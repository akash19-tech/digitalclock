'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[9],{1290:function(K,U,d){d.r(U);var h=d(0),e=d(27),r=d(392),m=d(18),n=d(19);class z{}z.beginDraftingAsync="OSC:BDA";z.U6i="OSC:FEQ";z.selectComment="OSC:SC";Object(h.a)(z,"CommentTaskNames",null,[]);class v{constructor(ba){this.yHa=ba;this.Ngk=[]}get handler(){return this.yHa}get L8(){return this.Ngk}}Object(h.a)(v,"RegisteredListener",null,[]);class x{constructor(ba,Aa){this.type=0;this.payload=null;this.type=ba;
this.payload=Aa}}Object(h.a)(x,"OfficeSharedCommentsEvent",null,[1530]);class B{constructor(){this.eventType=0;this.newViewContainer=null;this.viewContainerVisibilityState=1}}Object(h.a)(B,"ViewContainerEvent",null,[1530]);var D=d(676);class w{constructor(ba){this.gze=!1;this.TX=new m.a;this.wb=ba}w3k(ba){ba=new v(ba);this.TX.add(ba)}tMh(ba){for(let Aa=0;Aa<this.TX.count;++Aa)if(this.TX.ga(Aa).handler===ba){this.TX.removeAt(Aa);break}}jpa(ba=!1){const Aa=()=>{if(e.AFrameworkApplication.Yg)r.ULS.sendTraceTag(40420181,
201,50,"Skipped processing comment pane events since app is shutting down.");else for(let Lb=0;Lb<this.TX.count;++Lb){const Mb=this.TX.ga(Lb);for(;0<Mb.L8.length;){var Pa=Array.dequeue(Mb.L8);if(Object(n.a)(B,Pa)){var ub=Mb.handler;ub(Pa)}else Object(n.a)(x,Pa)&&(ub=Mb.handler,ub(Pa.type,Pa.payload))}}};ba?Aa():this.gze||(this.gze=!0,D.a.u7a(this.wb,()=>{Aa();this.gze=!1},z.U6i))}}Object(h.a)(w,"GenericEventHost",null,[]);class J extends w{constructor(ba){super(ba)}Q4k(ba){this.w3k(ba)}vMl(ba){this.tMh(ba)}Kyh(ba){ba=
this.iKi(ba);for(let Aa=0;Aa<this.TX.count;++Aa)Array.enqueue(this.TX.ga(Aa).L8,ba);this.jpa(!0)}iKi(ba){const Aa=new B;Aa.eventType=3;Aa.viewContainerVisibilityState=ba;return Aa}i7i(){const ba=this.KPi();for(let Aa=0;Aa<this.TX.count;++Aa)Array.enqueue(this.TX.ga(Aa).L8,ba);this.jpa(!0)}KPi(){const ba=new B;ba.eventType=2;return ba}}Object(h.a)(J,"ViewContainerEventHost",w,[1508]);class G{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=
this.comment=this.comments=null;this.virtualized=!1;this.index=0;this.tempId=this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=this.modelCapabilityFlags=0;this.rehydrationDrafts=this.contextDrafts=this.smartReplies=null}}Object(h.a)(G,"BasicEventPayload",null,[1569]);class M{constructor(ba){this.nextPopulatedContextDetails=0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=ba}}Object(h.a)(M,"CommentContextDetails",null,[]);class N{constructor(){this.numberOfThreads=
this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=0;this.virtualized=!1;this.rehydrationDrafts=this.contextDrafts=null}}Object(h.a)(N,"ContextChangeWithSelectedThreadIndex",null,[1569]);class R{constructor(){this.tasks=this.comments=null}}Object(h.a)(R,"LoadCommentsNoVirtualization",null,[1569]);class C extends w{constructor(ba){super(ba);this.j6h=0}P3k(ba,Aa,Pa,ub,Lb,Mb,kd=0){ba=new v(ba);Mb&&Array.enqueue(ba.L8,this.TJi(Mb,this.j6h));Mb=Aa?Aa.length:0;Array.enqueue(ba.L8,
this.FOf(Mb,Pa,ub,kd,null));Mb&&Array.enqueue(ba.L8,this.sPf(Aa,Lb));this.TX.add(ba);this.jpa()}H8e(ba){this.tMh(ba)}WYe(ba,Aa,Pa,ub=0,Lb=null){this.oVa(this.FOf(ba,Aa,Pa,ub,Lb));this.jpa()}hhl(ba,Aa,Pa,ub,Lb=null){this.oVa(this.mKi(ba,Aa,Pa,ub,Lb));this.jpa()}kvh(ba,Aa,Pa){this.oVa(this.pKi(ba,Aa,Pa));this.jpa()}$Ye(ba,Aa){this.oVa(this.sPf(ba,Aa));this.jpa()}selectComment(ba){this.oVa(this.$Pf(ba,6));this.jpa()}highlightComment(ba){this.oVa(this.$Pf(ba,7));this.jpa()}U2a(ba,Aa){this.oVa(this.IMi(ba,
Aa));this.jpa()}cQk(ba,Aa){this.oVa(this.ROi(ba,Aa));this.jpa()}TJi(ba,Aa=0){const Pa=new G;Pa.modelCapabilityFlags=ba;Pa.richTextCapabilityFlags=Aa;return new x(12,Pa)}FOf(ba,Aa,Pa,ub,Lb=null){const Mb=new G;Mb.numberOfComments=ba;Mb.numberOfThreads=Aa;Mb.contextDetails=Object.assign(new M(Pa),{nextPopulatedContextDetails:ub});Mb.contextDrafts=Lb;Mb.rehydrationDrafts=null;return new x(0,Mb)}mKi(ba,Aa,Pa,ub,Lb=null){const Mb=new N;Mb.numberOfComments=ba;Mb.numberOfThreads=Aa;Mb.selectedThreadIndex=
Pa;Mb.contextDetails=Object.assign(new M(ub),{nextPopulatedContextDetails:0});Mb.contextDrafts=Lb;Mb.rehydrationDrafts=null;return new x(0,Mb)}pKi(ba,Aa,Pa){const ub=new G;ub.comments=ba;ub.numberOfThreads=Aa;ub.tasks=Pa;return new x(2,ub)}sPf(ba,Aa){const Pa=new R;Pa.comments=ba;Pa.tasks=Aa;return new x(1,Pa)}$Pf(ba,Aa){const Pa=new G;Pa.commentId="";ba&&(Pa.commentId=ba);return new x(Aa,Pa)}IMi(ba,Aa){const Pa=new G;Pa.changes=[];Pa.contextDetails=Object.assign(new M(Aa),{nextPopulatedContextDetails:ba});
return new x(10,Pa)}ROi(ba,Aa){const Pa=new G;Pa.commentId=ba;Pa.smartReplies=Aa;return new x(15,Pa)}oVa(ba){for(let Aa=0;Aa<this.TX.count;++Aa)Array.enqueue(this.TX.ga(Aa).L8,ba)}}Object(h.a)(C,"OfficeSharedCommentsEventHost",w,[1560]);var O=d(1243);class S{constructor(){this.Ssf=this.Vtf=!1;this.v9h=[]}get uQb(){return this.v9h}get omb(){return this.Vtf}set omb(ba){this.Vtf=ba;for(const Aa of this.uQb)Aa.omb=ba}get klb(){return this.Ssf}set klb(ba){this.Ssf=ba;for(const Aa of this.uQb)Aa.klb=ba}VMa(ba){for(const Aa of this.uQb)ba=
Aa.VMa(ba);return ba}}Object(h.a)(S,"AggregateCommentTaskPersonTransformer",null,[1588]);var T=d(106);class ca{constructor(ba,Aa,Pa,ub,Lb=!1){this.priority=this.completion=-1;this.type=ba;this.user=Aa;this.time=Pa;this.recordId=ub;this.isLossy=Lb}}Object(h.a)(ca,"HistoryRecord",null,[]);class L{constructor(ba,Aa){this.x1h=new O.a(()=>Aa.VMa(ba.value))}Qej(){return new Date}sDa(ba,Aa,Pa){if(0===ba)throw r.ULS.sendTraceTag(594650201,327,10,"CreateBlankHistoryRecord: we do not expect user to be able to create a record of type Unknown in the browser."),
Error.argument("recordType");const ub=T.a.create().toString();Pa=new ca(ba,this.x1h.value,Pa,ub,!1);Pa.commentId=Aa;r.ULS.sendTraceTag(42796192,327,50,"History Record Generated. [RecordType: {0}]",ba);return Pa}}Object(h.a)(L,"HistoryRecordFactory",null,[1589]);class da{constructor(){this.endDate=this.startDate=null}}Object(h.a)(da,"CommentTaskSchedule",null,[]);class Z{constructor(ba,Aa,Pa,ub,Lb,Mb){this.isLossy=ba;this.title=Aa;this.assignees=Pa;this.schedule=ub;this.completion=Lb;this.priority=
Mb}}Object(h.a)(Z,"CommentTaskState",null,[]);class fa{constructor(){this.commentId=null}}Object(h.a)(fa,"HistoryItem",null,[]);class aa{constructor(ba,Aa,Pa,ub,Lb,Mb,kd){this.XGd=!1;if(1!==Aa.type)throw Error.argument("createRecord");this.qTb=Pa;this.nTb=ub;this.oTb=Lb;this.bof=1;this.QBc=ba;this.O2h=Mb;this._state=new Z(!1,this.qTb,kd,new da,this.oTb,this.nTb);this._history=[];this.DPf(Aa)}Dvb(ba,Aa){if(1!==ba.type)throw Error.argument("createRecordTemplate");const Pa=aa.cuj(ba,this.bof);this.bof++;
return Object.assign(new ca(Aa,ba.user,ba.time,Pa),{commentId:ba.commentId})}get kug(){return this.history[this.history.length-1]}get wgg(){return this.state.completion===this.oTb}get vgg(){return this.state.priority===this.nTb}get xgg(){return(void 0===this.state.schedule.startDate||null===this.state.schedule.startDate)&&(void 0===this.state.schedule.endDate||null===this.state.schedule.endDate)}get ygg(){return this.state.title===this.qTb}DPf(ba){ba=Object.assign(new fa,{commentId:ba.commentId,records:[ba]});
this.history.push(ba)}Y3f(ba){let Aa=-1;for(let Pa=0;Pa<this.state.assignees.length;Pa++)if(this.QBc.equals(this.state.assignees[Pa],ba)){Aa=Pa;break}return Aa}prl(ba){const Aa=this.kug,Pa=Aa.records[Aa.records.length-1];return this.QBc.equals(Pa.user,ba.user)&&Aa.commentId===ba.commentId&&Pa.time.getTime()===ba.time.getTime()?!0:!1}kRl(ba){switch(ba.type){case 2:-1===this.Y3f(ba.assignee)&&this.state.assignees.push(ba.assignee);break;case 3:const Aa=this.Y3f(ba.assignee);0<=Aa&&this.state.assignees.splice(Aa,
1);break;case 4:Array.clear(this.state.assignees);break;case 5:this.state.schedule=ba.schedule;break;case 6:this.state.completion=ba.completion;break;case 9:this.state.title=ba.title;break;case 10:this.state.priority=ba.priority;break;case 0:this.state.isLossy=!0;break;case 1:r.ULS.sendTraceTag(595198540,327,10,"Create record passed for state evaluation");break;case 7:this.XGd=!0;break;case 8:this.XGd=!1;break;case -1:r.ULS.sendTraceTag(51139905,327,10,"Undo record passed for state evaluation");break;
default:this.state.isLossy=!0}ba.isLossy&&(this.state.isLossy=!0);this.prl(ba)?this.kug.records.push(ba):this.DPf(ba)}get isDeleted(){return this.XGd}get state(){return this._state}get history(){return this._history}pij(ba){if(!ba)return this.history;const Aa=Array.clone(this.history),Pa=Aa[0],ub=Pa.records.shift();if(!this.O2h){var Lb=this.Dvb(ub,4);Pa.records.unshift(Lb)}!ba.wgg&&this.wgg&&(Lb=this.Dvb(ub,6),Lb.completion=this.oTb,Pa.records.unshift(Lb));!ba.vgg&&this.vgg&&(Lb=this.Dvb(ub,10),Lb.priority=
this.nTb,Pa.records.unshift(Lb));!ba.xgg&&this.xgg&&(Lb=this.Dvb(ub,5),Lb.schedule=new da,Pa.records.unshift(Lb));!ba.ygg&&this.ygg&&(Lb=this.Dvb(ub,9),Lb.title=this.qTb,Pa.records.unshift(Lb));ba.isDeleted&&(ba=this.Dvb(ub,8),Pa.records.unshift(ba));return Aa}static cuj(ba,Aa){return"Synthesized-"+ba.recordId+"-"+Aa}}Object(h.a)(aa,"CommentTaskStateBuilder",null,[]);var ja=d(732);class I{constructor(ba,Aa,Pa,ub){this.id=ba;this.commentId=Aa;this.currentState=Pa;this.history=ub}}Object(h.a)(I,"CommentTaskItem",
null,[]);class sa{constructor(ba,Aa="",Pa="",ub=""){this.IsCurrentUser=!1;this.UserId=ba;this.Provider=Aa;this.DisplayName=Pa;this.Email=ub}}Object(h.a)(sa,"CommentTaskPerson",null,[1583]);const ka=ba=>{const Aa=new sa(ba.UserId,ba.Provider,ba.DisplayName,ba.Email);Aa.IsCurrentUser=ba.IsCurrentUser;return Aa};var Ma=d(1050);d(284);class Ea{constructor(ba){this.extensions=ba}}Object(h.a)(Ea,"ExtensionList",null,[]);class ma{static clone(ba){ba=ma.YBi(ba.extensions);return new Ea(ba)}static ZKf(ba){return ba?
ma.clone(ba):null}static isEmpty(ba){return!ba.extensions||!ba.extensions.count}static Xa(ba){return!ba||ma.isEmpty(ba)}static YBi(ba){if(!ba)return null;const Aa=new Ma.a;ba.forEach((Pa,ub)=>{Aa.add(Pa,ub);return!0});return Aa}}Object(h.a)(ma,"ExtensionListExtensions",null,[]);class va{static clone(ba){var Aa=ka(ba.user);Aa=new ca(ba.type,Aa,ba.time,ba.recordId,ba.isLossy);Aa.commentId=ba.commentId;Aa.anchorExtensionList=ma.ZKf(ba.anchorExtensionList);Aa.recordExtensionList=ma.ZKf(ba.recordExtensionList);
ba.assignee&&(Aa.assignee=ka(ba.assignee));if(ba.schedule){var Pa=ba.schedule;const ub=new da;ub.startDate=Pa.startDate;ub.endDate=Pa.endDate;Aa.schedule=ub}Aa.completion=ba.completion;Aa.title=ba.title;Aa.priority=ba.priority;Aa.undoId=ba.undoId;return Aa}}Object(h.a)(va,"HistoryRecordExtensions",null,[]);class Ca{constructor(ba,Aa,Pa,ub,Lb,Mb,kd,Id=!1){this.QBc=ba;this.QEc=Aa;this.lra=Pa;this.jWh=ub;this.qTb=Lb;this.nTb=Mb;this.oTb=kd;this.zCc=Id}pPi(ba,Aa,Pa,ub=null){if(!ba)throw r.ULS.sendTraceTag(42796181,
327,10,"taskId cannot be null."),Error.argumentNull("taskId");if(!Aa)throw r.ULS.sendTraceTag(42796182,327,10,"parentCommentId cannot be null."),Error.argumentNull("parentCommentId");if(!Pa||!Pa.length)throw r.ULS.sendTraceTag(42796183,327,10,"records cannot be null or empty."),Error.argumentNull("records");if(1!==Pa[0].type)throw r.ULS.sendTraceTag(42796184,327,10,"First record must be a Create record."),Error.argument("First record must be a Create record.");var Lb=[],Mb=null,kd=this.SUk(Pa);for(var Id of Pa)if(!kd.contains(Id.recordId))if(Pa=
this.Qcg(Id.commentId,ub),Pa=this.l$i(Id,Pa),1===Pa.type){let Xe=[];this.zCc&&Mb&&Mb.state&&(Xe=Mb.state.assignees);Mb=new aa(this.QBc,Pa,this.qTb,this.nTb,this.oTb,this.zCc,Xe);Lb.push(Mb)}else if(Mb)Mb.kRl(Pa);else throw r.ULS.sendTraceTag(595198539,327,10,"Undo resulted in ignoring of Task creation without also ignoring records after the create record."),Error.argument("Undo resulted in ignoring of Task creation without also ignoring records after the create record.");kd=null;Id=[];if(Mb){Mb.isDeleted||
(kd=Mb.state);Mb=null;for(var ce of Lb)Lb=ce.pij(Mb),Array.addRange(Id,Lb),Mb=ce}ce=this.Qcg(Aa,ub);kd&&(kd.completion=this.pEi(Aa,ub,kd.completion));return new I(ba,ce,kd,Id)}G9i(ba,Aa,Pa,ub=null){if(!Aa)throw r.ULS.sendTraceTag(42796185,327,10,"update cannot be null."),Error.argumentNull("update");if(Pa&&!ba)throw r.ULS.sendTraceTag(42796187,327,10,"CommentId must be specified for task creation."),Error.argument("commentId");const Lb=[],Mb=this.lra.Qej();if(Pa){var kd=this.lra.sDa(1,ba,Mb);Lb.push(kd)}kd=
null;if(Aa.assigneeUpdate){if(!Aa.assigneeUpdate.assigneesToAdd||!Aa.assigneeUpdate.assigneesToRemove)throw r.ULS.sendTraceTag(536999254,327,15,"Invalid AssigneeUpdate."),Error.argument("Schedule","Invalid AssigneeUpdate.");for(var Id=0;Id<Aa.assigneeUpdate.assigneesToAdd.length;Id++){var ce=this.EPf(2,Aa.assigneeUpdate.assigneesToAdd[Id],ba,Mb);ce&&Lb.push(ce)}for(Id=0;Id<Aa.assigneeUpdate.assigneesToRemove.length;Id++)(ce=this.EPf(3,Aa.assigneeUpdate.assigneesToRemove[Id],ba,Mb))&&Lb.push(ce)}else Aa.assignee&&
(Pa||(kd=this.lra.sDa(4,ba,Mb),Lb.push(kd)),Id=this.lra.sDa(2,ba,Mb),kd=this.QEc.VMa(Aa.assignee),Id.assignee=kd,Lb.push(Id));Aa.title?(ub=this.lra.sDa(9,ba,Mb),ub.title=Aa.title,Lb.push(ub)):Pa&&ub&&(Id=this.lra.sDa(9,ba,Mb),Id.title=this.jWh.Rvj(ub,kd),Lb.push(Id));if(Aa.schedule){if(Aa.schedule.startDate>Aa.schedule.endDate)throw r.ULS.sendTraceTag(42796188,327,10,"Invalid schedule."),Error.argument("Schedule","Invalid schedule.");ub=this.lra.sDa(5,ba,Mb);ub.schedule=Aa.schedule;Lb.push(ub)}if(void 0!==
Aa.completion&&null!==Aa.completion){ub=Aa.completion;if(0>ub||100<ub)throw r.ULS.sendTraceTag(42796189,327,10,"Invalid completion state."),Error.argumentOutOfRange("completion");Pa||r.ULS.sendTraceTag(595198538,327,50,"Task progress change. [Progress: {0}]",ub);Pa=this.lra.sDa(6,ba,Mb);Pa.completion=ub;Lb.push(Pa)}if(void 0!==Aa.priority&&null!==Aa.priority){Aa=Aa.priority;if(0>Aa||10<Aa)throw r.ULS.sendTraceTag(42796190,327,10,"Invalid priority state."),Error.argumentOutOfRange("priority");ba=this.lra.sDa(10,
ba,Mb);ba.priority=Aa;Lb.push(ba)}return Lb}EPf(ba,Aa,Pa,ub){if(2!==ba&&3!==ba)return r.ULS.sendTraceTag(0,327,10,"Assignee field should only be used for an Assign or Unassign HistoryRecord."),null;ba=this.lra.sDa(ba,Pa,ub);ba.assignee=this.QEc.VMa(Aa);return ba}SUk(ba){const Aa=new ja.a,Pa=new ja.a;for(let ub=ba.length-1;0<=ub;ub--){const Lb=ba[ub],Mb=Pa.contains(Lb.recordId);Mb||-1!==Lb.type||(Pa.contains(Lb.undoId)?r.ULS.sendTraceTag(578670598,327,50,"Multiple Undo records attempting to undo the same record."):
Pa.add(Lb.undoId));if(Mb||-1===Lb.type)Aa.contains(Lb.recordId)?r.ULS.sendTraceTag(578670599,327,50,"Record was already added to records to ignore. There must be multiple records with same ID."):Aa.add(Lb.recordId)}return Aa}l$i(ba,Aa){const Pa=va.clone(ba);Pa.commentId=Aa;Pa.user=this.QEc.VMa(ba.user);Pa.assignee=this.QEc.VMa(ba.assignee);return Pa}pEi(ba,Aa,Pa){let ub=Pa;ba&&Aa&&(({value:Aa}=Aa.wg(ba)).returnValue?(ub=Aa.ResolveState?100:100===Pa?0:Pa,ub!==Pa&&r.ULS.sendTraceTag(592719873,327,50,
"Task completion state has been changed to match comment resolution state for comment {0}",ba)):r.ULS.sendTraceTag(592719874,327,50,"Comment {0} not found in translation map. Completion unchanged",ba));return ub}Qcg(ba,Aa){let Pa=ba;ba&&Aa&&(({value:Aa}=Aa.wg(ba)).returnValue?Pa=Aa.CommentId:(r.ULS.sendTraceTag(42796191,327,50,"Id not found in translation map. Possible Orphan task candidate [CommentId: {0}]",ba),Pa=ba));return Pa}}Object(h.a)(Ca,"CommentTaskTranslatorImpl",null,[1037]);class oa{constructor(){this.i4a=
{};this.i4a.ops=[]}fQj(ba){const Aa=this.i4a.ops;if(Aa.length){var Pa=Aa.length-1;const ub=Aa[Pa];if(!ub.attributes){ub.insert+=ba;Aa[Pa]=ub;this.i4a.ops=Aa;return}}Pa={};Pa.insert=ba;Array.add(Aa,Pa)}GPj(ba,Aa,Pa){var ub={};ub.fullName=Aa.fullName;ub.email=Aa.email;ub.resolveState=Aa.resolveState;Aa={};Aa.atmention=ub;ba=this.o3b(ba,Aa);Pa&&(ub={},ub.contentId=Pa.contentId,Pa={},Pa.atmention=ub,ba.optional=Pa);Array.add(this.i4a.ops,ba)}insertImage(ba,Aa){ba=this.o3b(ba,{});const Pa={};Pa.base64=
Aa.base64;Aa={};Aa.image=Pa;ba.optional=Aa;Array.add(this.i4a.ops,ba)}insertHyperLink(ba,Aa){const Pa={};Pa.link=Aa.link;this.Enl(Pa,Aa);Array.add(this.i4a.ops,this.o3b(ba,Pa))}sfj(){return Sys.Serialization.JavaScriptSerializer.serialize(this.i4a)}o3b(ba,Aa){const Pa={};Pa.insert=ba;Pa.attributes=Aa;return Pa}Enl(ba,Aa){this.alb(Aa.weight>=oa.iwk,ba,"weight",Aa.weight);this.alb(Aa.italic,ba,"italic",!0);this.alb(Aa.underline,ba,"underline",!0);this.alb(Aa.strikethrough,ba,"strikethrough",!0);this.alb(!!Aa.highlight,
ba,"highlight",Aa.highlight);this.alb(!!Aa.color,ba,"color",Aa.color);this.alb(!!Aa.paragraph,ba,"paragraph",Aa.paragraph)}alb(ba,Aa,Pa,ub){ba&&(Aa[Pa]=ub)}static j6f(ba){return Sys.Serialization.JavaScriptSerializer.deserialize(ba,!0)}}oa.iwk=700;Object(h.a)(oa,"DeltaFormatCreator",null,[1551]);var Da=d(538),ta=d(1189);class ha{constructor(){this.ellipsis=CommonUIStrings.l_Ellipsis}Rvj(ba,Aa){if(!ba)throw r.ULS.sendTraceTag(592998807,327,10,"Missing commentRichText"),Error.argumentNull("commentRichText");
try{var Pa=oa.j6f(ba)}catch(ce){throw r.ULS.sendTraceTag(592998806,327,10,"commentRichText not in Delta Format"),Error.format("Improperly formatted Delta text in commentRichText");}var ub=ba=0,Lb=0;const Mb=RegExp("\\s+","g"),kd=new Sys.StringBuilder;for(var Id of Pa.ops)Id.attributes&&Id.attributes.atmention&&Id.attributes.atmention.email&&Aa&&(Pa=Id.attributes.atmention.email,0<Pa.length&&(Pa===Aa.UserId||Pa===Aa.Email||Pa===Da.a.a$a(Aa.UserId))&&(ub=ba,Lb=ub+Id.insert.length)),Pa=Id.insert.replace(Mb,
" "),ba+=Pa.length,kd.append(Pa);!Lb&&Aa&&r.ULS.sendTraceTag(592998805,327,10,"Assignee was not found in comment text",Aa.Provider);Aa=kd.toString().trimEnd();ba=Aa.length;255<ba?(Id=(255-(Lb-ub))/2,0>ub-Id?(ba=ta.a.instance.y9d(Aa,255-this.ellipsis.length),Lb=Aa.substring(0,ba)+this.ellipsis,ba="Trimmed End"):Lb+Id>ba?(ub=ta.a.instance.zVc(Aa,ba-255+this.ellipsis.length),Lb=this.ellipsis+Aa.substring(ub,ba),ba="Trimmed Start"):(ub=ta.a.instance.zVc(Aa,ub-Id+this.ellipsis.length),ba=ta.a.instance.y9d(Aa,
Lb+Id-this.ellipsis.length),Lb=this.ellipsis+Aa.substring(ub,ba)+this.ellipsis,ba="Trimmed Both")):(ba="No Trim",Lb=Aa);r.ULS.sendTraceTag(592998804,327,50,ba);return Lb}}Object(h.a)(ha,"ContentExtractor",null,[]);class Ha{constructor(ba,Aa){this.TZh=ba;this.y1h=Aa;this.klb=this.omb=!1}VMa(ba){if(!ba)return null;if(void 0===ba.UserId||null===ba.UserId)throw r.ULS.sendTraceTag(593368219,327,10,"Unexpected user missing UserId field"),Error.argumentType();if(ba.IsCurrentUser||!this.TZh.equals(this.y1h.value,
ba))return ba;ba=ka(ba);ba.IsCurrentUser=!0;return ba}}Object(h.a)(Ha,"EnsureIsCurrentUserSetTransformer",null,[1588]);class bb{constructor(){this.klb=this.omb=!1}VMa(ba){if(!ba)return null;if(void 0===ba.UserId||null===ba.UserId)return ba;if(!ba.Email||""===ba.Email){let Aa;if(Aa=Da.a.a$a(ba.UserId))return ba=ka(ba),ba.Email=Aa,ba}return ba}}Object(h.a)(bb,"RestoreEmailTransformer",null,[1588]);class Na{constructor(){this.klb=this.omb=!1}VMa(ba){if(!ba)return null;if(void 0!==ba.UserId&&null!==ba.UserId)return ba;
switch(this.omb?this.klb?2:1:0){case 0:if(void 0===ba.UserId||null===ba.UserId)throw r.ULS.sendTraceTag(593368215,327,10,"assignee missing UserId"),Error.argument("assignee.UserId");ba=ka(ba);break;case 1:if(void 0===ba.Id||null===ba.Id)throw r.ULS.sendTraceTag(593368214,327,10,"assignee missing Id"),Error.argument("assignee.Id");if(void 0===ba.Email||null===ba.Email)throw r.ULS.sendTraceTag(593368213,327,10,"assignee missing Email"),Error.argument("assignee.Email");var Aa=Na.zeh(ba.Id,ba.Email,null);
if(!Aa||""===Aa)throw r.ULS.sendTraceTag(593368212,327,10,"Failed to generate UserId"),Error.argument("UserId");var Pa=e.AFrameworkApplication.fa.Ha("HostAuthType")||"";if("aad"!==Pa.toLowerCase()||Aa.startsWith("S::")){if("msa"===Pa.toLowerCase())throw r.ULS.sendTraceTag(593368210,327,10,"Unexpected IPersonObject in MSA Environment"),Error.argument("CommentTaskUserType");r.ULS.sendTraceTag(593368209,327,50,"Receiving IPersonObject with AuthType {0}",Pa)}else throw r.ULS.sendTraceTag(593368211,327,
10,"Unexpected UserID format"),Error.argument("userId");ba=new sa(Aa,"AD",ba.DisplayName,ba.Email);break;case 2:if(void 0===ba.UserPrincipalName||null===ba.UserPrincipalName)throw r.ULS.sendTraceTag(593368208,327,10,"assignee missing UserPrincipalName"),Error.argument("assignee.UserPrincipalName");if(void 0!==ba.SuggestionSubtype&&null!==ba.SuggestionSubtype)if("OrganizationUser"===ba.SuggestionSubtype)Aa="AD";else throw r.ULS.sendTraceTag(593368207,327,10,"Unexpected LPP SuggestionSubtype : {0}",
ba.SuggestionSubtype),Error.argument("assignee.SuggestionSubtype");else throw r.ULS.sendTraceTag(593368206,327,10,"Missing SuggestionSubtype"),Error.argument("assignee.SuggestionSubtype");Pa=Na.zeh(ba.Id,ba.UserPrincipalName,ba.AadObjectId);if(!Pa||""===Pa)throw r.ULS.sendTraceTag(593368205,327,10,"Failed to generate UserId"),Error.argument("UserId");if("AD"===Aa&&!Pa.startsWith("S::"))throw r.ULS.sendTraceTag(593368204,327,10,"Unexpected UserID and Provider combination"),Error.argument("userId");
ba=new sa(Pa,Aa,ba.Name,ba.UserPrincipalName);break;default:throw r.ULS.sendTraceTag(593368203,327,10,"Unexpected UserType"),Error.argument("assignee.UserType");}return ba}static zeh(ba,Aa,Pa){if(!Aa||""===Aa)return r.ULS.sendTraceTag(593368218,327,50,"Missing UPN"),ba;if(Pa&&""!==Pa)return"S::"+Aa+"::"+Pa;if(!ba||""===ba)return r.ULS.sendTraceTag(593368217,327,50,"Missing ID"),ba;if(ba.startsWith("S::"))return ba;if(-1!==ba.indexOf("@")){Pa=ba.split("@");if(T.a.isValid(Pa[0]))return"S::"+Aa+"::"+
Pa[0];r.ULS.sendTraceTag(593368216,327,50,"ID is not in AadObjectId@TenantId format")}return ba}}Object(h.a)(Na,"UserIdCanonicalizationTransformer",null,[1588]);class Ia{constructor(ba,Aa,Pa=!1,ub=!1){this.UXh=ba;this.Acf=Aa;this.R1h=Pa;this.zCc=ub}gKi(){const ba=new Da.a;var Aa=new O.a(Ia.Cej);const Pa=new S;this.Acf&&(Pa.uQb.push(new Na),Pa.uQb.push(new bb));this.UXh&&Pa.uQb.push(new Ha(ba,Aa));Pa.omb=this.Acf;Pa.klb=this.R1h;Aa=new L(Aa,Pa);const ub=new ha;return new Ca(ba,Pa,Aa,ub,Ia.$Ri,Ia.MRi,
Ia.NRi,this.zCc)}static Cej(){const ba=new sa(e.AFrameworkApplication.fa.Ha("PresenceUserId")||"",e.AFrameworkApplication.fa.Ha("PresenceProvider")||"",e.AFrameworkApplication.userName||"");ba.IsCurrentUser=!0;return ba}}Ia.$Ri="";Ia.MRi=5;Ia.NRi=0;Object(h.a)(Ia,"CommentTaskTranslatorFactory",null,[1582]);class Qa{constructor(){this.pOd=this.Waf=!1;this.Grb=this.nx=this.Oif=this.ymf=this.wvf=this.Kpf=this.kuf=this.odf=this.rI=this.BYb=null}initialize(ba,Aa,Pa,ub=null,Lb=null,Mb=null,kd=null,Id=null,
ce=null,Xe=null){this.rI=ba;this.odf=Aa;this.kuf=Pa;this.Kpf=ub;this.wvf=Lb;this.ymf=Mb;this.Oif=kd;this.nx=Id;this.Waf=!0;this.Grb=ce;this.BYb=Xe}X$b(ba=null,Aa=null){if(!this.Waf)return r.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),new Promise((Pa,ub)=>{ub(D.a.kt(-2130915313))});if(this.pOd)return r.ULS.sendTraceTag(41424204,201,10,"InstantiateSharedComments called after shared comments was already instantiated."),new Promise(()=>
{});this.BYb||(e.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?this.BYb=appResourceLoader.loadChunk("sharedComments"):this.BYb=this.rI.loadScript("sharedComments"));return this.BYb.then(()=>{ba&&ba();this.pOd||(this.Grb&&this.Grb.execute(Pa=>{Pa.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}),Aa&&Aa(),sharedComments.instantiate(this.odf,this.kuf,this.Kpf,this.wvf,this.ymf,this.Oif,this.nx));this.pOd=!0})}}Object(h.a)(Qa,"CommentActivationManager",
null,[1584]);var qa=d(7);class Wa{constructor(){this.actionBehavior=this.actionType=0}}Object(h.a)(Wa,"CommentUIActionPayload",null,[]);var Hb=d(259);class jc{constructor(ba,Aa){this.Ca=ba;this.t3a=Aa;this.oAd=new Hb.a;for(let Pa of this.t3a)this.oAd.$(Pa.value.canvasActionId,Pa.key),ba=Pa.value,ba.delayActionsUntilRegistration||this.ya(ba)}ya(ba){ba.withFlags?this.Ca.ra(ba.canvasActionId,ba.canvasContextId,Object(qa.a)(this,this.$Zb,"actionHandler"),97):this.Ca.ya(ba.canvasActionId,ba.canvasContextId,
Object(qa.a)(this,this.$Zb,"actionHandler"))}zya(ba,Aa){this.t3a.Fb(ba)&&(this.t3a.ga(ba).delayActionsUntilRegistration&&this.ya(this.t3a.ga(ba)),this.t3a.ga(ba).registeredCallback=Aa)}$Zb(ba,Aa,Pa,ub,Lb){if(this.oAd.Fb(ba)){var Mb=this.oAd.ga(ba);if(!this.t3a.Fb(Mb))return 8;const kd=this.t3a.ga(Mb);if(kd.preCallback){const Id=kd.preCallback(ba,Aa,Pa,ub,Lb);if(2!==Id)return Id}if(!kd.registeredCallback)return 1===Pa?8:2;Mb=Object.assign(new Wa,{actionType:Mb});1===Pa&&(Mb.actionBehavior=1);Mb=kd.registeredCallback(Mb);
return kd.postCallback?kd.postCallback(Mb,ba,Aa,Pa,ub,Lb):Mb?32:8}return 2}}Object(h.a)(jc,"OfficeSharedCommentsActionHost",null,[1562]);var gc=d(353),$b=d(37),wb=d(197);class Db{}Object(h.a)(Db,"CommentActivityData",null,[]);var Xb=d(142),ab=d(73);class Ab{constructor(ba,Aa,Pa,ub,Lb,Mb,kd,Id,ce,Xe=null,jd=null){this.Iwf={["CancelCommentCreateThreadAction"]:$b.a.Hzh,["CommitComment"]:$b.a.Izh,["CommitDraftAction"]:$b.a.Jzh,["CommitDraftCreateAction"]:$b.a.E0e,["CommitDraftEditAction"]:$b.a.G0e,["CommitDraftReplyAction"]:$b.a.D0e,
["CreateReplyAction"]:$b.a.D0e,["CreateReplyWithMentions"]:$b.a.Kzh,["CreateReplyWithTaskAssigned"]:$b.a.Lzh,["CreateThreadAction"]:$b.a.E0e,["CreateThreadWithMentions"]:$b.a.Mzh,["CreateThreadWithTaskAssigned"]:$b.a.Nzh,["DeletePostAction"]:$b.a.Ozh,["DeleteThreadAction"]:$b.a.Pzh,["DeleteThreadWithTask"]:$b.a.Qzh,["DiscardDraftAsync"]:$b.a.Rzh,["PresentLinkToCommentAction"]:$b.a.Szh,["ResolveThreadAction"]:$b.a.Wzh,["ResolveThreadWithTask"]:$b.a.Xzh,["ReopenThreadAction"]:$b.a.Tzh,["ReopenThreadWithTask"]:$b.a.Uzh,
["RequestInitCommentSession"]:$b.a.Vzh,["SelectCommentAction"]:$b.a.Yzh,["UpdateCommentBodyAction"]:$b.a.G0e};this.dataCenter=this.ring=this.sessionId=this.releaseChannel=this.releaseAudience=this.appVersion=this.appName=null;this.disableUpload=!1;this.sovereignEnvironmentName=null;this.appName=ba;this.appVersion=Aa;this.releaseAudience=Pa;this.releaseChannel=ub;this.sessionId=Lb;this.ring=Mb;this.dataCenter=kd;this.disableUpload=Id;this.sovereignEnvironmentName=jd;this.Ca=ce;this.Mpf=Xe;this.hPj()}hPj(){this.Ca.ya($b.a.Hzh,
ab.a.frame,wb.ActionManager.Sg);this.Ca.ya($b.a.Izh,ab.a.frame,wb.ActionManager.Sg);this.Ca.ya($b.a.Jzh,ab.a.frame,wb.ActionManager.Sg);this.Ca.ya($b.a.D0e,ab.a.frame,wb.ActionManager.Sg);this.Ca.ya($b.a.Kzh,ab.a.frame,wb.ActionManager.Sg);this.Ca.ya($b.a.Lzh,ab.a.frame,wb.ActionManager.Sg);this.Ca.ya($b.a.E0e,ab.a.frame,wb.ActionManager.Sg);this.Ca.ya($b.a.Mzh,ab.a.frame,wb.ActionManager.Sg);this.Ca.ya($b.a.Nzh,ab.a.frame,wb.ActionManager.Sg);this.Ca.ya($b.a.Ozh,ab.a.frame,wb.ActionManager.Sg);this.Ca.ya($b.a.Pzh,
ab.a.frame,wb.ActionManager.Sg);this.Ca.ya($b.a.Qzh,ab.a.frame,wb.ActionManager.Sg);this.Ca.ya($b.a.Rzh,ab.a.frame,wb.ActionManager.Sg);this.Ca.ya($b.a.Szh,ab.a.frame,wb.ActionManager.Sg);this.Ca.ya($b.a.Wzh,ab.a.frame,wb.ActionManager.Sg);this.Ca.ya($b.a.Xzh,ab.a.frame,wb.ActionManager.Sg);this.Ca.ya($b.a.Tzh,ab.a.frame,wb.ActionManager.Sg);this.Ca.ya($b.a.Uzh,ab.a.frame,wb.ActionManager.Sg);this.Ca.ya($b.a.Vzh,ab.a.frame,wb.ActionManager.Sg);this.Ca.ya($b.a.Yzh,ab.a.frame,wb.ActionManager.Sg);this.Ca.ya($b.a.G0e,
ab.a.frame,wb.ActionManager.Sg)}sendULSTrace(ba,Aa,Pa,ub){r.ULS.sendTraceTag(ba,Aa,Pa,ub)}recordActivity(ba){this.Iwf[ba]&&this.Ca.processAction(this.Iwf[ba],2)}sendOtelEvent(ba){Xb.a.sendOtelEvent(ba)}recordPerfData(ba,Aa){this.Mpf&&(ba=Object.assign(new Db,{durationMs:Aa,name:ba}),this.Mpf.Joa(ba))}}Object(h.a)(Ab,"OfficeSharedCommentsTelemetry",null,[]);var rc=d(269);class tb{constructor(ba,Aa,Pa,ub){this.isRightToLeft=!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=ba;
this.appLocale=Aa;this.uiCulture=Pa;this.dataCulture=ub}}Object(h.a)(tb,"LocalizationDetails",null,[]);var Za=d(252),fb=d(67),ac=d(93);class Dc{constructor(ba,Aa){this.z$h=ba;this.Rff=Aa}getViewContainer(){return this.z$h}registerForViewContainerEvents(ba){this.Rff.Q4k(ba)}unregisterForViewContainerEvents(ba){this.Rff.vMl(ba)}}Object(h.a)(Dc,"ViewContainerProvider",null,[1507]);var Sc=d(71),xb=d(1244),Ta=d(36),ib=d(29),ob=d(248),fc=d(201),Jb=d(28),xc=d(193),ic=d(645);class nc{static g8f(ba){return ba===
nc.create?0:ba===nc.reply?1:ba===nc.edit?2:ba===nc.metadata?3:null}}nc.create="CREATE";nc.reply="REPLY";nc.edit="EDIT";nc.metadata="METADATA";Object(h.a)(nc,"CommentSessionType",null,[]);class Wb{constructor(){this.insertIndex=0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(h.a)(Wb,"InitCommentSessionResult",null,[]);class wc extends Wb{constructor(){super();this.updatedDraftSessionConfiguration=null}}Object(h.a)(wc,"BeginDraftingHostResult",
Wb,[]);class nb{constructor(ba,Aa="",Pa="",ub="",Lb=!1){this.Email=this.DisplayName=this.Provider=this.UserId=null;this.IsCurrentUser=!1;this.UserId=ba;this.Provider=Aa;this.DisplayName=Pa;this.Email=ub;this.IsCurrentUser=Lb}}Object(h.a)(nb,"OfficeSharedCommentUser",null,[]);var Rb=d(47),mb=d(56),Ub=d(156),zc=d(33);class Pc{constructor(ba,Aa,Pa){this.Tq=ba;this.vgk=Aa;this.Afk=Pa;this.RCg=null;this.YJg=!1}get ORa(){return this.Tq}get UC(){return this.vgk}get commentId(){return this.Afk}get O8(){return this.RCg}set O8(ba){this.RCg=
ba}get M2c(){return this.YJg}set M2c(ba){this.YJg=ba}}Object(h.a)(Pc,"ActiveCommentSession",null,[]);var Mc=d(694);class ld{static get bvk(){return 50}static raj(ba){return ld.gdj(ba)}static Snj(ba){if(""===ba)return"";let Aa=0,Pa="";try{const ub=oa.j6f(ba);for(const Lb of ub.ops)if(ld.Lua(Lb))Aa||(Pa+=ld.phj(Lb.attributes.atmention.fullName)),Aa+=1;else{const Mb=Lb.insert?Lb.insert:"";" "!==Mb&&0<Mb.length&&(Aa=0,Pa+=Mb)}}catch(ub){r.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return Pa}static gdj(ba){ba=
ld.Snj(ba);return 0<ba.length&&ba.split(" ").length<=ld.bvk?ba:null}static phj(ba){let Aa="";ba&&(ba=ba.split(" "),0<ba.length&&(Aa=ba[0]));return Aa}static Lua(ba){return!!ba.attributes&&!!ba.attributes.atmention}}Object(h.a)(ld,"BaseCommentSmartReplyHelpers",null,[]);class vb{constructor(ba){this.Vue=ba}LSl(ba,Aa,Pa,ub){-1===Pa||Aa||(Aa=ub[Pa],Pa=Aa.author?Aa.author.IsCurrentUser:!1,Aa&&Aa.commentBody&&!Pa&&(Aa=ld.raj(Aa.commentBody))&&this.Vue.invoke(ba,Aa))}}Object(h.a)(vb,"CommentSmartReplyHelpers",
null,[]);var cc=d(55),Hc=d(75),Pb=d(34),Uc=d(90),sc=d(91),lb=d(51);class Zb{constructor(){this.hEd=this.$Od=this.EPa=null;this.ugg=!1;this.ewd=this.fwd=this.endPos=this.startPos=0}get paragraphs(){return this.EPa}get oV(){return this.$Od}set oV(ba){this.$Od=ba;this.EPa=[];this.EPa.push(this.$Od)}get N3(){return this.hEd}set N3(ba){this.hEd=ba;this.EPa&&this.ncc&&this.EPa.push(this.hEd)}z2i(){for(const ba of this.EPa){const Aa=Object(xb.a)(5,ba);if(Aa&&-1!==Aa.gyb().indexOf("\ufffc"))return!0}return!1}Jsg(ba){const Aa=
(this.ewd&4294967295)>>>0;ba.TextBodyLength!==this.fwd||Aa===ba.TextBodyHash||Zb.yth.contains(this.ewd)||(Zb.yth.add(this.ewd),Jb.a.J(554280861,805,50,"IsTextBodyLengthValid - text body length matches but hash does not; ContainsObjectReplaceChar:{0}",this.z2i()));return ba.TextBodyLength===this.fwd}get elh(){let ba=0;if(this.isValid)if(this.ncc){ba+=Pb.ParagraphReader.textLength(this.oV)-this.startPos;ba+=this.endPos;for(let Aa=1;Aa<this.paragraphs.length-1;Aa++){const Pa=this.paragraphs[Aa];Pa&&
(ba+=Pb.ParagraphReader.textLength(Pa)+1)}}else ba=this.endPos-this.startPos;return ba}get IMa(){if(!this.isValid)return Uc.a.auto;var ba=lb.a.Lj(this.oV,this.startPos+1);if(!ba)return Uc.a.auto;ba=sc.a.Bs(ba);return ba?(ba=ba.cache)&&ba.k4?ba.fontColor:Uc.a.auto:Uc.a.auto}get isValid(){return!!this.oV&&!!this.N3&&!!this.paragraphs}get ncc(){return!this.oV.equals(this.N3)}bdi(ba){this.EPa&&ba&&this.EPa.push(ba)}jRj(){if(this.isValid&&(this.oV.Kv(16,!0),this.ncc))for(let ba=1;ba<this.paragraphs.length;ba++){const Aa=
this.paragraphs[ba];Aa&&Aa.Kv(16,!0)}}RUj(ba,Aa){if(!this.isValid)return!1;const Pa=Object(xb.a)(Hc.AParagraphNode,ba.node),ub=Object(xb.a)(Hc.AParagraphNode,Aa.node);return!(Pa&&ub&&Array.contains(this.paragraphs,Pa)&&Array.contains(this.paragraphs,ub))||Pa.equals(this.oV)&&(0>ba.Sa||ba.Sa<this.startPos)||ub.equals(this.N3)&&(0>Aa.Mb||Aa.Mb>this.endPos)?!1:!0}z6f(ba){let Aa=3;ba&&(!this.ncc&&this.oV.equals(ba)?Aa=2:this.oV.equals(ba)?Aa=0:this.N3.equals(ba)&&(Aa=1));return Aa}}Zb.yth=new ja.a;Object(h.a)(Zb,
"TextAnchorParagraphInfo",null,[]);class Oc{static Xwb(ba,Aa){return ba||Aa?ba&&Aa?ba.commentId===Aa.commentId:!1:!0}static aSc(ba){return!!ba.Children&&0<ba.Children.length}static knj(ba,Aa){ba=ba.gyb()+"\r";for(let Pa=0;Pa<ba.length;Pa++){let ub=ba.charCodeAt(Pa);160===ub&&(ub=32);Aa=(Aa<<5>>>0)+Aa+ub}return Aa}static XN(ba){return!!ba&&!!ba.textAnchoringInfo&&ba.textAnchoringInfo.EndPos>ba.textAnchoringInfo.StartPos&&0<ba.textAnchoringInfo.TextBodyLength}static M8b(ba,Aa){if(!Oc.XN(ba))return null;
if(!Aa||1>Aa.nz().length)return Jb.a.J(509220243,805,Aa?10:15,"CommentUtilities::GetTextAnchoredCommentParagraph - CommentAnchorShape is null:{0}, else text anchored shape has no paragraphs",!Aa),null;let Pa=null,ub=null,Lb=null;ba.textAnchoringInfo.AnchoringShape&&(ba.textAnchoringInfo.AnchoringShape.TableCell?(Pa=T.a.Jf(ba.textAnchoringInfo.AnchoringShape.TableCell.RowId),ub=T.a.Jf(ba.textAnchoringInfo.AnchoringShape.TableCell.ColId)):ba.textAnchoringInfo.AnchoringShape.SmartArtNodeId&&(Lb=ba.textAnchoringInfo.AnchoringShape.SmartArtNodeId,
Lb.startsWith("{")||(Lb="{"+Lb),Lb.endsWith("}")||(Lb+="}")));let Mb=ba.textAnchoringInfo.StartPos;ba=ba.textAnchoringInfo.EndPos;let kd=0,Id=0;const ce=new Zb;Aa=Aa.nz();for(let jd=0;jd<Aa.length;jd++){const rd=Aa[jd],Wc=Pb.ParagraphReader.textLength(Object(xb.a)(Hc.AParagraphNode,rd));if(Pa&&ub){var Xe=rd.AL();if(!Xe||!Pa.equals(Xe.rowId)||!ub.equals(Xe.cellId))continue}else if(Lb&&(!rd.get_smartArtModelId()||Lb!==rd.get_smartArtModelId()))continue;if(!ce.isValid&&(Wc>Mb||ce.oV)){if(!ce.oV&&(ce.oV=
Object(xb.a)(Hc.AParagraphNode,rd),ce.startPos=Mb,!ce.oV))return null;Xe=jd===Aa.length-1||!!Lb&&Oc.a_j(Lb,Aa[jd+1])||!!Pa&&!!ub&&Oc.$Zj(Pa,ub,Aa[jd+1]);Xe=Wc<ba&&0<Wc&&Xe;if((Wc>=ba||Xe)&&!ce.N3){if(Xe&&(ba=Wc),ce.N3=Object(xb.a)(Hc.AParagraphNode,rd),ce.endPos=ba,!ce.N3)return null}else rd.equals(ce.oV)||ce.bdi(Object(xb.a)(Hc.AParagraphNode,rd))}kd+=Wc+1;Id=Oc.knj(rd,Id);ce.oV||(Mb-=Wc+1);ba-=Wc+1}ce.fwd=kd;ce.ewd=Id;return ce}static a_j(ba,Aa){return Aa.get_smartArtModelId()&&Aa.get_smartArtModelId()===
ba?!1:!0}static $Zj(ba,Aa,Pa){return(Pa=Pa.AL())&&ba.equals(Pa.rowId)&&Aa.equals(Pa.cellId)?!1:!0}static Guj(ba,Aa,Pa,ub){Pa=ub=-1;if(!ba)return Jb.a.J(509220242,805,15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Parent shape is null."),{returnValue:null,qMa:Pa,dEa:ub};let Lb=Object(xb.a)(5,Aa.Va.node);const Mb=Object(xb.a)(5,Aa.jf.node);if(!Lb||!Mb)return Jb.a.J(509220241,805,15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Start paragraph node is null:{0}; end paragraph node is null:{1}.",
!Lb,!Mb),{returnValue:null,qMa:Pa,dEa:ub};const kd=Aa.Va.wQa,Id=Aa.jf.vsb;var ce=Pb.ParagraphReader.textLength(Aa.Va.node);Aa=Pb.ParagraphReader.textLength(Aa.jf.node);if(0>kd||0>=Id||kd===Id&&Lb===Mb||kd>ce||Id>Aa)return Jb.a.J(509220240,805,50,"CommentUtilities::GetTextAnchorParagraphFromSelection - Invalid start/end character positions. StartCp:{0}; EndCp{1}; FirstCtxTextLength:{2}; LastCtxTextLenth:{3}.",kd,Id,ce,Aa),{returnValue:null,qMa:Pa,dEa:ub};ba=ba.nz();if(!ba)return Jb.a.J(509220239,805,
15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Parent shape paragraph node list is null."),{returnValue:null,qMa:Pa,dEa:ub};ce=0;for(const Xe of ba){if(Mb.get_smartArtModelId()){if(Xe.get_smartArtModelId()!==Mb.get_smartArtModelId())continue;Lb.get_smartArtModelId()!==Mb.get_smartArtModelId()&&(Lb=Xe)}if(Mb.Gs()){if(Xe.AL()!==Mb.AL())continue;Lb.AL()!==Mb.AL()&&(Lb=Xe)}Lb===Xe&&(Pa=kd+ce);Mb===Xe&&(ub=Id+ce);if(0<=Pa&&0<=ub)return{returnValue:Lb,qMa:Pa,dEa:ub};ce+=Xe.gyb().length+1}0<=
Pa&&-1===ub&&(Lb.get_smartArtModelId()||Lb.Gs())&&(ub=ce-1);return{returnValue:Lb,qMa:Pa,dEa:ub}}static get VKc(){return cc.a.gg||cc.a.NVa}static get eSc(){return!cc.a.Vi}}Object(h.a)(Oc,"CommentUtilities",null,[]);const md=(ba,Aa)=>{var Pa,ub;if(null===ba||void 0===ba||!ba.ReactionList)return ba;for(const Lb in ba.ReactionList)ba.ReactionList[Lb].ReactionInstances=null===(ub=null===(Pa=ba.ReactionList[Lb])||void 0===Pa?void 0:Pa.ReactionInstances)||void 0===ub?void 0:ub.filter(Mb=>Mb.User.UserId!=
Aa.UserId);ba.ReactionList=ba.ReactionList.filter(Lb=>0!=Lb.ReactionInstances.length);0==ba.ReactionList.length&&(ba.ReactionList=void 0);return ba},Ib=ba=>ba.ka("PPTOCommentReactionsUIEnabled");class ud{constructor(ba,Aa,Pa,ub,Lb,Mb,kd,Id,ce,Xe,jd,rd,Wc,wd,Fe,ak){this.Uad=!1;this.jb=ba;this.iIa=Aa;this.nwe=Pa;this.iek=ub;this.wb=Lb;this.Jb=Mb;this.Xed=kd;this.Gfk=Id;this.Bwa=ce;this.Vue=jd;this.Sgk=rd;this.Vva=Wc;this.Nbd=wd;this.yfk=Fe;this.ia=ak}beginDraftingAsync(ba){if(!ba)return new Promise((Pa,
ub)=>{ub(D.a.kt(-2130915327))});const Aa=nc.g8f(ba.sessionType);return void 0===Aa||null===Aa?new Promise((Pa,ub)=>{ub(D.a.kt(-2130915317))}):2===Aa&&ba.commentId===ud.rIb?new Promise((Pa,ub)=>{ub(D.a.kt(-2130915324))}):new Promise((Pa,ub)=>{D.a.u7a(this.wb,()=>{var Lb=this.jb.Dbe(),Mb=null;let kd=-1;Jb.a.J(512496833,805,50,"CommentAPI::BeginDraftingAsync - SessionType: {0}",Aa);try{switch(Aa){case 0:if(this.Nbd)try{kd=this.jb.a8f(!0)}catch(jd){Jb.a.J(512496832,801,10,"GetIndexForDraftCommentCardInsertion threw en exception{0}",
jd),kd=Lb.length}else kd=Lb.length;Mb=new Pc(Aa,ba,"");this.Uad=!0;break;case 1:if(!ba.threadId||!ba.threadId.length)throw D.a.kt(-2130915324);kd=ud.Vij(Lb,ba.threadId);if(-1===kd)throw D.a.kt(-2130915323);if(this.Jb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1)){var Id=ba.threadId;(new vb(this.Vue)).LSl(Id,ud.TGj(Lb,Id),ud.Bae(Lb,Id),Lb)}Mb=new Pc(Aa,ba,ba.threadId);break;case 2:if(!ba.commentId||!ba.commentId.length)throw D.a.kt(-2130915324);kd=ud.Bae(Lb,ba.commentId);
if(-1===kd)throw D.a.kt(-2130915323);Mb=new Pc(Aa,ba,ba.commentId);break;case 3:kd=ud.Bae(Lb,ba.threadId);Mb=new Pc(Aa,ba,ba.threadId);break;default:throw D.a.kt(-2130915322);}if(!Mb)throw D.a.kt(-2130915322);var ce=this.jb.mMj(Mb);if(ce)throw ce;}catch(jd){ub(jd);return}Lb=new wc;Mb=this.Jb.Ha("UserName");ce=this.Jb.Ha("387");Id=this.Jb.Ha("388");const Xe=zc.a("PPTPlumbEmailThroughCG")?Da.a.a$a(ce||""):"";ce=new nb(ce,Id,Mb,Xe,!0);Lb.author=ce;Lb.insertIndex=kd;Lb.authorName=Mb;Lb.authorIdentity=
new String;Pa(Lb)})})}commit(ba,Aa,Pa){if(!this.jb.aPc)throw Jb.a.J(512496803,805,10,"CommentAPI::Commit - CurrentCommentSession is null; CommentSessionEndReason:{0}",this.jb.EDi),D.a.kt(-2130915320);var ub=this.jb.aPc.UC;if(!ub)throw Jb.a.J(512496802,805,15,"CommentAPI::Commit - CurrentCommentSession.DraftConfiguration is null"),D.a.kt(-2130915320);const Lb=nc.g8f(ub.sessionType);if(void 0===Lb||null===Lb)throw D.a.kt(-2130915317);if(ba!==ub.draftId)throw D.a.kt(-2130915327);const Mb=this.Vva?Ub.e(T.a.create().toString()):
"";this.jb.QTf();switch(Lb){case 0:return Jb.a.J(512496801,805,50,"CommentAPI::Commit - Create Comment {0}",Mb),ub={},this.jb.i$k(Mb),ub.commentId=Mb,this.Uad=!1,this.jb.E5g=Mb,ud.$Jh(Pa),ud.ZJh(),this.createComment(Aa,ub,Pa);case 1:return Jb.a.J(512496800,805,50,"CommentAPI::Commit - Create Reply {0}:{1}",ub.threadId,Mb),ba={},ba.parentId=ub.threadId,ba.commentId=Mb,ud.$Jh(Pa),ud.ZJh(),this.createComment(Aa,ba,Pa);case 2:return Jb.a.J(512496799,805,50,"CommentAPI::Commit - Edit comment {0}",ub.commentId),
Pa={},Pa.commentBody=Aa,this.wNl(ub.commentId,Pa),ba;case 3:return Jb.a.J(512496798,805,50,"CommentAPI::Commit - Update Metadata {0}",ub.threadId),Ib(this.Jb)?this.xNl(ub.threadId,Pa):this.aNh(ub.threadId,Pa),ub.threadId;default:throw D.a.kt(-2130915322);}}endCommentSession(ba){Jb.a.J(512496797,805,50,"CommentAPI::EndCommentSession - DraftId: {0}",ba);this.jb.endCommentSession(ba,this.Uad?9:1);this.Uad=!1}createComment(ba,Aa,Pa){const ub=this.Xed.axd(ba,new Date);let Lb="";this.Vva&&(Lb=Rb.a.Xa(Aa.commentId)?
T.a.create().toString():Aa.commentId);let Mb=null;void 0!==Pa&&null!==Pa&&(Mb=this.Xed.dIl(Lb,Pa.Task,ba));ba=this.jb.rrd;if(Pa=Aa.parentId?null:this.jb.Huj())ba=this.jb.Mgl;this.iIa.ubi(Lb,ub.plainText,Aa.parentId,ba,this.jb.anchorNode,ub.z5g,Mb,Pa);return Rb.a.Xa(Lb)?ud.rIb:Lb}deleteComment(ba){if(ba===ud.rIb)throw D.a.kt(-2130915327);Jb.a.J(512496796,805,50,"CommentAPI::DeleteComment - {0}",ba);this.iIa.deleteComment(ba)}selectComment(ba){ba!==ud.rIb&&this.jb.Fga(ba,0,!1)}highlightComment(ba){ba!==
ud.rIb&&this.jb.vai(ba)}$Mh(ba,Aa,Pa){const ub=Array.clone(this.jb.Dbe());var Lb=null;for(var Mb of ub)if(Mb.commentId===ba){Lb=Mb;break}if(!Lb)throw Jb.a.J(512496795,805,10,"Comment ID not found, UI and model in a mismatched state."),D.a.kt(-2130915323);(Mb=e.AFrameworkApplication.userName)&&0<Mb.length&&Mb!==Lb.author.DisplayName&&Jb.a.J(512496794,805,50,"Author of comment being edited is not the current user (isAnonymous={0})",e.AFrameworkApplication.Anb||e.AFrameworkApplication.ZQ);Mb=new Date;
Lb=this.Xed.axd(Lb.commentBody,null).plainText;Aa=this.Xed.axd(Aa.commentBody,Mb);this.iIa.rXi(Aa.plainText,ba,Aa.z5g);Pa||Lb!==Aa.plainText||this.nwe.kvh(ub,this.jb.H6g,Array.clone(this.jb.N9f()))}wNl(ba,Aa){if(ba===ud.rIb)throw D.a.kt(-2130915327);Aa.commentBody&&(this.Jb.ka("896")?this.$Mh(ba,Aa,!0):D.a.u7a(this.wb,()=>{this.$Mh(ba,Aa,!1)}))}xNl(ba,Aa){if(!((null===Aa||void 0===Aa?0:Aa.Resolve)||(null===Aa||void 0===Aa?0:Aa.Reaction)))throw D.a.kt(-2130915327);(null===Aa||void 0===Aa?0:Aa.Resolve)&&
this.aNh(ba,Aa);(null===Aa||void 0===Aa?0:Aa.Reaction)&&this.zNl(ba,Aa)}aNh(ba,Aa){if(void 0===Aa.Resolve||null===Aa.Resolve)throw D.a.kt(-2130915327);const Pa=Aa.Resolve.isResolved;let ub=Pa?100:0;void 0!==Aa.Task&&null!==Aa.Task&&(ub=Aa.Task.completion);this.iIa.bNh(ba,Pa?1:0,ub);Pa&&this.jb.Pjl()}zNl(ba,Aa){if(Ib(this.Jb)){if(null==(null===Aa||void 0===Aa?void 0:Aa.Reaction))throw D.a.kt(-2130915327);a:{switch(Aa.Reaction.reactionType){case 1:var Pa="\ud83d\udc4d";break a;default:Jb.a.J(509220244,
805,50,"Unsupported reaction type")}Pa=void 0}void 0!==Pa&&(this.iIa.ANl(ba,Pa,Aa.Reaction.isActive),this.jb.NBk())}}setThreadResolvedState(ba,Aa){this.iIa.bNh(ba,Aa?1:0,Aa?100:0);Aa&&this.jb.WSf(ba)}selectFirstThreadInNextCommentContext(){this.jb.wgl()}selectLastThreadInPreviousCommentContext(){this.jb.zgl()}presentLinkToComment(ba){if(ba=this.iIa.usj(ba)){ba=JSON.stringify({["sId"]:ba.sid,["cId"]:ba.cid});var Aa={};Aa.nav=Mc.a(ba);Aa.mode="copy";Jb.a.J(512496792,805,50,"PresentLinkToComment: nav:{0}",
ba);this.ia.Ka($b.a.zta,2,Aa)}else Jb.a.J(512496793,805,50,"PresentLinkToComment failed")}registerForCommentEvents(ba){this.yfk.xlj().then(Aa=>{this.nwe.P3k(ba,this.jb.Dbe(),this.jb.H6g,this.jb.isReadOnly,this.jb.N9f(),Aa,this.Gfk.g4c)})}unregisterForCommentEvents(ba){this.nwe.H8e(ba)}registerForAction(ba,Aa){this.iek.zya(ba,Aa);this.jb.e2k()}unregisterForAction(){}loadThreads(){Jb.a.J(512496791,805,10,"LoadThreads is not supported on WAC")}checkAtMentionCapability(){return new Promise(ba=>{e.AFrameworkApplication.fa.ff(()=>
{this.Bwa?this.Bwa.atMentionsEnabledAsync().then(Aa=>{ba(Aa);return null}):ba(!1)})})}resolveSupported(){return this.Sgk}static Vij(ba,Aa){let Pa=!1;for(let ub=0;ub<ba.length;ub++){if(Pa&&ba[ub].commentId!==Aa&&ba[ub].parentId!==Aa)return ub;ba[ub].commentId===Aa&&(Pa=!0)}return Pa?ba.length:-1}static TGj(ba,Aa){let Pa=!1;for(let ub=0;ub<ba.length;ub++)if(ba[ub].commentId===Aa&&(Pa=!0),Pa&&ba[ub].parentId===Aa)return!0;return!1}static Bae(ba,Aa){for(let Pa=0;Pa<ba.length;Pa++)if(ba[Pa].commentId===
Aa)return Pa;return-1}static ZJh(){if(zc.a("CommentsFpsIsEnabled"))try{const ba=mb.a.instance.Ia("Common.ISystemInitiatedFeedback");ba&&ba.execute(Aa=>{Aa.logActivity("PPTWebCommitNewCommentActivity","CommentsFpsIsEnabledBRS")})}catch(ba){Jb.a.J(512496790,805,10,"Exception thrown while triggering PPTWebCommitNewCommentActivity. Exception: {0}",ba)}}static $Jh(ba){if(zc.a("CommentsTasksFpsIsEnabled")&&ba&&ba.Task)try{const Aa=mb.a.instance.Ia("Common.ISystemInitiatedFeedback");Aa&&Aa.execute(Pa=>{Pa.logActivity("PPTWebCommitTaskActivity",
"CommentsTasksFpsIsEnabledBRS")})}catch(Aa){Jb.a.J(512496789,805,10,"Exception thrown while triggering PPTWebCommitTaskActivity. Exception: {0}",Aa)}}}ud.rIb="temp-id";Object(h.a)(ud,"CommentAPI",null,[1119,1120]);var od=d(205),Ud=d(317),Ad=d(702);class be{constructor(ba,Aa,Pa){this.Nnc=ba;this.commentId=Aa;this.state=Pa}}Object(h.a)(be,"CommentTextAnchorToHighlight",null,[]);class uf extends Sys.EventArgs{constructor(ba){super();this.Dql=ba}}Object(h.a)(uf,"CommentsVisibilityOnSmartArtChangeEventArgs",
Sys.EventArgs,[]);class sd{constructor(ba,Aa,Pa,ub,Lb,Mb,kd,Id,ce,Xe){this.WYg=[];this.Pfd=null;this.Ctd=!1;if(!Xe)throw Error.argumentNull("viewElementEventNotifier");this.Kc=Aa;this.PFe=this.Yjc=!1;this.D6c=ba;this.Opk=Pa;this.Udb=this.rXa=null;this.vl=ub;this.pa=Lb;this.aXa=Mb;this.dHa=kd;this.ffa=Id;this.Bfk=ce;this.WJ=Xe;this.ffa.yUe(this.Bfk)}get IW(){return this.rXa&&this.rXa.isConnected?this.rXa:null}get ADh(){return this.Yjc}Ysc(ba,Aa,Pa=!1,ub=!1){const Lb=this.Opk.ZI(ba);if(Lb)switch(Aa){case 0:Lb.display(Pa,
ub);this.rXa=ba;break;case 1:Lb.activate();this.Udb=ba;break;case 2:Lb.dismiss();this.rXa=null;break;case 3:this.IW&&this.IW===ba&&this.d9a&&this.I6d(this.d9a,ba)?Lb.display(Oc.XN(this.d9a),ub):Lb.dismiss();this.Udb=null;break;case 4:Lb.gVi(Pa),this.rXa=ba}}Nsd(ba){if(this.Kc&&this.Kc.Jc)switch(ba){case 0:this.Kc.Jc.highlight();this.Yjc=!0;break;case 2:this.Kc.Jc.hMh();this.Yjc=!1;break;case 1:this.Kc.Jc.highlight();this.PFe=!0;break;case 3:this.Kc.Jc.hMh(),this.PFe=!1}}KPc(){this.D6c&&(this.Yjc?
this.Nsd(2):this.IW&&this.Ysc(this.IW,2),this.awb(null))}I6d(ba,Aa){if(!Oc.XN(ba))return!0;ba=this.vl.lz();return od.a.any(ba,Pa=>!Oc.XN(Pa)&&Pa.anchorShape===Aa.get_shapeId())}GYe(ba,Aa,Pa,ub=!1,Lb=!1){if(this.D6c&&ba&&(!ub||sd.mwb(this.vl.lz(),ba))){ub=this.T8(ba);var Mb=this.IW!==ub&&!!this.IW;Mb&&this.pa.I8(this.IW);this.KPc();if(ub){const kd=Oc.XN(ba);this.Udb===ub?this.I6d(ba,ub)?this.Ysc(ub,4,kd,kd&&Mb):this.rXa=ub:this.I6d(ba,ub)?this.Ysc(ub,0,kd,Pa&&Mb):this.rXa=ub;Aa=!!Aa&&Aa===ba.commentId;
(kd||Aa)&&Lb||this.fhl(ub,String.format(ResourceStrings.L_CommentAnchoringShapeSelection,ba.authorName,ba.dt.toDateString(),ba.dt.toLocaleTimeString()))}else this.Nsd(0),this.Kc&&this.Kc.Jc&&this.Kc.Jc.gd&&this.yrd(String.format(ResourceStrings.L_CommentAnchoringSlideCommentSelection,(this.Kc.Jc.gd.ue+1).toString(),this.Kc.Jc.gd.title));!Lb&&Mb&&this.pa.selectShape(this.IW,!0,!1);this.awb(null)}}uai(ba){if(this.D6c){var Aa=this.T8(ba);Aa?Oc.XN(ba)?this.Udb=Aa:this.Ysc(Aa,1):this.Nsd(1);this.awb(ba)}}mPc(){this.Udb&&
this.Ysc(this.Udb,3);this.PFe&&!this.Yjc&&this.Nsd(3);this.awb(null)}T8(ba){if(!ba)return null;try{return this.dHa.aUc(ba)}catch(Aa){return Jb.a.J(512496788,805,15,"GetAnchoredShapeForComment - Exception while getting anchored shape: {0}",Aa),null}}awb(ba){const Aa=[];var Pa=this.Udb;ba&&!Pa&&(Pa=this.IW);const ub=this.IW?this.IW:this.pa.fo();ub||ba&&Pa||this.YJh(Aa);let Lb=null;const Mb=[];var kd=!1;if(Oc.XN(ba)&&Pa&&0<Pa.nz().length&&(!this.d9a||ba.commentId!==this.d9a.commentId)){var Id=Oc.M8b(ba,
Pa);Id&&Id.isValid&&(kd=Ud.a.Jf("{"+ba.commentId+"}{1}"),Aa.push(new be(Id,kd,1)),kd=!0,Pa=this.dHa.rk(Pa))&&(Mb.push(Pa),(Pa=Pa.shapeNode)&&Pa.Wf&&(Lb=Pa))}if(this.Ctd||ub&&0<ub.nz().length)if(Pa=this.vl.lz())for(var ce of Pa){if(!Oc.XN(ce)||!this.Ctd&&ce.anchorShape!==ub.get_shapeId()||kd&&ce.commentId===ba.commentId)continue;Id=this.Ctd?this.T8(ce):ub;if(!Id)continue;let Xe=Oc.M8b(ce,Id);if(!Xe||!Xe.isValid)continue;let jd=5;(Pa=!!this.d9a&&ce.commentId===this.d9a.commentId)&&(jd=0);const rd=Ud.a.Jf("{"+
ce.commentId+"}{1}");Aa.push(new be(Xe,rd,jd));if(Id=this.dHa.rk(Id))Mb.push(Id),Id=Id.shapeNode,!Lb&&Id&&Pa&&Id.Wf&&(Lb=Id)}for(const Xe of this.WYg)!Xe||Array.contains(Mb,Xe)||Xe.shapeNode&&Xe.shapeNode.Wf||(Xe.xne=!1,Xe.hq||!Xe.io||Xe.ry||Xe.DPb());ba=null;for(const Xe of Mb)(ce=Xe.shapeNode)&&ce.Wf?(ba||(ba=ce),Lb||ub!==ce||(Lb=ce)):(Xe.xne=!0,Xe.io||(Jb.a.J(512496787,805,50,"DetermineTextAnchorHighlighting - Switched from FidelityView to EditView to display text anchors"),Xe.yvd()));Lb||this.pa.$L()||
!ba||(Lb=ba);this.WYg=Mb;this.WJ.CXk(new uf(Lb));this.YJh(Aa)}YJh(ba){ba=Object.assign(new Ad.a,{action:0,type:0,gea:ba,mjb:this.ffa.bdb?this.ffa.bdb.gea:null});this.ffa.esd(ba)}yrd(ba){this.aXa.vga(ba)}fhl(ba,Aa){this.aXa.vlh(ba,Aa)}BZe(ba){this.D6c=ba}get d9a(){return this.Pfd&&this.Pfd.cNb?this.Pfd.cNb.comment:null}static mwb(ba,Aa){if(ba)for(const Pa of ba)if(Aa.commentId===Pa.commentId)return!0;return!1}}Object(h.a)(sd,"CommentAnchoringHighlightsHelper",null,[]);var Ze=d(43);class Ke{constructor(ba,
Aa,Pa,ub,Lb,Mb,kd){this.oc=ba;this.ta=Aa;this.q8c=Pa;this.zO=ub;this.Wpk=Lb;this.Vb=Mb;this.wb=kd;this.wlf=0}U2a(ba,Aa){if(ba||1!==this.g4c)if(2>this.oc.Cj())this.Aai?this.l_e(5):this.l_e(1);else{const Pa=Ze.a.kk("UpdateNextPopulatedContextDetails",2);this.q8c.z7d((ub,Lb,Mb)=>{this.aDk(ub,Lb,Mb,Pa,Aa)},Pa)}}get g4c(){return this.wlf}aDk(ba,Aa,Pa,ub,Lb){let Mb=1;if(this.ta.Ba){const kd=this.ta.Ba.ue;let Id=!1,ce=!1,Xe=!1;Aa&&ba&&(ba=ba.ue,ba<kd?Id=!0:ba===kd?ce=!0:(Xe=!0,Pa||(Id=!0)));0<=Lb&&(Lb<kd?
Id=!0:Lb===kd?ce=!0:Xe=!0);Xe?Mb=Id||ce?3:2:Id?Mb=4:ce&&(Mb=5)}this.l_e(Mb);ub.finish();D.a.u7a(this.wb,()=>{this.Vb.updateCommandUI()})}l_e(ba){this.wlf=ba;this.Wpk.U2a(ba,1===this.Vb.mode)}get Aai(){return!!this.ta.Ba&&this.zO.tWi(this.ta.Ba)}}Object(h.a)(Ke,"CommentContextDetailsUpdateHelper",null,[1039]);var hf=d(39);class Xa{Qjl(ba){if(null===ba)throw Error.argumentNull("comment");ba.setValue(hf.a.commentId,"")}Mjl(ba,Aa){if(null===ba)throw Error.argumentNull("comment");ba.setValue(hf.a.jZd,
Aa)}Ojl(ba){if(null===ba)throw Error.argumentNull("comment");if(ba=Object(xb.a)(490,ba))ba.$ub=ResourceStrings.anonymousCommentAuthor}KNb(ba){if(null===ba)throw Error.argumentNull("comment");ba.setValue(hf.a.s2b,!0)}lwh(ba,Aa,Pa,ub){if(null===ba)throw Error.argumentNull("comment");if(ba=Object(xb.a)(490,ba))ba.authorName=Aa,ba.v0b=Pa,ba.BKc=ub}Sjl(ba,Aa){if(null===ba)throw Error.argumentNull("comment");ba.setValue(hf.a.t2b,Aa)}Rjl(ba,Aa){if(!ba)throw Error.argumentNull("comment");Aa=Ta.c(Aa);ba.setValue(hf.a.reactions,
Aa)}}Object(h.a)(Xa,"CommentEditor",null,[1118]);var Bb=d(32),mc=d(84),Qc=d(58);class td{constructor(){this.anchorShape=0;this.dt=this.commentId=this.Children=this.changesData=this.authorName=null;this.isUnread=!1;this.reactions=this.providerId=this.pos=null;this.status=0;this.userId=this.textAnchoringInfo=this.text=this.taskInfo=null}}Object(h.a)(td,"Comment",null,[]);var Md=d(294),Pd=d(916),Be=d(280),fe=d(30);class Mf{constructor(ba,Aa,Pa,ub,Lb,Mb,kd,Id,ce,Xe,jd,rd,Wc,wd,Fe){this.Oea=null;this.lDb=
ub;this.Eb=Lb;this.ta=Mb;this.HB=kd;this.b$=Id;this.Jb=ce;this.Rb=Xe;this.pa=jd;this.CE=rd;this.wve=Wc;this.jc=wd;this.AR=Fe;this.FR=ba;this.zfk=Pa;this.Rgk=0===Aa;this.GMh();this.lse()}dispose(){}get userName(){return this.Jb.appSettings.UserName}get userId(){return this.Jb.appSettings["387"]}get providerId(){return this.Jb.appSettings["388"]}get isTasksHistoryEnabled(){return this.Jb.ka("TasksHistoryEnabled")}get tac(){return this.Jb.ka("PPTOBlueDotsForComments")}get zpg(){return zc.a("Comments.LogTasksTelemetry")}get oEa(){return this.Jb.ka("SlideResizePerfImprovementEnabled")}addComment(ba,
Aa,Pa){this.Zwf("",ba,Aa,Pa,null,null,null,null)}ubi(ba,Aa,Pa,ub,Lb,Mb,kd,Id){this.Zwf(ba,Aa,Pa,ub,Lb,Mb,kd,Id)}Zwf(ba,Aa,Pa,ub,Lb,Mb,kd,Id){const ce=this.FR.Ii("UserAction","AddComment");e.AFrameworkApplication.fa.z4?this.axf(ba,Aa,Pa,ub,Lb,Mb,kd,Id,ce):this.Jb.ff(()=>{this.axf(ba,Aa,Pa,ub,Lb,Mb,kd,Id,ce)})}axf(ba,Aa,Pa,ub,Lb,Mb,kd,Id,ce){this.zfk.zvb().then(Xe=>{Mf.lth&&(Jb.a.J(512262931,805,15,"FirstCommentBeingAdded - IsBlank:{0}; CreateNewCommentPolicyEnabled:{1}",this.Rgk,Xe),this.CE.Hak(Xe),
Mf.lth=!1);this.tbi(ba,Aa,Pa,ub,Lb,Mb,kd,Id);ce&&ce.stop();return Xe}).catch(Xe=>{Jb.a.J(512262930,805,10,JSON.stringify(Xe));throw Error.create("CreateNewEnabledAsync or AddCommentOnFullAppSettingsReady failed");})}tbi(ba,Aa,Pa,ub,Lb,Mb,kd,Id){if(this.IAb()){var ce=!1,Xe=0,jd=0;ub&&(ce=!0,Xe=ub.x,jd=ub.y);ub=this.Eb.je(15);try{var rd=this.Oea;ub.hc(rd);const Wc=Bb.GraphIterator.pb(rd),wd=Object(xb.a)(mc.a,this.lDb.createInstance(1074135127));this.b$.KNb(wd);this.b$.Qjl(wd);this.b$.Mjl(wd,ba);rd=
null;const Fe=Object(xb.a)(490,wd);if(Fe){if(Fe.bvb=ce)Fe.eda=Object.assign(new Pd.a,{X:Xe,Y:jd});Fe.MIh=this.wve.rvj();Fe.wKc=Mb;if(rd=Object(xb.a)(4,Lb))Fe.p2b=rd.get_shapeId();Pa&&(Fe.cya=Pa);kd&&(Fe.taskInfo=kd);Id&&(Fe.textAnchoringInfo=Id);Fe.Fsa=Aa}let ak=this.userId;Lb=!ak;const tj=!this.providerId,bh=!this.userName;(Lb||tj)&&Jb.a.J(512262928,805,Lb&&!tj?15:10,"CommentEditor UserID null: {0}; ProviderID null: {1} UserName null: {2};",Lb,tj,bh);zc.a("Comments.UseNameInPlaceOfUserId")&&Lb&&
!tj&&(ak=bh?ResourceStrings.anonymousCommentAuthor:this.userName);this.b$.lwh(wd,this.userName,ak,this.providerId);bh&&this.b$.Ojl(wd);Wc.Hl(wd,1);Jb.a.J(512262927,805,50,"CommentManager::AddCommentOnFullAppSettingsReady - Added comment: {0}; Has Task: {1}; Is Text Anchored: {2}, Is Shape Anchored: {3}",ba,!!kd,!!Id,!!rd)}finally{ub&&ub.dispose()}this.Y$j(ba,Pa,Aa,Id,kd)}else Jb.a.J(512262929,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - CommentContentNode is unavailable")}Y$j(ba,Aa,
Pa,ub,Lb){this.zpg?Aa?(Aa=this.Yta(Aa))?(Aa=this.Tta(Aa))?this.CE.Z$j(ba,Pa.length-1,!!ub,Aa.taskInfo,Lb):Jb.a.J(512262925,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - Parent comment not found"):Jb.a.J(512262926,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - Parent comment node not found"):this.CE.$$j(ba,Pa.length-1,!!ub,!!Lb):this.CE.ise(ba,Pa.length-1,!!ub,!!Lb)}deleteComment(ba){this.CE.Vck();if(this.IAb()){var Aa=this.Eb.xd(15);try{Aa.hc(this.Oea),this.R2d(ba,this.Oea),
Aa.fd=fe.a.deleteComment}finally{Aa&&Aa.dispose()}}else Jb.a.J(512262924,805,10,"CommentManager::DeleteComment - CommentContentNode is unavailable")}R2d(ba,Aa){zc.a("IsDeselectShapeOnDeleteCommentEnabled")&&this.pa.S_()&&(Jb.a.J(512262923,805,15,"CommentManager::DeleteCommentHelper - Removing shape selection in text edit while deleting comment"),this.pa.nh());const Pa=this.ddj(ba,Aa);if(Pa&&0<Pa.count){this.b$.KNb(Aa);for(let ub of Pa)Aa=Bb.GraphIterator.pb(ub),Aa.sc(39),Aa.Ni();Jb.a.J(512262922,
805,50,"CommentManager::DeleteCommentHelper - Deleted comment {0}",ba)}else Jb.a.J(512262921,805,10,"CommentManager::DeleteCommentHelper - Failed to find comment node {0}",ba);this.CE.v1k()}sSa(){const ba=Date.now();this.CE.Lak();const Aa=this.lz();if(Aa){var Pa=this.Eb.xd(15);try{Pa.hc(this.ta.Ba);for(const ub of Aa)this.R2d(ub.commentId,this.Oea);Pa.fd=fe.a.sSa}finally{Pa&&Pa.dispose()}Jb.a.J(512262919,805,50,"CommentManager::DeleteAllCommentsInSlide - Time taken: {0} ms",Date.now()-ba)}else Jb.a.J(512262920,
805,10,"CommentManager::DeleteAllCommentsInSlide - Failed to retrieve comments of active slide")}g4b(ba){const Aa=Date.now();ba?this.CE.Mak():this.CE.Kak();const Pa=this.ta.presentation;if(Pa){var ub=Pa.slides;if(ub){var Lb=this.Eb.xd(15);try{Lb.hc(Pa);for(const Mb of ub){const kd=Object(xb.a)(118,Mb);if(!kd||!kd.qE()){Jb.a.J(512262918,805,10,"CommentManager::DeleteAllComments - slideNode not found or has no comments node: {0}",kd);continue}const Id=Bb.GraphIterator.pb(kd).Cb(16);for(const ce of this.Uta(kd.qE()))(ba?
1===ce.status:1)&&this.R2d(ce.commentId,Id)}Lb.fd=ba?fe.a.Vvb:fe.a.Uvb}finally{Lb&&Lb.dispose()}Jb.a.J(512262917,805,50,"CommentManager::DeleteAllComments - Time taken: {0} ms - fOnlyDeleteResolved: {1}",Date.now()-Aa,ba)}}}editComment(ba,Aa){this.EVf(ba,Aa,null)}rXi(ba,Aa,Pa){this.EVf(ba,Aa,Pa)}EVf(ba,Aa,Pa){if(this.IAb()){var ub=this.Yta(Aa);if(ub){const Lb=this.Eb.je(15);try{Lb.hc(ub);this.b$.KNb(ub);const Mb=Object(xb.a)(490,ub);Mb&&(Mb.Fsa=ba,Mb.wKc=Pa)}finally{Lb&&Lb.dispose()}Jb.a.J(512262915,
805,50,"CommentManager::EditCommentInternal - Edited comment {0}",Aa)}else Jb.a.J(512262914,805,10,"CommentManager::EditCommentInternal - Failed to find comment node {0}",Aa);this.CE.Qak()}else Jb.a.J(512262916,805,10,"CommentManager::EditCommentInternal - CommentContentNode is unavailable")}cIb(ba,Aa){if(this.IAb()){var Pa=this.Yta(ba);if(Pa){if(null===Aa)throw Error.argumentNull("pos");const ub=this.Eb.je(15);try{ub.hc(Pa),this.b$.KNb(Pa),Object(xb.a)(490,Pa).eda=Object.assign(new Pd.a,{X:Aa.x,
Y:Aa.y})}finally{ub&&ub.dispose()}Jb.a.J(512262912,805,50,"CommentManager::MoveComment - Moved comment {0}",ba)}else Jb.a.J(512262883,805,10,"CommentManager::MoveComment - Failed to find comment node {0}",ba);this.CE.cck(ba)}else Jb.a.J(512262913,805,10,"CommentManager::MoveComment - CommentContentNode is unavailable")}ANl(ba,Aa,Pa){this.Jb.ff(()=>{this.BNl(ba,Aa,Pa)})}BNl(ba,Aa,Pa){if(this.IAb()){var ub=this.Yta(ba);if(ub){var Lb=this.Eb.je(15);try{Lb.hc(ub);this.b$.KNb(ub);const Xe=Object(xb.a)(490,
ub);if(Xe){var Mb=Xe.reactions,kd={DisplayName:this.userName,Email:void 0,FullName:this.userName,ProviderId:this.providerId,UserId:this.userId};if(Pa){let jd;jd=md(Mb,kd);a:{ba=jd;var Id;let rd={Time:new Date,User:kd};if(ba&&ba.ReactionList){for(const [Wc,wd]of ba.ReactionList.entries())if(wd.Type===Aa){null===(Id=ba.ReactionList[Wc].ReactionInstances)||void 0===Id?void 0:Id.push(rd);jd=ba;break a}ba.ReactionList.push({Type:Aa,ReactionInstances:[rd]})}else ba={ReactionList:[{Type:Aa,ReactionInstances:[rd]}]};
jd=ba}var ce=jd}else ce=md(Mb,kd);this.b$.Rjl(ub,ce)}else Jb.a.J(509215366,805,10,"CommentManager::updateCommentReactionsInternal - Failed to cast to comment node {0}",ba)}finally{null===Lb||void 0===Lb?void 0:Lb.dispose()}}else Jb.a.J(509219337,805,10,"CommentManager::updateCommentReactionsInternal - Failed to find comment node {0}",ba)}else Jb.a.J(509613472,805,10,"CommentManager::updateCommentReactionsInternal - CommentContentNode is unavailable")}bNh(ba,Aa,Pa){if(this.IAb()){var ub=this.Yta(ba);
if(ub){const Lb=this.Eb.je(15);try{Lb.hc(ub),this.b$.KNb(ub),this.b$.Sjl(ub,Aa),Object(xb.a)(490,ub).Cmb=Pa,this.isTasksHistoryEnabled&&this.b$.lwh(ub,this.userName,this.userId,this.providerId)}finally{Lb&&Lb.dispose()}if(this.zpg){Pa=this.Tta(ub);if(!Pa){Jb.a.J(512262881,805,10,"CommentManager::UpdateCommentStatus - Failed to find comment");return}1===Aa?this.CE.Eck(!!Pa.taskInfo):0===Aa&&this.CE.vdk(!!Pa.taskInfo)}else 1===Aa&&this.CE.Fck();Jb.a.J(512262880,805,50,"CommentManager::UpdateCommentStatus - Updated comment status {0}:{1}",
ba,Aa)}else Jb.a.J(512262879,805,10,"CommentManager::UpdateCommentStatus - Failed to find comment node {0}",ba)}else Jb.a.J(512262882,805,10,"CommentManager::UpdateCommentStatus - CommentContentNode is unavailable")}lz(){return this.Uta(this.Oea)}Uta(ba){const Aa=[];if(!ba||39!==ba.type)return Aa;ba=Bb.GraphIterator.pb(ba);for(var Pa=ba.Oi();Pa;){if(40===Pa.type){const ub=Object(xb.a)(490,Pa).cya;Pa=this.Tta(Pa);if(ub)for(const Lb of Aa)Lb.commentId===ub&&(Lb.Children||(Lb.Children=[]),Lb.Children.push(Pa));
else Aa.push(Pa)}Pa=ba.np()}return Aa}GMh(){const ba=this.ta.Ba;this.Oea=ba?Bb.GraphIterator.pb(ba).Cb(16):null}Uhj(){if(!this.Oea)return!1;const ba=Bb.GraphIterator.pb(this.Oea);if(this.HB.r5f(this.Oea))return!0;let Aa=ba.Oi();for(;Aa;){if(this.HB.r5f(Aa))return!0;Aa=ba.np()}return!1}D4i(ba,Aa){return this.W_f(ba,Aa,!1)}P4i(ba,Aa){return this.W_f(ba,Aa,!0)}W_f(ba,Aa,Pa){if(!ba)return null;if(ba=ba.qE()){ba=this.Rb.Lc(ba);let ub=Pa?ba.c9b():ba.Oi();for(;ub;){if(!(this.HB.F2c(ub)||Aa&&0!==this.HB.FUc(ub)))return this.Tta(ub);
ub=Pa?ba.qua():ba.np()}}return null}tWi(ba){return ba?(ba=ba.qE())?!!this.Rb.Lc(ba).Oi():!1:!1}GUc(ba){if(!ba)return 0;var Aa=ba.qE();ba=0;if(Aa){Aa=this.Rb.Lc(Aa);let Pa=Aa.Oi();for(;Pa;)this.HB.F2c(Pa)||ba++,Pa=Aa.np()}return ba}IAb(){return!!this.Oea&&this.Oea.isConnected}ddj(ba,Aa){Aa=Bb.GraphIterator.pb(Aa);var Pa=Aa.Oi();const ub=new m.a;for(;Pa;){const Lb=this.HB.DUc(Pa),Mb=Object(xb.a)(490,Pa).cya;ba!==Lb&&ba!==Mb||ub.add(Pa);Pa=Aa.np()}return ub}Yta(ba){const Aa=Bb.GraphIterator.pb(this.Oea);
let Pa=Aa.Oi();for(;Pa;){const ub=this.HB.DUc(Pa);if(ba===ub)return Pa;Pa=Aa.np()}return null}vce(ba){ba=this.Yta(ba);if(!ba)return null;const Aa=Object(xb.a)(490,ba).cya;return Rb.a.Xa(Aa)?ba:this.Yta(Aa)}Tta(ba){if(zc.a("GetCommentFromGraphNodeNullSafety")){var Aa=Object(xb.a)(490,ba);if(!Aa)return null;var Pa=new td;Pa.dt=Aa.E3b;Pa.text=Aa.Fsa;Pa.status=this.HB.FUc(ba);Pa.userId=Aa.v0b;Pa.commentId=this.HB.DUc(ba);Pa.authorName=Aa.authorName;Pa.providerId=Aa.BKc;Pa.anchorShape=Aa.p2b;Pa.pos=Object.assign(new Md.a,
{X:Aa.eda.X,Y:Aa.eda.Y});Pa.taskInfo=Aa.taskInfo;Pa.textAnchoringInfo=Aa.textAnchoringInfo;this.tac&&(Pa.changesData=Aa.changesData,Pa.isUnread=this.AR.instance&&this.AR.instance.Mmg(Aa));Ib(this.Jb)&&(Pa.reactions=Aa.reactions);return Pa}if(ba){Aa=this.HB.DUc(ba);Pa=new td;const ub=Object(xb.a)(490,ba);if(ub){Pa.dt=ub.E3b;Pa.anchorShape=ub.p2b;const Lb=ub.eda;Pa.pos=Object.assign(new Md.a,{X:Lb.X,Y:Lb.Y});Pa.text=ub.Fsa;Pa.authorName=ub.authorName;Pa.userId=ub.v0b;Pa.providerId=ub.BKc;this.tac&&
(Pa.changesData=ub.changesData,Pa.isUnread=this.AR.instance&&this.AR.instance.Mmg(ub));Ib(this.Jb)&&(Pa.reactions=ub.reactions)}Pa.status=this.HB.FUc(ba);Pa.commentId=Aa;Pa.taskInfo=Object(xb.a)(490,ub).taskInfo;Pa.textAnchoringInfo=Object(xb.a)(490,ub).textAnchoringInfo;return Pa}return null}O$a(ba){if(!ba)return[];const Aa=this.Uta(ba.qE());if(!Aa||this.oEa&&!Aa.length){if(!Aa)throw Error.create("GetCommentsSortedByPositionForSlide - Comments should not be null");return Aa}Aa.sort((Pa,ub)=>{var Lb=
this.jc.Qce(ba,Pa.anchorShape);Lb=Lb?Lb.kC:new Qc.a(0,0);var Mb=this.jc.Qce(ba,ub.anchorShape);Mb=Mb?Mb.kC:new Qc.a(0,0);Lb.y+=Pa.pos.Y;Mb.y+=ub.pos.Y;Lb.x+=Pa.pos.X;Mb.x+=ub.pos.X;let kd=Lb.y-Mb.y;kd||(kd=Lb.x-Mb.x)||(kd=+Pa.dt-+ub.dt);return kd});return Aa}usj(ba){var Aa=this.ta.presentation;if(!Aa)return null;Aa=Aa.slides;if(!Aa)return null;for(const Pa of Aa)if(Aa=Object(xb.a)(Be.a,Pa))for(const ub of this.Uta(Aa.qE())){if(ba===ub.commentId)return Pa;if(ub.Children)for(const Lb of ub.Children)if(ba===
Lb.commentId)return Pa}return null}lse(){let ba=0,Aa=0;var Pa=this.ta.presentation;if(Pa){var ub=Pa.slides;if(ub){Pa=new m.a;for(const Lb of ub)if((ub=Object(xb.a)(Be.a,Lb))&&ub.qE())for(const Mb of this.Uta(ub.qE()))Oc.XN(Mb)?Aa+=1:Mb.textAnchoringInfo&&Pa.add(Mb.commentId),ba+=1;this.CE.lse(ba,Aa,Pa)}}}}Mf.lth=!0;Object(h.a)(Mf,"CommentManager",null,[1116,1117,107]);var Bd=d(133);class Rc{constructor(ba,Aa,Pa,ub){this.zO=ba;this.Kc=Aa;this.Gb=Pa;this.zc=ub}Arj(ba){if(null===ba)throw Error.argumentNull("comment");
if(ba=this.aUc(ba))if(ba=this.rk(ba))return ba.va.va;return null}paj(ba){if(null===ba)throw Error.argumentNull("comment");if(ba=this.aUc(ba)){if(ba.vd){var Aa=this.zc.ZN(ba);if(!Aa)return Jb.a.J(595133523,805,10,"GetAnchorBoundingRegion: Shape {0} is table shape but has no table node",ba.get_shapeId()),null;Aa=Aa.qc(this.Gb.Na);return Aa&&Aa.htmlElement?Bd.a.Lda(new Sys.UI.Bounds(Aa.htmlElement.clientLeft,Aa.htmlElement.clientTop,Aa.htmlElement.clientWidth,Aa.htmlElement.clientHeight)):(Jb.a.J(595133521,
805,10,"GetAnchorBoundingRegion: cannot find table view element for table shape {0}",ba.get_shapeId()),null)}if(ba=this.rk(ba))return ba=ba.va.va,Bd.a.Lda(new Sys.UI.Bounds(ba.clientLeft,ba.clientTop,ba.clientWidth,ba.clientHeight))}return null}aUc(ba){if(null===ba)throw Error.argumentNull("comment");if(!ba.anchorShape)return null;ba=this.zO.vce(ba.commentId);ba=this.zO.Tta(ba);if(!ba)return null;const Aa=this.Kc.Jc?this.Kc.Jc.gd:null;return Aa?Aa.YC(ba.anchorShape):(Jb.a.J(557090388,805,50,"ActiveSlide is null"),
null)}qaj(ba){if(null===ba)throw Error.argumentNull("comment");if(!ba.anchorShape)return 0;if(ba=this.aUc(ba))if(ba=this.rk(ba))return ba.rotation;return 0}rk(ba){if(null===ba)throw Error.argumentNull("shapeNode");return Object(xb.a)(119,ba.qc(this.Gb.Na))}}Object(h.a)(Rc,"CommentMarkerAnchorHelper",null,[1033]);var Gf=d(589),Nf=d(116);class Oa{constructor(ba,Aa,Pa){this.h$=ba;this.Kc=Aa;this.Tue=Pa}sWi(ba){const Aa=Object(xb.a)(490,this.Tue.Yta(ba.commentId));if(!Aa)throw r.ULS.sendTraceTag(595203538,
805,10,"There is no graph node for comment {0}",ba.commentId),Error.invalidOperation("GraphNodeNotFoundForComment");return!!Aa.eda}Apj(ba,Aa){if(!ba)throw Error.argumentNull("commentMarkerViewElement");if(!Aa)throw Error.argumentNull("comment");if(!this.Tue.Yta(Aa.commentId))return r.ULS.sendTraceTag(595141910,805,10,"GetRenderingPosition: There is no graph node for comment {0}",Aa.commentId),new Qc.a(0,Number.MIN_VALUE);const Pa=ba.Jn;ba=ba.Nkd;if(!this.sWi(Aa)||!Aa.pos.X&&!Aa.pos.Y){if(Pa)return Aa=
new Qc.a(Pa.fc-Pa.ic-Oa.Gqd.width-Oa.hth.width,Oa.hth.height),Oa.Ofg(Aa,Pa,ba),Aa;if(this.Kc.Jc&&this.Kc.Jc.gC)return new Qc.a(this.Kc.Jc.gC.clientWidth-Oa.Gqd.width,0);r.ULS.sendTraceTag(595203537,805,10,"m_activeSlideViewManager.ActiveSlideView || m_activeSlideViewManager.ActiveSlideView.ScreenBoundsElement is null");return new Qc.a(0,0)}Aa=new Qc.a(this.h$.Ne(Aa.pos.X,0),this.h$.Ne(Aa.pos.Y,1));Aa=new Qc.a(Aa._x-Oa.U0a._x,Aa._y-Oa.U0a._y);Pa&&(Aa._x=Math.max(0,Aa._x),Aa._y=Math.max(0,Aa._y),Aa._x=
Math.min(Aa._x,Pa.fc-Pa.ic-Oa.Gqd.width),Aa._y=Math.min(Aa._y,Pa.Zb-Pa.kc-Oa.Gqd.height),Oa.Ofg(Aa,Pa,ba));return Aa}yNl(ba,Aa){var Pa=new Qc.a(ba.element.offsetLeft,ba.element.offsetTop);Pa=new Qc.a(Pa._x+Oa.U0a._x,Pa._y+Oa.U0a._y);const ub=ba.Jn;ub&&ba.Nkd%360&&Oa.uCf(Pa,0-ba.Nkd,ub.Zf());Aa.pos.X=this.h$.gf(Pa._x,0);Aa.pos.Y=this.h$.gf(Pa._y,1);this.Tue.cIb(Aa.commentId,new Qc.a(Aa.pos.X,Aa.pos.Y))}static Ofg(ba,Aa,Pa){if(Aa&&Pa%360){var ub=new Qc.a(ba._x+Oa.U0a._x,ba._y+Oa.U0a._y);Oa.uCf(ub,Pa,
Aa.Zf());ba.update(ub._x-Oa.U0a._x,ub._y-Oa.U0a._y)}}static uCf(ba,Aa,Pa){ba.IM(0-Pa._x,0-Pa._y);Aa=Gf.a.L2d(Aa);ba.update(ba._x*Math.cos(Aa)-ba._y*Math.sin(Aa)+Pa._x,ba._x*Math.sin(Aa)+ba._y*Math.cos(Aa)+Pa._y)}}Oa.Gqd=new Nf.a(20,20);Oa.hth=new Nf.a(4,4);Oa.U0a=new Qc.a(4,20);Object(h.a)(Oa,"CommentMarkerPositionHelper",null,[1034]);var cb=d(139),Ic=d(78),qd=d(49);class le{constructor(ba,Aa){this.cJa=this.sIa=this.EDe=null;this.Fec=ba;this.Uq=Aa}Mv(){return!0}Yu(ba){if(!ba)return!1;this.cJa=this.Fec.element.style;
this.EDe=new Qc.a(ba.clientPoint.x,ba.clientPoint.y);this.sIa=new Qc.a(parseInt(this.cJa.left),parseInt(this.cJa.top));this.Rw(ba);return!0}Rw(ba){if(!ba)return!1;ba=this.q9f(new Qc.a(ba.clientPoint.x,ba.clientPoint.y),this.EDe);this.cJa.left=qd.a.Pc(this.sIa._x+ba._x);this.cJa.top=qd.a.Pc(this.sIa._y+ba._y);return!0}to(ba){if(ba){ba=this.q9f(new Qc.a(ba.clientPoint.x,ba.clientPoint.y),this.EDe);var Aa=this.sIa._x+ba._x,Pa=this.sIa._y+ba._y,ub=this.Fec.Jn;ub&&(Aa=Math.max(ub.ic,Aa),Aa=Math.min(ub.fc-
this.Fec.element.clientWidth,Aa),Pa=Math.max(ub.kc,Pa),Pa=Math.min(ub.Zb-this.Fec.element.clientHeight,Pa),ba._x=Aa-this.sIa._x,ba._y=Pa-this.sIa._y);this.cJa.left=qd.a.Pc(Aa);this.cJa.top=qd.a.Pc(Pa);this.Fec.G4g(ba)}}Au(){this.cJa.left=qd.a.Pc(this.sIa._x);this.cJa.top=qd.a.Pc(this.sIa._y)}q9f(ba,Aa){ba=Qc.a.rV(ba,Aa);return new Qc.a(this.Uq.om(ba.x),this.Uq.om(ba.y))}}Object(h.a)(le,"CommentMarkerDragAdapter",null,[274]);class yb{constructor(ba,Aa,Pa,ub,Lb,Mb,kd,Id){this.k$=null;this.AXa=this.BXa=
!1;if(!Aa)throw Error.argumentNull("parentElement");this.SDb=Id;this.a$=ba;this.pq=Pa;this.Fma=ub;this.lD=Lb;this.c8c=kd;this.Lm=document.createElement("div");this.Lm.className=Oc.aSc(ba)?this.lD.X2g:this.lD.W2g;this.Lm.title=ResourceStrings.L_CommentMarkerTooltip;this.Lm.style.display=this.c8c||this.SDb?"none":"block";this.Lm.setAttribute("data-pptcommentid",String.format("{0}",ba.commentId));this.uA=document.createElement("img");this.uA.alt=ResourceStrings.L_CommentMarkerTooltip;this.uA.src=Pa.frame.qk(Pa.frame.mT+
".png");this.uA.setAttribute(cb.a.hf,cb.a.Ju);this.Lm.appendChild(this.uA);this.P2a();this.frame.Rc.rb(fb.a.click,this.Lm,Object(qa.a)(this,this.JC,"clickHandler"));Oc.eSc&&(ac.a.addHandler(this.Lm,fb.a.qq,Object(qa.a)(this,this.yxa,"mouseOverHandler")),ac.a.addHandler(this.Lm,fb.a.Vs,Object(qa.a)(this,this.Blc,"mouseOutHandler")));Oc.VKc&&ac.a.addHandler(this.uA,fb.a.mouseDown,Object(qa.a)(this,this.fpc,"preventNativeDragMouseDownHandler"));Aa.appendChild(this.Lm);Mb||this.F0d()}dispose(){this.uA&&
(Oc.VKc&&ac.a.removeHandler(this.uA,fb.a.mouseDown,Object(qa.a)(this,this.fpc,"preventNativeDragMouseDownHandler")),this.frame.Rc.Bb(fb.a.click,this.Lm,Object(qa.a)(this,this.JC,"clickHandler")),this.uA.parentNode&&this.uA.parentNode.removeChild(this.uA),this.uA=null);this.Lm&&(Oc.eSc&&(ac.a.removeHandler(this.Lm,fb.a.qq,Object(qa.a)(this,this.yxa,"mouseOverHandler")),ac.a.removeHandler(this.Lm,fb.a.Vs,Object(qa.a)(this,this.Blc,"mouseOutHandler"))),this.Fma&&(this.Fma.YXd(),this.Fma.oF(this.Lm,this.k$)),
this.Lm.parentNode&&this.Lm.parentNode.removeChild(this.Lm));this.pq=this.a$=null}get comment(){return this.a$}get element(){return this.Lm}get frame(){return this.pq.frame}F0d(){this.Fma&&(this.k$=new le(this,mb.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion")),this.Fma.hK(this.Lm,this.k$))}updatePosition(ba){this.Lm.style.left=qd.a.Pc(ba._x-(this.pq.isRightToLeft?this.lD.kIe:0));this.Lm.style.top=qd.a.Pc(ba._y)}G4g(ba){this.pq.cIb(this.a$,ba)}select(ba){this.BXa=ba;this.P2a()}activate(ba){this.AXa=
ba;this.P2a()}hCh(){}setVisibility(ba){this.Lm.style.display=ba&&!this.SDb?"block":"none"}P2a(){this.SDb||(this.uA.className=Oc.aSc(this.a$)?this.BXa?Ic.getImageClassWithCluster(this.frame.mT,this.lD.$2g):this.AXa?Ic.getImageClassWithCluster(this.frame.mT,this.lD.Y2g):Ic.getImageClassWithCluster(this.frame.mT,this.lD.Z2g):this.BXa?Ic.getImageClassWithCluster(this.frame.mT,this.lD.V2g):this.AXa?Ic.getImageClassWithCluster(this.frame.mT,this.lD.jIe):Ic.getImageClassWithCluster(this.frame.mT,this.lD.flc))}get Jn(){return null}get Nkd(){return 0}JC(ba){if(ba.LA!==
Sys.UI.MouseButton.leftButton)return!1;this.frame.selectComment(this.a$,null,!1,!0,ba.ng,1,!1);ba=ba.mc;ba.preventDefault();ba.stopPropagation();return!0}yxa(){this.frame.tsb(this.a$,1)}Blc(){this.frame.tsb(null,1)}fpc(ba){ba.preventDefault()}}Object(h.a)(yb,"LegacyCommentMarkerViewElement",null,[1133]);var ef=d(99),Cb=d(650);class oc{constructor(ba,Aa,Pa,ub,Lb,Mb,kd,Id,ce){this.k$=null;this.kDg=this.AXa=this.BXa=!1;if(!Aa)throw Error.argumentNull("parentElement");this.a$=ba;this.pq=Pa;this.Fma=ub;
this.lD=Lb;this.dHa=Mb;this.B6c=kd;this.c8c=ce;this.Lm=document.createElement("div");this.Lm.className=Oc.aSc(ba)?this.lD.X2g:this.lD.W2g;Sys.UI.DomElement.addCssClass(this.Lm,"CommentMarker");this.Lm.title=ResourceStrings.L_CommentMarkerTooltip;this.Lm.style.display="none";this.Lm.setAttribute("data-pptcommentid",String.format("{0}",ba.commentId));this.uA=document.createElement("img");this.uA.alt=ResourceStrings.L_CommentMarkerTooltip;this.uA.src=Pa.frame.qk(Pa.frame.mT+".png");this.uA.setAttribute(cb.a.hf,
cb.a.Ju);this.Lm.appendChild(this.uA);this.P2a();this.frame.Rc.rb(fb.a.click,this.Lm,Object(qa.a)(this,this.JC,"clickHandler"));Oc.eSc&&(ac.a.addHandler(this.Lm,fb.a.qq,Object(qa.a)(this,this.yxa,"mouseOverHandler")),ac.a.addHandler(this.Lm,fb.a.Vs,Object(qa.a)(this,this.Blc,"mouseOutHandler")));Oc.VKc&&ac.a.addHandler(this.uA,fb.a.mouseDown,Object(qa.a)(this,this.fpc,"preventNativeDragMouseDownHandler"));Aa.appendChild(this.Lm);Id||this.F0d()}dispose(){this.uA&&(Oc.VKc&&ac.a.removeHandler(this.uA,
fb.a.mouseDown,Object(qa.a)(this,this.fpc,"preventNativeDragMouseDownHandler")),this.frame.Rc.Bb(fb.a.click,this.Lm,Object(qa.a)(this,this.JC,"clickHandler")),this.uA.parentNode&&this.uA.parentNode.removeChild(this.uA),this.uA=null);this.Lm&&(Oc.eSc&&(ac.a.removeHandler(this.Lm,fb.a.qq,Object(qa.a)(this,this.yxa,"mouseOverHandler")),ac.a.removeHandler(this.Lm,fb.a.Vs,Object(qa.a)(this,this.Blc,"mouseOutHandler"))),this.Fma&&(this.Fma.YXd(),this.Fma.oF(this.Lm,this.k$)),this.Lm.parentNode&&this.Lm.parentNode.removeChild(this.Lm));
this.pq=this.a$=null}get comment(){return this.a$}get element(){return this.Lm}get frame(){return this.pq.frame}F0d(){this.Fma&&(this.k$=new le(this,mb.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion")),this.Fma.hK(this.Lm,this.k$))}updatePosition(){const ba=this.B6c.Apj(this,this.comment);this.Lm.style.left=ba._x+"px";this.Lm.style.top=ba._y+"px"}G4g(){this.B6c.yNl(this,this.comment)}select(ba){this.BXa=ba;this.P2a();this.onVisibilityChange()}activate(ba){this.AXa=ba;this.P2a();this.onVisibilityChange()}hCh(ba){this.kDg=
ba;this.P2a();this.onVisibilityChange()}setVisibility(ba){this.c8c=!ba;this.onVisibilityChange()}onVisibilityChange(){!this.c8c&&(this.BXa||this.AXa||this.kDg)?(this.updatePosition(this.frame.nDa(this.comment.pos.X,this.comment.pos.Y)),this.Lm.style.display="block",ef.a.QI(this.Lm,Cb.a.lNc)):(this.Lm.style.display="none",ef.a.eLa(this.Lm,Cb.a.lNc))}get Jn(){return this.dHa.paj(this.a$)}get Nkd(){return this.dHa.qaj(this.a$)}P2a(){this.uA.className=Oc.aSc(this.a$)?this.BXa?Ic.getImageClassWithCluster(this.frame.mT,
this.lD.$2g):this.AXa?Ic.getImageClassWithCluster(this.frame.mT,this.lD.Y2g):Ic.getImageClassWithCluster(this.frame.mT,this.lD.Z2g):this.BXa?Ic.getImageClassWithCluster(this.frame.mT,this.lD.V2g):this.AXa?Ic.getImageClassWithCluster(this.frame.mT,this.lD.jIe):Ic.getImageClassWithCluster(this.frame.mT,this.lD.flc)}JC(ba){if(ba.LA!==Sys.UI.MouseButton.leftButton)return!1;this.frame.selectComment(this.a$,null,!1,!0,ba.ng,1,!1);ba=ba.mc;ba.preventDefault();ba.stopPropagation();return!0}yxa(){this.uA.className=
Ic.getImageClassWithCluster(this.frame.mT,this.lD.jIe)}Blc(){this.uA.className=Ic.getImageClassWithCluster(this.frame.mT,this.lD.flc)}fpc(ba){ba.preventDefault()}}Object(h.a)(oc,"ModernCommentMarkerViewElement",null,[1133]);class vc{constructor(ba,Aa,Pa,ub,Lb,Mb){this.dHa=ba;this.B6c=Aa;this.lD=Pa;this.Jfc=Lb;this.SDb=Mb;ub.zvb().then(kd=>{kd||this.a0e(!1)})}dispose(){this.lD=null}create(ba,Aa,Pa,ub,Lb,Mb){if(this.Jfc){const kd=this.dHa.Arj(ba);return new oc(ba,kd||Aa,Pa,ub,this.lD,this.dHa,this.B6c,
Lb,Mb)}return new yb(ba,Aa,Pa,ub,this.lD,Lb,Mb,this.SDb)}a0e(ba){this.SDb=this.Jfc=ba;this.lD.a0e(ba)}}Object(h.a)(vc,"CommentMarkerViewElementFactory",null,[1035,107]);var nd=d(77);class id extends nd.a{constructor(){super()}yii(ba){this.addHandler(id.dFh,ba)}m6g(){this.raiseEvent(id.dFh)}}id.dFh="S";Object(h.a)(id,"ATransactionCompletedProcessor",nd.a,[1087]);var Nd=d(41);class Ce extends id{constructor(ba,Aa,Pa){super();this.msk=ba;this.J8c=Aa;this.JX=Pa}get index(){return 0}run(){this.msk()}iMf(ba,
Aa){Aa.property!==hf.a.eda&&Aa.property!==hf.a.Fsa&&Aa.property!==hf.a.commentId&&Aa.property!==hf.a.s2b&&Aa.property!==hf.a.t2b&&Aa.property!==hf.a.Bvc&&Aa.property!==hf.a.Avc&&Aa.property!==hf.a.reactions||this.m6g()}ULf(ba,Aa){Aa.property!==Nd.a.tB&&Aa.property!==hf.a.s2b||this.m6g()}ZIj(){this.J8c.yd(39).fk(Object(qa.a)(this,this.ULf,"commentContentPropertyChanged"));this.J8c.yd(40).fk(Object(qa.a)(this,this.iMf,"commentPropertyChanged"));this.JX.njl(this)}uLl(){this.J8c.yd(40).Om(Object(qa.a)(this,
this.iMf,"commentPropertyChanged"));this.J8c.yd(39).Om(Object(qa.a)(this,this.ULf,"commentContentPropertyChanged"))}}Object(h.a)(Ce,"CommentPropertyTracker",id,[]);var af=d(669),de=d(143);class $f extends af.a{constructor(){super();this.comment=this.commentId=null;this.H_=Object.assign(new de.a,{T_:$f.getTypeName(),B_:$f.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(h.a)($f,"CommentSmartReplySignal",
af.a,[]);var ge=d(616);class ze extends ge.a{constructor(){super();this.DomainName=this.CommentId=null;this.ConfidenceLevel=0;this.ElapsedTime=this.ResultSets=null;this.H_=Object.assign(new de.a,{T_:ze.getTypeName(),B_:ze.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(h.a)(ze,"SmartReply",ge.a,[]);var si=d(313),sh=d(334);class dd{constructor(ba,Aa){this.TVh=ba;this.Ebf=Aa}initialize(){this.Ebf.execute(ba=>
{const Aa=ze.getTypeName();ba.VZ(Aa);ba.Moa(Aa,Object(qa.a)(this,this.MQ,"handleAnnotationEvent"))})}invoke(ba,Aa){const Pa=Object.assign(new si.a,{parentPath:["Signal",$f.getTypeName()],items:[Object.assign(new sh.a,{body:Object.assign(new $f,{commentId:ba,comment:Aa})})]});this.Ebf.execute(ub=>{ub.submitOperation(Pa)})}MQ(ba){if(ba){var Aa=new m.a;if(ba&&ba.CommentId&&ba.ResultSets&&0<ba.ResultSets.length&&ba.ResultSets[0].Documents&&0<ba.ResultSets[0].Documents.length){for(const Pa of ba.ResultSets[0].Documents)Aa.add(Pa.Caption);
0<Aa.count&&this.TVh.cQk(ba.CommentId,Aa.toArray())}else Jb.a.J(557593412,327,10,"Invalid response from SmartReplies request")}else Jb.a.J(557593411,327,50,"Smart reply invocation returned null annotations.")}}Object(h.a)(dd,"CommentSmartReplyProvider",null,[]);var Lc=d(316),Zd=d(285),Ne=d(279),Xc=d(98),lf=d(184),Kh=d(112),bd=d(62),fd=d(525);class Ve{constructor(ba,Aa,Pa,ub,Lb){this.Wue=this.Jve=this.gwe=this.J5c=0;this.Tzg=new m.a;this.PGe=this.gAg=this.Yue=this.vjc=this.eDe=0;this.FEe=new m.a;this.mte=
this.lte=this.nte=this.kte=0;this.Sxg=new m.a;this.udd=new m.a;this.Hve=this.Fve=this.Gve=this.Ive=this.eAe=this.dAe=this.fAe=this.gAe=0;this.M5c=this.eze=this.E6c=ib.App.pn;this.sYa=null;this.KGe=this.LGe=this.Eed=this.efd=this.Icd=this.jte=0;if(!ba)throw Error.argumentNull("coreEventHandler");if(!Aa)throw Error.argumentNull("appSettingsManager");this.Mc=ba;this.Jb=Aa;this.ta=Pa;this.HB=ub;this.Rue=Lb;this.Mc.HC(Object(qa.a)(this,this.Mo,"onSessionRehydrated"));this.Mc.GC(Object(qa.a)(this,this.WE,
"onSessionEnd"))}get VZd(){return this.Jb.ka("CommentTextAnchoringCreateNewEnabled")}get AEl(){return this.Jb.ka("TasksForCommentsEnabled")}ise(ba,Aa,Pa,ub){this.J5c+=1;this.Wue+=Aa;Pa&&(this.kte+=1,this.FEe.add(ba));ub&&(this.jte+=1)}$$j(ba,Aa,Pa,ub){this.Eed=ub?this.Eed+1:this.Eed;this.ise(ba,Aa,Pa,ub)}Z$j(ba,Aa,Pa,ub,Lb){(Lb=!!Lb)&&ub?this.LGe+=1:Lb&&(this.KGe+=1);this.ise(ba,Aa,Pa,Lb)}gdk(){this.nte+=1}ddk(){this.lte+=1}edk(){this.mte+=1}fdk(ba,Aa,Pa,ub){this.ipg(ba.commentId)||(Pa&&!this.G4j(Aa,
Pa.nz(),ub)?this.Lwg(ba,Pa,!0):this.Lwg(ba,Pa,!1))}v1k(){this.Jve+=1}Vck(){this.Ive+=1}Lak(){this.Gve+=1}Kak(){this.Fve+=1}Mak(){this.Hve+=1}Qak(){this.gwe+=1}cck(ba){this.Tzg.contains(ba)||(this.eDe+=1,this.Tzg.add(ba))}Eck(ba){this.Icd=ba?this.Icd+1:this.Icd;this.vjc+=1}vdk(ba){this.efd=ba?this.efd+1:this.efd}Fck(){this.vjc+=1}lse(ba,Aa,Pa){this.Yue=ba;this.PGe=Aa;this.Sxg=Pa;this.uwg()}Hak(ba){this.gAg=ba?1:2}JBk(ba){this.E6c===ib.App.pn&&(this.E6c=new Date,this.MGa("OnCollabCornerCommentsEnabled",
this.E6c,ba),this.VYe("CollabCornerCommentsEnabled",this.E6c))}eDk(ba){this.eze===ib.App.pn&&(this.eze=new Date,this.MGa("OnFloatingCommentsRendered",this.eze,ba))}GAk(ba){this.M5c===ib.App.pn&&(this.M5c=new Date,this.MGa("OnAllFloatingContainersVisible",this.M5c,ba),this.VYe("AllFloatingContainersVisible",this.M5c))}gCk(ba){const Aa=new Date;this.MGa("OnDeepLinkedCommentSelected",Aa,ba);this.VYe("DeepLinkedCommentSelected",Aa)}ipg(ba){return this.Sxg.contains(ba)||this.udd.contains(ba)}G4j(ba,Aa,
Pa){let ub=0;for(const Mb of Aa)if(Aa=Object(xb.a)(1066,Mb.qc(Pa))){Aa=Aa.htmlElement.getElementsByClassName(Xc.a.I3b);for(let kd=0;kd<Aa.length;kd++){var Lb=Aa[kd];const Id=Lc.a.ze(Lb,Xc.a.TZd);Id&&(ub+=od.a.contains(Id,ba)?1:0);(Lb=Lc.a.ze(Lb,Xc.a.PZd))&&(ub+=od.a.contains(Lb,ba)?1:0);if(2===ub)return!0}}return!1}Lwg(ba,Aa,Pa){if(ba&&ba.textAnchoringInfo&&!this.ipg(ba.commentId))if(ba.textAnchoringInfo.EndPos<=ba.textAnchoringInfo.StartPos){if(Aa){if(Pa){this.eAe+=1;this.udd.add(ba.commentId);return}this.fAe+=
1}else this.gAe+=1;this.udd.add(ba.commentId)}else 0>=ba.textAnchoringInfo.TextBodyLength&&(this.FEe.contains(ba.commentId)?this.FEe.remove(ba.commentId):(this.dAe+=1,this.udd.add(ba.commentId)))}MGa(ba,Aa,Pa){const ub={};ub.Event=ba;ub.Time=Aa.getTime();ub.SlideId=Pa.toString();ub.LandingSlide=this.Ijj();ub.SessionDimensions=this.Ice();ub.PerfMetrics=this.Eaj();ub.CommentPerfMetrics=this.fdj();ub.CommentFileType=this.Rue;ub.CommentDeepLinkedOpen=!!this.Jb.Ha("CurrentCommentId");ub.StandaloneCommentJsEnabled=
!0;ub.LoadSharedCommentsEarly=!0;ub.FetchFullAppSettingsOnBoot=this.Jb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.FetchFullAppSettingsOnBoot",!1);ub.PrefetchCommentCloudPolicy=this.Jb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PrefetchCommentCloudPolicy",!1);Jb.a.J(509703831,805,15,Ta.c(ub))}uwg(){Jb.a.J(509703830,805,15,"Comment(s) - OnOpen:{0}; FileType:{1}",this.Yue,this.Rue);Jb.a.J(509703829,805,15,"Text Anchor(s) - OnOpen:{0}",this.PGe);Jb.a.J(509703828,805,15,"Comment/Tasks BRSs - TextAnchoringCreateNewEnabled:{0}; TasksForCommentsEnabled:{1}; ",
this.VZd,this.AEl)}log(){Jb.a.J(509703827,805,15,"Comment(s) - Added:{0}; Edited:{1}; Deleted:{2}; AverageLength:{3}; Moved:{4}; Resolved:{5}; OnOpen:{6}; FileType:{7}; CreateNewPolicy:{8}",this.J5c,this.gwe,this.Jve,this.Wue/this.J5c,this.eDe,this.vjc,this.Yue,this.Rue,this.gAg);Jb.a.J(509703826,805,15,"Text Anchor(s) - OnOpen:{0}; Added:{1}; WithMultiPara:{2}; InSmartArt{3}; InTable:{4}; InvalidStartEndPos:{5}; InvalidBodyLength:{6}; InvalidShape:{7}; InvalidTextDelete:{8}",this.PGe,this.kte,this.nte,
this.lte,this.mte,this.fAe,this.dAe,this.gAe,this.eAe);Jb.a.J(509703825,805,15,"Deleted Comment(s) - Single:{0}; InSlide:{1}; InPresentation:{2}; Resolved:{3}",this.Ive,this.Gve,this.Fve,this.Hve);this.bdk()}bdk(){Jb.a.J(509703824,845,15,"Task(s) - Added:{0}",this.jte);const ba={};ba.ResolvedTasksCount=this.Icd;ba.UnresolvedTasksCount=this.efd;ba.TasksCreatedNewThreadCount=this.Eed;ba.TasksReassignedInReplyCount=this.LGe;ba.TasksCreatedInReplyCount=this.KGe;Jb.a.J(509703823,845,15,Ta.c(ba))}Mo(){this.uwg()}WE(){this.log()}Ijj(){if(this.sYa)return this.sYa;
this.sYa={};var ba=parseInt(this.Jb.Ha("CurrentSlideId"));ba=ba!==bd.a.empty.sid?bd.a.Uy(ba,0):this.ta.presentation.Xyb(0);if(!ba)return this.sYa;this.sYa.SlideId=ba.toString();if(ba=this.ta.presentation.Zce(ba.sid))ba=Object(xb.a)(118,ba).qE(),this.sYa.HasComments=this.HB.sgg(ba),this.sYa.HasActiveComments=this.HB.igg(ba);return this.sYa}Ice(){const ba={};ba.Ring=e.AFrameworkApplication.Od.Ring;ba.Host=e.AFrameworkApplication.Od.Host;ba.UiHost=e.AFrameworkApplication.Od.UiHost;ba.SessionOrigin=e.AFrameworkApplication.Od.SessionOrigin;
ba.ApplicationMode=e.AFrameworkApplication.Od.ApplicationMode;ba.Browser=e.AFrameworkApplication.Od.Browser;ba.Os=e.AFrameworkApplication.Od.Os;return ba}Eaj(){const ba={};ba[Zd.a.rRb]=gc.a.instance.Tg(Zd.a.rRb);ba.DocPageNavigationStart=gc.a.instance.Tg("DocPageNavigationStart");ba[Zd.a.L6b]=gc.a.instance.Tg(Zd.a.L6b);ba[fd.a.CWe]=gc.a.instance.Tg(fd.a.CWe);ba[fd.a.BWe]=gc.a.instance.Tg(fd.a.BWe);ba[fd.a.Oqh]=gc.a.instance.Tg(fd.a.Oqh);ba[fd.a.fZf]=gc.a.instance.Tg(fd.a.fZf);ba[fd.a.l6d]=gc.a.instance.Tg(fd.a.l6d);
ba[fd.a.k6d]=gc.a.instance.Tg(fd.a.k6d);ba[fd.a.LYd]=gc.a.instance.Tg(fd.a.LYd);ba[Zd.a.ozd]=0<Ne.a.instance.Ylh();return ba}fdj(){const ba={};ba[ic.a.SZd]=gc.a.instance.Tg(ic.a.SZd);ba[ic.a.XZd]=gc.a.instance.Tg(ic.a.XZd);ba[ic.a.F$b]=gc.a.instance.Tg(ic.a.F$b);ba[ic.a.Rhe]=gc.a.instance.Tg(ic.a.Rhe);ba[ic.a.F0e]=gc.a.instance.Tg(ic.a.F0e);ba[ic.a.X$b]=gc.a.instance.Tg(ic.a.X$b);ba[ic.a.She]=gc.a.instance.Tg(ic.a.She);ba[ic.a.Vre]=gc.a.instance.Tg(ic.a.Vre);ba[ic.a.U7d]=gc.a.instance.Tg(ic.a.U7d);
ba[ic.a.V7d]=gc.a.instance.Tg(ic.a.V7d);ba[ic.a.utd]=gc.a.instance.Tg(ic.a.utd);ba[ic.a.$0d]=gc.a.instance.Tg(ic.a.$0d);ba[ic.a.Z0d]=gc.a.instance.Tg(ic.a.Z0d);return ba}rrj(){const ba=gc.a.instance.Tg("DocPageNavigationStart");if(!gc.a.instance.Tg(Zd.a.rRb))return ba;const Aa=gc.a.instance.Tg(Zd.a.rRb);return 6E4>ba-Aa?Aa:ba}VYe(ba,Aa){const Pa=[];Array.add(Pa,Object.assign(new Kh.a,{name:"EventName",string:ba}));Xb.a.sendActivityEvent(Object.assign(new lf.a,{name:"CommentsBootEvents",durationMs:Aa.getTime()-
this.rrj(),dataFields:Pa}))}}Object(h.a)(Ve,"CommentTelemetryManager",null,[1074]);var rf=d(699),Ag=d(700),ne=d(701);class kf extends rf.a{constructor(ba,Aa){super();this.qjk=ba;this.Hi=Aa;this.Fze=[new Ag.a(Xc.a.WLf,null),new Ag.a(Xc.a.XLf,null),new Ag.a(Xc.a.YLf,null),new Ag.a(Xc.a.aMf,null),new Ag.a(Xc.a.eMf,null),new Ag.a(Xc.a.fMf,null),new Ag.a(Xc.a.dMf,null),new Ag.a(Xc.a.ZLf,null),new Ag.a(Xc.a.$Lf,null),new Ag.a(Xc.a.bMf,null),new Ag.a(Xc.a.cMf,null)]}get isInHighContrastMode(){return!!this.Hi&&
this.Hi.isInHighContrastMode}get Hzb(){return this.qjk}get Ege(){return this.Fze}Rmc(ba,Aa){var Pa=this.N_.Vja;if(Pa&&0===Pa.type&&(Pa=this.N_.Vja.gea,Pa=Object(n.a)(Array,Pa)?Pa:null)){var ub=null,Lb=null,Mb=new Ma.a;for(const kd of Pa)kd.Nnc.isValid&&Array.contains(kd.Nnc.paragraphs,ba)&&(0===kd.state?ub=kd.commentId:1===kd.state&&(Lb=kd.commentId),Mb.$(kd.commentId,kd.Nnc));this.Qli(Aa.querySelectorAll("*"),Mb,ba,ub,Lb)}}bac(ba,Aa){ba=Object(n.a)(Array,ba)?Array.isArray(ba)?ba:null:null;if(!ba||
0<ba.length&&!Object(xb.a)(be,ba[0]))return Aa;for(const Pa of ba)if(Pa.Nnc.isValid)for(const ub of Pa.Nnc.paragraphs)ub&&(ne.b(ub),Aa.add(ub));return Aa}v2i(ba,Aa){ba=ba.IMa;const Pa=Aa?kf.Ufk:kf.Vfk;Aa=Uc.a.i5f(ba,Aa?kf.Lkk:kf.Mkk);ba=Uc.a.i5f(ba,Pa);return Aa<ba}Qli(ba,Aa,Pa,ub,Lb){const Mb=new ja.a,kd=new ja.a;for(let Xe=0;Xe<ba.length;Xe++){const jd=ba[Xe];this.Lod(jd);if(!jd.parentNode)continue;var Id=Lc.a.ze(jd,Xc.a.TZd),ce=Lc.a.ze(jd,Xc.a.PZd);const rd=[!1,!1,!1];if(Id)for(const Wc of Id)if(Aa.Fb(Wc)){Id=
Aa.ga(Wc).z6f(Pa);if(Aa.ga(Wc).ugg||(2===Id||0===Id)&&!this.isInHighContrastMode&&this.v2i(Aa.ga(Wc),Wc===Lb))Aa.ga(Wc).ugg=!0,Mb.add(Wc);kd.add(Wc);this.iTf(Aa,Pa,Wc,ub,Lb,rd,!0)}if(ce)for(const Wc of ce)kd.contains(Wc)&&(kd.remove(Wc),Mb.remove(Wc),this.iTf(Aa,Pa,Wc,ub,Lb,rd,!1));if(0!==ne.a(jd)){ce=(Id=0<Mb.count)&&!!Lb&&Mb.contains(Lb);const Wc=!!ub&&kd.contains(ub),wd=!!Lb&&kd.contains(Lb);0<kd.count&&!this.isInHighContrastMode&&0<=jd.parentNode.className.indexOf(Xc.a.JMa)&&(ef.a.QI(jd.parentNode,
Xc.a.WLf),wd?ef.a.QI(jd.parentNode,ce?Xc.a.$Lf:Xc.a.ZLf):Wc?(ef.a.QI(jd.parentNode,Xc.a.XLf),Id=jd.parentNode.className.match(new RegExp("\\b"+Xc.a.Ohg+"\\b")),(!Id||1>Id.length)&&ef.a.QI(jd.parentNode,Xc.a.YLf)):ef.a.QI(jd.parentNode,Id?Xc.a.fMf:Xc.a.eMf));rd[1]?ef.a.QI(jd,ce?Xc.a.cMf:Xc.a.bMf):rd[0]?ef.a.QI(jd,Xc.a.aMf):rd[2]&&ef.a.QI(jd,Xc.a.dMf)}}}iTf(ba,Aa,Pa,ub,Lb,Mb,kd){ba=ba.ga(Pa).z6f(Aa);if(2===ba||(kd?0===ba:1===ba))ub&&ub.equals(Pa)&&(Mb[0]=!0),Lb&&Lb.equals(Pa)&&(Mb[1]=!0),Mb[2]=!0}}
kf.Mkk="#F5E7F6";kf.Vfk="#503355";kf.Lkk="#F2E1F4";kf.Ufk="#4C3050";Object(h.a)(kf,"CommentTextAnchorHighlightActor",rf.a,[]);class kg{constructor(ba){let Aa;this.l2h=20;Aa=ba?ba="SharedCommentBubble":ba="SharedCommentBubbleSelected";this.g2h=this.tTa("SharedCommentBubble");this.f2h=this.tTa("SharedCommentBubbleHover");this.Zmf=this.tTa(ba);this.k2h=this.tTa("SharedCommentBubble");this.j2h=this.tTa("SharedCommentBubbleHover");this.$mf=this.tTa(Aa);this.h2h="ModernCommentMarkerElementSingle cui-img-cont-float";
this.i2h="ModernCommentMarkerElementWithReplies cui-img-cont-float"}get W2g(){return this.h2h}get X2g(){return this.i2h}get kIe(){return this.l2h}get flc(){return this.g2h}get jIe(){return this.f2h}get V2g(){return this.Zmf}get Z2g(){return this.k2h}get Y2g(){return this.j2h}get $2g(){return this.$mf}a0e(ba){const Aa=ba?this.flc:"SharedCommentBubbleSelected";ba=ba?this.flc:Aa;this.Zmf=this.tTa(Aa);this.$mf=this.tTa(ba)}tTa(ba){return String.format("{0}_{1}x{2}x32",ba,this.kIe,this.kIe)}}Object(h.a)(kg,
"CommentViewHelper",null,[]);class Af{constructor(ba,Aa,Pa,ub,Lb,Mb){this.Mc=ba;this.ta=Aa;this.wb=Pa;this.gWg=ub;this.jb=Mb;this.gWg.IF(Object(qa.a)(this,this.Sjd,"onSlideOrderChanged"));this.Mc.hfi(Object(qa.a)(this,this.u8g,"onCommentsChanged"))}dispose(){this.Mc.i7k(Object(qa.a)(this,this.u8g,"onCommentsChanged"));this.gWg.oP(Object(qa.a)(this,this.Sjd,"onSlideOrderChanged"))}u8g(){const ba=this.ta.Ba;D.a.u7a(this.wb,()=>{this.tQk(ba)})}Sjd(ba,Aa){if(2===Aa.yW){const Pa=this.ta.Ba;D.a.u7a(this.wb,
()=>{this.vgh(Pa)})}}vgh(ba){this.ta.Ba===ba&&ba&&this.jb.U2a(!0)}tQk(ba){this.vgh(ba)}}Object(h.a)(Af,"CommentsChangeListener",null,[107]);var Wf=d(141),vf=d(277),De=d(177);class Ee{static tDa(ba,Aa,Pa,ub,Lb,Mb,kd){const Id=qd.a.sB();Id.alt=Mb;Id.className=Ic.getImageClassWithCluster(Aa,Lb);Id.setAttribute(cb.a.hf,cb.a.Ju);Id.src=ba.qk(Aa+".png");Id.setAttribute("Unselectable","on");ba=qd.a.Il();ba.className=Pa+" cui-img-cont-float";ba.setAttribute(cb.a.hf,cb.a.Ju);ba.appendChild(Id);Pa=qd.a.Il();
Pa.className=ub;Pa.setAttribute("Unselectable","on");Pa.setAttribute(cb.a.hf,cb.a.Ju);Pa.appendChild(ba);ub=qd.a.kda();ub.className=Ee.Jdl+" cui-ctl";ub.title=Mb;ub.setAttribute(cb.a.hf,cb.a.Ju);ub.setAttribute(cb.a.er,Mb);ub.appendChild(Pa);kd&&(Mb=qd.a.Il(),Mb.className="cui-ctl-mediumlabel",Mb.setAttribute("Unselectable","on"),Mb.setAttribute(cb.a.hf,cb.a.Ju),Mb.innerText=kd,ub.appendChild(Mb));return ub}static uDa(ba,Aa){return Ee.tDa(ba,ba.mT,"cui-img-16by16","cui-ctl-iconContainer",Aa,CommonUIStrings.l_DialogClose,
null)}}Ee.Hdl="CommentPaneLTR";Ee.Idl="CommentPaneRTL";Ee.Jdl="CommentPaneWithBorderButton";Ee.Xdl=300;Object(h.a)(Ee,"CommentPaneHelper",null,[]);var Jd=d(48);class Og{constructor(ba,Aa,Pa,ub,Lb){this.mgc=this.LIa=null;new vf.a(0,0,0,0);this.bYa=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesM2IsEnabled");this.Vzg=null;this.KAh=!1;this.GH=Lb;this.FJ=ba;this.Vb=Aa;this.GH||(this.LIa=document.createElement("div"),this.LIa.className="CommentPanel",this.LIa.style.position=
"absolute");this.Ab=!1;this.LO=Pa;this.V_g=ub}dispose(){}layout(ba,Aa){if(this.bYa)return ba;if(null===ba)throw Error.argumentNull("availableArea");const Pa=Aa?ba.MD(this.width):ba.ND(this.width);this.isVisible&&(Aa?Pa.MD(1):Pa.ND(1));this.GH||qd.a.O1(this.LIa,Pa);return ba}Rge(ba){this.mgc=ba}Tjl(ba){this.Vzg=ba}Xp(ba,Aa){this.Ab=ba;this.bYa?this.GH?this.qK(this.Ab):this.V_g.qK(this,this.Ab,ResourceStrings.L_Comments,Jd.a.Kp):(this.Vb.Vhb(this.LO&&Aa?1:2),this.FJ.updateCommandUI())}qK(ba){Wf.UISurfaces.Gq().then(Aa=>
{ba?Aa.showTaskPane(Jd.a.Kp,this.Vzg):Aa.hideTaskPane(Jd.a.Kp,2);return null}).catch(Aa=>{Jb.a.J(572339907,833,10,"CommentsPane::ShowHidePane exception: {0}. isVisible: {1}",Aa.toString(),ba.toString())})}MYe(){Wf.UISurfaces.Gq().then(ba=>{ba.setSelectedTaskPane(Jd.a.Kp);return null}).catch(ba=>{Jb.a.J(572339909,833,10,"CommentsPane::SelectPane exception: {0}",ba.toString())})}sgl(){try{this.GH?this.MYe():this.V_g.MYe(Jd.a.Kp)}catch(ba){Jb.a.J(592591050,805,100," Task pane couldn't be selected as it is not present in tabbed task pane group",
ba)}}Vhb(ba){this.Vb.Vhb(this.LO&&ba?1:2)}get isVisible(){return this.Ab}get va(){return this.LIa}get order(){return 18}get width(){return this.isVisible?Ee.Xdl+1:0}}Object(h.a)(Og,"CommentsPane",null,[1040,587,107,1065]);class Rg{constructor(){this.H0a=this.rMa=0;this.Vc=this.j1a=this.Ija=null}}Object(h.a)(Rg,"FindCommentContext",null,[]);var Eg;(function(ba){ba[ba.findNextComment=0]="findNextComment";ba[ba.findPreviousComment=1]="findPreviousComment";ba[ba.findNextActiveComment=2]="findNextActiveComment";
ba[ba.findPreviousActiveComment=3]="findPreviousActiveComment"})(Eg||(Eg={}));Object(h.b)("FindCommentRequestType",Eg);class xf{constructor(ba,Aa,Pa,ub,Lb,Mb){this.oc=ba;this.ta=Aa;this.Xye=Pa;this.zO=ub;this.EHg=Lb;this.Cd=new Rg;this.Ghk=Mb}get jDa(){return this.Ghk.value}dispose(){this.Xye.dispose();this.Cd=this.Xye=null}y7d(ba,Aa,Pa){this.u7d(0,!1,ba,Aa,Pa)}F7d(ba,Aa,Pa){this.u7d(1,!1,ba,Aa,Pa)}z7d(ba,Aa){this.u7d(0,!0,ba,Aa,!1)}u7d(ba,Aa,Pa,ub,Lb){var Mb=this.ta.presentation;if(!Mb)throw Error.argumentNull("Presentation is null");
ub||(ub=Ze.a.kk("FindComment",0),ub.Wa("FindCommentRequestType",Eg[ba]));ub.Wa(xf.kXd,"true");if(this.EHg&&this.ta.Ba){if(!this.ta.Ba)throw Error.argumentNull("ActiveSlide is null");const kd=this.ta.Ba.ue;Mb=Mb.slides||[];this.Cd.Ija=Pa;this.Cd.H0a=xf.ghj(ba,Lb);this.Cd.Vc=ub;Aa?this.v7d(Mb[kd>=Mb.length-1?0:kd+1]):1===ba?this.k0f(Mb,kd-1,Lb):this.h0f(Mb,kd+1,Lb)}else ub.Wa(xf.qui,this.EHg.toString()),Pa(null,null,!1,!1)}h0f(ba,Aa,Pa){this.Cd.j1a=null;this.Cd.rMa=Aa;for(let ub=Aa;ub<ba.length;ub++)if(ba[ub]&&
this.Xrg(ba[ub])){const Lb=this.lhj(ba[ub],Pa);if(Lb){this.Cd.Ija(ba[ub],Lb,!1,!1);return}}else{this.v7d(ba[ub]);return}0<Aa?this.S4i(Pa):this.notFound()}k0f(ba,Aa,Pa){this.Cd.j1a=null;this.Cd.rMa=Aa;for(let ub=Aa;-1<ub;ub--)if(ba[ub]&&this.Xrg(ba[ub])){const Lb=this.Pjj(ba[ub],Pa);if(Lb){this.Cd.Ija(ba[ub],Lb,!1,!1);return}}else{this.v7d(ba[ub]);return}Aa<ba.length-1?this.$4i(Pa):this.notFound()}v7d(ba){this.Cd.Vc.vm(xf.avi,new Date);ba&&this.Xye.find(ba.Db,this.Cd.H0a,Object(qa.a)(this,this.rHk,
"onServerFindSucceeded"),Object(qa.a)(this,this.qHk,"onServerFindFailed"))}rHk(ba){this.Cd.Vc.oC(xf.kXd,"false");this.Cd.Vc.vm(xf.YGf,new Date);this.Cd.Vc.Wa(xf.GGf,"true");ba?(this.Cd.j1a=ba,-1===this.t8b(this.Cd.j1a.TargetSlideId)?this.notFound():this.Cd.Ija(this.zGl(this.Cd.j1a.TargetSlideId),this.Cd.j1a.TargetComment,this.Cd.j1a.IsFirstComment,this.Cd.j1a.IsLastComment)):this.notFound()}qHk(){this.Cd.Vc.oC(xf.kXd,"false");this.Cd.Vc.vm(xf.YGf,new Date);this.Cd.Vc.Wa(xf.GGf,"false");Jb.a.J(512496786,
805,50,"OnServerFindFailed");this.notFound()}S4i(ba){var Aa=this.ta.presentation;if(!Aa)throw Error.argumentNull("Presentation is null");Aa=Aa.slides||[];od.a.Xa(Aa)?this.notFound():this.h0f(Aa,0,ba)}$4i(ba){var Aa=this.ta.presentation;if(!Aa)throw Error.argumentNull("Presentation is null");Aa=Aa.slides||[];od.a.Xa(Aa)?this.notFound():this.k0f(Aa,Aa.length-1,ba)}lhj(ba,Aa){ba=this.oc.Zk(ba.Db);if(this.jDa){const Pa=(ba=this.zO.O$a(ba))?ba.length:0;for(let ub=0;ub<Pa;ub++){const Lb=ba[ub];if(xf.htg(Lb,
Aa))return Lb}return null}return this.zO.D4i(ba,Aa)}Pjj(ba,Aa){ba=this.oc.Zk(ba.Db);if(this.jDa){var Pa=(ba=this.zO.O$a(ba))?ba.length:0;for(--Pa;0<=Pa;Pa--){const ub=ba[Pa];if(xf.htg(ub,Aa))return ub}return null}return this.zO.P4i(ba,Aa)}Xrg(ba){return ba.uE}t8b(ba){var Aa=this.ta.presentation;if(!Aa)throw Error.argumentNull("Presentation is null");if(ba){Aa=Aa.slides||[];ba=new bd.a(ba);for(let Pa=0;Pa<Aa.length;Pa++)if(Aa[Pa]&&bd.a.v2b(Aa[Pa].Db,ba))return Pa}return-1}zGl(ba){return ba?this.oc.Wka(new bd.a(ba)):
null}notFound(){this.Cd.Ija&&this.Cd.Ija(null,null,!1,!1)}static ghj(ba,Aa){if(Aa)switch(ba){case 0:return 2;case 1:return 3}return ba}static htg(ba,Aa){return!Aa||0===ba.status}}xf.kXd="IsCompletedSearchInClient";xf.avi="ServerSearchStartTime";xf.YGf="ServerSearchEndTime";xf.GGf="IsServerSearchSucceeded";xf.qui="IsBRSOn";Object(h.a)(xf,"FindCommentLogic",null,[1038,107]);var hd=d(82);class yf{constructor(){this.type=0;this.Ija=this.Vc=null;this.LRd=!1}}Object(h.a)(yf,"Entry",null,[]);class cd{constructor(ba,
Aa){this.P7c=null;this.Sp=ba;this.wb=Aa;this.pna=[];this.YCe=0}dispose(){this.Sp.dispose();this.pna=this.Sp=null;Jb.a.J(25985481,805,50,"MaxQueuedEntryNum: {0}",this.YCe)}y7d(ba,Aa,Pa){this.enqueue(1,ba,Aa,Pa)}F7d(ba,Aa,Pa){this.enqueue(0,ba,Aa,Pa)}z7d(ba,Aa){this.enqueue(2,ba,Aa,!1)}enqueue(ba,Aa,Pa,ub){Pa.Wa("AlreadyQueuedEntryCount",this.pna.length.toString());ba=Object.assign(new yf,{type:ba,Ija:(Lb,Mb,kd,Id)=>{Aa(Lb,Mb,kd,Id);this.P7c=null;this.efh()},Vc:Pa,LRd:ub});Array.enqueue(this.pna,ba);
this.YCe=Math.max(this.YCe,this.pna.length);this.efh()}efh(){0<this.pna.length&&!this.P7c&&(this.P7c=new hd.a(2,1,0,Object(qa.a)(this,this.sUk,"processOneEntry"),90,"49"),this.wb.Hb(this.P7c))}sUk(){const ba=Array.dequeue(this.pna);1===ba.type?this.Sp.y7d(ba.Ija,ba.Vc,ba.LRd):0===ba.type?this.Sp.F7d(ba.Ija,ba.Vc,ba.LRd):this.Sp.z7d(ba.Ija,ba.Vc)}}Object(h.a)(cd,"FindCommentLogicDecorator",null,[1038,107]);var cg=d(394),xh=d(110);class Yf extends xh.a{constructor(ba,Aa){super();this.StartSlideId=null;
this.RequestType=0;this.FFindModernComments=!1;if(null===ba)throw Error.argumentNull("slideId");this.RequestType=Aa;this.StartSlideId=ba.toString();this.FFindModernComments=!0}pl(){return 88}}Object(h.a)(Yf,"FindCommentRequest",xh.a,[]);class Hf extends cg.a{constructor(ba){super();this.hxa=null;this.oXg=0;this.fJa=this.vHa=null;this.enabled=2;this.HFb=0;this.Rk=!1;this.Ym=ba;this.Ym.register(this)}dispose(){this.Rk||(1===this._state&&this.Ym.unregister(this),this.Rk=!0,this.HFb=0)}find(ba,Aa,Pa,
ub){0<this.HFb&&null!==Pa&&(Jb.a.J(523249091,805,15,"FindCommentReplicator::Find() - NumPendingFindRequests={0}",this.HFb),Pa(null));this.hxa=ba;this.oXg=Aa;this.QF(Pa,ub,null)}fla(){return 0<this.HFb&&!this.Rk}bO(){return!1}RUa(){return this.prg||this.fla()}kMb(){if(1===this._state)this.Wd.TH=new Yf(this.hxa,this.oXg),this.Wd.status=1,this._state=3;else if(3===this._state&&this.prg)if(Jb.a.J(523249092,805,50,"FindCommentRequest EnqeueTime={0}, InvokedTime={1}, CompletedTime={2}",this.Wd.Epd,this.Wd.iu,
this.Wd.wv),2===this.Wd.statusCode&&this.Wd.Yr&&1===this.Wd.Yr.length){const ba=this.Wd.Yr[0];0!==ba.StatusCode?this.PH(ba):this.j1(ba)}else this.PH()}QF(ba,Aa){this.HFb++;this.fJa=ba;this.vHa=Aa;this.Ym.Uaa()}forceOutbound(){}PH(ba=null){Jb.a.J(523249094,805,50,"FindCommentReplicator Inbound failed: HttpStatusCode={0}, OperationStatusCode={1}, FindCommentResponseStatusCode={2}",this.Wd.Iv,this.Wd.statusCode,ba?ba.StatusCode:-1);this.X9g(ba,!1)}j1(ba){this.X9g(ba,!0)}get prg(){return!!this.Wd&&2===
this.Wd.status}X9g(ba,Aa){this.HFb--;this._state=1;if(Aa){Aa=null;try{Aa=Sys.Serialization.JavaScriptSerializer.deserialize(ba.FindCommentResult)}catch(Pa){Jb.a.J(523249095,805,10,"Cannot parse find comment result: {0}",Pa)}this.fJa(Aa)}else this.vHa(null,-1)}}Object(h.a)(Hf,"FindCommentReplicator",cg.a,[107]);class ji{constructor(){this.nx=null;this.wyc=this.gqf=this.Dbf=this.gZb=this.Dvf=this.$nf=this.orf=!1}Yrj(){this.nx||(r.ULS.sendTraceTag(588292828,327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),
this.fyh());return this.nx}xlj(){return new Promise((ba,Aa)=>{this.wyc?ba(this.k9f()):this.Yvh().then(()=>{ba(this.k9f())}).catch(Pa=>{Aa(Pa)})})}k9f(){this.wyc||r.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let ba;ba=33;this.Dbf&&(ba|=2);this.orf&&(ba|=8);this.Dvf&&(ba|=16);this.$nf&&(ba|=4);this.gZb&&(ba|=64);this.gqf&&(ba|=128);return ba}}Object(h.a)(ji,"OfficeSharedCommentsAppCapabilities",
null,[1561]);class Qi extends ji{constructor(ba,Aa,Pa,ub,Lb,Mb){super();this.Jb=ba;this.Ea=Aa;this.oOg=Pa;this.Oad=Mb;this.Iol(ub,Lb);this.fyh();this.Yvh()}Iol(ba,Aa){zc.a("CheckTaskHostIsEnabledForOneDriveConsumer")&&this.Atl(ba)?this.gZb=!0:this.gZb=this.Jb.ka("TasksForCommentsEnabled")&&!ba;this.Dvf=!1;this.orf=Aa;this.gqf=this.$nf=!0}Atl(ba){return this.Jb.ka("TasksForCommentsEnabled")&&!ba&&this.Jb.ka("TasksHostIsEnabled")}fyh(){this.nx={};const ba=this.gZb&&this.Ea.z4j;this.nx.CommentsFluentUI=
"true";this.nx.CommentTasks=this.gZb.toString();this.nx.DisabledChangeGates=this.Jb.Ha("DisabledChangeGatesInSharedComments");this.nx.DiscreteHostedComments="true";this.nx.CommentReactions=Ib(this.Jb).toString();this.nx.NewCommentButton="true";this.nx.PersonaColor="true";this.nx.LivePersonaPicker="true";this.nx.AtMentionFloodgateSurvey=e.AFrameworkApplication.fa.ka("AtMentionUserFloodGateCampaignIsEnabled").toString();this.nx.CommentTasksFromReply=ba.toString();this.nx.LogDraftCommentIdPair=this.Oad.toString();
this.nx.HyperlinksInComments="true";this.nx.SmartReplies=this.Jb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1).toString();this.nx.TaskPaneWithNewInfrastructure=this.Ea.YZd.toString();this.nx.NewSelectionInteractions="true";this.nx.ExtendedDrafting="true";this.nx.LinkToComment="true";this.nx.WebThemeIntegration="true";this.nx.TaskHistoryRecordIDs=this.Jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",!1).toString()}Yvh(){return new Promise((ba,
Aa)=>{this.oOg?this.oOg.atMentionsEnabledAsync().then(Pa=>{this.Dbf=Pa;this.wyc=!0;ba(this.wyc)}):(r.ULS.sendTraceTag(509645712,327,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),Aa(D.a.kt(-2130915320)))})}}Object(h.a)(Qi,"PPTSharedCommentAppCapabilities",ji,[]);class ah{constructor(ba){this.Eg=ba}display(ba,Aa){this.Eg.P8e(ba?0:2,Aa);this.Eg.setVisibility()}dismiss(){this.Eg.GAi();this.Eg.setVisibility()}activate(){this.Eg.P8e(1);
this.Eg.setVisibility()}gVi(ba){this.Eg.P8e(ba?0:2)}xm(ba){this.Eg.xm(ba)}iC(ba){this.Eg.iC(ba)}Mp(){return this.Eg.Mp()}KL(ba){return this.Eg.EAb(ba)}Xw(ba){this.Eg.Xw(ba)}dispose(){this.Eg.dispose()}my(){this.Eg.my()}aD(ba){return this.Eg.aD(ba)}QA(ba){return this.Eg.QA(ba)}draw(ba,Aa){this.Eg.draw(ba,Aa)}get visible(){return this.Eg.visible}set visible(ba){this.Eg.visible=ba}setPosition(ba,Aa){this.Eg.setPosition(ba,Aa)}Ij(ba){this.Eg.Ij(ba)}vq(ba){this.Eg.vq(ba)}Eu(ba){this.Eg.Eu(ba)}setZIndex(ba){this.Eg.setZIndex(ba)}JD(ba,
Aa){this.Eg.JD(ba,Aa)}setSelection(){}}Object(h.a)(ah,"ShapeCommentsAnchoredSelectionView",null,[1069,239,240,107]);class Kd{constructor(ba,Aa){this.canvasContextId=this.canvasActionId=0;this.withFlags=!1;this.postCallback=this.registeredCallback=this.preCallback=null;this.delayActionsUntilRegistration=!1;this.canvasActionId=ba;this.canvasContextId=Aa}}Object(h.a)(Kd,"CommentUIAction",null,[]);var Qd=d(65),Gg=d(656),Sg=d(120),Wh=d(183),Bg=d(1153),oh=d(542);class Yj{constructor(){this.draftId=null;
this.insertIndex=0;this.anchorHintText=null}}Object(h.a)(Yj,"CurrentContextDraft",null,[]);class Gh{constructor(){this.contentId=null;this.anchorTop=this.containerContentType=0;this.anchorBottom=this.anchorRight=this.anchorLeft=null}}Object(h.a)(Gh,"IContentAnchorPosition",null,[]);class Xh{constructor(){this.y=this.x=this.height=this.width=0}}Object(h.a)(Xh,"IViewportInfo",null,[]);class Yg{constructor(){this.allContainersVisibleCallback=this.positionsUpdatedScrollHeightCallback=this.positionsUpdatedCallback=
this.paneOpenedCallback=this.paneClosedCallback=null}}Object(h.a)(Yg,"FloatingContainerManagerCreationParams",null,[]);var dg=d(140),Od=d(53),We=d(838),Zj=d(422),ij=d(390),Wd=d(919),ki;(function(ba){ba[ba.line=0]="line";ba[ba.lineInv=1]="lineInv";ba[ba.triangle=2]="triangle";ba[ba.rtTriangle=3]="rtTriangle";ba[ba.rect=4]="rect";ba[ba.diamond=5]="diamond";ba[ba.parallelogram=6]="parallelogram";ba[ba.trapezoid=7]="trapezoid";ba[ba.nonIsoscelesTrapezoid=8]="nonIsoscelesTrapezoid";ba[ba.pentagon=9]="pentagon";
ba[ba.hexagon=10]="hexagon";ba[ba.heptagon=11]="heptagon";ba[ba.octagon=12]="octagon";ba[ba.decagon=13]="decagon";ba[ba.dodecagon=14]="dodecagon";ba[ba.star4=15]="star4";ba[ba.star5=16]="star5";ba[ba.star6=17]="star6";ba[ba.star7=18]="star7";ba[ba.star8=19]="star8";ba[ba.star10=20]="star10";ba[ba.star12=21]="star12";ba[ba.star16=22]="star16";ba[ba.star24=23]="star24";ba[ba.star32=24]="star32";ba[ba.roundRect=25]="roundRect";ba[ba.round1Rect=26]="round1Rect";ba[ba.round2SameRect=27]="round2SameRect";
ba[ba.round2DiagRect=28]="round2DiagRect";ba[ba.snipRoundRect=29]="snipRoundRect";ba[ba.snip1Rect=30]="snip1Rect";ba[ba.snip2SameRect=31]="snip2SameRect";ba[ba.snip2DiagRect=32]="snip2DiagRect";ba[ba.plaque=33]="plaque";ba[ba.ellipse=34]="ellipse";ba[ba.teardrop=35]="teardrop";ba[ba.homePlate=36]="homePlate";ba[ba.chevron=37]="chevron";ba[ba.pieWedge=38]="pieWedge";ba[ba.pie=39]="pie";ba[ba.blockArc=40]="blockArc";ba[ba.donut=41]="donut";ba[ba.noSmoking=42]="noSmoking";ba[ba.rightArrow=43]="rightArrow";
ba[ba.leftArrow=44]="leftArrow";ba[ba.upArrow=45]="upArrow";ba[ba.downArrow=46]="downArrow";ba[ba.stripedRightArrow=47]="stripedRightArrow";ba[ba.notchedRightArrow=48]="notchedRightArrow";ba[ba.bentUpArrow=49]="bentUpArrow";ba[ba.leftRightArrow=50]="leftRightArrow";ba[ba.upDownArrow=51]="upDownArrow";ba[ba.leftUpArrow=52]="leftUpArrow";ba[ba.leftRightUpArrow=53]="leftRightUpArrow";ba[ba.quadArrow=54]="quadArrow";ba[ba.leftArrowCallout=55]="leftArrowCallout";ba[ba.rightArrowCallout=56]="rightArrowCallout";
ba[ba.upArrowCallout=57]="upArrowCallout";ba[ba.downArrowCallout=58]="downArrowCallout";ba[ba.leftRightArrowCallout=59]="leftRightArrowCallout";ba[ba.upDownArrowCallout=60]="upDownArrowCallout";ba[ba.quadArrowCallout=61]="quadArrowCallout";ba[ba.bentArrow=62]="bentArrow";ba[ba.uturnArrow=63]="uturnArrow";ba[ba.circularArrow=64]="circularArrow";ba[ba.leftCircularArrow=65]="leftCircularArrow";ba[ba.leftRightCircularArrow=66]="leftRightCircularArrow";ba[ba.curvedRightArrow=67]="curvedRightArrow";ba[ba.curvedLeftArrow=
68]="curvedLeftArrow";ba[ba.curvedUpArrow=69]="curvedUpArrow";ba[ba.curvedDownArrow=70]="curvedDownArrow";ba[ba.swooshArrow=71]="swooshArrow";ba[ba.cube=72]="cube";ba[ba.can=73]="can";ba[ba.lightningBolt=74]="lightningBolt";ba[ba.heart=75]="heart";ba[ba.sun=76]="sun";ba[ba.moon=77]="moon";ba[ba.smileyFace=78]="smileyFace";ba[ba.irregularSeal1=79]="irregularSeal1";ba[ba.irregularSeal2=80]="irregularSeal2";ba[ba.foldedCorner=81]="foldedCorner";ba[ba.bevel=82]="bevel";ba[ba.frame=83]="frame";ba[ba.halfFrame=
84]="halfFrame";ba[ba.corner=85]="corner";ba[ba.diagStripe=86]="diagStripe";ba[ba.chord=87]="chord";ba[ba.arc=88]="arc";ba[ba.leftBracket=89]="leftBracket";ba[ba.rightBracket=90]="rightBracket";ba[ba.leftBrace=91]="leftBrace";ba[ba.rightBrace=92]="rightBrace";ba[ba.bracketPair=93]="bracketPair";ba[ba.bracePair=94]="bracePair";ba[ba.straightConnector1=95]="straightConnector1";ba[ba.bentConnector2=96]="bentConnector2";ba[ba.bentConnector3=97]="bentConnector3";ba[ba.bentConnector4=98]="bentConnector4";
ba[ba.bentConnector5=99]="bentConnector5";ba[ba.curvedConnector2=100]="curvedConnector2";ba[ba.curvedConnector3=101]="curvedConnector3";ba[ba.curvedConnector4=102]="curvedConnector4";ba[ba.curvedConnector5=103]="curvedConnector5";ba[ba.callout1=104]="callout1";ba[ba.callout2=105]="callout2";ba[ba.callout3=106]="callout3";ba[ba.accentCallout1=107]="accentCallout1";ba[ba.accentCallout2=108]="accentCallout2";ba[ba.accentCallout3=109]="accentCallout3";ba[ba.borderCallout1=110]="borderCallout1";ba[ba.borderCallout2=
111]="borderCallout2";ba[ba.borderCallout3=112]="borderCallout3";ba[ba.accentBorderCallout1=113]="accentBorderCallout1";ba[ba.accentBorderCallout2=114]="accentBorderCallout2";ba[ba.accentBorderCallout3=115]="accentBorderCallout3";ba[ba.wedgeRectCallout=116]="wedgeRectCallout";ba[ba.wedgeRoundRectCallout=117]="wedgeRoundRectCallout";ba[ba.wedgeEllipseCallout=118]="wedgeEllipseCallout";ba[ba.cloudCallout=119]="cloudCallout";ba[ba.cloud=120]="cloud";ba[ba.ribbon=121]="ribbon";ba[ba.ribbon2=122]="ribbon2";
ba[ba.ellipseRibbon=123]="ellipseRibbon";ba[ba.ellipseRibbon2=124]="ellipseRibbon2";ba[ba.leftRightRibbon=125]="leftRightRibbon";ba[ba.verticalScroll=126]="verticalScroll";ba[ba.horizontalScroll=127]="horizontalScroll";ba[ba.wave=128]="wave";ba[ba.doubleWave=129]="doubleWave";ba[ba.plus=130]="plus";ba[ba.flowChartProcess=131]="flowChartProcess";ba[ba.flowChartDecision=132]="flowChartDecision";ba[ba.flowChartInputOutput=133]="flowChartInputOutput";ba[ba.flowChartPredefinedProcess=134]="flowChartPredefinedProcess";
ba[ba.flowChartInternalStorage=135]="flowChartInternalStorage";ba[ba.flowChartDocument=136]="flowChartDocument";ba[ba.flowChartMultidocument=137]="flowChartMultidocument";ba[ba.flowChartTerminator=138]="flowChartTerminator";ba[ba.flowChartPreparation=139]="flowChartPreparation";ba[ba.flowChartManualInput=140]="flowChartManualInput";ba[ba.flowChartManualOperation=141]="flowChartManualOperation";ba[ba.flowChartConnector=142]="flowChartConnector";ba[ba.flowChartPunchedCard=143]="flowChartPunchedCard";
ba[ba.flowChartPunchedTape=144]="flowChartPunchedTape";ba[ba.flowChartSummingJunction=145]="flowChartSummingJunction";ba[ba.flowChartOr=146]="flowChartOr";ba[ba.flowChartCollate=147]="flowChartCollate";ba[ba.flowChartSort=148]="flowChartSort";ba[ba.flowChartExtract=149]="flowChartExtract";ba[ba.flowChartMerge=150]="flowChartMerge";ba[ba.flowChartOfflineStorage=151]="flowChartOfflineStorage";ba[ba.flowChartOnlineStorage=152]="flowChartOnlineStorage";ba[ba.flowChartMagneticTape=153]="flowChartMagneticTape";
ba[ba.flowChartMagneticDisk=154]="flowChartMagneticDisk";ba[ba.flowChartMagneticDrum=155]="flowChartMagneticDrum";ba[ba.flowChartDisplay=156]="flowChartDisplay";ba[ba.flowChartDelay=157]="flowChartDelay";ba[ba.flowChartAlternateProcess=158]="flowChartAlternateProcess";ba[ba.flowChartOffpageConnector=159]="flowChartOffpageConnector";ba[ba.actionButtonBlank=160]="actionButtonBlank";ba[ba.actionButtonHome=161]="actionButtonHome";ba[ba.actionButtonHelp=162]="actionButtonHelp";ba[ba.actionButtonInformation=
163]="actionButtonInformation";ba[ba.actionButtonForwardNext=164]="actionButtonForwardNext";ba[ba.actionButtonBackPrevious=165]="actionButtonBackPrevious";ba[ba.actionButtonEnd=166]="actionButtonEnd";ba[ba.actionButtonBeginning=167]="actionButtonBeginning";ba[ba.actionButtonReturn=168]="actionButtonReturn";ba[ba.actionButtonDocument=169]="actionButtonDocument";ba[ba.actionButtonSound=170]="actionButtonSound";ba[ba.actionButtonMovie=171]="actionButtonMovie";ba[ba.gear6=172]="gear6";ba[ba.gear9=173]=
"gear9";ba[ba.funnel=174]="funnel";ba[ba.mathPlus=175]="mathPlus";ba[ba.mathMinus=176]="mathMinus";ba[ba.mathMultiply=177]="mathMultiply";ba[ba.mathDivide=178]="mathDivide";ba[ba.mathEqual=179]="mathEqual";ba[ba.mathNotEqual=180]="mathNotEqual";ba[ba.cornerTabs=181]="cornerTabs";ba[ba.squareTabs=182]="squareTabs";ba[ba.plaqueTabs=183]="plaqueTabs";ba[ba.chartX=184]="chartX";ba[ba.chartStar=185]="chartStar";ba[ba.chartPlus=186]="chartPlus"})(ki||(ki={}));Object(h.b)("ST_ShapeType",ki);var xi=d(158);
class Pg{constructor(){this.RowId=this.ColId=null}}Object(h.a)(Pg,"TableCellInfo",null,[]);var Ej=d(918),Hh=d(52),gh=d(189),Ie=d(125),eg=d(174),yi=d(1150),Fj=d(944),Yh=d(945),ei=d(356),Hi=d(107);class yh{constructor(ba,Aa){this.Swa=this.wDb=null;this.nKg=!1;this.BFe=ba;this.Dg=Aa}get O3j(){return this.nKg}TLb(ba,Aa){Aa&&ba.removeNotification(Aa);return Aa}D5k(ba){this.wDb=this.TLb(ba,this.wDb);this.TLb(ba,this.Swa);this.Swa=this.wDb=null}bxl(ba,Aa,Pa){ba?this.BFe.Mm.isVisible&&1===ba.ZM.length&&Aa.Ba&&
bd.a.hba(ba.o$a.Db,Aa.Ba.Db)||Wf.UISurfaces.FL().then(ub=>{this.Swa=this.TLb(ub,this.Swa);this.Swa=null;var Lb=Object.assign(new yi.a,{label:ba.CKb,onExecute:()=>{ba.primaryButtonAction(this.BFe,Aa);Aa.Ba.ue!==ba.o$a.ue&&Pa.$J(ba.o$a.ue);this.TLb(ub,this.Swa);this.Swa=null}}),Mb=Object.assign(new yi.a,{label:ba.Tqd,onExecute:()=>{this.nKg=!0;this.TLb(ub,this.Swa);this.Swa=null}});Mb=Object.assign(new Fj.a,{target:".EditingRibbonPanel",title:ba.title,content:ba.content,primaryButtonProps:Lb,secondaryButtonProps:Mb,
useTeachingStyles:!1,showCloseIcon:!0,calloutProps:Object.assign(new Yh.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1,onDismiss:()=>{this.Dg.Eo(Jd.a.J1a)},preventDismissOnScroll:!0,preventDismissOnResize:!0})});Lb=Object.assign(new ei.a,{onShow:()=>{this.Dg.DI(Jd.a.J1a)}});Mb=ub.callout(Mb);this.Swa=ub.addNotification(Mb,Lb)}):Jb.a.J(546153881,805,50,"SharedCommentFrame::ShowReviewResolvedCommentsCallout - Trying to show review resolved comments callout when params are null.")}TBh(ba,Aa){const Pa=
new Hi.StandardDialog;Pa.Ad=4;Pa.Tx(ResourceStrings.l_DeleteAllCommentsConfirmationTitle,Aa?ResourceStrings.l_DeleteAllResolvedCommentsConfirmation:ResourceStrings.l_DeleteAllCommentsConfirmation,1,ub=>{1===ub?(ba.g4b(Aa),this.BFe.E6d(Aa)?this.UBh():this.SBh(Aa?ResourceStrings.l_DeleteAllResolvedCommentsInPresentationCallout:ResourceStrings.l_DeleteAllCommentsInPresentationCallout),Jb.a.J(546153882,805,50,"SharedCommentFrame::ShowDeleteAllConfirmationDialog - Yes button clicked for DeleteAllComments - fDeleteAllResolved: {0}",
Aa)):Jb.a.J(546153883,805,50,"SharedCommentFrame::ShowDeleteAllConfirmationDialog - No button clicked for DeleteAllComments - fDeleteAllResolved: {0}",Aa)})}UBh(){const ba=new Hi.StandardDialog;ba.Ad=0;ba.Tx(ResourceStrings.l_DeleteAllCommentsErrorTitle,ResourceStrings.l_DeleteAllCommentsError,1,null)}SBh(ba){const Aa=()=>{this.Dg.DI(Jd.a.J1a)},Pa=()=>{this.Dg.Eo(Jd.a.J1a)};Wf.UISurfaces.FL().then(ub=>{this.TLb(ub,this.wDb);this.wDb=null;var Lb=Object.assign(new Fj.a,{target:".EditingRibbonPanel",
title:ResourceStrings.l_DeleteAllCommentsCalloutTitle,content:ba,showCloseIcon:!0,useTeachingStyles:!1,calloutProps:Object.assign(new Yh.a,{directionalHint:6,isBeakVisible:!1,onDismiss:Pa,preventDismissOnScroll:!0,preventDismissOnResize:!0})});const Mb=Object.assign(new ei.a,{onShow:Aa});Lb=ub.callout(Lb);this.wDb=ub.addNotification(Lb,Mb)})}}Object(h.a)(yh,"CommentCalloutDialogManager",null,[]);var La=d(984);class sb{constructor(ba){this.iIa=ba;this.pna=[];this.Eve=new La.a(1E3,Object(qa.a)(this,
this.perform,"perform"))}qQk(ba){Array.contains(this.pna,ba)||Array.add(this.pna,ba);this.Eve.perform()}perform(){const ba=this.pna;this.pna=[];for(let Aa=0;Aa<ba.length;Aa++){const Pa=ba[Aa];this.iIa.cIb(Pa.commentId,new Qc.a(Pa.pos.X,Pa.pos.Y))}}}Object(h.a)(sb,"CommentKeyboardMoveController",null,[]);class Ob{constructor(ba,Aa,Pa,ub,Lb){this.QGa=this.Vwa=null;this.ufa=[];if(!ba)throw Error.argumentNull("parentElement");if(!Aa)throw Error.argumentNull("frame");this.uFb=Pa;this.Sk=ba;this.jb=Aa;
this.tDg=ub;this.BDg=Lb}dispose(){this.RUe();this.jb=this.Sk=null}RUe(){this.QGa=this.Vwa=null;if(this.ufa&&0<this.ufa.length){for(const ba of this.ufa)ba&&ba.dispose();Array.clear(this.ufa)}}y_(ba){if(!this.oEa)return!0;if(!ba||!ba.length)return!1;ba=eg.e(ba,Aa=>0===Aa.status);return!!ba&&0<ba.length}uod(ba){this.RUe();if(ba&&this.Sk){var Aa=this.jb.isReadOnly?null:this.jb.mu;for(const Pa of ba)this.ufa.push(this.uFb.create(Pa,this.Sk,this,Aa,this.jb.isReadOnly,Oc.XN(Pa)||!this.BDg));this.y_(ba)&&
this.r9e()}}selectComment(ba,Aa){if(!(!ba&&!this.Vwa||this.Vwa&&Oc.Xwb(ba,this.Vwa.comment))&&(this.Vwa&&this.Vwa.select(!1),this.Vwa=null,ba))for(const Pa of this.ufa){if(Oc.Xwb(Pa.comment,ba)){this.Vwa=Pa;Pa.select(!0);break}if(Aa&&Pa.comment.Children)for(const ub of Pa.comment.Children)if(Oc.Xwb(ub,ba)){this.Vwa=Pa;Pa.select(!0);return}}}tsb(ba,Aa){if(!(!ba&&!this.QGa||this.QGa&&Oc.Xwb(ba,this.QGa.comment))&&(this.QGa&&this.QGa.activate(!1),this.QGa=null,ba))for(const Pa of this.ufa){if(Oc.Xwb(Pa.comment,
ba)){this.QGa=Pa;Pa.activate(!0);break}if(Aa&&Pa.comment.Children)for(const ub of Pa.comment.Children)if(Oc.Xwb(ub,ba)){this.QGa=Pa;Pa.activate(!0);return}}}iCh(ba){for(const Aa of this.ufa)Aa.hCh(ba)}r9e(){for(const ba of this.ufa)ba.updatePosition(this.jb.nDa(ba.comment.pos.X,ba.comment.pos.Y))}cIb(ba,Aa){Aa=this.jb.MNf(Aa._x,Aa._y);ba.pos.X+=Aa._x;ba.pos.Y+=Aa._y;Aa=new Qc.a(ba.pos.X,ba.pos.Y);this.jb.selectComment(ba,null,!0,!1,0,1,!1);this.jb.manager.cIb(ba.commentId,Aa)}dPl(ba){for(const Aa of this.ufa)if(Aa.comment===
ba){Aa.updatePosition(this.jb.nDa(Aa.comment.pos.X,Aa.comment.pos.Y));break}}ePl(ba){for(const Aa of ba)for(const Pa of this.ufa)Pa.comment.commentId===Aa.commentId&&Pa.updatePosition(this.jb.nDa(Pa.comment.pos.X,Pa.comment.pos.Y))}setVisibility(ba){this.BDg=ba;for(const Aa of this.ufa)Aa.setVisibility(!Oc.XN(Aa.comment)&&ba)}get frame(){return this.jb}get isRightToLeft(){return this.tDg}set isRightToLeft(ba){this.tDg=ba}get parentElement(){return this.Sk}set parentElement(ba){this.Sk=ba}get cNb(){return this.Vwa}get oEa(){return!!e.AFrameworkApplication.fa&&
e.AFrameworkApplication.fa.ka("SlideResizePerfImprovementEnabled")}}Object(h.a)(Ob,"CommentMarkerView",null,[]);class pc{constructor(){this.comment=this.slide=null;this.direction=0;this.FYe=null}}Object(h.a)(pc,"CommentSelectContext",null,[]);var Kc;(function(ba){ba[ba.previous=0]="previous";ba[ba.next=1]="next"})(Kc||(Kc={}));Object(h.b)("CommentSelectDirection",Kc);class Gd{constructor(ba,Aa){if(!ba||1>ba.length)throw Error.argument("ISlideNode[] slides");if(!Aa)throw Error.argumentNull("ICommentGraphManager graphManager");
this.Aqk=ba;this.vl=Aa;this.ZEe=[];this.init()}get nKa(){return this.Aqk}get ZM(){return this.ZEe}get o$a(){return this.ZM[this.ZM.length-1]}get CKb(){return 1<this.ZM.length?ResourceStrings.L_CommentReviewResolvedCalloutGoToButton:ResourceStrings.L_CommentReviewResolvedCalloutReviewButton}get Tqd(){return ResourceStrings.L_CommentReviewResolvedCalloutDontShowButton}get title(){return ResourceStrings.L_CommentReviewResolvedCalloutTitle}get content(){return this.zyl()}init(){for(const ba of this.nKa)for(const Aa of this.vl.Uta(ba.qE()))if(1===
Aa.status){this.ZEe.push(ba);break}if(1>this.ZEe.length)throw Error.argument("ISlideNode[] slides contains no resolved comments.");}zyl(){switch(this.ZM.length){case 1:return ResourceStrings.L_CommentReviewResolvedCalloutContentSlides1;case 2:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides2,this.ZM[1].ue+1,this.ZM[0].ue+1);case 3:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides3,this.ZM[2].ue+1,this.ZM[1].ue+1,this.ZM[0].ue+1);case 4:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides4,
this.ZM[3].ue+1,this.ZM[2].ue+1,this.ZM[1].ue+1);default:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlidesN,this.ZM[this.ZM.length-1].ue+1,this.ZM[this.ZM.length-2].ue+1,this.ZM[this.ZM.length-3].ue+1,this.ZM.length-3)}}thj(){for(const ba of this.vl.O$a(this.o$a))if(1===ba.status)return ba;return null}primaryButtonAction(ba,Aa){if(!Aa.presentation||!Aa.presentation.slides)return Jb.a.J(571269902,805,10,"ResolvedCommentsCalloutParams::PrimaryButtonAction - Failed to show callout due to null {0}",
Aa.presentation?"Presentation.Slides":"Presentation"),null;const Pa=this.thj();if(!Pa)return null;ba.Mm.isVisible||ba.Vtd();if(Aa.Ba&&bd.a.hba(Aa.Ba.Db,this.o$a.Db))ba.Fga(Pa.commentId,1,!0);else for(const ub of Aa.presentation.slides)if(bd.a.hba(ub.Db,this.o$a.Db))return Object.assign(new pc,{slide:this.o$a,comment:Pa,direction:1,FYe:Ze.a.kk("SelectResolvedCommentCrossSlide",1)});return null}}Object(h.a)(Gd,"ResolvedCommentsCalloutParams",null,[]);class he{constructor(){this.type="SharedCommentsTaskPaneProps";
this.focusCallback=null}}Object(h.a)(he,"SharedCommentsTaskPaneProps",null,[]);var Ue=d(994),Rf=d(441),sf=d(151);class ag{constructor(ba,Aa,Pa,ub,Lb,Mb,kd,Id,ce,Xe,jd,rd,Wc,wd,Fe,ak,tj,bh,ee,Mi,Nl,Cg,zi,Zh,ch,kk,Vi,kj,Ni,ph,Ck,Rj,Jk,hk,Bl,ie,df,uj,Xl,Sj,bk,Ii,Kk,Ch,fi,Lk,$h,Yl,Cl,ol,Zk,lk,$k,cj,fg,al,gi,rm){this.tFe=this.Cn=null;this.reb=!0;this.Sn=this.wxe=this.Mfc=this.dxe=this.teb=!1;this.Ifb=0;this.kdd=this.EGb=!1;this.eHa=this.scd=this.mi=this.YWa=this.Mgb=this.X$=this.Uxg=null;this.vDg=this.eYa=
!1;this.Or=null;this.HFe=this.Owe=!1;this.uXg=null;this.wGf=[Jd.a.Lz,Jd.a.Kp,Jd.a.BW,Jd.a.sDi];this.Onb=2147483647;this.KCb=0;this.NLg=-1;this.Qzg=0;this.cic=null;this.vbd=this.fcd=this.Pue=!1;this.$Ja=(xa,Ff)=>{Ff.slide===this.ta.Ba&&(xa=this.AR.instance.yfe||this.AR.instance.zfe,!Ff.slide.isUnread||xa)&&(Ff=this.vl.lz(),this.KLb(Ff,e.AFrameworkApplication.isRtl,!0))};if(!ie)throw Error.argumentNull("appSettingsManager");if(!Cg)throw Error.argumentNull("commentEventHost");if(!Aa)throw Error.argumentNull("commentTelemetryManager");
if($k.Un&&!rm)throw Error.argumentNull("sorterViewActorLazy");this.GH=Zk;this.ia=Pa;this.Vb=ub;this.Mm=Lb;this.mu=Mb;this.Rc=kd;this.Fa=Id;this.Dg=ce;this.ke=Xe;this.pa=jd;this.Kc=Wc;this.Gy=wd;this.Us=Fe;this.vl=ba;this.CE=Aa;this.zkk=new sb(ba);this.u5=ak;this.ta=tj;this.Hed=bh.yd(40);this.XNg=zc.a("PreventCommentDraftDeletionOnPageContentChange")?bh.yd(7):bh.yd(8);this.SFb=rd;this.OO=Wc.Jc?Wc.Jc.RZd:null;this.kwa=ch;this.wb=Mi;this.t0=Cg;this.shb=zi;this.LMg=Nl;this.ddd=Zh;this.Que=kk;this.q8c=
Vi;this.De=ph;this.nbd=kj;this.Vq=Ni;this.L6c=Ck;this.Ts=Rj;this.uFb=Jk;this.FR=hk;this.oo=Bl;this.Jb=ie;this.Js=uj;this.ZCg=Xl;this.L4=new m.a;this.Ud=Sj;this.Ya=bk;this.Igb=Kk;this.Vva=Ii;this.Ic=Ch;this.Ga=$h;this.Dpk=Yl;this.BJ=Cl;this.Rfc=ol;this.Ea=$k;this.Hh=cj;this.CX=fg;this.Jfc=Lk;this.YHa=!1;this.ia.Kaa(this);this.Qdb=new yh(this,this.Dg);this.AR=al;this.V0=gi;this.Gna=rm;if(!df)throw Error.argumentNull("InteractiveViewManagerFuture");this.GGg=df;this.mek=this.mJi();this.GH&&this.Mm.Tjl(this.fnj());
this.Rb=lk;fi.zvb().then(xa=>{xa||this.BZe(!1)})}get ZRc(){return this.ZCg}get J6d(){return this.Jb.ka("195")}get IZf(){return this.Vva}get a4b(){return this.Jb.Ha("CurrentCommentId")}get u2d(){return this.Jb.Ha("CurrentSlideId")}get u2b(){return this.Jb.ka("PptReactTabbedTaskPanesM2IsEnabled")}get MRk(){return this.Jb.ka("PPTSafeLinksIsEnabledForModernComments")}get GDi(){return this.Jb.ka("CommentTextAnchoringReadWriteEnabled")}get VZd(){return this.Jb.ka("CommentTextAnchoringCreateNewEnabled")}get vWf(){return this.Jb.ka("EnableDeleteAllComments")}get oEa(){return this.Jb.ka("SlideResizePerfImprovementEnabled")}get Awb(){return zc.a("CompactingDHCsEnabled")}get yZf(){return zc.a("CanvasToCommentFocusFixV2")}get tac(){return this.Jb.ka("PPTOBlueDotsForComments")}initialize(){this.Sn=
1===this.Vb.mode;this.GH||(this.kwa?Sys.UI.DomElement.addCssClass(this.SFb,Ee.Idl):Sys.UI.DomElement.addCssClass(this.SFb,Ee.Hdl));const ba=this.Fa.Fc(Jd.a.Kp);ba.uJ=!0;ba.c3a=!0;ba.Lca(Pa=>{const ub=!zc.a("FixAltF12KeboardingInCommentPane")||!Pa||Pa.name!==Jd.a.hN;this.Amc(!0,!Pa||Pa.name!==Jd.a.Lz&&ub,!0)});ba.vCa((Pa,ub)=>{Pa=(ub.name===Jd.a.jP||ub.name===Jd.a.Raa)&&Pa.name===Jd.a.Kp;this.Amc(!1,!1,ub.name===Jd.a.Kp||ub.name===Jd.a.vg||ub.name===Jd.a.Lz||ub.name===Jd.a.BW||this.u2b&&ub.name===
Jd.a.hN||Pa)});const Aa=this.Fa.Fc(Jd.a.Lz);Aa.Lca((Pa,ub)=>{this.pGk(Pa,ub)});Aa.vCa(()=>{this.oGk()});this.GH||this.Rc.QLb(fb.a.click,this.SFb,Object(qa.a)(this,this.PIb,"onCommentPaneParentDivClick"),null,ba.c3a);this.vb();this.Gy.dTd(Object(qa.a)(this,this.SJa,"onBeforeSlideSwitched"));this.Gy.aT(Object(qa.a)(this,this.S8e,"updateCommentsWhenNavigateSlide"));this.Us.GQa(Object(qa.a)(this,this.Fwf,"activeSlideDOMDisplayed"));this.Vq.vhi(Object(qa.a)(this,this.V$g,"onPageViewZoomChanged"));this.Js.Pzf(Object(qa.a)(this,
this.onShapeSelected,"onShapeSelected"));this.Js.Zhi(Object(qa.a)(this,this.Uah,"onShapeDeselected"));this.Gy.D_b(Object(qa.a)(this,this.ebh,"onShapeTextSelected"));this.Gy.zTd(Object(qa.a)(this,this.fnc,"onSlideBackgroundClicked"));this.Jfc&&(this.Gy.E_b(Object(qa.a)(this,this.WHk,"onSlideSizeUpdated")),this.Gy.fii(Object(qa.a)(this,this.cbh,"onShapeRotatedOrBoundsUpdated")),this.Gy.bii(Object(qa.a)(this,this.cbh,"onShapeRotatedOrBoundsUpdated")));this.Hed.fk(Object(qa.a)(this,this.$bh,"onTextAnchorPropertyChanged"));
this.XNg.IF(Object(qa.a)(this,this.$B,"onChildTopologyChanged"));this.Hed.ACa(Object(qa.a)(this,this.Z7g,"onBeforeTextAnchorDisconnect"));this.Igb.fk(Object(qa.a)(this,this.bnc,"onShapePropertyChange"));this.Igb.shi(Object(qa.a)(this,this.Yah,"onShapeInvalidation"));this.Ic.tfi(Object(qa.a)(this,this.h9g,"onF6FocusDocument"));this.Ic.fJc(Object(qa.a)(this,this.uib,"onSetFocus"));this.tac&&this.V0.execute(Pa=>{Pa.pJc(this.$Ja)});this.L6c.wTd(Object(qa.a)(this,this.Mjd,"onSessionExpired"));this.L6c.GC(Object(qa.a)(this,
this.Qxa,"onSessionEnded"));this.Kc.Jc&&this.Kc.Jc.RZd&&(this.SJa(this,null),this.S8e(this,null));this.Vb.GI(Object(qa.a)(this,this.G7g,"onAppModeSwitched"));this.Vb.JQa(Object(qa.a)(this,this.tY,"onSetOffline"));this.Us.Msb(Object(qa.a)(this,this.Ojd,"onShapeViewElementAddedOrRemoved"));this.Us.Rzf(Object(qa.a)(this,this.Ojd,"onShapeViewElementAddedOrRemoved"));this.pa.fE(Object(qa.a)(this,this.QH,"onSelectionChanged"))}Ojd(ba,Aa){this.Cn&&(ba=Aa.$w)&&ba.shapeNode&&this.$2j(ba.shapeNode.slideId)&&
this.Cn.uod(this.vl.lz())}$2j(ba){return!!this.ta&&!!this.ta.pk&&this.ta.pk.equals(ba)}BZe(ba){this.Vva=this.ZCg=ba;this.oo.BZe(ba)}WHk(){this.Cn&&this.Cn.r9e()}cbh(ba,Aa){if(this.Cn){const Pa=Aa.$w.shapeNode;if(Pa){if((ba=this.vl.lz())&&ba.length){Aa=[];for(const ub of ba)ub.anchorShape===Pa.get_shapeId()&&Aa.push(ub);this.Cn.ePl(Aa)}}else Jb.a.J(512496785,805,10,"SharedCommentFrame:OnShapeRotatedOrBoundsUpdated shape is null")}}DOl(){try{if(this.u2b&&this.Mm){const ba=Object(xb.a)(1065,this.Mm);
ba&&(ba.KAh=!!this.mi)}}catch(ba){Jb.a.J(512496784,805,10,"TabbedTaskPane - Exception while updating if draft comment is closed for tabbed flow",ba)}}DZf(){return this.mi&&this.mi.O8&&this.ta.Ba?!bd.a.hba(this.mi.O8,this.ta.Ba.Db):!1}Qwb(){return this.mi&&this.ta.Ba?!this.mi.O8||bd.a.hba(this.mi.O8,this.ta.Ba.Db):!1}Eph(){if(this.Or&&this.Or.isIntegratedExtensionEnabled()){const ba=this.vl.lz(),Aa=!this.oEa||!this.YHa;ba&&0<ba.length&&(this.cS(!0,!0,Aa),this.opd());this.Qwb()&&this.Dph(this.mi)}}KFk(){if(this.Or){this.DOl();
this.Eph();const ba=this.$Mb;ba&&0!==ba.status&&this.bNa(1)}}LFk(){this.k4b();const ba=!this.oEa||!(this.y_()&&this.YHa);this.cS(!1,!1,ba)}YFk(ba){this.KCb!==ba&&(this.KCb=ba,this.Kc&&this.Kc.Jc&&this.Kc.Jc.cOh(2,!1,this.KCb))}zjg(){const ba=Object.assign(new Yg,{paneClosedCallback:Object(qa.a)(this,this.KFk,"onPaneClosedCallback"),paneOpenedCallback:Object(qa.a)(this,this.LFk,"onPaneOpenedCallback"),positionsUpdatedScrollHeightCallback:Object(qa.a)(this,this.YFk,"onPositionUpdatedScrollHeightCallback")});
ba.allContainersVisibleCallback=Object(qa.a)(this,this.FAk,"onAllContainersVisible");this.Or=floatingContainerManager.FactoryGlobal.createFloatingContainerManagerInstance(ba)}POj(){this.MRk&&this.Dpk.execute(ba=>{const Aa=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();Aa?Aa.registerSafelinksNavigator(Object(qa.a)(ba,ba.sxd,"tryNavigate")):Jb.a.J(512496783,805,15,"SharedCommentFrame:InitializeRichContentEditAPI consumerAPI is null. Created successfully:{0}")})}xMj(){this.zjg();
this.cS(!0,!1,!0);this.Owe=!0;const ba=this.m7b();ac.a.Aod(ba,[fb.a.contextMenu]);if(this.Or){this.Or.setDhcContainerPanel(ba,this.kwa);var Aa=Object.assign(new Xh,{width:parseFloat(ba.style.width),height:this.Onb,x:0,y:0});this.Or.updateViewport(Aa);this.Or.setCompactContainers(this.Awb)}this.opd();this.CE.eDk(this.ta.pk);Aa=this.Fa.Fc(Jd.a.BW);Aa.uJ=!0;Aa.c3a=!0;Aa.Lca(Pa=>{this.Amc(!0,!Pa||Pa.name!==Jd.a.Lz,!0)});Aa.vCa((Pa,ub)=>{Pa=(ub.name===Jd.a.jP||ub.name===Jd.a.Raa)&&Pa.name===Jd.a.BW;this.Amc(!1,
!1,ub.name===Jd.a.Kp||ub.name===Jd.a.vg||ub.name===Jd.a.Lz||ub.name===Jd.a.BW||this.u2b&&ub.name===Jd.a.hN||Pa)});this.Fa.SZc(Jd.a.BW,Jd.a.Xi,ba);this.Hmh();this.ia.ya(fe.a.V1,ab.a.frame,Object(qa.a)(this,this.V1,"showHideComments"))}opd(){const ba=this.vl.lz();this.Aph(ba)}Hmh(){if(this.Or){const ba=this.m7b();if(ba){const Aa=this.Fa.Fc(Jd.a.BW);this.Rc.QLb(fb.a.click,ba,Object(qa.a)(this,this.PIb,"onCommentPaneParentDivClick"),null,Aa.c3a)}}}wMh(){if(this.Or){const ba=this.m7b();ba&&this.Rc.Bb(fb.a.click,
ba,Object(qa.a)(this,this.PIb,"onCommentPaneParentDivClick"))}}m7b(){const ba=this.Kc&&this.Kc.Jc?this.Kc.Jc.fda:null;return ba?ba.va:null}Aph(ba){if(this.Kc.Jc&&this.Owe){if(!this.Or)try{this.zjg(),Jb.a.J(512496782,801,15,"SharedCommentFrame::RenderCommentContainers - m_containerManager is null. Created successfully:{0}",!!this.Or)}catch(ub){Jb.a.J(512496781,801,10,"SharedCommentFrame::RenderCommentContainers - Error creating m_containerManager: {0}",ub);return}var Aa=Date.now();if((ba=this.XSf(ba))&&
ba.length){var Pa=this.m7b();Pa.setAttribute(cb.a.hf,"group");if(Pa){this.L4=this.vdj(ba);Jb.a.J(512496780,801,50,"SharedCommentFrame::RenderCommentContainers - Content anchor positions: {0}",this.L4.count);if(!this.L4.count&&!this.HVa){this.cS(!1,!1,!0);Jb.a.J(512496779,801,50,"SharedCommentFrame::RenderCommentContainers - Time taken:{0} ms",Date.now()-Aa);return}this.Or.setDhcContainerPanel(Pa,this.kwa);this.Or.attachContainers(this.L4.toArray());this.cS(!0,!1,!0)}Jb.a.J(512496778,801,50,"SharedCommentFrame::RenderCommentContainers Time taken:{0} ms",
Date.now()-Aa)}}}XSf(ba){if(!ba||!ba.length)return ba;const Aa=new m.a;for(const Pa of ba)0!==Pa.status?this.WSf(Pa.commentId):Aa.add(Pa);return Aa.toArray()}fQl(){this.Pue=!1;if(!this.oo.ADh&&!this.oo.IW&&this.Kc.Jc){var ba=this.vl.O$a(this.Kc.Jc.gd);for(const Aa of ba)if(0===Aa.status){this.selectComment(Aa,null,!0,!0,0,0,!1);break}}}wsj(){if(!this.Kc||!this.Kc.Jc||!this.Kc.Jc.gd)return this.Onb;var ba=this.Kc.Jc.gd;if(isNaN(ba.Vk))return this.Onb;ba=ba.Vk;return 0>ba?this.Onb:ba}M3f(ba){var Aa=
this.oo.T8(ba);ba=ba.pos.Y;Aa&&(ba+=Aa.kC.y,Aa.Ug&&(Aa=this.Ga.Cs(Aa),ba+=Aa&&Aa.kC?Aa.kC.y:0));return this.nDa(0,ba).y}W8e(){if(this.Or){const ba=this.wsj();ba!==this.NLg&&(this.NLg=ba,this.Or.setSlideHeight(ba))}}Dph(ba){if(ba&&0===ba.ORa){var Aa=0;if(this.Awb)Aa=-this.Onb,this.W8e();else{const Pa=this.pa.fo();Pa&&(Aa=this.nDa(0,Pa.kC.y).y)}Aa=Object.assign(new Gh,{contentId:ba.UC.draftId,containerContentType:0,anchorTop:Aa,anchorLeft:0});this.cS(!0,!0,!0);this.Or.setDhcContainerPanel(this.m7b(),
this.kwa);this.Or.updateDrafting(Aa,!0);this.Or.selectContainer(ba.UC.draftId,!0)}}i$k(ba){if(this.L4){var Aa=0,Pa="";if(this.Awb){var ub=this.pa.fo();ub&&(Aa=this.nDa(0,ub.kC.y).y);if(ub=this.vl.lz())for(const Lb of ub)Rb.a.Xa(Lb.commentId)||this.M3f(Lb)!==Aa||(Pa=Lb.commentId)}Aa=Object.assign(new Gh,{contentId:ba,containerContentType:0,anchorTop:Aa,anchorLeft:0});this.Awb?this.Or.updateDraftingAndPosition(Aa,!1,Pa):this.Or.updateDrafting(Aa,!1);this.Or.selectContainer(ba,!0)}}WSf(ba){if(this.Or&&
this.L4){for(let Aa of this.L4)ag.b3g(Aa,ba)&&(this.Or.detachContainers([Aa]),this.L4.remove(Aa));this.y_()||this.HVa||this.cS(!1,!1,!0)}}Pjl(){this.Pue=!0}qRc(){this.u2b&&this.Mm&&this.Mm.isVisible&&this.Mm.sgl()}X1i(){var ba=this.ta.presentation;if(!ba)return!1;ba=ba.slides;if(!ba)return!1;for(const Aa of ba)if(ba=Object(xb.a)(Be.a,Aa))for(const Pa of this.vl.Uta(ba.qE()))if(Oc.XN(Pa))return!0;return!1}ade(ba){var Aa=this.ta.presentation;if(!Aa)return null;Aa=Aa.slides;if(!Aa)return null;for(const Pa of Aa)if(Aa=
Object(xb.a)(Be.a,Pa),bd.a.hba(Aa.Db,ba))return Aa;return null}O1i(){return this.VZd||this.GDi&&this.X1i()}acg(){const ba=this.pa.Pa.mb,Aa=this.pa.Pa.N6;if(!ba||!Aa)return null;var Pa=Object(xb.a)(5,ba.Va.node),ub=Object(xb.a)(5,Aa.Va.node);if(!Pa||!ub)return null;Pa=Object(xb.a)(gh.TableCellNode,Pa.AL());ub=Object(xb.a)(gh.TableCellNode,ub.AL());return Pa&&ub?Pa.rowIndex>ub.rowIndex?ba:Aa:null}Huj(){if(!this.O1i()||!this.pa.S_())return null;Jb.a.J(512496777,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Begin.");
var ba=0,Aa=0;if(this.pa.Pa.Sl){var Pa=this.acg();if(!Pa)return Jb.a.J(512496776,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, table cell selection is null."),null;var ub=Pa}else ub=this.pa.Pa.mb;if(!ub)return Jb.a.J(512496775,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, current selection is null."),null;const Lb=({qMa:ba,dEa:Aa}=Oc.Guj(this.pa.I_(),ub,ba,Aa)).returnValue;if(!Lb||0>ba||0>Aa||0>=Aa-ba)return Jb.a.J(512496774,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, invalid text anchor ParagraphNode is null:{0}, EndPos:{1}, StartPos:{2}.",
!Lb,Aa,ba),null;Pa=new Ej.a;Pa.StartPos=ba;Pa.EndPos=Aa;if(this.pa.kWa()&&Lb.get_smartArtModelId()){Jb.a.J(512496773,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Text selection in SmartArt.");Pa.AnchoringShape=new Wd.a;ba=T.a.Jf(Lb.get_smartArtModelId()).toString();if(!ba||!T.a.isValid(ba))return Jb.a.J(512496772,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, Smart Art node ID string is null:{0} or invalid.",!ba),null;Pa.AnchoringShape.SmartArtNodeId=ba;
this.CE.ddk()}else if(Lb.Gs()){Jb.a.J(512496771,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Text selection in table.");Aa=Object(xb.a)(gh.TableCellNode,Lb.AL());if(!Aa)return Jb.a.J(512496770,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, table cell node is null."),null;ba=Aa.rowId.toString();Aa=Aa.cellId.toString();if(!(ba&&Aa&&T.a.isValid(ba)&&T.a.isValid(Aa)))return Jb.a.J(512496769,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, Row/Col ID string is null:{0}/{1} or invalid.",
!ba,!Aa),null;Pa.AnchoringShape=new Wd.a;Pa.AnchoringShape.TableCell=new Pg;Pa.AnchoringShape.TableCell.RowId=ba;Pa.AnchoringShape.TableCell.ColId=Aa;this.CE.edk()}ba=Object(xb.a)(5,ub.Va.node);ub=Object(xb.a)(5,ub.jf.node);ba!==ub&&this.CE.gdk();Jb.a.J(512496768,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Succeeded.");return Pa}sTi(ba){if(this.Or&&ba){for(const Aa of this.L4.toArray()){let Pa=!1;for(const ub of ba)if(ag.b3g(Aa,ub.commentId)){Pa=!0;break}Pa||(this.Or.detachContainers([Aa]),
this.L4.remove(Aa),Jb.a.J(512496739,801,50,"SharedCommentFrame::DetachDeletedCommentContainers {0}",Aa.contentId))}this.y_()||this.HVa||this.cS(!1,!1,!0)}}k4b(){if(this.Or){for(const ba of this.L4.toArray())this.Or.detachContainers([ba]);this.L4.clear()}this.y_()||this.HVa||(this.oEa&&!this.YHa?this.cS(!1,!1,!1):this.cS(!1,!1,!0))}f3e(ba){if(!ba)return null;ba.sort((Aa,Pa)=>{var ub=this.oo.T8(Aa);ub=ub?ub.kC:new Qc.a(0,0);var Lb=this.oo.T8(Pa);Lb=Lb?Lb.kC:new Qc.a(0,0);ub.y+=Aa.pos.Y;Lb.y+=Pa.pos.Y;
ub.x+=Aa.pos.X;Lb.x+=Pa.pos.X;let Mb=ub.y-Lb.y;Mb||(Mb=ub.x-Lb.x)||(Mb=+Aa.dt-+Pa.dt);return Mb});return ba}vdj(ba){const Aa=new m.a;if(ba){this.Awb&&this.W8e();for(const Pa of ba)Rb.a.Xa(Pa.commentId)||(ba=this.M3f(Pa),ba=Object.assign(new Gh,{contentId:Pa.commentId,containerContentType:0,anchorTop:ba,anchorLeft:0}),Aa.add(ba))}return Aa}tY(ba){this.e$g(ba)}unh(ba,Aa){for(let Pa=0;Pa<ba.Ta.length;Pa++){const ub=ba.Ta.ga(Pa);if(!ub.Bg)continue;const Lb=[];for(let Mb=0;Mb<ub.Bg.length;Mb++){const kd=
ub.Bg.ga(Mb);kd.LI.equals(Aa)&&Lb.push(kd)}if(!(1>Lb.length))try{ba.Kpa=!0;for(const Mb of Lb)ub.Bg.remove(Mb)}catch(Mb){Jb.a.J(512496738,805,10,"SharedCommentFrame::RemoveCommentRange - Exception{0} when trying to remove start/end comment GUIDs",Mb.toString())}finally{ba.Kpa=!1}}}$wf(ba,Aa,Pa){ba.Bg||(ba.Bg=new Zj.a(ba));const ub=ba.Bg.Je.paragraph;Aa=new We.a(ba.Bg.Je,null,Aa,Pa);ba.Bg.add(Aa);ub.jv()}jOc(ba){return Ud.a.Jf("{"+ba+"}{1}")}j_b(ba,Aa,Pa,ub){let Lb=null;for(let Mb=0;Mb<ba.Ta.length;Mb++){let kd=
ba.Ta.ga(Mb);if(kd.cp>=Pa){try{ba.Kpa=!0;if(kd.cp>Pa||!kd.formatting)this.BJ.Tga(ba,Mb,Pa,Lb),kd=ba.Ta.ga(Mb);this.$wf(kd,Aa,ub)}catch(Id){Jb.a.J(512496737,805,10,"SharedCommentFrame::AddCommentRange - Exception{0} when trying to add start/end comment GUIDs",Id.toString())}finally{ba.Kpa=!1}return}kd.formatting&&(Lb=kd.formatting)}if(Pb.ParagraphReader.textLength(ba)>=Pa)try{ba.Kpa=!0;this.BJ.Tga(ba,ba.Ta.length,Pa,Lb);const Mb=ba.Ta.ga(ba.Ta.length-1);this.$wf(Mb,Aa,ub)}catch(Mb){Jb.a.J(512496736,
805,10,"SharedCommentFrame::AddCommentRange - Exception{0} when trying to add start/end comment GUIDs",Mb.toString())}finally{ba.Kpa=!1}}X4b(){var ba=this.vl.lz();if(ba){var Aa=Date.now(),Pa=!1,ub=new Ma.a;for(var Lb of ba){var Mb=Oc.M8b(Lb,this.oo.T8(Lb));ub.$(Lb.commentId,Mb)}for(var kd of ba)if(kd.textAnchoringInfo&&(Lb=this.oo.T8(kd))&&(Mb=ub.ga(kd.commentId),!Mb||!Mb.isValid||Mb.Jsg(kd.textAnchoringInfo)))for(var Id of Lb.nz())this.unh(Object(xb.a)(Hc.AParagraphNode,Id),this.jOc(kd.commentId));
for(const ce of ba)if((ba=ub.ga(ce.commentId))&&ba.isValid&&ba.Jsg(ce.textAnchoringInfo)&&(this.Mm.isVisible||0===ce.status)){Pa=this.jOc(ce.commentId);this.j_b(ba.oV,Pa,ba.startPos,!0);if(ba.ncc)for(kd=1;kd<ba.paragraphs.length;kd++){if(Id=ba.paragraphs[kd])this.j_b(Id,Pa,0,!0),ba.N3.equals(Id)?this.j_b(ba.N3,Pa,ba.endPos,!1):this.j_b(Id,Pa,Pb.ParagraphReader.textLength(Id),!1)}else this.j_b(ba.N3,Pa,ba.endPos,!1);ba.jRj();Pa=!0}Pa&&Jb.a.J(512496735,805,100,"SharedCommentFrame::EditCommentParagraphMarkers - time taken:{0} ms",
Date.now()-Aa)}}$bh(ba,Aa){if((ba=this.vl.Tta(Aa.node))&&(Aa.property===hf.a.Bvc||Aa.property===hf.a.Avc||Aa.property===hf.a.cwd||Aa.property===hf.a.dwd)){const Pa=Oc.XN(ba);Pa&&this.X4b();!ba.textAnchoringInfo||Pa||Aa.property!==hf.a.dwd&&Aa.property!==hf.a.cwd||this.CE.fdk(ba,this.jOc(ba.commentId),this.oo.T8(ba),this.Kc.Jc.Na)}}SWf(){this.mi&&this.X$&&(this.t0.WYe(this.X$.length,this.Ifb,this.Sn,this.Que.g4c),this.t0.$Ye(Array.clone(this.X$),Array.clone(this.Mgb)),this.rJf(2))}F3j(ba,Aa){Aa=this.Rb.Lc(Aa);
for(var Pa=Aa.Cb(2);Pa;Pa=Aa.Gf(2))if((Pa=Object(xb.a)(117,Pa))&&bd.a.hba(Pa.Db,ba))return!0;return!1}$B(ba,Aa){Aa&&(ba=Object(xb.a)(482,Aa.node),Aa=Aa.yW,ba&&2===Aa&&((Aa=this.u5.Ef)&&Aa.slides&&0>=Aa.slides.length&&this.Mm.isVisible&&this.Hqc(!1,!1),this.mi&&(Aa=this.mi.O8,!Aa&&this.ta.Ba&&(Aa=this.ta.Ba.Db),this.F3j(Aa,ba)||this.SWf())))}Z7g(ba,Aa){if((ba=this.vl.Tta(Aa.node))&&Oc.XN(ba)&&(Aa=this.oo.T8(ba)))for(const Pa of Aa.nz())this.unh(Object(xb.a)(Hc.AParagraphNode,Pa),this.jOc(ba.commentId))}Yah(ba,
Aa){(ba=Object(xb.a)(4,Aa.node))&&0<ba.nz().length&&(Aa.hlg&192||Aa.hlg&4)&&this.X4b()}bnc(ba,Aa){ba=Aa.property;Aa=Aa.node;if(ba===Nd.a.Iy||ba===Nd.a.Jy)if(ba=this.vl.lz()){for(const Pa of ba)Pa.pos.Y=Aa.kC.y,Pa.pos.X=Aa.kC.x;this.opd()}}Mjd(){Jb.a.J(512496734,805,this.Xab?15:50,"SharedCommentFrame::OnSessionExpired - HasActiveDraft:{0}",this.Xab)}Qxa(ba,Aa){Jb.a.J(512496733,805,this.Xab?15:50,"SharedCommentFrame::OnSessionEnded - SessionEndedReason:{0};HasActiveDraft:{1}",Rf.a[Aa.GD],this.Xab)}dispose(){this.Cn&&
(this.Cn.dispose(),this.Cn=null);this.uFb&&(this.uFb.dispose(),this.uFb=null);this.Gy.zoh(Object(qa.a)(this,this.SJa,"onBeforeSlideSwitched"));this.Gy.Uoa(Object(qa.a)(this,this.S8e,"updateCommentsWhenNavigateSlide"));this.Gy.aMb(Object(qa.a)(this,this.Fwf,"activeSlideDOMDisplayed"));this.Vq.D8k(Object(qa.a)(this,this.V$g,"onPageViewZoomChanged"));this.Js.kph(Object(qa.a)(this,this.onShapeSelected,"onShapeSelected"));this.Js.Q8k(Object(qa.a)(this,this.Uah,"onShapeDeselected"));this.Gy.jpd(Object(qa.a)(this,
this.ebh,"onShapeTextSelected"));this.Gy.nph(Object(qa.a)(this,this.fnc,"onSlideBackgroundClicked"));this.Igb.Om(Object(qa.a)(this,this.bnc,"onShapePropertyChange"));this.Igb.A8k(Object(qa.a)(this,this.Yah,"onShapeInvalidation"));this.Ic.p7k(Object(qa.a)(this,this.h9g,"onF6FocusDocument"));this.Ic.BVe(Object(qa.a)(this,this.uib,"onSetFocus"));this.tac&&this.V0.execute(ba=>{ba.JVe(this.$Ja)});this.Hed.Om(Object(qa.a)(this,this.$bh,"onTextAnchorPropertyChanged"));this.XNg.oP(Object(qa.a)(this,this.$B,
"onChildTopologyChanged"));this.Hed.gLa(Object(qa.a)(this,this.Z7g,"onBeforeTextAnchorDisconnect"));this.Vb.IY(Object(qa.a)(this,this.G7g,"onAppModeSwitched"));this.L6c.hph(Object(qa.a)(this,this.Mjd,"onSessionExpired"));this.L6c.Laa(Object(qa.a)(this,this.Qxa,"onSessionEnded"));this.Vb.dMb(Object(qa.a)(this,this.tY,"onSetOffline"));this.GH||this.Rc.Bb(fb.a.click,this.SFb,Object(qa.a)(this,this.PIb,"onCommentPaneParentDivClick"));this.wMh();this.OO=this.SFb=null;this.Us.ipd(Object(qa.a)(this,this.Ojd,
"onShapeViewElementAddedOrRemoved"));this.Us.V8k(Object(qa.a)(this,this.Ojd,"onShapeViewElementAddedOrRemoved"));this.pa.Xoa(Object(qa.a)(this,this.QH,"onSelectionChanged"))}get isReadOnly(){return this.Sn}get HVa(){return!!this.mi}get hasFocus(){return this.dxe}mJi(){const ba=new sf.a;var Aa=new Kd(fe.a.nVa,Hh.a.application);Aa.preCallback=Object(qa.a)(this,this.sMc,"claimFocus");Aa.postCallback=Object(qa.a)(this,this.PTf,"disableOnEmptyDeckAndReadOnly");ba.$(0,Aa);Aa=new Kd(fe.a.deleteComment,Hh.a.application);
Aa.preCallback=Object(qa.a)(this,this.sMc,"claimFocus");Aa.postCallback=Object(qa.a)(this,this.PTf,"disableOnEmptyDeckAndReadOnly");ba.$(3,Aa);Aa=new Kd(fe.a.xQe,Hh.a.application);Aa.preCallback=Object(qa.a)(this,this.sMc,"claimFocus");Aa.postCallback=Object(qa.a)(this,this.ngh,"postCommentAction");ba.$(2,Aa);Aa=new Kd(fe.a.MJe,Hh.a.application);Aa.preCallback=Object(qa.a)(this,this.sMc,"claimFocus");Aa.postCallback=Object(qa.a)(this,this.ngh,"postCommentAction");ba.$(1,Aa);Aa=new Kd($b.a.eQb,Hh.a.application);
Aa.preCallback=Object(qa.a)(this,this.awl,"showHideActionPreCallback");Aa.postCallback=Object(qa.a)(this,this.$vl,"showHideActionPostCallback");Aa.delayActionsUntilRegistration=this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&zc.a("DelayCommentsShowHideAction");ba.$(6,Aa);return ba}awl(ba,Aa,Pa,ub,Lb){if(1===Pa)return!this.ta.Ba||this.isDisabled?8:2;Jb.a.J(36983504,805,50,"New Comment Pane opened.");this.Mm.Vhb(!!Lb&&Lb.AutoShowHide);return 2}$vl(ba,Aa,Pa,ub,
Lb,Mb){if(1===ub)return ba&&this.CE.JBk(this.ta.pk),ba?32:8;this.nAf(this.Mm.isVisible,!!Mb&&Mb.AutoShowHide);return ba?32:8}sMc(ba,Aa,Pa,ub,Lb){if(1===Pa&&this.pa.zVa())return 8;1!==Pa&&((this.Mfc=!!Lb&&Lb.ShouldCanvasTakeFocus)||this.lta(),this.pa.au(),this.wxe=!0);return 2}ngh(ba,Aa,Pa,ub){if(1===ub&&(this.eYa||!this.X$))return 8;this.Mfc=!1;return ba?32:8}PTf(ba,Aa,Pa,ub){return(1!==ub||!this.Sn&&this.X$)&&this.Kc.Jc?ba?32:8:8}nDa(ba,Aa){return new Qc.a(this.nbd.Ne(ba,0),this.nbd.Ne(Aa,1))}MNf(ba,
Aa){return new Qc.a(this.nbd.gf(ba,0),this.nbd.gf(Aa,1))}Txb(ba){ba=this.vl.Yta(ba);return this.vl.Tta(ba)}Fga(ba,Aa,Pa){!this.DZf()||ba!==this.mi.UC.draftId&&ba!==this.mi.commentId?this.Qwb()&&ba===this.mi.UC.draftId?(this.t0.selectComment(ba),this.Or&&this.Or.selectContainer(ba,!0),this.yZf&&!this.hasFocus&&1!==Aa&&this.lta()):this.selectComment(this.Txb(ba),null,!0,!0,0,Aa,Pa):(ba=this.ade(this.mi.O8),ba)?1!==Aa&&(this.mi.M2c=!0,this.Ea.Un?this.Gna.instance&&this.Gna.instance.$J(ba.ue):this.De.$J(ba.ue)):
(Jb.a.J(512496732,805,10,"SharedCommentFrame::SelectCommentId - InvalidCommentDataState - slide for extended draft not found"),this.endCommentSession(this.mi.UC.draftId,0))}selectComment(ba,Aa,Pa,ub,Lb,Mb,kd){this.pa.au();Aa=this.$Mb?this.$Mb.commentId:null;kd||this.qRc();0!==Mb?ba?this.t0.selectComment(ba.commentId):this.t0.selectComment(null):0===Mb&&(Mb=this.oo.T8(ba))&&Mb.hL&&this.oo.yrd(ki[Mb.hL]);this.Cn&&this.Cn.selectComment(ba,!0);!this.Mm.isVisible&&this.Or&&ba&&ba!==this.YWa&&(Mb=this.vl.vce(ba.commentId))&&
(Mb=this.vl.Tta(Mb),this.Or.selectContainer(Mb.commentId,!this.Mfc&&!kd&&!this.wxe),this.wxe=!1,this.Kc&&this.Kc.Jc&&this.Kc.Jc.ryd(5,!1,this.KCb));kd||this.Mfc||this.lta();!this.oo||!this.Mm.isVisible&&this.Mm.isVisible||(this.oo.GYe(ba,Aa,!0,!1,kd),Oc.XN(ba)&&!kd&&this.X4b());this.Vb.updateCommandUI()}get $Mb(){return this.Cn&&this.Cn.cNb?this.Cn.cNb.comment:null}wgl(){if(!this.eYa){const ba=Ze.a.kk("SelectNextCommentCrossSlide",1),Aa=!this.Mm.isVisible;this.eYa=!0;this.q8c.y7d((Pa,ub)=>{this.x9g(Pa,
ub,1,ba)},ba,Aa)}}zgl(){if(!this.eYa){const ba=Ze.a.kk("SelectPreviousCommentCrossSlide",1),Aa=!this.Mm.isVisible;this.eYa=!0;this.q8c.F7d((Pa,ub)=>{this.x9g(Pa,ub,0,ba)},ba,Aa)}}x9g(ba,Aa,Pa,ub){ub.vm("FindCommentEndTime",new Date);this.wb.Hb(new hd.a(2,1,100,()=>{this.eYa&&(this.eYa=!1,this.Osl(ba,Aa,Pa)?this.Fga(this.mi.commentId||this.mi.UC.draftId,0,!1):Aa&&ba&&this.Kc.Jc.gd?ba.Db.equals(this.Kc.Jc.gd.Db)?(this.selectComment(Aa,null,!0,!0,2,1,!1),ub.Wa("CircularSelectCommentInSingleSlide",Kc[Pa]),
ub.finish()):(this.eHa=Object.assign(new pc,{slide:ba,comment:Aa,direction:Pa,FYe:ub}),this.Ea.Un?this.Gna.instance&&this.Gna.instance.$J(ba.ue):this.De.$J(ba.ue)):(this.Vb.updateCommandUI(),ub.Wa("NoCommentFound",Kc[Pa]),ub.finish()))},90,"47"))}e8f(){let ba=-1;if(!this.mi)return ba;if(this.mi.O8){const Aa=this.ade(this.mi.O8);Aa&&(ba=Aa.ue)}else this.Kc.Jc&&this.Kc.Jc.gd&&(ba=this.Kc.Jc.gd.ue);return ba}Osl(ba,Aa,Pa){if(!this.mi||this.mi.UC.sessionType!==nc.create)return!1;const ub=this.e8f();if(0>
ub)return!1;if(!Aa||!ba)return!0;Aa=this.Kc.Jc.gd.ue;if(1===Pa)return Pa=ub<=Aa&&Aa<ba.ue,Aa=ba.ue<=Aa&&Aa<ub,ub<=ba.ue&&!Pa||Aa;Pa=ub>=Aa&&Aa>ba.ue;Aa=ba.ue>=Aa&&Aa>ub;return ub>ba.ue&&!Pa||Aa}bNa(ba){0!==ba&&this.t0.selectComment(null);this.Cn&&this.Cn.selectComment(null,!1);if(this.Or&&(this.Or.deselectContainer(),this.Kc&&this.Kc.Jc)){let Aa=5;const Pa=this.pa.fo();Pa&&Pa.Wf&&(Aa=2);this.Kc.Jc.ryd(Aa,!1,this.KCb)}this.oo&&0!==ba&&(this.oo.KPc(),this.oo.mPc());this.Vb.updateCommandUI()}vai(ba){this.tsb(this.Txb(ba),
0)}tsb(ba,Aa){this.YWa!==ba&&(this.oo&&(ba?this.oo.uai(ba):this.oo.mPc()),this.YWa=ba,0!==Aa&&(this.YWa?this.t0.highlightComment(this.YWa.commentId):this.t0.highlightComment(null)),this.Cn&&this.Cn.tsb(this.YWa,!0))}ugl(){if(this.a4b){var ba=this.Txb(this.a4b),Aa=this.Kc.Jc.gd.sid,Pa=Aa===parseInt(this.u2d);ba?(1!==ba.status&&2!==ba.status||this.Vtd(),this.selectComment(ba,null,!0,!0,0,1,!1),this.CE.gCk(this.ta.pk),Jb.a.J(512496730,804,15,"Deep link - Comment successfully found.  CommentId: {0}; DeepLinkedSlideId: {1};",
this.a4b,this.u2d)):(Pa&&this.Ud.Ds(Object.assign(new xi.a,{Code:389,Source:4}),this.Ya.podSessionId),Jb.a.J(512496731,804,15,"Deep link - Comment not found. CommentId: {0}; DeepLinkedSlideId: {1}; CurrentSlideId: {2}",this.a4b,this.u2d,parseInt(Aa)))}}get manager(){return this.vl}get mT(){return"per"}get a3g(){return this.OO}set a3g(ba){this.OO=ba;this.Cn&&(this.Cn.parentElement=ba)}get E5g(){return this.cic}set E5g(ba){this.cic=ba}uod(ba){this.KLb(ba,void 0,!0)}RU(ba,Aa){Aa=!zc.a("FixAltF12KeboardingInCommentPane")||
Aa;this.Amc(ba,Aa,!0)}qUe(){!this.GH&&this.Mm&&(this.SFb.style.display=this.Mm.isVisible?"flex":"none");this.Cn&&(this.Cn.setVisibility(this.reb),this.Cn.iCh(this.teb),this.oo.awb(this.YWa))}Hqc(ba,Aa){this.qLh(ba,Aa);this.qUe();this.nAf(ba,Aa)}V$g(){this.Cn&&!this.Jfc&&this.Cn.r9e();this.opd();this.Awb&&this.W8e()}shh(){this.eYa=!1;this.jXf();this.Cn&&this.Cn.RUe();this.EGb=!1;this.wMh()}jXf(){this.vl.GMh()}SJa(){this.YHa=this.y_()||this.Qwb();this.oo&&this.YHa&&(this.oo.KPc(),this.oo.mPc());this.J6d&&
(this.shh(),this.bEf())}ptl(){return this.mi&&this.mi.O8&&this.ta.Ba?this.mi.M2c&&bd.a.hba(this.mi.O8,this.ta.Ba.Db):!1}S8e(){this.J6d||this.shh();this.ta.Ba||this.SJa(this,null);this.jXf();this.Kc.Jc&&(this.a3g=this.Kc.Jc.RZd);const ba=this.Kc&&this.Kc.Jc?this.vl.O$a(this.Kc.Jc.gd):this.vl.lz(),Aa=this.Wij(ba),Pa=this.y_()||this.Qwb();this.fcd||Pa||(this.Hh.waa(this.Hh.bYd,this.Hh.UZd),this.fcd=!0);this.Mm.isVisible||(Pa?(this.k4b(),this.Eph()):this.y_()?(this.k4b(),this.cS(!0,!1,!0)):this.oEa&&
!this.YHa?this.cS(!1,!1,!1):this.cS(!1,!1,!0),this.Hmh());this.KLb(ba,e.AFrameworkApplication.isRtl,!1,Aa);this.ptl()?(this.Fga(this.mi.commentId||this.mi.UC.draftId,0,!1),this.mi.M2c=!1):-1<Aa&&this.Fga(ba[Aa].commentId,0,!1);this.eHa&&(this.eHa.FYe.finish(),this.eHa=null);this.U2a(!1);-1!==Aa&&this.Cn&&(this.Cn.tsb(null,!1),this.Cn.selectComment(ba[Aa],!1));this.J6d||this.bEf()}Fwf(){if(this.HFe){try{this.Qdb.bxl(this.uXg,this.ta,this.De)}catch(ba){Jb.a.J(512496729,805,10,"ActiveSlideDOMDisplayed - Exception while attempting to show resolved comment callout: {0}",
ba)}this.HFe=!1}}U2a(ba){const Aa=this.e8f();this.Que.U2a(ba,Aa)}WNl(ba){this.mi&&!this.mi.O8&&(this.mi.O8=ba)}onShapeSelected(ba,Aa){this.ZRc&&(ba=Aa.shapeNode,this.z0e(ba),ba&&0<ba.nz().length&&this.X4b())}ebh(ba,Aa){this.ZRc&&(this.z0e(Aa.$w.shapeNode),this.X4b())}QH(ba,Aa){if(Aa&&Aa.zl&&this.pa.S_()&&(ba=this.vl.lz())){Aa=!1;for(var Pa of ba)if(Oc.XN(Pa)){Aa=!0;break}Aa&&((Pa=this.pa.I_())?this.z0e(Pa):Jb.a.J(512496728,805,10,"SharedCommentFrame::OnSelectionChanged - Text selection exists but associated shape is null."))}}z0e(ba){ba.get_shapeId()&&
(this.oo&&ba!==this.oo.IW&&this.bNa(1),this.Muh(ba.get_shapeId(),!0))}Muh(ba,Aa){var Pa=this.vl.lz();if(Pa){var ub=null,Lb=null,Mb=0,kd=null;for(const Id of Pa)if((this.Mm.isVisible||0===Id.status)&&Id.anchorShape===ba)if(this.pa.S_()&&Oc.XN(Id)){Pa=this.pa.Pa.mb.Va;const ce=this.pa.Pa.mb.jf,Xe=Oc.M8b(Id,this.oo.T8(Id));Xe&&Xe.isValid?(this.$Mb&&this.$Mb.commentId===Id.commentId||Xe.fwd===Id.textAnchoringInfo.TextBodyLength)&&Xe.RUj(Pa,ce)&&(Lb?(Pa=Xe.elh,Pa<Mb&&(Lb=Id,Mb=Pa)):(Lb=Id,Mb=Xe.elh)):
(ub=Id,Jb.a.J(512496727,805,10,"SharedCommentFrame::SelectCommentWithShapeId - Comment anchor shape paragraph is null."))}else Lb||kd||Oc.XN(Id)||(kd=Id);Lb?this.Fga(Lb.commentId,1,Aa):kd?this.Fga(kd.commentId,1,Aa):this.pa.S_()&&!ub?this.oo&&this.bNa(1):ub&&this.Fga(ub.commentId,1,Aa)}}Uah(){if(this.ZRc){var ba=this.n$d();this.oo.yrd(String.format(ResourceStrings.L_CommentAnchoringSlideActiveCommentCount,ba.toString()));this.bNa(1)}}n$d(){const ba=this.vl.lz();let Aa=[];ba&&(Aa=eg.e(ba,Pa=>0===Pa.status));
return Aa.length}fnc(){this.ZRc&&this.bNa(1)}h9g(ba,Aa){Aa.Shb===Jd.a.vg&&this.oo.yrd(ResourceStrings.l_SlidePanel+", "+String.format(ResourceStrings.L_CommentAnchoringSlideActiveCommentCount,this.n$d().toString()));Aa.zKb===Jd.a.vg&&this.bNa(1)}uib(ba,Aa){this.yZf&&Aa.Shb!==Jd.a.BW&&(Aa.zKb===Jd.a.BW||Jd.a.Lz)&&this.Xab&&this.bNa(1)}Wij(ba){let Aa=-1;if(this.eHa&&this.Kc.Jc)if(this.eHa.slide!==this.Kc.Jc.gd)Jb.a.J(512496726,805,50,"GetIndexOfCommentToSelect() - Active slide doesn't match expected slide in select context");
else if(ba&&0<ba.length){if(this.Mm.isVisible)Aa=1===this.eHa.direction?0:ba.length-1;else if(1===this.eHa.direction)for(var Pa=0;Pa<ba.length;Pa++){if(0===ba[Pa].status){Aa=Pa;break}}else for(Pa=ba.length-1;0<=Pa;Pa--)if(0===ba[Pa].status){Aa=Pa;break}0<=Aa&&Aa<ba.length&&(ba=ba[Aa],Pa=this.eHa.comment,Pa.dt===ba.dt&&Pa.commentId===ba.commentId&&Pa.authorName===ba.authorName||Jb.a.J(512496725,805,15,"GetIndexOfCommentToSelect() - Expected comment doesn't exist in active slide"))}return Aa}uLe(){!this.vl.Uhj()||
this.vbd?(this.KLb(this.vl.lz(),e.AFrameworkApplication.isRtl,!0),this.vbd&&(this.vbd=!1)):this.mi&&(0===this.mi.ORa||1===this.mi.ORa?(this.IZf&&this.KLb(this.vl.lz(),e.AFrameworkApplication.isRtl,!0),0===this.mi.ORa&&(this.kdd=!0)):this.mi&&2===this.mi.ORa&&this.IZf&&this.KLb(this.vl.lz(),e.AFrameworkApplication.isRtl,!0))}NBk(){Ib(this.Jb)&&(this.vbd=!0,this.uLe())}get rrd(){const ba=this.pa.fo();if(ba){const Aa=ba.kC;this.tFe=new Qc.a(e.AFrameworkApplication.isRtl?Aa.x:Aa.x+ba.Ix,Aa.y)}else this.tFe=
null;return this.tFe}get Mgl(){if(!this.pa.S_())return null;var ba=Object(xb.a)(5,this.pa.Pa.mb.jf.node);if(!ba)return null;const Aa=Object(xb.a)(1066,ba.qc(this.Kc.Jc.Na));if(!Aa)return null;var Pa=null,ub=Aa.htmlElement.getElementsByClassName("Selected");if(0<ub.length)Pa=ub[ub.length-1];else if(this.pa.Pa.Sl){if(ub=this.acg())if(ub=Object(xb.a)(5,ub.jf.node))if(ub!==ba){if(ba=Object(xb.a)(1066,ub.qc(this.Kc.Jc.Na)))Pa=ba.htmlElement}else Pa=Aa.htmlElement}else return null;ba=this.pa.fo();if(!ba||
!Pa)return null;ba=Object(xb.a)(119,ba.qc(this.Kc.Jc.Na));if(!ba)return null;Pa=Qd.a.ki(Pa);ba=Qd.a.ki(ba.uq);if(0>=Pa.width+Pa.height&&0>=ba.width+ba.height)return null;ba=Qc.a.rV(new Qc.a(Pa.x,Pa.y),new Qc.a(ba.x,ba.y));return this.MNf(ba.x+Pa.width-5,ba.y+10)}get anchorNode(){const ba=this.pa.fo();return this.Uxg=ba?ba:this.Kc.Jc.gd}qLh(ba,Aa){this.Mm&&(Aa||this.mwh(),this.shb.Kyh(ba?3:1),!this.isDisabled&&ba&&zc.a("CommentShimmerBugFix")&&this.CX&&this.CX.isVisible&&(this.CX.Ihg(),this.Vb.Vhb(1)),
this.cS(!ba,!1,!0),this.Mm.Xp(!this.isDisabled&&ba,Aa),this.Mm.isVisible&&(this.reb=!0))}cS(ba,Aa,Pa){const ub=this.y_();Pa&&(!ub&&!this.YHa||ub&&this.YHa)&&Jb.a.J(512496724,805,50,"Slide Resize and render was called for Navigation between slides without comments or both slides with comments but it was unnecessary.");!this.y_()&&!this.HVa&&ba&&!Aa||this.Mm.isVisible&&ba&&!Aa||this.y_()&&this.CX&&this.CX.isVisible&&!ba&&!Aa||!this.Kc.Jc||!(Aa=this.Kc.Jc.fda)||(Aa.setVisibility(ba),ba=new Ue.a(ba),
this.Gy.Xjh(ba),Pa?this.Vb.Vhb(1):Jb.a.J(512496723,805,50,"Slide Resize and render was redundant. Navigation was between both slides without comments or both slides with comments"),this.Kc.Jc.ryd(5,!1,this.KCb))}RKl(ba){this.Mm&&(this.reb=!this.isDisabled&&ba,this.reb||(this.shb.Kyh(1),this.Mm.Xp(!1,!1),this.Fa.tj(Jd.a.Kp,!1)))}fnj(){const ba=new he;ba.focusCallback=Object(qa.a)(this,this.hTc,"focusFirstPaneElement");return Object.assign(new Gg.a,{title:ResourceStrings.L_Comments,hideHeader:!1,width:parseInt(this.aYl?
300:320),contentProps:ba,location:2,onOpen:Aa=>{ac.a.Aod(Aa,[fb.a.contextMenu]);const Pa=this.Fa.Fc(Jd.a.Kp);this.Rc.QLb(fb.a.click,Aa,Object(qa.a)(this,this.PIb,"onCommentPaneParentDivClick"),null,Pa.c3a)},onClose:Aa=>{this.Hqc(!1,!1);this.Rc.Bb(fb.a.click,Aa,Object(qa.a)(this,this.PIb,"onCommentPaneParentDivClick"))},isModernPane:!0})}bEf(){if(!this.vDg){var ba=this.vl.lz();ba=!!ba&&0<ba.length;Jb.a.J(512496722,805,50,"SharedCommentPane::AutoShowHideCommentsPane hasComments:{0}",ba);ba?this.y_()&&
this.cS(!0,!1,!0):(this.k4b(),this.oEa&&!this.YHa?this.cS(!1,!1,!1):this.cS(!1,!1,!0))}}Vtd(){this.Mm.isVisible||this.ia.processAction(fe.a.V1,2);this.qRc()}BIj(){this.Mm.isVisible&&this.ia.processAction(fe.a.V1,2)}qk(ba){return this.ke.qk(ba)}get isDisabled(){const ba=this.u5.Ef;return ba?ba.$ab:!0}byf(){this.scd||(this.scd=new hd.a(0,1,0,Object(qa.a)(this,this.V1k,"refreshCommentsTask"),90,"48"),this.wb.Hb(this.scd))}G7g(ba){this.e$g(1===ba.mode)}e$g(ba){this.Sn=ba;this.byf();zc.a("PreventCommentPaneCloseOnReadOnlyChanged")?
this.SWf():this.Mm.isVisible&&this.Sn&&this.BIj()}Dbe(){return this.X$?this.X$:[]}N9f(){return this.Mgb?this.Mgb:[]}get H6g(){return this.Ifb}get aPc(){return this.mi}a8f(ba){const Aa=this.Kc&&this.Kc.Jc?this.vl.O$a(this.Kc.Jc.gd):this.f3e(this.vl.lz());if(!Aa||!Aa.length)return 0;let Pa=null;this.rrd&&(Pa=this.nDa(this.rrd.x,this.rrd.y));let ub=-1,Lb=0;for(let ce=0;ce<Aa.length;ce++){var Mb=this.oo.T8(Aa[ce]);if(!Pa&&Mb)break;if(Mb&&Pa){var kd=Mb.kC.x,Id=Mb.kC.y;kd+=Aa[ce].pos.X;Id+=Aa[ce].pos.Y;
Mb.Ug&&(Mb=this.Ga.Cs(Mb),kd+=Mb&&Mb.kC?Mb.kC.x:0,Id+=Mb&&Mb.kC?Mb.kC.y:0);Id=this.nDa(kd,Id);kd=Id.y;Id=Id.x;if(Pa.y<kd)break;if(Pa.y>kd||Pa.y===kd&&Pa.x>=Id)ub=ce,Aa[ce].Children&&ba&&(Lb+=Aa[ce].Children.length)}else Mb||(ub=ce,Aa[ce].Children&&ba&&(Lb+=Aa[ce].Children.length))}return ub+Lb+1}mMj(ba){if(!this.Owe)throw Jb.a.J(512496721,805,10,"SharedCommentFrame::InitCommentSession - InvalidCommentDataState - floating container not loaded"),D.a.kt(-2130915320);if(this.mi)return Jb.a.J(512496720,
805,15,"SharedCommentFrame::InitCommentSession - CommentSessionAlreadyActive"),D.a.kt(-2130915319);if(null===ba)throw Error.argumentNull("session");if(!ba.commentId.length&&0!==ba.ORa)return D.a.kt(-2130915327);this.mi=ba;this.U2a(!0);0===ba.ORa&&(this.bNa(0),this.Mm.isVisible||this.Dph(ba));if(this.Mm.isVisible||!this.Mm.isVisible)this.lta(),this.zYi();let Aa="";ba.UC&&(Aa=ba.UC.draftId);Jb.a.J(512496719,805,50,"SharedCommentFrame::InitCommentSession - Success; DraftId:{0}",Aa);return null}endCommentSession(ba,
Aa){if(this.mi){if(this.mi.UC&&this.mi.UC.draftId!==ba)throw Jb.a.J(512496718,805,10,"SharedCommentFrame::EndCommentSession - InvalidArgument; EndingDraftId:{0}, ActiveDraftId:{1}",ba,this.mi.UC.draftId),D.a.kt(-2130915327);this.Qzg=Aa}9!==Aa||this.Mm.isVisible||this.Fa.fC(Jd.a.vg);this.mi=null;this.Vb.updateCommandUI();if(this.Or&&!this.Mm.isVisible){const Pa=[Object.assign(new Gh,{contentId:ba,containerContentType:0,anchorTop:0,anchorLeft:0})];this.Or.detachContainers(Pa);this.y_()||this.cS(!1,
!1,!0)}this.ddd.urg&&this.QTf();Jb.a.J(512496717,805,50,"SharedCommentFrame::EndCommentSession - Success; DraftId:{0}; EndReason:{1}",ba,Aa)}get EDi(){return this.Qzg}z6(){this.lta()}eTf(ba){if(this.Ea.ka("CommentCopyPasteEnabled")&&!this.Qdb.O3j)for(const Aa of ba)for(const Pa of this.vl.Uta(Aa.qE()))if(1===Pa.status){this.uXg=new Gd(ba,this.vl);this.HFe=!0;return}}vb(){1!==this.Rfc.Kja&&(this.ia.ya(fe.a.$tc,Hh.a.application,Object(qa.a)(this,this.V1,"showHideComments")),this.ia.ra(fe.a.uSe,Hh.a.application,
Object(qa.a)(this,this.SKa,"queryShowHideComments"),97));this.vWf&&(this.ia.ya(fe.a.sSa,Hh.a.application,Object(qa.a)(this,this.g4b,"deleteAllComments")),this.ia.ya(fe.a.Uvb,Hh.a.application,Object(qa.a)(this,this.g4b,"deleteAllComments")),this.ia.ya(fe.a.Vvb,Hh.a.application,Object(qa.a)(this,this.g4b,"deleteAllComments")));this.ia.ya(fe.a.IOb,Hh.a.application,Object(qa.a)(this,this.V1,"showHideComments"));this.ia.ra($b.a.aTe,ab.a.frame,Object(qa.a)(this,this.SKa,"queryShowHideComments"),97);this.ia.ra(fe.a.SKa,
Hh.a.application,Object(qa.a)(this,this.SKa,"queryShowHideComments"),97);this.ia.ra(fe.a.oLb,Hh.a.application,Object(qa.a)(this,this.SKa,"queryShowHideComments"),97);this.ia.ra(fe.a.wnd,Hh.a.application,Object(qa.a)(this,this.SKa,"queryShowHideComments"),97);this.ia.ya(fe.a.$Ie,Hh.a.application,Object(qa.a)(this,this.whd,"nudgeCommentMarker"));this.ia.ya(fe.a.aJe,Hh.a.application,Object(qa.a)(this,this.whd,"nudgeCommentMarker"));this.ia.ya(fe.a.bJe,Hh.a.application,Object(qa.a)(this,this.whd,"nudgeCommentMarker"));
this.ia.ya(fe.a.cJe,Hh.a.application,Object(qa.a)(this,this.whd,"nudgeCommentMarker"));this.ia.ya(fe.a.dQb,Hh.a.application,Object(qa.a)(this,this.dQb,"toggleCommentAnchoringFocus"));this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)&&(this.ia.ya($b.a.mwb,Hh.a.application,Object(qa.a)(this,this.mwb,"doesCommentExist")),this.ia.ya($b.a.o2b,Hh.a.application,Object(qa.a)(this,this.o2b,"commentActivitySelected")));this.pe()}pe(){var ba=this.Fa.Fc(Sg.AFrame.Xi),Aa=
this.Fa.Fc(Jd.a.Lz);const Pa=this.Fa.Fc(Jd.a.iS);ba.bindAction(Wh.KeyInputManager.Qa(De.a.uAa,1),fe.a.dQb);Aa.bindAction(Wh.KeyInputManager.Qa(De.a.uAa,1),fe.a.dQb);Pa.bindAction(Wh.KeyInputManager.Qa(De.a.uAa,1),fe.a.dQb);ba=this.Fa.Fc(Jd.a.Kp);Aa=[ba,this.Fa.Fc(Ie.a.iE),this.Fa.Fc(Ie.a.o3),this.Fa.Fc(Jd.a.vg),this.Fa.Fc(Jd.a.vQ)];for(const ub of Aa)ub.bindAction(Wh.KeyInputManager.Qa(De.a.xha,Wh.KeyInputManager.Re|(cc.a.Ik?4:1)),fe.a.nVa);ba.bindAction(Wh.KeyInputManager.Qa(De.a.vAa,1),fe.a.nVa)}KLb(ba,
Aa,Pa,ub=-1){this.kwa=Aa;!this.Cn&&this.OO&&(this.Cn=new Ob(this.OO,this,this.uFb,this.kwa,this.reb),this.oo.Pfd=this.Cn);if(ba){ag.Aak(ba);Aa=null;this.pa.S_()&&(Aa=this.pa.Pa);var Lb=0<ba.length?ba[ba.length-1]:null;if(this.Cn){var Mb=this.Cn.cNb?this.Cn.cNb.comment:null;const kd=Mb?Mb.commentId:null;this.Cn.isRightToLeft=this.kwa;this.Cn.uod(ba);this.oo&&(this.y_()||this.Qwb())&&(this.oo.KPc(),this.oo.mPc());this.Cn.selectComment(null,!1);if(this.mi)Mb=this.Txb(this.mi.commentId),this.oo&&this.oo.GYe(Mb,
kd,!1),this.Cn.selectComment(Mb,!0);else if(Pa&&Mb){const Id=this.Txb(Mb.commentId);this.oo&&(this.Mm.isVisible||!Id||1!==Id.status&&2!==Id.status)&&(this.Cn.selectComment(Mb,!1),this.oo.GYe(Mb,kd,!1,!0))}else this.kdd&&Lb&&(this.Fga(Lb.commentId,1,!1),this.Cn.selectComment(Lb,!1));this.Cn.iCh(this.teb);this.teb&&this.oo.awb(this.YWa)}this.Ifb=ba.length;ba=this.f3e(ba);this.X$=this.LMg.ZHl(ba,this.Sn);this.Mgb=this.LMg.YHl(ba);Pa?(this.U2a(!0),this.t0.kvh(Array.clone(this.X$),this.Ifb,Array.clone(this.Mgb)),
this.kdd&&Lb&&this.t0.selectComment(Lb.commentId)):(Pa=[],this.Qwb()&&(Pa=this.a8f(!1),Pa=[Object.assign(new Yj,{draftId:this.mi.UC.draftId,insertIndex:0>ub?0:Pa})]),0>ub?this.t0.WYe(this.X$.length,this.Ifb,this.Sn,this.Que.g4c,Pa):this.t0.hhl(this.X$.length,this.Ifb,ub,this.Sn,Pa),this.t0.$Ye(Array.clone(this.X$),Array.clone(this.Mgb)));if(this.cic){if(ub=this.Txb(this.cic))this.selectComment(ub,null,!0,!0,0,1,!1),this.cic=null}else Aa&&this.pa.gF(Aa);ba=this.XSf(ba);this.L4&&ba&&this.L4.count>ba.length&&
this.sTi(ba);this.Aph(ba);this.Pue&&this.fQl();this.kdd=!1}else this.t0.WYe(0,0,this.Sn,1),this.t0.$Ye([],[]),this.Ifb=0,this.Cn&&(this.Cn.isRightToLeft=this.kwa,this.Cn.uod(null)),this.Mgb=this.X$=null,this.qLh(!1,!1),this.k4b()}lta(){this.u2b&&this.qRc();this.hasFocus?this.mi&&this.ddd.urg&&!this.DZf()&&this.Fa.fC(Jd.a.Lz):this.Fa.fC(this.Mm.isVisible?Jd.a.Kp:Jd.a.BW)}V1k(){this.scd=null;this.uLe()}PIb(){this.lta();this.pa.au();return!1}rJf(ba){if(this.mi){if(!this.mi.UC)throw Jb.a.J(512496716,
805,10,"CheckDraftConfigurationAndEndCommentSession - InvalidCommentDataState DraftConfiguration is null. EndReason: {0}",ba),D.a.kt(-2130915320);this.endCommentSession(this.mi.UC.draftId,ba)}else Jb.a.J(512496715,805,50,"Calling EndCommentSession when there is no currentCommentSession. EndReason: {0}",ba),this.endCommentSession("",ba)}zYi(){this.EGb=this.Fa.Ee.name===(this.Mm.isVisible?Jd.a.Kp:Jd.a.BW);this.ddd.iAf(!0)}QTf(){this.ddd.iAf(!1);this.EGb&&(this.Fa.fC(this.Mm.isVisible?Jd.a.Kp:Jd.a.BW),
this.EGb=!1)}pGk(ba,Aa){if(ba&&ba.name!==Jd.a.Kp&&ba.name!==Jd.a.BW&&Aa.name===Jd.a.Lz)if(this.Mm.isVisible)this.hTc();else if(this.mi){ba="";switch(this.mi.ORa){case 0:ba=this.mi.UC?this.mi.UC.draftId:"";break;case 1:case 2:if(Aa=this.vl.vce(this.mi.commentId))ba=this.vl.Tta(Aa).commentId}this.Or.selectContainer(ba,!0)}this.EGb=!0}oGk(){this.EGb=!1}hTc(){this.Mm.isVisible&&this.shb.i7i()}Amc(ba,Aa,Pa){this.dxe=ba;this.Vb.updateCommandUI();(zc.a("FixAltF12KeboardingInCommentPane")||!this.GH)&&this.dxe&&
Aa&&this.hTc();ba||Pa||this.bNa(1)}E6d(ba){var Aa=this.ta.presentation;if(!Aa)return!1;Aa=Aa.slides;if(!Aa)return!1;for(const Pa of Aa)if(Aa=Object(xb.a)(Be.a,Pa))if(Aa=this.vl.Uta(Aa.qE()),ba)for(const ub of Aa){if(1===ub.status)return!0}else{if(Aa&&0<Aa.length)return!0}else Jb.a.J(512496714,805,10,"SharedCommentFrame::FPresentationHasComments - slideNode not found");return!1}rSi(){this.vl.sSa();const ba=this.vl.lz();ba&&ba.length?this.Qdb.UBh():this.Qdb.SBh(ResourceStrings.l_DeleteAllCommentsOnSlideCallout)}whd(ba,
Aa,Pa){if(1===Pa)return 32;if(null!==this.Xuh){Aa=this.Xuh;switch(ba){case fe.a.$Ie:Aa.pos.Y+=20;break;case fe.a.aJe:Aa.pos.X-=20;break;case fe.a.bJe:Aa.pos.X+=20;break;case fe.a.cJe:Aa.pos.Y-=20}this.Cn.dPl(Aa);this.zkk.qQk(Aa)}return 32}g4b(ba,Aa,Pa){return!this.vWf||this.Sn||this.mi&&this.mi.UC?8:1===Pa?this.ofj(ba):this.pSi(ba)}ofj(ba){switch(ba){case fe.a.sSa:return this.vl.lz()&&this.vl.lz().length?32:8;case fe.a.Uvb:return this.E6d(!1)?32:8;case fe.a.Vvb:return 1!==this.Rfc.Kja&&this.E6d(!0)?
32:8;default:return Jb.a.J(512496712,805,15,"SharedCommentFrame::GetDeleteAllCommentsState - Unexpected actionId: {0}",ba),2}}pSi(ba){switch(ba){case fe.a.sSa:this.rSi();break;case fe.a.Uvb:this.Qdb.TBh(this.vl,!1);break;case fe.a.Vvb:this.Qdb.TBh(this.vl,!0);break;default:return Jb.a.J(512496711,805,15,"SharedCommentFrame::DeleteAllCommentsExecute - Unexpected actionId, cannot execute: {0}",ba),2}return 32}V1(ba,Aa,Pa,ub,Lb){if(1===Pa)return!this.ta.Ba||this.isDisabled?8:32;Aa=!this.Mm.isVisible;
Pa=this.FR.Ii("UserAction",String.format("ShowHideComments: {0}",Aa?"ShowPane":"HidePane"));Jb.a.J(36983504,805,50,"New Comment Pane opened.");ba===fe.a.IOb?(this.RKl(!this.reb),this.qUe()):ba===fe.a.$tc?(this.teb=!this.teb,this.oo.Ctd=this.teb,this.qUe()):this.Hqc(Aa,!!Lb&&Lb.AutoShowHide);Pa&&Pa.stop();return 32}rZi(){this.Mm.isVisible&&this.Fga(this.mi.UC.draftId,1,!1)}dQb(){var ba=this.Fa.Ee.name;if(this.mi&&this.mi.UC)return ba===Jd.a.vg?(this.lta(),zc.a("FixAltF12KeboardingInCommentPane")||
zc.a("SelectCommentDuringAlt12ActiveDraftEnable")&&this.rZi()):this.Fa.vf(Jd.a.vg),32;if(this.oo.ADh||this.oo.IW){if(ba===Jd.a.vg||ba===Jd.a.iS){var Aa=this.oo.IW;this.Mm.isVisible||(ba=0,Aa&&(ba=Aa.get_shapeId()),this.Muh(ba,!1));this.lta();return 32}if(od.a.contains(this.wGf,ba)){if((Aa=this.$Mb)&&Oc.XN(Aa)){if(ba=Oc.M8b(Aa,this.oo.IW),ba.isValid){const Pa=[];for(let Lb=0;Lb<ba.paragraphs.length;Lb++){const Mb=ba.paragraphs[Lb];Mb&&Pa.push(Od.SelectionFactory.D3(Mb,ba.oV.equals(Mb)?ba.startPos:
0,ba.N3.equals(Mb)?ba.endPos:Pb.ParagraphReader.textLength(Mb)))}const ub=new dg.SelectionCollection(Pa,0);Aa.textAnchoringInfo.AnchoringShape&&Aa.textAnchoringInfo.AnchoringShape.SmartArtNodeId?(this.Fa.vf(Jd.a.iS),this.GGg.execute(Lb=>{(Lb=Object(xb.a)(415,Lb.Rd))&&this.GGg.instance.Jyh(Object(xb.a)(ij.a,Lb),ub)})):(this.Fa.vf(Jd.a.vg),this.pa.gF(ub))}}else this.Fa.vf(Jd.a.vg);return 32}}else{if(od.a.contains(this.wGf,ba))this.Fa.vf(Jd.a.vg);else{ba=null;ba=this.Kc&&this.Kc.Jc?this.vl.O$a(this.Kc.Jc.gd):
this.f3e(this.vl.lz());if(!od.a.Xa(ba))for(Aa of ba)if(this.Mm.isVisible||0===Aa.status){this.Fga(Aa.commentId,1,!1);break}this.lta()}return 32}return 8}nAf(ba,Aa){ba&&!Aa?this.GH?this.qRc():(this.Fa.tj(Jd.a.Kp,!0),this.lta(),this.hTc()):Aa?ba&&this.Fa.q4(Jd.a.Kp,Jd.a.Xi,this.Mm,!1):0<this.n$d()||this.mi&&this.mi.UC?this.Fa.tj(Jd.a.BW,!0):this.Fa.tj(Jd.a.Kp,!1);Aa||this.mwh()}FAk(){this.fcd||(this.Hh.dP(this.Hh.bYd,this.Hh.UZd),this.Hh.vaa(this.Hh.bYd,this.Hh.UZd),this.fcd=!0,this.CE.GAk(this.ta.pk));
this.CX&&this.CX.N2i()}mwh(){const ba=this.vl.lz();ba&&0<ba.length&&(this.vDg=!0)}y_(){var ba=this.vl.lz();if(!ba||!ba.length)return!1;ba=eg.e(ba,Aa=>0===Aa.status);return!!ba&&0<ba.length}SKa(ba,Aa,Pa,ub,Lb){ba===fe.a.SKa?Lb[Bg.a.On]=this.Mm.isVisible:ba===fe.a.oLb||ba===$b.a.aTe?Lb[oh.a.On]=this.Mm.isVisible:ba===fe.a.wnd?Lb[oh.a.On]=this.reb:ba===fe.a.uSe&&(Lb[oh.a.On]=this.teb);return!this.ta.Ba||this.isDisabled?16:32}mwb(ba,Aa,Pa,ub,Lb){return 2!==Pa?32:(ba=this.uZf(Lb))&&this.findComment(ba)?
32:8}o2b(ba,Aa,Pa,ub,Lb){return 2!==Pa?32:(ba=this.uZf(Lb))&&this.txk(ba)?32:8}uZf(ba){if(!ba)return null;ba=ba.NavigationId;if(!ba)return null;try{return JSON.parse(ba)}catch(Aa){return Jb.a.J(512496710,805,10,"ExtractNavParams - Exception while parsing navigation id",Aa),null}}txk(ba){if(this.cng(this.Kc.Jc.gd,ba))return this.Luh(ba);var Aa=bd.a.Uy(ba.sId,ba.cId);Aa=this.ade(Aa);if(!Aa)return!1;this.Ea.Un?this.Gna.instance&&this.Gna.instance.$J(Aa.ue):this.De.$J(Aa.ue);D.a.u7a(this.wb,()=>{this.Luh(ba)});
return!0}Luh(ba){const Aa=this.findComment(ba);if(!Aa)return!1;1!==Aa.status&&2!==Aa.status||this.Vtd();this.Fga(ba.commentId,1,!1);return!0}findComment(ba){var Aa=this.ta.presentation;if(!Aa)return null;Aa=Aa.slides;if(!Aa)return null;for(const Pa of Aa)if((Aa=Object(xb.a)(Be.a,Pa))&&this.cng(Aa,ba)){Aa=this.vl.Uta(Aa.qE());for(const ub of Aa){if(ub.commentId===ba.commentId)return ub;if(ub.Children&&ub.Children.length)for(const Lb of ub.Children)if(Lb.commentId===ba.commentId)return Lb}}return null}cng(ba,
Aa){return ba.cid&&Aa.cId?ba.cid===Aa.cId:ba.sid===Aa.sId}isCollapsed(){return!1}get Xuh(){return null}clearSelection(){}e2k(){this.Vb.updateCommandUI()}get Xab(){return!!this.mi}EAi(){this.mi&&this.rJf(8)}b6(ba){2===ba.behavior&&ba.actionId===fe.a.S_a&&(ba=this.Ts.UUc(!0),ba!==fe.a.bld&&ba!==fe.a.tQ&&ba!==fe.a.sSa&&ba!==fe.a.Uvb&&ba!==fe.a.Vvb||Wf.UISurfaces.FL().then(Aa=>{this.Qdb.D5k(Aa)}))}a6(){}static b3g(ba,Aa){return ba.contentId===Aa}static Aak(ba){let Aa="";if(ba){for(const Pa of ba)if(Aa+=
Pa.commentId+";",Pa.Children)for(const ub of Pa.Children)Aa+=ub.commentId+";";Jb.a.J(512496659,805,15,"LogCommentIds() - {0}",Aa)}}}Object(h.a)(ag,"SharedCommentFrame",null,[1067,107,1068,143]);class xg{constructor(ba,Aa,Pa,ub,Lb,Mb,kd=null){this.date=this.author=this.commentBody=this.parentId=this.commentId=null;this.commentFlags=0;this.usersByReactionType=null;this.commentId=ba;this.parentId=Aa;this.commentBody=Pa;this.author=ub;this.date=Lb;this.commentFlags=Mb;this.usersByReactionType=kd}}Object(h.a)(xg,
"OfficeSharedCommentModel",null,[]);class Tg{constructor(ba,Aa){this.CommentId=ba;this.ResolveState=Aa}}Object(h.a)(Tg,"CommentProperties",null,[]);class li{constructor(){this.email=this.fullName="";this.resolveState=0}}Object(h.a)(li,"AtMentionAttributes",null,[]);class Li{constructor(){this.contentId=""}}Object(h.a)(Li,"AtMentionOptionalAttributes",null,[]);class Le{constructor(){this.atmention=this.altText=this.lang=null;this.italic=!1;this.link=null;this.underline=this.strikethrough=!1;this.weight=
0;this.paragraph=this.color=this.highlight=null}}Object(h.a)(Le,"DeltaAttributes",null,[]);var Ih;(function(ba){ba[ba.Undo=-1]="Undo";ba[ba.Unknown=0]="Unknown";ba[ba.Create=1]="Create";ba[ba.Assign=2]="Assign";ba[ba.Unassign=3]="Unassign";ba[ba.UnassignAll=4]="UnassignAll";ba[ba.Schedule=5]="Schedule";ba[ba.Progress=6]="Progress";ba[ba.Delete=7]="Delete";ba[ba.Restore=8]="Restore";ba[ba.SetTitle=9]="SetTitle";ba[ba.Priority=10]="Priority"})(Ih||(Ih={}));Object(h.b)("HistoryRecordType",Ih);class bj{constructor(){this.Id=
this.FullName=this.Email=this.DispName=null}}Object(h.a)(bj,"CommentAtMention",null,[]);var zh=d(917);class jj{constructor(){this.UserId=this.ProviderId=this.FullName=this.Email=this.DisplayName=null}}Object(h.a)(jj,"UserInfo",null,[]);class Sh{constructor(ba,Aa){this.plainText=ba;this.z5g=Aa}}Object(h.a)(Sh,"TextTranslationResult",null,[]);var ya=d(72);class Ra{constructor(ba,Aa,Pa){this.Ubl="[";this.Lni=RegExp("\\<\\@(.*?)\\>|\\[\\@(.*?)\\]");this.$8j=RegExp("(?:https?:\\/\\/|www\\.)[^\\s]+","gi");
this.Mni=RegExp("(\\<\\@.*?\\>|\\[\\@.*?\\]|(?:https?:\\/\\/|www\\.)[^\\s]+)","gi");this.Twg=!1;this.EPi=ub=>{if(!ub)return null;let Lb={};for(const Mb of ub){a:{switch(Mb.Type){case "\ud83d\udc4d":ub=1;break a;default:Jb.a.J(509220245,805,50,"Unsupported reaction type")}ub=void 0}void 0!==ub&&(Lb[ub.toString()]=this.BUk(Mb.ReactionInstances))}return Lb};this.BUk=ub=>{let Lb=[];for(const Mb of ub)ub=Mb.User,Lb.push({DateUtc:Mb.Time,DisplayName:ub.DisplayName,Email:ub.Email,Provider:ub.ProviderId,
UserId:ub.UserId,IsCurrentUser:this.isCurrentUser(Mb.User.UserId,Mb.User.ProviderId)});return Lb};this.Jb=ba;this.CFe=Aa;this.NBe=Pa}get userId(){return this.Jb.appSettings["387"]}get providerId(){return this.Jb.appSettings["388"]}Xrj(ba,Aa){let Pa=0;if(1===ba.status||2===ba.status)Pa|=8;Aa&&(Pa|=1);this.jtl(ba)&&(Pa|=16);this.Jb.ka("PPTOBlueDotsForComments")&&ba.isUnread&&(Pa|=32);return Pa}isCurrentUser(ba,Aa){return ba?"Author"===ba||this.userId===ba&&Aa===Aa?!0:!1:!1}xUj(ba){return this.isCurrentUser(ba.userId,
ba.providerId)}jtl(ba){return""===ba.userId||"Author"===ba.userId||!this.jTl(ba.userId)||this.userId===ba.userId&&this.providerId===ba.providerId?!1:!0}jTl(ba){return 3===ba.split("::").length}AJh(ba,Aa,Pa){var ub;if(null===ba)throw Error.argumentNull("comment");const Lb=this.aIl(ba.text);var Mb=ba.authorName,kd=zc.a("PPTPlumbEmailThroughCG")?Da.a.a$a(ba.userId||""):"";const Id=ba.dt;Pa=this.Xrj(ba,Pa);Mb=new nb(ba.userId,ba.providerId,Mb,kd,this.xUj(ba));return Ib(this.Jb)&&(null===ba||void 0===
ba?0:ba.reactions)?(kd=this.EPi(null===(ub=ba.reactions)||void 0===ub?void 0:ub.ReactionList),new xg(ba.commentId,Aa,Lb,Mb,Id,Pa,kd)):new xg(ba.commentId,Aa,Lb,Mb,Id,Pa)}ZHl(ba,Aa){if(null===ba)throw Error.argumentNull("comments");const Pa=new m.a;for(const ub of ba)if(Pa.add(this.AJh(ub,"",Aa)),ub.Children&&0<ub.Children.length)for(const Lb of ub.Children)Pa.add(this.AJh(Lb,ub.commentId,Aa));return Pa.toArray()}eIl(ba,Aa,Pa,ub){const Lb=Object.assign(new zh.a,{Asignees:[]});ba=this.CFe.G9i(ba,Aa,
!Aa.taskId,Pa);for(const Mb of ba)2===Mb.type?Mb.assignee?(ba=Object.assign(new jj,{DisplayName:Mb.assignee.DisplayName,FullName:Mb.assignee.DisplayName,UserId:Mb.assignee.UserId,ProviderId:Mb.assignee.Provider,Email:Mb.assignee.Email}),Lb.Asignees.push(ba)):Jb.a.J(512496658,845,10,"TranslateSharedTaskMetadataToTaskInfo - History record type is assign, but Assignee is null."):9===Mb.type&&(Lb.Title=Mb.title);if(!Lb.Asignees)return Jb.a.J(512496657,845,10,"TranslateSharedTaskMetadataToTaskInfo - TaskInfo assignee is null and not set."),
null;Lb.Title||(Jb.a.J(512496656,845,15,"TranslateSharedTaskMetadataToTaskInfo - TaskInfo title is null and not set."),Lb.Title=ub);return Lb}cIl(ba,Aa){const Pa=new zh.a;if(ba.assignee){const ub=new jj,Lb=ba.assignee;ub.DisplayName=Lb.Name;ub.FullName=Lb.Name;ub.UserId=Lb.UserPrincipalName;ub.ProviderId="O365";ub.Email=Lb.UserPrincipalName;Pa.Asignees=[ub]}Pa.Title=ba.title?ba.title:Aa;return Pa}dIl(ba,Aa,Pa){if(!Aa)return null;try{const ub=this.axd(Pa,new Date).plainText,Lb=this.NBe?this.eIl(ba,
Aa,Pa,ub):this.cIl(Aa,ub);if(!Lb)return null;Lb.CompletionPercentage=Aa.completion?Aa.completion:0;return Lb}catch(ub){Jb.a.J(512496655,845,10,"TranslateSharedTaskMetadataToTaskInfo - Exception thrown: {0}",ub)}return null}YHl(ba){if(null===ba)throw Error.argumentNull("comments");const Aa=new m.a;for(const Pa of ba)Pa.taskInfo&&Pa.taskInfo.Asignees&&0<Pa.taskInfo.Asignees.length&&(ba=this.XHl(Pa))&&Aa.add(ba);return Aa.toArray()}XHl(ba){if(this.NBe&&this.CFe&&0<ba.taskInfo.TaskHistoryRecords.length)try{const Aa=
Ra.ZHi(ba.taskInfo.TaskHistoryRecords),Pa=new ya.a;Pa.add(ba.commentId,new Tg(ba.commentId,100===ba.taskInfo.CompletionPercentage));const ub=this.CFe.pPi(ba.commentId,ba.commentId,Aa,Pa);Ra.Gyi(ba,ub,this.NBe);return ub}catch(Aa){return Jb.a.J(512496654,845,10,"TranslateCommentTaskToSharedCommentTaskItem Failed due to [{0}]",Aa.message),this.zJh(ba)}else return this.zJh(ba)}zJh(ba){var Aa=new da;Aa.startDate=ba.taskInfo.StartDate;Aa.endDate=ba.taskInfo.DueDate;const Pa=new sa(ba.taskInfo.Asignees[0].UserId);
Pa.DisplayName=ba.taskInfo.Asignees[0].DisplayName;Pa.Provider=ba.taskInfo.Asignees[0].ProviderId;Pa.Email=ba.taskInfo.Asignees[0].Email;const ub=Array(1);ub[0]=Pa;Aa=new Z(!1,ba.taskInfo.Title,ub,Aa,ba.taskInfo.CompletionPercentage,0);return new I(ba.commentId,ba.commentId,Aa,[])}aIl(ba){if(null===ba)throw Error.argumentNull("nativeText");const Aa=new oa;ba=ba.split(this.Mni);for(const ub of ba){var Pa=this.Lni.exec(ub);Pa&&3===Pa.length?(ba=new li,Pa[0].substring(0,1)===this.Ubl?(ba.fullName=Pa[2],
ba.resolveState=1):(ba.fullName=Pa[1],ba.resolveState=0),ba.email="UnknownEmail",Pa=new Li,Pa.contentId="Pre-existing Mention",Aa.GPj("@"+ba.fullName,ba,Pa),this.Twg||(this.Twg=!0,Jb.a.J(512496653,845,15,"Rendering mention when AtMentions are disabled."))):(ba=this.$8j.exec(ub))&&1===ba.length?(ba=ba[0],Aa.insertHyperLink(ba,Object.assign(new Le,{link:ba}))):Aa.fQj(ub)}return Aa.sfj()}axd(ba,Aa){var Pa=Sys.Serialization.JavaScriptSerializer.deserialize(ba);ba=[];Aa||(Aa=new Date);const ub=new Sys.StringBuilder;
for(const Lb of Pa.ops)if(Lb.attributes){if(Lb.attributes.atmention){const Mb=1<Lb.insert.length?Lb.insert.substring(1,Lb.insert.length):"";if(Lb.optional&&Lb.optional.atmention&&Lb.optional.atmention.contentId)Pa=Ra.m8f(Mb,1===Lb.attributes.atmention.resolveState);else{Pa=Ra.m8f(Mb,1===Lb.attributes.atmention.resolveState);const kd=Ra.amj(Aa,1===Lb.attributes.atmention.resolveState);Array.add(ba,Object.assign(new bj,{FullName:Lb.attributes.atmention.fullName,DispName:Mb,Id:kd,Email:Lb.attributes.atmention.email}));
Aa=new Date(Aa.getTime()+1)}}else Lb.attributes.link||Jb.a.J(512496652,845,10,"Unsupported formatting discovered in Delta. Stripping out rich text."),Pa=Lb.insert;ub.append(Pa)}else ub.append(Lb.insert);return new Sh(ub.toString(),ba)}static vIi(ba){switch(ba){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6;case 7:return 10;case 8:return 9;case 9:return-1;default:return 0}}static sIi(ba){var Aa=null;ba.User&&(Aa=new sa(ba.User.UserId,
ba.User.ProviderId,ba.User.DisplayName));Aa=new ca(Ra.vIi(ba.HistoryRecordType),Aa,ba.DtTime,ba.RecordId);Aa.commentId=ba.CommentId;ba.Assignee&&(Aa.assignee=new sa(ba.Assignee.UserId,ba.Assignee.ProviderId,ba.Assignee.DisplayName));ba.StartDate&&ba.DueDate?(Aa.schedule=new da,Aa.schedule.startDate=ba.StartDate?ba.StartDate:null,Aa.schedule.endDate=ba.DueDate?ba.DueDate:null):ba.StartDate&&!ba.DueDate?Jb.a.J(512496651,845,10,"ConvertToOfficeSharedHistoryRecord schedule end date is null but start date is not"):
!ba.StartDate&&ba.DueDate&&Jb.a.J(512496650,845,10,"ConvertToOfficeSharedHistoryRecord schedule start date is null but end date is not");var Pa=ba.Priority;0<Pa?Aa.priority=Pa:Jb.a.J(512496649,845,10,"Priority is negative");Pa=ba.CompletionPercentage;0<=Pa?Aa.completion=Pa:Jb.a.J(512496648,845,10,"Percent complete is negative");Aa.title=ba.Title;Aa.undoId=ba.UndoId;return Aa}static ZHi(ba){const Aa=ba.length,Pa=Array(Aa);for(let ub=0;ub<Aa;++ub)Pa[ub]=Ra.sIi(ba[ub]);return Pa}static Gyi(ba,Aa,Pa){const ub=
Aa.currentState,Lb=ba.taskInfo;let Mb=!1;const kd=zc.a("SetTaskFromTaskStateInsteadOfHistory");Lb.StartDate.toString()!==ub.schedule.startDate.toString()&&(kd&&(ub.schedule.startDate=Lb.StartDate),Mb=!0,Jb.a.J(512496647,845,10,"Start Date does not match."));Lb.DueDate.toString()!==ub.schedule.endDate.toString()&&(kd&&(ub.schedule.endDate=Lb.DueDate),Mb=!0,Jb.a.J(512496646,845,10,"End Date does not match."));Lb.CompletionPercentage!==ub.completion&&(kd&&(ub.completion=Lb.CompletionPercentage),Mb=!0,
Jb.a.J(512496645,845,10,"Completion percentage does not match."));Lb.Title!==ub.title&&(kd&&(ub.title=Lb.Title),Mb=!0,Jb.a.J(512496644,845,10,"Title does not match."));Lb.Asignees[0].UserId!==ub.assignees[0].UserId&&(kd&&(ub.assignees[0].UserId=Lb.Asignees[0].UserId),Mb=!0,Jb.a.J(512496643,845,10,"Assigned to user id does not match."));Lb.Asignees[0].DisplayName!==ub.assignees[0].DisplayName&&(kd&&(ub.assignees[0].DisplayName=Lb.Asignees[0].DisplayName),Mb=!0,Jb.a.J(512496642,845,10,"Assigned to display name does not match."));
Lb.Asignees[0].ProviderId!==ub.assignees[0].Provider&&(kd&&(ub.assignees[0].Provider=Lb.Asignees[0].ProviderId),Mb=!0,Jb.a.J(512496641,845,10,"Assigned to provider id does not match."));Lb.Asignees[0].Email!==ub.assignees[0].Email&&(kd&&(ub.assignees[0].Email=Lb.Asignees[0].Email),Pa||(Mb=!0,Jb.a.J(512496640,845,10,"Assigned to email does not match.")));if(Mb&&Pa&&(Ra.adk(ba,Aa),zc.a("IsThrowForTaskStateMismatchEnabled")))throw Jb.a.J(0,845,10,"There was a mismatch between the state and state as determined by history"),
Error.create("TaskStateMismatch");}static adk(ba,Aa){const Pa=new m.a;for(const ub of Aa.history)for(const Lb of ub.records)Pa.add(Ih[Lb.type]);if(Pa.count!==ba.taskInfo.TaskHistoryRecords.length){Aa=new m.a;for(const ub of ba.taskInfo.TaskHistoryRecords)Aa.add(Ih[ub.HistoryRecordType]);Jb.a.J(512496611,845,10,"LogTaskHistoryDetailsForMismatch")}}static amj(ba,Aa){ba=ba._toFormattedString("yyyy-MM-ddThh:mm:ss:fff",Sys.CultureInfo.InvariantCulture);return Aa?ba+"_Z":ba}static m8f(ba,Aa){return Aa?
"[@"+ba+"]":"<@"+ba+">"}}Object(h.a)(Ra,"SharedCommentModelTranslator",null,[1064]);class hb{constructor(ba,Aa,Pa){this.bYa=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesM2IsEnabled")&&e.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesF6LoopFixesIsEnabled");this.Akf=!1;this.Fa=ba;this.Dg=Aa;this.pDb=Pa}iAf(ba){ba?(this.bYa&&this.pDb&&this.pDb.isVisible||this.Dg.DI(Jd.a.Lz),this.Dg.Eo(Jd.a.Kp),this.Fa.fC(Jd.a.Lz)):(this.Dg.Eo(Jd.a.Lz),this.pDb.isVisible&&!this.bYa&&
this.Dg.DI(Jd.a.Kp));this.Akf=ba}get urg(){return this.Akf}}Object(h.a)(hb,"SharedCommentsRTEFocusActionHelper",null,[1036]);class Eb{constructor(ba,Aa,Pa,ub){this.cancelButton=this.confirmButton=this.body=this.title=null;this.title=ba;this.body=Aa;this.confirmButton=Pa;this.cancelButton=ub}}Object(h.a)(Eb,"ViewContainerModalDialogStrings",null,[]);class Yb{constructor(ba,Aa,Pa){this.containerType="full-pane";this.identifier=null;this.jb=ba;this.Fa=Aa;this.identifier=Pa}closeView(){this.jb.Hqc(!1,
!1)}openView(){this.jb.Hqc(!0,!1)}invokeModalConfirmationDialog(ba,Aa,Pa){const ub=new Hi.StandardDialog;Pa&&Pa.title&&Pa.body&&Pa.confirmButton&&Pa.cancelButton||(Jb.a.J(35496838,805,10,"InvokeModalConfirmationDialog: No localized strings provided."),Pa=new Eb("","","",""));ub.Ad=1;ub.Oe(1,Pa.confirmButton);ub.Oe(0,Pa.cancelButton);ub.u9a=this.Fa.Ee.name;ub.bmc=!0;ub.Tx(Pa.title,Pa.body,1,Lb=>{1===Lb?(ba(),ub.u9a=null):Aa()})}}Object(h.a)(Yb,"ViewContainerAPI",null,[1062,1063]);class Nb extends Sys.EventArgs{constructor(){super()}}
Object(h.a)(Nb,"CommentsPackageLoadedEventArgs",Sys.EventArgs,[]);var ed=d(342);class zd{constructor(){this.fMg=this.Y_g=this.shb=this.I1g=this.Bwa=this.A6c=this.LIa=this.C6c=this.hR=this.K=null;this.peb=this.Vva=this.TDb=!1;this.FR=this.Xue=null;this.ZNg="6F1926CF-E872-4C4C-9393-3956FCFEB98A";this.zO=null;this.bYa=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesM2IsEnabled");this.GH=!1}Yb(ba){this.K=ba;this.GH=this.K.resolve("PowerPointWebEditor.IApplicationSettings").YZd;
this.FR=this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");this.shb=new J(e.AFrameworkApplication.Ae,"CommentPane");ba.register(Xa,"PowerPointWebEditor.CommentEditor").as("PowerPointWebEditor.ICommentEditor").ma().oa(()=>new Xa);const Aa=this.K.resolve("PowerPointWebEditor.IFileInfo").Kja,Pa=2===Aa||3===Aa;this.TDb=Pa;this.peb=1===Aa;ba.register(Ve,"PowerPointWebEditor.CommentTelemetryManager").as("PowerPointWeb.Comments.ICommentTelemetryManager").ma().oa(()=>new Ve(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.ICommentReader"),Aa));ba.register(Mf,"PowerPointWebEditor.CommentManager").as("PowerPointWeb.Comments.ICommentGraphManager").ma().oa(()=>new Mf(this.FR,Aa,this.K.resolve("PowerPointWebEditor.ICommentCloudPolicy"),this.K.resolve("PowerPointWebEditor.IClassFactory"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.Graph.ICommentReader"),this.K.resolve("PowerPointWebEditor.ICommentEditor"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWeb.Comments.ICommentTelemetryManager"),this.K.resolve("PowerPoint.IDateHelper"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.Ia("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager")));
const ub=this.TDb||!this.peb;this.zO=this.K.resolve("PowerPointWeb.Comments.ICommentGraphManager");ub&&ba.register(191,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeCommentsAnchoredSelectionView>").ma().oa(()=>new ed.a((ce,Xe)=>{let jd=null;const rd=Object(xb.a)(119,ce.qc(ba.resolve("Box4.IPageView").Na));rd&&!rd.Nl&&(ce=ba.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").s1d(ba.resolve("PowerPointWebEditor.IPptSelectionManager"),null,ce,
Xe,rd.hV),jd=new ah(ce),jd.xm(rd.hV),rd.Yra(jd,5),jd.visible=rd.OQ||rd.io);return jd}));this.K.register(1033,"PowerPointWeb.Comments.ICommentMarkerAnchorHelper").ma().oa(()=>new Rc(this.zO,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),ba.resolve("PowerPointWebEditor.Graph.ITableReader")));this.K.register(1034,"PowerPointWeb.Comments.ICommentMarkerPositionHelper").ma().oa(()=>new Oa(this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Md,
this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.zO));const Lb=this.TDb||!this.peb;this.K.register(1035,"PowerPointWeb.Comments.ICommentMarkerViewElementFactory").ma().oa(()=>new vc(this.K.resolve("PowerPointWeb.Comments.ICommentMarkerAnchorHelper"),this.K.resolve("PowerPointWeb.Comments.ICommentMarkerPositionHelper"),new kg(Lb),this.K.resolve("PowerPointWebEditor.ICommentCloudPolicy"),Lb,Lb));this.K.register(kf,"PowerPointWebEditor.CommentTextAnchorHighlightActor").ma().oa(()=>
new kf(!this.peb,this.K.resolve("Common.Utils.IHighContrastDetector")));const Mb=new sd(ub,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),ub?this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeCommentsAnchoredSelectionView>"):null,this.zO,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IAriaManager"),this.K.resolve("PowerPointWeb.Comments.ICommentMarkerAnchorHelper"),this.K.resolve("Box4.Highlight.IHighlightManager"),
this.K.resolve("PowerPointWebEditor.CommentTextAnchorHighlightActor"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"));ba.register(1036,"PowerPointWebEditor.IRTEFocusActionHelper").ma().oa(()=>new hb(ba.resolve("Common.IFocusManager"),ba.resolve("Common.IF6Manager"),ba.resolve("PowerPointWebEditor.ICommentsPane")));this.K.register(C,"Common.Comments.OfficeSharedCommentsEventHost").as("Common.Comments.IOfficeSharedCommentsEventHost").ma().oa(()=>new C(this.K.resolve("Common.ITaskManager")));
const kd=this.K.resolve("Common.IAppSettingsManager").ka("TasksHistoryEnabled");kd&&this.K.register(1037,"Common.Comments.ICommentTaskTranslator").ma().oa(()=>(new Ia(!0,kd,!0)).gKi());this.K.register(Ra,"PowerPointWebEditor.SharedCommentModelTranslator").as("PowerPointWeb.Comments.ISharedCommentModelTranslator").ma().oa(()=>new Ra(this.K.resolve("Common.IAppSettingsManager"),kd?this.K.resolve("Common.Comments.ICommentTaskTranslator"):null,kd));this.K.register(Qa,"Common.Comments.CommentActivationManager").as("Common.Comments.ICommentActivationManager").ma().oa(()=>
new Qa);this.Vva=this.K.resolve("Common.IAppSettingsManager").ka("896")&&(Pa||!this.peb);this.K.register(ag,"PowerPointWebEditor.SharedCommentFrame").as("PowerPointWeb.Comments.ICommentFrame").as("PowerPointWebEditor.ICommentSessionManager").ma().oa(()=>new ag(this.zO,this.K.resolve("PowerPointWeb.Comments.ICommentTelemetryManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.ICommentsPane"),this.K.resolve("Common.DragInputManager"),
this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.ICommentsPane").va,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Graph.IGraphInstance"),this.K.resolve("PowerPoint.IDateHelper"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWeb.Comments.ISharedCommentModelTranslator"),this.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.shb,this.K.resolve("PowerPointWebEditor.IRTEFocusActionHelper"),e.AFrameworkApplication.isRtl,this.K.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),
this.K.resolve("PowerPointWebEditor.IFindCommentLogic"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Md,this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("PowerPointWeb.Comments.ICommentMarkerViewElementFactory"),this.FR,Mb,this.K.resolve("Common.IAppSettingsManager"),this.K.Ia("Box4.IInteractiveViewManager"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),ub,ba.resolve("PowerPointWebEditor.IErrorHandler"),ba.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.Vva,ba.resolve("Box4.Graph.IGraphInstance").yd(10),ba.resolve("PowerPointWebEditor.View.IViewEventSource"),ba.resolve("PowerPointWebEditor.ICommentCloudPolicy"),Lb,ba.resolve("PowerPointWebEditor.IShapeReader"),ba.Ia("Common.App.SafeLinks.ISafeLinksManager"),ba.resolve("Box4.ICharacterPropertiesEditor"),ba.resolve("PowerPointWebEditor.IFileInfo"),
this.GH,ba.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPPTRumTracker"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").AJa?this.K.resolve("PowerPointWebEditor.ICommentShimmerView"):null,this.K.Ia("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),this.K.Ia("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Un?
this.K.Ia("PowerPointWebEditor.ISorterViewActorLazy"):null));this.K.register(jc,"Common.Comments.OfficeSharedCommentsActionHost").as("Common.Comments.IOfficeSharedCommentsActionHost").ma().oa(()=>new jc(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWeb.Comments.ICommentFrame").mek));this.K.register(Yb,"PowerPointWebEditor.ViewContainerAPI").as("PowerPointWeb.Comments.IPptViewContainerAPI").ma().oa(()=>new Yb(this.K.resolve("PowerPointWeb.Comments.ICommentFrame"),this.K.resolve("PowerPointWebEditor.IFocusManager"),
this.ZNg));const Id=new xf(this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),new Hf(this.K.resolve("PowerPointWebEditor.IPPTReplicationScheduler")),this.zO,this.K.resolve("Common.IAppSettingsManager").ka("459"),this.K.oe("PowerPointWeb.Comments.ICommentFrame"));this.K.register(1038,"PowerPointWebEditor.IFindCommentLogic").ma().oa(()=>new cd(Id,this.K.resolve("Common.ITaskManager")));this.K.register(Af,"PowerPointWebEditor.CommentsChangeListener").ma().oa(()=>
new Af(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Box4.Graph.IGraphInstance").yd(7),this.K.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),this.K.resolve("PowerPointWeb.Comments.ICommentFrame")));this.K.register(1039,"PowerPointWebEditor.ICommentContextDetailsUpdateHelper").ma().oa(()=>new Ke(this.K.resolve("PowerPointWebEditor.IPresentationReader"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IFindCommentLogic"),this.zO,this.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("Common.ITaskManager")));this.K.register(Ce,"PowerPointWebEditor.CommentPropertyTracker").ma().oa(()=>new Ce(Object(qa.a)(this.K.resolve("PowerPointWeb.Comments.ICommentFrame"),this.K.resolve("PowerPointWeb.Comments.ICommentFrame").uLe,
"onCommentPropertiesUpdated"),ib.App.yP.uV,ob.GraphTransactionManager.instance));this.K.register(1040,"PowerPointWebEditor.ICommentsPane").ma().oa(()=>new Og(this.K.resolve("PowerPointWebEditor.IFrameContext"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").fva,this.K.resolve("PowerPointWebEditor.ITaskPaneManager"),this.GH));this.K.register(dd,"PowerPointWebEditor.CommentSmartReplyProvider").ma().oa(()=>new dd(this.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),
this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")))}init(){gc.a.instance.lc(ic.a.XZd,(new Date).getTime());const ba=this.FR.Ii("UserAction","InitCommentsPackage"),Aa={};this.GH||(this.LIa=this.K.resolve("PowerPointWebEditor.ICommentsPane").va);this.hR=this.K.resolve("PowerPointWeb.Comments.ICommentFrame");this.hR.initialize();var Pa=ba.dr;Aa.CommentFrameInitMS=Pa;this.K.resolve("PowerPointWebEditor.ICommentSessionManager");this.C6c=this.K.resolve("PowerPointWebEditor.CommentPropertyTracker");
this.C6c.ZIj();const ub=ba.dr;Aa.CommentPropertyTrackerInitMS=ub-Pa;this.Xue=this.K.resolve("PowerPointWebEditor.CommentsChangeListener");this.I1g=this.K.resolve("PowerPointWeb.Comments.IPptViewContainerAPI");var Lb=Ta.b(e.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());Pa=Lb.Ring||"Unknown";Lb=Lb.WACDatacenter||"Unknown";const Mb=this.K.resolve("PowerPointWebEditor.IApplicationSettings").PSj;var kd=e.AFrameworkApplication.fa.Ha("LokiComplianceEnvironment");kd=kd&&""!==kd?kd:
e.AFrameworkApplication.fa.Ha("SovereignEnvironmentName");this.Y_g=new Ab("PowerPoint",e.AFrameworkApplication.buildVersion,null,null,e.AFrameworkApplication.userSessionId,Pa,Lb,!Mb,this.K.resolve("Common.IActionManagerExtended"),null,kd);Pa=rc.a.He(e.AFrameworkApplication.lcid);this.fMg=new tb(e.AFrameworkApplication.isRtl,Pa?Pa.name:Sys.CultureInfo.CurrentCulture.name,e.AFrameworkApplication.uiCulture,e.AFrameworkApplication.dataCulture);this.GH||(this.LIa.id=this.ZNg);this.F$b();e.AFrameworkApplication.fa.ff(Object(qa.a)(this,
this.en,"onFullAppSettingsReady"));(Pa=this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"))&&Pa.BXk(new Nb);Pa=ba.dr;Aa.CommentReactPaneInitMS=Pa-ub;this.nMj();Aa.CommentPaneInitMS=ba.dr-Pa;e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1)&&this.K.resolve("PowerPointWebEditor.CommentSmartReplyProvider").initialize();ba.stop();Jb.a.J(512262878,805,15,"CommentsPackage::Init telemetry InitTimeMS:{0}; ModernCommentsReloadEnabledWithoutRoundtrip:{1}",
Aa,this.K.resolve("Common.IAppSettingsManager").ka("896"))}nMj(){const ba=this.K.resolve("PowerPointWebEditor.ICommentsPane"),Aa=this.K.resolve("PowerPointWebEditor.IPaneManager");this.GH||(!this.bYa||this.bYa&&!document.getElementsByClassName("CommentPanel").length)&&Aa.YZ(ba);Aa.tCb(2);this.K.resolve("PowerPointWebEditor.IFocusManager").q4(Jd.a.Kp,Jd.a.Xi,ba,!ba.isVisible)}F$b(){gc.a.instance.lc(ic.a.F$b,(new Date).getTime());const ba=this;this.K.resolve("PowerPointWebEditor.ICommentCloudPolicy").zvb().then(Aa=>
{gc.a.instance.lc(ic.a.Rhe,(new Date).getTime());Za.a.Lt(ba.K.Ia("Common.App.People.IExternalPeopleAPI")).continueWith(Pa=>{ba.Bwa=Pa.result;ba.Bwa||Jb.a.J(512262877,805,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");ba.K.resolve("PowerPointWebEditor.IApplicationSettings").yg&&(Pa=ba.K.resolve("Common.IAppSettingsManager").Ha("368"),ba.Bwa.qdh(Pa+"p"));Pa=[fb.a.contextMenu];ba.GH||ac.a.Aod(ba.LIa,Pa);const ub=Aa&&(ba.TDb||!ba.peb),Lb=ba.K.resolve("Common.IAppSettingsManager").ka("PositionDraftCommentCardOnCommentsPaneBasedOnAnchorPositionEnabled");
ba.K.register(Qi,"PowerPointWebEditor.PPTSharedCommentAppCapabilities").as("Common.Comments.IOfficeSharedCommentsAppCapabilities").ma().oa(()=>new Qi(ba.K.resolve("Common.IAppSettingsManager"),ba.K.resolve("PowerPointWebEditor.IApplicationSettings"),ba.Bwa,ba.peb,ub,ba.Vva));ba.K.register(ud,"PowerPointWebEditor.CommentAPI").as("PowerPointWebEditor.IPptOfficeSharedCommentAPI").ma().oa(()=>new ud(ba.K.resolve("PowerPointWeb.Comments.ICommentFrame"),ba.zO,ba.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),
ba.K.resolve("Common.Comments.IOfficeSharedCommentsActionHost"),ba.K.resolve("Common.ITaskManager"),ba.K.resolve("Common.IAppSettingsManager"),ba.K.resolve("PowerPointWeb.Comments.ISharedCommentModelTranslator"),ba.K.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),ba.Bwa,ba.K.resolve("PowerPointWebEditor.ICommentCloudPolicy"),ba.K.resolve("PowerPointWebEditor.CommentSmartReplyProvider"),ub,ba.Vva,Lb,ba.K.resolve("Common.Comments.IOfficeSharedCommentsAppCapabilities"),ba.K.resolve("Common.IActionManagerExtended"),
ba.K.resolve("PowerPointWebEditor.IApplicationSettings")));ba.A6c=ba.K.resolve("PowerPointWebEditor.IPptOfficeSharedCommentAPI")},11).continueWith(()=>{ba.A6c&&ba.A6c.checkAtMentionCapability().then(Pa=>{Pa&&((Pa=ba.K.Ia("Common.ISystemInitiatedFeedback"))?Pa.execute(ub=>{ub.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}):Jb.a.J(512262876,805,10,"InitOfficeSharedComments:InitOfficeSharedComments sifFuture should not be null."))});ba.lMj()})})}lMj(){gc.a.instance.lc(ic.a.F0e,
(new Date).getTime());const ba=this.K.resolve("Common.IDynamicScriptLoaderProvider").rI,Aa=this.K.resolve("Common.Comments.IOfficeSharedCommentsAppCapabilities"),Pa=this.K.resolve("Common.Comments.ICommentActivationManager");gc.a.instance.lc("CommentActivationManagerInitStart",(new Date).getTime());Pa.initialize(ba,this.A6c,this.Y_g,this.Bwa,new Dc(this.I1g,this.shb),this.fMg,null,Aa.Yrj());gc.a.instance.lc(ic.a.X$b,(new Date).getTime());Pa.X$b().then(()=>{gc.a.instance.lc(ic.a.She,(new Date).getTime());
this.hR.POj();gc.a.instance.lc(ic.a.Vre,(new Date).getTime());xc.a(this.K)("floatingContainerManager").then(()=>{gc.a.instance.lc(ic.a.U7d,(new Date).getTime());this.hR.xMj();gc.a.instance.lc(ic.a.V7d,(new Date).getTime());if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").Rmi){const ub=this.zO.lz();ub&&0<ub.length?(this.hR.ugl(),gc.a.instance.lc(ic.a.utd,(new Date).getTime()),fc.App.iNb(null,ic.a.utd)):Jb.a.J(512262875,805,50,"InitCommentActivationManager: Deep link to a slide without comments")}}).catch(ub=>
{Jb.a.J(512262874,801,10,"Failed to load the resources for the floating container UI + "+ub.toString())})})}en(){this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame").updateCommandUI()}dispose(){this.C6c&&this.C6c.uLl();this.hR&&this.hR.dispose();this.Xue&&this.Xue.dispose();this.Bwa=null}get name(){return"PowerPointWebEditor.CommentsPackage"}static main(){gc.a.instance.lc(ic.a.SZd,(new Date).getTime());e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.CommentTTVRImprovementIsEnabled",
!1)?Sc.a.instance.Ac(new zd,0,!0):Sc.a.instance.Ac(new zd)}}Object(h.a)(zd,"CommentsPackage",null,[2,3]);var Hd=d(13);Type.registerNamespace("Common.App.SharedComments");Type.registerNamespace("FloatingContainer");Type.registerNamespace("FloatingContainerManager");Type.registerNamespace("PowerPointWeb.Comments");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("RichContentEditAPI");Type.registerNamespace("Common.Comments");Object(Hd.c)("Comment");zd.main();Object(Hd.b)("Comment")},
699:function(K,U,d){d.d(U,"a",function(){return n});K=d(0);var h=d(18),e=d(99),r=d(29),m=d(50);d(98);class n{constructor(){this.N_=null}get Hzb(){return!1}NJh(z,v){let x=new h.a;const B=new m.GraphTransaction(3);try{B.ld(r.App.Lb.Kd.Mn.Ag),this.Icc(v)&&(x=this.bac(v,x)),v!==z&&this.Icc(z)&&(x=this.bac(z,x))}finally{B&&B.dispose()}return x.toArray()}Icc(z){return!!z}Lod(z){let v=!1;for(const x of this.Ege)v||!Sys.UI.DomElement.containsCssClass(z,x.className)&&!Sys.UI.DomElement.containsCssClass(z,
x.k9b)||(v=!0),e.a.eLa(z,x.className),e.a.eLa(z,x.k9b)}}Object(K.a)(n,"AHighlightActor",null,[989])},700:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(e,r){this.className=e;this.k9b=r}}Object(K.a)(h,"HighlightCssClassPair",null,[])},701:function(K,U,d){d.d(U,"b",function(){return m});d.d(U,"a",function(){return n});var h=d(99);d(29);var e=d(50);d(34);d(94);var r=d(98);const m=z=>{const v=new e.GraphTransaction(3);try{v.ld(z),z.Kv(32,!0)}finally{v&&v.dispose()}},n=z=>{if(z){z=
h.a.Hka(z);if(-1===z.indexOf(r.a.B8)&&-1!==z.indexOf(r.a.FN)&&-1===z.indexOf(r.a.J3b))return 2;if(-1===z.indexOf(r.a.B8)&&(-1!==z.indexOf(r.a.I3b)||-1!==z.indexOf(r.a.VN)||-1!==z.indexOf(r.a.J3b)||-1!==z.indexOf(r.a.jNc)||-1!==z.indexOf(r.a.ZOc)||-1!==z.indexOf(r.a.XOc)||-1!==z.indexOf(r.a.WOc)||-1!==z.indexOf(r.a.T1d)||-1!==z.indexOf(r.a.O1d)||-1!==z.indexOf(r.a.Q1d)||-1!==z.indexOf(r.a.YOc)||-1!==z.indexOf(r.a.N1d)))return 1;if(-1!==z.indexOf("WACImageContainer"))return 3}return 0}},702:function(K,
U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.type=this.action=0;this.mjb=this.gea=null}}Object(K.a)(h,"HighlightOperation",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19809348/wdjs/ppteditDS.comment.js.map