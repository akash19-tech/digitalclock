'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[14],{1295:function(K,U,d){d.r(U);K=d(0);var h=d(71),e=d(28),r=d(197),m=d(52),n=d(30);class z{constructor(va,Ca){this.ia=va;this.ia.ra(n.a.oKj,m.a.application,r.ActionManager.Bv,4);this.ia.ra(n.a.pKj,m.a.application,r.ActionManager.Bv,4);this.ia.ra(n.a.qKj,m.a.application,r.ActionManager.Bv,4);this.ia.ra(n.a.rKj,m.a.application,r.ActionManager.Bv,4);this.ia.ra(n.a.sKj,m.a.application,r.ActionManager.Bv,4);this.ia.ra(n.a.tKj,
m.a.application,r.ActionManager.Bv,4);this.ia.ra(n.a.uKj,m.a.application,r.ActionManager.Bv,4);this.ia.ra(n.a.$Jj,m.a.application,r.ActionManager.Bv,4);this.ia.ra(n.a.aKj,m.a.application,r.ActionManager.Bv,4);this.ia.ra(n.a.bKj,m.a.application,r.ActionManager.Bv,4);this.ia.ra(n.a.cKj,m.a.application,r.ActionManager.Bv,4);this.ia.ra(n.a.dKj,m.a.application,r.ActionManager.Bv,4);this.ia.ra(n.a.eKj,m.a.application,r.ActionManager.Bv,4);this.ia.ra(n.a.fKj,m.a.application,r.ActionManager.Bv,4);this.ia.ra(n.a.ZJj,
m.a.application,r.ActionManager.Bv,4);this.ia.ra(n.a.gKj,m.a.application,r.ActionManager.Bv,4);this.ia.ra(n.a.hKj,m.a.application,r.ActionManager.Bv,4);this.ia.ra(n.a.jKj,m.a.application,r.ActionManager.Bv,4);this.ia.ra(n.a.kKj,m.a.application,r.ActionManager.Bv,4);this.ia.ra(n.a.lKj,m.a.application,r.ActionManager.Bv,4);this.ia.ra(n.a.mKj,m.a.application,r.ActionManager.Bv,4);this.ia.ra(n.a.nKj,m.a.application,r.ActionManager.Bv,4);this.sAg=JSON.parse(Ca.Ha("674"));for(const oa of this.sAg)oa.regex=
new RegExp(oa.pattern)}trackAction(va){for(const Ca of this.sAg)Ca.regex.test(va)&&this.ia.processAction(Ca.actionId,2)}}Object(K.a)(z,"IdeasActionTracker",null,[978]);class v{constructor(){this.Leb=this.TGe=this.$Fe=null;this.cYj=this.OYl}addSlideSuggestionsListener(va){this.$Fe=va}addTextToSmartArtSuggestionListener(va){this.TGe=va}oSd(va){this.Leb=va}notifySlideSuggestion(va,Ca){this.$Fe&&(this.$Fe(va,Ca),e.a.J(512496328,829,50,"data: count: {0}, correlation: {1}",Ca?Ca.suggestions.length:0,Ca?
Ca.correlationId:"0"))}notifyTextToSmartArtSuggestion(va,Ca){this.TGe&&(this.TGe(va,Ca),e.a.J(512496327,829,50,"data: count: {0}, correlation: {1}",Ca?Ca.suggestions.length:0,Ca?Ca.correlationId:"0"))}uhd(va){this.Leb&&this.Leb(va)}}Object(K.a)(v,"InfraredDesignerServiceProvider",null,[976]);class x{constructor(){this.Leb=null}oSd(va){this.Leb=va}uhd(va){this.Leb&&this.Leb(va)}}Object(K.a)(x,"InfraredTelemetryListener",null,[977]);var B=d(205),D=d(1050),w=d(47),J=d(7),G=d(36);class M{}Object(K.a)(M,
"EntityGroup",null,[]);class N extends M{}Object(K.a)(N,"Idea",M,[]);var R=d(551);class C{}Object(K.a)(C,"ProviderResult",null,[]);var O=d(345),S=d(444),T=d(443),ca=d(344),L=d(550),da=d(27),Z=d(269);class fa{}fa.zQk="PowerPoint";fa.eUl="WAC";Object(K.a)(fa,"ApplicationPropertiesConstants",null,[]);class aa{}Object(K.a)(aa,"EnterpriseUserInfo",null,[]);class ja{}Object(K.a)(ja,"Message",null,[]);class I extends ja{}I.PowerPointTextTileChangedMessageType="PowerPoint.TextTileChanged";Object(K.a)(I,"PowerPointTextTileChangedMessage",
ja,[]);class sa{}Object(K.a)(sa,"RankerConfiguration",null,[]);class ka{constructor(va){this.e2g=va}v$i(va,Ca){return new Promise((oa,Da)=>{this.e2g&&va&&Ca||Da("wopiIdentityManager or tokenParameter or clientWoipId is null");this.e2g.getAccessToken(va,Ca).then(ta=>{ta?oa(ta.accessToken):Da("auth token is null")},ta=>{Da(ta)})})}}Object(K.a)(ka,"AuthenticationProvider",null,[987]);class Ma{constructor(va,Ca,oa,Da,ta=""){this.resource=va;this.scope=Ca;this.silentLogin=oa;this.options=Da;this.correlationId=
ta}}Object(K.a)(Ma,"InfraredTokenParameters",null,[307]);class Ea{constructor(va,Ca,oa,Da,ta,ha,Ha,bb,Na){this.lGg=this.Qte=this.tif=null;this.WFg=!1;this.jCe=null;this.FFe=!1;e.a.J(512262852,809,50,"PPTWebEditorInfraredRuntimeManager - Initialize");this.TGb=va;this.yik=Ha;this.Oze=Na;this.hlk=va.ka("659");this.aHb=va.Ha("750");Ha=window.location.hostname;Na=va.Ha("816");Ha&&0<Ha.length&&Na&&0<Na.length&&0<=Na.toLowerCase().indexOf(Ha.toLowerCase())&&(this.aHb="");this.QXa=Ca;this.tfc=ha;if(this.ctk=
va.ka("688"))this.lGg=va.Ha("689"),this.Qte=new ka(bb);this.QXa.addSlideSuggestionsListener(Object(J.a)(this,this.YHk,"onSlideSuggestion"));this.QXa.addTextToSmartArtSuggestionListener(Object(J.a)(this,this.xIk,"onTextToSmartArtSuggestion"));this.QXa.oSd(Object(J.a)(this,this.S9g,"onIdeasSessionTelemetry"));oa.oSd(Object(J.a)(this,this.S9g,"onIdeasSessionTelemetry"));this.tfc&&this.tfc.execute(Ia=>{Ia.izf(Object(J.a)(this,this.KLe,"onEditorCritiques"))});this.ia=Da;(this.mU=ta)&&this.mU.execute(Ia=>
{Ia.registerSimpleLocalWorkflow("InfraredSlideTextTileWorkflow",Object.assign(new T.a,{name:"InfraredSlideTextTileLambda",inputSchema:S.a.ruc,outputSchema:S.a.ruc,func:(Qa,qa,Wa)=>{this.ZHk(Qa);Wa(null)}}))});this.qql()}get Nzb(){return this.tif}qql(){var va=JSON.parse(this.TGb.Ha("612"));va=Object.assign(new sa,{rankingOrder:va});var Ca=IdeasInfraredConnector,oa=Ca.setup,Da=e.a.J,ta=Object(J.a)(this,this.vKj,"ideasPaneVisibilityStatusCallback"),ha=this.TGb;const Ha={};Ha.appName=2===da.AFrameworkApplication.Aa.ob.zk?
fa.zQk:"unknown";Ha.appVersion=da.AFrameworkApplication.buildVersion;Ha.appPlatform=fa.eUl;Ha.lcid=da.AFrameworkApplication.lcid;var bb=Z.a.He(da.AFrameworkApplication.lcid);bb=bb?bb.name:null;const Na=bb.split("-");Ha.market=Na[Na.length-1];Ha.uiLanguage=bb;Ha.sessionId=da.AFrameworkApplication.userSessionId;Ha.tenantRoot=ha.Ha("748");Ha.shredderServiceEndpoint=ha.Ha("749");this.tif=oa.call(Ca,va,Da,ta,Ha,this.yik,Object(J.a)(this,this.$ag,"getShredderServiceAuthTokenPromise"))}vKj(va){this.WFg=
va;(this.QXa.cYj=va)?(this.ia.processAction(n.a.cxb,2),this.gih()):this.ia.Ka(n.a.$oa,2,new L.a(!0,ca.a.Yge))}YHk(va,Ca){const oa=[];oa.push(Object.assign(new N,{providerId:R.a.GDh,groupTypeId:R.a.FDh,notificationConfidence:0,shouldRaiseNotification:!1,confidence:1,data:Ca}));try{this.Nzb.pushProviderResult(Object.assign(new C,{providerId:R.a.GDh,resultStatus:va,entityGroups:oa}))}catch(Da){e.a.J(512262851,811,10,"OnTextToSmartArtSuggestion: Exception occured while posting message to IR, Exception is: {0} ",
Da)}"Success"===va&&(B.a.Xa(Ca.suggestions)||this.Oze.Qwd(0))}xIk(va,Ca){const oa=[];oa.push(Object.assign(new N,{providerId:R.a.QDh,groupTypeId:R.a.PDh,notificationConfidence:0,shouldRaiseNotification:!1,confidence:1,data:Ca}));try{this.Nzb.pushProviderResult(Object.assign(new C,{providerId:R.a.QDh,resultStatus:va,entityGroups:oa}))}catch(Da){e.a.J(512262850,811,10,"OnTextToSmartArtSuggestion: Exception occured while posting message to IR, Exception is: {0} ",Da)}}S9g(va){try{this.Nzb.trackIdeasProviderAction(va.cardId,
va.actionType,va.actionEngagement)}catch(Ca){e.a.J(512262849,811,10,"OnIdeasSessionTelemetry: Exception occured while calling TrackIdeasProviderAction in IR, Exception is: {0} ",Ca)}}ZHk(va){if(this.hlk)if(va)if(va){try{const Ca=G.a(va.Content);this.ooi(this.jCe,Ca)&&(this.jCe=Ca,this.FFe=!0)}catch(Ca){e.a.J(512262818,811,10,"Deserializing tile response failed");return}this.WFg&&this.gih()}else e.a.J(512262819,811,50,"ProcessSlideTextTileChange,TileNull");else e.a.J(512262848,811,50,"ProcessSlideTextTileChange,InputNull")}ooi(va,
Ca){if(!va&&Ca||va&&!Ca)return!0;if(!va&&!Ca)return!1;if(!va.drawingElems&&Ca.drawingElems||va.drawingElems&&!Ca.drawingElems)return!0;const oa=new D.a;for(const Da of va.drawingElems)if(va=Da.text)for(const ta of va.paragraphs)ta&&(w.a.Xa(ta.id)||w.a.Xa(ta.chars)||oa.$(ta.id,ta.chars));for(const Da of Ca.drawingElems)if(Ca=Da.text)for(const ta of Ca.paragraphs)if(ta&&!(w.a.Xa(ta.id)||w.a.Xa(ta.chars)||oa.Fb(ta.id)&&oa.ga(ta.id)===ta.chars))return!0;return!1}gih(){if(this.FFe){try{this.Nzb.postMessage(Object.assign(new I,
{messageType:I.PowerPointTextTileChangedMessageType,data:this.jCe}))}catch(va){e.a.J(512262817,811,10,"OnSlideTextTileChange: Exception occured while posting message to IR Exception is: {0} ",va)}this.Oze.Qwd(1);this.FFe=!1}}KLe(va,Ca){try{va=[],va.push(Object.assign(new N,{groupTypeId:R.a.WVf,providerId:R.a.cWf,notificationConfidence:Ca.ola?Ca.ola.notificationConfidence:0,shouldRaiseNotification:Ca.ola?Ca.ola.shouldRaiseNotification:!1,confidence:Ca.ola?Ca.ola.confidence:0,data:Ca.d5b})),this.Nzb.pushProviderResult(Object.assign(new C,
{providerId:R.a.cWf,resultStatus:Ca.ola?Ca.ola.resultStatus:O.a.invalid,entityGroups:va}))}catch(oa){e.a.J(512262816,811,10,"OnEditorCritiques: Exception occured while calling PushProviderResult in IR, Exception is: {0} ",oa)}Ca.ola&&"Success"===Ca.ola.resultStatus&&Ca.d5b&&!B.a.Xa(Ca.d5b.critiques)&&this.Oze.Qwd(2)}$ag(){if(!this.Qte)return e.a.J(512262815,811,50,"authenticationProvider is null"),null;try{if(this.aHb&&0<this.aHb.length)return this.Qte.v$i(new Ma(this.aHb,"user_impersonation",!0,
{}),this.lGg);e.a.J(512262814,811,50,"ShredderServiceResourceId is null or empty");return null}catch(va){return e.a.J(512262813,811,10,"Exception occured while retrieving auth token from wopi identity, Exception is: {0} ",va),null}}Ggj(){return new Promise(va=>{const Ca=this.TGb.Ha("749"),oa=this.$ag();Ca&&Ca.length&&oa?oa.then(Da=>{Da&&Da.length?(Da=new aa,Da.CountryCode="US",Da.IsEnabled=!1,Da.IsEnterpriseEnabled=!0,Da.IsGoLocal=!1,Da.ServiceEndpoint=Ca,Da.TenantRoot="",va(Da)):va(null)},()=>{va(null)}):
va(null)})}}Object(K.a)(Ea,"PPTWebEditorInfraredRuntimeManager",null,[959]);class ma{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Infrared"}Yb(va){this.K=va;this.K.register(v,"PowerPointWebEditor.Infrared.InfraredDesignerServiceProvider").as("PowerPointWebEditor.IDesignerServiceProvider").ma().oa(()=>new v);this.K.register(x,"PowerPointWebEditor.Infrared.InfraredTelemetryListener").as("PowerPointWebEditor.IInfraredTelemetryListener").ma().oa(()=>new x);this.K.register(z,"PowerPointWebEditor.Infrared.IdeasActionTracker").as("PowerPointWebEditor.Infrared.IIdeasActionTracker").ma().oa(()=>
new z(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.IAppSettingsManager")));e.a.J(512262812,809,50,"PPTWebEditorInfraredRuntimePackage - Registering IInfraredRuntimeManager");this.K.register(Ea,"PowerPointWebEditor.Infrared.PPTWebEditorInfraredRuntimeManager").as("PowerPointWebEditor.Infrared.IInfraredRuntimeManager").ma().oa(()=>new Ea(this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IDesignerServiceProvider"),this.K.resolve("PowerPointWebEditor.IInfraredTelemetryListener"),
this.K.resolve("Common.IActionManager"),this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.Ia("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"),this.K.resolve("PowerPointWebEditor.Infrared.IIdeasActionTracker"),this.K.resolve("Common.App.WopiIdentity.WopiIdentityManager"),this.K.resolve("PowerPointWebEditor.Infrared.IIdeasContext")))}init(){const va=this.K.resolve("Common.IAppSettingsManager");va.ff(()=>{va.ka("610")&&(e.a.J(512262811,809,50,"PPTWebEditorInfraredRuntimePackage - Initialize IInfraredRuntimeManager"),
this.K.resolve("PowerPointWebEditor.Infrared.IInfraredRuntimeManager"))})}dispose(){}static main(){h.a.instance.Ac(new ma)}}Object(K.a)(ma,"PPTWebEditorInfraredRuntimePackage",null,[2,3]);Type.registerNamespace("Microsoft.Office.Infrared");Type.registerNamespace("PowerPointWebEditor.Infrared");ma.main()}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19809348/wdjs/ppteditDS.infrared.js.map