(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[127],{807:function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return i});var r,i;(function(e){e[e.xSmall=0]="xSmall";e[e.small=1]="small";e[e.medium=2]="medium";e[e.large=3]="large"})(r||(r={}));(function(e){e[e.normal=0]="normal";e[e.large=1]="large"})(i||(i={}))},904:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(0),i=n(1),s=n(62),o=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.state={isRendered:void 0===Object(s.e)()};return n}t.prototype.componentDidMount=function(){var e=this,t=this.props.delay;this._timeoutId=window.setTimeout(function(){e.setState({isRendered:!0})},t)};t.prototype.componentWillUnmount=function(){this._timeoutId&&clearTimeout(this._timeoutId)};t.prototype.render=function(){return this.state.isRendered?i.Children.only(this.props.children):null};t.defaultProps={delay:0};return t})(i.Component)},950:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r,i;(function(e){e.Msa="msa_auth:";e.Graph="graph_auth:";e.MsaStrongAuth="msa_strong_auth:";e.PhoneLink="phone_link:";e.Substrate="substrate_auth:"})(r||(r={}));(function(e){e[e.STI=1]="STI";e[e.Default=2]="Default"})(i||(i={}))},976:function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(697),i=n(0),s=n(1),o=n(807),u=n(698),a=n(254),f=n(904),l=Object(u.e)(),c=(function(e){Object(i.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.type,n=e.size,r=e.ariaLabel,u=e.ariaLive,c=e.styles,h=e.label,p=e.theme,d=e.className,v=e.labelPosition,m=r,g=Object(a.u)(this.props,a.s,["size"]),y=n;void 0===y&&void 0!==t&&(y=t===o.t.large?o.e.large:o.e.medium);var b=l(c,{theme:p,size:y,className:d,labelPosition:v});return s.createElement("div",Object(i.__assign)({},g,{className:b.root}),s.createElement("div",{className:b.circle}),h&&s.createElement("div",{className:b.label},h),m&&s.createElement("div",{role:"status","aria-live":u},s.createElement(f.e,null,s.createElement("div",{className:b.screenReaderText},m))))};t.defaultProps={size:o.e.medium,ariaLive:"polite",labelPosition:"bottom"};return t})(s.Component),h=n(14),p=n(78),d={root:"ms-Spinner",circle:"ms-Spinner-circle",label:"ms-Spinner-label"},v=Object(p.t)(function(){return Object(h._)({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}})}),m=Object(r.e)(c,function(e){var t,n=e.theme,r=e.size,s=e.className,u=e.labelPosition,a=n.palette,f=Object(h.x)(d,n);return{root:[f.root,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},"top"===u&&{flexDirection:"column-reverse"},"right"===u&&{flexDirection:"row"},"left"===u&&{flexDirection:"row-reverse"},s],circle:[f.circle,{boxSizing:"border-box",borderRadius:"50%",border:"1.5px solid "+a.themeLight,borderTopColor:a.themePrimary,animationName:v(),animationDuration:"1.3s",animationIterationCount:"infinite",animationTimingFunction:"cubic-bezier(.53,.21,.29,.67)",selectors:(t={},t[h.o]=Object(i.__assign)({borderTopColor:"Highlight"},Object(h.T)()),t)},r===o.e.xSmall&&["ms-Spinner--xSmall",{width:12,height:12}],r===o.e.small&&["ms-Spinner--small",{width:16,height:16}],r===o.e.medium&&["ms-Spinner--medium",{width:20,height:20}],r===o.e.large&&["ms-Spinner--large",{width:28,height:28}]],label:[f.label,n.fonts.small,{color:a.themePrimary,margin:"8px 0 0",textAlign:"center"},"top"===u&&{margin:"0 0 8px"},"right"===u&&{margin:"0 0 0 8px"},"left"===u&&{margin:"0 8px 0 0"}],screenReaderText:h.M}},void 0,{scope:"Spinner"})},1198:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e.ScriptLoaded="share_scriptsLoaded";e.UIReady="share_uiReady";e.Ready="share_ready";e.Error="share_error";e.Resize="share_resize";e.GrantAccessCompleted="share_grantAccessCompleted";e.Dismiss="share_dismiss";e.ReadyForRecipients="share_readyForRecipients";e.OutlookClicked="share_outlookClicked";e.SendRecipients="atMention_defaultRecipients";e.ManageAccessClicked="share_manageAccessClicked";e.ShareCompleted="share_completed";e.MakeVisible="share_makeVisible";e.Destruct="share_destruct";e.ResetMakeVisible="share_resetMakeVisible";e.InstantLoadReady="share_instantLoadReady";e.ShareContextInformation="share_postContextInformation";e.Started="share_started";e.LinkSettingCompleted="share_linkSettingsCompleted";e.GetToken="share_getToken";e.DocumentInformation="share_documentInformation";e.SharingInfoBarInformation="share_sharingInfoBarInformation";e.SharingStoreReady="share_sharingStoreReady"})(r||(r={}))},1243:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(2),i=n(4),s=[{flightStringId:"FamilySharing",flightEnabled:Object(i.qo)(r.FamilySharing)},{flightStringId:"FamilySharingWacKS",flightEnabled:Object(i.qo)(r.FamilySharingWacKS)},{flightStringId:"ManageAccessRevampConsumer",flightEnabled:Object(i.qo)(r.ManageAccessRevampConsumer)},{flightStringId:"ODCHideNonPremiumLinkFeatures",flightEnabled:Object(i.qo)(r.ODCHideNonPremiumLinkFeatures)},{flightStringId:"ODCRequestAccess",flightEnabled:Object(i.qo)(r.ODCRequestAccess)},{flightStringId:"SharingTooltipCalloutKS",flightEnabled:Object(i.qo)(r.SharingTooltipCalloutKS)},{flightStringId:"Enable3SonWacWord",flightEnabled:Object(i.qo)(r.Enable3SonWacWord)},{flightStringId:"ODCFacepileFeature",flightEnabled:Object(i.qo)(r.ODCFacepileFeature)}]},1244:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.share=1]="share";e[e.copyLink=2]="copyLink";e[e.atMention=3]="atMention";e[e.manageAccess=5]="manageAccess";e[e.addPeople=7]="addPeople"})(r||(r={}))},1676:function(e,t,n){"use strict";n.r(t);n.d(t,"SharingIFrame",function(){return L});n.d(t,"ShareDialog",function(){return A});n.d(t,"WacGrantAccessDialog",function(){return O});n.d(t,"WacShareDialog",function(){return _});var r,i=n(0),s=n(1),o=n(1198);(function(e){e[e.Success=0]="Success";e[e.CannotGrantPermission=1]="CannotGrantPermission";e[e.UserDoesNotExist=2]="UserDoesNotExist";e[e.Failed=3]="Failed"})(r||(r={}));var u=n(727),a=n(21),f=n(34),l=n(162),c=n(165),h=n(242),p=n(212),d=n(976),v=n(807),m=n(106);Object(m.e)([{rawString:".wacShareDialog{position:relative}.wacShareDialog iframe{border:none}.spinner{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.wacShareDialogReady .spinner{display:none}.wacShareDialogLoading iframe{visibility:hidden}"}]);var g=n(133),y=n(80),b=n(101),w=n(16),E=n(721),S=n(1244),x=n(1243),T=n(950),N=1,C=w.e.isActivated("E1C27267-F996-4735-833A-AC42431C3886","11/25/2022","ODC WACShare Fullscreen"),k=w.e.isActivated("8B1E6850-95D2-11ED-87CD-0800200C9A66","1/16/2023","ODC WAC word 3s enabled");function L(e){var t=this,n=e.origin,r=e.dialogUrl,u=e.itemName,a=e.listItemId,f=e.correlationId,l=e.mode,c=e.navId,m=e.clickTime,g=e.accessChecked,y=e.recipients,b=e.ageGroup,w=e.onShareDismiss,E=e.onShareReady,S=e.onShareError,x=e.onShareTimeout,C=e.onGrantPermissionCompleted,L=Object(s.useRef)(null),A=Object(s.useRef)(null),O=Object(s.useRef)(null),M=Object(s.useState)(!1),_=M[0],D=M[1],P=Object(s.useCallback)(function(e){var t;if(e.origin===n&&e.source===(null===(t=A.current)||void 0===t?void 0:t.contentWindow)){var r=JSON.parse(e.data);switch(r.name){case o.e.Ready:D(!0);if(O.current){clearTimeout(O.current);O.current=null}null==E||E();break;case o.e.Error:if(O.current){clearTimeout(O.current);O.current=null}var i=r,s=i.error,u=i.errorMessage,a=i.debugErrorMessage;if(a)try{s=JSON.parse(a).error.name}catch(e){}null==S||S(s,u);break;case o.e.Resize:if(A.current){A.current.width="".concat(r.width);A.current.height="".concat(r.height)}break;case o.e.OutlookClicked:case o.e.Dismiss:null==w||w();break;case o.e.GrantAccessCompleted:null==C||C(r);break;case o.e.ReadyForRecipients:if(A.current){var f={name:"atMention_defaultRecipients",recipientIds:y.map(function(e){return e.Id})};A.current.contentWindow.postMessage(JSON.stringify(f),n)}break;default:window.console.log("Unknown message: "+r.name)}}},[D,n,y,w,E,S,C]),H=Object(h.t)();Object(s.useEffect)(function(){var e=L.current;if(e){(function(e){Object(i.__awaiter)(t,void 0,void 0,function(){var t,n,s,o,h,d,v,w,E,C,L,M,_;return Object(i.__generator)(this,function(i){switch(i.label){case 0:i.trys.push([0,5,,6]);t=H.consume(p.e);n=y?y.map(function(e){return e.Id}):[];s=void 0;return k?[3,2]:[4,Promise.all([t.getGraphToken({forceRefresh:!0}),t.getSubstrateToken(T.e.Default,!0)])];case 1:o=i.sent(),h=o[0],d=o[1];s={authToken:h.accessToken,additionalTokens:{substrateToken:d.accessToken},itemName:u,listItemId:a,clientId:"odcWac",correlationId:f,mode:l,navId:c,clickTime:m,accessChecked:g,defaultRecipients:n,ageGroup:b,emailAddress:null===(_=window.$Config)||void 0===_?void 0:_.email};return[3,4];case 2:return[4,t.getGraphToken({forceRefresh:!0})];case 3:v=i.sent();s={authToken:v.accessToken,itemName:u,listItemId:a,clientId:"odcWac",correlationId:f,mode:l,navId:c,clickTime:m,accessChecked:g,defaultRecipients:n,ageGroup:b};i.label=4;case 4:w="".concat("shareFrame","-").concat(N++);(E=document.createElement("iframe")).name=w;A.current=E;e.appendChild(E);(C=document.createElement("form")).target=w;C.action=r;C.method="POST";e.appendChild(C);(L=document.createElement("input")).type="hidden";L.name="context";L.value=JSON.stringify(s);C.appendChild(L);window.addEventListener("message",P);C.submit();O.current=window.setTimeout(x,3e4);return[3,6];case 5:M=i.sent();null==S||S("FailedToInitialize",null==M?void 0:M.message);return[3,6];case 6:return[2]}})})})(e);return function(){if(O.current){clearTimeout(O.current);O.current=null}window.removeEventListener("message",P)}}},[u,a,f,l,c,m,g,y,b,x,S,H]);return s.createElement("div",{ref:L,className:"\n        wacShareDialog\n        ".concat(_?"wacShareDialogReady":"wacShareDialogLoading","\n      ")},_?null:s.createElement(d.e,{className:"spinner",size:v.e.large}))}function A(e){var t=e.origin,n=e.devHost,r=e.onShareReady,o=e.onShareDismiss,f=e.onShareError,l=e.onShareTimeout,c="".concat(t,"/share?consumer=true&smkt=").concat(encodeURIComponent(y.e.language),"&origin=").concat(encodeURIComponent(window.location.origin))+(n?"&devhost=".concat(encodeURIComponent(n)):""),h=new a.e({name:"WacHost.ShareDialog"});return s.createElement(u.e,{isOpen:!0,styles:{main:{minWidth:480,minHeight:155}}},s.createElement(L,Object(i.__assign)({},e,{dialogUrl:c,onShareReady:function(){h.end({resultType:a.t.Success,resultCode:"Share dialog ready"});null==r||r()},onShareError:function(e,t){h.end({resultType:a.t.Failure,resultCode:"Share dialog error",extraData:{error:e,errorMessage:t}});null==f||f(e,t)},onShareTimeout:function(){h.end({resultType:a.t.Failure,resultCode:"Share dialog timeout"});null==l||l()},onShareDismiss:function(){h.end({resultType:a.t.Success,resultCode:"Share dialog dismissed"});null==o||o()}})))}function O(e){var t=Object(l.t)().dispatcher,n=Object(c.t)(),o=n.cache,u=n.clear,a=Object(s.useState)(!1),h=a[0],p=a[1];if(!o||!u)return null;var d=o.message,v=o.signal;return s.createElement(A,Object(i.__assign)({},e,{mode:S.e.addPeople,correlationId:d.ShareCorrelation,accessChecked:d.UserPermissionsVerified,onGrantPermissionCompleted:function(e){var t=e.successful;p(!0);v.resolve({MessageId:f.t.CheckUserAccessAndGrantPermissions_Result,Values:{Id:d.Id,DialogCanceled:!1,Persons:d.Persons.map(function(e){return{Id:e.Id,Provider:e.Provider,Status:t?r.Success:r.Failed}})},CorrelationId:g.e.generate()})},onShareReady:function(){t.respond(Object(f.n)())},onShareDismiss:function(){h||v.resolve({MessageId:f.t.CheckUserAccessAndGrantPermissions_Result,Values:{Id:d.Id,DialogCanceled:!0,Persons:d.Persons.map(function(e){return{Id:e.Id,Provider:e.Provider,Status:r.Failed}})},CorrelationId:g.e.generate()});t.respond(Object(f.r)());u()}}))}function M(e){var t=this,r=Object(E.e)(function(){return Object(i.__awaiter)(t,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(3,1673)];case 1:return[2,e.sent().ShareDialog]}})})});return s.createElement(r,Object(i.__assign)({},e))}function _(e){var t=this,r=Object(h.t)(),o=Object(c.t)(),u=o.cache,a=o.clear,d=Object(l.t)().dispatcher,v=Object(s.useCallback)(function(){d.respond(Object(f.n)())},[d]),m=Object(s.useCallback)(function(){d.respond(Object(f.r)());null==u||u.signal.resolve(void 0);a()},[d,null==u?void 0:u.signal,a]),g=Object(s.useState)(!0),E=g[0],N=g[1];if(!(e.isOwlRampEnabled||u&&a))return null;var L=e.isOwlRampEnabled?e.mode:(function(e){return S.e[e]||S.e.share})(null==u?void 0:u.message.mode),O=e.isOwlRampEnabled?e.correlationId:null==u?void 0:u.message.ShareCorrelation,_=e.isOwlRampEnabled?e.navId:null==u?void 0:u.message.nav,D=e.isOwlRampEnabled?e.clickTime:null==u?void 0:u.message.clickTime;if(C)return E?s.createElement(A,Object(i.__assign)({},e,{mode:L,correlationId:O,navId:_,clickTime:D,onShareReady:e.isOwlRampEnabled?void 0:v,onShareDismiss:e.isOwlRampEnabled?function(){N(!1)}:m})):null;var P=w.e.isActivated("FBB80417-B626-42B0-9DF6-872E93DD94F6","11/11/2022","ODC Share Fullscreen"),H=w.e.isActivated("1CA4EBCD-F7E0-42C0-B5D7-BA07ECB8BCDC","11/30/2022","ODC Max Height Based on Window.innerHeight"),B={initializeShareFrame:function(r){var s=r.parentElement,o=r.calloutProps,u=r.sharingInformation,a=r.onError,f=u.authToken,l=u.webAbsoluteUrl,c=u.additionalTokens;Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,u;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,n.ee([109],1392)];case 1:t=i.sent().SharePrefetch;r={authToken:f||"",additionalTokens:c,webAbsoluteUrl:l||"",listItemId:e.listItemId,itemName:o.itemName,itemCount:1,multiShareIds:[e.listItemId],mode:Number(o.mode),defaultRecipients:o.defaultRecipients,theme:o.theme,hostOptions:{hideShareDialogOverflowButton:!0},clientId:"odcWac",consumerFlightContexts:x.e,fullScreenIframe:!P,emailAddress:k?null:null===(u=window.$Config)||void 0===u?void 0:u.email};if(!H)try{r.maxHeight=window.innerHeight}catch(e){}return[4,new t({element:s,environment:b.e.prod,locale:o.locale,disableIframeDomainCheck:!0,isConsumer:!0,context:r,options:{onError:a,openManageAccess:o.openManageAccess}}).initializeUI()];case 2:i.sent();return[2]}})})},getSharingInformation:function(){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,n,s,o,u;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=r.consume(p.e);return k?[3,2]:[4,Promise.all([t.getGraphToken({forceRefresh:!0}),t.getSubstrateToken(T.e.Default,!0)])];case 1:n=i.sent(),s=n[0],o=n[1];return[2,Promise.resolve({authToken:s.accessToken,itemId:e.listItemId,additionalTokens:{substrateToken:o.accessToken}})];case 2:return[4,t.getGraphToken({forceRefresh:!0})];case 3:u=i.sent();return[2,Promise.resolve({authToken:u.accessToken,itemId:e.listItemId})]}})})},getClientId:function(){return"WAC"},mode:(function(t){return e.isOwlRampEnabled&&e.mode?e.mode:"copy"===t?S.e.copyLink:S.e[t]||S.e.share})(null==u?void 0:u.message.mode),resolve:function(){console.log("ShareDialog loaded")},reject:function(){console.log("ShareDialog error")},locale:y.e.language||"en-US",itemName:e.itemName,iFrameFullScreenOverride:!0};return s.createElement(M,Object(i.__assign)({},B))}}}]);