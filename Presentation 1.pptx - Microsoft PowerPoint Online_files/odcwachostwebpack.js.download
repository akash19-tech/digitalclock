/*! For license information please see odcwachostwebpack.js.LICENSE.txt */
(function(e){function t(t){for(var r,i,s=t[0],o=t[1],u=t[2],a=0,f=[];a<s.length;a++){i=s[a];Object.prototype.hasOwnProperty.call(c,i)&&c[i]&&f.push(c[i][0]);c[i]=0}for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r]);b&&b(t);for(;f.length;)f.shift()();h.push.apply(h,u||[]);return n()}function n(){for(var e,t=0;t<h.length;t++){for(var n=h[t],r=!0,i=1;i<n.length;i++){var s=n[i];0!==c[s]&&(r=!1)}if(r){h.splice(t--,1);e=p(p.s=n[0])}}return e}var r=window,i=r.require;function s(e){var t=e&&e.indexOf("/",e.indexOf("://")+3)+1;return t?e.slice(0,t):e}var o=document.currentScript,u=s(o&&o.src||i&&i.toUrl("")),a=s(r.__backupBaseUrl),f=i&&i.s.contexts._,l={},c={odcwachostwebpack:0},h=[];function p(t){if(l[t])return l[t].exports;var n=l[t]={i:t,l:!1,exports:{}};e[t].call(n.exports,n,n.exports,p);n.l=!0;return n.exports}var d=[[],[133],[74],[114,"ondemand.resx-ondemand"],[127],[131],[138],[179,"ondemand.resx-ondemand"],[66,"ondemand.resx-ondemand"],[80,"ondemand.resx-ondemand"]];p.ee=function(e,t,n){return Promise.all((Array.isArray(e)?e:d[e]).map(function(e){return p.e(e)})).then(n?p.t.bind(0,t,n):p.bind(0,t))};p.e=function(e){var t=f&&f.config.paths[e]&&f.nameToUrl(e)||(function(e){return p.p+""+e+".js"})(e);function n(e){var n=[],i=c[e];if(0!==i)if(i)n.push(i[2]);else{var s=new Promise(function(t,n){i=c[e]=[t,n]});n.push(i[2]=s);var o,u=document.createElement("script");u.charset="utf-8";u.timeout=120;p.nc&&u.setAttribute("nonce",p.nc);u.src=t;0!==u.src.indexOf(window.location.origin+"/")&&(u.crossOrigin="anonymous");var a=new Error;o=function(t){u.onerror=u.onload=null;clearTimeout(f);var n=c[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;a.message="Loading chunk "+e+" failed.\n("+r+": "+i+")";a.name="ChunkLoadError";a.type=r;a.request=i;n[1](a)}c[e]=void 0}};var f=setTimeout(function(){o({type:"timeout",target:u})},12e4);u.onerror=u.onload=o;var l=r.__odspSriHashes;if(l){var h=l[r.__odsp_culture+"/"+e]||l[e];h&&(u.integrity=h)}document.head.appendChild(u)}return Promise.all(n)}return n(e).catch(function(i){var s=r.__integrityViolationCallBack;s&&s(i.request);var o=a&&t.replace(u,a);if(o&&o!==t){t=o;return n(e)}return Promise.reject(i)})};p.m=e;p.c=l;p.d=function(e,t,n){p.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})};p.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});Object.defineProperty(e,"__esModule",{value:!0})};p.t=function(e,t){1&t&&(e=p(e));if(8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);p.r(n);Object.defineProperty(n,"default",{enumerable:!0,value:e});if(2&t&&"string"!=typeof e)for(var r in e)p.d(n,r,function(t){return e[t]}.bind(null,r));return n};p.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};p.d(t,"a",t);return t};p.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};p.p="/";p.oe=function(e){console.error(e);throw e};var v=p.p;Object.defineProperty(p,"p",{get:function(){if(window.require&&window.require.toUrl){var e=window.require.toUrl("");v=("/"!==e.slice(-1)?e+"/":e)+"odcwachostwebpack.manifest/"}return v}});var m=window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[],g=m.push.bind(m);m.push=t;m=m.slice();for(var y=0;y<m.length;y++)t(m[y]);var b=g;h.push([605,"plt.resx-plt","plt.react","plt.office-ui-fabric-react","plt.odsp-common","plt.items-view"]);n()})(Array(0).concat([function(e,t,n){"use strict";n.r(t);n.d(t,"__extends",function(){return i});n.d(t,"__assign",function(){return s});n.d(t,"__rest",function(){return o});n.d(t,"__decorate",function(){return u});n.d(t,"__param",function(){return a});n.d(t,"__metadata",function(){return f});n.d(t,"__awaiter",function(){return l});n.d(t,"__generator",function(){return c});n.d(t,"__createBinding",function(){return h});n.d(t,"__exportStar",function(){return p});n.d(t,"__values",function(){return d});n.d(t,"__read",function(){return v});n.d(t,"__spread",function(){return m});n.d(t,"__spreadArrays",function(){return g});n.d(t,"__spreadArray",function(){return y});n.d(t,"__await",function(){return b});n.d(t,"__asyncGenerator",function(){return w});n.d(t,"__asyncDelegator",function(){return E});n.d(t,"__asyncValues",function(){return S});n.d(t,"__makeTemplateObject",function(){return x});n.d(t,"__importStar",function(){return N});n.d(t,"__importDefault",function(){return C});n.d(t,"__classPrivateFieldGet",function(){return k});n.d(t,"__classPrivateFieldSet",function(){return L});var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var s=function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};function o(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function u(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(i=e[u])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o}function a(e,t){return function(n,r){t(n,r,e)}}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,u);var t}a((r=r.apply(e,t||[])).next())})}function c(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return(function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;(r=0,i)&&(s=[2&s[0],i.value]);switch(s[0]){case 0:case 1:i=s;break;case 4:o.label++;return{value:s[1],done:!1};case 5:o.label++;r=s[1];s=[0];continue;case 7:s=o.ops.pop();o.trys.pop();continue;default:if(!(i=o.trys,i=i.length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1];i=s;break}if(i&&o.label<i[2]){o.label=i[2];o.ops.push(s);break}i[2]&&o.ops.pop();o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e];r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}})([s,u])}}}var h=Object.create?function(e,t,n,r){void 0===r&&(r=n);Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n);e[r]=t[n]};function p(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||h(t,e,n)}function d(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){e&&r>=e.length&&(e=void 0);return{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function g(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var s=arguments[t],o=0,u=s.length;o<u;o++,i++)r[i]=s[o];return r}function y(e,t,n){if(n||2===arguments.length)for(var r,i=0,s=t.length;i<s;i++)if(r||!(i in t)){r||(r=Array.prototype.slice.call(t,0,i));r[i]=t[i]}return e.concat(r||Array.prototype.slice.call(t))}function b(e){return this instanceof b?(this.v=e,this):new b(e)}function w(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){i[e]&&(r[e]=function(t){return new Promise(function(n,r){s.push([e,t,n,r])>1||u(e,t)})})}function u(e,t){try{(n=i[e](t)).value instanceof b?Promise.resolve(n.value.v).then(a,f):l(s[0][2],n)}catch(e){l(s[0][3],e)}var n}function a(e){u("next",e)}function f(e){u("throw",e)}function l(e,t){(e(t),s.shift(),s.length)&&u(s[0][0],s[0][1])}}function E(e){var t,n;return t={},r("next"),r("throw",function(e){throw e}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:b(e[r](t)),done:"return"===r}:i?i(t):t}:i}}function S(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=d(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){(function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)})(r,i,(t=e[n](t)).done,t.value)})}}}function x(e,t){Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t;return e}var T=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function N(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&h(t,e,n);T(t,e);return t}function C(e){return e&&e.__esModule?e:{default:e}}function k(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function L(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n}},,function(e,t,n){"use strict";n.r(t);n.d(t,"On",function(){return u});n.d(t,"Off",function(){return a});n.d(t,"SendForSignatureEnabled",function(){return f});n.d(t,"EnableSearchInRecycleBinFreemium",function(){return l});n.d(t,"DisableCommandsWhenOffline",function(){return c});n.d(t,"SPListsHomeSubstrateAPI",function(){return h});n.d(t,"ODCRequestAccess",function(){return p});n.d(t,"HolidayPositioningFRE",function(){return d});n.d(t,"Onboarding50GBStandAlonePlanRamp",function(){return v});n.d(t,"RecurringFrePositioningExp",function(){return m});n.d(t,"EnableRecurringFrePositioning",function(){return g});n.d(t,"OneHunderedGBFreDimeEnabled",function(){return y});n.d(t,"OneHunderedGBFreDimeExp",function(){return b});n.d(t,"OneHunderedGBFreFreeTrialEnabled",function(){return w});n.d(t,"OneHunderedGBFreFreeTrialExp",function(){return E});n.d(t,"OneHunderedGBFre100DefaultDimeEnabled",function(){return S});n.d(t,"OneHunderedGBFre100DefaultDimeExp",function(){return x});n.d(t,"EnableHundredGBDIME",function(){return T});n.d(t,"HundredGBDIMEExperiment",function(){return N});n.d(t,"UploadQuotaWarningDialogExp",function(){return C});n.d(t,"UploadQuotaWarningDialogEnabled",function(){return k});n.d(t,"GB100FreeTrialDialogExp",function(){return L});n.d(t,"Enable100GBFreeTrialDialog",function(){return A});n.d(t,"EnableM365Basic",function(){return O});n.d(t,"InfoPaneActivityFeed",function(){return M});n.d(t,"EnableMsJs",function(){return _});n.d(t,"ShowEmailInPeoplePicker",function(){return D});n.d(t,"ModernSharePointStore",function(){return P});n.d(t,"EnableTeachingBubbles",function(){return H});n.d(t,"EnableCoachmarks",function(){return B});n.d(t,"AddToOneDriveBubble",function(){return j});n.d(t,"PhotosSearchBubble",function(){return F});n.d(t,"SharingDialogRedux",function(){return I});n.d(t,"RUMOne",function(){return q});n.d(t,"EnableNotificationSubscriptions",function(){return R});n.d(t,"ShowTagCountInPhotos",function(){return U});n.d(t,"CollaborativeAlbumsEnabled",function(){return z});n.d(t,"UseVroomGetPermissions",function(){return W});n.d(t,"RenderListDataAsStreamLeftNavOpt",function(){return X});n.d(t,"MillionsofTagsControl",function(){return V});n.d(t,"RemoveFromSharedList",function(){return $});n.d(t,"PromotedPhotosContentEnabled",function(){return J});n.d(t,"OneRmO365UpsellEnabled",function(){return K});n.d(t,"EnableLoadDimeJs",function(){return Q});n.d(t,"EnableDimeMarketFix",function(){return G});n.d(t,"EnableDimePageConfigMarket",function(){return Y});n.d(t,"EnableDimeVaultUpsell",function(){return Z});n.d(t,"EnableDimeVaultDialog",function(){return ee});n.d(t,"EnableDimeHolidayPositioning",function(){return te});n.d(t,"ODBSyncButtonDefaultNGSC",function(){return ne});n.d(t,"HideSyncButton",function(){return re});n.d(t,"OneDriveAspxRedirect",function(){return ie});n.d(t,"RecycleBinImmersive",function(){return se});n.d(t,"EnableNewTicketingService",function(){return oe});n.d(t,"SiteAnalyticsV3",function(){return ue});n.d(t,"SiteTraffic2",function(){return ae});n.d(t,"EnableAllNewsAndSiteAnalyticsInGovClouds",function(){return fe});n.d(t,"EnablePasswordProtectedLinks",function(){return le});n.d(t,"EnablePremiumCheckWebPasswordLinks",function(){return ce});n.d(t,"EnableResponsiveFilesListView",function(){return he});n.d(t,"EnableIconographyExperiment",function(){return pe});n.d(t,"EnableEXPExperimentAATest",function(){return de});n.d(t,"EnableNewSharedFolder",function(){return ve});n.d(t,"DwellTimeTopItemsEnabled",function(){return me});n.d(t,"SitePagesTimeSpent",function(){return ge});n.d(t,"UsePrimeApiMoveCopy",function(){return ye});n.d(t,"CreateDwellDataInExcel",function(){return be});n.d(t,"CreateDocLibWithSensLabel",function(){return we});n.d(t,"DocumentSettingPanel",function(){return Ee});n.d(t,"DisplayAggregatedSitesCountMessage",function(){return Se});n.d(t,"HideHubChartsIfYggdrassilsUnavailable",function(){return xe});n.d(t,"EnableGeoLocationDEU",function(){return Te});n.d(t,"MentionTeachingUIAA",function(){return Ne});n.d(t,"MentionTeachingUIAB",function(){return Ce});n.d(t,"MentionTeachingUI",function(){return ke});n.d(t,"LogPeoplePickerMounting",function(){return Le});n.d(t,"EnableNewHasAccessControl",function(){return Ae});n.d(t,"AttachGroupIdToSharedByKey",function(){return Oe});n.d(t,"UseFluidDevPreview",function(){return Me});n.d(t,"CustomActionPreFetch",function(){return _e});n.d(t,"TipsNTricksForCommSite",function(){return De});n.d(t,"PermUpdateForChannelSIte",function(){return Pe});n.d(t,"VivaConnectionsGA",function(){return He});n.d(t,"VivaConnectionsPreviewTagRemoval",function(){return Be});n.d(t,"EnableRedeemSamsungBonusDialog",function(){return je});n.d(t,"RepositionUpsellFREExperiment",function(){return Fe});n.d(t,"FamilySharing",function(){return Ie});n.d(t,"FamilySharingWacKS",function(){return qe});n.d(t,"ManageAccessRevampConsumer",function(){return Re});n.d(t,"ODCSharePrefetchInline",function(){return Ue});n.d(t,"ODCHideNonPremiumLinkFeatures",function(){return ze});n.d(t,"SharingTooltipCalloutKS",function(){return We});n.d(t,"OneHundredGBSKUExperiment",function(){return Xe});n.d(t,"OneHundredGBSKUEnabled",function(){return Ve});n.d(t,"FiftyGBSKUExperiment",function(){return $e});n.d(t,"FiftyGBSKUEnabled",function(){return Je});n.d(t,"Enable3SonWacWord",function(){return Ke});n.d(t,"ODCFacepileFeature",function(){return Qe});n.d(t,"DownloadAsZip",function(){return Ge});n.d(t,"PolicyTipPanel",function(){return Ye});n.d(t,"FileHandlersV2",function(){return Ze});n.d(t,"AuthZenUserActivityInSight",function(){return et});n.d(t,"EnableExcelSurveyV2",function(){return tt});n.d(t,"EnableExcelSurveyV2LicenseCheck",function(){return nt});n.d(t,"UseOLSQueryForSearch",function(){return rt});n.d(t,"DisableExcelSurveyV2TeamSite",function(){return it});n.d(t,"DragAndDropRobotAnimation",function(){return st});n.d(t,"SpListInPageSearch",function(){return ot});n.d(t,"SpListNextTheming",function(){return ut});n.d(t,"SuiteNavPrefersTenantTheme",function(){return at});n.d(t,"OversharingMitigations",function(){return ft});n.d(t,"ODBNextUserFeedbackViaYammer",function(){return lt});n.d(t,"RecursiveUnsharing",function(){return ct});n.d(t,"MoveCopyFolderSelectionUX",function(){return ht});n.d(t,"CopyCrossSiteFromTeamSite",function(){return pt});n.d(t,"MoveCrossSite",function(){return dt});n.d(t,"MoveCopyCrossLibraryUsePrime",function(){return vt});n.d(t,"ItemAnalytics",function(){return mt});n.d(t,"ItemAnalyticsChart",function(){return gt});n.d(t,"FileMoveSharingHint",function(){return yt});n.d(t,"SensitivityLabelEditor",function(){return bt});n.d(t,"ShowInfoPaneByDefault",function(){return wt});n.d(t,"UseReactGridListGroup",function(){return Et});n.d(t,"EmbeddedPowerApps",function(){return St});n.d(t,"PowerAppsAndAndProcessSimpleTestEnvironment",function(){return xt});n.d(t,"PowerAppsAndAndProcessSimpleDevEnvironment",function(){return Tt});n.d(t,"UseReactSPOHeader",function(){return Nt});n.d(t,"EnablePushChannelAutoRefresh",function(){return Ct});n.d(t,"AllowPushChannelLongPolling",function(){return kt});n.d(t,"AllowPushChannelDnsUrls",function(){return Lt});n.d(t,"EnablePushChannel",function(){return At});n.d(t,"ShowFirstRunInLibraries",function(){return Ot});n.d(t,"ShowFirstRunInLists",function(){return Mt});n.d(t,"AutoAlbumBannerV2Enabled",function(){return _t});n.d(t,"SPOAppPrecludeIE9",function(){return Dt});n.d(t,"EnableGetItemsPrefetch",function(){return Pt});n.d(t,"PeopleCards",function(){return Ht});n.d(t,"PeopleCardsLinkedInIntegration",function(){return Bt});n.d(t,"MessageBorder",function(){return jt});n.d(t,"SubjectLine",function(){return Ft});n.d(t,"PeopleCardsLokiDogfood",function(){return It});n.d(t,"GrooveNewProtocol",function(){return qt});n.d(t,"UseNewSharingDialog",function(){return Rt});n.d(t,"UseNewReportAbuseDialog",function(){return Ut});n.d(t,"UserVroomApiForRemoveFromShareWithMeListAndReportAbuse",function(){return zt});n.d(t,"UseVroomApiForReportAbuse",function(){return Wt});n.d(t,"UseVroomApiForRequestReview",function(){return Xt});n.d(t,"UseVroomUpdateCaption",function(){return Vt});n.d(t,"EnableAnonReportConcernCommand",function(){return $t});n.d(t,"EnableEnhancedMobileUpsell",function(){return Jt});n.d(t,"RecycleBinListFooter",function(){return Kt});n.d(t,"EnableViewInFolder",function(){return Qt});n.d(t,"PhotosLayoutViewDisabled",function(){return Gt});n.d(t,"VisioDrawingCreation",function(){return Yt});n.d(t,"UseVroomUpload",function(){return Zt});n.d(t,"SyncButtonStringChange",function(){return en});n.d(t,"EnableSecurityMomentLightbox",function(){return tn});n.d(t,"ShareV3",function(){return nn});n.d(t,"EnableManageAccessInReact",function(){return rn});n.d(t,"EnableWideCenteredManageAccess",function(){return sn});n.d(t,"ODCInlineShare",function(){return on});n.d(t,"ODCManageAccessCommandBarContextMenu",function(){return un});n.d(t,"EnableLinkSettingsEditPanel",function(){return an});n.d(t,"PreventDownloadLink",function(){return fn});n.d(t,"CoachMarkInLinkSettingsExperiment",function(){return ln});n.d(t,"UseActivitiesApi",function(){return cn});n.d(t,"DownloadNotifications",function(){return hn});n.d(t,"VersionAllFiles",function(){return pn});n.d(t,"Groupify",function(){return dn});n.d(t,"DocAspxCreateNewWord",function(){return vn});n.d(t,"EnableEvokeAlignments",function(){return mn});n.d(t,"EvokeDev",function(){return gn});n.d(t,"SuiteNavPerfListThreshold",function(){return yn});n.d(t,"EnableInfoPaneStickyHeader",function(){return bn});n.d(t,"SaveListSortAndGroupBy",function(){return wn});n.d(t,"SaveListFilterUpdates",function(){return En});n.d(t,"SaveListFieldUpdates",function(){return Sn});n.d(t,"EnableTrendingSignalInListView",function(){return xn});n.d(t,"CreateSharedLibraryInODB",function(){return Tn});n.d(t,"ChangeCreateSharedLibraryIFrameUrl",function(){return Nn});n.d(t,"UseTilesList",function(){return Cn});n.d(t,"UseTilesListForAllPhotos",function(){return kn});n.d(t,"ShowLeftNavOnRestorePage",function(){return Ln});n.d(t,"SharedLeftNav",function(){return An});n.d(t,"PeoplePickerGraph",function(){return On});n.d(t,"PeoplePicker3S",function(){return Mn});n.d(t,"DisablePeoplePicker3SExperiment",function(){return _n});n.d(t,"ImplicitShareNotify",function(){return Dn});n.d(t,"isForceImplicitSharingExperimentEnabled",function(){return Pn});n.d(t,"EnableLinkLevelManageAccess",function(){return Bn});n.d(t,"UseVroomDownload",function(){return jn});n.d(t,"MediaTAUseVroomV21",function(){return Fn});n.d(t,"EnableAnonymousSigninDialog",function(){return In});n.d(t,"UnauthenticatedBannerUseSigninDialog",function(){return qn});n.d(t,"ProjectVWeb",function(){return Rn});n.d(t,"ProjectVKeyboardShortcut",function(){return Un});n.d(t,"EnableOrderPrints",function(){return zn});n.d(t,"SigninDialogSupportBusinessAccounts",function(){return Wn});n.d(t,"SamsungGalleryFilter",function(){return Xn});n.d(t,"UseODBRestoreArticle",function(){return Vn});n.d(t,"FlowRemindMeCoachmark",function(){return $n});n.d(t,"FlowOdbCommandBarCoachmark",function(){return Jn});n.d(t,"FlowSignOffCoachmark",function(){return Kn});n.d(t,"ReviewPermissionUI",function(){return Qn});n.d(t,"OfficeReviewPermission",function(){return Gn});n.d(t,"ReviewPermissionExp",function(){return Yn});n.d(t,"EnableVroomEmailSettings",function(){return Zn});n.d(t,"EnableVroomTaggingSettings",function(){return er});n.d(t,"EnableManageStorageSettings",function(){return tr});n.d(t,"EnableVroomDocFormatSettings",function(){return nr});n.d(t,"UseItemsScopeInPicker",function(){return rr});n.d(t,"UseItemsScopeInAllPhotosEnableGrid",function(){return ir});n.d(t,"UseItemsScopeInAllPhotosForwardPaging",function(){return sr});n.d(t,"UseItemsScopeInExplorePhotos",function(){return or});n.d(t,"UsePhysicalPixelSizeThumbsInAllPhotosView",function(){return ur});n.d(t,"RequestCacheSizeThumbnails",function(){return ar});n.d(t,"EnableMultiplePhotoStories",function(){return fr});n.d(t,"EnablePhotoStream",function(){return lr});n.d(t,"EnablePhotoStreamInviteExpOne",function(){return cr});n.d(t,"EnablePhotoStreamInviteExpOneOn",function(){return hr});n.d(t,"EnablePhotoStreamInLeftNav",function(){return pr});n.d(t,"EnableNewCarouselDesign",function(){return dr});n.d(t,"EnableNewCarouselDesignExp",function(){return vr});n.d(t,"EnableOnThisMonth",function(){return mr});n.d(t,"EnableRecommendationApi",function(){return gr});n.d(t,"EnableLastWeekPreviousYears",function(){return yr});n.d(t,"EnableMojFeedback",function(){return br});n.d(t,"EnableNewPhotosExperience",function(){return wr});n.d(t,"EnableMOJNotificationBanner",function(){return Er});n.d(t,"EnableSeeAllSeeFeaturedButton",function(){return Sr});n.d(t,"UseLegacyDataManagerToFirePLT",function(){return xr});n.d(t,"PasteToUploadFromClipboard",function(){return Tr});n.d(t,"MoveAndCopyWithClipboard",function(){return Nr});n.d(t,"AddPeopleReact",function(){return Cr});n.d(t,"SubscribeToItemPerRowInDetailsList",function(){return kr});n.d(t,"SyntexBrandingEnabled",function(){return Lr});n.d(t,"ReadOnlyItemsStore",function(){return Ar});n.d(t,"InAppMessagingMLUpsellPositioning",function(){return Or});n.d(t,"LeftNavTeamSiteLibraries",function(){return Mr});n.d(t,"EnableDocLibServiceWorker",function(){return _r});n.d(t,"DisableDocLibServiceWorker",function(){return Dr});n.d(t,"EnableServiceWorkerDataCachingWeb",function(){return Pr});n.d(t,"EnableServiceWorkerHomePageCachingWeb",function(){return Hr});n.d(t,"EnableServiceWorkerRecentCachingWeb",function(){return Br});n.d(t,"EnableServiceWorkerEncryptionWeb",function(){return jr});n.d(t,"EnableServiceWorkerDebuggingWeb",function(){return Fr});n.d(t,"EnableServiceWorkerJsCachingPWA",function(){return Ir});n.d(t,"NavigationPreloadForOdbServiceWorker",function(){return qr});n.d(t,"EnablePDFWebWorkerManifest",function(){return Rr});n.d(t,"UseMsPdfWebWorkerManifest",function(){return Ur});n.d(t,"IPRecordVersioningClient",function(){return zr});n.d(t,"DeleteConfirmDialogODC",function(){return Wr});n.d(t,"RestoreDSTAdjustment",function(){return Xr});n.d(t,"ReactEditItemPanel",function(){return Vr});n.d(t,"Image360Viewer",function(){return $r});n.d(t,"GroupifyFromModernPages",function(){return Jr});n.d(t,"MruToMruPlusPlusSkyApi",function(){return Kr});n.d(t,"ShowSharepointRestoreLink",function(){return Qr});n.d(t,"UseReactConsumerShell",function(){return Gr});n.d(t,"LivePersonaPickerEnabled",function(){return Yr});n.d(t,"UseLegacyCoachmarkExperiment",function(){return Zr});n.d(t,"StoreViewSettings",function(){return ei});n.d(t,"OneDriveSettings",function(){return ti});n.d(t,"SPListLightSpeed",function(){return ni});n.d(t,"EnableFraudTenantBannerNotification",function(){return ri});n.d(t,"EnableRecentForMediaTypeFilters",function(){return ii});n.d(t,"EnableItemsScopeInPickerRecent72",function(){return si});n.d(t,"ODBSearchTenantScope",function(){return oi});n.d(t,"Use3SEventsAPI",function(){return ui});n.d(t,"DisableShareInvalidateItemInSearchView",function(){return ai});n.d(t,"WriteMruSignalWhenMediaPicked",function(){return fi});n.d(t,"WriteMruSignalWhenMediaDownloaded",function(){return li});n.d(t,"LanguageRedirect",function(){return ci});n.d(t,"LanguageProfileChange",function(){return hi});n.d(t,"OldSiteSettingsPage",function(){return pi});n.d(t,"CreateDocumentPromptSameTab",function(){return di});n.d(t,"CreateDocumentToVroom",function(){return vi});n.d(t,"HideAccessRequestLink",function(){return mi});n.d(t,"ShareableAddressBarLink",function(){return gi});n.d(t,"RedirectExcelSurveysToFormsV2",function(){return yi});n.d(t,"SkipSettingMicroserviceBaseInfo",function(){return bi});n.d(t,"DisablePremiumUserFactUpdate",function(){return wi});n.d(t,"DisableSingleFileDownloadFallback",function(){return Ei});n.d(t,"UseVroomInVaultSingleFileDownload",function(){return Si});n.d(t,"UsePagingTokenForSearch",function(){return xi});n.d(t,"CreateListLargeDialog",function(){return Ti});n.d(t,"OrgListTemplatesPivot",function(){return Ni});n.d(t,"OrgListTemplatesUseApplyListDesign",function(){return Ci});n.d(t,"OOTBListTemplatesFromCDN",function(){return ki});n.d(t,"ListTemplatePreviewV2",function(){return Li});n.d(t,"SPListWebPack",function(){return Ai});n.d(t,"ContentCenterUIGAFeatures",function(){return Oi});n.d(t,"ModelDiscoveryPanelFlight",function(){return Mi});n.d(t,"FormProcessingModelRetentionLabelSupport",function(){return _i});n.d(t,"SyntexFormProcessingModelTableSupport",function(){return Di});n.d(t,"SyntexFlowTemplates",function(){return Pi});n.d(t,"SyntexEmailClassifyAndExtractFlowTemplate",function(){return Hi});n.d(t,"SyntexFormProcessingModelClassifyAndExtract",function(){return Bi});n.d(t,"RunModelFlatFileStructureSupport",function(){return ji});n.d(t,"RunModelFolderClassificationSupportEnabled",function(){return Fi});n.d(t,"RunModelCustomizationSupportEnabled",function(){return Ii});n.d(t,"HighPrioritySchedulingFeature",function(){return qi});n.d(t,"EnableWebTemplatesGallery",function(){return Ri});n.d(t,"ThirdPartySiteTemplateProgressUX",function(){return Ui});n.d(t,"TeamsAppMobileSubEntityChat",function(){return zi});n.d(t,"RetrieveFlowsFromGroupEnvironment",function(){return Wi});n.d(t,"BizAppsForListTemplates",function(){return Xi});n.d(t,"ThirdPartyBizAppsForListTemplates",function(){return Vi});n.d(t,"BuiltInDocLibAnalyzerFlow",function(){return $i});n.d(t,"UsePowerAutomateMakerPortal",function(){return Ji});n.d(t,"WEXMultipleHomeSitesGlobalNav",function(){return Ki});n.d(t,"UseSdk80FilePickerForRunSharingReport",function(){return Qi});n.d(t,"EnableOneUpVisioPreview",function(){return Gi});n.d(t,"EnableWrsPreviewOutsideODB",function(){return Yi});n.d(t,"EnableZipFilePreviewing",function(){return Zi});n.d(t,"DisableZipContentDownload",function(){return es});n.d(t,"UseSandboxHtmlViewer",function(){return ts});n.d(t,"UseWebPdfViewer",function(){return ns});n.d(t,"EnableNewOneUpCommandBar",function(){return rs});n.d(t,"EnableNewOneUpCommandBarODCExperiment",function(){return is});n.d(t,"EnableNewOneUpCommandBarODCExperiment_ABTrigger",function(){return ss});n.d(t,"EnableDarkThemeForOneUpMediaViewer",function(){return os});n.d(t,"EnableDarkThemeForOneUpMediaViewerODCExperiment",function(){return us});n.d(t,"EnableDarkThemeForOneUpMediaViewerODCExperiment_ABTrigger",function(){return as});n.d(t,"DisableOneUpUpdateViewCount",function(){return fs});n.d(t,"EnableOneUpTextFileV2",function(){return ls});n.d(t,"EnableOneUpAZNBViewer",function(){return cs});n.d(t,"EnableOneUpAZNBViewerForEmbed",function(){return hs});n.d(t,"EnableNewOneUpWithNoKO",function(){return ps});n.d(t,"EnableMobileWebOfficeAppUpsell",function(){return ds});n.d(t,"EnableOneUpNotifyHostAccessibilityKeySequence",function(){return vs});n.d(t,"OneUpEmbedWacPassClientId",function(){return ms});n.d(t,"OneUpEmbedWacPassDocClickTime",function(){return gs});n.d(t,"OneUpEmbedWacPassUih",function(){return ys});n.d(t,"OneUpEmbedWacPassEmbeddingPageParam",function(){return bs});n.d(t,"EnablePdfCoversionForAllTypes",function(){return ws});n.d(t,"DefaultPdfToNative",function(){return Es});n.d(t,"UsePdfViewerToPreviewTif",function(){return Ss});n.d(t,"AllowVideoDiagnostics",function(){return xs});n.d(t,"EnableHlsPretranscode",function(){return Ts});n.d(t,"UseAltTranscodeForDashManifests",function(){return Ns});n.d(t,"UseFlashVideoPlayerFromManifest",function(){return Cs});n.d(t,"VideoEndOfStream",function(){return ks});n.d(t,"VideoModeCascadeTimeout",function(){return Ls});n.d(t,"VideoModePreferStreamError",function(){return As});n.d(t,"VideoAttemptFfmpegToMediaFoundationFallback",function(){return Os});n.d(t,"VideoMoreAgressiveTokenRefresh",function(){return Ms});n.d(t,"VideoForcedTokenRefresh",function(){return _s});n.d(t,"VideoTokenFromGraph",function(){return Ds});n.d(t,"VideoSetQueryParamForNative",function(){return Ps});n.d(t,"VideoSetCorrelationIdAsQSP",function(){return Hs});n.d(t,"VideoSetPsiAndCcatQspToManifestKillSwitch",function(){return Bs});n.d(t,"VideoCorsErrorTest",function(){return js});n.d(t,"VideoEnableReducedMaxRequestCount2",function(){return Fs});n.d(t,"VideoEnableReducedMaxRequestCount4",function(){return Is});n.d(t,"VideoLimitDefaultStartingQuality480p",function(){return qs});n.d(t,"UseOnePlayer",function(){return Rs});n.d(t,"UseOnePlayerForEmbedMicroservice",function(){return Us});n.d(t,"EnableOnePlayerForGovCloud",function(){return zs});n.d(t,"EnableOnePlayerForGovCloudForEmbedMicroservice",function(){return Ws});n.d(t,"EnableFluentMtcPreloadNativeKillswitch",function(){return Xs});n.d(t,"EnableOnePlayerVideoDataSourceVROOMTokenKillswitch",function(){return Vs});n.d(t,"EnableOnePlayerReturnVideoElementToHostKillswitch",function(){return $s});n.d(t,"EnableHostPageContextForOnePlayerEmbed",function(){return Js});n.d(t,"EnableOnePlayerDeveloperToolsPanel",function(){return Ks});n.d(t,"EnableOnePlayerFluentMtcOptimization",function(){return Qs});n.d(t,"EnableRenderListDataAsStreamCallForTeams",function(){return Gs});n.d(t,"VideoABRQualityThrottle240",function(){return Ys});n.d(t,"VideoABRQualityThrottle360",function(){return Zs});n.d(t,"VideoABRQualityThrottle480",function(){return eo});n.d(t,"VideoABRQualityThrottle720",function(){return to});n.d(t,"VideoUseCdn",function(){return no});n.d(t,"VideoEnableEncryption",function(){return ro});n.d(t,"VideoUseCdnForHls",function(){return io});n.d(t,"VideoEnableEncryptionForHls",function(){return so});n.d(t,"VideoDecryptionErrorsInvestigation",function(){return oo});n.d(t,"VideoSessionHeartbeat",function(){return uo});n.d(t,"VideoEnableMaxRetryCheckOnRequestManagerKillSwitch",function(){return ao});n.d(t,"VideoParseResolutionFromAdaptationSetHeight",function(){return fo});n.d(t,"VideoEnableDashlingTelemetry",function(){return lo});n.d(t,"VideoEnableDashlingDecryptorV2",function(){return co});n.d(t,"VideoEnableDashlingParallelKeyCall",function(){return ho});n.d(t,"VideoEnableDashlingCdnRefIdsTelemetry",function(){return po});n.d(t,"VideoEnableDashlingTelemetryInfo",function(){return vo});n.d(t,"VideoEnableRefreshToken",function(){return mo});n.d(t,"VideoEnableForceMeta",function(){return go});n.d(t,"VideoEnableDashlingHybridPlayback",function(){return yo});n.d(t,"VideoDashlingMaxBuffer30Seconds",function(){return bo});n.d(t,"VideoDashlingMaxBuffer60Seconds",function(){return wo});n.d(t,"VideoDashlingMaxBuffer90Seconds",function(){return Eo});n.d(t,"TeamsMeetingRecordingPlayerCaptionSupport",function(){return So});n.d(t,"VideoEnableDashlingOptimizations",function(){return xo});n.d(t,"VideoRetryMetadataCallWithPlaybackAccessToken",function(){return To});n.d(t,"TeamsMeetingRecordingPrecheckForCaptionsFromMeta",function(){return No});n.d(t,"TMRMetaRedirect",function(){return Co});n.d(t,"ForceTMRToMediaFoundation",function(){return ko});n.d(t,"TMRFallbackToFFMPEG",function(){return Lo});n.d(t,"VideoIdentifyOneUpPlayerToMetaKillswitch",function(){return Ao});n.d(t,"DisableSKCompliance",function(){return Oo});n.d(t,"CallstackQueryStringParameter",function(){return Mo});n.d(t,"HlsV6Playback",function(){return _o});n.d(t,"MeTAVideoManifestQspPassthrough",function(){return Do});n.d(t,"DashlingRequestTimeout15s",function(){return Po});n.d(t,"VideoRequestStaggerMultiple1",function(){return Ho});n.d(t,"EnableDASHOnSafari",function(){return Bo});n.d(t,"EnableRobustLoggingForManifestRequests",function(){return jo});n.d(t,"ForceProgressivePlaybackOnDownloadAspx",function(){return Fo});n.d(t,"EnablePretranscodeSupport",function(){return Io});n.d(t,"EmbedAccessOnEmbedAspx",function(){return qo});n.d(t,"EmbedLinkSupportOnEmbedAspx",function(){return Ro});n.d(t,"ReportOneUpFileAccess",function(){return Uo});n.d(t,"RemoveOneUpSlideNavigation",function(){return zo});n.d(t,"ShowRequestAccessButton",function(){return Wo});n.d(t,"DarkBackgroundForPhotosOneUp",function(){return Xo});n.d(t,"DarkBackgroundForPhotosOneUpExperiment",function(){return Vo});n.d(t,"DarkBackgroundForPhotosOneUpExperiment_ABTrigger",function(){return $o});n.d(t,"EnableLivePhotoVideos",function(){return Jo});n.d(t,"EnableLivePhotoVideos_NativePlayback",function(){return Ko});n.d(t,"EnableLivePhotoVideosForCobUser",function(){return Qo});n.d(t,"EnableSamsungMotionPhotoVideos",function(){return Go});n.d(t,"EngagementTelemetryEnhancement",function(){return Yo});n.d(t,"EnableAudioEnhancement",function(){return Zo});n.d(t,"IncludeAudioEnhancementInVideoManifestFile",function(){return eu});n.d(t,"VideoAutoplayBehaviorUpdate",function(){return tu});n.d(t,"OnePlayerVideoAutoplayBehaviorUpdate",function(){return nu});n.d(t,"OnePlayerVideoDeferAllowedUpdate",function(){return ru});n.d(t,"EnableEditUtilityControlIE",function(){return iu});n.d(t,"EnableEditUtilityControlSafari",function(){return su});n.d(t,"EnableEditUtilityControlMobile",function(){return ou});n.d(t,"EnableEditUtilityControl",function(){return uu});n.d(t,"EnableEditControlTeachingBubble",function(){return au});n.d(t,"EnableEditControlExperimentAA",function(){return fu});n.d(t,"EnableEditControlExperimentAB",function(){return lu});n.d(t,"EnableEditControlAdjustments",function(){return cu});n.d(t,"EnableEditControlFilters",function(){return hu});n.d(t,"EnableEditAllImageFormats",function(){return pu});n.d(t,"EnableEditControlMarkup",function(){return du});n.d(t,"EnableEditControlArrowHead",function(){return vu});n.d(t,"EnableEditPNG",function(){return mu});n.d(t,"EnableEditHEIC",function(){return gu});n.d(t,"FlushBufferredDataDuringStreamReset",function(){return yu});n.d(t,"PDFiumBasedPDFViewer",function(){return bu});n.d(t,"UseMsPdfViewer",function(){return wu});n.d(t,"EnableEditPDF",function(){return Eu});n.d(t,"EnableEmbedMsPdfViewer",function(){return Su});n.d(t,"UseMsPdfViewerForEmbedMicroservice",function(){return xu});n.d(t,"EnableEditPdfTeachingBubble",function(){return Tu});n.d(t,"UseUniversalAnnotation",function(){return Nu});n.d(t,"ERBugFixesEnabledForUniversalAnnotation",function(){return Cu});n.d(t,"UseMsPdfExtract",function(){return ku});n.d(t,"EnablePdfDownloadByRange",function(){return Lu});n.d(t,"EnablePdfFormFilling",function(){return Au});n.d(t,"PWAListsInstallPrompt",function(){return Ou});n.d(t,"PWAODInstallPrompt",function(){return Mu});n.d(t,"EnableEditSmartTemplateItemscopeAction",function(){return _u});n.d(t,"EnableCopyLinkInContentAssemblyTemplates",function(){return Du});n.d(t,"OptimizelyEnabled",function(){return Pu});n.d(t,"DisplayGuestPermittedInfoInModernHeader",function(){return Hu});n.d(t,"EnterExitTeamsFullscreen",function(){return Bu});n.d(t,"ListFormMultiColumns",function(){return ju});n.d(t,"EnableRecommendList",function(){return Fu});n.d(t,"OnePlayerEnableHlsFFMPEGKillSwitch",function(){return Iu});n.d(t,"ForceHlsForSafariOnePlayerKillswitch",function(){return qu});n.d(t,"AddCrossOriginAnonymousForProgressiveVideoKillswitch",function(){return Ru});n.d(t,"OnePlayerEmbedCrossWindowSupport",function(){return Uu});n.d(t,"OnePlayerDisableCdn",function(){return zu});n.d(t,"OnePlayerPrefetchFluentMtc",function(){return Wu});n.d(t,"OnePlayerFavorAdaptiveForLongerTMRVideo",function(){return Xu});n.d(t,"OnePlayerFavorAdaptiveForLongerNonTMRVideo",function(){return Vu});n.d(t,"OnePlayerFastNextGenEngineEnabled",function(){return $u});n.d(t,"OnePlayerFastNextGenEngineGovEnabled",function(){return Ju});n.d(t,"OnePlayerRefactoredSourceProviderEnabled",function(){return Ku});n.d(t,"OnePlayerAlwaysUseFFMPEG",function(){return Qu});n.d(t,"OnePlayerOneDsEndpointOverride",function(){return Gu});n.d(t,"OnePlayerOneDSEndpointOverrideGovClouds",function(){return Yu});n.d(t,"ODSPSidePanelRetentionChartEnabledForGCCandITAR",function(){return Zu});n.d(t,"FlushingOnlyAudioChunksDuringResettingStreams",function(){return ea});n.d(t,"CreateFromListUseSiteScriptAPI",function(){return ta});n.d(t,"LeftNavOpenInNewWindow",function(){return na});n.d(t,"EnableExpirationSectionForTMR",function(){return ra});n.d(t,"EnableCheckExpirationDateForTMR",function(){return ia});n.d(t,"CreateListFromCSV",function(){return sa});n.d(t,"CreateListFromCSVathena",function(){return oa});n.d(t,"IncludeSchemaInExportImportCSV",function(){return ua});n.d(t,"IncludeSchemaInExportImportCSVSpartanLists",function(){return aa});n.d(t,"shouldTargetWindow",function(){return fa});n.d(t,"EnableCameraHvcInStreamAspx",function(){return la});n.d(t,"EnableOneCameraInSwa",function(){return ca});n.d(t,"EnableSwaNewRecordingCommandButton",function(){return ha});n.d(t,"EnableSwaCreateUploadDestinationPicker",function(){return pa});n.d(t,"EnableSwaFileManagement",function(){return da});n.d(t,"EnableSWAUploadWithDestinationPicker",function(){return va});n.d(t,"EnableClipchampFileABug",function(){return ma});n.d(t,"EnableOpenButtonAfterSWAUpload",function(){return ga});n.d(t,"EnableOpenButtonAfterSWAMoveCopy",function(){return ya});n.d(t,"EnableTextInsteadOfFolderLinksForSwaUpload",function(){return ba});n.d(t,"EnableOpenButtonAfterSWAMoveCopyRefactor",function(){return wa});n.d(t,"EnableVideoSettingsAfterSWAUpload",function(){return Ea});n.d(t,"EnableSingleItemInNewMenuDropDown",function(){return Sa});n.d(t,"SuppressSharedRootInMoveCopyPanel",function(){return xa});n.d(t,"OnePlayerBugfixAriaDeferredLoadKillswitch",function(){return Ta});n.d(t,"AuthZenBlockDownloadPolicyBanner",function(){return Na});n.d(t,"SiteContentsLinksInSameTab",function(){return Ca});n.d(t,"ReadOnlyAccessPolicyBanner",function(){return ka});n.d(t,"DownloadDebugLogs",function(){return La});n.d(t,"ProgressiveUrlQspStreamClient",function(){return Aa});n.d(t,"VCAnalyticsMSITTestingOSDPWeb",function(){return Oa});n.d(t,"CreateConvergenceEnabled",function(){return Ma});n.d(t,"CreateConvergenceViaVroom",function(){return _a});n.d(t,"EnableStableFREforTMR",function(){return Da});n.d(t,"UseUTCTimeZoneForTMR",function(){return Pa});n.d(t,"CheckIfCodecCanBePlayedNativelyKillswitch",function(){return Ha});n.d(t,"EnableEmbedDialog",function(){return Ba});n.d(t,"EnableGraphApiGetEmbedInfo",function(){return ja});n.d(t,"SPAppBarBlockHubJoin",function(){return Fa});n.d(t,"ShareEmbedCodeInSWAEnabled",function(){return Ia});n.d(t,"OnePlayerAccurateLoadSignal",function(){return qa});n.d(t,"NeutralStreamWebAppTheme",function(){return Ra});n.d(t,"SWAAddToFavorites",function(){return Ua});n.d(t,"HideTaggingFeatures",function(){return za});n.d(t,"EnableATOForCrossStackContent",function(){return Wa});n.d(t,"EnableATOForCOBtoCOB",function(){return Xa});n.d(t,"HideShareButton",function(){return Va});n.d(t,"HideEditPhoto",function(){return $a});n.d(t,"HideEmbedButton",function(){return Ja});n.d(t,"HideAddToAlbum",function(){return Ka});n.d(t,"HideAlbumPivot",function(){return Qa});n.d(t,"ShowAlertIcon",function(){return Ga});n.d(t,"EnableDocumentDigestEmail",function(){return Ya});n.d(t,"FixODCOneUpPreview",function(){return Za});n.d(t,"MinVideoBandwithKillswitch",function(){return ef});n.d(t,"GetRequestParametersErrorForPrefetchKillswitch",function(){return tf});n.d(t,"FetchOperationErrorLogKillswitch",function(){return nf});n.d(t,"OnePlayerNextGenEngineCdnEnabled",function(){return rf});n.d(t,"Base64OnePlayerShareOptionsGenerationEnabled",function(){return sf});n.d(t,"CompleteForPromiseBeforeEcsPromiseKillswitch",function(){return of});n.d(t,"isOneplayerPlaygroundEnabled",function(){return uf});n.d(t,"isUsingServerUrlForSWADriveAccessTokens",function(){return af});n.d(t,"isAudioFilesEnabled",function(){return ff});n.d(t,"isRemoveCommandBarNewTooltipEnabled",function(){return lf});n.d(t,"enableAlbumForConvergence",function(){return cf});n.d(t,"EnableCreateAlbumFromFolder",function(){return hf});n.d(t,"enableMojForConvergence",function(){return pf});n.d(t,"isAudioFilesGovEnabled",function(){return df});n.d(t,"isWebViewEnabled",function(){return vf});n.d(t,"SpartanByDefaultWithFallback",function(){return mf});n.d(t,"VideoPage_Conf",function(){return gf});n.d(t,"VideoPage",function(){return yf});n.d(t,"EnablePreAuthEmbedLinkForImage",function(){return bf});var r=n(10),i=n(4);n.d(t,"pageContext",function(){return i.Go});n.d(t,"isOneDriveWinApp",function(){return i.Xo});n.d(t,"isSPListWebpack",function(){return i.Vo});n.d(t,"isOneDrive",function(){return i.Wo});n.d(t,"isSPOFilePickerWebPack",function(){return i.$o});n.d(t,"isODBFileBrowserWebPack",function(){return i.Ro});n.d(t,"isODBLightSpeedWebPack",function(){return i.Uo});n.d(t,"FluentVNextStyling",function(){return i.ln});n.d(t,"PowerApps",function(){return i.Qr});n.d(t,"AthenaPlaceholdersUX",function(){return i.m});n.d(t,"AadTokenProviderPopupFlow",function(){return i.t});n.d(t,"EnableFavorites",function(){return i.Te});n.d(t,"UseSpartanSWM",function(){return i.Co});n.d(t,"ShowPeopleAndMeetingsInLeftNav",function(){return i.Qi});n.d(t,"UseOdbHomeAsDefault",function(){return i.yo});n.d(t,"EnableSpartanMeetingsView",function(){return i.Ot});n.d(t,"EnableSpartanPeopleView",function(){return i.Mt});n.d(t,"EnableNonFileInODB",function(){return i.Ve});n.d(t,"EnableOD3SuiteNav",function(){return i.Ke});n.d(t,"OD3Styles",function(){return i.Lr});n.d(t,"isODCLightspeedManifest",function(){return i.zo});n.d(t,"IsODBWebApp",function(){return i.Pn});n.d(t,"AddTelemetryHeaders",function(){return i.s});n.d(t,"ApprovalFlows",function(){return i.v});n.d(t,"BypassOAuthForCrossGeoCallsInFilePicker",function(){return i.y});n.d(t,"CSIOdbScopedSearch",function(){return i.C});n.d(t,"CSIOdbScopeControl",function(){return i.N});n.d(t,"CSISpoScopeControl",function(){return i.O});n.d(t,"CSISPODisableUpscopeSearch",function(){return i.k});n.d(t,"CSIOdbNotMyFiles3S",function(){return i.T});n.d(t,"CSISearchQueryAlteration",function(){return i.L});n.d(t,"CSISearchResultUnifiedModifiedTime",function(){return i.A});n.d(t,"CSIMetadataSearchInSPLists",function(){return i.S});n.d(t,"CSIStronglyTypedManagedProperties",function(){return i.M});n.d(t,"CSIMetadataSearchNPS",function(){return i.x});n.d(t,"CSIContentQueryDiscoveryFRE",function(){return i.w});n.d(t,"ChangeFlowToAutomate",function(){return i._});n.d(t,"ClientCustomActions",function(){return i.H});n.d(t,"PropertiesFormConnector",function(){return i.si});n.d(t,"CreateMMDColumnField",function(){return i.V});n.d(t,"CreateLookupColumnField",function(){return i.X});n.d(t,"CreateColumnNewOrder",function(){return i.z});n.d(t,"ContentCenterEnabled",function(){return i.q});n.d(t,"ConsumeExposedDefaultClickControl",function(){return i.j});n.d(t,"DeferredPageContextInfo",function(){return i.Q});n.d(t,"DisableDomainLowering",function(){return i.G});n.d(t,"DisablePopularAroundYou",function(){return i.ee});n.d(t,"DisableServiceWorkerPWA",function(){return i.ne});n.d(t,"DocumentSetsModernView",function(){return i.ae});n.d(t,"DynamicFlowDates",function(){return i.le});n.d(t,"EnableActionMemoization",function(){return i.ge});n.d(t,"EnableAccountSwitching",function(){return i.me});n.d(t,"EnableCommonServiceWorker",function(){return i.be});n.d(t,"EnableFoldersDocumentsGroupings",function(){return i._e});n.d(t,"EnableMediaTilesInDocumentsGroup",function(){return i.qe});n.d(t,"EnableODBServiceWorker",function(){return i.Qe});n.d(t,"EnableOdbServiceWorkerExperiment",function(){return i.et});n.d(t,"EnableOneUpDataManager",function(){return i.st});n.d(t,"EnableODCServiceWorker",function(){return i.Ye});n.d(t,"EnableServiceWorkerPrefetch",function(){return i.Tt});n.d(t,"EnableLastWeekPreviousYearsExp",function(){return i.je});n.d(t,"EnableMonthRecapGroupHeaderExp",function(){return i.Re});n.d(t,"EnableOneUpInSwmPwa",function(){return i.ot});n.d(t,"EnablePowerPointWrsPreview",function(){return i.dt});n.d(t,"DebugWindow",function(){return i.K});n.d(t,"EnableOpenInImmersiveReader",function(){return i.ut});n.d(t,"EnableItemsScopeOpenInStream",function(){return i.Be});n.d(t,"EnableReferrerLoggingOnPageViewEvents",function(){return i.bt});n.d(t,"EnableQuickAccess",function(){return i.mt});n.d(t,"EnablePinToQuickAccess",function(){return i.ht});n.d(t,"EnableQuickAccessDragAndDrop",function(){return i.gt});n.d(t,"EnableInLineFolderSVGs",function(){return i.He});n.d(t,"EnableColoredFolders",function(){return i.ye});n.d(t,"EnableRecentWithGraphAddon",function(){return i.yt});n.d(t,"DisableWinAppPhotosPivot",function(){return i.se});n.d(t,"ExecuteFREAfterFCI",function(){return i.Yt});n.d(t,"ShimSpartanOneUpInFavorites",function(){return i.Ui});n.d(t,"ShimSpartanOneUpInSWM",function(){return i.zi});n.d(t,"EnablingSpartanInFileBrowser",function(){return i.Gt});n.d(t,"EnableSpartanInWebViewList",function(){return i.At});n.d(t,"EnableSpartanSharedWithMeToast",function(){return i.Dt});n.d(t,"SpartanListInNewTab",function(){return i.ts});n.d(t,"UseFileBrowserForSitesInODB",function(){return i.js});n.d(t,"UseSystemUserKeyNullForMondoPrefetch",function(){return i.ko});n.d(t,"UseFileBrowserLayerProjectionForSitesInODB",function(){return i.Fs});n.d(t,"UseCrossSiteFileBrowserForSitesInODB",function(){return i.Hs});n.d(t,"AlwaysUseOneDriveNavForUser",function(){return i.h});n.d(t,"EnableSiteRootBreadcrumbIcons",function(){return i.kt});n.d(t,"EnablePhoneLinkInFilePicker",function(){return i.at});n.d(t,"EnableSpartanRecentFilePicker",function(){return i._t});n.d(t,"EnableTilesListMediaGroupings",function(){return i.Ft});n.d(t,"EnableTitleInImmersiveReader",function(){return i.qt});n.d(t,"EnableTimeToFileItemEngagement",function(){return i.It});n.d(t,"AddColumnsToViewInSpListAndSpartan",function(){return i.r});n.d(t,"ForceEnableCrossOriginCommands",function(){return i.pn});n.d(t,"ForceSwitchToDogFoodForPhoneLink",function(){return i.mn});n.d(t,"ForceSwitchToBetaForPhoneLink",function(){return i.vn});n.d(t,"ForceSwitchToProductionForPhoneLink",function(){return i.gn});n.d(t,"ForceUseMockAPIForPhoneLink",function(){return i.yn});n.d(t,"ForceUseV2HVCForPhoneLink",function(){return i.bn});n.d(t,"EnableFeedbackForPhoneLink",function(){return i.Ne});n.d(t,"EnableTrendingSignalInItemsScope",function(){return i.Rt});n.d(t,"EnableWordWrsPreview",function(){return i.$t});n.d(t,"EnableWiderShareDialog",function(){return i.Vt});n.d(t,"UsePerManifestPrefetchForTeamChannelFilter",function(){return i.Eo});n.d(t,"FileRequestUI",function(){return i.on});n.d(t,"FileRequestInSharePoint",function(){return i.sn});n.d(t,"FlowForLibraries",function(){return i.fn});n.d(t,"ForceEnableAria",function(){return i.hn});n.d(t,"FrankieBasedFrequentSites",function(){return i.En});n.d(t,"HideExploreYourPhotosCarousel",function(){return i.Ln});n.d(t,"HideLanguagePickerForAnonymous",function(){return i.An});n.d(t,"IntegrateCommandOnLists",function(){return i.Dn});n.d(t,"ItemActivityColumn",function(){return i.Hn});n.d(t,"ItemCachePerformanceTimings",function(){return i.Bn});n.d(t,"ItemsScopeAutoActionKillSwitch",function(){return i.jn});n.d(t,"EnableFixCurrentItemUrlAutoAction",function(){return i.Oe});n.d(t,"LightspeedListViewDataPrefetch",function(){return i.Wn});n.d(t,"LightspeedQuotaPrefetch",function(){return i.Xn});n.d(t,"PreferIsMySiteOwner",function(){return i.Zr});n.d(t,"ListDataRenderOptionChange",function(){return i.Kn});n.d(t,"LocationHoverCard",function(){return i.rr});n.d(t,"LoadFloodgateOnDemand",function(){return i.nr});n.d(t,"ModernizeAddColumn",function(){return i.ar});n.d(t,"O365ShellModuleJSClient",function(){return i.Tr});n.d(t,"ODBLeftNavPins",function(){return i.Ar});n.d(t,"ODBLightSpeedSpartanLeftNav",function(){return i.Or});n.d(t,"RecommendedInOdb",function(){return i.ai});n.d(t,"OD3CommandBar",function(){return i.Nr});n.d(t,"OD3LeftNav",function(){return i.kr});n.d(t,"OD3Fluent2TokenSupport",function(){return i.Cr});n.d(t,"OdbLightspeed",function(){return i.Hr});n.d(t,"OdbLightSpeedBasic",function(){return i.Pr});n.d(t,"OdcLightspeed",function(){return i.Br});n.d(t,"SPPagesSuiteSearchBox",function(){return i.Li});n.d(t,"CSIGuestSuiteNavSearchBox",function(){return i.E});n.d(t,"OneDriveLightSpeedPltBlock",function(){return i.Fr});n.d(t,"ShowPerfButton",function(){return i.Gi});n.d(t,"InitializeLoggingWithOAuthSupport",function(){return i.Mn});n.d(t,"UseGetDriveQuotaKey",function(){return i.Rs});n.d(t,"RefreshOnPreviewClose",function(){return i.fi});n.d(t,"PeopleCardsOnLoki",function(){return i.qr});n.d(t,"PeopleCardsReactComponent",function(){return i.Rr});n.d(t,"PowerAppListForms",function(){return i.Kr});n.d(t,"PreviewAIBuilder",function(){return i.ei});n.d(t,"PreviewUnknownFileTypes",function(){return i.ti});n.d(t,"ProcessSimple",function(){return i.ni});n.d(t,"EnableLightspeedManifestForODBNonPages",function(){return i.Fe});n.d(t,"RenderBypassDefaultClickAction",function(){return i.hi});n.d(t,"EnableSubstrateSearchResults",function(){return i.Bt});n.d(t,"RecentFileHoverCard",function(){return i.oi});n.d(t,"RenderBypassHeroCommands",function(){return i.di});n.d(t,"RenderBypassSignals",function(){return i.mi});n.d(t,"RenderBypassDragDrop",function(){return i.pi});n.d(t,"RenderBypassPersonaCard",function(){return i.vi});n.d(t,"RenderBypassStickyHeaders",function(){return i.gi});n.d(t,"RenderBypassSuiteNavFull",function(){return i.bi});n.d(t,"RenderBypassSuiteNavDeferred",function(){return i.yi});n.d(t,"StopAtAppStart",function(){return i.is});n.d(t,"RequestDatesInUtc",function(){return i.Ei});n.d(t,"RequestSignOffSwitch",function(){return i.xi});n.d(t,"RulesPanel",function(){return i.Ni});n.d(t,"RulesOnLibrary",function(){return i.Ti});n.d(t,"SPOFlowIntegration",function(){return i.Ci});n.d(t,"SearchWithShortcutSupport",function(){return i.Pi});n.d(t,"SearchItemsScope",function(){return i._i});n.d(t,"SearchItemsScopeInPicker",function(){return i.Di});n.d(t,"SPSearchItemsScope",function(){return i.Ai});n.d(t,"SetDetailsLayoutAsDefault",function(){return i.Hi});n.d(t,"SetDetailsLayoutAsDefaultExpV3",function(){return i.Bi});n.d(t,"ShareToTeams",function(){return i.Ii});n.d(t,"SharedWithMeFileHoverCard",function(){return i.Ri});n.d(t,"UseItemsScopeUpload",function(){return i.lo});n.d(t,"ShareDropdownCommand",function(){return i.Fi});n.d(t,"DisableMakeThisATabUntilAuthSortsOut",function(){return i.Y});n.d(t,"ShowItemsScopeODBMoreSitesPage",function(){return i.Ki});n.d(t,"Spotlight",function(){return i.rs});n.d(t,"UnifiedAutomateIntegrateMenu",function(){return i.xs});n.d(t,"UnifiedSuiteNavBootstrapperLoadingFlow",function(){return i.Ts});n.d(t,"UnifiedSuiteNavComponent",function(){return i.Ns});n.d(t,"Use3SFileSuggestion",function(){return i.Ps});n.d(t,"UseSelfIssuedTokenForSPOWebAuth",function(){return i.So});n.d(t,"UseSelfIssuedTokenInZipDownload",function(){return i.xo});n.d(t,"UseIdentityAuthForVroom",function(){return i.Us});n.d(t,"UseItemsScopeDefaultClickHandlers",function(){return i.Ws});n.d(t,"DisableSilentAuthFrameForUnauthUsers",function(){return i.re});n.d(t,"UseItemsScopeInAnomalies",function(){return i.Ys});n.d(t,"UseItemsScopeInAlbums",function(){return i.Xs});n.d(t,"UseFilePicker80ForSPOMoveCopy",function(){return i.Is});n.d(t,"UseItemsScopeVroomMoveCopy",function(){return i.co});n.d(t,"UseItemsScopeInAllPhotosEnableIE",function(){return i.$s});n.d(t,"UseItemsScopeInAllPhotosEnableMobile",function(){return i.Ks});n.d(t,"UseItemsScopeInAllPhotosEnableSafari",function(){return i.Qs});n.d(t,"UseItemsScopeInAllPhotos",function(){return i.Vs});n.d(t,"UseItemsScopeInAllTags",function(){return i.Gs});n.d(t,"UseItemsScopeInOneDrive",function(){return i.eo});n.d(t,"UseItemsScopeInPlaces",function(){return i.to});n.d(t,"UseItemsScopeInShared",function(){return i.ro});n.d(t,"UseItemsScopeInSingleAlbum",function(){return i.io});n.d(t,"UseItemsScopeInSingleTag",function(){return i.oo});n.d(t,"UseItemsScopeInSinglePlace",function(){return i.so});n.d(t,"UseItemsScopeInOnThisDay",function(){return i.Zs});n.d(t,"UseItemsScopeInAllPhotosEnableInFilePicker",function(){return i.Js});n.d(t,"UseItemsScopeInSitesForODB",function(){return i.uo});n.d(t,"UseItemsScopeInTeamSites",function(){return i.fo});n.d(t,"UseItemsScopeInSuiteNav",function(){return i.ao});n.d(t,"UseItemsScopeInRestoreOperations",function(){return i.no});n.d(t,"UseLargeDriveItemSetPageSize",function(){return i.ho});n.d(t,"UseNewShareDialogForWinApp",function(){return i.mo});n.d(t,"WACHostMoveToFolder",function(){return i.Fo});n.d(t,"WACHostCommonFilePicker",function(){return i.jo});n.d(t,"UseOneUpTextEditor",function(){return i.wo});n.d(t,"EnableFreeTrialForUSQRollout",function(){return i.De});n.d(t,"EnableUSQPreferHeaderApiCall",function(){return i.zt});n.d(t,"EnableUSQOnWeb",function(){return i.Ut});n.d(t,"DisableManageStorageForUSQ",function(){return i.Z});n.d(t,"EnableLoginTakeoverForUSQ",function(){return i.Ie});n.d(t,"ShowPwaInstallDialogInUwpApp",function(){return i.Yi});n.d(t,"ReplaceSourcedocPathToGuid",function(){return i.wi});n.d(t,"UpdateUIConvergenceEnbaled",function(){return i.Ds});n.d(t,"ShouldShimShareCommand",function(){return i.Xi});n.d(t,"ShouldShimVaultSideCommand",function(){return i.Vi});n.d(t,"LeanItemsViewWave1",function(){return i.zn});n.d(t,"LeanItemsViewDnd2Lists",function(){return i.Un});n.d(t,"UserExpirationStrings",function(){return i.Bo});n.d(t,"ODBSubstrateSearchQueryV2",function(){return i.Mr});n.d(t,"ODBTelemetryWebWorker",function(){return i._r});n.d(t,"EnableODCWebWorker",function(){return i.Ze});n.d(t,"EnableODCCustomerPromiseWebWorker",function(){return i.Ge});n.d(t,"Enable1DSTelemetryForOneDrive",function(){return i.pe});n.d(t,"SPOODBWebUploadChecksumFrontEnd",function(){return i.ki});n.d(t,"EnableStreamUploadHashing",function(){return i.Ht});n.d(t,"UseVroomInItemsScopeAllPhotosOtdExp",function(){return i._o});n.d(t,"UseVroomInItemsScopeAllPhotos",function(){return i.Mo});n.d(t,"AllowTestPhotoNotification",function(){return i.f});n.d(t,"UseSkipTokenForVroom",function(){return i.No});n.d(t,"UseVroomInItemsScopeSingleTag",function(){return i.Po});n.d(t,"UseVroomInItemsScopeSinglePlace",function(){return i.Do});n.d(t,"EnablePhotosCarouselOnFile",function(){return i.lt});n.d(t,"EnablePhotosCarouselOnFileExp",function(){return i.ct});n.d(t,"EnablePhotoStreamProvisionCheck",function(){return i.ft});n.d(t,"EnableOdcSyncCommand",function(){return i.tt});n.d(t,"EnableOdcSyncCommandExp",function(){return i.nt});n.d(t,"LargestFilesImprovement",function(){return i.qn});n.d(t,"LargestFilesImprovementExp",function(){return i.Rn});n.d(t,"EnableOdcSyncInLeftNav",function(){return i.rt});n.d(t,"A2ODMoveShortcuts",function(){return i.e});n.d(t,"AddToOneDriveMountPointRenderOption",function(){return i.o});n.d(t,"SearchAppClientFlight",function(){return i.Oi});n.d(t,"EnableSharePointItemMapping",function(){return i.Nt});n.d(t,"PowerBIPanel",function(){return i.Yr});n.d(t,"ODCWebAppManifest",function(){return i.Dr});n.d(t,"PersistedFilterPill",function(){return i.Ur});n.d(t,"UpdateOdcUpgradeOptionApiForConvergence",function(){return i.Os});n.d(t,"UpdateOdcStorageInfoApiForConvergence",function(){return i.As});n.d(t,"UpdateOdcPhotoApiForConvergence",function(){return i.Ls});n.d(t,"UpdateOdcVaultApiForConvergence",function(){return i.Ms});n.d(t,"ApplyItemsScopeToRecycleBin",function(){return i.d});n.d(t,"NoFreeUpSpaceSoftLockedBannerExp",function(){return i.br});n.d(t,"EnableNoFreeUpSpaceSoftLockedBanner",function(){return i.Xe});n.d(t,"NewOverquotaExperienceExp",function(){return i.gr});n.d(t,"EnabledNewOverquotaExperience",function(){return i.Qt});n.d(t,"NewHighquotaExperienceExp",function(){return i.mr});n.d(t,"EnabledFreeTrialBanner",function(){return i.Jt});n.d(t,"FreeTrialBannerExp",function(){return i.Sn});n.d(t,"EnabledNewHighquotaExperience",function(){return i.Kt});n.d(t,"FreeTrialInPremiumUpsell",function(){return i.xn});n.d(t,"FreeTrialInPremiumUpsellExp",function(){return i.Tn});n.d(t,"EnableWXPOverQuotaUpsellExp",function(){return i.Xt});n.d(t,"EnableWXPOverQuotaUpsell",function(){return i.Wt});n.d(t,"EnableFloodgate",function(){return i.Me});n.d(t,"NPSCampaignProd",function(){return i.pr});n.d(t,"NPSCampaignDogfood",function(){return i.cr});n.d(t,"NPSCampaignForceNomination",function(){return i.hr});n.d(t,"NPSSuiteSurvey",function(){return i.dr});n.d(t,"AllPhotosFpsCampaign",function(){return i.a});n.d(t,"FPSMoveCopy",function(){return i.Zt});n.d(t,"NLQSSurvey",function(){return i.lr});n.d(t,"AlwaysUseMondoPrefetch",function(){return i.c});n.d(t,"UseWebAbsoluteUrlInSPSitesListsData",function(){return i.Ho});n.d(t,"ListThumbnailThrottling",function(){return i.Gn});n.d(t,"ListThumbnailVideoThrottling",function(){return i.Yn});n.d(t,"FormatCalendarView",function(){return i.wn});n.d(t,"UnscheduledPaneInModernCalendar",function(){return i.ks});n.d(t,"NewSharedLibrariesPage",function(){return i.yr});n.d(t,"FiltersInODB",function(){return i.un});n.d(t,"UseMicroServiceForSitesLists",function(){return i.po});n.d(t,"OdcSuiteNavSearchBox",function(){return i.jr});n.d(t,"SearchInFilePicker",function(){return i.Mi});n.d(t,"EnableSearchInFilePickerHosts",function(){return i.xt});n.d(t,"HideCreateSite",function(){return i.kn});n.d(t,"ListsHomeGoMobile",function(){return i.er});n.d(t,"ListsHomeFirstRun",function(){return i.Zn});n.d(t,"FreemiumListsBanner",function(){return i.Nn});n.d(t,"AthenaTryPreviewDialog",function(){return i.g});n.d(t,"ListsHomeOnboardingExperience",function(){return i.tr});n.d(t,"UseDialogForDocLibCreate",function(){return i.Bs});n.d(t,"UseSensitivityLabelChanges",function(){return i.To});n.d(t,"StoreViewParamsInSubEntityId",function(){return i.ss});n.d(t,"RemoveMobileUpsellBanner",function(){return i.li});n.d(t,"UseOnDemandKnockoutItems",function(){return i.bo});n.d(t,"MoveTransitionResourcesToKOResourceScope",function(){return i.fr});n.d(t,"ClipchampAppEnabled",function(){return i.B});n.d(t,"UseItemsScopeDefaultClickForSpartanList",function(){return i.zs});n.d(t,"EnablePresenceHeaderItemScope",function(){return i.vt});n.d(t,"TeamsIAInSharepoint",function(){return i.ws});n.d(t,"ChannelListLite",function(){return i.D});n.d(t,"RemoveSharedWithUs",function(){return i.ci});n.d(t,"SharedChannelAwareTeamsApis",function(){return i.qi});n.d(t,"ListCommandBarCustomizationFeature",function(){return i.Jn});n.d(t,"NucleusDataSyncListsFeature",function(){return i.wr});n.d(t,"SyntexAIBHybridModelFlight",function(){return i.us});n.d(t,"SyntexModelSiteScopeEnabled",function(){return i.ls});n.d(t,"NucleusPreviewAvailable",function(){return i.Sr});n.d(t,"NucleusMySiteDiscoveryFeature",function(){return i.Er});n.d(t,"NucleusSyncIssuesUX",function(){return i.xr});n.d(t,"UniversalPrintEnabled",function(){return i.Cs});n.d(t,"FileBrowserAppCachingInTeams",function(){return i.tn});n.d(t,"CreateListFromTemplateFPS",function(){return i.W});n.d(t,"EnableTeamsFileHandlerOpenDefaultClick",function(){return i.jt});n.d(t,"EditSchemaInTeamsFileBrowser",function(){return i.he});n.d(t,"SyntexFileInspectorPanel",function(){return i.fs});n.d(t,"SyntexCopilotODB",function(){return i.as});n.d(t,"EditMetadataInTeamsFileBrowser",function(){return i.ce});n.d(t,"AdvanceCommandsInTeamsFileBrowser",function(){return i.u});n.d(t,"EnableSpfxInTeamsFileBrowser",function(){return i.Pt});n.d(t,"RequestSPFXFrameworkInfoInListPrefetch",function(){return i.Si});n.d(t,"ShadowGraphQLRequest",function(){return i.ji});n.d(t,"GraphQLMismatchLogging",function(){return i.Cn});n.d(t,"ShowExportToPowerBI",function(){return i.Ji});n.d(t,"EnableFilePickerPhotosPivot",function(){return i.ke});n.d(t,"EnableFilePickerSharedPivot",function(){return i.Le});n.d(t,"ItemsScopePureReactDragDrop",function(){return i.Fn});n.d(t,"ForceEnableFilePickerYammerPivot",function(){return i.dn});n.d(t,"EnableMoveCopyToCloudStorageProviders",function(){return i.Ue});n.d(t,"Enable3PFeatureInODBFileBrowser",function(){return i.de});n.d(t,"Enable3PSubFeaturesInODBFileBrowser",function(){return i.ve});n.d(t,"EnableSWMViewsInTeams",function(){return i.St});n.d(t,"EnableFromALinkInFilePicker",function(){return i.Pe});n.d(t,"MergeBrowserOptionsFromPostBody",function(){return i.sr});n.d(t,"MergePickerOptionsFromPostBody",function(){return i.or});n.d(t,"DsapiMemberGroupsInFilesIA",function(){return i.fe});n.d(t,"EnableSpartanDataPrefetchInTeams",function(){return i.Lt});n.d(t,"ShowAddCloudStorageCommand",function(){return i.$i});n.d(t,"ShowTeamsAddCloudStorageCommand",function(){return i.Zi});n.d(t,"TeamsDeeplinkGetChannels",function(){return i.hs});n.d(t,"ListFiltersHeader",function(){return i.Qn});n.d(t,"SpartanPersistedFilterPills",function(){return i.ns});n.d(t,"ProgressToastsNotifications",function(){return i.ii});n.d(t,"OverridePBIHost",function(){return i.Ir});n.d(t,"UseUpdatedPBIApiUrl",function(){return i.Oo});n.d(t,"LogErrorInPrefetchListData",function(){return i.ir});n.d(t,"SuiteNavNotFixedHeight",function(){return i.os});n.d(t,"TemplatizationCustomerPromiseKSActivated",function(){return i.Ss});n.d(t,"DocumentGenerationCPKSActivated",function(){return i.ue});n.d(t,"FileHandlerProxyManifest",function(){return i.nn});n.d(t,"FileHandlerProxyOnWeb",function(){return i.rn});n.d(t,"CAAEAllowDotxFormat",function(){return i.b});n.d(t,"ContentAssemblyInTeamsFileBrowser",function(){return i.I});n.d(t,"PlaceholdersToColumns",function(){return i.zr});n.d(t,"ContentAssemblyCoPilot",function(){return i.F});n.d(t,"ContractLibForCC",function(){return i.U});n.d(t,"UseTokenCacheForOAuth",function(){return i.Lo});n.d(t,"EnableCooldownAfterAuthFlow",function(){return i.Ee});n.d(t,"UseNewShareDialog",function(){return i.vo});n.d(t,"EnableMsaOauthErrorRedirect",function(){return i.ze});n.d(t,"MissingMetadataMessageBar",function(){return i.ur});n.d(t,"TeamsFileBrowserEnableCookieRefresh",function(){return i.ps});n.d(t,"TeamsFileBrowserUseTokensForCrossDomainCalls",function(){return i.bs});n.d(t,"TeamsFileBrowserUseTokensForAllCalls",function(){return i.ys});n.d(t,"TeamsFileBrowserUseTokenForSubstrateFromTeams",function(){return i.gs});n.d(t,"TeamsFileBrowserUseTokenForGraphFromTeams",function(){return i.ms});n.d(t,"EnableFilePickerOrganizationAssets",function(){return i.Ce});n.d(t,"EnableFilePickerSitePivot",function(){return i.Ae});n.d(t,"TeamsFileBrowserUseOBOTokens",function(){return i.vs});n.d(t,"TeamsFileBrowserPrefetchPageOnCookieSet",function(){return i.ds});n.d(t,"FlushLoggingBeforeCrossWindowMessaging",function(){return i.cn});n.d(t,"EnableDragDropHoverOpen",function(){return i.xe});n.d(t,"RecentVroom21Takeover",function(){return i.ui});n.d(t,"EnableDragDropCopy",function(){return i.Se});n.d(t,"EnableSPListLightspeedForRestore",function(){return i.Et});n.d(t,"ChannelSiteHeaderUpdate",function(){return i.P});n.d(t,"EnableCookiesForGraphAnalyticsRequests",function(){return i.we});n.d(t,"DisableSourceInvalidationOnCopy",function(){return i.ie});n.d(t,"PlaylistPreview",function(){return i.Wr});n.d(t,"PlaylistPreviewV2",function(){return i.Xr});n.d(t,"PlaylistPreviewV3",function(){return i.Vr});n.d(t,"PlaylistPreviewV4",function(){return i.$r});n.d(t,"PlaylistPreviewV5",function(){return i.Jr});n.d(t,"AddBookListTemplateFlight",function(){return i.n});n.d(t,"ApartmentHuntingTemplateFlight",function(){return i.p});n.d(t,"JobApplicationTrackerTemplateFlight",function(){return i.In});n.d(t,"ProductSupportTemplateFlight",function(){return i.ri});n.d(t,"UpdateTemplateThumbnailsFlight",function(){return i._s});n.d(t,"EnablePowerBIIngegration",function(){return i.pt});n.d(t,"TeamChannelFolder",function(){return i.cs});n.d(t,"UseNewShortcutTagIcon",function(){return i.go});n.d(t,"ShortcutLink",function(){return i.Wi});n.d(t,"EnableShortcutSourceInfoSection",function(){return i.Ct});n.d(t,"ContentCenterModelRename",function(){return i.R});n.d(t,"UseTsQuery",function(){return i.Ao});n.d(t,"SpListNext",function(){return i.es});n.d(t,"PowerAppsCustomizeFormsCommandListsAllItems",function(){return i.Gr});n.d(t,"ListAllItemsSpartanListView",function(){return i.$n});n.d(t,"FixRumOneScenarioIdForOneUp",function(){return i.an});n.d(t,"DisableScrollInLightspeedPhotoViews",function(){return i.te});n.d(t,"CurrentItemUsingItemSelectionHelper",function(){return i.J});n.d(t,"CurrentItemInAddToAlbumExecutor",function(){return i.$});n.d(t,"EnableNotificationBannerInLightspeed",function(){return i.$e});n.d(t,"LightspeedUpsellPrefetch",function(){return i.Vn});n.d(t,"AllowTryNewFeatureEnabledFeatures",function(){return i.l});n.d(t,"tryNewFeatureUrlQueryKey",function(){return i.Yo});n.d(t,"UseFilePicker80ForSPOMoveCopyExp",function(){return i.qs});n.d(t,"DisplayActivitiesInODBUIPlt",function(){return i.oe});n.d(t,"isTryNewFeatureEnabled",function(){return i.Ko});n.d(t,"isWinAppVersionCompatible",function(){return i.Qo});n.d(t,"isServiceConfigSettingEnabled",function(){return i.Jo});n.d(t,"getServiceConfigSetting",function(){return i.Io});n.d(t,"isFeatureEnabled",function(){return i.qo});n.d(t,"NavigationSwitcher",function(){return i.vr});n.d(t,"HoverCardInTeamsFileBrowser",function(){return i.On});n.d(t,"IntegrateCommandInTeamsFileBrowser",function(){return i._n});n.d(t,"EnableOfflineAriaTelemetryCache",function(){return i.it});n.d(t,"EnableNewStreamWebAppInStreamAspx",function(){return i.We});n.d(t,"AddDeleteListToSettingsFlight",function(){return i.i});n.d(t,"EnableRequestFilesLink",function(){return i.wt});n.d(t,"TeamsLPC",function(){return i.Es});n.d(t,"EnableNucleusForItemScopeListPrefetch",function(){return i.Je});var s=n(489);n.d(t,"UseADALForSPOWebAuth",function(){return s.n});n.d(t,"ShareDialogTestEndpoint",function(){return s.t});n.d(t,"ListShareMode",function(){return s.e});var o=window._spPageContextInfo,u={Fallback:!0},a={},f={ODB:1616},l={ODB:60640},c={ODB:60362},h={ODB:473},p={ODC:"ODCRequestAccess"},d={ODC:"HolidayPositioningFRE"},v={ODC:"Onboarding50GBStandAlonePlanRamp"},m={ODC:"RecurringFrePositioningExp"},g={ODC:"EnableRecurringFrePositioning"},y={ODC:"OneHunderedGBFreDimeEnabled"},b={ODC:"OneHunderedGBFreDimeExp"},w={ODC:"OneHunderedGBFreFreeTrialEnabled"},E={ODC:"OneHunderedGBFreFreeTrialExp"},S={ODC:"OneHunderedGBFre100DefaultDimeEnabled"},x={ODC:"OneHunderedGBFre100DefaultDimeExp"},T={ODC:"EnableHundredGBDIME"},N={ODC:"HundredGBDIMEExperiment"},C={ODC:"UploadQuotaWarningDialogExp"},k={ODC:"UploadQuotaWarningDialogEnabled"},L={ODC:"100GBFreeTrialDialogExp"},A={ODC:"Enable100GBFreeTrialDialog"},O={ODC:"EnableM365Basic"},M={ODB:!0},_={ODC:"EnableMsJs"},D={ODC:!0},P={ODB:608},H={ODB:833,ODC:"EnableTeachingBubbles"},B={ODC:"EnableCoachmarks"},j={ODC:"isAddToOneDriveBubbleEnabled"},F={ODC:"PhotosSearchBubble"},I={ODB:539,ODC:!0},q={ODB:499},R={ODC:"EnableNotificationSubscriptions"},U={ODC:"ShowTagCountInPhotos"},z={ODC:"CollabAlbumsEnabled"},W={ODC:"UseVroomGetPermissions"},X={ODB:561},V={ODB:1171},$={ODB:564},J={ODC:"PromotedPhotosContentEnabled"},K={ODC:"OneRmO365UpsellEnabled"},Q={ODC:"EnableLoadDimeJs"},G={ODC:"EnableDimeMarketFix"},Y={ODC:"EnableDimePageConfigMarket"},Z={ODC:"EnableDimeVaultUpsell"},ee={ODC:"EnableDimeVaultDialog"},te={ODC:"EnableDimeHolidayPositioning"},ne={ODB:569},re={ODB:586},ie={ODB:571},se={ODB:572},oe={ODC:"EnableNewTicketingService"},ue={ODB:391},ae={ODB:1253},fe={ODB:60575},le={ODC:"EnablePasswordProtectedLinks"},ce={ODC:"EnablePremiumCheckWebPasswordLinks"},he={ODB:i.Wo?721:-721,ODC:"EnableResponsiveFilesListView"},pe={ODC:"EnableIconographyExperiment"},de={ODC:"EnableExpExperimentAATest"},ve={ODB:1296},me={ODB:1701},ge={ODB:1861},ye={ODB:60948},be={ODB:1640},we={ODB:60740},Ee={ODB:60863},Se={ODB:640},xe={ODB:646},Te={ODB:1390},Ne={ODC:"EnableAtMentionTeachingUIAA"},Ce={ODC:"EnableAtMentionTeachingUIAB"},ke={ODC:"EnableAtMentionTeachingUI"},Le={ODC:"LogPeoplePickerMounting"},Ae={ODC:!0,ODB:!1},Oe={ODC:"AttachGroupIdToSharedByKey"},Me={ODC:"UseFluidDevPreview"},_e={ODB:688},De={ODB:60035},Pe={ODB:60350},He={ODB:60208},Be={ODB:60498},je={ODC:"EnableRedeemSamsungBonusDialog"},Fe={ODC:"RepositionUpsellFREExperiment"},Ie={ODC:"FamilySharing"},qe={ODC:"FamilySharingWacKS"},Re={ODC:"ManageAccessRevampConsumer"},Ue={ODC:"ODCSharePrefetchInline"},ze={ODC:"ODCHideNonPremiumLinkFeatures"},We={ODC:"SharingTooltipCalloutKS"},Xe={ODC:"OneHundredGBSKUExperiment"},Ve={ODC:"OneHundredGBSKUEnabled"},$e={ODC:"FiftyGBSKUExperimentv2"},Je={ODC:"FiftyGBSKUEnabled"},Ke={ODC:"Enable3SonWacWord"},Qe={ODC:"ODCFacepileFeature"},Ge={ODC:"UseDownloadMicroservice"},Ye={ODB:836},Ze={ODB:!0},et={ODB:14162},tt={ODB:964},nt={ODB:968},rt={ODB:890},it={ODB:928},st={ODC:"DragAndDropRobotAnimation",ODB:899},ot={Fallback:!0},ut={ODB:761},at={ODB:516},ft={ODB:722},lt={ODB:591},ct={ODB:725},ht={ODB:727},pt={ODB:730},dt={ODB:731},vt={ODB:783},mt={ODB:308,ODC:"ItemAnalytics"},gt={ODB:!!(i.Wo||o.listBaseTemplate>=0)||-1063},yt={ODB:734},bt={ODB:60925},wt=a,Et={ODB:-500},St={ODB:83},xt={ODB:751},Tt={ODB:752},Nt={ODB:706},Ct={ODB:818,ODC:"EnablePushChannelAutoRefresh"},kt={ODB:859},Lt={ODB:857},At={ODB:860,ODC:"EnablePushChannel"},Ot={ODB:756},Mt={ODB:902},_t={ODC:"AutoAlbumBannerV2Enabled"},Dt={ODB:757},Pt={ODC:"EnableGetItemsPrefetch"},Ht={ODB:804},Bt={ODB:811},jt={ODB:812},Ft={ODB:1193},It={ODB:813},qt={ODB:35},Rt={ODB:821},Ut={ODC:"UseNewReportAbuseDialog"},zt={ODC:"UserVroomApiForRemoveFromSharedListAndReportAbuse"},Wt={ODC:"UseVroomApiForReportAbuse"},Xt={ODC:"UseVroomApiForRequestReview"},Vt={ODC:"UseVroomUpdateCaption"},$t={ODC:!r.e.isActivated("63D3DE85-2D59-4622-8BD4-CEEC395F89D6","10/21/2021","Enable anonymous report concern command")},Jt={ODC:"EnableEnhancedMobileUpsell"},Kt={ODB:842,ODC:"RecycleBinListFooter"},Qt={ODB:854,ODC:"EnableViewInFolder"},Gt={ODC:"PhotosLayoutViewDisabled"},Yt={ODB:973},Zt={ODB:-873},en={ODB:712},tn={ODC:"EnableSecurityMomentLightbox"},nn={ODB:884},rn={ODB:777},sn={ODB:60783},on={ODC:"ODCInlineShare"},un={ODC:"ODCManageAccessCommandBar"},an={ODB:778},fn={ODB:780},ln={ODB:1176},cn={ODB:887},hn={ODB:885,ODC:"EnableDownloadPushChannelNotifications"},pn={ODC:"VersionAllFiles"},dn={ODB:118},vn={ODB:202},mn={ODC:"EnableEvokeAlignments"},gn={ODC:"EvokeDev"},yn={ODB:285},bn={ODC:"EnableInfoPaneStickyHeader"},wn={ODB:1144},En={ODB:1162},Sn={ODB:1154},xn={ODB:1065},Tn={ODB:!r.e.isActivated("b8c885e0-1292-4bba-a624-d365f85bf140","05/27/2021","Show the new create shared library UI in ODB")},Nn={ODB:60329},Cn={ODB:!0,ODC:"UseTilesList"},kn={ODB:!1,ODC:"UseTilesListForAllPhotos"},Ln={ODB:!1,ODC:!0},An={ODB:351},On={ODB:387},Mn={ODB:1286},_n={ODB:1287},Dn={ODB:852},Pn={ODB:903},Hn=r.e.isActivated("5b1beb70-aac8-4da3-a4e2-151c7e55cd53","Fallback to global canManageLinks logic"),Bn={ODC:!1,ODB:!Hn},jn={ODB:!1,ODC:!0,OneDrive:!0},Fn={ODB:620},In={ODC:"EnableAnonymousSigninDialog"},qn={ODC:"UnauthenticatedBannerUseSigninDialog"},Rn={ODC:"ProjectV_WebCreate"},Un={ODC:!0},zn={ODC:"EnableOrderPrintsWeb"},Wn={ODC:"SigninDialogSupportBusinessAccounts"},Xn={ODC:"SamsungGalleryFilter"},Vn={ODB:!0,ODC:!1},$n={ODB:1142},Jn={ODB:1052},Kn={ODB:1227},Qn={ODB:772},Gn={ODB:1765},Yn={ODB:1363},Zn={ODC:"EnableVroomEmailSettings"},er={ODC:"EnableVroomTaggingSettings"},tr={ODC:"EnableManageStorageSettings"},nr={ODC:"EnableVroomDocFormatSettings"},rr={ODB:!0,ODC:!1},ir={ODC:"UseItemsScopeInAllPhotosEnableGrid"},sr={ODC:"UseItemsScopeInAllPhotosForwardPaging"},or={ODC:"UseItemsScopeInExplorePhotos"},ur={ODC:"UsePhysicalPixelSizeThumbsInAllPhotosView"},ar={ODC:"RequestCacheSizeThumbnails"},fr={ODC:"EnableMultiplePhotoStories"},lr={ODC:"EnablePhotoStream"},cr={ODC:"EnablePhotoStreamInviteExpOne"},hr={ODC:"EnablePhotoStreamInviteExpOneOn"},pr={ODC:"EnablePhotoStreamInLeftNav"},dr={ODC:"EnableNewCarouselDesign"},vr={ODC:"EnableNewCarouselDesignExp"},mr={ODC:"EnableOnThisMonth"},gr={ODC:"EnableRecommendationApi"},yr={ODC:"EnableLastWeekPreviousYears"},br={ODC:"EnableMojFeedback"},wr={ODC:"EnableNewPhotosExperience"},Er={ODC:"EnableMOJNotificationBanner"},Sr={ODC:"EnableSeeAllButton"},xr={ODC:"UseLegacyDataManagerToFirePLT"},Tr={ODC:!0,ODB:!0},Nr={ODC:"MoveAndCopyWithClipboard",ODB:-776},Cr={ODB:!0,ODC:!1},kr={ODB:!0},Lr={ODB:1552},Ar={ODC:"ReadOnlyItemsStore",ODB:-17},Or={ODC:"InAppMessagingWebTargetedUpsells"},Mr={ODB:-1197},_r={ODB:1578},Dr={ODB:1610},Pr={ODB:1221},Hr={ODB:1223},Br={ODB:1384},jr={ODB:1262},Fr={ODB:1367},Ir={ODB:1453},qr={ODB:1257},Rr={ODB:60578},Ur={ODB:60930},zr={ODB:1261},Wr={ODC:"DeleteConfirmDialog"},Xr={ODC:"RestoreDayLightSavingTimeAdjustment"},Vr={ODB:1999},$r={ODC:"UseImage360Viewer",ODB:!0},Jr={ODB:1134},Kr={ODC:"MruToMruPlusPlusSkyApi"},Qr={ODB:!0},Gr={ODC:!0,OneDrive:!1},Yr={ODB:1415},Zr={ODB:1417},ei={ODB:1352},ti={ODB:!0},ni={ODB:1484},ri={ODB:60299},ii={ODB:1169},si={ODB:60572},oi={ODB:1650},ui={ODB:1796},ai={ODB:!r.e.isActivated("61c45046-bce1-4f47-a4dc-477520ba1895","11/16/2021","Do not invalidate item after sharing when in search view")},fi={ODB:1054},li={ODB:1606},ci={ODC:"LanguageSettingsRedirect"},hi={ODC:"LanguageProfileChange"},pi={ODB:1393},di={ODC:"CreateDocumentPromptSameTab"},vi={ODC:"CreateDocumentToVroom"},mi={ODB:!0},gi={ODB:1466},yi={ODC:"RedirectExcelSurveysToFormsV2"},bi={ODB:!0},wi={ODC:"DisablePremiumUserFactUpdate"},Ei={ODC:"DisableSingleFileDownloadFallback"},Si={ODC:"UseVroomInVaultSingleFileDownload"},xi={ODC:"UsePagingTokenForSearch"},Ti={ODB:60735},Ni={ODB:60011},Ci={ODB:1745},ki={ODB:60312},Li={ODB:60507},Ai={ODB:1667},Oi={ODB:1884},Mi={ODB:60162},_i={ODB:1060},Di={ODB:60103},Pi={ODB:60422},Hi={ODB:60519},Bi={ODB:60380},ji={ODB:677},Fi={ODB:60145},Ii={ODB:1956},qi={ODB:1934},Ri={ODB:1047},Ui={ODB:1621},zi={ODB:1180},Wi={ODB:60120},Xi={ODB:60121},Vi={ODB:1767},$i={ODB:1244},Ji={ODB:1697},Ki={ODB:60652},Qi={ODB:60706},Gi={ODB:-123,OneDrive:!0},Yi={ODB:872,OneDrive:!0},Zi={ODB:!0,ODC:"EnableZipFilePreviewing",OneDrive:!0},es={ODB:60195},ts={ODB:!0,OneDrive:!0},ns={ODB:817,ODC:!0,OneDrive:!0},rs={ODB:60099,ODC:"EnableNewOneUpCommandBar"},is={ODB:!1,ODC:"EnableNewOneUpCommandBarODCExperiment"},ss={ODC:"EnableNewOneUpCommandBarODCExperiment_ABTrigger"},os={ODB:60005,ODC:"EnableDarkThemeForOneUpMediaViewer",OneDrive:!1},us={ODB:!1,ODC:"EnableDarkThemeForOneUpMediaViewerODCExperiment"},as={ODC:"EnableDarkThemeForOneUpMediaViewerODCExperiment_ABTrigger"},fs={ODC:"DisableOneUpUpdateViewCount"},ls={ODB:1511,ODC:"EnableOneUpTextFileV2"},cs={ODB:1709,ODC:!1,OneDrive:!1},hs={ODB:!1,ODC:!1,ECS:1069610},ps={ODB:1816},ds={ODB:1115},vs={ODB:1040,ODC:!1,OneDrive:!0},ms={ODB:!r.e.isActivated("cce0d731-4a47-460e-b5d5-c31fdf4d347a","9/11/2020","Pass through clientId to hosted OneUp WAC app"),ODC:!1,OneDrive:!0},gs={ODB:!r.e.isActivated("53c310fe-1add-42fe-9e42-26b35764ed1a","12/14/2020","Pass through docClickTime to hosted OneUp WAC app"),ODC:!1,OneDrive:!0},ys={ODB:!r.e.isActivated("bcc0651f-a0de-430b-8435-1afc9875b682","08/03/2021","Pass through uih to hosted OneUp WAC app"),ODC:!1},bs={ODB:!r.e.isActivated("731D9A2D-7DDD-4DE8-98D1-D454F59246E7","05/30/2022","Pass through EmbeddingPageSessionInfo and EmbeddingPageOrigin to hosted OneUp WAC app"),ODC:!1},ws={ODB:826,OneDrive:!0},Es={ODB:1639},Ss={ODB:!r.e.isActivated("8a90e09f-a635-4113-897e-402973bce841","10/21/2021","Use pdf viewer to preview tiff files"),ODC:!0},xs={ODB:336,ODC:"AllowVideoDiagnostics"},Ts={ODB:!0,ODC:!1,OneDrive:!1,Fallback:!1},Ns={ODB:!0,OneDrive:!0},Cs={ODB:!0,ODC:!1,Fallback:!0},ks={ODB:!0},Ls={ODB:!0},As={ODB:!0},Os={ODB:!0,ODC:"VideoFallback"},Ms={ODB:!0,ODC:!1},_s={ODB:!r.e.isActivated("f50a33e2-f57e-4b97-a36d-d6a3be9e5240","02/09/2021","Add forced new token while trying to get token"),ODC:!1},Ds={ODB:!r.e.isActivated("97048ac2-781a-4ee8-8f5d-46995f622c82","05/24/2021","Use GraphDatasource to get and refresh driveAccessToken"),ODC:!1},Ps={ODB:!0,ODC:!1},Hs={ODB:!r.e.isActivated("d6cee8cb-7162-4dee-a43b-63adeeb1971d","01/27/2021","Sets a query param (correlationId) which can help debug client errors using service logs"),ODC:!1},Bs={ODB:!r.e.isActivated("eae1b7c5-a0b3-43b0-839c-30cfbc2e5a9d","4/12/2021","Add sending of playbackSessionId and content category as qsp"),ODC:!1},js={ODC:!1,ODB:!r.e.isActivated("276f3e59-6a18-4296-b221-d9fbe60eca97","2/9/2021","Use a window.fetch  request to check for cors errors")},Fs={ODB:1440,ODC:!1,OneDrive:!1},Is={ODB:1591,ODC:!1,OneDrive:!1},qs={ODB:60202,ODC:!1,OneDrive:!1},Rs={ODB:1995},Us={ODB:!1,ECS:79947},zs={ODB:60436},Ws={ECS:89865},Xs={ECS:1009715},Vs={ECS:1003081},$s={ECS:1008378},Js={ODB:!1,ODC:!1,ECS:94436},Ks={ODB:60213},Qs={ODB:60912,ODC:!1},Gs={ODB:!1,ODC:!1,ECS:83884},Ys={ODB:!1,ODC:!1},Zs={ODB:!1,ODC:!1},eo={ODB:!1,ODC:!1},to={ODB:!1,ODC:!1},no={ODB:643,ODC:!1},ro={ODB:644,ODC:!1},io={ODB:1160,ODC:!1},so={ODB:644,ODC:!1},oo={ODB:60424,ODC:!1},uo={ODB:!r.e.isActivated("71913f76-47d4-4293-a492-2205b7c1e655","3/18/2021","Enable sending of heartbeat telemetry"),ODC:!1,OneDrive:!0},ao={ODB:r.e.isActivated("bdfc077e-7152-4772-874e-1936725cde1f","3/24/2021","Enable max retries check on RequestManager in Dashling."),ODC:!1,ECS:77954},fo={ODB:!r.e.isActivated("9d46a6f9-9676-41ed-a4b5-3c01c1080993","3/1/2021","Use the height specified in the adaptation set as the resolution, rather than parsing it from the resolutionId"),ODC:!1,OneDrive:!0},lo={ODB:!r.e.isActivated("d4be6831-a0f7-40f7-b77b-5ad215b528c9","8/19/2020","Control if video dashling telemetry is enabled"),ODC:!1},co={ODB:!r.e.isActivated("20f62141-0df7-4eb3-943c-ff45219c1ee1","8/19/2020","Control if video dashling decryptor v2 is disabled"),ODC:!1},ho={ODB:!r.e.isActivated("f6b9287b-5835-460b-8651-ae3b92ec34ce","9/14/2020","Control if video dashling supports parallel key call"),ODC:!1},po={ODB:!r.e.isActivated("336583dd-00a6-40dd-beea-2f2068fb2f0c","8/19/2020","Control if video dashling cdn ref ids telemetry is enabled"),ODC:!1},vo={ODB:!r.e.isActivated("c56be611-10e0-4cde-8a46-1244a42f47b3","9/28/2020","Control if video dashling telemetry info is enabled"),ODC:!1},mo={ODB:!r.e.isActivated("b8133a0d-36a6-4a4d-ba26-fb4563484d41","11/11/2020","Control if video refresh token is enabled"),ODC:!1},go={ODB:!r.e.isActivated("22f8bf4b-d19c-4c1f-a5a7-cb2fd36c8d6c","10/05/2020","Control if force Meta params are enabled"),ODC:!1},yo={ODB:!r.e.isActivated("351ee0af-7950-49cf-a8f7-2fa77e44fb97","11/05/2020","Control if smart playback is enabled"),ODC:!1},bo={ODB:60108,ODC:!1,Fallback:!1},wo={ODB:60109,ODC:!1,Fallback:!1},Eo={ODB:60110,ODC:!1,Fallback:!1},So={ODB:1886,ODC:!1,Fallback:!1,OneDrive:!0},xo={ODB:!r.e.isActivated("45a43ec1-f520-41e6-9f94-4d14af7ccf6d","9/30/2020","Control if video dashling optimizations are enabled"),ODC:!1},To={ODB:!r.e.isActivated("411555f8-233c-4f56-97f4-586835b5e130","04/03/2021","Retry video metadata call with the access token provided in the playback URLs"),ODC:!1,OneDrive:!0},No={ODB:!r.e.isActivated("cc74fd4e-2d38-4443-a603-78c3c5024447","09/01/2020","Call MeTa to verify captions exist before showing UI toggle"),ODC:!1},Co={ODB:1661,ODC:!1,Fallback:!1,OneDrive:!0},ko={ODB:60003,ODC:!1,Fallback:!1,OneDrive:!0},Lo={ODB:!r.e.isActivated("c1063c7b-5a82-4f68-84ca-3920d6541988","2/11/2021","Controls teams meeting recordings fallback to ffmpeg when media foundation unsuccessful"),ODC:!1,Fallback:!1},Ao={ODB:r.e.isActivated("0f853474-6c72-4456-ac06-ed2da32c4d44","3/9/2021","Identify OneUpPlayer to MeTA transcode service"),ODC:!0,ECS:76545},Oo={ODB:!1,ODC:!r.e.isActivated("174C413E-7F06-49B2-AFBE-D1C3E6972EBA","11/24/2021","Disable SK compliance video block for ODC")},Mo={ODB:!1,ODC:!1,OneDrive:!0},_o={ODB:!0,ODC:!1},Do={ODB:60048,ODC:!1,Fallback:!1},Po={ODB:60305,ODC:!1,ECS:82729},Ho={ODB:60313,ODC:!1,ECS:83394},Bo={ODB:!r.e.isActivated("dbecc8cc-2bf6-4a33-bedf-9f71faa71fdf","1/5/2021","Controls DASH playback on Safari"),ODC:!1,Fallback:!1,OneDrive:!0},jo={ODB:60085,ODC:!1,Fallback:!1},Fo={ODB:60255,ODC:!1,ECS:79919},Io={ODB:!r.e.isActivated("ce53700c-4498-49ef-b738-21131fdc2551","5/30/2021","Enable pretranscode support"),ODC:!1},qo={ODB:!r.e.isActivated("398DDB43-D6A8-4060-8F69-378A0AEF845A","03/25/2022","Display request access button when no permission (403)"),ODC:!1},Ro={ODB:60838,ODC:!1},Uo={ODB:!0},zo={ODB:834,ODC:"RemoveOneUpSlideNavigation",OneDrive:!0},Wo={ODB:!r.e.isActivated("d047b4a4-477a-4da6-b18c-1eb7daf19cc8","11/03/2021","Add request access button to OneUp curtain"),ODC:!1},Xo={ODC:"DarkBackgroundForPhotosOneUp"},Vo={ODC:"DarkBackgroundForPhotosOneUpExperiment"},$o={ODC:"DarkBackgroundForPhotosOneUpExperiment_ABTrigger"},Jo={ODC:"EnableLivePhotoVideos"},Ko={ODC:"EnableLivePhotoVideos_NativePlayback"},Qo={ODC:"EnableLivePhotoVideosForCobUser"},Go={ODC:"EnableSamsungMotionPhotoVideos"},Yo={ODB:!r.e.isActivated("0b6f3eb5-90ef-4e77-81d9-2286c06c3257","07/20/2021","Engagement Telemetry Enhancement for 1up according to ask from OnePlayer"),ODC:!1},Zo={ODB:60026,ODC:!1,OneDrive:!1,Fallback:!1},eu={ODB:60081,ODC:!1,OneDrive:!1,Fallback:!1},tu={ODB:!r.e.isActivated("ca5833b4-d7d9-406d-8e36-fc28548b52a2","10/21/2020","Update video autoplay behavior"),ODC:"1upVideoAutoplayUpdate",OneDrive:!0},nu={ODB:1181,OneDrive:!0},ru={ODB:60636},iu={ODC:"EnableEditUtilityControlIE"},su={ODC:"EnableEditUtilityControlSafari"},ou={ODC:"EnableEditUtilityControlMobile"},uu={ODC:"EnableEditUtilityControl",ODB:60204},au={ODC:"EnableEditControlTeachingBubble"},fu={ODC:"EnableEditControlExperimentAA"},lu={ODC:"EnableEditControlExperimentAB"},cu={ODC:"EnableEditControlAdjustments",ODB:60478},hu={ODC:"EnableEditControlFilters",ODB:60545},pu={ODC:"EnableEditAllImageFormats"},du={ODC:"EnableEditControlMarkup",ODB:60139},vu={ODC:"EnableEditControlArrowHead",ODB:60739},mu={ODC:"EnableEditPNG",ODB:60593},gu={ODC:"EnableEditHEIC",ODB:60664},yu={ODB:634,ODC:!1,OneDrive:!1,Fallback:!1},bu={ODB:60093,ODC:!1,OneDrive:!1,Fallback:!1},wu={ODB:60124,ODC:!1,OneDrive:!1,Fallback:!1},Eu={ODB:1614,ODC:!1,OneDrive:!1,Fallback:!1},Su={ODB:1655,ODC:!1,OneDrive:!1,Fallback:!1},xu={ECS:1071224},Tu={ODB:!r.e.isActivated("9ffb3b8b-fbfe-4c66-bd3a-34f3451d6037","02/06/2023","Killswitch to enable teaching bubble for PDF editing")},Nu={ODB:1355,ODC:!1,OneDrive:!1,Fallback:!1},Cu={ODB:!r.e.isActivated("260364a3-3855-4555-95ad-fc012bfe8d0c","01/06/2022","Enable ER Bug fixes for Universal Annotations"),ODC:!1,OneDrive:!1,Fallback:!1},ku={ODB:17055,ODC:!1,OneDrive:!1,Fallback:!1},Lu={ODB:1811,ODC:!1,OneDrive:!1,Fallback:!1},Au={ODB:1063,ODC:!1,OneDrive:!1,Fallback:!1},Ou={ODB:60347},Mu={ODB:60349,ODC:"PWACustomInstallPrompt"},_u={ODB:1866},Du={ODB:1880},Pu={ODB:803,ODC:"OptimizelyEnabled"},Hu={ODB:363},Bu={ODB:464},ju={ODB:8},Fu={ODB:1970},Iu={ODB:r.e.isActivated("bd34a99e-6762-42ac-9795-c2123340281b","11/17/2021","Enable FFMPEG transcoding for all HLS sessions"),ECS:110016},qu={ODB:r.e.isActivated("ac5fc96a-ba27-41c2-8211-39a2d12bd2b0","2/17/2022","When the browser is Safari, force the video files to play using native player"),ECS:1003067},Ru={ODB:r.e.isActivated("1ba50e39-1615-4340-82c7-765408f11243","4/27/2022","When progressive playback is used, add cross origin anonymous to the video element"),ECS:1013575},Uu={ODB:60388,ECS:87743},zu={ODB:60325},Wu={ODB:1691},Xu={ODB:60847},Vu={ODB:60846},$u={ODB:1295},Ju={ODB:1959},Ku={ODB:1363},Qu={ODB:1264},Gu={ODB:1083},Yu={ODB:1152},Zu={ODB:60089},ea={ODB:60248},ta={ODB:60279},na={ODB:60322},ra={ODB:60087,ODC:!1,OneDrive:!1,Fallback:!1},ia={ODB:!r.e.isActivated("F6679A55-17E3-4F3B-BECF-7B969EB307C2","02/08/2022","Check if the teams meeting recording has an expiration date."),ODC:!1,OneDrive:!1,Fallback:!1},sa={ODB:60317},oa={ODB:60391},ua={ODB:60637},aa={ODB:1204},fa={ODB:!r.e.isActivated("0c7f0abb-bacf-45f2-814d-61bb1e84f2f5","8/1/2021","move target up to solve keybinding issues")},la={ODB:60543},ca={ODB:1318},ha={ODB:1312},pa={ODB:18960},da={ODB:1402},va={ODB:1418},ma={ODB:60287},ga={ODB:!r.e.isActivated("2a642dc2-93e1-41f8-b6e1-d7c4c9acecd2","09/08/2022","View button for opening uploaded video in SWA in new tab")},ya={ODB:!r.e.isActivated("3cf3efe2-3050-4c01-8597-317ed1e0acc2","28/08/2022","Open button for opening moved/copied video in SWA in new tab")},ba={ODB:!r.e.isActivated("b2895e2b-5ca4-448b-955c-38d728d7e7b2","23/12/2022","Do not show links in SWA upload popup and panel for destination directories")},wa={ODB:!r.e.isActivated("4678edfd-5753-410d-a418-5ce8e9368075","10/03/2022","Refactoring code for open button showing after moved/copied video in SWA")},Ea={ODB:!r.e.isActivated("f2e15bcb-b2af-40ee-90fa-4d0e27ac3b99","09/13/2022","Opening Video Settings automatically after opening uploaded video")},Sa={ODB:!r.e.isActivated("461e4739-e857-4d71-88da-805c7c90b75e","10/06/2022","Having only one item in new menu dropdown if other is turned off")},xa={ODC:!r.e.isActivated("D095D1B3-A17F-441B-8855-D465ED3CA91F","12/15/2021","")},Ta={ECS:114542},Na={ODB:60703},Ca={ODB:60720},ka={ODB:60752},La={ODB:60798},Aa={ODB:60800},Oa={ODB:1197},Ma={ODC:"CreateConvergenceEnabled"},_a={ODC:"CreateConvergenceViaVroom"},Da={ODB:!r.e.isActivated("483a92b4-201c-4b8c-b657-3fe2ce288672","4/22/2022","Show teaching bubble for TMR files consistently before user closes it."),ODC:!1,OneDrive:!1,Fallback:!1},Pa={ODB:!r.e.isActivated("a6183b15-1c4c-4fe0-b52c-b263235d6c3d","5/11/2022","Use UTC time zone for TMR"),ODC:!1,OneDrive:!1,Fallback:!1},Ha={ODB:!r.e.isActivated("744d1129-5df2-4930-b056-7bc0fb82151b","5/11/2022","Feature to check if video codec is in the list of unsupported by browser")},Ba={ODB:1108,ODC:!1,OneDrive:!1,Fallback:!1},ja={ODB:!1,ODC:"EnableGraphApiGetEmbedInfo",OneDrive:!1,Fallback:!1},Fa={ODB:1306},Ia={ODB:1159},qa={ODB:1451},Ra={ODB:1713},Ua={ODB:60666},za={ODC:"HideTaggingFeatures"},Wa={ODC:"HideATOForCrossStackContent"},Xa={ODC:"EnableATOForCOBtoCOB"},Va={ODC:"HideShareButton"},$a={ODC:"HideEditPhoto"},Ja={ODC:"HideEmbedButton"},Ka={ODC:"HideAddToAlbum"},Qa={ODC:"HideAlbumPivot"},Ga={ODC:"ShowAlertIcon"},Ya={ODC:"EnableDocumentDigestEmail"},Za={ODB:!1,ODC:!r.e.isActivated("DE2FA0D9-D704-4B85-916B-9DB19121E9A1","3/21/2023","Fix COB OneUp cannot open thumbnail correctly.")},ef={ODB:r.e.isActivated("b2ac1c0f-d8e1-4f24-9d57-41afa45a5f66","10/11/2022","Killswitch to enable prefetching video with low bitrate")},tf={ODB:!r.e.isActivated("25c1f6db-47d7-4e6b-b85e-80d4815265b1","9/29/2022","Killswitch to add error handling for getrequestparametersasync call in prefetch")},nf={ODB:!r.e.isActivated("60fdf489-9918-46ee-8151-5a98bc049a81","10/26/2022","Killswitch to add logging for error in fetch operation")},rf={ODB:1606},sf={ODB:1679},of={ODB:r.e.isActivated("3ed78801-a94e-47e9-9ea5-82939e22db18","03/14/2023","Allows forProviderPromise to complete before ecsProviderPromise")},uf={ODB:1209},af={ODB:1347},ff={ODB:1199},lf={ODB:r.e.isActivated("51ee2bb9-9d53-45e8-a198-02a1d377f01d","1/23/2023","Remove tooltip from new button on command bar")},cf={ODC:"EnableAlbumForConvergence"},hf={ODC:"EnableCreateAlbumFromFolder"},pf={ODC:"EnableMojForConvergence"},df={ODB:1887},vf={ODB:1901},mf={ODB:60007},gf={ODB:60323},yf={ODB:60331},bf={ODC:"EnablePreAuthEmbedLinkForImage"}},,function(e,t,n){"use strict";n.d(t,"zo",function(){return f});n.d(t,"Pn",function(){return l});n.d(t,"s",function(){return c});n.d(t,"v",function(){return h});n.d(t,"y",function(){return p});n.d(t,"C",function(){return d});n.d(t,"N",function(){return v});n.d(t,"O",function(){return m});n.d(t,"k",function(){return g});n.d(t,"T",function(){return y});n.d(t,"L",function(){return b});n.d(t,"A",function(){return w});n.d(t,"S",function(){return E});n.d(t,"M",function(){return S});n.d(t,"x",function(){return x});n.d(t,"w",function(){return T});n.d(t,"_",function(){return N});n.d(t,"H",function(){return C});n.d(t,"si",function(){return k});n.d(t,"V",function(){return L});n.d(t,"X",function(){return A});n.d(t,"z",function(){return O});n.d(t,"q",function(){return M});n.d(t,"j",function(){return _});n.d(t,"Q",function(){return D});n.d(t,"G",function(){return P});n.d(t,"ee",function(){return H});n.d(t,"ne",function(){return B});n.d(t,"ae",function(){return j});n.d(t,"le",function(){return F});n.d(t,"ge",function(){return I});n.d(t,"me",function(){return q});n.d(t,"be",function(){return R});n.d(t,"_e",function(){return U});n.d(t,"qe",function(){return z});n.d(t,"Qe",function(){return W});n.d(t,"et",function(){return X});n.d(t,"st",function(){return V});n.d(t,"Ye",function(){return $});n.d(t,"Tt",function(){return J});n.d(t,"je",function(){return K});n.d(t,"Re",function(){return Q});n.d(t,"ot",function(){return G});n.d(t,"dt",function(){return Y});n.d(t,"K",function(){return Z});n.d(t,"ut",function(){return ee});n.d(t,"Be",function(){return te});n.d(t,"bt",function(){return ne});n.d(t,"mt",function(){return re});n.d(t,"ht",function(){return ie});n.d(t,"gt",function(){return se});n.d(t,"He",function(){return oe});n.d(t,"ye",function(){return ue});n.d(t,"yt",function(){return ae});n.d(t,"se",function(){return fe});n.d(t,"Yt",function(){return le});n.d(t,"Ui",function(){return ce});n.d(t,"zi",function(){return he});n.d(t,"Gt",function(){return pe});n.d(t,"At",function(){return de});n.d(t,"Dt",function(){return ve});n.d(t,"ts",function(){return me});n.d(t,"js",function(){return ge});n.d(t,"ko",function(){return ye});n.d(t,"Fs",function(){return be});n.d(t,"Hs",function(){return we});n.d(t,"h",function(){return Ee});n.d(t,"kt",function(){return Se});n.d(t,"at",function(){return xe});n.d(t,"_t",function(){return Te});n.d(t,"Ft",function(){return Ne});n.d(t,"qt",function(){return Ce});n.d(t,"It",function(){return ke});n.d(t,"r",function(){return Le});n.d(t,"pn",function(){return Ae});n.d(t,"mn",function(){return Oe});n.d(t,"vn",function(){return Me});n.d(t,"gn",function(){return _e});n.d(t,"yn",function(){return De});n.d(t,"bn",function(){return Pe});n.d(t,"Ne",function(){return He});n.d(t,"Rt",function(){return Be});n.d(t,"$t",function(){return je});n.d(t,"Vt",function(){return Fe});n.d(t,"Eo",function(){return Ie});n.d(t,"on",function(){return qe});n.d(t,"sn",function(){return Re});n.d(t,"fn",function(){return Ue});n.d(t,"hn",function(){return ze});n.d(t,"En",function(){return We});n.d(t,"Ln",function(){return Xe});n.d(t,"An",function(){return Ve});n.d(t,"Dn",function(){return $e});n.d(t,"Hn",function(){return Je});n.d(t,"Bn",function(){return Ke});n.d(t,"jn",function(){return Qe});n.d(t,"Oe",function(){return Ge});n.d(t,"Wn",function(){return Ye});n.d(t,"Xn",function(){return Ze});n.d(t,"Zr",function(){return et});n.d(t,"Kn",function(){return tt});n.d(t,"rr",function(){return nt});n.d(t,"nr",function(){return rt});n.d(t,"ar",function(){return it});n.d(t,"Tr",function(){return st});n.d(t,"Ar",function(){return ot});n.d(t,"Or",function(){return ut});n.d(t,"ai",function(){return at});n.d(t,"Nr",function(){return ft});n.d(t,"kr",function(){return lt});n.d(t,"Cr",function(){return ct});n.d(t,"Hr",function(){return ht});n.d(t,"Pr",function(){return pt});n.d(t,"Br",function(){return dt});n.d(t,"Li",function(){return vt});n.d(t,"E",function(){return mt});n.d(t,"Fr",function(){return gt});n.d(t,"Gi",function(){return yt});n.d(t,"Mn",function(){return Et});n.d(t,"Rs",function(){return St});n.d(t,"fi",function(){return xt});n.d(t,"qr",function(){return Tt});n.d(t,"Rr",function(){return Nt});n.d(t,"Kr",function(){return Ct});n.d(t,"ei",function(){return kt});n.d(t,"ti",function(){return Lt});n.d(t,"ni",function(){return At});n.d(t,"Fe",function(){return Ot});n.d(t,"hi",function(){return Mt});n.d(t,"Bt",function(){return _t});n.d(t,"oi",function(){return Dt});n.d(t,"di",function(){return Pt});n.d(t,"mi",function(){return Ht});n.d(t,"pi",function(){return Bt});n.d(t,"vi",function(){return jt});n.d(t,"gi",function(){return Ft});n.d(t,"bi",function(){return It});n.d(t,"yi",function(){return qt});n.d(t,"is",function(){return Rt});n.d(t,"Ei",function(){return Ut});n.d(t,"xi",function(){return zt});n.d(t,"Ni",function(){return Wt});n.d(t,"Ti",function(){return Xt});n.d(t,"Ci",function(){return Vt});n.d(t,"Pi",function(){return $t});n.d(t,"_i",function(){return Jt});n.d(t,"Di",function(){return Kt});n.d(t,"Ai",function(){return Qt});n.d(t,"Hi",function(){return Gt});n.d(t,"Bi",function(){return Yt});n.d(t,"Ii",function(){return Zt});n.d(t,"Ri",function(){return en});n.d(t,"lo",function(){return tn});n.d(t,"Fi",function(){return nn});n.d(t,"Y",function(){return rn});n.d(t,"Ki",function(){return sn});n.d(t,"rs",function(){return on});n.d(t,"xs",function(){return un});n.d(t,"Ts",function(){return an});n.d(t,"Ns",function(){return fn});n.d(t,"Ps",function(){return ln});n.d(t,"So",function(){return cn});n.d(t,"xo",function(){return hn});n.d(t,"Us",function(){return pn});n.d(t,"Ws",function(){return dn});n.d(t,"re",function(){return vn});n.d(t,"Ys",function(){return mn});n.d(t,"Xs",function(){return gn});n.d(t,"Is",function(){return yn});n.d(t,"co",function(){return bn});n.d(t,"$s",function(){return wn});n.d(t,"Ks",function(){return En});n.d(t,"Qs",function(){return Sn});n.d(t,"Vs",function(){return xn});n.d(t,"Gs",function(){return Tn});n.d(t,"eo",function(){return Nn});n.d(t,"to",function(){return Cn});n.d(t,"ro",function(){return kn});n.d(t,"io",function(){return Ln});n.d(t,"oo",function(){return An});n.d(t,"so",function(){return On});n.d(t,"Zs",function(){return Mn});n.d(t,"Js",function(){return _n});n.d(t,"uo",function(){return Dn});n.d(t,"fo",function(){return Pn});n.d(t,"ao",function(){return Hn});n.d(t,"no",function(){return Bn});n.d(t,"ho",function(){return jn});n.d(t,"mo",function(){return Fn});n.d(t,"Fo",function(){return In});n.d(t,"jo",function(){return qn});n.d(t,"wo",function(){return Rn});n.d(t,"De",function(){return Un});n.d(t,"zt",function(){return zn});n.d(t,"Ut",function(){return Wn});n.d(t,"Z",function(){return Xn});n.d(t,"Ie",function(){return Vn});n.d(t,"Yi",function(){return $n});n.d(t,"wi",function(){return Jn});n.d(t,"Ds",function(){return Kn});n.d(t,"Xi",function(){return Qn});n.d(t,"Vi",function(){return Gn});n.d(t,"zn",function(){return Yn});n.d(t,"Un",function(){return Zn});n.d(t,"Bo",function(){return er});n.d(t,"Mr",function(){return tr});n.d(t,"_r",function(){return nr});n.d(t,"Ze",function(){return rr});n.d(t,"Ge",function(){return ir});n.d(t,"pe",function(){return sr});n.d(t,"ki",function(){return or});n.d(t,"Ht",function(){return ur});n.d(t,"_o",function(){return ar});n.d(t,"Mo",function(){return fr});n.d(t,"f",function(){return lr});n.d(t,"No",function(){return cr});n.d(t,"Po",function(){return hr});n.d(t,"Do",function(){return pr});n.d(t,"lt",function(){return dr});n.d(t,"ct",function(){return vr});n.d(t,"ft",function(){return mr});n.d(t,"tt",function(){return gr});n.d(t,"nt",function(){return yr});n.d(t,"qn",function(){return br});n.d(t,"Rn",function(){return wr});n.d(t,"rt",function(){return Er});n.d(t,"e",function(){return Sr});n.d(t,"o",function(){return xr});n.d(t,"Oi",function(){return Tr});n.d(t,"Nt",function(){return Nr});n.d(t,"Yr",function(){return Cr});n.d(t,"Dr",function(){return kr});n.d(t,"Ur",function(){return Lr});n.d(t,"Os",function(){return Ar});n.d(t,"As",function(){return Or});n.d(t,"Ls",function(){return Mr});n.d(t,"Ms",function(){return _r});n.d(t,"d",function(){return Dr});n.d(t,"br",function(){return Pr});n.d(t,"Xe",function(){return Hr});n.d(t,"gr",function(){return Br});n.d(t,"Qt",function(){return jr});n.d(t,"mr",function(){return Fr});n.d(t,"Jt",function(){return Ir});n.d(t,"Sn",function(){return qr});n.d(t,"Kt",function(){return Rr});n.d(t,"xn",function(){return Ur});n.d(t,"Tn",function(){return zr});n.d(t,"Xt",function(){return Wr});n.d(t,"Wt",function(){return Xr});n.d(t,"Me",function(){return Vr});n.d(t,"pr",function(){return $r});n.d(t,"cr",function(){return Jr});n.d(t,"hr",function(){return Kr});n.d(t,"dr",function(){return Qr});n.d(t,"a",function(){return Gr});n.d(t,"Zt",function(){return Yr});n.d(t,"lr",function(){return Zr});n.d(t,"c",function(){return ei});n.d(t,"Ho",function(){return ti});n.d(t,"Gn",function(){return ni});n.d(t,"Yn",function(){return ri});n.d(t,"wn",function(){return ii});n.d(t,"ks",function(){return si});n.d(t,"yr",function(){return oi});n.d(t,"un",function(){return ui});n.d(t,"po",function(){return ai});n.d(t,"jr",function(){return fi});n.d(t,"Mi",function(){return li});n.d(t,"xt",function(){return ci});n.d(t,"kn",function(){return hi});n.d(t,"er",function(){return pi});n.d(t,"Zn",function(){return di});n.d(t,"Nn",function(){return vi});n.d(t,"g",function(){return mi});n.d(t,"tr",function(){return gi});n.d(t,"Bs",function(){return yi});n.d(t,"To",function(){return bi});n.d(t,"ss",function(){return wi});n.d(t,"li",function(){return Ei});n.d(t,"bo",function(){return Si});n.d(t,"fr",function(){return xi});n.d(t,"B",function(){return Ti});n.d(t,"zs",function(){return Ni});n.d(t,"vt",function(){return Ci});n.d(t,"ws",function(){return ki});n.d(t,"D",function(){return Li});n.d(t,"ci",function(){return Ai});n.d(t,"qi",function(){return Oi});n.d(t,"Jn",function(){return Mi});n.d(t,"wr",function(){return _i});n.d(t,"us",function(){return Di});n.d(t,"ls",function(){return Pi});n.d(t,"Sr",function(){return Hi});n.d(t,"Er",function(){return Bi});n.d(t,"xr",function(){return ji});n.d(t,"Cs",function(){return Fi});n.d(t,"tn",function(){return Ii});n.d(t,"W",function(){return qi});n.d(t,"jt",function(){return Ri});n.d(t,"he",function(){return Ui});n.d(t,"fs",function(){return zi});n.d(t,"as",function(){return Wi});n.d(t,"ce",function(){return Xi});n.d(t,"u",function(){return Vi});n.d(t,"Pt",function(){return $i});n.d(t,"Si",function(){return Ji});n.d(t,"ji",function(){return Ki});n.d(t,"Cn",function(){return Qi});n.d(t,"Ji",function(){return Gi});n.d(t,"ke",function(){return Yi});n.d(t,"Le",function(){return Zi});n.d(t,"Fn",function(){return es});n.d(t,"dn",function(){return ts});n.d(t,"Ue",function(){return ns});n.d(t,"de",function(){return rs});n.d(t,"ve",function(){return is});n.d(t,"St",function(){return ss});n.d(t,"Pe",function(){return os});n.d(t,"sr",function(){return us});n.d(t,"or",function(){return as});n.d(t,"fe",function(){return fs});n.d(t,"Lt",function(){return ls});n.d(t,"$i",function(){return cs});n.d(t,"Zi",function(){return hs});n.d(t,"hs",function(){return ps});n.d(t,"Qn",function(){return ds});n.d(t,"ns",function(){return vs});n.d(t,"ii",function(){return ms});n.d(t,"Ir",function(){return gs});n.d(t,"Oo",function(){return ys});n.d(t,"ir",function(){return bs});n.d(t,"os",function(){return ws});n.d(t,"Ss",function(){return Es});n.d(t,"ue",function(){return Ss});n.d(t,"nn",function(){return xs});n.d(t,"rn",function(){return Ts});n.d(t,"b",function(){return Ns});n.d(t,"I",function(){return Cs});n.d(t,"zr",function(){return ks});n.d(t,"F",function(){return Ls});n.d(t,"U",function(){return As});n.d(t,"Lo",function(){return Os});n.d(t,"Ee",function(){return Ms});n.d(t,"vo",function(){return _s});n.d(t,"ze",function(){return Ds});n.d(t,"en",function(){return Ps});n.d(t,"ur",function(){return Hs});n.d(t,"ps",function(){return Bs});n.d(t,"bs",function(){return js});n.d(t,"ys",function(){return Fs});n.d(t,"gs",function(){return Is});n.d(t,"ms",function(){return qs});n.d(t,"Ce",function(){return Rs});n.d(t,"Ae",function(){return Us});n.d(t,"vs",function(){return zs});n.d(t,"ds",function(){return Ws});n.d(t,"cn",function(){return Xs});n.d(t,"xe",function(){return Vs});n.d(t,"ui",function(){return $s});n.d(t,"Se",function(){return Js});n.d(t,"Et",function(){return Ks});n.d(t,"P",function(){return Qs});n.d(t,"we",function(){return Gs});n.d(t,"ie",function(){return Ys});n.d(t,"Wr",function(){return Zs});n.d(t,"Xr",function(){return eo});n.d(t,"Vr",function(){return to});n.d(t,"$r",function(){return no});n.d(t,"Jr",function(){return ro});n.d(t,"n",function(){return io});n.d(t,"p",function(){return so});n.d(t,"In",function(){return oo});n.d(t,"ri",function(){return uo});n.d(t,"_s",function(){return ao});n.d(t,"pt",function(){return fo});n.d(t,"cs",function(){return lo});n.d(t,"go",function(){return co});n.d(t,"Wi",function(){return ho});n.d(t,"Ct",function(){return po});n.d(t,"R",function(){return vo});n.d(t,"Ao",function(){return mo});n.d(t,"es",function(){return go});n.d(t,"Gr",function(){return yo});n.d(t,"$n",function(){return bo});n.d(t,"an",function(){return wo});n.d(t,"te",function(){return Eo});n.d(t,"J",function(){return So});n.d(t,"$",function(){return xo});n.d(t,"$e",function(){return To});n.d(t,"Vn",function(){return No});n.d(t,"l",function(){return Co});n.d(t,"Yo",function(){return ko});n.d(t,"qs",function(){return Lo});n.d(t,"oe",function(){return Ao});n.d(t,"Ko",function(){return Oo});n.d(t,"Qo",function(){return Mo});n.d(t,"Jo",function(){return Do});n.d(t,"Io",function(){return Po});n.d(t,"qo",function(){return Bo});n.d(t,"vr",function(){return jo});n.d(t,"On",function(){return Fo});n.d(t,"_n",function(){return Io});n.d(t,"it",function(){return qo});n.d(t,"We",function(){return Ro});n.d(t,"i",function(){return Uo});n.d(t,"wt",function(){return zo});n.d(t,"Es",function(){return Wo});n.d(t,"Je",function(){return Xo});var r=n(177),i=n(527),s=n(10),o=n(363),u=n(50);n.d(t,"t",function(){return u.e});n.d(t,"m",function(){return u.t});n.d(t,"Te",function(){return u.r});n.d(t,"Ve",function(){return u.i});n.d(t,"Ke",function(){return u.s});n.d(t,"Ot",function(){return u.o});n.d(t,"Mt",function(){return u.u});n.d(t,"ln",function(){return u.a});n.d(t,"Lr",function(){return u.f});n.d(t,"Qr",function(){return u.l});n.d(t,"Qi",function(){return u.c});n.d(t,"yo",function(){return u.h});n.d(t,"Co",function(){return u.p});n.d(t,"Ro",function(){return u.d});n.d(t,"Uo",function(){return u.v});n.d(t,"Wo",function(){return u.m});n.d(t,"Xo",function(){return u.g});n.d(t,"Vo",function(){return u.y});n.d(t,"$o",function(){return u.b});n.d(t,"Go",function(){return u.w});var a=window._spModuleLink&&"ODBLightSpeedWebPack"===window._spModuleLink.manifestName,f=window.Flight&&"odclightspeedwebpack"===window.Flight.manifest,l=o.e,c={ODC:"AddTelemetryHeaders"},h={serviceSetting:"ExternalService_bizappsapprovalflowsenabled"},p={ODB:!s.e.isActivated("BF7BE655-7F9F-40C8-920B-C4088F784512","05/05/2022","Prefer cookie API calls using proxy in File Picker")},d={ODB:1189},v={ODB:1419},m={ODB:1534},g={ODB:60138},y={ODB:1876},b={ODB:60210},w={ODB:60065},E={ODB:60942},S={ODB:1343},x={ODB:1371},T={ODB:1854},N={ODB:1441},C={ODB:688},k={ODB:!u.m},L={ODB:1786},A={ODB:60119},O={ODB:60053},M={ODB:1132},_={ODB:!s.e.isActivated("95195f4e-8936-409f-bc5e-d98fad1cef73","08/18/2021","KillSwitch for consuming exposed Default click control handler in OneDriveItemsScopeApp"),ODC:!0},D={ODB:610},P={ODC:"DisableDomainLowering"},H={ODB:1654},B={ODB:1366},j={ODB:1114},F={serviceSetting:"ExternalService_bizappsremindmeflowenabled"},I={ODB:!0},q={ODC:"EnableAccountSwitching"},R={ODB:1620},U={ODB:!0},z={ODB:!s.e.isActivated("93C317DF-466B-47B2-96C0-2E9BB53EB3D3","05/05/2022","Use river flow in Tiles List media group")},W={ODB:1135},X={ODB:1623},V={ODC:"EnableOneUpDataManager"},$={ODC:"EnableODCServiceWorker"},J={ODC:"EnableServiceWorkerPrefetch"},K={ODC:"EnableLastWeekPreviousYearsExp"},Q={ODC:"EnableMonthRecapGroupHeaderExp"},G={ODB:1080},Y={ODB:268,OneDrive:!0},Z={ODB:336,ODC:"DebugWindowEnabled"},ee={ODB:!(!a&&!u.y)&&60154},te={ODB:60036},ne={ODB:!s.e.isActivated("7B7FA902-74E1-41A3-B7FA-5E99A7C60744","10/25/2021","Enables the CallerId and CallerScenarioId query provided on inbound links to be logged in extra data of Page.View engagement event.")},re={ODB:60348},ie={ODB:60482},se={ODB:60805},oe={ODB:-60765},ue={ODB:60765},ae={ODC:!u.g&&"UseItemsScopeInRecent",ODB:1191},fe={ODC:!!u.g&&!s.e.isActivated("70C000B4-CC40-4BC4-99BF-77B1C9D91115","08/01/2022","Disable photos pivot in winApp")},le={ODC:"ExecuteFREAfterFCI"},ce={ODB:-1434},he={ODB:1903},pe={ODB:60230},de={ODB:60865},ve={ODB:1972},me={ODB:1919},ge={ODB:60676},ye={ODB:60016},be={ODB:!s.e.isActivated("728AC795-2069-44D4-B387-4B82D9E1D930","06/29/2022","Use layer projection for Sites in ODB")},we={ODB:!s.e.isActivated("C7DDA4BE-D28B-4151-A22F-0BD7727B012D","1/26/2022","Use cross-site File Browser for Sites in ODB")},Ee={ODB:-8765},Se={ODB:60684},xe={ODB:60832,ODC:"EnablePhoneLinkInFilePicker"},Te={ODB:60212},Ne={ODB:-1504},Ce={ODB:-1893},ke={ODB:!s.e.isActivated("0f4230b0-8301-4560-aac8-39a4782d0e1f","01/10/2022","Time-to-File Metrics for File Browsing"),ODC:!1},Le={ODB:1445},Ae={ODB:-7930},Oe={ODB:60929,ODC:"ForceSwitchToDogFoodForPhoneLink"},Me={ODB:1292,ODC:"ForceSwitchToBetaForPhoneLink"},_e={ODB:1294,ODC:"ForceSwitchToProductionForPhoneLink"},De={ODB:1077,ODC:"ForceUseMockAPIForPhoneLink"},Pe={ODB:1577,ODC:"ForceUseV2HVCForPhoneLink"},He={ODB:60025,ODC:"EnableFeedbackForPhoneLink"},Be={ODB:-1065},je={ODB:270,OneDrive:!0},Fe={ODB:!!u.m&&60267},Ie={ODB:60502},qe={ODB:!u.g&&1177},Re={ODB:!u.g&&1668},Ue={serviceSetting:"ExternalService_bizappsflowenabled"},ze={ODB:-990,ODC:"ForceEnableAria"},We={ODB:1492},Xe={ODC:"HideExploreYourPhotosCarousel"},Ve={ODC:"HideLanguagePickerForAnonymous"},$e={ODB:719},Je={ODB:!!u.m&&491,ODC:!1,OneDrive:!1},Ke={ODB:-101},Qe={ODB:!s.e.isActivated("3dac8e1f-9e31-454a-a297-e150a263791b","11/16/2021","Enable ItemsScope AutoAction."),ODC:!s.e.isActivated("482DE0D2-5BC9-4258-8129-745BEA91C66D","10/21/2021","Enable ItemsScope AutoAction")},Ge={ODB:!1,ODC:!s.e.isActivated("482DE0D2-5BC9-4258-8129-745BEA91C66D","10/21/2021","Enable ItemsScope AutoAction")},Ye={ODC:!u.g&&!s.e.isActivated("5F12686F-52A2-4E49-A1D8-A2AE7969622E","10/29/2021","Use multiPart getItem api(ODC vroom) to avoid CORS if KS is not activated.")&&"LightspeedListViewDataPrefetch"},Ze={ODC:!u.g&&"LightspeedQuotaPrefetch"},et={ODB:!s.e.isActivated("DC975CAD-8F3C-4979-97E2-DA9970A68919","03/25/2022","Prefer isMySiteOwner check for ODB"),Fallback:!0},tt={ODB:788,OneDrive:!0},nt={ODB:1220},rt={ODC:"LoadFloodgateOnDemand"},it={ODB:60644},st={ODB:!0},ot={ODB:!!a&&-1520},ut={ODB:60186},at={ODB:1781},ft={ODB:60839},lt={ODB:60536},ct={ODB:60799},ht={ODB:a},pt={ODB:-299},dt={ODC:u.g?"EnableLightspeedInOneDriveWinApp":"WebLightspeed"},vt={ODB:1240,ODC:!0},mt={ODB:60242},gt={ODB:-298,ODC:"UseLightSpeedPltBlock"},yt={ODB:1653,ODC:"ShowPerfButton"},bt=void 0===n.p,wt=u.m&&!a&&!u.g||!u.m&&bt&&!s.e.isActivated("608E1D31-70F0-4B48-9EC3-CDCC41EA17E2","8/30/2021","Refresh the page in a SPList when closing previewer when the user is using AMD."),Et={Fallback:!s.e.isActivated("9ACCAC8B-D74D-43A2-98AA-457EADAF074D","11/5/2021","Initialze logging with OAuth support")},St={ODC:!s.e.isActivated("F7A1F6FE-3272-4B0E-AD26-70E8322C5D8F","09/15/2022","Ensure components use getDriveQuotaKey method to get the key")},xt={ODB:wt,ODC:!1},Tt={ODB:805},Nt={ODB:809},Ct={ODB:115},kt={ODB:1156},Lt={ODB:1064},At={serviceSetting:"ExternalService_bizappsflowenabled"},Ot={ODB:1821},Mt={ODB:!s.e.isActivated("72B58EAF-775A-4B01-BFF4-A083818DDF86","05/05/2022","Use on-demand implementation for DefaultClickAction")},_t={ODB:1010},Dt={ODB:1871},Pt={ODB:-403},Ht={ODB:-404},Bt={ODB:-406},jt={ODB:-407},Ft={ODB:-408},It={ODB:-409},qt={ODB:-410},Rt={ODB:-500},Ut={ODB:865,OneDrive:!0},zt={serviceSetting:"ExternalService_bizappsrequestsignoffenabled"},Wt={serviceSetting:"ExternalService_listrulesenabled"},Xt={ODB:60463},Vt={serviceSetting:"ExternalService_bizappsflowenabled"},$t={ODB:60943},Jt={ODB:60477,ODC:"UseItemsScopeInSearch"},Kt={ODB:-1315},Qt={ODB:60420},Gt={ODC:"SetDetailsLayoutAsDefault"},Yt={ODC:"SetDetailsLayoutAsDefaultExpV3"},Zt={ODB:60393},en={ODB:1427},tn={ODB:!u.g},nn={ODB:90007},rn={ODB:1619},sn={ODB:!0},on={ODB:573},un={ODB:60515},an={ODB:1302},fn={ODB:!0},ln={ODC:"Use3SFileSuggestion"},cn={ODB:l.ODB?1651:60021},hn={ODB:u.m?1954:1955},pn={ODB:-671},dn={ODB:!0,ODC:!0},vn={ODC:!s.e.isActivated("0DEAC9E8-4230-49B1-869A-55EE7D4256FC","10/22/2021","Disable silent auth frame in ODC itemsscope for anonymous users")},mn={ODC:"UseItemsScopeInAnomalies"},gn={ODC:"UseItemsScopeInAlbums"},yn={ODB:1143,ODC:"UseFilePicker80ForMoveCopy"},bn={ODC:"UseItemsScopeVroomMoveCopy"},wn={ODC:"UseItemsScopeInAllPhotosEnableIE"},En={ODC:"UseItemsScopeInAllPhotosEnableMobile"},Sn={ODC:"UseItemsScopeInAllPhotosEnableSafari"},xn={ODC:"UseItemsScopeInAllPhotos"},Tn={ODC:"UseItemsScopeInAllTags"},Nn={ODC:u.g?"EnableLightspeedInOneDriveWinApp":"UseItemsScope",ODB:!u.g||1413},Cn={ODC:"UseItemsScopeInPlaces"},kn={ODB:!0,ODC:!u.g&&"UseItemsScopeInShared"},Ln={ODC:"UseItemsScopeInSingleAlbum"},An={ODC:"UseItemsScopeInSingleTag"},On={ODC:"UseItemsScopeInSinglePlace"},Mn={ODC:"UseItemsScopeInOnThisDay"},_n={ODC:"UseItemsScopeInAllPhotosEnableInFilePicker"},Dn={ODB:!u.g},Pn={ODB:851},Hn={ODC:f},Bn={ODC:"UseItemsScopeInRestoreOperations"},jn={ODC:"UseLargeDriveItemSetPageSize"},Fn={ODC:"UseNewShareDialogForWinApp"},In={ODB:!0,ODC:"WACHostMoveToFolder"},qn={ODB:!0,ODC:"WACHostCommonFilePicker"},Rn={ODB:894,ODC:"UseOneUpTextEditor",OneDrive:!0},Un={ODC:"EnableFreeTrialForUSQRollout"},zn={ODC:"EnableUSQPreferHeaderShadowCall"},Wn={ODC:"EnableUSQOnWeb"},Xn={ODC:"DisableManageStorageForUSQ"},Vn={ODC:"EnableLoginTakeoverForUSQ"},$n={ODC:!!u.g&&"ShowPwaInstallDialogInUwpApp"},Jn={ODB:60820},Kn={ODB:60850},Qn={ODC:!0,ODB:!1},Gn={ODC:!0,ODB:!1},Yn={ODB:!!u.m||60522,ODC:!0},Zn={ODB:60626,ODC:!1},er={ODB:60801,Fallback:!1},tr={ODB:1642},nr={ODB:60916},rr={ODC:"EnableODCWebWorker"},ir={ODC:"EnableODCCustomerPromiseWebWorker"},sr={ODB:60193,ODC:"Enable1DSTelemetry"},or={ODB:1460},ur={ODB:1870},ar={ODC:"UseVroomInItemsScopeAllPhotosOtdExp"},fr={ODC:"UseVroomInItemsScopeAllPhotos"},lr={ODC:"AllowTestPhotoNotification"},cr={ODC:"UseSkipTokenForVroom"},hr={ODC:"UseVroomInItemsScopeSingleTag"},pr={ODC:"UseVroomInItemsScopeSinglePlace"},dr={ODC:"EnablePhotosCarouselOnFile"},vr={ODC:"EnablePhotosCarouselOnFileExp"},mr={ODC:"EnablePhotoStreamProvisionCheck"},gr={ODC:"EnableOdcSyncCommand"},yr={ODC:"EnableOdcSyncCommandExp"},br={ODC:"LargestFilesImprovement"},wr={ODC:"LargestFilesImprovementExp"},Er={ODC:"EnableOdcSyncInLeftNav"},Sr={ODB:60389},xr={ODB:1912},Tr={ODB:1228},Nr={ODB:1881},Cr={ODB:1905},kr={ODC:"WebAppManifest"},Lr={ODB:60428},Ar={ODC:"\tUpdateOdcUpgradeOptionApiForConvergence\t"},Or={ODC:"UpdateOdcStorageInfoApiForConvergence"},Mr={ODC:"UpdateOdcPhotoApiForConvergence"},_r={ODC:"UpdateOdcVaultApiForConvergence"},Dr={ODC:"ApplyItemsScopeToRecycleBin"},Pr={ODC:"NoFreeUpSpaceSoftLockedBannerExp"},Hr={ODC:"EnableNoFreeUpSpaceSoftLockedBanner"},Br={ODC:"NewOverquotaExperienceExp"},jr={ODC:"EnabledNewOverquotaExperience"},Fr={ODC:"NewHighquotaExperienceExp"},Ir={ODC:"EnabledFreeTrialBanner"},qr={ODC:"FreeTrialBannerExp"},Rr={ODC:"EnabledNewHighquotaExperience"},Ur={ODC:"FreeTrialInPremiumUpsell"},zr={ODC:"FreeTrialInPremiumUpsellExp"},Wr={ODC:"EnableWXPOverQuotaUpsellExp"},Xr={ODC:"EnableWXPOverQuotaUpsell"},Vr={ODB:u.m?453:-453,ODC:"EnableFloodgate"},$r={ODC:"NPSCampaignProd"},Jr={ODC:"NPSCampaignDogfood"},Kr={ODC:"NPSCampaignForceNomination"},Qr={ODC:"NPSSuiteSurvey"},Gr={ODC:"AllPhotosFpsCampaign"},Yr={ODB:60101,ODC:"FPSMoveCopy"},Zr={ODC:"NLQSSurvey"},ei={Fallback:!s.e.isActivated("65FF4CD5-ED32-43CD-B171-29E55A13704A","03/30/2023","Always use MondoPrefetch")},ti={ODB:!0},ni={ODB:1927,ODC:"ListThumbnailThrottling"},ri={ODB:-1927},ii={ODB:60335},si={ODB:60719},oi={ODB:!s.e.isActivated("a22e84e5-8586-40bd-8095-9c90ab3fad2b","12/08/2020","Use the new tile design in the more shared libraries page")},ui={ODB:876,ODC:!1},ai={ODB:577},fi={ODC:"OdcSuiteNavSearchBox"},li={ODC:"EnableSearchInFilePicker",ODB:683},ci={ODC:"EnableSearchInFilePickerHosts",ODB:1128},hi={ODB:1212},pi={ODB:651},di={ODB:650},vi={ODB:60421},mi={ODB:1328},gi={ODB:60882},yi={ODB:60201},bi={ODB:!s.e.isActivated("a393b488-dba6-431f-b6f9-383f65f2340b","4/10/2023","Protection for sensitivity label changes that are not blocked by doclib flight.")},wi={Fallback:!s.e.isActivated("0DC77B68-0CAB-4063-B386-57EFD9F26BF1","10/12/2022","Store viewParams in subEntityId")},Ei={ODB:1917},Si={ODB:!!a&&60491,ODC:!1},xi={ODB:!s.e.isActivated("74355188-3458-42A4-9DB6-5666BA79B5EB","03/02/2022","Moves transition resources to the KnockoutResourceScope as a preparation for OnDemand Knockout")},Ti={ODB:1344},Ni={ODB:-7007},Ci={ODB:1877},ki={ODB:1931},Li={ODB:60947},Ai={ODB:1396},Oi={ODB:60713},Mi={ODB:60561},_i={ODB:1669},Di={ODB:60753},Pi={ODB:60291},Hi={ODB:1620},Bi={ODB:60046},ji={ODB:60063},Fi={ODB:1805},Ii={ODB:1622},qi={ODB:60472},Ri={ODB:1320},Ui={ODB:60029},zi={ODB:1960},Wi={ODB:1319},Xi={ODB:606},Vi={ODB:1317},$i={ODB:60591},Ji={ODB:60199},Ki={ODB:u.m?-60005:-60032},Qi={ODB:-1249},Gi={ODB:60744},Yi={ODB:-2006,ODC:"EnableFilePickerPhotosPivot"},Zi={ODB:-2007,ODC:"EnableFilePickerSharedPivot"},es={ODB:1741,ODC:"ItemsScopePureReactDragDrop"},ts={ODB:-2008},ns={ODB:60730},rs={ODB:60126},is={ODB:1424},ss={ODB:17206},os={ODB:1825},us={ODB:!1},as={ODB:!1},fs={ODB:60160},ls={ODB:60714},cs={ODB:-2021},hs={ODB:1280},ps={ODB:60390},ds={ODB:60100},vs={ODB:60738},ms={ODB:1192,ODC:"ProgressToastsNotifications"},gs={ODB:-999999},ys={ODB:1101},bs={ODB:!s.e.isActivated("f8821413-7078-41bf-b2f4-f23a04fb160a","05/11/2021","Log error in PrefetchListData method")},ws={ODB:!s.e.isActivated("be72c753-c1ba-4ab0-ad2a-8b72581fe3a0","05/30/2021","Remove fixed height from suite nav at 400% zoom"),ODC:!1};function Es(){return s.e.isActivated("74ca0a28-3aba-41fc-a2b7-18ceea743839","10/19/2022","Customer Promise events for ASHA")}function Ss(){return s.e.isActivated("1c086a60-15dd-4b07-a770-9c68f0573722","04/03/2023","Document generation customer Promise events for ASHA")}var xs={ODB:1207},Ts={ODB:-1207},Ns={ODB:60667},Cs={ODB:1326},ks={ODB:1070},Ls={ODB:60061},As={ODB:60583},Os={ODB:!1,ODC:"UseTokenCacheForOAuth",OneDrive:!1},Ms={ODC:"EnableCooldownAfterAuthFlow"},_s={ODC:"UseNewShareDialog"},Ds={ODC:"EnableMsaOauthErrorRedirect"},Ps={ODC:"FamilySharing"},Hs={ODB:60868},Bs={ODB:!s.e.isActivated("4149C961-3AC9-4275-B8FD-F9FD97843F5A","01/06/2023","Enable cookie refresh in Teams File Browser")},js={ODB:-5432},Fs={ODB:-5433},Is={ODB:1987},qs={ODB:60297},Rs={ODB:1216},Us={ODB:1099},zs={ODB:1501},Ws={ODB:60241},Xs={Fallback:!s.e.isActivated("CC7D2937-5E6E-4604-AAC5-E5A8DD34BFFB","11/08/2022","Flush telemetry before notifying Picker host")},Vs={Fallback:!s.e.isActivated("2A89B57A-0069-4F50-AAD5-3B931C8EF512","03/08/2023","Enable open on drag-hover")},$s={ODB:60944},Js={Fallback:!s.e.isActivated("00783027-B2E9-4B88-82FB-C2921BF253B2","03/18/2023","Enable Drag/Drop copy")},Ks={ODB:1279},Qs={ODB:60118},Gs={ODB:60047},Ys={ODB:!s.e.isActivated("63B21C89-2740-44A9-980B-DDA8E2689DAA","07/21/2021","Do not invalidate source location when performing a copy"),ODC:!s.e.isActivated("63B21C89-2740-44A9-980B-DDA8E2689DAA","07/21/2021","Do not invalidate source location when performing a copy")},Zs={ODB:60243,ODC:!0},eo={ODB:60880,ODC:!0},to={ODB:1146,ODC:!0},no={ODB:1759,ODC:!0},ro={ODB:60221,ODC:!0},io={ODB:60889},so={ODB:1799},oo={ODB:1793},uo={ODB:1800},ao={ODB:60928},fo={ODB:405},lo={ODB:149},co={ODB:1170},ho={ODB:563},po={ODB:1066},vo={ODB:1517},mo={serviceSetting:"ExternalService_isodbsubstratesearchenabled"},go={ODB:556,Fallback:!0},yo={ODB:60227},bo={ODB:1789},wo={ODC:"FixRumOneScenarioIdForOneUp"},Eo={ODC:"DisableScrollInLightspeedPhotoViews"},So={ODC:!s.e.isActivated("60FAB98B-2A5D-4153-B69A-46A9C7C4B6D7","11/17/2021","Use SelectionHelper to get the current item")},xo={ODC:!s.e.isActivated("CCA9C934-1E36-4308-B93D-0025EAAECC37","11/17/2021","Use SelectionHelper to get the current item in AddToAlbumExecutor")},To={ODC:!s.e.isActivated("EB5778E9-2AB1-4A93-AED8-64615D06F8D6","03/01/2022","Show notification banner in Lightspeed")},No={ODC:!s.e.isActivated("71881921-E770-4A04-A8CD-CA451918151D","12/14/2022","Make upsell related API calls in prefetch")},Co=[Pn],ko="TryNewFeature",Lo=90084,Ao={ODB:60674},Oo=function(e){if(Co.some(function(t){return!(t.ODB&&t.ODB!==e.ODB||t.ODC&&t.ODC!==e.ODC)})){var t=window.location.search;t&&"?"===t.charAt(0)&&(t=t.substr(1));var n=r.e(t),i=n&&n[ko];return"true"===i||"1"===i}return!1},Mo=function(){var e,t,n,r,i=(e=navigator.userAgent,t=e.substring(e.indexOf("OneDriveWinApp")),n=t&&t.split("/"),{winappMajorVersion:(r=u.g&&(n.length>1?n[1].split("."):t))?parseInt(r[0],10):"-1",winappMinorVersion:r?parseInt(r[1],10):"-1",winappPatchVersion:r?parseInt(r[2],10):"-1"}),s=i.winappMajorVersion,o=i.winappMinorVersion;return!(s<19||19===s&&(o<23||23===o&&i.winappPatchVersion<7))},_o=u.w&&u.w.IsIEDisabledForItemsScope,Do=function(e){return s.e.isActivated("ff60da5f-a9ea-432e-9d7b-d58b8f7519ba","2/19/2021","ServiceConfigSettingKillSwitch")?1===Number(Po(e)):1===Number(Po(e))||"true"===Po(e)},Po=function(e){if(u.w&&u.w.farmSettings)return u.w.farmSettings[e]},Ho=function(e){return e.serviceSetting?Do(e.serviceSetting):(!_o||e!==Pn)&&(i.n.isFeatureEnabled(e)||Oo(e))},Bo=u.g?function(e){if(!Mo())return!1;switch(e){case Dn:case qe:return Ho(e={ODB:1211});case Fn:return Ho(e={ODC:"UseNewShareDialogForWinApp"});default:return Ho(e)}}:Ho,jo={ODB:60340},Fo={ODB:60269},Io={ODB:60613},qo={ODB:60902},Ro={ODB:60658},Uo={ODB:1299},zo={ODB:1282},Wo={ODB:1399},Xo={ODB:1757}},function(e,t,n){"use strict";var r=n(210);n.d(t,"e",function(){return r.e})},function(e,t,n){"use strict";n.d(t,"L",function(){return u});n.d(t,"l",function(){return a});n.d(t,"m",function(){return f});n.d(t,"q",function(){return l});n.d(t,"I",function(){return c});n.d(t,"h",function(){return h});n.d(t,"g",function(){return p});n.d(t,"C",function(){return d});n.d(t,"A",function(){return v});n.d(t,"O",function(){return m});n.d(t,"P",function(){return g});n.d(t,"B",function(){return y});n.d(t,"i",function(){return b});n.d(t,"b",function(){return w});n.d(t,"F",function(){return E});n.d(t,"D",function(){return S});n.d(t,"e",function(){return x});n.d(t,"f",function(){return T});n.d(t,"k",function(){return N});n.d(t,"s",function(){return C});n.d(t,"y",function(){return s});n.d(t,"E",function(){return k});n.d(t,"a",function(){return L});n.d(t,"M",function(){return A});n.d(t,"x",function(){return O});n.d(t,"_",function(){return M});n.d(t,"n",function(){return _});n.d(t,"d",function(){return D});n.d(t,"S",function(){return P});n.d(t,"w",function(){return H});n.d(t,"o",function(){return B});n.d(t,"u",function(){return j});n.d(t,"r",function(){return F});n.d(t,"p",function(){return I});n.d(t,"c",function(){return q});n.d(t,"t",function(){return R});n.d(t,"N",function(){return U});n.d(t,"v",function(){return z});n.d(t,"R",function(){return W});n.d(t,"U",function(){return X});n.d(t,"j",function(){return o.e});n.d(t,"H",function(){return V});n.d(t,"T",function(){return $});var r=n(3),i=(n(294),new r.t("itemComment"),n(250)),s=new r.t("list"),o=(new r.t("oAuthTokenDataSource"),new r.t("siteScripts"),n(460),n(348)),u=(new r.t("recentList"),new r.t("folder"),new r.t("appsItem"),new r.t("externallySharedItem"),new r.t("popularItem"),new r.t("subsiteItem"),new r.t("mostViewsItem"),new r.t("mostViewersItem"),new r.t("settings")),a=new r.t("getItem"),f=new r.t("items"),l=(new r.t("versionControl"),new r.t("versionHistory")),c=new r.t("vault"),h=i.e,p=(new r.t("peopleCardFactory"),new r.t("peopleCard"),new r.t("language"),new r.t("languagePicker")),d=(new r.t("leftNav"),new r.t("search")),v=new r.t("sharing"),m=(new r.t("sharingLightSpeed"),new r.t("sharingData")),g=(new r.t("groups"),new r.t("suiteNav")),y=(new r.t("iosMobileAppPath"),new r.t("url")),b=(new r.t("universalAnnotation"),new r.t("download")),w=(new r.t("footer"),new r.t("manifests")),E=(new r.t("itemActivityFeed"),new r.t("itemActivityFeedHelper"),new r.t("itemActivityFeedSharingHelper"),new r.t("userInfo")),S=(new r.t("storageInfo"),new r.t("storageOptions")),x=new r.t("album"),T=(new r.t("tag"),new r.t("shareByLink"),new r.t("folderItemCount")),N=(new r.t("photo"),new r.t("subscriptions"),new r.t("analytics"),new r.t("feedback"),new r.t("sendFeedback")),C=new r.t("embed"),k=(new r.t("application"),new r.t("policyTip")),L=(new r.t("policyTipLightSpeed"),new r.t("customAction"),new r.t("taxonomy"),new r.t("web"),new r.t("floodgate")),A=new r.t("shortcutsDS"),O=(new r.t("encoding"),new r.t("rating")),M=(new r.t("publish"),new r.t("videoItem"),new r.t("sites")),_=new r.t("copy"),D=(new r.t("upsell"),new r.t("notifications"),new r.t("command")),P=(new r.t("processFilters"),new r.t("quota"),new r.t("itemColumn"),new r.t("bundle"),new r.t("itemPicker"),new r.t("site"),new r.t("pushChannel")),H=(new r.t("itemAutoRefresh"),new r.t("loginApp"),new r.t("mruRecent")),B=(new r.t("pdf"),new r.t("zip"),new r.t("url2"),new r.t("attachments"),new r.t("spotlight"),new r.t("error"),new r.t("promotedPhotos"),new r.t("fileHandler")),j=new r.t("fileHandlerFromCache"),F=(new r.t("recycleBin"),new r.t("deleteRestore")),I=new r.t("instrumentation"),q=(new r.t("shadowCall"),new r.t("graph")),R=(new r.t("formula"),new r.t("appUrl"),new r.t("graphUrl"),new r.t("batchUploaderType")),U=(new r.t("vroomItemIdentityProcessor"),new r.t("preAuth"),new r.t("peopleService"),new r.t("schema")),z=(new r.t("restore"),new r.t("restore"),new r.t("restoreActivities"),new r.t("inAppMessaging"),new r.t("notificationSettings"),new r.t("itemInvalidator")),W=(new r.t("itemUpdator"),new r.t("wopiFrame"),new r.t("wrs"),new r.t("excel"),new r.t("winAppCommunicator")),X=new r.t("wip"),V=(new r.t("worker"),new r.t("checkUserAccessDataSource"),new r.t("userExpiration"),new r.t("itemMuteNotificationDataSource"),new r.t("ticketRedeemer")),$=(new r.t("recommendList"),new r.t("reportAbuse"));new r.t("requestReview"),new r.t("listsFomeFREDataSource"),new r.t("removeFromShareWithMeList")},,,,function(e,t,n){"use strict";var r=n(16);t.e=r.e},function(e,t,n){"use strict";var r=n(0),i=n(316),s=n(163),o=n(7),u=n(6),a=n(30),f=n(49),l=n(17),c=n(5),h=n(21),p=n(47),d=n(154),v=n(77),m=n(16),g=n(351),y=n(465),b=n(222),w=m.t.isActivated("2f42fb7d-6b1f-4e1e-b447-33d94f689c0d","3/15/2023","Killswitch for logging asha related props in the customerpromise."),E=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="BaseAction";var i=r,s=i.resources,o=i.observables,a=n.urlDataSource,f=void 0===a?s.consume(u.B.optional):a,l=n.instrumentationProvider,c=void 0===l?s.consume(p.i.optional):l;r._BaseAction_urlDataSource=f;r._BaseAction_instrumentationProvider=c;r.isQosLogged=!0;r.logStartEnd=!1;r.enableCustomerPromiseLogging=!1;r._executingInstanceCount=o.create(0);var h={deferEvaluation:!0};r.isAvailable=o.pureCompute(r._computeIsAvailable,h);r.isToggled=o.pureCompute(r._computeIsToggled,h);r.isExecuting=o.pureCompute(r._computeIsExecuting,h);return r}t.prototype.execute=function(e){var t,n,r,i=this,s=this.isQosLogged?this.onCreateQosEvent(e):void 0,o=s?this.getEngagement():void 0;try{if(s){!w&&this.customerPromiseStartSchema&&(n=new g.e(this.customerPromiseStartSchema));this._logEngagementEvent(s.data.extraData,o);this.trackUserAction(this.name)}if(!(t=this.instrumentOnExecutionWithCustomerPromise(this.onExecute(e,s))))throw new Error("Action did not return a promise")}catch(e){f.e.log(e);r=e}if(t){this._executingInstanceCount(this._executingInstanceCount.peek()+1);t.then(function(e){i._executingInstanceCount(i._executingInstanceCount.peek()-1);if(s){s.end(e);n&&n.end({resultType:h.t.Success})}},function(t){i._executingInstanceCount(i._executingInstanceCount.peek()-1);if(t&&!a.n.isCanceled(t)){f.e.log(t);i._logCustomerPromiseEndWithError(n,t)}if(s){s.end(i.onCreateErrorEventArg(e,t,!1));i._logCustomerPromiseEndWithError(n,t)}})}else{if(s){s.end(this.onCreateErrorEventArg(e,r,!0));this._logCustomerPromiseEndWithError(n,r)}t=a.n.reject(r)}return t};t.prototype.onCreateQosEvent=function(e){var t=this._BaseAction_urlDataSource;return new i.e({name:this.name,pageType:t&&l.e[t.getPageType()]||"",queryType:t&&c.e[t.getQueryType()]||"",logStartEnd:this.logStartEnd})};t.prototype.onCreateErrorEventArg=function(e,t,n){return t&&a.n.isCanceled(t)?{resultType:h.t.ExpectedFailure,resultCode:"Canceled"}:t instanceof v.e?{resultType:t.isExpected?h.t.ExpectedFailure:h.t.Failure,resultCode:t.code,error:t.message,extraData:{CorrelationId:t.correlationId}}:{resultType:h.t.Failure,resultCode:n?"NoPromiseReturned":"PromiseFailed",error:t?"".concat(t.message||""):void 0}};t.prototype.onExecute=function(e,t){var n={resultType:h.t.Failure};return a.n.resolve(n)};t.prototype.instrumentOnExecutionWithCustomerPromise=function(e){var t=e;if(this.enableCustomerPromiseLogging){var n=this._BaseAction_urlDataSource,i=new g.e({scenario:this.name,extraData:{pageType:n&&l.e[n.getPageType()]||"",queryType:n&&c.e[n.getQueryType()]||""}});t=e.then(function(e){var t=e.resultCode,n=e.resultType,s=e.error,o=e.extraData;i.end({resultType:n,errorCode:t,extraData:Object(r.__assign)(Object(r.__assign)({},o),{error:s})});return e}).catch(function(e){var t;if(a.n.isCanceled(e))t={resultType:h.t.ExpectedFailure,errorCode:"Canceled"};else{var n=Object(b.e)(e),s=n.resultType,o=n.resultCode,u=n.error,f=n.extraData;t={resultType:s,errorCode:o,extraData:Object(r.__assign)(Object(r.__assign)({},f),{error:u})}}i.end(t);throw e})}return t};t.prototype.onIsAvailable=function(){return!0};t.prototype.onIsToggled=function(){return!1};t.prototype.getEngagement=function(){return this.resources.consume(d.e)};t.prototype.trackUserAction=function(e){var t=this._BaseAction_instrumentationProvider;if(t){var n=this.getEngagement();t.userExecuteAction({name:e,engagement:n})}};t.prototype._logCustomerPromiseEndWithError=function(e,t){e&&e.end(Object(y.e)(t))};t.prototype._computeIsAvailable=function(){return!!this.onIsAvailable()};t.prototype._computeIsToggled=function(){return!!this.onIsToggled()};t.prototype._computeIsExecuting=function(){return this._executingInstanceCount()>0};t.prototype._logEngagementEvent=function(e,t){void 0===t&&(t=this.isQosLogged?this.getEngagement():void 0);if(t){var n=this._BaseAction_instrumentationProvider;t.logData({name:this.name,isIntentional:this.isExecutionIntentional,location:"NA",usageType:s.e[s.e.Click],currentPage:n&&n.currentPageName()||"NA",previousPage:n&&n.previousPageName()||"NA",extraData:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},e||{}),n&&n.getEngagementData()||{}),{isAction:!0})})}};t.dependencies=Object(r.__assign)(Object(r.__assign)({},o.n.dependencies),{urlDataSource:u.B,instrumentationProvider:p.i.optional});return t})(o.n);t.e=E},,function(e,t,n){"use strict";n.d(t,"i",function(){return i});n.d(t,"s",function(){return s});n.d(t,"l",function(){return o});n.d(t,"S",function(){return u});n.d(t,"g",function(){return a});n.d(t,"t",function(){return f});n.d(t,"e",function(){return l});n.d(t,"b",function(){return c});n.d(t,"c",function(){return h});n.d(t,"r",function(){return p});n.d(t,"y",function(){return d});n.d(t,"w",function(){return v});n.d(t,"u",function(){return m});n.d(t,"a",function(){return g});n.d(t,"E",function(){return y});n.d(t,"o",function(){return b});n.d(t,"p",function(){return w});n.d(t,"d",function(){return E});n.d(t,"h",function(){return S});n.d(t,"m",function(){return x});n.d(t,"n",function(){return T});n.d(t,"f",function(){return N});n.d(t,"v",function(){return C});var r=n(3),i=new r.t("currentItem"),s=new r.t("currentItemSet"),o=new r.t("groupThrottle"),u=(new r.t("focusItem"),new r.t("focusItemSet"),new r.t("dataManagerMapper"),new r.t("viewParams")),a=(new r.t("originalViewParams"),new r.t("itemsSelection")),f=(new r.t("selectionIndexResolver"),new r.t("autoFillParams")),l=new r.t("actionMap"),c=new r.t("slideshowState"),h=new r.t("isDebugWindowVisible"),p=new r.t("canUserSelect"),d=new r.t("promiseTracker"),v=(new r.t("currentPage"),new r.t("currentSelectionModelGroup"),new r.t("useMobileList")),m=new r.t("disableDotDotDotHeroCommand"),g=new r.t("disableShareHeroCommand"),y=(new r.t("uploadActionHandler"),new r.t("vaultTeachingBubble")),b=new r.t("currentView"),w=(new r.t("currentLayout"),new r.t("backToClassicUrl"),new r.t("isItemSetRendered")),E=new r.t("isPremiumUpsellVisible"),S=new r.t("isFamiliesOrGroupsFreVisible"),x=new r.t("isVaultFreVisible"),T=(new r.t("hasUpsellBeenShownAlready"),new r.t("canModifySchema")),N=new r.t("displayImageTileNames"),C=new r.t("isSharingSectionExpanded");new r.t("hasSeenPositioningThisSession"),new r.t("mobileUpsellDismissedThisSession"),new r.t("mobileOfficeAppUpsellDismissedThisSession"),new r.t("didUserEnterPasswordForFile")},,function(e,t,n){"use strict";n.d(t,"t",function(){return h});n.d(t,"j",function(){return d.E});n.d(t,"e",function(){return A});n.d(t,"v",function(){return O});n.d(t,"m",function(){return M});n.d(t,"o",function(){return _});n.d(t,"E",function(){return D});n.d(t,"N",function(){return P});n.d(t,"x",function(){return H});n.d(t,"L",function(){return B});n.d(t,"k",function(){return j});n.d(t,"r",function(){return F});n.d(t,"M",function(){return I});n.d(t,"n",function(){return q});n.d(t,"_",function(){return R});n.d(t,"O",function(){return U});n.d(t,"D",function(){return z});n.d(t,"l",function(){return W});n.d(t,"s",function(){return X});n.d(t,"u",function(){return V});n.d(t,"p",function(){return $});n.d(t,"a",function(){return J});n.d(t,"T",function(){return K});n.d(t,"H",function(){return Q});n.d(t,"b",function(){return G});n.d(t,"c",function(){return Y});n.d(t,"g",function(){return Z});n.d(t,"w",function(){return ee});n.d(t,"f",function(){return te});n.d(t,"i",function(){return ne});n.d(t,"P",function(){return re});n.d(t,"d",function(){return ie});n.d(t,"y",function(){return se});n.d(t,"A",function(){return oe});n.d(t,"C",function(){return ue});n.d(t,"h",function(){return ae});n.d(t,"S",function(){return le});n.d(t,"B",function(){return ce});var r,i=n(0),s=n(20),o=n(45),u=n(142),a=n(5),f=n(75),l=n(17),c=n(96);(function(e){e[e.Feed=0]="Feed";e[e.Story=1]="Story"})(r||(r={}));var h,p=r,d=n(32),v=n(2),m=n(29),g=n(140),y=n(183),b=n(57),w=n(151),E=n(71),S=n(110),x=n(16),T=n(350),N=(n(533),n(93));(function(e){e[e.all=31]="all";e[e.folders=2]="folders";e[e.photos=8]="photos";e[e.documents=16]="documents";e[e.music=32]="music"})(h||(h={}));var C={ch:"https://www.microsoft.com/de-ch/microsoft-schweiz/unternehmen/impressum.aspx",at:"https://www.microsoft.com/de-at/unternehmen/rechtliches/impressum-corp.aspx",de:"https://www.microsoft.com/germany/siteservices/impressum/default.mspx"},k=x.e.isActivated("B658585F-0A1A-4AAD-A6C8-5C88474A1FA7","11/08/2021","Restrict OneUp page type assignment to the default scenario in the switch statement"),L=!x.e.isActivated("04490DD5-293D-4466-9D41-2C7345A66BC3","02/17/2022","Default doesCidMatchViewerId to false in case of unauth shared scenarios with no CID in URL"),A=x.e.isActivated("E29AAB51-52AB-4E89-8A66-5BCC6CA3B5F4","02/06/2023","Preserve view params start with wd and pass it to wac");x.e.isActivated("DFFB77B6-8059-4C5F-B2B3-8E96E04C4B1F","01/30/2023","Add check for the largest files view");function O(e){var t;void 0===e&&(e={});var n=((t={}).id=e.id||"root",t.cid=e.cid||d.E,t.driveId=e.driveId||"",t.groupId=e.groupId||"",t.qt="".concat(e.qt||"").toLowerCase(),t.did=e.did||"",t.q=e.q||"",t.sft=e.sft||"",t.beginDate=e.beginDate||"",t.endDate=e.endDate||"",t.ft=e.ft||"",t.ext=e.ext||"",t.df=e.df||"",t.sp=e.sp||"",t.ocid=e.ocid||"",t["WT.mc_id"]=e["WT.mc_id"]||"",t.locationFilter=e.locationFilter||"",t.tagFilter=e.tagFilter||"",t.onThisDay=e.onThisDay||"",t.onThisMonth=e.onThisMonth||"",t.lastWeekPreviousYears=e.lastWeekPreviousYears||"",t.scope=e.scope||"",t.useUtilityFiltering=void 0===e.useUtilityFiltering?"":e.useUtilityFiltering,t.startDate=e.startDate||"",t.internalPath=e.internalPath||"",t.psId=e.psId||"",t.u=e.u||"",t.searchsessionid=e.searchsessionid||"",t.mojDate=e.mojDate||"",t.moj=e.moj||"",t.acType=e.acType||"",t.psId=e.psId,t.psPostId=e.psPostId,t.psRIds=e.psRIds||"",t.pssc=e.pssc||"",t);return s.n(n,void 0,!0)}function M(e){return s.e(e)}function _(e){var t=Object(i.__assign)({},e);if(t.parId||t.parQt||t.parCid){delete t.id;delete t.qt;delete t.internalPath;if(t.parId){t.id=t.parId;delete t.parId}if(t.parQt){t.qt=t.parQt;delete t.parQt}if(t.parCid){t.cid=t.parCid;delete t.parCid}}delete t.u;return O(t)}function D(e,t){var n;switch(e.v){case"1":case"FolderPickerView":case"2":case"FilePickerView":case"pickerconsent":n=l.e.FilePicker;break;case"3":n=l.e.Files;break;case"photos":n=l.e.Photos;break;case"photoStream":n=l.e.PhotoStream;break;case"managestorage":n=l.e.StorageInfo;break;case"photopreferences":n=l.e.PhotoPreferences;break;case"tagpreferences":n=l.e.TagPreferences;break;case"error":n=l.e.Error;break;case"RansomwareDetection":n=l.e.RansomwareDetection;break;case"syncplaceholders":n=l.e.SyncPlaceholders;break;case"upgrade":n=l.e.StorageOptions;break;case"restore":n=l.e.Restore;break;case"TextFileEditor":n=l.e.TextFileEditor;break;case"syncpremiumupsell":n=l.e.SyncOnboarding;break;case"validatepermission":n=l.e.ValidatePermission;break;case"requestaccess":n=l.e.RequestAccess;break;case"unlock":n=l.e.Unlock;break;case"ManageVault":n=l.e.ManageVault;break;case"traceme":n=l.e.TraceMe;break;case"convergence":n=l.e.Convergence;break;case"documentoptions":n=l.e.DocumentOptions;break;case"devicebackups":n=l.e.DeviceBackups;break;case"search":n=l.e.Search;break;case"NotificationOptions":n=l.e.NotificationOptions;break;default:if(Object(d.u)())n=l.e.AccountChooser;else{if(!k&&W(e)&&t)return l.e.OneUp;n=l.e.Files}}return k&&W(e)&&t?l.e.OneUp:n}function P(e){var t;switch(M(_(e)).qt){case"mru":t=a.e.Recent;break;case"recyclebin":t=a.e.RecycleBin;break;case"sharedby":t=a.e.SharedWithMe;break;case"sharedbyme":t=a.e.SharedByMe;break;case"search":t=a.e.Search;break;case"allmyphotos":t=a.e.AllMyPhotos;break;case"photostream":t=a.e.PhotoStream;break;case"selection":t=a.e.Selection;break;default:t=Object(d.l)(e)||Object(d.c)(e)||!x.e.isActivated("4D0BEE0C-FCE7-4D8F-B6C7-3BC94830A252")&&(Object(d.a)(e)||Object(d.y)(e)||Object(d.b)(e)||Object(d.w)(e))?a.e.AllMyPhotos:Object(d.u)()?"false"===e.load_login?a.e.AccountChooserMobileSDK:a.e.AccountChooserPicker:a.e.Files}return t}function H(e){return"photos"===e.v&&Object(f.e)(P(e))?c.e.AllMyPhotos:Object(d.c)(e)?c.e.allTags:Object(d.w)(e)?c.e.singleTag:Object(d.l)(e)?c.e.allPlaces:Object(d.b)(e)?c.e.singlePlace:Object(d.d)(e)?c.e.onThisDay:Object(d.v)(e)?c.e.onThisMonth:Object(d.p)(e)?c.e.lastWeekPreviousYears:Object(d.f)(e)?c.e.AllMyPhotos:Object(d.a)(e)?c.e.Albums:Object(d.y)(e)?c.e.singleAlbum:"photos"===e.v?c.e.AllMyPhotos:null}function B(e,t){return t===l.e.Photos?"".concat(c.e[H(e)]):t===l.e.PhotoStream?"".concat(p[(function(e){return e.psId?p.Story:p.Feed})(e)]):""}function j(e){var t,n;void 0===e&&(e=a.e.Files);var r=((t={})[a.e.Files]="",t[a.e.Recent]="mru",t[a.e.SharedWithMe]="sharedby",t[a.e.SharedByMe]="sharedbyme",t[a.e.RecycleBin]="recyclebin",t[a.e.AllMyPhotos]="allmyphotos",t[a.e.PhotoStream]="photostream",t[a.e.Selection]="selection",t);return O(((n={}).qt=r[e],n))}function F(e){return e.authkey}function I(e){return!(e.mid||e.mcid||"sharedby"!==e.qt&&q(e)||U(e))}function q(e){var t=e.cid;return!(L&&!t&&d.h)&&R(t)}function R(e){var t=d.E;return!e||Object(T.e)(e,t)}function U(e){return Object(d.f)(e)||Object(d.a)(e)||Object(d.y)(e)||Object(d.c)(e)||Object(d.l)(e)||Object(d.d)(e)||Object(d.v)(e)||Object(d.p)(e)}function z(e){return!(!e.mid||!e.mcid)}function W(e){var t=null;if(e.parId||e.parQt||e.parCid){(t={}).id=e.id;t.qt=e.qt;t.cid=e.cid;t.internalPath=e.internalPath;Object(v.isFeatureEnabled)(v.UpdateOdcPhotoApiForConvergence)&&(t.driveId=e.driveId);delete t.u}return t&&O(t)||null}function X(e){var t=e.action||"";return m.e[t.toLowerCase()]||m.t.none}function V(){return window.location.protocol+"//"+window.location.host}function $(e){var t=e.itemKey,n=e.itemInfo,r=e.page,s=e.action,o=e.preserveAction,u=void 0!==o&&o,c=e.viewParams,p=n||{},v=p.itemIsPlaceholder,y=p.itemVirtualItemType,w=p.itemExtension,E=p.itemType,S=M(t),x=Object(i.__assign)({},S),T=K(c);void 0!==r&&(T.v=(function(e,t){var n,r=t.v;switch(e){case l.e.FilePicker:n=fe(r)?r:"FilePickerView";break;case l.e.TextFileEditor:n="TextFileEditor";break;case l.e.Photos:n="photos";break;case l.e.RansomwareDetection:n="RansomwareDetection";break;default:case l.e.Files:}return n})(r,c));var N=!1,C=!!w&&Object(g.n)(w,E);if(v)switch(x.id){case"tags":case"places":case"albums":T.v="photos";N=!0}else{"TextFileEditor"===T.v&&(C||(T.v=""));switch(y){case b.e.Album:case b.e.AlbumRoot:case b.e.Tag:case b.e.TagsRoot:T.v="photos";N=!0}}if("allmyphotos"===S.qt){x.v="photos";N=!0;if("true"===S.onThisDay||"true"===S.onThisMonth||"true"===S.lastWeekPreviousYears){c&&c.startDate&&(x.startDate=c.startDate);c&&c.cid&&(x.cid=c.cid)}}if("photostream"===S.qt){x.v="photoStream";x.psShareId=c.psShareId}var k=P(S);C||!n||N||k===a.e.Search||k===a.e.AllMyPhotos||k===a.e.PhotoStream||(x.v="");!C&&Object(f.e)(k)&&("photos"!==T.v&&"photoStream"!==T.v||Object(d.n)(S)!==h.photos.toString())&&(x.v="");fe(T.v)&&(x.v=T.v);delete T.scope;delete x.u;var L=X(c);s?x.action=s&&m.t[s]&&m.t[s].toLowerCase()||"":u&&L&&(L===m.t.showProperties&&x.o||(x.action=m.t[L].toLowerCase()));Object(i.__assign)(T,x);return T}function J(e,t){var n=[];n.push(V());switch(e){case 0:n.push("/");break;case 1:n.push(u.r);break;case 2:n.push(te());break;default:n.push(te())}n.push("?");n.push(t);return n.join("")}function K(e){var t,n=((t={}).iam=e.iam,t.ticket=e.ticket,t.authkey=e.authkey,t.redeem=e.redeem,t.v=e.v,t.invref=e.invref,t.invsrc=e.invsrc,t.client_id=e.client_id,t.scope=e.scope,t.domain=e.domain,t.referrer=e.referrer,t.crid=e.crid,t.auth=e.auth,t.picker=e.picker,t.filePicker=e.filePicker,t.expectsBusiness=e.expectsBusiness,t.sc=e.sc,t.simulateunauth=e.simulateunauth,t);for(var r in e)0===r.indexOf("EXPExperimentTest_e")&&(n[r]=e[r]);var i=e["WT.mc_id"],s=e.ocid;if(i){n["WT.mc_id"]=i;n.ocid=s||i}if(!A)for(var o in e)o.startsWith("wd")&&(n[o]=e[o]);return n}function Q(e,t){void 0===t&&(t=!1);return t||o.t.si?ne(re(e)):e}function G(e){var t,n=((t={}).ocid=e.ocid||e["WT.mc_id"],t.v="managestorage",t);return Q("#"+s.n(n,null,!0))}function Y(){var e=N.e.getMarket(),t=e&&e.split("-")[1];return t&&C[t.toLowerCase()]}function Z(){return"https://go.microsoft.com/fwlink/?linkid=2100224"}function ee(e){var t,n=e.wtcParam,r=e.viewParams,i=e.hideLeftNav,o=((t={}).ocid=r.ocid||r["WT.mc_id"]||n,t.v="upgrade",t.hideLeftNav=i,t),u="/"===window.location.pathname;return Q("".concat(u?"#":"/?").concat(s.n(o,null,!0)))}function te(){return window.location.pathname}function ne(e){var t=o.t.signInUrl;if(window.location.href.indexOf("iam=")>-1){t+="&redirect_uri={0}";e=V()+"/business"}else t+="&ru={0}&wreply={0}";return E.o(t,y.e.encodeURIComponent(e||window.location.href))}function re(e){0===e.indexOf("#")&&(e=J(2,e.substring(1)));return e}function ie(e){var t=e.additionalViewParams,n=$(Object(i.__assign)({},e));t&&Object(S.e)(n,t);t&&t.sc||delete n.sc;return"#"+s.n(n,null,!0)}function se(){return V()+"/marketblockerror.aspx"}function oe(e){var t={};t.id=e.id;t.challengeToken=e.authkey;t.v="validatepermission";return V()+"?"+s.n(t,null,!0)}function ue(e){var t={};t.id=e.id;t.challengeToken=e.authkey;t.v="requestaccess";return V()+"?"+s.n(t,null,!0)}function ae(e){void 0===e&&(e={});var t=Object(i.__assign)({},e),n=e.ithint;if(n){switch(n.split(",")[0]){case"album":t.v="photos"}delete t.ithint}a.e.AllMyPhotos===P(e)&&(t.v="photos");switch(e.v){case"pickerconsent":t.v="pickerconsent";break;case"FolderPickerView":case"1":t.v="FolderPickerView";break;case"FilePickerView":case"2":t.v="FilePickerView";break;case"RansomwareDetection":t.v="RansomwareDetection";break;case"3":delete t.v}return t}function fe(e){var t;switch(e){case"FilePickerView":case"2":case"FolderPickerView":case"1":case"pickerconsent":t=!0;break;default:t=!1}return t}function le(){var e={qt:"photostream",v:"photoStream"};return V()+"?"+s.n(e,null,!0)}function ce(e){void 0===e&&(e={filters:[]});for(var t=[],n=[],r=0,i=0,s=e.filters;i<s.length;i++){"string"==typeof(a=s[i])?t.push(a):n.push(a)}if(!t.length)for(var o=0,u=n;o<u.length;o++){var a;switch(a=u[o]){case w.e.folder:r|=7;break;case w.e.audio:r|=32;break;case w.e.media:r|=8;break;case w.e.document:r|=16;break;case w.e.any:r|=h.all}}var f=t.join(";"),l="".concat(r||""),c={};f&&(c.ext=f);l&&(c.ft=l);return c}},,function(e,t,n){"use strict";var r;(function(e){e[e.Loading=0]="Loading";e[e.Files=1]="Files";e[e.FilePicker=2]="FilePicker";e[e.FolderPicker=3]="FolderPicker";e[e.Photos=4]="Photos";e[e.TextFileEditor=5]="TextFileEditor";e[e.AccountChooser=6]="AccountChooser";e[e.StorageInfo=7]="StorageInfo";e[e.StorageOptions=8]="StorageOptions";e[e.AppData=9]="AppData";e[e.Error=10]="Error";e[e.SyncOnboarding=11]="SyncOnboarding";e[e.Share=12]="Share";e[e.OneUp=14]="OneUp";e[e.PhotoPreferences=15]="PhotoPreferences";e[e.Embed=16]="Embed";e[e.SyncPlaceholders=17]="SyncPlaceholders";e[e.Restore=18]="Restore";e[e.ValidatePermission=20]="ValidatePermission";e[e.RansomwareDetection=21]="RansomwareDetection";e[e.Settings=22]="Settings";e[e.Unlock=23]="Unlock";e[e.MobileAppUpsell=24]="MobileAppUpsell";e[e.FileRequest=26]="FileRequest";e[e.CreateList=27]="CreateList";e[e.ManageVault=28]="ManageVault";e[e.RequestAccess=29]="RequestAccess";e[e.TraceMe=30]="TraceMe";e[e.FileBrowser=31]="FileBrowser";e[e.TagPreferences=32]="TagPreferences";e[e.PhotoStream=33]="PhotoStream";e[e.Convergence=34]="Convergence";e[e.DocumentOptions=35]="DocumentOptions";e[e.DeviceBackups=37]="DeviceBackups";e[e.Search=38]="Search";e[e.NotificationOptions=39]="NotificationOptions";e[e.ContentAssembly=40]="ContentAssembly";e[e.MetaOSAuthPopup=41]="MetaOSAuthPopup";e[e.SharingSettings=301]="SharingSettings";e[e.SyncSettings=302]="SyncSettings";e[e.StorageSettings=303]="StorageSettings";e[e.AccessPolicySettings=304]="AccessPolicySettings";e[e.ComplianceSettings=305]="ComplianceSettings";e[e.NotificationSettings=306]="NotificationSettings";e[e.GeoLocations=307]="GeoLocations"})(r||(r={}));var i=r;t.e=i},function(e,t,n){var r,i,s;!(function(o){var u=this||(0,eval)("this"),a=u.document,f=u.navigator,l=u.jQuery,c=u.JSON;(function(o){i=[t,n],void 0!==(s="function"==typeof(r=o)?r.apply(t,i):r)&&(e.exports=s)})(function(e,t){function n(e,t){return(null===e||typeof e in g)&&e===t}function r(e,t){var n;return function(){n||(n=m.a.setTimeout(function(){n=o;e()},t))}}function i(e,t){var n;return function(){clearTimeout(n);n=m.a.setTimeout(e,t)}}function s(e,t){t&&t!==y?"beforeChange"===t?this.Lb(e):this.Ha(e,t):this.Mb(e)}function h(e,t){null!==t&&t.k&&t.k()}function p(e,t){var n=this.Ic,r=n[x];r.S||(this.lb&&this.Na[t]?(n.Qb(t,e,this.Na[t]),this.Na[t]=null,--this.lb):r.r[t]||n.Qb(t,e,r.s?{ia:e}:n.wc(e)))}function d(e,t,n,r){m.d[e]={init:function(e,i,s,o,u){var a,f;m.m(function(){var s=i(),o=m.a.c(s),l=(o=!n!=!o,!f);(l||t||o!==a)&&(l&&m.va.Aa()&&(f=m.a.ua(m.e.childNodes(e),!0)),o?(l||m.e.da(e,m.a.ua(f)),m.Ka(r?r(u,s):u,e)):m.e.xa(e),a=o)},null,{i:e});return{controlsDescendantBindings:!0}}};m.h.ta[e]=!1;m.e.V[e]=!0}var v,m=void 0!==e?e:{};m.b=function(e,t){for(var n=e.split("."),r=m,i=0;i<n.length-1;i++)r=r[n[i]];r[n[n.length-1]]=t};m.G=function(e,t,n){e[t]=n};m.version="3.5.0-pre";m.b("version",m.version);m.options={deferUpdates:!1,useOnlyNativeEvents:!1};m.a=(function(){function e(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}function t(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function n(e,t){e.__proto__=t;return e}function r(e,t,n,r){var i=e[t].match(g)||[];m.a.q(n.match(g),function(e){m.a.pa(i,e,r)});e[t]=i.join(" ")}var i={__proto__:[]}instanceof Array,s="function"==typeof Symbol,h={},p={};h[f&&/Firefox\/2/i.test(f.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"];h.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" ");e(h,function(e,t){if(t.length)for(var n=0,r=t.length;n<r;n++)p[t[n]]=e});var d={propertychange:!0},v=a&&(function(){for(var e=3,t=a.createElement("div"),n=t.getElementsByTagName("i");t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e",n[0];);return 4<e?e:o})(),g=/\S+/g;return{ec:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],q:function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)},o:function(e,t){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(e,t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},Tb:function(e,t,n){for(var r=0,i=e.length;r<i;r++)if(t.call(n,e[r],r))return e[r];return null},Ma:function(e,t){var n=m.a.o(e,t);0<n?e.splice(n,1):0===n&&e.shift()},Ub:function(e){for(var t=[],n=0,r=(e=e||[]).length;n<r;n++)0>m.a.o(t,e[n])&&t.push(e[n]);return t},fb:function(e,t){for(var n=[],r=0,i=(e=e||[]).length;r<i;r++)n.push(t(e[r],r));return n},La:function(e,t){for(var n=[],r=0,i=(e=e||[]).length;r<i;r++)t(e[r],r)&&n.push(e[r]);return n},ra:function(e,t){if(t instanceof Array)e.push.apply(e,t);else for(var n=0,r=t.length;n<r;n++)e.push(t[n]);return e},pa:function(e,t,n){var r=m.a.o(m.a.zb(e),t);0>r?n&&e.push(t):n||e.splice(r,1)},ka:i,extend:t,Ya:n,Za:i?n:t,D:e,Ca:function(e,t){if(!e)return e;var n,r={};for(n in e)e.hasOwnProperty(n)&&(r[n]=t(e[n],n,e));return r},ob:function(e){for(;e.firstChild;)m.removeNode(e.firstChild)},lc:function(e){for(var t=((e=m.a.W(e))[0]&&e[0].ownerDocument||a).createElement("div"),n=0,r=e.length;n<r;n++)t.appendChild(m.$(e[n]));return t},ua:function(e,t){for(var n=0,r=e.length,i=[];n<r;n++){var s=e[n].cloneNode(!0);i.push(t?m.$(s):s)}return i},da:function(e,t){m.a.ob(e);if(t)for(var n=0,r=t.length;n<r;n++)e.appendChild(t[n])},sc:function(e,t){var n=e.nodeType?[e]:e;if(0<n.length){for(var r=n[0],i=r.parentNode,s=0,o=t.length;s<o;s++)i.insertBefore(t[s],r);s=0;for(o=n.length;s<o;s++)m.removeNode(n[s])}},za:function(e,t){if(e.length){for(t=8===t.nodeType&&t.parentNode||t;e.length&&e[0].parentNode!==t;)e.splice(0,1);for(;1<e.length&&e[e.length-1].parentNode!==t;)e.length--;if(1<e.length){var n=e[0],r=e[e.length-1];for(e.length=0;n!==r;)e.push(n),n=n.nextSibling;e.push(r)}}return e},uc:function(e,t){7>v?e.setAttribute("selected",t):e.selected=t},ab:function(e){return null===e||e===o?"":e.trim?e.trim():e.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},od:function(e,t){e=e||"";return!(t.length>e.length)&&e.substring(0,t.length)===t},Nc:function(e,t){if(e===t)return!0;if(11===e.nodeType)return!1;if(t.contains)return t.contains(3===e.nodeType?e.parentNode:e);if(t.compareDocumentPosition)return 16==(16&t.compareDocumentPosition(e));for(;e&&e!=t;)e=e.parentNode;return!!e},nb:function(e){return m.a.Nc(e,e.ownerDocument.documentElement)},Rb:function(e){return!!m.a.Tb(e,m.a.nb)},A:function(e){return e&&e.tagName&&e.tagName.toLowerCase()},Xb:function(e){return m.onError?function(){try{return e.apply(this,arguments)}catch(e){throw m.onError&&m.onError(e),e}}:e},setTimeout:function(e,t){return setTimeout(m.a.Xb(e),t)},bc:function(e){setTimeout(function(){m.onError&&m.onError(e);throw e},0)},p:function(e,t,n){var r=m.a.Xb(n);n=v&&d[t];if(m.options.useOnlyNativeEvents||n||!l)if(n||"function"!=typeof e.addEventListener){if(void 0===e.attachEvent)throw Error("Browser doesn't support addEventListener or attachEvent");var i=function(t){r.call(e,t)},s="on"+t;e.attachEvent(s,i);m.a.F.oa(e,function(){e.detachEvent(s,i)})}else e.addEventListener(t,r,!1);else l(e).bind(t,r)},Da:function(e,t){if(!e||!e.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var n;n=!("input"!==m.a.A(e)||!e.type||"click"!=t.toLowerCase())&&("checkbox"==(n=e.type)||"radio"==n);if(m.options.useOnlyNativeEvents||!l||n)if("function"==typeof a.createEvent){if("function"!=typeof e.dispatchEvent)throw Error("The supplied element doesn't support dispatchEvent");(n=a.createEvent(p[t]||"HTMLEvents")).initEvent(t,!0,!0,u,0,0,0,0,0,!1,!1,!1,!1,0,e),e.dispatchEvent(n)}else if(n&&e.click)e.click();else{if(void 0===e.fireEvent)throw Error("Browser doesn't support triggering events");e.fireEvent("on"+t)}else l(e).trigger(t)},c:function(e){return m.H(e)?e():e},zb:function(e){return m.H(e)?e.t():e},cb:function(e,t,n){var i;t&&("object"==typeof e.classList?(i=e.classList[n?"add":"remove"],m.a.q(t.match(g),function(t){i.call(e.classList,t)})):"string"==typeof e.className.baseVal?r(e.className,"baseVal",t,n):r(e,"className",t,n))},$a:function(e,t){var n=m.a.c(t);null!==n&&n!==o||(n="");var r=m.e.firstChild(e);!r||3!=r.nodeType||m.e.nextSibling(r)?m.e.da(e,[e.ownerDocument.createTextNode(n)]):r.data=n;m.a.Sc(e)},tc:function(e,t){e.name=t;if(7>=v)try{e.mergeAttributes(a.createElement("<input name='"+e.name+"'/>"),!1)}catch(e){}},Sc:function(e){9<=v&&(e=1==e.nodeType?e:e.parentNode).style&&(e.style.zoom=e.style.zoom)},Oc:function(e){if(v){var t=e.style.width;e.style.width=0;e.style.width=t}},jd:function(e,t){e=m.a.c(e);t=m.a.c(t);for(var n=[],r=e;r<=t;r++)n.push(r);return n},W:function(e){for(var t=[],n=0,r=e.length;n<r;n++)t.push(e[n]);return t},$b:function(e){return s?Symbol(e):e},sd:6===v,ud:7===v,C:v,gc:function(e,t){for(var n=m.a.W(e.getElementsByTagName("input")).concat(m.a.W(e.getElementsByTagName("textarea"))),r="string"==typeof t?function(e){return e.name===t}:function(e){return t.test(e.name)},i=[],s=n.length-1;0<=s;s--)r(n[s])&&i.push(n[s]);return i},fd:function(e){return"string"==typeof e&&(e=m.a.ab(e))?c&&c.parse?c.parse(e):new Function("return "+e)():null},Eb:function(e,t,n){if(!c||!c.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return c.stringify(m.a.c(e),t,n)},gd:function(t,n,r){var i=(r=r||{}).params||{},s=r.includeFields||this.ec,o=t;if("object"==typeof t&&"form"===m.a.A(t)){o=t.action;for(var u=s.length-1;0<=u;u--)for(var f=m.a.gc(t,s[u]),l=f.length-1;0<=l;l--)i[f[l].name]=f[l].value}n=m.a.c(n);var c=a.createElement("form");c.style.display="none";c.action=o;c.method="post";for(var h in n)(t=a.createElement("input")).type="hidden",t.name=h,t.value=m.a.Eb(m.a.c(n[h])),c.appendChild(t);e(i,function(e,t){var n=a.createElement("input");n.type="hidden";n.name=e;n.value=t;c.appendChild(n)});a.body.appendChild(c);r.submitter?r.submitter(c):c.submit();setTimeout(function(){c.parentNode.removeChild(c)},0)}}})();m.b("utils",m.a);m.b("utils.arrayForEach",m.a.q);m.b("utils.arrayFirst",m.a.Tb);m.b("utils.arrayFilter",m.a.La);m.b("utils.arrayGetDistinctValues",m.a.Ub);m.b("utils.arrayIndexOf",m.a.o);m.b("utils.arrayMap",m.a.fb);m.b("utils.arrayPushAll",m.a.ra);m.b("utils.arrayRemoveItem",m.a.Ma);m.b("utils.extend",m.a.extend);m.b("utils.fieldsIncludedWithJsonPost",m.a.ec);m.b("utils.getFormFields",m.a.gc);m.b("utils.peekObservable",m.a.zb);m.b("utils.postJson",m.a.gd);m.b("utils.parseJson",m.a.fd);m.b("utils.registerEventHandler",m.a.p);m.b("utils.stringifyJson",m.a.Eb);m.b("utils.range",m.a.jd);m.b("utils.toggleDomNodeCssClass",m.a.cb);m.b("utils.triggerEvent",m.a.Da);m.b("utils.unwrapObservable",m.a.c);m.b("utils.objectForEach",m.a.D);m.b("utils.addOrRemoveItem",m.a.pa);m.b("utils.setTextContent",m.a.$a);m.b("unwrap",m.a.c);Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if(1===arguments.length)return function(){return t.apply(e,arguments)};var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice(0);r.push.apply(r,arguments);return t.apply(e,r)}});m.a.f=new(function(){function e(e,i){var s=e[n];if(!s||"null"===s||!r[s]){if(!i)return o;s=e[n]="ko"+t++;r[s]={}}return r[s]}var t=0,n="__ko__"+(new Date).getTime(),r={};return{get:function(t,n){var r=e(t,!1);return r===o?o:r[n]},set:function(t,n,r){r===o&&e(t,!1)===o||(e(t,!0)[n]=r)},clear:function(e){var t=e[n];return!!t&&(delete r[t],e[n]=null,!0)},I:function(){return t+++n}}});m.b("utils.domData",m.a.f);m.b("utils.domData.clear",m.a.f.clear);m.a.F=new(function(){function e(e,t){var r=m.a.f.get(e,n);r===o&&t&&(r=[],m.a.f.set(e,n,r));return r}function t(n){if(r=e(n,!1))for(var r=r.slice(0),s=0;s<r.length;s++)r[s](n);m.a.f.clear(n);m.a.F.cleanExternalData(n);if(i[n.nodeType])for(r=n.firstChild;n=r;)r=n.nextSibling,8===n.nodeType&&t(n)}var n=m.a.f.I(),r={1:!0,8:!0,9:!0},i={1:!0,9:!0};return{oa:function(t,n){if("function"!=typeof n)throw Error("Callback must be a function");e(t,!0).push(n)},rc:function(t,r){var i=e(t,!1);i&&(m.a.Ma(i,r),0==i.length&&m.a.f.set(t,n,o))},$:function(e){if(r[e.nodeType]&&(t(e),i[e.nodeType])){var n=[];m.a.ra(n,e.getElementsByTagName("*"));for(var s=0,o=n.length;s<o;s++)t(n[s])}return e},removeNode:function(e){m.$(e);e.parentNode&&e.parentNode.removeChild(e)},cleanExternalData:function(e){l&&"function"==typeof l.cleanData&&l.cleanData([e])}}});m.$=m.a.F.$;m.removeNode=m.a.F.removeNode;m.b("cleanNode",m.$);m.b("removeNode",m.removeNode);m.b("utils.domNodeDisposal",m.a.F);m.b("utils.domNodeDisposal.addDisposeCallback",m.a.F.oa);m.b("utils.domNodeDisposal.removeDisposeCallback",m.a.F.rc);(function(){var e=[0,"",""],t=[1,"<table>","</table>"],n=[3,"<table><tbody><tr>","</tr></tbody></table>"],r=[1,"<select multiple='multiple'>","</select>"],i={thead:t,tbody:t,tfoot:t,tr:[2,"<table><tbody>","</tbody></table>"],td:n,th:n,option:r,optgroup:r},s=8>=m.a.C;m.a.ma=function(t,n){var r;if(l){if(l.parseHTML)r=l.parseHTML(t,n)||[];else if((r=l.clean([t],n))&&r[0]){for(var o=r[0];o.parentNode&&11!==o.parentNode.nodeType;)o=o.parentNode;o.parentNode&&o.parentNode.removeChild(o)}}else{(r=n)||(r=a);o=r.parentWindow||r.defaultView||u;var f,c=m.a.ab(t).toLowerCase(),h=r.createElement("div");f=(c=c.match(/^<([a-z]+)[ >]/))&&i[c[1]]||e;c=f[0];f="ignored<div>"+f[1]+t+f[2]+"</div>";"function"==typeof o.innerShiv?h.appendChild(o.innerShiv(f)):(s&&r.appendChild(h),h.innerHTML=f,s&&h.parentNode.removeChild(h));for(;c--;)h=h.lastChild;r=m.a.W(h.lastChild.childNodes)}return r};m.a.Cb=function(e,t){m.a.ob(e);if(null!==(t=m.a.c(t))&&t!==o)if("string"!=typeof t&&(t=t.toString()),l)l(e).html(t);else for(var n=m.a.ma(t,e.ownerDocument),r=0;r<n.length;r++)e.appendChild(n[r])}})();m.b("utils.parseHtmlFragment",m.a.ma);m.b("utils.setHtml",m.a.Cb);m.M=(v={},{wb:function(e){if("function"!=typeof e)throw Error("You can only pass a function to ko.memoization.memoize()");var t=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);v[t]=e;return"\x3c!--[ko_memo:"+t+"]--\x3e"},zc:function(e,t){var n=v[e];if(n===o)throw Error("Couldn't find any memo with ID "+e+". Perhaps it's already been unmemoized.");try{return n.apply(null,t||[]),!0}finally{delete v[e]}},Ac:function(e,t){var n=[];(function e(t,n){if(t)if(8==t.nodeType)null!=(r=m.M.nc(t.nodeValue))&&n.push({Mc:t,dd:r});else if(1==t.nodeType)for(var r=0,i=t.childNodes,s=i.length;r<s;r++)e(i[r],n)})(e,n);for(var r=0,i=n.length;r<i;r++){var s=n[r].Mc,o=[s];t&&m.a.ra(o,t);m.M.zc(n[r].dd,o);s.nodeValue="";s.parentNode&&s.parentNode.removeChild(s)}},nc:function(e){return(e=e.match(/^\[ko_memo\:(.*?)\]$/))?e[1]:null}});m.b("memoization",m.M);m.b("memoization.memoize",m.M.wb);m.b("memoization.unmemoize",m.M.zc);m.b("memoization.parseMemoText",m.M.nc);m.b("memoization.unmemoizeDomNodeAndDescendants",m.M.Ac);m.Z=(function(){function e(){if(r)for(var e,t=r,i=0;s<r;)if(e=n[s++]){if(s>t){if(5e3<=++i){s=r;m.a.bc(Error("'Too much recursion' after processing "+i+" task groups."));break}t=r}try{e()}catch(e){m.a.bc(e)}}}function t(){e();s=r=n.length=0}var n=[],r=0,i=1,s=0;return{scheduler:u.MutationObserver?(function(e){var t=a.createElement("div");new MutationObserver(e).observe(t,{attributes:!0});return function(){t.classList.toggle("foo")}})(t):a&&"onreadystatechange"in a.createElement("script")?function(e){var t=a.createElement("script");t.onreadystatechange=function(){t.onreadystatechange=null;a.documentElement.removeChild(t);t=null;e()};a.documentElement.appendChild(t)}:function(e){setTimeout(e,0)},Xa:function(e){r||m.Z.scheduler(t);n[r++]=e;return i++},cancel:function(e){(e-=i-r)>=s&&e<r&&(n[e]=null)},resetForTesting:function(){var e=r-s;s=r=n.length=0;return e},nd:e}})();m.b("tasks",m.Z);m.b("tasks.schedule",m.Z.Xa);m.b("tasks.runEarly",m.Z.nd);m.ya={throttle:function(e,t){e.throttleEvaluation=t;var n=null;return m.B({read:e,write:function(r){clearTimeout(n);n=m.a.setTimeout(function(){e(r)},t)}})},rateLimit:function(e,t){var n,s,o;"number"==typeof t?n=t:(n=t.timeout,s=t.method);e.eb=!1;o="notifyWhenChangesStop"==s?i:r;e.Ua(function(e){return o(e,n)})},deferred:function(e,t){if(!0!==t)throw Error("The 'deferred' extender only accepts the value 'true', because it is not supported to turn deferral off once enabled.");e.eb||(e.eb=!0,e.Ua(function(t){var n;return function(){m.Z.cancel(n);n=m.Z.Xa(t);e.notifySubscribers(o,"dirty")}}))},notify:function(e,t){e.equalityComparer="always"==t?null:n}};var g={undefined:1,boolean:1,number:1,string:1};m.b("extenders",m.ya);m.xc=function(e,t,n){this.ia=e;this.gb=t;this.Lc=n;this.S=!1;m.G(this,"dispose",this.k)};m.xc.prototype.k=function(){this.S=!0;this.Lc()};m.J=function(){m.a.Za(this,b);b.rb(this)};var y="change",b={rb:function(e){e.K={};e.Ob=1},Y:function(e,t,n){var r=this;n=n||y;var i=new m.xc(r,t?e.bind(t):e,function(){m.a.Ma(r.K[n],i);r.Ia&&r.Ia(n)});r.sa&&r.sa(n);r.K[n]||(r.K[n]=[]);r.K[n].push(i);return i},notifySubscribers:function(e,t){(t=t||y)===y&&this.Ib();if(this.Qa(t))try{m.l.Vb();for(var n,r=this.K[t].slice(0),i=0;n=r[i];++i)n.S||n.gb(e)}finally{m.l.end()}},Oa:function(){return this.Ob},Vc:function(e){return this.Oa()!==e},Ib:function(){++this.Ob},Ua:function(e){var t,n,r,i=this,o=m.H(i);i.Ha||(i.Ha=i.notifySubscribers,i.notifySubscribers=s);var u=e(function(){i.Nb=!1;o&&r===i&&(r=i());t=!1;i.tb(n,r)&&i.Ha(n=r)});i.Mb=function(e){i.Nb=t=!0;r=e;u()};i.Lb=function(e){t||(n=e,i.Ha(e,"beforeChange"))}},Qa:function(e){return this.K[e]&&this.K[e].length},Tc:function(e){if(e)return this.K[e]&&this.K[e].length||0;var t=0;m.a.D(this.K,function(e,n){"dirty"!==e&&(t+=n.length)});return t},tb:function(e,t){return!this.equalityComparer||!this.equalityComparer(e,t)},extend:function(e){var t=this;e&&m.a.D(e,function(e,n){var r=m.ya[e];"function"==typeof r&&(t=r(t,n)||t)});return t}};m.G(b,"subscribe",b.Y);m.G(b,"extend",b.extend);m.G(b,"getSubscriptionsCount",b.Tc);m.a.ka&&m.a.Ya(b,Function.prototype);m.J.fn=b;m.jc=function(e){return null!=e&&"function"==typeof e.Y&&"function"==typeof e.notifySubscribers};m.b("subscribable",m.J);m.b("isSubscribable",m.jc);m.va=m.l=(function(){function e(e){r.push(n);n=e}function t(){n=r.pop()}var n,r=[],i=0;return{Vb:e,end:t,qc:function(e){if(n){if(!m.jc(e))throw Error("Only subscribable things can act as dependencies");n.gb.call(n.Hc,e,e.Dc||(e.Dc=++i))}},w:function(n,r,i){try{return e(),n.apply(r,i||[])}finally{t()}},Aa:function(){if(n)return n.m.Aa()},Ta:function(){if(n)return n.Ta}}})();m.b("computedContext",m.va);m.b("computedContext.getDependenciesCount",m.va.Aa);m.b("computedContext.isInitial",m.va.Ta);m.b("ignoreDependencies",m.rd=m.l.w);var w=m.a.$b("_latestValue");m.N=function(e){function t(){if(0<arguments.length)return t.tb(t[w],arguments[0])&&(t.ga(),t[w]=arguments[0],t.fa()),this;m.l.qc(t);return t[w]}t[w]=e;m.a.ka||m.a.extend(t,m.J.fn);m.J.fn.rb(t);m.a.Za(t,E);m.options.deferUpdates&&m.ya.deferred(t,!0);return t};var E={equalityComparer:n,t:function(){return this[w]},fa:function(){this.notifySubscribers(this[w])},ga:function(){this.notifySubscribers(this[w],"beforeChange")}};m.a.ka&&m.a.Ya(E,m.J.fn);var S=m.N.hd="__ko_proto__";E[S]=m.N;m.Pa=function(e,t){return null!==e&&e!==o&&e[S]!==o&&(e[S]===t||m.Pa(e[S],t))};m.H=function(e){return m.Pa(e,m.N)};m.Ba=function(e){return!!("function"==typeof e&&e[S]===m.N||"function"==typeof e&&e[S]===m.B&&e.Wc)};m.b("observable",m.N);m.b("isObservable",m.H);m.b("isWriteableObservable",m.Ba);m.b("isWritableObservable",m.Ba);m.b("observable.fn",E);m.G(E,"peek",E.t);m.G(E,"valueHasMutated",E.fa);m.G(E,"valueWillMutate",E.ga);m.la=function(e){if("object"!=typeof(e=e||[])||!("length"in e))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");e=m.N(e);m.a.Za(e,m.la.fn);return e.extend({trackArrayChanges:!0})};m.la.fn={remove:function(e){for(var t=this.t(),n=[],r="function"!=typeof e||m.H(e)?function(t){return t===e}:e,i=0;i<t.length;i++){var s=t[i];r(s)&&(0===n.length&&this.ga(),n.push(s),t.splice(i,1),i--)}n.length&&this.fa();return n},removeAll:function(e){if(e===o){var t=this.t(),n=t.slice(0);this.ga();t.splice(0,t.length);this.fa();return n}return e?this.remove(function(t){return 0<=m.a.o(e,t)}):[]},destroy:function(e){var t=this.t(),n="function"!=typeof e||m.H(e)?function(t){return t===e}:e;this.ga();for(var r=t.length-1;0<=r;r--)n(t[r])&&(t[r]._destroy=!0);this.fa()},destroyAll:function(e){return e===o?this.destroy(function(){return!0}):e?this.destroy(function(t){return 0<=m.a.o(e,t)}):[]},indexOf:function(e){var t=this();return m.a.o(t,e)},replace:function(e,t){var n=this.indexOf(e);0<=n&&(this.ga(),this.t()[n]=t,this.fa())}};m.a.ka&&m.a.Ya(m.la.fn,m.N.fn);m.a.q("pop push reverse shift sort splice unshift".split(" "),function(e){m.la.fn[e]=function(){var t=this.t();this.ga();this.Wb(t,e,arguments);var n=t[e].apply(t,arguments);this.fa();return n===t?this:n}});m.a.q(["slice"],function(e){m.la.fn[e]=function(){var t=this();return t[e].apply(t,arguments)}});m.b("observableArray",m.la);m.ya.trackArrayChanges=function(e,t){function n(){if(!s){s=!0;i=e.notifySubscribers;e.notifySubscribers=function(e,t){t&&t!==y||++a;return i.apply(this,arguments)};var t=[].concat(e.t()||[]);u=null;r=e.Y(function(n){n=[].concat(n||[]);if(e.Qa("arrayChange")){var r;(!u||1<a)&&(u=m.a.ib(t,n,e.hb));r=u}t=n;u=null;a=0;r&&r.length&&e.notifySubscribers(r,"arrayChange")})}}e.hb={};t&&"object"==typeof t&&m.a.extend(e.hb,t);e.hb.sparse=!0;if(!e.Wb){var r,i,s=!1,u=null,a=0,f=e.sa,l=e.Ia;e.sa=function(t){f&&f.call(e,t);"arrayChange"===t&&n()};e.Ia=function(t){l&&l.call(e,t);"arrayChange"!==t||e.Qa("arrayChange")||(i&&(e.notifySubscribers=i,i=o),r.k(),s=!1)};e.Wb=function(e,t,n){function r(e,t,n){return i[i.length]={status:e,value:t,index:n}}if(s&&!a){var i=[],o=e.length,f=n.length,l=0;switch(t){case"push":l=o;case"unshift":for(t=0;t<f;t++)r("added",n[t],l+t);break;case"pop":l=o-1;case"shift":o&&r("deleted",e[l],l);break;case"splice":t=Math.min(Math.max(0,0>n[0]?o+n[0]:n[0]),o);o=1===f?o:Math.min(t+(n[1]||0),o),f=t+f-2,l=Math.max(o,f);for(var c=[],h=[],p=2;t<l;++t,++p)t<o&&h.push(r("deleted",e[t],t)),t<f&&c.push(r("added",n[p],t));m.a.fc(h,c);break;default:return}u=i}}}};var x=m.a.$b("_state");m.m=m.B=function(e,t,n){function r(){if(0<arguments.length){if("function"!=typeof i)throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");i.apply(s.pb,arguments);return this}m.l.qc(r);(s.T||s.s&&r.Ra())&&r.aa();return s.U}"object"==typeof e?n=e:(n=n||{},e&&(n.read=e));if("function"!=typeof n.read)throw Error("Pass a function that returns the value of the ko.computed");var i=n.write,s={U:o,T:!0,Sa:!1,Fb:!1,S:!1,Wa:!1,s:!1,kd:n.read,pb:t||n.owner,i:n.disposeWhenNodeIsRemoved||n.i||null,wa:n.disposeWhen||n.wa,mb:null,r:{},L:0,dc:null};r[x]=s;r.Wc="function"==typeof i;m.a.ka||m.a.extend(r,m.J.fn);m.J.fn.rb(r);m.a.Za(r,T);n.pure?(s.Wa=!0,s.s=!0,m.a.extend(r,N)):n.deferEvaluation&&m.a.extend(r,C);m.options.deferUpdates&&m.ya.deferred(r,!0);s.i&&(s.Fb=!0,s.i.nodeType||(s.i=null));s.s||n.deferEvaluation||r.aa();s.i&&r.ba()&&m.a.F.oa(s.i,s.mb=function(){r.k()});return r};var T={equalityComparer:n,Aa:function(){return this[x].L},Qb:function(e,t,n){if(this[x].Wa&&t===this)throw Error("A 'pure' computed must not be called recursively");this[x].r[e]=n;n.Ga=this[x].L++;n.na=t.Oa()},Ra:function(){var e,t,n=this[x].r;for(e in n)if(n.hasOwnProperty(e)&&(t=n[e]).ia.Vc(t.na))return!0},cd:function(){this.Fa&&!this[x].Sa&&this.Fa()},ba:function(){return this[x].T||0<this[x].L},md:function(){this.Nb||this.cc()},wc:function(e){if(e.eb&&!this[x].i){var t=e.Y(this.cd,this,"dirty"),n=e.Y(this.md,this);return{ia:e,k:function(){t.k();n.k()}}}return e.Y(this.cc,this)},cc:function(){var e=this,t=e.throttleEvaluation;t&&0<=t?(clearTimeout(this[x].dc),this[x].dc=m.a.setTimeout(function(){e.aa(!0)},t)):e.Fa?e.Fa():e.aa(!0)},aa:function(e){var t=this[x],n=t.wa;if(!t.Sa&&!t.S){if(t.i&&!m.a.nb(t.i)||n&&n()){if(!t.Fb){this.k();return}}else t.Fb=!1;t.Sa=!0;try{this.Rc(e)}finally{t.Sa=!1}t.L||this.k()}},Rc:function(e){var t=this[x],n=t.Wa?o:!t.L,r={Ic:this,Na:t.r,lb:t.L};m.l.Vb({Hc:r,gb:p,m:this,Ta:n});t.r={};t.L=0;r=this.Qc(t,r);this.tb(t.U,r)&&(t.s||this.notifySubscribers(t.U,"beforeChange"),t.U=r,t.s?this.Ib():e&&this.notifySubscribers(t.U));n&&this.notifySubscribers(t.U,"awake")},Qc:function(e,t){try{var n=e.kd;return e.pb?n.call(e.pb):n()}finally{m.l.end(),t.lb&&!e.s&&m.a.D(t.Na,h),e.T=!1}},t:function(){var e=this[x];(e.T&&!e.L||e.s&&this.Ra())&&this.aa();return e.U},Ua:function(e){m.J.fn.Ua.call(this,e);this.Fa=function(){this.Lb(this[x].U);this[x].T=!0;this.Mb(this)}},k:function(){var e=this[x];!e.s&&e.r&&m.a.D(e.r,function(e,t){t.k&&t.k()});e.i&&e.mb&&m.a.F.rc(e.i,e.mb);e.r=null;e.L=0;e.S=!0;e.T=!1;e.s=!1;e.i=null}},N={sa:function(e){var t=this,n=t[x];if(!n.S&&n.s&&"change"==e){n.s=!1;if(n.T||t.Ra())n.r=null,n.L=0,n.T=!0,t.aa(),t.Ib();else{var r=[];m.a.D(n.r,function(e,t){r[t.Ga]=e});m.a.q(r,function(e,r){var i=n.r[e],s=t.wc(i.ia);s.Ga=r;s.na=i.na;n.r[e]=s})}n.S||t.notifySubscribers(n.U,"awake")}},Ia:function(e){var t=this[x];t.S||"change"!=e||this.Qa("change")||(m.a.D(t.r,function(e,n){n.k&&(t.r[e]={ia:n.ia,Ga:n.Ga,na:n.na},n.k())}),t.s=!0,this.notifySubscribers(o,"asleep"))},Oa:function(){var e=this[x];e.s&&(e.T||this.Ra())&&this.aa();return m.J.fn.Oa.call(this)}},C={sa:function(e){"change"!=e&&"beforeChange"!=e||this.t()}};m.a.ka&&m.a.Ya(T,m.J.fn);var k=m.N.hd;m.m[k]=m.N;T[k]=m.m;m.Yc=function(e){return m.Pa(e,m.m)};m.Zc=function(e){return m.Pa(e,m.m)&&e[x]&&e[x].Wa};m.b("computed",m.m);m.b("dependentObservable",m.m);m.b("isComputed",m.Yc);m.b("isPureComputed",m.Zc);m.b("computed.fn",T);m.G(T,"peek",T.t);m.G(T,"dispose",T.k);m.G(T,"isActive",T.ba);m.G(T,"getDependenciesCount",T.Aa);m.pc=function(e,t){if("function"==typeof e)return m.m(e,t,{pure:!0});(e=m.a.extend({},e)).pure=!0;return m.m(e,t)};m.b("pureComputed",m.pc);(function(){function e(n,r,i){i=i||new t;if("object"!=typeof(n=r(n))||null===n||n===o||n instanceof RegExp||n instanceof Date||n instanceof String||n instanceof Number||n instanceof Boolean)return n;var s=n instanceof Array?[]:{};i.save(n,s);(function(e,t){if(e instanceof Array){for(var n=0;n<e.length;n++)t(n);"function"==typeof e.toJSON&&t("toJSON")}else for(n in e)t(n)})(n,function(t){var u=r(n[t]);switch(typeof u){case"boolean":case"number":case"string":case"function":s[t]=u;break;case"object":case"undefined":var a=i.get(u);s[t]=a!==o?a:e(u,r,i)}});return s}function t(){this.keys=[];this.Jb=[]}m.yc=function(t){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return e(t,function(e){for(var t=0;m.H(e)&&10>t;t++)e=e();return e})};m.toJSON=function(e,t,n){e=m.yc(e);return m.a.Eb(e,t,n)};t.prototype={save:function(e,t){var n=m.a.o(this.keys,e);0<=n?this.Jb[n]=t:(this.keys.push(e),this.Jb.push(t))},get:function(e){return 0<=(e=m.a.o(this.keys,e))?this.Jb[e]:o}}})();m.b("toJS",m.yc);m.b("toJSON",m.toJSON);m.j={u:function(e){switch(m.a.A(e)){case"option":return!0===e.__ko__hasDomDataOptionValue__?m.a.f.get(e,m.d.options.xb):7>=m.a.C?e.getAttributeNode("value")&&e.getAttributeNode("value").specified?e.value:e.text:e.value;case"select":return 0<=e.selectedIndex?m.j.u(e.options[e.selectedIndex]):o;default:return e.value}},ha:function(e,t,n){switch(m.a.A(e)){case"option":switch(typeof t){case"string":m.a.f.set(e,m.d.options.xb,o);"__ko__hasDomDataOptionValue__"in e&&delete e.__ko__hasDomDataOptionValue__;e.value=t;break;default:m.a.f.set(e,m.d.options.xb,t),e.__ko__hasDomDataOptionValue__=!0,e.value="number"==typeof t?t:""}break;case"select":""!==t&&null!==t||(t=o);for(var r,i=-1,s=0,u=e.options.length;s<u;++s)if((r=m.j.u(e.options[s]))==t||""==r&&t===o){i=s;break}(n||0<=i||t===o&&1<e.size)&&(e.selectedIndex=i);break;default:null!==t&&t!==o||(t="");e.value=t}}};m.b("selectExtensions",m.j);m.b("selectExtensions.readValue",m.j.u);m.b("selectExtensions.writeValue",m.j.ha);m.h=(function(){function e(e){123===(e=m.a.ab(e)).charCodeAt(0)&&(e=e.slice(1,-1));var t,n=[],o=e.match(r),u=[],a=0;if(o){o.push(",");for(var f,l=0;f=o[l];++l){var c=f.charCodeAt(0);if(44===c){if(0>=a){n.push(t&&u.length?{key:t,value:u.join("")}:{unknown:t||u.join("")});t=a=0;u=[];continue}}else if(58===c){if(!a&&!t&&1===u.length){t=u.pop();continue}}else 47===c&&l&&1<f.length?(c=o[l-1].match(i))&&!s[c[0]]&&((o=(e=e.substr(e.indexOf(f)+1)).match(r)).push(","),l=-1,f="/"):40===c||123===c||91===c?++a:41===c||125===c||93===c?--a:t||u.length||34!==c&&39!==c||(f=f.slice(1,-1));u.push(f)}}return n}var t=["true","false","null","undefined"],n=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,r=RegExp("\"(?:[^\"\\\\]|\\\\.)*\"|'(?:[^'\\\\]|\\\\.)*'|/(?:[^/\\\\]|\\\\.)*/w*|[^\\s:,/][^,\"'{}()/:[\\]]*[^\\s,\"'{}()/:[\\]]|[^\\s]","g"),i=/[\])"'A-Za-z0-9_$]+$/,s={in:1,return:1,typeof:1},o={};return{ta:[],ea:o,yb:e,Va:function(r,i){function s(e,r){var i;if(!l){var c=m.getBindingHandler(e);if(c&&c.preprocess&&!(r=c.preprocess(r,e,s)))return;(c=o[e])&&(i=r,0<=m.a.o(t,i)?i=!1:(c=i.match(n),i=null!==c&&(c[1]?"Object("+c[1]+")"+c[2]:i)),c=i);c&&a.push("'"+e+"':function(_z){"+i+"=_z}")}f&&(r="function(){return "+r+" }");u.push("'"+e+"':"+r)}var u=[],a=[],f=(i=i||{}).valueAccessors,l=i.bindingParams,c="string"==typeof r?e(r):r;m.a.q(c,function(e){s(e.key||e.unknown,e.value)});a.length&&s("_ko_property_writers","{"+a.join(",")+" }");return u.join(",")},bd:function(e,t){for(var n=0;n<e.length;n++)if(e[n].key==t)return!0;return!1},Ea:function(e,t,n,r,i){e&&m.H(e)?!m.Ba(e)||i&&e.t()===r||e(r):(e=t.get("_ko_property_writers"))&&e[n]&&e[n](r)}}})();m.b("expressionRewriting",m.h);m.b("expressionRewriting.bindingRewriteValidators",m.h.ta);m.b("expressionRewriting.parseObjectLiteral",m.h.yb);m.b("expressionRewriting.preProcessBindings",m.h.Va);m.b("expressionRewriting._twoWayBindings",m.h.ea);m.b("jsonExpressionRewriting",m.h);m.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",m.h.Va);(function(){function e(e){return 8==e.nodeType&&s.test(i?e.text:e.nodeValue)}function t(e){return 8==e.nodeType&&o.test(i?e.text:e.nodeValue)}function n(n,r){for(var i=n,s=1,o=[];i=i.nextSibling;){if(t(i)&&0==--s)return o;o.push(i);e(i)&&s++}if(!r)throw Error("Cannot find closing comment tag to match: "+n.nodeValue);return null}function r(e,t){var r=n(e,t);return r?0<r.length?r[r.length-1].nextSibling:e.nextSibling:null}var i=a&&"\x3c!--test--\x3e"===a.createComment("test").text,s=i?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,o=i?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,u={ul:!0,ol:!0};m.e={V:{},childNodes:function(t){return e(t)?n(t):t.childNodes},xa:function(t){if(e(t))for(var n=0,r=(t=m.e.childNodes(t)).length;n<r;n++)m.removeNode(t[n]);else m.a.ob(t)},da:function(t,n){if(e(t)){m.e.xa(t);for(var r=t.nextSibling,i=0,s=n.length;i<s;i++)r.parentNode.insertBefore(n[i],r)}else m.a.da(t,n)},oc:function(t,n){e(t)?t.parentNode.insertBefore(n,t.nextSibling):t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n)},ic:function(t,n,r){r?e(t)?t.parentNode.insertBefore(n,r.nextSibling):r.nextSibling?t.insertBefore(n,r.nextSibling):t.appendChild(n):m.e.oc(t,n)},firstChild:function(n){return e(n)?!n.nextSibling||t(n.nextSibling)?null:n.nextSibling:n.firstChild},nextSibling:function(n){e(n)&&(n=r(n));return n.nextSibling&&t(n.nextSibling)?null:n.nextSibling},Uc:e,qd:function(e){return(e=(i?e.text:e.nodeValue).match(s))?e[1]:null},mc:function(n){if(u[m.a.A(n)]){var i=n.firstChild;if(i)do{if(1===i.nodeType){var s,o=null;if(s=i.firstChild)do{if(o)o.push(s);else if(e(s)){var a=r(s,!0);a?s=a:o=[s]}else t(s)&&(o=[s])}while(s=s.nextSibling);if(s=o)for(o=i.nextSibling,a=0;a<s.length;a++)o?n.insertBefore(s[a],o):n.appendChild(s[a])}}while(i=i.nextSibling)}}}})();m.b("virtualElements",m.e);m.b("virtualElements.allowedBindings",m.e.V);m.b("virtualElements.emptyNode",m.e.xa);m.b("virtualElements.insertAfter",m.e.ic);m.b("virtualElements.prepend",m.e.oc);m.b("virtualElements.setDomNodeChildren",m.e.da);(function(){m.R=function(){this.Gc={}};m.a.extend(m.R.prototype,{nodeHasBindings:function(e){switch(e.nodeType){case 1:return null!=e.getAttribute("data-bind")||m.g.getComponentNameForNode(e);case 8:return m.e.Uc(e);default:return!1}},getBindings:function(e,t){var n=(n=this.getBindingsString(e,t))?this.parseBindingsString(n,t,e):null;return m.g.Pb(n,e,t,!1)},getBindingAccessors:function(e,t){var n=(n=this.getBindingsString(e,t))?this.parseBindingsString(n,t,e,{valueAccessors:!0}):null;return m.g.Pb(n,e,t,!0)},getBindingsString:function(e){switch(e.nodeType){case 1:return e.getAttribute("data-bind");case 8:return m.e.qd(e);default:return null}},parseBindingsString:function(e,t,n,r){try{var i,s=this.Gc,o=e+(r&&r.valueAccessors||"");if(!(i=s[o])){var u,a="with($context){with($data||{}){return{"+m.h.Va(e,r)+"}}}";u=new Function("$context","$element",a);i=s[o]=u}return i(t,n)}catch(t){throw t.message="Unable to parse bindings.\nBindings value: "+e+"\nMessage: "+t.message,t}}});m.R.instance=new m.R})();m.b("bindingProvider",m.R);(function(){function e(e){return function(){return e}}function t(e){return e()}function n(e){return m.a.Ca(m.l.w(e),function(t,n){return function(){return e()[n]}})}function r(t,r,i){return"function"==typeof t?n(t.bind(null,r,i)):m.a.Ca(t,e)}function i(e,t){return n(this.getBindings.bind(this,e,t))}function s(e,t,n){var r,i=m.e.firstChild(t),s=m.R.instance,o=s.preprocessNode;if(o){for(;r=i;)i=m.e.nextSibling(r),o.call(s,r);i=m.e.firstChild(t)}for(;r=i;)i=m.e.nextSibling(r),a(e,r,n)}function a(e,t,n){var r=!0,i=1===t.nodeType;i&&m.e.mc(t);(i&&n||m.R.instance.nodeHasBindings(t))&&(r=f(t,null,e,n).shouldBindDescendants);r&&!h[m.a.A(t)]&&s(e,t,!i)}function f(e,n,r,s){var u,a,f=m.a.f.get(e,p);if(!n){if(f)throw Error("You cannot apply bindings multiple times to the same element.");m.a.f.set(e,p,!0)}!f&&s&&m.vc(e,r);if(n&&"function"!=typeof n)u=n;else{var l=m.R.instance,c=l.getBindingAccessors||i,h=m.B(function(){(u=n?n(r,e):c.call(l,e,r))&&r.P&&r.P();return u},null,{i:e});u&&h.ba()||(h=null)}if(u){var d=h?function(e){return function(){return t(h()[e])}}:function(e){return u[e]},v=function(){return m.a.Ca(h?h():u,t)};v.get=function(e){return u[e]&&t(d(e))};v.has=function(e){return e in u};s=(function(e){var t=[],n={},r=[];m.a.D(e,function i(s){if(!n[s]){var o=m.getBindingHandler(s);o&&(o.after&&(r.push(s),m.a.q(o.after,function(t){if(e[t]){if(-1!==m.a.o(r,t))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+r.join(", "));i(t)}}),r.length--),t.push({key:s,hc:o}));n[s]=!0}});return t})(u);m.a.q(s,function(t){var n=t.hc.init,i=t.hc.update,s=t.key;if(8===e.nodeType&&!m.e.V[s])throw Error("The binding '"+s+"' cannot be used with virtual elements");try{"function"==typeof n&&m.l.w(function(){var t=n(e,d(s),v,r.$data,r);if(t&&t.controlsDescendantBindings){if(a!==o)throw Error("Multiple bindings ("+a+" and "+s+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");a=s}}),"function"==typeof i&&m.B(function(){i(e,d(s),v,r.$data,r)},null,{i:e})}catch(e){throw e.message='Unable to process binding "'+s+": "+u[s]+'"\nMessage: '+e.message,e}})}return{shouldBindDescendants:a===o}}function c(e){return e&&e instanceof m.Q?e:new m.Q(e)}m.d={};var h={script:!0,textarea:!0,template:!0};m.getBindingHandler=function(e){return m.d[e]};m.Q=function(e,t,n,r,i){function s(){var i=l?e():e,s=m.a.c(i);t?(t.P&&t.P(),m.a.extend(f,t),f.P=a):(f.$parents=[],f.$root=s,f.ko=m);f.$rawData=i;f.$data=s;n&&(f[n]=s);r&&r(f,t,s);return f.$data}var u,a,f=this,l="function"==typeof e&&!m.H(e);i&&i.exportDependencies?s():(a=m.B(s,null,{wa:function(){return u&&!m.a.Rb(u)},i:!0})).ba()&&(f.P=a,a.equalityComparer=null,u=[],a.Bc=function(e){u.push(e);m.a.F.oa(e,function(e){m.a.Ma(u,e);u.length||(a.k(),f.P=a=o)})})};m.Q.prototype.createChildContext=function(e,t,n,r){return new m.Q(e,this,t,function(e,t){e.$parentContext=t;e.$parent=t.$data;e.$parents=(t.$parents||[]).slice(0);e.$parents.unshift(e.$parent);n&&n(e)},r)};m.Q.prototype.extend=function(e){return new m.Q(this.P||this.$data,this,null,function(t,n){t.$rawData=n.$rawData;m.a.extend(t,"function"==typeof e?e():e)})};m.Q.prototype.Zb=function(e,t){return this.createChildContext(e,t,null,{exportDependencies:!0})};var p=m.a.f.I(),d=m.a.f.I();m.vc=function(e,t){if(2!=arguments.length)return m.a.f.get(e,d);m.a.f.set(e,d,t),t.P&&t.P.Bc(e)};m.Ja=function(e,t,n){1===e.nodeType&&m.e.mc(e);return f(e,t,c(n),!0)};m.Ec=function(e,t,n){n=c(n);return m.Ja(e,r(t,n,e),n)};m.Ka=function(e,t){1!==t.nodeType&&8!==t.nodeType||s(c(e),t,!0)};m.Sb=function(e,t){!l&&u.jQuery&&(l=u.jQuery);if(t&&1!==t.nodeType&&8!==t.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");t=t||u.document.body;a(c(e),t,!0)};m.kb=function(e){switch(e.nodeType){case 1:case 8:var t=m.vc(e);if(t)return t;if(e.parentNode)return m.kb(e.parentNode)}return o};m.Kc=function(e){return(e=m.kb(e))?e.$data:o};m.b("bindingHandlers",m.d);m.b("applyBindings",m.Sb);m.b("applyBindingsToDescendants",m.Ka);m.b("applyBindingAccessorsToNode",m.Ja);m.b("applyBindingsToNode",m.Ec);m.b("contextFor",m.kb);m.b("dataFor",m.Kc)})();(function(e){function t(t,r){var o,u=i.hasOwnProperty(t)?i[t]:e;u?u.Y(r):((u=i[t]=new m.J).Y(r),n(t,function(e,n){var r=!(!n||!n.synchronous);s[t]={definition:e,$c:r};delete i[t];o||r?u.notifySubscribers(e):m.Z.Xa(function(){u.notifySubscribers(e)})}),o=!0)}function n(e,t){r("getConfig",[e],function(n){n?r("loadComponent",[e,n],function(e){t(e,n)}):t(null,null)})}function r(t,n,i,s){s||(s=m.g.loaders.slice(0));var o=s.shift();if(o){var u=o[t];if(u){var a=!1;if(u.apply(o,n.concat(function(e){a?i(null):null!==e?i(e):r(t,n,i,s)}))!==e&&(a=!0,!o.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}else r(t,n,i,s)}else i(null)}var i={},s={};m.g={get:function(n,r){var i=s.hasOwnProperty(n)?s[n]:e;i?i.$c?m.l.w(function(){r(i.definition)}):m.Z.Xa(function(){r(i.definition)}):t(n,r)},Yb:function(e){delete s[e]},Kb:r};m.g.loaders=[];m.b("components",m.g);m.b("components.get",m.g.get);m.b("components.clearCachedDefinition",m.g.Yb)})();(function(){function e(e,t,n,r){function s(){0==--u&&r(o)}var o={},u=2,a=n.template;n=n.viewModel;a?i(t,a,function(t){m.g.Kb("loadTemplate",[e,t],function(e){o.template=e;s()})}):s();n?i(t,n,function(t){m.g.Kb("loadViewModel",[e,t],function(e){o[f]=e;s()})}):s()}function n(e){switch(m.a.A(e)){case"script":return m.a.ma(e.text);case"textarea":return m.a.ma(e.value);case"template":if(r(e.content))return m.a.ua(e.content.childNodes)}return m.a.ua(e.childNodes)}function r(e){return u.DocumentFragment?e instanceof DocumentFragment:e&&11===e.nodeType}function i(e,n,r){"string"==typeof n.require?t||u.require?(t||u.require)([n.require],r):e("Uses require, but no AMD loader is present"):r(n)}function s(e){return function(t){throw Error("Component '"+e+"': "+t)}}var o={};m.g.register=function(e,t){if(!t)throw Error("Invalid configuration for "+e);if(m.g.ub(e))throw Error("Component "+e+" is already registered");o[e]=t};m.g.ub=function(e){return o.hasOwnProperty(e)};m.g.pd=function(e){delete o[e];m.g.Yb(e)};m.g.ac={getConfig:function(e,t){t(o.hasOwnProperty(e)?o[e]:null)},loadComponent:function(t,n,r){var o=s(t);i(o,n,function(n){e(t,o,n,r)})},loadTemplate:function(e,t,i){e=s(e);if("string"==typeof t)i(m.a.ma(t));else if(t instanceof Array)i(t);else if(r(t))i(m.a.W(t.childNodes));else if(t.element)if(t=t.element,u.HTMLElement?t instanceof HTMLElement:t&&t.tagName&&1===t.nodeType)i(n(t));else if("string"==typeof t){var o=a.getElementById(t);o?i(n(o)):e("Cannot find element with ID "+t)}else e("Unknown element type: "+t);else e("Unknown template value: "+t)},loadViewModel:function(e,t,n){(function e(t,n,r){if("function"==typeof n)r(function(e){return new n(e)});else if("function"==typeof n[f])r(n[f]);else if("instance"in n){var i=n.instance;r(function(){return i})}else"viewModel"in n?e(t,n.viewModel,r):t("Unknown viewModel value: "+n)})(s(e),t,n)}};var f="createViewModel";m.b("components.register",m.g.register);m.b("components.isRegistered",m.g.ub);m.b("components.unregister",m.g.pd);m.b("components.defaultLoader",m.g.ac);m.g.loaders.push(m.g.ac);m.g.Cc=o})();(function(){function e(e,n){if(r=e.getAttribute("params")){var r=t.parseBindingsString(r,n,e,{valueAccessors:!0,bindingParams:!0}),i=(r=m.a.Ca(r,function(t){return m.m(t,null,{i:e})}),m.a.Ca(r,function(t){var n=t.t();return t.ba()?m.m({read:function(){return m.a.c(t())},write:m.Ba(n)&&function(e){t()(e)},i:e}):n}));i.hasOwnProperty("$raw")||(i.$raw=r);return i}return{$raw:{}}}m.g.getComponentNameForNode=function(e){var t=m.a.A(e);if(m.g.ub(t)&&(-1!=t.indexOf("-")||"[object HTMLUnknownElement]"==""+e||8>=m.a.C&&e.tagName===t))return t};m.g.Pb=function(t,n,r,i){if(1===n.nodeType){var s=m.g.getComponentNameForNode(n);if(s){if((t=t||{}).component)throw Error('Cannot use the "component" binding on a custom element matching a component');var o={name:s,params:e(n,r)};t.component=i?function(){return o}:o}}return t};var t=new m.R;9>m.a.C&&(m.g.register=(function(e){return function(t){a.createElement(t);return e.apply(this,arguments)}})(m.g.register),a.createDocumentFragment=(function(e){return function(){var t,n=e(),r=m.g.Cc;for(t in r)r.hasOwnProperty(t)&&n.createElement(t);return n}})(a.createDocumentFragment))})();(function(e){var t=0;m.d.component={init:function(e,n,r,i,s){function o(){var e=u&&u.dispose;"function"==typeof e&&e.call(u);a=u=null}var u,a,f=m.a.W(m.e.childNodes(e));m.a.F.oa(e,o);m.m(function(){var r,i,l=m.a.c(n());"string"==typeof l?r=l:(r=m.a.c(l.name),i=m.a.c(l.params));if(!r)throw Error("No component name specified");var c=a=++t;m.g.get(r,function(t){if(a===c){o();if(!t)throw Error("Unknown component '"+r+"'");(function(e,t,n){if(!(t=t.template))throw Error("Component '"+e+"' has no template");e=m.a.ua(t);m.e.da(n,e)})(r,t,e);var n=(function(e,t,n,r){var i=e.createViewModel;return i?i.call(e,r,{element:t,templateNodes:n}):r})(t,e,f,i);t=s.createChildContext(n,void 0,function(e){e.$component=n;e.$componentTemplateNodes=f});u=n;m.Ka(t,e)}})},null,{i:e});return{controlsDescendantBindings:!0}}};m.e.V.component=!0})();var L={class:"className",for:"htmlFor"};m.d.attr={update:function(e,t){var n=m.a.c(t())||{};m.a.D(n,function(t,n){var r=!1===(n=m.a.c(n))||null===n||n===o;r&&e.removeAttribute(t);8>=m.a.C&&t in L?(t=L[t],r?e.removeAttribute(t):e[t]=n):r||e.setAttribute(t,n.toString());"name"===t&&m.a.tc(e,r?"":n.toString())})}};(function(){m.d.checked={after:["value","attr"],init:function(e,t,n){function r(){var r=e.checked,s=h?i():r;if(!m.va.Ta()&&(!u||r)){var o=m.l.w(t);if(f){var a=l?o.t():o;c!==s?(r&&(m.a.pa(a,s,!0),m.a.pa(a,c,!1)),c=s):m.a.pa(a,s,r);l&&m.Ba(o)&&o(a)}else m.h.Ea(o,n,"checked",s,!0)}}var i=m.pc(function(){return n.has("checkedValue")?m.a.c(n.get("checkedValue")):n.has("value")?m.a.c(n.get("value")):e.value}),s="checkbox"==e.type,u="radio"==e.type;if(s||u){var a=t(),f=s&&m.a.c(a)instanceof Array,l=!(f&&a.push&&a.splice),c=f?i():o,h=u||f;u&&!e.name&&m.d.uniqueName.init(e,function(){return!0});m.m(r,null,{i:e});m.a.p(e,"click",r);m.m(function(){var n=m.a.c(t());e.checked=f?0<=m.a.o(n,i()):s?n:i()===n},null,{i:e});a=o}}};m.h.ea.checked=!0;m.d.checkedValue={update:function(e,t){e.value=m.a.c(t())}}})();m.d.class={update:function(e,t){var n=m.a.ab(m.a.c(t()));m.a.cb(e,e.__ko__cssValue,!1);e.__ko__cssValue=n;m.a.cb(e,n,!0)}};m.d.css={update:function(e,t){var n=m.a.c(t());null!==n&&"object"==typeof n?m.a.D(n,function(t,n){n=m.a.c(n);m.a.cb(e,t,n)}):m.d.class.update(e,t)}};m.d.enable={update:function(e,t){var n=m.a.c(t());n&&e.disabled?e.removeAttribute("disabled"):n||e.disabled||(e.disabled=!0)}};m.d.disable={update:function(e,t){m.d.enable.update(e,function(){return!m.a.c(t())})}};m.d.event={init:function(e,t,n,r,i){var s=t()||{};m.a.D(s,function(s){"string"==typeof s&&m.a.p(e,s,function(e){var o,u=t()[s];if(u){try{var a=m.a.W(arguments);r=i.$data;a.unshift(r);o=u.apply(r,a)}finally{!0!==o&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}!1===n.get(s+"Bubble")&&(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())}})})}};m.d.foreach={kc:function(e){return function(){var t=e(),n=m.a.zb(t);if(!n||"number"==typeof n.length)return{foreach:t,templateEngine:m.X.sb};m.a.c(t);return{foreach:n.data,as:n.as,includeDestroyed:n.includeDestroyed,afterAdd:n.afterAdd,beforeRemove:n.beforeRemove,afterRender:n.afterRender,beforeMove:n.beforeMove,afterMove:n.afterMove,templateEngine:m.X.sb}}},init:function(e,t){return m.d.template.init(e,m.d.foreach.kc(t))},update:function(e,t,n,r,i){return m.d.template.update(e,m.d.foreach.kc(t),n,r,i)}};m.h.ta.foreach=!1;m.e.V.foreach=!0;m.d.hasfocus={init:function(e,t,n){function r(r){e.__ko_hasfocusUpdating=!0;var i=e.ownerDocument;if("activeElement"in i){var s;try{s=i.activeElement}catch(e){s=i.body}r=s===e}i=t();m.h.Ea(i,n,"hasfocus",r,!0);e.__ko_hasfocusLastValue=r;e.__ko_hasfocusUpdating=!1}var i=r.bind(null,!0),s=r.bind(null,!1);m.a.p(e,"focus",i);m.a.p(e,"focusin",i);m.a.p(e,"blur",s);m.a.p(e,"focusout",s)},update:function(e,t){var n=!!m.a.c(t());e.__ko_hasfocusUpdating||e.__ko_hasfocusLastValue===n||(n?e.focus():e.blur(),!n&&e.__ko_hasfocusLastValue&&e.ownerDocument.body.focus(),m.l.w(m.a.Da,null,[e,n?"focusin":"focusout"]))}};m.h.ea.hasfocus=!0;m.d.hasFocus=m.d.hasfocus;m.h.ea.hasFocus=!0;m.d.html={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){m.a.Cb(e,t())}};d("if");d("ifnot",!1,!0);d("with",!0,!1,function(e,t){return e.Zb(t)});m.d.let={init:function(e,t,n,r,i){t=i.extend(t);m.Ka(t,e);return{controlsDescendantBindings:!0}}};m.e.V.let=!0;var A,O={};m.d.options={init:function(e){if("select"!==m.a.A(e))throw Error("options binding applies only to SELECT elements");for(;0<e.length;)e.remove(0);return{controlsDescendantBindings:!0}},update:function(e,t,n){function r(){return m.a.La(e.options,function(e){return e.selected})}function i(e,t,n){var r=typeof t;return"function"==r?t(e):"string"==r?e[t]:n}function s(t,r){if(d&&l)m.j.ha(e,m.a.c(n.get("value")),!0);else if(p.length){var i=0<=m.a.o(p,m.j.u(r[0]));m.a.uc(r[0],i);d&&!i&&m.l.w(m.a.Da,null,[e,"change"])}}var u=e.multiple,a=0!=e.length&&u?e.scrollTop:null,f=m.a.c(t()),l=n.get("valueAllowUnset")&&n.has("value"),c=n.get("optionsIncludeDestroyed");t={};var h,p=[];l||(u?p=m.a.fb(r(),m.j.u):0<=e.selectedIndex&&p.push(m.j.u(e.options[e.selectedIndex])));f&&(void 0===f.length&&(f=[f]),h=m.a.La(f,function(e){return c||e===o||null===e||!m.a.c(e._destroy)}),n.has("optionsCaption")&&null!==(f=m.a.c(n.get("optionsCaption")))&&f!==o&&h.unshift(O));var d=!1;t.beforeRemove=function(t){e.removeChild(t)};f=s;n.has("optionsAfterRender")&&"function"==typeof n.get("optionsAfterRender")&&(f=function(e,t){s(0,t);m.l.w(n.get("optionsAfterRender"),null,[t[0],e!==O?e:o])});m.a.Bb(e,h,function(t,r,s){s.length&&(p=!l&&s[0].selected?[m.j.u(s[0])]:[],d=!0);r=e.ownerDocument.createElement("option");t===O?(m.a.$a(r,n.get("optionsCaption")),m.j.ha(r,o)):(s=i(t,n.get("optionsValue"),t),m.j.ha(r,m.a.c(s)),t=i(t,n.get("optionsText"),s),m.a.$a(r,t));return[r]},t,f);m.l.w(function(){l?m.j.ha(e,m.a.c(n.get("value")),!0):(u?p.length&&r().length<p.length:p.length&&0<=e.selectedIndex?m.j.u(e.options[e.selectedIndex])!==p[0]:p.length||0<=e.selectedIndex)&&m.a.Da(e,"change")});m.a.Oc(e);a&&20<Math.abs(a-e.scrollTop)&&(e.scrollTop=a)}};m.d.options.xb=m.a.f.I();m.d.selectedOptions={after:["options","foreach"],init:function(e,t,n){m.a.p(e,"change",function(){var r=t(),i=[];m.a.q(e.getElementsByTagName("option"),function(e){e.selected&&i.push(m.j.u(e))});m.h.Ea(r,n,"selectedOptions",i)})},update:function(e,t){if("select"!=m.a.A(e))throw Error("values binding applies only to SELECT elements");var n=m.a.c(t()),r=e.scrollTop;n&&"number"==typeof n.length&&m.a.q(e.getElementsByTagName("option"),function(e){var t=0<=m.a.o(n,m.j.u(e));e.selected!=t&&m.a.uc(e,t)});e.scrollTop=r}};m.h.ea.selectedOptions=!0;m.d.style={update:function(e,t){var n=m.a.c(t()||{});m.a.D(n,function(t,n){null!==(n=m.a.c(n))&&n!==o&&!1!==n||(n="");e.style[t]=n})}};m.d.submit={init:function(e,t,n,r,i){if("function"!=typeof t())throw Error("The value for a submit binding must be a function");m.a.p(e,"submit",function(n){var r,s=t();try{r=s.call(i.$data,e)}finally{!0!==r&&(n.preventDefault?n.preventDefault():n.returnValue=!1)}})}};m.d.text={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){m.a.$a(e,t())}};m.e.V.text=!0;(function(){if(u&&u.navigator)var e=function(e){if(e)return parseFloat(e[1])},t=u.opera&&u.opera.version&&parseInt(u.opera.version()),n=u.navigator.userAgent,r=e(n.match(/^(?:(?!chrome).)*version\/([^ ]*) safari/i)),i=e(n.match(/Firefox\/([^ ]*)/));if(10>m.a.C)var s=m.a.f.I(),a=m.a.f.I(),f=function(e){var t=this.activeElement;(t=t&&m.a.f.get(t,a))&&t(e)},l=function(e,t){var n=e.ownerDocument;m.a.f.get(n,s)||(m.a.f.set(n,s,!0),m.a.p(n,"selectionchange",f));m.a.f.set(e,a,t)};m.d.textInput={init:function(e,n,s){function u(t,n){m.a.p(e,t,n)}function a(){c||(h=e.value,c=m.a.setTimeout(f,4))}function f(){clearTimeout(c);h=c=o;var t=e.value;p!==t&&(p=t,m.h.Ea(n(),s,"textInput",t))}var c,h,p=e.value,d=9==m.a.C?a:f;10>m.a.C?(u("propertychange",function(e){"value"===e.propertyName&&d(e)}),8==m.a.C&&(u("keyup",f),u("keydown",f)),8<=m.a.C&&(l(e,d),u("dragend",a))):(u("input",f),5>r&&"textarea"===m.a.A(e)?(u("keydown",a),u("paste",a),u("cut",a)):11>t?u("keydown",a):4>i&&(u("DOMAutoComplete",f),u("dragdrop",f),u("drop",f)));u("change",f);m.m(function t(){var r=m.a.c(n());null!==r&&r!==o||(r="");h!==o&&r===h?m.a.setTimeout(t,4):e.value!==r&&(p=r,e.value=r)},null,{i:e})}};m.h.ea.textInput=!0;m.d.textinput={preprocess:function(e,t,n){n("textInput",e)}}})();m.d.uniqueName={init:function(e,t){if(t()){var n="ko_unique_"+ ++m.d.uniqueName.Jc;m.a.tc(e,n)}}};m.d.uniqueName.Jc=0;m.d.value={after:["options","foreach"],init:function(e,t,n){if("input"!=e.tagName.toLowerCase()||"checkbox"!=e.type&&"radio"!=e.type){var r=["change"],i=n.get("valueUpdate"),s=!1,o=null;i&&("string"==typeof i&&(i=[i]),m.a.ra(r,i),r=m.a.Ub(r));var u=function(){o=null;s=!1;var r=t(),i=m.j.u(e);m.h.Ea(r,n,"value",i)};!m.a.C||"input"!=e.tagName.toLowerCase()||"text"!=e.type||"off"==e.autocomplete||e.form&&"off"==e.form.autocomplete||-1!=m.a.o(r,"propertychange")||(m.a.p(e,"propertychange",function(){s=!0}),m.a.p(e,"focus",function(){s=!1}),m.a.p(e,"blur",function(){s&&u()}));m.a.q(r,function(t){var n=u;m.a.od(t,"after")&&(n=function(){o=m.j.u(e);m.a.setTimeout(u,0)},t=t.substring(5));m.a.p(e,t,n)});var a=function(){var r=m.a.c(t()),i=m.j.u(e);if(null!==o&&r===o)m.a.setTimeout(a,0);else if(r!==i)if("select"===m.a.A(e)){var s=n.get("valueAllowUnset");(i=function(){m.j.ha(e,r,s)})();s||r===m.j.u(e)?m.a.setTimeout(i,0):m.l.w(m.a.Da,null,[e,"change"])}else m.j.ha(e,r)};m.m(a,null,{i:e})}else m.Ja(e,{checkedValue:t})},update:function(){}};m.h.ea.value=!0;m.d.visible={update:function(e,t){var n=m.a.c(t()),r="none"!=e.style.display;n&&!r?e.style.display="":!n&&r&&(e.style.display="none")}};A="click",m.d[A]={init:function(e,t,n,r,i){return m.d.event.init.call(this,e,function(){var e={};e[A]=t();return e},n,r,i)}};m.O=function(){};m.O.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource")};m.O.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock")};m.O.prototype.makeTemplateSource=function(e,t){if("string"==typeof e){var n=(t=t||a).getElementById(e);if(!n)throw Error("Cannot find template with ID "+e);return new m.v.n(n)}if(1==e.nodeType||8==e.nodeType)return new m.v.qa(e);throw Error("Unknown template type: "+e)};m.O.prototype.renderTemplate=function(e,t,n,r){e=this.makeTemplateSource(e,r);return this.renderTemplateSource(e,t,n,r)};m.O.prototype.isTemplateRewritten=function(e,t){return!1===this.allowTemplateRewriting||this.makeTemplateSource(e,t).data("isRewritten")};m.O.prototype.rewriteTemplate=function(e,t,n){t=t((e=this.makeTemplateSource(e,n)).text());e.text(t);e.data("isRewritten",!0)};m.b("templateEngine",m.O);m.Gb=(function(){function e(e,t,n,r){e=m.h.yb(e);for(var i=m.h.ta,s=0;s<e.length;s++){var o=e[s].key;if(i.hasOwnProperty(o)){var u=i[o];if("function"==typeof u){if(o=u(e[s].value))throw Error(o)}else if(!u)throw Error("This template engine does not support the '"+o+"' binding within its templates")}}n="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+m.h.Va(e,{valueAccessors:!0})+" } })()},'"+n.toLowerCase()+"')";return r.createJavaScriptEvaluatorBlock(n)+t}var t=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'|[^>]*))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,n=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{Pc:function(e,t,n){t.isTemplateRewritten(e,n)||t.rewriteTemplate(e,function(e){return m.Gb.ed(e,t)},n)},ed:function(r,i){return r.replace(t,function(t,n,r,s,o){return e(o,n,r,i)}).replace(n,function(t,n){return e(n,"\x3c!-- ko --\x3e","#comment",i)})},Fc:function(e,t){return m.M.wb(function(n,r){var i=n.nextSibling;i&&i.nodeName.toLowerCase()===t&&m.Ja(i,e,r)})}}})();m.b("__tr_ambtns",m.Gb.Fc);(function(){m.v={};m.v.n=function(e){if(this.n=e){var t=m.a.A(e);this.bb="script"===t?1:"textarea"===t?2:"template"==t&&e.content&&11===e.content.nodeType?3:4}};m.v.n.prototype.text=function(){var e=1===this.bb?"text":2===this.bb?"value":"innerHTML";if(0==arguments.length)return this.n[e];var t=arguments[0];"innerHTML"===e?m.a.Cb(this.n,t):this.n[e]=t};var e=m.a.f.I()+"_";m.v.n.prototype.data=function(t){if(1===arguments.length)return m.a.f.get(this.n,e+t);m.a.f.set(this.n,e+t,arguments[1])};var t=m.a.f.I();m.v.n.prototype.nodes=function(){var e=this.n;if(0==arguments.length)return(m.a.f.get(e,t)||{}).jb||(3===this.bb?e.content:4===this.bb?e:o);m.a.f.set(e,t,{jb:arguments[0]})};m.v.qa=function(e){this.n=e};m.v.qa.prototype=new m.v.n;m.v.qa.prototype.text=function(){if(0==arguments.length){var e=m.a.f.get(this.n,t)||{};e.Hb===o&&e.jb&&(e.Hb=e.jb.innerHTML);return e.Hb}m.a.f.set(this.n,t,{Hb:arguments[0]})};m.b("templateSources",m.v);m.b("templateSources.domElement",m.v.n);m.b("templateSources.anonymousTemplate",m.v.qa)})();(function(){function e(e,t,n){var r;for(t=m.e.nextSibling(t);e&&(r=e)!==t;)n(r,e=m.e.nextSibling(r))}function t(t,n){if(t.length){var r=t[0],i=t[t.length-1],s=r.parentNode,o=m.R.instance,u=o.preprocessNode;if(u){e(r,i,function(e,t){var n=e.previousSibling,s=u.call(o,e);s&&(e===r&&(r=s[0]||t),e===i&&(i=s[s.length-1]||n))});t.length=0;if(!r)return;r===i?t.push(r):(t.push(r,i),m.a.za(t,s))}e(r,i,function(e){1!==e.nodeType&&8!==e.nodeType||m.Sb(n,e)});e(r,i,function(e){1!==e.nodeType&&8!==e.nodeType||m.M.Ac(e,[n])});m.a.za(t,s)}}function n(e){return e.nodeType?e:0<e.length?e[0]:null}function r(e,r,i,o,u){u=u||{};var a=(e&&n(e)||i||{}).ownerDocument,f=u.templateEngine||s;m.Gb.Pc(i,f,a);if("number"!=typeof(i=f.renderTemplate(i,o,u,a)).length||0<i.length&&"number"!=typeof i[0].nodeType)throw Error("Template engine must return an array of DOM nodes");a=!1;switch(r){case"replaceChildren":m.e.da(e,i);a=!0;break;case"replaceNode":m.a.sc(e,i);a=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+r)}a&&(t(i,o),u.afterRender&&m.l.w(u.afterRender,null,[i,o.$data]));return i}function i(e,t,n){return m.H(e)?e():"function"==typeof e?e(t,n):e}var s;m.Db=function(e){if(e!=o&&!(e instanceof m.O))throw Error("templateEngine must inherit from ko.templateEngine");s=e};m.Ab=function(e,t,u,a,f){if(((u=u||{}).templateEngine||s)==o)throw Error("Set a template engine before calling renderTemplate");f=f||"replaceChildren";if(a){var l=n(a);return m.B(function(){var s=t&&t instanceof m.Q?t:new m.Q(t,null,null,null,{exportDependencies:!0}),o=i(e,s.$data,s);s=r(a,f,o,s,u);"replaceNode"==f&&(l=n(a=s))},null,{wa:function(){return!l||!m.a.nb(l)},i:l&&"replaceNode"==f?l.parentNode:l})}return m.M.wb(function(n){m.Ab(e,t,u,n,"replaceNode")})};m.ld=function(e,n,s,u,a){function f(e,n){t(n,c);s.afterRender&&s.afterRender(n,e);c=null}function l(t,n){c=a.createChildContext(t,s.as,function(e){e.$index=n});return r(null,"ignoreTargetNode",i(e,t,c),c,s)}var c;return m.B(function(){var e=m.a.c(n)||[];void 0===e.length&&(e=[e]);e=m.a.La(e,function(e){return s.includeDestroyed||e===o||null===e||!m.a.c(e._destroy)});m.l.w(m.a.Bb,null,[u,e,l,s,f])},null,{i:u})};var u=m.a.f.I();m.d.template={init:function(e,t){var n=m.a.c(t());if("string"==typeof n||n.name)m.e.xa(e);else{if("nodes"in n){if(n=n.nodes||[],m.H(n))throw Error('The "nodes" option must be a plain, non-observable array.')}else n=m.e.childNodes(e);n=m.a.lc(n);new m.v.qa(e).nodes(n)}return{controlsDescendantBindings:!0}},update:function(e,t,n,r,i){var s=t();n=!0;r=null;"string"==typeof(t=m.a.c(s))?t={}:(s=t.name,"if"in t&&(n=m.a.c(t.if)),n&&"ifnot"in t&&(n=!m.a.c(t.ifnot)));"foreach"in t?r=m.ld(s||e,n&&t.foreach||[],t,e,i):n?(i="data"in t?i.Zb(t.data,t.as):i,r=m.Ab(s||e,i,t,e)):m.e.xa(e);i=r;(t=m.a.f.get(e,u))&&"function"==typeof t.k&&t.k();m.a.f.set(e,u,i&&i.ba()?i:o)}};m.h.ta.template=function(e){return 1==(e=m.h.yb(e)).length&&e[0].unknown||m.h.bd(e,"name")?null:"This template engine does not support anonymous templates nested within its templates"};m.e.V.template=!0})();m.b("setTemplateEngine",m.Db);m.b("renderTemplate",m.Ab);m.a.fc=function(e,t,n){if(e.length&&t.length){var r,i,s,o,u;for(r=i=0;(!n||r<n)&&(o=e[i]);++i){for(s=0;u=t[s];++s)if(o.value===u.value){o.moved=u.index;u.moved=o.index;t.splice(s,1);r=s=0;break}r+=s}}};m.a.ib=(function(){function e(e,t,n,r,i){var s,o,u,a,f,l=Math.min,c=Math.max,h=[],p=e.length,d=t.length,v=d-p||1,g=p+d+1;for(s=0;s<=p;s++)for(a=u,h.push(u=[]),f=l(d,s+v),o=c(0,s-1);o<=f;o++)u[o]=o?s?e[s-1]===t[o-1]?a[o-1]:l(a[o]||g,u[o-1]||g)+1:o+1:s+1;l=[];c=[];v=[];s=p;for(o=d;s||o;)d=h[s][o]-1,o&&d===h[s][o-1]?c.push(l[l.length]={status:n,value:t[--o],index:o}):s&&d===h[s-1][o]?v.push(l[l.length]={status:r,value:e[--s],index:s}):(--o,--s,i.sparse||l.push({status:"retained",value:t[o]}));m.a.fc(v,c,!i.dontLimitMoves&&10*p);return l.reverse()}return function(t,n,r){r="boolean"==typeof r?{dontLimitMoves:r}:r||{};n=n||[];return(t=t||[]).length<n.length?e(t,n,"added","deleted",r):e(n,t,"deleted","added",r)}})();m.b("utils.compareArrays",m.a.ib);(function(){function e(e,t,n,r,i){var s=[],u=m.B(function(){var o=t(n,i,m.a.za(s,e))||[];0<s.length&&(m.a.sc(s,o),r&&m.l.w(r,null,[n,o,i]));s.length=0;m.a.ra(s,o)},null,{i:e,wa:function(){return!m.a.Rb(s)}});return{ca:s,B:u.ba()?u:o}}var t=m.a.f.I(),n=m.a.f.I();m.a.Bb=function(r,i,s,u,a){function f(e,t){S=p[t];b!==t&&(N[e]=S);S.qb(b++);m.a.za(S.ca,r);g.push(S);E.push(S)}function l(e,t){if(e)for(var n=0,r=t.length;n<r;n++)t[n]&&m.a.q(t[n].ca,function(r){e(r,n,t[n].ja)})}i=i||[];u=u||{};var c,h=m.a.f.get(r,t)===o,p=m.a.f.get(r,t)||[],d=m.a.fb(p,function(e){return e.ja}),v=m.a.ib(d,i,u.dontLimitMoves),g=[],y=0,b=0,w=[],E=[];i=[];for(var S,x,T,N=[],C=(d=[],0);x=v[C];C++)switch(T=x.moved,x.status){case"deleted":T===o&&((S=p[y]).B&&(S.B.k(),S.B=o),m.a.za(S.ca,r).length&&(u.beforeRemove&&(g.push(S),E.push(S),S.ja===n?S=null:i[C]=S),S&&w.push.apply(w,S.ca)));y++;break;case"retained":f(C,y++);break;case"added":T!==o?f(C,T):(S={ja:x.value,qb:m.N(b++)},g.push(S),E.push(S),h||(d[C]=S))}m.a.f.set(r,t,g);l(u.beforeMove,N);m.a.q(w,u.beforeRemove?m.$:m.removeNode);for(C=0,h=m.e.firstChild(r);S=E[C];C++){S.ca||m.a.extend(S,e(r,s,S.ja,a,S.qb));for(y=0;v=S.ca[y];h=v.nextSibling,c=v,y++)v!==h&&m.e.ic(r,v,c);!S.Xc&&a&&(a(S.ja,S.ca,S.qb),S.Xc=!0)}l(u.beforeRemove,i);for(C=0;C<i.length;++C)i[C]&&(i[C].ja=n);l(u.afterMove,N);l(u.afterAdd,d)}})();m.b("utils.setDomNodeChildrenFromArrayMapping",m.a.Bb);m.X=function(){this.allowTemplateRewriting=!1};m.X.prototype=new m.O;m.X.prototype.renderTemplateSource=function(e,t,n,r){if(t=9>m.a.C||!e.nodes?null:e.nodes())return m.a.W(t.cloneNode(!0).childNodes);e=e.text();return m.a.ma(e,r)};m.X.sb=new m.X;m.Db(m.X.sb);m.b("nativeTemplateEngine",m.X);(function(){m.vb=function(){var e=this.ad=(function(){if(!l||!l.tmpl)return 0;try{if(0<=l.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(e){}return 1})();this.renderTemplateSource=function(t,n,r,i){i=i||a;r=r||{};if(2>e)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var s=t.data("precompiled");s||(s=t.text()||"",s=l.template(null,"{{ko_with $item.koBindingContext}}"+s+"{{/ko_with}}"),t.data("precompiled",s));t=[n.$data];n=l.extend({koBindingContext:n},r.templateOptions);(n=l.tmpl(s,t,n)).appendTo(i.createElement("div"));l.fragments={};return n};this.createJavaScriptEvaluatorBlock=function(e){return"{{ko_code ((function() { return "+e+" })()) }}"};this.addTemplate=function(e,t){a.write("<script type='text/html' id='"+e+"'>"+t+"<\/script>")};0<e&&(l.tmpl.tag.ko_code={open:"__.push($1 || '');"},l.tmpl.tag.ko_with={open:"with($1) {",close:"} "})};m.vb.prototype=new m.O;var e=new m.vb;0<e.ad&&m.Db(e);m.b("jqueryTmplTemplateEngine",m.vb)})()})})()},function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(30),s=n(7),o=n(13),u=n(384),a=n(69),f=n(137),l=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=r,s=i.resources,a=i.observables,l=n.getCurrentItem,c=void 0===l?s.consume(o.i.lazy.optional):l,h=n.getItemSetSelectionModel,p=void 0===h?s.consume(o.g.lazy.optional):h,d=n.getSelectionHelper,v=void 0===d?s.consume(u.e.lazy.optional):d,m=t.allowMultiSelect,g=void 0!==m&&m,y=t.canFallback,b=void 0!==y&&y,w=t.ignoreSelection,E=void 0!==w&&w,S=t.overrideItem,x=t.useCurrentSelectionGroup,T=void 0!==x&&x;r._allowMultiSelect=g;r._overrideItem=S;r._ignoreSelection=E;r._useCurrentSelectionGroup=T;r._placeholder=r.observables.create(new f.e);r._getSelectionModel=p;S||(r._selectionHelper=v&&v());b&&c&&(r._fallback=c());r.selection=a.pureCompute(r._computeSelection);r.firstItem=a.pureCompute(r._computeFirstItem);r.currentItem=a.pureCompute(function(){return(c&&c()||r._placeholder)()});return r}t.prototype.filterItems=function(e){var t=this.selection();if(!t.length)return!1;for(var n=this.observables,r=0,i=t;r<i.length;r++){var s=i[r],o=n.unwrap(s);if(!o)return!0;if(!e(o))return!1}return!0};t.prototype.resolveSelection=function(){var e=this;return this._resolveSelection().then(function(t){if(t&&t.length)return t;if(e._fallback){var n=e._fallback.peek();if(n)return[n]}return[]})};t.prototype.resolveFirst=function(){var e=this;return this._resolveSelection().then(function(t){return t&&t.length?t[0]:e._fallback?e._fallback.peek():void 0})};t.prototype.selectItems=function(e){var t=this._getSelectionModel();t&&t.setSelectedKeys(e.map(function(e){return e.key}))};t.prototype.clearSelection=function(){var e=this._getSelectionModel();e&&e.clear()};t.prototype.selectAll=function(){var e=this._getSelectionModel();e&&e.selectAll()};t.prototype._computeSelection=function(){var e=this._getCurrentSelection();return!this._allowMultiSelect&&e.length>1?[]:e||[]};t.prototype._computeFirstItem=function(){var e=this.selection();return e&&e[0]&&e[0]()};t.prototype._getCurrentSelection=function(){if(this._overrideItem)return[this._overrideItem];var e,t=this._getSelectionModel();if(t){if(this._useCurrentSelectionGroup&&t.getSelectionModelGroup()){var n=t.getSelectionModelGroup().currentSelection();n&&(t=n)}e=t.selection()}else e=[];(0===e.length||this._ignoreSelection)&&this._fallback&&(e=[this._fallback]);return e};t.prototype._resolveSelection=function(){var e=this;if(this._overrideItem)return i.n.resolve([this._overrideItem.peek()]);var t=this.observables.ignore(function(){return e._computeSelection()});if(this._ignoreSelection||!t.length)return i.n.resolve([]);var n=this._selectionHelper;return n?n.resolveSelection():i.n.reject(new Error("Unable to resolve selection."))};return t})(s.n),c=Object(a.o)("ItemSelectionHelper",l,Object(r.__assign)(Object(r.__assign)({},s.n.dependencies),{currentItem:o.i.lazy.optional,itemSetSelectionModel:o.g.lazy.optional,selectionHelper:u.e.lazy.optional}))},,,,function(e,t,n){"use strict";n.d(t,"t",function(){return ae});var r,i=n(0),s=n(28),o=n(17),u=n(5),a=n(75),f=n(66),l=n(57),c=n(29);(function(e){e[e.iosappstore=0]="iosappstore"})(r||(r={}));var h=r,p=n(2),d=n(20),v=n(71),m=n(183),g=n(89),y=n(313),b=n(177),w=n(267),E=n(151),S=n(45),x=n(3),T=n(69),N=n(90),C=n(36),k=n(140),L=n(15);var A,O=n(350),M=n(32),_=n(142),D=n(195),P=n(110),H=n(16);(function(e){e[e.current=0]="current";e[e.focus=1]="focus";e[e.external=2]="external"})(A||(A={}));function B(e){var t=e.itemInfo,n=e.urlType,r=void 0===n?"default":n,i=e.preserveAction,u=void 0!==i&&i,a=e.viewParams,l=t.itemType,h=e.action,p=void 0===h?u&&Object(L.s)(a)||void 0:h,v=(function(e){var t;switch(e){case s.e.Media:t=A.focus;break;case s.e.Folder:case s.e.Error:t=A.current;break;default:t=A.external}return t})(l),m=!!H.e.isActivated("CBF950BB-C412-4331-9430-066677E49966","10/21/2021","Compute OneUp URL for media items in mount points")||l!==s.e.Media;a.mid&&m&&(v=A.current);return(function(e,t){var n=t.itemInfo,r=t.parentItemInfo,i=t.viewParams,u=t.useOneUpTextEditor,a=t.queryType,l=t.page,h=void 0===l?Object(L.E)(i):l,p=n.itemKey,v=n.itemExtension,m=n.itemType;if(e!==A.current&&h===o.e.FilePicker)return"";var g,y=Object(L.m)(p);if(Object(M.g)(a)&&!Object(M.g)(Object(L.N)(y)))return"";if(v&&Object(k.n)(v,m))e=u&&h!==o.e.TextFileEditor?A.focus:A.external;else if(h===o.e.TextFileEditor&&Object(L.s)(i)===c.t.createTextDocument)return"#"+d.n(i,null,!0);switch(e){case A.current:g=(function(e){var t=e.itemInfo,n=e.preserveAction,r=e.action,i=e.viewParams,s=e.page,o=e.additionalViewParams,u=t.itemKey;if(t.itemIsStub){var a=Object(L.l)(i);if(a){if(Object(L.s)(i)===c.t.locate)return"";delete i.viewer;return q({itemInfo:{itemKey:a},parentItemInfo:t,action:c.t.locate,viewParams:i})}}return Object(L.d)({itemKey:u,itemInfo:t,preserveAction:n,action:r,viewParams:i,page:s,additionalViewParams:o})})(t);break;case A.focus:g=I(t);break;default:g=(function(e){var t,n=e.itemInfo,r=e.viewParams,i=F({itemInfo:n,parentItemInfo:e.parentItemInfo}),o=n.itemKey,u=n.openItemByDefault,a=n.itemExtension,l=n.itemType,h=n.itemErrorType,p=n.itemOpenUrl;t=l===s.e.Error?(function(e){var t,n=e.itemKey,r=e.viewParams;switch(e.itemErrorType||f.e.requestFailed){case f.e.marketBlocked:return Object(L.y)();case f.e.userNotReady:return Object(L.P)(Object(L.d)({itemKey:n,viewParams:r}));case f.e.accessDenied:var i=r.lor;return i&&i.toLowerCase()===_.n?"?".concat("v","=").concat("error","&").concat("type","=").concat(_.t):Object(L.H)(Object(L.d)({itemKey:n,viewParams:r,additionalViewParams:(t={},t.sc=r.sc||"",t)}));case f.e.authenticationExpired:return Object(L.H)(Object(L.d)({itemKey:n,viewParams:r}),!0);case f.e.userSuspended:var s=Object(L.s)(r)===c.t.feedback?c.t.feedback:void 0;return S.t.si?Object(L.H)(Object(L.d)({itemKey:n,viewParams:r,action:s}),!0):Object(L.d)({itemKey:n,action:s,viewParams:r});case f.e.passwordRequired:return Object(L.A)(r);case f.e.requestAccess:return Object(L.C)(r)}return Object(L.d)({itemKey:n,viewParams:r})})({itemKey:o,viewParams:r,itemErrorType:h}):a&&Object(k.n)(a,l)?j({itemInfo:n,parentItemInfo:i,viewParams:r}):void 0===u||u?u&&p&&-1===p.indexOf("redir.aspx")||a&&(".fluid"===a.toLowerCase()||".loop"===a.toLowerCase())?p:I({itemInfo:n,parentItemInfo:i,action:c.t.locate,viewParams:r}):I({itemInfo:n,parentItemInfo:i,action:c.t.defaultClick,viewParams:r});return t})({itemInfo:n,parentItemInfo:r,viewParams:i})}return g})(l===s.e.Error?A.external:"existing"===r?(function(e){var t;t=Object(L.l)(e)?A.focus:A.current;return t})(a):"focus"===r||p?p&&p!==c.t.locate&&v===A.current?v:A.focus:v,e)}function j(e){var t=e.itemInfo,n=e.parentItemInfo,r=e.viewParams,i=n&&n.itemKey,s=Object(L.p)({itemKey:t.itemKey,itemInfo:t,page:o.e.TextFileEditor,viewParams:r}),u=Object(L.m)(i||"");s.parId=u.id;var a=d.n(s,null,!0);return"TextFileEditor"!==r.v?Object(L.a)(2,a):"#"+a}function F(e){var t=e.itemInfo,n=e.parentItemInfo;return H.e.isActivated("6DCD168B-9EA1-4AD3-A81F-12E38ED97BF2","10/21/2021","Use getParentItemInfo")?n:n&&n.itemKey!==t.itemKey&&n||t.parentFolderItemInfo}function I(e){var t,n=e.itemInfo,r=F({itemInfo:n,parentItemInfo:e.parentItemInfo}),s=!1;H.e.isActivated("1065E6DF-81FE-4F4A-BB9A-625CC03793AA","10/21/2021","Compute URL using AllPhotos parentKey")||(s=Boolean("photos"===e.viewParams.v&&(n.itemIsVideo||n.itemIsPhoto)&&"allmyphotos"!==e.viewParams.qt&&!e.viewParams.parId&&!e.viewParams.parQt&&r&&!r.itemIsAlbum));var o=e;if(s){var u=Object(L.v)(((t={}).qt="allmyphotos",t.id="root",t.cid=L.j,t));o=Object(i.__assign)(Object(i.__assign)({},e),{parentItemInfo:{itemKey:u}})}return q(o)}function q(e){var t=e.itemInfo,n=e.parentItemInfo,r=e.viewParams,s=e.additionalViewParams,o=n&&n.itemKey||"",u=Object(L.m)(t.itemKey),a=Object(L.p)(Object(i.__assign)(Object(i.__assign)({},e),{itemKey:o,itemInfo:n}));s&&Object(P.e)(u,s);r&&r.commentId&&(u.commentId=r.commentId);u.parId=a.id;u.parQt=a.qt;if(u.cid!==a.cid){u.parCid=a.cid;delete a.cid}delete a.internalPath;delete a.qt;delete a.id;delete u.u;var f=a.action;if(f)if(r&&r.commentId&&"showproperties"===f.toLowerCase()){delete a.action;u.o=_.i}else{delete a.action;u.action=f}else u.o=_.i;return"#"+d.n(u,a,!0)}var R=n(268),U=n(42),z=n(105);function W(){var e="".concat("ps-hasProvision-").concat(Object(z.e)(L.j));return localStorage.getItem(e)}function X(){return Object(p.isFeatureEnabled)(p.EnableVroomEmailSettings)||(function(){if(!H.e.isActivated("D5468AE0-1714-40CA-A48A-0C7FB08CB87C","08/26/2022","Disable Photo Story for Converged User")&&Object(U.e)(L.j))return!1;var e=!H.e.isActivated("51EBAB33-7AA2-422B-A5FF-BF99D5296EC4","02/15/2022","Enable Photo story for users who were invited")&&"true"===W(),t=-1!==navigator.userAgent.indexOf("OneDriveWinApp");try{t=t||!!window.sessionStorage.getItem("_isOneDriveWinApp")}catch(e){}return!t&&(Object(p.isFeatureEnabled)(p.EnablePhotoStream)||e)})()}var V,$,J=n(253),K=n(553),Q=n(39),G=window.$Config&&window.$Config.isINT,Y=window.FilesConfig&&window.FilesConfig.skyApiDomain,Z=window.FilesConfig&&window.FilesConfig.storageDomain,ee=window.FilesConfig&&window.FilesConfig.mpcDomain;(function(e){e[e.DateCreated=0]="DateCreated";e[e.DateModified=1]="DateModified"})($||($={}));var te=H.e.isActivated("6CEBAB53-E3AA-4B32-A437-CEC98812ABB4","10/21/2021","Refactor URL DataSource"),ne=!H.e.isActivated("71CADB9F-8CE9-47DA-A4A3-0340D883A255","03/02/2023","Propogates redeemTokem if available in WAC open URLs"),re=!H.e.isActivated("CA949581-487C-4A90-9D63-81958797F222","10/21/2021","Fast OneUp in ODC")&&Object(p.isFeatureEnabled)(p.UseItemsScopeInOneDrive),ie=new x.t({name:"".concat("UrlDataSource",".useOneUpTextEditor"),factory:new x.e(Object(p.isFeatureEnabled)(p.UseOneUpTextEditor))}),se=new x.t({name:"".concat("UrlDataSource",".useRefactoredGetDefaultClickUrl"),factory:new x.e(!te)}),oe=new x.t({name:"".concat("UrlDataSource",".enableFastOneUp"),factory:new x.e(re)}),ue=(function(){function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var n=this,r=t.navigation,i=void 0===r?this.resources.consume(C.e):r,s=t.useOneUpTextEditor,o=void 0===s?this.resources.consume(ie):s,u=t.enableFastOneUp,a=void 0===u?this.resources.consume(oe):u,f=t.useRefactoredDefaultClickUrl,l=void 0===f?this.resources.consume(se):f;this._navigation=i;this._useOneUpTextEditor=o;this._enableFastOneUp=a;this._useRefactoredDefaultClickUrl=l;this.getCurrentPageBaseUrl=e&&e._getCurrentPageBaseUrl||(this._useRefactoredDefaultClickUrl?L.u:this.getCurrentPageBaseUrl);this._getCurrentUrlPathName=e&&e._getCurrentUrlPathName||this._getCurrentUrlPathName;this._events=new N.t(this);(this._mayBeFastOneUp=this._enableFastOneUp&&Object(p.isFeatureEnabled)(p.UseItemsScopeInOneDrive)&&!!this.getFocusItemKey(this._navigation.viewParams))&&this._events.on(this._navigation,"change",function(){if(!n.getFocusItemKey(n._navigation.viewParams)){n._mayBeFastOneUp=!1;n._events.off(n._navigation)}})}e.getKey=function(e){void 0===e&&(e={});return Object(L.v)(e)};e.getKeyParams=function(e){return Object(L.m)(e)};e.getIsSyncUserBusiness=function(e){return"b"===e.pt};e.getWtMcIdParamKeyIsSync=function(e){var t=e.ocid||e["WT.mc_id"];return t&&t.toLowerCase().indexOf("sync")>=0};e.getRedeemCodeParam=function(e){var t=e.redeemCode;return"undefined"===t?"":t};e.getProfileImage=function(t){return e.storageBaseUrl+"/users/0x"+t+"/myprofile/expressionprofile/profilephoto:UserTileLarge,UserTileStatic/MeControlMediumUserTile?ck=1&ex=24&fofoff=1"};e.getTermsUrl=function(){return"https://g.live.com/8seskydrive/tou"};e.getPrivacyUrl=function(){return"https://go.microsoft.com/fwlink/?LinkId=521839"};e.getImpressumUrl=function(){return Object(L.c)()};e.getResourceRedirectUrl=function(e){return"https://onedrive.live.com/redir.aspx?"+d.n({resid:e})};e.encodeSharingUrl=function(e){return Object(M.e)(e)};e.getThumbnailUrl=function(t,n,r,i){i=i||r;return v.o(e.storageBaseUrl+"/Items/{1}:CustomThumbnailSource,HighRes,Default?{2}",t,n,d.n({width:r,height:i,cropmode:"center"}))};e.getVroomBaseUrl=function(e){return Object(M.o)(e)};e.getAutoRedeemRedirectUrl=function(t){var n="",r=t.viewParams,i=r.id,s=r.cid,o=r.action;r.autoredeeem&&i&&s&&o&&(n=e.getAutoRedeemLoginUrl(i,s,o,t));return n};e.getAutoRedeemLoginUrl=function(t,n,r,i){var s,o=e._getAutoRedeemUrl(t,n,r,!1,i.viewParams),u=((s={}).ru=o,s.wreply=o,s);return S.t.signInUrl+"&"+d.n(u,null,!0)};e.getAutoRedeemLogoutUrl=function(t,n,r,i){var s,o=e._getAutoRedeemUrl(t,n,r,!0,i.viewParams),u=((s={}).lru=o,s);return S.t.autoRedeemSignOut+"&"+d.n(u,null,!0)};e.getCookieDomain=function(){return window.$Config.sd};e.getEnvironment=function(){return Object(D.e)()};e.areCidsEqual=function(e,t){return Object(O.e)(e,t)};e._getAutoRedeemUrl=function(e,t,n,r,i){var s,o=((s={}).id=e,s.cid=t,s.action=n,s.authkey=i.authkey,s);r&&(o.autoredeeem="1");return window.location.protocol+"//"+window.location.host+document.location.pathname+"?"+d.n(o,null,!0)};e.prototype.getDefaultRootItemId=function(){return"root"};e.prototype.getKey=function(t){return e.getKey(t)};e.prototype.getKeyParams=function(e){return Object(L.m)(e)};e.prototype.getRequestAccessLogoutUrl=function(e,t,n){var r,i,s=((r={resid:e,ithint:t}).challengeToken=n,r.v="requestaccess",r),o=window.location.protocol+"//"+window.location.host+document.location.pathname+"?"+d.n(s,null,!0),u=((i={}).lru=o,i);return S.t.autoRedeemSignOut+"&"+d.n(u,null,!0)};e.prototype.getItemHintRedirectViewParams=function(e){void 0===e&&(e={});return Object(L.h)(e)};e.prototype.getQueryType=function(e){void 0===e&&(e=this._navigation.viewParams);return Object(L.N)(e)};e.prototype.getPhotoType=function(e){return Object(L.x)(e)};e.prototype.getPageType=function(e,t){void 0===e&&(e=this._navigation.viewParams);return Object(L.E)(e,this._mayBeFastOneUp||t)};e.prototype.getViewerType=function(e){return(function(e){var t=e.viewer;switch(t){case"3d":case"Audio":case"Error":case"FileHandler":case"Html":case"OnePlayerVideo":case"OnePlayerAudio":case"Other":case"Panorama":case"Image360":case"Pdf":case"MSPdf":case"Photo":case"TextFile":case"Thumbnail":case"Video":case"WAC":case"Wrs":case"Zip":return t}})(e)};e.prototype.saveViewerType=function(e){return(function(e){var t;return(t={}).viewer=e,t})(e)};e.prototype.getFocusItemKey=function(e){void 0===e&&(e=this._navigation.viewParams);return Object(L.l)(e)};e.prototype.getCurrentItemKey=function(e){void 0===e&&(e=this._navigation.viewParams);return Object(L.o)(e)};e.prototype.areKeysEqual=function(e,t){var n=this.getKeyParams(e),r=this.getKeyParams(t);delete n.u;delete r.u;return this.getKey(n)===this.getKey(r)};e.prototype.getRootItemKey=function(e){void 0===e&&(e=u.e.Files);return Object(L.k)(e)};e.prototype.isRecycleBin=function(e){return this._useRefactoredDefaultClickUrl?Object(M.g)(e):e===u.e.RecycleBin};e.prototype.isCurrentQueryPhotoStream=function(e){void 0===e&&(e=this._navigation.viewParams);return"photostream"===e.qt};e.prototype.isCurrentQueryFiles=function(e){void 0===e&&(e=this._navigation.viewParams);var t=!H.e.isActivated("4B9ACAFF-DC04-4EA0-93FF-9439B92FD516","10/21/2021","Check is Search in Files pivot")&&(e.searchsessionid||"search"===e.parQt);return Object(L.D)(e)||0===Object.keys(e).length||!e.qt&&!e.v&&!t&&Object(L.n)(e)};e.prototype.isCurrentQueryRecent=function(e){void 0===e&&(e=this._navigation.viewParams);return"mru"===e.qt};e.prototype.isCurrentQuerySharedWithMe=function(e){void 0===e&&(e=this._navigation.viewParams);return Object(L.M)(e)};e.prototype.isCurrentQuerySharedByMe=function(e){void 0===e&&(e=this._navigation.viewParams);return"sharedbyme"===e.qt};e.prototype.isCurrentQuerySharedFilesRoot=function(e){void 0===e&&(e=this._navigation.viewParams);return"sharedbyme"===e.qt||"sharedby"===e.qt};e.prototype.isCurrentQueryRecycleBin=function(e){void 0===e&&(e=this._navigation.viewParams);return"recyclebin"===e.qt};e.prototype.getDisableQueryAlteration=function(e){void 0===e&&(e=this._navigation.viewParams);return!1};e.prototype.isCurrentQuery=function(e,t){void 0===t&&(t=this._navigation.viewParams);switch(e){case u.e.Files:return this.isCurrentQueryFiles();case u.e.Recent:return this.isCurrentQueryRecent();case u.e.SharedWithMe:return this.isCurrentQuerySharedWithMe();case u.e.SharedByMe:return this.isCurrentQuerySharedByMe();case u.e.RecycleBin:return this.isCurrentQueryRecycleBin();case u.e.Photos:case u.e.AllMyPhotos:return Object(L.O)(t);case u.e.PhotoStream:return this.isCurrentQueryPhotoStream(t);default:return!!t.qt&&t.qt.toString().toLowerCase()===u.e[e].toString().toLowerCase()}};e.prototype.getFilesQueryUrl=function(){return this._requireAuthentication(this.getItemUrl(this.getKey({}),{page:o.e.Files}))};e.prototype.getRecycleBinQueryUrl=function(){var e;return Object(U.e)(L.j)&&!Object(p.isFeatureEnabled)(p.ApplyItemsScopeToRecycleBin)?"".concat(this.getMpcOneDriveUrl(),"?view=5"):this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt="recyclebin",e)),{page:o.e.Files}))};e.prototype.getRecentQueryUrl=function(){var e;return this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt="mru",e)),{page:o.e.Files}))};e.prototype.getPhotoStreamQueryUrl=function(e,t){var n;void 0===t&&(t=!1);var r=Object(i.__assign)({},this._navigation.viewParams);t||delete r.psShareId;return this._requireAuthentication(this.getItemUrl(this.getKey(((n={}).qt="photostream",n.v="photoStream",n.psId=e||"me",n.psShareId=r.psShareId,n.psPostId=r.psPostId,n.pssc=r.pssc,n)),{page:o.e.PhotoStream,viewParams:r}))};e.prototype.getPhotoStreamMyFeedQueryUrl=function(e){var t;void 0===e&&(e=!1);var n=Object(i.__assign)({},this._navigation.viewParams);e||delete n.psShareId;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="photostream",t.v="photoStream",t.psShareId=n.psShareId,t.psPostId=n.psPostId,t.pssc=n.pssc,t)),{page:o.e.PhotoStream,viewParams:n}))};e.prototype.getPhotoStreamShareIdUrl=function(e){var t,n=((t={}).id="root",t.qt="photostream",t.v="photoStream",t.psShareId=e,t);return this.getCurrentPageBaseUrl()+"?"+d.n(n,null,!0)};e.prototype.getPhotoStreamForMojsQueryUrl=function(e,t,n){var r,s=Object(i.__assign)({},this._navigation.viewParams);delete s.psShareId;return this._requireAuthentication(this.getItemUrl(this.getKey(((r={}).qt="photostream",r.v="photoStream",r.mojDate=e,r.moj=t,r.psRIds=n.join(","),r)),{page:o.e.PhotoStream,viewParams:s}))};e.prototype.getAllMyPhotosQueryUrl=function(t){var n;return this._requireAuthentication(this.getItemUrl(this.getKey(((n={}).qt="allmyphotos",n.id=t,n.cid=e.viewerId,n)),{page:o.e.Photos}))};e.prototype.getAlbumsQueryUrl=function(e){var t;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).id="albums",t)),{page:o.e.Photos}))};e.prototype.getTagsQueryUrl=function(e){var t;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).id="tags",t)),{page:o.e.Photos}))};e.prototype.getPlacesQueryUrl=function(e){var t;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).id="places",t)),{page:o.e.Photos}))};e.prototype.getOnThisDayQueryUrl=function(e,t){var n,r;return this._requireAuthentication(this.getItemUrl(this.getKey(((n={}).qt="allmyphotos",n.onThisDay=!0,n.moj="onThisDay",n)),{page:o.e.Photos,additionalViewParams:(r={},r.sc=e&&e.sc||"",r)}))};e.prototype.getOnThisMonthQueryUrl=function(e){var t,n;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="allmyphotos",t.onThisMonth=!0,t.moj="onThisMonth",t.useUtilityFiltering=e.useUtilityFiltering,t)),{page:o.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))};e.prototype.getLastWeekPreviousYearsQueryUrl=function(e){var t,n;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="allmyphotos",t.lastWeekPreviousYears=!0,t.moj="lastWeekPreviousYears",t.useUtilityFiltering=e.useUtilityFiltering,t)),{page:o.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))};e.prototype.getRecentPhotoUrl=function(e){var t,n;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).parQt=e.parQt,t.id=e.id,t.cid=e.cid,t)),{page:o.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))};e.prototype.getAllPhotosForPlaceUrl=function(e,t){var n;return this.getItemUrl(this.getKey(((n={}).id=t,n.locationFilter=e,n.qt="allmyphotos",n)),{page:o.e.Photos})};e.prototype.getSharedByQueryUrl=function(){var e;return this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt="sharedby",e)),{page:o.e.Files}))};e.prototype.getSharedByYouQueryUrl=function(){var e,t=this.resources.consume(J.e);return this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt=t?"sharedbyme":"sharedby",e)),{page:o.e.Files}))};e.prototype.getOneDriveAppsUrl=function(){return"https://g.live.com/8SESkyDrive/SkyDriveApps?biciid=lhnlink"};e.prototype.getOptionsUrl=function(e){void 0===e&&(e=this._navigation.viewParams);return this.getNewManageStorageUrl()};e.prototype.getManageStorageUrl=function(){return this.getCurrentPageBaseUrl()+"/options/ManageStorage"};e.prototype.getPhotoPreferencesUrl=function(){var e,t=((e={}).v="photopreferences",e),n="#"+d.n(t,null,!0);return this._requireAuthentication(n)};e.prototype.getManageVaultUrl=function(){var e,t=((e={}).v="ManageVault",e),n="#"+d.n(t,null,!0);return this._requireAuthentication(n)};e.prototype.getTagPreferencesUrl=function(){var e,t=((e={}).v="tagpreferences",e),n="#"+d.n(t,null,!0);return this._requireAuthentication(n)};e.prototype.getOfficeFileOptionsUrl=function(){var e;if(Object(p.isFeatureEnabled)(p.EnableVroomDocFormatSettings)&&Object(U.e)(L.j)){var t=((e={}).v="documentoptions",e),n="#"+d.n(t,null,!0);return this._requireAuthentication(n)}return this.getCurrentPageBaseUrl()+"/options/DocumentOptions"};e.prototype.getPhotosOptionsUrl=function(){return this.getCurrentPageBaseUrl()+"/options/PeopleOptions"};e.prototype.getUpgradeOptionsUrl=function(e,t){return this.getNewUpgradeOptionsUrl(e,this._navigation.viewParams,t)};e.prototype.getNotificationOptionsUrl=function(){var e;if(X()){var t=((e={}).v="NotificationOptions",e),n="#"+d.n(t,null,!0);return this._requireAuthentication(n)}return this.getCurrentPageBaseUrl()+"/options/NotificationOptions"};e.prototype.getDeviceBackupsOptionsUrl=function(){return this.getCurrentPageBaseUrl()+"/options/DeviceBackups"};e.prototype.getSearchOptionsUrl=function(){return this.getCurrentPageBaseUrl()+"/options/Search"};e.prototype.getNewManageStorageUrl=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).ocid=e.ocid||e["WT.mc_id"],t.v="managestorage",t),r="#"+d.n(n,null,!0);return this._requireAuthentication(r)};e.prototype.getNewUpgradeOptionsUrl=function(e,t,n){void 0===t&&(t=this._navigation.viewParams);return Object(L.w)({wtcParam:e,viewParams:t,hideLeftNav:n})};e.prototype.getNewRestoreOptionsUrl=function(e,t){var n;void 0===t&&(t=this._navigation.viewParams);var r=((n={}).ocid=t.ocid||t["WT.mc_id"]||e,n.v="restore",n),i="#"+d.n(r,null,!0);return this._requireAuthentication(i)};e.prototype.getTaggingOptionsUrl=function(){return"/options/PeopleOptions"};e.prototype.getPeopleApiUrl=function(t){var n={prefix:t};return e.peopleBaseUrl+"/directory/search?"+d.n(n)};e.prototype.getUserInfoApiUrl=function(){return Object(R.e)()};e.prototype.setUserInfoApiUrl=function(){return Object(R.t)()};e.prototype.getPublishToWalgreensUrl=function(){return e.skyApiBaseUrl+"PublishToWalgreens"};e.prototype.getDownloadUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);var n=e.ownerId,r=this.getAuthKeyParamValue(t),i=this.getTicketParamValue(t),s=S.t.canary,o={cid:n,authKey:r,ticket:i,resid:e.id,canary:s};if(e.video){var u=Math.ceil((1.25*e.video.duration||0)/6e4);o.duration=Math.min(Math.max(1,u)+60,1440)}return this.getCurrentPageBaseUrl()+"/GetDownloadUrl?"+d.n(o,null,!0)};e.prototype.getEmbedInfoUrl=function(t){var n={id:t.id};return e.skyApiBaseUrl+"GetEmbedInfo?"+d.n(n,null,!0)};e.prototype.getEmbedPageUrl=function(e){var t={cid:e.ownerId,resid:e.id};return this.getCurrentPageBaseUrl()+"/embed?"+d.n(t,null,!0)};e.prototype.getPermissionsUrl=function(t,n){var r;void 0===n&&(n=this._navigation.viewParams);var i=this.getAuthKeyParamValue(n),s=((r={}).id=t.id,r);i&&(s.authkey=i);return e.skyApiBaseUrl+"GetPermissions?"+d.n(s)};e.prototype.getSearchQueryUrl=function(e,t){var n,r=e.query,i=e.dateFilter,s=e.conversationId,o=e.largestSize,u=e.filter;u||(u=Object(L.O)(this._navigation.viewParams)?g.t.photos:g.t.all);var a=((n={}).qt="search",n.q=r,n.searchsessionid=s,n.ft=L.t[g.t[u]],n);if("number"==typeof i&&i!==g.e.anyDate){var f=new Date,l=this._getDateDuration(i,f);a.df=$[$.DateCreated];a.beginDate=l.toISOString();a.endDate=f.toISOString()}o&&(a.sp="size");return this.getItemUrl(this.getKey(a),t)};e.prototype.getSearchFilterQueryUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);return this.getSearchQueryUrl({query:t.q,conversationId:t.searchsessionid,filter:e,dateFilter:this.getAppliedDateFilter()})};e.prototype.isSearchFilterApplied=function(e,t){void 0===t&&(t=this._navigation.viewParams);return this.getContextualFilter(t)===String(L.t[g.t[e]])};e.prototype.getSearchByDateFilterQueryUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);return this.getSearchQueryUrl({query:t.q,conversationId:t.searchsessionid,filter:g.t[String(L.t[this.getContextualFilter(t)])],dateFilter:e})};e.prototype.isSearchByDateFilterApplied=function(e){return this.getAppliedDateFilter()===e};e.prototype.getAutoActionType=function(e){if(this._useRefactoredDefaultClickUrl)return Object(L.s)(e);var t=e.action||"";return c.e[t.toLowerCase()]||c.t.none};e.prototype.getQueryParamValue=function(e){void 0===e&&(e=this._navigation.viewParams);return e.q};e.prototype.getCommentIdParamValue=function(e){void 0===e&&(e=this._navigation.viewParams);return e.commentId};e.prototype.getLayoutContentType=function(t){void 0===t&&(t=this._navigation.viewParams);var n=t.layout;return n&&e.contentTypeByLayoutType[n]};e.prototype.getItemTypeFilter=function(e){var t=[],n=Number(e.ft)||0;7==(7&n)&&t.push(E.e.folder);16==(16&n)&&t.push(E.e.document);8==(8&n)&&t.push(E.e.media);for(var r=0,i=(e.ext||"").split(";");r<i.length;r++){var s=i[r];t.push(s)}return{filters:t}};e.prototype.saveItemTypeFilter=function(e){void 0===e&&(e={filters:[]});return Object(L.B)(e)};e.prototype.getUsersFilter=function(e){var t=e.userFilters;return t&&t.split(";#")};e.prototype.saveUsersFilter=function(e){var t={};t.userFilters=e&&e.join(";#");return t};e.prototype.saveDateDurationFilter=function(e){return{}};e.prototype.getDateDurationFilter=function(e){return""};e.prototype.getIAmValue=function(e){void 0===e&&(e=this._navigation.viewParams);return e.iam};e.prototype.getFeedbackUrl=function(){return e.skyApiBaseUrl+"GetFeedBackUrl"};e.prototype.getCidFromResourceId=function(e){void 0===e&&(e=this._navigation.viewParams);return Object(M.t)(e)};e.prototype.getCreateTextDocumentUrl=function(t,n,r){void 0===r&&(r=this._navigation.viewParams);var i={};i.id=t;i.cid=n;i.iam=this.getIAmParamValue(r);i.action=e.createTextDocumentActionValue;i.v="TextFileEditor";var s=d.n(i,null,!0);return this._getCurrentPageUrl(2,s)};e.prototype.getCreateDocumentInTabUrl=function(e,t,n,r){var i;void 0===r&&(r=this._navigation.viewParams);var s,o=this.getAuthKeyParamValue(r),u=this.getTicketParamValue(r),a=this.getIAmParamValue(r),f=r.qt,l=1===e.documentFormat?"odf":"",h=((i={}).cid=e.ownerId,i.wacqt=f||"",i.wdo=1,i);if(n){s="?";h.id=e.id;var p=void 0;switch(t){case"w":p=c.t.createWord;break;case"x":p=c.t.createExcel;break;case"p":p=c.t.createPowerPoint;break;case"n":p=c.t.createOneNote}h.action=p&&c.t[p].toLowerCase()||""}else{s="/create.aspx?";h.parId=e.id;h.nd=t+l}o&&(h.authkey=o);u&&(h.ticket=u);a&&(h.iam=a);return s+d.n(h)};e.prototype.getDownloadItemUrl=function(e,t,n,r){void 0===r&&(r=this._navigation.viewParams);if(e.processFilters)return e.processFilters.thumbnailUrl;var i=this.getAuthKeyParamValue(r),s=this.getTicketParamValue(r),o=this.getIAmParamValue(r),u={cid:e.ownerId,authKey:i,ticket:s,iam:o,resid:e.id,canary:t,ithint:e.extension&&e.extension.toLowerCase(),open:n||void 0};return this.getCurrentPageBaseUrl()+"/download.aspx?"+d.n(u,null,!0)};e.prototype.getPrintPdfUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);var n=this.getAuthKeyParamValue(t),r=this.getTicketParamValue(t),i=this.getIAmParamValue(t),s=S.t.canary,o={cid:e.ownerId,authKey:n,ticket:r,iam:i,resid:e.id,canary:s,ithint:e.extension&&e.extension.toLowerCase(),open:1,serve:1};return this.getCurrentPageBaseUrl()+"/pdf?"+d.n(o,null,!0)};e.prototype.getVersionHistoryUrl=function(e,t,n){var r,s;void 0===n&&(n=this._navigation.viewParams);var o=this.getIAmParamValue(n),u=this.getAuthKeyParamValue(n),a=n.redeem,f=Object(i.__assign)(Object(i.__assign)({cid:e,resid:t,iam:o},u?((r={}).authkey=u,r):{}),ne&&a?((s={}).redeem=a,s):{});return"/versions.aspx?"+d.n(f,null,!0)};e.prototype.getOpenInOfficeOnlineUrl=function(e,t,n){void 0===n&&(n={});var r,i=n.forceReadOnly,s=void 0!==i&&i,o=e.properties.commandsSupported,u=(void 0===o?{}:o).defc,a=e.openUrl;if(s)r="view.aspx";else switch(u){case"2":r="edit.aspx";break;default:r="view.aspx"}var f=(null==e?void 0:e.itemId)||(null==e?void 0:e.id);if(f){var l=new Q.t("/".concat(r));l.setQueryParameter("resid",f);var c=this.getAuthKeyParamValue(t);c&&l.setQueryParameter("authkey",c);var h=t.redeem;ne&&h&&l.setQueryParameter("redeem",h);if(!L.e)for(var p in t)p.startsWith("wd")&&l.setQueryParameter(p,t[p]);return l.toString()}var v=Object(y.n)(e),m=a.indexOf("?")>0?"&":"?";return a.replace("redir.aspx",r).replace("download.aspx",r)+m+d.n({app:v,wdo:1,wacqt:t.qt},null,!0)};e.prototype.getOpenInOfficeClientUrl=function(e,t,n){var r,s,o,u;void 0===t&&(t=this._navigation.viewParams);if(!H.e.isActivated("C1567AF7-26C3-4CFC-A439-2A58F8558245","07/18/2022","open history file in office client")&&Object(U.e)(e.ownerId)){var a=null!==(o=null===(s=e.properties)||void 0===s?void 0:s.path)&&void 0!==o?o:null===(u=e.itemFromServer)||void 0===u?void 0:u.webDavUrl;return Object(K.e)(e.appMap,a,e.extension,!0,!1)}var f=this.getAuthKeyParamValue(t),l=this.getIAmParamValue(t),c=t.redeem,h=Object(i.__assign)({cid:n,resid:e.id,authKey:f,iam:l,autoRedirect:"false"},ne&&c?((r={}).redeem=c,r):{});return this.getCurrentPageBaseUrl()+"/openinclient?"+d.n(h,null,!0)};e.prototype.getNewInOfficeClientUrl=function(e,t,n){return""};e.prototype.getDownloadAsZipIframeUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);var n={canary:e,iam:this.getIAmParamValue(t)};return this.getCurrentPageBaseUrl()+"/downloadasziplanding?"+d.n(n,null,!0)};e.prototype.getDownloadAsZipPostUrl=function(t,n,r){void 0===r&&(r=this._navigation.viewParams);var i=v.o(e.storageBaseUrl+"/downloadfiles/V1/Zip",t),s=r,o={authKey:s.authkey,ticket:s.ticket,iam:this.getIAmParamValue(s),application:n};return i+"?"+d.n(o,null,!0)};e.prototype.getOwnerId=function(t,n){return this.getKeyParams(t||this.getCurrentItemKey(n)).cid||e.viewerId};e.prototype.getSharedByUrl=function(e,t,n){var r,s;return this.getItemUrl(this.getKey(Object(i.__assign)(((r={}).qt="sharedby",r.id=e,r.cid=t,r),n?((s={}).groupId=n,s):{})))};e.prototype.getExternalUrl=function(t){var n=h[t];if(!n)throw new Error("Invalid external alias provided to fetch external url.");return this.getCurrentPageBaseUrl()+e.EXTERNAL_URL_FORMAT+n};e.prototype.getUploadStorageUrl=function(t,n){return"root"===t.id?v.o(e.storageBaseUrl,[t.ownerId])+"/MyCIDStuff/0x"+t.ownerId+"/LiveFolders/"+m.e.encodeURIComponent(n):v.o(e.storageBaseUrl,[t.uploadOwnerId])+"/items/"+t.id+"/"+m.e.encodeURIComponent(n)};e.prototype.getAppSubfolder=function(){return"odc"};e.prototype.getDefaultClickUrl=function(e,t){var n,r,o,u,a,f,l,h,v,m;void 0===t&&(t={});var g,y=t.viewParams,b=void 0===y?this._navigation.viewParams:y,w=t.itemSet,E=t.urlType,S=void 0===E?"default":E,x=t.preserveAction,T=void 0!==x&&x,N=t.action,C=void 0===N?T&&this.getAutoActionType(b)||void 0:N;if(!e||!e.key)return"";Object(p.isFeatureEnabled)(p.UpdateOdcVaultApiForConvergence)&&Object(U.e)(L.j)&&"PersonalVault"===(null===(f=null===(a=null===(u=e.itemFromServer)||void 0===u?void 0:u.remoteItem)||void 0===a?void 0:a.sharepointIds)||void 0===f?void 0:f.webRelativeListUrl)&&(e=Object(i.__assign)(Object(i.__assign)({},e),{key:d.n((n={},n.mcid=d.e(e.key).cid,n.mid=d.e(e.key).id,n.cid=null===(l=e.graph)||void 0===l?void 0:l.driveId,n.id=null===(h=e.graph)||void 0===h?void 0:h.itemId,n))}));if(b.sb){!this.isCurrentQuery(e.queryType,b)||(e=Object(i.__assign)(Object(i.__assign)({},e),{key:d.n(Object(i.__assign)(Object(i.__assign)({},d.e(e.key)),(r={},r.sb=b.sb,r.sd=b.sd,r)))}))}if(b.mcid){this.getKeyParams(e.key).cid===(b.cid||b.parCid)&&(e=Object(i.__assign)(Object(i.__assign)({},e),{key:d.n(Object(i.__assign)(Object(i.__assign)({},d.e(e.key)),(o={},o.mcid=b.mcid,o.mid=b.mid,o)))}))}if(this._useRefactoredDefaultClickUrl){var k=null===(m=null===(v=null==e?void 0:e.properties)||void 0===v?void 0:v.commandsSupported)||void 0===m?void 0:m.defc,O=w&&w.item.peek(),M=O&&O.key!==e.key&&O||e.UNSAFE_parent,_=M&&M.key,D=void 0;k&&(D="1"===k);return B({itemInfo:{itemKey:e.key,itemIsStub:e.isStub,itemIsPlaceholder:e.isPlaceholder,itemIsPhoto:!!e.photo,itemIsVideo:!!e.video,itemVirtualItemType:e.virtualItemType,itemExtension:e.extension,itemType:e.type,itemOpenUrl:e.openUrl,itemErrorType:e.error&&e.error.type,openItemByDefault:D},parentItemInfo:M&&{itemKey:_,itemIsAlbum:M.isAlbum,itemIsPlaceholder:M.isPlaceholder,itemIsStub:M.isStub,itemVirtualItemType:M.virtualItemType,itemExtension:M.extension,itemType:M.type,itemOpenUrl:M.openUrl,itemErrorType:M.error&&M.error.type},preserveAction:T,action:C,viewParams:b,page:t.page,useOneUpTextEditor:this._useOneUpTextEditor,queryType:e.queryType,additionalViewParams:t.additionalViewParams,urlType:S})}var P=this._getDefaultUrlFormat(e),j=!!H.e.isActivated("CBF950BB-C412-4331-9430-066677E49966","10/21/2021","Compute OneUp URL for media items in mount points")||e.type!==s.e.Media;b.mid&&j&&(P=A.current);g=e.type===s.e.Error?A.external:"existing"===S?this._getCurrentUrlFormat(b):"focus"===S||C?C&&C!==c.t.locate&&P===A.current?P:A.focus:P;return this._getItemClickUrl(e,w,g,t)};e.prototype.getTagUrl=function(e){var t,n="";n=e.localizedTag&&e.localizedTag!==e.tag?"".concat(e.localizedTag,";").concat(e.tag):e.tag;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="allmyphotos",t.tagFilter=n,t)),{page:o.e.Photos}))};e.prototype.getAuthenticateUrl=function(e){if(this._useRefactoredDefaultClickUrl)return Object(L.i)(e);var t=S.t.signInUrl;if(window.location.href.indexOf("iam=")>-1){t+="&redirect_uri={0}";e=this.getCurrentPageBaseUrl()+"/business"}else t+="&ru={0}&wreply={0}";return v.o(t,m.e.encodeURIComponent(e||window.location.href))};e.prototype.getLanguageWithAuthenRedirectUrl=function(){return Object(L.g)()};e.prototype.getRootUrl=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).iam=this.getIAmParamValue(e),t);return this.getCurrentPageBaseUrl()+"?"+d.n(n,null,!0)};e.prototype.getCurrentSiteUrl=function(){return window.location.href};e.prototype.getCurrentPageBaseUrl=function(){return window.location.protocol+"//"+window.location.host};e.prototype.getMarketBlockedUrl=function(){return this._useRefactoredDefaultClickUrl?Object(L.y)():this.getCurrentPageBaseUrl()+"/marketblockerror.aspx"};e.prototype.getValidatePermissionUrl=function(){if(this._useRefactoredDefaultClickUrl)return Object(L.A)(this._navigation.viewParams);var e={};e.id=this._navigation.viewParams.id;e.challengeToken=this._navigation.viewParams.authkey;e.v="validatepermission";return this.getCurrentPageBaseUrl()+"?"+d.n(e,null,!0)};e.prototype.getRequestAccessUrl=function(){if(this._useRefactoredDefaultClickUrl)return Object(L.C)(this._navigation.viewParams);var e={};e.id=this._navigation.viewParams.id;e.challengeToken=this._navigation.viewParams.authkey;e.v="requestaccess";return this.getCurrentPageBaseUrl()+"?"+d.n(e,null,!0)};e.prototype.handleFatalErrorDuringViewLoad=function(){if(0===document.cookie.indexOf("sr=3")||document.cookie.indexOf("; sr=3")>-1)this._setFatalErrorCookie(0,!0);else if(0===document.cookie.indexOf("sr=2")||document.cookie.indexOf("; sr=2")>-1){this._setFatalErrorCookie(3,!1);window.top.location=document.location.href}else if(0===document.cookie.indexOf("sr=")||document.cookie.indexOf("; sr=")>-1){this._setFatalErrorCookie(2,!1);location.reload(!0)}else{this._setFatalErrorCookie(1,!1);window.top.location=document.location.href}};e.prototype.getForceLoginDownloadUrl=function(e){var t="https://"+location.host+"?"+this.getDefaultClickUrl(e.UNSAFE_parent).substring(1);return this.getAuthenticateUrl(t)};e.prototype.getItemUrl=function(e,t){void 0===t&&(t={});if(this._useRefactoredDefaultClickUrl){var n=t.viewParams,r=void 0===n?this._navigation.viewParams:n,s=t.item;return Object(L.d)(Object(i.__assign)(Object(i.__assign)({},t),{itemKey:e,itemInfo:s&&{itemKey:s.key,itemIsPlaceholder:s.isPlaceholder,itemVirtualItemType:s.virtualItemType,itemExtension:s.extension,itemType:s.type},viewParams:r}))}var o=this._getItemQueryParams(e,t),u=t.additionalViewParams;u&&u.sc?Object(P.e)(o,u):delete o.sc;return"#"+d.n(o,null,!0)};e.prototype.getSuiteNavConfigUrl=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).iam=this.getIAmParamValue(e),t);return"/getsuitenavconfig?"+d.n(n,null,!0)};e.prototype.getApiName=function(){return"Vroom"};e.prototype.getApiBaseUrl=function(t){return e.getVroomBaseUrl(t)};e.prototype.getAppliedDateFilter=function(e){void 0===e&&(e=this._navigation.viewParams);var t;if(!e.df)return g.e.anyDate;var n=(Date.parse(e.endDate)-Date.parse(e.beginDate))/864e5;switch(Math.floor(n)){case 1:t=g.e.oneDay;break;case 30:t=g.e.oneMonth;break;case 7:t=g.e.oneWeek;break;case 365:t=g.e.oneYear}return t};e.prototype.getResourcePreloadUrl=function(){return"/preload?manifest=wac"};e.prototype.getHipCheckUrl=function(){return"https://mail.".concat(G?"live-int":"live",".com/?rru=hip")};e.prototype.getVerifyAccountUrl=function(){return"https://g.live.com/8SESkydrive/VerifyAccount"};e.prototype.isSearchPassThrough=function(e){void 0===e&&(e=this._navigation.viewParams);return!!e.sp};e.prototype.isLargestFilesView=function(e){void 0===e&&(e=this._navigation.viewParams);return"size"===e.sp};e.prototype.getNavLinkClickUrl=function(e){return""};e.prototype.qualifyUrl=function(e){if(this._useRefactoredDefaultClickUrl)return Object(L.P)(e);0===e.indexOf("#")&&(e=this._getCurrentPageUrl(2,e.substring(1)));return e};e.prototype.getSignInUrlWithAction=function(e,t){var n=t||S.t.si;if(!n)return"";var r=b.t(n),i=d.e(r),s=i.wreply,o=b.t(s),u=d.e(o);u.action=c.t[e];i.wreply="".concat(b.n(s),"?").concat(d.n(u));return"".concat(b.n(n),"?").concat(d.n(i))};e.prototype.getNewPlaceholderItemKey=function(){var t;return d.n(((t={}).id="placeHolder ".concat(e.placeholderId++),t))};e.prototype.getIAmParamValue=function(e){void 0===e&&(e=this._navigation.viewParams);return e.iam};e.prototype.getAuthKeyParamValue=function(e){void 0===e&&(e=this._navigation.viewParams);return Object(L.r)(e)};e.prototype.getTicketParamValue=function(e){void 0===e&&(e=this._navigation.viewParams);return e.ticket};e.prototype.getReferrer=function(e){void 0===e&&(e=this._navigation.viewParams);return e.referrer};e.prototype.getContextualFilter=function(e){void 0===e&&(e=this._navigation.viewParams);return this._useRefactoredDefaultClickUrl?Object(M.n)(e):e.ft};e.prototype.getMyRestorePageUrl=function(){return Promise.resolve("")};e.prototype.getTextEditorItemUrl=function(e,t){var n=t.parentItem,r=t.viewParams;if(this._useRefactoredDefaultClickUrl)return j({itemInfo:{itemKey:e.key,itemExtension:e.extension,itemType:e.type},parentItemInfo:n&&{itemKey:n.key},viewParams:r});var i=this._getItemQueryParams(e.key,{item:e,page:o.e.TextFileEditor,viewParams:r}),s=n||e.UNSAFE_parent,u=this.getKeyParams(s&&s.key||"");i.parId=u.id;var a=d.n(i,null,!0);return"TextFileEditor"!==r.v?this._getCurrentPageUrl(2,a):"#"+a};e.prototype.getQueryUrl=function(e,t){return this._requireAuthentication(this.getItemUrl(this.getRootItemKey(t),{page:e}))};e.prototype.getMpcOneDriveUrl=function(){return"".concat(ee,"/personal/").concat(e.viewerId,"/_layouts/15/onedrive.aspx")};e.prototype._getItemQueryParams=function(e,t){var n=void 0===t?{}:t,r=n.item,s=n.page,o=n.action,f=n.preserveAction,h=void 0!==f&&f,p=n.viewParams,d=void 0===p?this._navigation.viewParams:p,v=this.getKeyParams(e),m=Object(i.__assign)({},v),g=Object(L.T)(d);void 0!==s&&(g.v=this._getPageParamValue(s,d));var y=!1,b=Object(k.r)(null==r?void 0:r.extension,null==r?void 0:r.type);if(r&&!r.isPlaceholder){"TextFileEditor"===g.v&&(b||(g.v=""));switch(r.virtualItemType){case l.e.Album:case l.e.AlbumRoot:case l.e.Tag:case l.e.TagsRoot:g.v="photos";y=!0}}else switch(m.id){case"tags":case"places":case"albums":g.v="photos";y=!0}if("allmyphotos"===v.qt){m.v="photos";y=!0;if("true"===v.onThisDay||"true"===v.onThisMonth||"true"===v.lastWeekPreviousYears){d&&d.startDate&&(m.startDate=d.startDate);d&&d.cid&&(m.cid=d.cid)}}if("photostream"===v.qt){m.v="photoStream";m.psShareId=d.psShareId}var w=this.getQueryType(v);b||!r||y||w===u.e.Search||w===u.e.AllMyPhotos||w===u.e.PhotoStream||(m.v="");!b&&Object(a.e)(w)&&("photos"!==g.v&&"photoStream"!==g.v||this.getContextualFilter(v)!==L.t.photos.toString())&&(m.v="");this._isFilePickerPage(g.v)&&(m.v=g.v);delete m.u;var E=this.getAutoActionType(d);o?m.action=o&&c.t[o]&&c.t[o].toLowerCase()||"":h&&E&&(E===c.t.showProperties&&m.o||(m.action=c.t[E].toLowerCase()));Object(P.e)(g,m);return g};e.prototype._getDateDuration=function(e,t){var n=new Date(t.toString())||new Date;switch(e){case g.e.oneDay:n.setDate(n.getDate()-1);break;case g.e.oneMonth:n.setDate(n.getDate()-30);break;case g.e.oneWeek:n.setDate(n.getDate()-7);break;case g.e.oneYear:n.setDate(n.getDate()-365)}return n};e.prototype._setFatalErrorCookie=function(e,t){var n="sr="+e+"requireDeps;path=/;domain="+window.$Config.urlHost+";";t&&(n+="expires="+new Date(2e3,1,1).toUTCString()+";");document.cookie=n};e.prototype._getCurrentUrlFormat=function(e){void 0===e&&(e=this._navigation.viewParams);return this.getFocusItemKey(e)?A.focus:A.current};e.prototype._getDefaultUrlFormat=function(e){var t;switch(e.type){case s.e.Media:t=A.focus;break;case s.e.Folder:case s.e.Error:t=A.current;break;default:t=A.external}return t};e.prototype._getItemClickUrl=function(e,t,n,r){var i=r.viewParams,s=void 0===i?this._navigation.viewParams:i,u=r.page,a=void 0===u?this.getPageType(s):u;if(n!==A.current&&a===o.e.FilePicker)return"";var f,l=this.getKeyParams(e.key);if(this.isRecycleBin(e.queryType)&&!this.isRecycleBin(this.getQueryType(l)))return"";if(Object(k.r)(e.extension,e.type))n=this._useOneUpTextEditor&&a!==o.e.TextFileEditor?A.focus:A.external;else if(a===o.e.TextFileEditor&&this.getAutoActionType(s)===c.t.createTextDocument)return"#"+d.n(s,null,!0);switch(n){case A.current:f=this._getCurrentItemUrl(e,r);break;case A.focus:f=this._getFocusItemUrl(e,t,r);break;default:f=this._getDefaultItemUrl(e,{itemSet:t,viewParams:s})}return f};e.prototype._getCurrentItemUrl=function(e,t){var n=void 0===t?{}:t,r=n.preserveAction,i=n.action,s=n.viewParams,o=void 0===s?this._navigation.viewParams:s,u=n.page,a=n.additionalViewParams;if(e.isStub){var f=this.getFocusItemKey(o);if(f)return this.getAutoActionType(o)===c.t.locate?"":this._getFocusItemUrlFromKey(f,e,{action:c.t.locate,viewParams:o})}return this.getItemUrl(e.key,{item:e,preserveAction:r,action:i,viewParams:o,page:u,additionalViewParams:a})};e.prototype._getFocusItemUrl=function(t,n,r){var i,s=this._getParentItem(t,n),o=!!r.viewParams&&Boolean("photos"===r.viewParams.v&&(t.video||t.photo)&&"allmyphotos"!==r.viewParams.qt&&!r.viewParams.parId&&!r.viewParams.parQt&&s&&!s.isAlbum),u={key:this.getKey((i={},i.qt="allmyphotos",i.id="root",i.cid=e.viewerId,i))};return this._getFocusItemUrlFromKey(t.key,o?u:s,r)};e.prototype._getFocusItemUrlFromKey=function(t,n,r){var i=void 0===r?{}:r,s=i.preserveAction,o=void 0!==s&&s,u=i.action,a=i.viewParams,f=void 0===a?this._navigation.viewParams:a,l=i.additionalViewParams,c=n&&n.key||"",h=this.getKeyParams(t),p=this._getItemQueryParams(c,{item:n,preserveAction:o,action:u,viewParams:f});f&&f.commentId&&(h.commentId=f.commentId);h.parId=p.id;h.parQt=p.qt;if(h.cid!==p.cid){h.parCid=p.cid;delete p.cid}delete p.internalPath;delete p.qt;delete p.id;delete h.u;var v=p.action;if(v)if(f&&f.commentId&&"showproperties"===v.toLowerCase()){delete p.action;h.o=e.oneUpOverlayValue}else{delete p.action;h.action=v}else h.o=e.oneUpOverlayValue;l&&Object(P.e)(h,l);return"#"+d.n(h,p,!0)};e.prototype._getPageParamValue=function(e,t){var n,r=t.v;switch(e){case o.e.FilePicker:n=this._isFilePickerPage(r)?r:"FilePickerView";break;case o.e.TextFileEditor:n="TextFileEditor";break;case o.e.Photos:n="photos";break;case o.e.RansomwareDetection:n="RansomwareDetection";break;default:case o.e.Files:}return n};e.prototype._getErrorItemUrl=function(t,n){var r;void 0===n&&(n=this._navigation.viewParams);switch(t&&t.error&&t.error.type||f.e.requestFailed){case f.e.marketBlocked:return this.getMarketBlockedUrl();case f.e.userNotReady:return this.qualifyUrl(this.getItemUrl(t.key));case f.e.accessDenied:var i=n.lor;return i&&i.toLowerCase()===e.linkOriginParamValue?"?".concat("v","=").concat("error","&").concat("type","=").concat(e.linkNotSupportedParamValue):this._requireAuthentication(this.getItemUrl(t.key,{viewParams:n,additionalViewParams:(r={},r.sc=n.sc||"",r)}));case f.e.authenticationExpired:return this._requireAuthentication(this.getItemUrl(t.key,{viewParams:n}),!0);case f.e.userSuspended:var s=this.getAutoActionType(n)===c.t.feedback?c.t.feedback:void 0;return S.t.si?this._requireAuthentication(this.getItemUrl(t.key,{viewParams:n,action:s}),!0):this.getItemUrl(t.key,{action:s});case f.e.passwordRequired:return this.getValidatePermissionUrl();case f.e.requestAccess:return this.getRequestAccessUrl()}return this.getItemUrl(t.key)};e.prototype._getDefaultItemUrl=function(e,t){var n,r,i=void 0===t?{}:t,o=i.itemSet,u=i.viewParams,a=void 0===u?this._navigation.viewParams:u,f=this._getParentItem(e,o);if(e.type===s.e.Error)r=this._getErrorItemUrl(e,a);else if(Object(k.r)(e.extension,e.type))r=this.getTextEditorItemUrl(e,{parentItem:f,viewParams:a});else{var l=null===(n=null==e?void 0:e.properties)||void 0===n?void 0:n.commandsSupported,h=(null==l?void 0:l.defc)||"";r=h&&"1"!==h?this._getFocusItemUrl(e,o,{action:c.t.defaultClick,viewParams:a}):"1"===h&&e.openUrl&&(-1===e.openUrl.indexOf("redir.aspx")||e.extension&&(".fluid"===e.extension.toLowerCase()||".loop"===e.extension.toLowerCase()))?e.openUrl:this._getFocusItemUrl(e,o,{action:c.t.locate,viewParams:a})}return r};e.prototype._getCurrentPageUrl=function(t,n){if(this._useRefactoredDefaultClickUrl)return Object(L.a)(t,n);var r=[];r.push(this.getCurrentPageBaseUrl());switch(t){case 0:r.push("/");break;case 1:r.push(e.nextSiteUrlPrefix);break;case 2:r.push(this._getCurrentUrlPathName());break;default:r.push(this._getCurrentUrlPathName())}r.push("?");r.push(n);return r.join("")};e.prototype._getCurrentUrlPathName=function(){return this._useRefactoredDefaultClickUrl?Object(L.f)():window.location.pathname};e.prototype._isFilePickerPage=function(e){var t;switch(e){case"FilePickerView":case"2":case"FolderPickerView":case"1":case"pickerconsent":t=!0;break;default:t=!1}return t};e.prototype._requireAuthentication=function(e,t){void 0===t&&(t=!1);return this._useRefactoredDefaultClickUrl?Object(L.H)(e,t):t||S.t.si?this.getAuthenticateUrl(this.qualifyUrl(e)):e};e.prototype._getParentItem=function(e,t){var n=t&&t.item.peek();return n&&n.key!==e.key&&n||e.UNSAFE_parent};e.dependencies={navigation:C.e,useOneUpTextEditor:ie,useRefactoredDefaultClickUrl:se,enableFastOneUp:oe};e.oneUpOverlayValue=_.i;e.EXTERNAL_URL_FORMAT="/externalredirector?alias=";e.skyApiBaseUrl=Y+"/API/2/";e.viewerId=L.j;e.storageBaseUrl=Z;e.feedbackBaseUrl="https://cid-{0}.users.storage.live.com";e.tagsFeedbackBaseUrl="https://storage.live.com";e.peopleBaseUrl="https://people.onedrive.com";e.nextSiteUrlPrefix=_.r;e.scenarioName="odweb";e.locateActionName="locate";e.linkOriginParamValue="shorturl";e.linkNotSupportedParamValue="linknotsupported";e.createTextDocumentActionValue="createTextDocument";e.contentTypeByLayoutType=((V={}).photo=w.n,V.list=w.t,V.grid=w.e,V);e.placeholderId=0;return e})(),ae=(t.e=ue,Object(T.s)("UrlDataSource",ue))},function(e,t,n){"use strict";var r=(function(){function e(t){this.id="".concat(++e._lastId);this.name=t}e.prototype.matches=function(e){return e===this};e._lastId=0;return e})();t.e=r},function(e,t,n){"use strict";n.d(t,"t",function(){return l});var r=n(0),i=n(7),s=n(6),o=n(69),u=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._commandDataSource=n.itemCommandDataSource;return r}t.prototype.getCommand=function(e,t){return this._commandDataSource.getCommand(e,t)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{itemCommandDataSource:s.d});return t})(i.n),a=Object(o.s)("ItemCommandProvider",u),f=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=n.itemCommandProvider,s=void 0===i?r.resources.consume(a):i;r._itemCommandProvider=s;return r}t.prototype.isCommandSupported=function(e,t){var n=this._itemCommandProvider;return!n||!!n.getCommand(e,t)};t.prototype.getCommandBehavior=function(e,t){var n=this._itemCommandProvider,r=n&&n.getCommand(e,t);return r&&r.behavior};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{itemCommandProvider:a});return t})(i.n),l=(t.e=f,Object(o.s)("ItemCommandHelper",f))},,,function(e,t,n){"use strict";var r;(function(e){e[e.File=0]="File";e[e.Folder=1]="Folder";e[e.Media=2]="Media";e[e.OneNote=3]="OneNote";e[e.Unknown=4]="Unknown";e[e.Error=5]="Error";e[e.App=6]="App";e[e.Subsite=7]="Subsite";e[e.Shortcut=8]="Shortcut";e[e.Album=9]="Album";e[e.MultiShare=10]="MultiShare"})(r||(r={}));t.e=r},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r;(function(e){e[e.none=0]="none";e[e.locate=1]="locate";e[e.defaultClick=2]="defaultClick";e[e.download=3]="download";e[e.share=4]="share";e[e.sharing=5]="sharing";e[e.sendSurvey=6]="sendSurvey";e[e.createTextDocument=7]="createTextDocument";e[e.createWord=8]="createWord";e[e.createExcel=9]="createExcel";e[e.createExcelForm=10]="createExcelForm";e[e.createPowerPoint=11]="createPowerPoint";e[e.createOneNote=12]="createOneNote";e[e.openInExcel=13]="openInExcel";e[e.openInWord=14]="openInWord";e[e.openInPowerPoint=15]="openInPowerPoint";e[e.openInOneNote=16]="openInOneNote";e[e.openInVisio=17]="openInVisio";e[e.openInProject=18]="openInProject";e[e.openInPublisher=19]="openInPublisher";e[e.openInOffice=20]="openInOffice";e[e.embed=21]="embed";e[e.reportAbuse=22]="reportAbuse";e[e.addToShared=23]="addToShared";e[e.editBrowser=24]="editBrowser";e[e.feedback=25]="feedback";e[e.versionHistory=26]="versionHistory";e[e.showProperties=27]="showProperties";e[e.edit=28]="edit";e[e.editNew=29]="editNew"})(r||(r={}));var i={};for(var s in r)if("number"==typeof r[s]){var o=s,u=r[o];i[o.toLowerCase()]=u}t.t=r},,,function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"r",function(){return f});n.d(t,"s",function(){return l});n.d(t,"u",function(){return c});n.d(t,"l",function(){return p});n.d(t,"c",function(){return d});n.d(t,"f",function(){return v});n.d(t,"a",function(){return m});n.d(t,"y",function(){return g});n.d(t,"w",function(){return y});n.d(t,"b",function(){return b});n.d(t,"d",function(){return w});n.d(t,"v",function(){return E});n.d(t,"p",function(){return S});n.d(t,"g",function(){return x});n.d(t,"m",function(){return T});n.d(t,"t",function(){return N});n.d(t,"n",function(){return C});n(142);var r=n(195),i=n(5),s=n(44);n.d(t,"o",function(){return s.r});n.d(t,"i",function(){return s.n});n.d(t,"h",function(){return s.s});n.d(t,"E",function(){return s.u});function o(e){var t=Object(s.i)(),n=u();return a("https://".concat(t).concat(n,"/redir?resid=").concat(e))}function u(){return 2===Object(r.e)()?"storage.live-int.com":"onedrive.live.com"}function a(e){return"u!".concat(window.btoa(e).replace(/=/g,"").replace(/[+]/g,"-").replace(/\//g,"_"))}function f(e){void 0===e&&(e="v1.0");return"https://graph.microsoft.com/".concat(e)}function l(){return"https://substrate.office.com"}function c(){return"/picker/accountchooser"===document.location.pathname.toLowerCase()}function h(e){return"photos"===e.v}function p(e){return"places"===e.id&&h(e)}function d(e){return"tags"===e.id&&h(e)}function v(e){return"allmyphotos"===e.qt||"allmyphotos"===e.parQt}function m(e){return"albums"===e.id&&h(e)}function g(e){return!!e.id&&"albums"!==e.id&&"tags"!==e.id&&"places"!==e.id&&!!e.cid&&h(e)&&!v(e)}function y(e){return v(e)&&!!e.tagFilter&&h(e)}function b(e){return!!e.locationFilter&&h(e)}function w(e){return!!e.onThisDay&&h(e)}function E(e){return!!e.onThisMonth&&h(e)}function S(e){return!!e.lastWeekPreviousYears&&h(e)}function x(e){return e===i.e.RecycleBin}function T(e){return"upgrade"===e.v}function N(e){var t=e.id;if(t){var n=t.indexOf("!");if(n>-1)return t.slice(0,n)}}function C(e){return e.ft}},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return i});n.d(t,"r",function(){return u});n.d(t,"n",function(){return a});n.d(t,"i",function(){return f});var r,i,s=n(30),o=n(133);(function(e){e.App_LoadingStatus="App_LoadingStatus";e.SetOverlayContent="SetOverlayContnet";e.UI_CheckUserAccessAndGrantPermissions="UI_CheckUserAccessAndGrantPermissions";e.GetAccessToken="GetAccessToken";e.App_GetCustomAuthConfig="App_GetCustomAuthConfig";e.App_RefreshSessionInfo="App_RefreshSessionInfo";e.File_Rename="File_Rename";e.UI_CopyAndEdit="UI_CopyAndEdit";e.App_WopiInfoFromUrl="App_WopiInfoFromUrl";e.Edit_Notification="Edit_Notification";e.UI_FileEmbed="UI_FileEmbed";e.UI_ShareForm="UI_ShareForm";e.UI_SignIn="UI_SignIn";e.User_Activity="User_Activity";e.App_WopiDavUrlFromIds="App_WopiDavUrlFromIds";e.UI_FileVersions="UI_FileVersions";e.UI_FileProperties="UI_FileProperties";e.App_PushState="App_PushState";e.App_SwitchMode="App_SwitchMode";e.UI_Sharing="UI_Sharing";e.App_MoveToFolder="App_MoveToFolder";e.App_FilePicker="App_FilePicker"})(r||(r={}));(function(e){e.BlurFocus="BlurFocus";e.Host_AccessibilityLoopComplete="Host_AccessibilityLoopComplete";e.GrabFocus="GrabFocus";e.CanEmbed="CanEmbed";e.PostAccessToken="PostAccessToken";e.App_PopState="App_PopState";e.Host_RefreshSessionInfo="Host_RefreshSessionInfo";e.CheckUserAccessAndGrantPermissions_Result="CheckUserAccessAndGrantPermissions_Result";e.Host_WopiInfoFromUrl="Host_WopiInfoFromUrl";e.Host_DavUrlFromIds=" Host_DavUrlFromIds";e.Host_SetCustomAuthConfig="Host_SetCustomAuthConfig";e.SetOverlayContent="SetOverlayContent";e.Host_PerfTiming="Host_PerfTiming";e.Host_PostmessageReady="Host_PostmessageReady";e.Host_MoveToFolder="Host_MoveToFolder";e.Host_FilePicker="Host_FilePicker"})(i||(i={}));function u(){return{CorrelationId:o.e.generate(),MessageId:i.GrabFocus}}function a(){return{CorrelationId:o.e.generate(),MessageId:i.BlurFocus}}function f(e){var t;return function(n,r,i){return t?t(n,r,i):s.n.resolve(e()).then(function(e){return(t=e)(n,r,i)})}}},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(3).t)("navigation")},function(e,t,n){"use strict";var r=n(0),i=n(120),s=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n,r=e.call(this,t)||this;n=r.useGlobalResources()?r.resources.consume(i.t):r.managed(i.e);r._loader=new n({path:r.getExecutorPath(),getModule:r.getModuleFactory(),getExecutorParams:function(){return r.selectionHelper.resolveSelection().then(function(e){return r.getExecutorParameters({selection:e})})}});return r}t.prototype.useGlobalResources=function(){return!1};t.prototype.onExecute=function(e,t){return this._loader.execute(e,t)};return t})(n(492).e);t.e=s},,,function(e,t,n){"use strict";var r=n(30),i=n(21),s=n(135),o=n(215),u=n(367),a=n(39),f=n(153),l=n(216),c=n(260),h=n(4),p=Object(h.qo)(h.G),d=(function(){function e(){}e.prototype.canHandleRequest=function(e){return e.indexOf("storage.live.com")>-1};e.prototype.handleRequest=function(e,t){var n=new f.e(t);if(p)this._bypassProxy(n,e);else{var r=this._getProxy(e.url);e.useDefaultHeaders=!0;var i=Object(l.t)(e,function(e){n.complete(e)});r.createRequest(i)}return n.getPromise()};e.prototype._getProxy=function(e){var t=new a.t(e);this._xmlProxy||(this._xmlProxy=new c.e({source:t.getScheme()+"://"+t.getHost()+"/xmlproxy.htm?domain="+document.domain}));return this._xmlProxy};e.prototype._bypassProxy=function(e,t){this._basicRequestor||(this._basicRequestor=new o.e);var n;t.disableLogging||(n=new s.e({url:t.url,name:t.qosName||"BaseStorageRequest."+t.apiName}));t.withCredentials=!0;this._basicRequestor.handleRequest(t,function(){null==n||n.end({resultType:i.t.ExpectedFailure});e.cancel()}).then(function(t){e.complete(t);null==n||n.end({resultType:i.t.Success})},function(t){e.error(t);null==n||n.end({resultType:i.t.Failure})})};return e})(),v=Object(h.qo)(h.G),m=(function(){function e(){this._xmlProxies={}}e.prototype.canHandleRequest=function(e){return e.indexOf(".users.storage.live.com")>-1};e.prototype.handleRequest=function(e,t){var n=new f.e(t);if(v)this._bypassProxy(n,e);else{var r=this._getProxy(e.url);e.useDefaultHeaders=!0;var i=Object(l.t)(e,function(e){n.complete(e)});r.createRequest(i)}return n.getPromise()};e.prototype._getProxy=function(e){var t=new a.t(e),n=t.getHost();this._xmlProxies[n]||(this._xmlProxies[n]=new c.e({source:t.getScheme()+"://"+t.getHost()+"/xmlproxy.htm?domain="+document.domain}));return this._xmlProxies[n]};e.prototype._bypassProxy=function(e,t){this._basicRequestor||(this._basicRequestor=new o.e);var n;t.disableLogging||(n=new s.e({url:t.url,name:t.qosName||"StorageRequest."+t.apiName}));t.withCredentials=!0;this._basicRequestor.handleRequest(t,function(){null==n||n.end({resultType:i.t.ExpectedFailure});e.cancel()}).then(function(t){e.complete(t);null==n||n.end({resultType:i.t.Success})},function(t){e.error(t);null==n||n.end({resultType:i.t.Failure})})};return e})(),g=n(243),y=[{Constructor:u.t},{Constructor:m},{Constructor:d},{Constructor:o.e}],b=(function(){function e(){}e.prototype.send=function(e){return w(e)};e.prototype.sendPost=function(e,t,n){return w({apiName:e,url:t,requestType:"POST",postData:n})};e.prototype.sendPostUrlEncoded=function(e,t,n){return w({apiName:e,url:t,requestType:"POST",postData:n,headers:{"Content-Type":"application/x-www-form-urlencoded;"}})};return e})();t.e=b;function w(e){e.requestType=e.requestType||"GET";var t;if(!e.disableLogging){var n=e.url;n=n&&n.replace(/authkey=[^&]+&?/gi,"");t=new s.e({url:n,name:e.qosName||"DataRequest."+e.apiName})}var o,u=(function(e){for(var t=0,n=y;t<n.length;t++){var r=n[t];r.instance||(r.instance=new r.Constructor);if(r.instance.canHandleRequest(e.url))return r.instance}})(e),a=u.getHandlerContentWindow&&u.getHandlerContentWindow(),f=(o=a||window)&&o.performance||void 0,l=f&&f.now();return u.handleRequest(e,function(){t&&t.end({resultType:i.t.ExpectedFailure})}).then(function(n){if(!e.returnRawXHR)return(function(e){var t,n=e.data,s=e.apiEvent;if(!n||0===n.status){s.end({error:"Unkown client side request error (status code 0)",resultType:i.t.ExpectedFailure});return r.n.reject({message:"Promise failed with empty error response",url:n&&n.responseURL||"",status:0,data:void 0})}if(200===n.status||201===n.status){var o=JSON.parse(n.responseText);s&&s.end({resultType:i.t.Success});return o}var u="",a="";try{var f=JSON.parse(n.responseText);t=f&&f.error||f;u=f&&f.transactionId||"";a=n.getResponseHeader("MS-CV")||""}catch(e){t={message:n.responseText}}var l=t,c=t&&t.items;if(c)for(var h=0,p=c;h<p.length;h++){var d=p[h];if(d.error){l=d.error;break}}l||(l={});l.transactionId=u;l.msCorrelationVector=a;var v={errorCode:l&&l.code||"",errorTitle:""},m=e.isErrorExpectedCallback&&e.isErrorExpectedCallback(v);s&&(function(e,t,n,r){var s={resultCode:n&&n.code||"",resultType:r?i.t.ExpectedFailure:i.t.Failure,extraMetrics:{httpStatus:e.status,httpStatusText:e.statusText}};if(n&&n.items)for(var o=0,u=n.items;o<u.length;o++){var a=u[o];if(a.error){n=a.error;break}}if(n){s.error=n.debugMessage||n.message;s.extraData={stack:n.stackTrace,isExpected:n.isExpected,transactionId:n.transactionId,msCorrelationVector:n.msCorrelationVector}}t.end(s)})(n,s,l,m);return r.n.reject({message:"Promise failed without error handler",url:n.responseURL||"",status:n.status,data:t})})({data:n,apiEvent:t,isErrorExpectedCallback:e.isErrorExpectedCallback});var s=Object(g.e)(e.url,l,a);t&&t.end({resultType:i.t.Success,extraData:{rawRequestDuration:s.duration,performanceEntry:JSON.stringify(s)}});return n},function(n){if(n&&n.isProxyFailure){t.end({error:n.message,resultType:i.t.ExpectedFailure});return r.n.reject(n.message)}if(t){var s=Object(g.e)(e.url,l,a),o=n&&n.message||n||"Unkown error occurred while creating API request";t.end({error:o,resultType:i.t.Failure,extraData:{rawRequestDuration:s.duration,performanceEntry:JSON.stringify(s)}})}return r.n.reject(n)})}},,,function(e,t,n){"use strict";var r;(function(e){e[e.created=0]="created";e[e.started=1]="started";e[e.completed=2]="completed";e[e.failed=3]="failed";e[e.canceled=4]="canceled";e[e.expired=5]="expired"})(r||(r={}));t.e=r},function(e,t,n){"use strict";n.d(t,"o",function(){return u});n.d(t,"s",function(){return a});n.d(t,"u",function(){return f});n.d(t,"r",function(){return l});n.d(t,"n",function(){return c});n.d(t,"t",function(){return h});n.d(t,"i",function(){return p});n.d(t,"e",function(){return d});var r=n(42),i=n(45),s=n(195),o=n(105),u=(null===i.t||void 0===i.t?void 0:i.t.mpcDomain)||"https://my.microsoftpersonalcontent.com",a="UnAuth"===(null===i.t||void 0===i.t?void 0:i.t.hcid),f=!a&&(null===i.t||void 0===i.t?void 0:i.t.hcid)||"";function l(e){var t=e.apiVersion,n=e.driveId,i=e.includeViewerId,s=void 0!==i&&i,o=e.migrationState,a=void 0!==o&&o;n&&"me"!==n||(n=f);if(Object(r.e)(n)||a){"v1.0"===t&&(t="v2.0");return s?(function(e){void 0===e&&(e="v2.0");return"".concat(u,"/personal/").concat(f,"/_api/").concat(e)})(t):h(t)}return c(t)}function c(e){void 0===e&&(e="v1.0");var t=p(),n=2===Object(s.e)()?"storage.live-int.com":"api.onedrive.com";return"https://".concat(t).concat(n,"/").concat(e)}function h(e){void 0===e&&(e="v2.0");return"".concat(u,"/_api/").concat(e)}function p(){switch(Object(s.e)()){case 3:return"soak2.test.";case 4:return"soak3.test.";case 2:return"newapi.dev.";default:return""}}function d(e){var t,n,r;return null!==(r=null!==(n=null!==(t=null==e?void 0:e.driveId)&&void 0!==t?t:Object(o.e)(null==e?void 0:e.cid))&&void 0!==n?n:Object(o.e)(f||void 0))&&void 0!==r?r:"me"}},function(e,t,n){"use strict";n.d(t,"t",function(){return o});n.d(t,"e",function(){return u});var r=n(39),i=n(3),s=window&&window.FilesConfig||{};s.skyDrivePickerOAuth||(s.skyDrivePickerOAuth="oauth");!s.oauthToken&&window&&(s.oauthToken=new r.t(window.location.href).getQueryParameter("access_token"));var o=s,u=window&&window.$Config||{};new i.t({name:"".concat("Config",".files"),factory:new i.e(o)}),new i.t({name:"".concat("Config",".config"),factory:new i.e(u)})},,function(e,t,n){"use strict";n.d(t,"o",function(){return i});n.d(t,"m",function(){return s});n.d(t,"p",function(){return o});n.d(t,"u",function(){return u});n.d(t,"i",function(){return a});n.d(t,"d",function(){return f});n.d(t,"r",function(){return l});n.d(t,"t",function(){return c});n.d(t,"c",function(){return h});n.d(t,"h",function(){return p});n.d(t,"v",function(){return d});n.d(t,"n",function(){return v});n.d(t,"s",function(){return m});n.d(t,"e",function(){return g});n.d(t,"f",function(){return y});n.d(t,"a",function(){return b});n.d(t,"l",function(){return w});var r=n(3),i=(new r.t("provider.suiteNav"),new r.t("provider.peopleCard")),s=(new r.t("provider.shareByLink"),new r.t("provider.groupsLeftNav"),new r.t("provider.publishingSiteProvider"),new r.t("provider.userInfo")),o=new r.t("provider.tag"),u=new r.t("provider.photo"),a=(new r.t("provider.notification"),new r.t("provider.notificationManager"),new r.t("provider.instrumentation")),f=new r.t("provider.teachingBubble"),l=new r.t("provider.feedback"),c=new r.t("provider.embed"),h=new r.t("provider.storageInfo"),p=new r.t("provider.storageOptions"),d=(new r.t("provider.subscriptions"),new r.t("provider.customAction"),new r.t("provider.taxonomy"),new r.t("provider.thumbnail")),v=(new r.t("provider.appsItem"),new r.t("provider.externallySharedItem")),m=(new r.t("provider.popularItem"),new r.t("provider.mostViewsItem"),new r.t("provider.mostViewersItem"),new r.t("provider.subsiteItem"),new r.t("provider.itemHistory")),g=(new r.t("provider.spotlight"),new r.t("provider.error"),new r.t("provider.publish"),new r.t("provider.bundleLoader")),y=(new r.t("provider.upsell"),new r.t("provider.profile")),b=new r.t("provider.processFilters"),w=new r.t("provider.userState");new r.t("provider.ransomwareDetection"),new r.t("provider.promotedPhotos"),new r.t("provider.site"),new r.t("provider.graphToken"),new r.t("provider.dragAndDropRobot"),new r.t("provider.recycleBin"),new r.t("provider.premiumState"),new r.t("provider.mruRecent"),new r.t("provider.userExpiration"),new r.t("provider.requestReview")},function(e,t,n){"use strict";n.d(t,"n",function(){return i});n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(3),i=new r.t("ODCUrlDataSource"),s=new r.t("ODCRecycleBinDataSource"),o=new r.t("ODCItemDataSource")},,function(e,t,n){"use strict";n.d(t,"w",function(){return i});n.d(t,"g",function(){return s});n.d(t,"y",function(){return o});n.d(t,"m",function(){return u});n.d(t,"b",function(){return a});n.d(t,"d",function(){return f});n.d(t,"v",function(){return l});n.d(t,"a",function(){return c});n.d(t,"l",function(){return h});n.d(t,"t",function(){return p});n.d(t,"e",function(){return d});n.d(t,"n",function(){return v});n.d(t,"r",function(){return m});n.d(t,"p",function(){return g});n.d(t,"c",function(){return y});n.d(t,"h",function(){return b});n.d(t,"o",function(){return w});n.d(t,"u",function(){return E});n.d(t,"i",function(){return S});n.d(t,"s",function(){return x});n.d(t,"f",function(){return T});var r=n(16),i=window._spPageContextInfo,s=(function(){var e=-1!==navigator.userAgent.indexOf("OneDriveWinApp");try{e=e||!!window.sessionStorage.getItem("_isOneDriveWinApp")}catch(e){}return e})(),o=window._spModuleLink&&"SPListWebPack"===window._spModuleLink.manifestName,u=!i||"21"===i.webTemplate&&700===i.listBaseTemplate,a=window._spModuleLink&&"SPOFilePickerWebPack"===window._spModuleLink.manifestName,f=window._spModuleLink&&"ODBFileBrowserWebPack"===window._spModuleLink.manifestName,l=window._spModuleLink&&"ODBLightSpeedWebPack"===window._spModuleLink.manifestName,c={ODB:!!(u||a||f)&&60443,ODC:"FluentVNextStyling"},h={serviceSetting:"ExternalService_bizappspowerappsenabled"},p={ODB:60596},d={Fallback:!r.e.isActivated("B35E04AA-346B-44E3-B7A4-88FC1D79C889","01/06/2023","Enable Popup flow for MSAL authentication")},v={ODB:1441},m=(r.e.isActivated("DC975CAD-8F3C-4979-97E2-DA9970A68919","03/25/2022","Prefer isMySiteOwner check for ODB"),{ODB:1434}),g={ODB:s?-60903:60903},y={ODB:s?-1915:1915},b={ODB:!o&&60881},w={ODB:s?-1943:1943},E={ODB:s?-1945:1945},S={ODB:-10355},x={ODB:1268},T={ODB:!!l&&60694}},function(e,t,n){"use strict";n.r(t);n.d(t,"encodeItemSetParentKeyKey",function(){return O});n.d(t,"resourceKey",function(){return _});var r=n(0),i=(n(381),n(7)),s=n(160),o=n(137),u=n(134),a=n(30),f=n(13),l=n(6),c=n(509),h=n(43),p=n(174),d=n(107),v=n(192),m=n(346);function g(e,t){for(var n=t.start,r=Math.min(t.end,e.length),i=n;i<r;i++)if(!e[i])return!1;return!0}var y=n(525),b=n(3),w=n(69),E=n(225),S=n(153),x=n(450),T=n(18),N=(function(){function e(e,t,n,r){this._context=e;this._store=t;this._isTokenBaseApi=n;this._tokenBasedExtraItemCount=r}e.prototype.initialize=function(e,t){this._skipDataFetch=!1;if(!this._context.group&&this._context.noIndexBasedDataFetch){var n=e&&e.content.peek().groupings,r=n&&n.length&&n[0].itemGroups;this._context.group=this._getGroupStartingOnIndex(t,r)}e&&e.isExpired&&(this._context.group=null);this._isExpandingGroup=this._context.noIndexBasedDataFetch&&this._context.group&&"__next__"!==this._context.group.groupingId&&!this._context.groupReplace;this._isFetchingNextGroup=this._context.group&&this._isTokenBaseApi&&"__next__"===this._context.group.groupingId;var i=e&&e.content.peek().groupings;this._isAllCollapsedQuery=i&&i.length>0&&i[0].isAllCollapsed&&i[0].isAllCollapsed.peek()&&!this._isExpandingGroup};e.prototype.isResultSetValid=function(e,t){var n=this._skipDataFetch;n||(n=this._isAllCollapsedQuery?!this._isExpandingGroup&&!this._context.requestToken:(this._isTokenBaseApi||!this._context.skipInMemoryCache)&&g(e,t)&&!(this._isFetchingNextGroup&&this._context.endIndex>e.length));return n};e.prototype.computeNewChildren=function(e,t,n,r,i){var s,o=!1;this._context.groupReplace&&(this._isFetchingNextGroup=!!e.nextRequestToken);s=i&&!n.isExpired?n.content.peek().items:[];if(e.nextRequestToken){!t.requestToken&&s.length>e.totalChildren&&(s[e.totalChildren]=null);e.totalChildren+=this._tokenBasedExtraItemCount;this._store.setNextRequestToken(t.parentKey,r,e.nextRequestToken);o=!0;n&&(n.isTokenBasedApi=o)}else this._store.setNextRequestToken(t.parentKey,r,"end");if(t.requestToken){t.startIndex=s.length-this._tokenBasedExtraItemCount;e.totalChildren+=s.length-this._tokenBasedExtraItemCount}if(this._isFetchingNextGroup||this._isAllCollapsedQuery){var u=e.children.length,a=e.startIndex+u;e.nextRequestToken&&(a+=this._tokenBasedExtraItemCount);e.totalChildren=Math.max(e.totalChildren,Math.max(s.length,a))}if(e.item&&e.totalChildren>=0){this._isExpandingGroup||(s.length>0&&0===e.totalChildren?s=[]:s.length=e.totalChildren);var f=void 0;f=t.groupReplace?t.startIndex:void 0!==e.startIndex?e.startIndex:this._isExpandingGroup?t.group.startIndex:t.startIndex;for(var l=0,c=0;l<s.length;l++)if(l>=f&&c<e.children.length){s[l]=this._store.getItem(e.children[c].key);if(t.remoteItem||t.isMountPointFolder){s[l].peek().isMountPointFolder=!0;s[l].peek().remoteWebUrl=t.isMountPointFolder?t.remoteWebUrl:t.remoteItem.SiteUrl}c++}}return{allChildren:s,hasNextRequestToken:o}};e.prototype.computeNewGroupings=function(e,t,n,r,i){var s=this._isExpandingGroup?r.group:null,o=r.itemsPerGroup,u=e&&e.length>0?e[0].itemGroups:null,a=null;u&&u.length>0&&u[u.length-1].isPlaceholder&&(a=u.pop());var f=this._mergeGroupings(e,t,i,n);if(s&&f){f[0].isAllCollapsed(!1);s.state({isCollapsed:!1})}if(n&&n.length>0&&!n[n.length-1]&&(u=f&&f.length>0?f[0].itemGroups:null)&&u.length>0){var l=u[u.length-1];this._context.groupReplace&&this._isFetchingNextGroup&&(l.hasMoreData=!0);var c=n[l.startIndex+(-1!==o?Math.min(l.count,o):l.count)-1]&&!(this._context.groupReplace&&l.count<o),h=f[0].isAllCollapsed.peek();if(c||this._isFetchingNextGroup||h){var p=l.startIndex+l.count;a?a.startIndex=p:a={groupingId:"__next__",startIndex:p,count:1,isPlaceholder:!0,state:T.observable({isCollapsed:!1})};n.length<p&&(n.length=p+1);u.push(a)}}return f};e.prototype._mergeGroupings=function(e,t,n,r){var i=e;if(i&&i.length>0){if(t&&t.length>0)for(var s=0;s<t.length;s++){var o=i[s].isAllCollapsed.peek();i[s].itemGroups=n?this._retainItemGroupState(i[s].itemGroups,t[s].itemGroups):this._mergeItemGroups(i[s].itemGroups,t[s].itemGroups,o,null,r)}}else i=t;return i};e.prototype._mergeItemGroups=function(e,t,n,r,i){var s=e;if(e&&e.length>0){if(t&&t.length>0)for(var o=function(e){var t=!1;n&&e.state({isCollapsed:!0});for(var o=function(i){var o=s[i];if(e.groupingId===o.groupingId){if(u._context.noIndexBasedDataFetch||!u._context.isTokenBasedApi){if(u._context.groupReplace){o.count+=e.count;o.hasMoreData&&i<s.length-1&&(o.hasMoreData=!1)}else o.count=e.count;o.children=u._mergeItemGroups(o.children,e.children,n,o);if(0===i)o.startIndex=r?r.startIndex:0;else{var a=s[i-1],f=a.startIndex+a.count-o.startIndex;o.startIndex+=f;o.children&&o.children.forEach(function(e){e.startIndex+=f})}}else{var l=e.startIndex+u._context.startIndex,c=e.startIndex+u._context.startIndex+e.count;o.startIndex=Math.min(o.startIndex,l);o.count=Math.max(c,o.startIndex+o.count)-o.startIndex}t=!0;return"break"}},a=0;a<s.length;a++){if("break"===o(a))break}if(!t){var f=s[s.length-1],l=f.startIndex+f.count-e.startIndex;e.startIndex+=l;e.children&&e.children.forEach(function(e){e.startIndex+=l});var c=Math.min(e.count,30),h=0;if(i)for(var p=e.startIndex;p<e.startIndex+c;p++)i[p]||h++;h&&(e.emptyItemCount=h);s.push(e)}},u=this,a=0,f=t;a<f.length;a++){o(f[a])}}else s=t;return s};e.prototype._retainItemGroupState=function(e,t,n){var r=t;if(t&&t.length>0&&e&&e.length>0){for(var i={},s=0,o=e;s<o.length;s++){var u=o[s];i[u.groupingId]=u}for(var a=0,f=r;a<f.length;a++){var l=f[a],c=i[l.groupingId];if(c){l.state(c.state.peek());l.children=this._retainItemGroupState(c.children,l.children,c)}}}return r};e.prototype._getGroupStartingOnIndex=function(e,t){if(t&&t.length>0)for(var n=0;n<t.length;n++){var r=t[n];if(!(r&&r.startIndex<=e))break;var i=r.startIndex+r.count-1;if(r.children){if(i>=e)return this._getGroupStartingOnIndex(e,r.children)}else{if(r.startIndex===e)return r.state.peek().isCollapsed?null:r;if(i>=e){var s=n<t.length-1?t[n+1]:null;if(s&&!s.state.peek().isCollapsed){this._skipDataFetch=!0;return null}}}}return null};return e})(),C=n(440),k=n(4),L=n(253),A=n(16),O=new b.t({name:"".concat("ItemProvider",".encodeItemSetParentKey"),factory:new b.e(Object(k.qo)(k.bo))}),M=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._registeredProjections={};r._pendingGetItemRequests={};r._store=n.itemsStore;r._operationProvider=n.operationProvider;r._schemaDataSource=n.schemaDataSource;r._updateQuota=n.updateQuota;r._groupThrottle=n.groupThrottle;r._encodeItemSetParentKey=n.encodeItemSetParentKey||!1;r._smartFiltersStore=n.smartFiltersStore;return r}t.prototype.getItem=function(e){return this._getItem(e)};t.prototype.getItemSetKey=function(e,t){var n="parentKey="+(this._encodeItemSetParentKey?encodeURIComponent(e.parentKey):e.parentKey);function r(e,t){t&&(n+="&".concat(e,"=").concat(t))}r("ownerId",e.ownerId);r("groupingType",e.groupingType);n+="&sortField="+(e.sortField||"");n+="&isAscending="+("boolean"==typeof e.isAscending?e.isAscending:"");var i=e.filters;if(i)for(var s in i)n+="&"+s+"="+i[s];r("groupBy",e.groupBy);r("viewId",e.baseViewId);r("viewXml",e.viewXml);r("additionalFiltersXml",e.additionalFiltersXml);var o=!t&&e.itemSetProjections;if(o){var u="";for(var a in o)u+=a+"_"+o[a];n+="&projection="+u}e.supportsNestedGroups&&(n+="&ng=1");return n};t.prototype.getSpecifiedItems=function(e){e&&e.needToClearParentSmartFiltersInfo&&e.parentKey&&this._smartFiltersStore&&this._smartFiltersStore.invalidate(e.parentKey);return this._getItemDataSource().then(function(t){return t.getSpecifiedItems(e)})};t.prototype.getItemSync=function(e){var t=this.getItemSetKey(e),n=e.parentKey,r=this._store.getItem(n),i=this._getItemSet(t,e);if(!r){var s=new o.e(n),u=e.queryType,a=void 0===u?s.queryType:u;s.queryType=a;this._store.setItem(s);r=this._store.getItem(n)}if(!i){var f=r.peek(),l=f&&f.folder,c=l&&l.childCount||0;(i=new m.e(t,e,c)).item=r;var h=e.needSchema;if(void 0===h||h){var p=this._schemaDataSource,d=p&&p.getColumns(f);d&&d.length>0&&i.schema(d)}this._store.setItemSet(t,i)}return i};t.prototype.invalidateItem=function(e,t){var n=void 0===t?{}:t,i=n.triggerFetch,s=void 0!==i&&i,o=n.emptyAllOtherSets,u=void 0!==o&&o,a=n.refreshSchema,f=void 0!==a&&a,l=n.updateGrouping,c=void 0!==l&&l,h=n.purgeCache,p=void 0!==h&&h;u&&this._store.emptyAllOtherSets([e]);if(f){(d=this._store.getItemSetFromItemKey(e))&&d.schema([])}c||this._store.invalidateItem(e,{purgeCache:p});this._smartFiltersStore&&this._smartFiltersStore.invalidate(e);if(s){var d=this._store.getItemSetFromItemKey(e);this._getItem(Object(r.__assign)(Object(r.__assign)({parentKey:e},d&&d.context||{}),{skipCache:!0,updateGrouping:c}))}};t.prototype.removeFromRecent=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromRecent(e)}).then(function(n){n&&t.invalidateItem(e.parentKey);return n})};t.prototype.removeMountPoint=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeMountPoint(e)}).then(function(n){n&&t.invalidateItem(e.parentKey);return n})};t.prototype.createMountPoint=function(e){return this._getItemDataSource().then(function(t){return t.createMountPoint(e)}).then(function(e){return e},function(e){return a.n.wrapError(e)})};t.prototype.createDocument=function(e,t,n,r,i){var s=this;return this._getItemDataSource().then(function(o){return o.createDocument(e,t,n,r).then(function(t){if(i&&o.updateContentType){var n=t.match(/{(.*)}/),r=n&&n[1];return r?o.updateContentType(e,r,i).then(function(){s.invalidateItem(e);s._updateQuota(!0);return t}):t}s.invalidateItem(e);s._updateQuota(!0);return t})})};t.prototype.createCustomDocument=function(e,t,n){var r=this;return this._getItemDataSource().then(function(r){return r.createCustomDocument(e,t,n)}).then(function(t){if(!t)return a.n.wrapError();r.invalidateItem(e);r._updateQuota(!0);return r.getItem({parentKey:e}).then(function(e){return r.peekUnwrapObservable(r._store.getItem(t))})})};t.prototype.updateBundle=function(e,t){var n=this,r=[new E.e(e.item.key,e.item)];t.update(r);return this._getItemDataSource().then(function(t){return t.updateBundle(e)}).then(function(){n.invalidateItem(e.item.UNSAFE_parent?e.item.UNSAFE_parent.key:e.item.key);r=r.map(function(e){return e.succeed()});t.update(r)},function(i){n.invalidateItem(e.item.UNSAFE_parent?e.item.UNSAFE_parent.key:e.item.key);var s=new Error(i);r=r.map(function(e){return e.fail(s)});t.update(r);return a.n.wrapError(s)})};t.prototype.removeFromSharedList=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromSharedList(e)}).then(function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:this.invalidateItem(e.parentKey);return this.resources.consume(L.e)?[4,this.resources.consumeAsync(l.v)]:[3,2];case 1:t.sent().invalidateItems(e.parentKey);t.label=2;case 2:return[2,n]}})})})};t.prototype.updateViewCount=function(e){return this._getItemDataSource().then(function(t){return t.updateViewCount(e)})};t.prototype.reportAbuse=function(e){var t=new p.e,n=this._operationProvider.register({name:e.item.name||"",type:d.e.reportAbuse,payloads:{reportAbuse:{item:e.item}},iconName:e.item.iconName,batch:t}),r=this._getItemDataSource().then(function(t){return t.reportAbuse(e)});n.state(h.e.started);n.progress.maximum(1);return r.then(function(e){n.state(h.e.completed);n.progress.current(1);return e},function(e){n.state(h.e.failed);n.error(new v.e({message:e}));return a.n.wrapError(e)})};t.prototype.requestReview=function(e){for(var t=this,n=new p.e,r=e.items.map(function(e){var r=t._operationProvider.register({name:e.name||"",type:d.e.requestReview,payloads:{requestReview:{item:e}},iconName:e.iconName,batch:n});r.progress.maximum(1);r.progress.current(0);return r}),i=this._getItemDataSource().then(function(t){return t.requestReview(e)}),s=0,o=r;s<o.length;s++){o[s].state(h.e.started)}return i.then(function(n){for(var i=0,s=r;i<s.length;i++){var o=s[i];o.progress.current(1);o.state(h.e.completed)}var u=e.items[0].UNSAFE_parent;u&&t.invalidateItem(u.key);return n},function(e){for(var t=0,n=r;t<n.length;t++){var i=n[t];i.error(new v.e({message:e}));i.state(h.e.failed)}return a.n.wrapError(e)})};t.prototype.saveSortOrder=function(e){return this._getItemDataSource().then(function(t){return t.saveSortOrder(e)}).then(function(e){return e},function(e){})};t.prototype.addCoverPhotos=function(e){return this._updateCoverPhotos(e,d.e.addCoverPhotos,this._addCoverPhotos)};t.prototype.removeCoverPhotos=function(e){return this._updateCoverPhotos(e,d.e.removeCoverPhotos,this._removeCoverPhotos)};t.prototype.changeFolderType=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.changeFolderType(e)}).then(function(n){t.invalidateItem(e.item.key,{triggerFetch:!0});return n})};t.prototype.updateItemProperty=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.updateItemProperty(e)}).then(function(n){t.invalidateItem(e.item.key,{triggerFetch:!0});return n})};t.prototype.getOpenInClientDetails=function(e){return this._getItemDataSource().then(function(t){return t.getOpenInClientDetails(e)}).then(function(e){return e},function(e){})};t.prototype.getWorkProgress=function(e){return this._getItemDataSource().then(function(t){return t.getWorkProgress(e)})};t.prototype.processReferral=function(e,t){return this._getItemDataSource().then(function(n){return n.processReferral(e,t)})};t.prototype.getItemOcrTextContent=function(e){return this._getItemDataSource().then(function(t){return t.getItemOcrTextContent(e)})};t.prototype.updateItemOcrInfo=function(e,t,n){var r=this;return this._getItemDataSource().then(function(r){return r.updateItemOcrInfo(e,t,n)}).then(function(t){r.invalidateItem(e.key,{triggerFetch:!0});return t},function(e){return e})};t.prototype.rotateItems=function(e,t){var n=this,r={},i=e.items.map(function(e){return r[e.key]=new E.e(e.key,e)});t.update(i);return this._getItemDataSource().then(function(t){return t.rotateItems(e)}).then(function(){i=i.map(function(e){return e.succeed()});t.update(i)},function(e){var s=e.data||[];i=[];for(var o=0,u=s;o<u.length;o++){var a=u[o],f=r[a.key];n._store.setItem(f.input);delete r[a.key];i.push(f.fail(a.error))}for(var l in r){f=r[l];delete r[l];i.push(f.succeed())}t.update(i)})};t.prototype.registerProjection=function(e,t){this._registeredProjections[e]=t};t.prototype.computeProjectedItemSet=function(e,t,n,r){var i=n.itemSetProjections,s=r?null:this._store.getItemSet(e),o=!s||s.isPlaceholder||s.isExpired||s.version!==t.version;if(!s||o){if(!s){(s=new m.e(e,n)).item=t.item;s.isTokenBasedApi=t.isTokenBasedApi;s.isPlaceholder=t.isPlaceholder;s.isExpired=t.isExpired;s.version=t.version}for(var u in i){var a=this._registeredProjections[u];a&&a.projectItemSet(s,t,i[u])}r||this._store.setItemSet(e,s)}return s};t.prototype.redeemPermissionToken=function(e){return this._getItemDataSource().then(function(t){return t.redeemPermissionToken(e)})};t.prototype._getItem=function(e){var n,i=this,s=y.e(e),o=this._store;if(e.keyAlias){n=this.getItemSync({parentKey:e.keyAlias}).item;e.parentKey=n.peek().key}else n=this.getItemSync(e).item;var u=e.skipCache,f=void 0!==u&&u,c=this.getItemSetKey(e),h=e.itemSetProjections?this.getItemSetKey(e,!0):c,p=this._getItemSet(c,e),d=p&&p.content.peek().items,v=e.isTokenBasedApi||!!p&&!!p.isTokenBasedApi,b=!f&&n&&!n.peek().revision&&p&&!p.isExpired&&!p.isPlaceholder&&(!e.requestAllChildren||g(d,{start:0,end:d.length})),w=e.startIndex,E=void 0===w?0:w,x=e.pageSize,T=void 0===x?100:x,k=e.endIndex||E+T;k=d&&d.length>0&&!v?Math.min(d.length,k):k;E=Math.max(0,Math.min(k,E));var L=!A.e.isActivated("73b2b18a-27b0-433f-95cf-c7f77326ff37","11/09/2021","Not set requestToken if itemSet is expired")?p&&!p.isExpired?o.getNextRequestToken(h):void 0:o.getNextRequestToken(h);e.requestToken="end"===L?"":L;var O=new N(e,o,v,t.TOKEN_BASED_API_EXTRA_ITEMS);O.initialize(p,E);var M=!1,_=p&&p.content.peek();if(_&&(1===_.partialResultStatus||2===_.partialResultStatus)){M=!0;1===_.partialResultStatus&&p.content({items:_.items,groupings:_.groupings,partialResultRequestCount:0,partialResultStatus:2})}if(b&&!M&&O.isResultSetValid(d,{start:E,end:k}))return a.n.wrap(p);if(n&&n.peek().isStub){var D=e.startKey;if(D){if(o.getItem(D)){p.content.peek().items=[o.getItem(D)];p.isPlaceholder=!0;p.isExpired=!1;var P=this._schemaDataSource,H=P&&P.getColumns(n.peek());H&&H.length>0&&p.schema(H);p.content.valueHasMutated&&p.content.valueHasMutated()}}return a.n.wrap(p)}var B=p&&!p.isExpired&&p.content.peek().groupings;B&&B.length>0&&(e.isGrouped=!0);this._normalizeContext(e,d,E,k,!b);var j=this._getRequestKey(e),F=this._pendingGetItemRequests[j];if(F)return e.itemSetProjections?F.getPromise().then(function(t){return i.computeProjectedItemSet(c,t,e)}):F.getPromise();v&&!L&&(e.startIndex=0);this._pendingGetItemRequests[j]=F=new S.e;this.resources.consumeAsync(l.l.bypass).then(function(t){return t.getItem(Object(r.__assign)(Object(r.__assign)({},e),{itemSetKey:c}))}).then(function(t){if(s.updateContextBasedOnResult&&e.updateContextBasedOnResult){s.updateContextBasedOnResult(s,t);e.updateContextBasedOnResult(e,t);c=i.getItemSetKey(s)}var r=e.itemSetProjections?i.getItemSetKey(e,!0):c;n=o.getItem(e.parentKey);var u=o.getItemSet(r);b=!(!n||!u);var a=O.computeNewChildren(t,e,u,r,!!b),f=a.allChildren,l=a.hasNextRequestToken;l&&(v=l);if(t.item&&!e.ignoreChildren&&!e.skipStoreResults){if(!b){(u=new m.e(r,e)).item=o.getItem(e.parentKey);u.isTokenBasedApi=v;o.setItemSet(r,u)}var h=!!u.isExpired;u.sortField=t.sortField;u.isAscending=t.isAscending;u.isPlaceholder=!1;u.isExpired=!1;var p=e.needSchema;if(void 0===p||p){var d=t.schema;u.schema(d&&d.length>0&&d||[]);t.customViewRenderer?u.customViewRenderer=i.observables.create(t.customViewRenderer):u.customViewRenderer=i.observables.create(void 0)}var w=t.groupings;v&&e.mergeGroupings&&(w=O.computeNewGroupings(u.content.peek().groupings,t.groupings,f,e,h));t.contentTypes&&u.contentTypes&&u.contentTypes(t.contentTypes);var E=u.content.peek(),S=E.partialResultStatus,x=E.partialResultRequestCount,T=void 0===x?0:x;if(!(w&&w.length&&!!w[0])){if(l&&(t.children&&t.children.length<30||!t.children)){var N=T+1;N<=5?T=N:S=1}else void 0===S||0===S||l?2===S&&t.children&&30===t.children.length&&(S=0):S=3}u.content({items:f,groupings:w,partialResultRequestCount:T,partialResultStatus:S});var C=u.version,k=void 0===C?0:C;u.version=k+1}delete i._pendingGetItemRequests[j];if(e.requestAllChildren&&!g(f,{start:0,end:t.totalChildren})){var L=y.e(e),A=L.startIndex,M=void 0===A?0:A;L.startIndex=M+100;return i._getItem(L)}if(t.isFromBrowserCache){s.skipCache=!0;return i._getItem(s)}e.itemSetProjections&&(u=i.computeProjectedItemSet(c,u,e));return u},function(e){delete i._pendingGetItemRequests[j];return a.n.wrapError(e)}).then(function(e){F.complete(e)},function(t){i._groupThrottle&&!i._groupThrottle()&&t&&t.errorCode===Number(C.t.queryThrottled)&&!e.noGroupReplace?i._groupThrottle(!0):F.error(t)});return F.getPromise()};t.prototype._normalizeContext=function(e,t,n,r,i){var s=e.pageSize||100;if(!e.avoidSeamSnapping){if(!i&&!(n-n%s==r-r%s)&&t)for(;n<r&&t[n];)n++;e.startIndex=n-n%s}"number"!=typeof e.pageSize&&(e.pageSize=100);for(var o=e.startIndex,u=void 0===o?0:o;r-u>e.pageSize;)e.pageSize+=100};t.prototype._getRequestKey=function(e){var t=this.getItemSetKey(e,!0);e.requestToken?t+=e.requestToken:t+="&startIndex="+e.startIndex;return t+="&pageSize="+e.pageSize};t.prototype._getItemSet=function(e,t){var n=this._store,r=n.getItemSet(e);if(t.itemSetProjections){var i=this.getItemSetKey(t,!0),s=n.getItemSet(i);s&&(r=this.computeProjectedItemSet(e,s,t))}return r};t.prototype._updateCoverPhotos=function(e,t,n){for(var r=this,i=new p.e,s=e.target,o=e.items.map(function(e){var n=r._operationProvider.register({name:e.name||"",type:t,payloads:{coverPhotos:{parent:s,item:e}},iconName:e.iconName,batch:i});n.progress.maximum(1);n.progress.current(0);return n}),u=n.call(this,e),a=0,f=o;a<f.length;a++){f[a].state(h.e.started)}return u.then(function(t){r.invalidateItem(s.key);(null==e?void 0:e.itemsScopeInvalidate)&&r.resources.consumeAsync(l.v).then(function(e){e.invalidateItems(null==s?void 0:s.key)});for(var n=0,i=o;n<i.length;n++){var u=i[n];u.progress.current(1);u.state(h.e.completed)}return t},function(){for(var e=0,t=o;e<t.length;e++){t[e].state(h.e.failed)}})};t.prototype._addCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.addCoverPhotos(e)})};t.prototype._removeCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.removeCoverPhotos(e)})};t.prototype._getItemDataSource=function(){return a.n.resolve(this.resources.consumeAsync(l.m))};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{groupThrottle:f.l.optional,schemaDataSource:l.N.optional,itemsStore:u.e,operationProvider:s.e,smartFiltersStore:c.e.optional,updateQuota:x.e,encodeItemSetParentKey:O.optional});t.TOKEN_BASED_API_EXTRA_ITEMS=2;return t})(i.n),_=(t.default=M,Object(w.s)("ItemProvider",M))},function(e,t,n){"use strict";var r=n(609);t.e=r.e},function(e,t,n){"use strict";n.d(t,"e",function(){return s.e});n.d(t,"t",function(){return s.t});n.d(t,"n",function(){return o});var r=n(357);location.search,n(452),n(280),n(188),location.search;var i,s=n(252);function o(){if(!i){var e=navigator.userAgent;i=/Teams\/((?:(\d+)\.)?(?:(\d+)\.)?(?:(\d+)\.\d+)).* Electron\/((?:(\d+)\.)?(?:(\d+)\.)?(?:(\d+)\.\d+))/.test(e)}return i||Object(r.t)()||Object(r.e)()}},,,,function(e,t,n){"use strict";var r;(function(e){e[e.AlbumRoot=0]="AlbumRoot";e[e.TagsRoot=1]="TagsRoot";e[e.Album=2]="Album";e[e.Tag=3]="Tag";e[e.FaceRoot=4]="FaceRoot";e[e.Location=5]="Location"})(r||(r={}));t.e=r},,,,function(e,t,n){"use strict";var r=n(0),i=n(14),s=(function(e){Object(r.__extends)(t,e);function t(t,n){return e.call(this,t,n)||this}return t})((function(){function e(e,t){this.value=e;this.extraClasses=t}e.prototype.getClass=function(){var e=this.value?Object(i.C)(this.value):void 0;0;return"ms-Icon ms-Icon--".concat(this.value," ").concat(e||"").concat(this.extraClasses?" "+this.extraClasses:"")};e.prototype.getExtraClasses=function(){return this.extraClasses};e.prototype.toString=function(){return this.value};return e})());t.e=s},,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];0}},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.requestFailed=0]="requestFailed";e[e.authenticationExpired=1]="authenticationExpired";e[e.accessDenied=2]="accessDenied";e[e.marketBlocked=3]="marketBlocked";e[e.userSuspended=4]="userSuspended";e[e.userNotReady=5]="userNotReady";e[e.passwordRequired=6]="passwordRequired";e[e.mfaRequired=7]="mfaRequired";e[e.insufficientVaultQuota=8]="insufficientVaultQuota";e[e.requestAccess=9]="requestAccess"})(r||(r={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(3),i=n(69),s=n(244),o=new r.t({name:"platformDetection",factory:new i.i(s.e)})},,,,,function(e,t,n){"use strict";n.d(t,"r",function(){return h});var r=n(0),i=n(7),s=n(225);n.d(t,"t",function(){return s.e});var o=n(137),u=n(134),a=n(186);n.d(t,"e",function(){return a});var f=n(3),l=n(69),c=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=n.itemsStore,s=void 0===i?r.resources.consume(u.e):i;r._itemsStore=s;r._itemUpdatesByKey={};return r}t.prototype.update=function(e,t){void 0===t&&(t=!1);for(var n=0,r=e;n<r.length;n++){var i=r[n];this._processTask(i)}};t.prototype.flush=function(){var e;e={};for(var t=this._itemUpdatesByKey,n=Object.keys(t).filter(function(e){return!!t[e].item}),i=0,s=n;i<s.length;i++){var u=s[i],f=t[u],l=new o.e(u),c=this._getStoreItem(u);if(c){c.UNSAFE_parent;var h=Object(r.__rest)(c,["UNSAFE_parent"]);Object(a.default)(l,h)}Object(a.default)(l,{revision:0});for(var p=0,d=f.item;p<d.length;p++){var v=d[p];Object(a.default)(l,v)}e[u]=l}for(var m=0,g=n;m<g.length;m++){var y=(l=e[u=g[m]]).parentKey;if(y){var b=e[y]||this._getStoreItem(y)||new o.e(y);e[y]=b;l.UNSAFE_parent=b}else delete l.UNSAFE_parent}this._pushItemsToStore(e);for(var w=0,E=n;w<E.length;w++){u=E[w];delete(f=t[u]).item}};t.prototype.reset=function(){this._itemUpdatesByKey={}};t.prototype.getItem=function(e){var t=e.key;return this._getStoreItem(t)};t.prototype.getChildren=function(e){var t,n,r,i=e.parentKey,s=e.startIndex,o=e.endIndex,u=[],a=this._itemUpdatesByKey[i];if(a){var f=a.set;if(f)if(f.childrenByIndex){s=void 0===(n=(t={startIndex:s,endIndex:o}).startIndex)?f.startIndex:n,o=void 0===(r=t.endIndex)?f.endIndex:r;for(var l=s;l<o;l++){var c=f.childrenByIndex[l],h=this._getStoreItem(c);u.push(h)}}else if(f.childrenBySibling)for(var p={},d="";d=f.childrenBySibling[d];){if(p[d])throw new Error("Circular reference encountered enumerating the children of '".concat(i,"'."));p[d]=!0;h=this._getStoreItem(d);u.push(h)}}return u};t.prototype._processTask=function(e){var t=e.key,n=e.output,r=n.item,i=n.set,s=this._itemUpdatesByKey,o=s[t];o||(o=s[t]={});if(r){o.item||(o.item=[]);o.item.push(r)}if(i){var u=s[i.parent.key];u||(u=s[i.parent.key]={});u.set||(u.set={});var a=u.set;if(void 0!==i.index){a.childrenByIndex||(a.childrenByIndex=[]);void 0===a.startIndex?a.startIndex=i.index:a.startIndex=Math.min(a.startIndex,i.index);var f=a.childrenByIndex.length;a.childrenByIndex[i.index]=t;void 0===a.endIndex?a.endIndex=i.index+1:a.endIndex>i.index+1?a.endIndex+=a.childrenByIndex.length-f:a.endIndex=Math.max(a.endIndex,i.index+1)}else if(i.after){a.childrenBySibling||(a.childrenBySibling={});a.childrenBySibling[i.after.key]=t}}};t.prototype._getStoreItem=function(e){var t=this._itemsStore.getItem(e);return this.peekUnwrapObservable(t)};t.prototype._pushItemsToStore=function(e){var t={};for(var n in e){(s=t[i=e[(a=e[n]).parentKey]&&a.parentKey||""]||(t[i]=[])).push(n)}for(var r=[""];r.length;){var i,s;if(s=t[i=r.shift()]){for(var o=0,u=s;o<u.length;o++){var a;if(!(a=e[n=u[o]]))throw new Error("Attempted to update the same item multiple times.");this._itemsStore.setItem(a,n)}r.push.apply(r,s)}}};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{itemsStore:u.e});return t})(i.n),h=new f.t({name:"ItemTaskObserver",factory:new l.r(c)});t.n=c},,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(30),i=n(21),s=n(69),o=n(6),u=(function(){function e(e,t){this._ticketRedeemer=t.ticketRedeemer}e.prototype.redeemItem=function(e,t,n){return this.redeemItems([e],t,n)};e.prototype.redeemItems=function(e,t,n){return e&&e.some(function(e){return e&&e.tokenNeedsRedeeming})||n?r.n.resolve(this._ticketRedeemer()).then(function(n){return n?n.startRedeem(t,e&&e[0]):{resultType:i.t.Success}}):r.n.resolve({resultType:i.t.Success})};return e})(),a=Object(s.s)("ItemRedeemer",u,{ticketRedeemer:o.H.async.optional})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(210);function i(e){return e===r.e.Search}},,,,function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"f",function(){return s});n.d(t,"i",function(){return o});n.d(t,"e",function(){return u});n.d(t,"r",function(){return a});n.d(t,"c",function(){return f});n.d(t,"n",function(){return l});n.d(t,"l",function(){return c});n.d(t,"u",function(){return h});n.d(t,"s",function(){return p});n.d(t,"o",function(){return d});n.d(t,"a",function(){return v});var r=n(24),i=new r.e("createFolder"),s=new r.e("rename"),o=new r.e("moveFrom"),u=new r.e("copyFrom"),a=(new r.e("moveTo"),new r.e("copyTo"),new r.e("deleteItem")),f=new r.e("restoreItem"),l=new r.e("deleteAllItems"),c=new r.e("restoreAllItems"),h=(new r.e("createText"),new r.e("changeExpiration"),new r.e("open"),new r.e("openInTextEditor")),p=new r.e("openInHtmlViewer"),d=new r.e("openInImageEditor"),v=new r.e("openPdfInBrowser");new r.e("quickEdit"),new r.e("editItem"),new r.e("createShortcut"),new r.e("pinToMru"),new r.e("printPdf")},,function(e,t,n){"use strict";n.d(t,"e",function(){return v});var r=n(0),i=n(7),s=n(69),o=n(18),u=n(30),a=n(153),f=n(58),l=n(488),c=function(){this.icon=null;this.isAvailable=o.observable(!0);this.isVisible=o.observable(!0);this.isDefault=!1;this.automationId="";this.instrumentationId="";this.isExecuting=o.observable(!1);this.isLink=!1;this.execute=function(){return u.n.wrap(1)}},h=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.state=o.observable(1);var r=t.title,i=t.titleAction,s=t.titleIcon,u=t.titleIconAriaLabel,f=t.customCssClasses,h=t.actions,p=void 0===h?[]:h,d=t.component,v=t.control,m=t.isDismissable,g=void 0===m||m,y=t.isSoftDismissable,b=void 0===y||y,w=t.isDismissableOnResize,E=void 0!==w&&w,S=t.isDismissableOnScroll,x=void 0!==S&&S,T=t.size,N=void 0===T?"Small":T,C=t.automationId,k=t.executeDefaultAction,L=void 0===k||k,A=t.isCallout,O=t.isOverlayHidden,M=void 0!==O&&O,_=t.overlayColor,D=void 0===_?"rgba(255,255,255,.4)":_,P=t.invokerEvent,H=t.calloutHeight,B=t.instrumentationId,j=void 0===B?"":B,F=t.shouldPreserveFocus,I=void 0===F||F,q=t.stayAsPopup,R=void 0!==q&&q,U=t.template,z=void 0===U?1:U,W=t.style,X=void 0===W?l.e.normal:W,V=t.focusOnPrimaryAction,$=void 0!==V&&V,J=t.dismissOnEsc,K=void 0!==J&&J;n.title=o.isObservable(r)?r:o.observable(r);n.titleAction=i;n.titleIcon=s;n.titleIconAriaLabel=u;n.customCssClasses=f;n.actions=p;n.component=d;n.control=v;n.isDismissable=g;n.isSoftDismissable=b;n.isDismissableOnResize=E;n.isDismissableOnScroll=x;n.size=N;n.automationId=C||"";n.executeDefaultAction=L;n.isCallout=!!A&&!!P;n.isOverlayHidden=M;n.overlayColor=D;n.invokerEvent=P;n.calloutHeight=H;n.instrumentationId=j;n.shouldPreserveFocus=o.isObservable(I)?I:o.observable(I);n.stayAsPopup=R;n.template=z;n.style=X;n.focusOnPrimaryAction=$;n.dismissOnEsc=K;n.actions=n.actions.map(function(e){return o.utils.extend(new c,e)});n.actionsVisible=n.createComputed(function(){for(var e=!1,t=0,r=n.actions;t<r.length;t++){r[t].isVisible()&&(e=!0)}return e},{disposeWhen:function(){return 1!==n.state()}});var Q=new a.e;n.createComputed(function(){var e=n.state();1!==e&&(2===e?Q.complete():Q.cancel())});n._promise=Q.getPromise();n.events.on(document,"keydown",n._keyDownEvent);return n}t.prototype.complete=function(){this.state(2)};t.prototype.dismiss=function(){this.state(3)};t.prototype.wait=function(){return this._promise};t.prototype._keyDownEvent=function(e){e.keyCode===f.e.escape&&this.dismissOnEsc&&this.state(3)};return t})(i.n),p=n(320),d=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._dialogs=[];r.currentDialog=r.observables.create();r._needsOverlayContent=n.needsOverlayContent;return r}t.prototype.requestDialog=function(e){this._needsOverlayContent.needsOverlayContent.set(!0);var t=this._dialogs;if(e.maxOneDialog&&t.length>0)return t[0];var n=this.currentDialog,r=new h(e);if(e.queueDialog){t.push(r);1===t.length&&n(r)}else{t.unshift(r);n(r)}var i=function(){var e=t.indexOf(r);if(e>=0){t.splice(e,1);n(t[0])}r.dispose()};r.wait().then(i,i);return r};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{needsOverlayContent:p.e});return t})(i.n),v=Object(s.s)("DialogProvider",d)},,,function(e,t,n){"use strict";n.d(t,"u",function(){return i});n.d(t,"t",function(){return s});n.d(t,"n",function(){return o});n.d(t,"i",function(){return u});n.d(t,"e",function(){return a});n.d(t,"r",function(){return f});n.d(t,"s",function(){return l});n.d(t,"o",function(){return c});var r=n(24),i=new r.e("share"),s=new r.e("addToShared"),o=new r.e("embed"),u=(new r.e("comment"),new r.e("removeFromShared")),a=new r.e("addAsMountPoint"),f=new r.e("removeAsMountPoint"),l=new r.e("reportAbuse"),c=new r.e("requestReview");new r.e("alertItem"),new r.e("alertItem")},,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});n.d(t,"n",function(){return o});n.d(t,"i",function(){return u});n.d(t,"r",function(){return a});n.d(t,"f",function(){return f});n.d(t,"s",function(){return l});n.d(t,"a",function(){return c});n.d(t,"u",function(){return h});n.d(t,"o",function(){return p});n.d(t,"l",function(){return d});var r=n(24),i=new r.e("createExcel"),s=new r.e("createOneNote"),o=new r.e("createPowerPoint"),u=new r.e("createWord"),a=new r.e("createSurvey"),f=new r.e("viewSurvey"),l=new r.e("editSurvey"),c=new r.e("publishSurvey"),h=new r.e("openOnline"),p=new r.e("openInClient"),d=new r.e("viewVersionHistory");new r.e("openInPowerBI"),new r.e("contentTypeNavigation"),new r.e("editNewMenu"),new r.e("uploadTemplate")},,function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return i});var r,i;(function(e){e[e.all=0]="all";e[e.folders=1]="folders";e[e.photos=2]="photos";e[e.documents=3]="documents";e[e.music=4]="music"})(r||(r={}));(function(e){e[e.anyDate=0]="anyDate";e[e.oneDay=1]="oneDay";e[e.oneWeek=2]="oneWeek";e[e.oneMonth=3]="oneMonth";e[e.oneYear=4]="oneYear"})(i||(i={}))},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.Home=1]="Home";e[e.Personal=2]="Personal";e[e.Solo=3]="Solo";e[e.Trial=4]="Trial";e[e.Storage=5]="Storage"})(r||(r={}))},function(e,t,n){"use strict";var r;(function(e){e[e.AllMyPhotos=0]="AllMyPhotos";e[e.Albums=1]="Albums";e[e.allTags=2]="allTags";e[e.allPlaces=3]="allPlaces";e[e.allPeople=4]="allPeople";e[e.singleAlbum=5]="singleAlbum";e[e.singleTag=6]="singleTag";e[e.singlePlace=7]="singlePlace";e[e.singlePerson=8]="singlePerson";e[e.onThisDay=9]="onThisDay";e[e.onThisMonth=10]="onThisMonth";e[e.lastWeekPreviousYears=11]="lastWeekPreviousYears"})(r||(r={}));t.e=r},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(208),i=new r.e("Item",r.t.subject)},,,,,,function(e,t,n){"use strict";(function(e){n.d(t,"e",function(){return l});n.d(t,"t",function(){return h});var r=function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},i="undefined"==typeof window?e:window,s=i&&i.CSPSettings&&i.CSPSettings.nonce,o=(function(){var e=i.__themeState__||{theme:void 0,lastStyleElement:void 0,registeredStyles:[]};e.runState||(e=r(r({},e),{perf:{count:0,duration:0},runState:{flushTimer:0,mode:0,buffer:[]}}));e.registeredThemableStyles||(e=r(r({},e),{registeredThemableStyles:[]}));i.__themeState__=e;return e})(),u=/[\'\"]\[theme:\s*(\w+)\s*(?:\,\s*default:\s*([\\"\']?[\.\,\(\)\#\-\s\w]*[\.\,\(\)\#\-\w][\"\']?))?\s*\][\'\"]/g,a=function(){return"undefined"!=typeof performance&&performance.now?performance.now():Date.now()};function f(e){var t=a();e();var n=a();o.perf.duration+=n-t}function l(e,t){void 0===t&&(t=!1);f(function(){var n=Array.isArray(e)?e:v(e),r=o.runState,i=r.mode,s=r.buffer,u=r.flushTimer;if(t||1===i){s.push(n);u||(o.runState.flushTimer=setTimeout(function(){o.runState.flushTimer=0;f(function(){var e=o.runState.buffer.slice();o.runState.buffer=[];var t=[].concat.apply([],e);t.length>0&&c(t)})},0))}else c(n)})}function c(e,t){o.loadStyles?o.loadStyles(d(e).styleString,e):(function(e){if("undefined"==typeof document)return;var t=document.getElementsByTagName("head")[0],n=document.createElement("style"),r=d(e),i=r.styleString,u=r.themable;n.setAttribute("data-load-themed-styles","true");s&&n.setAttribute("nonce",s);n.appendChild(document.createTextNode(i));o.perf.count++;t.appendChild(n);var a=document.createEvent("HTMLEvents");a.initEvent("styleinsert",!0,!1);a.args={newStyle:n};document.dispatchEvent(a);var f={styleElement:n,themableStyle:e};u?o.registeredThemableStyles.push(f):o.registeredStyles.push(f)})(e)}function h(e){o.theme=e;(function(){if(o.theme){for(var e=[],t=0,n=o.registeredThemableStyles;t<n.length;t++){var r=n[t];e.push(r.themableStyle)}if(e.length>0){(function(e){void 0===e&&(e=3);if(3===e||2===e){p(o.registeredStyles);o.registeredStyles=[]}if(3===e||1===e){p(o.registeredThemableStyles);o.registeredThemableStyles=[]}})(1);c([].concat.apply([],e))}}})()}function p(e){e.forEach(function(e){var t=e&&e.styleElement;t&&t.parentElement&&t.parentElement.removeChild(t)})}function d(e){var t=o.theme,n=!1;return{styleString:(e||[]).map(function(e){var r=e.theme;if(r){n=!0;var i=t?t[r]:void 0,s=e.defaultValue||"inherit";t&&!i&&console,0;return i||s}return e.rawString}).join(""),themable:n}}function v(e){var t=[];if(e){for(var n=0,r=void 0;r=u.exec(e);){var i=r.index;i>n&&t.push({rawString:e.substring(n,i)});t.push({theme:r[1],defaultValue:r[2]});n=u.lastIndex}t.push({rawString:e.substring(n)})}return t}}).call(this,n(572))},function(e,t,n){"use strict";var r;(function(e){e[e.multiple=0]="multiple";e[e.renameItems=1]="renameItems";e[e.deleteItems=2]="deleteItems";e[e.pointInTimeRestore=3]="pointInTimeRestore";e[e.restoreItems=4]="restoreItems";e[e.uploadItems=5]="uploadItems";e[e.moveItems=6]="moveItems";e[e.copyItems=7]="copyItems";e[e.rotateItems=8]="rotateItems";e[e.addItemsToAlbum=9]="addItemsToAlbum";e[e.addCoverPhotos=10]="addCoverPhotos";e[e.removeCoverPhotos=11]="removeCoverPhotos";e[e.createAlbumFromFolder=12]="createAlbumFromFolder";e[e.createColumn=13]="createColumn";e[e.editColumn=14]="editColumn";e[e.deleteColumn=15]="deleteColumn";e[e.checkInItem=16]="checkInItem";e[e.checkOutItem=17]="checkOutItem";e[e.undoCheckOutItem=18]="undoCheckOutItem";e[e.createFolder=19]="createFolder";e[e.updateBundle=20]="updateBundle";e[e.shareItem=21]="shareItem";e[e.reportAbuse=22]="reportAbuse";e[e.requestReview=23]="requestReview";e[e.setAlbumCoverPhoto=24]="setAlbumCoverPhoto";e[e.createAlbum=25]="createAlbum";e[e.uploadVideos=26]="uploadVideos";e[e.saveItem=27]="saveItem";e[e.createItem=28]="createItem";e[e.publishItem=29]="publishItem";e[e.unPublishItem=30]="unPublishItem";e[e.applyOfficeLens=31]="applyOfficeLens";e[e.removeOfficeLens=32]="removeOfficeLens";e[e.updateMetadata=33]="updateMetadata";e[e.makeHomepage=34]="makeHomepage";e[e.triggerFlow=35]="triggerFlow";e[e.downloadAsZip=36]="downloadAsZip";e[e.saveAutoAlbum=37]="saveAutoAlbum";e[e.discardAutoAlbum=38]="discardAutoAlbum";e[e.addToOneDrive=39]="addToOneDrive";e[e.removeFromSharedList=40]="removeFromSharedList";e[e.setupApprovalFlow=41]="setupApprovalFlow";e[e.setupReminderFlow=42]="setupReminderFlow";e[e.sharepointPointInTimeRestore=43]="sharepointPointInTimeRestore";e[e.sharingReport=44]="sharingReport";e[e.editViewColumns=45]="editViewColumns";e[e.runModelOnItems=46]="runModelOnItems";e[e.importModel=47]="importModel";e[e.downloadItem=48]="downloadItem";e[e.deleteSmartTemplate=49]="deleteSmartTemplate";e[e.publishSmartTemplate=50]="publishSmartTemplate";e[e.unpublishSmartTemplate=51]="unpublishSmartTemplate";e[e.universalAnnotationSync=52]="universalAnnotationSync"})(r||(r={}));t.e=r},function(e,t,n){"use strict";var r;(function(e){e[e.white=1]="white";e[e.themePrimary=2]="themePrimary";e[e.neutralLighterAlt=3]="neutralLighterAlt";e[e.themeTertiary=4]="themeTertiary"})(r||(r={}));t.e=r},,,,,function(e,t,n){"use strict";var r;(function(e){e[e.None=0]="None";e[e.NewBrandFRE=1]="NewBrandFRE";e[e.MusicFolderCreationOld=2]="MusicFolderCreationOld";e[e.MusicFolderCreation=3]="MusicFolderCreation";e[e.OneUnitUpsell=4]="OneUnitUpsell";e[e.OneDriveBusinessUpsell=5]="OneDriveBusinessUpsell";e[e.TenGigMaxFileSize=6]="TenGigMaxFileSize";e[e.PreviewTagsView=7]="PreviewTagsView";e[e.XboxMusic=8]="XboxMusic";e[e.O365Upsell1=9]="O365Upsell1";e[e.O365Upsell2=10]="O365Upsell2";e[e.O365Upsell3=11]="O365Upsell3";e[e.O365Upsell4=12]="O365Upsell4";e[e.OneRmO365Upsell=13]="OneRmO365Upsell";e[e.FirstRunExperienceDialog=14]="FirstRunExperienceDialog";e[e.ExpiringSharingLinks=15]="ExpiringSharingLinks";e[e.MobileUpsell=16]="MobileUpsell";e[e.WrsIntroduction=17]="WrsIntroduction"})(r||(r={}));t.e=r},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(134),i=n(69),s=(function(){function e(e,t){this._itemsStore=t.itemsStore}e.prototype.getParent=function(e){if(e){var t=this._itemsStore.getItem(e.key),n=t&&t.peek(),r=n&&(n.parentKey||n.UNSAFE_parent&&n.UNSAFE_parent.key);return r?this._itemsStore.getItem(r):void 0}};e.prototype.getFacetedAncestorOrSelf=function(e,t,n){void 0===n&&(n="");return this.getAncestorOrSelf(e,function(e){return n?e[t]&&e[t][n]:!!e[t]})};e.prototype.getAncestorOrSelf=function(e,t){for(var n,r=e&&e.key;r;){var i=this._itemsStore.getItem(r),s=i&&i.peek();if(!s)break;if(t(s)){n=i;break}r=s&&(s.parentKey||s.UNSAFE_parent&&s.UNSAFE_parent.key)}return n};e.dependencies={itemsStore:r.e};return e})(),o=Object(i.s)("ItemParentHelper",s)},,,function(e,t,n){"use strict";n.d(t,"t",function(){return c});var r=n(0),i=n(30),s=n(3),o=n(7),u=n(47),a=n(369),f=n(16),l=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r._getModule=t.getModule;r._path=t.path;r._getExecutorParams=t.getExecutorParams;if(f.e.isActivated("9DB5106C-820A-4714-B0C1-1005523DFE8F","07/09/2021","Removes usage of BundeLoader from ExecutorAction to solve race conditions in BundleQueue")){r._bundleLoader=r.resources.consume(u.e);r._bundleLoader.queueLoad(r._path,r._getModule).done()}return r}t.prototype.execute=function(e,t){var n=this;return this._path?this._loadExecutorType().then(function(r){return"function"!=typeof r?i.n.wrapError(new Error("Cannot create action from ".concat(r,": ").concat(n._path))):i.n.as(n._getExecutorParams()).then(function(s){var o=new(n.resources.injected(r))(s);return i.n.as(o.execute(e,t))})}):i.n.wrapError(new Error("Cannot create action from nothing: ".concat(this._path)))};t.prototype._loadExecutorType=function(){if(f.e.isActivated("9DB5106C-820A-4714-B0C1-1005523DFE8F","07/09/2021","Removes usage of BundeLoader from ExecutorAction to solve race conditions in BundleQueue")){var e=this._bundleLoader.loadNow(this._path,this._getModule);this._loadExecutorType=function(){return e};return e}return this._getModule().then(function(e){return Object(a.e)(e)})};t.dependencies=Object(r.__assign)({},o.n.dependencies);return t})(o.n);t.e=l;var c=new s.t({name:"ExecutorLoader",factory:{dependencies:l.dependencies,create:function(e){return{instance:(function(t){Object(r.__extends)(n,t);function n(n){return t.call(this,n,e)||this}return n})(l)}}}})},function(e,t,n){"use strict";n.d(t,"r",function(){return l});n.d(t,"t",function(){return c});n.d(t,"n",function(){return h});n.d(t,"e",function(){return v});var r=n(3),i=n(259),s=new(n(55).e)("photosExperimentHelperKeyFacet",{}).serialize({}),o=new(n(9).e)("photosExperimentHelper"),u=n(2);n(207),n(36);var a=n(4),f=n(67),l=new r.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabled"),factory:{dependencies:{},create:function(e){return{instance:a.Wo?Object(a.qo)(a.eo)||Object(a.qo)(a.uo):Object(a.qo)(a.fo)}}}}),c=(new r.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInFilesPivot"),factory:{dependencies:{},create:function(){return{instance:a.Wo?Object(a.qo)(a.eo):Object(a.qo)(a.fo)}}}}),new r.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInRecentPivot"),factory:{dependencies:{},create:function(){return{instance:Object(a.qo)(a.yt)}}}}),new r.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSharedPivot"),factory:{dependencies:{},create:function(){return{instance:Object(a.qo)(a.ro)}}}}),new r.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInCrossSitePivots"),factory:{dependencies:{},create:function(){return{instance:!!a.Wo&&Object(a.qo)(a.uo)}}}}),new r.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllPhotosPivot"),factory:{dependencies:{platformDetection:f.e},create:function(e){return{instance:Object(a.qo)(a.Vs)&&(!e.platformDetection.isIE||Object(a.qo)(a.$s))&&(!e.platformDetection.isSafari||Object(a.qo)(a.Qs))&&(!e.platformDetection.isMobile||Object(a.qo)(a.Ks))}}}})),h=new r.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSingleAlbumView"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:c},create:function(e){return{instance:Object(a.qo)(a.io)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),p=new r.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSingleTagView"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:c},create:function(e){return{instance:Object(a.qo)(a.oo)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),d=new r.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSinglePlace"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:c},create:function(e){return{instance:Object(a.qo)(a.so)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),v=(new r.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllPhotosFilePicker"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:c},create:function(e){return{instance:Object(a.qo)(a.Js)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new r.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllTagsPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:c},create:function(e){return{instance:Object(a.qo)(a.Gs)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new r.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllPlacesPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:c},create:function(e){return{instance:Object(a.qo)(a.to)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new r.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllAlbumsPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:c},create:function(e){return{instance:Object(a.qo)(a.Xs)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}));new r.t({name:"".concat("ItemsScopeFeature.key",".isVroomEnabledInAllPhotosPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:c},create:function(e){return{instance:function(e){var t=e(Object(i.e)(function(e){return e.demandItemFacet(o,s)}));return Object(u.isFeatureEnabled)(u.UseVroomInItemsScopeAllPhotos)||Boolean(t&&t.isUseVroomInItemsScopeAllPhotosOtdExpOn())}&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new r.t({name:"".concat("ItemsScopeFeature.key",".isVroomEnabledInSingleTagView"),factory:{dependencies:{isItemsScopeEnabledInSingleTagView:p},create:function(e){return{instance:Object(a.qo)(a.Po)&&e.isItemsScopeEnabledInSingleTagView}}}}),new r.t({name:"".concat("ItemsScopeFeature.key",".isVroomEnabledInSinglePlaceView"),factory:{dependencies:{isItemsScopeEnabledInSinglePlaceView:d},create:function(e){return{instance:Object(a.qo)(a.Do)&&e.isItemsScopeEnabledInSinglePlaceView}}}})},,,,,,function(e,t,n){"use strict";n.d(t,"r",function(){return r});n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});n.d(t,"n",function(){return o});var r;(function(e){e[e.NotCreated=-1]="NotCreated";e[e.Created=0]="Created";e[e.BubbleShown=1]="BubbleShown";e[e.FreShown=2]="FreShown"})(r||(r={}));var i="oneDriveVault",s="canary",o=3},function(e,t,n){"use strict";n.d(t,"e",function(){return p});var r=n(0),i=n(11),s=n(21),o=n(7),u=n(30),a=n(153),f=n(652),l=n(345),c=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.state,i=t.source,s=t.useToggleBehavior,o=t.useGlobalResources,a=t.getParams;if((function(e){return!!e.moduleDefinition})(i)){var c=i.moduleDefinition;n._getComponentDefinition=function(){return Object(f.e)(c)}}else{var h=i.component;n._getComponentDefinition=function(){return u.n.wrap(h)}}n._useToggleBehavior=s;n._state=r;n._getParams=a;n._action=n.createObservable();n._getHiddenDomProvider=n.resources.consume(l.e.async.lazy);n._useGlobalResources=o;n.isAvailable=n.createPureComputed(n._computeIsAvailable);n.isToggled=n.createPureComputed(n._computeIsToggled);return n}t.prototype.execute=function(e){var t,n=this;if(this._useToggleBehavior){var i=this._action.peek();if(i){i.cancel();return u.n.wrap()}}var s=new a.e,o={complete:function(){s.complete()},fail:function(e){s.error(e)},cancel:function(){s.cancel()}};this._useToggleBehavior&&this._action(o);return u.n.as(this._getParams()).then(function(i){return n._getHiddenDomProvider().then(function(a){return n._getComponentDefinition().then(function(u){t=a.requestControl({name:u.tagName,params:Object(r.__assign)(Object(r.__assign)({action:o,event:e},i||{}),n._useGlobalResources?{}:{resources:n.resources})});return s.getPromise()}).then(function(){t&&a.disposeControl(t);n._action.peek()===o&&n._action(void 0)},function(e){t&&a.disposeControl(t);n._action.peek()===o&&n._action(void 0);return u.n.wrapError(e)})})})};t.prototype._computeIsAvailable=function(){return this._state().isAvailable};t.prototype._computeIsToggled=function(){var e=this._state().isToggled;return void 0!==e&&e||this._useToggleBehavior&&!!this._action()};return t})(o.n);var h=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.name,i=t.source,s=t.handlerType,o=t.actionParams,u=t.useToggleBehavior,a=void 0!==u&&u,f=t.useGlobalResources;n.name=r;var l=s?new(n.managed(s))(o):void 0,h=l&&l.state||n.createObservable({isAvailable:!0}),p=l&&l.getParams?function(){return l.getParams()}:function(){};(null==l?void 0:l.getCustomerPromiseStartSchema)&&(n.customerPromiseStartSchema=l.getCustomerPromiseStartSchema());n._controlExecutorLoader=new(n.managed(c))({source:i,state:h,useToggleBehavior:a,useGlobalResources:f,getParams:p});return n}t.prototype.onIsAvailable=function(){return this._controlExecutorLoader.isAvailable()};t.prototype.onIsToggled=function(){return this._controlExecutorLoader.isToggled()};t.prototype.onExecute=function(e){return this._controlExecutorLoader.execute(e).then(function(){return{resultType:s.t.Success}})};return t})(i.e);function p(e){var t=e.name,n=e.source,i=e.useToggleBehavior,s=e.handlerType,o=e.useGlobalResources,u=void 0!==o&&o;return(function(e){Object(r.__extends)(o,e);function o(r){return e.call(this,{name:t,source:n,useToggleBehavior:i,actionParams:r,handlerType:s,useGlobalResources:u})||this}return o})(h)}},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return b});var r=n(0),i=n(137),s=n(99),o=n(116),u=n(3),a=n(69),f=n(20),l=n(155),c=n(28),h=n(362),p=n(186),d=n(2),v=Object(d.isFeatureEnabled)(d.ReadOnlyItemsStore);function m(e){return e&&e.item&&e.item.peek().key}function g(e){e.isExpired=!0;var t=e.content,n=t.peek();n.groupings=null;n.items=[];t.valueHasMutated()}var y=(function(e){Object(r.__extends)(t,e);function t(){var t=e.call(this,"ItemsStore")||this;t._itemSetsKeys={};t._observables=new o.e({owner:t});t._vaultItemsToPurge=[];window.odstore=t;return t}t.prototype.dispose=function(){this._observables.dispose()};t.prototype.setItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this._handleSetItem.apply(this,Object(r.__spreadArray)([e],t,!1))};t.prototype.getItem=function(e){return this.getValue("item="+e)};t.prototype.setItemSet=function(e,t){var n="result="+e;this.setValue(n,t);this._itemSetsKeys[n]=1};t.prototype.getItemSetFromItemKey=function(e){var t;for(var n in this._itemSetsKeys){var r=(t=this.getValue(n)).content&&t.content.peek(),i=r&&r.items;if(i)for(var s=0,o=i;s<o.length;s++){var u=o[s];if(u&&u.peek().parentKey===e)return t}}};t.prototype.getItemSet=function(e){return this.getValue("result="+e)};t.prototype.getAllItemSetKeys=function(){var e=[];for(var t in this._itemSetsKeys)e.push(t.slice("result=".length));return e};t.prototype.setNextRequestToken=function(e,t,n){var r="token="+t;n?this.setValue(r,n):this.remove(r)};t.prototype.getNextRequestToken=function(e){return this.getValue("token="+e)};t.prototype.invalidateItem=function(e,t){var n=(void 0===t?{}:t).purgeCache,r=void 0!==n&&n;return this._handleItemInvalidation(e,this.getItem(e),r)};t.prototype.invalidateItemSet=function(e){var t=this.getValue("result="+e);t&&g(t)};t.prototype.emptyAllOtherSets=function(e){var t;for(var n in this._itemSetsKeys)(t=this.getValue(n)).item&&(0===e.length||e.indexOf(t.item.peek().key)<0)&&g(t)};t.prototype.invalidateLocation=function(e){var t;for(var n in this._itemSetsKeys){var r=m(t=this.getValue(n));if(r){var i=f.e(r),s=i&&i.locationFilter;s&&s.indexOf(e)>=0&&(t.isExpired=!0)}}};t.prototype.invalidateTag=function(e){var t;for(var n in this._itemSetsKeys){var r=m(t=this.getValue(n));if(r){var i=f.e(r);i&&i.tagFilter===e&&(t.isExpired=!0)}}};t.prototype.invalidateAllPhotos=function(){var e;for(var t in this._itemSetsKeys){var n=(e=this.getValue(t)).item&&e.item.peek();if(n&&n.key&&n.key.indexOf("allmyphotos")>=0){e.isExpired=!0;this._invalidateItem(n)}}};t.prototype.invalidateAllVault=function(){for(var e=0,t=Object(r.__spreadArray)([],this._vaultItemsToPurge,!0);e<t.length;e++){var n=t[e],s=void 0;if(n.vault&&n.vault.root){(s=new i.e(n.key)).name=n.name;s.displayName=n.displayName;s.dateModified=" ";s.folder={};s.vault={isLocked:!0,root:{}}}this._purgeItem(n,s)}this._vaultItemsToPurge=[]};t.prototype._handleItemInvalidation=function(e,t,n){var r=this;if(t){var i=t.peek(),s=!1,o=[];if(i){o.push(i);switch(i.type){case c.e.Folder:case c.e.Media:s=!0}}for(var u in this._itemSetsKeys){var a=this.getValue(u),f=a.item&&a.item.peek(),l=f&&f.key;if(l&&(l===e||s&&l.indexOf("allmyphotos")>-1)){l===e?this.setNextRequestToken(e,a.key,""):o.push(f);a.isExpired=!0}}o.forEach(n?function(e){return r._purgeItem(e)}:function(e){return r._invalidateItem(e)})}};t.prototype._purgeItem=function(e,t){var n=t||new i.e(e.key);this.setItem(n)};t.prototype._invalidateItem=function(e){var t=new i.e(e.key);Object(p.default)(t,e);Object(p.default)(t,{revision:e.revision+1});this.setItem(t)};t.prototype._handleSetItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=[];v&&!Object.isFrozen(e)&&Object.freeze(e);e.vault&&this._vaultItemsToPurge.push(e);for(var s=function(t){var n="".concat("item=").concat(t),r=v?"".concat("item_write=").concat(t):n,s=o.getValue(n),u=o.getValue(r);if(u)u(e);else{(u=o._observables.create(e)).equalityComparer=l.t;o.setValue(r,u);s=v?o._observables.pureCompute(function(){return u()}):u;o.setValue(n,s)}i.push(s)},o=this,u=0,a=Object(h.e)(Object(r.__spreadArray)([e.key],t,!0));u<a.length;u++){var f=a[u];s(f)}return i[0]};return t})(s.e),b=new u.t({name:"ItemsStore",factory:new a.i(y)})},,,function(e,t,n){"use strict";var r=n(5),i=function(e){void 0===e&&(e="");this.isDropEnabled=!1;this.permissions={High:0,Low:0};this.key=e;this.revision=0;this.queryType=r.e.Files;this.displayType=r.e.Files;this.isPlaceholder=!0;this.properties={};this.recycleBinProperties={};this.reputationProperties={};this.statistics={views:0,viewsUnique:0,viewsLast2Weeks:0,viewsLast2WeeksUnique:0,viewsLastWeek:0,viewsLastWeekUnique:0,viewsLastMonth:0,viewsLastMonthUnique:0};this.urls={};this.state={upload:{status:5},removing:!1}};t.e=i},function(e,t,n){var r;(function(i,s){"use strict";var o=function(e){if("object"!=typeof e.document)throw new Error("Cookies.js requires a `window` with a `document` object");var t=function(e,n,r){return 1===arguments.length?t.get(e):t.set(e,n,r)};t._document=e.document;t._cacheKeyPrefix="cookey.";t._maxExpireDate=new Date("Fri, 31 Dec 9999 23:59:59 UTC");t.defaults={path:"/",secure:!1};t.get=function(e){t._cachedDocumentCookie!==t._document.cookie&&t._renewCache();return t._cache[t._cacheKeyPrefix+e]};t.set=function(e,n,r){(r=t._getExtendedOptions(r)).expires=t._getExpiresDate(void 0===n?-1:r.expires);t._document.cookie=t._generateCookieString(e,n,r);return t};t.expire=function(e,n){return t.set(e,void 0,n)};t._getExtendedOptions=function(e){return{path:e&&e.path||t.defaults.path,domain:e&&e.domain||t.defaults.domain,expires:e&&e.expires||t.defaults.expires,secure:e&&void 0!==e.secure?e.secure:t.defaults.secure}};t._isValidDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())};t._getExpiresDate=function(e,n){n=n||new Date;"number"==typeof e?e=e===1/0?t._maxExpireDate:new Date(n.getTime()+1e3*e):"string"==typeof e&&(e=new Date(e));if(e&&!t._isValidDate(e))throw new Error("`expires` parameter cannot be converted to a valid Date instance");return e};t._generateCookieString=function(e,t,n){var r=(e=(e=e.replace(/[^#$&+\^`|]/g,encodeURIComponent)).replace(/\(/g,"%28").replace(/\)/g,"%29"))+"="+(t=(t+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent));r+=(n=n||{}).path?";path="+n.path:"";r+=n.domain?";domain="+n.domain:"";r+=n.expires?";expires="+n.expires.toUTCString():"";return r+=n.secure?";secure":""};t._getCacheFromString=function(e){for(var n={},r=e?e.split("; "):[],i=0;i<r.length;i++){var s=t._getKeyValuePairFromCookieString(r[i]);void 0===n[t._cacheKeyPrefix+s.key]&&(n[t._cacheKeyPrefix+s.key]=s.value)}return n};t._getKeyValuePairFromCookieString=function(e){var t=e.indexOf("=");t=t<0?e.length:t;return{key:decodeURIComponent(e.substr(0,t)),value:decodeURIComponent(e.substr(t+1))}};t._renewCache=function(){t._cache=t._getCacheFromString(t._document.cookie);t._cachedDocumentCookie=t._document.cookie};t._areEnabled=function(){var e="1"===t.set("cookies.js",1).get("cookies.js");t.expire("cookies.js");return e};t.enabled=t._areEnabled();return t},u="object"==typeof i.document?o(i):o;void 0!==(r=function(){return u}.call(t,n,t,e))&&(e.exports=r)})("undefined"==typeof window?this:window)},function(e,t,n){"use strict";var r=n(0),i=n(11),s=n(30),o=n(21),u=n(36),a=n(13),f=n(20),l=n(556),c=n(3),h=n(69),p=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="Navigation";var i=t.url,s=t.viewParams,o=t.target,f=void 0===o?"_top":o,l=t.forceNavigation,c=void 0!==l&&l,h=t.ignoreHistory,p=t.beforeNavigation,d=t.afterNavigation,v=t.postProcessUrl,m=n.navigation,g=void 0===m?r.resources.consume(u.e):m,y=n.viewParamsObservable,b=void 0===y?r.resources.consume(a.S):y;r._navigation=g;r._viewParams=b;r._url=r.wrapObservable(i);r._inputViewParams=r.wrapObservable(s);r._target=r.wrapObservable(f);r._forceNavigation=c;r._ignoreHistory=h;r._beforeNavigation=p;r._afterNavigation=d;r._postProcessUrl=v;return r}t.prototype.onExecute=function(e,t){var n=this._url.peek(),r=this._inputViewParams.peek(),i=this._beforeNavigation;i&&i(this._navigation);var u=this._postProcessUrl?this._postProcessUrl(n):n;(this._forceNavigation||n)&&this._navigation.navigateTo({url:u,viewParams:r,frameId:this._target.peek(),ignoreHistory:this._ignoreHistory});this._afterNavigation&&this._afterNavigation(this._navigation);return s.n.wrap({resultType:o.t.Success})};t.prototype.onIsAvailable=function(){var e=this._url();if(!e)return!1;if(this._forceNavigation)return!0;var t=this._inputViewParams(),n=this._viewParams(),r="#"+f.n(n),i=t&&0===t.indexOf("#")?t.substring(1):"",s=i+(i?"&":"")+(0===e.indexOf("#")?e.substring(1):"");if(s){var o=f.e(s);return!l.e(n,o)}return e!==r};t.dependencies={resources:c.s,navigation:u.e,viewParamsObservable:a.S};return t})(i.e);t.e=p;Object(h.o)("NavigationAction",p)},function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return u});n.d(t,"r",function(){return a});n.d(t,"n",function(){return f});var r=n(63),i="text/plain",s={abap:i,ada:i,adp:i,ahk:i,as:i,as3:i,asc:i,ascx:"text/xml",asm:i,asp:i,awk:i,bash:i,bash_login:i,bash_logout:i,bash_profile:i,bashrc:i,bat:"text/x-bat",bib:i,bsh:"text/x-java",build:i,builder:i,c:"text/x-cpp","c++":"text/x-c++src",capfile:i,cc:"text/x-c++src",cfc:i,cfm:i,cfml:i,cl:i,clj:i,cls:i,cmake:i,cmd:"text/x-bat",coffee:"text/coffeescript",cpp:"text/x-cpp",cpt:"text/xml",cpy:i,cs:"text/x-csharp",cshtml:"text/x-cshtml",cson:"text/coffeescript",csproj:"text/xml",css:"text/css",ctp:"text/html",cxx:"text/x-c++src",d:i,db:i,ddl:i,di:i,dif:i,diff:i,disco:"text/xml",dml:i,dtd:"text/xml",dtml:"text/xml",el:i,emakefile:i,erb:i,erl:i,f:i,f90:i,f95:i,fs:"text/x-fsharp",fsi:"text/x-fsharp",fsscript:"text/x-fsharp",fsx:"text/x-fsharp",gemfile:i,gemspec:"text/ruby",gitconfig:"text/x-ini",go:i,groovy:i,gvy:i,h:"text/x-cpp","h++":"text/x-c++hdr",haml:i,handlebars:"text/x-handlebars-template",hbs:"text/x-handlebars-template",hcp:i,hh:"text/x-c++hdr",hpp:"text/x-cpp",hrl:i,hs:i,htc:"text/javascript",htm:"text/html",html:"text/html",hxx:"text/x-c++hdr",idl:"text/x-c++hdr",iim:i,inc:"text/html",inf:i,ini:"text/x-ini",inl:"text/x-c++src",ipp:"text/x-c++src",irbrc:i,jade:"text/x-jade",jav:"text/x-java-source",java:"text/x-java-source",js:"text/javascript",json:"application/json",jsp:i,jsx:"text/javascript",l:i,less:"text/x-less",lhs:i,lisp:i,log:i,lst:i,ltx:i,lua:"text/x-lua",m:i,mak:i,make:i,markdn:"text/x-web-markdown",markdown:"text/x-web-markdown",md:"text/x-web-markdown",mdown:"text/x-web-markdown",mkdn:"text/x-web-markdown",ml:i,mli:i,mll:i,mly:i,mm:i,mud:i,nfo:i,opml:"text/xml",osascript:i,osts:"text/javascript",out:i,p:i,pas:i,patch:i,php:"application/x-php",php2:"application/x-php",php3:"application/x-php",php4:"application/x-php",php5:"application/x-php",phtml:"text/html",pl:i,plist:i,pm:i,pod:i,pp:i,profile:i,properties:i,ps1:"text/x-powershell",ps1xml:"text/x-powershell",psd1:"text/x-powershell",psm1:"text/x-powershell",pt:"text/xml",py:"text/python",pyw:i,r:i,rake:i,rb:"text/ruby",rbx:i,rc:i,re:i,reg:i,rest:i,resw:"text/xml",resx:"text/xml",rhtml:i,rjs:i,rprofile:i,rpy:i,rss:"text/xml",rst:i,rxml:i,s:i,sass:"text/scss",scala:i,scm:i,sconscript:i,sconstruct:i,script:i,scss:"text/scss",sgml:"text/xml",sh:i,shtml:"text/html",sml:"text/xml",sql:i,sty:i,t:i,tcl:i,tex:i,text:i,textile:i,tld:"text/xml",tli:"text/x-c++hdr",tmpl:"text/html",tpl:"text/html",ts:"text/typescript",txt:i,vb:"text/x-vb",vi:i,vim:i,wsdl:"text/xml",xaml:"text/xml",xhtml:"text/html",xml:"text/xml",xoml:"text/xml",xsd:"text/xml",xsl:i,xslt:i,yaml:i,yaws:i,yml:i,zsh:i};function o(e){return((e&&"."===e[0]?e.substring(1):e)||"").toLowerCase()}function u(e){e=o(e);return s.hasOwnProperty(e)}function a(e,t){return!!e&&f(e,t)}function f(e,t){return u(e)&&(t===r.t.File||t===r.t.Media||t===r.t.Unknown)}},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"i",function(){return i});n.d(t,"r",function(){return s});n.d(t,"n",function(){return o});n.d(t,"t",function(){return u});var r=String.fromCharCode(9),i="OneUp",s="/next",o="shorturl",u="linknotsupported"},,,,function(e,t,n){"use strict";var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.text=t.text;return n}return t})(n(97).e),s=n(98).e({tagName:"ms-text-container",template:'<div class="TextContainer" data-bind="text:text"></div>',viewModel:i});t.e=s},,,,,function(e,t,n){"use strict";var r=n(510);n.d(t,"e",function(){return r.e})},,,function(e,t,n){"use strict";n.d(t,"e",function(){return d});var r=n(0),i=n(126),s=n(92),o=n(3),u=n(69),a=n(354),f=n(294),l=new o.t({name:"".concat("Engagement",".useEngagementSystem"),factory:new o.e(!0)}),c={engagementHandlers:f.e.optional},h=new o.t({name:"".concat("Engagement",".engagementHelper"),loader:{load:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,n.ee([137],1712)];case 1:e=t.sent().EngagementHelper;return[2,{dependencies:c,create:function(t){var n=t.engagementHandlers;return{instance:new e({},{handlers:n})}}}]}})})}}}),p=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._isEnabled=n.isEnabled;r._getEngagementHelper=n.getEngagementHelper;r._getEngagementHandlers=n.getEngagementHandlers;r._isEnabled&&r._getEngagementHelper().catch(function(){});return r}t.prototype.logData=function(e){var t=this;void 0===e&&(e={});this._isEnabled?this._getEngagementHelper().then(function(n){n.fromSource({contexts:t.contexts}).logData(e)}).catch(function(){}):e.name&&s.e.logData(e)};t.prototype.clone=function(e){return new t({},{engagementSource:{contexts:e},isEnabled:this._isEnabled,getEngagementHelper:this._getEngagementHelper,getEngagementHandlers:this._getEngagementHandlers})};t.dependencies={engagementSource:a.n,isEnabled:l,getEngagementHelper:h.async.lazy,getEngagementHandlers:f.e.optional.async.lazy};return t})(i.t),d=Object(u.s)("Engagement",p)},,,function(e,t,n){"use strict";var r;(function(e){e[e.Left=0]="Left";e[e.Top=0]="Top";e[e.Right=1]="Right";e[e.Bottom=2]="Bottom";e[e.Center=4]="Center";e[e.VerticalCenter=8]="VerticalCenter";e[e.BottomCenter=6]="BottomCenter";e[e.BottomRight=3]="BottomRight";e[e.RightVerticalCenter=9]="RightVerticalCenter"})(r||(r={}));t.e=r},,,function(e,t,n){"use strict";n.d(t,"e",function(){return g});var r=n(0),i=n(7),s=n(43),o=n(174),u=n(107),a=n(30);function f(){return a.n.wrap()}var l=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.key=t.key;var r=n.observables,i=t.count,s=void 0===i?r.create(1):i,o=t.isAvailable,u=void 0===o?r.create(!0):o,a=t.onExecute,l=void 0===a?f:a;n.count=s;n.isAvailable=u;n._onExecute=l.bind(t.operation);return n}t.prototype.dispose=function(){e.prototype.dispose.call(this);this._onExecute=f};t.prototype.execute=function(){return this._onExecute()};return t})(i.n),c=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{})||this,i=n.observables;n.name=t.name;n.iconName=t.iconName;n.state=i.create(s.e.created);n.warning=i.create("");n.error=i.create();n.count=i.create(1);var a=Object(r.__assign)({minimum:0,maximum:0,current:0},t.progress||{});n.progress={minimum:i.create(a.minimum),maximum:i.create(a.maximum),current:i.create(a.current)};n.type=i.create(t.type||u.e.multiple);n.batch=t.batch||new o.e;n._initializeActions(t.actions);n.payloads=i.create(t.payloads||{});n.visibility=i.create(t.visibility||0);return n}t.prototype.dispose=function(){this.actions({});this.payloads({});e.prototype.dispose.call(this)};t.prototype._initializeActions=function(e){void 0===e&&(e={});var t={};for(var n in e){var r=e[n];t[n]=this.scope.attach(new l({key:n,operation:this,isAvailable:r.isAvailable,onExecute:r.execute}))}this.actions=this.observables.create(t)};return t})(i.n),h=n(238),p=n(364),d=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.operations=t.operations;n.name="";n.iconName="";n.progress={minimum:n.createObservable(0),maximum:n.createObservable(0),current:n.createObservable(0)};n.batch=t.batch;n.error=n.createObservable();n.count=n.createObservable(0);n._initializeType();n.payloads=n.createPureComputed(n._computePayloads);n.actions=n.createObservable({});n.states=n.createObservable({created:0,started:0,completed:0,failed:0,canceled:0,expired:0});n._initializeOperations();n.state=n.createPureComputed(n._computeState);n.visibility=n.createPureComputed(n._computeVisibility);return n}t.prototype._initializeType=function(){var e=this.addDisposable(p.e.group(this.operations,function(e){return e.type()}));this.type=this.createPureComputed(function(){return 1===e().length&&e()[0].key||u.e.multiple})};t.prototype._computePayloads=function(){var e=this.operations()[0];return e&&e.payloads()||{}};t.prototype._initializeOperations=function(){var e=this;this.addDisposable(this.operations.map({mappingWithDisposeCallback:function(t){var n=e.createPureComputed(function(){return s.e[t.state()]}),r=e.addDisposable(h.t(t.progress.minimum,e.progress.minimum)),i=e.addDisposable(h.t(t.progress.maximum,e.progress.maximum)),o=e.addDisposable(h.t(t.progress.current,e.progress.current)),u=e.addDisposable(h.e(n,e.states)),a=e.addDisposable(h.n(t.error,e.error)),f=e.addDisposable(h.t(t.count,e.count)),l=e.createComputed(function(){var n=!1,r=e.actions.peek();for(var i in t.actions())if(!(i in r)){r[i]=e._initializeAction(i);n=!0}n&&e.actions.valueHasMutated()});return{mappedValue:t,dispose:function(){n.dispose();r.dispose();i.dispose();o.dispose();u.dispose();l.dispose();a.dispose();f.dispose()}}}}))};t.prototype._computeState=function(){var e=this.states();return e.started||e.created&&(e.failed||e.completed||e.canceled)?s.e.started:e.created?s.e.created:e.failed?s.e.failed:e.completed?s.e.completed:e.canceled?s.e.canceled:s.e.expired};t.prototype._computeVisibility=function(){return this.operations().reduce(function(e,t){var n=t.visibility.peek();return n<e?n:e},2)};t.prototype._initializeAction=function(e){var t=this.addDisposable(this.operations.filter(function(t){var n=t.actions()[e];return n&&n.isAvailable()}));return this.addDisposable(new l({count:this.createPureComputed(function(){return t().length}),key:e,operation:this,isAvailable:this.createPureComputed(function(){return!!t().length}),onExecute:function(){return a.n.all(t().slice().map(function(t){var n=t.actions.peek()[e];return n&&n.execute()||a.n.wrap()}))}}))};return t})(i.n),v=n(69),m=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this,i=r.observables,s=new o.e;r._observers=i.createArray();var u=r.operations=i.createArray(),a=r.scope.attached(d),f=r.groups=r.addDisposable(p.e.group(u,function(e){return e.batch}).map({mappingWithDisposeCallback:function(e){var t=new a({batch:e.key,operations:e.values});return{mappedValue:t,dispose:function(){t.dispose()}}}}));r.overall=new(r.managed(d))({batch:s,operations:f});r.isLocked=r.createPureComputed(r._computeIsLocked);r.createBackgroundComputed(r._computeRemoveAllWhenUnlocked).extend({deferred:!0});return r}t.prototype.lock=function(){var e=this,t={};this._observers.push(t);return{dispose:function(){e._observers.remove(t)}}};t.prototype.register=function(e){var t=new c(e);2!==t.visibility.peek()&&this.operations.push(t);return t};t.prototype.deleteGroupOperation=function(e){var t=Object(r.__spreadArray)([],e.operations.peek(),!0);this.operations.removeAll(t);t.forEach(function(e){e.dispose()})};t.prototype.cleanup=function(e){void 0===e&&(e=!1);for(var t=[],n=0,r=this.groups.peek();n<r.length;n++){var i=r[n],o=i.state.peek();if(o===s.e.completed||!e&&(o===s.e.expired||o===s.e.canceled||o===s.e.failed))for(var u=i.operations.peek(),a=void 0,f=0;f<u.length;f++){a=!0;var l=u[f];if(o===s.e.failed&&l.actions)for(var c=l.actions.peek(),h=Object.keys(c),p=0;p<h.length;p++)if("cancel"!==h[p]&&c[h[p]].isAvailable.peek()){a=!1;break}a&&t.push(u[f])}}this.operations.removeAll(t);t.forEach(function(e){e.dispose()})};t.prototype._computeRemoveAllWhenUnlocked=function(){this.isLocked()||this.cleanup()};t.prototype._computeIsLocked=function(){return this._observers().length>0};return t})(i.n),g=Object(v.s)("OperationProvider",m)},function(e,t,n){"use strict";n.d(t,"e",function(){return h});var r=n(3),i=n(69),s=n(348),o=n(502),u=n(282),a=n(490),f=n(30),l=new r.t({name:"cookieOrigin",factory:new r.e(window.location.origin)}),c=new r.t({name:"".concat("VroomDataRequestor",".isOfflineStatePromise"),factory:{dependencies:{isOfflineStateObservable:a.e},create:function(e){return{instance:function(){return f.n.resolve(e.isOfflineStateObservable.get())}}}}}),h=Object(i.s)("VroomDataRequestor",u.e,{sessionManagementProvider:o.e.optional,urlDataSource:s.e.optional,cookieOrigin:l,isOffline:c})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(1),i=Object(r.createContext)({});function s(){return Object(r.useContext)(i)}function o(e){var t=e.dispatcher,n=e.children;return r.createElement(i.Provider,{value:{dispatcher:t}},n)}},,,function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"e",function(){return a});var r=n(1),i=n(162),s=n(153),o=Object(r.createContext)({clear:function(){throw new Error("Missing clear function in WacMessagePresenterContext")},cache:null});function u(){return Object(r.useContext)(o)}function a(e){var t=e.eventType,n=e.children,u=Object(i.t)().dispatcher,a=Object(r.useState)(null),f=a[0],l=a[1],c=r.useCallback(function(){l(null)},[l]),h=r.useCallback(function(e){var t=new s.e;l({message:e,signal:t});var n=t.getPromise();n.then(c,c);return n},[l]);Object(r.useEffect)(function(){if(u&&t){u.addEventListener(t,h);return function(){u.removeEventListener(t,h)}}},[u,t,h]);return r.createElement(o.Provider,{value:{cache:f,clear:c}},f&&c?n:null)}},,function(e,t,n){"use strict";n.d(t,"n",function(){return f});n.d(t,"e",function(){return l});var r;(function(e){e[e.FRE=0]="FRE";e[e.ONEUNIT=1]="ONEUNIT"})(r||(r={}));var i,s=r,o=n(113),u=n(2),a=window.$Config&&window.$Config.isINT,f="https://messaging-int.msonerm.com/",l="https://dynmsg.modpim.com/",c=((i={})[o.e.NewBrandFRE]={id:o.e.NewBrandFRE,type:s.FRE,checkThrottle:function(e){return e.viewCount<=2&&!e.didUserDismiss},getUpsellIframeUrl:function(e){return"".concat(a?f:l,"api/v1/messaging/web/message?puid=").concat(e.upsellUserId,"&locale=").concat(e.market,"&Source=OneDriveFRE")},shouldSendMessageOnClose:!0,renderType:0},i[o.e.OneRmO365Upsell]={id:o.e.OneRmO365Upsell,type:s.ONEUNIT,ramp:u.OneRmO365UpsellEnabled,checkThrottle:function(e){return Object(u.isFeatureEnabled)(u.OneRmO365UpsellEnabled)},getUpsellIframeUrl:function(e){return"".concat(a?f:l,"api/v1/messaging/web/message?puid=").concat(e.upsellUserId,"&locale=").concat(e.market,"&data=").concat(encodeURIComponent(JSON.stringify({isO365:e.isO365,bytesUsed:e.bytesUsed,bytesAvailable:e.bytesAvailable})),"&Source=OneDriveWebBanner")},shouldSendMessageOnClose:!0,renderType:1},i);t.t=c},,,,function(e,t,n){"use strict";n.d(t,"r",function(){return a});n.d(t,"t",function(){return f});n.d(t,"e",function(){return r});n.d(t,"n",function(){return i});var r,i,s,o,u=n(3),a=new u.t("sortManager"),f=new u.t("dataManager");new u.t("listViewContextMenuCommandSet"),new u.t("topCommandSet"),new u.t("listViewContextMenuHelper"),new u.t("fileContent"),new u.t("contentRange"),new u.t("error");(function(e){(function(e){e.isLeftNavClosing=new u.t("base.leftNav.isLeftNavClosing");e.isLeftNavVisible=new u.t("base.leftNav.isLeftNavVisible");e.hideLeftNav=new u.t("base.leftNav.hideLeftNav");e.isLeftNavUserExpanded=new u.t("base.leftNav.isLeftNavUserExpanded");e.toggleIsLeftNavUserExpanded=new u.t("base.leftNav.toggleIsLeftNavUserExpanded")})(e.leftNav||(e.leftNav={}));(function(e){e.context=new u.t("base.suiteNav.context");e.isTopBarVisible=new u.t("base.suiteNav.isTopBarVisible");e.isTopBarHamburgerVisible=new u.t("base.suiteNav.isTopBarHamburgerVisible");e.isSuiteNavHamburgerVisible=new u.t("base.suiteNav.isSuiteNavHamburgerVisible");e.supportHamburgerInSuiteNav=new u.t("base.suiteNav.supportHamburgerInSuiteNav");e.isSuiteNavHidden=new u.t("base.suiteNav.isSuiteNavHidden")})(e.suiteNav||(e.suiteNav={}));(function(e){e.transclusionProvider=new u.t("base.commandBar.transclusionProvider");e.isDarkTheme=new u.t("base.commandBar.isDarkTheme");e.isSearchHidden=new u.t("base.commandBar.isSearchHidden")})(e.commandBar||(e.commandBar={}));(function(e){e.isInfoPaneAvailable=new u.t("base.infoPane.isInfoPaneAvailable");e.hidePreview=new u.t("base.infoPane.hidePreview")})(e.infoPane||(e.infoPane={}));(function(e){e.isFiltersPaneAvailable=new u.t("base.filtersPane.isFiltersPaneAvailable")})(e.filtersPane||(e.filtersPane={}));(function(e){e.isColumnCustomizationPaneExpanded=new u.t("base.columnCustomizationPane.isColumnCustomizationPaneExpanded");e.columnToFormat=new u.t("base.columnCustomizationPane.columnToFormat");e.viewToFormat=new u.t("base.columnCustomizationPane.viewToFormat")})(e.columnCustomizationPane||(e.columnCustomizationPane={}));(function(e){e.isPhotosOnly=new u.t("base.oneUpOverlay.isPhotosOnly")})(e.oneUpOverlay||(e.oneUpOverlay={}));(function(e){e.hasFooter=new u.t("base.footer.hasFooter")})(e.footer||(e.footer={}));e.isSPLightSpeed=new u.t("base.isSPLightSpeed");e.isScrollbarHidden=new u.t("base.isScrollbarHidden");e.addPaddingBottom=new u.t("base.addPaddingBottom");e.makeFlexBox=new u.t("base.makeFlexBox");e.contextMenuHelper=new u.t("base.contextMenuHelper");e.isRetrievingData=new u.t("base.isRetrievingData")})(r||(r={}));(function(e){e.layoutType=new u.t("files.layoutType");e.isArrangeControlVisible=new u.t("files.isArrangeControlVisible")})(i||(i={}));(function(e){e.layoutType=new u.t("photos.layoutType")})(s||(s={}));(function(e){e.layoutType=new u.t("storageInfo.layoutType")})(o||(o={}));new u.t("eventScope")},,,function(e,t,n){"use strict";var r=(function(){function e(){this.id=++e._lastBatchId}e._lastBatchId=0;return e})();t.e=r},,function(e,t,n){"use strict";var r=n(0),i=n(11),s=n(117),o=n(19),u=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=t.item,u=n.getItemSelectionHelperType,a=void 0===u?r.resources.consume(o.e.lazy):u,f=n.itemParentHelper,l=void 0===f?r.resources.consume(s.e):f;r.isItemSpecified=!!i;r.item=i||new(r.scope.attached(a()))({canFallback:!0,ignoreSelection:!0}).currentItem;r.itemParentHelper=l;return r}t.prototype.onIsAvailable=function(){return!!this.item()};t.prototype.getParent=function(e,t,n){var r=this.itemParentHelper.getFacetedAncestorOrSelf(e,t);return n?this.peekUnwrapObservable(r):this.unwrapObservable(r)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.e.dependencies),{getItemSelectionHelperType:o.e.lazy,itemParentHelper:s.e});return t})(i.e);t.e=u},,,,,function(e,t,n){"use strict";var r;(function(e){e[e.defaultValue=0]="defaultValue";e[e.ascending=1]="ascending";e[e.descending=2]="descending"})(r||(r={}));t.e=r},,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(527),i=window._spPageContextInfo,s=function(e){if(i&&i.farmSettings)return i.farmSettings[e]},o=function(e){return e.serviceSetting?(t=e.serviceSetting,1===Number(s(t))||"true"===s(t)):r.n.isFeatureEnabled(e);var t}},,function(e,t,n){"use strict";var r;(function(e){e[e.Lock=1]="Lock";e[e.Unlock=2]="Unlock";e[e.Manage=3]="Manage";e[e.FreDialog=4]="FreDialog";e[e.ShowFiles=5]="ShowFiles";e[e.Reset=6]="Reset";e[e.Debug=7]="Debug";e[e.FilesRemaining=8]="FilesRemaining"})(r||(r={}));t.e=r},,function(e,t,n){"use strict";var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.errorType=t.errorType||0;n.payloads=t.payloads||{};return n}return t})(n(77).e);t.e=i},,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=window.FilesConfig&&window.FilesConfig.env;function i(){switch(r&&r.toLowerCase()){case"soak3":return 4;case"soak2":return 3;case"dev":return 2;case"df":return 1;default:return 0}}},function(e,t,n){"use strict";var r;(function(e){e[e.defaultValue=0]="defaultValue";e[e.displayName=1]="displayName";e[e.dateModified=2]="dateModified";e[e.dateCreated=3]="dateCreated";e[e.size=4]="size";e[e.itemType=5]="itemType";e[e.dateTaken=6]="dateTaken";e[e.owner=7]="owner";e[e.userArranged=8]="userArranged";e[e.dateAccessed=9]="dateAccessed";e[e.relevancy=10]="relevancy";e[e.dateDeleted=11]="dateDeleted";e[e.location=12]="location";e[e.dateShared=13]="dateShared";e[e.sharer=14]="sharer"})(r||(r={}));t.e=r},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){var t=!1;if(e)switch(e.errorCode){case 2:case 101:case 102:case 103:case 152:case 161:case 162:case 200:case 201:case 202:case 209:case 1e3:case 1006:case 1007:case 2006:case 3e3:case 3403:case 9017:case 10001:case 10002:case 10004:case 10006:case 10009:case 10011:case 10012:case 10013:case 10027:t=!0}return t}},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(3).t)("pageContext")},,function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"n",function(){return a});n.d(t,"r",function(){return f});n.d(t,"i",function(){return l});n.d(t,"t",function(){return c});n.d(t,"u",function(){return p});n.d(t,"f",function(){return d});n.d(t,"l",function(){return v});n.d(t,"s",function(){return m});n.d(t,"a",function(){return g});n.d(t,"o",function(){return y});n.d(t,"c",function(){return b});var r=n(2),i=n(30);function s(e){var t;return function(){return t||(t=i.n.resolve(e()).then(function(e){return e.default}).catch(function(e){t=void 0;return i.n.reject(e)}))}}var o="ms-albums-list",u=Object(r.isFeatureEnabled)(r.UseTilesListForAllPhotos)?"od-tiles-list":"ms-all-photos-list",a="ms-grid-customlist",f="ms-details-customlist",l="ms-details-list",c="ms-compact-details-list",h=Object(r.isFeatureEnabled)(r.UseTilesList)?"od-tiles-list":"ms-grid-list",p="ms-single-album-list",d="od-tag-grid",v="od-tags-list",m="od-doccard-grid",g="od-sites-grid-list",y={"ms-albums-list":s(function(){return n.ee([52,"ondemand.resx-ondemand"],1657)}),"od-tiles-list":s(function(){return n.ee([65],1674)}),"ms-all-photos-list":s(function(){return n.ee([53,"ondemand.resx-ondemand"],1658)}),"ms-grid-customlist":s(function(){return n.ee([55,"ondemand.resx-ondemand"],1636)}),"ms-details-customlist":s(function(){return n.ee([56,"ondemand.resx-ondemand"],1603)}),"ms-details-list":s(function(){return n.ee([57],1604)}),"ms-compact-details-list":s(function(){return n.ee([54],1605)}),"ms-grid-list":s(function(){return n.ee([59,"ondemand.resx-ondemand"],1713)}),"ms-single-album-list":s(function(){return n.ee([61,"ondemand.resx-ondemand"],1680)}),"od-tag-grid":s(function(){return n.ee([63,"ondemand.resx-ondemand"],1659)}),"od-tags-list":s(function(){return n.ee([64,"ondemand.resx-ondemand"],1227)}),"od-doccard-grid":s(function(){return n.ee([58,"ondemand.resx-ondemand"],1681)}),"od-shared-grid-list":s(function(){return n.ee([60,"ondemand.resx-ondemand"],1682)}),"od-sites-grid-list":s(function(){return n.ee([62,"ondemand.resx-ondemand"],1646)})};function b(e,t){var n=t&&t.isCustomList,r=t&&t.isPlaceholder;switch(e){case o:return o;case u:return u;case a:return r?e:n?a:h;case f:case l:return r?e:n?f:l;case c:return c;case"ms-grid-list":case"od-tiles-list":case h:return r?e:n?a:h;case p:return p;case d:return d;case v:return v;case m:return m;case"od-shared-grid-list":return"od-shared-grid-list";case g:return g;default:return n?f:l}}},function(e,t,n){"use strict";n.d(t,"t",function(){return o});n.d(t,"e",function(){return u});n.d(t,"n",function(){return a});var r=n(55),i=n(191),s=n(9),o=new r.e("odspNextApp",{}),u=o.serialize({}),a=(new r.e("odspNextPage",{pageType:i.e}),new r.e("OdbSettingsNav",{}),new r.e("OdbSettingsNavSetGroup",{}),new r.e("odspNextPage",{setingsPageType:i.e}),new s.e("disableFastOneUp"),new s.e("resourceScopeFacet"));new s.e("defaultGraphEndpoint"),new s.e("hasPageLoad"),new s.e("isLightspeedApp"),new s.e("sessionId"),new s.e("disallowCookies"),new s.e("enableClaimsChallenge"),new s.e("overrideUseIdentityAuthForVroomFlightEnabled"),new s.e("overrideUseSelfIssuedTokenForSPOWebAuth"),new s.e("nucleusOfflineFacet"),new s.e("offlineDetectionFacet"),new s.e("allowAutomateCrossDomainFacet"),new s.e("spPageContextItem")},function(e,t,n){"use strict";var r=n(354);n.d(t,"e",function(){return r.e});n.d(t,"t",function(){return r.t});n.d(t,"n",function(){return r.n})},,function(e,t,n){"use strict";var r;(function(e){e[e.Files=0]="Files";e[e.Recent=1]="Recent";e[e.DocumentLibraries=2]="DocumentLibraries";e[e.SharedWithMe=3]="SharedWithMe";e[e.DocsInCommon=4]="DocsInCommon";e[e.RecycleBin=5]="RecycleBin";e[e.Photos=6]="Photos";e[e.Search=7]="Search";e[e.AllMyPhotos=8]="AllMyPhotos";e[e.AccountChooserPicker=9]="AccountChooserPicker";e[e.AccountChooserMobileSDK=10]="AccountChooserMobileSDK";e[e.Popular=11]="Popular";e[e.RecentUnpopular=12]="RecentUnpopular";e[e.SecondStageRecycleBin=13]="SecondStageRecycleBin";e[e.Apps=14]="Apps";e[e.Subsites=15]="Subsites";e[e.RecentActivity=18]="RecentActivity";e[e.ExternallyShared=19]="ExternallyShared";e[e.SharedByMe=20]="SharedByMe";e[e.Favorites=21]="Favorites";e[e.DetailsPane=22]="DetailsPane";e[e.Channels=24]="Channels";e[e.PhotoStream=25]="PhotoStream";e[e.PhoneLink=26]="PhoneLink";e[e.DefaultDocLib=27]="DefaultDocLib";e[e.ListSyncIssues=28]="ListSyncIssues";e[e.OneDriveHome=29]="OneDriveHome";e[e.TeamsDownloads=30]="TeamsDownloads";e[e.MyLists=31]="MyLists";e[e.Selection=32]="Selection";e[e.People=33]="People";e[e.Meetings=34]="Meetings";e[e.RecentLists=35]="RecentLists";e[e.MyOrganizationAssets=36]="MyOrganizationAssets"})(r||(r={}));t.e=r},,function(e,t,n){"use strict";n.d(t,"e",function(){return A});var r=n(0),i=n(149),s=n(183),o=n(30),u=n(153),a=n(21),f=n(3),l=n(69),c=n(39),h=new f.t("TokenFetcher.key"),p=n(469),d=n(4),v=n(40),m=n(237),g=n(90),y=n(145),b=n(115),w=n(454),E=n(138),S=n(32),x=n(16),T=!x.e.isActivated("CC480577-4503-4791-A14F-03B120625613","04/29/2022","Use config anon check instead"),N=!x.e.isActivated("51FC098A-B1A9-4476-B1F9-A8A3A0120F40","03/01/2023","Set substrate token expiration time manually to an hour"),C=new f.t({name:"".concat("IdentityDataSource",".enableCooldownAfterAuthFlow"),factory:new f.e(Object(d.qo)(d.Ee))}),k=new f.t({name:"".concat("IdentityDataSource",".enableTokenCache"),factory:new f.e(Object(d.qo)(d.Lo))}),L=(function(){function e(e,t){var n=this;this._getResouceByTokenType=function(e){switch(e){case"graph_auth:":return Object(S.r)();case"substrate_auth:":return Object(S.s)();default:return Object(S.i)()}};this._enableCooldownAfterAuthFlow=t.enableCooldownAfterAuthFlow;this._tokenFetcher=t.tokenFetcher;t.enableTokenCache&&(this._tokenCache=new p.t);this._pendingSignals={"msa_auth:":void 0,"graph_auth:":void 0,"msa_strong_auth:":void 0,"phone_link:":void 0,"substrate_auth:":void 0};this._authFrameAttempts={"msa_auth:":0,"graph_auth:":0,"msa_strong_auth:":0,"phone_link:":0,"substrate_auth:":0};this._tokenRefreshCooldowns={"msa_auth:":void 0,"graph_auth:":void 0,"msa_strong_auth:":void 0,"phone_link:":void 0,"substrate_auth:":void 0};this._scope=new y.e;this._async=this._scope.attach(new b.e);if(this.getIdentity().type===i.e.msa){var r=this._scope.attach(new g.t(this));this._silentAuthOrigin=document.location.protocol+"//"+document.location.hostname;r.on(window,"message",this._onMessageReceived);this._sessionId=$Config.authSessionId||"0";if(!x.e.isActivated("DA868920-AFA9-4023-A5F0-16185C12D46B","10/21/2021","Web canary refresh")){this._lastCanaryRefreshTime=Date.now();r.on(window,"focus",function(){if(Date.now()-n._lastCanaryRefreshTime>6e4){n._lastCanaryRefreshTime=Date.now();n._refreshCanary()}})}}Object(m.t)(m.e.spoSandbox)&&this.signOut()}e.prototype.dispose=function(){this._scope.dispose()};e.prototype.getIdentity=function(){var e=i.e.anonymous,t="";if("UnAuth"!==$Config.unid){t=$Config.unid;e=$Config.aadClientId&&"live.com"===$Config.domain?i.e.aad:i.e.msa}return{email:$Config.email,id:t,loginName:"",type:e,sessionState:""}};e.prototype.getSignInUrl=function(){return FilesConfig.si};e.prototype.signOut=function(){this._expireAuthCookie("msa_auth:");this._expireAuthCookie("graph_auth:");this._expireAuthCookie("substrate_auth:")};e.prototype.getSessionToken=function(e,t,n){void 0===e&&(e=!1);void 0===t&&(t=!1);var r=t?"msa_strong_auth:":"msa_auth:";return this._getToken(r,this._getResouceByTokenType(r),e,n)};e.prototype.getGraphToken=function(e){var t=e.forceRefresh,n=void 0!==t&&t,r=e.claimsChallenge;return this._getToken("graph_auth:",this._getResouceByTokenType("graph_auth:"),n,r)};e.prototype.getPhoneLinkToken=function(e){var t=e.resource,n=e.forceRefresh,r=void 0!==n&&n,i=e.claimsChallenge;return this._getToken("phone_link:",t,r,i)};e.prototype.getSubstrateToken=function(e,t){return this._getToken("substrate_auth:",this._getResouceByTokenType("substrate_auth:"),t)};e.prototype.getAuthUrl=function(e,t){var n=new c.t("https://login.live.com/oauth20_authorize.srf");n.setQueryParameter("client_id","00000000481710A4");n.setQueryParameter("res","success");n.setQueryParameter("resuictx","selection");n.setQueryParameter("response_type","token");if(this.getIdentity().type===i.e.msa){var r="sa.html";t?r="saroot.html":"soak2"===FilesConfig.env?r="sasoak2.html":"soak3"===FilesConfig.env?r="sasoak3.html":"dev"===FilesConfig.env&&(r="sadev.html");n.setQueryParameter("redirect_uri","https://p.sfx.ms/".concat(r));t||"msa_strong_auth:"===e||n.setQueryParameter("display","none");var s=void 0;switch(e){case"msa_auth:":case"msa_strong_auth:":s="dev"===FilesConfig.env||FilesConfig.isSpoSandbox?"onedrive-devbox.access":"msa_strong_auth:"===e?"onedrive_implicit_forceSA.access":"onedrive_implicit.access";break;case"graph_auth:":if(Object(d.qo)(d.vo)){s="contacts.read Files.ReadWrite people.read";Object(w.e)()&&(s+=" Mail.Read");Object(d.qo)(d.en)&&(s+=" Family.Read")}else s="contacts.read";break;case"substrate_auth:":s="https://substrate.office.com/M365.Access"}n.setQueryParameter("scope",s);x.e.isActivated("EF2D0BBC-FA1F-44F7-A93D-899C2AB1F098","","")||n.setQueryParameter("login_hint",$Config.email);return n.toString()}return $Config.silentAuth};e.prototype.refreshAuthTicket=function(){this._silentAuthRpsIframe&&document.body.removeChild(this._silentAuthRpsIframe);this._rpsIFrameQosEvent=new a.e({name:"IdentityDataSource.refreshAuthTicket"});this._silentAuthRpsIframe=document.createElement("iframe");var e=$Config.silentAuth;this._silentAuthRpsIframe.src=e.replace(s.e.encodeURIComponent("{{RU}}"),s.e.encodeURIComponent("https://onedrive.live.com/sa?msaCallback=1"));document.body.appendChild(this._silentAuthRpsIframe)};e.prototype._refreshCanary=function(){(new v.e).send({apiName:"getPageContext",url:"/getpagecontext"}).then(function(e){e.canary&&FilesConfig.canary!==e.canary&&(FilesConfig.canary=e.canary)})};e.prototype._getToken=function(e,t,n,s){if(!this._tokenFetcher){if(this.getIdentity().type===i.e.aad)return o.n.reject("Unable to get a token for a business account");if(Object(d.qo)(d.re)&&this.getIdentity().type===i.e.anonymous)return o.n.reject("Unable to silent auth anonymous unauth users.")}var f;switch(e){case"graph_auth:":f="Graph";break;case"msa_strong_auth:":f="MSAStrong";break;case"phone_link:":f="PhoneLink";break;case"substrate_auth:":f="Substrate";break;default:f="MSA"}var l=new a.e({name:"IdentityDataSource.get".concat(f,"Token")}),c=this._getTokenFromCache(e),h=c.token,p=c.shouldRefresh,v=c.hadCookie;if(n||s){h=void 0;var m=this._tokenRefreshCooldowns[e];m&&m.complete()}if((p||!h)&&!this._pendingSignals[e]){var g=this._pendingSignals[e]=new u.e;this._tokenFetcher?this._tokenFetcher.getToken({resource:t,tokenType:f,name:f,claimsChallenge:s}).then(function(e){g.complete(Object(r.__assign)({accessToken:e.access_token},"WLID1.1"===e.scheme?{wlidToken:e.access_token}:{}))},function(e){g.error(e)}):this._setupSilentAuthIframe(e)}if(h){l.end({resultType:a.t.Success,resultCode:p?"withinExpiration":"cached",error:v?void 0:"noCookie"});return o.n.resolve({accessToken:h})}return this._pendingSignals[e].getPromise().then(function(e){l.end({resultType:a.t.Success,resultCode:"fullRefresh"});return e},function(e){l.end({resultType:a.t.Failure,error:e&&e.message});return o.n.reject(e)})};e.prototype._writeTokenToCache=function(e,t,n){this._writeAuthCookie(e,t,n);var r=Date.now()+1e3*(N&&"substrate_auth:"===e?3600:n);if(this._tokenCache){var i=this._getTokenCacheKey(e);this._tokenCache.setValue(i,{value:t,expiration:r})}};e.prototype._getTokenFromCache=function(e){var t=this._getTokenFromCookie(e);if(this._tokenCache){var n=Date.now(),r=this._getTokenCacheKey(e),i=this._tokenCache.getValue(r,n);if(i)return{token:i.value,shouldRefresh:n+6e4>i.expiration,hadCookie:!!t}}return{token:t,shouldRefresh:!t,hadCookie:!!t}};e.prototype._writeAuthCookie=function(e,t,n){var r=this._getTokenCacheKey(e),i=Date.now()+1e3*(N&&"substrate_auth:"===e?3600:n);E.set(r,t,{path:"/",secure:!0,expires:new Date(i).toUTCString()})};e.prototype._getTokenFromCookie=function(e){var t=this._getTokenCacheKey(e);return E.get(t)};e.prototype._expireAuthCookie=function(e){var t=this._getTokenCacheKey(e);E.expire(t,{secure:!0,path:"/"})};e.prototype._getTokenCacheKey=function(e){return e+this.getIdentity().id+this._sessionId};e.prototype._onMessageReceived=function(e){if(this._silentAuthRpsIframe&&e.source===this._silentAuthRpsIframe.contentWindow&&e.origin===window.location.origin&&e.data){var t=this._rpsIFrameQosEvent;if("MSA_AuthenticationSuccess"===e.data){this._refreshCanary();t.end({resultType:a.t.Success})}else"MSA_AuthenticationError"===e.data&&t.end({resultType:a.t.Failure,resultCode:"error"})}else if(this._silentAuthIframe&&e.source===this._silentAuthIframe.contentWindow&&e.origin===this._silentAuthOrigin&&void 0!==this._silentAuthIframeTokenType){t=this._currentIFrameQosEvent;var n="",r=0;if(e.data&&"object"==typeof e.data&&"ODSA"===e.data.source){n=e.data.token;r=parseInt(e.data.expiresIn,10)}else{if("string"!=typeof e.data)return;var i=e.data.split(" ");if(2===i.length){n=i[0];r=parseInt(i[1],10)}else if(1===i.length){var s=i[0].split("&");t.end({resultType:a.t.Failure,resultCode:"error"});if(0===s[0].indexOf("error=access_denied")){var o=T?null===$Config||void 0===$Config?void 0:$Config.anonId:E.get("ANON");Object(d.qo)(d.ze)&&o&&window.open(this.getAuthUrl(this._silentAuthIframeTokenType,!0),"_self")}return}}if(!!n&&r>0){this._writeTokenToCache(this._silentAuthIframeTokenType,n,r);t.end({resultType:a.t.Success});var u=this._pendingSignals[this._silentAuthIframeTokenType];u&&u.complete({accessToken:n})}else t.end({resultType:a.t.Failure,resultCode:"invalidToken"});this._removeSilentAuthIframe(this._silentAuthIframeTokenType,!0)}};e.prototype._setupSilentAuthIframe=function(e){var t=this;if(!this._silentAuthIframe){this._authFrameAttempts[e]++;this._silentAuthIframeTokenType=e;var n=this._tokenRefreshCooldowns[e];o.n.resolve(n&&n.getPromise()).then(function(){var n=t._currentIFrameQosEvent=new a.e({name:"IdentityDataSource.getTokenViaIFrame",extraData:{authTokenType:e,attemptCount:t._authFrameAttempts[e]}});t._silentAuthIframe=document.createElement("iframe");t._silentAuthIframe.style.display="none";t._silentAuthIframe.src=t.getAuthUrl(e);document.body.appendChild(t._silentAuthIframe);t._silentAuthIframeTimeoutId=t._async.setTimeout(function(){t._silentAuthIframeTimeoutId=void 0;n.end({resultType:a.t.Failure,resultCode:"timeout"});if(t._authFrameAttempts[e]<5){t._removeSilentAuthIframe(e,!1);t._setupSilentAuthIframe(e)}else t._removeSilentAuthIframe(e,!0)},3e4)})}};e.prototype._removeSilentAuthIframe=function(e,t){this._silentAuthIframeTokenType=void 0;if(this._silentAuthIframe){document.body.removeChild(this._silentAuthIframe);this._silentAuthIframe=void 0}if(void 0!==this._silentAuthIframeTimeoutId){this._async.clearTimeout(this._silentAuthIframeTimeoutId);this._silentAuthIframeTimeoutId=void 0}if(this._enableCooldownAfterAuthFlow){var n=this._tokenRefreshCooldowns[e]=new u.e;this._async.setTimeout(function(){n.complete()},3e4)}if(t){var r=this._pendingSignals[e];r&&r.error(new Error("Timed out acquiring OAuth token."));this._pendingSignals[e]=void 0;this._authFrameAttempts[e]=0;this._pendingSignals["msa_auth:"]?this._setupSilentAuthIframe("msa_auth:"):this._pendingSignals["msa_strong_auth:"]?this._setupSilentAuthIframe("msa_strong_auth:"):this._pendingSignals["graph_auth:"]?this._setupSilentAuthIframe("graph_auth:"):this._pendingSignals["substrate_auth:"]&&this._setupSilentAuthIframe("substrate_auth:")}};e.dependencies={enableCooldownAfterAuthFlow:C,enableTokenCache:k,tokenFetcher:h.optional};return e})(),A=Object(l.s)("IdentityDataSource",L)},function(e,t,n){"use strict";n.d(t,"t",function(){return i});var r;(function(e){e[e.unknown=-1]="unknown";e[e.normal=0]="normal";e[e.critical=1]="critical";e[e.full=2]="full";e[e.outOfSpace=3]="outOfSpace";e[e.overQuota=4]="overQuota";e[e.nearing=5]="nearing"})(r||(r={}));var i=function(e){switch(e){case r.normal:return"normal";case r.nearing:return"nearing";case r.critical:return"critical";case r.full:return"full";case r.outOfSpace:return"outOfSpace";case r.overQuota:return"overQuota";default:return"unknown"}};t.e=r},,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(153),i=n(216),s=(function(){function e(){}e.prototype.canHandleRequest=function(e){return!0};e.prototype.handleRequest=function(e,t){var n=new r.e(t);try{var s=new XMLHttpRequest;e.withCredentials&&(s.withCredentials=!0);s.open(e.requestType||"GET",e.url,!0);e.responseType&&(s.responseType=e.responseType);s.timeout=6e4;var o=e.useDefaultHeaders?Object(i.e)(e.headers):e.headers||{};o.Accept||s.setRequestHeader("Accept","application/json;odata=verbose");e.postData&&!o["Content-Type"]&&s.setRequestHeader("Content-Type","application/json;odata=verbose");for(var u in o)o[u]&&s.setRequestHeader(u,o[u]);s.onreadystatechange=function(){4===s.readyState&&n.complete(s)};s.send(e.postData)}catch(e){n.error(e)}return n.getPromise()};return e})()},function(e,t,n){"use strict";n.d(t,"e",function(){return a});n.d(t,"t",function(){return f});var r=n(0),i=n(138),s=n(20),o=n(45),u={canary:o.t.canary,Accept:"application/json",AppId:o.t.appId,"Cache-Control":"private","X-ForceCache":"1"};o.t.oauthToken&&(u["X-Auth"]=o.t.oauthToken);function a(e){var t=Object(r.__assign)(Object(r.__assign)({},u),e||{}),n=(function(){var e=window.location.search,t="";if(e){var n=s.e(e.substring(1)).iam,r=i.get("aad_auth:"+n);if(r){var o=r.indexOf("id_token=");t=r.substring(o+"id_token=".length,r.indexOf("&",o))}}return t})();n&&(t.Authorization="Bearer "+n);o.t.canary&&o.t.canary!==t.canary&&(t.canary=o.t.canary);return t}function f(e,t){var n=e.useDefaultHeaders?a(e.headers):e.headers||{};return{onData:t,payload:{url:e.url,cb:t,v:e.requestType,verb:e.requestType,headers:n,postString:e.postData,cbp:e.progressCallback,timeout:6e4}}}},,,,,,,,,function(e,t,n){"use strict";var r=(function(){function e(e,t){if((function(e){return!!e&&"object"==typeof e})(e)){this.key=e.key;this.input=e.input;this.output=e.output;this.status=e.status;this.error=e.error}else{this.key=e;this.input=t;this.status=0}}e.prototype.succeed=function(t){var n=new e(this);n.output=t;n.status=1;delete n.error;return n};e.prototype.fail=function(t){var n=new e(this);n.error=t;n.status=2;return n};e.prototype.cancel=function(){var t=new e(this);delete t.error;t.status=3;return t};e.prototype.restart=function(){return new e(this.key,this.input)};e.prototype.changeInput=function(t){var n=t(this.input),r=new e(this.key,n);r.output=this.output;r.status=this.status;r.error=this.error;return r};e.prototype.changeOutput=function(t){var n=t(this.output),r=new e(this.key,this.input);r.output=n;r.status=this.status;r.error=this.error;return r};e.prototype.compare=function(e){return!e||this.input!==e.input||this.output!==e.output||this.error!==e.error||this.status!==e.status?{previous:e,current:this}:null};return e})();t.e=r},,function(e,t,n){"use strict";var r=n(338);n.d(t,"e",function(){return r.e});n.d(t,"t",function(){return r.t})},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=n(177),i=n(16),s={showFre:"showFre",showPremiumPositioning:"showPremiumPositioning",showNewFeaturesExperience:"showNewFeaturesExperience",showWelcomeExperience:"showWelcomeExperience",showFamiliesFre:"showFamiliesFre",showGroupsFre:"showGroupsFre",showHolidayPosFre:"showHolidayPosFre",showQuotaLevelUpsellFre:"showQuotaLevelUpsellFre",upsellOverride:"upsell",resetUpsellParams:"resetUpsells",spoSandbox:"spoSandbox",showPwaInstallDialog:"showPwaInstallDialog"};function o(e,t){var n;void 0===t&&(t={});return(null===(n=window.__testHooks)||void 0===n?void 0:n[e])||t[e]||void 0}i.e.isActivated("8C62316A-3AF9-4CDB-875D-5C08EA8E7C21","02/24/2022","Stash ODC test hooks to window so that they persist throughout page load and in-app navigations")||(function(){if(!window.__testHooks){window.__testHooks={};var e=location.search?location.search.substring(1):"",t=Object(r.e)(e);for(var n in s)t[n]&&(window.__testHooks[n]=t[n])}})()},,,,,function(e,t,n){"use strict";n(0),n(1);var r=n(262);n.d(t,"e",function(){return r.e});n.d(t,"t",function(){return r.n})},,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(3),i=n(69),s=new r.t("identity");new r.t({name:"IdentityDataSource.key",loader:new i.t(function(){return n.ee([122],640).then(function(e){return e.resourceKey})})})},,function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r,i;function s(){void 0===r&&(r=-1!==navigator.userAgent.indexOf("OneDriveWinApp")||(function(){try{return!!window.sessionStorage.getItem("_isOneDriveWinApp")}catch(e){return!1}})());return r}function o(){if(void 0===i){var e=navigator.userAgent;i=-1!==e.indexOf("Xbox")&&-1!==e.indexOf("OneDriveWinApp")}return i}},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(3),i=n(4),s=new r.t({name:"".concat("SharedItemsScopeExperiment.key",".isUseItemsScopeInSharedEnabled"),factory:new r.e(Object(i.qo)(i.ro))})},,,function(e,t,n){"use strict";var r=n(349);n.d(t,"e",function(){return r.e})},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(90),i=(function(){function e(e){this._proxySetup=!1;this._eventGroup=new r.t(window);this._requests=[];this._onAttach=e.onAttach;this._onReady=e.onReady;this._initIframeIfNotExist(e.source);window.$Network||(window.$Network={Proxy:{_registerProxy:s},onhttperror:{fire:function(){}}});window.NextNetworkRegisterProxy=s}e.prototype.createRequest=function(e){this._proxySetup?this._doRequest(e):this._requests.push(e)};e.prototype.reloadIframe=function(e){var t=this._iframe.src;document.body.removeChild(this._iframe);this._proxySetup=!1;this._iframe=void 0;this._initIframeIfNotExist(e||t)};e.prototype._attachToIframe=function(e){var t=this;this._eventGroup.on(e,"iframeReady",function(){t._eventGroup.off(e);t._onProxyReady()});this._onAttach&&this._onAttach(e)};e.prototype._onProxyReady=function(){this._onReady&&this._onReady();this._proxySetup=!0;for(var e=0,t=this._requests;e<t.length;e++){var n=t[e];this.createRequest(n)}this._requests=[]};e.prototype._doRequest=function(e){this._iframe.contentWindow.fetchXML(e.payload,null,null,e.onData)};e.prototype._initIframeIfNotExist=function(e){if(!this._iframe){this._iframe=(function(e,t){(e=document.createElement("iframe")).style.display="none";e.src=t;return e})(this._iframe,e);this._attachToIframe(this._iframe);document.body.insertBefore(this._iframe,document.body.firstChild)}};return e})();function s(e){var t=e.frameElement;r.t.raise(t,"iframeReady")}},,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return i});n.d(t,"n",function(){return s});var r="List",i="Grid",s="Album"},function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});var r=(window.FilesConfig&&window.FilesConfig.skyApiDomain)+"/API/2/";function i(){return r+"GetUserInfo"}function s(){return r+"SetUserInfo"}},function(e,t,n){"use strict";var r=n(153),i=n(40),s=(function(){function e(){}e.start=function(e){var t=new r.e(function(){for(var e=0,t=o;e<t.length;e++){t[e].cancel()}}),n=e.items.slice(),s=e.parallelRequests||1,o=[];function u(e){var t=o.indexOf(e);t>=0&&o.splice(1,t)}function a(){var r=new i.e,s=n.splice(0,e.batchSize),f=JSON.stringify(e.getPostData(s)),l=r.send({apiName:e.apiName,url:e.url,requestType:"POST",postData:f,isErrorExpectedCallback:e.isErrorExpectedCallback}).then(function(){u(l);e.onBatchComplete&&e.onBatchComplete(s);n.length?a():t.complete()},function(e){u(l);(function(e){t.error(e)})(e)});o.push(l)}for(var f=0;n.length>0&&f<s;f++)a();return t.getPromise()};return e})();t.e=s},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(3).n)({owner:"OneDriveRoot",useFactoriesOnKeys:!0})},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return i});var r=1,i=10},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});n.d(t,"n",function(){return a});n.d(t,"i",function(){return f});n.d(t,"r",function(){return l});var r=n(17),i=n(5),s=["","Lock","Unlock","Manage","FreDialog","Unlock","Reset","Debug","FilesRemaining"],o="PVault-IconUpsell",u="PVault-QuotaBannerLearnMore",a="PVault-QuotaErrorLearnMore";function f(e){return s[e]}function l(e,t){var n;switch(e){case r.e.Files:n="Files";break;case r.e.Restore:n="Restore";break;case r.e.RansomwareDetection:n="RansomwareDetection";break;case r.e.ManageVault:n="ManageVault";break;default:n=""}return t?"".concat(n,"-").concat(i.e[t]):"".concat(n)}},,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(3),i=n(69),s=new r.t({name:"VaultDataSource.key",loader:new i.t(function(){return n.ee(0,399).then(function(e){return e.resourceKey})})})},,,function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return i});var r,i;(function(e){e[e.Storage50GbPlanMonthly=1]="Storage50GbPlanMonthly";e[e.Storage50GbPlanAnnual=2]="Storage50GbPlanAnnual";e[e.OfficeHomeMonthly=3]="OfficeHomeMonthly";e[e.OfficeHomeAnnual=4]="OfficeHomeAnnual";e[e.OfficePersonalMonthly=5]="OfficePersonalMonthly";e[e.OfficePersonalAnnual=6]="OfficePersonalAnnual";e[e.OfficeTrial=7]="OfficeTrial";e[e.OfficeOffer1YearFree=8]="OfficeOffer1YearFree";e[e.OfficeSolo=9]="OfficeSolo";e[e.OfficeHomeLearnMore=10]="OfficeHomeLearnMore";e[e.OfficePersonalLearnMore=11]="OfficePersonalLearnMore";e[e.ChangeCurrency=12]="ChangeCurrency";e[e.OfficePersonalTermsAndConditions=13]="OfficePersonalTermsAndConditions";e[e.FeatureCardStorage=14]="FeatureCardStorage";e[e.FeatureCardProductivity=15]="FeatureCardProductivity";e[e.FeatureCardSecurity=16]="FeatureCardSecurity";e[e.FeatureCardSharing=17]="FeatureCardSharing";e[e.FeatureCardOfficeApps=18]="FeatureCardOfficeApps";e[e.LaunchFeatureCard=19]="LaunchFeatureCard";e[e.LaunchSeeAllFeatures=20]="LaunchSeeAllFeatures";e[e.MonthlyAnnualPriceToggle=21]="MonthlyAnnualPriceToggle";e[e.StoragePlanOnSlider=22]="StoragePlanOnSlider";e[e.OfficePersonalOnSlider=23]="OfficePersonalOnSlider";e[e.OfficeHomeOnSlider=24]="OfficeHomeOnSlider";e[e.SelectPlanOnSlider=25]="SelectPlanOnSlider";e[e.EmbedConfiguratorLinkShown=26]="EmbedConfiguratorLinkShown";e[e.EmbedConfiguratorClick=27]="EmbedConfiguratorClick";e[e.WhatsTakingUpSpace=28]="WhatsTakingUpSpace";e[e.SelectedOfficeHomeMonthly=29]="SelectedOfficeHomeMonthly";e[e.SelectedOfficePersonalMonthly=30]="SelectedOfficePersonalMonthly";e[e.PlansInterruptDialogAnnualOption=31]="PlansInterruptDialogAnnualOption";e[e.PlansInterruptDialogMonthlyOption=32]="PlansInterruptDialogMonthlyOption";e[e.PrintPdfNative=33]="PrintPdfNative";e[e.PrintPdfDownloadOptionShown=34]="PrintPdfDownloadOptionShown";e[e.PrintPdfDownloadOptionClicked=35]="PrintPdfDownloadOptionClicked";e[e.SharedViaFacebook=36]="SharedViaFacebook";e[e.SharedViaTwitter=37]="SharedViaTwitter";e[e.SharedViaLinkedIn=38]="SharedViaLinkedIn";e[e.SharedViaSinaWeibo=39]="SharedViaSinaWeibo";e[e.ShowPlansInterruptDialog=40]="ShowPlansInterruptDialog";e[e.ClosePlansInterruptDialog=41]="ClosePlansInterruptDialog";e[e.Shown100GbPlanInterruptDialog=42]="Shown100GbPlanInterruptDialog";e[e.ShownRedeemSamsungBonusDialog=43]="ShownRedeemSamsungBonusDialog";e[e.InterruptO365Clicked=44]="InterruptO365Clicked";e[e.InterruptOD50Clicked=45]="InterruptOD50Clicked";e[e.DownloadOfficeApps=46]="DownloadOfficeApps";e[e.QuotaUsageClick=47]="QuotaUsageClick";e[e.GetAdditionalStorageClick=48]="GetAdditionalStorageClick";e[e.UnipuxExperiencePurchaseClick=49]="UnipuxExperiencePurchaseClick";e[e.AADCPurchaseBlock=50]="AADCPurchaseBlock";e[e.StorageInfoUpsellClick=51]="StorageInfoUpsellClick"})(r||(r={}));(function(e){e[e.OfficePlansSection=1]="OfficePlansSection";e[e.StoragePlansSection=2]="StoragePlansSection";e[e.UpgradePage=3]="UpgradePage";e[e.BelowQuotaProgressBar=4]="BelowQuotaProgressBar";e[e.EmbedPane=5]="EmbedPane";e[e.OneUp=6]="OneUp";e[e.SharingDialog=7]="SharingDialog";e[e.ManageStoragePage=8]="ManageStoragePage"})(i||(i={}))},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(3).t)("engagementHandlers")}],Array(17),[function(e,t,n){"use strict";n.d(t,"e",function(){return d});n.d(t,"r",function(){return v});n.d(t,"t",function(){return m});n.d(t,"n",function(){return g});var r=n(0),i=n(7),s=n(85),o=n(622),u=n(134),a=n(497),f=n(13),l=n(3),c=n(69),h=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this,i=r.observables;r._selectionModel=n.itemSetSelectionModel;r._clientSideExtensionHelper=n.clientSideExtensionHelper;r._itemsStore=n.itemsStore;var u=r.selection=new o.e({selectionMode:1===r._selectionModel.mode?s.n.single:s.n.multiple,onSelectionChanged:r._onSelectionChange.bind(r),getKey:r.getKey.bind(r),canSelectItem:r._canSelectItem.bind(r)});r._isModal=i.create(!!u.isModal&&u.isModal());i.compute(r._computeUpdateItems);i.backgroundCompute(r._computeUpdateReactSelection);r.isModal=i.compute({read:function(){return r._isModal()},write:function(e){return u&&u.setModal(e)},pure:!0});return r}t.prototype.getKey=function(e,t){return e&&this._selectionModel.getItemKey(this._itemsStore.getItem("".concat(e.key)))||"".concat(t)};t.prototype._computeUpdateReactSelection=function(){var e=this,t=this._selectionModel,n=this.selection,r=t.selection();this.observables.ignore(function(){if(e._shouldUpdateSelection())if(0===t.mode&&(t.isAllSelected()&&!n.isAllSelected()||0===t.selectedCount()&&n.isAllSelected()))n.setAllSelected(t.isAllSelected()&&!n.isAllSelected());else{n.setChangeEvents(!1);n.setAllSelected(!1);for(var i=0,s=r;i<s.length;i++){var o=s[i];n.setKeySelected(t.getItemKey(o),!0,!1)}n.setChangeEvents(!0)}})};t.prototype._shouldUpdateSelection=function(){var e=this._selectionModel,t=this.selection,n=!1;if(e.selectedCount()!==t.count||0===e.mode&&e.isAllSelected()!==t.isAllSelected())n=!0;else if(!t.isAllSelected()||1===e.mode)for(var r=0,i=e.selection();r<i.length;r++){var s=i[r];if(!t.isKeySelected(e.getItemKey(s))){n=!0;break}}return n};t.prototype._onSelectionChange=function(){var e=this;this.observables.ignore(function(){var t=e._selectionModel,n=e.selection;e._isModal(!!n.isModal&&n.isModal());if(e._shouldUpdateSelection()){if(n.mode===s.n.multiple&&(!t.isAllSelected()&&n.isAllSelected()||t.isAllSelected()&&0===n.count))!t.isAllSelected()&&n.isAllSelected()?t.selectAll():t.clear();else{for(var r=[],i=0,o=n.getSelection();i<o.length;i++){var u=o[i],a=e.getKey(u);r.push(a)}t.setSelectedKeys(r)}var f=e._clientSideExtensionHelper;f&&f.raiseListChangeEvent(n.getSelection())}})};t.prototype._computeUpdateItems=function(){var e=this,t=this._selectionModel.itemSet(),n=[];if(t)for(var r=0,i=t.content().items;r<i.length;r++){var s=i[r],o=this.observables.peekUnwrap(s);o?n.push(o):n.push(void 0)}this.observables.ignore(function(){var r=t&&e.observables.peekUnwrap(t.item);(t&&!t.isPlaceholder||r&&r.isStub)&&e.selection.setItems(n,!1)})};t.prototype._canSelectItem=function(e){var t=this;return this.observables.ignore(function(){return t._selectionModel.canSelectItem(t._itemsStore.getItem(e.key))})};return t})(i.n),p=new l.t({name:"".concat("SelectionManager",".selectionManager"),factory:new c.n(h,Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{itemSetSelectionModel:f.g,clientSideExtensionHelper:a.e.optional,itemsStore:u.e}))}),d=new l.t({name:"".concat("SelectionManager",".getKey"),factory:{dependencies:{selectionManager:p},create:function(e){var t=e.selectionManager;return{instance:function(e,n){return t.getKey(e,n)}}}}}),v=new l.t({name:"".concat("SelectionManager",".selectionMode"),factory:{dependencies:{itemSetSelectionModel:f.g},create:function(e){return{instance:0===e.itemSetSelectionModel.mode?s.n.multiple:s.n.single}}}}),m=new l.t({name:"".concat("SelectionManager",".getKey"),factory:{dependencies:{selectionManager:p},create:function(e){return{instance:e.selectionManager.isModal}}}}),g=new l.t({name:"SelectionManager",factory:{dependencies:{selectionManager:p},create:function(e){return{instance:e.selectionManager.selection}}}});new l.t({name:"".concat("SelectionManager",".hasSelection"),factory:{dependencies:{itemSetSelectionModel:f.g,isSelectionModal:m,observablesFactoryType:i.i},create:function(e){var t=new e.observablesFactoryType,n=e.itemSetSelectionModel,r=e.isSelectionModal;return{instance:t.pureCompute(function(){return r()||n.selectedCount()>0}),disposable:t}}}})},function(e,t,n){"use strict";n.d(t,"n",function(){return y});n.d(t,"r",function(){return b});n(407),n(61);var r,i,s,o,u,a=n(41),f=n(319);n.d(t,"e",function(){return f.e});n.d(t,"t",function(){return f.t});n.d(t,"i",function(){return f.n});n.d(t,"s",function(){return f.r});n.d(t,"o",function(){return f.i});var l="ms-word",c="onenote|UsePlain",h="ms-powerpoint",p="ms-excel",d="ms-visio",v="ms-publisher",m="ms-project";(r={})[l]=a.OpenInWordOnline,r[c]=a.OpenInOneNoteOnline,r[h]=a.OpenInPowerPointOnline,r[p]=a.OpenInExcelOnline,r[d]=a.OpenInVisioOnline;(i={})[l]=a.OpenInWord,i[c]=a.OpenInOneNote,i[h]=a.OpenInPowerPoint,i[p]=a.OpenInExcel,i[d]=a.OpenInVisio,i[v]=a.OpenInPublisher,i[m]=a.OpenInProject,i["ms-infopath"]=a.OpenInInfoPath;var g=((s={})[l]="Word",s[c]="OneNote",s[h]="PowerPoint",s[m]="Project",s[d]="Visio",s[p]="Excel",s);function y(e){var t=e.extension;return t&&".pdf"===t.toLowerCase()?"WordPdf":g[e.appMap]||"Word"}function b(e){return g[e]}(o={})[l]="WordLogo",o[c]="OneNoteLogo",o[h]="PowerPointLogo",o[p]="ExcelLogo",o[d]="VisioLogo",o[v]="Page",(u={})[l]="svg/word_16x1.svg",u[c]="svg/onenote_16x1.svg",u[h]="svg/powerpoint_16x1.svg",u[p]="svg/excel_16x1.svg",u[d]="svg/visio_16x1.svg",u[v]="Page",u.Stream="svg/stream_16x1.svg"},,function(e,t,n){"use strict";var r=n(0),i=n(7),s=n(225);n.d(t,"t",function(){return s.e});var o=n(392),u=n(30),a=n(153),f=n(160),l=n(43),c=n(192),h=n(107);n.d(t,"e",function(){return h.e});var p=n(174),d=n(412),v=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r._actionsByName={};var i=n.operationProvider,s=void 0===i?r.resources.consume(f.e):i,u=n.operatorBatchMonitorType,a=void 0===u?r.resources.consume(d.e):u;r._operationProvider=s;r._operationBatch=new p.e;r._operatorBatchMonitor=r.scope.attach(new a({operationBatch:r._operationBatch,onOperationFinished:function(e){return r.onOperationFinished(e)}}));r._operationsByKey={};r._observer=r.addDisposable(new o.e(r._onTaskChanges.bind(r)));r._throttleExecuteAllActions=r.async.debounce(r._executeAllActions);r.registerActions({cancel:r.onCancel});return r}t.prototype.dispose=function(){e.prototype.dispose.call(this);this._observer=null;this._actionsByName={};this._getActionExecutor=null;this._onTaskChanges=null;this._operationsByKey={};this._throttleExecuteAllActions=null};t.prototype.start=function(){var e=this;return this._operatorBatchMonitor.start(function(){return e.onStart(e._observer)})};t.prototype.wait=function(){var e=this;return this._operatorBatchMonitor.wait().then(function(){e.dispose()},function(){e.dispose()})};t.prototype.onStart=function(e){return u.n.wrap()};t.prototype.onCancel=function(e,t){e=e.map(function(e){return e.cancel()});t.update(e);return u.n.wrap()};t.prototype.registerActions=function(e){for(var t in e){var n=e[t];if(n){n._BaseOperator_actionName=t;this._actionsByName[t]={action:e[t],callback:e[t].bind(this),queue:[],signal:new a.e}}else delete this._actionsByName[t]}};t.prototype.getOperationDetails=function(e){var t;t=1===e.status?l.e.completed:2===e.status?l.e.failed:3===e.status?l.e.canceled:l.e.started;return{type:h.e.multiple,name:"",iconName:null,error:e.error&&new c.e({message:e.error.message,payloads:{}})||null,state:t,progress:{minimum:0,maximum:3!==e.status?1:0,current:1===e.status?1:0},visibility:0,payloads:{},actions:[]}};t.prototype.onOperationFinished=function(e){};t.prototype._queueTaskForAction=function(e,t){var n=this._actionsByName[e];n.queue.push(t);this._throttleExecuteAllActions();return n.signal.getPromise()};t.prototype._executeAllActions=function(){for(var e in this._actionsByName){var t=this._actionsByName[e],n=t.signal;t.signal=new a.e;if(t.queue.length){var r=t.queue.splice(0,t.queue.length);t.callback(r,this._observer).done(m(n),g(n))}}};t.prototype._onTaskChanges=function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];this._updateOperationForTask(r)}};t.prototype._updateOperationForTask=function(e){var t,n=e.current,r=this.getOperationDetails(n),i=this._operationsByKey[n.key];t={};for(var s=0,o=r.actions;s<o.length;s++){var u=o[s],a=u._BaseOperator_actionName,f=this._actionsByName[a];f&&f.action===u&&(t[a]=!0)}if(!i){var l={};for(var a in this._actionsByName)l[a]={isAvailable:this.createObservable(a in t),execute:this._getActionExecutor(a,n)};var c={batch:this._operationBatch,type:r.type,name:r.name,iconName:r.iconName,payloads:r.payloads,progress:r.progress,visibility:r.visibility,actions:l};i=this._operationsByKey[n.key]=this._operationProvider.register(c)}if(i.name!==r.name){i.name=r.name;i.payloads(r.payloads)}i.progress.minimum(r.progress.minimum);i.progress.maximum(r.progress.maximum);i.progress.current(r.progress.current);i.type(r.type);i.error(r.error);i.state(r.state);for(var a in this._actionsByName)i.actions.peek()[a].isAvailable(a in t)};t.prototype._getActionExecutor=function(e,t){var n=this;return function(){return n._queueTaskForAction(e,t)}};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{operationProvider:f.e,operatorBatchMonitorType:d.e});return t})(i.n);t.n=v;function m(e){return function(){return e.complete()}}function g(e){return function(t){return e.error(t)}}},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(3),i=n(256),s=new r.t({name:"NeedsOverlayContent.key",factory:{dependencies:{},create:function(){return{instance:{needsOverlayContent:new i.e(!1)}}}}})},,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.notConfigured=0]="notConfigured";e[e.visible=1]="visible";e[e.notVisible=2]="notVisible"})(r||(r={}))},,function(e,t,n){"use strict";var r=n(623);t.e=r.e},,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(3),i=new r.t("rumOneHelper");new r.t("rumOneListsHomeHelper"),new r.t("RUMOneScenarioPrefix")},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return c});n.d(t,"n",function(){return p});n.d(t,"t",function(){return d});n(28);var r=n(124),i=n(71),s=(n(33),"Doc"),o="Ppt",u="Xls",a="Vsd",f="Lib",l={WinDocuments:f,WinLibrary:f,WinMusic:f,WinPictures:f,WinPodcastLibrary:f,WinVideos:f,WinDrive:"Drive",CDDrive:"CDDrive",GenericDrive:"Drive",UsbDrive:"USBDrive",ExternalDrive:"ExtDrive",NetworkStorage:"NetDrive",Accdb:"Mdb",Doc:s,Docm:s,Docx:s,Dot:s,Dotm:s,Dotx:s,Exe:"Exe",Html:"Html",Mdb:"Mdb",Mpp:"Mpp",Mpt:"Mpp",Odp:o,Ods:u,Odt:s,One:"One",Onepkg:"One",Onetoc2:"One",Notebook:"OneNotebook",Pot:o,Potm:o,Potx:o,Ppa:o,Ppam:o,Pps:o,Ppsm:o,Ppsx:o,Ppt:o,Pptm:o,Pptx:o,Pub:"Pub",Rtf:"Rtf",Txt:"Txt",Vdw:a,Vsd:a,Vsdm:a,Vsdx:a,Vsl:a,Vss:a,Vssm:a,Vssx:a,Vst:a,Vstm:a,Vstx:a,Xaml:"Xaml",Xla:u,Xlam:u,Xll:u,Xls:u,Xlsb:u,Xlsm:u,Xlsx:u,Xlt:u,Xltm:u,Xltx:u,Xml:"Xml",Xps:"Xps",Xsn:"Xsn",Zip:"Zip"};function c(e){var t=r.fileTypeNoExtension;if(!e)return t;var n=h(i.e(e));if(n)return r["fileType"+n];var s=e.toUpperCase();return s?i.o(r.fileTypeUnknown,s):t}function h(e){return l[e]}function p(e){return d(e)&&!!e.properties.newTag}function d(e){return!!e.properties&&!!e.properties.autoAlbumTag}},function(e,t,n){"use strict";var r=n(0),i=n(241),s=n(67),o=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,i=n.valueAccessor();n._platform=n.resources.consume(s.e.optional);n._isPermanent="object"==typeof i&&i.isPermanent||!1;n._isReentrant="object"==typeof i&&i.isReentrant||!1;document.activeElement===n.element&&n._select();var o=Object(r.__assign)({focus:n._onFocus,focusin:n._onFocus,mouseup:n._onMouseUp},n._isReentrant?{focusout:n._onFocusOut}:{});n.events.onAll(n.element,o);return n}t.prototype._select=function(){var e=this.element;if((this._isPermanent||!this._hasSelected)&&"function"==typeof this.element.select){e.select();try{this._platform.isIOS&&e.value&&e.setSelectionRange(0,e.value.length)}catch(e){}this._hasSelected=!0;return!0}return!1};t.prototype._onFocus=function(e){this._select();return!0};t.prototype._onFocusOut=function(){this._hasSelected=!1;return!0};t.prototype._onMouseUp=function(e){if(this._select())return!1};return t})(i.t);t.e=o},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(3).t)("attributionHelper")},,,function(e,t,n){"use strict";var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.html=t.html;return n}return t})(n(97).e),s=n(98).e({tagName:"ms-html-container",template:'<div class="HTMLContainer" data-bind="html:html"></div>',viewModel:i});t.e=s},function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"n",function(){return i});var r={idParamKey:"id",parentIdParamKey:"parent",driveIdParamKey:"driveId",driveEndpointParamKey:"endpoint",queryTypeParamKey:"view",pageParamKey:"p",parentQueryTypeParamKey:"parentview",windowNameJsonKey:"ODBParams",queryParamKey:"q",conversationIdParamKey:"cvid",metadataSearchIdKey:"searchid",uniqueParamKey:"u",navParamKey:"nav",localeKey:"locale",dateFilterKey:"dateFilter",typeFiltersKey:"typeFilters",userFiltersKey:"userFilters",viewIdKey:"viewid",viewPathKey:"viewpath",isPowerAppView:"isPowerAppView",listIdKey:"listid",listUrlKey:"listurl",sortFieldKey:"sortField",isAscendingKey:"isAscending",policyTipKey:"policyTipForListItemId",sharingKey:"sharingDialogForListItemId",managePermissionsKey:"managePermissionsForListItemId",pseudoPolicyTipKey:"showpolicytips",groupByKey:"groupBy",errorTypeKey:"type",correlationIdKey:"correlation",commentIdKey:"commentId",emailCTRParamKey:"e",useFiltersInViewXmlKey:"useFiltersInViewXml",itemId:"itemId",playlistLayout:"playlistLayout",needsAttentionViewKey:"needsAttentionView",requiredColumnsKey:"required",pickerLinkTypeKey:"link_type",pickerAADClientIdKey:"aad_client_id",pickerMSAClientIdKey:"msa_client_id",pickerSelectionModeKey:"selection_mode",pickerViewTypeKey:"view_type",pickerAccessLevelKey:"access",pickerReturnUrlKey:"ru",remoteItem:"remoteItem",stateParamKey:"state",callerId:"CallerId",callerScenarioId:"CallerScenarioId",listItemIdKey:"ID",rootFolderParamKey:"RootFolder",sourceKey:"Source",isDialogKey:"IsDlg",contentTypeId:"ContentTypeId",newTargetListUrlKey:"newTargetListUrl",shareLinkId:"slrid",settingKey:"setting",userExpirationPanelKey:"userExpiration",sharedLibraryCreated:"sharedLibraryCreated",expandPageRowLimitKey:"rowLimit",fileBrowserOptionsKey:"fileBrowser",groupIdKey:"groupId",odSkipAutoFocus:"odSkipAutoFocus",teamIdKey:"teamId",channelIdKey:"channelId",entityIdKey:"entityId",subEntityIdKey:"subEntityId",ringIdKey:"ringId",asidKey:"asid",sidKey:"sid",returnUrl:"returnUrl",disableQueryAlterationKey:"dqa",searchScopeKey:"searchScope",action:"action",videoDriveId:"videoDriveId",videoItemId:"videoItemId",videoParentId:"videoParentId",viewerKey:"viewer",personIdKey:"personId",meetingIdKey:"meetingId",templateId:"templateId",sourceDoc:"sourcedoc",entryPoint:"entry",viewerNavParamKey:"NAV"},i=/^Filter(Field|Value|Type|Op|LookupId|Display)(s?)([1-9]|10)$/;t.t=r},function(e,t,n){"use strict";n.r(t);n.d(t,"ODB_LEFT_NAV",function(){return E});n.d(t,"NEW_OFFICE_FILE",function(){return S});n.d(t,"ODC_PHOTOS_SEARCH",function(){return x});n.d(t,"DOCSET_PROPERTIES_PANE",function(){return T});n.d(t,"PHOTO_LAYOUT",function(){return C});n.d(t,"ODC_MOBILE_APP_UPSELL",function(){return L});n.d(t,"ODC_WEB_COMMENTS",function(){return A});n.d(t,"EXPIRING_SHARING_LINKS",function(){return O});n.d(t,"FLOW_REQUEST_SIGNOFF",function(){return M});n.d(t,"FLOW_REMIND_ME",function(){return _});n.d(t,"FLOW_ODB_COMMAND_BAR_COACHMARK",function(){return D});n.d(t,"RECENT_VIEW",function(){return H});n.d(t,"LEFT_NAV_SITE_PINNING",function(){return B});n.d(t,"GO_TO_SITE",function(){return j});n.d(t,"ADD_TO_ONEDRIVE_COMMAND",function(){return F});n.d(t,"ADD_TO_ONEDRIVE_COMMAND_CFT",function(){return I});n.d(t,"PHOTO_EDIT",function(){return q});n.d(t,"PDF_EDIT",function(){return R});n.d(t,"LAUNCH_BUSINESS_APPS_SETUP_WIZARD_COMMAND",function(){return U});n.d(t,"METADATA_SEARCH_TEACHING_BUBBLE",function(){return z});n.d(t,"CONTENT_QUERY_DISCOVERY_TEACHING_BUBBLE",function(){return W});n.d(t,"CONTENT_QUERY_DISCOVERY_TEACHING_BUBBLE_SECONDARY",function(){return X});n.d(t,"METADATA_SEARCH_QUERYABLE_FIELD",function(){return V});n.d(t,"ADD_SMART_TEMPLATE",function(){return $});n.d(t,"GENERATE_CAAE_DOCUMENT",function(){return J});n.d(t,"MODERN_TEMPLATE_VIEW_INFO",function(){return K});n.d(t,"USE_UNIVERSAL_ANNOTATION",function(){return Q});n.d(t,"TMR_EXPIRATION_DATE_EDIT",function(){return G});n.d(t,"PHOTO_STORY",function(){return Y});n.d(t,"SHARE_TO_TEAMS",function(){return Z});n.d(t,"BACK_UP_YOUR_PC_FILES",function(){return ee});n.d(t,"SETUP_DOCUMENT_ANALYSIS_FLOW_COMMAND",function(){return te});var r=n(0),i=n(226),s=n(35),o=n(108),u=n(281),a=n(157),f=n(2),l=n(371),c=n(277),h=n(1),p=n(545),d=n(13),v=n(242),m=n(306);var g=n(374);var y=n(68),b=n(721),w=Object(b.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([173,"ondemand.resx-ondemand"],1714)];case 1:return[2,e.sent().PsOnboardingTeachingBubbleContent]}})})}),E={campaignGuid:"49FEA7F9-6B31-4C2C-95EC-A9246E51D22C",startDate:new Date(2014,8,29),endDate:new Date(2016,4,1),title:s.F,bodyCopy:s.j,flag:f.Off,colorVariation:o.e.themePrimary},S={campaignGuid:"1c2b5f74-1c33-4297-8199-97c78c2284c2",bodyCopy:s.c,flag:f.On,colorVariation:o.e.themePrimary,isDismissable:!0,isCoachmark:!0},x={campaignGuid:"D3F55EC7-C130-456E-8F27-2EA31F2D5B8D",startDate:new Date(2016,2,23),endDate:new Date(2019,2,23),bodyCopy:s.U,flag:f.PhotosSearchBubble,colorVariation:o.e.themePrimary},T={campaignGuid:"DB44A538-E6D0-4AC6-B735-3D77161E6E83",killSwitchGuid:"714AF444-CE4B-4A21-AFB9-71CAA861CC3D",title:s.p,bodyCopy:s.h,colorVariation:o.e.themePrimary,flag:f.DocumentSetsModernView,alignment:a.e.Left,isCoachmark:!0,isDismissable:!0,name:"DOCSET_PROPERTIES_PANE"},N=new i.e(100,u.e/2+4),C={campaignGuid:"C847EA02-D118-4C3E-A73E-8B2C5D9944DA",bodyCopy:s.R,flag:f.On,colorVariation:o.e.themePrimary,alignment:a.e.Right,offset:N},k=new i.e(u.e/2+4,0),L={campaignGuid:"523F0995-B7E2-4612-BEA5-A7EF9F949C64",title:s._,bodyCopy:s.M,flag:f.EnableEnhancedMobileUpsell,alignment:a.e.Left,offset:k},A={campaignGuid:"FE1795D2-BC90-4CB0-9E1E-043738D734C8",teachingBubbleContentAs:function(e){var t=Object(v.t)(),n=t.consume(d.e),i=t.consume(p.e),s=e.defaultRender,o=e.onDismiss,u=Object(r.__rest)(e,["defaultRender","onDismiss"]),a=Object(c.e)(function(e){i.isPending=!0;var r=new(t.injected(n.ShowPropertiesAction))({useToggleBehavior:!1});r.execute(e);r.dispose();o(e)}),f=Object(c.e)(function(e){i.isPending=!0;o(e)});if(o)return s?h.createElement(s,Object(r.__assign)({},u,{headline:m.t,hasCondensedHeadline:!1,onDismiss:o,primaryButtonProps:{text:m.n,onClick:a},secondaryButtonProps:{text:m.r,onClick:f}}),m.e):void 0},isDismissable:!0,flag:f.MentionTeachingUIAA,experimentData:Object(f.isFeatureEnabled)(f.MentionTeachingUI)?void 0:{name:"AtMentionTeachingUIExperiment",startDate:"8/24/2021"},aaToABExperimentFlight:f.MentionTeachingUIAB,directionalHint:y.e.bottomAutoEdge,persistentBeak:!0},O={campaignGuid:"A4776EC9-2059-4971-AB9C-4003C3C7B3D8",title:s.v,bodyCopy:s.d,colorVariation:o.e.themePrimary,flag:f.On,alignment:a.e.Left,maxUserViewCount:1,isPremiumFeature:!0},M={campaignGuid:"A41001BA-6205-4730-A670-C89DD0D8451F",killSwitchGuid:"0EC0ED2B-06D2-4375-91E6-3CFF7E48B37D",experimentData:{name:"flowRequestSignOffCoachmarkExperiment2",startDate:"01/22/2019"},flag:f.FlowSignOffCoachmark,maxUserViewCount:1,title:s.x,isCoachmark:!0,isDismissable:!0,bodyCopy:s.S,automateExperimentBodyCopy:s.u,name:"FLOW_REQUEST_SIGNOFF"},_={campaignGuid:"87802041-45CB-4304-BFD1-E2E98E3CB31B",killSwitchGuid:"98802041-45CB-4304-BFD1-E2E98E3CB31C",compatibleCampaign:M,experimentData:{name:Object(f.isFeatureEnabled)(f.UseLegacyCoachmarkExperiment)?"flowRemindMeCoachmarkExperiment":"".concat("flowRemindMeCoachmarkExperiment").concat(2),startDate:Object(f.isFeatureEnabled)(f.UseLegacyCoachmarkExperiment)?"10/17/2018":"01/22/2019"},flag:f.FlowRemindMeCoachmark,maxUserViewCount:1,title:s.E,isCoachmark:!0,isDismissable:!0,bodyCopy:s.w,automateExperimentBodyCopy:s.o,name:"FLOW_REMIND_ME"},D={campaignGuid:"FD86A6D7-F3D9-47EC-994C-D01AAB624F28",killSwitchGuid:"B35D963C-9FFD-4154-9A9B-E112B67E5BCA",experimentData:{name:Object(f.isFeatureEnabled)(f.UseLegacyCoachmarkExperiment)?"flowOdbCommandBarCoachmarkExperiment":"".concat("flowOdbCommandBarCoachmarkExperiment").concat(2),startDate:Object(f.isFeatureEnabled)(f.UseLegacyCoachmarkExperiment)?"10/17/2018":"01/22/2019"},flag:f.FlowOdbCommandBarCoachmark,maxUserViewCount:1,title:s.b,isCoachmark:!0,isDismissable:!0,bodyCopy:s.y,automateExperimentBodyCopy:s.s,name:"FLOW_ODB_COMMAND_BAR_COACHMARK"},P=new i.e(0,-40),H={campaignGuid:"696ee2ba-076d-400c-ae9a-0b28e71f567b",title:s.W,bodyCopy:s.z,colorVariation:o.e.themePrimary,flag:f.On,alignment:a.e.Left,offset:P},B={campaignGuid:"108dfc30-090d-4ab7-8575-372a28d7ee3a",title:s.O,bodyCopy:s.A,colorVariation:o.e.themePrimary,flag:f.ODBLeftNavPins,alignment:a.e.Left},j={campaignGuid:"976ef592-f66a-4d08-b837-ba3f9cda70fb",title:s.L,bodyCopy:s.k,colorVariation:o.e.themePrimary,flag:f.On,alignment:a.e.Left},F={campaignGuid:"94a29c48-ae93-44cc-94fa-bb106da7bb2d",flag:f.On,title:s.i,isCoachmark:!0,illustrationImage:{src:"".concat(window.require.toUrl("odsp-media/images/addtoonedrive/add2od_1x.gif")),alt:s.i,height:200},coachMarkStyles:function(e){var t=e.isCollapsed;return{entityHost:t&&{backgroundColor:"#0078D4"},childrenContainer:{selectors:{".ms-TeachingBubble-subText":{color:"#FFFFFF"},".ms-TeachingBubble-headline":{color:"#FFFFFF"},".ms-TeachingBubble-closebutton":{color:"#FFFFFF",selectors:{":hover":{color:"#FFFFFF"}}}}},rotateAnimationLayer:{selectors:{svg:{fill:t?"#0078D4":"#7BDCEE"}}}}},teachingBubbleStyles:{closeButton:{color:"#0078D4"}},isDismissable:!0,persistentBeak:!0,maxUserViewCount:2,disableCondensedHeadline:!0,bodyCopy:s.r,name:"ADD_TO_ONEDRIVE_COMMAND"},I=Object(r.__assign)(Object(r.__assign)({},F),{campaignGuid:"dcd7409f-bd4d-4b95-aeb4-f1156656b0ab",name:"ADD_TO_ONEDRIVE_COMMAND_CFT"}),q={campaignGuid:"ac1f12bf-bc9e-41f9-84e9-49351392a052",title:s.q,bodyCopy:s.I,flag:f.EnableEditControlTeachingBubble,directionalHint:y.e.bottomAutoEdge,colorVariation:o.e.themePrimary,alignment:a.e.Right,offset:N,isCoachmark:!0,persistentBeak:!0,isDismissable:!0},R={campaignGuid:"3aead293-1016-42fe-9e98-182280ae809c",flag:f.EnableEditPdfTeachingBubble,colorVariation:o.e.themePrimary,directionalHint:y.e.bottomAutoEdge,isCoachmark:!1,persistentBeak:!0,isDismissable:!0,teachingBubbleContentAs:function(e){var t=e.defaultRender,n=e.onDismiss,i=Object(r.__rest)(e,["defaultRender","onDismiss"]),s=Object(c.e)(function(e){n(e)});return t?h.createElement(t,Object(r.__assign)({},i,{headline:g.t,primaryButtonProps:{text:g.n,onClick:s},onDismiss:n}),g.e):void 0},name:"PDF_EDIT"},U={campaignGuid:"8c5ffbba-577b-4a30-86bf-d93c02942877",flag:f.On,isCoachmark:!0,isDismissable:!0,persistentBeak:!0,title:s.m,bodyCopy:s.g,name:"LAUNCH_BUSINESS_APPS_SETUP_WIZARD_COMMAND",defaultFact:{d:!1,v:0}},z={campaignGuid:"b8ceb79a-73e5-4e1d-8df8-27dedb514597",flag:f.On},W={campaignGuid:"dcdd7a79-f0a6-4b88-94e2-a76178bd5eee",flag:f.On},X={campaignGuid:"c75fc458-8c94-4e75-91c9-6be5e94cf2e4",flag:f.On},V={campaignGuid:"6f376cef-52b4-4abc-b6e9-aca8686e5220",flag:f.On},$={campaignGuid:"b23b2ba7-87e7-44f1-a635-bf05c7fcde4e",flag:f.On,title:s.n,bodyCopy:s.e,primaryButtonText:s.t,isDismissable:!0,maxUserViewCount:5,name:"ADD_SMART_TEMPLATE"},J={campaignGuid:"c8896a46-5b51-474d-8b52-f7a9629c1751",flag:f.On,title:s.C,bodyCopy:s.T,primaryButtonText:s.N,isDismissable:!0,maxUserViewCount:5,name:"GENERATE_CAAE_DOCUMENT"},K={campaignGuid:"f3d86546-dd2d-47aa-a3e8-9f1ce1afda52",flag:f.On,title:s.H,bodyCopy:s.D,primaryButtonText:s.P,isDismissable:!0,maxUserViewCount:5,name:"MODERN_TEMPLATE_VIEW_INFO"},Q={campaignGuid:"447eb215-1e48-45cd-8644-8c83c604d4c1",bodyCopy:s.Z,colorVariation:o.e.themePrimary,flag:f.ERBugFixesEnabledForUniversalAnnotation,directionalHint:y.e.bottomRightEdge,isCoachmark:!1,persistentBeak:!0,isDismissable:!0,maxUserViewCount:5,name:"USE_UNIVERSAL_ANNOTATION"},G={campaignGuid:Object(f.isFeatureEnabled)(f.EnableStableFREforTMR)?"5ee0205b-23b6-4867-a5ce-7fff50bb50b2":"bbc4c8cc-da34-424a-92ab-43ae518c1c7b",title:s.Y,bodyCopy:s.G,colorVariation:o.e.themePrimary,flag:f.EnableExpirationSectionForTMR,directionalHint:y.e.bottomRightEdge,isCoachmark:!1,persistentBeak:!0,isDismissable:!0,maxUserViewCount:Object(f.isFeatureEnabled)(f.EnableStableFREforTMR)?1e3:1,name:"TMR_EXPIRATION_DATE_EDIT"},Y={campaignGuid:"65fe39bb-0669-4b21-a67d-a30c4ce3b959",flag:f.On,directionalHint:y.e.rightCenter,isCoachmark:!1,isDismissable:!0,persistentBeak:!0,maxUserViewCount:2,teachingBubbleContentAs:w,name:"PHOTO_STORY"},Z={campaignGuid:"59b0a6bb-d54c-48cc-a13e-8df743f6ffa3",killSwitchGuid:"8e80b4eb-f274-48fa-befa-3fca46573a91",title:s.Q,bodyCopy:s.K,primaryButtonText:s.J,secondaryButtonText:s.B,colorVariation:o.e.themePrimary,experimentId:l.e,flag:f.ShareToTeams,alignment:a.e.Left,isCoachmark:!0,isDismissable:!0,name:"SHARE_TO_TEAMS"},ee={campaignGuid:"4c0cab92-8ab5-426e-ad64-860c49ec2a8a",title:s.f,bodyCopy:s.a,colorVariation:o.e.themePrimary,flag:f.On,alignment:a.e.Left,isCoachmark:!0,directionalHint:y.e.rightBottomEdge,isDismissable:!0,persistentBeak:!0},te={campaignGuid:"21432b3b-ab4f-4a12-a4fa-f25b4de9cfef",flag:f.On,isCoachmark:!0,isDismissable:!0,persistentBeak:!0,title:s.$,bodyCopy:s.X,primaryButtonText:s.V,maxUserViewCount:5,name:"SETUP_DOCUMENT_ANALYSIS_FLOW_COMMAND",defaultFact:{d:!1,v:0}}},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(3).t)("MoveCopyCapabilities")},function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(0),i=n(3),s=n(69),o=new i.t({name:"HiddenDomProvider.key",loader:new s.t(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([121],661)];case 1:return[2,e.sent().resourceKey]}})})})})},function(e,t,n){"use strict";var r=function(e){this.items=new Array(e||0);this.groupings=null;this.partialResultRequestCount=0;this.partialResultStatus=0},i=n(18),s=n(155),o=function(e,t,n){this.key=e||"";this.content=i.observable(new r(n));this.content.equalityComparer=s.t;this.schema=i.observableArray([]);this.schema.equalityComparer=s.e;this.context=i.utils.extend({},t);this.contentTypes=i.observableArray([]);this.isPlaceholder=!0;this.version=0};t.e=o},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(3).t)("urlLite")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=(function(){function e(e){this._value=e;this._observers=new Set}e.prototype.get=function(){return this._value};e.prototype.set=function(e){this._value=e;this._observers.forEach(function(e){e()})};e.prototype.subscribe=function(e){var t=this;this._observers.add(e);return function(){t._observers.delete(e)}};return e})()},,,,,function(e,t,n){"use strict";n.d(t,"n",function(){return s});var r=n(126);n.d(t,"e",function(){return r.n});var i=n(3);n.d(t,"t",function(){return r.r});var s=new i.t({name:"".concat("Engagement",".engagementSource"),factory:new i.e(r.e)})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r;function i(){"boolean"!=typeof r&&(r="srcdoc"in document.createElement("iframe"));return r}},,function(e,t,n){"use strict";n.d(t,"t",function(){return o});n.d(t,"e",function(){return u});var r;(function(){function e(){}e.DefaultLocale="en-US";e.TeamsListClientName="Teams.List";e.TeamsPagesClientName="Teams.Page";e.TeamsFileClientName="Teams.File";e.PageContextKey="_spPageContextInfo"})(),n(227);(function(e){e[e.None=0]="None";e[e.List=1]="List";e[e.Page=2]="Page";e[e.Portal=3]="Portal";e[e.File=4]="File"})(r||(r={}));var i=function(){},s=r.None;new i;var o=function(){return s===r.List};var u=function(){return s===r.File};r.None},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){var t;t={};for(var n=[],r=0,i=e;r<i.length;r++){var s=i[r],o="".concat(s);if(!t[o]){t[o]=!0;n.push(s)}}return n}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r={ODB:window._spModuleLink&&-1!==["ODBLightSpeedWebPack","ODBOneDrive"].indexOf(window._spModuleLink.manifestName)}},,function(e,t,n){"use strict";var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.trackPromise=function(e){var t=!1,n=this.attach({dispose:function(){!t&&e.cancel&&e.cancel()}}),r=function(){t=!0;n.dispose()};e.done(r,r);return e};t.prototype.trackSignal=function(e){this.attach({dispose:function(){e.cancel()}});return e};return t})(n(145).e);t.e=i},,function(e,t,n){"use strict";n.d(t,"e",function(){return p});n.d(t,"t",function(){return v});var r=n(153),i=n(49),s=n(21),o=n(135),u=n(216),a=n(260),f=n(215),l=n(4),c={resultCode:"Proxy Timeout",message:"The SkyApiXmlProxy content failed to load within 15 seconds."},h={resultCode:"IFrame load failure",message:"The SkyApiXmlProxy content failed to execute correctly."},p=window.FilesConfig&&window.FilesConfig.skyApiDomain,d=Object(l.qo)(l.G),v=(function(){function e(){this._requests=[]}e.prototype.canHandleRequest=function(e){return e.indexOf(p)>-1};e.prototype.handleRequest=function(e,t){var n=this,i=new r.e(function(){n._removeSignal(i);t()});if(this._proxyFailure||d)this._bypassProxy(i,e);else{this._requests.push({signal:i,options:e});e.useDefaultHeaders=!0;var s=Object(u.t)(e,function(e){n._removeSignal(i);i.complete(e)});this._initialize();this._xmlProxy.createRequest(s)}return i.getPromise()};e.prototype.getHandlerContentWindow=function(){return this._iframe&&g(this._iframe)?this._iframe.contentWindow:null};e.prototype._initialize=function(){var e=this;this._xmlProxy||(this._xmlProxy=new a.e({source:m(!1),onAttach:this._attachToIframe.bind(this),onReady:function(){window.clearTimeout(e._timeout);e._qos&&e._qos.end({resultType:s.t.Success});e._requests=[]}}))};e.prototype._bypassProxy=function(e,t){this._basicRequestor||(this._basicRequestor=new f.e);var n;t.disableLogging||(n=new o.e({url:t.url,name:t.qosName||"DataRequest.NoSkyProxy."+t.apiName}));t.withCredentials=!0;t.useDefaultHeaders=!0;this._basicRequestor.handleRequest(t,function(){n&&n.end({resultType:s.t.ExpectedFailure});e.cancel()}).then(function(t){e.complete(t);n&&n.end({resultType:s.t.Success})},function(t){e.error(t);n&&n.end({resultType:s.t.Failure})})};e.prototype._attachToIframe=function(e){var t=this;this._iframe=e;var n=this._hasReloaded?"SkyApiXmlProxyRetry":"SkyApiXmlProxy";this._qos=new s.e({name:n});this._timeout=window.setTimeout(function(){t._proxyFailed(c)},15e3);e.onload=function(){if(!g(e)){window.clearTimeout(t._timeout);if(t._hasReloaded)t._proxyFailed(h);else{t._handleError(h);t._reloadIframe(m(!0))}}}};e.prototype._removeSignal=function(e){this._requests=this._requests.filter(function(t){return e!==t.signal})};e.prototype._reloadIframe=function(e){this._hasReloaded=!0;window.clearTimeout(this._timeout);this._timeout=void 0;this._xmlProxy.reloadIframe(e)};e.prototype._handleError=function(e){this._qos.end({error:e.message,resultCode:e.resultCode,resultType:s.t.Failure});this._qos=void 0;i.e.logError(e.message)};e.prototype._proxyFailed=function(e){this._handleError(e);this._proxyFailure={isProxyFailure:!0,message:e.message};for(var t=0,n=this._requests;t<n.length;t++){var r=n[t];this._bypassProxy(r.signal,r.options)}this._requests=[]};return e})();function m(e){var t=e?"cache=".concat((function(e){try{return String.fromCharCode.apply(null,(window.crypto||window.msCrypto).getRandomValues(new Uint8Array(e)).map(function(e){return e%26+"A".charCodeAt(0)}))}catch(e){return""}})(6),"&"):"";return"".concat(p,"/xmlproxy.htm?").concat(t,"domain=").concat(document.domain)}function g(e){try{for(var t=e.contentDocument.getElementsByTagName("script"),n=0;n<t.length;n++){var r=t[n];if(r&&r.src&&r.src.indexOf("xmlproxy.js")>=0)return!0}}catch(e){return!1}return!1}},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return y});n.d(t,"t",function(){return b});var r=n(187),i=n(4),s=n(3),o=n(50),u=n(188),a=n(204),f={pageContext:a.e},l=new s.t({name:"spartanSharedWithMeExperiment",factory:{dependencies:f,create:function(e){return{instance:Object(r.t)(90050,e.pageContext)}}}}),c=n(295),h=n(252),p={pageContext:a.e};var d=new s.t({name:"isSpartanSharedWithMeSupported",factory:{dependencies:p,create:function(e){return{instance:function(){return t=e.pageContext,n=t&&(t.isExternalGuestUser||t.isAnonymousGuestUser),!(!t||n||Object(c.t)(t.env2)||Object(c.e)(t.env2)||Object(h.e)()||!t.isMySiteOwner);var t,n}}}}}),v={pageContext:a.e},m={isSpartanSharedWithMeSupported:d,spartanSharedWithMeExperiment:l,newSpartanSharedWithMeExperiment:new s.t({name:"newSpartanSharedWithMeExperiment",factory:{dependencies:v,create:function(e){return{instance:Object(r.t)(90168,e.pageContext)}}}})},g=function(e){var t=e.isSpartanSharedWithMeSupported,n=e.spartanSharedWithMeExperiment,r=e.newSpartanSharedWithMeExperiment,i=t()&&(Object(u.e)(o.p)||!!n.variantToDisplay||!!r.variantToDisplay);g=function(){return i};return i};new s.t({name:"isSpartanSharedWithMeEnabled",factory:{dependencies:m,create:function(e){return{instance:function(){return g(e)}}}}});var y=90022,b=function(e,t){var n=window._spPageContextInfo;return n&&!(!Object(i.qo)(t)||!Object(r.n)(e,n))}},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return Q});var r=n(396),i=n(461),s=n(129),o=n(3),u=n(514),a=n(17),f=n(5),l=n(6),c=n(219),h=new c.e("storeKeyToNavigationUrl",{url:c.t}),p=new o.t("storeKeyToUrlControlHandler"),d=n(207),v=new o.t("IItemsScopeKeyConverter"),m=new c.e("itemKeyToStoreKey",{storeKey:c.t}),g=n(481),y=new o.t("ItemsScopeAddon"),b=new o.t("IItemCacheConfiguration"),w=n(0),E=n(261),S=n(69),x=new o.t({name:"ItemProvider.key",loader:new S.t(function(){return n.ee(0,51).then(function(e){return e.resourceKey})})}),T=new o.t({name:"KnockoutStoreItemControlHandler",factory:{dependencies:{resources:o.s},create:function(e){var t=e.resources;return{instance:Object(E.t)(function(){return Object(w.__awaiter)(void 0,void 0,void 0,function(){var e,n;return Object(w.__generator)(this,function(r){switch(r.label){case 0:return[4,t.consumeAsync(x)];case 1:e=r.sent();n=function(){return{getItem:function(t){return e.getItemSync({parentKey:t,ignoreChildren:!0}).item}}};return[2,Object(E.e)()(function(){return function(){return n}})]}})})})}}}}),N=(new o.t({name:"KnockoutStoreItemControlHandler",factory:{dependencies:{itemProvider:x},create:function(e){var t=e.itemProvider;function n(e,n){return{getItem:function(e){return t.getItemSync({parentKey:e,ignoreChildren:!0}).item}}}return{instance:Object(E.e)()(function(){return function(){return n}})}}}}),new c.e("knockoutStoreItem",{getItem:c.t})),C=n(554),k=n(259),L=n(724),A=(n(1),n(80)),O=n(264),M=n(56),_=n(541),D=n(512),P=n(101),H=n(327),B=n(718),j=n(4),F=n(720),I=n(119),q=n(67),R=n(542),U=n(187),z=window._spPageContextInfo,W=n(16).e.isActivated("69cccbd8-2920-4c21-ac9a-62ff791a6c06","11/16/2022","set debounce render to be false"),X={resources:o.s},V=new o.t({name:"".concat("ItemCacheConfiguration",".webConfiguration"),factory:{dependencies:{},create:function(){return{instance:Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)({},D.e.pack(new B.e)),O.t.pack(Object(_.e)())),{}),M.o.pack({enablePageLoadBarrier:!0}))}}}}),$=(new o.t({name:"ItemCacheConfiguration",factory:{dependencies:X,create:function(e){var t=e.resources;return{instance:Object(s.e)(function(){return function(e){var n,r=new F.e,i=t.consume(q.e),s=Object(j.Jo)("ExternalService_isitemscopefilecardenabled");r.resolveItems({items:(n={},n[I.e]=Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)({},M.s.pack({reportRUMOnePerfData:!1,logRenderEndTime:function(e,n){var r=t.consume(H.e.optional);r&&r.logRUMOneForItemsScopeListView(e,n)}})),M.o.pack({enablePageLoadBarrier:!0})),P.v.pack({language:A.e.language,cultureLCID:A.e.cultureLCID})),P.h.pack(!0)),P.a.pack(!0)),P.d.pack(!0)),P.l.pack(!!W)),P.i.pack(!0)),P.p.pack(Object(j.qo)(j.Rt))),P.c.pack(!0)),P.f.pack(!0)),P.u.pack(s&&!i.isMobile)),P.s.pack(Object(j.qo)(j.Se))),P.o.pack(Object(j.qo)(j.xe))),P.r.pack(!0)),R.e.pack({showInPLT:Object(j.qo)(j.oe)||1===Object(U.n)(90158,z)})),P.n.pack(.1)),n)});e(r.execute())}})}}}}),new o.t({name:"".concat("ItemCacheStoreBase",".oneItemCacheInstance"),factory:{dependencies:{},create:function(){return{instance:{created:!1}}}}})),J=new o.t({name:"".concat("ItemCacheStoreBase",".storeBase"),factory:{dependencies:{webConfiguration:V,oneItemCacheInstance:$},create:function(e){var t=e.webConfiguration,n=e.oneItemCacheInstance;if(n.created)throw new Error("Attempted to create a second instance of the ItemCacheStore.");n.created=!0;var r=Object(L.e)({configuration:t});return{instance:r,disposable:r}}}}),K={urlRoutingAddon:new o.t({name:"".concat("ItemCacheStore",".urlRoutingAddon"),factory:{dependencies:{itemsScopeKeyConverter:v,storeKeyToUrlControlHandler:p},create:function(e){var t=e.itemsScopeKeyConverter,n=e.storeKeyToUrlControlHandler;return{instance:Object(s.e)(function(){return function(e){e(Object(u.e)(d.t,m)(t.itemKeyToStoreKeyControlHandler));e(Object(u.e)(d.t,g.e)(t.viewParamsToItemKeyControlHandler));e(Object(u.e)(d.t,h)(n));e(C.e)}})}}}}),itemsScopeAddon:y,itemCacheConfiguration:b,itemCacheStoreBase:J,knockoutStoreItemAddon:new o.t({name:"".concat("ItemCacheStore",".knockoutStoreItemAddon"),factory:{dependencies:{knockoutStoreItemControlHandler:T},create:function(e){var t=e.knockoutStoreItemControlHandler;return{instance:Object(s.e)(function(){return function(e){e(Object(u.e)(d.t,N)(t))}})}}}}),pageLoadAddon:new o.t({name:"".concat("ItemCacheStore",".pageLoadAddon"),factory:{dependencies:{pageLoadMonitor:i.e,resources:o.s},create:function(e){var t=e.resources,n=e.pageLoadMonitor;return{instance:Object(s.e)(function(){return function(e){e(Object(r.r)({waitIndefinitely:!0})).then(function(){var i=(function(e){var t=e.consume(l.B);return"".concat(a.e[t.getPageType()]||"Default","-").concat(f.e[t.getQueryType()]||"Default")})(t);n.pageLoaded({name:i,error:e(Object(k.e)(function(e){return Object(r.e)(e)}))})})}})}}}})},Q=new o.t({name:"ItemCacheStore",factory:{dependencies:K,create:function(e){var t=e.pageLoadAddon,n=e.urlRoutingAddon,r=e.itemsScopeAddon,i=e.itemCacheConfiguration,s=e.itemCacheStoreBase,o=e.knockoutStoreItemAddon;s.dispatch(i);s.dispatch(n);s.dispatch(o);s.dispatch(r);s.dispatch(t);return{instance:s}}}})},function(e,t,n){"use strict";n.d(t,"e",function(){return d});var r=n(0),i=n(7),s=n(81),o=n(146),u=n(30),a=n(41),f=n(370),l=n(61),c=n(13),h=(n(116),n(69)),p=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._dialogProvider=n.dialogProvider;r._promiseTracker=n.promiseTracker;r._itemSetSelectionModel=n.itemSetSelectionModel;return r}t.prototype.resolveSelection=function(){var e,t,n=this.createObservable(f.e),r=this.createObservable(!0),i=this.createObservable(!1),s=this._shouldShowDialog();if(this._itemSetSelectionModel){t=this._itemSetSelectionModel.resolveSelection().then(function(t){s=!1;e&&e.state(2);return t},function(t){if(e){n(f.t);r(!1);i(!0)}return u.n.wrapError(t)});s&&(e=this._createDialog(n,r,i)).wait().done(void 0,function(){t.cancel()});this._promiseTracker&&this._promiseTracker.registerPromise(t)}else t=u.n.wrap([]);return t};t.prototype._createDialog=function(e,t,n){return this._dialogProvider.requestDialog({title:f.n,isDismissable:!1,component:{name:o.e.tagName,params:{text:e}},actions:[{name:a.cancelActionText,execute:function(){return u.n.wrap(3)},isVisible:t,icon:new l.e("Cancel"),isDefault:!0},{name:a.ok,execute:function(){return u.n.wrap(3)},isVisible:n,icon:new l.e("Cancel"),isDefault:!0}]})};t.prototype._shouldShowDialog=function(){for(var e=0,t=this._itemSetSelectionModel.selection.peek();e<t.length;e++){var n=t[e];if(!this.peekUnwrapObservable(n))return!0}return!1};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{dialogProvider:s.e,promiseTracker:c.y.optional,itemSetSelectionModel:c.g});return t})(i.n);var d=Object(h.s)("SelectionHelper",p)},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"t",function(){return u});n.d(t,"n",function(){return o});var r,i,s;(function(e){e[e.spam=0]="spam";e[e.nudityOrPornography=1]="nudityOrPornography";e[e.harassmentOrThreatening=2]="harassmentOrThreatening";e[e.childEndangermentOrExploitation=3]="childEndangermentOrExploitation";e[e.other=4]="other";e[e.copyrightInfringement=5]="copyrightInfringement"})(i||(i={}));(function(e){e[e.malwareOrViruses=0]="malwareOrViruses";e[e.sexuallyInappropriate=1]="sexuallyInappropriate";e[e.harassmentOrThreatening=2]="harassmentOrThreatening";e[e.childSexualExploitation=3]="childSexualExploitation";e[e.other=4]="other";e[e.terroristContent=5]="terroristContent";e[e.fraudOrSpam=6]="fraudOrSpam";e[e.hateSpeech=7]="hateSpeech";e[e.imminentHarm=8]="imminentHarm";e[e.copyrightInfringement=9]="copyrightInfringement"})(s||(s={}));var o,u={childSexualExploitation:"ChildEndangermentExploitation",copyrightInfringement:"ContentInfringement",sexuallyInappropriate:"OffensiveContent",terroristContent:"Terrorism",malwareOrViruses:"VirusSpywareMalware",other:"Other",fraudOrSpam:"Fraud",hateSpeech:"HateSpeech",imminentHarm:"ImminentHarmToPersonsOrProperty"};(function(e){e[e.File=0]="File";e[e.PhotoStreamComment=1]="PhotoStreamComment";e[e.PhotoStreamFile=2]="PhotoStreamFile"})(o||(o={}));(r={})[o.PhotoStreamComment]="Comment",r[o.PhotoStreamFile]="PhotoStreamFile";t.r=i},,,function(e,t,n){"use strict";var r=(function(){function e(e){this._tasksByKey={};this._onChanges=e}e.map=function(e,t){return{update:function(n,r){void 0===r&&(r=!1);e.update(n.map(function(e){return t(e)}),r)}}};e.prototype.dispose=function(){this._tasksByKey={};this._onChanges=null};e.prototype.getTasks=function(){var e=[];for(var t in this._tasksByKey)e.push(this._tasksByKey[t]);return e};e.prototype.getTask=function(e){return this._tasksByKey[e]};e.prototype.update=function(e,t){void 0===t&&(t=!1);var n,r,i;n={};for(var s in this._tasksByKey)n[s]=this._tasksByKey[s];i=[];for(var o=0,u=e;o<u.length;o++){var a=u[o],f=n[a.key],l=a.compare(f);l&&i.push(l);delete n[a.key];this._tasksByKey[a.key]=a}if(t)for(var s in n){r=n[s];delete this._tasksByKey[s];i.push({previous:r,current:null})}this.onChanges(i)};e.prototype.onChanges=function(e){this._onChanges&&this._onChanges(e)};return e})();t.e=r},function(e,t,n){"use strict";n.d(t,"t",function(){return d});n.d(t,"e",function(){return v});var r=n(0),i=n(7),s=n(30),o=n(48),u=n(40),a=n(23),f=n(269),l=n(20),c=n(333),h=1e3,p=n(198),d="__New",v="__Auto";(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._urlDataSource=n.resources.consume(o.n);return n}t.prototype.addToAlbum=function(e,n){var r={id:e.id,name:null,items:this._getIdsFromKeyArray(n),action:t.ADD_TO_ALBUM_ACTION};return this._handleRequest(n,r)};t.prototype.removeFromAlbum=function(e,n){var r={id:e.id,name:null,items:this._getIdsFromKeyArray(n),action:t.REMOVE_FROM_ALBUM_ACTION};return this._handleRequest(n,r)};t.prototype.createAlbum=function(e,n){var r=this,i=this._getIdsFromKeyArray(n),o=i.slice(0,20),a={id:null,name:e,items:o,action:t.CREATE_ALBUM_ACTION};return(new u.e).send({requestType:"POST",postData:JSON.stringify(a),apiName:"".concat(t.MODIFY_ALBUM_API_NAME,".").concat(a.action),url:this._getModifyAlbumUrl(),isErrorExpectedCallback:p.e}).then(function(e){if(!n||n&&n.length<20)return e;o=i.slice(20);var u={id:e.id,items:o,action:t.ADD_TO_ALBUM_ACTION,name:null};return r._handleRequest(o,u).then(function(t){return e},function(e){var t={errorType:c.e.other,error:new Error(e.data.message)};return s.n.wrapError(t)})},function(e){var t=c.e.other;e.data.code===h&&(t=c.e.conflict);var n={errorType:t,error:new Error(e.data.message)};return s.n.wrapError(n)})};t.prototype.getWalgreensLandingPageUrl=function(e){var t=this._urlDataSource.getPublishToWalgreensUrl();return(new u.e).sendPostUrlEncoded("PublishToWalgreens",t,JSON.stringify({ids:e}))};t.prototype.createAlbumFromFolder=function(e){var n=this._getModifyAlbumUrl(),r=new u.e,i={id:null,name:e.folder.name,items:[e.folder.id],action:t.CREATE_ALBUM_WITH_RENAME_ACTION};return r.send({apiName:"".concat(t.MODIFY_ALBUM_API_NAME,".").concat(i.action),url:n,requestType:"POST",postData:JSON.stringify(i),isErrorExpectedCallback:p.e})};t.prototype.getAlbumsParentKey=function(e){var n;void 0===e&&(e={});var r=((n={}).id=t.ALBUMS_ID,n.cid=this._urlDataSource.getOwnerId(),n.tagFilter=e.tagFilter,n);return l.n(r,void 0,!0)};t.prototype.setCoverPhoto=function(e,n){var r=this._getModifyAlbumUrl(),i=new u.e,o={id:e.id,items:[n.id],action:t.SET_COVER_PHOTO_ACTION,name:null};return i.send({apiName:"".concat(t.MODIFY_ALBUM_API_NAME,".").concat(o.action),url:r,requestType:"POST",postData:JSON.stringify(o),isErrorExpectedCallback:p.e}).then(null,function(e){var t=e&&e.data&&e.data.message||"";return s.n.wrapError(t)})};t.prototype._handleRequest=function(e,n){var r=this._getModifyAlbumUrl();return f.e.start({apiName:"".concat(t.MODIFY_ALBUM_API_NAME,".").concat(n.action),url:r,batchSize:20,items:e,isErrorExpectedCallback:p.e,getPostData:function(e){return{id:n.id,name:n.name,items:e,action:n.action}}})};t.prototype._getModifyAlbumUrl=function(){return a.e.skyApiBaseUrl+t.MODIFY_ALBUM_API_NAME};t.prototype._getIdsFromKeyArray=function(e){return e.map(function(e){return l.e(e).id})};t.ADD_TO_ALBUM_ACTION="Add";t.CREATE_ALBUM_ACTION="Create";t.CREATE_ALBUM_WITH_RENAME_ACTION="CreateWithRename";t.REMOVE_FROM_ALBUM_ACTION="Remove";t.SET_COVER_PHOTO_ACTION="SetCoverPhoto";t.MODIFY_ALBUM_API_NAME="ModifyAlbum";t.ALBUMS_ID="albums"})(i.n)},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=n(16).e.isActivated("358B2C0E-6B7B-4A1A-B7E1-48C4E8C075AD","4/7/2023","Enable the new IDEAs attribution")},,,,function(e,t,n){"use strict";n.r(t);n.d(t,"STORAGE_KEY_EXPIRATION",function(){return F});n.d(t,"resourceKey",function(){return z});var r=n(0),i=n(7),s=n(46),o=n(6),u=n(92),a=n(81),f=n(60),l=n(61),c=n(189),h=n(117),p=n(134),d=n(121),v=n(405),m=n(127),g=n(36),y=n(30),b=n(286),w=n(5),E=n(47),S=n(51),x=n(69),T=n(161),N=n(146),C=n(337),k=n(239),L=n(39),A=n(53),O=n(10),M=n(4),_=n(503),D=n(300),P=n(32),H=n(42),B=n(44),j=n(532),F="expirationtime",I=["ManageVault","Restore","RansomwareDetection"],q=!O.e.isActivated("CD980492-57E1-4F11-95BA-27FBECF1987D","01/25/2022","Enable item invalidate after vault actions in ODC lightspeed"),R=!O.e.isActivated("41127D76-546C-4B0D-A56E-271886E91F4A","02/18/2022","Enable quota invaludate in ODC lightspeed when needed"),U=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._clientName=n.clientName;r._identityDataSource=n.identityDataSource;r._vroomDataRequestor=n.vroomDataRequestor;r._itemStore=n.itemStore;r._navigation=n.navigation;r._urlDataSource=n.urlDataSource;r._itemProvider=n.itemProvider;r._dialogProvider=n.dialogProvider;r._userInfoProvider=n.userInfoProvider;r._itemParentHelper=n.itemParentHelper;r._bundleLoader=n.bundleLoader;r._isItemsScopeEnabled=n.isItemsScopeEnabled;r._vaultStore=n.vaultStore;r._storageKeyPrefix=r._vaultStore.storageKeyPrefix;r._dataStore=r._vaultStore.dataStore;r._isVaultOpen=r._vaultStore.isVaultOpen;r._vaultFreState=r._vaultStore.vaultFreState;r._vaultSuggestCardState=r.createObservable(0);r._vaultQuota=r._vaultStore.vaultQuota;r._quotaLoaded=r.createComputed(r._computeQuotaLoaded);r._isVaultDisabled=r._vaultStore.isVaultDisabled;r._isLocking=!1;r._isOneDriveWinApp=Object(A.e)();r.isOverQuota=r._vaultStore.isOverQuota;r._showVaultLockNotification=r._vaultStore.showVaultLockNotification;r._showVaultFreMessage=r._vaultStore.showVaultFreMessage;r.createComputed(r._calculateFreMessage);r.events.on(window,"storage",r._onStorageChange);r.createBackgroundComputed(r._updateVaultQuota);r.fetchIsVaultDisabled();r._isVaultOpen.peek()&&(r._getExpiration()<Date.now()?r.lockVault(void 0,!0):r._handleVaultUnlock());return r}t.prototype.vaultLockMessageSubscribe=function(e){this.scope.attach(e.register(this._showVaultLockNotification))};t.prototype.vaultStateSubscribe=function(e){this.scope.attach(e.register(this._isVaultOpen))};t.prototype.vaultFreSubscribe=function(e){this.scope.attach(e.register(this._vaultFreState))};t.prototype.vaultQuotaSubscribe=function(e){this.scope.attach(e.register(this._vaultQuota))};t.prototype.vaultMenuCalloutSubscribe=function(e){this.scope.attach(e.register(this._showVaultFreMessage))};t.prototype.vaultDisabledSubscribe=function(e){this.scope.attach(e.register(this._isVaultDisabled))};t.prototype.getVaultItem=function(){return this._vaultItem};t.prototype.isVaultOpen=function(){return this._isVaultOpen};t.prototype.isVaultDisabled=function(){return this._isVaultDisabled};t.prototype.freState=function(){return this._vaultFreState};t.prototype.suggestCardState=function(){return this._vaultSuggestCardState};t.prototype.getShowVaultFreMessage=function(){return this._showVaultFreMessage()};t.prototype.setShowVaultFreMessage=function(e,t){void 0===t&&(t=!1);t||this._showVaultFreMessage(e);this._setVaultIconFre(e)};t.prototype.unlockVault=function(e,t){var n=this;return this.getVault(!1,!0).then(function(i){if(!i||!i.vault||i.vault.isLocked||e){var s;s=e?n._identityDataSource.getSessionToken(!0):n._isOneDriveWinApp?y.n.resolve({wlidToken:t}):y.n.resolve({accessToken:t});var o={};n._isOneDriveWinApp&&(o.Prefer="Include-Feature=Vault");Object(M.qo)(M.s)&&(o=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},o),{Scenario:D.e.OpenVault,ScenarioType:D.t.ActiveUserOperation}),n._clientName?{Application:n._clientName}:{}));return s.then(function(t){return n._vroomDataRequestor.send(Object(r.__assign)({apiName:"action.unlockVault",path:"/drive/special/vault/action.unlockVault",headers:o,requestType:"POST",postData:JSON.stringify({}),accessToken:t,postProcessQos:n._postProcessUnlockQos.bind(n),useAuthorizationHeaders:!0,qosExtraData:{isExtend:!!e}},Object(M.qo)(M.Ms)&&Object(H.e)(B.u)?n.getUnlockVaultV2RequestData():{})).then(function(){n.setVaultLockState({root:void 0,isLocked:!1,expirationInSeconds:1200});if(!e){var t=n._urlDataSource.getRootItemKey();n._invalidateItems(t)}return y.n.resolve({})}).catch(function(e){n._handleVaultLock();return y.n.reject(e)})})}n.setVaultLockState(i.vault,!!t)})};t.prototype.setVaultLockState=function(e,t,n){void 0===t&&(t=!1);if(!this._isLocking){var r=this._isVaultOpen.peek(),i=e.isLocked;if(i||r)i&&r&&this._handleVaultLock(!1,n);else{var o=e.expirationInSeconds||1200,u=Date.now()+1e3*o;this._dataStore.setValue(F,u,s.e.local);this._handleVaultUnlock(t)}}};t.prototype.lockVault=function(e,t){var n=this;this._isLocking=!0;this._navToRootIfInVault();if(e){var i=this._urlDataSource.getPageType(this._navigation.viewParams),s=this._urlDataSource.getQueryType(this._navigation.viewParams);u.e.logData({name:"Vault.Autolocked",extraData:{location:Object(b.r)(i,s)}})}var o=this._vaultItem?y.n.resolve(this._vaultItem):this.getVault(),a={};this._isOneDriveWinApp&&(a.Prefer="Include-Feature=Vault");Object(M.qo)(M.s)&&(a=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},a),{Scenario:D.e.CloseVault,ScenarioType:D.t.ActiveUserOperation}),this._clientName?{Application:this._clientName}:{}));return o.then(function(i){return n._vroomDataRequestor.send(Object(r.__assign)({apiName:"action.lockVault",path:"/drive/special/vault/action.lockVault",headers:a,requestType:"POST",postData:JSON.stringify({}),postProcessQos:n._postProcessQos.bind(n),qosExtraData:{isAutoLock:!!e}},Object(M.qo)(M.Ms)&&Object(H.e)(B.u)?n.getLockVaultV2RequestData():{})).then(function(){n._isLocking=!1;n._handleVaultLock(t)}).catch(function(e){n._isLocking=!1;403===e.status?n._handleVaultLock(t):n._showLockFailed();return n._isExpectedError(e)?y.n.resolve():y.n.reject(e)})})};t.prototype.dismissLockNotification=function(){this._showVaultLockNotification(!1)};t.prototype.extendLock=function(){return this.unlockVault(!0)};t.prototype.getVault=function(e,t,n,r){var i=this,s={};e&&(s.Prefer="auto-create-special-folder");this._isOneDriveWinApp&&(s.Prefer=s.Prefer+",Include-Feature=Vault");n=n||"GET";return(Object(M.qo)(M.Ms)&&Object(H.e)(B.u)?this.getVaultV2(e,r):this._vroomDataRequestor.send({apiName:r?"EnableVault":e?"CreateVault":"GetVault",path:"/drive/special/vault",headers:s,requestType:n,breakCache:!0,qosExtraData:{requestType:n},postProcessQos:this._postProcessQos.bind(this)})).then(function(e){var t,n;if(e){(null===(n=null===(t=null==e?void 0:e.createdBy)||void 0===t?void 0:t.user)||void 0===n?void 0:n.id)&&(e.createdBy.user.id=e.createdBy.user.id.toUpperCase());i._vaultItem=e}return e}).catch(function(e){return t?null:y.n.reject(e)})};t.prototype.getQuota=function(){var e=this,t={};this._isOneDriveWinApp&&(t.Prefer="Include-Feature=Vault");return this._vroomDataRequestor.send({apiName:"drive",path:"/drive?select=quota/vault",headers:t,requestType:"GET"}).then(function(t){var n=t&&t.quota&&t.quota.vault;e._vaultQuota(n);return n})};t.prototype.createVaultIfNotExist=function(){var e=this;return this._userInfoProvider.getUserFact(46).then(function(t){if(!t||e._vaultFreState.peek()===m.r.Created)return e.getVault(!0).then(function(t){e.setVaultState(m.r.Created);e._isVaultDisabled(!1);var n=e._urlDataSource.getRootItemKey();e._invalidateItems(n,{triggerFetch:!0});return t});var n=JSON.parse(t.param||"{}");e._vaultFreState(n.s);e._vaultSuggestCardState(n.c)})};t.prototype.fetchIsVaultDisabled=function(){var e=this;if(void 0!==this._isVaultDisabledPromise)return this._isVaultDisabledPromise;this._isVaultDisabledPromise=this._userInfoProvider.getUserFact(46).then(function(t){if(t)return e.getVault(!1,!1,"HEAD").then(function(){e._isVaultDisabled(!1);return!1}).catch(function(t){var n=404===t.status;e._isVaultDisabled(n);return n});e._isVaultDisabled(!0);return!0});return this._isVaultDisabledPromise};t.prototype.enableVault=function(){var e=this;return this.getVault(!0,!1,"GET",!0).then(function(t){var n=e._urlDataSource.getRootItemKey();e._invalidateItems(n,{triggerFetch:!0});e._isVaultDisabled(!1);return t})};t.prototype.disableVault=function(e){var t=this;if(Object(M.qo)(M.Ms)&&Object(H.e)(B.u))return e?this.disableVaultV2():y.n.resolve("confirmToken");var n={};e&&(n.If="(<".concat(e,">)"));this._isOneDriveWinApp&&(n.Prefer="Include-Feature=Vault");return this._vroomDataRequestor.send({apiName:"deleteVault",headers:n,path:"/drive/special/vault",requestType:"DELETE",postData:JSON.stringify({}),postProcessQos:this._postProcessQos.bind(this)}).then(function(){t._cleanLocalLockInfo();t._isVaultDisabled(!0)}).catch(function(e){var t=e.response;if(t&&t.error&&t.error.fixItUrl){var n=new L.t(t.error.fixItUrl).getQueryParameter("confirmationToken");if(n){0;return n}}return y.n.reject(e)})};t.prototype.setVaultState=function(e,t){var n=void 0;if(void 0!==e&&e>this._vaultFreState.peek()){this._vaultFreState(e);n=e}t&&this._vaultSuggestCardState(t);var r={s:n||this._vaultFreState.peek(),c:t||this._vaultSuggestCardState.peek()};return this._userInfoProvider.setUserInfo(46,3,JSON.stringify(r))};t.prototype.reset=function(){0;return y.n.resolve(!1)};t.prototype.toggleDebug=function(){0};t.prototype._onNavigationChange=function(){var e=this._getCurrentItem(),t=this._navigation.viewParams,n=this._isVaultOpen.peek();if(e){n&&(!e.vault&&I.indexOf(t&&t.v)<=-1?this._detatchIdleEvents():this._attachIdleEvents());if(e.vault&&e.vault.root){if(!this._vaultRootLoadEventFiled){u.e.logData({name:"Vault.Unlocked.Loaded"});this._vaultRootLoadEventFiled=!0}}else this._vaultRootLoadEventFiled=!1}};t.prototype._computeQuotaLoaded=function(){if(this._bundleLoader.getBundleInfo(2).isLoaded()){this._userStateProvider||(this._userStateProvider=this.resources.consume(E.l));return!0}return!1};t.prototype._updateVaultQuota=function(){var e=this._userStateProvider&&this._userStateProvider.quotaNeedsUpdate();if(this._quotaLoaded()&&e&&this._isVaultOpen()){this.getQuota();if(M.zo&&R){var t=this._getCurrentItem();this.resources.consumeAsync(o.v).then(function(e){e.invalidateQuota(null==t?void 0:t.key)})}}};t.prototype._isDebug=function(){0;return!1};t.prototype._getExpiration=function(){return this._isDebug()?Date.now()+12e4:this._dataStore.getValue(F,s.e.local)};t.prototype._startExpirationTimers=function(){var e=this;this._expirationWarningTimerId=this.async.setTimeout(function(){e._verifyLockExpiration()},this._getExpiration()-Date.now()-6e4);this._expirationLockTimerId=this.async.setTimeout(function(){0;e.lockVault(!0)},this._getExpiration()-Date.now())};t.prototype._stopExpirationTimers=function(){this.async.clearTimeout(this._expirationWarningTimerId);this.async.clearTimeout(this._expirationLockTimerId)};t.prototype._resetExpirationTimers=function(){0;this._stopExpirationTimers();this._startExpirationTimers()};t.prototype._attachIdleEvents=function(){if(!this._idleEventsAttached){"ontouchstart"in document.documentElement&&this.events.on(document,"touchstart",this._resetLastActivity,!0);this.events.on(document,"mousemove",this._resetLastActivity,!0);this.events.on(document,"keypress",this._resetLastActivity,!0);this._idleEventsAttached=!0;0}};t.prototype._detatchIdleEvents=function(){if(this._idleEventsAttached){"ontouchstart"in document.documentElement&&this.events.off(document,"touchstart",this._resetLastActivity,!0);this.events.off(document,"mousemove",this._resetLastActivity,!0);this.events.off(document,"keypress",this._resetLastActivity,!0);this._idleEventsAttached=!1;0}};t.prototype._resetLastActivity=function(){this._lastActivity=Date.now()};t.prototype._verifyLockExpiration=function(){var e=this;0;if(this._isDebug())this._showLockWarning();else if(Date.now()-this._lastActivity<9e5){0;this.extendLock().then(function(){e._resetExpirationTimers()})}else this.getVault().then(function(t){var n=t.vault&&t.vault.expirationInSeconds||0;if(1e3*n>12e4){0;var r=Date.now()+1e3*n;e._dataStore.setValue(F,r,s.e.local);e._resetExpirationTimers()}else e._showLockWarning()}).catch(function(t){0;return e.lockVault()})};t.prototype._showLockFailed=function(){var e=this,t=this._dialogProvider.requestDialog({title:k.s,component:{name:C.e.tagName,params:{html:'<span class="ms-fontColor-error">'.concat(k.r,"</span>")}},actions:[{name:k.i,execute:function(){return y.n.resolve(2)},isAvailable:this.observables.create(!0),icon:new l.e("CheckMark"),isDefault:!0}],isSoftDismissable:!1});t.wait().then(function(){if(2===t.state.peek()){e.async.clearTimeout(e._retryLockVault);e._retryLockVault=e.async.setTimeout(function(){e.lockVault()},500)}})};t.prototype._showLockWarning=function(){var e=this;this._warningDialog=this._dialogProvider.requestDialog({title:k.n,component:{name:N.e.tagName,params:{text:k.e}},actions:[{name:k.t,execute:function(){u.e.logData({name:"Vault.StillHere.Extend"});return e.extendLock().then(function(){e._resetExpirationTimers();return y.n.resolve(2)})},isAvailable:this.observables.create(!0),icon:new l.e("Cancel"),isDefault:!0}],isSoftDismissable:!1});u.e.logData({name:"Vault.StillHere.Shown"});this._warningDialog.wait().catch(function(){3===e._warningDialog.state.peek()&&u.e.logData({name:"Vault.StillHere.Dismiss"})})};t.prototype._handleVaultLock=function(e,t){this._cleanLocalLockInfo(t);this._showVaultLockNotification(!e)};t.prototype._cleanLocalLockInfo=function(e){var t=this;this._isVaultOpen(!1);this._dataStore.remove(F,s.e.local);this._stopExpirationTimers();e||this._navToRootIfInVault();this.events.off(this._navigation,"change",this._onNavigationChange);this._navEventAttached=!1;this._getVaultIconFre()||this._showVaultFreMessage(!1);this._detatchIdleEvents();this._warningDialog&&this._warningDialog.dismiss();Object.keys(w.e).map(function(e){var n=t._urlDataSource.getRootItemKey(w.e[e]);t._invalidateItems(n)});var n=this._getCurrentItem();if(this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(n,"vault"))){var r=this._urlDataSource.getRootItemKey();this._itemStore.emptyAllOtherSets([r])}else n&&this._invalidateItems(n.key,{emptyAllOtherSets:!0});this._itemStore.invalidateAllVault()};t.prototype._navToRootIfInVault=function(){var e=this._getCurrentItem();if(this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"vault"))){var t=this._urlDataSource.getRootItemKey(),n=this._urlDataSource.getItemUrl(t);this._navigation.navigateTo({url:n})}};t.prototype._invalidateItems=function(e,t){var n=this;this._isItemsScopeEnabled()?this.resources.consumeAsync(o.v).then(function(r){r.invalidateItems(e);Object(M.qo)(M.Ms)&&Object(H.e)(B.u)&&r.invalidateCurrentItemSet();M.zo&&q&&n._itemProvider.invalidateItem(e,t);var i=n._getCurrentItem();(null==i?void 0:i.vault)&&r.invalidateItems(i.key)}):this._itemProvider.invalidateItem(e,t)};t.prototype._handleVaultUnlock=function(e){var t=this;void 0===e&&(e=!1);this._isVaultOpen(!0);this._resetExpirationTimers();var n=this._urlDataSource.getRootItemKey();this._invalidateItems(n,{triggerFetch:!0});if(!this._navEventAttached){this.events.on(this._navigation,"change",this._onNavigationChange);this._navEventAttached=!0;this._onNavigationChange()}this.getQuota();this._warningDialog&&this._warningDialog.dismiss();var r=this._getCurrentItem();if(r&&(r.vault||r.isPlaceholder||r.error&&r.error.data&&161===r.error.data.errorCode||r.queryType===w.e.RecycleBin&&"root"===r.id)){this._invalidateItems(r.key,{triggerFetch:!0});var i=this._urlDataSource.getFocusItemKey(this._navigation.viewParams);i&&this._invalidateItems(i,{purgeCache:!0})}this._showVaultLockNotification(!1);u.e.logData({name:"Vault.Unlocked.Succeeded"});if(this._getVaultIconFre()&&!e){this.async.setTimeout(function(){t._showVaultFreMessage(!0)},5e3);this._setVaultIconFre(!1)}};t.prototype._onStorageChange=function(e){var t=e.key,n=e.oldValue,r=e.newValue;if(t===this._storageKeyPrefix+m.e&&r)try{var i=JSON.parse(r);FilesConfig.canary!==i&&(FilesConfig.canary=FilesConfig.navCanary=i)}catch(e){}if(t===this._storageKeyPrefix+F)if(r){if(!n||r>n){this._dataStore.getValue(F,s.e.local)||this._dataStore.setValue(F,parseInt(r,10),s.e.local);this._handleVaultUnlock()}}else this._isVaultOpen.peek()&&this._handleVaultLock()};t.prototype._calculateFreMessage=function(){var e=this;this._getVaultIconFre()&&this.async.setTimeout(function(){e._showVaultFreMessage(!0)},5e3)};t.prototype._getCurrentItem=function(){var e=this._urlDataSource.getCurrentItemKey(this._navigation.viewParams);return this.unwrapObservable(this._itemStore.getItem(e))};t.prototype._getVaultIconFre=function(){return this._dataStore.getValue("vaultMenuCalloutMessageShow",s.e.local)};t.prototype._setVaultIconFre=function(e){e?this._dataStore.setValue("vaultMenuCalloutMessageShow",e,s.e.local):this._dataStore.remove("vaultMenuCalloutMessageShow",s.e.local)};t.prototype._postProcessQos=function(e,t){this._isExpectedError(t)&&(e.resultType=f.e.ExpectedFailure);return e};t.prototype._postProcessUnlockQos=function(e,t){this._isExpectedUnlockError(t)&&(e.resultType=f.e.ExpectedFailure);return e};t.prototype._isExpectedError=function(e){if(400===e.status||403===e.status){var t=Object(c.i)(e);if("memberdoesnotexist"===(t=t&&t.toLowerCase())||"unlockrequired"===t||"accessdenied"===t||"confirmationrequired"===t)return!0}else if(404===e.status)return!0;return!1};t.prototype._isExpectedUnlockError=function(e){var t=Object(c.i)(e);if("vaultunlockextensiontimeexceeded"===(t=t&&t.toLowerCase())){u.e.logData({name:"Vault.Unlock.MaxExtensionError"});return!0}return!1};t.prototype.enableVaultV2=function(e){var t=this;return this._vroomDataRequestor.send({endpoint:Object(P.o)({apiVersion:"v2.1",driveId:"me",includeViewerId:!0}),apiName:e?"CreateVault":"EnableVault",path:"/oneDrive.createVault",requestType:"POST",breakCache:!0,apiVersion:"v2.1",qosExtraData:{requestType:"POST"},postProcessQos:this._postProcessQos.bind(this),useAuthorizationHeaders:!0}).then(function(){t.setVaultLockState({root:void 0,isLocked:!1,expirationInSeconds:1200})})};t.prototype.disableVaultV2=function(){var e,t=this;return(null===(e=this._identityDataSource)||void 0===e?void 0:e.getSessionToken(!0)).then(function(e){return t._vroomDataRequestor.send({endpoint:Object(P.o)({apiVersion:"v2.1",driveId:"me",includeViewerId:!0}),apiName:"deleteVault",path:"/oneDrive.disableVault",requestType:"POST",breakCache:!0,apiVersion:"v2.1",qosExtraData:{requestType:"POST"},postProcessQos:t._postProcessQos.bind(t),useAuthorizationHeaders:!0,accessToken:e}).then(function(){t._cleanLocalLockInfo();t._isVaultDisabled(!0)}).catch(function(e){return y.n.reject(e)})})};t.prototype.getUnlockVaultV2RequestData=function(){return{endpoint:Object(P.o)({apiVersion:"v2.1",driveId:"me",includeViewerId:!0}),apiName:"action.unlockVaultV2",path:"/oneDrive.unlockVault"}};t.prototype.getLockVaultV2RequestData=function(){return{endpoint:Object(P.o)({apiVersion:"v2.1",driveId:"me",includeViewerId:!0}),apiName:"action.lockVaultV2",path:"/oneDrive.lockVault"}};t.prototype.getVaultV2=function(e,t){var n=this,i={Prefer:"Include-Feature=AddToOneDrive"};return(e||t?this.enableVaultV2(e):y.n.resolve()).then(function(){return n._vroomDataRequestor.send({endpoint:Object(P.o)({apiVersion:"v2.1",driveId:"me",includeViewerId:!0}),apiName:"GetVault",path:"/drive/items/root/children?select=*,containingDrivePolicyScenarioViewpoint&filter=remoteItem/containingDrivePolicyScenarioViewpoint/PolicyScenarioId eq '".concat("fa0c6428-7a2e-4a42-a9cc-52f48021d0ba","'"),headers:i,breakCache:!0,apiVersion:"v2.1",useAuthorizationHeaders:!0})}).then(function(e){var t;if(0===e.length)return y.n.reject({status:404,message:"Vault not found"});var n=e[0];return Object(r.__assign)(Object(r.__assign)({},n),{vault:Object(j.e)(null===(t=n.remoteItem)||void 0===t?void 0:t.containingDrivePolicyScenarioViewpoint)})})};return t})(i.n);t.default=U;var z=Object(x.s)("VaultDataSource",U,Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{clientName:_.e.optional,identityDataSource:o.h,vroomDataRequestor:T.e,itemStore:p.e,vaultStore:v.resourceKey,urlDataSource:o.B,navigation:g.e,itemProvider:S.resourceKey,dialogProvider:a.e,userInfoProvider:E.m,itemParentHelper:h.e,bundleLoader:E.e,isItemsScopeEnabled:d.r.lazy}))},,,,,,function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return c});var r=n(0),i=n(7),s=n(69),o=n(99),u=n(46),a=n(127),f=n(6),l=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._identityDataSource=n.identityDataSource;r.isVaultDisabled=r.createObservable(void 0);r.vaultFreState=r.createObservable(a.r.NotCreated);r.vaultQuota=r.createObservable(void 0);r.isOverQuota=r.createPureComputed(r._computeIsOverQuota);r.showVaultLockNotification=r.createObservable(!1);r.showVaultFreMessage=r.createObservable(!1);r.storageKeyPrefix=a.t+r._identityDataSource.getIdentity().id;r.dataStore=new o.e(r.storageKeyPrefix,u.e.local);r.isVaultOpen=r.createObservable(!!r.dataStore.getValue("expirationtime",u.e.local));return r}t.prototype._computeIsOverQuota=function(){var e=this.vaultQuota();return!!e&&e.remainingFiles<=0&&e.totalFiles>0};return t})(i.n);t.default=l;var c=Object(s.s)("VaultStore",l,Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{identityDataSource:f.h}))},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});var r=n(411),i=n(1),s=n(162);function o(e){var t=e.targetOrigin,n=e.logOnly,o=e.iframeElem,u=e.allowedOrigins,a=e.migrationState,f=Object(s.t)().dispatcher;Object(i.useEffect)(function(){if(o){var e=new r.t({targetOrigin:t,logOnly:n,iframeElem:o,allowedOrigins:u,migrationState:a});e.attach(f);e.start();e.sendHostReadyMessage();return function(){e.dispose();e.deattach()}}},[n,o,u,f]);return null}function u(e){var t=e.application,n=e.session,o=e.migrationState,u=Object(s.t)().dispatcher;Object(i.useEffect)(function(){if(t&&n&&u){var e=Microsoft.Office[t.name].CommandIds,i=new r.e({application:t,session:n,migrationState:o,commandIds:e});i.attach(u);i.start();return function(){i.dispose();i.deattach()}}},[t,n,u]);return null}},function(e,t,n){"use strict";n.d(t,"t",function(){return l});n.d(t,"e",function(){return c});var r=n(0),i=n(133),s=n(34),o=n(30),u=n(21),a=n(64),f=n(92),l=(function(){function e(e){var t=this;this.handleMessage=function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,n,i,s,l,c,h,p,d,v;return Object(r.__generator)(this,function(r){switch(r.label){case 0:Object(a.e)("WacPostMessageSource receive message: ",e.data);t=new u.e({name:"WacHost.Message.Post.".concat(e.type)});if(!this.validate(e)){Object(a.e)("WacPostMessageSource invalid message: ",e.data);t.end({resultType:u.t.ExpectedFailure,resultCode:"WAC Post message source/origin is invalid",extraData:{origin:e.origin}});return[2]}try{n=JSON.parse(e.data)}catch(n){Object(a.e)("WacPostMessageSource invalid message data: ",e.data);t.end({resultType:u.t.Failure,resultCode:"WAC Post message data is invalid",extraData:{data:e.data,Error:null==n?void 0:n.message}});return[2]}if(this.logOnly){Object(a.e)("WacPostMessageSource log message only: ",e.data);t.end({resultType:u.t.Success,resultCode:"WAC post message handling success",extraData:{SendTime:n.SendTime,CorrelationId:n.CorrelationId,wdUserSession:n.wdUserSession||(null===(c=n.Values)||void 0===c?void 0:c.wdUserSession)}});return[2]}f.e.logData({name:"".concat(this.migrationState?"COB":"ODC",".WacPostMessage.Receive.").concat(n.MessageId),usageType:"Click",extraData:{SendTime:n.SendTime,CorrelationId:n.CorrelationId,wdUserSession:n.wdUserSession||(null===(h=n.Values)||void 0===h?void 0:h.wdUserSession)}});r.label=1;case 1:r.trys.push([1,6,,7]);if(!this.dispatcher){Object(a.e)("WacPostMessageSource ignore message cause no dispatcher: ",e.data);t.end({resultType:u.t.Success,resultCode:"Application message handling skip",extraData:{SendTime:n.SendTime,CorrelationId:n.CorrelationId,wdUserSession:n.wdUserSession||(null===(p=n.Values)||void 0===p?void 0:p.wdUserSession)}});return[2]}if(!(i=this.dispatcher.dispatch(n.MessageId,n.Values)))return[3,5];s=void 0;return o.n.isPromise(i)?[4,i]:[3,3];case 2:s=r.sent();return[3,4];case 3:s=i;r.label=4;case 4:s&&this.receive(s,e.source,e.origin);r.label=5;case 5:t.end({resultType:u.t.Success,resultCode:"WAC post message handling success",extraData:{SendTime:n.SendTime,CorrelationId:n.CorrelationId,wdUserSession:n.wdUserSession||(null===(d=n.Values)||void 0===d?void 0:d.wdUserSession)}});return[3,7];case 6:l=r.sent();Object(a.e)("WacPostMessageSource message error: ",l);t.end({resultType:u.t.Failure,resultCode:"WAC Post message handling error",extraData:{SendTime:n.SendTime,CorrelationId:n.CorrelationId,wdUserSession:n.wdUserSession||(null===(v=n.Values)||void 0===v?void 0:v.wdUserSession),Error:null==l?void 0:l.message}});return[3,7];case 7:return[2]}})})};this.logOnly=e.logOnly;this.targetOrigin=e.targetOrigin;this.allowedOrigins=e.allowedOrigins;this.iframeElem=e.iframeElem;this.migrationState=e.migrationState}e.prototype.attach=function(e){this.deattach();this.dispatcher=e;e.attach(this)};e.prototype.deattach=function(){if(this.dispatcher){this.dispatcher.deattach(this);this.dispatcher=void 0}};e.prototype.start=function(){window.addEventListener("message",this.handleMessage)};e.prototype.dispose=function(){window.removeEventListener("message",this.handleMessage)};e.prototype.sendHostReadyMessage=function(){if(this.iframeElem)try{this.receive({CorrelationId:i.e.generate(),MessageId:s.t.Host_PostmessageReady})}catch(e){console.log(e)}};e.prototype.receive=function(e,t,n){if(!this.logOnly){f.e.logData({name:"".concat(this.migrationState?"COB":"ODC",".WacPostMessage.Send.").concat(e.MessageId),usageType:"Click",extraData:{SendTime:Date.now(),CorrelationId:null==e?void 0:e.CorrelationId}});t=t||this.iframeElem.contentWindow;n=n||this.targetOrigin;t&&n&&t.postMessage(JSON.stringify(Object(r.__assign)(Object(r.__assign)({},e),{SendTime:Date.now()})),n)}};e.prototype.validate=function(e){var t=this.allowedOrigins,n=this.iframeElem,r=e.origin,i=e.source;if(!n||i!==n.contentWindow){Object(a.e)("WacPostMessageSource invalid message cause invalid source");return!1}if(t){if(-1===t.findIndex(function(e){return r.toLowerCase()===e.toLowerCase()})){Object(a.e)("WacPostMessageSource invalid message cause invalid origin");return!1}}return!0};return e})(),c=(function(){function e(e){var t=this;this.handleMessage=function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,n,i,s,l,c,h,p,d;return Object(r.__generator)(this,function(r){switch(r.label){case 0:Object(a.e)("WacPostMessageSource receive message: ",e.data);t=new u.e({name:"WacHost.Message.Application.".concat(e.type)});n=e.type,i=e.data;f.e.logData({name:"".concat(this.migrationState?"COB":"ODC",".WacPostMessage.Receive.").concat(n),usageType:"Click",extraData:{SendTime:i.SendTime,CorrelationId:i.CorrelationId,wdUserSession:i.wdUserSession||(null===(c=i.Values)||void 0===c?void 0:c.wdUserSession)}});r.label=1;case 1:r.trys.push([1,6,,7]);if(!this.dispatcher){t.end({resultType:u.t.Success,resultCode:"Application message handling skip",extraData:{SendTime:i.SendTime,CorrelationId:i.CorrelationId,wdUserSession:i.wdUserSession||(null===(h=i.Values)||void 0===h?void 0:h.wdUserSession)}});return[2]}if(!(s=this.dispatcher.dispatch(n,i)))return[3,5];l=void 0;return o.n.isPromise(s)?[4,s]:[3,3];case 2:l=r.sent();return[3,4];case 3:l=s;r.label=4;case 4:l&&this.receive(l);r.label=5;case 5:t.end({resultType:u.t.Success,resultCode:"Application message handling success",extraData:{SendTime:i.SendTime,CorrelationId:i.CorrelationId,wdUserSession:i.wdUserSession||(null===(p=i.Values)||void 0===p?void 0:p.wdUserSession)}});return[3,7];case 6:r.sent();Object(a.e)("WacPostMessageSource receive message: ",e.data);t.end({resultType:u.t.Failure,resultCode:"Application message handling error",extraData:{SendTime:i.SendTime,CorrelationId:i.CorrelationId,wdUserSession:i.wdUserSession||(null===(d=i.Values)||void 0===d?void 0:d.wdUserSession)}});return[3,7];case 7:return[2]}})})};this.application=e.application;this.session=e.session;this.migrationState=e.migrationState;this.commandIds=e.commandIds}e.prototype.attach=function(e){this.deattach();this.dispatcher=e;e.attach(this)};e.prototype.deattach=function(){if(this.dispatcher){this.dispatcher.deattach(this);this.dispatcher=void 0}};e.prototype.start=function(){this.application.addEventListener(this.handleMessage)};e.prototype.dispose=function(){this.application.removeEventListener(this.handleMessage)};e.prototype.receive=function(e){f.e.logData({name:"".concat(this.migrationState?"COB":"ODC",".WacPostMessage.Send.").concat(e.MessageId),usageType:"Click",extraData:{SendTime:Date.now(),CorrelationId:null==e?void 0:e.CorrelationId}});this.runCommand(e)};e.prototype.runCommand=function(e){var t=e.MessageId,n=e.Values,r=this.getCommandId(t);r&&this.session.run(r,n)};e.prototype.getCommandId=function(e){var t=this.commandIds;switch(e){case s.t.BlurFocus:return t.blurFocus;case s.t.Host_AccessibilityLoopComplete:return t.continueAccessibilityLoop;case s.t.GrabFocus:return t.grabFocus;case s.t.CanEmbed:return t.sendEmbeddedViewUrl;case s.t.PostAccessToken:return t.sendAccessToken;case s.t.App_PopState:return t.popState;case s.t.Host_RefreshSessionInfo:return t.sendSessionInfo;case s.t.CheckUserAccessAndGrantPermissions_Result:return t.sendUserAccessAndPermissions;case s.t.Host_WopiInfoFromUrl:return t.sendWopiInfo;case s.t.Host_DavUrlFromIds:return t.sendDavUrl;case s.t.Host_SetCustomAuthConfig:return t.sendCustomAuthConfig;case s.t.Host_MoveToFolder:return t.moveToFolder;case s.t.Host_FilePicker:return t.completeSharedFilePicker}};return e})()},function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(7),s=n(69),o=n(160),u=n(30),a=n(153),f=n(43),l=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._operationProvider=n.operationProvider;r._operationBatch=t.operationBatch;r._onOperationFinished=t.onOperationFinished;r._completionSignal=new a.e;r._completionSignal.getPromise().done(function(){r.dispose()},function(){r.dispose()});r.addDisposable(r._operationProvider.groups.subscribe(r._onOperationProviderGroupsChanged,r,"arrayChange"));return r}t.prototype.getGroupOperation=function(){return this._groupOperation};t.prototype.start=function(e){var t=this;return e().then(function(){t._completeIfNoGroupCreated()},function(e){t._completeIfNoGroupCreated();return u.n.wrapError(e)})};t.prototype.wait=function(){return this._completionSignal.getPromise()};t.prototype._createGroupOperationSubscription=function(e){var t=this,n=this.createPureComputed(function(){var t=e.state();return t===f.e.completed||t===f.e.canceled||t===f.e.failed||t===f.e.expired});this.createBackgroundComputed(function(){n()&&t.observables.ignore(function(){t._onOperationFinished&&t._onOperationFinished(e)})})};t.prototype._onOperationProviderGroupsChanged=function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t],i=r.value;if(i.batch===this._operationBatch)if("added"===r.status){if(!this._groupOperation){this._groupOperation=i;this._createGroupOperationSubscription(i)}}else"deleted"!==r.status||r.moved||this._completionSignal.complete()}};t.prototype._completeIfNoGroupCreated=function(){this._groupOperation||this._completionSignal.complete()};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{operationProvider:o.e});return t})(i.n),c=Object(s.o)("OperatorBatchMonitor",l)},function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return i});var r="oneDriveFullScreenTakeoverDialog",i="screenBlockingDialogShownThisSession"},function(e,t,n){"use strict";var r=n(0),i=n(58),s=(function(){function e(){}e.isOpenDebugWindowEvent=function(e){return!(e.keyCode!==i.e.graveAccent||!e.ctrlKey&&!e.altKey||e.shiftKey)};e.isOpenSimplePerfDashboardEvent=function(e){return!(e.keyCode!==i.e.f8||!e.ctrlKey&&!e.altKey||e.shiftKey)};e.initSimplePerfDashboard=function(t){if(!e._perfDashboardOpen){e._markPerfDashboardOpen(!0);n.ee([135],650).then(function(n){n.show(t,e._markPerfDashboardOpen)})}};e.isInitialized=function(){return e._initialized};e.init=function(t){var i=this;e._initialized||Object(r.__awaiter)(i,void 0,void 0,function(){var i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,n.ee([117],660)];case 1:i=r.sent().default;if(!e._initialized){e._initialized=!0;i.init(t)}return[2]}})})};e.enableAutoOpen=function(e){0};e._markPerfDashboardOpen=function(t){e._perfDashboardOpen=t};e.AutoOpenSessionKey="DebugWindow_AutoOpen";return e})();t.e=s},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(3),i=n(69),s=new r.t({name:"VaultStore.key",loader:new i.t(function(){return n.ee(0,405).then(function(e){return e.resourceKey})})})}],Array(19),[function(e,t,n){"use strict";n.d(t,"i",function(){return i.e});n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});n.d(t,"n",function(){return u});n.d(t,"r",function(){return a});var r=n(3),i=n(204),s=(new r.t("sharingContextInformation"),new r.t("listContext")),o=(new r.t("listItems"),new r.t("inplaceEditorUrl"),new r.t("inplaceEditorClosing"),new r.t("appViewChangeInProgress"),new r.t("appViewChangeInProgress"),new r.t("itemsPerGroup"),new r.t("loggingContext")),u=new r.t("loggingContextBuckets"),a=(new r.t("provider.contentTypes"),new r.t("onePageContext"),new r.t("searchBehavior"),new r.t("newDocumentTemplates"));new r.t("listsHostContext"),new r.t("listsHostWelcomeContext"),new r.t("getApplicationKey")},,,function(e,t,n){"use strict";var r,i=n(0),s=n(241),o=n(7),u=n(153),a=n(69),f=n(550),l=n(290),c=n(247),h=n(22),p=n(21);(function(e){e[e.none=0]="none";e[e.queue=1]="queue";e[e.server=2]="server"})(r||(r={}));var d=r,v=Object(c.e)({eventName:"ImageLoad,Qos,",shortEventName:"ImageLoad"},{loadType:{typeRef:r,type:h.e.Enum}},p.e),m=n(446),g=n(77),y=n(16),b=n(2),w=!y.t.isActivated("C123FC1B-1706-4C97-AFF3-45C077654F1A","08/11/2022","Enable not pre-auth vroom style image preview"),E=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._semaphore=new l.e(16);r._thumbnailCache=n.thumbnailCache;return r}t.prototype.loadImage=function(e){var t=this,n=e.url,r=e.imageElement,i=void 0===r?document.createElement("img"):r,s=e.scenarioName,o=e.desiredSize,u=e.getContents,a={url:n,width:0,height:0},l=this._thumbnailCache,c=l.isLoaded(a),h=function(e){return f.e.authenticate(e).then(function(){return t._waitForImageLoad(i,e,s)}).then(function(e){l.record(a);if(i.complete&&!e)return t._waitForTimeout(300)}).then(function(){var t=i.naturalWidth||i.width,n=i.naturalHeight||i.height;return{url:e,width:t,height:n}})};return w&&u?this.trackPromise(u(Object(b.isFeatureEnabled)(b.FixODCOneUpPreview)?o:void 0,n).then(function(e){var n=URL.createObjectURL(e);return c?h(n):t._semaphore.enqueue(function(){return h(n)})})):c?h(n):this._semaphore.enqueue(function(){return h(n)})};t.prototype._waitForImageLoad=function(e,t,n){var r,i,s,o=this.async,a=this.events,f=function(){s&&o.clearTimeout(s);a.off(e)},l=new u.e(function(){f();e.setAttribute("src","");t&&/^blob:/.test(t)&&URL.revokeObjectURL(t)}),c=t&&t.indexOf("&encodeFailures=1")>=0;a.onAll(e,{load:function(){f();if(c&&1===e.naturalWidth&&e.naturalHeight>6e4){var t=e.naturalHeight-6e4,n=406===t||412===t;i&&i.end({resultType:n?p.t.ExpectedFailure:p.t.Failure,resultCode:"".concat(t),error:"Encoded failure"});l.error(new g.e({code:"".concat(t),isExpected:n,message:"Server returned encoded failure ".concat(t)}))}else{i&&i.end({resultType:p.t.Success});l.complete(r)}},error:function(){f();i&&i.end({resultType:p.t.Failure});l.error(new Error("Image '".concat(t,"' failed to load")))}});s=o.setTimeout(function(){l.cancel()},3e4);n&&(i=new v({name:n,loadType:d.server}));e.setAttribute("src",t);r=!!e.complete;return this.trackPromise(l.getPromise())};t.prototype._waitForTimeout=function(e){var t,n=this.async,r=new u.e(function(){t&&n.clearTimeout(t)});t=n.setTimeout(function(){r.complete()},e);return r.getPromise()};t.dependencies=Object(i.__assign)(Object(i.__assign)({},o.n.dependencies),{thumbnailCache:m.e});return t})(o.n),S=Object(a.s)("ImageLoader",E),x=n(309),T=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t)||this;r._debouncer=new x.e;r._imageLoader=r.resources.consume(S);var i=r.valueAccessor(),s=i.src,o=i.image,u=i.error,a=i.isLoaded,f=i.isError,l=i.actualSize,c=i.scenarioName,h=i.desiredSize,p=i.getContents;r._src=r.wrapObservable(s);r._image=r.wrapObservable(o);r._error=r.wrapObservable(u);r._scenarioName=c;r._getContents=p;r._desiredSize=r.wrapObservable(h);var d=n.outputExtenders,v=void 0===d?{deferred:!0}:d;r.createComputed(r._computeLoadImage);r.createBackgroundComputed(function(){var e=r._image();a&&a(!!e);if(l){var t=void 0;if(e){t={width:e.width,height:e.height}}l(t)}o&&o(e)}).extend(v);r.createBackgroundComputed(function(){var e=r._error();u&&u(e);f&&f(!!e)}).extend(v);return r}t.prototype._computeLoadImage=function(){var e,t=this,n=this.unwrapObservable(this._src),r=this.unwrapObservable(this._getContents);this._image(void 0);this._scenarioName&&(e=new v({name:this._scenarioName,loadType:d.queue}));this._debouncer.debounce(this.trackPromise(this._imageLoader.loadImage({url:n,imageElement:this.element,scenarioName:this._scenarioName,desiredSize:this.unwrapObservable(this._desiredSize),getContents:r}))).then(function(n){t._image(n);t._error(void 0);e&&e.end({resultType:p.t.Success})},function(n){t._error(n);e&&e.end({resultType:n.isExpected?p.t.ExpectedFailure:p.t.Failure})})};return t})(s.t);t.e=T},,,,,function(e,t,n){"use strict";var r=n(106);Object(r.e)([{rawString:".od-LoadingSpinner{white-space:nowrap}.od-LoadingSpinner-loadingText{vertical-align:top}.od-LoadingSpinner-loadingGif{vertical-align:bottom}"}]);var i=n(0),s=n(18),o=n(97),u=n(438),a=n(456),f=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;t&&void 0!==t.loadingText?n.loadingText=t.loadingText:n.loadingText=a.e;n.addBindingHandlers({imageLoader:u.e});n.isVisible=s.observable(!0);n.isImageLoaded=s.observable(!1);n.loadingImageUrl=window.require.toUrl("odsp-media/images/loading/loadingspinner.gif");return n}t.prototype.hideSpinner=function(){this.isVisible(!1)};return t})(o.e),l=n(98).e({tagName:"ms-loadingSpinner",template:'<div class="od-LoadingSpinner" data-automationid="ms-loadingSpinner"><img class="od-LoadingSpinner-loadingGif" role="presentation" data-bind="click:hideSpinner,visible:isVisible,imageLoader:{src:loadingImageUrl,isLoaded:isImageLoaded}"><span class="od-LoadingSpinner-loadingText" data-bind="text:loadingText"></span></div>',viewModel:f,synchronous:!0});t.e=l},,function(e,t,n){"use strict";var r;(function(e){e[e.Public=0]="Public";e[e.PublicUnlisted=2]="PublicUnlisted";e[e.Shared=3]="Shared";e[e.Private=4]="Private";e[e.Unknown=5]="Unknown"})(r||(r={}));t.e=r},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n(7),s=n(69),o=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r._recordsByThumbnailKey={};r._bucketsByImageKey={};var i=r.observables;r.lastAccessedDate=i.create(new Date);var s=n.pruneThumbnailsExtenders,o=void 0===s?{rateLimit:{timeout:6e5}}:s;i.backgroundCompute(r._pruneThumbnails).extend(o);return r}t.prototype.getCoveragePercent=function(e,t){var n=l(e),r=l(t);return Math.sqrt(r/n)};t.prototype.register=function(e,t,n,r){void 0===n&&(n=t);void 0===r&&(r=!0);var i=this.lastAccessedDate;i(new Date);var s=f(this.getCoveragePercent(e,n)),o=a(e),u=a(t),l=this._recordsByThumbnailKey,c=this._bucketsByImageKey,h=l[o]||{lastAccessed:void 0,buckets:{}};h.lastAccessed=i.peek();var p=h.buckets[s];if(!p||this.getCoveragePercent(p.size,n)>1){p&&delete c[p.key];p=h.buckets[s]={key:u,size:n,image:t,isLoaded:r,lastAccessed:i.peek()}}c[u]=p;l[o]=h};t.prototype.record=function(e){var t=this.lastAccessedDate;t(new Date);var n=a(e),r=this._bucketsByImageKey,i=r[n];i?i.isLoaded=!0:r[n]={key:n,size:e,image:e,isLoaded:!0,lastAccessed:t.peek()}};t.prototype.isLoaded=function(e){var t=this.lastAccessedDate;t(new Date);var n=a(e),r=this._bucketsByImageKey[n];r&&(r.lastAccessed=t.peek());return!!r&&r.isLoaded};t.prototype.retrieve=function(e,t,n){void 0===t&&(t=1);void 0===n&&(n=t);var r=a(e),i=this._recordsByThumbnailKey[r],s=this.lastAccessedDate;s(new Date);if(i){var o=i.buckets;i.lastAccessed=s.peek();var u=f(t),l=f(n),c=-1/0,h=!1;for(var p in o){var d=Number(p);if(d<=u&&d>=l&&o[d].isLoaded){c=Math.max(c,d);h=!0}}var v=h&&o[c];return v&&v.image}};t.prototype._pruneThumbnails=function(){var e=this.lastAccessedDate().getTime();c(this._recordsByThumbnailKey,e);c(this._bucketsByImageKey,e)};return t})(i.n),u=Object(s.s)("ThumbnailCache",o);function a(e){var t=e.url,n=e.width,r=e.height;return JSON.stringify({url:t,width:n,height:r})}function f(e){return Math.floor(Math.log(e)/Math.log(2)*4)}function l(e){return e.width*e.height}function c(e,t){for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];t-e[i].lastAccessed.getTime()>432e5&&delete e[i]}}},function(e,t,n){"use strict";var r;(function(e){e[e.Recycle=2]="Recycle";e[e.PermanantDelete=3]="PermanantDelete";e[e.MoveToSecondStage=4]="MoveToSecondStage"})(r||(r={}));t.e=r},function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return E});var r=n(0),i=n(91),s=n(69),o=n(36),u=n(16),a=n(30),f=(function(){function e(e,t){this.item=e.item;this._dataSource=t.dataSource}e.prototype.getSettings=function(){var e=this;if(!this._settingsPromise){this._settingsPromise=this._dataSource.getSettings(this);this._settingsPromise.done(null,function(t){if(a.n.isCanceled(t)){e._settingsPromise=null;e._rawResponse=null}})}return this._settingsPromise};e.prototype.getPermissions=function(e){this._permissionsPromise&&!e||(this._permissionsPromise=this._dataSource.getPermissions(this));return this._permissionsPromise};e.prototype.cancelGetPermissionsPromise=function(){if(this._permissionsPromise){this._permissionsPromise.cancel();this._cleanCacheIfCancel()}};e.prototype.getLinks=function(){var e=this;this._linksPromise||(this._linksPromise=this._dataSource.getLinks(this).then(function(t){e._linksData=t;return t}));return this._linksPromise};e.prototype.cancelGetLinksPromise=function(){if(this._linksPromise){this._linksPromise.cancel();this._cleanCacheIfCancel()}};e.prototype.getBestSharingLink=function(e){return this._dataSource.getBestSharingLink(this,e)};e.prototype.setLink=function(e){var t=this._linksData;if(e&&t){var n=t.filter(function(t){return t&&t.role===e.role&&t.type===e.type});if(0===n.length)t.push(e);else{var r=n[0];r.url=e.url;r.expiration=e.expiration;r.isActive=e.isActive}}};e.prototype.doSharingScopesContainLinks=function(){return this._dataSource.doSharingScopesContainLinks()};e.prototype.getRawResponse=function(){var e=this;if(!this._rawResponse){this._rawResponse=this._dataSource.getRawResponse(this);this._rawResponse.done(null,function(t){a.n.isCanceled(t)&&(e._rawResponse=null)})}return this._rawResponse};e.prototype._cleanCacheIfCancel=function(){this._linksPromise=null;this._settingsPromise=null;this._permissionsPromise=null;this._rawResponse=null};return e})(),l=n(210),c=n(188),h={ODB:!u.e.isActivated("61c45046-bce1-4f47-a4dc-477520ba1895","11/16/2021","Do not invalidate item after sharing when in search view")},p=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._dataSource=n.sharingDataSource;r._shareDataCache={};r._shareItemHelper=n.shareItemHelper;return r}t.prototype.getSharingInformation=function(e,t,n,r,i){return this._dataSource.getSharingInformation(e,t,n,r,"",i)};t.prototype.shareLink=function(e){var t=this;return this._dataSource.shareLink(e).then(function(n){if(n.link){t._invalidateCachedItem(e.items[0]);t._invalidateItem(e.items[0])}return n})};t.prototype.unshareLink=function(e){var t=this;return this._dataSource.unshareLink(e).then(function(n){t._invalidateCachedItem(e.item);t._invalidateItem(e.item);return n})};t.prototype.updatePermissions2=function(e,t,n){var r=this;return this._dataSource.updatePermissions2(e,t,n).then(function(e){r._invalidateCachedItem(t);r._invalidateItem(t);return e})};t.prototype.updatePermissionsMultiple=function(e,t,n,r,i){var s=this;return this._dataSource.updatePermissionsMultiple(e,t,n,r,i).then(function(e){s._invalidateCachedItem(t);s._invalidateItem(t);return e})};t.prototype.supportsExistingAccessOption=function(e){return this._dataSource.supportsExistingAccessOption(e)};t.prototype.getClientId=function(){return this._dataSource.getClientId()};t.prototype.parseRawSharingInformation=function(e,t){return this._dataSource.parseRawSharingInformation(e,t)};t.prototype.emailWithoutPermissioning=function(e,t,n){return this._dataSource.emailWithoutPermissioning(e,t,n)};t.prototype.checkPermissions=function(e,t){return this._dataSource.checkPermissions(e,t)};t.prototype.setAddressBarLinkCapability=function(e,t){return this._dataSource.setAddressBarLinkCapability(e,t)};t.prototype.getSharingData=function(e,t){var n=this._shareDataCache[e.id],r=n&&n.data;if(!r||e.eTag!==n.eTag||t){r=this.scope.attach(new f({item:e},{dataSource:this.getSharingDataDataSource()}));this._shareDataCache[e.id]={eTag:e.eTag,data:r}}return r};t.prototype.share=function(e,t){var n=this;return this._shareItemHelper.share(e,t).then(function(e){n._invalidateCache();return e})};t.prototype.stopSharing=function(e,t){var n=this;return this._dataSource.stopSharing(e,t).then(function(e){n._invalidateCache();return e})};t.prototype.unshare=function(e){var t=this;return this._dataSource.unshare(e).then(function(n){t._invalidateCache();t.itemProviderInvalidateParent(e);t.itemProviderInvalidate(e.key);return n})};t.prototype.updatePermissions=function(e,t,n,r){var i=this;return this._dataSource.updatePermissions(e,t,n,r).then(function(e){i._invalidateCache();i.itemProviderInvalidateParent(t);return e})};t.prototype.manageSharingLinks=function(e,t){var n=this;if(t&&t.link&&t.link.shareId&&!t.create){var r={item:e[0],kind:t.link.kind,shareId:t.link.shareId};return this._dataSource.unshareLink(r).then(function(e){n._invalidateCachedItem(r.item);n._invalidateItem(r.item);return[]})}var i=(e=e&&e.length?e:[]).map(function(e){return n.getSharingData(e)});return this._dataSource.manageSharingLinks(i,t).then(function(t){n._invalidateCache();var r=e[0];r&&n.itemProviderInvalidateParent(r);return t})};t.prototype._invalidateCache=function(){this._shareDataCache={}};t.prototype._invalidateCachedItem=function(e){e&&e.id&&this._shareDataCache[e.id]&&(this._shareDataCache[e.id]=null)};t.prototype._invalidateItem=function(e){!this.itemProviderInvalidate||!e||e.queryType===l.e.Search&&Object(c.e)(h)||this.itemProviderInvalidateParent(e)};return t})(i.e),d=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._dataSource=n.sharingDataSource;return r}t.prototype.share=function(e,t,n){return this._dataSource.share(e,t)};return t})(i.e),v=n(6),m=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.dependencies={sharingDataSource:v.A};return t})(d),g=Object(s.s)("ShareItemHelper",m),y=n(47),b=n(51),w=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._sharingDataDataSource=n.sharingDataDataSource;r._itemProvider=n.externallySharedItemProvider||n.itemProvider;return r}t.prototype.getSharingDataDataSource=function(){return this._sharingDataDataSource};t.prototype.itemProviderInvalidate=function(e){this._itemProvider.invalidateItem(e)};t.prototype.itemProviderInvalidateParent=function(e){var t=e&&e.UNSAFE_parent&&e.UNSAFE_parent.key;t&&this._itemProvider.invalidateItem(t)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.e.dependencies),{sharingDataSource:v.A,sharingDataDataSource:v.O.optional,navigation:o.e,externallySharedItemProvider:y.n.optional,itemProvider:b.resourceKey.optional,shareItemHelper:g});return t})(p),E=(t.default=w,Object(s.s)("SharingProvider",w))},,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(7),i=new(n(3).t)({name:"".concat("UserStateProvider.key",".updateQuota"),factory:{dependencies:{observablesFactoryType:r.i},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(3),i=n(69),s=new r.t({name:"UploadOperator.key",loader:new i.t(function(){return n.ee([88],642).then(function(e){return e.typeResourceKey})})})},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(3),i=n(256),s=n(323),o=new r.t({name:"".concat("FirstRunExperienceStatus.key",".FirstRunExperienceStatus"),factory:{dependencies:{},create:function(e){return{instance:new i.e(s.e.notConfigured)}}}})},,function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(7),s=n(69),o=n(30),u=n(18),a=(function(){function e(e){var t=this,n=e.noTitle,r=void 0!==n&&n,i=e.title,s=void 0===i?u.observable(""):i,a=e.elementDescribedBy,f=void 0===a?"":a,l=e.hasCommandBar,c=void 0!==l&&l,h=e.size,p=void 0===h?"Small":h,d=e.scrollMode,v=void 0===d?"auto":d,m=e.showCloseButton,g=void 0===m||m,y=e.includePadding,b=void 0===y||y,w=e.preserveLightDismiss,E=void 0!==w&&w,S=e.stickyCloseButton,x=void 0!==S&&S,T=e.component,N=void 0===T?null:T,C=e.maximizePanelContent,k=void 0!==C&&C,L=e.panelContentSize,A=void 0===L?u.observable({width:0,height:0}):L,O=e.isBlocking,M=e.disableEscape,_=void 0!==M&&M,D=e.overridePanelStyle;this.size=p;this.title=u.isObservable(s)?s:u.observable(s);this.elementDescribedBy=f;this.maximizePanelContent=k;this.panelContentSize=A;this.noTitle=r;this.hasCommandBar=c;this.component=N;this.scrollMode=v;this.showCloseButton=g;this.includePadding=b;this.preserveLightDismiss=E;this.stickyCloseButton=x;this.isBlocking=u.isObservable(O)?O:u.observable(O);this.disableEscape=_;this.overridePanelStyle=D;this.state=u.observable(0);this._promise=new o.n(function(e){var n=u.computed(function(){if(1===t.state()){e(!0);n.dispose()}},t)})}e.prototype.wait=function(){return this._promise};return e})(),f=n(320),l=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.currentPanels=r.observables.createArray();r._needsOverlayContent=n.needsOverlayContent;return r}t.prototype.requestPanel=function(e){this._needsOverlayContent.needsOverlayContent.set(!0);var t=new a(e),n=this.currentPanels;n.push(t);var r=function(){return n.remove(t)};t.wait().then(r,r);return t};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{needsOverlayContent:f.e});return t})(i.n),c=Object(s.s)("PanelProvider",l)},,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(3).t)("people")},function(e,t,n){"use strict";n.d(t,"e",function(){return x});var r,i,s=n(0),o=n(115),u=n(30),a=n(153),f=n(185),l=n(69),c=n(3),h=n(511),p=n(21),d=n(351),v=n(16),m=v.e.isActivated("06BB39DE-57D9-40CA-B107-2EBFF4CE4AF5","11/10/2022","Point logSuccess, logUnexpectedFailure, and logExpectedFailure to use logEndData"),g=v.e.isActivated("68B68656-3621-421B-9045-10B503504CEC","12/17/2022","Log and end a Qos Event when AppQos logs an end event without a start.");function y(e,t,n){void 0===n&&(n=!1);if(!r){var o=e||{name:"App"},u=p.e.withContext(function(e){return t?Object(s.__assign)(Object(s.__assign)({},e),{Workload:t}):e});r=new u(o);n&&(i=new d.e({scenario:"AppBoot",pillar:"Boot"}))}return r}function b(e){var t=e.workload;if(!r){y(void 0,t);if(!g){new p.e({name:"AppQosWithoutStart"}).end({resultType:p.t.Failure})}}e&&r.end(e);i&&e&&i.end({resultType:e.resultType,errorCode:null==e?void 0:e.resultCode,extraData:null==e?void 0:e.extraData})}var w=new c.t("BootOptions"),E=n(109),S=(function(){function e(e,t){this.isPageLoaded=!1;this.isPageRenderingComplete=!1;this._pltSignal=new a.e;this._renderingCompleteSignal=new a.e;this._async=new o.e;this._resources=t.resources;this._immediatePageLoadedCallbacks=[];this._scope=new h.e;this._scope.attach(this._async);this._scope.trackSignal(this._pltSignal);this._scope.trackSignal(this._renderingCompleteSignal)}e.prototype.pageLoaded=function(e){var t,n,i,o=this;if(e)if("string"==typeof e)t=e;else{t=e.name;n=e.workload;i=e.error}if(!this.isPageLoaded){t&&f.e.plt(t);(function(e){if(m){var t=(e||{}).workload;r||y(void 0,t);r.end(e||{resultType:p.t.Success})}else b(e||{resultType:p.t.Success})})(Object(s.__assign)({resultType:p.t.Success},n?{workload:n}:{}));this.isPageLoaded=!0;this.pageLoadError=i;var a=this._resources.consume(w.optional);a&&a.onEUPL&&a.onEUPL();for(var l=[],c=this._immediatePageLoadedCallbacks.shift();c;){l.push(this._scope.trackPromise(c()));c=this._immediatePageLoadedCallbacks.shift()}u.n.all(l).then(function(){o._async.setImmediate(function(){return o._pltSignal.complete()})})}};e.prototype.pageRenderingIsComplete=function(e){var t=this;this._async.setImmediate(function(){return t._renderingCompleteSignal.complete()})};e.prototype.waitForPLT=function(){var e=this,t=this._pltSignal;return t.getPromise().catch(function(n){return n instanceof E.e&&t!==e._pltSignal?e.waitForPLT():u.n.reject(n)})};e.prototype.waitForPageRenderingComplete=function(){var e=this,t=this._renderingCompleteSignal;return t.getPromise().catch(function(n){return n instanceof E.e&&t!==e._renderingCompleteSignal?e.waitForPageRenderingComplete():u.n.reject(n)})};e.prototype.reset=function(){this.isPageLoaded=!1;this.pageLoadError=void 0;var e=this._pltSignal,t=this._renderingCompleteSignal;this._pltSignal=new a.e;this._renderingCompleteSignal=new a.e;e.error(new E.e({message:"Reset page load state."}));t.error(new E.e({message:"Reset page load state."}))};e.prototype.addImmediatePageLoadedCallback=function(e){if(this.isPageLoaded)throw"Cannot add immediate page loaded call back after page has already loaded";if(this._immediatePageLoadedCallbacks.length>3)throw"Too many callbacks registered!";this._immediatePageLoadedCallbacks.push(e)};e.prototype.dispose=function(){this._scope.dispose()};return e})(),x=Object(l.s)("PageLoadMonitor",S,{resources:c.s})},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(3),i=n(69),s=new r.t({name:"AlbumProvider.key",loader:new i.t(function(){return n.ee([82],641).then(function(e){return e.resourceKey})})})},,function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(99),i=(function(){function e(){this._state={}}e.prototype.getValue=function(e,t){var n=this._state[e];if(n&&t<n.expiration)return n;delete this._state[e]};e.prototype.setValue=function(e,t){t?this._state[e]=t:delete this._state[e]};return e})(),s=(function(){function e(e){var t=e.userId,n=e.cachingType;this._store=new r.e("Identity.OAuth.".concat(t),n)}e.prototype.getValue=function(e,t){var n=this._store.getValue(e);if(n&&t<n.expiration)return n;this._store.remove(e)};e.prototype.setValue=function(e,t){t?this._store.setValue(e,t):this._store.remove(e)};return e})()},,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(608),i=n(3),s=n(69),o=new i.t({name:"offlineDetection",factory:new s.i(r.e)})},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(3),i=n(69),s=new r.t({name:"".concat("AlbumsInvalidator.key",".albumsInvalidator"),loader:new i.t(function(){return n.ee([91],663).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";var r=n(0),i=n(7),s=n(36),o=n(47),u=n(213),a=n(39),f=n(334);n.d(t,"t",function(){return f.e});var l=n(395),c=n(518),h=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._navigation=n.resources.consume(s.e);return n}t.prototype.appendPurchaseAttribution=function(e,t,n){var r=new a.t(t),i=this._navigation.viewParams.ocid||this._navigation.viewParams["WT.mc_id"];i||(i=!l.e&&n||this.getPurchaseAttribution(e));var s=r.getQueryParameter("ru");if(s){var o=new a.t(s);o.setQueryParameter("ocid",i);r.setQueryParameter("ru",o.toString())}r.setQueryParameter("ocid",i);return r.toString()};t.prototype.getPurchaseAttribution=function(e){var t=this._navigation.viewParams.ocid||this._navigation.viewParams["WT.mc_id"];if(t)return t;var n=this._getUserState(),r=e.attributionEndpoint||"Web",i=Object(c.e)(e.source,e.cta);return!l.e&&i||"PROD_OneDrive-".concat(r,"_").concat(e.source,"_").concat(n,"_").concat(e.cta)};t.prototype._getUserState=function(){return this._isUserStateProviderAvailable()&&this._userStateProvider.status?(function(e){switch(e){case u.e.normal:return"Normal";case u.e.nearing:case u.e.critical:return"Critical";case u.e.full:return"Full";case u.e.overQuota:case u.e.outOfSpace:return"OverLimit";default:case u.e.unknown:return"Unknown"}})(this._userStateProvider.status.peek()):"Unknown"};t.prototype._isUserStateProviderAvailable=function(){this._userStateProvider=this.resources.consume(o.l.optional);this._bundleLoader=this.resources.consume(o.e.optional);if(this._bundleLoader){return this._bundleLoader.getBundleInfo(2).isLoaded()}return!1};return t})(i.n);t.e=h},function(e,t,n){"use strict";var r,i=n(0),s=n(7),o=n(30),u=n(335),a=n(336),f=n(111),l=n(269),c=n(40),h=n(52),p=n(57),d=n(28),v=n(445),m=n(164),g=n(480);(function(e){e.AppleLivePhoto="AppleLivePhoto";e.SamsungMotionPhoto="SamsungMotionPhoto"})(r||(r={}));var y,b=n(289),w=n(104),E=n(5),S=n(75),x=n(23),T=n(16),N=n(71),C=n(313),k=n(311),L=n(80);(function(e){e[e.unRes=0]="unRes";e[e.doc=1]="doc"})(y||(y={}));var A,O=n(20),M=y[y.unRes],_=y[y.doc],D=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});return e.call(this,t)||this}t.prototype.processThumbnailSet=function(e,t){for(var n={},r={},s=0,o=e.thumbnails;s<o.length;s++){var u=o[s];n[u.name]=u;if(0===u.name.indexOf("scaled")){r[u.name.substring("scaled".length).toLowerCase()]=u}}var a,f={thumbnailSet:e,thumbnailsByType:n,thumbnailsBySize:r,item:t},l=n[M],c=n[_];l?a=this._isOriginalThumbnailRequired(t)?this._getOriginalThumbnail(l,f):this._getUnResThumbnail(l,f):c?a=t.video&&t.video.width&&t.video.height?this._getUnResThumbnail(Object(i.__assign)(Object(i.__assign)({},c),{width:t.video.width,height:t.video.height}),f):t.photo&&t.photo.width&&t.photo.height?this._getUnResThumbnail(Object(i.__assign)(Object(i.__assign)({},c),{width:t.photo.width,height:t.photo.height}),f):this._getDocThumbnail(c,f):Object.keys(r).length&&(a=this._getScaledThumbnail(f));return a};t.prototype.getProcessFiltersUrl=function(e,t){for(var n,r=0,i=e.thumbnails;r<i.length;r++){var s=i[r];"custom"===s.name&&(n=s)}return n?this._createSizedUrl(e.baseUrl,n.url,{width:n.width,height:n.height}):""};t.prototype._getOriginalThumbnail=function(e,t){var n=t.item.photo.originalUrl||t.item.urls&&t.item.urls[m.e[m.e.download]];return n?{width:t.item.photo.width,height:t.item.photo.height,url:this._createUrlPattern(t.thumbnailSet.baseUrl,e.url),getAligned:function(e,r){return{width:t.item.photo.width,height:t.item.photo.height,url:n}}}:this._getUnResThumbnail(e,t)};t.prototype._getUnResThumbnail=function(e,t){var n=this;return{width:e.width,height:e.height,url:this._createUrlPattern(t.thumbnailSet.baseUrl,e.url),getAligned:function(r,i){return{width:e.width,height:e.height,url:n._createSizedUrl(t.thumbnailSet.baseUrl,e.url,r)}}}};t.prototype._getDocThumbnail=function(e,t){var n=this;return{width:0,height:0,url:this._createUrlPattern(t.thumbnailSet.baseUrl,e.url),getAligned:function(r,i){return{width:0,height:0,url:n._createSizedUrl(t.thumbnailSet.baseUrl,e.url,{width:r.width,height:Math.max(r.height,2048)})}}}};t.prototype._getScaledThumbnail=function(e){var t,n=this,r=[];for(var i in e.thumbnailsBySize){var s=e.thumbnailsBySize[i];switch(i){case"largest":t=s;break;default:r.push(s)}}r.sort(function(e,t){return e.width*e.height-t.width*t.height});t=t||r[r.length-1];var o=e.item.photo||t;return{url:this._createUrl(e.thumbnailSet.baseUrl,t.url),width:o.width,height:o.height,getAligned:function(i,s){for(var u,a=i.width*i.height,f=0,l=r;f<l.length;f++){var c=l[f];if(c.width*c.height>.9*a){u=c.url;break}}return{width:o.width,height:o.height,url:n._createUrl(e.thumbnailSet.baseUrl,u||t.url)}}}};t.prototype._createSizedUrl=function(e,t,n){var r={width:Math.ceil(n.width),height:Math.ceil(n.height)};n.width===n.height&&(r.cropMode="center");return this._createUrl(e,t,r)};t.prototype._createUrlPattern=function(e,t){return this._createUrl(e,t,{width:{uriValue:"{0}"},height:{uriValue:"{1}"},cropMode:"center"})};t.prototype._createUrl=function(e,t,n){void 0===n&&(n={});var r="".concat(e).concat(t),i=O.n(n)?r.indexOf("?")>-1?"&":"?":"";return"".concat(r).concat(i).concat(O.n(n))};t.prototype._isOriginalThumbnailRequired=function(e){var t=e.extension,n=void 0===t?"":t,r=e.photo;return".gif"===n.toLowerCase()&&!!r};return t})(s.n),P=n(2),H=n(48),B=n(6),j=n(184),F=n(393),I=n(362),q=n(72),R=n(140),U=((A={}).at="1",A.ata="1",A.de="3",A.defc="1",A.dl="3",A.em="3",A.mc="1",A.rfa="1",A.rn="1",A.sh="1",A.vo="1",[".jfif",".jfif-tbnl",".jpe",".jpg",".jpeg"]);function z(e){return U.some(function(t){return e.toLowerCase()===t})}var W=n(422);function X(e,t,n){var r=window.FilesConfig&&window.FilesConfig.df?"s":"p";return"https://southcentralus1-media".concat(r,".svc.ms/transform/").concat(e,"?provider=odc&cs=V2VifE9EQw==&inputFormat=").concat(t,"&docid=").concat(encodeURIComponent(n))}var V=n(715);function $(e){if("number"==typeof e)return Object(V.e)(e)}var J=n(149),K=!T.e.isActivated("B11CEEB1-B225-42EF-A0A0-0892C41C07F1","07/15/2022","Force item redemption for skyapi items when the user is anonymous"),Q={0:h.e.Owner,1:h.e.Edit,2:h.e.View,3:h.e.Submitter,4:h.e.CoOwner,5:h.e.None},G=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=t.getRootItemTitle,i=void 0===r?n._getRootItemTitle:r,s=t.getItemKeyExtension,o=void 0===s?n._getItemKeyExtension:s;n._getRootItemTitle=i;n._getItemKeyExtension=o;n._urlDataSource=n.resources.consume(H.n);n._identityDataSource=n.resources.consume(B.h);n._thumbnailProcessor=new(n.managed(D));return n}t.prototype.processItemResult=function(e){var t=this,n=e.requestKey,s=e.itemFromServer,o=e.requestMetadata,u=e.setItemKey,a=e.skipSettingChildren,l=e.isPrimaryRequestedItem,c=e.isPlaceholder,v=e.observer,y=this._urlDataSource.getKeyParams(n),w=e.queryType,T=void 0===w?this._urlDataSource.getQueryType(y):w;if(s){var A=this.getItemKey({requestKey:n,itemFromServer:s}),O={key:A},M=s.itemStatus;O.itemStatus=M;var _="";s.locatedIn?_=s.locatedIn:s.deletedFromLocation?_="/"===s.deletedFromLocation[0]?s.deletedFromLocation.substr(1):s.deletedFromLocation:s.ownerCid&&s.ownerCid===x.e.viewerId?_=f.e:s.ownerName&&(_=N.o(f.c,s.ownerName));var D=s.internalPath;D&&(O.internalPath=D);var H=this._identityDataSource.getIdentity(),B=s.ownerCid||H.id,F=this._getNormalizedId(s);O.id=F;var R="root"===s.id?s.rootResourceId||"root":F,U=s.resourcePartitionCid||B;O.itemId=R;void 0!==s.mruId&&(O.mruState={mruId:s.mruId,app:s.mruApp,type:s.mruType});O.graph={itemId:R,driveId:U,driveType:"personal"};O.statistics={views:s.visitorViews};O.eTag=s.eTag;O.isSharerFolder=s.isSharerFolder;O.parentKey=this._getParentKey(s,{requestKeyParams:y});var V=this._getVirtualItemType(s);O.virtualItemType=V;var G=this._isPhotosRoot(s,{requestKeyParams:y}),Y=this._isPhotosSubRoot(s,{requestKeyParams:y,isPhotosRoot:G}),Z=this._getIsRootFolder(s,{isPhotosSubRoot:Y});O.isRootFolder=Z;var ee=s.name,te="";O.comments={count:s.commentCount||0,settings:{isCommentDisabled:s.commentSettings&&s.commentSettings.commentingDisabled&&!!s.commentSettings.commentingDisabled.isDisabled}};l||(O.isStub=s.isPlaceholder);var ne=s.iconType?C.e[s.iconType.toLowerCase()]:"";O.appMap=ne;var re=this._getItemType(s,ne),ie=s.extension||"";O.extension=ie;O.size=Number(s.size);var se,oe=s.sharingLevelValue;O.sharingType=oe;O.isBundle=!!s.isBundle;O.locations=s.locations;O.creatorName=s.creatorName;O.caption=s.caption||"";O.itemFromServer=s;(s.photo||s.video||s.isAlbum)&&(se=s.tags||[]);O.tags=se;O.ocr=s.ocr;O.urls=s.urls;var ue=s.userRole in Q?Q[s.userRole]:h.e.None;if("MountPoint"===s.groupFolderType){ue=h.e.Edit;O.mountPoint={}}O.vault=s.vault;var ae=s.vault;ae&&ae.root&&this.resources.consumeAsync(b.e).then(function(e){e.setVaultLockState(ae)});O.defaultSubText=this._getDefaultSubText(ue,oe,s.sharingLevel);O.location=_;O.ownerId=B;O.ownerName=s.ownerName||"";O.uploadOwnerId=U;O.specialFolderCanonicalName=s.specialFolderCanonicalName||"";O.isSpecialFolder=!!s.isSpecialFolder;var fe={};if(Z){if(x.e.areCidsEqual(O.ownerId,x.e.viewerId)){ee=this._getRootItemTitle(A);ue=h.e.Owner}else ee=f.l;o&&(O.taskStatus={restoreAllCount:o.restoreAllWorkItemCount,deleteAllCount:o.deleteAllWorkItemCount})}if(o){O.tokenNeedsRedeeming=o.tokenNeedsRedeeming;O.tokenType=o.tokenType}K&&H.type===J.e.anonymous&&(O.tokenNeedsRedeeming=!0);if(s.settings){fe.allPhotosFolderId=s.settings.allPhotosFolderId;fe.allPhotosSortAscending=s.settings.allPhotosSortAscending}s.displayQuotaExceeded&&(fe.quota={display:{exceeded:s.displayQuotaExceeded,remaining:s.displayQuotaRemaining,total:s.displayQuotaTotal,used:s.displayQuotaUsed,size:s.displaySize},exceeded:s.quotaExceeded,remaining:s.quotaRemaining,status:s.quotaStatus,total:s.quotaTotal});fe.ghostId=s.ghostId;if(s.thumbnailSet){O.thumbnail=this._thumbnailProcessor.processThumbnailSet(s.thumbnailSet,s);var le=this._thumbnailProcessor.getProcessFiltersUrl(s.thumbnailSet,s);le&&(O.processFilters={thumbnailUrl:le})}var ce=s.folder;if(ce){var he=[];O.folder={childCount:ce.childCount,documentCount:ce.documentCount,folderCount:ce.folderCount,photoCount:ce.photoCount,totalCount:ce.totalCount,covers:he};var pe=ce.covers;if(pe)for(var de=0,ve=pe;de<ve.length;de++){var me=ve[de],ge=this._thumbnailProcessor.processThumbnailSet(me,s);ge&&he.push(ge)}}var ye,be=s.photo;be&&(ye={width:be.width,height:be.height,cameraMake:be.cameraMake,cameraModel:be.cameraModel,exposureNumerator:be.exposureNumerator,exposureDenominator:be.exposureDenominator,focalLength:be.focalLength,focalRatio:be.focalRatio,iso:be.iso,originalUrl:s.urls[m.e[m.e.open]],displayDateTaken:be.displayDateTaken,dateTaken:be.dateTaken,quality:q.e.optional(be.quality?{isBad:be.quality.isBad}:void 0),isLivePhoto:q.e.optional(be.isLivePhoto),isSamsungMotionPhoto:q.e.optional(be.isSamsungMotionPhoto)});O.photo=ye;(null==be?void 0:be.isLivePhoto)&&Object(P.isFeatureEnabled)(P.EnableLivePhotoVideos)?O.video=Object(i.__assign)(Object(i.__assign)({},(function(e){return{width:e.width,height:e.height,fourCC:"H264",burstPhotoType:r.AppleLivePhoto}})(be)),s.video):(null==be?void 0:be.isSamsungMotionPhoto)&&Object(P.isFeatureEnabled)(P.EnableSamsungMotionPhotoVideos)?O.video=Object(i.__assign)(Object(i.__assign)({},(function(e){return{width:e.width,height:e.height,fourCC:"H264",burstPhotoType:r.SamsungMotionPhoto}})(be)),s.video):O.video=s.video;O.audio=s.audio;O.panorama=s.panorama;O.geoLocation=s.location;var we=s.textEditorMimeType;O.textEditorMimeType=we;var Ee=!!s.isAlbum;O.isAlbum=Ee;var Se,xe=s.photo||s.video,Te=$(s.dateModifiedOnClient),Ne=$(s.creationDate),Ce=$(s.lastAccess),ke=$(s.dateShared),Le=$(s.dateDeleted),Ae=$(s.dateExpires),Oe=xe&&$(xe.dateTaken),Me=s.displayModifiedDate,_e=s.displayCreationDate,De=s.displayLastAccess,Pe=s.displayDateShared,He=s.displayDateDeleted,Be=s.displayExpiryDate;try{Te&&(Me=Object(j.t)(Te));Ne&&(_e=Object(j.s)(Ne));Ce&&(De=Object(j.s)(Ce));ke&&(Pe=Object(j.s)(ke));Le&&(He=Object(j.s)(Le));Ae&&(Be=Object(j.s)(Ae));Oe&&(Se=Object(j.t)(Oe,!1,!1,!0))}catch(e){}O.dateModifiedValue=s.dateModifiedOnClient;O.dateModifiedTime=O.vault&&O.vault.root?"":Te;O.dateCreatedTime=Ne;O.dateAccessedTime=Ce;O.dateSharedTime=ke;O.dateDeletedTime=Le;O.dateExpiresTime=Ae;O.dateModified=O.vault&&O.vault.root?O.vault.isLocked?" ":"Unlocked":Me;O.dateCreated=_e;O.dateAccessed=De;O.dateShared=Pe;O.dateDeleted=He;O.dateExpires=Be;if(xe){O.dateTakenTime=q.e.optional(Oe);O.dateTaken=q.e.optional(Se)}O.itemFromServer=s;O.lifeCycleStatus=q.e.optional(this._getItemLifeCycleStatus(O));var je={},Fe={};if(s.isAlbumRoot){Fe.dl=!0;Fe.sh=!0;Fe.rn=!0}if((null==be?void 0:be.isLivePhoto)&&Object(P.isFeatureEnabled)(P.EnableLivePhotoVideos)){Fe.aol=!0;Fe.rot=!0;Fe.vo=!0;je.acp="1"}(be||s.video)&&(je.ata="1");be&&!z(O.extension)&&(Fe.rot=!0);if(s.commands)for(var Ie=s.commands.split(","),qe=0;qe<Ie.length;qe+=2){Ie[qe]in Fe||(je[Ie[qe]]=Ie[qe+1])}else"root"===O.id&&Object(S.e)(T)&&(je.defc="1");if(s.audio){delete je.pl;je.defc="1"}var Re,Ue,ze,We=!!je.orr;O.isViolation=We;O.queryType=T;O.displayType=!ce||1!==ce.category||T===E.e.Files&&Z?T:E.e.Photos;O.queryType===E.e.Recent&&Z&&(je.defc="1");if(re===d.e.Folder&&!O.isStub)switch(ue){case h.e.Owner:case h.e.CoOwner:case h.e.Edit:ze=O.queryType===E.e.Files||O.queryType===E.e.SharedWithMe&&!Z;break;default:ze=!1}O.sharingRole=ue;O.isDropEnabled=ze;O.iconName=k.n({type:re,extension:ie,sharingType:oe,textEditorMimeType:we});O.iconName=this._isFluidFile(s)?"fluid":O.iconName;O.documentFormat=s.docFormat||0;V===p.e.AlbumRoot&&(ee=g.e);D&&(te=L.e.isRightToLeft?D.slice(0).reverse().join(" < "):D.join(" > "));c||(O.isPlaceholder=!1);O.isDraggable=O.queryType===E.e.Files&&!O.mountPoint;if(ce){O.childCount=s.estimatedResultCount||ce.totalCount;O.category=ce.category;Re=[];ce.itemGroupings&&(Ue=ce.itemGroupings.map(function(e){var n=e.itemGroups,r=Object(i.__rest)(e,["itemGroups"]);return Object(i.__assign)(Object(i.__assign)({},r),{itemGroups:n.map(function(e){return Object(i.__assign)(Object(i.__assign)({},e),{state:t.observables.create({isCollapsed:!1})})})})}));var Xe={};if(ce.children&&!a)for(var Ve=0,$e=ce.children;Ve<$e.length;Ve++){var Je=$e[Ve],Ke=this.processItemResult({observer:v,requestKey:n,itemFromServer:Je,queryType:T,requestMetadata:o,skipSettingChildren:!1,isPrimaryRequestedItem:!1}).item;Re.push(Ke);Xe[Ke.key]={newTag:this.getNewTagIfExists(Je),autoAlbumTag:this.getAutoAlbumTagIfExists(Je)}}if(V===p.e.AlbumRoot){for(var Qe={groupingId:"newAutoAlbums",count:0,state:this.observables.create({isCollapsed:!0})},Ge=[],Ye=0,Ze=[],et=Math.max(3,10-Re.length),tt=0,nt=Re;tt<nt.length;tt++){var rt=nt[tt],it=Xe[rt.key];if(it&&it.newTag&&it.autoAlbumTag)if(++Ye>et){Ge.push(rt);Qe.count++}else Ze.push(rt);else Ze.push(rt)}Qe.startIndex=Ze.length;Re=Ze.concat(Ge);var st={name:"newAutoAlbumsGrouping",itemGroups:[Qe]};Ue.push(st)}}else s.name&&this._isFluidFile(s)?O.openUrl=this._generateOpenUrlForFluidFile(s.name,U,R):s.urls&&(s.urls.oneNoteWeb?O.openUrl=s.urls.oneNoteWeb:O.openUrl=s.urls.viewInBrowser);var ot=ie&&ie.toLowerCase(),ut=ot&&ot.slice(1);if(".pdf"===ot||".ai"===ot&&je.dl){je.defc="1";O.openUrl=this._urlDataSource.getDownloadItemUrl({key:A,id:R,ownerId:B,extension:ie},FilesConfig.canary,!0);Object(P.isFeatureEnabled)(P.UseWebPdfViewer)&&(re=d.e.Media)}var at,ft,lt="".concat(x.e.getVroomBaseUrl({apiVersion:"v1.0",driveId:U}),"/drives/").concat(U,"/items/").concat(R);if(Object(P.isFeatureEnabled)(P.EnableZipFilePreviewing)&&(".zip"===ot||".rar"===ot)){je.defc="1";re=d.e.Media;O.zip=q.e.optional((at=ut,(ft=lt)?{downloadZipContentsUrl:X("zipcontent",at,ft),zipMetaDataUrl:X("zipmetadata",at,ft)}:void 0))}var ct=(function(e,t){var n=W.e(e),r=W.t(e);if(n||r)return{canConvert:n,canRenderNative:r,conversionUrl:n&&t?"".concat(X("glb",e,t),"&{.authParams}"):void 0}})(ut,lt);if(ct){re=d.e.Media;O.model3d=ct;je.defc="1"}O.type=re;O.thumbnail&&"4"===je.defc&&(je.defc="1");!l&&s.isPlaceholder&&(je.defc="1");if("allmyphotos"===y.qt&&O.id===y.id){je.defc="1";ee=""}var ht=ce?ce.childCount:0;O.name=ee;O.displayName=te||"".concat(ee).concat(ie);s.estimatedResultCount&&(ht=Re.length+(s.folder&&s.folder.startIndex||0));if(s.isRecycled&&s.folder&&!ht){ht=Re.length;O.childCount=ht}fe.newTag=this.getNewTagIfExists({tags:se});fe.autoAlbumTag=this.getAutoAlbumTagIfExists({isAlbum:Ee,tags:se});var pt=[A];u&&n&&pt.push(n);e.keyAlias&&pt.push(e.keyAlias);var dt=!0;"allmyphotos"===y.qt&&O.id===y.id&&(dt=!1);fe.commandsSupported=q.e.replace(je);O.properties=fe;for(var vt=0,mt=Object(I.e)(pt);vt<mt.length;vt++){var gt=mt[vt];v.update([new q.t(gt).succeed({item:dt?O:{key:A}})])}var yt=s.hasMoreResults?""+s.estimatedResultCount:"";"search"===y.qt&&s.folder&&s.folder.pagingToken&&(yt=s.folder.pagingToken);s.isRecycled&&s.folder&&s.folder.hasMoreRecycledItems&&(yt=s.folder.pagingToken);return{item:{key:A},children:Re,groupings:Ue,totalChildren:ht,nextRequestToken:yt}}};t.prototype.getAutoAlbumTagIfExists=function(e){var t=null;if(!e.isAlbum)return t;var n=e.tags;if(n)for(var r=0,i=n;r<i.length;r++){var s=i[r];if(s.tag===F.e){t=s;break}}return t};t.prototype.getNewTagIfExists=function(e){var t=e.tags,n=null;if(t)for(var r=0,i=t;r<i.length;r++){var s=i[r];if(s.tag===F.t){n=s;break}}return n};t.prototype.getItemKey=function(e){var t,n,r,s,o,u=e.itemFromServer,a=e.requestKey,f=this._urlDataSource.getKeyParams(a);if(u.isAlbumRoot)o=this._urlDataSource.getKey(((t={}).id="albums",t.tagFilter=f.tagFilter,t));else if(u.isTagsRoot)o=this._urlDataSource.getKey(((n={}).id="tags",n));else{var l=this._getItemKeyExtension(u,a),c=u.ownerCid,h=u.internalPath,p=void 0===h?[]:h,d=this._getNormalizedId(u),v=this._urlDataSource.isCurrentQuery(E.e.SharedWithMe,f);if(v&&"1209427492"===u.ownerDCid&&"0000000048166624"===u.ownerCid){d="1209427492";c="0000000048166624"}o=this._urlDataSource.getKey(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},l),((r={}).id=d,r.cid=c,r.internalPath=p.join(","),r)),Object(P.isFeatureEnabled)(P.AttachGroupIdToSharedByKey)&&v&&u.groupId?((s={}).u="group_".concat(u.groupId),s):{}))}return o};t.prototype._generateOpenUrlForFluidFile=function(e,t,n){var r=Object(P.isFeatureEnabled)(P.UseFluidDevPreview)?"https://dev.fluidpreview.office.net/p":"https://fluidpreview.office.net/p",i=encodeURIComponent(btoa("spo:https://api.onedrive.com")),s=encodeURIComponent(e),o=encodeURIComponent(t),u=encodeURIComponent(n);return"".concat(r,"/").concat(i,"/").concat(o,"/").concat(u,"/").concat(s)};t.prototype._getDefaultSubText=function(e,t,n){var r;switch(e){case h.e.Owner:r=t===v.e.Private?"":w.l;break;case h.e.View:r=w.t;break;case h.e.Edit:case h.e.CoOwner:r=w.e;break;default:r=""}return r};t.prototype._getItemType=function(e,t){return e.isPlaceholder?d.e.Folder:17===e.itemType?d.e.OneNote:e.folder?d.e.Folder:e.video||e.photo||e.audio?d.e.Media:t||this._isTextEditorFile(e)||this._isFluidFile(e)?d.e.File:e.thumbnailSet?d.e.Media:d.e.File};t.prototype._isFluidFile=function(e){return!!e.extension&&(".fluid"===e.extension.toLowerCase()||".loop"===e.extension.toLowerCase())};t.prototype._isTextEditorFile=function(e){return Object(R.t)(e.extension||"")};t.prototype._getItemKeyExtension=function(e,t){var n,r=this._urlDataSource.getKeyParams(t);return r.id===e.id?r:e.folder?((n={}).ft=r.ft,n.ext=r.ext,n):{}};t.prototype._getRootItemTitle=function(e){return a.e};t.prototype._getNormalizedId=function(e){return e.id&&e.id.indexOf("!")>=0?e.id.toUpperCase():e.id};t.prototype._getParentKey=function(e,t){var n,r,i=t.requestKeyParams;e.isRecycled&&"root"!==e.id?r=this._urlDataSource.getRootItemKey(E.e.RecycleBin):e.isSharerFolder?r=this._urlDataSource.getRootItemKey(E.e.SharedWithMe):e.isAlbumRoot?r=void 0:e.parentId&&(r=this._urlDataSource.getKey(((n={}).id=e.parentId,n.cid=e.ownerCid,n.ft=i.ft,n.ext=i.ext,n)));return r};t.prototype._getVirtualItemType=function(e){var t;e.isAlbumRoot?t=p.e.AlbumRoot:e.isAlbum?t=p.e.Album:e.isTagsRoot&&(t=p.e.TagsRoot);return t};t.prototype._getIsRootFolder=function(e,t){var n=t.isPhotosSubRoot;return("root"===e.id||e.isAlbumRoot)&&!n};t.prototype._isPhotosRoot=function(e,t){var n=t.requestKeyParams;return"allmyphotos"===n.qt&&e.id===n.id};t.prototype._isPhotosSubRoot=function(e,t){var n=t.requestKeyParams;return t.isPhotosRoot&&(!!n.tagFilter||!!n.locationFilter)};t.prototype._getItemLifeCycleStatus=function(e){var t={};this._isItemLifeCycleStatusNew(e.dateCreatedTime)&&(t.isNew=!0);return t};t.prototype._isItemLifeCycleStatusNew=function(e){var t=(new Date).getTime(),n=e&&e.valueOf();return!isNaN(n)&&t-n<1728e5};return t})(s.n);var Y=n(18),Z=n(447),ee=n(33),te=n(136),ne=n(229),re=n(13),ie=n(67);function se(e,t,n){void 0===n&&(n={});var r;if(n){var s=(function(e,t){var n,r=t.consume(ie.e).isMobile&&!!t.consume(re.w.optional),s=Object(i.__assign)(Object(i.__assign)({},ue("type","","FileTypeIcon",!1)),{minWidth:r?48:16,width:r?48:16,isIcon:!0,fieldType:te.e.FileIcon}),o=fe(!0),u=he(!0),a=le(),l=ae(!0),c=Object(i.__assign)(Object(i.__assign)({},ue("_shareHeroCommand","","_shareHeroCommand",!1)),{isIcon:!0,minWidth:16,width:16,fieldType:te.e.ShareCommand}),h=fe(!1),p=he(!1),d=ae(!1),v=Object(i.__assign)(Object(i.__assign)({},ue("dateTaken",ne.informationDateTaken,"dateTaken",!0)),{fieldType:te.e.DateTime}),m=r?oe(s,[[o],[u,l,a]],Object(i.__spreadArray)(Object(i.__spreadArray)(Object(i.__spreadArray)(Object(i.__spreadArray)([],"userArranged"===e?[ce()]:[],!0),[o,u],!1),"dateTaken"===e?[v]:[],!0),[l,a],!1)):Object(i.__spreadArray)(Object(i.__spreadArray)(Object(i.__spreadArray)(Object(i.__spreadArray)(Object(i.__spreadArray)(Object(i.__spreadArray)([],"userArranged"===e?[ce()]:[],!0),[s,o],!1),[c],!1),[u],!1),"dateTaken"===e?[v]:[],!0),[a,l],!1),g=r?oe(s,[[o],[u,l,a]],[o,u,v,l,a]):Object(i.__spreadArray)(Object(i.__spreadArray)(Object(i.__spreadArray)(Object(i.__spreadArray)([],"userArranged"===e?[ce()]:[],!0),[s,o],!1),[c],!1),[u,v,a,l],!1),y=Object(i.__assign)(Object(i.__assign)({},ue("dateAccessed",f.n,"dateAccessed",!0)),{fieldType:te.e.DateTime}),b=Object(i.__assign)(Object(i.__assign)({},ue("location",f.r,"",!1)),{showTooltip:!0}),w=r?oe(s,[[o],[y,l,a]],[o,y,l,a]):[s,o,y,u,b,l],S=le(),x=[s,o,S,l],T=[s,o,S,l],N=r?oe(s,[[h],[p,d,a]],[h,p,d,a]):[s,h,a,p,b,d],C=Object(i.__assign)(Object(i.__assign)({},ue("location",f.o,"location",!0)),{width:300,showTooltip:!0}),k=Object(i.__assign)(Object(i.__assign)({},ue("dateDeleted",f.t,"dateDeleted",!0)),{fieldType:te.e.DateTime}),L=r?oe(s,[[o],[l,k,C]],[o,k,l,C]):[s,o,C,k,l];return(n={})[E.e.Files]=m,n[E.e.Photos]=g,n[E.e.Recent]=w,n[E.e.SharedWithMe]=x,n[E.e.DocsInCommon]=T,n[E.e.Search]=N,n[E.e.RecycleBin]=L,n})(n.defaultSortField,t);e.type===d.e.Folder&&(r=s[e.displayType]||s[E.e.Files]);r&&(r=r.map(function(e){return Object(i.__assign)(Object(i.__assign)({},e),n.isSortEnabled?(e.internalName||e.key)===n.sortField?{isSorted:!0,isAscending:n.isAscending}:{isSorted:!1}:{sortable:!1})}))}return r}function oe(e,t,n){for(var r=[],s=0;s<t.length;s++)for(var o=0,u=t[s];o<u.length;o++){var a=u[o];r.push(Object(i.__assign)(Object(i.__assign)({},a),{customRowNumber:s}))}for(var f=[e,Object(i.__assign)(Object(i.__assign)({},ue("","","",!1)),{width:900,customFields:r})],l=0,c=n;l<c.length;l++){var h=c[l];f.push(Object(i.__assign)(Object(i.__assign)({},h),{isVisible:!1,isVisibleMobile:!1}))}return f}function ue(e,t,n,r,i){return{key:e,name:t,internalName:n,minWidth:90,width:130,isVisible:!0,isVisibleMobile:!0,isCollapsable:!0,sortable:r,isSorted:!1,isIcon:!1,isHtml:!1,isAscending:!0,fieldType:te.e.Text,filterable:!1,isFocused:Y.observable(!1)}}function ae(e){return Object(i.__assign)(Object(i.__assign)({},ue("size",f.a,"size",e)),{isHtml:!0,fieldType:te.e.FileSize,sortable:e})}function fe(e){return Object(i.__assign)(Object(i.__assign)({},ue("displayName",f.s,"displayName",e)),{isCollapsable:!1,minWidth:220,width:440,fieldType:te.e.Name,sortable:e,hasListItemMenu:!0})}function le(){return Object(i.__assign)(Object(i.__assign)({},ue("defaultSubText",f.u,"",!1)),{fieldType:te.e.Shared})}function ce(){return Object(i.__assign)(Object(i.__assign)({},ue("",f.f,"userArranged",!0)),{isVisible:!1,isVisibleMobile:!1})}function he(e){var t=f.i;return Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},ue("dateModified",t,"dateModified",e)),{sortable:e,sortDescFirst:e,fieldType:te.e.DateTime}),"ml"==="".concat(L.e.language).toLowerCase()?{width:150}:{})}var pe=n(134),de=n(181),ve=n(196),me=n(66),ge=(function(e){Object(i.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.processError=function(e){var t,n=e.requestKey,r=e.error,i=e.itemName,s=e.observer;switch(r&&r.data&&r.data.code||0){case 101:case 102:case 103:case 152:t=me.e.authenticationExpired;break;case 161:t=me.e.mfaRequired;break;case 162:t=me.e.insufficientVaultQuota;break;case 200:t=me.e.userSuspended;break;case 201:t=me.e.userNotReady;break;case 202:t=me.e.marketBlocked;break;case 3e3:case 10009:t=me.e.accessDenied;break;case 3403:t=me.e.passwordRequired;break;case 3404:t=me.e.requestAccess;break;case 9017:break;default:t=me.e.requestFailed}var o=this.getError(r,i);s.update([new q.t(n).succeed({item:{key:n,type:d.e.Error,error:{type:t,data:o},isPlaceholder:!1,properties:{commandsSupported:{defc:"1"}}}})]);return{error:o,key:n}};t.prototype.getError=function(e,t){var n,r,i,s=e&&e.data&&e.data.code||0;switch(s){case 209:n=w.d;r=w.p;break;case 509:n=w.h;break;case 1e3:n=w.i;break;case 1006:n=w.s;break;case 2005:case 2006:n=w.f;break;case 3e3:n=w.a;r=w.u;break;case 9001:n=Object(N.o)(w.o,t);break;case 9006:n=w.c;break;default:n=w.r;r=w.n}if(161===s){i=e&&e.data&&e.data.exceptionData&&e.data.exceptionData.fixItUrl||null;this.resources.consumeAsync(B.I).then(function(e){return e.setVaultLockState({root:void 0,isLocked:!0},void 0,!0)})}return{errorCode:s,errorTitle:n,errorDetailedText:r,actionUrl:i}};return t})(s.n),ye=n(389),be=n(267),we=(function(){function e(){this._urlDataSource=this.resources.consume(B.B)}e.prototype.getDefaultGetItemContext=function(e){var t=this._urlDataSource.getCurrentItemKey(e),n=this._urlDataSource.getKeyParams(t),r=this._urlDataSource.getOwnerId(t,e),i=this._urlDataSource.getQueryType(n);return{groupingType:this._getGroupingType(r),isAscending:void 0,pageSize:this._getPageSize(i),ownerId:r,parentKey:t,queryType:i,resultSetOptions:void 0,revision:0,sortField:void 0,startIndex:0,startKey:void 0}};e.prototype._getPageSize=function(e){switch(e){case E.e.Search:return 50;default:return 100}};e.prototype._getGroupingType=function(e){var t=this._getLocalStorageValue("".concat("ItemsStoreonedrive.web.files.filesquerytype",".").concat(e.toLowerCase())),n=JSON.parse(t||"{}");return t&&n[E.e[E.e.Files]]!==be.e?0:1};e.prototype._getLocalStorageValue=function(e){try{return window.localStorage[e]}catch(e){return""}};return e})(),Ee=n(185),Se=n(36),xe=n(45),Te=n(198),Ne=n(138),Ce=(function(){function e(){this._urlDataSource=this.resources.consume(H.n);this._navigation=this.resources.consume(Se.e)}e.prototype.getFetchUrl=function(e,t,n){var r="".concat(e.sortField?ve.e[e.sortField]:ve.e.defaultValue),i=null===e.isAscending||void 0===e.isAscending?de.e.defaultValue.toString():e.isAscending?de.e.ascending.toString():de.e.descending.toString(),s=this._urlDataSource.getKeyParams(e.parentKey),o=this._urlDataSource.getQueryType(s);Object(S.e)(o)&&(e.groupingType=0);var u=1===e.groupingType?"0,1,2":"0",a={caller:x.e.viewerId,sb:n?"":r,ps:e.pageSize,sd:i,gb:u,d:"1",m:xe.e.mkt,iabch:"1",pi:"5",path:1,lct:1,rset:x.e.scenarioName,v:t};(n||Object(P.isFeatureEnabled)(P.UsePagingTokenForSearch)&&o===E.e.Search)&&(a.pagingToken=e.requestToken||"");Ne.get("BadgerAuth")||(a.urlType=0);e.startKey?a.sid=this._urlDataSource.getKeyParams(e.startKey).id:void 0!==e.startIndex&&(a.si=e.startIndex);var f=this._urlDataSource.getAuthKeyParamValue(),l=this._urlDataSource.getTicketParamValue(),c=this._urlDataSource.getReferrer();f&&(a.authKey=f);l&&(a.ticket=l);Object(S.e)(o)&&c&&(a.searchreferrer=c);if(e.filters){e.filters.tagFilter&&(a.tagFilter=e.filters.tagFilter);e.filters.locationFilter&&(a.tagFilter=e.filters.locationFilter)}var h=e.parentKey||"",p=this._urlDataSource.getKeyParams(h);delete p.u;o===E.e.Recent&&delete p.ext;Object(S.e)(o)&&!p.sp&&(a.includeSharedItems=1);if(p.sp){a.searchpassthru="sortby=largestsize";delete p.sp}n&&o===E.e.RecycleBin&&(p.qt="recyclebinv2");5!==this._urlDataSource.getAppliedDateFilter()&&delete p.endDate;return x.e.skyApiBaseUrl+"GetItems?"+O.n(p,a)};e.prototype.triggerGetItemsIfApplicable=function(e,t){var n=this._urlDataSource.getCurrentItemKey(this._navigation.viewParams),r=this._urlDataSource.getKeyParams(n);if(this._urlDataSource.getQueryType(r)===E.e.Files&&!this._navigation.viewParams.v){var i=new c.e,s=new(this.resources.injected(we)),o={};o["X-SkyApiOriginId"]=t;var u=s.getDefaultGetItemContext(this._navigation.viewParams);u.skipCache=!0;var a=this.getRequestVersion(u),f=this.getFetchUrl(u,a,!1);Ee.e.mark("Prefetch.GetItems.Started");e[f]=i.send({apiName:"GetItems",url:f,headers:o,isErrorExpectedCallback:Te.e}).then(function(e){Ee.e.mark("Prefetch.GetItems.Done");return e});this.persistResultVersion(u,a)}};e.prototype.getRequestVersion=function(e){var t=ke(e.ownerId),n=t?JSON.parse(this._getLocalStorageValue(t)||"{}"):{},r=String(Math.random()),i=this._urlDataSource.getKeyParams(e.parentKey),s=this._urlDataSource.getQueryType(i);return e.skipCache||s===E.e.RecycleBin?r:n[e.parentKey&&e.parentKey.toLowerCase()]||r};e.prototype.persistResultVersion=function(e,t){if(e.ownerId){var n=ke(e.ownerId),r=JSON.parse(this._getLocalStorageValue(n)||"{}");r[e.parentKey.toLowerCase()]=t;this._persistResultVersion(n,JSON.stringify(r))}};e.prototype.removeBrowserCacheResultVersion=function(e,t){if(e){var n=ke(e),r=JSON.parse(this._getLocalStorageValue(n)||"{}");delete r[t.toLowerCase()];this._persistResultVersion(n,JSON.stringify(r))}};e.prototype._persistResultVersion=function(e,t){try{window.localStorage[e]=t}catch(e){}};e.prototype._getLocalStorageValue=function(e){try{return window.localStorage[e]}catch(e){return""}};return e})();function ke(e){return e&&"OneDrive.GetItemsVersionLookup.".concat(e.toLowerCase())}var Le={},Ae=String(Math.random()),Oe=n(344);(function(e){Object(i.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getCapabilities=function(){return this.resources.consume(Oe.e)};t.prototype.copyItemsAsync=function(e){return this._handleMoveCopyAsyncApiRequest(e,this._getCopyItemsAsyncUrl())};t.prototype.hasMatchingId=function(e,t){return e===t.id};t.prototype._handleMoveCopyAsyncApiRequest=function(e,t){var n=new c.e,r=Me(e);return n.send({apiName:"CopyItemsAsync",url:t,requestType:"POST",postData:JSON.stringify(r),isErrorExpectedCallback:function(e){switch(e.errorCode){case 2001:return!0;default:return!1}}})};t.prototype._getCopyItemsAsyncUrl=function(){return x.e.skyApiBaseUrl+"CopyItemsAsync"}})(s.n);function Me(e){return{items:e.items.map(function(e){return e.id}),targetId:e.targetId,cid:e.cid,group:e.group,nameConflict:e.nameConflict,deleteSource:e.deleteSource,overrideLock:e.overrideLock}}var _e=n(290),De=n(121),Pe=n(472),He=n(391),Be=n(44),je=n(383),Fe=n(211),Ie=n(42),qe=n(32),Re=n(15),Ue=0,ze=(function(e){Object(i.__extends)(t,e);function t(){var t=e.call(this)||this;t._itemDataSourceHelper=new(t.managed(Ce));t.isLargeRecycleBin=Y.observable(!1);t._pendingGetItemRequests={};t._itemsStore=t.resources.consume(pe.e);t._urlDataSource=t.resources.consume(H.n);t._identity=t.resources.consume(B.h);t._itemResultProcessor=new(t.managed(G))({getRootItemTitle:t.getRootItemTitle.bind(t),getItemKeyExtension:t._getItemKeyExtension.bind(t)});t._itemErrorProcessor=new(t.managed(ge));t._rotationSemaphore=new _e.e;return t}t.getServerDocumentType=function(e){var t;switch(e){case ee.e.Word:t="w";break;case ee.e.Excel:t="x";break;case ee.e.PowerPoint:t="p";break;case ee.e.OneNote:t="n";break;case ee.e.ExcelSurvey:t="f"}return t};t.prototype.getItem=function(e){var t=this._itemDataSourceHelper.getRequestVersion(e),n=this._itemDataSourceHelper.getFetchUrl(e,t,this.isLargeRecycleBin.peek());return this._getItem(n,t,e)};t.prototype.getSpecifiedItems=function(e){return null};t.prototype.getColumns=function(e,t){void 0===t&&(t=this._getDefaultSortInformation(e.itemFromServer));return se(e,this.resources,t)};t.prototype.deleteItems=function(e){var t=this,r=this._urlDataSource.getKeyParams(e.parentKey);if(Object(Ie.e)(Be.u)&&Object(P.isFeatureEnabled)(P.UpdateOdcPhotoApiForConvergence)&&("allmyphotos"===r.qt||["places".toString(),"tags".toString()].indexOf(r.id)>=0)){var i=this.resources.consume(je.e);return new o.n(function(t,r){n.ee([139],1699).then(function(t){var n=t.deleteItems;return i.dispatch(n({items:Object(Fe.e)(e.items,function(e){return{currentItemSetKey:e.graph.itemId}},function(e){return He.e.serialize({endpoint:Object(Be.t)("v2.0"),driveId:e.graph.driveId,itemId:e.graph.itemId})})}))}).then(function(){t(e.items.map(function(e){return e.graph.itemId}))}).catch(function(e){r(e)})})}var s=e.items;s&&s[0].key&&!s[0].id&&(s=s.map(function(e){return t._itemsStore.getItem(e.key).peek()}));return l.e.start({apiName:"DeleteItems",url:this._getDeleteItemsUrl(),batchSize:100,items:s,getPostData:function(t){return{deletionType:e.deletionType?e.deletionType:Z.e.Recycle,targetId:r.id,cid:x.e.viewerId,group:0,overrideLock:!!e.overrideLock,items:t.map(function(e){return e.id})}},isErrorExpectedCallback:function(e){switch(e.errorCode){case 3e3:case 9001:return!0;default:return!1}},onBatchComplete:function(e){for(var t=0,n=e;t<n.length;t++){n[t].eTag=""}}})};t.prototype.renameItem=function(e){var t=this,r=this._urlDataSource.getKeyParams(e.parentKey),i=e.item.name,s=e.newName+e.item.extension,u=e.item.extension;if(e.nameHasExtension){var a=e.newName.lastIndexOf(".");if(a>0){u=e.newName.substr(a+1);Array.isArray(xe.t.createTextDocumentExts)&&xe.t.createTextDocumentExts.indexOf(u)>=0&&(s=e.newName)}}if(Object(Ie.e)(Be.u)&&Object(P.isFeatureEnabled)(P.UpdateOdcPhotoApiForConvergence)&&("allmyphotos"===r.qt||["places".toString(),"tags".toString()].indexOf(r.id)>=0)){var f=this.resources.consume(je.e),l=He.e.serialize({endpoint:Object(Be.t)("v2.0"),driveId:e.item.graph.driveId,itemId:e.item.graph.itemId});return new o.n(function(t,r){return n.ee([140],1700).then(function(t){var n,r,i=t.renameItem;return f.dispatch(i({items:(n={},n[l]={names:(r={},r[e.item.name]={newName:e.newName,newExtension:u},r)},n)}))}).then(function(){t(e.newName)}).catch(function(e){r(e)})})}var h=this._getUpdateItemsUrl(),p=new c.e,d=JSON.stringify({id:e.item.properties.ghostId||e.item.id,name:s,lid:r.id,rset:x.e.scenarioName,ownerId:e.ownerId});return p.send({apiName:"UpdateItem",url:h,requestType:"POST",postData:d,isErrorExpectedCallback:this._isErrorExpected}).then(function(n){if(t.resources.consume(De.t)){var r=e.item.id;e.item.isAlbum&&void 0!==r&&t.resources.consumeAsync(Pe.e).then(function(e){e.invalidateAlbumName(r)})}return n},function(e){return o.n.wrapError(t._itemErrorProcessor.getError(e,i).errorTitle)})};t.prototype.getOpenInClientDetails=function(e){var t=this._getOpenInClientDetailsUrl()+"?id="+e.id;return(new c.e).send({apiName:"GetOpenInClientDetails",url:t})};t.prototype.saveSortOrder=function(e){var t=this._getUpdateItemsUrl(),n=new c.e,r=JSON.stringify({id:e.item.id,sortOrder:e.sortOrder,sortDirection:e.sortDirection,cid:x.e.viewerId});return n.sendPost("UpdateItem",t,r)};t.prototype.reportAbuse=function(e){var t=this,n=this._getReportAbuseUrl(),r=new c.e,i=JSON.stringify({rao:e.rao,id:e.item.id,ownerName:e.item.ownerName,ownerCid:e.item.ownerId,itemName:e.item.name,urls:e.item.urls,cid:x.e.viewerId,group:0,desc:e.desc,ref:window.location.href,photoStreamId:e.photoStreamId,postId:e.postId,reportContentType:e.reportContentType||ye.n.File});return r.send({apiName:"ReportAbuse",url:n,requestType:"POST",postData:i,isErrorExpectedCallback:this._isErrorExpected}).then(null,function(e){return o.n.wrapError(t._itemErrorProcessor.getError(e).errorTitle)})};t.prototype.requestReview=function(e){var t=this,n=this._getRequestReviewUrl(),r=window.$Config,i=new c.e,s=JSON.stringify({email:r.email,ids:e.items.map(function(e){return e.id}),photoStreamId:e.photoStreamId,postId:e.postId,reportContentType:e.reportContentType||ye.n.File});return i.send({apiName:"OwnerRequestReview",url:n,requestType:"POST",postData:s,isErrorExpectedCallback:this._isErrorExpected}).then(null,function(e){return o.n.wrapError(t._itemErrorProcessor.getError(e).errorTitle)})};t.prototype.updateBundle=function(e){var t=this,n=this._getUpdateBundleUrl(),r=new c.e,i=JSON.stringify({bundleId:e.item.id,bundleAction:e.bundleAction,items:e.items});return r.send({apiName:"UpdateBundle",url:n,requestType:"POST",postData:i,isErrorExpectedCallback:this._isErrorExpected}).then(null,function(e){return o.n.wrapError(t._itemErrorProcessor.getError(e).errorTitle)})};t.prototype.removeFromSharedList=function(e){var t=this._getRemoveFromSharedListUrl(),n=new c.e,r=JSON.stringify({items:e.items.map(function(e){return e.id}),markAsSpam:e.markAsSpam});return n.sendPost("AbdicatePermissions",t,r)};t.prototype.addCoverPhotos=function(e){var t=this._getAddCoverPhotoUrl(),n=new c.e,r=e.items.map(function(e){return e.id}),i=JSON.stringify({items:r,targetId:e.target.id,cid:x.e.viewerId,group:e.target.isGroup?1:0});return n.sendPost("AddFavorites",t,i)};t.prototype.removeCoverPhotos=function(e){var t=this._getRemoveCoverPhotoUrl(),n=new c.e,r=e.items.map(function(e){return e.id}),i=JSON.stringify({items:r,targetId:e.target.id,cid:x.e.viewerId,group:e.target.isGroup?1:0});return n.sendPost("RemoveFavorites",t,i)};t.prototype.changeFolderType=function(e){var t=this._getUpdateItemsUrl(),n=new c.e,r=JSON.stringify({id:e.item.id,category:e.category,cid:x.e.viewerId});return n.sendPost("UpdateItem",t,r)};t.prototype.updateItemProperty=function(e){var t,n,r=this._getUpdateItemsUrl(),i=new c.e;Object(P.isFeatureEnabled)(P.UseItemsScopeInOneDrive)&&(n=O.e(e.item.parentKey));var s={id:e.item.id,lid:(null===(t=e.item.UNSAFE_parent)||void 0===t?void 0:t.id)||(null==n?void 0:n.id),overrideLock:(!!e.overrideLock).toString(),rset:x.e.scenarioName};s[e.propertyName]=e.propertyValue||"";var o=e.qosPostfix?"UpdateItem_"+e.qosPostfix:"UpdateItem";return i.sendPost(o,r,JSON.stringify(s))};t.prototype.createFolder=function(e){var t=this,n=this._getCreateFolderUrl(),r=this._urlDataSource.getKeyParams(e.parent.key),i=new c.e,s=[];if(e.selectedPeople&&e.selectedPeople.length>0)for(var u=0,a=e.selectedPeople;u<a.length;u++){var f=a[u];s.push({role:2,type:0,email:f.email})}var l={ownerCid:this._identity.getIdentity().id,message:e.sharingNote,requireSignIn:!0,entities:s},h=JSON.stringify({parentId:r.id,cid:r.cid,group:0,name:e.folderName,permissionsInfo:e.selectedPeople&&e.selectedPeople.length>0?l:null,doNotRollbackOnPartialPermissionsError:!0,sendShareNotification:!0});return i.send({apiName:"AddFolder",url:n,requestType:"POST",postData:h,isErrorExpectedCallback:this._isErrorExpected}).then(function(n){n=n.items||n.item;var r=new(t.resources.consume(q.r)),i=t._getItemResult({requestKey:e.parent.key,itemFromServer:n,queryType:E.e.Files,keyAlias:e.keyAlias,isPrimaryRequestedItem:!0,observer:r});r.flush();return i?r.getItem({key:i.item.key}):null},function(e){return o.n.wrapError(t._itemErrorProcessor.getError(e).errorTitle)})};t.prototype.createDocument=function(e,n,r){var i=this;if(n===ee.e.Text)return o.n.wrap(this._createTextDocument(e));var s=this._getCreateDocumentUrl(),u=t.getServerDocumentType(n),a=new c.e,f=this._urlDataSource.getKeyParams(e),l=JSON.stringify({parentId:f.id,nameConflict:r?0:2,overrideLock:!1,cid:f.cid,group:0,name:r,docType:u});return a.send({apiName:"CreateDocument",url:s,requestType:"POST",postData:l,isErrorExpectedCallback:this._isErrorExpected}).then(function(t){var r="";if((t=t.items||t.item)&&t.length>0){var s=new(i.resources.consume(q.r)),o=i._getItemResult({requestKey:e,itemFromServer:t[0],queryType:E.e.Files,isPrimaryRequestedItem:!0,observer:s});s.flush();r=(r=s.getItem({key:o.item.key}).openUrl.replace("redir.aspx","edit.aspx")).replace("&page=view","");n===ee.e.OneNote&&(r+="&nd=1")}return r},function(e){return o.n.wrapError(i._itemErrorProcessor.getError(e).errorTitle)})};t.prototype.createCustomDocument=function(e,t,n){return null};t.prototype.createShortcut=function(e,t,n){return null};t.prototype._createTextDocument=function(e){var t=this._urlDataSource.getKeyParams(e);return this.resources.consume(H.n).getCreateTextDocumentUrl(t.id,t.cid)};t.prototype.createDocumentInTab=function(e,n,r){var i,s=t.getServerDocumentType(e);if(e===ee.e.Text)i=this._createTextDocument(n.key);else{i=this.resources.consume(H.n).getCreateDocumentInTabUrl(n,s,r)}return i};t.prototype.getFilterData=function(e,t,n){return null};t.prototype.restoreItems=function(e){var t=this._urlDataSource.getKeyParams(e.parentKey);return l.e.start({apiName:"RestoreItems",url:this._getRestoreItemsUrl(),batchSize:100,items:e.items,isErrorExpectedCallback:function(e){switch(e.errorCode){case 1e3:case 2001:return!0;default:return!1}},getPostData:function(n){var r={targetId:t.id,cid:x.e.viewerId,group:0,items:n.map(function(e){return e.id}),recycleBinItems:n.map(function(e){return{deletedFromLocation:e.location===f.e?"":e.location,id:e.id,name:e.extension?e.name+e.extension:e.name}}),retainAcls:e.retainAcls||!1};e.nameConflict&&(r.nameConflict=e.nameConflict);return r}})};t.prototype.restoreAll=function(e){var t=this._getRestoreAllUrl(),n=new c.e;return new o.n(function(e,r){n.sendPost("RestoreAll",t,"").then(function(){e(!0)},r)})};t.prototype.copyItems=function(e){return this._handleMoveCopyApiRequest("CopyItems",e,this._getCopyItemsUrl())};t.prototype.moveItems=function(e){return this._handleMoveCopyApiRequest("MoveItems",e,this._getMoveItemsUrl())};t.prototype.removeFromRecent=function(e){for(var t,n=this._getRemoveFromRecentUrl(),r=new c.e,i=[],s=0;s<e.items.length;s++)i.push(e.items[s].id);t=JSON.stringify({items:i});return r.sendPost("RemoveFromMRU",n,t)};t.prototype.removeMountPoint=function(e){var t,n=this._getRemoveMountPointUrl(),r=new c.e;t=JSON.stringify({id:e.item.properties.ghostId||e.item.id});return r.sendPost("RemoveMountPoint",n,t)};t.prototype.createMountPoint=function(e){var t,n=this,r=this._getCreateMountPointUrl(),i=new c.e,s=this._urlDataSource.getAuthKeyParamValue();t=JSON.stringify({isMountPoint:1,sourceResourceId:e.item.id,nameConflict:1,authKey:s});return i.sendPost("MountFolder",r,t).then(function(e){var t=new(n.resources.consume(q.r)),r=e?n._getItemResult({requestKey:"",itemFromServer:e.item,queryType:E.e.Files,isPrimaryRequestedItem:!0,observer:t}).item:null;t.flush();return r?t.getItem({key:r.key}):null},function(e){return o.n.wrapError(e)})};t.prototype.getWorkProgress=function(e){var t=this._getWorkProgressUrl(e),n=new c.e;return(e.workItemIds?n.sendPost("GetWorkProgress",t,JSON.stringify({workItemIds:e.workItemIds})):n.send({apiName:"GetWorkProgress",url:t})).then(function(e){return Object(i.__assign)(Object(i.__assign)({},e),{progress:e.progress.map(function(e){var t,n,r;if("Completed"===e.status){var s=e.targetResourceId;if(s){var o=Object(qe.t)(((t={}).id=s,t));r={key:Object(Re.v)(((n={}).cid=o,n.id=s,n))}}}return Object(i.__assign)(Object(i.__assign)({},e),{createdItem:r})})})})};t.prototype.cancelWork=function(e){var t=this._getCancelWorkUrl();(new c.e).sendPost("CancelWork",t,JSON.stringify(e));return o.n.wrap(!0)};t.prototype.getItemOcrTextContent=function(e){var t=new c.e,n=JSON.stringify({ids:[e.id],streamName:"TextContent"});return t.sendPost("Download",x.e.skyApiBaseUrl+"GetDownloadUrl",n).then(function(e){var t=e.DownloadUrl||e.items&&e.items[0]&&e.items[0].downloadUrl;return u.e.start({url:t,json:null}).then(function(e){var t=window.DOMParser,n=(t&&(new t).parseFromString(e.responseText,"text/xml")).querySelector("c");return n&&n.textContent})})};t.prototype.updateItemOcrInfo=function(e,t,n){var r,i=this._getUpdateItemsUrl(),s=new c.e,o=JSON.stringify({eTag:e.eTag,id:e.id,textContent:t||"",entityTags:n,lid:null===(r=e.UNSAFE_parent)||void 0===r?void 0:r.id,rset:x.e.scenarioName});return s.sendPost("UpdateItem",i,o)};t.prototype.processReferral=function(e,t){var n=this._getProcessReferralUrl(),r=new c.e,i={inviterId:e};t&&""!==t&&(i.inviteSrc=t);return r.sendPost("ProcessReferral",n,JSON.stringify(i))};t.prototype.rotateItems=function(e){for(var t=this,n=new(this.resources.consume(q.r)),r=this._getRotateItemUrl(),s=[],u=function(u){var f=a.peekUnwrapObservable(a._itemsStore.getItem(u.key)),l=++Ue;if(f.thumbnail){var h=f.orientedThumbnail;h=h?Object(i.__assign)(Object(i.__assign)({},h),{rotation:h.rotation+e.rotation,version:l}):{rotation:e.rotation,thumbnail:Object(i.__assign)({},f.thumbnail),version:l};n.update([new q.t(u.key).succeed({item:{key:u.key,orientedThumbnail:q.e.replace(h)}})])}var p=new c.e,d=JSON.stringify({targetId:u.id,numberOfClockwiseRotations:-e.rotation,cid:x.e.viewerId,rset:x.e.scenarioName});s.push(a._rotationSemaphore.enqueue(function(){return p.sendPost("ChangeImageOrientation",r,d).then(function(e){var r=t.peekUnwrapObservable(t._itemsStore.getItem(u.key)),i=r.itemFromServer&&r.itemFromServer.commands;e.item.commands=i||e.item.commands;t._itemResultProcessor.processItemResult({observer:n,itemFromServer:e.item,isPrimaryRequestedItem:!0,skipSettingChildren:!0,requestKey:u.key});var s=r.orientedThumbnail;s&&s.version===l&&n.update([new q.t(u.key).succeed({item:{key:u.key,orientedThumbnail:q.e.remove()}})]);return r},function(r){var i=t.peekUnwrapObservable(t._itemsStore.getItem(u.key)).orientedThumbnail;if(i){i=i.version===l?q.e.remove():{rotation:i.rotation-e.rotation};n.update([new q.t(u.key).succeed({item:{key:u.key,orientedThumbnail:i}})])}var s=new Error(r.data.message);s.data={key:u.key,error:r.data};return o.n.wrapError(s)})}))},a=this,f=0,l=e.items;f<l.length;f++){u(l[f])}n.flush();return o.n.all(s).then(function(e){n.flush();if(t.resources.consume(De.t))for(var r=function(e){var n=O.e(e.key);t.resources.consumeAsync(B.v).then(function(e){e.invalidateItems(O.n(n))})},i=0,s=e;i<s.length;i++){r(s[i])}return e.map(function(e){var n=t.peekUnwrapObservable(t._itemsStore.getItem(e.key));n&&n.UNSAFE_parent&&t._itemDataSourceHelper.removeBrowserCacheResultVersion(n.ownerId,n.UNSAFE_parent.key);return n})},function(e){n.flush();var t=new Error;t.data=Object.keys(e).map(function(t){return e[t].data});return o.n.wrapError(t)})};t.prototype.redeemPermissionToken=function(e){var t=this._urlDataSource.getAuthKeyParamValue(),n=this._getRedeemPermissionTokenUrl(),r=new c.e,i={id:e.item.id,authKey:t};return r.sendPost("RedeemPermissionToken",n,JSON.stringify(i))};t.prototype.updateViewCount=function(e){var t=e.items.filter(function(e){return e.ownerId!==x.e.viewerId});return 0===t.length?o.n.wrap(null):l.e.start({apiName:"UpdateViewCount",url:this._getUpdateViewCountUrl(),batchSize:100,items:t,getPostData:function(e){return{cid:x.e.viewerId,ids:e.map(function(e){return e.id})}}})};t.prototype.getRootItemTitle=function(e){return a.e};t.prototype._getRootFileId=function(){return"root"};t.prototype._getParentItemId=function(){return""};t.prototype._getItemKeyExtension=function(e,t){var n,r=this._urlDataSource.getKeyParams(t);return r.id===e.id?r:e.folder?((n={}).ft=r.ft,n.ext=r.ext,n):{}};t.prototype._handleMoveCopyApiRequest=function(e,t,n){for(var r,s=new c.e,u=t.items.map(function(e){return e.id}),a=Me(t),f=[],l=new _e.e,h=function(){var o=u.splice(0,100);a.items=o;var c=JSON.stringify(a);!1!==t.ackMoveIfShared&&(r={prefer:"Block-Move-Into-Vault-If-Shared"});var h=l.enqueue(function(){return s.send({apiName:e,url:n,requestType:"POST",headers:r,postData:c,isErrorExpectedCallback:function(e){switch(e.errorCode){case 1e3:case 1007:case 1012:case 2028:case 2029:return!0;case 3e3:case 3e3:case 9001:return!0}}}).then(function(e){return e},function(e){return e.data&&e.data.items?e.data:{items:[Object(i.__assign)(Object(i.__assign)({},e),{error:e.data})]}})});f.push(h)};u.length;)h();return o.n.all(f).then(function(e){var t=e.map(function(e){return e.items});return{items:[].concat.apply([],t)}})};t.prototype._getItem=function(e,t,n){var r,s=this,u=String(Math.random()),a=((r={})["X-SkyApiOriginId"]=u,r),f=this._pendingGetItemRequests[e];if(!f){var l=Le[e];if(l){u=Ae;delete Le[e]}var h=void 0;h=!T.e.isActivated("4AE305A7-991F-4556-87DE-C1DDF1D5F01A","10/21/2021","Override invalid SkyAPI root item request")&&this._isInvalidRootItemRequest(e)?this._getMockItemNotFoundResponse(e):!n.skipCache&&l||(new c.e).send({apiName:"GetItems",qosName:n.qosName,url:e,headers:a,isErrorExpectedCallback:Te.e});var p=!1;f=h.then(function(r){p=!0;Ee.e.mark("ItemsDataSource.GetItems.Normalizing");var o,a=r.originId,f=r.items||r.item&&[r.item]||[];if(f&&f.length>0){for(var l=new(s.resources.consume(q.r)),c=void 0,h=f.length-1;h>=0;h--){var v=0===h;if(!f[0].isBundle||v){var m=h>0,g=s._getItemResult({observer:l,requestKey:n.parentKey,itemFromServer:f[h],queryType:n.queryType,requestMetadata:{tokenNeedsRedeeming:r.tokenNeedsRedeeming,tokenType:r.tokenType,restoreAllWorkItemCount:r.restoreAllWorkItemCount||0,deleteAllWorkItemCount:r.deleteAllWorkItemCount||0},setItemKey:!m,skipSettingChildren:m,isPrimaryRequestedItem:v});v&&(c=g)}}l.flush();if(c&&c.item){var y=l.getItem({key:c.item.key}),b=f[0],w=s._getDefaultSortInformation(b);if(n.sortField){var E=w&&w.defaultSortField;w={sortField:n.sortField,defaultSortField:E,isAscending:n.isAscending,isSortEnabled:!s.isLargeRecycleBin.peek()}}var S=void 0;w&&(S=w.isAscending);var x=a!==u;x||y.type!==d.e.Folder||s._itemDataSourceHelper.persistResultVersion(n,t);var T=se(y,s.resources,w),N=void 0;if(T&&w)for(var C=0,k=T;C<k.length;C++){var L=k[C];if(L.internalName===w.sortField){N=L.key;break}}o=Object(i.__assign)(Object(i.__assign)({},c),{schema:T,startIndex:b.folder?b.folder.startIndex:n.startIndex,isFromBrowserCache:x,sortField:N,isAscending:S})}}delete s._pendingGetItemRequests[e];return o},function(t){delete s._pendingGetItemRequests[e];var r=new(s.resources.consume(q.r)),i=s._itemErrorProcessor.processError({requestKey:n.parentKey,error:t,observer:r}).error;r.flush();return o.n.wrapError(i)});p||(this._pendingGetItemRequests[e]=f)}return f};t.prototype._isErrorExpected=function(e){switch(e.errorCode){case 209:case 509:case 1e3:case 1006:case 2006:case 3e3:case 9001:case 9006:case 3403:return!0;default:return!1}};t.prototype._getDefaultSortInformation=function(e){var t;e&&e.folder&&e.folder.defaultSort&&e.folder.defaultSortDirection&&Object.keys(ve.e).length/2>e.folder.defaultSort&&(t={sortField:ve.e[e.folder.defaultSort],defaultSortField:ve.e[e.folder.defaultSort],isAscending:e.folder.defaultSortDirection.toString()===de.e.ascending.toString(),isSortEnabled:!0});return t};t.prototype._getItemResult=function(e){return this._itemResultProcessor.processItemResult(e)};t.prototype._getCreateDocumentUrl=function(){return x.e.skyApiBaseUrl+"CreateDocument"};t.prototype._getCreateFolderUrl=function(){return x.e.skyApiBaseUrl+"AddFolder?lct=1"};t.prototype._getDeleteItemsUrl=function(){return x.e.skyApiBaseUrl+"DeleteItems"};t.prototype._getUpdateViewCountUrl=function(){return x.e.skyApiBaseUrl+"UpdateViewCount"};t.prototype._getRestoreItemsUrl=function(){return x.e.skyApiBaseUrl+"RestoreItems"};t.prototype._getOpenInClientDetailsUrl=function(){return x.e.skyApiBaseUrl+"GetOpenInClientDetails"};t.prototype._getRequestReviewUrl=function(){return x.e.skyApiBaseUrl+"OwnerRequestReview"};t.prototype._getReportAbuseUrl=function(){return x.e.skyApiBaseUrl+"ReportAbuse"};t.prototype._getRemoveFromSharedListUrl=function(){return x.e.skyApiBaseUrl+"AbdicatePermissions"};t.prototype._getAddCoverPhotoUrl=function(){return x.e.skyApiBaseUrl+"AddFavorites"};t.prototype._getRemoveCoverPhotoUrl=function(){return x.e.skyApiBaseUrl+"RemoveFavorites"};t.prototype._getUpdateItemsUrl=function(){return x.e.skyApiBaseUrl+"UpdateItem?lct=1"};t.prototype._getUpdateBundleUrl=function(){return x.e.skyApiBaseUrl+"UpdateBundle"};t.prototype._getCopyItemsUrl=function(){return x.e.skyApiBaseUrl+"CopyItemsAsync"};t.prototype._getMoveItemsUrl=function(){return x.e.skyApiBaseUrl+"MoveItems"};t.prototype._getRemoveFromRecentUrl=function(){return x.e.skyApiBaseUrl+"RemoveFromMRU"};t.prototype._getRemoveMountPointUrl=function(){return x.e.skyApiBaseUrl+"RemoveMountPoint"};t.prototype._getCreateMountPointUrl=function(){return x.e.skyApiBaseUrl+"AddFolder"};t.prototype._getRestoreAllUrl=function(){return x.e.skyApiBaseUrl+"RestoreAll"};t.prototype._getWorkProgressUrl=function(e){return x.e.skyApiBaseUrl+"GetWorkProgress?type="+e.type};t.prototype._getRotateItemUrl=function(){return x.e.skyApiBaseUrl+"ChangeImageOrientation"};t.prototype._getCancelWorkUrl=function(){return x.e.skyApiBaseUrl+"CancelWork"};t.prototype._getProcessReferralUrl=function(){return x.e.skyApiBaseUrl+"ProcessReferral"};t.prototype._getRedeemPermissionTokenUrl=function(){return x.e.skyApiBaseUrl+"RedeemPermissionToken"};t.prototype._isInvalidRootItemRequest=function(e){var t=new URL(e);return"root"===t.searchParams.get("id")&&t.searchParams.has("caller")&&t.searchParams.has("cid")&&!x.e.areCidsEqual(t.searchParams.get("caller"),t.searchParams.get("cid"))};t.prototype._getMockItemNotFoundResponse=function(e){return o.n.reject({message:"Promise failed without error handler",url:e,status:500,data:{code:3e3,debugMessage:"Item not found or access denied.",isExpected:!0,message:"This item might have been deleted, expired, or you might not have permission to access it. Contact the owner of this item for more information.",stackTrace:""}})};return t})(s.n);t.e=ze},,function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n(0),i=n(18),s=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.memoryContent=i.observable(null);n.serverContent=i.observable(null);n.outDated=i.observable(!1);n.isEditable=i.observable(!1);n.hasConflict=n.createPureComputed(n._computeHasConflict);n.hasPendingSave=n.createPureComputed(n._computeHasPendingSave);n.hasChanges=n.createPureComputed(n._computeHasChanges);n._lastSaved=i.observable(null);n._pendingSave=i.observable(null);return n}t.prototype.startingSave=function(){this.hasPendingSave.peek()||this._pendingSave(this.memoryContent.peek().text)};t.prototype.saveFailed=function(){this.hasPendingSave.peek()&&this._pendingSave(null)};t.prototype.saveSucceded=function(){if(this.hasPendingSave.peek()){this.updateETag=!0;this._lastSaved(this._pendingSave.peek());this._pendingSave(null)}};t.prototype._computeHasPendingSave=function(){return!!this._pendingSave()};t.prototype._computeHasChanges=function(){var e=this.memoryContent();if(!e||"string"!=typeof e.text)return!1;var t=this._lastSaved();if(null===t){this._lastSaved(e.text);return!1}return e.text!==t};t.prototype._computeHasConflict=function(){return!!this.serverContent()};return t})(n(7).n),o=n(218),u=n(69),a=(function(){function e(e,t){this._itemContents={}}e.prototype.getItemContent=function(e){var t=e.key,n=this._itemContents,r=n[t];if(!r){r=new s;Object(o.e)(r,function(){delete n[t]});n[t]=r}return r};e.prototype.dispose=function(){this._itemContents={}};return e})(),f=Object(u.s)("ItemContentProvider",a,{})},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(219),i=new r.e("viewParamsToItemKey",{itemKey:r.t})},,,function(e,t,n){"use strict";n.d(t,"n",function(){return u});n.d(t,"t",function(){return a});var r=n(3),i=n(69),s=n(18),o=new r.t({name:"Share.key",loader:new i.t(function(){return n.ee([76,"ondemand.resx-ondemand"],662).then(function(e){return e.resourceKey.local})})});t.e=o;var u=new r.t({name:"share",factory:new r.e(s.observable())}),a=new r.t({name:"manageAccessShare",factory:new r.e(s.observable())});new r.t({name:"manageAccessAddPeople",factory:new r.e(s.observable())}),new r.t({name:"copy",factory:new r.e(s.observable([]))}),new r.t("sharingContextInformation")},,,,function(e,t,n){"use strict";var r;(function(e){e[e.normal=0]="normal";e[e.blocker=1]="blocker";e[e.vaultBlocker=2]="vaultBlocker"})(r||(r={}));t.e=r},function(e,t,n){"use strict";n.d(t,"n",function(){return r});n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r={ODB:!n(16).e.isActivated("96723D41-0476-4E60-A02D-199517143E81","11/10/2020","Allow ADAL as fallback for OAuth token requests")},i={ODB:1026},s={ODB:1977}},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(3),i=n(471),s=n(365),o=n(349),u=new r.t({name:"".concat("isOfflineStateObservable.key",".isOfflineStateObservable"),factory:{dependencies:{offlineDetection:i.e},create:function(e){var t=new s.e,n=new o.e(e.offlineDetection.offline);t.attach(e.offlineDetection.onChange(function(e){n.set(e)}));return{instance:n,disposable:t}}}})},,function(e,t,n){"use strict";var r=n(0),i=n(11),s=n(25),o=n(19),u=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.itemCommandHelper=new(n.managed(s.e));n.selectionHelper=new(n.child(o.e))(Object(r.__assign)(Object(r.__assign)({},n.getSelectionOptions(t)),{overrideItem:t.item}));return n}t.prototype.getSelectionOptions=function(e){void 0===e&&(e={});return{}};return t})(i.e);t.e=u},,function(e,t,n){"use strict";var r=n(0),i=n(11),s=n(100),o=n(6),u=n(25),a=n(87),f=n(19),l=n(13),c=n(53),h=n(10),p=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="OpenInOfficeOnline";var r=t.openLocal,i=void 0!==r&&r,s=t.forceReadOnly,a=void 0!==s&&s,p=t.useDefaultAction,d=void 0!==p&&p;n._forceReadOnly=a;n._useDefaultAction=d;n._urlDataSource=n.resources.consume(o.B);n._viewParams=n.resources.consume(l.S);n._itemSelectionHelper=new(n.child(f.e))({overrideItem:t.item});n._itemCommandHelper=n.resources.consume(u.t);n.item=n._itemSelectionHelper.firstItem;n._url=n.createPureComputed(n._computeUrl);var v=!1;h.e.isActivated("4DF83139-3BF3-4543-81F8-8AE4BF66F8B3","09/03/2018","Teams Open Office Online In-App")||(v=Object(c.n)());var m=n.resources.consume(l.e);n._navigationAction=new(n.managed(m.NavigationAction))({url:n._url,target:i||v?void 0:"_blank",postProcessUrl:function(e){return n._postProcessUrl(e)}});return n}t.prototype._postProcessUrl=function(e){return e};t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!(e&&e.openUrl&&e.appMap)&&this._itemCommandHelper.isCommandSupported(e,a.u)&&this._navigationAction.isAvailable()};t.prototype.onExecute=function(e,t){return this._navigationAction.execute(e)};t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(s.e,{item:this._itemSelectionHelper.firstItem})};t.prototype._computeUrl=function(){var e=this._itemSelectionHelper.firstItem();if(!e)return"";var t=this._viewParams();return this._urlDataSource.getOpenInOfficeOnlineUrl(e,t,{forceReadOnly:this._forceReadOnly,useDefaultAction:this._useDefaultAction})};return t})(i.e);t.e=p},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(7),i=new(n(3).t)({name:"".concat("UseItemsScope.key",".useItemsScope"),factory:{dependencies:{observablesFactoryType:r.i},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(7),i=new(n(3).t)({name:"".concat("IsFiltersPaneExpanded",".isFiltersPaneExpanded"),factory:{dependencies:{observablesFactoryType:r.i},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});var r=n(3),i=(new r.t("idle"),new r.t("beforeUnload"),new r.t("syncActiveXClient"),new r.t("attributionHelper"),new r.t("educationAndUpsells"),new r.t("fileHandlerHelper"),new r.t("clientSideExtensionHelper")),s=new r.t("needsAttentionViewHelper");new r.t("shyConductor")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return i});n.d(t,"n",function(){return s});var r="ListsAction",i="resetAllSurveyStatuses",s="resetSurveyStatusById"},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(3).t)("KnockoutResourceScope.key")},function(e,t,n){"use strict";var r=n(106);Object(r.e)([{rawString:".od-ItemNameEditor-input{display:table-cell;width:100%}.od-ItemNameEditor-extension{direction:ltr;display:table-cell}[dir=ltr] .od-ItemNameEditor-extension{padding-left:8px}[dir=rtl] .od-ItemNameEditor-extension{padding-right:8px}.od-ItemNameEditor--noExtension .od-ItemNameEditor-input{display:block;width:auto}.od-ItemNameEditor--noExtension .od-ItemNameEditor-extension{display:none}.od-ItemNameEditor-status{font-size:12px;font-weight:400;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";word-wrap:break-word}.od-ItemNameEditor-status--error{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-ItemNameEditor-input--error{border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"!important}"}]);var i=n(0),s=n(18),o=n(97),u=n(548),a=n(332),f=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.namePlaceholder=u.e;n.name=t.name;n.extension=t.extension;n.status=t.status||s.observable("");n.hasError=t.hasError||s.observable(!1);n.isEnabled=t.isEnabled||s.observable(!0);n.hasFocus=t.hasFocus||s.observable(!0);n.namePlaceholder=t.namePlaceholder||n.namePlaceholder;n.nameAriaLabel=t.nameAriaLabel||"";n.addBindingHandlers({selectOnFocus:a.e});return n}t.prototype.onClick=function(e,t){t.stopPropagation()};return t})(o.e),l=n(98).e({tagName:"ms-item-name-editor",template:'<div class="od-ItemNameEditor" data-bind="css:{\'od-ItemNameEditor--noExtension\':!extension,\'is-focused\':hasFocus,\'is-error\':hasError}"><div class="od-TextField"><span class="od-ItemNameEditor-input"><input class="od-TextField-field" id="ItemNameEditor-input" type="text" data-bind="textInput:name,hasFocus:hasFocus,selectOnFocus,attr:{\'aria-label\':nameAriaLabel,placeholder:namePlaceholder},css:{\'od-ItemNameEditor-input--error\':hasError},click:onClick,enable:isEnabled,automation:\'itemNameEditor-Input\'"></span><span class="od-ItemNameEditor-extension" data-bind="text:extension"></span></div>\x3c!--ko if:hasError--\x3e<div class="od-ItemNameEditor-status" aria-live="assertive" role="status" data-bind="text:status,css:{\'od-ItemNameEditor-status--error\':hasError}"></div>\x3c!--/ko--\x3e</div>',viewModel:f,synchronous:!0});t.e=l},function(e,t,n){"use strict";n.d(t,"e",function(){return p});var r=n(69),i=n(0),s=n(91),o=n(250),u=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._identityDataSource=n.identityDataSource;return r}t.prototype.getToken=function(){return this._identityDataSource.getGraphToken({})};t.dependencies=Object(i.__assign)(Object(i.__assign)({},s.e.dependencies),{identityDataSource:o.e});return t})(s.e),a=Object(r.s)("GraphTokenProvider",u),f=n(3),l=(function(){function e(){}e.prototype.getApiName=function(){return"Graph"};e.prototype.getApiBaseUrl=function(){return"https://graph.microsoft.com/beta"};return e})(),c=new f.t({name:"GraphUrlDataSource",factory:new r.i(l)}),h=n(282),p=Object(r.s)("GraphDataRequestor",h.e,{sessionManagementProvider:a,urlDataSource:c});h.e},function(e,t,n){"use strict";n.d(t,"e",function(){return v});var r,i=n(149),s=new(n(3).t)("".concat("MicroServiceDataSource.key",".microServiceDataSource")),o=n(30),u=n(250),a=n(69),f=n(77),l=n(203);(function(e){e.unauthUser="unauthUser"})(r||(r={}));var c=n(188),h={ODB:n(363).e.ODB?1651:60021},p=Object(c.e)(h)&&Object(c.e)({ODB:-671}),d=(function(){function e(e,t){this._identityDataSource=t.identityDataSource;this._microServiceDataSource=t.microServiceDataSource}e.prototype.getToken=function(e,t){var n=this._identityDataSource.getIdentity().type;if(n===i.e.aad){if(t&&p){var s=new l.e(t).authority;return this._identityDataSource.getSharePointToken(s)}if(this._microServiceDataSource)return this._microServiceDataSource.getAuthData().then(function(t){if(t)return e&&"v2.1"===e?{accessToken:t.authTokenV21,proofToken:t.proofTokenV21,tokenUrl:t.tokenUrlV21}:{accessToken:t.authToken,proofToken:t.proofToken,tokenUrl:t.tokenUrl}},function(e){return o.n.resolve()})}else if(n===i.e.msa)return this._identityDataSource.getSessionToken();return o.n.reject(new f.e({code:r.unauthUser,isExpected:!0,message:"Cannot request a token for an unauthenticated user."}))};e.prototype.getFormDigest=function(e){return this._identityDataSource.getFormDigest(e)};e.dependencies={identityDataSource:u.e,microServiceDataSource:s.optional};return e})(),v=Object(a.s)("SessionManagementProvider",d)},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(3).t)("clientName")},,,,function(e,t,n){"use strict";var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;function o(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=(function(){try{if(!Object.assign)return!1;var e=new String("abc");e[5]="de";if("5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var r={};"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e});return"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}})()?Object.assign:function(e,t){for(var n,u,a=o(e),f=1;f<arguments.length;f++){n=Object(arguments[f]);for(var l in n)i.call(n,l)&&(a[l]=n[l]);if(r){u=r(n);for(var c=0;c<u.length;c++)s.call(n,u[c])&&(a[u[c]]=n[u[c]])}}return a}},,function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(3),i=(new r.t("dataStore"),new r.t("userSettingsStore")),s=(new r.t("userInfoStore"),new r.t("smartFiltersStore"))},,function(e,t,n){"use strict";var r=n(365);t.e=r.e},,,,function(e,t,n){"use strict";n.d(t,"t",function(){return l});var r=n(0),i=n(6),s=n(30),o=n(167),u=n(69),a=n(16),f=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this,s=a.t.isActivated("8dba7267-c081-480e-9601-f659d6395db5","09/09/2020","Add dependencies to UserInfoProvider and UserInfoDataSource");r.dataSource=!s&&n&&n.dataSource||r.resources.consume(i.F);r.canPersistUserInfo=r.dataSource.canPersistUserInfo();return r}t.prototype.getAnid=function(){return this.dataSource.getAnid()};t.prototype.isAuthenticated=function(){return this.dataSource.isAuthenticated()};t.prototype.getUserInfo=function(e){var t=this;return e||!this._cachedUserInfo?this.isAuthenticated()?this.dataSource.getUserInfo(e).then(function(e){t._cachedUserInfo=e;return e},function(e){return s.n.wrapError(null)}):s.n.wrap(null):s.n.wrap(this._cachedUserInfo)};t.prototype.setUserInfo=function(e,t,n,r,i){return this.dataSource.setUserInfoWithUserFacts(e,t,n,r,i)};t.prototype.resetUpsellUserFact=function(){return this.dataSource.resetUpsellUserFact()};t.prototype.getBubbleUserFact=function(e,t,n){return this.dataSource.getBubbleUserFact?this.dataSource.getBubbleUserFact(e,t,n):this.getUserInfo(n).then(function(t){if(t&&t.info)for(var n=0,r=t.info;n<r.length;n++){var i=r[n],s=e.campaignGuid;if(i.id&&i.id.toLowerCase()===s.toLowerCase())return JSON.parse(i.data)}return{d:!1,v:0}},function(e){return s.n.wrapError(null)})};t.prototype.setBubbleUserFact=function(e,t){return this.dataSource.setBubbleUserFact?this.dataSource.setBubbleUserFact(e,t):this.setUserInfo(17,3,null,e.campaignGuid,JSON.stringify(t))};t.prototype.getSurveyStatusUserFact=function(e,t,n){return t?s.n.resolve({activated:!1,dateLastModified:new Date}):this.dataSource.getSurveyStatusUserFact?this.dataSource.getSurveyStatusUserFact(e):this.getUserInfo(n).then(function(t){if(t&&t.info)for(var n=0,r=t.info;n<r.length;n++){var i=r[n];if(i.id&&i.id.toLowerCase()===e.toLowerCase())return{activated:JSON.parse(i.data).a,dateLastModified:new Date(i.modifiedDate)}}return{activated:!1,dateLastModified:new Date}})};t.prototype.setSurveyStatusUserFact=function(e,t){return this.dataSource.setSurveyStatusUserFact?this.dataSource.setSurveyStatusUserFact(e,t):this.setUserInfo(47,3,null,e,JSON.stringify({a:t.activated}))};t.prototype.getUpsellDismissedById=function(e,t){return this.dataSource.getUpsellDismissedById(e,t)};t.prototype.getUpsellViewCountById=function(e,t){return this.dataSource.getUpsellViewCountById(e,t)};t.prototype.markUpsellAsSeen=function(e){return this.dataSource.markUpsellAsSeen(e)};t.prototype.markUpsellAsDismissed=function(e){return this.dataSource.markUpsellAsDismissed(e)};t.prototype.updateUpsellData=function(e,t,n){return this.dataSource.updateUpsellData(e,t,n)};t.prototype.hasUserFact=function(e){return this.dataSource.hasUserFact(e)};t.prototype.getUserFact=function(e){return this.dataSource.getUserFact(e)};t.prototype.getIsPremium=function(e){return this.dataSource.getIsPremium(e)};t.prototype.getUpsellToShow=function(e){return this.dataSource.getUpsellToShow(e)};t.prototype.getUpsellViewCount=function(e){return this.dataSource.getUpsellViewCount(e)};t.prototype.getUpsellDismissed=function(e){return this.dataSource.getUpsellDismissed(e)};t.prototype.getUpsellIframeSrc=function(e,t){return this.dataSource.getUpsellIframeSrc(e,t)};t.prototype.getUpsellVariationIfApplicable=function(e){return e.variation?o.t[e.variation]:e};t.prototype.sendShowUpsell=function(e,t,n){return this.dataSource.sendShowUpsell(e,t,n)};t.prototype.sendCloseUpsell=function(e,t,n){return this.dataSource.sendCloseUpsell(e,t,n)};t.prototype.getMarket=function(){return this.dataSource.getMarket()};t.prototype.getFirstRunExperienceDismissed=function(){return this.dataSource.getFirstRunExperienceDismissed()};t.prototype.getFirstRunExperienceViewCount=function(){return this.dataSource.getFirstRunExperienceViewCount()};t.prototype.updateFirstRunExperienceData=function(e,t){return this.dataSource.updateFirstRunExperienceData(e,t)};t.prototype.hasPositioningBeenViewed=function(){return this.dataSource.hasPositioningBeenViewed()};t.prototype.datePositioningViewed=function(){return this.dataSource.datePositioningViewed()};t.prototype.getPremiumUpsellsViewed=function(){return this.dataSource.getPremiumUpsellsViewed()};t.prototype.getMostRecentNewFeaturesUpsellViewed=function(){return this.dataSource.getMostRecentNewFeaturesUpsellViewed()};t.prototype.setPositioningUserFactWithParams=function(e){return this.dataSource.setPositioningUserFactWithParams(e)};t.prototype.getExpiringSharingLinksSeen=function(){return this.dataSource.getExpiringSharingLinksSeen()};t.prototype.setExpiringSharingLinksSeen=function(){return this.dataSource.setExpiringSharingLinksSeen()};t.dependencies={dataSource:i.F};return t})(n(91).e);t.e=f;var l=Object(u.s)("UserInfoProvider",f)},,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e,t){switch(e){case"trialbanner":return"cmmywkr3bya"}}},function(e,t,n){"use strict";var r=n(295);n.d(t,"e",function(){return r.t})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(193),i=n(470);function s(e){return e}function o(e,t){return e&&e.extension&&!!e.openUrl&&!t.isRecycleBin(e.queryType)&&e.itemStatus!==r.e.ConditionalAccessViewOnly&&e.itemStatus!==r.e.ConditionalAccessBlocked&&i.e.hasItemPermission(e,i.e.openItems)}},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(3),i=n(7),s=new r.t({name:"".concat("UploadedItemResourceKey",".UploadedItem"),factory:{dependencies:{observablesFactoryType:i.i},create:function(e){var t=new e.observablesFactoryType;return{instance:t.create({}),disposable:t}}}})},function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n(0),i=n(315),s=n(51),o=n(107),u=n(69),a=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._context=t;r._itemProvider=n.itemProvider;return r}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t),r=t.input;n.type=o.e.updateBundle;n.name=r.name;n.iconName=r.iconName;n.payloads.updateBundle={item:r,parent:r.UNSAFE_parent};return n};t.prototype.onStart=function(e){var t=[new i.t(this._context.item.key,this._context.item)];e.update(t);return this._itemProvider.updateBundle(this._context,e)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{itemProvider:s.resourceKey});return t})(i.n),f=Object(u.o)("UpdateBundleOperator",a)},function(e,t,n){"use strict";var r=n(0),i=n(7),s=n(92),o=n(61),u=n(81),a=n(6),f=n(30),l=n(21),c=n(153),h=n(337),p=n(220),d=n(289),v=n(53),m=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._identityDataSource=n.resources.consume(a.h);n._isOneDriveWinApp=Object(v.e)();return n}t.prototype.unlockPopup=function(){var e=this;this._unlockSignal=new c.e;this.async.setTimeout(function(){e._showPopupNotice()},500);if(this._isOneDriveWinApp){this.events.on(window,"StrongAuthTokenFromWinApp",this._onReceivedTokenFromWinApp);this._showLoginPopupForWinApp()}else{this.events.on(window,"message",this._onReceivedMessage);this._createLoginPopup()}return this._unlockSignal.getPromise()};t.prototype._onReceivedMessage=function(e){var t=this;if(this._loginPopup&&e.origin===window.location.origin&&e.data){var n=void 0;try{n=JSON.parse(e.data)}catch(e){}if(n&&n.isVault){this.async.clearInterval(this._popupInterval);this._popupInterval=0;var r=new l.e({name:"VaultHelper.FinalizeUnlock"});if(n.success){n.canary&&(FilesConfig.canary=n.canary);n.navCanary&&(FilesConfig.navCanary=n.navCanary);this.resources.consumeAsync(d.e).then(function(e){e.unlockVault().then(function(){r.end({resultType:l.t.Success});t._popupNoticeDialog.complete();t._unlockSignal.complete(n.success);t._loginPopup.close();t._loginPopup=null}).catch(function(){r.end({resultType:l.t.Failure,resultCode:"UnlockSessionMismatch",error:n.error&&n.error.message||"Unknown"});t._showUnlockError()})})}else{r.end({resultType:l.t.Failure,resultCode:"UnlockFailure",error:n.error&&n.error.message||"Unknown"});this._showUnlockError()}}}};t.prototype._showUnlockPopBlockError=function(){this._popupNoticeDialogText("".concat(p.r,'<p class="ms-fontColor-error">').concat(p.e,"</p>"));s.e.logData({name:"Vault.VerificationNeeded.Blocked"});this._loginPopup=null};t.prototype._showUnlockError=function(){this._popupNoticeDialogText("".concat(p.r,'<p class="ms-fontColor-error">').concat(p.t,"</p>"));s.e.logData({name:"Vault.Unlock.Failed"});this._unlockSignal.complete(!1);if(this._loginPopup){this._loginPopup.close();this._loginPopup=null}};t.prototype._createLoginPopup=function(){var e=this._identityDataSource.getAuthUrl("msa_strong_auth:"),t=window.screenX,n=window.screenY,r=window.outerWidth,i=window.outerHeight,s=t+Math.max(r-500,0)/2,o=n+Math.max(i-500,0)/2;this._loginPopup=window.open(e,"vaultPopup","width=".concat(500,",height=").concat(500,",top=").concat(o,",left=").concat(s,",status=no,resizeable=yes,toolbar=no,menubar=no,scrollbars=yes"));this._monitorLoginPopup()};t.prototype._monitorLoginPopup=function(){var e=this;this._popupInterval||(this._popupInterval=this.async.setInterval(function(){if(e._loginPopup)if(e._loginPopup.closed){e.async.clearInterval(e._popupInterval);e._popupInterval=0}else try{e._loginPopup.postMessage("updating reference of parent to support navigations in auth popup",window.location.origin)}catch(t){t&&"TypeError"===t.name&&e._showUnlockPopBlockError()}else{e.async.clearInterval(e._popupInterval);e._popupInterval=0}},500))};t.prototype._showPopupNotice=function(){var e=this;if(!this._popupNoticeDialog||1!==this._popupNoticeDialog.state.peek()){var t=this.resources.consume(u.e),n=p.i;this._popupNoticeDialogText=this.observables.create(p.r);this._popupNoticeDialog=t.requestDialog({title:n,isSoftDismissable:!1,focusOnPrimaryAction:!0,component:{name:h.e.tagName,params:{html:this._popupNoticeDialogText}},actions:[{name:p.n,execute:function(){return e.onDialogExecute()},isAvailable:this.observables.create(!0),icon:new o.e("CheckMark"),isDefault:!0}]});this._logVaultEvent("Vault.VerificationNeeded.Shown");this._popupNoticeDialog.wait().catch(function(){if(e._loginPopup&&3===e._popupNoticeDialog.state.peek()){e._logVaultEvent("Vault.VerificationNeeded.Dismiss");e._unlockSignal.cancel();e._loginPopup.close();e._loginPopup=null}});this._popupNoticeDialog.wait().then(function(){e._loginPopup&&2===e._popupNoticeDialog.state.peek()&&e._logVaultEvent("Vault.VerificationNeeded.Succeeded")})}};t.prototype.onDialogExecute=function(){this._logVaultEvent("Vault.VerificationNeeded.ShowPopup");if(this._loginPopup&&!this._loginPopup.closed)try{this._loginPopup.focus()}catch(e){}else this._isOneDriveWinApp?this._showLoginPopupForWinApp():this._createLoginPopup();return f.n.resolve(1)};t.prototype._logVaultEvent=function(e){s.e.logData({name:e})};t.prototype._showLoginPopupForWinApp=function(){this._identityDataSource.getSessionToken(void 0,!0)};t.prototype._onReceivedTokenFromWinApp=function(e){var t=this,n=new l.e({name:"VaultHelper.PWA.FinalizeUnlock"});if(e.detail.error||!e.detail.token){n.end({resultType:l.t.Failure,resultCode:"UnlockFailure",error:e.detail.error||"Unknown"});this._showUnlockError()}else this.resources.consumeAsync(d.e).then(function(r){r.unlockVault(!1,e.detail.token).then(function(){n.end({resultType:l.t.Success});t._popupNoticeDialog.complete();t._unlockSignal.complete(!0)}).catch(function(){n.end({resultType:l.t.Failure,resultCode:"UnlockSessionMismatch",error:e.detail.error||"Unknown"});t._showUnlockError()})})};return t})(i.n);t.e=m}],Array(22),[function(e,t,n){(function(){function t(e,t){var n,r,i,s,o,u,a,f;n=3&e.length;r=e.length-n;i=t;o=3432918353;u=461845907;f=0;for(;f<r;){a=255&e.charCodeAt(f)|(255&e.charCodeAt(++f))<<8|(255&e.charCodeAt(++f))<<16|(255&e.charCodeAt(++f))<<24;++f;i=27492+(65535&(s=5*(65535&(i=(i^=a=(65535&(a=(a=(65535&a)*o+(((a>>>16)*o&65535)<<16)&4294967295)<<15|a>>>17))*u+(((a>>>16)*u&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(s>>>16)&65535)<<16)}a=0;switch(n){case 3:a^=(255&e.charCodeAt(f+2))<<16;case 2:a^=(255&e.charCodeAt(f+1))<<8;case 1:i^=a=(65535&(a=(a=(65535&(a^=255&e.charCodeAt(f)))*o+(((a>>>16)*o&65535)<<16)&4294967295)<<15|a>>>17))*u+(((a>>>16)*u&65535)<<16)&4294967295}i^=e.length;i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295;i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295;return(i^=i>>>16)>>>0}var n=t;n.v2=function(e,t){for(var n,r=e.length,i=t^r,s=0;r>=4;){n=1540483477*(65535&(n=255&e.charCodeAt(s)|(255&e.charCodeAt(++s))<<8|(255&e.charCodeAt(++s))<<16|(255&e.charCodeAt(++s))<<24))+((1540483477*(n>>>16)&65535)<<16);i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16));r-=4;++s}switch(r){case 3:i^=(255&e.charCodeAt(s+2))<<16;case 2:i^=(255&e.charCodeAt(s+1))<<8;case 1:i=1540483477*(65535&(i^=255&e.charCodeAt(s)))+((1540483477*(i>>>16)&65535)<<16)}i=1540483477*(65535&(i^=i>>>13))+((1540483477*(i>>>16)&65535)<<16);return(i^=i>>>15)>>>0};n.v3=t;e.exports=n})()},,,,,function(e,t,n){"use strict";n.r(t);n.d(t,"ShowPropertiesAction",function(){return C});var r=n(0),i=n(11),s=n(7),o=n(3),u=n(406),a=new o.t({name:"".concat("DetailsPaneId",".detailsPaneId"),factory:{dependencies:{},create:function(){return{instance:Object(u.e)("DetailsPane-")}}}}),f=new o.t({name:"".concat("IsDetailsPaneExpanded",".isDetailsPaneExpanded"),factory:{dependencies:{detailsPaneId:a,observablesFactoryType:s.i},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}}),l=n(496),c=new o.t({name:"".concat("IsCopilotPaneExpanded",".isCopilotPaneExpanded"),factory:{dependencies:{observablesFactoryType:s.i},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}}),h=n(30),p=n(19),d=n(171),v=n(13),m=n(327),g=n(154),y=n(21),b=n(90),w=n(5),E={};function S(e){return E[e]}function x(e,t){E[e]=t}var T=n(100),N=n(2),C=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="ShowProperties";var i=n.isInfoPaneExpanded,s=void 0===i?r.resources.consume(f):i,o=n.isSharingSectionExpanded,u=void 0===o?r.resources.consume(v.v.optional):o,a=n.isInfoPaneAvailable,h=void 0===a?r.resources.consume(d.e.infoPane.isInfoPaneAvailable.optional):a,y=n.isFiltersPaneExpanded,b=void 0===y?r.resources.consume(l.e):y,w=n.isCopilotPaneExpanded,E=void 0===w?r.resources.consume(c):w,S=n.isColumnCustomizationPaneExpanded,x=void 0===S?r.resources.consume(d.e.columnCustomizationPane.isColumnCustomizationPaneExpanded.optional):S,T=n.rumOneHelper,N=void 0===T?r.resources.consume(m.e.optional):T,C=n.itemSelectionHelperType,k=void 0===C?r.resources.consume(p.e):C,L=n.engagement,A=void 0===L?r.resources.consume(g.e):L,O=t.useToggleBehavior,M=void 0!==O&&O,_=t.isSharingSectionExpanded,D=void 0!==_&&_,P=t.allowMultiSelect,H=void 0!==P&&P;r._isInfoPaneExpanded=s;r._isSharingSectionExpanded=u;r._isInfoPaneAvailable=h||r.observables.create(!0);r._isFiltersPaneExpanded=b;r._isCopilotPaneExpanded=E;r._isColumnCustomizationPaneExpanded=x;r._rumOneHelper=N;r._useToggleBehavior=M;r._allowMultiSelect=H;r._shouldExpandSharingSection=D;r._itemSelectionHelper=new(r.scope.attached(k))({allowMultiSelect:r._allowMultiSelect,canFallback:!0,useCurrentSelectionGroup:!0});r._engagement=A;return r}t.prototype.onExecute=function(e){if(!this.isToggled.peek()){this._rumOneHelper&&this._rumOneHelper.logPropertiesPaneLaunch();this._isFiltersPaneExpanded&&this._isFiltersPaneExpanded(!1);this._isCopilotPaneExpanded&&this._isCopilotPaneExpanded(!1);this._isColumnCustomizationPaneExpanded&&this._isColumnCustomizationPaneExpanded(!1)}this._isSharingSectionExpanded&&this._isSharingSectionExpanded(this._shouldExpandSharingSection);var t=!this._useToggleBehavior||!this._isInfoPaneExpanded.peek();t&&(function(e){var t=S(e);if(t){t.end({resultType:y.t.Failure});t=void 0}if(!t){var n={name:e};x(e,t=new y.e(n))}})("LaunchInfoPane");this._engagement.logData({name:"DetailsPane.Click.".concat(t?"Open":"Close"),isIntentional:!0});this._isInfoPaneExpanded(t);b.t.raise(document.body,"resize",void 0,!0);return h.n.wrap({resultType:y.t.Success})};t.prototype.onIsAvailable=function(){var e=this._isInfoPaneAvailable();if(this._useToggleBehavior&&this._isInfoPaneExpanded())return!0;if(!e)return!1;var t=this._itemSelectionHelper.firstItem;if(!t())return!1;var n=[t];this._allowMultiSelect&&(n=this._itemSelectionHelper.selection());for(var r=0,i=n;r<i.length;r++){var s=i[r];if(s){var o=s();if(o&&(o.error||o.isPlaceholder&&o.queryType!==w.e.Search))return!1}}return!0};t.prototype.onIsToggled=function(){return this._isInfoPaneExpanded()};t.prototype.getEngagement=function(){return Object(N.isFeatureEnabled)(N.EngagementTelemetryEnhancement)?e.prototype.getEngagement.call(this).withPart(T.e,{item:this._itemSelectionHelper.firstItem}):e.prototype.getEngagement.call(this)};return t})(i.e);t.default=C}],Array(20),[function(e,t){var n;n=(function(){return this})();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n}],Array(28),[function(e,t,n){"use strict";e.exports=n(602)},function(e,t,n){"use strict";var r,i,s,o;if("object"==typeof performance&&"function"==typeof performance.now){var u=performance;t.unstable_now=function(){return u.now()}}else{var a=Date,f=a.now();t.unstable_now=function(){return a.now()-f}}if("undefined"==typeof window||"function"!=typeof MessageChannel){var l=null,c=null,h=function(){if(null!==l)try{var e=t.unstable_now();l(!0,e);l=null}catch(e){throw setTimeout(h,0),e}};r=function(e){null!==l?setTimeout(r,0,e):(l=e,setTimeout(h,0))};i=function(e,t){c=setTimeout(e,t)};s=function(){clearTimeout(c)};t.unstable_shouldYield=function(){return!1};o=t.unstable_forceFrameRate=function(){}}else{var p=window.setTimeout,d=window.clearTimeout;if("undefined"!=typeof console){var v=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills");"function"!=typeof v&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var m=!1,g=null,y=-1,b=5,w=0;t.unstable_shouldYield=function(){return t.unstable_now()>=w};o=function(){};t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<e?Math.floor(1e3/e):5};var E=new MessageChannel,S=E.port2;E.port1.onmessage=function(){if(null!==g){var e=t.unstable_now();w=e+b;try{g(!0,e)?S.postMessage(null):(m=!1,g=null)}catch(e){throw S.postMessage(null),e}}else m=!1};r=function(e){g=e;m||(m=!0,S.postMessage(null))};i=function(e,n){y=p(function(){e(t.unstable_now())},n)};s=function(){d(y);y=-1}}function x(e,t){var n=e.length;e.push(t);e:for(;;){var r=n-1>>>1,i=e[r];if(!(void 0!==i&&0<C(i,t)))break e;e[r]=t,e[n]=i,n=r}}function T(e){return void 0===(e=e[0])?null:e}function N(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length;r<i;){var s=2*(r+1)-1,o=e[s],u=s+1,a=e[u];if(void 0!==o&&0>C(o,n))void 0!==a&&0>C(a,o)?(e[r]=a,e[u]=n,r=u):(e[r]=o,e[s]=n,r=s);else{if(!(void 0!==a&&0>C(a,n)))break e;e[r]=a,e[u]=n,r=u}}}return t}return null}function C(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var k=[],L=[],A=1,O=null,M=3,_=!1,D=!1,P=!1;function H(e){for(var t=T(L);null!==t;){if(null===t.callback)N(L);else{if(!(t.startTime<=e))break;N(L),t.sortIndex=t.expirationTime,x(k,t)}t=T(L)}}function B(e){P=!1;H(e);if(!D)if(null!==T(k))D=!0,r(j);else{var t=T(L);null!==t&&i(B,t.startTime-e)}}function j(e,n){D=!1;P&&(P=!1,s());_=!0;var r=M;try{H(n);for(O=T(k);null!==O&&(!(O.expirationTime>n)||e&&!t.unstable_shouldYield());){var o=O.callback;if("function"==typeof o){O.callback=null;M=O.priorityLevel;var u=o(O.expirationTime<=n);n=t.unstable_now();"function"==typeof u?O.callback=u:O===T(k)&&N(k);H(n)}else N(k);O=T(k)}if(null!==O)var a=!0;else{var f=T(L);null!==f&&i(B,f.startTime-n);a=!1}return a}finally{O=null,M=r,_=!1}}var F=o;t.unstable_IdlePriority=5;t.unstable_ImmediatePriority=1;t.unstable_LowPriority=4;t.unstable_NormalPriority=3;t.unstable_Profiling=null;t.unstable_UserBlockingPriority=2;t.unstable_cancelCallback=function(e){e.callback=null};t.unstable_continueExecution=function(){D||_||(D=!0,r(j))};t.unstable_getCurrentPriorityLevel=function(){return M};t.unstable_getFirstCallbackNode=function(){return T(k)};t.unstable_next=function(e){switch(M){case 1:case 2:case 3:var t=3;break;default:t=M}var n=M;M=t;try{return e()}finally{M=n}};t.unstable_pauseExecution=function(){};t.unstable_requestPaint=F;t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=M;M=e;try{return t()}finally{M=n}};t.unstable_scheduleCallback=function(e,n,o){var u=t.unstable_now();"object"==typeof o&&null!==o?o="number"==typeof(o=o.delay)&&0<o?u+o:u:o=u;switch(e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}e={id:A++,callback:n,priorityLevel:e,startTime:o,expirationTime:a=o+a,sortIndex:-1};o>u?(e.sortIndex=o,x(L,e),null===T(k)&&e===T(L)&&(P?s():P=!0,i(B,o-u))):(e.sortIndex=a,x(k,e),D||_||(D=!0,r(j)));return e};t.unstable_wrapCallback=function(e){var t=M;return function(){var n=M;M=t;try{return e.apply(this,arguments)}finally{M=n}}}},function(e,t,n){var r,i,s;!(function(o){"use strict";function u(e,t,n,r,i,s,o){this.inputItem=t,this.stateArrayIndex=n,this.mappingOptions=i,this.arrayOfState=s,this.outputObservableArray=o,this.outputArray=this.outputObservableArray.peek(),this.isIncluded=null,this.suppressNotification=!1,this.outputArrayIndex=e.observable(r),this.disposeFuncFromMostRecentMapping=null,this.mappedValueComputed=e.computed(this.mappingEvaluator,this),this.mappedValueComputed.subscribe(this.onMappingResultChanged,this),this.previousMappedValue=this.mappedValueComputed.peek()}function a(e,t){if(!e)return null;switch(e.status){case"added":return e.index;case"deleted":return e.index+t;default:throw new Error("Unknown diff status: "+e.status)}}function f(e,t,n,r,i,s,o,a,f){var l="number"==typeof t.moved,c=l?n[t.moved]:new u(e,t.value,r,i,s,o,a);return o.splice(r,0,c),c.isIncluded&&f.splice(i,0,c.mappedValueComputed.peek()),l&&(c.stateArrayIndex=r,c.setOutputArrayIndexSilently(i)),c}function l(e,t,n,r,i){var s=t.splice(n,1)[0];s.isIncluded&&i.splice(r,1),"number"!=typeof e.moved&&s.dispose()}function c(e,t,n){return e.stateArrayIndex=t,e.setOutputArrayIndexSilently(n),n+(e.isIncluded?1:0)}function h(e,t,n,r,i,s){return t.subscribe(function(t){if(t.length){for(var o=(function(e,t){for(var n={},r=0;r<e.length;r++){var i=e[r];"added"===i.status&&"number"==typeof i.moved&&(n[i.moved]=t[i.moved])}return n})(t,n),u=0,h=t[0],p=0,d=h&&(function(e,t,n){return n.length&&t[e.index]?t[e.index].outputArrayIndex.peek():n.length})(h,n,r),v=h.index;h||v<n.length;v++)if(a(h,p)===v){switch(h.status){case"added":f(e,h,o,v,d,s,n,i,r).isIncluded&&d++,p++;break;case"deleted":l(h,n,v,d,r),p--,v--;break;default:throw new Error("Unknown diff status: "+h.status)}h=t[++u]}else v<n.length&&(d=c(n[v],v,d));i.valueHasMutated()}},null,"arrayChange")}function p(e,t){var n=[],r=[],i=e.observableArray(r),s=this.peek();if("function"==typeof t&&(t={mapping:t}),t.mappingWithDisposeCallback){if(t.mapping||t.disposeItem)throw new Error("'mappingWithDisposeCallback' cannot be used in conjunction with 'mapping' or 'disposeItem'.")}else if(!t.mapping)throw new Error("Specify either 'mapping' or 'mappingWithDisposeCallback'.");for(var o=0;o<s.length;o++){var a=s[o],f=new u(e,a,o,r.length,t,n,i),l=f.mappedValueComputed.peek();n.push(f),f.isIncluded&&r.push(l)}var c=h(e,this,n,r,i,t),p=e.computed(i).extend({trackArrayChanges:!0}),d=p.dispose;return p.dispose=function(){c.dispose(),e.utils.arrayForEach(n,function(e){e.dispose()}),d.call(this,arguments)},v(e,p),p}function d(e,t){return p.call(this,e,function(e){return t(e)?e:g})}function v(e,t){return e.utils.extend(t,e[y]),t}function m(e){e.projections={_exclusionMarker:g},(function(e){function t(e,t){return function(){return t.apply(this,[e].concat(Array.prototype.slice.call(arguments,0)))}}e[y]={map:t(e,p),filter:t(e,d)}})(e),v(e,e.observableArray.fn)}var g={};u.prototype.dispose=function(){this.mappedValueComputed.dispose(),this.disposeResultFromMostRecentEvaluation()},u.prototype.disposeResultFromMostRecentEvaluation=function(){if(this.disposeFuncFromMostRecentMapping&&(this.disposeFuncFromMostRecentMapping(),this.disposeFuncFromMostRecentMapping=null),this.mappingOptions.disposeItem){var e=this.mappedValueComputed();this.mappingOptions.disposeItem(e)}},u.prototype.mappingEvaluator=function(){null!==this.isIncluded&&this.disposeResultFromMostRecentEvaluation();var e;if(this.mappingOptions.mapping)e=this.mappingOptions.mapping(this.inputItem,this.outputArrayIndex);else{if(!this.mappingOptions.mappingWithDisposeCallback)throw new Error("No mapping callback given.");var t=this.mappingOptions.mappingWithDisposeCallback(this.inputItem,this.outputArrayIndex);if(!("mappedValue"in t))throw new Error("Return value from mappingWithDisposeCallback should have a 'mappedItem' property.");e=t.mappedValue,this.disposeFuncFromMostRecentMapping=t.dispose}var n=e!==g;return this.isIncluded!==n&&(null!==this.isIncluded&&this.moveSubsequentItemsBecauseInclusionStateChanged(n),this.isIncluded=n),e},u.prototype.onMappingResultChanged=function(e){e!==this.previousMappedValue&&(this.isIncluded&&this.outputArray.splice(this.outputArrayIndex.peek(),1,e),this.suppressNotification||this.outputObservableArray.valueHasMutated(),this.previousMappedValue=e)},u.prototype.moveSubsequentItemsBecauseInclusionStateChanged=function(e){var t,n,r=this.outputArrayIndex.peek();if(e)for(this.outputArray.splice(r,0,null),t=this.stateArrayIndex+1;t<this.arrayOfState.length;t++)(n=this.arrayOfState[t]).setOutputArrayIndexSilently(n.outputArrayIndex.peek()+1);else for(this.outputArray.splice(r,1),t=this.stateArrayIndex+1;t<this.arrayOfState.length;t++)(n=this.arrayOfState[t]).setOutputArrayIndexSilently(n.outputArrayIndex.peek()-1)},u.prototype.setOutputArrayIndexSilently=function(e){this.suppressNotification=!0,this.outputArrayIndex(e),this.suppressNotification=!1};var y="_ko.projections.cache";(function(){if(void 0!==e.exports){var o=n(18);m(o),e.exports=o}else i=[n(18)],void 0!==(s="function"==typeof(r=m)?r.apply(t,i):r)&&(e.exports=s)})()})()},,function(e,t,n){"use strict";n.r(t);var r,i=n(0),s=n(1),o=n(132),u=n(376),a=n(430),f=n(39),l=n(138),c=n.n(l),h=n(399),p=n(127);(function(e){e[e.Valid=0]="Valid";e[e.Expiring=1]="Expiring";e[e.Locked=2]="Locked";e[e.Unlocked=3]="Unlocked";e[e.Extended=4]="Extended";e[e.Ended=5]="Ended"})(r||(r={}));var d,v=(function(){function e(e,t){var n=this;this.listeners=[];this.checkExpiration=function(){n.fetchExpirationTime().then(function(e){e?e-12e4<Date.now()?n.notifyExpiring():n.handleVaultExtended():n.notifyLocked()},function(){n.notifyExpiring()})};this.handleVaultLocked=function(){n.stopTimers();n.notifyLocked()};this.handleVaultUnlocked=function(){n.notifyUnlocked()};this.handleVaultExtended=function(){n.stopTimers();n.startTimers();n.notifyExtended()};this.handleStorageEvent=function(e){if(e.key===n.expirationTimeStorageKey){var t=e.newValue,r=e.oldValue;t?r?t>r&&n.handleVaultExtended():n.handleVaultUnlocked():n.handleVaultLocked()}};this.wacDataSource=t;this.storagePrefix="".concat(p.t).concat(e);this.expirationTimeStorageKey="".concat(this.storagePrefix).concat(h.STORAGE_KEY_EXPIRATION)}e.prototype.setup=function(){var e=this;this.addStorageEventListener();return this.syncExpirationTime().then(function(){e.startTimers()})};e.prototype.dispose=function(){this.removeStorageEventListener();this.stopTimers()};e.prototype.addEventListener=function(e){-1===this.listeners.findIndex(function(t){return t===e})&&this.listeners.push(e)};e.prototype.removeEventListener=function(e){var t=this.listeners.findIndex(function(t){return t===e});-1!==t&&this.listeners.splice(t)};e.prototype.extendVault=function(){var e=this;return this.wacDataSource.request("/drive/special/vault/action.unlockVault","POST",!0).then(function(){return e.syncExpirationTime()}).then(function(){return e.handleVaultExtended()}).catch(function(){e.handleVaultLocked()})};e.prototype.onUserActivity=function(){this.extendVault()};e.prototype.notify=function(e){for(var t=0,n=this.listeners;t<n.length;t++){(0,n[t])(e)}};e.prototype.notifyExpiring=function(){this.notify(r.Expiring)};e.prototype.notifyLocked=function(){this.notify(r.Locked)};e.prototype.notifyUnlocked=function(){this.notify(r.Unlocked)};e.prototype.notifyExtended=function(){this.notify(r.Extended)};e.prototype.syncExpirationTime=function(){var e=this;return this.fetchExpirationTime().then(function(t){t&&e.setExpirationTime(t)})};e.prototype.fetchExpirationTime=function(){return this.wacDataSource.request("/drive/special/vault","GET",!0).then(function(e){var t=e[0];if(t.vault.expirationInSeconds)return Date.now()+1e3*t.vault.expirationInSeconds})};e.prototype.getExpirationTime=function(){return Number(window.localStorage.getItem(this.expirationTimeStorageKey))};e.prototype.setExpirationTime=function(e){try{e&&window.localStorage.setItem(this.expirationTimeStorageKey,String(e))}catch(e){console.log(e)}};e.prototype.startTimers=function(){this.stopTimers();var e=this.getExpirationTime();if(e){var t=e-Date.now();this.expirationTimerId=window.setTimeout(this.checkExpiration,t-12e4);this.lockedTimerId=window.setTimeout(this.handleVaultLocked,t)}};e.prototype.stopTimers=function(){if(this.expirationTimerId){window.clearTimeout(this.expirationTimerId);this.expirationTimerId=void 0}if(this.lockedTimerId){window.clearTimeout(this.lockedTimerId);this.lockedTimerId=void 0}};e.prototype.addStorageEventListener=function(){window.addEventListener("storage",this.handleStorageEvent)};e.prototype.removeStorageEventListener=function(){window.removeEventListener("storage",this.handleStorageEvent)};return e})();(function(e){e[e.JSApiBootNotStart=0]="JSApiBootNotStart";e[e.JSApiBootStarted=1]="JSApiBootStarted";e[e.JSApiBootPendingComplete=2]="JSApiBootPendingComplete";e[e.JSApiBootSuccess=3]="JSApiBootSuccess";e[e.JSApiBootFailed=4]="JSApiBootFailed"})(d||(d={}));var m=(function(){function e(e,t,n){void 0===e&&(e="Unknown");void 0===n&&(n=d.JSApiBootNotStart);this.reset(e,t,n)}e.prototype.update=function(e){if(this.data&&e)for(var t in e)this.data[t]=e[t]};e.prototype.reset=function(e,t,n){void 0===e&&(e="Unknown");void 0===n&&(n=d.JSApiBootNotStart);this.data={bootState:n,entryPoint:e,userClickTime:t}};return e})(),g=n(21),y=n(153);function b(e,t){var n=new y.e,r=new g.e({name:"WacHost.JsApiScriptLoad"}),i=document.createElement("script");i.onload=function(){r.end({resultType:g.t.Success,resultCode:"JS API script Load Completed"});n.resolve(void 0)};i.onerror=function(){document.body.removeChild(i);r.end({resultType:g.t.Failure,resultCode:"JS API script Load Failure"});t({bootState:void 0,resultType:g.t.Failure,resultCode:"LoadFailed",errorInfo:"Failed to load JsApi"});n.reject(void 0)};i.onabort=function(){document.body.removeChild(i);r.end({resultType:g.t.Failure,resultCode:"JS API script Load Abort"});t({bootState:void 0,resultType:g.t.Failure,resultCode:"LoadFailed",errorInfo:"Failed to load JsApi Abort"});n.reject(void 0)};i.src=e;document.body.appendChild(i);return n.getPromise()}function w(e,t,n){try{return t.UseV2?(function(e,t,n){var r=new g.e({name:"WacHost.JsApiScriptBootstrap"}),i=E(t,n),s={host:{storageHostName:t.HostName,capabilities:t.capabilities},user:{id:t.UserId},bootstrapperUrl:t.BootstrapperUrl},o=Microsoft.Office[t.Application].createApplication(s),u={hostSessionId:t.HostSessionId},a=o.createSession(u),f={appUrl:t.ApplicationUrl,file:{name:t.FileName,getUrl:t.FileGetUrl,getUrlExpiry:t.FileGetUrlExpiry,size:t.FileSize,eTag:t.ETag,uniqueId:t.UniqueId},container:e,wopi:{source:t.WopiSrc,accessToken:t.AccessToken,expiry:t.AccessTokenExpiry},bootParams:{readOnly:t.ReadOnly,viewOnly:t.ViewOnly},ownerId:t.OwnerId,diagnostics:{entryPoint:n.entryPoint,userClickTime:n.userClickTime,hostPageNavigationStartTime:n.hostPageNavigationStartTime,hostPageFetchStartTime:n.hostPageFetchStartTime,hostPageResponseStartTime:n.responseStartTime,hostPageFirstFlushTime:n.hostPageFirstFlushTime,officeBootstrapperStartTime:n.officeBootstrapperStartTime,officeBootstrapperEndTime:n.officeBootstrapperEndTime,officeInitializationTime:n.officeInitializationTime,hostInitializeCallTime:n.hostInitializeCallTime,hostCompleteCallTime:void 0},sessionContext:t.SessionContext};return a.boot(f).then(function(e){var n;if(i){clearTimeout(i);i=null}if("success"===e.completion){r.end({resultType:g.t.Success,resultCode:"JS API script bootstrap success"});t.triggerLogEvent({bootState:d.JSApiBootSuccess,resultType:g.t.Success,resultCode:"Success"});var s=null===(n=a.diagnostics)||void 0===n?void 0:n.appInitDiagnostics,u={documentLoadedTime:null==s?void 0:s.documentLoadedTime,appCompletedTime:null==s?void 0:s.appCompletedTime};return{application:o,session:a,wacAppDiagnostics:u}}r.end({resultType:g.t.Failure,resultCode:"JS API script bootstrap not completed",extraData:{error:e.error,completion:e.completion}});t.triggerLogEvent({bootState:d.JSApiBootFailed,resultType:g.t.Failure,resultCode:"InitFailed",error:e.error});return Promise.reject(e.error)},function(e){if(i){clearTimeout(i);i=null}r.end({resultType:g.t.Failure,resultCode:"JS API script bootstrap failure",extraData:{error:e}});t.triggerLogEvent({bootState:d.JSApiBootFailed,resultType:g.t.Failure,resultCode:"InitFailed",error:e});return Promise.reject(e)})})(e,t,n):(function(e,t,n){var r=new y.e,i=new g.e({name:"WacHost.JsApiScriptBootstrap"}),s=E(t,n),o={BootstrapperUrl:t.BootstrapperUrl,Container:e,SessionInformation:{HostName:t.HostName,HostSessionId:t.HostSessionId,UserId:t.UserId,OwnerId:t.OwnerId,SessionContext:t.SessionContext,SupportsCustomAuthConfig:t.capabilities.customAuthConfig,SupportsCommonFilePicker:t.capabilities.commonFilePicker,SupportsMoveToFolder:t.capabilities.moveToFolder},ApplicationUrl:t.ApplicationUrl,WopiPrecheckInfo:{DocUniqueId:t.UniqueId,ETag:t.ETag,FileName:t.FileName,FileGetUrl:t.FileGetUrl,FileGetUrlExpiry:t.FileGetUrlExpiry,FileSize:t.FileSize,ReadOnly:t.ReadOnly,ViewOnly:t.ViewOnly},WopiInfo:{WopiSrc:t.WopiSrc,AccessToken:t.AccessToken,AccessTokenExpiry:new Date(t.AccessTokenExpiry)},ApplicationCustomSettings:{UnifiedAppEnabled:t.AppEnabled},Diagnostics:{entryPoint:n.entryPoint,userClickTime:n.userClickTime,hostPageNavigationStartTime:n.hostPageNavigationStartTime,hostPageFetchStartTime:n.hostPageFetchStartTime,hostPageResponseStartTime:n.responseStartTime,hostPageFirstFlushTime:n.hostPageFirstFlushTime,officeBootstrapperStartTime:n.officeBootstrapperStartTime,officeBootstrapperEndTime:n.officeBootstrapperEndTime,officeInitializationTime:n.officeInitializationTime,hostInitializeCallTime:n.hostInitializeCallTime,hostCompleteCallTime:void 0},FnOnInitializeSuccess:function(e,n){if(s){clearTimeout(s);s=null}i.end({resultType:g.t.Success,resultCode:"JS API script bootstrap success"});t.triggerLogEvent({bootState:d.JSApiBootSuccess,resultType:g.t.Success,resultCode:"Success"});var o={documentLoadedTime:null==n?void 0:n.documentLoadedTime,appCompletedTime:null==n?void 0:n.appCompletedTime};r.resolve({application:u,wacAppDiagnostics:o})},FnOnInitializeFailure:function(e){if(s){clearTimeout(s);s=null}i.end({resultType:g.t.Failure,resultCode:"JS API script bootstrap failure"});t.triggerLogEvent({bootState:d.JSApiBootFailed,resultType:g.t.Failure,resultCode:"InitFailed",error:e});r.reject(void 0)},FnOnAppModeSwitched:function(e){t.onModeSwitched({NewMode:e})},FnIsFeatureEnabled:t.capabilities.isFeatureEnabled},u=Microsoft.Office[t.Application].Application.InitializeWopiPending(o);o.Diagnostics.hostCompleteCallTime=Date.now();u.Complete(o.WopiInfo);return r.getPromise()})(e,t,n)}catch(e){var r=(null==e?void 0:e.message)||"Error during JsApi initialize.";t.triggerLogEvent({bootState:d.JSApiBootFailed,resultType:g.t.Failure,resultCode:"BootException",errorInfo:r})}}function E(e,t){var n=setTimeout(function(){n=null;new g.e({name:"WacHost.JsApiScriptBootstrap",startTimeOverride:t.officeInitializationTime}).end({resultType:g.t.Failure,resultCode:"JS API script bootstrap timeout"});t.bootState===d.JSApiBootPendingComplete&&e.triggerLogEvent({bootState:d.JSApiBootFailed,resultType:"visible"===document.visibilityState?g.t.Failure:g.t.ExpectedFailure,resultCode:"Timeout",errorInfo:"Timeout"})},15e4);return n}var S=n(30),x=n(64),T=(function(){function e(){this.sources=[];this.handlers={}}e.prototype.attach=function(e){var t=this;Object(x.e)("MessageDispatcher: attached source ",e);-1===this.sources.findIndex(function(t){return e===t})&&this.sources.push(e);return function(){t.deattach(e)}};e.prototype.deattach=function(e){Object(x.e)("MessageDispatcher: deattached source ",e);var t=this.sources.findIndex(function(t){return e===t});-1!==t&&this.sources.splice(t,1)};e.prototype.dispatch=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,function(){var n,r,s,o;return Object(i.__generator)(this,function(i){switch(i.label){case 0:Object(x.e)("MessageDispatcher dispatch message: ",e,t);i.label=1;case 1:i.trys.push([1,8,,9]);if(!(n=this.handlers[e]))return[3,6];Object(x.e)("MessageDispatcher handle event: ",e,t);if(!(r=n(t)))return[3,5];s=void 0;return S.n.isPromise(r)?[4,r]:[3,3];case 2:s=i.sent();return[3,4];case 3:s=r;i.label=4;case 4:Object(x.e)("MessageDispatcher receive response: ",e,s);return[2,s];case 5:return[3,7];case 6:Object(x.e)("MessageDispatcher ignore event: ",e,t);i.label=7;case 7:return[3,9];case 8:o=i.sent();Object(x.e)("MessageDispatcher unhandled error: ",o);throw o;case 9:return[2]}})})};e.prototype.respond=function(e){for(var t=0,n=this.sources;t<n.length;t++){n[t].receive(e)}};e.prototype.addEventListener=function(e,t){Object(x.e)("MessageDispatcher add event handler: ",e);this.handlers[e]=t};e.prototype.removeEventListener=function(e,t){Object(x.e)("MessageDispatcher remove event handler: ",e);this.handlers[e]=void 0};e.prototype.dispose=function(){this.sources=[];this.handlers={}};return e})(),N=n(34),C=n(634),k=n(534),L=n(52),A=n(211),O=n(15),M=(function(){function e(e,t,n){this._apiUrlBase=e;this._identityDataSource=t;this._badgerToken=n}e.prototype.getItem=function(e,t,n,r,i,s,o){var u,a=this;void 0===o&&(o=!0);u=r?"/drives/"+encodeURIComponent(e)+"/items/root:/".concat(r):"/drives/"+encodeURIComponent(e)+"/items/".concat(t);u+="?action=".concat(n,"&$select=*,openWith,webDavUrl");var f=(null==i?void 0:i.wd)||(null==s?void 0:s.getQueryParameter("wd"));f&&(u+="&wd=".concat(f));var l=(null==i?void 0:i.wdorigin)||(null==i?void 0:i.wdOrigin)||(null==s?void 0:s.getQueryParameter("wdorigin"))||(null==s?void 0:s.getQueryParameter("wdOrigin"));l&&(u+="&wdorigin=".concat(l));return this.request(u,"GET",o).then(function(e){var t=e[0];return a._buildOneDriveItemFromResponse(t)},function(e){var t=e[0];Object(x.e)("Error: cannot get item info from vroom call: ",t);return null})};e.prototype.getWopiInfoWithItemId=function(e,t){var n="/items/".concat(e,"/driveItem?$select=openWith");return this.request(n,"GET",t).then(function(e){var t=e[0],n=t.openWith,r=t.webDavUrl,i=t.id,s=t.parentReference;return n&&n.wac?{driveId:s.driveId,itemId:i,webDavUrl:r,accessToken:n.wac.accessToken,accessTokenExpiry:n.wac.accessTokenExpiry,wopiSrc:n.wac.wopiSrc}:S.n.reject({driveId:null==s?void 0:s.driveId,itemId:i,error:{Id:"MissingProperty",Details:"No wac property was found in the response"}})},function(e){var t,n=e[0],r=(null===(t=e[1].status)||void 0===t?void 0:t.toString())||"Unknown",i=JSON.stringify({error:n});return S.n.reject({error:{Id:r,Details:i}})})};e.prototype.getWopiInfoWithUrl=function(e,t){var n="/shares/".concat(e,"/driveItem?$select=openWith,parentReference,id");return this.request(n,"GET",t).then(function(e){var t=e[0],n=t.openWith,r=t.webDavUrl,i=t.id,s=t.parentReference;return n&&n.wac?{driveId:s.driveId,itemId:i,webDavUrl:r,accessToken:n.wac.accessToken,accessTokenExpiry:n.wac.accessTokenExpiry,wopiSrc:n.wac.wopiSrc}:S.n.reject({driveId:null==s?void 0:s.driveId,itemId:i,webDavUrl:r,error:{Id:"MissingProperty",Details:"No wac property was found in the response"}})},function(e){var t,n=e[0],r=(null===(t=e[1].status)||void 0===t?void 0:t.toString())||"Unknown",i=JSON.stringify({error:n});return S.n.reject({error:{Id:r,Details:i}})})};e.prototype.getWopiDavURLWithDriveIdItemId=function(e,t,n){var r="/drives/".concat(e,"/items/").concat(t,"?$select=openWith,webDavUrl");return this.request(r,"GET",n).then(function(n){var r=n[0],i=r.openWith,s=r.webDavUrl;return i&&i.wac?{driveId:e,itemId:t,webDavUrl:s,accessToken:i.wac.accessToken,accessTokenExpiry:i.wac.accessTokenExpiry,wopiSrc:i.wac.wopiSrc}:S.n.reject({driveId:e,itemId:t,webDavUrl:s,error:{Id:"MissingProperty",Details:"No wac property was found in the response"}})},function(e){var t,n=e[0],r=(null===(t=e[1].status)||void 0===t?void 0:t.toString())||"Unknown",i=JSON.stringify({error:n});return S.n.reject({error:{Id:r,Details:i}})})};e.prototype.request=function(e,t,n){var r=this;void 0===t&&(t="POST");void 0===n&&(n=!1);return this.createHeaders(n).then(function(n){return new S.n(function(s,o){return Object(i.__awaiter)(r,void 0,void 0,function(){var r,u;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,fetch("".concat(this._apiUrlBase).concat(e),{method:t,headers:n})];case 1:return[4,(r=i.sent()).json()];case 2:u=i.sent();r.ok?s([u,r]):o([null==u?void 0:u.error,r]);return[2]}})})})})};e.prototype.createHeaders=function(e){var t={Accept:"application/json"};e&&(t.Prefer="Include-Feature=Vault");if(this._badgerToken){t.Authorization="Badger ".concat(this._badgerToken.token);return S.n.resolve(t)}return this._identityDataSource.getSessionToken().then(function(e){t.Authorization="Bearer ".concat(e.accessToken);return t})};e.prototype._buildOneDriveItemFromResponse=function(e){var t,n;if(!e){Object(x.e)("Error: the item info is null");return null}var r=e.id,i=e.name,s=e.folder,o=e.thumbnails,u=e.size,a=e.description,f=e.root,l=e.eTag,c=e.parentReference,h=c&&c.driveId,p={key:Object(O.v)((t={},t.id=r,t.driveId=h,t))},d=c.id?Object(O.v)(((n={}).id=c.id,n.driveId=h,n)):void 0;p.parentKey=d;p.sharingRole=this._getSharingRole(e);var v=(s?{extension:""}:C.n(i)).extension;p.itemId=r;var m=c&&c.driveType;p.graph={itemId:r,driveId:h,driveType:m};var g=f?k.e:i;p.name=i;p.displayName=g;p.extension=v;p.size=u;p.caption=a||"";p.ownerId=h;p.isRootFolder=!!f;p.eTag=l;if(s){var y=s.childCount;p.folder={childCount:y};if(o&&o.length>0){p.folder.covers=[];for(var b=0,w=o;b<w.length;b++){var E=w[b];p.folder.covers.push(E.large)}}p.childCount=y}p.vault=e.vault;p.itemFromServer=e;return p};e.prototype._getSharingRole=function(e){var t=e.shared;if(t&&t.effectiveRoles&&t.owner){var n=t.effectiveRoles,r=Object(A.e)(n||[],function(){return!0});return r.owner?L.e.Owner:r.write?L.e.Edit:r.read?L.e.View:L.e.None}return L.e.Owner};return e})(),_=n(20),D=n(202),P=n(725),H=n(236),B=n(552),j=n(649),F=n(485);function I(e){var t=e.vault,n=e.dispatcher,i=Object(s.useState)(r.Valid),o=i[0],u=i[1];Object(s.useEffect)(function(){if(t){t.setup();t.addEventListener(u);return function(){t.dispose();t.removeEventListener(u)}}},[t,u]);var a=null;switch(o){case r.Expiring:a=s.createElement(q,{onExtend:function(){t.extendVault();n.respond(Object(N.r)())},onClose:function(){window.location.href="/"},onLayerDidMount:function(){n.respond(Object(N.n)())},onDismiss:function(){window.location.href="/"}});break;case r.Locked:a=s.createElement(R,{onUnlock:function(){window.location.reload()},onClose:function(){window.location.href="/"},onLayerDidMount:function(){n.respond(Object(N.n)())},onDismiss:function(){window.location.href="/"}});break;case r.Unlocked:window.location.reload();break;case r.Extended:a=null}return s.createElement("div",null,a)}function q(e){var t=e.onExtend,n=e.onClose,r=e.onLayerDidMount,i=e.onDismiss;return s.createElement(U,{title:D.r,subText:D.e,onOk:t,okText:D.n,onCancel:n,cancelText:D.t,onLayerDidMount:r,onDismiss:i})}function R(e){var t=e.onUnlock,n=e.onClose,r=e.onLayerDidMount,i=e.onDismiss;return s.createElement(U,{title:D.o,subText:D.i,onOk:t,okText:D.u,onCancel:n,cancelText:D.s,onLayerDidMount:r,onDismiss:i})}function U(e){var t=e.title,n=e.subText,r=e.okText,i=e.onOk,o=e.cancelText,u=e.onCancel,a=e.onLayerDidMount,f=e.onDismiss;return s.createElement(P.e,{minWidth:480,hidden:!1,type:H.e.normal,modalProps:{isOpen:!0,isBlocking:!0,layerProps:{onLayerDidMount:a}},onDismiss:f,dialogContentProps:{title:t,subText:n}},s.createElement(B.e,null,r?s.createElement(j.e,{onClick:i,text:r}):null,o?s.createElement(F.e,{onClick:u,text:o}):null))}var z=n(270),W=(n(566),n(36)),X=n(69),V=n(6),$=n(48),J=n(212),K=n(23),Q=n(242),G=n(47),Y=n(474),Z=n(5),ee=n(283),te=(function(e){Object(i.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getItem=function(t){var n,r=this._urlDataSource.getKeyParams(t.parentKey),i=this._urlDataSource.getQueryType(r);t.qosName=t.qosName||"Odc.".concat(Z.e[i],".ItemDataSource.getItem");switch(i){case Z.e.SharedWithMe:n=this._getSharedDataSource().then(function(e){return e.getItem(t)});break;case Z.e.Recent:n=this._getRecentDataSource().then(function(e){return e.getItem(t)});break;case Z.e.RecycleBin:n=this._getRecycleBinDataSource().then(function(e){return e.getItem(t)});break;case Z.e.Search:n=this._getSearchDataSource().then(function(e){return e.getItem(t)});break;default:n=e.prototype.getItem.call(this,t)}return n};t.prototype._getRecentDataSource=function(){var e=this,t=S.n.resolve(n.ee([163],1589)).then(ee.e).then(function(t){return new(e.managed(t))});this._getRecentDataSource=function(){return t};return t};t.prototype._getSearchDataSource=function(){var e=this,t=S.n.resolve(n.ee([166,"ondemand.resx-ondemand"],1590)).then(ee.e).then(function(t){return new(e.managed(t))});this._getSearchDataSource=function(){return t};return t};t.prototype._getRecycleBinDataSource=function(){var e=this,t=S.n.resolve(n.ee([164],1591)).then(ee.e).then(function(t){return new(e.managed(t))});this._getRecycleBinDataSource=function(){return t};return t};t.prototype._getSharedDataSource=function(){var e=this,t=S.n.resolve(n.ee([168],1592)).then(ee.e).then(function(t){return new(e.managed(t))});this._getSharedDataSource=function(){return t};return t};return t})(Y.e),ne=n(7),re=n(161),ie=(function(e){Object(i.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.getThumbnails=function(e,t,n){void 0===n&&(n=null);var r=t.map(se).join(",");return this.resources.consume(re.e).send({apiName:"thumbnails",path:"/drives/".concat(e.driveId,"/items/").concat(e.itemId,"/thumbnails?select=").concat(r).concat(n?"&authkey=".concat(n):""),needsAuthorization:!n})};t.prototype.getThumbnailForLargestDimension=function(e,t,n){return n?this.getThumbnailForSize(e,t,999999):this.getThumbnailForSize(e,999999,t)};t.prototype.getThumbnailForSize=function(e,t,n){var r="c".concat(t,"x").concat(n);return e.value[0][r]};return t})(ne.n);function se(e){return"c".concat(e.width||999999,"x").concat(e.height||999999)}var oe=n(91),ue=n(149),ae=n(17),fe=n(339),le=n(2),ce=n(4),he={ODC:"DisableTeachingBubbleForTABTest"},pe={ODB:-834},de=n(10),ve=n(92),me=n(99),ge=n(46),ye=n(449),be=n(371),we=n(281),Ee=n(256),Se=(function(){function e(e,t){void 0===e&&(e={});this._dataStore=new me.e("TeachingBubbleProvider",ge.e.session);this._identityDataSource=t.identityDataSource;this._userInfoProvider=t.userInfoProvider;this._navigation=t.navigation;this.currentBubble=new Ee.e(void 0);this._bubbles=[];this._navigation.viewParams.resetAllBubbles&&this._resetAllBubbles();var n=this._navigation.viewParams.resetBubbleByGuid;n&&this._resetBubbleByGuid(n)}e.prototype.showNextBubble=function(){var e=this.getNextBubble();this.clearCurrentBubble();for(;e&&this.hasBubbleBeenSeenThisSession(e.campaign);)e=this.getNextBubble();e&&this._setCurrentBubble(e)};e.prototype.getNextBubble=function(){return this._bubbles.pop()};e.prototype.clearCurrentBubble=function(){this.currentBubble&&this.currentBubble.set(null)};e.prototype.addBubble=function(e){var t=this,n=e.bubble;return n?this.shouldBubbleBeAdded(n,!1).then(function(n){if(n){t._addBubbleToQueue(e);return!0}return!1}):S.n.wrap(!1)};e.prototype.shouldBubbleBeAdded=function(e,t,n,r,i){var s=this;void 0===i&&(i=!0);if(Object(le.isFeatureEnabled)(he)||Object(le.isFeatureEnabled)(pe))return S.n.wrap(!1);if(r){var o=this._checkShouldBubbleBeAdded(e,t,r);return S.n.wrap(o)}return this._userInfoProvider.getBubbleUserFact(e,n,i).then(function(n){return s._checkShouldBubbleBeAdded(e,t,n)})};e.prototype.markBubbleAsDismissed=function(e){var t=this;return this._userInfoProvider.getBubbleUserFact(e).then(function(n){n.d=!0;var r=t._userInfoProvider.setBubbleUserFact(e,n);t.markBubbleAsSeen(e);ve.e.logData({name:"TeachingBubble.Dismissed",extraData:{campaignGuid:e.campaignGuid}});t.showNextBubble();return r})};e.prototype.markBubbleAsSeen=function(e){var t=this;this.markBubbleAsSeenThisSession(e);return this._userInfoProvider.getBubbleUserFact(e).then(function(n){n.v++;ve.e.logData({name:"TeachingBubble.Seen",extraData:{campaignGuid:e.campaignGuid}});return t._userInfoProvider.setBubbleUserFact(e,n)})};e.prototype.hasBubbleBeenSeen=function(e){return this._userInfoProvider.getBubbleUserFact(e).then(function(e){return e.v>0})};e.prototype.hasBubbleBeenSeenToday=function(e){var t=this._dataStore.getValue(this.getTeachingBubbleCampaignSessionSeenTimeKey(e),ge.e.local);return!!t&&(t-(new Date).getTime())/864e5<1};e.prototype.markBubbleAsSeenThisSession=function(e){this._dataStore.setValue(this.getTeachingBubbleCampaignSessionSeenKey(e),!0);this._dataStore.setValue(this.getTeachingBubbleCampaignSessionSeenTimeKey(e),(new Date).getTime(),ge.e.local)};e.prototype.hasBubbleBeenSeenThisSession=function(e){return this._dataStore.getValue(this.getTeachingBubbleCampaignSessionSeenKey(e))};e.prototype.getTeachingBubbleCampaignSessionSeenKey=function(e){return"Seen"+e.campaignGuid};e.prototype.getTeachingBubbleCampaignSessionSeenTimeKey=function(e){return"SeenTime"+e.campaignGuid};e.prototype._checkShouldBubbleBeAdded=function(e,t,n){var r=!this._identityDataSource||this._identityDataSource.getIdentity().type!==ue.e.anonymous,i=e.maxUserViewCount||we.t,s=Object(le.isFeatureEnabled)(le.EnableTeachingBubbles)||t,o=Object(le.isFeatureEnabled)(e.flag)||!(!e.experimentId||!Object(be.t)(e.experimentId,e.flag)),u=!e.killSwitchGuid||!de.e.isActivated(e.killSwitchGuid);return s&&r&&n&&o&&u&&!this.hasBubbleBeenSeenThisSession(e)&&this._isExperimentEnabled(e)&&!n.d&&n.v<i};e.prototype._isExperimentForceEnabled=function(e){if(!e)return!1;var t=e.getExperimentData();return t&&t.name&&!!this._navigation.viewParams[t.name]};e.prototype._isExperimentEnabled=function(e){if(!e.experimentData)return!0;var t=this._getExperiment(e);return!t||(this._isExperimentForceEnabled(t)||t.IsExperimentOn())};e.prototype._getExperiment=function(t){if(t.experimentData&&t.experimentData.name){var n=t.experimentData.name;e.experiments[n]||(e.experiments[n]=new ye.t(t.experimentData,t.aaToABExperimentFlight));return e.experiments[n]}};e.prototype._resetBubbleCampaignUserFact=function(e){this._userInfoProvider.setBubbleUserFact(e,{d:!1,v:0})};e.prototype._resetCampaignSeenSessionStorage=function(e){this._dataStore.remove(this.getTeachingBubbleCampaignSessionSeenKey(e))};e.prototype._resetAllBubbles=function(){var e=this;this._iterateThroughBubbles(function(t){e._resetBubbleCampaignUserFact(t);e._resetCampaignSeenSessionStorage(t)})};e.prototype._resetBubbleByGuid=function(e){var t=this;this._iterateThroughBubbles(function(n){if(n.campaignGuid===e){t._resetBubbleCampaignUserFact(n);t._resetCampaignSeenSessionStorage(n)}})};e.prototype._iterateThroughBubbles=function(e){for(var t in fe)fe[t].campaignGuid&&e(fe[t])};e.prototype._setCurrentBubble=function(e){this.currentBubble.set(e)};e.prototype._addBubbleToQueue=function(e){var t=e.bubble,n=e.element;this._bubbles.unshift({campaign:t,anchorElement:n});this.currentBubble.get()||this.showNextBubble()};e.dependencies={identityDataSource:V.h.optional,userInfoProvider:G.m,navigation:W.e};e.experiments={};return e})(),xe=Object(X.s)("TeachingBubbleProvider",Se),Te=n(3),Ne=new Te.t({name:"FloodgateDataSource.key",loader:new X.t(function(){return n.ee([118,"ondemand.resx-ondemand"],1664).then(function(e){return e.resourceKey})})}),Ce=n(32),ke=(function(){function e(e,t){this._navigation=t.navigation;this._mayBeFastOneUp=!!Object(ce.qo)(ce.an)&&!!this.getFocusItemKey(this._navigation.viewParams);this._isFastOneUp=this._mayBeFastOneUp}e.prototype.checkIsFastOneUp=function(){return this._isFastOneUp};e.prototype.resetIsFastOneUp=function(){this._isFastOneUp=!1};e.prototype.getCurrentItemKey=function(e){void 0===e&&(e=this._navigation.viewParams);return Object(O.o)(e)};e.prototype.getKey=function(e){return Object(O.v)(e)};e.prototype.getKeyParams=function(e){return Object(O.m)(e)};e.prototype.getQueryType=function(e){void 0===e&&(e=this._navigation.viewParams);return Object(O.N)(e)};e.prototype.getPageType=function(e,t){void 0===e&&(e=this._navigation.viewParams);return Object(O.E)(e,this._mayBeFastOneUp||t)};e.prototype.getSubQueryType=function(e,t){void 0===e&&(e=this._navigation.viewParams);return Object(O.L)(e,t)};e.prototype.getFocusItemKey=function(e){void 0===e&&(e=this._navigation.viewParams);var t=null;if(e.parId||e.parQt||e.parCid){(t={}).id=e.id;t.qt=e.qt;t.cid=e.cid;t.internalPath=e.internalPath;delete t.u}return t&&Object(O.v)(t)||null};e.prototype.getRootItemKey=function(e){void 0===e&&(e=Z.e.Files);return Object(O.k)(e)};e.prototype.getDefaultRootItemId=function(){return"root"};e.prototype.getApiBaseUrl=function(e){return Object(Ce.o)(e)};e.prototype.getNavLinkClickUrl=function(e){return""};e.dependencies={navigation:W.e,resources:Te.s};return e})(),Le=Object(X.s)("UrlDataSourceLite",ke),Ae=n(455),Oe=n(323),Me=n(16),_e=!Me.t.isActivated("261E9FAA-0D80-41B7-A45F-FD8A6AE6327C","04/04/2021","Capture referral origin information"),De=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._navigation=n.resources.consume(W.e);n._identityDataSource=n.resources.consume(J.e);n._urlDataSourceLite=n.resources.consume(Le);n._teachingBubbleProvider=n.resources.consume(xe);n._firstRunExperienceStatus=n.resources.consume(Ae.e);return n}t.prototype.getEngagementData=function(e){var t=this._navigation.viewParams.ocid||this._navigation.viewParams["WT.mc_id"],n={referralOrigin:t};return e===ae.e[ae.e.StorageOptions]?Object(i.__assign)({purchaseSource:t},_e&&t&&n):_e&&t?n:void 0};t.prototype.userExecuteAction=function(e){var t=this;if(Object(le.isFeatureEnabled)(le.EnableFloodgate)&&e){var n=e.name;this.resources.consumeAsync(Ne).then(function(e){0===n.indexOf("Upload")&&(n="Upload");if(t._identityDataSource.getIdentity().type!==ue.e.anonymous){"NewSession"===n&&t._isValidNpsSurveyContext()&&e.recordUserAction("NewNpsSession");t._isMeaningfulNpsAction(n)&&e.recordUserAction("MeaningfulNpsAction");"Navigation"===n&&Object(Ce.f)(t._navigation.viewParams)&&e.recordUserAction("EnteredAllPhotosView")}e.recordUserAction(n)})}};t.prototype.userSeeItem=function(e){};t.prototype._isValidNpsSurveyContext=function(){var e=this._urlDataSourceLite.getPageType(),t=e===ae.e.Files||e===ae.e.Photos;return!this._teachingBubbleProvider.currentBubble.get()&&this._firstRunExperienceStatus.get()!==Oe.e.visible&&t};t.prototype._isMeaningfulNpsAction=function(e){return"Open.File"===e||"Open.Media"===e||/OpenIn[a-zA-z]+/.test(e)||"Upload"===e||"CreateFolder"===e||/Create[a-zA-Z]+DocumentAction/.test(e)};return t})(oe.e),Pe=n(164),He=n(426),Be=n(163),je=(function(){function e(){}e.prototype.trackUserAction=function(e){if(!this._hasReported)if(this._startEngagement){var t=this._getActionName(e);if(t){this._endEngagement=e;this._report(t)}}else"ItemsView.Load"===e.name&&("101"!==e.listTemplateId&&"700"!==e.listTemplateId&&"Recent"!==e.objectType&&"Files-RecentSpartan"!==e.currentPage&&"Files-Home"!==e.currentPage&&"SharedWithMe"!==e.objectType&&"Files-SharedWithMeSpartan"!==e.currentPage&&"SharedByMe"!==e.objectType&&"Files-SharedByMeSpartan"!==e.currentPage&&"Files-Favorites"!==e.currentPage||(this._startEngagement=e))};e.prototype._getActionName=function(e){switch(e.name){case"Open.File":case"Open.Media":return"Open";case"Open":if("File"!==e.objectType)return;return"Open";case"CopyLink":case"CopyTo":case"CreateDocument":case"CreateFolder":case"Delete":case"Download":case"ItemPicker.Complete":case"MoveTo":case"OpenInOfficeClient":case"OpenInOfficeOnline":case"OpenInImmersiveReader":case"Upload":case"Rename":case"Share":case"Favorite":case"Unfavorite":return e.name;case"ShareAction":return"Share";case"CopyLinkAction":return"CopyLink";case"OpenItemAction":return"Open";case"UploadFileAction":case"UploadFolderAction":return"Upload"}};e.prototype._report=function(e){if(this._startEngagement&&this._endEngagement){ve.e.logData(Object(i.__assign)(Object(i.__assign)({},this._endEngagement),{action:e,name:"TimeToFile",isIntentional:!0,extraData:Object(i.__assign)(Object(i.__assign)({"TimeToFile.Duration":performance.now()},this._endEngagement.extraData),Object(A.t)(this._startEngagement.extraData,function(e){return e},function(e){return"extraData"===e?void 0:"entry.".concat(e)}))}));this._hasReported=!0}};return e})(),Fe=Object(X.s)("TimeToFileReporter",je,{}),Ie=n(75),qe=n(133),Re=new Te.t({name:"SearchSession.key",factory:new Te.e(qe.e.generate())}),Ue=n(154),ze=n(247),We=n(22),Xe=Object(ze.e)({eventName:"Page,",shortEventName:"Page"},{previousName:We.e.String,currentName:We.e.String}),Ve=n(733),$e=!Me.e.isActivated("DA910F66-8C98-428B-8A0F-C9BDE6481EB9","08/26/2022","Perform extra sanitization prior to logging extension, part 2"),Je={".doc":!0,".docx":!0,".ppt":!0,".pptx":!0},Ke=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t)||this;r.searchSessionStarted=!1;r._dataStore=new me.e("",ge.e.session);r._instrumentationDataSource=n.instrumentationDataSource||r.resources.consume(V.p.optional);r._pageEvent=void 0;r._engagement=n.engagement||r.resources.consume(Ue.e);r._searchSession=n.searchSession||r.resources.consume(Re.optional);r._timeToFileReporter=n.timeToFileReporter||r.resources.consume(Fe);return r}t.prototype.logStartSearchOnSubmit=function(){var e,t;if(!this.searchSessionStarted){var n={name:"StartSearchSession",location:"NA",usageType:Be.e[Be.e.Click],currentPage:this.currentPageName()||"NA",previousPage:this.previousPageName()||"NA",extraData:{searchSessionId:this._searchSession}};this._startSearchSession();this._engagement.logData(n)}null===(t=null===(e=this._instrumentationDataSource)||void 0===e?void 0:e.onSearchStarted)||void 0===t||t.call(e)};t.prototype.currentPageName=function(){return this._pageEvent&&this._pageEvent.data&&this._pageEvent.data.currentName};t.prototype.previousPageName=function(){return this._pageEvent&&this._pageEvent.data&&this._pageEvent.data.previousName};t.prototype.userViewPage=function(e){var t=e.name,n="(none)";if(this._pageEvent){n=this._pageEvent.data.currentName;this._pageEvent.end();this.userExecuteAction({name:"NavigatePage"})}this._pageEvent=new Xe({currentName:t,previousName:n});this._engagement.logData({name:"Page.View",location:"NA",usageType:Be.e[Be.e.Click],currentPage:t,previousPage:n,extraData:this._getExtraData(t,e)})};t.prototype.userSeeItem=function(e){var t,n;if(this._instrumentationDataSource){this._instrumentationDataSource.userSeeItem(e);Object(Ie.e)(e.queryType)&&(null===(n=(t=this._instrumentationDataSource).logSearchResultsRendered)||void 0===n||n.call(t))}};t.prototype.userExecuteAction=function(e){this._instrumentationDataSource&&this._instrumentationDataSource.userExecuteAction(e);this._timeToFileReporter&&this._timeToFileReporter.trackUserAction({name:e.name,currentPage:this.currentPageName()||"NA",previousPage:this.previousPageName()||"NA",extraData:this.getEngagementData()||{}})};t.prototype.userClickItem=function(e){var t=Pe.e[Pe.e.bingClickInstrumentation];if(Object(Ie.e)(e.queryType)&&e.urls&&e.urls[t]){var n=new g.e({name:"SearchResultClickItem"});He.e(e.urls[t]).done(function(){n.end({resultType:g.t.Success})},function(){n.end({resultType:g.t.Failure,extraData:{url:e.urls[t]}})})}this._logOfficeDocAge(e)};t.prototype.userClickSuggestion=function(e){if(e){var t=new g.e({name:"SearchSuggestionClickItem"});He.e(e).done(function(){t.end({resultType:g.t.Success})},function(){t.end({resultType:g.t.Failure,extraData:{url:e}})})}};t.prototype.getEngagementData=function(e){return this._getExtraData(void 0,e)};t.prototype.logSearchResultsRendered=function(){var e,t;null===(t=null===(e=this._instrumentationDataSource)||void 0===e?void 0:e.logSearchResultsRendered)||void 0===t||t.call(e)};t.prototype._getExtraData=function(e,t){return this._instrumentationDataSource?this._instrumentationDataSource.getEngagementData(e||this.currentPageName(),t):null};t.prototype._startSearchSession=function(){this.searchSessionStarted=!0};t.prototype._logOfficeDocAge=function(e){if(e&&e.dateModifiedValue)try{var t=e&&e.extension&&e.extension.toLowerCase();if(t){var n=$e?Object(Ve.e)(t):t,r=this._engagement;r.logData({name:"File.Clicked",currentPage:this.currentPageName()||"NA",previousPage:this.previousPageName()||"NA",extraData:{extension:n,size:e.size}});"ms-word"===e.appMap||"ms-powerpoint"===e.appMap?this._dataStore.setValue("OfficeDocClickTime",new Date):this._dataStore.setValue("OfficeDocClickTime","");if(Je[t]){var i=new Date(e.dateModifiedValue),s=Math.ceil(((new Date).getTime()-i.getTime())/1e3);s>0&&r.logData({name:"OfficeDocument.Clicked",extraData:{extension:n,age:s,dateModified:e.dateModifiedValue}})}}}catch(e){}};t.dependencies=Object(i.__assign)(Object(i.__assign)({},oe.e.dependencies),{instrumentationDataSource:V.p.optional,engagement:Ue.e,searchSession:Re.optional,timeToFileReporter:Fe});return t})(oe.e),Qe=Ke,Ge=(Object(X.s)("InstrumentationProvider",Ke),n(515)),Ye=n(40),Ze=n(93),et=n(167),tt=n(113),nt=n(268),rt=n(237),it=!Me.e.isActivated("8C62316A-3AF9-4CDB-875D-5C08EA8E7C21","02/24/2022","Stash ODC test hooks to window so that they persist throughout page load and in-app navigations"),st=window.$Config&&window.$Config.isINT,ot=1;Object(le.isFeatureEnabled)(le.EnableSecurityMomentLightbox)&&(ot=2);var ut=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r._pendingRequests={};r._currentParamUpsells={};r._navigation=r.resources.consume(W.e);return r}t.prototype.canPersistUserInfo=function(){return!0};t.prototype.getCurrentParamUpsells=function(){return this._currentParamUpsells};t.prototype.setCurrentParamUpsells=function(e){this._currentParamUpsells=e};t.prototype.getAnid=function(){return Ze.e.getAnid()};t.prototype.getMarket=function(){return Ze.e.getMarket()};t.prototype.getLanguage=function(){return Ze.e.getLanguage()};t.prototype.isNewUser=function(){return Ze.e.isNewUser()};t.prototype.isAuthenticated=function(){return Ze.e.isAuthenticated()};t.prototype.getUserInfo=function(e){var t=this,n=Object(nt.e)(),r=e?n+"?v="+Math.random():n,i=new Ye.e;if(this._pendingRequests[n])return this._pendingRequests[n];if(!this.isAuthenticated()||!e&&this._cachedUserInfo)return S.n.wrap(this._cachedUserInfo);var s=i.send({apiName:"GetUserInfo",url:r}).then(function(e){delete t._pendingRequests[n];t._cachedUserInfo=e;if(e&&e.notifications)for(var r=0,i=e.notifications;r<i.length;r++){var s=i[r];7===s.type&&s.param&&(t._currentParamUpsells=JSON.parse(s.param))}if(e&&e.info)for(var o=0,u=e.info;o<u.length;o++){var a=u[o];24===a.type&&(t._positioningData=a)}return e},function(e){delete t._pendingRequests[n];return S.n.wrapError(e)});this._pendingRequests[n]=s;return s};t.prototype.setUserInfo=function(e){var t=Object(nt.t)();return(new Ye.e).sendPostUrlEncoded("SetUserInfo",t,JSON.stringify(e)).then(function(e){return!(!e||e.error)})};t.prototype.setUserInfoWithUserFacts=function(e,t,n,r,i){var s={type:e,action:t};n&&(s.param=n);i&&(s.data=i);r&&(s.id=r);n&&7===e&&(this._currentParamUpsells=JSON.parse(n));return this.setUserInfo(s)};t.prototype.sendShowUpsell=function(e,t,n){return this._sendUpsell(e,t,n,"SHOWED")};t.prototype.sendCloseUpsell=function(e,t,n){return this._sendUpsell(e,t,n,"CLOSE")};t.prototype.resetUpsellUserFact=function(){return this.setUserInfoWithUserFacts(7,3,JSON.stringify({}))};t.prototype.handleUpdateUpsellData=function(e,t,n){var r=this.getUpsellVariationIfApplicable(e),i=this._currentParamUpsells[r.id];if(i){t&&(i.d=1);n&&i.v++}else this._currentParamUpsells[r.id]={d:t?1:0,v:n?1:0}};t.prototype.updateUpsellData=function(e,t,n){this.handleUpdateUpsellData(e,t,n);return this.setUserInfoWithUserFacts(7,3,JSON.stringify(this._currentParamUpsells))};t.prototype.hasUserFact=function(e){var t=this;return this.getUserInfo(!1).then(function(n){var r=!1;if(!t._cachedUserInfo)throw new Error("CachedUserInfo is not defined when trying to access user fact");(r=t._cachedUserInfo.info.some(function(t){return t.type===e&&t.isSet}))||(r=t._cachedUserInfo.rewards.some(function(t){return t.type===e&&t.isSet}));return r})};t.prototype.getUserFact=function(e){return this.getUserInfo(!1).then(function(t){if(t&&t.info)for(var n=t.info,r=0;r<n.length;r++)if(n[r].type===e)return n[r];return null})};t.prototype.getIsPremium=function(e){return this.getUserInfo(e).then(function(e){if(e&&e.info)for(var t=e.info,n=0;n<t.length;n++)if(35===t[n].type)return!0;return!1})};t.prototype.getUpsellToShow=function(e){var t=this._checkForParamOverrides();return null!==t?S.n.wrap(t):this.checkThrottle(et.t[tt.e.OneRmO365Upsell]).then(function(e){return e?et.t[tt.e.OneRmO365Upsell]:null})};t.prototype.getUpsellViewCount=function(e){var t=this,n=this.getUpsellVariationIfApplicable(e);return this.getUserInfo(!1).then(function(e){var r=0;t._currentParamUpsells[n.id]&&(r=t._currentParamUpsells[n.id].v);return r},function(e){return null})};t.prototype.getUpsellDismissed=function(e){var t=this,n=this.getUpsellVariationIfApplicable(e);return this.getUserInfo(!1).then(function(e){var r=!1;t._currentParamUpsells[n.id]&&(r=!!t._currentParamUpsells[n.id].d);return r},function(e){return null})};t.prototype.checkThrottle=function(e){var t=this._navigation.viewParams,n=this.getUpsellDismissed(e),r=this.getUpsellViewCount(e);return S.n.all({didUserDismiss:n,viewCount:r}).then(function(n){var r=n.didUserDismiss,i=n.viewCount;return null!==r&&null!==i&&e.checkThrottle({viewCount:i,didUserDismiss:r,viewParams:t,market:$Config.mkt})})};t.prototype.getUpsellIframeSrc=function(e,t){var n=this;return this.getUserInfo(!1).then(function(r){if(e.getUpsellIframeUrl)return n.getIsPremium(!1).then(function(r){return e.getUpsellIframeUrl({anid:n.getAnid(),market:$Config.mkt,override:0,isNewUser:n.isNewUser(),upsellUserId:$Config.upsellUserId,variationId:e.id,availableUpsells:et.t,isO365:r,bytesAvailable:n._getTotalQuotaInBytes(t),bytesUsed:n._getQuotaUsedInBytes(t)})})})};t.prototype.getUpsellVariationIfApplicable=function(e){return e.variation?et.t[e.variation]:e};t.prototype.getUpsellDismissedById=function(e,t){return S.n.wrap(void 0)};t.prototype.getUpsellViewCountById=function(e,t){return S.n.wrap(void 0)};t.prototype.markUpsellAsSeen=function(e){return S.n.wrap(void 0)};t.prototype.markUpsellAsDismissed=function(e){return S.n.wrap(void 0)};t.prototype.getFirstRunExperienceDismissed=function(){var e=this;return this.getUserInfo(!1).then(function(t){var n=!1;e._currentParamUpsells[tt.e.FirstRunExperienceDialog]&&(n=!!e._currentParamUpsells[tt.e.FirstRunExperienceDialog].d);return n},function(e){return!0})};t.prototype.getFirstRunExperienceViewCount=function(){var e=this;return this.getUserInfo(!1).then(function(t){var n=0,r=e._currentParamUpsells[tt.e.FirstRunExperienceDialog];r&&(n=r.v);return n})};t.prototype.updateFirstRunExperienceData=function(e,t){this.handleUpdateFirstRunExperienceData(e,t);return this.setUserInfoWithUserFacts(7,3,JSON.stringify(this._currentParamUpsells))};t.prototype.handleUpdateFirstRunExperienceData=function(e,t){var n=this._currentParamUpsells[tt.e.FirstRunExperienceDialog];if(n){e&&(n.d=1);t&&n.v++}else this._currentParamUpsells[tt.e.FirstRunExperienceDialog]={d:e?1:0,v:t?1:0}};t.prototype.hasPositioningBeenViewed=function(){var e=this;return this.getUserInfo(!1).then(function(){return!!e._positioningData},function(e){return!0})};t.prototype.datePositioningViewed=function(){var e=this;return this.getUserInfo(!1).then(function(){var t=e._positioningData;if(t)return new Date(t.createdDate+"z")})};t.prototype.getPremiumUpsellsViewed=function(){return S.n.all({hasPositioningViewed:this.hasPositioningBeenViewed(),hasNewFeaturesViewed:this.getMostRecentNewFeaturesUpsellViewed()})};t.prototype.getMostRecentNewFeaturesUpsellViewed=function(){var e=this;return this.getUserInfo(!1).then(function(){var t=e._positioningData;if(t){if(t.param){return JSON.parse(t.param).v>=ot}return!1}return!0},function(e){return!0})};t.prototype.setPositioningUserFactWithParams=function(e){if(Object(le.isFeatureEnabled)(le.DisablePremiumUserFactUpdate))return S.n.resolve(!0);var t={v:0};this._positioningData&&this._positioningData.param&&(t=JSON.parse(this._positioningData.param));e&&(t.v=ot);return this.setUserInfoWithUserFacts(24,3,JSON.stringify(t),"78f745e2-e4f9-4734-8a08-454e12832a22")};t.prototype.getExpiringSharingLinksSeen=function(){var e=this;return this.getUserInfo(!1).then(function(t){var n=e._currentParamUpsells[tt.e.ExpiringSharingLinks];return n&&!!n.d},function(e){return!0})};t.prototype.setExpiringSharingLinksSeen=function(){var e=this._currentParamUpsells[tt.e.ExpiringSharingLinks];e?e.d=1:this._currentParamUpsells[tt.e.ExpiringSharingLinks]={d:1,v:1};this.setUserInfoWithUserFacts(7,3,JSON.stringify(this._currentParamUpsells))};t.prototype._checkForParamOverrides=function(){var e=this._navigation.viewParams,t=ft(rt.e.upsellOverride,e);if(t)return et.t[t];ft(rt.e.resetUpsellParams,e)&&this.resetUpsellUserFact();return null};t.prototype._getTotalQuotaInBytes=function(e){return e&&e.properties&&e.properties.quota&&e.properties.quota.total};t.prototype._getQuotaUsedInBytes=function(e){var t=this._getTotalQuotaInBytes(e);return t?t-e.properties.quota.remaining:null};t.prototype._sendUpsell=function(e,t,n,r){var i=new Ye.e,s=st?et.n:et.e,o={CampaignId:e.CampaignID,ContentId:e.MessageID,Id:t,Locale:n,Source:"OneDriveWebBanner",TransactionID:e.TransactionID,Type:0,UserAction:r},u="".concat(s,"api/v1/messaging/web/useraction?").concat(_.n(o));return i.sendPost("OneRM",u,"").then(function(e){return!0},function(e){return!1})};return t})(ne.n),at=ut;function ft(e,t){return it?Object(rt.t)(e,t):t[e]}Object(X.s)("UserInfoDataSource",ut);var lt=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._embedDataSource=n.resources.consume(V.s);return n}t.prototype.getEmbedInfo=function(e){return this._embedDataSource.getEmbedInfo(e)};t.prototype.createEmbedLink=function(e){return this._embedDataSource.createEmbedLink(e)};return t})(ne.n),ct=Object(s.createContext)({});function ht(e){var t=e.diagnostics,n=e.children;return s.createElement(ct.Provider,{value:{diagnostics:t}},n)}var pt=n(410);function dt(e){var t,n,r=Object(s.useRef)(null),i=Object(s.useState)(null),o=i[0],u=i[1],a=Object(s.useState)(null),l=a[0],c=a[1],h=Object(s.useState)(null),p=h[0],v=h[1],m=e.bootstrapParams,y=Object(s.useContext)(ct).diagnostics,b=Object(s.useRef)(e.onStart),E=Object(s.useRef)(e.onSucceed),S=Object(s.useRef)(e.onFailed),x=Object(s.useRef)(e.onTimeout);Object(s.useEffect)(function(){b.current=e.onStart;E.current=e.onSucceed;S.current=e.onFailed;x.current=e.onTimeout},[e.onStart,e.onSucceed,e.onFailed,e.onTimeout]);Object(s.useEffect)(function(){return(function(){var e;if(r.current&&y){null===(e=b.current)||void 0===e||e.call(b);var t,n=Date.now();y.update({bootState:d.JSApiBootStarted,officeInitializationTime:n,hostInitializeCallTime:n});w(r.current,m,y.data).then(function(e){var n,i=e.application,s=e.session,o=e.wacAppDiagnostics;y.update({wacHostCompleteTime:Date.now(),wacAppDiagnostics:o});t=function(){if(i&&i.Dispose){i.Dispose();i=null}};var a=r.current.querySelector("iframe");u(a);c(i);v(s);null===(n=E.current)||void 0===n||n.call(E)},function(e){var t;y.update({wacHostCompleteTime:Date.now()});null===(t=S.current)||void 0===t||t.call(S,e)});y.update({bootState:d.JSApiBootPendingComplete});var i=function(){var e;(null===(e=y.data)||void 0===e?void 0:e.bootState)===d.JSApiBootPendingComplete&&m.triggerLogEvent({bootState:d.JSApiBootFailed,resultType:g.t.ExpectedFailure,resultCode:"UserNavAway",errorInfo:"User navigate away"})};window.addEventListener("beforeunload",i);return function(){window.removeEventListener("beforeunload",i);t&&t()}}})()},[y,m]);return s.createElement(s.Fragment,null,s.createElement("div",{id:"WACContainer",ref:r}),s.createElement(pt.e,{targetOrigin:(t=m.ApplicationUrl,n=new f.t(t,{queryCaseInsensitive:!0}),n.getLeftPart(f.e.authority)),logOnly:m.UseV2,iframeElem:o,allowedOrigins:m.AllowedOrigins,migrationState:m.MigrationState}),s.createElement(pt.t,{application:l,session:p,migrationState:m.MigrationState}))}var vt=n(162);function mt(e){var t=e.context,n=e.eventType,r=e.handler,i=Object(vt.t)().dispatcher,o=Object(s.useCallback)(function(e){return r(e,t,i)},[r,t,i]);Object(s.useEffect)(function(){if(i&&n){i.addEventListener(n,o);return function(){i.removeEventListener(n,o)}}},[i,n,o]);return null}var gt,yt=n(722),bt=n(165);(function(e){e.COB_UpdateUI="COB_UpdateUI";e.COB_SyncPageContext="COB_SyncPageContext"})(gt||(gt={}));var wt=n(44),Et=n(195),St=n(501),xt=n(482),Tt=n(282),Nt=(function(e){Object(i.__extends)(t,e);function t(){var t=e.call(this)||this;t._dataRequestor=t.resources.consume(St.e);t._urlDataSource=t.resources.consume($.n);return t}t.prototype.getEmbedInfo=function(e){return Object(i.__awaiter)(this,void 0,S.n,function(){var t,n,r,s,o=this;return Object(i.__generator)(this,function(u){switch(u.label){case 0:return Object(le.isFeatureEnabled)(le.EnableGraphApiGetEmbedInfo)?[4,this.resources.consumeAsync(V.h)]:[3,3];case 1:t=u.sent();this._dataRequestor=new Tt.t({},{urlDataSource:{getApiBaseUrl:function(){return"https://graph.microsoft.com/beta"}},sessionManagementProvider:{getToken:function(){return Object(i.__awaiter)(o,void 0,S.n,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return t?[4,t.getGraphToken({})]:[3,2];case 1:return[2,e.sent()];case 2:return[2,S.n.reject("Could not retrieve identity data source")]}})})}}});this._sharingService=new xt.e({},{dataRequestor:this._dataRequestor});return[4,this._sharingService.getPermissions(e.id)];case 2:n=u.sent();return[2,this._parsePermissions(n)];case 3:r=new Ye.e;s=this._urlDataSource.getEmbedInfoUrl(e);return[2,r.send({apiName:"GetEmbedInfo",url:s,useDefaultHeaders:!0,isErrorExpectedCallback:this._isExpected}).then(function(e){return{embedCode:e.embedCode,embedUrl:e.embedUrl,configuratorUrl:e.embedConfiguratorUrl}},function(e){return o._isExpected(e)?null:S.n.wrapError(e)})]}})})};t.prototype.createEmbedLink=function(e){var t=this,n={type:"embed"};return this._getItemUrl(e).then(function(e){var r="".concat(e,"/createLink");return t._dataRequestor.send({path:r,apiName:"createLink",requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify(n||{}),getErrorAsMessage:!0}).then(function(e){var t=e.link,n=void 0===t?{}:t,r=n.webHtml,i=void 0===r?"":r,s=n.webUrl;return{embedCode:i,embedUrl:void 0===s?"":s}})})};t.prototype._parsePermissions=function(e){for(var t,n=0,r=e;n<r.length;n++){var i=r[n];if("embed"===(null===(t=i.link)||void 0===t?void 0:t.type))return{embedCode:i.link.webHtml,embedUrl:i.link.webUrl}}};t.prototype._isExpected=function(e){return e&&e.data&&3017===e.data.code};t.prototype._getItemUrl=function(e,t){return S.n.resolve(this.resources.consumeAsync(V.c).then(function(n){return n.getItemUrl(e,{apiVersion:t})}))};return t})(ne.n),Ct={EnableWacJsApiV2:{ODC:"EnableWacJsApiV2"},EnableWacOfficeWebLoader:{ODC:"EnableWacOfficeWebLoader"},EnableWacUnifiedApps:{ODC:"EnableWacUnifiedApps"},Word:{WacHostFlightWordWordJsApiV2NoWrapper:{ODC:"Wac_HostFlight_Word_WordJsApiV2NoWrapper"},WacHostFlightWordWordJsApiV2:{ODC:"Wac_HostFlight_Word_WordJsApiV2"},WacHostFlightWordODCShareLinkPreload:{ODC:"Wac_HostFlight_Word_ODCShareLinkPreload"},WacHostFlightWordWordScriptsPreload:{ODC:"Wac_HostFlight_Word_WordScriptsPreload"},WacJsApiWordView:{ODC:"Wac_JsApi_Word_View"},WacJsApiWordEdit:{ODC:"Wac_JsApi_Word_Edit"},WacJsApiWordEditNew:{ODC:"Wac_JsApi_Word_EditNew"},EnableWacUseOpenUrlInPlaceOfEditForUnifiedWord:{ODC:"EnableWacUseOpenUrlInPlaceOfEditForUnified_Word"}},Excel:{WacHostFlightExcelExcelJsApiV2NoWrapper:{ODC:"Wac_HostFlight_Excel_ExcelJsApiV2NoWrapper"},WacHostFlightExcelExcelJsApiV2:{ODC:"Wac_HostFlight_Excel_ExcelJsApiV2"},WacHostFlightExcelExcelLandingPageOfflineTelemetry:{ODC:"Wac_HostFlight_Excel_ExcelLandingPageOfflineTelemetry"},WacHostFlightExcelInstantShell:{ODC:"Wac_HostFlight_Excel_InstantShell"},WacHostFlightExcelODCShareLinkPreload:{ODC:"Wac_HostFlight_Excel_ODCShareLinkPreload"},WacHostFlightExcelExcelAdaptiveLayoutDownload:{ODC:"Wac_HostFlight_Excel_ExcelAdaptiveLayoutDownload"},WacHostFlightExcelExcelLandingPageObserver:{ODC:"Wac_HostFlight_Excel_ExcelLandingPageObserver"},WacJsApiExcelView:{ODC:"Wac_JsApi_Excel_View"},WacJsApiExcelEdit:{ODC:"Wac_JsApi_Excel_Edit"},WacJsApiExcelEditNew:{ODC:"Wac_JsApi_Excel_EditNew"},EnableWacUseOpenUrlInPlaceOfEditForUnifiedExcel:{ODC:"EnableWacUseOpenUrlInPlaceOfEditForUnified_Excel"}},PowerPoint:{WacHostFlightPowerPointPowerPointJsApiV2NoWrapper:{ODC:"Wac_HostFlight_PowerPoint_PowerPointJsApiV2NoWrapper"},WacHostFlightPowerPointPowerPointJsApiV2:{ODC:"Wac_HostFlight_PowerPoint_PowerPointJsApiV2"},WacHostFlightPowerPointODCShareLinkPreload:{ODC:"Wac_HostFlight_PowerPoint_ODCShareLinkPreload"},WacJsApiPowerPointView:{ODC:"Wac_JsApi_PowerPoint_View"},WacJsApiPowerPointEdit:{ODC:"Wac_JsApi_PowerPoint_Edit"},WacJsApiPowerPointEditNew:{ODC:"Wac_JsApi_PowerPoint_EditNew"},EnableWacUseOpenUrlInPlaceOfEditForUnifiedPowerPoint:{ODC:"EnableWacUseOpenUrlInPlaceOfEditForUnified_PowerPoint"}},OneNote:{WacHostFlightOneNoteOneNoteJsApiV2NoWrapper:{ODC:"Wac_HostFlight_OneNote_OneNoteJsApiV2NoWrapper"},WacHostFlightOneNoteOneNoteJsApiV2:{ODC:"Wac_HostFlight_OneNote_OneNoteJsApiV2"},WacHostFlightOneNoteODCShareLinkPreload:{ODC:"Wac_HostFlight_OneNote_ODCShareLinkPreload"},WacJsApiOneNoteView:{ODC:"Wac_JsApi_OneNote_View"},WacJsApiOneNoteEdit:{ODC:"Wac_JsApi_OneNote_Edit"},WacJsApiOneNoteEditNew:{ODC:"Wac_JsApi_OneNote_EditNew"},EnableWacUseOpenUrlInPlaceOfEditForUnifiedOneNote:{ODC:"EnableWacUseOpenUrlInPlaceOfEditForUnified_OneNote"}},Visio:{WacHostFlightVisioVisioJsApiV2NoWrapper:{ODC:"Wac_HostFlight_Visio_VisioJsApiV2NoWrapper"},WacHostFlightVisioVisioJsApiV2:{ODC:"Wac_HostFlight_Visio_VisioJsApiV2"},WacHostFlightVisioODCShareLinkPreload:{ODC:"Wac_HostFlight_Visio_ODCShareLinkPreload"},WacJsApiVisioView:{ODC:"Wac_JsApi_Visio_View"},WacJsApiVisioEdit:{ODC:"Wac_JsApi_Visio_Edit"},WacJsApiVisioEditNew:{ODC:"Wac_JsApi_Visio_EditNew"},EnableWacUseOpenUrlInPlaceOfEditForUnifiedVisio:{ODC:"EnableWacUseOpenUrlInPlaceOfEditForUnified_Visio"}},WacSendPerformanceLog:{ODC:"WacSendPerformanceLog"}};function kt(e,t,n){var r=e.replace(/_/g,"").replace(/\{0\}/g,t).replace(/\{1\}/g,n);return Ct[t][r]}function Lt(e){return!!e&&Object(ce.qo)(e)}function At(e,t,n){return Lt(kt(e,t,n))}var Ot=n(105),Mt=n(249),_t=n(547),Dt=n(265),Pt=n(231);var Ht,Bt=n(82),jt=n(351),Ft=n(721),It=n(42),qt=n(95),Rt=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.storageOptionsData=n.createObservable(null);n._storageOptionsDataSource=n.resources.consume(V.D);return n}t.prototype.updateStorageOptions=function(e){void 0===e&&(e=!1);if(!e&&this.storageOptionsData.peek())return S.n.wrap(this.storageOptionsData.peek());var t=new g.e({name:"GetUpgradeOptionsRetry"});return this._storageOptionsHelper(0,t)};t.prototype._storageOptionsHelper=function(e,t){var n=this;if(e<=7)return this._storageOptionsDataSource.getStorageOptions().then(function(r){t.end({resultType:g.t.Success,extraData:{retries:e}});n.storageOptionsData(r);return r},function(r){r.data&&159===r.data.code?n.async.setTimeout(function(){n._storageOptionsHelper(e+1,t)},1e3):t.end({resultType:g.t.Failure,extraData:{retries:e}})});t.end({resultType:g.t.Failure,extraData:{retries:e}})};return t})(ne.n),Ut=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._storageOptionsDataSource=n.resources.consume(V.D);n._storageOptionsRequestor=new(n.managed(Rt));n._storageOptionsRequestor.updateStorageOptions();n.isReady=n.createPureComputed(n._computeIsReady);n.isEligibleForPremium=n.createPureComputed(n._computeIsEligibleForPremium);n.isEligibleForOneDrivePlan=n.createPureComputed(n._computeIsEligibleForOneDrivePlan);n.isEligibleFor100Gbplan=n.createPureComputed(n._computeIsEligibleFor100GbPlan);n.hasOffice=n.createPureComputed(n._computeHasOffice);n.hasStoragePlan=n.createPureComputed(n._computeHasStoragePlan);n._data=n.createPureComputed(function(){return n._storageOptionsRequestor.storageOptionsData()});return n}t.prototype.getStorageOptions=function(e){void 0===e&&(e=!0);return!e&&this._data()?S.n.wrap(this._data()):this._storageOptionsDataSource.getStorageOptions()};t.prototype.getPremiumPurchaseInformation=function(e){var t=this;return this._storageOptionsRequestor.updateStorageOptions(e).then(function(e){var n=t._parsePremiumPlans(e),r=n[0],i=n[1];return r&&r.pricePerMonth?t._getPurchaseInfo(r,!0,!0):i&&i.pricePerMonth?t._getPurchaseInfo(i,!0,!1):r&&r.pricePerYear?t._getPurchaseInfo(r,!1,!0):i&&i.pricePerYear?t._getPurchaseInfo(i,!1,!1):void 0})};t.prototype.getHasCurrentOfficePlan=function(e){return this._storageOptionsRequestor.updateStorageOptions(e).then(function(e){return e.hasCurrentOfficePlan})};t.prototype.getIsEligibleForPremium=function(e){return this._storageOptionsRequestor.updateStorageOptions(e).then(function(e){if(e){if(e.hasCurrentOfficePlan)return!1;if(e.officePlans)for(var t=0,n=e.officePlans;t<n.length;t++){var r=n[t];if(qt.e[r.type]===qt.e.Home||qt.e[r.type]===qt.e.Personal||qt.e[r.type]===qt.e.Solo)for(var i=0,s=r.purchaseActions;i<s.length;i++){var o=s[i];if(1===o.durationInMonths||12===o.durationInMonths)return!0}}}return!1})};t.prototype._getHasBiggestOneDrivePlan=function(){var e,t=this._data(),n=t.oneDrivePlans,r=t.hasCurrentOfficePlan,i=null!==(e=null==n?void 0:n.length)&&void 0!==e?e:0;return!(!r||i<1)&&n[i-1].isCurrentPlan};t.prototype._areOneDrivePlansAvailable=function(){var e=this._data().oneDrivePlans;return!!e&&e.length>0};t.prototype._hasPlanWith100GBOrMore=function(){var e=this._data().storagePlans;if(null!==e){for(var t=0,n=e;t<n.length;t++){var r=n[t];if(r.isCurrentPlan&&r.durationInMonths>0)return r.planQuotaBytes>=107374182400}return!1}return null};t.prototype._getPurchaseInfo=function(e,t,n){e.market=this._data().market;var r=t?e.secondaryOfficePlanUrl:e.mainOfficePlanUrl;return{price:t?e.pricePerMonth:e.pricePerYear,purchaseUrl:r,planName:e.type,planType:n?qt.e.Personal:qt.e.Home}};t.prototype._parsePremiumPlans=function(e){var t,n;if(e&&e.officePlans)for(var r=0,i=e.officePlans;r<i.length;r++){var s=i[r];if(qt.e[s.type]!==qt.e.Trial){for(var o=0,u=s.purchaseActions;o<u.length;o++){var a=u[o];if(1===a.durationInMonths){s.pricePerMonth=a.price;s.secondaryOfficePlanUrl=a.purchaseUrl}if(12===a.durationInMonths){s.pricePerYear=a.price;s.mainOfficePlanUrl=a.purchaseUrl}}qt.e[s.type]===qt.e.Home?t=s:n=s}}return[n,t]};t.prototype._computeIsEligibleForPremium=function(){var e=this._data();if(e){if(e.hasCurrentOfficePlan)return!1;if(e.officePlans)for(var t=0,n=e.officePlans;t<n.length;t++){var r=n[t];if(qt.e[r.type]===qt.e.Home||qt.e[r.type]===qt.e.Personal||qt.e[r.type]===qt.e.Solo)for(var i=0,s=r.purchaseActions;i<s.length;i++){var o=s[i];if(1===o.durationInMonths||12===o.durationInMonths)return!0}}return!1}};t.prototype._computeIsEligibleForOneDrivePlan=function(){return!(!this.hasOffice()||!this._areOneDrivePlansAvailable()||this._getHasBiggestOneDrivePlan())};t.prototype._computeIsEligibleFor100GbPlan=function(){var e,t=this._data(),n=null===(e=null==t?void 0:t.storagePlans)||void 0===e?void 0:e.find(function(e){return 107374182400===e.planQuotaBytes&&1===e.durationInMonths});return!(!(null==n?void 0:n.price)||!(null==n?void 0:n.purchaseUrl)||this.hasOffice()||this.hasStoragePlan())};t.prototype._computeHasOffice=function(){var e=this._data();if(e)return e.hasCurrentOfficePlan};t.prototype._computeHasStoragePlan=function(){var e=this._data();if(e)return!!e.hasCurrentStoragePlan||this._hasPlanWith100GBOrMore()};t.prototype._computeIsReady=function(){return!!this._data()};return t})(ne.n),zt=n(473),Wt=n(334),Xt=n(11),Vt=(function(e){Object(i.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t.name="Unsupported";return t}t.prototype.onIsAvailable=function(){return!1};return t})(Xt.e),$t=function(){this.AddCoverPhotoAction=Vt;this.AddExistingAppViewAction=Vt;this.AddFlowAction=Vt;this.AddPhotosToAlbumAction=Vt;this.EditSmartTemplateAction=Vt;this.DeleteSmartTemplateAction=Vt;this.DeleteSmartTemplateWithProgressAction=Vt;this.PublishSmartTemplateAction=Vt;this.PublishSmartTemplateWithProgressAction=Vt;this.UnPublishSmartTemplateAction=Vt;this.UnPublishSmartTemplateWithProgressAction=Vt;this.CopySmartTemplateLinkAction=Vt;this.ActivateUniversalAnnotationAction=Vt;this.AddToAlbumAction=Vt;this.AddToBundleAction=Vt;this.AddToFolderAction=Vt;this.AddToFolderAction=Vt;this.AddToQuickLaunchAction=Vt;this.AddToSharedListAction=Vt;this.AddToSpotlightAction=Vt;this.AlertAction=Vt;this.ApplyOfficeLensAction=Vt;this.ApproveRejectAction=Vt;this.AuthenticationPolicyWarningAction=Vt;this.AutoExecuteAction=Vt;this.CancelEditAction=Vt;this.ChangeAppViewVisibilityAction=Vt;this.ChangeFolderTypeAction=Vt;this.CheckInAction=Vt;this.CheckOutAction=Vt;this.ClearFilterAction=Vt;this.ClearSelectionAction=Vt;this.ComplianceDetailsAction=Vt;this.ContentTypeNavigationAction=Vt;this.LaunchConfigureFlowsPanelAction=Vt;this.CopyFieldAction=Vt;this.CopyFormAction=Vt;this.CreateAlbumAction=Vt;this.CreateAlbumFromFolderAction=Vt;this.CreateAppViewAction=Vt;this.CreateColumnAction=Vt;this.CreateCustomDocumentAction=Vt;this.CreateDocumentAction=Vt;this.CreateFileRequestAction=Vt;this.CreateFolderAction=Vt;this.CreateItemAction=Vt;this.CreateMountPointAction=Vt;this.CreateNewFolderAction=Vt;this.CreateSitePageAction=Vt;this.CustomActionNavigationAction=Vt;this.CustomizeClientFormAction=Vt;this.CustomizeFormsNavigationAction=Vt;this.CustomizeViewAction=Vt;this.DefaultClickAction=Vt;this.DeleteAction=Vt;this.DeleteTemplateAction=Vt;this.DeleteAppAction=Vt;this.DeleteViewAction=Vt;this.DiscardAutoAlbumAction=Vt;this.DownloadAction=Vt;this.SendForSignatureAction=Vt;this.OpenSWAAction=Vt;this.DownloadZipContentsAction=Vt;this.EditAction=Vt;this.EditInClipchampAction=Vt;this.EditItemAction=Vt;this.EditItemCancelAction=Vt;this.EditItemSaveAction=Vt;this.EditNewAppViewAction=Vt;this.EditNewMenuAction=Vt;this.EditNewMenuPaneAction=Vt;this.EditPdfAction=Vt;this.EditRenditionsAction=Vt;this.EditTagsAction=Vt;this.EmbedAction=Vt;this.EmptyRecycleBinAction=Vt;this.ExportListAction=Vt;this.ExternalNavigateAction=Vt;this.FeedbackAction=Vt;this.FileHandlerOpenAction=Vt;this.FileHandlerCreateAction=Vt;this.FilterAction=Vt;this.FilterSearchAction=Vt;this.FilterSearchByDateAction=Vt;this.GetLinkAction=Vt;this.GroupItemsAction=Vt;this.ImplicitSaveAutoAlbumAction=Vt;this.InvokeFirstRunExperienceAction=Vt;this.LanguagePickerAction=Vt;this.LaunchApprovalDetailsDialogAction=Vt;this.LaunchChangeTheLookPanelAction=Vt;this.LaunchColumnCustomizationPaneAction=Vt;this.LaunchColumnManagementPanelAction=Vt;this.LaunchCreateAppViewPanelAction=Vt;this.LaunchCreateGroupPanelAction=Vt;this.LaunchCreateListDialog=Vt;this.LaunchCreateShortcutPanel=Vt;this.LaunchDocLibSettingPanelAction=Vt;this.LaunchFilterPanelAction=Vt;this.LaunchFlowWidgetPanelAction=Vt;this.LaunchFormatViewPaneAction=Vt;this.LaunchGroupifyPanelAction=Vt;this.LaunchGroupMembershipPanelAction=Vt;this.LaunchListCreationPanelAction=Vt;this.LaunchListFormAction=Vt;this.LaunchMoveCopyPanelAction=Vt;this.LaunchPdfExtractionAction=Vt;this.LaunchPdfMergeAction=Vt;this.LaunchSitePermissionsPanelAction=Vt;this.LaunchSiteSettingsPanelAction=Vt;this.LaunchGlobalNavSettingsPanelAction=Vt;this.LaunchWebTemplatesGalleryAction=Vt;this.LaunchUserExpirationPanelAction=Vt;this.LaunchVivaConnectionsSettingsPanelAction=Vt;this.ListFormActivityPaneToggleAction=Vt;this.MakeHomepageAction=Vt;this.VaultAction=Vt;this.ModifyColumnAction=Vt;this.ModifyShowInFiltersPaneAction=Vt;this.MoveCopyAction=Vt;this.MoveLeftSpotlightAction=Vt;this.MoveRightSpotlightAction=Vt;this.NavigateToItemAction=Vt;this.NavigateToSharePointHomeAction=Vt;this.NavigationAction=Vt;this.NewClipchampAction=Vt;this.OneDriveSortAction=Vt;this.OpenAction=Vt;this.OpenChatAction=Vt;this.OpenAppAction=Vt;this.OpenDocSetAction=Vt;this.OpenHyperlinkAction=Vt;this.OpenInExplorerAction=Vt;this.OpenInfoPathAction=Vt;this.OpenInImageEditorAction=Vt;this.OpenInOfficeClientAction=Vt;this.OpenInOfficeOnlineAction=Vt;this.OpenInImmersiveReaderAction=Vt;this.OpenInSharePointAction=Vt;this.OpenInDesktopAction=Vt;this.OpenInTextEditorAction=Vt;this.OpenInClipchampAction=Vt;this.OpenInHtmlViewerAction=Vt;this.OpenNeedsAttentionViewAction=Vt;this.OpenPdfInBrowserAction=Vt;this.OpenInPowerBIAction=Vt;this.OpenShortcutAction=Vt;this.OpenSiteAction=Vt;this.OrderPrintsAction=Vt;this.PinToMruAction=Vt;this.PlayAudioAction=Vt;this.PlaySlideShowAction=Vt;this.PolicyTipAction=Vt;this.PreviewAction=Vt;this.PrintPdfAction=Vt;this.PublishAction=Vt;this.RedeemAction=Vt;this.RedeemCodeAction=Vt;this.RemoveCoverPhotoAction=Vt;this.RemoveFromAlbumAction=Vt;this.RemoveFromBundleAction=Vt;this.RemoveFromRecentAction=Vt;this.RemoveFromSharedListAction=Vt;this.RemoveFromSpotlightAction=Vt;this.RemoveMountPointAction=Vt;this.RemoveOfficeLensAction=Vt;this.RemoveTagAction=Vt;this.RemoveTagFromItemAction=Vt;this.RenameAction=Vt;this.RenameColumnAction=Vt;this.ReportAbuseAction=Vt;this.RequestReviewAction=Vt;this.RestoreAction=Vt;this.RestoreAllAction=Vt;this.RestoreFilesAction=Vt;this.RotateAction=Vt;this.SaveAction=Vt;this.SaveAutoAlbumAction=Vt;this.SaveSortOrderAction=Vt;this.SaveViewAction=Vt;this.SeeAllAppsAction=Vt;this.SelectAction=Vt;this.SelectAllAction=Vt;this.SetAlbumCoverPhotoAction=Vt;this.SetDefaultViewAction=Vt;this.SetFocusAction=Vt;this.SetPhotosRootAction=Vt;this.SetUpApprovalFlowAction=Vt;this.SetUpReminderFlowAction=Vt;this.ShareAction=Vt;this.ShareByLinkAction=Vt;this.ShowExistingFlowsAction=Vt;this.ShowFiltersAction=Vt;this.ShowCopilotAction=Vt;this.ShowItemAnalyticsAction=Vt;this.ShowSuggestedFilesAction=Vt;this.ShowKeyPointsAction=Vt;this.ShowKeyboardMapAction=Vt;this.ShowMalwareDetectedAction=Vt;this.ShowOperationsAction=Vt;this.ShowPermissionsAction=Vt;this.ShowPropertiesAction=Vt;this.ShowRunReportAction=Vt;this.ShowSelectionAction=Vt;this.ShowVersionHistoryAction=Vt;this.SignOutAction=Vt;this.StopSlideShowAction=Vt;this.SurveyAction=Vt;this.SwitchPhotoFolderLayoutTypeAction=Vt;this.SwitchSharingLinkAction=Vt;this.SwitchViewAction=Vt;this.SyncAction=Vt;this.SynchronizeAppViewAction=Vt;this.LaunchTeamChannelAction=Vt;this.ToggleAction=Vt;this.ToggleDebugWindowAction=Vt;this.ToggleIsLeftNavUserExpandedAction=Vt;this.ToggleListLayoutAction=Vt;this.ToggleSelectionModeAction=Vt;this.TriggerFlowAction=Vt;this.TriggerFlowByIdAction=Vt;this.TriggerODBConvertToPdfFlowAction=Vt;this.TriggerODBRequestSignOffFlowAction=Vt;this.TriggerSignoffFlowAction=Vt;this.TriggerExtractFileMetadataFlowAction=Vt;this.UndoCheckOutAction=Vt;this.UnPublishAction=Vt;this.UpdateCaptionAction=Vt;this.UpdatePermissionsAction=Vt;this.UploadAction=Vt;this.UploadTemplateAction=Vt;this.QuotaBlockAction=Vt;this.ViewInFolderAction=Vt;this.ViewItemAction=Vt;this.ViewOriginalAction=Vt;this.WorkflowAction=Vt},Jt=n(407),Kt=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="ExternalNavigate";n._item=t.item;return n}t.prototype.onIsAvailable=function(){return!0};t.prototype.onExecute=function(e){var t=this,n=window.open("","_blank"),r=this._item.peek();return S.n.resolve(this.resources.consumeAsync($.n)).then(function(e){var i=void 0;if(i=t._isOfficeItem()&&r.openUrl?r.openUrl:e.getItemUrl(r.key,{item:r})){n.location.href=i;return{resultType:g.t.Success}}n.close();return{resultType:g.t.Failure}})};t.prototype._isOfficeItem=function(){var e=this._item.peek(),t=e.extension&&e.extension.replace(/^\./,"");return t&&Jt.t[t]&&".pdf"!==e.extension};return t})(Xt.e),Qt=n(19),Gt=n(28);(function(e){e[e.DefaultClick=0]="DefaultClick";e[e.OpenInOfficeOnline=1]="OpenInOfficeOnline";e[e.OpenFileLocation=2]="OpenFileLocation";e[e.OpenItemActivityItem=3]="OpenItemActivityItem";e[e.OpenPdfInBrowser=4]="OpenPdfInBrowser"})(Ht||(Ht={}));var Yt=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=t.item,i=t.openRelation,s=void 0===i?0:i,o=t.actionType;n.name="OpenInDesktop";n._itemSelectionHelper=new(n.child(Qt.e))({overrideItem:2===s?r:void 0,allowMultiSelect:!1,canFallback:0!==s,ignoreSelection:0!==s});n._urlDataSource=n.resources.consume(V.B);n._actionType=o;return n}t.prototype.onIsAvailable=function(){return!0};t.prototype.onExecute=function(e,t){var n=this._itemSelectionHelper.firstItem(),r={id:n.id,name:n.name,actionType:Ht[this._actionType],queryType:Z.e[n.queryType],itemType:Gt.e[n.type],openUrl:n.openUrl,parentUrl:n.parentLink,shortcutUrl:n.urls[Pe.e.shortcutTarget],siteUrl:this._urlDataSource.getCurrentSiteUrl(),fullItemUrl:this._urlDataSource.getItemUrl(n.key),extension:n.extension};window.external.notify(JSON.stringify(r));return S.n.wrap({resultType:g.t.Success})};return t})(Xt.e),Zt=n(74),en=n(25),tn=n(51),nn=n(24),rn=new nn.e("removeFromRecent"),sn=new nn.e("addCoverPhoto"),on=new nn.e("removeCoverPhoto"),un=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="AddCoverPhotoAction";r._itemReedemer=r.resources.consume(Zt.e);r._itemCommandHelper=new(r.managed(en.e));r._itemSelectionHelper=new(r.child(Qt.e))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e,t=this,n=this._itemSelectionHelper.currentItem(),r=null===(e=null==n?void 0:n.vault)||void 0===e?void 0:e.root;return n.queryType!==Z.e.Search&&n.queryType!==Z.e.SharedWithMe&&!r&&(!n.isBundle||!!n.isAlbum)&&this._itemSelectionHelper.filterItems(function(e){return t._itemCommandHelper.isCommandSupported(e,sn)})};t.prototype.onExecute=function(e,t){return Object(i.__awaiter)(this,void 0,S.n,function(){var e,t=this;return Object(i.__generator)(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveSelection()];case 1:return(e=n.sent()).length?[2,this._itemReedemer.redeemItems(e,this).then(function(){var n,r=t.resources.consume(tn.resourceKey),i=e[0].UNSAFE_parent;if(Object(ce.qo)(ce.eo)){var s=e[0],o=(null==s?void 0:s.parentKey)&&Object(O.m)(s.parentKey);n={key:e[0].parentKey,id:o.id}}return r.addCoverPhotos({items:e,target:i||n,itemsScopeInvalidate:!!n}).then(function(){return{resultType:g.t.Success}})})]:[2,S.n.resolve({resultCode:"EmptySelection",resultType:g.t.Failure})]}})})};return t})(Xt.e),an=n(37),fn=n(457),ln=(new nn.e("play"),new nn.e("rotate")),cn=new nn.e("editCaption"),hn=new nn.e("editTags"),pn=new nn.e("removeTags"),dn=new nn.e("viewOriginal"),vn=new nn.e("applyOfficeLens"),mn=new nn.e("removeOfficeLens"),gn=new nn.e("addToAlbum"),yn=new nn.e("removeFromAlbum"),bn=new nn.e("addPhotosToAlbum"),wn=!de.e.isActivated("B8D2D2A7-E86C-4603-A180-25887F432C8C","",""),En=!de.e.isActivated("12240148-D376-40BA-91CD-7D460F2D6DA2","04/18/2022","Disable AddToAlbumAction in vault since it is not working, because of access denied"),Sn=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="AddToAlbum";n._panelProvider=n.resources.consume(fn.e);n._urlDataSource=n.resources.consume(V.B);return n}t.prototype.getExecutorPath=function(){return"./AddToAlbumExecutor"};t.prototype.getModuleFactory=function(){return function(){return S.n.resolve(n.ee([8,"ondemand.resx-ondemand"],1665))}};t.prototype.getExecutorParameters=function(){return{actionName:this.name,itemSelectionHelper:this.selectionHelper,panelProvider:this._panelProvider,urlDataSource:this._urlDataSource}};t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}};t.prototype.onIsAvailable=function(){if(!Object(le.isFeatureEnabled)(le.HideAddToAlbum)&&!0===Object(It.e)(wt.u))return!1;var e=this.selectionHelper.firstItem(),t=null==e?void 0:e.vault;return!(En&&t)&&(!wn||(null==e?void 0:e.ownerId)&&Object(O._)(e.ownerId))&&this.itemCommandHelper.isCommandSupported(e,gn)&&e.queryType!==Z.e.RecycleBin};return t})(an.e),xn=n(117),Tn=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="AddToFolderAction";n._itemParentHelper=n.resources.consume(xn.e);return n}t.prototype.getExecutorPath=function(){return"./AddToFolderExecutor"};t.prototype.getModuleFactory=function(){return function(){return S.n.resolve(n.ee([10,"ondemand.resx-ondemand"],1596))}};t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper}};t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem(),t=e&&this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"vault","root"));return!!t&&!t.vault.isLocked};return t})(an.e),Nn=n(61),Cn=n(229),kn=n(106);Object(kn.e)([{rawString:".FolderTypeEditor-option+.FolderTypeEditor-option{margin-top:10px}"}]);var Ln,An=n(97);(function(e){e[e.documents=0]="documents";e[e.photos=1]="photos";e[e.favorites=2]="favorites"})(Ln||(Ln={}));var On,Mn=Ln,_n=n(18),Dn=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.infoPaneResx=Cn;n.category=t.category;n.typeDocuments=Mn[Mn.documents];n.typePhotos=Mn[Mn.photos];n.categoryText=_n.observable(Mn[n.category()]);n.subscribe(n.categoryText,function(){n.category(Mn[n.categoryText()])});return n}return t})(An.e),Pn=n(98),Hn=Pn.e({tagName:"ms-folder-type-editor",template:'<div class="FolderTypeEditor"><div class="FolderTypeEditor-option"><div class="ms-RadioButton"><input class="ms-RadioButton-input" type="radio" name="folderType" id="folderTypeDocuments" data-bind="attr:{value:typeDocuments},checked:categoryText"><label for="folderTypeDocuments" class="ms-RadioButton-field"><span class="od-Label" data-bind="text:infoPaneResx.informationFolderTypeDocuments"></span></label></div></div><div class="FolderTypeEditor-option"><div class="ms-RadioButton"><input type="radio" name="folderType" id="folderTypePhotos" value="photos" data-bind="attr:{value:typePhotos},checked:categoryText" class="ms-RadioButton-input"><label for="folderTypePhotos" class="ms-RadioButton-field"><span class="od-Label" data-bind="text:infoPaneResx.informationFolderTypePhotos"></span></label></div></div></div>',viewModel:Dn,synchronous:!0}),Bn=n(81),jn=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="ChangeFolderType";r._itemProvider=r.resources.consume(tn.resourceKey);r._urlDataSource=r.resources.consume(V.B);r._identityDataSource=r.resources.consume(V.h);r._itemSelectionHelper=new(r.child(Qt.e))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){if(!Me.e.isActivated("B93166B0-4771-4455-90F3-5E582AF8CF19","10/21/2021","Disable change folder type"))return!1;var e=this._itemSelectionHelper.firstItem(),t=this._identityDataSource.getIdentity();return!(!e||!t||void 0===e.queryType||t.type===ue.e.anonymous||void 0===e.category||this._urlDataSource.isRecycleBin(e.queryType))};t.prototype.onExecute=function(e,t){return Object(i.__awaiter)(this,void 0,S.n,function(){var e,t,n,r,s=this;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:if(!(e=i.sent()))return[2,S.n.resolve({resultCode:"EmptySelection",resultType:g.t.Failure})];t=e.category;n=this.observables.create(t);r=this.resources.consume(Bn.e);return[2,r.requestDialog({title:Cn.informationChangeFolderTitle,component:{name:Hn.tagName,params:{category:n}},actions:[{name:Cn.informationSave,execute:function(){return S.n.resolve(2)},isAvailable:this.createComputed(function(){return e.category!==n()}),isDefault:!0,icon:new Nn.e("Save"),automationId:"changeFolderTypeSave"}]}).wait().then(function(){return s._itemProvider.changeFolderType({category:n(),item:e}).then(function(){return{resultType:g.t.Success}})})]}})})};return t})(Xt.e),Fn=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="ClearSelection";var i=r.resources;r._urlDataSource=i.consume(V.B);r._itemSelectionHelper=new(r.child(Qt.e))({allowMultiSelect:!0,canFallback:!1});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper,t=this._urlDataSource,n=t.getKeyParams(e.currentItem().key),r=t.getQueryType(n);return e.selection().length>0&&!t.isRecycleBin(r)};t.prototype.onExecute=function(e,t){this._itemSelectionHelper.clearSelection();return S.n.resolve({resultType:g.t.Success})};return t})(Xt.e),In=n(176),qn=n(33),Rn=n(500),Un=n(41),zn=n(67),Wn=n(734),Xn=n(53),Vn=new Te.t({name:"".concat("CreateDocumentAction",".createItemOperator"),loader:new X.t(function(){return S.n.resolve(n.ee([85],1597)).then(function(e){return e.typeResourceKey})})}),$n=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._isRunningTABTest=!1;n.docType=t.docType;n.templateUrl=t.templateUrl;n.name="Create"+(qn.e[n.docType]||"")+"DocumentAction";n.navigation=n.resources.consume(W.e);n.itemProvider=n.resources.consume(tn.resourceKey);n._dialogProvider=n.resources.consume(Bn.e);n.platformDetection=n.resources.consume(zn.e);n.redirect=!0;n.openInNewTab=!1;n.askForFileName=n.docType===qn.e.OneNote;n._isOneDriveWinApp=Object(Xn.e)();"true"===window.sessionStorage.getItem("_isRunningTABTest")&&(n._isRunningTABTest=!0);return n}t.prototype.createDocument=function(e,t){var n=this,r=this.navigation,i=this.itemProvider,s=null,o=i.createDocument(e.key,this.docType,t,this.templateUrl).then(function(e){e&&(s=e);return S.n.wrap({resultType:g.t.Success})});o.done(function(e){s&&!window._isRunningTABTest&&n.async.setImmediate(function(){return r.navigateTo({url:s,frameId:n.openInNewTab?"_blank":null})})});return o};t.prototype.onIsAvailable=function(){return!(this.platformDetection.isMobile&&!this.platformDetection.isIPad||this._isOneDriveWinApp)&&this.item().queryType===Z.e.Files};t.prototype.isCommandSupported=function(){return!0};t.prototype.onExecute=function(e,t){return this.isCommandSupported()?this.onExecuteCore():S.n.wrap({resultType:g.t.Success})};t.prototype.onExecuteCore=function(){if(!this._isCreatingFile){var e=this.item.peek();return this.askForFileName?this._createDocumentWithDialog(e):this.createDocument(e)}};t.prototype.onCreateDocumentPromise=function(e,t,n){return null};t.prototype.createNewFile=function(e,t){var n=this;return S.n.resolve(this.resources.consumeAsync(Vn)).then(function(t){var r=new t({fileName:e,parentItem:n.item.peek()});return n.trackPromise(r.start())})};t.prototype._createDocumentWithDialog=function(e){var t=this,n=this._dialogProvider,r=this.observables.create(""),i=this.observables.create(""),s=this.observables.create(!1),o=this.observables.create(!0),u=null,a=Object(Wn.t)(this.docType);this._isCreatingFile=!0;var f,l=function(e){s(!0);o(!0);i(e);return 1},c=n.requestDialog({title:Object(Wn.e)(this.docType,Un),isDismissable:this.docType!==qn.e.Text||Object(le.isFeatureEnabled)(le.EnableOneUpTextFileV2)&&Object(le.isFeatureEnabled)(le.CreateDocumentPromptSameTab),component:{name:Rn.e.tagName,params:{name:r,automationId:"createDocumentDialog",extension:a,status:i,hasError:s,isEnabled:o}},actions:[{name:Un.CreateCommit,execute:function(){i(Un.Saving);o(!1);s(!1);return(function(){var n=t.docType===qn.e.OneNote||t.docType===qn.e.ExcelSurvey||t.docType===qn.e.ExcelForm?r.peek():r.peek()+a,i=t.onCreateDocumentPromise(t.docType,e,n);if(i)return i.then(function(e){u=e;return 2},l);if(t.redirect){return t.itemProvider.createDocument(e.key,t.docType,n,t.templateUrl).then(function(e){u=e;return 2},l)}return t.createNewFile(n,e).then(function(){return 2},l)})()},isAvailable:this.observables.pureCompute(function(){return t._isCreateAvailable(o,r)}),isDefault:!0,icon:new Nn.e("Save"),automationId:"createDocumentDialogCommit"}]}).wait().then(function(){Object(le.isFeatureEnabled)(le.CreateDocumentPromptSameTab)&&t.docType!==qn.e.Text&&(f=window.open("",t._isRunningTABTest?"_self":"_blank"));return{resultType:g.t.Success}},function(){return{resultType:g.t.ExpectedFailure}});c.done(function(){t._isCreatingFile=!1;if(u)if(f)f.location.href=u;else{var e=t.navigation;t.async.setImmediate(function(){return e.navigateTo({url:u,frameId:t.openInNewTab?"_blank":null})})}});return c};t.prototype._isCreateAvailable=function(e,t){if(!e())return!1;var n=t();return!!n&&" "!==n[0]};return t})(In.e),Jn=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._platform=n.resources.consume(zn.e);n.formAction=t.formAction;n.canary=t.canary;n.target=t.target||(n._platform.isMobile?"":"_blank");return n}return t})(An.e),Kn=Pn.e({tagName:"ms-create-doc-form",template:'<form class="CreateDocumentForm" id="create_form" name="create_form" method="post" data-bind="attr:{action:formAction,target:target}"><input name="canary" type="hidden" data-bind="value:canary"></form>',viewModel:Jn,synchronous:!0}),Qn=n(121);(function(e){e[e.Excel=1]="Excel";e[e.OneNote=2]="OneNote";e[e.PowerPoint=3]="PowerPoint";e[e.Word=4]="Word";e[e.Visio=5]="Visio";e[e.Project=6]="Project";e[e.Publisher=7]="Publisher"})(On||(On={}));var Gn=On,Yn=(function(){var e,t,n,r,i,s,o,u,a,f="";var l={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4},c={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32},h={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4},p={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},d={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};function v(){return(function(){(function(){if(s)return;s=!0;o=y("Windows NT")})();return o>=6.1})()&&!(window.navigator.userAgent.indexOf("ARM;")>=0)&&(T()||L()||k())}function m(){return window.navigator.userAgent.indexOf("Windows")>=0}function g(){return window.navigator.userAgent.indexOf("Windows Phone")>=0}function y(e){var t=new RegExp(e+"\\s+(\\d+(\\.\\d*)?)").exec(window.navigator.userAgent),n=-1;if(null!=t&&t.length>=2){n=parseFloat(t[1]);isNaN(n)&&(n=-1)}return n}function b(){(function(){if(!u){u=!0;a=y("Windows Phone")}})();return a>=8}function w(){return"function"==typeof navigator.msLaunchUri&&!g()&&!x()}function E(){return window.navigator.userAgent.indexOf("Macintosh")>=0}function S(){return window.navigator.userAgent.indexOf("iPhone")>=0||window.navigator.userAgent.indexOf("iPad")>=0}function x(){return window.navigator.userAgent.indexOf("Edge/")>=0}function T(){return window.navigator.userAgent.indexOf(" MSIE ")>=0||window.navigator.userAgent.indexOf("Trident/")>=0}function N(){return!!T()&&8==window.document.documentMode}function C(){return window.navigator.userAgent.indexOf(" Firefox/")>=0}function k(){return window.navigator.userAgent.toLowerCase().indexOf("chrome")>=0}function L(){return(function(){if(C())return O("firefox/");return 0})()>=3}function A(){return(function(){if(window.navigator.userAgent.indexOf(" AppleWebKit/")>=0)return O("version/");return 0})()>=3}function O(e){var t=window.navigator.userAgent.toLowerCase(),n=t.indexOf(e);if(n>=0){var r=n+e.length,i=t.length;return parseInt(t.substring(r,i))}return 0}function M(e,t,n){w()?navigator.msLaunchUri(e,t,n):!k()&&!S()||x()?(function(e,t,n){var r=document.getElementById("OICFrame");if(null==r){(r=document.createElement("iframe")).className="ObjectInDialog";r.style.visibility="hidden";r.src="about:blank";document.body.appendChild(r);r.id="OICFrame"}try{r.contentWindow.location.href=e}catch(e){null!=n&&n();return}null!=t&&t()})(e,t,n):(function(e,t,n){var r=document.getElementById("OICLinkTag");if(null==r){(r=document.createElement("a")).id="OICLinkTag";r.style.visibility="hidden";r.href="";r.target="_top";document.body.appendChild(r);null!=r.addEventListener&&r.addEventListener("click",function(e){null!=e.stopPropagation&&e.stopPropagation()},!1)}try{r.href=e;r.click()}catch(e){null!=n&&n();return}null!=t&&t()})(e,t,n)}function _(e){return 0!=(e.Options&c.SkipProtocolHandler)||N()}function D(e){return!_(e)&&(!!(function(e){return E()&&(e.Application==d.OneNote||V("application/x-sharepoint-protocolhandler",!1)||V("application/x-sharepoint-webkit-protocolhandler",!1))})(e)||(!!w()||(!(P()||"ActiveXObject"in window&&!g()||k())||Z()>=15)))}function P(){return E()&&(L()||A())||L()}function H(e){return e===l.ReadOnly||e===l.ReadWrite}function B(e,t,n,r){var s=(function(e){if(e!=d.OneNote&&g()&&!b())return"office:";switch(e){case d.Excel:return"ms-excel:";case d.OneNote:return"onenote:";case d.PowerPoint:return"ms-powerpoint:";case d.Visio:return"ms-visio:";case d.Word:return"ms-word:";case d.Project:return"ms-project:";case d.Publisher:return"ms-publisher:";case d.Infopath:return"ms-infopath:";case d.Access:return"ms-access:";default:return""}})(e);if(null==s){Y(h.Unattempted,i.Application);return!1}e==d.Visio&&n==l.ReadWrite&&(n=l.WriteOnly);var o=s;if(!(r=r||g()&&!b())){var u="";H(n)?u+="ofv|":u+="ofe|";o+=j(u+="u|")}M(o+=j(t),F,I);return!0}function j(e){if(E()&&k()){var t="";try{t=decodeURI(e)}catch(e){}if(t==e)return encodeURI(e)}return e}function F(){G(p.ProtocolHandler)}function I(){i.Options|=c.SkipProtocolHandler;Q(i,e,t)}function q(){if(w())return!0;if(k()){void 0!==navigator.plugins.refresh&&navigator.plugins.refresh();return!!navigator.mimeTypes["application/x-vnd.officeondemand"]}if(C()){var e=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(e);var t=document.createEvent("Events");t.initEvent("RoamingOfficeInstalled",!0,!1);e.dispatchEvent(t);return!!e.getAttribute("installed")}if(T())try{return new ActiveXObject("RoamingOfficeActiveX.RoamingOffice").HrExists()}catch(e){}return!1}function R(e,t,n,r,i,s){U(e,t,(function(e){switch(e){case d.Excel:return"root\\office15\\excel.exe";case d.PowerPoint:return"root\\office15\\powerpnt.exe";case d.Visio:return"root\\office15\\visio.exe";case d.Word:return"root\\office15\\winword.exe";case d.Project:return"root\\office15\\winproj.exe";case d.Publisher:return"root\\office15\\mspub.exe";case d.Infopath:return"root\\office15\\infopath.exe";case d.Access:return"root\\office15\\msaccess.exe";default:return null}})(n),r,"x86",f,i,s)}function U(e,t,i,s,o,u,a,f){var l="";null!=s&&(l+=" "+s);null!=e&&(l+=' "'+e+'"');if(w()||k()){n=a;r=f;var c="office:";c+=' "'+u+'"';c+=' "'+i+'"';c+=' "ROAMING"';c+=' "'+t+'"';c+=' "'+o+'"';M(c+=" "+l,z,W)}else if(C()){var d=document.createElement("RoamingExtensionElement");d.setAttribute("cabUrl",u);d.setAttribute("app",i);d.setAttribute("licensingEntitlements",t);d.setAttribute("platform",o);d.setAttribute("args",l);document.documentElement.appendChild(d);var v=document.createEvent("Events");v.initEvent("RoamingOfficeLaunch",!0,!1);d.dispatchEvent(v);null!=a&&a(p.RoamingFFExtension)}else if(T()){var m=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice");if(null!=m)try{m.HrConfigureSingle(u,i,t,o,l);null!=a&&a(p.RoamingActiveX)}catch(e){}}else null!=f&&f(h.Failed)}function z(){null!=n&&n(p.RoamingProtocolHandler)}function W(){null!=r&&r(h.ControlNeeded)}function X(){var e=document.getElementById("npSharePointPlugin");if(null==e){var t="application/x-sharepoint";E()&&A()&&$("application/x-sharepoint-webkit")&&(t="application/x-sharepoint-webkit");if(!$(t)){if(!E()||!$("application/officelive"))return null;t="application/officelive"}var n=document.createElement("object");n.id="npSharePointPlugin";n.type=t;n.style.width="0px";n.style.height="0px";n.style.setProperty("visibility","hidden","");document.body.appendChild(n);e=document.getElementById("npSharePointPlugin")}return e}function V(e,t){var n=window.navigator.mimeTypes;if(null==n)return!1;var r=n[e];return!!r&&!(t&&!r.enabledPlugin)}function $(e){return V(e,!0)}function J(e){try{if(null!=new ActiveXObject(e))return!0}catch(e){}return!1}function K(e){switch(e){case d.OneNote:return"OneNote.Notebook";default:return""}}function Q(n,r,s){i=n;e=r;t=s;if(n.DocumentUrl){var o=n.DocumentUrl;try{o=decodeURIComponent(n.DocumentUrl)}catch(e){}n.Mode===l.ReadWrite&&c.CheckoutRequired===(n.Options&c.CheckoutRequired)&&(n.Mode=l.ForceCheckout);c.HostIsEditOnly===(n.Options&c.HostIsEditOnly)&&(n.Mode=l.WriteOnly);if(D(n))B(n.Application,n.DocumentUrl,n.Mode,n.Application==d.OneNote);else if(N()&&(function(e,t,n,r){try{var i=new ActiveXObject("SharePoint.OpenDocuments.5");if(i)return i.ViewDocument3(window.self,e,t,r)}catch(e){}return!1})(o,n.Mode,n.Options,K(n.Application)))G(p.O15ActiveX);else{var u;if(P())u=(function(e,t,n){var r=X();if(null==r)return h.Unattempted;var i=!1;try{i=r.ViewDocument3(window.self,e,t,n)}catch(e){}if(!i)try{i=H(t)?r.ViewDocument2(window.self,e,n):r.EditDocument2(window.self,e,n)}catch(e){}if(i){G(p.NpapiPlugin);return h.None}return h.Failed})(o,n.Mode,K(n.Application));else{(function(){try{var e=new ActiveXObject("IDBHO.IDBHOCtrl");null!=e&&e.SaveSSOCreds()}catch(e){}})();u=(function(e,t,n,r){var i;try{if(i=new ActiveXObject("SharePoint.OpenDocuments.4")){if(i.ViewDocument3(window.self,e,t,r)){G(p.O14ActiveX);return h.None}return h.Failed}}catch(e){}if(c.O14Only===(n&c.O14Only))return h.Unattempted;try{if(i=new ActiveXObject("SharePoint.OpenDocuments.3")){if(i.ViewDocument3(window.self,e,t,r)){G(p.O12ActiveX);return h.None}return h.Failed}}catch(e){}if(c.O12UpOnly===(n&c.O12UpOnly))return h.Unattempted;try{if(i=new ActiveXObject("SharePoint.OpenDocuments.2")){if(H(t)?i.ViewDocument2(window.self,e,r):i.EditDocument2(window.self,e,r)){G(p.O11ActiveX);return h.None}return h.Failed}}catch(e){}return h.Unattempted})(o,n.Mode,n.Options,K(n.Application))}if(u!=h.None){if(n.CouldUseRoamingApps&&v()&&n.Application!=d.OneNote){if(!q()){Y(h.ControlNeeded,i.Application);return}if(n.RoamingAppsLauncher){(function(n){void 0!==n.RoamingAppsLauncher&&null!=n.RoamingAppsLauncher?void 0===n.RoamingBitsUrl||null==n.RoamingBitsUrl?R(n.DocumentUrl,n.RoamingAppsLauncher,n.Application,n.ApplicationParameters,e,t):U(n.DocumentUrl,n.RoamingAppsLauncher,n.RoamingApplicationExe,n.ApplicationParameters,n.RoamingPlatform,n.RoamingBitsUrl,e,t):Y(h.Unattempted,i.Application)})(n);return}if(!n.ContinueIfLauncherIsNull){Y(h.LauncherNeeded,i.Application);return}}if(!(c.NoProtocolHandlerFallback==(n.Options&c.NoProtocolHandlerFallback)||_(n)||T()||E()&&u!=h.Unattempted)){B(n.Application,n.DocumentUrl,n.Mode,n.Application==d.OneNote);return}Y(u,i.Application)}}}else Y(h.Unattempted,i.Application)}function G(t){null!=e&&e(t)}function Y(e,n){void 0===n&&(n=null);null!=t&&t(e,n)}function Z(){var e=0;if(P()||k()){var t=X();try{null!=t&&(e=t.GetOfficeVersion())}catch(e){}}else J("SharePoint.OpenDocuments.5")?e=15:J("SharePoint.OpenDocuments.4")?e=14:J("SharePoint.OpenDocuments.3")?e=12:J("SharePoint.OpenDocuments.2")&&(e=11);return e}function ee(){return E()&&($("application/x-sharepoint")||$("application/x-sharepoint-webkit"))}return{OpenDocumentMode:l,OpenDocumentOptions:c,OpenDocumentFailureType:h,OpenDocumentControl:p,OfficeApplication:d,EditDocumentInClient:Q,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Mode=0;this.Options=0;this.Application=d.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.ApplicationParameters="";this.RoamingPlatform="";this.RoamingApplicationExe="";this.RoamingBitsUrl=""},OfficeVersionInstalled:Z,IsO14MacPluginInstalled:ee,OfferOfficeInDialog:function(){return m()&&Z()<=11},OfferOfficeNoIntrusive:function(){return m()&&Z()<15},OfferMacOffice:function(){return E()&&!(window.navigator.userAgent.indexOf("PPC Mac")>=0)&&!ee()},CanUseRoamingControl:q,InitUrls:function(e,t,n){f=e},LaunchRoamingApps:R,LaunchRoamingApps2:U,ShouldShowDialog:function(){return!g()},IsInternetExplorer:T}})(),Zn=(function(){function e(){}e.executeOpenInClient=function(t,n){e._item=t.item;e._provider=n.consume(tn.resourceKey);if(t.isDavUrl){e._openInClient(t);return S.n.wrap({resultType:g.t.Success})}return e._getOpenInClientDetails(t)};e._getOpenInClientDetails=function(t){return e._provider.getOpenInClientDetails(e._item).then(function(n){if(n){var r=n.davUrl;t.url=r;t.isDavUrl=!0;e._openInClient(t)}return S.n.wrap({resultType:g.t.Success})})};e._openInClient=function(e){if(!e.useDirectInvoke){var t=Yn.OpenDocumentMode.WriteOnly;e.item.sharingRole===L.e.View&&(t=Yn.OpenDocumentMode.ReadOnly);e.appType===Gn[7].toString()&&(t=Yn.OpenDocumentMode.WriteOnly);var n=Yn.OpenDocumentOptions.None;e.Mode=t;e.Options=n;var r={DocumentUrl:e.url,Mode:t,Options:n,Application:Yn.OfficeApplication[e.appType],ContinueIfLauncherIsNull:!0};Yn.EditDocumentInClient(r,null,null)}};return e})(),er=n(90),tr=!Me.e.isActivated("6FFA2C0E-77D3-4E3F-9C8D-DD5834567BC5","05/20/2022","Invalidate itemCache as part of SkyApiHelper.refreshItemWhenVisible");function nr(e,t,n){var r=rr(),i=r?r+"Hidden":"hidden",s=r+"visibilitychange",o=new er.t({}),u=window.document;if(i){var a=function(){if(!u[i]){o.off(u,s,a);t.consume(tn.resourceKey).invalidateItem(e.key,{triggerFetch:n});if(tr){!!t.consume(Qn.r.lazy)&&t.consumeAsync(V.v).then(function(t){t.invalidateItems(e.key)})}}};o.on(u,s,a)}}function rr(){var e=window.document;return"hidden"in e?"":"msHidden"in e?"ms":"webkitHidden"in e?"webkit":"mozHidden"in e?"moz":void 0}var ir,sr=n(345),or=n(87),ur=new nn.e("upload"),ar=new nn.e("download"),fr=(new nn.e("sync"),n(160)),lr=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._vroomDataRequestor=n.vroomDataRequestor;return r}t.prototype.create=function(e,t,n,r){var i=this;return r?t===qn.e.OneNote?this.getCreateUrl(e,t,!0).then(function(t){var r={name:n,folder:{},package:{type:"oneNote"},"@microsoft.graph.conflictBehavior":"fail"};return i._vroomDataRequestor.send({apiName:"createFolder",path:t,requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify(r),headers:{Prefer:"allow-zerobyte"}}).then(function(t){i._invalidateItem(e);return t.id},function(e){return S.n.reject(e.message)})}):this.getCreateUrl(e,t,!0).then(function(t){return i._vroomCreateDoc(t).then(function(t){i._invalidateItem(e);return t.id})}):this.getCreateUrl(e,t).then(function(e){return i._vroomCreateDoc(e).then(function(e){return e.webUrl})})};t.prototype.getCreateUrl=function(e,t,n){var r=this;return n&&t===qn.e.OneNote?this.getGraphItemUrl(e,!1).then(function(e){return e+"/children"}):this.getGraphItemUrl(e,!0).then(function(e){return e+"/"+r.getDefaultExtension(t)+":/content?@name.conflictBehavior=defaultName"})};t.prototype.getGraphItemUrl=function(e,t){return S.n.resolve(this.resources.consumeAsync(V.c)).then(function(n){return n.getItemUrl(e,{isPath:t,useDirectEndpoint:!0})})};t.prototype.getDefaultExtension=function(e){var t="";switch(e){case qn.e.Word:t=".docx";break;case qn.e.Excel:t=".xlsx";break;case qn.e.PowerPoint:t=".pptx";break;default:throw new TypeError("Invalid DocumentType")}return t};t.prototype._vroomCreateDoc=function(e){return this._vroomDataRequestor.send({apiName:"CreateDocument",path:e,requestType:"PUT",useAuthorizationHeaders:!0,headers:{Prefer:"allow-zerobyte"}})};t.prototype._invalidateItem=function(e){this.resources.consumeAsync(V.v).then(function(t){e.key&&t.invalidateItems(e.key)})};t.dependencies=Object(i.__assign)(Object(i.__assign)({},ne.n.dependencies),{vroomDataRequestor:re.e});return t})(ne.n),cr=Object(X.s)("CreateDocumentDataSource",lr,Object(i.__assign)(Object(i.__assign)({},ne.n.dependencies),{vroomDataRequestor:re.e})),hr=n(375),pr=n(192),dr=n(43),vr=n(107),mr=n(311),gr=n(427),yr=!Me.e.isActivated("0174E87A-4271-4BB2-9664-193F480AE6DB","01/24/2023","Enables various actions to redirect to sign in if attempted by an unauth user"),br=!Me.e.isActivated("1097DC43-A3D7-4151-A119-48637C6D4534","04/05/2022","Fixes itemsscope + ko shim logic related to items with view-only permissions"),wr="https://".concat("onedrive.live.com","/edit.aspx"),Er=!Me.e.isActivated("5E0AD4DB-9DBA-4030-A292-B3BA6793039C","11/16/2021","Send a skyAPi requset to get docFormat"),Sr=0,xr=!1,Tr=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._enableCreateDocumentForCOB=!1;n.c_pathLimitError="folderPathLimitExceeded";n.c_accessDeniedError="accessDenied";n.c_pathLengthErrorLearnMoreLink="https://support.office.com/article/0b10108f-8459-4a7a-b912-28f8adec5a81";n._identityDataSource=n.resources.consume(J.e);n._itemDataSource=n.resources.consume($.e);n._getHiddenDomProvider=n.resources.consume(sr.e.async.lazy);n._createDocumentDataSource=n.resources.consume(cr);n._forceRedeem=!n.resources.consume(G.m).isAuthenticated();n._operationProvider=n.resources.consume(fr.e);n._itemCommandHelper=new(n.managed(en.e));n._itemReedemer=n.resources.consume(Zt.e);n.askForFileName=!!t.autoInvokedItem;t.docType===qn.e.Text&&(Object(le.isFeatureEnabled)(le.EnableOneUpTextFileV2)||t.autoInvokedItem)&&(n.redirect=!1);n._itemCommandKey=n._getItemCommandKey(n.docType);n.docType===qn.e.ExcelSurvey&&Object(le.isFeatureEnabled)(le.RedirectExcelSurveysToFormsV2)&&(n.name="CreateFormsSurveyDocumentAction");Object(le.isFeatureEnabled)(le.CreateDocumentToVroom)&&(n._vroomDocTypes=[qn.e.Word,qn.e.Excel,qn.e.PowerPoint]);return n}t.prototype.onCreateDocumentPromise=function(e,t,n){if(this._enableCreateDocumentForCOB&&(!Object(le.isFeatureEnabled)(le.EnableOneUpTextFileV2)||Object(gr.t)(e,!0))){if(Me.e.isActivated("9744B736-537F-4A3E-9C11-B60273E2D1BA","07/01/2022","create onenote via vroom api")){var r=this._createDocumentForCOB(e,t,n);return S.n.resolve(null==r?void 0:r.toString())}return this._createDocumentDataSource.create(t,e,n,!0).then(function(e){var t=new f.t(wr);t.setQueryParameter("resid",e,!0);t.setQueryParameter("nd","1",!0);return S.n.resolve(t.toString())},function(e){return S.n.reject(e)})}return null};t.prototype.onIsAvailable=function(){var t=this.item();if(t&&t.vault&&t.vault.isLocked||!this._itemCommandKey)return!1;var n=this._itemCommandHelper.getCommandBehavior(t,this._itemCommandKey);return(br&&n?1===n:this._itemCommandHelper.isCommandSupported(t,this._itemCommandKey))&&e.prototype.onIsAvailable.call(this)};t.prototype.onExecute=function(e,t){var n,r,i=this,s=this.item.peek();if(yr&&!Ze.e.isAuthenticated()){var o=this.navigation;o.navigateTo(K.e.getAutoRedeemLoginUrl(s.id,s.ownerId,this.name,o));return S.n.resolve({resultType:g.t.Success})}this._checkCreateDocumentForCOB(s);var u=Object(le.isFeatureEnabled)(le.CreateDocumentToVroom)&&-1!==this._vroomDocTypes.indexOf(this.docType);if(Object(le.isFeatureEnabled)(le.UseItemsScopeInOneDrive)&&Er&&u&&!xr&&!this._enableCreateDocumentForCOB){if(this._isRunningTABTest){n="_self";r=window.open("",n)}else{n="newDocumentTab_".concat(Sr);r=window.open("",n);Sr++}return this._itemDataSource.getItem({parentKey:s.key,startIndex:0,pageSize:0,skipInMemoryCache:!0}).then(function(s){var o;ir=null===(o=null==s?void 0:s.item)||void 0===o?void 0:o.documentFormat;xr=!0;return i._executeAction(e,t,n,ir,r)}).catch(function(){return i._executeAction(e,t,n,ir,r)})}return this._executeAction(e,t,void 0,ir)};t.prototype._executeAction=function(t,n,r,i,s){var o=this,u=this.item.peek(),a=1!==(i||(null==u?void 0:u.documentFormat))&&Object(le.isFeatureEnabled)(le.CreateDocumentToVroom)&&-1!==this._vroomDocTypes.indexOf(this.docType);!a||r||this._enableCreateDocumentForCOB||(s=window.open("",this._getTargetId()));return this._itemReedemer.redeemItem(u,this,this._forceRedeem).then(function(){var i=o._itemDataSource;if(o.askForFileName)return e.prototype.onExecute.call(o,t,n);if(o.docType===qn.e.OneNote||o.docType===qn.e.Text&&Object(le.isFeatureEnabled)(le.EnableOneUpTextFileV2)||2===o._itemCommandHelper.getCommandBehavior(u,o._itemCommandKey)){if(Object(le.isFeatureEnabled)(le.CreateDocumentPromptSameTab)){o.askForFileName=!0;return e.prototype.onExecute.call(o,t,n)}var l=o.navigation,c=i.createDocumentInTab(o.docType,u,!0);l.navigateTo({url:c,frameId:o._getTargetId()});nr(u,o.resources);return{resultType:g.t.Success}}if(o.docType===qn.e.ExcelSurvey&&Object(le.isFeatureEnabled)(le.RedirectExcelSurveysToFormsV2)){l=o.navigation;var h=o._identityDataSource.getIdentity(),p="Action=Create&Host=ODC&Title="+encodeURIComponent(Un.FormDefaultName),d="https://forms.office.com/Pages/DesignPage.aspx?Action=Create&auth_pvr=WindowsLiveId"+(h.email?"&auth_upn="+encodeURIComponent(h.email):"")+"&Fragment="+encodeURIComponent(p);l.navigateTo({url:d,frameId:o._getTargetId()});return{resultType:g.t.Success}}if(o._enableCreateDocumentForCOB){if(!Me.e.isActivated("45955574-DA27-457D-BF90-A452A8068680","09/05/2022","COB account use Vroom to create new file")&&Object(le.isFeatureEnabled)(le.CreateConvergenceViaVroom)){s=null!=s?s:window.open("",o._getTargetId());return o._createDocumentDataSource.create(u,o.docType,null,!0).then(function(e){var t=new f.t(wr);t.setQueryParameter("resid",e,!0);t.setQueryParameter("nd","1",!0);s.location.href=t.toString();o._writePerfForWac();return{resultType:g.t.Success}}).catch(function(e){s.close();var t=o._createDocumentDataSource.getDefaultExtension(o.docType);o._showError(e,u,t);return{resultType:g.t.Failure}})}var v=o._createDocumentForCOB(o.docType,u);o.navigation.navigateTo({url:null==v?void 0:v.toString(),frameId:o._getTargetId()});o._writePerfForWac();return{resultType:g.t.Success}}return a?o._createDocumentDataSource.create(u,o.docType).then(function(e){if(s)s.location.href=e;else{o.navigation.navigateTo({url:e})}o._writePerfForWac();nr(u,o.resources);return{resultType:g.t.Success}}).catch(function(e){s&&s.close();var t=o._createDocumentDataSource.getDefaultExtension(o.docType);o._showError(e,u,t);return{resultType:g.t.Failure}}):o._getHiddenDomProvider().then(function(e){var t=i.createDocumentInTab(o.docType,u,!1),n=e.requestControl({name:Kn.tagName,params:{canary:FilesConfig.navCanary,formAction:t,resources:o.resources,target:r}});o._writePerfForWac();document.getElementById("create_form").submit();e.disposeControl(n);nr(u,o.resources);return S.n.wrap({resultType:g.t.Success})})})};t.prototype._showError=function(e,t,n){var r,i=this,s=this.observables;(r=this._operationProvider.register({iconName:mr.n({type:Gt.e.File,extension:n}),name:"",type:vr.e.createItem,payloads:{uploadItems:{name:"New file",parent:t}},actions:{close:{isAvailable:s.create(!0),execute:function(){r.actions().learnMore.isAvailable(!1);r.state(dr.e.canceled);return S.n.wrap(null)}},learnMore:{isAvailable:s.create(!0),execute:function(){window.open(i.c_pathLengthErrorLearnMoreLink,i._getTargetId());return S.n.wrap()}}}})).progress.maximum(1);r.progress.current(0);var o=r.actions().learnMore;switch(e.code){case this.c_pathLimitError:o.isAvailable(!0);r.error(new pr.e({message:hr.n}));break;case this.c_accessDeniedError:o.isAvailable(!1);r.error(new pr.e({message:hr.e}));break;default:o.isAvailable(!1);r.error(new pr.e({message:hr.t}))}r.state(dr.e.failed)};t.prototype._writePerfForWac=function(){try{localStorage.ODCWac_ST=(new Date).getTime().toString()}catch(e){}};t.prototype._getTargetId=function(){return this._isRunningTABTest?"_self":"_blank"};t.prototype._getItemCommandKey=function(e){var t;switch(e){case qn.e.Word:t=or.i;break;case qn.e.Excel:t=or.e;break;case qn.e.PowerPoint:t=or.n;break;case qn.e.ExcelSurvey:t=or.r;break;case qn.e.OneNote:t=or.t;break;case qn.e.Text:t=ur}return t};t.prototype._checkCreateDocumentForCOB=function(e){this._enableCreateDocumentForCOB=!Me.e.isActivated("25D2DD67-8AD1-4CF3-9AB1-0662C8CB3588","3/24/2022","create new codument for COB")&&Object(le.isFeatureEnabled)(le.CreateConvergenceEnabled)&&Object(It.e)(e.ownerId)};t.prototype._createDocumentForCOB=function(e,t,n){var r,i;try{if(e===qn.e.Visio)return null;var s="".concat(wt.o,"/personal/").concat(null===(r=t.ownerId)||void 0===r?void 0:r.toUpperCase(),"/Documents"),o="".concat(s,"/_layouts/15/doc.aspx"),u=void 0;t.itemFromServer.sharepointIds&&(u=t.itemFromServer.sharepointIds.listItemUniqueId);var a=this._getDocAspxUrlForCOB(o,s+"/Documents",e,u),l=new f.t(new f.t(window.location.href).getStringWithoutQueryAndFragment()+"edit.aspx?"+a.getQuery(!0));n&&l.setQueryParameter("fn",n,!0);e===qn.e.OneNote&&l.setQueryParameter("progId","OneNote.Notebook",!0);l.setQueryParameter("cid",null===(i=t.ownerId)||void 0===i?void 0:i.toUpperCase(),!0);return l}catch(e){console.log(e);return null}};t.prototype._getDocAspxUrlForCOB=function(e,t,n,r){var i=Object(gr.e)(e,t,n,r,!0),s=new f.t(i);s.setQueryParameter("CT",(new Date).getTime().toString(),!0);s.setQueryParameter("OR","DocLib",!0);return s};return t})($n),Nr=n(79),Cr=(function(e){Object(i.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t.name="CreateFolder";return t}t.prototype.getExecutorPath=function(){return"./CreateFolderExecutor"};t.prototype.getModuleFactory=function(){return function(){return S.n.resolve(n.ee([155,"ondemand.resx-ondemand"],1598))}};t.prototype.getSelectionOptions=function(){return{canFallback:!0}};t.prototype.getExecutorParameters=function(){var e=this;return this.selectionHelper.resolveFirst().then(function(t){return{actionName:e.name,item:t}})};t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return!(e&&e.vault&&e.vault.isLocked)&&e&&e.queryType===Z.e.Files&&this.itemCommandHelper.isCommandSupported(e,Nr.t)};return t})(an.e),kr=(function(e){Object(i.__extends)(t,e);function t(n){var r=e.call(this,n)||this;r.text=n.text;r.isLearnMoreVisible=n.isLearnMoreVisible;r.learnMoreText=Un.CreateMountPointLearnMore;r.learnMoreUrl=t.LEARNMORE_URL;return r}t.LEARNMORE_URL="https://go.microsoft.com/fwlink/p/?LinkID=389986";return t})(An.e),Lr=Pn.e({tagName:"ms-create-mp",template:'<div class="CreateMountPoint"><span data-bind="text:text"></span>\x3c!--ko if:isLearnMoreVisible--\x3e&nbsp;<a data-bind="attr:{href:learnMoreUrl},text:learnMoreText"></a>\x3c!--/ko--\x3e</div>',viewModel:kr,synchronous:!0}),Ar=n(71),Or=n(84),Mr=n(145),_r=n(13),Dr=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.isSingleSelectAction=!0;r.canFallbackToParent=!0;r.name="CreateMountPoint";r._actionMap=r.resources.consume(_r.e);r._itemReedemer=r.resources.consume(Zt.e);r._itemCommandHelper=new(r.managed(en.e));r._itemSelectionHelper=new(r.child(Qt.e))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&this._itemCommandHelper.isCommandSupported(e,Or.e)};t.prototype.onExecute=function(e,t){return Object(i.__awaiter)(this,void 0,S.n,function(){var e,t,n,r,s,o,u,a,f,l=this;return Object(i.__generator)(this,function(c){switch(c.label){case 0:e=this.resources.consume(Bn.e);return[4,this._itemSelectionHelper.resolveFirst()];case 1:return(t=c.sent())?[4,this._itemReedemer.redeemItem(t,this)]:[2,{resultType:g.t.ExpectedFailure}];case 2:c.sent();n=new(this.scope.attached(Mr.e));r=this.observables.create(!0);s=this.observables.create(!0);o=this.observables.create(Un.CreateMountPointDetails);u=Ar.o(Un.CreateMountPointTitle,t.name);a=function(){return Object(i.__awaiter)(l,void 0,S.n,function(){var e,n,u;return Object(i.__generator)(this,function(i){switch(i.label){case 0:e=this.resources.consume(tn.resourceKey);r(!1);s(!1);o(Un.CreateMountPointWait);i.label=1;case 1:i.trys.push([1,3,,4]);return[4,e.createMountPoint({item:t})];case 2:n=i.sent();new(this.managed(this._actionMap.OpenAction))({openRelation:2,item:this.createObservable(n)}).execute(null);return[2,2];case 3:if((u=i.sent()).data&&u.data.message){o(u.data.message);return[2,1]}return[2,1];case 4:return[2]}})})};f=e.requestDialog({title:u,component:{name:Lr.tagName,params:{text:o,isLearnMoreVisible:r}},actions:[{name:Un.CreateMountPointConfirm,execute:function(){return a()},isAvailable:r,isVisible:r,icon:new Nn.e("FabricFolderLink"),isDefault:!0},{name:Un.Close,execute:function(){return S.n.resolve(2)},isAvailable:this.observables.create(!0),isVisible:n.attach(this.observables.pureCompute(function(){return!r()})),icon:new Nn.e("Cancel"),isDefault:!0}]});c.label=3;case 3:c.trys.push([3,,5,6]);return[4,f.wait()];case 4:c.sent();this._itemSelectionHelper.clearSelection();return[3,6];case 5:n.dispose();return[7];case 6:return[2,{resultType:g.t.Success}]}})})};return t})(Xt.e),Pr=n(155),Hr=n(100),Br=n(493),jr=n(208),Fr=new jr.e("Open",jr.t.intent),Ir=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="DefaultClick";r.isQosLogged=!1;var i=t.item,s=t.userInvokedItem,o=void 0!==s&&s,u=t.hideIfDefaultIsDownload,a=void 0!==u&&u,f=t.sourceEngagement,l=void 0===f?"":f,c=r,h=c.resources,p=c.observables;h.expose(jr.n,h.consume(jr.n).withPart(Fr));r._itemSelectionHelper=new(r.child(Qt.e))({overrideItem:i,allowMultiSelect:!1,canFallback:!1});r.item=r._itemSelectionHelper.firstItem;r.sourceEngagement=l;r.userInvokedItem=o;r.hideIfDefaultIsDownload=a;r.actionMap=h.consume(_r.e);r.urlDataSource=h.consume(V.B);r.viewParams=h.consume(_r.S);r._isFilePickerPage=p.pureCompute(r._computeIsFilePickerPage);r._action=p.pureCompute(r._computeAction);r._action.equalityComparer=Pr.t;r._instrumentationProvider=h.consume(G.i);return r}t.prototype.onIsAvailable=function(){var e=this.observables.peekUnwrap(this._action);return!!e&&e.isAvailable()};t.prototype.onExecute=function(e){var t=this.observables,n=t.peekUnwrap(this.item);this._logEngagement(n,e);var r=this._instrumentationProvider;r&&n&&r.userClickItem(n);var i=t.peekUnwrap(this._action);return i&&i.execute(e)||S.n.resolve({resultType:g.t.ExpectedFailure})};t.prototype.onComputeAction=function(){return new(this.managed(this.actionMap.OpenAction))({openRelation:2,item:this.item})};t.prototype._computeIsFilePickerPage=function(){return this.urlDataSource.getPageType(this.viewParams())===ae.e.FilePicker};t.prototype._computeAction=function(){var e,t=this._lastAction;if(t){t.dispose();this._lastAction=void 0}var n=this.item();this._isFilePickerPage()&&n&&n.type!==Gt.e.Folder||(e=this.onComputeAction());this._lastAction=e;return e};t.prototype._logEngagement=function(e,t){var n=this.sourceEngagement;if(n){var r;if(e)switch(e.type){case Gt.e.File:r="FileOpen.".concat(n);break;case Gt.e.Folder:r="FolderOpen.".concat(n);break;case Gt.e.App:r="AppOpen.".concat(n);break;case Gt.e.Subsite:r="SubsiteOpen.".concat(n);break;default:r="Open.".concat(n)}else r="Open.".concat(n);this.resources.consume(Ue.e).withPart(Br.e).withPart(Hr.e,{item:e}).logData({name:r,extraData:{action:t?t.type:"unknown"}})}};return t})(Xt.e),qr=n(428),Rr=n(146),Ur=(function(e){Object(i.__extends)(t,e);function t(){var t=e.call(this,{})||this;t.name="ShowNotShared";t._dialogProvider=t.resources.consume(Bn.e);return t}t.prototype.onExecute=function(e){return this._dialogProvider.requestDialog({title:qr.t,component:{name:Rr.e.tagName,params:{text:qr.e}},actions:[]}).wait().then(function(){return S.n.wrap({resultType:g.t.Success})})};return t})(Xt.e),zr=n(29),Wr=new nn.e("defaultClick"),Xr=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._odcUrlDataSource=n.resources.consume($.n);n._itemCommandHelper=new(n.managed(en.e));n._defaultClickBehavior=n.createPureComputed(n._computeDefaultClickBehavior);n._isOneDriveWinApp=Object(Xn.e)();n._isOneDriveXboxApp=Object(Xn.t)();n._isPWA=n.resources.consume(zn.e).isPWA;return n}t.prototype.onIsAvailable=function(){var t=this.item(),n=this.hideIfDefaultIsDownload&&4===this._itemCommandHelper.getCommandBehavior(t,Wr);return e.prototype.onIsAvailable.call(this)&&!n};t.prototype.onComputeAction=function(){var t,n=this;switch(this._defaultClickBehavior()){case 1:t=e.prototype.onComputeAction.call(this);break;case 2:case 3:t=this._isOneDriveWinApp||this._isPWA?new(this.managed(this.actionMap.OpenAction))({openRelation:2,item:this.item,urlType:"focus"}):new(this.managed(this.actionMap.OpenInOfficeOnlineAction))({item:this.item,openLocal:!this.userInvokedItem,useDefaultAction:!0});break;case 4:case 7:t=this._isOneDriveXboxApp?new(this.managed(this.actionMap.OpenAction))({openRelation:2,item:this.item,urlType:"focus"}):new(this.managed(this.actionMap.DownloadAction))({item:this.item,userInvokedItem:this.userInvokedItem});break;case 6:case 10:t=new(this.managed(this.actionMap.OpenInOfficeClientAction))({item:this.item,userInvokedItem:this.userInvokedItem});break;case 11:t=new(this.managed(this.actionMap.NavigationAction))({url:this.createPureComputed(function(){var e=n._odcUrlDataSource.qualifyUrl(n._odcUrlDataSource.getDefaultClickUrl(n.item(),{action:zr.t.defaultClick,viewParams:n.viewParams()}));return n._odcUrlDataSource.getAuthenticateUrl(e)}),userInvokedItem:this.userInvokedItem});break;case 15:t=new(this.managed(this.actionMap.PlayAudioAction))({item:this.item});break;case 50:t=new(this.managed(Ur))}return t};t.prototype._computeDefaultClickBehavior=function(){return this._itemCommandHelper.getCommandBehavior(this.item(),Wr)};return t})(Ir),Vr=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="Delete";n.logStartEnd=!0;n._currentItem=Object(ce.qo)(ce.J)?n.selectionHelper.currentItem:n.resources.consume(_r.i);return n}t.prototype.getExecutorPath=function(){return"./DeleteExecutor"};t.prototype.getModuleFactory=function(){return function(){return S.n.resolve(n.ee([156,"ondemand.resx-ondemand"],1393))}};t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}};t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,currentItem:this._currentItem.peek()}};t.prototype.onIsAvailable=function(){var e=this;return this._currentItem()&&this.selectionHelper.filterItems(function(t){var n=!!t.UNSAFE_parent&&t.UNSAFE_parent.isBundle,r=!!t.UNSAFE_parent&&t.UNSAFE_parent.isAlbum;return e.itemCommandHelper.isCommandSupported(t,Nr.r)&&t.queryType!==Z.e.SharedWithMe&&t.queryType!==Z.e.DocsInCommon&&!n&&!r})};return t})(an.e),$r=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._itemCommandHelper=new(n.managed(en.e));n.name="Download";n._currentItem=Me.e.isActivated("CA6B3004-C196-4F99-90F6-72ACA9F6971B","10/21/2021","Get Current Item from ItemSelectionHelper")?n.resources.consume(_r.i):n.selectionHelper.currentItem;n._itemCommandHelper=new(n.managed(en.e));n._isOneDriveWinApp=Object(Xn.e)();n._isOneDriveXboxApp=Object(Xn.t)();return n}t.prototype.getExecutorPath=function(){return"./DownloadExecutor"};t.prototype.getModuleFactory=function(){return function(){return S.n.resolve(n.ee([160,"ondemand.resx-ondemand"],1645))}};t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!this._isOneDriveWinApp,canFallback:!0}};t.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper,currentItem:this._currentItem.peek(),actionName:this.name}};t.prototype.onIsAvailable=function(){var e=this,t=this.selectionHelper.selection(),n=this.selectionHelper.firstItem();if((t.length>1||n&&n.folder)&&l.get("BadgerAuth"))return!1;var r=this._currentItem();return!(t.length>1&&r.queryType===Z.e.SharedWithMe&&r.isRootFolder)&&(!this._isOneDriveXboxApp&&this.selectionHelper.filterItems(function(t){return e._itemCommandHelper.isCommandSupported(t,ar)}))};return t})(an.e),Jr=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="EditTagsAction";n._itemCommandHelper=new(n.managed(en.e));n._currentItem=Me.e.isActivated("5E6E4463-F472-41DE-9873-C1A437FCA008","10/21/2021","Get Current Item from ItemSelectionHelper")?n.resources.consume(_r.i):n.selectionHelper.currentItem;return n}t.prototype.getExecutorPath=function(){return"./EditTagsExecutor"};t.prototype.getModuleFactory=function(){return function(){return S.n.resolve(n.ee([17,"ondemand.resx-ondemand"],1599))}};t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!0}};t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,currentItem:this._currentItem.peek()}};t.prototype.onIsAvailable=function(){var e=this;return(!Object(It.e)(wt.u)||Object(le.isFeatureEnabled)(le.HideTaggingFeatures))&&this.selectionHelper.filterItems(function(t){return t&&(!!t.photo||!!t.video)&&t.sharingRole===L.e.Owner&&(!t.queryType||t.queryType!==Z.e.RecycleBin)&&e._itemCommandHelper.isCommandSupported(t,hn)})};return t})(an.e),Kr=n(128),Qr=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.state=n.createPureComputed(n._computeState);n._itemSelectionHelper=new(n.child(Qt.e))({allowMultiSelect:!0,canFallback:!0,overrideItem:t.item});n._itemCommandHelper=new(n.managed(en.e));n._currentItem=Object(le.isFeatureEnabled)(le.CurrentItemUsingItemSelectionHelper)?n._itemSelectionHelper.currentItem:n.resources.consume(_r.i);return n}t.prototype.getParams=function(){return{actionName:"ShowTagsEditor",selectionHelper:this._itemSelectionHelper,currentItem:this._currentItem.peek()}};t.prototype._computeState=function(){return{isAvailable:this._isAvailable()}};t.prototype._isAvailable=function(){var e=this;return(!Object(It.e)(wt.u)||Object(le.isFeatureEnabled)(le.HideTaggingFeatures))&&this._itemSelectionHelper.filterItems(function(t){return t&&(!!t.photo||!!t.video)&&t.sharingRole===L.e.Owner&&(!t.queryType||t.queryType!==Z.e.RecycleBin)&&e._itemCommandHelper.isCommandSupported(t,hn)})};return t})(ne.n),Gr=Object(Kr.e)({name:"ShowTagsEditor",source:{moduleDefinition:{path:"./ShowTagsEditorExecutor",getModule:function(){return S.n.resolve(n.ee([18,"ondemand.resx-ondemand"],1666))}}},handlerType:Qr}),Yr=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="Embed";n._isOneDriveXboxApp=Object(Xn.t)();return n}t.prototype.getExecutorPath=function(){return"./EmbedExecutor"};t.prototype.getModuleFactory=function(){return function(){return S.n.resolve(n.ee([19,"ondemand.resx-ondemand"],1656))}};t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper}};t.prototype.onIsAvailable=function(){if(!Object(le.isFeatureEnabled)(le.HideEmbedButton)&&!0===Object(It.e)(wt.u))return!1;var e=this.selectionHelper.firstItem();return!this._isOneDriveXboxApp&&e&&this.itemCommandHelper.isCommandSupported(e,Or.n)};return t})(an.e),Zr=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="EmptyRecycleBin";n._urlDataSource=n.resources.consume(V.B);n._strings=Un;n._usePollGetItemsForDeletion=t.usePollGetItemsForDeletion;n._currentItem=Object(ce.qo)(ce.J)?n.selectionHelper.currentItem:n.resources.consume(_r.i);return n}t.prototype.getExecutorPath=function(){return"./EmptyRecycleBinExecutor"};t.prototype.getModuleFactory=function(){return function(){return S.n.resolve(n.ee([161,"ondemand.resx-ondemand"],1677))}};t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}};t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,currentItem:this._currentItem.peek(),usePollGetItemsForDeletion:this._usePollGetItemsForDeletion}};t.prototype.onIsAvailable=function(){var e=this.selectionHelper.selection(),t=this._currentItem();return t&&this.itemCommandHelper.isCommandSupported(t,Nr.n)&&this._urlDataSource.isRecycleBin(t.queryType)&&t.childCount>0&&0===e.length};t.prototype.onExecute=function(t){var n=this;return this._usePollGetItemsForDeletion?e.prototype.onExecute.call(this,t):this.resources.consume(Bn.e).requestDialog({title:this._strings.emptyRecycleBin,component:{name:Rr.e.tagName,params:{text:this._strings.recycleBinEmptyConfirm}},actions:[{name:this._strings.recycleBinEmptyConfirmYes,execute:function(){return S.n.wrap(2)},isAvailable:this.createObservable(!0),icon:new Nn.e("Delete"),isDefault:!1},{name:this._strings.recycleBinEmptyConfirmNo,execute:function(){return S.n.wrap(3)},isAvailable:this.createObservable(!0),icon:new Nn.e("Cancel"),isDefault:!0}]}).wait().then(function(){return e.prototype.onExecute.call(n,t)}).then(function(){return{resultType:g.t.Success}})};return t})(an.e),ei=n(120),ti=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var r=e.call(this,t)||this;r.name="Feedback";r._executorLoader=new(r.managed(ei.e))({path:"./FeedbackExecutor",getModule:function(){return S.n.resolve(n.ee([20,"ondemand.resx-ondemand"],1648))},getExecutorParams:function(){return{}}});return r}t.prototype.onIsAvailable=function(){return!0};t.prototype.onExecute=function(e){return this._executorLoader.execute(e)};return t})(Xt.e);Object(kn.e)([{rawString:".LanguagePicker select{width:100%}"}]);var ni,ri=n(305),ii=n(80),si=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.canary=t.canary;n.selectedLanguage=t.selectedLanguage;n.loadingText=ri.t;var r=n.observables;n.isLoading=r.create(!0);n.languages=r.createArray([]);n.currentLanguage=r.create("");var i=n.resources.consume(V.g.optional);i&&i.getLanguages().then(function(e){n.canary(e.canary);n.currentLanguage(e.currentLanguage);for(var t=e.languageList,r=0,i=t;r<i.length;r++){var s=i[r];s.displayText=(ii.e.isRightToLeft?"&rlm;":"&lrm;")+s.nativeName+" - "+s.name}n.languages(t);n.isLoading(!1)});return n}return t})(An.e),oi=Pn.e({tagName:"ms-language-picker",template:'<form class="LanguagePicker">\x3c!--ko if:$data.isLoading--\x3e<div data-bind="text:loadingText"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:$data.isLoading--\x3e<select name="language" data-bind="value:selectedLanguage,foreach:languages,automation:\'dropDown\'"><option data-bind="attr:{selected:isoValue===$parent.currentLanguage()},value:isoValue,html:displayText"></option></select>\x3c!--/ko--\x3e</form>',viewModel:si}),ui=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="LanguagePicker";n._languagePickerDataSource=n.resources.consume(V.g);n._navigation=n.resources.consume(W.e);n._dialogProvider=n.resources.consume(Bn.e);n._lang=n.observables.create("");n._canary=n.observables.create("");return n}t.prototype.onExecute=function(e,t){var n=this;return this._dialogProvider.requestDialog({title:ri.e,automationId:"languagePicker",component:{name:oi.tagName,params:{selectedLanguage:this._lang,canary:this._canary}},actions:[{name:ri.n,execute:function(){return n.onDialogExecute()},isAvailable:this.observables.create(!0),icon:new Nn.e("Save"),isDefault:!0}]}).wait().then(function(){return{resultType:g.t.Success}})};t.prototype.onIsAvailable=function(){return!0};t.prototype.onDialogExecute=function(){var e=this;return this._languagePickerDataSource.saveLanguage(this._lang(),this._canary()).then(function(t){e._navigation.navigateTo(_.t(window.location.href,"mkt",t));return 2})};return t})(Xt.e),ai=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t)||this;r.name="NavigateToItem";r._urlDataSource=r.resources.consume(V.B);r._viewParams=r.resources.consume(_r.S);var i=t.item,s=t.itemSet,o=void 0===s?r.resources.consume(_r.s.optional):s,u=t.parentItem,a=t.urlType,f=t.isRedirect,l=void 0!==f&&f,c=t.forceInSameWindow,h=void 0!==c&&c,p=t.shouldPreserveAction,d=void 0!==p&&p;r._itemSet=o;r._parentItem=u;r._urlType=r.wrapObservable(a);r._isRedirect=l;r._forceInSameWindow=r.wrapObservable(h);r._shouldPreserveAction=r.wrapObservable(d);var v=n.itemSelectionHelperType,m=void 0===v?r.resources.consume(Qt.e):v;r._itemSelectionHelper=new(r.scope.attached(m))({overrideItem:i,allowMultiSelect:!1,canFallback:!0});r._url=r.createPureComputed(r._computeUrl);r._target=r.createPureComputed(r._computeTarget);var g=r.resources.consume(_r.e);r._navigationAction=new(r.managed(g.NavigationAction))({url:r._url,ignoreHistory:r._isRedirect,target:r._target});return r}t.prototype.onIsAvailable=function(){return this._navigationAction.isAvailable()};t.prototype.onExecute=function(e){return this._navigationAction.execute(e)};t.prototype.getEngagement=function(){return Object(le.isFeatureEnabled)(le.EngagementTelemetryEnhancement)?e.prototype.getEngagement.call(this).withPart(Hr.e,{item:this._itemSelectionHelper.firstItem}):e.prototype.getEngagement.call(this)};t.prototype._computeUrl=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&this._urlDataSource.getDefaultClickUrl(e,{urlType:this._urlType(),preserveAction:this._shouldPreserveAction(),itemSet:this._itemSet&&this._itemSet(),parentItem:this._parentItem&&this._parentItem(),viewParams:this._viewParams()})||""};t.prototype._computeTarget=function(){var e;return!this._forceInSameWindow()&&(e=this._url())&&0!==e.indexOf("#")?"_blank":"_top"};return t})(Xt.e),fi=n(139),li=n(171),ci=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="SortAction";n.isExecutionIntentional=!0;n._sortManager=n.resources.consume(li.r);n._column=t.column;n._ascending=t.ascending;return n}t.getSortedColumn=function(e){var t,n=e();if(n)for(var r=0;r<n.length;r++)if(n[r]&&n[r].isSorted){t=n[r];break}return t};t.prototype.onExecute=function(e,t){this._updateCurrentSort(this._column,this._ascending);return S.n.wrap({resultType:g.t.Success})};t.prototype.onIsAvailable=function(){return!0};t.prototype.onIsToggled=function(){var e=!1;this._column&&(e=this._column.isSorted&&this._column.isAscending===this._ascending);return e};t.prototype._updateCurrentSort=function(e,t){if(e){var n=e.internalName||e.key;this._sortManager.updateSort(n,t)}};return t})(Xt.e);(function(e){e[e.Column=0]="Column";e[e.Order=1]="Order"})(ni||(ni={}));var hi,pi=ni,di=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="Sort";n._sortManager=n.resources.consume(li.r);n._currentItemSet=n.resources.consume(_r.s);n._mode=t.mode;n._column=t.column;n._ascending=t.ascending;return n}t.prototype.onExecute=function(e,t){var n=ci.getSortedColumn(this._currentItemSet().schema);this._column||(this._column=n);var r={sortMode:pi[this._mode],sortAscending:"Ascending"};this._column&&(r.sortColumn=this._column.internalName||this._column.key);if(this._mode===pi.Column)this.updateCurrentSort(this._column,n.isAscending);else if(this._mode===pi.Order){if(this._currentItemSet&&this._currentItemSet().schema){r.sortAscending=this._ascending?"Ascending":"Descending";this.updateCurrentSort(n,this._ascending)}}else S.n.wrap({resultType:g.t.Failure});return S.n.wrap({resultType:g.t.Success,extraData:r})};t.prototype.onIsAvailable=function(){return!!this._currentItemSet&&(!this._isVaultLocked()&&!!ci.getSortedColumn(this._currentItemSet().schema))};t.prototype.onIsToggled=function(){var e=!1;if(this._mode===pi.Column&&this._column)e=this._column.isSorted;else if(this._mode===pi.Order&&this._currentItemSet&&this._currentItemSet().schema){var t=ci.getSortedColumn(this._currentItemSet().schema);e=t&&t.isAscending===this._ascending}return!this._isVaultLocked()&&e};t.prototype.updateCurrentSort=function(e,t){if(e){var n=e.internalName||e.key;this._sortManager.updateSort(n,t)}};t.prototype._isVaultLocked=function(){var e=this._currentItemSet&&this._currentItemSet().item();return e&&e.vault&&e.vault.isLocked};return t})(Xt.e),vi=n(137),mi=n(110),gi=!Me.e.isActivated("DA910F66-8C98-428B-8A0F-C9BDE6481EB9","08/26/2022","Perform extra sanitization prior to logging extension, part 2"),yi=new vi.e,bi=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="Open";var i=t.item,s=t.openRelation,o=void 0===s?0:s,u=t.ignoreHistory,a=void 0!==u&&u,f=t.itemSet,l=t.openLocal,c=void 0!==l&&l,h=t.urlType,p=void 0===h?"default":h,d=t.preserveAction,v=void 0!==d&&d,m=t.nonFoldersOnly,g=void 0!==m&&m;r._openRelation=o;r._nonFoldersOnly=g;r._urlType=r.wrapObservable(p);r._itemSelectionHelper=new(r.child(Qt.e))({overrideItem:2===o?i:void 0,allowMultiSelect:!1,canFallback:0!==o,ignoreSelection:0!==o});r.item=r.createComputed(r._computeItem,{deferEvaluation:!0,pure:!0});var y=r.resources.consume(_r.e);r._navigateToItemAction=new(r.managed(y.NavigateToItemAction))({item:r.item,itemSet:f,parentItem:r._itemSelectionHelper.currentItem,urlType:r._urlType,forceInSameWindow:c,isRedirect:a,shouldPreserveAction:v});return r}t.prototype.onIsAvailable=function(){var e=this.item();return(!this._nonFoldersOnly||!!e&&!e.folder)&&this._navigateToItemAction.isAvailable()};t.prototype.onExecute=function(e,t){var n=this.item.peek();if(!n)return S.n.resolve({resultType:g.t.ExpectedFailure});n.type===Gt.e.Folder&&t&&t.data&&(t.data.folder=!0);t.data.extraData||(t.data.extraData={});mi.e(t.data.extraData,{uniqueId:n.properties?n.properties.uniqueId:void 0});return this._navigateToItemAction.execute(e).then(function(){var e=gi&&n.extension?Object(Ve.e)(n.extension):n.extension||"",t={fileType:Gt.e[n.type||Gt.e.Unknown],extension:e};return S.n.resolve({resultType:g.t.Success,extraData:t})})};t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(Hr.e,{item:this.item})};t.prototype.trackUserAction=function(t){var n=this.item.peek();if(n)switch(n.type){case Gt.e.File:e.prototype.trackUserAction.call(this,"Open.File");break;case Gt.e.Media:e.prototype.trackUserAction.call(this,"Open.Media");break;default:e.prototype.trackUserAction.call(this,t)}};t.prototype._computeItem=function(){var e,t=this._itemSelectionHelper.firstItem();switch(this._openRelation){case 3:e=t&&t.UNSAFE_parent;break;case 1:case 2:e=t;break;default:case 0:e=t}return e||yi};return t})(Xt.e),wi=n(190),Ei=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._itemCommandHelper=new(n.managed(en.e));n._skipVaultChecks=!!t.ignoreHistory;return n}t.prototype.onIsAvailable=function(){var t=this.item();return e.prototype.onIsAvailable.call(this)&&this._itemCommandHelper.isCommandSupported(t,Wr)};t.prototype.onExecute=function(t,n){var r=this,i=this.item.peek();if(i&&i.vault&&!this._skipVaultChecks){var s=this.resources.consume(V.B),o=this.resources.consume(_r.S),u=s.getPageType(o.peek()),a=u===ae.e.FilePicker||u===ae.e.FolderPicker;if(i.vault.isLocked||a){var f=this.resources.consume(_r.e);return new(this.managed(f.VaultAction))({actionType:wi.e.Unlock,item:this.item}).execute(null).then(function(i){if(i.resultType===g.t.Success)return e.prototype.onExecute.call(r,t,n)})}}return e.prototype.onExecute.call(this,t,n)};return t})(bi),Si=n(519),xi=!Me.e.isActivated("A61307C5-CA5C-474C-99AB-E9F954A94351","06/06/2022","Hide preview button for loop powered files"),Ti=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="Preview";var r=n.resources.consume(_r.e);n._dataStore=new me.e("",ge.e.local);n._itemSelectionHelper=new(n.child(Qt.e))({allowMultiSelect:!1,overrideItem:t.item,canFallback:!1});n._openAction=new(n.managed(r.OpenAction))({urlType:n.observables.compute(n._computeUrlType),item:t.item,openRelation:t.item?2:void 0,nonFoldersOnly:!0});n._itemParentHelper=n.resources.consume(xn.e);return n}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem(),t=void 0;e&&(t=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")));return(!xi||!this._isBFile())&&!(!e||e.external||!this._openAction.isAvailable()||e.type===Gt.e.OneNote||Object(Si.e)()&&e.queryType===Z.e.SharedWithMe||t&&t.list&&!t.list.isDocumentLibrary)};t.prototype.onExecute=function(e,t){var n=this._itemSelectionHelper.firstItem.peek();!n||"ms-word"!==n.appMap&&"ms-powerpoint"!==n.appMap?this._dataStore.setValue("OfficeDocClickTime",""):this._dataStore.setValue("OfficeDocClickTime",new Date);return this._openAction.execute(e)};t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(Hr.e,{item:this._itemSelectionHelper.firstItem})};t.prototype._computeUrlType=function(){var e=this._itemSelectionHelper.firstItem();return e&&e.queryType===Z.e.Recent?"default":"focus"};t.prototype._isBFile=function(){var e=this._itemSelectionHelper.firstItem();if(e){var t=e.extension,n=e.properties,r=t?t.toLowerCase():"",i=n&&n.ProgId?n.ProgId:"";return".fluid"===r||".note"===r||".whiteboard"===r||".loop"===r||"Fluid."===i.substring(0,6)}return!1};return t})(Xt.e),Ni=!Me.e.isActivated("DA910F66-8C98-428B-8A0F-C9BDE6481EB9","08/26/2022","Perform extra sanitization prior to logging extension, part 2"),Ci=((hi={})[1]=Gn.Excel,hi[2]=Gn.OneNote,hi[3]=Gn.PowerPoint,hi[4]=Gn.Word,hi[5]=Gn.Visio,hi[6]=Gn.Project,hi[7]=Gn.Publisher,hi),ki=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="OpenInOfficeClient";r._itemReedemer=r.resources.consume(Zt.e);r._navigation=r.resources.consume(W.e);r._platform=r.resources.consume(zn.e);r._itemCommandHelper=new(r.managed(en.e));r._urlDataSource=r.resources.consume($.n);r._isOneDriveXboxApp=Object(Xn.t)();r._itemSelectionHelper=new(r.child(Qt.e))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._platform,t=this._itemSelectionHelper.firstItem();return(e.isMac||e.isWindows||e.isIOS||e.isWinPhone||e.isAndroid)&&!this._isOneDriveXboxApp&&!!t&&this._itemCommandHelper.isCommandSupported(t,or.o)};t.prototype.onExecute=function(e,t){return Object(i.__awaiter)(this,void 0,S.n,function(){var e,n,r=this;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:if(!(e=i.sent()))return[2,S.n.resolve({resultCode:"EmptySelection",resultType:g.t.Failure})];t.data.extraData||(t.data.extraData={});n=e.extension?e.extension.toLowerCase():void 0;mi.e(t.data.extraData,{fileType:Ni&&n?Object(Ve.e)(n):n});return[2,this._itemReedemer.redeemItem(e,this).then(function(){if(r._platform.isMobile){var t=r._navigation,n=r._urlDataSource;t.navigateTo(n.getOpenInOfficeClientUrl(e,r._navigation.viewParams,K.e.viewerId));return{resultType:g.t.Success}}var i=r._itemCommandHelper.getCommandBehavior(e,or.o),s=Ci[i];return(function(e,t,n,r,i){var s;e.type===Gt.e.OneNote&&(s=e.urls.oneNoteClient);var o={url:s,isDavUrl:!!s,fileName:e.name,iconType:e.iconName,appType:r,extension:r===Gn[2].toString()?".one":e.extension,item:e};return Zn.executeOpenInClient(o,i)})(e,K.e.viewerId,e.isGroup,Gn[s],r.resources)})]}})})};return t})(Xt.e),Li=n(520),Ai=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="OpenPdfInBrowserAction";var r=n,i=r.observables,s=r.resources;n._itemCommandHelper=s.consume(en.t);n._itemSelectionHelper=new(n.child(Qt.e))({overrideItem:t.item});n._urlDataSource=s.consume(V.B);var o=i.pureCompute(function(){var e=n._itemSelectionHelper.firstItem();return e&&e.openUrl}),u=s.consume(_r.e);n._navigationAction=new(n.managed(u.NavigationAction))({url:o,target:"_blank"});Object(Xn.e)()&&(n._openInDesktopAction=new(n.managed(u.OpenInDesktopAction))({openRelation:2,item:n._itemSelectionHelper.firstItem,actionType:Ht.OpenPdfInBrowser}));n._pdfViewerHelper=t.pdfViewerHelper;return n}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!(this._openInDesktopAction&&!this._openInDesktopAction.isAvailable())&&(!!e&&Object(Li.e)(e,this._urlDataSource)&&this._itemCommandHelper.isCommandSupported(e,Nr.a)&&".pdf"===e.extension.toLowerCase()&&(!this._pdfViewerHelper||!this._pdfViewerHelper.isPdfEditAvailable(e)))};t.prototype.onExecute=function(e,t){return this._openInDesktopAction?this._openInDesktopAction.execute(e):this._navigationAction.execute(e)};t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(Hr.e,{item:this._itemSelectionHelper.firstItem})};return t})(Xt.e),Oi=n(494),Mi=n(495),_i=!Me.e.isActivated("DA910F66-8C98-428B-8A0F-C9BDE6481EB9","08/26/2022","Perform extra sanitization prior to logging extension, part 2"),Di=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});return e.call(this,t)||this}t.prototype.onIsAvailable=function(){var e=this.item();return!!e&&((e.extension&&".pdf"===e.extension.toLowerCase()||this._itemCommandHelper.isCommandSupported(e,or.u))&&e.queryType!==Z.e.RecycleBin)};t.prototype.onExecute=function(t,n){var r,i=this.item.peek();if(i.queryType!==Z.e.Search){var s=void 0;this.resources.consume(Mi.e)()&&(s={key:null==i?void 0:i.parentKey});nr((null===(r=null==i?void 0:i.UNSAFE_parent)||void 0===r?void 0:r.isStub)?i:i.UNSAFE_parent||s,this.resources,!0)}n.data.extraData||(n.data.extraData={});var o=i.extension?i.extension.toLowerCase():void 0;mi.e(n.data.extraData,{fileType:_i&&o?Object(Ve.e)(o):o});try{localStorage.ODCWac_ST=(new Date).getTime().toString()}catch(e){}return e.prototype.onExecute.call(this,t,n)};return t})(Oi.e),Pi=n(193),Hi=n(140),Bi=n(355),ji=(function(){function e(){}e.alert=function(t,n,r,i,s){void 0===r&&(r=!1);void 0===s&&(s="alert");var o="sp_a11y_alert_"+t,u=document.querySelector("#"+o);u&&document.body.removeChild(u);var a=document.createElement("p");r||a.setAttribute("style",e._cssHidden);i&&a.classList.add(i);a.setAttribute("role",s);a.setAttribute("aria-live","assertive");a.setAttribute("id",o);var f=document.createTextNode(n);document.body.appendChild(a);a.appendChild(f)};e._cssHidden="position:absolute;text-indent:-9999px;\n    width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;border:0;";return e})(),Fi=de.e.isActivated("995DA390-4F3E-4CA5-A276-9DAB53FEE8A8","10/21/2022","Enables the openInTextEditor Command for html files"),Ii=de.e.isActivated("2A5735C3-7E7C-4AA8-BB28-03BF84755D01","11/9/2022","Defers Open commands until after the Open Command Menu is closed"),qi=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="OpenInTextEditor";var i=r.resources,s=n.urlDataSource,o=void 0===s?i.consume(V.B):s,u=n.viewParams,a=void 0===u?i.consume(_r.S):u,f=n.itemCommandHelper,l=void 0===f?i.consume(en.t):f,c=n.platformDetection,h=void 0===c?i.consume(zn.e):c,p=n.actionMap,d=void 0===p?i.consume(_r.e):p;r._urlDataSource=o;r._viewParams=a;r._itemCommandHelper=l;r._platformDetection=h;r._url=r.createPureComputed(r._computeUrl);r.itemSelectionHelper=new(r.child(Qt.e))({overrideItem:t.item});r._navigationAction=new(r.managed(d.NavigationAction))({url:r._url,target:r._platformDetection.isPWA?"_self":"_blank"});r._isOneDriveWinApp=Object(Xn.e)();return r}t.prototype.onIsAvailable=function(){var e=this.itemSelectionHelper.firstItem();if(!e)return!1;if(Object(ce.qo)(le.EnableOneUpTextFileV2)&&!this._availableForHtml(e))return!1;var t=this.itemSelectionHelper.currentItem(),n=this._urlDataSource.getKeyParams(t.key),r=this._urlDataSource.getQueryType(n),i=de.e.isActivated("35BD4D5C-F09B-4F80-BBFD-1080AFB2EBC1","11/10/2021","Use item.parentKey as fallback since item.UNSAFE_parent will not be set in ItemsScope pivots")?!!e.UNSAFE_parent||Object(ce.qo)(ce.bo)&&!!e.parentKey:!!e.UNSAFE_parent||!!e.parentKey;return this._itemCommandHelper.isCommandSupported(e,Nr.u)&&!this._platformDetection.isMobile&&this._navigationAction.isAvailable()&&!!e&&i&&Object(Hi.r)(e.extension,e.type)&&r!==Z.e.SharedWithMe&&!this._isOneDriveWinApp&&!this._urlDataSource.isRecycleBin(r)&&e.itemStatus!==Pi.e.ConditionalAccessViewOnly&&e.itemStatus!==Pi.e.ConditionalAccessBlocked};t.prototype.onExecute=function(e){var t=this;return Ii?this._navigationAction.execute(e):new S.n(function(n){setTimeout(function(){ji.alert("OpenInTextEditor",Un.OpenInTextEditorAriaAlert);n(t._navigationAction.execute(e))},0)})};t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(Hr.e,{item:this.itemSelectionHelper.firstItem})};t.prototype._computeUrl=function(){var e=this.itemSelectionHelper.firstItem();if(!e||!e.UNSAFE_parent&&!e.parentKey)return"";if(!Object(ce.qo)(le.EnableOneUpTextFileV2))return this._urlDataSource.getTextEditorItemUrl(e,{parentItem:this.itemSelectionHelper.currentItem(),viewParams:this._viewParams()});var t=this._availableForHtml(e)?this._urlDataSource.saveViewerType("TextFile"):{};return this._urlDataSource.getDefaultClickUrl(e,{parentItem:this.itemSelectionHelper.currentItem(),viewParams:this._viewParams(),additionalViewParams:t})};t.prototype._availableForHtml=function(e){var t=e&&e.htmlConversion&&Object(ce.qo)(le.UseSandboxHtmlViewer)&&(Object(Bi.e)()||this._platformDetection.isEdge),n="TextFile"===this._urlDataSource.getViewerType(this._viewParams());return t&&!n&&!Fi};return t})(Xt.e),Ri=de.e.isActivated("17DB17D7-FC3F-4243-B2CE-A54D5E531404","10/27/2022","Enable OpenInHtmlViewer Action"),Ui=de.e.isActivated("2A5735C3-7E7C-4AA8-BB28-03BF84755D01","11/9/2022","Defers Open commands until after the Open Command Menu is closed"),zi=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="OpenInHtmlViewer";var i=r.resources,s=n.urlDataSource,o=void 0===s?i.consume(V.B):s,u=n.viewParams,a=void 0===u?i.consume(_r.S):u,f=n.itemCommandHelper,l=void 0===f?i.consume(en.t):f,c=n.platformDetection,h=void 0===c?i.consume(zn.e):c,p=n.actionMap,d=void 0===p?i.consume(_r.e):p;r._urlDataSource=o;r._viewParams=a;r._itemCommandHelper=l;r._platformDetection=h;r._url=r.createPureComputed(r._computeUrl);r.itemSelectionHelper=new(r.child(Qt.e))({overrideItem:t.item});r._navigationAction=new(r.managed(d.NavigationAction))({url:r._url,target:r._platformDetection.isPWA?"_self":"_blank"});return r}t.prototype.onIsAvailable=function(){var e=this.itemSelectionHelper.firstItem();if(!e)return!1;if(!Object(ce.qo)(le.EnableOneUpTextFileV2))return!1;var t=e&&e.htmlConversion&&Object(ce.qo)(le.UseSandboxHtmlViewer)&&(Object(Bi.e)()||this._platformDetection.isEdge),n="TextFile"!==this._urlDataSource.getViewerType(this._viewParams());return this._itemCommandHelper.isCommandSupported(e,Nr.s)&&t&&!n&&!Ri};t.prototype.onExecute=function(e){var t=this;return Ui?this._navigationAction.execute(e):new S.n(function(n){setTimeout(function(){ji.alert("OpenInHTMLViewer",Un.OpenInHtmlViewerAriaAlert);n(t._navigationAction.execute(e))},0)})};t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(Hr.e,{item:this.itemSelectionHelper.firstItem})};t.prototype._computeUrl=function(){var e=this.itemSelectionHelper.firstItem();if(!e||!e.UNSAFE_parent&&!e.parentKey)return"";var t=this._urlDataSource.saveViewerType("Html");return this._urlDataSource.getDefaultClickUrl(e,{parentItem:this.itemSelectionHelper.currentItem(),viewParams:this._viewParams(),additionalViewParams:t})};return t})(Xt.e),Wi=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="OrderPrints";n._platformDetection=n.resources.consume(zn.e);n._identity=n.resources.consume(V.h).getIdentity();n._isOneDriveXboxApp=Object(Xn.t)();return n}t.prototype.getExecutorPath=function(){return"./OrderPrintsExecutor"};t.prototype.getModuleFactory=function(){return function(){return S.n.resolve(n.ee([23,"ondemand.resx-ondemand"],1660))}};t.prototype.getExecutorParameters=function(){return{actionName:this.name,itemSelectionHelper:this.selectionHelper}};t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}};t.prototype.onIsAvailable=function(){if(!Object(le.isFeatureEnabled)(le.EnableOrderPrints))return!1;if(this._identity.type===ue.e.anonymous)return!1;var e=this.selectionHelper.firstItem(),t=this.selectionHelper.selection().length,n=e&&e.queryType,r=n===Z.e.Files||n===Z.e.Photos||Object(Ie.e)(n)||n===Z.e.AllMyPhotos||n===Z.e.SharedWithMe;return!(!t||!r||this._isOneDriveXboxApp)&&(this._identity.type!==ue.e.aad&&e.photo&&t>=1&&t<=100&&$Config&&"en-us"===$Config.mkt.toLowerCase()&&!this._platformDetection.isMac)};return t})(an.e),Xi=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="PlayAudio";var r=n.resources.consume(_r.e),i=n.observables;n._item=new(n.child(Qt.e))({overrideItem:t.item,allowMultiSelect:!1,canFallback:!1}).firstItem;var s=new(n.managed(r.OpenAction))({urlType:i.pureCompute(n._computeUrlType),item:t.item,nonFoldersOnly:!0});n._action=s;return n}t.prototype.onIsAvailable=function(){var e=this._item();return e&&!e.external&&!!e.audio&&this._action.isAvailable()};t.prototype.onExecute=function(e,t){return this._action.execute(e)};t.prototype._computeUrlType=function(){var e=this._item();return e&&e.queryType===Z.e.Recent?"default":"focus"};return t})(Xt.e),Vi=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="PlaySlideShow";r._slideshowState=r.resources.consume(_r.b);r._itemSelectionHelper=new(r.child(Qt.e))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e,t,n=this._itemSelectionHelper.firstItem(),r=!(!Object(le.isFeatureEnabled)(le.EnableLivePhotoVideos)||!(null===(e=null==n?void 0:n.photo)||void 0===e?void 0:e.isLivePhoto)),i=!(!Object(le.isFeatureEnabled)(le.EnableSamsungMotionPhotoVideos)||!(null===(t=null==n?void 0:n.photo)||void 0===t?void 0:t.isSamsungMotionPhoto));return!(!n||!n.photo||r||i||this._slideshowState.isSlideShowModeEnabled())};t.prototype.onExecute=function(e,t){this._slideshowState.isSlideShowModeEnabled(!0);return this._slideshowState.enterSlideshowMode()?S.n.resolve({resultType:g.t.Success}):S.n.resolve({resultType:g.t.Failure})};return t})(Xt.e),$i=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="StopSlideShow";r._slideshowState=r.resources.consume(_r.b);r._itemSelectionHelper=new(r.child(Qt.e))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){return!!this._itemSelectionHelper.firstItem()&&this._slideshowState.isSlideShowModeEnabled()};t.prototype.onExecute=function(e,t){return this._slideshowState&&this._slideshowState.exitSlideshowMode()?S.n.resolve({resultType:g.t.Success}):S.n.resolve({resultType:g.t.Failure})};return t})(Xt.e),Ji=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="RemoveCoverPhotoAction";r._itemReedemer=r.resources.consume(Zt.e);r._itemCommandHelper=new(r.managed(en.e));r._itemSelectionHelper=new(r.child(Qt.e))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e,t=this,n=this._itemSelectionHelper.currentItem(),r=null===(e=null==n?void 0:n.vault)||void 0===e?void 0:e.root;return n.queryType!==Z.e.SharedWithMe&&!r&&(!n.isBundle||!!n.isAlbum)&&this._itemSelectionHelper.filterItems(function(e){return t._itemCommandHelper.isCommandSupported(e,on)})};t.prototype.onExecute=function(e,t){return Object(i.__awaiter)(this,void 0,S.n,function(){var e,t=this;return Object(i.__generator)(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveSelection()];case 1:return(e=n.sent()).length?[2,this._itemReedemer.redeemItems(e,this).then(function(){var n,r=t.resources.consume(tn.resourceKey),i=e[0].UNSAFE_parent;if(Object(ce.qo)(ce.eo)){var s=e[0],o=(null==s?void 0:s.parentKey)&&Object(O.m)(s.parentKey);n={key:e[0].parentKey,id:o.id}}return r.removeCoverPhotos({items:e,target:i||n,itemsScopeInvalidate:!!n}).then(function(){return{resultType:g.t.Success}})})]:[2,S.n.resolve({resultCode:"EmptySelection",resultType:g.t.Failure})]}})})};return t})(Xt.e),Ki=n(549),Qi=n(293),Gi=n(199),Yi=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._dataSource=n.mruRecentDataSource;r._itemProvider=n.itemProvider;var i=n.location,s=void 0===i?window.location:i;r._origin=new Qi.e(s.href).authority;return r}t.prototype.changePinStatus=function(e){return this._dataSource.changePinStatus(e)};t.prototype.getTokenForMru=function(){return this._dataSource.getTokenForMru()};t.prototype.removeFromRecent=function(e){var t=this;return Object(le.isFeatureEnabled)(le.MruToMruPlusPlusSkyApi)?this._dataSource.removeRecentItem(e).then(function(n){t._itemProvider.invalidateItem(e.parentKey);return n}):this._itemProvider.removeFromRecent(e)};t.prototype.recordDocumentView=function(e){var t=e.graph,n=new Qi.e(e.openUrl),r="".concat(n.authority||this._origin).concat(n.path),s=e.sharingType,o=e.dateCreatedTime,u=e.dateModifiedTime,a=e.mruState,f=e.properties,l=void 0===f?{}:f,c=l.editorName,h=void 0===c?[]:c,p=l.creatorName,d=void 0===p?[]:p,v=a&&a.mruId,m=h[0],g=d[0],y=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({category:"Document",type:"DocumentUrl",app:Zi(e),url:r},(function(e){var t=e.name,n=e.extension,r=n&&n.replace(/^\.+/,"");return{title:t&&(n?t.replace(RegExp(".".concat(r,"$")),""):t),extension:r}})(e)),{file_size:e.size}),v?{mru_id:v}:{onedrive_info:t&&{drive_id:t.driveId,item_id:t.itemId,parent_reference_id:e.UNSAFE_parent&&e.UNSAFE_parent.graph&&e.UNSAFE_parent.graph.itemId,drive_type:t.driveType},resource_id:e.itemId}),{sharing_info:{state:"number"==typeof s&&s<Gi.e.Private?1:0},modification_info:es(m,u),creation_info:es(g,o)});return this._dataSource.recordDocumentView(e,y)};t.dependencies=Object(i.__assign)(Object(i.__assign)({},ne.n.dependencies),{itemProvider:tn.resourceKey,mruRecentDataSource:V.w});return t})(ne.n);function Zi(e){return Object(Ki.e)(e.extension)?"PdfViewer":e.audio||e.image360||e.photo||e.video?"Media":"OtherNonOffice"}function es(e,t){if(e&&t)return{timestamp:t.toISOString(),user_info:{upn:e.sip||e.email,display_name:e.title}}}var ts=Object(X.s)("MruRecentProvider",Yi),ns=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="RemoveFromRecent";r._urlDataSource=r.resources.consume(V.B);r._itemCommandHelper=new(r.managed(en.e));r._itemSelectionHelper=new(r.child(Qt.e))({allowMultiSelect:!Object(le.isFeatureEnabled)(le.MruToMruPlusPlusSkyApi),canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._urlDataSource.getKeyParams(this._itemSelectionHelper.currentItem().key),t=this._urlDataSource.getQueryType(e),n=this._itemSelectionHelper.firstItem();return t===Z.e.Recent&&!!n&&this._itemCommandHelper.isCommandSupported(n,rn)};t.prototype.onExecute=function(e,t){var n=this,r=this._itemSelectionHelper.currentItem.peek();return this._itemSelectionHelper.resolveSelection().then(function(e){n._itemSelectionHelper.clearSelection();return n.resources.consumeAsync(ts).then(function(t){return t.removeFromRecent({parentKey:r.key,items:e})})}).then(function(){return{resultType:g.t.Success}})};return t})(Xt.e),rs=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="RemoveTag";r._tag=t.tag;r._itemReedemer=r.resources.consume(Zt.e);r._itemCommandHelper=new(r.managed(en.e));r._itemSet=r.resources.consume(_r.s.optional);r._tagProvider=r.resources.consume(G.p);r._itemSelectionHelper=new(r.child(Qt.e))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this;return(!Object(It.e)(wt.u)||Object(le.isFeatureEnabled)(le.HideTaggingFeatures)||"objectdetectors"===this._tag().source)&&this._itemSelectionHelper.filterItems(function(t){return e._itemCommandHelper.isCommandSupported(t,pn)})};t.prototype.onExecute=function(e,t){return Object(i.__awaiter)(this,void 0,S.n,function(){var e,t=this;return Object(i.__generator)(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveSelection()];case 1:return(e=n.sent()).length?[2,this._itemReedemer.redeemItems(e,this).then(function(){var n,r=t._tag.peek(),i=t.resources.consume(G.u).getAllPhotosSettings().peek(),s=t._itemSet&&(null===(n=t._itemSet.peek())||void 0===n?void 0:n.key);return t._tagProvider.updateTags({items:e,tagsToAdd:null,tagsToDelete:[r],parentKey:s,rootItemId:i.rootId}).then(function(){return{resultType:g.t.Success}})})]:[2,S.n.resolve({resultCode:"EmptySelection",resultType:g.t.Failure})]}})})};return t})(Xt.e),is=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="Rename";return n}t.prototype.getExecutorPath=function(){return"./RenameExecutor"};t.prototype.getModuleFactory=function(){return function(){return S.n.resolve(n.ee([165],1678))}};t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper}};t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return e&&this.itemCommandHelper.isCommandSupported(e,Nr.f)};return t})(an.e),ss=new Te.t({name:"".concat("RestoreAction",".restoreItemsOperator"),loader:new X.t(function(){return S.n.resolve(n.ee([31],1600)).then(function(e){return e.typeResourceKey})})}),os=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._urlDataSource=n.resources.consume(V.B);n._itemSelectionHelper=new(n.child(Qt.e))({allowMultiSelect:!0,overrideItem:t.item});n._itemCommandHelper=new(n.managed(en.e));return n}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();if(!e)return!1;var t=this._itemSelectionHelper.currentItem(),n=this._urlDataSource.getKeyParams(t.key);return!!this._urlDataSource.isRecycleBin(this._urlDataSource.getQueryType(n))&&this._itemCommandHelper.isCommandSupported(e,Nr.c)};t.prototype.onExecute=function(e){var t=this,n=this._itemSelectionHelper.currentItem.peek().key;return this._itemSelectionHelper.resolveSelection().then(function(e){return t.resources.consumeAsync(ss).then(function(r){var i=new r({parentKey:n,items:e});t.trackPromise(i.start());return i.wait()})}).then(function(){return{resultType:g.t.Success}})};return t})(Xt.e),us=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="RestoreAll";n._itemCommandHelper=new(n.managed(en.e));n._currentItem=Object(ce.qo)(ce.J)?n.selectionHelper.currentItem:n.resources.consume(_r.i);return n}t.prototype.getExecutorPath=function(){return"./RestoreAllExecutor"};t.prototype.getModuleFactory=function(){return function(){return S.n.resolve(n.ee([30],1601))}};t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}};t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,currentItem:this._currentItem}};t.prototype.onIsAvailable=function(){var e=this.selectionHelper.selection&&this.selectionHelper.selection(),t=this._currentItem();return t&&t.childCount>0&&0===e.length&&this._itemCommandHelper.isCommandSupported(t,Nr.l)};return t})(an.e),as=n(441),fs=new Te.t({name:"RotateAction",loader:new X.t(function(){return S.n.resolve(n.ee([32],1602)).then(function(e){return e.typeResourceKey})})}),ls=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._itemSelectionHelper=new(n.child(Qt.e))({allowMultiSelect:!0,overrideItem:t.item});n._itemCommandHelper=new(n.managed(en.e));n._itemRedeemer=n.resources.consume(Zt.e);return n}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return this._itemCommandHelper.isCommandSupported(e,ln)};t.prototype.onExecute=function(e){var t=this,n=this._itemSelectionHelper.currentItem.peek().key;return this._itemSelectionHelper.resolveSelection().then(function(e){return t._itemRedeemer.redeemItems(e,t).then(function(){return S.n.resolve(t.resources.consumeAsync(fs))}).then(function(r){var i=new r({items:e,parentKey:n,rotation:as.e.right});return t.trackPromise(i.start())})}).then(function(){return{resultType:g.t.Success}})};return t})(Xt.e),cs=n(196),hs=n(181),ps=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="SaveSort";n._item=n.resources.consume(_r.i);n._currentItemSet=n.resources.consume(_r.s);return n}t.prototype.onExecute=function(e,t){var n=ci.getSortedColumn(this._currentItemSet().schema);if(!n)return S.n.wrapError({resultType:g.t.Failure});var r=n.isAscending,i=cs.e[n.internalName||n.key].toString(),s=null===r?hs.e.defaultValue.toString():r?hs.e.ascending.toString():hs.e.descending.toString();return this.resources.consume(tn.resourceKey).saveSortOrder({sortOrder:i,sortDirection:s,item:this._item()}).then(function(){return{resultType:g.t.Success}})};t.prototype.onIsAvailable=function(){var e=this._item(),t=e&&e.displayType;return!(e&&e.vault&&e.vault.isLocked)&&(t===Z.e.Files||t===Z.e.Photos)};return t})(Xt.e),ds=n(308),vs=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="SetFocus";n._selector=t.selector;n._shouldClick=t.shouldClick;return n}t.prototype.onExecute=function(e,t){var n=document.querySelector(this._selector);if(n){n.focus();this._shouldClick&&ds.e.clickElement(n)}return S.n.wrap({resultType:g.t.Success})};return t})(In.e),ms=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.sharingMethod=t&&t.sharingMethod?t.sharingMethod:null;n._alreadyRedeemed=t&&t.alreadyRedeemed?t.alreadyRedeemed:null;n.name="ShareByLink";n._urlDataSource=n.resources.consume(V.B);n._itemCommandHelper=new(n.managed(en.e));return n}t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();if(!e)return!1;var t=this.selectionHelper.selection().length,n=t>1&&e.queryType===Z.e.SharedWithMe&&e.isRootFolder,r=t>1&&e.isAlbum,i=this._urlDataSource.isRecycleBin(e.queryType);return(this._itemCommandHelper.isCommandSupported(e,Or.u)||e.vault)&&!n&&!r&&!i&&this._allItemsSupportShare()};t.prototype.getExecutorPath=function(){return"./ShareByLinkExecutor"};t.prototype.getModuleFactory=function(){return function(){return S.n.resolve(n.ee([167,"ondemand.resx-ondemand"],1630))}};t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!0}};t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,startState:this._startState,alreadyRedeemed:this._alreadyRedeemed,sharingMethod:this.sharingMethod}};t.prototype._allItemsSupportShare=function(){var e=this.selectionHelper.selection();if(!e.length)return!1;for(var t=0,n=e;t<n.length;t++){var r=n[t];if(r){var i=r();if(!i)return!0;if(!this._itemCommandHelper.isCommandSupported(i,Or.u)&&(!i.vault||i.vault.isLocked))return!1}}return!0};return t})(an.e),gs=(function(e){Object(i.__extends)(t,e);function t(t){var r=e.call(this,t)||this;r.name="ShowKeymap";r._executorLoader=new(r.managed(ei.e))({path:"./ShowKeyboardMapExecutor",getModule:function(){return S.n.resolve(n.ee([37,"ondemand.resx-ondemand"],1667))},getExecutorParams:function(){return{}}});return r}t.prototype.onIsAvailable=function(){return!0};t.prototype.onExecute=function(e){return this._executorLoader.execute(e)};return t})(Xt.e),ys=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._operationProvider=n.resources.consume(fr.e);n.state=n.createPureComputed(n._computeState);return n}t.prototype._computeState=function(){return{isAvailable:this._operationProvider.overall.state()!==dr.e.expired,isToggled:this._operationProvider.isLocked()}};return t})(ne.n),bs=Object(Kr.e)({name:"ShowOperations",source:{moduleDefinition:{path:"./ShowOperationsExecutor",getModule:function(){return S.n.resolve(n.ee([38,"ondemand.resx-ondemand"],1637))}}},handlerType:ys});Object(kn.e)([{rawString:"@keyframes commandBarBoxShadowAnimation{0%{box-shadow:none;background-color:transparent}100%{background-color:"},{theme:"listBackground",defaultValue:"#fff"},{rawString:";box-shadow:0 3.2px 7.2px 0 rgba(0,0,0,.132),0 .6px 1.8px 0 rgba(0,0,0,.108)}}@keyframes commandBarDividerAnimation{0%{opacity:1}100%{opacity:0}}.InfoPane-sharing{margin-top:.5rem}.InfoPane-sectionHeaderText{font-size:.875rem}.od-SharingSection-ManageAccessLink{font-size:.75rem}.SharingSection-shareLink{line-height:1.625rem;font-size:.75rem}html[dir=ltr] .SharingSection-shareLink{float:right}html[dir=rtl] .SharingSection-shareLink{float:left}.SharingSection-entity{padding:.5rem 0;font-size:.75rem}.SharingSection-entity .ms-Persona{white-space:nowrap}.SharingSection-entity .ms-Persona .ms-Persona-details{display:inline-block;max-width:10.625rem;padding:0}.SharingSection-addPeople{font-size:1.125rem;min-height:3.125rem;margin-top:.625rem}.SharingSection-addPeople-icon{display:inline-block;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#fff"},{rawString:";font-size:1.25rem;border-radius:50%;width:3.125rem;height:3.125rem}[dir=ltr] .SharingSection-addPeople-icon{margin-right:.625rem}[dir=rtl] .SharingSection-addPeople-icon{margin-left:.625rem}.SharingSection-addPeople-icon .ms-Icon--PeopleAdd{position:relative;top:.75rem}[dir=ltr] .SharingSection-addPeople-icon .ms-Icon--PeopleAdd{left:.9375rem}[dir=rtl] .SharingSection-addPeople-icon .ms-Icon--PeopleAdd{right:.9375rem}.SharingSection-addPeople-text{display:inline-block;vertical-align:top;line-height:3.125rem}.SharingSection-linksBox a{display:inline-block;margin-top:.3125rem}.SharingSection-link,.od-PermissionsPanel-link{padding-top:.5rem}.od-alert{display:none}.od-alert.od-PermissionsPanel-alert{display:block}div.ms-ContextualMenu.is-open{z-index:299}.od-PermissionsPanel{height:100%;overflow-y:auto;overflow-x:hidden}.od-PermissionsPanel .od-SharingLink-linkSwitcher{font-size:.75rem}.od-PermissionPile-FacePile{display:inline-block;margin:0;padding:0}.od-PermissionPile-FacePile.od-PermissionPile-Unshared{display:inline-flex;flex-wrap:wrap;justify-content:start}.od-PermissionsPanel-shareLink{line-height:1.625rem;font-size:.75rem}html[dir=ltr] .od-PermissionsPanel-shareLink{float:right}html[dir=rtl] .od-PermissionsPanel-shareLink{float:left}.od-PermissionPile-accessibleLabel{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.od-PermissionsPanel-stopSharing{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:1rem;background:0 0;border:none;padding:0;cursor:pointer}.od-PermissionsPanel-stopSharing:focus,.od-PermissionsPanel-stopSharing:hover{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-PermissionsPanel-stopSharing a:focus{border:.0625rem solid "},{theme:"white",defaultValue:"#fff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.od-PermissionsPanel-stopSharing a:focus{border:.0625rem solid "},{theme:"black",defaultValue:"#000"},{rawString:"}}.od-PermissionsPanel-entity{padding:.5rem 0;font-size:.75rem}.od-PermissionsPanel-entity .od-Persona .od-Persona-details{display:inline-block;max-width:200px;padding:0}.od-PermissionsPanel-addPeople{font-size:1.0625rem;min-height:3.125rem;padding-bottom:.625rem}.od-PermissionsPanel-addPeople-icon{display:inline-block;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#fff"},{rawString:";font-size:1.25rem;border-radius:50%;width:3.125rem;height:3.125rem}[dir=ltr] .od-PermissionsPanel-addPeople-icon{margin-right:.625rem}[dir=rtl] .od-PermissionsPanel-addPeople-icon{margin-left:.625rem}.od-PermissionsPanel-addPeople-icon .ms-Icon--PeopleAdd{position:relative;top:.75rem;left:.9375rem}.od-PermissionsPanel-addPeople-text{display:inline-block;vertical-align:top;line-height:3.125rem}.od-PermissionsPanel-linksBox a{display:inline-block;margin-top:.3125rem}.od-PermissionsPanel-link{padding-top:.5rem}.od-PermissionsPanel-container{overflow:hidden}.od-PermissionsPanel-container-withCommandbar{top:40px}.od-PermissionsPanel-head{font-size:1.25rem;font-weight:600;margin-bottom:.5rem}.od-PermissionsPanel-fileName{font-size:.875rem;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";overflow:hidden;text-overflow:ellipsis;white-space:nowrap;height:1.5625rem}[dir=ltr] .od-PermissionsPanel-fileName{padding-right:2.5rem}[dir=rtl] .od-PermissionsPanel-fileName{padding-left:2.5rem}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path{padding:.1875rem;display:inline-block;vertical-align:middle}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path .od-PermissionsPanel-Path-Element{display:inline;word-break:break-all}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path .od-PermissionsPanel-Path-Element:after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:';padding:0 .3125rem;font-size:.5rem;font-weight:800;content:"\\e76c"}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path .od-PermissionsPanel-Path-Element:last-child:after{content:"";display:none}html[dir=rtl] .od-PermissionsPanel-Path-Element:after{content:"\\e76b"}.od-PermissionsPanel-titleBar{padding-top:1rem;padding-bottom:.25rem;border-bottom:solid .0625rem '},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}[dir=ltr] .od-PermissionsPanel-titleBar{padding-left:1rem}[dir=rtl] .od-PermissionsPanel-titleBar{padding-right:1rem}.od-PermissionsPanel-parent{height:100%}.od-PermissionsPanel-content{padding-top:15px;padding-left:32px;padding-right:5px}.od-PermissionsPanel-linksBox,.od-PermissionsPanel-linksBox-row{right:0;bottom:0}.od-SharingSection-PermissionsPile{width:20rem;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";box-sizing:border-box;margin-bottom:1rem;padding:1rem 1.5rem}.od-SharingSection-PermissionsPile .InfoPane-sectionHeader{cursor:default;padding-bottom:0}.od-SharingSection-PermissionsPile .od-Link:focus-visible{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SharingSection-ManageAccessLink-Button{border:0;background:"},{theme:"white",defaultValue:"#fff"},{rawString:";font-size:inherit;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";cursor:pointer}.od-SharingSection-PermissionsPile-personas{margin-bottom:.25rem}.od-SharingSection-PermissionsPile-personas .od-Persona{display:inline-block;width:2rem;height:2rem;box-sizing:border-box;cursor:pointer;vertical-align:top}[dir=ltr] .od-SharingSection-PermissionsPile-personas .od-Persona{margin-right:.25rem}[dir=rtl] .od-SharingSection-PermissionsPile-personas .od-Persona{margin-left:.25rem}.od-SharingSection-PermissionsPile-personas .od-Persona.od-Persona--xs{border:.0625rem solid transparent}.od-SharingSection-PermissionsPile-personas .od-Persona.od-Persona--xs .od-Persona-initials{font-size:1rem}.od-SharingSection-PermissionsPile-personas .od-Persona.od-HasAccessControl{text-align:center;padding:.375rem 0;height:unset;width:unset}.od-SharingSection-PermissionsPile-personas .od-Persona.od-Pointer{cursor:auto}.od-SharingSection-PermissionsPile-personas .od-Persona-presence{box-sizing:border-box;border:.0625rem solid "},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-SharingSection-PermissionsPile-personas .od-PersonaTile{outline:0}.od-SharingSection-PermissionsPile-personas .od-Persona-image[disabled] .od-SharingSection-PermissionsPile-addFriend{cursor:default;background-color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-focus--enabled .od-Persona--xs:focus{box-shadow:0 0 0 .0625rem "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:" inset}.od-SharingSection-PermissionsPile-addFriend{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#fff"},{rawString:";height:100%;border-radius:50%;position:relative;font-size:1.0625rem}.od-SharingSection-PermissionsPile-numberText{font-size:.625rem;padding-top:1rem;text-align:center;pointer-events:none;color:"},{theme:"black",defaultValue:"#000"},{rawString:";line-height:normal}.od-SharingSection-PermissionsPile-personaBorder{box-sizing:border-box}.od-SharingSection-PermissionsPile-personaBorder:focus{outline:.0625rem solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SharingSection-PermissionsPile-personaBorder .ms-Icon{font-size:.875rem}.od-SharingSection-PermissionsPile-personaIcon{position:relative;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";height:100%;pointer-events:none;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";border-radius:50%}.od-SharingSection-PermissionsPile-personaIcon.od-SharingSection-PermissionsPile-personaIcon--many .ms-Icon{position:absolute;top:.25rem;transform:translateX(-50%);color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";font-size:.75rem;line-height:normal}[dir=ltr] .od-SharingSection-PermissionsPile-personaIcon.od-SharingSection-PermissionsPile-personaIcon--many .ms-Icon{left:50%}[dir=rtl] .od-SharingSection-PermissionsPile-personaIcon.od-SharingSection-PermissionsPile-personaIcon--many .ms-Icon{right:50%}.od-SharingSection-PermissionsPile-personaMore{position:relative;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";height:100%}.od-SharingSection-PermissionsPile-moreNumber{position:absolute;font-size:.625rem;top:50%;transform:translate(-50%,-50%);color:"},{theme:"black",defaultValue:"#000"},{rawString:"}[dir=ltr] .od-SharingSection-PermissionsPile-moreNumber{left:50%}[dir=rtl] .od-SharingSection-PermissionsPile-moreNumber{right:50%}.od-SharingSection-PermissionsPile-description{margin-bottom:.25rem;padding:.125rem}.od-SharingSection-PermissionsPile-description .ms-Icon{font-size:.75rem;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SharingSection-PermissionsPile-descriptionText{display:inline-block;font-size:.75rem;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";vertical-align:top;padding:.1875rem}.od-Persona .od-Persona--xs{display:inline-block}.od-SharingSection-PermissionsPile-personas .od-Persona .od-Persona-details{display:none}.od-Panel-button--close .ms-Icon--Cancel{font-size:1rem}.od-ShowPermissions-commandBar{outline:0;margin:0;border:0;top:0;width:100%;padding:0;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-ShowPermissions-commandBar .ms-CommandBar{animation-name:ms-fadeIn,ms-slideDownIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(0.1,0.9,0.2,1);animation-fill-mode:both;animation-delay:.5s;padding:0}@media (prefers-reduced-motion:reduce){.od-ShowPermissions-commandBar .ms-CommandBar{animation:none}}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";box-shadow:inset 0 .0625rem 0 0 "},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:";color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button i{color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button:hover{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:none}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button:focus{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:0 0 0 .0625rem "},{theme:"white",defaultValue:"#fff"},{rawString:" inset}.od-ShowPermissions-commandBar .CommandBar{animation-name:ms-fadeIn,ms-slideDownIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(0.1,0.9,0.2,1);animation-fill-mode:both;animation-delay:.5s}@media (prefers-reduced-motion:reduce){.od-ShowPermissions-commandBar .CommandBar{animation:none}}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:hover{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";box-shadow:inset 0 .0625rem 0 0 "},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-icon{color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-icon .od-IconGlyph{color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-commandText{color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-linkWrapper{padding-left:.75rem;padding-right:.75rem}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:hover{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:none}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:hover .CommandBarItem-icon{color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:hover .CommandBarItem-commandText{color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:focus{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:focus .CommandBarItem-link:before{border:.0625rem solid "},{theme:"themeDarker",defaultValue:"#004578"},{rawString:";margin:-.375rem}"}]);var ws=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.state=n.createPureComputed(n._computeState);n._itemSelectionHelper=new(n.child(Qt.e))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item});n._itemCommandHelper=n.resources.consume(en.t);n.engagementSource=t.engagementSource;return n}t.prototype.getParams=function(){return{item:this._itemSelectionHelper.firstItem.peek(),engagementSource:this.engagementSource}};t.prototype._computeState=function(){var e=this._itemSelectionHelper.firstItem(),t=this._itemCommandHelper.isCommandSupported(e,Or.u),n=e&&e.remoteItem;return{isAvailable:!!e&&t&&!n}};return t})(ne.n),Es=Object(Kr.e)({name:"ShowPermissions",source:{moduleDefinition:{path:"./ShowPermissionsExecutor",getModule:function(){return S.n.resolve(n.ee([39,"ondemand.resx-ondemand"],1633))}}},handlerType:ws});Object(kn.e)([{rawString:".od-SuggestedFiles-titleBar{padding-bottom:8px}.od-SuggestedFiles-head{font-size:20px;font-weight:600}.od-SuggestedFiles-description{padding:4px 0 12px;font-size:14px;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}"}]);var Ss=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.state=n.createPureComputed(n._computeState);return n}t.prototype._computeState=function(){return{isAvailable:!0}};return t})(ne.n),xs=Object(Kr.e)({name:"ShowSuggestedFiles",source:{moduleDefinition:{path:"./ShowSuggestedFilesExecutor",getModule:function(){return S.n.resolve(n.ee([40,"ondemand.resx-ondemand"],1668))}}},handlerType:Ss}),Ts=n(551),Ns=n(312),Cs=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="ShowSelection";r._urlDataSource=r.resources.consume(V.B);r._isSelectionModal=r.resources.consume(Ns.t);r._itemSelectionHelper=new(r.child(Qt.e))({allowMultiSelect:!0,canFallback:!1});return r}t.prototype.onIsAvailable=function(){return(this._itemSelectionHelper.selection().length>0||this._isSelectionModal())&&this._urlDataSource.getPageType()!==ae.e.TextFileEditor};t.prototype.onExecute=function(e,t){this._itemSelectionHelper.clearSelection();this._isSelectionModal(!1);return S.n.resolve({resultType:g.t.Success})};return t})(Xt.e),ks=n(206),Ls=n(309),As=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._pageLayoutType=n.pageLayoutType;r.layoutType=r._getLayoutType();r._debouncer=r.scope.attach(new Ls.e);return r}t.prototype._getLayoutType=function(){var e=this,t=this.observables,n=t.create("");t.backgroundCompute(function(){var t=e._pageLayoutType(),r=ks.o[t];e._debouncer.debounce(r?r().then(function(e){return e.tagName}):S.n.wrap("")).then(function(e){n(e)})});return n};t.dependencies=Object(i.__assign)(Object(i.__assign)({},ne.n.dependencies),{pageLayoutType:li.n.layoutType});return t})(ne.n),Os=new Te.t({name:"".concat("ToggleListLayoutHelper",".layoutTypeResolver"),factory:new X.n(As)}),Ms=(new Te.t({name:"".concat("ToggleListLayoutHelper",".resolvedLayoutType"),factory:{dependencies:{layoutTypeResolver:Os},create:function(e){return{instance:e.layoutTypeResolver.layoutType}}}}),(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.pageLayoutType=n.resources.consume(li.n.layoutType);return n}t.prototype.changeLayout=function(e){var t=this;return(0,ks.o[e])().then(function(n){t.pageLayoutType(n.tagName);return S.n.resolve({resultType:g.t.Success,extraData:{layout:e}})})};return t})(ne.n)),_s=n(57),Ds=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="ToggleListLayout";n._layoutType=ks.c(t.layoutType);n._shouldClearContextualFilter=void 0===t.clearContextualFilter||t.clearContextualFilter;n._currentItem=n.resources.consume(_r.i);n._viewParams=n.resources.consume(_r.S);n._actionMap=n.resources.consume(_r.e);n._urlDataSource=n.resources.consume(V.B);n._helper=new(n.managed(Ms));return n}t.prototype.onIsAvailable=function(){var e=this.resources.consume(Qn.t),t=this._currentItem(),n=t&&t.queryType,r=t.key!==this._urlDataSource.getRootItemKey(Z.e.SharedWithMe)&&n!==Z.e.DocsInCommon;e||(r=r&&n!==Z.e.AllMyPhotos);var i=this._urlDataSource.getKeyParams(t.key),s=t.virtualItemType!==_s.e.Album;this._layoutType===ks.u&&(s=n===Z.e.Files);e&&n===Z.e.AllMyPhotos&&(s=!("allmyphotos"!==i.qt||i.tagFilter||i.locationFilter||i.onThisDay||i.onThisMonth||i.lastWeekPreviousYears));"allmyphotos"===i.qt&&(s=this._layoutType!==ks.i&&this._layoutType!==ks.t);return r&&s};t.prototype.onExecute=function(e,t){var n,r=this;if(this._shouldClearContextualFilter){var i=mi.e({},this._viewParams.peek());delete i.ft;n=new(this.managed(this._actionMap.NavigationAction))({url:"#".concat(_.n(i))}).execute(e)}else n=S.n.wrap();return n.then(function(){return r._helper.changeLayout(r._layoutType)},function(){return r._helper.changeLayout(r._layoutType)})};t.prototype.onIsToggled=function(){return this._layoutType===this._helper.pageLayoutType()};return t})(Xt.e),Ps=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="ViewOriginal";n._itemCommandHelper=new(n.managed(en.e));n._selectionHelper=new(n.child(Qt.e))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item});n._url=n.observables.pureCompute(function(){var e=n._selectionHelper.firstItem(),t=e&&e.photo&&e.photo.originalUrl;return t&&t.replace(/#/g,"%23")});n._navigationAction=new(n.managed(fi.e))({url:n._url,target:"_blank"});return n}t.prototype.onIsAvailable=function(){var e=this._selectionHelper.firstItem();return!!e&&!!this._url()&&this._itemCommandHelper.isCommandSupported(e,dn)};t.prototype.onExecute=function(e,t){return this._url.peek()?this._navigationAction.execute(e):S.n.reject({})};return t})(Xt.e),Hs=n(209),Bs=n(451),js=n(521),Fs=n(435),Is=n(452),qs=n(280),Rs=n(498);var Us=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.logStartEnd=!0;n.name="Upload."+Hs.e[n.uploadProcessorType];n._itemRedeemer=n.resources.consume(Zt.e);return n}t.prototype.onIsAvailable=function(){if(!this._isPlatformSupported())return!1;var t=this.item();return e.prototype.onIsAvailable.call(this)&&t.type===Gt.e.Folder};t.prototype.onExecute=function(t,n){var r=this,i=this.item.peek();return this._itemRedeemer.redeemItem(i,this).then(function(){return e.prototype.onExecute.call(r,t,n)})};t.prototype._isPlatformSupported=function(){var e=!1,t=this.platform.isIPad&&this.platform.browserMajor<6;if(this.platform.isWinAppWipEnabled)return!1;if(!t)switch(this.uploadProcessorType){case Hs.e.Html5file:e=this.platform.isHtml5FileUploadSupported;break;case Hs.e.Folder:e=this.platform.isFolderUploadSupported}return e};return t})((function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="Upload";n.platform=n.resources.consume(zn.e);n.uploadProcessorType=t.uploadProcessorType;n._resetInputElement();n.addDisposable({dispose:function(){if(n._inputElement){document.body.removeChild(n._inputElement);n._inputElement=void 0}}});n.itemCommandHelper=n.resources.consume(en.t);n.skipInvalidation=!1;n._currentItemSet=n.resources.consume(_r.s.optional);n._createUploadObserver=t.createUploadObserver;return n}t.prototype.onExecute=function(e,t){this.resources.consume(Ue.e).logData({name:"Upload.TopMenu.Click",isIntentional:!0});var n=new y.e;window.sessionStorage.getItem("_isRunningTABTest")||this._clickHiddenInput(n);return n.getPromise()};t.prototype.onIsAvailable=function(){var e=!1,t=this.item();if(!this.itemCommandHelper.isCommandSupported(t,ur))return!1;switch(this.uploadProcessorType){case Hs.e.Html5file:e=this.platform.isHtml5FileUploadSupported;break;case Hs.e.Folder:e=this.platform.isFolderUploadSupported}return e&&!t.isPlaceholder&&t.queryType===Z.e.Files};t.prototype._resetInputElement=function(){var e=this;this._inputElement&&document.body.removeChild(this._inputElement);var t=document.createElement("input");this._inputElement=t;t.style.display="none";t.type="file";var n="commandFileInput";if(this.uploadProcessorType===Hs.e.Folder){n="commandFolderInput";t.webkitdirectory=!0}t.className=n;t.multiple=!0;t.onchange=function(n){e._uploadFiles(t).done(function(){e._resetInputElement()})};document.body.appendChild(t)};t.prototype._clickHiddenInput=function(e){var t=this,n=this._inputElement;n.onchange=function(r){t._uploadFiles(n).then(function(t){e.complete(t)},function(t){e.error(t)}).then(function(){t._resetInputElement()})};n.click()};t.prototype._uploadFiles=function(e){var t=this,n=Array.prototype.slice.call(e&&(e["test-files"]||e.files)||[]);if(n){var r=this._createUploadObserver&&this._createUploadObserver(),i=de.e.isActivated("5C4BC63E-54D5-4F24-8333-E6905633B445","9/4/2020","Wait for KO item to resolve before upload")?void 0:r&&r.resolveParentItem();return S.n.resolve(i).then(function(){return S.n.resolve(t.resources.consumeAsync(Bs.e))}).then(function(e){var i=new e({files:n,parentItem:t.item.peek(),wasDragAndDropped:!1,type:t.uploadProcessorType,itemSet:t._currentItemSet&&t._currentItemSet.peek(),skipInvalidation:t.skipInvalidation,isTemplate:t.isTemplate,onItemUploaded:function(e){r&&r.onItemUploaded(e);t.resources.consume(js.e)(e)}});i.start();return i.wait()}).then(function(){r&&r.onUploadCompleted();(function(e,t,n){if(e.isExposed(V.a)){var r=e.consume(Fs.i.optional),i=!1;if(r&&r.isSPO){var s=Number(r.webTemplate)===Is.t.mySite;i=!!r.listBaseTemplate&&Object(qs.s)(r.listBaseTemplate);if(s&&!i)return}var o=i?"FloodgateForLists.":"FloodgateForSPO.";try{var u=e.consume(V.a),a=n?t:i?Rs.e:"SPListAction";u.recordUserAction(a,t)}catch(e){ve.e.logData({name:o+"error"+t,extraData:{error:e}})}}})(t.resources,"uploadAction");return{resultType:g.t.Success}},function(e){r&&r.onUploadCompleted();return S.n.reject(e)})}return S.n.wrap({resultType:g.t.ExpectedFailure})};return t})(In.e)),zs={scenario:"updateDescription"},Ws=(function(e){Object(i.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._itemCommandHelper=new(t.managed(en.e));return t}t.prototype.onIsAvailable=function(){var t=this.item();return e.prototype.onIsAvailable.call(this)&&this._itemCommandHelper.isCommandSupported(t,cn)&&!(t.vault&&t.vault.root&&t.vault.isLocked)};return t})((function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="UpdateCaption";n.caption=t.caption;return n}t.prototype.onExecute=function(e,t){var n,r,i,s,o;if(!Object(le.isFeatureEnabled)(le.UseVroomUpdateCaption)){return this.resources.consume(tn.resourceKey).updateItemProperty({item:this.item(),propertyName:"caption",propertyValue:this.caption(),overrideLock:!0,qosPostfix:"caption"}).then(function(){return{resultType:g.t.Success}})}var u=this.resources.consume(re.e),a=((n={}).description=this.caption(),n),f=this.item();if(!(null===(r=f.graph)||void 0===r?void 0:r.itemId))return S.n.wrapError(new Error("invalid itemId"));var l="".concat(Object(Ce.o)({apiVersion:"v2.1",driveId:(null===(i=f.graph)||void 0===i?void 0:i.driveId)||"me"}),"/drives/").concat((null===(s=f.graph)||void 0===s?void 0:s.driveId)||"me","/items/").concat(null===(o=f.graph)||void 0===o?void 0:o.itemId);u.send({apiName:"updateItem_".concat("description").concat(Object(It.e)(O.j)?".migratedUser":""),path:l,useAuthorizationHeaders:!0,requestType:"PATCH",postData:JSON.stringify(a),headers:zs}).then(function(){return{resultType:g.t.Success}})};t.prototype.onIsAvailable=function(){if(Object(le.isFeatureEnabled)(le.EnableSamsungMotionPhotoVideos)){var e=this.item();return!(!!e&&!!e.photo&&!!e.photo.isSamsungMotionPhoto)}return!0};return t})(In.e));Object(kn.e)([{rawString:"html[dir=ltr] .od-sharesurvey-preview{float:left}html[dir=rtl] .od-sharesurvey-preview{float:right}[dir=ltr] .od-sharesurvey-preview{margin-right:10px}[dir=rtl] .od-sharesurvey-preview{margin-left:10px}.od-sharesurvey-details{max-width:350px}html[dir=ltr] .od-sharesurvey-details{float:left}html[dir=rtl] .od-sharesurvey-details{float:right}.od-sharesurvey-create{margin-top:10px}.od-sharesurvey-textbox{padding:1px 5px 2px 10px;margin:10px 0;width:100%;box-sizing:border-box;text-overflow:ellipsis}html[dir=rtl] .od-sharesurvey-textbox{padding:1px 10px 2px 5px}.od-sharesurvey-error{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}"}]);var Xs=n(448),Vs=n(332),$s=n(200),Js=n(325),Ks=n(443),Qs=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.loadingSpinnerTagName=Ks.e.tagName;n._item=t.item;n.previewSrc=t.previewSrc;n.isLoading=_n.observable(!0);n.sharingLink=_n.observable(null);n.hasError=_n.observable(!1);n.instructionsText=$s.i;n.createText=$s.e;n.removeText=$s.s;n.loadingText=$s.r;n.errorText=$s.n;n._sharingProvider=n.resources.consume(Xs.resourceKey);n._getSharingInfo();n.addBindingHandlers({selectOnFocus:Vs.e});return n}t.prototype.onCreateClicked=function(){var e=this;this.isLoading(!0);var t={type:Js.e.Form,role:L.e.Submitter,create:!0};this._sharingProvider.manageSharingLinks([this._item],t).done(function(){e._getSharingInfo()},function(t){e.isLoading(!1);e.hasError(!0)})};t.prototype.onRemoveClicked=function(){var e=this;this.isLoading(!0);var t={id:this.sharingLink().id,type:Js.e.Form,role:L.e.None,create:!1};this._sharingProvider.manageSharingLinks([this._item],t).done(function(){e.isLoading(!1);e.sharingLink(null)},function(t){e.isLoading(!1);e.hasError(!0)})};t.prototype._getSharingInfo=function(){var e=this;this._sharingProvider.getSharingData(this._item).getLinks().then(function(t){e.isLoading(!1);if(t)for(var n=0,r=t;n<r.length;n++){var i=r[n];i.type===Js.e.Form&&e.sharingLink(i)}})};return t})(An.e),Gs=Pn.e({tagName:"od-share-survey",template:'<div class="ShareSurvey"><div class="od-sharesurvey-preview"><img data-bind="attr:{src:previewSrc}"></div><div class="od-sharesurvey-details">\x3c!--ko if:isLoading--\x3e<span class="ms-font-m" data-bind="component:{name:loadingSpinnerTagName,params:{loadingText:loadingText}}"></span>\x3c!--/ko--\x3e\x3c!--ko if:!isLoading()--\x3e<span class="od-sharesurvey-instructions" data-bind="text:instructionsText"></span>\x3c!--ko if:!sharingLink()--\x3e<button class="od-Button od-sharesurvey-create" data-bind="click:onCreateClicked"><span class="od-Button-label" data-bind="text:createText"></span></button>\x3c!--/ko--\x3e\x3c!--ko if:sharingLink()--\x3e<input type="text" class="od-sharesurvey-textbox" readonly data-bind="attr:{value:sharingLink().url},selectOnFocus:{isPermanent:true}"><br><button class="od-Button" data-bind="click:onRemoveClicked"><span class="od-Button-label" data-bind="text:removeText"></span></button>\x3c!--/ko--\x3e<br>\x3c!--ko if:hasError()--\x3e<span class="od-sharesurvey-error" data-bind="text:errorText"></span>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div><div class="ms-clearfix"></div></div>',viewModel:Qs,synchronous:!0}),Ys=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="Survey";r._actionType=t.actionType;r._navigation=r.resources.consume(W.e);r._dialogProvider=r.resources.consume(Bn.e);r._itemCommandHelper=new(r.managed(en.e));r._urlDataSource=r.resources.consume($.n);r._itemSelectionHelper=new(r.child(Qt.e))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this,t=this._getCommandKey();return this._itemSelectionHelper.filterItems(function(n){return e._itemCommandHelper.isCommandSupported(n,t)})};t.prototype.onExecute=function(e,t){return Object(i.__awaiter)(this,void 0,S.n,function(){var t,n,r,s,o,u,a;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:if(!(t=i.sent()))return[2,S.n.resolve({resultCode:"EmptySelection",resultType:g.t.Failure})];if(1===this._actionType)return[2,this.showShareDialog(t)];n=this._navigation;r=this._urlDataSource.getAuthKeyParamValue();s=this._urlDataSource.getTicketParamValue();o=n.viewParams.qt;u=3===this._actionType?3:2;a=Ar.o("/edit.aspx?cid={0}&resid={1}&wacqt={2}&formAction={3}&app=Excel",K.e.viewerId,t.id,o||"",u);r?a+="&authKey="+r:s&&(a+="&ticket="+s);return[2,new(this.managed(fi.e))({url:a,target:"_blank"}).execute(e)]}})})};t.prototype.showShareDialog=function(e){var t=Ar.o($s.o,e.name);return this._dialogProvider.requestDialog({title:t,size:"Large",component:{name:Gs.tagName,params:{item:e,previewSrc:FilesConfig.imgBaseUrl+"images/embed_form.png"}},actions:[{name:$s.t,execute:function(){return S.n.resolve(2)},isAvailable:this.observables.create(!0),isVisible:this.observables.create(!0),icon:new Nn.e("Cancel")}]}).wait().then(function(){return{resultType:g.t.Success}})};t.prototype._getCommandKey=function(){switch(this._actionType){case 1:return or.a;case 2:return or.f;case 3:return or.s}};return t})(Xt.e),Zs=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="AddToSharedList";r._itemReedemer=r.resources.consume(Zt.e);r._itemCommandHelper=new(r.managed(en.e));r._itemSelectionHelper=new(r.child(Qt.e))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&this._itemCommandHelper.isCommandSupported(e,Or.t)};t.prototype.onExecute=function(e,t){return Object(i.__awaiter)(this,void 0,S.n,function(){var e,t=this;return Object(i.__generator)(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:return(e=n.sent())?[2,this._itemReedemer.redeemItem(e,this,!0).then(function(){t.resources.consume(tn.resourceKey).invalidateItem(e.key,{triggerFetch:!0});return{resultType:g.t.Success}})]:[2,S.n.resolve({resultCode:"EmptySelection",resultType:g.t.Failure})]}})})};return t})(Xt.e),eo=Me.e.isActivated("C092CAF4-C574-4ADB-9783-65C549F8FBFC","11/22/2022","Only show the remove from shared list command in the Shared with me view"),to=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="RemoveFromSharedList";n._itemCommandHelper=new(n.managed(en.e));n._currentItem=Object(ce.qo)(ce.J)?n.selectionHelper.currentItem:n.resources.consume(_r.i);n._urlDataSource=n.resources.consume(K.t);return n}t.prototype.getExecutorPath=function(){return"./RemoveFromSharedListExecutor"};t.prototype.getModuleFactory=function(){return function(){return S.n.resolve(n.ee([26,"ondemand.resx-ondemand"],1654))}};t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!0}};t.prototype.getExecutorParameters=function(){return{currentItem:this._currentItem.peek(),selectionHelper:this.selectionHelper}};t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return(eo||this._urlDataSource.isCurrentQuerySharedWithMe())&&this._itemCommandHelper.isCommandSupported(e,Or.i)};return t})(an.e),no=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="AddToBundleAction";return n}t.prototype.getExecutorPath=function(){return"./AddToBundleExecutor"};t.prototype.getModuleFactory=function(){return function(){return S.n.resolve(n.ee([9,"ondemand.resx-ondemand"],1606))}};t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper}};t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem(),t=e&&e.ownerId&&e.ownerId.toUpperCase(),n=K.e.viewerId&&K.e.viewerId.toUpperCase();return e&&e.isBundle&&t===n};return t})(an.e),ro=n(522),io=Me.t.isActivated("7B5F7746-6573-454C-B237-500C813D8D50","4/19/2022","Fix the remove from bundle availability logic in ItemsScope"),so=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="RemoveFromBundleAction";r._itemSelectionHelper=new(r.child(Qt.e))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();if(Object(ce.qo)(ce.eo)){var t=this._itemSelectionHelper.currentItem();if(io)return!!e&&!!(null==t?void 0:t.isBundle)&&!t.isAlbum&&Object(O._)(t.ownerId);var n=t&&t.ownerId&&t.ownerId.toUpperCase(),r=O.j.toUpperCase(),i=(null==e?void 0:e.parentKey)&&Object(O.m)(e.parentKey),s=t.id&&i&&i.id===t.id;return!(!e||!t.isBundle||!s||n!==r)}return!!(e&&e.UNSAFE_parent&&e.UNSAFE_parent.isBundle)&&e.UNSAFE_parent.ownerId===K.e.viewerId};t.prototype.onExecute=function(e,t){return Object(i.__awaiter)(this,void 0,S.n,function(){var e,t=this;return Object(i.__generator)(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveSelection()];case 1:return(e=n.sent()).length?[2,this.resources.consumeAsync(ro.e).then(function(n){var r=new n({items:e.map(function(e){return e.id}),bundleAction:1,item:e[0].UNSAFE_parent});t.trackPromise(r.start());return r.wait()}).then(function(){return{resultType:g.t.Success}})]:[2,S.n.resolve({resultCode:"EmptySelection",resultType:g.t.Failure})]}})})};return t})(Xt.e),oo=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="ReportAbuse";n._navigation=n.resources.consume(W.e);return n}t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!1}};t.prototype.getExecutorPath=function(){return"./ReportAbuseExecutor"};t.prototype.getModuleFactory=function(){return function(){return S.n.resolve(n.ee([28,"ondemand.resx-ondemand"],1639))}};t.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper}};t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return this.itemCommandHelper.isCommandSupported(e,Or.s)||Object(le.isFeatureEnabled)(le.EnableAnonReportConcernCommand)&&!K.e.viewerId&&e&&!e.itemStatus&&(!e.folder||e.type===Gt.e.OneNote)};t.prototype.onExecute=function(t,n){if(Object(le.isFeatureEnabled)(le.EnableAnonReportConcernCommand)&&!K.e.viewerId){this._navigation.navigateTo({url:"https://www.microsoft.com/concern/onedrive",frameId:"_blank"});return S.n.wrap({resultType:g.t.Success})}return e.prototype.onExecute.call(this,t,n)};return t})(an.e),uo=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="RemoveMountPoint";r._urlDataSource=r.resources.consume(V.B);r._dialogProvider=r.resources.consume(Bn.e);r._itemProvider=r.resources.consume(tn.resourceKey);r._navigation=r.resources.consume(W.e);r._itemCommandHelper=new(r.managed(en.e));r._itemSelectionHelper=new(r.child(Qt.e))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&this._itemCommandHelper.isCommandSupported(e,Or.r)};t.prototype.onExecute=function(e,t){var n=this,r=this._itemSelectionHelper.currentItem.peek(),i=this._itemProvider,s=this._navigation,o=this._dialogProvider;return this._itemSelectionHelper.resolveFirst().then(function(e){if(!e)return{resultType:g.t.ExpectedFailure};var t=e.UNSAFE_parent,u=Ar.o(Un.RemoveMountPointDetails2,e.name);return o.requestDialog({title:Un.RemoveMountPointTitle,component:{name:Rr.e.tagName,params:{text:u}},actions:[{name:Un.RemoveMountPoint,execute:function(){return S.n.resolve(2)},isAvailable:n.observables.create(!0),icon:new Nn.e("Cancel"),isDefault:!0}]}).wait().then(function(){n._itemSelectionHelper.clearSelection();return i.removeMountPoint({parentKey:r.key,item:e}).then(function(){var e,r=t?n._urlDataSource.getDefaultClickUrl(t):"";Object(ce.qo)(ce.eo)&&(e=n._urlDataSource.getRootUrl());var i=r||e;s.navigateTo(i);return{resultType:g.t.Success}})})})};return t})(Xt.e),ao=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="RequestReview";n._itemCommandHelper=new(n.managed(en.e));return n}t.prototype.getExecutorPath=function(){return"./RequestReviewExecutor"};t.prototype.getModuleFactory=function(){return function(){return S.n.resolve(n.ee([29,"ondemand.resx-ondemand"],1661))}};t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!Object(le.isFeatureEnabled)(le.UseVroomApiForRequestReview),canFallback:!1}};t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper}};t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return this._itemCommandHelper.isCommandSupported(e,Or.o)};return t})(an.e),fo=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="ViewInFolderAction";r._navigation=r.resources.consume(W.e);r._urlDataSource=r.resources.consume($.n);r._itemReedemer=r.resources.consume(Zt.e);r._itemSelectionHelper=new(r.child(Qt.e))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem(),t=e&&e.parentKey&&Object(Ie.e)(e.queryType),n=this._urlDataSource.isCurrentQuery(Z.e.Photos);return!!e&&(t||n&&e.type===Gt.e.Media)&&K.e.areCidsEqual(e.ownerId,K.e.viewerId)};t.prototype.onExecute=function(e,t){return Object(i.__awaiter)(this,void 0,S.n,function(){var e,t=this;return Object(i.__generator)(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:return(e=n.sent())?[2,this._itemReedemer.redeemItem(e,this).then(function(){t._navigation.navigateTo({url:t._urlDataSource.getItemUrl(e.parentKey,{page:ae.e.Files})});return S.n.resolve({resultType:g.t.Success})})]:[2,S.n.resolve({resultCode:"EmptySelection",resultType:g.t.Failure})]}})})};return t})(Xt.e),lo=n(413),co=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="SignOut";n.url=t.url;n.target=t.target||"_top";n._navigation=n.resources.consume(W.e);n._sessionProvider=n.resources.consume(J.e);var r=lo.e+n._sessionProvider.getIdentity().id;n._dataStore=new me.e(r,ge.e.local);return n}t.prototype.onExecute=function(e,t){this._sessionProvider.signOut();try{delete localStorage["onedrive.autoredirect"]}catch(e){}this._dataStore.remove(lo.t,ge.e.session);this.url&&"#"!==this.url&&this._navigation.navigateTo({url:this.url,frameId:this.target});return S.n.wrap({resultType:g.t.Success})};t.prototype.onIsAvailable=function(){return!0};return t})(Xt.e),ho=n(414),po=(function(e){Object(i.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t.name="ToggleDebugWindow";return t}t.prototype.onIsAvailable=function(){return!0};t.prototype.onExecute=function(e,t){if(ho.e.isInitialized()){var n=this.resources.consume(_r.c);n(!n())}else ho.e.init(this.resources);return S.n.wrap({resultType:g.t.Success})};return t})(Xt.e),vo=n(467),mo=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="RemoveFromAlbum";r._itemCommandHelper=new(r.managed(en.e));r._itemSelectionHelper=new(r.child(Qt.e))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.currentItem(),t=this._itemSelectionHelper.firstItem();return!!e.isAlbum&&!!t&&this._itemCommandHelper.isCommandSupported(t,yn)};t.prototype.onExecute=function(e,t){var n=this,r=this._itemSelectionHelper.currentItem();return this._itemSelectionHelper.resolveSelection().then(function(e){n._itemSelectionHelper.clearSelection();var t={album:r,items:e};return S.n.resolve(n.resources.consumeAsync(vo.e)).then(function(e){return e.removeFromAlbum(t)}).then(function(){n._refreshItemsScopeRemovedItems(e);return{resultType:g.t.Success}},function(e){n._refreshItemsScopeCurrentItemSet();return{resultType:g.t.Failure}})})};t.prototype._refreshItemsScopeRemovedItems=function(e){this.resources.consume(Qn.e)&&this.resources.consumeAsync(V.v).then(function(t){for(var n=0,r=e;n<r.length;n++){var i=r[n];i.id&&t.invalidateItems(i.key)}})};t.prototype._refreshItemsScopeCurrentItemSet=function(){this.resources.consume(Qn.e)&&this.resources.consumeAsync(V.v).then(function(e){e.invalidateCurrentItemSet()})};return t})(Xt.e),go=n(45),yo=!de.e.isActivated("B8D2D2A7-E86C-4603-A180-25887F432C8C","",""),bo=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=t.item;n._itemSelectionHelper=new(n.child(Qt.e))({overrideItem:r,allowMultiSelect:!1,canFallback:!0});n._itemCommandHelper=new(n.managed(en.e));n.state=n.createPureComputed(n._computeState);return n}t.prototype.getParams=function(){return this._itemSelectionHelper.resolveFirst().then(function(e){return{item:e}})};t.prototype._computeState=function(){var e=this._itemSelectionHelper.firstItem();return{isAvailable:!!e&&!!go.e.hcid&&e.virtualItemType===_s.e.Album&&(!yo||e.ownerId&&Object(O._)(e.ownerId))&&this._itemCommandHelper.isCommandSupported(e,bn)}};return t})(ne.n),wo=Object(Kr.e)({name:"AddPhotosToAlbum",source:{moduleDefinition:{path:"./AddPhotosToAlbumExecutor",getModule:function(){return S.n.resolve(n.ee([7,"ondemand.resx-ondemand"],1679))}}},handlerType:bo}),Eo=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._itemSelectionHelper=new(n.child(Qt.e))({allowMultiSelect:!1,canFallback:!0});n.state=n.createPureComputed(n._computeState);return n}t.prototype._computeState=function(){var e=this._itemSelectionHelper.firstItem();return{isAvailable:e&&e.virtualItemType===_s.e.AlbumRoot}};return t})(ne.n),So=Object(Kr.e)({name:"CreateAlbum",source:{moduleDefinition:{path:"./CreateAlbumExecutor",getModule:function(){return S.n.resolve(n.ee([13,"ondemand.resx-ondemand"],1655))}}},handlerType:Eo}),xo=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="SelectAction";var i=n.itemSelectionHelperType,s=void 0===i?r.resources.consume(Qt.e):i,o=n.actionMap,u=void 0===o?r.resources.consume(_r.e):o;r._item=t.item;r._selectItems=t.selectItems;r._itemSelectionHelper=new s({overrideItem:t.item,allowMultiSelect:!0,canFallback:!1});t.showProperties&&(r._showPropertiesAction=new(r.managed(u.ShowPropertiesAction))({}));return r}t.prototype.onIsAvailable=function(){var e=this.observables.unwrap(this._item);return!!e&&!e.isPlaceholder};t.prototype.onExecute=function(e,t){return Object(i.__awaiter)(this,void 0,S.n,function(){var t,n=this;return Object(i.__generator)(this,function(r){switch(r.label){case 0:if(this._selectItems){t=this._selectItems.map(function(e){return n.observables.peekUnwrap(e)});this._itemSelectionHelper.selectItems(t)}else this._item&&this._itemSelectionHelper.selectItems([this.observables.peekUnwrap(this._item)]);return this._showPropertiesAction?[4,this._showPropertiesAction.execute(e)]:[3,2];case 1:r.sent();r.label=2;case 2:return[2,{resultType:g.t.Success}]}})})};return t})(Xt.e),To=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="SelectAll";r._selectionModel=r.resources.consume(_r.g);return r}t.prototype.onIsAvailable=function(){return 0===this._selectionModel.mode};t.prototype.onExecute=function(e,t){this._selectionModel.selectAll();return S.n.resolve({resultType:g.t.Success})};return t})(Xt.e),No=n(89),Co=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="FilterSearch";n._filter=t.filter;n._urlDataSource=n.resources.consume(V.B);n._viewParams=n.resources.consume(_r.S);n._showCurrentView=t.showCurrentView;n._url=n.createPureComputed(n._computeUrl);n._supportsSearchFiltering=n._getSupportsSearchFiltering();n._navigationAction=new(n.managed(fi.e))({url:n._url,forceNavigation:!0});return n}t.prototype.onExecute=function(e,t){return this._navigationAction.execute(e)};t.prototype.onIsAvailable=function(){this._viewParams();return this._supportsSearchFiltering()&&!this._urlDataSource.isSearchPassThrough()&&Object(Ie.e)(this._urlDataSource.getQueryType())&&this._navigationAction.isAvailable()};t.prototype.onIsToggled=function(){this._viewParams();var e=Object(Ie.e)(this._urlDataSource.getQueryType())&&this._urlDataSource.isSearchFilterApplied(this._filter)&&!this._urlDataSource.isSearchPassThrough();e&&this._showCurrentView(e&&this._filter!==No.t.all);return e};t.prototype._computeUrl=function(){this._viewParams();return this._urlDataSource.getSearchFilterQueryUrl(this._filter)};t.prototype._getSupportsSearchFiltering=function(){var e=this.createObservable(!1);S.n.resolve(this.resources.consumeAsync(V.C)).done(function(t){e(t.getCapabilities().supportsSearchFiltering)});return e};return t})(Xt.e),ko=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="RemoveTagFromItem";r._itemSelectionHelper=new(r.child(Qt.e))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item});r._viewParams=r.resources.consume(_r.S);return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.currentItem(),t=this._itemSelectionHelper.firstItem();return e.virtualItemType===_s.e.Tag&&!!t&&!!e.tags&&e.tags.length>0};t.prototype.onExecute=function(e,t){var n=this,r=this._itemSelectionHelper.currentItem(),i=r.tags,s=this.resources.consume(G.p),o=this.resources.consume(G.u).getAllPhotosSettings().peek();return this._itemSelectionHelper.resolveSelection().then(function(e){var t,u=e[0],a=u&&u.tags;if(a&&i)for(var f=0,l=a;f<l.length;f++){var c=l[f];if(c.tag===i[0].tag){t=c;break}}n._itemSelectionHelper.clearSelection();if(!t)return S.n.resolve({resultType:g.t.Failure});var h=!1,p=n._viewParams.peek();n.resources.consume(Qn.t)&&void 0===p.tagFilter&&(h=!0);return s.updateTags({items:e,tagsToAdd:null,tagsToDelete:[t],parentKey:r.key,rootItemId:o.rootId,skipInvalidate:h}).then(function(){return{resultType:g.t.Success}})})};return t})(Xt.e),Lo=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="SetAlbumCoverPhoto";n._currentItem=Object(ce.qo)(ce.J)?n.selectionHelper.currentItem:n.resources.consume(_r.i);n._itemCommandHelper=new(n.managed(en.e));return n}t.prototype.getExecutorPath=function(){return"./SetAlbumCoverPhotoExecutor"};t.prototype.getModuleFactory=function(){return function(){return S.n.resolve(n.ee([35],1701))}};t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1}};t.prototype.getExecutorParameters=function(){return{itemSelectionHelper:this.selectionHelper,currentItem:this._currentItem.peek()}};t.prototype.onIsAvailable=function(){var e=this._currentItem(),t=this.selectionHelper.firstItem();return!!e&&e.virtualItemType===_s.e.Album&&this._itemCommandHelper.isCommandSupported(e,Nr.r)&&!!t&&!(!t.photo&&!t.video)};return t})(an.e),Ao=n(96),Oo=n(316),Mo=(function(e){Object(i.__extends)(t,e);function t(t){var r=e.call(this,t)||this;r.name="SetPhotosRoot";r._rootId=t.rootId;r._photoProvider=r.resources.consume(G.u);r._itemProvider=r.resources.consume(tn.resourceKey);r._viewParams=r.resources.consume(_r.S);r._urlDataSource=r.resources.consume($.n);r._executorLoader=new(r.managed(ei.e))({path:"./SetPhotosRootExecutor",getModule:function(){return S.n.resolve(n.ee([36],1607))},getExecutorParams:function(){return{photoProvider:r._photoProvider,itemProvider:r._itemProvider,urlDataSource:r._urlDataSource,rootId:r._rootId}}});return r}t.prototype.onIsToggled=function(){var e=!1,t=this._viewParams().id;if("ROOT"===this._rootId)e="root"===t;else if("SAMSUNGFOLDER"===this._rootId){e="samsungGallery"===this._photoProvider.getAllPhotosSettings()().folderName}else if("ALLPHOTOSFOLDER"===this._rootId){e="photos"===this._photoProvider.getAllPhotosSettings()().folderName}return e};t.prototype.onIsAvailable=function(){var e=this._viewParams();switch(this._urlDataSource.getPhotoType(e)){case Ao.e.AllMyPhotos:case Ao.e.onThisDay:case Ao.e.onThisMonth:case Ao.e.lastWeekPreviousYears:return!0;default:return!1}};t.prototype.onExecute=function(e){return this._executorLoader.execute(e)};t.prototype.onCreateQosEvent=function(e){return new Oo.e({name:this.name,pageType:this._urlDataSource&&ae.e[this._urlDataSource.getPageType()]||"",queryType:this._urlDataSource&&Z.e[this._urlDataSource.getQueryType()]||"",logStartEnd:this.logStartEnd,extraData:{filter:this._rootId}})};return t})(Xt.e),_o=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="FilterSearchByDateAction";n._filter=t.filter;n._urlDataSource=n.resources.consume(V.B);n._viewParams=n.resources.consume(_r.S);n._showCurrentView=t.showCurrentView;n._url=n.createPureComputed(n._computeUrl);n._supportsSearchFiltering=n._getSupportsSearchFiltering();n._navigationAction=new(n.managed(fi.e))({url:n._url,forceNavigation:!0});return n}t.prototype.onExecute=function(e,t){return this._navigationAction.execute(e)};t.prototype.onIsAvailable=function(){this._viewParams();return this._supportsSearchFiltering()&&!this._urlDataSource.isSearchPassThrough()&&Object(Ie.e)(this._urlDataSource.getQueryType())&&this._navigationAction.isAvailable()};t.prototype.onIsToggled=function(){this._viewParams();var e=this._urlDataSource.isSearchByDateFilterApplied(this._filter)&&Object(Ie.e)(this._urlDataSource.getQueryType())&&!this._urlDataSource.isSearchPassThrough();e&&this._showCurrentView(e&&this._filter!==No.e.anyDate);return e};t.prototype._computeUrl=function(){this._viewParams();return this._urlDataSource.getSearchByDateFilterQueryUrl(this._filter)};t.prototype._getSupportsSearchFiltering=function(){var e=this.createObservable(!1);S.n.resolve(this.resources.consumeAsync(V.C)).done(function(t){e(t.getCapabilities().supportsSearchFiltering)});return e};return t})(Xt.e),Do=n(344),Po=n(253),Ho=!Me.e.isActivated("F821B97F-2856-4BCD-A56C-3D1866606118","05/09/2022",'Enable "copy to" action when accessing a share link'),Bo=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._isMove=t.isMove;n.name="LaunchMoveCopyPanel";n._currentItem=Me.e.isActivated("CA6B3004-C196-4F99-90F6-72ACA9F6971B","10/21/2021","Get Current Item from ItemSelectionHelper")?n.resources.consume(_r.i):n.selectionHelper.currentItem;n._urlDataSource=n.resources.consume($.n);n._capabilities=n.resources.consume(Do.e);return n}t.prototype.getExecutorPath=function(){return"../LaunchMoveCopyPanelExecutor"};t.prototype.getModuleFactory=function(){return function(){return S.n.resolve(n.ee([21],1702))}};t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!0}};t.prototype.getExecutorParameters=function(){return{isMove:this._isMove,actionName:this.name,selectionHelper:this.selectionHelper}};t.prototype.onIsAvailable=function(){var e=this;if(!this._capabilities.supportsMoveCopy)return!1;var t=this._currentItem();if(this.selectionHelper.selection().length>1&&t.queryType===Z.e.SharedWithMe&&t.isRootFolder)return!1;if(!Ho&&!this._isMove&&this._urlDataSource.getAuthKeyParamValue()&&this.resources.consume(Po.e))return!1;var n=this._isMove?Nr.i:Nr.e;return this._urlDataSource.getPageType()!==ae.e.TextFileEditor&&this.selectionHelper.filterItems(function(t){return e.itemCommandHelper.isCommandSupported(t,n)})};return t})(an.e),jo=n(222),Fo=n(484),Io=new Te.t({name:"DeeplinkCommentId.key",factory:{dependencies:{},create:function(){return{instance:_n.observable({})}}}}),qo=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="AutoExecute";n._focusItem=t.focusItem;n._actionMap=n.resources.consume(_r.e);n._navigation=n.resources.consume(W.e);n._urlDataSource=n.resources.consume($.n);n._viewParams=n.resources.consume(_r.S);n._originalViewParams=Object(i.__assign)({},n._viewParams.peek());n._actionType=n.createPureComputed(n._computeAutoActionType,{deferEvaluation:!0});n._createAction=n.createPureComputed(n._computeCreateAction,{deferEvaluation:!0});n._action=n.createPureComputed(n._computeAction,{deferEvaluation:!0});return n}t.prototype.onExecute=function(e,t){var n,r=this._actionType.peek(),i=this._action.peek(),s=this.item.peek(),o=this._viewParams.peek(),u=new g.e({name:"AutoExecute-".concat(zr.t[r])});n=i&&i.isAvailable.peek()?i.execute(e):S.n.resolve({resultType:g.t.ExpectedFailure});r!==zr.t.locate&&this._navigation.navigateTo(this._urlDataSource.getDefaultClickUrl(s,{viewParams:o}));return n.then(function(e){u.end(e);return S.n.resolve(e)}).catch(function(e){u.end(Object(jo.e)(e));return S.n.reject(e)})};t.prototype.onIsAvailable=function(){var e=this._actionType(),t=this.item(),n=this._focusItem&&this._focusItem(),r=!t.isPlaceholder,i=!n||!n().isPlaceholder;return!!e&&i&&r};t.prototype._computeAutoActionType=function(){var e=this._viewParams();return this._urlDataSource.getAutoActionType(e)};t.prototype._computeCreateAction=function(){var e,t=this;switch(this._actionType()){case zr.t.defaultClick:e=function(){return new(t.managed(t._actionMap.DefaultClickAction))({sourceEngagement:"AutoExecuteAction",item:t._focusItem&&t._focusItem()})};break;case zr.t.download:e=function(){return new(t.managed(t._actionMap.DownloadAction))({})};break;case zr.t.share:case zr.t.sharing:if(Object(le.isFeatureEnabled)(le.ODCRequestAccess)){var n=this._originalViewParams,r=n.rc,i=n.isEdit,s=n.isDirect,o="1"===i,u="1"===s,a=r?[r]:void 0;e=function(){return new(t.managed(t._actionMap.ShowShareMultiItemAction))({focusItems:t.resources.consume(Fo.n),isEdit:o,isSecureShare:u,defaultRecipients:a})}}else e=function(){return new(t.managed(t._actionMap.ShareByLinkAction))({})};break;case zr.t.sendSurvey:e=function(){return new(t.managed(t._actionMap.SurveyAction))({actionType:1})};break;case zr.t.createTextDocument:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:qn.e.Text,autoInvokedItem:!0})};break;case zr.t.createWord:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:qn.e.Word,autoInvokedItem:!0})};break;case zr.t.createExcel:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:qn.e.Excel,autoInvokedItem:!0})};break;case zr.t.createExcelForm:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:qn.e.ExcelSurvey,autoInvokedItem:!0})};break;case zr.t.createPowerPoint:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:qn.e.PowerPoint,autoInvokedItem:!0})};break;case zr.t.createOneNote:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:qn.e.OneNote,autoInvokedItem:!0})};break;case zr.t.openInExcel:case zr.t.openInWord:case zr.t.openInPowerPoint:case zr.t.openInOneNote:case zr.t.openInVisio:case zr.t.openInProject:case zr.t.openInPublisher:case zr.t.openInOffice:e=function(){return new(t.managed(t._actionMap.OpenInOfficeClientAction))({})};break;case zr.t.embed:e=function(){return new(t.managed(t._actionMap.EmbedAction))({})};break;case zr.t.reportAbuse:e=function(){return new(t.managed(t._actionMap.ReportAbuseAction))({})};break;case zr.t.addToShared:e=function(){return new(t.managed(t._actionMap.AddToSharedListAction))({})};break;case zr.t.editBrowser:case zr.t.edit:case zr.t.editNew:e=function(){return new(t.managed(t._actionMap.OpenInOfficeOnlineAction))({})};break;case zr.t.feedback:e=function(){return new(t.managed(t._actionMap.FeedbackAction))({})};break;case zr.t.versionHistory:e=function(){return new(t.managed(t._actionMap.ShowVersionHistoryAction))({})};break;case zr.t.showProperties:if(this._focusItem&&!this._focusItem()){var f=this._originalViewParams.commentId,l=this.resources.consume(Io);f&&l({commentId:f});e=function(){return new(t.managed(t._actionMap.ShowPropertiesAction))({useToggleBehavior:!0})}}break;case zr.t.locate:}return e};t.prototype._computeAction=function(){var e=this._action.peek();e&&e.dispose();e=null;var t=this._createAction();t&&(e=t());return e};return t})(In.e),Ro=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="ToggleSelectionModeAction";n._platformDetection=n.resources.consume(zn.e);n._isSelectionModal=n.resources.consume(Ns.t);n._selectionHelper=new(n.child(Qt.e))({});n._isOneDriveXboxApp=Object(Xn.t)();return n}t.prototype.onIsAvailable=function(){return this._isOneDriveXboxApp||this._platformDetection.isMobile&&!this._isSelectionModal()&&!this._selectionHelper.firstItem()};t.prototype.onExecute=function(e){var t=this._isSelectionModal.peek();this._isSelectionModal(!t);return S.n.wrap({resultType:g.t.Success})};t.prototype.onIsToggled=function(){return this._isSelectionModal()};return t})(Xt.e),Uo=(function(e){Object(i.__extends)(t,e);function t(t){var r=e.call(this,t)||this;r.name="RedeemCode";r._executorLoader=new(r.managed(ei.e))({path:"./RedeemCodeExecutor",getModule:function(){return S.n.resolve(n.ee([25,"ondemand.resx-ondemand"],1669))},getExecutorParams:function(){return{redeemSuccess:t.redeemSuccess,redeemCode:t.redeemCode,actionName:r.name}}});return r}t.prototype.onExecute=function(e){return this._executorLoader.execute(e)};t.prototype.onIsAvailable=function(){return!0};return t})(Xt.e),zo=n(476),Wo=(function(e){Object(i.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getExecutorPath=function(){return"../SaveExecutor"};t.prototype.getModuleFactory=function(){return function(){return S.n.resolve(n.ee([34],1608))}};return t})((function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="Save";n._itemContentsProvider=n.resources.consume(zo.e);n._selectionHelper=new(n.child(Qt.e))({overrideItem:t.item,allowMultiSelect:!1,canFallback:!1});var r=Object(ce.qo)(ce.J)?n._selectionHelper.currentItem:n.resources.consume(_r.i);n._loader=new(n.managed(ei.e))({path:n.getExecutorPath(),getModule:n.getModuleFactory(),getExecutorParams:function(){return{selectionHelper:n._selectionHelper,currentItem:r.peek()}}});return n}t.prototype.onIsAvailable=function(){var e=this._selectionHelper.firstItem();if(!e)return!1;var t=this._itemContentsProvider.getItemContent(e);return!!t.isEditable()&&(!!t.memoryContent()&&(!t.hasConflict()&&(!t.hasPendingSave()&&t.hasChanges())))};t.prototype.onExecute=function(e){return this._loader.execute(e)};return t})(Xt.e)),Xo=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="Redeem";n._itemProvider=n.resources.consume(tn.resourceKey);n._urlDataSource=n.resources.consume(V.B);n._itemReedemer=n.resources.consume(Zt.e);n._selectionHelper=new(n.child(Qt.e))({overrideItem:t.item,allowMultiSelect:!0,canFallback:!1});return n}t.prototype.onIsAvailable=function(){return this._urlDataSource.getPageType()===ae.e.TextFileEditor&&this._selectionHelper.filterItems(function(e){return e.tokenNeedsRedeeming})};t.prototype.onExecute=function(e){var t=this;return this._selectionHelper.resolveSelection().then(function(e){return t._itemReedemer.redeemItems(e,t).then(function(){for(var n=0,r=e;n<r.length;n++){var i=r[n];t._itemProvider.invalidateItem(i.key,{triggerFetch:!0})}return S.n.wrap({resultType:g.t.Success})})})};return t})(Xt.e),Vo=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=n.itemSet;r.itemSet=i;r.item=r.createPureComputed(r._computeItem);r.item.equalityComparer=Pr.t;r.isEmpty=r.createPureComputed(r._computeIsEmpty);r.hasItems=r.createPureComputed(r._computeHasItems);r.hasName=r.createPureComputed(r._computeHasName);r.hasParent=r.createPureComputed(r._computeHasParent);r.name=r.createPureComputed(r._computeName);r.isPlaceholder=r.createPureComputed(r._computeIsPlaceholder);return r}t.prototype._computeItem=function(){return this.itemSet().item()};t.prototype._computeHasItems=function(){return this.itemSet().content().items.length>0};t.prototype._computeIsEmpty=function(){var e=0===this.itemSet().content().items.length&&!this.itemSet().isPlaceholder,t=!this.item().isPlaceholder;return e&&t};t.prototype._computeHasName=function(){var e=this.item();return!(!e.displayName&&!e.name)};t.prototype._computeHasParent=function(){return Me.e.isActivated("D99057A9-4CBD-49C0-8721-0C2D2A23ADC7","06/23/2021","Use item.parentKey and itemParentHelper to get parent of item")?!!this.item().UNSAFE_parent:!!this.item().parentKey};t.prototype._computeName=function(){var e=this.item();return e.displayName||e.name};t.prototype._computeIsPlaceholder=function(){return this.item().isPlaceholder};t.dependencies=Object(i.__assign)(Object(i.__assign)({},ne.n.dependencies),{itemSet:_r.s});return t})(ne.n),$o=Object(X.s)("ItemSetMonitor",Vo),Jo=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="SwitchPhotoFolderLayoutType";n._itemSetMonitor=n.resources.consume($o);return n}t.prototype.onIsToggled=function(){var e=this._itemSetMonitor.item();return!K.e.getKeyParams(e.key).ft};t.prototype.getExecutorPath=function(){return"./SwitchPhotoFolderLayoutTypeExecutor"};t.prototype.getModuleFactory=function(){return function(){return S.n.resolve(n.ee([42],1609))}};t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!1}};t.prototype.getExecutorParameters=function(){return{actionName:this.name}};return t})(an.e),Ko=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="CreateAlbumFromFolder";n._identity=n.resources.consume(V.h);n._urlDataSource=n.resources.consume($.n);n._itemParentHelper=n.resources.consume(xn.e);return n}t.prototype.isValidItem=function(e,t,n){var r=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"mountPoint")),i=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"vault")),s=n!==ae.e.TextFileEditor,o=e&&e.ownerId&&e.ownerId.toUpperCase(),u=K.e.viewerId&&K.e.viewerId.toUpperCase();return s&&t&&t.type!==ue.e.anonymous&&o===u&&!r&&e.type===Gt.e.Folder&&e.queryType===Z.e.Files&&"root"!==e.id&&!e.isBundle&&!e.isAlbum&&!i};t.prototype.getExecutorPath=function(){return"./CreateAlbumFromFolderExecutor"};t.prototype.getModuleFactory=function(){return function(){return S.n.resolve(n.ee([12],1703))}};t.prototype.getExecutorParameters=function(){return{actionName:this.name,itemSelectionHelper:this.selectionHelper}};t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};t.prototype.onIsAvailable=function(){if(!Object(le.isFeatureEnabled)(le.EnableCreateAlbumFromFolder)&&Object(It.e)(wt.u))return!1;var e=this.selectionHelper.firstItem();if(!e)return!1;var t=this._identity.getIdentity(),n=this._urlDataSource.getPageType();return this.isValidItem(e,t,n)};return t})(an.e),Qo=n(429),Go=n(470),Yo=n(387),Zo=new RegExp("^".concat("Templates","$"),"i"),eu=(function(){function e(){}e.isFolder=function(e,t){var n=!!e;n&&!(n=e.type===Gt.e.Folder)&&t&&e.type===Gt.e.OneNote&&(n=!!de.e.isActivated("94B1529C-14BB-4854-B5FC-748FCEFF2681","3/29/2022","Check for OneNote note")||(!e.contentTypeId||0!==e.contentTypeId.lastIndexOf("0x0101",0)));return n};e.isCheckedOut=function(e){return Yo.e(e)};e.isCheckedOutByUser=function(e,t){return Yo.n(e,t)};e.isCheckedOutByOther=function(t,n){return e.isCheckedOut(t)&&!e.isCheckedOutByUser(t,n)};e.showCheckedOutByOtherDialog=function(e){return e.requestDialog({title:Qo.t,component:{name:Rr.e.tagName,params:{text:Qo.e}},actions:[{name:Un.cancelActionText,execute:function(){return S.n.wrap(2)},icon:new Nn.e("Cancel"),isDefault:!0}]}).wait().then(function(){return{resultType:g.t.Success}})};e.isPublished=function(t,n){return n.isModerated?t.properties[e.PublishProperty]&&"3"!==t.properties[e.PublishProperty]&&"1"!==t.properties[e.PublishProperty]:0===e.getVersionNoModeration(t,n).minor&&0!==e.getVersionNoModeration(t,n).major};e.needsPublishingReminder=function(t,n){return!e.isPublished(t,n)&&(!e.isPendingApproval(t,n)&&!e.isPageTemplate(t)&&((!t.properties||!t.properties._ScheduledVersion||t.properties.owshiddenversion!==t.properties._ScheduledVersion)&&(Go.e.hasItemPermission(t,Go.e.editListItems)&&n.enableMinorVersions&&!e.isFolder(t,!0))))};e.isPublishingRelevant=function(t,n){return Go.e.hasItemPermission(t,Go.e.editListItems)&&n.enableMinorVersions&&!e.isCheckedOut(t)&&!e.isFolder(t,!0)};e.getVersionNoModeration=function(e,t){return t.isModerated?{major:0,minor:0}:this.getVersion(e,t)};e.getVersion=function(t,n){if(t&&t.properties&&t.properties[e.VersionProperty]){var r=Number(t.properties[e.VersionProperty])%512;return{major:Math.floor(Number(t.properties[e.VersionProperty])/512),minor:r}}return{major:0,minor:0}};e.isPendingApproval=function(t,n){return!!n.isModerated&&(t&&t.properties&&t.properties[e.PublishProperty]&&"2"===t.properties[e.PublishProperty])};e.isPageTemplate=function(e){if(!e)return!1;var t=!1,n=!1;if(e.id){var r=e.id.split("/"),i=r.length;t=Zo.test(r[i-2])}if(e.properties){var s=e.properties._SPSitePageFlags;n=!!s&&s.filter(function(e){return"template"===e.toLowerCase()}).length>0}return t||n};e.isApprovalRelevant=function(t,n){return n&&n.isModerated&&!e.isCheckedOut(t)&&Go.e.hasItemPermission(t,Go.e.editListItems)&&Go.e.hasItemPermission(t,Go.e.approveItems)};e.FileTypeProperty="FSObjType";e.PublishProperty="_ModerationStatus.";e.VersionProperty="_UIVersion";return e})(),tu=(new nn.e("checkout"),new nn.e("quickEdit"),new nn.e("editItem"),new nn.e("viewItem"),new nn.e("versionHistory")),nu=(new nn.e("exportList"),(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.state=n.createPureComputed(n._computeState);n._urlDataSource=n.resources.consume(V.B);n._itemParentHelper=n.resources.consume(xn.e);n._itemCommandHelper=n.resources.consume(en.t);n._itemSelectionHelper=new(n.child(Qt.e))({allowMultiSelect:!1,canFallback:!1});return n}t.prototype.getParams=function(){return{item:this._itemSelectionHelper.firstItem}};t.prototype._computeState=function(){var e=this._itemSelectionHelper.firstItem(),t=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")),n=t&&t.list,r=!eu.isFolder(e,!0)&&Go.e.hasItemPermission(e,Go.e.viewVersions);return{isAvailable:this._urlDataSource.getPageType()!==ae.e.TextFileEditor&&!!n&&!n.isExternal&&(n.enableVersions||n.isModerated)&&this._itemCommandHelper.isCommandSupported(e,tu)&&e.itemStatus!==Pi.e.ConditionalAccessBlocked&&e.itemStatus!==Pi.e.ConditionalAccessViewOnly&&r}};return t})(ne.n)),ru=Object(Kr.e)({name:"ShowReactVersionHistory",source:{moduleDefinition:{path:"./ShowReactVersionHistoryExecutor",getModule:function(){return S.n.resolve(n.ee([41,"ondemand.resx-ondemand"],1662))}}},handlerType:nu}),iu=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="VersionHistory";r._itemCommandHelper=new(r.managed(en.e));r._itemSelectionHelper=new(r.child(Qt.e))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&!Object(Xn.e)()&&(this._itemCommandHelper.isCommandSupported(e,or.l)||!!e&&(e.type===Gt.e.File||e.type===Gt.e.Media)&&!e.dateDeletedTime&&Object(le.isFeatureEnabled)(le.VersionAllFiles))};t.prototype.onExecute=function(e,t){return Object(i.__awaiter)(this,void 0,S.n,function(){var t,n,r,s;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:if(!(t=i.sent()))return[2,S.n.resolve({resultCode:"EmptySelection",resultType:g.t.Failure})];if(!Object(It.e)(t.ownerId)&&this._itemCommandHelper.isCommandSupported(t,or.l)){n=this.resources.consume(V.B);r=n.getVersionHistoryUrl(K.e.viewerId,t.id);return[2,new(this.managed(fi.e))({url:r,target:"_blank"}).execute(e)]}if(Ze.e.isAuthenticated())return[2,(new(this.managed(ru))).execute(e)];s=this.resources.consume(W.e);return[2,new(this.managed(fi.e))({url:K.e.getAutoRedeemLoginUrl(t.id,t.ownerId,this.name,s)}).execute(e)]}})})};return t})(Xt.e),su=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="ApplyOfficeLens";n._item=Object(ce.qo)(ce.J)?n.selectionHelper.currentItem:n.resources.consume(_r.i);return n}t.prototype.getExecutorPath=function(){return"./ApplyOfficeLensExecutor"};t.prototype.getModuleFactory=function(){return function(){return S.n.resolve(n.ee([11],1704))}};t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!1}};t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,item:this._item.peek()}};t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return e&&this._item&&this.itemCommandHelper.isCommandSupported(e,vn)};return t})(an.e),ou=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var r=e.call(this,t)||this;r.name="RemoveOfficeLens";r._selectionHelper=new(r.child(Qt.e))({overrideItem:t.item,allowMultiSelect:!1,canFallback:!1});r._itemCommandHelper=new(r.managed(en.e));r._item=Object(ce.qo)(ce.J)?r._selectionHelper.currentItem:r.resources.consume(_r.i);r._loader=new(r.managed(ei.e))({path:"./RemoveOfficeLensExecutor",getModule:function(){return S.n.resolve(n.ee([27],1705))},getExecutorParams:function(){return{actionName:r.name,selectionHelper:r._selectionHelper,item:r._item.peek()}}});return r}t.prototype.onIsAvailable=function(){var e=this._selectionHelper.firstItem();return e&&this._item()&&this._itemCommandHelper.isCommandSupported(e,mn)};t.prototype.onExecute=function(e){return this._loader.execute(e)};return t})(Xt.e),uu=n(322),au=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._primary=new(n.managed(t.primary))(t.actionParams);var r=Object(i.__assign)(Object(i.__assign)({},t.actionParams),{primaryActionName:n._primary.name});n._secondary=new(n.managed(t.secondary))(r);n.name=n._primary.name;n.isAvailable=n._primary.isAvailable;n.isExecuting=n.createPureComputed(n._computeIsExecuting);n.isToggled=n.createPureComputed(n._computeIsToggled);n.inputType=n.createPureComputed(n._computeInputType);return n}t.create=function(e,n){return(function(t){Object(i.__extends)(r,t);function r(r){return t.call(this,{primary:e,secondary:n,actionParams:r})||this}return r})(t)};t.prototype.execute=function(e){return this._getAction().execute(e)};t.prototype._getAction=function(){return this._secondary.isAvailable.peek()?this._secondary:this._primary};t.prototype._computeIsExecuting=function(){return this._primary.isExecuting()||this._secondary.isExecuting()};t.prototype._computeIsToggled=function(){return this._primary.isToggled()||this._secondary.isToggled()};t.prototype._computeInputType=function(){var e=this._secondary.isAvailable()?this._secondary:this._primary;return e&&e.inputType?e.inputType():uu.e.none};return t})(ne.n),fu=n(292),lu=!Me.e.isActivated("85B60F61-8AB8-435E-92B3-7D9D9F3451ED","03/30/2023","Prompt for download on PDF print"),cu=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="PrintPdf";n._urlDataSource=n.resources.consume($.n);n._instrumentationProvider=n.resources.consume(G.i);n._platform=n.resources.consume(zn.e);n._navigation=n.resources.consume(W.e);n._supportsIframePrint=!lu&&(n._platform.isChrome||n._platform.isSafari);n._isOneDriveXboxApp=Object(Xn.t)();return n}t.prototype.getExecutorPath=function(){return"./PrintPdfExecutor"};t.prototype.getModuleFactory=function(){return function(){return S.n.resolve(n.ee([24,"ondemand.resx-ondemand"],1610))}};t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!1}};t.prototype.getExecutorParameters=function(){return{actionName:this.name,urlDataSource:this._urlDataSource,instrumentationProvider:this._instrumentationProvider,navigation:this._navigation,selectionHelper:this.selectionHelper}};t.prototype.onExecute=function(t){var n=this;return this._supportsIframePrint?this.selectionHelper.resolveFirst().then(function(e){var t=n._urlDataSource.getPrintPdfUrl(e);ve.e.logData({name:fu.t[fu.t.PrintPdfNative],location:fu.e[fu.e.OneUp],usageType:Be.e[Be.e.Click],currentPage:n._instrumentationProvider.currentPageName(),previousPage:n._instrumentationProvider.previousPageName()});n._navigation.navigateTo({url:t,frameId:"_blank"});return S.n.wrap({resultType:g.t.Success})}):e.prototype.onExecute.call(this,t)};t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return e&&".pdf"===e.extension&&!this._platform.isMobile&&!this._isOneDriveXboxApp&&Object(le.isFeatureEnabled)(le.UseWebPdfViewer)};return t})(an.e),hu=n(331),pu=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="SaveAutoAlbum";n._isHidden=t.isHidden||!1;return n}t.prototype.getExecutorPath=function(){return"./SaveAutoAlbumExecutor"};t.prototype.getModuleFactory=function(){return function(){return S.n.resolve(n.ee([33],1706))}};t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};t.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper,isHidden:this._isHidden}};t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return Object(le.isFeatureEnabled)(le.EnableEvokeAlignments)&&e&&e.virtualItemType===_s.e.Album&&(hu.n(e)||Object(le.isFeatureEnabled)(le.EvokeDev))};return t})(an.e),du=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="DiscardAutoAlbum";return n}t.prototype.getExecutorPath=function(){return"./DiscardAutoAlbumExecutor"};t.prototype.getModuleFactory=function(){return function(){return S.n.resolve(n.ee([15],1707))}};t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};t.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper}};t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return Object(le.isFeatureEnabled)(le.EnableEvokeAlignments)&&e&&e.virtualItemType===_s.e.Album&&hu.n(e)};return t})(an.e),vu=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="ImplicitSaveAutoAlbum";n._action=t.action;n._saveAutoAlbumAction=t.saveAutoAlbumAction;return n}t.prototype.onExecute=function(e,t){var n=this;return this._action.execute(e).then(function(t){n._saveAutoAlbumAction.isAvailable()&&n._saveAutoAlbumAction.execute(e);return t})};t.prototype.onIsAvailable=function(){return this._action.isAvailable()};return t})(Xt.e),mu=n(116),gu=n(286),yu=n(415),bu=n(523),wu=!de.e.isActivated("C3FF543C-D25D-4467-BED7-BEE3A94C6264","11/10/2021","Use vaultStore to get vault property"),Eu=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._itemParentHelper=n.resources.consume(xn.e);n._itemSelectionHelper=new(n.child(Qt.e))({allowMultiSelect:!0,overrideItem:t.item});n._urlDataSource=n.resources.consume(V.B);n._viewParams=n.resources.consume(_r.S);n._vaultActionType=t.actionType;n._isGlobal=t.isGlobal;n._goPremiumSource=t.goPremiumSource;n._shouldShowFRE=!1!==t.shouldShowFRE;n._vaultHelper=new(n.managed(bu.e))({});n._isVaultUnlocked=n.observables.createCallback(Object(mu.t)(!1));n._vaultFreState=n.observables.createCallback(Object(mu.t)(p.r.NotCreated));n._isVaultDisabled=n.observables.createCallback(Object(mu.t)(!1));wu?n.resources.isDefined(yu.e)&&n.resources.consumeAsync(yu.e).then(function(e){n._isVaultUnlocked.register(e.isVaultOpen);n._vaultFreState.register(e.vaultFreState);n._isVaultDisabled.register(e.isVaultDisabled)}):n.resources.isDefined(V.I)&&n.resources.consumeAsync(V.I).then(function(e){e.vaultStateSubscribe(n._isVaultUnlocked);e.vaultFreSubscribe(n._vaultFreState);e.vaultDisabledSubscribe(n._isVaultDisabled)});n._isOneDriveWinApp=Object(Xn.e)();return n}t.prototype.getExecutorPath=function(){return"./VaultExecutor"};t.prototype.getModuleFactory=function(){return function(){return S.n.resolve(n.ee([43,"ondemand.resx-ondemand"],1670))}};t.prototype.getSelectionOptions=function(e){return e.actionType===wi.e.ShowFiles?{allowMultiSelect:!0,canFallback:!1}:{allowMultiSelect:!1,canFallback:!0}};t.prototype.onIsAvailable=function(){var e,t=this.selectionHelper.firstItem(),n=t&&this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(t,"vault"));if(this._isVaultDisabled())return!1;var r=Object(ce.qo)(ce.Ms)&&Object(It.e)(wt.u)?!this._isVaultUnlocked():(null===(e=null==n?void 0:n.vault)||void 0===e?void 0:e.isLocked)||!1;if(this._vaultActionType===wi.e.ShowFiles){var i=this._itemSelectionHelper.currentItem(),s=this._urlDataSource.getKeyParams(i.key),o=this._urlDataSource.getQueryType(s),u=this.selectionHelper.selection();return!(o!==Z.e.RecycleBin||this._vaultFreState()!==p.r.FreShown||this._isOneDriveWinApp||u.length>0)&&!this._isVaultUnlocked()}if(this._vaultActionType===wi.e.Unlock)return!!(n&&n.vault&&r);if(this._vaultActionType===wi.e.Lock){var a=this._isGlobal&&this._isVaultUnlocked(),f=t&&t.vault&&t.vault.root&&!r;return!(!a&&!f)}return n&&!n.error||this._isVaultUnlocked()};t.prototype.getExecutorParameters=function(){return{actionType:this._vaultActionType,isPickerPage:this._isPickerPage,goPremiumSource:this._goPremiumSource}};t.prototype.onExecute=function(t,n){var r=this._urlDataSource.getPageType(this._viewParams.peek()),i=this._urlDataSource.getQueryType(this._viewParams.peek());this._isPickerPage=r===ae.e.FilePicker||r===ae.e.FolderPicker;ve.e.logData({name:"Vault.".concat(Object(gu.i)(this._vaultActionType)),extraData:{location:Object(gu.r)(r,i)}});if(this._vaultActionType===wi.e.Unlock&&!this._isOneDriveWinApp&&!this._isPickerPage){var s=this._vaultFreState.peek();if(this._shouldShowFRE&&(s===p.r.BubbleShown||s===p.r.Created)){this._vaultActionType=wi.e.FreDialog;return e.prototype.onExecute.call(this,t,n)}var o=this._vaultActionType.toString();return this._vaultHelper.unlockPopup().then(function(e){return e?S.n.resolve({name:o,resultType:g.t.Success}):S.n.reject({name:o,resultType:g.t.Failure})})}return e.prototype.onExecute.call(this,t,n)};return t})(an.e),Su=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._itemRedeemer=n.resources.consume(Zt.e);n._isEdit=t.isEdit;n._isSecureShare=t.isSecureShare;n._defaultRecipients=t.defaultRecipients;n._itemsBeingShared=t.focusItems;n._selectionHelper=new(n.child(Qt.e))({overrideItem:null,allowMultiSelect:!0,canFallback:!0});n._urlDataSource=n.resources.consume(V.B);n._itemCommandHelper=n.resources.consume(en.t);n.name="ShowShareMultiItemAction";return n}t.prototype.onIsAvailable=function(){var e=this._selectionHelper.firstItem();if(!e)return!1;var t=this._selectionHelper.selection().length;if(!Object(le.isFeatureEnabled)(le.HideShareButton)&&!0===Object(It.e)(wt.u)&&1!==t)return!1;var n=t>1&&e.queryType===Z.e.SharedWithMe&&e.isRootFolder,r=t>1&&e.isAlbum,i=this._urlDataSource.isRecycleBin(e.queryType);return this._itemCommandHelper.isCommandSupported(e,Or.u)&&!n&&!r&&!i};t.prototype.onExecute=function(e,t){var n=this;this._itemsBeingShared.peek()&&this._itemsBeingShared(void 0);var r=this._selectionHelper.selection().map(function(e){return e.peek()});return this._itemRedeemer.redeemItems(r,this).then(function(){n._itemsBeingShared({items:r,defaultRecipients:n._defaultRecipients,isEdit:n._isEdit,isSecureShare:n._isSecureShare});return S.n.wrap({resultType:g.t.Success})},function(e){return S.n.reject(e)})};return t})(Xt.e),xu=(function(e){Object(i.__extends)(t,e);function t(t){var n=this,r=t.load,i=t.actionParams,s=(n=e.call(this,i)||this).resources.consume(G.e.optional);n.isQosLogged=!1;n.name="Deferred".concat(t.modulePath).replace(/Action|\.|\//g,"");n._action=n.createObservable();var o=new y.e;(s?s.waitForPLT().then(r):S.n.resolve(r())).done(function(e){return o.complete(e)},function(e){return o.error(e)});n._getActionPromise=n.trackPromise(o.getPromise().then(function(e){return new(n.managed(e))(i)}));n._getActionPromise.done(function(e){return n._action(e)});n.inputType=n.createPureComputed(n._computeInputType);return n}t.prototype.onIsAvailable=function(){return!!this._action()&&this._action().isAvailable()};t.prototype.onIsToggled=function(){return!!this._action()&&this._action().isToggled()};t.prototype.onExecute=function(e,t){return this._getActionPromise.then(function(t){return t.execute(e)})};t.prototype._computeInputType=function(){var e=this._action();return e&&e.inputType?e.inputType():uu.e.none};return t})(Xt.e);function Tu(e,t){return(function(e,t){var n;function r(){return n||(n=t())}return(function(t){Object(i.__extends)(n,t);function n(n){return t.call(this,{load:r,modulePath:e,actionParams:n})||this}return n})(xu)})(e,function(){return t().then(ee.e)})}var Nu=(function(e){Object(i.__extends)(t,e);function t(){var t=e.call(this)||this,r=Tu("../quotaBlock/odc/QuotaBlockAction",function(){return n.ee([153,"ondemand.resx-ondemand"],1642)});t.ExternalNavigateAction=Kt;t.OpenInDesktopAction=Yt;t.AddCoverPhotoAction=un;t.AddPhotosToAlbumAction=wo;t.AddToAlbumAction=Sn;t.AddToBundleAction=no;t.AddToFolderAction=Tn;t.AddToSharedListAction=Zs;t.ApplyOfficeLensAction=su;t.AutoExecuteAction=qo;t.ChangeFolderTypeAction=jn;t.ClearSelectionAction=Fn;t.CreateAlbumAction=So;t.CreateAlbumFromFolderAction=Ko;t.CreateDocumentAction=au.create(Tr,r);t.CreateFolderAction=Cr;t.CreateNewFolderAction=Tu("../createNewFolder/odc/CreateNewFolderAction",function(){return n.ee([147],1697)});t.CreateMountPointAction=Dr;t.DefaultClickAction=Xr;t.DeleteAction=Vr;t.DiscardAutoAlbumAction=du;t.DownloadAction=$r;t.DownloadZipContentsAction=Tu("../downloadZipContents/odc/DownloadZipContentsAction",function(){return n.ee([148],1653)});t.EditTagsAction=Jr;t.ShowTagsEditorAction=Gr;t.EmbedAction=Yr;t.EmptyRecycleBinAction=Zr;t.FeedbackAction=ti;t.FilterSearchAction=Co;t.FilterSearchByDateAction=_o;t.ImplicitSaveAutoAlbumAction=vu;t.LanguagePickerAction=ui;t.LaunchMoveCopyPanelAction=Bo;t.MoveCopyAction=Tu("../moveCopy/odc/MoveCopyAction",function(){return n.ee([150],1698)});t.NavigateToItemAction=ai;t.NavigationAction=fi.e;t.OneDriveSortAction=di;t.OpenAction=Ei;t.PreviewAction=Ti;t.OpenInOfficeClientAction=ki;t.OpenPdfInBrowserAction=Ai;t.OpenInOfficeOnlineAction=au.create(Di,r);t.OpenInTextEditorAction=qi;t.OpenInHtmlViewerAction=zi;t.OpenInImageEditorAction=Tu("../openInImageEditor/OpenInImageEditorAction",function(){return n.ee([151],1594)});t.OrderPrintsAction=Wi;t.PlayAudioAction=Xi;t.PlaySlideShowAction=Vi;t.PrintPdfAction=cu;t.RedeemAction=Xo;t.RedeemCodeAction=Uo;t.RemoveCoverPhotoAction=Ji;t.RemoveFromAlbumAction=mo;t.RemoveFromBundleAction=so;t.RemoveFromRecentAction=ns;t.RemoveFromSharedListAction=to;t.RemoveMountPointAction=uo;t.RemoveOfficeLensAction=ou;t.RemoveTagAction=rs;t.RemoveTagFromItemAction=ko;t.RenameAction=is;t.ReportAbuseAction=oo;t.RequestReviewAction=ao;t.RestoreAction=os;t.RestoreAllAction=us;t.RotateAction=ls;t.SaveAction=Wo;t.SaveAutoAlbumAction=pu;t.SaveSortOrderAction=ps;t.SelectAction=xo;t.SelectAllAction=To;t.SetAlbumCoverPhotoAction=Lo;t.SetFocusAction=vs;t.SetPhotosRootAction=Mo;t.ShareByLinkAction=ms;t.ShowKeyboardMapAction=gs;t.ShowOperationsAction=bs;t.ShowPermissionsAction=Es;t.ShowSuggestedFilesAction=xs;t.ShowPropertiesAction=Ts.default;t.ShowSelectionAction=Cs;t.ShowVersionHistoryAction=iu;t.SignOutAction=co;t.SortAction=ci;t.StopSlideShowAction=$i;t.SurveyAction=Ys;t.SwitchPhotoFolderLayoutTypeAction=Jo;t.ToggleDebugWindowAction=po;t.ToggleIsLeftNavUserExpandedAction=Tu("../../controls/leftNavExpander/actions/ToggleIsLeftNavUserExpandedAction",function(){return n.ee([154],1595)});t.ToggleListLayoutAction=Ds;t.ToggleSelectionModeAction=Ro;t.UpdateCaptionAction=Ws;t.UploadAction=au.create(Us,r);t.QuotaBlockAction=r;t.VaultAction=Eu;t.ViewInFolderAction=fo;t.ViewOriginalAction=Ps;t.ShowShareMultiItemAction=Su;return t}return t})($t),Cu=n(499),ku=n(367);function Lu(e,t){var n,r=null===(n=e.purchaseActions)||void 0===n?void 0:n[0];return Object(i.__assign)({price:null==r?void 0:r.price,durationInMonths:null==r?void 0:r.durationInMonths,purchaseUrl:null==r?void 0:r.purchaseUrl,planQuotaBytes:e.quotaBytes,market:t.market,purchaseData:{Currency:t.currency,Name:e.planName,Duration:null==r?void 0:r.durationInMonths}},e)}var Au=!de.e.isActivated("E6494370-FCD4-4B46-8577-8704BD998947","06/09/2022","Make sure we dont fire more than one API request"),Ou={unknown:0,upgrade:1,downgrade:2},Mu=(function(e){Object(i.__extends)(t,e);function t(){var t=e.call(this)||this;t._pendingRequests={};t._navigation=t.resources.consume(W.e);t._ctpMktParam=t._navigation.viewParams.ctpMkt;return t}t.prototype.getStorageOptions=function(){var e=this;if(Object(ce.qo)(ce.Os))return this.getStorageOptionsV2();var n=new Ye.e,r=this._navigation.viewParams.accountid,i=new f.t(t._storageOptionsUrl);i.setQueryParameter("ctpMkt",this._ctpMktParam,!1);i.setQueryParameter("accountid",r,!1);if(Au){if(this._pendingRequests[i.toString()])return this._pendingRequests[i.toString()];var s=n.send({apiName:"GetUpgradeOptions",url:i.toString()}).then(function(t){delete e._pendingRequests[i.toString()];return t}).catch(function(t){delete e._pendingRequests[i.toString()];return S.n.wrapError(t)});this._pendingRequests[i.toString()]=s;return s}return n.send({apiName:"GetUpgradeOptions",url:i.toString()})};t.prototype.getStorageOptionsV2=function(){var e=this,t="/sites/root/consumerSiteAppConfigs/files/oneDrive.getUpgradeOptions(market='".concat(this._ctpMktParam||"en-Us","')");if(Au&&this._pendingRequests[t])return this._pendingRequests[t];var n=this.resources.consume(re.e).send({endpoint:Object(Ce.o)({apiVersion:"v2.1",driveId:"me",includeViewerId:!0}),apiName:"GetUpgradeOptionsV2",path:t,apiVersion:"v2.1",useAuthorizationHeaders:!0}).then(function(n){var r,s,o;delete e._pendingRequests[t];return Object(i.__assign)(Object(i.__assign)({},n),{storagePlans:null===(r=n.storagePlans)||void 0===r?void 0:r.map(function(e){return Lu(e,n)}),officePlans:null===(s=n.officePlans)||void 0===s?void 0:s.map(function(e){return Lu(e,n)}),oneDrivePlans:null===(o=n.incrementalOneDrivePlans)||void 0===o?void 0:o.map(function(e){return Object(i.__assign)(Object(i.__assign)({},e),{transition:Ou[e.transition]||0})})})}).catch(function(n){delete e._pendingRequests[t];return S.n.wrapError(n)});this._pendingRequests[t]=n;return n};t._storageOptionsUrl=ku.e+"/API/2/GetUpgradeOptions";return t})(ne.n),_u=Object(N.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([93],1572)];case 1:return[2,e.sent().handleAppLoadingStatus]}})})}),Du=Object(N.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([102],1573)];case 1:return[2,e.sent().handleSetOverlayContent]}})})}),Pu=Object(N.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([95],1574)];case 1:return[2,e.sent().handleCopyAndEdit]}})})}),Hu=Object(N.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([96],1575)];case 1:return[2,e.sent().handleDavUrlFromIds]}})})}),Bu=Object(N.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([97],1576)];case 1:return[2,e.sent().handleEditNotification]}})})}),ju=Object(N.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([100],1577)];case 1:return[2,e.sent().handleGetCustomAuthConfig]}})})}),Fu=Object(N.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([101],1578)];case 1:return[2,e.sent().handleRefreshSessionInfo]}})})}),Iu=Object(N.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([99],1579)];case 1:return[2,e.sent().handleFileRename]}})})}),qu=Object(N.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([103],1580)];case 1:return[2,e.sent().handleSignIn]}})})}),Ru=Object(N.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([104],1581)];case 1:return[2,e.sent().handleUserActivity]}})})}),Uu=Object(N.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([107],1582)];case 1:return[2,e.sent().handleWopiInfoFromUrl]}})})}),zu=Object(N.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([98],1583)];case 1:return[2,e.sent().handleFileProperties]}})})}),Wu=Object(N.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([105],1584)];case 1:return[2,e.sent().handleVersionHistory]}})})}),Xu=Object(N.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([106],1585)];case 1:return[2,e.sent().handleWacClose]}})})}),Vu=Object(N.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([94],1586)];case 1:return[2,e.sent().handleAppPushState]}})})}),$u=Object(Ft.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(4,1676)];case 1:return[2,e.sent().WacGrantAccessDialog]}})})}),Ju=Object(Ft.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(4,1676)];case 1:return[2,e.sent().WacShareDialog]}})})}),Ku=Object(Ft.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([126,"ondemand.resx-ondemand"],1694)];case 1:return[2,e.sent().WacEmbedDialog]}})})}),Qu=Object(Ft.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([128,"ondemand.resx-ondemand"],1695)];case 1:return[2,e.sent().WacQuotaDialog]}})})}),Gu=Object(Ft.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([129,"ondemand.resx-ondemand"],1652)];case 1:return[2,e.sent().WacRedeemDialog]}})})}),Yu=Object(Ft.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([123],1696)];case 1:return[2,e.sent().LegacyWacApplication]}})})}),Zu=Object(Ft.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([116],1672)];case 1:return[2,e.sent().COBWacApplication]}})})}),ea=Object(Ft.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(9,1650)];case 1:return[2,e.sent().WacFilePickerDialog]}})})}),ta=Object(Ft.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(9,1650)];case 1:return[2,e.sent().WacMoveToFolderPickerDialog]}})})});Object(yt.e)();Object(u.e)();var na,ra,ia="https://onedrive.live.com",sa=new f.t(window.location.href);(function(e){e.View="View";e.Edit="Edit";e.EditNew="EditNew";e.BinaryConvert="BinaryConvert"})(na||(na={}));function oa(e,t,n){var r,s,o,u,a,l,c,h,p;return Object(i.__awaiter)(this,void 0,S.n,function(){var d,v,m,g,y,b,w,E,S;return Object(i.__generator)(this,function(T){switch(T.label){case 0:d=window.WacConfig;v=(null===(r=d.viewParams)||void 0===r?void 0:r.cid)||(null==t?void 0:t.cid);m=(null===(s=d.viewParams)||void 0===s?void 0:s.id)||(null==t?void 0:t.resid);if(!ma())return[3,2];"editnew"!==(null===(o=null==t?void 0:t.action)||void 0===o?void 0:o.toLowerCase())&&"editnew"!==(null===(u=null==sa?void 0:sa.getQueryParameter("action"))||void 0===u?void 0:u.toLowerCase())||(d.OriginalMode="EditNew");return[4,e.getItem(v,m,d.OriginalMode,d.RelativePath,t,sa)];case 1:if(!(y=T.sent()))return[2,null];if(!(function(e){var t,n,r,s=window.WacConfig,o=null===(n=null===(t=e.itemFromServer)||void 0===t?void 0:t.openWith)||void 0===n?void 0:n.wac;if(!o){Object(x.e)("Error: the wopiInfo is null");return!1}var u=!1;if(Lt(Ct.EnableWacUnifiedApps)){u=!1;if(o.bootstrapperUrl&&At("Wac_JsApi_{0}_{1}",o.appName,s.OriginalMode)){u=!0;s.OriginalMode===na.Edit&&Lt(kt("EnableWacUseOpenUrlInPlaceOfEditForUnified_{0}",o.appName))&&(o.applicationUrl||(u=!1))}}var a=!1;u&&(a=!0);var l=!1;a&&Lt(Ct.EnableWacJsApiV2)&&(Lt(kt("Wac_HostFlight_{0}_{0}JsApiV2",o.appName))||Lt(kt("Wac_HostFlight_{0}_{0}JsApiV2NoWrapper",o.appName)))&&(l=!0);s.UseUnifiedApps=a?1:0;s.BootWithJsApiV2=l?1:0;s.Application=o.appName;s.OpenInClientAction="OpenIn"+o.appName;var c,h=e.itemId;if(s.RelativePath){var p=new f.t(s.CloseUrl);p.setQueryParameter("id",h);s.CloseUrl=p.toString();(p=new f.t(s.FilePropertiesUrl)).setQueryParameter("id",h);s.FilePropertiesUrl=p.toString();(p=new f.t(s.FileVersionUrl)).setQueryParameter("resid",h);s.FileVersionUrl=p.toString();(p=new f.t(s.EditUrl)).setQueryParameter("resid",h);s.EditUrl=p.toString();(p=new f.t(s.ViewUrl)).setQueryParameter("resid",h);s.ViewUrl=p.toString();s.viewParams.id=h}var d=JSON.parse(s.PageTitleTypeList);for(var v in d)if(-1!==d[v].indexOf(o.appName)){c=d[v];break}s.PageTitleType=c;if(a){var m;m={WordJsApiV2NoWrapper:Lt(Ct.Word.WacHostFlightWordWordJsApiV2NoWrapper)?1:0,WordJsApiV2:Lt(Ct.Word.WacHostFlightWordWordJsApiV2)?1:0,WordScriptsPreload:Lt(Ct.Word.WacHostFlightWordWordScriptsPreload)?1:0,ExcelJsApiV2NoWrapper:Lt(Ct.Excel.WacHostFlightExcelExcelJsApiV2NoWrapper)?1:0,ExcelJsApiV2:Lt(Ct.Excel.WacHostFlightExcelExcelJsApiV2)?1:0,ExcelLandingPageOfflineTelemetry:Lt(Ct.Excel.WacHostFlightExcelExcelLandingPageOfflineTelemetry)?1:0,InstantShell:Lt(Ct.Excel.WacHostFlightExcelInstantShell)?1:0,ExcelAdaptiveLayoutDownload:Lt(Ct.Excel.WacHostFlightExcelExcelAdaptiveLayoutDownload)?1:0,ExcelLandingPageObserver:Lt(Ct.Excel.WacHostFlightExcelExcelLandingPageObserver)?1:0,PowerPointJsApiV2NoWrapper:Lt(Ct.PowerPoint.WacHostFlightPowerPointPowerPointJsApiV2NoWrapper)?1:0,PowerPointJsApiV2:Lt(Ct.PowerPoint.WacHostFlightPowerPointPowerPointJsApiV2)?1:0,OneNoteJsApiV2NoWrapper:Lt(Ct.OneNote.WacHostFlightOneNoteOneNoteJsApiV2NoWrapper)?1:0,OneNoteJsApiV2:Lt(Ct.OneNote.WacHostFlightOneNoteOneNoteJsApiV2)?1:0,VisioJsApiV2NoWrapper:Lt(Ct.Visio.WacHostFlightVisioVisioJsApiV2NoWrapper)?1:0,VisioJsApiV2:Lt(Ct.Visio.WacHostFlightVisioVisioJsApiV2)?1:0,ODCShareLinkPreload:Lt(kt("Wac_HostFlight_{0}_ODCShareLinkPreload",o.appName))?1:0};s.Unified=Object(i.__assign)(Object(i.__assign)({},s.Unified),{WacApplication:o.appName,WacBootstrapperUrl:o.bootstrapperUrl,UserId:$Config.hcid,OwnerId:e.ownerId,ApplicationUrl:ga(o.applicationUrl,e.size),PageTitle:c.replace("{0}",e.name),ETag:e.eTag,FileName:e.name,FileGetUrl:o.fileGetUrl,FileGetUrlExpiry:null===(r=o.fileGetUrlExpiry)||void 0===r?void 0:r.toString(),FileSize:e.size,WopiSrc:o.wopiSrc,AccessToken:o.accessToken,AccessTokenExpiry:o.accessTokenExpiry,HostFlights:m,AppEnabled:u?1:0,ResourceId:h})}else s.Unified=void 0;return!0})(y))return[2,null];(function(e){var t,n=window.WacConfig;document.title=n.PageTitleType.replace("{0}",null==e?void 0:e.name);var r=void 0,i=JSON.parse(n.IconPathList);for(var s in i)if(-1!==i[s].key.indexOf(n.Application)){r=i[s].value;break}if(r){var o=document.head.querySelector('link[rel="icon"]');if(null!==o)o.href=r;else{(o=document.createElement("link")).rel="icon";o.href=r;o.type="image/x-icon";document.head.appendChild(o)}}if(window.history&&window.history.replaceState){var u=new f.t(window.location.href);u.getQueryParameter("resid")&&(null===(t=n.viewParams)||void 0===t?void 0:t.id)&&u.setQueryParameter("resid",n.viewParams.id,!0);window.history.replaceState(null,document.title,u.toString())}})(y);"Other"===(null===(a=n.data)||void 0===a?void 0:a.entryPoint)&&(g=fa())&&n.update({entryPoint:g.entryPoint});m=(null===(l=d.viewParams)||void 0===l?void 0:l.id)||(null==t?void 0:t.resid);return[2,{id:y.itemId,name:y.name,eTag:y.eTag,key:"id=".concat(m),vault:y.vault,urls:{dav:null===(c=y.itemFromServer)||void 0===c?void 0:c.webDavUrl},sharingType:y.sharingType,ownerId:y.ownerId,folder:y.folder,video:y.video,photo:y.photo,itemFromServer:y.itemFromServer,parentKey:y.parentKey,graph:{itemId:y.itemId,driveId:(null===(p=null===(h=y.itemFromServer)||void 0===h?void 0:h.parentReference)||void 0===p?void 0:p.driveId)||Object(Ot.e)(v)}}];case 2:y=JSON.parse(d.GetItemsResponse).items[0];b=Object(O.v)(((E={}).id=y.id,E.cid=d.viewParams.cid,E));w=y.parentId?Object(O.v)(((S={}).id=y.parentId,S.cid=d.viewParams.cid,S)):void 0;return[2,{id:y.id,name:y.name,eTag:y.eTag,key:b,parentKey:w,vault:y.vault,urls:y.urls,sharingType:y.sharingLevelValue,ownerId:y.ownerCid,folder:y.folder?{}:void 0,video:y.video,photo:y.photo,graph:{itemId:y.id,driveId:Object(Ot.e)(v)}}]}})})}function ua(){return Object(i.__awaiter)(this,void 0,void 0,function(){var e,t;return Object(i.__generator)(this,function(n){switch(n.label){case 0:e=2===Object(Et.e)();t="https://api.badger".concat(e?"d":"p",".svc.ms/v1.0/token");return[4,fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({appid:"00000000-0000-0000-0000-0000481710a4"})})];case 1:return[4,n.sent().json()];case 2:return[2,n.sent()]}})})}function aa(e,t,n){return Object(i.__awaiter)(this,void 0,void 0,function(){var r,s;return Object(i.__generator)(this,function(i){switch(i.label){case 0:r=Object(wt.t)();s="".concat(r,"/shares/u!").concat(n);return[4,fetch(s,{method:"POST",headers:{"Content-Type":"application/json",Authorization:e?"Badger ".concat(e.token):"Bearer ".concat(t.accessToken),Prefer:"autoredeem"}})];case 1:return[4,i.sent().json()];case 2:return[2,i.sent()]}})})}function fa(){var e,t;try{var n=localStorage.getItem("ODCWac_ST");if(n){localStorage.removeItem("ODCWac_ST");return{entryPoint:"SDX.Skydrive*Root",clickTime:Number(n)}}var r=c.a.get("BP"),i=_.e(r),s=i.ST,o=i.FR;if(s&&o&&(o.indexOf("WC.Hotmail*WACCopy")>-1||o.indexOf("SDX.Skydrive*Root")>-1)){return{clickTime:Number(s),entryPoint:o}}if(null===(t=null===(e=window.WacConfig)||void 0===e?void 0:e.Unified)||void 0===t?void 0:t.ApplicationUrl){var u=new f.t(window.WacConfig.Unified.ApplicationUrl),a=u.getQueryParameter("wdorigin")||u.getQueryParameter("wdOrigin");if(a)return{entryPoint:a}}return{entryPoint:"Other"}}catch(e){return{entryPoint:"Other"}}}function la(e,t){var n,r=1===(null===(n=e.Ramps)||void 0===n?void 0:n.WacUseShareTestEndpoint)?"https://www.onedrive-tst.com":"https://www.onedrive.com",i=t.sharedevhost;i&&(r="https://www.onedrive-tst.com");return{origin:r,devHost:i,height:402,width:320}}function ca(e){var t,n,r=this,s=e.redeemDialogHandleRef,o=e.diagnostics,u=e.viewParams,a=e.item,f=e.resourceScope,l=e.wacDataSource,c=e.vault,h=window.Flight,p=window.FilesConfig,d=window.$Config,v=window.WacConfig,m=f.consume(V.h).getIdentity().type!==ue.e.anonymous;return{diagnostics:o,viewParams:u,callerCid:d.hcid,env:p.env,enableInteractiveAuthFlow:1===(null===(t=h.Ramps)||void 0===t?void 0:t.WacAddinInteractiveAuthFlow),email:d.email,pageTitleType:v.PageTitleType,wacIframeDomain:null===(n=v.Unified)||void 0===n?void 0:n.ApplicationUrl,Mode:v.Mode,ViewUrl:v.ViewUrl,EditUrl:v.EditUrl,FileVersionUrl:v.FileVersionUrl,FilePropertiesUrl:v.FilePropertiesUrl,CloseUrl:v.CloseUrl,SignInUrl:p.signInUrl,autoRedeemSignOut:p.autoRedeemSignOut,autoRedeemUrl:p.autoRedeemUrl,authKey:p.authKey,item:a,refreshItem:function(e){return Object(i.__awaiter)(r,void 0,void 0,function(){var e,t,n,r,s,o;return Object(i.__generator)(this,function(i){switch(i.label){case 0:e=(null===(n=v.viewParams)||void 0===n?void 0:n.cid)||(null==u?void 0:u.cid)||(null===(r=v.Migration)||void 0===r?void 0:r.hcid);t=(null===(s=v.viewParams)||void 0===s?void 0:s.id)||(null==u?void 0:u.resid)||(null===(o=v.Migration)||void 0===o?void 0:o.id);return[4,l.getItem(e,t,v.OriginalMode,v.RelativePath,u,sa)];case 1:i.sent().key="id=".concat(t);return[2]}})})},wacDataSource:l,isAuthenticated:m,vault:c,Ramps:h.Ramps,shareDialog:la(window.Flight,u),redeemDialogHandleRef:s}}(function(e){e[e.Initial=0]="Initial";e[e.Loading=1]="Loading";e[e.Loaded=2]="Loaded";e[e.Failed=3]="Failed"})(ra||(ra={}));function ha(e){var t=Object(s.useState)(function(){return new g.e({name:"ODCWacHost.Bootstrap"})})[0],n=e.item,r=e.vault,a=e.diagnostics,l=e.viewParams,c=e.wacDataSource,h=e.bootstrapperUrl,p=e.resources,d=Object(s.useRef)(null),v=Object(s.useState)(function(){return ca({redeemDialogHandleRef:d,diagnostics:a,viewParams:l,item:n,resourceScope:p,wacDataSource:c,vault:r})}),m=v[0],y=v[1],w=Object(s.useCallback)(function(e){window.WacConfig.Mode=e.NewMode;Object(u.t)({Mode:window.WacConfig.Mode||window.WacConfig.OriginalMode});y(function(t){return Object(i.__assign)(Object(i.__assign)({},t),{Mode:e.NewMode})})},[y]),E=function(e){if(e){e.bootState&&a.update({bootState:e.bootState});(function(e,t){var n,r=e.resultType,i=e.resultCode,s=e.errorInfo,o=e.error;new g.e({name:"".concat(ma()?"COB":"ODC",".Wac.Init"),startTimeOverride:null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.hostInitializeCallTime}).end({resultType:r,resultCode:i,error:s,extraData:{error:o?JSON.stringify(o):""}})})(e,a);(function(e,t){var n=e.resultType,r=e.resultCode,i=e.errorInfo,s=e.error,o=window.WacConfig,u=o.Unified,a=window.Flight;new jt.e({scenario:"DocOpenODC",extraData:{clientId:null==u?void 0:u.WacApplication}}).end({resultType:n,errorCode:r,extraData:{HostSessionId:null==u?void 0:u.HostSessionId,FileSize:null==u?void 0:u.FileSize,errorInfo:i,error:s?JSON.stringify(s):"",action:o.Mode||o.OriginalMode,session:a.session,xid:a.xid}})})(e)}},S=Object(s.useState)(function(){var e,t=window.WacConfig,n=t.Unified,r=window.Flight,i=ma(),s=new f.t(n.ApplicationUrl),o=void 0;i&&s&&(o=decodeURIComponent(s.getQueryParameter("sc")));return{UseV2:!!t.BootWithJsApiV2,UserId:n.UserId,SessionContext:o,MigrationState:i,HostName:n.HostName,HostSessionId:n.HostSessionId,OwnerId:n.OwnerId,AppEnabled:n.AppEnabled,capabilities:{isFeatureEnabled:function(e){return!(!n||!n.HostFlights)&&!!n.HostFlights[e]},customAuthConfig:!!(null===(e=r.Ramps)||void 0===e?void 0:e.WacSupportCustomAuthConfig),commonFilePicker:Lt(ce.jo),moveToFolder:Lt(ce.Fo)},BootstrapperUrl:n.WacBootstrapperUrl,Application:n.WacApplication,ApplicationUrl:n.ApplicationUrl,FileName:n.FileName,FileGetUrl:n.FileGetUrl,FileGetUrlExpiry:n.FileGetUrlExpiry,FileSize:n.FileSize,ETag:n.ETag,UniqueId:n.ResourceId,WopiSrc:n.WopiSrc,AccessToken:n.AccessToken,AccessTokenExpiry:n.AccessTokenExpiry,ReadOnly:n.ReadOnly,ViewOnly:n.ViewOnly,onModeSwitched:w,triggerLogEvent:E}})[0],x=Object(s.useState)(ra.Initial),C=x[0],k=x[1],L=Object(s.useState)(function(){return new T})[0],A=Object(s.useCallback)(function(e){e.state?L.respond({MessageId:N.t.App_PopState,Values:{Url:window.location.href,State:e.state},CorrelationId:qe.e.generate()}):window.history&&window.history.back()},[L]);Object(s.useEffect)(function(){window.addEventListener("popstate",A);return function(){window.removeEventListener("popstate",A)}},[L]);Object(s.useEffect)(function(){(function(){Object(i.__awaiter)(this,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:e.trys.push([0,2,,3]);if(C!==ra.Initial)return[2];k(ra.Loading);a.update({officeBootstrapperStartTime:Date.now()});return[4,b(h,E)];case 1:e.sent();a.update({officeBootstrapperEndTime:Date.now()});k(ra.Loaded);return[3,3];case 2:e.sent();a.update({officeBootstrapperEndTime:Date.now()});k(ra.Failed);return[2];case 3:return[2]}})})})()},[C,h,a]);var O=(function(){var e,t,n,r,i=window.WacConfig;return(null===(r=null===(t=null===(e=window.Microsoft)||void 0===e?void 0:e.Office)||void 0===t?void 0:t[null===(n=null==i?void 0:i.Unified)||void 0===n?void 0:n.WacApplication])||void 0===r?void 0:r.EventIds)||{}})();return s.createElement(Q.e,{resources:p},s.createElement(ht,{diagnostics:a},s.createElement(vt.e,{dispatcher:L},C===ra.Loaded?s.createElement(dt,{bootstrapParams:S,onSucceed:function(){var e,n,r,i,u;window.g_WACDone=!0;if(!(null==l?void 0:l.disableQuotaWarning)&&(null===(e=window.WacConfig)||void 0===e?void 0:e.IsOverQuota)){var f=null===(n=window.WacConfig)||void 0===n?void 0:n.Unified,c=f.OwnerId,h=f.UserId;(function(e,t,n,r){var i="wac-quota-dialog",u=document.getElementById(i);if(!u){(u=document.createElement("div")).id=i;document.body.append(u)}o.render(s.createElement(Qu,{fileSize:e,wacType:r,resources:t,isUserFileOwner:n}),u)})(null===(r=window.WacConfig.Unified)||void 0===r?void 0:r.FileSize,p,c===h,null===(u=null===(i=window.WacConfig.Unified)||void 0===i?void 0:i.WacApplication)||void 0===u?void 0:u.toLowerCase())}t.end({resultType:g.t.Success,resultCode:"WacApplication bootstrap succeed",extraData:{diagnostics:m.diagnostics.data}});(function(e){var t,n,r,i;if(!Lt(Ct.WacSendPerformanceLog))return;if(!(null==e?void 0:e.data))return;var s,o=window.WacConfig,u=e.data;if(u.userClickTime)s=u.userClickTime;else{if(!u.hostPageNavigationStartTime)return;s=u.hostPageNavigationStartTime}var a="".concat(ma()?"COB":"ODC",".Wac.Perf"),f=function(e,t){new g.e({name:"".concat(a,".").concat(e),startTimeOverride:Date.now()-(t-s)}).end({resultType:g.t.Success,resultCode:"Success",extraData:{userClickTime:u.userClickTime,hostPageNavigationStartTime:u.hostPageNavigationStartTime,ServerStartTime:o.ServerStartTime?Number(o.ServerStartTime):void 0,name:e,time:t}})};u.userClickTime&&f("userClickTime",u.userClickTime);u.hostPageNavigationStartTime&&f("hostPageNavigationStartTime",u.hostPageNavigationStartTime);u.hostPageFirstFlushTime&&f("hostPageFirstFlushTime",u.hostPageFirstFlushTime);u.officeBootstrapperStartTime&&f("officeBootstrapperStartTime",u.officeBootstrapperStartTime);u.officeBootstrapperEndTime&&f("officeBootstrapperEndTime",u.officeBootstrapperEndTime);u.officeInitializationTime&&f("officeInitializationTime",u.officeInitializationTime);(null===(t=u.wacAppDiagnostics)||void 0===t?void 0:t.documentLoadedTime)&&f("documentLoadedTime",null===(n=u.wacAppDiagnostics)||void 0===n?void 0:n.documentLoadedTime);(null===(r=u.wacAppDiagnostics)||void 0===r?void 0:r.appCompletedTime)&&f("appCompletedTime",null===(i=u.wacAppDiagnostics)||void 0===i?void 0:i.appCompletedTime);u.wacHostCompleteTime&&f("wacHostCompleteTime",u.wacHostCompleteTime);if(!u.serverStartTime)return;s=u.serverStartTime;u.serverStartTime&&f("serverStartTime",u.serverStartTime);u.pageTaskCompleteTime&&f("pageTaskCompleteTime",u.pageTaskCompleteTime);u.responseCompleteTime&&f("responseCompleteTime",u.responseCompleteTime)})(a)},onFailed:function(){window.g_WACDone=!1;t.end({resultType:g.t.Failure,resultCode:"WacApplication bootstrap failed",extraData:{diagnostics:m.diagnostics.data}})}}):null,s.createElement(Gu,{redeemDialogHandleRef:d,callerCid:m.callerCid,item:n,signInUrl:m.SignInUrl,autoRedeemSignOut:m.autoRedeemSignOut,autoRedeemUrl:m.autoRedeemUrl,authKey:m.authKey}),s.createElement(bt.e,{eventType:O.UserAccessAndPermissions},s.createElement($u,Object(i.__assign)({itemName:n.name,listItemId:n.id},m.shareDialog))),s.createElement(mt,{eventType:O.SetOverlayContent,handler:Du,context:m}),s.createElement(mt,{eventType:O.CopyAndEdit,handler:Pu,context:m}),s.createElement(mt,{eventType:O.Edit,handler:Pu,context:m}),s.createElement(mt,{eventType:O.GetDavUrlFromIds,handler:Hu,context:m}),s.createElement(mt,{eventType:O.UserEditActivity,handler:Bu,context:m}),s.createElement(bt.e,{eventType:O.FileEmbed},s.createElement(Ku,{item:m.item})),s.createElement(mt,{eventType:O.GetCustomAuthConfig,handler:ju,context:m}),s.createElement(mt,{eventType:O.RefreshSessionInfo,handler:Fu,context:m}),s.createElement(mt,{eventType:O.FileRenamed,handler:Iu,context:m}),s.createElement(bt.e,{eventType:O.Share},s.createElement(Ju,Object(i.__assign)({itemName:n.name,listItemId:n.id},m.shareDialog))),Lt(ce.Fo)?s.createElement(bt.e,{eventType:O.MoveToFolder},s.createElement(ta,{item:n})):null,Lt(ce.jo)?s.createElement(bt.e,{eventType:O.SharedFilePicker},s.createElement(ea,{item:n})):null,s.createElement(mt,{eventType:O.SignIn,handler:qu,context:m}),s.createElement(mt,{eventType:O.UserActivity,handler:Ru,context:m}),s.createElement(mt,{eventType:O.FileVersions,handler:Wu,context:m}),s.createElement(mt,{eventType:O.GetWopiInfoFromUrl,handler:Uu,context:m}),s.createElement(mt,{eventType:O.UI_Close,handler:Xu,context:m}),s.createElement(va,{context:m,updateWacAppMode:w}))),s.createElement(I,{vault:r,dispatcher:L}))}function pa(e){var t=e.item,n=e.vault,r=e.diagnostics,o=e.viewParams,u=e.wacDataSource,a=e.applicationUrl,f=e.applicationParams,l=e.resources,c=Object(s.useRef)(null),h=Object(s.useState)(function(){return ca({redeemDialogHandleRef:c,diagnostics:r,viewParams:o,item:t,resourceScope:l,wacDataSource:u,vault:n})}),p=h[0],d=h[1],v=Object(s.useCallback)(function(e){d(function(t){return Object(i.__assign)(Object(i.__assign)({},t),{Mode:e.NewMode})})},[d]),m=Object(s.useState)(function(){return new T})[0],g=Object(s.useCallback)(function(e){e.state?m.respond({MessageId:N.t.App_PopState,Values:{Url:window.location.href,State:e.state},CorrelationId:qe.e.generate()}):window.history&&window.history.back()},[m]);Object(s.useEffect)(function(){window.addEventListener("popstate",g);return function(){window.removeEventListener("popstate",g)}},[m]);return s.createElement(Q.e,{resources:l},s.createElement(ht,{diagnostics:r},s.createElement(vt.e,{dispatcher:m},s.createElement(Yu,{applicationUrl:a,params:f,migrationState:ma()}),s.createElement(Gu,{redeemDialogHandleRef:c,callerCid:p.callerCid,item:t,signInUrl:p.SignInUrl,autoRedeemSignOut:p.autoRedeemSignOut,autoRedeemUrl:p.autoRedeemUrl,authKey:p.authKey}),s.createElement(va,{context:p,updateWacAppMode:v}))),s.createElement(I,{vault:n,dispatcher:m}))}function da(e){var t=e.token,n=e.diagnostics,r=e.wacDataSource,o=e.viewParams,u=e.migration,a=e.resources,f=Object(s.useRef)(null),l=Object(s.useState)(function(){return ca({redeemDialogHandleRef:f,diagnostics:n,viewParams:o,resourceScope:a,wacDataSource:r})}),c=l[0],h=l[1],p=Object(s.useCallback)(function(e){h(function(t){return Object(i.__assign)(Object(i.__assign)({},t),{Mode:e.NewMode})})},[h]),d=Object(s.useState)(function(){return new T})[0],v=Object(s.useCallback)(function(e){e.state?d.respond({MessageId:N.t.App_PopState,Values:{Url:window.location.href,State:e.state},CorrelationId:qe.e.generate()}):window.history&&window.history.back()},[d]);Object(s.useEffect)(function(){window.addEventListener("popstate",v);return function(){window.removeEventListener("popstate",v)}},[d]);var m=Object(s.useCallback)(function(e){if(e){var t=e.page,n=e.item,r=e.wopiContext;n.id="".concat(u.hcid,"!s").concat(n.id.slice(1,-1).replace(/-/g,""));var s=t.title,o=t.faviconLink,a=t.queryUrl;s&&(document.title=s);if(o){var f=document.head.querySelector('link[rel="icon"]');if(null!==f)f.href=o;else{(f=document.createElement("link")).rel="icon";f.href=o;f.type="image/x-icon";document.head.appendChild(f)}}if(a){-1===a.indexOf("?cid=")&&-1===a.indexOf("&cid=")&&(a+="&cid="+u.hcid);var l=location.href.substring(0,location.href.indexOf(location.search)+1);window.history.replaceState({},"",l+a)}new g.e({name:"Convergence.WacOpen"}).end({resultType:g.t.Success,resultCode:"Success",error:""});h(function(e){return Object(i.__assign)(Object(i.__assign)({},e),{item:Object(i.__assign)(Object(i.__assign)({},n),{graph:{itemId:n.id,driveId:Object(Ot.e)(u.hcid)}}),wacIframeDomain:r.WebAppUrl})})}},[h,u.hcid]);return s.createElement(Q.e,{resources:a},s.createElement(vt.e,{dispatcher:d},t.accessToken?s.createElement(Zu,{docAspxUrl:u.DocAspxUrl,token:t}):null,c.item?s.createElement(Gu,{redeemDialogHandleRef:f,callerCid:c.callerCid,item:c.item,signInUrl:c.SignInUrl,autoRedeemSignOut:c.autoRedeemSignOut,autoRedeemUrl:c.autoRedeemUrl,authKey:c.authKey}):null,s.createElement(mt,{eventType:gt.COB_SyncPageContext,handler:m,context:c}),s.createElement(va,{context:c,updateWacAppMode:p})))}function va(e){var t=e.context,n=e.updateWacAppMode;if(!t.item)return null;var r=t.item;return s.createElement(s.Fragment,null,s.createElement(bt.e,{eventType:N.e.UI_CheckUserAccessAndGrantPermissions},s.createElement($u,Object(i.__assign)({itemName:r.name,listItemId:r.id},t.shareDialog))),s.createElement(mt,{eventType:N.e.SetOverlayContent,handler:Du,context:t}),s.createElement(mt,{eventType:N.e.App_LoadingStatus,handler:_u,context:t}),s.createElement(mt,{eventType:N.e.UI_CopyAndEdit,handler:Pu,context:t}),s.createElement(mt,{eventType:N.e.App_WopiDavUrlFromIds,handler:Hu,context:t}),s.createElement(mt,{eventType:N.e.App_WopiInfoFromUrl,handler:Uu,context:t}),s.createElement(mt,{eventType:N.e.Edit_Notification,handler:Bu,context:t}),s.createElement(bt.e,{eventType:N.e.UI_FileEmbed},s.createElement(Ku,{item:t.item})),s.createElement(mt,{eventType:N.e.App_GetCustomAuthConfig,handler:ju,context:t}),s.createElement(mt,{eventType:N.e.App_RefreshSessionInfo,handler:Fu,context:t}),s.createElement(mt,{eventType:N.e.File_Rename,handler:Iu,context:t}),s.createElement(bt.e,{eventType:N.e.UI_Sharing},s.createElement(Ju,Object(i.__assign)({itemName:r.name,listItemId:r.id},t.shareDialog))),Lt(ce.Fo)?s.createElement(bt.e,{eventType:N.e.App_MoveToFolder},s.createElement(ta,{item:r})):null,Lt(ce.jo)?s.createElement(bt.e,{eventType:N.e.App_FilePicker},s.createElement(ea,{item:r})):null,s.createElement(mt,{eventType:N.e.UI_SignIn,handler:qu,context:t}),s.createElement(mt,{eventType:N.e.User_Activity,handler:Ru,context:t}),s.createElement(mt,{eventType:N.e.UI_FileVersions,handler:Wu,context:t}),s.createElement(mt,{eventType:N.e.UI_FileProperties,handler:zu,context:t}),s.createElement(mt,{eventType:N.e.App_PushState,handler:Vu,context:t}),s.createElement(mt,{eventType:N.e.App_SwitchMode,handler:n,context:t}))}function ma(){var e=window.WacConfig;return!!e&&(!!e.MigrationState||!!e.Migration)}function ga(e,t){return(function(e){if(!ma())return e;if(!Me.e.isActivated("F1ECDFC1-79AA-4298-BF16-D19171FA771C","3/8/2023","KillSwitch to Update Language Param from mkt")&&$Config.mkt){var t=new f.t(e);t.setQueryParameter("ui",$Config.mkt,!0);t.setQueryParameter("rs",$Config.mkt,!0);return t.toString()}return e})((function(e){if(!ma())return e;try{var t=new f.t(e),n=JSON.parse(t.getQueryParameter("sc"));n=n?Object(i.__assign)(Object(i.__assign)({},n),{pmo:n.pmo||ia}):{pmo:ia};t.setQueryParameter("sc",encodeURIComponent(JSON.stringify(n)),!0);return t.toString()}catch(t){Object(x.e)("can not add sessionContext: ",t);return e}})((function(e,t){if(!ma())return e;if(0===t){var n=new f.t(e);n.setQueryParameter("new","1",!0);return n.toString()}return e})(e,t)))}function ya(){window.location.href="https://onedrive.live.com/error.html"}(function(){var e,t,r,l,c,h,p,d,g;Object(i.__awaiter)(this,void 0,void 0,function(){var y,b,w,E,S,T,N,C,k,L,A,O,_,D,P,H,B,j,F,I,q,R,U,Q,Y,Z,ee,ne,re,se,oe;return Object(i.__generator)(this,function(i){switch(i.label){case 0:i.trys.push([0,14,,15]);y=window.WacConfig;b=(function(){var e,t=fa();e=t?new m(t.entryPoint,t.clickTime):new m;var n=window.$Config,r=window.WacConfig;e.update({serverStartTime:(null==r?void 0:r.ServerStartTime)?Number(null==r?void 0:r.ServerStartTime):void 0,pageTaskCompleteTime:(null==r?void 0:r.WacPageTaskCompleteTime)?Number(null==r?void 0:r.WacPageTaskCompleteTime):void 0,responseStartTime:n.pageResponseStartTime?Number(n.pageResponseStartTime):void 0,responseCompleteTime:n.pageResponseCompleteTime?Number(n.pageResponseCompleteTime):void 0,hostPageFirstFlushTime:Date.now()});if(window.performance&&window.performance.timing){var i=window.performance.timing;e.update({hostPageFetchStartTime:i.fetchStart,hostPageNavigationStartTime:i.navigationStart})}return e})();if(window.history&&window.history.replaceState){w=window.location.href.replace(/&(wdo|wdfre)=\d+/gi,"");window.history.replaceState(null,document.title,w)}(function(e){e.expose(W.e,new a.e);e.expose(_r.S,_n.observable({}));e.expose(V.F,new(e.injected(at)));e.expose(G.m,new(e.injected(Ge.e)));e.exposeFactory(V.h,new X.e(J.e));e.expose($.n,new(e.injected(K.e)));e.exposeFactory(V.B,new X.e($.n));var t=new(e.injected(te));e.expose(V.l,t);e.expose(V.m,t);e.expose(V.r,t);e.expose(V.N,t);e.expose($.e,t);e.expose(G.v,new(e.injected(ie)));e.expose(V.p,new(e.injected(De)));e.expose(G.i,new(e.injected(Qe)));e.expose(V.D,new(e.injected(Mu)));e.expose(Wt.e,new(e.injected(zt.e)));e.expose(G.h,new(e.injected(Ut)));e.expose(_r.e,new Nu);e.exposeAsync(V.c,new X.t(function(){return n.ee([149],1587).then(function(e){return e.resourceKey})}));e.expose(Cu.e,e);e.expose(V.s,new(e.injected(Nt)));e.expose(G.t,new(e.injected(lt)))})(z.e);E=new a.e;S=E.viewParams;T=Object(wt.r)({apiVersion:"v1.0",driveId:(null===(e=y.viewParams)||void 0===e?void 0:e.cid)||(null==S?void 0:S.cid)||(null===(t=y.Migration)||void 0===t?void 0:t.hcid),includeViewerId:!1,migrationState:ma()});N=z.e.consume(V.h);C=N.getIdentity().type===ue.e.anonymous;k=void 0;L=void 0;if(!(S&&S.redeem&&ma()))return[3,8];i.label=1;case 1:i.trys.push([1,7,,8]);return C?[4,ua()]:[3,3];case 2:k=i.sent();return[3,5];case 3:return[4,N.getSessionToken()];case 4:L=i.sent();i.label=5;case 5:return[4,aa(k,L,S.redeem)];case 6:(null==(A=i.sent())?void 0:A.error)&&(function(e,t){var n;if(e&&e.innerError&&"sharingPasswordRequired"===e.innerError.code)if(0===(null===(n=e["@error.fixItUrl"])||void 0===n?void 0:n.indexOf(ia)))window.location.href=e["@error.fixItUrl"];else{var r=new f.t(ia);r.setQueryParameter("v","validatepermission",!0);r.setQueryParameter("redeem",null==t?void 0:t.redeem,!0);r.setQueryParameter("migratedtospo","true",!0);r.setQueryParameter("cid",null==t?void 0:t.cid,!0);r.setQueryParameter("id",null==t?void 0:t.resid,!0);r.setQueryParameter("ithint",null==t?void 0:t.ithint,!0);window.location.href=r.toString()}})(A.error,S);return[3,8];case 7:O=i.sent();Object(x.e)("can not acquire badger token or session token, can not complete redeem operation: ",O);ya();return[2];case 8:_=new M(T,N,k);(D=document.createElement("div")).id="app";document.body.append(D);if(!y.Migration)return[3,12];if(!k)return[3,9];H={accessToken:k.token,isBadger:!0};return[3,11];case 9:return[4,N.getSessionToken()];case 10:H=i.sent();i.label=11;case 11:P=H;o.render(s.createElement(da,{diagnostics:b,token:P,wacDataSource:_,viewParams:S,authSessionId:$Config.authSessionId,email:$Config.email,migration:y.Migration,resources:z.e}),D);return[2];case 12:return[4,oa(_,S,b)];case 13:if(!(B=i.sent())){ya();return[2]}j=void 0;j=C?Bt.e.ConsumerAnonymous:Object(It.e)($Config.hcid)?Bt.e.ConsumerOnSPO:Bt.e.Consumer;Object(u.t)({ClientName:"WacHost.".concat(null===(r=y.Unified)||void 0===r?void 0:r.WacApplication),Application:y.Application,Mode:y.Mode||y.OriginalMode,OriginalMode:y.OriginalMode,AccountType:Bt.e[j]});F=(function(e){var t=Object(Pt.getAriaInfo)(),r=t.ariaEnvironment,i=t.version,s=t.ariaContext,o=e.clientName;if(r&&"dev"!==i||Object(ce.qo)(ce.hn)){var u=Object(_t.getCustomerPromiseHandler)({clientName:o,ariaEnvironment:r,ariaContext:s,ariaLoader:function(){return n.ee(1,1628,7)},disableCookies:s.disableCookies,tenantToken:"prod"===r?Dt.ODCTenantTokens.prod:Dt.ODCTenantTokens.ppe});u.attach(Object(Mt.e)());return u}return null})({clientName:null===(l=y.Unified)||void 0===l?void 0:l.WacApplication});(null===(c=y.Unified)||void 0===c?void 0:c.HostSessionId)&&F&&F.updateContext({customerPromiseSessionId:null===(h=y.Unified)||void 0===h?void 0:h.HostSessionId,accountType:Bt.e[j]});I=!!B.vault;q=I?new v($Config.unid,_):void 0;R=null===(p=y.Unified)||void 0===p?void 0:p.WacBootstrapperUrl;if(!y.UseUnifiedApps||!y.Unified){if(ma()){U=null===(g=null===(d=B.itemFromServer)||void 0===d?void 0:d.openWith)||void 0===g?void 0:g.wac;Z=ga(U.applicationUrl,B.size);(Q={}).access_token=U.accessToken;Q.access_token_ttl=U.accessTokenExpiry;Q.owner_id=B.ownerId;Q.user_id=$Config.hcid;y.Legacy={Url:Z,Params:Q}}if(!y.Legacy){Y="Edit"===y.OriginalMode;Z=Y?B.urls.wacIframeEdit:B.urls.wacIframeView;ee={};null==(ne=Y?B.urls.wacIframeEditPostParameters:B.urls.wacIframeViewPostParameters)||ne.split("&").forEach(function(e){var t=e.split("=");ee[decodeURIComponent(t[0])]=decodeURIComponent(t[1])});y.Legacy={Url:Z,Params:ee}}re=y.Legacy.Url;se=y.Legacy.Params;o.render(s.createElement(pa,{item:B,vault:q,viewParams:S,wacDataSource:_,diagnostics:b,resources:z.e,applicationUrl:re,applicationParams:se}),D);return[2]}o.render(s.createElement(ha,{item:B,vault:q,viewParams:S,wacDataSource:_,bootstrapperUrl:R,diagnostics:b,resources:z.e}),D);return[3,15];case 14:oe=i.sent();Object(x.e)("error when rendering app: ",oe);return[2];case 15:return[2]}})})})()}]));define("ODCWacHostWebpack",[],{});