/*
 @license DOMPurify 2.4.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.1/LICENSE */
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[3],{1031:function(K,U,d){d.r(U);K=d(0);var h=d(77),e=d(47),r=d(93),m=d(67),n=d(27),z=d(1243),v=d(7),x=d(18),B=d(87),D=d(312),w=d(28),J=d(33);class G{constructor(Wa){this.ApiType=0;this.ApiType=Wa}}Object(K.a)(G,"SlideshowApiMessage",null,[]);class M extends G{constructor(){super(14);this.TopValue="0%";this.HeightValue="100%"}}Object(K.a)(M,"DockSlideshowViewMessage",G,[]);class N extends G{constructor(){super(6);
this.AnimStep=this.SlideIndex=0}}Object(K.a)(N,"GoToSlideApiMessage",G,[]);class R extends G{constructor(){super(16);this.SlideIndex=0;this.TimeLineMappings=null}}Object(K.a)(R,"GoToSlideWithTimeLinesApiMessage",G,[]);class C extends G{constructor(){super(19);this.Color=this.Item=null}}Object(K.a)(C,"InkManagerMessage",G,[]);class O{constructor(Wa){this.IH=Wa.origin;this.XZg=Wa.source;this.Qva=Wa.data}}Object(K.a)(O,"MessageEvent",null,[]);var S=d(957),T=d(955),ca=d(958),L=d(959);class da extends Sys.EventArgs{constructor(Wa){super();
this.pcc=Wa.IsStartTranscription;this.fw=Wa.SubtitlesPosition}}Object(K.a)(da,"OnLiveSubtitlesDockedViewEventArgs",Sys.EventArgs,[]);class Z extends Sys.EventArgs{constructor(Wa){super();this.Xx=Wa.SessionTelemetry}}Object(K.a)(Z,"OnLogEndOfTranscriptionSessionEventArgs",Sys.EventArgs,[]);var fa=d(962),aa=d(963),ja=d(960);class I extends Sys.EventArgs{constructor(Wa,Hb){super();this.HSj=Wa;this.category=Hb.Category;this.code=Hb.Code;this.message=Hb.Message;this.py=Hb.ExtraInfo;this.correlationId=
Hb.CorrelationId;this.sessionId=Hb.SessionId}}Object(K.a)(I,"OnSlideshowErrorEventArgs",Sys.EventArgs,[]);var sa=d(956);class ka extends Sys.EventArgs{constructor(Wa){super();this.isFinal=Wa.IsFinal;this.vJh=Wa.Transcripts}}Object(K.a)(ka,"OnSubtitleUpdatedEventArgs",Sys.EventArgs,[]);var Ma=d(964),Ea=d(961);class ma extends Sys.EventArgs{constructor(Wa){super();this.errorName=Wa.ErrorName;this.vetoName=Wa.VetoName;this.isIntentional=Wa.IsIntentional;this.isInternal=Wa.IsInternal;this.alertOnPillar=
Wa.AlertOnPillar;this.isSessionEndingError=Wa.IsSessionEndingError;this.durationMs=Wa.DurationMs}}Object(K.a)(ma,"RecordQosErrorEventArgs",Sys.EventArgs,[]);class va extends G{constructor(){super(11);this.StartSlideShowTime=0}}Object(K.a)(va,"RecordStartedSlideShowTimestampApiMessage",G,[]);class Ca extends G{constructor(){super(7);this.WacCluster=this.PodSessionId=null}}Object(K.a)(Ca,"RefreshPodSessionApiMessage",G,[]);class oa extends G{constructor(){super(21);this.IsMute=!1}}Object(K.a)(oa,"SetMicrophoneStateMessage",
G,[]);class Da extends G{constructor(){super(12);this.OsfLocalStorageData=null}}Object(K.a)(Da,"SetOsfLocalStorageApiMessage",G,[]);class ta{constructor(){this.pcc=this.vpg=!1;this.fw=null}}Object(K.a)(ta,"SlideShowViewDockingState",null,[]);var ha=d(1034);class Ha extends G{constructor(){super(0);this.SlideIndex=this.SlideId=0;this.WacCluster=this.Endpoint=this.PodSessionId=this.WacUserSessionId=this.UserId=null;this.FPrerenderSS=!1;this.PrerenderCid=null;this.SlideShowClickTime=0;this.EndSlideShowText=
null;this.FSupportSVGInWebGL="0";this.HostSupportsSessionRefreshEnabled=!1;this.RenderShapeBuilder="0";this.CustomTransitionResourceUrl=this.DisabledTransitionsList=this.VetoAppSettingsStr=this.FileHost=null;this.StreamVideoUseThinEmbed=!1;this.DisabledChangeGates=null;this.AllowExternalMarketplace=this.AreThirdPartyAddInsAllowed=!1}}Object(K.a)(Ha,"StartSlideShowApiMessage",G,[]);class bb extends G{constructor(){super(13);this.IsToggleOn=!1;this.PragueSessionInfo=""}}Object(K.a)(bb,"ToggleTranscriberLiveBroadcastModeMessage",
G,[]);class Na extends G{constructor(){super(18);this.HideUI=!1}}Object(K.a)(Na,"ToggleTranscriberUIVisibilityMessage",G,[]);class Ia extends G{constructor(){super(8);this.SubtitlesResourceStr=this.SubtitlesContextStr=this.SubtitlesAppSettingsStr=null;this.MicrophoneDeviceId=this.LiveBroadcastContextStr=this.RehearsalContextStr=""}}Object(K.a)(Ia,"TranscribeApiMessage",G,[]);var Qa=d(69);d.d(U,"SlideshowFrame",function(){return qa});class qa{constructor(Wa,Hb,jc,gc,$b,wb,Db,Xb){this.jb=this.yYa=this.xYa=
this.awa=null;this.xa=new h.a;this.qHa=null;this.nGe=this.a_g=!1;this.tf=Hb;this.la=jc;this.Hc=gc;this.Ub=$b;this.xO=wb;this.Xl=Db;this.HDb=Xb;this.Gkk=new z.a(Object(v.a)(Wa,Wa.Xqi,"browserSupportsRenderingSVGInWebGL"))}init(Wa,Hb,jc){if(!this.jb){this.awa=document.getElementById("HiddenFocusTrapAnchor");this.jb=document.createElement("iframe");this.jb.id="SlideShowHostFrame";this.jb.className="SlideShowHostFrame";this.jb.style.display=Qa.a.Pe;this.jb.setAttribute("allow","microphone; autoplay");
this.qHa=new ta;jc=this.la.isHermesSlideShowPreloadEnabled?String.format("EndSlideShowText={0}&UserSessionId={1}&WacCluster={2}",e.a.Qe(ResourceStrings.l_EndOfSlideShowMessage),e.a.Qe(jc),e.a.Qe(Hb)):"";jc+=String.format(jc?"&HostSupportsSessionRefreshEnabled={0}":"HostSupportsSessionRefreshEnabled={0}",e.a.Qe(this.la.hostSupportsSessionRefreshEnabled.toString()));jc+=String.format(jc?"&InkingEnabled={0}":"InkingEnabled={0}",e.a.Qe(this.la.isInkingInSlideShowEnabled.toString()));jc+=String.format(jc?
"&VideoThruTransparentCanvas={0}":"VideoThruTransparentCanvas={0}",e.a.Qe(this.la.b6j.toString()));jc+=String.format(jc?"&IsFlipgridVideoEnabled={0}":"IsFlipgridVideoEnabled={0}",e.a.Qe(this.la.ecb.toString()));jc+=String.format(jc?"&IsTEDVideoEnabled={0}":"IsTEDVideoEnabled={0}",e.a.Qe(this.la.VBb.toString()));jc+=String.format(jc?"&IsAllowExternalMarketplace={0}":"IsAllowExternalMarketplace={0}",e.a.Qe(this.la.g0c.toString()));jc+=String.format(jc?"&IsNewSlideShowToolbarEnabled={0}":"IsNewSlideShowToolbarEnabled={0}",
e.a.Qe(this.la.tbc.toString()));jc+=String.format("&ImageCachingEnabled={0}",e.a.Qe(this.la.Eyl.toString()));jc+=String.format("&PodSlideshowEnableTabLoopFix={0}",e.a.Qe(this.la.TOk.toString()));jc+=String.format("&PodsLoadSlideShowFrameFromCdn={0}",e.a.Qe(this.la.podsLoadSlideShowFrameFromCdn.toString()));jc+=String.format("&PodsBase={0}",e.a.Qe(this.la.podsWebServiceBase));var gc=this.la.Caa;this.la.fWa&&(gc=new D.a(gc),gc.oxc=this.la.fWa,gc.utc=this.la.mzh,gc.ttc=this.la.lzh,gc=gc.toString());
var $b=this.la.podsLoadSlideShowFrameFromCdn&&!e.a.Xa(this.la.podsBaseSlideShowFramePath);this.jb.src=$b?this.la.podsBaseSlideShowFramePath:"./SlideShowFrame.html";this.jb.src=String.format(this.jb.src+"?Version={0}&WacCluster={1}&BootJS={2}&{3}={4}",Wa,e.a.Qe(Hb),e.a.Qe(this.la.pptEditorSlideShowWrsEndpoint),B.a.Wnc,gc);w.a.J(512495881,830,50,String.format("LoadFromCdn {0}, IsTranscriberEnabled {1}",$b,this.la.Tla));if(this.la.Tla||this.la.Bcc)this.jb.src=String.format(this.jb.src+"&TranscriberJS={0}&ClientAudioMessageJS={1}&SpeechResultMessageJS={2}&TranscriberURI={3}",
e.a.Qe(this.la.pptEditorTranscriberJsUri),e.a.Qe(this.la.pptEditorTransciberClientAudioMessageJsUri),e.a.Qe(this.la.pptEditorTransciberSpeechResultMessageJsUri),e.a.Qe(this.la.pptEditorSpeechHandlerBaseUri)),this.jb.src=String.format(this.jb.src+"&SpeechResponseMessageJS={0}",e.a.Qe(this.la.pptEditorTranscriberSpeechResponseMessageJsUri)),e.a.rg(this.la.pptEditorTranscriberQualityStatusMessageJsUri).endsWith("qualitystatusmessage.js")&&(this.jb.src=String.format(this.jb.src+"&QualityStatusMessageJS={0}",
e.a.Qe(this.la.pptEditorTranscriberQualityStatusMessageJsUri))),this.la.Bcc&&e.a.rg(this.la.pptEditorTranscriberRehearsalResultMessageJsUri).endsWith("rehearsalresultmessage.js")&&(this.jb.src=String.format(this.jb.src+"&RehearsalResultMessageJS={0}",e.a.Qe(this.la.pptEditorTranscriberRehearsalResultMessageJsUri))),this.la.pptEditorTranscriberLiveAgentEnabled&&e.a.rg(this.la.pptEditorTranscriberAgentCommandMessageJsUri).endsWith("agentcommandmessage.js")&&(this.jb.src=String.format(this.jb.src+"&AgentCommandMessageJS={0}",
e.a.Qe(this.la.pptEditorTranscriberAgentCommandMessageJsUri)));this.la.powerPointLiveBroadcastEnabled&&(this.jb.src+="&wdLiveBroadcast=true");this.jb.src=String.format(this.jb.src+"#{0}",jc);J.a("PresenterCoachTabFix")&&this.awa?this.tf.insertBefore(this.jb,this.awa):this.tf.appendChild(this.jb);r.a.addHandler(window,m.a.message,Object(v.a)(this,this.aIk,"onSlideshowMessage"));this.Hc.Swb&&this.la.bmd&&this.m$j();J.a("PresenterCoachTabFix")&&(this.xYa=document.getElementById("legacySlideshowBeginningFocusTrap"),
this.yYa=document.getElementById("legacySlideshowEndFocusTrap"),this.xYa||this.yYa||(this.xYa=document.createElement("div"),this.xYa.id="legacySlideshowBeginningFocusTrap",this.xYa.className="FocusTrap",this.xYa.tabIndex=0,r.a.addHandler(this.xYa,m.a.focus,Object(v.a)(this,this.gnc,"onSlideShowContainerDivFocusHandler")),this.yYa=document.createElement("div"),this.yYa.id="legacySlideshowEndFocusTrap",this.yYa.className="FocusTrap",this.yYa.tabIndex=0,r.a.addHandler(this.yYa,m.a.focus,Object(v.a)(this,
this.gnc,"onSlideShowContainerDivFocusHandler")),this.tf.insertBefore(this.xYa,this.tf.firstChild),this.tf.insertBefore(this.yYa,this.awa.nextSibling)))}}d$a(){return this.la.bmd&&this.nGe}gIk(){w.a.J(512495880,830,50,"SlideShowFrame::OnSpeechClientScriptLoaded Speech client script has been loaded successfully");this.a_g=!0;return null}m$j(){const Wa=new x.a;Wa.add(this.HDb.loadScript("PPTSpeechClient"));Promise.all(Wa.toArray()).then(()=>this.gIk()).catch(Hb=>{w.a.J(512495879,830,10,"SlideShowFrame::LoadSpeechClientResources Failed to load the resources for SlideShowCore: {0}",
Hb)})}Sud(Wa,Hb,jc,gc,$b,wb,Db,Xb,ab){this.qHa=new ta;Db&&w.a.J(512495878,830,50,String.format("Will trigger slideshow bundle rendering, correlation = {0}",Xb));this.sG(Object.assign(new Ha,{WacCluster:jc,PodSessionId:gc,UserId:$b,WacUserSessionId:wb,SlideId:Wa,SlideIndex:Hb,FPrerenderSS:Db,PrerenderCid:Xb,SlideShowClickTime:ab,EndSlideShowText:ResourceStrings.l_EndOfSlideShowMessage,FSupportSVGInWebGL:this.Gkk.value?"1":"0",RenderShapeBuilder:this.la.fWa?"1":"0",FileHost:n.AFrameworkApplication.fa.Ha("FileHost"),
VetoAppSettingsStr:this.Owj(),DisabledTransitionsList:this.la.WMa,CustomTransitionResourceUrl:this.la.fRf,StreamVideoUseThinEmbed:n.AFrameworkApplication.fa.ka("StreamVideoUseThinEmbed"),DisabledChangeGates:n.AFrameworkApplication.fa.Ha("PPTDisabledChangeGates"),AreThirdPartyAddInsAllowed:n.AFrameworkApplication.Qca,AllowExternalMarketplace:n.AFrameworkApplication.fa.ka("51")}))}prev(){this.sG(new G(2))}next(){this.sG(new G(1))}transcribe(Wa,Hb,jc,gc,$b,wb,Db){var Xb=!!this.Ub&&!!this.Ub.instance&&
(this.Ub.instance.gTa||this.Ub.instance.kr);(this.Ub&&this.Ub.instance&&this.Ub.instance.Er&&this.Ub.instance.lEa||Xb)&&!this.Ub.instance.Wwb()?w.a.J(512495877,830,50,"LivePresenter prevented transcriber from starting"):this.d$a()?(ha.a.instance.transcribe(Wa,Hb,jc,gc,$b,wb,Db),this.yQc(this.Hc.Qh&&5!==$b,this.Hc.fw)):(Xb={},Xb.TranslationLanguages=this.la.powerPointLiveBroadcastEnabled?this.la.liveBroadcastTranslationLanguagesOverride:"",Xb.BroadcastSubtitlesFromSpeechFrontDoorForLive=this.la.powerPointLiveBroadcastEnabled?
!0:!1,this.sG(Object.assign(new Ia,{SubtitlesAppSettingsStr:this.Ntj(Wa,jc,Hb,gc,$b,wb),SubtitlesContextStr:this.Hc.pCl,SubtitlesResourceStr:this.Otj(),RehearsalContextStr:Db?Db.U4k:"",LiveBroadcastContextStr:JSON.stringify(Xb),MicrophoneDeviceId:this.xO.microphoneDeviceId})))}setMicrophoneState(Wa){this.d$a()?ha.a.instance.setMicrophoneState(Wa):(this.sG(Object.assign(new oa,{IsMute:Wa})),this.Ub&&this.Ub.instance&&(Wa?this.Ub.instance.gxh():this.Ub.instance.hxh()))}yZe(){}lQb(Wa,Hb=""){this.qHa.vpg=
Wa;w.a.J(512495876,830,50,"Toggling transcriber's Live Broadcast mode ... On: {toggleOn}");this.d$a()?(ha.a.instance.bJh(Wa,Hb),this.yQc(this.Hc.Qh,this.Hc.fw)):this.sG(Object.assign(new bb,{IsToggleOn:Wa,PragueSessionInfo:Hb}));this.P8g()}toggleTranscriberUIVisibility(Wa){w.a.J(512495875,830,50,"Toggling Transcriber UI visibilitye ... On: {showUI}");this.d$a()?(Wa=Wa?Wa?!1:!0:!ha.a.instance.isVisible(),ha.a.instance.setVisibility(Wa),ha.a.instance.BJc(),this.yQc(this.Hc.Qh,this.Hc.fw)):this.sG(Object.assign(new Na,
{HideUI:Wa}))}yQc(Wa,Hb){this.qHa.pcc=Wa;this.qHa.fw=Hb;this.P8g()}setOsfLocalStorage(){const Wa={};let Hb=!1;try{const jc=RegExp("^osfCacheVersion|_?_OSF_.+$");for(let gc=0;gc<localStorage.length;++gc){const $b=localStorage.key(gc);if(jc.test($b)){const wb=localStorage.getItem($b);Wa[$b]=wb;Hb=!0}}}catch(jc){w.a.J(512495874,830,50,"SlideShowFrame::Exception while retrieving OSF Local Storage data: {0}",jc.toString())}Hb&&this.sG(Object.assign(new Da,{OsfLocalStorageData:Wa}))}show(){w.a.J(512495873,
830,50,"SlideShowFrame::Show Making frame visible.");if(this.jb){this.jb.style.display=Qa.a.Rj;var Wa=(new Date).getTime();w.a.J(512495843,830,50,"SlideShowFrame::Show Sending startedSlideShowTimestamp: {0} to SlideShowFrame.html",Wa);this.sG(Object.assign(new va,{StartSlideShowTime:Wa}))}else w.a.J(512495872,830,15,"SlideShowFrame::Show Making frame visible, but m_frame is null.")}jWa(){return this.jb&&this.jb.style.display!==Qa.a.Pe?!0:!1}f9(){return"Legacy"}ewc(Wa){this.jb.style.display=Wa?Qa.a.Rj:
Qa.a.Pe;this.d$a()&&ha.a.instance.setVisibility(Wa&&this.Hc.Qh)}OTc(){w.a.J(512495842,830,50,"SlideShowFrame: Exiting with post message");this.sG(new G(3))}exit(){this.jb.style.display===Qa.a.Pe?this.xa.raiseEvent("OnExit",new T.a({SlideId:0,IsBeforeReady:!0})):(w.a.J(512495841,830,50,"SlideShowFrame: Making frame invisible"),this.jb.style.display=Qa.a.Pe,this.sG(new G(3)));this.d$a()&&ha.a.instance.R3e()}restoreFocus(){this.jb.style.display===Qa.a.Pe||this.kne()||(this.jb.focus(),this.sG(new G(4)))}pausePresentation(){this.sG(new G(15))}G6e(){this.xa.raiseEvent("OnFullscreenClick",
new Sys.EventArgs)}getCurrentPosition(){this.sG(new G(5))}getCurrentPositionWithTimeLines(){this.sG(new G(17))}getCurrentSlideDimensions(){this.sG(new G(20))}zUa(Wa){this.sG(Object.assign(new N,{SlideIndex:Wa,AnimStep:0}))}CPe(Wa){this.sG(Object.assign(new C,{Item:Wa.item,Color:Wa.color}))}dZe(Wa){this.xa.raiseEvent("OnSpecialKey",new sa.a({["Key"]:Wa.keyCode,["ShiftKey"]:Wa.shiftKey}))}vvh(){this.sG(new G(22))}Sdg(Wa,Hb){this.sG(Object.assign(new R,{SlideIndex:Wa,TimeLineMappings:Hb}))}refreshPodSession(Wa,
Hb){this.sG(Object.assign(new Ca,{PodSessionId:Wa,WacCluster:Hb}))}setVisibility(Wa){this.jb.style.visibility=Wa?Qa.a.Oz:Qa.a.Xs}Pga(Wa){this.sG(new G(Wa?9:10));this.d$a()&&ha.a.instance.Pga(Wa)}hJc(Wa){this.xa.addHandler("OnSlideshowReady",Wa)}dpd(Wa){this.xa.removeHandler("OnSlideshowReady",Wa)}fTd(Wa){this.xa.addHandler("OnBrowserEvent",Wa)}uVe(Wa){this.xa.removeHandler("OnBrowserEvent",Wa)}mzf(Wa){this.xa.addHandler("OnFullscreenClick",Wa)}Joh(Wa){this.xa.removeHandler("OnFullscreenClick",Wa)}hTd(Wa){this.xa.addHandler("OnSlideshowContextMenu",
Wa)}wVe(Wa){this.xa.removeHandler("OnSlideshowContextMenu",Wa)}mTd(Wa){this.xa.addHandler("OnPodSessionExpired",Wa)}AVe(Wa){this.xa.removeHandler("OnPodSessionExpired",Wa)}KQa(Wa){this.xa.addHandler("OnPositionChangeEventId",Wa)}dkb(Wa){this.xa.removeHandler("OnPositionChangeEventId",Wa)}ija(Wa){this.xa.addHandler("OnExit",Wa)}yga(Wa){this.xa.removeHandler("OnExit",Wa)}jzf(Wa){this.xa.addHandler("OnSlideshowError",Wa)}Goh(Wa){this.xa.removeHandler("OnSlideshowError",Wa)}C_b(Wa){this.xa.addHandler("OnGetCurrentPosition",
Wa)}ckb(Wa){this.xa.removeHandler("OnGetCurrentPosition",Wa)}dJc(Wa){this.xa.addHandler("OnGetCurrentSlideDimensions",Wa)}bpd(Wa){this.xa.removeHandler("OnGetCurrentSlideDimensions",Wa)}iJc(Wa){this.xa.addHandler("OnSpecialKey",Wa)}epd(Wa){this.xa.removeHandler("OnSpecialKey",Wa)}zzf(Wa){this.xa.addHandler("OnVisibilityChangeEventId",Wa)}EVe(Wa){this.xa.removeHandler("OnVisibilityChangeEventId",Wa)}pzf(Wa){this.xa.addHandler("OnLogEndOfTranscriptionSession",Wa)}Loh(Wa){this.xa.removeHandler("OnLogEndOfTranscriptionSession",
Wa)}ozf(Wa){this.xa.addHandler("OnLiveSubtitlesDockedViewEventId",Wa)}Koh(Wa){this.xa.removeHandler("OnLiveSubtitlesDockedViewEventId",Wa)}jTd(Wa){this.xa.addHandler("OnEnterEndOfShowEventId",Wa)}xVe(Wa){this.xa.removeHandler("OnEnterEndOfShowEventId",Wa)}lTd(Wa){this.xa.addHandler("OnLeaveEndOfShowEventId",Wa)}zVe(Wa){this.xa.removeHandler("OnLeaveEndOfShowEventId",Wa)}xzf(Wa){this.xa.addHandler("OnSubtitleUpdatedEventId",Wa)}Uoh(Wa){this.xa.removeHandler("OnSubtitleUpdatedEventId",Wa)}yzf(Wa){this.xa.addHandler("OnTranscriberStartedEventId",
Wa)}Woh(Wa){this.xa.removeHandler("OnTranscriberStartedEventId",Wa)}Gzf(Wa){this.xa.addHandler("RecordQosErrorEventId",Wa)}cph(Wa){this.xa.removeHandler("RecordQosErrorEventId",Wa)}aIk(Wa){Wa=new O(Wa.rawEvent);if(this.R5j(Wa)){var Hb=this.Acl(Wa.Qva),jc=Hb.EventType;28===jc&&w.a.J(512495840,830,50,"SlideshowFrame.OnSlideshowMessage: Receive message event: {0}",Wa.Qva);switch(jc){case 23:this.yid(Hb);break;case 18:this.cib(Hb);break;case 6:this.eGk();break;case 11:this.ybh(!1,Hb);break;case 13:this.ybh(!0,
Hb);break;case 2:this.ega(Hb);break;case 7:this.Ixa(Hb);break;case 12:this.Sxa(Hb);break;case 24:this.$Hk(Hb);break;case 26:this.w_a(Hb);break;case 27:this.zjd(Hb);break;case 29:this.ajd(Hb);break;case 5:this.Bjd(Hb);break;case 30:this.lIk(Hb);break;case 32:this.hkd(Hb);break;case 31:this.$id(Hb);break;case 19:this.vid(Hb);break;case 20:this.Xid(Hb);break;case 33:this.rod(Hb)}}}R5j(Wa){try{if(Wa.XZg!==this.jb.contentWindow)return w.a.J(512495839,830,50,"SlideshowFrame.IsValidSlideshowEventSourceAndOrigin: Invalid message source or origin: {0}",
Wa.XZg.location.href),!1}catch(Hb){return w.a.J(512495838,830,50,"SlideshowFrame.IsValidSlideshowEventSourceAndOrigin: Exception at checking event source/origin: {0}",Hb.toString()),!1}return!0}Acl(Wa){try{return Sys.Serialization.JavaScriptSerializer.deserialize(Wa)}catch(Hb){let jc=Hb.toString();J.a("DisableLogPostMsgData")&&(Wa="<redacted>");J.a("DisableLogPostMsgEx")&&(jc="<redacted>");w.a.J(512495837,830,15,"SlideshowFrame.RetrieveMsgEventData: Exception at deserializing event data: {0}.  Exception: {1}",
Wa,jc)}return{}}eGk(){if(this.la.bmd&&this.a_g&&!this.nGe)try{const Wa=(new Date).getTime();ha.a.instance.init(this.la,this.jb.contentDocument.body,this.Hc,this,this.Xl,this.Ub,this.xO);this.nGe=!0;w.a.J(512495836,833,50,"SlideshowFrame.OnPresentationOpenedHandler: SpeechClient initialized successfully! TimeUsed: {0} ms",(new Date).getTime()-Wa)}catch(Wa){w.a.J(512495835,830,10,"SlideshowFrame.OnPresentationOpenedHandler: Exception thrown: {0}.",Wa.toString())}w.a.J(512495834,830,50,"SlideshowFrame.OnPresentationOpenedHandler");
this.xa.raiseEvent("OnSlideshowReady",new Sys.EventArgs)}cib(Wa){this.xa.raiseEvent("OnBrowserEvent",new S.a(Wa))}yid(Wa){w.a.J(512495833,830,50,"SlideshowFrame.OnExitSlideshowHandler");w.a.J(512495832,830,50,"SlideShowFrame: Making frame invisible");this.jb.style.display=Qa.a.Pe;this.xa.raiseEvent("OnExit",new T.a(Wa))}ega(Wa){w.a.J(512495831,830,50,"SlideshowFrame.OnGetCurrentPositionHandler");this.xa.raiseEvent("OnGetCurrentPosition",new ca.a(Wa))}Ixa(Wa){w.a.J(512495830,830,50,"SlideshowFrame.OnGetCurrentSlideDimensionsHandler");
this.xa.raiseEvent("OnGetCurrentSlideDimensions",new L.a(Wa))}ybh(Wa,Hb){this.xa.raiseEvent("OnSlideshowError",new I(Wa,Hb))}Sxa(Wa){Wa=new sa.a(Wa);w.a.J(512495829,830,50,"SlideshowFrame.OnSpecialKeyHandler: Key={0}",Wa.key);this.xa.raiseEvent("OnSpecialKey",Wa)}$Hk(Wa){w.a.J(512495828,830,50,"SlideshowFrame.OnSlideshowContextMenuHandler");this.xa.raiseEvent("OnSlideshowContextMenu",new ja.a(Wa))}w_a(Wa){w.a.J(512495827,830,50,"SlideshowFrame.OnVisibilityChangeHandler");this.xa.raiseEvent("OnVisibilityChangeEventId",
new Ea.a(Wa))}zjd(Wa){w.a.J(512495826,830,50,"SlideshowFrame.OnPodSessionExpiredHandler");this.xa.raiseEvent("OnPodSessionExpired",new fa.a(Wa))}ajd(Wa){w.a.J(512495825,830,50,"SlideshowFrame.OnLogEndOfTranscriptionSessionHandler");this.xa.raiseEvent("OnLogEndOfTranscriptionSession",new Z(Wa));this.Hc.Ywb=!1}Bjd(Wa){w.a.J(512495824,830,50,"SlideshowFrame.OnPositionChangedHandler");this.xa.raiseEvent("OnPositionChangeEventId",new aa.a(Wa))}lIk(Wa){w.a.J(512495823,830,50,"SlideshowFrame.OnSubtitleUpdatedHandler");
this.xa.raiseEvent("OnSubtitleUpdatedEventId",new ka(Wa))}hkd(Wa){w.a.J(512495822,830,50,"SlideshowFrame.OnTranscriberStartedHandler");this.xa.raiseEvent("OnTranscriberStartedEventId",new Ma.a(Wa));this.Hc.Ywb=!0}gnc(){this.restoreFocus()}$id(Wa){w.a.J(512495821,830,50,"SlideshowFrame.OnLiveSubtitlesDockedViewHandler");try{const Hb=new da(Wa);this.yQc(Hb.pcc,Hb.fw);this.xa.raiseEvent("OnLiveSubtitlesDockedViewEventId",Hb)}catch(Hb){w.a.J(512495820,830,15,"SlideshowFrame.OnLiveSubtitlesDockedViewHandler threw exception: {0}.",
Hb.toString())}}vid(){w.a.J(512495819,830,50,"SlideshowFrame.OnEnterEndOfShowHandler");this.xa.raiseEvent("OnEnterEndOfShowEventId",Sys.EventArgs.Empty)}Xid(){w.a.J(512495818,830,50,"SlideshowFrame.OnLeaveEndOfShowHandler");this.xa.raiseEvent("OnLeaveEndOfShowEventId",Sys.EventArgs.Empty)}rod(Wa){w.a.J(512495817,830,50,"SlideshowFrame.RecordQosErrorHandler");this.xa.raiseEvent("RecordQosErrorEventId",new ma(Wa))}sG(Wa){this.jb&&this.jb.contentWindow&&this.jb.contentWindow.postMessage(Sys.Serialization.JavaScriptSerializer.serialize(Wa),
"*")}P8g(){var Wa=0,Hb=100;this.qHa.pcc&&("BelowSlide"===this.qHa.fw?(Wa=0,Hb=85):"AboveSlide"===this.qHa.fw&&(Wa=15,Hb=85));Wa=Wa.toString()+"%";Hb=Hb.toString()+"%";this.qHa.vpg&&(Wa=String.format("calc({0} + {1})",Wa,"26px"),Hb=String.format("calc({0} - {1})",Hb,"26px"));this.sG(Object.assign(new M,{TopValue:Wa,HeightValue:Hb}))}Owj(){const Wa={};Wa.AnimTranstionMinDurationMs=n.AFrameworkApplication.fa.wc("PodSlideShowVetoAnimTranstionMinDurationMs",1E3);Wa.AnimTranstionWorstFrameIndex=n.AFrameworkApplication.fa.wc("PodSlideShowVetoAnimTranstionWorstFrameIndex",
3);Wa.AnimTranstionMaxFrameDurationMs=n.AFrameworkApplication.fa.wc("PodSlideShowVetoAnimTranstionMaxFrameDurationMs",300);Wa.AnimTranstionMinFPS=n.AFrameworkApplication.fa.wc("PodSlideShowVetoAnimTranstionMinFPS",24);Wa.NavDurationMs=n.AFrameworkApplication.fa.wc("PodSlideShowVetoNavDurationMs",1250);Wa.SlideShowEUPLThresholdInMs=n.AFrameworkApplication.fa.wc("SlideShowEUPLThresholdInMs",6E3);Wa.SlideShowNavigationThresholdInMs=n.AFrameworkApplication.fa.wc("SlideShowNavigationThresholdInMs",1250);
return JSON.stringify(Wa)}Ntj(Wa,Hb,jc,gc,$b,wb){const Db=this.la.mRk&&e.a.rg(this.la.pptEditorTranscriberQualityStatusMessageJsUri).endsWith("qualitystatusmessage.js"),Xb={};Xb.WacUserSessionId=Wa;Xb.WacUserDatacenterCluster=Hb;Xb.PodSessionId=jc;Xb.DocId=gc;Xb.EntryPoint=$b;Xb.StartTime=wb;Xb.PodsWebServiceBase=this.la.podsWebServiceBase;Xb.TranscriberLoggingIntervalInMS=this.la.KHl;Xb.TranscribeRealTimeFactorLowerThreshold=this.la.GHl;Xb.TranscribeRealTimeFactorUpperThreshold=this.la.HHl;Xb.IsTranscriberLogEachTranscriptMessage=
this.la.a5j;Xb.IsTranscriberContentLoggingEnabled=this.la.Y4j;Xb.FUseEndpointInWebapp=this.la.d5j;Xb.CustomEndpointRequestTimeoutInMs=this.la.pptEditorTransriberCustomEndpointRequestTimeoutInMs;Xb.RTLLanguages=this.la.pptEditorTranscribeRTLTranslationLanguages;Xb.HeartbeatInterval=5E3;Xb.RoundtripLatencyThreshold=1E6;Xb.AudioSendingCountIntervalMS=this.la.pptEditorTranscribeAudioSendingCountIntervalMS;Xb.FragmentLatencyWarnThreshold=1E6;Xb.FragmentLatencyErrorThreshold=1E6;Xb.MessageType=this.la.pptEditorTransciberMessageType;
Xb.MaxAllowedFragmentLatencyMS=this.la.WOk;Xb.DynamicBufferEnabled=this.la.Z4j;Xb.DefaultBufferSize=this.la.JHl;Xb.MaxAllowedFinalFragmentLatencyMS=this.la.VOk;Xb.FSupportSpeechResponseMessage=Db;Xb.IsLiveAgent=this.la.pptEditorTranscriberLiveAgentEnabled&&Db&&e.a.rg(this.la.pptEditorTranscriberAgentCommandMessageJsUri).endsWith("agentcommandmessage.js");Xb.ShouldCreateCustomEndpointWithSession=this.la.pptEditorTranscriberCustomEndpointWithSession;Xb.TranscriberShowListeningDetectionTextInMS=this.la.lRk;
Xb.PodTranscriberAudioContextSampleRate=this.la.UOk;Xb.RehearsalGrammarIsEnabled=this.la.UPe;Xb.PodRehearsalMonotoneEnabled=this.la.gPe;return JSON.stringify(Xb)}Otj(){const Wa={};Wa.Detection_AudioQualityIssue=ResourceStrings.L_SubtitleDetection_AudioQualityIssue;Wa.Detection_HighBackgroundNoise=ResourceStrings.L_SubtitleDetection_HighBackgroundNoise;Wa.Detection_HighJitter=ResourceStrings.L_SubtitleDetection_HighJitter;Wa.Detection_HighLatency=ResourceStrings.L_SubtitleDetection_HighLatency;Wa.Detection_Listening=
ResourceStrings.L_SubtitleDetection_Listening;Wa.Detection_MicReady=ResourceStrings.L_SubtitleDetection_MicReady;Wa.Detection_NetworkQualityIssue=ResourceStrings.L_SubtitleDetection_NetworkQualityIssue;Wa.Detection_NoMicrophone=ResourceStrings.L_SubtitleDetection_NoMicrophone;Wa.Detection_SoundReminder=ResourceStrings.L_SubtitleDetection_SoundReminder;Wa.Detection_SpeakingTooLoud=ResourceStrings.L_SubtitleDetection_SpeakingTooLoud;Wa.Detection_SpeakingTooQuiet=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet;
Wa.DetectionText_AudioQualityIssue=ResourceStrings.L_SubtitleDetectionText_AudioQualityIssue;Wa.DetectionText_HighBackgroundNoise=ResourceStrings.L_SubtitleDetectionText_HighBackgroundNoise;Wa.DetectionText_HighJitter=ResourceStrings.L_SubtitleDetectionText_HighJitter;Wa.DetectionText_HighLatency=ResourceStrings.L_SubtitleDetectionText_HighLatency;Wa.DetectionText_NetworkQualityIssue=ResourceStrings.L_SubtitleDetectionText_NetworkQualityIssue;Wa.DetectionText_SpeakingTooLoud=ResourceStrings.L_SubtitleDetectionText_SpeakingTooLoud;
Wa.DetectionText_SpeakingTooQuiet=ResourceStrings.L_SubtitleDetectionText_SpeakingTooQuiet;Wa.Accessibility_Content=ResourceStrings.L_SubtitleAccessibilityContent;Wa.Accessibility_Window=ResourceStrings.L_SubtitleAccessibilityWindow;Wa.InitialMessage=ResourceStrings.L_SubtitleInitMessage;Wa.GenericErrorMessage=ResourceStrings.L_SubtitleGenericErrorMessage;Wa.RetryErrorMessage=ResourceStrings.L_SubtitleRetryErrorMessage;Wa.ErrorAudioDevice=ResourceStrings.L_SubtitleAudioDeviceErrorMessage;Wa.GenericRetryErrorMessage=
ResourceStrings.L_SpeechGenericRetryErrorMessage;Wa.GenericNetworkErrorMessage=ResourceStrings.L_SpeechGenericNetworkErrorMessage;return JSON.stringify(Wa)}kne(){return!!this.Ub&&!!this.Ub.instance&&this.Ub.instance.GZf}}Object(K.a)(qa,"SlideshowFrame",null,[442])},1032:function(K,U,d){K=d(0);var h=d(392),e=d(987),r=d(142),m=d(170),n=d(27),z=d(7),v=d(18),x=d(696);class B{constructor(fb){this.urb=fb}next(fb){this.urb=(9301*this.urb+49297)%233280;return Math.floor(this.urb/233280*fb)}}Object(K.a)(B,
"Random",null,[]);var D=d(209);class w extends D.a{constructor(){super();this.DismissHostingSurfaceOnExecute=!0}}Object(K.a)(w,"CuiButtonPropsExtended",D.a,[]);var J=d(948),G=d(591),M=d(1167),N=d(1159),R=d(593);class C{constructor(){this.text=this.href=null}}Object(K.a)(C,"LinkProps",null,[]);class O{constructor(){this.icon=this.text=this.href=null}}Object(K.a)(O,"LinkWithLabelProps",null,[]);var S=d(319),T=d(272),ca=d(949),L=d(156),da=d(47);class Z{constructor(fb,ac,Dc,Sc,xb,Ta=null,ib=null){this.hFd=
{};this.qmf={};this.gFd={};this.Zgf=0;this.Ypf=!1;this.cSb=0;this.zhf=!1;this.m4a=this.bWb=0;this.eob=ac;this.PG=null;this.s1h=Dc;this.u1h=Sc;this.B6h=xb;this.$af=ib;this.Oa=Ta||n.AFrameworkApplication.fa;this.eob.BUe(Object(z.a)(this,this.aib,"onAddinDetailsRefreshed"));appChrome.addInApi.loadOfficeAddInIcons()}get sNf(){return this.gFd}I3k(fb){if(fb.lW){for(let ac=0;ac<fb.lW.length;ac++)appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+fb.lW[ac].solutionId,fb.lW[ac].iconUrl);this.$af&&this.$af.dYl()}else 0===
fb.errorCode&&h.ULS.sendTraceTag(509687429,220,10,"addinDetails is null which will lead to no icons registered")}get wcb(){return!!this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}get poe(){return!!this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewDownloadEnabled",!1)}get I1c(){return!!this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewDownloadV2Enabled",!1)}get zoe(){return!!this.Oa&&
this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",!1)&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsPopularLoaderEnabled",!1)}Vrl(fb){0===fb.a_&&(this.cSb|=1);1===fb.a_&&(this.cSb|=2);return!!this.cSb}aib(fb,ac){this.I3k(ac);this.Vrl(ac)&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutOverflowTelemetryEnabled",!1)&&this.pck()}lJf(){let fb=this.eob.C$a(0);if(1!==fb.errorCode)return!0;fb=this.eob.C$a(1);
return 1!==fb.errorCode}xOk(fb){const ac=[];var Dc=new B((new Date).getDate());for(var Sc=0;8>Sc;Sc++)Array.add(ac,Dc.next(fb.count));Dc=0;for(let xb of fb){Sc=!1;for(const Ta of ac)if(Dc===Ta){Sc=!0;break}Dc++;if(Sc){let Ta;(Ta=xb.addinInfo).AUP=20*Ta.AUP}else if(1===xb.addinInfo.priority){let Ta;(Ta=xb.addinInfo).AUP=4*Ta.AUP}else if(2===xb.addinInfo.priority){let Ta;(Ta=xb.addinInfo).AUP=2*Ta.AUP}}fb.Sc((xb,Ta)=>xb.addinInfo.AUP<Ta.addinInfo.AUP?1:-1);return fb}yOk(fb){for(let ac of fb)if(1===
ac.addinInfo.priority){let Dc;(Dc=ac.addinInfo).AUP=4*Dc.AUP}else if(2===ac.addinInfo.priority){let Dc;(Dc=ac.addinInfo).AUP=2*Dc.AUP}fb.Sc((ac,Dc)=>ac.addinInfo.AUP<Dc.addinInfo.AUP?1:-1);return fb}n1d(fb,ac){const Dc={};Dc.width=fb;Dc.height=ac;Dc.backgroundColor="transparent";return Dc}U0d(){return{"margin-top":"4px","max-width":"96px",height:"32px","font-size":"12px",overflow:"hidden",display:"-webkit-box","-webkit-line-clamp":"2","-webkit-box-orient":"vertical","white-space":"normal","word-break":"break-word",
"text-overflow":"ellipsis"}}AVc(){const fb={},ac={},Dc={};ac.root={marginTop:"12px",marginLeft:"16px",marginRight:"16px",marginBottom:"20px",width:"100%",padding:0};ac.inner={margin:"-4px"};Dc.root=this.n1d(100,100);Dc.flexContainer={flexDirection:"column"};Dc.label=this.wcb?{"margin-top":"4px","max-width":"86px","font-size":"12px","text-overflow":"ellipsis"}:this.U0d();fb.galleryButtonInExpanded=Dc;fb.galleryStack=ac;return fb}b$i(){return Object.assign(new N.a,{Id:"AddinFlyoutMoreButton",ExternalId:"AddinFlyoutMoreButton",
Icon:"AllApps_16",Command:this.B6h,LabelText:CommonUIStrings.l_AddinsFlyoutSeeAllButtonText,FullIconStyle:{root:{"max-width":"16px","max-height":"16px","min-width":"16px","min-height":"16px",border:"1px solid #E0E0E0","border-radius":"6px",padding:"15px 15px 15px 15px",overflow:"hidden"}},Alt:CommonUIStrings.l_AddinsPickerGalleryButtonMoreArialText})}Fxb(fb,ac,Dc){const Sc={},xb={width:"32px",height:"32px","border-radius":"6px",overflow:"hidden",padding:"7px",border:"1px solid #E0E0E0"};n.AFrameworkApplication.isRtl&&
(xb.direction="ltr");Sc.root=xb;return Object.assign(new N.a,{Id:Dc,ExternalId:Dc,Icon:"AddinFlyoutControl"+ac.solutionId,Command:fb===CommonUIStrings.l_PopularAddins?this.s1h:this.u1h,LabelText:ac.displayName,FullIconStyle:Sc,Alt:ac.description})}HPk(fb,ac,Dc){const Sc=Object.assign(new M.a,{SectionId:fb,Title:fb,GalleryButtons:[]});for(let xb=0;xb<Dc;xb++)Array.add(Sc.GalleryButtons,this.Fxb(fb,ac[xb],this.hFd[ac[xb].solutionId]));return Sc}$7b(){var fb=[];const ac=this.eob.C$a(0);Array.addRange(fb,
ac.lW);const Dc=this.eob.C$a(1);Array.addRange(fb,Dc.lW);let Sc=fb.length;this.m4a=0<Sc?5:6;n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&h.ULS.sendTraceTag(509687428,220,15,"The MRU list number is {0}, myAddins: {1}|{2}, adminManaged: {3}|{4}",Sc,x.a[ac.errorCode],ac.lW.length,x.a[Dc.errorCode],Dc.lW.length);fb.sort((xc,ic)=>{xc=L.d(xc.displayName);ic=L.d(ic.displayName);return da.a.localeCompare(xc,ic)});const xb=6<Sc;xb&&(Sc=5);
for(var Ta=0;Ta<Sc;Ta++)this.sFf(fb[Ta]);let ib=[];Ta=null;this.PG?ib=this.PG:(Ta=this.eob.C$a(2),0===Ta.errorCode&&Ta.lW.forEach(xc=>{-1!==xc.addinInfo.priority&&(this.sFf(xc),ib.push(xc))}));Ta=!0;ib.length||(Ta=!1);let ob=0;if(Ta&&(ob=fb.length?3>=fb.length?9:6:12,ib=this.wcb?this.nmi(ib,fb):this.lmi(ib,fb),ob>ib.length&&(ob=ib.length),n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&!this.Ypf&&!this.wcb)){var fc="",Jb="";for(let xc=
0;xc<ib.length&&xc<ob;xc++)fc+=ib[xc].displayName,fc+=",",Jb+=ib[xc].solutionId,Jb+=",";h.ULS.sendTraceTag(509673818,220,15,"The popular list number is {0}, addin name list:{1}, addin solution id list:{2}",ob,fc,Jb);this.Ypf=!0}fc=Object.assign(new T.a,{Id:"FooterSection",ControlsId:"FooterSection.Controls",ControlList:[]});Jb=Object.assign(new D.a,{ExternalId:"InsertMoreAddInsFromFooter",AriaDescription:CommonUIStrings.l_AddinsPickerFooterButtonMoreArialText});Array.add(fc.ControlList,Jb);appChrome.api.dispatch(appChrome.actions.setControlLabel("InsertMoreAddInsFromFooter",
CommonUIStrings.l_AddinPickerButtonMore));fc=Object.assign(new S.a,{Id:"Ribbon.AddinPicker",MenuSectionList:[],MenuFooterSection:fc,UpdateDynamically:!0});2!==ac.errorCode||fb.length?3===ac.errorCode&&3===Dc.errorCode?(h.ULS.sendTraceTag(509687426,220,10,"dataProvider invoke error hit"),fb=this.g3f("Common",CommonUIStrings.l_AddinPickerGeneralError),Array.add(fc.MenuSectionList,fb)):(0<Sc?this.kOf(fc,fb,Sc,"MRUAddins",CommonUIStrings.l_MyAddinSection,xb):this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutBannerEnabled",
!1)&&(fb=this.p9i(),Array.add(fc.MenuSectionList,fb),h.ULS.sendTraceTag(509216389,220,50,"Show flyout banner")),Ta&&(this.wcb?(Array.add(fc.MenuSectionList,this.Z9i(ib,this.m4a)),fb=[],this.PNh(fb),appChrome.api.dispatch(fb),this.bWb=this.PG.length<this.m4a?this.PG.length:this.m4a):this.kOf(fc,ib,ob,"PopularAddins",CommonUIStrings.l_PopularAddins))):(h.ULS.sendTraceTag(509687427,220,10,"store disabled hit"),fb=this.g3f("StoreDisabled",CommonUIStrings.l_AddinPickerDisableError),Array.add(fc.MenuSectionList,
fb));return fc}get jxb(){return!!this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNotSignedInFixEnabled",!0)}get gTc(){return!!this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNoMailboxFixEnabled",!0)}VCl(){if(!(this.m4a>=this.PG.length)){var fb=[];for(let ac=0;ac<this.m4a;ac++)this.qmf["PopularAddInsListItem"+ac]=this.PG[ac].solutionId,this.NMl(fb,ac.toString(),this.PG[this.bWb]),this.bWb===this.PG.length-1?this.bWb=0:this.bWb++;this.PNh(fb);
appChrome.api.dispatch(fb)}}PNh(fb){6>this.m4a?fb.push(appChrome.actions.updateControlHiddenState("PopularAddInsListItem5",!0)):fb.push(appChrome.actions.updateControlHiddenState("PopularAddInsListItem5",!1))}Z9i(fb,ac){const Dc=Object.assign(new T.a,{Id:"PopularAddinListSection",ControlsId:"PopularAddinListSection.Controls",ControlList:[],Title:CommonUIStrings.l_PopularAddins});for(let Sc=0;Sc<0+ac&&Sc<fb.length;Sc++)this.qmf.PopularAddInsListItem0=fb[Sc].solutionId,this.h9i(Dc.ControlList,Sc.toString(),
fb[Sc]);fb=Object.assign(new w,{Id:"SwitchPopularAddIns",ExternalId:"SwitchPopularAddIns",ExternalImageId:"RefreshGreen_20",Command:"152023954",LabelText:CommonUIStrings.l_AddinSwitchText,ShouldTakeFocus:!1,DismissHostingSurfaceOnExecute:!1});Array.add(Dc.ControlList,fb);return Dc}h9i(fb,ac,Dc){ac=this.pPf(ac,Dc);Array.add(fb,ac)}NMl(fb,ac,Dc){Dc=this.pPf(ac,Dc);const Sc={};Sc.label=Dc.Label;Sc.secondaryLabel=Dc.SecondaryLabel;Sc.description=Dc.Description;Sc.iconSet=Dc.iconSet;Sc.links=Dc.Links;
this.I1c&&(Sc.details=Dc.Details);Sc.commandValueId=Dc.CommandValueId;Sc.actionCommandValueId=Dc.ActionCommandValueId;fb.push(appChrome.actions.updateMultiActionButton("PopularAddInsListItem"+ac,Sc))}pPf(fb,ac){let Dc="";if(this.poe||this.I1c){var Sc=ac.addinInfo.downloadNumber;5E6<=Sc?(Sc=5E6,Dc=Sc.toLocaleString()+"+"):1E3<=Sc?(Sc=1E3*Math.round(Sc/1E3),Dc=Sc.toLocaleString()+"+"):0<Sc&&(Sc=1E3,Dc="<"+Sc.toLocaleString());this.poe&&(Dc="\u2b73 "+Dc);0>=Sc&&(Dc=CommonUIStrings.l_AddinDownloadNewText)}Sc=
[];const xb=[];if(this.I1c){var Ta=Object.assign(new O,{icon:Dc===CommonUIStrings.l_AddinDownloadNewText?null:"download",text:Dc});Array.add(xb,Ta);Ta=Object.assign(new O,{text:this.Oa.getStringFeatureGate("Microsoft.Office.SharedOnline.AddinListStoreLabel",CommonUIStrings.l_AddinListStore2),href:"https://appsource.microsoft.com/en-us/product/office/"+ac.solutionId});Array.add(xb,Ta)}else Ta=Object.assign(new C,{text:CommonUIStrings.l_AddinListPrivacy,href:ac.privacyUrl}),Array.add(Sc,Ta),Ta=Object.assign(new C,
{text:CommonUIStrings.l_AddinListLicense,href:ac.licenseUrl}),Array.add(Sc,Ta),Ta=Object.assign(new C,{text:CommonUIStrings.l_AddinListStore,href:"https://appsource.microsoft.com/en-us/product/office/"+ac.solutionId}),Array.add(Sc,Ta);Ta={};Ta["default"]="AddinFlyoutControl"+ac.solutionId;return Object.assign(new ca.a,{Id:"PopularAddInsListItem"+fb,ExternalId:"PopularAddInsListItem"+fb,CommandId:"PopularAddInsListItem"+fb,iconSet:Ta,SecondaryLabel:this.poe&&!this.I1c?"("+Dc+")":null,Details:xb,Label:ac.displayName,
ActionText:CommonUIStrings.l_AddinListAdd,Description:ac.description,Links:Sc,ActionId:"PopularAddInsListItemAdd"+fb,ActionCommandValueId:this.d3f(ac),CommandValueId:this.d3f(ac)})}d3f(fb){return this.zoe?String.format("{0}#{1}",fb.solutionId,fb.storeId):fb.solutionId}sFf(fb){if(!(fb.solutionId in this.hFd)){const ac="AddinGalleryButton"+this.Zgf.toString();this.hFd[fb.solutionId]=ac;this.gFd[ac]=this.zoe?fb:fb.solutionId;this.gFd[ac+"Add"]=this.zoe?fb:fb.solutionId;this.Zgf++}}p9i(){const fb=Object.assign(new T.a,
{Id:"BannerSection",ControlsId:"BannerSection.Controls",ControlList:[]}),ac=Object.assign(new R.a,{Id:"AddInFlyoutBanner",ExternalId:"AddInFlyoutBanner",LabelText:this.Oa.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableConfigBannerUIString",CommonUIStrings.l_AddinBannerText),IconName:"FlyoutBannerCommon",IsBanner:!0});Array.add(fb.ControlList,ac);return fb}g3f(fb,ac){const Dc=Object.assign(new T.a,{Id:"ErrorSection",ControlsId:"ErrorSection.Controls",ControlList:[]});fb=Object.assign(new J.a,
{Id:"ErrorView",ExternalId:"ReloadAddInPicker",IconName:fb,Label:ac,RetryButtonTitle:CommonUIStrings.l_AddinPickerTryAgain,OnRetryCommandId:"ReloadAddInPicker",AriaDescription:"StoreDisabled"===fb?ac:CommonUIStrings.l_AddinPickerTryAgainAriaLabel});Array.add(Dc.ControlList,fb);return Dc}lmi(fb,ac){var Dc=new v.a;for(let Sc=0;Sc<fb.length;Sc++)Dc.add(fb[Sc]);this.PG||(8<Dc.count&&(Dc=this.xOk(Dc)),this.PG=Dc.toArray());for(fb=0;fb<this.PG.length;fb++)for(Dc=0;Dc<ac.length;Dc++)if(this.PG[fb].solutionId.toLowerCase()===
ac[Dc].solutionId.toLowerCase()){Array.remove(this.PG,this.PG[fb--]);break}return this.PG}nmi(fb,ac){var Dc=new v.a;for(let Sc=0;Sc<fb.length;Sc++)Dc.add(fb[Sc]);this.PG||(8<Dc.count&&(Dc=this.yOk(Dc)),this.PG=Dc.toArray());for(fb=0;fb<this.PG.length;fb++)for(Dc=0;Dc<ac.length;Dc++)if(this.PG[fb].solutionId.toLowerCase()===ac[Dc].solutionId.toLowerCase()){Array.remove(this.PG,this.PG[fb--]);break}return this.PG}kOf(fb,ac,Dc,Sc,xb,Ta=!1){const ib=Object.assign(new T.a,{Id:Sc+"Section",ControlsId:Sc+
"Section.Controls",ControlList:[]});Sc=Object.assign(new G.a,{Id:Sc+"GalleryControl",ExternalId:Sc+"GalleryControl",GalleryStyle:this.AVc(),Width:3,Type:4,GallerySections:[]});Array.add(fb.MenuSectionList,ib);Array.add(ib.ControlList,Sc);fb=this.HPk(xb,ac,Dc);Ta&&Array.add(fb.GalleryButtons,this.b$i());Sc.GallerySections.push(fb)}Nld(fb){if(fb)try{fb.MenuItems=this.$7b()}catch(ac){h.ULS.sendTraceTag(509687425,220,10,"GetReactGalleryMenu hit exception "+(ac?ac.toString():""))}else h.ULS.sendTraceTag(509687424,
220,10,"PopulateMenu menuProps is null")}dispose(){}pck(){if(!this.zhf&&this.wrd){var fb=appChrome.selectors.getSelectedTabId();fb&&L.a(fb,"Home")&&((fb=document.getElementById("InsertAddInFlyout"))&&"none"!==window.getComputedStyle(fb,"").display||h.ULS.sendTraceTag(509368032,344,15,"Addin button is in overflow"),this.zhf=!0)}}get wrd(){return!!window.appChrome&&!!appChrome.selectors}static syb(fb){return fb.failure?fb.failure.invokeResultCode:-1E3}}Object(K.a)(Z,"AppsFlyoutGenerator",null,[107]);
var fa=d(377),aa=d(56),ja=d(226),I=d(988),sa=d(194),ka=d(171),Ma=d(1244),Ea=d(695),ma=d(37),va=d(42),Ca=d(84),oa=d(39);class Da{constructor(){this.idField=null;this.stateField=0}}Object(K.a)(Da,"CT_OsfBackgroundAppData",null,[]);class ta{constructor(){this.currentStoreTypeField=this.bkgdDataField=this.assetStoreIdField=this.assetIdField=this.appVersionField=null;this.heightField=0;this.heightFieldSpecified=!1;this.idField=null;this.isAddinCommandsField=!1;this.storeIdField=null;this.widthField=this.targetTypeField=
0;this.widthFieldSpecified=!1}}Object(K.a)(ta,"CT_OsfInsertionInfo",null,[]);var ha=d(52),Ha=d(986),bb=d(989),Na=d(340),Ia=d(33),Qa=d(30),qa=d(152),Wa=d(943),Hb=d(541);class jc extends Hb.a{constructor(fb){super("TextAboveImage");this.imageHeight=this.imageWidth=this.image=this.paragraphs=null;this.paragraphs=fb.paragraphs;this.image=fb.image;this.imageWidth=fb.imageWidth;this.imageHeight=fb.imageHeight}}Object(K.a)(jc,"TextAboveImage",Hb.a,[]);class gc{constructor(fb,ac){this.imageHeight=this.imageWidth=
this.image=this.paragraphs=null;this.paragraphs=fb;this.image=ac}}Object(K.a)(gc,"TextAboveImageCustomProps",null,[]);var $b=d(141),wb=d(1150),Db=d(945),Xb=d(944),ab=d(356),Ab=d(82),rc=d(134);class tb{constructor(){this.Dkk="ClickOnLaunch";this.ngk="ClickOnDismiss";this.hqk="Show";this.Uhk="BetterEntryPoint_InsertTab";this.trk=500;this.Gik=280;this.Cik=192;this.Rik="InsertAddInFlyout";this.upk="RibbonOverflowMenu-overflow";this.tpk="[data-unique-id=Ribbon-InsertAddinTransitionEntry]";this.mik="[data-unique-id=Home]";
this.Sik="InsertAddinTransitionEntry"}vJi(){Object(qa.a)(this,void 0,void 0,function*(){try{let fb=yield $b.UISurfaces.FL();tb.rGb&&(fb.removeNotification(tb.rGb),tb.rGb=null);let ac=this.tpk,Dc=document.getElementById(this.Sik);const Sc=Dc?window.getComputedStyle(Dc,null):null;if(null==Dc||Sc&&"none"===Sc.display)ac=this.mik;const xb=CommonUIStrings.l_BetterEntryPointTUI_Title,Ta=CommonUIStrings.l_BetterEntryPointTUI_Content,ib=new Wa.a("https://iriscoremetadataprod.blob.core.windows.net/assets/add-ins_powerpoint_1677568738672.svg"),
ob=new gc(Ta,ib),fc=new jc(ob);fc.imageWidth=this.Gik;fc.imageHeight=this.Cik;const Jb=new wb.a;Jb.label=CommonUIStrings.l_BetterEntryPointTUI_ButtonText1;Jb.ariaDescription=CommonUIStrings.l_BetterEntryPointTUI_ButtonText1;Jb.onExecute=()=>{this.LDj();this.Mea(this.Dkk)};const xc=new wb.a;xc.label=CommonUIStrings.l_BetterEntryPointTUI_ButtonText2;xc.ariaDescription=CommonUIStrings.l_BetterEntryPointTUI_ButtonText2;xc.onExecute=()=>{fb.removeNotification(tb.rGb);this.Mea(this.ngk)};const ic=new Db.a;
ic.onDismiss=()=>{fb.removeNotification(tb.rGb)};ic.setInitialFocus=!0;const nc=new Xb.a;nc.target=ac;nc.title=xb;nc.content=fc;nc.showCloseIcon=!0;nc.hasDynamicSizing=!1;nc.preventLightDismiss=!1;nc.useTeachingStyles=!0;nc.primaryButtonProps=Jb;nc.secondaryButtonProps=xc;nc.calloutProps=ic;const Wb=fb.callout(nc),wc=new ab.a;wc.onShow=()=>{this.Mea(this.hqk)};tb.rGb=fb.addNotification(Wb,wc);return null}catch(fb){return h.ULS.sendTraceTag(509207556,220,15,"Failed to GetNotificationsAPIAsync: {0}",
fb),null}})}LDj(){appChrome.api.dispatch(appChrome.actions.setCurrentTab("Home"));const fb=new Ab.a(0,1,this.trk,()=>{this.T7j()});rc.a.instance.Hb(fb)}T7j(){const fb=document.getElementById(this.Rik),ac=fb?window.getComputedStyle(fb,null):null;if(null==fb||ac&&"none"===ac.display){const Dc=document.getElementById(this.upk);null!=Dc?(Dc.onclick=function(){const Sc=new Ab.a(0,1,500,()=>{const xb=document.querySelector("[data-unique-id='Overflow-InsertAddInFlyout']");null!=xb?(xb.click(),h.ULS.sendTraceTag(509207555,
220,50,"Launch flyout in overflow")):h.ULS.sendTraceTag(509207554,220,10,"Neither ribbon nor overflow can launch flyout")});rc.a.instance.Hb(Sc);Dc.onclick=function(){}},Dc.click()):h.ULS.sendTraceTag(509207553,220,10,"Neither ribbon nor overflow can launch flyout")}else fb.click(),h.ULS.sendTraceTag(509207552,220,50,"Launch flyout in ribbon button")}Mea(fb){fb={["AppTeachingUICalloutAction"]:fb,["AppTeachingUICalloutGoal"]:this.Uhk};r.a.sendTelemetryEvent(Object.assign(new ka.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:m.a.kz(fb)}))}}tb.rGb=null;Object(K.a)(tb,"PPTBetterEntryTeachingCallout",null,[]);d.d(U,"a",function(){return Za});class Za{constructor(fb,ac,Dc,Sc,xb,Ta,ib,ob,fc,Jb,xc,ic,nc){this.KHg=this.IFe=!1;this.hui=1E3;this.iui="AddinFlyoutFeedbackSurvey";this.jui=15E3;this.GFe=!0;this.ZCb=0;this.gFg=!1;this.pek="g_InstallOrigin";this.ZZg=new Map([["InsertAddInsFromBackstage","Backstage"],["InsertAddIns","Ribbon"],["LaunchAddinDialogFromTellMe","TellMe"],["AddinFlyoutMoreButton","AddinFlyoutSeeAll"],
["InsertMoreAddInsFromFooter","InsertMoreAddInsFromFooter"]]);this.GRg=null;this.RDj=()=>this.lVd&&!this.Jb.ka("AppsForOfficeThirdPartyIsDisabled")&&this.jsa&&this.jsa.lJf()?32:8;this.vDj=(Wb,wc,nb,Rb,mb)=>{if(2!==nb)return this.jsa&&this.jsa.lJf()?32:8;if(!this.jsa)return 8;this.jsa.Nld(mb);this.IFe&&(this.Yqc(),this.L7j());return 32};this.RFj=(Wb,wc,nb)=>{if(2!==nb)return 32;this.Ete.VCl();this.Yqc();return 32};this.Ryj=(Wb,wc)=>{if(2!==Wb)return 32;this.Yqc();Wb=wc.Href;wc=wc.CommandValueId;const nb=
this.Gd.xJc.U6b(wc);nb&&(wc={["solutionId"]:Za.aJ(wc,nb.storeType,nb.assetId,nb.storeId)},wc.href=Wb,r.a.sendTelemetryEvent(Object.assign(new ka.a,{name:"Office.Extensibility.Host.AddInListLinkClickedFromFlyout",dataFields:m.a.kz(wc)})));return 32};this.iCj=(Wb,wc,nb,Rb,mb)=>{this.Yqc();return"LinkClickedPayload"===mb.Type?this.Ryj(nb,mb):this.gfg(Wb,wc,nb,Rb,mb)};this.cCj=(Wb,wc,nb,Rb,mb)=>{if(2!==nb)return 32;this.Yqc();wc=mb.CommandValueId;nb=this.Gd.xJc.U6b(wc);Rb={};if(nb)Rb.solutionId=wc,Rb.version=
nb.version,Rb.storeType=nb.storeType,Rb.storeId=nb.storeId,Rb.assetId=nb.assetId,Rb.assetStoreId=nb.assetStoreId,Rb.targetType=nb.targetType,Rb.displayName=nb.displayName,Rb.width=nb.width,Rb.height=nb.height,this.Gd.WIb("handleInsertAppForOffice",Rb),this.cfe(Wb,Rb),Wb={["solutionId"]:Za.aJ(wc,nb.storeType,nb.assetId,nb.storeId)},r.a.sendTelemetryEvent(Object.assign(new ka.a,{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyoutListView",dataFields:m.a.kz(Wb)}));else return h.ULS.sendTraceTag(509109065,
344,10,"No add-in details."),8;return 32};this.jCj=(Wb,wc,nb,Rb,mb)=>{var Ub;if(!this.g5||!mb)return 8;if(1===nb)return this.Gd?32:8;if(!this.Gd)return this.ZCb||(this.ZCb=window.performance.now()),this.eM.Eja(),this.eM.zQa(Wb,mb),8;Wb=mb[Ea.a.Nwb];mb=mb[Ea.a.zib];wc=mb.optionalProperties;nb={};nb.ZA=wc.TaskPaneTitle;nb.assetId=Wb.getId();nb.c6=wc.OnRenderedCallback;nb.nonPersistedSettings=mb.bwb;nb.TPc=wc.DialogIsModal;nb.XPc=wc.DialogShowTitleBar;nb.dialogWidth=wc.DialogWidth;nb.dialogHeight=wc.DialogHeight;
nb.dialogLeft=wc.DialogLeft;nb.p4b=wc.DialogRight;nb.dialogTop=wc.DialogTop;nb.n4b=wc.DialogBottom;nb.gka=null!==(Ub=wc.DialogTitle)&&void 0!==Ub?Ub:"";nb.sourceLocationOverrideResourceId=wc.SourceLocationOverrideResourceId;nb.t3d=wc.DialogParentId;this.Gd.U9k(nb);return 32};this.oFj=(Wb,wc,nb,Rb,mb)=>{if(2!==nb)return 32;if(!this.Gd)return 8;wc=mb[Ea.a.Nwb];nb=mb[Ea.a.zib].optionalProperties;Wb={};Wb.ZA=nb.TaskPaneTitle;Wb.assetId=wc.getId();Wb.sourceLocationOverrideResourceId=nb.SourceLocationOverrideResourceId;
Wb.c6=nb.tWl;Wb.nonPersistedSettings=nb.bwb;wc=this.Gd.Exb(Wb);wc=this.Gd.zQ(wc);mb=mb[Ea.a.fvb];return wc&&"taskpane"==mb.toLowerCase()?(this.Gd.Lkl(wc.instanceId,Wb),32):8};this.Uyj=(Wb,wc,nb,Rb,mb)=>{if(2!==nb)return 32;if(mb.SourceControlId)return this.GRg=new tb,this.GRg.vJi(),32;h.ULS.sendTraceTag(509207557,220,10,"Control id is null.")};this.kCj=(Wb,wc,nb,Rb,mb)=>{if(2!==nb)return 32;if(!this.jsa)return 8;wc=this.jsa.sNf[mb.SourceControlId];if(!wc)return h.ULS.sendTraceTag(509383066,220,10,
"SourceControlId (solutionId) is empty in LaunchAddinInstallDialog"),8;this.Gd?this.Gd.I7j(wc):(this.eM.Eja(),this.eM.zQa(Wb,mb));return 32};this.gfg=(Wb,wc,nb,Rb,mb)=>{if(2!==nb)return 32;if(!this.jsa)return 8;wc=this.wcb?mb.CommandValueId:this.jsa.sNf[mb.SourceControlId];if(!wc)return h.ULS.sendTraceTag(509383065,220,10,"SourceControlId (solutionId) is empty in LaunchAddinInstallDialog"),8;this.Gd?this.Gd.u4c(wc):(this.eM.Eja(),this.eM.zQa(Wb,mb));return 32};this.hfg=(Wb,wc,nb,Rb,mb)=>{wc=this.ta.Ba;
Rb=this.Tb.Ef;if(!(this.g5&&wc&&Rb)||this.qf.$c(wc))return 8;if(!this.lVd)return h.ULS.sendTraceTag(512288602,802,50,"Web add-in insert blocked by doc IRM"),8;if(1===nb)return 32;Ia.a("LogAddinInstallOriginEnabledForPPT")&&(nb=mb?mb.SourceControlId:void 0,window[this.pek]=this.ZZg.get(nb)?this.ZZg.get(nb):"Unknown");this.Gd?Ia.a("UpdateLaunchInsertDialog")?(Wb=mb?mb.SourceControlId:void 0,mb=mb?mb.CommandValueId:null,"InsertMoreAddInsFromFooter"===Wb?this.Gd.Gug("{98143890-AC66-440E-A448-ED8771A02D52}"):
"AddinFlyoutMoreButton"===Wb?this.Gd.Gug("0"):"LaunchAddinDialogFromTellMe"==Wb&&mb?this.Gd.W7j(mb):this.Gd.launchInsertDialog()):this.Gd.launchInsertDialog():(this.eM.Eja(),this.eM.zQa(Wb,mb));return 32};this.cfg=(Wb,wc,nb,Rb,mb)=>{if(!mb)return 8;null!=this.Gd&&this.Jb.isChangeGateEnabled("OnInsertAgaveStartedEnabled")&&this.Gd.WIb("handleInsertAppForOffice",mb);return this.cfe(Wb,mb)};this.PBj=(Wb,wc,nb,Rb,mb)=>mb?this.cfe(Wb,mb):8;this.cfe=(Wb,wc)=>{if(!this.lVd)return h.ULS.sendTraceTag(512288601,
802,50,"Web add-in insert blocked by doc IRM"),16;if(0===wc.targetType)return this.aQj(wc,Wb);if(1===wc.targetType){if(this.qf.$c(this.Tb.Ef))return 16;this.jjk?wc.isAddinCommands?Ia.a("AddinCommandsActionTypeUndefinedCheck")?void 0===wc.addinCommandsActionType||null===wc.addinCommandsActionType||0===wc.addinCommandsActionType?this.xQb(wc):1===wc.addinCommandsActionType?this.n_c(wc):h.ULS.sendTraceTag(512288600,802,50,"HandleInsertAppForOfficeUpload invalid AddinCommandsActionType of "+wc.addinCommandsActionType.toString()):
0===wc.addinCommandsActionType?this.xQb(wc):1===wc.addinCommandsActionType&&this.n_c(wc):(Wb={},Wb.solutionId=wc.solutionId,Wb.version=wc.version,Wb.storeType=wc.storeType,Wb.storeId=wc.storeId,Wb.targetData=wc,this.Gd.Ui.isAddinCommandsAsync(Wb,(nb,Rb,mb)=>{Rb?this.xQb(mb.targetData):this.n_c(mb.targetData);nb||(nb=mb.targetData,h.ULS.sendTraceTag(512288599,220,10,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(nb.solutionId,nb.storeType,nb.assetId,null,
null,nb.storeId),nb.storeType))})):this.n_c(wc);Ha.a.add(wc.solutionId,wc.targetType,wc.storeId,wc.storeType,wc.version);return 32}return 8};this.la=fb;this.Jb=ac;this.g5=this.la.pptEditInsertAppsForOfficeEnabled;this.jjk=this.la.Iua;this.qr=Dc;this.ia=Sc;this.Tb=xb;this.ta=Ta;this.nad=ob;this.Eb=ib;this.eM=fc;this.Oc=Jb;this.Rb=xc;this.qf=ic;this.hj=nc}get lVd(){return this.g5&&n.AFrameworkApplication.Qca}vb(){this.ia.ra(Qa.a.eAb,ha.a.application,this.hfg,516);this.ia.ra(Qa.a.$Zc,ha.a.application,
this.PBj,4);this.ia.ya(Qa.a.XYc,ha.a.application,Object(z.a)(this,this.yBj,"handleHideAppForOfficeTaskPane"));this.ia.ra(Qa.a.ikb,ha.a.application,Object(z.a)(this,this.IEj,"handleRenderAppForOfficeTaskPane"),4);this.ia.ra(Qa.a.a0a,ha.a.application,Object(z.a)(this,this.a0a,"queryEntitledAppsForOffice"),96);this.ia.ya(Qa.a.Oga,ha.a.application,Object(z.a)(this,this.Xfg,"handleShowFirstPartyTaskPane"));this.ia.ya(Qa.a.Vub,ha.a.application,Object(z.a)(this,this.dAj,"handleCloseAppsForOfficeTaskPane"));
this.ia.ya(ma.a.aCh,ha.a.application,Object(z.a)(this,this.uFj,"handleShowExtensionTaskPane"));this.ia.ya(ma.a.dLf,ha.a.application,Object(z.a)(this,this.eAj,"handleCloseExtensionTaskPane"));this.ia.ya(ma.a.Irh,ha.a.application,Object(z.a)(this,this.UEj,"handleRestartExtensionTaskPane"));this.ia.ya(Qa.a.RMh,ha.a.application,Object(z.a)(this,this.qGj,"handleUpdateBackgroundAppData"));this.ia.ya(ma.a.Jug,ha.a.application,this.jCj);Ia.a("EnabledTellMeAddinOnPPTO")&&(this.ia.ra(ma.a.zkg,ha.a.application,
this.cfg,4),this.ia.ra(ma.a.vre,ha.a.application,this.hfg,4));this.Yzf&&(this.ia.ya(ma.a.u4c,ha.a.application,this.gfg),this.ia.ya(ma.a.Cie,ha.a.application,this.cfg),this.ia.ya(ma.a.Mug,ha.a.application,this.kCj),this.ia.ra(ma.a.BVk,ha.a.application,this.RDj,4),this.ia.ya(ma.a.nPk,ha.a.application,this.vDj),PowerPointWebEditor.AppChromeSettingsLoadedHandler.RegisterOrInvokeOnAppChromeSettingsLoad(Object(z.a)(this,()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("InsertAddInFlyout",
!1))},"insertAddInFlyoutUpdateStateCallback")),this.wcb&&(this.ia.ya(ma.a.XCl,ha.a.application,this.RFj),this.ia.ya(ma.a.K7j,ha.a.application,this.iCj),this.ia.ya(ma.a.FQj,ha.a.application,this.cCj)));Ia.a("EnableSetTitleExtensionTaskPane")&&this.ia.ya(ma.a.Eyh,ha.a.application,this.oFj);this.eji&&this.ia.ra(ma.a.nkg,ha.a.application,this.Uyj,516)}get jsa(){if(!this.Yzf)return null;if(!this.Gd)return this.eM.Eja(),null;this.Ete||(this.Gd.xJc?(this.Ete=new Z(this.ia,this.Gd.xJc,ma.a.u4c.toString(),
ma.a.Mug.toString(),Qa.a.eAb.toString(),this.Jb),this.IFe=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowFlyoutSurveyEnabled",!1)):h.ULS.sendTraceTag(509379480,220,10,"this.appForOfficeManager.addinDetailsProvider is null"));return this.Ete}get Yzf(){return this.Jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&this.Jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)}get wcb(){return this.Jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",
!1)}get eji(){return this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinTransitionEntranceEnabled",!1)}pe(){}get Gd(){return this.Oc.instance}static aJ(fb,ac,Dc,Sc){return Telemetry.PrivacyRules.GetPrivacyCompliantId(fb,ac,Dc,null,null,Sc)}L7j(){fa.a.instance.getItem("AddinFlyoutSurveyShowedInPPT")&&(this.GFe=!1);this.GFe&&(window.setTimeout(()=>{let fb=this.i7f();fb&&"hidden"!==fb.visibility&&(this.KHg=!0)},this.hui),this.Wok=window.setTimeout(()=>{this.A_g=aa.a.instance.Ia("Common.ISystemInitiatedFeedback");
this.KHg&&this.A_g&&this.A_g.execute(fb=>{let ac=this.i7f();ac&&"hidden"===ac.visibility&&(fb.Ulb(this.iui,null),this.GFe=!1,fa.a.instance.setItem("AddinFlyoutSurveyShowedInPPT","1"))})},this.jui))}i7f(){let fb=null;try{const ac=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");ac&&(fb=ja.a.rt(ac.parentNode.parentNode.parentNode))}catch(ac){h.ULS.sendTraceTag(508900309,220,10,"AddinFlyout get parent and parent get exception "+(ac?ac.toString():""))}return fb}Yqc(){this.IFe&&window.clearTimeout(this.Wok)}uFj(fb,
ac,Dc,Sc,xb){if(2!==Dc)return 32;const Ta=xb[Ea.a.Nwb];xb=xb[Ea.a.zib];const ib={};ib.ZA=xb.optionalProperties[e.a.ZA];ib.assetId=Ta.getId();ib.c6=xb.optionalProperties[e.a.c6];ib.nonPersistedSettings=xb.bwb;return this.Xfg(fb,ac,Dc,Sc,ib)}eAj(fb,ac,Dc,Sc,xb){if(2!==Dc)return 32;fb=xb[Ea.a.Nwb];xb=xb[Ea.a.zib];ac={};ac.ZA=xb.optionalProperties[e.a.ZA];ac.assetId=fb.getId();ac.sourceLocationOverrideResourceId=xb.optionalProperties[e.a.sourceLocationOverrideResourceId];ac.c6=xb.optionalProperties[e.a.c6];
ac.nonPersistedSettings=xb.bwb;xb=this.Gd.Exb(ac);return(xb=this.Gd.zQ(xb))&&this.Gd.rZd(xb.instanceId)?32:8}UEj(fb,ac,Dc,Sc,xb){if(2!==Dc)return 32;fb=xb[Ea.a.Nwb];ac=xb[Ea.a.zib];xb={};xb.ZA=ac.optionalProperties[e.a.ZA];xb.assetId=fb.getId();xb.sourceLocationOverrideResourceId=ac.optionalProperties[e.a.sourceLocationOverrideResourceId];xb.c6=ac.optionalProperties[e.a.c6];xb.nonPersistedSettings=ac.bwb;fb=this.Gd.Exb(xb);return(fb=this.Gd.zQ(fb))?(this.Gd.lmh(fb.instanceId,xb),32):8}yBj(fb,ac,Dc,
Sc,xb){if(!this.g5)return 16;if(!xb)return 8;if(1===Dc)return 32;fb=Object(Ma.a)(String,xb);if(!fb||!fb.length)return 8;if((ac=this.Gd.OSc(fb))&&ac.taskpane){if(this.Gd.Qua(fb))return this.Gd.qNb(fb,!1),32;if(ac.jp&&OSF.OsfControl.isFirstPartyStoreString(ac.jp.storeType))return this.Gd.oQc(fb),this.Gd.VXk(fb),32;ac=ac.taskpane.ownerAddinSolutionId;if(this.Gd.dSj(fb)||ac)this.Gd.oQc(fb);else if(ac=this.Gd.fUc(),Dc=this.Rb.Lc(ac),fb=this.Gd.v0f(fb)){Dc.$k(Object(Ma.a)(Ca.a,fb));fb=this.Eb.xd(4,void 0,
void 0,void 0,!0);try{fb.hc(ac),Dc.Ni()}finally{fb&&fb.dispose()}}}return 32}IEj(fb,ac,Dc,Sc,xb){if(!this.g5)return 16;if(!xb)return 8;if(1===Dc)return 32;ac=Object(Ma.a)(String,xb);if(!ac||!ac.length)return 8;this.Gd?this.Gd.ikb(ac):this.eM.zQa(fb,xb);return 32}Xfg(fb,ac,Dc,Sc,xb){if(!this.g5)return 16;if(!xb)return 8;if(1===Dc)return 32;if(this.Gd){if(!xb||!xb.assetId||!n.AFrameworkApplication.J2c(xb.assetId))return 8;xb.nonPersistedSettings||(xb.nonPersistedSettings={});xb.nonPersistedSettings.ShowFeedback=
n.AFrameworkApplication.iF;!this.gFg&&this.ZCb&&(this.gFg=!0,fb=window.performance.now()-this.ZCb,h.ULS.sendTraceTag(512288597,220,50,"Apps for office load time {0}",fb));fb=this.Gd.Exb(xb);if(fb=this.Gd.zQ(fb))return this.Gd.lmh(fb.instanceId,xb),32;this.Gd.F9k(xb)}else this.ZCb||(this.ZCb=window.performance.now()),this.eM.Eja(),this.eM.zQa(fb,xb);return 32}qGj(fb,ac,Dc,Sc,xb){if(1===Dc)return this.g5?32:8;if(!this.g5)return 16;if(!(xb&&xb.qw&&-1!==xb.qw.state&&xb.qw.Pya&&this.Gd))return 8;fb=this.Gd.sEa(xb.jp.id);
if(!fb)return 8;ac=this.Eb.xd(4,void 0,void 0,void 0,!0);try{ac.hc(fb),fb.setValue(oa.a.Ctb,xb.qw.state),fb.setValue(oa.a.R7a,xb.qw.Pya),fb.setValue(va.a.V_b,xb.jp.storeType)}finally{ac&&ac.dispose()}return 32}dAj(fb,ac,Dc,Sc,xb){return this.g5?xb?1===Dc?32:this.Gd&&xb&&xb.length?this.Gd.rZd(xb)?32:8:8:8:16}a0a(fb,ac,Dc,Sc,xb){var Ta;if(2===Dc){ac=xb.callback;if(!ac)return 16;Ia.a("AllowQueryAddinsForStoreTypes")?this.Gd?this.NVk(ac,null!==(Ta=xb.storeType)&&void 0!==Ta?Ta:OSF.StoreTypeEnum.MarketPlace):
(xb=Object.assign({},xb),this.eM.zQa(fb,xb)):this.MVk(ac)}return 32}NVk(fb,ac){const Dc=new I.a;Dc.callbackFunc=fb;Dc.storeType=ac;Dc.fromInsertDialog=!1;Dc.refresh="true"===fa.a.instance.getItem(sa.a.DTd);this.Gd.Ui.queryEntitlementDetails(Dc)}MVk(fb){const ac=new I.a;ac.callbackFunc=fb;ac.storeType=OSF.StoreTypeEnum.MarketPlace;ac.fromInsertDialog=!1;ac.refresh="true"===fa.a.instance.getItem(sa.a.DTd);this.Gd.Ui.queryEntitlementDetails(ac)}xQb(fb){const ac=new v.a;ac.add(fb);fb={};fb[sa.a.uJc]=
ac;fb[sa.a.j8]=3;this.ia.Ka(ma.a.s4c,2,fb)}aQj(fb,ac){const Dc=this.ta.Ba;if(!Dc||this.qf.$c(Dc))return 16;if(!this.hj.iD(Dc,1))return this.hj.KD(Dc),16;try{return this.Bkg(fb,Dc,Dc.Db,ac)}catch(Sc){return 8}}Bkg(fb,ac,Dc,Sc){Dc=ac.WMi(fb.width,fb.height,ac.zs()+1);bb.a.Xxf(Dc,fb,this.Gd);this.qr.zT([Object(Ma.a)(4,Dc)],ac,Sc);Ha.a.add(fb.solutionId,fb.targetType,fb.storeId,fb.storeType,fb.version);return 32}n_c(fb){if(!this.Gd.zQ(fb.solutionId)){var ac=this.Gd.sEa(fb.solutionId),Dc=this.Gd.fUc();
if(ac){Dc=new Na.a(ac);if(!Dc.visibility){let Sc=this.Eb.xd(4,void 0,void 0,void 0,!0);try{Sc.hc(ac),ac.setValue(va.a.X_b,!0),ac.setValue(va.a.V_b,fb.storeType)}finally{Sc&&Sc.dispose()}}this.Gd.ikb(Dc.id)}else{ac=bb.a.DJi(this.nad.value,fb,this.Gd);fb=this.Eb.xd(4,void 0,void 0,void 0,!0);try{fb.hc(Dc),bb.a.Tai(Dc,ac)}finally{fb&&fb.dispose()}}}}}Object(K.a)(Za,"AppForOfficeActor",null,[251])},1034:function(K,U,d){K=d(0);var h=d(318),e=d(27),r=d(47),m=d(7),n=d(19),z=d(1244),v=d(36),x=d(28);class B{}
B.speechMode="Subtitles";B.ZQf=[B.speechMode];B.sourceLanguage=null;B.targetLanguages=null;B.speechFDBase=null;B.podSessionId=null;B.vQh=null;B.docId=null;B.webServiceBase=null;B.userSessionId=e.AFrameworkApplication.userSessionId;Object(K.a)(B,"PPTSpeechClientConfig",null,[]);var D=d(77);class w{constructor(){this.xa=new D.a}onFinalRecognitionText(da){this.xa.raiseEvent("OnFinalRecognitionText",da)}onPartialRecognitionText(da){this.xa.raiseEvent("OnPartialRecognitionText",da)}onError(da){this.xa.raiseEvent("OnError",
da)}onSpeechRecognitionStarted(da){this.xa.raiseEvent("OnSpeechRecognitionStarted",da)}onEventUpdate(da){this.xa.raiseEvent("OnEventUpdate",da)}wfi(da){this.xa.addHandler("OnFinalRecognitionText",da)}r7k(da){this.xa.removeHandler("OnFinalRecognitionText",da)}yhi(da){this.xa.addHandler("OnPartialRecognitionText",da)}E8k(da){this.xa.removeHandler("OnPartialRecognitionText",da)}qfi(da){this.xa.addHandler("OnError",da)}m7k(da){this.xa.removeHandler("OnError",da)}wii(da){this.xa.addHandler("OnSpeechRecognitionStarted",
da)}h9k(da){this.xa.removeHandler("OnSpeechRecognitionStarted",da)}sfi(da){this.xa.addHandler("OnEventUpdate",da)}o7k(da){this.xa.removeHandler("OnEventUpdate",da)}}Object(K.a)(w,"PPTSpeechClientObserverController",null,[]);var J=d(392),G=d(469);class M{constructor(){this.accessToken=null}}Object(K.a)(M,"IAuthenticationProvider",null,[]);class N{constructor(){this.docId=this.podsSessionId=this.webServiceBase=this.userDataCenterClusterId=null}}Object(K.a)(N,"IDocumentDownloadConfig",null,[]);class R{constructor(){this.documentDownloadConfig=
this.userSessionId=this.speechFDBase=this.properties=this.targetLanguages=this.sourceLanguage=this.speechMode=null;this.clientApp=0;this.clientMetaData=null;this.captureAudioPauseResumeRecordingState=this.requestServiceCustomEndpoint=!1;this.microphoneDeviceId=null}}Object(K.a)(R,"ISpeechConfig",null,[]);class C{constructor(da){this.J5=da}onFinalText(){}onFragmentText(){}onFinalRecognitionText(da,Z){this.J5.onFinalRecognitionText(da,Z)}onPartialRecognitionText(da,Z){this.J5.onPartialRecognitionText(da,
Z)}onError(da){if("ErrorNone"!==da)switch(da){case "ErrorInvalidSubscriptionFromConfig":case "ErrorInvalidRegionFromConfig":case "ErrorAddSessionFailure":case "ErrorCreateSpeechSessionBadRequest":this.J5.onError("AccessDenied");break;case "ErrorSpeechHandlerWebSocketFailure":case "ErrorProtobufDeserializationFailure":case "ErrorConnectionRetryFailure":this.J5.onError("FailedToConnect");break;case "ErrorWaitAudioTimeout":case "ErrorInitialBabbleTimeout":case "ErrorCustomEndpointTimeout":this.J5.onError("Timeout");
break;case "ErrorInitialSilenceTimeout":this.J5.onError("InitialSilenceTimeout");break;case "ErrorSpeechRecognitionFailure":case "ErrorTranslationFailure":case "ErrorFailedToGetSupportedTextLanguages":case "ErrorUnknown":this.J5.onError("UnknownError");break;case "ErrorInvalidMessage":case "ErrorAudioAbortError":case "ErrorAudioOverconstrainedError":case "ErrorAudioTypeError":this.J5.onError("MicrophoneError");break;case "ErrorAudioSecurityError":case "ErrorAudioNotAllowedError":this.J5.onError("NotAllowedError");
break;case "ErrorAudioNotFoundError":this.J5.onError("NotFoundError");break;case "ErrorAudioNotReadableError":this.J5.onError("NotReadableError");break;default:this.J5.onError("CustomError-"+da)}}onSpeechRecognitionStarted(da){J.ULS.sendTraceTag(594355729,830,50,"PPTSpeechClientObserver::OnSpeechRecognitionStarted {0}",da);this.J5.onSpeechRecognitionStarted(da)}onEventUpdate(da){this.J5.onEventUpdate(da)}}Object(K.a)(C,"PPTSpeechClientObserver",null,[572]);class O{constructor(da){this.baa=null;this.aJa=
0;this.microphoneDeviceId="";this.Jqk=new C(da)}L3j(){return 2===this.aJa}YOj(){const da=this.B0d(),Z=Object.assign(new M,{accessToken:""});this.baa&&0!==this.aJa&&(this.baa.stopSpeechRecognition(),this.aJa=0);this.baa=(new PPTSpeechClient.SpeechClientFactory).createSpeechClient(da,this.Jqk,Z,null,new G.a);return this.baa?!0:(J.ULS.sendTraceTag(594355727,830,10,"Speech client was not successfully created"),!1)}ZEh(){this.baa&&(0===this.aJa?(this.baa.startSpeechRecognition(),this.aJa=2):1===this.aJa&&
(this.baa.resumeSpeechRecognition(),this.aJa=2))}DBl(){this.baa&&(this.baa.stopSpeechRecognition(),this.aJa=0)}TNk(){this.baa&&(this.baa.pauseSpeechRecognition(),this.aJa=1)}setCustomSetting(da,Z){this.baa&&this.baa.setCustomSetting(da,Z)}B0d(){return Object.assign(new R,{speechMode:B.speechMode,sourceLanguage:B.sourceLanguage,targetLanguages:B.targetLanguages,speechFDBase:B.speechFDBase,captureAudioPauseResumeRecordingState:!0,clientApp:0,documentDownloadConfig:Object.assign(new N,{docId:B.docId,
podsSessionId:B.podSessionId,userDataCenterClusterId:B.vQh,webServiceBase:B.webServiceBase}),userSessionId:B.userSessionId,microphoneDeviceId:this.microphoneDeviceId})}}Object(K.a)(O,"PPTSpeechClientProxy",null,[]);var S;(function(da){da[da.none=0]="none";da[da.singleLineRibbon=1]="singleLineRibbon";da[da.multipleLineRibbon=2]="multipleLineRibbon";da[da.slideShowToolbar=3]="slideShowToolbar";da[da.slideShowKeyboardShortcut=4]="slideShowKeyboardShortcut";da[da.liveBroadcast=5]="liveBroadcast"})(S||
(S={}));Object(K.b)("TranscriptionEntryPoint",S);var T=d(684),ca=d(69);d.d(U,"a",function(){return L});class L{constructor(){this.tf=this.daa=this.uD=this.Xgb=this.Wr=this.jb=this.la=this.Ub=this.Hc=null;this.MEb=!1;this.Xl=null;this.fhb=this.zkc=0;this.BIg=!1;this.eJa=this.dJa="";this.e8c=!1;this.zGe="";this.sve=0;this.hEb=this.c1=this.FHb="";this.xO=null;this.jxa={};this.lna=new w;this.O$=new O(this.lna);L.bPj()}init(da,Z,fa,aa,ja,I,sa){x.a.J(512495707,830,50,"SlideshowSubtitles.Init");this.tf=
Z;this.la=da;this.Hc=fa;this.jb=aa;this.Xl=ja;this.Ub=I;this.xO=sa;this.Wr=document.createElement("div");this.Wr.id="SubtitleContainer";this.Wr.className="SubtitleContainer";this.Wr.style.display=ca.a.Pe;this.Wr.style.visibility=ca.a.Xs;this.Xgb=document.createElement("div");this.Xgb.id="SubtitleResultDiv";this.Xgb.className="SubtitleResultDiv";this.Hc.Y1i&&(this.Xgb.style.direction="rtl");this.uD=document.createElement("span");this.uD.id="SubtitleResultSpan";this.uD.className="SubtitleResultSpan";
this.uD.setAttribute("aria-hidden","true");this.daa=document.createElement("span");this.daa.id="SubtitleAccessibilitySpan";this.daa.className="SubtitleAccessibilitySpan";this.daa.innerText="";this.daa.setAttribute("lang",this.Hc.bAa);this.daa.setAttribute("aria-live","assertive");this.daa.setAttribute("aria-label",ResourceStrings.L_SubtitleAccessibilityWindow);this.daa.setAttribute("aria-atomic","true");this.Xgb.appendChild(this.uD);this.Xgb.appendChild(this.daa);this.Wr.appendChild(this.Xgb);this.tf.appendChild(this.Wr);
h.a.instance.rb(this.uD,()=>!1);e.AFrameworkApplication.fa.z4?this.en():e.AFrameworkApplication.fa.ff(Object(m.a)(this,this.en,"onFullAppSettingsReady"))}en(){this.FHb=this.getUserId();this.c1=e.AFrameworkApplication.fa.Ha("TenantId");this.hEb=this.la.hostAuthType||e.AFrameworkApplication.fa.Ha("HostAuthType")||"Unknown"}getUserId(){let da=e.AFrameworkApplication.fa.Ha("PptEditingUserId");r.a.Xa(da)&&(da=e.AFrameworkApplication.fa.Ha("LoggableUserId"),x.a.J(512495706,822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",
r.a.Xa(da)));return da}T6k(){this.Wr.style.display=ca.a.Pe;this.Wr.style.visibility=ca.a.Xs}transcribe(da,Z,fa,aa,ja,I){this.QBb()&&(this.Xl.instance.show(ResourceStrings.L_SubtitleDetection_SoundReminder,T.a.thd),this.zkc=window.setTimeout(Object(m.a)(this,this.zge,"hideSoundReminderNotification"),3E3));this.pPl(Z,fa,aa,this.Hc);this.O$&&(this.O$.microphoneDeviceId=this.xO.microphoneDeviceId);this.Hc.Qh&&this.O$.YOj()?(this.jxa.StartTime=I,this.jxa.LastError="ErrorNone",this.jxa.EntryPoint=S[ja],
this.lna.wfi(Object(m.a)(this,this.w9g,"onFinalRecognitionTextHandler")),this.lna.yhi(Object(m.a)(this,this.Z$g,"onPartialRecognitionTextHandler")),this.lna.qfi(Object(m.a)(this,this.Hbh,"onSpeechProxyErrorHandler")),this.lna.sfi(Object(m.a)(this,this.Ibh,"onSpeechProxyEventUpdateHandler")),this.lna.wii(Object(m.a)(this,this.Jbh,"onSpeechRecognitionStartedHandler")),this.O$.ZEh(),this.O$.setCustomSetting("clientMetadata",JSON.stringify(this.a6f())),this.uD.innerText="["+ResourceStrings.L_SubtitleInitMessage+
"]",this.uD.style.color="rgba( 255, 255, 0, 1 )",this.setVisibility(5!==ja),this.BJc(),this.jb.dJc(Object(m.a)(this,this.Ixa,"onGetCurrentSlideDimensionsHandler")),this.jb.KQa(Object(m.a)(this,this.Qjd,"onSlideChangedHandler"))):this.R3e()}a6f(da=""){const Z=v.b(e.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),fa={};fa.userID=this.FHb;fa.tenantId=this.c1;fa.identityProvider=this.hEb;fa.audienceChannel="";fa.audienceGroup=Z.Ring||"Unknown";fa.buildVersion=e.AFrameworkApplication.buildVersion||
"Unknown";fa.locale=this.la.uKa||"Unknown";fa.wacHost=Z.Host||"Unknown";fa.wacDatacenter=Z.WACDatacenter||"Unknown";fa.livePragueSessionInfo=da;return fa}R3e(){this.Wr.style.display=ca.a.Pe;this.Wr.style.visibility=ca.a.Xs;this.O$.DBl();this.lna.r7k(Object(m.a)(this,this.w9g,"onFinalRecognitionTextHandler"));this.lna.E8k(Object(m.a)(this,this.Z$g,"onPartialRecognitionTextHandler"));this.lna.m7k(Object(m.a)(this,this.Hbh,"onSpeechProxyErrorHandler"));this.lna.o7k(Object(m.a)(this,this.Ibh,"onSpeechProxyEventUpdateHandler"));
this.lna.h9k(Object(m.a)(this,this.Jbh,"onSpeechRecognitionStartedHandler"));this.jb.bpd(Object(m.a)(this,this.Ixa,"onGetCurrentSlideDimensionsHandler"));this.jb.dkb(Object(m.a)(this,this.Qjd,"onSlideChangedHandler"));this.QBb()&&this.Xl.instance.hide();this.jxa.EndTime=Date.now();x.a.J(512495705,817,15,JSON.stringify(this.jxa,L.BLl));this.jxa={};this.Hc.Ywb=!1}BJc(){let da=3;this.jxa.LastPosition=this.Hc.fw;"AboveSlide"===this.Hc.fw&&this.Wr.style.visibility===ca.a.Oz?(this.Wr.style.display=ca.a.nba,
this.Wr.style.backgroundColor="black",this.Wr.style.bottom="auto"):"BelowSlide"===this.Hc.fw&&this.Wr.style.visibility===ca.a.Oz?(this.Wr.style.display=ca.a.nba,this.Wr.style.backgroundColor="black",this.Wr.style.bottom="3%",da=-1):"TopOverlay"===this.Hc.fw?(this.Wr.style.display=ca.a.nba,this.Wr.style.backgroundColor="transparent",this.Wr.style.bottom="auto",da=5):"BottomOverlay"===this.Hc.fw&&(this.Wr.style.display=ca.a.nba,this.Wr.style.backgroundColor="transparent",this.Wr.style.bottom="5%",da=
-1);this.MEb&&document.getElementById("LiveURLBarLayerHost")?this.Wr.style.top=-1<da?String.format("calc({0}% + {1})",da.toString(),"26px"):"auto":(this.Wr.style.top=-1<da?da.toString()+"%":"auto",this.sAf())}isVisible(){return this.Wr.style.visibility===ca.a.Oz}bJh(da,Z=""){B.ZQf=da?["Live","Subtitles"]:["Subtitles"];this.MEb=da;this.setVisibility(this.Wr.style.visibility===ca.a.Oz);this.BJc();this.O$.setCustomSetting("clientMetadata",JSON.stringify(this.a6f(Z)));this.O$.setCustomSetting("slideIndex",
this.sve);this.O$.setCustomSetting("currentSpeechModes",JSON.stringify(B.ZQf))}Pga(da){this.Wr.style.cursor=da?"default":"none"}sAf(){this.uD.style.fontSize=Math.floor(this.Wr.clientHeight/2/1.5).toString()+"px";this.zGe=Math.floor(this.Wr.clientHeight/12-2)+"px";this.uD.style.display="inline"}setVisibility(da){this.Wr?(null===da&&(da=this.Wr.style.visibility===ca.a.Xs),this.Wr.style.visibility=da?ca.a.Oz:ca.a.Xs):x.a.J(509703457,817,50,"SlideshowSubtitles::setVisibility SubtitleContainer is null")}Ixa(){this.sAf()}Qjd(da,
Z){this.sve=Z.slideIndex;this.O$.L3j()&&this.MEb&&(this.O$.setCustomSetting("currentSlideIndex",this.sve),x.a.J(512495704,817,50,"SlideshowSubtitles::OnSlideChangedHandler Updated current slide index for live"))}setMicrophoneState(da){da?(this.O$.TNk(),this.yrc(),this.e8c=!0,this.Ub&&this.Ub.instance&&this.Ub.instance.gxh()):(this.O$.ZEh(),this.Ub&&this.Ub.instance&&this.Ub.instance.hxh())}zge(){this.QBb()&&(window.clearTimeout(this.zkc),this.Xl.instance.hide())}pPl(da,Z,fa,aa){B.sourceLanguage=aa.Fpa;
B.targetLanguages=aa.anb;B.podSessionId=da;B.vQh=Z;B.docId=fa;B.webServiceBase=this.la.podsWebServiceBase;B.speechFDBase=e.AFrameworkApplication.fa.Ha("715");da=!!this.Ub&&!!this.Ub.instance&&(this.Ub.instance.gTa||this.Ub.instance.kr);B.speechMode=this.Ub&&this.Ub.instance&&this.Ub.instance.Er&&this.Ub.instance.lEa||da?"Live":"Subtitles"}uUf(da,Z){this.BIg||(this.uD.style.color="rgba( 255, 255, 255, 1 )",window.clearTimeout(this.fhb),this.uD.innerText=this.Lvj(da,Z),this.uD.scrollTop=this.uD.scrollHeight,
this.fhb=window.setTimeout(Object(m.a)(this,this.yrc,"resetSubtitlesToEmpty"),1E4),Z&&(this.daa.innerText=da,this.daa.focus()),this.uD.style.padding=r.a.Xa(da)?"0px":this.zGe)}Av(da){this.BIg||(this.uD.style.color="rgba( 255, 255, 0, 1 )",r.a.Xa(da)&&(da=ResourceStrings.L_SubtitleGenericErrorMessage),window.clearTimeout(this.fhb),this.uD.innerText="["+da+"]",this.uD.scrollTop=this.uD.scrollHeight,this.fhb=window.setTimeout(Object(m.a)(this,this.yrc,"resetSubtitlesToEmpty"),1E4),this.uD.style.padding=
this.zGe,this.daa.innerText="",this.daa.focus())}KFj(da){if(null!==da)switch(da){case "NotAllowedError":case "NotFoundError":case "NotReadableError":case "MicrophoneError":this.Av(ResourceStrings.L_SubtitleAudioDeviceErrorMessage);this.jxa.LastError="MicrophoneError";break;case "FailedToConnect":this.Av(ResourceStrings.L_SubtitleRetryErrorMessage);this.jxa.LastError="FailedToConnect";break;case "AccessDenied":case "UnknownError":case "Timeout":this.Av(ResourceStrings.L_SubtitleGenericErrorMessage);
this.jxa.LastError="FailedToCreateSpeechSession";break;default:x.a.J(512495703,830,15,"HandleSpeechProxyError {0}",da)}}w9g(da,Z){this.Wr.style.visibility!==ca.a.Xs&&this.uUf(Z[this.Hc.anb],!0)}Z$g(da,Z){this.Wr.style.visibility!==ca.a.Xs&&this.uUf(Z[this.Hc.anb],!1)}Hbh(da,Z){x.a.J(512495702,830,10,"OnSpeechProxyErrorHandler {0}",Z);(da=Z.toString())&&(-1<da.indexOf("NotAllowedError")||-1<da.indexOf("NotFoundError")||-1<da.indexOf("NotReadableError")||-1<da.indexOf("MicrophoneError"))&&this.QBb()&&
this.Xl.instance.show(ResourceStrings.L_SubtitleDetection_NoMicrophone,T.a.d_a);this.KFj(da)}Jbh(da,Z){({SlideShowCoreFrame:da}=d(742));const {SlideshowFrame:fa}=d(1031);x.a.J(512495701,830,50,"OnSpeechRecognitionStartedHandler {0}",Z.toString());Object(n.a)(da,this.jb)?Object(z.a)(da,this.jb).hkd(Z.toString()):Object(n.a)(fa,this.jb)&&this.la.bmd&&Object(z.a)(fa,this.jb).hkd(Z.toString());this.yrc();this.QBb()&&this.Xl.instance.hide()}Ibh(da,Z){if(this.QBb())switch(da=Z.eventName,da){case "MediaEvent":"AudioDeviceConnected"===
Z.mediaStatus&&this.Xl.instance.show(ResourceStrings.L_SubtitleDetection_MicReady,T.a.thd);break;case "ConnectionRetry":this.Xl.instance.show(ResourceStrings.L_SpeechGenericRetryErrorMessage,T.a.d_a);this.Av(ResourceStrings.L_SubtitleGenericErrorMessage);break;case "QualityStatusUpdate":const fa=Z.shortCode;da=Z.longCode;const aa=Z.shortString,ja=Z.longString;switch(Z.severity){case 0:this.Xl.instance.hide();break;case 1:(Z=0<fa?L.GY[fa]:aa)&&this.Xl.instance.show(Z,T.a.CIb);break;case 2:(Z=0<fa?
L.GY[fa]:aa)&&this.Xl.instance.show(Z,T.a.d_a),Z=null===da?ja:L.GY[da],r.a.Xa(Z)||(window.clearTimeout(this.fhb),this.Av(Z),this.fhb=window.setTimeout(Object(m.a)(this,this.yrc,"resetSubtitlesToEmpty"),3E4))}break;default:x.a.J(512495700,830,50,"OnSpeechProxyEventUpdateHandler Event {0}",da)}}QBb(){return this.la.pptEditorVoiceUXEnabled&&!!this.Xl&&!!this.Xl.instance}yrc(){this.uD.style.color="rgba( 255, 255, 255, 1 )";this.uD.innerText="";this.uD.scrollTop=this.uD.scrollHeight;this.eJa=this.dJa=
"";this.e8c=!1;this.fhb=0;this.uD.style.padding="0px"}Lvj(da,Z){this.e8c?this.vli(da):this.l$k(da);this.e8c=Z;return r.a.Xa(this.dJa)||r.a.Xa(this.eJa)?r.a.Xa(this.dJa)?this.eJa:this.dJa:this.dJa+"\n"+this.eJa}vli(da){this.dJa=r.a.Xa(this.eJa)?this.dJa:this.eJa;this.eJa=da}l$k(da){r.a.Xa(this.dJa)||r.a.Xa(this.eJa)?this.dJa=da:this.eJa=da}static get instance(){return L.Sp}static bPj(){L.GY[1]=ResourceStrings.L_SubtitleDetection_Listening;L.GY[2]=ResourceStrings.L_SubtitleDetectionText_AudioQualityIssue;
L.GY[3]=ResourceStrings.L_SubtitleDetectionText_HighBackgroundNoise;L.GY[4]=ResourceStrings.L_SubtitleDetectionText_SpeakingTooLoud;L.GY[5]=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet}static BLl(da,Z){return"undefined"===typeof Z?null:Z}}L.GY=Array(20);L.Sp=new L;Object(K.a)(L,"SlideshowSubtitles",null,[515])},1036:function(K,U,d){K=d(0);var h=d(27),e=d(55),r=d(56),m=d(269),n=d(314);class z{constructor(Na,Ia=null){this.a3h=Na;this.VS=Ia||n.a.hae(e.a.Z7a,"")}get xu(){return this.a3h}get Ob(){return this.VS}b_e(Na){this.Ob.d++;
return this.xu.b_e(Na)}dOb(Na){this.Ob.e++;return this.xu.dOb(Na)}$H(Na){this.Ob.f++;return this.xu.$H(Na)}t1a(Na){this.Ob.h++;return this.xu.t1a(Na)}VY(Na){this.Ob.i++;return this.xu.VY(Na)}TY(Na){this.Ob.j++;return this.xu.TY(Na)}A6(Na){this.Ob.k++;return this.xu.A6(Na)}UY(Na){this.Ob.l++;return this.xu.UY(Na)}TZe(Na){this.Ob.m++;return this.xu.TZe(Na)}JLa(Na,Ia=!1){this.Ob.n++;return this.xu.JLa(Na,Ia)}Nee(){this.Ob.o++;return this.xu.Nee()}H2e(){this.Ob.p++;return this.xu.H2e()}rNb(Na){this.Ob.m++;
return this.xu.rNb(Na)}sr(Na){this.Ob.q++;return this.xu.sr(Na)}ppa(Na){this.Ob.r++;return this.xu.ppa(Na)}LNb(Na){this.Ob.g++;return this.xu.LNb(Na)}Tsd(Na){return this.xu.Tsd(Na)}A1a(Na){this.Ob.s++;return this.xu.A1a(Na)}ysd(Na){this.Ob.s++;return this.xu.ysd(Na)}Jga(Na){this.Ob.s++;return this.xu.Jga(Na)}z1a(Na){this.Ob.s++;return this.xu.z1a(Na)}vlb(Na){this.Ob.t++;return this.xu.vlb(Na)}Usd(Na){this.Ob.u++;return this.xu.Usd(Na)}Psc(Na){this.Ob.v++;return this.xu.Psc(Na)}rpa(Na){return this.xu.rpa(Na)}$rd(Na){this.Ob.z++;
return this.xu.$rd(Na)}KWe(){return this.xu.KWe()}QLa(Na,Ia){this.Ob.w++;this.Ob.x++;return this.xu.QLa(Na,Ia)}R1(Na){this.Ob.y++;return this.xu.R1(Na)}s1a(Na){this.Ob.z++;return this.xu.s1a(Na)}clearFormatting(){return this.xu.clearFormatting()}clone(){return new z(this.xu.clone(),this.Ob)}}Object(K.a)(z,"FormattingStewardUsageCollector",null,[1329]);class v extends z{constructor(Na,Ia=null){super(Na,Ia)}get Y5(){return this.xu}get yE(){return this.Y5.yE}set yE(Na){this.Y5.yE=Na}get textIndent(){return this.Y5.textIndent}get marginLeft(){return this.Y5.marginLeft}get Gkd(){return this.Y5.Gkd}get lineSpacing(){return this.Y5.lineSpacing}get Sga(){return this.Y5.Sga}get B4c(){return this.Y5.B4c}get nga(){return this.Y5.nga}get paragraph(){return this.Y5.paragraph}set paragraph(Na){this.Y5.paragraph=
Na}get u$a(){return this.Y5.u$a}exd(Na){return this.Y5.exd(Na)}A7e(Na){return this.Y5.A7e(Na)}clone(){const Na=this.xu.clone();return new v(Na,this.Ob)}}Object(K.a)(v,"FormattingStewardUsageCollector",z,[1328,1329]);var x=d(34),B=d(76),D=d(187),w=d(683),J=d(54),G=d(147),M=d(74),N=d(59),R=d(317),C=d(1130),O=d(347),S=d(47),T=d(1252),ca=d(1247),L=d(1246),da=d(114),Z=d(41),fa=d(83),aa=d(42),ja=d(38),I=d(88),sa=d(307);class ka{}ka.yellow="FFFF00";ka.lime="00FF00";ka.aqua="00FFFF";ka.fuchsia="FF00FF";ka.blue=
"0000FF";ka.red="FF0000";ka.navy="000080";ka.teal="008080";ka.green="008000";ka.purple="800080";ka.maroon="800000";ka.olive="808000";ka.gray="808080";ka.Syl="C0C0C0";ka.black="000000";Object(K.a)(ka,"FontHighlightColorEnum",null,[]);var Ma=d(349),Ea=d(51),ma=d(902),va=d(376),Ca=d(109);class oa{constructor(Na,Ia,Qa,qa,Wa,Hb,jc,gc,$b=null,wb=!1){this.nv=this.EEc=null;this.mXb=0;this.Jcf=this.lXb=null;this.S2=0;this.DPa=this.VGc=this.iDc=this.CGc=this.m5a=this.Bia=this.vDc=this.gHc=null;this.QRf=.25*
da.Font.MI;this.paragraph=Na;this.If=Ia;this.bL=Qa;this.OP=qa;this.Zha=Wa;this.PV=Hb;this.GZ=jc;this.v4a=gc;$b?(Ca.a(4223818,307,!!$b.nv),this.nv=$b.nv.KMc(this.paragraph),this.mXb=$b.mXb,this.lXb=$b.lXb,$b.Bia&&(this.Bia=new ma.a,this.Bia.afterSpacing.value=$b.Bia.afterSpacing.value,this.Bia.beforeSpacing.value=$b.Bia.beforeSpacing.value),$b.m5a&&(this.m5a=$b.m5a.clone()),this.S2=$b.S2,this.VGc=$b.VGc.clone(),this.gHc=$b.gHc,this.vDc=$b.vDc,this.CGc=$b.CGc,this.iDc=$b.iDc,$b.nga&&(this.DPa=$b.nga)):
(this.nv=new sa.a(this.paragraph,0),this.nv.formatting=new Ma.a(this.nv,R.a.nil),Ia=Ea.a.YRa(Na),Ia=this.OP.Bs(Ia),this.gkl(Ia),oa.Dul(Na)?(this.Zha.WZe(this.nv.formatting,Ia,wb),this.S2=Na.Ua(Z.a.Vl)?Na.eb(Z.a.Vl):0):this.S2=-1,this.mXb=0,this.lXb=null,this.Bia=this.hfj(),this.v4a&&(this.Bia=this.Zha.VW(Na),this.m5a=this.Zha.Lae(Na),this.CGc=this.Zha.tUa(Na),this.iDc=this.Zha.c9(Na)),this.VGc=new C.DictionaryPropertySet,this.Zha.HZe(this.nv.formatting,Na,wb))}get paragraph(){return this.EEc}set paragraph(Na){Ca.a(4223816,
307,!!Na&&x.ParagraphReader.ae(Na));this.EEc=Na}get u$a(){return this.nv.formatting}get Onc(){return this.mXb}get $dh(){return this.lXb}get q3(){return this.Jcf}get yE(){return this.S2}set yE(Na){Ca.a(4223817,307,1===Na||2===Na||3===Na||ja.a.instance.ga(54)&&6===Na);this.S2=Na}get textIndent(){return this.gHc}get marginLeft(){return this.vDc}get Gkd(){return this.Bia}get lineSpacing(){return this.m5a}get Sga(){return this.CGc}get B4c(){return this.iDc}get nga(){return this.DPa}gkl(Na){const Ia=this.OP.language(Na);
Ia&&this.If.Nsc(this.nv.formatting,Ia,0,Na.cache.XVa,!1)}hfj(){if(ja.a.instance.ga(54))return null;const Na=new ma.a;Na.afterSpacing.value=this.QRf;Na.beforeSpacing.value=this.QRf;return Na}b_e(Na){(Na=m.a.He(Na))&&this.If.u1a(this.nv.formatting,Na.LCID);return!0}dOb(){return!1}$H(Na){this.If.$H(this.nv.formatting,Na);return!0}t1a(Na){this.If.setItalic(this.nv.formatting,Na);return!0}VY(Na){this.If.VY(this.nv.formatting,Na);return!0}TY(Na){this.If.TY(this.nv.formatting,Na);return!0}A6(Na){this.If.A6(this.nv.formatting,
Na);return!0}UY(Na){this.If.UY(this.nv.formatting,Na);return!0}TZe(Na){if(0>=Na)return!1;this.If.Xq(this.nv.formatting,Na);return!0}JLa(Na,Ia){if(!Na||""===Na)return!1;if(({fontInfo:Qa}=O.FontUtils.TKl(Na)).returnValue)return this.If.jV(this.nv.formatting,Qa.fontName),!0;var Qa=!1;const qa=O.FontUtils.pG(Na);Ia&&this.tcc(qa,this.PV)&&(this.PV.createFontUrl(Na),Qa=!0);this.tcc(qa,this.GZ)&&(Qa=!0);Qa&&this.If.jV(this.nv.formatting,qa);return Qa}tcc(Na,Ia){return!!Ia&&Ia.isEnabled&&Ia.tcc(Na)}Nee(){this.If.iYc(this.nv.formatting);
return!0}H2e(){this.If.xud(this.nv.formatting);return!0}rNb(Na){if(0>=Na)return!1;this.If.rNb(this.nv.formatting,Na);return!0}sr(Na){var {Box4PasteSteward:Ia}=d(250);if(!this.If.Crg(Na)){if(null===Na||""===Na)return!1;Na=Ia.U8a(Na)}Ia=null;this.nga&&this.nga.hasOwnProperty(aa.a.listLevel.id.toString())&&(Ia=this.nga[aa.a.listLevel.id.toString()]);this.If.sr(this.nv.formatting,Na,Ia);return!0}ppa(Na){const {Box4PasteSteward:Ia}=d(250);if(!Na||""===Na||ja.a.instance.ga(49)&&!oa.Rxj().contains(Na)||
this.Zha.iBh(this.nv.formatting))return!1;this.If.ppa(this.nv.formatting,Ia.U8a(Na));return!0}s1a(Na){this.If.s1a(this.nv.formatting,Na);return!0}LNb(Na){this.If.LNb(this.nv.formatting,Na);return!0}Tsd(Na){let Ia=0;switch(S.a.rg(Na)){case "small-caps":Ia=1;break;case "uppercase":Ia=2}this.If.Pm(this.nv.formatting,fa.a.capitalization,Ia);return!0}$rd(Na){const {Box4PasteSteward:Ia}=d(250);if(!Na||""===Na)return!1;this.VGc.setValue(Z.a.$Lc,parseInt(Ia.U8a(Na),16));return!0}z1a(Na){return 0>=Na?!1:this.ysd(I.StyleReader.Ctj(Na))}A1a(Na){this.clearFormatting();
this.mXb=Na;return!0}ysd(Na){const {Box4PasteSteward:Ia}=d(250);return Na&&0<Na.length&&Ia.uPb&&Ia.uPb.kH(Na)?(this.lXb=Na,!0):!1}Jga(Na){const {Box4PasteSteward:Ia}=d(250);return Na&&0<Na.length&&Ia.uPb&&Ia.uPb.kH(Na)?(this.Jcf=Na,!0):!1}A7e(Na){if(this.q3){Na=d(250).Box4PasteSteward.uPb||I.StyleReader.JL(Na);if(!Na)return Ca.a(41968715,307,!1),!1;(Na=Na.kH(this.q3))&&this.If.Jga(this.nv.formatting,Na);return!0}return!1}QLa(Na,Ia){if(ja.a.instance.ga(54))return!1;Ca.a(5297416,307,0<=Na&&0<=Ia);0<=
Na&&(this.Bia.beforeSpacing.value=Na);0<=Ia&&(this.Bia.afterSpacing.value=Ia);return 0<=Na||0<=Ia}R1(Na){if(!ja.a.instance.ga(54)||!Na)return!1;const Ia=parseFloat(S.a.substring(Na,0,S.a.rg(Na).indexOf("px")));if(!isNaN(Ia))return this.m5a=new va.a(3,T.a.qga(Ia,1)),!0;Na=parseFloat(S.a.substring(Na,0,S.a.rg(Na).indexOf("%")));return isNaN(Na)?!1:(this.m5a=new va.a(2,Na/100),!0)}vlb(Na){let Ia=0;if(!Na||""===Na)return!1;switch(Na){case "left":Ia=1;break;case "center":Ia=2;break;case "right":Ia=3;break;
case "justify":ja.a.instance.ga(54)&&(Ia=6)}if(0===Ia)return!1;this.yE=Ia;return!0}Usd(Na){this.gHc=Na;return!0}Psc(Na){this.vDc=Na;return!0}rpa(Na){this.DPa=JSON.parse(Na);return this.nga?!0:!1}clearFormatting(){this.nv.formatting=new Ma.a(this.nv,R.a.nil);return!0}KWe(){this.S2=0;return!0}exd(Na){var {Box4PasteSteward:Ia}=d(250);if(!ja.a.instance.ga(71))return!1;if(0<this.Onc&&Ia.gKa[this.Onc]){Ca.a(4223819,307,1<=this.Onc);Ca.a(4223820,307,7>=this.Onc);Ia=I.StyleReader.JL(Na);if(!Ia)return Ca.a(4223821,
307,!1),!1;Ia=Ia.kH(d(250).Box4PasteSteward.gKa[this.Onc]);this.bL.aba(Ia,Na,!1);return!0}if(this.$dh){Ia=d(250).Box4PasteSteward.uPb||I.StyleReader.JL(Na);if(!Ia)return Ca.a(41968716,307,!1),!1;this.bL.aba(Ia.kH(this.$dh),Na,!1);return!0}return!1}clone(){return new oa(this.paragraph,this.If,this.bL,this.OP,this.Zha,this.PV,this.GZ,this.v4a,this)}static Rxj(){oa.dQ||(oa.dQ=new ca.a(L.a.Ml()),oa.dQ.add(ka.yellow),oa.dQ.add(ka.lime),oa.dQ.add(ka.aqua),oa.dQ.add(ka.fuchsia),oa.dQ.add(ka.blue),oa.dQ.add(ka.red),
oa.dQ.add(ka.navy),oa.dQ.add(ka.teal),oa.dQ.add(ka.green),oa.dQ.add(ka.purple),oa.dQ.add(ka.maroon),oa.dQ.add(ka.olive),oa.dQ.add(ka.gray),oa.dQ.add(ka.Syl),oa.dQ.add(ka.black));return oa.dQ}static Dul(Na){if(!ja.a.instance.ga(71))return!0;Na=I.StyleReader.HQ(I.StyleReader.tE(Na));return Na===I.StyleReader.RQh||Na===I.StyleReader.sNa||Na===I.StyleReader.UQh||Na===I.StyleReader.Jpa}}oa.dQ=null;Object(K.a)(oa,"FormattingSteward",null,[1328,1329]);class Da{N7e(){return!1}ife(Na){return Na}rpa(){}INb(){}m1c(){return!1}get k2c(){return!1}R1(){}QLa(){}lyh(){}axh(){}get lBh(){return!1}}
Object(K.a)(Da,"NoOpPasteStewardBridge",null,[349]);var ta=d(18);class ha{constructor(Na,Ia){this.Hyk=Na;this.Iyk=Ia||"Normal"}}Object(K.a)(ha,"NoteTagInfoBox4",null,[]);const Ha=Na=>{const Ia=new ta.a;for(let Qa of Na)Na=new ha(Qa.Hyk,Qa.Iyk),Ia.add(Na);return Ia};d.d(U,"a",function(){return bb});class bb{constructor(Na,Ia,Qa=null,qa=null){this.GZ=this.PV=null;this.j7i=h.AFrameworkApplication.fa.ka("FollowDestinationFormattingPasteIsEnabled");this.Ipf=0;this.zb=Na;this.NG=Ia;this.vZ=qa||new Da;this.VS=
Qa||n.a.hae(e.a.Z7a,"")}get Ob(){return this.VS}get characterPropertiesEditor(){return bb.mh||(bb.mh=r.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}get fontService(){return this.PV||(this.PV=r.a.instance.qb("Box4.IFontService"))}get FDa(){return this.GZ||(this.GZ=r.a.instance.qb("Box4.CustomFontService"))}reset(){}get b4b(){return this.s$d(!1)}s$d(Na){Ca.a(4223770,307,N.OutlineElementReader.ih(this.zb));const Ia=J.OutlineElementNavigator.yi(this.zb);J.OutlineElementNavigator.Te(this.zb);
Ca.a(4223771,307,!!Ia&&x.ParagraphReader.ae(Ia));Na=new oa(Ia,bb.oh,bb.wP,bb.X7i,bb.Y7i,this.fontService,this.FDa,this.j7i,void 0,Na);return new v(Na,this.Ob)}m1(){}ooa(){}u_a(){}noa(){}moa(){}Gxa(){}Fxa(){}NA(){}MA(){}q_a(){}p_a(){}Lxa(){}YJa(){}roa(){}poa(){}Kxa(){}qoa(){}r_a(){}eIb(Na){N.OutlineElementReader.ih(this.zb)?(bb.Wh.V$b(this.zb,!0),J.OutlineElementNavigator.ZJ(this.zb,!1,!1)):M.OutlineReader.ku(this.zb)?G.OutlineNavigator.saa(this.zb)?Na?(this.zb.Ni(),bb.aC.nW(this.zb,!1)):bb.Wh.Uqc(this.zb):
bb.aC.nW(this.zb,!1):Ca.a(8128524,307,!1,"Unexpected node type {0} encountered",this.zb.Bi)}cUa(Na){let Ia=null;if(Na&&Na.TU&&Na.cultureName)try{Ia=Object.assign(new w.a,{languageId:m.a.He(Na.cultureName).LCID})}catch(Qa){Ca.a(8128526,307,!1,"Setting up culture {0} encountered {1}",Na.cultureName,Qa)}Ia||null==this.NG||(Ia=Object.assign(new w.a,{languageId:this.NG}));return Ia}get UM(){return this.Ipf}set UM(Na){this.Ipf=Na}hKc(){}Rwd(){}YYd(){}get S8a(){return!1}get g9a(){return!1}d9j(Na){let Ia=
1;if(Na.spg){var Qa=0;switch(Na.listStyleType){case 1:Ia=0;break;case 7:Ia=1;break;case 8:Ia=2;break;case 9:Ia=3;break;case 10:Ia=4;break;case 11:Ia=5}}else switch(Qa=1,Na.listStyleType){case 1:Ia=0;break;case 3:Ia=1;break;case 4:Ia=2;break;case 5:Ia=3}let qa;Qa=(qa=B.ListReader.$9a)?D.a.NN(Qa,Ia,Ha(Na.g6),Na.listId,Na.listLevel,Na.levelText,Na.font):D.a.NN(Qa,Ia,Ha(Na.g6));Na.spg&&!Na.bTj&&(Qa.SA=qa&&0<Na.listId&&0<=Na.listLevel&&!Na.LJb?Na.SAl:Na.yQi);this.vZ.INb(this.zb,Qa,Na);return Qa}zY(){}wY(){}yY(){}xY(){}vY(){}uY(){}static get Wh(){return bb.Ji||
(bb.Ji=r.a.instance.resolve("Box4.IOutlineElementEditor"))}static get aC(){return bb.ay||(bb.ay=r.a.instance.resolve("Box4.IOutlineEditor"))}static get oh(){return bb.If||(bb.If=r.a.instance.resolve("Box4.IFormattingEditor"))}static get wP(){return bb.bL||(bb.bL=r.a.instance.resolve("Box4.Styles.IStyleEditor"))}static get X7i(){return bb.OP||(bb.OP=r.a.instance.resolve("Box4.IFormattingReader"))}static get Y7i(){return bb.Zha||(bb.Zha=r.a.instance.resolve("Box4.Actors.IFormattingStewardBridge"))}}
bb.Ji=null;bb.ay=null;bb.mh=null;bb.If=null;bb.bL=null;bb.OP=null;bb.Zha=null;Object(K.a)(bb,"Box4PasteStewardBase",null,[1297,1298,480])},1039:function(K,U,d){d.r(U);K=d(0);var h=d(732),e=d(1057),r=d(1043),m=d(205),n=d(7),z=d(41),v=d(74),x=d(32),B=d(39),D=d(28),w=d(43);class J{constructor(L,da){this.te=L;this.eg=da}}Object(K.a)(J,"RowSpan",null,[]);class G{constructor(L){this.VB=L;this.$Ia=[]}ISd(L,da){Array.add(this.$Ia,new J(L,da))}ldl(L){for(let da=0;da<this.$Ia.length;da++){const Z=this.$Ia[da];
L<=Z.te&&Z.te++;L<=Z.eg&&Z.eg++}}get x(){return this.VB}get Gsh(){return this.$Ia}static Wqe(L,da){return L.VB===da}static b_d(L,da){L=L.VB-da.VB;return 0<L?1:0>L?-1:0}}Object(K.a)(G,"ColSplit",null,[]);const M=(L,da,Z)=>{let fa;fa=-1;for(let aa=0;aa<L.length;++aa)if(Z(L.ga(aa),da))return fa=aa,{returnValue:!0,Ozb:fa};return{returnValue:!1,Ozb:fa}};class N{constructor(L,da){this.me=L;this.Tf=da}}Object(K.a)(N,"ColSpan",null,[]);class R{constructor(L){this.WB=L;this.$Ia=[]}ISd(L,da){Array.add(this.$Ia,
new N(L,da))}DCi(L){for(let da=0;da<this.$Ia.length;da++){const Z=this.$Ia[da];L<=Z.me&&Z.me++;L<=Z.Tf&&Z.Tf++}}get yLf(){return this.$Ia}get y(){return this.WB}static Wqe(L,da){return L.WB===da}static b_d(L,da){L=L.WB-da.WB;return 0<L?1:0>L?-1:0}}Object(K.a)(R,"RowSplit",null,[]);var C=d(970),O=d(29);class S{constructor(L,da,Z,fa,aa,ja,I,sa,ka,Ma,Ea,ma,va,Ca,oa){this.MVa=!1;this.ej=this.YLc=this.i_g=this.ged=null;this.GLh=L;this.Vc=da;this.xEh=Z;this.Z1a=fa;this.pzd=aa;this.tableNode=ja;this.Md=
I;this.eZ=sa;this.cUa=ka;this.ndl=Ma;this.ECi=Ea;this.uqd=ma;this.UMc=va;this.rows=Ca;this.cols=oa;this.$1a=0;this.rcc=!1}W7a(L){this.ged=new Date;this.i_g=L}L9a(){this.ged>O.App.pn&&this.Vc&&this.Vc.Wa(this.i_g,(+new Date-+this.ged).toString());this.ged=O.App.pn}finish(){const {TableMergeSplitEditor:L}=d(1039);this.Vc&&(this.ej&&(this.rcc=!1,this.Vc.Wa(L.jXl,this.ej.message)),this.Vc.Wa("SplitCellsSucceeded",this.rcc.toString()),this.Vc.finish(),this.Vc=null);if(this.ej)throw this.ej;this.xEh&&this.xEh(this.rcc,
this.Z1a)}}Object(K.a)(S,"SplitCellsArguments",null,[]);var T=d(336);d.d(U,"TableMergeSplitEditor",function(){return ca});class ca{constructor(L,da,Z,fa,aa,ja,I,sa,ka,Ma,Ea,ma,va,Ca,oa){this.Rb=L;this.gY=da;this.JA=Z;this.M5=fa;this.ued=aa;this.pM=ja;this.Tbd=I;this.Sq=ka;this.Uea=Ma;this.Rfb=Ea;this.gl=ma;this.Eb=va;this.pa=Ca;this.qdd=oa}merge(L,da,Z){const fa=L.ef(da.te,da.me),aa=this.Rb.Lc(fa);let ja=aa.zB(1);const I=[B.a.rowId,B.a.cellId];ja&&aa.Cc();let sa=!0;for(let Ma=da.te;Ma<da.eg;++Ma){let Ea=
L.ef(Ma,da.me);for(let ma=da.me+(Ma===da.te?1:0);ma<da.Tf;++ma)if(ma!==da.me&&(Ea=L.ef(Ma,ma)),!Ea||!Ea.isGhostCell){Ea.vo(B.a.rowSpan,B.a.colSpan);Ea.isGhostCell=!0;var ka=x.GraphIterator.pb(Ea);v.OutlineReader.isEmpty(ka)?this.wnh(ka):(sa&&v.OutlineReader.isEmpty(aa)&&(sa=!1,ja=null,this.wnh(aa)),this.pM.C7i(Ea,va=>{this.pM.ny(aa.currentNode,va,I);return!0},va=>11===va.type||22===va.type||12===va.type),ka=this.Rb.mae(ka),ka.Cb(1),this.pM.Lwk(aa,ja,ka.role,ka.role,ka),ka.izb(1),ja=ka.currentNode)}}this.M5.oNl(Z,
fa,da);fa.rowSpan=da.fP;fa.colSpan=da.PR;L.setValue(B.a.complexTable,!0);this.Tbd.mVe(L);L.oea(511);this.JA.$$b(L);return fa}Yzl(L,da,Z,fa,aa,ja,I,sa,ka){if(1>=Z&&1>=fa)ka&&ka(!0,da);else{var Ma=new Date,Ea=w.a.kk("SplitCells",1);Ea.Oj=!0;var ma=new h.a,va=new e.a,Ca=new e.a,oa=this.Uea.iEa(L,aa,da);da=this.Sq.VRc(aa,da);var Da=ja.qag();for(ja=ja.h5f();oa.moveNext();){ma.add(oa.f7b().id.toString());const bb=oa.qA;for(var ta=1;ta<Z;ta++){var ha=Da[bb.te];ha+=(Da[bb.eg]-ha)*ta/Z;var Ha=void 0;({Ozb:Ha}=
M(va,ha,R.Wqe)).returnValue||(Ha=va.length,va.add(new R(ha)));va.ga(Ha).ISd(bb.me,bb.Tf)}for(ta=1;ta<fa;ta++)ha=ja[bb.me],ha+=(ja[bb.Tf]-ha)*ta/fa,({Ozb:Ha}=M(Ca,ha,G.Wqe)).returnValue||(Ha=Ca.length,Ca.add(new G(ha))),Ca.ga(Ha).ISd(bb.te,bb.eg)}va=va.toArray();Ca=Ca.toArray();va.sort((bb,Na)=>R.b_d(Na,bb));Ca.sort((bb,Na)=>G.b_d(Na,bb));Ea.Wa("Prep",(+new Date-+Ma).toString());Ma=this.Eb.je(15);Ma.hc(L);L=new S(Ma,Ea,ka,da,ma,L,I,aa,sa,Da,ja,va,Ca,Z,fa);L=new r.a(null,Object(n.a)(this,this.eAl,"splitRowSeams"),
L);L.Wi=!1;L.$l("SplitTableCells");L.run()}}eAl(L,da){try{for(da.W7a("SplitRowSeams");da.$1a<da.uqd.length;){const Z=({MVa:da.MVa}=this.yJi(da.tableNode,da.Md,da.eZ,da.cUa,da.ndl,da.uqd[da.$1a])).returnValue;da.$1a++;if(da.MVa){let fa;(fa=da.Z1a).eg=fa.eg+1;for(let aa=0;aa<da.UMc.length;aa++)da.UMc[aa].ldl(Z)}if(L.Ppa)return!0}da.L9a();da.$1a=0;L.hh(Object(n.a)(this,this.bAl,"splitColSeams"))}catch(Z){da.ej=Z,L.hh(Object(n.a)(this,this.Dmb,"tearDownSplit"))}return!0}bAl(L,da){try{for(da.W7a("SplitColSeams");da.$1a<
da.UMc.length;){const Z=({MVa:da.MVa}=this.xJi(da.tableNode,da.Md,da.eZ,da.cUa,da.ECi,da.UMc[da.$1a])).returnValue;da.$1a++;if(da.MVa){let fa;(fa=da.Z1a).Tf=fa.Tf+1;for(let aa=0;aa<da.uqd.length;++aa)da.uqd[aa].DCi(Z)}if(L.Ppa)return!0}da.L9a();da.$1a=0;L.hh(Object(n.a)(this,this.ZQb,"updateIsComplexTableProperty"))}catch(Z){da.ej=Z,L.hh(Object(n.a)(this,this.Dmb,"tearDownSplit"))}return!0}ZQb(L,da){try{da.W7a("UpdateComplex"),this.Tbd.T8e(this.Rb.Lc(da.tableNode)),da.L9a(),da.YLc=this.Uea.iEa(da.tableNode,
da.eZ,da.Z1a),L.hh(Object(n.a)(this,this.h6i,"fixSplitCells"))}catch(Z){da.ej=Z,L.hh(Object(n.a)(this,this.Dmb,"tearDownSplit"))}return!0}h6i(L,da){try{for(da.W7a("FixInsideBorders");da.YLc.moveNext();)if(da.pzd.contains(da.YLc.f7b().id.toString())&&this.g6i(da.tableNode,da.eZ,da.YLc,da.rows,da.cols),L.Ppa)return!0;da.L9a();L.hh(Object(n.a)(this,this.h_i,"ensureMinRowHeightColumnWidth"))}catch(Z){da.ej=Z,L.hh(Object(n.a)(this,this.Dmb,"tearDownSplit"))}return!0}h_i(L,da){try{da.W7a("EnsureMinHeightWidth"),
1<da.rows&&this.i_i(da.tableNode,da.Z1a),1<da.cols&&this.g_i(da.tableNode,da.Z1a),da.L9a(),L.hh(Object(n.a)(this,this.setSelection,"setSelection"))}catch(Z){da.ej=Z,L.hh(Object(n.a)(this,this.Dmb,"tearDownSplit"))}return!0}setSelection(L,da){try{da.W7a("SetSelection");da.rcc=!da.Z1a.eTa();if(da.rcc){const Z=this.qdd.jPi(da.tableNode,da.eZ,da.Z1a);Z&&this.pa.gF(Z)}da.L9a();da.W7a("Render");L.Wi||da.GLh.oxh(L);da.GLh.dispose();L.hh(Object(n.a)(this,this.Dmb,"tearDownSplit"))}catch(Z){da.ej=Z,L.hh(Object(n.a)(this,
this.Dmb,"tearDownSplit"))}return!0}Dmb(L,da){da.L9a();da.finish();return!1}yJi(L,da,Z,fa,aa,ja){var I;let sa=({Joe:I}=C.c(aa,ja.y)).returnValue;if(I=!I){sa++;var ka=aa[sa-1],Ma=aa[sa],Ea=this.Rb.Lc(L);this.Nlc(Ea,sa-1);var ma=Ea.currentNode;Ea=this.Tbd.zie(Ea);ka=ja.y-ka;ma.setValue(B.a.Fu,da.gf(ka,1));ka=Ma-ja.y;Ea.setValue(B.a.Fu,da.gf(ka,1));Array.insert(aa,sa,ja.y);Z.vVa(3)}for(da=0;da<ja.yLf.length;++da){aa=ja.yLf[da];Ma=[];for(ma=aa.me;ma<=aa.Tf;++ma)({Zla:ka}=this.ued.vKh(L,Z,ma,sa)),Ma[Ma.length]=
ka;ma=new T.a;ma.me=aa.me;ma.Tf=aa.Tf;ma.te=sa-1;ma.eg=sa+1;for(ma=this.Uea.iEa(L,Z,ma);ma.moveNext();)ka=ma.qA,Ea=ma.f7b(),this.ONf(sa,ka.me,Ea),this.wwh(sa,ka.me,Ea,fa);for(ma=aa.me;ma<aa.Tf;++ma){ka=L.ef(sa-1,ma);Ea=L.ef(sa,ma);var va=this.Sq.TI(Z,sa-1,ma);va.me===ma&&(ka=L.ef(va.te,va.me),va=sa-va.te,Ea.rowSpan=ka.rowSpan-va,ka.rowSpan=va,Ea.colSpan=ka.colSpan);Ea.isGhostCell=ka.isGhostCell}Z.vVa(1);this.M5.Q7d(L,Z,sa,aa.me,aa.Tf,!0);for(let Ca=aa.me,oa=0;Ca<=aa.Tf;++Ca,++oa)Ma[oa]&&this.M5.c0e(L,
Z,Ca,sa,sa+1,Ma[oa])}return{returnValue:sa,MVa:I}}xJi(L,da,Z,fa,aa,ja){var I;let sa=({Joe:I}=C.b(aa,ja.x)).returnValue;if(I=!I){sa++;var ka=aa[sa-1],Ma=aa[sa],Ea=this.Rb.Lc(L);this.gY.M4g(Ea);Ea.gq(sa-1,1);this.Tbd.yie(Ea);if(Ea=L.sa(z.a.ev,null))Ea=m.a.clone(Ea),Ea[sa-1]=da.gf(ja.x-ka,0),Ea[sa]=da.gf(Ma-ja.x,0),L.setValue(z.a.ev,Ea);Array.insert(aa,sa,ja.x);Z.vVa(3)}for(da=0;da<ja.Gsh.length;++da){aa=ja.Gsh[da];ka=[];for(Ma=aa.te;Ma<=aa.eg;++Ma)({Zla:Ea}=this.ued.rKh(L,Z,Ma,sa)),ka[ka.length]=Ea;
Ma=new T.a;Ma.te=aa.te;Ma.eg=aa.eg;Ma.me=sa-1;Ma.Tf=sa+1;for(Ma=this.Uea.iEa(L,Z,Ma);Ma.moveNext();){Ea=Ma.qA;var ma=Ma.f7b();this.ONf(Ea.te,sa,ma);this.wwh(Ea.te,sa,ma,fa)}for(Ma=aa.te;Ma<aa.eg;++Ma){Ea=L.ef(Ma,sa-1);ma=L.ef(Ma,sa);var va=this.Sq.TI(Z,Ma,sa-1);va.te===Ma&&(Ea=L.ef(va.te,va.me),va=sa-va.me,ma.colSpan=Ea.colSpan-va,Ea.colSpan=va,ma.rowSpan=Ea.rowSpan);ma.isGhostCell=Ea.isGhostCell}Z.vVa(1);this.M5.S7d(L,Z,sa,aa.te,aa.eg,!0);for(let Ca=aa.te,oa=0;Ca<=aa.eg;++Ca,++oa)ka[oa]&&this.M5.ZZe(L,
Z,Ca,sa,sa+1,ka[oa])}return{returnValue:sa,MVa:I}}g6i(L,da,Z,fa,aa){var ja=this.Uea.iEa(L,da,Z.JE);ja.moveTo(Z.VO,Z.fM);Z=ja.qA;for(let I=1;I<fa;++I)ja.Vwk(),Z.eg=ja.qA.eg,Z.Tf=ja.qA.Tf;for(fa=1;fa<aa;++fa)ja.moveNext(),Z.eg=ja.qA.eg,Z.Tf=ja.qA.Tf;for(aa=this.Uea.iEa(L,da,Z);aa.moveNext();){ja=aa.qA;let I;ja.eg<Z.eg&&({Zla:I}=this.ued.rKh(L,da,Z.eg,ja.me)).returnValue&&this.M5.ZZe(L,da,ja.eg,ja.me,ja.Tf,I);ja.Tf<Z.Tf&&({Zla:I}=this.ued.vKh(L,da,Z.Tf,ja.te)).returnValue&&this.M5.c0e(L,da,ja.Tf,ja.te,
ja.eg,I)}}i_i(L,da){L=this.Rb.Lc(L);this.Nlc(L,da.te);for(let Z=da.te;Z<da.eg;++Z){const fa=L.currentNode.sa(B.a.Fu,0);fa&&fa<this.gl.ELc(L.currentNode)&&L.currentNode.setValue(B.a.Fu,0);L.Gf(1)}}g_i(L,da){let Z=L.sa(z.a.ev,null),fa=!1;if(Z){Z=m.a.clone(Z);for(let aa=da.me;aa<da.Tf;++aa){const ja=this.gl.gub(L,aa);Z[aa]&&Z[aa]<ja&&(Z[aa]=ja,fa=!0)}}fa&&L.setValue(z.a.ev,Z)}ONf(L,da,Z){const fa=Z.getContainingTable();fa||D.a.J(512495627,822,10,"Not able to access TableNode from Table Cell Node");fa.ef(L,
da).cellShading=Z.cellShading}wwh(L,da,Z,fa){const aa=Z.getContainingTable();aa||D.a.J(512495625,822,10,"Not able to access TableNode from Table Cell Node");L=x.GraphIterator.pb(aa.ef(L,da));this.Rfb.nW(L,!0,fa(Z))}Nlc(L,da){for(this.gY.M4g(L);0<da--;)this.gY.axk(L)}wnh(L){L=this.Rb.mae(L);let da=L.Cb(1);for(;da;)da=L.xSa(1)}}Object(K.a)(ca,"TableMergeSplitEditor",null,[236])},1040:function(K,U,d){K=d(0);var h=d(7),e=d(392),r=d(27),m=d(172),n=d(202),z=d(56);class v{constructor(C,O,S,T){this.EJd=null;
this.iAc=T;this.oca=C;this.pca=O;this.HP=S;this.dtf=this.r2g.Rsl;C=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.c2h=C[0];this.b2h=C[1]}get r2g(){return this.EJd||(this.EJd=z.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get aVa(){return CommonUIStrings.l_OICErrorHelpLink}get Ktc(){return this.dtf}get t2g(){return this.c2h}get s2g(){return this.b2h}get q2g(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.dtf?
3:2}get D5b(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get BNc(){return!!this.pca}get E5b(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get gka(){return CommonUIStrings.l_DefaultDialogTitle}ITe(C){this.kmc(C)}Fre(C){this.kmc(C)}kmc(C){let O=10;this.pca&&1===C&&(this.pca(this.HP),O=1);this.oca&&this.oca(this.HP);this.Oo(O)}$hb(){n.Redirect.showHelp("OICFailure");this.Oo(2)}yKe(){this.r2g.Hug();this.Oo(4)}Oo(C){e.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",
this.iAc,C);r.AFrameworkApplication.nkb(m.a.Lch,this.iAc,C)}dispose(){this.HP=this.oca=this.pca=null}}Object(K.a)(v,"AOICErrorDialog",null,[107]);var x=d(93),B=d(107);class D extends v{constructor(C,O,S,T){super(C,O,S,T);this.hPa=this.Uz=null;C=document.createElement("span");C.id="errorMessageText";C.innerText=this.errorMessage;C.appendChild(document.createElement("br"));C.appendChild(document.createElement("br"));this.Uz=document.createElement("a");this.Uz.href="#";this.Uz.innerText=this.aVa;C.appendChild(this.Uz);
x.a.addHandler(this.Uz,"click",Object(h.a)(this,this.$hb,"oicErrorHelpLinkHandler"));O=new B.StandardDialog;O.kg=this.id;this.Ktc?(S=document.createElement("span"),T=document.createElement("span"),S.innerText=this.t2g,T.innerText=this.s2g,this.hPa=document.createElement("a"),this.hPa.href="#",this.hPa.innerText=this.q2g,C.appendChild(document.createElement("br")),C.appendChild(S),C.appendChild(this.hPa),C.appendChild(T),x.a.addHandler(this.hPa,"click",Object(h.a)(this,this.yKe,"oicErrorMacOfferLinkHandler"))):
this.BNc&&(C.appendChild(document.createElement("br")),C.appendChild(document.createElement("br")),S=document.createElement("span"),S.innerText=this.D5b,C.appendChild(S));this.BNc?(O.Ad=1,O.Oe(1,this.E5b)):O.Ad=0;O.Tx(this.gka,null,this.icon,Object(h.a)(this,this.Fre,"legacyOICErrorDialogHandler"),C);O.y6("errorMessageText")}dispose(){this.Uz&&(x.a.removeHandler(this.Uz,"click",Object(h.a)(this,this.$hb,"oicErrorHelpLinkHandler")),this.Uz=null);this.hPa&&(x.a.removeHandler(this.hPa,"click",Object(h.a)(this,
this.yKe,"oicErrorMacOfferLinkHandler")),this.hPa=null);super.dispose()}}Object(K.a)(D,"OICErrorDialog",v,[]);class w{constructor(C,O,S){this.oca=O;this.pca=C;this.HP=S}get id(){return"OICErrorDialogWithDownload"}get iYf(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get aVa(){return CommonUIStrings.l_OICErrorHelpLink}get D5b(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get E5b(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get gka(){return CommonUIStrings.l_DefaultDialogTitle}ITe(C){this.kmc(C)}Fre(C){this.kmc(C)}kmc(C){let O=
10;1===C&&(this.pca(this.HP),O=1);this.oca&&this.oca(this.HP);this.Oo(O)}$hb(){n.Redirect.showHelp("OICFailure");this.Oo(2)}Oo(C){r.AFrameworkApplication.nkb(m.a.Mch,3,C)}dispose(){this.HP=this.pca=this.oca=null}}Object(K.a)(w,"AOICErrorDialogWithDownload",null,[107]);class J extends w{constructor(C,O,S){super(C,O,S);this.Uz=null;C=document.createElement("span");C.id="errorMessageText";C.innerText=this.iYf;C.appendChild(document.createElement("br"));C.appendChild(document.createElement("br"));this.Uz=
document.createElement("a");this.Uz.href="#";this.Uz.innerText=this.aVa;C.appendChild(this.Uz);x.a.addHandler(this.Uz,"click",Object(h.a)(this,this.$hb,"oicErrorHelpLinkHandler"));C.appendChild(document.createElement("br"));C.appendChild(document.createElement("br"));O=document.createElement("span");O.innerText=this.D5b;C.appendChild(O);O=new B.StandardDialog;O.kg=this.id;O.Ad=1;O.Oe(1,this.E5b);O.Tx(this.gka,null,this.icon,Object(h.a)(this,this.Fre,"legacyOICErrorDialogHandler"),C);O.y6("errorMessageText")}dispose(){this.Uz&&
(x.a.removeHandler(this.Uz,"click",Object(h.a)(this,this.$hb,"oicErrorHelpLinkHandler")),this.Uz=null);super.dispose()}}Object(K.a)(J,"OICErrorDialogWithDownload",w,[]);var G=d(79);class M extends v{constructor(C,O,S,T){super(C,O,S,T);O={["errorMessage"]:this.errorMessage};O.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.aVa,["onExecute"]:ca=>{this.$hb(ca)}};this.Ktc?(O.macOfficePreLinkText=this.t2g,O.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.q2g,
["onExecute"]:ca=>{this.yKe(ca)}},O.macOfficePostText=this.s2g):this.BNc&&(O.errorFileDownloadOffer=this.D5b);C=new G.a(!1,!1,!0);this.BNc?(C.Ad=1,C.Oe(1,this.E5b)):C.Ad=0;C.kg=this.id;O={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:O};C.pj(this.gka,Object(h.a)(this,this.ITe,"reactOICErrorDialogHandler"),O)}}Object(K.a)(M,"ReactOICErrorDialog",v,[]);class N extends w{constructor(C,O,S){super(C,O,S);O={["errorMessage"]:this.iYf,["errorFileDownloadOffer"]:this.D5b};O.helpLink={["type"]:"AppLinkProps",
["id"]:"helpLink",["text"]:this.aVa,["onExecute"]:T=>{this.$hb(T)}};C=new G.a(!1,!1,!0);C.Ad=1;C.Oe(1,this.E5b);C.kg=this.id;O={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:O};C.pj(this.gka,Object(h.a)(this,this.ITe,"reactOICErrorDialogHandler"),O)}}Object(K.a)(N,"ReactOICErrorDialogWithDownload",w,[]);d.d(U,"a",function(){return R});class R{constructor(){this.Qqa=!!r.AFrameworkApplication.Aa&&r.AFrameworkApplication.Aa.ob.hD}PMi(C,O,S){this.Qqa?new M(C,O,null,S):new D(C,O,null,S)}QMi(C,
O,S){this.Qqa?new N(C,O,S):new J(C,O,S)}RMi(C,O,S,T,ca){const {ReactOICErrorDialogWithTrial:L}=d(1147),{OICErrorDialogWithTrial:da}=d(1148);this.Qqa?new L(C,O,S,null,T,ca):new da(C,O,S,null,T,ca)}static get instance(){return R.La||(R.La=new R)}}R.La=null;Object(K.a)(R,"OICErrorDialogFactory",null,[1323])},1046:function(K,U,d){K=d(0);var h=d(392),e=d(1244),r=d(1245),m=d(1246),n=d(120),z=d(27),v=d(718),x=d(204),B=d(270),D=d(95),w=d(251),J=d(309),G=d(36),M=d(156),N=d(55),R=d(47);class C{constructor(){this.cvFlights=
this.uiHost=this.productName=null;this.isCVSurveyEnabled=!1}}Object(K.a)(C,"CustomerVoiceSurveyParams",null,[]);var O=d(142),S=d(540);class T{sendTelemetryEvent(Z){const fa=new S.a;fa.otelEvent=Z;O.a.sendOtelEvent(fa)}}Object(K.a)(T,"OtelTelemetrySink",null,[1341]);class ca{constructor(){this.userFactName=this.props=this.dedupIntervalSeconds=null}}Object(K.a)(ca,"UserFactManifestParams",null,[]);var L=d(579);d.d(U,"a",function(){return da});class da{static init(Z,fa,aa,ja,I){I.onDismiss=Z;I.onError=
fa;Z=null;OfficeBrowserFeedback.initOptions?("screenshot"in I&&(OfficeBrowserFeedback.initOptions.screenshot=I.screenshot),"showEmailAddress"in I&&(OfficeBrowserFeedback.initOptions.showEmailAddress=I.showEmailAddress),"feedbackForumUrl"in I&&(OfficeBrowserFeedback.initOptions.feedbackForumUrl=I.feedbackForumUrl),Z=I):OfficeBrowserFeedback.initOptions=I;OfficeBrowserFeedback.initOptions.telemetrySink||(OfficeBrowserFeedback.initOptions.telemetrySink=da.LPf());OfficeBrowserFeedback.multiFeedback(Z).then(()=>
{h.ULS.sendTraceTag(36300302,356,100,"BFCOCV Success calling OCV Feedback")}).catch(sa=>h.ULS.sendTraceTag(36300303,356,10,"BFCOCV Error:"+sa.toString()))}static The(Z,fa,aa,ja){h.ULS.sendTraceTag(36546398,356,50,"BFCOCV.Entered InitSIFeedback");if(da.Ppb===da.initialized)return Promise.resolve(1);if(da.Ppb===da.Xjg)return da.Yjg||(da.Yjg=!0,h.ULS.sendTraceTag(36546399,356,15,"BFCOCV.InitSIFeedback:Initializing")),Promise.resolve(0);if(da.Ppb!==da.error){da.Ppb=da.Xjg;h.ULS.sendTraceTag(36546400,
356,50,"BFCOCV.InitSIFeedback:past init check");if(da.SMj(Z,fa,aa,ja))return z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateDynamicCampaignEnabled",!1)?da.sMj(aa).then(()=>da.Ajg()):da.Ajg();da.Ppb=da.error;Promise.reject(da.N6g)}return Promise.reject(0)}static Ajg(){try{return v.a.Y0k(da.Fjj(),()=>OfficeBrowserFeedback.floodgate.initialize().then(()=>da.A3e())).catch(Z=>{let fa=10;Z&&Z.toString()&&M.a(Z.toString(),da.P$j)&&(fa=15);h.ULS.sendTraceTag(36546402,
356,fa,"BFCOCV Floodgate initialize error:"+Z.toString())})}catch(Z){return h.ULS.sendTraceTag(590975881,356,15,"BFCOCV Floodgate initialize error:"+Z.toString()),Promise.reject(da.Jzk)}}static Fjj(){return Object.assign(new L.a,{featureName:"Floodgate",crewAlias:"floodgatecrew",vetoPillar:"OfficeBrowserFeedback"})}static A3e(){return OfficeBrowserFeedback.floodgate.start().then(()=>{da.L6i()}).catch(Z=>{h.ULS.sendTraceTag(36546401,356,10,"BFCOCV Floodgate start error:"+Z.toString())})}static L6i(){da.Ppb=
da.initialized;h.ULS.sendTraceTag(36546403,356,50,"BFCOCV.Started floodgate");try{const Z=z.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateTestActivity","");for(const fa of Z.split("|"))fa&&da.logActivity(fa,null)}catch(Z){h.ULS.sendTraceTag(539015366,356,50,"Error triggering test activity")}}static kva(){let Z=!1;const fa=z.AFrameworkApplication.fa;fa&&(Z="teams"===(fa.Ha(z.AFrameworkApplication.wK)||"").toLowerCase());return N.a.xGa||Z}static S6g(){return"undefined"==
typeof OfficeBrowserFeedback}static SMj(Z,fa,aa,ja){let I=!0;try{if(da.S6g())return h.ULS.sendTraceTag(39900617,356,15,da.N6g),!1;OfficeBrowserFeedback.initOptions||(aa.onDismiss=ja,aa.onError=fa,aa=da.ili(aa),OfficeBrowserFeedback.initOptions=aa);OfficeBrowserFeedback.initOptions.telemetrySink||(OfficeBrowserFeedback.initOptions.telemetrySink=da.LPf());const Ma=da.Zak;fa={};ja={};const Ea={};ja.onSurveyActivated=da.pIk;ja.onTeachingCampaignRender=aa.onTeachingCampaignRender;Ea.LogExperimentTrigger=
Ma;fa.onSurveyActivatedCallback=ja;fa.onDismiss=Z;fa.autoDismiss=aa.FloodgateUIAutoDismissTimeEnum;fa.telemetryGroup=aa.telemetryGroup;fa.uIStringGetter=aa.uIStringGetter;fa.authTokenCallback=aa.authTokenCallback;fa.augLoopCallback=aa.augLoopCallback;fa.campaignFlights="";fa.governanceServiceEnabled=aa.governanceServiceEnabled;fa.governanceServiceConfig=aa.governanceServiceConfig;fa.personalizerEnabled=aa.personalizerEnabled;fa.messagingServiceSettings=aa.messagingServiceSettings;fa.isPriorityEnabled=
aa.isPriorityEnabled;fa.enableWebCampaignGovernance=aa.enableWebCampaignGovernance;fa.logExperimentTrigger=Ea;z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.AppGovernanceProviderForSurveys",!1)&&z.AFrameworkApplication.G9&&(da.M_f.add(da.o4i),Z={},Z.getDecision=da.Rej,fa.appGovernanceProvider=Z);z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1)&&("surveyEnabled"in aa&&(fa.surveyEnabled=aa.surveyEnabled),"showEmailAddress"in
aa&&(fa.showEmailAddress=aa.showEmailAddress));fa.isEudbUxEnabled=!1;z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EUDBUXIsEnabled",!1)&&(fa.isEudbUxEnabled=!0);var sa=da.xej(aa);const ma=da.h7f(sa);let va=da.Wej(aa);for(let Ca in ma){sa=Ca;var ka=ma[Ca];-1!==sa.toLowerCase().indexOf("flight")?fa.campaignFlights+=ka+";":va=va+sa+"="+ka+"&"}h.ULS.sendTraceTag(50422099,356,50,"campaignFlights: "+fa.campaignFlights+" campaignQueryParameters: "+va);fa.campaignQueryParameters=
va;fa.customerVoiceSurveyParams=da.Jej(aa.Application.toString(),da.kva()?da.BEl:"");OfficeBrowserFeedback.floodgate.initOptions=fa}catch(Ma){I=!1,h.ULS.sendTraceTag(39900618,356,15,Ma.toString())}return I}static Rej(Z){if(Z=Z.getTags())for(const fa of Z)if(da.M_f.has(fa))return!0;return!1}static ili(Z){try{const fa=Z.applicationGroup?Z.applicationGroup:{},aa=fa.appData,ja=aa?G.a(G.a('"'+aa+'"')):{};ja.fgUIAutoDismiss=Z.FloodgateUIAutoDismissTimeEnum;fa.appData=G.c(ja);Z.applicationGroup=fa}catch(fa){h.ULS.sendTraceTag(588842831,
356,10,"Failed to parse applicationGroup.appData",fa.toString())}return Z}static xej(Z){Z=Array.isArray(Z.Flights)?Z.Flights:null;Z||(Z=(Z=z.AFrameworkApplication.fa.Ha("FlightId"))?Z.toString().split(";"):null);if(z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateTreatmentVariableFlighting",!0)){const fa=z.AFrameworkApplication.fa.$Sc;if(fa)for(let aa in fa){const ja={key:aa,value:fa[aa]};-1!==(ja&&ja.key?ja.key.toLowerCase():"").indexOf("floodgateflight")&&
"unset"!==(ja&&ja.value?ja.value.toString().toLowerCase():"")&&Z.push(ja.key)}}return Z}static h7f(Z){const fa={SelfTriggerActivity:""};if(!Z||!Z.length)return fa;try{for(let I=0;I<Z.length;I++){let sa=Z[I]?Z[I].toLowerCase():"";if(-1===sa.indexOf("floodgateflight"))continue;const ka=sa.lastIndexOf(".");-1!==ka&&(sa=sa.substring(ka+1,sa.length));if(-1!==("AppFlights"in fa?fa.AppFlights:"").indexOf(sa))continue;fa.AppFlights="AppFlights"in fa?fa.AppFlights+(";"+sa):sa;const Ma=R.a.replaceAll(sa,"-",
""),Ea=z.AFrameworkApplication.fa.Ha(Ma);if(Ea)try{const ma=G.a(Ea);ma&&ma.SelfTriggerActivity||(fa.SelfTriggerActivity+=";"+Ma);if(ma)for(let va in ma){var aa=va,ja=ma[va];aa in fa?fa[aa]!==ja&&(fa[aa]=fa[aa]+";"+ja):fa[aa]=ja}}catch(ma){h.ULS.sendTraceTag(50422101,356,10,"Failed to parse the "+Ma+" json data",ma.toString())}else fa.SelfTriggerActivity+=";"+Ma}}catch(I){h.ULS.sendTraceTag(50422102,356,10,"Failed to get floodgate flight parameters for floodgateContext",I.toString())}return fa}static Wej(Z){let fa=
"";const aa={["OFC_Audience"]:"AudienceGroup",["Datacenter"]:"WACDatacenter",["TenantId"]:"TenantId"};for(let sa in aa){var ja=sa,I=aa[sa];let ka=Z[Object(e.a)(String,I)];ka||(ka=z.AFrameworkApplication.fa.Ha(Object(e.a)(String,I)));ka&&(fa+=ja+"="+encodeURIComponent(ka)+"&")}return fa}static ekl(Z){da.k2d=Z}static pIk(Z,fa,aa){if(Z)try{const I=fa?fa.getCampaignId():"",sa=fa?fa.getLauncherType():"",ka=aa?aa.contextInfo:null;var ja=fa?fa.getSurveyInfo():null;const Ma=ja?ja.getPreferredLaunchType():
null,Ea=ja?ja.getMetadata():null,ma=Ea?Ea.getContentMetadata():null,va=ma?ma.customSurveyName:null,Ca=ma?ma.telemetryEventName:null;da.NTj(I)?h.ULS.sendTraceTag(539015367,356,50,"BFCOCV.onSurveyActivated campaign disabled -"+I):(z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.AppGovernanceProviderForSurveys",!1)&&z.AFrameworkApplication.G9&&h.ULS.sendTraceTag(512312960,356,50,"BFCOCV.onSurveyActivated Initiated survey activation for campaign - {0} during Live session",I),
ja={},ja.campaignId=I,ja.surveyName=va,ja.launcherType=sa,ja.contextInfoLength=ka?ka.length.toString():"-1",ja.preferredLaunchType=Ma,ja.telemetryEventName=Ca,h.ULS.sendTraceTag(36706399,356,50,"BFCOCV.onSurveyActivated -  "+JSON.stringify(ja)),sa&&"coachingux"===sa.toLowerCase()&&Ma&&"default"!==Ma.toLowerCase()&&da.Zfg(ma,fa,aa)?h.ULS.sendTraceTag(555071513,356,50,"BFCOCV.onSurveyActivated. Custom survey activation successful - "+JSON.stringify(ja)):(Z.launch(aa),da.fzh()))}catch(I){h.ULS.sendTraceTag(555071514,
356,10,"BFCOCV.onSurveyActivated. Error handling activation callback - "+(I?I.toString():""))}else h.ULS.sendTraceTag(36706400,356,10,"BFCOCV.onSurveyActivated given a null launcher")}static Y$d(Z){if(!Z||z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableFloodgateTriggerFlightIdLog",!1))return null;try{const fa=(z.AFrameworkApplication.fa.Ha("FlightId")||"").toLocaleLowerCase(),aa=Z.toString().toLocaleLowerCase().split(";");for(const ja of aa)if(-1!==fa.indexOf(ja))return ja}catch(fa){h.ULS.sendTraceTag(508961430,
306,50,"Error retrieving flightId of campaign event -"+(fa?fa.toString():""))}return null}static Zak(Z){for(const fa of Z){Z=null;if(fa.triggerEvent){const aa=da.Y$d(fa.triggerEvent);aa&&(Z=Object(e.a)(OfficeBrowserFeedback.IEventFlightInfo,fa.eventInfo),Z.flightId=aa);z.AFrameworkApplication.dma(fa.triggerEvent)}h.ULS.sendTraceTag(509100380,306,50,"Web Campaign UI launched. "+JSON.stringify(Z?Z:fa.eventInfo))}}static aGj(Z){Z=Z?Z.surfaceContext:null;if(!Z||!Z.surveyForm)return h.ULS.sendTraceTag(555071516,
356,10,"Missing activation arguments"),!1;try{const fa=Z.surveyForm.getSurveyInfo(),aa=fa?fa.getMetadata():null,ja=aa?aa.getContentMetadata():null;return da.Zfg(ja,Z.surveyForm,Z.surveyParams)}catch(fa){h.ULS.sendTraceTag(555071517,356,10,"BFCOCV.HandleActivationCallback Error - "+(fa?fa.toString():""))}return!1}static Zfg(Z,fa,aa){if(!Z||!Z.customSurveyName||!fa)return h.ULS.sendTraceTag(555071518,356,10,"Survey arguments not provided "+(Z?Z.customSurveyName:null)),!1;const ja=fa.getCampaignId();
if(Z.telemetryEventName){var I={["action"]:"Opened",["id"]:ja,["success"]:"true",["triggerType"]:"custom",["customSurveyName"]:Z.customSurveyName,["telemetryEventName"]:Z.telemetryEventName};da.k2d?da.k2d(Z.telemetryEventName,I):(z.AFrameworkApplication.uk(Z.telemetryEventName),z.AFrameworkApplication.ECb(Z.telemetryEventName),h.ULS.sendTraceTag(512505554,356,50,"BFCOCV.onSurveyActivated survey activated -"+JSON.stringify(I)))}I=da.ywf.Fb(Z.customSurveyName)?da.ywf.ga(Z.customSurveyName):null;if(!I)return h.ULS.sendTraceTag(555071519,
356,50,"Activation callback not found - "+Z.customSurveyName+", "+ja),!1;(Z=I(fa,aa))&&Z.then(sa=>{h.ULS.sendTraceTag(555071520,356,50,"Activation callback result - "+JSON.stringify(sa))}).catch(sa=>{h.ULS.sendTraceTag(555071521,356,50,"Error in activation callback handling: "+(sa?sa.toString():""))});return!0}static NTj(Z){try{return-1!==z.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateDisabledCampaigns","").toLowerCase().indexOf((Z||"").toLowerCase())}catch(fa){h.ULS.sendTraceTag(539015368,
356,10,"Error checking if campaign is disabled - "+Z)}return!1}static logActivity(Z,fa=null){if(da.DYd(Z,"LogActivity")){var aa=da.Z$d();aa&&(h.ULS.sendTraceTag(37856259,356,50,"BFCOCV.Calling OCV's logActivity "+Z),aa.logActivity(Z,1,fa))}}static Ulb(Z){Z?(h.ULS.sendTraceTag(38605915,356,50,"BFCOCV.Calling OCV's showCustomSurvey"),OfficeBrowserFeedback.floodgate.showCustomSurvey(Z),da.fzh()):h.ULS.sendTraceTag(38605914,356,10,"BFCOCV.surveyJsonObject null:")}static fzh(){da.Ura(da.q1f)}static WNj(Z,
fa,aa){var ja=[3,2,5,1];const I=D.FocusManager.instance(),sa=I.Fc(Z);sa.parent=n.AFrame.Xi;sa.uJ=!0;B.a.instance.e3(Z,!0);fa&&sa.Lca(fa);if(aa){w.a.instance.d8(Z,aa,!1,!0);J.a.instance.d8(Z,aa,!1,!0);Z=new x.DOMFocusListing(()=>aa);for(fa=0;fa<ja.length;++fa)Z.Ro(ja[fa]);I.zja(()=>aa,sa,Z).uX=!0}}static Ura(Z){const fa=document.getElementById(Z);fa?da.WNj(Z,da.iDk,fa):h.ULS.sendTraceTag(36706402,356,15,"BFCOCV.Could not find container "+Z)}static iDk(Z,fa){h.ULS.sendTraceTag(37107265,356,100,"BFCOCV.OnFocusAction. PrevScopeName "+
(Z?Z.name:"")+" NextScopeName "+(fa?fa.name:""));fa&&(Z=D.FocusManager.instance().EQ(fa.name))&&Z.Egd()}static sdc(Z){if(da.DYd(Z,"LogActivityStart")){var fa=da.Z$d();fa&&(h.ULS.sendTraceTag(37856260,356,50,"BFCOCV.Calling OCV's logActivityStartTime "+Z),fa.logActivityStartTime(Z))}}static Nvg(Z){if(da.DYd(Z,"LogActivityEnd")){var fa=da.Z$d();fa&&(h.ULS.sendTraceTag(37856262,356,50,"BFCOCV.Calling OCV's logActivityStopTime "+Z),fa.logActivityStopTime(Z,new Date))}}static M6i(){OfficeBrowserFeedback.floodgate.start()}static N6i(){OfficeBrowserFeedback.floodgate.stop()}static sMj(Z){try{const fa=
Z.telemetryGroup,aa=new Map;aa.set("Agent",da.nXi);aa.set("Platform","Web");aa.set("Host",Z.Host||"");aa.set("Audience",fa.audienceGroup||"");aa.set("TenantId",fa.tenantId||"");z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateDynamicCampaignTestEnabled",!1)&&(z.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateDynamicCampaignTestAudience","Dogfood"),aa.set("Audience","Dogfood"),aa.set("SurveyValidation","true"));const ja=
{};ja.appName=Z.Application||"";ja.language=Z.locale||"";ja.appVersion=fa.officeBuild||"";ja.host=da.mXi;ja.filters=aa;ja.localStorageProvider=OfficeBrowserFeedback.floodgate.getStorageProvider();const I=new FloodgateDynamicCampaign.Client(ja);I.telemetryEvents.subscribe((sa,ka)=>{h.ULS.sendTraceTag(508912419,356,50,"Floodgate Ecs Telemetry Event: "+sa+", details: "+JSON.stringify(ka))});return I.start().then(()=>{const sa={enabled:!0};sa.ecsClient=I;OfficeBrowserFeedback.floodgate.initOptions.dynamicCampaignConfig=
sa}).catch(sa=>{h.ULS.sendTraceTag(508912418,356,10,"EcsClient starts with Error: "+(sa?sa.toString():""))})}catch(fa){return h.ULS.sendTraceTag(508912417,356,15,"Initialized EcsClient failed with error: "+fa.toString()),Promise.resolve(0)}}static DYd(Z,fa){Z||h.ULS.sendTraceTag(36546433,356,10,"BFCOCV.Error. null 'name' in method "+fa);return!!Z}static Z$d(){let Z=null;const fa=OfficeBrowserFeedback.floodgate.getEngine();fa?(Z=fa.getActivityListener())||h.ULS.sendTraceTag(36546434,356,10,"BFCOCV.Error floodgate listener null"):
da.x6g||(da.x6g=!0,h.ULS.sendTraceTag(36546435,356,15,"BFCOCV.Error floodgate engine null"));return Z}static LPf(){return new T}static Jej(Z,fa){return Object.assign(new C,{productName:Z,uiHost:fa,cvFlights:"",isCVSurveyEnabled:!0})}static bee(Z){return Object.assign(new ca,{dedupIntervalSeconds:86400,props:[],userFactName:Z})}}da.q1f="obf-ToastContainer";da.notInitialized=0;da.Xjg=1;da.initialized=2;da.error=-1;da.Ppb=da.notInitialized;da.x6g=!1;da.Yjg=!1;da.P$j="window.localStorage is not available";
da.N6g="OFB still undefined";da.Jzk="OFB Floodgate is undefined or does not contain initialize function";da.BEl="Teams";da.o4i="Live";da.mXi="https://config.edge.skype.com";da.nXi="ChillWAC";da.M_f=new Set;da.ywf=new r.a(m.a.Ml());da.k2d=null;Object(K.a)(da,"BrowserFeedbackControlOCV",null,[])},1048:function(K,U,d){K=d(0);class h{constructor(){this.results=null;this.totalResultCount=0;this.hasTooManyResults=!1}}Object(K.a)(h,"DocumentContentSearchResults",null,[]);class e{getAllParagraphsInDocument(){return null}selectRange(){}selectRangeV2(N,
R,C,O,S){this.selectRange(R,C,O,S)}selectRangeV3(){}search(){}searchV2(N,R){this.search(N,C=>{R(Object.assign(new h,{results:C,totalResultCount:C.length,hasTooManyResults:100<C.length}))})}searchWithParam(N,R){this.search(N.query,R)}searchWithParamV2(N,R){this.searchWithParam(N,C=>{R(Object.assign(new h,{results:C,totalResultCount:C.length,hasTooManyResults:C.length>N.totalResultLimit}))})}highlight(){}highlightWithParam(N){this.highlight(N.query)}getRevision(){return null}getDocumentSelection(){return null}clearDocumentSelection(){}selectNextPrevHighlight(){return-1}getSelectedText(){return null}submitDocumentContentExtractionSignal(){}generateDocumentSummary(){return Promise.resolve(null)}generateDocumentSummaryDetails(){return Promise.resolve(null)}extractDocumentObjects(){}getAuthorImageUrlFromClient(){return Promise.resolve(null)}getId(){return"DocumentContentExecutor"}}
Object(K.a)(e,"BaseDocumentContentExecutor",null,[821,845]);class r{constructor(){this.subdocumentId=this.snippet=null;this.endOffsetInParagraph=this.startOffsetInParagraph=this.paragraphIndex=this.endOffsetInSnippet=this.startOffsetInSnippet=this.subdocumentType=0;this.authorName=this.authorEmail=null}}Object(K.a)(r,"DocumentContentSearchResult",null,[]);var m=d(106),n=d(27),z=d(47),v=d(18),x=d(75),B=d(34),D=d(51),w=d(392),J=d(688),G=d(30);d.d(U,"a",function(){return M});class M extends e{constructor(N,
R,C,O,S,T,ca,L,da,Z,fa){super();if(!N)throw Error("pageNode is null");if(!R)throw Error("interactiveViewManager is null");if(!C)throw Error("selectionFactory is null");if(!O)throw Error("slideReader is null");if(!S)throw Error("workspace is null");if(!T)throw Error("graphTopologyManager is null");if(!ca)throw Error("searchContextFactory is null");if(!L)throw Error("actionManager is null");if(!da)throw Error("selectionManager is null");if(!Z)throw Error("clipServiceManager is null");if(!fa)throw Error("presentationReader is null");
this.vmk=N;this.wA=R;this.qdd=C;this.jc=O;this.Tb=S;this.ta=T;this.Kpk=ca;this.ia=L;this.pa=da;this.yO=Z;this.oc=fa}getAllParagraphsInDocument(){const N=this.Qbe(),R=new v.a;for(let C of N)R.add(M.Nbe(C));return R.toArray()}selectRange(N,R,C,O){if(!(0>N||0>R||0>C||0>O||N>C||N===C&&R>O)){var S=this.Qbe();S.count<=C||(N=S.ga(N),C=S.ga(C),M.jtg(N,R)&&M.jtg(C,O)&&(S=this.jc.mg(N),this.ta.Ba!==S&&this.Tb.Tvh(S),R=this.qdd.Qg(N,R),O=this.qdd.WN(R,D.a.Lj(C,O+1)),this.wA.d0e(this.Tb.fL,O)))}}search(N,R){const C=
new v.a,O=N.toLowerCase();var S=this.Qbe();let T=0;for(let L of S){S=M.Nbe(L);const da=S.toLowerCase();let Z=0;for(;-1<(Z=da.indexOf(O,Z));){var ca=this.Kpk.gOi(S,Z,Z+N.length);ca=Object.assign(new r,{snippet:ca.FHi,startOffsetInSnippet:ca.ucl,endOffsetInSnippet:ca.rcl-1,paragraphIndex:T,startOffsetInParagraph:Z,endOffsetInParagraph:Z+N.length-1});C.add(ca);Z+=N.length}T++}C.Sc((L,da)=>L.paragraphIndex===da.paragraphIndex?L.startOffsetInParagraph-da.startOffsetInParagraph:L.paragraphIndex-da.paragraphIndex);
R(C.toArray())}getSelectedSlidesAsPPTXStream(){const N=this.pa.Se();if(N&&N.length)return this.c5f(N);w.ULS.sendTraceTag(509642065,1313,10,"Unable to get selected slides. getAllSelectedSlideNodes returned undefined or empty")}getAllSlidesAsPPTXStream(){const N=this.oc.wbg();if(N&&N.length)return this.c5f(N);w.ULS.sendTraceTag(509437598,1313,10,"Unable to get slides in presentaiton. Calling getSortedSlideNodes returnd no slides")}c5f(N){var R=this.yO.hOc(1,N.length,!1),C=m.a.create().toString();C=
new J.a(R,C,N);var O=8;O=this.ia.Ka(G.a.e0d,2,C);R.DW=O;C=n.AFrameworkApplication.fa.Ha("361");O=z.a.Qe(R.Jp);const S=z.a.Qe(R.QD);R=z.a.Qe(R.Ky);if(O&&S&&R)return{url:`${C}GetClipboardBytes.ashx?Id=${O}&DC=${S}&pkey=${R}&wdwaccluster=${S}&DataType=${1}`,selectedSlideIDs:N.map(T=>T.id.toString())}}Qbe(){var N=B.ParagraphReader.CWc(this.vmk.value,!0,!1);const R=new v.a;for(let C of N)N=this.jc.mg(C),N.gO||N.PBb||R.add(C);return R}static Nbe(N){N=B.ParagraphReader.text(N);return x.AParagraphNode.Sod(N,
" ")}static jtg(N,R){N=M.Nbe(N);return R<N.length}}Object(K.a)(M,"PPTDocumentContentExecutor",e,[])},1054:function(K,U,d){K=d(0);var h=d(356),e=d(541);class r extends e.a{constructor(D,w=null,J=null){super("DeferredContentType");this.title=this.isDeferred=this.messageText=null;this.title=w;this.messageText=D;this.isDeferred=J}}Object(K.a)(r,"DeferredContentProps",e.a,[]);var m=d(28),n=d(944),z=d(945);const v=(D,w)=>Object.assign(new n.a,{target:".EditingRibbonPanel",content:D,useTeachingStyles:!1,
showCloseIcon:!0,calloutProps:Object.assign(new z.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1,preventDismissOnScroll:!0,onDismiss:w,preventDismissOnResize:!0})});var x=d(48);d.d(U,"a",function(){return B});class B{constructor(){this.oU=new r(ResourceStrings.l_DeferredContentDownloadACopyWaitToastMessage,ResourceStrings.l_DeferredContentDownloadACopyWaitDialogTitle,!0)}dVi(D,w,J,G){G=Object.assign(new h.a,{onShow:()=>{J.DI(x.a.J1a)}});w=D.callout(w);return G=D.addNotification(w,G)}z5k(D,w){D.removeNotification(w);
m.a.J(523871964,843,10,"DownloadACopy Toast can not be removed!");return w}hNi(D){return v(this.oU,()=>{D.Eo(x.a.J1a)})}}Object(K.a)(B,"DownloadACopyDeferred",null,[519])},1055:function(K,U,d){K=d(0);var h=d(589),e=d(1244),r=d(293),m=d(510);class n{constructor(){this.limField=0;this.limFieldSpecified=!1}}Object(K.a)(n,"CT_LineJoinMiterProperties",null,[]);var z=d(977);class v{constructor(){this.valField=0}}Object(K.a)(v,"CT_PositiveFixedPercentage",null,[]);var x=d(978),B=d(372),D=d(327),w=d(294);
d.d(U,"a",function(){return J});class J{Sag(G,M,N,R,C,O){G=Object(e.a)(340,O.Ba.tg(C.Na));N=C.Md;C=Math.round(R.cN(N.Ne(M.width*h.a.zD,0),G.UT));M=Math.round(R.cN(N.Ne(M.height*h.a.zD,1),G.UT));return{xzh:C,pzh:M}}yOf(G,M){return Object.assign(new r.a,{TopLeft:Object.assign(new w.a,{X:0,Y:0}),TopRight:Object.assign(new w.a,{X:G,Y:0}),BottomLeft:Object.assign(new w.a,{X:0,Y:M}),BottomRight:Object.assign(new w.a,{X:G,Y:M})})}cxh(G){G.lineStyle=Object.assign(new z.a,{algnField:0,algnFieldSpecified:!0,
capField:2,capFieldSpecified:!0,cmpdField:0,cmpdFieldSpecified:!0,miterField:Object.assign(new n,{limField:8E5,limFieldSpecified:!0}),prstDashField:Object.assign(new x.a,{valField:0,valFieldSpecified:!0}),solidFillField:Object.assign(new D.a,{schemeClrField:Object.assign(new B.a,{valField:4})}),wField:6350,wFieldSpecified:!0})}nxh(G){G.fill=Object.assign(new m.a,{solidFillField:Object.assign(new D.a,{schemeClrField:Object.assign(new B.a,{valField:4})})});G.lineStyle=Object.assign(new z.a,{algnField:0,
algnFieldSpecified:!0,capField:2,capFieldSpecified:!0,cmpdField:0,cmpdFieldSpecified:!0,miterField:Object.assign(new n,{limField:8E5,limFieldSpecified:!0}),prstDashField:Object.assign(new x.a,{valField:0,valFieldSpecified:!0}),solidFillField:Object.assign(new D.a,{schemeClrField:this.fOi(Object.assign(new v,{valField:5E4}))}),wField:12700,wFieldSpecified:!0})}fOi(G){const M={itemsElementNameField:[26]};M.itemsField=[G];M.valField=4;return M}}Object(K.a)(J,"InsertShapeActorHelper",null,[506])},1065:function(K,
U,d){K=d(0);var h=d(7),e=d(1243),r=d(27),m=d(67),n=d(82);class z{constructor(x,B,D,w=null){this.origin=x;this.data=B;this.source=D;this.mc=w}}Object(K.a)(z,"MessageEventArgs",null,[]);d.d(U,"a",function(){return v});class v{constructor(x,B){this.mRd=null;this.L$h=x;this.Zd=B;this.IDc=null}get Mmb(){return this.L$h.value}get taskManager(){return this.Zd.value}Sni(x){this.IDc=x;this.mRd=Object(h.a)(this,this.rQk,"postMessageEventHandler");this.Mmb.addHandler(m.a.message,this.mRd,null)}vTi(){this.IDc=
null;this.Mmb.removeHandler(m.a.message,this.mRd)}T_c(x,B){const D=new n.a(0,1,1,()=>{x(B)},7);this.taskManager.Hb(D)}wRj(x,B){const D=new n.a(0,1,1,()=>{x(B)},7);this.taskManager.Hb(D)}rQk(x){return this.IDc?this.IDc(new z(x.origin,x.data,x.source,x.mc)):!1}static get instance(){return v.E$a()}static E$a(){return new v(new e.a(()=>r.AFrameworkApplication.Mmb),new e.a(()=>r.AFrameworkApplication.Ae))}}Object(K.a)(v,"MessageEventHandler",null,[329])},1068:function(K,U,d){K=d(0);var h=d(392),e=d(105),
r=d(269),m=d(7),n=d(1244),z=d(36);class v{constructor(){this.Value=this.Id=this.LanguageId=null}}Object(K.a)(v,"CritiqueTypeOption",null,[]);var x=d(3);d.d(U,"a",function(){return B});class B{constructor(D,w,J){this.kOd={};this.Bl=null;this.Jrf=D;this.m6h=w;this.n6h=J;this.r5a=x.Task.qt({})}init(){this.r5a=this.Jrf.dee(this.m6h,["ProofingSettingLanguageList","ProofingSettings"]).CWRCo(Object(m.a)(this,this.MEk,"onLoadSettingsTaskFinished"),8)}THl(D){const w={};if(!(D&&"ProofingSettingLanguageList"in
D))return w;const J=Array.isArray(z.a(D.ProofingSettingLanguageList))?z.a(D.ProofingSettingLanguageList):null;for(const G of J)"ProofingSettings"+G in D&&(w[G]=Object(n.a)(Object,z.a(D["ProofingSettings"+G])));return w}UHl(D){const w={},J=[];for(let N in D){var G=N,M=D[N];M&&(J.push(G),w["ProofingSettings"+G]=z.c(M))}w.ProofingSettingLanguageList=z.c(J);return w}saveSettings(D){this.r5a=x.Task.qt(D);this.Bl=null;try{const w=this.UHl(D);this.Jrf.Iyh(this.n6h,w).continueWith(Object(m.a)(this,this.ZGk,
"onSaveSettingsTaskFinished"),8)}catch(w){h.ULS.sendTraceTag(35401881,375,10,"Save settings failed with exception {0}",w.toString())}}g$d(){if(!this.Bl){if(6!==this.r5a.status)return[];try{var D=this.r5a.result;let M;if(e.a.isEmpty(this.kOd))M=D;else if(e.a.isEmpty(D))M=this.kOd;else{M={};var w=this.kOd;for(let N in w)M[N]=e.a.otc(w[N]);M=B.merge(M,D)}this.Bl=[];for(let N in M){var J=M[N];const R=r.a.He(parseInt(N));if(!R)continue;const C=R.name;w=J;for(let O in w){D=O;var G=w[O];const S=Object.assign(new v,
{LanguageId:C,Id:D,Value:G.toString()});this.Bl.push(S)}}}catch(M){h.ULS.sendTraceTag(36542301,375,10,"GetCritiqueTypeOptions failed with exception: {0}",M.toString())}}return this.Bl}BUi(D,w){const J=this.r5a.result;if(J)try{let G=J[D];G||(G={});G[w]=!1;J[D]=G;this.saveSettings(J)}catch(G){h.ULS.sendTraceTag(36750082,375,10,"DisableCritique failed with exception: {0}",G.toString())}}MEk(D){if(D.Dm)return h.ULS.sendTraceTag(34964619,375,10,"Load setting failed with exception {0}",D.ej),null;if(6===
D.status)try{return this.THl(D.result)}catch(w){h.ULS.sendTraceTag(34964620,375,10,"Parse settings with exception {0}",w.toString())}return null}ZGk(D){D.Dm&&h.ULS.sendTraceTag(34964621,375,10,"Save setting failed with exception {0}",D.ej)}static merge(D,w){D=D||{};if(w)for(let M in w){var J=M,G=w[M];D[J]=D[J]||{};for(let N in G)D[J][N]=G[N]}return D}}Object(K.a)(B,"CritiqueTypeSettings",null,[741])},1071:function(K,U,d){K=d(0);var h=d(27),e=d(139),r=d(81),m=d(1252),n=d(205),z=d(47),v=d(162),x=d(28),
B=d(447),D=d(448);class w{constructor(){this.alt=null;this.height=0;this.src=this.alt="";this.width=this.height=0}}Object(K.a)(w,"ImagePasteArgs",null,[]);var J=d(332),G=d(43),M=d(49),N=d(30);d.d(U,"a",function(){return R});class R{constructor(C,O,S,T,ca,L,da,Z,fa,aa,ja,I){this.ia=C;this.Fa=O;this.wIa=S;this.pa=T;this.Zsk=ca;this.Wo=L;this.oma=da;this.$e=aa;this.NB=ja;this.Ec=I;this.ghc=Z;this.u$c=fa;this.Kdd=!1;this.Shc=-1}xQ(C){if(!this.wIa.oac(this.Fa)||!C)return!1;if(C.gSc&&C.ehe)return this.Kdd=
!1,C.xQ=this.ghc;if(!C.hn||0<C.hn.getElementsByTagName(M.a.Dig).length)return!1;this.Kdd=!this.Qfe(C)&&this.r3j(this.pa.Xd());C.xQ=this.Kdd?this.u$c:this.ghc;return C.xQ}r3j(C){return 1===C.length?C[0].H4j:!1}hUk(C,O){this.mih(C,O,0);if(!C.firstChild||!C.firstChild.className||!B.a.Elg(C.firstChild.className))if(!this.Wo.gg||"<br>"!==C.innerHTML){const S=v.b(C);S&&0<S.length&&(O.gZ=C.innerHTML)}}mih(C,O,S){if(C){if(S>=R.iLc)throw Error.create(String.format("Exceeds the maximum recursions ({0}).",R.iLc));
if(1===C.nodeType){var T=C.tagName.toLowerCase();if(this.oma.u1j(T))C.parentNode.removeChild(C);else{for(let L=C.firstChild;L;L=ca){var ca=L.nextSibling;this.mih(L,O,S+1)}T===M.a.n4?(C.parentNode.removeChild(C),this.iUk(C,O)):T===M.a.Bmb?(C.parentNode.removeChild(C),this.OUk(C,O)):T===M.a.listTag&&this.oUk(C);h.AFrameworkApplication.fa.ka("EnhancedTextCCPEnabled")&&this.WOl(C);O.Gbc&&this.S6k(C);O.Hbc&&this.R6k(C);this.Ec.P_e(C,O.Wb)}}}}WOl(C){(C=C.style)&&C.N5e&&(C.textDecoration=C.N5e)}R6k(C){const O=
C.style;O&&(O.fontFamily&&(O.fontFamily=""),O.fontSize&&(O.fontSize=""),O.color&&(O.color=""),C.getAttribute&&C.getAttribute("data-scheme-color")&&C.setAttribute("data-scheme-color",""),O.backgroundColor&&(O.backgroundColor=""),O.backgroundImage&&C.className&&-1<C.className.indexOf("Highlight")&&(O.backgroundImage=""))}S6k(C){const O=C.style;O&&(O.fontWeight&&(O.fontWeight=""),O.fontStyle&&(O.fontStyle=""),O.textDecoration&&(O.textDecoration=""),O.N5e&&(O.N5e=""),O.verticalAlign&&(O.verticalAlign=
""),O.fontFamily&&(O.fontFamily=""),O.fontSize&&(O.fontSize=""),O.color&&(O.color=""),C.getAttribute&&C.getAttribute("data-scheme-color")&&C.setAttribute("data-scheme-color",""),O.backgroundColor&&(O.backgroundColor=""),O.backgroundImage&&C.className&&-1<C.className.indexOf("Highlight")&&(O.backgroundImage=""))}oUk(C){if(C){var O=C.getAttribute("data-"+e.a.n0b);if(O&&0<O.length&&C.style){var S=parseInt(O);if(1!==O.length||isNaN(S)||1>S||S>J.a.u8)O="1",S=1;S>this.Shc&&(this.Shc=S);O=String.format(M.a.f9j,
O);(S=C.style.cssText)?C.setAttribute("style",O+S):C.setAttribute("style",O)}if((O=C.parentNode)&&!this.$e.mZj(O.tagName)){S=C.nextSibling;const T=this.$e.B3b();T.appendChild(C);O.insertBefore(T,S)}}}iUk(C,O){if(C&&C.src&&C.src.length){var S=window.location.href.toLowerCase();S=r.a.DQ(S);if(C.src.startsWith(S))x.a.J(509153345,826,50,"Pasted image src is an empty string.");else{S=Math.ceil(m.a.Ne(this.oma.Qij(C),0,!1));var T=Math.ceil(m.a.Ne(this.oma.Iij(C),1,!1));O.hea.push(Object.assign(new w,{src:C.src,
alt:C.alt,width:S?S:C.width,height:T?T:C.height}))}}}OUk(C,O){C&&C.innerHTML&&C.rows&&C.rows.length&&(C.getElementsByTagName(M.a.Jvd).length||C.getElementsByTagName(M.a.NDl).length)&&(C=v.c(C),!C||0>=C.length||O.r2a.push(C))}Qfe(C){if(C.gSc)return!0;const O=C.hn.getElementsByTagName(M.a.Bmb).length;return 0<C.hn.getElementsByTagName(M.a.n4).length||0<O}paste(C){if(h.AFrameworkApplication.ZQ)this.Zsk.luc(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null);else{const O=Object.assign(new D.a,
{Wb:C.Wb});let S=!0;O.COb=this.Kdd;h.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")&&(O.smg=C.t6d,O.Gbc=C.O5b&&!this.Qfe(C)&&""!==C.hn.innerText,O.Hbc=h.AFrameworkApplication.fa.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled")&&C.P5b&&!this.Qfe(C));if(C.gSc)O.hea.push(Object.assign(new w,{src:C.ehe,width:0,height:0}));else try{this.hUk(C.hn,O),0<this.Shc&&(x.a.J(509153315,826,50,String.format("max list level pasted into new shape = {0}.",this.Shc-1)),this.Shc=-1)}catch(T){S=!1,x.a.J(509153314,
826,15,T.message)}S&&(this.Xrl(O)?this.yNk(O):this.ia.Ka(N.a.eya,2,O))}}Xrl(C){return n.a.Xa(C.r2a)&&z.a.Xa(C.gZ)&&!!C.hea&&1===C.hea.length&&this.A5j(C.hea[0].src)}A5j(C){if(z.a.Xa(C)||!C.startsWith("data:image"))return!1;C=C.split(";");if(!C||2!==C.length)return!1;C=C[0].replace("/",".");return 0===this.NB.dzd(C,!0)}yNk(C){let O=new Image;const S=C.hea[0],T=G.a.Kb;if(S.width&&S.height)C.m2c=!0,this.ia.Ka(N.a.eya,2,C);else{const ca=new Date;O.onload=()=>{C.rOe=+new Date-+ca;S.width=O.width;S.height=
O.height;C.m2c=!0;O=null;G.a.NF(T,()=>{this.ia.Ka(N.a.eya,2,C)})};O.onerror=()=>{O=null;G.a.NF(T,()=>{this.ia.Ka(N.a.eya,2,C)})};O.src=S.src}}}R.iLc=100;Object(K.a)(R,"HtmlPasteHandler",null,[525])},1072:function(K,U,d){K=d(0);var h=d(18),e=d(27),r=d(1249),m=d(249),n=d(39);class z{constructor(D,w){this.actionId=D;this.zd=w}}Object(K.a)(z,"CommandActionData",null,[]);var v=d(30),x=d(33);d.d(U,"a",function(){return B});class B{constructor(D,w,J,G,M,N){this.f1g=[];this.rqg=!1;this.Zdc=null;this.z6c=
new h.a;this.ia=D;this.oEe=w;this.Jwf=!1;this.Rb=J;this.xH=G;this.U$=M;this.hyg=this.JFb=null;N&&Object(x.a)("EnhancementOfSDXPaneBootTime")&&this.eMj()}eMj(){this.JFb||(this.JFb=e.AFrameworkApplication.lj("officeExtensionMerge.js",5));this.hyg||(this.hyg=e.AFrameworkApplication.lj("appforoffice.hermes"+this.xH.Qqe,1));if(!this.Zdc){const D=[this.U$.Bvb(this.xKe)];this.Zdc=r.a.create("pptedit.appforoffice",D,()=>d.e(7).then(d.bind(null,1288)))}}get Jxd(){return this.f1g}get xKe(){this.JFb||(this.JFb=
e.AFrameworkApplication.lj("officeExtensionMerge.js",5));return this.JFb}set xKe(D){this.JFb=D}get Vki(){if(!this.Zdc){const D=[this.U$.Bvb(this.xKe)];this.Zdc=r.a.create("pptedit.appforoffice",D,()=>d.e(7).then(d.bind(null,1288)))}return this.Zdc}Hdi(D){this.Jxd.push(D)}Eja(){this.rqg||(m.a.oy(this.Vki),this.rqg=!0)}DIl(){for(const D of this.Jxd)D.Nlb();this.f1g=[]}EIl(){var D=this.Rb.Lc(this.oEe.Ef).Cb(18);D=this.Rb.Lc(D);let w=D.Cb(19);if(w){do w=D.Cq,this.ia.Ka(v.a.ikb,2,w.eb(n.a.b_));while(D.Gf(19))
}}zQa(D,w){this.z6c.add(new z(D,w))}gAj(){if(0<this.z6c.count){for(let D of this.z6c)this.ia.Ka(D.actionId,2,D.zd);this.z6c.clear()}}Cfe(){const D=!!this.Jxd&&0<this.Jxd.length;let w=!1;if(this.oEe.Ef&&!D){const J=this.Rb.Lc(this.oEe.Ef).Cb(18);J&&0<this.Rb.Lc(J).W8(19)&&(w=!0)}return D||w}}Object(K.a)(B,"AppForOfficeManagerFactory",null,[468])},1073:function(K,U,d){K=d(0);var h=d(47);class e{constructor(m,n){this.xjk=m;this.Jad=n}get JVa(){return this.xjk}get message(){return this.Jad}}Object(K.a)(e,
"CalloutNotificationError",null,[]);d.d(U,"a",function(){return r});class r{constructor(m,n){this.fzg=m;this.wpk=n}fba(m,n,z,v,x,B,D,w,J,G,M,N,R,C){this.fzg.show(this.wpk,null,!1,J,G,m,n,z,x,v,B,D,w,M,N,R,C)}H3d(){this.fzg.dismiss()}MBh(m){if(!m)throw Error.argumentNull("CalloutNotificationMessageAttributes");const n=this.MSl(m);if(n&&n.JVa)return n;this.fba(m.title,m.message,m.Sgg,m.CKb,m.Xgg,m.Tqd,m.uTk,m.bgl,m.vTk,m.cgl,!!m.timeoutInSeconds,m.timeoutInSeconds,m.jHj,m.RJj);return new e(!1,null)}MSl(m){return h.a.Xa(m.title)?
new e(!0,"Invalid Title"):h.a.Xa(m.message)?new e(!0,"Invalid Message"):m.Sgg&&h.a.Xa(m.CKb)?new e(!0,"Missing PrimaryButtonLabel"):m.Xgg&&h.a.Xa(m.Tqd)?new e(!0,"Missing SecondaryButtonLabel"):new e(!1,null)}}Object(K.a)(r,"CalloutNotificationAdapter",null,[363])},1074:function(K,U,d){K=d(0);var h=d(27),e=d(745),r=d(233);class m extends e.a{constructor(z,v){super(z);this.Tek=v}TIh(z){return r.i(r.g(z))}v6e(z){return r.i(z)}bwc(z){return this.Tek?z.zpi:z.bwc().toString()}hti(z,v,x){const B=new Sys.StringBuilder;
B.append(String.format('<Menu Id="{0}">',"menuFontColor"));B.append(this.qee(z,v,x));B.append('<MenuSection Id="More Font Colors"><Controls Id="Color.Menu.Controls">');B.append(String.format('<Button Id="Color.Menu.MoreFontColors" Command="{0}" Image16by16="{1}" Image16by16Class="per_MoreColors_16x16x32" LabelText="{2}" Keytip="{3}" />',"862825906",h.AFrameworkApplication.Cm,ResourceStrings.l_MoreFontColors,ResourceStrings.l_MoreFontColorsKeytip));B.append("</Controls> </MenuSection>");B.append("</Menu>");
return B.toString()}}Object(K.a)(m,"ColorMenuBuilder",e.a,[]);d.d(U,"a",function(){return n});class n{Rcj(z){return new e.a(z)}l5f(z,v){return new m(z,v)}}Object(K.a)(n,"ColorPickerBuilderFactory",null,[381])},1075:function(K,U,d){var h=d(152);K=d(0);var e=d(106),r=d(1279),m;(function(N){N[N.unattempted=0]="unattempted";N[N.inProgress=1]="inProgress";N[N.notHandled=2]="notHandled";N[N.handleExternally=4]="handleExternally";N[N.failed=8]="failed";N[N.error=16]="error";N[N.succeeded=32]="succeeded";
N[N.delayed=64]="delayed"})(m||(m={}));Object(K.b)("ActionResponse",m);var n=d(39),z=d(280),v=d(350),x=d(690),B=d(150),D=d(339),w=d(1244),J=d(30),G=d(448);d.d(U,"a",function(){return M});class M{constructor(N,R,C,O,S,T,ca,L,da,Z,fa){this.ta=N;this.pa=R;this.hj=C;this.Fa=O;this.xk=S;this.Rq=T;this.b1=ca;this.qf=L;this.ia=da;this.qr=Z;this.rIa=fa;this.select=({scope:aa,index:ja=-1})=>Object(h.a)(this,void 0,void 0,function*(){let I=[],sa=[];var ka=null!==aa&&void 0!==aa?aa:"Selection";if("Selection"===
ka){var Ma=this.pa.un();Ma?sa.push(Ma):(Ma=this.pa.Se(),0<Ma.length&&this.rIa.UMb(14,Ma,I),0!=I.length||aa||(ka="Presentation"))}if(Array.isArray(ka)&&0<ka.length&&ka[0]instanceof z.a)this.rIa.UMb(14,ka,I);else if("Presentation"===ka&&this.ta.presentation){ka=this.ta.presentation.slides;if(null===ka)throw Error("Could not cast from ISlide to ISlide on presentation slides");this.rIa.UMb(14,ka,I)}sa.push(...I.map(Ea=>Ea.node));return-1!==ja&&ja<sa.length?[sa[ja]]:sa});this.format=({tables:aa,color:ja,
fillColor:I,styles:sa,cellColor:ka,border:Ma,borderColor:Ea,mergeCells:ma,splitCells:va})=>Object(h.a)(this,void 0,void 0,function*(){var Ca;let oa=!1;var Da=!1,ta=!1;const ha=[];for(const bb of aa){let Na=this.pa.Ev();1===aa.length&&Na&&0<Na.length?oa=!0:Na=bb.Bab();Na.filter(Ia=>!Ia.isGhostCell);var Ha=this.Btj(null!==(Ca=null!==sa&&void 0!==sa?sa:I)&&void 0!==Ca?Ca:ja);Ha&&0<Ha.length&&bb.setValue(n.a.Oza,e.a.Jf(Ha));if(ka&&x.a.kIf(ka)&&!Da){Da=this.fde(ka);for(const Ia of Na)Ha=Ia.cellShading,
v.b(Ha),Ha.solidFillField=Da,Ia.cellShading=Ha;Da=oa&&1===aa.length}if((Ma||Ea)&&!ta){if(Ma)ta=Ea&&x.a.kIf(Ea)?this.fde(Ea):void 0,this.ia.Ka(J.a.Lpa,r.a.execute,{["TableNode"]:bb,["CellNodes"]:Na,["SourceControlId"]:this.J$a(Ma),["BorderColor"]:ta,["DoNotCreateTransaction"]:!0});else{ta=x.a.MRa(Ea);this.ia.Ka(J.a.p2a,r.a.execute,{["TableNode"]:bb,["Color"]:ta});ta=this.fde(Ea);for(const Ia of Na)B.Box4ColorHelper.Rbb(Ia.wMa)||(Ia.wMa=ta),B.Box4ColorHelper.Rbb(Ia.$ga)||(Ia.$ga=ta),B.Box4ColorHelper.Rbb(Ia.vMa)||
(Ia.vMa=ta),B.Box4ColorHelper.Rbb(Ia.aha)||(Ia.aha=ta)}ta=oa&&1===aa.length}(ma||va)&&oa&&this.ia.Ka(ma?J.a.mergeTableCells:J.a.splitTableCells,r.a.execute,{["rows"]:1,["columns"]:2});ha.push(new Promise(Ia=>D.a.k9(Ia,bb,!0).bind(this)))}yield Promise.all(ha)});this.sQj=aa=>{aa=Object.assign(new G.a,{COb:!1,r2a:[aa]});if(this.ia.Ka(J.a.eya,r.a.execute,aa)!==m.succeeded)throw Error("Table insertion from HTML failed.");return this.pa.fo()};this.uQj=(aa,ja,I)=>{const sa=[];if(!ja||Number.isNaN(ja)||
!I||Number.isNaN(I))throw Error("Invalid rows and columns provided.");this.pa.au();this.pa.nh();this.Fa.Bd();for(const Ma of aa){aa=Ma;if(!aa)throw Error("Cannot find selected slide to insert table.");if(!this.qf.$c(aa)){if(!this.hj.iD(aa,1))throw this.hj.KD(aa),Error("Too many shapes on the slide.");var ka=aa.Db;ka=aa.C3(ka.sid,ka.cid,0,ja,I,aa.zs());sa.push(ka);this.qr.zT([ka],aa,null);this.Rq.lA=ka}}return sa};this.insert=({slides:aa,rows:ja,columns:I,html:sa})=>Object(h.a)(this,void 0,void 0,
function*(){if(!aa)throw Error("No slide context provided to insert table.");const ka=[];sa?ka.push(this.sQj(sa)):ka.push(...this.uQj(aa,ja,I));const Ma=[];for(const Ea of ka)Ma.push(new Promise(ma=>D.a.k9(ma,Ea,!0).bind(this)));return Promise.all(Ma)});this.delete=({tables:aa})=>Object(h.a)(this,void 0,void 0,function*(){if(!aa)throw Error.argumentNull("tables");for(const sa of aa){var ja=this.pa.fo();ja&&ja.vd&&this.qf.$c(ja)||(ja=Object(w.a)(4,sa),this.xk.gQc(ja))}const I=this.ta.Ba;I&&this.qf.rw(I,
"handleDeleteTable");return new Promise(sa=>D.a.k9(sa,I).bind(this))});if(!N)throw Error.argumentNull("m_graphTopologyManager");if(!R)throw Error.argumentNull("m_selectionManager");if(!C)throw Error.argumentNull("m_shapeCountValidator");if(!O)throw Error.argumentNull("m_focusManager");if(!S)throw Error.argumentNull("m_shapeEditor");if(!T)throw Error.argumentNull("m_ribbonChangeManager");if(!ca)throw Error.argumentNull("m_tableStyleGalleryManager");if(!L)throw Error.argumentNull("m_actionBlockingManager");
if(!da)throw Error.argumentNull("m_actionManager");if(!Z)throw Error.argumentNull("m_transactionHelper");if(!fa)throw Error.argumentNull("m_odslGraphUtils");}evj(){var N=this.pa.Se();return N&&0!=N.length?(N=N[0])?N.Ed:null:null}Ncj(N,R){N=x.a.Pcj(N);return(Math.abs(N.r-R.r)^2)+(Math.abs(N.g-R.g)^2)+(Math.abs(N.b-R.b)^2)}Btj(N){if(!N)return"";var R=N.toLowerCase();this.b1.q5d();N=this.b1.$Tc();if(!N||!N.length)return"";if(R.includes("transparent")||R.includes("none")){var C=N[0].Rh(n.a.tableStyle);
return C.hY?C.hY.styleIdField:""}R=x.a.MRa(R);if(!R.length)return"";const O=this.evj();if(!O)return"";let S=999999,T="";for(let L=0;7>L;++L){const da=N[L].Rh(n.a.tableStyle);if(!da.hY)continue;var ca=null!==(C=da.hY.firstRowField)&&void 0!==C?C:da.hY.wholeTblField;if(!ca||!ca.tcStyleField)continue;ca=ca.tcStyleField.fillField;if(!ca||ca.noFillField)continue;let Z;ca.solidFillField?Z=B.Box4ColorHelper.UH(B.Box4ColorHelper.Rga(ca.solidFillField),O):ca.gradFillField&&(Z=v.f(ca.gradFillField,O).stops[0].color);
Z&&(ca=this.Ncj(R,Z),ca<=S&&(S=ca,T=da.hY.styleIdField))}return T}fde(N){const R={};R.Color=x.a.MRa(N);return B.Box4ColorHelper.pS(R)}J$a(N){N=N.toLowerCase();if(N.includes("no"))return"TableBordersNoBorder";if(!N.includes("all")){if(N.includes("outside"))return"TableBordersOutsideBorders";if(N.includes("horizontal"))return"TableBordersInsideHorizontalBorder";if(N.includes("vertical"))return"TableBordersInsideVerticalBorder";if(N.includes("inside"))return"TableBordersInsideBorders";if(N.includes("top"))return"TableBordersTopBorder";
if(N.includes("bottom"))return"TableBordersBottomBorder";if(N.includes("left"))return"TableBordersLeftBorder";if(N.includes("right"))return"TableBordersRightBorder";if(N.includes("up"))return"TableBordersDiagonalUpBorder";if(N.includes("down"))return"TableBordersDiagonalDownBorder";if(N.includes("diagonal"))return"TableBordersDiagonalUpBorder"}return"TableBordersAllBorders"}}Object(K.a)(M,"ODSLTable",null,[464])},1077:function(K,U,d){K=d(0);var h=d(669),e=d(143);class r extends h.a{constructor(){super();
this.languageId=null;this.startOfSentence=!1;this.userInitQuery=this.text=null;this.H_=Object.assign(new e.a,{T_:r.getTypeName(),B_:r.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_TextPredictorSignalBase"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(K.a)(r,"TextPredictorSignalBase",h.a,[]);d.d(U,"a",function(){return m});class m extends r{constructor(){super();this.H_=Object.assign(new e.a,{T_:m.getTypeName(),B_:m.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_TextPredictorSignal"}static getBaseTypes(){return["AugLoop_Signals_TextPredictorSignalBase",
"AugLoop_Signals_Signal"]}}Object(K.a)(m,"TextPredictorSignal",r,[])},111:function(K,U,d){d.d(U,"a",function(){return e});K=d(0);var h=d(1273);class e{constructor(){this.x$a=this.cGf=this.W3=this.iba=this.fLc=this.STc=this.Cxb=this.CEa=this.m_=this.eNc=this.Fwd=null}Hf(r){this.Fwd=new h.a;this.Fwd.value=r}Dsc(){this.eNc=new h.a;this.eNc.value=!0}kV(r){this.STc=new h.a;this.STc.value=r}}Object(K.a)(e,"QueryResult",null,[])},1144:function(K,U,d){d.d(U,"a",function(){return e});K=d(0);var h=d(99);class e{constructor(r){this.xCd=
r.cloneNode(!0);this.bpf=r}restore(){for(h.a.vv(this.bpf);this.xCd.firstChild;){const r=this.xCd.firstChild;h.a.lP(r);this.bpf.appendChild(r)}this.xCd=null}}Object(K.a)(e,"DomElementContentState",null,[])},1145:function(K,U,d){d.r(U);d.d(U,"SpellingRequestObjectUpdatedV2",function(){return r});K=d(0);var h=d(674),e=d(673);class r extends h.a{constructor(){super();this.ProofingEngine=0;this.UseContextualResults=!1;this.TextUnit=0;this.Descriptors=this.OverriddenCritiqueTypeOptions=null;this.UxLcid=
0}static L8d(m,n){const z=new r;h.a.oPe(z,m,n);z.UserActionType=e.a[m.userAction];z.ProofingEngine=m.uga;z.Descriptors=m.descriptors;z.OverriddenCritiqueTypeOptions=m.overriddenCritiqueTypeOptions;z.UxLcid=m.DPh;2===m.uga?z.TextUnit=m.range.textUnit:1===m.uga&&(z.UseContextualResults=!0);return z}}Object(K.a)(r,"SpellingRequestObjectUpdatedV2",h.a,[])},1146:function(K,U,d){d.r(U);d.d(U,"SpellingRequestObjectUpdated",function(){return r});K=d(0);var h=d(674),e=d(673);class r extends h.a{constructor(){super();
this.UseContextualResults=this.TrackMetrics=this.UseOneSpeller=!1;this.ExperimentId=null}static L8d(m,n,z,v,x,B){const D=new r;h.a.oPe(D,m,n);D.UserActionType=e.a[m.userAction];D.UseOneSpeller=z;D.TrackMetrics=v;D.UseContextualResults=x;B&&(D.ExperimentId=B);return D}}Object(K.a)(r,"SpellingRequestObjectUpdated",h.a,[])},1147:function(K,U,d){d.r(U);d.d(U,"ReactOICErrorDialogWithTrial",function(){return m});K=d(0);var h=d(7);U=d(940);var e=d(202),r=d(79);class m extends U.a{constructor(n,z,v,x,B,D){super(n,
z,v,x,B,D);z={["errorMessage"]:this.hYf,["offerString"]:this.R6g};n=new r.a(!1,!1,!0);this.gCh?(n.Ad=1,z.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.aVa,["onExecute"]:()=>{e.Redirect.showHelp(this.lhg)}}):(n.Ad=4,n.Oe(2,this.pig));n.Oe(1,this.nwf);n.kg=this.id;z={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:z};n.pj(this.gka,Object(h.a)(this,this.y_k,"reactOICErrorDialogWithTrialHandler"),z)}}Object(K.a)(m,"ReactOICErrorDialogWithTrial",U.a,[])},1148:function(K,U,
d){d.r(U);d.d(U,"OICErrorDialogWithTrial",function(){return r});K=d(0);var h=d(7);U=d(940);var e=d(107);class r extends U.a{constructor(m,n,z,v,x,B){super(m,n,z,v,x,B);m=document.createElement("span");m.innerText=this.hYf;m.appendChild(document.createElement("br"));m.appendChild(document.createElement("br"));n=document.createElement("span");n.innerText=this.R6g;m.appendChild(n);n=new e.StandardDialog;this.gCh?(n.Ad=1,n.nSd(this.aVa,this.lhg)):(n.Ad=4,n.Oe(2,this.pig));n.Oe(1,this.nwf);n.kg=this.id;
n.Tx(this.gka,null,this.icon,Object(h.a)(this,this.H8j,"legacyOICErrorDialogWithTrialHandler"),m)}}Object(K.a)(r,"OICErrorDialogWithTrial",U.a,[])},1149:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.keytip=this.id=this.image=this.label=this.command=null}}Object(K.a)(h,"HeaderButtonInfo",null,[])},1150:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.ariaDescription=this.onExecute=this.label=null}}Object(K.a)(h,"CalloutButtonProps",
null,[])},1151:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.y=this.x=0}}Object(K.a)(h,"IPoint",null,[])},1152:function(K,U,d){d.d(U,"a",function(){return e});K=d(0);var h=d(27);d=d(77);class e{static kgi(r){e.Iaf.addHandler(e.HLf,r)}static zXk(r){h.AFrameworkApplication.fa.ka("SqmCommandEventSourceEnabled")&&e.Iaf.raiseEvent(e.HLf,r)}}e.HLf="CommandClickEvent";e.Iaf=new d.a;Object(K.a)(e,"CommandClickEvents",null,[])},1153:function(K,U,d){d.d(U,"a",function(){return h});
K=d(0);class h{}h.Image16by16Class="Image16by16Class";h.Image32by32Class="Image32by32Class";h.On="On";h.LabelText="LabelText";h.ApplyLabelTextToControlOnly="ApplyLabelTextToControlOnly";h.EnsureControlRoleIsButton="EnsureControlRoleIsButton";h.Visible="Visible";Object(K.a)(h,"SplitButtonCommandProperties",null,[])},1154:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(e,r=null,m=null,n=null){this.iconSet={};this.iconSet["default"]=e;this.iconSet.icon16=r;this.iconSet.icon24=
m;this.iconSet.icon32=n}}Object(K.a)(h,"IconSetContainer",null,[])},1155:function(K,U,d){d.r(U);d.d(U,"NewCustomEventFactory",function(){return h});K=d(0);d=d(544);class h extends d.a{constructor(){super()}create(e,r){const m={};m.detail=r;return new CustomEvent(e,m)}}Object(K.a)(h,"NewCustomEventFactory",d.a,[])},1156:function(K,U,d){d.r(U);d.d(U,"IECustomEventFactory",function(){return h});K=d(0);d=d(544);class h extends d.a{constructor(){super()}create(e,r){const m=window.document.createEvent("CustomEvent");
m.initCustomEvent(e,!1,!1,r);return m}}Object(K.a)(h,"IECustomEventFactory",d.a,[])},1157:function(K,U,d){d.r(U);d.d(U,"CheckRoamingRightsRequest",function(){return h});K=d(0);d=d(969);class h extends d.a{constructor(){super()}Kyb(){return 2}pl(){return 1}}Object(K.a)(h,"CheckRoamingRightsRequest",d.a,[])},1158:function(K,U,d){d.r(U);d.d(U,"GetRoamingLauncherRequest",function(){return h});K=d(0);d=d(969);class h extends d.a{constructor(){super()}Kyb(){return 0}pl(){return 2}}Object(K.a)(h,"GetRoamingLauncherRequest",
d.a,[])},1159:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);d=d(360);class h extends d.a{constructor(){super();this.LargePreviewIconStyle=this.PreviewIconStyle=this.FullIconStyle=this.Icon=null}get Type(){return 4}}Object(K.a)(h,"IconGalleryButtonProps",d.a,[])},1160:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}h.Mgh="WAC_Powerpoint";h.d$b=null;Object(K.a)(h,"AddinHostApp",null,[])},1161:function(K,U,d){d.d(U,"a",function(){return r});K=d(0);var h=d(204),e=d(95);class r{constructor(m){this.ow=
m;this.uN=Array.indexOf(this.ow,this.xka)}dispose(){this.ow=null}get q_(){return this.ow[this.uN]}mF(m){this.Fsc(m,!1);return!0}t$a(m){this.Fsc(m,!0)}Fsc(m,n){m&&(this.q_!==m||n)&&(m.tabIndex=0,e.FocusManager.Zq(m));Array.contains(this.ow,m)&&(this.uN=Array.indexOf(this.ow,m))}get Khh(){let m=this.uN;do if(m)if(0<m&&m<this.ow.length)m--;else break;else m=this.ow.length-1;while(!h.DOMFocusListing.aEa(this.ow[m])&&m!==this.uN);return this.ow[m]}get F5g(){let m=this.uN;do if(m===this.ow.length-1)m=0;
else if(0<=m&&m<this.ow.length-1)m++;else break;while(!h.DOMFocusListing.aEa(this.ow[m])&&m!==this.uN);return this.ow[m]}get xka(){let m=0;for(;!h.DOMFocusListing.aEa(this.ow[m])&&m<this.ow.length;)m++;return h.DOMFocusListing.aEa(this.ow[m])?this.ow[m]:null}get jCb(){let m=this.ow.length-1;for(;!h.DOMFocusListing.aEa(this.ow[m])&&0<m;)m--;return h.DOMFocusListing.aEa(this.ow[m])?this.ow[m]:null}}Object(K.a)(r,"DialogFocusListing",null,[273])},1162:function(K){(function(U,d){K.exports=d()})(this,
function(){function U(Xb,ab){if("object"!==d(Xb)||"function"!==typeof Xb.createPolicy)return null;var Ab=null;ab.currentScript&&ab.currentScript.hasAttribute("data-tt-policy-suffix")&&(Ab=ab.currentScript.getAttribute("data-tt-policy-suffix"));ab="dompurify"+(Ab?"#"+Ab:"");try{return Xb.createPolicy(ab,{createHTML:function(rc){return rc},createScriptURL:function(rc){return rc}})}catch(rc){return console.warn("TrustedTypes policy "+ab+" could not be created."),null}}function d(Xb){"@babel/helpers - typeof";
return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(ab){return typeof ab}:function(ab){return ab&&"function"==typeof Symbol&&ab.constructor===Symbol&&ab!==Symbol.prototype?"symbol":typeof ab},d(Xb)}function h(Xb,ab){h=Object.setPrototypeOf||function(Ab,rc){Ab.__proto__=rc;return Ab};return h(Xb,ab)}function e(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.QYl)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,
[],function(){})),!0}catch(Xb){return!1}}function r(Xb,ab,Ab){r=e()?Reflect.construct:function(rc,tb,Za){var fb=[null];fb.push.apply(fb,tb);rc=new (Function.bind.apply(rc,fb));Za&&h(rc,Za.prototype);return rc};return r.apply(null,arguments)}function m(Xb){var ab=Array.isArray(Xb)?n(Xb):void 0;ab||(ab="undefined"!==typeof Symbol&&null!=Xb[Symbol.iterator]||null!=Xb["@@iterator"]?Array.from(Xb):void 0);if(!ab)a:{if(Xb){if("string"===typeof Xb){ab=n(Xb,void 0);break a}ab=Object.prototype.toString.call(Xb).slice(8,
-1);"Object"===ab&&Xb.constructor&&(ab=Xb.constructor.name);if("Map"===ab||"Set"===ab){ab=Array.from(Xb);break a}if("Arguments"===ab||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ab)){ab=n(Xb,void 0);break a}}ab=void 0}if(!(Xb=ab))throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return Xb}function n(Xb,ab){if(null==ab||ab>Xb.length)ab=Xb.length;for(var Ab=0,rc=Array(ab);Ab<ab;Ab++)rc[Ab]=
Xb[Ab];return rc}function z(Xb){return function(ab){for(var Ab=arguments.length,rc=Array(1<Ab?Ab-1:0),tb=1;tb<Ab;tb++)rc[tb-1]=arguments[tb];return T(Xb,ab,rc)}}function v(Xb,ab,Ab){Ab=Ab?Ab:fa;J&&J(Xb,null);for(var rc=ab.length;rc--;){var tb=ab[rc];if("string"===typeof tb){var Za=Ab(tb);Za!==tb&&(G(ab)||(ab[rc]=Za),tb=Za)}Xb[tb]=!0}return Xb}function x(Xb){var ab=O(null),Ab;for(Ab in Xb)T(w,Xb,[Ab])&&(ab[Ab]=Xb[Ab]);return ab}function B(Xb,ab){for(;null!==Xb;){var Ab=N(Xb,ab);if(Ab){if(Ab.get)return z(Ab.get);
if("function"===typeof Ab.value)return z(Ab.value)}Xb=M(Xb)}return function(rc){console.warn("fallback value for",rc);return null}}function D(){function Xb(dd){var Lc,Zd;Ab("beforeSanitizeAttributes",dd,null);var Ne=dd.attributes;if(Ne){var Xc={attrName:"",FDf:"",Wtg:!0,LWl:uf};for(Zd=Ne.length;Zd--;){var lf=Lc=Ne[Zd],Kh=lf.name;lf=lf.namespaceURI;Lc="value"===Kh?Lc.value:ka(Lc.value);var bd=Nd(Kh);Xc.attrName=bd;Xc.FDf=Lc;Xc.Wtg=!0;Xc.J7i=void 0;Ab("uponSanitizeAttribute",dd,Xc);Lc=Xc.FDf;if(!Xc.J7i&&
(fb(Kh,dd),Xc.Wtg))if(Ma(/\/>/i,Lc))fb(Kh,dd);else{Qc&&(Lc=I(Lc,lb," "),Lc=I(Lc,Zb," "),Lc=I(Lc,Oc," "));var fd=Nd(dd.nodeName);a:{var Ve=fd;var rf=bd,Ag=Lc;if(Mf&&("id"===rf||"name"===rf)&&(Ag in ib||Ag in af))Ve=!1;else{if(!Bb||hf[rf]||!Ma(md,rf))if(!Xa||!Ma(Ib,rf))if(!uf[rf]||hf[rf]){if(!(0<Ve.indexOf("-")&&(Ze.c2 instanceof RegExp&&Ma(Ze.c2,Ve)||Ze.c2 instanceof Function&&Ze.c2(Ve))&&(Ze.O7a instanceof RegExp&&Ma(Ze.O7a,rf)||Ze.O7a instanceof Function&&Ze.O7a(rf))||"is"===rf&&Ze.KJc&&(Ze.c2 instanceof
RegExp&&Ma(Ze.c2,Ag)||Ze.c2 instanceof Function&&Ze.c2(Ag)))){Ve=!1;break a}}else if(!(le[rf]||Ma(Ud,I(Ag,od,""))||("src"===rf||"xlink:href"===rf||"href"===rf)&&"script"!==Ve&&0===sa(Ag,"data:")&&Ic[Ve]||mc&&!Ma(ud,I(Ag,od,"")))&&Ag){Ve=!1;break a}Ve=!0}}if(Ve){!Bd||"id"!==bd&&"name"!==bd||(fb(Kh,dd),Lc="user-content-"+Lc);if(Mc&&"object"===d(Rb)&&"function"===typeof Rb.getAttributeType&&!lf)switch(Rb.getAttributeType(fd,bd)){case "TrustedHTML":Lc=Mc.createHTML(Lc);break;case "TrustedScriptURL":Lc=
Mc.createScriptURL(Lc)}try{lf?dd.setAttributeNS(lf,Kh,Lc):dd.setAttribute(Kh,Lc),da(Sc.removed)}catch(ne){}}}}Ab("afterSanitizeAttributes",dd,null)}}function ab(dd){Ab("beforeSanitizeElements",dd,null);if(dd instanceof wc&&("string"!==typeof dd.nodeName||"string"!==typeof dd.textContent||"function"!==typeof dd.removeChild||!(dd.attributes instanceof Wb)||"function"!==typeof dd.removeAttribute||"function"!==typeof dd.setAttribute||"string"!==typeof dd.namespaceURI||"function"!==typeof dd.insertBefore||
"function"!==typeof dd.hasChildNodes)||Ma(/[\u0080-\uFFFF]/,dd.nodeName))return ac(dd),!0;var Lc=Nd(dd.nodeName);Ab("uponSanitizeElement",dd,{tagName:Lc,MWl:Ad});if(!(!dd.hasChildNodes()||rc(dd.firstElementChild)||rc(dd.content)&&rc(dd.content.firstElementChild))&&Ma(/<[/\w]/g,dd.innerHTML)&&Ma(/<[/\w]/g,dd.textContent)||"select"===Lc&&Ma(/<template/i,dd.innerHTML))return ac(dd),!0;if(!Ad[Lc]||Ke[Lc]){if(!Ke[Lc]&&0<Lc.indexOf("-")&&(Ze.c2 instanceof RegExp&&Ma(Ze.c2,Lc)||Ze.c2 instanceof Function&&
Ze.c2(Lc)))return!1;if(Rc&&!Oa[Lc]){Lc=Pc(dd)||dd.parentNode;var Zd=zc(dd)||dd.childNodes;if(Zd&&Lc)for(var Ne=Zd.length-1;0<=Ne;--Ne)Lc.insertBefore(mb(Zd[Ne],!0),Ub(dd))}ac(dd);return!0}if(Zd=dd instanceof xc){(Zd=Pc(dd))&&Zd.tagName||(Zd={namespaceURI:ef,tagName:"template"});Ne=fa(dd.tagName);var Xc=fa(Zd.tagName);Zd=!(oc[dd.namespaceURI]&&("http://www.w3.org/2000/svg"===dd.namespaceURI?"http://www.w3.org/1999/xhtml"===Zd.namespaceURI?"svg"===Ne:"http://www.w3.org/1998/Math/MathML"===Zd.namespaceURI?
"svg"===Ne&&("annotation-xml"===Xc||de[Xc]):ze[Ne]:"http://www.w3.org/1998/Math/MathML"===dd.namespaceURI?"http://www.w3.org/1999/xhtml"===Zd.namespaceURI?"math"===Ne:"http://www.w3.org/2000/svg"===Zd.namespaceURI?"math"===Ne&&$f[Xc]:si[Ne]:"http://www.w3.org/1999/xhtml"===dd.namespaceURI?"http://www.w3.org/2000/svg"===Zd.namespaceURI&&!$f[Xc]||"http://www.w3.org/1998/Math/MathML"===Zd.namespaceURI&&!de[Xc]?0:!si[Ne]&&(ge[Ne]||!ze[Ne]):"application/xhtml+xml"===nd&&oc[dd.namespaceURI]))}if(Zd||("noscript"===
Lc||"noembed"===Lc)&&Ma(/<\/no(script|embed)/i,dd.innerHTML))return ac(dd),!0;Qc&&3===dd.nodeType&&(Lc=dd.textContent,Lc=I(Lc,lb," "),Lc=I(Lc,Zb," "),Lc=I(Lc,Oc," "),dd.textContent!==Lc&&(Z(Sc.removed,{element:dd.cloneNode()}),dd.textContent=Lc));Ab("afterSanitizeElements",dd,null);return!1}function Ab(dd,Lc,Zd){sc[dd]&&L(sc[dd],function(Ne){Ne.call(Sc,Lc,Zd,Ce)})}function rc(dd){return"object"===d(Jb)?dd instanceof Jb:dd&&"object"===d(dd)&&"number"===typeof dd.nodeType&&"string"===typeof dd.nodeName}
function tb(dd){return cc.call(dd.ownerDocument||dd,dd,ic.SHOW_ELEMENT|ic.SHOW_COMMENT|ic.SHOW_TEXT,null,!1)}function Za(dd){if(Md)dd="<remove></remove>"+dd;else var Lc=(Lc=ja(dd,/^[\r\n\t ]+/))&&Lc[0];"application/xhtml+xml"===nd&&"http://www.w3.org/1999/xhtml"===ef&&(dd='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+dd+"</body></html>");var Zd=Mc?Mc.createHTML(dd):dd;if("http://www.w3.org/1999/xhtml"===ef)try{var Ne=(new nb).parseFromString(Zd,nd)}catch(Xc){}if(!Ne||!Ne.documentElement){Ne=
vb.createDocument(ef,"template",null);try{Ne.documentElement.innerHTML=Cb?"":Zd}catch(Xc){}}Zd=Ne.body||Ne.documentElement;dd&&Lc&&Zd.insertBefore(ib.createTextNode(Lc),Zd.childNodes[0]||null);return"http://www.w3.org/1999/xhtml"===ef?Pb.call(Ne,td?"html":"body")[0]:td?Ne.documentElement:Zd}function fb(dd,Lc){try{Z(Sc.removed,{attribute:Lc.getAttributeNode(dd),from:Lc})}catch(Zd){Z(Sc.removed,{attribute:null,from:Lc})}Lc.removeAttribute(dd);if("is"===dd&&!uf[dd])if(Pd||Be)try{ac(Lc)}catch(Zd){}else try{Lc.setAttribute(dd,
"")}catch(Zd){}}function ac(dd){Z(Sc.removed,{element:dd});try{dd.parentNode.removeChild(dd)}catch(Lc){try{dd.outerHTML=ld}catch(Zd){dd.remove()}}}function Dc(dd){return dd instanceof RegExp||dd instanceof Function}function Sc(dd){return D(dd)}var xb=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"undefined"===typeof window?null:window;Sc.version="2.4.1";Sc.removed=[];if(!xb||!xb.document||9!==xb.document.nodeType)return Sc.d3c=!1,Sc;var Ta=xb.document,ib=xb.document,ob=xb.DocumentFragment,
fc=xb.HTMLTemplateElement,Jb=xb.Node,xc=xb.Element,ic=xb.NodeFilter,nc=xb.NamedNodeMap,Wb=void 0===nc?xb.NamedNodeMap||xb.rWl:nc,wc=xb.HTMLFormElement,nb=xb.DOMParser,Rb=xb.trustedTypes;nc=xc.prototype;var mb=B(nc,"cloneNode"),Ub=B(nc,"nextSibling"),zc=B(nc,"childNodes"),Pc=B(nc,"parentNode");"function"===typeof fc&&(fc=ib.createElement("template"),fc.content&&fc.content.ownerDocument&&(ib=fc.content.ownerDocument));var Mc=U(Rb,Ta),ld=Mc?Mc.createHTML(""):"";fc=ib;var vb=fc.implementation,cc=fc.createNodeIterator,
Hc=fc.createDocumentFragment,Pb=fc.getElementsByTagName,Uc=Ta.importNode;fc={};try{fc=x(ib).documentMode?ib.documentMode:{}}catch(dd){}var sc={};Sc.d3c="function"===typeof Pc&&vb&&"undefined"!==typeof vb.createHTMLDocument&&9!==fc;var lb=Qa,Zb=qa,Oc=Wa,md=Hb,Ib=jc,ud=$b,od=wb,Ud=gc,Ad=null,be=v({},[].concat(m(ma),m(va),m(Ca),m(Da),m(ha))),uf=null,sd=v({},[].concat(m(Ha),m(bb),m(Na),m(Ia))),Ze=Object.seal(Object.create(null,{c2:{writable:!0,configurable:!1,enumerable:!0,value:null},O7a:{writable:!0,
configurable:!1,enumerable:!0,value:null},KJc:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ke=null,hf=null,Xa=!0,Bb=!0,mc=!1,Qc=!1,td=!1,Md=!1,Pd=!1,Be=!1,fe=!1,Mf=!0,Bd=!1,Rc=!0,Gf=!1,Nf={},Oa=null,cb=v({},"annotation-xml audio colgroup desc foreignobject head iframe math mi mn mo ms mtext noembed noframes noscript plaintext script style svg template thead title video xmp".split(" ")),Ic=null,qd=v({},"audio video img source image track".split(" ")),le=null,yb=v({},"alt class for id label name pattern placeholder role summary title value style xmlns".split(" ")),
ef="http://www.w3.org/1999/xhtml",Cb=!1,oc=null,vc=v({},["http://www.w3.org/1998/Math/MathML","http://www.w3.org/2000/svg","http://www.w3.org/1999/xhtml"],aa),nd,id=["application/xhtml+xml","text/html"],Nd,Ce=null,af=ib.createElement("form"),de=v({},["mi","mo","mn","ms","mtext"]),$f=v({},["foreignobject","desc","title","annotation-xml"]),ge=v({},["title","style","font","a","script"]),ze=v({},va);v(ze,Ca);v(ze,oa);var si=v({},Da);v(si,ta);var sh=function Zd(Lc){var Ne,Xc=tb(Lc);for(Ab("beforeSanitizeShadowDOM",
Lc,null);Ne=Xc.nextNode();)Ab("uponSanitizeShadowNode",Ne,null),ab(Ne)||(Ne.content instanceof ob&&Zd(Ne.content),Xb(Ne));Ab("afterSanitizeShadowDOM",Lc,null)};Sc.sanitize=function(Lc){var Zd=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};(Cb=!Lc)&&(Lc="\x3c!--\x3e");if("string"!==typeof Lc&&!rc(Lc)){if("function"!==typeof Lc.toString)throw Ea("toString is not a function");Lc=Lc.toString();if("string"!==typeof Lc)throw Ea("dirty is not a string, aborting");}if(!Sc.d3c){if("object"===d(xb.z6e)||
"function"===typeof xb.z6e){if("string"===typeof Lc)return xb.z6e(Lc);if(rc(Lc))return xb.z6e(Lc.outerHTML)}return Lc}Ce&&Ce===Zd||(Zd&&"object"===d(Zd)||(Zd={}),Zd=x(Zd),nd=-1===id.indexOf(Zd.BSh)?nd="text/html":nd=Zd.BSh,Nd="application/xhtml+xml"===nd?aa:fa,Ad="ALLOWED_TAGS"in Zd?v({},Zd.eWl,Nd):be,uf="ALLOWED_ATTR"in Zd?v({},Zd.cWl,Nd):sd,oc="ALLOWED_NAMESPACES"in Zd?v({},Zd.dWl,aa):vc,le="ADD_URI_SAFE_ATTR"in Zd?v(x(yb),Zd.gaf,Nd):yb,Ic="ADD_DATA_URI_TAGS"in Zd?v(x(qd),Zd.bWl,Nd):qd,Oa="FORBID_CONTENTS"in
Zd?v({},Zd.oaf,Nd):cb,Ke="FORBID_TAGS"in Zd?v({},Zd.lWl,Nd):{},hf="FORBID_ATTR"in Zd?v({},Zd.kWl,Nd):{},Nf="USE_PROFILES"in Zd?Zd.EWl:!1,Xa=!1!==Zd.gWl,Bb=!1!==Zd.hWl,mc=Zd.iWl||!1,Qc=Zd.yWl||!1,td=Zd.FWl||!1,Pd=Zd.uWl||!1,Be=Zd.vWl||!1,fe=Zd.wWl||!1,Md=Zd.mWl||!1,Mf=!1!==Zd.zWl,Bd=Zd.AWl||!1,Rc=!1!==Zd.pWl,Gf=Zd.oWl||!1,Ud=Zd.fWl||Ud,ef=Zd.sWl||"http://www.w3.org/1999/xhtml",Zd.uNa&&Dc(Zd.uNa.c2)&&(Ze.c2=Zd.uNa.c2),Zd.uNa&&Dc(Zd.uNa.O7a)&&(Ze.O7a=Zd.uNa.O7a),Zd.uNa&&"boolean"===typeof Zd.uNa.KJc&&
(Ze.KJc=Zd.uNa.KJc),Qc&&(Bb=!1),Be&&(Pd=!0),Nf&&(Ad=v({},m(ha)),uf=[],!0===Nf.html&&(v(Ad,ma),v(uf,Ha)),!0===Nf.QCl&&(v(Ad,va),v(uf,bb),v(uf,Ia)),!0===Nf.WYl&&(v(Ad,Ca),v(uf,bb),v(uf,Ia)),!0===Nf.NXl&&(v(Ad,Da),v(uf,Na),v(uf,Ia))),Zd.yRh&&(Ad===be&&(Ad=x(Ad)),v(Ad,Zd.yRh,Nd)),Zd.xRh&&(uf===sd&&(uf=x(uf)),v(uf,Zd.xRh,Nd)),Zd.gaf&&v(le,Zd.gaf,Nd),Zd.oaf&&(Oa===cb&&(Oa=x(Oa)),v(Oa,Zd.oaf,Nd)),Rc&&(Ad["#text"]=!0),td&&v(Ad,["html","head","body"]),Ad.table&&(v(Ad,["tbody"]),delete Ke.MHh),R&&R(Zd),Ce=
Zd);Sc.removed=[];"string"===typeof Lc&&(Gf=!1);if(Gf){if(Lc.nodeName&&(Zd=Nd(Lc.nodeName),!Ad[Zd]||Ke[Zd]))throw Ea("root node is forbidden and cannot be sanitized in-place");}else if(Lc instanceof Jb){var Ne=Za("\x3c!----\x3e");Zd=Ne.ownerDocument.importNode(Lc,!0);1===Zd.nodeType&&"BODY"===Zd.nodeName?Ne=Zd:"HTML"===Zd.nodeName?Ne=Zd:Ne.appendChild(Zd)}else{if(!Pd&&!Qc&&!td&&-1===Lc.indexOf("<"))return Mc&&fe?Mc.createHTML(Lc):Lc;Ne=Za(Lc);if(!Ne)return Pd?null:fe?ld:""}Ne&&Md&&ac(Ne.firstChild);
for(var Xc=tb(Gf?Lc:Ne);Zd=Xc.nextNode();)if((3!==Zd.nodeType||Zd!==lf)&&!ab(Zd)){Zd.content instanceof ob&&sh(Zd.content);Xb(Zd);var lf=Zd}if(Gf)return Lc;if(Pd){if(Be)for(lf=Hc.call(Ne.ownerDocument);Ne.firstChild;)lf.appendChild(Ne.firstChild);else lf=Ne;uf.PYl&&(lf=Uc.call(Ta,lf,!0));return lf}lf=td?Ne.outerHTML:Ne.innerHTML;td&&Ad["!doctype"]&&Ne.ownerDocument&&Ne.ownerDocument.doctype&&Ne.ownerDocument.doctype.name&&Ma(Db,Ne.ownerDocument.doctype.name)&&(lf="<!DOCTYPE "+Ne.ownerDocument.doctype.name+
">\n"+lf);Qc&&(lf=I(lf,lb," "),lf=I(lf,Zb," "),lf=I(lf,Oc," "));return Mc&&fe?Mc.createHTML(lf):lf};return Sc}var w=Object.hasOwnProperty,J=Object.setPrototypeOf,G=Object.isFrozen,M=Object.getPrototypeOf,N=Object.getOwnPropertyDescriptor,R=Object.freeze,C=Object.seal,O=Object.create,S="undefined"!==typeof Reflect&&Reflect,T=S.apply,ca=S.construct;T||(T=function(Xb,ab,Ab){return Xb.apply(ab,Ab)});R||(R=function(Xb){return Xb});C||(C=function(Xb){return Xb});ca||(ca=function(Xb,ab){return r(Xb,m(ab))});
var L=z(Array.prototype.forEach),da=z(Array.prototype.pop),Z=z(Array.prototype.push),fa=z(String.prototype.toLowerCase),aa=z(String.prototype.toString),ja=z(String.prototype.match),I=z(String.prototype.replace),sa=z(String.prototype.indexOf),ka=z(String.prototype.trim),Ma=z(RegExp.prototype.test),Ea=function(Xb){return function(){for(var ab=arguments.length,Ab=Array(ab),rc=0;rc<ab;rc++)Ab[rc]=arguments[rc];return ca(Xb,Ab)}}(TypeError),ma=R("a abbr acronym address area article aside audio b bdi bdo big blink blockquote body br button canvas caption center cite code col colgroup content data datalist dd decorator del details dfn dialog dir div dl dt element em fieldset figcaption figure font footer form h1 h2 h3 h4 h5 h6 head header hgroup hr html i img input ins kbd label legend li main map mark marquee menu menuitem meter nav nobr ol optgroup option output p picture pre progress q rp rt ruby s samp section select shadow small source spacer span strike strong style sub summary sup table tbody td template textarea tfoot th thead time tr track tt u ul var video wbr".split(" ")),
va=R("svg a altglyph altglyphdef altglyphitem animatecolor animatemotion animatetransform circle clippath defs desc ellipse filter font g glyph glyphref hkern image line lineargradient marker mask metadata mpath path pattern polygon polyline radialgradient rect stop style switch symbol text textpath title tref tspan view vkern".split(" ")),Ca=R("feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feDistantLight feFlood feFuncA feFuncB feFuncG feFuncR feGaussianBlur feImage feMerge feMergeNode feMorphology feOffset fePointLight feSpecularLighting feSpotLight feTile feTurbulence".split(" ")),
oa=R("animate color-profile cursor discard fedropshadow font-face font-face-format font-face-name font-face-src font-face-uri foreignobject hatch hatchpath mesh meshgradient meshpatch meshrow missing-glyph script set solidcolor unknown use".split(" ")),Da=R("math menclose merror mfenced mfrac mglyph mi mlabeledtr mmultiscripts mn mo mover mpadded mphantom mroot mrow ms mspace msqrt mstyle msub msup msubsup mtable mtd mtext mtr munder munderover".split(" ")),ta=R("maction maligngroup malignmark mlongdiv mscarries mscarry msgroup mstack msline msrow semantics annotation annotation-xml mprescripts none".split(" ")),
ha=R(["#text"]),Ha=R("accept action align alt autocapitalize autocomplete autopictureinpicture autoplay background bgcolor border capture cellpadding cellspacing checked cite class clear color cols colspan controls controlslist coords crossorigin datetime decoding default dir disabled disablepictureinpicture disableremoteplayback download draggable enctype enterkeyhint face for headers height hidden high href hreflang id inputmode integrity ismap kind label lang list loading loop low max maxlength media method min minlength multiple muted name nonce noshade novalidate nowrap open optimum pattern placeholder playsinline poster preload pubdate radiogroup readonly rel required rev reversed role rows rowspan spellcheck scope selected shape size sizes span srclang start src srcset step style summary tabindex title translate type usemap valign value width xmlns slot".split(" ")),
bb=R("accent-height accumulate additive alignment-baseline ascent attributename attributetype azimuth basefrequency baseline-shift begin bias by class clip clippathunits clip-path clip-rule color color-interpolation color-interpolation-filters color-profile color-rendering cx cy d dx dy diffuseconstant direction display divisor dur edgemode elevation end fill fill-opacity fill-rule filter filterunits flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight fx fy g1 g2 glyph-name glyphref gradientunits gradienttransform height href id image-rendering in in2 k k1 k2 k3 k4 kerning keypoints keysplines keytimes lang lengthadjust letter-spacing kernelmatrix kernelunitlength lighting-color local marker-end marker-mid marker-start markerheight markerunits markerwidth maskcontentunits maskunits max mask media method mode min name numoctaves offset operator opacity order orient orientation origin overflow paint-order path pathlength patterncontentunits patterntransform patternunits points preservealpha preserveaspectratio primitiveunits r rx ry radius refx refy repeatcount repeatdur restart result rotate scale seed shape-rendering specularconstant specularexponent spreadmethod startoffset stddeviation stitchtiles stop-color stop-opacity stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke stroke-width style surfacescale systemlanguage tabindex targetx targety transform transform-origin text-anchor text-decoration text-rendering textlength type u1 u2 unicode values viewbox visibility version vert-adv-y vert-origin-x vert-origin-y width word-spacing wrap writing-mode xchannelselector ychannelselector x x1 x2 xmlns y y1 y2 z zoomandpan".split(" ")),
Na=R("accent accentunder align bevelled close columnsalign columnlines columnspan denomalign depth dir display displaystyle encoding fence frame height href id largeop length linethickness lspace lquote mathbackground mathcolor mathsize mathvariant maxsize minsize movablelimits notation numalign open rowalign rowlines rowspacing rowspan rspace rquote scriptlevel scriptminsize scriptsizemultiplier selection separator separators stretchy subscriptshift supscriptshift symmetric voffset width xmlns".split(" ")),
Ia=R(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Qa=C(/\{\{[\w\W]*|[\w\W]*\}\}/gm),qa=C(/<%[\w\W]*|[\w\W]*%>/gm),Wa=C(/\${[\w\W]*}/gm),Hb=C(/^data-[\-\w.\u00B7-\uFFFF]/),jc=C(/^aria-[\-\w]+$/),gc=C(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),$b=C(/^(?:\w+script|data):/i),wb=C(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Db=C(/^html$/i);return D()})},1163:function(K,U){Object.defineProperty(U,"__esModule",{value:!0});
U.ActionRecommendationPrompt=void 0;K=U.ActionRecommendationPrompt||(U.ActionRecommendationPrompt={});K.ODSLPPT="ODSLPPT";K.TextToTableAndSmartArtPPT="TextToTableAndSmartArtPPT";K.NextSlidePPT="NextSlidePPT";K.TextGenerationForSelectedTextPPT="TextGenerationForSelectedTextPPT";K.TextGenerationForTextBoxPPT="TextGenerationForTextBoxPPT"},1164:function(K,U,d){Object.defineProperty(U,"__esModule",{value:!0});U.ActionRecommendationAnnotation=void 0;const h=d(305);class e{constructor(r){h.SchemaObject.assign(e,
this,r)}get metadata(){return this.M_}set metadata(r){this.M_=r}static getTypeName(){return"AugLoop_ActionRecommendation_ActionRecommendationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(r){return h.SchemaObject.matchesTypesFor(r,[e.getTypeName()])}}U.ActionRecommendationAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1165:function(K,U){Object.defineProperty(U,"__esModule",{value:!0});U.ActionRecommendationTrigger=void 0;K=U.ActionRecommendationTrigger||
(U.ActionRecommendationTrigger={});K.TextBoxSelection="TextBoxSelection";K.TextSelection="TextSelection"},1166:function(K,U,d){Object.defineProperty(U,"__esModule",{value:!0});U.ActionRecommendationSignal=void 0;const h=d(305);class e{constructor(r){h.SchemaObject.assign(e,this,r)}static getTypeName(){return"AugLoop_ActionRecommendation_ActionRecommendationSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(r){return h.SchemaObject.matchesTypesFor(r,[e.getTypeName()])}}
U.ActionRecommendationSignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1167:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.InsertionPoint=this.GalleryButtons=this.Title=this.SectionId=null}}Object(K.a)(h,"GallerySectionProps",null,[])},1168:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);d=d(299);class h{}h.Value="Value";h.Image16by16Class="Image16by16Class";h.Alt="Alt";h.Visible=d.a.visible;Object(K.a)(h,"LabelCommandProperties",null,[])},1182:function(K,
U,d){d.r(U);K=d(0);var h=d(392),e=d(7),r=d(1244),m=d(27),n=d(141),z=d(464),v=d(268),x=d(203),B=d(56),D=d(73),w=d(37);class J{constructor(Ta,ib,ob,fc,Jb){this.fKd=null;this.RP=!0;this.JP=null;this.Ca=Ta;this.Xh=ib;this.dDd=ob;this.P6h=fc;this.Rg=Jb;m.AFrameworkApplication.ZIc(Object(e.a)(this,this.ROl,"updateLastError"));this.P6h.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(this.RP=m.AFrameworkApplication.iF,B.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(xc=>
{xc.isFeatureEnabled("mso_sendASmile",!0).then(ic=>{this.RP=m.AFrameworkApplication.iF&&ic;this.Xh&&this.Xh.updateCommandUI();return null},()=>null)})):B.a.instance.Ia("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(xc=>{xc.Z3("Enabled").then(ic=>{this.RP=ic;return null},()=>null)})}get Rg(){this.JP||(m.AFrameworkApplication.Rg||(m.AFrameworkApplication.Rg=new z.a),this.JP=m.AFrameworkApplication.Rg);return this.JP}set Rg(Ta){this.JP=Ta}ROl(Ta,ib){void 0!==ib&&null!==ib&&
ib&&(this.fKd=ib.errorCode)}vb(){this.Ca.ya(w.a.giveFeedback,D.a.frame,Object(e.a)(this,this.Yxj,"giveFeedbackHandler"));this.Ca.ya(w.a.n7e,D.a.frame,Object(e.a)(this,this.n7e,"triggerFloodgateSurvey"));this.Xh.updateCommandUI()}n7e(Ta,ib,ob,fc,Jb){if(1===ob)return 32;if(2===ob&&!Jb)return 8;B.a.instance.Ia("Common.ISystemInitiatedFeedback").execute(xc=>{xc.logActivity(Object(r.a)(String,Jb.ActivityName),Object(r.a)(String,Jb.BRSName))});return 32}Yxj(Ta,ib,ob,fc,Jb){if(1===ob)return m.AFrameworkApplication.fa.ka("IsFeedbackExperiencesAvailable")||
(this.RP=!1),this.RP&&x.SessionStatusManager.instance.Z_?32:8;if(2===ob){h.ULS.sendTraceTag(8405838,356,50,"");this.Rg.Feedback|=v.a.k3i;const xc=Jb||{};void 0!==xc.ErrorCode&&null!==xc.ErrorCode||null==this.fKd||(xc.ErrorCode=this.fKd);m.AFrameworkApplication.fa.pSd(xc);this.dDd&&(this.dDd.instance||3===m.AFrameworkApplication.Aa.ob.zk&&1===m.AFrameworkApplication.Aa.ob.LJa||B.a.instance.qb("Common.App.CustomerFeedback.ICustomerFeedbackFormManager"),this.dDd.execute(ic=>{m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OcvFeedbackvNextModalWacEnabled",
!1)?n.UISurfaces.L9f().then(nc=>{void 0!==nc&&null!==nc?(h.ULS.sendTraceTag(8405838,356,100,"OCV vNext Modal: GiveFeedbackHandler command invoked"),ic.$7j(xc,nc)):(h.ULS.sendTraceTag(520626707,356,15,"FeedbackAPI not retrieved"),ic.wre(xc));return nc},()=>{h.ULS.sendTraceTag(520626706,356,15,"Error while retrieving feedbackAPI");ic.wre(xc);return null}):ic.wre(xc)}))}return 32}}Object(K.a)(J,"CustomerFeedbackActor",null,[1235]);class G{constructor(Ta,ib,ob){this.OVb=this.sJd=!1;this.JP=this.Adf=null;
this.V6a=Ta;this.FFc=ib;this.Rg=ob}get Rg(){this.JP||(m.AFrameworkApplication.Rg||(m.AFrameworkApplication.Rg=new z.a),this.JP=m.AFrameworkApplication.Rg);return this.JP}set Rg(Ta){this.JP=Ta}wre(Ta){this.Adf=Ta;this.Bjg()||this.odc()}$7j(Ta,ib){this.V6a.Lvl(Ta,ib)}odc(){this.sJd||(this.sJd=!0,this.FFc.p4d(Object(e.a)(this,this.Ezk,"oFeedbackJsDownloadFinished")))}Ezk(Ta){Ta?(this.OVb=!0,this.Rg.Feedback|=v.a.o3i,this.Bjg(),h.ULS.sendTraceTag(7611924,356,100,"CF - JS downloaded")):(this.Rg.Feedback|=
v.a.n3i,h.ULS.sendTraceTag(7611925,356,100,"CF - JS download failed"));this.sJd=!1}Bjg(){return this.OVb?(this.V6a.Gxl(this.Adf),!0):!1}Mtg(Ta){this.OVb=Ta}}Object(K.a)(G,"CustomerFeedbackC3FormManager",null,[1322]);var M=d(18),N=d(678),R=d(185),C=d(249),O=d(310);class S{constructor(Ta=null){this.Lof=null;this.pEc=new M.a;this.HP=Ta}p4d(Ta){S.Mcc()?this.pEc.add(Ta):this.Lof=Ta;Ta="Feedback/officebrowserfeedback_floodgate.js";N.a.Hne()&&(Ta="Feedback/latest/officebrowserfeedback_floodgate.js");var ib=
"OFeedbackIntl";m.AFrameworkApplication.fa.Lu("IsServerFlavorDebug")&&m.AFrameworkApplication.fa.ka("IsServerFlavorDebug")&&(ib+=".debug");ib+=".js";Ta=R.a.dvb(Ta);R.a.ODi(ib);ib=null;if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateDynamicCampaignEnabled",!1)){ib=[];var ob=R.a.dvb("Feedback/latest/officebrowserfeedback_ecs_client.js");ob=O.a.create(ob);ib.push(ob)}ib=O.a.create(Ta,ib,null);ib.kW(Object(e.a)(this,this.tEk,"onJsDownloadFinished"));C.a.oy(ib);
h.ULS.sendTraceTag(7611929,356,100,"CF - Downloading JS from: {0}",Ta)}zjl(Ta){this.HP?Ta&&this.HP.add(Ta):this.HP=Ta}tEk(Ta,ib){if(S.Mcc()){for(Ta=0;Ta<this.pEc.count;Ta++)this.pEc.ga(Ta)(ib.succeeded,this.HP);this.pEc.clear()}else this.Lof(ib.succeeded,this.HP)}static Mcc(){return!!m.AFrameworkApplication.Aa&&!!m.AFrameworkApplication.Aa.ob&&3===m.AFrameworkApplication.Aa.ob.zk&&1===m.AFrameworkApplication.Aa.ob.LJa}}Object(K.a)(S,"CustomerFeedbackResourceDownloadManager",null,[1321]);class T{constructor(){this.audienceGroup=
null;this.vKe=this.Ckb=0}Yqg(){return!this.vKe}}Object(K.a)(T,"OCVData",null,[]);var ca=d(120),L=d(204),da=d(97);class Z extends Sys.EventArgs{constructor(Ta){super();this.lCl=Ta}}Object(K.a)(Z,"OnFeedbackUiDismisedArgs",Sys.EventArgs,[]);var fa=d(170),aa=d(70),ja=d(202),I=d(36),sa=d(156),ka=d(269),Ma=d(478),Ea=d(47),ma=d(106),va=d(1046),Ca=d(77);class oa{constructor(Ta,ib){this.ntk="obf-MainContentHolder";this.O8j="obf-OverallSmileAnchor";this.PTl="obf-visible";this.oqa=this.ISb=oa.Jpd;this.gHd=
this.fHd=this.RP=!0;this.bjf=this.Ypb=this.QEd=this.PEd=this.MCc=this.kCc=this.yVb=!1;this.oCc=!0;this.FJd=this.jJd=this.JP=this.iid=this.IGd=this.pPd=null;this.pYh=m.AFrameworkApplication.fa.ka("FeedbackTabHandlerEnabled");this.Pd=Ta;this.Rg=ib;this.Ma=new Ca.a;if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)){const xc=this;B.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(nc=>
{nc.isFeatureEnabled("mso_sendASmile",xc.RP).then(Wb=>{xc.RP=Wb;return null},()=>null);nc.isFeatureEnabled("FloodgateSurvey",xc.MCc).then(Wb=>{xc.MCc=Wb;xc.QEd=!0;return null},()=>null)});const ic=this;B.a.instance.Ia("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(nc=>{nc.Z3("IncludeScreenshot").then(Wb=>{ic.yVb=Wb;return null},()=>null);nc.Z3("IncludeEmail").then(Wb=>{ic.kCc=Wb;ic.PEd=!0;return null},()=>null)})}else{const xc=this;B.a.instance.Ia("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(ic=>
{ic.Z3("Enabled").then(nc=>{xc.RP=nc;return null},()=>null);ic.Z3("IncludeScreenshot").then(nc=>{xc.yVb=nc;return null},()=>null);ic.Z3("IncludeEmail").then(nc=>{xc.kCc=nc;xc.PEd=!0;return null},()=>null);ic.Z3("SurveyEnabled").then(nc=>{xc.MCc=nc;xc.QEd=!0;return null},()=>null)})}if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForUpsell",!0)){this.Ypb=m.AFrameworkApplication.fa.ka("PremiumUpsellIsEnabled");const xc=this;B.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(ic=>
{xc.Ypb=ic.isFreemiumUpsellEnabled();ic.isFeatureEnabled("mso_sendASmile",!1).then(nc=>{xc.bjf=nc;return null},()=>null)})}const ob=this;B.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(xc=>{xc.isFeatureEnabled("FeedbackForum",ob.oCc).then(ic=>{ob.oCc=ic;return null},()=>null)});const fc=this;B.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(xc=>{xc.isFeatureEnabled("FeedbackComplianceCannotConsent",fc.fHd).then(ic=>{fc.fHd=
ic;return null},()=>null)});const Jb=this;B.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(xc=>{xc.isFeatureEnabled("FeedbackComplianceCannotPartialConsent",Jb.gHd).then(ic=>{Jb.gHd=ic;return null},()=>null)});N.a.Hne()?(this.pPd=R.a.dvb("Feedback/latest/officebrowserfeedback.css"),this.IGd=R.a.$Zd("Feedback/latest/Intl/")):(this.pPd=R.a.dvb("Feedback/officebrowserfeedback.css"),this.IGd=R.a.$Zd("Feedback/Intl/"))}get Rg(){this.JP||(m.AFrameworkApplication.Rg||
(m.AFrameworkApplication.Rg=new z.a),this.JP=m.AFrameworkApplication.Rg);return this.JP}set Rg(Ta){this.JP=Ta}get Gre(){return this.jJd||(this.jJd=document.getElementById(this.O8j))}get Efd(){return this.FJd||(this.FJd=document.getElementById(this.ntk))}ygi(Ta){this.Ma.addHandler(oa.o9g,Ta)}KAi(){this.FJd=this.jJd=null}YVj(Ta){return!!Ta&&0<=Ta.className.toLowerCase().indexOf(this.PTl.toLowerCase())}Lvl(Ta,ib){if(!m.AFrameworkApplication.iF)h.ULS.sendTraceTag(37856257,356,15,"ShowFeedbackButton is false, but ShowUi got called, some feedback entry point is still visible");
else if(this.RP)if(h.ULS.sendTraceTag(508952780,356,50,"Feedback api retrieved"),m.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.delayFeedbackForPolicies"))this.iSi(()=>{this.zJk(Ta,ib)});else{h.ULS.sendTraceTag(520626705,356,50,"Feedback api retrieved");const ob=Ta||{};this.getContext(ob);ib.initializeFeedbackModal(ob,Object(e.a)(this,this.onDismiss,"onDismiss"),Object(e.a)(this,this.onError,"onError"));h.ULS.sendTraceTag(7948385,356,50,"Successfully opened feedback form and set focus.");
this.Rg.Feedback|=v.a.Q6d}}zJk(Ta,ib){this.oqa=this.clearInterval(this.oqa);Ta=Ta||{};this.getContext(Ta);ib.initializeFeedbackModal(Ta,Object(e.a)(this,this.onDismiss,"onDismiss"),Object(e.a)(this,this.onError,"onError"));h.ULS.sendTraceTag(508952779,356,50,"Successfully opened feedback form and set focus.");this.Rg.Feedback|=v.a.Q6d}iSi(Ta){let ib=300;this.oqa=this.clearInterval(this.oqa);this.oqa=window.setInterval(()=>{this.WCf()&&Ta();ib*=2;1E4<ib&&(Ta(),h.ULS.sendTraceTag(508952778,356,10,"Failed to retrieve correct OCPS policies due to timeout"))},
ib)}Gxl(Ta){if(!m.AFrameworkApplication.iF)h.ULS.sendTraceTag(520626704,356,15,"ShowFeedbackButton is false, but ShowUi got called, some feedback entry point is still visible");else if(this.RP){Ta=Ta||{};this.getContext(Ta);var ib=oa.ETi(Ta.AppMode||"Unknown");va.a.init(Object(e.a)(this,this.onDismiss,"onDismiss"),Object(e.a)(this,this.onError,"onError"),356,ib,Ta);this.SNj();oa.allowKeytips(!1);h.ULS.sendTraceTag(520488648,356,50,"Successfully opened feedback form and set focus.");this.Rg.Feedback|=
v.a.Q6d}}$3i(Ta,ib){ib&&2>=ib.Ckb?((ib=m.AFrameworkApplication.fa.Ha("UserPrincipalName"))&&0<ib.length&&(Ta.userEmail=ib),Ta.userEmailConsentDefault=!0):Ta.userEmail=""}S3f(Ta){const ib={};if(void 0!==Ta.appData&&null!==Ta.appData){var ob=Ta.appData;for(var fc in ob)ib[fc]=ob[fc]}ib.App=Ta.Application||"";ib.AppMode=Ta.AppMode||"";ib.AppModeExt=Ta.ApplicationMode||"";ib.Host=Ta.Host||"";ib.Language=Ta.locale;ib.IsError=Ta.Error||!1;ib.IsCrash=Ta.Crash||!1;ib.ServerDocId=Ta.ServerDocId||"";Ta.ErrorCode&&
""!==Ta.ErrorCode.toString()&&(ib.IsError=!0);"Origin"in Ta&&(ib.Origin=Ta.Origin);ib.ClientThrottlingProtection=this.Rg.ClientThrottlingProtection||"";ib.HostServiceLevel=this.Rg.HostServiceLevel||"";ib.RequestedCallThrottling=this.Rg.RequestedCallThrottling||"";ib.WacServiceLevel=this.Rg.WacServiceLevel||"";this.Rg.HostResponseStats&&(ob=this.Rg.HostResponseStats.Label)&&(ib.HostFarmHint=ob);ob=m.AFrameworkApplication.fa;(fc=ob.Ha(m.AFrameworkApplication.wK))&&""!==fc&&(ib.UiHost=fc);(fc=ob.Ha(m.AFrameworkApplication.PLh))&&
""!==fc&&(ib.UiHostIntegrationType=fc);ob.ka("OcvFeedbackIncludesSessionOriginIsEnabled")&&(ob=Ta.SessionOrigin,ob&&""!==ob||(Ta=Ta.SourceControlId)&&""!==Ta&&sa.a(sa.d(Ta),"feedback")&&(ob=this.E5f().SessionOrigin),ob&&""!==ob&&(ib.SessionOrigin=ob));Ta=null;try{Ta=I.c(ib),Ta=Ea.a.Ada(Ta,Ea.a.eCb)}catch(Jb){Ta="",h.ULS.sendTraceTag(520644571,356,10,"Exception trying to serialize appData: {0}",Jb.message)}return{["appData"]:Ta||""}}Fej(Ta){const ib={};for(let ob in Ta)ib[ob]=Ta[ob];ib.IsFreemiumUpsellEnabled=
this.Ypb;ib.IsAadcEnabled=this.bjf;ib.IsFeedbackEnabled=this.RP;return ib}Iej(){let Ta=null;try{const ib=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.WebSurfacesSettings",null);ib&&(Ta=I.b(ib))}catch(ib){h.ULS.sendTraceTag(543520794,356,10,"Could not deserialize WebSurfacesSettingsJson")}return Ta||{}}jdj(Ta,ib){Ta.clientFeedbackId||(Ta.clientFeedbackId=ma.a.create().toString());if(Ta&&ib){Ta.LanguageID?Ta.locale=ka.a.He(Ta.LanguageID).name||"":Ta.ApplicationLCID&&
(Ta.locale=Ta.ApplicationLCID);Ta.applicationGroup=this.S3f(Ta);Ta.applicationSettings=this.Fej(m.AFrameworkApplication.fa.appSettings);Ta.webSurfacesSettings=this.Iej();Ta.userfactConfig=oa.nwj();oa.gTf(ib,Ta);Ta.appId=oa.JTi();Ta.environment=ib.vKe;Ta.stylesUrl=this.pPd;Ta.intlUrl=this.IGd;Ta.rtl=m.AFrameworkApplication.fa.ka("Rtl")?"rtl":"ltr";var ob=oa.ITi();Ta.primaryColour=ob.primaryColour;Ta.secondaryColour=ob.secondaryColour;Ta.sessionId=Ta.SessionID||Ta.WACSessionID||"";Ta.build=Ta.ApplicationVersion||
Ta.WFEVersion||"";ob=Ta.FlightIDs?Ta.FlightIDs.toString():Ta.Flights?Ta.Flights.toString():"";var fc="";Ta.ErrorCode&&(fc=Ta.ErrorCode.toString());var Jb=this.Tnj(Ta),xc=ib.Yqg()?m.AFrameworkApplication.fa.Ha("TenantId"):"";xc&&"0"!==xc||(xc="");var ic=m.AFrameworkApplication.fa.Ha("LoggableUserIdSpace"),nc=m.AFrameworkApplication.fa.Ha("LoggableUserId")||"";switch(ic){case "MsaPuid":nc="p:"+nc;break;case "MsaCid":nc="m:"+nc;break;case "OrgIdPuid":nc="a:"+(m.AFrameworkApplication.fa.Ha("AADUserObjectId")||
nc);break;default:h.ULS.sendTraceTag(575415951,356,50,"Unknown LoggableUserIdSpace. LoggableUserId: {0}, LoggableUserIdSpace: {1}",nc,ic),nc=""}ic={};if(void 0!==Ta.telemetryGroup&&null!==Ta.telemetryGroup){const Wb=Ta.telemetryGroup;for(let wc in Wb)ic[wc]=Wb[wc]}ic.audienceGroup=ib.audienceGroup;ic.audience=ib.audienceGroup;ic.flights=ob;ic.platform=Jb;ic.ringId=ib.Ckb;ic.officeUILang=m.AFrameworkApplication.lcid;ic.errorCode=fc;ic.loggableUserId=nc;ic.processSessionId=Ta.SessionID||Ta.WACSessionID||
"";ic.officeBuild=Ta.ApplicationVersion||Ta.WFEVersion||"";0<xc.length&&"84df9e7f-e9f6-40af-b435-aaaaaaaaaaaa"!==xc&&(ic.tenantId=xc);Ta.telemetryGroup=ic;Ta.webGroup={["browser"]:Ta.Browser||"",["browserVersion"]:(Ta.BrowserMajorVersion||"")+"."+(Ta.BrowserMinorVersion||""),["dataCenter"]:Ta.Datacenter||Ta.WACDatacenter||""};Ta.isCommercialHost=m.AFrameworkApplication.fa.ka("IsO365CommercialHost");this.CTi(Ta);Ta.disableIncludeScreenshot=!this.yVb;Ta.screenshot=this.yVb;Ta.showEmailAddress=this.kCc;
Ta.emailPolicyValue=this.kCc?1:0;Ta.screenshotPolicyValue=this.yVb?1:0;m.AFrameworkApplication.fa.ka("IsO365CommercialHost")||(Ta.disableIncludeScreenshot=!1,Ta.showEmailAddress=!0,Ta.screenshot=!0);m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1)&&(Ta.surveyEnabled=this.MCc,m.AFrameworkApplication.fa.ka("IsO365ConsumerHost")&&(Ta.showEmailAddress=!0,Ta.surveyEnabled=!0));this.$3i(Ta,ib);this.iid=Ta.DismissHandler?Ta.DismissHandler:
null;this.ATi(Ta)}}WCf(){return this.PEd&&this.QEd}getContext(Ta){Ta=Ta||this.E5f();const ib=new T;this.jdj(Ta,ib);return Ta}Tnj(Ta){let ib="";Ta.Platform&&(ib=Ta.Platform.toString());Ta.PlatformMajorVersion&&(0<ib.length&&(ib+=" "),ib+=Ta.PlatformMajorVersion.toString()+".");Ta.PlatformMinorVersion&&(ib+=Ta.PlatformMinorVersion.toString());return ib}vAl(Ta){Ta.ApplicationMode&&(Ta.AppMode=Ta.ApplicationMode);Ta.ApplicationModeExtended&&(Ta.ApplicationMode=Ta.ApplicationModeExtended)}E5f(){let Ta;
try{Ta=I.b(m.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),this.vAl(Ta)}catch(ib){h.ULS.sendTraceTag(36794389,356,10,"Could not deserialize SessionStartInfoJson"),Ta={}}return Ta}onError(Ta){Ta=Ma.a.Oyb(Ta);h.ULS.sendTraceTag(37259477,356,10,"FB submit error: {0}",Ta);this.Rg.Feedback|=v.a.m3i;oa.allowKeytips(!0)}QVi(){if(oa.Npg()){h.ULS.sendTraceTag(40112215,356,50,oa.w6g);var Ta=B.a.instance.resolve("Common.ISystemInitiatedFeedback");Ta&&Ta.logActivity("AppUsageNPSLocalizationTest",
null)}}onDismiss(Ta){this.Qoa();this.KAi();fa.a.HIb()&&h.ULS.sendTraceTag(34936718,356,50,"FB dismiss");fa.a.uWa()&&da.c(Ta?w.a.j3i:w.a.e3i,!0,null,2,8);Ta?(fa.a.HIb()&&h.ULS.sendTraceTag(34936719,356,15,"FB submit"),this.Rg.Feedback|=v.a.p3i):(this.Rg.Feedback|=v.a.l3i,this.QVi());this.Ma.raiseEvent(oa.o9g,new Z(Ta));oa.allowKeytips(!0);this.iid&&(this.iid(),this.iid=null)}SNj(){if(this.Pd){let Ta=!1,ib=5,ob=!1;this.oqa=this.clearInterval(this.oqa);this.ISb=this.clearInterval(this.ISb);this.ISb=
window.setInterval(()=>{if(this.Gre){ob=!0;var fc=this.Pd.Fc(oa.i9a);fc.uJ=!0;fc.parent=ca.AFrame.Xi;fc.o7a(oa.LQi);fc.f8(()=>{let Jb=this.Pd.EQ(oa.i9a),xc=null,ic=5,nc=!1;this.oqa=window.setInterval(()=>{this.YVj(this.Efd)&&(nc=!0,this.Gre.focus(),Jb||(Jb=this.Pd.EQ(oa.i9a)),Jb&&!xc&&(xc=Jb.Dj),xc&&xc.mF(this.Gre));ic--;if(nc||!ic)this.oqa=this.clearInterval(this.oqa)},1E3)});Ta||(this.Pd.XU(oa.i9a,!0),Ta=!0);this.pYh&&this.Efd&&(fc=new L.DOMFocusListing(()=>this.Efd),fc.Ro(1),fc.Ro(2),fc.Ro(3),
fc.Ro(5),fc=this.Pd.zja(()=>this.Efd,this.Pd.Fc(oa.i9a),fc),fc.Xjb(),fc.uX=!0,fc.QRa=!0,fc.D4g())}ib--;if(ob||!ib)this.ISb=this.clearInterval(this.ISb)},1E3)}}clearInterval(Ta){Ta!==oa.Jpd&&(window.clearInterval(Ta),Ta=oa.Jpd);return Ta}Qoa(){this.Pd&&(this.Pd.q1(oa.i9a),this.Pd.YLb(oa.i9a))}ATi(Ta){this.fHd?this.gHd||(Ta.ageGroup=4):Ta.ageGroup=3;m.AFrameworkApplication.fa.ka("IsAnonymousUser")?Ta.authenticationType=2:Ta.authenticationType="aad"===m.AFrameworkApplication.fa.Ha("HostAuthType")?1:
0}CTi(Ta){this.oCc&&(Ta.myFeedbackForumUrl="https://go.microsoft.com/fwlink/?linkid=2171883",Ta.MyFeedbackPortalUrl="https://go.microsoft.com/fwlink/?linkid=2171883");if(this.oCc){const ib=oa.DTi();void 0!==ib&&null!==ib&&(Ta.feedbackPortalUrl=ib,Ta.feedbackForumUrl=ib)}}static allowKeytips(Ta){m.AFrameworkApplication.Aa.ob.Pp&&aa.a("allowKeytips")&&appChrome.api.allowKeytips(Ta)}static EYi(){return m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSendUserFacts",
!1)}static FYi(){return m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableTargetedMessagingServiceFactRequest",!1)}static PUi(){let Ta=null;try{const ib=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.DisabledUserFacts","");ib&&""!==ib&&(Ta=ib.split(","))}catch(ib){h.ULS.sendTraceTag(509104515,356,10,"Could not parse DisabledUserFacts")}return Ta||[]}static nwj(){const Ta={};Ta.enableSendUserFacts=oa.EYi();Ta.enableTargetedMessagingServiceFactRequest=
oa.FYi();Ta.disabledUserFacts=oa.PUi();Ta.userFactRules=oa.VOi();return Ta}static VOi(){const Ta={};Ta.ExcelWebLastUsed=va.a.bee("ExcelWebLastUsed");Ta.PowerPointWebLastUsed=va.a.bee("PowerPointWebLastUsed");Ta.WordWebLastUsed=va.a.bee("WordWebLastUsed");return Ta}static gTf(Ta,ib){if(ib){Ta.Ckb=parseInt(ib.Ring);if(isNaN(Ta.Ckb))Ta.audienceGroup="Unknown",Ta.Ckb=-2;else switch(Ta.Ckb){case 0:case 1:Ta.audienceGroup="Dogfood";break;case 2:Ta.audienceGroup="Microsoft";break;case 3:case 4:case 5:case 6:Ta.audienceGroup=
"Production";break;default:Ta.audienceGroup="Unknown"}var ob=!0;ib.Host&&(ob="MsInternal"!==ib.Host&&"Blue Chicken"!==ib.Host);Ta.vKe=ob?0:1}}static JTi(){let Ta=0;switch(ja.Redirect.application){case 2:Ta=2155;break;case 4:Ta=2158;break;case 3:Ta=2157;break;case 1:Ta=2156;break;case 5:Ta=2159;break;default:h.ULS.sendTraceTag(34723679,356,10,"Unexpected Application: {0}",ja.Redirect.application.toString())}return Ta}static ITi(){const Ta={};let ib="#2B579A",ob="#3C65A4";switch(ja.Redirect.application){case 2:m.AFrameworkApplication.fa&&
m.AFrameworkApplication.fa.ka("AppColorUpdateIsEnabled")?(ib="#185ABD",ob="#2E6AC5"):(ib="#2B579A",ob="#3C65A4");break;case 4:ib="#7719AA";ob="#9953C0";break;case 3:ib="#B7472A";ob="#C75033";break;case 1:ib="#217346";ob="#3F8159";break;case 5:ib="#3955A3";ob="#4D6AB8";break;default:h.ULS.sendTraceTag(36230303,356,10,"Unexpected Application: {0}",ja.Redirect.application.toString())}Ta.primaryColour=ib;Ta.secondaryColour=ob;return Ta}static DTi(){let Ta=null;switch(ja.Redirect.application){case 2:Ta=
"https://go.microsoft.com/fwlink/?linkid=2170869&clcid=0x409";break;case 4:Ta="https://go.microsoft.com/fwlink/?linkid=2172997&clcid=0x409";break;case 3:Ta="https://go.microsoft.com/fwlink/?linkid=2171000&clcid=0x409";break;case 1:Ta="https://go.microsoft.com/fwlink/?linkid=2170798&clcid=0x409";break;case 5:Ta="https://go.microsoft.com/fwlink/?linkid=2173231&clcid=0x409";break;default:h.ULS.sendTraceTag(540577997,356,10,"Unexpected Application: {0}",ja.Redirect.application.toString())}return Ta}static ETi(Ta){let ib=
356;switch(ja.Redirect.application){case 2:switch(Ta){case "Edit":ib=364;break;case "View":case "Attendee":case "Presenter":ib=363;break;default:h.ULS.sendTraceTag(7652195,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Word Online View Mode",m.AFrameworkApplication.Aa.SZa),ib=363}break;case 4:ib=362;break;case 3:switch(Ta){case "Edit":ib=361;break;case "View":case "Attendee":case "Presenter":case "Outline":case "":ib=360;break;default:h.ULS.sendTraceTag(7652224,356,15,"Unexpected ModeName: {0}. Setting ULSCat to PowerPoint Online View Mode",
m.AFrameworkApplication.Aa.SZa),ib=360}break;case 1:switch(Ta){case "Edit":ib=358;break;case "View":ib=357;break;case "Survey":ib=359;break;default:h.ULS.sendTraceTag(7652225,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Excel Online View Mode",m.AFrameworkApplication.Aa.SZa),ib=357}break;case 5:switch(Ta){case "View":ib=373;break;case "Edit":ib=374;break;default:h.ULS.sendTraceTag(18158298,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Visio Online View Mode",m.AFrameworkApplication.Aa.SZa),
ib=373}break;default:h.ULS.sendTraceTag(7652226,356,10,"Unexpected Application: {0}",ja.Redirect.application.toString())}return ib}static LQi(){h.ULS.sendTraceTag(38572302,356,50,"CustomerFeedbackScope is disposed")}static Npg(){if(!oa.kKe){const Ta=!!m.AFrameworkApplication.fa&&m.AFrameworkApplication.fa.ka(oa.w6g);oa.kKe=Ta?2:1}return 2===oa.kKe}}oa.i9a="CustomerFeedbackFocusId";oa.o9g="FUID";oa.Jpd=-1;oa.kKe=0;oa.w6g="NPSLocalizationTestingIsEnabled";Object(K.a)(oa,"CustomerFeedbackUiWrapper",
null,[1319]);var Da=d(15),ta=d(1245),ha=d(1246);class Ha{constructor(Ta,ib,ob,fc){this.rcf=Ta;this.zha=ib;this.qcf=ob;this.j3h=fc}activityName(){return this.zha}object(){return this.j3h}}Object(K.a)(Ha,"OneCallBackData",null,[]);class bb{constructor(Ta,ib,ob,fc){this.UNa=[];Array.add(this.UNa,new Ha(Ta,ib,ob,fc))}add(Ta){Ta&&Array.addRange(this.UNa,Ta.UNa)}MAi(){Array.clear(this.UNa)}}Object(K.a)(bb,"CallBackData",null,[]);var Na=d(541);class Ia extends Na.a{constructor(Ta,ib,ob=null,fc=!1,Jb=!1,
xc=null,ic=null,nc=null){super("FloodgateTeachingCallout");this.image=this.footer=this.message=this.smallHeadline=this.title=null;this.positionImageAtLeft=!1;this.secondaryButtonProps=this.primaryButtonProps=null;this.footer=Ta;this.message=ib;this.image=ob;this.positionImageAtLeft=fc;this.smallHeadline=Jb;this.title=xc;this.primaryButtonProps=ic;this.secondaryButtonProps=nc}}Object(K.a)(Ia,"FloodgateCalloutContent",Na.a,[]);class Qa{constructor(){this.props=this.options=null}}Object(K.a)(Qa,"Notification",
null,[]);var qa=d(1150),Wa=d(944),Hb=d(356);class jc extends Na.a{constructor(Ta,ib,ob=null,fc=null){super("PremiumUpsellCallout");this.imageHeight=this.imageProps=this.content=this.title=null;this.title=Ta;this.content=ib;this.imageProps=ob;this.imageHeight=fc}}Object(K.a)(jc,"PremiumUpsellCalloutContentProps",Na.a,[]);var gc=d(945),$b=d(943);class wb{static P_d(Ta){return wb.Yoj().then(ib=>{try{const ob=[];for(let fc=0;fc<Ta.length;fc++){const Jb=Ta[fc],xc=wb.c4j(Jb.surfaceType),ic=new Qa;ic.options=
wb.Amj(Jb,!xc);ic.props=xc?ib.callout(wb.Btk(Ta[fc])):ib.externalNotification();ob.push(ic)}return wb.Vvl(ib,ob)}catch(ob){throw Error.create("Failed to convert and show teaching UX using WAC notifications: "+ob.message);}})}static c4j(Ta){switch(Ta.toLowerCase()){case "teaching":case "coachmark":case "sequence":case "premiumupsell":return!0;default:return!1}}static Amj(Ta,ib){const ob=new Hb.a;ib&&(ob.onShow=Ta.onUnsupportedSurfaceType);ob.telemetryId="FloodgateTeachingUx-Surface"+(ib?"NotSupported":
"Supported");return ob}static Btk(Ta){var ib="premiumupsell"!==Ta.surfaceType.toLowerCase()?new Ia(Ta.footer,Ta.description,Ta.illustrationImage?Object.assign(new $b.a(Ta.illustrationImage),{ariaLabel:Ta.imageAriaLabel}):null,"left"===Ta.position,Ta.smallHeadline,Ta.title,wb.mUc(Ta.primaryButtonText,Ta.primaryButtonAction),wb.mUc(Ta.secondaryButtonText,Ta.secondaryButtonAction)):new jc(Ta.title,Ta.description,Ta.illustrationImage?Object.assign(new $b.a(Ta.illustrationImage),{ariaLabel:Ta.imageAriaLabel}):
null);ib=Object.assign(new Wa.a,{target:Ta.selector,content:ib,showCloseIcon:null!=Ta.hasCloseButton?Ta.hasCloseButton:!0,preventLightDismiss:null!=Ta.preventAutoDismiss?Ta.preventAutoDismiss:!1,useTeachingStyles:!0,calloutProps:Object.assign(new gc.a,{onDismiss:ob=>{if(Ta.onClosed)if(ob)Ta.onClosed("close");else Ta.onClosed("auto dismiss")},directionalHint:Ta.anchorHint,setInitialFocus:!0})});"coachmark"===Ta.surfaceType.toLowerCase()?(ib.hasDynamicSizing=!1,ib.useCoachmark=!0,ib.calloutProps.setInitialFocus=
!1):"premiumupsell"===Ta.surfaceType.toLowerCase()&&(ib.primaryButtonProps=wb.mUc(Ta.primaryButtonText,Ta.primaryButtonAction),ib.secondaryButtonProps=wb.mUc(Ta.secondaryButtonText,Ta.secondaryButtonAction),ib.showCloseIcon=!1,ib.useTeachingStyles=!1,ib.calloutProps.preventDismissOnLostFocus=!1);return ib}static mUc(Ta,ib){return Ta&&""!==Ta&&ib?Object.assign(new qa.a,{label:Ta,onExecute:ib}):(h.ULS.shipAssertTag(594569111,356,(!Ta||""===Ta)&&!ib,"A callout button needs both a caption and an action."),
null)}static Yoj(){wb.bTc||(m.AFrameworkApplication.Aa.ob.bWa&&m.AFrameworkApplication.fa.ka("WacFloodgateNotificationsIntegrationIsEnabled")?wb.bTc=n.UISurfaces.FL().then(Ta=>{const ib=new Ia(null,null);if(Ta.isCustomContentSupported&&Ta.isCustomContentSupported(ib))return Ta;throw Error.create("Custom Content not supported: "+ib.type);},Ta=>{h.ULS.sendTraceTag(593352343,383,15,"Failed to GetNotificationsAPIAsync: {0}",Ta);return null}):wb.bTc=Promise.reject("React Notifications not enabled"));return wb.bTc}static Vvl(Ta,
ib){if(!ib||!ib.length)return[];const ob=[];for(let fc=0;fc<ib.length;fc++){const Jb=wb.Gwl(Ta,ib[fc]);ob.push(Jb)}return ob}static Gwl(Ta,ib){const ob=Ta.addNotification(ib.props,ib.options);return()=>{Ta.removeNotification(ob)}}}wb.bTc=null;Object(K.a)(wb,"FloodgateNotifications",null,[]);class Db{static pal(){return m.AFrameworkApplication.fa.ka("IsO365ConsumerHost")?new Promise(Ta=>{B.a.instance.Ia("Common.App.OAuth.IOAuthManager").execute(ib=>{if(ib&&ib.mmg()){var ob=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.PersonalizationOAuthUri",
Db.KRi);ib.gI("Tulips",ob).then(fc=>{fc&&fc.IsSuccess?(h.ULS.sendTraceTag(508905242,356,50,"PersonalizationAuthManager got auth token"),Ta(fc.Token)):(h.ULS.sendTraceTag(508905241,356,15,"PersonalizationAuthManager Error - "+(fc?fc.ErrorMessage:"")),Ta(null));return null})}else h.ULS.sendTraceTag(508905243,356,15,"PersonalizationAuthManager oauthManager not valid"),Ta(null)})}):Promise.resolve(null)}}Db.KRi="https://attributes.engagement.office.com/UserFacts.Read";Object(K.a)(Db,"PersonalizationAuthManager",
null,[]);const Xb=(Ta,ib)=>{Ta=m.AFrameworkApplication.fa.Ha("UserPrincipalName");if(ib=!!ib.M6g&&2===ib.M6g.Ckb)ib=(ib=Ta.toLowerCase())?0<ib.indexOf("linkedin.com")||0<ib.indexOf("linkedin.biz"):!1;return ib};class ab{constructor(Ta,ib){this.M6g=Ta;this.context=ib}}Object(K.a)(ab,"SurveyMetadata",null,[]);var Ab=d(67),rc=d(270),tb=d(93),Za=d(82);class fb{constructor(Ta){this.JVa=this.isInitialized=!1;this.Yja=this.kob=null;this.d3a=!1;this.J4e=null;this.Ung=!1;this.vPc=0;this.$Rf=-1;this.yPe=this.uPc=
null;this.$Ua=!0;this.rQ=Ta;this.Xvc={};this.EDf=!1;this.wMb=this.na=null;this.aTc=0}oPj(Ta){this.isInitialized&&this.kob||this.JVa?h.ULS.sendTraceTag(595142230,356,10,"SIFB: InitializeWACAppParameters called too late, its already initialized or in err state."):null===Ta?h.ULS.sendTraceTag(595142229,356,15,"SIFB: InitializeWACAppParameters was passed null param"):(this.d3a=Ta.d3a,h.ULS.sendTraceTag(595142228,356,10,"SIFB: GetAppSpecificFeedbackData returned null"))}ePj(){const Ta=this.rQ.getContext(null),
ib=new T;oa.gTf(ib,Ta);this.J4e=new ab(ib,Ta);this.wMb=new Da.ScriptSharpLegacyMap;this.wMb.$("LinkedInWACUsage",Xb)}get etb(){this.kob||(this.kob=B.a.instance.qb("Common.App.IAppSpecificFeedbackData"));return this.kob}logActivity(Ta,ib,ob=null){Ta&&this.q$a(Ta,fb.xhb,ib)&&(this.isInitialized?(h.ULS.sendTraceTag(37754499,356,50,"SIFB: LogActivity "+Ta),va.a.logActivity(Ta,ob)):(h.ULS.sendTraceTag(37754500,356,50,"SIFB: LogActivity (initializing first) "+Ta),this.eie(new bb(va.a.logActivity,Ta,null,
ob))))}gse(Ta){try{m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogTriggerActivityName",!1)&&h.ULS.sendTraceTag(520140175,356,50,"Trigger Activity Name: "+Ta),-1===this.$Rf&&(this.$Rf=m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.DeferredActivityDelayInMilliSeconds",fb.DRf)),this.uPc||(this.uPc=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateDeferredActivityAllowedList"," ").toString().toLowerCase()),
!m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowAllTriggerActivities",!0)&&this.uPc&&Ta&&Ta.startsWith("Ribbon_")&&-1===this.uPc.indexOf(Ta.toLowerCase())?h.ULS.sendTraceTag(527247310,356,100,"SIFB: LogActivityDeferred activity ignored"):this.isInitialized?(0<this.vPc&&m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClearNearActivityTimeouts",!1)&&(window.clearTimeout(this.vPc),h.ULS.sendTraceTag(592217693,356,50,"SIFB: LogActivityDeferred cancelled "+
Ta)),this.vPc=window.setTimeout(()=>{this.vPc=0;this.logActivity(Ta,null)},fb.DRf)):h.ULS.sendTraceTag(592217692,356,50,"SIFB: LogActivityDeferred called before initialization "+Ta)}catch(ib){h.ULS.sendTraceTag(527247311,356,10,"SIFB: LogActivityDeferred activity failed: "+(ib?ib.toString():""))}}sdc(Ta,ib){Ta&&this.q$a(Ta,fb.xhb,ib)&&(this.Pvg(Ta,ib),this.Xvc[Ta]=ib)}Pvg(Ta,ib){this.q$a(Ta,fb.xhb,ib)&&(this.isInitialized?(h.ULS.sendTraceTag(37754501,356,50,"SIFB: LogActivityStartInternal "+Ta),va.a.sdc(Ta,
null)):(h.ULS.sendTraceTag(37754502,356,50,"SIFB: LogActivityStartInternal (initializing first) "+Ta),this.eie(new bb(va.a.sdc,Ta,null,null))))}Nvg(Ta){Ta&&this.isInitialized&&this.q$a(Ta,fb.xhb,void 0)&&(Ta in this.Xvc&&delete this.Xvc[Ta],this.Ovg(Ta,void 0))}Ovg(Ta,ib){this.isInitialized&&this.q$a(Ta,fb.xhb,ib)&&(h.ULS.sendTraceTag(37754503,356,50,"SIFB: LogActivityEndInternal "+Ta),va.a.Nvg(Ta))}Ulb(Ta,ib){if(this.q$a(Ta,fb.xhb,ib))if(this.etb){if(ib=this.etb.cee(Ta))this.isInitialized?(h.ULS.sendTraceTag(38605911,
356,50,"SIFB:ShowUserInitiatedSurvey "+Ta),va.a.Ulb(ib)):(h.ULS.sendTraceTag(38605912,356,50,"SIFB:ShowUserInitiatedSurvey (initializing first) "+Ta),this.eie(new bb(null,null,va.a.Ulb,ib)))}else h.ULS.sendTraceTag(556896919,356,10,"AppSpecificFeedbackData is null")}q$a(Ta,ib,ob){if(this.JVa)return!1;if(!m.AFrameworkApplication.iF)return h.ULS.sendTraceTag(37601796,356,50,"SIFB: All feedback/floodgate is disabled"),!1;if(!this.TWj())return!1;this.GJi();return(this.KVj(Ta)||this.xQi(Ta)||this.lSj(Ta))&&
this.yqi(ib,ob)&&this.OCl(Ta)}GJi(){if(!this.kob){const Ta=B.a.instance.qb("Common.App.IAppSpecificFeedbackData");Ta?this.kob=Ta:h.ULS.sendTraceTag(589641477,356,10,"SIFB.Error:IAppSpecificFeedbackData not found in the container")}}UWj(Ta){return 6!==Ta}TWj(){if(0===this.aTc){const Ta=this.rQ.getContext(null);this.aTc=this.UWj(parseInt(Ta.Ring))?1:2;2===this.aTc&&h.ULS.sendTraceTag(50389538,356,15,"SIFB: floodgate disabled in this environment")}return 1===this.aTc}OCl(Ta){null===this.wMb&&this.ePj();
return Ta&&this.wMb&&this.wMb.Fb(Ta)?this.wMb.ga(Ta)(Ta,this.J4e):!0}zej(){if(!this.Yja&&!this.EDf){this.EDf=!0;const Ta=this.rQ.getContext(null);this.Yja="locale"in Ta?Ta.locale:"";this.Yja=this.Yja.toLowerCase()}return this.Yja}xQi(Ta){this.Yja||(this.Yja=this.zej());if(!(this.Yja&&this.Yja.length&&Ta&&Ta.length))return!1;let ib="en-us"===this.Yja||this.b_j(Ta)||oa.Npg();!ib&&this.RZj(Ta)&&(ib=this.SZj(this.Yja));return ib}RZj(Ta){return this.etb?"AppUsageNPS"===Ta||"AppUsageTimeSatisfiedNPS"===
Ta||"SuiteUsageNPS"===Ta||"SuiteUsageTimeSatisfiedNPS"===Ta:(h.ULS.sendTraceTag(593769179,356,10,"SIFB:IsNPSActivity AppSpecificFeedbackData was null. activityName: "+Ta),!1)}KVj(Ta){return!!Ta&&-1!==Ta.toLowerCase().indexOf("floodgateflight")}b_j(Ta){return!!Ta&&-1!==Ta.toLowerCase().indexOf("nlqs")}SZj(Ta){if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAllNpsLanguages",!1))return!0;if(!Ta||!Ta.length)return!1;if(!m.AFrameworkApplication.fa.ka("WacNPSLocalizedLanguagesEnabled"))return"en-us"===
Ta;let ib=!1;switch(Ta){case "en-us":case "es-es":case "ja-jp":case "en-gb":case "pt-br":case "nl-nl":case "de-de":case "fr-fr":case "sv-se":case "fi-fi":case "nb-no":case "da-dk":case "ru-ru":case "es-mx":case "pl-pl":case "zh-cn":case "zh-tw":case "it-it":case "ko-kr":ib=!0}return ib}yqi(Ta,ib){return m.AFrameworkApplication.fa.ka(Ta)?ib&&!m.AFrameworkApplication.fa.ka(ib)?(h.ULS.sendTraceTag(36767233,356,50,"SIFB: FC BRS("+ib+") is off"),!1):!0:(h.ULS.sendTraceTag(36546386,356,50,"SIFB: Main SIF BRS("+
Ta+") is off"),!1)}lSj(Ta){const ib=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.AllowedCampaignActivities","ShowFirstRunExperienceUIV2");return!!Ta&&!!ib&&-1!==ib.toLowerCase().indexOf(Ta.toLowerCase())}eie(Ta){if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1))m.AFrameworkApplication.fa.ff(()=>{try{this.HQc(Ta)}catch(ib){h.ULS.sendTraceTag(50357646,356,10,"SIFB.Error:Download and initialize failed "+
ib)}});else try{this.HQc(Ta)}catch(ib){h.ULS.sendTraceTag(574997505,356,10,"SIFB.Error:Download and initialize failed "+ib)}}qnc(){this.d3a||this.start()}fJk(){this.d3a||this.stop()}A3e(){this.d3a&&this.start()}vBl(){this.d3a&&this.stop()}start(){h.ULS.sendTraceTag(37623952,356,100,"SIFB: Start called "+this.isInitialized);if(this.isInitialized)if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateDelayStart",!1)){const Ta=Za.a.FOc(m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateAfterIdleCallbackDelayMs",
10),Object(e.a)(this,this.$Eh,"startSurvey"),m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateDelayStartIdleOverrideMs",1E3));m.AFrameworkApplication.Ae.Hb(Ta)}else this.$Eh(null)}$Eh(){va.a.M6i();this.aGl()}stop(){h.ULS.sendTraceTag(37623953,356,100,"SIFB: Stop called "+this.isInitialized);this.isInitialized&&(this.$Fl(),va.a.N6i())}aGl(){const Ta=this.Xvc;for(let ib in Ta)this.Pvg(ib,Ta[ib])}$Fl(){const Ta=this.Xvc;for(let ib in Ta)this.Ovg(ib,Ta[ib])}HQc(Ta){h.ULS.sendTraceTag(36546388,
356,100,"SIFB: Entered DownloadResources");var ib=B.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager");ib&&(ib.OVb?this.r1f(!0,Ta):(ib=B.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"),ib.zjl(Ta),ib.p4d(Object(e.a)(this,this.r1f,"floodgateJsDownloadFinished"))))}r1f(Ta,ib){h.ULS.sendTraceTag(36546389,356,100,"SIFB: Entered FloodgateJsDownloadFinished. succeeded is "+Ta);let ob="";ib&&ib.UNa&&0<ib.UNa.length&&(ob=ib.UNa[0].activityName());
if(Ta)if(N.a.Hne())if(this.isInitialized)this.a4d(ib);else{if(this.JVa||!this.yPe)this.yPe=this.ogh();this.yPe.then(()=>{this.a4d(ib)}).catch(fc=>this.pgh(ob,fc))}else this.ogh().then(()=>{this.a4d(ib)}).catch(fc=>this.pgh(ob,fc));else this.JVa=!0,h.ULS.sendTraceTag(36546391,356,10,"SIFB Error:JS download failed. Activity name "+ob)}pgh(Ta,ib){this.JVa=!0;h.ULS.sendTraceTag(36546390,356,10,"SIFB Error: in post download init. Activity name "+Ta+". "+ib.toString())}O6i(Ta){this.na||this.kPj();let ib=
Ta;Ta&&0<Ta.length&&(ib=this.na&&this.na.Fb(Ta)?this.na.ga(Ta):Ta);return ib?ib:""}ogh(){var Ta=B.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager");Ta&&Ta.Mtg(!0);this.jql();this.Kpl();this.initOptions();if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)&&m.AFrameworkApplication.fa.ka("IsO365ConsumerHost"))return this.$$i().then(ib=>{this.ose(ib);return ib}).then(ib=>va.a.The(Object(e.a)(this,
this.UMe,"onSIFeedbackDismiss"),Object(e.a)(this.rQ,this.rQ.onError,"onError"),ib,Object(e.a)(this.rQ,this.rQ.onDismiss,"onDismiss")));if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1)&&m.AFrameworkApplication.fa.ka("IsO365CommercialHost")&&m.AFrameworkApplication.fa.ka("OcpsIsEnabled"))return fb.fSi(this.h8f()).then(()=>{const ib=this.j9d();this.ose(ib);return ib}).then(ib=>va.a.The(Object(e.a)(this,this.UMe,"onSIFeedbackDismiss"),
Object(e.a)(this.rQ,this.rQ.onError,"onError"),ib,Object(e.a)(this.rQ,this.rQ.onDismiss,"onDismiss")));Ta=this.j9d();this.ose(Ta);return va.a.The(Object(e.a)(this,this.UMe,"onSIFeedbackDismiss"),Object(e.a)(this.rQ,this.rQ.onError,"onError"),Ta,Object(e.a)(this.rQ,this.rQ.onDismiss,"onDismiss"))}$$i(){return new Promise(Ta=>{B.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(ib=>{const ob=this.j9d();ib.isFeatureEnabled("FloodgateSurvey",!0).then(fc=>{ob.surveyEnabled=
"surveyEnabled"in ob?fc&&ob.surveyEnabled:fc;Ta(ob);return null},fc=>{h.ULS.sendTraceTag(555857947,356,15,"GetAllContextForFloodgatePromise Error {0}",fc.toString());Ta(ob);return null})})})}Hej(){let Ta=null;try{const ib=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.MessagingServiceSettings",null);ib&&(Ta=I.b(ib))}catch(ib){h.ULS.sendTraceTag(540285072,356,10,"Could not deserialize MessagingServiceSettingsJson")}return Ta||{}}j9d(){const Ta=this.rQ.getContext(null);
Ta.FloodgateUIAutoDismissTimeEnum=this.Oaj();Ta.uIStringGetter=Object(e.a)(this,this.O6i,"floodgateUIStringGetter");Ta.authTokenCallback=fb.NJi(Object(r.a)(String,Ta.AudienceGroup));Ta.augLoopCallback=fb.LJi();Ta.onTeachingCampaignRender=fb.P_d;Ta.governanceServiceEnabled=fb.A7f();Ta.governanceServiceConfig=fb.Shj();Ta.personalizerEnabled=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePersonalizerEnabled",!1);Ta.messagingServiceSettings=this.Hej();Ta.isPriorityEnabled=
fb.woj();Ta.enableWebCampaignGovernance=fb.IYi();return Ta}ose(Ta){const ib=this.rQ.WCf(),ob=this.h8f(),fc=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1),Jb=m.AFrameworkApplication.fa.ka("IsO365CommercialHost"),xc=m.AFrameworkApplication.fa.ka("IsO365ConsumerHost"),ic=m.AFrameworkApplication.fa.ka("OcpsIsEnabled"),nc="surveyEnabled"in Ta?Ta.surveyEnabled:"null or undefined",Wb="showEmailAddress"in Ta?Ta.showEmailAddress:"null or undefined",
wc=fb.A7f(),nb=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePersonalizerEnabled",!1);h.ULS.sendTraceTag(575947136,356,50,'"Info": "SIFB Info: Floodgate SDK will init.", "OcpsPoliciesSet": "{0}", "FGAdminControlsEnabled": "{1}", "IsO365CommercialHost": "{2}", "IsO365ConsumerHost": "{3}", "OcpsIsEnabled": "{4}", "FGInitDelayTime": "{5}", "ShowEmailAddress": "{6}", "surveyEnabled": "{7}", "governanceServiceEnabled": "{8}", "governanceServiceConfig": "{9}", "personalizerEnabled": "{10}"',
ib,fc,Jb,xc,ic,ob,Wb,nc,wc,I.c(Ta.governanceServiceConfig),nb)}Oaj(){return Xb(null,this.J4e)?(h.ULS.sendTraceTag(593278928,356,50,"SIFB Info:LinkedIn - Floodgate AutoDismissTimeEnum:0"),0):m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgatePromptAutoDismissEnum",m.AFrameworkApplication.fa.wc("FloodgateUIAutoDismissTimeEnum",2))}h8f(){return m.AFrameworkApplication.fa.wc("FloodgateContextAndInitDelayInMilliSeconds",fb.LRi)}a4d(Ta){this.isInitialized=!0;this.Mei();
va.a.ekl(Object(e.a)(this,this.qdk,"logTriggerEvent"));if(Ta){for(const ib of Ta.UNa)ib.rcf?(0,ib.rcf)(ib.activityName(),ib.object()):ib.qcf?(0,ib.qcf)(ib.object()):h.ULS.sendTraceTag(38605913,356,10,"SIFB Error:callerData callback actions were null");Ta.MAi()}else h.ULS.sendTraceTag(37623954,356,10,"SIFB Error:callerData was null");try{const ib=this.rQ.getContext(null),ob=va.a.h7f(Array.isArray(ib.Flights)?ib.Flights:null),fc=ob?Object(r.a)(String,ob.SelfTriggerActivity):null;if(fc)for(const Jb of fc.split(";"))Jb&&
""!==Jb&&this.logActivity(Jb,null)}catch(ib){h.ULS.sendTraceTag(51131788,356,10,"SIFB Error:error posting webactivities "+(ib?ib.toString():""))}}Mei(){if(!this.Ung&&window.addEventListener){const Ta=Object(e.a)(this,this.cJk,"onWebCampaignEvent");window.addEventListener("FGWebSurfaceEvent",Ta,!0);this.Ung=!0}}Wvg(Ta,ib){Ta&&m.AFrameworkApplication.dma(Ta);h.ULS.sendTraceTag(50704975,306,50,"Web Campaign UI launched. "+ib)}YUj(Ta){if(!Ta)return!1;try{const ib=(m.AFrameworkApplication.fa.Ha("FlightId")||
"").toLocaleLowerCase(),ob=Ta.toString().toLocaleLowerCase().split(";");for(const fc of ob)if(2<fc.length&&(fc.lastIndexOf("-control")===fc.length-8||fc.lastIndexOf("cf")===fc.length-2&&-1!==ib.indexOf(fc)))return!0}catch(ib){h.ULS.sendTraceTag(512505555,306,50,"Error serializing campaign event -"+(ib?ib.toString():""))}return!1}qdk(Ta,ib){ib=ib||{};if(Ta){var ob=fb.Y$d(Ta);ob&&(ib.flightId=ob);"isControl"in ib||(ob=this.YUj(Ta))&&(ib.isControl=ob)}this.Wvg(Ta,JSON.stringify(ib))}cJk(Ta){if(Ta=Ta?
Ta.detail:null){var ib=!m.AFrameworkApplication.fa.ka("WacFloodgateNotificationsIntegrationIsEnabled"),ob=(Ta.action||"").toLowerCase();switch(ob){case "dismissed":ib&&rc.a.instance.Eo("obf-DynamicWebSurfaces");break;case "updated":ib&&va.a.Ura("obf-DynamicWebSurfaces");break;case "opened":case "":ob=Ta.telemetryEventName;let fc;try{fc=JSON.stringify(Ta)}catch(Jb){fc="id : "+Ta.id+" telemetryEventName: "+ob,h.ULS.sendTraceTag(51131789,306,50,"Error serializing campaign event. "+fc+" Error: "+(Jb?
Jb.toString():""))}Ta.success?this.Wvg(ob,fc):h.ULS.sendTraceTag(50422098,306,10,"Error launching Web Campaign UI."+fc);Ta.isHidden||Ta.isAA||!ib||va.a.Ura("obf-DynamicWebSurfaces");break;default:h.ULS.sendTraceTag(594626399,306,50,"Unrecognized action "+ob)}}}N5k(Ta){if(!Ta)return null;try{const ib=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateDisabledCampaigns","").toLowerCase();if(!ib||""===ib)return Ta;const ob=I.b(Ta),fc=new M.a;let Jb=0;for(const xc of ob){const ic=
xc.CampaignId;ic&&-1!==ib.indexOf(ic.toLowerCase())?(h.ULS.sendTraceTag(509167254,356,50,"Ignoring disabled campaign -"+ic),Jb++):fc.add(xc)}return Jb?I.c(fc.toArray()):Ta}catch(ib){return h.ULS.sendTraceTag(509167253,356,10,"Error filtering out disabled campaigns"),Ta}}WIl(Ta){var ib=["Live"];if(!Ta)return null;try{const ob=I.b(Ta),fc=new M.a;for(const Jb of ob){const xc=Jb.Tags;if(xc)for(const ic of ib)Array.contains(xc,ic)&&fc.add(Jb)}return I.c(fc.toArray())}catch(ob){return h.ULS.sendTraceTag(523904348,
356,10,"Could not deserialize CampaignDefinitionsJson"),null}}jql(){let Ta=!1,ib=null;const ob=this.kab();if(ob&&this.etb)try{let fc=this.etb.Lbj();m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.FilterOfficeLiveSurvey",!1)&&m.AFrameworkApplication.G9&&(fc=this.WIl(fc));m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FilterDisabledCampaigns",!0)&&(fc=this.N5k(fc));fc?(ob.setItem(fb.Awi,fc),Ta=!0):(ib="SIFB.campaign str was null",h.ULS.sendTraceTag(594143442,
356,10,ib))}catch(fc){ib="SIFB.Floodgate surveys !available. Exception writing to localStorage:SetupCampaigns: "+fc,h.ULS.sendTraceTag(594143441,356,50,ib)}else this.etb?(ib="SIFB.Floodgate surveys !available. Campaign !set.Storage.Local was null",h.ULS.sendTraceTag(594143440,356,50,ib)):(ib="SIFB.Floodgate surveys not available. App Specific Feedback data was null",h.ULS.sendTraceTag(556896920,356,50,ib));h.ULS.sendTraceTag(37856258,356,50,"SIFB:Exiting SetupCampaigns "+Ta+" errorString: "+(ib?ib:
"null"))}UMe(Ta,ib){fa.a.HIb()&&h.ULS.sendTraceTag(36546397,356,50,"SIFB.Floodgate dismissed, submitted:{0}, campaingId:{1}",ib,Ta);fa.a.uWa()&&da.c(ib?w.a.cSl:w.a.bSl,!0,null,2,8);rc.a.instance.Eo(va.a.q1f)}initOptions(){}Kpl(){this.d3a||(tb.a.addHandler(window.self,Ab.a.focus,Object(e.a)(this,this.qnc,"onWindowFocus")),tb.a.addHandler(window.self,Ab.a.blur,Object(e.a)(this,this.fJk,"onWindowBlur")))}kab(){if(!this.$Ua)return null;let Ta=null;try{Ta=localStorage}catch(ib){this.$Ua=!1,Ta=null,h.ULS.sendTraceTag(594052320,
356,50,"SIFB.GetLocalStorage error "+(ib?ib.toString():""))}return Ta}kPj(){h.ULS.sendTraceTag(39077269,356,50,"inside InitializeUIStringGetter");try{this.na=new ta.a(ha.a.Ml()),this.na.$("nps_Title",CommonUIStrings.l_WAC_NPS_Title),this.na.$("nps_PromptQuestion",CommonUIStrings.l_WAC_NPS_PromptQuestion),this.na.$("nps_RatingQuestion",CommonUIStrings.l_WAC_NPS_RatingQuestion),this.na.$("nps_RatingQuestion_Word",fb.sdg()),this.na.$("nps_RatingQuestion_OneNote",fb.oxj()),this.na.$("nps_OneClickPromptQuestion_PPT",
CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion_PPT),this.na.$("nps_OneClickPromptQuestion_Excel",CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion_Excel),this.na.$("nps_OneClickRatingQuestion_Excel",fb.qdg()),this.na.$("nps_OneClickRatingQuestion_PowerPoint",fb.rdg()),this.na.$("nps_RatingQuestion_PowerPoint",fb.rdg()),this.na.$("nps_RatingQuestion_Excel",fb.qdg()),this.na.$("nps_RatingQuestion_Visio",CommonUIStrings.l_WAC_NPS_RatingQuestion_Visio),this.na.$("nps_Rating_Values_1",CommonUIStrings.l_WAC_NPS_Rating_Values_1),
this.na.$("nps_Rating_Values_2",CommonUIStrings.l_WAC_NPS_Rating_Values_2),this.na.$("nps_Rating_Values_3",CommonUIStrings.l_WAC_NPS_Rating_Values_3),this.na.$("nps_Rating_Values_4",CommonUIStrings.l_WAC_NPS_Rating_Values_4),this.na.$("nps_Rating_Values_5",CommonUIStrings.l_WAC_NPS_Rating_Values_5),this.na.$("nps_QuestionQuestion",CommonUIStrings.l_WAC_NPS_Rating_QuestionQuestion),this.na.$("nps_OneClickPromptQuestion",CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion),this.na.$("nps_OneClickRatingQuestion_Word",
fb.sdg()),this.na.$("nps_OneClickRating_Values_1",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_1),this.na.$("nps_OneClickRating_Values_2",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_2),this.na.$("nps_OneClickRating_Values_3",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_3),this.na.$("nps_OneClickRating_Values_4",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_4),this.na.$("nps_OneClickRating_Values_5",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_5),this.na.$("nps_Suite_RatingQuestion",
"How likely are you to recommend Microsoft 365 to others, if asked?"),this.na.$("nps_Suite_QuestionQuestion","Please tell us more. Why did you choose that answer?"),this.na.$("NSVPromptTitle",CommonUIStrings.l_Excel_NSV_Prompt),this.na.$("NSVTimedSurvey_Question",CommonUIStrings.l_Excel_NSV_Overview_Question),this.na.$("SatisfactionRating_1",CommonUIStrings.l_Excel_Rating_1_Satisfied),this.na.$("SatisfactionRating_2",CommonUIStrings.l_Excel_Rating_2_Satisfied),this.na.$("SatisfactionRating_3",CommonUIStrings.l_Excel_Rating_3_Satisfied),
this.na.$("SatisfactionRating_4",CommonUIStrings.l_Excel_Rating_4_Satisfied),this.na.$("SatisfactionRating_5",CommonUIStrings.l_Excel_Rating_5_Satisfied),this.na.$("NSV_Timed_Feedback_Freeform_Question",CommonUIStrings.l_Excel_NSV_Timed_Feedback_Freeform_Question),this.na.$("NSV_Prompt_Title_Feedback",CommonUIStrings.l_Title_For_NSV_Floodgate_Prompt),this.na.$("NSVDidntCreateSheetViewQuestion",CommonUIStrings.l_NSV_Didnt_Create_NSV_Survey_Question),this.na.$("NSVDidntCreateNSVOption_1",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_1),
this.na.$("NSVDidntCreateNSVOption_2",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_2),this.na.$("NSVDidntCreateNSVOption_3",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_3),this.na.$("NSVDidntCreateNSVOption_4",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_4),this.na.$("NSVFreeformDidntCreateSheetView",CommonUIStrings.l_NSV_Freeform_Reason_Didnt_Create_SheetView),this.na.$("NSVDidntCreatePrompt",CommonUIStrings.l_NSV_Didnt_Create_SheetView_Prompt),this.na.$("NSVPromptQuestion",CommonUIStrings.l_NSV_PromptQuestion),
this.na.$("CatchUpFPS_Title",CommonUIStrings.l_WAC_CatchUpFPS_Title),this.na.$("CatchUpFPS_Question",CommonUIStrings.l_WAC_CatchUpFPS_Question),this.na.$("CatchUpFPS_YesLabel",CommonUIStrings.l_WAC_CatchUpFPS_YesLabel),this.na.$("CatchUpFPS_NoLabel",CommonUIStrings.l_WAC_CatchUpFPS_NoLabel),this.na.$("CatchUpFPS_RatingQuestion",CommonUIStrings.l_WAC_CatchUpFPS_RatingQuestion),this.na.$("CatchUpFPS_RatingValue_1",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_1),this.na.$("CatchUpFPS_RatingValue_2",
CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_2),this.na.$("CatchUpFPS_RatingValue_3",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_3),this.na.$("CatchUpFPS_RatingValue_4",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_4),this.na.$("CatchUpFPS_RatingValue_5",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_5),this.na.$("CatchUpFPS_WhyQuestion",CommonUIStrings.l_WAC_CatchUpFPS_WhyQuestion),this.na.$("ReviewMode_FloodgatePromptTitle",CommonUIStrings.l_WAC_ReviewMode_FloodgatePromptTitle),this.na.$("ReviewMode_FloodgatePromptQuestion",
CommonUIStrings.l_WAC_ReviewMode_FloodgatePromptQuestion),this.na.$("ReviewMode_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_ReviewMode_FloodgatePrompt_YesLabel),this.na.$("ReviewMode_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_ReviewMode_FloodgatePrompt_NoLabel),this.na.$("ReviewMode_FloodgateRatingQuestion",CommonUIStrings.l_WAC_ReviewMode_FloodgateRatingQuestion),this.na.$("ReviewMode_FloodgateRating_1",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_1),this.na.$("ReviewMode_FloodgateRating_2",
CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_2),this.na.$("ReviewMode_FloodgateRating_3",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_3),this.na.$("ReviewMode_FloodgateRating_4",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_4),this.na.$("ReviewMode_FloodgateRating_5",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_5),this.na.$("ReviewMode_FloodgateQuestion",CommonUIStrings.l_WAC_ReviewMode_FloodgateQuestion),this.na.$("collab_RatingQuestion_Visio",CommonUIStrings.l_Visio_Collab_RatingQuestion),
this.na.$("collab_Title_Visio",CommonUIStrings.l_Visio_Collab_Title),this.na.$("collab_Prompt_Question_Visio",CommonUIStrings.l_Visio_Collab_Prompt_Question),this.na.$("collab_Rating_Values_1",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_1),this.na.$("collab_Rating_Values_2",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_2),this.na.$("collab_Rating_Values_3",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_3),this.na.$("collab_Rating_Values_4",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_4),
this.na.$("collab_Rating_Values_5",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_5),this.na.$("collab_Question_Visio",CommonUIStrings.l_Visio_Collab_Question),this.na.$("connector_campaign_Survey_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Survey_Question),this.na.$("connector_campaign_Title",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Title),this.na.$("connector_campaign_Prompt_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Prompt_Question),this.na.$("connector_campaign_Rating_Values_1",
CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_1),this.na.$("connector_campaign_Rating_Values_2",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_2),this.na.$("connector_campaign_Rating_Values_3",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_3),this.na.$("connector_campaign_Rating_Values_4",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_4),this.na.$("connector_campaign_Rating_Values_5",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_5),this.na.$("connector_campaign_Verbatim_Question",
CommonUIStrings.l_VisioWeb_ConnectorCampaign_Verbatim_Question),this.na.$("WordFollowUpFeelingsFPS_PromptTitle",CommonUIStrings.l_WordFollowUpFeelingsFPS_PromptTitle),this.na.$("WordFollowUpFeelingsFPS_PromptQuestion",CommonUIStrings.l_WordFollowUpFeelingsFPS_PromptQuestion),this.na.$("WordFollowUpFeelingsFPS_Prompt_YesLabel",CommonUIStrings.l_WordFollowUpFeelingsFPS_Prompt_YesLabel),this.na.$("WordFollowUpFeelingsFPS_Prompt_NoLabel",CommonUIStrings.l_WordFollowUpFeelingsFPS_Prompt_NoLabel),this.na.$("WordFollowUpFeelingsFPS_RatingQuestion",
CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingQuestion),this.na.$("WordFollowUpFeelingsFPS_RatingValue_1",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_1),this.na.$("WordFollowUpFeelingsFPS_RatingValue_2",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_2),this.na.$("WordFollowUpFeelingsFPS_RatingValue_3",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_3),this.na.$("WordFollowUpFeelingsFPS_RatingValue_4",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_4),this.na.$("WordFollowUpFeelingsFPS_RatingValue_5",
CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_5),this.na.$("WordFollowUpFeelingsFPS_WhyQuestion",CommonUIStrings.l_WordFollowUpFeelingsFPS_WhyQuestion),this.na.$("DictationV2_Title",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_Title),this.na.$("DictationV2_GreetingQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingQuestion),this.na.$("DictationV2_GreetingAnswer_Sure",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingAnswer_Sure),this.na.$("DictationV2_GreetingAnswer_Notnow",
CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingAnswer_Notnow),this.na.$("DictationV2_RatingQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingQuestion),this.na.$("DictationV2_RatingAnswer_1",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_1),this.na.$("DictationV2_RatingAnswer_2",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_2),this.na.$("DictationV2_RatingAnswer_3",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_3),this.na.$("DictationV2_RatingAnswer_4",
CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_4),this.na.$("DictationV2_RatingAnswer_5",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_5),this.na.$("DictationV2_PromptQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_PromptQuestion),this.na.$("OfficeScriptsFPS_Title",CommonUIStrings.l_WAC_OfficeScriptsFPS_Title),this.na.$("OfficeScriptsFPS_Question",CommonUIStrings.l_WAC_OfficeScriptsFPS_Question),this.na.$("OfficeScriptsFPS_YesLabel",CommonUIStrings.l_WAC_OfficeScriptsFPS_YesLabel),
this.na.$("OfficeScriptsFPS_NoLabel",CommonUIStrings.l_WAC_OfficeScriptsFPS_NoLabel),this.na.$("OfficeScriptsFPS_RatingQuestion",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingQuestion),this.na.$("OfficeScriptsFPS_RatingValue_1",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_1),this.na.$("OfficeScriptsFPS_RatingValue_2",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_2),this.na.$("OfficeScriptsFPS_RatingValue_3",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_3),this.na.$("OfficeScriptsFPS_RatingValue_4",
CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_4),this.na.$("OfficeScriptsFPS_RatingValue_5",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_5),this.na.$("OfficeScriptsFPS_WhyQuestion",CommonUIStrings.l_WAC_OfficeScriptsFPS_WhyQuestion),this.na.$("ExcelAddins_Prompt",CommonUIStrings.l_Excel_Addins_Prompt),this.na.$("ExcelAddins_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("ExcelAddins_Rating_Question",CommonUIStrings.l_Excel_Addins_Rating_Question),this.na.$("ExcelAddins_QuestionQuestion",
CommonUIStrings.l_Excel_Addins_QuestionQuestion),this.na.$("ExcelAddins_Rating_1_Expectations",CommonUIStrings.l_Excel_Addins_Choice_1),this.na.$("ExcelAddins_Rating_2_Expectations",CommonUIStrings.l_Excel_Addins_Choice_2),this.na.$("ExcelAddins_Rating_3_Expectations",CommonUIStrings.l_Excel_Addins_Choice_3),this.na.$("ExcelAddins_Rating_4_Expectations",CommonUIStrings.l_Excel_Addins_Choice_4),this.na.$("ExcelAddins_Rating_5_Expectations",CommonUIStrings.l_Excel_Addins_Choice_5),this.na.$("ExcelIdeas_Prompt",
CommonUIStrings.l_Excel_Ideas_Prompt),this.na.$("ExcelIdeas_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("ExcelIdeas_Rating_Question",CommonUIStrings.l_Excel_Ideas_Rating_Question),this.na.$("ExcelIdeas_ExpectationsQuestion",CommonUIStrings.l_Excel_Ideas_ExpectationsQuestion),this.na.$("ExcelIdeas_Rating_1_Expectations",CommonUIStrings.l_Excel_Rating_1_Expectations),this.na.$("ExcelIdeas_Rating_2_Expectations",CommonUIStrings.l_Excel_Rating_2_Expectations),this.na.$("ExcelIdeas_Rating_3_Expectations",
CommonUIStrings.l_Excel_Rating_3_Expectations),this.na.$("ExcelIdeas_Rating_4_Expectations",CommonUIStrings.l_Excel_Rating_4_Expectations),this.na.$("ExcelIdeas_Rating_5_Expectations",CommonUIStrings.l_Excel_Rating_5_Expectations),this.na.$("ExcelRecommendedCharts_Prompt",CommonUIStrings.l_Excel_RecommendedCharts_Prompt),this.na.$("ExcelRecommendedCharts_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("ExcelRecommendedCharts_Rating_Question",CommonUIStrings.l_Excel_RecommendedCharts_Rating_Question),
this.na.$("ExcelRecommendedCharts_WhyQuestion",CommonUIStrings.l_Excel_RecommendedCharts_WhyQuestion),this.na.$("ExcelRecommendedCharts_Rating_1_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_1_Satisfied),this.na.$("ExcelRecommendedCharts_Rating_2_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_2_Satisfied),this.na.$("ExcelRecommendedCharts_Rating_3_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_3_Satisfied),this.na.$("ExcelRecommendedCharts_Rating_4_Satisfied",
CommonUIStrings.l_ExcelRecommendedCharts_Rating_4_Satisfied),this.na.$("ExcelRecommendedCharts_Rating_5_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_5_Satisfied),this.na.$("ExcelRecommendedPivotTable_Prompt",CommonUIStrings.l_Excel_RecommendedPivotTable_Prompt),this.na.$("ExcelRecommendedPivotTable_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("ExcelRecommendedPivotTable_Rating_Question",CommonUIStrings.l_Excel_RecommendedPivotTable_Rating_Question),this.na.$("ExcelRecommendedPivotTable_ExpectationsQuestion",
CommonUIStrings.l_Excel_RecommendedPivotTable_ExpectationsQuestion),this.na.$("ExcelRecommendedPivotTable_Rating_1_Expectations",CommonUIStrings.l_Excel_Rating_1_Expectations),this.na.$("ExcelRecommendedPivotTable_Rating_2_Expectations",CommonUIStrings.l_Excel_Rating_2_Expectations),this.na.$("ExcelRecommendedPivotTable_Rating_3_Expectations",CommonUIStrings.l_Excel_Rating_3_Expectations),this.na.$("ExcelRecommendedPivotTable_Rating_4_Expectations",CommonUIStrings.l_Excel_Rating_4_Expectations),this.na.$("ExcelRecommendedPivotTable_Rating_5_Expectations",
CommonUIStrings.l_Excel_Rating_5_Expectations),this.na.$("Download_as_Image_Rating_Question",CommonUIStrings.l_Visio_Download_As_Image_Rating_Question),this.na.$("Download_as_Image_Title",CommonUIStrings.l_Visio_Download_As_Image_Title),this.na.$("Download_as_Image_Prompt_Question",CommonUIStrings.l_Visio_FPS_Prompt_Question),this.na.$("Download_as_Image_Rating_Values_1",CommonUIStrings.l_Visio_FPS_Rating_Values_1),this.na.$("Download_as_Image_Rating_Values_2",CommonUIStrings.l_Visio_FPS_Rating_Values_2),
this.na.$("Download_as_Image_Rating_Values_3",CommonUIStrings.l_Visio_FPS_Rating_Values_3),this.na.$("Download_as_Image_Rating_Values_4",CommonUIStrings.l_Visio_FPS_Rating_Values_4),this.na.$("Download_as_Image_Rating_Values_5",CommonUIStrings.l_Visio_FPS_Rating_Values_5),this.na.$("Download_as_Image_Question",CommonUIStrings.l_Visio_FPS_General_Question),this.na.$("TextPredictions_FloodgatePromptTitle",CommonUIStrings.l_WAC_TextPredictions_FloodgatePromptTitle),this.na.$("TextPredictions_FloodgatePromptQuestion",
CommonUIStrings.l_WAC_TextPredictions_FloodgatePromptQuestion),this.na.$("TextPredictions_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_TextPredictions_FloodgatePrompt_YesLabel),this.na.$("TextPredictions_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_TextPredictions_FloodgatePrompt_NoLabel),this.na.$("TextPredictions_FloodgateRatingQuestion",CommonUIStrings.l_WAC_TextPredictions_FloodgateRatingQuestion),this.na.$("TextPredictions_FloodgateRating_1",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_1),
this.na.$("TextPredictions_FloodgateRating_2",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_2),this.na.$("TextPredictions_FloodgateRating_3",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_3),this.na.$("TextPredictions_FloodgateRating_4",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_4),this.na.$("TextPredictions_FloodgateRating_5",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_5),this.na.$("TextPredictions_FloodgateQuestion",CommonUIStrings.l_WAC_TextPredictions_FloodgateQuestion),
this.na.$("SoftwareITDiagrams_Title",CommonUIStrings.l_Visio_SoftwareITDiagrams_Title),this.na.$("SoftwareITDiagrams_Survey_Question",CommonUIStrings.l_VisioWeb_SoftwareITDiagrams_Survey_Question),this.na.$("SoftwareITDiagrams_Prompt_Question",CommonUIStrings.l_Visio_FPS_Prompt_Question1),this.na.$("SoftwareITDiagrams_Rating_Values_1",CommonUIStrings.l_Visio_FPS_Rating_Values_1a),this.na.$("SoftwareITDiagrams_Rating_Values_2",CommonUIStrings.l_Visio_FPS_Rating_Values_2),this.na.$("SoftwareITDiagrams_Rating_Values_3",
CommonUIStrings.l_Visio_FPS_Rating_Values_3),this.na.$("SoftwareITDiagrams_Rating_Values_4",CommonUIStrings.l_Visio_FPS_Rating_Values_4),this.na.$("SoftwareITDiagrams_Rating_Values_5",CommonUIStrings.l_Visio_FPS_Rating_Values_5),this.na.$("SofwareITDiagrams_Question",CommonUIStrings.l_Visio_FPS_General_Question),this.na.$("ExternalContent_FloodgatePromptTitle",CommonUIStrings.l_WAC_ExternalContent_FloodgatePromptTitle),this.na.$("ExternalContent_FloodgatePromptQuestion",CommonUIStrings.l_WAC_ExternalContent_FloodgatePromptQuestion),
this.na.$("ExternalContent_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_ExternalContent_FloodgatePrompt_YesLabel),this.na.$("ExternalContent_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_ExternalContent_FloodgatePrompt_NoLabel),this.na.$("ExternalContent_FloodgateRatingQuestion",CommonUIStrings.l_WAC_ExternalContent_FloodgateRatingQuestion),this.na.$("ExternalContent_FloodgateRating_1",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_1),this.na.$("ExternalContent_FloodgateRating_2",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_2),
this.na.$("ExternalContent_FloodgateRating_3",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_3),this.na.$("ExternalContent_FloodgateRating_4",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_4),this.na.$("ExternalContent_FloodgateRating_5",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_5),this.na.$("ExternalContent_FloodgateQuestion",CommonUIStrings.l_WAC_ExternalContent_FloodgateQuestion),this.na.$("Translator_GreetingQuestion",CommonUIStrings.l_Word_Translator_Floodgate_GreetingQuestion),
this.na.$("Translator_PromptTitle",CommonUIStrings.l_Word_Translator_Floodgate_PromptTitle),this.na.$("Translator_GreetingAnswer_NotNow",CommonUIStrings.l_Word_Translator_Floodgate_GreetingAnswer_NotNow),this.na.$("Translator_GreetingAnswer_Sure",CommonUIStrings.l_Word_Translator_Floodgate_GreetingAnswer_Sure),this.na.$("Translator_RatingQuestion",CommonUIStrings.l_Word_Translator_Floodgate_RatingQuestion),this.na.$("Translator_RatingValue_1",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_1),
this.na.$("Translator_RatingValue_2",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_2),this.na.$("Translator_RatingValue_3",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_3),this.na.$("Translator_RatingValue_4",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_4),this.na.$("Translator_RatingValue_5",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_5),this.na.$("Translator_PromptQuestion",CommonUIStrings.l_Word_Translator_Floodgate_PromptQuestion),this.na.$("TeamsOpen_GreetingQuestion",
CommonUIStrings.l_WAC_NPS_Title),this.na.$("TeamsOpen_PromptTitle",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("TeamsOpen_GreetingAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("TeamsOpen_GreetingAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("TeamsOpen_RatingQuestion_Word",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Word),this.na.$("TeamsOpen_RatingQuestion_Excel",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Excel),this.na.$("TeamsOpen_RatingQuestion_PowerPoint",
CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_PowerPoint),this.na.$("TeamsOpen_Rating_Browser",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Rating_Browser),this.na.$("TeamsOpen_Rating_Teams",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Rating_Teams),this.na.$("TeamsOpen_PromptQuestion",CommonUIStrings.l_WAC_NPS_Rating_QuestionQuestion),this.na.$("LinkedIn_Title",CommonUIStrings.l_LinkedIn_Title),this.na.$("LinkedIn_PromptQuestion",CommonUIStrings.l_LinkedIn_PromptQuestion),this.na.$("LinkedIn_QuestionQuestion",
CommonUIStrings.l_LinkedIn_QuestionQuestion),this.na.$("LinkedIn_Rating_Values_1",CommonUIStrings.l_LinkedIn_Rating_Values_1),this.na.$("LinkedIn_Rating_Values_2",CommonUIStrings.l_LinkedIn_Rating_Values_2),this.na.$("LinkedIn_Rating_Values_3",CommonUIStrings.l_LinkedIn_Rating_Values_3),this.na.$("LinkedIn_Rating_Values_4",CommonUIStrings.l_LinkedIn_Rating_Values_4),this.na.$("LinkedIn_Rating_Values_5",CommonUIStrings.l_LinkedIn_Rating_Values_5),this.na.$("Excel_LinkedIn_RatingQuestion",CommonUIStrings.l_Excel_LinkedIn_RatingQuestion),
this.na.$("VHRestore_Title",CommonUIStrings.l_WAC_VHRestore_PromptTitle),this.na.$("VHRestore_PromptQuestion",CommonUIStrings.l_WAC_VHRestore_PromptQuestion),this.na.$("VHRestore_Sure",CommonUIStrings.l_WAC_VHRestore_Sure),this.na.$("VHRestore_NotNow",CommonUIStrings.l_WAC_VHRestore_NotNow),this.na.$("VHRestore_SurveyQuestion",CommonUIStrings.l_WAC_VHRestore_SurveyQuestion),this.na.$("VHRestore_Answer_Options_1",CommonUIStrings.l_WAC_VHRestore_AnswerOption_1),this.na.$("VHRestore_Answer_Options_2",
CommonUIStrings.l_WAC_VHRestore_AnswerOption_2),this.na.$("VHRestore_Answer_Options_3",CommonUIStrings.l_WAC_VHRestore_AnswerOption_3),this.na.$("VHRestore_Answer_Options_4",CommonUIStrings.l_WAC_VHRestore_AnswerOption_4),this.na.$("VHRestore_WhyQuestion",CommonUIStrings.l_WAC_VHRestore_WhyQuestion),this.na.$("ShowChanges_Prompt",CommonUIStrings.l_Excel_ShowChanges_Prompt),this.na.$("ShowChanges_PromptQuestion",CommonUIStrings.l_Excel_ShowChanges_PromptQuestion),this.na.$("ShowChanges_PromptLabel_Sure",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("ShowChanges_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ShowChanges_RatingQuestion",CommonUIStrings.l_Excel_ShowChanges_RatingQuestion),this.na.$("ShowChanges_RatingValue_1",CommonUIStrings.l_Excel_ShowChanges_RatingValue_1),this.na.$("ShowChanges_RatingValue_2",CommonUIStrings.l_Excel_ShowChanges_RatingValue_2),this.na.$("ShowChanges_RatingValue_3",CommonUIStrings.l_Excel_ShowChanges_RatingValue_3),this.na.$("ShowChanges_RatingValue_4",
CommonUIStrings.l_Excel_ShowChanges_RatingValue_4),this.na.$("ShowChanges_RatingValue_5",CommonUIStrings.l_Excel_ShowChanges_RatingValue_5),this.na.$("ShowChanges_WhyQuestion",CommonUIStrings.l_Excel_ShowChanges_WhyQuestion),this.na.$("ModernUxExperiment_FloodgatePromptTitle",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptTitle),this.na.$("ModernUxExperiment_FloodgatePromptQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptQuestion),this.na.$("ModernUxExperiment_FloodgatePromptAnswer_NotNow",
CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptAnswer_NotNow),this.na.$("ModernUxExperiment_FloodgatePromptAnswer_Sure",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptAnswer_Sure),this.na.$("ModernUxExperiment_FloodgateRatingQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingQuestion),this.na.$("ModernUxExperiment_FloodgateRatingValue_1",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_1),this.na.$("ModernUxExperiment_FloodgateRatingValue_2",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_2),
this.na.$("ModernUxExperiment_FloodgateRatingValue_3",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_3),this.na.$("ModernUxExperiment_FloodgateRatingValue_4",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_4),this.na.$("ModernUxExperiment_FloodgateRatingValue_5",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_5),this.na.$("ModernUxExperiment_FloodgateHearMoreQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_HearMoreQuestion),this.na.$("FileBackedLoopComponents_FloodgatePromptTitle",
CommonUIStrings.l_FileBackedLoopComponents_Floodgate_PromptTitle),this.na.$("FileBackedLoopComponents_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("FileBackedLoopComponents_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("FileBackedLoopComponents_FloodgatePromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("FileBackedLoopComponents_FloodgateRatingQuestion",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingQuestion),
this.na.$("FileBackedLoopComponents_FloodgateRatingValue_1",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_1),this.na.$("FileBackedLoopComponents_FloodgateRatingValue_2",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_2),this.na.$("FileBackedLoopComponents_FloodgateRatingValue_3",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_3),this.na.$("FileBackedLoopComponents_FloodgateRatingValue_4",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_4),
this.na.$("FileBackedLoopComponents_FloodgateRatingValue_5",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_5),this.na.$("FileBackedLoopComponents_FloodgateWhyQuestion",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_FloodgateWhyQuestion),this.na.$("PollLoopComponent_FloodgatePromptTitle",CommonUIStrings.l_PollLoopComponent_Floodgate_PromptTitle),this.na.$("PollLoopComponent_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("PollLoopComponent_FloodgatePromptAnswer_NotNow",
CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("PollLoopComponent_FloodgatePromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("PollLoopComponent_FloodgateRatingQuestion",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingQuestion),this.na.$("PollLoopComponent_FloodgateRatingValue_1",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_1),this.na.$("PollLoopComponent_FloodgateRatingValue_2",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_2),this.na.$("PollLoopComponent_FloodgateRatingValue_3",
CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_3),this.na.$("PollLoopComponent_FloodgateRatingValue_4",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_4),this.na.$("PollLoopComponent_FloodgateRatingValue_5",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_5),this.na.$("PollLoopComponent_FloodgateWhyQuestion",CommonUIStrings.l_PollLoopComponent_Floodgate_FloodgateWhyQuestion),this.na.$("RemoveLoopComponents_FloodgatePromptTitle",CommonUIStrings.l_RemoveLoopComponents_Floodgate_PromptTitle),
this.na.$("RemoveLoopComponents_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("RemoveLoopComponents_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("RemoveLoopComponents_FloodgatePromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("RemoveLoopComponents_FloodgateRatingQuestion",CommonUIStrings.l_RemoveLoopComponents_Floodgate_RatingQuestion),this.na.$("RemoveLoopComponents_FloodgateRatingValue_1",
CommonUIStrings.l_RemoveLoopComponents_Floodgate_RatingValue_1),this.na.$("RemoveLoopComponents_FloodgateRatingValue_2",CommonUIStrings.l_RemoveLoopComponents_Floodgate_RatingValue_2),this.na.$("RemoveLoopComponents_FloodgateRatingValue_3",CommonUIStrings.l_RemoveLoopComponents_Floodgate_RatingValue_3),this.na.$("RemoveLoopComponents_FloodgateRatingValue_4",CommonUIStrings.l_RemoveLoopComponents_Floodgate_RatingValue_4),this.na.$("RemoveLoopComponents_FloodgateRatingValue_5",CommonUIStrings.l_RemoveLoopComponents_Floodgate_RatingValue_5),
this.na.$("RemoveLoopComponents_FloodgateWhyQuestion",CommonUIStrings.l_RemoveLoopComponents_Floodgate_FloodgateWhyQuestion),this.na.$("NotUseLoopComponents_FloodgateCommentQuestion",CommonUIStrings.l_NotUseLoopComponents_Floodgate_CommentQuestion),this.na.$("NotUseLoopComponents_FloodgateRatingQuestion",CommonUIStrings.l_NotUseLoopComponents_Floodgate_RatingQuestion),this.na.$("NotUseLoopComponents_FloodgateRatingValue_1",CommonUIStrings.l_NotUseLoopComponents_Floodgate_RatingValue_1),this.na.$("NotUseLoopComponents_FloodgateRatingValue_2",
CommonUIStrings.l_NotUseLoopComponents_Floodgate_RatingValue_2),this.na.$("NotUseLoopComponents_FloodgateRatingValue_3",CommonUIStrings.l_NotUseLoopComponents_Floodgate_RatingValue_3),this.na.$("NotUseLoopComponents_FloodgateRatingValue_4",CommonUIStrings.l_NotUseLoopComponents_Floodgate_RatingValue_4),this.na.$("NotUseLoopComponents_FloodgateRatingValue_5",CommonUIStrings.l_NotUseLoopComponents_Floodgate_RatingValue_5),this.na.$("TabSwitchTreatmentExperiment_FloodgatePromptTitle",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptTitle),
this.na.$("TabSwitchTreatmentExperiment_FloodgatePromptQuestion",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptQuestion),this.na.$("TabSwitchTreatmentExperiment_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptAnswer_NotNow),this.na.$("TabSwitchTreatmentExperiment_FloodgatePromptAnswer_Sure",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptAnswer_Sure),this.na.$("TabSwitchTreatmentExperiment_FloodgateRatingQuestion",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingQuestion),
this.na.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_1",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_1),this.na.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_2",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_2),this.na.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_3",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_3),this.na.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_4",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_4),
this.na.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_5",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_5),this.na.$("TabSwitchTreatmentExperiment_FloodgateHearMoreQuestion",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_HearMoreQuestion),this.na.$("TabSwitchControlExperiment_FloodgatePromptTitle",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptTitle),this.na.$("TabSwitchControlExperiment_FloodgatePromptQuestion",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptQuestion),
this.na.$("TabSwitchControlExperiment_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptAnswer_NotNow),this.na.$("TabSwitchControlExperiment_FloodgatePromptAnswer_Sure",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptAnswer_Sure),this.na.$("TabSwitchControlExperiment_FloodgateRatingQuestion",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingQuestion),this.na.$("TabSwitchControlExperiment_FloodgateRatingValue_1",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_1),
this.na.$("TabSwitchControlExperiment_FloodgateRatingValue_2",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_2),this.na.$("TabSwitchControlExperiment_FloodgateRatingValue_3",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_3),this.na.$("TabSwitchControlExperiment_FloodgateRatingValue_4",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_4),this.na.$("TabSwitchControlExperiment_FloodgateRatingValue_5",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_5),
this.na.$("TabSwitchControlExperiment_FloodgateHearMoreQuestion",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_HearMoreQuestion),this.na.$("ShortcutDiscovery_PromptTitle",CommonUIStrings.l_ShortcutDiscovery_PromptTitle),this.na.$("ShortcutDiscovery_PromptQuestion",CommonUIStrings.l_ShortcutDiscovery_PromptQuestion),this.na.$("ShortcutDiscovery_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ShortcutDiscovery_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.na.$("ShortcutDiscovery_RatingQuestion",CommonUIStrings.l_ShortcutDiscovery_RatingQuestion),this.na.$("ShortcutDiscovery_RatingValue_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1),this.na.$("ShortcutDiscovery_RatingValue_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2),this.na.$("ShortcutDiscovery_RatingValue_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3),this.na.$("ShortcutDiscovery_RatingValue_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4),this.na.$("ShortcutDiscovery_RatingValue_5",
CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5),this.na.$("ShortcutDiscovery_WhyQuestion",CommonUIStrings.l_ShortcutDiscovery_WhyQuestion),this.na.$("Fonts_PromptTitle",CommonUIStrings.l_FontExperience_FloodgatePromptTitle),this.na.$("Fonts_PromptQuestion",CommonUIStrings.l_FontExperience_FloodgatePromptQuestion),this.na.$("Fonts_PromptAnswer_NotNow",CommonUIStrings.l_FontExperience_FloodgatePromptAnswer_NotNow),this.na.$("Fonts_PromptAnswer_Sure",CommonUIStrings.l_FontExperience_FloodgatePromptAnswer_Sure),
this.na.$("Fonts_RatingQuestion",CommonUIStrings.l_FontExperience_FloodgateRatingQuestion),this.na.$("Fonts_RatingValue_1",CommonUIStrings.l_FontExperience_FloodgateRatingValue_1),this.na.$("Fonts_RatingValue_2",CommonUIStrings.l_FontExperience_FloodgateRatingValue_2),this.na.$("Fonts_RatingValue_3",CommonUIStrings.l_FontExperience_FloodgateRatingValue_3),this.na.$("Fonts_RatingValue_4",CommonUIStrings.l_FontExperience_FloodgateRatingValue_4),this.na.$("Fonts_RatingValue_5",CommonUIStrings.l_FontExperience_FloodgateRatingValue_5),
this.na.$("Fonts_WhyQuestion",CommonUIStrings.l_FontExperience_FloodgateWhyQuestion),this.na.$("Ruler_PromptTitle",CommonUIStrings.l_WordRuler_PromptTitle),this.na.$("Ruler_PromptQuestion",CommonUIStrings.l_WordRuler_PromptQuestion),this.na.$("Ruler_PromptAnswer_NotNow",CommonUIStrings.l_WordRuler_PromptAnswer_NotNow),this.na.$("Ruler_PromptAnswer_Sure",CommonUIStrings.l_WordRuler_PromptAnswer_Sure),this.na.$("Ruler_RatingQuestion",CommonUIStrings.l_WordRuler_RatingQuestion),this.na.$("Ruler_RatingValue_1",
CommonUIStrings.l_WordRuler_RatingValue_1),this.na.$("Ruler_RatingValue_2",CommonUIStrings.l_WordRuler_RatingValue_2),this.na.$("Ruler_RatingValue_3",CommonUIStrings.l_WordRuler_RatingValue_3),this.na.$("Ruler_RatingValue_4",CommonUIStrings.l_WordRuler_RatingValue_4),this.na.$("Ruler_RatingValue_5",CommonUIStrings.l_WordRuler_RatingValue_5),this.na.$("Ruler_WhyQuestion",CommonUIStrings.l_WordRuler_WhyQuestion),this.na.$("CustomTabDialog_PromptTitle",CommonUIStrings.l_CustomTabDialog_PromptTitle),
this.na.$("CustomTabDialog_PromptQuestion",CommonUIStrings.l_CustomTabDialog_PromptQuestion),this.na.$("CustomTabDialog_PromptAnswer_NotNow",CommonUIStrings.l_CustomTabDialog_PromptAnswer_NotNow),this.na.$("CustomTabDialog_PromptAnswer_Sure",CommonUIStrings.l_CustomTabDialog_PromptAnswer_Sure),this.na.$("CustomTabDialog_RatingQuestion",CommonUIStrings.l_CustomTabDialog_RatingQuestion),this.na.$("CustomTabDialog_RatingValue_1",CommonUIStrings.l_CustomTabDialog_RatingValue_1),this.na.$("CustomTabDialog_RatingValue_2",
CommonUIStrings.l_CustomTabDialog_RatingValue_2),this.na.$("CustomTabDialog_RatingValue_3",CommonUIStrings.l_CustomTabDialog_RatingValue_3),this.na.$("CustomTabDialog_RatingValue_4",CommonUIStrings.l_CustomTabDialog_RatingValue_4),this.na.$("CustomTabDialog_RatingValue_5",CommonUIStrings.l_CustomTabDialog_RatingValue_5),this.na.$("CustomTabDialog_WhyQuestion",CommonUIStrings.l_CustomTabDialog_WhyQuestion),this.na.$("WordStyles_FloodgatePromptTitle",CommonUIStrings.l_WordStyles_FloodgatePromptTitle),
this.na.$("WordStyles_FloodgatePromptQuestion",CommonUIStrings.l_WordStyles_FloodgatePromptQuestion),this.na.$("WordStyles_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordStyles_FloodgatePrompt_YesLabel),this.na.$("WordStyles_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordStyles_FloodgatePrompt_NoLabel),this.na.$("WordStyles_FloodgateRatingQuestion",CommonUIStrings.l_WordStyles_FloodgateRatingQuestion),this.na.$("WordStyles_FloodgateRating_1",CommonUIStrings.l_WordStyles_FloodgateRating_1),this.na.$("WordStyles_FloodgateRating_2",
CommonUIStrings.l_WordStyles_FloodgateRating_2),this.na.$("WordStyles_FloodgateRating_3",CommonUIStrings.l_WordStyles_FloodgateRating_3),this.na.$("WordStyles_FloodgateRating_4",CommonUIStrings.l_WordStyles_FloodgateRating_4),this.na.$("WordStyles_FloodgateRating_5",CommonUIStrings.l_WordStyles_FloodgateRating_5),this.na.$("WordStyles_FloodgateWhyQuestion",CommonUIStrings.l_WordStyles_FloodgateWhyQuestion),this.na.$("UnsavedChangesHighlight_PromptTitle",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_PromptTitle),
this.na.$("UnsavedChangesHighlight_PromptQuestion",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_PromptQuestion),this.na.$("UnsavedChangesHighlight_Prompt_YesLabel",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Prompt_YesLabel),this.na.$("UnsavedChangesHighlight_Prompt_NoLabel",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Prompt_NoLabel),this.na.$("UnsavedChangesHighlight_RatingQuestion",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_RatingQuestion),this.na.$("UnsavedChangesHighlight_Rating_Yes",
CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Rating_Yes),this.na.$("UnsavedChangesHighlight_Rating_No",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Rating_No),this.na.$("UnsavedChangesHighlight_CommentQuestion",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_CommentQuestion),this.na.$("WordUnifiedRead_FloodgatePromptTitle",CommonUIStrings.l_WordUnifiedRead_FloodgatePromptTitle),this.na.$("WordUnifiedRead_FloodgatePromptQuestion",CommonUIStrings.l_WordUnifiedRead_FloodgatePromptQuestion),
this.na.$("WordUnifiedRead_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordUnifiedRead_FloodgatePrompt_YesLabel),this.na.$("WordUnifiedRead_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordUnifiedRead_FloodgatePrompt_NoLabel),this.na.$("WordUnifiedRead_FloodgateRatingQuestion",CommonUIStrings.l_WordUnifiedRead_FloodgateRatingQuestion),this.na.$("WordUnifiedRead_FloodgateRating_1",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_1),this.na.$("WordUnifiedRead_FloodgateRating_2",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_2),
this.na.$("WordUnifiedRead_FloodgateRating_3",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_3),this.na.$("WordUnifiedRead_FloodgateRating_4",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_4),this.na.$("WordUnifiedRead_FloodgateRating_5",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_5),this.na.$("WordUnifiedRead_FloodgateWhyQuestion",CommonUIStrings.l_WordUnifiedRead_FloodgateWhyQuestion),this.na.$("GrammarSuggestions_FloodgatePromptTitle",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePromptTitle),
this.na.$("GrammarSuggestions_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePromptQuestion),this.na.$("GrammarSuggestions_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePrompt_YesLabel),this.na.$("GrammarSuggestions_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePrompt_NoLabel),this.na.$("GrammarSuggestions_FloodgateRatingQuestion",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRatingQuestion),this.na.$("GrammarSuggestions_FloodgateRating_1",
CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_1),this.na.$("GrammarSuggestions_FloodgateRating_2",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_2),this.na.$("GrammarSuggestions_FloodgateRating_3",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_3),this.na.$("GrammarSuggestions_FloodgateRating_4",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_4),this.na.$("GrammarSuggestions_FloodgateRating_5",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_5),this.na.$("GrammarSuggestions_FloodgateQuestion",
CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateQuestion),this.na.$("WordRemoveSsr_FloodgatePromptTitle",CommonUIStrings.l_WordRemoveSsr_FloodgatePromptTitle),this.na.$("WordRemoveSsr_FloodgatePromptQuestion",CommonUIStrings.l_WordRemoveSsr_FloodgatePromptQuestion),this.na.$("WordRemoveSsr_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordRemoveSsr_FloodgatePrompt_YesLabel),this.na.$("WordRemoveSsr_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordRemoveSsr_FloodgatePrompt_NoLabel),this.na.$("WordRemoveSsr_FloodgateRatingQuestion",
CommonUIStrings.l_WordRemoveSsr_FloodgateRatingQuestion),this.na.$("WordRemoveSsr_FloodgateRating_1",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_1),this.na.$("WordRemoveSsr_FloodgateRating_2",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_2),this.na.$("WordRemoveSsr_FloodgateRating_3",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_3),this.na.$("WordRemoveSsr_FloodgateRating_4",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_4),this.na.$("WordRemoveSsr_FloodgateRating_5",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_5),
this.na.$("WordRemoveSsr_FloodgateWhyQuestion",CommonUIStrings.l_WordRemoveSsr_FloodgateWhyQuestion),this.na.$("WordDrawing_FloodgatePromptTitle",CommonUIStrings.l_WordDrawing_FloodgatePromptTitle),this.na.$("WordDrawing_FloodgatePromptQuestion",CommonUIStrings.l_WordDrawing_FloodgatePromptQuestion),this.na.$("WordDrawing_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordDrawing_FloodgatePrompt_YesLabel),this.na.$("WordDrawing_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordDrawing_FloodgatePrompt_NoLabel),
this.na.$("WordDrawing_FloodgateRatingQuestion",CommonUIStrings.l_WordDrawing_FloodgateRatingQuestion),this.na.$("WordDrawing_FloodgateRating_1",CommonUIStrings.l_WordDrawing_FloodgateRating_1),this.na.$("WordDrawing_FloodgateRating_2",CommonUIStrings.l_WordDrawing_FloodgateRating_2),this.na.$("WordDrawing_FloodgateRating_3",CommonUIStrings.l_WordDrawing_FloodgateRating_3),this.na.$("WordDrawing_FloodgateRating_4",CommonUIStrings.l_WordDrawing_FloodgateRating_4),this.na.$("WordDrawing_FloodgateRating_5",
CommonUIStrings.l_WordDrawing_FloodgateRating_5),this.na.$("WordDrawing_FloodgateWhyQuestion",CommonUIStrings.l_WordDrawing_FloodgateWhyQuestion),this.na.$("WordPenNSAT_FloodgatePromptTitle",CommonUIStrings.l_WordPenNSAT_FloodgatePromptTitle),this.na.$("WordPenNSAT_FloodgatePromptQuestion",CommonUIStrings.l_WordPenNSAT_FloodgatePromptQuestion),this.na.$("WordPenNSAT_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("WordPenNSAT_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),
this.na.$("WordPenNSAT_FloodgateRatingQuestion",CommonUIStrings.l_WordPenNSAT_FloodgateRatingQuestion),this.na.$("WordPenNSAT_FloodgateRating_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.na.$("WordPenNSAT_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.na.$("WordPenNSAT_FloodgateRating_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.na.$("WordPenNSAT_FloodgateRating_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),
this.na.$("WordPenNSAT_FloodgateRating_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.na.$("WordPenNSAT_FloodgateWhyQuestion",CommonUIStrings.l_WordPenNSAT_FloodgateWhyQuestion),this.na.$("ShyRibbon_FloodgatePromptTitle",CommonUIStrings.l_ShyRibbon_FloodgatePromptTitle),this.na.$("ShyRibbon_FloodgatePromptQuestion",CommonUIStrings.l_ShyRibbon_FloodgatePromptQuestion),this.na.$("ShyRibbon_FloodgatePrompt_YesLabel",CommonUIStrings.l_ShyRibbon_FloodgatePrompt_YesLabel),
this.na.$("ShyRibbon_FloodgatePrompt_NoLabel",CommonUIStrings.l_ShyRibbon_FloodgatePrompt_NoLabel),this.na.$("ShyRibbon_Floodgate_Question",CommonUIStrings.l_ShyRibbon_Floodgate_Question),this.na.$("ShyRibbon_Floodgate_Option_1",CommonUIStrings.l_ShyRibbon_Floodgate_Option_1),this.na.$("ShyRibbon_Floodgate_Option_2",CommonUIStrings.l_ShyRibbon_Floodgate_Option_2),this.na.$("ShyRibbon_Floodgate_Option_3",CommonUIStrings.l_ShyRibbon_Floodgate_Option_3),this.na.$("ShyRibbon_Floodgate_Option_4",CommonUIStrings.l_ShyRibbon_Floodgate_Option_4),
this.na.$("ShyRibbon_Floodgate_Option_5",CommonUIStrings.l_ShyRibbon_Floodgate_Option_5),this.na.$("ShyRibbon_FloodgateTellusMore",CommonUIStrings.l_ShyRibbon_Floodgate_TellMore),this.na.$("WordAutoCorrect_FloodgatePromptTitle",CommonUIStrings.l_WordAutoCorrect_FloodgatePromptTitle),this.na.$("WordAutoCorrect_FloodgatePromptQuestion",CommonUIStrings.l_WordAutoCorrect_FloodgatePromptQuestion),this.na.$("WordAutoCorrect_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordAutoCorrect_FloodgatePrompt_YesLabel),
this.na.$("WordAutoCorrect_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordAutoCorrect_FloodgatePrompt_NoLabel),this.na.$("WordAutoCorrect_FloodgateRatingQuestion",CommonUIStrings.l_WordAutoCorrect_FloodgateRatingQuestion),this.na.$("WordAutoCorrect_FloodgateRating_1",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_1),this.na.$("WordAutoCorrect_FloodgateRating_2",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_2),this.na.$("WordAutoCorrect_FloodgateRating_3",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_3),
this.na.$("WordAutoCorrect_FloodgateRating_4",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_4),this.na.$("WordAutoCorrect_FloodgateRating_5",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_5),this.na.$("WordAutoCorrect_FloodgateWhyQuestion",CommonUIStrings.l_WordAutoCorrect_FloodgateWhyQuestion),this.na.$("PasswordProtectedDocumentSupport_FloodgatePromptTitle",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePromptTitle),this.na.$("PasswordProtectedDocumentSupport_FloodgatePromptQuestion",
CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePromptQuestion),this.na.$("PasswordProtectedDocumentSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePrompt_YesLabel),this.na.$("PasswordProtectedDocumentSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePrompt_NoLabel),this.na.$("PasswordProtectedDocumentSupport_FloodgateRatingQuestion",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRatingQuestion),
this.na.$("PasswordProtectedDocumentSupport_FloodgateRating_1",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_1),this.na.$("PasswordProtectedDocumentSupport_FloodgateRating_2",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_2),this.na.$("PasswordProtectedDocumentSupport_FloodgateRating_3",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_3),this.na.$("PasswordProtectedDocumentSupport_FloodgateRating_4",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_4),
this.na.$("PasswordProtectedDocumentSupport_FloodgateRating_5",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_5),this.na.$("PasswordProtectedDocumentSupport_FloodgateWhyQuestion",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateWhyQuestion),this.na.$("WordSimilarity_FloodgatePromptTitle",CommonUIStrings.l_WordSimilarity_FloodgatePromptTitle),this.na.$("WordSimilarity_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("WordSimilarity_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("WordSimilarity_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("WordSimilarity_FloodgateRatingQuestion",CommonUIStrings.l_WordSimilarity_FloodgateRatingQuestion),this.na.$("WordSimilarity_FloodgateRating_1",CommonUIStrings.l_WordSimilarity_FloodgateRating_1),this.na.$("WordSimilarity_FloodgateRating_2",CommonUIStrings.l_WordSimilarity_FloodgateRating_2),this.na.$("WordSimilarity_FloodgateRating_3",CommonUIStrings.l_WordSimilarity_FloodgateRating_3),
this.na.$("WordSimilarity_FloodgateRating_4",CommonUIStrings.l_WordSimilarity_FloodgateRating_4),this.na.$("WordSimilarity_FloodgateRating_5",CommonUIStrings.l_WordSimilarity_FloodgateRating_5),this.na.$("WordSimilarity_FloodgateWhyQuestion",CommonUIStrings.l_WordSimilarity_FloodgateWhyQuestion),this.na.$("PremiumPreviewFloodgateTitle",CommonUIStrings.l_PremiumPreview_FeedbackTitle),this.na.$("PremiumPreviewFloodgatePrompt",CommonUIStrings.l_PremiumPreview_FeedbackPrompt),this.na.$("PremiumPreviewFloodgateRatingQuestion",
CommonUIStrings.l_PremiumPreview_FeedbackRatingQuestion),this.na.$("PremiumPreviewFloodgateQuestion",CommonUIStrings.l_PremiumPreview_FeedbackQuestion1),this.na.$("PremiumPreviewFloodgateMinRating",CommonUIStrings.l_PremiumPreview_FeedbackMinRating),this.na.$("PremiumPreviewFloodgateMaxRating",CommonUIStrings.l_PremiumPreview_FeedbackMaxRating),this.na.$("FloodgateNLQSPromptTitle",CommonUIStrings.l_FloodgateNLQSPromptTitle),this.na.$("FloodgateNLQSPromptSubtitle",CommonUIStrings.l_FloodgateNLQSPromptSubtitle),
this.na.$("FloodgateNLQSPromptYes",CommonUIStrings.l_FloodgateNLQSPromptYes),this.na.$("FloodgateNLQSPromptNo",CommonUIStrings.l_FloodgateNLQSPromptNo),this.na.$("FloodgateNLQSRatingQuestion",CommonUIStrings.l_FloodgateNLQSRatingQuestion),this.na.$("FloodgateNLQSRating1",CommonUIStrings.l_FloodgateNLQSRating1),this.na.$("FloodgateNLQSRating2",CommonUIStrings.l_FloodgateNLQSRating2),this.na.$("FloodgateNLQSRating3",CommonUIStrings.l_FloodgateNLQSRating3),this.na.$("FloodgateNLQSRating4",CommonUIStrings.l_FloodgateNLQSRating4),
this.na.$("FloodgateNLQSRating5",CommonUIStrings.l_FloodgateNLQSRating5),this.na.$("FloodgateNLQSDetailsQuestion",CommonUIStrings.l_FloodgateNLQSDetailsQuestion),this.na.$("ExcelWebEaseOfUse_Prompt",CommonUIStrings.l_ExcelWeb_EaseOfUse_Prompt),this.na.$("ExcelWebEaseOfUse_PromptQuestion",CommonUIStrings.l_ExcelWeb_EaseOfUse_PromptQuestion),this.na.$("ExcelWebEaseOfUse_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("ExcelWebEaseOfUse_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),
this.na.$("ExcelWebEaseOfUse_RatingQuestion",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingQuestion),this.na.$("ExcelWebEaseOfUse_RatingValue_1",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_1),this.na.$("ExcelWebEaseOfUse_RatingValue_2",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_2),this.na.$("ExcelWebEaseOfUse_RatingValue_3",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_3),this.na.$("ExcelWebEaseOfUse_RatingValue_4",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_4),this.na.$("ExcelWebEaseOfUse_RatingValue_5",
CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_5),this.na.$("ExcelWebEaseOfUse_WhyQuestion",CommonUIStrings.l_ExcelWeb_EaseOfUse_WhyQuestion),this.na.$("ExcelWebPrintSurvey_Prompt",CommonUIStrings.l_ExcelWeb_PrintSurvey_Prompt),this.na.$("ExcelWebPrintSurvey_PromptQuestion",CommonUIStrings.l_ExcelWeb_PrintSurvey_PromptQuestion),this.na.$("ExcelWebPrintSurvey_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("ExcelWebPrintSurvey_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),
this.na.$("ExcelWebPrintSurvey_RatingQuestion",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingQuestion),this.na.$("ExcelWebPrintSurvey_RatingValue_1",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_1),this.na.$("ExcelWebPrintSurvey_RatingValue_2",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_2),this.na.$("ExcelWebPrintSurvey_RatingValue_3",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_3),this.na.$("ExcelWebPrintSurvey_RatingValue_4",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_4),
this.na.$("ExcelWebPrintSurvey_RatingValue_5",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_5),this.na.$("ExcelWebPrintSurvey_WhyQuestion",CommonUIStrings.l_ExcelWeb_PrintSurvey_WhyQuestion),this.na.$("ReactAutoFilter_PromptLine_1",CommonUIStrings.l_Excel_ReactAutoFilter_PromptLine_1),this.na.$("ReactAutoFilter_PromptLine_2",CommonUIStrings.l_Excel_ReactAutoFilter_PromptLine_2),this.na.$("ReactAutoFilter_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("ReactAutoFilter_PromptLabel_NotNow",
CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ReactAutoFilter_RatingQuestion",CommonUIStrings.l_Excel_ReactAutoFilter_RatingQuestion),this.na.$("ReactAutoFilter_RatingValue_1",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_1),this.na.$("ReactAutoFilter_RatingValue_2",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_2),this.na.$("ReactAutoFilter_RatingValue_3",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_3),this.na.$("ReactAutoFilter_RatingValue_4",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_4),
this.na.$("ReactAutoFilter_RatingValue_5",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_5),this.na.$("ReactAutoFilter_CommentQuestion",CommonUIStrings.l_Excel_ReactAutoFilter_CommentQuestion),this.na.$("WordLinksExperience_FloodgatePromptTitle",CommonUIStrings.l_WordLinksExperience_FloodgatePromptTitle),this.na.$("WordLinksExperience_FloodgatePromptQuestion",CommonUIStrings.l_WordLinksExperience_FloodgatePromptQuestion),this.na.$("WordLinksExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordLinksExperience_FloodgatePrompt_YesLabel),
this.na.$("WordLinksExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordLinksExperience_FloodgatePrompt_NoLabel),this.na.$("WordLinksExperience_FloodgateRatingQuestion",CommonUIStrings.l_WordLinksExperience_FloodgateRatingQuestion),this.na.$("WordLinksExperience_FloodgateRating_1",CommonUIStrings.l_WordLinksExperience_FloodgateRating_1),this.na.$("WordLinksExperience_FloodgateRating_2",CommonUIStrings.l_WordLinksExperience_FloodgateRating_2),this.na.$("WordLinksExperience_FloodgateRating_3",
CommonUIStrings.l_WordLinksExperience_FloodgateRating_3),this.na.$("WordLinksExperience_FloodgateRating_4",CommonUIStrings.l_WordLinksExperience_FloodgateRating_4),this.na.$("WordLinksExperience_FloodgateRating_5",CommonUIStrings.l_WordLinksExperience_FloodgateRating_5),this.na.$("WordLinksExperience_FloodgateWhyQuestion",CommonUIStrings.l_WordLinksExperience_FloodgateWhyQuestion),this.na.$("OnlineVideoSupport_FloodgatePromptTitle",CommonUIStrings.l_OnlineVideoSupport_FloodgatePromptTitle),this.na.$("OnlineVideoSupport_FloodgatePromptQuestion",
CommonUIStrings.l_OnlineVideoSupport_FloodgatePromptQuestion),this.na.$("OnlineVideoSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_OnlineVideoSupport_FloodgatePrompt_YesLabel),this.na.$("OnlineVideoSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_OnlineVideoSupport_FloodgatePrompt_NoLabel),this.na.$("OnlineVideoSupport_FloodgateRatingQuestion",CommonUIStrings.l_OnlineVideoSupport_FloodgateRatingQuestion),this.na.$("OnlineVideoSupport_FloodgateRating_1",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_1),
this.na.$("OnlineVideoSupport_FloodgateRating_2",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_2),this.na.$("OnlineVideoSupport_FloodgateRating_3",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_3),this.na.$("OnlineVideoSupport_FloodgateRating_4",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_4),this.na.$("OnlineVideoSupport_FloodgateRating_5",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_5),this.na.$("OnlineVideoSupport_FloodgateWhyQuestion",CommonUIStrings.l_OnlineVideoSupport_FloodgateWhyQuestion),
this.na.$("NavPaneExperience_FloodgatePromptTitle",CommonUIStrings.l_NavPaneExperience_FloodgatePromptTitle),this.na.$("NavPaneExperience_FloodgatePromptQuestion",CommonUIStrings.l_NavPaneExperience_FloodgatePromptQuestion),this.na.$("NavPaneExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_NavPaneExperience_FloodgatePrompt_YesLabel),this.na.$("NavPaneExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_NavPaneExperience_FloodgatePrompt_NoLabel),this.na.$("NavPaneExperience_FloodgateRatingQuestion",
CommonUIStrings.l_NavPaneExperience_FloodgateRatingQuestion),this.na.$("NavPaneExperience_FloodgateRating_1",CommonUIStrings.l_NavPaneExperience_FloodgateRating_1),this.na.$("NavPaneExperience_FloodgateRating_2",CommonUIStrings.l_NavPaneExperience_FloodgateRating_2),this.na.$("NavPaneExperience_FloodgateRating_3",CommonUIStrings.l_NavPaneExperience_FloodgateRating_3),this.na.$("NavPaneExperience_FloodgateRating_4",CommonUIStrings.l_NavPaneExperience_FloodgateRating_4),this.na.$("NavPaneExperience_FloodgateRating_5",
CommonUIStrings.l_NavPaneExperience_FloodgateRating_5),this.na.$("NavPaneExperience_FloodgateWhyQuestion",CommonUIStrings.l_NavPaneExperience_FloodgateWhyQuestion),this.na.$("BookmarksExperience_FloodgatePromptTitle",CommonUIStrings.l_BookmarksExperience_FloodgatePromptTitle),this.na.$("BookmarksExperience_FloodgatePromptQuestion",CommonUIStrings.l_BookmarksExperience_FloodgatePromptQuestion),this.na.$("BookmarksExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_BookmarksExperience_FloodgatePrompt_YesLabel),
this.na.$("BookmarksExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_BookmarksExperience_FloodgatePrompt_NoLabel),this.na.$("BookmarksExperience_FloodgateRatingQuestion",CommonUIStrings.l_BookmarksExperience_FloodgateRatingQuestion),this.na.$("BookmarksExperience_FloodgateRating_1",CommonUIStrings.l_BookmarksExperience_FloodgateRating_1),this.na.$("BookmarksExperience_FloodgateRating_2",CommonUIStrings.l_BookmarksExperience_FloodgateRating_2),this.na.$("BookmarksExperience_FloodgateRating_3",
CommonUIStrings.l_BookmarksExperience_FloodgateRating_3),this.na.$("BookmarksExperience_FloodgateRating_4",CommonUIStrings.l_BookmarksExperience_FloodgateRating_4),this.na.$("BookmarksExperience_FloodgateRating_5",CommonUIStrings.l_BookmarksExperience_FloodgateRating_5),this.na.$("BookmarksExperience_FloodgateWhyQuestion",CommonUIStrings.l_BookmarksExperience_FloodgateWhyQuestion),this.na.$("WordPictureBorder_FloodgatePromptTitle",CommonUIStrings.l_WordPictureBorder_FloodgatePromptTitle),this.na.$("WordPictureBorder_FloodgatePromptQuestion",
CommonUIStrings.l_WordPictureBorder_FloodgatePromptQuestion),this.na.$("WordPictureBorder_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordPictureBorder_FloodgatePrompt_YesLabel),this.na.$("WordPictureBorder_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordPictureBorder_FloodgatePrompt_NoLabel),this.na.$("WordPictureBorder_FloodgateRatingQuestion",CommonUIStrings.l_WordPictureBorder_FloodgateRatingQuestion),this.na.$("WordPictureBorder_FloodgateRating_1",CommonUIStrings.l_WordPictureBorder_FloodgateRating_1),
this.na.$("WordPictureBorder_FloodgateRating_2",CommonUIStrings.l_WordPictureBorder_FloodgateRating_2),this.na.$("WordPictureBorder_FloodgateRating_3",CommonUIStrings.l_WordPictureBorder_FloodgateRating_3),this.na.$("WordPictureBorder_FloodgateRating_4",CommonUIStrings.l_WordPictureBorder_FloodgateRating_4),this.na.$("WordPictureBorder_FloodgateRating_5",CommonUIStrings.l_WordPictureBorder_FloodgateRating_5),this.na.$("WordPictureBorder_FloodgateWhyQuestion",CommonUIStrings.l_WordPictureBorder_FloodgateWhyQuestion),
this.na.$("WordComment_FloodgatePromptTitle",CommonUIStrings.l_WordComment_FloodgatePromptTitle),this.na.$("WordComment_FloodgatePromptQuestion",CommonUIStrings.l_WordComment_FloodgatePromptQuestion),this.na.$("WordComment_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordComment_FloodgatePrompt_YesLabel),this.na.$("WordComment_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordComment_FloodgatePrompt_NoLabel),this.na.$("WordComment_FloodgateRatingQuestion",CommonUIStrings.l_WordComment_FloodgateRatingQuestion),
this.na.$("WordComment_FloodgateRating_1",CommonUIStrings.l_WordComment_FloodgateRating_1),this.na.$("WordComment_FloodgateRating_2",CommonUIStrings.l_WordComment_FloodgateRating_2),this.na.$("WordComment_FloodgateRating_3",CommonUIStrings.l_WordComment_FloodgateRating_3),this.na.$("WordComment_FloodgateRating_4",CommonUIStrings.l_WordComment_FloodgateRating_4),this.na.$("WordComment_FloodgateRating_5",CommonUIStrings.l_WordComment_FloodgateRating_5),this.na.$("WordComment_FloodgateWhyQuestion",CommonUIStrings.l_WordComment_FloodgateWhyQuestion),
this.na.$("WordTrackChanges_FloodgatePromptTitle",CommonUIStrings.l_WordTrackChanges_FloodgatePromptTitle),this.na.$("WordTrackChanges_FloodgatePromptQuestion",CommonUIStrings.l_WordTrackChanges_FloodgatePromptQuestion),this.na.$("WordTrackChanges_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordTrackChanges_FloodgatePrompt_YesLabel),this.na.$("WordTrackChanges_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordTrackChanges_FloodgatePrompt_NoLabel),this.na.$("WordTrackChanges_FloodgateRatingQuestion",
CommonUIStrings.l_WordTrackChanges_FloodgateRatingQuestion),this.na.$("WordTrackChanges_FloodgateRating_1",CommonUIStrings.l_WordTrackChanges_FloodgateRating_1),this.na.$("WordTrackChanges_FloodgateRating_2",CommonUIStrings.l_WordTrackChanges_FloodgateRating_2),this.na.$("WordTrackChanges_FloodgateRating_3",CommonUIStrings.l_WordTrackChanges_FloodgateRating_3),this.na.$("WordTrackChanges_FloodgateRating_4",CommonUIStrings.l_WordTrackChanges_FloodgateRating_4),this.na.$("WordTrackChanges_FloodgateRating_5",
CommonUIStrings.l_WordTrackChanges_FloodgateRating_5),this.na.$("WordTrackChanges_FloodgateWhyQuestion",CommonUIStrings.l_WordTrackChanges_FloodgateWhyQuestion),this.na.$("CollabCorner_Survey_DownloadCopies_Prompt_Line_1",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_Line_1),this.na.$("CollabCorner_Survey_DownloadCopies_Prompt_Line_2",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_Line_2),this.na.$("CollabCorner_Survey_DownloadCopies_Prompt_YesLabel",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_YesLabel),
this.na.$("CollabCorner_Survey_DownloadCopies_Prompt_NoLabel",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_NoLabel),this.na.$("CollabCorner_Survey_DownloadCopies_Rating_Question",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Question),this.na.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_1",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_1),this.na.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_2",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_2),
this.na.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_3",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_3),this.na.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_4",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_4),this.na.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_5",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_5),this.na.$("CollabCorner_Survey_DownloadCopies_Comment_Question",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Comment_Question),
this.na.$("WordListsExperience_FloodgatePromptTitle",CommonUIStrings.l_WordListsExperience_FloodgatePromptTitle),this.na.$("WordListsExperience_FloodgatePromptQuestion",CommonUIStrings.l_WordListsExperience_FloodgatePromptQuestion),this.na.$("WordListsExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordListsExperience_FloodgatePrompt_YesLabel),this.na.$("WordListsExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordListsExperience_FloodgatePrompt_NoLabel),this.na.$("WordListsExperience_FloodgateRatingQuestion",
CommonUIStrings.l_WordListsExperience_FloodgateRatingQuestion),this.na.$("WordListsExperience_FloodgateRating_1",CommonUIStrings.l_WordListsExperience_FloodgateRating_1),this.na.$("WordListsExperience_FloodgateRating_5",CommonUIStrings.l_WordListsExperience_FloodgateRating_5),this.na.$("WordListsExperience_FloodgateAdditionalThoughts",CommonUIStrings.l_WordListsExperience_FloodgateAdditionalThoughts),this.na.$("WordChartsSupport_FloodgatePromptTitle",CommonUIStrings.l_WordChartsSupport_FloodgatePromptTitle),
this.na.$("WordChartsSupport_FloodgatePromptQuestion",CommonUIStrings.l_WordChartsSupport_FloodgatePromptQuestion),this.na.$("WordChartsSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordChartsSupport_FloodgatePrompt_YesLabel),this.na.$("WordChartsSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordChartsSupport_FloodgatePrompt_NoLabel),this.na.$("WordChartsSupport_FloodgateRatingQuestion",CommonUIStrings.l_WordChartsSupport_FloodgateRatingQuestion),this.na.$("WordChartsSupport_FloodgateRating_1",
CommonUIStrings.l_WordChartsSupport_FloodgateRating_1),this.na.$("WordChartsSupport_FloodgateRating_2",CommonUIStrings.l_WordChartsSupport_FloodgateRating_2),this.na.$("WordChartsSupport_FloodgateRating_3",CommonUIStrings.l_WordChartsSupport_FloodgateRating_3),this.na.$("WordChartsSupport_FloodgateRating_4",CommonUIStrings.l_WordChartsSupport_FloodgateRating_4),this.na.$("WordChartsSupport_FloodgateRating_5",CommonUIStrings.l_WordChartsSupport_FloodgateRating_5),this.na.$("WordChartsSupport_FloodgateWhyQuestion",
CommonUIStrings.l_WordChartsSupport_FloodgateWhyQuestion),this.na.$("WordTablesSupport_FloodgatePromptTitle",CommonUIStrings.l_WordTablesSupport_FloodgatePromptTitle),this.na.$("WordTablesSupport_FloodgatePromptQuestion",CommonUIStrings.l_WordTablesSupport_FloodgatePromptQuestion),this.na.$("WordTablesSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordTablesSupport_FloodgatePrompt_YesLabel),this.na.$("WordTablesSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordTablesSupport_FloodgatePrompt_NoLabel),
this.na.$("WordTablesSupport_FloodgateRatingQuestion",CommonUIStrings.l_WordTablesSupport_FloodgateRatingQuestion),this.na.$("WordTablesSupport_FloodgateRating_1",CommonUIStrings.l_WordTablesSupport_FloodgateRating_1),this.na.$("WordTablesSupport_FloodgateRating_2",CommonUIStrings.l_WordTablesSupport_FloodgateRating_2),this.na.$("WordTablesSupport_FloodgateRating_3",CommonUIStrings.l_WordTablesSupport_FloodgateRating_3),this.na.$("WordTablesSupport_FloodgateRating_4",CommonUIStrings.l_WordTablesSupport_FloodgateRating_4),
this.na.$("WordTablesSupport_FloodgateRating_5",CommonUIStrings.l_WordTablesSupport_FloodgateRating_5),this.na.$("WordTablesSupport_FloodgateWhyQuestion",CommonUIStrings.l_WordTablesSupport_FloodgateWhyQuestion),this.na.$("ModernPresence_PromptLine_1",CommonUIStrings.l_Excel_ModernPresence_PromptLine_1),this.na.$("ModernPresence_PromptLine_2",CommonUIStrings.l_Excel_ModernPresence_PromptLine_2),this.na.$("ModernPresence_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("ModernPresence_PromptLabel_NotNow",
CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ModernPresence_RatingQuestion",CommonUIStrings.l_Excel_ModernPresence_RatingQuestion),this.na.$("ModernPresence_RatingValue_1",CommonUIStrings.l_Excel_ModernPresence_RatingValue_1),this.na.$("ModernPresence_RatingValue_2",CommonUIStrings.l_Excel_ModernPresence_RatingValue_2),this.na.$("ModernPresence_RatingValue_3",CommonUIStrings.l_Excel_ModernPresence_RatingValue_3),this.na.$("ModernPresence_RatingValue_4",CommonUIStrings.l_Excel_ModernPresence_RatingValue_4),
this.na.$("ModernPresence_RatingValue_5",CommonUIStrings.l_Excel_ModernPresence_RatingValue_5),this.na.$("ModernPresence_CommentQuestion",CommonUIStrings.l_Excel_ModernPresence_CommentQuestion),this.na.$("WordInsertImages_FloodgatePromptTitle",CommonUIStrings.l_WordInsertImages_FloodgatePromptTitle),this.na.$("WordInsertImages_FloodgatePromptQuestion",CommonUIStrings.l_WordInsertImages_FloodgatePromptQuestion),this.na.$("WordInsertImages_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordInsertImages_FloodgatePrompt_YesLabel),
this.na.$("WordInsertImages_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordInsertImages_FloodgatePrompt_NoLabel),this.na.$("WordInsertImages_FloodgateRatingQuestion",CommonUIStrings.l_WordInsertImages_FloodgateRatingQuestion),this.na.$("WordInsertImages_FloodgateRating_1",CommonUIStrings.l_WordInsertImages_FloodgateRating_1),this.na.$("WordInsertImages_FloodgateRating_2",CommonUIStrings.l_WordInsertImages_FloodgateRating_2),this.na.$("WordInsertImages_FloodgateRating_3",CommonUIStrings.l_WordInsertImages_FloodgateRating_3),
this.na.$("WordInsertImages_FloodgateRating_4",CommonUIStrings.l_WordInsertImages_FloodgateRating_4),this.na.$("WordInsertImages_FloodgateRating_5",CommonUIStrings.l_WordInsertImages_FloodgateRating_5),this.na.$("WordInsertImages_FloodgateWhyQuestion",CommonUIStrings.l_WordInsertImages_FloodgateWhyQuestion),this.na.$("FontPicker_FloodgatePromptTitle",CommonUIStrings.l_FontPicker_FloodgatePromptTitle),this.na.$("FontPicker_FloodgatePromptQuestion",CommonUIStrings.l_FontPicker_FloodgatePromptQuestion),
this.na.$("FontPicker_FloodgatePromptYesLabel",CommonUIStrings.l_FontPicker_FloodgatePromptYesLabel),this.na.$("FontPicker_FloodgatePromptNoLabel",CommonUIStrings.l_FontPicker_FloodgatePromptNoLabel),this.na.$("FontPicker_FloodgateRatingQuestion",CommonUIStrings.l_FontPicker_FloodgateRatingQuestion),this.na.$("FontPicker_FloodgateRating1",CommonUIStrings.l_FontPicker_FloodgateRating1),this.na.$("FontPicker_FloodgateRating2",CommonUIStrings.l_FontPicker_FloodgateRating2),this.na.$("FontPicker_FloodgateRating3",
CommonUIStrings.l_FontPicker_FloodgateRating3),this.na.$("FontPicker_FloodgateRating4",CommonUIStrings.l_FontPicker_FloodgateRating4),this.na.$("FontPicker_FloodgateRating5",CommonUIStrings.l_FontPicker_FloodgateRating5),this.na.$("FontPicker_FloodgateCommentQuestion",CommonUIStrings.l_FontPicker_FloodgateCommentQuestion),this.na.$("FormulasMenu_PromptLine_1",CommonUIStrings.l_Excel_FormulasMenu_PromptLine_1),this.na.$("FormulasMenu_PromptLine_2",CommonUIStrings.l_Excel_FormulasMenu_PromptLine_2),
this.na.$("FormulasMenu_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("FormulasMenu_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("FormulasMenu_RatingQuestion",CommonUIStrings.l_Excel_FormulasMenu_RatingQuestion),this.na.$("FormulasMenu_RatingValue_1",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_1),this.na.$("FormulasMenu_RatingValue_2",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_2),this.na.$("FormulasMenu_RatingValue_3",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_3),
this.na.$("FormulasMenu_RatingValue_4",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_4),this.na.$("FormulasMenu_RatingValue_5",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_5),this.na.$("FormulasMenu_CommentQuestion",CommonUIStrings.l_Excel_FormulasMenu_CommentQuestion),this.na.$("WordWebEditorSeen_FloodgatePromptTitle",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.na.$("WordWebEditorSeen_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("WordWebEditorSeen_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("WordWebEditorSeen_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("WordWebEditorSeen_FloodgateRatingQuestion",CommonUIStrings.l_WordWebEditorSeen_FloodgateRatingQuestion),this.na.$("WordWebEditorSeen_FloodgateRating_1",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_ExtremelyNegative),this.na.$("WordWebEditorSeen_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_SomewhatNegative),this.na.$("WordWebEditorSeen_FloodgateRating_3",
CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_NeitherNegativeNorPositive),this.na.$("WordWebEditorSeen_FloodgateRating_4",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_SomewhatPositive),this.na.$("WordWebEditorSeen_FloodgateRating_5",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_ExtremelyPositive),this.na.$("WordWebEditorSeen_FloodgateWhyQuestion",CommonUIStrings.l_WordWebEditorSeen_FloodgateWhyQuestion),this.na.$("OnenotePerf_FloodgatePromptTitle",fb.pxj()),this.na.$("OnenotePerf_FloodgatePromptQuestion",
CommonUIStrings.l_OnenotePerf_FloodgatePromptQuestion),this.na.$("OnenotePerf_FloodgatePrompt_YesLabel",CommonUIStrings.l_OnenotePerf_FloodgatePrompt_YesLabel),this.na.$("OnenotePerf_FloodgatePrompt_NoLabel",CommonUIStrings.l_OnenotePerf_FloodgatePrompt_NoLabel),this.na.$("OnenotePerf_FloodgateRatingQuestion",fb.qxj()),this.na.$("OnenotePerf_FloodgateRatingQuestionChoice_1",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_1),this.na.$("OnenotePerf_FloodgateRatingQuestionChoice_2",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_2),
this.na.$("OnenotePerf_FloodgateRatingQuestionChoice_3",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_3),this.na.$("OnenotePerf_FloodgateRatingQuestionChoice_4",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_4),this.na.$("OnenotePerf_FloodgateRatingQuestionChoice_5",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_5),this.na.$("OnenotePerf_FloodgateWhyQuestion",CommonUIStrings.l_OnenotePerf_FloodgateWhyQuestion),this.na.$("OnenoteInkSurvey_Prompt",CommonUIStrings.l_OnenoteInkSurvey_Prompt),
this.na.$("OnenoteInkSurvey_PromptQuestion",CommonUIStrings.l_InkSurvey_PromptQuestion),this.na.$("OnenoteInkSurvey_Prompt_Sure",CommonUIStrings.l_InkSurvey_Prompt_Sure),this.na.$("OnenoteInkSurvey_Prompt_NoNow",CommonUIStrings.l_InkSurvey_Prompt_NoNow),this.na.$("OnenoteInkSurvey_RatingQuestion",CommonUIStrings.l_OnenoteInkSurvey_RatingQuestion),this.na.$("OnenoteInkSurvey_QuestionChoice_1",CommonUIStrings.l_InkSurvey_QuestionChoice_1),this.na.$("OnenoteInkSurvey_QuestionChoice_2",CommonUIStrings.l_InkSurvey_QuestionChoice_2),
this.na.$("OnenoteInkSurvey_QuestionChoice_3",CommonUIStrings.l_InkSurvey_QuestionChoice_3),this.na.$("OnenoteInkSurvey_QuestionChoice_4",CommonUIStrings.l_InkSurvey_QuestionChoice_4),this.na.$("OnenoteInkSurvey_QuestionChoice_5",CommonUIStrings.l_InkSurvey_QuestionChoice_5),this.na.$("OnenoteInkSurvey_WhyQuestion",CommonUIStrings.l_InkSurvey_WhyQuestion),this.na.$("OnenotePenInkSurvey_Prompt",CommonUIStrings.l_OnenotePenInkSurvey_Prompt),this.na.$("OnenotePenInkSurvey_PromptQuestion",CommonUIStrings.l_PenInkSurvey_PromptQuestion),
this.na.$("OnenotePenInkSurvey_Prompt_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("OnenotePenInkSurvey_Prompt_NoNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("OnenotePenInkSurvey_RatingQuestion",CommonUIStrings.l_OnenotePenInkSurvey_RatingQuestion),this.na.$("OnenotePenInkSurvey_QuestionChoice_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.na.$("OnenotePenInkSurvey_QuestionChoice_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),
this.na.$("OnenotePenInkSurvey_QuestionChoice_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.na.$("OnenotePenInkSurvey_QuestionChoice_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.na.$("OnenotePenInkSurvey_QuestionChoice_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.na.$("OnenotePenInkSurvey_WhyQuestion",CommonUIStrings.l_PenInkSurvey_WhyQuestion),this.na.$("PenInkSurvey_Prompt",CommonUIStrings.l_PenInkSurvey_Prompt),
this.na.$("PenInkSurvey_RatingQuestion",CommonUIStrings.l_PenInkSurvey_RatingQuestion),this.na.$("PenInkSurvey_PromptQuestion",CommonUIStrings.l_PenInkSurvey_PromptQuestion),this.na.$("PenInkSurvey_Prompt_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("PenInkSurvey_Prompt_NoNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("PenInkSurvey_QuestionChoice_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.na.$("PenInkSurvey_QuestionChoice_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),
this.na.$("PenInkSurvey_QuestionChoice_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.na.$("PenInkSurvey_QuestionChoice_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.na.$("PenInkSurvey_QuestionChoice_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.na.$("PenInkSurvey_WhyQuestion",CommonUIStrings.l_PenInkSurvey_WhyQuestion),this.na.$("SkittleFloodgateTitle",CommonUIStrings.l_Skittle_FeedbackTitle),this.na.$("SkittleFloodgatePrompt",
CommonUIStrings.l_Skittle_FeedbackPrompt),this.na.$("SkittleFloodgateRatingQuestion",CommonUIStrings.l_Skittle_FeedbackRatingQuestion),this.na.$("SkittleFloodgateQuestion",CommonUIStrings.l_Skittle_FeedbackQuestion),this.na.$("SkittleFloodgateMinRating",CommonUIStrings.l_Skittle_FeedbackMinRating),this.na.$("SkittleFloodgateMaxRating",CommonUIStrings.l_Skittle_FeedbackMaxRating),this.na.$("WordDocumentModes_FloodgatePromptTitle",CommonUIStrings.l_WordDocumentModes_FloodgatePromptTitle),this.na.$("WordDocumentModes_FloodgatePromptQuestion",
CommonUIStrings.l_WordDocumentModes_FloodgatePromptQuestion),this.na.$("WordDocumentModes_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordDocumentModes_FloodgatePrompt_YesLabel),this.na.$("WordDocumentModes_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordDocumentModes_FloodgatePrompt_NoLabel),this.na.$("WordDocumentModes_FloodgateRatingQuestion",CommonUIStrings.l_WordDocumentModes_FloodgateRatingQuestion),this.na.$("WordDocumentModes_FloodgateRating_1",CommonUIStrings.l_WordDocumentModes_FloodgateRating_1),
this.na.$("WordDocumentModes_FloodgateRating_5",CommonUIStrings.l_WordDocumentModes_FloodgateRating_5),this.na.$("WordDocumentModes_FloodgateWhyQuestion",CommonUIStrings.l_WordDocumentModes_FloodgateWhyQuestion),this.na.$("WordDesignerFloodgateTitle",CommonUIStrings.l_WordDesigner_FeedbackTitle),this.na.$("WordDesignerFloodgatePrompt",CommonUIStrings.l_WordDesigner_FeedbackPrompt),this.na.$("WordDesignerFloodgatePromptYesLabel",CommonUIStrings.l_WordDesigner_FloodgatePrompt_YesLabel),this.na.$("WordDesignerFloodgatePromptNoLabel",
CommonUIStrings.l_WordDesigner_FloodgatePrompt_NoLabel),this.na.$("WordDesignerFloodgateRatingQuestion",CommonUIStrings.l_WordDesigner_FeedbackRatingQuestion),this.na.$("WordDesignerFloodgateMinRating",CommonUIStrings.l_WordDesigner_FeedbackMinRating),this.na.$("WordDesignerFloodgateMaxRating",CommonUIStrings.l_WordDesigner_FeedbackMaxRating),this.na.$("WordDesignerFloodgateQuestion",CommonUIStrings.l_WordDesigner_FeedbackQuestion1),this.na.$("WordDesignerBlankDocumentExperienceTitle",CommonUIStrings.l_WordDesigner_BlankDocumentExperience_UserInitiatedTitle),
this.na.$("WordDesignerBlankDocumentExperienceRatingQuestion",CommonUIStrings.l_WordDesigner_BlankDocumentExperience_UserInitiatedRatingQuestion),this.na.$("WordDesignerBlankDocumentExperienceCommentQuestion",CommonUIStrings.l_WordDesigner_BlankDocumentExperience_UserInitiatedCommentQuestion),this.na.$("WordDesignerT2ISurveyQuestion",CommonUIStrings.l_WordDesigner_T2ISurveyQuestion),this.na.$("WordDesignerPQSurveyQuestion",CommonUIStrings.l_WordDesigner_PQSurveyQuestion),this.na.$("WordDesignerFormattingSuggestionsSurveyQuestion",
CommonUIStrings.l_WordDesigner_FormattingSuggestionsSurveyQuestion),this.na.$("WordDesignerAllContextualSuggestionsFeedbackRatingQuestion",CommonUIStrings.l_WordDesigner_AllContextualSuggestionsFeedbackRatingQuestion),this.na.$("WordDesignerDesignerPasteFeedbackRatingQuestion",fb.rxj()),this.na.$("WordDesignerHideSuggestionsQuestion",CommonUIStrings.l_WordDesigner_HideSuggestionsQuestion),this.na.$("WordDesignerHideSuggestionsAnswer1",CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_1),this.na.$("WordDesignerHideSuggestionsAnswer2",
CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_2),this.na.$("WordDesignerHideSuggestionsAnswer3",CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_3),this.na.$("WordDesignerHideSuggestionsAnswer4",CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_4),this.na.$("FpsInDocSearch_FloodgatePromptTitle",CommonUIStrings.l_FpsInDocSearch_FloodgatePromptTitle),this.na.$("FpsInDocSearch_FloodgatePromptQuestion",CommonUIStrings.l_FpsInDocSearch_FloodgatePromptQuestion),this.na.$("FpsInDocSearch_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("FpsInDocSearch_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("FpsInDocSearch_FloodgateRatingQuestion",CommonUIStrings.l_FpsInDocSearch_FloodgateRatingQuestion),this.na.$("FpsInDocSearch_FloodgateRating_1",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_1),this.na.$("FpsInDocSearch_FloodgateRating_2",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_2),this.na.$("FpsInDocSearch_FloodgateRating_3",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_3),
this.na.$("FpsInDocSearch_FloodgateRating_4",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_4),this.na.$("FpsInDocSearch_FloodgateRating_5",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_5),this.na.$("FpsInDocSearch_FloodgateWhyQuestion",CommonUIStrings.l_FpsInDocSearch_FloodgateWhyQuestion),this.na.$("FpsInDocQna_FloodgatePromptTitle",CommonUIStrings.l_FpsInDocQna_FloodgatePromptTitle),this.na.$("FpsInDocQna_FloodgatePromptQuestion",CommonUIStrings.l_FpsInDocQna_FloodgatePromptQuestion),this.na.$("FpsInDocQna_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("FpsInDocQna_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("FpsInDocQna_FloodgateRatingQuestion",CommonUIStrings.l_FpsInDocQna_FloodgateRatingQuestion),this.na.$("FpsInDocQna_FloodgateRating_1",CommonUIStrings.l_FpsInDocQna_FloodgateRating_1),this.na.$("FpsInDocQna_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2),this.na.$("FpsInDocQna_FloodgateRating_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3),
this.na.$("FpsInDocQna_FloodgateRating_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4),this.na.$("FpsInDocQna_FloodgateRating_5",CommonUIStrings.l_FpsInDocQna_FloodgateRating_5),this.na.$("FpsInDocQna_FloodgateWhyQuestion",CommonUIStrings.l_FpsInDocQna_FloodgateWhyQuestion),this.na.$("AtMentionFPS_Title",CommonUIStrings.l_WAC_AtMentionFPS_Title),this.na.$("AtMentionFPS_Question",CommonUIStrings.l_WAC_AtMentionFPS_Question),this.na.$("AtMentionFPS_YesLabel",CommonUIStrings.l_WAC_AtMentionFPS_YesLabel),
this.na.$("AtMentionFPS_NoLabel",CommonUIStrings.l_WAC_AtMentionFPS_NoLabel),this.na.$("AtMentionFPS_RatingQuestion",CommonUIStrings.l_WAC_AtMentionFPS_RatingQuestion),this.na.$("AtMentionFPS_RatingValue_1",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_1),this.na.$("AtMentionFPS_RatingValue_2",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_2),this.na.$("AtMentionFPS_RatingValue_3",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_3),this.na.$("AtMentionFPS_RatingValue_4",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_4),
this.na.$("AtMentionFPS_RatingValue_5",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_5),this.na.$("AtMentionFPS_WhyQuestion",CommonUIStrings.l_WAC_AtMentionFPS_WhyQuestion),this.na.$("ClientPaginationSurvey_Title",CommonUIStrings.l_WAC_ClientPaginationSurvey_Title),this.na.$("ClientPaginationSurvey_Question",CommonUIStrings.l_WAC_ClientPaginationSurvey_Question),this.na.$("ClientPaginationSurvey_YesLabel",CommonUIStrings.l_WAC_ClientPaginationSurvey_YesLabel),this.na.$("ClientPaginationSurvey_NoLabel",
CommonUIStrings.l_WAC_ClientPaginationSurvey_NoLabel),this.na.$("ClientPaginationSurvey_RatingQuestion",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingQuestion),this.na.$("ClientPaginationSurvey_RatingValue_1",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_1),this.na.$("ClientPaginationSurvey_RatingValue_2",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_2),this.na.$("ClientPaginationSurvey_RatingValue_3",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_3),this.na.$("ClientPaginationSurvey_RatingValue_4",
CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_4),this.na.$("ClientPaginationSurvey_RatingValue_5",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_5),this.na.$("ClientPaginationSurvey_WhyQuestion",CommonUIStrings.l_WAC_ClientPaginationSurvey_WhyQuestion),this.na.$("CIQAtInvokeFPS_Title",CommonUIStrings.l_WAC_CIQAtInvokeFPS_Title),this.na.$("CIQAtInvokeFPS_Question",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("CIQAtInvokeFPS_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.na.$("CIQAtInvokeFPS_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("CIQAtInvokeFPS_RatingQuestion",CommonUIStrings.l_WAC_CIQAtInvokeFPS_RatingQuestion),this.na.$("CIQAtInvokeFPS_RatingValue_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1),this.na.$("CIQAtInvokeFPS_RatingValue_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2),this.na.$("CIQAtInvokeFPS_RatingValue_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3),this.na.$("CIQAtInvokeFPS_RatingValue_4",
CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4),this.na.$("CIQAtInvokeFPS_RatingValue_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5),this.na.$("CIQAtInvokeFPS_WhyQuestion",CommonUIStrings.l_WAC_CIQAtInvokeFPS_WhyQuestion),this.na.$("ConditionalFormatting_PromptLine_1",CommonUIStrings.l_Excel_ConditionalFormatting_PromptLine_1),this.na.$("ConditionalFormatting_PromptLine_2",CommonUIStrings.l_Excel_ConditionalFormatting_PromptLine_2),this.na.$("ConditionalFormatting_PromptLabel_Sure",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("ConditionalFormatting_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ConditionalFormatting_RatingQuestion",CommonUIStrings.l_Excel_ConditionalFormatting_RatingQuestion),this.na.$("ConditionalFormatting_RatingValue_1",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_1),this.na.$("ConditionalFormatting_RatingValue_2",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_2),this.na.$("ConditionalFormatting_RatingValue_3",
CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_3),this.na.$("ConditionalFormatting_RatingValue_4",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_4),this.na.$("ConditionalFormatting_RatingValue_5",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_5),this.na.$("ConditionalFormatting_CommentQuestion",CommonUIStrings.l_Excel_ConditionalFormatting_CommentQuestion),this.na.$("InAppNotification_Title",CommonUIStrings.l_WAC_InAppNotification_Title),this.na.$("InAppNotification_Description",
CommonUIStrings.l_WAC_InAppNotification_Description),this.na.$("InAppNotification_Button1_AddinTab",CommonUIStrings.l_WAC_InAppNotification_Button1_AddinTab),this.na.$("InAppNotification_Button1_AddinButton",CommonUIStrings.l_WAC_InAppNotification_Button1_AddinButton),this.na.$("InAppNotification_Button2",CommonUIStrings.l_WAC_InAppNotification_Button2),this.na.$("BlueDotsFPS_Title",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.na.$("BlueDotsFPS_Question",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),
this.na.$("BlueDotsFPS_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("BlueDotsFPS_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("BlueDotsFPS_RatingQuestion",CommonUIStrings.l_WAC_CatchUpBlueDotsFPS_RatingQuestion),this.na.$("BlueDotsFPS_RatingValue_1",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_1),this.na.$("BlueDotsFPS_RatingValue_2",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_2),this.na.$("BlueDotsFPS_RatingValue_3",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_3),
this.na.$("BlueDotsFPS_RatingValue_4",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_4),this.na.$("BlueDotsFPS_RatingValue_5",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_5),this.na.$("BlueDotsFPS_WhyQuestion",CommonUIStrings.l_WAC_CatchUpBlueDotsFPS_WhyQuestion),this.na.$("WordWebOpeningDocuments_FloodgatePromptTitle",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePromptTitle),this.na.$("WordWebOpeningDocuments_FloodgatePromptQuestion",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePromptQuestion),
this.na.$("WordWebOpeningDocuments_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePrompt_YesLabel),this.na.$("WordWebOpeningDocuments_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePrompt_NoLabel),this.na.$("WordWebOpeningDocuments_FloodgateRatingQuestion",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRatingQuestion),this.na.$("WordWebOpeningDocuments_FloodgateRating_1",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_1),this.na.$("WordWebOpeningDocuments_FloodgateRating_2",
CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_2),this.na.$("WordWebOpeningDocuments_FloodgateRating_3",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_3),this.na.$("WordWebOpeningDocuments_FloodgateRating_4",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_4),this.na.$("WordWebOpeningDocuments_FloodgateRating_5",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_5),this.na.$("WordWebOpeningDocuments_FloodgateTellUsMoreQuestion",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateTellUsMore),
this.na.$("WordCommentReaction_FloodgatePromptTitle",CommonUIStrings.l_WordCommentReaction_FloodgatePromptTitle),this.na.$("WordCommentReaction_FloodgatePromptQuestion",CommonUIStrings.l_WordCommentReaction_FloodgatePromptQuestion),this.na.$("WordCommentReaction_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordCommentReaction_FloodgatePrompt_YesLabel),this.na.$("WordCommentReaction_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordCommentReaction_FloodgatePrompt_NoLabel),this.na.$("WordCommentReaction_FloodgateRatingQuestion",
CommonUIStrings.l_WordCommentReaction_FloodgateRatingQuestion),this.na.$("WordCommentReaction_FloodgateRating_1",CommonUIStrings.l_WordCommentReaction_FloodgateRating_1),this.na.$("WordCommentReaction_FloodgateRating_2",CommonUIStrings.l_WordCommentReaction_FloodgateRating_2),this.na.$("WordCommentReaction_FloodgateRating_3",CommonUIStrings.l_WordCommentReaction_FloodgateRating_3),this.na.$("WordCommentReaction_FloodgateRating_4",CommonUIStrings.l_WordCommentReaction_FloodgateRating_4),this.na.$("WordCommentReaction_FloodgateRating_5",
CommonUIStrings.l_WordCommentReaction_FloodgateRating_5),this.na.$("WordCommentReaction_FloodgateWhyQuestion",CommonUIStrings.l_WordCommentReaction_FloodgateWhyQuestion),this.na.$("GuestCoauthoring_FloodgatePromptTitle",CommonUIStrings.l_WAC_GuestCoauthSurvey_PromptTitle),this.na.$("GuestCoauthoring_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GuestCoauthSurvey_PromptQuestion),this.na.$("GuestCoauthoring_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GuestCoauthSurvey_YesLabel),this.na.$("GuestCoauthoring_FloodgatePrompt_NoLabel",
CommonUIStrings.l_WAC_GuestCoauthSurvey_NoLabel),this.na.$("GuestCoauthoring_FloodgateQuestion",CommonUIStrings.l_WAC_GuestCoauthSurvey_FloodgateQuestion),this.na.$("GuestCoauthoring_FloodgateRatingValue_1",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_1),this.na.$("GuestCoauthoring_FloodgateRatingValue_2",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_2),this.na.$("GuestCoauthoring_FloodgateRatingValue_3",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_3),this.na.$("GuestCoauthoring_FloodgateRatingValue_4",
CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_4),this.na.$("GuestCoauthoring_FloodgateRatingValue_5",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_5),this.na.$("GuestCoauthoring_FloodgateRatingQuestion",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingQuestion),this.na.$("CtrlClickExperience_FloodgatePromptTitle",CommonUIStrings.l_CtrlClickExperience_FloodgatePromptTitle),this.na.$("CtrlClickExperience_FloodgatePromptQuestion",CommonUIStrings.l_CtrlClickExperience_FloodgatePromptQuestion),
this.na.$("CtrlClickExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_CtrlClickExperience_FloodgatePrompt_YesLabel),this.na.$("CtrlClickExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_CtrlClickExperience_FloodgatePrompt_NoLabel),this.na.$("CtrlClickExperience_FloodgateRatingQuestion",CommonUIStrings.l_CtrlClickExperience_FloodgateRatingQuestion),this.na.$("CtrlClickExperience_FloodgateRating_1",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_1),this.na.$("CtrlClickExperience_FloodgateRating_2",
CommonUIStrings.l_CtrlClickExperience_FloodgateRating_2),this.na.$("CtrlClickExperience_FloodgateRating_3",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_3),this.na.$("CtrlClickExperience_FloodgateRating_4",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_4),this.na.$("CtrlClickExperience_FloodgateRating_5",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_5),this.na.$("CtrlClickExperience_FloodgateWhyQuestion",CommonUIStrings.l_CtrlClickExperience_FloodgateWhyQuestion),this.na.$("WordTypingResponsiveness_FloodgatePromptTitle",
CommonUIStrings.l_WordTypingResponsiveness_FloodgatePromptTitle),this.na.$("WordTypingResponsiveness_FloodgatePromptQuestion",CommonUIStrings.l_WordTypingResponsiveness_FloodgatePromptQuestion),this.na.$("WordTypingResponsiveness_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordTypingResponsiveness_FloodgatePrompt_YesLabel),this.na.$("WordTypingResponsiveness_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordTypingResponsiveness_FloodgatePrompt_NoLabel),this.na.$("WordTypingResponsiveness_FloodgateRatingQuestion",
CommonUIStrings.l_WordTypingResponsiveness_FloodgateRatingQuestion),this.na.$("WordTypingResponsiveness_FloodgateRating_1",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_1),this.na.$("WordTypingResponsiveness_FloodgateRating_2",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_2),this.na.$("WordTypingResponsiveness_FloodgateRating_3",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_3),this.na.$("WordTypingResponsiveness_FloodgateRating_4",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_4),
this.na.$("WordTypingResponsiveness_FloodgateRating_5",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_5),this.na.$("WordTypingResponsiveness_FloodgateWhyQuestion",CommonUIStrings.l_WordTypingResponsiveness_FloodgateWhyQuestion),this.na.$("ShareSection_PromptLine_1",CommonUIStrings.l_Excel_ShareSection_PromptLine_1),this.na.$("ShareSection_PromptLine_2",CommonUIStrings.l_Excel_ShareSection_PromptLine_2),this.na.$("ShareSection_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.na.$("ShareSection_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ShareSection_RatingQuestion",CommonUIStrings.l_Excel_ShareSection_RatingQuestion),this.na.$("ShareSection_RatingValue_1",CommonUIStrings.l_Excel_Rating_1_Satisfied),this.na.$("ShareSection_RatingValue_2",CommonUIStrings.l_Excel_Rating_2_Satisfied),this.na.$("ShareSection_RatingValue_3",CommonUIStrings.l_Excel_Rating_3_Satisfied),this.na.$("ShareSection_RatingValue_4",CommonUIStrings.l_Excel_Rating_4_Satisfied),
this.na.$("ShareSection_RatingValue_5",CommonUIStrings.l_Excel_Rating_5_Satisfied),this.na.$("ShareSection_CommentQuestion",CommonUIStrings.l_Excel_ShareSection_CommentQuestion),this.na.$("ShareSection_LinkCreation_PromptLine_1",CommonUIStrings.l_Excel_ShareSection_LinkGeneration_PromptLine_1),this.na.$("WordUnsavedPrompt_FloodgatePromptTitle",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.na.$("WordUnsavedPrompt_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),
this.na.$("WordUnsavedPrompt_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("WordUnsavedPrompt_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("WordUnsavedPrompt_FloodgateRatingQuestion",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRatingQuestion),this.na.$("WordUnsavedPrompt_FloodgateRating_1",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_1),this.na.$("WordUnsavedPrompt_FloodgateRating_2",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_2),
this.na.$("WordUnsavedPrompt_FloodgateRating_3",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_3),this.na.$("WordUnsavedPrompt_FloodgateRating_4",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_4),this.na.$("WordUnsavedPrompt_FloodgateRating_5",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_5),this.na.$("WordUnsavedPrompt_FloodgateWhyQuestion",CommonUIStrings.l_WordUnsavedPrompt_FloodgateWhyQuestion),this.na.$("ExcelLive_PromptLine_1",CommonUIStrings.l_Excel_ExcelLive_PromptLine_1),
this.na.$("ExcelLive_PromptLine_2",CommonUIStrings.l_Excel_ExcelLive_PromptLine_2),this.na.$("ExcelLive_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("ExcelLive_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ExcelLive_RatingQuestion",CommonUIStrings.l_Excel_ExcelLive_RatingQuestion),this.na.$("ExcelLive_RatingValue_1",CommonUIStrings.l_Excel_ExcelLive_RatingValue_1),this.na.$("ExcelLive_RatingValue_2",CommonUIStrings.l_Excel_ExcelLive_RatingValue_2),
this.na.$("ExcelLive_RatingValue_3",CommonUIStrings.l_Excel_ExcelLive_RatingValue_3),this.na.$("ExcelLive_RatingValue_4",CommonUIStrings.l_Excel_ExcelLive_RatingValue_4),this.na.$("ExcelLive_RatingValue_5",CommonUIStrings.l_Excel_ExcelLive_RatingValue_5),this.na.$("ExcelLive_CommentQuestion",CommonUIStrings.l_Excel_ExcelLive_CommentQuestion),this.na.$("SmartViewFormatAsTable_Prompt",CommonUIStrings.l_Excel_SmartViewFormatAsTable_Prompt),this.na.$("SmartViewFormatAsTable_PromptQuestion",CommonUIStrings.l_Excel_SmartViewFormatAsTable_PromptQuestion),
this.na.$("SmartViewFormatAsTable_Rating_Question",CommonUIStrings.l_Excel_SmartViewFormatAsTable_Rating_Question),this.na.$("SmartViewFormatAsTable_RatingValue_1",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_1),this.na.$("SmartViewFormatAsTable_RatingValue_2",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_2),this.na.$("SmartViewFormatAsTable_RatingValue_3",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_3),this.na.$("SmartViewFormatAsTable_RatingValue_4",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_4),
this.na.$("SmartViewFormatAsTable_RatingValue_5",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_5),this.na.$("SmartViewFormatAsTable_WhyQuestion",CommonUIStrings.l_Excel_SmartViewFormatAsTable_WhyQuestion),this.na.$("EaseOfDiscoveringCommand_Floodgate_PromptTitle",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_PromptTitle),this.na.$("EaseOfDiscoveringCommand_Floodgate_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("EaseOfDiscoveringCommand_Floodgate_PromptAnswer_NotNow",
CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("EaseOfDiscoveringCommand_Floodgate_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("EaseOfDiscoveringCommand_Floodgate_RatingQuestion",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingQuestion),this.na.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_1",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_1),this.na.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_2",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_2),
this.na.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_3",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_3),this.na.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_4",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_4),this.na.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_5",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_5),this.na.$("EaseOfDiscoveringCommand_Floodgate_HearMoreQuestion",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_HearMoreQuestion),
this.na.$("EaseOfEditingAndFormatting_Floodgate_PromptTitle",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_PromptTitle),this.na.$("EaseOfEditingAndFormatting_Floodgate_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("EaseOfEditingAndFormatting_Floodgate_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("EaseOfEditingAndFormatting_Floodgate_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("EaseOfEditingAndFormatting_Floodgate_RatingQuestion",
CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingQuestion),this.na.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_1",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_1),this.na.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_2",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_2),this.na.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_3",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_3),this.na.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_4",
CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_4),this.na.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_5",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_5),this.na.$("EaseOfEditingAndFormatting_Floodgate_HearMoreQuestion",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_HearMoreQuestion),this.na.$("EaseOfUse_Floodgate_Prompt_Line1",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Line1),this.na.$("EaseOfUse_Floodgate_Prompt_Line2",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Line2),
this.na.$("EaseOfUse_Floodgate_Prompt_Affirmative_Answer",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Affirmative_Answer),this.na.$("EaseOfUse_Floodgate_Prompt_Negative_Answer",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Negative_Answer),this.na.$("EaseOfUse_Floodgate_Rating_Question",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Question),this.na.$("EaseOfUse_Floodgate_Rating_Scale_1",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_1),this.na.$("EaseOfUse_Floodgate_Rating_Scale_2",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_2),
this.na.$("EaseOfUse_Floodgate_Rating_Scale_3",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_3),this.na.$("EaseOfUse_Floodgate_Rating_Scale_4",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_4),this.na.$("EaseOfUse_Floodgate_Rating_Scale_5",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_5),this.na.$("EaseOfUse_Floodgate_Comment_Question",CommonUIStrings.l_EaseOfUse_Floodgate_Comment_Question),this.na.$("Toolbar_Floodgate_Prompt_Line1",CommonUIStrings.l_Toolbar_Floodgate_Prompt_Line1),
this.na.$("Toolbar_Floodgate_Prompt_Line2",CommonUIStrings.l_Toolbar_Floodgate_Prompt_Line2),this.na.$("Toolbar_Floodgate_Prompt_Affirmative_Answer",CommonUIStrings.l_Toolbar_Floodgate_Prompt_Affirmative_Answer),this.na.$("Toolbar_Floodgate_Prompt_Negative_Answer",CommonUIStrings.l_Toolbar_Floodgate_Prompt_Negative_Answer),this.na.$("Toolbar_Floodgate_Rating_Question",CommonUIStrings.l_Toolbar_Floodgate_Rating_Question),this.na.$("Toolbar_Floodgate_Rating_Scale_1",CommonUIStrings.l_Toolbar_Floodgate_Rating_Scale_1),
this.na.$("Toolbar_Floodgate_Rating_Scale_2",CommonUIStrings.l_Toolbar_Floodgate_Rating_Scale_2),this.na.$("Toolbar_Floodgate_Rating_Scale_3",CommonUIStrings.l_Toolbar_Floodgate_Rating_Scale_3),this.na.$("Toolbar_Floodgate_Rating_Scale_4",CommonUIStrings.l_Toolbar_Floodgate_Rating_Scale_4),this.na.$("Toolbar_Floodgate_Rating_Scale_5",CommonUIStrings.l_Toolbar_Floodgate_Rating_Scale_5),this.na.$("Toolbar_Floodgate_Comment_Question",CommonUIStrings.l_Toolbar_Floodgate_Comment_Question),this.na.$("PerformanceExperience_PromptLine_Sure",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("PerformanceExperience_PromptLine_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("PerformanceExperience_RatingQuestion",fb.Z8b(0)),this.na.$("PerformanceExperience_RatingQuestion_OpenFile",fb.Z8b(1)),this.na.$("PerformanceExperience_RatingQuestion_Responsivness",fb.Z8b(2)),this.na.$("PerformanceExperience_RatingQuestion_OpenFile_CurrentSession",fb.Z8b(3)),this.na.$("PerformanceExperience_RatingQuestion_Responsivness_CurrentSession",
fb.Z8b(4)),this.na.$("PerformanceExperience_RatingValue_1",CommonUIStrings.l_Excel_Rating_1_Satisfied),this.na.$("PerformanceExperience_RatingValue_2",CommonUIStrings.l_Excel_Rating_2_Satisfied),this.na.$("PerformanceExperience_RatingValue_3",CommonUIStrings.l_Excel_Rating_3_Satisfied),this.na.$("PerformanceExperience_RatingValue_4",CommonUIStrings.l_Excel_Rating_4_Satisfied),this.na.$("PerformanceExperience_RatingValue_5",CommonUIStrings.l_Excel_Rating_5_Satisfied),this.na.$("PerformanceExperience_CommentQuestion",
CommonUIStrings.l_Excel_PerformanceExperience_CommentQuestion),this.na.$("CleanData_PromptTitle",CommonUIStrings.l_Excel_CleanData_Survey_PromptTitle),this.na.$("CleanData_PromptQuestion",CommonUIStrings.l_Excel_CleanData_Survey_PromptQuestion),this.na.$("CleanData_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("CleanData_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("CleanData_RatingQuestion",CommonUIStrings.l_Excel_CleanData_Survey_RatingQuestion),
this.na.$("CleanData_RatingValue_1",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_1),this.na.$("CleanData_RatingValue_2",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_2),this.na.$("CleanData_RatingValue_3",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_3),this.na.$("CleanData_RatingValue_4",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_4),this.na.$("CleanData_RatingValue_5",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_5),this.na.$("CleanData_CommentQuestion",CommonUIStrings.l_Excel_CleanData_Survey_CommentQuestion),
this.na.$("DarkModeSurvey_Title",CommonUIStrings.l_WAC_DarkModeSurvey_Title),this.na.$("DarkModeSurvey_Question",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("DarkModeSurvey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("DarkModeSurvey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("DarkModeSurvey_RatingQuestion",CommonUIStrings.l_WAC_DarkModeSurvey_RatingQuestion),this.na.$("DarkModeSurvey_RatingValue_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),
this.na.$("DarkModeSurvey_RatingValue_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.na.$("DarkModeSurvey_RatingValue_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.na.$("DarkModeSurvey_RatingValue_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),this.na.$("DarkModeSurvey_RatingValue_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.na.$("DarkModeSurvey_WhyQuestion",CommonUIStrings.l_WAC_GenericSurvey_WhyThatRatingQuestion),
this.na.$("Fluent2Survey_Title",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Prompt_Line_1),this.na.$("Fluent2Survey_Question",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Prompt_Line_2),this.na.$("Fluent2Survey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("Fluent2Survey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("Fluent2Survey_RatingQuestion",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question),this.na.$("Fluent2Survey_RatingValue_1",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_1),
this.na.$("Fluent2Survey_RatingValue_2",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_2),this.na.$("Fluent2Survey_RatingValue_3",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_3),this.na.$("Fluent2Survey_RatingValue_4",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_4),this.na.$("Fluent2Survey_RatingValue_5",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_5),this.na.$("Fluent2Survey_WhyQuestion",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_CommentQuestion),
this.na.$("Fluent2OptOutSurvey_Title",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Prompt_Line_1),this.na.$("Fluent2OptOutSurvey_Question",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Prompt_Line_2),this.na.$("Fluent2OptOutSurvey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("Fluent2OptOutSurvey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("Fluent2OptOutSurvey_RatingQuestion",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Rating_Question),
this.na.$("Fluent2OptOutSurvey_RatingValue_1",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Rating_Question_Option_1),this.na.$("Fluent2OptOutSurvey_RatingValue_2",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Rating_Question_Option_2),this.na.$("Fluent2OptOutSurvey_WhyQuestion",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_CommentQuestion),this.na.$("ConsumerExperiment_PromptTitle",CommonUIStrings.l_ConsumerExperiment_Floodgate_PromptTitle),this.na.$("ConsumerExperiment_PromptQuestion",
CommonUIStrings.l_ConsumerExperiment_Floodgate_PromptQuestion),this.na.$("ConsumerExperiment_RatingQuestion",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingQuestion),this.na.$("ConsumerExperiment_RatingValue1",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_1),this.na.$("ConsumerExperiment_RatingValue2",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_2),this.na.$("ConsumerExperiment_RatingValue3",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_3),this.na.$("ConsumerExperiment_RatingValue4",
CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_4),this.na.$("ConsumerExperiment_RatingValue5",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_5),this.na.$("ConsumerExperiment_VerbatimQuestion",CommonUIStrings.l_ConsumerExperiment_Floodgate_Verbatim_Question),this.na.$("ConsumerExperiment_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ConsumerExperiment_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("AIMakerSurvey_Title",CommonUIStrings.l_AIMakerSurvey_Title),
this.na.$("AIMakerSurvey_Question",CommonUIStrings.l_AIMakerSurvey_Question),this.na.$("AIMakerSurvey_YesLabel",CommonUIStrings.l_AIMakerSurvey_YesLabel),this.na.$("AIMakerSurvey_NoLabel",CommonUIStrings.l_AIMakerSurvey_NoLabel),this.na.$("AIMakerSurvey_RatingQuestion",CommonUIStrings.l_AIMakerSurvey_RatingQuestion),this.na.$("AIMakerSurvey_MinRating",CommonUIStrings.l_AIMakerSurvey_MinRating),this.na.$("AIMakerSurvey_MaxRating",CommonUIStrings.l_AIMakerSurvey_MaxRating),this.na.$("AIMakerSurvey_CommentQuestion",
CommonUIStrings.l_AIMakerSurvey_CommentQuestion),this.na.$("CheckPerformance_Prompt",CommonUIStrings.l_Excel_CheckPerformance_Prompt),this.na.$("CheckPerformance_PromptQuestion",CommonUIStrings.l_Excel_CheckPerformance_PromptQuestion),this.na.$("CheckPerformance_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("CheckPerformance_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("CheckPerformance_RatingQuestion",CommonUIStrings.l_Excel_CheckPerformance_RatingQuestion),
this.na.$("CheckPerformance_RatingValue_1",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_1),this.na.$("CheckPerformance_RatingValue_2",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_2),this.na.$("CheckPerformance_RatingValue_3",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_3),this.na.$("CheckPerformance_RatingValue_4",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_4),this.na.$("CheckPerformance_RatingValue_5",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_5),this.na.$("CheckPerformance_CommentQuestion",
CommonUIStrings.l_Excel_CheckPerformance_CommentQuestion),this.na.$("SmartSuggestion_PromptTitle",CommonUIStrings.l_Excel_SmartSuggestion_Survey_PromptTitle),this.na.$("SmartSuggestion_PromptQuestion",CommonUIStrings.l_Excel_SmartSuggestion_Survey_PromptQuestion),this.na.$("SmartSuggestion_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("SmartSuggestion_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("SmartSuggestion_RatingQuestion",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingQuestion),
this.na.$("SmartSuggestion_RatingValue_1",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_1),this.na.$("SmartSuggestion_RatingValue_2",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_2),this.na.$("SmartSuggestion_RatingValue_3",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_3),this.na.$("SmartSuggestion_RatingValue_4",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_4),this.na.$("SmartSuggestion_RatingValue_5",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_5),
this.na.$("SmartSuggestion_CommentQuestion",CommonUIStrings.l_Excel_SmartSuggestion_Survey_CommentQuestion),this.na.$("PPTO_Picture_FloodgatePromptTitle",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.na.$("PPTO_Picture_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("PPTO_Picture_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("PPTO_Picture_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),
this.na.$("PPTO_Picture_FloodgateRatingQuestion",CommonUIStrings.l_PPTO_Picture_FloodgateRatingQuestion),this.na.$("PPTO_Picture_FloodgateRating_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.na.$("PPTO_Picture_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.na.$("PPTO_Picture_FloodgateRating_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.na.$("PPTO_Picture_FloodgateRating_4",CommonUIStrings.l_PPTO_Picture_FloodgateRating_4_SomewhatSatisfied),
this.na.$("PPTO_Picture_FloodgateRating_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.na.$("PPTO_Picture_FloodgateWhyQuestion",CommonUIStrings.l_PPTO_Picture_FloodgateWhyQuestion),this.na.$("CCPExperience_FloodgatePromptTitle",CommonUIStrings.l_CCPExperience_FloodgatePromptTitle),this.na.$("CCPExperience_FloodgatePromptQuestion",CommonUIStrings.l_CCPExperience_FloodgatePromptQuestion),this.na.$("CCPExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_CCPExperience_FloodgatePrompt_YesLabel),
this.na.$("CCPExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_CCPExperience_FloodgatePrompt_NoLabel),this.na.$("CCPExperience_FloodgateRatingQuestion",CommonUIStrings.l_CCPExperience_FloodgateRatingQuestion),this.na.$("CCPExperience_FloodgateRating_1",CommonUIStrings.l_CCPExperience_FloodgateRating_1),this.na.$("CCPExperience_FloodgateRating_2",CommonUIStrings.l_CCPExperience_FloodgateRating_2),this.na.$("CCPExperience_FloodgateRating_3",CommonUIStrings.l_CCPExperience_FloodgateRating_3),this.na.$("CCPExperience_FloodgateRating_4",
CommonUIStrings.l_CCPExperience_FloodgateRating_4),this.na.$("CCPExperience_FloodgateRating_5",CommonUIStrings.l_CCPExperience_FloodgateRating_5),this.na.$("CCPExperience_FloodgateWhyQuestion",CommonUIStrings.l_CCPExperience_FloodgateWhyQuestion),this.na.$("FRE_FirstTeachingCalloutTitle",CommonUIStrings.l_FRE_FirstTeachingCalloutTitle),this.na.$("FRE_FirstTeachingCalloutDescription",CommonUIStrings.l_FRE_FirstTeachingCalloutDescription),this.na.$("FRE_TeachingCalloutNextButtonText",CommonUIStrings.l_FRE_TeachingCalloutNextButtonText),
this.na.$("FRE_SecondTeachingCalloutTitle",CommonUIStrings.l_FRE_SecondTeachingCalloutTitle),this.na.$("FRE_SecondTeachingCalloutDescription",CommonUIStrings.l_FRE_SecondTeachingCalloutDescription),this.na.$("FRE_ThirdTeachingCalloutTitle",CommonUIStrings.l_FRE_ThirdTeachingCalloutTitle),this.na.$("FRE_ThirdTeachingCalloutDescription",CommonUIStrings.l_FRE_ThirdTeachingCalloutDescription),this.na.$("FRE_TeachingCalloutGotItButtonText",CommonUIStrings.l_FRE_TeachingCalloutGotItButtonText),this.na.$("FloodgateSurveyNoRealEditPromptTitle",
CommonUIStrings.l_FloodgateSurveyNoRealEditPromptTitle),this.na.$("FloodgateSurveyNoRealEditPromptQuestion",CommonUIStrings.l_FloodgateSurveyNoRealEditPromptQuestion),this.na.$("FloodgateSurveyNoRealEditSure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("FloodgateSurveyNoRealEditNotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("FloodgateSurveyNoRealEditQuestion1",CommonUIStrings.l_FloodgateSurveyNoRealEditQuestion1),this.na.$("FloodgateSurveyNoRealEditOption1",CommonUIStrings.l_FloodgateSurveyNoRealEditOption1),
this.na.$("FloodgateSurveyNoRealEditOption2",CommonUIStrings.l_FloodgateSurveyNoRealEditOption2),this.na.$("FloodgateSurveyNoRealEditOption3",CommonUIStrings.l_FloodgateSurveyNoRealEditOption3),this.na.$("FloodgateSurveyNoRealEditOption4",CommonUIStrings.l_FloodgateSurveyNoRealEditOption4),this.na.$("FloodgateSurveyNoRealEditOption5",CommonUIStrings.l_FloodgateSurveyNoRealEditOption5),this.na.$("FloodgateSurveyNoRealEditQuestion2",CommonUIStrings.l_FloodgateSurveyNoRealEditQuestion2),this.na.$("FormulaByExample_PromptTitle",
CommonUIStrings.l_Excel_FormulaByExample_Survey_PromptTitle),this.na.$("FormulaByExample_PromptQuestion",CommonUIStrings.l_Excel_FormulaByExample_Survey_PromptQuestion),this.na.$("FormulaByExample_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("FormulaByExample_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("FormulaByExample_RatingQuestion",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingQuestion),this.na.$("FormulaByExampleIgnored_RatingQuestion",
CommonUIStrings.l_Excel_FormulaByExampleIgnored_Survey_RatingQuestion),this.na.$("FormulaByExample_RatingValue_1",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_1),this.na.$("FormulaByExample_RatingValue_2",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_2),this.na.$("FormulaByExample_RatingValue_3",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_3),this.na.$("FormulaByExample_RatingValue_4",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_4),this.na.$("FormulaByExample_RatingValue_5",
CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_5),this.na.$("FormulaByExample_CommentQuestion",CommonUIStrings.l_Excel_FormulaByExample_Survey_CommentQuestion),this.na.$("FormulaByExampleDeclined_CommentQuestion",CommonUIStrings.l_Excel_FormulaByExampleDeclined_Survey_CommentQuestion),this.na.$("CIQSeenNotKeptFPS_Title",CommonUIStrings.l_WAC_CIQSeenNotKeptFPS_Title),this.na.$("CIQSeenNotKeptFPS_Question",CommonUIStrings.l_WAC_CIQSeenNotKeptFPS_Question),this.na.$("CIQSeenNotKeptFPS_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("CIQSeenNotKeptFPS_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("CIQSeenNotKeptFPS_RatingQuestion",CommonUIStrings.l_WAC_CIQSeenNotKeptFPS_RatingQuestion),this.na.$("CIQSeenNotKeptFPS_RatingValue_Yes",CommonUIStrings.l_DialogYes),this.na.$("CIQSeenNotKeptFPS_RatingValue_No",CommonUIStrings.l_DialogNo),this.na.$("CIQSeenNotKeptFPS_WhyQuestion",CommonUIStrings.l_WAC_CIQSeenNotKeptFPS_WhyQuestion),this.na.$("FloodgateSurveyProofingSuggestions_PromptTitle",
CommonUIStrings.l_FloodgateSurveyProofingSuggestionsPromptTitle),this.na.$("FloodgateSurveyProofingSuggestions_PromptQuestion",CommonUIStrings.l_FloodgateSurveyProofingSuggestionsPromptQuestion),this.na.$("FloodgateSurveyProofingSuggestions_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("FloodgateSurveyProofingSuggestions_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("FloodgateSurveyProofingSuggestions_WhyQuestion",CommonUIStrings.l_FloodgateSurveyProofingSuggestionsPromptQuestion1),
this.na.$("FloodgateSurveyProofingSuggestions_Option_1",CommonUIStrings.l_FloodgateSurveyProofingSuggestionsOption1),this.na.$("FloodgateSurveyProofingSuggestions_Option_2",CommonUIStrings.l_FloodgateSurveyProofingSuggestionsOption2),this.na.$("FloodgateSurveyProofingSuggestions_Option_3",CommonUIStrings.l_FloodgateSurveyProofingSuggestionsOption3),this.na.$("FloodgateSurveyProofingSuggestions_Option_4",CommonUIStrings.l_FloodgateSurveyProofingSuggestionsOption4),this.na.$("FloodgateSurveyProofingSuggestions_Option_5",
CommonUIStrings.l_FloodgateSurveyProofingSuggestionsOption5),this.na.$("FloodgateSurveyProofingSuggestions_AdditionalDetailsQuestion",CommonUIStrings.l_FloodgateSurveyProofingSuggestionsPromptQuestion2),this.na.$("MultiColumnsSurvey_Title",CommonUIStrings.l_WAC_MultiColumnsSurvey_Title),this.na.$("MultiColumnsSurvey_Question",CommonUIStrings.l_WAC_MultiColumnsSurvey_Question),this.na.$("MultiColumnsSurvey_YesLabel",CommonUIStrings.l_WAC_MultiColumnsSurvey_YesLabel),this.na.$("MultiColumnsSurvey_NoLabel",
CommonUIStrings.l_WAC_MultiColumnsSurvey_NoLabel),this.na.$("MultiColumnsSurvey_RatingQuestion",CommonUIStrings.l_WAC_MultiColumnsSurvey_RatingQuestion),this.na.$("MultiColumnsSurvey_RatingValue_1",CommonUIStrings.l_WAC_MultiColumnsSurvey_RatingValue_1),this.na.$("MultiColumnsSurvey_RatingValue_5",CommonUIStrings.l_WAC_MultiColumnsSurvey_RatingValue_5),this.na.$("MultiColumnsSurvey_ImproveQuestion",CommonUIStrings.l_WAC_MultiColumnsSurvey_ImproveQuestion)}catch(Ta){h.ULS.sendTraceTag(594052319,356,
15,"SIFB.InitializeUIStringGetter error "+(Ta?Ta.toString():""))}}static fSi(Ta){try{return new Promise(ib=>{window.setTimeout(()=>{ib(null)},Ta)})}catch(ib){return h.ULS.sendTraceTag(578348238,356,50,"SIFB Info: Floodgate init delay not possible in DelayCustomMs"),Promise.resolve(null)}}static A7f(){return!m.AFrameworkApplication.fa.ka("FloodgateGovernanceServiceIsDisabled")}static woj(){return m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePrioritySurveyEnabled",
!1)}static IYi(){return m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableWebCampaignGovernance",!1)}static P_d(Ta){const ib=Ta?Ta[0]:null;h.ULS.sendTraceTag(512505556,356,50,"SIFB Info:ConvertAndShowTeachingUx - "+(ib?ib.surfaceId:""));if(ib&&"customsurface"===(ib&&ib.surfaceType?ib.surfaceType.toLocaleLowerCase():null)){const ob=va.a.aGj(ib);if(ob)return h.ULS.sendTraceTag(555071522,356,50,"SIFB Info:Floodgate activation result - "+ob+", "+ib.surfaceId),null}return wb.P_d(Ta)}static Shj(){const Ta=
{};Ta.retry=m.AFrameworkApplication.fa.wc("FloodgateGovernanceServiceRetryCount",0);Ta.timeout=m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateGovernanceServiceTimeoutInMs",1E4);Ta.simpleRequestEnabled=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateGovernanceServiceSimpleRequestEnabled",!1);Ta.forceServicelessSurveyDisplay=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateGovernanceServiceForceServicelessSurveyDisplayEnabled",
!1);return Ta}static NJi(Ta){if(!("Unknown"!==Ta&&"Automation"!==Ta&&m.AFrameworkApplication.fa.ka("FloodgateAuthCallbackIsEnabled")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateLocalMessagingEnabled",!1)))return h.ULS.sendTraceTag(50423047,356,50,"SIFB Info:Floodgate authCallback not enabled "+Ta),null;Ta={};Ta.getUserPuid=fb.swj;m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PersonalizationOAuthManagerEnabled",!1)&&(Ta.getAuthToken=
fb.getAuthToken);return Ta}static getAuthToken(Ta){return Ta&&Ta.scenario?"tulips"===Ta.scenario.toLowerCase()?Db.pal():null:(h.ULS.sendTraceTag(508905240,356,50,"SIFB Invalid authCallback params"),null)}static LJi(){const Ta={},ib=!m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAugLoopRuntimeIsDisabled",!1)&&(m.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAugLoopRuntimeIsEnabled",
!1));Ta.isEnabled=ib;return Ta}static swj(){return m.AFrameworkApplication.fa.Ha("Puid")}static Y$d(Ta){if(!Ta||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableFloodgateTriggerFlightIdLog",!1))return null;try{const ib=(m.AFrameworkApplication.fa.Ha("FlightId")||"").toLocaleLowerCase(),ob=Ta.toString().toLocaleLowerCase().split(";");for(const fc of ob)if(-1!==ib.indexOf(fc))return fc}catch(ib){h.ULS.sendTraceTag(508961431,306,50,"Error retrieving flightId of campaign event -"+
(ib?ib.toString():""))}return null}static sdg(){return va.a.kva()?CommonUIStrings.l_WAC_NPS_RatingQuestion_WordForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_Word}static rdg(){return va.a.kva()?CommonUIStrings.l_WAC_NPS_RatingQuestion_PowerPointForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_PowerPoint}static qdg(){return va.a.kva()&&m.AFrameworkApplication.fa.ka("ExcelNpsForTeamsQuestionIsEnabled")?CommonUIStrings.l_WAC_NPS_RatingQuestion_ExcelForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_Excel}static Z8b(Ta){if(va.a.kva())switch(Ta){case 1:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_OpenFile;
case 2:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_Responsivness;case 3:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_OpenFile_CurrentSession;case 4:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_Responsivness_CurrentSession;default:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion}switch(Ta){case 1:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_OpenFile;case 2:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_Responsivness;
case 3:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_OpenFile_CurrentSession;case 4:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_Responsivness_CurrentSession;default:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion}}static oxj(){return va.a.kva()&&m.AFrameworkApplication.fa.ka("NpsOneNoteForTeamsQuestionIsEnabled")?CommonUIStrings.l_WAC_NPS_RatingQuestion_OneNoteForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_OneNote}static qxj(){return va.a.kva()?
CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionForTeams:CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestion}static pxj(){return va.a.kva()?CommonUIStrings.l_OnenotePerf_FloodgatePromptTitleForTeams:CommonUIStrings.l_OnenotePerf_FloodgatePromptTitle}static rxj(){switch(m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.Designer.SmartPasteInCCPFloatieExperience",0)){case 1:return CommonUIStrings.l_WordDesigner_FormatWithDesignerFeedbackRatingQuestion;case 2:return CommonUIStrings.l_WordDesigner_MatchDocumentFormattingFeedbackRatingQuestion;
case 3:return CommonUIStrings.l_WordDesigner_UseSmartPasteFeedbackRatingQuestion;default:return""}}}fb.xhb="SystemInitiatedFeedbackIsEnabled";fb.Awi="obf-CampaignDefinitions";fb.DRf=100;fb.LRi=8002;Object(K.a)(fb,"SystemInitiatedFeedback",null,[1320]);class ac{constructor(Ta){if(!Ta)throw Error.argumentNull("SystemInitiatedFeedback is null");this.ntf=Ta;this.zAd={};this.jyc={};this.wAd={}}logActivity(Ta,ib,ob){const fc=new Date;if(!Ta||!this.ntf.q$a(Ta,fb.xhb,ib))return!1;let Jb=null;Ta in this.zAd&&
(Jb=this.zAd[Ta]);const xc=this.I$i(Ta),ic=this.H$i(Ta);if(this.eZi(Jb,fc,ob))return h.ULS.sendTraceTag(39924675,356,50,"SIFB with time lapse: skipped {0} {1} log(s)",xc,Ta),this.ntf.logActivity(Ta,ib),this.zAd[Ta]=fc,this.jyc[Ta]=0,this.wAd[Ta]=ic+1,!0;this.jyc[Ta]=xc+1;return!1}eZi(Ta,ib,ob){return Ta?ib.getTime()-Ta.getTime()>=1E3*ob:!0}I$i(Ta){let ib=0;Ta in this.jyc&&(ib=this.jyc[Ta]);return ib}H$i(Ta){let ib=0;Ta in this.wAd&&(ib=this.wAd[Ta]);return ib}}Object(K.a)(ac,"SystemInitiatedFeedbackWithTimeLapse",
null,[1318]);var Dc=d(95),Sc=d(71);d.d(U,"CustomerFeedbackPackage",function(){return xb});class xb{constructor(){this.Qdf=this.Da=null}get name(){return"Common.App.CustomerFeedback"}Yb(Ta){m.AFrameworkApplication.Rg||(h.ULS.sendTraceTag(51385996,356,15,"DataPlumber is null. Recreate it"),m.AFrameworkApplication.Rg=new z.a);Ta.register(S,"Common.App.CustomerFeedback.CustomerFeedbackResourceDownloadManager").as("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager").ma();Ta.register(oa,
"Common.App.CustomerFeedback.CustomerFeedbackUiWrapper").as("Common.App.ICustomerFeedbackUiWrapper").ma().oa(()=>new oa(Dc.FocusManager.instance(),m.AFrameworkApplication.Rg));Ta.register(G,"Common.App.CustomerFeedback.CustomerFeedbackC3FormManager").as("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").ma().oa(()=>new G(Ta.resolve("Common.App.ICustomerFeedbackUiWrapper"),Ta.resolve("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"),m.AFrameworkApplication.Rg));Ta.register(1235,
"Common.ICustomerFeedbackActor").ma().oa(()=>new J(m.AFrameworkApplication.Ra,m.AFrameworkApplication.Aa,Ta.Ia("Common.App.CustomerFeedback.ICustomerFeedbackFormManager"),m.AFrameworkApplication.fa,m.AFrameworkApplication.Rg));Ta.register(fb,"Common.App.CustomerFeedback.SystemInitiatedFeedback").as("Common.ISystemInitiatedFeedback").ma().oa(()=>new fb(Ta.resolve("Common.App.ICustomerFeedbackUiWrapper")));Ta.register(ac,"Common.App.CustomerFeedback.SystemInitiatedFeedbackWithTimeLapse").as("Common.ISystemInitiatedFeedbackWithTimeLapse").ma().oa(()=>
new ac(Ta.resolve("Common.ISystemInitiatedFeedback")));this.Da=Ta}init(){xb._initialized||(xb.Mcc()||(this.Qdf=this.Da.resolve("Common.ICustomerFeedbackActor"),this.Qdf.vb(),m.AFrameworkApplication.Aa.updateCommandUI()),this.Da.Ia("Common.App.IAppSpecificFeedbackData").execute(()=>{this.Da.resolve("Common.App.CustomerFeedback.SystemInitiatedFeedback");this.Da.resolve("Common.App.CustomerFeedback.SystemInitiatedFeedbackWithTimeLapse")}),xb._initialized=!0)}dispose(){}static Mcc(){return!!m.AFrameworkApplication.Aa&&
!!m.AFrameworkApplication.Aa.ob&&3===m.AFrameworkApplication.Aa.ob.zk&&1===m.AFrameworkApplication.Aa.ob.LJa}static main(){let Ta=!1;xb.Mcc()&&(Ta=!0);Sc.a.instance.Ac(new xb,0,Ta)}}xb._initialized=!1;Object(K.a)(xb,"CustomerFeedbackPackage",null,[2,3])},1191:function(K,U,d){K=d(0);var h=d(7),e=d(36);class r{constructor(){this.classId=0}static q9a(x){try{return e.a(x)}catch(B){}return null}}Object(K.a)(r,"ARoamingAppsResponse",null,[]);class m{constructor(){this.state=this.callback=null;this.Dne=
!1}}Object(K.a)(m,"GetRoamingAppsLauncherContext",null,[]);var n=d(27),z=d(82);d.d(U,"a",function(){return v});class v{constructor(x){this.lCd=!1;this.V7=v.Abb;this.rNd=this.QKd=0;this.platform=null;this.l6h=x;this.ovf=this.sNd=!1}get tXe(){return this.l6h}get aSl(){return this.tXe&&this.sNd?this.ovf:!1}Uzi(){n.AFrameworkApplication.xbc&&this.tXe&&!this.sNd&&!this.lCd&&(this.rNd=3,this.lCd=!0,this.ebl(),this.AYf())}ebl(){this.V7=v.Abb;this.QKd=0}getRoamingAppsLauncher(x,B,D){this.aSl?(x=new m,x.callback=
B,x.state=D,x.Dne=!0,this.FYf(x)):B(!1,"",D)}AYf(){const x=new (d(1157).CheckRoamingRightsRequest);x.RoamingApp=this.rNd;x.BaseDocQuerySignature=n.AFrameworkApplication.gh;x.execute(Object(h.a)(this,this.Wzi,"checkUserRoamingRightsSucceeded"),Object(h.a)(this,this.Vzi,"checkUserRoamingRightsFailed"),null)}Wzi(x){n.AFrameworkApplication.Yg||((x=r.q9a(x.data.ee))?this.b0e(x.HasRights):this.b0e(!1))}Vzi(){if(!n.AFrameworkApplication.Yg)if(this.QKd>=v.avk)this.b0e(!1);else{var x=new z.a(2,1,this.V7,Object(h.a)(this,
this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);n.AFrameworkApplication.Ae.Hb(x);this.QKd++;this.V7*=v.hXe;this.V7>v.klc&&(this.V7=v.klc)}}b0e(x){this.ovf=x;this.sNd=!0;this.lCd=!1}retryCheckUserRoamingRights(){this.AYf()}FYf(x){const B=new (d(1158).GetRoamingLauncherRequest);B.RoamingApp=this.rNd;B.BaseDocQuerySignature=n.AFrameworkApplication.gh;B.execute(Object(h.a)(this,this.Ppj,"getRoamingAppsLauncherSucceeded"),Object(h.a)(this,this.Opj,"getRoamingAppsLauncherFailed"),x)}Ppj(x){if(!n.AFrameworkApplication.Yg){var B=
r.q9a(x.data.ee);x=x.data.state;B?(this.platform=B.Platform,x.callback(!0,B.Launcher,x.state)):x.callback(!1,"",x.state)}}Opj(x){if(!n.AFrameworkApplication.Yg){var B=x.data.state;5===x.data.status&&B.Dne?(B.Dne=!1,this.FYf(B)):B.callback(!1,"",B.state)}}static get instance(){return v.Vt||(v.Vt=new v(n.AFrameworkApplication.Ymi))}}v.Abb=1E3;v.hXe=5;v.klc=12E5;v.avk=5;v.Vt=null;Object(K.a)(v,"RoamingAppsManager",null,[])},1192:function(K,U,d){K=d(0);var h=d(7),e=d(974),r=d(67);class m extends e.a{constructor(w,
J,G,M,N,R=null){super(w,G,N.nS,R);this.Anf=0;this.Hba=this.ulj(M);this.hsb=J;this.Xh=N;this.p6e=7;this.ns=this.hsb.ownerDocument.createElement("div");this.ns.className="ModalCalloutControlOverlay";this.ns.tabIndex=0;this.hsb.insertBefore(this.ns,this.hsb.firstChild)}show(){this.TL||(this.Xh.hjb(),this.Xh.iRa(!1),this.ns.style.zIndex=String(this.Xh.Sra),super.show(),this.Gt(),this.Anf=window.setTimeout(Object(h.a)(this,this.dismiss,"dismiss"),1E3*this.p6e))}dismiss(){this.TL&&(this.Xh.TSa(!1),this.Vpa(),
this.hsb&&this.hsb.contains(this.ns)&&this.hsb.removeChild(this.ns),super.dismiss(),window.clearTimeout(this.Anf))}Gt(){this.Xh.Nca(Object(h.a)(this,this.dismiss,"dismiss"));this.Xh.Wy.rb(r.a.click,this.ns,Object(h.a)(this,this.onClick,"onClick"))}Vpa(){this.Xh.iLa(Object(h.a)(this,this.dismiss,"dismiss"));this.Xh.Wy.Bb(r.a.click,this.ns,Object(h.a)(this,this.onClick,"onClick"))}onClick(){this.dismiss();return!0}ulj(w){let J=0;switch(w){case 0:J=190;break;case 1:J=250;break;case 2:J=300;break;case 3:J=
360}return J}}Object(K.a)(m,"ModalCallout",e.a,[]);var n=d(392),z=d(356),v=d(141);class x extends m{constructor(w,J,G,M,N,R=null){super(w,J,G,M,N,R);this.ZDc=null}show(){if(!this.TL){const w=Object.assign(new z.a,{onShow:()=>{m.prototype.show.call(this)}});v.UISurfaces.FL().then(J=>{const G=J.externalNotification();this.ZDc=J.addNotification(G,w);return null},J=>{n.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",J);return null})}}dismiss(){this.TL&&this.ZDc&&(v.UISurfaces.FL().then(w=>
{w.removeNotification(this.ZDc);return this.ZDc=null},w=>{n.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",w);return null}),super.dismiss())}}Object(K.a)(x,"ReactManagedModalCallout",m,[]);var B=d(27);d.d(U,"a",function(){return D});class D{static Y0d(w,J,G,M,N=null){return B.AFrameworkApplication.Aa.ob.bWa?new x(w,J,G,M,B.AFrameworkApplication.Aa,N):new m(w,J,G,M,B.AFrameworkApplication.Aa,N)}}Object(K.a)(D,"ModalCalloutControlFactory",null,[])},1193:function(K,U,d){d.r(U);
K=d(0);var h=d(527),e=d(528);class r{constructor(v){this.WP=this.Mcf=h.a.unused;this.wGc=v}get Pub(){return this.Mcf}QKe(v,x,B,D){B===this.wGc.element&&(this.Mcf=v,this.WP=D+this.wGc.offset)}OMe(){}RWd(v){return this.Pub!==h.a.unused?Object.assign(new e.a,{element:v,offset:this.WP}):null}}Object(K.a)(r,"ChildSelectionHelper",null,[1461]);class m{constructor(v,x){this.iKd=!1;this.wGc=x;this._parent=v;this.WP=x.offset}get Pub(){return h.a.unused}QKe(v,x,B,D){x||this.wGc.offset!==v||(this.WP=D,this.iKd=
!0)}OMe(v,x){!this.iKd&&this.WP>x&&(this.WP-=x-v+1)}RWd(v){return Object.assign(new e.a,{element:this.iKd?v:this._parent,offset:this.WP})}}Object(K.a)(m,"ParentSelectionHelper",null,[1461]);var n=d(929);d.d(U,"CombineHelper",function(){return z});class z{constructor(v,x,B){this.Fff=h.a.unused;this.RSb="";this._element=v;this.WYb=x;this.wYb=this.m5f(v,B.start);this.tYb=this.m5f(v,B.end)}m5f(v,x){return x.element===v?new m(v,x):new r(x)}mei(v){const x=v===this.WYb,B=this._element.childNodes[v],D=this.RSb.length;
this.wYb.QKe(v,x,B,D);this.tYb.QKe(v,x,B,D);this.RSb+=B.nodeValue}end(v,x){this.WYb!==x&&(this.Fff=x,Array.add(v,this))}dDi(){var v=this.poj();this.snh(this.WYb,v-1);this.snh(v+1,this.Fff);v=this._element.childNodes[this.WYb];this.RSb!==v.nodeValue&&(v.nodeValue=this.RSb);return this.eti(v)}snh(v,x){if(!(x<v)){this.wYb.OMe(v,x);this.tYb.OMe(v,x);for(let B=v;B<=x;B++)this._element.removeChild(this._element.childNodes[v])}}eti(v){return Object.assign(new n.a,{start:this.wYb.RWd(v),end:this.tYb.RWd(v)})}poj(){return this.wYb.Pub!==
h.a.unused?this.wYb.Pub:this.tYb.Pub!==h.a.unused?this.tYb.Pub:this.WYb}}Object(K.a)(z,"CombineHelper",null,[])},1198:function(K,U,d){K=d(0);var h=d(1243),e=d(392),r=d(27),m=d(82),n=d(72);class z{static txj(){if(!z.qyc&&(z.qyc=new n.a,r.AFrameworkApplication.fa&&r.AFrameworkApplication.fa.Lu("AggregatorIdDisabledList"))){const B=r.AFrameworkApplication.fa.eA("AggregatorIdDisabledList");for(let D=0;D<B.length;D++)z.qyc.$(B[D],!0)}return z.qyc}}z.qyc=null;Object(K.a)(z,"DisabledAggregatorListStore",
null,[]);var v=d(284);d.d(U,"a",function(){return x});class x{constructor(B,D,w,J,G,M=!0,N=null){this.Fef=this.Stf=this.Tkf=!1;this.Zd=null;if(!B)throw v.a.argument("taskManagerLazy");if(!G)throw v.a.argument("dataAggregator");this.O8h=B;this.dLd=D;this._id=w;this.Vif=6E4*J;this.Zzc=G;this.mrf=M;this.jYb=N;z.txj().Fb(this._id.toString())&&(this.Fef=!0)}get taskManager(){return this.Zd||(this.Zd=this.O8h.value)}track(B,D=null){this.Fef||(this.x_i(),this.zfl(),this.Zzc.I_b(B,D))}zfl(){!this.Tkf&&0<
this.Vif&&(this.Tkf=!0,this.ouh())}ouh(){const B=new m.a(5,1,this.Vif,()=>{this.ihl()},19,this._id.toString());this.taskManager.Hb(B)}ihl(){!this.jYb||this.jYb.T0e()?this.zrd():this.mrf&&this.Zzc.reset();this.ouh()}zrd(){const B=this.Zzc.getData();if(B){const D=parseInt(String(B.length));if(isNaN(D)||0<D)this.Avh(B),this.mrf&&this.Zzc.reset()}}Avh(B){e.ULS.sendTraceTag(7079840,335,50,"Aggregator: {0}",{["ID"]:this._id.toString(),["Data"]:B})}x_i(){this.Stf||(this.dLd(()=>{this.zrd()}),this.Stf=!0)}static Fr(B,
D,w,J,G){return new x(new h.a(()=>r.AFrameworkApplication.Ae),r.AFrameworkApplication.Wga,B,D,w,J,G)}static PW(B,D,w,J=!0){return x.Fr(B,D,w,J,null)}}Object(K.a)(x,"Aggregator",null,[1361])},126:function(K,U,d){d.d(U,"a",function(){return h});d.d(U,"b",function(){return e});const h=r=>null===r||"undefined"===typeof r||!r.length,e=r=>null===r||"undefined"===typeof r},1272:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);var h;(function(e){e[e.chrome=0]="chrome";e[e.edge=1]="edge";e[e.firefox=
2]="firefox";e[e.IE=3]="IE";e[e.safari=4]="safari";e[e.others=5]="others";e[e.unknown=6]="unknown";e[e.electron=7]="electron";e[e.chromiumEdge=8]="chromiumEdge";e[e.teamsElectron=9]="teamsElectron"})(h||(h={}));Object(K.b)("BrowserCode",h)},1273:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.value=!1}}Object(K.a)(h,"OutBool",null,[])},1274:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.Alt=this.DisplayColor=this.Color=null}}Object(K.a)(h,
"ColorCellProps",null,[])},1275:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);d=d(360);class h extends d.a{constructor(){super();this.Style=this.Character=null}get Type(){return 1}}Object(K.a)(h,"CharacterCodeGalleryButtonProps",d.a,[])},1276:function(K,U,d){d.d(U,"a",function(){return e});K=d(0);var h=d(521);class e{constructor(r){this.ada=r}cZe(r){return h.a.then(this.ada.Csb(r,1,"",{"Content-Type":"application/json; charset=utf-8"},0,void 0,void 0,void 0,void 0,void 0,"2"),m=>this.Hpj(m))}Hpj(r){return r&&
r.uj&&r.uj.data?r.uj.data.ee:null}}Object(K.a)(e,"SimpleRequestManager",null,[1529])},1277:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);d=d(299);class h{}h.LabelText=d.a.labelText;h.Alt=d.a.alt;h.Image16by16Class=d.a.Qzb;h.Image32by32Class=d.a.wFa;h.Image48by48Class=d.a.dhe;h.Visible=d.a.visible;h.HasPopup="HasPopup";Object(K.a)(h,"ButtonCommandProperties",null,[])},1278:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);var h;(function(e){e[e.horizontal=0]="horizontal";e[e.vertical=
1]="vertical"})(h||(h={}));Object(K.b)("Orientation",h)},1279:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);var h;(function(e){e[e.isEnabled=1]="isEnabled";e[e.execute=2]="execute";e[e.animation=3]="animation"})(h||(h={}));Object(K.b)("ActionBehavior",h)},1280:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);var h;(function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS";e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid";e[e.msoulscat_ES_EWAJSHeaderResize=2]="msoulscat_ES_EWAJSHeaderResize";
e[e.msoulscat_ES_EWAJSKeyboard=3]="msoulscat_ES_EWAJSKeyboard";e[e.msoulscat_ES_EWAJSTest=4]="msoulscat_ES_EWAJSTest";e[e.msoulscat_ES_EWAJSFloatingObjects=5]="msoulscat_ES_EWAJSFloatingObjects";e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart";e[e.msoulscat_ES_MobileEwa=7]="msoulscat_ES_MobileEwa";e[e.msoulscat_ES_EWAJSBIExplore=8]="msoulscat_ES_EWAJSBIExplore";e[e.msoulscat_ES_EWAJSNov=9]="msoulscat_ES_EWAJSNov";e[e.msoulscat_ES_EWAJSExcelEverywhere=10]="msoulscat_ES_EWAJSExcelEverywhere";
e[e.msoulscat_ES_EWAJSTp=11]="msoulscat_ES_EWAJSTp";e[e.msoulscat_ES_EWAJSComment=12]="msoulscat_ES_EWAJSComment";e[e.msoulscat_ES_EWAJSOCSIntegration=13]="msoulscat_ES_EWAJSOCSIntegration";e[e.msoulscat_bULS_Uploader=100]="msoulscat_bULS_Uploader";e[e.msoulscat_bULS_CachingHost=101]="msoulscat_bULS_CachingHost";e[e.msoulscat_bULS_Core=102]="msoulscat_bULS_Core";e[e.msoulscat_bULS_Assert=103]="msoulscat_bULS_Assert";e[e.msoulscat_Osi_MsoSpLogging=200]="msoulscat_Osi_MsoSpLogging";e[e.msoulscat_MSOSP_Error=
201]="msoulscat_MSOSP_Error";e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands";e[e.msoulscat_MSOSP_MsoSpRenameManager=203]="msoulscat_MSOSP_MsoSpRenameManager";e[e.msoulscat_MSOSP_CrossDocumentMessenger=204]="msoulscat_MSOSP_CrossDocumentMessenger";e[e.msoulscat_MSOSP_ClientRequestManager=205]="msoulscat_MSOSP_ClientRequestManager";e[e.msoulscat_MSOSP_DownloadQueue=206]="msoulscat_MSOSP_DownloadQueue";e[e.msoulscat_MSOSP_CommandUI=207]="msoulscat_MSOSP_CommandUI";e[e.msoulscat_MSOSP_AppSettings=
208]="msoulscat_MSOSP_AppSettings";e[e.msoulscat_MSOSP_CommonDebug=209]="msoulscat_MSOSP_CommonDebug";e[e.msoulscat_MSOSP_DomUtils=210]="msoulscat_MSOSP_DomUtils";e[e.msoulscat_MSOSP_OIC=211]="msoulscat_MSOSP_OIC";e[e.msoulscat_MSOSP_AnonEdit=212]="msoulscat_MSOSP_AnonEdit";e[e.msoulscat_MSOSP_Activity=213]="msoulscat_MSOSP_Activity";e[e.msoulscat_MSOSP_AnonCreate=214]="msoulscat_MSOSP_AnonCreate";e[e.msoulscat_MSOSP_O365ShellService=215]="msoulscat_MSOSP_O365ShellService";e[e.msoulscat_MSOSP_SaveToCloudStorage=
216]="msoulscat_MSOSP_SaveToCloudStorage";e[e.msoulscat_MSOSP_SessionExpirationManager=217]="msoulscat_MSOSP_SessionExpirationManager";e[e.msoulscat_MSOSP_TaskManager=218]="msoulscat_MSOSP_TaskManager";e[e.msoulscat_MSOSP_SaveAsToHost=219]="msoulscat_MSOSP_SaveAsToHost";e[e.msoulscat_MSOSP_AddInCommands=220]="msoulscat_MSOSP_AddInCommands";e[e.msoulscat_MSOSP_CookieCompliance=221]="msoulscat_MSOSP_CookieCompliance";e[e.msoulscat_Osi_MsoSpOfflineLogger=222]="msoulscat_Osi_MsoSpOfflineLogger";e[e.msoulscat_MSOSP_Signals=
223]="msoulscat_MSOSP_Signals";e[e.msoulscat_MSOSP_Skills=224]="msoulscat_MSOSP_Skills";e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS";e[e.msoulscat_MSOSP_OTelJSBootstrap=226]="msoulscat_MSOSP_OTelJSBootstrap";e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker";e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype";e[e.msoulscat_MSOSP_OTelJSTest=229]="msoulscat_MSOSP_OTelJSTest";e[e.msoulscat_MSOSP_LiveMeeting=230]="msoulscat_MSOSP_LiveMeeting";
e[e.msoulscat_Wac_WordMerge=300]="msoulscat_Wac_WordMerge";e[e.msoulscat_WAC_WordViewer=301]="msoulscat_WAC_WordViewer";e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence";e[e.msoulscat_Wac_RevisionDiffer=303]="msoulscat_Wac_RevisionDiffer";e[e.msoulscat_Wac_WordCoauth=304]="msoulscat_Wac_WordCoauth";e[e.msoulscat_Wac_Replication=305]="msoulscat_Wac_Replication";e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral";e[e.msoulscat_Box4_CopyPaste=307]="msoulscat_Box4_CopyPaste";
e[e.msoulscat_Wac_WordEditorFootnoteEndnote=308]="msoulscat_Wac_WordEditorFootnoteEndnote";e[e.msoulscat_Wac_WordEditorPageNumber=309]="msoulscat_Wac_WordEditorPageNumber";e[e.msoulscat_Wac_EventManager=310]="msoulscat_Wac_EventManager";e[e.msoulscat_Wac_WordEditorTableStyle=311]="msoulscat_Wac_WordEditorTableStyle";e[e.msoulscat_Wac_WordEditorFindReplace=312]="msoulscat_Wac_WordEditorFindReplace";e[e.msoulscat_Wac_FindReplace=313]="msoulscat_Wac_FindReplace";e[e.msoulscat_Wac_WordEditorPageBreak=
314]="msoulscat_Wac_WordEditorPageBreak";e[e.msoulscat_WAC_Box4Crash=315]="msoulscat_WAC_Box4Crash";e[e.msoulscat_Wac_WordEditorBlobFormatting=316]="msoulscat_Wac_WordEditorBlobFormatting";e[e.msoulscat_Wac_WordEditorHeaderFooter=317]="msoulscat_Wac_WordEditorHeaderFooter";e[e.msoulscat_Wac_WordEditorSelection=318]="msoulscat_Wac_WordEditorSelection";e[e.msoulscat_Wac_NodeLogger=319]="msoulscat_Wac_NodeLogger";e[e.msoulscat_Wac_TaskPaneFramework=320]="msoulscat_Wac_TaskPaneFramework";e[e.msoulscat_Wac_Focus=
321]="msoulscat_Wac_Focus";e[e.msoulscat_Wac_ImageEditor=322]="msoulscat_Wac_ImageEditor";e[e.msoulscat_Wac_EditingView=323]="msoulscat_Wac_EditingView";e[e.msoulscat_Wac_Box4General=324]="msoulscat_Wac_Box4General";e[e.msoulscat_Wac_PeoplesWell=325]="msoulscat_Wac_PeoplesWell";e[e.msoulscat_Wac_PageView=326]="msoulscat_Wac_PageView";e[e.msoulscat_Wac_Comments=327]="msoulscat_Wac_Comments";e[e.msoulscat_Wac_DirectPrint=328]="msoulscat_Wac_DirectPrint";e[e.msoulscat_Wac_GraphValidation=329]="msoulscat_Wac_GraphValidation";
e[e.msoulscat_Wac_OneNotePrint=330]="msoulscat_Wac_OneNotePrint";e[e.msoulscat_Wac_AppSettings=331]="msoulscat_Wac_AppSettings";e[e.msoulscat_Wac_Embed=332]="msoulscat_Wac_Embed";e[e.msoulscat_Wac_SkypeChat=333]="msoulscat_Wac_SkypeChat";e[e.msoulscat_WAC_Accessibility=334]="msoulscat_WAC_Accessibility";e[e.msoulscat_Wac_Aggregator=335]="msoulscat_Wac_Aggregator";e[e.msoulscat_Wac_WordEditorPagination=336]="msoulscat_Wac_WordEditorPagination";e[e.msoulscat_WAC_WordEditorSave=337]="msoulscat_WAC_WordEditorSave";
e[e.msoulscat_Wac_WoncaGeneral=338]="msoulscat_Wac_WoncaGeneral";e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral";e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon";e[e.msoulscat_Wac_WordEditorAppsForOffice=341]="msoulscat_Wac_WordEditorAppsForOffice";e[e.msoulscat_Wac_SendUsYourFile=342]="msoulscat_Wac_SendUsYourFile";e[e.msoulscat_WAC_DocxSaveMonitor=343]="msoulscat_WAC_DocxSaveMonitor";e[e.msoulscat_Wac_AppsForOffice=344]="msoulscat_Wac_AppsForOffice";e[e.msoulscat_Wac_BrowserPerformance=
345]="msoulscat_Wac_BrowserPerformance";e[e.msoulscat_Wac_WordEditorShapes=346]="msoulscat_Wac_WordEditorShapes";e[e.msoulscat_Wac_WordEditorFeatureHelper=347]="msoulscat_Wac_WordEditorFeatureHelper";e[e.msoulscat_Wac_InsertSymbol=348]="msoulscat_Wac_InsertSymbol";e[e.msoulscat_Wac_WebAppsPortal=349]="msoulscat_Wac_WebAppsPortal";e[e.msoulscat_Wac_Yammer=350]="msoulscat_Wac_Yammer";e[e.msoulscat_Wac_OoXml=351]="msoulscat_Wac_OoXml";e[e.msoulscat_Wac_InsertMedia=352]="msoulscat_Wac_InsertMedia";e[e.msoulscat_Wac_WordZoom=
353]="msoulscat_Wac_WordZoom";e[e.msoulscat_Wac_WordEditorFormatPainter=354]="msoulscat_Wac_WordEditorFormatPainter";e[e.msoulscat_Wac_WordRealTimeTyping=355]="msoulscat_Wac_WordRealTimeTyping";e[e.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback";e[e.msoulscat_Wac_WacFeedbackExcelOnlineViewMode=357]="msoulscat_Wac_WacFeedbackExcelOnlineViewMode";e[e.msoulscat_Wac_WacFeedbackExcelOnlineEditMode=358]="msoulscat_Wac_WacFeedbackExcelOnlineEditMode";e[e.msoulscat_Wac_WacFeedbackExcelOnlineSurveyMode=
359]="msoulscat_Wac_WacFeedbackExcelOnlineSurveyMode";e[e.msoulscat_Wac_WacFeedbackPptOnlineViewMode=360]="msoulscat_Wac_WacFeedbackPptOnlineViewMode";e[e.msoulscat_Wac_WacFeedbackPptOnlineEditMode=361]="msoulscat_Wac_WacFeedbackPptOnlineEditMode";e[e.msoulscat_Wac_WacFeedbackOneNoteOnline=362]="msoulscat_Wac_WacFeedbackOneNoteOnline";e[e.msoulscat_Wac_WacFeedbackWordOnlineViewMode=363]="msoulscat_Wac_WacFeedbackWordOnlineViewMode";e[e.msoulscat_Wac_WacFeedbackWordOnlineEditMode=364]="msoulscat_Wac_WacFeedbackWordOnlineEditMode";
e[e.msoulscat_Wac_Box4Undo=365]="msoulscat_Wac_Box4Undo";e[e.msoulscat_Wac_WordEditorCustomXml=366]="msoulscat_Wac_WordEditorCustomXml";e[e.msoulscat_Wac_WordEditorNavigationPane=367]="msoulscat_Wac_WordEditorNavigationPane";e[e.msoulscat_Wac_WordEditorContentControl=368]="msoulscat_Wac_WordEditorContentControl";e[e.msoulscat_Wac_WordEditorExtension=369]="msoulscat_Wac_WordEditorExtension";e[e.msoulscat_Wac_UpdateHints=370]="msoulscat_Wac_UpdateHints";e[e.msoulscat_Wac_OneNoteAppsforOffice=371]="msoulscat_Wac_OneNoteAppsforOffice";
e[e.msoulscat_Wac_OneNoteExtension=372]="msoulscat_Wac_OneNoteExtension";e[e.msoulscat_Wac_WacFeedbackVisioOnlineViewMode=373]="msoulscat_Wac_WacFeedbackVisioOnlineViewMode";e[e.msoulscat_Wac_WacFeedbackVisioOnlineEditMode=374]="msoulscat_Wac_WacFeedbackVisioOnlineEditMode";e[e.msoulscat_Wac_Proofing=375]="msoulscat_Wac_Proofing";e[e.msoulscat_Wac_WordEditorTrackChange=376]="msoulscat_Wac_WordEditorTrackChange";e[e.msoulscat_Wac_WordEditorCatchUp=377]="msoulscat_Wac_WordEditorCatchUp";e[e.msoulscat_Wac_WacSafeLinks=
378]="msoulscat_Wac_WacSafeLinks";e[e.msoulscat_Wac_WopiBootstrapper=379]="msoulscat_Wac_WopiBootstrapper";e[e.msoulscat_Wac_PeopleHandler=380]="msoulscat_Wac_PeopleHandler";e[e.msoulscat_Wac_WacOcsVectorClockTelemetry=381]="msoulscat_Wac_WacOcsVectorClockTelemetry";e[e.msoulscat_Wac_WacDigitalPrint=382]="msoulscat_Wac_WacDigitalPrint";e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry";e[e.msoulscat_Wac_PolicyHandler=384]="msoulscat_Wac_PolicyHandler";e[e.msoulscat_Wac_WordEditorMetadataHelper=
385]="msoulscat_Wac_WordEditorMetadataHelper";e[e.msoulscat_Wac_WordEditorRevisionMetadata=386]="msoulscat_Wac_WordEditorRevisionMetadata";e[e.msoulscat_Wac_WacInProductMessaging=387]="msoulscat_Wac_WacInProductMessaging";e[e.msoulscat_Wac_WordEditorResumeAssistant=388]="msoulscat_Wac_WordEditorResumeAssistant";e[e.msoulscat_Wac_Box4AugmentationLoop=389]="msoulscat_Wac_Box4AugmentationLoop";e[e.msoulscat_Wac_WordEditorAcronyms=390]="msoulscat_Wac_WordEditorAcronyms";e[e.msoulscat_Wac_WacCatchUpActivities=
391]="msoulscat_Wac_WacCatchUpActivities";e[e.msoulscat_Wac_WacAwayStatus=392]="msoulscat_Wac_WacAwayStatus";e[e.msoulscat_Wac_Box4List=393]="msoulscat_Wac_Box4List";e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation";e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync";e[e.msoulscat_Wac_IdeasRuntime=396]="msoulscat_Wac_IdeasRuntime";e[e.msoulscat_Wac_IdeasPane=397]="msoulscat_Wac_IdeasPane";e[e.msoulscat_Wac_Infrared=398]="msoulscat_Wac_Infrared";e[e.msoulscat_Wac_WordEditorModernTranslator=
399]="msoulscat_Wac_WordEditorModernTranslator";e[e.msoulscat_OneService_Site=400]="msoulscat_OneService_Site";e[e.msoulscat_OneService_UnitTests=401]="msoulscat_OneService_UnitTests";e[e.msoulscat_OneService_ClipperInstall=402]="msoulscat_OneService_ClipperInstall";e[e.msoulscat_OneService_ClipperUsage=403]="msoulscat_OneService_ClipperUsage";e[e.msoulscat_OneService_Site_EmailSettings=404]="msoulscat_OneService_Site_EmailSettings";e[e.msoulscat_OneService_Site_Notebooks=405]="msoulscat_OneService_Site_Notebooks";
e[e.msoulscat_OneService_Site_DevSite=406]="msoulscat_OneService_Site_DevSite";e[e.msoulscat_OneService_Site_FeaturedApps=407]="msoulscat_OneService_Site_FeaturedApps";e[e.msoulscat_OneService_Site_FeedbackPage=408]="msoulscat_OneService_Site_FeedbackPage";e[e.msoulscat_OneService_Augmentation=409]="msoulscat_OneService_Augmentation";e[e.msoulscat_OneService_AugmentationProvider_UrlEnhancer=410]="msoulscat_OneService_AugmentationProvider_UrlEnhancer";e[e.msoulscat_OneService_AugmentationProvider_DomEnhancer=
411]="msoulscat_OneService_AugmentationProvider_DomEnhancer";e[e.msoulscat_OneService_AugmentationProvider_Entitization=412]="msoulscat_OneService_AugmentationProvider_Entitization";e[e.msoulscat_OneService_ClipperTooltip=413]="msoulscat_OneService_ClipperTooltip";e[e.msoulscat_OneService_Site_Students=414]="msoulscat_OneService_Site_Students";e[e.msoulscat_OneService_AugmentationProvider_BizcardExtractor=415]="msoulscat_OneService_AugmentationProvider_BizcardExtractor";e[e.msoulscat_OneService_Site_ClassNotebook=
416]="msoulscat_OneService_Site_ClassNotebook";e[e.msoulscat_WAC_RealtimeChannel=500]="msoulscat_WAC_RealtimeChannel";e[e.msoulscat_WAC_RealtimeChannelTest=501]="msoulscat_WAC_RealtimeChannelTest";e[e.msoulscat_WAC_HostNotification=502]="msoulscat_WAC_HostNotification";e[e.msoulscat_WAC_Signalr=600]="msoulscat_WAC_Signalr";e[e.msoulscat_WAC_VisioApp=700]="msoulscat_WAC_VisioApp";e[e.msoulscat_WAC_VisioLoader=701]="msoulscat_WAC_VisioLoader";e[e.msoulscat_WAC_VisioDataModel=702]="msoulscat_WAC_VisioDataModel";
e[e.msoulscat_WAC_VisioRenderer=703]="msoulscat_WAC_VisioRenderer";e[e.msoulscat_WAC_VisioRecalc=704]="msoulscat_WAC_VisioRecalc";e[e.msoulscat_WAC_VisioCommand=705]="msoulscat_WAC_VisioCommand";e[e.msoulscat_WAC_VisioController=706]="msoulscat_WAC_VisioController";e[e.msoulscat_WAC_VisioShapePanel=707]="msoulscat_WAC_VisioShapePanel";e[e.msoulscat_WAC_VisioAppControls=708]="msoulscat_WAC_VisioAppControls";e[e.msoulscat_WAC_VisioSync=709]="msoulscat_WAC_VisioSync";e[e.msoulscat_WAC_VisioDataRefresh=
710]="msoulscat_WAC_VisioDataRefresh";e[e.msoulscat_WAC_VisioWebDVAddinService=711]="msoulscat_WAC_VisioWebDVAddinService";e[e.msoulscat_WAC_VisioWebDVAddinClient=712]="msoulscat_WAC_VisioWebDVAddinClient";e[e.msoulscat_WAC_VisioWebClipboard=713]="msoulscat_WAC_VisioWebClipboard";e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation";e[e.msoulscat_Wac_PptAppEvents=801]="msoulscat_Wac_PptAppEvents";e[e.msoulscat_Wac_PptAppsForOffice=802]="msoulscat_Wac_PptAppsForOffice";e[e.msoulscat_Wac_PptBrowserLayer=
803]="msoulscat_Wac_PptBrowserLayer";e[e.msoulscat_Wac_PptCoauthoring=804]="msoulscat_Wac_PptCoauthoring";e[e.msoulscat_Wac_PptComments=805]="msoulscat_Wac_PptComments";e[e.msoulscat_Wac_PptEditingManager=806]="msoulscat_Wac_PptEditingManager";e[e.msoulscat_Wac_PptFocus=807]="msoulscat_Wac_PptFocus";e[e.msoulscat_Wac_PptGraph=808]="msoulscat_Wac_PptGraph";e[e.msoulscat_Wac_PptInit=809]="msoulscat_Wac_PptInit";e[e.msoulscat_Wac_PptNavigation=810]="msoulscat_Wac_PptNavigation";e[e.msoulscat_Wac_PptNone=
811]="msoulscat_Wac_PptNone";e[e.msoulscat_Wac_PptNotes=812]="msoulscat_Wac_PptNotes";e[e.msoulscat_Wac_PptPerf=813]="msoulscat_Wac_PptPerf";e[e.msoulscat_Wac_PptPresence=814]="msoulscat_Wac_PptPresence";e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape";e[e.msoulscat_Wac_PptSelection=816]="msoulscat_Wac_PptSelection";e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession";e[e.msoulscat_Wac_PptTasks=818]="msoulscat_Wac_PptTasks";e[e.msoulscat_Wac_PptThumbnailPane=819]="msoulscat_Wac_PptThumbnailPane";
e[e.msoulscat_Wac_PptText=820]="msoulscat_Wac_PptText";e[e.msoulscat_Wac_PptUtil=821]="msoulscat_Wac_PptUtil";e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView";e[e.msoulscat_Wac_PptSynchronization=823]="msoulscat_Wac_PptSynchronization";e[e.msoulscat_Wac_PptWebService=824]="msoulscat_Wac_PptWebService";e[e.msoulscat_Wac_PptMedia=825]="msoulscat_Wac_PptMedia";e[e.msoulscat_Wac_PptCopyPaste=826]="msoulscat_Wac_PptCopyPaste";e[e.msoulscat_Wac_PptZoom=827]="msoulscat_Wac_PptZoom";e[e.msoulscat_Wac_PptRealTimeCoauth=
828]="msoulscat_Wac_PptRealTimeCoauth";e[e.msoulscat_Wac_PptDesigner=829]="msoulscat_Wac_PptDesigner";e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow";e[e.msoulscat_Wac_PptPictureCrop=831]="msoulscat_Wac_PptPictureCrop";e[e.msoulscat_Wac_PptVersionHistory=832]="msoulscat_Wac_PptVersionHistory";e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive";e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb";e[e.msoulscat_Wac_PptGc2General=835]="msoulscat_Wac_PptGc2General";e[e.msoulscat_Wac_PptGc2GraphicHost=
836]="msoulscat_Wac_PptGc2GraphicHost";e[e.msoulscat_Wac_PptGc2Operation=837]="msoulscat_Wac_PptGc2Operation";e[e.msoulscat_Wac_PptPresentToTeams=838]="msoulscat_Wac_PptPresentToTeams";e[e.msoulscat_Wac_PptWebSocketFrontDoor=839]="msoulscat_Wac_PptWebSocketFrontDoor";e[e.msoulscat_Wac_MediaSnap=840]="msoulscat_Wac_MediaSnap";e[e.msoulscat_Wac_MediaTranscoding=841]="msoulscat_Wac_MediaTranscoding";e[e.msoulscat_Wac_FileSnap=842]="msoulscat_Wac_FileSnap";e[e.msoulscat_Wac_PptPartialDocs=843]="msoulscat_Wac_PptPartialDocs";
e[e.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync";e[e.msoulscat_Wac_PptCollabTasks=845]="msoulscat_Wac_PptCollabTasks";e[e.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos";e[e.msoulscat_Wac_ChatPPT=847]="msoulscat_Wac_ChatPPT";e[e.msoulscat_Uci_CommandsClient=1300]="msoulscat_Uci_CommandsClient";e[e.msoulscat_Uci_InsightsClient=1301]="msoulscat_Uci_InsightsClient";e[e.msoulscat_Uci_Assistance=1302]="msoulscat_Uci_Assistance";e[e.msoulscat_Uci_Insights=1303]="msoulscat_Uci_Insights";
e[e.msoulscat_Uci_Insights_Overview=1304]="msoulscat_Uci_Insights_Overview";e[e.msoulscat_Uci_Insights_DrillIn=1306]="msoulscat_Uci_Insights_DrillIn";e[e.msoulscat_Uci_JunoClient=1307]="msoulscat_Uci_JunoClient";e[e.msoulscat_Uci_GraphImportClient=1308]="msoulscat_Uci_GraphImportClient";e[e.msoulscat_Uci_TellMeServiceClient=1309]="msoulscat_Uci_TellMeServiceClient";e[e.msoulscat_Uci_EnrichmentClient=1310]="msoulscat_Uci_EnrichmentClient";e[e.msoulscat_Uci_JunoBrowserExtension=1311]="msoulscat_Uci_JunoBrowserExtension";
e[e.msoulscat_Uci_Enrichment=1312]="msoulscat_Uci_Enrichment";e[e.msoulscat_Uci_SmartLookupClient=1313]="msoulscat_Uci_SmartLookupClient";e[e.msoulscat_Uci_CanvasContext=1314]="msoulscat_Uci_CanvasContext";e[e.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency";e[e.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification";e[e.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime";e[e.msoulscat_Osf_AppManagementMenu=1404]="msoulscat_Osf_AppManagementMenu";e[e.msoulscat_Osf_InsertionDialogSession=
1405]="msoulscat_Osf_InsertionDialogSession";e[e.msoulscat_Osf_UploadFileDevCatelog=1406]="msoulscat_Osf_UploadFileDevCatelog";e[e.msoulscat_Osf_UploadFileDevCatalogUsage=1411]="msoulscat_Osf_UploadFileDevCatalogUsage";e[e.msoulscat_OneNoteOnline_Navigation=1600]="msoulscat_OneNoteOnline_Navigation";e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache";e[e.msoulscat_OneNoteOnline_Zoom=1602]="msoulscat_OneNoteOnline_Zoom";e[e.msoulscat_Alchemy_Browser=1700]="msoulscat_Alchemy_Browser";
e[e.msoulscat_Ice_EmailHrd=1800]="msoulscat_Ice_EmailHrd";e[e.msoulscat_Ice_InsertMedia=1801]="msoulscat_Ice_InsertMedia";e[e.msoulscat_Ice_Abt=1802]="msoulscat_Ice_Abt";e[e.msoulscat_Met_Broadcast=1900]="msoulscat_Met_Broadcast";e[e.msoulscat_NlAppsClient_Acronyms=2200]="msoulscat_NlAppsClient_Acronyms";e[e.msoulscat_NlAppsClient_EditorPane=2201]="msoulscat_NlAppsClient_EditorPane";e[e.msoulscat_NlAppsClient_KeyPoints=2202]="msoulscat_NlAppsClient_KeyPoints";e[e.msoulscat_NlAppsClient_Synonyms=2203]=
"msoulscat_NlAppsClient_Synonyms";e[e.msoulscat_NlAppsClient_ToDo=2204]="msoulscat_NlAppsClient_ToDo";e[e.msoulscat_Wac_Ideas=2250]="msoulscat_Wac_Ideas";e[e.msoulscat_Wac_ReadingTime=2251]="msoulscat_Wac_ReadingTime";e[e.msoulscat_Wac_Goals=2252]="msoulscat_Wac_Goals";e[e.msoulscat_Wac_StatsDialog=2253]="msoulscat_Wac_StatsDialog";e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory";e[e.msoulscat_Wac_OAuth=3E3]="msoulscat_Wac_OAuth";e[e.msoulscat_Wac_WordGraphicsEditor=3001]="msoulscat_Wac_WordGraphicsEditor";
e[e.msoulscat_Wac_Licensing=3002]="msoulscat_Wac_Licensing";e[e.msoulscat_Wac_WordTasks=3003]="msoulscat_Wac_WordTasks";e[e.msoulscat_Wac_ApplicationFeatureHelper=3004]="msoulscat_Wac_ApplicationFeatureHelper";e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory";e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard";e[e.msoulscat_Wac_Box4Workers=3007]="msoulscat_Wac_Box4Workers";e[e.msoulscat_Wac_WordWorkers=3008]="msoulscat_Wac_WordWorkers";e[e.msoulscat_Wac_WordEditorClientPagination=
3009]="msoulscat_Wac_WordEditorClientPagination";e[e.msoulscat_Wac_WordPrediction=3010]="msoulscat_Wac_WordPrediction";e[e.msoulscat_Wac_TranscriptionPane=3011]="msoulscat_Wac_TranscriptionPane";e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout";e[e.msoulscat_Wac_ComponentStateLogging=3013]="msoulscat_Wac_ComponentStateLogging";e[e.msoulscat_Wac_WordRuler=3014]="msoulscat_Wac_WordRuler";e[e.msoulscat_Wac_WordInlineTab=3015]="msoulscat_Wac_WordInlineTab";e[e.msoulscat_Wac_WordDesigner=
3016]="msoulscat_Wac_WordDesigner";e[e.msoulscat_Wac_Styles=3017]="msoulscat_Wac_Styles";e[e.msoulscat_Wac_WordStyles=3018]="msoulscat_Wac_WordStyles";e[e.msoulscat_Wac_TableOfContents=3019]="msoulscat_Wac_TableOfContents";e[e.msoulscat_Wac_ConvertWordToPpt=3020]="msoulscat_Wac_ConvertWordToPpt";e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker";e[e.msoulscat_Wac_WordTables=3022]="msoulscat_Wac_WordTables";e[e.msoulscat_Wac_WordColors=3023]="msoulscat_Wac_WordColors";e[e.msoulscat_Wac_ProactiveUxGovernance=
3025]="msoulscat_Wac_ProactiveUxGovernance";e[e.msoulscat_Wac_PrebootHandler=3026]="msoulscat_Wac_PrebootHandler";e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost";e[e.msoulscat_Wac_ConditionalTriggering=3028]="msoulscat_Wac_ConditionalTriggering";e[e.msoulscat_Wac_WordBookmarks=3029]="msoulscat_Wac_WordBookmarks";e[e.msoulscat_Wac_WordEditorClientPaginationTyping=3030]="msoulscat_Wac_WordEditorClientPaginationTyping";e[e.msoulscat_Wac_WordEditorNudgeToWeb=3031]="msoulscat_Wac_WordEditorNudgeToWeb";
e[e.msoulscat_Wac_Suite=3032]="msoulscat_Wac_Suite";e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools";e[e.msoulscat_Wac_ContextIQ=3034]="msoulscat_Wac_ContextIQ";e[e.msoulscat_Wac_WordEditorClientActivityGeneration=3035]="msoulscat_Wac_WordEditorClientActivityGeneration";e[e.msoulscat_Wac_WordEditorEmergencyView=3036]="msoulscat_Wac_WordEditorEmergencyView";e[e.msoulscat_Wac_WordRevisionSequenceNumber=3037]="msoulscat_Wac_WordRevisionSequenceNumber";e[e.msoulscat_Wac_WordDataLossMonitor=
3038]="msoulscat_Wac_WordDataLossMonitor";e[e.msoulscat_Wac_OWL=3039]="msoulscat_Wac_OWL";e[e.msoulscat_Wac_OWLNest=3040]="msoulscat_Wac_OWLNest";e[e.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker";e[e.msoulscat_Wac_OfficeTemplatesMetadataService=3042]="msoulscat_Wac_OfficeTemplatesMetadataService";e[e.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite";e[e.msoulscat_Wac_AiInsert=3044]="msoulscat_Wac_AiInsert";e[e.msoulscat_Wac_FastCards=3045]="msoulscat_Wac_FastCards";e[e.msoulscat_Wac_SendToKindle=
3046]="msoulscat_Wac_SendToKindle";e[e.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize";e[e.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose"})(h||(h={}));Object(K.b)("ULSCat",h)},1281:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);var h;(function(e){e[e.error=10]="error";e[e.warning=15]="warning";e[e.important=20]="important";e[e.info=50]="info";e[e.verbose=100]="verbose";e[e.spam=200]="spam";e[e.shiftFactor=1E3]="shiftFactor"})(h||(h={}));Object(K.b)("ULSTraceLevel",
h)},1285:function(K,U,d){function h(a,b){if(!a||!b)return[];const c=new Set;a.forEach(f=>{var l;return null===(l=null===f||void 0===f?void 0:f.tKe)||void 0===l?void 0:l.forEach(y=>{y&&c.add(y)})});return Array.from(c).map(f=>b.ze(ha.a.Jf(f))).filter(f=>null!==f&&void 0!==f)}function e(a,b){return b&&b.TableNode?new wF(b):new xF(a)}function r(a,b){Eo.set(a,b)}d.r(U);var m=d(0),n=d(71),z=d(55),v=d(95),x=d(183),B=d(177),D=d(120),w=d(27),J=d(1130),G=d(37),M=d(161),N=d(38);class R{constructor(a){this.value=
a}}Object(m.a)(R,"RefTriState",null,[]);var C=d(35);class O{tUe(){this.N_i();this.KJj();this.T6j();this.Ndk();N.a.instance.ga(70)&&this.hVk();this.Xgl();N.a.instance.ga(71)&&this.rPb();this.lDl();this.eEl();this.MQi();this.D6j();this.Vcl();this.Ezl();this.hFl();N.a.instance.ga(79)&&(z.a.Ik||this.RLj(),this.n9j(),this.Jyk(),this.HLl())}N_i(){const a=v.FocusManager.instance().Fc(M.AppFrame.KW);a.bindAction(x.KeyInputManager.Qa(B.a.Dp,0),C.a.enter);a.bindAction(x.KeyInputManager.Qa(B.a.Dp,4),C.a.vtd)}KJj(){const a=
v.FocusManager.instance().Fc(M.AppFrame.KW);D.AFrame.Bk(a,x.KeyInputManager.ww(Box4Intl.Box4Strings.l_HK_Hyperlink),C.a.insertHyperlink)}RLj(){const a=v.FocusManager.instance().Fc(D.AFrame.Xi);D.AFrame.Bk(a,x.KeyInputManager.Qa(B.a.rha,5),C.a.TC);D.AFrame.Bk(a,x.KeyInputManager.Qa(B.a.Eba,5),C.a.My)}D6j(){if(!z.a.Ex){const a=v.FocusManager.instance().Fc(D.AFrame.Xi);D.AFrame.Bk(a,x.KeyInputManager.Qa(B.a.Yxc,x.KeyInputManager.Re),C.a.Htg,O.zkb("faOpen"))}}T6j(){const a=v.FocusManager.instance().Fc(M.AppFrame.KW);
N.a.instance.ga(54)&&D.AFrame.Bk(a,x.KeyInputManager.ww(Box4Intl.Box4Strings.l_HK_CenterJustify),C.a.centerJustify,O.gK);z.a.Ik?(D.AFrame.Bk(a,x.KeyInputManager.ww(Box4Intl.Box4Strings.l_HK_LeftJustify_Mac),C.a.leftJustify,O.gK),D.AFrame.Bk(a,x.KeyInputManager.ww(Box4Intl.Box4Strings.l_HK_RightJustify_Mac),C.a.rightJustify,O.gK)):(D.AFrame.Bk(a,x.KeyInputManager.ww(Box4Intl.Box4Strings.l_HK_LeftJustify),C.a.leftJustify,O.gK),D.AFrame.Bk(a,x.KeyInputManager.ww(Box4Intl.Box4Strings.l_HK_RightJustify),
C.a.rightJustify,O.gK));N.a.instance.ga(54)&&D.AFrame.Bk(a,x.KeyInputManager.Qa(B.a.Yzd,x.KeyInputManager.Re),C.a.fullJustify,O.gK)}n9j(){var a=v.FocusManager.instance();const b=a.Fc(D.AFrame.Xi);a=a.Fc(M.AppFrame.KW);D.AFrame.Bk(b,x.KeyInputManager.Qa(B.a.nNa,x.KeyInputManager.Re),C.a.iN,O.FTf);D.AFrame.Bk(b,x.KeyInputManager.Qa(B.a.l$e,x.KeyInputManager.Re),C.a.zP,O.FTf);z.a.dCb&&a.bindAction(x.KeyInputManager.Qa(B.a.Xxc,4|x.KeyInputManager.Re),C.a.iN)}Ndk(){const a=v.FocusManager.instance().Fc(D.AFrame.Xi);
D.AFrame.Bk(a,x.KeyInputManager.ww(Box4Intl.Box4Strings.l_HK_TellMe),G.a.wvc,O.gK)}Jyk(){if(N.a.instance.ga(27)||N.a.instance.ga(58)){const a=v.FocusManager.instance().Fc(D.AFrame.Xi),b=N.a.instance.ga(58)?C.a.hfl:C.a.save;D.AFrame.Bk(a,x.KeyInputManager.ww(Box4Intl.Box4Strings.l_HK_Save),b);D.AFrame.Bk(a,x.KeyInputManager.Qa(B.a.Daf,0),C.a.sync)}}hVk(){const a=v.FocusManager.instance().Fc(M.AppFrame.KW);w.AFrameworkApplication.fa.ka("WordEditorIdeasIsEnabled")&&w.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")||
D.AFrame.Bk(a,x.KeyInputManager.Qa(B.a.Vxc,1),C.a.jhd);D.AFrame.Bk(a,x.KeyInputManager.Qa(B.a.Vxc,0),C.a.jhd)}Xgl(){this.evh(M.AppFrame.KW);this.evh(M.AppFrame.KTe)}evh(a){var b=v.FocusManager.instance(),c=B.a.Eba,f=B.a.rha;a=b.Fc(a);const l=b.Fc(w.AFrameworkApplication.Yib);a.bindAction(x.KeyInputManager.Qa(c,0),C.a.leftArrow);a.bindAction(x.KeyInputManager.Qa(f,0),C.a.rightArrow);a.bindAction(x.KeyInputManager.Qa(B.a.nZ,0),C.a.upArrow);a.bindAction(x.KeyInputManager.Qa(B.a.f7,0),C.a.downArrow);
a.bindAction(x.KeyInputManager.Qa(f,4),C.a.L1a);a.bindAction(x.KeyInputManager.Qa(c,4),C.a.K1a);z.a.Ik?(a.bindAction(x.KeyInputManager.Qa(f,1),C.a.CDa),a.bindAction(x.KeyInputManager.Qa(c,1),C.a.BDa),a.bindAction(x.KeyInputManager.Qa(f,5),C.a.fSa),a.bindAction(x.KeyInputManager.Qa(c,5),C.a.eSa),a.bindAction(x.KeyInputManager.Qa(f,8),C.a.VZa),a.bindAction(x.KeyInputManager.Qa(c,8),C.a.WZa),a.bindAction(x.KeyInputManager.Qa(f,12),C.a.$Sa),a.bindAction(x.KeyInputManager.Qa(c,12),C.a.aTa)):(a.bindAction(x.KeyInputManager.Qa(f,
x.KeyInputManager.Re),C.a.CDa),a.bindAction(x.KeyInputManager.Qa(c,x.KeyInputManager.Re),C.a.BDa),a.bindAction(x.KeyInputManager.Qa(f,x.KeyInputManager.Re|4),C.a.fSa),a.bindAction(x.KeyInputManager.Qa(c,x.KeyInputManager.Re|4),C.a.eSa));a.bindAction(x.KeyInputManager.Qa(B.a.nZ,4),C.a.qOb);a.bindAction(x.KeyInputManager.Qa(B.a.f7,4),C.a.Flb);a.bindAction(x.KeyInputManager.Qa(B.a.nZ,x.KeyInputManager.Re),C.a.L3b);a.bindAction(x.KeyInputManager.Qa(B.a.f7,x.KeyInputManager.Re),C.a.Hvb);a.bindAction(x.KeyInputManager.Qa(B.a.nZ,
x.KeyInputManager.Re|4),C.a.b9a);a.bindAction(x.KeyInputManager.Qa(B.a.f7,x.KeyInputManager.Re|4),C.a.dSa);a.bindAction(x.KeyInputManager.Qa(B.a.pF,0),C.a.WZa);a.bindAction(x.KeyInputManager.Qa(B.a.pF,4),C.a.aTa);if(N.a.instance.ga(41))a.bindAction(x.KeyInputManager.Qa(B.a.pF,x.KeyInputManager.Re),C.a.Fgd),a.bindAction(x.KeyInputManager.Qa(B.a.jx,x.KeyInputManager.Re),C.a.gJe);else if(N.a.instance.ga(17)||N.a.instance.ga(77))a.bindAction(x.KeyInputManager.Qa(B.a.pF,x.KeyInputManager.Re),C.a.Ihb),
a.bindAction(x.KeyInputManager.Qa(B.a.jx,x.KeyInputManager.Re),C.a.Hhb);a.bindAction(x.KeyInputManager.Qa(B.a.pF,x.KeyInputManager.Re|4),C.a.X9a);a.bindAction(x.KeyInputManager.Qa(B.a.jx,0),C.a.VZa);a.bindAction(x.KeyInputManager.Qa(B.a.jx,4),C.a.$Sa);a.bindAction(x.KeyInputManager.Qa(B.a.jx,x.KeyInputManager.Re|4),C.a.W9a);z.a.Ik&&(a.bindAction(x.KeyInputManager.Qa(B.a.nZ,2),C.a.WZa),a.bindAction(x.KeyInputManager.Qa(B.a.nZ,6),C.a.aTa),a.bindAction(x.KeyInputManager.Qa(B.a.f7,2),C.a.VZa),a.bindAction(x.KeyInputManager.Qa(B.a.f7,
6),C.a.$Sa),a.bindAction(x.KeyInputManager.Qa(B.a.pF,1),C.a.Ihb),a.bindAction(x.KeyInputManager.Qa(B.a.jx,1),C.a.Hhb),N.a.instance.ga(6)&&(a.bindAction(x.KeyInputManager.Qa(B.a.nZ,5),C.a.b9a),a.bindAction(x.KeyInputManager.Qa(B.a.f7,5),C.a.dSa)));c=x.KeyInputManager.ww(Box4Intl.Box4Strings.l_HK_SelectAll);a.bindAction(c,C.a.pta);l.bindAction(c,G.a.ySa);N.a.instance.ga(79)&&(f=b.Fc(D.AFrame.gE),b=b.Fc(D.AFrame.Xi),f.bindAction(c,G.a.PCa),b.bindAction(x.KeyInputManager.Qa(B.a.wNa,x.KeyInputManager.Re|
4),C.a.Vqd),N.a.instance.ga(41)&&z.a.Ik&&(a.bindAction(x.KeyInputManager.Qa(B.a.rC,1),C.a.Ihb),a.bindAction(x.KeyInputManager.Qa(B.a.qC,1),C.a.Hhb)),b.bindAction(x.KeyInputManager.Qa(B.a.qC,0),C.a.pageDown),b.bindAction(x.KeyInputManager.Qa(B.a.rC,0),C.a.pageUp),b.bindAction(x.KeyInputManager.Qa(B.a.qC,4),C.a.Ctc),b.bindAction(x.KeyInputManager.Qa(B.a.rC,4),C.a.xtd));N.a.instance.ga(6)&&(a.bindAction(x.KeyInputManager.Qa(B.a.qC,x.KeyInputManager.Re|4),G.a.ySa),a.bindAction(x.KeyInputManager.Qa(B.a.rC,
x.KeyInputManager.Re|4),G.a.ySa));z.a.ik||a.bindAction(x.KeyInputManager.Qa(B.a.lNa,0),C.a.gba);a.bindAction(x.KeyInputManager.Qa(B.a.gqa,4),C.a.wtd);a.bindAction(x.KeyInputManager.Qa(B.a.gqa,4|x.KeyInputManager.Re),C.a.wtd)}rPb(){const a=v.FocusManager.instance().Fc(M.AppFrame.KW);D.AFrame.Bk(a,x.KeyInputManager.Qa(B.a.Vzd,x.KeyInputManager.Re|1),C.a.QUd);D.AFrame.Bk(a,x.KeyInputManager.Qa(B.a.Wzd,x.KeyInputManager.Re|1),C.a.RUd);D.AFrame.Bk(a,x.KeyInputManager.Qa(B.a.xaf,x.KeyInputManager.Re|1),
C.a.SUd);D.AFrame.Bk(a,x.KeyInputManager.Qa(B.a.yaf,x.KeyInputManager.Re|1),C.a.TUd);D.AFrame.Bk(a,x.KeyInputManager.Qa(B.a.zaf,x.KeyInputManager.Re|1),C.a.UUd);D.AFrame.Bk(a,x.KeyInputManager.Qa(B.a.Aaf,x.KeyInputManager.Re|1),C.a.VUd);D.AFrame.Bk(a,x.KeyInputManager.Qa(B.a.vAa,x.KeyInputManager.Re|4),C.a.PUd);N.a.instance.ga(61)&&v.FocusManager.instance().Fc(D.AFrame.Xi).bindAction(x.KeyInputManager.Qa(B.a.$zd,x.KeyInputManager.Re|4),C.a.vmi)}lDl(){const a=v.FocusManager.instance().Fc(M.AppFrame.KW);
a.bindAction(x.KeyInputManager.Qa(B.a.$q,0),C.a.tab);a.bindAction(x.KeyInputManager.Qa(B.a.$q,4),C.a.Dtc)}eEl(){if(N.a.instance.ga(30)){const a=v.FocusManager.instance().Fc(M.AppFrame.KW);D.AFrame.Bk(a,x.KeyInputManager.Qa(B.a.Dp,x.KeyInputManager.Re),C.a.Hua)}}hFl(){const a=v.FocusManager.instance(),b=a.Fc(M.AppFrame.KW);a.Fc(D.AFrame.gE);D.AFrame.Bk(b,x.KeyInputManager.ww(Box4Intl.Box4Strings.l_HK_Bold),C.a.bold,O.gK);D.AFrame.Bk(b,x.KeyInputManager.ww(Box4Intl.Box4Strings.l_HK_Italic),C.a.setItalic,
O.gK);D.AFrame.Bk(b,x.KeyInputManager.ww(Box4Intl.Box4Strings.l_HK_Underline),C.a.underline,O.gK);z.a.Ik&&(D.AFrame.Bk(b,x.KeyInputManager.ww(Box4Intl.Box4Strings.l_HK_Bold_Mac),C.a.bold,O.gK),D.AFrame.Bk(b,x.KeyInputManager.ww(Box4Intl.Box4Strings.l_HK_Italic_Mac),C.a.setItalic,O.gK),D.AFrame.Bk(b,x.KeyInputManager.ww(Box4Intl.Box4Strings.l_HK_Underline_Mac),C.a.underline,O.gK));D.AFrame.Bk(b,x.KeyInputManager.ww(Box4Intl.Box4Strings.l_HK_ClearFormatting),C.a.clearFormatting);N.a.instance.ga(54)&&
D.AFrame.Bk(b,x.KeyInputManager.Qa(B.a.Unb,x.KeyInputManager.Re|4),C.a.clearFormatting);D.AFrame.Bk(b,x.KeyInputManager.Qa(B.a.Snb,x.KeyInputManager.Re|1),C.a.Q1,O.zkb("00FFFF"));if(N.a.instance.ga(94)||N.a.instance.ga(96))D.AFrame.Bk(b,x.KeyInputManager.Qa(B.a.nNa,x.KeyInputManager.Re|4),C.a.mH,O.gK),D.AFrame.Bk(b,x.KeyInputManager.Qa(B.a.vxc,x.KeyInputManager.Re),C.a.mH,O.gK),D.AFrame.Bk(b,x.KeyInputManager.Qa(B.a.Wyd,x.KeyInputManager.Re|4),C.a.bI,O.gK),D.AFrame.Bk(b,x.KeyInputManager.Qa(B.a.txc,
x.KeyInputManager.Re),C.a.bI,O.gK);w.AFrameworkApplication.fa.ka("PPTOToggleCaseByShiftF3Enabled")&&D.AFrame.Bk(b,x.KeyInputManager.ww(Box4Intl.Box4Strings.l_HK_ToggleCase),C.a.Gwd);w.AFrameworkApplication.fa.ka("SubSuperscriptShortcutEnabled")&&(D.AFrame.Bk(b,x.KeyInputManager.Qa(B.a.Yyd,x.KeyInputManager.Re|4),C.a.superscript,O.gK),D.AFrame.Bk(b,x.KeyInputManager.Qa(B.a.azd,x.KeyInputManager.Re|4),C.a.superscript,O.gK),D.AFrame.Bk(b,x.KeyInputManager.Qa(B.a.Zyd,x.KeyInputManager.Re|4),C.a.subscript,
O.gK),D.AFrame.Bk(b,x.KeyInputManager.Qa(B.a.uxc,x.KeyInputManager.Re|4),C.a.subscript,O.gK))}HLl(){const a=v.FocusManager.instance().Fc(D.AFrame.gE),b=v.FocusManager.instance().Fc(M.AppFrame.KW);var c=x.KeyInputManager.ww(Box4Intl.Box4Strings.l_HK_Undo);a.bindAction(c,G.a.PCa);b.bindAction(c,C.a.undo);c=x.KeyInputManager.Qa(B.a.iI,1);a.bindAction(c,G.a.PCa);z.a.Ik||b.bindAction(c,C.a.undo);c=x.KeyInputManager.ww(Box4Intl.Box4Strings.l_HK_Redo);a.bindAction(c,G.a.PCa);b.bindAction(c,C.a.redo);c=x.KeyInputManager.Qa(B.a.iI,
5);a.bindAction(c,G.a.PCa);z.a.Ik||b.bindAction(c,C.a.redo)}Ezl(){const a=v.FocusManager.instance().Fc(M.AppFrame.KW);N.a.instance.ga(54)?(z.a.Ik?this.ssa(a,x.KeyInputManager.Qa(B.a.Wzd,5),"\u20ac"):this.ssa(a,x.KeyInputManager.Qa(B.a.Qnb,x.KeyInputManager.Re|1),"\u20ac"),this.ssa(a,x.KeyInputManager.Qa(B.a.tAa,x.KeyInputManager.Re|1),"\u00a9"),this.ssa(a,x.KeyInputManager.Qa(B.a.PRb,x.KeyInputManager.Re|1),"\u00ae"),this.ssa(a,x.KeyInputManager.Qa(B.a.QRb,x.KeyInputManager.Re|1),"\u2122"),this.ssa(a,
x.KeyInputManager.Qa(B.a.uxc,x.KeyInputManager.Re|1),"\u2014"),this.ssa(a,x.KeyInputManager.Qa(B.a.nNa,x.KeyInputManager.Re|1),"\u2026"),this.ssa(a,x.KeyInputManager.Qa(B.a.l$e,x.KeyInputManager.Re|5),"\u00bf"),this.ssa(a,x.KeyInputManager.Qa(B.a.Vzd,x.KeyInputManager.Re|5),"\u00a1")):N.a.instance.ga(25)&&this.ssa(a,x.KeyInputManager.Qa(B.a.Qnb,x.KeyInputManager.Re|1),"\u20ac")}ssa(a,b,c){D.AFrame.Bk(a,b,C.a.sVa,O.pQj("symbol_"+c))}MQi(){if(w.AFrameworkApplication.iF){var a=v.FocusManager.instance().Fc(D.AFrame.Xi);
D.AFrame.Bk(a,x.KeyInputManager.Qa(B.a.Baf,x.KeyInputManager.Re|1),G.a.giveFeedback);D.AFrame.Bk(a,x.KeyInputManager.Qa(B.a.Caf,x.KeyInputManager.Re|1),G.a.giveFeedback)}}Vcl(){const a=v.FocusManager.instance().Fc(D.AFrame.Xi);z.a.Ex||D.AFrame.Bk(a,x.KeyInputManager.Qa(B.a.Snb,1),C.a.activateRibbonTab,O.zkb("tabHome"));D.AFrame.Bk(a,x.KeyInputManager.Qa(B.a.vAa,1),C.a.activateRibbonTab,O.zkb("tabInsert"));D.AFrame.Bk(a,x.KeyInputManager.Qa(B.a.Tnb,1),C.a.activateRibbonTab,O.zkb("tabPageLayout"));
D.AFrame.Bk(a,x.KeyInputManager.Qa(B.a.PRb,1),C.a.activateRibbonTab,O.zkb("tabReview"));D.AFrame.Bk(a,x.KeyInputManager.Qa(B.a.Faf,1),C.a.activateRibbonTab,O.zkb("tabView"))}static get instance(){return O.La||(O.La=new O)}static FTf(){return new J.DictionaryPropertySet}static gK(){return new R(2)}static pQj(a){return()=>{const b={};b.SourceControlId=a;return b}}static zkb(a){return()=>a}}O.La=null;Object(m.a)(O,"ShortcutRegistration",null,[]);class S{get name(){return"Box4.Shortcuts"}Yb(){}init(){O.instance.tUe()}dispose(){}static main(){n.a.instance.Ac(new S)}}
Object(m.a)(S,"Box4ShortcutsPackage",null,[2,3]);var T=d(304);class ca{$t(a,b,c=!1,f=!1,l=!1,y=null){return T.a.$t(a,b,c,f,l,y)}jxc(a,b,c){return T.a.jxc(a,b,c)}Ptb(a,b){return T.a.Ptb(a,b)}tW(a,b,c,f,l=!1,y=!1){return T.a.tW(a,b,c,f,l,y)}mRa(a,b=null){return T.a.mRa(a,b)}pea(){T.a.pea()}X8a(a,b,c,f=null){return T.a.X8a(a,b,c,f)}fFa(a,b,c=!1,f=!0){return T.a.fFa(a,b,c,f)}ccc(a,b){return T.a.ccc(a,b)}}Object(m.a)(ca,"TextMetricsAdapterProxy",null,[1391]);var L=d(316),da=d(153);class Z{Ouj(a){var b=
a;for(a=null;!a&&b&&"P"!==b.tagName;)a=L.a.ze(b,da.a.TPb),b=b.parentNode;b=-1;a&&(b=parseInt(a.toString(),10));return b}}Object(m.a)(Z,"TextMetricsHelper",null,[429]);class fa{constructor(){this.Da=null}get name(){return"Box4.TextMetrics"}init(){this.Da.resolve("Box4.ITextMetricsAdapter")}dispose(){}Yb(a){this.Da=a;this.Da.register(1391,"Box4.ITextMetricsAdapter").ma().oa(()=>new ca);this.Da.register(429,"Box4.TextMetricsApi.ITextMetricsHelper").ma().oa(()=>new Z)}static main(){n.a.instance.Ac(new fa)}}
Object(m.a)(fa,"Box4TextMetricsPackage",null,[2,3]);var aa=d(347),ja=d(251),I=d(7),sa=d(100),ka=d(392),Ma=d(732),Ea=d(99),ma=d(47),va=d(1263),Ca=d(1259),oa=d(67),Da=d(572),ta=d(105),ha=d(317),Ha=d(811),bb=d(269),Na=d(18),Ia=d(6);class Qa{static dll(a){const b=new Ma.a;for(let c of a)b.add(c);return b}static Bnh(a,b){const c=new Na.a;b=Qa.dll(b);for(let f of a)b.contains(f)||c.add(f);return c}static P5k(a,b){return Qa.Bnh(Ia.asEnumerable(a),b).toArray()}static Q5k(a,b){return Qa.Bnh(a,b)}}Object(m.a)(Qa,
"ExtendedGuidUtils",null,[]);var qa=d(1244),Wa=d(19),Hb=d(162);class jc{}jc.Gxi="ChangeInfo";Object(m.a)(jc,"CatchUpActivityConstants",null,[]);class gc{}gc.wJb="\u00a0";gc.REf="\ue200";gc.Yig="\ue201";gc.DXi=32767;gc.kQc=3;gc.Q3d=1;Object(m.a)(gc,"ContentEditableViewConstants",null,[]);var $b=d(555),wb=d(123),Db=d(34),Xb=d(371),ab=d(41),Ab=d(42),rc=d(90),tb=d(91),Za=d(54),fb=d(88);class ac{constructor(a,b,c){this.Sa=b;this.Mb=c}}Object(m.a)(ac,"ChangeInfo",null,[]);d(617);var Dc=d(830);class Sc{}
Object(m.a)(Sc,"InternalLinkConstants",null,[]);class xb extends Sys.EventArgs{constructor(){super();this.G9a=null}}Object(m.a)(xb,"EditEventArgs",Sys.EventArgs,[]);class Ta extends xb{constructor(){super();this.x8j=0;this.qHl=this.bRc=this.W5e=this.Z8j=this.xLj=this.Blg=this.l2f=this.I3i=this.Q_i=!1}}Object(m.a)(Ta,"ParagraphContentUpdatedEventArgs",xb,[]);class ib{constructor(a){this.k4c=a}}Object(m.a)(ib,"BlobPresenterArgs",null,[]);var ob=d(32);class fc{}fc.p4="TrackedChange";fc.vHh="TrackChangeTableRowInsertion";
fc.sHh="TrackChangeTableRowDeletion";fc.hIh="TrackChangeTextInsertion";fc.fIh="TrackChangeTextDeletion";fc.YKj="TrackChangeImageModified";fc.WKj="TrackChangeImageInsertion";fc.SKj="TrackChangeImageDeletion";fc.Nre="TrackChangeIndirectEffect";Object(m.a)(fc,"TrackChangeConstants",null,[]);var Jb=d(928),xc=d(98);const ic=a=>!!a.jSa&&Ia.AT(a.jSa,b=>3===b.type||2===b.type||4===b.type),nc=(a,b)=>{let c=!1,f=!1,l=null;if(b.jSa)for(let y of b.jSa)1===y.type&&(c=!0),3===y.type&&(f=!0),4===y.type&&y.Je&&y.Je.paragraph&&
(l=y);l&&Sys.UI.DomElement.addCssClass(a,xc.a.fQi);f&&Sys.UI.DomElement.addCssClass(a,xc.a.Ohg);c&&Sys.UI.DomElement.addCssClass(a,xc.a.$Pi)},Wb=a=>{const b=[xc.a.MWi,xc.a.NWi,xc.a.LWi];for(const c of b)Sys.UI.DomElement.removeCssClass(a,c)};var wc=d(365);class nb{constructor(a){this.WTb=this.XYb=this.Jdf=null;this.Qi=a}get paragraphNode(){return this.Qi}get jSa(){return this.Jdf}get hmb(){return this.XYb}get M9a(){return this.WTb}get isEmpty(){return(!this.jSa||!this.jSa.count)&&(!this.hmb||!this.hmb.count)&&
(!this.M9a||!this.M9a.count)}nFk(){this.hmb&&(this.XYb=new Na.a);this.M9a&&(this.WTb=new Na.a)}Jyd(a){this.jSa||(this.Jdf=new wc.a);this.hmb||(this.XYb=new Na.a);this.M9a||(this.WTb=new Na.a);this.jSa.Jyd(a,b=>{this.hmb.add(b)},b=>{this.M9a.add(b)})}}Object(m.a)(nb,"IntentRenderingState",null,[]);class Rb{constructor(a,b){this.element=a;this.next=b}}Object(m.a)(Rb,"ElementStackNode",null,[]);class mb{constructor(a=!1){this._history=new Sys.StringBuilder;this.bBa=this.sv=null;this.wZb=a}fbk(a){if(this.wZb&&
a){this._history.append("[Cp "+a.cp+":");if(a.$h)for(var b=0;b<a.$h.length;b++)this._history.append(a.$h.ga(b).Hy+","+a.$h.ga(b).Vfa),b!==a.$h.length-1&&this._history.append("|");if(a.Ck)for(a.$h&&this._history.append("|"),b=0;b<a.Ck.length;b++)this._history.append(a.Ck.ga(b).Nua?"B":"I"),this._history.append(a.Ck.ga(b).Jk?"S":"E"),this._history.append(a.Ck.ga(b).xBb?"R":"F"),b!==a.Ck.length-1&&this._history.append("|");this._history.append("]\n")}}clear(){if(this.sv){for(var a=this.sv;a.next;)a=
a.next;a.next=this.bBa;this.bBa=this.sv;this.sv=null;this.wZb&&this._history.append("Clear\n")}}peek(a=""){this.isEmpty()&&ka.ULS.sendTraceTag(50604245,324,15,"_top is null when calling Peek with Label: {0}. History: {1}",a,this._history.toString());this.wZb&&this._history.append(String.format("Peek Label: {0}\n",a));return this.sv.element}pop(a=""){this.isEmpty()&&ka.ULS.sendTraceTag(50604246,324,15,"_top is null when calling Pop with label {0}. History: {1}",a,this._history.toString());const b=
this.sv.element;this.sv.element=null;const c=this.sv.next;this.sv.next=this.bBa;this.bBa=this.sv;this.sv=c;this.wZb&&this._history.append(String.format("Pop {0} Label:{1}\n",b?b.className:"Null Element",a));return b}push(a,b=""){if(this.bBa){const c=this.bBa.next;this.bBa.next=this.sv;this.sv=this.bBa;this.bBa=c;this.sv.element=a}else this.sv=new Rb(a,this.sv);this.wZb&&this._history.append(String.format("Push {0} Label:{1}\n",a?a.className:"Null Element",b))}isEmpty(){return!this.sv}}Object(m.a)(mb,
"ElementStack",null,[]);class Ub{constructor(){this.Ubc=!1;this.span=null}}Object(m.a)(Ub,"IntelligentPlaceholderRenderingState",null,[]);class zc{constructor(a,b,c){this.eventName=a;this.Bc=b;this.handler=c}}Object(m.a)(zc,"ParagraphContentRendererMouseEventRegistration",null,[]);var Pc=d(77);class Mc extends Sys.EventArgs{constructor(a,b,c){super();this.element=a;this.paragraphNode=b;this.RLb=c}}Object(m.a)(Mc,"ParagraphContentRendererEventArgs",Sys.EventArgs,[]);class ld extends Mc{constructor(a,
b,c,f,l){super(a,b,c);this.XYb=f.hmb;this.WTb=f.M9a;this.KXh=l}get hmb(){return this.XYb}get M9a(){return this.WTb}get elementType(){return this.KXh}}Object(m.a)(ld,"IntentRangeRenderedEventArgs",Mc,[]);class vb extends Mc{constructor(a,b,c,f){super(a,b,c);this.Yp=f}}Object(m.a)(vb,"SpellingErrorRenderedEventArgs",Mc,[]);class cc{constructor(){this.Ma=new Pc.a}dispose(){this.Ma&&(this.Ma.dispose(),this.Ma=null)}MZk(a,b,c,f){this.Ma&&this.Ma.raiseEvent(cc.hIk,new vb(a,b,c,f))}ekh(a,b,c,f,l){this.Ma&&
this.Ma.raiseEvent(cc.kEk,new ld(a,b,c,f,l))}}cc.hIk="OnSpellingErrorRangeRendered";cc.kEk="OnIntentRangeRendered";Object(m.a)(cc,"ParagraphRenderEvents",null,[107]);class Hc{constructor(){this.LJf=null;this.dhg=!1;this.y4g=this.kwf=null}}Object(m.a)(Hc,"RenderParagraphContentResults",null,[]);var Pb=d(151),Uc=d(72),sc=d(382);class lb{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc){this.hBa=this.uId=this.tHd=this.brb=null;this.Pf=a;this.UP=b;this.hd=c;this.Kqa=f;this.yN=l;this.mw=H;this.b6a=
Q;this.bPa=ia;this.uWh=Ua;this.QV=kb;this.q5h=Gb;this.$Yh=ec;this.ZUh=Fc;this.Uuf=new Ma.a;this.YGc=dc;this.iqb=!!wa&&wa.VFa(65);this.hHc=this.kBc=null;this.KOa=y;this.r0h=!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("MinimizeIntelligentPlaceholderWorkIsEnabled");this.kd=wa}get fHf(){return!0}get epg(){null==this.tHd&&(this.tHd=!!this.kd&&this.kd.isFeatureEnabled(85));return this.tHd}get ttg(){null==this.uId&&(this.uId=!!this.kd&&this.kd.isFeatureEnabled(77));return this.uId}get iO(){null==
this.hBa&&(this.hBa=!!this.kd&&this.kd.isFeatureEnabled(79));return this.hBa}P9k(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd){this.kBc={};this.hHc=new Pb.a;const Vd=Db.ParagraphReader.text(a),Ld=new Na.a;var ye=!1;w.AFrameworkApplication.fa&&(ye=w.AFrameworkApplication.fa.ka("ElementStackTrackHistoryIsEnabled"));const Xd=new mb(ye);Xd.push(c,"RenderParagraphContentStart");let Xf=null,ug=null,qg=null,Fg=null,qf=ye=null;const bg=new Ta;var Kg=!1;let rg=!1,ui=!1,Ik=!1,vg=0,Lg=null,rh=null;const Bm=
new Na.a;this.YGc&&this.YGc.BXl(a,c);const xj=this.bPa.VW(a);this.bPa.Yli(c,a,b,xj,b.Md);if(this.b6a.Fx&&b.hm){var Cm=this.Pf.Rd;Cm&&1===Cm.editingView.mode&&(c.style.fontFamily="",c.style.fontSize="")}Cm=!a.cX;let go=!1,Tl=!1,ho=!1,Ul=!1,Kl=0,lm=!1,zn=!1,jl=null,oi=0;const An=new Ub,io=Array(a.Ta.length+1);let Ep=this.epg?new Na.a:null,Mm=null,Nm=null;for(;vg<a.Ta.length;){const we=a.Ta.ga(vg);var yj=void 0,kh=void 0,zj=!1;Xd.fbk(we);({kNc:yj,gNc:kh}=lb.q5f(we));this.epg&&(!this.r0h||yj.length||
kh.length)&&({kNc:yj,gNc:kh,wQi:Ep,EYj:zj}=lb.CNl(we.paragraph.Lh,yj,kh,Ep),An.Ubc=0<Ep.count);Ul=0<yj.length||Ul;io[vg]=c.childNodes.length;if(0<we.cp&&we.Vj)break;let lh=we.cp;const rj=vg<a.Ta.length-1?a.Ta.ga(vg+1).cp:Db.ParagraphReader.textLength(a);vg++;var zg=!1;0<lh&&Xd.pop("CurrentCpLargerThanZero");we.aM&&(Xf=null);we.zv&&(Nm=we.zv);we.isDictationCorrectionEnd&&(Nm=null);we.OY&&(ug=null);we.y4&&(qg=null);we.Ila&&(Fg=null);var Rd=void 0,gf=void 0;this.iO?(Rd=we.Bea,gf=we.V_):(Rd=!!we.To,gf=
!!we.fieldRangeEnd);if(!Kg||we.blob||we.formatting||we.hyperlink||we.zn||we.B4||gf||Rd||this.iqb&&(we.isTrackChangeInfoEnd||we.qO)||we.yw&&!we.yw.isEmpty)zg=!0,0<lh&&Kg&&Xd.pop("InFormattingSpan");gf&&(Xd.pop("HasFieldEnd"),Kg=!1);we.zn&&(go||(ui=!0),Tl=go=!1);we.hyperlink&&(go&&(ui=!0),go=!0,Tl=we.hyperlink.Lua);we.zn&&!ui&&(Xd.pop("IsHyperlinkEnd"),Kg=!1);this.kd&&this.kd.isFeatureEnabled(17)&&(we.isChangeEnd&&(lm||ka.ULS.sendTraceTag(36282713,324,15,"Found catch up change end with out change start!"),
lm=!1,rh=null),we.changeStart&&(lm&&ka.ULS.sendTraceTag(36282714,324,15,"Found catch up change start with out change end!"),rh=we,lm=!we.Vj));if(this.iqb&&(we.isTrackChangeInfoEnd&&(ho||(Ik=!0),ho=!1,Lg=null),we.qO&&(ho&&(Ik=!0),Lg=we,ho=!we.Vj),we.isTrackChangeInfoEnd&&!Ik)){for(Kg=0;Kg<Kl;Kg++)Xd.pop("IsTrackChangeInfoEnd");Kl=0;Kg=!1}Mm&&Mm.nFk();we.yw&&(Mm||(Mm=new nb(a)),Mm.Jyd(we.yw));if(we.B4&&!we.Vj){ye=ye||we.formatting;gf=this.jPf(Xd.peek("CreateIpFormattingSpan"),ye,xj,b,a,Ua,ia,Lg);gf=
Ea.a.iab(gf);for(let Aj of gf)kb=lb.eja(l,kb,Aj);bg.Blg=!0}we.hyperlink&&!ui&&({FGa:kb,hYi:zn,returnValue:qf}=this.I9k(qf,we,Xd,xj,bg,b,a,f,l,y,H,ia,Lg,kb,Ua,Cm,Kg,zn));!this.iqb||Ik||we.Vj||(we.Ap&&(this.ZVe(we.Ap,Xd,bg,b,ia),Kl++),we.Qo&&(this.ZVe(we.Qo,Xd,bg,b,ia),Kl++),we.Ys&&(this.ZVe(we.Ys,Xd,bg,b,ia),Kl++));Rd&&({hSa:ye,FGa:kb,returnValue:qf}=this.E9k(qf,l,a,we,ye,Xd,xj,bg,b,ia,Ua,kb,Kg,Cm,Lg));this.ttg&&this.aJf(a,b,yc&&Fc);we.blob?({FGa:kb,Y8j:jl,X8j:oi,returnValue:rg}=this.w9k(kb,Kg,ye,
we,y,H,Cm,qf,Xd,xj,bg,lh,rg,Fc,b,Bm,yc,a,Ua,l,Gb,ec,Q,ia,Ld,Lg,rh,yj,kh,jl,oi,Mm),Kg=!1,ye=qf=null):(Rd=we.B4&&!ma.a.substring(Vd,lh,rj).length,zg&&(zg=qf,{hSa:ye,returnValue:qf}=this.G9k(ye,we,xj,Xd,bg,b,a,ia,Lg,Ua,Rd),Kg=!0,qf&&qf.style&&(zn&&zg&&zg.style&&(zg.style.fontSize=qf.style.fontSize,zg.style.lineHeight=qf.style.lineHeight),jl&&jl.style&&0<oi&&we.formatting&&we.formatting.cache.sua&&oi>we.formatting.cache.fontSize&&(jl.style.fontSize=qf.style.fontSize,jl.style.lineHeight=qf.style.lineHeight))),
zn=!1,jl=null,oi=0,Rd||(we.Yp&&(Xf=we.Yp),we.OF&&(qg=we.OF),we.bM&&(Fg=we.bM),we.Vw&&(ug=we.Vw),zg=ma.a.substring(Vd,lh,rj),zj=this.A1d(Xd.peek("CreateTextOverlaySpan1"),ye,a,Xf,qg,Fg,ug,b,Bm,ia,zg,yc&&(Gb<=lh&&lh<ec||a.cX),xd,An,zj,Mm,!!Nm,Tl),Xd.push(zj,"TextOverlaySpan1"),bg.W5e=!0,this.YRd(Xd.peek("AddCommentHintCssAndDataToElement"),yj,kh),this.yN&&this.yN.yAb&&Xf&&Xf.Eh&&(yj=Object(qa.a)(295,Xf.Eh))&&yj.ON&&yj.ON.TraceId&&5===yj.proofingType&&!yj.vFa&&(this.E5k(Xd.peek("RemoveConsistencyCheckCustomData")),
kh=this.pdj(we.Yp,a,vg),L.a.aw(Xd.peek("errorDetails"),kh,yj.ON.TraceId)),this.zZe(rh,Xd.peek("SetChangeId"),we.cp,rj),yc&&Gb!==ec&&({FGa:kb,returnValue:lh}=this.GUk(zj,Xd,ye,a,Xf,qg,Fg,ug,bg,b,l,Bm,ia,Vd,Gb,ec,kb,lh,rj,xd,An,Mm,!!Nm,Tl)),Ea.a.Mz(Xd.peek("SetElementText"),ma.a.substring(Vd,lh,rj)),kb=lb.eja(l,kb,Xd.peek("AddLeafNodeElement"))))}if(a.FYc!==Ul||this.iqb||this.b6a.Hxc)a.FYc=Ul,(f=Za.OutlineElementNavigator.vB(a))&&f.t9(b.Na,32,!0);({k4c:qf,FGa:kb,returnValue:Kg}=this.K9k(a,c,ye,xj,bg,
qf,b,a,l,ia,Lg,Ua,kb,Kg,Cm));!An.Ubc&&An.span&&this.EUd(null,An.span);Cm&&this.D9k(c,qf,bg,b,a,l,ia,wa,kb,dc,rh);io[io.length-1]=c.children.length;this.yOl(rg,tc,b);this.tPl(bg,Kg,l);this.rxh(b,a,c);let Lf;return Lf=new Hc,Lf.LJf=Ld,Lf.dhg=rg,Lf.kwf=io,Lf.y4g=Bm,Lf}RLb(a,b,c,f){this.UP.rb(a,b,c,f);return new zc(a,b,c)}pdj(a,b,c){let f=0;a&&a.Eh&&(f|=16);if(c<b.Ta.length&&b.Ta.ga(c).aM||c===b.Ta.length)f|=1;switch(f){case 0:return Jb.a.PJe;case 16:return Jb.a.A4c;case 1:return Jb.a.lqd;case 17:return Jb.a.RKc}return""}E5k(a){L.a.Soa(a,
Jb.a.PJe);L.a.Soa(a,Jb.a.A4c);L.a.Soa(a,Jb.a.lqd);L.a.Soa(a,Jb.a.RKc)}zZe(a,b,c,f){this.kd&&this.kd.isFeatureEnabled(17)&&a&&a.changeStart&&L.a.aw(b,jc.Gxi,new ac(a.changeStart.id,c,f))}I9k(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc){!Fc||yc||b.B4||(a=this.j3b(c.peek("CreateFormattingSpan1"),null,f,y,H,kb,dc,Gb),a.className+=" EmptyTextRun",ec=lb.eja(ia,ec,a),tc=l.bRc=!0);b=this.ZLi(c.peek("CreateLinkAnchor"),b.hyperlink,y,Q,wa,Ua,kb);c.push(b,"RenderHyperlink");l.Z8j=!0;return{returnValue:a,FGa:ec,
hYi:tc}}ZVe(a,b,c,f,l){a=this.xPi(b.peek("CreateTrackChangeRange"),a,f,l);b.push(a,"RenderTrackChange");c.qHl=!0}E9k(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc){Gb||f.B4||(l=f.formatting||l,ec?(a=this.j3b(y.peek("CreateFormattingSpan2"),l,H,ia,c,wa,Ua,dc),a.appendChild(ia.ownerDocument.createTextNode("")),a.className+=" EmptyTextRun",kb=lb.eja(b,kb,a),Q.bRc=!0):(a=this.ROc(l,H,ia,c,Ua,dc),Q.l2f=!0));b=this.ZKi(y.peek("CreateFieldRangeSpan1"),ia,wa,c);y.push(b,"RenderFieldRange");Q.I3i=!0;return{returnValue:a,
hSa:l,FGa:kb}}w9k(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye,Xd,Xf,ug,qg,Fg,qf,bg,Kg,rg,ui){b||(c=f.formatting||c,H&&!f.B4?(Q=this.j3b(ia.peek("CreateFormattingSpan4"),c,wa,dc,tc,Xf,xd,qg),Q.appendChild(dc.ownerDocument.createTextNode("")),Q.className+=" EmptyTextRun",a=lb.eja(Vd,a,Q),Ua.bRc=!0):Q=this.ROc(c,wa,dc,tc,xd,qg));1===f.blob.Bq&&(Gb=!0);b=f.blob.ooj(dc);b.f3f(new ib(Q));Q=b.element;Sys.UI.DomElement.containsCssClass(Q,xc.a.fdc)&&(Kg=Q,c&&c.cache.sua&&(rg=c.cache.fontSize));
Sys.UI.DomElement.addCssClass(Q,xc.a.FN);this.b6a.TWi&&5!==f.blob.Bq&&Sys.UI.DomElement.addCssClass(Q,xc.a.PWi);this.iqb&&this.J9k(f,dc,Q,qg);this.YRd(Q,qf,bg);ui&&!ui.isEmpty?(nc(Q,ui),this.brb&&this.brb.ekh(Q,tc,(Ik,vg,Lg,rh)=>{Fc.add(this.RLb(Ik,vg,Lg,rh))},ui,1)):Wb(Q);this.zZe(Fg,Q,f.cp,f.cp+1);ia.peek("blobElt").appendChild(Q);Xd(Q,!0);ug.add(f.blob);yc&&(Ld<=kb&&kb+1<=ye||tc.cX)?(ec&&(Sys.UI.DomElement.containsCssClass(Q,xc.a.R1d)||Sys.UI.DomElement.addCssClass(Q,xc.a.R1d),w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordTouchImageGrippiesResizedSettings"),
w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("TouchImageGrippiesResizedIsEnabled")&&this.Pf&&this.Pf.Rd&&Object(Wa.a)($b.PageView,this.Pf.Rd)&&(c=this.Pf.Rd,kb=w.AFrameworkApplication.Ra,c&&3===c.rug?kb.Ka(C.a.lJh,2,Q):kb.Ka(C.a.mJh,2,Q))),Sys.UI.DomElement.addCssClass(Q,xc.a.B8)):(Sys.UI.DomElement.removeCssClass(Q,xc.a.R1d),Sys.UI.DomElement.removeCssClass(Q,xc.a.B8));this.ttg||this.aJf(tc,dc,yc&&ec);Sys.UI.DomElement.removeCssClass(Q,xc.a.bQi);this.kd&&this.kd.isFeatureEnabled(162)&&
5===f.blob.Bq&&(f=f.blob,f.properties&&f.properties.Ua(ab.a.o$b)&&(f=f.properties.eb(ab.a.o$b))&&""!==f&&(Fc.add(this.RLb(oa.a.Sfa,Q,l,f)),Fc.add(this.RLb(oa.a.Sfa,Q,y,f))));a=lb.eja(Vd,a,Q);ia.push(Q,"RenderBlob");return{returnValue:Gb,FGa:a,Y8j:Kg,X8j:rg}}YRd(a,b,c){b.length?(Sys.UI.DomElement.addCssClass(a,xc.a.jNc),L.a.aw(a,xc.a.TZd,b)):Sys.UI.DomElement.removeCssClass(a,xc.a.jNc);c.length&&L.a.aw(a,xc.a.PZd,c)}aJf(a,b,c){a=ob.GraphIterator.pb(a);a.kf();a.Kg(11);if(b=a.currentNode.qc(b.Na))b.htmlElement.style.zIndex=
c?"1":""}J9k(a,b,c,f){let l=Ea.a.dcj(c,lb.nJh);5===a.blob.Bq&&f?(l||(l=b.lp(Ca.a.span),l.id=lb.nJh,Sys.UI.DomElement.addCssClass(l,fc.YKj),Sys.UI.DomElement.addCssClass(l,fc.p4),c.appendChild(l)),this.t3f(b,l,f.Ap,fc.SKj),this.t3f(b,l,f.Qo,fc.WKj)):l&&c.removeChild(l)}t3f(a,b,c,f){c&&!Ea.a.j7b(b,f)&&(a=a.lp(Ca.a.span),a.className=f,a.style.borderBottom="2px solid #000",b.appendChild(a))}G9k(a,b,c,f,l,y,H,Q,ia,wa,Ua){a=b.formatting||a;b=Ua?this.ROc(a,c,y,H,wa,ia):this.j3b(f.peek("CreateFormattingSpan5"),
a,c,y,H,Q,wa,ia);f.push(b,"RenderFormattingSpan");l.l2f=!0;return{returnValue:b,hSa:a}}GUk(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye,Xd,Xf){tc<dc&&dc<xd&&(tc=ma.a.substring(ec,tc,dc),Ea.a.Mz(a,tc),yc=lb.eja(Ua,yc,a),b.pop("ProcessSelectionBegins"),a=this.A1d(b.peek("CreateTextOverlaySpan2"),c,f,l,y,H,Q,wa,kb,Gb,tc,!0,Vd,Ld,!1,ye,Xd,Xf),b.push(a,"TextOverlaySpan2"),tc=dc,ia.W5e=!0);tc<Fc&&Fc<xd&&(ec=ma.a.substring(ec,tc,Fc),Ea.a.Mz(a,ec),yc=lb.eja(Ua,yc,a),b.pop("ProcessSelectionEnds"),
a=this.A1d(b.peek("CreateTextOverlaySpan3"),c,f,l,y,H,Q,wa,kb,Gb,ec,!1,Vd,Ld,!1,ye,Xd,Xf),b.push(a,"TextOverlaySpan3"),tc=Fc,ia.W5e=!0);return{returnValue:tc,FGa:yc}}K9k(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc){if(0<a.Ta.length){const Fc=a.Ta.last;let yc;yc=!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("TextRunForHyperlinkInTableCellEnabled");a=ob.GraphIterator.pb(a);!Fc.zn||yc&&a.sc(16)||(ec=!1,c=null);if(this.iO?Fc.V_:Fc.fieldRangeEnd)ec=!1,c=null;if(Fc.B4){c||(c=Fc.formatting);y=this.jPf(b,
c,f,H,Q,kb,wa,Ua);b=Ea.a.iab(y);for(let tc of b)Gb=lb.eja(ia,Gb,tc);l.Blg=!0}else!ec&&dc&&(c||(c=Fc.formatting),y=this.j3b(b,c,f,H,Q,wa,kb,Ua),y.appendChild(H.ownerDocument.createTextNode("")),y.className+=" EmptyTextRun",Gb=lb.eja(ia,Gb,y),l.bRc=!0)}else ka.ULS.sendTraceTag(18482315,324,15,"CharacterProperties has no elements");return{returnValue:ec,k4c:y,FGa:Gb}}D9k(a,b,c,f,l,y,H,Q,ia,wa,Ua){var kb=lb.wbj(a,wa);b=this.TOf(b,f,Q,kb);Da.a.instance.shipAssertTag(25519712,8,0<l.Ta.length,"Chps should never be empty");
Q=null;l.Ta&&0<l.Ta.length&&(Q=l.Ta.last);this.iqb&&Q&&(Q.Ap||Q.Qo||Q.Ys)&&(b.className+=" "+fc.p4);let Gb;({kNc:kb,gNc:Gb}=lb.q5f(Q));this.YRd(b,kb,Gb);this.zZe(Ua,b,Q?Q.cp:0,-1);wa&&(b.className+=" "+Xb.a.G2d);this.rxh(f,l,b);a.appendChild(b);H(b);lb.eja(y,ia,b);c.Q_i=!0}rxh(a,b,c){if(a.hm&&this.Kqa.$kd&&this.Kqa.wtl(c)){if((a=this.Kqa.gua(b))&&0<ta.a.count(a))try{c.setAttribute("data-ccp-props",JSON.stringify(a))}catch(f){ka.ULS.sendTraceTag(23639749,307,15,"SetParagraphPropertiesOnHtmlElement for CCP - Cannot serialize object contains circular reference.")}(b=
this.Kqa.Suj(b))&&0<b.length&&c.setAttribute("data-indent",b)}}xPi(a,b,c,f){c=c.lp(Ca.a.span);switch(b.changeType){case 2:c.className=fc.fIh+" "+fc.p4;c.style.color="#000";break;case 1:c.className=fc.hIh+" "+fc.p4;c.style.color="#000";break;case 3:c.className=fc.p4}a.appendChild(c);f(c);return c}yOl(a,b,c){a&&!b?c.notify(1):!a&&b&&c.notify(2)}tPl(a,b,c){a.x8j=c.count;a.xLj=b;this.q5h(a)}ZLi(a,b,c,f,l,y,H){c=c.lp(Ca.a.a);c.className=xc.a.mig;b.Lua&&b.Jtc&&!N.a.instance.ga(61)&&(b.url.endsWith(w.AFrameworkApplication.fa.Ha("UserPrincipalName"))?
c.className+=" "+xc.a.hQi:c.className+=" "+xc.a.iQi);this.mw.yBh()&&(c.style["pointer-events"]="all");this.mw.TAh(this.b6a.ORl,!0)&&this.q6k(c);this.UP.rb(oa.a.Sfa,c,l,b.url);this.UP.rb(oa.a.Tfa,c,y);f.add(c);b.url&&ma.a.C9(b.url)&&!z.a.Vi&&(Hb.d(c,va.a.href,b.url),Hb.d(c,va.a.target,"_blank"),Hb.d(c,va.a.rel,"noreferrer"));a.appendChild(c);H(c);return c}q6k(a){a.style.textDecoration="none";a.style.color="inherit"}j3b(a,b,c,f,l,y,H,Q){b=this.ROc(b,c,f,l,H,Q);a.appendChild(b);y(b);return b}ROc(a,b,
c,f,l,y){if(this.fHf){var H=a?a.Am.toString():ha.a.nil.toString();if(H in this.kBc)a=this.kBc[H];else{let Q=a?a.cache:Dc.FormattingCacheManager.K$a(f,ha.a.nil);a=this.v0d(a,Q,b,c,f,l);this.kBc[H]=a}b=a.cloneNode();L.a.TNc(a,b)}else H=a?a.cache:Dc.FormattingCacheManager.K$a(f,ha.a.nil),b=this.v0d(a,H,b,c,f,l);this.ICf(b,y);return b}v0d(a,b,c,f,l,y){const H=f.lp(Ca.a.span);b=this.mw.X5f(f,b,l)||b;this.Hli(f,H,b,l);this.Mli(H,b,l,f,y);this.Wli(H,a);this.bPa.Zli(H,l,c,f.Md,b.fontSize,b.wL);return H}Hli(a,
b,c,f){a=this.mw.V5f(a,f,c);for(let l of a.keys)b.setAttribute(l,a.ga(l))}jPf(a,b,c,f,l,y,H,Q){var ia=b?b.cache:Dc.FormattingCacheManager.K$a(l,ha.a.nil);ia=this.ZUh(ia,l);b=this.v0d(b,ia,c,f,l,y);this.ICf(b,Q);ia.isSuperscript||ia.cG?(f=f.lp(Ca.a.span),this.ECf(f,ia,!0),b.appendChild(f),Ea.a.Mz(f,""),H(f)):Ea.a.Mz(b,"");a.appendChild(b);H(b);return b}Mli(a,b,c,f,l){var y=b.xt;const H=[];Array.add(H,xc.a.JMa);var Q=this.mw.bae(c,b,this.b6a.PRl,y);var ia=null;b.hbb&&(ia=b.gS,ia=ia===rc.a.auto?"transparent":
rc.a.bH(ia));b.VUa&&(ia=b.highlight,ia=ia===rc.a.auto?"transparent":rc.a.bH(ia));c.a6g!==rc.a.nil&&(Q=rc.a.bH(c.a6g));l!==rc.a.nil&&(ia=rc.a.bH(l));Ea.a.$Ca(a);b.Igg&&(a.style.opacity=b.Q1f.toString());b.Vbb&&(a.title=Box4Intl.Box4Strings.l_DeadWordLink);Q?(a.style.color=Q,Hb.d(a,va.a.oRf,"WindowText"===Q?"auto":"none")):Hb.d(a,va.a.oRf,"auto");ia?(a.style.backgroundColor=ia,"transparent"!==ia&&Array.add(H,"Highlight")):Sys.UI.DomElement.removeCssClass(a,"Highlight");l=b.fontSize;if(b.isSuperscript||
b.cG)l=Math.floor(l*this.mw.rde());Q=this.mw.p7f(l,c,f.Md);ia=this.mw.z7b(b);l=this.QV&&this.QV.s7i?this.QV.Abi(b.wL):this.uWh(ia);this.b6a.Jne&&l&&aa.FontUtils.EBb(ia)&&(l=this.mw.KCf(ia,l));let wa=b.PUa&&b.isBold;void 0===wa&&(wa=!1);let Ua=b.ebb&&b.isItalic;void 0===Ua&&(Ua=!1);l=this.mw.Fih(new Ha.a(ia,wa,Ua),l,c);!this.UKl(ia,b,a.style)&&b.PUa&&(b.isBold?(a.style.fontWeight="bold",z.a.Ik&&z.a.ik&&Array.add(H,"MacChromeBold")):a.style.fontWeight="normal");b.ebb&&(a.style.fontStyle=b.isItalic?
"italic":"normal");(b.Azb||y&&this.mw.VAh()||b.zzb||b.I9b)&&this.$Ve(a,b,c,H);Q&&(a.style.fontSize=Q);if(l&&(a.style.fontFamily=l,N.a.instance.ga(118))){Da.a.instance.J(51676058,8,4,"UseQuotesWithFontFamily is Enabled.");c=new Sys.StringBuilder("");y=l.split(",");for(l=0;l<y.length-1;l++)c.append('"'+y[l].trim()+'",');0<y.length&&c.append('"'+y[y.length-1].trim()+'"');a.style.fontFamily=c.toString()}b.QUa&&(1===b.capitalization?a.style.fontVariant="small-caps":2===b.capitalization?a.style.textTransform=
"uppercase":a.style.fontVariant="normal");if(f=this.mw.T4f(b,f.Md))a.style.letterSpacing=f;if(b=this.mw.s8f(b))a.style.fontKerning=b,z.a.bU&&(a.style.fontFeatureSettings="normal"===b?'"kern" 1':'"kern" 0');a.className=H.join(" ")}UKl(a,b,c){return N.a.instance.ga(116)&&z.a.Ik&&z.a.ik?"Community Light"===a?(c.fontWeight=b.isBold?"400":"300",!0):"Community Semibold"===a?(c.fontWeight=b.isBold?"bold":"600",!0):"Community Slab Medium"===a?(c.fontWeight=b.isBold?"bold":"500",!0):"Community Slab Semibold"===
a?(c.fontWeight=b.isBold?"bold":"600",!0):!1:!1}ICf(a,b){this.hd.ig&&b&&!b.Vj&&(b.Ap||b.Qo)&&(a.style.color="#000")}Wli(a,b){if(b=b?this.$Yh(b):0){const c=bb.a.He(b);c?(a.setAttribute("xml:lang",c.name),a.setAttribute("lang",c.name)):this.Uuf.contains(b)||(ka.ULS.sendTraceTag(18482318,324,15,"Unknown LCID encountered in file: {0}",b),this.Uuf.add(b))}}$Ve(a,b,c,f){c="";const l=b.xE,y=b.bG;b=b.U_;l&&(c="underline",f[f.length]="Underlined");if(y||b)c=l?c+" line-through":"line-through",f[f.length]="Strikethrough";
l||y||b||(c="none");0<c.length&&(a.style.textDecoration=c)}ECf(a,b,c){b.isSuperscript&&(a.style.verticalAlign="super",a.className+=" Superscript");b.cG&&(a.style.verticalAlign="sub",a.className+=" Subscript");c&&(a.style.backgroundColor="inherit");(b.isSuperscript||b.cG)&&Hb.d(a,va.a.qRf,(b.fontSize/2).toString())}A1d(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc){const xd=b?b.cache:Dc.FormattingCacheManager.K$a(c,ha.a.nil);Ua=!f||Gb||this.XSa(f,Ua)?0:f.Eh.proofingType;Gb=!!l;const Vd=!!y,Ld=!!H;
y=this.mw.pBh(xd,kb,l,y,H);if(ec.Ubc||Fc&&ic(Fc))y=!1;this.fHf?(l=this.Vuj(xd,Ua,Gb,Vd,Ld,kb,y,yc),this.hHc.Fb(l)?kb=this.hHc.ga(l):(kb=this.sQf(Q,xd,Ua,Gb,Vd,Ld,kb,y,yc,f),this.hHc.$(l,kb)),Q=kb.cloneNode(),L.a.TNc(kb,Q)):Q=this.sQf(Q,xd,Ua,Gb,Vd,Ld,kb,y,yc,f);this.Qji(a,Q,xd);this.STd(a,Q);this.uAf(Q);this.tAf(a,Q);this.Kqa.KIi&&this.Rji(Q,b,c);this.brb&&0!==Ua&&this.brb.MZk(Q,c,(ye,Xd,Xf,ug)=>{ia.add(this.RLb(ye,Xd,Xf,ug))},f);ec.Ubc&&dc&&ec.span&&(this.EUd(null,ec.span),ec.span=null);if((b=ec.Ubc?
Q:null)||ec.span)this.EUd(b,ec.span),ec.span=b,ec.span&&(b=(b=L.a.ze(a,da.a.G4c))?b:-1,0<b&&(ec.span.style.lineHeight=String.format("{0}px",b+3)));Fc&&!Fc.isEmpty&&(nc(Q,Fc),this.brb&&this.brb.ekh(Q,c,(ye,Xd,Xf,ug)=>{ia.add(this.RLb(ye,Xd,Xf,ug))},Fc,0));tc&&Sys.UI.DomElement.addCssClass(Q,xc.a.gQi);a.appendChild(Q);wa(Q);return Q}XSa(a,b){b=a&&a.Eh&&a.Eh.token?a.Eh.token:b;return 0!==a.Eh.errorType&&!!this.KOa&&this.KOa.contains(b,a.Eh.lcid)}Vuj(a,b,c,f,l,y,H,Q){b|=0;y&&(b|=16);H&&(b|=32);c&&(b|=
64);f&&(b|=128);l&&(b|=256);Q&&(b|=2048);a.isSuperscript&&(b|=512);a.cG&&(b|=1024);return b}sQf(a,b,c,f,l,y,H,Q,ia,wa){a=a.lp(Ca.a.span);const Ua=[];if(0!==c){if(!this.b6a.TUl)switch(w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopV2Proofing",!1)&&wa&&(ia=wa.Eh)&&ia.WAf&&Ua.push("annotation-"+ia.WAf),c){case 1:Ua[Ua.length]=xc.a.ZOc;break;case 2:Ua[Ua.length]=xc.a.XOc;break;case 3:Ua[Ua.length]=xc.a.WOc}b.isSuperscript&&(Ua[Ua.length]=xc.a.T1d)}else ia&&
(Ua[Ua.length]=xc.a.ZPi);H&&(Ua[Ua.length]=xc.a.B8);f&&(Ua[Ua.length]=xc.a.O1d);l&&(Ua[Ua.length]=xc.a.Q1d);y&&(Ua[Ua.length]=xc.a.YOc);a.className=0<Ua.length?Ua.join(" "):xc.a.I3b;this.ECf(a,b,Q);return a}Rji(a,b,c){if(b&&a){if(b=tb.a.Pxb(b))if(b=fb.StyleReader.HQ(b)){a.setAttribute("data-ccp-charstyle",b);return}(c=Db.ParagraphReader.ae(c)?fb.StyleReader.tE(c):null)&&(c=fb.StyleReader.HQ(c))&&c!==fb.StyleReader.sNa&&c!==fb.StyleReader.SQh&&a.setAttribute("data-ccp-parastyle",c)}}Qji(a,b,c){(c=
this.mw.Vbg(c))&&a.style&&a.style.fontSize&&""!==a.style.fontSize&&(a=a.style.fontSize,a=parseFloat(ma.a.substring(a,0,a.indexOf("px"))),isNaN(a)||(b.style.verticalAlign=a/this.mw.rde()*c/100+"px"))}STd(){}uAf(){}tAf(){}ZKi(a,b,c,f){b=b.lp(Ca.a.span);b.className=xc.a.X6d;this.YGc&&this.YGc.GYl(f,b);a.appendChild(b);c(b);return b}TOf(a,b,c,f){b=b.lp(Ca.a.span);b.className=xc.a.VN;a&&(b.style.fontSize=a.style.fontSize,b.style.lineHeight=this.D$d(a),b.style.fontFamily=a.style.fontFamily,Object(sc.a)("UpdateTextColorInEOP")&&
(b.style.color=a.style.color));a="";for(let l=0;l<f;l++)a+=c;b.innerText=a;return b}D$d(a){return a.style.lineHeight}EUd(a,b){a?(Sys.UI.DomElement.addCssClass(a,"Highlight"),Sys.UI.DomElement.addCssClass(a,xc.a.cQi),b||Sys.UI.DomElement.addCssClass(a,xc.a.P1d)):b&&((a=Sys.UI.DomElement.containsCssClass(b,xc.a.P1d))&&Sys.UI.DomElement.removeCssClass(b,xc.a.P1d),Sys.UI.DomElement.addCssClass(b,a?xc.a.eQi:xc.a.dQi))}static eja(a,b,c){L.a.aw(c,da.a.EGa,b);b<a.count?a.$(b,c):a.add(c);return b+1}static q5f(a){let b,
c;b=[];c=[];if(a&&a.Bg)for(let f=0;f<a.Bg.length;f++){const l=a.Bg.ga(f);Array.add(l.Jk?b:c,l.LI)}return{kNc:b,gNc:c}}static vri(a,b){const c=new Uc.a;for(const l of b){var f=a.ze(l);b=f.eb(Ab.a.r2b);if(f=f.sa(Ab.a.hNc,null)){let y;({value:y}=c.wg(f)).returnValue||(y=new Na.a,c.$(f,y));y.add(b)}}return c}static s5f(a,b,c){const f=new Na.a,l=lb.vri(a,b);for(const y of b){const H=a.ze(y),Q=H.eb(Ab.a.r2b),ia=H.sa(Ab.a.VGi,!1),wa=H.sa(Ab.a.VLf,!1);H.sa(Ab.a.doe,!1)&&!wa&&(c.add(y),ia||l.Fb(Q)||f.add(H.id))}return Qa.P5k(b,
f)}static CNl(a,b,c,f){const l=new Na.a,y=new Na.a;b=lb.s5f(a,b,l);a=lb.s5f(a,c,y);c=new Na.a;c.addRange(f);c.addRange(l);c=Qa.Q5k(c,y);return{kNc:b,gNc:a,wQi:c,EYj:0<y.count}}static wbj(a,b){var c=1;if(z.a.aG&&!b){a=Ea.a.YTc(a,!1);for(let f of a)"IMG"===f.tagName?c+=3:Sys.UI.DomElement.containsCssClass(f,"PageBreakBlob")&&(c+=gc.kQc+gc.Q3d)}return c}}lb.q7i=.8;lb.nJh="TrackChangeImageOverlay";Object(m.a)(lb,"ParagraphContentRenderer",null,[1410]);var Zb=d(76),Oc=d(613),md=d(1258),Ib=d(56);class ud{constructor(a){this._element=
null;this.oi=a;this.IBc=[]}get ownerDocument(){return this.oi}get element(){return this._element}ylb(a){this._element=a}n6g(){var a=Sys.EventArgs.Empty;if(this.IBc)for(let b=0;b<this.IBc.length;b++)(0,this.IBc[b])(this,a)}dispose(){this.IBc=this._element=this.oi=null}}Object(m.a)(ud,"APresenter",null,[1454,107]);class od extends ud{constructor(a,b){super(b.htmlElement.ownerDocument);this.nqb=null;this.kXb=a;this.A$h=b}f3f(a){this.element&&a.k4c===this.nqb||(this.nqb=a.k4c,this.ylb(this.kXb.TOf(this.nqb,
this.A$h.Nd,da.a.lRc,1)),this.element.className=xc.a.fdc,this.element.style.lineHeight=this.nqb.style.lineHeight,a=""+L.a.ze(this.nqb,da.a.TPb),L.a.aw(this.element,da.a.TPb,a),a=md.a.createElement(this.ownerDocument,Ca.a.span),a.innerText=da.a.Cxi,Ea.a.vv(this.element),this.element.appendChild(a),a=md.a.createElement(this.ownerDocument,Ca.a.br),this.element.appendChild(a))}llg(){}dispose(){super.dispose();this.nqb=null}}Object(m.a)(od,"LineBreakPresenter",ud,[]);class Ud{constructor(a){this.kXb=a}create(a){return new od(this.kXb,
a)}}Object(m.a)(Ud,"LineBreakPresenterFactory",null,[1409]);class Ad extends ud{constructor(a,b){super(a.ownerDocument);this.QQd=b;this.Hca=a}f3f(){this.element||(this.ylb(this.Hca.lp(Ca.a.span)),19===this.QQd.kind||18===this.QQd.kind?Sys.UI.DomElement.addCssClass(this.element,xc.a.N1d):(Sys.UI.DomElement.addCssClass(this.element,xc.a.J3b),this.element.title=Box4Intl.Box4Strings.l_UnsupportedTooltip),this.element.innerText=this.QQd.w9a,this.n6g())}llg(){this.ylb(null);this.n6g()}}Object(m.a)(Ad,"UnsupportedObjectPresenter",
ud,[]);class be{create(a,b){return new Ad(a,b)}}Object(m.a)(be,"UnsupportedObjectPresenterFactory",null,[1408]);class uf{constructor(a=!1,b=!1,c=!1,f=!1,l=!1,y=!1,H=!1){this.Fx=a;this.TWi=b;this.ORl=c;this.PRl=f;this.Hxc=l;this.Jne=y;this.TUl=H}}Object(m.a)(uf,"ParagraphContentRendererSettings",null,[]);var sd=d(114);class Ze{constructor(a,b,c){this.PV=a;this.GZ=b;this.RTb=c}Y$a(a){return a}p7f(a,b,c){return c.Pja(a)}T4f(){return null}s8f(){return z.a.ik&&window.chrome?"none":null}AJf(){return!1}iKh(){return!1}KCf(){return""}YOh(){}sMf(){}uBh(a){return a===
C.a.underline||a===C.a.vpa||a===C.a.strikethrough||a===C.a.nt||a===C.a.Q1}sRe(a,b){this.PV&&this.PV.isEnabled&&this.PV.createFontUrl(a);this.GZ&&this.GZ.isEnabled&&(b=aa.FontUtils.Ksb(b,a,!1,!1,!0),this.GZ.createFontUrl(a));return b}Fih(a,b,c=null){if(!a)return b;b=this.sRe(a.fontName,b);this.RTb&&this.RTb.isEnabled&&(b=aa.FontUtils.Ksb(b,a.fontName,!1,!0),this.RTb.IXl(a)||this.RTb.TWl(c),this.RTb.cXl(a));return b}Y0c(){return!1}bae(a,b,c,f){a=null;!c&&f||!b.k4||(b=b.fontColor,a=b===rc.a.auto?"WindowText":
rc.a.bH(b));return a}pBh(a,b,c,f,l){return!b&&!c&&!f&&!l}Vbg(){return 0}rde(){return.8}TAh(a,b){return a||!b}yBh(){return!1}VAh(){return!1}V5f(){return new Uc.a}X5f(){return null}z7b(a){return sd.Font.PEa(a.wL)}}Object(m.a)(Ze,"TextRenderingStrategy",null,[1381]);class Ke{get name(){return"Box4.ParagraphRenderElements"}Yb(a){a.register(Ud,"Box4.LineBreakPresenterFactory").as("Box4.ILineBreakPresenterFactory").ma().oa(()=>new Ud(a.resolve("Box4.IParagraphContentRenderer")));a.register(be,"Box4.UnsupportedObjectPresenterFactory").as("Box4.IUnsupportedObjectPresenterFactory").ma();
a.register(Ze,"Box4.TextRenderingStrategy").as("Box4.ITextRenderingStrategy").ma().oa(()=>new Ze(a.qb("Box4.IFontService"),a.qb("Box4.CustomFontService"),a.qb("Box4.IEmbeddedFontService")));a.register(uf,"Box4.ParagraphContentRendererSettings").ma().oa(()=>new uf(Zb.ListReader.Fx,w.AFrameworkApplication.fa.ka("DragDropSelectionIsEnabled"),N.a.instance.ga(49),N.a.instance.ga(53),w.AFrameworkApplication.fa.ka("WordEditorCommentImprovementIsEnabled"),w.AFrameworkApplication.fa.ka(aa.FontUtils.mLf),w.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")));
a.register(lb,"Box4.ParagraphContentRenderer").as("Box4.IParagraphContentRenderer").ma().oa(()=>new lb(sa.InteractiveViewManager.instance,ja.a.instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IFormattingPropertyTransitStrategy"),a.qb("Box4.Proofing.IProofingFeatureConfiguration"),a.resolve("Box4.Proofing.IIgnoreAllKeywords"),a.resolve("Box4.ITextRenderingStrategy"),a.resolve("Box4.ParagraphContentRendererSettings"),a.resolve("Box4.ILineSpacingHelper"),a.qb("Box4.IFeatureHelper"),
aa.FontUtils.Oja,a.qb("Box4.IFontSlotProvider"),Object(I.a)(a.resolve("Box4.IEditStateEventManager"),a.resolve("Box4.IEditStateEventManager").nkh,"raiseParagraphContentUpdatedEvent"),tb.a.language,a.qb("Box4.ITableOfContentRenderHelper"),Oc.a.rFf))}init(){}dispose(){}static main(){n.a.instance.Ac(new Ke)}}Object(m.a)(Ke,"Box4ParagraphRenderElementsPackage",null,[2,3]);class hf{constructor(a,b,c,f,l,y,H){this.Moe=a;this.v6j=b;this.Y1c=c;this.R0j=f;this.P3j=l;this.Fx=y;this.m4j=b&&H||f}}Object(m.a)(hf,
"TableCellViewElementSettings",null,[]);class Xa{get name(){return"Box4.TableViewElements"}Yb(a){a.register(hf,"Box4.TableCellViewElementSettings").ma().oa(()=>new hf(w.AFrameworkApplication.fa.ka("OneNoteSpannedTableCellRenderIsEnabled"),N.a.instance.ga(63),N.a.instance.ga(30),N.a.instance.ga(77),N.a.instance.ga(71),Zb.ListReader.Fx,w.AFrameworkApplication.fa.ka("WordEditorTableCellWidthIsEnabled")))}init(){}dispose(){}static main(){n.a.instance.Ac(new Xa)}}Object(m.a)(Xa,"Box4TableViewElementsPackage",
null,[2,3]);var Bb=d(1243),mc=d(393),Qc=d(1267),td=d(239),Md=d(168),Pd=d(182),Be=d(1197);class fe{ze(a,b){return L.a.ze(a,b)}aw(a,b,c){L.a.aw(a,b,c)}Soa(a,b){L.a.Soa(a,b)}cLa(a){L.a.cLa(a)}TNc(a,b){L.a.TNc(a,b)}}Object(m.a)(fe,"CustomDataProxy",null,[1580]);var Mf=d(357),Bd=d(65),Rc=d(29);class Gf{constructor(){this.Ma=new Pc.a}sXk(a){this.Ma.raiseEvent("OnBackspaceDelete",a)}}Object(m.a)(Gf,"BackspaceDeleteEventSource",null,[1457,1458]);class Nf extends Sys.EventArgs{constructor(a,b){super();this.lN=
a;this.gV=b}}Nf.eventId="AEV.AVLD";Object(m.a)(Nf,"EditingViewOnAfterValidateEventArgs",Sys.EventArgs,[]);class Oa extends Pc.a{constructor(){super()}$yf(a){this.addHandler(Nf.eventId,a)}H7k(a){this.removeHandler(Nf.eventId,a)}}Oa.nHi="AEV.CR";Object(m.a)(Oa,"ContentEditableViewEventSource",Pc.a,[]);var cb=d(51);class Ic{constructor(){this.nFc=null;this.Yh=0}cnj(a){if(!this.nFc){var b=a.Mb?cb.a.createTextRange(a.node,0,a.Mb):cb.a.Lj(a.node,a.Mb);this.nFc=wb.HyperlinkReader.WC(b,!1);this.Yh=this.nFc.length-
1}for(;0<=this.Yh;)if(b=this.nFc[this.Yh],a.Mb<=b.Sa)--this.Yh;else return b.Mb<=a.Sa?null:b;return null}}Object(m.a)(Ic,"OverlappingHyperlinkHelper",null,[]);class qd{constructor(a,b,c,f,l){this.w2a=a;this.eE=b;this.usa=c;this.wgd=f;this.xgd=l}}Object(m.a)(qd,"PersistActiveSpanEditState",null,[]);class le{constructor(a,b){this.Fg=a;this.mh=b;this.REc=[];this.qI=this.pI=-1}hWe(){if(-1!==this.pI&&-1!==this.qI&&this.mh){this.REc.reverse();const a=this.REc.join("");let b,c;this.pI===this.qI?(b=cb.a.Lj(this.Fg,
this.pI),c=!!a.length):(b=cb.a.createTextRange(this.Fg,this.pI,this.qI),c=this.qI-this.pI!==a.length||this.Jde(b)!==a);c&&this.mh.replaceTextRange(b,a,!0,void 0,C.a.typing)}this.qI=this.pI=-1;Array.clear(this.REc)}wli(a,b){this.pI=a.Sa;-1===this.qI&&(this.qI=a.Mb);0<b.length&&Array.add(this.REc,b)}Jde(a){return Db.ParagraphReader.text(a.node).substring(a.Sa,a.Mb)}}Object(m.a)(le,"ReplacementTextRangeBuilder",null,[]);var yb=d(40);class ef{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb){this.Jh=a;this.VD=
b;this.ara=c;this.fg=f;this.qd=l;this.In=y;this.ud=H;this.kn=ia;this.jd=wa;this.wf=Ua;this.Oa=kb;this.PCc=this.Oa.ka("TextLayoutServiceUseResponse");this.Rkf=this.Oa.ka("TextLayoutServiceEnableActiveContentSpanFix")}LJl(){let a,b;a=b=null;if(this.ud&&this.ud.lS){var c=this.kn.getSelection(this.jd.contentWindow);if(c){a=b=c.focusNode;for(c=null;b&&"span"!==(c=b.nodeName.toLowerCase())&&!Sys.UI.DomElement.containsCssClass(b,xc.a.mga);)b=b.parentNode;"span"!==c&&(b=null);return{returnValue:!!b,L1f:a,
M1f:b}}}return{returnValue:!1,L1f:a,M1f:b}}Bmj(a){let b=0;for(let c of Ea.a.iab(a))"span"===c.nodeName.toLowerCase()&&b++;return b}Dgl(a){if(!a.parentNode||!a.parentNode.parentNode)return null;for(var b=a.parentNode;!Sys.UI.DomElement.containsCssClass(b,xc.a.mga)&&!Sys.UI.DomElement.containsCssClass(b,xc.a.Q9);){if("font"===b.nodeName.toLowerCase()){a=b.previousSibling;if(!a)break;if("a"===a.nodeName.toLowerCase()){b=null;for(let c of Ea.a.iab(a))"span"===c.nodeName.toLowerCase()&&(b=c);return b}}b=
b.parentNode}return null}Vdj(a,b,c,f,l){let y=Ea.a.Fv(c);const H=Ea.a.k9d(c,xc.a.mga);l=this.Bmj(H)+this.Jh.Ki.length-l.At.length;2>l?f.nextSibling&&"span"!==f.nextSibling.nodeName.toLowerCase()&&"br"!==f.nextSibling.nodeName.toLowerCase()?y=Ea.a.Fv(f)+Ea.a.Fv(f.nextSibling):"span"!==c.nodeName.toLowerCase()&&c.nextSibling?y=Ea.a.Fv(f):"#text"===c.nodeName.toLowerCase()&&c.parentNode!==f&&(y=Ea.a.Fv(f)):2===l?f.nextSibling&&"span"===f.nextSibling.nodeName.toLowerCase()&&(y=Ea.a.Fv(f)+Ea.a.Fv(f.nextSibling)):
2<l&&(y=b.innerText,ka.ULS.sendTraceTag(541172697,323,50,"GetCorrectLastActiveSpanTextForCompleteOvertype: SpanCountDiff > 2"));a.x2b||!b.innerText.endsWith(" ")||y.endsWith(" ")||(y+=b.innerText.substr(b.innerText.trimEnd().length));return y}kOk(a,b,c,f,l){const y=new qd(null,null,!0,null,null);let H=null,Q=null;if(1===this.wf.mode||2===this.wf.mode)({L1f:H,M1f:Q}=this.LJl());let ia=!1,wa=!1;const Ua=new Ic,kb=new le(a,f),Gb=0<this.Jh.Ki.length&&this.Jh.Ki[0].x2b;let ec=null;H&&this.Oa.ka("TextLayoutServiceEnableHyperLinkDataLossFix")&&
(ec=this.Dgl(H));for(let Fc=this.Jh.Ki.length-1;0<=Fc;Fc--){const yc=this.Jh.Ki[Fc],tc=yc.LF;let xd=!1;if(this.Rkf&&this.PCc&&Q&&!Ea.a.f5b(tc)){var dc=!1;Gb&&Fc===this.Jh.Ki.length-1&&!Ea.a.k9d(H,xc.a.VN)?xd=dc=!0:1===this.Jh.Ki.length&&(dc=!0);dc&&(tc.innerText=this.Vdj(yc,tc,H,Q,c),y.usa=!1)}y.eE=Ea.a.Fv(tc);this.VD.O7&&this.cZi(y.eE)&&(y.eE=ma.a.substr(y.eE,0,y.eE.length-1));dc=this.Edj(a,Fc);this.Ywk(a,b,Fc,y);wa=!!y.w2a||wa;ec===tc&&(y.xgd=tc.innerText+Ea.a.Fv(H),H.nodeValue="",y.usa=!1,ka.ULS.sendTraceTag(541172698,
323,50,"PersistActiveSpanEdits: Moved text from bare node to sibling span"));y.wgd||(y.wgd=this.L4i(a,dc,Ua));const Vd=!!l&&l.zHi(dc);this.GMl(a,b,tc,Fc,y,xd);Vd&&0<y.eE.length?(kb.hWe(),this.replaceTextRange(f,y,"",dc),this.Sli(l,Vd,y,dc)):this.FEi(yc,y.eE,dc,kb);ia=tc===Q||ia}kb.hWe();this.BOl(a,y);H&&Ea.a.Fv(H)&&!ia&&!wa&&(this.qd.Xb("ValidTextDropped",{["Reason"]:"TextLostDuringOvertype"}),ef.Lmf||(ka.ULS.sendTraceTag(23909632,323,50,"PersistActiveSpanEdits: browser created new span with text that are is lost during OverType"),
ef.Lmf=!0));return y.usa}FEi(a,b,c,f){if(c.contextId!==yb.a.Mf&&!a.x2b&&0<=a.wkd){let l=a.wkd,y=a.ONe;a=l!==y?cb.a.createTextRange(c.node,l,y):cb.a.Lj(c.node,l);b=b.substring(l-c.Sa,b.length-(c.Mb-y))}else a=c;a.Mb-a.Sa!==b.length||b!==this.Jde(a)?f.wli(a,b):f.hWe()}cZi(a){return a.charAt(a.length-1)===gc.wJb||z.a.Ho&&a.charCodeAt(a.length-1)===B.a.sRb}Jde(a){return Db.ParagraphReader.text(a.node).substring(a.Sa,a.Mb)}replaceTextRange(a,b,c,f){b.eE!==c&&a&&a.replaceTextRange(f,b.eE,!0,!0)}Sli(a,b,
c,f){b&&0<c.eE.length&&(b=cb.a.createTextRange(f.node,f.Sa,f.Mb+c.eE.length),a.Uli(b))}BOl(a,b){b.wgd&&(b=wb.HyperlinkReader.WC(b.wgd,!0),1===b.length&&this.In&&this.In.ypl(a,b[0]))}GMl(a,b,c,f,l,y){const H=Ea.a.mag(c);this.Jh.Ki[f].x2b&&H?y||this.kAj(b,f,l,H):l.w2a&&!Sys.UI.DomElement.containsCssClass(c,xc.a.FN)?(this.qd.Xb("MomentaryIncorrectFormatting",{["Reason"]:"MoveEopTextIntoSpan"}),this.fg.bc++,l.eE+=l.w2a,l.w2a=null,Ea.a.Mz(this.Jh.Ki[f].LF,l.eE)):l.xgd?(l.eE=l.xgd,l.xgd=null):this.PCc&&
this.Rkf&&(a=Db.ParagraphReader.text(a),b=this.Jh.Ki[f],c=b.wkd,y=b.ONe,f+1<this.Jh.Ki.length&&!Ea.a.f5b(this.Jh.Ki[f+1].LF)&&c===y&&0<c&&" "===a.charAt(c-1)&&(l.eE=l.eE.substr(0,c-1)+" "+l.eE.substr(c-1),l.usa=!1),b.LF.innerText.endsWith(" ")||" "!==a.charAt(y)||b.z_a+b.AUa!==y+1||(l.eE+=" ",l.usa=!1))}kAj(a,b,c,f){!b&&c.w2a?(this.qd.Xb("MomentaryIncorrectFormatting",{["Reason"]:"MoveEopTextIntoSpan0"}),this.fg.bb++,c.eE=c.w2a,Ea.a.Mz(this.Jh.Ki[b].LF,c.eE),this.ud.dG&&(a=a.lastChild,this.PCc&&Sys.UI.DomElement.containsCssClass(a,
xc.a.Q9)&&(a=a.lastChild),a&&a.parentNode&&a.parentNode.insertBefore(f,a)),c.w2a=null):(this.qd.Xb("ValidTextDropped",{["Reason"]:"EopTextLostDuringOvertype"}),this.fg.bd++,c.eE="",Ea.a.Mz(this.Jh.Ki[b].LF,c.eE))}Edj(a,b){b=this.Jh.Ki[b];return b.z_a?cb.a.createTextRange(a,b.AUa,b.AUa+b.z_a):cb.a.Lj(a,b.AUa)}Ywk(a,b,c,f){if(this.Jh.Ki[c].AUa+this.Jh.Ki[c].z_a===Db.ParagraphReader.textLength(a)&&(a=b.lastChild,this.PCc&&Sys.UI.DomElement.containsCssClass(a,xc.a.Q9)&&(a=a.lastChild),c=Ea.a.Fv(a),c.length>
this.ara.N5d)){this.fg.ba++;this.VD.mlb(!1,b,this.Jh);f.w2a=ma.a.substr(c,0,c.length-this.ara.N5d);b="";for(c=0;c<this.ara.N5d;c++)b+=da.a.lRc;a.innerText=b;f.usa=!1}}L4i(a,b,c){return(b=c.cnj(b))&&ef.lTj(b)?cb.a.Lj(a,b.Sa):null}static lTj(a){return!!a.hyperlink&&a.hyperlink.url===Db.ParagraphReader.text(a.paragraph).substring(a.Sa,a.Mb)}}ef.Lmf=!1;Object(m.a)(ef,"ActiveContentSpansPersistanceManager",null,[1456]);class Cb{constructor(a){this.$s=a}HAk(a){a&&this.$s.dZ()}}Object(m.a)(Cb,"AppFrameResizeEventProcessor",
null,[]);class oc{constructor(){this.b_b=new Na.a}ya(a){this.b_b.add(a)}Mta(a){return this.b_b.count>a?this.b_b.ga(a):null}get HGa(){return this.b_b.count}isEmpty(){return!this.b_b.count}}Object(m.a)(oc,"AggregatedAutoCorrectActions",null,[1338]);var vc=d(238);class nd{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc){this.QR=this.In=this.LBc=this.Ye=null;this.kv=a;this.EK=b;this.Bh=c;this.Qb=f;this.Jh=l;this.EZ=y;this.Ep=H;this.aj=Q;this.oia=ia;this.$s=wa;this.wf=Ua;this.wS=kb;this.Lk=Gb;this.Uc=
ec;this.hd=dc;this.hp=Fc}iT(a){this.Ye=a}get z0b(){return this.EK}get hyperlinkEditor(){return this.In||(this.In=Ib.a.instance.qb("Box4.IHyperlinkEditor"))}get IJj(){return this.LBc||(this.LBc=Ib.a.instance.qb("Box4.IHyperlinkActionFactory"))}HRj(a){if(this.kv.instance&&a&&2===this.Bh.mode)if(this.Ye.Zs(!0),this.oia.value.Aw(),a.Cx)this.kv.instance.FRj(a),this.oia.value.Aw();else{var b=this.aj.U8(this.Bh.mode,this.Qb.Pi);a.jig.innerText=a.jig.innerText;this.wS.wrc();this.Ep.raiseEvent(vc.a.autoCorrect);
1===this.kv.instance.GRj(a)&&(this.wf.Zaa(!0),b>=a.KR&&(b+=a.D4c),this.aj.yT(b,this.Qb.Zh),this.Ye.Zs(!0),this.oia.value.Aw(),this.$s.dZ())}}XHe(a,b){if(!this.kv.instance||!this.IJj||!this.hyperlinkEditor)return null;this.Ye.Zs(!0);a=this.EZ.Vta(b).Va;b=a.Sa;if(0>=b||!this.Jh.Ki.length)return null;if(a=this.kv.instance.XHe(a.node,b))this.QR||(this.QR=new oc),this.QR.ya(a);return a}HVi(a,b){if(2===this.Bh.mode&&this.Jh.Ki.length){var c=this.aj.U8(this.Bh.mode,this.Qb.Pi);!this.QR&&this.kv.instance&&
(b=this.EZ.Vta(b).Va,0>c||!this.Jh.Ki.length||(this.QR=new oc,this.QR=this.kv.instance.xOf(b.node,c,c-this.Jh.Ki[0].UKc,this.Jh.Ki[0].LF,!this.Jh.Ki[0].UKc,a),this.QR.HGa||(this.QR=null)))}}bOk(){if(2===this.Bh.mode){if(0<this.QR.HGa){this.Ye.Zs(!0);for(var a=0;a<this.QR.HGa;a++)this.QR.Mta(a).LPh();for(a=0;a<this.QR.HGa;a++)this.HRj(this.QR.Mta(a))}this.QR=null}}}Object(m.a)(nd,"AutocorrectActionExecutor",null,[]);var id=d(321);class Nd{constructor(a,b,c,f,l,y,H,Q,ia,wa){this.Y9h=y;this.EZ=a;this.nj=
b;this.ZD=c;this.rf=f;this.MK=l;this.Jaf=H;this.hd=Q;this.XD=ia;this.zAa=!!wa;this.kv=wa}XJl(a,b,c,f,l,y,H){if(!f)return!1;f=this.EZ.Vta(l);if(!f||!this.rf.Dx(f)||!f.Va.Pk)return!1;l=f.Va;if(this.h0j(l)||this.KYj(a,l)||this.tcb(l))return!1;if(Rc.App.Noi){if(this.g0j(y))return!1}else if(this.f0j(y))return!1;return this.MK&&this.MK.RAb(f)||!this.Kwi(a,this.nj,H,Ea.a.Fv(c),b)||this.zAa&&!a&&this.kv.instance&&this.kv.instance.ZHj()?!1:!0}g0j(a){if(this.Jaf&&a&&Sys.UI.DomElement.containsCssClass(a,xc.a.mga)){const b=
Ea.a.Nda(a,xc.a.Q9);b&&(a=b)}return Ea.a.Nda(a,Nd.$5g)?!0:!1}f0j(a){if(this.Jaf&&a&&Sys.UI.DomElement.containsCssClass(a,xc.a.mga)){const b=Ea.a.Nda(a,xc.a.Q9);b&&(a=b)}return Ea.a.Nda(a,id.a.hdb)||Ea.a.Nda(a,Nd.$5g)?!0:!1}tcb(a){return this.XD.tcb(a).returnValue}h0j(a){return this.nj&&(!this.Y9h.l1b(a.node)||N.a.instance.ga(14)&&this.ZD.Wdh(a.node))?!0:!1}KYj(a,b){return N.a.instance.ga(14)&&this.ZD.tZj(b,!a)}Kwi(a,b,c,f,l){if(!f||""===f)return!1;var y=this.hd.ig&&this.hd.jz;y=a&&!y?0:1;!a&&1<c&&
ma.a.Gx(f,c-1)?y=2:c<f.length&&ma.a.Gx(f,c)&&(y=1);if(a){if(a=c+y,a>=f.length-2||!this.Lwi(c,f,y))return!1}else{a=c-y;if(b){if(0>a)return!1}else if(0>=a)return!1;if(1===a&&ma.a.uz(f.charCodeAt(0))&&(f.length===c||ma.a.uz(f.charCodeAt(c))))return!1}b=T.a.fFa(l,a,!0,!0);return Sys.UI.DomElement.containsCssClass(b,da.a.aQi)||Sys.UI.DomElement.containsCssClass(b,xc.a.VN)||Sys.UI.DomElement.containsCssClass(b,xc.a.FN)||Sys.UI.DomElement.containsCssClass(b,da.a.pW)?!1:!0}Lwi(a,b,c){return ma.a.uz(b.charCodeAt(a+
c))&&(!a&&b.length===1+c||1===a&&ma.a.uz(b.charCodeAt(0)))?!1:!0}}Nd.$5g="NoteTagContainer";Object(m.a)(Nd,"BackspaceInBrowserHandler",null,[]);var Ce=d(1254),af=d(226);class de{constructor(a,b,c){this.point=a;this.width=b;this.height=c}}Object(m.a)(de,"UnroundedRectangle",null,[]);var $f=d(1099),ge=d(64),ze=d(146);class si{constructor(a,b,c,f,l,y,H,Q,ia){this.Dh=null;this.Mga=!1;this.ica=a;this.jd=b;this.KZ=c;this.J2=f;this.ud=l;this.Pf=y;this.wf=H;this.Qb=Q;this.YP=ia}F0b(a){this.Dh=a}dZ(){if(2===
this.wf.mode&&this.Qb.Gg){var a=this.Qb.HW,b=this.Qb.Zh;if(a&&b){if(!this.jd.Cg&&(w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordBoundsSynchronizerHeaderFooterEarlyReturnSettings"),w.AFrameworkApplication.fa.ka("BoundsSynchronizerHeaderFooterEarlyReturnIsEnabled"))){ka.ULS.sendTraceTag(51667991,317,50,"Null EditingDom in SynchronizeBounds. ViewId: {0}",this.Dh.Na);return}this.jd.Cg.eKe(a);b=this.jd.Cg.Gu;var c=this.E6f(a.htmlElement,b.parentNode);if(c&&c.point){var f=c.point;
a=c.width;c=c.height;0>a&&(a=0);var l=Ce.a.create();try{b.style.top=f.y.toString()+"px",b.style.left=f.x.toString()+"px",b.style.width=a.toString()+"px",b.style.height=c.toString()+"px",b.style.paddingRight=""}finally{l&&l.dispose()}this.FBh()&&(f=this.jd.Bm(),this.e6j()?f.style.clip="":(b.style.height=c+100+"px",f.style.clip="rect(0px,"+a+"px,"+c+"px,0px)"));this.ica.instance.YOl(b.parentNode,this.Qb.rda,!!this.Dh&&this.Dh.hm&&this.Dh.gxb)}}}}FBh(){return this.ud.dG&&!this.ud.Vi&&N.a.instance.ga(30)}UVj(a){return Ea.a.LVa(a)}e6j(){return ze.c(this.Dh.Ag)}ki(a){return Bd.a.ki(a)}HGh(a){var b=
ge.a.instance.Pa.mb;if(1===this.wf.mode){var c=(b.Af?b.jf:b.Va).node;b=c.qc(this.Pf.Rd.Na);a=c.qc(a);if(b&&a){this.jd.Cg.eKe(b);a=this.jd.Cg.Gu;var f=this.E6f(b.htmlElement,a.parentNode);if(f&&f.point){b=f.point;c=f.width;f=f.height;0>f&&(f=1);0>c&&(c=1);a=a.style;if(this.ud.Ukb)this.J2.Hhg();else{const l=b.x+"px";c+="px";f+="px";if(a.left!==l||a.width!==c||a.height!==f)a.left=l,a.width=c,a.height=f}b=b.y+"px";a.top!==b&&(a.top=b)}}}}E6f(a,b){if(!this.UVj(a))return null;var c=this.ki(a),f=this.ki(b);
let l=c.x-f.x;f=c.y-f.y;var y=Ce.a.create();try{l+=b.scrollLeft,f+=b.scrollTop}finally{y&&y.dispose()}b=c.width;c=c.height;this.KZ&&this.KZ.instance&&this.KZ.instance.Yog(a)&&(y=this.KZ.instance.G3,b/=y,c/=y);if(this.YP.BBb(a)){var H=af.a.rt(a);H&&(y=parseFloat(H.width),H=parseFloat(H.height),isNaN(y)||isNaN(H)||(b=y,c=H))}0>=b&&(b=a.scrollWidth);0>=c&&(c=a.scrollHeight);if(this.ud.NVa||this.ud.Ho)b+=.001,l+=.001,f+=.001;c+=1.001;return new de(new $f.a(l,f),b,c)}}Object(m.a)(si,"BoundsSynchronizer",
null,[1455]);var sh=d(571),dd=d(82);class Lc{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb){this.W2h=new sh.a(RegExp("\r\n","g"),"\n");this.WGd=null;this.PId=0;this.BMd=!1;this.$Bc=!0;this.qd=b;this.fg=c;this.gDc=a;this.jd=f;this.ep=l;this.ud=y;this.Pf=H;this.Zd=Q;this.nj=ia;this.kn=wa;this.QNd=Ua;this.Kra=Gb}get kng(){null==this.WGd&&(this.WGd=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("CursorPositionFixForIMEInMacIsEnabled"):!1);return this.WGd}get zWa(){return this.PId}get g_k(){return this.BMd}get KQj(){return this.$Bc}nUc(a,
b){var c=this.jd.Wta();if(1===a||0===a)return 0;if(this.ud.lS){var f=this.MEa();if(f){this.BMd=!this.B2c(f);c=this.kn.nXc(f);var l=this.kn.Dbg(f),y=l;w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordCursorPositionFixForIMEInMacSettings");this.kng&&this.ud.Ik&&(f=this.kn.I6f(f),l!==f&&(y=f));return this.ep.Kbe(c,b,y,this.fg,this.qd,this.nj)}ka.ULS.sendTraceTag(51463631,324,50,"GetCaretPosition could not find IP, rangeObject is null")}else if(this.ud.aG)try{return l=c.selection.createRange(),
y=this.jd.Bm().innerText,b=0,""!==y&&(b=Math.abs(this.kn.moveStart(l.range,-1E5)),l=c.selection.createRange(),f=Math.abs(this.kn.moveEnd(l.range,-1E5)),this.BMd=b!==f),y=this.W2h.pKa(y),b>=y.length&&(b=y.length-1),b}catch(H){this.qd.Xb("IncorrectIpPosition",{["Reason"]:"OldIeGetCaretPositionException"}),this.fg.bg++,ka.ULS.sendTraceTag(51463190,324,15,"Incorrect IP position, message: {0}, Exception: {1}",H.message,H.toString())}else ka.ULS.sendTraceTag(51463191,324,15,"GetCaretPosition could not find IP, returned 0");
this.fg.bh++;return 0}B2c(a){return Bd.a.B2c(a)}MEa(){return Bd.a.MEa(this.jd.contentWindow)}dul(a,b,c,f,l){if(!w.AFrameworkApplication.fa||!w.AFrameworkApplication.fa.ka("TextLayoutServiceEnableSelectionCursorFix")||c!==l+f||a===b.At.length-1||Sys.UI.DomElement.containsCssClass(b.At[a+1],xc.a.VN))return!1;a=b.At[a];b=Ea.a.k9d(a,xc.a.Q9);if(!b)return!1;b=Ea.a.iab(b).toArray();return b[b.length-1]!==a?!1:!0}yT(a,b){var c=this.jd.contentWindow;this.$Bc=!0;this.PId=a;try{if(this.ud.lS){const y=b.At;
let H;var f=0;const Q=this.kn.getSelection(c);if(Q)for(H=0;H<b.At.length;H++){const ia=b.At;ka.ULS.shipAssertTag(18437200,315,y===ia);let wa=ia[H],Ua=this.ep.cJ(wa,this.fg,this.qd,this.nj);var l=a<=Ua+f;const kb=Sys.UI.DomElement.containsCssClass(wa,xc.a.FN),Gb=Sys.UI.DomElement.containsCssClass(wa,da.a.pW),ec=this.dul(H,b,a,f,Ua);if(l&&!kb&&!Gb&&!ec){b=H+1;if(a===Ua+f&&b<ia.length){const dc=ia[b];!this.ep.cJ(dc,this.fg,this.qd,this.nj)&&Ea.a.f5b(dc)&&(wa=dc,f=a)}a-=f;this.gDc.value.m2b(wa,c);for(c=
wa;c.firstChild;)c=c.firstChild;this.DTj(Q,c,a)||(c=this.A_i(c,this.jd.Wta()),this.kng&&this.ud.Ik?2!==this.Pf.editingView.Jvb&&this.pXf(c,a,Q):this.pXf(c,a,Q));break}f+=Ua}}else this.ud.aG&&(f=this.QNd.create(this.Pf.Rd),l=this.kn.createRange(this.jd.Bm()),this.kn.collapse(l,!0),this.kn.moveStart(l,a),l.select(),f.dispose())}catch(y){ka.ULS.shipAssertTag(4203852,315,!1)}}A_i(a,b){"SPAN"===a.nodeName&&(b=b.Jl.createTextNode(""),a.appendChild(b),a=b);return a}pXf(a,b,c){if(this.ep.Lng(a)){this.kn.removeAllRanges(c);
var f=this.kn.createRange(a.ownerDocument);this.kn.PNb(f,!0,a,b);this.kn.PNb(f,!1,a,b);try{this.kn.addRange(c,f)}catch(l){this.fg.bl++,this.qd.Xb("PossibleNoIp",{["Reason"]:"AddRangeException"}),ka.ULS.shipAssertTag(1708946,315,!1)}this.kn.collapse(f,!0)}else ka.ULS.sendTraceTag(541172696,324,50,"EnsureCaretPositionToTextObject: Detached element")}updateCaretPosition(a,b){this.PId=this.nUc(a,b)}mouseDown(){return this.$Bc=!1}YJ(){this.$Bc=!0;return!1}U8(a,b){this.Kra&&this.Kra.NSl(this.zWa,this.nUc(a,
b));return this.zWa}DTj(a,b,c){const f=a.focusNode,l=!!f&&3===f.nodeType,y=a.focusOffset;return a.isCollapsed&&l&&f===b&&y===c}gSf(a,b){const c=new dd.a(0,1,0,()=>{b.wWa(a.mode)&&this.updateCaretPosition(a.mode,b.Pi)},28);this.Zd.Hb(c)}}Object(m.a)(Lc,"CaretPositionManager",null,[1453]);var Zd=d(266);class Ne{constructor(){this.KI=Zd.a.instance.I9d()}}Object(m.a)(Ne,"CevUsageDataTracker",null,[]);class Xc{constructor(a,b){this.Kzc=null;this.Uia=0;this.Gg=this.HW=null;this.rda=!1;this.dCa=a;this.Pf=
b}init(a){this.Uia=a}get cIj(){return!!this.Gg&&!!this.Gg.tg(this.Uia)}get gSa(){ka.ULS.shipAssertTag(18437208,315,!!this.Gg);return this.Zh?this.Zh.htmlElement:null}get Pi(){return this.Zh?this.Zh.Pi:null}get Zh(){return this.Kzc}set Zh(a){this.Kzc=a;a=null;this.dCa.instance&&(a=this.dCa.instance.HKh());this.Kzc&&a&&a.dZl(this.Kzc.Ydh)}wWa(a){return 1!==a||ge.a.instance.Pa.Cea?this.Gg&&this.Zh&&this.HW?(a=this.Pf.Rd)&&Db.ParagraphReader.ae(this.Gg)&&this.Zh===this.Gg.qc(this.Uia)&&this.HW===this.Gg.qc(a.Na)?
!0:!1:!1:!0}}Object(m.a)(Xc,"CevViewContentManager",null,[1452]);var lf=d(1261),Kh=d(383);class bd{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc){this.Ye=null;this.JK=a;this.WPd=b;this.qd=c;this.tGd=f;this.Kra=l;this.Jia=y;this.Xk=H;this.Bh=Q;this.ks=ia;this.wf=wa;this.NOa=Ua;this.Pba=kb;this.AC=Gb;this.WV=ec;this.Irb=dc}iT(a){this.Ye=a}h_d(a,b,c){if(this.NOa.wLj||this.JK.B$b||!b)return!1;if(this.WPd.fAh)return!0;b=this.qd.Zp(C.a.typing);b.properties.$(lf.a.source,"Composition");a=this.kEi(a,c);
b.end();return a}kEi(a,b){this.tGd.correctBadImeState()&&this.Kra.qrc(C.a.gLl);this.Jia.fixupAfterMagnifierDrag();if(this.WV.xkd(a))return!1;this.Xk.ire=(new Date).getTime();if(1===this.Bh.mode){let c;({j4:b,gPb:c}=this.WV.KKh(a,b));if(b)return c}this.ks.isComposing=!0;this.Irb||this.wf.Zaa(!0);a.eventName===oa.a.i_d&&this.Pba.raiseEvent(Kh.a.yMf,a);this.AC.FQa(a);return!1}A2b(a,b,c){this.Irb&&this.Ye&&this.Ye.Zs(!0,!0);return this.h_d(a,b,c)}z2b(a,b,c){this.h_d(a,b,c);return this.ks.isComposing=
!1}}Object(m.a)(bd,"CompositionEventProcessor",null,[]);class fd{constructor(a,b,c){this.TGd=!1;this.Pba=a;this.Ep=b;this.B7=c}get isComposing(){return this.TGd}set isComposing(a){(this.TGd=a)?(this.Pba.raiseEvent(Kh.a.lEi),this.Ep.raiseEvent(vc.a.qLj)):(this.Pba.raiseEvent(Kh.a.iEi),this.Ep.raiseEvent(vc.a.oLj))}get rGa(){return!this.isComposing&&!this.B7.bjg}}Object(m.a)(fd,"CompositionStateManager",null,[]);var Ve=d(139),rf=d(92);class Ag{constructor(a,b,c){this.T_h=w.AFrameworkApplication.fa.ka("AccessibilityNotificationEnabledViaAriaLiveRegion");
this.nCa=this.$Dd=this.sRd=this.XAa=this.pDd=null;this.psb=a;this.kI=b;this.uqa=c;this.render();this.uqa.Ogd&&this.kI.GI(Object(I.a)(this,this.vgd,"modeSwitched"))}vgd(){this.uqa.dBh&&this.bsd(!0);this.wXf()}get Gu(){return this.sRd}get contentWindow(){return Bd.a.Bnj(this.psb.ownerDocument)}get contentDocument(){return this.psb.ownerDocument}get sAa(){return this.psb}get ao(){return this.$Dd}get XQh(){return this.nCa}get isValid(){return!0}initialize(a,b){this.XAa=a;this.XAa.nWd=Object(I.a)(this,
this.onBlur,"onBlur");b()}prh(){this.Gu.style.left="0px";this.Gu.style.top="0px"}zZi(){this.XAa&&this.XAa.q_i(this,this.kI)}Qoa(){}ixd(){v.FocusManager.Zq(this.contentWindow)}wKh(){v.FocusManager.NKl(this.ao)}get Ilb(){return!Bd.a.WRj(this.ao)}set Ilb(a){}pZe(a,b,c){this.ao.setAttribute(Ve.a.er,a);this.pDd&&(this.pDd.innerText=b);this.Isc(c)}Isc(a){a&&this.ao.setAttribute(Ve.a.hf,a)}bsd(a){if(z.a.Wj||a)a=!this.uqa.ome&&a,this.ao.setAttribute("contenteditable",a?"true":"false"),this.uqa.dBh?(Sys.UI.DomElement.addCssClass(this.ao,
"WACEditing"),Sys.UI.DomElement.addCssClass(this.ao,M.AppFrame.IVf),Sys.UI.DomElement.addCssClass(this.ao,"EditingSurfaceBody")):(Sys.UI.DomElement.removeCssClass(this.ao,"WACEditing"),Sys.UI.DomElement.removeCssClass(this.ao,M.AppFrame.IVf),Sys.UI.DomElement.removeCssClass(this.ao,"EditingSurfaceBody"))}dispose(){this.iMl();this.Gu&&(this.Gu.parentNode&&this.Gu.parentNode.removeChild(this.Gu),this.$Dd=this.sRd=null)}render(){const a=String.format("{0}_EditingElement",this.psb.id),b=String.format("{0}_WrappingDiv",
a);this.sRd=document.createElement("div");this.Gu.id=b;this.Gu.style.height="0px";this.Gu.style.width="0px";this.Gu.style.display="none";Rc.App.instance.T0c&&Sys.UI.DomElement.addCssClass(this.Gu,"NoPointer");this.$Dd=document.createElement("div");this.ao.id=a;this.ao.setAttribute("contenteditable",!this.uqa.ome);this.ao.setAttribute("spellcheck","false");z.a.Gla&&this.contentDocument.execCommand("AutoUrlDetect",!1,!1);this.vjl();this.wXf();rf.c(this.ao,!0);rf.c(this.Gu,!0);this.nCa=document.createElement("div");
this.Gu.appendChild(this.ao);this.psb.appendChild(this.Gu)}wXf(){if(this.ao){const a=String.format("{0}_WACEditing_DescribedByElement",this.psb.id),b=this.uqa.cai;this.uqa.ome?this.ao.setAttribute("tabindex","0"):this.ao.removeAttribute("tabindex");if(!this.T_h){const c=N.a.instance.ga(81)?Box4Intl.Box4Strings.l_EditingSurfaceF2ScreenReaderDescribedByMessage:Ve.a.Mbj();this.pDd=Ve.a.tBf(this.Gu,this.ao,a,c);this.pZe(b,c,null)}}}vjl(){z.a.Wj?Sys.UI.DomElement.addCssClass(this.ao,"InternetExplorer"):
z.a.gg?Sys.UI.DomElement.addCssClass(this.ao,"FireFox"):z.a.nva&&Sys.UI.DomElement.addCssClass(this.ao,"Safari");z.a.Vi?Sys.UI.DomElement.addCssClass(this.ao,"iPad"):Sys.UI.DomElement.addCssClass(this.ao,"usehover")}iMl(){this.XAa&&(this.XAa.hMl(this,this.kI),this.XAa=null)}onBlur(a){this.XAa.$wg(a);this.XAa.GEf(a)}mwk(){this.Gu.style.width="0px";this.Gu.style.height="0px"}eKe(a){a=a.htmlElement;this.Gu.parentNode!==a.parentNode&&a.parentNode&&a.parentNode.insertBefore(this.Gu,a)}GJl(a){if(a&&"DIV"===
a.tagName){var b=a.childNodes;for(let c=0;c<b.length;c++)if("TBODY"===b[c].tagName||"TR"===b[c].tagName){for(b=a.ownerDocument.createElement("TABLE");a.hasChildNodes();)b.appendChild(a.firstChild);Ea.a.$Ca(a);a.appendChild(b);break}}}}Object(m.a)(Ag,"ContentEditableDiv",null,[1479,107]);class ne{create(a,b,c){return new Ag(a,b,c)}}Object(m.a)(ne,"ContentEditableDomFactory",null,[1451]);var kf=d(75);class kg{constructor(a,b){this.ud=a;kg.Oa=b}Q0c(a){return Sys.UI.DomElement.containsCssClass(a,"PageBreakBlob")}$Xi(a,
b){a=Ea.a.Fv(a);const c=ma.a.DGa(a,b-1);return(b=a.substr(c+1,b-c-1))&&(ma.a.C9(b)||ma.a.Nac(b))?!0:!1}A$d(a,b,c){try{if(3===a.nodeType)return a.nodeValue}catch(l){return b.Xb("FailedToRetrieveText",{["Reason"]:"GetTextCrashed"}),c.o++,""}if("IMG"===a.tagName)return gc.Yig;if("BR"===a.tagName)return gc.REf;if(this.Pog(a)&&(w.AFrameworkApplication.dM("Microsoft.Office.Web.SessionSettings.IWacWoncaSkipPictureDescriptionWhenGettingElementTextSettings"),kg.Oa.ka("SkipPictureDescriptionWhenGettingElementTextIsEnabled")))return"";
let f="";for(let l=0;l<a.childNodes.length;l++)f+=this.A$d(a.childNodes[l],b,c);return f}scg(a,b,c,f){try{if(3===a.nodeType){var l=a.nodeValue;l=a.nodeValue;return l.length}}catch(y){return ka.ULS.sendTraceTag(51463192,324,15,y.message),c.Xb("PossibleIncorrectIpPosition",{["Reason"]:"TextLengthForSelectionRecursiveBadNode"}),b.bs++,-1}if(kg.N1c(a))return this.Zjj(a);if(Sys.UI.DomElement.containsCssClass(a,"LineBreakBlob"))return 1;l=0;"IMG"===a.tagName&&(l=f?l+1:l+3);if(this.Pog(a)&&(w.AFrameworkApplication.dM("Microsoft.Office.Web.SessionSettings.IWacWoncaSkipPictureDescriptionWhenGettingElementTextSettings"),
kg.Oa.ka("SkipPictureDescriptionWhenGettingElementTextIsEnabled")))return 0;this.Q0c(a)&&(l+=gc.kQc+gc.Q3d);for(let y=0;y<a.childNodes.length;y++){const H=this.scg(a.childNodes[y],b,c,f);if(0<=H)l+=H;else return a.innerText.length}return l}Pog(a){return void 0===a.parentNode||null===a.parentNode?!1:Sys.UI.DomElement.containsCssClass(a.parentNode,"WACImageContainer")&&"SPAN"===a.tagName&&Sys.UI.DomElement.containsCssClass(a,"WACAltTextDescribedBy")}j4j(a){return Sys.UI.DomElement.containsCssClass(a,
xc.a.jDl)}Zjj(a){return(a=a.querySelector(".RawEquation"))?parseInt(a.getAttribute("data-length")):kf.AParagraphNode.w_.length}cJ(a,b,c,f){try{if(3===a.nodeType){let l=a.nodeValue;l=a.nodeValue;return l.length}}catch(l){return c.Xb("PossibleIncorrectIpPosition",{["Reason"]:"TextLengthForSelectionBadNode"}),b.br++,0}return this.scg(a,b,c,f)}R4f(a,b,c,f,l){let y=0;const H=a.At;for(let Q=0;Q<H.length;Q++){a=H[Q];const ia=this.cJ(a,f,c,l);if(b<y+ia)return b-=y,c=a.innerText,b>=c.length?0:ma.a.charCodeAt(c,
b);y+=ia}f.bt++;return 0}Kbe(a,b,c,f,l,y){if(void 0===a||null===a)return l.Xb("IncorrectIpPosition",{["Reason"]:"NoOffsetFromNullElement"}),f.bi++,ka.ULS.sendTraceTag(51463193,324,15,"NoOffsetFromNullElement when trying to get position"),0;if(!b)return ka.ULS.sendTraceTag(18437279,324,15,"GetParagraphCpFromElementOffset found null ParagraphElement when trying to get position"),0;let H=0;if(3===a.nodeType)H=c;else for(var Q=0;Q<c;Q++)H+=this.cJ(a.childNodes[Q],f,l,y);for(;a!==b;){Q=a;a=a.parentNode;
if(!a){ka.ULS.sendTraceTag(51463195,324,15,"GetParagraphCpFromElementOffset found null parent when trying to get position");l.Xb("IncorrectIpPosition",{["Reason"]:"NoOffsetFromNullParent"});f.bj++;if(w.AFrameworkApplication.fa&&(w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordInvalidCaretPositionFixSettings"),w.AFrameworkApplication.fa.ka("InvalidCaretPositionFixIsEnabled")))return 0;break}this.Q0c(Q)&&(H+=gc.kQc);let ia=0;for(;ia<a.childNodes.length&&a.childNodes[ia]!==Q;)H+=
this.cJ(a.childNodes[ia],f,l,y),ia++;if(ia===a.childNodes.length)if(3===Q.nodeType)H=c;else return l.Xb("IncorrectIpPosition",{["Reason"]:"NoOffsetFromSelectionNotInDom"}),f.bk++,ka.ULS.sendTraceTag(51463196,324,15,"The current selection is in a non-text node that is not in the editing view's DOM."),0}return H}Lng(a){return Ea.a.f5b(a)}static get instance(){kg.La||(kg.La=new kg(Qc.a.instance,w.AFrameworkApplication.fa));return kg.La}static N1c(a){return Sys.UI.DomElement.containsCssClass(a,xc.a.Euk)||
Sys.UI.DomElement.containsCssClass(a,xc.a.S_i)||Sys.UI.DomElement.containsCssClass(a,xc.a.AXi)}}kg.La=null;kg.Oa=null;Object(m.a)(kg,"ContentEditableViewDomUtils",null,[1435]);class Af{constructor(a,b){this.fGd=null;this.jd=a;this.Xk=b}Pxd(){return 1<this.ggj()||this.zgg(this.fGd,this.C6f())}wrc(){const a=this.C6f();this.fGd=a?a.cloneNode(!0):null}ggj(){if(this.jd){const a=this.jd.Bm();if(a&&a.childNodes)return a.childNodes.length}return 0}C6f(){if(this.jd){const a=this.jd.Bm();if(a)return a.firstChild}return null}zgg(a,
b){if(!a&&!b)return!1;if(!a||!b)return!0;try{return this.bHj(a,b)}catch(c){return ka.ULS.sendTraceTag(17134560,324,15,"HasDifferentHtmlStructure ex: {0}",c),!0}}bHj(a,b){if(ma.a.rg(a.nodeName)!==ma.a.rg(b.nodeName))return!0;if(a.childNodes.length!==b.childNodes.length&&(!z.a.gg||a.childNodes.length!==b.childNodes.length-1||"BR"!==ma.a.nC(b.childNodes[b.childNodes.length-1].nodeName))){var c=!a.childNodes.length||3===a.childNodes[0].nodeType;for(var f=0;c&&f<b.childNodes.length;f++)c=3===b.childNodes[f].nodeType&&
c;if(c)return!1;c=b.childNodes.length;for(f=0;f<b.childNodes.length;f++)3!==b.childNodes[f].nodeType||b.childNodes[f].nodeValue.length||c--;return c!==a.childNodes.length}for(c=0;c<a.childNodes.length;c++)if((!kg.N1c(a.childNodes[c])||!kg.N1c(b.childNodes[c]))&&this.zgg(a.childNodes[c],b.childNodes[c]))return!0;return!1}a6i(a,b){if(z.a.kJ&&N.a.instance.ga(98)){b.Xb("PossiblyIncorrectTypedText",{["Reason"]:"FixEOPSpanforAndroidChrome"});b=Ea.a.Nda(this.fGd,"EOP");const c=Ea.a.Nda(a.firstChild,"EOP");
b&&!c&&a.firstChild&&a.firstChild.appendChild(b.cloneNode(!0))}}}Object(m.a)(Af,"ContentEditableHtmlStructureUtils",null,[]);class Wf{constructor(){this.L2h=w.AFrameworkApplication.fa.ka("MoveToIpModeInReadOnlyView")}get mode(){return w.AFrameworkApplication.Ra.mode}get Ogd(){return this.L2h}get dBh(){return this.Ogd?!0:1!==w.AFrameworkApplication.Ra.mode||Rc.App.vBb&&w.AFrameworkApplication.dU}get cai(){switch(this.mode){case 3:return Box4Intl.Box4Strings.l_EditingSurfaceScreenReaderTitleMessage;
case 2:return Box4Intl.Box4Strings.l_ReviewingSurfaceScreenReaderTitleMessage}return Box4Intl.Box4Strings.l_ReadingSurfaceScreenReaderTitleMessage}get ome(){return this.Ogd?1===w.AFrameworkApplication.Ra.mode||Rc.App.vBb&&w.AFrameworkApplication.dU:Rc.App.vBb&&w.AFrameworkApplication.dU?!(Rc.App.n1b||Rc.App.Wbc):1===w.AFrameworkApplication.Ra.mode}get Ltd(){return this.Ogd?1===w.AFrameworkApplication.Ra.mode||Rc.App.vBb&&w.AFrameworkApplication.dU:Rc.App.vBb&&w.AFrameworkApplication.dU}}Object(m.a)(Wf,
"ContentEditableModeHelper",null,[1384]);var vf=d(197),De=d(36);class Ee{static hJi(a){const b={};for(let c of a)a=0,c in b&&(a=b[c]),b[c]=a+1;return De.c(b)}}Object(m.a)(Ee,"CommonActivityAggregationMethods",null,[]);var Jd=d(1050),Og=d(1062),Rg=d(582),Eg=d(318),xf=d(281),hd=d(93);class yf{constructor(){this.nWd=this.$wg=this.GEf=this.IQc=this.G1=this.WIe=this.Ghb=this.fNb=this.Y0a=this.UTd=this.T6e=this.U6e=this.MC=this.D9a=this.JC=this.J4b=this.U2b=this.l2d=this.Ync=this.P4b=this.ZDa=this.$Da=
this.Emb=this.z2b=this.j_d=this.A2b=this.Ycb=this.AGa=this.kA=null;this.A7=this.LAd=this.ODd=this.INd=this.DGd=this.XPd=this.HCd=!1}q_i(a,b){if(!this.A7){this.A7=!0;var c=Rg.a.instance,f=b.zG,l=b.nS,y=b.Lmb,H=b.Wy,Q=Eg.a.instance,ia=b.fha,wa=xf.a.instance,Ua=b.mwd,kb=b.jwd;z.a.Vi&&(Md.EventHandlerManager.instance.V3k(this.UTd),this.LAd=!0);b.Nca(this.G1);this.b3k(a.ao,f,l,H,y,wa,ia,Q,c,Ua,kb)}}hMl(a,b){if(this.A7){var c=Rg.a.instance,f=b.zG,l=b.nS,y=b.Lmb,H=b.Wy,Q=Eg.a.instance,ia=b.fha,wa=xf.a.instance,
Ua=b.mwd,kb=b.jwd;this.LAd&&(Md.EventHandlerManager.instance.kMl(this.UTd),this.LAd=!1);b.iLa(this.G1);this.eMl(a.ao,f,l,H,y,wa,ia,Q,c,Ua,kb);this.A7=!1}}b3k(a,b,c,f,l,y,H,Q,ia,wa,Ua){b.Np(a);c.Np(a);f.Np(a);l.Np(a);y.Np(a);hd.a.addHandler(a,oa.a.paste,this.Ync);hd.a.addHandler(a,oa.a.cut,this.l2d);hd.a.addHandler(a,oa.a.copy,this.U2b);!yf.P1j&&z.a.gg&&(hd.a.addHandler(a,oa.a.l4d,this.J4b),this.ODd=!0);hd.a.addHandler(a,oa.a.blur,this.nWd);f.rb(oa.a.click,a,this.JC);2===Rc.App.mode?H.hK(a,this.IQc,
!0):H.hK(a,this.IQc);Q.rb(a,this.MC);l.rb(oa.a.V6,a,this.U6e);l.rb(oa.a.e2,a,this.T6e);c.rb(oa.a.mouseDown,a,this.Ghb,null);c.rb(oa.a.YJ,a,this.WIe,null);b.rb(oa.a.Tl,a,this.AGa);b.rb(oa.a.uy,a,this.Ycb);b.rb(oa.a.Bf,a,this.kA);b.rb(oa.a.gRa,a,this.kA);f.rb(oa.a.doubleClick,a,this.D9a);hd.a.addHandler(a,oa.a.scroll,this.Y0a);if(z.a.y4e||z.a.gg)Ua.rb(oa.a.xMf,a,this.A2b,this),Ua.rb(oa.a.i_d,a,this.j_d,this),Ua.rb(oa.a.g_d,a,this.z2b,this),this.HCd=!0;Rc.App.wWd&&z.a.gGh||z.a.Ho?(wa.rb(oa.a.input,a,
this.Emb,this),this.DGd=!0):z.a.C4e&&(wa.rb(oa.a.R5e,a,this.Emb,this),this.XPd=!0);ia.rb(oa.a.drop,a,this.$Da);z.a.dva&&(ia.rb(oa.a.E9a,a,this.ZDa),ia.rb(oa.a.nVf,a,this.P4b),this.INd=!0);ia.rb(oa.a.eNb,a,this.fNb)}eMl(a,b,c,f,l,y,H,Q,ia,wa,Ua){hd.a.removeHandler(a,oa.a.paste,this.Ync);hd.a.removeHandler(a,oa.a.cut,this.l2d);hd.a.removeHandler(a,oa.a.copy,this.U2b);this.ODd&&(hd.a.removeHandler(a,oa.a.l4d,this.J4b),this.ODd=!1);hd.a.removeHandler(a,oa.a.blur,this.nWd);f.Bb(oa.a.click,a,this.JC);H.oF(a,
this.IQc);Q.Bb(a,this.MC);l.Bb(oa.a.V6,a,this.U6e);l.Bb(oa.a.e2,a,this.T6e);c.Bb(oa.a.mouseDown,a,this.Ghb);c.Bb(oa.a.YJ,a,this.WIe);b.ir(a);c.ir(a);f.ir(a);l.ir(a);y.ir(a);b.Bb(oa.a.Tl,a,this.AGa);b.Bb(oa.a.uy,a,this.Ycb);b.Bb(oa.a.Bf,a,this.kA);b.Bb(oa.a.gRa,a,this.kA);f.Bb(oa.a.doubleClick,a,this.D9a);hd.a.removeHandler(a,oa.a.scroll,this.Y0a);this.HCd&&(Ua.Bb(oa.a.xMf,a,this.A2b),Ua.Bb(oa.a.i_d,a,this.j_d),Ua.Bb(oa.a.g_d,a,this.z2b),this.HCd=!1);this.XPd&&(wa.Bb(oa.a.R5e,a,this.Emb),this.XPd=
!1);this.DGd&&(wa.Bb(oa.a.input,a,this.Emb),this.DGd=!1);ia.Bb(oa.a.drop,a,this.$Da);this.INd&&(ia.Bb(oa.a.E9a,a,this.ZDa),ia.Bb(oa.a.nVf,a,this.P4b),this.INd=!1);ia.Bb(oa.a.eNb,a,this.fNb)}static get P1j(){null==yf.RHd&&(yf.RHd=w.AFrameworkApplication.fa.ka("RemoveDomSubtreeModifiedEventHandlerIsEnabled"));return yf.RHd}}yf.RHd=null;Object(m.a)(yf,"ContentEditableSurfaceEventHandlers",null,[]);var cd=d(61),cg=d(119),xh=d(850),Yf=d(136),Hf=d(258);class ji extends Og.a{constructor(a,b,c,f,l,y,H,Q,
ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye,Xd,Xf,ug,qg,Fg,qf,bg,Kg,rg,ui,Ik,vg,Lg){super(vg);this.lFc=null;this.WQc=this.gxb=this.f4b=this.gV=!1;this.Pf=a;this.Uc=b;this.Yk=c;this.Ut=H.create(this);this.Lob=Fg;this.jd=Q;this.uqa=Lg;y.ya(C.a.qTf,yb.a.application,vf.ActionManager.Sg);y.ya(C.a.rTf,yb.a.application,vf.ActionManager.Sg);f.execute(rh=>{rh.eRi(C.a.typing,lf.a.ofh);rh.rZe(C.a.typing,lf.a.source,Ee.hJi)});l&&l.execute(rh=>{rh.jYl(Object(I.a)(this,this.Uxa,"onZoomChanged"))});this.Ep=wa;this.Cqa=
tc;this.gOd=Gb;this.JK=Ua;this.$K=ec;this.$K.init(this.Na);this.J2=dc;this.wf=Fc;this.Xk=kb;this.Qb=ia;this.Qb.init(this.Na);this.Bh=xd;this.O5a=Vd;this.$s=yc;this.FPa=Ld;this.mI=Xf;this.ks=ye;this.AC=ug;this.NOa=Xd;this.WV=qg;this.hWh=qf;this.iWh=bg;this.DXh=Kg;this.gWh=rg;this.jia=ui;this.fWh=Ik;this.jia.Wfi(Object(I.a)(this,this.b8g,"onBindEditingDom"));this.jia.ngi(Object(I.a)(this,this.mch,"onUnbindEditingDom"));this.jia.Efi(Object(I.a)(this,this.bjh,"pushViewElementValidationStates"));this.jia.Dfi(Object(I.a)(this,
this.b$g,"onInteractiveViewOnAfterLoadContent"));this.Pcf=!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("ChromiumEdgeUIPasteForPPTIsEnabled")&&z.a.u0c;this.tff=!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix")&&z.a.$T}get Md(){return this.Nf.Md}dispose(){this.jia.F7k(Object(I.a)(this,this.b8g,"onBindEditingDom"));this.jia.R7k(Object(I.a)(this,this.mch,"onUnbindEditingDom"));this.jia.y7k(Object(I.a)(this,this.bjh,"pushViewElementValidationStates"));
this.jia.x7k(Object(I.a)(this,this.b$g,"onInteractiveViewOnAfterLoadContent"));this.gWh.dispose();super.dispose()}Uxa(){this.Mga=!0}get ownerDocument(){const a=this.jd.Wta();return a?a.Jl:null}get container(){return this.ISa}get B_d(){return this.ao}createElement(a){a=this.ownerDocument.createElement(a);this.jd.Cg.XQh.appendChild(a);return a}lp(a){a=md.a.createElement(this.ownerDocument,a);this.jd.Cg.XQh.appendChild(a);return a}OCa(){throw Error.notImplemented("BindToContainer doesnt mean anything for ContentEditableView yet--we shouldn't be calling it!");
}RKe(){this.Ep.raiseEvent(vc.a.EXi);this.WQc=!0}get ISa(){return this.jd.Cg?this.jd.Cg.Gu:null}get ao(){return this.jd.Bm()}get UAb(){return!0}oBi(){this.J2.EMc()}get I2c(){return this.ks.rGa}get isComposing(){return this.ks.isComposing}FSk(){this.Pcf||this.tff?this.FPa.rhh(!0,""):(this.disable(!1,24),this.bsd(!0),z.a.Ex&&(this.ISa.style.overflow="hidden"),this.ISa.style.width="0px",this.ISa.style.height="0px",this.ISa.style.display="block",this.Ep.raiseEvent(vc.a.gNk),this.J2.EMc(),this.$K.xLa(this.Bh.mode,
this.Qb.Pi,this.Qb.Gg,this.Qb.Zh,this.Yk.value.isEditingAllowed||this.Yk.value.sz))}DEl(){this.Pcf||this.tff?this.FPa.Lrh("none"):z.a.Ex&&this.ISa&&(this.ISa.style.overflow="none")}Zs(a,b=!1){this.mI.Zs(a,b)}dZ(){this.$s.dZ()}get hm(){return!0}lha(a,b){if(1===this.mode&&17!==a.Bi){const c=a.currentNode;if(!ge.a.instance.Pa.uH&&!c.qBb(ge.a.instance.Pa.Zr)&&6!==a.role)return!1}return super.lha(a,b)}get XF(){let a=super.XF;switch(this.mode){case 2:a|=450;break;case 1:a|=448;break;case 0:a|=511}return a}get Jvb(){const a=
w.AFrameworkApplication.fa.ka("EditingViewDelayUpdateFixIsEnabled");return a&&!this.I2c?2:this.root&&this.ownerDocument&&this.isActive&&!this.Cqa.K9?a||this.I2c?1:2:3}rY(a){return this.iWh.rY(a)}i1(a){return this.hWh.i1(a)}H1d(){return new xh.a(this.Na)}WKe(a){!w.AFrameworkApplication.Yg&&0!==this.mode&&this.Nf&&this.Nf.Go&&(this.ubk(a),this.Uc.Nle())}ubk(a){if(a){var b=a.pB;a=this.L3f(a.Zu,!0);b=this.L3f(b,!1);ka.ULS.sendTraceTag(38396191,324,50,"Parent : [{0}] Child : [{1}]",a,b)}}L3f(a,b){let c=
"";a&&(a=a.node)&&(c+="nodeId : "+a.id+"; type : "+a.type+"; ",Db.ParagraphReader.ae(a)&&(c+="paraId : "+Db.ParagraphReader.S7b(a)+"; ",c+="hasImage : "+cg.a(a,5)+";"),b&&(b=ob.GraphIterator.pb(a),b.kf(),c+="inTable : "+cd.TableReader.Gs(b)+";"));return c}nMe(a){!w.AFrameworkApplication.Yg&&1===this.mode&&a&1&&this.Nf&&this.Nf.Go&&this.Uc.YMe()}bsd(a){this.jd.q1a(a)}cdb(a,b,c){this.Lob.cdb(a,b,c)}uRc(){this.NOa.uRc()}Znl(){this.gOd.vZf(ge.a.instance.Pa)}Qkb(){this.$K.Qkb(this.mode,this.Qb.Pi,this.Qb.Gg,
this.Qb.Zh,this.Yk.value.isEditingAllowed||this.Yk.value.sz)}xLa(){this.$K.xLa(this.mode,this.Qb.Pi,this.Qb.Gg,this.Qb.Zh,this.Yk.value.isEditingAllowed||this.Yk.value.sz)}get Gg(){return this.isActive?this.Qb.Gg:null}get mode(){return this.Bh.mode}get isActive(){return this.wf.isActive}get DVa(){return this.wf.I7b(this.Qb.Gg)}get Epe(){return this.wf.r8f(this.Qb.Gg)}get Nf(){return this.Pf.Rd}get LNe(){return this.O5a.tNf}get mza(){return this.NOa.mza}set mza(a){this.NOa.mza=a}get Mga(){return this.$s.Mga}set Mga(a){this.$s.Mga=
a}get hne(){return!0}get UVe(){return 2}get Ltd(){const a=this.Yk.value.isEditingAllowed||this.Yk.value.sz;return this.uqa.Ltd?a:!0}get mKa(){return this.FPa.mKa}get lvb(){return this.Xk}get kLl(){return this.AC}get pHi(){return this.Lob}get nLj(){return this.NOa}get XKk(){return this.WV}kdc(a){return Hf.a.qvg(a,this)}fMb(a){return Hf.a.Gph(a,this)}krc(a){return Hf.a.Uph(a,this)}mlc(a){return Hf.a.B3g(a,this)}kub(a){return Hf.a.BHf(a,this)}rsc(a){return Hf.a.$uh(a,this)}x6b(a){return Hf.a.p1f(a,this)}w0b(a){return Hf.a.SDf(a,
this)}QVj(){switch(this.mode){case 2:if(this.Qb.Gg)return this.RVj(this.Qb.Gg)}return!1}RVj(a){a=Yf.a.pb(this.Na,a.node);return a.fr&&a.kf()?a.lSa.oY(510&~this.XF):!0}b8g(a,b){this.wEf(b.Cg)}mch(){this.jd.xLl()}NNj(a,b,c,f){a=this.fWh.create(a,b,this.uqa);b=new yf;b.IQc=c;this.DXh.uPk(b);a.initialize(b,f);return a}wEf(a){this.jd.Dpi(a,this)}disable(a,b){this.Bh.Yaa(0,a,b)}o2a(){this.Bh.o2a()}suspend(){this.Cqa.suspend()}resume(){this.Cqa.resume()}bjh(a,b){this.Pf.Rd===b.Nf&&(this.lFc=this.pNa,this.pNa=
new Jd.a(0))}lPk(){const a=this.lFc,b=this.pNa;for(let c=0;c<b.keys.length;++c){const f=b.keys.ga(c);let l;a.$(l=f,a.ga(l)|b.ga(f))}this.pNa=a;this.lFc=null}KKf(){this.lFc=null}E1e(a){return 1!==this.mode||a.Qy||this.Nf.Nb.Pa.uH?!1:!0}Dqe(a,b){return this.Nf.Nb&&!this.Nf.Nb.Pa.uH&&b?a.Qy!==b.aqe:!0}b$g(a,b){this.Pf.Rd===b.Nf?this.lPk():this.Pf.Rd||this.KKf()}}Object(m.a)(ji,"ContentEditableView",Og.a,[518,166,107,1450]);class Qi{constructor(a,b,c,f,l,y){this.qd=a;this.fg=b;this.nj=c;this.ep=f;this.Pf=
l;this.Cr=y}Tmg(a){return Sys.UI.DomElement.containsCssClass(a,xc.a.fNf)}}Object(m.a)(Qi,"ContentEditableViewContentControlHelper",null,[1383]);var ah=d(406),Kd=d(129),Qd=d(118),Gg=d(851);class Sg{constructor(a,b,c,f,l){this.x2b=!1;this.ONe=this.wkd=-1;this.LF=a;this.Fle=b;this.UKc=c;this.AUa=f;this.z_a=l}}Object(m.a)(Sg,"ActiveContentSpan",null,[]);class Wh{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye,Xd){this.Yha=this.NTb=null;this.O9=!1;this.Etf=0;this.cDd=Ld;this.Pf=a;
this.qd=b;this.fg=c;this.nj=f;this.Uc=l;this.rf=y;this.MK=H;this.Bh=Q;this.Qb=ia;this.Yk=wa;this.hqa=Ua;this.wf=kb;this.Zd=Gb;this.ud=ec;this.aj=dc;this.ep=Fc;this.Jh=yc;this.JK=tc;this.jd=xd;this.VD=Vd;this.aB=Xd}get Jda(){return this.Yha||(this.Yha=Ib.a.instance.qb("Box4.IFormatPainter"))}Epi(a){this.NTb=a}get REh(){return this.Etf}HQi(a,b,c){const f=this.Pf.Rd;if(!f)return!1;f.TLe();if(2!==this.Bh.mode)return this.qd.Xb("PossibleFocusWeirdness",{["Reason"]:"ClickOnHiddenEditingFrame"}),this.fg.be++,
!1;if(this.nj&&b)return this.qd.Xb("DisallowedClickDuringDictation",{["Reason"]:"CursorPositioningClick"}),this.fg.bf++,!0;if(3!==a.ng&&a.LA===Sys.UI.MouseButton.rightButton&&this.ud.gg)return Rc.App.Lb.qba.J5i(a.mc.rawEvent),!0;if(!f)return!1;b=f.Gka(a);if(3===a.ng){var l=this.Uc.Pa.mb;if(this.rf.Dx(l)){var y=l.Va.node.tg(f.Na);l=this.aB?this.aB.SRa(l.Va,!0):l.Va.Sa;y=T.a.tW(l,y,!!l,!1,!1);y=new Sys.UI.Bounds(y.x-7,y.y,14,y.height);if(ah.a.Ald(b,y))return Rc.App.Lb.C6(b,3),!0}}if(!c)return!0;this.aj.gSf(this.Bh,
this.Qb);v.FocusManager.mN()&&(v.FocusManager.instance().vf(f.VI),this.JK.setFocus(this.Bh.mode,this.Qb.Pi,this.Qb.Gg,this.Qb.Zh,this.Yk.value.isEditingAllowed||this.Yk.value.sz));(c=rf.a(a.Bc))?(this.NTb.Zs(!0),f.Y6(a.clientPoint,c,c.gb,f,a.mc.rawEvent.shiftKey,a.n_,a.ng)):f.Y6(b,null,null,f,a.shiftKey,a.n_,a.ng);this.Jda&&this.Jda.PL&&this.hqa.processAction(C.a.Aka,2);this.NTb.cdb(a.shiftKey,b,a.ng);f.nLe(new Gg.a(a));this.ud.kJ&&(a=new dd.a(0,1,0,()=>{this.wf.NLa(!0);this.fixupAfterCursor(5)},
27),this.Zd.Hb(a));return!0}T4e(a,b=!1){if(2===this.Bh.mode&&this.Qb.Zh){var c=this.jd.Cg.Gu;if("0px"!==c.style.height&&"0px"!==c.style.width||!this.ud.ype){c=this.Uc.Pa.mb;var f=!!this.MK&&this.MK.ubb();this.nj&&a?(this.qd.Xb("MomentaryIncorrectIpPosition",{["Reason"]:"NoSynchronizeCursorDuringDictation"}),this.fg.bm++):(this.bkl(b||f,this.Qb.Zh.At,this.Uc.Pa.mb.Va),f&&this.MK.l5e(c))}}}bkl(a,b,c){let f=0,l=0;c=c.Sa;let y=!1;for(let H=0;H<b.length;H++){const Q=b[H],ia=this.ep.cJ(Q,this.fg,this.qd,
this.nj);if(Sys.UI.DomElement.containsCssClass(Q,da.a.pW))f+=ia;else if(y||(this.Etf=f,y=!0),Sys.UI.DomElement.containsCssClass(Q,xc.a.FN))c--,f+=ia,l++;else{if(c<=ia){a||this.aj.yT(f+c,this.Qb.Zh);this.Qrd(b,H,f,l,c);break}c-=ia;f+=ia;l+=ia}}}fixupAfterCursor(){if(2===this.Bh.mode){var a=this.aj.U8(this.Bh.mode,this.Qb.Pi),b=0,c=0,f=this.Qb.Zh.At,l;for(l=0;l<f.length;l++){const y=this.ep.cJ(f[l],this.fg,this.qd,this.nj);let H,Q,ia;({t4:H,Cla:ia,DAb:Q}=this.Iyi(f,l));if(a<=y&&this.n6i(f,l,a,H,ia,
b,c,Q))return;a-=y;b+=y;H?c++:Q||(c+=y)}this.qd.Xb("ActiveContentSpansOutOfSync",{["Reason"]:"FixupAfterCursorFailed"});this.fg.bq++}}n6i(a,b,c,f,l,y,H,Q){const ia=a[b],wa=this.ep.cJ(ia,this.fg,this.qd,this.nj);if(f||this.nj&&l)if(l||!this.O9&&c!==wa){if(this.fg.bo++,this.aj.yT(y,this.Qb.Zh),c=this.ep.cJ(a[b-1],this.fg,this.qd,this.nj),this.Qrd(a,b-1,y-c,H-c,c),l)return!0}else this.fg.bn++,this.aj.yT(y+wa,this.Qb.Zh),this.Qrd(a,b+1,y+wa,H+1,0);else if(!Q)return ma.a.Gx(Ea.a.Fv(ia),c)&&(this.fg.bp++,
this.aj.yT(y+c+(this.O9?1:-1),this.Qb.Zh)),this.Qrd(a,b,y,H,c),!0;return!1}Iyi(a,b){let c,f;c=Sys.UI.DomElement.containsCssClass(a[b],xc.a.FN);f=Sys.UI.DomElement.containsCssClass(a[b],da.a.pW);a=Sys.UI.DomElement.containsCssClass(a[b],xc.a.VN);return{t4:c,Cla:a,DAb:f}}Qrd(a,b,c,f,l){const y=this.Qb.HW,H=a[b];Sys.UI.DomElement.containsCssClass(H,xc.a.VN)&&(ka.ULS.shipAssertTag(4318915,315,!1),this.qd.Xb(Kd.a.h2,{["Reason"]:Qd.a.dYf}));Sys.UI.DomElement.containsCssClass(H,xc.a.FN)&&(ka.ULS.shipAssertTag(4318916,
315,!1),this.qd.Xb(Kd.a.h2,{["Reason"]:Qd.a.AEf}));a=this.DMi(a,b,c,f,l,y);b=a.length!==this.Jh.Ki.length;for(c=0;!b&&c<this.Jh.Ki.length;)this.Jh.Ki[c].LF!==a[c].LF&&(b=!0),this.Jh.Ki[c].z_a!==a[c].z_a&&(b=!0),c++;b&&(this.NTb.DVa&&this.NTb.Zs(!0),this.Jh.Ki=a)}DMi(a,b,c,f,l,y){const H=a[b];var Q=this.ep.cJ(H,this.fg,this.qd,this.nj);const ia=[];let wa=null;b<a.length-1&&l===Q&&(wa=a[b+1]);var Ua=null;0<b&&!l&&(Ua=a[b-1]);a=this.cDd.ze(H,da.a.EGa);a=y.At[a];Array.add(ia,new Sg(H,a,c,f,Q-(this.VD.O7?
1:0)));!wa||Sys.UI.DomElement.containsCssClass(wa,xc.a.VN)||Sys.UI.DomElement.containsCssClass(wa,xc.a.FN)?!Ua||Sys.UI.DomElement.containsCssClass(Ua,xc.a.VN)||Sys.UI.DomElement.containsCssClass(Ua,xc.a.FN)||Sys.UI.DomElement.containsCssClass(Ua,da.a.pW)||(a=this.cDd.ze(Ua,da.a.EGa),a=y.At[a],Q=this.ep.cJ(Ua,this.fg,this.qd,this.nj),Array.insert(ia,0,new Sg(Ua,a,c-Q,f-Q,Q))):(a=this.cDd.ze(wa,da.a.EGa),a=y.At[a],Ua=this.ep.cJ(wa,this.fg,this.qd,this.nj),Array.add(ia,new Sg(wa,a,c+Q,f+Q,Ua)));return ia}}
Object(m.a)(Wh,"ContentEditableViewCursorManager",null,[1449]);class Bg{}Object(m.a)(Bg,"ContentEditableViewDebugLogger",null,[]);class oh{constructor(a,b,c,f,l,y,H){this.ara=a;this.AC=b;this.Jh=c;this.LAc=f;this.fg=l;this.Pba=y;this.Bh=H}dispose(){this.ara.xKf();this.AC.dispose();this.Jh.jKf();this.LAc.zrd();Zd.a.instance.qak(this.fg);this.Pba.raiseEvent(Kh.a.Obk);this.Bh.dispose()}}Object(m.a)(oh,"ContentEditableViewDisposer",null,[]);class Yj{constructor(){this.hQc=!0}cdb(a,b,c){a&&(this.hQc=!1,
Rc.App.Lb.C6(b,c))}}Object(m.a)(Yj,"ContentEditableViewFloatieHandler",null,[1448]);var Gh=d(1143),Xh=d(145);class Yg{constructor(a,b,c,f,l,y,H){this.Blf=0;this.G1c=this.B$b=this.qhe=this.uhe=!1;this.jd=a;this.Pf=b;this.MK=c;this.nj=f;this.xq=l;this.GBd=y;this.Pd=H}$pi(){this.nj&&!this.B$b&&100<(new Date).getTime()-this.Blf&&(Xh.GrippersManager.instance.$9b=!0,this.G1c=!1)}setFocus(a,b,c,f,l){const y=this.Pf.Rd;this.Blf=(new Date).getTime();this.MK&&this.MK.ubb()||(1===a?this.Vkl(l):this.nj&&!this.xq.whe&&
Md.EventHandlerManager.instance.oYf!==oa.a.click||!this.jd.Cg.Ilb||(l=new Gh.a(y),this.jd.Cg.ixd(),this.nj&&(this.B$b=!0,this.jd.Bm().blur(),this.B$b=!1),this.jd.Cg.wKh(),c&&f&&""!==b.innerText&&b.focus(),this.GBd.H9&&(this.G1c=!0),l&&l.dispose(),this.GBd.Wj&&0!==a&&(this.jd.Cg.Ilb=!1)))}Vkl(a){if(!this.nj||a){a=null;z.a.Wj&&(a=new Gh.a(this.Pf.Rd));this.jd.Cg.Ilb&&(this.jd.Cg.ixd(),this.jd.Cg.wKh(),z.a.Wj&&(this.jd.Cg.Ilb=!1),this.GBd.H9&&this.xq.whe&&(this.G1c=!0));var b=this.jd.Bm();this.jd.Cg.Ilb&&
b.firstChild&&3!==b.firstChild.nodeType&&b.firstChild.focus();a&&a.dispose()}}FZi(a){2!==a&&1!==a||this.jd.Cg.ixd()}Ine(){const a=this.Pd.Ee;return!!a&&this.Pf.Rd.VI===a.name}}Object(m.a)(Yg,"ContentEditableViewFocusHelper",null,[1447]);class dg{constructor(a,b,c){this.k$b=a;this.ljb=b;this.usa=c}}Object(m.a)(dg,"GraphUpdateState",null,[]);var Od=d(53),We=d(109);class Zj{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye,Xd,Xf,ug,qg,Fg,qf,bg,Kg,rg){this.Ye=this.rTb=null;this.Lk=
Kg;this.Cr=bg;this.Oha=a;this.Bh=b;this.qd=c;this.Uc=f;this.MK=l;this.rf=y;this.wf=H;this.SK=Q;this.Qb=ia;this.Xk=wa;this.VD=Ua;this.Jh=kb;this.jd=Gb;this.FV=ec;this.wS=dc;this.Cqa=Fc;this.EZ=yc;this.Jia=xd;this.aj=Vd;this.O5a=Ld;this.$s=ye;this.fg=Xd;this.B7=Xf;this.Zd=ug;this.ud=qg;this.hia=Fg;this.zTh=qf;this.mh=tc;this.Vz=rg}iT(a){this.Ye=a}get bYc(){const a=this.EZ.Vta(this.FV.O9);return a?a.Va.Sa:0}get Fqi(){return this.bYc}Zs(a,b=!1){ka.ULS.shipAssertTag(18437283,315,!!this.mh);if(this.Ye.DVa||
this.Ye.Epe)if(this.Ye.kLl.typingProcess(),this.Ye.isActive&&2===this.Bh.mode&&(this.Ye.DVa||this.Ye.Epe)){var c=this.qd.Zp(C.a.Zs);this.Oha.tG(()=>{this.vOl(a,b)},"ContentEditableView:UpdateGraphInternal");c.end()}}hll(a,b=!1){const c=this.rf.Pz;this.Uc.setSelection(a,void 0,void 0,b);this.rf.Pz=c}vOl(a,b=!1){We.c(36226527,306,100,"UpdateGraphInternalCalled");this.wf.Nal();if(this.Qb.Zh){a=new dg(!1,a,!1);a.ljb&&this.Cqa.suspend();this.Jia.fixupAfterMagnifierDrag();var c=this.SK.YTa();c.set(this.Qb.Gg.node);
var f=this.Lk.je(b?12:15,C.a.Zs);f.fd=this.Xk.n3?C.a.NCa:C.a.typing;f.Sy(c);this.VD.htl(a.ljb,this.Ye.I2c,this.Jh)&&(this.fg.v++,this.VD.mlb(!1,this.Qb.Pi,this.Jh));var l=!!this.MK&&this.MK.ubb(),y=l?ge.a.instance.Pa.mb:this.wAi();this.lOk(a);this.rPl();this.rerenderWhenNeeded(b,a,c);l||this.y6i(b,y);this.Jh.jKf();f.dispose();this.iDl(a);this.$s.Mga&&(this.$s.dZ(),this.$s.Mga=!1);a.ljb&&this.Cqa.resume();this.Xk.F1();We.c(18437313,306,100,"UpdateGraphInternalExited")}else ka.ULS.shipAssertTag(17884510,
315,!1,"CurrentEditingViewElement is NULL. Bail out updateGraph early!")}iDl(a){a.k$b||this.FV.T4e(this.Xk.uea,a.usa)}rerenderWhenNeeded(a,b,c){!b.k$b||this.Xk.Wsg()||a||(this.Bh.Yaa(0,!0,5),b.ljb&&(this.Cqa.resume(),b.ljb=!1),this.cac(c.currentNode))}wAi(){this.aj.updateCaretPosition(this.Bh.mode,this.Qb.Pi);this.O5a.x9e();this.wS.a6i(this.jd.Bm(),this.qd);return this.EZ.Vta(this.FV.O9)}y6i(a,b){const c=this.Cr.textLength(b.Va.node);b.Va.Sa>c&&(b=Od.SelectionFactory.Qg(b.Va.node,c));this.hll(b,a);
a=!!this.MK&&this.MK.RAb(b);this.Xk.Wsg()&&!a&&this.aj.yT(this.aj.zWa,this.Qb.Zh)}cac(a){N.a.instance.ga(70)&&Rc.App.oS.cac(a)}rPl(){if(N.a.instance.ga(2)){const a=Za.OutlineElementNavigator.vB(this.Ye.Gg);a&&Zb.ListReader.PVa(a)}}P2d(){if(this.Ye.DVa||this.Ye.Epe)this.rTb?this.Zd.E1(this.rTb,Zj.hSf):(this.rTb=new dd.a(0,1,Zj.hSf,Object(I.a)(this,this.delayUpdateGraphCallback,"delayUpdateGraphCallback"),26),this.Zd.Hb(this.rTb))}delayUpdateGraphCallback(){this.rTb=null;this.Qb.wWa(this.Bh.mode)&&
this.Zs(!0)}U6k(){let a;if(this.Xk.n3){var b=this.bYc;a=this.Xk.ZNc}else if(this.Xk.Usa)b=this.bYc,a=b+(this.Xk.gwd-Ea.a.Fv(this.Qb.gSa).length);else return;if(b===a)this.qd.Xb("PossibleDropACharDeletion",{["Reason"]:"LostBrowserSelection"});else{ka.ULS.shipAssertTag(18437315,315,b<=a);var c=this.Cr.text(this.Ye.Gg),f="";this.Cr.OTa(this.Ye.Gg,a);if(!b&&a<c.length&&" "===c.charAt(a)||0<b&&a<c.length&&" "===c.charAt(b-1)&&" "===c.charAt(a))a+=1,f+=gc.wJb;this.kBi(this.Ye.Gg);b=cb.a.createTextRange(this.Ye.Gg,
b,a);this.mh.replaceTextRange(b,f,void 0,void 0,C.a.ZVd)}}kBi(a){N.a.instance.ga(70)&&this.Vz.BMc(a)}lOk(a){let b=!0;if(this.B7.bjg)this.B7.SYi();else{const c=1<this.jd.Bm().childNodes.length;a.k$b=this.wS.Pxd();if(a.k$b||this.Xk.Usa||this.Xk.n3){a.k$b&&this.fg.w++;c&&(this.qd.Xb("PossibleValidTextDropped",{["Reason"]:"ExtraParagraphsFound"}),this.fg.x++,b=!1);if(this.Xk.n3||this.Xk.Usa)this.U6k(),this.wS.wrc(),b=!1;a.ljb&&(this.qd.Xb("PossibleImeAutoDetermine",{["Reason"]:"StopPreseveringBrowserState"}),
this.fg.z++,this.Cqa.resume(),a.ljb=!1);this.Jh.vAi(this.Qb.Zh)}}a.usa=!0;b&&(a.usa=this.zTh.kOk(this.Qb.Gg,this.Qb.Pi,this.Qb.Zh,this.mh,this.hia.instance))}}Zj.hSf=250;Object(m.a)(Zj,"ContentEditableViewGraphUpdater",null,[]);var ij=d(438),Wd=d(59);class ki{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye,Xd,Xf,ug,qg,Fg,qf,bg){this.Ye=null;this.qug=0;this.Kmf=!1;this.Ma=a;this.Bh=b;this.Qb=c;this.Pf=f;this.jd=l;this.Kha=y;this.$s=H;this.VD=ia;this.ud=wa;this.fg=Ua;this.Cr=kb;
this.Jh=Gb;this.wS=ec;this.YPd=dc;this.ara=Fc;this.JK=yc;this.O5a=tc;this.Uc=xd;this.nj=Vd;this.$K=Ld;this.Yk=ye;this.Xk=Xd;this.Ep=Xf;this.SK=ug;this.iQa=qg;this.tca=Fg;this.kd=qf;this.z0h=bg}iT(a){this.Ye=a}tAk(a){this.Ma.raiseEvent(Nf.eventId,new Nf(a.lN,this.Ye.gV),this.Ye);if(1===this.Bh.mode)return this.uAk(a);if(0===this.Bh.mode||!this.aOl(a))return!1;this.VD.yKf();if(this.$Nl())return!0;this.u6i();this.ara.cFh(this.Qb.Zh);this.s6i();!this.Kmf&&this.Qb.Zh&&0<this.Qb.Zh.Evd&&(this.Kmf=!0,w.AFrameworkApplication.dM("Microsoft.Office.Web.SessionSettings.IWacWordEditorInlineTabsSettings"));
this.kd&&this.kd.isFeatureEnabled(84)&&this.Nph(this.Qb.Zh);this.O5a.x9e();this.z0h||this.tca.BLb(Object.assign(new ij.a,{Ttc:!0}));this.kd&&this.kd.isFeatureEnabled(84)||this.Nph(this.Qb.Zh);return!0}Nph(a){a&&a.Evd&&(this.iQa?this.iQa.rYl(a,!0):ka.ULS.sendTraceTag(23708818,323,10,"TabRenderer is null."))}aOl(a){if(!this.Qb.Gg)return!1;this.Qb.Zh=this.Qb.Gg.qc(this.Ye.Na);this.Qb.Zh||ka.ULS.sendTraceTag(18437322,324,15,"current editing view element is set to null!");this.Qb.HW=this.Qb.Gg.qc(this.Pf.Rd.Na);
if(!this.Qb.HW)return!1;this.jd.Cg.eKe(this.Qb.HW);const b=this.jd.Bm(),c=this.Qb.gSa;(b?b.firstChild:null)!==c&&c&&(Ea.a.vv(b),b.appendChild(c));if(!a.lN&&!this.Ye.WQc){this.Ye.gV&&this.Kha.T4e(this.Xk.uea);this.Ye.gV=!1;if(this.$s.Mga||!a.dKa)this.$s.dZ(),this.$s.Mga=!1;return!1}this.Ye.WQc&&(this.Ye.WQc=!1,this.Ye.gxb=!0);return!0}s6i(){this.$s.dZ();if(this.Ye.gxb){this.JK.setFocus(this.Bh.mode,this.Qb.Pi,this.Qb.Gg,this.Qb.Zh,this.Yk.value.isEditingAllowed||this.Yk.value.sz);if(this.ud.gg){const a=
this.jd.Bm(),b=a?a.firstChild:null;b&&3===b.nodeType&&(this.fg.bv++,a.removeChild(b))}this.Ye.gxb=!1}this.Kha.T4e(this.Xk.uea)}u6i(){if(this.ud.gg){var a=this.jd.Bm();const b=a?a.firstChild:null;b&&"BR"===b.tagName&&(this.fg.bu++,a.removeChild(b))}this.ud.zPb||(a=this.SK.Lc(this.Qb.Gg),this.Cr.isEmpty(a)&&!this.Cr.one(a)&&this.VD.mlb(!0,this.Qb.Pi,this.Jh));this.YPd.value.m2b(this.jd.Bm(),this.jd.contentWindow);this.wS.wrc()}$Nl(){var a=this.Qb.HW;const b=this.jd.Bm().style;if(this.Ye.gxb){if(!a)return!0;
a=this.Qb.Zh.htmlElement;this.$s.FBh()&&(b.position="absolute",b.width="100%");a.style.width="auto";a.style.height="auto"}this.Qb.rda=this.K_j();return!1}K_j(){return Wd.OutlineElementReader.Gm(Za.OutlineElementNavigator.vB(this.Qb.Gg.node))}rt(a){return af.a.rt(a)}uAk(a){if(!this.Uc.Pa||!this.Uc.Pa.mb)return ka.ULS.sendTraceTag(19711041,324,15,"Attempt to validate selection with empty selection."),!1;if(!this.Ye.gV&&(!a.lN||Rc.App.kme&&a.dKa))return this.$s.Mga&&(this.$s.HGh(this.Ye.Na),this.$s.Mga=
!1),!1;this.Ye.gV=!1;a=(new Date).getTime();const b=this.Uc.Npa;!this.nj&&!b.Ioe&&!b.xqe&&250<a-this.qug?this.dSf(null):(this.Ep.raiseEvent(vc.a.Ayk),b.wml(Object(I.a)(this,this.dSf,"delayOnAfterValidateSelection")));return!0}dSf(){1===this.Bh.mode&&(this.Uc.Pa.Cea&&this.Qb.Gg&&(this.Qb.Zh=this.Qb.Gg.qc(this.Ye.Na),this.Qb.Zh||ka.ULS.sendTraceTag(18437327,324,15,"current editing view element is set to null!"),this.Qb.HW=this.Qb.Gg.qc(this.Pf.Rd.Na)),this.Uc.Pa.Cea&&this.jd.Bm().firstChild!==this.Qb.gSa&&
this.Qb.gSa&&(Ea.a.vv(this.jd.Bm()),this.jd.Bm().appendChild(this.Qb.gSa)),this.jd.Bm().firstChild&&(this.Uc.Pa.Cea?this.jd.Bm().style.direction=this.rt(this.jd.Bm().firstChild).direction:Sys.UI.DomElement.containsCssClass(this.jd.Bm().firstChild,"Rtl")?this.jd.Bm().style.direction="rtl":this.jd.Bm().style.direction="ltr",this.Uc.Pa.Cea&&this.ara.cFh(this.Qb.Zh),this.$s.HGh(this.Ye.Na),this.$K.Qkb(this.Bh.mode,this.Qb.Pi,this.Qb.Gg,this.Qb.Zh,this.Yk.value.isEditingAllowed||this.Yk.value.sz)),this.qug=
(new Date).getTime(),this.Ep.raiseEvent(vc.a.H5i))}i1(a){const b=this.tAk(a);this.Ep.raiseEvent(!a.lN||Rc.App.kme&&a.dKa?vc.a.GJc:vc.a.Xdh);return b}}Object(m.a)(ki,"ContentEditableViewOnAfterValidateHandler",null,[]);class xi{constructor(a,b,c,f,l){this.Ye=null;this.$s=a;this.ks=c;this.jd=f;this.Ep=l}iT(a){this.Ye=a}rY(a){const b=this.Ye.Jvb;let c=3===b;c||2!==b||(this.Ye.root.che(510),c=!0,this.$s.dZ());if(c)return a.cancel=!0,!1;this.Ep.tXk(a);return!1}}Object(m.a)(xi,"ContentEditableViewOnBeforeValidateHandler",
null,[]);class Pg{constructor(a,b,c,f,l){this.O7=!1;this.uBa=null;this.Ep=a;this.qd=b;this.fg=c;this.jd=f;this.Xqf=l}yKf(){this.O7=!1}mlb(a,b,c){const f=this.jd.Wta();a&&(this.O7=Ea.a.Fv(b)!==da.a.lRc);if(a&&!this.O7){for(b=this.jd.Bm();b.firstChild;)b=b.firstChild,this.Xqf&&Sys.UI.DomElement.containsCssClass(b,xc.a.JMa)&&Sys.UI.DomElement.addCssClass(b,xc.a.RNe);3!==b.nodeType?(this.uBa=f.Jl.createTextNode(gc.wJb),b.appendChild(this.uBa)):(this.uBa=b,this.uBa.nodeValue=gc.wJb);this.O7=!0;this.Ep.mkh(!0)}if(!a&&
this.O7){a=this.uBa;b=null;try{b=this.uBa.parentNode,b||""!==a.nodeValue||(this.uBa=null)}catch(l){this.fg.i++,this.uBa=null}this.uBa&&b!==f||(this.qd.Xb("PossibleExtraSpace",{["Reason"]:"LostPadding"}),this.fg.j++,c.Ki.length&&(a=this.j0f(c.Ki[c.Ki.length-1].LF)));if(a&&(a.nodeValue.endsWith(" ")||a.nodeValue.endsWith(gc.wJb))){if(this.Xqf)for(c=a;(c=c.parentNode)&&c.tagName&&"P"!==c.tagName.toUpperCase();)if(Sys.UI.DomElement.containsCssClass(c,xc.a.RNe)){Sys.UI.DomElement.removeCssClass(c,xc.a.RNe);
break}c=a.nodeValue;a.nodeValue=c.substring(0,c.length-1)}this.O7=!1;this.Ep.mkh(!1)}}htl(a,b,c){return!this.O7||a||(z.a.dG&&!z.a.ik||z.a.aG)&&!b?!1:c.Bwf()}j0f(a){if(a.className===xc.a.VN)return null;var b=a.childNodes?a.childNodes.length:0;if(b)for(--b;0<=b;--b){const c=this.j0f(a.childNodes[b]);if(c)return c}else if("#text"===a.nodeName&&(b=a.nodeValue,b.endsWith(" ")||b.endsWith(gc.wJb)))return a;return null}}Object(m.a)(Pg,"ContentEditableViewPaddingManager",null,[1446]);class Ej{constructor(a){this.U2d=
this.S5e=this.Usa=this.n3=!1;this.q4c=this.gwd=this.ZNc=-1;this.YGd=!1;this.ire=0;this.hqa=a}get uea(){return this.YGd}set uea(a){a!==this.YGd&&this.hqa.processAction(a?C.a.qTf:C.a.rTf,2);this.YGd=a}Wsg(){return this.S5e||this.Usa||this.n3}F1(){this.U2d=this.S5e=this.Usa=this.n3=!1;this.q4c=this.gwd=this.ZNc=-1}}Object(m.a)(Ej,"ContentEditableViewTypingState",null,[]);class Hh{constructor(a,b,c,f,l,y,H){this.aj=a;this.fg=b;this.qd=c;this.ep=f;this.wf=l;this.Qb=y;this.nj=H}Vta(a){if(!this.Qb.Zh||1===
this.wf.mode&&!this.Cea())return null;const b=this.aj.U8(this.wf.mode,this.Qb.Pi);let c=b,f=0;const l=this.Qb.Zh.At;let y,H=!1;for(y=0;y<l.length;y++){var Q=l[y];if(!this.ep.Lng(Q)){H=!0;continue}const ia=this.ep.cJ(Q,this.fg,this.qd,this.nj),wa=Sys.UI.DomElement.containsCssClass(Q,xc.a.FN);Q=Sys.UI.DomElement.containsCssClass(Q,da.a.pW);if(c<=ia)return wa?c=a||c===ia?1:0:Q&&(c=0),this.Qg(this.Qb.Gg,f,c);c-=ia;wa?f++:Q||(f+=ia)}return H?this.Qg(this.Qb.Gg,0,b):this.Qg(this.Qb.Gg,0,0)}Qg(a,b,c){return Od.SelectionFactory.Qg(a,
b+c)}Cea(){return ge.a.instance.Pa.Cea}}Object(m.a)(Hh,"CurrentEditSelectionProvider",null,[1445]);class gh{constructor(a,b,c){this.WRb=[];this.rIc=null;this.qd=a;this.VS=b;this.YPd=c}get Ki(){return this.WRb}set Ki(a){this.WRb=a}Bwf(){return this.WRb.length?1<this.WRb.length||1<this.WRb[0].LF.innerText.length:!1}k1f(a,b,c){const f=L.a.ze(a,da.a.EGa),l=b?a.firstChild:a.lastChild;let y=null;b&&0<f?y=c.At[f-1]:!b&&f<c.At.length&&(y=c.At[f+1]);if(y)for(this.qd.Xb("MomentaryNonLinkFormatting",{["Reason"]:"MoveSafariStrayTextNode"}),
this.VS.u++,a.removeChild(l),b?y.appendChild(l):y.insertBefore(l,y.firstChild),a=0;a<this.Ki.length;a++);}vAi(a){for(let b=0;b<this.Ki.length;b++){const c=this.Ki[b].LF;z.a.dG&&0<c.getElementsByTagName("A").length&&(3===c.firstChild.nodeType?this.k1f(c,!0,a):3===c.lastChild.nodeType&&this.k1f(c,!1,a));Ea.a.Mz(c,c.innerText)}}oyk(a){for(let b=0;b<this.Ki.length;b++)this.YPd.m2b(this.Ki[b].LF,a)}B5k(){for(let a=0;a<this.Ki.length;++a){const b=this.Ki[a].LF;if(Sys.UI.DomElement.containsCssClass(b,xc.a.ZOc)||
Sys.UI.DomElement.containsCssClass(b,xc.a.XOc)||Sys.UI.DomElement.containsCssClass(b,xc.a.WOc)||Sys.UI.DomElement.containsCssClass(b,xc.a.YOc)){const c=this.Ki[a].z_a;c&&c!==b.innerText.length&&(b.className=xc.a.I3b)}}}$tk(a,b){for(let c=0;c<this.Ki.length;c++){const f=this.Ki[c],l=a<=f.AUa,y=f.AUa+f.z_a,H=y<=b;f.wkd=l?f.AUa:a;f.ONe=H?y:b;l&&H&&(f.x2b=!0)}}jKf(){Array.clear(this.Ki)}}Object(m.a)(gh,"CurrentlyActiveContentSpans",null,[1444]);class Ie{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,
Fc,yc,tc,xd){this.eDd=!1;this.rf=a;this.Uc=b;this.qd=c;this.wf=f;this.Ep=l;this.Pf=y;this.Jh=H;this.Qb=Q;this.ud=ia;this.$K=wa;this.Yk=Ua;this.GAa=kb;this.CSb=Gb;this.YWh=ec;this.lk=dc;this.jd=Fc;this.Ca=tc;this.hd=xd;this.P_h=yc.ka("ChromeSingleTextRunCopyImprovementIsEnabled");this.vVb=yc.ka("PasteKeepSourceFontSizeFixIsEnabled");this.k0h=(this.g5h=yc.ka("ProtectInClient"))||yc.ka("ProtectedFile");this.Z_h=yc.ka("EnableExtractForProtectedFile");this.cVb=yc?yc.ka("ImageDataURLSkippedForSafari12IsEnabled"):
!1;this.JVb=yc?yc.ka("TextLayoutServiceUseResponse"):!1;this.Erf=this.Drf=!1}get k_(){return this.GAa.instance}get Qcb(){return this.hd.ig&&this.hd.jz}Feg(a,b,c,f){this.wSk(a,b,c,f)}wSk(a,b,c,f){this.k0h&&!this.Z_h?a.preventDefault():!b||this.Yk.value.isEditingAllowed||this.Yk.value.sz&&this.Qcb?1!==this.wf.mode||this.eDd||!c||f||(this.k_?b&&!this.rf.J0c(this.Uc.Yj)?(ka.ULS.sendTraceTag(3994324,307,50,"Cut not allowed"),this.qd.Xb(Kd.a.zh,{["Reason"]:Qd.a.m2d}),this.CSb.show(),a.preventDefault()):
(this.Uc.Npa.u8d(),this.eDd=!0,b&&this.Ep.raiseEvent(vc.a.NQi),z.a.cva&&a.rawEvent&&a.rawEvent.currentTarget&&(w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings"),this.cVb&&this.lk.vpd(a.rawEvent.currentTarget,"data-src","data-srcurl")),this.ud.ik&&this.P_h&&this.i6i(a),this.vVb&&(this.Drf=this.e6i(a)),this.JVb&&(this.Erf=this.p6k(a)),a=this.YWh.create(null,Object(I.a)(this,this.YUi,"dispatchCutCopy"),b),a.$l("Browser "+(b?"Cut":"Copied")),a.run()):
(ka.ULS.sendTraceTag(3994323,307,50,"Clipboard command not available"),this.Ca.Kse(b?C.a.cut:C.a.copy),a.preventDefault())):a.preventDefault()}i6i(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:null;if(b&&b.setData){var c=null;c=this.H9d();({X3b:c}=this.lk.lKh(c));c&&(a.preventDefault(),b.setData("text/html",Hb.c(c)),b.setData("text/plain",c.innerText))}}e6i(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:null;if(b&&b.setData){const c=b.getData("text/html").toString();if(c&&0<c.length)return a=
this.lk.hKa(c),this.lk.v1b(a,this.Pf.Rd.Md,!0)?(b.setData("text/html",a.innerHTML),!0):!1}return this.lk.v1b(a.rawEvent.currentTarget,this.Pf.Rd.Md,!0)}p6k(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:null;if(b&&b.setData){const c=b.getData("text/html").toString();a=c&&0<c.length?this.lk.hKa(c):a.rawEvent.currentTarget;if(this.lk.lyd(a,!1))return b.setData("text/html",Hb.c(a)),b.setData("text/plain",a.innerText),!0}return!1}H9d(){if(this.ud.lS){const a=this.jd.Wta();if(a&&a.Jl)return a.Jl.getSelection()}return null}YUi(a,
b){this.eDd=!1;if(this.Pf.Rd.Go&&1!==w.AFrameworkApplication.Aa.state){if(b){if(this.ud.gg){for(b=0;b<this.Jh.Ki.length;b++){const c=this.Jh.Ki[b].LF,f=c.getElementsByTagName("BR");for(let l=0;l<f.length;l++)c.removeChild(f[l])}this.$K.xLa(this.wf.mode,this.Qb.Pi,this.Qb.Gg,this.Qb.Zh,this.Yk.value.isEditingAllowed||this.Yk.value.sz)}this.k_.Gqi(a)}else this.k_.Eqi(a);z.a.cva&&this.cVb&&this.Pf&&this.lk.vpd(this.Pf.Rd.Cg.ao,"data-srcurl","data-src");this.vVb&&this.Drf&&this.Pf&&this.Pf.Rd&&this.lk.v1b(this.Pf.Rd.Cg.ao,
this.Pf.Rd.Md,!1);this.JVb&&this.Erf&&this.Pf&&this.Pf.Rd&&this.lk.lyd(this.Pf.Rd.Cg.ao,!0)}}}Object(m.a)(Ie,"CutCopyHandler",null,[1443]);class eg{constructor(a,b,c,f,l,y,H,Q){this.ud=a;this.Bh=b;this.ks=c;this.qd=f;this.wf=l;this.kia=y;this.$s=H;this.Irb=Q}J4b(a,b){this.ud.gg&&2===this.Bh.mode&&b&&this.ks.isComposing&&(a=this.qd.Zp(C.a.typing),a.properties.$(lf.a.source,"DomChange"),this.vWi(),a.end())}vWi(){this.Irb||this.wf.Zaa(!0);this.kia.UHb();this.$s.dZ()}}Object(m.a)(eg,"DomChangeEventProcessor",
null,[]);class yi{constructor(a,b,c,f){this.aj=a;this.Bh=b;this.Qb=c;this.Pf=f}gib(a,b){if(!b)return!1;this.aj.gSf(this.Bh,this.Qb);return this.Pf.Rd?this.Pf.Rd.gib(a):!1}}Object(m.a)(yi,"DoubleClickProcessor",null,[]);class Fj{constructor(a,b,c){this.ud=a;this.mpb=b;this.aEd=c}ZDa(){this.mpb.f9a=!0;return!1}P4b(){return this.mpb.f9a=!1}$Da(a){this.mpb.f9a=!1;this.aEd.cancelEventAndRestoreEditingSurface(a.mc);return!0}}Object(m.a)(Fj,"DragEventsProcessor",null,[]);class Yh{constructor(a){this.fff=
0;this.$Cd=!1;this.ud=a}get f9a(){return this.$Cd}set f9a(a){this.$Cd=a;window.clearTimeout(this.fff);this.$Cd&&(this.fff=window.setTimeout(Object(I.a)(this,this.jAk,"onAfterDragInactivity"),1E3))}jAk(){this.f9a=!1}}Object(m.a)(Yh,"DragStateManager",null,[]);class ei extends xb{constructor(){super();this.B5g=this.Tzk=0}}Object(m.a)(ei,"SetModeEditEventArgs",xb,[]);class Hi extends xb{constructor(){super();this.updates=null;this.aAa=new Na.a}}Object(m.a)(Hi,"BeforeValidateEditEventArgs",xb,[]);class yh{constructor(){this.Sgl=
this.wWi=null}}Object(m.a)(yh,"EditStateFactoryManager",null,[]);class La extends xb{constructor(){super();this.charCode=0;this.TZj=this.isComposing=!1}}Object(m.a)(La,"KeyDownEditEventArgs",xb,[]);class sb extends xb{constructor(){super();this.charCode=0;this.isComposing=!1}}Object(m.a)(sb,"KeyPressEditEventArgs",xb,[]);class Ob extends xb{constructor(){super();this.EHj=!1}}Object(m.a)(Ob,"PaddingChangedEventArgs",xb,[]);class pc{constructor(a){this.Ma=new Pc.a;this.n4a=Object.assign(new yh,{wWi:()=>
a.Bm(),Sgl:()=>Bd.a.MEa(a.contentWindow)})}addHandler(a,b){this.Ma.addHandler(a,b)}removeHandler(a,b){this.Ma.removeHandler(a,b)}raiseEvent(a){this.Ma.raiseEvent(a,Object.assign(new xb,{G9a:this.n4a}))}jZk(a,b){0===a&&0===b||this.Ma.raiseEvent(vc.a.lml,Object.assign(new ei,{Tzk:a,B5g:b,G9a:this.n4a}))}tXk(a){this.Ma.raiseEvent(vc.a.fpi,Object.assign(new Hi,{G9a:this.n4a,updates:a.updates,aAa:a.aAa}))}nkh(a){a.G9a=this.n4a;this.Ma.raiseEvent(vc.a.Xdh,a)}rTe(a,b){this.Ma.raiseEvent(vc.a.uy,Object.assign(new sb,
{charCode:a.mc.charCode,isComposing:b,G9a:this.n4a}))}lYk(a,b,c){this.Ma.raiseEvent(vc.a.Bf,Object.assign(new La,{charCode:a.mc.charCode,isComposing:b,TZj:c,G9a:this.n4a}))}mkh(a){this.Ma.raiseEvent(vc.a.ZKk,Object.assign(new Ob,{G9a:this.n4a,EHj:a}))}}Object(m.a)(pc,"EditStateEventManager",null,[1442]);class Kc{constructor(a){this.YHd=this.fCc=!1;this.$lf=null;this.zdf=0;this.uZc=!1;this.Ma=a;this.pff=0;this.cJd=2}get mode(){return this.pff}glb(a,b){0===a?(0===b&&(b=1),this.$lf=(new Date).toISOString(),
this.cJd=b):this.cJd=0;this.pff=a}get p4c(){return this.cJd}get E7j(){return this.$lf}get isActive(){return 0!==this.mode}get qHi(){return this.zdf}NLa(a){this.YHd=a}I7b(a){return this.isActive&&!!a&&this.fCc}Zaa(a){!this.fCc&&a&&this.Ma.raiseEvent(Oa.nHi);this.fCc=a;this.$yk(a);a&&(this.zdf=(new Date).getTime())}r8f(a){return this.isActive&&!!a&&this.YHd}$yk(a){a&&Xh.GrippersManager.instance.setVisibility(!1)}Nal(){this.YHd=this.fCc=!1}}Object(m.a)(Kc,"EditViewStateManager",null,[1441]);var Gd=d(930);
class he{constructor(a,b,c,f,l,y){this.jd=a;this.VD=b;this.Ep=c;this.$K=f;this.Oa=l;this.Pf=y;this.Oa&&(this.Oa.ka("WordEditorImageOverflowIsEnabled")||this.Oa.ka("WordEditorImageUseRelativeHeightAsZIndexDirectlyIsEnabled"))&&(he.QQc=-1*Math.pow(2,31))}EMc(){this.VD.yKf();Ea.a.vv(this.jd.Bm())}v5d(a){const b=this.jd.Bm();if(2===a){var c=gc.DXi;a=he.CXi;b.style.overflow="visible"}else if(1===a)c=z.a.Ukb?0:he.QQc,a="0",b.style.overflow="hidden";else return;const f=this.jd.Cg.Gu;f.style.position="absolute";
this.Oa&&(this.Oa.ka("WordEditorImageOverflowIsEnabled")||this.Oa.ka("WordEditorImageUseRelativeHeightAsZIndexDirectlyIsEnabled"))&&0<c?(c=document.createElement("div"),f.style.zIndex=String(c.style.zIndex)):f.style.zIndex=String(c);f.style.display="block";f.style.visibility="visible";f.style.maxHeight="none";f.style.maxWidth="";b.style.visibility="visible";f.style.opacity=a}xXf(a){if(this.jd&&this.jd.Cg&&this.jd.Cg.Gu){var b=this.jd.Cg.Gu;b.style.zIndex=String(z.a.Ukb?0:he.QQc);z.a.Ukb&&!a&&(b.style.visibility=
"hidden",this.jd.Bm().style.visibility="hidden")}}CSk(a){this.Ep.raiseEvent(vc.a.NRj);this.EMc();this.jd.q1a(!0);this.jd.Bm().style.direction="";this.v5d(a);this.jd.Cg.mwk()}ySk(a){this.jd.q1a(!0);this.v5d(a);z.a.Ukb&&this.Hhg();z.a.aG&&Sys.UI.DomElement.addCssClass(this.jd.Bm(),"NonStandardIEClipboard")}BSk(a){this.v5d(a);z.a.aG&&Sys.UI.DomElement.removeCssClass(this.jd.Bm(),"NonStandardIEClipboard")}ASk(a,b,c,f,l,y,H){this.Ep.raiseEvent(vc.a.endEditing);const Q=this.jd.Bm();Q&&(Ea.a.vv(Q),z.a.iX&&
b&&a&&(this.jd.q1a(!0),Q.innerText=" ",this.$K.xLa(c,f,l,y,H)),a||Bd.a.GKf(Q),this.jd.q1a(!1),this.xXf(b))}zSk(a){this.jd.q1a(!1);z.a.aG&&Sys.UI.DomElement.removeCssClass(this.jd.Bm(),"NonStandardIEClipboard");this.xXf(a);this.Ep.raiseEvent(vc.a.PBi)}DSk(){const a=Sys.UI.DomElement.getBounds(this.Pf.Rd.mK),b=this.jd.Cg.Gu;Sys.UI.DomElement.getBounds(b).y<a.y&&(b.style.top=Math.max(this.Pf.Rd.scrollTop,Gd.a)+"px");b.style.opacity="0";b.style.zIndex=String(he.QQc);z.a.Wj&&(b.style.visibility="Hidden",
this.jd.Bm().style.visibility="Hidden")}Hhg(){const a=1E3-this.Pf.Rd.container.getBoundingClientRect().left+this.Pf.Rd.scrollLeft+1,b=this.jd.Cg.Gu;b.style.left="-11000px";b.style.paddingRight=a+"px";b.style.width=1E4+a+"px"}}he.QQc=-1E3;he.CXi="1";Object(m.a)(he,"EditingDomDisplayManipulator",null,[]);class Ue{constructor(a){this.r5h=a}get range(){return this.r5h}select(){this.range.select()}execCommand(a,b,c){return this.range.execCommand(a,b,c)}queryCommandEnabled(a){return this.range.queryCommandEnabled(a)}queryCommandIndeterm(a){return this.range.queryCommandIndeterm(a)}queryCommandState(a){return this.range.queryCommandState(a)}queryCommandSupported(a){return this.range.queryCommandSupported(a)}queryCommandValue(a){return this.range.queryCommandValue(a)}scrollIntoView(a){this.range.scrollIntoView(a)}}
Object(m.a)(Ue,"RangeProxy",null,[1543]);class Rf{constructor(a){this.dGc=a}get selection(){return this.dGc}get type(){return this.selection.type}createRange(){return new Ue(this.selection.createRange())}clear(){this.selection.clear()}empty(){this.selection.empty()}}Object(m.a)(Rf,"SelectionProxy",null,[1533]);class sf{constructor(a){this.rXh=a}get Jl(){return this.rXh}get body(){return this.Jl.body}get activeElement(){return this.Jl.activeElement}get documentElement(){return this.Jl.documentElement}get document(){return this.Jl.cookie}get selection(){return new Rf(this.Jl.selection)}get designMode(){return this.Jl.designMode}get doctype(){return this.Jl.doctype}get domain(){return this.Jl.domain}get hidden(){return this.Jl.hidden}get implementation(){return this.Jl.implementation}get parentWindow(){return this.Jl.parentWindow}get referrer(){return this.Jl.referrer}get title(){return this.Jl.title}get URL(){return this.Jl.URL}get visibilityState(){return this.Jl.visibilityState}createAttribute(a){return this.Jl.createAttribute(a)}open(){this.Jl.open()}close(){this.Jl.close()}attachEvent(a,
b){return this.Jl.attachEvent(a,b)}detachEvent(a,b){this.Jl.detachEvent(a,b)}createAttributeNS(a,b){return this.Jl.createAttributeNS(a,b)}createDocumentFragment(){return this.Jl.createDocumentFragment()}createElement(a){return this.Jl.createElement(a)}createElementNS(a,b){return this.Jl.createElementNS(a,b)}createEvent(a){return this.Jl.createEvent(a)}createTextNode(a){return this.Jl.createTextNode(a)}dispatchEvent(a){return this.Jl.dispatchEvent(a)}execCommand(a,b,c){return this.Jl.execCommand(a,
b,c)}hasFocus(){return this.Jl.hasFocus()}focus(){this.Jl.focus()}getElementById(a){return this.Jl.getElementById(a)}getElementsByTagName(a){return this.Jl.getElementsByTagName(a)}getElementsByTagNameNS(a,b){return this.Jl.getElementsByTagNameNS(a,b)}getElementsByName(a){return this.Jl.getElementsByName(a)}write(a){this.Jl.write(a)}querySelector(a){return this.Jl.querySelector(a)}querySelectorAll(a){return this.Jl.querySelectorAll(a)}queryCommandEnabled(a){return this.Jl.queryCommandEnabled(a)}queryCommandIndeterm(a){return this.Jl.queryCommandIndeterm(a)}queryCommandState(a){return this.Jl.queryCommandState(a)}queryCommandSupported(a){return this.Jl.queryCommandSupported(a)}queryCommandValue(a){return this.Jl.queryCommandValue(a)}}
Object(m.a)(sf,"DOMDocumentProxy",null,[1578]);class ag{constructor(){this.p4a=null}get isValid(){return this.Cg.isValid}get contentWindow(){return this.Cg?this.Cg.contentWindow:null}get Cg(){return this.p4a}NCk(a){Hf.a.I2g(a,this.Cg.Gu)}MCk(){Hf.a.C8e(this.Cg.Gu)}DXf(){this.Cg.zZi()}Inj(a){if(!z.a.gg)return a.innerHTML;this.Cg.GJl(a);return a.innerHTML}xLl(){this.Cg?(this.MCk(),this.p4a=null):ka.ULS.sendTraceTag(18437346,323,15,"UnbindFromEditingDom: View not currently bound to Dom.")}Dpi(a,b){this.p4a=
a;this.NCk(b)}Bm(){return this.Cg?this.Cg.ao:null}q1a(a){this.Cg&&this.Cg.bsd(a)}Wta(){return this.Cg?new sf(this.Cg.contentDocument):null}}Object(m.a)(ag,"EditingDomManager",null,[1440]);var xg=d(147);class Tg{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd){this.Lia=0;this.Ye=null;this.Qb=a;this.Lk=b;this.J2=c;this.Ep=f;this.Cqa=l;this.Zd=y;this.jd=H;this.wf=Q;this.JK=ia;this.Yk=wa;this.ud=Ua;this.VD=kb;this.Uc=Gb;this.MK=ec;this.Jh=dc;this.Pf=Fc;this.rf=yc;this.hd=xd;this.jia=tc;this.jia.Aii(Object(I.a)(this,
this.Rbh,"onSynchronizeMode"))}dispose(){this.jia.i9k(Object(I.a)(this,this.Rbh,"onSynchronizeMode"))}F0b(a){(this.Ye=a)||ka.ULS.sendTraceTag(22122889,323,50,"Bind ContentEditableView resolve failed as null.")}get mode(){return this.wf.mode}endClipboard(){if(1===this.mode){var a=this.Lk.je(2);a.ld(this.Ye.root);this.Ye.detach();this.Qb.Gg&&!this.pme&&this.Qb.Gg.t9(this.Pf.Rd.Na,4,!0);this.wf.glb(0,3);this.Qb.Gg=null;this.Qb.Zh=null;this.Qb.HW=null;this.J2.zSk(this.Ye.mKa);a.dispose()}}Yaa(a,b,c){this.Ye.DVa&&
this.Qb.Zh?this.Ye.Zs(!1):this.Ye.DVa&&!this.Qb.Zh&&ka.ULS.shipAssertTag(17884511,315,!1,"Content is dirty when CurrentEditingViewElement is still NULL");this.Ep.jZk(this.mode,a);let f=!0;switch(a){case 2:this.endClipboard();this.wf.glb(a,c);f=this.startEditing(this.GQi);break;case 1:if(this.mode!==a||this.Uc.Pa.Zr!==this.Lia)this.endEditing(!0),this.wf.glb(a,c),f=this.CAl(),this.Lia=this.Uc.Pa.Zr;break;case 0:this.mode!==a&&(2===this.mode&&Xh.GrippersManager.instance.setVisibility(!1),this.endEditing(b),
this.endClipboard(),this.wf.glb(a,c))}f||this.wf.glb(0,7)}pkl(){this.wf.glb(2,0)}get GQi(){return this.Uc.Pa.mb.Va.node}startEditing(a){if(1===this.Cwf)return!1;this.jd.DXf();this.Ye.mza?this.Ye.Zs(!0):(this.Ye.nLj.FXf(!1),this.wf.I7b(this.Qb.Gg)&&this.Ye.Zs(!1));this.Ye.mza=!1;if(this.Qb.Gg===a)return a=ob.GraphIterator.pb(a.node),this.C5d(a),this.Qb.cIj&&(this.ud.Vi&&this.Ye.lvb.uea||this.JK.setFocus(this.mode,this.Qb.Pi,this.Qb.Gg,this.Qb.Zh,this.Yk.value.isEditingAllowed||this.Yk.value.sz)),!0;
const b=this.Lk.je(2,C.a.startEditing);b.ld(a.node);this.Ye.detach();this.Qb.Gg&&this.Qb.Gg.t9(this.Pf.Rd.Na,4,!0);this.Qb.Gg=a;this.Qb.Gg.t9(this.Pf.Rd.Na,4,!0);if(this.hd.ig){const c=cg.j(this.Qb.Gg,5);for(let f=0;f<c.length;f++)c[f].wUf(this.Ye)}this.Ye.gxb=!0;this.J2.CSk(this.mode);this.Ye.ly(a.node);this.VD.mlb(!1,this.Qb.Pi,this.Jh);this.wf.Zaa(!1);this.wf.NLa(!1);a=ob.GraphIterator.pb(this.Qb.Gg.node);this.C5d(a);b.dispose();return!0}endEditing(a){if(2===this.mode&&(this.Ye.uRc(),this.Ye.Zs(!0),
!this.pme)){var b=this.Lk.je(2);b.ld(this.Ye.root);this.Ye.detach();this.Qb.Gg&&this.Pf.Rd&&this.Qb.Gg.t9(this.Pf.Rd.Na,20,!0);this.wf.glb(0,4);this.Qb.Gg=null;this.Qb.Zh=null;this.Qb.HW=null;this.J2.ASk(a,this.Ye.mKa,this.mode,this.Qb.Pi,this.Qb.Gg,this.Qb.Zh,this.Yk.value.isEditingAllowed||this.Yk.value.sz);b.dispose()}}CAl(){if(this.pme||N.a.instance.ga(11)&&1===this.Cwf)return!1;this.Ep.raiseEvent(vc.a.OBi);this.jd.DXf();const a=this.Lk.je(2);a.ld(this.Uc.Kmb);this.wf.I7b(this.Qb.Gg)&&this.Ye.Zs(!1);
this.Ye.detach();this.Qb.Gg=null;this.Qb.Zh=null;this.Qb.HW=null;if(this.Uc.Pa.Cea){const b=this.Uc.Pa.mb.Va.node;this.Ye.ly(b);const c=ob.GraphIterator.pb(b);this.Qb.Gg=b;this.Qb.rda=this.FUj(b);this.C5d(c);this.Qb.Gg.t9(this.Pf.Rd.Na,4,!0)}else this.Ye.ly(this.Uc.Kmb);this.J2.ySk(this.mode);this.VD.mlb(!1,this.Qb.Pi,this.Jh);a.dispose();return!0}Rbh(){this.o2a()}o2a(){if(!this.Cqa.K9&&!w.AFrameworkApplication.Ae.Dw&&this.Pf.Rd&&this.Pf.Rd.isActive){var a=this.Uc.Pa.mb;a&&this.JK.Ine()?this.MK&&
this.MK.ubb()?this.Yaa(2,!0,10):this.rf.Dx(a)?Rc.App.Lb.Kd.isEditingAllowed||Rc.App.Lb.Kd.sz?this.Yaa(2,!0,0):this.Ye.Ltd?(this.Yaa(1,!0,0),this.Yaa(0,!0,15)):this.Yaa(2,!0,0):this.Yaa(1,!0,0):this.Yaa(0,!1,a?9:8)}}get pme(){return w.AFrameworkApplication.Yg}get Cwf(){return w.AFrameworkApplication.Aa.state}C5d(a){a.kf();xg.OutlineNavigator.kXe(a)}FUj(a){return Wd.OutlineElementReader.Gm(Za.OutlineElementNavigator.vB(a))}}Object(m.a)(Tg,"EditingModeTransitionManager",null,[1439]);class li{constructor(a,
b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye){this.Ye=null;this.Zd=a;this.wf=b;this.Qb=c;this.o1h=f;this.Xk=l;this.n1h=y;this.l1h=H;this.GCd=Q;this.d9h=ia;this.lpb=wa;this.FPa=Ua;this.Tdf=kb;this.qXh=Gb;this.JK=ec;this.Kha=dc;this.vZb=Fc;this.vXh=yc;this.A3h=tc;this.dUh=xd;this.$1h=Vd;this.Jia=Ld;this.aj=ye}iT(a){this.Ye=a}get ZY(){return!this.Zd.Dw&&this.wf.isActive&&this.Qb.wWa(this.wf.mode)?!0:!1}uPk(a){a.AGa=b=>this.o1h.AGa(b,this.ZY);a.Ycb=b=>this.n1h.Ycb(b,this.ZY);a.kA=b=>this.l1h.kA(b,
this.ZY,this.Ye.f4b);a.A2b=b=>this.GCd.A2b(b,this.ZY,this.Ye.f4b);a.j_d=b=>this.GCd.h_d(b,this.ZY,this.Ye.f4b);a.z2b=b=>this.GCd.z2b(b,this.ZY,this.Ye.f4b);a.Emb=b=>this.d9h.Emb(b,this.ZY&&this.Ye.Ltd);a.$Da=Object(I.a)(this.lpb,this.lpb.$Da,"dropHandler");a.ZDa=Object(I.a)(this.lpb,this.lpb.ZDa,"dragOverHandler");a.P4b=Object(I.a)(this.lpb,this.lpb.P4b,"dragLeaveHandler");a.Ync=b=>{this.FPa.handlePaste(b,this.Ye.root,this.wf.uZc)};a.l2d=b=>{this.Tdf.Feg(b,!0,this.ZY,this.wf.uZc)};a.U2b=b=>{this.Tdf.Feg(b,
!1,this.ZY,this.wf.uZc)};a.J4b=b=>{this.qXh.J4b(b,this.ZY)};a.GEf=()=>{this.JK.$pi()};a.JC=b=>this.Kha.HQi(b,this.Xk.uea,this.ZY);a.MC=b=>this.vZb.onContextMenu(b,this.Ye.Gg);a.U6e=Object(I.a)(this.vZb,this.vZb.nnc,"onTouchMove");a.T6e=Object(I.a)(this.vZb,this.vZb.lJb,"onTouchEnd");a.UTd=()=>{this.JK.FZi(this.wf.mode)};a.D9a=b=>this.vXh.gib(b,this.ZY);a.Y0a=b=>{this.A3h.onScroll(b,this.ZY,this.Ye.ownerDocument.documentElement)};a.G1=()=>{this.dUh.HAk(this.ZY)};a.$wg=b=>{this.$1h.lostFocus(b,this.ZY)};
a.fNb=()=>this.Jia.lFj(this.ZY,this.Ye.Gg);a.Ghb=b=>this.aj.mouseDown(b);a.WIe=b=>this.aj.YJ(b)}}Object(m.a)(li,"EditingSurfaceEventHandlerManager",null,[]);class Li{constructor(a,b,c){this.qd=a;this.fg=b;this.Bh=c}cancelEventAndRestoreEditingSurface(a){this.qd.Xb("DisallowedDragAndDrop",{["Reason"]:"CancelEventAndRestoreEditingSurface"});this.fg.bx++;hd.a.Kn(a);this.Bh.Yaa(0,!0,6);this.Bh.o2a()}}Object(m.a)(Li,"EditingSurfaceEventHandlerUtils",null,[]);class Le{constructor(){this.XBa=0}get K9(){return 0<
this.XBa}suspend(){this.XBa++}resume(){0<this.XBa&&this.XBa--}}Object(m.a)(Le,"EditingSurfaceStateManager",null,[]);class Ih{constructor(a=30){this.Ufd=this.llc=-1;this.Rmb=Array(a);this.lgd=Array(a-1)}oJh(){this.c1k();this.gPl()}zrd(){const a=this.hil();ka.ULS.sendTraceTag(18437392,324,50,"Duration Values: "+a)}c1k(){var a=(new Date).getTime();if(this.llc<this.Rmb.length-1)this.llc++;else for(let b=0;b<this.Rmb.length-1;b++)this.Rmb[b]=this.Rmb[b+1];this.Rmb[this.llc]=a}gPl(){const a=this.llc+1;
for(let b=2;b<=a;b++)this.aLl(b,this.agj(b))}agj(a){const b=this.llc;return this.Rmb[b]-this.Rmb[b-(a-1)]}aLl(a,b){a-=2;this.Ufd<a?(this.Ufd++,this.lgd[this.Ufd]=b):b<this.lgd[a]&&(this.lgd[a]=b)}hil(){const a=this.r4i();return Sys.Serialization.JavaScriptSerializer.serialize(a)}r4i(){const a=Array(this.Ufd+1);for(let b=0;b<a.length;b++)a[b]=Math.round(this.lgd[b]/(b+1));return a}}Object(m.a)(Ih,"EventFrequencyTracker",null,[]);var bj=d(1116),zh=d(1118);class jj{constructor(a){this.Pt=null;this.gp=
0;this.CK=a;this.Kj=new Date;this.Cyc=w.AFrameworkApplication.Aa.mode}end(a){this.gp=a;this.Pt=new Date}get startTime(){return this.Kj}get endTime(){return this.Pt}get actionId(){return this.CK}get behavior(){return 2}get LKc(){return this.Cyc}get kK(){return null}get zd(){return null}get telemetryData(){return null}get response(){return this.gp}get XT(){return 1}get eq(){return 30}get Dsa(){return null}get Wi(){return!0}}Object(m.a)(jj,"TypingActionOperation",null,[1433,337,338]);class Sh{constructor(a,
b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc){this.Ye=this.KBc=this.Npb=null;this.S3h=a;this.Bh=b;this.Ep=c;this.oia=f;this.J2=l;this.Lk=y;this.Qb=H;this.Pf=Q;this.Zd=ia;this.Yk=wa;this.wf=Ua;this.aj=kb;this.Jh=Gb;this.$s=ec;this.kia=dc;this.wS=Fc;this.Uc=yc;this.ZD=tc}iT(a){this.Ye=a}get bjg(){return!!this.Npb}startHybridTransition(){if(this.Yk.value.isEditingAllowed||this.Yk.value.sz){this.Bh.pkl();this.Ep.raiseEvent(vc.a.WKk);this.oll(C.a.overtype);this.oia.value.Aw();this.J2.BSk(this.Bh.mode);
var a=this.Lk.je(2);a.ld(this.Ye.root);this.Qb.Gg&&!w.AFrameworkApplication.Yg&&this.Qb.Gg.t9(this.Pf.Rd.Na,4,!0);a.dispose();this.wS.wrc();this.wf.NLa(!0);this.aj.updateCaretPosition(this.Bh.mode,this.Qb.Pi);this.S3h.o6i(this.Qb.Zh,this.Qb.Gg,this.Qb.HW);this.Jh.$tk(this.Uc.Pa.mb.Va.Sa,this.Uc.Pa.mb.Va.Mb);this.$s.dZ();this.kia.UHb();this.oci();this.Ep.raiseEvent(vc.a.UKk)}else this.Bh.Yaa(0,!0,12)}SYi(){this.wS.wrc();this.Npb.end(32);bj.a.getInstance().Cqc(this.Npb);zh.a.getInstance().Bqc(this.Npb);
this.Npb=null}oci(){this.KBc||(this.KBc=new dd.a(2,1,20,Object(I.a)(this,this.hybridCleanup,"hybridCleanup"),24),this.Zd.Hb(this.KBc))}oll(a){this.Npb=new jj(a)}hybridCleanup(){this.KBc=null;this.Qb.wWa(this.Bh.mode)&&this.Ye.Zs(!0)}C1e(){if(!this.Uc.Pa.Cea)return!1;const a=this.Uc.Pa.mb.Va,b=wb.HyperlinkReader.WC(a,!1);for(const c of b)if(c.Sa===a.Sa&&c.Mb<=a.Mb)return!1;return this.ZD.J2j(a)?!1:!cg.d(a.node,a.Sa)&&!cg.d(a.node,a.Mb-1)&&!a.node.YGi}}Object(m.a)(Sh,"HybridTransitionManager",null,
[1429]);class ya{constructor(a,b,c,f,l){this.vGd=this.mza=!1;this.ks=a;this.Bh=b;this.jd=c;this.Jh=f;this.Pf=l}get wLj(){return this.vGd}uRc(){this.FXf(!0)}FXf(a){this.ks.isComposing&&2===this.Bh.mode&&(ka.ULS.sendTraceTag(18437401,323,50,"EnsureImeDetermined"),this.vGd=!0,this.jd.Cg.Qoa(),this.Jh.oyk(this.jd.contentWindow),this.vGd=!1,this.ks.isComposing=!1,a&&this.Pf.Rd.Go&&(this.Pf.Rd.Mub()&&ka.ULS.sendTraceTag(38602073,323,50,"Selection is reset to view top by EnsureImeDetermined."),this.Bh.o2a()))}}
Object(m.a)(ya,"ImeManager",null,[]);class Ra{constructor(a,b,c,f,l,y,H,Q){this.Dh=null;this.ud=a;this.jd=b;this.Bh=c;this.Lk=f;this.qd=l;this.fg=y;this.kn=Q}F0b(a){this.Dh=a}get uLj(){if(this.ud.gg){const a=Bd.a.MEa(this.jd.contentWindow);if(a&&this.kn.nXc(a)===this.jd.Bm())return!0}return!1}correctBadImeState(){if(!this.uLj)return!1;this.qd.Xb("PossibleIncorrectImeBehavior",{["Reason"]:"CorrectBadImeState"});this.fg.bz++;const a=this.Lk.je(3);a.ld(this.Dh.root);this.Bh.Yaa(0,!0,11);this.Bh.o2a();
a.dispose();return!0}}Object(m.a)(Ra,"ImeRecoveryUtils",null,[]);class hb{constructor(a,b,c,f,l,y,H,Q,ia){this.Jh=a;this.fg=b;this.qd=c;this.nj=f;this.SK=l;this.ep=y;this.Pf=H;this.Qb=ia}UHb(){for(let a=0;a<this.Jh.Ki.length;a++)this.ep.cJ(this.Jh.Ki[a].LF,this.fg,this.qd,this.nj)?Sys.UI.DomElement.removeCssClass(this.Jh.Ki[a].Fle,"EmptyTextRun"):Sys.UI.DomElement.addCssClass(this.Jh.Ki[a].Fle,"EmptyTextRun"),Ea.a.T2b(this.Jh.Ki[a].LF,this.Jh.Ki[a].Fle)}}Object(m.a)(hb,"InteractiveViewSynchronizer",
null,[]);var Eb=d(15),Yb=d(205),Nb=d(243);class ed{constructor(){}}Object(m.a)(ed,"OnBackspaceDeleteEventArgs",null,[]);class zd{constructor(a){this.o7d=a}}Object(m.a)(zd,"OnDisMissFloatieEventArgs",null,[]);var Hd=d(557),ba=d(102);class Aa{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye,Xd,Xf,ug,qg,Fg,qf,bg,Kg,rg,ui,Ik,vg,Lg,rh,Bm,xj,Cm,go,Tl,ho,Ul,Kl,lm,zn){this.Kia=null;this.Tjf=this.kbf=!1;this.RVb=new Eb.ScriptSharpLegacyMap;this.dCa=a;this.nj=b;this.Zd=c;this.jd=f;this.qd=
l;this.fg=y;this.Kra=H;this.Jia=Q;this.Kha=ia;this.Qb=wa;this.aj=Ua;this.ud=kb;this.kn=Gb;this.EZ=ec;this.rf=dc;this.wS=Fc;this.mI=yc;this.Tqa=tc;this.Uc=xd;this.wf=Vd;this.ks=Ld;this.oia=ye;this.AC=Xd;this.mh=Xf;this.Yk=ug;this.$K=qg;this.Lob=Fg;this.Xk=qf;this.NOa=bg;this.WV=Kg;this.IUh=rg;this.Irb=ui;this.Lk=Ik;this.Ca=vg;this.hd=Lg;this.hp=rh;this.cE=Bm;this.$Tb=xj;this.YP=Cm;this.o6a=go;this.tca=Tl;this.Ep=ho;this.HUh=Ul;this.zAa=!!Kl;this.kv=Kl;this.Oa=lm;this.In=zn}get Jwc(){return this.dCa.instance?
this.dCa.instance.HKh():null}get N2d(){return this.$Tb||(this.$Tb=Ib.a.instance.qb("Common.IEventTimingMeter"))}get f1a(){return this.Kia||(this.Kia=Ib.a.instance.qb("Box4.ISelectionCommands"))}a7j(a,b){let c=this.efe(a);c||(c=this.fCj(a,b));return c}fCj(a,b){const c=a.mc,f=c.keyCode,l=a.eventName===oa.a.gRa;if(this.zAa&&l&&this.kv.instance&&this.kv.instance.ZAk(f===B.a.iI))return hd.a.Kn(c),!0;if(f===B.a.n3a&&c.shiftKey&&c.ctrlKey)return l&&(w.AFrameworkApplication.Ra.processAction(C.a.GQf,2),ka.ULS.sendTraceTag(41738320,
323,50,"CtrlShiftV triggered.")),!1;if(l&&c.ctrlKey){if(f===B.a.Yyd||f===B.a.azd)return this.Mse(C.a.FQf),!1;if(f===B.a.Zyd||f===B.a.uxc)return this.Mse(C.a.EQf),!1;if(f===B.a.waf)return this.Mse(C.a.mQi),!1}this.nj&&(this.Zd.fSf(Aa.sEl),this.jd.Cg.ixd());if(1===this.wf.mode)return this.vEk(a,b);if(this.nj&&this.Xk.uea)return this.qd.Xb("DisallowedKeyDownDuringDictation",{["Reason"]:"KeyDownHandler"}),this.fg.bw++,hd.a.Kn(c),this.Kra.qrc(C.a.typing),!0;this.Jia.fixupAfterMagnifierDrag();this.jd.Bm().scrollTop=
0;this.Kha.O9=!this.Qb.rda&&f===B.a.BP||this.Qb.rda&&f===B.a.qS||f===B.a.jx;this.aj.updateCaretPosition(this.wf.mode,this.Qb.Pi);this.ud.Wj&&(c.ctrlKey||c.altKey)&&f!==B.a.Xyd&&f!==B.a.kNa&&f!==B.a.Bnb&&f!==B.a.Xzd&&this.NOa.uRc();return this.eCj(a)}eCj(a){var b=a.mc.keyCode;const c=b===B.a.$pa,f=b===B.a.iI;let l=!1,y=!1,H=!1;switch(b){case B.a.jx:case B.a.pF:H=!0;w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordBrowserHandledNavigationSettings");b=this.Oa.ka("BrowserHandledNavigationIsEnabled");
a.mc.altKey||a.mc.ctrlKey||a.mc.shiftKey||this.ud.Ik||!b&&this.ud.ik||(y=!0);break;case B.a.qS:case B.a.BP:H=!0;this.ud.Ik&&this.kn.g9f(a.mc.rawEvent)&&!a.mc.altKey&&!a.mc.shiftKey?y=!0:this.ud.Wj&&this.f1a?a.mc.altKey||a.mc.ctrlKey||a.mc.shiftKey||(y=!0):l=!0;this.Oa&&this.Oa.ka("EditSurfaceKeyboardNavImprovementsIsEnabled")&&this.wf.NLa(!0);break;case B.a.n2:case B.a.m2:H=!0;this.ud.Wj&&this.f1a?y=this.JAj(a):l=!0;this.Oa&&this.Oa.ka("EditSurfaceKeyboardNavImprovementsIsEnabled")&&(this.rf.R2c(this.o6a.mb)||
this.rf.pLa(),this.wf.NLa(!0));break;case B.a.$pa:case B.a.iI:if(!this.Yk.value.isEditingAllowed&&this.Yk.value.sz)l=!0;else if(this.yAj(a,c,f))return!0;break;case B.a.HPh:this.qd.Xb("InsertKeyPressed");l=!0;break;default:if(a.mc.keyCode===B.a.Xzd||a.mc.keyCode===B.a.bzd||this.ud.dUd)this.ks.isComposing=!0,this.Irb||this.wf.Zaa(!0)}(this.Xk.n3&&!f||this.Xk.Usa&&!c)&&this.mI.Zs(!0);2!==this.wf.mode&&(H=y=!1);a.eventName===oa.a.gRa&&this.Ep.lYk(a,this.ks.isComposing,H);y&&(this.oia.value.Aw(),this.AC.FQa(a));
l&&hd.a.Kn(a.mc);return y}efe(a){return w.AFrameworkApplication.fa.ka("PPTOTextPredictionIsEnabled")?Hd.a.efe(a,this.o6a.k6b):!1}zAj(a){const b=this.o6a.k6b;var c=b.node;const f=b.Sa,l=Db.ParagraphReader.text(c);let y=!1;if(a){if(f<Db.ParagraphReader.textLength(c)){a=this.Lk.je(15);try{a.ld(c),c=f+1,ma.a.Gx(l,c)&&c++,this.In.AIb(b,null),this.Ca.processAction(C.a.rightArrow,2)}finally{a&&a.dispose()}y=!0}}else if(0<f){a=this.Lk.je(15);try{a.ld(c),c=f-1,ma.a.Gx(l,c)&&c--,this.In.AIb(b,null),this.Ca.processAction(C.a.leftArrow,
2)}finally{a&&a.dispose()}y=!0}return y}arj(a){return tb.a.Bs(a.Va).cache.fontSize}JAj(a){var b=!1;if(!(a.mc.altKey||a.mc.ctrlKey||a.mc.shiftKey||(a=cg.f(this.Qb.Gg),Yb.a.any(a,c=>5===c.Bq||8===c.Bq)))){if(this.jd.Cg&&this.YP.BBb(this.jd.Cg.ao))return!1;this.AC.mnb&&this.AC.typingProcess();b=this.EZ.Vta(this.Kha.O9);a=this.rf.yja(b);a=this.Qb.rda?a.x+a.width:a.x;-1===this.rf.Pz?(this.rf.Pz=a,b=!0):b=Math.abs(this.rf.Pz-a)<=this.arj(b)}return b}yAj(a,b,c){if(!a.mc.altKey&&!a.mc.ctrlKey&&!a.mc.shiftKey&&
(this.nj&&this.Xk.n3&&this.wS.Pxd()&&this.mI.Zs(!1),this.IUh.XJl(b,this.Qb.Zh,this.Qb.gSa,this.Qb.Gg,this.Kha.O9,this.Qb.HW.Pi,this.mI.Fqi))){if(this.hd.ig&&this.hd.jz)return(b=this.zAj(b))&&hd.a.Kn(a.mc),b;const f=this.qd.Zp(C.a.ZVd);this.Jwc&&this.Jwc.g7j();const l=new ed(a,c,b);this.HUh.sXk(l);(c&&!this.Xk.n3||b&&!this.Xk.Usa)&&this.mI.Zs(!1);N.a.instance.ga(50)&&this.Tqa.value&&this.Tqa.value.Bw&&this.Uc.ZZb();Ea.a.T2b(this.Qb.Zh.Pi,this.Qb.HW.Pi);this.AC.FQa(a);this.rf.pLa();this.wf.Zaa(!0);
this.Xk.Usa=b;this.Xk.n3=c;this.Xk.n3&&-1===this.Xk.ZNc?this.Xk.ZNc=this.mI.bYc:this.Xk.Usa&&-1===this.Xk.gwd&&(this.Xk.gwd=Ea.a.Fv(this.Qb.gSa).length);f.end();return!0}return!1}kA(a,b,c){const f=this.N2d;try{f&&f.keyDownEventHandlerStart(a.mc.rawEvent);0===this.wf.mode&&a.mc.keyCode!==B.a.Dp&&1!==this.Ca.mode&&this.Pbk(this.wf,a.eventName);if(!b||!this.mh)return!1;(a.mc.keyCode!==B.a.Bnb||this.Lob.hQc)&&this.Yk.value.aq.lE();if(!this.ysl(a)){const H=new zd(!0);this.tca.KXk(H)}if(!this.wf.isActive)return!1;
this.Xk.ire=(new Date).getTime();const l=this.qd.Zp(C.a.typing);l.properties.$(lf.a.source,"KeyDown");l.properties.$(lf.a.ofh,"KeyDown");const y=this.a7j(a,c);y&&hd.a.nxi(a.mc);l.end();return y}finally{f&&f.keyDownEventHandlerEnd(a.mc.rawEvent)}}ysl(a){switch(a.mc.keyCode){case B.a.Dba:case B.a.GPh:case B.a.f7:case B.a.nZ:case B.a.Eba:case B.a.rha:case B.a.bzd:case B.a.czd:return!0}return!1}Pbk(a,b){b={["EventName"]:b};w.AFrameworkApplication.Aa&&(b.Mode=w.AFrameworkApplication.Aa.mode);if(a)if(b.Trigger=
a.p4c,b.TriggeredTime=a.E7j,this.RVb.Fb(a.p4c)){let c,f;(c=this.RVb).$(f=a.p4c,c.ga(f)+1)}else this.RVb.$(a.p4c,1);b.Msg="BadEditSurfaceState";this.kbf?ka.ULS.sendTraceTag(18437408,323,50,"{0}",b):(ka.ULS.shipAssertTag(18437408,323,!1,"{0}",b),w.AFrameworkApplication.Wga(()=>{this.Qbk()}));this.kbf=!0}Qbk(){if(!this.Tjf){var a="";for(let b of this.RVb.keys)a+=" Trigger "+b+" - "+this.RVb.ga(b)+",";ka.ULS.sendTraceTag(50421966,323,10,"Total keyinput lost in UnknownMode:"+a);this.Tjf=!0}}vEk(a,b){this.nj&&
this.$K.Qkb(this.wf.mode,this.Qb.Pi,this.Qb.Gg,this.Qb.Zh,this.Yk.value.isEditingAllowed||this.Yk.value.sz);if(this.hd.ig&&(x.KeyInputManager.QYc(a.mc)===x.KeyInputManager.Qa(B.a.tAa,x.KeyInputManager.Re)||x.KeyInputManager.QYc(a.mc)===x.KeyInputManager.Qa(B.a.$xc,x.KeyInputManager.Re))&&(w.AFrameworkApplication.fK||w.AFrameworkApplication.cC)&&!w.AFrameworkApplication.QSa)return hd.a.Kn(a.mc),!0;const c=this.o6a.k6b,f=c.node;if(a.mc.keyCode===B.a.Dp){if(Nb.EmbeddedFileReader.I0j(f))return hd.a.Kn(a.mc),
!0;if(ba.ImageReader.tH(f)||!Nb.EmbeddedFileReader.bcb(f))if(ba.ImageReader.tH(f)||ba.ImageReader.cGa(c))return w.AFrameworkApplication.Ra.ei(c,C.a.XB,2,!1,null,null),hd.a.Kn(a.mc),!0}switch(a.mc.keyCode){case B.a.Xzd:case B.a.bzd:if({j4:a,gPb:b}=this.WV.KKh(a,b),a)return b}return!1}Mse(a){w.AFrameworkApplication.Ra.processAction(a,2)}}Aa.sEl=2E3;Object(m.a)(Aa,"KeyDownProcessor",null,[]);class Pa{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc){this.ep=a;this.Qb=b;this.fg=c;this.qd=f;this.nj=l;
this.VD=y;this.mI=H;this.wS=Q;this.Bh=ia;this.aj=wa;this.EZ=Ua;this.FV=kb;this.rf=Gb;this.Xk=ec;this.wf=dc}get fOe(){return this.ep.cJ(this.Qb.Pi,this.fg,this.qd,this.nj)-(this.VD.O7?1:0)-this.ep.cJ(this.Qb.Pi.lastChild,this.fg,this.qd,this.nj)}mUk(a,b){switch(b.keyCode){case B.a.pF:case B.a.qS:if(this.YIj(a,b))return!0;break;case B.a.jx:case B.a.BP:if(this.OYi(a,b))return!0;break;case B.a.n2:case B.a.m2:if(this.EMl(a,b))return!0;break;case B.a.iI:if(this.Ooi())return!0}return!1}Ooi(){return this.Xk.n3&&
this.wS.Pxd()?(this.mI.Zs(!1,!0),!0):!1}EMl(a,b){a.H0c=!0;var c=this.fOe;const f=this.aj.U8(this.Bh.mode,this.Qb.Pi);f>=c&&(this.aj.yT(c,this.Qb.Zh),a.mb=this.EZ.Vta(this.FV.O9));if(f===b.U3b)a.h9a=b.keyCode===B.a.nZ?1:3;else{if(f<c&&ma.a.uz(this.ep.R4f(this.Qb.Zh,f-1,this.qd,this.fg,this.nj))){c=this.rf.Cta(a.mb,!1,!1,!1,!0);c=this.rf.yja(c);var l=a.mb.Va;a=this.rf.yja(a.mb);l=tb.a.Bs(l);a.y>c.y&&Math.abs(a.x-this.rf.Pz)>2*l.cache.fontSize&&this.aj.yT(f-1,this.Qb.Zh)}this.wf.NLa(!0);this.FV.fixupAfterCursor(b.keyCode===
B.a.nZ?1:3);this.mI.P2d();return!0}return!1}OYi(a,b){a.H0c=!0;const c=this.fOe;this.rf.pLa();const f=this.aj.U8(this.Bh.mode,this.Qb.Pi);f>=c&&(this.aj.yT(c,this.Qb.Zh),a.mb=this.EZ.Vta(this.FV.O9));if(b.keyCode===B.a.BP&&(b.U3b>=c&&!this.Qb.rda||b.U3b===this.FV.REh&&this.Qb.rda))a.h9a=2;else return this.wf.NLa(!0),b.keyCode===B.a.jx&&f<c&&ma.a.uz(this.ep.R4f(this.Qb.Zh,f-1,this.qd,this.fg,this.nj))&&this.aj.yT(f-1,this.Qb.Zh),this.FV.fixupAfterCursor(this.Qb.rda?4:2),this.mI.P2d(),!0;return!1}YIj(a,
b){a.H0c=!0;const c=this.fOe;this.rf.pLa();if(b.keyCode===B.a.qS&&(b.U3b===this.FV.REh&&!this.Qb.rda||b.U3b>=c&&this.Qb.rda))a.h9a=4;else return this.wf.NLa(!0),this.FV.fixupAfterCursor(this.Qb.rda?2:4),this.mI.P2d(),!0;return!1}}Object(m.a)(Pa,"KeyEntryProcessor",null,[]);var ub=d(1250),Lb=d(130),Mb=d(44);class kd{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye,Xd,Xf,ug,qg,Fg,qf){this.GAa=this.kqf=null;this.ud=a;this.kn=b;this.qd=c;this.Jia=f;this.Yk=l;this.WV=y;this.B7=H;this.ks=
Q;this.wf=ia;this.Uc=wa;this.jd=Ua;this.LAc=kb;this.aj=Gb;this.Dha=ec;this.ep=dc;this.Qb=Fc;this.Kha=yc;this.Jh=tc;this.Tqa=xd;this.Ep=Vd;this.AC=Ld;this.Pba=ye;this.dCa=Xd;this.C8h=Xf;this.Mha=ug;this.hd=qg;this.hp=Fg;this.$Tb=qf}get Jwc(){return this.dCa&&this.dCa.instance?this.dCa.instance.HKh():null}get Qcb(){return this.hd.ig&&this.hd.jz}get k_(){return this.GAa||(this.GAa=Ib.a.instance.qb("Box4.IClipboardCommands"))}get N2d(){return this.$Tb||(this.$Tb=Ib.a.instance.qb("Common.IEventTimingMeter"))}Ycb(a,
b){if(!b)return!1;b=this.N2d;try{b&&b.keyPressedEventHandlerStart(a.mc.rawEvent);if(this.ud.dG&&this.ud.Ik&&this.kn.g9f(a.mc.rawEvent))return!1;this.Jwc&&!x.KeyInputManager.Sog(a)&&this.Jwc.g7j();const c=this.qd.Zp(C.a.typing);c.properties.$(lf.a.source,"KeyPress");const f=this.f7j(a);c.end();return f}finally{b&&b.keyPressedEventHandlerEnd(a.mc.rawEvent)}}ZFj(){if((this.C8h||this.Qcb)&&this.Mha.l3(this.Uc.Yj,14)){var a=Object(qa.a)(ub.a,this.Mha.N6b(this.Uc.Yj,16,!1));if(a&&1<a.length){const b=[],
c=this.Uc.Pa.ga(0);a=a.getContext(0).node;for(let f=0;f<c.length;++f){const l=c.ga(f).node;if(!ob.GraphIterator.pb(l).vba(a))break;Array.add(b,c.ga(f))}0<b.length&&this.Uc.setSelection(new Lb.Selection(b,!0))}}}nYk(a,b){if(1===this.wf.mode)return!1;this.Ep.rTe(a,this.ks.isComposing);let c;(c=this.AC).W3c=c.W3c+1;z.a.Ho||Rc.App.wWd&&z.a.gGh||(this.AC.ZAh(this.ks.rGa)||this.AC.FQa(a),this.wf.Zaa(!0));this.ks.isComposing&&N.a.instance.ga(50)&&this.Tqa.value&&this.Tqa.value.Bw&&this.Uc.ZZb();this.Jh.rIc=
"";0<this.Jh.Ki.length&&(this.ud.gg||" "===b)&&(this.Jh.rIc=Ea.a.Fv(this.Jh.Ki[0].LF));this.Pba.raiseEvent(Kh.a.Yqe,a);this.LAc.oJh();return!1}IVi(a){let b=!1;this.ks.rGa&&this.Dha.z0b.instance&&(" "===a&&this.ep.$Xi(this.Qb.Pi,this.aj.U8(this.wf.mode,this.Qb.Pi))&&(b=!!this.Dha.XHe(this.ks.rGa,this.Kha.O9)),!b&&this.Dha.z0b.instance.f5j(a)&&this.Dha.HVi(a,this.Kha.O9))}gCj(a){if(1!==this.wf.mode||(this.ud.Wj||this.ud.Ho)&&a.mc.ctrlKey&&!a.mc.altKey||this.ud.Gla&&a.mc.charCode===B.a.mZ)return!1;if(this.WV.vkd(a))return!0;
var b=this.WV.g1e();const c=this.WV.Bsl();if(b||c||!this.B7.C1e())return b&&!c&&this.Uc.setSelection(Od.SelectionFactory.Qg(this.Uc.Pa.mb.Va.node,this.Uc.Pa.mb.Va.Sa)),b=this.ccb(),this.ZFj(),this.k_&&(this.k_.Ieh(String.fromCharCode(a.mc.charCode),b),this.Pba.raiseEvent(Kh.a.Yqe,a)),hd.a.Kn(a.mc),!0;if(this.WV.PNe(a))return!0;if(this.Qcb){b=this.hd.Htb();try{this.Ep.rTe(a,this.ks.isComposing),this.ud.Ho&&this.k_?(this.k_.Ieh(String.fromCharCode(a.mc.charCode)),hd.a.Kn(a.mc)):(this.AC.FQa(a),this.wf.Zaa(!0))}finally{b&&
b.dispose()}}else this.B7.startHybridTransition(),this.Ep.rTe(a,this.ks.isComposing),this.AC.FQa(a),this.wf.Zaa(!0);this.Pba.raiseEvent(Kh.a.Yqe,a);this.LAc.oJh();return!1}ccb(){if(this.Uc&&this.Uc.Pa&&this.Uc.Pa.mb){const a=this.Uc.Pa.mb;return Mb.SelectionEditor.im(a.ga(a.length-1))||a.ga(a.length-1).contextId===yb.a.paragraph}return!1}f7j(a){this.Jia.fixupAfterMagnifierDrag();if(!(this.Yk.value.isEditingAllowed||this.Yk.value.sz&&this.Qcb))return hd.a.Kn(a.mc),!0;if(this.WV.xkd(a))return!1;if(1===
this.wf.mode)return this.gCj(a);this.jd.Bm().scrollTop=0;this.ud.gg&&this.wf.I7b(this.Qb.Gg)&&" "===this.kqf&&this.AC.typingProcess();const b=ma.a.charAt(ma.a.fromCharCode(a.mc.charCode),0);this.kqf=b;this.ks.isComposing||(x.KeyInputManager.Sog(a)&&(this.ks.isComposing=!0),this.aj.g_k&&(this.ks.isComposing=!0));this.IVi(b);if(this.ud.gg&&!this.ud.Ik){const c=a.mc;if(c.ctrlKey&&122===this.kn.Q4f(c)||c.ctrlKey&&121===this.kn.Q4f(c))return!0}return this.nYk(a,b)}}Object(m.a)(kd,"KeyPressProcessor",null,
[]);class Id{constructor(a,b){this.uj=a;this.keyCode=this.uj.mc.keyCode;this.U3b=b}get oHj(){return!(void 0===this.keyCode||null===this.keyCode)}}Object(m.a)(Id,"KeyQueueEntry",null,[]);class ce{constructor(a,b,c,f,l,y,H){this.SVb=[];this.Kia=null;this.m1h=a;this.wf=b;this.Qb=c;this.rf=f;this.Uc=l;this.mI=y;this.aj=H}get f1a(){return this.Kia||(this.Kia=Ib.a.instance.qb("Box4.ISelectionCommands"))}nhh(a){let b=-1;if(x.KeyInputManager.mpg(a.eventName)&&2===this.wf.mode)switch(a.mc.keyCode){case B.a.pF:case B.a.jx:case B.a.qS:case B.a.BP:case B.a.n2:case B.a.m2:N.a.instance.ga(45)&&
this.wf.I7b(this.Qb.Gg)&&this.mI.Zs(!1,!1);Xh.GrippersManager.instance.cVa();b=this.aj.U8(this.wf.mode,this.Qb.Pi);break;default:Xh.GrippersManager.instance.restoreAfterCursoring()}Array.add(this.SVb,new Id(a,b))}nUk(a){for(;0<this.SVb.length;){const b=this.SVb[0];Array.removeAt(this.SVb,0);const c=x.KeyInputManager.mpg(b.uj.eventName);if(!(c&&(b.uj.mc.altKey||b.uj.mc.ctrlKey||b.uj.mc.shiftKey)||this.SVb.length)){if(c)if(b.oHj){if(this.m1h.mUk(a,b))return!0}else this.rf.pLa();if(this.yKl(a))return!0}}return!1}yKl(a){if(5!==
a.h9a){if(this.wf.r8f(this.Qb.Gg))if(1===a.h9a||3===a.h9a){const b=this.rf.Pz;this.Uc.setSelection(a.mb);this.rf.Pz=b}else this.Uc.setSelection(a.mb);this.f1a.Mwk(a.h9a);if(2!==this.wf.mode)return!0}return!1}}Object(m.a)(ce,"KeyQueueProcessor",null,[]);class Xe{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb){this.Kia=null;this.qd=a;this.$K=b;this.Bh=c;this.ks=f;this.Qb=l;this.Yk=y;this.kia=H;this.$s=Q;this.TCc=ia;this.jd=wa;this.Lob=Ua;this.AC=kb}get f1a(){return this.Kia||(this.Kia=Ib.a.instance.qb("Box4.ISelectionCommands"))}AGa(a,
b){if(!b)return!1;b=this.qd.Zp(C.a.typing);b.properties.$(lf.a.source,"KeyUp");a=this.i7j(a);b.end();return a}i7j(a){a.mc.keyCode===B.a.Bnb&&(this.Lob.hQc=!0);a.mc.ctrlKey&&this.$K.aTf(this.Bh.mode,ge.a.instance.Pa,this.f1a,this.Qb.Zh,this.Qb.Pi,this.Qb.Gg,this.Yk.value.isEditingAllowed||this.Yk.value.sz);this.ks.isComposing&&(this.kia.UHb(),this.$s.dZ());this.AC.ZAh(this.ks.rGa)&&(this.TCc.nhh(a),this.AC.mnb=!0,this.AC.typingProcess());this.jd.Bm().scrollTop=0;return!1}}Object(m.a)(Xe,"KeyUpProcessor",
null,[]);class jd{constructor(a){this.yCd=this.dBd=this.GG=null;this.Zd=a}get q8(){return this.GG||(this.GG=Ib.a.instance.resolve("Common.Utils.IAriaNotifier"))}mzk(a){a&&(this.yCd=a,this.dBd=new dd.a(2,1,500,Object(I.a)(this,this.tryAriaNotifyParagraphLockedTask,"tryAriaNotifyParagraphLockedTask"),29),this.Zd.Hb(this.dBd))}tryAriaNotifyParagraphLockedTask(a){this.yCd&&a&&this.dBd===a&&this.q8.sendNotification(String.format(Box4Intl.Box4Strings.l_ScreenReaderBlockEditing,this.yCd),!0)}}Object(m.a)(jd,
"LockedParagraphAriaNotifier",null,[]);class rd{constructor(a){this.mI=a}lostFocus(a,b){w.AFrameworkApplication.Yg||b&&this.mI.Zs(!0,!1)}}Object(m.a)(rd,"LostFocusEventProcessor",null,[]);class Wc{constructor(a,b,c,f){this.fg=a;this.Bh=b;this.kia=c;this.$s=f}onScroll(a,b,c){b&&(c.scrollLeft||c.scrollTop)&&(this.fg.h++,c.scrollLeft=0,c.scrollTop=0,2===this.Bh.mode&&(this.kia.UHb(),this.$s.dZ()))}}Object(m.a)(Wc,"OnScrollProcessor",null,[]);var wd=d(1144);class Fe{constructor(a,b,c,f){this.html=a;this.text=
b;this.BFl=c;this.F_d=f}dispose(){this.F_d=null}}Object(m.a)(Fe,"OriginalElementContent",null,[107]);class ak{constructor(a,b,c){this.$Wb=[];this.Lff=0;this.qd=a;this.VS=b;this.ep=c}get N5d(){return this.Lff}get ddh(){return this.$Wb}xKf(){for(let a=0;a<this.$Wb.length;a++)this.$Wb[a]&&(this.$Wb[a].dispose(),this.$Wb[a]=null)}cFh(a){this.xKf();a=a.At;for(let c=0;c<a.length;c++){const f=a[c];var b=!1;f.parentNode&&f.parentNode.parentNode&&(b=Sys.UI.DomElement.containsCssClass(f.parentNode.parentNode,
xc.a.X6d));if(b||Sys.UI.DomElement.containsCssClass(f,xc.a.FN)||Sys.UI.DomElement.containsCssClass(f,da.a.pW)||Sys.UI.DomElement.containsCssClass(f,xc.a.VN)){let l=b=null,y=null;1===f.childNodes.length&&3===f.firstChild.nodeType?b=Ea.a.Fv(f):(l=this.ep.A$d(f,this.qd,this.VS),y=new wd.a(f));this.ddh[c]=new Fe(f.innerHTML,b,l,y)}Sys.UI.DomElement.containsCssClass(f,xc.a.VN)&&(this.Lff=Ea.a.U$a(f))}}}Object(m.a)(ak,"OriginalElementContentArray",null,[1428]);class tj{constructor(a,b,c,f,l,y,H){this.Jh=
a;this.fg=l;this.qd=f;this.nj=H;this.VD=b;this.Uc=c;this.ep=y}o6i(a,b,c){var f=this.Uc.Pa.mb.Va;const l=f.Sa;f=f.Mb;let y=0,H=0;a=a.At;Array.clear(this.Jh.Ki);for(let Ua=0;Ua<a.length;Ua++){var Q=a[Ua],ia=this.ep.cJ(Q,this.fg,this.qd,this.nj);if(Sys.UI.DomElement.containsCssClass(Q,xc.a.FN))H<l?y+=ia:H<f&&(ia=cg.d(b,H))&&!ia.UCa&&(ia=L.a.ze(Q,da.a.EGa),Array.add(this.Jh.Ki,new Sg(Q,c.At[ia],y,H,1))),H++;else if(Sys.UI.DomElement.containsCssClass(Q,da.a.pW))y+=ia;else if(!Sys.UI.DomElement.containsCssClass(Q,
xc.a.VN)){if(H+ia>=l&&H<=f){let kb=L.a.ze(Q,da.a.EGa);var wa=c.At[kb];Sys.UI.DomElement.removeCssClass(wa,xc.a.B8);Array.add(this.Jh.Ki,new Sg(Q,wa,y,H,ia-(this.VD.O7?1:0)));for(Q=this.ep.cJ(wa,this.fg,this.qd,this.nj);Q<ia&&!(kb+1>=c.At.length);)wa=c.At[kb+1],Q+=this.ep.cJ(wa,this.fg,this.qd,this.nj),wa.parentNode.removeChild(wa),Array.removeAt(c.At,kb+1)}else if(H>f)break;y+=ia;H+=ia}}}}Object(m.a)(tj,"OvertypeDomPreparer",null,[]);var bh=d(122),ee=d(60);class Mi{constructor(a,b,c,f,l,y,H,Q,ia,
wa,Ua,kb,Gb,ec,dc,Fc){this.LLd=!1;this.GAa=null;this.U1h=a;this.Bh=b;this.ud=c;this.Uc=f;this.Kra=l;this.rf=y;this.Yk=H;this.Pf=Q;this.ks=ia;this.B7=wa;this.nj=Ua;this.Qb=kb;this.$K=Gb;this.AC=ec;this.hd=dc;this.hp=Fc}get k_(){return this.GAa||(this.GAa=Ib.a.instance.qb("Box4.IClipboardCommands"))}rKl(){return 1===this.Bh.mode?(this.LLd&&this.ud.gg&&this.fWd(),this.LLd=!1,!0):!1}fWd(){if(this.k_){const a=new J.DictionaryPropertySet;a.setValue(ee.a.VU,"<span></span>");this.k_.t8(null,a,!1)}}PNe(a){const b=
this.Uc.Npa;return b.xqe||b.Ioe?(hd.a.Kn(a.mc),this.Kra.qrc(C.a.VKk),!0):!1}vkd(a){if(!this.rf.Jua(ge.a.instance.Pa.mb))return!1;hd.a.Kn(a.mc);this.Kra.qrc(C.a.vkd);return!0}xkd(a){if(!N.a.instance.ga(14))return!1;var b=ge.a.instance.Pa.ga(0);if(!bh.a.instance.Pgl(b))return!1;b=this.rf.rxc(ge.a.instance.Pa);this.U1h.mzk(b);hd.a.Kn(a.mc);this.Kra.qrc(2===this.Bh.mode?C.a.hLl:C.a.xkd);return!0}KKh(a,b){let c,f;f=c=!1;if(!this.Yk.value.isEditingAllowed)return hd.a.Kn(a.mc),{j4:!0,gPb:!0};if(!b)return{j4:!0,
gPb:!0};if(this.vkd(a)||this.Pf.Rd.Nb.Pa.uH&&a.mc.type===oa.a.g_d)return{j4:!0,gPb:f};this.ks.isComposing=!0;b=this.g1e();if(!b&&this.B7.C1e()){if(this.PNe(a))return{j4:!0,gPb:f};this.nj&&this.$K.Qkb(this.Bh.mode,this.Qb.Pi,this.Qb.Gg,this.Qb.Zh,this.Yk.value.isEditingAllowed||this.Yk.value.sz);this.hd.ig&&this.hd.jz?(hd.a.Kn(a.mc),f=c=!0):this.B7.startHybridTransition()}else b&&this.Uc.setSelection(Od.SelectionFactory.Qg(ge.a.instance.Pa.mb.Va.node,ge.a.instance.Pa.mb.Va.Sa)),this.Uc.Npa.vub(),this.hd.ig&&
this.hd.jz?(hd.a.Kn(a.mc),f=c=!0):this.ud.gg?(this.LLd=!0,this.AC.FQa(a),c=!0):(this.fWd(),hd.a.Kn(a.mc));return{j4:c,gPb:f}}g1e(){if(!this.Uc.Pa.Cea)return!1;var a=ge.a.instance.Pa.mb.Va;return a.Sa!==a.Mb-1?!1:(a=cg.d(a.node,a.Sa))&&5===a.Bq?!0:!1}Bsl(){if(!this.Uc.Pa.Cea)return!1;const a=this.Uc.Pa.mb.Va;return!cg.d(a.node,a.Mb)||0<a.Sa&&!cg.d(a.node,a.Sa-1)||a.Sa===a.Mb?!1:!0}}Object(m.a)(Mi,"OvertypeUtils",null,[]);class Nl{constructor(a,b,c,f,l,y){this.a4a=null;this.jd=a;this.qWh=b;this.Pf=
c;this.Bh=f;this.Qb=l;this.vLd=y}get tNf(){return this.qWh}x9e(){if(2===this.Bh.mode&&this.Pf.Rd.qp&&this.Qb.wWa(this.Bh.mode)){var a=this.Qb.Zh,b=this.tNf.Ibe(a.gb);this.vLd.Cph(b,this.a4a,a,this.jd.Cg.Gu,!1,!0);this.a4a=b}}}Object(m.a)(Nl,"ParagraphOverlayPositioner",null,[]);class Cg{constructor(a,b){this.pNk=this.location=null;this.Pu=a;this.isRtl=b}}Object(m.a)(Cg,"OnShowFloatieEventArgs",null,[]);class zi{constructor(){this.type=0;this.payload=this.KNe=null;this.E4c=!1;this.HRa=this.style=this.tRe=
null}}Object(m.a)(zi,"PasteDataContext",null,[]);class Zh{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye,Xd,Xf,ug,qg,Fg){this.OLd=this.Hpf=this.Yn=null;this.tOd=qg;this.xra=Fg;this.Gpf=a.ka("PasteClipboardImageInChromeIsEnabled");this.f4h=a.ka("PasteFromPlainTextKeepEmptyLinesIsEnabled");this.GMd=a.ka("ReadImageBlobForIE11UpIsEnabled");this.EVh=a.wc("ClipboardDataImageBlobLimitaton",10);this.DYb=a.ka("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.ktf=a.ka("PasteInBootLoadingUIIsEnabled");
this.yOd=a.ka("ParseStyleFromRawHtmlHeadIsEnabled");this.Zd=b;this.qd=c;this.Lk=f;this.Uc=l;this.Bh=y;this.jd=H;this.J2=Q;this.Pf=ia;this.ud=wa;this.$K=Ua;this.Qb=kb;this.Dha=Gb;this.Yk=ec;this.GAa=dc;this.lk=Fc;this.XWh=tc;this.eQa=xd;this.JS=Vd;this.Ca=Ld;this.j7=ye;this.fra=Xd;this.tca=Xf;this.aCa=ug;this.Ucf=[Object(I.a)(this,this.KKj,"imageClipboardDataHandler"),Object(I.a)(this,this.LOk,"plainTextClipboardDataHandler"),Object(I.a)(this,this.yJj,"htmlClipboardDataHandler")]}get k_(){return this.GAa.instance}get mKa(){return this.OLd}Hnj(a){switch(a){case "image/png":a=
1;break;case "text/plain":a=2;break;case "text/html":a=3;break;default:a=0}return a}get t7h(){return this.yOd||this.DYb}nCj(a){const b=new zi;b.type=this.Hnj(a.type);b.payload=a.data;b.E4c=!0;this.ath(b)}rhh(a,b){this.Uc.Npa.vub();this.Bh.Yaa(0,!0,13);this.jd.q1a(!0);const c=this.jd.Cg.Gu.style;c.display="block";a&&(b=c.overflow,c.overflow="hidden");this.J2.DSk();this.Pf.Rd.pAa();this.ud.dva?this.$K.xLa(this.Bh.mode,this.Qb.Pi,this.Qb.Gg,this.Qb.Zh,this.Yk.value.isEditingAllowed||this.Yk.value.sz):
this.J2.EMc();return b}Lrh(a){this.jd.Cg.Gu.style.overflow=a}handlePaste(a,b,c){if(!c&&!this.mKa&&!this.Zd.Dw)if(this.k_||this.ktf){this.Dha.QR&&(this.Dha.QR=null);this.OLd=this.Lk.je(3);this.mKa.ld(b);b=new zi;b.HRa=this.aCa.E3e();b.HRa.cKc("pasteHandler");b.E4c=!1;b.KNe=this.rhh(this.JS.Etd,b.KNe);if(c=this.lk.Oda(a)){this.t7h&&this.CMk(c,b);for(let f=0;f<this.Ucf.length&&this.Ucf[f](a,c,b);++f);}this.xra&&a.preventDefault();w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacLoadingPasteBootUISettings");
!this.k_&&this.ktf?this.ath(b):this.$sh(b)}else ka.ULS.sendTraceTag(3994320,307,50,"Clipboard command not available"),this.qd.Xb(Kd.a.zh,{["Reason"]:Qd.a.iSf}),this.Ca.Kse(C.a.t8),a.preventDefault()}ath(a){ka.ULS.sendTraceTag(24492118,307,50,"Clipboard commands unavailable. Loading Paste dialog is showing.");this.Dpa();this.j7.Mj(6,()=>{this.UUi(a)})}Dpa(){this.Yn=this.fra();this.Yn.Ir=!1;this.Yn.Ad=5;this.Yn.Dpa(null,null,null)}UUi(a){this.Yn&&(this.Yn.close(),this.Yn=null);ka.ULS.sendTraceTag(24492119,
307,50,"Clipboard commands available. Dismissing progress dialog.");this.$sh(a)}$sh(a){a=this.XWh.create(null,Object(I.a)(this,this.WVi,"doPasteOperation"),a);a.$l("Browser Pasted (Editing Surface)");a.run()}KKj(a,b,c){if((this.Gpf||this.GMd)&&(b=this.lk.R9d(a.rawEvent))&&this.lk.Qyd(this.jd.Bm())){let f=null;if(({v$b:f}=this.lk.mxd(b,this.EVh,this.JS.ilc)).returnValue)return c.type=1,c.payload=f,this.GMd&&this.ud.iX&&a.preventDefault(),!1}return!0}LOk(a,b,c){return this.f4h&&this.lk.s0j(b)&&(a=this.lk.Vbe(b))?
(c.type=2,c.payload=a,!1):!0}yJj(a,b,c){return this.tOd&&(a=this.lk.B7b(b))?(c.type=3,c.payload=a,this.yOd&&c.style&&(c.payload+=c.style),!1):!0}WVi(a,b){var c=this.jd.Cg.Gu.style;b&&this.JS.Etd&&"hidden"===c.overflow&&this.Lrh(b.KNe);if(c=this.jd.Bm()){if(this.ud.nva)for(var f=c.firstChild;f&&1===c.childNodes.length&&rf.a(f);)c=f,f=f.firstChild;if(b&&(this.Gpf||this.GMd)&&1===b.type&&this.lk.Qyd(c)&&(f=b.payload)){this.Hpf=a;this.JS.Q2b(f,l=>{this.MUf(this.Hpf,l,b)});return}this.MUf(a,this.jd.Inj(c),
b)}}bwf(a){a=this.eQa.create(a,Object(I.a)(this,this.PHh,"teardownPaste"),null);a.$l("Aborting Paste in ContentEditableView");a.run()}MUf(a,b,c){this.ud.Wj&&(Ea.a.vv(this.jd.Bm()),this.ud.Gla||this.jd.Cg.Qoa());if(this.xra&&!c)ka.ULS.sendTraceTag(541172694,307,10,"No pasteDataContext"),this.bwf(a);else{c.E4c&&(b="",1!==c.type&&(b=c.payload));var f=!b&&!c.E4c;this.xra&&(f=!c.payload&&f);f?(ka.ULS.sendTraceTag(18437454,307,15,""),this.bwf(a)):(c.style&&(b+=c.style),this.jd.q1a(!0),f=new J.DictionaryPropertySet,
f.setValue(ee.a.VU,b),f.setValue(Ab.a.Zne,!0),f.setValue(ab.a.kO,!0),1===c.type&&this.JS.Mtc?f.setValue(ee.a.zZc,b):2===c.type&&c.payload?f.setValue(ee.a.Mib,c.payload):3===c.type&&c.payload&&(this.xra?f.setValue(ee.a.VU,c.payload):f.setValue(ee.a.wOe,c.payload)),this.DYb&&c.tRe&&f.setValue(ee.a.Xeh,c.tRe),c.HRa&&f.setValue(ee.a.HRa,c.HRa),a=this.eQa.create(a,Object(I.a)(this,this.uwi,"callPasteAction"),f),a.$l("Paste in ContentEditableView"),a.run())}}uwi(a,b){this.k_.t8(a,b,!0);a.hh(Object(I.a)(this,
this.PHh,"teardownPaste"));return!0}PHh(a){this.Bh.o2a();this.mKa&&(this.mKa.iV(a),this.mKa.dispose(),this.OLd=null);a.hh(Object(I.a)(this,this.HXd,"callPasteFloatie"));return!0}HXd(a,b){a=Object(qa.a)(J.DictionaryPropertySet,b);if(!a||a.sa(ee.a.Mib,null)||a.sa(ee.a.zZc,null))return!1;b=new Cg(1,w.AFrameworkApplication.isRtl);b.pNk=a.sa(ee.a.VU,null);this.tca.xTe(b);return!1}CMk(a,b){if(a=this.lk.rZf(a)){w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordGatherMetadataAboutPastedHTMLContentSettings");
if(this.DYb){let c=this.lk.sZf(a);null===c?c="inaccessible":""===c&&(c="unknown");b.tRe=c}this.yOd&&(b.style=this.lk.I1i(a))}}}Object(m.a)(Zh,"PasteHandler",null,[1427]);class ch{constructor(a,b,c,f,l){this.Tnf=new sh.a(RegExp("\u00a0","g")," ");this.puf=new sh.a(new RegExp("["+gc.REf+gc.Yig+"]","g"),"");this.qd=a;this.fg=b;this.aj=c;this.ep=f;this.ud=l}pAi(a,b,c,f,l){if(l){l=!1;for(let ia=0;ia<a.length;++ia){const wa=b.ddh[ia];if(!wa)continue;const Ua=a[ia];var y=Ua.innerHTML,H=wa.html;if(y.length===
H.length||y===H)continue;if(kg.N1c(Ua))continue;l=!0;y=Sys.UI.DomElement.containsCssClass(Ua,da.a.pW);H=Sys.UI.DomElement.containsCssClass(Ua,xc.a.FN);const kb=Sys.UI.DomElement.containsCssClass(Ua,xc.a.VN);let Gb=!1,ec=!1;Ua.parentNode&&Ua.parentNode.parentNode&&Sys.UI.DomElement.containsCssClass(Ua.parentNode.parentNode,xc.a.X6d)&&(Gb=Ua.parentNode.parentNode.firstChild===Ua.parentNode,ec=Ua.parentNode.parentNode.lastChild===Ua.parentNode);var Q=void 0;let dc;wa.text?(Q=Ea.a.Fv(Ua),dc=wa.text):
(Q=this.ep.A$d(Ua,this.qd,this.fg),dc=wa.BFl);const Fc=this.Tnf.pKa(Q).indexOf(this.Tnf.pKa(dc));if(0<=Fc){const yc=this.puf.pKa(ma.a.substring(Q,0,Fc));Q=this.puf.pKa(ma.a.right(Q,Fc+dc.length));0<yc.length&&((kb||H||Gb)&&0<ia?(this.Mgd(a[ia-1],yc,!0,this.fg),this.ep.Q0c(Ua)&&(f-=gc.kQc)):y&&ia!==a.length-1&&this.Mgd(a[ia+1],yc,!1,this.fg));0<Q.length&&((H||ec||y)&&ia!==a.length-1?(this.Mgd(a[ia+1],Q,!1,this.fg),this.ep.Q0c(Ua)&&(f+=gc.Q3d)):kb&&0<ia&&this.Mgd(a[ia-1],Q,!0,this.fg))}else kb&&(this.ud.Wj||
this.ud.Ho)&&1===dc.length&&!Q.length?ka.ULS.sendTraceTag(18437455,315,50,"Possible Ins/Overtype"):kb&&this.ud.gg||ka.ULS.shipAssertTag(18437456,315,!1,"CleanReadOnlyObjects failed."),y=dc?dc.length:0,H=Q.length,H>y&&(f-=H-y);wa.text?Ea.a.Mz(Ua,wa.text):(this.ep.j4j(Ua)||wa.F_d.restore(),wa.F_d=new wd.a(Ua))}l&&this.aj.yT(f,c)}}Mgd(a,b,c,f){f.n++;c?Ea.a.Mz(a,Ea.a.Fv(a)+b):Ea.a.Mz(a,b+Ea.a.Fv(a))}}Object(m.a)(ch,"ReadOnlyObjectsCleaner",null,[]);class kk{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,
ec,dc,Fc,yc,tc,xd,Vd){this.Uia=0;this.jd=a;this.gOd=b;this.JK=c;this.fg=f;this.qd=l;this.gDc=y;this.Uc=H;this.aj=Q;this.ep=ia;this.ud=wa;this.mf=Ua;this.rf=kb;this.Pf=Gb;this.nj=ec;this.QNd=dc;this.kn=Fc;this.Cr=yc;this.m0h=tc;this.EYh=Vd}init(a){this.Uia=a}Qkb(a,b,c,f,l){if(this.jd.isValid){var y=this.jd.Bm();y&&y.firstChild&&1!==w.AFrameworkApplication.Aa.state&&(this.gOd.vZf(this.Uc.Pa),this.BYe(a,b,c,f,l))}}xLa(a,b,c,f,l){if(this.JK.Ine()&&(!this.nj||this.mf.Hih))if(this.JK.setFocus(a,b,c,f,l),
this.ud.lS){a="Window.getSelection";b=this.jd.Bm();if(this.ud.bU){if("none"===b.style.display){ka.ULS.sendTraceTag(19702473,324,15,"Editing element is not displayed");return}if(!Ea.a.GVa(this.jd.Cg.sAa,b)){ka.ULS.sendTraceTag(19702474,324,15,"Editing element is not attached to view panel");return}}try{var y=this.kn.getSelection(this.jd.contentWindow);y&&(a="Selection.removeAllRanges",this.kn.removeAllRanges(y),a="Selection.selectAllChildren",this.kn.qgl(y,b))}catch(H){y=Ea.a.mag(b),ka.ULS.sendTraceTag(18437461,
324,10,"{{'BrowserAPI':'{0}','HTML':'{1}','Stack':'{2}','Display':{3},'RootElement':{4}}}",a,b?Bd.a.x4d(b):"",H.stack,b?b.style.display:"",y?y.tagName+","+y.id+","+y.className:"")}}else this.kn.BYe(this.jd.Wta().Jl)}BYe(a,b,c,f,l){const y=this.Uc.Pa.mb;try{if(this.JK.Ine()&&(!this.nj||this.mf.Hih)){var H=y.Va,Q=y.jf,ia=this.QNd.create(this.Pf.Rd);this.xLa(a,b,c,f,l);a=null;var wa=this.jd.Wta();if(this.ud.lS){a=this.kn.getSelection(this.jd.contentWindow);if(!a)return;if(this.kn.Uoj(a)){var Ua=this.kn.getRangeAt(a,
0);this.kn.removeAllRanges(a)}else Ua=this.kn.createRange(wa.Jl)}else if(this.ud.aG)Ua=wa.selection.createRange();else return;this.m0h&&this.fml(Ua);(this.rf.tk(H)||this.rf.im(H))&&this.k6i(H,Ua);this.rf.tk(Q)&&this.l6i(Q,Ua);this.ud.lS?this.kn.addRange(a,Ua):this.ud.aG&&Ua.select();ia.dispose()}}catch(kb){H=this.jd.Bm(),ka.ULS.sendTraceTag(18437463,324,10,"{{'Message':'{0}','Stack':'{1}','HTML':'{2}'}}",kb.message,kb.stack,H?Bd.a.x4d(H):"")}}l6i(a,b){var c=a.node.qc(this.Uia).At;let f=0,l=0,y=0;
a=a.Mb;for(var H=!1;f<c.length;){const Q=this.ep.cJ(c[f],this.fg,this.qd,this.nj);if(H)y+=Q;else if(Sys.UI.DomElement.containsCssClass(c[f],xc.a.FN))l++;else if(!Sys.UI.DomElement.containsCssClass(c[f],da.a.pW)){if(a<=l+Q)if(H=a-l,this.ud.lS){c=c[f];this.gDc.value.m2b(c,this.jd.contentWindow);this.Lxh(b,c,H,!1);break}else y=Q-H,H=!0;l+=Q}f++}this.ud.aG&&this.kn.moveEnd(b,-y)}k6i(a,b){var c=a.node.qc(this.Uia).At;let f=0;var l=0;let y=0,H=a.Sa;for(this.rf.im(a)&&(H=this.Cr.textLength(a.node));f<c.length;)if(a=
this.ep.cJ(c[f],this.fg,this.qd,this.nj),Sys.UI.DomElement.containsCssClass(c[f],xc.a.FN))l++,f++,y+=a;else if(Sys.UI.DomElement.containsCssClass(c[f],da.a.pW))f++,y+=a;else if(this.EYh&&Sys.UI.DomElement.containsCssClass(c[f],xc.a.W4d))f++,y+=a;else{if(H<=l+a){l=H-l;this.ud.lS?(c=c[f],this.gDc.value.m2b(c,this.jd.contentWindow),this.Lxh(b,c,l,!0)):this.kn.moveStart(b,y+l);break}l+=a;y+=a;f++}}Lxh(a,b,c,f){b.childNodes.length?(1<b.childNodes.length||b.firstChild&&3!==b.firstChild.nodeType)&&ka.ULS.sendTraceTag(18437465,
324,50,"Span is not normalized"):ka.ULS.sendTraceTag(18437464,324,10,"Trying to set selection in an empty span");let l=0,y=null;b=Ea.a.YTc(b,!0);for(let H of b)if(3===H.nodeType){b=H.nodeValue.length;if(c<=l+b){this.kn.PNb(a,f,H,c-l);return}y=H;l+=b}y?(ka.ULS.sendTraceTag(18437467,324,15,"CP ({0}) was greater than length of all text nodes ({1}), setting at end",c,l),this.kn.PNb(a,f,y,c-l)):ka.ULS.sendTraceTag(18437466,324,15,"Span contained no text nodes")}aTf(a,b,c,f,l,y,H){var Q=this.Uc.Npa;if(Q.xqe||
Q.Ioe)return!1;var ia=this.jd.Bm();if(!ia.innerHTML.length)return!1;Q=!1;if(this.ud.lS)(b=Bd.a.MEa(this.jd.contentWindow))&&(this.kn.nXc(b)===ia?Q=!0:this.nj&&Bd.a.y1j(b)&&Bd.a.x1j(b)&&(Q=!0));else if(this.ud.aG){var wa=this.jd.Wta().selection.createRange();wa=this.kn.xij(wa.range);wa=wa.replace(ma.a.kDc,"");ia=ia.innerHTML;ia=ia.replace(ma.a.kDc,"");if(wa===ia)switch(a){case 2:Q=!0;break;case 1:1<b.length||!(this.rf.ju(b.mb.Va)||this.rf.im(b.mb.Va)||this.rf.ju(b.mb.jf)||this.rf.im(b.mb.jf))||(Q=
!0)}}if(!Q)return!1;this.fg.by++;this.nj&&c?c.pta():2===a?this.aj.yT(this.aj.zWa,f):1===a&&this.Qkb(a,l,y,f,H);return!0}fml(a){a=Ea.a.YTc(a.commonAncestorContainer,!0);for(let b of a)b&&(a=Ea.a.Hka(b),a.startsWith("OutlineElement")&&(-1!==a.toLowerCase().indexOf("rtl")?b.style.direction="rtl":b.style.direction="ltr"),a.toLowerCase().startsWith("paragraph")&&b.parentNode&&b.parentNode.tagName.toLowerCase().startsWith("li")&&(b.style.margin=""))}}Object(m.a)(kk,"SelectContentHelper",null,[]);class Vi{constructor(a,
b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc){this.Kia=this.Gqa=this.Ye=null;this.Bh=a;this.aj=b;this.fg=Gb;this.Qb=c;this.wf=f;this.jd=l;this.Zd=y;this.kn=H;this.ep=Q;this.qd=kb;this.Uc=ia;this.nj=dc;this.$K=wa;this.FV=Ua;this.Yk=ec;this.wS=Fc}get f1a(){return this.Kia||(this.Kia=Ib.a.instance.qb("Box4.ISelectionCommands"))}iT(a){this.Ye=a}lFj(a,b){if(!a)return!1;var c=this.Bh.mode;if(2===c)if(!this.aj.KQj)this.fg.b++,this.aj.yT(this.aj.zWa,this.Qb.Zh);else if(this.nj){if(500>(new Date).getTime()-this.wf.qHi)return this.Ye.lvb.uea=
!1;a=Bd.a.MEa(this.jd.contentWindow);if(!a)return!1;if(Bd.a.B2c(a)){b=this.aj.nUc(c,this.Qb.Pi);if(this.aj.zWa===b&&!this.Ye.lvb.uea)return this.Gqa&&(this.Zd.Lg(this.Gqa),this.Zd.Hb(this.Gqa)),!1;if(this.wS.Pxd())return this.fg.c++,this.Ye.lvb.uea=!0,!1;if(this.Ye.lvb.uea)return this.fg.d++,this.wf.Zaa(!0),this.Ye.Zs(!0),this.Ye.lvb.uea=!1;this.Gqa||this.Ye.Zs(!0);Xh.GrippersManager.instance.setVisibility(!1);this.Mkl();return!1}if(this.$K.aTf(c,ge.a.instance.Pa,this.f1a,this.Qb.Zh,this.Qb.Pi,this.Qb.Gg,
this.Yk.value.isEditingAllowed||this.Yk.value.sz))return this.fg.e++,!1;c=this.ep.Kbe(this.kn.nXc(a),this.Qb.Pi,this.kn.Dbg(a),this.fg,this.qd,this.nj);a=this.ep.Kbe(this.kn.Cgj(a),this.Qb.Pi,this.kn.I6f(a),this.fg,this.qd,this.nj);if(0>c||a<c||Db.ParagraphReader.textLength(b.node)<a)return!1;this.fg.f++;this.Uc.setSelection(Od.SelectionFactory.D3(b.node,c,a))}return!1}Mkl(){this.Gqa?this.Zd.Lg(this.Gqa):this.Gqa=new dd.a(2,1,1E3,()=>{this.fixupAfterMagnifierDrag()},23);this.Zd.Hb(this.Gqa)}fixupAfterMagnifierDrag(){if(this.Gqa){this.Gqa=
null;var a=this.Bh.mode;2===a&&this.Qb.wWa(a)&&(this.fg.g++,this.aj.updateCaretPosition(a,this.Qb.Pi),this.wf.NLa(!0),this.FV.fixupAfterCursor(5),this.Ye.Zs(!0),Xh.GrippersManager.instance.fCh())}}}Object(m.a)(Vi,"SelectionChangeHandler",null,[1426]);class kj{constructor(a,b){this.jd=a;this.yYb=b}vZf(a){this.DCf(this.jd.Bm(),this.yYb+a.Zr,z.a.Lqi)}DCf(a,b,c){for(a=a.firstChild;a;a=a.nextSibling)3!==a.nodeType&&(this.x6k(a),Sys.UI.DomElement.addCssClass(a,b),Sys.UI.DomElement.addCssClass(a,c),this.DCf(a,
b,c))}x6k(a){var b=a.className;if(b){b=b.split(" ");for(let c=0;c<b.length;c++)b[c].startsWith(this.yYb)&&Sys.UI.DomElement.removeCssClass(a,b[c])}else ka.ULS.sendTraceTag(18437474,324,50,"Class string for DOMElement is null")}}Object(m.a)(kj,"SequenceCodeHelper",null,[1425]);class Ni{constructor(a,b,c,f){this.fg=f;this.aj=b;this.qd=c;this.Oa=a}AVk(a,b,c,f){if(a.Ki.length){var l=a.Ki[0].LF,y=Ea.a.Fv(l);if((a=a.rIc)&&y&&y.length===a.length+1&&y.endsWith(" ")){var H=Bd.a.Mae(l);H&&((a=L.a.ze(l,da.a.EGa),
a=b.At[a+1],a)?Bd.a.Mae(a)!==H&&(c=this.aj.U8(c,f),f=Ea.a.Fv(a),this.qd.Xb("MomentaryIncorrectLinkLength",{["Reason"]:"MovedSpaceOutOfLink"}),this.fg.q++,Ea.a.Mz(l,y.substring(0,y.length-1)),Ea.a.Mz(a," "+f),this.aj.yT(c,b)):this.fg.p++)}}}Bxi(a,b,c){for(let f=0;f<a.childNodes.length;f++){const l=a.childNodes[f];if(l.parentNode===a)if(this.Oa.ka("TextLayoutServiceEnableHyperLinkDataLossFix")&&Sys.UI.DomElement.containsCssClass(l,xc.a.Q9))for(let y=0;y<l.childNodes.length;y++)this.IIf(l.childNodes[y],
y,b,a,c)&&y--;else this.IIf(l,f,b,a,c)&&f--}}IIf(a,b,c,f,l){const y=a.parentNode;f=y===f;if(3===a.nodeType){let H=-1;const Q=a.nodeValue;let ia=null,wa="";if(b){const Ua=y.childNodes[b-1];if(rf.a(Ua)&&(!f||Db.ParagraphReader.ae(rf.a(Ua).gb))){for(ia=Ua;ia.lastChild&&1===ia.lastChild.nodeType;)ia=ia.lastChild;wa=ia.innerText+Q}}if(!ia&&b!==y.childNodes.length-1&&(b=y.childNodes[b+1],rf.a(b)&&(!f||Db.ParagraphReader.ae(rf.a(b).gb)))){for(ia=b;ia.firstChild&&1===ia.firstChild.nodeType;)ia=ia.firstChild;
wa=Q+ia.innerText}ia?(H=this.aj.U8(c,y),this.qd.Xb("MomentaryIncorrectFormatting",{["Reason"]:"MovedSpanlessText"}),this.fg.r++,Ea.a.Mz(ia,wa)):(this.qd.Xb("ValidTextDropped",{["Reason"]:"DroppedSpanlessText"}),this.fg.s++);y.removeChild(a);-1!==H&&this.aj.yT(H,l);return!0}return!1}w5k(a,b,c,f){if(z.a.gg&&a.Ki.length){var l=Ea.a.Fv(a.Ki[0].LF),y=a.rIc;l&&y&&l.length===y.length+2?this.Qnh(0,a,b,c,f):2===a.Ki.length&&this.Qnh(1,a,b,c,f)}}Qnh(a,b,c,f,l){c=this.aj.U8(c,f);if((f=Ea.a.Fv(b.Ki[a].LF))&&
f.endsWith("\u00a0 ")){this.fg.t++;var y=f.lastIndexOf("\u00a0 ");f=f.substr(0,y)+" ";b.Ki[a].LF.innerText=f;(0<a?c-(b.Ki[0].UKc+Ea.a.Fv(b.Ki[0].LF).length):c-b.Ki[0].UKc)>f.length&&c--;this.aj.yT(c,l)}}}Object(m.a)(Ni,"StrayTextCleanupUtils",null,[]);class ph{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd){this.Yha=null;this.WPd=a;this.mpb=b;this.aEd=c;this.qd=f;this.Jia=l;this.Bh=y;this.Uc=H;this.B7=Q;this.ud=ia;this.wf=wa;this.Xk=Ua;this.AC=kb;this.kia=Gb;this.$s=ec;this.WV=dc;this.Pba=
Fc;this.Qb=yc;this.iQa=tc;this.hd=xd}get Jda(){return this.Yha||(this.Yha=Ib.a.instance.qb("Box4.IFormatPainter"))}Emb(a,b){if(!b)return!1;if(this.WPd.fAh)return a.mc.preventDefault(),!0;if(this.mpb.f9a&&this.ud.dva)return this.mpb.f9a=!1,this.aEd.cancelEventAndRestoreEditingSurface(a.mc),!0;this.Jda&&this.Jda.PL&&(this.Jda.PL=!1);this.xAj(a.mc);b=this.qd.Zp(C.a.typing);b.properties.$(lf.a.source,"TextInput");a=this.iFl(a);b.end();return a}iFl(a){this.Jia.fixupAfterMagnifierDrag();if(1===this.Bh.mode){if(this.WV.g1e())this.Uc.setSelection(Od.SelectionFactory.Qg(ge.a.instance.Pa.mb.Va.node,
ge.a.instance.Pa.mb.Va.Sa));else if(this.B7.C1e()){if(this.WV.PNe(a))return!1;this.B7.startHybridTransition()}this.ud.kJ&&this.WV.fWd()}this.Pba.raiseEvent(Kh.a.jFl,a);this.wf.Zaa(!0);this.Xk.S5e=!0;this.AC.FQa(a);this.iQa&&this.iQa.CYl(this.Qb.Zh);this.kia.UHb();this.$s.dZ();return!1}xAj(a){this.ud.gg||"deleteContentBackward"!==a.rawEvent.inputType||(this.Xk.U2d=!this.Xk.n3,this.Xk.U2d&&w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("DeleteFromInputEventIsEnabled")&&(a=ph.dYd.nUc(2,this.Qb.Pi),
a<ph.dYd.zWa&&(a=Od.SelectionFactory.D3(this.Qb.Gg,a,ph.dYd.zWa),w.AFrameworkApplication.Ra.Ka(C.a.uSa,2,a))))}static get dYd(){return ph.aj||(ph.aj=Ib.a.instance.resolve("Box4.ICaretPositionManager"))}}ph.aj=null;ph.wS=null;ph.mI=null;Object(m.a)(ph,"TextInputEventProcessor",null,[]);class Ck{constructor(a,b,c,f,l,y){this.JK=a;this.ud=b;this.mf=c;this.Xk=f;this.Yk=l;this.hd=y}get Qcb(){return this.hd.ig&&this.hd.jz}get fAh(){if(this.JK.B$b||!this.Yk.value.isEditingAllowed&&this.Yk.value.sz&&!this.Qcb)return!0;
if(this.ud.H9){var a=this.mf.u7j;if(0<a){var b=(new Date).getTime();a=b-a;b-=this.Xk.ire;if(500>a&&a<b)return!0}}return!1}}Object(m.a)(Ck,"TextInputHandlerUtils",null,[]);var Rj=d(527),Jk=d(309);class hk{constructor(a,b,c,f){this.Nqa=null;this.ud=a;this.JK=b;this.Pf=c;this.rf=f}onContextMenu(a,b){let c=!1;this.ud.H9&&this.JK.G1c&&(b=this.rf.xvb(this.Pf.Rd,b,this.Pf.Rd.Gka(a),!1),this.rf.Dx(b)&&(c=!0));c?(this.Nqa=a.clientPoint,a=!0):(this.Nqa=null,a=this.Pf.Rd.onContextMenu(a));return a}nnc(a){if(this.ud.H9&&
this.Nqa){const b=Jk.a.R6e;if(a.clientPoint.x>this.Nqa.x+b||a.clientPoint.x<this.Nqa.x-b||a.clientPoint.y>this.Nqa.y+b||a.clientPoint.y<this.Nqa.y-b)this.Nqa=null}return!1}lJb(a){let b=!1;this.ud.H9&&this.Nqa&&(b=this.Pf.Rd.onContextMenu(a),this.Nqa=null);return b}}Object(m.a)(hk,"TouchEventProcessor",null,[]);class Bl{create(a){return new jj(a)}}Object(m.a)(Bl,"TypingActionOperationFactory",null,[1423]);var ie=d(73),df=d(248);class uj{constructor(a,b,c,f,l,y){this.Nuf=0;this.vlf=ha.a.nil;this.GVb=
this.gCc=!1;this.nkf=4===Rc.App.mode;this.FEc=!1;this.H9h=new Pb.a;this.H9h.add(0,C.a.rWe);this.zHc=new Pb.a;this.zHc.add(0,0);this.dmf=a;this.Kob=b;this.Pf=c;this.Ep=f;this.I9h=l;this.gCd=y;this.flf=Object(I.a)(this,this.gal,"reportTypingCharCount");w.AFrameworkApplication.Wga(()=>{this.tdk()});this.gCd&&this.z3k();this.y3k();w.AFrameworkApplication.Ra&&w.AFrameworkApplication.Ra.ra(C.a.rWe,ie.a.frame,vf.ActionManager.Sg,96)}z3k(){this.Ep&&this.Ep.addHandler(vc.a.uy,this.flf)}y3k(){this.Kob&&this.Kob.$yf(Object(I.a)(this,
this.EJc,"afterEditingViewValidateEventHandler"))}qrc(a){this.dmf.value&&0===this.dmf.value.mode||(a=new jj(a),a.end(8),bj.a.getInstance().Cqc(a),zh.a.getInstance().Bqc(a))}x8g(a,b){if(!this.nkf&&Rc.App.Lb&&2===Rc.App.Lb.mode&&b&&b.graphNode&&Db.ParagraphReader.ae(b.graphNode)&&!cg.a(b.graphNode,5)){if(a=b.graphNode.id,a!==this.vlf){if(this.FEc){var c;(c=this.zHc).$(0,c.ga(0)+1);w.AFrameworkApplication.Ra.processAction(C.a.rWe,2);c="Paragraph rendering is blocked";this.I9h&&(c+=", so graph transaction manager is reset",
df.GraphTransactionManager.instance.f0e());ka.ULS.sendTraceTag(38547550,323,15,c)}this.vlf=a;this.FEc=!0}}else this.FEc=!1}EJc(a,b){this.nkf||!b.lN&&!b.gV||(!this.gCc&&this.Pf.Rd&&(this.Pf.Rd.egi(Object(I.a)(this,this.x8g,"onContentEditableViewClick")),this.gCc=!0),this.FEc=!1)}gal(){this.Nuf++}NSl(a,b){a!==b&&(a=String.format("CP changed unexpectedly in browser, expected {0} but was {1}",a,b),ka.ULS.sendTraceTag(18437207,323,15,a))}tdk(){this.GVb||(this.gCd&&(ka.ULS.sendTraceTag(38114780,323,50,
""+this.Nuf),this.wVi(),this.gCd=!1),0<this.zHc.ga(0)&&ka.ULS.sendTraceTag(38536792,323,15,"ParagraphDisappear:{0}",this.zHc.ga(0)),this.vVi(),this.GVb=!0)}wVi(){this.Ep&&this.Ep.removeHandler(vc.a.uy,this.flf)}vVi(){this.Kob&&this.Kob.H7k(Object(I.a)(this,this.EJc,"afterEditingViewValidateEventHandler"));this.gCc&&this.Pf.Rd&&(this.Pf.Rd.L7k(Object(I.a)(this,this.x8g,"onContentEditableViewClick")),this.gCc=!1)}}Object(m.a)(uj,"TypingLogger",null,[1382]);const Xl=a=>{w.AFrameworkApplication.fa.ka("TypingSurveyIsEnabled")&&
(a.execute(b=>{b.sdc("WordTypingSurveyTrigger",null)}),a.execute(b=>{window.setTimeout(()=>{b.logActivity("WordTypingSurveyTrigger",null)},300)}))};class Sj{constructor(a){this.H0c=!1;this.h9a=5;this.t5g=!1;this.CJe=!0;this.mb=a}}Object(m.a)(Sj,"TypingProcessState",null,[]);class bk{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye,Xd,Xf,ug,qg,Fg,qf,bg,Kg,rg){this.Ria=this.Ye=null;this.mnb=!1;this.Gxd=null;this.W3c=0;this.EUb=a;this.Qb=b;this.tGd=c;this.aj=f;this.O5a=l;this.Ep=
y;this.TCc=H;this.EZ=Q;this.FV=ia;this.wf=wa;this.Tqa=Ua;this.Uc=kb;this.MK=Gb;this.kia=ec;this.qd=dc;this.fg=Fc;this.mI=yc;this.Zd=tc;this.Xk=xd;this.Jh=Vd;this.VD=Ld;this.ara=ye;this.Dha=Xd;this.ud=Xf;this.hia=ug;this.Lk=qg;this.$s=Fg;this.y5h=qf;this.lPd=bg;this.ks=Kg;this.hd=rg;this.glf=0;this.Fgf=!1;this.jPj()}iT(a){this.Ye=a}get v2a(){return this.Ria||(this.Ria=Ib.a.instance.qb("Box4.ITextFormattingCommands"))}jLl(){We.c(18437507,306,100,"TypingProcessInternalCalled");const a=this.hd.Htb();
try{this.W3c=0;if(this.Ye.XKk.rKl()||2!==this.wf.mode||!this.wf.isActive||w.AFrameworkApplication.Yg||!this.Qb.Gg||this.tGd.correctBadImeState())return;this.aj.updateCaretPosition(this.wf.mode,this.Qb.Pi);this.O5a.x9e();this.BAi();this.Ep.raiseEvent(vc.a.typingProcess);if(!this.Qb.gSa||(2==Rc.App.mode||sc.a("SkipTypingProcessorDuringComposition"))&&this.ks.isComposing)return;const b=new Sj(this.EZ.Vta(this.FV.O9));if(this.TCc.nUk(b))return;b.H0c||(this.wf.Zaa(!0),b.t5g=!0);this.tUk(b);if(!this.Qb.wWa(this.wf.mode))return;
const c=this.Qb.HW.gb;this.hd.ig&&(c.YHb=this.Uc.Pa.mb.Va.Sa);b.t5g&&N.a.instance.ga(50)&&this.Tqa.value&&this.Tqa.value.Bw&&this.Uc.ZZb();if(b.CJe){try{this.kia.UHb()}catch(f){this.qd.Xb("PossibleEditSurfaceIncorrectSize",{["Reason"]:"MirrorToPageViewCrash"}),this.fg.l++,this.mI.Zs(!1,!1)}this.$s.dZ();this.ks.rGa&&(this.mI.Zs(!0,!0),this.Syi())}}finally{a&&a.dispose()}We.c(18437510,306,100,"TypingProcessInternalExited")}Syi(){Rc.App.Lb.aIj&&Rc.App.Lb.Fdl()}FQa(a){this.TCc.nhh(a);this.mnb||(this.mnb=
!0,this.Zd.Hb(this.Gxd))}kSi(){if(!this.Xk.n3&&!this.Xk.Usa)return!1;const a=!this.Tqa.value||this.Tqa.value.amIAlone?bk.Byj:bk.Ayj,b=this.EUb();-1===this.Xk.q4c&&(this.Xk.q4c=b);return b-this.Xk.q4c<a?(this.Zd.Hb(this.Gxd),this.mnb=!0):!1}typingProcess(){if(this.mnb&&(this.mnb=!1,this.glf++,!this.Zd.Dw&&this.Qb.wWa(this.wf.mode)&&!(this.MK&&this.MK.ubb()||this.kSi()))){var a=this.qd.Zp(C.a.typingProcess);this.jLl();a.end();this.Fgf||this.glf!==bk.tyi||((a=Ib.a.instance.Ia("Common.ISystemInitiatedFeedback"))&&
Xl(a),this.Fgf=!0)}}BAi(){if(this.ks.rGa){if(this.Jh.Bwf())if((this.ud.dG||this.ud.Ho)&&this.VD.O7){const a=this.aj.U8(this.wf.mode,this.Qb.Pi);this.VD.mlb(!1,this.Qb.Pi,this.Jh);this.aj.yT(a,this.Qb.Zh)}else this.VD.mlb(!1,this.Qb.Pi,this.Jh);this.y5h.pAi(this.Qb.Zh.At,this.ara,this.Qb.Zh,this.aj.U8(this.wf.mode,this.Qb.Pi),this.ks.rGa);this.lPd.Bxi(this.Qb.Pi,this.wf.mode,this.Qb.Zh);this.lPd.AVk(this.Jh,this.Qb.Zh,this.wf.mode,this.Qb.Pi);this.Jh.B5k();this.lPd.w5k(this.Jh,this.wf.mode,this.Qb.Pi,
this.Qb.Zh)}}tUk(a){this.Dha.QR?(this.Dha.bOk(),a.CJe=!1):this.hia.instance&&this.hia.instance.Yfe()&&!this.ud.zPb&&(this.ks.rGa&&this.v2a?(this.Tli(a.mb),a.CJe=!1):this.hia.instance.K0a())}Tli(a){if(this.v2a&&this.hia.instance){this.hia.instance.freeze();var b=ge.a.instance.Pa.mb,c=this.Lk.je(15);c.ld(this.Qb.Gg.node);a=Od.SelectionFactory.WN(a,b.Va);this.v2a.DNb(a.Va,!0);this.hia.instance.d6e();this.hia.instance.K0a();this.Qb.Zh&&this.Uc.setSelection(this.EZ.Vta(this.FV.O9));c.dispose();this.wf.Zaa(!0);
this.mI.Zs(!0,!1)}}jPj(){let a=1;z.a.Ho&&(a=w.AFrameworkApplication.fa.wc("Box4TypingTaskTimeEdge",1));this.Gxd=new dd.a(0,1,a,()=>{this.typingProcess()},25)}dispose(){this.Gxd=null}ZAh(a){return this.ud.H9&&a?this.Dha.QR||this.W3c>bk.Yuk||this.hia.instance&&this.hia.instance.Yfe()||this.VD.O7?!0:!1:!1}}bk.Yuk=7;bk.Ayj=250;bk.Byj=2E3;bk.tyi=500;Object(m.a)(bk,"TypingProcessManager",null,[1422,107]);class Ii{constructor(){this.Ma=new Pc.a}KXk(a){this.Ma.raiseEvent("OnDismissPasteFloatie",a)}QXk(){this.Ma.raiseEvent("OnExpandMenuPasteFloatie")}BLb(a){this.Ma.raiseEvent("OnPastedContentUpdated",
a)}xTe(a){this.Ma.raiseEvent("OnShowPasteFloatie",a)}Qgi(a){this.Ma.addHandler("OnPastedContentUpdated",a)}rgi(a){this.Ma.addHandler("OnDismissPasteFloatie",a)}xgi(a){this.Ma.addHandler("OnExpandMenuPasteFloatie",a)}khi(a){this.Ma.addHandler("OnShowPasteFloatie",a)}}Object(m.a)(Ii,"PasteFloatieEventSource",null,[1419,1420,1421]);var Kk=d(892),Ch=d(132),fi=d(325),Lk=d(408),$h=d(229),Yl=d(846);class Cl{constructor(){this.Da=null}get name(){return"Box4.ContentEditableView"}Yb(a){this.Da=a;a.register(Rj.a,
"Box4.TextNodeCombiner").as("Box4.ITextNodeCombiner").ma().oa(()=>new Rj.a);a.register(ne,"Box4.ContentEditableDomFactory").as("Box4.IContentEditableDomFactory").ma().oa(()=>new ne);a.register(Ih,"Box4.EventFrequencyTracker").ma().oa(()=>new Ih);a.register(Ne,"Box4.CevUsageDataTracker").ma().oa(()=>new Ne);a.register(Oa,"Box4.ContentEditableViewEventSource").ma().oa(()=>new Oa);a.register(gh,"Box4.CurrentlyActiveContentSpans").as("Box4.ICurrentlyActiveContentSpans").ma().oa(()=>new gh(mc.a.instance,
Zd.a.instance.I9d(),a.resolve("Box4.TextNodeCombiner")));a.register(ak,"Box4.OriginalElementContentArray").as("Box4.IOriginalElementContentArray").ma().oa(()=>new ak(mc.a.instance,Zd.a.instance.I9d(),kg.instance,a.resolve("Box4.IContentEditableViewContentControlHelper")));a.register(ag,"Box4.EditingDomManager").as("Box4.IEditingDomManager").ma().oa(()=>new ag);a.register(pc,"Box4.EditStateEventManager").as("Box4.IEditStateEventManager").ma().oa(()=>new pc(a.resolve("Box4.IEditingDomManager")));a.register(Pg,
"Box4.ContentEditableViewPaddingManager").as("Box4.IContentEditableViewPaddingManager").ma().oa(()=>new Pg(a.resolve("Box4.EditStateEventManager"),mc.a.instance,a.resolve("Box4.CevUsageDataTracker").KI,a.resolve("Box4.EditingDomManager"),a.resolve("Common.IAppSettingsManager").ka("RemovePaddingHighlightEnabled")));a.register(1382,"Box4.ITypingLogger").ma().oa(()=>new uj(a.oe("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ContentEditableViewEventSource"),sa.InteractiveViewManager.instance,a.resolve("Box4.EditStateEventManager"),
a.resolve("Common.IAppSettingsManager").ka("QoETypingImprovementIsEnabled"),a.resolve("Common.IAppSettingsManager").ka("QoECharCountIsEnabled")));a.register(Lc,"Box4.CaretPositionManager").as("Box4.ICaretPositionManager").ma().oa(()=>new Lc(a.oe("Box4.ITextNodeCombiner"),mc.a.instance,a.resolve("Box4.CevUsageDataTracker").KI,a.resolve("Box4.EditingDomManager"),kg.instance,Qc.a.instance,sa.InteractiveViewManager.instance,w.AFrameworkApplication.Ae,Qc.a.instance.Vi,Kk.a.instance,a.resolve("Common.IScrollLockFactory"),
a.resolve("Box4.IContentEditableViewContentControlHelper"),a.resolve("Box4.ITypingLogger")));a.register(Yg,"Box4.ContentEditableViewFocusHelper").as("Box4.IContentEditableViewFocusHelper").ma().oa(()=>new Yg(a.resolve("Box4.EditingDomManager"),sa.InteractiveViewManager.instance,a.resolve("Box4.IExternalSelectionManager"),Qc.a.instance.Vi,td.a.instance,Qc.a.instance,v.FocusManager.instance()));a.register(ch,"Box4.ReadOnlyObjectsCleaner").ma().oa(()=>new ch(mc.a.instance,a.resolve("Box4.CevUsageDataTracker").KI,
a.resolve("Box4.CaretPositionManager"),kg.instance,Qc.a.instance));a.register(Ni,"Box4.StrayTextCleanupUtils").ma().oa(()=>new Ni(w.AFrameworkApplication.fa,a.resolve("Box4.CaretPositionManager"),mc.a.instance,a.resolve("Box4.CevUsageDataTracker").KI));a.register(1383,"Box4.IContentEditableViewContentControlHelper").ma().oa(()=>new Qi(mc.a.instance,a.resolve("Box4.CevUsageDataTracker").KI,Qc.a.instance.Vi,kg.instance,sa.InteractiveViewManager.instance,a.resolve("Box4.IParagraphReader")));a.register(ef,
"Box4.ActiveContentSpansPersistanceManager").as("Box4.IActiveContentSpansPersistanceManager").ma().oa(()=>new ef(a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.CevUsageDataTracker").KI,mc.a.instance,a.qb("Box4.IHyperlinkEditor"),Qc.a.instance,a.resolve("Box4.IContentEditableViewContentControlHelper"),Kk.a.instance,a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IEditViewStateManager"),
a.resolve("Common.IAppSettingsManager")));a.register(Xc,"Box4.CevViewContentManager").as("Box4.ICevViewContentManager").ma().oa(()=>new Xc(a.Ia("Common.ITypingSpeedMeterProvider"),sa.InteractiveViewManager.instance));a.register(Ej,"Box4.ContentEditableViewTypingState").ma().oa(()=>new Ej(w.AFrameworkApplication.Ra));a.register(Af,"Box4.ContentEditableHtmlStructureUtils").ma().oa(()=>new Af(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.ContentEditableViewTypingState")));a.register(kj,"Box4.SequenceCodeHelper").ma().oa(()=>
new kj(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IConstantsProvider").Dvh));a.register(kk,"Box4.SelectContentHelper").ma().oa(()=>new kk(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.SequenceCodeHelper"),a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.CevUsageDataTracker").KI,mc.a.instance,a.oe("Box4.ITextNodeCombiner"),ge.a.instance,a.resolve("Box4.ICaretPositionManager"),kg.instance,Qc.a.instance,Md.EventHandlerManager.instance,fi.a.instance,sa.InteractiveViewManager.instance,
Qc.a.instance.Vi,a.resolve("Common.ScrollLockFactory"),Kk.a.instance,a.resolve("Box4.IParagraphReader"),Zb.ListReader.Fx,a.resolve("Box4.IContentEditableViewContentControlHelper"),a.resolve("Common.IAppSettingsManager").ka("FixUpEmptySpanInSelectionBeginIsEnabled")));a.register(he,"Box4.EditingDomDisplayManipulator").ma().oa(()=>new he(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.SelectContentHelper"),
w.AFrameworkApplication.fa,sa.InteractiveViewManager.instance));a.register(Kc,"Box4.EditViewStateManager").as("Box4.IEditViewStateManager").ma().oa(()=>new Kc(a.resolve("Box4.ContentEditableViewEventSource")));a.register(hb,"Box4.InteractiveViewSynchronizer").ma().oa(()=>new hb(a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.CevUsageDataTracker").KI,mc.a.instance,Qc.a.instance.Vi,a.resolve("Box4.Graph.IGraphIteratorFactory"),kg.instance,sa.InteractiveViewManager.instance,a.resolve("Box4.IEditViewStateManager"),
a.resolve("Box4.ICevViewContentManager")));a.register(Hh,"Box4.CurrentEditSelectionProvider").ma().oa(()=>new Hh(a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.CevUsageDataTracker").KI,mc.a.instance,kg.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),Qc.a.instance.Vi,a.resolve("Box4.IContentEditableViewContentControlHelper")));a.register(Nd,"Box4.BackspaceInBrowserHandler").ma().oa(()=>new Nd(a.resolve("Box4.CurrentEditSelectionProvider"),Qc.a.instance.Vi,
bh.a.instance,fi.a.instance,a.resolve("Box4.IExternalSelectionManager"),$h.a.instance,w.AFrameworkApplication.fa.ka("PPTLineBoxEnabled"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IHyperlinkStrategy"),w.AFrameworkApplication.fa.ka("AutoCorrectUndoByBackspaceIsEnabled")?a.Ia("Box4.IAutoCorrectScheduler"):null));a.register(tj,"Box4.OvertypeDomPreparer").ma().oa(()=>new tj(a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.ContentEditableViewPaddingManager"),
ge.a.instance,mc.a.instance,a.resolve("Box4.CevUsageDataTracker").KI,kg.instance,Qc.a.instance.Vi,a.resolve("Box4.IContentEditableViewContentControlHelper")));a.register(Ie,"Box4.CutCopyHandler").as("Box4.ICutCopyHandler").ma().oa(()=>new Ie(fi.a.instance,ge.a.instance,mc.a.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.EditStateEventManager"),sa.InteractiveViewManager.instance,a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.ICevViewContentManager"),Qc.a.instance,
a.resolve("Box4.SelectContentHelper"),new Bb.a(()=>Rc.App.Lb.Kd),a.Ia("Box4.IClipboardCommands"),a.resolve("Box4.ICannotCutDialog"),a.resolve("Common.IDelayOperationFactory"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("Box4.IEditingDomManager"),w.AFrameworkApplication.fa,w.AFrameworkApplication.Ra,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(Ii,"Box4.PasteFloatieEventSource").as("Box4.IPasteFloatieEventSource").as("Box4.IPasteFloatieEventHandler").as("Box4.IPasteFloatieEventNotifier").ma().oa(()=>
new Ii);a.register(Gf,"Box4.BackspaceDeleteEventSource").as("Box4.IBackspaceDeleteEventSource").as("Box4.IBackspaceDeleteEventNotifier").ma().oa(()=>new Gf);a.register(si,"Box4.BoundsSynchronizer").as("Box4.IBoundsSynchronizer").ma().oa(()=>new si(a.Ia("Box4.IListMarkerUtility"),a.resolve("Box4.IEditingDomManager"),a.Ia("Common.IZoomManager"),a.resolve("Box4.EditingDomDisplayManipulator"),Qc.a.instance,sa.InteractiveViewManager.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),
a.resolve("Box4.IRotatingCoordinateConverter")));a.register(Le,"Box4.EditingSurfaceStateManager").ma().oa(()=>new Le);a.register(Tg,"Box4.EditingModeTransitionManager").as("Box4.IEditingModeTransitionManager").ma().oa(()=>new Tg(a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.EditingDomDisplayManipulator"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.EditingSurfaceStateManager"),w.AFrameworkApplication.Ae,a.resolve("Box4.IEditingDomManager"),
a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ContentEditableViewFocusHelper"),new Bb.a(()=>Rc.App.Lb.Kd),Qc.a.instance,a.resolve("Box4.IContentEditableViewPaddingManager"),ge.a.instance,a.resolve("Box4.IExternalSelectionManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),sa.InteractiveViewManager.instance,fi.a.instance,a.resolve("Box4.IInteractiveEventHandler"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(Nl,"Box4.ParagraphOverlayPositioner").ma().oa(()=>
new Nl(a.resolve("Box4.IEditingDomManager"),new Yl.a,sa.InteractiveViewManager.instance,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.IParagraphOverlayControlRenderer")));a.register(Bg,"Box4.ContentEditableViewDebugLogger").ma().oa(()=>new Bg);a.register(Ra,"Box4.ImeRecoveryUtils").ma().oa(()=>new Ra(Qc.a.instance,a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.Graph.IGraphTransactionFactory"),
mc.a.instance,a.resolve("Box4.CevUsageDataTracker").KI,a.resolve("Box4.ContentEditableViewDebugLogger"),Kk.a.instance));a.register(nd,"Box4.AutocorrectActionExecutor").ma().oa(()=>new nd(a.Ia("Box4.IAutoCorrectScheduler"),a.Ia("Box4.IAutoCorrectRules"),a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.CaretPositionManager"),
a.oe("Box4.IUndoManager"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.Graph.IGraphTransactionFactory"),ge.a.instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance));a.register(Zh,"Box4.PasteHandler").as("Box4.IPasteHandler").ma().oa(()=>new Zh(a.resolve("Common.IAppSettingsManager"),w.AFrameworkApplication.Ae,mc.a.instance,
a.resolve("Box4.Graph.IGraphTransactionFactory"),ge.a.instance,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.EditingDomDisplayManipulator"),sa.InteractiveViewManager.instance,Qc.a.instance,a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.CevViewContentManager"),a.resolve("Box4.AutocorrectActionExecutor"),new Bb.a(()=>Rc.App.Lb.Kd),a.Ia("Box4.IClipboardCommands"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("Box4.IFileReaderHelperFactory"),
a.resolve("Common.IDelayOperationFactory"),a.resolve("Common.ISimpleOperationFactory"),a.resolve("Box4.IProcessImageStrategy"),w.AFrameworkApplication.Ra,Pd.a.get_instance(),()=>new Be.a,a.resolve("Box4.IPasteFloatieEventSource"),a.resolve("Common.Utils.Telemetry.ITelemetry"),Rc.App.instance.bbc,Rc.App.instance.tOb));a.register(Wh,"Box4.ContentEditableViewCursorManager").ma().oa(()=>new Wh(sa.InteractiveViewManager.instance,mc.a.instance,a.resolve("Box4.CevUsageDataTracker").KI,Qc.a.instance.Vi,ge.a.instance,
fi.a.instance,a.resolve("Box4.IExternalSelectionManager"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.ICevViewContentManager"),new Bb.a(()=>Rc.App.Lb.Kd),w.AFrameworkApplication.Ra,a.resolve("Box4.IEditViewStateManager"),w.AFrameworkApplication.Ae,Qc.a.instance,a.resolve("Box4.ICaretPositionManager"),kg.instance,a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.IContentEditableViewFocusHelper"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IContentEditableViewPaddingManager"),
new fe,a.resolve("Box4.IContentEditableViewContentControlHelper"),a.qb("Box4.CharacterPointConverter")));a.register(Vi,"Box4.SelectionChangeHandler").as("Box4.ISelectionChangeHandler").ma().oa(()=>new Vi(a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.IEditingDomManager"),w.AFrameworkApplication.Ae,Kk.a.instance,kg.instance,ge.a.instance,a.resolve("Box4.SelectContentHelper"),
a.resolve("Box4.ContentEditableViewCursorManager"),mc.a.instance,a.resolve("Box4.CevUsageDataTracker").KI,new Bb.a(()=>Rc.App.Lb.Kd),Qc.a.instance.Vi,a.resolve("Box4.ContentEditableHtmlStructureUtils")));a.register(Sh,"Box4.HybridTransitionManager").as("Box4.IHybridTransitionManager").ma().oa(()=>new Sh(a.resolve("Box4.OvertypeDomPreparer"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.EditStateEventManager"),a.oe("Box4.IUndoManager"),a.resolve("Box4.EditingDomDisplayManipulator"),
a.resolve("Box4.Graph.GraphTransactionFactory"),a.resolve("Box4.CevViewContentManager"),sa.InteractiveViewManager.instance,w.AFrameworkApplication.Ae,new Bb.a(()=>Rc.App.Lb.Kd),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),ge.a.instance,bh.a.instance));a.register(fd,"Box4.CompositionStateManager").ma().oa(()=>
new fd(a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.HybridTransitionManager")));a.register(ya,"Box4.ImeManager").ma().oa(()=>new ya(a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),sa.InteractiveViewManager.instance));a.register(Yh,"Box4.DragStateManager").ma().oa(()=>new Yh(Qc.a.instance));a.register(hk,"Box4.TouchEventProcessor").ma().oa(()=>
new hk(Qc.a.instance,a.resolve("Box4.ContentEditableViewFocusHelper"),sa.InteractiveViewManager.instance,fi.a.instance));a.register(Cb,"Box4.AppFrameResizeEventProcessor").ma().oa(()=>new Cb(a.resolve("Box4.BoundsSynchronizer")));a.register(Wc,"Box4.OnScrollProcessor").ma().oa(()=>new Wc(a.resolve("Box4.CevUsageDataTracker").KI,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.BoundsSynchronizer")));a.register(Li,"Box4.EditingSurfaceEventHandlerUtils").ma().oa(()=>
new Li(mc.a.instance,a.resolve("Box4.CevUsageDataTracker").KI,a.resolve("Box4.IEditingModeTransitionManager")));a.register(Fj,"Box4.DragEventsProcessor").ma().oa(()=>new Fj(Qc.a.instance,a.resolve("Box4.DragStateManager"),a.resolve("Box4.EditingSurfaceEventHandlerUtils")));a.register(yi,"Box4.DoubleClickProcessor").ma().oa(()=>new yi(a.resolve("Box4.CaretPositionManager"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.CevViewContentManager"),sa.InteractiveViewManager.instance));a.register(eg,
"Box4.DomChangeEventProcessor").ma().oa(()=>new eg(Qc.a.instance,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.CompositionStateManager"),mc.a.instance,a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.BoundsSynchronizer"),w.AFrameworkApplication.fa.ka("SkipUpdateGraphWhenComposing")));a.register(Ck,"Box4.TextInputHandlerUtils").ma().oa(()=>new Ck(a.resolve("Box4.IContentEditableViewFocusHelper"),Qc.a.instance,Md.EventHandlerManager.instance,
a.resolve("Box4.ContentEditableViewTypingState"),new Bb.a(()=>Rc.App.Lb.Kd),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(Zj,"Box4.ContentEditableViewGraphUpdater").ma().oa(()=>new Zj(Mf.a.instance,a.resolve("Box4.EditingModeTransitionManager"),mc.a.instance,ge.a.instance,a.resolve("Box4.IExternalSelectionManager"),fi.a.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.Graph.GraphIteratorFactory"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ContentEditableViewTypingState"),
a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.EditingDomManager"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.EditingSurfaceStateManager"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.CharacterPropertiesEditor"),a.resolve("Box4.ISelectionChangeHandler"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ParagraphOverlayPositioner"),
a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.CevUsageDataTracker").KI,a.resolve("Box4.HybridTransitionManager"),w.AFrameworkApplication.Ae,Qc.a.instance,a.Ia("Box4.IInsertionPointFormatting"),a.resolve("Box4.IActiveContentSpansPersistanceManager"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.Graph.GraphTransactionFactory"),a.resolve("Box4.Proofing.IModifiedRangeEditor"),a.qb("Box4.CharacterPointConverter"),a.resolve("Box4.ITypingLogger")));a.register(Pa,"Box4.KeyEntryProcessor").ma().oa(()=>
new Pa(kg.instance,a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.CevUsageDataTracker").KI,mc.a.instance,Qc.a.instance.Vi,a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.ContentEditableViewGraphUpdater"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.ContentEditableViewCursorManager"),fi.a.instance,a.resolve("Box4.ContentEditableViewTypingState"),
a.resolve("Box4.EditViewStateManager")));a.register(ce,"Box4.KeyQueueProcessor").ma().oa(()=>new ce(a.resolve("Box4.KeyEntryProcessor"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),fi.a.instance,ge.a.instance,a.resolve("Box4.ContentEditableViewGraphUpdater"),a.resolve("Box4.ICaretPositionManager")));a.register(bk,"Box4.TypingProcessManager").as("Box4.ITypingProcessManager").ma().oa(()=>new bk(Bd.a.vj,a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ImeRecoveryUtils"),
a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ParagraphOverlayPositioner"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.KeyQueueProcessor"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.EditViewStateManager"),new Bb.a(()=>Rc.App.Mh),ge.a.instance,a.resolve("Box4.IExternalSelectionManager"),a.resolve("Box4.InteractiveViewSynchronizer"),mc.a.instance,a.resolve("Box4.CevUsageDataTracker").KI,a.resolve("Box4.ContentEditableViewGraphUpdater"),
w.AFrameworkApplication.Ae,a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.AutocorrectActionExecutor"),Qc.a.instance,a.Ia("Box4.IInsertionPointFormatting"),a.resolve("Box4.Graph.GraphTransactionFactory"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.ReadOnlyObjectsCleaner"),a.resolve("Box4.StrayTextCleanupUtils"),a.resolve("Box4.CompositionStateManager"),
a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(Mi,"Box4.OvertypeUtils").ma().oa(()=>new Mi(new jd(w.AFrameworkApplication.Ae),a.resolve("Box4.EditingModeTransitionManager"),Qc.a.instance,ge.a.instance,a.resolve("Box4.ITypingLogger"),fi.a.instance,new Bb.a(()=>Rc.App.Lb.Kd),sa.InteractiveViewManager.instance,a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.HybridTransitionManager"),Qc.a.instance.Vi,a.resolve("Box4.CevViewContentManager"),a.resolve("Box4.SelectContentHelper"),
a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance));a.register(Yj,"Box4.ContentEditableViewFloatieHandler").ma().oa(()=>new Yj);a.register(Xe,"Box4.KeyUpProcessor").ma().oa(()=>new Xe(mc.a.instance,a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.ICevViewContentManager"),new Bb.a(()=>Rc.App.Lb.Kd),
a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.KeyQueueProcessor"),a.resolve("Box4.EditingDomManager"),a.resolve("Box4.ContentEditableViewFloatieHandler"),a.resolve("Box4.TypingProcessManager")));const b=!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("TableEditingSelectIsEnabled");a.register(kd,"Box4.KeyPressProcessor").ma().oa(()=>new kd(Qc.a.instance,Kk.a.instance,mc.a.instance,a.resolve("Box4.ISelectionChangeHandler"),new Bb.a(()=>
Rc.App.Lb.Kd),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.IHybridTransitionManager"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.EditViewStateManager"),ge.a.instance,a.resolve("Box4.EditingDomManager"),a.resolve("Box4.EventFrequencyTracker"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.AutocorrectActionExecutor"),kg.instance,a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),new Bb.a(()=>
Rc.App.Mh),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.ContentEditableViewEventSource"),a.Ia("Common.ITypingSpeedMeterProvider"),b,Ch.ContextSetEditor.instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.qb("Common.IEventTimingMeter")));a.register(Aa,"Box4.KeyDownProcessor").ma().oa(()=>new Aa(a.Ia("Common.ITypingSpeedMeterProvider"),Qc.a.instance.Vi,w.AFrameworkApplication.Ae,
a.resolve("Box4.IEditingDomManager"),mc.a.instance,a.resolve("Box4.CevUsageDataTracker").KI,a.resolve("Box4.ITypingLogger"),a.resolve("Box4.ISelectionChangeHandler"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ICaretPositionManager"),Qc.a.instance,Kk.a.instance,a.resolve("Box4.CurrentEditSelectionProvider"),fi.a.instance,a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.ContentEditableViewGraphUpdater"),new Bb.a(()=>
Rc.App.Mh),ge.a.instance,a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.CompositionStateManager"),a.oe("Box4.IUndoManager"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.CharacterPropertiesEditor"),new Bb.a(()=>Rc.App.Lb.Kd),a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.ContentEditableViewFloatieHandler"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.ImeManager"),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.BackspaceInBrowserHandler"),w.AFrameworkApplication.fa.ka("SkipUpdateGraphWhenComposing"),
a.resolve("Box4.Graph.IGraphTransactionFactory"),w.AFrameworkApplication.Ra,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,a.qb("Common.IEventTimingMeter"),a.resolve("Box4.IRotatingCoordinateConverter"),Lk.a.instance,a.resolve("Box4.IPasteFloatieEventSource"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.IBackspaceDeleteEventSource"),w.AFrameworkApplication.fa.ka("AutoCorrectUndoByBackspaceIsEnabled")?
a.Ia("Box4.IAutoCorrectScheduler"):null,w.AFrameworkApplication.fa,a.qb("Box4.IHyperlinkEditor")));a.register(ki,"Box4.ContentEditableViewOnAfterValidateHandler").ma().oa(()=>new ki(a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.CevViewContentManager"),sa.InteractiveViewManager.instance,a.resolve("Box4.EditingDomManager"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.ContentEditableViewDebugLogger"),
a.resolve("Box4.IContentEditableViewPaddingManager"),Qc.a.instance,a.resolve("Box4.CevUsageDataTracker").KI,a.resolve("Box4.IParagraphReader"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.oe("Box4.ITextNodeCombiner"),a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.IContentEditableViewFocusHelper"),a.resolve("Box4.ParagraphOverlayPositioner"),ge.a.instance,Qc.a.instance.Vi,a.resolve("Box4.SelectContentHelper"),new Bb.a(()=>Rc.App.Lb.Kd),
a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.qb("Box4.ITabRenderer"),a.resolve("Box4.IPasteFloatieEventSource"),a.qb("Box4.IFeatureHelper"),w.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")));a.register(xi,"Box4.ContentEditableViewOnBeforeValidateHandler").ma().oa(()=>new xi(a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.ContentEditableViewDebugLogger"),a.resolve("Box4.CompositionStateManager"),
a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.EditStateEventManager")));a.register(bd,"Box4.CompositionEventProcessor").ma().oa(()=>new bd(a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.TextInputHandlerUtils"),mc.a.instance,a.resolve("Box4.ImeRecoveryUtils"),a.resolve("Box4.ITypingLogger"),a.resolve("Box4.SelectionChangeHandler"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.EditViewStateManager"),
a.resolve("Box4.ImeManager"),a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.OvertypeUtils"),w.AFrameworkApplication.fa.ka("SkipUpdateGraphWhenComposing")));a.register(ph,"Box4.TextInputEventProcessor").ma().oa(()=>new ph(a.resolve("Box4.TextInputHandlerUtils"),a.resolve("Box4.DragStateManager"),a.resolve("Box4.EditingSurfaceEventHandlerUtils"),mc.a.instance,a.resolve("Box4.SelectionChangeHandler"),a.resolve("Box4.EditingModeTransitionManager"),
ge.a.instance,a.resolve("Box4.HybridTransitionManager"),Qc.a.instance,a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.ICevViewContentManager"),a.qb("Box4.ITabRenderer"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(rd,
"Box4.LostFocusEventProcessor").ma().oa(()=>new rd(a.resolve("Box4.ContentEditableViewGraphUpdater")));a.register(li,"Box4.EditingSurfaceEventHandlerManager").ma().oa(()=>new li(w.AFrameworkApplication.Ae,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.KeyUpProcessor"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.KeyPressProcessor"),a.resolve("Box4.KeyDownProcessor"),a.resolve("Box4.CompositionEventProcessor"),a.resolve("Box4.TextInputEventProcessor"),
a.resolve("Box4.DragEventsProcessor"),a.resolve("Box4.PasteHandler"),a.resolve("Box4.CutCopyHandler"),a.resolve("Box4.DomChangeEventProcessor"),a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.TouchEventProcessor"),a.resolve("Box4.DoubleClickProcessor"),a.resolve("Box4.OnScrollProcessor"),a.resolve("Box4.AppFrameResizeEventProcessor"),a.resolve("Box4.LostFocusEventProcessor"),a.resolve("Box4.SelectionChangeHandler"),a.resolve("Box4.CaretPositionManager")));
a.register(oh,"Box4.ContentEditableViewDisposer").ma().oa(()=>new oh(a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.CurrentlyActiveContentSpans"),a.resolve("Box4.EventFrequencyTracker"),a.resolve("Box4.CevUsageDataTracker").KI,a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.EditingModeTransitionManager")));a.register(Bl,"Box4.TypingActionOperationFactory").as("Box4.ITypingActionOperationFactory").ma().oa(()=>new Bl);a.register(1384,
"Box4.IContentEditableModeHelper").ma().oa(()=>new Wf);a.register(ji,"Box4.ContentEditableView").as("Box4.IEditingView").ma().oa(()=>new ji(sa.InteractiveViewManager.instance,ge.a.instance,new Bb.a(()=>Rc.App.Lb.Kd),a.Ia("Common.IActivityAggregationInfo"),a.Ia("Common.IZoomManager"),w.AFrameworkApplication.Ra,a.resolve("Box4.IHtmlViewRootFactory"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.ContentEditableViewFocusHelper"),
a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.SequenceCodeHelper"),a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.EditingDomDisplayManipulator"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.EditingSurfaceStateManager"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.ParagraphOverlayPositioner"),a.resolve("Box4.IPasteHandler"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.ImeManager"),a.resolve("Box4.ContentEditableViewGraphUpdater"),
a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.ContentEditableViewFloatieHandler"),a.resolve("Box4.ContentEditableViewOnAfterValidateHandler"),a.resolve("Box4.ContentEditableViewOnBeforeValidateHandler"),a.resolve("Box4.EditingSurfaceEventHandlerManager"),a.resolve("Box4.ContentEditableViewDisposer"),a.resolve("Box4.IInteractiveEventHandler"),a.resolve("Box4.IContentEditableDomFactory"),Rc.App.MMa,a.resolve("Box4.IContentEditableModeHelper")))}init(){this.Da.resolve("Box4.EditingModeTransitionManager").F0b(this.Da.resolve("Box4.ContentEditableView"));
this.Da.resolve("Box4.BoundsSynchronizer").F0b(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.ImeRecoveryUtils").F0b(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.AutocorrectActionExecutor").iT(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.ContentEditableViewCursorManager").Epi(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.SelectionChangeHandler").iT(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.HybridTransitionManager").iT(this.Da.resolve("Box4.ContentEditableView"));
this.Da.resolve("Box4.ContentEditableViewGraphUpdater").iT(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.TypingProcessManager").iT(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.ContentEditableViewOnAfterValidateHandler").iT(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.ContentEditableViewOnBeforeValidateHandler").iT(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.EditingSurfaceEventHandlerManager").iT(this.Da.resolve("Box4.ContentEditableView"));
this.Da.resolve("Box4.CompositionEventProcessor").iT(this.Da.resolve("Box4.ContentEditableView"))}dispose(){}static main(){n.a.instance.Ac(new Cl)}}Object(m.a)(Cl,"ContentEditableViewPackage",null,[2,3]);class ol{get name(){return"PowerPointWebEditor.AutoFit"}Yb(){}init(){}dispose(){}static main(){n.a.instance.Ac(new ol)}}Object(m.a)(ol,"PPTWebEditorAutoFitPackage",null,[2,3]);class Zk{constructor(a){this.rI=a}}Object(m.a)(Zk,"DynamicScriptLoaderProvider",null,[1574]);var lk=d(358),$k=d(249),cj=d(315);
const fg=(a,b)=>{var c=al(b);c=a.identifier+c+".js";let f="";f=a.isLocalized?f+(w.AFrameworkApplication.lcid+"/"):f+gi(b);return f+c},al=()=>w.AFrameworkApplication.fa.ka("IsCombinedBundleEnabled")?"":w.AFrameworkApplication.fa.Lu("IsServerFlavorDebug")?w.AFrameworkApplication.fa.ka("IsServerFlavorDebug")?"":".min":".min",gi=a=>a&&w.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")&&!w.AFrameworkApplication.fa.ka("AppChromeOverrideIsCombinedBundle")&&!w.AFrameworkApplication.fa.ka("IsCombinedBundleEnabled")?
"exp/":"",rm=(a="anonymous",b="dynamicScriptLoaderDependencies")=>{const c={resolveScript:f=>{var l=lk.AppChromeOverrideUtilities.npg(c.knownScripts,f.identifier);if(lk.AppChromeOverrideUtilities.isEnabled&&l)l=f.isLocalized?lk.AppChromeOverrideUtilities.W8f(w.AFrameworkApplication.lcid):lk.AppChromeOverrideUtilities.PMb,f.isLocalized||(l+=gi(!0)),f=l+f.identifier+lk.AppChromeOverrideUtilities.zSc+".js";else if(cj.a.instance.isEnabled){var y=w.AFrameworkApplication.Hpa;f=fg(f,l);cj.a.instance.isEnabled&&
(l=cj.a.instance.nae(w.AFrameworkApplication.L1+f))&&(y=l+w.AFrameworkApplication.L1);ka.ULS.sendTraceTag(592228695,306,50,"Dynamic loading hashed resource for "+f);f=y+f}else if(y=al(l),w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ScriptUrlFromNameNewIsEnabled",!1))f.isLocalized?f=w.AFrameworkApplication.lj(f.identifier+y,3):(f=gi(l)+f.identifier,f=w.AFrameworkApplication.lj(f+y+".js",5));else{var H=w.AFrameworkApplication.Hpa;H=f.isLocalized?
H+(w.AFrameworkApplication.lcid+"/"):H+gi(l);f=H+f.identifier+y+".js"}return f},resolveSriHash:f=>{const l=lk.AppChromeOverrideUtilities.npg(c.knownScripts,f.identifier);cj.a.instance.isEnabled?(f=fg(f,l),f=cj.a.instance.$sj(w.AFrameworkApplication.L1+f)):f=null;return f}};c.crossOriginAttributeValue=a;c.knownScripts=window[b];return c};var xa=d(28),Ff=d(661);class Ri{constructor(){this.hCe=this.U$=this.K=null;this.UJg=this.rHg=!1}get name(){return"PowerPointWebEditor.DynamicScriptLoader"}Yb(a){if(!a)throw Error.argumentNull("container");
this.K=a;this.U$=this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory");this.K.register(Zk,"Common.DynamicScriptLoaderProvider").as("Common.IDynamicScriptLoaderProvider").ma().oa(()=>{var b=window.self.EarlyDynamicScriptLoader;if(void 0===b||null===b){b=rm();if(Ff.a.LXj){const c=b.resolveScript;b.resolveScript=f=>{let l=Ff.a.T7e(f.identifier+(lk.AppChromeOverrideUtilities.isEnabled?lk.AppChromeOverrideUtilities.zSc:".min")+".js");l||(l=c(f));return l}}this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptUseManagedScriptResourceLoading&&
(b.loadScriptHandler=Object(I.a)(this,this.loadScript,"loadScript"));return new Zk(new dynamicScriptLoader.DynamicScriptLoader(b))}w.AFrameworkApplication.fa.ka("EnableDefaultDSLImpl")||b.Gaf&&b.Gaf(Object(I.a)(this,this.loadScript,"loadScript"));return new Zk(b)});this.rHg=w.AFrameworkApplication.fa.ka("EarlyLazySprite");this.UJg=w.AFrameworkApplication.fa.ka("RibbonShimmerExperimentEnabled");w.AFrameworkApplication.fa.ka("LoadSLideGridJSEarly")&&Ri.bsc.push("slidegrid");Ri.bsc.push("comment-pane-strings");
Ri.bsc.push("sharedcomments");Ri.bsc.push("floatingcontainermanager")}loadScript(a,b){let c=this.hCe;c&&c.isCompleted&&(this.hCe=c=null);const f=this.rHg&&Array.contains(Ri.bsc,a),l=w.AFrameworkApplication.fa.ka("BootFilesInDelayScriptFactory")&&Array.contains(Ri.Udl,a)?this.U$.QJi(b,Array.contains(Ri.sth,a),!(this.UJg&&Array.contains(Ri.qel,a))):this.U$.m1d(b,null,Array.contains(Ri.sth,a));f||(this.hCe=l.IGa);return new Promise((y,H)=>{const Q=Date.now(),ia=()=>{l.IGa.continueWith(wa=>{if(6===wa.status)y(a);
else{let Ua=String.format("Failed to download the script with identifier: {0} at url: {1}.",a,b);wa.ej&&(Ua+=" "+wa.ej.message);H(Error.create(Ua))}});xa.a.J(508908375,813,50,"LoadScript:: Identifier:{0}, DelayInMs:{1}",a,Date.now()-Q);$k.a.oy(l)};!c||f?ia():c.continueWith(()=>{ia()})})}init(){}dispose(){}}Ri.sth=["common","powerpoint-ribbon-intl","appChrome"];Ri.bsc="ppt-ribbon-sprite-lazy ppt-ribbon-mlr-sprite-lazy powerpoint-ribbon-intl-lazy powerpoint-ribbon-mlr-intl-lazy powerpoint-ribbon-intl powerpoint-ribbon-mlr-intl appchrome".split(" ");
Ri.Udl="common common50 ppt-ribbon-sprite-lazy ppt-ribbon-mlr-sprite-lazy powerpoint-ribbon-intl-lazy powerpoint-ribbon-mlr-intl-lazy powerpoint-ribbon-intl powerpoint-ribbon-mlr-intl appchrome".split(" ");Ri.qel=["common","appchrome"];Object(m.a)(Ri,"DynamicScriptLoaderPackage",null,[2,3]);var vj=d(152),Hg=d(106),ua=d(173),eb=d(33);class Tb{constructor(a,b,c){this.la=a;this.Ya=b;this.Su=c}a3f(a){return Object(vj.a)(this,void 0,void 0,function*(){try{a.RequestOptions.CorrelationId||(a.RequestOptions.CorrelationId=
Hg.a.create().toString());xa.a.J(509214920,817,15,`CopilotProxy::generatePPTFromOutline: ${JSON.stringify({Correlation:a.RequestOptions.CorrelationId,ClientName:a.RequestOptions.ClientName,MergeAction:a.RequestOptions.MergeAction,InsertPosition:a.RequestOptions.InsertPosition})}`);const b=yield this.T8d(a.OutlineInput,a.RequestOptions);return yield this.EIe(b,a.RequestOptions)}catch(b){return xa.a.J(509214918,817,10,`CopilotProxy::generatePPTFromOutline: ${JSON.stringify({Error:b,Correlation:a.RequestOptions.CorrelationId,
ClientName:a.RequestOptions.ClientName,MergeAction:a.RequestOptions.MergeAction,InsertPosition:a.RequestOptions.InsertPosition})}`),!1}})}T8d(a,b){return Object(vj.a)(this,void 0,void 0,function*(){b.CorrelationId||(b.CorrelationId=Hg.a.create().toString());xa.a.J(509214917,817,15,`CopilotProxy::generatePPTFromOutline: ${JSON.stringify({Correlation:b.CorrelationId,ClientName:b.ClientName,MergeAction:b.MergeAction,InsertPosition:b.InsertPosition})}`);let c=`${this.la.Ha("CreatorServiceBase")}?action=OutlineToPPT`;
c=this.n2f(c);const f={};f.PodSID=this.Ya.podSessionId;f.Client=b.ClientName;Object(eb.a)("PptCreatorAddScenarioInHeader")&&(f.Scenario="ReplaceAll"===b.MergeAction?"Create":"Insert");f["X-CorrelationId"]=b.CorrelationId;f["X-UserSessionId"]=w.AFrameworkApplication.userSessionId;try{const l=yield this.send({rva:"generatePPTFromOutline",url:c,payload:JSON.stringify(a),headers:f});return JSON.parse(l)}catch(l){xa.a.J(509214916,817,10,`CopilotProxy::generatePPTFromOutline: ${JSON.stringify({Exception:l,
Correlation:b.CorrelationId,ClientName:b.ClientName,MergeAction:b.MergeAction,InsertPosition:b.InsertPosition})}`)}})}EIe(a,b){return Object(vj.a)(this,void 0,void 0,function*(){b.CorrelationId||(b.CorrelationId=Hg.a.create().toString());if(!a||!a.DownloadablePPTInfos||0==a.DownloadablePPTInfos.length)return xa.a.J(509214919,817,10,`CopilotProxy::generatePPTFromOutline: generatePPTFromOutline returned invalid response ${JSON.stringify({Correlation:b.CorrelationId,ClientName:b.ClientName,MergeAction:b.MergeAction,
InsertPosition:b.InsertPosition})}`),!1;xa.a.J(509118050,817,15,`CopilotProxy::generatePPTFromOutline: ${JSON.stringify({Correlation:b.CorrelationId,ClientName:b.ClientName,MergeAction:b.MergeAction,InsertPosition:b.InsertPosition})}`);const c=a.DownloadablePPTInfos[0].DownloadUrl;if(!c)return xa.a.J(509163081,817,10,`CopilotProxy::generatePPTFromOutline: generatePPTFromOutline failed; ${JSON.stringify({ErrorCode:a.DownloadablePPTInfos[0].ErrorCode,Correlation:b.CorrelationId,ClientName:b.ClientName,
MergeAction:b.MergeAction,InsertPosition:b.InsertPosition})}`),!1;const f={};f.PodSID=this.Ya.podSessionId;f.Client=b.ClientName;Object(eb.a)("PptCreatorAddScenarioInHeader")&&(f.Scenario="ReplaceAll"===b.MergeAction?"Create":"Insert");f["X-UserSessionId"]=w.AFrameworkApplication.userSessionId;f["X-CorrelationId"]=b.CorrelationId;let l=`${this.la.Ha("MergeSlidesFromUrlEndpoint")}`;l=this.n2f(l);return(yield this.send({rva:"mergeGeneratedSlides",url:l,payload:JSON.stringify({DownloadUrl:c,MergeAction:b.MergeAction,
InsertPosition:b.InsertPosition}),headers:f})).includes("Error")?!1:!0})}n2f(a){if(!this.la.ka("StoryTellerForwardWdQueryParams"))return a;const b=new URLSearchParams(window.location.search.toLowerCase()),c=this.la.Ha("StoryTellerWdQueryParamsToForward").toLowerCase().split(",");for(const [f,l]of b.entries())-1<c.indexOf(f)&&(a+="&"+f+"="+encodeURIComponent(l));return a}send(a){return new Promise((b,c)=>{const f=new Date;this.Su.zj(a.url,2,a.payload,a.headers,!1,0,l=>{var y;xa.a.J(509214915,817,15,
`CopilotProxy::${a.rva}: Time Taken ${+new Date-+f}`);l.data.Ke!==ua.a.mx&&(xa.a.J(509214914,817,10,`CopilotProxy::${a.rva}: Bad Http Status ${l.data.Ke}`),c(`Error - Bad Http Status ${l.data.Ke}`));xa.a.J(509214913,817,15,`CopilotProxy::${a.rva}: call successful`);b(null!==(y=l.data.ee)&&void 0!==y?y:"")},l=>{var y,H;const Q=new Date;xa.a.J(509214912,817,10,`CopilotProxy::${a.rva}: request failed Status: ${null===(y=null===l||void 0===l?void 0:l.data)||void 0===y?void 0:y.Ke}, Time Taken ${+Q-+f}`);
c(`Error - ${a.rva} failed with ${null===(H=null===l||void 0===l?void 0:l.data)||void 0===H?void 0:H.Ke}`)},null)})}}Object(m.a)(Tb,"CopilotProxy",null,[1405]);class uc{constructor(a,b,c,f){this.Mfk=5;this.nve=0;this.Uhc="ReplaceAll";this.Nzg="colorSchemeTextArea";this.A0g="themeIdsTextArea";this.hWg="presOutlineTextArea";this.xve="CopilotStatusBarDebugUI";this.jMg="CopilotLogPanelId";this.KFf=l=>{l.innerText="";const y=this.oc.ETa();for(let H=0;H<y.length;++H){const Q=y[H],ia=document.createElement("option");
ia.value=Q.sid+";"+Q.cid;ia.textContent=""+(H+1);l.appendChild(ia)}(l=l.options[l.selectedIndex].value.split(";"))&&2===l.length&&(this.BGg={ReferenceSlide:{Sid:parseInt(l[0]),Cid:parseInt(l[1])},InsertBefore:!1})};this.bGk=()=>{const l=document.getElementById("InsertPositionSelect");l&&this.KFf(l)};this.pXa=a;this.Ave={ColorScheme:b.Ha("CopilotTestDefaultColorScheme"),ThemeIds:b.Ha("CopilotTestDefaultThemeIds"),PresOutline:b.Ha("CopilotTestDefaultPresOutline")};this.oc=c;this.gGb=f;this.gGb.IF(this.bGk);
document.getElementById("StatusBar").addEventListener("contextmenu",()=>{this.nve++;this.nve>=this.Mfk&&(this.tvl(),this.nve=0)})}tvl(){if(!document.getElementById(this.xve)){var a=document.createElement("div");a.id=this.xve;a.setAttribute("style","position: absolute; right: 0; bottom: 24px; display: block; z-Index: 10001; border:1px solid gray; padding: 10px; background-color:#f1f1f1");a.appendChild(this.LWd("Color Scheme",this.Nzg,this.Ave.ColorScheme,"100px"));a.appendChild(this.LWd("Theme Ids",
this.A0g,this.Ave.ThemeIds,"30px"));a.appendChild(this.LWd("Presentation Outline",this.hWg,this.Ave.PresOutline,void 0));a.appendChild(this.isi());a.appendChild(this.Osi());a.appendChild(this.gsi());document.body.appendChild(a);"ReplaceAll"==this.Uhc?this.rsd(!1):this.rsd(!0)}}LWd(a,b,c,f){const l=document.createElement("div");l.setAttribute("style","margin: 2px 0px; padding: 5px; border: solid 1px darkgray; border-radius: 10px;");const y=document.createElement("div");y.setAttribute("style","margin: 2px; color: black; display: inline");
const H=document.createElement("textarea");H.id=b;H.value=c;H.setAttribute("style","display: block; margin: 5px 0px; width: 800px; height: 200px; resize:none; overflow-y: scroll");void 0!==f&&(H.style.height=f);b=document.createElement("div");b.setAttribute("style","display: inline; float: right; margin-bottom: 2px");f=document.createElement("button");f.innerText="Default";f.onclick=()=>{H.value=c};b.appendChild(f);f=document.createElement("button");f.style.marginLeft="10px";f.innerText="Clear";f.onclick=
()=>{H.value=""};b.appendChild(f);f=document.createElement("label");f.textContent=a;f.setAttribute("style","color: black; margin: 2px");y.appendChild(f);y.appendChild(b);l.appendChild(y);l.appendChild(H);return l}isi(){const a=document.createElement("div");a.setAttribute("style","margin: 2px 0px; padding: 5px; border: solid 1px darkgray; border-radius: 10px;");a.appendChild(this.hsi());a.appendChild(this.bsi());return a}hsi(){const a=document.createElement("div");a.setAttribute("style","display:inline; margin: 2px 20px;");
const b=document.createElement("label");b.textContent="MergeAction: ";b.style.color="black";const c=document.createElement("select"),f=document.createElement("option");f.value="ReplaceAll";f.textContent="ReplaceAll";const l=document.createElement("option");l.value="Insert";l.textContent="Insert";"ReplaceAll"==this.Uhc?f.selected=!0:l.selected=!0;c.appendChild(f);c.appendChild(l);a.appendChild(b);a.appendChild(c);c.addEventListener("change",()=>{"Insert"===c.options[c.selectedIndex].value?(this.Uhc=
"Insert",this.rsd(!0)):(this.Uhc="ReplaceAll",this.rsd(!1))});return a}bsi(){const a=document.createElement("div");a.id="InsertPositionDiv";a.setAttribute("style","display:inline; margin: 2px 20px; visibility: hidden");const b=document.createElement("label");b.textContent="After slide: ";b.style.color="black";const c=document.createElement("select");c.id="InsertPositionSelect";this.KFf(c);c.addEventListener("change",()=>{const f=c.options[c.selectedIndex].value.split(";");f&&2===f.length&&(this.BGg=
{ReferenceSlide:{Sid:parseInt(f[0]),Cid:parseInt(f[1])},InsertBefore:!1})});a.appendChild(b);a.appendChild(c);return a}rsd(a){document.getElementById("InsertPositionDiv").style.visibility=a?"visible":"hidden"}Osi(){const a=document.createElement("div");a.setAttribute("style","margin: 2px 0px; padding: 5px; border: solid 1px darkgray; border-radius: 10px;");a.appendChild(this.Psi());a.appendChild(this.rri());return a}Psi(){const a=document.createElement("button");a.style.marginRight="10px";a.innerText=
"GenerateAndMergeSlides";a.onclick=()=>Object(vj.a)(this,void 0,void 0,function*(){try{const b={OutlineInput:{ColorScheme:JSON.parse(document.getElementById(this.Nzg).value),ThemeIds:JSON.parse(`[${document.getElementById(this.A0g).value}]`),FRenderFirstThumb:!0,PresOutline:JSON.parse(document.getElementById(this.hWg).value)},RequestOptions:{ClientName:"ChatPPT",MergeAction:this.Uhc,InsertPosition:this.BGg,CorrelationId:void 0}},c=yield this.pXa.a3f(b);this.log(`generateAndMergeSlides succeeded: ${c}`)}catch(b){this.log(`generateAndMergeSlides error: ${b}`)}});
return a}rri(){const a=document.createElement("button");a.innerText="Close";a.onclick=()=>{document.body.removeChild(document.getElementById(this.xve))};return a}gsi(){const a=document.createElement("div");a.setAttribute("style","margin: 2px 0px; padding: 5px; border: solid 1px darkgray; border-radius: 10px; user-select: text;");var b=document.createElement("label");b.style.color="black";b.style.userSelect="text";b.textContent=`UserSessionId: ${w.AFrameworkApplication.userSessionId}`;a.appendChild(b);
b=document.createElement("textarea");b.id=this.jMg;b.value="";b.setAttribute("style","display: block; margin: 5px 0px; width: 800px; height: 200px; resize:none; overflow-y: scroll");b.disabled=!0;b.style.height="50px";a.appendChild(b);return a}log(a){document.getElementById(this.jMg).value+=a+"\r\n"}}Object(m.a)(uc,"StatusBarDebugUI",null,[]);class yd{get name(){return"PowerPointWebEditor.CopilotProxy"}Yb(a){this.K=a;a.register(Tb,"PowerPointWebEditor.CopilotProxy").as("PowerPointWebEditor.ICopilotProxy").ma().oa(()=>
new Tb(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),w.AFrameworkApplication.Me))}init(){this.K.resolve("PowerPointWebEditor.ICopilotProxy");this.K.resolve("Common.IAppSettingsManager").ka("CopilotDebugUIEnabled")&&new uc(this.K.resolve("PowerPointWebEditor.ICopilotProxy"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("Box4.Graph.IGraphInstance").yd(7))}dispose(){}static main(){(w.AFrameworkApplication.fa.ka("EnableChatPPT")||
w.AFrameworkApplication.fa.ka("EnableChatPPTCopilot")||w.AFrameworkApplication.fa.ka("EnableStoryTeller"))&&n.a.instance.Ac(new yd)}}Object(m.a)(yd,"PPTWebEditorCopilotProxyPackage",null,[2,3]);var oe=d(172),$d=d(96),ve=d(648),hc=d(52),Of;(function(a){a[a.unknown=0]="unknown";a[a.orderlyShutdown=1]="orderlyShutdown";a[a.bootIncomplete=2]="bootIncomplete";a[a.podSessionRefreshed=3]="podSessionRefreshed";a[a.seamlessFailoverManager=4]="seamlessFailoverManager";a[a.inlineDocumentRepair=5]="inlineDocumentRepair"})(Of||
(Of={}));Object(m.b)("RefreshDocTrigger",Of);var Nc=d(43),$e=d(86);class lj extends Sys.EventArgs{constructor(a,b){super();this.A2j=b}}Object(m.a)(lj,"FailoverEventArgs",Sys.EventArgs,[]);var th=d(245),Ig=d(110);class wk extends Ig.a{constructor(a){super();this.FailedMachineId=null;this.FailedMachineId=a}pl(){return 61}}Object(m.a)(wk,"CheckUnblockUIRequest",Ig.a,[]);var bl=d(891),ea=d(30);class Gj{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye){this.Vma=!1;this.exa=this.IEe=
this.jHa=this.pHa=this.sU=this.Ls=null;this.la=a;this.wb=b;this.Ook=c;this.qf=f;this.pa=l;this.Fa=y;this.wA=H;this.V6c=dc;this.kfb=yc;this.Ym=Q;this.Sek=ia;this.ta=wa;this.Tb=Ua;this.Q$=kb;this.Fe=Gb;this.Ud=ec;this.mHa=Fc;this.ia=tc;this.mD=xd;this.An=Vd;this.EZa=Ld;this.ij=ye;this.ehk=this.la.podsFailoverRefreshDocSlideDrawTimeoutInMS;this.Kkk=this.la.podsLegacyFailoverRefreshDocSlideDrawTimeoutInMS}vb(){this.ia.ra(ea.a.LLb,hc.a.application,Object(I.a)(this,this.O1k,"refeshDoc"),64)}O1k(a,b,c,f,
l){this.Z7e(l.failedMachineId,l.isPlanedShutdown,"podSessionId"in l?l.podSessionId:"","isPodSessionRefreshed"in l&&l.isPodSessionRefreshed?3:"fromSeamlessFailoverManager"in l?4:"fromInlineDocumentRepair"in l?5:0);return 32}get Di(){return this.Tb.Di}mta(a){a.N9b()&&a.mta()}Z7e(a,b,c,f){if(!this.Fe.rd.hermesFailOverImprovementIsEnabled||this.kfb())return!1;if(this.Vma||this.mHa.ung)return!0;const l=this.Di;if(!(l&&l.Fi&&l.Fi.xx&&l.Fi.xx.id!==ha.a.nil&&l.contentReplicator&&this.ta.presentation&&this.ta.presentation.id.equals(ve.a.WNe)))return!1;
5===f&&this.xwf();this.Ym.pause();this.Q$.suspend();this.wA.Rd&&this.wA.Rd.endEditing(!1,14);this.wA.forEach(Object(I.a)(this,this.mta,"ensureGraphUpdated"));l.MT(!0)&&l.Ega();this.pa.setSelection(null);this.Fa.Bd();this.Ls=Nc.a.kk("RefreshDoc");this.Ls.Wa("IsPlanedShutdown",b.toString());this.Ls.Wa("PodSessionId",c);this.Ls.Wa("RefreshDocTrigger",Of[f]);xa.a.J(512360801,809,50,"DocRefreshHandler::TryRefreshDoc:ActionID:{0}; ActionDetails:{1}",this.Ls.actionId,this.Ls.bQb());this.sU=a;b?(this.pHa=
new Date,this.mHa.VBh(),this.V6c.Hb(this.y0d())):this.kmh();this.mD.akh(new lj(b,!1));this.ta.presentation.QWe();this.qf.blockContent(this.ta.presentation,"RefreshDoc",!0);xa.a.J(512360798,822,15,"DocRefreshHandler::TryRefeshDoc, Block Presentation");this.Ud.disabled=!0;return this.Vma=this.Fe.oab().wid=!0}xwf(){this.Ym.isPaused&&(xa.a.J(512360797,801,50,"DocRefreshHandler::ActivateReplicationScheduler:  ReplicationScheduler was paused - UnPaused it"),this.Ym.onb());try{this.Ym.oIf()}catch(a){xa.a.J(512360796,
801,15,"DocRefreshHandler::ActivateReplicationScheduler CancelBlockedOperation failed. {0}",a)}}y0d(){return this.jHa=new th.a(new wk(this.sU),Object(I.a)(this,this.kLe,"onCheckUnBlockUISuccess"),Object(I.a)(this,this.jLe,"onCheckUnBlockUIFailed"),a=>0===a.StatusCode&&!a.ServerError,3)}kmh(){this.Ls.Wa("FailedMachineId",this.sU);this.IEe=new Date;this.Ook.LLb(this.sU,this.Ls,!this.Fe.rd.refreshDocSynchronouslyIsEnabled,!1,Object(I.a)(this,this.hWi,"docRefreshSuccessCallback"),Object(I.a)(this,this.gWi,
"docRefreshFailedCallback"));this.Sek.Mxa()}kLe(){this.mHa.YYc();this.Ls.Wa("DeploymengUIBlockingTime",(+new Date-+this.pHa).toString());this.Ls.Wa("CheckUnblockUISucceeded","True");this.kmh()}jLe(a){if(142===a.ServerError.Code)return xa.a.J(512360795,822,50,"UnBlockUI failed with ErrorBlockUIUnderDeployment, failed machine: {0}, UI blocking time in ms: {1}",this.sU,+new Date-+this.pHa),this.V6c.Hb(this.jHa),!0;this.Ls.Wa("DeploymengUIBlockingTime",(+new Date-+this.pHa).toString());this.Ls.Wa("CheckUnblockUISucceeded",
"False");this.mHa.YYc();return this.sah(a)}hWi(){this.An.YSd(Object(I.a)(this,this.$Me,"onSlideDrawComplete"));this.exa&&this.wb.Lg(this.exa);const a=this.Ls.tK("RefreshDocTrigger");this.exa=new dd.a(2,1,a&&1===a.length&&"podSessionRefreshed"===a[0]?this.ehk:this.Kkk,Object(I.a)(this,this.onSlideDrawTimeout,"onSlideDrawTimeout"),90,"62");this.wb.Hb(this.exa);a&&1===a.length&&"inlineDocumentRepair"===a[0]&&this.xwf()}gWi(a){return this.sah(a)}$Me(){ka.ULS.sendTraceTag(512360794,821,50,"DocRefreshHandler::OnSlideDrawComplete");
this.exa&&(this.wb.Lg(this.exa),this.exa=null);this.An.$od(Object(I.a)(this,this.$Me,"onSlideDrawComplete"));this.Ls&&(this.Ls.Wa("ReStoreStatusAfterRefreshStartTime",Nc.a.uf(new Date)),this.Q$.resume(),this.Ls.Wa("SlideDrawResult","True"),this.Ls.vm("SlideDrawCompleteET",new Date),this.Ym.isPaused&&this.Ym.onb(),this.Ls.Wa("LoadAndRenderTime",(+new Date-+this.IEe).toString()),this.Fe.rd.gUe||this.Fe.oab().Oxa(),this.Ls.Wa("ReStoreStatusAfterRefreshEndTime",Nc.a.uf(new Date)),this.NMe(!0),this.EZa.rkh(new bl.a("DocRefresh")),
this.ij.Inb=2,w.AFrameworkApplication.nkb($e.a.Oh(180),oe.a.unknown,oe.a.Owc),$d.Health.instance.recordQosError("AppRebooted",["UnexpectedAppRefresh"],!1,!1,!0,!1,null))}onSlideDrawTimeout(){this.An.$od(Object(I.a)(this,this.$Me,"onSlideDrawComplete"));this.exa&&(this.wb.Lg(this.exa),this.exa=null);ka.ULS.sendTraceTag(512360793,821,10,"DocRefreshHandler::OnSlideDrawTimeout");this.Ls.Wa("SlideDrawResult","False");this.NMe(!1);this.N$k()}N$k(){this.Ud.disabled=!1;w.AFrameworkApplication.Oo($e.a.Oh(379));
$d.Health.instance.recordQosError("RefreshDocTimeout",["UnexpectedAppRefresh"],!1,!1,!0,!0,null);w.AFrameworkApplication.fv&&w.AFrameworkApplication.fv.P8();this.ia.Ka(ea.a.refresh,2,{refreshtrigger:"DocRefreshHandler::ReportErrorAndRefreshPage"})}sah(a){ka.ULS.sendTraceTag(512360792,821,50,"DocRefreshHandler:OnRefreshFailed Original error Code:{0}, Source:{1}, ExtraParam:{2}, Correlation:{3}",a.ServerError.Code,a.ServerError.Source,a.ServerError.ExtraErrorParam?a.ServerError.ExtraErrorParam.join(","):
"empty",a.Ph);this.NMe(!1);return!1}NMe(a){this.Vma=!1;this.jHa=this.sU=null;this.IEe=new Date(0);Nc.a.$cc=new Date;this.Ls&&(this.Ls.Wa("Result",a?"Success":"Failed"),this.Ls.finish(!0),this.Ls=null);this.Ud.disabled=!1;this.Fe.oab().wid=!1;this.qf.xK(this.ta.presentation)}}Object(m.a)(Gj,"DocRefreshHandler",null,[1389]);var Hj=d(158);class mj{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb){this.Vma=!1;this.jHa=this.pHa=this.sU=this.Ls=null;this.ia=a;this.ai=b;this.li=c;this.qf=f;this.pa=l;this.Fa=y;
this.Ym=H;this.ta=Q;this.Q$=ia;this.mHa=wa;this.Ya=Ua;this.la=kb;this.kfb=Gb;this.la.aog&&this.li.GC(Object(I.a)(this,this.WE,"onSessionEnd"))}vb(){this.ia.ra(ea.a.failover,hc.a.application,Object(I.a)(this,this.fBj,"handleFailover"),64)}WE(){this.Ym.isPaused||this.Ym.pause()}fBj(a,b,c,f,l){if(1===c||this.kfb()||this.Vma||this.mHa.ung)return 32;this.sU=l;if(!this.sU)return 8;this.Ls=Nc.a.kk("SeamlessFailover");this.Ym.pause();this.Q$.suspend();this.pa.setSelection(null);this.Fa.Bd();this.qf.blockContent(this.ta.presentation,
"SeamlessFailover",!0);xa.a.J(37106114,822,15,"SeamlessFailoverHandler::HandleFailover, Block Presentation");this.pHa=new Date;this.mHa.VBh();this.li.akh(new lj(!0,!0));w.AFrameworkApplication.Dwb();this.ai.xIc(this.y0d());this.Vma=!0;return 32}y0d(){return this.jHa=new th.a(new wk(this.sU),Object(I.a)(this,this.kLe,"onCheckUnBlockUISuccess"),Object(I.a)(this,this.jLe,"onCheckUnBlockUIFailed"),a=>0===a.StatusCode&&!a.ServerError,3)}kLe(){this.mHa.YYc();this.Ls.Wa("DeploymengUIBlockingTime",(+new Date-
+this.pHa).toString());this.Ls.Wa("CheckUnblockUISucceeded","True");this.Ls.Wa("FailedMachineId",this.sU);this.Ya.Zwb=this.sU;this.n_k()}jLe(a){if(142===a.ServerError.Code)return xa.a.J(22315610,822,50,"UnBlockUI failed with ErrorBlockUIUnderDeployment, failed machine: {0}, UI blocking time in ms: {1}",this.sU,+new Date-+this.pHa),this.ai.xIc(this.jHa),!0;this.Ls.Wa("DeploymengUIBlockingTime",(+new Date-+this.pHa).toString());this.Ls.Wa("CheckUnblockUISucceeded","False");this.mHa.YYc();return this.XCk(a)}n_k(){this.Ls.Wa("ReStoreStatusAfterRefresh",
Nc.a.uf(new Date));this.Ym.onb();this.Q$.resume();this.i9g(!0);w.AFrameworkApplication.nkb($e.a.Oh(180),oe.a.unknown,oe.a.Owc);$d.Health.instance.recordQosError("AppRebooted",["UnexpectedAppRefresh"],!1,!1,!0,!1,null)}XCk(a){ka.ULS.sendTraceTag(22315611,821,50,"SeamlessFailoverHandler:OnFailoverFailed Original error Code:{0}, Source:{1}, ExtraParam:{2}, Correlation:{3}",a.ServerError.Code,a.ServerError.Source,a.ServerError.ExtraErrorParam?a.ServerError.ExtraErrorParam.join(","):"empty",a.Ph);this.i9g(!1);
a.ServerError=Object.assign(new Hj.a,{Code:157,Source:0});return!1}i9g(a){this.Vma=!1;this.jHa=this.sU=null;this.Ls&&(this.Ls.Wa("Result",a?"Success":"Failed"),this.Ls.finish(),this.Ls=null);this.qf.xK(this.ta.presentation)}dispose(){this.la.aog&&this.li.Laa(Object(I.a)(this,this.WE,"onSessionEnd"))}}Object(m.a)(mj,"SeamlessFailoverHandler",null,[107]);var Dl=d(222),Ai=d(107),nj=d(1195),Bi=d(286),El=d(844),te=d(234),sm=d(632);class Zl{constructor(a,b,c,f,l){if(!a)throw Error.argumentNull("actionManager");
this.ia=a;this.la=b;this.l$=c;this.Gz=f;this.Jb=l;this.cfb=!1}Av(a,b=!1,...c){this.w4b.apply(this,[$e.a.Oh(a),this.l$.OWc(a),this.l$.Sde(a),this.l$.obe(a),b].concat(c))}w4b(a,b,c,f,l=!1,...y){if(!Dl.a.wx){var H=2,Q=!1;if(a===$e.a.Oh(83))this.la.k3j&&(c=ResourceStrings.l_CannotPasteImageTitle,f=ResourceStrings.l_SuggestionToInsertPicture,H=3);else if(a===$e.a.Oh(8)||a===$e.a.Oh(256)||a===$e.a.Oh(257)||a===$e.a.Oh(291))H=0,Q=!0;y&&0<y.length&&(f=String.format.apply(null,[f].concat(y)));this.Kt(new sm.a(a,
c,f,b,H),l,Q)}}Kt(a,b=!1,c=!1){let f=a.ood;var l=$e.a.aU(a.Vm)?te.a[$e.a.nL(a.Vm)]:"";xa.a.J(512497111,801,15,"ErrorDialog::ShowErrorDialog BSQMErrorCode: {0}; ErrorName: {1}, SuppressErrorReporting: {2}, ShowFeedbackButtonEnabled: {3}, ClientActions - None: {4}, Dismiss: {5}, Close: {6}, OpenInClient: {7}, Refresh: {8}, HideFeedback: {9}, Repair: {10}",a.Vm,l,b,w.AFrameworkApplication.iF,0===f,!!(f&1),!!(f&2),!!(f&4),!!(f&8),!!(f&16),!!(f&64));"errorLocalChangeLostCoauth"==l&&eb.a("LocalChangesLostQoSErrorEnabled")&&
$d.Health.instance.recordQosError("LocalChangesLost",["ClientSideDataLoss"],!1,!0,!0,!1,null);if(this.eul(a))xa.a.J(512497110,801,50,"ErrorDialog::ShowErrorDialog Skip showing error {0} to users.",a.Vm);else{l=new Ai.StandardDialog;var y=null,H=!1,Q=this.Jb.ka("UserCanWriteRelative");f&64&&xa.a.J(512497109,801,50,"ErrorDialog::ShowErrorDialog. User's Access level:{0}",this.Jb.Ha("DocumentPermissions")||"");var ia=!1;f&64&&this.la.pptFileRecoveryEnabled&&(ia=!0);f&64&&!Q&&xa.a.J(512497108,801,50,"ErrorDialog::ShowErrorDialog. We found a repairable error but user has no permission to write relative, but inline repair is enabled. Will try to repair.");
!ia&&f&64&&(c=!1,f=this.iOl(a));Q=!!(f&4)&&!(w.AFrameworkApplication.dKh||w.AFrameworkApplication.ZQ);var wa=!!(f&2)&&w.AFrameworkApplication.rea;c=c?ResourceStrings.l_OpenInApp:ResourceStrings.L_OpenInPowerPoint;l.Ir=wa||!!(f&1);f&8?(l.Ad=0,y=Object(I.a)(this,this.tod,"refreshActionHandler"),Array.contains(this.la.hermesRefreshErrorSuppressionList,a.Vm.toString())?l.sP(nj.a.V3(a.title),nj.a.V3(a.message),y):(xa.a.J(512497107,801,50,"ErrorDialog::ShowErrorDialog BSQMErrorCode: {0}.",a.Vm),l.Oe(1,
ResourceStrings.L_Refresh),l.Ty(a.Vm,nj.a.V3(a.title),nj.a.V3(a.message),y,b)),H=this.cfb=!0):ia?(xa.a.J(512497106,801,50,"ErrorDialog::ShowErrorDialog. We met an error need to repair. ErrorCode: {0}",a.Vm),this.ia.processAction(ea.a.repair,2)):wa&&Q?(l.Ad=4,l.Oe(1,c),l.Oe(2,ResourceStrings.L_Close),y=Object(I.a)(this,this.TJk,"openOrCloseActionHandler"),this.cfb=!0):Q?(l.Ad=0,l.Oe(1,c),y=Object(I.a)(this,this.okd,"openInClientActionHandler"),this.cfb=!0):wa?(l.Ad=0,l.Oe(1,ResourceStrings.L_Close),
y=Object(I.a)(this,this.aCi,"closeActionHandler"),this.cfb=!0):(c=!!(f&1)||0===f,l.Ir=c,l.Ad=c?0:5);H||ia||(f&16&&f&32?(b||w.AFrameworkApplication.Oo(a.Vm),l.T1a=!1,l.Tx(nj.a.V3(a.title),nj.a.V3(a.message),a.icon,y)):l.Ty(a.Vm,nj.a.V3(a.title),nj.a.V3(a.message),y,b));this.cfb&&this.Gz&&this.Gz.closeSession(4);this.cfb?$d.Health.instance.recordQosError($e.a.ida(a.Vm),["NonDismissibleDialog"],!1,!1,!0,!0,null):$d.Health.instance.recordQosError($e.a.ida(a.Vm),["DismissibleDialog"],!1,!1,!0,!1,null)}}get T1c(){return this.cfb}iOl(a){xa.a.J(512497105,
801,15,"ErrorDialog::UpdateErrorWhenRepairDisabled. We found a repairable error but user has no permission to repair. Falling back to generic error dialog.");a.message=a.Vm===$e.a.Oh(8)||a.Vm===$e.a.Oh(43)?ResourceStrings.errorMessage_EditSlideCorruption:ResourceStrings.errorMessage_CannotOpenDocument;a.title=ResourceStrings.errorTitle_PowerpointStandard;a.icon=2;return 6}okd(a,b){xa.a.J(512497104,801,50,"Button={0};DontShowAgain={1}",a,b);1===a&&this.xih()}TJk(a,b){xa.a.J(512497103,801,50,"Button={0};DontShowAgain={1}",
a,b);1===a?this.xih():this.ia.Ka(ea.a.mxb,2,Bi.c)}aCi(a,b){xa.a.J(512497102,801,50,"Button={0};DontShowAgain={1}",a,b);this.ia.Ka(ea.a.mxb,2,Bi.c)}tod(a,b){xa.a.J(512497101,801,50,"Button={0};DontShowAgain={1}",a,b);this.ia.Ka(ea.a.refresh,2,{refreshtrigger:"ErrorDialog::RefreshActionHandler"})}xih(){(new El.a(C.a.openInClient)).Yle()}eul(a){return a.Vm===$e.a.Oh(83)&&(w.AFrameworkApplication.dM("Microsoft.Office.Server.Powerpoint.Web.IPptSkipErrorCannotPastePictureNotFoundSettings"),this.la.eyl)||
a.Vm===$e.a.Oh(56)&&(w.AFrameworkApplication.dM("Microsoft.Office.Server.Powerpoint.Web.IPptSkipErrorLocalChangeLostCoauthSettings"),this.la.fyl)?!0:!1}}Object(m.a)(Zl,"ErrorDialog",null,[1387]);var Ji=d(279),Qe=d(127),$l=d(524),mk=d(1033);class zf extends Sys.EventArgs{constructor(){super();this.bDa=this.KC=0;this.message=this.title=null}}Object(m.a)(zf,"BeforeHandleErrorEventArgs",Sys.EventArgs,[]);class Jf extends zf{constructor(a){super();this.bTa=null;this.errorCode=a;this.KC=0}}Object(m.a)(Jf,
"OnBeforeHandleClientErrorEventArgs",zf,[]);class Fl extends zf{constructor(){super();this.KC=0}}Object(m.a)(Fl,"OnBeforeHandleServerErrorEventArgs",zf,[]);class Cc extends Sys.EventArgs{constructor(a,b,c){super();this.UO=a;this.$gk=b;this.xh=c}get podSessionId(){return this.UO}get dSc(){return this.$gk}get errorCode(){return this.xh}}Object(m.a)(Cc,"PodSessionUnavailableEventArgs",Sys.EventArgs,[]);class uo{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec){this.Qze=!1;this.jik=[8];this.iAe={["Generic"]:CommonUIStrings.l_DecryptSkipReasonGeneric,
["DecryptionDefered"]:CommonUIStrings.l_DecryptSkipReasonDecryptionDefered,["EncryptedOutsideSharepoint"]:CommonUIStrings.l_DecryptSkipReasonEncryptedOutsideSharepoint,["UnsupportedMsoDataStore"]:CommonUIStrings.l_DecryptSkipReasonUnsupportedMsoDataStore,["PasswordProtected"]:CommonUIStrings.l_DecryptSkipReasonPasswordProtected,["ContentExpiryLabel"]:CommonUIStrings.l_DecryptSkipReasonContentExpiryLabel,["InvalidLabelOwner"]:CommonUIStrings.l_DecryptSkipReasonInvalidLabelOwner,["DeletedLabel"]:CommonUIStrings.l_DecryptSkipReasonDeletedLabel,
["LabelProtectionChanged"]:CommonUIStrings.l_DecryptSkipReasonLabelProtectionChanged,["UnsupportedLabel"]:CommonUIStrings.l_DecryptSkipReasonLabelUnsupportedLabel,["DoubleKeyDisabled"]:CommonUIStrings.l_DecryptSkipReasonLabelDoubleKeyDisabled};this.disabled=!1;this.l$=a;this.$ea=b;this.ul=c;this.QBg=f;this.ia=l;this.Ya=y;this.Jb=H;this.Vb=Q;this.aGb=ia;this.Dff=!1;this.Ym=wa;this.Gz=Ua;this.Xo=Gb;this.Ej=ec;this.Fe=kb}Ds(a,b,c=null,f=!1){if(this.disabled)return ka.ULS.sendTraceTag(512263053,804,50,
"Ignore server error {0}",a?a.Code:315),!0;this.Gz.Jtk();if(this.Gz.b0)return ka.ULS.sendTraceTag(512263052,804,15,"GlobalErrorHandler:HandleServerError - Ignore server error since session is already closed. ErrorCode:{0}",a?a.Code:315),!0;let l=!1,y=0,H=0,Q=null;var ia=null;c&&(ia=new Fl,l=c(ia),y=ia.KC,H=ia.bDa,Q=ia.title,ia=ia.message);l||(l=this.nFj(a,b));l||(b=a?a.Code:315,a=a?a.ExtraErrorParam:null,this.a2i(b)&&(this.Dff=!0,this.Ym.pause()),a?this.Ty.apply(this,[y,b,H,Q,ia,f].concat(a)):this.Ty(y,
b,H,Q,ia,f));return l}nFj(a,b){if(!a)return!1;ka.ULS.sendTraceTag(512263051,821,15,"{0} - Error Code:{1} Source:{2} ExtraParam:{3}","GlobalErrorHandler:HandleServerErrorInternal",a.Code,a.Source,a.ExtraErrorParam?a.ExtraErrorParam.join(","):"empty");if(153===a.Code)return Ji.a.instance.QTe(Date.now()),Ji.a.T4c(w.AFrameworkApplication.userSessionId),w.AFrameworkApplication.nkb($e.a.Oh(153),oe.a.unknown,oe.a.Owc),({s6e:c}=Ji.a.instance.zKh()).returnValue&&ka.ULS.sendTraceTag(512263050,804,50,"{0} - Data Center Redirect - Time duration from user launch browser to redirection starting {1}",
"GlobalErrorHandler:HandleServerErrorInternal",(new Date).getTime()-c),a.ExtraErrorParam?this.H1k(a.ExtraErrorParam[0]):ka.ULS.sendTraceTag(512263049,804,10,"{0} - Data Center Redirect missing RedirectUrl","GlobalErrorHandler:HandleServerErrorInternal"),!0;if(142===a.Code&&a.ExtraErrorParam&&0<a.ExtraErrorParam.length)return(2===a.ExtraErrorParam.length?32===this.ia.Ka(ea.a.failover,2,a.ExtraErrorParam[0]):this.QBg.Z7e(a.ExtraErrorParam[0],!0,this.Ya.podSessionId||"",1))||this.Ty(0,157,0,null,null),
!0;if(274===a.Code)return ka.ULS.sendTraceTag(512263048,804,10,"{0} - Pods session is locked for edit/merge. Local change could be lost","GlobalErrorHandler:HandleServerErrorInternal"),!0;if(4===a.Code&&this.Xo.instance&&!ma.a.Xa(this.Ya.xSc))return ka.ULS.sendTraceTag(512263047,801,15,"Triggering rehydration for password files from GlobalErrorHandler"),this.Xo.instance.l7e(!1,0,a.Code),!0;if(157===a.Code&&2===a.Source&&a.ExtraErrorParam&&0<a.ExtraErrorParam.length){var c=1<a.ExtraErrorParam.length?
a.ExtraErrorParam[1]:"";return this.Jb.ka("685")&&c.toLowerCase()!==this.Ya.podSessionId.toLowerCase()?(xa.a.J(512263046,801,15,"{0} - Replication cache request boot incomplete failures were ignored, ServerReturnPodSessionSeed: {1}; SessionInfoSeed: {2}.","GlobalErrorHandler:HandleServerErrorInternal",c,b),!0):this.Jb.ka("884")&&this.Qze?(xa.a.J(512263045,801,15,"{0} - Ignore bootIncomplete error after SaveAndClose( ReleaseLock=true ).","GlobalErrorHandler:HandleServerErrorInternal"),!0):this.QBg.Z7e(a.ExtraErrorParam[0],
!1,this.Ya.podSessionId||"",2)}if(223===a.Code||285===a.Code||362===a.Code||this.Jb.ka("560")&&229===a.Code||this.Jb.ka("914")&&this.Xo.instance&&this.Xo.instance.J2i(a.Code)){if(b!==this.Ya.podSessionId)return xa.a.J(512263044,801,15,"{0} - PodSessionId mismatch, skip failover signal. FailedPodSessionId:{1}; CurrentPodSessionId:{2}","GlobalErrorHandler:HandleServerErrorInternal",b,this.Ya.podSessionId),!0;if(this.Jb.ka("914")&&this.Xo.instance&&this.Xo.instance.z_)return xa.a.J(512263043,801,15,
"{0} - SeamlessFailover is ongoing. FailedPodSessionId:{1}; CurrentPodSessionId:{2}","GlobalErrorHandler:HandleServerErrorInternal",b,this.Ya.podSessionId),!0;xa.a.J(512263042,801,15,"{0} - RaisePodSessionUnavailableEvent, serverErrorCode:{1};","GlobalErrorHandler:HandleServerErrorInternal",a.Code);this.aGb.NYk(new Cc(this.Ya.podSessionId,!!a.ExtraErrorParam&&!!a.ExtraErrorParam.length&&"PodsOrderlyShutdown"===a.ExtraErrorParam[0],a.Code));return!0}if(389===a.Code||292===a.Code&&3===a.Source)return a=
this.Vb.notificationBar.vDa(ResourceStrings.L_DeepLinking_BootSlideNotFound,!1),this.Jb.ka("IsAutomation")?a.displayTimeoutSeconds=this.Jb.wc("PodDeepLinkingToastMessageDisplayTimeMsForAutomation",a.displayTimeoutSeconds)/1E3:xa.a.J(512263041,804,15,"{0} - Deep link - Slide not found","GlobalErrorHandler:HandleServerErrorInternal"),this.Vb.notificationBar.ji(a),!0;if(238===a.Code&&this.Jb.ka("561")&&this.Xo.instance&&this.Xo.instance.z_)return xa.a.J(512263040,801,50,"{0} - SessionBootInProgress during seamless failover, skipped",
"GlobalErrorHandler:HandleServerErrorInternal"),!0;if(329===a.Code)return xa.a.J(512263011,801,15,"{0} - PreconditionFailed error due to host integration ID mismatch, silent fail","GlobalErrorHandler:HandleServerErrorInternal"),this.iDh(a.Code,null),!0;if(104===a.Code)return b=2===this.Ej.qda,a.Code=b?56:105,xa.a.J(512263010,801,15,"{0} - LocalChangeLost seen when user is {1}. Returning {2}.","GlobalErrorHandler:HandleServerErrorInternal",b?"co-authoring":"alone",te.a[a.Code]),this.Ty(0,a.Code,0,
null,null),!0;if(this.XTj(a.Code)&&2!==this.Jb.state)return xa.a.J(512263009,801,15,"{0} - Skip check file error if it under retry","GlobalErrorHandler:HandleServerErrorInternal"),!0;if(117===a.Code){if((b=a.ExtraErrorParam)&&2===b.length&&"GB"===b[1])return this.Ty.apply(this,[0,a.Code,0,null,ResourceStrings.errorMessage_CannotOpenDocumentTooLargeGB,!1].concat(b)),!0}else if(432===a.Code)return this.Ty.apply(this,[1,a.Code,8,null,ResourceStrings.errorMessage_UserNetworkLocationUnauthorized,!1].concat(a.ExtraErrorParam)),
!0;return!1}nH(a,b){if(this.disabled)return ka.ULS.sendTraceTag(512263008,804,50,"Ignore client error {0}",a),!0;let c=!1,f=0,l=0,y=null,H=null;var Q=null;b&&(Q=new Jf(a),c=b(Q),f=Q.KC,l=Q.bDa,y=Q.title,H=Q.message,Q=Q.bTa);c||(c=!1);c||(Q?this.Ty.apply(this,[f,a,l,y,H,!1].concat(Q)):this.Ty(f,a,l,y,H));return c}Ty(a,b,c,f,l,y=!1,...H){0===a&&(a=this.l$.fpj(b));0===c&&(c=this.l$.OWc(b));f||(f=this.l$.Sde(b));l||(3===b&&this.Jb.ka("DecryptSkipReasonIRMErrorEnabled")?l=this.xfj():(xa.a.J(512263007,
801,50,"GlobalErrorHandler::ShowError errorCode != ErrorCannotOpenDocumentIRM"),l=this.l$.obe(b)));const Q=()=>{this.Evl.apply(this,[a,b,c,f,l,y].concat(H))};2===this.Jb.state?Q():this.Jb.ff(Q)}xfj(){xa.a.J(512263006,801,50,"GlobalErrorHandler::GetDetailedIRMError DecryptSkipReason = "+w.AFrameworkApplication.$3b);return w.AFrameworkApplication.$3b&&this.iAe[w.AFrameworkApplication.$3b]?this.iAe[w.AFrameworkApplication.$3b]:this.iAe.Generic}Evl(a,b,c,f,l,y,...H){if(2===a){let Q;(Q=this.ul).w4b.apply(Q,
[b,c,f,l].concat(H))}else 3===a?this.iDh.apply(this,[b].concat(H)):this.cta.apply(this,[$e.a.Oh(b),c,f,l,y].concat(H))}cta(a,b,c,f,l,...y){0===b&&(b=this.l$.OWc($e.a.nL(a)));if(mk.GraphSpaceRootReplicator.krg($e.a.nL(a))&&y&&0<y.length){this.Ya.qpd=y[0];var H=new Na.a;for(var Q=1;Q<y.length;Q++)H.add(y[Q]);y=H.toArray()}H=Object.assign(new $l.a,{Type:6,Token:this.Fe.rd.Doc,Data:{["Reason"]:"FatalError",["ErrorName"]:$e.a.ida(a)}});eb.a("PPT.BootstrapperMessageNewValues")&&(H.MessageId=Qe.a.TMh,Q=
{Reason:"FatalError"},Q.ErrorName=H.Data.ErrorName,H.Values=Q);window.parent.postMessage(De.c(H),"*");ka.ULS.sendTraceTag(512263005,804,15,"GlobalErrorHandler:DisplayErrorDialog: {0}",a);let ia;(ia=this.$ea).w4b.apply(ia,[a,b,c,f,l].concat(y))}H1k(a){Bd.a.openWindow(1,a)}get jla(){return this.Qze}set jla(a){this.Qze=a;xa.a.J(512263004,801,50,"GlobalErrorHandler::IgnoreBootIncompleteFailure is set to {0}",a)}get e5d(){return this.Dff}VSd(){}uTd(){}iDh(a,...b){const c=$e.a.Oh(a);xa.a.J(512263003,801,
50,"GlobalErrorHandler::SilentFail BSQMErrorCode: {0}; ErrorCode:{1}, ErrorParams:{2}",c,a,b?b.join(","):"");w.AFrameworkApplication.Oo(c);$d.Health.instance.recordQosError($e.a.ida(c),["SilentFailure"],!1,!0,!0,!1,null)}XTj(a){return 288===a||300===a||301===a||302===a||303===a?!0:!1}a2i(a){return Array.contains(this.jik,a)?!0:!1}}Object(m.a)(uo,"GlobalErrorHandler",null,[1390,1418]);class gn{constructor(a){this.Bfc=!1;this.aY=null;this.Ur=a}get ung(){return this.Bfc}VBh(){var a=ResourceStrings.errorTitle_PowerpointEditingStandard,
b=ResourceStrings.errorMessage_BlockUIUnderDeployment;this.Bfc||(this.aY=new Be.a,this.aY.Ad=5,this.aY.message=nj.a.V3(b),this.aY.Ir=!1,xa.a.J(22315662,822,50,"Showing UI blocking dialog to prompt user we are deploying"),this.aY.Dpa(nj.a.V3(a),null,null),this.Bfc=!0,this.Ur.BEf(!0))}YYc(){this.Bfc&&(this.aY.hide(),this.Bfc=!1,this.aY=null,this.Ur.BEf(!1))}}Object(m.a)(gn,"DeployingDialog",null,[1385]);var Lh=d(1043),uh=d(440),Wi=d(654),tm=d(426),Dk=d(163),Va=d(62),vh=d(922);class Ol{constructor(a,
b,c,f,l,y,H,Q){this.Vea=this.Ve=this.oEb=this.iEb=null;this.Q7c=!1;this.k8c=this.ned=this.G5c=null;this.Vma=!1;this.ta=a;this.Tb=b;this.Pq=c;this.Sb=f;this.V6c=l;this.xCg=y;this.Xo=H;this.vsk=Q}get Di(){return this.Tb.Di}LLb(a,b,c,f,l,y){this.Vma||(this.Vma=!0,this.Q7c=c,this.Ve=b,this.ned=l,this.k8c=y,this.Xo.instance&&this.Xo.instance.ARd("abortedOnRefreshDoc"),this.xCg&&this.xCg(),this.V6c.Hb(this.INi(a,f)))}INi(a,b){let c=this.ta.Ba&&!Va.a.Cw(this.ta.Ba.Db)?this.ta.Ba.Db:Va.a.empty;c=b?Va.a.empty:
c;this.Ve.Wa("CurrentActiveSlideId",c.toString());this.G5c=Va.a.Cw(c)?Va.a.empty:c;return new th.a(new vh.a(c,a),Object(I.a)(this,this.rDk,"onGetCellSuccess"),Object(I.a)(this,this.qDk,"onGetCellFailed"),this.vsk?null:Object(I.a)(this,this.ZSl,"validateResponse"))}ZSl(a){return!a.ServerError&&0===a.StatusCode&&a&&a.Cells&&a.Cells.length?(a=a.Cells[a.Cells.length-1])&&a.RevisionList?0<a.RevisionList.length:!1:!1}rDk(a){this.Ve.Wa("GetCells",a.Ph);a=new Lh.a(null,Object(I.a)(this,this.ELj,"inboundSetup"),
a);a.Wi=!this.Q7c;a.$l("RefreshUIOperation");a.run()}qDk(a){this.Ve.Wa("GetCells",a.Ph);200!==a.HttpStatusCode&&this.Ve.Wa("GetCellsHttpStatusCode",a.HttpStatusCode.toString());if(this.k8c&&this.k8c(a))return!0;a.ServerError=Object.assign(new Hj.a,{Code:294,Source:0});$d.Health.instance.recordQosError("RefreshDocFailed",["UnexpectedAppRefresh"],!1,!0,!0,!0,null);return!1}ELj(a,b){(this.Vea=this.Tb.Mn)&&this.Vea.pN&&this.Vea.pN.e5c();this.Vea&&this.Vea.qp&&(this.Vea.pN=new Wi.a(Zd.a.instance,"FailoverView"));
this.Ve.Wa("InboundSetupStartTime",Nc.a.uf(new Date));if(eb.a("UseBuildIncrementalInboundOperation"))this.Tb.Ba=null,this.iEb=this.Di.contentReplicator.uFf(b);else{const c=b.Cells[b.Cells.length-1],f=this.Di.Fi.xx.id;c.RevisionList[0].BaseId=Dk.a(f);this.Tb.Ba=null;this.iEb=new uh.a(c,f,!1,new Date,b.Ph,!1,!1,!1)}this.oEb=this.Pq.je(3);this.oEb.ld(this.ta.presentation);this.Q7c&&this.oEb.iV(a);a.hh(Object(I.a)(this,this.lla,"inboundIncrementally"));this.Ve.Wa("InboundSetupEndTime",Nc.a.uf(new Date));
return!0}lla(a){this.Ve.Wa("InboundIncrementallyStartTime",Nc.a.uf(new Date));this.Di.contentReplicator.lla(this.iEb,new Date);this.iEb.SQ&&(this.oEb.dispose(),a.hh(Object(I.a)(this,this.Oil,"setActiveSlideAndRender")),this.oEb=this.iEb=null,this.Ve.Wa("InboundIncrementallyEndTime",Nc.a.uf(new Date)));return!0}Oil(a){this.Ve.Wa("SetActiveSlideAndRenderStartTime",Nc.a.uf(new Date));a.hh(Object(I.a)(this,this.G5i,"finishRefreshDoc"));if(Va.a.empty.equals(this.G5c))return this.Ve.Wa("SetActiveSlideAndRenderEndTime",
Nc.a.uf(new Date)),!0;const b=this.Sb.Zk(this.G5c);if(!b)return this.Ve.Wa("SetActiveSlideAndRenderEndTime",Nc.a.uf(new Date)),!0;const c=this.Pq.je(3);try{c.ld(b),this.Q7c&&c.iV(a),this.Tb.Ba=b}finally{c&&c.dispose()}this.Ve.Wa("SetActiveSlideAndRenderEndTime",Nc.a.uf(new Date));return!0}G5i(){this.ned&&this.ned();this.Vea&&this.Vea.pN&&(this.Vea.pN.e5c(),this.Vea.pN=new tm.a);this.F1();return!1}F1(){this.Vma=!1;this.k8c=this.ned=this.G5c=this.Vea=this.Ve=this.oEb=this.iEb=null}}Object(m.a)(Ol,"RefreshDocExecutor",
null,[1388]);class hn{obe(a){switch(a){case 1:a=ResourceStrings.errorMessage_Unknown;break;case 14:a=ResourceStrings.errorMessage_Unknown;break;case 2:a=ResourceStrings.errorMessage_CannotOpenDocumentFileType;break;case 3:a=ResourceStrings.errorMessage_CannotOpenDocumentIRM;break;case 4:a=ResourceStrings.errorMessage_CannotOpenDocumentPassword;break;case 41:a=ResourceStrings.errorMessage_CannotOpenDocumentGatekeeperFailure;break;case 33:a=ResourceStrings.errorMessage_CannotOpenDocumentMacro;break;
case 34:a=ResourceStrings.errorMessage_CannotOpenDocumentFinal;break;case 35:a=ResourceStrings.errorMessage_CannotOpenDocumentSigned;break;case 36:a=ResourceStrings.errorMessage_CannotOpenEmbeddedFonts;break;case 5:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 6:a=ResourceStrings.errorMessage_CannotInstallFonts;break;case 7:a=ResourceStrings.errorMessage_CannotConvertModifyPassword;break;case 8:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 306:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;
break;case 9:a=ResourceStrings.errorMessage_CannotComposeSlideUnexpected;break;case 10:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 12:a=ResourceStrings.errorMessage_GenericSlideCorruption;break;case 15:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 16:a=ResourceStrings.errorMessage_FailedToRetrieveResource;break;case 17:a=ResourceStrings.errorMessage_FailedToRenderDocument;break;case 18:a=ResourceStrings.errorMessage_FailedToRenderSlide;break;case 20:a=ResourceStrings.errorMessage_CannotSaveDocument;
break;case 21:a=ResourceStrings.errorMessage_InvalidCommand;break;case 22:a=ResourceStrings.errorMessage_DocVersionMismatch;break;case 23:a=ResourceStrings.errorMessage_CannotAcquirePptEditLock;break;case 58:a=ResourceStrings.errorMessage_CannotAcquirePptEditSharedLock;break;case 24:a=ResourceStrings.errorMessage_RequiresCheckout;break;case 25:a=ResourceStrings.errorMessage_LockedForOfflineCheckout;break;case 26:a=ResourceStrings.errorMessage_LockedByAnotherUser;break;case 27:a=ResourceStrings.errorMessage_AccessDenied;
break;case 28:a=ResourceStrings.errorMessage_NoLicense;break;case 29:a=ResourceStrings.errorMessage_Unknown;break;case 30:a=ResourceStrings.errorMessage_TextTooBig;break;case 31:a=ResourceStrings.errorMessage_TryAgain;break;case 37:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 32:a=ResourceStrings.errorMessage_Unexpected;break;case 11:a=ResourceStrings.errorMessage_FailedToRetrieveResource;break;case 13:a=ResourceStrings.errorMessage_FileNotFoundOrPermissionDenied;break;case 38:a=ResourceStrings.errorMessage_ServiceUnavailable;
break;case 39:a=ResourceStrings.errorMessage_PptEditExistingExclusiveLock;break;case 40:a=ResourceStrings.errorMessage_PptEditCheckedOutByAnother;break;case 42:a=ResourceStrings.errorMessage_EditWorkerTimeout;break;case 43:a=ResourceStrings.errorMessage_EditSlideCorruption;break;case 44:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 45:a=ResourceStrings.errorMessage_ClipartCannotConnect;break;case 46:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 47:a=ResourceStrings.errorMessage_Unknown;
break;case 48:a=ResourceStrings.errorMessage_Unknown;break;case 49:a=ResourceStrings.errorMessage_Unknown;break;case 50:a=ResourceStrings.errorMessage_Unknown;break;case 51:a=ResourceStrings.errorMessage_Unknown;break;case 52:a=ResourceStrings.errorMessage_Unknown;break;case 53:a=ResourceStrings.errorMessage_Unknown;break;case 54:a=ResourceStrings.errorMessage_Unknown;break;case 55:a=ResourceStrings.errorMessage_CannotOpenODPDocumentPassword;break;case 56:a=ResourceStrings.errorMessage_LocalChangeLost;
break;case 57:a=ResourceStrings.errorMessage_NumberOfCoauthorsReachedMax;break;case 59:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 60:a=ResourceStrings.errorMessage_ImageTooLarge;break;case 61:a=ResourceStrings.errorMessage_ImageWrongFormat;break;case 62:a=ResourceStrings.errorMessage_ImageNoAccess;break;case 63:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 64:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 65:a=ResourceStrings.errorMessage_WacConversionFailure;
break;case 66:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 67:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 68:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 69:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 70:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 71:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 72:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 73:a=ResourceStrings.errorMessage_WacConversionFailure;
break;case 74:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 75:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 76:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 77:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 78:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 79:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 80:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 254:a=ResourceStrings.errorMessage_CannotOpenDocument;
break;case 255:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 256:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 257:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 258:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 81:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 82:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 83:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 84:a=ResourceStrings.errorMessage_ClipartCannotDownload;
break;case 85:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 86:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 87:a=ResourceStrings.errorMessage_InsertLocalPictureTooLarge;break;case 88:a=ResourceStrings.invalidCanary;break;case 89:a=ResourceStrings.imageUploadRequestError;break;case 90:a=ResourceStrings.invalidImageFileError;break;case 91:a=ResourceStrings.imageUploadRequestError;break;case 92:a=ResourceStrings.imageUploadRequestError;break;case 93:a=ResourceStrings.imageUploadRequestError;
break;case 94:a=ResourceStrings.imageUploadRequestError;break;case 95:a=ResourceStrings.errorMessage_Unknown;break;case 96:a=ResourceStrings.errorMessage_Unknown;break;case 97:a=ResourceStrings.errorMessage_Unknown;break;case 98:a=ResourceStrings.errorMessage_Unknown;break;case 99:a=ResourceStrings.errorMessage_Unknown;break;case 137:a=ResourceStrings.errorMessage_TryAgain;break;case 100:a=ResourceStrings.errorMessage_Unknown;break;case 101:a=ResourceStrings.errorMessage_Unknown;break;case 102:a=
ResourceStrings.errorMessage_Unknown;break;case 103:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 104:a=ResourceStrings.errorMessage_LocalChangeLost;break;case 105:a=ResourceStrings.errorMessage_Unknown;break;case 238:a=ResourceStrings.errorMessage_Unknown;break;case 269:a=ResourceStrings.errorMessage_Unknown;break;case 262:a=ResourceStrings.errorMessage_Unknown;break;case 288:a=ResourceStrings.errorMessage_Unknown;break;case 268:a=ResourceStrings.errorMessage_Unknown;break;case 315:a=
ResourceStrings.errorMessage_Unknown;break;case 237:a=ResourceStrings.errorMessage_Unknown;break;case 228:a=ResourceStrings.errorMessage_Unknown;break;case 233:a=ResourceStrings.errorMessage_Unknown;break;case 231:a=ResourceStrings.errorMessage_Unknown;break;case 230:a=ResourceStrings.errorMessage_Unknown;break;case 426:a=ResourceStrings.errorMessage_Unknown;break;case 19:a=ResourceStrings.errorMessage_CannotSaveDocument;break;case 106:a=ResourceStrings.errorMessage_FailedToLocalSaveDocument;break;
case 107:a=ResourceStrings.errorMessage_NumberOfSessionsPerUserReachedMax;break;case 108:a=ResourceStrings.errorMessage_Unknown;break;case 109:a=ResourceStrings.errorMessage_NullPresentationId;break;case 111:a=ResourceStrings.errorMessage_CannotInsertOnlineVideo;break;case 112:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 143:a=ResourceStrings.errorMessage_InsertOnlinePictureTooLarge;break;case 113:a=ResourceStrings.errorMessage_ImageTooLarge;break;case 114:a=ResourceStrings.errorMessage_CannotPastePicture;
break;case 115:a=ResourceStrings.errorMessage_CannotPastePicture;break;case 116:a=ResourceStrings.errorMessage_CannotPastePicture;break;case 117:a=ResourceStrings.errorMessage_CannotOpenDocumentTooLarge;break;case 118:a=ResourceStrings.errorMessage_StorageOutOfMemory;break;case 141:a=ResourceStrings.errorMessage_CannotAcquirePptEditLock;break;case 142:a=ResourceStrings.errorMessage_BlockUIUnderDeployment;break;case 135:a=ResourceStrings.errorMessage_Unknown;break;case 144:a=ResourceStrings.errorMessage_FailedToRetrieveResource;
break;case 147:a=ResourceStrings.errorMessage_CannotInsertOnlinePictureNotFound;break;case 148:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 149:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 150:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 151:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 155:a=ResourceStrings.errorMessage_Unknown;break;case 156:a=ResourceStrings.errorMessage_Unknown;break;case 159:a=ResourceStrings.errorMessage_Unknown;
break;case 154:a=ResourceStrings.errorMessage_CannotOpenZeroByteDocument;break;case 157:a=ResourceStrings.errorMessage_TryAgain;break;case 158:a=ResourceStrings.errorMessage_Unknown;break;case 160:a=ResourceStrings.errorMessage_Unknown;break;case 168:a=ResourceStrings.errorMessage_Unknown;break;case 169:a=ResourceStrings.errorMessage_TryAgain;break;case 173:a=ResourceStrings.errorMessage_TryAgain;break;case 199:a=ResourceStrings.errorMessage_Unknown;break;case 200:a=ResourceStrings.errorMessage_CannotOpenDocument;
break;case 201:a=ResourceStrings.errorMessage_Unknown;break;case 202:a=ResourceStrings.errorMessage_ClipServicePasteCopyFailed;break;case 203:a=ResourceStrings.errorMessage_Unknown;break;case 204:a=ResourceStrings.errorMessage_Unknown;break;case 205:a=ResourceStrings.errorMessage_Unknown;break;case 206:a=ResourceStrings.errorMessage_Unknown;break;case 209:a=ResourceStrings.errorMessage_Unexpected;break;case 210:a=ResourceStrings.errorMessage_Unknown;break;case 211:a=ResourceStrings.imageUploadRequestError;
break;case 212:a=ResourceStrings.imageUploadTimeoutError;break;case 213:a=ResourceStrings.errorMessage_TryAgain;break;case 214:a=ResourceStrings.errorMessage_LocalChangeLost;break;case 215:a=ResourceStrings.errorMessage_Unknown;break;case 363:a=ResourceStrings.errorMessage_Unknown;break;case 287:a=ResourceStrings.errorMessage_CannotOpenZeroByteDocument;break;case 321:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 222:a=ResourceStrings.errorMessage_SlideTooManyShapes;break;case 247:a=
ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 275:a=ResourceStrings.errorMessage_DownloadAppSettingsFailed;break;case 244:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 295:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 245:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 246:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 249:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 250:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;
break;case 322:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 329:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 243:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 251:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 252:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 242:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 241:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;
case 293:a=ResourceStrings.errorMessage_TryAgain;break;case 294:a=ResourceStrings.errorMessage_TryAgain;break;case 379:a=ResourceStrings.errorMessage_TryAgain;break;case 296:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 297:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 298:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 332:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 354:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 355:a=
ResourceStrings.errorMessage_FailedToOpenDocument;break;case 356:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 357:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 365:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 364:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 358:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 369:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 333:a=ResourceStrings.errorMessage_ServiceUnavailable;
break;case 299:a=ResourceStrings.imageUploadTimeoutError;break;case 304:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 305:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 307:a=ResourceStrings.errorMessage_Unknown;break;case 353:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 308:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 377:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 309:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;
break;case 325:a=ResourceStrings.errorMessage_CannotAcquirePptEditSharedLock;break;case 352:a=ResourceStrings.errorMessage_Unknown;break;case 328:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 330:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 331:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 334:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 373:a=ResourceStrings.errorMessage_Unknown;break;case 374:a=ResourceStrings.errorMessage_CannotOpenDocument;
break;case 384:a=ResourceStrings.errorMessage_ZeroByteFileNotFound;break;case 391:a=ResourceStrings.errorMessage_CannotOpenDocumentWrongPassword;break;case 399:a=ResourceStrings.errorMessage_Unknown;break;case 400:a=ResourceStrings.errorMessage_Unknown;break;case 401:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 402:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 403:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 404:a=ResourceStrings.errorMessage_CannotInsertStream;
break;case 405:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 416:a=ResourceStrings.errorMessage_InsertLocalAudioTooLarge;break;case 418:a=ResourceStrings.errorMessage_InvalidNumberOfAudioFilesError;break;case 417:a=ResourceStrings.errorMessage_InvalidAudioFileError;break;case 422:a=ResourceStrings.errorMessage_EmptyAudioFileError;break;case 419:a=ResourceStrings.errorMessage_AudioUploadRequestError;break;case 424:a=ResourceStrings.errorMessage_AudioInvalidFileError;break;case 427:a=
ResourceStrings.errorMessage_InvalidAudioFileExtension;break;case 433:a=ResourceStrings.errorMessage_Unknown;break;case 434:a=ResourceStrings.errorMessage_Unknown;break;case 435:a=ResourceStrings.errorMessage_Unknown;break;case 440:a=ResourceStrings.errorMessage_UploadedMediaFilesNotReceived;break;case 441:a=ResourceStrings.errorMessage_UploadedInvalidMediaFileType;break;case 442:a=ResourceStrings.errorMessage_UploadedMediaTooLarge;break;case 443:a=ResourceStrings.errorMessage_UploadedInvalidMediaFileType;
break;case 444:a=ResourceStrings.errorMessage_UploadedMediaNonStandardResponse;break;case 445:a=ResourceStrings.errorMessage_UploadedMediaFilesNotReceived;break;case 446:a=ResourceStrings.errorMessage_UploadedMediaInternalError;break;case 447:a=ResourceStrings.errorMessage_UploadedMediaFilesNotReceived;break;case 449:a=ResourceStrings.errorMessage_MediaUploadTimeout;break;case 450:a=ResourceStrings.errorMessage_UploadedVideoTooLarge;break;default:a=ResourceStrings.errorMessage_Unknown}return a}Sde(a){switch(a){case 1:a=
ResourceStrings.errorTitle_Unknown;break;case 14:a=ResourceStrings.errorTitle_Unknown;break;case 2:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 3:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 4:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 41:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 33:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 34:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 35:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 36:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 5:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 6:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 7:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 8:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 306:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 9:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 10:a=ResourceStrings.errorTitle_WacStandard;break;case 12:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 15:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 16:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 17:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 18:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 20:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 21:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 22:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 23:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 58:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 24:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 25:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 26:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 27:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 28:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 29:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 30:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 31:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 37:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 32:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 11:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 13:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 38:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 39:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 40:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 42:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 43:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 44:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 45:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 46:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 47:a=ResourceStrings.errorTitle_Unknown;break;case 48:a=ResourceStrings.errorTitle_Unknown;break;case 49:a=ResourceStrings.errorTitle_Unknown;break;case 50:a=ResourceStrings.errorTitle_Unknown;
break;case 51:a=ResourceStrings.errorTitle_Unknown;break;case 52:a=ResourceStrings.errorTitle_Unknown;break;case 53:a=ResourceStrings.errorTitle_Unknown;break;case 54:a=ResourceStrings.errorTitle_Unknown;break;case 55:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 56:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 57:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 59:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 60:a=ResourceStrings.errorTitle_PasteImageFailed;
break;case 61:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 62:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 63:a=ResourceStrings.errorTitle_WacStandard;break;case 64:a=ResourceStrings.errorTitle_WacStandard;break;case 65:a=ResourceStrings.errorTitle_WacStandard;break;case 66:a=ResourceStrings.errorTitle_WacStandard;break;case 67:a=ResourceStrings.errorTitle_WacStandard;break;case 68:a=ResourceStrings.errorTitle_WacStandard;break;case 69:a=ResourceStrings.errorTitle_WacStandard;
break;case 70:a=ResourceStrings.errorTitle_WacStandard;break;case 71:a=ResourceStrings.errorTitle_WacStandard;break;case 72:a=ResourceStrings.errorTitle_WacStandard;break;case 73:a=ResourceStrings.errorTitle_WacStandard;break;case 74:a=ResourceStrings.errorTitle_WacStandard;break;case 75:a=ResourceStrings.errorTitle_WacStandard;break;case 76:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 77:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 78:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 79:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 80:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 254:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 255:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 256:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 257:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 258:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 81:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 82:a=
ResourceStrings.errorTitle_PowerpointStandard;break;case 83:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 84:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 85:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 86:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 87:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 88:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 89:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 90:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 91:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 92:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 93:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 94:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 95:a=ResourceStrings.errorTitle_Unknown;break;case 96:a=ResourceStrings.errorTitle_Unknown;break;case 97:a=ResourceStrings.errorTitle_Unknown;break;case 98:a=ResourceStrings.errorTitle_Unknown;break;case 99:a=ResourceStrings.errorTitle_Unknown;
break;case 137:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 100:a=ResourceStrings.errorTitle_Unknown;break;case 101:a=ResourceStrings.errorTitle_Unknown;break;case 102:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 103:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 104:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 105:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 238:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 269:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 262:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 288:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 268:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 315:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 237:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 228:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 233:a=
ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 231:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 230:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 426:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 19:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 106:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 107:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 108:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 109:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 111:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 112:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 143:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 113:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 114:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 115:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 116:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 117:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 118:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 141:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 142:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 135:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 144:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 147:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 148:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 149:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 150:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 151:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 155:a=ResourceStrings.errorTitle_Unknown;break;case 156:a=ResourceStrings.errorTitle_Unknown;break;case 159:a=ResourceStrings.errorTitle_Unknown;break;case 154:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 157:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;
case 158:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 160:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 168:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 169:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 173:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 199:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 200:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 201:a=ResourceStrings.errorTitle_Unknown;
break;case 202:a=ResourceStrings.errorTitle_PasteSlideFailed;break;case 203:a=ResourceStrings.errorTitle_Unknown;break;case 204:a=ResourceStrings.errorTitle_Unknown;break;case 205:a=ResourceStrings.errorTitle_Unknown;break;case 206:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 209:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 210:a=ResourceStrings.errorTitle_Unknown;break;case 211:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 212:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 213:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 214:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 215:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 363:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 287:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 321:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 222:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 247:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 275:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 244:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 295:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 245:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 246:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 249:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 250:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 322:a=
ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 329:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 243:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 251:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 252:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 242:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 241:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 293:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 294:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 379:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 296:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 297:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 298:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 332:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 354:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 355:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 356:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 357:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 365:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 364:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 358:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 369:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 333:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 299:a=
ResourceStrings.errorTitle_PowerpointStandard;break;case 304:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 305:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 307:a=ResourceStrings.errorMessage_Unknown;break;case 353:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 308:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 377:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 309:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 325:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 352:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 328:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 330:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 331:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 334:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 373:a=ResourceStrings.errorTitle_Unknown;break;case 374:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 384:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 391:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 399:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 400:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 401:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 402:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 403:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 404:a=
ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 405:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 416:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 418:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 417:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 422:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 419:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 424:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 427:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 433:a=ResourceStrings.errorTitle_Unknown;break;case 434:a=ResourceStrings.errorTitle_Unknown;break;case 435:a=ResourceStrings.errorTitle_Unknown;break;case 440:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 441:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 442:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 443:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 444:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 445:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 446:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 447:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 449:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 450:a=ResourceStrings.errorTitle_PowerpointStandard;break;default:a=ResourceStrings.errorTitle_Unknown}return a}OWc(a){switch(a){case 2:a=6;break;case 3:a=6;break;case 4:a=6;break;case 41:a=6;break;case 33:a=6;break;case 34:a=6;break;case 35:a=
6;break;case 36:a=6;break;case 5:a=6;break;case 6:a=6;break;case 7:a=6;break;case 8:a=116;break;case 306:a=116;break;case 9:a=6;break;case 10:a=6;break;case 15:a=6;break;case 16:a=8;break;case 17:a=6;break;case 20:a=12;break;case 22:a=8;break;case 23:a=2;break;case 58:a=2;break;case 24:a=2;break;case 25:a=2;break;case 26:a=2;break;case 27:a=2;break;case 28:a=2;break;case 31:a=8;break;case 37:a=2;break;case 32:a=8;break;case 13:a=2;break;case 38:a=2;break;case 39:a=2;break;case 40:a=2;break;case 42:a=
6;break;case 43:a=6;break;case 44:a=2;break;case 46:a=49;break;case 55:a=2;break;case 57:a=2;break;case 59:a=2;break;case 60:a=49;break;case 63:a=6;break;case 64:a=6;break;case 65:a=6;break;case 66:a=6;break;case 67:a=6;break;case 68:a=6;break;case 69:a=6;break;case 70:a=6;break;case 71:a=6;break;case 72:a=6;break;case 73:a=6;break;case 74:a=6;break;case 75:a=6;break;case 76:a=6;break;case 77:a=6;break;case 78:a=6;break;case 79:a=6;break;case 80:a=6;break;case 254:a=6;break;case 255:a=6;break;case 256:a=
116;break;case 257:a=116;break;case 258:a=6;break;case 81:a=49;break;case 82:a=49;break;case 83:a=49;break;case 84:a=49;break;case 85:a=49;break;case 86:a=49;break;case 105:a=8;break;case 238:a=8;break;case 269:a=8;break;case 262:a=8;break;case 288:a=8;break;case 268:a=8;break;case 315:a=8;break;case 237:a=8;break;case 228:a=8;break;case 233:a=8;break;case 231:a=8;break;case 230:a=8;break;case 426:a=8;break;case 19:a=12;break;case 106:a=6;break;case 107:a=2;break;case 117:a=6;break;case 118:a=2;break;
case 141:a=6;break;case 142:a=8;break;case 156:a=8;break;case 154:a=6;break;case 157:a=8;break;case 158:a=8;break;case 199:a=8;break;case 200:a=2;break;case 202:a=49;break;case 212:a=49;break;case 287:a=4;break;case 321:a=4;break;case 222:a=5;break;case 247:a=4;break;case 275:a=8;break;case 244:a=4;break;case 295:a=4;break;case 245:a=4;break;case 246:a=4;break;case 249:a=4;break;case 250:a=4;break;case 322:a=1;break;case 243:a=4;break;case 251:a=4;break;case 252:a=4;break;case 242:a=4;break;case 241:a=
8;break;case 293:a=12;break;case 294:a=12;break;case 296:a=6;break;case 333:a=12;break;case 299:a=49;break;case 304:a=6;break;case 353:a=6;break;case 308:a=12;break;case 377:a=12;break;case 309:a=4;break;case 325:a=6;break;case 352:a=10;break;case 328:a=12;break;case 330:a=4;break;case 331:a=4;break;case 334:a=6;break;case 374:a=6;break;case 384:a=2;break;case 391:a=6;break;case 399:a=8;break;case 400:a=8;break;case 449:a=49;break;case 450:a=49;break;default:a=0}return a}fpj(a){switch(a){case 5:a=
1;break;case 137:a=3;break;case 201:a=3;break;case 203:a=3;break;case 204:a=3;break;case 205:a=3;break;case 209:a=3;break;case 210:a=3;break;case 213:a=3;break;case 215:a=3;break;case 363:a=3;break;case 329:a=3;break;case 379:a=3;break;case 296:a=1;break;case 297:a=3;break;case 298:a=3;break;case 332:a=3;break;case 354:a=3;break;case 355:a=3;break;case 356:a=3;break;case 357:a=3;break;case 365:a=3;break;case 364:a=3;break;case 358:a=3;break;case 369:a=3;break;case 305:a=3;break;case 307:a=3;break;
case 373:a=3;break;case 391:a=1;break;case 433:a=3;break;case 434:a=3;break;case 435:a=3;break;default:a=1}return a}}Object(m.a)(hn,"DefaultErrorMapping",null,[1386]);var Ij=d(722);class Mk{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ErrorHandling"}Yb(a){this.K=a;a.register(1385,"PowerPointWebEditor.ErrorHandling.IDeployingDialog").ma().oa(()=>new gn(a.resolve("PowerPointWebEditor.Core.IPPTAppFrame")));a.register(1386,"PowerPointWebEditor.IErrorMapping").ma().oa(()=>new hn);a.register(1387,
"PowerPointWebEditor.IErrorDialog").ma().oa(()=>new Zl(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IErrorMapping"),a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("Common.IAppSettingsManager")));const b=new Bb.a(()=>new Ij.a(a.resolve("PowerPointWebEditor.BootStorage.IBackgroundReplicationScheduler"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IPPTServerResponseHelper"),
a.resolve("PowerPointWebEditor.IReplicationTimerFactory").x3b(a.resolve("Box4.IReplicationParameters")),Ib.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>w.AFrameworkApplication.Yg));a.register(1388,"PowerPointWebEditor.ErrorHandling.IRefreshDocExecutor").ma().oa(()=>new Ol(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("PowerPointWebEditor.IPresentationReader"),
b.value,w.AFrameworkApplication.mXf,this.K.Ia("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),a.resolve("Common.IAppSettingsManager").ka("DataSyncUseFluid")));a.register(1389,"PowerPointWebEditor.IDocRefreshHandler").ma().oa(()=>new Gj(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.ErrorHandling.IRefreshDocExecutor"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("Box4.IInteractiveViewManager"),a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.BootStorage.IBackgroundReplicationScheduler"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("Box4.IProofingManager"),a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.IErrorHandler"),b.value,a.resolve("PowerPointWebEditor.ErrorHandling.IDeployingDialog"),
()=>w.AFrameworkApplication.Yg,a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.IImageViewManager"),a.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventNotifier"),a.resolve("PowerPointWebEditor.IZoomContext")));a.register(mj,"PowerPointWebEditor.SeamlessFailoverHandler").ma().oa(()=>new mj(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),
a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Box4.IProofingManager"),a.resolve("PowerPointWebEditor.ErrorHandling.IDeployingDialog"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings"),()=>w.AFrameworkApplication.Yg));
a.register(1390,"PowerPointWebEditor.IDelayedErrorHandler").ma().oa(()=>new uo(this.K.resolve("PowerPointWebEditor.IErrorMapping"),this.K.resolve("PowerPointWebEditor.IErrorDialog"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.IDocRefreshHandler"),this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventNotifier"),
this.K.resolve("Box4.IReplicationScheduler"),this.K.resolve("PowerPointWebEditor.ISessionLifetimeManager"),this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.Ia("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")))}init(){this.K.resolve("PowerPointWebEditor.IDelayedErrorHandler");this.K.resolve("PowerPointWebEditor.IDocRefreshHandler").vb();this.K.resolve("PowerPointWebEditor.SeamlessFailoverHandler").vb()}dispose(){this.K.resolve("PowerPointWebEditor.SeamlessFailoverHandler").dispose()}static main(){n.a.instance.Ac(new Mk)}}
Object(m.a)(Mk,"PPTWebEditorErrorHandlingPackage",null,[2,3]);var ig=d(1266),Dh=d(87),zb=d(39);class dj{constructor(){this.font=null;this.j1c=this.isValid=!1}}Object(m.a)(dj,"EmbeddedFontClientStatus",null,[]);class am{constructor(a,b,c,f,l,y){this.jfd=this.keb=null;this.Ea=a;this.vy=b;this.oWg=c.yd(7);this.oc=f;this.CGb=l;this.xz=y;this.oWg.fk(Object(I.a)(this,this.qib,"onPresentationPropertyChanged"));this.vy.NFa(()=>{this.c9e(0)})}dispose(){this.oWg.Om(Object(I.a)(this,this.qib,"onPresentationPropertyChanged"))}get isInitialized(){return!!this.keb}get KPh(){return this.jfd}Q9d(a){return this.isInitialized?
this.keb.Fb(a)?this.keb.ga(a):null:null}createFontUrl(a){if(this.Ea.podsHtmlTextForEmbeddedFontsIsEnabled)if(xa.a.J(41521309,820,50,"CreateFontUrl"),this.isInitialized||this.c9e(2),this.isInitialized){var b=this.xz.pG(a);if((b=this.Q9d(b))&&!b.j1c&&b.isValid){b.font.Name!==a&&xa.a.J(41296397,820,15,"Name is not identical");a=aa.FontUtils.u7b(a);const c=this.CGb.resolve(Dh.a.m7i,am.v7i(b.font));ma.a.Xa(a)||ma.a.Xa(c)?xa.a.J(41296399,820,15,"FontFace name or url is invalid"):(this.xz.rRa(a,String.format("url('{0}')",
c)),b.j1c=!0)}}else xa.a.J(41296401,820,10,"Dictionary is not initialized")}qib(a,b){b&&b.node&&b.property&&b.property===zb.a.embeddedFonts&&this.c9e(1)}c9e(a){if(this.Ea.podsHtmlTextForEmbeddedFontsIsEnabled)if(xa.a.J(41521314,820,50,"UpdateEmbeddedFontDictionary, reason: {0}",a),a=this.oc.ugj()){this.keb?xa.a.J(41521346,820,50,"Dictionary is updated, count: {0}",a.length):(this.keb=new Uc.a,xa.a.J(41296405,820,15,"Dictionary is initialized, count: {0}",a.length));for(const b of a){if(ma.a.Xa(b.Name)){xa.a.J(41296407,
820,15,"Name is invalid");continue}if(0!==b.Style)continue;a=am.dXj(b);const c=this.xz.pG(b.Name),f=this.Q9d(c);f&&(f.isValid===a||f.j1c)||this.keb.$(c,Object.assign(new dj,{font:b,isValid:a,j1c:!1}))}this.jfd=am.GPi(this.keb);this.xz.fOl(this.jfd);aa.FontUtils.Mbi(this.jfd,Object(I.a)(this,this.createFontUrl,"createFontUrl"))}else xa.a.J(41296403,820,10,"EmbeddedFonts is null")}static v7i(a){return JSON.stringify(a)}static dXj(a){return!ma.a.Xa(a.Name)&&4>a.Style&&!a.IsRestricted&&(0===a.LoadResult||
270===a.LoadResult)}static GPi(a){const b={};for(let c of a)c.value.isValid&&(a=[],a.push(new ig.a("",0,0,"",[0])),b[c.key]=a);return b}}Object(m.a)(am,"EmbeddedFontsManager",null,[1377,107]);class um{}um.loading="loading";um.loaded="loaded";um.error="error";Object(m.a)(um,"FontFaceStatus",null,[]);class pl{constructor(){this.C$c=this.Pxg=!1;this.mze=null;this.init()}get jsg(){return this.C$c}load(a){return new Promise((b,c)=>{this.C$c&&!ma.a.Xa(a)||c([]);let f;f=this.Pxg&&-1<a.indexOf("'")?String.format('48px "{0}"',
a):String.format("48px '{0}'",a);this.mze.load(f).then(l=>{for(const y of l)ma.a.Xa(y.family)||y.status===um.loaded||xa.a.J(40429085,801,15,"Font load status {0}",y.status);l.length||xa.a.J(41494563,801,15,"No font resolved");b(l)},l=>{xa.a.J(41739607,801,10,"Rejected: {0}",l.toString());c(l)})})}init(){const a=window.document;this.mze=a&&a.fonts?a.fonts:null;this.C$c=!!this.mze;this.Pxg=!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("AllowSpecialCharacterFontsToRender");xa.a.J(41494593,
801,50,"FontFaceSetAPIIsSupported: {0}",this.C$c)}}Object(m.a)(pl,"FontFaceSetObserver",null,[1375]);class vm{constructor(a){if(!a)throw Error.argumentNull("fontFaceSetObserver");this.yeb=a}die(a){return a?a:{}}Whe(a){return a?a:()=>{}}CQh(a,b,c,f,l,y,H){if(!a)return[];b=this.die(b);c=this.Whe(c);f=this.die(f);l=this.Whe(l);y=this.die(y);H=this.Whe(H);const Q=[];for(const ia of a)ia in f?(l(ia),Q.push(this.yeb.load(String.format("{0}_MSCustomFont",ia)))):ia in b?(c(ia),Q.push(this.yeb.load(String.format("{0}_MSFontService",
ia)))):ia in y&&(H(ia),Q.push(this.yeb.load(String.format("{0}_EmbeddedFont",ia))));return Q}}Object(m.a)(vm,"FontsObserver",null,[1376]);class Sf{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Fonts"}Yb(a){this.K=a;this.K.register(1375,"PowerPointWebEditor.Fonts.IFontFaceSetObserver").ma().oa(()=>new pl);this.K.register(1376,"PowerPointWebEditor.Fonts.IFontsObserver").ma().oa(()=>new vm(this.K.resolve("PowerPointWebEditor.Fonts.IFontFaceSetObserver")));this.K.register(1377,"PowerPointWebEditor.Fonts.IEmbeddedFontsManager").ma().oa(()=>
new am(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener"),this.K.resolve("Box4.Graph.IGraphInstance"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PPTe.IResourceViewElementResolver"),this.K.resolve("PowerPointWebEditor.IFontUtilsManager")))}init(){this.K.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager")}dispose(){}static main(){n.a.instance.Ac(new Sf)}}Object(m.a)(Sf,"PPTWebEditorFontsPackage",
null,[2,3]);var bm=d(435);class Vn{mBh(){return!1}}Object(m.a)(Vn,"DefaultParagraphViewElementSetUpdateStrategy",null,[1404]);var sg=d(224),nf=d(1110),Jj=d(244);class If extends sg.a{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb){super(a,b,l);this.bDc=null;this.ZVb=rc.a.nil;this.Mgf=this.DFd=!1;this.yZ=this.xZ=this.Oob=this.Nob=-1;this.aGd=this.sVb=!1;this.ODc=this.F4c=this.CLd=this.arf=this.Mqb=null;this.Evd=0;this.kcf=this.a4a=this.Bif=null;a.pN.o0a(b);this.KWa=c;this.DLd=y;this.eZh=H;this.dZh=Q;this.b4h=
ia;this.hd=wa;this.FZh=Ua;this.mw=kb;this.S2a(!0);this.j0e(!0);this.fId=new Bb.a(Object(I.a)(this,this.GTi,"determineIsShapesAndTextboxesEnabled"));this.At=[];this.FOa=new Na.a;this.Lcf=new Na.a;this.Thb();this.Qc.Sh&&(b=this.Qc.onj(this.gb))&&(b.isSelected&&(this.aS.gIb=!0),b.z9&&(this.sVb=!0),this.aS.gIb&&(this.Nob=b.Qja,this.Oob=b.Rja,this.xZ=b.kT,this.yZ=b.vsa));a.qp&&(a=Object(qa.a)(1061,a))&&a.d_k(this.gb);this.kXb=f;this.vLd=Gb}get tLk(){return this.kXb}get gOe(){return this.DLd}get Oph(){return this.arf||
(this.arf=this.eZh())}get Fkd(){if(!this.CLd){const a=this.dZh();a&&(this.CLd=a.$Yl())}return this.CLd}get Xf(){return this.hd}get N_(){return this.FZh}get pug(){return this.ZVb}set pug(a){this.ZVb=a}get JJj(){return this.FOa}get Ydh(){return this.Pi?Ea.a.H3f(this.Pi,!1):0}get Pi(){return this.Mqb}get rbb(){return this.Bif}S2a(a){let b=!1;this.Grl(a)&&(a=this.a9a(),this.hc(a),this.bDc=null,this.ZVb=rc.a.nil,b=!0);this.Xf.ig&&this.gb.$mb?Sys.UI.DomElement.addCssClass(this.htmlElement,fc.p4):Sys.UI.DomElement.containsCssClass(this.htmlElement,
fc.p4)&&(Sys.UI.DomElement.removeCssClass(this.htmlElement,fc.p4),this.htmlElement.removeAttribute("title"));return b}Grl(a){let b=!!this.htmlElement;b=b&&0<this.htmlElement.getElementsByTagName("p").length;return a||!b||!this.Pi||"p"!==ma.a.rg(this.Pi.tagName)}a9a(){this.Mqb=this.Nd.lp(Ca.a.p);this.Mqb.className="Paragraph";this.Bif=this.Nd.lp(Ca.a.span);this.rbb.className="WACImageGroupContainer";return this.Nd.hm?this.Mqb:this.zVl()}zVl(){const a=this.Nd.lp(Ca.a.div);a.className="ParaWrappingDiv";
a.appendChild(this.Mqb);this.ap(this.Mqb);return a}$U(a){super.$U(a);if(this.gb.l_)return a=this.gb.l_.qc(a.p2).Pyc,this.gb.l_=null,new Jj.a(a.Una,a.minWidth,a.Vna);let b;b=this.kcf;a.Cb(88)&&(b=Jj.a.max(b,a.fr.iMa),a.Cc());return b}Yy(a){if(w.AFrameworkApplication.fa.ka("TextLayoutServiceUpdateLayoutLogicEnabled")&&(this.F4c=null,this.Pi)){const b=this.Pi.getElementsByClassName("LineBox");if(b&&0<b.length){this.F4c=Array(b.length);for(let c=0;c<b.length;c++)this.F4c[c]=Ea.a.Fv(b[c]).length}}this.S2a(!1)&&
(a.currentNode.anchor.sk(this.Na,8),a.parentNode.anchor.sk(this.Na,8),this.bDc=null);super.Yy(a);this.gNi(a,this.Pi)}gNi(a,b){var c=this.gb;if(this.Qc.Sh){var f=sa.InteractiveViewManager.instance.Rd;f&&f.Na===this.Qc.Na&&f.editingView.hm&&f.editingView.Gg===this.gb&&2===f.editingView.mode?Sys.UI.DomElement.addCssClass(this.htmlElement,If.nhg):Sys.UI.DomElement.removeCssClass(this.htmlElement,If.nhg)}if(c.l_)c=c.l_.qc(a.p2).htmlElement,Ea.a.T2b(c,b),b=this.Qc,b.Sh&&b.XF&128&&(this.gb.l_=null);else{a=
this.pnj();f=fb.StyleReader.I7f(a);fb.StyleReader.A3c(a)&&f?(Hb.d(b,va.a.role,Ve.a.dDf),Hb.d(b,va.a.fDf,f)):(b.removeAttribute(Ve.a.hf),b.removeAttribute(Ve.a.n0b));var l="";if(N.a.instance.ga(71)||N.a.instance.ga(77))l=this.vej(c);f=a=null;var y=Db.ParagraphReader.Cbg(c,N.a.instance.ga(53),N.a.instance.ga(71),N.a.instance.ga(77),N.a.instance.ga(54));if(this.Mgf||l!==this.bDc||this.ZVb!==c.XJe){a="WindowText";f="transparent";this.bDc=l;this.Mgf=!1;l="";let Q=null;"P"!==b.tagName&&y.dbb&&(Q=aa.FontUtils.Oja(y.fontName));
if(y.k4){var H=y.fontColor;H!==rc.a.auto&&(a=rc.a.bH(H))}N.a.instance.ga(49)||(y.hbb&&(H=y.gS,H!==rc.a.auto&&(f=rc.a.bH(H))),y.VUa&&(H=y.highlight,H!==rc.a.auto&&(f=rc.a.bH(H))));if(H=Db.ParagraphReader.language(this.gb))if(H=bb.a.He(H))b.setAttribute("xml:lang",H.name),b.setAttribute("lang",H.name);b.style.fontWeight=y.isBold?"bold":"normal";b.style.fontStyle=y.isItalic?"italic":"normal";b.style.verticalAlign="baseline";y.isSuperscript&&(b.style.verticalAlign="super");y.cG&&(b.style.verticalAlign=
"sub");y.xE&&(l="underline");if(y.bG||y.U_)l=0<l.length?l+" line-through":"line-through";b.style.textDecoration=l;b.style.fontFamily=Q?Q:"'Segoe UI',Tahoma,Verdana,'Sans-Serif'";y.QUa?1===y.capitalization?b.style.fontVariant="small-caps":2===y.capitalization?b.style.textTransform="uppercase":b.style.fontVariant="normal":b.style.textTransform=""}this.ZVb=c.XJe;N.a.instance.ga(49)&&(y.hbb&&(l=y.gS,l!==rc.a.auto&&(f=rc.a.bH(l))),y.VUa&&(y=y.highlight,y!==rc.a.auto&&(f=rc.a.bH(y))));this.gb.properties.sa(ab.a.Omg,
!1)?(Sys.UI.DomElement.addCssClass(b,"Conflict"),b.setAttribute(Ve.a.Rca,"conflictSRDescription")):(Sys.UI.DomElement.removeCssClass(b,"Conflict"),b.removeAttribute(Ve.a.Rca),f?(b.style.backgroundColor=f,If.xyf(f,b)):N.a.instance.ga(49)&&(b.style.backgroundColor="transparent",Sys.UI.DomElement.removeCssClass(b,"Highlight")));c.XJe!==rc.a.nil?(Sys.UI.DomElement.addCssClass(b,"NoteTagHighlight"),f&&(b.style.borderColor=f,If.xyf(f,b))):(Sys.UI.DomElement.removeCssClass(b,"NoteTagHighlight"),Sys.UI.DomElement.removeCssClass(b,
"Highlight"));a&&(b.style.color=a);c=Wd.OutlineElementReader.Gm(Za.OutlineElementNavigator.vB(this.gb));this.Qc.hm&&(c?Sys.UI.DomElement.addCssClass(b,"Rtl"):Sys.UI.DomElement.removeCssClass(b,"Rtl"));switch(Db.ParagraphReader.CL(this.gb)){case 1:b.style.textAlign="left";b.style.Fmb="";break;case 2:b.style.textAlign="center";b.style.Fmb="";break;case 3:b.style.textAlign="right";b.style.Fmb="";break;case 6:b.style.textAlign="justify";b.style.Fmb="auto";break;case 7:b.style.textAlign="justify";b.style.Fmb=
"distribute";break;case 9:case 11:case 10:b.style.textAlign="justify";b.style.Fmb="kashida";break;case 13:b.style.textAlign="justify";b.style.Fmb="inter-cluster";break;default:b.style.textAlign="",b.style.Fmb=""}4===Rc.App.mode&&N.a.instance.ga(86)&&z.a.Wj&&"right"===b.style.textAlign.toLowerCase()&&(a=b.style.paddingRight.toLowerCase(),""===a||"0px"===a)&&(b.style.paddingRight="1px");N.a.instance.ga(54)&&(Hb.d(b,va.a.Ux,this.gb.sa(Ab.a.yo,0)),Hb.d(b,va.a.nLk,this.gb.id.toString()));this.gOe.qxh(this.gb,
b,c,this.Na)}}pnj(){var a=N.a.instance.ga(71)?(a=fb.StyleReader.tE(this.gb))?fb.StyleReader.HQ(a):N.a.instance.ga(61)?fb.StyleReader.sNa:fb.StyleReader.Jpa:fb.StyleReader.Jpa;return a}vej(a){let b="";var c=fb.StyleReader.tE(a);c&&(b+=c.id);fb.StyleReader.xr&&({tableStyle:a,M8a:c}=fb.StyleReader.xr.Cab(a),a&&(b+=a.id),c&&(b+=c.id));return b}yba(){this.gb.t9(this.Na,16,!0)}Thb(){this.fId.value&&this.gb.sbb.Thb()}yK(a){if(!this.cyl()){this.Thb();var b=this.gb;this.YJf();Ea.a.vv(this.Pi);Ea.a.vv(this.rbb);
var c=this.Pi;c.style.minHeight="";this.At=[];this.Evd=0;var f=new Na.a,l=0;a&&(l=this.Nni(a,b,f,c,l));if(!this.byl()){a=!1;var y=this.htmlElement.parentNode,H=this.htmlElement.nextSibling;y&&(this.Tqc(y,this.htmlElement),a=!0);this.Fkd&&this.Fkd.sYl();var Q=l;l=this.tLk.P9k(b,this.Nd,c,this.JJj,f,Object(I.a)(this,this.O$g,"onOverHyperlink"),Object(I.a)(this,this.K$g,"onOutHyperlink"),Object(I.a)(this,this.sK,"takeOwnershipOfSubtree"),Object(I.a)(this,this.ap,"takeOwnership"),da.a.lRc,this.pug,l,
this.Nob,this.Oob,this.sVb,If.B3c,!!this.aS&&this.aS.gIb,this.DFd,Rc.App.oS.f1e,Wd.OutlineElementReader.Gm(Za.OutlineElementNavigator.vB(this.gb)));if(!w.AFrameworkApplication.fa.ka("TextLayoutServiceDataDeletionFixEnabled")||this.mw.AJf(b,f))this.mw.iKh(c,this.Nd,l.kwf,b,Q,f,ge.a.instance.Pa?ge.a.instance.Pa.mb:null,this.F4c)||this.Nd.qp||this.mw.YOh(b);this.At=f.toArray();this.ODc=l.y4g;this.Lcf=l.LJf;this.DFd=l.dhg;this.Fkd&&this.Fkd.nYl(this.Ydh);this.Oph&&this.Oph.qYl(c);this.DNh();this.aGd=
!0;a&&y.insertBefore(this.htmlElement,H);!this.Qc.hm&&y&&"li"===ma.a.rg(y.tagName)&&this.Tni(b,y);this.Qc.hm||this.mw.sMf(c)}}}Tni(a,b){if(Zb.ListReader.foa){if(b=this.cWc(a)){const c=b.qc(this.Qc.Na);if(c){const f=Ea.a.Nda(this.htmlElement,"Paragraph");this.bLk(a)?(a=(a=this.dnj(f))?a.nextSibling:null)?f.insertBefore(c.htmlElement,a):f.appendChild(c.htmlElement):Ea.a.URd(f,c.htmlElement);b.anchor.sk(this.Na,64)}}}else this.KWa.rOf(b,a,this.Na)}dnj(a){for(let b=0;b<a.children.length;b++){const c=
a.children[b];if(Sys.UI.DomElement.containsCssClass(c,"PageBreakBlob"))return c}return null}bLk(a){if(!a)return!1;a=a.Ta;if(!a)return!1;a=a.first;return a?(a=a.blob)?8===a.Bq:!1:!1}cWc(a){const b=new ob.GraphIterator;b.set(a);return b.kf()?(Za.OutlineElementNavigator.Te(b),this.Xf.ig&&!b.gJ(4)?b.Cb(31):b.Cb(4)):null}Nni(a,b,c,f,l){a=Yf.a.pb(a.p2,a.currentNode);if(!a.Oi())return l;let y=0,H=!1,Q=0,ia=0,wa=0,Ua=!1;const kb=Db.ParagraphReader.gX(b),Gb=this.fId.value;do{const ec=a.fr.htmlElement;Sys.UI.DomElement.containsCssClass(ec,
da.a.pW)?(Gb&&b.sbb.SYl?(Ua||(Zb.ListReader.Fx&&kb||b.sbb.KYl(this.rbb),f.appendChild(this.rbb)),this.rbb.appendChild(ec)):f.appendChild(ec),L.a.aw(ec,da.a.EGa,l++),c.add(ec),this.Qc.Sh&&({hwk:Q,Muk:ia,Luk:wa}=If.kml(b,ec,Gb,a,Ua,Q,ia,wa)),H=Ua=!0):f.appendChild(ec)}while(a.oFa());Gb?this.Qc.hm?this.EOl():(this.GNh(wa+6,ia+6),y=ia+6):y=ia-Q+6;H&&!Rc.App.instance.$Kj&&this.Qc.Sh&&f.clientHeight<y&&(f.style.minHeight=y+"px");return l}GNh(a=0,b=0){this.fId.value&&this.gb.sbb.JYl(this.rbb,a,b)}myd(){const a=
new Yf.a(this.Na);a.set(this.gb);a.kf();Za.OutlineElementNavigator.Te(a);Zb.ListReader.Fx&&(this.gOe.qxh(this.gb,this.Pi,Wd.OutlineElementReader.Gm(a.currentNode),this.Na),this.KWa.aPl(a))}DNh(){this.N_.Rmc(this.gb,this.Pi)}GTi(){const a=Ib.a.instance.qb("Box4.IFeatureHelper");return!!a&&a.isFeatureEnabled(130)}get isSelected(){return super.isSelected}set isSelected(a){super.isSelected=a;a||(this.yZ=this.xZ=this.Oob=this.Nob=-1)}get Qja(){return this.Qc.hm?this.gb.qc(this.Qc.Nf.Na).Qja:this.Nob}set Qja(a){this.Nob!==
a&&(this.Nob=a,this.wpa(16),this.gb.anchor.sk(this.Qc.Na,16))}get Rja(){return this.Qc.hm?this.gb.qc(this.Qc.Nf.Na).Rja:this.Oob}set Rja(a){this.Oob!==a&&(this.Oob=a,this.wpa(48),this.gb.anchor.sk(this.Qc.Na,48))}get kT(){return this.Qc.hm?this.gb.qc(this.Qc.Nf.Na).kT:this.xZ}set kT(a){this.xZ!==a&&(this.xZ=a,this.wpa(16),this.gb.anchor.sk(this.Qc.Na,16))}get vsa(){return this.Qc.hm?this.gb.qc(this.Qc.Nf.Na).vsa:this.yZ}set vsa(a){this.yZ!==a&&(this.yZ=a,this.wpa(48),this.gb.anchor.sk(this.Qc.Na,
48))}get z9(){return this.Qc.hm?this.gb.qc(this.Qc.Nf.Na).z9:this.sVb}set z9(a){this.sVb!==a&&(this.sVb=a,this.wpa(16),this.gb.anchor.sk(this.Qc.Na,16))}get cYf(){return this.At[this.At.length-1]}dispose(){this.I5k();super.dispose();this.YJf();for(let a of this.Lcf)a.wUf(this.Nd)}I5k(){if(this.a4a&&this.htmlElement)for(let a of this.a4a)a.H5k(this.htmlElement)}ioa(){super.ioa();this.DFd&&this.Qc.notify(2)}iyd(a){const b=w.AFrameworkApplication.fa.ka("Box4DoNotRenderPresenceOutOfView"),c=this.Qc.LNe.Ibe(this.gb);
this.vLd.Cph(c,this.a4a,this,this.htmlElement,b,this.itl());this.a4a=c;this.aGd||this.DNh();this.aGd=!1;super.iyd(a)}wpa(a){this.b4h.mBh(this.gb)||super.wpa(a)}cyl(){if(this.gpg()){const a=this.Qc;if(1!==a.editingView.Jvb)return a.W1d=!0}return!1}byl(){return this.Qc.hm&&Mb.SelectionEditor.Jua(ge.a.instance.Pa.mb)?!0:!1}EOl(){var a=this.gb.qc(this.Qc.Nf.Na);a&&(a=Sys.UI.DomElement.getBounds(a.rbb),this.GNh(a.width,a.height))}itl(){return!this.gpg()&&!this.Qc.hm}gpg(){if(sa.InteractiveViewManager.instance.Rd!==
this.Qc)return!1;const a=this.Qc.editingView;return a.Gg===this.gb&&2===a.mode}i0j(){const a=this.getBounds(),b=Bd.a.ki(this.Qc.container);return a.y+a.height>=b.y&&a.y<=b.y+b.height}wIe(a){a.Nqh(this);0<this.Evd&&a.ual(this)}get PZa(){return this.Pi}YNh(a){this.kcf=new Jj.a(0,a,0)}getBounds(){const a=T.a.Ptb(this.htmlElement.querySelector("p.Paragraph")||this.htmlElement,this.Qc.Sh?this.gb.id.toString():"");this.gOe.mji(this.gb,a,Wd.OutlineElementReader.Gm(Za.OutlineElementNavigator.vB(this.gb)),
this.Qc.Na);return a}O$g(a){sg.a.fpl(a.Bc,a.OD);if(Rc.App.n1b){const b=a.Bc,c=b.querySelector(".NormalTextRun")||b;N.a.instance.ga(8)||a.n_?c.style.cursor="pointer":c.style.cursor="text";Sys.UI.DomElement.addCssClass(b,If.VIe);nf.a.instance().lgi(Object(I.a)(this,this.xLe,"onCtrlKeyDown"));nf.a.instance().mgi(Object(I.a)(this,this.zLe,"onCtrlKeyUp"))}return!0}K$g(a){Sys.UI.DomElement.removeCssClass(a.Bc,If.VIe);nf.a.instance().Boh(Object(I.a)(this,this.xLe,"onCtrlKeyDown"));nf.a.instance().Coh(Object(I.a)(this,
this.zLe,"onCtrlKeyUp"));return!0}YJf(){for(let a=0;a<this.FOa.count;a++)Rc.App.Lb.nS.Bb(oa.a.Sfa,this.FOa.ga(a),Object(I.a)(this,this.O$g,"onOverHyperlink")),Rc.App.Lb.nS.Bb(oa.a.Tfa,this.FOa.ga(a),Object(I.a)(this,this.K$g,"onOutHyperlink")),nf.a.instance().Boh(Object(I.a)(this,this.xLe,"onCtrlKeyDown")),nf.a.instance().Coh(Object(I.a)(this,this.zLe,"onCtrlKeyUp"));this.FOa.clear();if(this.ODc){for(let a of this.ODc)Rc.App.Lb.nS.Bb(a.eventName,a.Bc,a.handler);this.ODc=null}}xLe(){this.cza("pointer")}zLe(){this.cza("text")}cza(a){for(let b=
0;b<this.FOa.count;b++)if(Sys.UI.DomElement.containsCssClass(this.FOa.ga(b),If.VIe)){const c=this.FOa.ga(b).querySelector(".NormalTextRun");if(c){c.style.cursor=a;break}}}static get B3c(){return!!ge.a.instance.Pa&&!!ge.a.instance.Pa.mb&&ge.a.instance.Pa.mb.B3c}static xyf(a,b){"transparent"!==a?Sys.UI.DomElement.addCssClass(b,"Highlight"):Sys.UI.DomElement.removeCssClass(b,"Highlight")}static kml(a,b,c,f,l,y,H,Q){b=Sys.UI.DomElement.getBounds(b);c&&(a=a.sbb.vXl(f.currentNode),b.x=a.x,b.y=a.y,b.height&&
b.width||(b.height=a.height,b.width=a.width));a=b.y+b.height;if(!l||b.y<y)y=b.y;if(!l||a>H)H=a;b=b.x+b.width;if(!l||b>Q)Q=b;return{hwk:y,Muk:H,Luk:Q}}}If.nhg="HiddenParagraph";If.VIe="MouseIsOn";Object(m.a)(If,"ParagraphViewElement",sg.a,[1066,1460,1029,472,107]);class Je extends sg.a{constructor(a,b,c,f,l,y){super(a,b);this.fh=this.hd=this.ica=this.DLd=null;Zb.ListReader.foa?(this.WTf(),this.j0e(!0),this.ica=c,this.DLd=l,this.hd=y,this.fh=f,this.S2a(!0)):(this.j0e(!1),a=this.Nd.lp(Ca.a.span),a.className=
"ListGhost",this.hc(a))}S2a(a){if(Zb.ListReader.foa){var b=this.f$f(this.gb);a&&(a=this.W0d(),this.hc(a),(b=Object(qa.a)(If,b.qc(this.Qc.Na)))&&b.htmlElement&&(b=b.Pi))&&((a=Ea.a.j7b(b,Je.hdb))?b.replaceChild(this.htmlElement,a):Ea.a.URd(b,this.htmlElement))}}get Qre(){return Ea.a.j7b(this.htmlElement,Je.jdc)}Yy(){this.S2a(!1);if(!this.Qc.hm&&Zb.ListReader.foa)if(this.hd.ig)this.Yll(this.htmlElement,this.Qre,this.gb);else{const a=this.ica.yCb(this.gb);this.Qre.innerText=a}}yK(a){this.Qc.hm||Zb.ListReader.foa&&
a.currentNode.anchor.sk(this.Na,64)}wIe(a){Zb.ListReader.foa&&a.Nqh(this)}get PZa(){return this.htmlElement}YNh(){}myd(){this.Zll()}Q8f(){return-1}Yll(a,b,c){var f=this.fh.Uae(c);if(f)if(12!==f.type)Da.a.instance.shipAssertTag(34930713,8,!1,"the node associated with the list is type [{0}]",f.type);else{var l=f.Ta,y=l?l.last.Qo:null;l=l?l.last.Ap:null;var H=f.$mb,Q=f.BKb,ia=f.a9();f=!!H&&Q.q6f(ia).Ua(Ab.a.listID);H=null;f&&(H=Q.Ua(Ab.a.listID)&&ia.Ua(Ab.a.listID)?3:Q.Ua(Ab.a.listID)?2:1);Q=this.ica.yCb(c);
c=this.ica.yCb(c);y=!!y||f&&(1===H||3===H);l=!!l||f&&(2===H||3===H);H=!y&&!l&&""!==Q&&Q!==c;for(ia=!y&&!l&&!H;b.hasChildNodes();)b.removeChild(b.firstChild);b.innerText="";b.style.color="";b.title="";Sys.UI.DomElement.removeCssClass(b,fc.Nre);Sys.UI.DomElement.removeCssClass(a,fc.p4);if(ia)b.innerText=c;else{if(l||H)ia=md.a.createElement(b.ownerDocument,Ca.a.span),Sys.UI.DomElement.addCssClass(ia,fc.fIh),ia.innerText=Q,b.appendChild(ia);if(y||H)Q=md.a.createElement(b.ownerDocument,Ca.a.span),Sys.UI.DomElement.addCssClass(Q,
fc.hIh),Q.innerText=c,b.appendChild(Q);y||l?b.style.color="#000":Sys.UI.DomElement.addCssClass(b,fc.Nre);f&&Sys.UI.DomElement.addCssClass(a,fc.p4)}}else Da.a.instance.shipAssertTag(34930712,8,!1,"No paragraph is found with a list node")}f$f(a){if(!a)return null;const b=new ob.GraphIterator;b.set(a);b.kf();return Za.OutlineElementNavigator.Te(b)?b.Cb(2):null}W0d(){const a=this.Nd.lp(Ca.a.span);Sys.UI.DomElement.addCssClass(a,Je.hdb);this.AOc(a);return a}AOc(a){const b=md.a.createElement(a.ownerDocument,
Ca.a.span);Sys.UI.DomElement.addCssClass(b,Je.jdc);b.style.textIndent="0px";b.style.textAlign="left";a.appendChild(b);return b}Zll(){if(!this.Qc.hm){var a=this.f$f(this.gb),b=a.qc(this.Qc.Na).htmlElement.parentNode;!this.Qc.hm&&b&&"li"===ma.a.rg(b.tagName)&&this.ica.VNh(b,a,this.Na,this.Qre,!1)}}}Je.hdb="ListMarkerWrappingSpan";Je.jdc="ListMarker";Object(m.a)(Je,"NumberListViewElement",sg.a,[1460,1029,472,107]);var F=d(396),V=d(1129);class za{constructor(a,b){this.offsetWidth=a;this.offsetHeight=
b}}Object(m.a)(za,"ListMarkerOffset",null,[]);class gb{constructor(){this.Skk="ListMarkerMeasuringPad";this.Jhc=new Jd.a}skj(a){let b=a.innerHTML;if(!b.length)return new za(0,0);var c=null;window.getComputedStyle&&(c=window.getComputedStyle(a,null))&&(b+=["",c.fontFamily,c.fontSize,c.fontStyle,c.fontWeight,c.fontVariant,c.textDecoration].join("_"));this.Jhc.Fb(b)||(a=a.cloneNode(!0),c&&(a.style.fontFamily=c.fontFamily,a.style.fontSize=c.fontSize,a.style.fontStyle=c.fontStyle,a.style.fontWeight=c.fontWeight,
a.style.fontVariant=c.fontVariant,a.style.textDecoration=c.textDecoration),V.a.C0b(),V.a.vab(this.Skk).appendChild(a),{width:c,height:a}=Bd.a.hVc(a),this.Jhc.$(b,new za(c,a)),V.a.r5b());return this.Jhc.ga(b)}}Object(m.a)(gb,"ListMarkerOffsetCache",null,[1379]);var Fb=d(1252),Ec=d(1269),$c=d(83),Ed=d(256),pe=d(187),Se=d(500);class Ye{constructor(a,b){this.hd=this.KZ=this.UK=null;this.fh=a;this.OG=b;this.KG=Zb.ListReader.Fx;this.Ex=z.a.Ex||z.a.Ho}get Uf(){return this.fh}get SM(){return this.OG}get cM(){return this.UK||
(this.UK=Ib.a.instance.qb("Box4.List.ListSettings"))}get Dka(){return this.KZ||(this.KZ=Ib.a.instance.Ia("Common.IZoomManager"))}set Dka(a){this.KZ=a}get Xf(){return this.hd||(this.hd=Ib.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get enabled(){return this.KG}yCb(a){const b=this.Uf.jab(a);return b&&b.propertySet.sa(ab.a.Zi,null)?1===b.listType?this.TFf(b):0===b.listType?this.G6g(b,a):"":""}$Ol(a,b){if(this.enabled&&b&&(this.Uf.xea(b)||this.Xf.ig&&63===b.type)&&this.bBb(a)){a.style.display=
"block";var c=this.uyb(a);this.ssd(a,b);c&&(a=this.yCb(b),c.innerText=a)}}rOf(a,b,c){if(this.enabled&&this.bBb(a)){var f=this.uyb(a);f&&this.VNh(a,b,c,f)}}VNh(a,b,c,f,l=!1){var y=ob.GraphIterator.pb(b);y.kf();Za.OutlineElementNavigator.Te(y);if(Zb.ListReader.Hk(y)||this.Xf.ig&&Zb.ListReader.dcc(y)){const Q=y.currentNode;var H=Wd.OutlineElementReader.Gm(Q);this.Xf.ig?this.Uf.P4g(y):this.Uf.Wna(y);y=y.currentNode;if(!Zb.ListReader.foa){const ia=this.yCb(y);f.innerText=ia}f.setAttribute(Ve.a.HI,Ve.a.lB);
12!==b.type?Se.a.J1c(b)&&(a=f.parentNode,f.style.height="auto",b=c=0,{width:c,height:b}=this.eyb(f),f.style.height="",c=-1*(Math.ceil(c)+13),f.style.marginLeft=H?"13px":c+"px",f.style.marginRight=H?c+"px":"13px",Ea.a.wkl(f,H?"right":"left"),H=0,{height:H}=this.eyb(a.parentNode),f.style.marginTop=Math.max((H-b)/2,0)+"px"):(this.Aol(a,f,b,Q,y,c),this.n9e(b,f,c,y,H,l))}}aPl(a){this.enabled&&a&&a.fr&&Wd.OutlineElementReader.Gm(a.currentNode)}m9e(a,b,c,f,l=-1){this.enabled&&(Db.ParagraphReader.gX(a)||
this.Xf.ig&&Db.ParagraphReader.CXj(a))&&this.TNh(a,b,c,l,null)}YOl(a,b,c){if(this.enabled&&this.bBb(a)){var f=Ea.a.W4f(a,Ye.GXi);if(f&&(f=Ea.a.W4f(f,Ye.FXi))&&(f=Ea.a.V8(f,Ye.mga))&&f.style&&(z.a.gg||(f.style.marginTop="0px"),(a=Ea.a.V8(a,Ye.rLk))&&(a=Ea.a.V8(a,Ye.mga))&&f.className.startsWith(Ye.mga))){if(this.Xf.ig){var l=Ea.a.Qxb(a,Ye.JMa);var y=Ea.a.Qxb(f,Ye.JMa)}else l=this.N7d(a,Ye.JMa),y=Ea.a.V8(f,Ye.JMa);l&&y&&(f.style.marginLeft!==a.style.marginLeft&&(f.style.marginLeft=""===a.style.marginLeft?
"0px":a.style.marginLeft),f.style.marginRight!==a.style.marginRight&&(f.style.marginRight=""===a.style.marginRight?"0px":a.style.marginRight),{a1f:b,P0f:c}=this.RNh(a,f,l,y,b,c),this.Dji(b,c,f))}}}N7d(a,b){return Ea.a.V8(a,b)}RNh(a,b,c,f,l,y){var H;""!==a.style.textIndent&&(y&&this.Uf.idb||""===b.style.textIndent)&&(y=a.style.textIndent,this.Uf.idb&&(H=this.bWc(a))&&(y=this.Nvi(H,y)),b.style.textIndent=y);y=this.byb(c);H=this.byb(f);Math.floor(H.x)!==Math.floor(y.x)?(a=this.Zvi(l,y,H),a=isNaN(a)?
0:a,""!==b.style.textIndent&&(l=b.style.textIndent,y=l.lastIndexOf("px"),0<y&&(l=l.substring(0,y),a+=parseInt(l))),b.style.textIndent=a+"px",y=this.byb(c),H=this.byb(f)):""===b.style.textIndent&&(b.style.textIndent=a.style.textIndent);return{a1f:y,P0f:H}}Zvi(a,b,c){let f=0;10>Math.abs(c.x-b.x)?this.cM.nZj||(f=this.g$f(a,b,c)):f=this.g$f(a,b,c);return f}g$f(a,b,c){return a?c.x-b.x:b.x-c.x}Nvi(a,b){let c=b,f;({width:f}=this.eyb(a));if(f){var l=a.style.marginLeft,y=a.style.marginRight;const H=l.lastIndexOf("px"),
Q=y.lastIndexOf("px");a=c.lastIndexOf("px");0<a&&0<H&&0<Q&&(l=this.kOe(l,H),y=this.kOe(y,Q),(b=this.kOe(b,a))||l||y)&&(c=b+f+l+y+"px")}return c}kOe(a,b){a=a.substring(0,b);a=parseFloat(a);return a=isNaN(a)?0:a}Dji(a,b,c){if(z.a.gg){if(.1<Math.abs(a.y-b.y)){let f=parseFloat(c.style.marginTop);f=isNaN(f)?0:f;c.style.marginTop=a.y-b.y+f+"px"}}else c.style.marginTop=a.y-b.y+"px"}Q8f(a,b=!1){return(a=this.uyb(a))?({width:a}=this.eyb(a),b?a+0:a):0}uyb(a){return this.enabled&&this.bBb(a)?(a=Se.a.Bkj(a))?
this.O8f(a):null:null}ssd(a,b,c=!1){if(this.enabled&&this.bBb(a)){if(this.Xf.ig){var f="1";var l=this.Uf.Qae(b)}else f=this.rkj(b),l=this.Uf.jab(b);b=this.J7b(b,l);c?(Hb.d(a,va.a.WQi,b),Hb.d(a,va.a.role,Ve.a.$Qa),Hb.d(a,va.a.VQi,f)):(Hb.d(a,va.a.sni,b),Hb.d(a,va.a.role,Ve.a.$Qa),Hb.d(a,va.a.fDf,f))}}O8f(a){if(!this.enabled||!a)return null;let b=null;(a=this.bWc(a))&&(b=Ea.a.V8(a,Ye.jdc)||this.AOc(a));return b}bBb(a){return!!a&&"li"===ma.a.rg(a.tagName)}TNh(){}g6f(){return 720}eyb(a){let b,c;({width:b,
height:c}=Bd.a.hVc(a));this.Dka&&this.Dka.instance&&this.Dka.instance.Yog(a)&&(b/=this.Dka.instance.G3,c/=this.Dka.instance.G3);return{width:b,height:c}}byb(a){const b=Bd.a.hVc(a).returnValue;this.Dka&&this.Dka.instance&&this.Dka.instance.Yog(a)&&(b.x/=this.Dka.instance.G3,b.y/=this.Dka.instance.G3);return b}Oka(a,b){switch(a.Oka()){case 0:return b+"";case 4:return ma.a.INf(b-1,!0);case 2:return ma.a.KNf(b,!0);case 3:return ma.a.INf(b-1,!1);case 1:return ma.a.KNf(b,!1);case 22:return 10>b?"0"+b:b+
"";default:return b+""}}TFf(a){if(1!==a.listType)return"";a=this.Dmj(a.listType,a.listStyle);return Ed.a.jFf(a[0])}G6g(a,b){b=this.J7b(b,a);return this.Oka(a,b)+"."}Dmj(a,b){return pe.a.NN(a,b).propertySet.sa(ab.a.Zi,null)}J7b(a,b){const c=b.kka;return c!==Ed.a.ax?c:this.ewi(a,b)}ewi(a,b){if(b.oX!==Ed.a.ax)return b.oX;if(b.SA!==Ed.a.ax)return b.SA;let c=1;const f=new ob.GraphIterator;f.set(a);f.kf();for(Za.OutlineElementNavigator.Te(f);f.qua();)if(Zb.ListReader.Hk(f)){const l=this.Uf.Gv(f);if(l&&
b&&l.listType===b.listType&&l.listStyle===b.listStyle){if(l.oX!==Ed.a.ax)return c+l.oX;if(l.SA!==Ed.a.ax)return c+l.SA;if(a.Ua(Ab.a.listID)&&f.currentNode.Ua(Ab.a.listID)&&f.currentNode.eb(Ab.a.listID)!==a.eb(Ab.a.listID))break;c++}}return c}DQl(a,b){Rc.App.gdb&&(a.Ua(ab.a.fontColor)&&(b.fontColor=a.eb(ab.a.fontColor)),a.Ua(ab.a.fontSize)&&(b.fontSize=a.eb(ab.a.fontSize)),a.Ua(ab.a.font)&&(b.fontName=a.eb(ab.a.font)),a.Ua(ab.a.bold)&&(b.isBold=a.eb(ab.a.bold)),a.Ua(ab.a.italic)&&(b.isItalic=a.eb(ab.a.italic)),
a.Ua(ab.a.superscript)&&(b.isSuperscript=a.eb(ab.a.superscript)),a.Ua(ab.a.subscript)&&(b.cG=a.eb(ab.a.subscript)),a.Ua(ab.a.strikethrough)&&(b.bG=a.eb(ab.a.strikethrough)),a.Ua($c.a.nt)&&(b.U_=a.eb($c.a.nt)))}Lbe(a,b){a=Db.ParagraphReader.Cbg(a,N.a.instance.ga(53),N.a.instance.ga(71),N.a.instance.ga(77),N.a.instance.ga(54));this.DQl(b,a);return a}Y5f(){return null}UNh(a,b,c,f){const l=c.parentNode;let y=f.sa(ab.a.fontSize,sd.Font.MI);if(a.cG||a.isSuperscript)Hb.d(c,va.a.qRf,(y/2).toString()),y=Math.floor(y*
lb.q7i),l&&(l.style.fontSize=y/2+"pt"),c.style.fontSize=y/2+"pt";else if(Zb.ListReader.foa){if(c.style.fontSize=y/2+"pt",!f.Ua(ab.a.fontSize)&&(a=Ea.a.Qxb(b,"EOP")))c.style.fontSize=a.style.fontSize}else c.style.fontSize=b.style.fontSize}Aol(a,b,c,f,l,y){b&&this.bBb(a)&&(b.style.verticalAlign=a.style.verticalAlign,f&&l&&Rc.App.gdb&&(y=f.tg(y)))&&(f=this.Lbe(c,l,N.a.instance.ga(53),N.a.instance.ga(71),N.a.instance.ga(77),N.a.instance.ga(54)),f=this.Y5f(y.Nd,c)||f,this.z7b(a,b,l),!this.Xf.ig||""===
b.style.color&&!Sys.UI.DomElement.containsCssClass(b,fc.Nre)?(c="",f.k4&&(y=f.fontColor,y!==rc.a.auto&&(c=rc.a.bH(y))),b.style.color=c,c=this.Uf.jab(l)):c=this.Uf.Qae(l),b.style.fontWeight=f.isBold&&1!==c.listType?"bold":"normal",b.style.fontStyle=f.isItalic&&1!==c.listType?"italic":"normal",f.isSuperscript?b.style.verticalAlign="super":f.cG&&(b.style.verticalAlign="sub"),this.UNh(f,a,b,l),f.bG||f.U_)&&(b.style.textDecoration=0<b.style.textDecoration.length?b.style.textDecoration+" line-through":
"line-through")}z7b(a,b){b.style.fontFamily=a.style.fontFamily}bWc(a){return a?Ea.a.j7b(a,id.a.hdb)||this.W0d(a):null}AOc(a){const b=md.a.createElement(a.ownerDocument,Ca.a.span);Sys.UI.DomElement.addCssClass(b,Ye.jdc);b.style.textIndent="0px";b.style.textAlign="left";a.appendChild(b);return b}W0d(a){if(!a)return null;const b=md.a.createElement(a.ownerDocument,Ca.a.span);Sys.UI.DomElement.addCssClass(b,id.a.hdb);Ea.a.URd(a,b);this.AOc(b);return b}n9e(a,b,c){this.m9e(a,b.parentNode.parentNode,this.SM.hyb(a).tRb,
this.SM.$$a(a).tRb,c)}}Ye.mga="Paragraph";Ye.rLk="ParaWrappingDiv";Ye.FXi="_EditingElement";Ye.GXi="_EditingElement_WrappingDiv";Ye.JMa="TextRun";Ye.jdc="ListMarker";Object(m.a)(Ye,"AListMarkerUtility",null,[1380]);var ae=d(66),lg=d(825);class og{}og.SWd=8226;og.RFf="Arial";og.i2d=65532;og.JJa=65533;Object(m.a)(og,"PptListConstants",null,[]);var se=d(63),Df=d(235);class Ci extends Ye{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc){super(a,b);this.Tdk=[12295,19968,20108,19977,22235,20116,
20845,19971,20843,20061];this.ite=c;this.Jhc=f;this.Ga=l;this.jm=y;this.Dqk=H;this.Rb=Q;this.xD=ia;this.Gh=wa;this.IJ=Ua;this.HH=kb;this.wA=Gb;this.mxg=ec;this.jYa=dc;this.zA=tc;this.iwa=Fc;this.dhc=yc}rkj(a){const b=new ob.GraphIterator;b.set(a);b.kf();Za.OutlineElementNavigator.Te(b);return b.currentNode.sa(Ab.a.listLevel,0)+1+""}TNh(a,b,c,f,l=null){const y=this.ite.Zp(ea.a.ZOl);l=new Yf.a(f);l.set(a);l.kf();Za.OutlineElementNavigator.Te(l);if(Zb.ListReader.Hk(l)){if(!b){this.ite.Xb(Kd.a.zh,{["Reason"]:"ParagraphElementNull"});
y.end();return}f=this.O8f(b);if(!f){this.ite.Xb(Kd.a.zh,{["Reason"]:"ListMarkerNotFound"});y.end();return}let H=this.eyb(f).width;const Q=l.fr.Nd.Md;a=Q.vK(this.SM.c9(a).oN,0);c=Q.vK(Fb.a.qga(c,0),0);this.zA&&Object(Wa.a)(415,this.wA.Rd)&&(c=0);l=Wd.OutlineElementReader.Gm(l.currentNode);this.Vll(b,f,a,c,H,l)}y.end()}eyb(a){a=this.Jhc.skj(a);return{width:a.offsetWidth,height:a.offsetHeight}}bWc(a){let b=a;this.jYa&&a&&0<=a.className.indexOf(xc.a.mga)&&(a=Ea.a.Nda(a,xc.a.Q9))&&(b=a);return super.bWc(b)}N7d(a,
b){return this.jYa?Ea.a.V8(a,xc.a.Q9)?Ea.a.Qxb(a,b):Ea.a.V8(a,b):super.N7d(a,b)}RNh(a,b,c,f){b.style.textIndent=a.style.textIndent;a=this.byb(c);f=this.byb(f);return{a1f:a,P0f:f}}Oka(a,b){switch(a.Oka()){case 18:return 21>b?ma.a.fromCharCode(b-1+9312):b.toString();case 19:return this.U9i(b)}return super.Oka(a,b)}TFf(a){let b="";if(1===a.listType){const c=a.propertySet.sa(ab.a.Zi,null);c&&c.length&&c[0]&&(b=ma.a.tw(c[0],4))}b=this.Uji(b?b:"2022",a);if(eb.a("FixEvalSecurityBugForListMarkerUtility")&&
String.fromCodePoint)return String.fromCodePoint(String.format("0x{0}",b));xa.a.J(512496919,809,15,"Use of Eval in ListMarkerUtility");return Object(Ec.a)(String.format("'\\u{0}'",b))}G6g(a,b){b=this.J7b(b,a);return this.Oka(a,b)+this.Cmj(a)}Vll(a,b,c,f,l,y){f?this.Xll(a,b,f,c,l,y):this.Wll(a,b,l,y)}Xll(a,b,c,f,l,y){const H=Math.max(Math.abs(c),l);a.style.textIndent=0<c?H+"px":Math.max(H-f,0)+"px";this.fxh(H-l,-1*H,b,y)}Wll(a,b,c,f){a.style.textIndent=c+"px";this.fxh(0,-1*c,b,f)}fxh(a,b,c,f){c.style.marginLeft=
f?a+"px":b+"px";c.style.marginRight=f?b+"px":a+"px"}Cmj(a){a=a.R9;for(let b=0;b<a.length;b++)if(a[b]===og.JJa){if(b+2>=a.length)break;return a[b+2]?ma.a.fromCharCode(a[b+2]):""}return"."}U9i(a){let b="";for(;0<a;)b=ma.a.fromCharCode(this.Tdk[a%10])+b,a=parseInt(String(a/10));return b}Uji(a,b){let c=a;1===b.listType&&b.cbb&&0<=Array.indexOf(Ci.Qdl,b.font)&&!a.indexOf("0")&&(c="f"+a.substr(1));return c}Lbe(a,b,c,f,l,y){if(!this.mxg)return super.Lbe(a,b,c,f,l,y);f=this.Rb.Lc(b);f.sc(11);f.Kg(11);l=this.IJ.BQ(f,
this.HH.Sda(f));c=new lg.ParagraphStandardProperties;(y=this.jm.x9(b))||this.Dqk.ZTj(b)?(c.fontColor=rc.a.pSa,c.fontSize=y?se.a.e6g:Db.ParagraphReader.tka(a,ab.a.fontSize,sd.Font.MI)):(b.Ua(ab.a.fontColor)?c.fontColor=b.eb(ab.a.fontColor):l&&l.Ua(ab.a.fontColor)&&!ae.isTableCellOrInside(f)?c.fontColor=l.eb(ab.a.fontColor):c.fontColor=this.Gh.tka(a,ab.a.fontColor,rc.a.nil),f=this.Gh.tka(a,ab.a.fontSize,sd.Font.MI),a=this.Ga.JEa(this.Ga.vn(a)),a*=f,b.Ua(zb.a.lxb)&&(a*=b.eb(zb.a.lxb)),c.fontSize=a);
return c}UNh(a,b,c){this.mxg&&(b=this.xD.$I(b))&&a.sua&&(c.style.fontSize=b.Nd.Md.Pja(a.fontSize),c.style.lineHeight="0.1")}n7f(a,b){let c="";const f=this.Uf.jab(b);1===f.listType&&f.cbb?c=f.font&&-1===f.font.indexOf(",")?aa.FontUtils.Oja(f.font):f.font:19===f.Oka()||18===f.Oka()&&21>this.J7b(b,f)?c=aa.FontUtils.Oja("Dengxian"):(b=null,a&&a.parentNode&&a.parentNode.parentNode&&(b=a.parentNode.parentNode.children[1]),b&&(c=b.style.fontFamily));return c}z7b(a,b,c){a=this.n7f(b,c);b.style.fontFamily=
a;b.style.fontFamily||!z.a.ik&&!z.a.Ho||("Wingdings 3,Sans-Serif"===a?b.style.fontFamily="'Wingdings 3','Sans-Serif'":"Wingdings 2,Sans-Serif"===a&&(b.style.fontFamily="'Wingdings 2','Sans-Serif'"))}n9e(a,b,c,f,l,y=!1){if(this.jYa){if(b=b.parentNode.parentNode)b=0<=b.className.indexOf(xc.a.Q9)?b.parentNode:b,this.m9e(a,b,this.SM.hyb(a).tRb,this.SM.$$a(a).tRb,c)}else super.n9e(a,b,c,f,l,y)}uyb(a){return super.uyb(a)}jkj(a,b){return this.J7b(b,a)}ssd(a,b,c=!1){if(this.iwa){const l=this.Rb.Lc(b);l.sc(11);
l.Kg(11);l.Cb(2);if(c){if(b&&b.Ua(zb.a.ong)&&!b.eb(zb.a.ong)){var f=b.sa(ab.a.Zi,null);f&&0<f.length&&a.setAttribute("data-charcodes",f.toString());f=this.uyb(a);f=this.n7f(f,b);ma.a.Xa(f)||a.setAttribute("data-font",f);a.setAttribute("data-buAutoNum",b.sa(zb.a.autonumberBulletType,8))}this.dhc&&l.currentNode.Ua(zb.a.ane)&&!l.currentNode.eb(zb.a.ane)&&a.setAttribute("data-margin",l.currentNode.sa(Ab.a.nm,Df.a.leftMargin).toString())}}super.ssd(a,b,c)}Y5f(a,b){return this.zA&&a&&b&&(Object(Wa.a)(415,
a)||Object(Wa.a)(415,this.wA.Rd)&&a.hm)?(a=new lg.ParagraphStandardProperties,a.fontName=sd.Font.sT,a.fontColor=rc.a.pSa,a.fontSize=se.a.bzl,a):null}}Ci.Qdl="Symbol;Wingdings;Wingdings 2;Wingdings 3;Webdings;Wingdings,Sans-Serif".split(";");Object(m.a)(Ci,"ListMarkerUtility",Ye,[975]);class oj{static mck(){"GetSpecialIndentWithTabs"in oj.wth||(oj.wth.GetSpecialIndentWithTabs=!0,xa.a.J(40649491,817,15,"{0}:{1}","GetSpecialIndentWithTabs","Invalid tab size"))}}oj.wth={};Object(m.a)(oj,"SessionLogger",
null,[]);class Pl{constructor(a,b,c,f,l,y){this.sad=a;this.J$=b;this.Gh=c;this.Rb=f;this.IJ=l;this.wAg=y}qxh(a,b,c,f=-1){let l=this.wAg;0<=f&&(l=this.t6f(a,f)||l);this.Nml(a,b,c,l);this.Oml(a,b,l,f)}t6f(a,b){let c=null;(a=a.qc(b))&&a.Nd&&(c=a.Nd.Md);return c}Nml(a,b,c,f){let l=0;this.Gh.gX(a)||(l=f.vK(this.J$.c9(a).oN,0));c?(b.style.marginLeft="",b.style.marginRight=l+"px"):(b.style.marginLeft=l+"px",b.style.marginRight="")}Oml(a,b,c,f=-1){var l=this.J$.tVc(a).oN;a.anchor&&this.Gh.gX(a)&&0<=f?this.sad.m9e(a,
b,Fb.a.vK(l,0),0,f):(f=c.vK(l,0),l=c.vK(this.J$.c9(a).oN,0),b.style.textIndent=this.Wsj(f,l,this.jJi(a),this.kfj(a),c)+"px")}jJi(a){let b=0;if(void 0!==a&&null!==a&&(a=a.characterData))for(;b<a.length;)if("\t"===a.charAt(b))b++;else break;return b}kfj(a){let b=a.sa(Ab.a.Tvb,Pl.zLc);if(!a.Ua(Ab.a.Tvb)){const c=this.Rb.Lc(a);c.set(a);c.sc(11);c.Kg(11);(a=this.IJ.BQ(c,a.sa(Ab.a.listLevel,Df.a.yFa)))&&(b=a.sa(Ab.a.Tvb,Pl.zLc))}return b}Wsj(a,b,c,f,l){a=-1*a<b?a:-1*b;if(!c)return a;0>a&&(c--,a=0);0>=f&&
(c=0,oj.mck());0<c&&(f=l.vK(f,0),a=(Math.floor((a+b)/f)+c)*f-b);return a}mji(a,b,c,f=-1){var l=this.wAg;0<=f&&(l=this.t6f(a,f)||l);a=this.J$.tVc(a).oN;l=l.vK(a,0);0>l&&(c||(b.x+=l),b.width-=l)}}Pl.zLc=1440;Object(m.a)(Pl,"ParagraphViewIndentationStrategy",null,[1459]);var Pf=d(431),Rm=d(649),Zf=d(372),Ge=d(150),Si=d(233),Fn=d(264);class ck{constructor(a,b,c){this.success=a;this.MKk=b;this.qTk=c}}Object(m.a)(ck,"AddSpansForThisLinePerTextLayoutPropertyResult",null,[]);var Mo=d(831);class Gm{constructor(){this.Xm=
new J.DictionaryPropertySet}eb(a){return this.Xm.eb(a)}sa(a,b){return this.Xm.sa(a,b)}Ua(a){return this.Xm.Ua(a)}get propertySet(){return this.Xm.clone()}get wL(){return this.Xm.sa(ab.a.font,sd.Font.sT)}get wV(){return this.Xm.sa(Ab.a.wV,-1)}get fieldInstruction(){return this.Xm.sa(Ab.a.fieldInstruction,"")}get sua(){return this.Xm.Ua(ab.a.fontSize)}get fontSize(){return this.Xm.sa(ab.a.fontSize,sd.Font.MI)}get k4(){return this.Xm.Ua(ab.a.fontColor)}get fontColor(){return this.Xm.sa(ab.a.fontColor,
rc.a.nil)}get Igg(){return this.Xm.Ua(Mo.a.j2b)}get Q1f(){return this.Xm.sa(Mo.a.j2b,1)}get VUa(){return this.Xm.Ua(ab.a.highlight)}get highlight(){return this.Xm.sa(ab.a.highlight,rc.a.nil)}get hbb(){return this.Xm.Ua($c.a.gS)}get gS(){return this.Xm.sa($c.a.gS,rc.a.nil)}get Kgg(){return this.Xm.Ua(ab.a.yt)}get language(){return this.Xm.sa(ab.a.yt,0)}get PUa(){return this.Xm.Ua(ab.a.bold)}get isBold(){return this.Xm.sa(ab.a.bold,!1)}get ebb(){return this.Xm.Ua(ab.a.italic)}get isItalic(){return this.Xm.sa(ab.a.italic,
!1)}get Azb(){return this.Xm.Ua(ab.a.underline)}get xE(){return this.Xm.sa(ab.a.underline,!1)}get OYc(){return this.Xm.Ua(ab.a.gw)}get gw(){return this.Xm.sa(ab.a.gw,sd.Font.BV)}get zzb(){return this.Xm.Ua(ab.a.strikethrough)}get bG(){return this.Xm.sa(ab.a.strikethrough,!1)}get I9b(){return this.Xm.Ua($c.a.nt)}get U_(){return this.Xm.sa($c.a.nt,!1)}get isSuperscript(){return this.Xm.sa(ab.a.superscript,!1)}get cG(){return this.Xm.sa(ab.a.subscript,!1)}get YG(){return this.Xm.sa(Ab.a.YG,null)}get xt(){return this.Xm.sa(ab.a.xt,
!1)}get X_(){return this.Xm.sa(ab.a.X_,!1)}get yn(){return this.Xm.sa(ab.a.yn,!1)}get Vbb(){return this.Xm.sa(Ab.a.Vbb,!1)}get XVa(){return this.Xm.sa(ee.a.Bxa,!1)}get QUa(){return this.Xm.Ua($c.a.capitalization)}get capitalization(){return this.Xm.sa($c.a.capitalization,0)}get PFa(){return this.Xm.sa(Ab.a.PFa,!1)}fq(a,b){b.Ua(a)&&this.Xm.setValue(a,b.Rh(a))}static $Kc(a){const b=new Gm;b.Xm.setValue(ab.a.fontSize,se.a.Zyl);b.fq(ab.a.superscript,a.propertySet);b.fq(ab.a.subscript,a.propertySet);a.xt&&
b.Xm.setValue(ab.a.underline,!0);return b}}Object(m.a)(Gm,"PptSmartArtFormattingCache",null,[917]);class Nk{constructor(a,b,c,f){this.vpi=a;this.ypi=b;this.wpi=c;this.xpi=f}}Object(m.a)(Nk,"SelectionImageProperty",null,[]);var cl=d(149),wf=d(69);class Ug{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye,Xd,Xf,ug,qg){this.lFg=this.kFg=!1;if(!ug)throw Error.argumentNull("graphTopologyManager");this.wA=a;this.Ga=b;this.jc=c;this.vfk=f;this.Wo=l;this.xD=y;this.Vic=H;this.yy=Q;this.wz=
ia;this.HX=wa;this.ta=ug;this.Veb=Ua;this.m$c=kb;this.QEb=Gb&&!xd;this.jYa=ec;this.rYa=dc;this.ZEb=Fc;this.Hgc=yc;this.hfd=tc&&!xd;this.zA=Vd;this.Tma=Ld;this.n$c=ye;this.Kjf=Xd;this.pkk=Xf;this.ta=ug;this.hkk=qg}Y$a(a,b){if(b.sa(zb.a.fGa,!1))return se.a.e6g;b=this.Ga.JEa(this.Ga.vn(b));return ah.a.qz(b,1)?a:2*Math.round(a*b/2)}KCf(a,b){if(!this.Kjf||!a)return b;const c=Ug.o7f(a);if(a===c)return b;eb.a("PPTO.TextRendering.UpdateFontFamilyWithWebFontFallback")&&(this.yy&&this.yy.YWj?({E6b:b}=Ug.Cxd(a,
this.yy.tcc(a),b)).returnValue||({E6b:b}=Ug.Cxd(c,this.yy.QTj(c),b)).returnValue:({E6b:b}=Ug.Cxd(c,!0,b)).returnValue&&({E6b:b}=Ug.Cxd(a,!0,b)).returnValue);return b}lrj(a){if(!this.hkk||ma.a.Xa(a))return null;const b=this.ta.presentation.n8d;if(!b)return null;for(const c of b)if(c.Font===a)return c.SubstitutedByFont;return null}p7f(a,b,c){return c.Pja(this.Y$a(a,b))}T4f(a,b){return a.Ua(zb.a.Iub)?b.Daa(a.eb(zb.a.Iub)/Pf.a.Ioc,0)+"px":null}s8f(a){if(a.Ua(zb.a.fCb)){const b=a.eb(zb.a.fCb)/Pf.a.Ioc;
a=a.fontSize;return 0<b&&a*Pf.a.nbb>=b?"normal":"none"}return null}bae(a,b,c,f){let l=null;this.Veb?l=rc.a.bH(0):!c&&f||!b.k4?this.QEb&&f&&(l=N.a.instance.ga(119)?b.sa(zb.a.fVa,!1)?this.P7f(a):rc.a.bH(b.fontColor):this.P7f(a)):(a=b.fontColor,l=a===rc.a.auto?"WindowText":rc.a.bH(a));return l}pBh(a,b,c,f,l){return!b&&!c&&!f&&!l&&(!this.m$c||a.isSuperscript||a.cG)}Vbg(a){return a.Ua(zb.a.EN)?a.eb(zb.a.EN)/1E3:0}rde(){return 2/3}P7f(a){let b=null;var c=Object.assign(new Rm.a,{schemeClrField:Object.assign(new Zf.a,
{valField:10})});a=Object(qa.a)(117,this.jc.mg(a));(c=this.vfk.UH(c,a?a.Ed:null))&&(b=Ge.Box4ColorHelper.jha(c).yV());return b}TAh(a,b){return this.QEb||a||!b}yBh(){return!0}VAh(){return this.QEb}SQl(a,b,c,f){if(!c||!c.Va||!f||1>f.length)return b;let l=0,y=0;for(let H=0;H<f.length;H++){if(c.Va.Sa>=y&&c.Va.Sa<y+f[H]||c.Va.Sa===y+f[H]&&f[H]>b.Lines[H]){l=H;break}y+=f[H]}c=0;for(const H of b.Lines)c+=H;a=a.Ta.ga(a.Ta.length-1).cp;a+1!==c&&(b.Lines[l]+=a+1-c);return b}AJf(a,b){a=Object(qa.a)(kf.AParagraphNode,
a);if(!a||!a.Ta)return!1;let c=0;for(let f of b)if(0>f.className.indexOf("EOP")){if(f.innerText!==a.characterData.substr(c,f.innerText.length))return!1;c+=f.innerText.length}return!0}iKh(a,b,c,f,l,y,H,Q){if(!(this.jYa&&a&&c&&c.length&&b))return!1;var ia=this.Ga.vn(f);if(!ia)return!1;ia=this.rYa&&ia.YDb;if(!b.qp&&!ia)return!1;f=Object(qa.a)(kf.AParagraphNode,f);if(!f||!f.Ta||!ia&&this.Vic.s9a(f))return!1;c=this.aej(c,f,!b.qp);if(this.wTi(a,c))return!1;if(0<=a.style.textAlign.indexOf("justify")){if(!this.Wo||
this.Wo.dva)return!1;Sys.UI.DomElement.addCssClass(a,"JustifyAlign")}else Sys.UI.DomElement.removeCssClass(a,"JustifyAlign");return this.ZEb?this.eJl(f,a,b,l,y,H,Q):this.cJl(a,b,c)}YOh(a){this.rYa&&a&&(a=this.Ga.vn(a))&&a.YDb&&(xa.a.J(512496915,820,50,"UpdateUseTextLayoutService - Fallback to HTML Text Layout for this shape."),a.wnb(!1))}fkj(a,b){const c=cl.a.ri(a,zb.a.UPb,null);if(!c||!c.Lines)return null;if(!b){if(!a.Ta.length)return xa.a.J(512496914,820,50,"GetLineInfoIfValid - CharacterProperties length 0, TextLayout {0}",
c.Lines.length),null;b=0;for(const f of c.Lines)b+=f;if(a.Ta.ga(a.Ta.length-1).cp+1!==b)return null}return c}cJl(a,b,c){if(!c)return!1;const f=new Na.a;for(const l of c){c=b.lp(Ca.a.span);Sys.UI.DomElement.addCssClass(c,xc.a.Q9);f.add(c);let y=!1;for(let H=0;H<l;H++)if(a.firstChild)c.appendChild(a.firstChild);else{xa.a.J(512496913,820,10,"Span count not match between paragraph and countOfSpanInLine");y=!0;break}if(y)break}b=Object(qa.a)(1066,this.xD.$I(a));if(!b)return xa.a.J(512496912,820,10,"Line Box is not added because the ownership of paragraph dom is null"),
!1;for(let l of f)b.ap(l),a.appendChild(l);return!0}eJl(a,b,c,f,l,y,H){if(!b||!c)return!1;let Q=cl.a.ri(a,zb.a.UPb,null);if(!Q||!Q.Lines||!Q.Lines.length)return!1;for(this.pkk&&(Q=this.SQl(a,Q,y,H));l.count>f;)l.removeAt(f);a=new Na.a;H=y=f=null;for(let ia=0;ia<Q.Lines.length;ia++){f=c.lp(Ca.a.span);Sys.UI.DomElement.addCssClass(f,xc.a.Q9);a.add(f);const wa=this.Vdi(Q.Lines[ia],b,f,y,H,l);y=wa.MKk;H=wa.qTk;this.hdk(ia,Q.Lines.length,f.lastChild);if(!wa.success){xa.a.J(512496911,820,50,"TryAddLineBoxWithSpanUpdatePerTextLayoutProperty - Number of chars specified by text layout not available in paragraph");
break}}for(this.RIc(y,f,l);b.firstChild;)this.RIc(b.firstChild,f,l);return this.dJl(b,a)}hdk(a,b,c){Ug.nFg||($d.Health.instance.recordKpiUsage("TextLineBreakWordBreakTelemetry",0,"pptotext",null),Ug.nFg=!0);!c||!c.innerText||1>c.innerText.length||(a=a+1===b,b=-1<c.innerText.indexOf(" "),c=" "!==c.innerText.charAt(c.innerText.length-1),!Ug.mFg&&!a&&b&&c&&($d.Health.instance.recordKpiFailure("TextLineBreakWordBreakTelemetry","TLSWordBreakError",!1,!0,null),Ug.mFg=!0))}Vdi(a,b,c,f,l,y){let H=!0;for(;0<
a;){if(!(f&&f.innerText.length||b.firstChild)){xa.a.J(512496910,820,10,"TryAddLineBoxSpanPerTextLayoutProperty - Number of chars specified not available");H=!1;break}let Q;f?(l=Q=f,f=null):(Q=b.firstChild,l&&!Sys.UI.DomElement.containsCssClass(Q,xc.a.VN)&&(l.style.lineHeight=Q.style.lineHeight),l=null);const ia=Q.innerText.length;a>=ia?(this.RIc(Q,c,y),a-=ia):(f=Q.cloneNode(!1),this.fAl(Q,f,a),this.RIc(Q,c,y),a-=Q.innerText.length)}return new ck(H,f,l)}fAl(a,b,c){a=a.childNodes;let f=-1;for(let l=
0;l<a.length;l++){const y=a[l];if(c)if(c>=y.innerText.length)c-=y.innerText.length;else{const H=y.cloneNode(!0);H.innerText=y.innerText.substring(c,y.innerText.length+1);b.appendChild(H);y.innerText=y.innerText.substring(0,c);c=0}else{f=l;break}}for(;-1!==f&&f<a.length;)b.appendChild(a[f])}RIc(a,b,c){if(a&&b&&c){b.appendChild(a);a=Ea.a.iab(a);for(let f of a)c.add(f),L.a.aw(f,"leafEltIdx",c.count-1)}}dJl(a,b){const c=Object(qa.a)(1066,this.xD.$I(a));if(!c)return xa.a.J(512496909,820,10,"Line Box is not added because the ownership of paragraph dom is null"),
!1;for(let f of b)c.ap(f),a.appendChild(f);return!0}aej(a,b,c){const f=this.qIi(this.fkj(b,c));if(!f||!f.length)return null;c=f.length;const l=Array(c);let y=0,H=1;for(let Q=0;Q<b.Ta.length;Q++)H<c&&b.Ta.ga(Q).cp===f[H]&&(l[y]=a[Q],y++,H++);l[c-1]=a[a.length-1];if(H!==c)return xa.a.J(512496908,820,50,"indexOfLineStartCp and countOfLine( TextLayout property) do not match"),null;a=Array(c);a[0]=l[0];for(b=1;b<c;b++)a[b]=l[b]-l[b-1];return a}qIi(a){a=a?a.Lines:null;if(!a||!a.length)return a;const b=
Array(a.length);b[0]=0;for(let c=1;c<a.length;c++)b[c]=b[c-1]+a[c-1];return b}wTi(a,b){if(!b)return!1;a=a.childNodes;let c=0;for(const f of b){b=!0;for(let l=c;l<f+c&&l<a.length;l++)Sys.UI.DomElement.containsCssClass(a[l],xc.a.FN)||Sys.UI.DomElement.containsCssClass(a[l],xc.a.W4d)||(b=!1);if(b)return!0;c+=f}return!1}V5f(a,b,c){const f=new Uc.a;if(!a||!b||!c)return xa.a.J(512496907,826,15,"GetCustomAttributes: htmlViewInstance={0}, paragraphNode={1}, formattingCache={2}.",a?"not null":"null",b?"not null":
"null",c?"not null":"null"),f;this.orl(a,b)&&(a=null,c.Ua(zb.a.schemeColor)&&(a=c.eb(zb.a.schemeColor),a=this.tmj(b,a)),ma.a.Xa(a)||f.$("data-scheme-color",a),this.n$c&&c.Ua(zb.a.K0c)&&(c.eb(zb.a.K0c)?f.$("data-usefontface","false"):f.$("data-usefontface","true")),eb.a("HyperlinkColorBugFix")&&c.Ua(zb.a.fVa)&&(c.eb(zb.a.fVa)||f.$("data-hyperlinkhascustomcolor","true")));return f}tmj(a,b){if(ma.a.Xa(b))return"";const c=Fn.SchemeColor.parse(b);if(c&&c.color&&!c.rua){a=Object(qa.a)(117,this.jc.mg(a));
a=c.resolve(a?a.Ed:null);if(!a)return"";c.lQ=Si.g(a.Q0a);return c.toString()}return b}orl(a,b){return this.Hgc&&a.hm&&Ug.Y3j(b)}sMf(a){if(this.hfd){a=a.querySelectorAll("."+Ug.S1d);const c=a.length,f=Array(c);for(var b=0;b<c;++b)f[b]=this.X9k(a[b]);for(b=0;b<c;++b)wf.a.IPj(a[b],f[b].vpi,f[b].ypi,f[b].wpi,f[b].xpi)}}V9k(a){return new Nk("linear-gradient(to right, "+wf.a.$Mc+", "+wf.a.$Mc+")",wf.a.a4e,"0px "+a.style.verticalAlign,wf.a.hvd)}kSj(a){for(a=a.firstChild;a;){if(!Sys.UI.DomElement.containsCssClass(a,
xc.a.B8))return!1;a=a.nextSibling}return!0}W9k(a){let b=Number.MAX_VALUE,c=0,f=0;const l=a.querySelectorAll("span."+xc.a.B8);for(let y=0;y<l.length;y++){const H=l[y];f+=this.rgj(H);b=Math.min(b,H.offsetLeft);c=Math.max(c,H.offsetLeft+H.offsetWidth)}return new Nk("linear-gradient(to right, "+wf.a.$Mc+", "+wf.a.$Mc+")",0<c-a.offsetLeft?f+"px 100%":wf.a.a4e,b-a.offsetLeft+"px "+a.style.verticalAlign,wf.a.hvd)}X9k(a){return this.kSj(a)?this.V9k(a):this.W9k(a)}rgj(a){let b=0;if((a=a.getClientRects())&&
0<a.length)for(const c of a)b+=c.width;return b}X5f(a,b,c){return this.zA&&a&&b&&c&&(Object(Wa.a)(415,a)||Object(Wa.a)(415,this.wA.Rd)&&a.hm)?Gm.$Kc(b):null}uBh(){return!1}z7b(a){let b=a.sa(zb.a.latinFont,sd.Font.sT);b.startsWith("+")&&(b=a.sa(ab.a.font,sd.Font.sT));let c=new Na.a;c.add(b);var f=[zb.a.eastAsianFont,zb.a.complexScriptFont,zb.a.FPb];for(var l of f)a.Ua(l)&&(f=a.eb(l),!f||f.startsWith("+")||c.contains(f)||c.add(f));if(a=this.lrj(b))l=new Na.a,l.add(b),eb.a("UseServerFallbackFontFirst")?
l.insert(0,a):l.add(a),this.Rck(a,c),c=l;return c.toArray().join(",")}Rck(a,b){this.kFg||aa.FontUtils.isMissingFont(b.ga(0))?this.lFg||b.contains(a)||(xa.a.J(512496905,820,15,"Server fallback font mismatches browser fallback(s)."),this.lFg=!0):(xa.a.J(512496906,820,15,"Browser-used font available, but server-provided fallback mismatches."),this.kFg=!0)}sRe(a,b){if(a){var c=a.indexOf(",");0<c&&(a=a.substring(0,c))}c=!!this.yy&&this.yy.isEnabled;const f=!!this.wz&&this.wz.isEnabled;if(f||c||this.Tma)b=
aa.FontUtils.Ksb(b,a,c,this.Tma,f);f&&this.wz.createFontUrl(a);c&&(this.Kjf&&a?(c=Ug.o7f(a),this.yy.createFontUrl(a),c&&this.yy.createFontUrl(c)):this.yy.createFontUrl(a));this.Tma&&this.HX.createFontUrl(a);return b}Fih(a,b){return a?this.sRe(a.fontName,b):b}Y0c(){return this.Tma}static sVc(a){if(ma.a.Xa(a))return null;const b=a.indexOf(",");-1<b&&(a=a.substring(0,b).trim());return a}static o7f(a){if(ma.a.Xa(a))return null;a=Ug.sVc(a);let b=a.toLowerCase();for(;b;){let f=!1;b=b.trim();for(const l of Ug.t7i){var c=
l;b.endsWith("\u200b")&&(c+="\u200b");b.endsWith(c)&&(f=!0,c=b.lastIndexOf(c),b=b.substring(0,c+1))}if(!f)break}return a.substring(0,b.length)}static Cxd(a,b,c){return a&&b?(c=aa.FontUtils.Xbi(Ug.sVc(a),c),{returnValue:!0,E6b:c}):{returnValue:!1,E6b:c}}static Y3j(a){return a.sa(zb.a.fGa,!1)?!1:!0}}Ug.S1d="Selection";Ug.DQf="SelectionShadow";Ug.t7i=" bold; italic; demibold; extrablack; extrabold; extralight; heavy; light; medium; regular; semibold; thin".split(";");Ug.nFg=!1;Ug.mFg=!1;Object(m.a)(Ug,
"TextRenderingStrategy",null,[1381]);class ej{constructor(){this.Gzb=[]}yUe(a){a&&!Array.contains(this.Gzb,a)&&(a.N_=this,Array.add(this.Gzb,a))}Rmc(a,b){for(let c=0;c<this.Gzb.length;c++){const f=this.Gzb[c];f.Hzb&&f.Rmc(a,b)}}}Object(m.a)(ej,"AHighlightManager",null,[1378]);class Wn extends ej{constructor(){super();this.JLg=this.Sec=null}get Vja(){return this.Sec}get bdb(){return this.JLg}esd(a){if(a&&((this.Sec=a)&&0===this.Sec.action&&(this.JLg=this.Sec),a.gea||a.mjb)){var b=[];for(let c=0;c<
this.Gzb.length;c++){const f=this.Gzb[c];f.Hzb&&Array.addRange(b,f.NJh(a.gea,a.mjb))}}}}Object(m.a)(Wn,"HighlightManager",ej,[]);class Pp{constructor(a,b){this.ywa=a;this.sfc=b;this.ywa.fk(Object(I.a)(this,this.$g,"onPropertyChanged"))}dispose(){this.ywa.Om(Object(I.a)(this,this.$g,"onPropertyChanged"))}$g(a,b){a=b.node;b.property.id===zb.a.UPb.id&&a.isConnected&&!this.sfc.isComposing&&a.anchor.Jr(208)}}Object(m.a)(Pp,"ParagraphNodeViewBehavior",null,[107]);class jn{constructor(a){this.sfc=a}mBh(a){if(a=
Object(qa.a)(5,a)){if(this.sfc.isComposing){if(!a.k3c)return xa.a.J(22586562,822,50,"Skip paragraph view validation because CEV is in IME composing"),!0;xa.a.J(22586564,822,50,"invalidate paragraph view element because text changed in new revision")}a.k3c=!1}return!1}}Object(m.a)(jn,"ParagraphViewElementCEVSetUpdateStrategy",null,[1404]);class nk{constructor(a){this.pbd=[zb.a.qX,zb.a.Jx,zb.a.Gea,zb.a.ama,zb.a.Fea,zb.a.$la,Ab.a.nm,Ab.a.CY,Ab.a.uo,Ab.a.xJb,Ab.a.listLevel,ab.a.Vl,ab.a.xJ];this.j4h=a.Poe;
this.B1c=a.B1c;this.i4h=a.pptCopyPasteMarginAndIndentationEnabled}get $kd(){return this.j4h}get KIi(){return!1}get Keh(){return this.i4h}get zLk(){return this.pbd}wtl(a){return!!a.tagName&&"p"===ma.a.rg(a.tagName)&&Sys.UI.DomElement.containsCssClass(a,xc.a.mga)}gua(a){const b={};for(const c of this.pbd)b[c.id.toString()]=a.Rh(c);return b}rpa(a,b){if(b){const c=Db.ParagraphReader.gX(a);this.hnl(a,b,this.pbd,this.vqg(a),c);a.setValue(ee.a.Fbc,!0)}}vqg(a){let b=!1;(a=ob.GraphIterator.pb(a).parentNode)&&
Wd.OutlineElementReader.I9(a)&&(b=Zb.ListReader.PVa(a));return b}Nvk(a,b,c,f){this.Keh||(f=!0);if(this.$kd){const l=a.sa(ee.a.Fbc,!1),y=b.sa(ee.a.Fbc,!1),H=l||!f&&!y&&!l?b:a;this.OIi(H,l||!f&&!y&&!l?a:b,this.pbd,this.vqg(H),c)}}Suj(a){return this.Keh&&a?Db.ParagraphReader.gX(a)&&a.Ua(zb.a.$me)&&!a.eb(zb.a.$me)&&a.Ua(Ab.a.uo)?a.eb(Ab.a.uo).toString():"":""}hnl(a,b,c,f,l){for(const y of c)this.kBh(y,f,l)||(c=b[y.id.toString()],void 0!==c?a.setValue(y,c):a.removeProperty(y))}OIi(a,b,c,f,l){for(const y of c)this.kBh(y,
f,l)||(c=b.Rh(y),void 0!==c?a.ye(y,c):a.removeProperty(y))}kBh(a,b,c){return this.B1c&&!b&&c&&(a===Ab.a.nm||a===Ab.a.uo)}}Object(m.a)(nk,"PptFormattingPropertyTransitStrategy",null,[1402]);class ql{}ql.$Lh="UnderlineColor";ql.Mxd="UnderlinePositionInEm";ql.Nxd="UnderlineThicknessInEm";ql.mTc="FontSizePx";Object(m.a)(ql,"ParagraphViewElementProperties",null,[]);class Mh extends lb{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye,Xd){super(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc);
this.Fdc=yc;this.HKg=tc;this.eIg=xd&&!Ld;this.hfd=Vd&&!Ld;this.IKg=ye;this.Idd=Xd}STd(a,b){this.Fdc?a.style&&!ma.a.Xa(a.style.verticalAlign)&&(ma.a.Xa(b.style.verticalAlign)?(b.style.verticalAlign=a.style.verticalAlign.startsWith("-")?a.style.verticalAlign.substring(1,a.style.verticalAlign.length):"-"+a.style.verticalAlign,this.wji(a)):a.style.verticalAlign="",b.style.lineHeight="0px"):super.STd(a,b)}wji(a){if(null!==a.style&&!ma.a.Xa(a.style.verticalAlign)){if(this.HKg&&this.WXj(a)){const b=a.style.backgroundColor;
a.style.backgroundColor=null;wf.a.sBf(a,String.format("linear-gradient(to right, {0}, {0})",b),wf.a.a4e,String.format("0px {0}",a.style.verticalAlign),wf.a.hvd)}if(this.hfd||this.HKg)a.style.verticalAlign.startsWith("-")?a.style.paddingTop=a.style.verticalAlign.substring(1,a.style.verticalAlign.length):a.style.paddingBottom=a.style.verticalAlign}}D$d(a){return this.Fdc?"0px":super.D$d(a)}uAf(a){a.style.position=wf.a.Ouc}WXj(a){return Sys.UI.DomElement.containsCssClass(a,"Highlight")&&null!==a.style&&
a.style.backgroundColor!==wf.a.$Ci}$Ve(a,b,c,f){if(this.eIg&&b.xt){if(b.bG||b.U_)a.style.textDecoration=wf.a.dCl,f[f.length]="Strikethrough";b.xE&&(f[f.length]="Underlined");let l,y;this.Idd&&({Mxd:l,Nxd:y}=this.Xvj(b.wL)).returnValue?(L.a.aw(a,ql.$Lh,this.Wvj(c,b)),L.a.aw(a,ql.Mxd,l),L.a.aw(a,ql.Nxd,y)):ma.a.Xa(a.style.textDecoration)?a.style.textDecoration=wf.a.TFh:a.style.textDecoration+=" "+wf.a.TFh}else super.$Ve(a,b,c,f)}Wvj(a,b){a=this.mw.bae(a,b,!1,!0);return String.format("linear-gradient(to right, {0}, {0})",
a)}Xvj(a){return{returnValue:"Calibri"===a,Mxd:1.1133,Nxd:.0654}}YTj(a,b){if(!a||!b)return!1;for(a=a.firstChild;a;){if(Sys.UI.DomElement.containsCssClass(a,xc.a.B8))return!0;a=a.nextSibling}return!1}tAf(a,b){this.hfd&&(Sys.UI.DomElement.containsCssClass(b,xc.a.B8)||this.YTj(a,xc.a.B8)?(Sys.UI.DomElement.addCssClass(a,Ug.S1d),this.IKg&&z.a.ik&&Sys.UI.DomElement.addCssClass(a,Ug.DQf)):(Sys.UI.DomElement.removeCssClass(a,Ug.S1d),this.IKg&&z.a.ik&&Sys.UI.DomElement.removeCssClass(a,Ug.DQf)));if(this.eIg&&
Sys.UI.DomElement.containsCssClass(a.parentNode,xc.a.mig)){const c=L.a.ze(a,ql.$Lh),f=L.a.ze(a,ql.Nxd);let l=L.a.ze(a,ql.Mxd);if(c&&f&&l){if(!ma.a.Xa(a.style.fontSize)&&a.style.fontSize.endsWith("px")&&!ma.a.Xa(b.style.verticalAlign)&&b.style.verticalAlign.endsWith("px")){a=parseFloat(a.style.fontSize);const y=parseFloat(b.style.verticalAlign);isNaN(a)||!a||isNaN(y)||(l-=y/a)}wf.a.sBf(b,c,String.format("100% {0}em",f),String.format("0% {0}em",l),wf.a.hvd);b.style.textDecoration=wf.a.eCl}}}}Object(m.a)(Mh,
"PptParagraphContentRenderer",lb,[]);class Gl{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Paragraph"}Yb(a){this.K=a;this.AUe();this.IUe();this.c4k();this.EUe();this.j4k();this.k4k();this.b4k()}init(){this.K.register(1378,"Box4.Highlight.IHighlightManager").ma().oa(()=>new Wn);this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393230,new bm.a((a,b)=>new If(a,b,this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("PowerPointWebEditor.PptParagraphContentRenderer"),
new Xb.a(a,b),this.K.resolve("Box4.IParagraphViewIndentationStrategy"),()=>null,()=>null,a.hm&&w.AFrameworkApplication.fa.ka("SkipUpdateContentEditableViewWhenComposing")?this.K.resolve("PowerPointWebEditor.Paragraph.ParagraphViewElementCEVSetUpdateStrategy"):this.K.resolve("Box4.DefaultParagraphViewElementSetUpdateStrategy"),this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.K.resolve("Box4.Highlight.IHighlightManagerFactory").instance,this.K.resolve("Box4.ITextRenderingStrategy"),
this.K.resolve("Box4.IParagraphOverlayControlRenderer"))));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393234,new bm.a((a,b)=>new Je(a,b,this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("Box4.List.IListReader"),this.K.resolve("Box4.IParagraphViewIndentationStrategy"),this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)));this.K.resolve("PowerPointWebEditor.ParagraphNodeViewBehavior")}dispose(){this.K.resolve("PowerPointWebEditor.ParagraphNodeViewBehavior").dispose()}AUe(){this.K.register(1379,
"PowerPointWebEditor.IListMarkerOffsetCache").ma().oa(()=>new gb);this.K.register(1380,"Box4.IListMarkerUtility").ma().oa(()=>new Ci(this.K.resolve("Box4.List.IListReader"),this.K.resolve("Box4.IParagraphIndentationReader"),mc.a.instance,this.K.resolve("PowerPointWebEditor.IListMarkerOffsetCache"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.Graph.ISmartArtReader"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),
this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),this.K.resolve("PowerPointWebEditor.IPptListEditor"),this.K.resolve("PowerPointWebEditor.IPptListCore"),this.K.resolve("Box4.IInteractiveViewManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptRenderListBulletStyleInBox4Enabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").zcb,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteListMarkerEnabled,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteMarginAndIndentationEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled))}IUe(){this.K.register(1381,"Box4.ITextRenderingStrategy").ma().oa(()=>new Ug(this.K.resolve("Box4.IInteractiveViewManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IBox4ColorHelper"),this.K.resolve("Common.IBrowserUtils"),
this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),this.K.qb("Box4.CloudFontService"),this.K.qb("Box4.CustomFontService"),this.K.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").qmg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Oqg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Lqg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").zcb,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").VPb,this.K.resolve("PowerPointWebEditor.IApplicationSettings").jIh,this.K.resolve("PowerPointWebEditor.IApplicationSettings").v2c,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Nqg,this.K.resolve("Common.Utils.IHighContrastDetector").isInHighContrastMode,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").podsHtmlTextForEmbeddedFontsIsEnabled,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteFontFamilyEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").eXj,this.K.resolve("PowerPointWebEditor.IApplicationSettings").vFl,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").qil))}c4k(){this.K.register(Vn,"Box4.DefaultParagraphViewElementSetUpdateStrategy").ma();this.K.register(jn,"PowerPointWebEditor.Paragraph.ParagraphViewElementCEVSetUpdateStrategy").ma().oa(()=>
new jn(this.K.resolve("Box4.IEditingView")))}EUe(){this.K.register(Pl,"PowerPointWebEditor.ParagraphViewIndentationStrategy").as("Box4.IParagraphViewIndentationStrategy").ma().oa(()=>new Pl(this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("Box4.IParagraphIndentationReader"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPptListEditor"),new F.a))}j4k(){this.K.register(nk,"PowerPointWebEditor.Paragraph.PptFormattingPropertyTransitStrategy").as("Box4.IFormattingPropertyTransitStrategy").ma().oa(()=>
new nk(this.K.resolve("PowerPointWebEditor.IApplicationSettings")))}k4k(){this.K.register(Mh,"PowerPointWebEditor.PptParagraphContentRenderer").as("Box4.IParagraphContentRenderer").ma().oa(()=>new Mh(sa.InteractiveViewManager.instance,ja.a.instance,this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.K.resolve("Box4.IFormattingPropertyTransitStrategy"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.qb("Box4.Proofing.IIgnoreAllKeywords"),this.K.resolve("Box4.ITextRenderingStrategy"),
this.K.resolve("Box4.ParagraphContentRendererSettings"),this.K.resolve("Box4.ILineSpacingHelper"),this.K.qb("Box4.IFeatureHelper"),aa.FontUtils.WHi,this.K.qb("Box4.IFontSlotProvider"),Object(I.a)(this.K.resolve("Box4.IEditStateEventManager"),this.K.resolve("Box4.IEditStateEventManager").nkh,"raiseParagraphContentUpdatedEvent"),tb.a.language,this.K.qb("Box4.ITableOfContentRenderHelper"),Oc.a.rFf,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorDifferentLineHeightEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Oqg,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").Lqg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Nqg,this.K.resolve("Common.Utils.IHighContrastDetector").isInHighContrastMode,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextSelectionShadowFixIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").gsl))}b4k(){this.K.register(Pp,"PowerPointWebEditor.ParagraphNodeViewBehavior").ma().oa(()=>new Pp(this.K.resolve("Box4.Graph.IGraphInstance").yd(12),
this.K.resolve("Box4.IEditingView")))}static main(){n.a.instance.Ac(new Gl)}}Object(m.a)(Gl,"PPTWebEditorParagraphPackage",null,[2,3]);var mg=d(505),wm=d(631);class dk extends Sys.EventArgs{constructor(a){super();this.Uk=a}}Object(m.a)(dk,"PopSessionClosedEventArgs",Sys.EventArgs,[]);class Xn{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd){this.nDe=this.Ewa=null;this.Ie=a;this.Su=b;this.Ud=c;this.pc=f;this.la=l;this.Nkc=y;this.Jbd=H;this.vy=Q;this.Ig=ia;this.zfa=wa;this.pa=Ua;this.qf=
kb;this.ta=Gb;this.ia=ec;this.wb=dc;this.$ea=Fc;this.Xo=tc;this.mD=xd;H.rTd(Object(I.a)(this,this.cJb,"onPodSessionUnavailable"));H.Lsb(Object(I.a)(this,this.fga,"onPodSessionRefreshed"));yc.HC(Object(I.a)(this,this.Mo,"onSessionRehydrated"));this.eEe=new dd.a(4,2,2E3,Object(I.a)(this,this.detectFailoverTimeout,"detectFailoverTimeout"),90,"18")}get isEnabled(){return this.la.yg}get Mbc(){return!!this.Ewa}Wnj(a,b){const c=Nc.a.kk("GetPodSessionInfo");try{const f=this.Ie.podSessionId,l=Hg.a.create().toString(),
y=String.format("{0}PodHandler.ashx?action=GetPodSessionInfo",this.la.podsWebServiceBase),H={};H.PodSID=f;H["X-UserSessionId"]=this.Nkc();H["X-CorrelationID"]=l;c.Wa("PodSessionId",f);c.Wa("Cid",l);this.Su.iW(y,2,null,H,[Dh.a.i6],0,Q=>{try{if(f!==this.Ie.podSessionId)c.Wa("ExpectedPodSessionId",f),c.Wa("ActualPodSessionId",this.Ie.podSessionId),c.Wa("Result","PodSessionIdUnexpected"),c.finish(!0),a&&a();else{var ia=!0;if(Q.data){if(c.Wa("HttpStatus",Q.data.Ke.toString()),c.Wa("RequestStatus",mg.a[Q.data.status]),
Q.data.yj){const wa=Q.data.yj[Dh.a.i6];wa&&"errorCannotFindSession"===wa&&(c.Wa("ErrorCode",wa),ia=!1)}}else c.Wa("HttpStatus","UNKNOWN"),c.Wa("RequestStatus","UNKNOWN");ia?(c.Wa("Result","Succeeded"),c.finish(),a&&a()):(c.Wa("Result","Failed"),c.finish(!0),b&&b())}}catch(wa){xa.a.J(512496143,801,10,"PodSessionManager::GetPodSessionInfo - Exception: {0}",wa),b&&b()}},Q=>{try{if(f!==this.Ie.podSessionId)c.Wa("ExpectedPodSessionId",f),c.Wa("ActualPodSessionId",this.Ie.podSessionId),c.Wa("Result","PodSessionIdUnexpected"),
c.finish(!0),a&&a();else{if(Q.data){if(c.Wa("HttpStatus",Q.data.Ke.toString()),c.Wa("RequestStatus",mg.a[Q.data.status]),Q.data.yj){const ia=Q.data.yj[Dh.a.i6];ia&&c.Wa("ErrorCode",ia)}}else c.Wa("HttpStatus","UNKNOWN"),c.Wa("RequestStatus","UNKNOWN");c.Wa("Result","Failed");c.finish(!0);b&&b()}}catch(ia){xa.a.J(512496142,801,10,"PodSessionManager::GetPodSessionInfo - Exception: {0}",ia),b&&b()}},null,void 0,void 0,this.la.Ynj,this.la.Znj,"GetPodSessionInfo",void 0,!0)}catch(f){xa.a.J(512496141,801,
10,"PodSessionManager::GetPodSessionInfo - Exception: {0}",f),c.Wa("Result","Failed"),c.finish(!0),b&&b()}}cJb(a,b){a=!1;this.Ewa?xa.a.J(512496140,801,15,"PodSessionManager::OnPodSessionUnavailable - Already unavailable. PresentationId:{0}; IsBootCompleted:{1}; PopSessionInitialized:{2}; PopSessionId:{3}; PodSessionId:{4}; ReadOnly mode:{5}; PodsUnavailableStartTime:{6}; PodSeamlessRehydrationManager:{7}; FPodsOrderlyShutdown:{8}",this.Ie.presentationId.string,this.vy.xla,this.Ig.rG,this.Ie.Uk,this.Ie.podSessionId,
!this.pc.Pn,Nc.a.uf(this.Ewa),!!this.Xo.instance,b.dSc):(this.Ewa=new Date,a=!0,xa.a.J(512496139,801,15,"PodSessionManager::OnPodSessionUnavailable - Unavailable is detected. PresentationId:{0}; IsBootCompleted:{1}; PopSessionInitialized:{2}; PopSessionId:{3}; PodSessionId:{4}; ReadOnly mode:{5}; PodsUnavailableStartTime:{6}; PodSeamlessRehydrationManager:{7}; FPodsOrderlyShutdown:{8}",this.Ie.presentationId.string,this.vy.xla,this.Ig.rG,this.Ie.Uk,this.Ie.podSessionId,!this.pc.Pn,Nc.a.uf(this.Ewa),
!!this.Xo.instance,b.dSc));this.$ea.instance&&this.$ea.instance.T1c?xa.a.J(512496138,801,15,"PodSessionManager::OnPodSessionUnavailable - IsNonDismissibleDialogShown is TRUE, ignore Pods unavailable signal. PopSessionId:{0}; PodSessionId:{1}",this.Ie.Uk,this.Ie.podSessionId):this.vy.xla&&this.la.podsSeamlessFailoverEnabled&&this.Xo.instance?this.Xo.instance.l7e(b.dSc,4,b.errorCode):(this.Ud.jla=!1,this.vy.xla?this.Ig.rG?(a&&this.wb.Hb(this.eEe),this.zfa.tWc(this.Ie.presentationId.string,this.Ie.Uk,
this.Ie.podSessionId,b.dSc,c=>{this.Ccl(c,this.Ie.Uk)},c=>{this.Bcl(c,this.Ie.Uk)}),this.pa.setSelection(null),this.qf.blockContent(this.ta.presentation,"OnPodSessionUnavailable",!0),xa.a.J(512496136,817,15,"PodSessionManager::OnPodSessionUnavailable, Block Presentation")):this.QCj():xa.a.J(512496137,801,15,"PodSessionManager::OnPodSessionUnavailable - Skip since session is not ready. PodSessionId:{0}",this.Ie.podSessionId))}QCj(){this.nDe||(this.nDe=new Date);const a=+new Date-+this.nDe;a>this.la.podsNullSrmWaitTimeInMs?
(xa.a.J(512496135,801,15,"PodSessionManager::OnPodSessionUnavailable - Already wait {0}ms, won't wait anymore. PodSessionId:{1}",a,this.Ie.podSessionId),w.AFrameworkApplication.Oo($e.a.Oh(305)),$d.Health.instance.recordQosError("ErrorCannotFailoverRehydration",["UnexpectedAppRefresh"],!1,!1,!0,!0,null),this.ia.Ka(ea.a.refresh,2,{refreshtrigger:"PodSessionManager::HandleNullPodFailoverManager"})):xa.a.J(512496134,801,15,"PodSessionManager::OnPodSessionUnavailable - Skip since PodFailoverManager is not ready. MaxWaitTime:{0}ms; ElapsedTime:{1}ms. PodSessionId:{2}",
this.la.podsNullSrmWaitTimeInMs,a,this.Ie.podSessionId)}detectFailoverTimeout(){if(this.Ewa){var a=+new Date-+this.Ewa;a>this.la.podsFailoverBrowserWaitTimeoutInMs&&(this.wb.Lg(this.eEe),xa.a.J(512496133,801,15,"PodSessionManager::DetectFailoverTimeout - Won't wait for failover any longer. ElapsedTimeInMs:{0}, PodSessionId:{1}, PopSessionId:{2}",a,this.Ie.podSessionId,this.Ie.Uk),a=Object.assign(new Hj.a,{Code:293,Source:6}),this.Ud.Ds(a,this.Ie.podSessionId,b=>{b.KC=1;b.bDa=8;return!1}))}}Ccl(a,
b){a&&(this.Ie.Uk!==b?xa.a.J(512496132,801,15,"PodSessionManager::RetrievePODSInfoSucceeded - Ignore failure since PopSessionId is changed. CurrentPopSession:{0}; RequestPopSession:{1}; PodSessionId:{2}",this.Ie.Uk,b,this.Ie.podSessionId):(b=a.result)?(xa.a.J(512496131,817,50,"PodSessionManager::RetrievePODSInfoSucceeded - OldPodSessionId:{0}; NewPodSessionId:{1};",this.Ie.podSessionId,b.DocumentSessionID),this.Ie.podSessionId!==b.DocumentSessionID&&(a=this.Ie.podSessionId,this.Ie.podSessionId=b.DocumentSessionID,
this.Jbd.pkh(new wm.a(a,b.DocumentSessionID)))):xa.a.J(512496130,801,10,"Return type: {0}. PodSessionId:{1}, PopSessionId:{2}",a.result?Object.getType(a.result):null,this.Ie.podSessionId,this.Ie.Uk))}Bcl(a,b){if(this.Ie.Uk!==b)xa.a.J(512496129,801,15,"PodSessionManager::RetrievePODSInfoFailed - Ignore failure since PopSessionId is changed. CurrentPopSession:{0}; RequestPopSession:{1}; PodSessionId:{2}",this.Ie.Uk,b,this.Ie.podSessionId);else{b=316;var c=-1;a&&a.error&&(b=$e.a.nL(a.error.Vm),c=a.error.Vm);
xa.a.J(512496128,801,15,"PodSessionManager::RetrievePODSInfoFailed - PresentationId:{0}; PopSessionId:{1}; OldDocumentSessionID:{2}; NewDocumentSessionID:{3}; ResponseRecievedTime:{4}; BSQMErrorCode:{5}; ServerErrorCode:{6}",this.Ie.presentationId.string,this.Ie.Uk,this.Ie.podSessionId,"",Nc.a.uf(new Date),c,b);c===$e.a.Oh(241)&&(this.Ig.rG=!1,this.mD.sTe(new dk(this.Ig.Eea)))}}fga(a,b){Nc.a.pCb=new Date;Nc.a.twd=[];this.Ie.podSessionId!==b.qY?xa.a.J(512496099,801,15,"PodSessionManager::OnPodSessionRefreshed - PodSessionId should not change when we get the event! ExpectedPodSessionId:{0}; NewPodSessionId:{1}; PopSessionId:{2}",
this.Ie.podSessionId,b.qY,this.Ie.Uk):(this.wb.Lg(this.eEe),xa.a.J(512496098,801,15,"PodSessionManager::OnPodSessionRefreshed - PresentationId:{0}; PopSessionId:{1}; OldDocumentSessionID:{2}; NewDocumentSessionID:{3}; PodsUnavailableStartTime:{4}; PodsRefreshedTime:{5}",this.Ie.presentationId.string,this.Ie.Uk,b.KIb,b.qY,Nc.a.uf(this.Ewa||new Date),Nc.a.uf(new Date)),this.Ud.jla=!1,this.la.podsSeamlessFailoverEnabled&&this.Xo.instance?xa.a.J(512496097,801,15,"PodSessionManager::OnPodSessionRefreshed - Skip refresh Doc since seamless failover is on."):
(a={failedMachineId:null,isPlanedShutdown:!1,isPodSessionRefreshed:!0},a.podSessionId=b.qY,this.ia.Ka(ea.a.LLb,2,a)),this.Ewa=null)}Mo(){this.Ewa=null}}Object(m.a)(Xn,"PodSessionManager",null,[1373]);var Gn;(function(a){a[a.active=0]="active";a[a.passive=1]="passive";a[a.hidden=2]="hidden";a[a.frozen=3]="frozen"})(Gn||(Gn={}));Object(m.b)("AppVisibilityState",Gn);class kn{constructor(){this.IsTabHidden=!1;this.PresentationID=this.PopSessionID=null}}Object(m.a)(kn,"GetHostSessionInfoParams",null,[]);
class Yn{constructor(a,b,c,f,l,y,H,Q,ia,wa){this.Pcd=0;this.cIa=this.Yma=this.YEe=null;this.pYg=0;this.FHe=!1;this.Ya=b;this.Pic=a;this.Ig=c;this.la=f;this.$ea=l;this.wR=y;this.kna=H;this.pc=Q;this.WX=ia;this.sJa=wa;this.qDb=0;this.YFb=this.la.getHostSessionInfoRequestTimeoutInMs;this.Gmk=this.la.getHostSessionInfoRequestMaxTimeoutInMs;this.Mmk=this.la.getHostSessionInfoPingIntervalForFailedResponseInMs;this.Dfk=f.maxPopsRehydrationCount;this.dGb=this.la.$fh;this.cGb=this.la.podsPopSessionDisconnectedTimeLimitInMS;
this.tma=!1;this.mFb=this.Ya.Uk;this.oLg="";this.Hpd();this.vLa(0,!0)}Hpd(){this.Pcd=0;this.cIa=new Date}swi(a){if(this.Ala&&!w.AFrameworkApplication.Yg&&this.pc.VL){var b=!1;this.sJa&&this.sJa.instance&&(b=2===this.sJa.instance.E7a,this.FHe||(this.FHe=!0,this.sJa.instance.lJc(Object(I.a)(this,this.qQh,"visiblityChanged"))));var c=Object.assign(new kn,{PopSessionID:this.Ya.Uk,PresentationID:this.Ya.presentationId.string,IsTabHidden:b});this.YEe=new Date;b=Math.min(this.YFb+2E3*this.Pcd,this.Gmk);
var f=ta.a.eI("RequestTimeout",b.toString());this.Pic.HVc(c,()=>{this.zDk(c.PopSessionID,a)},l=>{this.yDk(l,c.PopSessionID,a)},null,f,this.la.getHostSessionInfoRequestTimeoutInMs,b+2E3)}else this.pc.VL&&(xa.a.J(24655577,801,50,"HostSessionInfoCaller::CallGetHostSessionInfo - Skipped. IsClientActive:{0}; IsShuttingDown:{1}; IsNonDismissibleDialogShown:{2}; AppInReadMode:{3};",this.Ala,w.AFrameworkApplication.Yg,!!this.$ea.instance&&this.$ea.instance.T1c,!this.pc.Pn),this.close(this.Ala?this.pc.VL?
"AppShuttingDown":"TransitionedToReadingMode":"ClientDisabled"))}vLa(a,b){this.Yma=new Date;this.pYg=window.setTimeout(()=>{this.swi(b)},a)}JQl(a){xa.a.J(24655581,801,50,"HostSessionInfoCaller::OnGetHostSessionInfoSucceeded - popSessionId:{0}, TimeTakenInMs:{1}",a,+new Date-+this.YEe);this.Hpd();this.qDb=0;this.Ig.qre=this.cIa;this.Ig.pre=a}zDk(a,b){this.WX.prc();this.wR.RZf(a,"HostSessionInfoCaller::OnGetHostSessionInfoSucceeded")?this.vLa(0,b):(this.JQl(a),b&&this.vLa(this.la.getHostSessionInfoPingIntervalInMs,
!0))}qQh(a,b){xa.a.J(592852376,801,50,"HostSessionInfoCaller.VisiblityChanged - Old:{0},  New:{1} ",Gn[b.oldState],Gn[b.newState]);this.vLa(0,!1)}bxi(){return this.kna.Mbc||!this.Ala?(xa.a.J(36320459,801,15,"HostSessionInfoCaller.CanRehydrateHostSession - Skip POPS Rehydration. IsPodSessionUnavailable:{0}; IsClientActive:{1}; Now:{2}",this.kna.Mbc,this.Ala,Nc.a.uf(new Date)),!1):this.qDb>this.Dfk?(xa.a.J(36996355,801,10,"HostSessionInfoCaller::CanRehydrateHostSession: Skip POPS rehydration, abort the ping client and raise an ACE error because we exceeded max rehydration threshold. Total number of POPS created so far:{0}; Max Allowed:{1};",
this.qDb,this.la.maxPopsRehydrationCount),this.close("POPSRehydrationThresholdReached"),this.wR.hfe($e.a.Oh(328),"HostSessionInfoCaller::CanRehydrateHostSession"),!1):!0}xga(a){this.bxi()&&(++this.qDb,this.wR.xga(a),this.Hpd())}ftl(a){if($e.a.aU(a))switch($e.a.nL(a)){case 326:case 240:case 103:return!0;case 329:return this.la.X4k}return!1}Egj(a){if($e.a.aU(a))switch($e.a.nL(a)){case 326:return 10;case 240:return 1;case 103:return 12;case 329:return 13;default:return 14}else return 14}yDk(a,b,c){a.KY&&
200===a.KY.Ke&&this.WX.prc();if(this.wR.RZf(b,"HostSessionInfoCaller::OnGetHostSessionInfoFailed"))this.vLa(0,c);else{++this.Pcd;var f=+new Date-+this.cIa,l=44,y=-1;a&&a.error&&(l=$e.a.aU(a.error.Vm)?$e.a.nL(a.error.Vm):44,y=a.error.Vm);a=ta.a.eI("PopSessionId",b,"ServerErrorCode",l,"BSQMErrorCode",y,"TimeTakenInMs",+new Date-+this.YEe,"RetryCount",this.Pcd,"PopSessionDisconnectedTimeLimitInMS",this.cGb,"PopsIdleTimeLimitInMS",this.dGb,"Now",Nc.a.uf(new Date),"CurrentDisconnectedTimeInMs",f,"PopSessionCreatedCount",
this.qDb,"LastPingScheduledTime",Nc.a.uf(this.Yma),"LastSuccessfulEnsureHostSessionId",this.Ig.ore);b="";try{b=Sys.Serialization.JavaScriptSerializer.serialize(a)}catch(H){xa.a.J(36320455,801,15,"HostSessionInfoCaller::OnGetHostSessionInfoFailed - Exception thrown while serializing the log string:{0};",H)}xa.a.J(24655583,801,15,"HostSessionInfoCaller::OnGetHostSessionInfoFailed - Ping request failed: "+b);+new Date-+this.Yma>this.cGb?this.vLa(0,c):this.ftl(y)?this.xga(this.Egj(y),y):y===$e.a.Oh(370)?
f<this.dGb?this.vLa(this.la.getHostSessionInfoPingIntervalInMs,c):this.xga(11,y):f>=this.cGb?this.xga(3,y):this.vLa(this.Mmk,c)}}Ase(a){const b=ta.a.eI("LastUsedPopSessionId",this.mFb,"LastClientClosedReason",this.oLg,"IsClientActive",this.Ala,"AppInEditingMode",this.pc.Pn,"PopSessionDisconnectedTimeLimitInMS",this.cGb,"PopsIdleTimeLimitInMS",this.dGb,"Now",Nc.a.uf(new Date),"ConsecutivelyTriggeredPopsRehydrationCount",this.qDb,"LastPingScheduledTime",Nc.a.uf(this.Yma),"LastSuccessfulEnsureHostSessionId",
this.Ig.ore);let c;try{c=Sys.Serialization.JavaScriptSerializer.serialize(b)}catch(f){xa.a.J(51421313,801,15,"HostSessionInfoCaller::LogPopsState - Exception thrown while serializing the log string:{0};",f),c=""}xa.a.J(51421315,801,15,"HostSessionInfoCaller::LogPopsState:{0} - {1}",a,c)}Kjb(a){xa.a.J(36282957,801,15,"HostSessionInfoCaller.Reboot - Reason:{0}. Restarted on PopSession {1}. LastUsedPopSession:{2}; IsClientActive:{3};",a,this.Ya.Uk,this.mFb,this.Ala);this.Ala&&this.mFb===this.Ya.Uk||
(this.mFb=this.Ya.Uk,this.Hpd(),this.tma?(this.tma=!1,this.vLa(0,!0)):xa.a.J(51421318,801,15,"HostSessionInfoCaller.Reboot did not schedule a ping request as the client was not closed previously - Reason:{0}; PopSession:{1}; LastUsedPopSession:{2}; IsClientActive:{3};",a,this.Ya.Uk,this.mFb,this.Ala))}close(a){this.tma||(xa.a.J(36536660,801,15,"HostSessionInfoCaller.Close - PopSession:{0}; Now:{1}; Reason:{2};",this.Ya.Uk,Nc.a.uf(new Date),a),this.FHe&&this.sJa&&this.sJa.instance&&this.sJa.instance.B8k(Object(I.a)(this,
this.qQh,"visiblityChanged")),this.tma=!0,this.mFb="",this.oLg=a,window.clearTimeout(this.pYg))}get Ala(){return!this.tma}}Object(m.a)(Yn,"HostSessionInfoCaller",null,[]);class Hm{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb){this.Fwa=null;this.Pic=a;this.Ya=b;this.Mc=c;this.Ig=f;this.la=l;this.$ea=y;this.wR=H;this.kna=Q;this.pc=ia;this.WX=Ua;this.sJa=kb;this.Mc.sTd(Object(I.a)(this,this.oib,"onPopSessionClosed"));this.Mc.GC(Object(I.a)(this,this.Qxa,"onSessionEnded"));this.Mc.tTd(Object(I.a)(this,this.o_a,
"onPopSessionInitialized"))}bOj(){xa.a.J(509150673,801,50,"PopSessionInfoClient::InitializeGetHostSessionInfoClient");this.Ig.rG&&this.iah()}o_a(){this.iah()}iah(){!this.Fwa&&this.Ig.rG?this.Fwa=new Yn(this.Pic,this.Ya,this.Ig,this.la,this.$ea,this.wR,this.kna,this.pc,this.WX,this.sJa):this.Kjb("PopSessionInitialized")}oib(){this.close("PopSessionClosed")}Qxa(){this.Ase("SessionClosed")}Ase(a){this.Fwa&&this.Fwa.Ase(a)}Kjb(a){this.Fwa&&this.Fwa.Kjb(a)}close(a){this.Fwa&&this.Fwa.close(a)}get Ala(){return!!this.Fwa&&
this.Fwa.Ala}dispose(){this.Mc.Zoh(Object(I.a)(this,this.oib,"onPopSessionClosed"));this.Mc.FVe(Object(I.a)(this,this.o_a,"onPopSessionInitialized"))}}Object(m.a)(Hm,"PopSessionInfoClient",null,[1374,107]);var Cd=d(282),Jh=d(216),Me=d(115),ue=d(662),Sm=d(330),Hl=d(878),dh=d(864);const No=a=>{if($e.a.aU(a)){a=$e.a.nL(a);if(dh.a(a))return 1;switch(a){case 103:case 44:case 370:return 0;case 309:case 311:case 27:case 320:case 244:case 245:case 372:return 1;case 326:return 2;default:return 3}}else switch(a){case $e.a.pEa:case $e.a.J3c:return 0;
default:return 3}};class Zn{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb){this.Ya=a;this.Ig=b;this.Ud=c;this.la=f;this.Vv=l;this.mD=y;this.N$=H;this.zfa=Ua;this.pc=kb;this.kna=ia;this.ZMg=this.la.hermesNotRefreshErrorList;this.RCe=this.la.podsMaxRetryTimesForEnsureHostSession;this.vMg=this.la.podsMaxRetryDurationForEnsureHostSessionInMs;this.la.yg&&(Q.zii(Object(I.a)(this,this.qIk,"onSyncLoopStatusNotified")),wa.phi(Object(I.a)(this,this.oIk,"onSuccessfulOutbound")),wa.i8(Object(I.a)(this,this.Sw,"onUnifiedAppStateChanged")));
w.AFrameworkApplication.jA&&wa.sJc(Object(I.a)(this,this.kga,"onWopiTokenRefreshed"))}xga(a,b=null,c=null){var f=this.N$.A$a(this.Ya.presentationId.string);f=Object.assign(new ue.a,{ForceCreatePods:!1,DoRehydrate:!0,IsRetrySession:!1,PodSessionID:this.Ya.podSessionId,PresentationID:this.Ya.presentationId.string,PodEndpointUrl:this.la.podsWebServiceBase,PopSessionID:f,UrlOverrides:this.la.Caa,IsCoauthSession:w.AFrameworkApplication.Rg.IsCoauthSession,IsCreateNewSession:this.la.QL,UseSharedHostFile:this.la.pRb});
this.N$.HLc(f,b,c,a)}LLe(a,b){if(this.SZf(b,"PopSessionManager::OnEnsureHostSessionSucceeded"))this.anh();else{var c=new Date;this.Ya.Uk=b.bC.PopSessionID;this.Ig.rG=!0;this.Ig.toc=!0;this.Ig.ore=b.bC.PopSessionID;this.Ig.Ula=c;this.mD.OYk();xa.a.J(22934494,801,15,"PopSessionManager::OnEnsureHostSessionSucceeded - OldPopSessionID: {0}, ExpectedPopSessionId: {1}, ExpectedPodSessionId: {2}, CurrentPodSessionId:{3}, Trigger: {4}, Retries: {5}, StartTime: {6}, EndTime: {7}, Duration: {8}ms, ActionId: {9},",
b.f_a,b.bC.PopSessionID,b.bC.PodSessionID,this.Ya.podSessionId,Hl.a[b.trigger],b.retryCount,Nc.a.uf(b.startTime),Nc.a.uf(c),+c-+b.startTime,b.actionId);b.VH&&b.VH(a)}}SIb(a,b){let c=a.error.Vm;const f=new Date;if(this.SZf(b,"PopSessionManager::OnEnsureHostSessionFailed -"))this.anh();else{if(b.retryCount<this.RCe&&+f-+b.startTime<=this.vMg){if(0===No(c)||c===$e.a.Oh(252)){b.retryCount++;a=this.N$.A$a(this.Ya.presentationId.string);xa.a.J(23349401,801,50,"{0} OldPopSessionID: {1}, ExpectedPopSessionId: {2}, ExpectedPodSessionId: {3}, CurrentPodSessionId:{4}, Trigger: {5}, Retries: {6}, StartTime: {7}, Now: {8}, Duration: {9}ms, bSqmErrorCode: {10}, ActionId: {11},",
"PopSessionManager::OnEnsureHostSessionFailed -",b.f_a,b.bC.PopSessionID,b.bC.PodSessionID,this.Ya.podSessionId,Hl.a[b.trigger],b.retryCount,Nc.a.uf(b.startTime),Nc.a.uf(f),+f-+b.startTime,c,b.actionId);b.bC.PopSessionID=a;b.bC.IsRetrySession=!0;this.N$.FHf(b);return}this.Ig.Ula=f;var l="FatalError"}else this.Ig.Ula=f,l=b.retryCount>=this.RCe?String.format("Exceeded the limit of {0} times of retrying",this.RCe):String.format("EnsureHostSession duration exceeded the limit of {0}ms. ElapsedTime: {1}ms",
this.vMg,+f-+b.startTime);c===$e.a.pEa&&(c=0===b.trigger?$e.a.Oh(375):$e.a.Oh(309));xa.a.J(23667161,801,10,"{0} OldPopSessionID: {1}, ExpectedPopSessionId: {2}, ExpectedPodSessionId: {3}, CurrentPodSessionId:{4}, Trigger: {5}, Retries: {6}, StartTime: {7}, EndTime: {8}, Duration: {9}, bSqmErrorCode: {10}, AbortReason: {11}, ActionId:{12},","PopSessionManager::OnEnsureHostSessionFailed -",b.f_a,b.bC.PopSessionID,b.bC.PodSessionID,this.Ya.podSessionId,Hl.a[b.trigger],b.retryCount,Nc.a.uf(b.startTime),
Nc.a.uf(f),+f-+b.startTime,c,l,b.actionId);b.ot&&b.ot(a)||this.hfe(c,"PopSessionManager::OnEnsureHostSessionFailed -")}}SZf(a,b){return a.bC.PodSessionID!==this.Ya.podSessionId?(xa.a.J(512262810,801,15,"EnsureHostSession - Ignore response since PodSessionId is changed. CurrentPodsSession:{0}; RequestPodsSession:{1}; functionName:{2} Need to trigger another request immediately.",this.Ya.podSessionId,a.bC.PodSessionID,b),!0):!1}anh(){this.Ig.Ula=new Date;this.xga(8)}qIk(a,b){a=$e.a.Oh(b.EGh);xa.a.J(512262809,
801,10," {0} - ServerErrorCode:{1}, bSqmErrorCode:{2}, PopSessionId:{3}, PodSessionId:{4}","PopSessionManager::OnSyncLoopStatusNotified",b.EGh,a,this.Ya.Uk,this.Ya.podSessionId);this.Ig.rG=!1;this.mD.sTe(new dk(this.Ig.Eea));this.hfe(a,"PopSessionManager::OnSyncLoopStatusNotified",b.t1i)}kga(a,b){try{b.p3c?(xa.a.J(512262808,814,50,"PopSessionManager::OnWopiTokenRefreshed Token refresh succeeded."),b.J0j||(this.lub(()=>{},()=>{}),this.xga(9))):xa.a.J(512262807,814,15,"PopSessionManager::OnWopiTokenRefreshed Token refresh failed.")}catch(c){xa.a.J(512262806,
814,10,"PopSessionManager::OnWopiTokenRefreshed Exception: {0}",c)}}RZf(a,b){return a&&this.Ya.Uk&&this.Ya.Uk!==a?(xa.a.J(512262805,801,15,"PopSessionManager::FStaleResponse - RequestingFunctionName:{0} - Ignore response since PopSessionId is changed. CurrentPopSessionId:{1}; RequestPopSessionId:{2}; LastAttemptedEnsureHostSessionId:{3};",b,this.Ya.Uk,a,this.Ig.Eea),!0):!1}hfe(a,b,c=null){xa.a.J(512262804,801,10,"PopSessionManager::HandlePOPSErrors:{0}; SourceFunction:{1};",a,b);if(!this.eBj(a)){if(w.AFrameworkApplication.jA&&
a===$e.a.Oh(320)){const f=Cd.a.instance.s8a();if(f){xa.a.J(512262803,801,15,"PopSessionManager::HandlePOPSErrors:{0}; SessionExpired fTriggered:{1};",a,f);return}}this.Vv.pfe(a,b)||this.T3d(a,b,c)}}lub(a,b,c=!1){xa.a.J(512262802,801,15,"PopSessionManager::CallClosePopSession - PopSessionID: {0}, PodSessionId: {1}, PopSessionInitialized: {2}, LastAttemptedEnsureHostSessionId:{3}, PopSessionForceClosed:{4}",this.Ya.Uk,this.Ya.podSessionId,this.Ig.rG,this.Ig.Eea,this.Ig.Kld);if(this.Ig.rG||!this.Ig.Kld){if(this.d8e(c,
""))a(new Sm.a(null)),xa.a.J(512262801,801,50,"sendBeacon request sent Time:{0}",Date.now());else{const f={};f["X-UsePopsRole"]=w.AFrameworkApplication.fa.ka("UsePopsRole").toString();this.zfa.MMc(this.Ig.Eea,this.Ya.podSessionId,this.Ya.presentationId.string,w.AFrameworkApplication.fa.appSettings["361"],this.Ya.Baa,c,a,b,null,f)}this.Ig.rG=!1;this.Ig.Kld=!0;this.mD.sTe(new dk(this.Ig.Eea))}}d8e(a,b){if(!z.a.Stb())return!1;try{const c=this.Zaj(a,b),f=this.z9d();w.AFrameworkApplication.Me.Yya(f,c);
return!0}catch(c){return xa.a.J(512262800,801,10,"Failed to send beacon request for ClosePopWacSession"),!1}}Zaj(a,b){const c={};c.popSessionID=this.Ig.Eea;c.podSessionID=b.length?b:this.Ya.podSessionId;c.presentationID=this.Ya.presentationId.string;c.podUrl=w.AFrameworkApplication.fa.appSettings["361"];c.podInstance=this.Ya.Baa;c.fTimeoutOrUserClose=a;return Me.c(c)}z9d(){var a=w.AFrameworkApplication.fa.Ha("368")+w.AFrameworkApplication.fa.Ha("367")+"/ClosePopWacSession";a=new Jh.QueryStringBuilder(a);
a.hy(w.AFrameworkApplication.h3a,w.AFrameworkApplication.userSessionId);a.hy(w.AFrameworkApplication.BWd,w.AFrameworkApplication.buildVersion);a.hy("waccluster",this.Ya.Ek);a.hy("WacUserType",w.AFrameworkApplication.userType);a.hy(w.AFrameworkApplication.FCb,w.AFrameworkApplication.X4c);a.hy(w.AFrameworkApplication.gW,w.AFrameworkApplication.accessToken);a.hy(w.AFrameworkApplication.Ica,w.AFrameworkApplication.um.toString());a.hy("X-UsePopsRole",this.Ya.nAa.toString());a.hy("X-PopsAffinityRoutingEnabled",
this.Ya.lGa.toString());return a=a.toString()}eBj(a){if(a!==$e.a.Oh(245))return!1;if(this.Ig.jug>this.Ig.Ula&&this.Ig.rG)return xa.a.J(512262799,801,15,"PopSessionManager::HandleFailedToGetPodsLatestBase - Got FailedToGetPodsLatestBase again."),!1;this.Ig.jug=new Date;this.BJf(0);return!0}BJf(a){const b=this.Ya.podSessionId;this.kna.Wnj(()=>{if(b!==this.Ya.podSessionId)xa.a.J(512262798,801,15,"{0} - Skip. PodSession is changed. Requested:{1}, Current:{2}","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase",
b,this.Ya.podSessionId);else{var c=$e.a.Oh(245);this.Vv.pfe(c,"PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase")||this.T3d(c,"PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase")}},()=>{b!==this.Ya.podSessionId?xa.a.J(512262797,801,15,"{0} - Skip. PodSession is changed. Requested:{1}, Current:{2}","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase",b,this.Ya.podSessionId):this.kna.Mbc?xa.a.J(512262796,801,15,"{0} - Skip. PODS unhealthy already",
"PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase"):a<this.la.Xnj?(xa.a.J(512262795,801,15,"{0} - Retry getting PODS health state. CurrentRetryCount:{1}","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase",a),this.BJf(a+1)):(xa.a.J(512262794,801,10,"{0} - PODS is unhealthy. Trigger rehydration.","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase"),this.Ud.Ds(Object.assign(new Hj.a,{Code:223,Source:6}),b))})}T3d(a,b,c=null){xa.a.J(512262793,801,
10,"PopSessionManager::DisplayPOPSErrors:{0}; RequestingFunction:{1};",a,b);const f=$e.a.nL(a);$e.a.aU(a)?(a=Object.assign(new Hj.a,{Code:$e.a.nL(a),Source:5,ExtraErrorParam:c}),this.Ud.Ds(a,this.Ya.podSessionId,l=>{l.KC=1;Array.contains(this.ZMg,te.a[f].toUpperCase())||(l.bDa=8);399===f?(l.title=ResourceStrings.errorTitle_PowerpointEditingStandard,l.message=ResourceStrings.errorMessage_Unknown):384!==f&&(l.title=ResourceStrings.errorTitle_PowerpointEditingStandard,l.message=ResourceStrings.errorMessage_FailedToEnsurePopSession);
return!1})):(b=0,Array.contains(this.ZMg,te.a[f].toUpperCase())||(b=8),this.Ud.cta(a,b,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FailedToEnsurePopSession))}oIk(){this.Ig.rG||(xa.a.J(512262792,801,15,"PopSessionManager::OnSuccessfulOutbound - PopSession not initialized. OldPopSessionID:{0}, PresentationID Null?:{1}",this.Ya.Uk,!this.Ya.presentationId.string),this.xga(5))}Sw(a,b){eb.a("Pops.CloseSessionDueToReadonly")&&b.boe&&!this.pc.VL&&this.Ig.rG&&(xa.a.J(512262791,
801,50,"PopSessionManager::OnUnifiedAppStateChanged - Close Pop session due to readonly"),this.lub(()=>{},()=>{}))}}Object(m.a)(Zn,"PopSessionManager",null,[1372]);class vo{get name(){return"PowerPointWebEditor.PodsPops"}Yb(a){a.register(1372,"PowerPointWebEditor.PodsPopsCore.IPopSessionManager").ma().oa(()=>new Zn(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionCoreManager"),a.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState")));a.register(1373,"PowerPointWebEditor.PodsPopsCore.IPodSessionManager").ma().oa(()=>
new Xn(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),w.AFrameworkApplication.Me,a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.IApplicationSettings"),()=>w.AFrameworkApplication.userSessionId,a.resolve("PowerPointWebEditor.Core.IPodsPopsEventSource"),a.resolve("PowerPointWebEditor.IAppBootCompletedListener"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.ITaskManager"),a.Ia("PowerPointWebEditor.IErrorDialog"),a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),a.Ia("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier")));a.register(1374,"PowerPointWebEditor.PodsPops.IPopSessionInfoClient").ma().oa(()=>
new Hm(a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.Ia("PowerPointWebEditor.IErrorDialog"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionManager"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.NotificationManager"),
a.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),a.Ia("Common.App.VisibilityManagement.IVisibilityManager")))}init(){}dispose(){}static main(){n.a.instance.Ac(new vo)}}Object(m.a)(vo,"PPTWebEditorPodsPopsPackage",null,[2,3]);class np{constructor(a,b,c,f,l){this.D$=new Na.a;this.Gec=this.Hec=null;this.XBg=this.qfc=0;this.mAe=this.lAe=!1;this.gEb=Fb.a.Daa(2,0,!1);this.DZa=Fb.a.Daa(2,1,!1);this.aed=a;this.egc=c;this.xl=f;this.Uq=b;this.pMg=l}get Jc(){return this.egc.Jc}Tah(a,b,c,f){if(!b)return!1;
this.lAe||(this.qfc=Date.now(),this.lAe=!0);b=!1;try{if(this.xl.ZCf(c.shapeNode)){this.D$.clear();this.Xvi();const l=this.mdj(c);if(a){const H=this.xl.Psj(this.xl.YI(c,a),this.MTa(l),this.Jc,this.gEb,this.DZa);if(H.top||H.bottom||H.left||H.right)b=!0,this.xl.vuc(c,H);if(this.pMg){const Q=this.xl.Hgj(this.xl.YI(c,a),l,this.gEb,this.DZa,f);if(Q.top||Q.bottom||Q.left||Q.right)b=!0,this.xl.vuc(c,Q);const ia=this.xl.Igj(this.xl.YI(c,a),l,this.Jc,this.DZa,f,a);if(ia.top||ia.bottom||ia.left||ia.right)b=
!0,this.xl.vuc(c,ia);const wa=this.xl.Xkj(this.xl.YI(c,a),l,this.Jc,this.DZa,f,a);if(wa.top||wa.bottom||wa.left||wa.right)b=!0,this.xl.vuc(c,wa)}}else b=this.xl.mzl(c,this.xl.YI(c,a),this.MTa(l),this.Jc,this.gEb,this.DZa);this.D$.addRange(this.xl.Fvi(this.xl.YI(c,a),this.MTa(l),this.Jc));const y=this.xl.fub(this.xl.YI(c,a),this.MTa(l));if(y.count)this.D$.addRange(y);else if(!b){let H;H=a?this.xl.lzl(this.xl.YI(c,!0),this.MTa(l),c):this.xl.kzl(this.xl.YI(c,!1),this.MTa(l),c,this.DZa,this.gEb);this.D$.addRange(H);
b=!!H&&0<H.count}if(this.pMg)if(a)this.D$.addRange(this.xl.yXd(this.xl.YI(c,a),this.xl.HTa(l),this.Jc,f,a)),this.D$.addRange(this.xl.k8a(this.xl.YI(c,a),this.xl.HTa(l),this.Jc,f,a)),this.D$.addRange(this.xl.Ovi(this.xl.YI(c,a),this.xl.HTa(l),f));else{const H=this.xl.k8a(this.xl.YI(c,a),this.xl.HTa(l),this.Jc,f,a);if(H.count)this.D$.addRange(H);else if(!b){const ia=this.xl.$Dh(this.xl.YI(c,!1),this.MTa(l),c,this.Jc,this.DZa,this.gEb);this.D$.addRange(this.xl.k8a(this.xl.YI(c,a),this.xl.HTa(l),this.Jc,
f,a));b=ia}const Q=this.xl.yXd(this.xl.YI(c,a),this.xl.HTa(l),this.Jc,f,a);if(Q.count)this.D$.addRange(Q);else if(!b){const ia=this.xl.$Dh(this.xl.YI(c,!1),this.MTa(l),c,this.Jc,this.DZa,this.gEb);this.D$.addRange(this.xl.yXd(this.xl.YI(c,a),this.xl.HTa(l),this.Jc,f,a));b=ia}}this.aed.wVf(this.D$.toArray());this.aed.visible=!0}}catch(l){this.mAe||(xa.a.J(8959958,815,10,"SmartGuide - moving error {0}",l.toString()),this.mAe=!0)}return b}Xah(a){a&&(this.aed.visible=!1,this.Gec=this.Hec=null,this.D$.clear(),
this.aed.wVf([]),this.XBg=Date.now(),this.mAe=this.lAe=!1,xa.a.J(8959960,815,50,"SmartGuide - moving timespan {0}",(this.XBg-this.qfc).toString()))}Xvi(){this.xl.O6g=this.Uq.om(this.Jc.UU.offsetLeft-this.Jc.Qc.scrollLeft);this.xl.P6g=this.Uq.om(this.Jc.UU.offsetTop-this.Jc.Qc.scrollTop)}mdj(a){return this.Hec?this.Hec:this.Hec=this.xl.ldj(this.xl.Urj(this.Jc,this.Jc.Na),a)}MTa(a){return this.Gec?this.Gec:this.Gec=this.xl.HTa(a)}}Object(m.a)(np,"SmartGuideManager",null,[1354]);var fj=d(133),qe=d(165),
Xi=d(200),Zc=d(58),Kj=d(166);class gg{constructor(){this.Y6c=this.bHa=null;this.N8c=0;this.leb=this.Rgb=null;this.Mjf=!1}get color(){return this.bHa}set color(a){this.bHa=a}get dashStyle(){return this.Y6c}set dashStyle(a){this.Y6c=a}get m9b(){return this.N8c}set m9b(a){this.N8c=a}get Sf(){return this.Rgb}set Sf(a){this.Rgb=a}get Hg(){return this.leb}set Hg(a){this.leb=a}get sH(){return this.Mjf}set sH(a){this.Mjf=a}length(){let a=-1;this.Rgb&&this.leb&&(a=Math.sqrt(Math.pow(this.leb._x-this.Rgb._x,
2)+Math.pow(this.leb._y-this.Rgb._y,2)));return a}reset(){const a=new gg;this.bHa=a.bHa;this.Y6c=a.Y6c;this.N8c=a.N8c;this.Rgb=a.Rgb;this.leb=a.leb}}Object(m.a)(gg,"SmartGuideLine",null,[1497]);class Rq{constructor(a,b,c,f){this.distance=a;this.cWd=b;this.j5d=c;this.direction=f}}Object(m.a)(Rq,"DistancePair",null,[]);class ln{constructor(a,b){this.shape=a;this.Qk=b}}Object(m.a)(ln,"LightSet",null,[]);class rl{constructor(a,b,c,f){this.begin=a;this.end=b;this.shape=c;this.distance=f}}Object(m.a)(rl,
"LightSetItem",null,[]);class mn{constructor(){this.feb={};this.iLg=[]}ga(a){return this.feb[a]}$(a,b){a in this.feb||this.iLg.push(a);return this.feb[a]=b}get keys(){return this.iLg}}Object(m.a)(mn,"NumberDictionary",null,[]);class Di{constructor(a,b){this.first=a;this.second=b}}Object(m.a)(Di,"NumberPair",null,[]);var xk=d(670);class hi{constructor(a,b){this.zFe=[];this.zg=5;this.I4=this.Qw=2;this.NO=4;this.PB=3;this.cbd=this.bbd=0;this.Uq=a;this.bHb=b}Urj(a,b){a=ob.GraphIterator.pb(a.gb);const c=
[];for(var f=a.Cb(1);f;f=a.Gf(1))f=Kj.a(f,b),c.push(f);return c}YI(a,b){for(const c of this.zFe)if(c.wG(a))return c.YI(a,b);return null}addHandler(a){this.zFe.push(a)}kzl(a,b,c,f,l){f=this.Nud(f,hi.oLc);l=this.Nud(l,hi.oLc);for(var y of f){f=a.copy();f.move(0,0-y);f=this.fub(f,b);if(f.count)return this.kMa(c,0,-y),f;f=a.copy();f.move(0,y);f=this.fub(f,b);if(f.count)return this.kMa(c,0,y),f}for(let H of l){y=a.copy();y.move(0-H,0);y=this.fub(y,b);if(y.count)return this.kMa(c,-1*H,0),y;y=a.copy();y.move(H,
0);y=this.fub(y,b);if(y.count)return this.kMa(c,H,0),y}return new Na.a}Nud(a,b){const c=new Na.a;a/=b;let f=0;for(let l=0;l<b;++l)f+=a,c.add(f);return c}lzl(a,b,c){var f=[];for(const l of f)if(f=a.copy(),f.setOffsets(l),f=this.fub(f,b),f.count)return this.vuc(c,l),f;return new Na.a}HTa(a){const b=[];for(const c of a)b.push(new xk.a(c.ys()));return b}mzl(a,b,c,f,l,y){const H=new Zc.a(Number.MAX_VALUE,Number.MAX_VALUE);let Q=Number.MAX_VALUE;var ia=Number.MAX_VALUE;let wa=[];for(const Ua of c)wa.push(Ua);
this.bHb&&(wa=this.Qdi(wa,f));for(const Ua of wa)c=this.qlj(b,Ua,Q),Math.abs(H.y)>Math.abs(c)&&(H.y=c),Q=Math.abs(c),c=this.olj(b,Ua,ia),Math.abs(H.x)>Math.abs(c)&&(H.x=c),ia=Math.abs(c);ia=this.egj(b,Q,f);Math.abs(H.y)>Math.abs(ia)&&(H.y=ia);ia=this.dgj(b,Q,f);Math.abs(H.x)>Math.abs(ia)&&(H.x=ia);Math.abs(H.x)>l&&(H.x=0);Math.abs(H.y)>y&&(H.y=0);return H.x||H.y?(this.kMa(a,H.x,H.y),!0):!1}Qdi(a,b){var c=this.Uq.om(b.we.width);b=this.Uq.om(b.we.height);var f=new xk.a(new fj.a(new Zc.a(0,0),new Zc.a(c,
0),new Zc.a(c,b),new Zc.a(0,b)));a.push(f);f=new xk.a(new fj.a(new Zc.a(0,0),new Zc.a(c,0),new Zc.a(c,b/2),new Zc.a(0,b/2)));a.push(f);c=new xk.a(new fj.a(new Zc.a(0,0),new Zc.a(c/2,0),new Zc.a(c/2,b),new Zc.a(0,b)));a.push(c);return a}vuc(a,b){this.CYc(a,c=>{c.setOffsets(a,b)})}kMa(a,b,c){this.CYc(a,f=>{f.setPosition(a,b,c)})}CYc(a,b){for(const c of this.zFe)if(c.wG(a)){b(c);break}}Psj(a,b,c,f,l){let y=Number.MAX_VALUE,H=Number.MAX_VALUE,Q=Number.MAX_VALUE,ia=Number.MAX_VALUE;var wa=[];for(var Ua of b)wa.push(Ua.copy());
b=this.Uq.om(c.we.width);c=this.Uq.om(c.we.height);Ua=new xk.a(new fj.a(new Zc.a(0,0),new Zc.a(b,0),new Zc.a(b,c),new Zc.a(0,c)));wa.push(Ua);this.bHb&&(Ua=new xk.a(new fj.a(new Zc.a(0,0),new Zc.a(b,0),new Zc.a(b,c/2),new Zc.a(0,c/2))),wa.push(Ua),b=new xk.a(new fj.a(new Zc.a(0,0),new Zc.a(b/2,0),new Zc.a(b/2,c),new Zc.a(0,c))),wa.push(b));for(const kb of wa)wa=this.lrd([kb.Zb-a.kc,kb.kc-a.kc,kb.Zf().y-a.kc],l),this.fU(wa,l)&&Math.abs(wa)<Math.abs(y)&&(y=wa),wa=this.lrd([kb.Zb-a.Zb,kb.kc-a.Zb,kb.Zf().y-
a.Zb],l),this.fU(wa,l)&&Math.abs(wa)<Math.abs(H)&&(H=wa),wa=this.lrd([kb.ic-a.ic,kb.fc-a.ic,kb.Zf().x-a.ic],f),this.fU(wa,f)&&Math.abs(wa)<Math.abs(Q)&&(Q=wa),wa=this.lrd([kb.ic-a.fc,kb.fc-a.fc,kb.Zf().x-a.fc],f),this.fU(wa,f)&&Math.abs(wa)<Math.abs(ia)&&(ia=wa);a=new Xi.a;a.top=y===Number.MAX_VALUE?a.top:y;a.bottom=H===Number.MAX_VALUE?a.bottom:H;a.left=Q===Number.MAX_VALUE?a.left:Q;a.right=ia===Number.MAX_VALUE?a.right:ia;return a}ZCf(a){return a.Pla||a.qj||a.rl||a.nr||a.Wf}Nfj(a,b){return Math.abs(a-
b)}qlj(a,b,c){a=[new Di(a.kc,b.kc),new Di(a.kc,b.Zb),new Di(a.kc,b.Zf().y),new Di(a.Zb,b.kc),new Di(a.Zb,b.Zb),new Di(a.Zb,b.Zf().y),new Di(a.Zf().y,b.kc),new Di(a.Zf().y,b.Zb),new Di(a.Zf().y,b.Zf().y)];return this.gWc(a,c)}olj(a,b,c){a=[new Di(a.ic,b.ic),new Di(a.ic,b.fc),new Di(a.ic,b.Zf().x),new Di(a.fc,b.ic),new Di(a.fc,b.fc),new Di(a.fc,b.Zf().x),new Di(a.Zf().x,b.ic),new Di(a.Zf().x,b.fc),new Di(a.Zf().x,b.Zf().x)];return this.gWc(a,c)}egj(a,b,c){c=this.Uq.om(c.we.height);a=[new Di(a.kc,0),
new Di(a.kc,c),new Di(a.Zb,0),new Di(a.Zb,c),new Di(a.Zf().y,0),new Di(a.Zf().y,c)];return this.gWc(a,b)}dgj(a,b,c){c=this.Uq.om(c.we.width);a=[new Di(a.ic,0),new Di(a.ic,c),new Di(a.fc,0),new Di(a.fc,c),new Di(a.Zf().x,0),new Di(a.Zf().x,c)];return this.gWc(a,b)}gWc(a,b){let c=Number.MAX_VALUE;for(const f of a)a=this.Nfj(f.first,f.second),a<b&&(b=a,c=f.second-f.first);return c}fU(a,b){a=Math.abs(a);return.2<a&&a<b}lrd(a,b){let c=Number.MAX_VALUE;for(const f of a)this.fU(f,b)&&Math.abs(c)>Math.abs(f)&&
(c=f);return c}ldj(a,b){const c=new Na.a;for(const f of a)this.ZCf(f.shapeNode)&&f.gb!==b.gb&&c.add(f);return c.toArray()}fub(a,b){var c=new Na.a;c.add(a);var f=new Na.a;f.add(a);var l=new Na.a;l.add(a);var y=new Na.a;y.add(a);for(const H of b)H.Zb<a.kc||H.kc>a.Zb||(H.ic<a.ic&&this.uIc(c,H,2),H.fc>a.fc&&this.uIc(f,H,3)),H.fc<a.ic||H.ic>a.fc||(H.kc<a.kc&&this.uIc(l,H,0),H.Zb>a.Zb&&this.uIc(y,H,1));a=this.lWc(c,2);f=this.lWc(f,3);b=this.lWc(l,0);c=this.lWc(y,1);y=new mn;this.BOc(y,a[0]);this.BOc(y,
f[0]);l=new mn;this.BOc(l,b[0]);this.BOc(l,c[0]);this.ASc(y,a,2);this.ASc(y,f,3);this.ASc(l,b,0);this.ASc(l,c,1);a=new Na.a;f=new Na.a;this.oPf(y,a,f);this.oPf(l,a,f);this.g2a(a,1);this.g2a(f,2);a.addRange(f);for(let H of a)this.$v(H);return a}lWc(a,b){const c=new Na.a;for(let l=0;l<a.count;++l){var f=new rl(this.Uej(a,l,b),this.nfj(a,l,b),null,-1);f=new ln(a.ga(l),[f]);for(let y=l+1;y<a.count;++y){const H=f.Qk.length;let Q=H;for(let ia=0;ia<H;++ia)if(!f.Qk[ia].shape&&-1===f.Qk[ia].distance&&f.Qk[ia].end>
f.Qk[ia].begin){const wa=this.Ofj(a,l,y,b);Q+=this.dUk(a,y,ia,Q,l,wa,f,b);Q+=this.fUk(a,y,ia,Q,l,wa,f,b);Q+=this.UUk(a,y,ia,Q,l,wa,f,b);Q+=this.eUk(a,y,ia,l,wa,f,b)}}c.add(f)}return c.toArray()}oPf(a,b,c){for(const l of a.keys){var f=a.ga(l);if(1<f.count){const y=new Na.a;for(let H of f){f=!1;for(let Q of y)if(this.Vmi(H,Q)){f=!0;y.remove(Q);break}f||y.add(H)}for(let H of y)this.YLi(H,b,c)}}}Vmi(a,b){return this.TCf(a.cWd,b.cWd)&&this.TCf(a.j5d,b.j5d)}TCf(a,b){return a.ic===b.ic&&a.fc===b.fc&&a.kc===
b.kc&&a.Zb===b.Zb}uIc(a,b,c){const f=a.count;for(let l=0;l<f;l++){const y=a.ga(l);if(3===c&&(b.ic<a.ga(0).fc?b.fc:b.ic)<(y.ic<a.ga(0).fc?y.fc:y.ic)||2===c&&(b.fc>a.ga(0).ic?b.ic:b.fc)>(y.fc>a.ga(0).ic?y.ic:y.fc)||0===c&&(b.Zb>a.ga(0).kc?b.kc:b.Zb)>(y.Zb>a.ga(0).kc?y.kc:y.Zb)||1===c&&(b.kc<a.ga(0).Zb?b.Zb:b.kc)<(y.kc<a.ga(0).Zb?y.Zb:y.kc)){a.insert(l,b);return}}a.add(b)}BOc(a,b){for(const c of b.Qk)0<c.distance&&a.$(Math.round(100*c.distance)/100,new Na.a)}ASc(a,b,c){const f=new mn;for(const l of b){for(const y of a.keys)f.$(y,
0);for(const y of l.Qk)if(0<y.distance&&y.shape)for(const H of a.keys)if(b=H,this.Ru(y.distance,b)){const Q=f.ga(H);1>Q&&(a.ga(H).add(new Rq(b,l.shape,y.shape,c)),f.$(H,Q+1));break}}}Uej(a,b,c){b=a.ga(b);a=a.ga(0);switch(c){case 2:case 3:return Math.max(b.kc,a.kc);case 0:case 1:return Math.max(b.ic,a.ic);default:return-1}}nfj(a,b,c){b=a.ga(b);a=a.ga(0);switch(c){case 2:case 3:return Math.min(b.Zb,a.Zb);case 0:case 1:return Math.min(b.fc,a.fc);default:return-1}}dUk(a,b,c,f,l,y,H,Q){const ia=a.ga(b);
l=a.ga(l);switch(Q){case 3:case 2:if(ia.Zb>=H.Qk[c].begin&&ia.Zb<=H.Qk[c].end&&ia.kc<=H.Qk[c].begin)return a=new rl(H.Qk[c].begin,ia.Zb,a.ga(b),3===Q?y-l.fc:l.ic-y),H.Qk[f]=a,H.Qk[c].begin=ia.Zb,1;break;case 0:case 1:if(ia.fc>=H.Qk[c].begin&&ia.fc<=H.Qk[c].end&&ia.ic<=H.Qk[c].begin)return a=new rl(H.Qk[c].begin,ia.fc,a.ga(b),0===Q?l.kc-y:y-l.Zb),H.Qk[f]=a,H.Qk[c].begin=ia.fc,1}return 0}fUk(a,b,c,f,l,y,H,Q){const ia=a.ga(b);l=a.ga(l);switch(Q){case 3:case 2:if(ia.kc>=H.Qk[c].begin&&ia.kc<=H.Qk[c].end&&
ia.Zb>=H.Qk[c].end)return a=new rl(ia.kc,H.Qk[c].end,a.ga(b),3===Q?y-l.fc:l.ic-y),H.Qk[f]=a,H.Qk[c].end=ia.kc,1;break;case 0:case 1:if(ia.ic>=H.Qk[c].begin&&ia.ic<=H.Qk[c].end&&ia.fc>=H.Qk[c].end)return a=new rl(ia.ic,H.Qk[c].end,a.ga(b),0===Q?l.kc-y:y-l.Zb),H.Qk[f]=a,H.Qk[c].end=ia.ic,1}return 0}UUk(a,b,c,f,l,y,H,Q){const ia=a.ga(b);l=a.ga(l);switch(Q){case 3:case 2:if(ia.kc>H.Qk[c].begin&&ia.kc<H.Qk[c].end&&ia.Zb>H.Qk[c].begin&&ia.Zb<H.Qk[c].end)return a=new rl(ia.kc,ia.Zb,a.ga(b),3===Q?y-l.fc:
l.ic-y),H.Qk[f]=a,a=new rl(ia.Zb,H.Qk[c].end,null,-1),H.Qk[++f]=a,H.Qk[c].end=ia.kc,2;break;case 0:case 1:if(ia.ic>H.Qk[c].begin&&ia.ic<H.Qk[c].end&&ia.fc>H.Qk[c].begin&&ia.fc<H.Qk[c].end)return a=new rl(ia.ic,ia.fc,a.ga(b),0===Q?l.kc-y:y-l.Zb),H.Qk[f]=a,a=new rl(ia.fc,H.Qk[c].end,null,-1),H.Qk[++f]=a,H.Qk[c].end=ia.ic,2}return 0}eUk(a,b,c,f,l,y,H){const Q=a.ga(b);f=a.ga(f);switch(H){case 3:case 2:Q.kc<y.Qk[c].begin&&Q.Zb>y.Qk[c].end&&(y.Qk[c].shape=a.ga(b),y.Qk[c].distance=3===H?l-f.fc:f.ic-l);break;
case 0:case 1:Q.ic<y.Qk[c].begin&&Q.fc>y.Qk[c].end&&(y.Qk[c].shape=a.ga(b),y.Qk[c].distance=0===H?f.kc-l:l-f.Zb)}return 0}Ofj(a,b,c,f){let l=-1;c=a.ga(c);a=a.ga(b);switch(f){case 3:c.ic<a.fc&&c.fc>=a.fc&&(l=c.fc);c.ic>=a.fc&&(l=c.ic);break;case 2:c.fc>a.ic&&c.ic<=a.ic&&(l=c.ic);c.fc<=a.ic&&(l=c.fc);break;case 0:c.Zb>a.kc&&c.kc<=a.kc&&(l=c.kc);c.Zb<=a.kc&&(l=c.Zb);break;case 1:c.kc<a.Zb&&c.Zb>=a.Zb&&(l=c.Zb),c.kc>=a.Zb&&(l=c.kc)}return l}YLi(a,b,c){const f=a.cWd;var l=a.j5d;switch(a.direction){case 3:var y=
Math.max(f.Zb,l.Zb),H=new gg;H.Sf=new Zc.a(f.fc-this.PB,f.kc);H.Hg=new Zc.a(f.fc-this.PB,y+this.zg);b.add(H);H=new gg;H.Sf=new Zc.a(f.fc+a.distance-this.PB,l.kc);H.Hg=new Zc.a(f.fc+a.distance-this.PB,y+this.zg);b.add(H);b=new gg;b.Sf=new Zc.a(f.fc-this.PB,y+this.zg);b.Hg=new Zc.a(f.fc+a.distance-this.PB,y+this.zg);c.add(b);break;case 2:y=Math.max(f.Zb,l.Zb);H=new gg;H.Sf=new Zc.a(f.ic-a.distance-this.PB,l.kc);H.Hg=new Zc.a(f.ic-a.distance-this.PB,y+this.zg);b.add(H);l=new gg;l.Sf=new Zc.a(f.ic-this.PB,
f.kc);l.Hg=new Zc.a(f.ic-this.PB,y+this.zg);b.add(l);b=new gg;b.Sf=new Zc.a(f.ic-a.distance-this.PB,y+this.zg);b.Hg=new Zc.a(f.ic-this.PB,y+this.zg);c.add(b);break;case 0:y=Math.max(f.fc,l.fc);H=new gg;H.Sf=new Zc.a(f.ic,f.kc-this.Qw);H.Hg=new Zc.a(y+this.zg,f.kc-this.Qw);b.add(H);H=new gg;H.Sf=new Zc.a(l.ic,f.kc-a.distance-this.Qw);H.Hg=new Zc.a(y+this.zg,f.kc-a.distance-this.Qw);b.add(H);b=new gg;b.Sf=new Zc.a(y+this.zg,f.kc-this.Qw);b.Hg=new Zc.a(y+this.zg,f.kc-a.distance-this.Qw);c.add(b);break;
case 1:y=Math.max(f.fc,l.fc),H=new gg,H.Sf=new Zc.a(f.ic,f.Zb-this.Qw),H.Hg=new Zc.a(y+this.zg,f.Zb-this.Qw),b.add(H),H=new gg,H.Sf=new Zc.a(l.ic,f.Zb+a.distance-this.Qw),H.Hg=new Zc.a(y+this.zg,f.Zb+a.distance-this.Qw),b.add(H),b=new gg,b.Sf=new Zc.a(y+this.zg,f.Zb-this.Qw),b.Hg=new Zc.a(y+this.zg,f.Zb+a.distance-this.Qw),c.add(b)}}Ovi(a,b,c){const f=new Na.a;if(!c)return f;let l=!1;var y=!1;const H=c.equals(qe.a.west)||c.equals(qe.a.Wu)||c.equals(qe.a.dI),Q=c.equals(qe.a.east)||c.equals(qe.a.VE)||
c.equals(qe.a.jF),ia=c.equals(qe.a.north)||c.equals(qe.a.Wu)||c.equals(qe.a.VE);c=c.equals(qe.a.south)||c.equals(qe.a.dI)||c.equals(qe.a.jF);for(const Ua of b){if(this.Vrg(a,Ua,!0,b)&&(H||Q)){l=!0;var wa=new gg;wa.Sf=new Zc.a(Ua.ic,Ua.Zf()._y);wa.Hg=new Zc.a(Ua.fc-this.PB,Ua.Zf()._y);wa.sH=!0;f.add(this.$v(wa))}this.Vrg(a,Ua,!1,b)&&(ia||c)&&(y=!0,wa=new gg,wa.Sf=new Zc.a(Ua.Zf()._x,Ua.kc),wa.Hg=new Zc.a(Ua.Zf()._x,Ua.Zb-this.I4),wa.sH=!1,f.add(this.$v(wa)))}l&&(b=new gg,b.Sf=new Zc.a(a.ic,a.Zf()._y),
b.Hg=new Zc.a(a.fc-this.PB,a.Zf()._y),b.sH=!0,f.add(this.$v(b)));y&&(y=new gg,y.Sf=new Zc.a(a.Zf()._x,a.kc),y.Hg=new Zc.a(a.Zf()._x,a.Zb-this.I4),y.sH=!1,f.add(this.$v(y)));this.g2a(f,2);return f}V5(a,b,c){var f=this.kea(a,b,!1),l=this.kea(a,b,!0);if(!f&&!l)return!1;let y=[];if(f){if(a.fc<=b.ic||a.fc<=b.fc){var H;var Q=b.kc>a.kc?b.kc:a.kc;var ia=b.Zb<a.Zb?b.Zb:a.Zb;f=H=b.ic;a.fc>b.ic&&(f=H=b.fc);f=new xk.a(new fj.a(new Zc.a(f,Q),new Zc.a(H,Q),new Zc.a(H,ia),new Zc.a(f,ia)));Array.add(y,f)}if(a.ic>=
b.fc||a.ic>=b.ic)Q=b.kc>a.kc?b.kc:a.kc,ia=b.Zb<a.Zb?b.Zb:a.Zb,f=H=b.fc,a.ic<b.fc&&(f=H=b.ic),f=new xk.a(new fj.a(new Zc.a(f,Q),new Zc.a(H,Q),new Zc.a(H,ia),new Zc.a(f,ia))),Array.add(y,f)}if(l){if(a.Zb<=b.kc||a.Zb<=b.Zb)l=b.ic>a.ic?b.ic:a.ic,Q=b.fc<a.fc?b.fc:a.fc,f=H=b.kc,a.Zb>b.kc&&(f=H=b.Zb),l=new xk.a(new fj.a(new Zc.a(l,f),new Zc.a(Q,f),new Zc.a(Q,H),new Zc.a(l,H))),Array.add(y,l);if(a.kc>=b.Zb||a.kc>=b.kc)l=b.ic>a.ic?b.ic:a.ic,Q=b.fc<a.fc?b.fc:a.fc,f=H=b.Zb,a.kc<b.Zb&&(f=H=b.kc),l=new xk.a(new fj.a(new Zc.a(l,
f),new Zc.a(Q,f),new Zc.a(Q,H),new Zc.a(l,H))),Array.add(y,l)}for(const wa of c)this.Wgg(wa,a)||this.Wgg(wa,b)||(y=this.UOl(a,wa,y));return 0<y.length?!0:!1}UOl(a,b,c){let f=[];for(const l of c)c=!0,l.ic===l.fc?(this.kea(l,b,!1)||(c=!1),a.fc<=l.ic&&b.fc<=a.fc&&(c=!1),a.fc<=l.ic&&b.ic>=l.fc&&(c=!1),a.ic>=l.fc&&b.ic>=a.ic&&(c=!1),a.ic>=l.fc&&b.fc<=l.ic&&(c=!1),c?b.kc<=l.kc&&b.Zb<l.Zb?f=this.cRb(f,!0,!0,!1,l,b):b.Zb>=l.Zb&&b.kc>l.kc?f=this.cRb(f,!0,!1,!1,l,b):b.kc>l.kc&&b.Zb<l.Zb&&(f=this.cRb(f,!0,!1,
!0,l,b)):Array.add(f,l)):l.kc===l.Zb&&(this.kea(l,b,!0)||(c=!1),a.Zb<=l.kc&&b.Zb<=a.Zb&&(c=!1),a.Zb<=l.kc&&b.kc>=l.Zb&&(c=!1),a.kc>=l.Zb&&b.kc>=a.kc&&(c=!1),a.kc>=l.Zb&&b.Zb<=l.kc&&(c=!1),c?b.ic<=l.ic&&b.fc<l.fc?f=this.cRb(f,!1,!0,!1,l,b):b.fc>=l.fc&&b.ic>l.ic?f=this.cRb(f,!1,!1,!1,l,b):b.ic>l.ic&&b.fc<l.fc&&(f=this.cRb(f,!1,!1,!0,l,b)):Array.add(f,l));return f}cRb(a,b,c,f,l,y){let H,Q,ia,wa,Ua,kb,Gb;if(c)b?(c=Q=l.ic,H=y.Zb,ia=l.Zb):(H=ia=l.kc,c=y.fc,Q=l.fc);else if(c||f){if(b?(c=Q=wa=kb=l.ic,H=l.kc,
ia=y.kc,Ua=y.Zb,Gb=l.Zb):(H=ia=Ua=Gb=l.kc,c=l.ic,Q=y.ic,wa=y.fc,kb=l.fc),f&&b&&!this.Ru(Ua,Gb)||f&&!b&&!this.Ru(wa,kb))f=new xk.a(new fj.a(new Zc.a(wa,Ua),new Zc.a(kb,Ua),new Zc.a(kb,Gb),new Zc.a(wa,Gb))),Array.add(a,f)}else b?(c=Q=l.ic,H=l.kc,ia=y.kc):(H=ia=l.kc,c=l.ic,Q=y.ic);if(b&&!this.Ru(H,ia)||!b&&!this.Ru(c,Q))b=new xk.a(new fj.a(new Zc.a(c,H),new Zc.a(Q,H),new Zc.a(Q,ia),new Zc.a(c,ia))),Array.add(a,b);return a}Wgg(a,b){return a.fc!==b.fc||a.ic!==b.ic||a.kc!==b.kc||a.Zb!==b.Zb?!1:!0}Vrg(a,
b,c,f){if(c)return c=this.Ru(a.ic,b.ic)&&this.Ru(a.fc,b.fc),this.Ru(a.fc-a.ic,b.fc-b.ic)&&!c&&this.V5(a,b,f);c=this.Ru(a.kc,b.kc)&&this.Ru(a.Zb,b.Zb);return this.Ru(a.Zb-a.kc,b.Zb-b.kc)&&!c&&this.V5(a,b,f)}Hgj(a,b,c,f,l){const y=new Xi.a;if(!l)return y;let H=Number.MAX_VALUE,Q=Number.MAX_VALUE,ia=Number.MAX_VALUE,wa=Number.MAX_VALUE;const Ua=l.equals(qe.a.west)||l.equals(qe.a.Wu)||l.equals(qe.a.dI),kb=l.equals(qe.a.east)||l.equals(qe.a.VE)||l.equals(qe.a.jF),Gb=l.equals(qe.a.north)||l.equals(qe.a.Wu)||
l.equals(qe.a.VE);l=l.equals(qe.a.south)||l.equals(qe.a.dI)||l.equals(qe.a.jF);const ec=[];for(const dc of b)ec.push(new xk.a(dc.ys()));for(const dc of ec)b=dc.Zb-dc.kc-(a.Zb-a.kc),this.fU(b,f)&&Math.abs(b)<Math.abs(H)&&this.V5(a,dc,ec)&&Gb&&(H=-1*b),this.fU(b,f)&&Math.abs(b)<Math.abs(Q)&&this.V5(a,dc,ec)&&l&&(Q=b),b=dc.fc-dc.ic-(a.fc-a.ic),this.fU(b,c)&&Math.abs(b)<Math.abs(ia)&&this.V5(a,dc,ec)&&Ua&&(ia=-1*b),this.fU(b,c)&&Math.abs(b)<Math.abs(wa)&&this.V5(a,dc,ec)&&kb&&(wa=b);y.top=H===Number.MAX_VALUE?
y.top:H;y.bottom=Q===Number.MAX_VALUE?y.bottom:Q;y.left=ia===Number.MAX_VALUE?y.left:ia;y.right=wa===Number.MAX_VALUE?y.right:wa;return y}Igj(a,b,c,f,l,y){let H=Number.MAX_VALUE,Q=Number.MAX_VALUE,ia=Number.MAX_VALUE,wa=Number.MAX_VALUE,Ua=!0,kb=!0,Gb=!0,ec=!0;y&&l&&(Ua=l.equals(qe.a.west)||l.equals(qe.a.Wu)||l.equals(qe.a.dI),kb=l.equals(qe.a.east)||l.equals(qe.a.VE)||l.equals(qe.a.jF),Gb=l.equals(qe.a.north)||l.equals(qe.a.Wu)||l.equals(qe.a.VE),ec=l.equals(qe.a.south)||l.equals(qe.a.dI)||l.equals(qe.a.jF));
l=[];for(var dc of b)l.push(new xk.a(dc.ys()));b=this.Uq.om(c.we.width);c=this.Uq.om(c.we.height);for(const Fc of l)Fc.ic>b/2&&Fc.ic<3*b/4&&a.fc<b/2&&kb&&(dc=b/2-a.fc-(Fc.ic-b/2),this.fU(dc,f)&&Math.abs(dc)<Math.abs(wa)&&this.V5(a,Fc,l)&&(wa=dc)),Fc.fc<b/2&&Fc.fc>b/4&&a.ic>b/2&&Ua&&(dc=b/2-Fc.fc-(a.ic-b/2),this.fU(dc,f)&&Math.abs(dc)<Math.abs(ia)&&this.V5(a,Fc,l)&&(ia=dc)),Fc.kc>c/2&&Fc.kc<3*c/4&&a.Zb<c/2&&ec&&(dc=c/2-a.Zb-(Fc.kc-c/2),this.fU(dc,f)&&Math.abs(dc)<Math.abs(Q)&&this.V5(a,Fc,l)&&(Q=dc)),
Fc.Zb<c/2&&Fc.Zb>c/4&&a.kc>c/2&&Gb&&(dc=c/2-Fc.Zb-(a.kc-c/2),this.fU(dc,f)&&Math.abs(dc)<Math.abs(H)&&this.V5(a,Fc,l)&&(H=dc));a=new Xi.a;a.top=H===Number.MAX_VALUE?a.top:H;a.bottom=Q===Number.MAX_VALUE?a.bottom:Q;a.left=ia===Number.MAX_VALUE?a.left:ia;a.right=wa===Number.MAX_VALUE?a.right:wa;return a}$Dh(a,b,c,f,l,y){l=this.Nud(l,hi.oLc);y=this.Nud(y,hi.oLc);for(var H of l){l=a.copy();l.move(0,0-H);if(this.k8a(l,b,f,null,!1).count)return this.kMa(c,0,-H),!0;l=a.copy();l.move(0,H);if(this.k8a(l,b,
f,null,!1).count)return this.kMa(c,0,H),!0}for(let Q of y){H=a.copy();H.move(0-Q,0);if(this.k8a(H,b,f,null,!1).count)return this.kMa(c,-1*Q,0),!0;H=a.copy();H.move(Q,0);if(this.k8a(H,b,f,null,!1).count)return this.kMa(c,Q,0),!0}return!1}kea(a,b,c){return c?a.ic>=b.ic&&a.ic<=b.fc||a.fc>=b.ic&&a.fc<=b.fc||b.ic>=a.ic&&b.ic<=a.fc||b.fc>=a.ic&&b.fc<=a.fc:a.kc>=b.kc&&a.kc<=b.Zb||a.Zb>=b.kc&&a.Zb<=b.Zb||b.kc>=a.kc&&b.kc<=a.Zb||b.Zb>=a.kc&&b.Zb<=a.Zb}yXd(a,b,c,f,l){const y=new Na.a,H=new Na.a,Q=new Na.a;
let ia=!1,wa=!1,Ua=!1,kb=!1,Gb=!0,ec=!0,dc=!0,Fc=!0;l&&f&&(Gb=f.equals(qe.a.west)||f.equals(qe.a.Wu)||f.equals(qe.a.dI),ec=f.equals(qe.a.east)||f.equals(qe.a.VE)||f.equals(qe.a.jF),dc=f.equals(qe.a.north)||f.equals(qe.a.Wu)||f.equals(qe.a.VE),Fc=f.equals(qe.a.south)||f.equals(qe.a.dI)||f.equals(qe.a.jF));f=this.Uq.om(c.we.width);c=this.Uq.om(c.we.height);l=new gg;l.Sf=new Zc.a(f/2-this.NO,0-this.Qw);l.Hg=new Zc.a(f/2-this.NO,c-this.Qw);const yc=new gg;yc.Sf=new Zc.a(0-this.NO,c/2-this.Qw);yc.Hg=new Zc.a(f-
this.NO,c/2-this.Qw);yc.sH=!0;for(const tc of b)tc.ic>f/2&&tc.ic<3*f/4&&a.fc<f/2&&this.V5(a,tc,b)&&ec&&this.Ru(f/2-a.fc,tc.ic-f/2)&&(ia=!0,0>tc.kc&&(l.Sf=new Zc.a(f/2,tc.kc)),tc.Zb>c&&(l.Hg=new Zc.a(f/2,tc.Zb+this.zg)),y.add(this.BQa(tc,!1,!1)),H.add(this.xQa(tc,!1,!1,f,c))),tc.fc<f/2&&tc.fc>f/4&&a.ic>f/2&&this.V5(a,tc,b)&&Gb&&this.Ru(a.ic-f/2,f/2-tc.fc)&&(wa=!0,0>tc.kc&&(l.Sf=new Zc.a(f/2,tc.kc)),tc.Zb>c&&(l.Hg=new Zc.a(f/2,tc.Zb+this.zg)),y.add(this.BQa(tc,!1,!0)),H.add(this.xQa(tc,!1,!0,f,c))),
tc.kc>c/2&&tc.kc<3*c/4&&a.Zb<c/2&&this.V5(a,tc,b)&&Fc&&this.Ru(c/2-a.Zb,tc.kc-c/2)&&(Ua=!0,0>tc.ic&&(yc.Sf=new Zc.a(tc.ic,c/2)),tc.fc>f&&(yc.Hg=new Zc.a(tc.fc+this.zg,c/2)),y.add(this.BQa(tc,!0,!1)),H.add(this.xQa(tc,!0,!1,f,c))),tc.Zb<c/2&&tc.Zb>c/4&&a.kc>c/2&&this.V5(a,tc,b)&&dc&&this.Ru(a.kc-c/2,c/2-tc.Zb)&&(kb=!0,0>tc.ic&&(yc.Sf=new Zc.a(tc.ic,c/2)),tc.fc>f&&(yc.Hg=new Zc.a(tc.fc+this.zg,c/2)),y.add(this.BQa(tc,!0,!0)),H.add(this.xQa(tc,!0,!0,f,c)));(ia||wa)&&y.add(this.$v(l));(Ua||kb)&&y.add(this.$v(yc));
Ua&&(a.ic<yc.Sf._x&&(yc.Sf=new Zc.a(a.ic,c/2)),a.fc>yc.Hg._x&&(yc.Hg=new Zc.a(a.fc,c/2+this.zg)),y.add(this.BQa(a,!0,!0)),H.add(this.xQa(a,!0,!0,f,c)));kb&&(a.ic<yc.Sf._x&&(yc.Sf=new Zc.a(a.ic,c/2)),a.fc>yc.Hg._x&&(yc.Hg=new Zc.a(a.fc,c/2+this.zg)),y.add(this.BQa(a,!0,!1)),H.add(this.xQa(a,!0,!1,f,c)));ia&&(a.kc<l.Sf._y&&(l.Sf=new Zc.a(f/2,a.kc)),a.Zb>l.Hg._y&&(l.Hg=new Zc.a(f/2,a.Zb+this.zg)),y.add(this.BQa(a,!1,!0)),H.add(this.xQa(a,!1,!0,f,c)));wa&&(a.kc<l.Sf._y&&(l.Sf=new Zc.a(f/2,a.kc)),a.Zb>
l.Hg._y&&(l.Hg=new Zc.a(f/2,a.Zb+this.zg)),y.add(this.BQa(a,!1,!1)),H.add(this.xQa(a,!1,!1,f,c)));this.g2a(y,1);this.g2a(H,2);for(let tc of y)Q.add(tc);for(let tc of H)Q.add(tc);return Q}BQa(a,b,c){const f=b&&c,l=b&&!c,y=!b&&!c;return!b&&c?(b=new gg,b.Sf=new Zc.a(a.fc-this.PB,a.Zb),b.Hg=new Zc.a(a.fc-this.PB,a.Zb+this.zg),this.$v(b)):y?(b=new gg,b.Sf=new Zc.a(a.ic-this.NO,a.Zb),b.Hg=new Zc.a(a.ic-this.NO,a.Zb+this.zg),this.$v(b)):f?(b=new gg,b.Sf=new Zc.a(a.fc,a.Zb-this.I4),b.Hg=new Zc.a(a.fc+this.zg,
a.Zb-this.I4),this.$v(b)):l?(b=new gg,b.Sf=new Zc.a(a.fc,a.kc-this.Qw),b.Hg=new Zc.a(a.fc+this.zg,a.kc-this.Qw),this.$v(b)):null}xQa(a,b,c,f,l){const y=b&&c,H=b&&!c,Q=!b&&!c;return!b&&c?(l=new gg,l.sH=!0,l.Sf=new Zc.a(f/2-this.NO,a.Zb+this.zg),l.Hg=new Zc.a(a.fc-this.PB,a.Zb+this.zg),this.$v(l)):Q?(l=new gg,l.sH=!0,l.Sf=new Zc.a(f/2-this.NO,a.Zb+this.zg),l.Hg=new Zc.a(a.ic-this.NO,a.Zb+this.zg),this.$v(l)):y?(f=new gg,f.sH=!0,f.Sf=new Zc.a(a.fc+this.zg,l/2-this.Qw),f.Hg=new Zc.a(a.fc+this.zg,a.Zb-
this.I4),this.$v(f)):H?(f=new gg,f.sH=!0,f.Sf=new Zc.a(a.fc+this.zg,l/2-this.Qw),f.Hg=new Zc.a(a.fc+this.zg,a.kc-this.Qw),this.$v(f)):null}Xkj(a,b,c,f,l,y){let H=Number.MAX_VALUE,Q=Number.MAX_VALUE,ia=Number.MAX_VALUE,wa=Number.MAX_VALUE,Ua=!0,kb=!0,Gb=!0,ec=!0;y&&l&&(Ua=l.equals(qe.a.west)||l.equals(qe.a.Wu)||l.equals(qe.a.dI),kb=l.equals(qe.a.east)||l.equals(qe.a.VE)||l.equals(qe.a.jF),Gb=l.equals(qe.a.north)||l.equals(qe.a.Wu)||l.equals(qe.a.VE),ec=l.equals(qe.a.south)||l.equals(qe.a.dI)||l.equals(qe.a.jF));
l=[];for(const dc of b)l.push(new xk.a(dc.ys()));b=this.Uq.om(c.we.width);c=this.Uq.om(c.we.height);for(const dc of l)dc.fc>3*b/4&&dc.fc<b&&a.ic<b/4&&0<a.ic&&this.kea(a,dc,!1)&&Ua&&(l=b-dc.fc-a.ic,this.fU(l,f)&&Math.abs(l)<Math.abs(ia)&&(ia=l)),dc.ic<b/4&&0<dc.ic&&a.fc>3*b/4&&a.fc<b&&this.kea(a,dc,!1)&&kb&&(l=b-a.fc-dc.ic,this.fU(l,f)&&Math.abs(l)<Math.abs(wa)&&(wa=l)),dc.Zb>3*c/4&&dc.Zb<c&&a.kc<c/4&&0<a.kc&&this.kea(a,dc,!0)&&Gb&&(l=c-dc.Zb-a.kc,this.fU(l,f)&&Math.abs(l)<Math.abs(H)&&(H=l)),dc.kc<
c/4&&0<dc.kc&&a.Zb>3*c/4&&a.Zb<c&&this.kea(a,dc,!0)&&ec&&(l=c-a.Zb-dc.kc,this.fU(l,f)&&Math.abs(l)<Math.abs(Q)&&(Q=l));a=new Xi.a;a.top=H===Number.MAX_VALUE?a.top:H;a.bottom=Q===Number.MAX_VALUE?a.bottom:Q;a.left=ia===Number.MAX_VALUE?a.left:ia;a.right=wa===Number.MAX_VALUE?a.right:wa;return a}k8a(a,b,c,f,l){const y=new Na.a,H=new Na.a,Q=new Na.a;var ia=!1,wa=!1,Ua=!1,kb=!1,Gb=!0;let ec=!0,dc=!0,Fc=!0;l&&f&&(Gb=f.equals(qe.a.west)||f.equals(qe.a.Wu)||f.equals(qe.a.dI),ec=f.equals(qe.a.east)||f.equals(qe.a.VE)||
f.equals(qe.a.jF),dc=f.equals(qe.a.north)||f.equals(qe.a.Wu)||f.equals(qe.a.VE),Fc=f.equals(qe.a.south)||f.equals(qe.a.dI)||f.equals(qe.a.jF));f=this.Uq.om(c.we.width);c=this.Uq.om(c.we.height);for(const yc of b)yc.fc>3*f/4&&yc.fc<f&&a.ic<f/4&&0<a.ic&&this.kea(a,yc,!1)&&Gb&&this.Ru(a.ic,f-yc.fc)&&(ia=!0,b=new gg,b.Sf=new Zc.a(yc.fc-this.PB,yc.Zb),b.Hg=new Zc.a(yc.fc-this.PB,yc.Zb+this.zg),y.add(this.$v(b)),b=new gg,b.sH=!0,b.Sf=new Zc.a(f-this.PB,yc.Zb+this.zg),b.Hg=new Zc.a(yc.fc-this.PB,yc.Zb+this.zg),
H.add(this.$v(b))),yc.ic<f/4&&0<yc.ic&&a.fc>3*f/4&&a.ic<f&&this.kea(a,yc,!1)&&ec&&this.Ru(f-a.fc,yc.ic)&&(wa=!0,b=new gg,b.Sf=new Zc.a(yc.ic-this.NO,yc.Zb),b.Hg=new Zc.a(yc.ic-this.NO,yc.Zb+this.zg),y.add(this.$v(b)),b=new gg,b.sH=!0,b.Sf=new Zc.a(0-this.NO,yc.Zb+this.zg),b.Hg=new Zc.a(yc.ic-this.NO,yc.Zb+this.zg),H.add(this.$v(b))),yc.Zb>3*c/4&&yc.Zb<c&&a.kc<c/4&&0<a.kc&&this.kea(a,yc,!0)&&dc&&this.Ru(a.kc,c-yc.Zb)&&(Ua=!0,b=new gg,b.Sf=new Zc.a(yc.fc,yc.Zb-this.I4),b.Hg=new Zc.a(yc.fc+this.zg,yc.Zb-
this.I4),y.add(this.$v(b)),l=new gg,b.sH=!0,l.Sf=new Zc.a(yc.fc+this.zg,yc.Zb-this.I4),l.Hg=new Zc.a(yc.fc+this.zg,c-this.I4),H.add(this.$v(l))),yc.kc<c/4&&0<yc.kc&&a.Zb>3*c/4&&a.Zb<c&&this.kea(a,yc,!0)&&Fc&&this.Ru(c-a.Zb,yc.kc)&&(kb=!0,b=new gg,b.Sf=new Zc.a(yc.fc,yc.kc-this.Qw),b.Hg=new Zc.a(yc.fc+this.zg,yc.kc-this.Qw),y.add(this.$v(b)),l=new gg,b.sH=!0,l.Sf=new Zc.a(yc.fc+this.zg,0-this.Qw),l.Hg=new Zc.a(yc.fc+this.zg,yc.kc-this.Qw),H.add(this.$v(l)));Ua&&(Ua=new gg,Ua.Sf=new Zc.a(a.fc,a.kc-
this.Qw),Ua.Hg=new Zc.a(a.fc+this.zg,a.kc-this.Qw),y.add(this.$v(Ua)),Gb=new gg,Ua.sH=!0,Gb.Sf=new Zc.a(a.fc+this.zg,0-this.Qw),Gb.Hg=new Zc.a(a.fc+this.zg,a.kc-this.Qw),H.add(this.$v(Gb)));kb&&(kb=new gg,kb.Sf=new Zc.a(a.fc,a.Zb-this.I4),kb.Hg=new Zc.a(a.fc+this.zg,a.Zb-this.I4),y.add(this.$v(kb)),Ua=new gg,kb.sH=!0,Ua.Sf=new Zc.a(a.fc+this.zg,c-this.I4),Ua.Hg=new Zc.a(a.fc+this.zg,a.Zb-this.I4),H.add(this.$v(Ua)));ia&&(ia=new gg,ia.Sf=new Zc.a(a.ic-this.NO,a.Zb),ia.Hg=new Zc.a(a.ic-this.NO,a.Zb+
this.zg),y.add(this.$v(ia)),ia=new gg,ia.sH=!0,ia.Sf=new Zc.a(0-this.NO,a.Zb+this.zg),ia.Hg=new Zc.a(a.ic-this.NO,a.Zb+this.zg),H.add(this.$v(ia)));wa&&(wa=new gg,wa.Sf=new Zc.a(a.fc-this.PB,a.Zb),wa.Hg=new Zc.a(a.fc-this.PB,a.Zb+this.zg),y.add(this.$v(wa)),wa=new gg,wa.sH=!0,wa.Sf=new Zc.a(f-this.PB,a.Zb+this.zg),wa.Hg=new Zc.a(a.fc-this.PB,a.Zb+this.zg),H.add(this.$v(wa)));this.g2a(y,1);this.g2a(H,2);for(let yc of y)Q.add(yc);for(let yc of H)Q.add(yc);return Q}Fvi(a,b,c){var f=new gg;const l=new gg,
y=new gg,H=new gg,Q=new gg,ia=new gg,wa=new Na.a;wa.add(f);wa.add(l);wa.add(y);wa.add(H);wa.add(Q);wa.add(ia);this.g2a(wa,0);this.rPj(f,l,y,H,Q,ia,a);for(const Ua of b)this.L3(a.kc,Ua.kc,Ua.Zb,f,Ua),this.L3(a.Zb,Ua.kc,Ua.Zb,l,Ua),this.L3(a.ic,Ua.ic,Ua.fc,y,Ua),this.L3(a.fc,Ua.ic,Ua.fc,H,Ua),this.bHb&&(this.L3(a.kc,Ua.Zf()._y,null,f,Ua),this.L3(a.Zb,Ua.Zf()._y,null,l,Ua),this.L3(a.ic,Ua.Zf()._x,null,y,Ua),this.L3(a.fc,Ua.Zf()._x,null,H,Ua),this.L3(a.Zf()._y,Ua.kc,null,Q,Ua),this.L3(a.Zf()._y,Ua.Zb,
null,Q,Ua),this.L3(a.Zf()._x,Ua.ic,null,ia,Ua),this.L3(a.Zf()._x,Ua.fc,null,ia,Ua)),this.L3(a.Zf()._y,Ua.Zf()._y,null,Q,Ua),this.L3(a.Zf()._x,Ua.Zf()._x,null,ia,Ua);0<f.length()&&0<l.length()&&(this.bHb?(Q.Sf=new Zc.a(a.ic-this.zg,a.Zf()._y),Q.Hg=Q.Sf.copy()):Q.reset());0<y.length()&&0<H.length()&&(this.bHb?(ia.Sf=new Zc.a(a.Zf()._x,a.ic-this.NO),ia.Hg=ia.Sf.copy()):ia.reset());if(this.bHb&&c){b=this.Uq.om(c.we.width);c=this.Uq.om(c.we.height);if(this.Ru(a.kc,c/2)||Math.abs(a.kc)<=hi.e8a||this.Ru(a.kc,
c))f.Sf._x=Math.min(f.Sf._x,-1*this.zg),f.Hg._x=Math.max(f.Hg._x,b+this.zg);if(this.Ru(a.Zb,c/2)||Math.abs(a.Zb)<=hi.e8a||this.Ru(a.Zb,c))l.Sf._x=Math.min(l.Sf._x,-1*this.zg),l.Hg._x=Math.max(l.Hg._x,b+this.zg);if(this.Ru(a.Zf()._y,c/2)||Math.abs(a.Zf()._y)<=hi.e8a||this.Ru(a.Zf()._y,c))Q.Sf._x=Math.min(Q.Sf._x,-1*this.zg),Q.Hg._x=Math.max(Q.Hg._x,b+this.zg);if(this.Ru(a.fc,b/2)||Math.abs(a.fc)<=hi.e8a||this.Ru(a.fc,b))H.Sf._y=Math.min(H.Sf._y,-1*this.zg),H.Hg._y=Math.max(H.Hg._y,c+this.zg);if(this.Ru(a.ic,
b/2)||Math.abs(a.ic)<=hi.e8a||this.Ru(a.ic,b))y.Sf._y=Math.min(y.Sf._y,-1*this.zg),y.Hg._y=Math.max(y.Hg._y,c+this.zg);if(this.Ru(a.Zf()._x,b/2)||Math.abs(a.Zf()._x)<=hi.e8a||this.Ru(a.Zf()._x,b))ia.Sf._y=Math.min(ia.Sf._y,-1*this.zg),ia.Hg._y=Math.max(ia.Hg._y,c+this.zg)}f=new Na.a;for(let Ua of wa)Ua.Sf&&0<Ua.length()&&(this.gZf(Ua,a),f.add(this.$v(Ua)));return f}L3(a,b,c,f,l){(this.Ru(a,b)||this.Ru(a,c))&&this.gZf(f,l)}gZf(a,b){a.sH?(a.Sf._x=Math.min(a.Sf._x,b.ic-this.zg),a.Hg._x=Math.max(a.Hg._x,
b.fc+this.zg)):(a.Sf._y=Math.min(a.Sf._y,b.kc-this.zg),a.Hg._y=Math.max(a.Hg._y,b.Zb+this.zg))}$v(a){let b;(b=a.Sf).x=b.x+this.bbd;let c;(c=a.Sf).y=c.y+this.cbd;let f;(f=a.Hg).x=f.x+this.bbd;let l;(l=a.Hg).y=l.y+this.cbd;return a}Ru(a,b){var c=hi.e8a;return!!a&&!!b&&Math.abs(a-b)<=c}rPj(a,b,c,f,l,y,H){a.Sf=new Zc.a(H.ic-this.zg,H.kc-this.Qw);a.Hg=a.Sf.copy();a.sH=!0;b.Sf=new Zc.a(H.ic-this.zg,H.Zb-this.I4);b.Hg=b.Sf.copy();b.sH=!0;c.Sf=new Zc.a(H.ic-this.NO,H.kc-this.zg);c.Hg=c.Sf.copy();f.Sf=new Zc.a(H.fc-
this.PB,H.kc-this.zg);f.Hg=f.Sf.copy();b=H.Zf();l.Sf=new Zc.a(a.Sf._x-this.zg,b._y-this.Qw);l.Hg=l.Sf.copy();l.sH=!0;y.Sf=new Zc.a(b._x-this.zg,c.Sf._y-this.zg);y.Hg=y.Sf.copy()}g2a(a,b){for(let c of a)0===b?(c.color=wf.a.ZCi,c.dashStyle="4,4",c.m9b=0):1===b?(c.color=wf.a.YCi,c.dashStyle="4,4",c.m9b=1):2===b&&(c.color=wf.a.ELf,c.dashStyle="4,4",c.m9b=2)}get O6g(){return this.bbd}set O6g(a){this.bbd=a}get P6g(){return this.cbd}set P6g(a){this.cbd=a}}hi.e8a=.4;hi.oLc=5;Object(m.a)(hi,"SmartGuideUtility",
null,[1356]);var Im=d(137),Hn=d(213),cm=d(167),nn=d(190);class on{constructor(a,b,c,f,l){this.dHb=this.eHb=this.yb=null;this.Zma=new Sys.UI.Bounds(0,0,0,0);this.vJa=1;this.Ab=!1;this.Jg=a;this.Hi=b;this.nd=f;this.Kc=c;this.nd.E_b(Object(I.a)(this,this.onResize,"onResize"));l&&this.nd.GQa(Object(I.a)(this,this.h1,"onActiveSlideDomDisplayed"));this.xm()}get visible(){return!!this.yb&&this.Ab}set visible(a){this.yb||this.xm();this.Ab!==a&&(this.yb.Sd(a),this.Ab=a)}wVf(a){this.dHb&&this.eHb.va.removeChild(this.dHb.va);
this.dHb=new Hn.a;let b=0;for(;b<a.length;b++){const c=a[b],f=new cm.a,l=on.J8j(on.glh(Zc.a.scale(c.Sf,this.vJa,this.vJa)),on.glh(Zc.a.scale(c.Hg,this.vJa,this.vJa)));f.Jt(l);f.dv(this.F3f(c.color));f.spa(c.dashStyle);f.ur(1);this.dHb.appendChild(f);2===c.m9b&&this.VWi(l[0],l[1])}this.eHb.appendChild(this.dHb)}VWi(a,b){a._y===b._y?a._x<b._x?this.vOf(a,b):this.vOf(b,a):a._y>b._y?this.wOf(a,b):this.wOf(b,a)}vOf(a,b){const c=this.vHf(b._x-a._x);this.bOc([new Zc.a(a._x,a._y),new Zc.a(a._x+c,a._y-c/2),
new Zc.a(a._x+c,a._y+c/2)]);this.bOc([new Zc.a(b._x,b._y),new Zc.a(b._x-c,b._y-c/2),new Zc.a(b._x-c,b._y+c/2)])}wOf(a,b){const c=this.vHf(a._y-b._y);this.bOc([new Zc.a(a._x,a._y),new Zc.a(a._x-c/2,a._y-c),new Zc.a(a._x+c/2,a._y-c)]);this.bOc([new Zc.a(b._x,b._y),new Zc.a(b._x-c/2,b._y+c),new Zc.a(b._x+c/2,b._y+c)])}vHf(a){return Math.min(a,10)/2}bOc(a){const b=new cm.a,c=this.F3f(wf.a.ELf);b.Jt(a);b.dv(c);b.ur(1);b.eF(c);b.Sd(!0);this.dHb.appendChild(b)}F3f(a){return this.Hi&&this.Hi.highContrastColors?
this.Hi.highContrastColors.foregroundTextColor:a}xm(){this.yb=new Im.a;this.yb.Dr("SmartGuideView");this.yb.Zj(0);this.yb.Sd(!1);this.Jg.va.appendChild(this.yb.va);this.eHb=new nn.a;this.eHb.va.style.overflow="visible";this.yb.appendChild(this.eHb);this.ds(this.Kc.Jc)}onResize(a,b){b&&this.ds(b.xG)}h1(a,b){b&&this.ds(b.xG)}ds(a){this.yb&&a&&a.we&&a===this.Kc.Jc&&(this.Zma.x!==a.we.x||this.Zma.y!==a.we.y||this.Zma.width!==a.we.width||this.Zma.height!==a.we.height)&&(this.Zma=new Sys.UI.Bounds(a.we.x,
a.we.y,a.we.width,a.we.height),this.yb.setPosition(a.we.x,a.we.y),this.eHb.ah(a.we.width,a.we.height),this.yb.ah(a.we.width,a.we.height))}static J8j(a,b){b._y===a._y||Math.abs(b._y-a._y)%2||(b._y+=1);b._x===a._x||Math.abs(b._x-a._x)%2||(b._x+=1);return[a,b]}static glh(a){return new Zc.a(Math.floor(a.x)+.5,Math.floor(a.y)+.5)}}Object(m.a)(on,"SmartGuideView",null,[1355]);class $n{setPosition(a,b,c){a.setPosition(a.x+b,a.y+c,!0)}setOffsets(a,b){a.setOffsets(Xi.a.add(a.e_a,b),!0)}YI(a){return new xk.a(a.ys())}wG(a){return!a.shapeNode.Lv}}
Object(m.a)($n,"DefaultShapeMoveResizeHandler",null,[709]);class xm{constructor(){this.K=null}get name(){return"PowerPointWebEditor.SmartGuide"}Yb(a){this.K=a;this.K.register(1354,"PowerPointWebEditor.ISmartGuideManager").ma().oa(()=>new np(this.K.resolve("PowerPointWebEditor.ISmartGuideView"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ISmartGuideUtility"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptoSmartGuidesMarginCenterEquisizing));
this.K.register(1355,"PowerPointWebEditor.ISmartGuideView").ma().oa(()=>new on(this.K.resolve("PowerPointWebEditor.ISlidePane"),this.K.resolve("Common.Utils.IHighContrastDetector"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").fva));this.K.register(1356,"PowerPointWebEditor.ISmartGuideUtility").ma().oa(()=>new hi(this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptoSmartGuidesAlignToSlideAndCenterEdge))}init(){this.K.resolve("PowerPointWebEditor.ISmartGuideUtility").addHandler(new $n)}dispose(){}static main(){n.a.instance.Ac(new xm)}}Object(m.a)(xm,"PPTWebEditorSmartGuidePackage",null,[2,3]);class dl{}dl.Qvg=[C.a.backspace,C.a.Gvb,C.a.pL,C.a.K3b,C.a.LDa,C.a.enter,C.a.vtd,C.a.XB,C.a.tab,C.a.Dtc,C.a.pageDown,C.a.pageUp,C.a.WZa,C.a.jJe,C.a.VZa,C.a.iJe];dl.O$j=[C.a.backspace,C.a.Gvb,C.a.pL,C.a.K3b,C.a.LDa,
C.a.enter,C.a.vtd,C.a.XB,C.a.tab,C.a.Dtc,C.a.font,C.a.n6,C.a.tLa,C.a.Xq,C.a.FKa,C.a.P0a,C.a.mH,C.a.bI,C.a.bold,C.a.setItalic,C.a.underline,C.a.strikethrough,C.a.sr,C.a.Q1,C.a.Gja,C.a.iN,C.a.zP,C.a.TC,C.a.My,C.a.Cja,C.a.Yla,C.a.gpa,C.a.BEa,ea.a.woa,ea.a.t1,ea.a.s1,ea.a.r1,C.a.NDa,C.a.kla,C.a.Pza,C.a.Qza,C.a.Rza,C.a.BMa,C.a.CMa,C.a.M$b,C.a.N$b,C.a.Dbb,C.a.mVa,C.a.qVa,C.a.Hua,C.a.H8,ea.a.cKb,C.a.deleteRow,ea.a.Hoc,C.a.KDa,ea.a.Vld,C.a.insertTable,ea.a.QPe,C.a.eT,C.a.d_,ea.a.l6,ea.a.CKa,ea.a.E1a,ea.a.ULa,
ea.a.tpa,ea.a.VLa,ea.a.Lud,ea.a.Kud,C.a.YM,C.a.sVa,C.a.centerJustify,C.a.leftJustify,C.a.rightJustify,C.a.fullJustify,C.a.z4b,C.a.Occ,C.a.htc,ea.a.Wlb,ea.a.Xlb,ea.a.Ylb,ea.a.Zlb,C.a.L0b];dl.Ngl=[C.a.leftArrow,C.a.rightArrow,C.a.upArrow,C.a.downArrow,C.a.L1a,C.a.K1a,C.a.CDa,C.a.BDa,C.a.fSa,C.a.eSa,C.a.qOb,C.a.Flb,C.a.L3b,C.a.Hvb,C.a.b9a,C.a.dSa,C.a.WZa,C.a.aTa,C.a.Ihb,C.a.Hhb,C.a.X9a,C.a.VZa,C.a.$Sa,C.a.W9a,C.a.pta,C.a.wtd,ea.a.msc,ea.a.MQb,ea.a.V1a,ea.a.VOb];Object(m.a)(dl,"ActionIdList",null,[]);
class ok{constructor(){this.ActionTime=this.ActionName=this.ActionId=null}}Object(m.a)(ok,"ActionInformation",null,[]);class Ok{constructor(a,b,c,f,l,y){this.tdb=[];this.Mdc=[];this.yJ=a;this.fte=b||[];this.ia=c;this.ia.Kaa(this);this.Ya=f;this.JX=l;this.CH=y}b6(a){this.rBh(a)&&this.Bpa(a.actionId)&&(this.tdb.push(a.actionId),this.Mdc.push(Date.now()))}a6(a){this.rBh(a)&&this.Bpa(a.actionId)&&(this.tdb.pop(),this.Mdc.pop())}Bpa(a){if(Array.contains(this.fte,a))return!0;a=this.ia.GT(a);return!!a&&
!(a.flags[32]||a.flags[64])}rBh(a){return 2===a.behavior&&a.Wi?!0:!1}getCommandName(a,b=""){return(a=this.yJ?this.yJ.t6(a):null)?a:b}oY(a){a&&a.Ssa&&xa.a.J(23594504,822,50,"ClientRevisionId:{0}, ActionName:{1}, PodSID:{2}, UndoAction:{3}",a.Ssa.toString(),this.actionName||(this.JX.fd===C.a.typing||this.JX.fd===C.a.NCa||this.JX.fd===C.a.tSa?"Typing":null)||(this.CH.w0c?"ClosingTextUndoStack":""),this.Ya.podSessionId||"",this.yJ.t6(this.JX.fd));return!!this.tdb.length}update(a,b){a=new ok;a.ActionId=
this.C8f();a.ActionName=this.D8f();a.ActionTime=this.Tjj().toString();cl.a.Po(b,zb.a.mai,a);b.setValue(zb.a.E$b,!0);b.setValue(zb.a.fqd,1)}get actionName(){return this.D8f()}get actionId(){return this.C8f()}Iae(){return this.tdb[this.tdb.length-1]}C8f(){return this.tdb.length?this.Iae().toString():null}D8f(){return this.tdb.length?this.getCommandName(this.Iae(),this.Iae().toString()):null}Tjj(){return this.Mdc.length?this.Mdc[this.Mdc.length-1]:Number.MAX_VALUE}}Object(m.a)(Ok,"ActionInfoRevisionMetaDataUpdater",
null,[1400,143]);class Jm{constructor(){this.xa=new Pc.a}Zkh(a){this.xa.raiseEvent("UCI",a)}Oii(a){this.xa.addHandler("UCI",a)}q9k(a){this.xa.removeHandler("UCI",a)}}Object(m.a)(Jm,"CcpEventSource",null,[1463,1464,1465]);class Zg{constructor(a,b){this.xec=this.uue=this.tue=null;this.vue=a;this.FU=b;this.vue.Oii(Object(I.a)(this,this.i8g,"onCcpPropertyChanged"))}i8g(a,b){this.tue=b.Jp;this.uue=b.Jxi;this.xec=b.Kxi}oY(a){a=this.FU.$Ea(a.Mya);!this.xec&&a.Ua(zb.a.C8a)&&(a.removeProperty(zb.a.IN),a.removeProperty(zb.a.mQ),
a.removeProperty(zb.a.C8a));return!!this.xec}update(a,b){b.setValue(zb.a.IN,this.tue);b.setValue(zb.a.mQ,this.uue);b.setValue(zb.a.C8a,this.xec);this.xec=this.uue=this.tue=null}dispose(){this.vue&&this.vue.q9k(Object(I.a)(this,this.i8g,"onCcpPropertyChanged"))}}Object(m.a)(Zg,"CcpInfoRevisionMetaDataUpdater",null,[1370,1400,107]);var Tm=d(328);class Nh extends Ig.a{constructor(a,b,c,f,l,y,H){super();this.ShapeId=this.Sid=this.Cid=0;this.FetchImageData=!1;this.AuthToken=this.Origin=this.SessionUrl=
null;this.Cid=a;this.Sid=b;this.ShapeId=c;this.FetchImageData=f;this.SessionUrl=l;this.Origin=y;this.AuthToken=H}pl(){return 108}}Object(m.a)(Nh,"AugmentImageRequest",Ig.a,[]);class ym extends Ig.a{constructor(){super()}pl(){return 81}}Object(m.a)(ym,"FlushRequest",Ig.a,[]);class sl extends Ig.a{constructor(a,b,c,f,l,y){super();this.AgendaSid=this.AgendaCid=0;this.Hints=this.DeckSuggestionId=this.SessionId=this.CorrelationId=null;this.AgendaCid=a;this.AgendaSid=b;this.CorrelationId=c;this.SessionId=
f;this.DeckSuggestionId=l;this.Hints=y}pl(){return 111}}Object(m.a)(sl,"GenerateAgendaDeckSuggestionRequest",Ig.a,[]);class jf extends Ig.a{constructor(a,b,c,f,l){super();this.AgendaSid=this.AgendaCid=0;this.Hints=this.OutlineJson=this.CorrelationId=null;this.AgendaCid=a;this.AgendaSid=b;this.CorrelationId=c;this.OutlineJson=f;this.Hints=l}pl(){return 110}}Object(m.a)(jf,"GenerateAgendaSuggestionRequest",Ig.a,[]);class pk extends Ig.a{constructor(a,b,c,f,l,y,H,Q,ia,wa){super();this.ShapeViewHeight=
this.ShapeViewWidth=this.ShapeId=this.Sid=this.Cid=0;this.SubNodeId=null;this.SubNodeHeight=this.SubNodeWidth=0;this.Trigger=this.CorrelationId=null;this.Cid=a;this.Sid=b;this.ShapeId=c;this.ShapeViewWidth=f;this.ShapeViewHeight=l;this.SubNodeId=y;this.SubNodeWidth=H;this.SubNodeHeight=Q;this.CorrelationId=ia;this.Trigger=wa}pl(){return 99}}Object(m.a)(pk,"GenerateIconSuggestionRequest",Ig.a,[]);class qk extends Ig.a{constructor(a,b,c,f){super();this.ImageKey=this.GraphNodeId=null;this.IsGenerateSuggestion=
this.IsSVGBlipFill=!1;this.GraphNodeId=Dk.a(a);this.ImageKey=b;this.IsSVGBlipFill=c;this.IsGenerateSuggestion=f}pl(){return 91}}Object(m.a)(qk,"GenerateImageDescriptionRequest",Ig.a,[]);class yk extends Ig.a{constructor(a,b,c,f,l,y,H){super();this.Sid=this.Cid=0;this.Hints=this.LastShownCorrelationId=this.Trigger=this.TermCorrelationId=this.CorrelationId=null;this.Cid=a;this.Sid=b;this.CorrelationId=c;this.TermCorrelationId=f;this.Trigger=l;this.LastShownCorrelationId=y;this.Hints=H}pl(){return 66}}
Object(m.a)(yk,"GenerateSuggestionRequest",Ig.a,[]);class rk extends yk{constructor(a,b,c,f,l,y,H,Q){super(a,b,f,null,l,y,"");this.ShapeViewHeight=this.ShapeViewWidth=this.ShapeId=0;this.ShapeId=c;this.ShapeViewWidth=H;this.ShapeViewHeight=Q}pl(){return 83}}Object(m.a)(rk,"GenerateReplaceObjectRequest",yk,[]);class zk extends Ig.a{constructor(a,b,c){super();this.m_shapeid=this.m_cid=this.m_slideid=0;this.m_slideid=a;this.m_cid=b;this.m_shapeid=c}pl(){return 57}}Object(m.a)(zk,"GetPictureCropInfoRequest",
Ig.a,[]);class hq extends Ig.a{constructor(){super();this.SlideCid=this.SlideSid=this.Scenario=0;this.ShapeIds=null}pl(){return 109}}Object(m.a)(hq,"ImageTransformRequest",Ig.a,[]);class ti extends Ig.a{constructor(a,b){super();this.JsonString=this.CorrelationId=null;this.CorrelationId=a;this.JsonString=b}pl(){return 84}}Object(m.a)(ti,"ReportReplaceObjectInfoRequest",Ig.a,[]);class pn extends Ig.a{constructor(a,b){super();this.JsonString=this.CorrelationId=null;this.CorrelationId=a;this.JsonString=
b}pl(){return 67}}Object(m.a)(pn,"ReportSuggestionSessionInfoRequest",Ig.a,[]);class wo extends Ig.a{constructor(a,b,c){super();this.SlideId=null;this.ShapeId=0;this.Base64OfSnapshot=null;this.SlideId=a;this.ShapeId=b;this.Base64OfSnapshot=c}pl(){return 59}}Object(m.a)(wo,"UpdateContentAddinSnapshotInfoRequest",Ig.a,[]);class tl{constructor(a,b,c){this.CH=a;this.Tb=b;this.Zzg=c}get w0c(){return this.CH.w0c}F8a(a,b=!1){return this.CH.F8a(a,b)}forceOutbound(){this.CH.forceOutbound()}Gga(a,b,c=!1){this.CH.Gga(a,
b,c)}xIc(a){this.CH.xIc(a)}oyb(a){return this.CH.oyb(a)}Hb(a){this.CH.Hb(a)}n$f(a,b,c,f=null,l=null,y=!1){a=new th.a(new zk(a,b,c),f,l,H=>0===H.StatusCode);this.CH.Gga(a,this.Tb,y)}Eka(a,b,c,f,l,y,H,Q=null,ia=null){a=new th.a(new yk(a,b,c,f,l,y,H),Q,ia,wa=>0===wa.StatusCode);this.CH.Gga(a,this.Tb)}generateImageDescription(a,b,c,f){a=new th.a(new qk(a,b,c,f),null,null,l=>0===l.StatusCode);this.CH.Gga(a,this.Tb)}$oa(a,b,c){a=new th.a(new pn(a,b),null,()=>!0,f=>0===f.StatusCode);this.CH.Gga(a,this.Tb,
c)}m3f(a,b,c,f,l,y,H,Q=null,ia=null){a=new th.a(new rk(a,b,c,f,l,null,y,H),Q,ia,wa=>0===wa.StatusCode);this.CH.Gga(a,this.Tb)}aal(a,b,c=null,f=null){a=new th.a(new ti(a,b),c,f,l=>0===l.StatusCode);this.CH.Gga(a,this.Tb)}M9i(a,b,c,f,l,y,H,Q,ia=null,wa=null){a=new th.a(new pk(a,b,c,f,l,y,74,74,H,Q),ia,wa,Ua=>0===Ua.StatusCode);this.CH.Gga(a,this.Tb)}augmentImage(a,b,c,f,l,y,H,Q=null,ia=null){a=new th.a(new Nh(a,b,c,f,l,y,H),Q,ia,wa=>0===wa.StatusCode);this.CH.Gga(a,this.Tb)}generateAgendaSuggestion(a,
b,c,f,l,y=null,H=null){a=new th.a(new jf(a,b,c,f,l),y,H,Q=>0===Q.StatusCode);this.CH.Gga(a,this.Tb)}generateAgendaDeckSuggestion(a,b,c,f,l,y,H=null,Q=null){a=new th.a(new sl(a,b,c,f,l,y),H,Q,ia=>0===ia.StatusCode);this.CH.Gga(a,this.Tb)}eNh(a,b,c,f=null,l=null){const y=new th.a(new wo(a,b,c),f,l,ia=>0===ia.StatusCode),H=()=>{this.v0i(y)};a=this.CH.oyb(this.Tb.Ef);const Q=new Tm.a;a?a.forceOutbound(()=>{H()},l?()=>{l(Q)}:null,null):(xa.a.J(509084637,823,10,"Can't find graph space replicator when trying to do outbound"),
l&&l(Q))}flush(a=null,b=null){a=new th.a(new ym,a,b,c=>0===c.StatusCode,3);this.CH.ota(a)}ota(a){this.CH.ota(a)}SUc(){return this.oyb(this.Tb.Ef)}v0i(a){this.Zzg.Hb(a);this.Zzg.forceOutbound(null,null,null)}}Object(m.a)(tl,"OutboundHelper",null,[1367,43,1407]);var ul=d(259),Ak=d(174);class Ek{constructor(a,b,c,f,l){this.vM=[];this.Afb=new ul.a;this.Ced=null;this.uxg=[];this.x5=null;this.xa=new Pc.a;this.QDg=this.DFb=this.ced=!1;this.Sb=a;this.la=b;this.ta=c;this.gpk=l;this.vwa=f;this.olk=this.la.$ua?
1:4;f.fk(Object(I.a)(this,this.bjd,"onMainMastersLoaded"));this.la.$ua&&f.fk(Object(I.a)(this,this.v$g,"onMasterIdListChanged"))}get Cuk(){if(this.la.$ua&&this.ta.Ba){const a=this.ta.Ba.jj;a&&Array.contains(this.vM,a)&&this.dJe(a)}return this.vM.slice(0,Math.min(this.olk,this.vM.length))}v6k(a){Array.remove(this.vM,a)}get hEl(){return this.Ced}get bP(){return this.Afb}get XZb(){return this.uxg}get GLj(){return!this.Ced}get ZNk(){return 0<this.vM.length&&(!this.la.iWa||this.ced)}get AJe(){return this.DFb}set AJe(a){this.DFb=
a}NAl(a){a&&this.NKh(a.jj)}PEh(){this.ced=!0;this.wod(!0);this.IMb()}NKh(a){this.ced=!0;a&&(Array.remove(this.vM,a),Array.insert(this.vM,0,a));this.IMb()}D3e(a){this.la.$ua?this.NKh(a):this.PEh()}a9f(a){if(!a||!this.Afb)return null;a=a.jj;if(!a)return null;let b=null;return({value:b}=this.Afb.wg(a)).returnValue?b:null}v$g(a,b){b.property.id===zb.a.Rfd.id&&(xa.a.J(38847373,824,50,"MasterIdList update, need load master id list: {0}",this.DFb),this.DFb&&(this.DFb=!1,this.ced&&(this.wod(!1),this.IMb())),
this.tJf())}bjd(a,b){a=b.property;if(this.la.$ua)if(a.id===zb.a.OHb.id){a=this.Sb.Qjj();const f=this.Sb.XI();if(f&&f.length)if(a&&a.length){for(var c=b=0;b<a.length&&c<f.length;){const l=a[b],y=f[c];l.Id<y.Id?(this.jNh(l.Id),b++):y.Id<l.Id?(this.u9e(y.Id),c++):(De.c(l)!==De.c(y)&&this.ZNl(y.Id),c++,b++)}if(c<f.length)for(;c<f.length;c++)this.u9e(f[c].Id);if(b<a.length)for(;b<a.length;b++)this.jNh(a[b].Id);this.IMb()}else Ak.b(f,null,l=>{this.u9e(l.Id)})}else a.id===zb.a.JY.id&&(xa.a.J(38847375,824,
50,"Slide size changed, need to reload the resources."),this.wod(!0),this.IMb());else if(a.id===zb.a.OHb.id||a.id===zb.a.JY.id)xa.a.J(19240846,824,50,"MainMasters are reloaded, need to reload the resources"),this.wod(!0),this.IMb()}u9e(a){this.dJe(a)}ZNl(a){this.dJe(a)}dJe(a){Array.contains(this.vM,a)&&Array.remove(this.vM,a);Array.insert(this.vM,0,a)}jNh(a){this.Afb.remove(a);-1!==Array.indexOf(this.vM,a)&&Array.remove(this.vM,a)}IMb(){this.x5=this.x5||this.gpk(this);this.x5.QF(null,null,null)}wod(a){if(this.la.$ua){xa.a.J(38847378,
824,50,"RefreshMastersToLoad, need clean cache: {0} ",a);var b=this.Sb.Hxb();a&&(Array.clear(this.vM),this.clearCache());if(b&&0<b.length)for(const c of b)-1===Array.indexOf(this.vM,c.idField)&&Array.add(this.vM,c.idField);else this.DFb=!0,(a=this.Sb.gA(0))&&(a=a.jj)&&Array.add(this.vM,a)}else if(a=this.Sb.XI(),Array.clear(this.vM),this.clearCache(),a)for(b of a)this.Afb.remove(b.Id),-1===Array.indexOf(this.vM,b.Id)&&Array.add(this.vM,b.Id)}QEk(a){if(a){for(const b of a)b&&(xa.a.J(38847381,824,50,
"PresentationResourcesManager::OnMainMasterResoucesLoaded master {0} resources loaded.",b.MasterId),this.Afb.$(b.MasterId,b),this.Ced=this.Ced||b.TableStyleGallery,this.la.$ua||Array.remove(this.vM,b.MasterId));this.tJf();this.xa.raiseEvent("MainMasterResourcesLoaded")}else xa.a.J(19240848,824,10,"PresentationResourcesManager::OnMainMasterResoucesLoaded mainMasterResouces returned is null")}tJf(){!this.QDg&&this.vDf()&&(this.QDg=!0,xa.a.J(38892514,824,50,"PresentationResourcesManager::CheckFirstMasterRetrieved first master retrieved."),
eb.a("RaiseFirstMasterRetrievedEvent")&&this.xa.raiseEvent("FirstMasterRetrieved"))}Yzk(a){this.la.powerPointEnableAccCheck&&(a&&a.length?(this.uxg=a,this.xa.raiseEvent("AccCheckRuleInfoListLoaded")):xa.a.J(19240850,824,10,"PresentationResourcesManager::OnAccRuleInfoListLoaded accRuleInfoList returned is null as acc-checker is enabled"))}vDf(){if(!this.la.$ua)return!0;const a=this.Sb.Hxb();if(a&&0<a.length)for(const b of this.Sb.Hxb())if(0<b.layoutCountField&&this.bP.Fb(b.idField)&&this.bP.ga(b.idField).LayoutIcons.length===
b.layoutCountField)return xa.a.J(38892545,813,50,"LayoutDialogReady: master ID: {0}, layout count: {1}",b.idField,b.layoutCountField),!0;return!1}eJc(a){this.xa.addHandler("MainMasterResourcesLoaded",a)}h8k(a){this.xa.removeHandler("MainMasterResourcesLoaded",a)}Agi(a){this.xa.addHandler("FirstMasterRetrieved",a)}Vfi(a){this.xa.addHandler("AccCheckRuleInfoListLoaded",a)}E7k(a){this.xa.removeHandler("AccCheckRuleInfoListLoaded",a)}clearCache(){this.Afb=new ul.a}dispose(){this.vwa.Om(Object(I.a)(this,
this.bjd,"onMainMastersLoaded"));this.la.$ua&&this.vwa.Om(Object(I.a)(this,this.v$g,"onMasterIdListChanged"));this.xa.dispose();this.x5&&this.x5.dispose()}}Object(m.a)(Ek,"PresentationResourcesManager",null,[1369,107]);var In=d(394);class Il extends Ig.a{constructor(){super();this.MasterIds=null;this.NeedLoadingMasterIdList=this.IncludeTableStyle=!1}pl(){return 52}static q_d(a,b,c){const f=new Il;f.MasterIds=a;f.IncludeTableStyle=b;f.NeedLoadingMasterIdList=c;return f}}Object(m.a)(Il,"GetEditPresResourcesRequest",
Ig.a,[]);class Tj extends In.a{constructor(a,b,c,f){super();this.rDb=0;this.$fb=this.S4=!1;this.Ym=a;this.QYa=b;this.WX=f;this.enabled=2;this.Uw=c.VKi();this.Ym.register(this)}QF(){this.Uw.L7i();this.Uw.vbb();this.Ym.Uaa()}forceOutbound(){}fla(){return this.QYa.ZNk||this.QYa.AJe}bO(){return!1}RUa(){return this.Wd&&2===this.Wd.status?!0:this.S4||this.$fb?!1:this.fla()&&this.Uw.O9b()}kMb(){if(1===this._state){var a=this.QYa.Cuk;this.Wd.TH=Il.q_d(a,this.QYa.GLj,this.QYa.AJe);for(const b of a)this.QYa.v6k(b);
this.Wd.status=1;this._state=3}else 3===this._state&&this.Wd&&2===this.Wd.status&&(this.$fb?(this._state=4,this.dispose()):(200===this.Wd.Iv&&this.WX.prc(),this.Uw.dNa(),2!==this.Wd.statusCode?this.PH():this.Wd.Yr&&1===this.Wd.Yr.length?(a=this.Wd.Yr[0],0===a.StatusCode?(this.QYa.QEk(De.a(a.MainMasterResources)),this.QYa.Yzk(De.a(a.AccRuleInfoList)),this.j1()):this.PH()):this.PH()))}get tda(){return this.fla()?this.Uw.okb():super.tda}dispose(){1===this._state||4===this._state?(this.S4||this.Ym.unregister(this),
this.S4=!0):this.$fb=!0}j1(){this.rDb=0;this._state=1;this.fla()||this.Uw.W1a()}PH(){4<++this.rDb?(this._state=4,xa.a.J(19240853,824,10,"PresentationResourcesReplicator quit after {0} failures",this.rDb)):(xa.a.J(19240855,824,15,"PresentationResourcesReplicator will retry on failure"),this._state=1)}}Object(m.a)(Tj,"PresentationResourcesReplicator",In.a,[107]);class ao{constructor(a,b){this.spk=a;this.FU=b}OGk(a){if(!a)throw Error.argumentNull("dataStorePusher is null!");const b=a.Mya;let c=null,
f=!1;for(const l of this.spk)if(l.oY(a)){if(!c&&(c=this.FU.$Ea(b),!c)){xa.a.J(23594507,817,50,"revisionMetadata is null");return}l.update(a,c);f=!0}f&&this.FU.zSd(b,a,c)}}Object(m.a)(ao,"RevisionMetaDataUpdateListener",null,[1371]);var Jn=d(415);class zm{$Ea(a){if(!a)return null;const b=a.HL(4);return b&&!b.equals(ha.a.nil)?a.ze(b):new Jn.a}E9e(a,b,c,f,l,y,H,Q,ia){if(a&&f){a.vo.apply(a,zm.bel);a.setValue(zb.a.Dqg,b);a.setValue(zb.a.E$b,!0);a.setValue(zb.a.fqd,1);a.setValue(zb.a.sid,f.sid);a.setValue(zb.a.cid,
f.cid);c&&a.setValue(zb.a.fGa,!0);l&&a.setValue(zb.a.shapeId,l.get_shapeId());y&&(a.setValue(zb.a.iq,!0),a.setValue(zb.a.hHh,y.cellId),a.setValue(zb.a.rowId,y.rowId));if(H&&0<H.length){b=H.length;c=Array(b);f=Array(b);for(l=0;l<b;l++)c[l]=H[l].rowId,f[l]=H[l].cellId;a.setValue(zb.a.iq,!0);a.setValue(zb.a.zmb,f);a.setValue(zb.a.uHh,c)}a.setValue(zb.a.a6e,Q);a.setValue(zb.a.$5e,ia)}}zSd(a,b,c){if(a&&b&&c){var f=!1;a.ze(zm.Cga)||(a.ZE(c,zm.Cga),f=!0);b.Wra(c);f&&b.hza(c.id,4)}}vOh(a,b){if(a){var c=a.Mya,
f=this.$Ea(c);f.setValue(zb.a.fqd,b);this.zSd(c,a,f)}}UPl(a){if(a){var b=a.Mya,c=this.$Ea(b);c.setValue(zb.a.Ocl,0);this.zSd(b,a,c)}}}zm.Cga=ha.a.Jf("{B3AB583C-77CD-428D-9371-02C2EA7C058B}{1}");zm.bel=[zb.a.Dqg,zb.a.shapeId,zb.a.iq,zb.a.fGa,zb.a.hHh,zb.a.rowId,zb.a.zmb,zb.a.uHh,zb.a.a6e,zb.a.$5e];Object(m.a)(zm,"RevisionMetadataHelper",null,[1401]);var xo=d(671),yo=d(866);class Am extends Ig.a{constructor(a,b,c,f){super();this.ShouldWaitForSave=this.ShouldReleaseLock=!1;this.SessionCloseReason=0;
this.SessionKey=null;this.ShouldReleaseLock=a;this.ShouldWaitForSave=b;this.SessionCloseReason=c;this.SessionKey=f}pl(){return 32}}Object(m.a)(Am,"SaveAndCloseRequest",Ig.a,[]);class zo{constructor(a,b,c,f,l,y,H,Q,ia){this.ai=a;this.fdd=b;this.mD=c;this.Ya=f;this.la=l;this.Gz=y;this.Ud=H;this.pc=Q;this.Ym=ia}N7i(a){this.Ya.JBb=!0;a=new Am(!0,!1,a,this.Ya.podSessionId);this.Ud.jla=!0;const b=this.ai.SUc();b&&b.bO()&&this.pc.Pn?this.la.GDa?(ka.ULS.sendTraceTag(509436876,844,50,"SaveAndCloseHandler: forceSaveOnUnload - application is unloading, forceOutbound to save any remaining changes."),
b.forceOutbound(null,null,null),this.fdd.f6d(a,null,null)):b.s$a(null,null,null,a):this.fdd.f6d(a,null,null)}U3(a=!1,b=!0,c=null,f=null,l=1){xa.a.J(509691458,823,50,"SaveAndCloseHandler::ForceSave Start, fReleaseLock: {0}, fWaitForSave: {1}, fSaveToHost: {2}",a,!0,b);const y=new Am(a,!0,l,this.Ya.podSessionId);if(a&&this.la.markSessionClosingAtForceSave)this.Gz.markSessionClosingAtForceSave(l),this.Ym.pause(),this.fdd.s$a(y,H=>{xa.a.J(509691457,823,50,"SaveAndCloseHandler::ForceSave Succeeded. Closing session");
this.la.cZf?this.Gz.closeSession(l):this.mD.cod(new xo.a(l));c(H)},()=>{xa.a.J(509691456,823,15,"SaveAndCloseHandler::ForceSave Failed.");this.Ym.onb();f&&f(null);return!0});else{a=this.ai.SUc();const H=Q=>{this.mDk(y,c,f,ia=>0===ia.StatusCode,Q,b,l)};a?a.forceOutbound(()=>{H(!0)},()=>{H(!1)},null):(xa.a.J(509691427,823,10,"Can't find graph space replicator when trying to do outbound"),H(!1))}}mDk(a,b,c,f,l,y,H){xa.a.J(509691426,823,50,"SaveAndCloseHandler::OnForceSaveOutboundComplete Start, fReleaseLock: {0}, fOutboundSuccess: {1}, fSaveToHost: {2}",
a.ShouldReleaseLock,l,y);l&&y||a.ShouldReleaseLock?(a.ShouldReleaseLock&&(this.Ud.jla=!0),this.fdd.ota(a,Q=>{a.ShouldReleaseLock&&(this.la.cZf?this.Gz.closeSession(H):this.mD.cod(new xo.a(H)));b(Q)},c,f)):l&&b?b(new yo.a):!l&&c&&c(new Tm.a)}}Object(m.a)(zo,"SaveAndCloseHandler",null,[1368]);var Ae=d(1058),hh=d(104);class dm{constructor(a,b,c,f){this.ai=a;this.kHe=b;this.okc=c;this.oxa=f}oY(a){let b=null,c=!0;if(this.ai.w0c)b=a.Ssa,c=!1;else if(this.kHe.fd===C.a.typing||this.kHe.fd===C.a.NCa||this.kHe.fd===
C.a.tSa)b=a.Ssa;b&&(this.oxa&&this.APi(b.toString()),Nc.a.zGa(),this.okc.sJh(b,c),xa.a.J(23594510,822,50,"ClientRevisionId:{0}, GenerateTime:{1}",a.Ssa.toString(),Nc.a.uf(new Date)));return!1}update(){}APi(a){const b=new Ae.ActionContext(hh.a.KLh,1,null);b.Oj=!0;b.FF=new Date;b.Wa(hh.a.LY,Nc.a.sab(a).toString());b.vr=!0;Nc.a.Jaa(b)}}Object(m.a)(dm,"TextEditingRevisionInfoMetaDataUpdater",null,[1400]);class pj{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Storage"}Yb(a){this.K=a;
const b=()=>new Ij.a(a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IPPTServerResponseHelper"),a.resolve("PowerPointWebEditor.IReplicationTimerFactory").x3b(a.resolve("Box4.IReplicationParameters")),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>w.AFrameworkApplication.Yg);a.register(1367,"PowerPointWebEditor.Storage.IOutboundHelper").ma().oa(()=>new tl(a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),
a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),b()));a.register(1368,"PowerPointWebEditor.Storage.ISaveAndCloseHandler").ma().oa(()=>new zo(a.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),a.resolve("PowerPointWebEditor.BootStorage.ISaveAndCloseTaskExecutor"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),
a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("Box4.IReplicationScheduler")));a.register(1369,"PowerPointWebEditor.IPresentationResourcesManager").ma().oa(()=>new Ek(a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Box4.Graph.IGraphInstance").yd(7),c=>new Tj(a.resolve("PowerPointWebEditor.BootStorage.IBackgroundReplicationScheduler"),c,a.resolve("PowerPointWebEditor.IReplicationTimerFactory"),
this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"))));this.UFi()}UFi(){this.K.register(zm,"PowerPointWebEditor.RevisionMetadataHelper").as("PowerPointWebEditor.IRevisionMetadataHelper").ma();this.K.register(Jm,"PowerPointWebEditor.CcpEventSource").as("PowerPointWebEditor.ICcpEventSource").as("PowerPointWebEditor.ICcpEventNotifier").as("PowerPointWebEditor.ICcpEventHandlers").ma();this.K.register(1370,"PowerPointWebEditor.ICcpInfoRevisionMetaDataUpdater").ma().oa(()=>new Zg(this.K.resolve("PowerPointWebEditor.ICcpEventHandlers"),
this.K.resolve("PowerPointWebEditor.IRevisionMetadataHelper")));this.K.register(1371,"PowerPointWebEditor.IRevisionMetaDataUpdateListener").ma().oa(()=>new ao([new Ok(this.K.resolve("PowerPointWebEditor.IActionNameResolver"),dl.Qvg,this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("Box4.Graph.IGraphTransactionManager"),this.K.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper")),new dm(this.K.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),
this.K.resolve("Box4.Graph.IGraphTransactionManager"),this.K.resolve("PowerPointWebEditor.ITextEditingRevisionInfoTracker"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").podThumbnailUpdateTelemetryEnabled),this.K.resolve("PowerPointWebEditor.ICcpInfoRevisionMetaDataUpdater")],this.K.resolve("PowerPointWebEditor.IRevisionMetadataHelper")))}init(){this.K.resolve("PowerPointWebEditor.IRevisionMetaDataUpdateListener")}dispose(){this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager").dispose();
this.K.resolve("PowerPointWebEditor.ICcpInfoRevisionMetaDataUpdater").dispose()}static main(){n.a.instance.Ac(new pj)}}Object(m.a)(pj,"PPTWebEditorStoragePackage",null,[2,3]);class qc{constructor(a,b,c){this.eTh=a;this.HWh=b;this.w6h=c}get LCID(){return this.eTh}get Lfl(){return this.w6h}get HQf(){return this.HWh}get Nme(){return!!(this.HQf&qc.kSh)}get Jac(){return!!(this.HQf&qc.lSh)}static OZc(){qc.WXe={["20490"]:new qc(20490,4215112,"Latn"),["8251"]:new qc(8251,4215112,"Latn"),["17418"]:new qc(17418,
4215112,"Latn"),["17417"]:new qc(17417,4215112,"Latn"),["8218"]:new qc(8218,4215304,"Cyrl"),["8204"]:new qc(8204,4215112,"Latn"),["8202"]:new qc(8202,4215112,"Latn"),["8201"]:new qc(8201,4215112,"Latn"),["8193"]:new qc(8193,4493640,"Arab"),["6154"]:new qc(6154,4215112,"Latn"),["7227"]:new qc(7227,4215112,"Latn"),["19466"]:new qc(19466,4215112,"Latn"),["16394"]:new qc(16394,4215112,"Latn"),["16393"]:new qc(16393,4215112,"Latn"),["16385"]:new qc(16385,4493640,"Arab"),["7194"]:new qc(7194,4215048,"Cyrl"),
["7180"]:new qc(7180,20808,"Latn"),["7178"]:new qc(7178,4215112,"Latn"),["7177"]:new qc(7177,4215112,"Latn"),["7169"]:new qc(7169,4493640,"Arab"),["12289"]:new qc(12289,4493640,"Arab"),["6203"]:new qc(6203,4215080,"Latn"),["15372"]:new qc(15372,4215112,"Latn"),["15370"]:new qc(15370,4215112,"Latn"),["15369"]:new qc(15369,4215112,"Latn"),["15361"]:new qc(15361,4493640,"Arab"),["6170"]:new qc(6170,4215304,"Latn"),["6156"]:new qc(6156,4215112,"Latn"),["18442"]:new qc(18442,4215112,"Latn"),["6153"]:new qc(6153,
4215112,"Latn"),["6145"]:new qc(6145,4493640,"Arab"),["4155"]:new qc(4155,4215080,"Latn"),["11274"]:new qc(11274,4215112,"Latn"),["5179"]:new qc(5179,4215112,"Latn"),["14348"]:new qc(14348,4215112,"Latn"),["14346"]:new qc(14346,4215112,"Latn"),["14345"]:new qc(14345,20808,"Latn"),["14337"]:new qc(14337,4493640,"Arab"),["5146"]:new qc(5146,4215048,"Latn"),["5132"]:new qc(5132,4215112,"Latn"),["5130"]:new qc(5130,4215112,"Latn"),["5129"]:new qc(5129,4215112,"Latn"),["5127"]:new qc(5127,4215112,"Latn"),
["5124"]:new qc(5124,4281672,"Hant"),["5121"]:new qc(5121,4493640,"Arab"),["31770"]:new qc(31770,4210820,""),["31748"]:new qc(31748,4277380,""),["10266"]:new qc(10266,4215048,"Cyrl"),["10252"]:new qc(10252,4215112,"Latn"),["10250"]:new qc(10250,4215112,"Latn"),["10249"]:new qc(10249,4215112,"Latn"),["13324"]:new qc(13324,4215112,"Latn"),["13322"]:new qc(13322,4215112,"Latn"),["13321"]:new qc(13321,4215112,"Latn"),["10241"]:new qc(10241,4493640,"Arab"),["13313"]:new qc(13313,4493640,"Arab"),["4122"]:new qc(4122,
4215048,"Latn"),["4108"]:new qc(4108,4215112,"Latn"),["4106"]:new qc(4106,4215112,"Latn"),["4105"]:new qc(4105,4215112,"Latn"),["4103"]:new qc(4103,4215112,"Latn"),["4100"]:new qc(4100,4282696,"Hans"),["3179"]:new qc(3179,4215048,"Latn"),["4097"]:new qc(4097,4493640,"Arab"),["1085"]:new qc(1085,299432,"Hebr"),["1144"]:new qc(1144,4280616,"Yiii"),["21514"]:new qc(21514,4215112,"Latn"),["2145"]:new qc(2145,5132616,"Deva"),["3131"]:new qc(3131,4215112,"Latn"),["2143"]:new qc(2143,4215432,"Latn"),["12314"]:new qc(12314,
4215048,"Cyrl"),["1070"]:new qc(1070,4215080,"Latn"),["1130"]:new qc(1130,4215080,"Latn"),["12300"]:new qc(12300,4215112,"Latn"),["1091"]:new qc(1091,4215080,"Latn"),["12298"]:new qc(12298,4215112,"Latn"),["12297"]:new qc(12297,4215112,"Latn"),["2055"]:new qc(2055,4215112,"Latn"),["2052"]:new qc(2052,4282664,"Hans"),["2115"]:new qc(2115,4215368,"Cyrl"),["9242"]:new qc(9242,4215304,"Latn"),["3098"]:new qc(3098,4215048,"Cyrl"),["2107"]:new qc(2107,4215112,"Latn"),["9228"]:new qc(9228,4215112,"Latn"),
["3084"]:new qc(3084,4215112,"Latn"),["9226"]:new qc(9226,4215112,"Latn"),["3082"]:new qc(3082,4215080,"Latn"),["3081"]:new qc(3081,4215112,"Latn"),["2094"]:new qc(2094,4215080,"Latn"),["3079"]:new qc(3079,4215112,"Latn"),["2092"]:new qc(2092,4215368,"Cyrl"),["1064"]:new qc(1064,4215080,"Cyrl"),["3076"]:new qc(3076,4281640,"Hant"),["2155"]:new qc(2155,4215048,"Latn"),["3073"]:new qc(3073,4493640,"Arab"),["1153"]:new qc(1153,4215080,"Latn"),["1119"]:new qc(1119,299400,"Arab"),["1086"]:new qc(1086,
4215080,"Latn"),["2144"]:new qc(2144,938632,"Deva"),["2077"]:new qc(2077,4215112,"Latn"),["1053"]:new qc(1053,4215080,"Latn"),["2141"]:new qc(2141,4215336,"Latn"),["2074"]:new qc(2074,4215304,"Latn"),["2073"]:new qc(2073,20808,"Cyrl"),["2072"]:new qc(2072,4215112,"Latn"),["2137"]:new qc(2137,4493896,"Arab"),["2070"]:new qc(2070,4215048,"Latn"),["2068"]:new qc(2068,4215048,"Latn"),["2067"]:new qc(2067,4215112,"Latn"),["1073"]:new qc(1073,4215080,"Latn"),["2064"]:new qc(2064,4215112,"Latn"),["2129"]:new qc(2129,
414016,"Tibt"),["2128"]:new qc(2128,4608584,"Mong"),["2060"]:new qc(2060,4215112,"Latn"),["1132"]:new qc(1132,4215080,"Latn"),["1097"]:new qc(1097,5132584,"Taml"),["2057"]:new qc(2057,4215080,"Latn"),["1164"]:new qc(1164,4493608,"Arab"),["106"]:new qc(106,4210820,""),["2118"]:new qc(2118,4493640,"Arab"),["2117"]:new qc(2117,5132584,"Beng"),["2049"]:new qc(2049,4493640,"Arab"),["1156"]:new qc(1156,4215080,"Latn"),["2110"]:new qc(2110,4215112,"Latn"),["1054"]:new qc(1054,4608296,"Thai"),["2108"]:new qc(2108,
4215048,"Latn"),["1083"]:new qc(1083,4215080,"Latn"),["136"]:new qc(136,4210820,""),["1114"]:new qc(1114,4493608,"Syrc"),["1148"]:new qc(1148,4215080,"Latn"),["1145"]:new qc(1145,20776,"Latn"),["11290"]:new qc(11290,4215304,"Latn"),["1075"]:new qc(1075,20776,"Latn"),["1106"]:new qc(1106,4215080,"Latn"),["1140"]:new qc(1140,4215080,"Latn"),["120"]:new qc(120,4276356,""),["1136"]:new qc(1136,4215080,"Latn"),["1066"]:new qc(1066,4215080,"Latn"),["1098"]:new qc(1098,5132584,"Telu"),["1169"]:new qc(1169,
4215048,"Latn"),["11276"]:new qc(11276,4215112,"Latn"),["61"]:new qc(61,295044,"Hebr"),["1060"]:new qc(1060,4215080,"Latn"),["11273"]:new qc(11273,4215112,"Latn"),["1058"]:new qc(1058,4215080,"Cyrl"),["128"]:new qc(128,4489348,""),["1160"]:new qc(1160,4215080,"Latn"),["1159"]:new qc(1159,4215080,"Latn"),["1158"]:new qc(1158,20776,"Latn"),["1157"]:new qc(1157,4215080,"Cyrl"),["11265"]:new qc(11265,4493640,"Arab"),["1155"]:new qc(1155,4215080,"Latn"),["1154"]:new qc(1154,4215080,"Latn"),["1117"]:new qc(1117,
4215080,"Cans"),["1152"]:new qc(1152,4493608,"Arab"),["1115"]:new qc(1115,5132584,"Sinh"),["1150"]:new qc(1150,4215080,"Latn"),["1113"]:new qc(1113,938280,"Deva"),["1112"]:new qc(1112,938280,"Beng"),["51"]:new qc(51,16516,""),["1146"]:new qc(1146,4215080,"Latn"),["1109"]:new qc(1109,5132584,"Mymr"),["115"]:new qc(115,4210820,""),["1143"]:new qc(1143,4215080,"Latn"),["1142"]:new qc(1142,20872,"Latn"),["1141"]:new qc(1141,4215080,"Latn"),["1104"]:new qc(1104,4215080,"Cyrl"),["2058"]:new qc(2058,4215112,
"Latn"),["1102"]:new qc(1102,5132584,"Deva"),["1137"]:new qc(1137,20776,"Latn"),["1100"]:new qc(1100,5132584,"Mlym"),["1135"]:new qc(1135,4215080,"Latn"),["1134"]:new qc(1134,4215080,"Latn"),["1133"]:new qc(1133,4215080,"Cyrl"),["1096"]:new qc(1096,5132584,"Orya"),["1131"]:new qc(1131,4215048,"Latn"),["1094"]:new qc(1094,5132584,"Guru"),["1129"]:new qc(1129,20872,"Latn"),["1128"]:new qc(1128,4215080,"Latn"),["1127"]:new qc(1127,20776,"Latn"),["1126"]:new qc(1126,20776,"Latn"),["1125"]:new qc(1125,
4493608,"Thaa"),["1124"]:new qc(1124,4215080,"Latn"),["1123"]:new qc(1123,4493608,"Arab"),["1122"]:new qc(1122,4215080,"Latn"),["1121"]:new qc(1121,5132584,"Deva"),["1120"]:new qc(1120,299400,"Arab"),["1118"]:new qc(1118,4215080,"Ethi"),["1082"]:new qc(1082,4215080,"Latn"),["1116"]:new qc(1116,4215080,"Cher"),["1080"]:new qc(1080,4215080,"Latn"),["1079"]:new qc(1079,4215080,"Geor"),["1078"]:new qc(1078,4215080,"Latn"),["1077"]:new qc(1077,4215080,"Latn"),["1111"]:new qc(1111,5132584,"Deva"),["1110"]:new qc(1110,
4215080,"Latn"),["1074"]:new qc(1074,4215080,"Latn"),["1108"]:new qc(1108,4608296,"Laoo"),["1107"]:new qc(1107,4608296,"Khmr"),["1071"]:new qc(1071,4215080,"Cyrl"),["1105"]:new qc(1105,4608296,"Tibt"),["1069"]:new qc(1069,4215080,"Latn"),["1103"]:new qc(1103,5132584,"Deva"),["1067"]:new qc(1067,4215080,"Armn"),["1101"]:new qc(1101,5132584,"Beng"),["1065"]:new qc(1065,4493608,"Arab"),["1099"]:new qc(1099,5132584,"Knda"),["1063"]:new qc(1063,4215080,"Latn"),["1062"]:new qc(1062,4215080,"Latn"),["1061"]:new qc(1061,
4215080,"Latn"),["1095"]:new qc(1095,5132584,"Gujr"),["1059"]:new qc(1059,4215080,"Cyrl"),["1093"]:new qc(1093,5132584,"Beng"),["1092"]:new qc(1092,4215080,"Cyrl"),["1056"]:new qc(1056,4493608,"Arab"),["1090"]:new qc(1090,4215080,"Latn"),["1089"]:new qc(1089,4215080,"Latn"),["1088"]:new qc(1088,4215080,"Cyrl"),["1087"]:new qc(1087,4215080,"Cyrl"),["1052"]:new qc(1052,4215080,"Latn"),["1051"]:new qc(1051,4215080,"Latn"),["1050"]:new qc(1050,4215048,"Latn"),["1049"]:new qc(1049,4215080,"Cyrl"),["1048"]:new qc(1048,
4215080,"Latn"),["1081"]:new qc(1081,5132584,"Deva"),["1046"]:new qc(1046,4215048,"Latn"),["1045"]:new qc(1045,4215080,"Latn"),["1044"]:new qc(1044,4215048,"Latn"),["1043"]:new qc(1043,4215080,"Latn"),["1076"]:new qc(1076,4215080,"Latn"),["1041"]:new qc(1041,4280616,"Jpan"),["1040"]:new qc(1040,4215080,"Latn"),["119"]:new qc(119,4210820,""),["1072"]:new qc(1072,4215176,"Latn"),["1037"]:new qc(1037,4493608,"Hebr"),["1036"]:new qc(1036,4215080,"Latn"),["1035"]:new qc(1035,4215080,"Latn"),["1068"]:new qc(1068,
4215080,"Latn"),["1033"]:new qc(1033,4215048,"Latn"),["1032"]:new qc(1032,4215080,"Grek"),["1031"]:new qc(1031,4215080,"Latn"),["1030"]:new qc(1030,4215080,"Latn"),["1029"]:new qc(1029,4215080,"Latn"),["1028"]:new qc(1028,4281672,"Hant"),["1027"]:new qc(1027,4215080,"Latn"),["1026"]:new qc(1026,4215080,"Cyrl"),["140"]:new qc(140,4489348,""),["1057"]:new qc(1057,4215080,"Latn"),["50"]:new qc(50,4210820,""),["1055"]:new qc(1055,4215080,"Latn"),["135"]:new qc(135,4210820,""),["134"]:new qc(134,16516,
""),["133"]:new qc(133,4210820,""),["132"]:new qc(132,4210820,""),["131"]:new qc(131,4210820,""),["130"]:new qc(130,4210820,""),["129"]:new qc(129,4210820,""),["1047"]:new qc(1047,4215080,"Latn"),["126"]:new qc(126,4210820,""),["89"]:new qc(89,5128324,""),["124"]:new qc(124,4210820,""),["1042"]:new qc(1042,4280616,"Hang"),["122"]:new qc(122,4210820,""),["121"]:new qc(121,16516,""),["1039"]:new qc(1039,4215080,"Latn"),["1038"]:new qc(1038,4215080,"Latn"),["118"]:new qc(118,16516,""),["117"]:new qc(117,
4210820,""),["116"]:new qc(116,4210820,""),["1034"]:new qc(1034,4219176,"Latn"),["114"]:new qc(114,4210820,""),["113"]:new qc(113,16516,""),["112"]:new qc(112,4210820,""),["111"]:new qc(111,4210820,""),["110"]:new qc(110,4210820,""),["109"]:new qc(109,4210820,""),["108"]:new qc(108,4210820,""),["107"]:new qc(107,4210820,""),["1025"]:new qc(1025,4493608,"Arab"),["105"]:new qc(105,16516,""),["104"]:new qc(104,4210820,""),["103"]:new qc(103,4210820,""),["102"]:new qc(102,16516,""),["101"]:new qc(101,
4489348,""),["100"]:new qc(100,4210820,""),["99"]:new qc(99,4489348,""),["98"]:new qc(98,4210820,""),["97"]:new qc(97,5128324,""),["96"]:new qc(96,966788,""),["95"]:new qc(95,4505732,""),["94"]:new qc(94,4210820,""),["93"]:new qc(93,4210820,""),["92"]:new qc(92,4210820,""),["91"]:new qc(91,5128324,""),["90"]:new qc(90,4489348,""),["85"]:new qc(85,5128324,""),["88"]:new qc(88,934020,""),["87"]:new qc(87,5128324,""),["86"]:new qc(86,4210820,""),["9275"]:new qc(9275,4215112,"Latn"),["84"]:new qc(84,
4604036,""),["83"]:new qc(83,4604036,""),["82"]:new qc(82,4210820,""),["81"]:new qc(81,4604036,""),["80"]:new qc(80,4604036,""),["79"]:new qc(79,5128324,""),["78"]:new qc(78,5128324,""),["77"]:new qc(77,5128324,""),["76"]:new qc(76,5128324,""),["75"]:new qc(75,5128324,""),["74"]:new qc(74,5128324,""),["73"]:new qc(73,5128324,""),["72"]:new qc(72,4210820,""),["71"]:new qc(71,4210820,""),["70"]:new qc(70,5128324,""),["69"]:new qc(69,5128324,""),["68"]:new qc(68,4210820,""),["67"]:new qc(67,4210820,
""),["66"]:new qc(66,4210820,""),["65"]:new qc(65,4210820,""),["64"]:new qc(64,4210820,""),["63"]:new qc(63,4210820,""),["62"]:new qc(62,4210820,""),["18441"]:new qc(18441,4215112,"Latn"),["59"]:new qc(59,4210820,""),["58"]:new qc(58,4210820,""),["57"]:new qc(57,5128324,""),["56"]:new qc(56,4210820,""),["55"]:new qc(55,4210820,""),["54"]:new qc(54,4210820,""),["53"]:new qc(53,4210820,""),["52"]:new qc(52,4210820,""),["31"]:new qc(31,4210820,""),["47"]:new qc(47,4210820,""),["49"]:new qc(49,4210820,
""),["48"]:new qc(48,4210820,""),["44"]:new qc(44,4210820,""),["46"]:new qc(46,4210820,""),["45"]:new qc(45,4210820,""),["41"]:new qc(41,4489348,""),["43"]:new qc(43,4210820,""),["42"]:new qc(42,4210820,""),["38"]:new qc(38,4210820,""),["40"]:new qc(40,4210820,""),["39"]:new qc(39,4210820,""),["35"]:new qc(35,4210820,""),["37"]:new qc(37,4210820,""),["36"]:new qc(36,4210820,""),["9225"]:new qc(9225,4215112,"Latn"),["34"]:new qc(34,4210820,""),["33"]:new qc(33,4210820,""),["32"]:new qc(32,4489348,
""),["29"]:new qc(29,4210820,""),["30"]:new qc(30,4604036,""),["27"]:new qc(27,4210820,""),["28"]:new qc(28,4210820,""),["9217"]:new qc(9217,4493640,"Arab"),["26"]:new qc(26,4210820,""),["25"]:new qc(25,4210820,""),["24"]:new qc(24,4210820,""),["23"]:new qc(23,4210820,""),["22"]:new qc(22,4210820,""),["21"]:new qc(21,4210820,""),["20"]:new qc(20,4210820,""),["19"]:new qc(19,4210820,"Latn"),["18"]:new qc(18,4276356,""),["17"]:new qc(17,4276356,""),["16"]:new qc(16,4210820,""),["15"]:new qc(15,4210820,
""),["14"]:new qc(14,4210820,""),["13"]:new qc(13,4489348,""),["12"]:new qc(12,4210820,""),["11"]:new qc(11,4210820,""),["10"]:new qc(10,4210820,""),["9"]:new qc(9,4210820,""),["8"]:new qc(8,4210820,""),["7"]:new qc(7,4210820,""),["6"]:new qc(6,4210820,""),["5"]:new qc(5,4210820,""),["4"]:new qc(4,4278404,""),["3"]:new qc(3,4210820,""),["2"]:new qc(2,4210820,""),["1"]:new qc(1,4489348,""),["0"]:new qc(0,1,"")}}static He(a){qc.WXe||qc.OZc();return qc.WXe[a.toString()]}}qc.WXe=null;qc.kSh=262144;qc.lSh=
65536;Object(m.a)(qc,"ExtendedCultureInfo",null,[]);class Lj{jV(a,b){var c=a.sa(ab.a.yt,1033);bb.a.He(c)&&(c=qc.He(c))&&(c.Jac?a.setValue(zb.a.eastAsianFont,b):c.Nme&&a.setValue(zb.a.complexScriptFont,b));a.setValue(zb.a.latinFont,b)}static aEi(a,b,c){b.baselineFieldSpecified&&(0>b.baselineField?a.ye(ab.a.subscript,!0):0<b.baselineField?a.ye(ab.a.superscript,!0):(a.ye(ab.a.subscript,!1),a.ye(ab.a.superscript,!1)));b.bFieldSpecified&&a.ye(ab.a.bold,b.bField);b.noProofFieldSpecified&&a.ye(Ab.a.noProof,
b.noProofField);b.iFieldSpecified&&a.ye(ab.a.italic,b.iField);b.strikeFieldSpecified&&a.ye(ab.a.strikethrough,b.strikeField);b.uFieldSpecified&&a.ye(ab.a.underline,b.uField);if(b.langField){var f=bb.a.He(b.langField);f?a.ye(ab.a.yt,f.LCID):xa.a.J(8958996,820,50," FormattingHelper::ComposeCharacterProperties - Unable to get culture info for "+b.langField)}b.altLangField&&((f=bb.a.He(b.altLangField))?a.ye(zb.a.OJc,f.LCID):xa.a.J(8958998,820,50," FormattingHelper::ComposeCharacterProperties - Unable to get culture info for "+
b.altLangField));b.hlinkClickField&&(a.ye(ab.a.xt,!0),a.ye(ab.a.X_,!0));Lj.dEi(a,b,c)}static zNf(a){a>Pf.a.Vfd?a=Pf.a.Vfd:a<Pf.a.mgd&&(a=Pf.a.mgd);return Lj.iYi(a)}static dEi(a,b,c){b.szFieldSpecified&&a.ye(ab.a.fontSize,Lj.zNf(b.szField));(c=Ge.Box4ColorHelper.rMb(b,c))&&a.setValue(ab.a.fontColor,c.PD);b.latinField&&a.ye(zb.a.latinFont,b.latinField.typefaceField);b.eaField&&a.ye(zb.a.eastAsianFont,b.eaField.typefaceField);b.csField&&a.ye(zb.a.complexScriptFont,b.csField.typefaceField);b.capFieldSpecified&&
a.ye($c.a.capitalization,b.capField);b.symField&&a.ye(zb.a.FPb,b.symField.typefaceField)}static iYi(a){return a/(Pf.a.Ioc*Pf.a.nbb)}static NEf(a){return a*Pf.a.nbb}}Object(m.a)(Lj,"FormattingHelper",null,[1115]);class qn{Ocj(a,b,c){let f="";const l=a.sa(Ab.a.i0,[]);l&&0<=b&&b<l.length&&(a=a.Lh)&&(b=a.ze(l[b]))&&b.Ua(zb.a.schemeColor)&&((b=Fn.SchemeColor.parse(b.eb(zb.a.schemeColor)))?b.rua?f=Si.i(b.lQ):b.jUe(c)&&(f=Si.i(b.lQ)):xa.a.J(38606471,826,50,"schemeClr is null."));return f}Qcj(a,b){let c=
"";(a=a.ptd)||xa.a.J(38088800,826,50,"This shapeNode don't have shapeFont");a&&!a.schemeClrField&&xa.a.J(38088802,826,50,"The shapeFont don't have schemeClrField.");a&&a.schemeClrField&&(14===a.schemeClrField.valField?xa.a.J(38549282,826,50,"The color of shapeFont is W"):13===a.schemeClrField.valField?xa.a.J(38549312,826,50,"The color of shapeFont is B"):xa.a.J(38549314,826,50,"The color of shapeFont is unexpected color"),b=Ge.Box4ColorHelper.rkb(a,b),b=Si.g(b.Q0a),c=Si.i(b),"000000"===c?xa.a.J(38549316,
826,50,"The resolved color of shapeFont is B"):"FFFFFF"===c?xa.a.J(38549318,826,50,"The resolved color of shapeFont is W"):xa.a.J(38549320,826,50,"The resolved color of shapeFont is unexpected color"));return c}}Object(m.a)(qn,"NonTableThemeColorHelper",null,[1366]);class Fk{constructor(){this.charsetField=0;this.panoseField=null;this.pitchFamilyField=0;this.typefaceField=null}}Object(m.a)(Fk,"CT_TextFont",null,[]);class Um{constructor(){this.sTa=this.M0a=null}}Object(m.a)(Um,"ThemeFont",null,[]);
class ff{static isThemeFont(a){return ff.vel.hasOwnProperty(a)}static Khj(a){let b="",c,f;({i$a:c,amb:f}=ff.Chj(a)).returnValue&&(0===c?0===f?b="+Heading":1===f?b="+Heading Asian":2===f&&(b="+Heading CS"):1===c&&(0===f?b="+Body":1===f?b="+Body Asian":2===f&&(b="+Body CS")));return b}static cti(a,b,c){const f=[];if(!c||!c.FontScheme)return f;var l=ff.h0,y=ff.h0,H=ff.h0;({yug:l,DVf:y,CQf:H}=ff.pPh(l,y,H,a));({yug:l,DVf:y,CQf:H}=ff.pPh(l,y,H,b));a=c.FontScheme;l!==ff.h0?(ff.MKb(a,0,l,ff.Hfd,f),ff.MKb(a,
1,l,ff.sgd,f)):(l=ff.Fab(a,0,0),b=ff.Fab(a,1,0),ff.Xa(l)||ff.Xa(b)||(f.push(Object.assign(new Um,{M0a:l,sTa:ff.Hfd})),f.push(Object.assign(new Um,{M0a:b,sTa:ff.sgd}))));y!==ff.h0?(ff.MKb(a,0,y,ff.Gfd,f),ff.MKb(a,1,y,ff.rgd,f)):(y=ff.Fab(a,0,1),l=ff.Fab(a,1,1),ff.Xa(y)||ff.Xa(l)||(f.push(Object.assign(new Um,{M0a:y,sTa:ff.Gfd})),f.push(Object.assign(new Um,{M0a:l,sTa:ff.rgd}))));H!==ff.h0?(ff.MKb(a,0,H,ff.Ffd,f),ff.MKb(a,1,H,ff.qgd,f)):(H=ff.Fab(a,0,2),y=ff.Fab(a,1,2),ff.Xa(H)||ff.Xa(y)||(f.push(Object.assign(new Um,
{M0a:H,sTa:ff.Ffd})),f.push(Object.assign(new Um,{M0a:y,sTa:ff.qgd}))));return f}static Xa(a){return!a||!a.length}static MKb(a,b,c,f,l){a&&c!==ff.h0&&(c=ff.Tvj(a,b,c),ff.Xa(c)&&(c=ff.Fab(a,b,0),ff.Xa(c)&&(c="Arial")),l.push(Object.assign(new Um,{M0a:c,sTa:f})))}static Fab(a,b,c){let f="";switch(b){case 0:a.majorFontField&&(f=ff.Tcg(a.majorFontField,c));break;case 1:a.minorFontField&&(f=ff.Tcg(a.minorFontField,c))}return f}static Tcg(a,b){let c="";if(a)switch(b){case 0:a.latinField&&(c=a.latinField.typefaceField);
break;case 1:a.eaField&&(c=a.eaField.typefaceField);break;case 2:a.csField&&(c=a.csField.typefaceField)}return c}static Tvj(a,b,c){if(!a||c===ff.h0)return"";let f="";if(1066===c)f="Viet";else if(1152===c)f="Uigh";else if(c=qc.He(c))f=c.Lfl;return ff.Uvj(a,b,f)}static Uvj(a,b,c){let f="";if(a&&c)switch(b){case 0:a.majorFontField&&(f=ff.Scg(a.majorFontField,c));break;case 1:a.minorFontField&&(f=ff.Scg(a.minorFontField,c))}return f}static Scg(a,b){let c="";if(a&&a.fontField&&b){a=a.fontField;for(let f=
0;f<a.length;f++){const l=a[f];if(l.scriptField&&l.scriptField.toLowerCase()===b.toLowerCase()){l.typefaceField&&(c=l.typefaceField);break}}}return c}static pPh(a,b,c,f){if(f!==ff.h0){const l=qc.He(f);l&&(l.Jac?b===ff.h0&&(b=f):l.Nme?c===ff.h0&&(c=f):a===ff.h0&&(a=f))}return{yug:a,DVf:b,CQf:c}}static Chj(a){switch(a){case ff.Ffd:return{returnValue:!0,i$a:0,amb:2};case ff.Gfd:return{returnValue:!0,i$a:0,amb:1};case ff.Hfd:return{returnValue:!0,i$a:0,amb:0};case ff.qgd:return{returnValue:!0,i$a:1,amb:2};
case ff.rgd:return{returnValue:!0,i$a:1,amb:1};case ff.sgd:return{returnValue:!0,i$a:1,amb:0}}return{returnValue:!1,i$a:2,amb:0}}static Evb(a,b){let c=null;if(0===a)switch(b){case 2:c=ff.Ffd;break;case 1:c=ff.Gfd;break;case 0:c=ff.Hfd}else if(1===a)switch(b){case 2:c=ff.qgd;break;case 1:c=ff.rgd;break;case 0:c=ff.sgd}null===c&&(xa.a.J(8959518,820,10,"TextFontHelper::CreateTextFont - Invalid text font encountered"),c="");return Object.assign(new Fk,{typefaceField:c,charsetField:1})}}ff.Ffd="+mj-cs";
ff.Gfd="+mj-ea";ff.Hfd="+mj-lt";ff.qgd="+mn-cs";ff.rgd="+mn-ea";ff.sgd="+mn-lt";ff.h0=0;ff.vel={["+mj-cs"]:"",["+mj-ea"]:"",["+mj-lt"]:"",["+mn-cs"]:"",["+mn-ea"]:"",["+mn-lt"]:""};Object(m.a)(ff,"TextFontHelper",null,[]);class Km{constructor(a,b,c){this.ta=a;this.jc=b;this.Ubd=c}xbl(a,b){let c="";var f=a.sa(ab.a.yt,ff.h0),l=a.sa(zb.a.OJc,ff.h0),y=qc.He(f===ff.h0?1033:f);if(y){let H="";a.Ua(zb.a.FPb)?H=a.eb(zb.a.FPb):y.Nme&&a.Ua(zb.a.complexScriptFont)?H=a.eb(zb.a.complexScriptFont):y.Jac&&a.Ua(zb.a.eastAsianFont)?
H=a.eb(zb.a.eastAsianFont):a.Ua(zb.a.latinFont)&&(H=a.eb(zb.a.latinFont));if(ff.isThemeFont(H)){y=!1;let Q=null;if(this.Ubd){if(b=Object(qa.a)(117,this.jc.mg(b)))Q=b.Ed}else{if(!this.ta.Ba)throw Error.argumentNull("ActiveSlide is null");Q=this.ta.Ba.Ed}if(Q&&(f=ff.cti(f,l,Q)))for(l=0;l<f.length;l++)if(H===f[l].sTa){c=f[l].M0a;y=!0;break}y||(c=ff.Khj(H))}else c=H}c&&a.ye(ab.a.font,c)}}Object(m.a)(Km,"FontResolver",null,[1365]);class em{constructor(a){this.zhk=a}CIi(a,b,c){a(ab.a.yt);a(zb.a.latinFont);
a(zb.a.eastAsianFont);a(zb.a.complexScriptFont);a(zb.a.FPb);a(zb.a.OJc);a(zb.a.Ed);a(zb.a.Iub);a(zb.a.fCb);a(zb.a.EN);a(zb.a.schemeColor);a(zb.a.K0c);a(zb.a.E2d);a(zb.a.B2d);a(zb.a.y2d);a(zb.a.I2d);a(zb.a.fVa);this.zhk.xbl(b(),c)}}Object(m.a)(em,"PptFormattingCacheCopyPropertyStrategy",null,[1399]);class bo{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TextFormatting"}Yb(a){this.K=a;a.register(1365,"Box4.IFontResolver").ma().oa(()=>new Km(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTableFontWithinMultipleThemesFix));a.register(1115,"PowerPointWebEditor.IFormattingHelper").ma().oa(()=>new Lj);a.register(em,"PowerPointWebEditor.PptFormattingCacheCopyPropertyStrategy").as("Box4.IFormattingCacheCopyPropertyStrategy").ma().oa(()=>new em(a.resolve("Box4.IFontResolver")));a.register(1366,"PowerPointWebEditor.INonTableThemeColorHelper").ma().oa(()=>new qn)}init(){this.K.resolve("PowerPointWebEditor.IFormattingHelper");
this.K.resolve("PowerPointWebEditor.INonTableThemeColorHelper")}dispose(){}static main(){n.a.instance.Ac(new bo)}}Object(m.a)(bo,"PPTWebEditorTextFormattingPackage",null,[2,3]);class co{constructor(a){this.hd=a;this.sVh=N.a.instance.ga(115)}aqg(a){return this.Fog(a)?!0:this.sVh?1074135161===a.Xe||1074135162===a.Xe:!1}Eog(a){return this.Fog(a)||131162===a.Xe||4325465===a.Xe||1179729===a.Xe}Fog(a){return 131140===a.Xe||this.hd.ig&&131120===a.Xe}UUf(a){return ta.a.any(a.lK,(b,c)=>!this.Eog(c)&&!this.aqg(c))}}
Object(m.a)(co,"UndoRevisionValidator",null,[1492]);class Oo{constructor(){this.kd=Ib.a.instance.qb("Box4.IFeatureHelper")}rOb(){return w.AFrameworkApplication.fa.ka("AllowMultiUserUndo")}M1a(){return this.rOb()&&w.AFrameworkApplication.fa.ka("AllowSmartUndoMerge")}}Object(m.a)(Oo,"UndoSettingsManager",null,[1491]);var rn=d(352),qj=d(1057),op=d(206);class sn{Ua(a){return a.Ua(void 0)}M$f(a,b){return a.sa(b,null)}LWc(a,b){a=(a=a.sa(b,null))?Array.clone(a):[];return new qj.a(a)}P$f(a,b){return a.sa(b,
"")}Hxh(a,b,c){a.setValue(b,c)}}Object(m.a)(sn,"MergeableObjectUtilities",null,[487]);class tn{constructor(a,b,c,f,l){this.Gb=a;this.ta=b;this.Ga=c;this.pa=f;this.D0=l}Ohd(a,b,c){if(a)if("PowerPointGroupShapes"===b&&c)for(a=a.lK,b=[],c=0;c<a.length;++c){var f=a[c];if(f&&393227===f.Xe&&f.Ua(zb.a.l9)){f=(new sn).LWc(f,zb.a.l9);for(var l=0;l<f.length;l++){var y=this.ta.Ba;if(!y)throw Error.argumentNull("ActiveSlide is null");const H=this.D0.Vda(f.ga(l));y=y.YC(H.get_shapeId());b.push(y)}this.AIj(b)}}else if("PowerPointUngroupShapes"===
b&&!c)for(a=a.lK,b=0;b<a.length;++b)if((c=a[b])&&393227===c.Xe&&c.Ua(zb.a.Upa))for(c=(new sn).LWc(c,zb.a.Upa),f=0;f<c.length;f++){l=this.ta.Ba;if(!l)throw Error.argumentNull("ActiveSlide is null");y=this.D0.Vda(c.ga(f));l=l.YC(y.get_shapeId());this.zIj(l)}}WYc(a){if(a){const b=a.tg(this.Gb.Na);b.ila();b.XMb=!0;this.pa.I8(a)}else xa.a.J(595359873,815,10,"GroupUngroupUndoRedoActionController::HideAndDeselectShape Trying to Hide and Deselect Null shape.")}AIj(a){if(a.length){var b=this.Ga.Cs(a[0]);this.WYc(b);
for(const c of a)this.WYc(c)}}zIj(a){this.WYc(a);if(a.Of){a=this.Ga.yx(a);for(const b of a)this.WYc(b)}}}Object(m.a)(tn,"GroupUngroupUndoRedoActionController",null,[1351]);class Gk{r8g(){}Ohd(){}T7g(){}s7g(){}t3c(){return!1}}Object(m.a)(Gk,"NoOpTablePartialEditController",null,[1352]);class un{constructor(a,b,c,f,l,y){this.Vfb=null;this.ai=a;this.Ga=b;this.okc=c;this.Tb=f;this.pa=l;this.ahc=y}r8g(){this.uqe()&&this.Q3e()}Ohd(a){a&&this.uqe()&&(a=this.Vfb,this.Q3e(),this.bFh(a))}T7g(a,b,c,f){let l;
this.uqe()&&!this.l0j(a,b,c,f)&&(l=this.Q3e());return l}s7g(a,b,c){if(a&&b&&c){this.Vfb=null;a=this.pa.Xd();c=new Jd.a;b=b.lK;for(let l=0;l<b.length;++l){var f=b[l];393230===f.Xe&&f.Ua(zb.a.cellId)&&(f=this.Ga.vn(f),Array.contains(a,f)&&c.$(f.get_shapeId(),f))}0<c.count&&this.bFh(c.values.ga(0))}}l0j(a,b,c,f){let l=!1;b&&this.t3c(a)&&(f=b.ZT&&f,l=(c||f)&&b.actionId===a,this.ahc||(l=(b.actionId===a||this.t3c(b.actionId))&&1===this.okc.czb(b.H6)||l));return l}t3c(a){let b=a===C.a.NCa||a===C.a.tSa||
a===C.a.typing;this.ahc||(b=a===C.a.XB||a===C.a.enter||b);return b}bFh(a){this.Vfb=a}Q3e(){if(this.Vfb){var a=this.Tb.Di.Fi.xx.id;0!==this.okc.czb(a)&&this.okc.sJh(a,!1);a=this.ai.F8a(this.Vfb,!0)}this.Vfb=null;return a}uqe(){return!!this.Vfb}}Object(m.a)(un,"TablePartialEditController",null,[1352]);var pp=d(936);class eo{constructor(a,b,c,f){this.Ts=a;this.isk=c;this.ia=f;this.vb()}vb(){this.ia.ra(ea.a.vjb,hc.a.application,Object(I.a)(this,this.vjb,"queryIsShapeTextEditHappened"),96)}vjb(a,b,c,f,
l){l.Pua=this.Pua(l.rvc,l.w7j);return 32}Lyj(a,b,c){this.isk.yGl(new pp.a(a,b,c))}Pua(a,b){let c=!1;a&&(c=!this.Ts.L1c()&&a.CGa!==b,this.Ts.L1c()||a.CGa!==b||xa.a.J(512493777,820,15,"{0}ViewElement::EndEditing - IsEditingHappened: false. Find localUndoStack is not empty but lastContentSavedTimeBeforeEnterTextEditing not changed",Object(Wa.a)(4,a)?"Shape":"Notes"));return c}}Object(m.a)(eo,"PPTUndoActionBehavior",null,[1490]);class qp extends Sys.EventArgs{constructor(a){super();this.actionId=a}}Object(m.a)(qp,
"OnUndoEventArgs",Sys.EventArgs,[]);var A=d(739),W=d(135);class na extends A.a{constructor(a=null,b=null,c=null){super(a,b);this.SJd=c||new sn}EKb(){super.EKb();const a=new qj.a,b=new Ma.a;b.add(ha.a.nil);this.Dkb.forEach((l,y)=>{b.add(y);a.add(y);return!0});for(this.objects.forEach(l=>{b.add(l);a.add(l);return!0});0<a.length;){var c=a.ga(0);a.Q2d(0);var f=this.objects.ga(c)||this.r_.wyb(c);if(f){c=f;f=c.mA();for(let l=0;l<f.length;l++){const y=f[l],H=W.a.A8b(W.a.F2f(y));8===H?this.Sxf(this.SJd.M$f(c,
y),a,b):9===H&&this.SJd.LWc(c,y).forEach(Q=>{this.Sxf(Q,a,b);return!0})}}else Da.a.instance.shipAssertTag(17409040,2,!1,"Failed to find [revisedObjectId: {0}]",c)}}Sxf(a,b,c){c.contains(a)||(c.add(a),this.gqg(a)&&(c=this.r_.wyb(a),this.sKe(c),b.add(a)))}}Object(m.a)(na,"ReferenceFollowingRevisionDiffer",A.a,[]);class Ga{WNi(a,b){return new na(a,b)}}Object(m.a)(Ga,"UndoDifferFactory",null,[1478]);var Ka=d(284),qb=d(596);class Qb{constructor(a,b,c,f,l,y,H){a||Ka.a.argument("revisionStore cannot be null",
"revisionStore");b||Ka.a.argument("undoRevisionValidator cannot be null","undoRevisionValidator");c||Ka.a.argument("undoSettingsManager cannot be null","undoSettingsManager");f||Ka.a.argument("undoDifferFactory cannot be null","undoDifferFactory");l||Ka.a.argument("revisedObjectSpace cannot be null","revisedObjectSpace");y||Ka.a.argument("undoRevisionMergeStrategy cannot be null","undoRevisionMergeStrategy");this.g6h=a;this.CHc=b;this.Fca=c;this.O9h=f;this.bYb=l;this.R9h=y;this.Xif=H}zOc(a,b){const c=
this.O9h.WNi(a,b);c.EKb();const f=new qb.a;f.K3e(this.bYb,a);c.Dkb.forEach((H,Q)=>{f.hza(Q,H);return!0});const l=new qj.a,y=a.gU<b.gU;c.objects.forEach((H,Q)=>{if(this.CHc.aqg(Q))return!0;if(y&&!this.CHc.Eog(Q)&&!b.$_(H)&&!a.$_(H))return l.add(H),!0;f.Wra(Q);return!0});0<l.length&&ka.ULS.sendTraceTag(22607311,365,100,"Skipping Objects because they're not referenced in base {0} or revised {1}: {2}",a.id,b.id,l.Kr());this.Xif&&this.Xif.KOl(f);return f.QSc()}XNi(a,b,c,f){b=this.zOc(a,b);if(!b)return null;
if(a.id===c.id)return ka.ULS.sendTraceTag(22607312,365,this.Fca.M1a()?15:50,"Undo merge attempted with base and current were the same revision. [AllowSmartUndoMerge: {0}]",this.Fca.M1a()),b;a=this.zOc(a,c);if(!a)return null;var l=b;this.CHc.UUf(a)?(ka.ULS.sendTraceTag(22607313,365,100,"Merge determined to be necessary for undo."),l=new qj.a,l.add(a),a=new qj.a,a.add(b),l=this.R9h.Pvk(f,a,l,c.dqd).cP.last()):ka.ULS.sendTraceTag(22607314,365,this.Fca.M1a()?15:50,"Undo merge determined to be not needed because base and current are equivalent. [AllowSmartUndoMerge: {0}]",
this.Fca.M1a());return this.zOc(c,l)}YNi(a,b,c,f,l){let y=null;f||(this.Fca.M1a()||!this.Fca.rOb()?y=this.zOc(c,b):(ka.ULS.sendTraceTag(22607315,365,10,"Trying to skip merge when multi user undo is enabled and smart merge is disabled."),f=!0));f&&(y=this.XNi(a,b,c,l));return y&&this.NBl(y)?y:null}NBl(a){return this.CHc.UUf(a)?(this.g6h.lmb(a),!0):!1}}Object(m.a)(Qb,"UndoRevisionManager",null,[1477]);var t=d(164);class Y{constructor(a){this.Ymf=null;this.Ma=new Pc.a;this.bob=null;this.msb=[];this.S9h=
a}dispose(){for(;0<this.msb.length;)this.moh(this.msb[0])}get eL(){return this.bob}set eL(a){this.bob&&(this.bob.isActive=!1);if(this.bob=a)this.bob.isActive=!0}register(a){if(!this.Ola(a)){const b=this.S9h.BPi(a);b.Nyh(c=>{this.Ma.raiseEvent(Y.MIk,new qp(c))});a.addListener(this);Array.add(this.msb,b)}}unregister(a){if(a=this.ezb(a))a===this.eL&&(this.eL=null),this.moh(a)}setActive(a){this.eL=this.ezb(a)}FMc(){const a=this.ezb(void 0);a&&(a.fpa(void 0),this.jKe())}get XW(){return this.fJ?this.eL.XW:
!1}get d2d(){return this.fJ?this.eL.d2d:null}get hla(){return this.fJ?this.eL.hla:!1}get dGa(){return this.fJ?this.eL.dGa():!1}B3e(a,b){this.fJ&&this.eL.B3e(a,b)}Aw(){this.fJ&&this.eL.Aw()}RW(){return this.fJ?this.eL.RW():null}undo(){return this.fJ?this.eL.undo():!1}redo(){return this.fJ?this.eL.redo():!1}MZa(a,b,c=!1){this.fJ&&this.eL.MZa(a,b,c)&&(this.jKe(),this.Ymf&&this.Ymf())}pNe(){this.fJ&&this.eL.pNe()}moh(a){a.graphSpace.removeListener(this);a.Nyh(null);a.dispose();Array.remove(this.msb,a)}Ola(a){return!!this.ezb(a)}get fJ(){return!!this.eL}ezb(a){for(let b=
0;b<this.msb.length;b++){const c=this.msb[b];if(c.WSj(a))return c}return null}jKe(){Rc.App.Lb.updateCommandUI()}Hid(a){this.unregister(a)}onBeforeLoadContent(a){const b=this.ezb(a);if(b)b.onBeforeLoadContent(a)}onAfterLoadContent(a){const b=this.ezb(a);if(b)b.onAfterLoadContent(a);this.eL===b&&(this.eL.XW||this.eL.hla)&&this.jKe()}onAfterFirstSaveContent(){}}Y.MIk="OnUndo";Object(m.a)(Y,"UndoManager",null,[1488,814,107,1489]);class pa extends Y{constructor(a,b,c){super(a);this.Jfk=b;this.qfd=c;this.Jfk.vfi(Object(I.a)(this,
this.YCk,"onFailoverSucceeded"));this.qfd.ZSd(Object(I.a)(this,this.dEk,"onInitialSelectionSet"))}get oya(){return this.eL}hVj(a){return this.fJ?this.oya.ing(a):!1}NYd(){this.fJ&&this.oya.CAi()}o$d(a){return this.fJ?this.oya.o$d(a):null}UUc(a){return this.fJ?this.oya.UUc(a):0}R4e(){this.fJ&&this.oya.R4e()}get XW(){return this.fJ?this.oya.rHj:!1}fpa(){this.fJ&&this.oya.fpa(!0)}YCk(a,b){b.A2j&&this.fpa()}dEk(){this.MZa(C.a.lVa,null)}X8e(a){this.fJ&&this.oya.X8e(a)}L1c(){return this.fJ?this.oya.L1c():
!1}ncb(){return this.fJ?this.oya.ncb():!1}}Object(m.a)(pa,"PPTUndoManager",Y,[1487,1488,814,107,1489]);class Ja{Pvk(a,b,c,f){return a?a.fgd(b,c,null,f,1,!1,5):null}}Object(m.a)(Ja,"PPTUndoRevisionMergeStrategy",null,[1486]);var Ya=d(140),jb=d(48);class Sb{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd){this.CBe=!1;if(xd&&!tc)throw Error.argumentNull("viewElementEventNotifier");this.eue=a;this.SB=b;this.CZg=c;this.hZa=f;this.WIa=l;this.Kgb=y;this.rkc=H;this.WJ=tc;this.E5=xd;Q===jb.a.Lz&&
(Q=jb.a.Kp);this.cEg=Q;this.pa=ia;this.Sb=wa;this.fik=Ua;this.Tb=kb;this.Fa=Gb;this.ia=ec;this.chc=dc;this.Vjc=Fc;this.Gb=yc}ocl(){this.ALh();if(this.SB){var a=this.Sb.Zk(this.SB);a&&this.fik.Ba!==a&&(this.Tb.Ba=a)}if(this.chc){if(this.hZa&&0<this.hZa.length){a=[];for(const b of this.hZa){let c=this.Sb.Zk(b);c&&a.push(c)}if(0<a.length){let b;(b=this.pa).rP.apply(b,a)}}this.ia.processAction(ea.a.Z0a,2)}this.E5&&this.WJ&&this.WJ.ukh()}bV(a=!1,b=null){this.ocl();if(this.CBe||this.Vlg())return this.CBe=
!1,null;b||(b=this.jub());this.setSelection(a,b);return b}jub(){let a=null;if(0<this.Kgb.length){const b=this.Sb.Zk(this.SB);if(b){const c=[];for(const f of this.Kgb){if(!f)continue;const l=b.GQ(f);if(l){const y=l.tg(this.Gb.Na);y&&!y.XMb&&c.push(Od.SelectionFactory.nl(l))}}0<c.length&&(a=new Ya.SelectionCollection(c,c.length-1))}}a||(a=this.eue.jub(!0));!a&&this.rkc&&(a=this.rkc.o3f());return a}setSelection(a=!1,b=null){this.eue.setSelection(a,b);b&&this.rkc&&xa.a.J(509445784,816,50,"Selection restore to IP level");
b||this.cEg!==jb.a.vg?this.Fa.vf(this.cEg):(this.pa.nh(),this.Fa.Bd())}dLc(){return this.eue.dLc()}ALh(){this.SB=this.j8e(this.SB,this.CZg);const a=[];let b=0;for(const c of this.hZa)a.push(this.j8e(c,this.WIa[b++]));this.hZa=a}j8e(a,b){let c=a;a&&Va.a.Cw(a)&&(a=this.Sb.w8b(b),a||(b=this.Vjc.isj(b),null!=b&&(a=this.Sb.eFa(b))),a&&(c=a.Db));return c}$Kl(){this.SB=this.j8e(this.SB,this.CZg);this.chc&&this.ALh();if(this.Kgb.length&&Array.contains(this.Kgb,0)){Array.clear(this.Kgb);var a=this.jub();if(this.pa.d0(a))for(let b of a)(a=
Object(qa.a)(4,b.Va.node))&&this.Kgb.push(a.get_shapeId())}}kQl(){this.CBe=this.Vlg()}Vlg(){const a=this.Sb.Zk(this.SB);if(!a)return!1;var b=this.rkc?[this.rkc.s_d]:this.Kgb;for(const c of b)if((b=a.GQ(c))&&b.hq)return!0;return!1}}Object(m.a)(Sb,"PPTUndoSelectionReference",null,[328,1485]);class kc{constructor(a,b,c,f,l){this.oc=a;this.eve=b;this.H6c=c;this.mkc=f;this.lkc=l}o3f(){var a=this.oc.Zk(this.eve);if(!a)return null;a=a.GQ(this.H6c);if(!a)return null;a=a.$yb();if(!a)return null;var b=a.sa(ab.a.Nza,
0);const c=a.sa(ab.a.dha,0);if(!this.mkc||!this.lkc||this.mkc.AMa>=b||this.mkc.zMa>=c||this.lkc.AMa>=b||this.lkc.zMa>=c)return null;b=ob.GraphIterator.pb(a.ef(this.mkc.AMa,this.mkc.zMa));b.sc(14);a=ob.GraphIterator.pb(a.ef(this.lkc.AMa,this.lkc.zMa));a.sc(14);return Od.SelectionFactory.y3b(b,a)}get s_d(){return this.H6c}}Object(m.a)(kc,"PPTUndoTableCellSelectionPos",null,[1500]);class db{constructor(a,b,c,f,l,y,H,Q){this.Rb=a;this.oc=b;this.gY=c;this.Efk=f;this.eve=l;this.H6c=y;this.xed=H;this.Brk=
Q}o3f(){var a=this.oc.Zk(this.TGi);if(!a)return null;let b=null;if(10===this.containerType||16===this.containerType)if(b=a.GQ(this.s_d),!b)return null;var c=[];switch(this.containerType){case 10:c=this.V8d(b);break;case 16:a=this.Rb.Lc(b);if(!a.Oi()||!a.Oi())return null;if(0>this.AMa||0>this.zMa||this.AMa>=a.currentNode.sa(ab.a.Nza,0)||this.zMa>=a.currentNode.sa(ab.a.dha,0)){this.gY.R4g(a,0,0);c.push(Od.SelectionFactory.Aj(a.currentNode,!0));break}this.gY.R4g(a,this.AMa,this.zMa);c=this.V8d(a.currentNode);
break;case 60:c=a.fUa();if(!c)return null;c=this.V8d(c);break;default:return null}return 0<c.length?new Ya.SelectionCollection(c,0):null}get s_d(){return this.H6c}V8d(a){const b=[];for(const c of this.fFl){const f=c.c$i(a);f&&b.push(f)}b.length||b.push(Od.SelectionFactory.Aj(a,!0));return b}get containerType(){return this.Efk}get TGi(){return this.eve}get zMa(){return this.xed?this.xed.zMa:-1}get AMa(){return this.xed?this.xed.AMa:-1}get fFl(){return this.Brk}}Object(m.a)(db,"PPTUndoTextSelectionPos",
null,[1500]);class Kb{constructor(a,b){this.hrk=a;this.prk=b}get zMa(){return this.hrk}get AMa(){return this.prk}}Object(m.a)(Kb,"TableCellIndex",null,[]);class lc{constructor(a,b,c,f,l,y){this.Rb=a;this.Gh=b;this.ymk=c;this.Hfk=f;this.hjk=l;this.gjk=y}get contextId(){return this.Hfk}get paragraphIndex(){return this.ymk}get jac(){return this.hjk}get iac(){return this.gjk}c$i(a){a=this.Rb.Lc(a);if(!a.Bee(this.paragraphIndex)||11!==a.Cq.type||!a.Cb(2)||12!==a.Cq.type&&21!==a.Cq.type||this.jac>this.iac||
-1>this.jac||this.iac>this.Gh.textLength(a.currentNode))return null;switch(this.contextId){case yb.a.Mf:return Od.SelectionFactory.D3(a.currentNode,this.jac,this.iac);case yb.a.textRange:return Od.SelectionFactory.D3(a.currentNode,this.jac,this.iac);case yb.a.endOfParagraph:return Od.SelectionFactory.mda(a.currentNode);case yb.a.paragraph:return Od.SelectionFactory.Mu(cb.a.WRa(this.jac,this.iac,!1,a.currentNode))}return null}}Object(m.a)(lc,"TextContextRecord",null,[]);class Jc{constructor(a,b,c,
f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc){if(Fc&&!dc)throw Error.argumentNull("viewElementEventNotifier");this.Zek=a;this.pa=b;this.bFg=c;this.Tb=f;this.Rb=l;this.Fa=y;this.oc=H;this.Ga=Q;this.Gh=ia;this.gY=wa;this.ia=Ua;this.chc=kb;this.Vjc=Gb;this.Gb=ec;this.WJ=dc;this.E5=Fc}Nsa(){const a=this.Zek.Nsa();let b=null,c=ha.a.nil;const f=this.bFg.Ba;f&&(b=f.Db,c=f.id);const l=[],y=[];if(this.chc){var H=this.pa.Se();for(var Q of H)l.push(Q.Db),y.push(Q.id)}H=[];Q=null;f&&(this.pa.rH()&&this.o1k(H),this.pa.pz()&&
(Q=this.t1k(b)));return new Sb(a,b,c,l,y,H,Q,this.Fa.C8,this.pa,this.oc,this.bFg,this.Tb,this.Fa,this.ia,this.chc,this.Vjc,this.Gb,this.WJ,this.E5)}V1c(a){return 10===a.type||60===a.type||16===a.type}o1k(a){const b=this.pa.Xd();for(const c of b)a.push(c.get_shapeId())}t1k(a){return this.pa.Pa.mb.qg?this.r1k(a):this.s1k(this.pa.Pa,a)}s1k(a,b){var c=Object(qa.a)(5,a.mb.Va.node),f=this.Rb.Lc(c);if(f.X6(Object(I.a)(this,this.V1c,"isOEContainerNode")))if(f.Cc()&&11===f.currentNode.type){if(f.Cc()){c=(c=
this.Ga.Tda(c))?c.get_shapeId():0;const l=f.Cq.type;f=16===l?this.zde(Object(qa.a)(130,f.Cq)):null;const y=a.mb,H=[];this.ABf(y,H);for(let Q of a)Q!==y&&this.Xmi(Q,y)&&this.ABf(Q,H);return new db(this.Rb,this.oc,this.gY,l,b,c,f,H)}}else xa.a.J(509445783,816,15,"Find text selection but its container is not OutlineElement");return null}r1k(a){var b=this.pa.Pa.ga(0),c=this.pa.Pa.last,f=b.qg;b=16===f.Va.node.type?this.zde(Object(qa.a)(130,f.Va.node)):null;f=c.qg;c=16===f.jf.node.type?this.zde(Object(qa.a)(130,
f.jf.node)):null;f=(f=this.Ga.Tda(f.Va.node))?f.get_shapeId():0;return new kc(this.oc,a,f,b,c)}zde(a){return a?new Kb(a.Ai,a.rowIndex):null}ABf(a,b){for(let c of a){if(!Object(Wa.a)(104,c.node))continue;a=this.Rb.Lc(c.node);if(!a.X6(Object(I.a)(this,this.V1c,"isOEContainerNode")))continue;a.Cc();const f=a.currentNode;a.Cc();a=a.LTa(f);b.push(new lc(this.Rb,this.Gh,a,c.contextId,c.Sa,c.Mb))}}Xmi(a,b){a=this.Rb.Lc(a.Va.node);b=this.Rb.Lc(b.Va.node);return a.X6(Object(I.a)(this,this.V1c,"isOEContainerNode"))&&
b.X6(Object(I.a)(this,this.V1c,"isOEContainerNode"))&&a.Cc()&&11===a.currentNode.type&&b.Cc()&&11===b.currentNode.type&&a.Cc()&&b.Cc()?a.currentNode===b.currentNode:!1}}Object(m.a)(Jc,"PPTUndoSelectionReferenceFactory",null,[309]);class Vc{constructor(){this.KXa=this.xYg=this.vFe=this.i1g=null;this.r$c=!1;this.qHe=null}g8e(){if(!this.KXa.LAb&&this.KXa.r4c)for(const a of this.KXa.r4c)if(a.equals(this.i1g)){this.vFe.bV(!1,this.xYg);xa.a.J(22684815,813,50,"Undo/Redo Success, and E2E time is: {0}ms",
+new Date-+this.qHe);this.KXa.$qc(Object(I.a)(this,this.g8e,"trySetSelectionWhenServerUndoRedoFinish"));this.r$c=!0;break}}t4k(a,b,c,f){a&&(this.i1g=b,this.xYg=f,(this.vFe=Object(qa.a)(1485,c))?(this.I8e(),this.qHe=new Date,this.KXa=a,this.KXa.aJc(Object(I.a)(this,this.g8e,"trySetSelectionWhenServerUndoRedoFinish")),this.r$c=!1):xa.a.J(21051018,816,15,"The selectionreference is not the type of PPTUndoSelectionReference"))}I8e(){this.KXa&&!this.r$c&&(xa.a.J(22684818,813,50,"Undo/Redo Fail, and E2E time is: {0}ms",
+new Date-+this.qHe),this.KXa.$qc(Object(I.a)(this,this.g8e,"trySetSelectionWhenServerUndoRedoFinish")),this.r$c=!0)}}Object(m.a)(Vc,"PPTUndoSelectionRestoreExecutor",null,[1350]);class vd{constructor(){this.Wqk=new Jd.a(!1);this.lsk=new Jd.a(!1);this.qMg=new Jd.a(!1);this.init()}init(){this.DMj()}DMj(){this.qMg.add(ea.a.NI,!0)}eJi(a){return a&&this.Wqk.Fb(a)?!0:!1}dJi(a){return a&&this.lsk.Fb(a)?!1:!0}Msl(a){return a&&this.qMg.Fb(a)?!0:!1}}Object(m.a)(vd,"PPTUndoSettings",null,[1484]);class me{constructor(a){this.Kj=
null;this.Dcf=a}start(a){this.Kj=a}cHj(){var a=new Date;return this.Dcf?+a-+this.Kj>this.Dcf:!1}}Object(m.a)(me,"UndoTimer",null,[1499]);var mf=d(487),cf=d(530);class Bh{constructor(a){this.Wba=this.c3=null;this.Cwb=this.Huc=a}get Huc(){return this.c3}set Huc(a){this.c3&&(this.c3.iP&=-2);this.c3=a;this.c3.iP|=1}get Cwb(){return this.Wba}set Cwb(a){this.Wba&&(this.Wba.iP&=-3);this.Wba=a;this.Wba.iP|=2}get H6(){return this.c3?this.c3.id:ha.a.nil}get h5d(){return this.Wba?this.Wba.id:ha.a.nil}get lK(){return this.c3?
this.c3.cvg():[]}combineWithPrevious(){}dispose(){this.c3&&(this.c3.iP&=-2);this.Wba&&(this.Wba.iP&=-3)}}Object(m.a)(Bh,"Box4UndoRecordData",null,[1511,107]);class Fh{constructor(a,b,c,f,l,y){this.Xya=a;this.Skb=b;this.P9h=c;this.actionId=f;this.ZT=l;this.oLa=y}get g2(){return this.P9h}get H6(){return this.g2.H6}dispose(){this.g2&&this.g2.dispose()}}Object(m.a)(Fh,"UndoRecord",null,[107]);class of{constructor(){this.Lra=[]}ga(a){return this.Lra[a]}get length(){return this.Lra.length}add(a){this.Lra.push(a)}clear(){for(let a=
0;a<this.Lra.length;a++)this.Lra[a].dispose();Array.clear(this.Lra)}remove(a){const b=Array.remove(this.Lra,a);b&&a.dispose();return b}removeAt(a){0<=a&&a<this.Lra.length&&(this.Lra[a].dispose(),Array.removeAt(this.Lra,a))}}Object(m.a)(of,"UndoRecordsArray",null,[]);class aj{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye,Xd){this.v6a=!0;this.P4a=this.Bhf=this.wCc=this.Arb=!1;this.spb=null;this.LKd=this.mof=0;this.kRd=null;this.rtf=!0;this.isActive=!1;this.Tz=a;this.bCd=b;this.D1h=
c;this.fFd=f;this.S$h=l;this.O3h=y;this.Lk=H;this.kI=Q;this.hrf=ia;this.E6h=wa;this.Zd=Ua;this.G9h=kb;this.O6h=Gb;this.wqf=ec;this.Quf=Fc;this.Ruf=yc;this.T9h=tc;this.Tuf=xd;this.Fca=Vd;this.ez=ye;this.Vg=new of;this.xs=this.uh=-1;this.Nif=Object(I.a)(this,this.hPf,"createInitialUndoRecord");this.MFc=dc;this.MFc.Thi(Object(I.a)(this,this.loh,"removeUndoRecordForRevision"));this.rtf=Xd}dispose(){this.Nif=null;this.FMc();this.Tz=null;this.MFc.N8k(Object(I.a)(this,this.loh,"removeUndoRecordForRevision"))}get graphSpace(){return this.Tz}get lpc(){return this.D1h.value}WSj(a){return this.Tz===
a?!0:!1}FMc(){this.Vg.clear();this.xs=this.uh=-1;this.v6a=!0}$Ai(){if(this.uh===this.Vg.length-1)this.FMc();else{let a=0;for(;a<this.uh;)this.Vg.removeAt(0),a++;this.uh=0;this.xs=1}}get XW(){return 0<this.uh}get d2d(){return this.XW?this.Vg.ga(this.uh).actionId:null}get e2d(){return 0<=this.uh&&this.uh<this.Vg.length?this.Vg.ga(this.uh).g2:null}B3e(a,b){this.P4a?(this.yvc(),this.fpa()):(this.wqf&&this.lpc.suspend(),this.P4a=!0,this.spb=a,this.mof=b,this.LKd=0)}yvc(){this.P4a=!1;this.wqf&&this.lpc.resume()}ELl(){this.O6h(new ha.a(this.spb,
1));this.yvc()}MZa(a,b,c=!1){if(!this.bCd()||a===C.a.lVa&&this.Vg.length)return!1;var f=this.Tz.MT();if(!f&&a!==C.a.lVa&&!c||!this.Tz||!this.Tz.Fi)return!1;f&&(this.Bhf||(ka.ULS.sendTraceTag(39102051,305,50,"Real Edit occurred"),this.Bhf=!0),this.fFd.execute(y=>{y.K4d()}));if(this.P4a){ka.ULS.sendTraceTag(23171273,365,50,"Incremental action {0} interrupted by user edits. Cancelling action.",this.spb);this.yvc();for(c=this.Vg.length-2;0<=c;c--)this.Vg.removeAt(c);this.uh=0;this.xs=-1}c=this.RW();f=
this.C1d(f,a);this.ewb();b=this.gDi(a,f,b);const l=this.Fca.rOb()&&!this.Fca.M1a();a=new Fh(b,c,f,a,this.Arb,l);this.Vg.add(a);this.uh=this.Vg.length-1;return!0}C1d(a,b){return this.Quf(a,b,void 0)}gDi(a,b,c){if(0<=this.uh){switch(a){case C.a.NCa:case C.a.tSa:case C.a.typing:this.v6a&&this.Vg.ga(this.uh).actionId===a?(a=this.Vg.ga(this.uh),c=a.Xya,b.combineWithPrevious(a.g2),this.Vg.removeAt(this.uh)):w.AFrameworkApplication.fa.ka("OtelSendTypingUserActionDisabled")||(b=this.G9h.create(a),b.end(32),
this.S$h.Cqc(b),this.O3h.Bqc(b))}this.v6a=!0}return c}pNe(){this.T9h(this)}zUi(){this.rtf&&!this.v6a||!this.Fca.rOb()||(this.v6a=!1,this.Arb=!0)}juk(){if(this.Fca.M1a())for(let a=0;a<this.Vg.length;a++)this.Vg.ga(a).oLa=!0}ewb(){if(this.uh<this.Vg.length-1){for(let a=this.Vg.length-1;a>this.uh;a--)this.Vg.removeAt(a);this.xs=-1}}MPl(){var a=t.ObjectSpace.Z8(this.Tz.Fi);a=new Bh(a);const b=this.RW(),c=this.Vg.ga(this.uh).Xya;a=new Fh(c,b,a,C.a.Uxd,this.Vg.ga(this.uh).ZT,this.Vg.ga(this.uh).oLa);this.Vg.removeAt(this.Vg.length-
1);this.Vg.add(a)}ojb(a,b,c,f){return a.ojb(b,c,f)}LOe(a,b,c){this.wCc=!0;a.Ure();this.wCc=!1;b.bV(void 0,c)}undo(){if(!this.XW)return!1;this.fFd.execute(wa=>{wa.K4d()});var a=!0;let b=!1;var c=!1;const f=this.Lk.je(7);f.ld(this.Tz);let l=0,y=!1,H=this.RW(),Q=null;const ia=this.Ruf(!0);for(this.Tuf.start(new Date);this.XW&&a;){const wa=this.Vg.ga(this.uh),Ua=this.Vg.ga(this.uh-1);a=wa.ZT&&Ua.ZT;ka.ULS.sendTraceTag(22607296,365,50,"Performing Undo [IsContinuation: {0}], [AppMode: {1}]",a,cf.a[this.ez]);
this.xs=this.uh;try{if(b=this.ojb(ia,wa.g2,Ua.g2,wa.oLa||Ua.oLa))H=this.Vg.ga(this.uh).Xya,Q=this.Vg.ga(this.xs).Skb,this.kRd&&this.kRd(this.Vg.ga(this.uh).actionId)}catch(kb){ka.ULS.sendTraceTag(22607297,365,10,"Undo hit an exception: {0}. Callstack: {1}",kb.message,kb.stack),b=!1,c=!0}l++;b?this.uh--:(ka.ULS.sendTraceTag(22607298,365,15,"Undo failed. [HitException: {0}] [AppMode: {1}]",c,cf.a[this.ez]),this.$Ai(),a=!1);if(this.Tuf.cHj()){y=!0;break}}b&&this.LOe(ia,H,null,Q,!0);f.dispose();this.Aw();
this.P4a&&(this.ELl(),this.ewb());this.kI.updateCommandUI();this.hrf.Uaa();if(0<this.uh&&y&&this.Vg.ga(this.uh).ZT){a=this.uh;for(c=0;0<a&&this.Vg.ga(a).ZT;)c++,a--;this.Vg.ga(this.uh).ZT=!1;ka.ULS.sendTraceTag(22607299,365,50,"Cascading undos exceed the time limit, [MergesDone: {0}], [MergesToBeDone: {1}].",l,c)}else 1<l&&ka.ULS.sendTraceTag(22607300,365,50,"Cascading undos within the time limit, [MergesDone: {0}]",l);return b}Aw(){this.Arb=this.v6a=!1}get hla(){return 0<this.xs}redo(){if(!this.hla)return!1;
this.fFd.execute(H=>{H.K4d()});var a=!0;let b=!1,c=!1;const f=this.Lk.je(7);f.ld(this.Tz);let l=this.RW();const y=this.Ruf(!1);for(;this.hla&&a;){a=this.Vg.ga(this.xs);const H=this.Vg.ga(this.uh);ka.ULS.sendTraceTag(22607301,365,50,"Performing Redo [IsContinuation: {0}] [AppMode: {1}]",this.Vg.ga(this.xs).ZT&&this.Vg.ga(this.uh).ZT,cf.a[this.ez]);try{if(b=this.ojb(y,a.g2,H.g2,a.oLa||H.oLa))l=this.Vg.ga(this.xs).Skb}catch(Q){ka.ULS.sendTraceTag(22607302,365,10,"Redo hit an exception: {0}. Callstack: {1}",
Q.message,Q.stack),b=!1,c=!0}b?(this.uh=this.xs,this.xs<this.Vg.length-1?(this.xs++,a=this.Vg.ga(this.xs).ZT&&this.Vg.ga(this.uh).ZT):(this.xs=-1,a=!1)):(ka.ULS.sendTraceTag(22607303,365,15,"Redo failed. [HitException: {0}] [AppMode: {1}]",c,cf.a[this.ez]),this.fpa(),a=!1)}b&&this.LOe(y,l,null,null,!1);f.dispose();this.Aw();this.kI.updateCommandUI();this.hrf.Uaa();return b}RW(){return this.bCd()?this.E6h.Nsa():null}EUk(a){return this.P4a&&Hg.a.compare(a.guid,this.spb)?(ka.ULS.sendTraceTag(512362002,
365,50,"Incremental Action in progress"),this.MPl(),this.LKd=a.n,this.LKd===this.mof&&(ka.ULS.sendTraceTag(23171274,365,100,"Incremental Action {0} was completed successfully",this.spb),this.yvc()),!0):!1}onBeforeLoadContent(){}onAfterLoadContent(a){if(!this.wCc&&!this.EUk(a.Fi.xx.id))if(this.P4a&&(ka.ULS.sendTraceTag(23171276,365,50,"Incremental action {0} terminated due to inbound revision with ID {1}",this.spb,this.Tz.Fi.xx.id),this.yvc()),!this.Fca.rOb())this.fpa();else if(this.hla||this.XW)this.zUi(),
this.juk()}fpa(a=!1){this.FMc();a?this.hPf(null):(a=new dd.a(2,1,0,this.Nif,50),this.Zd.Hb(a))}loh(a,b){if(b&&(1===(b.iP&1)||2===(b.iP&2))){a=this.hla;const f=this.XW;for(var c=this.Vg.length-1;0<=c;c--){const l=Object(qa.a)(Bh,this.Vg.ga(c).g2);!l||l.Huc!==b&&l.Cwb!==b||(this.Vg.removeAt(c),-1!==this.uh&&this.uh--,-1!==this.xs&&this.xs--)}b=this.hla;c=this.XW;!this.isActive||a===b&&f===c||(ka.ULS.sendTraceTag(36218332,365,15,"UndoRedo status is changed by revision removal:{0},{1},{2},{3}.",a,b,f,
c),this.kI.updateCommandUI())}}hPf(){this.bCd()&&this.MZa(C.a.lVa,this.RW())}dGa(){return this.wCc}Nyh(a){this.kRd=a}}Object(m.a)(aj,"UndoStack",null,[1512,107]);var di=d(812);class Gi extends Sys.EventArgs{constructor(a){super();this.state=a}}Object(m.a)(Gi,"RevisionStateArgs",Sys.EventArgs,[]);class Xj{constructor(a,b,c,f,l,y){this.Xya=a;this.Skb=b;this.H6=c;this.actionId=f;this.ZT=l;this.oLa=y}}Object(m.a)(Xj,"PPTLocalUndoRecord",null,[]);class Qm extends aj{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,
kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye,Xd,Xf,ug,qg,Fg,qf,bg,Kg,rg,ui,Ik,vg,Lg){super(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Fg,vg,4,Lg);this.I$c=!1;this.Qic=-1;this.uM=[];this.FU=Vd;this.nEe=Ld;this.lEe=ye;this.Rb=Xd;this.la=Xf;this.Kna=ug;this.Fa=qg;this.JXa=qf;this.JXa.Hzf(Object(I.a)(this,this.gJb,"onRevisionProcessed"));this.bhb=bg;this.pa=Kg;this.pHe=rg;this.YKg=ui;this.j1g=Ik;this.WMg=Fg.rOb()&&!Fg.M1a()}MZa(a,b,c=!1){let f=!1;b=this.j1g.gQl(b);var l=this.uh;this.nEe.Msl(a)?f=this.xuk(a,
b):this.nEe.dJi(a)?(f=this.twi(a,b,c))&&this.nJl(a):this.fpa();b=null;f?(l=this.uh-l,b=this.S8b(this.uh),this.Z0k(b,!l),this.ncb()||this.J5d()):this.j1g.PQj();l=null;this.la.designerSendActionDuration&&b&&b.g2&&b.g2.h5d!==ha.a.nil&&(l=b.g2.h5d);this.lEe.Lyj(a,f,l);return f}C1d(a,b){const c=0<=this.uh?this.Vg.ga(this.uh):null,f=this.bhb.T7g(b,c,this.v6a,this.Arb);b=this.Quf(a,b,f);this.bhb.s7g(c,b,a);return b}ing(a){let b=!1,c=null;a&&this.XW?c=this.Vg.ga(this.uh):!a&&this.hla&&(c=this.Vg.ga(this.xs));
c&&(b=this.A1c(c.H6));return b&&this.ncb()}ojb(a,b,c,f){let l=!1;if(this.ing(a.Tcb))(l=super.ojb(a,b,c,f))&&this.quk(a.Xla);else{const y=a.Tcb?2:3;l=a.Yih(H=>{this.FU.vOh(H,y)});this.duk(a.Xla);this.JXa.god(new Gi(0))}return l}onBeforeLoadContent(a){super.onBeforeLoadContent(a);this.I$c&&this.JXa.god(new Gi(2))}onAfterLoadContent(a){super.onAfterLoadContent(a);this.I$c&&(this.JXa.god(new Gi(3)),this.I$c=!1)}dispose(){this.JXa.dph(Object(I.a)(this,this.gJb,"onRevisionProcessed"));super.dispose()}LOe(a,
b,c,f,l){a&&a.Xla!=ha.a.nil&&(this.YKg&&(f&&this.HOh(f),b&&this.HOh(b)),0<this.uM.length&&(f=new Xj(this.RW(),b,a.Xla,l?ea.a.S_a:ea.a.R_a,!1,this.WMg),Array.add(this.uM,f)),a.Ure(),b&&0<this.uM.length?b.bV(void 0,c):(Nc.a.Kb&&(Nc.a.Jaa(Nc.a.Kb),Nc.a.Kb.oC(hh.a.LY,Nc.a.sab(a.Xla.toString()).toString())),this.YKg&&(f=Object(qa.a)(136,this.Tz.contentReplicator))&&b&&this.pHe.t4k(f,a.Xla,b,c)))}gJb(a,b){b&&(!(a=b.FD)||2!==a.RevisionSource&&3!==a.RevisionSource||(this.I$c=!0,this.la.nng||(b=2===a.RevisionSource?
Object(qa.a)(1485,this.Vg.ga(0<this.xs?this.xs:this.Vg.length-1).Xya):Object(qa.a)(1485,this.Vg.ga(this.uh).Skb))&&b.kQl(),this.WZi(a.ServerUndoStackLength,a.ServerRedoStackLength,a.LastServerUndoFail,a.LastServerRedoFail),this.JXa.god(new Gi(1))))}WZi(a,b,c,f){a!==this.uh&&xa.a.J(512362001,823,50,"Undo stack length not synced. Server length: {0}, client: {1}",a,this.uh);if(a<this.uh||f){do this.Vg.removeAt(this.uh--);while(this.uh>a);this.xs=0<this.xs?this.uh+1:-1;this.pHe.I8e()}if(!(0>this.xs)&&
(b!==this.Vg.length-this.xs&&xa.a.J(512362E3,823,50,"Redo stack length not synced. Server length: {0}, client: {1}",b,this.Vg.length-this.xs),b<this.Vg.length-this.xs||c)){do this.Vg.removeAt(this.xs);while(this.Vg.length-this.xs>b);if(!b||this.xs>=this.Vg.length)this.xs=-1;this.pHe.I8e()}}HOh(a){(a=Object(qa.a)(1485,a))&&a.$Kl()}CAi(){if(this.la.cBb&&this.uM.length){var a=this.S8b(this.uh);if(a){var b=a.Xya;if(this.A1c(a.H6)){for(let c=this.uh-1;0<c;c--){const f=this.S8b(c);if(!f)break;if(this.A1c(f.H6))b=
f.Xya,this.Vg.removeAt(c),this.uh--;else break}this.ewb()}else this.Vg.add(a),this.uh++,this.xs=-1;a.Xya=b;a.ZT=!1;this.Kpd();this.J5d()}else this.ewb(),this.Kpd()}}R4e(){if(this.la.cBb){var a=this.S8b(this.uh);if(a){if(0<(-1===this.Qic?0:this.Vg.length-this.Qic)){for(var b=this.Vg.length-1;b>=this.Qic;b--)this.Vg.removeAt(b);for(b=0;0<=b&&b<this.uM.length;){var c=b;let f=!0;for(;f&&b<this.uM.length;)b<this.uM.length-1?(f=this.uM[b].ZT&&this.uM[b+1].ZT,b++):(f=!1,b=-1);c=this.uM[c];this.Vg.add(new Fh(c.Xya,
this.uM[0>b?this.uM.length-1:b-1].Skb,a.g2,c.actionId,!1,c.oLa))}this.uh=this.Vg.length-1}this.xs=-1;this.Kpd();this.J5d()}else this.ewb(),this.Kpd()}}get rHj(){if(this.la.cBb&&this.ncb()){const a=this.S8b(this.uh);if(!a||0<this.uM.length&&!this.A1c(a.H6))return!1}return this.XW}J5d(){var a=this.la.nvk;if(this.uh>a){var b=0;for(a=this.uh-a-1;0<=a;a--)this.Vg.removeAt(a),b++;this.uh-=b;b=this.xs-b;this.xs=0<b?b:-1}}twi(a,b,c){const f=0<=this.uh?this.Vg.ga(this.uh):null;this.Arb=!!f&&this.bhb.t3c(a)&&
f.actionId===a&&this.Arb;return super.MZa(a,b,c)}Z0k(a,b){this.la.cBb&&a&&(this.ncb()||this.nEe.eJi(a.actionId))&&(this.uM.length||(this.Qic=this.uh),b&&Array.removeAt(this.uM,this.uM.length-1),Array.add(this.uM,new Xj(a.Xya,a.Skb,a.H6,a.actionId,a.ZT,a.oLa)))}S8b(a){return 0<a&&a<=this.uh?this.Vg.ga(a):null}o$d(a){a=a?this.uh:this.xs;return 0<=a&&a<this.Vg.length?this.Vg.ga(a).g2:null}UUc(a){a=a?this.uh:this.xs;return 0<=a&&a<this.Vg.length?this.Vg.ga(a).actionId:0}Kpd(){Array.clear(this.uM);this.Qic=
-1}ncb(){const a=this.Fa.Ee;return a?a.name!==jb.a.vg&&a.name!==jb.a.eoa&&a.name!==jb.a.iS&&a.name!==jb.a.Mza&&a.name!==jb.a.jP||!this.pa.pz()||this.hUj()?!1:!0:!1}lmb(a){t.ObjectSpace.a4(this.graphSpace.Fi,!1).lmb(a)}nJl(a){this.la.cBb||this.mJl(a);this.lJl(a)}mJl(a){if(1<=this.uh&&this.Xsg(a)){const b=this.uh-1,c=this.Vg.ga(b),f=c.actionId;f!==a&&!this.Xsg(f)||1!==this.Kna.czb(c.H6)||(this.Vg.removeAt(b),this.uh=this.Vg.length-1)}}lJl(a){if(1<=this.uh&&this.LSj(a)){const b=this.uh-1,c=this.Vg.ga(b).actionId;
if(c===a||this.sVj(c))this.Vg.removeAt(b),this.uh=this.Vg.length-1}}Xsg(a){return a===C.a.XB||a===C.a.NCa||a===C.a.tSa||a===C.a.typing||a===C.a.enter}sVj(a){return a===ea.a.n8||a===ea.a.eld}LSj(a){return a===ea.a.jtb||a===ea.a.$nc||a===ea.a.MJb}xuk(a,b){const c=this.C1d(this.Tz.MT(),a);this.ewb();a=new Fh(b,null,c,a,!1,this.WMg);this.Vg.add(a);this.uh=this.Vg.length-1;return!0}quk(a){let b=null;this.pa.Jla()?b=this.pa.Eag():this.pa.pz()&&(b=this.pa.fo());b&&this.JXa.Ykh(new di.a(b,a))}duk(a){const b=
this.Rb.Lc(this.graphSpace);b.Cb(80);Object(qa.a)(482,b.Cq).isDirty=!0;this.JXa.Ykh(new di.a(b.currentNode,a))}X8e(a){0>this.uh||(this.Vg.ga(this.uh).Skb=a)}L1c(){return!this.uM.length}A1c(a){for(const b of this.uM)if(b.H6===a)return!0;return!1}hUj(){for(const a of this.pa.Xd())if(a.eb(zb.a.clearFormatting))return!0;return!1}}Object(m.a)(Qm,"PPTUndoStack",aj,[]);class to{constructor(a){this.jsk=a}BPi(a){const b=this.jsk.yQf(a);return new Qm(a,()=>!!sa.InteractiveViewManager.instance.Rd,new Bb.a(()=>
Rc.App.oS),Ib.a.instance.Ia("Common.Interface.IEditNotificationManager"),bj.a.getInstance(),zh.a.getInstance(),Ib.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),Ib.a.instance.resolve("Box4.IAppFrame"),Ib.a.instance.resolve("Box4.IReplicationScheduler"),Ib.a.instance.resolve("Box4.ISelectionReferenceFactory"),Ib.a.instance.resolve("Common.ITaskManager"),Ib.a.instance.resolve("Box4.ITypingActionOperationFactory"),()=>{},N.a.instance.ga(70),mf.a.instance,b.aMh,b.bMh,b.fMh,new me(Rc.App.JIf),
Ib.a.instance.resolve("PowerPointWebEditor.IRevisionMetadataHelper"),Ib.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoSettings"),Ib.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoActionBehavior"),Ib.a.instance.resolve("Box4.Graph.IGraphIteratorFactory"),Ib.a.instance.resolve("PowerPointWebEditor.IApplicationSettings"),Ib.a.instance.resolve("PowerPointWebEditor.ITextEditingRevisionInfoReader"),Ib.a.instance.resolve("Common.IFocusManager"),Ib.a.instance.resolve("Box4.UndoRedo.IUndoSettingsManager"),
Ib.a.instance.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),Ib.a.instance.resolve("PowerPointWebEditor.ITablePartialEditController"),Ib.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),Ib.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoSelectionRestoreExecutor"),Ib.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").hermesUndoRedoNavigateSlideToRestoreSelectionIsEnabled,Ib.a.instance.resolve("PowerPointWebEditor.UndoRedo.IUndoSelectionUpdater"),
Ib.a.instance.oe("Box4.ICoauthCashTelemetry"),Object(eb.a)("SkipEnablingCascadeUndoIfNotCombiningUndoRecords"))}}Object(m.a)(to,"PPTUndoStackFactory",null,[1483]);class Io{constructor(){this.g7c=new Pc.a}yGl(a){this.g7c.raiseEvent("MU",a)}A_b(a){this.g7c.addHandler("MU",a)}sVe(a){this.g7c.removeHandler("MU",a)}dispose(){this.g7c.dispose()}}Object(m.a)(Io,"UndoEventSource",null,[1480,1481,1482,107]);class Jo{constructor(a,b){this.ihb=0;this.pdd=null;this.ABe=!1;this.Ts=a;this.el=b;this.el.Uyf(Object(I.a)(this,
this.S7g,"onBeforeForceOutboundGraphTransactionInitialize"));this.el.Tyf(Object(I.a)(this,this.Eid,"onForceOutboundGraphTransactionDisposed"))}dispose(){this.el.toh(Object(I.a)(this,this.S7g,"onBeforeForceOutboundGraphTransactionInitialize"));this.el.u7k(Object(I.a)(this,this.Eid,"onForceOutboundGraphTransactionDisposed"))}gQl(a){return 1===this.ihb&&this.pdd?this.pdd:a}PQj(){1===this.ihb&&(this.ABe=!0)}S7g(a,b){this.Zsg(b.transaction.aAa)&&(this.ihb+=1,1===this.ihb&&(this.pdd=this.Ts.RW()))}Eid(a,
b){this.Zsg(b.transaction.aAa)&&(1===this.ihb&&(this.pdd=null,this.ABe||(a=this.Ts.RW(),this.Ts.X8e(a)),this.ABe=!1),--this.ihb)}Zsg(a){return 8===(a&8)}}Object(m.a)(Jo,"UndoSelectionUpdater",null,[1353,107]);var Wl=d(601);class Ko{constructor(a,b,c){this.Tz=a;this.pId=b;this.HQd=c;this.FZ=t.ObjectSpace.Z8(this.Tz.Fi)}ojb(a,b,c){a=this.HQd.YNi(this.pId?a.Huc:b.Cwb,this.pId?b.Cwb:a.Huc,this.FZ,c,Rc.App.LMa);if(b=!!a)this.FZ=a;return b}Yih(a){const b=new qb.a;b.K3e(this.Tz.Fi,this.FZ);a(b);a=b.QSc();
t.ObjectSpace.a4(this.Tz.Fi,!1).lmb(a);this.FZ=a;return!!a}Ure(){const a=new Wl.a(t.ObjectSpace.Z8(this.Tz.Fi),this.FZ);this.Tz.ACb(a)}get Tcb(){return this.pId}get Xla(){return this.FZ.id}}Object(m.a)(Ko,"Box4UndoRedoPerformer",null,[1510]);class Np{constructor(a,b){this.aMh=c=>{c&&this.Tz.Ega();c=t.ObjectSpace.Z8(this.Tz.Fi);return new Bh(c)};this.bMh=c=>new Ko(this.Tz,c,this.HQd);this.fMh=c=>{if(c.e2d&&(this.Tz.MT()&&this.Tz.Ega(),c.e2d&&(c=c.e2d))){var f=t.ObjectSpace.Z8(this.Tz.Fi);c.Cwb=f}};
this.Tz=a;this.HQd=b}}Object(m.a)(Np,"Box4UndoStackDataSyncHelper",null,[1498]);class Lo{constructor(a){this.Q9h=a}yQf(a){return new Np(a,this.Q9h(a.Fi))}}Object(m.a)(Lo,"Box4UndoStackDataSyncHelperFactory",null,[1476]);class jp{constructor(a,b){var c,f;this.TYa=[];this.zHb=null!==(c=null===a||void 0===a?void 0:a.undoOperation)&&void 0!==c?c:null;this.Rcd=null!==(f=null===a||void 0===a?void 0:a.revisionId)&&void 0!==f?f:ha.a.nil;this.TYa=h(null===a||void 0===a?void 0:a.Qab,b);this.hic=b}get H6(){return this.Rcd}get h5d(){return this.Rcd}get lK(){return this.TYa}perform(){try{if(this.zHb){const a=
this.zHb.perform();this.zHb=a.undoOperation;this.TYa=h(a.Qab,this.hic);return a}}catch(a){ka.ULS.sendTraceTag(509097475,844,10,"FluidUndoRecordData.tryPerform exception: {0}.",a)}return null}combineWithPrevious(a){a&&a.zHb&&this.zHb.combineWithPrevious(a.zHb)}dispose(){}}Object(m.a)(jp,"FluidUndoRecordData",null,[1511,107]);class Qq{constructor(a,b){this.ggc=[];this.Ceb=a;this.ukk=b}ojb(a){return a?(a=a.perform(),this.lih(a)):!1}Yih(a){const b=this.Ceb.Fi.eWi.mOc();b.start(this.Ceb.Fi);a(b);a=b.finish();
return this.lih(a)}Ure(){this.ggc.forEach(a=>{this.Ceb.ACb(a)})}get Tcb(){return this.ukk}get Xla(){return 0<this.ggc.length?this.ggc[this.ggc.length-1].Wla:ha.a.nil}lih(a){return a?(a.Qab&&this.ggc.push(...a.Qab),!0):!1}}Object(m.a)(Qq,"FluidUndoRedoPerformer",null,[1510]);class kp{constructor(a){this.aMh=(b,c,f)=>{c=f;b&&(b=this.Ceb.Ega())&&(c=b,f&&(c.Qab.unshift(...f.Qab),c.undoOperation.combineWithPrevious(f.undoOperation)));return new jp(c,this.Ceb.Fi)};this.bMh=b=>new Qq(this.Ceb,b);this.fMh=
()=>{};this.Ceb=a}}Object(m.a)(kp,"FluidUndoStackDataSyncHelper",null,[1498]);class lp{yQf(a){return new kp(a)}}Object(m.a)(lp,"FluidUndoStackDataSyncHelperFactory",null,[1476]);class Op{constructor(a){this.FU=a}KOl(a){this.FU.vOh(a,1);this.FU.UPl(a)}}Object(m.a)(Op,"PPTInverseRevisionUpdater",null,[1397]);class mp{constructor(){this.K=null}get name(){return"PowerPointWebEditor.UndoRedo"}Yb(a){this.K=a;a.register(Oo,"Box4.UndoRedo.UndoSettingsManager").as("Box4.UndoRedo.IUndoSettingsManager").ma();
a.register(co,"Box4.UndoRedo.UndoRevisionValidator").as("Box4.UndoRedo.IUndoRevisionValidator").ma().oa(()=>new co(a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(309,"Box4.ISelectionReferenceFactory").ma().oa(()=>{const b=a.resolve("PowerPointWebEditor.IApplicationSettings");return b.hermesUndoRedoNavigateSlideToRestoreSelectionIsEnabled?new Jc(rn.SelectionReferenceFactory.instance,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.ITableNavigator"),a.resolve("Common.IActionManager"),b.gD,a.resolve("PowerPointWebEditor.ISidUpdater"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),
b.Un):rn.SelectionReferenceFactory.instance});a.register(Ja,"PowerPointWebEditor.UndoRedo.PPTUndoRevisionMergeStrategy").as("Box4.UndoRedo.IUndoRevisionMergeStrategy").ma();a.register(vd,"PowerPointWebEditor.UndoRedo.PPTUndoSettings").as("PowerPointWebEditor.UndoRedo.IPPTUndoSettings").ma();a.resolve("PowerPointWebEditor.IApplicationSettings").GDa?a.register(lp,"PowerPointWebEditor.UndoRedo.FluidUndoStackDataSyncHelperFactory").as("Box4.UndoRedo.IUndoStackDataSyncHelperFactory").ma():a.register(Lo,
"Box4.UndoRedo.Box4UndoStackDataSyncHelperFactory").as("Box4.UndoRedo.IUndoStackDataSyncHelperFactory").ma().oa(()=>new Lo(b=>new Qb(t.ObjectSpace.a4(b,a.resolve("PowerPointWebEditor.IApplicationSettings").GDa),a.resolve("Box4.UndoRedo.IUndoRevisionValidator"),a.resolve("Box4.UndoRedo.IUndoSettingsManager"),new Ga,b,a.resolve("Box4.UndoRedo.IUndoRevisionMergeStrategy"),new Op(a.resolve("PowerPointWebEditor.IRevisionMetadataHelper")))));a.register(to,"PowerPointWebEditor.UndoRedo.PPTUndoStackFactory").as("Box4.UndoRedo.IUndoStackFactory").ma().oa(()=>
new to(a.resolve("Box4.UndoRedo.IUndoStackDataSyncHelperFactory")));a.register(eo,"PowerPointWebEditor.UndoRedo.PPTUndoActionBehavior").as("PowerPointWebEditor.UndoRedo.IPPTUndoActionBehavior").ma().oa(()=>new eo(a.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.UndoRedo.UndoEventSource"),a.resolve("Common.IActionManagerExtended")));a.register(pa,"PowerPointWebEditor.UndoRedo.PPTUndoManager").as("Box4.UndoRedo.UndoManager").as("Box4.IUndoManager").as("PowerPointWebEditor.UndoRedo.IPPTUndoManager").as("Box4.StorageObjectSpace.IUndoRevisionLoadingState").ma().oa(()=>
new pa(a.resolve("Box4.UndoRedo.IUndoStackFactory"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.View.IViewEventHandlers")));a.register(1350,"PowerPointWebEditor.UndoRedo.IPPTUndoSelectionRestoreExecutor").ma().oa(()=>new Vc);a.register(Io,"PowerPointWebEditor.UndoRedo.UndoEventSource").as("PowerPointWebEditor.UndoRedo.IUndoEventSource").as("PowerPointWebEditor.UndoRedo.IUndoEventNotifier").as("PowerPointWebEditor.UndoRedo.IUndoEventHandlers").ma();this.bGi(a);
this.fGi(a);a.register(1351,"PowerPointWebEditor.IGroupUngroupUndoRedoActionController").ma().oa(()=>new tn(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper")))}bGi(a){a.register(1352,"PowerPointWebEditor.ITablePartialEditController").ma().oa(()=>{const b=a.resolve("PowerPointWebEditor.IApplicationSettings");
return b.v4j?new un(a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ITextEditingRevisionInfoTracker"),a.resolve("Box4.IWorkspace"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),b.cBb):new Gk})}fGi(a){a.register(1353,"PowerPointWebEditor.UndoRedo.IUndoSelectionUpdater").ma().oa(()=>new Jo(a.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers")))}init(){const a=
this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager");var b=this.K.resolve("Box4.IPageView");b.Ag&&(b=b.Ag.Vo(),a.register(b),a.setActive(b),a.MZa(C.a.lVa,null))}dispose(){this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager").dispose();this.K.resolve("PowerPointWebEditor.UndoRedo.IUndoSelectionUpdater").dispose()}static main(){n.a.instance.Ac(new mp)}}Object(m.a)(mp,"PPTWebEditorUndoRedoPackage",null,[2,3]);class En{constructor(a=!1,b,c=!1,f=!1,l=!1,y=!1,H=!1){this.SVa=a;this.uoe=
c;this.bbb=f;this.Lac=l;this.Qac=y;this.e1c=H}}Object(m.a)(En,"DocModeSwitcherData",null,[]);var ri=d(865);class Zi{constructor(a,b,c,f,l){this.DEb=!1;this.EEe=null;this.bHd=this.tId=this.CHd=this.MHd=this.FHd=this.$Hd=this.vHd=this.dId=this.gBa=this.lHd=this.sHd=this.JHd=this.hHd=this.BHd=this.zjf=!1;this.pc=a;this.ul=b;this.Mc=c;this.Vv=l;this.CHg=f.OXj;this.Wva=f.pptOnlineFallbackToReadOnlyAfterBootEnabled;this.gfb=f.frg;this.Pok=w.AFrameworkApplication.jA;this.reset()}initialize(){this.Mc.i8(Object(I.a)(this,
this.Sw,"onUnifiedAppStateChanged"));this.Mc.IQa(Object(I.a)(this,this.Qmc,"onOutboundReplication"));this.EEe=[Object(I.a)(this,this.pzi,"checkIsInlineRepairedDocument"),Object(I.a)(this,this.mzi,"checkIrmProtection"),Object(I.a)(this,this.Tzi,"checkUserPermission"),Object(I.a)(this,this.Oyi,"checkFileFormats"),Object(I.a)(this,this.Pyi,"checkFileLock"),Object(I.a)(this,this.zzi,"checkPasswordProtection"),Object(I.a)(this,this.Ryi,"checkFontRestriction"),Object(I.a)(this,this.qzi,"checkIsMarkedFinal"),
Object(I.a)(this,this.rzi,"checkIsMarkedReadOnlyRecommended"),Object(I.a)(this,this.Ezi,"checkSessionRestriction"),Object(I.a)(this,this.Dzi,"checkSessionAccessTokenExpired"),Object(I.a)(this,this.wzi,"checkNetworkIssueHappened"),Object(I.a)(this,this.Azi,"checkPopsHostIssueHappened"),Object(I.a)(this,this.$zi,"checkWopiAccessTokenOutOfRefreshRange"),Object(I.a)(this,this.ozi,"checkIsEmergencyViewMode")];this.Tsh(this.EEe)}dispose(){this.Mc.hkb(Object(I.a)(this,this.Sw,"onUnifiedAppStateChanged"))}reset(){this.bHd=
this.sHd=this.tId=this.CHd=this.MHd=this.FHd=this.$Hd=this.vHd=this.dId=this.lHd=this.JHd=this.gBa=this.hHd=this.BHd=this.zjf=!1}Sw(a,b){xa.a.J(22930964,809,50,"ReadOnlyUIManager::OnUnifiedAppStateChanged");this.reset();b.$bb&&this.pc.Pn||(this.ul.gUf(),this.Tsh(this.EEe))}Qmc(){this.Wva&&!this.DEb&&(this.DEb=!0);this.pc.VL||xa.a.J(38633602,801,15,"Outbound on RO mode")}Tsh(a){if(a)for(const b of a)if(b())break}Oyi(){if(this.AWj||!this.pc.hg(64)||this.CHg&&!(this.pc.hg(4)&&this.pc.hg(16)&&this.pc.hg(8)))return!0;
if(!this.pc.getState(64))return!1;if(this.CHg&&this.pc.getState(4)&&!this.pc.getState(16)&&!this.pc.getState(8)){var a=w.AFrameworkApplication.Ra.Ka(ea.a.TDa,2,Object.assign(new En,{e1c:!0,bbb:this.pc.getState(1)}));xa.a.J(577524062,809,50,"ReadOnlyUIManager::CheckFileFormats - callout display (FormatConvertible)"+a.toString());this.ul.rL(10);xa.a.J(24142428,809,50,"ReadOnlyUIManager::CheckFileFormats - business bar displayed (FormatConvertible)")}else a=w.AFrameworkApplication.Ra.Ka(ea.a.TDa,2,Object.assign(new En,
{Qac:!0,bbb:this.pc.getState(1)})),xa.a.J(578351494,809,50,"ReadOnlyUIManager::CheckFileFormats - callout display (FormatNotEditable)"+a.toString());return this.hHd=!0}mzi(){return this.OYj||!this.pc.hg(32768)?!0:this.pc.getState(32768)?(this.ul.rL(14),this.vHd=!0,xa.a.J(24761164,809,50,"ReadOnlyUIManager::CheckIrmProtection - business bar displayed for FileIrmProtected"),!0):!1}Pyi(){return this.CWj?!0:this.pc.hg(128)&&this.pc.getState(128)?(this.ul.rL(3),this.gBa=!0,xa.a.J(24761166,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for PptEditCheckedOutByAnother"),
!0):this.pc.hg(256)&&this.pc.getState(256)?(this.ul.rL(4),this.gBa=!0,xa.a.J(24761168,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for RequiresCheckout"),!0):this.pc.hg(512)&&this.pc.getState(512)?(this.ul.rL(5),this.gBa=!0,xa.a.J(24761170,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for LockedForOfflineCheckout"),!0):this.pc.hg(1024)&&this.pc.getState(1024)?(this.ul.rL(6),this.gBa=!0,xa.a.J(24761172,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for CannotAcquirePptEditLock"),
!0):this.pc.hg(2048)&&this.pc.getState(2048)?(this.ul.rL(7),this.gBa=!0,xa.a.J(24761174,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for CannotAcquirePptEditSharedLock"),!0):this.pc.hg(4096)&&this.pc.getState(4096)?(this.ul.rL(8),this.gBa=!0,xa.a.J(24761176,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for NumberOfCoauthorsReachedMax"),!0):this.pc.hg(8192)&&this.pc.getState(8192)?(this.ul.rL(9),this.gBa=!0,xa.a.J(24761178,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for PptEditExistingExclusiveLock"),
!0):!1}qzi(){if(this.zZj||!this.pc.hg(2)||!this.pc.hg(16))return!0;if(!this.pc.getState(2)&&this.pc.getState(16)){const a=w.AFrameworkApplication.Ra.Ka(ea.a.TDa,2,Object.assign(new En,{SVa:!0,bbb:this.pc.getState(1)}));xa.a.J(578351455,809,50,"ReadOnlyUIManager::CheckIsMarkedFinal - Callout display "+a.toString());return this.BHd=!0}return!1}rzi(){if(!this.gfb)return!1;if(this.AZj||!this.pc.hg(2)||!this.pc.hg(524288))return!0;if(!this.pc.getState(2)&&this.pc.getState(524288)){const a=w.AFrameworkApplication.Ra.Ka(ea.a.TDa,
2,Object.assign(new En,{uoe:!0,bbb:this.pc.getState(1)}));xa.a.J(578351452,809,50,"ReadOnlyUIManager::CheckIsMarkedReadOnlyRecommended - Callout displayed "+a.toString());return this.CHd=!0}return!1}zzi(){if(this.m0j||!this.pc.hg(2)||!this.pc.hg(32))return!0;if(!this.pc.getState(2)&&this.pc.getState(32)){const a=w.AFrameworkApplication.Ra.Ka(ea.a.TDa,2,Object.assign(new En,{Lac:!0,bbb:this.pc.getState(1)}));xa.a.J(578351449,809,50,"ReadOnlyUIManager::CheckPasswordProtection - Callout display "+a.toString());
return this.JHd=!0}return!1}pzi(){return this.tYj||!this.pc.hg(2097152)?!0:this.pc.getState(2097152)?(this.ul.rL(22),this.sHd=!0,xa.a.J(42824021,809,50,"ReadOnlyUIManager:: - Inline repaired document business bar displayed"),!0):!1}ozi(){var a=!1;if(this.dWj||!this.pc.hg(4194304))return!0;this.pc.getState(4194304)&&(a="NotAvailable",this.Vv&&(a=this.Vv.cyb(),a=ri.a[a]),$d.Health.instance.recordQosError("EmergencyViewModeEnabledReason"+a,["ViewByDefault"],!0,!0,!1,!1,null),32===w.AFrameworkApplication.Ra.processAction(ea.a.Yuc,
1)?(a=w.AFrameworkApplication.Ra.processAction(ea.a.Yuc,2),xa.a.J(578351445,809,15,"ReadOnlyUIManager:: EmergencyViewMode Emergency View Mode displayed in Doc Mode Switcher "+a.toString())):(this.ul.rL(23),xa.a.J(593295554,809,15,"ReadOnlyUIManager:: EmergencyViewMode business bar displayed")),this.bHd=a=!0);return a}Ryi(){return!this.$Wj&&this.pc.hg(2)&&this.pc.hg(8)?!this.pc.getState(2)&&this.pc.getState(8)?(this.ul.rL(12),this.lHd=!0,xa.a.J(24142434,809,50,"ReadOnlyUIManager::CheckFontRestriction - business bar displayed"),
!0):!1:!0}Tzi(){if(this.NVj||!this.pc.hg(1))return!0;if(!this.pc.getState(1)){const a=w.AFrameworkApplication.Ra.Ka(ea.a.TDa,2,new En);xa.a.J(578351441,809,50,"ReadOnlyUIManager::CheckUserPermission - Callout display "+a.toString());return!0}return!1}Ezi(){return this.W2j?!0:this.pc.hg(16384)&&this.pc.getState(16384)?(this.ul.rL(13),this.dId=!0,xa.a.J(24761184,809,50,"ReadOnlyUIManager::CheckSessionRestriction - business bar displayed"),!0):!1}Dzi(){return this.U2j?!0:this.pc.hg(65536)&&this.pc.getState(65536)?
($d.Health.instance.recordQosError("SessionAccessTokenExpired",["SessionExpired"],!1,!1,!0,!0,null),this.Wva?this.ul.lQc(15,this.DEb):this.ul.rL(15),this.$Hd=!0,xa.a.J(37066185,809,50,"ReadOnlyUIManager::CheckSessionAccessTokenExpired - business bar displayed"),!0):!1}Azi(){return this.O0j?!0:this.pc.hg(262144)&&this.pc.getState(262144)&&this.Wva?(this.ul.lQc(17,this.DEb),this.MHd=!0,xa.a.J(37310543,809,50,"ReadOnlyUIManager::CheckPopsHostIssueHappened - business bar displayed"),!0):!1}$zi(){return this.m6j?
!0:this.pc.hg(1048576)&&this.pc.getState(1048576)&&this.Wva&&this.Pok?(this.ul.lQc(21,this.DEb),this.tId=!0,xa.a.J(39327011,809,50,"ReadOnlyUIManager::CheckWopiAccessTokenOutOfRefreshRange - business bar displayed"),!0):!1}wzi(){return this.VZj?!0:this.pc.hg(131072)&&this.pc.getState(131072)&&this.Wva?(this.ul.lQc(16,this.DEb),this.FHd=!0,xa.a.J(37310545,809,50,"ReadOnlyUIManager::CheckNetworkIssueHappened - business bar displayed"),!0):!1}get NVj(){return this.zjf}get zZj(){return this.BHd}get AWj(){return this.hHd}get m0j(){return this.JHd}get tYj(){return this.sHd}get $Wj(){return this.lHd}get CWj(){return this.gBa}get W2j(){return this.dId}get OYj(){return this.vHd}get U2j(){return this.$Hd}get VZj(){return this.FHd}get O0j(){return this.MHd}get AZj(){return this.CHd}get m6j(){return this.tId}get dWj(){return this.bHd}}
Object(m.a)(Zi,"ReadOnlyUIManager",null,[1363,107]);class Ln{constructor(a,b,c,f){this.DHg=!1;this.Sw=()=>{xa.a.J(509367064,809,50,"FilterPrivacyUIManager::OnUnifiedAppStateChanged");this.qUf()};this.EWj=()=>!this.Jb.ka("FilterPrivacyBusinessBarEnabled")||this.DHg?!1:this.pc.hg(16777216)?this.pc.getState(16777216):(xa.a.J(509367063,809,50,"FilterPrivacyUIManager::IsFilterPrivacyEnabled - business bar not displayed, filterPrivacyEnabled field not ready"),!1);this.qUf=()=>{this.EWj()&&(this.ul.rL(27),
this.DHg=!0,xa.a.J(509366796,809,15,"FilterPrivacyUIManager::DisplayFilterPrivacyBusinessBar - business bar displayed"))};if(!f)throw Error.argumentNull("appSettingsManager");this.pc=a;this.ul=b;this.Mc=c;this.Jb=f}initialize(){this.Mc.i8(this.Sw);this.qUf()}dispose(){this.Mc.hkb(this.Sw)}}Object(m.a)(Ln,"FilterPrivacyUIManager",null,[1364,107]);class us{constructor(){this.Vye=this.hjc=this.K=null}get name(){return"PowerPointWebEditor.UnifiedApp"}Yb(a){this.K=a;this.K.register(1363,"PowerPointWebEditor.UnifiedApp.IReadOnlyUIManager").ma().oa(()=>
new Zi(this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Application.IReadOnlyManager")));this.K.register(1364,"PowerPointWebEditor.UnifiedApp.IFilterPrivacyUIManager").ma().oa(()=>new Ln(this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),
this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("Common.IAppSettingsManager")))}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").YFa&&(this.hjc=this.K.resolve("PowerPointWebEditor.UnifiedApp.IReadOnlyUIManager"),this.Vye=this.K.resolve("PowerPointWebEditor.UnifiedApp.IFilterPrivacyUIManager"),this.hjc.initialize(),this.Vye.initialize())}dispose(){this.hjc&&this.hjc.dispose();this.hjc&&this.Vye.dispose()}static main(){n.a.instance.Ac(new us)}}Object(m.a)(us,
"PPTWebEditorUnifiedAppPackage",null,[2,3]);var qh=d(274);class Cr{constructor(a,b,c,f){this.Gb=a;this.rr=b;this.QE=c;this.$va=f}Lka(){const a=new Jd.a;a.$(0,Object(I.a)(this,this.tableBorderAndResizeHandlesClickHandler,"tableBorderAndResizeHandlesClickHandler"));a.$(1,Object(I.a)(this,this.pptTableColumnHandleClickHandler,"pptTableColumnHandleClickHandler"));a.$(2,Object(I.a)(this,this.pptTableRowHandleClickHandler,"pptTableRowHandleClickHandler"));a.$(3,Object(I.a)(this,this.backgroundClickHandler,
"backgroundClickHandler"));a.$(4,Object(I.a)(this,this.shapeClickHandler,"shapeClickHandler"));return a}tableBorderAndResizeHandlesClickHandler(a){return this.rr.E4(a.Bc)||this.rr.nWa(a.Bc)||this.rr.h3c(a.Bc)?(this.Gb.Gwb(),qh.a.gm(!0)):qh.a.notHandled}pptTableColumnHandleClickHandler(a){if(this.rr.jva(a.Bc)){const b=this.rr.Bde(a.Bc);if(!b||!b.Ok)return xa.a.J(22577752,822,15,"Clicked on a table column handle but failed to get a ShapeViewElement."),qh.a.gm(!1);b.Ok.hq||this.rr.cNc(a.Bc,a.tV,a.Bj.ng);
return qh.a.gm(!0)}return qh.a.notHandled}pptTableRowHandleClickHandler(a){if(this.rr.wcc(a.Bc)){const b=this.rr.Bde(a.Bc);if(!b||!b.Ok)return xa.a.J(41209868,822,15,"Clicked on a table row handle but failed to get a ShapeViewElement."),qh.a.gm(!1);b.Ok.hq||this.rr.kdl(a.Bc,a.tV,a.Bj.ng);return qh.a.gm(!0)}return qh.a.notHandled}backgroundClickHandler(a){return this.Gb.lcc(a)?(this.$va.setVisibility(!1),qh.a.gm(!0)):qh.a.notHandled}shapeClickHandler(a){let b=qh.a.notHandled;this.QE.ecc||(b=this.QE.s0e(a));
this.QE.ecc=!1;if((a=this.QE.Rxb(a))&&!a.pO||a&&a.shapeNode&&a.shapeNode.vd&&a.pO)return qh.a.gm(!0);this.$va.setVisibility(!1);return b}}Object(m.a)(Cr,"ClickHandlers",null,[]);var sp=d(429),Ro=d(434);class tp{constructor(a,b,c,f,l,y){this.Gb=a;this.pa=b;this.Fa=c;this.ia=f;this.QE=l;this.eGb=y}Lka(){const a=new Jd.a;a.$(0,Object(I.a)(this,this.noContextMenuHandler,"noContextMenuHandler"));a.$(1,Object(I.a)(this,this.slideBackgroundContextMenuHandler,"slideBackgroundContextMenuHandler"));a.$(2,Object(I.a)(this,
this.shapeContextMenuHandler,"shapeContextMenuHandler"));return a}noContextMenuHandler(a){return this.Gb.cBh(a)?sp.a.notHandled:sp.a.gm(null)}slideBackgroundContextMenuHandler(a){return this.Gb.lcc(a)?(this.pa.au(),this.pa.nh(),this.Fa.Bd(),this.ia.Ka(ea.a.K_d,2,a.Bj),sp.a.gm(null)):sp.a.notHandled}shapeContextMenuHandler(a){var b=this.QE.Rxb(a);if(this.Vtl(b,a))b.hEa(),this.eGb?b.ry||this.ia.Ka(ea.a.hRa,2,new Ro.a(b.shapeNode,!0,a.Bj)):this.ia.Ka(ea.a.hRa,2,new Ro.a(b.shapeNode,!0,a.Bj));else if(this.Stl(b))return this.pa.au(),
(b=this.QE.Rrj(b,a))&&this.pa.selectShape(b,!0),this.Fa.Bd(),this.ia.Ka(ea.a.J_d,2,a.Bj),sp.a.gm(null);return sp.a.notHandled}Vtl(a,b){return!!a&&!!a.shapeNode&&a.shapeNode.isConnected&&a.shapeNode.Lsg&&!a.EAb(b.Bj)}Stl(a){return!!a||this.pa.rH()||!this.pa.Pa.length}}Object(m.a)(tp,"ContextMenuClickHandlers",null,[]);class kq{constructor(a,b,c,f,l){this.Gb=a;this.rr=b;this.QE=c;this.ia=f;this.Xgc=l}Lka(){const a=new Jd.a;a.$(0,Object(I.a)(this,this.tableBorderAndHandlesDoubleClickHandler,"tableBorderAndHandlesDoubleClickHandler"));
a.$(1,Object(I.a)(this,this.shapeDoubleClickHandler,"shapeDoubleClickHandler"));a.$(2,Object(I.a)(this,this.backgroundDoubleClickHandler,"backgroundDoubleClickHandler"));return a}tableBorderAndHandlesDoubleClickHandler(a){return this.rr.E4(a.Bc)||this.rr.nWa(a.Bc)||this.rr.h3c(a.Bc)?(this.Gb.Gwb(),qh.a.gm(!0)):this.rr.jva(a.Bc)||this.rr.wcc(a.Bc)?(this.Gb.Gwb(),qh.a.gm(!1)):qh.a.notHandled}shapeDoubleClickHandler(a){return this.QE.Rxb(a)?(this.Gb.Gwb(),qh.a.gm(!1)):qh.a.notHandled}backgroundDoubleClickHandler(a){return this.Gb.lcc(a)?
(this.Gb.Gwb(),this.Xgc||this.ia.processAction(ea.a.IFa,2,{DoubleClickInsert:"true"}),qh.a.gm(!0)):qh.a.notHandled}}Object(m.a)(kq,"DoubleClickHandlers",null,[]);class Sq{constructor(a,b,c,f,l){this.QE=a;this.xD=b;this.ia=c;this.Ga=f;this.FO=l}p9f(){return Object(I.a)(this,this.Agd,"mouseUpHandlerFilter")}Agd(a){return a?(a=this.xD.tce(a.Bc))&&a.gb&&this.Ga.vn(a.gb)&&this.FO.rWa&&this.QE.e1e?(this.ia.processAction(C.a.Aka,2),!0):this.QE.e1e=!1:!1}}Object(m.a)(Sq,"MouseInputHandlers",null,[]);var fm=
d(276);class lq{constructor(a,b,c,f){this.QE=a;this.Vb=b;this.N0=c;this.De=f}Lka(){const a=new Jd.a;a.$(0,Object(I.a)(this,this.backgroundPointerDownHandler,"backgroundPointerDownHandler"));a.$(1,Object(I.a)(this,this.shapePointerDownHandler,"shapePointerDownHandler"));a.$(2,Object(I.a)(this,this.defaultPointerDownHandler,"defaultPointerDownHandler"));return a}backgroundPointerDownHandler(a){this.HKl();return this.QE.fEf(a)}HKl(){this.De.ime()||Nc.a.c6d("ScrollActiveThumbnailIntoView",ea.a.Lkb,()=>
{this.De.Rqd();return 32})}shapePointerDownHandler(a){this.Vb.jX&&this.N0.show(3,-1);const b=this.QE.Rxb(a);if(b&&b.shapeNode&&b.shapeNode.Wf&&!b.shapeNode.Ug)return qh.a.gm(!1);if((Sys.UI.DomElement.containsCssClass(a.Bc,fm.a.kza)||Sys.UI.DomElement.containsCssClass(a.Bc,fm.a.nOb)||Sys.UI.DomElement.containsCssClass(a.Bc,fm.a.y0e)||Sys.UI.DomElement.containsCssClass(a.Bc,fm.a.Ovd)||Sys.UI.DomElement.containsCssClass(a.Bc,fm.a.iHh)||Sys.UI.DomElement.containsCssClass(a.Bc,fm.a.wHh))&&b.isSelected&&
!b.pO||void 0!==b&&null!==b&&b.shapeNode.pp)return this.QE.ecc=!1,qh.a.gm(!0);this.QE.ecc=!0;a=this.QE.s0e(a);a.j4&&(this.QE.e1e=!0);return a}defaultPointerDownHandler(){return qh.a.gm(!0)}}Object(m.a)(lq,"PointerDownHandlers",null,[]);class Tq{constructor(a){this.QE=a}Lka(){const a=new Jd.a;a.$(0,Object(I.a)(this,this.backgroundPointerUpHandler,"backgroundPointerUpHandler"));a.$(1,Object(I.a)(this,this.shapePointerUpHandler,"shapePointerUpHandler"));a.$(1,Object(I.a)(this,this.shapePointerUpHandler,
"shapePointerUpHandler"));a.$(2,Object(I.a)(this,this.defaultPointerUpHandler,"defaultPointerUpHandler"));return a}backgroundPointerUpHandler(a){return this.QE.fEf(a)}shapePointerUpHandler(a){const b=this.QE.Rxb(a);return b&&b.shapeNode&&b.shapeNode.Wf&&!b.shapeNode.Ug?qh.a.gm(!1):this.QE.s0e(a)}defaultPointerUpHandler(){return qh.a.gm(!0)}}Object(m.a)(Tq,"PointerUpHandlers",null,[]);class Rp extends Sys.EventArgs{constructor(){super()}}Object(m.a)(Rp,"SlideBackgroundClickedEventArgs",Sys.EventArgs,
[]);class fo{constructor(a,b,c,f,l,y,H,Q){this.Gb=a;this.rr=b;this.pa=c;this.$va=f;this.Fa=l;this.WJ=y;this.Bna=H;this.Ga=Q;this.e1e=this.ecc=!1}fEf(a){return this.Gb.lcc(a)?(this.pa.au(),a=a.Bj,this.WJ.Nkh(new Rp(!1)),(a.ctrlKey||a.shiftKey)&&a.LA===Sys.UI.MouseButton.leftButton?this.pa.kj():this.pa.nh(),this.$va.setVisibility(!1),this.Fa.Bd(),qh.a.gm(!0)):qh.a.notHandled}s0e(a){const b=this.Rxb(a);b&&this.pa.au();const c=Sys.UI.DomElement.containsCssClass(a.Bc,fm.a.kza)||Sys.UI.DomElement.containsCssClass(a.Bc,
fm.a.nOb)||Sys.UI.DomElement.containsCssClass(a.Bc,fm.a.y0e),f=this.rr.h3c(a.Bc)||this.rr.E4(a.Bc)||this.rr.nWa(a.Bc);Nc.a.Ak("isEventFromHandlers",c.toString());Nc.a.Ak("isEventFromTableHandlers",f.toString());return c&&!f&&b&&b.pO?(this.pa.kj(),this.$va.setVisibility(!1),this.Fa.Bd(),qh.a.gm(!0)):f&&b&&!b.pO?(b.O7g(a.Bj),qh.a.gm(!0)):!b||b.pO&&!this.mme(a)?qh.a.notHandled:(b.vHk(a.Bj),qh.a.gm(!0))}Rxb(a){let b=this.rr.$I(a.Bc);if(!b){var c=a.Bc,f=Hb.a(c,va.a.role);f=f?f.toString()===Ve.a.o0b:!1;
if(Sys.UI.DomElement.containsCssClass(c,"ListMarker")||f)for(;!b&&c;){b=this.rr.$I(c);if(Sys.UI.DomElement.containsCssClass(c,"Outline")&&Sys.UI.DomElement.containsCssClass(c,"OutlineSized"))break;c=c.parentNode}}if(b){c=Object(qa.a)(119,b);if(!c&&(this.rr.h3c(a.Bc)||this.rr.E4(a.Bc)||this.rr.nWa(a.Bc))&&(c=this.Bna.n7b(this.Ga.vn(b.gb)),!c))return xa.a.J(39322434,822,15,"Clicked on a table resize handle but failed to get its ContainerShapeViewElement."),null;if(c||(c=this.Bna.n7b(this.Ga.vn(b.gb)))&&
c.CB&&!(c.ry||c.hq||c.sqe))return c}return null}mme(a){return a&&a.Bc?a.Bc.id.startsWith(se.a.D7a):!1}Rrj(a,b){return a?this.Qrj(a):this.Prj(b.graphNode)}Qrj(a){let b=null;a.isSelected&&this.pa.rH()||(b=Object(qa.a)(4,a.gb));return b}Prj(a){let b=null;if(a){const c=ob.GraphIterator.pb(a);c.sc(10)?(a=Object(qa.a)(4,c.Kg(10)),this.pa.mX(a)||(b=a)):xa.a.J(22577757,808,15,"Unexpected type of graph node gets clicked, type: {0}, Id {1}",a.type,a.id)}return b}}Object(m.a)(fo,"ViewEventHandlerHelper",null,
[1398]);class Dr{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ViewEventHandler"}Yb(a){this.K=a;a.register(Cr,"PowerPointWebEditor.ViewEventHandler.ClickHandlers").ma().oa(()=>new Cr(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IViewElementHelper"),a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Box4.IGrippersManager")));a.register(kq,"PowerPointWebEditor.ViewEventHandler.DoubleClickHandlers").ma().oa(()=>
new kq(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IViewElementHelper"),a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Common.IActionManager"),a.resolve("PowerPointWebEditor.IApplicationSettings").kAb));a.register(tp,"PowerPointWebEditor.ViewEventHandler.ContextMenuClickHandlers").ma().oa(()=>new tp(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),
a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptContextMenuCrashFix));a.register(lq,"PowerPointWebEditor.ViewEventHandler.PointerDownHandlers").ma().oa(()=>new lq(a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Box4.IAppFrame"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView")));
a.register(Tq,"PowerPointWebEditor.ViewEventHandler.PointerUpHandlers").ma().oa(()=>new Tq(a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Box4.IAppFrame"),a.resolve("PowerPointWebEditor.IOfflineModalCallout")));a.register(Sq,"PowerPointWebEditor.ViewEventHandler.MouseInputHandlers").ma().oa(()=>new Sq(a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext")));a.register(fo,"PowerPointWebEditor.ViewEventHandler.ViewEventHandlerHelper").as("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper").ma().oa(()=>new fo(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IViewElementHelper"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Box4.IGrippersManager"),a.resolve("PowerPointWebEditor.IFocusManager"),
a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.View.IShapeViewHelper"),a.resolve("PowerPointWebEditor.IShapeReader")))}init(){const a=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");a.Xai(this.K.resolve("PowerPointWebEditor.ViewEventHandler.ClickHandlers").Lka());a.Jbi(this.K.resolve("PowerPointWebEditor.ViewEventHandler.DoubleClickHandlers").Lka());a.xbi(this.K.resolve("PowerPointWebEditor.ViewEventHandler.ContextMenuClickHandlers").Lka());
a.hdi(this.K.resolve("PowerPointWebEditor.ViewEventHandler.PointerDownHandlers").Lka());a.kdi(this.K.resolve("PowerPointWebEditor.ViewEventHandler.PointerUpHandlers").Lka());this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled&&this.K.resolve("Common.MouseInputManager").rb(oa.a.YJ,a.container,this.K.resolve("PowerPointWebEditor.ViewEventHandler.MouseInputHandlers").p9f())}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled&&
this.K.resolve("Common.MouseInputManager").Bb(oa.a.YJ,this.K.resolve("PowerPointWebEditor.View.IPPTPageView").container,this.K.resolve("PowerPointWebEditor.ViewEventHandler.MouseInputHandlers").p9f())}static main(){n.a.instance.Ac(new Dr)}}Object(m.a)(Dr,"PPTWebEditorViewEventHandlerPackage",null,[2,3]);var yg=d(81),Er;(function(a){a[a.notLoaded=1]="notLoaded";a[a.loaded=2]="loaded";a[a.failed=3]="failed"})(Er||(Er={}));Object(m.b)("WebSocketCompressionHelperLoadState",Er);var Mj=d(89),Uq=d(312),
Jl;(function(a){a[a.connecting=0]="connecting";a[a.open=1]="open";a[a.closing=2]="closing";a[a.closed=3]="closed"})(Jl||(Jl={}));Object(m.b)("WebSocketState",Jl);class vs{constructor(a,b,c,f,l){this.yic=this.Zl=this.EHb=null;this.zIa=-1;this.ufb=this.vma=0;this.Cec=-1;this.eFb=0;this.fFb=null;this.kXa=0;if(!a)throw Error.argumentNull("webSocketClient");this.Yv=a;this.Ya=b;this.OE=c;this.Mc=f;a=document.createElement("a");a.href=this.Yv.AUl;a.protocol="http:"===a.protocol?"ws":"wss";eb.a("PodsWebSocketFrontDoor.UseQueryString")?
(a=new Jh.QueryStringBuilder(a.href),eb.a("PodsWebSocketFrontDoor.UseWacClusterQueryString")&&a.jg(Dh.a.meh,b.Ek),eb.a("PodsWebSocketFrontDoor.UseUsidQueryString")&&a.jg(Dh.a.$Lk,w.AFrameworkApplication.userSessionId),a.jg(Dh.a.Wnc,l.toString()),this.EHb=a.toString()):this.EHb=a.href;this.yfb=yg.a.wB(this.EHb);this.C2b(2);this.vna=this.Yv.Urh;this.Cue=this.Yv.kCi;this.q0e();this.Mc.CCa(Object(I.a)(this,this.tib,"onSessionEnding"));this.Mc.HC(Object(I.a)(this,this.Mo,"onSessionRehydrated"))}dispose(){this.Mc.gpd(Object(I.a)(this,
this.tib,"onSessionEnding"));this.Mc.zga(Object(I.a)(this,this.Mo,"onSessionRehydrated"))}C2b(a){this.Zl&&this.Zl.close();this.Zl=new WebSocket(this.EHb,[]);this.Zl.onopen=Object(I.a)(this,this.onOpen,"onOpen");this.Zl.onerror=Object(I.a)(this,this.onError,"onError");this.Zl.onclose=Object(I.a)(this,this.onClose,"onClose");this.Zl.onmessage=Object(I.a)(this,this.onMessage,"onMessage");this.kXa=a;xa.a.J(556541794,this.Yv.$Q,50,"WebSocketFetcher::ConnectWebSocket - WebSocket connected WebSocketDomain:{0}, WacCluster:{1}, ConnectionReason:{2}",
this.yfb,this.Ya.Ek,this.kXa)}ping(){if(this.Zl)if(1===this.Zl.readyState){const a=this.Yv.rNi();this.Zl.send(a)}else xa.a.J(559284698,this.Yv.$Q,10,"WebSocketFetcher::Ping. Wrong WebSocket state {0}",this.Zl.readyState),this.Lya(4);else xa.a.J(559284697,this.Yv.$Q,50,"WebSocketFetcher::Ping Websocket is unavailable.")}rCi(){this.Zl.close()}onOpen(){xa.a.J(591208995,this.Yv.$Q,50,"WebSocketFetcher::OnOpen WebSocketDomain:{0}, WacCluster:{1}",this.yfb,this.Ya.Ek);this.xrc();this.eFb=0;this.fFb=null;
this.Yv.UBk()}onError(a){xa.a.J(591208993,this.Yv.$Q,10,"WebSocketFetcher::OnError {0}, WebSocketDomain:{1}, WacCluster:{2}",JSON.stringify(a),this.yfb,this.Ya.Ek)}onClose(a){xa.a.J(591208991,this.Yv.$Q,50,"WebSocketFetcher::OnClose WebSocketDomain:{0}, WacCluster:{1}, EventInfo:{2}, CloseEventCode:{3}, CloseEventReason:{4}",this.yfb,this.Ya.Ek,JSON.stringify(a),a.code,a.reason);this.eFb=a.code;this.fFb=a.reason}onMessage(a){try{a&&a.data&&this.Yv.VEk(a)}catch(b){xa.a.J(559284699,this.Yv.$Q,10,"WebSocketFetcher::OnMessage",
b.toString())}}q0e(){this.yic=()=>{"visible"===window.document.visibilityState?(window.clearTimeout(this.Cec),this.Zl||(xa.a.J(559284700,this.Yv.$Q,50,"WebSocketFetcher::PageVisibilityEventHandler Reconnecting after visibility regained."),this.Lya(1))):this.Cec=window.setTimeout(()=>{this.Zl&&(xa.a.J(559284701,this.Yv.$Q,50,"WebSocketFetcher::PageVisibilityEventHandler Closing due to visibility lost."),this.eFb=1E3,this.fFb="Lost visibility",this.Zl.close(this.eFb,this.fFb),this.Zl=null,window.clearTimeout(this.zIa))},
this.Cue)};window.self.addEventListener("visibilitychange",this.yic)}xrc(){this.vma=0}$Td(){0<this.Yv.ngd&&(new Date).getTime()-this.ufb>this.Yv.ngd&&(this.xrc(),xa.a.J(559284702,this.Yv.$Q,50,"WebSocketFetcher::Retry connect to server after long pause."))}VXd(){const a=!!this.OE&&!!this.OE.instance&&!this.OE.instance.b0,b=(new Date).getTime()-this.ufb>this.vna,c=this.vma<this.Yv.g3g,f=!this.Zl||3===this.Zl.readyState||2===this.Zl.readyState,l=a&&b&&c&&f;xa.a.J(557181E3,this.Yv.$Q,50,"WebSocketFetcher::CanRetry: canRetry:{0}, isPodsSessionAlive:{1}, retryTimeReached:{2}, retryAttemptsAvailable:{3}, noWebSocket:{4}",
l,a,b,c,f);return l}z_e(){this.ufb=(new Date).getTime();this.vna=Math.pow(2,this.vma)*this.Yv.Urh;0<this.Yv.ngd&&(this.vna=Math.min(this.vna,this.Yv.ngd));window.setTimeout(()=>{this.Lya(3)},this.vna)}Lya(a){this.$Td();this.VXd()&&(this.C2b(a),this.z_e(),this.vma++,a!==this.kXa&&xa.a.J(541671620,this.Yv.$Q,10,"WebSocketFetcher::ReconnectionReasonMismatch ReconnectionReason:{0}, m_reconnectionReason{1}",a,this.kXa),xa.a.J(559284703,this.Yv.$Q,50,"WebSocketFetcher::Retry connect to server. ReconnectionReason:{0}",
this.kXa),this.vma===this.Yv.g3g&&xa.a.J(559284704,this.Yv.$Q,50,"WebSocketFetcher::Max retries reached. ReconnectionReason:{0}",this.kXa))}sendMessage(a,b){if(!this.Zl)return xa.a.J(559284705,this.Yv.$Q,50,"WebSocketFetcher::SendMessage Websocket is unavailable. RequestType:{0}, LastCloseCode:{1}, LastCloseReason:{2}",b,this.eFb,this.fFb),1;xa.a.J(559284706,this.Yv.$Q,50,"WebSocketFetcher::SendMessage. WebSocket state {0}, RequestType:{1}, LastCloseCode:{2}, LastCloseReason:{3}",Jl[this.Zl.readyState],
b,this.eFb,this.fFb);if(1===this.Zl.readyState)return this.Zl.send(a),0;this.Lya(5);return 2}Ipl(){this.Zl.binaryType="arraybuffer"}bJb(){-1!==this.zIa&&window.clearTimeout(this.zIa);this.zIa=window.setTimeout(()=>{this.ping()},this.Yv.HOk)}OAi(){this.kXa=0}tib(){this.Zl&&(xa.a.J(557352418,this.Yv.$Q,50,"WebSocketFetcher::OnSessionEnding: closing due to session ending."),this.Zl.close(),this.Zl=null)}Mo(){this.Zl||(xa.a.J(557352419,this.Yv.$Q,50,"WebSocketFetcher::OnSessionRehydrated: reconnecting after session rehydrated."),
this.Lya(6))}}Object(m.a)(vs,"WebSocketFetcher",null,[1436,107]);var mq;(function(a){a[a.none=0]="none";a[a.visibilityRegainedReconnection=1]="visibilityRegainedReconnection";a[a.initialConnection=2]="initialConnection";a[a.timeoutReconnection=3]="timeoutReconnection";a[a.webSocketNotOpenOnPingReconnection=4]="webSocketNotOpenOnPingReconnection";a[a.webSocketNotOpenedReconnection=5]="webSocketNotOpenedReconnection";a[a.sessionRehydrationReconnection=6]="sessionRehydrationReconnection"})(mq||(mq={}));
Object(m.b)("ConnectionReason",mq);var Vq;(function(a){a[a.success=0]="success";a[a.nullWebSocket=1]="nullWebSocket";a[a.webSocketNotOpened=2]="webSocketNotOpened"})(Vq||(Vq={}));Object(m.b)("SendMessageStatusCode",Vq);class Ao extends Sys.EventArgs{constructor(a,b,c){super();this.response=a;this.$bl=b;this.CUj=c}}Object(m.a)(Ao,"WebSocketFrontDoorEventArgs",Sys.EventArgs,[]);var el=d(660);class Fr{constructor(a,b,c,f,l){this.Pl=window.performance.now();this.bFe=new Pc.a;this.uxe=this.Ifc=!0;this.HDb=
null;this.KHb=1;this.Ya=b;this.Aad=a.yUl;this.cEe=a.zUl;this.Elk=a.wUl;this.opk=a.xUl;this.pfk=a.uUl;this.pGb=a.tzd;this.ifd=a.NRl;this.MHe=a.vUl;this.yfb=yg.a.wB(this.MHe);this.vxa=new vs(this,b,c,f,new Uq.a(a.Caa));this.$Cg=a.sNc;if(l)this.HDb=l;else throw Error.argumentNull("dynamicScriptLoader");}dispose(){this.vxa.dispose()}ping(){this.vxa.ping()}Wx(a){const b=new Map,c=this.axj(a);a.smartArtEditOpRequest&&(b.set("requestType",c),b.set("correlationId",a.smartArtEditOpRequest.commonData?a.smartArtEditOpRequest.commonData.correlationId:
null),$d.Health.instance.recordKpiUsage("DeltaEdit",1,"gc2smartart",b));this.pGb?(a=this.vxa.sendMessage(JSON.stringify(a),c),0!==a&&(b.set("SendMessageStatusCode",Vq[a]),$d.Health.instance.recordKpiFailure("DeltaEdit","SendRequestFailure",!1,!0,Object.assign(new Mj.a,{extendedProperties:b})))):$d.Health.instance.recordKpiFailure("DeltaEdit","WebSocketProtobufBRSDisabled",!0,!0,Object.assign(new Mj.a,{extendedProperties:b}))}Shi(a){this.bFe.addHandler("ResponseReceivedEventId",a)}M8k(a){this.bFe.removeHandler("ResponseReceivedEventId",
a)}UBk(){if(this.pGb){var a=Nc.a.Kb?Nc.a.Kb.actionId:Hg.a.create().toString(),b=w.AFrameworkApplication.userSessionId,c=this.Ya.Ek;this.uxe=!0;b=el.p(a,b,this.Ya.podSessionId,c);b=this.vxa.sendMessage(JSON.stringify(b),"validateSession");xa.a.J(557175649,839,0===b?50:10,"PodsFrontDoorWebSocket::OnConnectionOpened ValidateSessionRequest correlationId:{0}, SendMessageStatusCode:{1}, WebSocketDomain:{2}, WacCluster:{3}",a,Vq[b],this.yfb,c)}}VEk(a){if(this.pGb)try{const b=this.D1i(a);if(b.pong)this.bJb(b.pong.pingTimestamp);
else if(b.validateSessionResponse)this.$Ik(b.validateSessionResponse);else if(b.compressionHandshakeResponse)this.QBk(b.compressionHandshakeResponse);else{const c=Object.getType(a.data)!==String;this.bFe.raiseEvent("ResponseReceivedEventId",new Ao(b,this.Fpj(a,c),c))}}catch(b){xa.a.J(541618382,839,10,"PodsFrontDoorWebSocket Failed to parse WebSocketFrontDoorServiceResponse")}else this.bJb(a.data)}D1i(a){let b=Object.getType(a.data)===String?a.data:null;if(b)return JSON.parse(b);if(2===this.KHb)return a=
new Uint8Array(a.data),b=WebSocketCompressionHelper.WebSocketCompressionHelper.decompressTextWithDeflateRaw(a),JSON.parse(b);xa.a.J(541349337,839,10,"PodsFrontDoorWebSocket: ExtractMessageReceive could not decompress data because WebSocketCompressionHelper is not loaded");return JSON.parse("")}Fpj(a,b){return b?(new Uint8Array(a.data)).byteLength:a.data.length}$Ik(a){if(a.isValid){if(this.$Cg){a=Nc.a.Kb?Nc.a.Kb.actionId:Hg.a.create().toString();const b=w.AFrameworkApplication.userSessionId,c=this.Ya.podSessionId,
f=this.Ya.Ek;xa.a.J(541161497,839,50,"PodsWebSocketFrontDoor::OnValidateSessionResponse - WebSocketCompressionHelperLoadState:{0}",Er[this.KHb]);1===this.KHb?this.z$j(a,b,c,f):2===this.KHb&&this.jvh(a,b,c,f)}this.ping()}else xa.a.J(556541795,839,10,"PodsWebSocketFrontDoor::OnMessageReceived - Closing WebSocket because session not valid. WebSocketDomain:{0}, WacCluster:{1}",this.yfb,this.Ya.Ek),this.vxa.rCi()}z$j(a,b,c,f){this.$Cg&&this.HDb.loadScript("WebSocketCompressionHelper").then(()=>{this.KHb=
2;this.jvh(a,b,c,f)}).catch(()=>{xa.a.J(541710233,839,10,"PodsFrontDoorWebSocket WebSocketCompressionHelper failed to load");this.KHb=3})}jvh(a,b,c,f){a=el.a(a,b,c,!0,f);a=this.vxa.sendMessage(JSON.stringify(a),"compressionHandshake");xa.a.J(541710232,839,50,"PodsFrontDoorWebSocket WebSocketCompressionHelper loaded and sent compression handshake with status code {0}",a)}QBk(a){a=a.clientReadyForCompression;xa.a.J(541710234,839,50,"PodsFrontDoorWebSocket WebSocket compression handshake received with value {0}",
a);a&&this.vxa.Ipl()}axj(a){return a.ping?"ping":a.validateSessionRequest?"validateSession":a.compressionHandshakeRequest?"compressionHandshake":a.smartArtEditOpRequest&&a.smartArtEditOpRequest.editOps&&a.smartArtEditOpRequest.editOps[0].resizeEditOp?"resizeEditOp":"unknown"}bJb(a){this.vxa.bJb(a);ma.a.Xa(a)?xa.a.J(561639837,839,10,"PodsFrontDoorWebSocket::OnPingReply Invalid pingTimestampStr"):(a=parseFloat(a),isNaN(a)?xa.a.J(591208987,839,10,"PodsFrontDoorPing::OnMessage Ping response not a number. m_protobufEnabled:{0}",
this.pGb):(a={["PingTime"]:window.performance.now()-this.Pl-a,MeasurementType:"Performance.Now"},a.First=this.Ifc?1:0,a.WebSocketFrontDoorProtobufEnabled=this.pGb,a.PostConnectionPing=this.uxe,a.ConnectionReason=mq[this.vxa.kXa],this.vxa.OAi(),this.uxe=this.Ifc=!1,xa.a.J(591208985,839,50,ta.a.toJSON(a))))}rNi(){var a=(window.performance.now()-this.Pl).toString();if(!this.pGb)return a;a=el.q(el.l(a),null,null,null,this.Ya.Ek);return JSON.stringify(a)}get AUl(){return this.ifd&&!ma.a.Xa(this.MHe)?this.MHe:
w.AFrameworkApplication.fa.appSettings.WebServiceBase+"WebSocketFrontDoorServiceHandler.ashx"}get $Q(){return 839}get HOk(){return this.cEe}get g3g(){return this.Aad}get Urh(){return this.opk}get ngd(){return this.Elk}get kCi(){return this.pfk}}Object(m.a)(Fr,"PodsWebSocketFrontDoor",null,[1349,107,1396]);class Gr{constructor(){this.K=null}get name(){return"PowerPointWebEditor.WebSocketFrontDoor"}Yb(a){if(!a)throw Error.create("PPTWebEditorWebSocketFrontDoorPackage : container is null");this.K=a;
a.register(1349,"PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor").ma().oa(()=>{try{return new Fr(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.Ia("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("Common.IDynamicScriptLoaderProvider").rI)}catch(b){return xa.a.J(591208983,839,10,"exception creating PodsWebSocketFrontDoor: "+b),null}})}init(){}dispose(){this.K.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor").dispose()}static main(){n.a.instance.Ac(new Gr)}}
Object(m.a)(Gr,"PPTWebEditorWebSocketFrontDoorPackage",null,[2,3]);var Wq=d(1189),bf=d(1198);class Mn{constructor(a=null){this.Xn=null;this.reset();this.jYb=a}I_b(a,b){if(!this.jYb||this.jYb.T0e())b in this.Xn||(this.Xn[b]=[]),this.Xn[b].push(a)}getData(){return ta.a.count(this.Xn)?this.Xn:null}reset(){this.Xn={}}}Object(m.a)(Mn,"NamedValuesAggregator",null,[1536]);class Hr{constructor(){this.Xn=new Na.a}get J0k(){return this.Xn.count}I_b(a){this.Xn.add(a)}getData(){return this.J0k?Ia.toArray(this.Xn):
null}reset(){this.Xn=new Na.a}}Object(m.a)(Hr,"BatchDataAggregator",null,[1536]);var Xq;(function(a){a[a.LanguageInfo=0]="LanguageInfo";a[a.FeedbackLoop=1]="FeedbackLoop";a[a.Config=2]="Config"})(Xq||(Xq={}));Object(m.b)("ApiType",Xq);class Ir{constructor(a,b){this.hi=a;this.tMd=b}Wx(a,b,c){if(c){a=Xq[a];var f={"Content-Type":"application/json; charset=utf-8"};f["X-StatelessPopsAffinityRoutingEnabled"]=w.AFrameworkApplication.fa.ka("PPTStatelessPOPSRequestAffinityEnabled").toString();this.hi.zj(this.tMd()+
"&apitype="+a,2,b,f,!1,3,Object(I.a)(this,this.nLa,"requestSucceeded"),Object(I.a)(this,this.lLa,"requestFailed"),c,void 0,void 0,void 0,void 0,"28")}}nLa(a){if(!w.AFrameworkApplication.Yg&&a&&a.data){var b=a.data.state;b&&b.zYc(b,a.data.ee)}}lLa(a){!w.AFrameworkApplication.Yg&&a&&a.data&&(a=a.data.state)&&a.mYc(a)}}Object(m.a)(Ir,"EditorServiceRequestManager",null,[1475]);class nq extends Sys.EventArgs{constructor(a){super();this.nodeId=a}}Object(m.a)(nq,"ErrorRangesChangedEventArgs",Sys.EventArgs,
[]);var fl=d(273);class vn{constructor(a,b,c){this.begin=a;this.end=b;this.Eh=c}}Object(m.a)(vn,"ErrorRange",null,[244]);class gm{constructor(a,b){this.Wn=a;this.YXh=b}get Je(){return this.Wn}get Eh(){return this.YXh}fe(a){return new gm(a||this.Wn,this.Eh)}}Object(m.a)(gm,"SpellingErrorObject",null,[146]);class Jr{constructor(a,b,c){this.Ma=new Pc.a;this.Cr=a;this.V6h=b;this.D0h=c}jxf(a,b){b=this.cEh(a,b);if(!Yb.a.Xa(b)){for(var c=this.TF(a),f=[],l=0,y=0;l<b.length&&y<c.length;){const H=c[y],Q=b[l];
Q.end<=H.begin?++l:(H.end>Q.begin&&Array.add(f,H),++y)}c=a.m2a();try{const H=a.$ja();try{this.ynh(a,f),this.kxf(a,b)}finally{H&&H.dispose()}}finally{c&&c.dispose()}this.vhd(a)}}fLa(a,b,c=!1){if(!Yb.a.Xa(b)){c=c?null:a.m2a();try{const f=a.$ja();try{this.ynh(a,b)}finally{f&&f.dispose()}}finally{c&&c.dispose()}this.vhd(a)}}j$k(a,b){const c=a.m2a();try{const f=a.$ja();try{this.RYd(a),b=this.cEh(a,b),Yb.a.Xa(b)||this.kxf(a,b)}finally{f&&f.dispose()}}finally{c&&c.dispose()}}RYd(a){const b=a.m2a();try{const c=
a.$ja();try{const f=a.Ta;for(a=0;a<f.length;a++){const l=f.ga(a);l.Yp&&(l.Yp=null);l.aM=!1}}finally{c&&c.dispose()}}finally{b&&b.dispose()}}TF(a,b=null){const c=[];let f=0,l=null;var y=!1;a=a.Ta;for(let H=0;H<a.length;H++){const Q=a.ga(H);if(Q.aM){const ia=Q.cp;l?(y=new vn(f,ia,l),b&&!b(y)||Array.add(c,y)):y?ka.ULS.sendTraceTag(41300895,324,10,"Encountered CHP SpellingError without ErrorDetails set"):ka.ULS.sendTraceTag(41300896,324,10,"Encountered SpellingErrorEnd without the begin: Begin CP {0}, End CP {1}",
f,ia);y=!1}Q.Yp&&(y=!0,f=Q.cp,l=Q.Yp.Eh)}return c}UTa(a){if(!a||!Mb.SelectionEditor.tk(a)&&!Mb.SelectionEditor.Xg(a))return null;const b=a.node;let c=a.Sa,f=a.Mb;a=Mb.SelectionEditor.Xg(a);const l=this.Cr.text(b);for(const y of this.TF(b))if(a){if(y.begin<=c&&y.end>=f)return y}else if(y.begin<=c&&y.end>=c&&ma.a.eHi(l,y.end,f))return y;return null}qsc(a){if(!this.D0h||!a||!(a.gda||2===a.length&&Mb.SelectionEditor.im(a.jf)))return!1;a=this.UTa(a.Va);if(!a)return!1;if(a=Object(qa.a)(295,a.Eh))if(a.zQh=
!0,a.Yne())return!1;return!a||5!==a.proofingType}cEh(a,b){if(Yb.a.Xa(b))return b;b=Array.clone(b);for(var c=b.length-1;0<=c;c--){var f=b[c];f&&f.Eh||(ka.ULS.sendTraceTag(41300897,324,15,"Received malformed ErrorRange: {0}. Filtering it out.",f?"Null error details":"Null range"),Array.removeAt(b,c))}if(!b.length)return b;fl.d(b);c=[];this.V6h&&Array.addRange(c,this.Cr.WTa(a));c=fl.a(c);for(f=a=0;f<b.length&&a<c.length;){let l=b[f];const y=c[a];l.begin<y.end&&y.begin<l.end?Array.removeAt(b,f):l.end<
y.end?f++:a++}return b}kxf(a,b){let c=!1;for(const f of b){b=f.Eh;c=1===b.proofingType||c;let l=a.Ewb(f.begin);l.Yp=new gm(l,b);l.isFromErrorRangeSplit=!0;l=a.Ewb(f.end);l.aM=!0;l.isFromErrorRangeSplit=!0}c&&(a.JAb=!1)}ynh(a,b){if(!Yb.a.Xa(b)){a=a.Ta;for(const c of b){b=a.HT(c.begin);const f=a.HT(c.end);b&&b.Yp&&f&&f.aM?(b.Yp=null,f.aM=!1):(b=String.format("Could not find and remove ErrorRange from CHPs. Cp Begin: {0}, Cp End: {1}",c.begin,c.end),ka.ULS.sendTraceTag(37532355,324,10,b))}}}vgi(a){this.Ma.addHandler("OnErrorRangesChanged",
a)}vhd(a){if(this.Ma.R9b){const b=this.TF(a);this.Ma.raiseEvent("OnErrorRangesChanged",new nq(a.id.toString(),b))}}}Object(m.a)(Jr,"ErrorRangeEditor",null,[1474]);var So=d(217);class Sp{constructor(){this.Aif=new So.a}contains(a,b){return a?this.Aif.contains(ma.a.RIh(a,b)):!1}add(a,b){a&&this.Aif.add(ma.a.RIh(a,b))}}Object(m.a)(Sp,"IgnoreAllKeywords",null,[1358]);var gl=d(218);class Kr extends gl.a{constructor(a,b,c){super(b,c);this.NG=a;this.zKa=this.Gaa=-1;this.rYd=0;this.textUnit=2}get lcid(){return this.NG}}
Object(m.a)(Kr,"ModifiedRange",gl.a,[]);class oq{constructor(a,b,c,f){this.N$h=a;this.YK=b;this.yN=c;this.yqf=f}get ymd(){return this.yqf?this.yqf.instance:null}TEf(a,b){const c=[];if(Yb.a.Xa(a)||Yb.a.Xa(b))return c;if(1===b.length){b=b[0].lcid;for(var f of a)Array.add(c,new Kr(b,f.begin,f.end))}else{a=Array.clone(a);a.reverse();f=0;do{var l=b[f];let y=l.lcid;for(l=l.end;0<a.length&&l>a[a.length-1].begin;){const H=a.pop(),Q=H.end,ia=Math.min(Q,l);Q>l&&a.push(new gl.a(l,Q));Array.add(c,new Kr(y,H.begin,
ia))}f++}while(0<a.length&&f<b.length);ka.ULS.shipAssertTag(37836432,324,!a.length,"Did not process all modified ranges in the stack")}return c}X0i(a,b,c,f){let l,y;({HIe:l,mIe:y}=oq.z0f(a,c,b));c=0;let H=a.begin,Q=a.end;const ia=this.ymd;let wa=!1;ia?(c=ia.findEndBoundary(b,Q-1,y),f||-1!==c||this.fhg(b,a)?c=-1===c?y:c:wa=!0):wa=!0;if(wa)return this.L6f(a,b,this.yN.I6g,l,y);if(!l)for(;" "===b.charAt(l)&&l<b.length;)l++;a=Math.max(ia.findBeginBoundary(b,H,l),l);return gl.a.createTextRange(a,c)}W0i(a,
b,c){return this.ZYf(a,b,c,this.yN.I6g)}V0i(a,b){if(!a||Yb.a.Xa(b))return a;let c=a.begin,f=a.end,l=!1;for(const y of b){if(a.end<=y.begin)break;a.begin>y.begin&&a.begin<y.end&&(c=y.begin,l=!0);a.end>y.begin&&a.end<y.end&&(f=y.end,l=!0)}return l?gl.a.createTextRange(c,f):a}btl(a,b){if(!a||!b)return!1;const c=a.begin;a=a.end;return!ma.a.mBb(b.substring(c,a))&&!ma.a.dHi(b,c,a)}Xbj(a,b,c){if(!a||!c||Yb.a.Xa(b))return 0;a=fl.c([a],b);b=0;for(const f of a)b+=this.N$h.mdg(c,f.begin,f.end);return b}Pbi(a,
b,c,f){if(a&&b){var l=a.begin,y=a.end,H=this.yN.Azk;if(0>=H)a.Gaa=l,a.zKa=y;else if(H=this.ZYf(a,b,f,H)){b=a.lcid;f=H.begin;H=H.end;if(0>f||this.AAh(f,l,b,c))f=l;this.AAh(y,H,b,c)&&(H=y);a.Gaa=f;a.zKa=H}else a.Gaa=l,a.zKa=y}}fhg(a,b){return this.ymd?-1!==this.ymd.findEndBoundary(a,b.begin,b.end):!1}AAh(a,b,c,f){if(a>=b)return!0;if(1>=f.length)return!1;a=this.TEf([new gl.a(a,b)],f);return 1!==a.length||a[0].lcid!==c}ZYf(a,b,c,f){if(!a||!b||0>f)return null;let l;({HIe:c,mIe:l}=oq.z0f(a,c,b));return this.L6f(a,
b,f,c,l)}L6f(a,b,c,f,l){return gl.a.createTextRange(this.YK.Y4i(b,c,a.begin,f),this.YK.E4i(b,c,a.end,l))}static z0f(a,b,c){let f;f=0;c=c.length;if(Yb.a.Xa(b))return{HIe:f,mIe:c};let l=a.begin;a=a.end;let y=!1,H=!1;for(const Q of b)if(!y&&Q.end<=l?f=Q.end:y=!0,!H&&Q.begin>=a&&(c=Q.begin,H=!0),y&&H)break;return{HIe:f,mIe:c}}}Object(m.a)(oq,"ModifiedExpandRangeHelper",null,[1473]);var To=d(354);class Lr{constructor(a,b){this.JGd=null;this.Fg=a;this.YK=b;this.TG=Db.ParagraphReader.text(this.Fg);this.tqf=
[]}Dwj(a,b){return this.KXc(this.YK.i6b(this.TG,a,b))}KXc(a){return a?this.fee(a.begin,a.end):null}fee(a,b){this.JGd=this.JGd||this.YK.bVc(this.Fg);return this.YK.KXc(a,b,this.TG,this.JGd)}jFa(a,b){(a=this.fee(a,b))&&Array.add(this.tqf,a)}Y7b(){return Array.clone(this.tqf)}}Object(m.a)(Lr,"ValidatedRangeContainer",null,[]);class up{constructor(a,b,c,f,l,y){this.Rm=a;this.YK=b;this.Uc=c;this.yN=f;this.s7h=l;this.$4h=y}Vxb(a){return new Lr(a,this.YK)}Zji(a){const b=a.m3d.currentNode;var c=a.iEh.currentNode;
const f=a.edh;a=this.dua(b);const l=this.Vxb(b);c=this.dua(c);for(var y of c)l.jFa(f+y.begin,f+y.end);Array.addRange(a,l.Y7b());if(y=l.Dwj(f,f))Array.add(a,y),this.cVe(b,y,0);b.f1=a}$ji(a,b,c){var f=a.f1;if(Yb.a.Xa(f)||f[f.length-1].end<=c)this.BMc(b);else{var l=[],y=this.Vxb(a),H=this.Vxb(b);for(const Q of f)if(f=Q.end,f>c){const ia=Q.begin;ia<c?(y.jFa(ia,c),H.jFa(0,f-c)):H.jFa(ia-c,f-c)}else Array.add(l,Q);c=y.Y7b();Array.addRange(c,l);a.f1=c;b.f1=H.Y7b();a.Lsc();b.Lsc()}}Mml(a){Db.ParagraphReader.ae(a)&&
!this.YK.AVa(a)&&(this.Rm.RYd(a),this.eWe(a,[new gl.a(0,Db.ParagraphReader.textLength(a))]))}Kxh(a,b){b&&a&&Db.ParagraphReader.ae(a)&&!this.YK.AVa(a)&&!a.LC&&this.M3g(a,this.Vxb(a).KXc(b),C.a.typing)}Pyh(a,b,c){a&&this.Kxh(a,this.YK.i6b(Db.ParagraphReader.text(a),b,c))}eWe(a,b){if(Db.ParagraphReader.ae(a))if(Yb.a.Xa(b))this.BMc(a);else{const c=this.Vxb(a);for(const f of b)c.jFa(f.begin,f.end);a.f1=c.Y7b()}}BMc(a){Db.ParagraphReader.ae(a)&&(a.f1=null)}Csd(a,b,c=null){if(Db.ParagraphReader.ae(a)&&!a.LC&&
!Yb.a.Xa(b)){fl.d(b);var f=null;if(this.yN.yAb||this.yN.wVa)f=Q=>1===Q.Eh.proofingType;f=this.Rm.TF(a,f);for(var l=[],y=0,H=0;H<f.length&&y<b.length;){const Q=b[y],ia=f[H];Q.end<=ia.begin?y++:(ia.end<=Q.begin||ia.begin>=Q.begin&&ia.end<=Q.end&&(0!==ia.Eh.errorType||ia.begin!==Q.begin)&&Array.add(l,ia),H++)}this.Rm.fLa(a,l);f=this.dua(a);b=fl.b(f,b);c&&(c=fl.c(f,[c]),0<c.length&&(b=fl.e(b,c)));this.eWe(a,b)}}dua(a){return Db.ParagraphReader.ae(a)?a.f1||[]:[]}hmi(a,b,c,f,l=0){const y=a.node;if(Db.ParagraphReader.ae(y)&&
!this.YK.AVa(y)&&!y.LC){var H=Db.ParagraphReader.text(y),Q=a.Sa,ia=a.Mb+f;this.s7h?(Q=a.Sa+b,ia=a.Mb-c+f):this.$4h&&(b=this.Uc.Yj,0<=f&&b&&Mb.SelectionEditor.Xg(b)&&(b=b.Sa,0<=b&&b<=H.length&&(b=this.YK.i6b(H,b,b))&&b.begin>=Q&&b.end<=ia&&(Q=b.begin,ia=b.end)));b=this.Vxb(y);c=null;0<=f&&(c=b.fee(Q,ia));c||(c=this.YK.i6b(H,Q,ia));0<=f?this.M3g(y,c,l):this.hPl(y,a.Sa,a.Mb,c,b,f,l)}}M3g(a,b,c){if(b){var f=this.dua(a);Array.add(f,b);a.f1=f;a.Lsc();this.cVe(a,b,c)}}hPl(a,b,c,f,l,y,H){const Q=this.dua(a),
ia=[];if(Q.length)if(Q[Q.length-1].end<b)if(f)Array.addRange(ia,Q);else return;else{for(const wa of Q)wa.end<b?Array.add(ia,wa):wa.begin>=c?l.jFa(wa.begin+y,wa.end+y):wa.begin<b?wa.end>c?l.jFa(wa.begin,wa.end+y):l.jFa(wa.begin,b):wa.end>c&&l.jFa(b,wa.end+y);Array.addRange(ia,l.Y7b())}f&&(Array.add(ia,f),this.cVe(a,f,H));a.f1=ia;a.Lsc();this.Rm.vhd(a)}cVe(a,b,c){const f=this.Rm.TF(a,y=>y.begin<=b.end&&y.end>=b.begin);if((c===C.a.ZVd||c===C.a.typing||c===C.a.cut||c===C.a.paste)&&1===f.length&&f[0].Eh){c=
f[0].Eh;var l=bb.a.He(c.lcid);l=l?l.name:up.iSh;const y=Object(Wa.a)(To.a,c)?c.typeId:up.zSh;ka.ULS.sendTraceTag(40486211,375,50,"ManualEdits CritiqueId:{0}, CultureTag:{1}",y,l);c.zQh&&ka.ULS.sendTraceTag(40486212,375,50,"ClickNoAction CritiqueId:{0}, CultureTag:{1}",y,l)}this.Rm.fLa(a,f)}}up.zSh="";up.iSh="UNKNOWN";Object(m.a)(up,"ModifiedRangeEditor",null,[1472]);class vp{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua=null){this.Rm=a;this.Vz=b;this.EZb=c;this.SK=f;this.g5a=l;this.oPa=y;this.YK=H;this.o6a=
Q;this.udf=ia;this.Ihf=Ua||vp.zRi;this.Isf=!1;wa.execute(kb=>{this.Isf=!!kb})}cNh(a){if(a&&Db.ParagraphReader.ae(a)&&a.LYc){let b=null;this.udf.Uua&&(b=c=>!!c.Eh&&1===c.Eh.proofingType);a.JAb=Yb.a.Xa(this.Vz.dua(a))&&Yb.a.Xa(this.Rm.TF(a,b))}}Blj(a,b){var c=this.Dlj(a,b);if(Yb.a.Xa(c))return[];const f=Db.ParagraphReader.text(a).replace("\u00a0"," "),l=this.Rm.TF(a),y=this.gil(a,l),H=y&&this.cJi(a),Q=this.YK.S_f(a),ia=fl.e(this.YK.R_f(a),Q);c=this.Qgj(c,b,f,ia,l,y,H);if(Yb.a.Xa(c))return[];b=this.g5a.Mjj(a);
c=this.oPa.TEf(c,b);if(Yb.a.Xa(c))return[];this.wVk(a,f,c);a=this.Vz.dua(a);for(const wa of c)this.oPa.Pbi(wa,f,b,Q),wa.rYd=this.oPa.Xbj(wa,a,f),y&&(H||this.oPa.fhg(f,wa))&&(wa.textUnit=4);return c}w4i(a){if(this.Ihf()||!a||""===a.sa(ab.a.tq,""))return null;var b=this.o6a.k6b;if(!b||!Mb.SelectionEditor.Xg(b)||b.node!==a||!this.sHj(a))return null;b=b.Sa;return this.YK.i6b(Db.ParagraphReader.text(a),b,b)}gmi(a,b,c,f,l,y,H=0){this.SK.Lc(a.node).kf()&&(this.Vz.hmi(a,b,c,y,H),this.EZb.gRl(a,f,l))}sHj(a){const b=
fl.a(this.Vz.dua(a));if(!b.length)return!1;a=fl.a(this.Rm.TF(a));let c=0,f=0;for(;c<a.length&&f<b.length;){const l=b[f],y=a[c];l.begin>=y.begin&&l.end<=y.end?f++:c++}return f!==b.length}Dlj(a,b){if(!a||a.Mme)return null;a=this.Vz.dua(a);return a.length&&b?fl.b(a,[b]):a}gil(a,b){return this.Isf&&this.udf.Uua?a.uVb||!b.length||Yb.a.any(b,c=>!!c.Eh&&2===c.Eh.Hvg):!1}cJi(a){if(!a.uVb||this.Ihf())return!0;var b;(b=this.o6a.k6b)&&b.node===a?(a=this.Vz.dua(a),b=b.Sa<a[a.length-1].begin):b=!0;return b}Qgj(a,
b,c,f,l,y,H){let Q=[];for(const ia of a)a=y?this.oPa.X0i(ia,c,f,H):this.oPa.W0i(ia,c,f),(a=this.oPa.V0i(a,l))&&Array.add(Q,a);Q=fl.a(Q);b=fl.f(f,b);return fl.b(Q,b)}wVk(a,b,c){const f=[];for(let l=c.length-1;0<=l;l--){const y=c[l];this.oPa.btl(y,b)||(Array.removeAt(c,l),Array.add(f,y))}this.Vz.Csd(a,f)}static zRi(){return ah.a.XHj(Rc.App.Lb.zG.mug)}}Object(m.a)(vp,"ParagraphProofingFacade",null,[1471]);var sk=d(1095);class wp{constructor(){this.mYc=this.zYc=this.activity=null}endActivity(a){this.activity&&
(this.activity.properties.$("EndReason",a),this.activity.end())}}Object(m.a)(wp,"EditorServiceAPIRequest",null,[]);class Yq extends wp{constructor(){super();this.Sza=this.request=null}}Object(m.a)(Yq,"ProofingConfigV2Request",wp,[]);class pq{constructor(a,b,c,f,l){this.Lcid=a;this.AppId=b;this.LanguageId=c;this.LanguageUXId=f;this.Descriptors=l}}Object(m.a)(pq,"ProofingConfigV2RequestObject",null,[]);var xp;(function(a){a[a.success=0]="success";a[a.partialSuccess=1]="partialSuccess";a[a.error=2]=
"error";a[a.disabled=3]="disabled"})(xp||(xp={}));Object(m.b)("ResponseStatus",xp);var Ql=d(3);class Mr{constructor(a,b,c,f,l){this.OTb=a;this.qd=b;this.FXb=c;this.Y4h=f;this.tvf=w.AFrameworkApplication.lcid;this.Aha=Rc.App.mode;this.Jzc={};this.YWb=new Uc.a;this.S4h=l}init(){this.Lld(this.tvf)}Lld(a){if(!(a.toString()in this.Jzc||w.AFrameworkApplication.Yg))try{this.Y4h.szi(a).continueWith(b=>{!b.result||this.YWb.Fb(a.toString())&&this.YWb.ga(a.toString())||this.ghl(a)},3)}catch(b){ka.ULS.sendTraceTag(36782929,
375,10,"PopulateConfigByLanguageId failed with exception: {0}",b)}}ghl(a){var b=new sk.a;const c=bb.a.He(a).name,f=bb.a.He(this.tvf).name;c&&c.length&&f&&f.length&&(b=Object.assign(new Yq,{request:new pq(a,this.zaj(),c,f,this.FXb.descriptors),activity:this.qd.Zp(C.a.qal),Sza:b,zYc:Object(I.a)(this,this.kpc,"processSuccessResponse"),mYc:Object(I.a)(this,this.ipc,"processFailResponse")}),this.YWb.$(a.toString(),!0),this.OTb.Wx(2,De.c(b.request),b))}kpc(a,b){if(!a||!a.request)return!1;this.YWb.$(a.request.Lcid.toString(),
!1);if(a.request.Lcid.toString()in this.Jzc)return a.endActivity("RequestSucceeded"),!0;let c=null;if(b&&b.length)try{c=De.a(b)}catch(f){ka.ULS.sendTraceTag(36811152,375,10,"Parse failed with exception: {0}",f)}if(!c||1===c.ResponseStatus)return b=c?xp[c.ResponseStatus]:"EmptyResponse",ka.ULS.sendTraceTag(37343687,375,50,"Failed to get proofing config, language {0}, Reason {1}",a.request.LanguageId,b),a.endActivity(b),!1;a.endActivity("RequestSucceeded");b=c.CritiqueCategoryInfoList;this.S4h.filter(b);
ka.ULS.sendTraceTag(35240099,375,50,"Get proofing config. CritiqueCategoryInfoList is null: {0}, Length of CritiqueCategoryInfoList: {1}, languageId: {2}",!b,b?b.length:0,a.request.LanguageId);this.Jzc[a.request.Lcid.toString()]=b;return!0}ipc(a){a&&(a.request&&this.YWb.$(a.request.Lcid.toString(),!1),a.Sza.Og(!1),ka.ULS.sendTraceTag(35240128,375,10,"Failed to get proofing config, language {0}",a.request.LanguageId),a.endActivity("RequestFailed"))}request(a){return Ql.Task.qt(this.Jzc[a.toString()])}zaj(){const a=
cf.a[this.Aha];return a.charAt(0).toUpperCase()+a.substr(1)+"_Online"}}Object(m.a)(Mr,"ProofingConfigV2Manager",null,[1362]);class hl{constructor(){this.Value=this.Name=null}static create(a,b){return Object.assign(new hl,{Name:a,Value:b})}static cie(){Object.assign(new hl,{Name:"IsCompliant",Value:void 0});Object.assign(new hl,{Name:"LicenseType",Value:"NoLicense"});Object.assign(new hl,{Name:"IsGoLocal",Value:void 0})}}Object(m.a)(hl,"Descriptor",null,[]);class zt{constructor(a,b){this.UAa=[];this.Oa=
a;this.fgf=b}get descriptors(){if(!this.UAa.length)try{this.cie()}catch(a){const b=String.format("Message: {0}. Stack: {1}",a.message,a.stack);ka.ULS.sendTraceTag(33952285,375,10,b)}return this.UAa}cie(){Array.clear(this.UAa);var a=this.Oa.ka("ProofingWithEditorServiceInboundaryCloudSuggestionsIsEnabled").toString();Array.add(this.UAa,Object.assign(new hl,{Name:"IsGoLocal",Value:this.Oa.ka("IsGoLocalEnvironment").toString()}));Array.add(this.UAa,Object.assign(new hl,{Name:"IsCompliant",Value:a}));
if(this.fgf.Oqe||this.fgf.wVa)a=this.Oa.ka("IsSubscriptionForProofingUser")?"Subscription":"NoLicense",Array.add(this.UAa,Object.assign(new hl,{Name:"LicenseType",Value:a}));this.mli();this.tli()}tli(){var a=De.b(this.Oa.appSettings.SessionStartInfoJson.toString());var b=a.Host||"";const c=a.Ring||"";a=a.WACDatacenter||"";""!==c&&""!==b&&(b=c+"-"+b,Array.add(this.UAa,Object.assign(new hl,{Name:"CustomAudience",Value:b})));""!==a&&Array.add(this.UAa,Object.assign(new hl,{Name:"Origin",Value:a}))}mli(){const a=
this.c4i(this.Oa.Ha("FlightId"));let b;0<a.length&&(b=Yb.a.join(a,";"),Array.add(this.UAa,Object.assign(new hl,{Name:"FlightIds",Value:b})),ka.ULS.sendTraceTag(33952287,375,50,"FlightCount: [{0}], flightIds: [{1}]",a.length,b))}c4i(a){const b=[];if(a&&""!==a){a=a.split(";");for(let c=0;c<a.length;c++)-1<a[c].toLowerCase().indexOf("editorservice")&&Array.add(b,a[c])}return b}}Object(m.a)(zt,"ProofingDescriptors",null,[1357]);class hm{constructor(a,b){this.wVa=this.yAb=this.fOd=!1;this.SKd=this.RKd=
0;this.fFc=a.ka("ProofingWithEditorServiceIsEnabled");this.rZh=a.ka("GrammarCheckIsEnabled");this.aWa=a.ka("ProofingSettingIsEnabled");this.gpe=a.ka("ProofingSecondaryContextualMenuIsEnabled");this.iCc=a.ka("EditorServiceSuggestionDescriptionsIsEnabled");a.ka("NewProofingExperienceEnabled");this.R$h=a.ka("WritingStyleIsEnabled");this.nXh=a.ka("DoNotCheckThisIssueEnabled");this.e0h=a.ka("IgnoreProofingCommandIsEnabled");this.Uua&&(this.fOd=!1,b.execute(()=>{this.fOd=!0}));2===this.uga?(this.SKd=2,
this.RKd=3):(this.SKd=a.wc("NumberOfWordsToProofAroundModifiedRanges",1),this.RKd=a.wc("NumberOfWordsAsContextAroundProofedRanges",0))}get Nog(){return this.e0h}get Uua(){return 2===this.uga&&this.rZh}get Oqe(){return this.Uua&&this.R$h}get fne(){return this.nXh&&this.gpe&&this.aWa}get BVj(){return this.iCc}get uga(){return this.fFc?2:0}get Azk(){return this.RKd}get I6g(){return this.SKd}get isLoaded(){return!this.fFc||!this.Uua||this.fOd}}Object(m.a)(hm,"ProofingFeatureConfiguration",null,[1470]);
class im extends wp{constructor(){super();this.request=null}}Object(m.a)(im,"ProofingFeedbackLoopRequest",wp,[]);class Tp{constructor(a,b,c){this.OTb=a;this.qd=b;this.FXb=c}lhl(a){a.Descriptors=this.FXb.descriptors;a=Object.assign(new im,{request:a,activity:this.qd.Zp(C.a.Jhl),zYc:Object(I.a)(this,this.kpc,"processSuccessResponse"),mYc:Object(I.a)(this,this.ipc,"processFailResponse")});this.OTb.Wx(1,De.c(a.request),a)}kpc(a){if(!a)return!1;a.endActivity("RequestSucceeded");return!0}ipc(a){a&&(ka.ULS.sendTraceTag(38847138,
375,15,"Proofing feedback failed"),a.endActivity("RequestFailed"))}}Object(m.a)(Tp,"ProofingFeedbackLoopManager",null,[1469]);class At extends wp{constructor(){super();this.Sza=this.request=null}}Object(m.a)(At,"ProofingLanguageInfoRequest",wp,[]);class u{constructor(a){this.AppId=a}}Object(m.a)(u,"ProofingLanguageInfoRequestObject",null,[]);class P{constructor(a,b){this.OTb=a;this.qd=b;this.Aha=Rc.App.mode;this.Rqa=new Eb.ScriptSharpLegacyMap;this.Hha=null;this.c6a=0}szi(a){if(this.Rqa.Fb(a))return Ql.Task.qt(!0);
this.oYe();return this.Hha.CWRCo(()=>!!this.Hha.result&&this.Hha.result.Fb(a),3)}tzi(a,b){if(this.Rqa.Fb(a))return Ql.Task.qt(this.Wbg(a,b));this.oYe();return this.Hha.CWRCo(()=>this.Wbg(a,b),3)}jej(a){if(0<this.Rqa.count)return Ql.Task.qt(this.K5f(a));this.oYe();return this.Hha.CWRCo(()=>this.K5f(a),3)}jal(){const a=new sk.a;w.AFrameworkApplication.Yg&&a.Og(null);const b=Object.assign(new At,{request:new u(cf.a[this.Aha]+"_Online"),activity:this.qd.Zp(C.a.ral),Sza:a,zYc:Object(I.a)(this,this.kpc,
"processSuccessResponse"),mYc:Object(I.a)(this,this.ipc,"processFailResponse")});this.OTb.Wx(0,De.c(b.request),b);this.c6a+=1;return a.task}kpc(a,b){let c=null;if(!a)return!1;try{c=De.a(b)}catch(l){ka.ULS.sendTraceTag(37025730,375,10,"Failed to parse language info response with exception {0}",l)}if(c&&0===c.ResponseStatus&&c.SupportedLanguages&&0<c.SupportedLanguages.length){for(var f of c.SupportedLanguages)(b=bb.a.He(f.LanguageId))&&0!==f.SupportedTextUnit&&this.Rqa.$(b.LCID,f);a.Sza.Og(this.Rqa);
a.endActivity("RequestSucceeded");return!0}a.Sza.Og(null);f=c?xp[c.ResponseStatus]:"EmptyResponse";ka.ULS.sendTraceTag(38847139,375,15,f);a.endActivity(f);return!1}ipc(a){a&&(a.Sza.Og(null),ka.ULS.sendTraceTag(38847168,375,15,"RequestFailed"),a.endActivity("RequestFailed"))}Wbg(a,b){if(!this.Rqa||!this.Rqa.Fb(a))return 0;a=this.Rqa.ga(a).SupportedTextUnit;return 0!==(b&a)?b:this.Wgj(b,a)}Wgj(a,b){for(a=b&(a|a-1);a;){b=a&a-1;if(!b)break;a=b}return a}K5f(a){const b=new Na.a;if(!this.Rqa)return b;for(let c of this.Rqa)c.value.SupportedCritiqueTag&
a&&b.add(c.key);return b}oYe(){if(!this.Hha||5===this.Hha.status||4===this.Hha.status||6===this.Hha.status&&!this.Hha.result)this.Hha=this.jal(),ka.ULS.sendTraceTag(38319180,375,1===this.c6a?50:15,"Schedule a new task for LanguageInfo request. IsRetried: {0}, Count: {1}",1!==this.c6a,this.c6a)}}Object(m.a)(P,"ProofingLanguageInfoManager",null,[1468]);class la{constructor(a,b){this.Z0h=a;this.Wqb=b}track(a,b=null){this.Z0h&&this.Wqb.track(a(),b)}}Object(m.a)(la,"ProofingMetricsAggregator",null,[1361]);
class Ba{Iyf(a,b){a&&Db.ParagraphReader.ae(a)&&!Yb.a.Xa(b)&&(fl.d(b),a.OQb=fl.e(a.OQb,b))}gRl(a,b,c){if(b){var f=a.Mb;a=a.node.OQb;for(let y=0;y<a.length;y++){var l=a[y];const H=l.begin;l=l.end;0>b?l>c&&(H>=f?a[y]=new gl.a(H+b,l+b):H>=c&&l<=f?(Array.removeAt(a,y),y--):a[y]=new gl.a(H<c?H:c,l<=f?c:l+b)):a[y]=new gl.a(H>f?H+b:H,l>f?l+b:l)}}}}Object(m.a)(Ba,"UnsupportedLanguageRangeEditor",null,[1467]);var Sa=d(1304),pb=d(473),Vb=d(247),Bc=d(456),Yc=d(1122),gd=d(674);class Td{constructor(){this.Vy=this.I0a=
null}}Object(m.a)(Td,"ClientRequestManagerStateObject",null,[]);class Re{constructor(a,b){this.request=a;this.response=b}}Object(m.a)(Re,"SpellCheckRequestResponseTuple",null,[]);class Uf{constructor(){this.DPh=0;this.aRf=this.voa=this.paragraphNode=this.range=null;this.userAction=0;this.OI=null;this.uga=0;this.overriddenCritiqueTypeOptions=this.descriptors=null}Zog(){const a=Db.ParagraphReader.text(this.paragraphNode);if(!a||!this.voa)return a===this.voa;let b=this.range.begin,c=this.range.end;return ma.a.kVd(a.substring(b,
c),this.voa.substring(b,c))}isValid(){return this.paragraphNode.isConnected&&this.Zog()}}Object(m.a)(Uf,"SpellCheckRequest",null,[]);var Ef=d(673),Oh=d(857),ek=d(858);class je{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld){this.PQd=new Ma.a;this.sXb=[];this.vAc=0;this.DFc={};this.Kba=null;this.Icf=Number.POSITIVE_INFINITY;this.szc=0;this.V7=je.Abb;this.W5a=null;this.SGc=0;this.Urb=[];this.Qzc=null;this.N5h=!1;this.WWb=[];this.PMd=[];this.T4h=0;this.X4h=c.ka(je.dVk);this.b5h=c.ka(je.kVk);
this.U4h=c.appSettings[je.bVk];this.R4h=c.ka(je.aVk);this.a5h=c.ka(je.iVk);this.kI=f;this.Aha=Rc.App.mode;this.Rm=a;this.Vz=b;this.EZb=wa;this.hi=l;this.t2h=c.wc(je.gVk,je.fVk);this.Z4h=Gb;this.Lk=y;this.rf=H;this.SK=Q;this.YK=ia;this.tMd=Ua;this.dFc=kb;this.ii=new Sa.a;this.W4h=c.ka(je.cVk);this.cFc=dc;this.eVk=Fc;this.qSc=ec;this.fFc=c.ka(je.jVk);this.FXb=yc;this.Q4h=tc;this.Pob=xd;this.j7=Vd;this.Zd=Ld}get zch(){return this.WWb}set zch(a){this.WWb=a}get TTc(){return w.AFrameworkApplication.Yg}get G3b(){return this.Pob.instance}suspend(){this.SGc++}resume(){if(w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopV2Proofing",
!1)&&Object(sc.a)("ALV2SpellingEnabled"))ka.ULS.sendTraceTag(508913506,324,15,"Paragraph legacy proofing hit");else if(0>=--this.SGc&&(this.SGc=0,0<this.Urb.length&&!this.Qzc)){const a=this.j7.isCompleted(4)?0:1;this.Qzc=new dd.a(a,1,1,Object(I.a)(this,this.Mzl,"spellCheckSuspendedNodes"),74);this.Zd.Hb(this.Qzc)}}Mzl(){this.Qzc=null;const a=Yb.a.clone(this.Urb);Array.clear(this.Urb);Date.now();let b=null;for(const c of a)b=this.sLh(c,!0,b);b&&b.dispose();this.N5h||Date.now()}jS(a,b=!1){(a=this.sLh(a,
b,null))&&a.dispose()}sLh(a,b,c){switch(this.Mta(a,b)){case 1:Yb.a.contains(this.Urb,a)||Array.add(this.Urb,a);break;case 2:c=this.doSpellCheck(a,c);this.executeNextRequest();break;case 3:this.executeNextRequest()}return c}Mta(a,b){return!a||this.TTc||!this.kI.Kd.isEditingAllowed&&!this.kI.Kd.sz?0:!b&&0<this.SGc||!this.qSc.isLoaded?1:!Db.ParagraphReader.ae(a)||!a.isConnected||a.anchor.qJ||a.Mme||a.cX||a.LC?3:this.Kba&&Yb.a.any(this.Kba,c=>c.paragraphNode===a)?0:Yb.a.any(this.sXb,c=>c.paragraphNode===
a)||!this.rf.Mt(this.SK.Lc(a))?3:2}doSpellCheck(a,b){const c=(wa,Ua)=>{this.Vz.Csd(wa,Ua)};var f=this.YK.bVc(a);let l=0<f.length;b=this.eRe(b,a,f,c);(f=this.cFc.w4i(a))&&this.fNi(a);const y=this.cFc.Blj(a,f),H=Db.ParagraphReader.text(a),Q=a.uVb,ia=[];for(let wa=y.length-1;0<=wa;wa--){const Ua=y[wa];Ua.begin!==Ua.end&&(this.PQd.contains(Ua.lcid)?Array.add(ia,Ua):(this.pJi(a,H,f,Ua,Q),Array.removeAt(y,wa)))}l=0<ia.length||0<y.length||l;b=this.eRe(b,a,ia,Object(I.a)(this.EZb,this.EZb.Iyf,"addUnsupportedRanges"));
b=this.eRe(b,a,y,c);l&&this.cFc.cNh(a);return b}je(a){const b=this.Lk.je(7,C.a.zyd);b.ld(a);return b}eRe(a,b,c,f){Yb.a.Xa(c)||(a=a||this.je(b),f(b,c));return a}fNi(a){const b=new dd.a(4,1,500,Object(I.a)(this,this.recheckParagraphTask,"recheckParagraphTask"),48);b.customData=a;this.Zd.Hb(b)}Cyk(a,b){b="b"+b.range.begin+"e"+b.range.end+"i"+b.range.lcid+"l"+b.voa.length+b.paragraphNode.id;this.DFc[b]=(this.DFc[b]||0)+1;this.vAc=Math.max(this.DFc[b],this.vAc);return this.vAc>je.Quk?(ka.ULS.sendTraceTag(22390425,
324,15,"Infinite proofing loop detected, cleaning paragraph proof state"),this.vAc=0,this.DFc={},this.Vz.BMc(a),!1):!0}pJi(a,b,c,f,l){const y=new Uf;y.DPh=w.AFrameworkApplication.lcid;y.voa=b;y.range=f;y.paragraphNode=a;y.aRf=c;y.userAction=l?1:0;const H=this.qSc.aWa;H&&this.G3b&&(y.overriddenCritiqueTypeOptions=this.G3b.g$d());this.Cyk(a,y)&&this.Ytj(y.range.lcid,y.range.textUnit).continueWith(Q=>{Q=Q.result;y.uga=2===this.qSc.uga?0!==Q?2:0:this.T4h;y.range.textUnit=Q;y.descriptors=this.FXb.descriptors;
this.gZi(y);H&&2===y.uga&&this.Q4h.Lld(y.range.lcid)},8).continueWith(()=>{this.executeNextRequest()})}Ytj(a,b){return 2===this.qSc.uga?this.eVk.tzi(a,b):Ql.Task.qt(b)}gZi(a){a.OI=new Date;Array.enqueue(this.sXb,a)}recheckParagraphTask(a){this.jS(a.customData)}executeNextRequest(){if(!this.TTc&&!this.Kba){var a=[];do{if(!this.sXb.length)break;const b=Array.dequeue(this.sXb);b.isValid()&&Array.add(a,b)}while(a.length<this.t2h);0>=a.length?(this.Kba=null,this.Nzl()):(this.Kba=a,this.Kba.sort((b,c)=>
+b.OI-+c.OI),a=this.Kba[0],this.dFc.track(+new Date-+a.OI,"ProofingRequestInQueue."+Ef.a[a.userAction]),this.executeRequest(this.Kba))}}Nzl(){for(var a=0;a<this.WWb.length;a++)(0,this.WWb[a])();Array.clear(this.WWb);for(a=0;a<this.PMd.length;a++)(0,this.PMd[a])();Array.clear(this.PMd)}executeRequest(a){if(a&&a.length){var b=[];for(let c=0;c<a.length;++c){const f=gd.a.jrj(this.X4h,a[c],this.Aha,this.b5h,this.a5h,this.R4h,this.U4h,this.fFc);Array.add(b,f)}b=Oh.a.FGi(b,Rc.App.mode);this.hi.zj(this.tMd(),
2,b,{"Content-Type":"application/json; charset=utf-8"},!1,3,Object(I.a)(this,this.Kzl,"spellCheckSucceeded"),Object(I.a)(this,this.Jzl,"spellCheckFailed"),Object.assign(new Td,{I0a:a,Vy:this.ii.Ii("WebServiceCall","Proofing")}),void 0,void 0,void 0,void 0,"29")}}Kzl(a){if(!this.TTc){a=a.data;this.dFc.track(a.state.Vy.dr,"ProofingRequestRoundtrip");var b=this.ii.Ii("DOMUpdate","Proofing");this.Lzl(a);this.dFc.track(b.dr,"UpdateProofingResults")}}Lzl(a){pb.a.mark(7798);this.Kba=null;var b=a.state.I0a;
if(({group:c}=ek.a.qKh(a.ee)).returnValue){var c=c.Responses;var f=({Jcl:b,ril:c}=this.Ptj(b,c)).returnValue;if(0<f.length){const l=this.je(f[0].request.paragraphNode);try{for(const y of f){const H=y.request;this.kI.iZi(H.paragraphNode,()=>{this.suk(y.response,H)})}}finally{l&&l.dispose()}}b.length?(this.bWd(a),this.PQe(b),this.f5d()):this.cbl();this.bWd(a);for(const l of c)Vb.PageStats.u_b(l);this.f5d();this.executeNextRequest()}else this.PQe(b);pb.a.mark(7799)}Ptj(a,b){let c,f;const l=[];c=[];f=
[];for(let y=0;y<a.length;y++){const H=a[y];if(!H.paragraphNode.isConnected)continue;const Q=b[y];if(5===Q.classId){const ia=Q.Fault;if(ia)switch(ia.Type){case 1:ka.ULS.sendTraceTag(22390429,324,15,"Previous proofing char limit: {0}; char limit returned by server: {1}; proofing word length we tried {2}",this.Icf,ia.Limit,ia.AttemptedValue);this.Icf=ia.Limit;break;default:ka.ULS.sendTraceTag(22390431,324,10,"Unknown limit type violated")}else c.push(H)}else l.push(new Re(H,Q));Q.ServerPageStatsTrace&&
f.push(Q.ServerPageStatsTrace)}return{returnValue:l,Jcl:c,ril:f}}suk(a,b){const c=b.paragraphNode;if(c.isConnected)if(c.LC)this.executeNextRequest();else{var f=this.je(c),l=this.Z4h.Dbl(a);if(b.Zog()){var y=b.range;const H=[y];l.Vpd(a)?(y=fl.a(this.Rm.TF(c)),1!==b.userAction&&c.Mmi()&&this.W4h&&(a=l.L_f(a,b,y)),this.Vz.Csd(c,H,b.aRf),a=l.H1i(a,b,y),this.Rm.jxf(c,a)):this.nGj(c,y);this.cFc.cNh(c)}c.Lsc();f.dispose();this.jS(c)}else this.executeNextRequest()}nGj(a,b){const c=[b];b=b.lcid;this.PQd.contains(b)||
(ka.ULS.sendTraceTag(42004739,324,50,"LCID {0} unsupported for proofing",b),this.PQd.add(b));this.Vz.Csd(a,c);this.EZb.Iyf(a,c)}Jzl(a){a=a.data;if(!this.TTc){var b=a.state;this.dFc.track(b.Vy.dr,"ProofingRequestRoundtrip");this.PQe(b.I0a);this.bWd(a);this.f5d()}}PQe(a){this.Kba=a;a=new dd.a(3,1,this.V7,Object(I.a)(this,this.retryCurrentRequest,"retryCurrentRequest"),49);this.Zd.Hb(a);++this.szc;this.V7*=je.hXe;this.V7>je.klc&&(this.V7=je.klc);4!==this.szc||this.hi.eGa||(this.W5a=Rc.App.Lb.notificationBar.vDa(Box4Intl.Box4Strings.l_NotificationBarProofingUnavailave,
!0),Rc.App.Lb.notificationBar.ji(this.W5a),w.AFrameworkApplication.mj.xbb(je.hSh,1),ka.ULS.sendTraceTag(7390529,324,15,"Proofing unavailable"),this.hi.JIc(this))}cbl(){this.szc&&(this.szc=0,this.V7=je.Abb);this.W5a&&(Rc.App.Lb.notificationBar.removeEntry(this.W5a),this.W5a=null,this.hi.Rod(this))}retryCurrentRequest(){this.executeRequest(this.Kba)}pIb(){Rc.App.Lb.notificationBar.removeEntry(this.W5a);this.W5a=null;this.hi.Rod(this)}Ulc(){}get Zpe(){return!this.Urb.length&&!this.Kba&&!this.sXb.length}bWd(a){Vb.PageStats.U7a("SpellCheck",
a.iu);(a=a.yj?a.yj[Bc.a.pDa]:null)&&Vb.PageStats.m7a(Yc.a.Ph,a)}f5d(){Vb.PageStats.eEa("SpellCheck")}}je.gVk="ProofingRequestsBatched";je.fVk=1;je.aVk="ProofingContextualResultsIsEnabled";je.iVk="ProofingTrackMetricsIsEnabled";je.dVk="ProofingInstrumentedAndContextualIsEnabled";je.kVk="ProofingWithOneSpellerIsEnabled";je.bVk="ProofingExperimentId";je.jVk="ProofingWithEditorServiceIsEnabled";je.cVk="ProofingFilterSpellCheckResultIsEnabled";je.hSh=11093;je.Quk=30;je.Abb=1E3;je.hXe=5;je.klc=72E6;Object(m.a)(je,
"ProofingCheckOperator",null,[302,1466]);var Qf=d(532);class Jg{constructor(a){this.Wqb=a}H1i(a,b,c){if(this.aXe(a)){const f={};a=this.wZf(b,a,c,f);this.lki(b,f);return a}b&&this.mki(b);return[]}lki(a,b){this.Wqb.track(()=>Object.assign(new Qf.a,{E:a.uga,C:a.range.rYd,F:b}))}mki(a){this.Wqb.track(()=>Object.assign(new Qf.a,{E:a.uga,C:a.range.rYd}))}Opg(a,b,c){return!a||Yb.a.all(a,f=>f.begin!==b||f.end!==c)}utg(a,b,c){return!!a&&Yb.a.any(a,f=>b>=f.begin&&c<=f.end)}}Object(m.a)(Jg,"AProofingResultsManager",
null,[1496]);var Ei=d(531),wj;(function(a){a[a.none=0]="none";a[a.spelling=1]="spelling";a[a.grammatical=2]="grammatical";a[a.advanced=3]="advanced";a[a.informational=4]="informational";a[a.consistency=5]="consistency"})(wj||(wj={}));Object(m.b)("ProofingType",wj);class Ti extends Jg{constructor(a,b,c,f=null){super(a);this.Oa=f;this.ZXh=b;this.yN=c}Vpd(a){return a&&63===a.classId?!0:(ka.ULS.sendTraceTag(20993182,375,10,"null response or unexpected response"),!1)}aXe(a){return this.Vpd(a)&&!!a.Critiques&&
0<a.Critiques.length}wZf(a,b,c,f){const l=[];b=b.Critiques;for(const Q of b)if(this.xHj(b,Q)&&this.qrl(Q)){var y=0<=a.range.Gaa?a.range.Gaa+Q.Start:a.range.begin+Q.Start;const ia=y+Q.Length;var H=a.voa.substring(y,ia);const wa=this.ZXh.create(Q,this.Wqb,this.Oa);wa.lcid=a.range.lcid;wa.token=H;wa.originalText=a.voa;wa.Gaa=a.range.Gaa;wa.zKa=a.range.zKa;a.range.end>=ia&&(H=new vn(y,ia,wa),Array.add(l,H));this.Opg(c,y,ia)&&(y=1===wa.proofingType?wj[wa.proofingType]:wa.typeId,f[y]=y in f?f[y]+1:1)}return l}L_f(a,
b,c){if(!this.aXe(a))return a;const f=[];for(const l of a.Critiques){const y=0<=b.range.Gaa?b.range.Gaa+l.Start:b.range.begin+l.Start;this.utg(c,y,y+l.Length)&&Array.add(f,l)}a.Critiques=f;return a}qrl(a){return 2!==Ei.b(a)||!this.yN.wVa}xHj(a,b){if(a)for(let c=0;c<a.length;c++)if(b.Start<=a[c].Start+a[c].Length&&b.Start+b.Length>=a[c].Start&&a[c].Priority<b.Priority)return!1;return!0}}Object(m.a)(Ti,"ProofingCheckResultsManager",Jg,[]);var pf=d(50),tk=d(94);class Qk{constructor(a,b,c,f,l,y,H){this.YFd=
!1;H&&c.GI(Object(I.a)(this,this.k0k,"recheckAllParagraphs"));b.Uei(Object(I.a)(this,this.pAk,"onAfterParagraphMerge"));l&&l.yd(12).h8(Object(I.a)(this,this.OFk,"onParagraphDisconnected"));this.Vz=a;this.EXb=f;this.Rm=y}OFk(a,b){Db.ParagraphReader.ae(b.node)&&this.Rm&&this.Rm.vhd(b.node)}pAk(a,b){this.Vz.Zji(b);this.jS(b.m3d.currentNode)}cac(a){this.Vz.Mml(a);this.jS(a)}k0k(a){if(2===a.mode&&(a=this.kcg(a)))for(a=tk.a.bA(a);a.moveNext();)Db.ParagraphReader.ql(a.iterator)&&this.jS(a.currentNode)}suspend(){this.EXb.suspend()}resume(){w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopV2Proofing",
!1)&&Object(sc.a)("ALV2SpellingEnabled")||this.EXb.resume()}get Zpe(){return this.EXb.Zpe}get f1e(){return this.YFd}set f1e(a){if(this.YFd!==a&&(this.YFd=a,a=this.kcg(Rc.App.Lb))){var b=new pf.GraphTransaction(2);try{b.set(a.gk);const c=tk.a.bA(a);for(;c.moveNext();)Db.ParagraphReader.ql(c.iterator)&&c.currentNode.Kv(16,!0)}finally{b&&b.dispose()}}}kcg(a){return(a.Kd.isEditingAllowed||a.Kd.sz)&&a.Kd.Mn.Go?a.Kd.Mn.Ag:null}qdi(a){Array.add(this.EXb.zch,a)}jS(a){this.EXb.jS(a,!1)}}Object(m.a)(Qk,"ProofingManager",
null,[1360]);var Bk=d(1253),Fi=d(672);class Uj extends Fi.a{constructor(a){super(a);this.aZb=null}get proofingType(){return 1}get suggestions(){return this.aZb?Array.clone(this.aZb):null}Hol(a){this.aZb=a}UMa(a,b=0){this.xqf.track(()=>Object.assign(new Qf.a,{E:0,T:1,A:a,I:b}))}}Object(m.a)(Uj,"OfficeSpellerErrorDetails",Fi.a,[]);class jm extends Jg{constructor(a){super(a)}Vpd(a){return!!a.Errors}aXe(a){return this.Vpd(a)&&0<a.Errors.length}wZf(a,b,c,f){let l=0;const y=[],H=b.Errors;for(let wa=0;wa<
H.length;wa++){var Q=H[wa],ia=Object.assign(new Uj(this.Wqb),{token:Q.Word,errorType:Q.Type,lcid:a.range.lcid});ia.Hol(Bk.a.YPh(b.Suggestions,wa*Bk.a.$tg));const Ua=Q.Offset+a.range.begin;Q=Ua+Q.Word.length;ia=new vn(Ua,Q,ia);Array.add(y,ia);this.Opg(c,Ua,Q)&&l++}f.spelling=l;return y}L_f(a,b,c){if(Yb.a.Xa(c)||!a)return a;const f=[],l=[];for(let H=0;H<a.Errors.length;++H){const Q=a.Errors[H];var y=Q.Offset+b.range.begin;this.utg(c,y,y+Q.Word.length)&&(y=H*Bk.a.$tg,Array.add(f,Bk.a.b7j(a.Suggestions,
y)),Array.add(f,Bk.a.YPh(a.Suggestions,y)),Array.add(l,Q))}a.Suggestions=f;a.Errors=l;return a}}Object(m.a)(jm,"ProofingResultsManager",Jg,[]);class vl{constructor(a,b,c){this.eFc=new Jd.a;this.bef=b;a.ka("ProofingWithEditorServiceIsEnabled")&&this.eFc.add(63,c.value);this.eFc.add(4,this.bef)}Dbl(a){if(this.eFc.Fb(a.classId))return this.eFc.ga(a.classId);ka.ULS.sendTraceTag(20747157,375,50,"Fallback ProofingResultsManager is resolved for response: {0}",a.classId);return this.bef}}Object(m.a)(vl,"ProofingResultsManagerResolver",
null,[1359]);class Th{constructor(a=null,b=null){this.cE=this.hd=null;this.CQd=a;this.DQd=b}get Xf(){!this.hd&&this.CQd&&this.CQd.instance&&(this.hd=this.CQd.instance.instance);return this.hd}get owc(){!this.cE&&this.DQd&&this.DQd.instance&&(this.cE=this.DQd.instance.instance);return this.cE}Y4i(a,b,c,f){if(!b)return c;" "!==a.charAt(c)&&(c=a.lastIndexOf(" ",c));if(0<=c)for(let l=0;l<b;l++){c=a.lastIndexOf(" ",c-1);if(c<=f)break;" "===a.charAt(c+1)&&l--}c=Math.max(c,f);return" "===a.charAt(c)?c+1:
c}E4i(a,b,c,f){if(!b)return c;0<c&&" "!==a.charAt(c-1)&&(c=a.indexOf(" ",c));if(0<=c)for(let l=0;l<b;l++){c=a.indexOf(" ",c+1);if(-1===c)break;" "===a.charAt(c-1)&&l--}return c=-1===c?f:Math.min(c,f)}AVa(a){return a.properties.sa(ab.a.AVa,!1)}R_f(a){a=Db.ParagraphReader.text(a);let b;const c=[];for(;b=Th.DKj.exec(a);)Array.add(c,new gl.a(b.index+b[1].length,b.index+b[0].length));return c}S_f(a,b=!0,c=!1){let f=[],l=!1,y=!1,H=!1,Q=!1,ia=-1;a=a.Ta;for(let Ua=0;Ua<a.length;Ua++){var wa=a.ga(Ua);wa.hyperlink?
y=!0:wa.zn&&(y=!1);b&&wa.formatting&&(H=wa.formatting.cache.XVa);if(c&&(wa.aM&&(Q=!1),wa.Yp)){const kb=Object(qa.a)(295,wa.Yp.Eh);kb&&(Q=kb.vFa)}l!==(y||H||Q||!!wa.blob)&&(wa=wa.cp,l?Array.add(f,new gl.a(ia,wa)):ia=wa,l=!l)}l&&(b=gl.a.createTextRange(ia,a.last.cp))&&Array.add(f,b);return f}bVc(a,b=!0,c=!1){return fl.e(this.R_f(a),this.S_f(a,b,c))}i6b(a,b,c){if(b===a.length)for(;0<b&&" "===a.charAt(b-1);)b--;b=a.lastIndexOf(" ",b-1)+1;c=a.indexOf(" ",c);0>c&&(c=a.length);return gl.a.createTextRange(b,
c)}KXc(a,b,c,f){if(!c||""===c||0>a||a>=b||b>c.length)return null;f=f||[];a=Th.k4f(a,b,c);for(var l=0;l<f.length;l++){var y=f[l];if(a<y.begin)break;a<y.end&&(a=Th.k4f(y.end,b,c))}b=Th.H6f(b,c);for(l=f.length-1;0<=l;l--){y=f[l];if(b>y.end)break;b>y.begin&&(b=Th.H6f(y.begin,c))}return(a=gl.a.createTextRange(a,b))&&a.S5j()?a:null}static k4f(a,b,c){for(;a<b&&ma.a.uz(c.charCodeAt(a));)a++;return a}static H6f(a,b){for(;0<a&&Th.oTj(a,b);)a--;return a}static oTj(a,b){a=b.charAt(a-1).toString();return a===
kf.AParagraphNode.ZQc||a===kf.AParagraphNode.w_}}Th.DKj=RegExp("(^| )(?:[a-z+.-]+://\\S+|[a-z]:[/\\\\]\\S+|\\\\\\\\\\S+|mailto:\\S+)","ig");Object(m.a)(Th,"ProofingTextUtility",null,[1403]);class Up{constructor(){this.Da=null}get name(){return"Box4.Proofing"}Yb(a){this.Da=a;this.Da.register(Jr,"Box4.Proofing.ErrorRangeEditor").as("Box4.Proofing.IErrorRangeEditor").ma().oa(()=>new Jr(this.Da.resolve("Box4.IParagraphReader"),N.a.instance.ga(14),N.a.instance.ga(70)));this.Da.register(up,"Box4.Proofing.ModifiedRangeEditor").as("Box4.Proofing.IModifiedRangeEditor").ma().oa(()=>
new up(this.Da.resolve("Box4.Proofing.IErrorRangeEditor"),this.Da.resolve("Box4.Proofing.IProofingTextUtility"),this.Da.resolve("Box4.ISelectionManager"),this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),w.AFrameworkApplication.fa.ka("MinimizeProofedRangesIsEnabled"),w.AFrameworkApplication.fa.ka("ProofingSetCentralWordRangeIsEnabled")));this.Da.register(Ba,"Box4.Proofing.UnsupportedLanguageRangeEditor").as("Box4.Proofing.IUnsupportedLanguageRangeEditor").ma().oa(()=>new Ba);this.Da.register(oq,
"Box4.Proofing.ModifiedExpandRangeHelper").as("Box4.Proofing.IModifiedExpandRangeHelper").ma().oa(()=>new oq(Wq.a.instance,this.Da.resolve("Box4.Proofing.IProofingTextUtility"),this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.Da.Ia("Box4.Proofing.IProofingSentenceSeparator")));this.Da.register(vp,"Box4.Proofing.ParagraphProofingFacade").as("Box4.Proofing.IParagraphProofingFacade").ma().oa(()=>new vp(this.Da.resolve("Box4.Proofing.IErrorRangeEditor"),this.Da.resolve("Box4.Proofing.IModifiedRangeEditor"),
this.Da.resolve("Box4.Proofing.IUnsupportedLanguageRangeEditor"),this.Da.resolve("Box4.Graph.IGraphIteratorFactory"),this.Da.resolve("Box4.ILanguageReader"),this.Da.resolve("Box4.Proofing.IModifiedExpandRangeHelper"),this.Da.resolve("Box4.Proofing.IProofingTextUtility"),Lk.a.instance,this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.Da.Ia("Box4.Proofing.IProofingSentenceSeparator")));this.Da.register(Th,"Box4.Proofing.ProofingTextUtility").as("Box4.Proofing.IProofingTextUtility").ma().oa(()=>
new Th(this.Da.Ia("Box4.TrackChange.ITrackChangeManagerFactory"),this.Da.Ia("Box4.TrackChange.ITrackChangeReaderFactory")));const b=()=>{const c=w.AFrameworkApplication.fa.Ha("ProofingWebServiceBase");return(void 0===c?Rc.App.webServiceBase:c)+"proofing.ashx?"+w.AFrameworkApplication.gh};this.Da.register(Ir,"Box4.Proofing.EditorServiceRequestManager").as("Box4.Proofing.IEditorServiceRequestManager").ma().oa(()=>new Ir(w.AFrameworkApplication.Me,b));this.Da.register(P,"Box4.Proofing.ProofingLanguageInfoManager").as("Box4.Proofing.IProofingLanguageInfoManager").ma().oa(()=>
new P(this.Da.resolve("Box4.Proofing.IEditorServiceRequestManager"),mc.a.instance));this.Da.register(Tp,"Box4.Proofing.ProofingFeedbackLoopManager").as("Box4.Proofing.IProofingFeedbackLoopManager").ma().oa(()=>new Tp(this.Da.resolve("Box4.Proofing.IEditorServiceRequestManager"),mc.a.instance,this.Da.resolve("Box4.Proofing.IProofingDescriptors")));this.Da.register(hm,"Box4.Proofing.ProofingFeatureConfiguration").as("Box4.Proofing.IProofingFeatureConfiguration").ma().oa(()=>new hm(w.AFrameworkApplication.fa,
this.Da.Ia("Box4.Proofing.IProofingSentenceSeparator")));this.Da.register(1357,"Box4.Proofing.IProofingDescriptors").ma().oa(()=>new zt(w.AFrameworkApplication.fa,this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration")));this.Da.register(je,"Box4.Proofing.ProofingCheckOperator").as("Box4.Proofing.IProofingCheckOperator").ma().oa(()=>new je(this.Da.resolve("Box4.Proofing.IErrorRangeEditor"),this.Da.resolve("Box4.Proofing.IModifiedRangeEditor"),w.AFrameworkApplication.fa,Rc.App.Lb,w.AFrameworkApplication.Me,
this.Da.resolve("Box4.Graph.IGraphTransactionFactory"),fi.a.instance,this.Da.resolve("Box4.Graph.IGraphIteratorFactory"),this.Da.resolve("Box4.Proofing.IProofingTextUtility"),this.Da.resolve("Box4.Proofing.IUnsupportedLanguageRangeEditor"),b,bf.a.PW(4,1,new Mn),this.Da.resolve("Box4.Proofing.IProofingResultsManagerResolver"),this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.Da.resolve("Box4.Proofing.IParagraphProofingFacade"),this.Da.resolve("Box4.Proofing.IProofingLanguageInfoManager"),
this.Da.resolve("Box4.Proofing.IProofingDescriptors"),this.Da.resolve("Box4.Proofing.IProofingConfigV2Manager"),this.Da.Ia("Box4.Proofing.ICritiqueTypeSettings"),Pd.a.get_instance(),w.AFrameworkApplication.Ae));this.Da.register(jm,"Box4.Proofing.ProofingResultsManager").ma().oa(()=>new jm(this.Da.resolve("Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>")));this.Da.register(1358,"Box4.Proofing.IIgnoreAllKeywords").ma().oa(()=>new Sp);this.Da.register(Ti,"Box4.Proofing.ProofingCheckResultsManager").ma().oa(()=>
new Ti(this.Da.resolve("Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>"),this.Da.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),w.AFrameworkApplication.fa));this.Da.register(1359,"Box4.Proofing.IProofingResultsManagerResolver").ma().oa(()=>new vl(w.AFrameworkApplication.fa,this.Da.resolve("Box4.Proofing.ProofingResultsManager"),this.Da.oe("Box4.Proofing.ProofingCheckResultsManager")));
this.Da.register(1360,"Box4.IProofingManager").ma().oa(()=>new Qk(this.Da.resolve("Box4.Proofing.IModifiedRangeEditor"),this.Da.resolve("Box4.IParagraphEditor"),this.Da.resolve("Box4.IAppFrame"),this.Da.resolve("Box4.Proofing.IProofingCheckOperator"),this.Da.qb("Box4.INotebookManager").uV,this.Da.qb("Box4.Proofing.IErrorRangeEditor"),4!==Rc.App.mode));this.Da.register(1361,"Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>").ma().oa(()=>new la(w.AFrameworkApplication.fa.ka("ProofingTrackMetricsIsEnabled"),
bf.a.PW(15,1,new Hr)));this.Da.register(1362,"Box4.Proofing.IProofingConfigV2Manager").ma().oa(()=>new Mr(this.Da.resolve("Box4.Proofing.IEditorServiceRequestManager"),mc.a.instance,this.Da.resolve("Box4.Proofing.IProofingDescriptors"),this.Da.resolve("Box4.Proofing.IProofingLanguageInfoManager"),this.Da.resolve("Box4.Proofing.IProofingCritiqueCategoryInfoFilter")))}init(){this.Da.resolve("Box4.IProofingManager")}dispose(){}static main(){n.a.instance.Ac(new Up)}}Object(m.a)(Up,"Box4ProofingPackage",
null,[2,3]);var ai=d(178);class Rl{constructor(a){this.q6e=0;this.mbb=this.IKb=this.imb=null;this.kba=w.AFrameworkApplication.Aa.vV;this.PQ=a;this.PQ.Iu(Qe.a.pwh);this.PQ.dC(Qe.a.pwh,Object(I.a)(this,this.uGk,"onReceivedCustomAuthConfig"))}getCustomAuthConfig(){if(this.mbb)return ka.ULS.sendTraceTag(589050652,344,100,"Returning existing promise"),this.mbb;this.imb=this.kba.Ii("ComponentAttach","getCustomAuthConfig");return this.mbb=new Promise((a,b)=>{const c={};let f=!1,l=!1,y=0;this.q6e=window.setInterval(()=>
{4>y?(y++,this.PQ.sendMessage(Qe.a.getCustomAuthConfig,c)):(window.clearInterval(this.q6e),f=!0,ka.ULS.sendTraceTag(588087303,344,10,De.c({["error"]:"Request timeout after 4 retries."})),b("Request timeout."))},1E3);this.IKb=(H,Q)=>{window.clearInterval(this.q6e);f||l||(l=!0,H?(ka.ULS.sendTraceTag(589050653,344,50,"Resolving Promise with authConfig"),a(H)):(ka.ULS.sendTraceTag(589050654,369,10,De.c({["error"]:Q.toString()})),b(Q)))};this.PQ.sendMessage(Qe.a.getCustomAuthConfig,c)})}uGk(a){try{const b=
De.a(a.Values[ai.a.uvi]);let c=w.AFrameworkApplication.fa.Ha("Application")||"";c=ma.a.rg(c);b.appSignInUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1&prompt=select_account";b.appSignInToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1";b.appSwitchUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1&prompt=select_account";b.appSwitchToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1";this.imb&&(this.imb.stop(),this.imb=null);
this.IKb(b,"")}catch(b){ka.ULS.sendTraceTag(589050655,344,10,De.c({["error"]:b.message,["stack"]:b.stack})),this.IKb(null,b.message)}}}Object(m.a)(Rl,"AccountSwitchingManager",null,[1430]);class qq{get name(){return"Common.App.AccountSwitching"}Yb(a){a.register(Rl,"Common.App.AccountSwitching.AccountSwitchingManager").as("Common.App.AccountSwitching.IAccountSwitching").ma().oa(()=>new Rl(a.resolve("Postmessage.IHostPostmessenger")))}init(){}dispose(){}static main(){n.a.instance.Ac(new qq)}}Object(m.a)(qq,
"AccountSwitchingPackage",null,[2,3]);class Vp{constructor(){this.Ma=new Pc.a}bJc(a){this.Ma.addHandler("OnEditHappenedEvent",a)}LXk(){this.Ma.raiseEvent("OnEditHappenedEvent")}}Object(m.a)(Vp,"EditNotificationEventSource",null,[]);var wn=d(97);class Uo{constructor(a,b,c,f,l,y,H=0){this.ZDd=!1;this.YDd=this.F5a=null;this.nvf=!1;this.Zd=b;this.$Dc=a;this.EOa=c;this.Uha=f;this.lvf=l;this.BXh=y;this.xAc=0;this.wBc=!1;try{0<H&&(this.xAc=H,3E5>this.xAc&&(this.xAc=3E5),this.Zd&&!this.YDd&&(this.YDd=new dd.a(3,
2,this.xAc,Object(I.a)(this,this.M$k,"reportEditDocumentUserActionTelemetryIfNecessary")),this.Zd.Hb(this.YDd)))}catch(Q){ka.ULS.sendTraceTag(51246176,383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+Q)}}get $Rl(){return this.nvf}K4d(){this.$Rl?this.wBc=!0:(this.nvf=!0,$d.Health.instance.addQosPillar("Save"),$d.Health.instance.addQosPillar("ContentCreation"),wn.c(G.a.editDocument));this.ZDd=!0;this.lvf&&this.lvf.Hwf();this.Uha&&this.Uha.LXk();w.AFrameworkApplication.Rg&&
w.AFrameworkApplication.Rg.Ytk();this.BXh&&!this.F5a&&(this.zsc(null),this.F5a=new dd.a(3,2,this.$Dc,Object(I.a)(this,this.zsc,"sendPostMessageIfNecessary"),113),this.Zd.Hb(this.F5a))}zsc(){this.ZDd&&(this.EOa.CWR(()=>this.EOa.result.sendMessage(Qe.a.editNotification,null)),ka.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this.ZDd=!1)}M$k(){try{this.wBc&&(wn.c(G.a.editDocument),this.wBc=!1)}catch(a){this.wBc=!1,ka.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+
a)}}}Object(m.a)(Uo,"EditNotificationManager",null,[1295]);class rq{constructor(a,b,c,f,l){this.EFd=this.F5a=null;this.Epb=this.vAd=!1;this.Zd=b;this.$Dc=a;this.EOa=c;this.UP=f;this.dLd=l;this.Gmh(null)}Gmh(){const a=document.getElementById(w.AFrameworkApplication.a0b);!this.Epb&&this.UP&&a&&(this.UP.rb(oa.a.qq,a,Object(I.a)(this,this.UIe,"mouseActivityHandler"),null),this.Epb=!0);this.dLd(()=>{this.dispose()})}UIe(){this.Epb&&(this.UP.Bb(oa.a.qq,document.getElementById(w.AFrameworkApplication.a0b),
Object(I.a)(this,this.UIe,"mouseActivityHandler")),this.Epb=!1);this.Hwf();return!1}Hwf(){this.vAd=!0;this.EFd||(this.EFd=new dd.a(3,2,this.$Dc,Object(I.a)(this,this.Gmh,"registerHandlerTask"),112),this.Zd.Hb(this.EFd));this.F5a||(this.zsc(null),this.F5a=new dd.a(3,2,this.$Dc,Object(I.a)(this,this.zsc,"sendPostMessageIfNecessary"),111),this.Zd.Hb(this.F5a))}zsc(){this.vAd&&(this.EOa.CWR(()=>this.EOa.result.sendMessage(Qe.a.QRl,null)),ka.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),
this.vAd=!1)}dispose(){this.Epb&&(this.UP.Bb(oa.a.qq,document.getElementById(w.AFrameworkApplication.a0b),Object(I.a)(this,this.UIe,"mouseActivityHandler")),this.Epb=!1)}}Object(m.a)(rq,"UserActivityHostNotificationManager",null,[1294,107]);var il=d(134),Zq=d(252);class Wp{constructor(){this.Da=null}get name(){return"Common.App.EditNotification"}init(){w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ff(Object(I.a)(this,this.en,"onFullAppSettingsReady"))}en(){Wp.vXi&&0<Wp.L4d&&(this.Da.register(Vp,
"Common.App.HostNotification.EditNotificationEventSource").ma(),this.Da.register(rq,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").ma().oa(()=>new rq(6E4,il.a.instance,Zq.a.Lt(this.Da.Ia("Postmessage.IHostPostmessenger")),ja.a.instance,w.AFrameworkApplication.Wga)),this.Da.register(Uo,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").ma().oa(()=>new Uo(Wp.L4d,il.a.instance,
Zq.a.Lt(this.Da.Ia("Postmessage.IHostPostmessenger")),this.Da.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.Da.qb("Common.Interface.IUserActivityHostNotificationManager"),Wp.wXi,Wp.tXi)),this.Da.resolve("Common.Interface.IEditNotificationManager"),ka.ULS.shipAssertTag(38086291,209,0<Wp.L4d,"EditNotification Interval is less than or equal to 0."))}Yb(a){this.Da=a}dispose(){}static get L4d(){return w.AFrameworkApplication.fa?parseInt(w.AFrameworkApplication.fa.appSettings.EditNotificationTimeIntervalMs||
"300000"):3E5}static get tXi(){return w.AFrameworkApplication.fa?parseInt(w.AFrameworkApplication.fa.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||"0"):0}static get vXi(){return!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("EditNotificationIsEnabled")}static get wXi(){return!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("EditNotificationPostMessageIsEnabled")}static main(){n.a.instance.Ac(new Wp)}}Object(m.a)(Wp,"CommonHostNotificationPackage",
null,[2,3]);class Ym{}Ym.cgd="ReactSharedHeaderMeControlFlexPane";Ym.tFa="headerui";Ym.H1b="chat_wrapper_pane";Object(m.a)(Ym,"ReactSharedHeaderConstants",null,[]);class Iu{constructor(a){this.jqf=0;this.jCd=null;this.v5h=a}get chat(){return window.swc}get isInitialized(){return!!this.chat}get I0e(){return this.v5h.value}vb(){this.isInitialized?this.yod():this.W3k(Object(I.a)(this,this.yod,"registerActionsInternal"))}yod(){ka.ULS.sendTraceTag(50595938,333,50,"Registering for chat events");try{this.isInitialized&&
(this.chat.getContainerProvider().then(a=>{a.getChatsContainer(Object(I.a)(this,this.oBk,"onChatContainerReady"))}).catch(a=>{ka.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",a)}),this.chat.getChatsCounter().then(a=>{a.onChatsCountChange(Object(I.a)(this,this.vyi,"chatCountChanged"))}).catch(a=>{ka.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",a)}),this.chat.getKeyboard().then(a=>{a.onKeyDown(Object(I.a)(this,this.rBk,"onChatKeyPress"))}).catch(a=>
{ka.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",a)}))}catch(a){ka.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",a)}}vyi(a){ka.ULS.sendTraceTag(50595970,333,50,"Chat count:{0}",a);if(!a)this.I0e.nBk();else if(1===a&&!this.jqf){const b=document.getElementById(this.jCd?this.jCd:Ym.H1b);b?this.I0e.sBk(b,Object(I.a)(this,this.OHl,"transferFocusToChat")):ka.ULS.sendTraceTag(50595971,333,10,"Chat parent is null")}this.jqf=a}oBk(a){this.jCd=a}rBk(a){a.ctrlKey&&
"f6"===a.key.toLowerCase()&&this.NHl(a.shiftKey)}W3k(a){Rg.a.instance.rb(oa.a.UCl,window.self,()=>{a();return!0})}OHl(){ka.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&this.chat.getFocuser().then(a=>{a.focusConversationInput()}).catch(a=>{ka.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",a)})}catch(a){ka.ULS.sendTraceTag(50595974,333,10,"Failed to transfer focus to chat: {0}",a)}}NHl(a){ka.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat");
this.I0e.pBk(a)}}Object(m.a)(Iu,"ChatManager",null,[1309]);class iw{constructor(){this.Ma=new Pc.a;this.Cuf=!1}qhi(a){this.Ma.addHandler("OnTopRowControlsCreatedEvent",a)}Ygi(a){this.Ma.addHandler("OnRenameTextboxStatusChangedEventKey",a)}get gHl(){return this.Cuf}BYk(){this.Cuf=!1;this.Ma.raiseEvent("OnTopRowControlsDisposingEvent")}wkh(a){this.Ma.raiseEvent("OnRenameTextboxStatusChangedEventKey",a?"true":"false")}}Object(m.a)(iw,"HeaderEventSource",null,[]);var sq=d(204);class Ju{constructor(a,
b,c,f,l){this.wHc=null;this.Pd=a;this.NK=b;this.UP=c;this.t9h=f;this.Ca=l}Fmh(a,b,c,f=null){const l=this.Pd.Fc(b);l.parent=c;l.uJ=!0;f&&l.Lca(f);this.UP.d8(b,a,!1);this.t9h.d8(b,a,!1);b=new sq.DOMFocusListing(()=>a);b.Ro(2);b.Ro(1);b.Ro(8);b.Ro(5);b.Ro(3);b.Ro(6);this.Pd.zja(()=>a,l,b).uX=!0;b=x.KeyInputManager.Qa(B.a.$q,0);c=x.KeyInputManager.Qa(B.a.$q,4);l.Bp(b);l.Bp(c)}onFlexPaneOpen(a){this.Fmh(a,Ym.cgd,Ym.tFa);this.Pd.vf(Ym.cgd);this.NK.e3(Ym.cgd)}onFlexPaneClose(){this.NK.Eo(Ym.cgd);this.Pd.vf(Ym.tFa)}sBk(a,
b){this.wHc||(this.wHc=b,this.Fmh(a,Ym.H1b,D.AFrame.gE,Object(I.a)(this,this.qBk,"onChatFocus")));this.Pd.vf(Ym.H1b);this.NK.e3(Ym.H1b)}qBk(){this.wHc&&this.wHc()}nBk(){this.NK.Eo(Ym.H1b);this.Pd.tTc(D.AFrame.JW)}pBk(a){this.Ca.processAction(a?G.a.r6d:G.a.Pzd,2)}}Object(m.a)(Ju,"ReactSharedHeaderFocusManager",null,[1109]);var jy=d(533);class Ku{constructor(a){this.Ca=a}vb(){this.Ca.ya(G.a.GTc,ie.a.frame,Object(I.a)(this,this.o5g,"navigateToUpsellPage"));this.Ca.ya(G.a.n8i,ie.a.frame,Object(I.a)(this,
this.launchUpsellExperience,"launchUpsellExperience"));this.Ca.ya(G.a.S$k,ie.a.frame,vf.ActionManager.Sg);this.Ca.ya(G.a.eqh,ie.a.frame,vf.ActionManager.Sg)}o5g(a,b,c,f,l){if(1===c)return 32;a=8;2===c&&(c=this.Z9d(l,"experience","gopremiumribbon"),l=yg.a.SW("2116536"),l=yg.a.q7a(l,"ocid",jy.b(w.AFrameworkApplication.Aa.ob.zk,w.AFrameworkApplication.Aa.ob.LJa,c)),Bd.a.En(l,"_blank",void 0,"NavigateToUpsellPage"),a=32,this.Ca.processAction(G.a.eqh,2),ka.ULS.sendTraceTag(38929747,340,50,"User directed to POC"));
return a}launchUpsellExperience(a,b,c,f,l){if(1===c)return 32;var y=8;2===c&&(ka.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon"),(y=Ib.a.instance.qb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))?(a=this.Z9d(l,"experience","gopremium"),l=this.Z9d(l,"dimeCampaignId",null),y.launchUpsellExperience(a,l),y=32):(ka.ULS.sendTraceTag(594874952,340,15,"ApplicationFeatureHelper not available"),y=this.o5g(a,b,c,f,l)));return y}Z9d(a,b,c){a&&a[b]&&(c=Object(qa.a)(String,
a[b]));return c}}Object(m.a)(Ku,"UpsellActor",null,[1308]);class Lu{constructor(){this.Da=null}get name(){return"Common.App.Header"}init(){Ib.a.instance.resolve("Common.App.Header.IUpsellActor").vb();Ib.a.instance.resolve("Common.App.Header.IChatManager").vb()}dispose(){}Yb(a){this.Da=a;this.Da.register(iw,"Common.App.Header.HeaderEventSource").ma();this.Da.register(Ku,"Common.App.Header.UpsellActor").as("Common.App.Header.IUpsellActor").ma().oa(()=>new Ku(w.AFrameworkApplication.Ra));this.Da.register(Ju,
"Common.App.Header.ReactSharedHeaderFocusManager").as("Common.App.Header.IReactSharedHeaderFocusManager").ma().oa(()=>new Ju(w.AFrameworkApplication.Aa.$r,w.AFrameworkApplication.Aa.gx,w.AFrameworkApplication.Aa.nS,w.AFrameworkApplication.Aa.Lmb,w.AFrameworkApplication.Ra));this.Da.register(Iu,"Common.App.Header.ChatManager").as("Common.App.Header.IChatManager").ma().oa(()=>new Iu(this.Da.oe("Common.App.Header.IReactSharedHeaderFocusManager")))}static main(){n.a.instance.Ac(new Lu)}}Object(m.a)(Lu,
"CommonAppHeaderPackage",null,[2,3]);class jw{constructor(a,b,c,f=null,l=null){this.zF=a;this.IUb=b;this.FUb=c;this.aqf=f;this.AXb=l}RRc(a){const b=new Sys.StringBuilder(this.zF.Orc);b.append("RoamingServiceHandler.ashx?action=");b.append("getFirstRunExperienceSettings");b.append("&");b.append(this.fce(a));b.append("&");b.append(w.AFrameworkApplication.gh);w.AFrameworkApplication.Me.zj(b.toString(),1,null,null,!0,2,Object(I.a)(this,this.ZEa,"getRequestSuccessCallback"),Object(I.a)(this,this.Uka,"getRequestFailureCallback"),
null)}Lwb(a){var b=new Sys.StringBuilder(this.zF.Orc);b.append("RoamingServiceHandler.ashx?action=");b.append("saveFirstRunExperienceSettings");b.append("&");b.append(w.AFrameworkApplication.gh);b=b.toString();a=De.c(a);w.AFrameworkApplication.Me.zj(b,2,a,null,!0,4,Object(I.a)(this,this.vQk,"postRequestSuccessCallback"),Object(I.a)(this,this.Eaa,"postRequestFailureCallback"),null)}ZEa(a){let b=!1,c=null;try{if(0<a.data.ee.length){const f=Object(qa.a)(Object,De.a(a.data.ee)),l=f?f[this.zF.nUd]:null;
l&&(c=Object(qa.a)(Object,De.a(l.toString())))}b=!0}catch(f){this.Uka(null)}b&&this.IUb&&this.IUb(a.data,c)}Uka(a){this.FUb&&this.FUb(a?a.data:null)}vQk(a){this.aqf&&this.aqf(a?a.data:null)}Eaa(a){this.AXb&&this.AXb(a?a.data:null)}fce(a){const b=new Sys.StringBuilder("requestedsettings=");for(let c=0;c<a.count;c++)b.append(a.ga(c)),c<a.count-1&&b.append(";");return b.toString()}}Object(m.a)(jw,"FirstRunExperienceRequestHandler",null,[]);var Mu=d(407);class kw{constructor(){this.oUb=this.aBc=this.zF=
null}O1e(a){a?(this.zF=a,this.EZj()&&(ka.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),a=new Na.a,a.add(this.zF.nUd),this.aBc=new jw(this.zF,Object(I.a)(this,this.ZEa,"getRequestSuccessCallback"),Object(I.a)(this,this.Uka,"getRequestFailureCallback"),null,Object(I.a)(this,this.Eaa,"postRequestFailureCallback")),this.aBc.RRc(a)),(this.zF.Isg||w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",
!1))&&this.P1e()):ka.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}EZj(){try{if(this.zF.Isg)return!0;if(!w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||w.AFrameworkApplication.fa.ka("IsAnonymousUser"))return!1;if(this.zF.qVj||this.zF.aCb||w.AFrameworkApplication.fa.ka("IsO365ConsumerHost"))return!0;const a=w.AFrameworkApplication.fa.Ha("FlightId");return-1!==(a?a.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(a){ka.ULS.sendTraceTag(576582624,
306,10,"Error checking setting {0}",a?a.toString():null)}return!1}Uth(a){const b={},c={};c.FREDisplayedDate=(new Date).toUTCString();c.VersionDisplayed=a;c.RemindMeLater=!1;b[this.zF.nUd]=De.c(c);ka.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.aBc&&this.aBc.Lwb(b)}ZEa(a,b){a=a?+a.wv-+a.iu:-1;a>this.zF.qsh?ka.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",
a,this.zF.qsh):b?this.Iul(b)?(ka.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.zF.V3g),this.P1e()):(this.O3d(!1),ka.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(ka.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.P1e())}Uka(a){this.O3d(!1);
ka.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",a?a.Ke:-1)}Eaa(a){ka.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",a?a.Ke:-1)}P1e(){this.O3d(!0);var a=Ib.a.instance.qb("Common.ISystemInitiatedFeedback");a?this.bCh(a):(ka.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",
!0)&&((a=Ib.a.instance.Ia("Common.ISystemInitiatedFeedback"))?a.execute(b=>{this.bCh(b)}):ka.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}bCh(a){if(a){var b=this.zF.E6i;b&&(w.AFrameworkApplication.uk(b),w.AFrameworkApplication.ECb(b));ka.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",b);a.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.oUb=Object(I.a)(this,this.bDk,"onFirstRunExperienceCampaignEvent"),
window.addEventListener("FGWebSurfaceEvent",this.oUb,!0),window.addEventListener("FRELaunchedEvent",this.oUb,!0)):(ka.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.Uth(this.zF.currentVersion))}else ka.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}bDk(a){if(a){var b=a.detail;a=a.type;var c=this.zF&&this.zF.HHf?this.zF.HHf.split("-")[0]:null;if("FRELaunchedEvent"===a||c&&b&&b.id&&-1!==b.id.indexOf(c))b.success&&(ka.ULS.sendTraceTag(51675546,
306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.Uth(this.zF.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.oUb,!0),window.removeEventListener("FRELaunchedEvent",this.oUb,!0))}}Iul(a){if("RemindMeLater"in a&&"FREDisplayedDate"in a){if("true"===a.RemindMeLater.toString()&&(+new Date-+new Date(a.FREDisplayedDate.toString()))/36E5>this.zF.V3g)return!0}else if(w.AFrameworkApplication.fa.ka("WacShowVersionBasedFREToAllUsers")&&
"VersionDisplayed"in a&&a.VersionDisplayed<this.zF.currentVersion)return ka.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}O3d(a){w.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&Mu.a.dispatch("FREDecisionEvent",{["show"]:a})}}Object(m.a)(kw,"FirstRunExperienceLauncher",null,[1283]);class Nu{constructor(){this.Da=null}get name(){return"Common.App.FirstRunExperienceLauncher"}Yb(a){this.Da=
a;this.Da.register(1283,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").ma().oa(()=>new kw)}init(){}dispose(){}static main(){n.a.instance.Ac(new Nu)}}Object(m.a)(Nu,"FirstRunExperienceLauncherPackage",null,[2,3]);class Bt{constructor(){this.sAd={}}wai(a){this.sAd[a.id.toString()]=a}Tyk(a){const b=this.sAd;for(let c in b)b[c].notify(a,!1);this.sAd={}}UVk(a,b){b&&this.wai(b);return this.Fah(a,b)}S4d(a){this.Tyk(a)}sWf(a,b){a.notify(b,!0)}}Object(m.a)(Bt,"AEventEmitter",null,[1292]);
var Ct;(function(a){a[a.notStarted=0]="notStarted";a[a.waiting=1]="waiting";a[a.shouldRetry=2]="shouldRetry";a[a.complete=3]="complete"})(Ct||(Ct={}));Object(m.b)("EventResultState",Ct);class ws{constructor(){this._state=0}get state(){return this._state}set state(a){ka.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:Ct[this._state],["NewState"]:Ct[a]},"ResultType",this.iag());this._state=a}}Object(m.a)(ws,"AEventResult",null,[1325]);class lw extends ws{constructor(){super();
this.kPd=this.wXb=null;this.state=0;this.KGd=this.Rif=!1}get UR(){return this.wXb}get sMa(){return this.kPd}get JQj(){return this.Rif}iag(){return"GetMoreInfo Result"}}Object(m.a)(lw,"GetMoreInfoResult",ws,[1324,1325]);var mw=d(442),Ou=d(534);class yp{constructor(a,b,c,f,l,y,H,Q){this.Ca=a;this.hi=b;this.kI=c;this.Bha=f;this.Zd=l;this.EUb=y;this.yZh=H;this.PGc=Q}K2k(){this.qIb.ya(G.a.sJb,ie.a.frame,Object(I.a)(this,this.sJb,"openUrlInNewTab"));this.qIb.ya(G.a.zNe,ie.a.frame,Object(I.a)(this,this.zNe,
"openDocumentUrl"));w.AFrameworkApplication.vda?this.rwg():this.qIb.ra(G.a.CQc,ie.a.frame,Object(I.a)(this,this.CQc,"documentLoaded"),96)}sJb(a,b,c,f,l){l&&l.MenuItemId&&(ka.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:l.SourceControlId,["AppType"]:Ou.a[this.Wfa]}),Bd.a.En(l.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}zNe(a,b,c,f,l){if(l&&l.MenuItemId){const y=w.AFrameworkApplication.fa.ka("WacInTabOpenMRUIsEnabledForUiHost"),H=w.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures");
ka.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",y,H);if(y&&H){ka.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:l.SourceControlId,["AppType"]:Ou.a[this.Wfa]});a=l.MenuItemId.toString();const Q={};Q[ai.a.FLb]="1";Q[ai.a.documentUrl]=a;Q[ai.a.reason]=mw.a.open;ka.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");w.AFrameworkApplication.KT().execute(ia=>{ia.sendMessage(Qe.a.XDa,Q)})}else this.sJb(a,
b,c,f,l)}return 32}CQc(){this.rwg();return 32}odb(a,b,c=""){if(b&&b.iu){const f=mg.a[b.status];b=b.iu.getTime();const l=this.RF()-b;ka.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:a,["RequestStatus"]:f,["ElapsedMs"]:l,["StartTime"]:b,["Notes"]:c})}else ka.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:a})}rwg(){var a=w.AFrameworkApplication.fa.ka("QPGVCI"),b=yg.a.JT(document.URL,"wdNewAndOpenCt",
a);if(b){b=parseInt(b);var c=yg.a.JT(document.URL,"wdPreviousSession",a);a=yg.a.JT(document.URL,"wdPreviousCorrelation",a);var f=w.AFrameworkApplication.fa.ka("NAOPLP");if(w.AFrameworkApplication.vda){var l=w.AFrameworkApplication.vda.getTime();!b||b>l?ka.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:b,["DocumentLoadedTime"]:l,["SessionId"]:c,["Correlation"]:a}):ka.ULS.sendTraceTag(5849683,202,f?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",
{["ClickToLoadTime"]:l-b,["ClickTimestamp"]:b,["SessionId"]:c,["Correlation"]:a})}else ka.ULS.sendTraceTag(5849681,202,f?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{["ClickTimestamp"]:b,["SessionId"]:c,["Correlation"]:a})}}get qIb(){return this.Ca.value}get Vlc(){return this.hi.value}get v5g(){return this.kI.value}get Wfa(){return this.Bha.value}get Ygd(){return this.Zd.value}get RF(){return this.EUb}get Zna(){return this.yZh.value}get tMa(){return this.PGc.value}static get instance(){return yp.La||
(yp.La=yp.Fr())}static Fr(){return new yp(new Bb.a(()=>w.AFrameworkApplication.Ra),new Bb.a(()=>w.AFrameworkApplication.Me),new Bb.a(()=>w.AFrameworkApplication.Aa),new Bb.a(()=>w.AFrameworkApplication.Aa.ob.zk),new Bb.a(()=>w.AFrameworkApplication.Ae),()=>(new Date).getTime(),new Bb.a(()=>w.AFrameworkApplication.Aa.ob.Zna),new Bb.a(()=>w.AFrameworkApplication.tMa))}}yp.La=null;Object(m.a)(yp,"NewAndOpenCommonHelpers",null,[1291]);class nw{constructor(a,b,c){this.iGc=this.nn=null;this.nNd=0;this.K6h=
a;this.Zd=b;this.kef=c}Xji(){this.nNd=this.zMb+1}PWe(a){this.nn&&(this.Zd.Lg(this.nn),this.nn=null);a&&(this.nNd=0)}RAl(a){const b=this.jGl;0<=b?(this.Xji(),this.PWe(!1),this.nn=new dd.a(4,1,b,a,107),this.Zd.Hb(this.nn)):(this.PWe(!0),ka.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.kef}))}get zMb(){return this.nNd}get jGl(){return this.zMb>=this.Ivh.length?-1:this.Ivh[this.zMb]}get Ivh(){if(!this.iGc){const a=(this.K6h.value||"0").split(",");this.iGc=[];for(let b=0;b<a.length;b++){const c=
parseInt(a[b]);isNaN(c)?ka.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.kef,["Entry"]:a[b]}):Array.add(this.iGc,c)}}return this.iGc}}Object(m.a)(nw,"RetryHelper",null,[]);class Zm extends Bt{constructor(a,b){super();this.sia=a;this.aYb=new nw(b,this.Alc.Ygd,"GetMoreInfo");this.fy=new lw}ytk(){this.WHe("Document opened")}oMi(a){return()=>{this.WHe(a,!0)}}Fah(a,b=null){ka.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",
{["Trigger"]:a});3===this.fy.state?(b&&this.sWf(b,this.fy),ka.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:a})):this.WHe(a);return this.fy}WHe(a,b=!1){this.aYb.PWe(!b);1===this.fy.state?ka.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:a,["RetryIndex"]:this.aYb.zMb}):(ka.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:a,["RetryIndex"]:this.aYb.zMb}),this.fy.state=1,b=
String.format("{0}GetMoreInfoHandler.ashx?{1}",this.Alc.Zna,w.AFrameworkApplication.gh),this.Alc.Vlc.iW(b,1,null,null,[Zm.Qpf,Zm.Ntf],5,this.rLi(),this.qLi(a),null))}rLi(){return a=>{var b=!1;let c=!1;var f=!1,l;w.AFrameworkApplication.fa.ka("GetMoreInfoDataFromResponseBody")&&(a.data.ee?({Nu:l}=De.d(a.data.ee)).returnValue?l?(f=!0,this.fy.kPd=l.StorageServiceDisplayName,this.fy.wXb=Zm.mtg(l.PersonalFileStorageUrl)?l.PersonalFileStorageUrl:"",""===this.fy.UR&&"SharePointOnlineConsumer"===w.AFrameworkApplication.fa.Ha("FileSource")&&
(this.fy.wXb=yg.a.Poa(w.AFrameworkApplication.breadcrumbFolderUrl)),b=""===this.fy.UR&&""!==this.fy.sMa):ka.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):ka.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):ka.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));
f||((l=a.data.yj)?(this.fy.kPd=(l[Zm.Ntf]||"").toString(),b=(l[Zm.Qpf]||"").toString(),this.fy.wXb=Zm.mtg(b)?b:"",""===this.fy.UR&&"SharePointOnlineConsumer"===w.AFrameworkApplication.fa.Ha("FileSource")?(this.fy.wXb=yg.a.Poa(w.AFrameworkApplication.breadcrumbFolderUrl),b=""===this.fy.UR&&""!==this.fy.sMa):b=""===b&&""!==this.fy.sMa):(ka.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),c=!0));f=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",
this.aYb.zMb,c,b,f);this.Alc.odb("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",a.data,f);this.Vvh(3,b,c)}}qLi(a){return b=>{this.Alc.odb("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",b.data,"Failure");this.Vvh(2);this.aYb.RAl(this.oMi(a))}}Vvh(a,b=!1,c=!1){this.fy.state=a;this.fy.Rif=b;this.fy.KGd=c;this.S4d(this.fy)}get Alc(){return this.sia.value}static get instance(){return Zm.La||(Zm.La=Zm.Fr())}static Fr(){return new Zm(new Bb.a(()=>yp.instance),new Bb.a(()=>w.AFrameworkApplication.Hlj))}static mtg(a){if(!a)return ka.ULS.sendTraceTag(5849624,
202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(ma.a.rg(a).startsWith("https://"))return!0;ka.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}Zm.Qpf="PersonalFileStorageUrl";Zm.Ntf="StorageServiceDisplayName";Zm.La=null;Object(m.a)(Zm,"GetMoreInfoActor",Bt,[]);class Vo{constructor(a,b,c,f,l){this.c_h=6E4;this.cjg="inactive";this.zwf="active";this.lia=!0;this.Zd=a;this.aZh=b;this.EUb=c;this.pHc=f;this.Ma=new Pc.a;l&&this.JAl();this.rlf=
this.E8f()}Pwf(a){this.Ma.addHandler(this.zwf,a)}Tci(a){this.Ma.addHandler(this.cjg,a)}JAl(){const a=new dd.a(5,2,this.c_h,Object(I.a)(this,this.BLj,"inactiveLoop"),108);this.CLj.Hb(a)}BLj(){const a=this.E8f(),b=this.RF()-a;b>this.ywd&&this.lia&&(ka.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:b}),this.lia=!1,this.Ma.raiseEvent(this.cjg));a-this.rlf>this.ywd&&(this.lia=!0,this.Ma.raiseEvent(this.zwf));this.rlf=a}get CLj(){return this.Zd.value}get E8f(){return this.aZh}get RF(){return this.EUb}get ywd(){return this.pHc.value}static get instance(){return Vo.La||
(Vo.La=Vo.Fr())}static Fr(){return new Vo(new Bb.a(()=>il.a.instance),()=>w.AFrameworkApplication.sre.getTime(),()=>(new Date).getTime(),new Bb.a(()=>w.AFrameworkApplication.ywd),!0)}}Vo.La=null;Object(m.a)(Vo,"InactivityManager",null,[]);var xs=d(937);class Pu extends ws{constructor(){super();this.M2h=this.Knf=this.Jnf=null;this.state=this.yuf=0;this.KGd=!1}get uJe(){return this.Jnf}get W4g(){return this.Knf}get mGl(){return this.yuf}iag(){return"MruActor Result"}}Object(m.a)(Pu,"MruResult",ws,[1327,
1325]);class Qu{constructor(a,b,c){this.task=null;this.Abb=a;this.hvk=b;this.taskManager=c;this.retryCount=this.Y$b=0;this.oMd=this.Vcc=null}v0j(a,b){return a===ua.a.q8d||20===b||18===b||3===b}Y1j(a){return 3===a||5===a||6===a||7===a||9===a||10===a||11===a||12===a||13===a||14===a||15===a||16===a||23===a||26===a||27===a||28===a}get qmd(){return this.oMd}reset(){this.Y$b=this.retryCount=0;this.oMd=this.Vcc=null;this.task&&(this.taskManager.Lg(this.task),this.task=null)}tPj(a,b,c,f){this.oMd=String.format("{0}_{1}",
c,f);if(this.retryCount>=this.hvk)return ka.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.v0j(c,f))return ka.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.Y1j(f)&&1<=this.Y$b)return this.Vcc=c,!1;b=Math.max(b,this.Abb*Math.pow(2,this.Y$b));if(26===f)b=Math.max(b,3E4);else if(27===f||28===f)b=Math.max(b,6E4);9===f||412===c&&(null==this.Vcc||412!==this.Vcc)?b=500:this.Y$b+=1;this.Vcc=c;this.retryCount+=1;this.task&&this.taskManager.Lg(this.task);
ka.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",b);this.task=new dd.a(2,1,b,a,107);this.taskManager.Hb(this.task);return!0}}Object(m.a)(Qu,"RetryManager",null,[]);var $q=d(223),tg=d(70);class ow{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(m.a)(ow,"WriteOptions",null,[]);class xn extends Bt{constructor(a,b,c,f,l,y,H){super();this.sia=a;this.T1h=b;this.PPa=new Qu(w.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",
5E3),w.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.gP.Ygd);this.uQa=new Qu(w.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),w.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.gP.Ygd);this.z5h=c;this.Vvf=f;this.Q$h={};this.J7=new Pu;this.XYh=l;this.RDc="";this.uF=y;this.Cff=H}get Fzd(){return this.Q$h}T4k(){this.gP.qIb.ya(G.a.uph,ie.a.frame,
Object(I.a)(this,this.t9k,"renameMruEntry"))}t9k(){return this.Y$e("Rename")}Gtk(){this.y2g("File Opened")}Htk(){this.y2g("IntervalUpdate")}y2g(a){ka.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:a});this.Y$e(a)}AQ(a){(a=ma.a.AQ(a))&&a.startsWith(".")&&(a=a.substring(1,a.length));return a}V3f(){switch(this.gP.Wfa){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}zwj(a){var b=this.XYh();
if(!b)return null;const c=new ow;c.documentUrl=this.Cff.value?encodeURI(b):b;c.mruItemId=this.RDc;c.app=this.V3f();if(b=this.uF())c.folderName=b.breadcrumbFolderName,b=b.rx,c.documentName=ma.a.iH(b),c.documentExt=this.AQ(b);a&&(c.documentName?c.documentName.length?255<=c.documentName.length?a.set("DocumentNameLength","Long"):2084<=c.documentName.length&&a.set("DocumentNameLength","VeryLong"):a.set("DocumentNameLength","0"):a.set("DocumentNameLength","Null"));return JSON.stringify(c)}Y$e(a,b=!1){if(4===
this.gP.Wfa&&!w.AFrameworkApplication.AQc)return 2;var c=$q.a.aA();c&&(c.set("Trigger",a),c.set("IsRetry",b?"true":"false"),c.set("MruIdSent",this.RDc?"true":"false"),c.set("URLEncoded",this.Cff.value?"true":"false"));$d.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",c);a=this.zwj(c);if(!a)return b=!w.AFrameworkApplication.Hnb,c&&(c.set("WebEditingIsEnabled",w.AFrameworkApplication.Hnb?"true":"false"),c.set("ProtectedFile",w.AFrameworkApplication.fK?"true":"false")),$d.Health.instance.recordKpiFailure("WriteMru",
"MissingDocumentUrl",b,!1,Object.assign(new Mj.a,{extendedProperties:c})),2;this.uQa&&!b&&this.uQa.reset();c=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.gP.Zna,this.Kvg);this.Vvf?this.Fzd["X-FileId"]=w.AFrameworkApplication.gh:c+=String.format("&{0}",w.AFrameworkApplication.gh);w.AFrameworkApplication.Od&&(this.Fzd["X-Office-AudienceGroup"]=Object(qa.a)(String,w.AFrameworkApplication.Od.AudienceGroup)||"");this.Fzd["X-Timeout"]=15E3;return this.gP.Vlc.zj(c,2,a,this.Fzd,!0,5,Object(I.a)(this,
this.DVl,"writeMruV2EntryOnServerSuccessCallback"),Object(I.a)(this,this.RPi,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}DVl(a){this.nfg(a.data)}nfg(a){const b=$q.a.aA();this.uQa&&(b&&this.uQa.qmd&&(b.set("LastError",this.uQa.qmd),b.set("NumRetries",this.uQa.retryCount.toString())),this.uQa.reset());const c=xs.c(a.ee);c&&c.diagnostics_data&&(this.RDc=c.diagnostics_data.mru_id);a=+a.wv-+a.iu;b&&b.set("RequestDuration",a.toString());$d.Health.instance.recordKpiSuccess("WriteMru",
Object.assign(new Mj.a,{extendedProperties:b}))}RPi(a){if(a.data.Ke===ua.a.D3b)this.nfg(a.data);else{var b=a.data.Ke===ua.a.$oc,c=$q.a.aA();this.Kfg(this.uQa,a,this.FPi(),c);c&&(c.set("StatusCode",a.data.Ke.toString()),b||this.cSd(a.data,c));$d.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",a.data.Ke),b,!1,Object.assign(new Mj.a,{extendedProperties:c}))}}FPi(){return()=>{this.Y$e("Retry",!0)}}Nlj(){this.Jfd("Polling")}Mlj(){this.Jfd("Retry",!0)}Atk(){this.Jfd("Open")}ztk(){this.Jfd("Activity")}Jfd(a,
b=!1){ka.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:a});const c=$q.a.aA();c&&(c.set("Trigger",a),c.set("IsRetry",b?"true":"false"));$d.Health.instance.recordKpiUsage("GetMru",0,"smartfio",c);this.PPa&&!b&&this.PPa.reset();this.sLi(Object(I.a)(this,this.Plj,"getMruV2FromServerSuccessCallback"),Object(I.a)(this,this.Llj,"getMruFromServerFailureCallback"))}cSd(a,b){a&&a.yj&&(a=a.yj["X-CorrelationId"])&&b.set("ServerCorrelationId",a)}tbk(a,b){a&&(b&&b.set("RequestDuration",
(+a.wv-+a.iu).toString()),$d.Health.instance.recordKpiSuccess("GetMru",Object.assign(new Mj.a,{extendedProperties:b})))}Plj(a){this.Qlj(a)}Qlj(a){var b="";let c=null,f=null,l=null;const y=xs.c(a.data.ee);y&&(c=y.places?y.places.items:[],f=y.documents?y.documents.items:[],(l=xs.a(y,!1))&&(b=De.c(l)));w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.ob.oGa&&tg.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(b,!0));b=$q.a.aA();this.PPa&&(b&&this.PPa.qmd&&(b.set("LastError",this.PPa.qmd),
b.set("NumRetries",this.PPa.retryCount.toString())),this.PPa.reset());l||c||f?(this.gP.odb("MruActor.GetMruV2FromServerSuccessCallback",a.data,"Success"),this.qyd(3,l,c,f),this.tbk(a.data,b)):(this.gP.odb("MruActor.GetMruV2FromServerSuccessCallback",a.data,"Failure: Invalid JSON"),b&&this.cSd(a.data,b),$d.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new Mj.a,{extendedProperties:b})),this.qyd(3,null,null,null,!0));this.S4d(this.J7)}Kfg(a,b,c,f){let l=0,y=0;const H=
xs.c(b.data.ee);H&&(null!=H.response_code&&(l=H.response_code,f&&f.set("MruResponseCode",l.toString()),9===l&&(this.RDc="")),H.error_data&&null!=H.error_data.retry_after_ms&&(y=H.error_data.retry_after_ms,f&&f.set("ExpectedRetryAfter",y.toString())));a&&(b=a.tPj(c,y,b.data.Ke,l),f&&(f.set("CurrentRetryCount",a.retryCount.toString()),f.set("RetryScheduled",b?"true":"false")))}Llj(a){this.Olj(a)}Olj(a){const b=a.data.Ke===ua.a.$oc,c=$q.a.aA();c&&(c.set("StatusCode",a.data.Ke.toString()),b||this.cSd(a.data,
c));this.gP.odb("MruActor.GetMruFromServerFailureCallback",a.data,"Failure");this.qyd(2);this.Kfg(this.PPa,a,Object(I.a)(this,this.Mlj,"getMruFromServerRetryTask"),c);$d.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",a.data.Ke),b,!1,Object.assign(new Mj.a,{extendedProperties:c}));this.S4d(this.J7);w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.ob.oGa&&tg.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",
!1)))}qyd(a,b=null,c=null,f=null,l=!1){if(3!==this.J7.state||3===a)this.J7.Jnf=b,this.J7.Knf=c,this.J7.M2h=f,this.J7.state=a,this.J7.KGd=l,this.J7.yuf=this.gP.RF()}Fah(a,b){ka.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:a,["ResultState"]:this.J7.state});b&&3===this.J7.state&&this.sWf(b,this.J7);return this.J7}sLi(a,b){this.qyd(1);let c;const f={};c=String.format(this.gP.Zna+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.V3f(),this.Kvg);this.z5h.value||
(c+="&entity=docs");w.AFrameworkApplication.Od&&(f["X-Office-AudienceGroup"]=Object(qa.a)(String,w.AFrameworkApplication.Od.AudienceGroup)||"");this.Vvf?f["X-FileId"]=w.AFrameworkApplication.gh:c+=String.format("&{0}",w.AFrameworkApplication.gh);this.gP.Vlc.zj(c,1,null,f,!0,5,a,b,null)}get gP(){return this.sia.value}get Kvg(){return this.T1h.value}static get instance(){return xn.La||(xn.La=xn.Fr())}static Fr(){return new xn(new Bb.a(()=>yp.instance),new Bb.a(()=>bb.a.He(w.AFrameworkApplication.lcid).name),
new Bb.a(()=>w.AFrameworkApplication.Aa.ob.hD),w.AFrameworkApplication.fa.ka("MruWriteFileIdInHeader"),()=>w.AFrameworkApplication.Aa.ob.bda,()=>w.AFrameworkApplication.du,new Bb.a(()=>w.AFrameworkApplication.fa.ka("OICEncodeUrlIsEnabled")))}}xn.La=null;Object(m.a)(xn,"MruActor",Bt,[]);class pw{constructor(){this.FZb=this.Lqf=this.Da=null;this.Bo=!1}get name(){return"Common.App.NewAndOpen.Core"}Yb(a){this.Da=a;a.register(1291,"Common.INewAndOpenCommonHelpers").ma().oa(()=>yp.instance);a.register(1292,
"Common.IEventEmitter<Common.IGetMoreInfoResult>").ma().oa(()=>Zm.instance);a.register(1292,"Common.IEventEmitter<Common.IMruResult>").ma().oa(()=>xn.instance)}init(){w.AFrameworkApplication.fa.ff(()=>{this.AFa()})}AFa(){this.Da.resolve("Common.INewAndOpenCommonHelpers");this.Da.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.Da.resolve("Common.IEventEmitter<Common.IMruResult>");var a=!1;yp.instance.K2k();w.AFrameworkApplication.Axa&&(a=!0);w.AFrameworkApplication.JTe&&(xn.instance.Atk(),
0<w.AFrameworkApplication.X4g&&this.zxf(),this.rql(),a=!0);w.AFrameworkApplication.tMa&&a&&Zm.instance.ytk();w.AFrameworkApplication.iPl&&(a=xn.instance,a.T4k(),a.Gtk(),il.a.instance.Hb(this.jPl))}rql(){Vo.instance.Pwf(Object(I.a)(xn.instance,xn.instance.ztk,"makeGetMruRequestActivityTrigger"));Vo.instance.Pwf(Object(I.a)(this,this.zxf,"addGetMruFromServerTask"));Vo.instance.Tci(Object(I.a)(this,this.zSi,"deleteGetMruFromServerTask"))}zSi(){il.a.instance.Lg(this.Y4g)}zxf(){il.a.instance.Hb(this.Y4g)}get Y4g(){return this.Lqf||
(this.Lqf=new dd.a(5,2,w.AFrameworkApplication.X4g,Object(I.a)(xn.instance,xn.instance.Nlj,"getMruFromServerTask"),109))}get jPl(){return this.FZb||(this.FZb=new dd.a(2,2,6E4*w.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(I.a)(xn.instance,xn.instance.Htk,"makeUpdateMruTask"),197))}dispose(){this.Bo||(this.Bo=!0,this.FZb&&(il.a.instance.Lg(this.FZb),this.FZb=null))}}Object(m.a)(pw,"CorePackageManager",null,[2,3,107]);var Oi=d(125);
class ky{constructor(a,b,c,f,l,y,H,Q,ia,wa){this.CMg=new Na.a;this.PYg=null;this.Tb=f;this.ta=l;this.Fa=c;this.Ava=H;this.jma=Q;this.wA=y;this.pa=b;this.la=ia;this.Vq=a;this.nd=wa;this.la.x2j&&(this.pa&&this.pa.fE(Object(I.a)(this,this.QH,"onSelectionChanged")),Q&&Q.R3k(this),this.Vq.$Ic(Object(I.a)(this,this.SU,"onFocusChanged")),this.nd.Szf(Object(I.a)(this,this.cnc,"onShapeViewElementUnlocked")),this.nd.Eii(Object(I.a)(this,this.fch,"onThumbnailsSetFakeImage")),this.nd.Fii(Object(I.a)(this,this.gch,
"onThumbnailsSetFocus")),this.nd.Gii(Object(I.a)(this,this.hch,"onThumbnailsSetSelected")),this.la.s1c&&this.Vq.nhi(Object(I.a)(this,this.zbh,"onSlideshowNavigationToolbarClickedHandler")),this.la.yg&&this.Vq.mhi(Object(I.a)(this,this.xbh,"onSlideshowContextMenuFocusedHandler")))}dispose(){this.Vq.Zod(Object(I.a)(this,this.SU,"onFocusChanged"));this.Vq.l7k(Object(I.a)(this,this.kCk,"onDesignerClickSuggestion"));this.nd.lph(Object(I.a)(this,this.cnc,"onShapeViewElementUnlocked"));this.nd.k9k(Object(I.a)(this,
this.fch,"onThumbnailsSetFakeImage"));this.nd.l9k(Object(I.a)(this,this.gch,"onThumbnailsSetFocus"));this.nd.m9k(Object(I.a)(this,this.hch,"onThumbnailsSetSelected"));this.la.s1c&&this.Vq.y8k(Object(I.a)(this,this.zbh,"onSlideshowNavigationToolbarClickedHandler"));this.la.yg&&this.Vq.x8k(Object(I.a)(this,this.xbh,"onSlideshowContextMenuFocusedHandler"))}QH(a,b){if(b&&b.zl&&this.pa.d0(b.zl))try{this.dFj(b.zl)}catch(c){a=String.format("AriaManager failed to handle the select changed event. Message: {0}. Stack: {1}",
c.message,c.stack),xa.a.J(17367906,822,10,a)}}dFj(a){var b=this.pa.Qf();if(1===a.length||1===b.length&&b[0].Ug){if(a=this.pa.fo()){b=new Na.a;let c=this.Q$f(a,b,Object(I.a)(this,this.Crj,"getShapeName"));c||b.count||(c=this.jma.Rag(a,b));!c&&a.get_smartArtModelId()?c=ResourceStrings.l_AccMessageSmartArtSubIcon:ma.a.Xa(c)||(c+=ResourceStrings.L_ShapeSelected);const f=this.jma.Krj(a);({iDf:c,maf:b}=this.wBf(f,c,b));!a.Es&&a.isUnread&&({iDf:c,maf:b}=this.wBf(this.jma.Lrj(a,this.PYg),c,b));0<b.count?
this.slh(b):this.vga(c||"")}}else 1<a.length&&(a=this.jma.Slj(this.pa.Xd()),this.vga(a||""))}wBf(a,b,c){a&&(c.count?c.add(document.createTextNode(a)):b=String.format(ResourceStrings.l_ShapeAndPresenceInfo,b,a));return{iDf:b,maf:c}}SU(a,b){b=b.Shb;if(b===Oi.a.iE||b===jb.a.vg){a=this.ta.Ba;let c=null;b===Oi.a.iE?c=(a=this.Tb.Pvc.P9)?String.format(ResourceStrings.l_ThumbnailPanelWithSlideInfo,this.mab()+this.jma.Lde(a)):String.format(ResourceStrings.l_ThumbnailPanelWithSlideInfo,this.mab()):b!==jb.a.vg||
!this.pa.Fs()&&this.pa.s4()||(this.wA&&this.wA.value&&(b=this.wA.value.Rd)&&a&&b.qp&&Kj.e(a,b.Na),c=this.jma.psj());this.vga(c||"")}}setAttribute(a,b,c){a&&Ve.a.bS(a,b,c)}q6(a){this.CMg.add(a)}Q$f(a,b,c=null){try{if(a&&this.Fa)for(let f of this.CMg)if(f){const l=f(a,this.Fa.Ee?this.Fa.Ee.name:null,b,c);if(l||b&&0<b.count)return l}}catch(f){a=String.format("AriaManager failed to get provider message. Message: {0}. Stack: {1}",f.message,f.stack),xa.a.J(17662480,822,10,a)}return null}slh(a){if(this.Ava&&
this.Ava.value){const b=this.Ava.value.Ckj();if(b&&a&&0<a.count){b.firstChild&&b.removeChild(b.firstChild);const c=document.createElement("p");for(let f of a)c.appendChild(f);b.appendChild(c)}}}vlh(a,b){if(a){const c=new Na.a;let f=this.Q$f(a,c);f||c.count||(f=this.jma.Rag(a,c));0<c.count?(b&&c.add(document.createTextNode(b)),this.slh(c)):(b&&(f+=" "+b),this.vga(f||""))}}vga(a){this.Ava&&this.Ava.value&&this.Ava.value.sendNotification(a,!0)}cnc(a,b){b.presenceUser&&b.F2j&&this.vga(String.format(ResourceStrings.L_EditorLeavingHint,
b.presenceUser.userName))}kCk(a,b){this.vga(this.jma.ufj(b.Lgl,b.wCl))}fch(a,b){this.setAttribute(b.U6.image,Ve.a.hf,Ve.a.$Qa)}gch(a,b){b.hasFocus&&b.U6.isSelected&&this.vga(this.mab()+this.jma.Lde(b.U6));this.setAttribute(b.U6.Nmb,Ve.a.L7a,b.hasFocus&&b.U6.isSelected?"true":"false")}hch(a,b){b.U6.isSelected&&b.hasFocus?this.vga(this.mab()+this.jma.Lde(b.U6)):b.U6.isSelected||this.vga(this.mab());this.setAttribute(b.U6.Nmb,Ve.a.L7a,b.U6.isSelected?"true":"false")}zbh(a,b){this.vga(b.text)}Crj(a){this.PYg=
a||ResourceStrings.l_Object}xbh(a,b){this.vga(b.text)}mab(){let a="";const b=this.pa.Se();b&&1<b.length&&(b.sort((c,f)=>c.ue-f.ue),this.rtb(b)&&(a=this.jma.mab(b[0].ue+1,b[b.length-1].ue+1)));return a}rtb(a){if(!a||1>=a.length)return!1;const b=a.length;return a[b-1].ue-a[0].ue+1===b?!0:!1}}Object(m.a)(ky,"AriaManager",null,[1264,107]);var tA=d(938);class ar{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Aria"}Yb(a){this.K=a;this.K.register(862,"PowerPointWebEditor.IAriaMessageHelper").ma().oa(()=>
new tA.a(this.K.Ia("PowerpointPresence.IPresenceUserManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.Ia("PowerPointWebEditor.Graph.ICommentReader"),this.K.Ia("PowerPointWebEditor.IAppForOfficeManager"),this.K.oe("PowerPointWebEditor.IAppforOfficeClassFactory"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(1264,
"PowerPointWebEditor.IAriaManager").ma().oa(()=>new ky(this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.oe("Box4.IInteractiveViewManager"),this.K.oe("Common.Utils.IAriaNotifier"),this.K.resolve("PowerPointWebEditor.IAriaMessageHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")))}init(){}dispose(){this.K.resolve("PowerPointWebEditor.IAriaManager").dispose()}static main(){n.a.instance.Ac(new ar)}}Object(m.a)(ar,"PptAriaPackage",null,[2,3]);var qw=d(1068);class ys{constructor(){this.Priority=0;this.Context=null;this.Length=this.StartInContext=this.Start=0;this.Metadata=ys.eYi;this.Suggestions=this.TypeId=this.TraceId=null;this.CritiqueActions=this.SupportedActions=0;this.RevisionId=this.TileId=this.Explanation=
this.ExplanationLabel=this.ExplanationTitle=this.CategoryTitle=null;this.Tag=this.Status=this.BucketId=0;this.AnnotationId=null}}ys.eYi=[];Object(m.a)(ys,"Critique",null,[]);class Dt{constructor(){this.Text=null;this.Level=0;this.Source=null;this.BucketId=this.Action=0;this.Description=null;this.NumberOfInstances=0}}Object(m.a)(Dt,"Suggestion",null,[]);class rw{KNc(a){if(!a)return null;const b=[];for(const c of a)a=Object.assign(new ys,{TraceId:c.traceId,CategoryTitle:c.categoryTitle,ExplanationTitle:c.explanationTitle||
"",ExplanationLabel:c.explanationLabel||"",Explanation:c.explanation||"",TileId:c.tileId,RevisionId:c.revisionId,BucketId:c.bucketId,Status:c.status,Tag:c.tags?this.jIi(c.tags):0,Start:c.start,Length:c.length,Priority:c.priority,TypeId:c.critiqueTypeId}),c.supportedActions&&(a.SupportedActions=this.R_d(c.supportedActions)),c.suggestions&&(a.Suggestions=this.W_d(c.suggestions)),b.push(a);return b}W_d(a){if(!a)return null;const b=[];for(const c of a)(a=this.U_d(c))&&b.push(a);return b}U_d(a){if(!a)return null;
const b=Object.assign(new Dt,{BucketId:a.bucketId,Description:a.description,NumberOfInstances:a.numberOfInstances,Source:a.source,Text:a.text,Level:this.Q_d(a.confidenceLevel)});a.actions&&(b.Action=this.V_d(a.actions));return b}Q_d(a){return 1===a?0:2===a?1:2}V_d(a){let b=0;a.autoCorrect&&(b|=4);a.changeOnce&&(b|=1);a.changeAll&&(b|=2);a.readAloud&&(b|=8);return b}jIi(a){return a.consistency?1:0}R_d(a){let b=0;a.addToDictionary&&(b|=16);a.deleteText&&(b|=1);a.ignore&&(b|=2);a.ignoreAll&&(b|=4);a.ignoreCritiqueType&&
(b|=8);a.showDetails&&(b|=32);return b}}Object(m.a)(rw,"CloudALResponseTransformer",null,[1288]);var pg=d(84),ly=d(536);class Et{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua){this.ywa=a;this.Ffb=b;this.RYg=c;this.ta=f;this.Eb=l;this.ia=y;this.jc=Q;this.jm=ia;this.Gh=wa;this.Mc=H;this.AA=Ua;this.ywa.ACa(Object(I.a)(this,this.QJa,"onBeforeParagraphDisconnect"));this.ywa.fk(Object(I.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.Mc.Lfi(Object(I.a)(this,this.i$g,"onLanguageOnRangeChanged"));
this.Ffb.ACa(Object(I.a)(this,this.V7g,"onBeforeNumberListDisconnect"));this.Ffb.fk(Object(I.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged"));this.RYg.IF(Object(I.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged"))}isEnabled(a){const b=this.ta.Ba;if(!b||!b.isConnected)return!1;const c=Object.assign(new ly.a,{slideId:b.Db});this.ia.Ka(ea.a.i0a,2,c);return 0<c.quc?(xa.a.J(37025884,375,50,"{0}, current slide {1} is locked due to one more people are here. Skipping",
a,b.id),!1):!0}initialize(){this.Ile(this.ta.Ba)}dispose(){this.ywa.gLa(Object(I.a)(this,this.QJa,"onBeforeParagraphDisconnect"));this.ywa.Om(Object(I.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.Mc.A7k(Object(I.a)(this,this.i$g,"onLanguageOnRangeChanged"));this.Ffb.gLa(Object(I.a)(this,this.V7g,"onBeforeNumberListDisconnect"));this.Ffb.Om(Object(I.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged"));this.RYg.oP(Object(I.a)(this,this.onShapeChildTopologyChanged,
"onShapeChildTopologyChanged"))}QJa(a,b){this.Awc(Object(qa.a)(kf.AParagraphNode,b.node),!1)}onParagraphPropertyChanged(a,b){b.property!==ab.a.tq&&b.property!==Ab.a.listLevel||this.Awc(Object(qa.a)(kf.AParagraphNode,b.node),!1)}i$g(a,b){this.Awc(b.paragraphNode,!0)}V7g(a,b){b.node&&Object(Wa.a)(pg.a,b.node)&&this.Awc(this.AA.Uae(Object(qa.a)(pg.a,b.node)),!0)}onNumberListPropertyChanged(a,b){b.node&&Object(Wa.a)(pg.a,b.node)&&b.node.isConnected&&b.property===ab.a.Zi&&this.Awc(this.AA.Uae(Object(qa.a)(pg.a,
b.node)),!0)}onShapeChildTopologyChanged(a,b){if(a=Object(qa.a)(4,b.node))a=this.jc.mg(a),this.Ile(a)}Awc(a,b){!this.Csl(a)||b&&this.dHj(a)||(a=Object(qa.a)(118,this.jc.mg(a)),this.Ile(a))}Ile(a){if(a&&a.isConnected&&a.isSlideCritiqueReady){var b=this.Eb.je(7,C.a.zyd);b.hc(a);a.isSlideCritiqueReady=!1;b.dispose()}}Csl(a){return!!a&&a.isConnected&&this.Gh.ae(a)&&!this.jm.x9(a)&&!a.sa(zb.a.cU,!1)}dHj(a){a=a.sa(ab.a.tq,"");return!a||!a.length}}Object(m.a)(Et,"ConsistencyCheckManager",null,[1257,107]);
var km=d(159),yn=d(535);class tq{constructor(){this.d=this.p=this.w=null}}Object(m.a)(tq,"ProofingDashboardTraceMetrics",null,[]);class Hk{}Hk.bre="bs";Hk.a4c="bd";Hk.wQh="was";Hk.xQh="wad";Hk.W1j="rm";Hk.wVl="wd";Hk.hUl="ad";Hk.ccl="rs";Object(m.a)(Hk,"TelemetryFieldNames",null,[]);class Sl{}Sl.ZFl="tcw";Sl.vwd="tcc";Sl.dug="bs";Sl.s7j="bd";Sl.cug="bpc";Sl.K2g="md";Object(m.a)(Sl,"TelemetryValues",null,[]);class zs{constructor(){this.wn=this.i=null}}Object(m.a)(zs,"Workflow",null,[]);var Nj=d(335);
class Ft{constructor(a){Nj.a.assign(Ft,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_RangeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return Nj.a.matchesTypesFor(a,[Ft.getTypeName()])}}Ft.H_={T_:Ft.getTypeName(),B_:Ft.getBaseTypes()};class Gt{constructor(a){Nj.a.assign(Gt,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_MultiTileRangeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return Nj.a.matchesTypesFor(a,
[Gt.getTypeName()])}}Gt.H_={T_:Gt.getTypeName(),B_:Gt.getBaseTypes()};class Ht{constructor(a){Nj.a.assign(Ht,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_LanguageDetectionSummaryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return Nj.a.matchesTypesFor(a,[Ht.getTypeName()])}}Ht.H_={T_:Ht.getTypeName(),B_:Ht.getBaseTypes()};class As{constructor(a){Nj.a.assign(As,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=
a}static getTypeName(){return"AugLoop_Text_LanguageCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return Nj.a.matchesTypesFor(a,[As.getTypeName()])}}As.H_={T_:As.getTypeName(),B_:As.getBaseTypes()};class Bs{constructor(a){Nj.a.assign(Bs,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_LanguageCountAnnotationLocalized"}static getBaseTypes(){return["AugLoop_Text_LanguageCountAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return Nj.a.matchesTypesFor(a,
[Bs.getTypeName()])}}Bs.H_={T_:Bs.getTypeName(),B_:Bs.getBaseTypes()};class It{constructor(a){Nj.a.assign(It,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_Definition"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return Nj.a.matchesTypesFor(a,[It.getTypeName()])}}It.H_={T_:It.getTypeName(),B_:It.getBaseTypes()};class uq{constructor(a){Nj.a.assign(uq,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=
a}static getTypeName(){return"AugLoop_Text_SuggestionsAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return Nj.a.matchesTypesFor(a,[uq.getTypeName()])}}uq.H_={T_:uq.getTypeName(),B_:uq.getBaseTypes()};class Xp{constructor(a){Nj.a.assign(Xp,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_Critique"}static getBaseTypes(){return["AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation",
"AugLoop_Core_Annotation"]}static typeGuard(a){return Nj.a.matchesTypesFor(a,[Xp.getTypeName()])}}Xp.H_={T_:Xp.getTypeName(),B_:Xp.getBaseTypes()};class Cs{constructor(a){Nj.a.assign(Cs,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_NeuralRewriteCritique"}static getBaseTypes(){return["AugLoop_Text_Critique","AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return Nj.a.matchesTypesFor(a,
[Cs.getTypeName()])}}Cs.H_={T_:Cs.getTypeName(),B_:Cs.getBaseTypes()};class Ds{constructor(a){Nj.a.assign(Ds,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_CritiqueCategoryCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return Nj.a.matchesTypesFor(a,[Ds.getTypeName()])}}Ds.H_={T_:Ds.getTypeName(),B_:Ds.getBaseTypes()};class Es{constructor(a){Nj.a.assign(Es,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=
a}static getTypeName(){return"AugLoop_Text_UniqueWordsCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return Nj.a.matchesTypesFor(a,[Es.getTypeName()])}}Es.H_={T_:Es.getTypeName(),B_:Es.getBaseTypes()};class zp{constructor(a){Nj.a.assign(zp,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_EmptyDocumentAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return Nj.a.matchesTypesFor(a,
[zp.getTypeName()])}}zp.H_={T_:zp.getTypeName(),B_:zp.getBaseTypes()};class Fs{constructor(a){Nj.a.assign(Fs,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_IdeasPersonalizationSettingsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return Nj.a.matchesTypesFor(a,[Fs.getTypeName()])}}Fs.H_={T_:Fs.getTypeName(),B_:Fs.getBaseTypes()};class Gs{constructor(a){Nj.a.assign(Gs,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=
a}static getTypeName(){return"AugLoop_Text_TextToSpeechAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return Nj.a.matchesTypesFor(a,[Gs.getTypeName()])}}Gs.H_={T_:Gs.getTypeName(),B_:Gs.getBaseTypes()};class Hs{constructor(a){Nj.a.assign(Hs,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_AutoreplaceAnnotation"}static getBaseTypes(){return["AugLoop_Text_Critique","AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation",
"AugLoop_Core_Annotation"]}static typeGuard(a){return Nj.a.matchesTypesFor(a,[Hs.getTypeName()])}}Hs.H_={T_:Hs.getTypeName(),B_:Hs.getBaseTypes()};class Ru{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc){this.ta=a;this.oD=b;this.CEe=c;this.Eb=f;this.Kgk=l;this.AWg=y;this.R0=H;this.Ga=Q;this.jm=ia;this.Ea=wa;this.Eue=Ua;this.P$=kb;this.dek=ec;this.N5c=dc;this.nd=Fc}initialize(){this.R0.execute(a=>{this.Ea.qea?(a.VZ(Xp.getTypeName()),a.w2k(Xp.getTypeName(),this.Qee.bind(this)),eb.a("PPTOAugLoopProofingTelemetry")&&
xa.a.J(508966307,375,20,"EditorServiceResultsManager.initialize: Activated annotation {0} on AugLoop v2 session & registered annotation handler {1}",Xp.getTypeName,this.Qee.getName),this.nd.aT(this.onActiveSlideDomReady.bind(this))):(a.addEventHandler(yn.a.EVd,Object(I.a)(this,this.yeg,"handleAugResults")),eb.a("PPTOAugLoopProofingTelemetry")&&xa.a.J(508966306,375,20,"EditorServiceResultsManager.initialize: Registered event handler {0} with AugLoop V1 session for {1}",this.yeg.getName,yn.a.EVd),this.Ea.pptAugmentationLoopCloudALEnabled&&
(a.addEventHandler(yn.a.QMc,Object(I.a)(this,this.Beg,"handleCloudALResults")),eb.a("PPTOAugLoopProofingTelemetry")&&xa.a.J(508966305,375,20,"EditorServiceResultsManager.initialize: Registered event handler {0} with AugLoop V1 session for {1}",this.Beg.getName,yn.a.QMc)))})}dispose(){this.Ea.qea&&this.nd.Uoa(this.onActiveSlideDomReady.bind(this))}onActiveSlideDomReady(a,b){var c,f,l;eb.a("EnableAnnotationStorage")&&this.N5c&&b&&b.Ba&&(a=b.Ba)&&null!==(c=a.Uj())&&void 0!==c&&c.some(y=>y.hasText)&&
(c=this.N5c.vaj(a))&&(a=null===(l=null===(f=a.changesData)||void 0===f?void 0:f.dtField)||void 0===l?void 0:l.getTime(),f=c.map(y=>y.body).filter(y=>y&&y.critiqueMetadata.sourceTimestamp).map(y=>Number(y.critiqueMetadata.sourceTimestamp)).find(y=>0<y),(!f||!a||f>=a)&&this.Qee(c,!1,!1))}Qee(a,b,c=!0){var f;eb.a("EnableAnnotationStorage")&&this.N5c&&c&&(f=this.N5c.ezj(a,b));c=Date.now();if(!(b||!a||0>=a.length)&&(b=[],a&&0!=a.length&&f)){for(const l of a){const y=l.body;if(!y)continue;const H=this.sbj(f,
Number(y.critiqueMetadata.shapeId),Number(y.critiqueMetadata.paragraphIndex));H&&b.push(...this.dek.KNc([y],H.id.toString()))}this.fuk(b,f);eb.a("PPTOAugLoopProofingTelemetry")&&(f=Date.now(),a=a.map(l=>l.body).filter(l=>l&&l.critiqueMetadata.sourceTimestamp).map(l=>Number(l.critiqueMetadata.sourceTimestamp)).find(l=>0<l),xa.a.J(508945999,375,20,"ALv2TotalProofingTime: {0}, ALv2MarkingResultsTime: {1}",f-a,f-c))}}fuk(a,b){var c;try{eb.a("PPTOAugLoopProofingTelemetry")&&xa.a.J(508966304,375,20,"ALv2: Marking critiques for slide, critiques count: {1}",
null!==(c=null===a||void 0===a?void 0:a.length)&&void 0!==c?c:0);const H=eb.a("ALV2SpellingEnabled"),Q=this.AWc(a,H);if(Q){var f=new Na.a,l=this.ta.Ba.Yca,y=this.Eb.je(7,C.a.zyd);y.hc(b);for(const ia in Q){const wa=Object(qa.a)(kf.AParagraphNode,l.ze(ha.a.Jf(ia)));if(!wa||wa.sa(km.a.C4,!1))continue;f.add(ia);const Ua=Q[ia];Ua||0<Ua.length?this.luk(wa,Ua):this.Rnh(wa);wa.setValue(km.a.C4,!0)}if(this.Ea.pptEditorConsistencyCheckIsEnabled){const ia=String.format("Start:{0}",(new Date).getTime().toString());
c=0;const wa=b.isSlideCritiqueReady;l=!1;if(!wa){const Ua=new Na.a,kb=this.AWc(a,!0);(l=this.K_f(kb,f,b,Ua))&&(c=this.yCf(kb,f,b,Ua))}xa.a.J(509116999,375,50,"{0}, End:{1}, IsReady:{2}, ShouldApply:{3}, Count:{4}",ia,(new Date).getTime().toString(),wa,l,c)}b.setValue(km.a.tne,!0);y.dispose()}}catch(H){xa.a.J(509116997,375,10,"markEditorServiceResultsForALV2 failed {0}",H.message)}}luk(a,b){const c=this.Ljj(a);this.N2g(a,b,c)}Ljj(a){const b=new Eb.ScriptSharpLegacyMap;let c=-1,f=-1,l=0;for(let y=0;y<
a.Ta.length;y++){const H=a.Ta.ga(y).formatting;H&&(f=tb.a.language(H),-1!==c&&c!==f&&(b.add(l,f),l=a.Ta.ga(y).cp),c=f)}b.add(l,f);return b}sbj(a,b,c){if(!a)return null;a=a.GQ(b);if(!a)return null;a=a.nz();b=0;for(const f of a)if(f.characterData){if(b==c)return f;b++}return null}yeg(a,b,c,f){xa.a.J(509116995,375,50,"Handle WAC AL results");if(b&&f&&b&&f){a=String.format("{0}, MarkStart:{1}",f.Telemetry,(new Date).getTime().toString());var l=this.a4f(b.Content);c=this.hgj(f.Payload);if(l&&c){var y=
!1;if(this.Ea.pptRegisterSingleProofingWorkflowEnabled||!this.Ea.pptAugmentationLoopCloudALEnabled||this.Ea.pptAugmentationLoopShadowCloudALEnabled)this.L2g(c.Critiques,l),y=!0;l=(new Date).getTime();if(f=this.P$.b3d(f.DashboardTelemetry))try{const H={};H[Hk.ccl]=c.ResponseStatus;H[Hk.W1j]=y;H[Hk.wVl]=l-f.d[Hk.bre];H[Hk.hUl]=f.d[Hk.xQh]-f.d[Hk.wQh];f.d=H;f.p=Sl.K2g;this.P$.track(f)}catch(H){xa.a.J(509116993,375,15,"trace metrics exception {0}",H.message)}a=String.format("{0}, MarkDone:{1}",a,l.toString());
xa.a.J(509116992,375,50,"Marked: {0}, TileID: {1}, critique count: {2}, {3}",y,b.Id,c.Critiques?c.Critiques.length:0,a)}else xa.a.J(509116994,375,10,c?"Aug slide is null":"Result is null")}}Beg(a,b,c,f){xa.a.J(509116963,375,50,"Handle Cloud AL results");a=(new Date).getTime();if(b&&f&&b&&f){f.partialSuccess&&xa.a.J(509116962,375,15,"Get partial success response");c=String.format("MarkStart:{0}",a.toString());var l=this.a4f(b.Content);if(l){var y=!1;if(this.Ea.pptRegisterSingleProofingWorkflowEnabled||
!this.Ea.pptAugmentationLoopShadowCloudALEnabled)y=this.Eue.KNc(f.critiques),this.L2g(y,l),y=!0;var H=(new Date).getTime(),Q=Object.assign(new tq,{w:Object.assign(new zs,{wn:Sl.vwd,i:b.Id}),p:Sl.K2g,d:{["ms"]:a,["md"]:H,["rm"]:y,["rs"]:f.partialSuccess?1:0}});this.P$.track(Q);c=String.format("{0}, MarkDone:{1}",c,H.toString());xa.a.J(509116960,375,50,"Marked: {0}, Cloud AL tileID: {1}, critique count: {2}, {3}",y,b.Id,f.critiques?f.critiques.length:0,c);eb.a("PPTOAugLoopProofingTelemetry")&&xa.a.J(508945998,
375,20,"ALv1TotalProofingTime: {0}, ALv1MarkingResultsTime: {1}",H-l.sourceTimestamp,H-a)}else xa.a.J(509116961,375,10,"Aug slide is null")}}a4f(a){let b=null;try{b=De.a(a)}catch(c){return xa.a.J(509116959,375,10,"Try parse aug slide failed"),null}return b}hgj(a){let b=null;try{b=De.a(a)}catch(c){return xa.a.J(509116958,375,10,"ApplyEditorServiceResults - Try parse aug response failed {0}",c.message),null}if(!b)return xa.a.J(509116957,375,15,"ApplyEditorServiceResults - Parsed response is null"),
null;if(1!==b.ResponseStatus&&0!==b.ResponseStatus)return xa.a.J(509116956,375,15,"ApplyEditorServiceResults - Failed editor service call {0}",b.ResponseStatus),null;1===b.ResponseStatus&&xa.a.J(509116955,375,15,"Get partial success response");return b}L2g(a,b){var c;try{const Q=this.ta.Ba;eb.a("PPTOAugLoopProofingTelemetry")&&xa.a.J(509088202,375,20,"ALv1: Marking critiques for slide, critiques count: {1}",null!==(c=null===a||void 0===a?void 0:a.length)&&void 0!==c?c:0);if(!this.cul(b,Q)){var f=
this.AWc(a,!1);if(f){var l=this.ta.Ba.Yca,y=new Na.a,H=this.Eb.je(7,C.a.zyd);H.hc(Q);for(const ia of b.drawingElems)if(ia.text&&ia.text.paragraphs)for(const wa of ia.text.paragraphs){const Ua=wa.id;y.add(Ua);const kb=Object(qa.a)(kf.AParagraphNode,l.ze(ha.a.Jf(Ua)));if(kb&&!kb.sa(km.a.C4,!1)){if(this.Ea.pptEditorGrammarAndWritingStyleIsEnabled)if(Ua in f){const Gb=Array.isArray(f[Ua])?f[Ua]:null;if(!Gb||!Gb.length||Gb[0].RevisionId!==kb.sa(km.a.o4c,0).toString())continue;this.N2g(kb,Gb,this.lqj(wa.cfRuns))}else this.Rnh(kb);
kb.setValue(km.a.C4,!0)}}if(this.Ea.pptEditorConsistencyCheckIsEnabled){const ia=String.format("Start:{0}",(new Date).getTime().toString());b=0;const wa=Q.isSlideCritiqueReady;c=!1;if(!wa){const Ua=new Na.a,kb=this.AWc(a,!0);(c=this.K_f(kb,y,Q,Ua))&&(b=this.yCf(kb,y,Q,Ua))}xa.a.J(509116998,375,50,"{0}, End:{1}, IsReady:{2}, ShouldApply:{3}, Count:{4}",ia,(new Date).getTime().toString(),wa,c,b)}Q.setValue(km.a.tne,!0);H.dispose()}}}catch(Q){xa.a.J(509116996,375,10,"MarkEditorServiceResults failed {0}",
Q.message)}}lqj(a){const b=new Eb.ScriptSharpLegacyMap;if(!a)return b;let c=0;for(const f of a)f.cf&&b.add(c,f.cf.lang),c+=f.len;return b}N2g(a,b,c){var f=this.oD.TF(a,y=>!!y.Eh);const l=[];for(const y of f)1===y.Eh.proofingType&&Array.add(l,y);b=this.j4i(a,b,l);f=this.i4i(b,f);this.oD.fLa(a,f);this.J2g(b,a,c);a.setValue(km.a.C4,!0)}Rnh(a){const b=this.oD.TF(a,c=>!!c.Eh&&1!==c.Eh.proofingType);this.oD.fLa(a,b);a.setValue(km.a.C4,!0)}yCf(a,b,c,f){const l=c.Yca,y=new Jd.a;let H=0;this.ibl(c);for(let ia in a){var Q=
a[ia];const wa=Object(qa.a)(kf.AParagraphNode,l.ze(ha.a.Jf(ia)));Q=Array.isArray(Q)?Q:null;if(!(wa&&wa.isConnected&&Q&&Q.length))continue;const Ua=[];for(const kb of Q)this.Pmg(kb)&&!f.contains(kb.BucketId)&&Ua.push(kb);0<Ua.length&&(this.J2g(Ua,wa),y.Fb(wa.id.toString())||y.$(wa.id.toString(),wa),H+=Ua.length)}if(0<y.count)for(let ia of b)y.Fb(ia)&&(a=y.ga(ia))&&c.jMa.add(a);c.isSlideCritiqueReady=!0;return H}K_f(a,b,c,f){var l=this.lnj(c);if(b.count!==l.count)return this.b5c(String.format("Topology changed from {0} to {1}",
b.count,l.count)),!1;c=c.Yca;for(var y of b){if(!l.contains(y))return this.b5c("ParaId changed"),!1;b=Object(qa.a)(kf.AParagraphNode,c.ze(ha.a.Jf(y)));if(!b||!b.isConnected)return this.b5c("Invalid ParaId"),!1;if(!b.sa(km.a.C4,!1))return this.b5c("Para pending proofing"),!1}for(let H in a){y=a[H];l=Object(qa.a)(kf.AParagraphNode,c.ze(ha.a.Jf(H)));y=Array.isArray(y)?y:null;if(!y||!y.length)continue;b=this.oD.TF(l,ia=>!!ia.Eh&&(1===ia.Eh.proofingType||2===ia.Eh.proofingType||3===ia.Eh.proofingType));
const Q=this.oD.TF(l,ia=>{ia=Object(qa.a)(295,ia.Eh);return!!ia&&5===ia.proofingType&&ia.vFa});l=this.CEe.bVc(l,!1,!0);for(const ia of y)if(this.Pmg(ia)){if(this.F0c(ia,b)||this.dVj(ia,y))f.add(ia.BucketId),xa.a.J(509116954,375,50,"Overlap critique: {0}",ia.BucketId);(this.F0c(ia,l)||this.F0c(ia,Q))&&f.add(ia.BucketId)}}return!0}b5c(a){xa.a.J(509116953,375,50,"Skip apply: {0}",a)}j4i(a,b,c){if(this.Ea.qea)return b;const f=[];for(const l of b){if(this.XGj(b,l)||a.characterData.length<l.Start+l.Length||
this.F0c(l,c))continue;const y=Ei.b(l);2!==y&&3!==y||f.push(l)}return f}i4i(a,b){const c=[];for(const f of b)this.Dsl(a,f)||Array.add(c,f);return c}Dsl(a,b){const c=b.Eh.proofingType;if(1===c)return!0;if(2===c||3===c)return!1;if(5===c){for(const f of a)if(this.C2c(f.Start,f.Start+f.Length,b.begin,b.end))return!1;return!0}return!1}F0c(a,b){const c=a.Start;a=a.Start+a.Length;for(const f of b)if(this.C2c(c,a,f.begin,f.end))return!0;return!1}AWc(a,b){const c={};eb.a("PPTOAugLoopProofingTelemetry")&&xa.a.J(508966303,
375,20,"Including spelling critiques {0}",b);if(a)for(const f of a)if(0!==f.Priority||b)f.TileId in c?Array.add(c[f.TileId],f):c[f.TileId]=[f];return c}aUa(a,b){let c=0;for(let f of a)if(b>=f.key)c=f.value;else break;return c}J2g(a,b,c=null){if(a&&a.length&&b){var f={},l=[];for(const H of a){var y=H.Start;const Q=y+H.Length,ia=b.characterData.substring(y,Q);a=this.Kgk.create(H,this.AWg);a.token=ia;c&&(a.lcid=this.aUa(c,y));y=new vn(y,Q,a);Array.add(l,y);a=1===a.proofingType?wj[a.proofingType]:a.typeId;
f[a]=a in f?f[a]+1:1}this.oD.jxf(b,l);this.AWg.track(()=>Object.assign(new Qf.a,{E:2,C:this.kJi(b.characterData),F:f}))}}XGj(a,b){const c=b.Start,f=b.Start+b.Length;for(const l of a)if(this.C2c(c,f,l.Start,l.Start+l.Length)&&Ei.a(l)>Ei.a(b))return!0;return!1}dVj(a,b){const c=a.Start,f=a.Start+a.Length;for(const l of b)if(l!==a&&this.C2c(c,f,l.Start,l.Start+l.Length))return!0;return!1}C2c(a,b,c,f){return a>=c&&a<f||c>=a&&c<b}kJi(a){return Wq.a.instance.mdg(a,0,a.length-1)}cul(a,b){return!a||!b||!b.isConnected||
a.id!==b.id.toString()}Pmg(a){return!!a&&5===Ei.b(a)}lnj(a){const b=new Na.a;a=a?a.Uj():[];for(const c of a)this.jm.gGa(c)||this.Ga.eK(c,f=>{b.add(f.id.toString())});return b}ibl(a){for(let b of a.jMa){const c=b;if(c){const f=this.oD.TF(c,l=>{l=Object(qa.a)(295,l.Eh);return!!l&&5===l.proofingType&&!l.vFa});this.oD.fLa(c,f)}}a.jMa.clear()}}Object(m.a)(Ru,"EditorServiceResultsManager",null,[]);class sw extends To.a{constructor(a,b,c,f,l,y=null){super(a,b,c,f,y);this.nG=l}get proofingType(){const a=
super.proofingType;return this.nG.wVa||2!==a?a:1}}Object(m.a)(sw,"PPTEditorServiceErrorDetails",To.a,[]);class tw{constructor(a,b,c){this.Yjk=a;this.Cok=b;this.nG=c}create(a,b,c=null){return new sw(a,b,this.Yjk,this.Cok,this.nG,c)}}Object(m.a)(tw,"PPTEditorServiceErrorDetailsFactory",null,[1254]);class uw{constructor(a){this.Ea=a}filter(a){if(a&&(!this.Ea.pptEditorConsistencyCheckIsEnabled||!this.Ea.pptEditorGrammarAndWritingStyleIsEnabled))for(let c=a.length-1;0<=c;--c){const f=a[c].CritiqueTypeInfoList;
for(let l=f.length-1;0<=l;--l){var b=f[l];b=Ei.c(b.CritiquePriority,b.CritiqueTag);this.Ea.pptEditorConsistencyCheckIsEnabled||5!==b||Array.removeAt(f,l);this.Ea.pptEditorGrammarAndWritingStyleIsEnabled||2!==b&&3!==b||Array.removeAt(f,l)}f.length||Array.removeAt(a,c)}}}Object(m.a)(uw,"PPTProofingCritiqueCategoryInfoFilter",null,[1255]);class Su extends Fi.a{constructor(a,b){super(null);this.vMd=a;this.errorType=2;this.Hvg=b}get proofingType(){return this.vMd}get suggestions(){return[]}UMa(){}}Object(m.a)(Su,
"UnknownErrorDetails",Fi.a,[]);class Tu{constructor(a,b,c,f,l){this.lcf=this.icf=null;this.OQd=this.dKd=0;this.WCd=!1;this.Qi=a;this.GXb=b;this.Vz=c;this.Rm=f;this.yN=l;this.Rzc=0}Plh(a,b,c){return{Pih:a,f7g:b,e7g:c}}kLh(){}$re(a,b,c,f,l,y,H,Q){!y&&(c=!!c&&c[a],f=!!f&&f[a],b&&b[a]||c||f)&&(b=this.Qi.Ta.last.cp,y=this.Qi.characterData.length,Array.add(H,new gl.a(b,y)),(c||f)&&Array.add(Q,new vn(b,y,new Su(this.yN.Oqe?l?l[a]:0:f?2:1,c?1:2))))}sPl(a,b){this.Vz.eWe(this.Qi,a);b&&this.Rm.j$k(this.Qi,b);
w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopV2Proofing",!1)&&Object(sc.a)("ALV2SpellingEnabled")||this.Oih()}Oih(){this.GXb.jS(this.Qi)}Wel(a,b,c,f){this.Sth(this.Rzc,b,c,f);this.dYe(a,this.WCd)}Sth(a,b,c,f){b.add(1===a);c.add(2===a||3===a);f.add(this.yN.Oqe?a:0)}dYe(a,b){a.add(b)}h$j(a){let b,c,f,l;b=this.Qi.sa(ab.a.Cxa,null);c=this.Qi.sa(ab.a.pMa,null);f=this.Qi.sa(Ab.a.Nab,null);l=this.Qi.sa(Ab.a.V_a,null);this.Qi.JAb=this.Qi.sa($c.a.amc,!1);({Cxa:b,
pMa:c,Nab:f,V_a:l}=this.XPh(b,c,f,l,a,"loading"));return{Cxa:b,pMa:c,Nab:f,V_a:l}}fYe(a,b,c,f,l){({Cxa:a,pMa:b,Nab:c,V_a:f}=this.XPh(a,b,c,f,l,"saving"));this.q_e(ab.a.Cxa,a);this.q_e(ab.a.pMa,b);this.q1e()&&this.q_e(Ab.a.Nab,c);this.Bml(Ab.a.V_a,f);this.Qi.JAb?this.Qi.ye($c.a.amc,!0):this.Qi.removeProperty($c.a.amc)}q1e(){return!0}q_e(a,b){b&&Array.contains(b,!0)?this.Qi.ye(a,b):this.Qi.removeProperty(a)}Bml(a,b){!b||Yb.a.all(b,c=>0===c)?this.Qi.removeProperty(a):this.Qi.ye(a,b)}UBi(a,b){(b=this.Qi.Ta.ga(b).formatting)?
(a.formatting=b.fe(a),N.a.instance.ga(57)&&(this.Qi.jv(),-1!==a.formatting.ug&&this.Qi.wordRunProperties.gAb(b.ug,64))):(ka.ULS.shipAssertTag(18109325,324,!1,"There is a Chp that has spelling error, but its formatting object is null"),mc.a.instance.Xb("CloneFormattingObjectError",{["Reason"]:"There is a Chp that has spelling error, but its formatting object is null"}))}XPh(a,b,c,f,l,y){const H=mc.a.instance.Zp(C.a.YSl);H.properties.$(lf.a.source,y);let Q=!1;a&&a.length!==l&&(ka.ULS.sendTraceTag(18109326,
324,10,"NotProofedRuns has inconstant length with expected. Length: [{0}], expected: [{1}], context:[{2}]",a.length,l,y),Q=!0);b&&b.length!==l&&(ka.ULS.sendTraceTag(18109327,324,10,"SpellErrorRuns has inconstant length with expected: Length: [{0}], expected: [{1}], context:[{2}]",b.length,l,y),Q=!0);this.q1e()&&c&&c.length!==l&&(ka.ULS.sendTraceTag(20784798,324,10,"GrammarErrorRuns has inconstant length with expected: Length: [{0}], expected: [{1}], context:[{2}]",c.length,l,y),Q=!0);f&&f.length!==
l&&(ka.ULS.sendTraceTag(25274201,324,10,"ProofingErrorHints has inconstant length with expected: Length: [{0}], expected: [{1}], context:[{2}]",f.length,l,y),Q=!0);if(Q)for(f=c=b=null,a=[],y=0;y<l;y++)Array.add(a,!0);H.end();return{returnValue:!Q,Cxa:a,pMa:b,Nab:c,V_a:f}}Kbh(){}UKe(){this.Rzc=0;this.icf=this.Qi.f1||[];this.lcf=this.Qi.OQb||[];this.OQd=this.dKd=0;this.WCd=!1}XKe(a,b){a.Yp&&a.Yp.Eh?this.Rzc=a.Yp.Eh.proofingType:a.aM&&(this.Rzc=0);a=a.cp;b=b?b.cp:a;this.WCd=({L3e:this.dKd}=this.eng(a,
b,this.icf,this.dKd)).returnValue||({L3e:this.OQd}=this.eng(a,b,this.lcf,this.OQd)).returnValue}eng(a,b,c,f){for(;f<c.length;){const l=c[f];if(l.end<=a)++f;else return{returnValue:b>l.begin,L3e:f}}return{returnValue:!1,L3e:f}}}Object(m.a)(Tu,"ProofingDataHandler",null,[1313]);var Oj=d(518);class Wo extends Tu{constructor(a,b,c,f,l,y,H,Q,ia,wa){super(a,b,c,f,Q);this.yHg=!1;this.rec=null;this.OJ=l;this.ia=y;this.Ga=H;this.jc=ia;this.G6c=null;this.la=wa}Kbh(){this.OJ.GKl(this.Qi)}Plh(a,b,c){this.Qi.Mme||
(a=!1,c=this.Rm.TF(this.Qi));this.G6c=this.Rm.TF(this.Qi,f=>{f=Object(qa.a)(295,f.Eh);return!!f&&5===f.proofingType&&!f.vFa});return{Pih:a,f7g:b,e7g:c}}kLh(a,b,c,f,l){const y=Object(qa.a)(118,this.jc.mg(this.Qi));this.Qi&&y&&y.isConnected&&y.isSlideCritiqueReady&&ma.a.kVd(this.Qi.characterData,b)&&this.G6c&&0<this.G6c.length&&(Array.addRange(l,this.G6c),l.sort((H,Q)=>H.end-Q.end));if(!a&&c&&0<c.length&&ma.a.kVd(this.Qi.characterData,b)&&f&&0<f.length){for(const H of c)this.arg(H,f)&&!this.arg(H,l)&&
Array.add(l,H);l.sort((H,Q)=>H.end-Q.end)}}arg(a,b){a=fl.c([a],b);return!Yb.a.Xa(a)&&Yb.a.any(a,c=>c.begin<c.end)}Oih(){this.la.qea&&Object(eb.a)("ALV2SpellingEnabled")?this.OJ.o1j(this.Qi)&&this.GXb.jS(this.Qi):xa.a.J(508913505,375,15,"Paragraph legacy proofing hit")}q1e(){return!1}dYe(a,b){this.yHg=!0;super.dYe(a,b);b&&(this.Qi.ye(km.a.C4,!1),this.Qi.ye(km.a.o4c,(new Date).getTime()))}Sth(a,b){this.rec||(this.rec=this.Rm.TF(this.Qi));b.add(1===a)}UKe(){super.UKe();this.rec=null}$re(a,b,c,f,l,y,
H,Q){y||(b=!!b&&b[a],a=!!c&&c[a],c=this.Qi.Ta.ga(this.Qi.Ta.length-1),b?(Array.add(H,new gl.a(c.cp,this.Qi.characterData.length)),this.Vel()):(b=this.Gbj(c.cp,this.Qi.characterData.length,this.Qi.characterData,ia=>{ia=ia.Eh.proofingType;return 2===ia||3===ia}))&&0<b.length&&Array.addRange(Q,b),a&&(Array.add(H,new gl.a(c.cp,this.Qi.characterData.length)),Array.add(Q,new vn(c.cp,this.Qi.characterData.length,new Su(1,1)))))}fYe(a,b,c,f,l){this.yHg||this.RHj()||xa.a.J.apply(null,[37368030,375,50,"notProofedRuns:{0}, spellErrorRuns:{1}, grammarErrorRuns:{2}",
a,b].concat(c));super.fYe(a,b,c,null,l)}RHj(){if(!this.Qi)return xa.a.J(508921562,375,10,"ParagraphNode is null"),!1;var a=this.Ga.vn(this.Qi);if(!a)return xa.a.J(508921561,375,10,"ShapeNode is null"),!1;a=new Oj.a(a,Rc.App.pn);this.ia.Ka(ea.a.vjb,2,a);return a.Pua}Vel(){const a=new pf.GraphTransaction(4);a.ld(this.Qi);this.Qi.ye(km.a.C4,!1);this.Qi.ye(km.a.o4c,(new Date).getTime());a.dispose()}Gbj(a,b,c,f){const l=[];if(this.rec)for(const y of this.rec){const H=Object(qa.a)(vn,y);H&&H.Eh&&H.Eh.token===
c.substring(H.begin,H.end)&&H.end>a&&H.end<=b&&f(H)&&Array.add(l,H)}return l}}Object(m.a)(Wo,"PPTProofingDataHandler",Tu,[]);class vw{constructor(a,b,c,f,l,y,H,Q,ia){this.Q$=a;this.Hlk=b;this.oD=c;this.OJ=f;this.nG=H;this.ia=l;this.jc=Q;this.Ga=y;this.la=ia}bNi(a){return new Wo(a,this.Q$,this.Hlk,this.oD,this.OJ,this.ia,this.Ga,this.nG,this.jc,this.la)}}Object(m.a)(vw,"PPTProofingDataHandlerFactory",null,[1258]);class Jt{constructor(a,b){this.R0=a;this.tyg=b}initialize(){this.R0.execute(a=>{if(this.tyg)for(const b of this.tyg)this.S4k(a,
b)})}S4k(a,b){a.registerSimpleRemoteWorkflow(b.CG,b.Gtb,b.SLb,b.Vsb)}}Object(m.a)(Jt,"ProofingAugLoopRuntimeManager",null,[]);class Uu{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc){this.Ga=a;this.jm=b;this.jc=c;this.Yl=f;this.Eb=l;this.Rb=y;this.el=H;this.ta=Q;this.Q$=ia;this.oD=wa;this.ai=kb;this.Gh=Gb;this.Bna=ec;this.wb=dc;this.nd=yc;this.uSg=tc;this.zZa=new Na.a;this.el.Lii(Object(I.a)(this,this.nch,"onUndoRevisionStateChanged"));this.AU=Ua.yd(12);this.AU.fk(Object(I.a)(this,this.onParagraphPropertyChanged,
"onParagraphPropertyChanged"));this.DM=Ua.yd(10);this.DM.IF(Object(I.a)(this,this.fbh,"onShapeTopologyChanged"));this.npk=new dd.a(3,1,0,Object(I.a)(this,this.resumeProofingAfterUndo,"resumeProofingAfterUndo"),90,"14");this.Tjc=this.i5=!1;this.nd.aT(Object(I.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"))}dispose(){this.el.p9k(Object(I.a)(this,this.nch,"onUndoRevisionStateChanged"));this.AU.Om(Object(I.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.DM.oP(Object(I.a)(this,
this.fbh,"onShapeTopologyChanged"));this.nd.Uoa(Object(I.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"))}Rsc(a,b){this.Ga.eK(a,c=>{this.txh(c,b)})}uxh(a,b){this.jm.Zoc(a,c=>{this.txh(c,b)})}HPl(a,b){b?this.Ga.eK(a,c=>{c&&this.oD.RYd(c)}):this.Ga.eK(a,c=>{c&&(c.L_b=!0)})}lLh(a){if(a&&a.isConnected&&!a.hq){var b=this.Eb.je(4);try{let c=!1;const f=this.Rb.Lc(a);b.hc(f);const l=this.Yl.Msa(a);for(;l.moveNext();){const y=l.currentNode;this.ntl(y)&&(c=!0,y.Djd(),y.mpc=!0)}c&&this.S2g(a)}finally{b&&
b.dispose()}this.ai.forceOutbound()}}GKl(a){if(this.Vua(a)&&a.L_b)if(this.Tjc&&!this.zZa.contains(a))this.zZa.add(a);else{var b=this.Eb.je(4);try{b.hc(a),a.Djd(),a.mpc=!0,this.muk(a)}finally{b&&b.dispose()}a.L_b=!1}}wmd(a){this.Vua(a)&&this.Ga.eK(a,b=>{this.Q$.jS(b)})}$Uk(a){this.Vua(a)&&this.jm.Zoc(a,b=>{this.Q$.jS(b)})}o1j(a){return this.Vua(a)&&(this.q1j(a)||this.p1j(a))}S2g(a){a&&a.isConnected&&this.Ga.uGa(a)&&this.Exh(a)}muk(a){const b=this.Ga.vn(a);this.S2g(b);this.jm.x9(a)&&(a=this.jm.Gyb(a))&&
a.isConnected&&this.jm.gGa(a)&&this.Exh(a)}nch(a,b){if(b)switch(b.state){case 0:this.Tjc=!0;break;case 3:this.Tjc=!1,this.i5||(this.wb.Hb(this.npk),this.i5=!0)}}ntl(a){return this.Vua(a)?a.sa(ab.a.Cxa,null)?!0:a.sa(ab.a.pMa,null)?!0:!1:!1}onParagraphPropertyChanged(a,b){this.Tjc&&b&&b.node&&(12!==b.node.type||this.zZa.contains(b.node)||this.zZa.add(b.node))}fbh(a,b){this.Tjc&&b&&b.node&&(10!==b.node.type||this.zZa.contains(b.node)||this.zZa.add(b.node))}resumeProofingAfterUndo(){this.i5=!1;for(let b of this.zZa)if(this.Vua(b))if(this.Ga.uGa(b)){var a=
b;a&&(this.Rsc(a,!0),this.wmd(a))}else this.Gh.ae(b)&&(a=b)&&(a.L_b=!0,this.Q$.jS(a));this.zZa.clear()}txh(a,b){a&&(a.L_b=b&&a.f1&&0<a.f1.length?!0:!1)}q1j(a){if(this.uSg){const b=this.ta.Ba;if(!this.Vua(b))return!1;a=this.Ga.Tda(a);return this.jc.mg(a)===b}return this.Bna.GUj(a)}p1j(a){var b=this.ta.Ba;if(!this.Vua(b))return!1;a=this.jm.Gyb(a);b=b.fUa();return this.Vua(a)&&this.Vua(b)&&ha.a.hQ(a.id,b.id)}Exh(a){a.setValue(zb.a.xmd,a.sa(zb.a.xmd,0)+1)}Vua(a){return!!a&&a.isConnected}onActiveSlideDomReady(){if(this.uSg){var a=
this.ta.Ba;if(a&&(a=a.Uj())&&0<a.length)for(const b of a)this.Ga.CB(b)&&this.wmd(b)}}}Object(m.a)(Uu,"ProofingBehaviorController",null,[1259,107]);class my extends bf.a{constructor(a,b,c,f,l,y=!0,H=!1,Q=50){super(a,b,c,f,l,y);this.qkk=H;this.uMg=Q}Avh(a){a=Array.isArray(a)?a:null;if(!Yb.a.Xa(a))if(a.length<=this.uMg)this.logTrace(a);else{const b=[];for(const c of a)Array.add(b,c),b.length===this.uMg&&(this.logTrace(b),Array.clear(b));0<b.length&&this.logTrace(b)}}logTrace(a){a&&xa.a.J(37325012,375,
this.qkk?15:50,"{0}",Me.c(a))}}Object(m.a)(my,"DashboardAggregator",bf.a,[]);class Ap{constructor(a){this.P$=new my(new Bb.a(()=>w.AFrameworkApplication.Ae),w.AFrameworkApplication.Wga,15,a.pptProofingDashboardTraceIntervalInMinutes,new Hr,!0,a.pptProofingDashboardTraceAsMonitorableEnabled,a.pptProofingDashboardMaxCountInEachLog)}track(a){this.P$.track(a,"")}b3d(a){let b=null;try{b=De.a(a)}catch(c){xa.a.J(37325010,375,15,"Try parse dashboardTelemetry failed")}return b}}Object(m.a)(Ap,"ProofingDashboardAggregator",
null,[1256]);class ww{track(){}b3d(){return null}}Object(m.a)(ww,"ProofingDashboardNonOperationAggregator",null,[1256]);var xw=d(444),Kt=d(443);class Vu{constructor(a){this.hpk=a}Wx(a,b,c){this.hpk(b,c);return!0}}Object(m.a)(Vu,"NonOpProofingALRequestManager",null,[1307]);class Wu{constructor(a,b,c){this.T0=this.o0=null;this.ghb=a;this.Kec=b.pptEditorConsistencyCheckIsEnabled;this.GCe=b.pptProofingLogWorkflowExceptionEnabled;this.P$=c;this.BEe=new Vu(Object(I.a)(this,this.uWe,"requestAL"))}get CG(){return"ProofingTileCheckCloudALWorkflow"}get proto(){return""}get Gtb(){this.o0||
(this.o0=Object.assign(new Kt.a,{name:"LambdaBefore_ProofingTileCheckCloudAL",inputSchema:xw.a.ruc,outputSchema:yn.a.lLf,func:Object(I.a)(this,this.$cb,"lambdaBeforeFunc")}));return this.o0}get Vsb(){return null}get SLb(){this.T0||(this.T0=Object.assign(new Kt.a,{name:"LambdaRemote_ProofingTileCheckCloudAL",inputSchema:yn.a.lLf,outputSchema:yn.a.QMc,func:null}));return this.T0}uWe(a,b){b(a)}$cb(a,b,c){try{xa.a.J(36962511,375,50,"{0}:LambdaBeforeStart",this.CG);const H=Object.assign(new tq,{d:{["bs"]:(new Date).getTime()},
w:Object.assign(new zs,{wn:Sl.vwd})});this.P$.track(Object.assign(new tq,{w:Object.assign(new zs,{wn:Sl.vwd}),p:Sl.dug}));let Q=String.format("LambdaBeforeStart:{0}",H.d[Hk.bre].toString());if(a){H.w.i=a.Id;try{var f=De.a(a.Content)}catch(ia){xa.a.J(36763234,375,10,"Try parse tile response failed");c(null);return}if(f){var l=f.isSlideCritiqueReady;b=!1;var y=({nGa:b}=this.ghb.Myl(f)).returnValue;y?b&&(!this.Kec||this.Kec&&l)?(c(null),this.P$.track(Object.assign(new tq,{w:Object.assign(new zs,{wn:Sl.vwd}),
p:Sl.cug})),xa.a.J(36962520,375,50,"{0}:LambdaBeforeDone,{1},isProofingClean:{2},isSlideCritiqueReady:{3}",this.CG,a.Id,b,l)):(H.d[Hk.a4c]=(new Date).getTime(),H.p=Sl.s7j,Q=String.format("TileId:{0}, {1}, LambdaBeforeDone:{2}",a.Id,Q,H.d[Hk.a4c].toString()),this.P$.track(H),xa.a.J(36783312,375,50,Q),this.BEe.Wx(f.id,y,c)):(c(null),xa.a.J(36962518,375,50,"{0}:LambdaBeforeDone,RequestNull,{1}",this.CG,a.Id))}else c(null)}else c(null),xa.a.J(36962513,375,50,"{0}:LambdaBeforeDone,InputNull",this.CG)}catch(H){a=
"CloudAL LambdaBefore Exception",this.GCe&&(a=String.format("CloudAL LambdaBefore Exception Message: {0}, Stack: {1}",H.message,H.stack)),xa.a.J(37835201,375,10,a),c(null)}}}Object(m.a)(Wu,"ProofingTileCheckCloudALWorkflow",null,[798,1281]);class yw{}Object(m.a)(yw,"AugEditorServiceTileCheckRequest",null,[]);class Xu{constructor(){this.contextId=this.b4c=null}}Object(m.a)(Xu,"RequestStateObject",null,[]);class Lt{constructor(a,b,c,f){this.ipk=0;this.T0=this.o0=null;this.ghb=a;this.mU=b;this.Kec=c.pptEditorConsistencyCheckIsEnabled;
this.GCe=c.pptProofingLogWorkflowExceptionEnabled;this.P$=f;this.BEe=new Vu(Object(I.a)(this,this.uWe,"requestAL"))}get CG(){return"ProofingTileCheckWacALWorkflow"}get proto(){return'syntax="proto3";message AugEditorServiceTileCheckRequest { string Topic = 1; string Data = 2; string ContextId = 3; string Telemetry = 4; string DashboardTelemetry = 5; };message AugEditorServiceTileCheckResponse { string  Topic = 1; string Payload = 2; string AppId = 3; string SessionId = 4; string ContextId = 5; string Telemetry = 6; string DashboardTelemetry = 7; }; '}get Gtb(){this.o0||
(this.o0=Object.assign(new Kt.a,{name:"LambdaBefore_ProofingTileCheckWacAL",inputSchema:xw.a.ruc,outputSchema:yn.a.MDf,func:Object(I.a)(this,this.$cb,"lambdaBeforeFunc")}));return this.o0}get Vsb(){return null}get SLb(){this.T0||(this.T0=Object.assign(new Kt.a,{name:"LambdaRemote_ProofingTileCheckWacAL",inputSchema:yn.a.MDf,outputSchema:yn.a.EVd,func:Object(I.a)(this,this.cre,"lambdaRemoteFunc")}));return this.T0}uWe(a,b){if(b){var c=this.P$.b3d(a.DashboardTelemetry);c&&(c.d[Hk.wQh]=(new Date).getTime());
var f=String.format("{0}, LambdaRemoteStart:{1}",a.Telemetry,(new Date).getTime());this.mU.execute(l=>{f=String.format("{0}, RequestWacALStart:{1}",f,(new Date).getTime().toString());l.rrc(a.Topic,a.Data,a.ContextId,y=>{this.nLa(y,f,c)},y=>{this.lLa(y,f)},Object.assign(new Xu,{contextId:a.ContextId,b4c:b}))})}}$cb(a,b,c){try{xa.a.J(36962523,375,50,"{0}:LambdaBeforeStart",this.CG);const H=Object.assign(new tq,{d:{["bs"]:(new Date).getTime()},w:Object.assign(new zs,{wn:Sl.ZFl})});let Q=String.format("LambdaBeforeStart:{0}",
H.d[Hk.bre].toString());this.P$.track(Object.assign(new tq,{w:H.w,p:Sl.dug}));if(a){try{var f=De.a(a.Content)}catch(ia){c(null);xa.a.J(36525525,375,10,"Try parse tile response failed");return}if(f){var l=f.isSlideCritiqueReady;b=!1;var y=({nGa:b}=this.ghb.Nyl(f,++this.ipk)).returnValue;y?b&&(!this.Kec||this.Kec&&l)?(c(null),this.P$.track(Object.assign(new tq,{w:H.w,p:Sl.cug})),xa.a.J(36962560,375,50,"{0}:LambdaBeforeDone,{1},isProofingClean:{2},isSlideCritiqueReady:{3}",this.CG,a.Id,b,l)):(H.d[Hk.a4c]=
(new Date).getTime(),Q=String.format("{0}, LambdaBeforeDone:{1}",Q,H.d[Hk.a4c].toString()),c(Object.assign(new yw,{Topic:yn.a.SXi,Data:De.c(y),ContextId:f.id,Telemetry:Q,DashboardTelemetry:Me.c(H)})),xa.a.J(36962562,375,50,"{0}:LambdaBeforeDone,{1}",this.CG,a.Id)):(c(null),xa.a.J(36962530,375,50,"{0}:LambdaBeforeDone,RequestNull{1},",this.CG,a.Id))}else c(null)}else c(null),xa.a.J(36962525,375,50,"{0}:LambdaBeforeDone,InputNull",this.CG)}catch(H){a="WACAL LambdaBefore Exception",this.GCe&&(a=String.format("WACAL LambdaBefore Exception Message: {0}, Stack: {1}",
H.message,H.stack)),xa.a.J(37835210,375,10,a),c(null)}}cre(a,b,c){xa.a.J(36962564,375,50,"{0}:LambdaRemoteStart",this.CG);a?this.BEe.Wx(a.ContextId,a,c):(c(null),xa.a.J(36962566,375,50,"{0}:LambdaRemoteDone,InputNull",this.CG))}nLa(a,b,c){if(!w.AFrameworkApplication.Yg&&a&&a.data){var f=(new Date).getTime(),l=a.data.state;if(l){try{var y=De.a(a.data.ee)}catch(H){l.b4c(null);xa.a.J(36525527,375,10,"Try parse aug response failed:{0}",H.message);return}y&&(y.Telemetry=String.format("{0}, LambdaRemoteDoneAndSucceed:{1}",
b,f.toString()),c&&(c.d[Hk.xQh]=f,y.DashboardTelemetry=Me.c(c)));l.b4c(y);xa.a.J(36962571,375,50,"{0}:LambdaRemoteDone,Succeeded",this.CG)}}}lLa(a,b){!w.AFrameworkApplication.Yg&&a&&a.data&&(b=String.format("{0}, LambdaRemoteDoneAndFailed: {1}",b,(new Date).getTime().toString()),xa.a.J(36525529,375,10,"Tile check request failed with: {0}, time: {1}",a.data.ee,b),(a=a.data.state)&&a.b4c(null))}}Object(m.a)(Lt,"ProofingTileCheckWacALWorkflow",null,[798,1281]);class zw{constructor(){this.groupType=0}}
Object(m.a)(zw,"AnalyzerData",null,[]);class Is{constructor(){this.nodes=this.metadata=null}}Object(m.a)(Is,"TopologyNode",null,[]);class Aw{constructor(){this.TileElements=this.AnalyzerData=this.RevisionId=this.TileId=null}}Object(m.a)(Aw,"Content",null,[]);class Yu{constructor(){this.value=this.typeName=this.name=this.languageId=this.id=null}}Object(m.a)(Yu,"CritiqueTypeOption",null,[]);class ny{constructor(){this.isCompliant=!1;this.licenseType=0}}Object(m.a)(ny,"Descriptors",null,[]);class Bw{constructor(){this.AppId=
this.SessionId=null;this.RequestOrderInSession=0;this.OverriddenCritiqueTypeOptions=this.Descriptors=this.Topology=this.Content=this.LanguageUxId=null}}Object(m.a)(Bw,"EditorServiceTileCheckRequest",null,[]);class Cw{constructor(){this.indentationLevel=this.listLevel=this.listType=0;this.listTag=null;this.listElementIndex=this.listNumeration=0}}Object(m.a)(Cw,"ListMetadata",null,[]);var Mt;(function(a){a[a.Undefined=0]="Undefined";a[a.AlphaLcParenBoth=1]="AlphaLcParenBoth";a[a.AlphaUcParenBoth=2]=
"AlphaUcParenBoth";a[a.AlphaLcParenR=3]="AlphaLcParenR";a[a.AlphaUcParenR=4]="AlphaUcParenR";a[a.AlphaLcPeriod=5]="AlphaLcPeriod";a[a.AlphaUcPeriod=6]="AlphaUcPeriod";a[a.ArabicParenBoth=7]="ArabicParenBoth";a[a.ArabicParenR=8]="ArabicParenR";a[a.ArabicPeriod=9]="ArabicPeriod";a[a.ArabicPlain=10]="ArabicPlain";a[a.RomanLcParenBoth=11]="RomanLcParenBoth";a[a.RomanUcParenBoth=12]="RomanUcParenBoth";a[a.RomanLcParenR=13]="RomanLcParenR";a[a.RomanUcParenR=14]="RomanUcParenR";a[a.RomanLcPeriod=15]="RomanLcPeriod";
a[a.RomanUcPeriod=16]="RomanUcPeriod";a[a.CircleNumDbPlain=17]="CircleNumDbPlain";a[a.CircleNumWdBlackPlain=18]="CircleNumWdBlackPlain";a[a.CircleNumWdWhitePlain=19]="CircleNumWdWhitePlain";a[a.ArabicDbPeriod=20]="ArabicDbPeriod";a[a.ArabicDbPlain=21]="ArabicDbPlain";a[a.Ea1ChsPeriod=22]="Ea1ChsPeriod";a[a.Ea1ChsPlain=23]="Ea1ChsPlain";a[a.Ea1ChtPeriod=24]="Ea1ChtPeriod";a[a.Ea1ChtPlain=25]="Ea1ChtPlain";a[a.Ea1JpnChsDbPeriod=26]="Ea1JpnChsDbPeriod";a[a.Ea1JpnKorPlain=27]="Ea1JpnKorPlain";a[a.Ea1JpnKorPeriod=
28]="Ea1JpnKorPeriod";a[a.Arabic1Minus=29]="Arabic1Minus";a[a.Arabic2Minus=30]="Arabic2Minus";a[a.Hebrew2Minus=31]="Hebrew2Minus";a[a.ThaiAlphaPeriod=32]="ThaiAlphaPeriod";a[a.ThaiAlphaParenR=33]="ThaiAlphaParenR";a[a.ThaiAlphaParenBoth=34]="ThaiAlphaParenBoth";a[a.ThaiNumPeriod=35]="ThaiNumPeriod";a[a.ThaiNumParenR=36]="ThaiNumParenR";a[a.ThaiNumParenBoth=37]="ThaiNumParenBoth";a[a.HindiAlphaPeriod=38]="HindiAlphaPeriod";a[a.HindiNumPeriod=39]="HindiNumPeriod";a[a.HindiNumParenR=40]="HindiNumParenR"})(Mt||
(Mt={}));Object(m.b)("ListNumeration",Mt);var Zu;(function(a){a[a.Undefined=0]="Undefined";a[a.Bullet=1]="Bullet";a[a.Numbered=2]="Numbered"})(Zu||(Zu={}));Object(m.b)("ListType",Zu);class oy{constructor(){this.tileContextDictionary=this.readingOrderTopology=this.tiles=this.overriddenCritiqueTypeOptions=this.languageUxId=this.documentSessionId=this.documentId=this.descriptors=null}}Object(m.a)(oy,"ProofingRequest",null,[]);class br{constructor(){this.Id=null;this.Type=0;this.NumberOfChildren=this.Children=
this.AnalyzerData=null;this.AreChildrenOrdered=!1}}Object(m.a)(br,"TopologyNode",null,[]);class $u{constructor(){this.nodes=null}}Object(m.a)($u,"ReadingOrderTopology",null,[]);class ni{constructor(){this.Length=this.Start=0;this.LanguageId=null;this.DoNotCheck=!1}}Object(m.a)(ni,"Span",null,[]);class py{constructor(){this.elements=this.metadata=null;this.subType=0}}Object(m.a)(py,"TextTile",null,[]);class qy{constructor(){this.text=null;this.textUnit=0;this.spans=this.listMetadata=this.languageId=
null;this.isClean=!1}}Object(m.a)(qy,"TextTileElement",null,[]);class vq{constructor(){this.doNotProcess=!1;this.languageId=null;this.start=this.length=0}}Object(m.a)(vq,"TextTileElementSpan",null,[]);class Js{constructor(){this.analyzerData=null;this.numberOfChildrenOnClient=0}}Object(m.a)(Js,"TileContext",null,[]);class Dw{constructor(){this.AnalyzerData=this.Text=null;this.TextUnit=0;this.LanguageId=null;this.IsClean=!1;this.Spans=null}}Object(m.a)(Dw,"TileElement",null,[]);class cr{constructor(){this.tileId=
this.revisionId=null;this.tileType=0}}Object(m.a)(cr,"TileMetadata",null,[]);class Ks{constructor(a,b,c,f,l,y){this.yWg=a;this.N6c=b;this.xWg=c;this.nG=f;this.Ea=l;this.oc=y;this.f7c=null}get hsg(){return w.AFrameworkApplication.fa.ka("IsSubscriptionForProofingUser")&&this.nG.wVa}get descriptors(){this.f7c||(this.f7c=this.tfj(),xa.a.J(37090579,375,50,"Descriptors: {0}",De.c(this.f7c)));return this.f7c}Nyl(a,b){let c;c=!0;var f=bb.a.He(w.AFrameworkApplication.lcid);if(!f)return{returnValue:null,nGa:c};
var l=new br,y=new br;b=Object.assign(new Bw,{Descriptors:this.descriptors,AppId:"powerPoint_Online",LanguageUxId:f.name,RequestOrderInSession:b,SessionId:w.AFrameworkApplication.userSessionId,Content:[],Topology:l,OverriddenCritiqueTypeOptions:this.N6c.g$d()});this.Ea.powerPointTopologyAndListInfoInSlideTileIsEnabled&&(l.Id=Hg.a.C3b(w.AFrameworkApplication.fa.Ha("ServerDocId")).toString(),l.Type=4,l.AnalyzerData=null,l.Children=[],l.NumberOfChildren=this.oc.Cj(),l.AreChildrenOrdered=!1,y.Id=a.id,
y.Type=3,y.AnalyzerData=null,y.Children=[],y.NumberOfChildren=null,y.AreChildrenOrdered=!0,Array.add(l.Children,y));for(var H of a.drawingElems)if(this.Ea.powerPointTopologyAndListInfoInSlideTileIsEnabled&&Array.add(y.Children,this.RHl(H)),H.text&&H.text.paragraphs)for(const ia of H.text.paragraphs){if(null===ia.chars||!ia.cfRuns||!ia.cfRuns.length)continue;a=new Aw;a.TileId=ia.id;a.TileElements=[];l=new Dw;l.Text=ia.chars;l.TextUnit=8;if(ia.pfRuns&&ia.pfRuns.length&&ia.pfRuns[0].pf){f=ia.pfRuns[0].pf;
l.AnalyzerData={};if(this.Ea.powerPointTopologyAndListInfoInSlideTileIsEnabled)if(16!==f.listType){l.AnalyzerData.ListLevel=f.lvl;var Q=Zu[this.S9d(f.listType)];1===f.listType?(l.AnalyzerData.ListType=Q,l.AnalyzerData.ListTag=f.listTag):0===f.listType&&(l.AnalyzerData.ListType=Q,l.AnalyzerData.ListNumeration=Mt[this.e5f(f.listNumeration)],l.AnalyzerData.ListElementIndex=f.listElementIndex)}else l.AnalyzerData.IndentLevel=f.lvl;else l.AnalyzerData.ListLevel=f.lvl;l.IsClean=!f.proofingDirty;a.RevisionId=
f.revisionId}c=c&&l.IsClean;Q=0;const wa=[];let Ua=null;for(const kb of ia.cfRuns)if(kb)if(f=bb.a.He(kb.cf.lang)){this.xWg.Lld(kb.cf.lang);f=Object.assign(new ni,{Start:Q,Length:kb.len,LanguageId:f.name,DoNotCheck:kb.cf.noProof});Ua||(Ua=f.LanguageId);if(Ua!==f.LanguageId||kb.cf.noProof)0<=f.Start&&0<f.Length&&f.Start+f.Length<=l.Text.length?wa.push(f):(f.Length||f.Start!==l.Text.length)&&xa.a.J(36823815,375,10,"Invalid span, start: {0}, length: {1}, paragraph length: {2}",f.Start,f.Length,l.Text.length);
Q+=kb.len}else Q+=kb.len;!l.IsClean&&0<wa.length&&(l.Spans=Array.clone(wa));l.LanguageId=Ua;ma.a.Xa(l.LanguageId)?xa.a.J(38385410,375,15,"Empty LanguageId, span length {0}",wa.length):(a.TileElements.push(l),b.Content.push(a))}for(y=b.Content.length-1;0<=y;y--)H=b.Content[y],H.TileElements.length&&null!==H.TileElements[0].Text||(xa.a.J(37091085,375,50,"Empty TileElements or empty text in tile {0}",H.TileId),Array.removeAt(b.Content,y));b.Content.length||xa.a.J(37091087,375,50,"Empty tiles");return{returnValue:b,
nGa:c}}RHl(a){const b=Object.assign(new br,{Id:a.id,Type:2,AnalyzerData:{},Children:[],NumberOfChildren:a.text.paragraphs.length,AreChildrenOrdered:!0});b.AnalyzerData.GroupType=a.mk.type;for(const c of a.text.paragraphs)a=Object.assign(new br,{Id:c.id,Type:1,NumberOfChildren:null,AreChildrenOrdered:!1}),Array.add(b.Children,a);return b}Myl(a){let b;b=!0;var c=bb.a.He(w.AFrameworkApplication.lcid);if(!c)return{returnValue:null,nGa:b};var f={};c=Object.assign(new oy,{descriptors:this.Acj(this.descriptors),
languageUxId:c.name,documentSessionId:w.AFrameworkApplication.userSessionId,tiles:[],overriddenCritiqueTypeOptions:this.zcj(this.N6c.g$d()),tileContextDictionary:f,documentId:Hg.a.C3b(w.AFrameworkApplication.fa.Ha("ServerDocId")).toString(),readingOrderTopology:Object.assign(new $u,{nodes:[]})});const l=this.Rdi(a,c.readingOrderTopology,f);for(var y of a.drawingElems)if(y.text&&y.text.paragraphs){a=this.lci(y,l,f);for(const H of y.text.paragraphs)({nGa:b}=this.nei(c.tiles,H,b)),this.adi(H,a,f)}for(f=
c.tiles.length-1;0<=f;f--)y=c.tiles[f],y.elements.length&&null!==y.elements[0].text||(xa.a.J(37091090,375,50,"Empty TileElements or empty text in tile {0}",y.metadata?y.metadata.tileId:""),Array.removeAt(c.tiles,f));c.tiles.length||xa.a.J(37091092,375,50,"Empty tiles");return{returnValue:c,nGa:b}}tfj(){if(!this.yWg.descriptors)return null;const a=Array.clone(this.yWg.descriptors);for(const b of a)if(this.hsg&&"licensetype"===b.Name.toLowerCase())return b.Value="Subscription",a;this.hsg&&Array.add(a,
Object.assign(new hl,{Name:"LicenseType",Value:"Subscription"}));return a}Acj(a){const b=new ny;for(const c of a)"iscompliant"===c.Name.toLowerCase()&&(b.isCompliant="true"===c.Value.toLowerCase()),"licensetype"===c.Name.toLowerCase()&&(b.licenseType="subscription"===c.Value.toLowerCase()?2:0);return b}S9d(a){switch(a){case 0:return 2;case 1:return 1;default:return 0}}zcj(a){const b=[];for(const c of a)a=Object.assign(new Yu,{id:c.Id,languageId:c.LanguageId,value:c.Value}),b.push(a);return b}e5f(a){return a+
1}Bcj(a){switch(a){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:return 0}}nei(a,b,c){if(null===b.chars||!b.cfRuns||!b.cfRuns.length)return{returnValue:null,nGa:c};const f=new py;f.metadata=new cr;f.metadata.tileId=b.id;f.metadata.tileType=1;f.elements=[];const l=new qy;l.text=b.chars;l.textUnit=4;l.listMetadata=new Cw;var y=l.isClean=!1;if(b.pfRuns&&b.pfRuns.length&&b.pfRuns[0].pf){y=b.pfRuns[0].pf;if(this.Ea.powerPointTopologyAndListInfoInSlideTileIsEnabled)if(16!==
y.listType){l.listMetadata.listLevel=y.lvl;var H=this.S9d(y.listType);1===y.listType?(l.listMetadata.listType=H,l.listMetadata.listTag=y.listTag):0===y.listType&&(l.listMetadata.listType=H,l.listMetadata.listNumeration=this.e5f(y.listNumeration),l.listMetadata.listElementIndex=y.listElementIndex)}else l.listMetadata.indentationLevel=y.lvl;else l.listMetadata.listLevel=b.pfRuns[0].pf.lvl,l.listMetadata.listType=this.S9d(b.pfRuns[0].pf.listType);f.metadata.revisionId=b.pfRuns[0].pf.revisionId;l.isClean=
y=!b.pfRuns[0].pf.proofingDirty;c=c&&y}H=0;const Q=[];let ia=null;for(const wa of b.cfRuns)if(wa)if(b=bb.a.He(wa.cf.lang)){this.xWg.Lld(wa.cf.lang);b=Object.assign(new vq,{start:H,length:wa.len,languageId:b.name,doNotProcess:wa.cf.noProof});ia||(ia=b.languageId);if(ia!==b.languageId||wa.cf.noProof)0<=b.start&&0<b.length&&b.start+b.length<=l.text.length?Q.push(b):(b.length||b.start!==l.text.length)&&xa.a.J(36823817,375,10,"Invalid span, start: {0}, length: {1}, paragraph length: {2}",b.start,b.length,
l.text.length);H+=wa.len}else H+=wa.len;!y&&0<Q.length&&(l.spans=Array.clone(Q));l.languageId=ia;if(ma.a.Xa(l.languageId))return xa.a.J(38385415,375,15,"Empty LanguageId, span length {0}",Q.length),{returnValue:null,nGa:c};f.elements.push(l);a.push(f);return{returnValue:f,nGa:c}}Rdi(a,b,c){const f=Object.assign(new Is,{metadata:Object.assign(new cr,{tileId:a.id,tileType:2}),nodes:[]});Array.add(b.nodes,f);b=Object.assign(new Js,{analyzerData:new zw,numberOfChildrenOnClient:a.drawingElems.length});
c[a.id]=b;return f}lci(a,b,c){const f=Object.assign(new Is,{metadata:Object.assign(new cr,{tileId:a.id}),nodes:[]});Array.add(b.nodes,f);b=Object.assign(new Js,{analyzerData:Object.assign(new zw,{groupType:this.Bcj(a.mk.type)}),numberOfChildrenOnClient:a.text.paragraphs.length});c[a.id]=b;return f}adi(a,b,c){const f=Object.assign(new Is,{metadata:Object.assign(new cr,{tileId:a.id,tileType:1}),nodes:[]});Array.add(b.nodes,f);b=Object.assign(new Js,{numberOfChildrenOnClient:0});c[a.id]=b}}Object(m.a)(Ks,
"TileToTileCheckRequestTransformer",null,[1280]);var ry;(function(a){a[a.High=0]="High";a[a.Medium=1]="Medium";a[a.Low=2]="Low";a[a.Informational=3]="Informational"})(ry||(ry={}));var Xo;(function(a){a[a.NotificationOnly=0]="NotificationOnly";a[a.Delete=1]="Delete";a[a.Ignore=2]="Ignore";a[a.IgnoreAll=4]="IgnoreAll";a[a.IgnoreCritiqueType=8]="IgnoreCritiqueType";a[a.AddToDictionary=16]="AddToDictionary";a[a.ShowDetails=32]="ShowDetails"})(Xo||(Xo={}));var Ls;(function(a){a[a.None=0]="None";a[a.ChangeOnce=
1]="ChangeOnce";a[a.ChangeAll=2]="ChangeAll";a[a.AutoCorrect=4]="AutoCorrect";a[a.ReadAloud=8]="ReadAloud";a[a.PersonalizedAutoCorrect=16]="PersonalizedAutoCorrect"})(Ls||(Ls={}));class Ew{KNc(a,b){if(!a)return null;const c=[];for(const f of a)a=Object.assign(new ys,{CategoryTitle:f.categoryName,ExplanationTitle:f.explanationTitle||"",ExplanationLabel:f.explanationLabel||"",Explanation:f.context||"",TileId:b,BucketId:f.bucketId,Tag:0,Start:f.range.start,Length:f.range.length,Priority:f.priority,TypeId:f.typeId,
AnnotationId:f.id}),f.critiqueActions&&(a.SupportedActions=this.R_d(f.critiqueActions)),f.suggestions&&(a.Suggestions=this.W_d(f.suggestions)),c.push(a);return c}W_d(a){if(!a)return null;const b=[];for(const c of a)(a=this.U_d(c))&&b.push(a);return b}U_d(a){if(!a)return null;const b=Object.assign(new Dt,{Description:a.description,Text:a.text,Level:this.Q_d()});a.suggestionActions&&(b.Action=this.V_d(a.suggestionActions));return b}Q_d(){return 2}V_d(a){let b=0;a&Ls.AutoCorrect&&(b|=4);a&Ls.ChangeOnce&&
(b|=1);a&Ls.ChangeAll&&(b|=2);a&Ls.ReadAloud&&(b|=8);return b}R_d(a){let b=0;a&Xo.AddToDictionary&&(b|=16);a&Xo.Delete&&(b|=1);a&Xo.Ignore&&(b|=2);a&Xo.IgnoreAll&&(b|=4);a&Xo.IgnoreCritiqueType&&(b|=8);a&Xo.ShowDetails&&(b|=32);return b}}Object(m.a)(Ew,"ALV2ResponseTransformer",null,[1279]);class Nr{constructor(a,b){this.Sb=a;this.Ea=b;this.Udc=new Map;this.XCb=new Map}ezj(a,b){if(a&&!(0>=a.length)){if(b)return this.sSi(a);a=a.filter(c=>Nj.a.getTypeNameFor(c.body)===Xp.getTypeName());return!a||0>=
a.length?void 0:this.Iai(a)}}vaj(a){var b;if(!a)return null;a=Va.a.Uy(a.sid,a.cid).toString();const c=[];null===(b=this.XCb.get(a))||void 0===b?void 0:b.forEach(l=>c.push(l));const f=[];c.filter(l=>this.Udc.has(l)).forEach(l=>{f.push(this.Udc.get(l))});return f}sSi(a){const b=this.mbg(a);for(const c of a)if(a=c.id,this.Udc.has(a)&&this.Udc.delete(a),b){const f=Va.a.Uy(b.sid,b.cid).toString();this.XCb.has(f)&&this.XCb.get(f).delete(a)}return b}Iai(a){const b=this.mbg(a);for(const c of a)this.Udc.set(c.id,
c),b&&(a=Va.a.Uy(b.sid,b.cid).toString(),this.XCb.has(a)||this.XCb.set(a,new Set),this.XCb.get(a).add(c.id));return b}Esj(a){var b=a[a.length-1];if(!b)return xa.a.J(508900097,375,15,"ALV2:getSlideNodeFromParentPath:: Null slide id received"),null;if(this.Ea.qea&&Object(eb.a)("ALSlideTileIdNewFormat")){if(-1>=b.indexOf("#")){xa.a.J(508900096,375,15,"ALV2:getSlideNodeFromParentPath:: Slide Id does not have valid separator");return}b=b.split("#");a=parseInt(b[0]);b=parseInt(b[1])}else a=parseInt(b.substring(0,
3)),b=parseInt(b.substring(3,b.length));a=Va.a.Uy(a,b);return this.Sb.Zk(a)}mbg(a){if(a&&!(1>a.length)&&a[0].source)switch(a=a[0],a.source.toLowerCase()){case "proofing-powerpoint":return this.Esj(a.parentPath)}}}Object(m.a)(Nr,"AnnotationStore",null,[1282]);class Nn{constructor(){this.nG=this.K=null}get name(){return"PowerPointWebEditor.Proofing"}Yb(a){this.K=a;this.QFi();this.RFi();this.K.register(1254,"Box4.Proofing.IEditorServiceErrorDetailsFactory").ma().oa(()=>new tw(w.AFrameworkApplication.fa.ka("ProofingFeedbackLoopIsEnabled"),
this.K.resolve("Box4.Proofing.IProofingFeedbackLoopManager"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration")));this.K.register(1255,"Box4.Proofing.IProofingCritiqueCategoryInfoFilter").ma().oa(()=>new uw(this.K.resolve("PowerPointWebEditor.IApplicationSettings")));a.register(1256,"PowerPointWebEditor.Proofing.IProofingDashboardAggregator").ma().oa(()=>this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptProofingDashboardTraceEnabled?new Ap(this.K.resolve("PowerPointWebEditor.IApplicationSettings")):
new ww);this.K.register(Nr,"PowerPointWebEditor.Proofing.AnnotationStore.AnnotationStore").as("PowerPointWebEditor.Proofing.AnnotationStore.IAnnotationStore").ma().oa(()=>new Nr(this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(Ru,"PowerPointWebEditor.Proofing.EditorServiceResultsManager").ma().oa(()=>new Ru(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),
this.K.resolve("Box4.Proofing.IProofingTextUtility"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),this.K.resolve("Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>"),this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.Proofing.ICloudALResponseTransformer"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingDashboardAggregator"),this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow"),this.K.resolve("PowerPointWebEditor.Proofing.IALV2ResponseTransformer"),this.K.resolve("PowerPointWebEditor.Proofing.AnnotationStore.IAnnotationStore"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")));this.K.register(1257,"PowerPointWebEditor.Proofing.IConsistencyCheckManager").ma().oa(()=>
new Et(this.K.resolve("Box4.Graph.IGraphInstance").yd(12),this.K.resolve("Box4.Graph.IGraphInstance").yd(22),this.K.resolve("Box4.Graph.IGraphInstance").yd(10),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("Box4.IParagraphReader"),
this.K.resolve("Box4.List.IListReader")));this.K.register(Ks,"PowerPointWebEditor.Proofing.TileToTileCheckRequestTransformer").as("PowerPointWebEditor.Proofing.ITileToTileCheckRequestTransformer").ma().oa(()=>new Ks(this.K.resolve("Box4.Proofing.IProofingDescriptors"),this.K.resolve("Box4.Proofing.ICritiqueTypeSettings"),this.K.resolve("Box4.Proofing.IProofingConfigV2Manager"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.IPresentationReader")));this.K.register(rw,"PowerPointWebEditor.Proofing.CloudALResponseTransformer").as("PowerPointWebEditor.Proofing.ICloudALResponseTransformer").ma().oa(()=>new rw);this.K.register(Ew,"PowerPointWebEditor.Proofing.ALV2ResponseTransformer").as("PowerPointWebEditor.Proofing.IALV2ResponseTransformer").ma().oa(()=>new Ew);this.K.register(Lt,"PowerPointWebEditor.Proofing.ProofingTileCheckWacALWorkflow").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow").ma().oa(()=>
new Lt(this.K.resolve("PowerPointWebEditor.Proofing.ITileToTileCheckRequestTransformer"),this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingDashboardAggregator")));this.K.register(Wu,"PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow").ma().oa(()=>new Wu(this.K.resolve("PowerPointWebEditor.Proofing.ITileToTileCheckRequestTransformer"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingDashboardAggregator")));this.K.register(Jt,"PowerPointWebEditor.Proofing.ProofingAugLoopRuntimeManager").ma().oa(()=>{const b=[],c=this.K.resolve("Common.IAppSettingsManager").ka("576");this.K.resolve("Common.IAppSettingsManager").ka("772")?b.push(c?this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow"):this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckWacALWorkflow")):
(b.push(this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckWacALWorkflow")),c&&b.push(this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow")));return new Jt(this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),b)});this.K.register(qw.a,"Box4.Proofing.CritiqueTypeSettings").as("Box4.Proofing.ICritiqueTypeSettings").ma().oa(()=>new qw.a(this.K.resolve("Box4.IRoamingServiceRequestManager"),w.AFrameworkApplication.fa.Ha("PptRoamingServiceGetActionName"),
w.AFrameworkApplication.fa.Ha("PptRoamingServiceSaveActionName")))}init(){this.K.resolve("PowerPointWebEditor.IPPTProofingDataHandlerFactory");const a=this.K.resolve("Common.IAppSettingsManager");a.ff(()=>{this.nG=this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration");this.nG.wVa=a.ka("810");this.nG.yAb=a.ka("809");this.nG.aWa=a.ka("299");if(this.nG.wVa||this.nG.yAb)this.K.resolve("Box4.Proofing.IProofingDescriptors").cie(),this.K.resolve("PowerPointWebEditor.Proofing.ProofingAugLoopRuntimeManager").initialize(),
this.K.resolve("PowerPointWebEditor.Proofing.EditorServiceResultsManager").initialize();this.nG.aWa&&(this.K.resolve("Box4.Proofing.IProofingConfigV2Manager").init(),this.K.resolve("Box4.Proofing.ICritiqueTypeSettings").init());this.nG.yAb&&(this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager"),this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager").initialize())});this.K.resolve("Box4.IProofingManager").suspend()}dispose(){this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController").dispose();
this.nG.yAb&&this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager").dispose();this.K.resolve("PowerPointWebEditor.Proofing.EditorServiceResultsManager").dispose()}QFi(){this.K.register(1258,"PowerPointWebEditor.IPPTProofingDataHandlerFactory").ma().oa(()=>new vw(this.K.resolve("Box4.IProofingManager"),this.K.resolve("Box4.Proofing.IModifiedRangeEditor"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")))}RFi(){this.K.register(1259,"PowerPointWebEditor.Proofing.IProofingBehaviorController").ma().oa(()=>new Uu(this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.IProofingManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("Box4.Graph.IGraphInstance"),this.K.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),this.K.resolve("Box4.IParagraphReader"),
this.K.resolve("PowerPointWebEditor.View.IShapeViewHelper"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").U0j))}static main(){n.a.instance.Ac(new Nn)}}Object(m.a)(Nn,"PPTWebEditorProofingPackage",null,[2,3]);class Fw{constructor(a,b,c,f,l,y,H,Q,ia,wa){this.nd=a;this.nd.oJc(Object(I.a)(this,this.ach,"onTextEditViewClose"));
this.nd.D_b(Object(I.a)(this,this.bch,"onTextEditViewOpen"));this.nd.cii(Object(I.a)(this,this.$7g,"onBeforeTextEditViewClose"));this.nd.gii(Object(I.a)(this,this.cch,"onTextEditViewUpdate"));this.Mue=b;this.ai=l;this.Ts=y;this.OJ=c;this.bhb=f;this.hgc=H;this.sfc=Q;this.Pdd=ia;this.OE=wa}get SMc(){return this.Mue.instance}dispose(){this.nd.HVe(Object(I.a)(this,this.ach,"onTextEditViewClose"));this.nd.jpd(Object(I.a)(this,this.bch,"onTextEditViewOpen"));this.nd.T8k(Object(I.a)(this,this.$7g,"onBeforeTextEditViewClose"));
this.nd.W8k(Object(I.a)(this,this.cch,"onTextEditViewUpdate"))}cch(){this.sfc.dZ()}bch(a,b){a=b.$w.shapeNode;this.OJ.Rsc(a,!1);this.OJ.wmd(a);this.SMc&&this.SMc.yHk(a)}$7g(a,b){this.hgc.x5d(b.$w.Nd)}ach(a,b){a=b.$w;const c=b.$w.shapeNode,f=!!c&&c.isConnected;b.Pua?this.OE.instance&&((this.OE.instance.JBb||this.OE.instance.b0)&&2===this.OE.instance.GD||this.OE.instance.W2c)?xa.a.J(38836432,822,15,"ShapeViewElementTextEditHandler::onTextEditViewClose skipped when session is closing reason:{0}, ForceSave:{1}",
this.OE.instance.GD,this.OE.instance.W2c):(f&&c.Msd(),c.vd?(this.OJ.lLh(c),this.bhb.r8g(),this.Ts.R4e()):(this.ai.F8a(c),this.Ts.NYd())):this.Pdd||this.OJ.lLh(c);this.OJ.Rsc(b.$w.shapeNode,f&&c.c1c);this.SMc&&!a.hq&&this.SMc.xHk(c)}}Object(m.a)(Fw,"ShapeViewElementTextEditHandler",null,[107]);class av{constructor(a){this.Ckc=null;this.okk=a;this.reset()}sJh(a,b){a&&this.Ckc.$(a,b)}czb(a){let b=0;this.Ckc.Fb(a)&&(b=this.Ckc.ga(a)?1:2);return b}BJe(a){return this.okk?1===this.czb(a):!1}reset(){const a=
this.Ckc;this.Ckc=new Jd.a(!1);return a}}Object(m.a)(av,"TextEditingRevisionInfoTracker",null,[1284,1285]);var Nt=d(1101),xe=d(589),sy=d(423),Gw=d(863),Ot=d(327);class Pt{constructor(){this.typeField=this.startAtField=0}}Object(m.a)(Pt,"CT_TextAutonumberBullet",null,[]);class bv{constructor(){this.charField=null}}Object(m.a)(bv,"CT_TextCharBullet",null,[]);class Hw{}Object(m.a)(Hw,"CT_TextNoAutofit",null,[]);class Ms{}Object(m.a)(Ms,"CT_TextNoBullet",null,[]);class cv{constructor(){this.lnSpcReductionField=
this.fontScaleField=0}}Object(m.a)(cv,"CT_TextNormalAutofit",null,[]);class Qt{constructor(){this.itemField=null}}Object(m.a)(Qt,"CT_TextSpacing",null,[]);class Iw{constructor(){this.valField=0}}Object(m.a)(Iw,"CT_TextSpacingPercent",null,[]);class Lm{constructor(){this.tField=this.rPrField=null}}Object(m.a)(Lm,"CT_WebRegularTextRun",null,[]);class Bo{constructor(){this.pField=this.lstStyleField=this.bodyPrField=null}}Object(m.a)(Bo,"CT_WebTextBody",null,[]);class Jw{constructor(){this.lInsField=
this.horzOverflowField=this.bInsField=this.anchorField=0;this.normAutofitField=this.noAutofitField=null;this.rotField=this.rInsField=0;this.spAutoFitField=null;this.spcFirstLastParaField=!1;this.wrapField=this.vertOverflowField=this.vertField=this.tInsField=0}}Object(m.a)(Jw,"CT_WebTextBodyProperties",null,[]);class dr{constructor(){this.altLangField=null;this.baselineField=0;this.bFieldSpecified=this.bField=this.baselineFieldSpecified=!1;this.blipFillField=null;this.capField=0;this.capFieldSpecified=
!1;this.defsymField=this.deflatinField=this.defeaField=this.defcsField=this.csField=null;this.dirtyField=!1;this.embedImgLocField=this.effectLstField=this.effectDagField=this.eaField=null;this.errField=!1;this.hlinkMouseOverField=this.hlinkClickField=this.highlightField=this.grpFillField=this.gradFillField=null;this.isDefFontFieldSpecified=this.isDefFontField=this.iFieldSpecified=this.iField=!1;this.kernField=0;this.kernFieldSpecified=!1;this.noFillField=this.lnField=this.latinField=this.langField=
null;this.normalizeHFieldSpecified=this.normalizeHField=this.noProofFieldSpecified=this.noProofField=!1;this.pattFillField=null;this.proofErrField=0;this.rawSolidFillField=null;this.rtlFieldSpecified=this.rtlField=!1;this.solidFillField=null;this.spcField=0;this.spcFieldSpecified=!1;this.stField=0;this.strikeFieldSpecified=this.strikeField=this.stFieldSpecified=!1;this.symField=null;this.szField=0;this.uFieldSpecified=this.uField=this.szFieldSpecified=!1;this.uLnTxField=this.uLnField=this.uFillTxField=
this.uFillField=null;this.utField=0;this.utFieldSpecified=!1}}Object(m.a)(dr,"CT_WebTextCharacterProperties",null,[]);class Kw{constructor(){this.pPrField=this.itemsField=this.endParaRPrField=null}}Object(m.a)(Kw,"CT_WebTextParagraph",null,[]);class Ns{constructor(){this.algnField=0;this.algnFieldSpecified=!1;this.buSzTxField=this.buSzPtsField=this.buSzPctField=this.buNoneField=this.buFontTxField=this.buFontField=this.buClrTxField=this.buClrField=this.buCharField=this.buAutoNumField=null;this.defIndentFieldSpecified=
this.defIndentField=!1;this.defIndentValueField=0;this.defListFieldSpecified=this.defListField=this.defIndentValueFieldSpecified=!1;this.defLnSpcField=null;this.defMarginFieldSpecified=this.defMarginField=!1;this.defMarLValueField=0;this.defMarLValueFieldSpecified=!1;this.defSpcBefField=this.defSpcAftField=this.defRPrField=null;this.defTabSzField=0;this.eaLnBrkFieldSpecified=this.eaLnBrkField=this.defTabSzFieldSpecified=!1;this.fontAlgnField=0;this.hangingPunctFieldSpecified=this.hangingPunctField=
this.fontAlgnFieldSpecified=!1;this.indentField=0;this.latinLnBrkFieldSpecified=this.latinLnBrkField=this.indentFieldSpecified=!1;this.lnSpcField=null;this.lvlField=0;this.lvlFieldSpecified=!1;this.marLField=0;this.marLFieldSpecified=!1;this.marRField=0;this.rtlFieldSpecified=this.rtlField=this.marRFieldSpecified=!1;this.spcBefField=this.spcAftField=null}}Object(m.a)(Ns,"CT_WebTextParagraphProperties",null,[]);class dv{constructor(a,b){this.shapeText=a;this.HRb=b}}Object(m.a)(dv,"ShapeTextState",
null,[]);class ev{constructor(){this.chngTyp=0;this.repChar=this.delChar=this.insChar=this.bodyPrChng=this.paraFrmtChng=this.charFrmtChng=null}}Object(m.a)(ev,"IncrementalRequestTextOperation",null,[]);class ik{constructor(a,b){this.len=this.cp=0;this.cp=a;this.len=b}$G(){return this.cp+this.len}contains(a){return this.cp<=a&&a<this.$G()}Zxa(a){return this.contains(a.cp)||a.contains(this.cp)}MFa(a){const b=Math.max(a.cp,this.cp);return new ik(b,Math.max(0,Math.min(a.$G(),this.$G())-1-b+1))}static copy(a){return new ik(a.cp,
a.len)}}Object(m.a)(ik,"TextRange",null,[]);class Co{constructor(a){this.Tq=a}}Object(m.a)(Co,"ChangeState",null,[]);const Lw=(a,b)=>{if(!(a&&b&&a.rPrField&&b.rPrField))return null;let c=!1;const f=new dr;a.rPrField.bField!==b.rPrField.bField&&(c=!0,f.bField=b.rPrField.bField,f.bFieldSpecified=b.rPrField.bFieldSpecified);a.rPrField.iField!==b.rPrField.iField&&(c=!0,f.iField=b.rPrField.iField,f.iFieldSpecified=b.rPrField.iFieldSpecified);a.rPrField.uField!==b.rPrField.uField&&(c=!0,f.uField=b.rPrField.uField,
f.uFieldSpecified=b.rPrField.uFieldSpecified);a.rPrField.strikeField!==b.rPrField.strikeField&&(c=!0,f.strikeField=b.rPrField.strikeField,f.strikeFieldSpecified=b.rPrField.strikeFieldSpecified);a.rPrField.szField!==b.rPrField.szField&&(c=!0,f.szField=b.rPrField.szField,f.szFieldSpecified=b.rPrField.szFieldSpecified);a.rPrField.spcField!==b.rPrField.spcField&&(c=!0,f.spcField=b.rPrField.spcField,f.spcFieldSpecified=b.rPrField.spcFieldSpecified);a.rPrField.kernField!==b.rPrField.kernField&&(c=!0,f.kernField=
b.rPrField.kernField,f.kernFieldSpecified=b.rPrField.kernFieldSpecified);a.rPrField.capField!==b.rPrField.capField&&(c=!0,f.capField=b.rPrField.capField,f.capFieldSpecified=b.rPrField.capFieldSpecified);a.rPrField.baselineField!==b.rPrField.baselineField&&(c=!0,f.baselineField=b.rPrField.baselineField,f.baselineFieldSpecified=b.rPrField.baselineFieldSpecified);!b.rPrField.latinField||a.rPrField.latinField&&a.rPrField.latinField.typefaceField===b.rPrField.latinField.typefaceField||(c=!0,f.latinField=
b.rPrField.latinField);!b.rPrField.eaField||a.rPrField.eaField&&a.rPrField.eaField.typefaceField===b.rPrField.eaField.typefaceField||(c=!0,f.eaField=b.rPrField.eaField);return c?f:null},ty=(a,b)=>{if(!(a&&b&&a.pPrField&&b.pPrField))return null;a=a.pPrField;b=b.pPrField;const c=new Ns;let f=!1;er(a.lnSpcField,b.lnSpcField)&&(c.lnSpcField=b.lnSpcField,f=!0);er(a.defLnSpcField,b.defLnSpcField)&&(c.defLnSpcField=b.defLnSpcField,f=!0);er(a.spcBefField,b.spcBefField)&&(c.spcBefField=b.spcBefField,f=!0);
er(a.defSpcBefField,b.defSpcBefField)&&(c.defSpcBefField=b.defSpcBefField,f=!0);er(a.spcAftField,b.spcAftField)&&(c.spcAftField=b.spcAftField,f=!0);er(a.defSpcAftField,b.defSpcAftField)&&(c.defSpcAftField=b.defSpcAftField,f=!0);De.c(a.defRPrField)!==De.c(b.defRPrField)&&(c.defRPrField=b.defRPrField,f=!0);!a.buNoneField!==!b.buNoneField&&(c.buNoneField=b.buNoneField,f=!0);De.c(a.buCharField)!==De.c(b.buCharField)&&(c.buCharField=b.buCharField,f=!0);De.c(a.buAutoNumField)!==De.c(b.buAutoNumField)&&
(c.buAutoNumField=b.buAutoNumField,f=!0);De.c(a.buFontField)!==De.c(b.buFontField)&&(c.buFontField=b.buFontField,f=!0);if(a.marLFieldSpecified!==b.marLFieldSpecified||a.marLField!==b.marLField)c.marLFieldSpecified=b.marLFieldSpecified,c.marLField=b.marLField,f=!0;if(a.defMarLValueFieldSpecified!==b.defMarLValueFieldSpecified||a.defMarLValueField!==b.defMarLValueField)c.defMarLValueFieldSpecified=b.defMarLValueFieldSpecified,c.defMarLValueField=b.defMarLValueField,f=!0;if(a.marRFieldSpecified!==b.marRFieldSpecified||
a.marRField!==b.marRField)c.marRFieldSpecified=b.marRFieldSpecified,c.marRField=b.marRField,f=!0;if(a.lvlFieldSpecified!==b.lvlFieldSpecified||a.lvlField!==b.lvlField)c.lvlFieldSpecified=b.lvlFieldSpecified,c.lvlField=b.lvlField,f=!0;if(a.indentFieldSpecified!==b.indentFieldSpecified||a.indentField!==b.indentField)c.indentFieldSpecified=b.indentFieldSpecified,c.indentField=b.indentField,f=!0;if(a.defIndentFieldSpecified!==b.defIndentFieldSpecified||a.defIndentField!==b.defIndentField)c.defIndentFieldSpecified=
b.defIndentFieldSpecified,c.defIndentField=b.defIndentField,f=!0;if(a.algnFieldSpecified!==b.algnFieldSpecified||a.algnField!==b.algnField)c.algnFieldSpecified=b.algnFieldSpecified,c.algnField=b.algnField,f=!0;if(a.defTabSzFieldSpecified!==b.defTabSzFieldSpecified||a.defTabSzField!==b.defTabSzField)c.defTabSzFieldSpecified=b.defTabSzFieldSpecified,c.defTabSzField=b.defTabSzField,f=!0;if(a.rtlFieldSpecified!==b.rtlFieldSpecified||a.rtlField!==b.rtlField)c.rtlFieldSpecified=b.rtlFieldSpecified,c.rtlField=
b.rtlField,f=!0;if(a.defListFieldSpecified!==b.defListFieldSpecified||a.defListField!==b.defListField)c.defListFieldSpecified=b.defListFieldSpecified,c.defListField=b.defListField,f=!0;if(a.defMarginFieldSpecified!==b.defMarginFieldSpecified||a.defMarginField!==b.defMarginField)c.defMarginFieldSpecified=b.defMarginFieldSpecified,c.defMarginField=b.defMarginField,f=!0;if(a.eaLnBrkFieldSpecified!==b.eaLnBrkFieldSpecified||a.eaLnBrkField!==b.eaLnBrkField)c.eaLnBrkFieldSpecified=b.eaLnBrkFieldSpecified,
c.eaLnBrkField=b.eaLnBrkField,f=!0;if(a.fontAlgnFieldSpecified!==b.fontAlgnFieldSpecified||a.fontAlgnField!==b.fontAlgnField)c.fontAlgnFieldSpecified=b.fontAlgnFieldSpecified,c.fontAlgnField=b.fontAlgnField,f=!0;if(a.latinLnBrkFieldSpecified!==b.latinLnBrkFieldSpecified||a.latinLnBrkField!==b.latinLnBrkField)c.latinLnBrkFieldSpecified=b.latinLnBrkFieldSpecified,c.latinLnBrkField=b.latinLnBrkField,f=!0;return f?c:null},er=(a,b)=>a||b?a&&b?a.itemField.valField!==b.itemField.valField:!0:!1;class fv{constructor(){this.ro=
this.uIa=null}}Object(m.a)(fv,"TextParaRange",null,[]);class Os{constructor(){this.ro=this.jJa=null}}Object(m.a)(Os,"TextRunRange",null,[]);class Mw{constructor(a,b,c,f,l,y){this.Dfa=this.qna=null;this.C5=this.kma=0;this.gM=this.P4=null;this.Twa=this.XGa=0;this.YGa=c;this.IIa=f;this.mma=l;this.S$=y;this.Bsd(new ik(0,a.shapeText.length),new ik(0,b.shapeText.length))}Bsd(a,b){this.qna=a;this.Dfa=b;for(a=Math.max(0,this.XGa-1);a<this.YGa.length;a++)if(this.YGa[a].ro.Zxa(this.qna)||this.qna.$G()<=this.YGa[a].ro.cp){this.XGa=
a;break}for(a=Math.max(0,this.Twa-1);a<this.IIa.length;a++)if(this.IIa[a].ro.Zxa(this.Dfa)||this.Dfa.$G()<=this.IIa[a].ro.cp){this.Twa=a;break}this.gM=this.P4=null;for(a=Math.max(0,this.kma-1);a<this.mma.length;a++)if(this.mma[a].ro.Zxa(this.qna)||this.qna.$G()<=this.mma[a].ro.cp){this.kma=a;break}for(a=Math.max(0,this.C5-1);a<this.S$.length;a++)if(this.S$[a].ro.Zxa(this.Dfa)||this.Dfa.$G()<=this.S$[a].ro.cp){this.C5=a;break}}OQf(){return this.XGa>=this.YGa.length?null:Object.assign(new fv,{uIa:this.YGa[this.XGa].uIa,
ro:this.YGa[this.XGa].ro.MFa(this.qna)})}PQf(){return this.Twa>=this.IIa.length?null:Object.assign(new fv,{uIa:this.IIa[this.Twa].uIa,ro:this.IIa[this.Twa].ro.MFa(this.Dfa)})}RQf(){return this.Zme()&&this.P4?Object.assign(new Os,{jJa:this.mma[this.kma].jJa,ro:this.P4}):null}SQf(){return this.Gac()&&this.gM?Object.assign(new Os,{jJa:this.S$[this.C5].jJa,ro:this.gM}):null}Yme(){return this.gng()&&this.Fac()}gng(){return this.XGa>=this.YGa.length?!1:this.YGa[this.XGa].ro.Zxa(this.qna)}Fac(){return this.Twa>=
this.IIa.length?!1:this.IIa[this.Twa].ro.Zxa(this.Dfa)}Zme(){return!this.gng()||this.kma>=this.mma.length?!1:this.mma[this.kma].ro.Zxa(this.YGa[this.XGa].ro)&&this.mma[this.kma].ro.Zxa(this.qna)}Gac(){return!this.Fac()||this.C5>=this.S$.length?!1:this.S$[this.C5].ro.Zxa(this.IIa[this.Twa].ro)&&this.S$[this.C5].ro.Zxa(this.Dfa)}UKh(){this.Yme()&&(this.XGa++,this.Twa++);return this.Yme()}VKh(){this.Fac()&&this.Twa++;return this.Fac()}kKl(){if(!this.Zme()||!this.Gac())return!1;if(this.P4&&this.gM){this.P4.$G()===
this.mma[this.kma].ro.$G()&&this.kma++;this.gM.$G()===this.S$[this.C5].ro.$G()&&this.C5++;if(!this.Zme()||!this.Gac())return!1;var a=this.mma[this.kma].ro.MFa(this.qna);this.P4.cp=Math.max(a.cp,this.P4.$G());this.P4.len=a.$G()-this.P4.cp;a=this.S$[this.C5].ro.MFa(this.Dfa);this.gM.cp=Math.max(a.cp,this.gM.$G());this.gM.len=a.$G()-this.gM.cp}else this.P4=this.mma[this.kma].ro.MFa(this.qna),this.gM=this.S$[this.C5].ro.MFa(this.Dfa);a=Math.min(this.P4.len,this.gM.len);this.P4.len=a;this.gM.len=a;return 0<
a}lKl(){if(!this.Gac())return!1;this.P4||(this.P4=this.mma[this.kma].ro.MFa(this.qna));if(this.gM){if(this.gM.$G()===this.S$[this.C5].ro.$G()&&(this.C5++,!this.Gac()))return!1;const a=this.S$[this.C5].ro.MFa(this.Dfa);this.gM.cp=Math.max(a.cp,this.gM.$G());this.gM.len=a.$G()-this.gM.cp}else this.gM=this.S$[this.C5].ro.MFa(this.Dfa);return 0<this.gM.len}}Object(m.a)(Mw,"TextFormatIterator",null,[]);class Nw{constructor(){this.txt=this.txtrng=null}}Object(m.a)(Nw,"TextModificationData",null,[]);class Ps{constructor(a,
b){this.textRange=new ik(a.cp,a.len);this.text=b}}Object(m.a)(Ps,"TextModificationInfo",null,[]);class gv{constructor(){this.len=this.cp=0}}Object(m.a)(gv,"TextRangeData",null,[]);class Rt{constructor(){this.charPrp=this.txtrng=null}}Object(m.a)(Rt,"WebTextCharFormatChange",null,[]);class hv{constructor(){this.paraPrp=this.txtrng=null}}Object(m.a)(hv,"WebTextParaFormatChange",null,[]);class Or{constructor(a,b){this.Cyg=this.zYa=this.pFb=this.ana=this.zU=-1;this.MDe=this.xue=null;this.qXa=new ik(0,
0);this.wma=new ik(0,0);this.K0=null;if(!a)throw Error.create("InputBaseTextStateNull");if(!b)throw Error.create("InputRevisedTextStateNull");this.bDb=a;this.ygb=b;let c,f;({KXe:a,bOe:c}=this.ucg(a.HRb));1<a.length&&(this.Cyg=a[a.length-1].ro.$G());({KXe:b,bOe:f}=this.ucg(b.HRb));this.EO=new Mw(this.bDb,this.ygb,c,f,a,b)}wEi(){this.nEi();this.oEi();this.yEi();const a=[],b=this.EEi();b&&a.push(b);a.push.apply(a,this.uEi());a.push.apply(a,this.tEi());a.push.apply(a,this.vEi());return a}ucg(a){const b=
[],c=[];var f=[];var l=[];let y=0;if(!a.pField)return{KXe:f,bOe:l};for(const H of a.pField)if(a=new fv,a.uIa=H,a.ro=new ik(y,0),f=0,H.itemsField&&H.itemsField.length){for(const Q of H.itemsField)Q.tField&&Q.tField.length&&(l=new Os,l.ro=new ik(y,Q.tField.length),l.jJa=Q,y+=Q.tField.length,f+=Q.tField.length,b.push(l));y+=1;a.ro.len=f;c.push(a)}return{KXe:b,bOe:c}}nEi(){this.zU=this.Tfd(!0)}oEi(){this.zU===this.bDb.shapeText.length?this.ana=0:(this.ana=this.Tfd(!1),this.zU+this.ana>this.bDb.shapeText.length?
this.ana=this.bDb.shapeText.length-this.zU:this.zU+this.ana>this.ygb.shapeText.length&&(this.ana=this.ygb.shapeText.length-this.zU))}yEi(){this.pFb=this.bDb.shapeText.length-this.zU-this.ana;this.zYa=this.ygb.shapeText.length-this.zU-this.ana}uEi(){const a=[];if(!this.zU)return a;this.EO.Bsd(new ik(0,this.zU),new ik(0,this.zU));do this.K0=this.sKh(),0!==this.K0.Tq&&a.push(this.rUc(this.K0));while(0!==this.K0.Tq);return a}EEi(){if(!this.pFb&&!this.zYa)return null;this.qXa=new ik(this.zU,this.pFb);
this.wma=new ik(this.zU,this.zYa);this.K0=!this.pFb&&0<this.zYa?new Co(4):0<this.pFb&&!this.zYa?new Co(5):new Co(6);return this.rUc(this.K0)}tEi(){const a=[];if(!this.zYa)return a;const b=new ik(this.zU-1,1);b.cp=Math.max(0,b.cp);b.cp=Math.min(b.cp,this.Cyg-1);this.EO.Bsd(b,new ik(this.zU,this.zYa));do this.K0=this.EJl(),0!==this.K0.Tq&&a.push(this.rUc(this.K0));while(0!==this.K0.Tq);return a}vEi(){const a=[];if(!this.ana)return a;this.K0=null;this.EO.Bsd(new ik(this.zU+this.pFb,this.ana),new ik(this.zU+
this.zYa,this.ana));do this.K0=this.sKh(),0!==this.K0.Tq&&a.push(this.rUc(this.K0));while(0!==this.K0.Tq);return a}rUc(a){if(!a)return null;const b=new ev;b.chngTyp=a.Tq;switch(a.Tq){case 3:b.charFrmtChng=Object.assign(new Rt,{txtrng:this.wma,charPrp:this.xue});break;case 2:b.paraFrmtChng=Object.assign(new hv,{txtrng:this.wma,paraPrp:this.MDe});break;case 4:b.insChar=Or.V5e(new Ps(this.qXa,this.ygb.shapeText.substring(this.wma.cp,this.wma.$G())));break;case 5:b.delChar=Or.V5e(new Ps(this.qXa,""));
break;case 6:b.repChar=Or.V5e(new Ps(this.qXa,this.ygb.shapeText.substring(this.wma.cp,this.wma.$G())))}return b}Tfd(a){const b=this.bDb.shapeText,c=this.ygb.shapeText,f=new ik(0,b.length),l=new ik(0,c.length);let y=a?0:b.length-1,H=a?0:c.length-1;for(;f.contains(y)&&l.contains(H)&&b.charAt(y)===c.charAt(H);)y=a?y+1:y-1,H=a?H+1:H-1;return a?y:b.length-y-1}EJl(){do{for(;this.EO.lKl();){var a=this.EO.RQf(),b=this.EO.SQf();if(a&&b){var c=Lw(a.jJa,b.jJa);this.qXa=ik.copy(a.ro);this.wma=ik.copy(b.ro);
if(c)return this.xue=c,new Co(3)}}if(this.EO.Fac()&&(a=this.EO.OQf(),b=this.EO.PQf(),a&&b&&(c=ty(a.uIa,b.uIa),this.qXa=ik.copy(a.ro),this.wma=ik.copy(b.ro),c)))return this.MDe=c,this.EO.VKh(),new Co(2)}while(this.EO.VKh());return new Co(0)}sKh(){do{for(;this.EO.kKl();){var a=this.EO.RQf(),b=this.EO.SQf();if(a&&b){var c=Lw(a.jJa,b.jJa);this.qXa=ik.copy(a.ro);this.wma=ik.copy(b.ro);if(c)return this.xue=c,new Co(3)}}if(this.EO.Yme()&&(a=this.EO.OQf(),b=this.EO.PQf(),a&&b&&(c=ty(a.uIa,b.uIa),this.qXa=
ik.copy(a.ro),this.wma=ik.copy(b.ro),c)))return this.MDe=c,this.EO.UKh(),new Co(2)}while(this.EO.UKh());return new Co(0)}static V5e(a){return Object.assign(new Nw,{txt:a.text,txtrng:Or.wFl(a.textRange)})}static wFl(a){return Object.assign(new gv,{cp:a.cp,len:a.len})}}Object(m.a)(Or,"IncrementalChangeIterator",null,[]);class fr{constructor(){this.rh=this.bh=this.increq=null}}Object(m.a)(fr,"TextLayoutDeltaClientRequestData",null,[]);class uy{constructor(){this.tb=null;this.h=this.w=0}}Object(m.a)(uy,
"TextLayoutFullClientRequest",null,[]);class gr{constructor(){this.corr=this.id=null;this.h={};this.delta=this.full=null}}Object(m.a)(gr,"TextLayoutRequest",null,[]);class St{constructor(a,b,c,f,l,y){this.yic=this.Zl=null;this.Ifc=!0;this.zIa=-1;this.Nmk=(new Date).getTime();this.ufb=this.vma=0;this.Cec=-1;this.Cue=5E3;const H=document.createElement("a");H.href=a;H.protocol="http:"===H.protocol?"ws":"wss";this.EHb=H.href;this.f5=b;this.C2b();this.iMg=c;this.rNg=f;this.jmk=l;this.cEe=y.rFl;this.Aad=
y.qFl;this.FXg=y.nFl;this.Ocd=y.mFl;this.vna=this.FXg;this.q0e()}onMessage(a){if(a&&a.data)if(a.data.startsWith("pong"))this.bJb(a.data);else if(a=JSON.parse(a.data)){a.h||(a.h={});a.h.bEnd=(new Date).getTime().toString();try{this.rNg&&this.rNg(a)}catch(b){xa.a.J(578828128,824,50,(this.f5?"Dark Traffic ":"")+"Exception in OnTextLayoutReceived: {0}",b.toString())}if(this.iMg){const b={Caller:"WebSocketTextLayoutFetcher.OnMessage"};b.Telemetry=a.h;b.Response=a.resp;b.First=this.Ifc;this.iMg(b)}this.Ifc=
!1}else xa.a.J(592304271,820,50,(this.f5?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnMessage Empty Response")}onClose(a){xa.a.J(592840414,820,50,(this.f5?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnClose {0}",JSON.stringify(a))}onError(a){xa.a.J(592840412,820,10,(this.f5?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnError {0}",JSON.stringify(a))}onOpen(){xa.a.J(592840410,820,50,(this.f5?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnOpen");this.xrc();this.ping();this.jmk()}q0e(){this.yic=
()=>{"visible"===window.document.visibilityState?(window.clearTimeout(this.Cec),this.Zl||(xa.a.J(587522389,820,50,(this.f5?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::PageVisibilityEventHandler Reconnecting after visibility regained."),this.Lya())):this.Cec=window.setTimeout(()=>{this.Zl&&(xa.a.J(587522387,820,50,(this.f5?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::PageVisibilityEventHandler Closing due to visibility lost."),this.Zl.close(),this.Zl=null,window.clearTimeout(this.zIa))},this.Cue)};
window.self.addEventListener("visibilitychange",this.yic)}C2b(){this.Zl&&this.Zl.close();this.Zl=new WebSocket(this.EHb,[]);this.Zl.onopen=Object(I.a)(this,this.onOpen,"onOpen");this.Zl.onerror=Object(I.a)(this,this.onError,"onError");this.Zl.onclose=Object(I.a)(this,this.onClose,"onClose");this.Zl.onmessage=Object(I.a)(this,this.onMessage,"onMessage")}xrc(){this.vma=0}$Td(){0<this.Ocd&&(new Date).getTime()-this.ufb>this.Ocd&&(this.xrc(),xa.a.J(587337758,820,50,(this.f5?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Retry connect to server after long pause."))}VXd(){return(new Date).getTime()-
this.ufb>this.vna&&this.vma<this.Aad&&(!this.Zl||3===this.Zl.readyState||2===this.Zl.readyState)}z_e(){this.ufb=(new Date).getTime();this.vna=Math.pow(2,this.vma)*this.FXg;0<this.Ocd&&(this.vna=Math.min(this.vna,this.Ocd));window.setTimeout(()=>{this.Lya()},this.vna)}Lya(){this.$Td();this.VXd()&&(this.C2b(),this.z_e(),this.vma++,xa.a.J(588071072,820,50,(this.f5?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Retry connect to server."),this.vma===this.Aad&&xa.a.J(588071070,820,50,(this.f5?"Dark Traffic ":
"")+"WebSocketTextLayoutFetcher::Max retries reached."))}fetch(a){this.Zl?(xa.a.J(587804674,820,50,(this.f5?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Fetch. WebSocket state {0}",Jl[this.Zl.readyState]),1===this.Zl.readyState?this.Zl.send(De.c(a)):this.Lya()):xa.a.J(587522383,820,50,(this.f5?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Fetch Websocket is unavailable.")}ping(){this.Zl?1===this.Zl.readyState?this.Zl.send("ping"+((new Date).getTime()-this.Nmk).toString()):(xa.a.J(588294232,
820,10,(this.f5?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Ping. Wrong WebSocket state {0}",this.Zl.readyState),this.Lya()):xa.a.J(587522380,820,50,(this.f5?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Ping Websocket is unavailable.")}bJb(){-1!==this.zIa&&window.clearTimeout(this.zIa);this.zIa=window.setTimeout(()=>{this.ping()},this.cEe)}}Object(m.a)(St,"WebSocketTextLayoutFetcher",null,[1293]);class Bp{constructor(a,b,c,f,l,y,H){this.UGb=this.Lgb=this.MDg=this.LDg=null;this.nextId=1;this.Iue=
-1;this.Hue=0;this.rye=!0;if(!a)throw Error.argumentNull("shapeReader");if(!b)throw Error.argumentNull("topologyManager");if(!c)throw Error.argumentNull("clientRequestManager");if(!f)throw Error.argumentNull("walls");if(!l)throw Error.argumentNull("appSettings");if(!y)throw Error.argumentNull("shapeViewLineBreakTelemetry");this.Ga=a;this.oq=b;this.Qfa=f;this.la=l;this.OU=-1;y.execute(Q=>{this.Lgb=Q});this.la.tFl&&(this.LDg=new St(this.la.pFl,!1,Object(I.a)(this,this.lck,"logOnResponseReceived"),Object(I.a)(this,
this.wIk,"onTextLayoutReceived"),Object(I.a)(this,this.v8g,"onConnectionOpen"),this.la),this.la.ehh&&(this.MDg=new St(this.la.oFl,!0,Object(I.a)(this,this.kck,"logOnDarkTrafficResponseReceived"),null,Object(I.a)(this,this.v8g,"onConnectionOpen"),this.la)));this.Afa=H}PM(a,b,c){xa.a.J(512495621,820,50,"TextLayoutManager::OnTimeout - Fallback to HTML Text Layout for this shape ");if(-1!==this.OU){window.clearTimeout(this.OU);this.OU=-1;var f=this.oq.presentation;f?(a=Object(qa.a)(118,f.ZC(Va.a.Uy(a,
b))))?(c=a.GQ(c))?c.wnb(!1):xa.a.J(512495618,820,50,"TextLayoutManager::OnTimeout, IShapeNode is null"):xa.a.J(512495619,820,50,"TextLayoutManager::OnTimeout, ISlide is null"):xa.a.J(512495620,820,50,"TextLayoutManager::OnTimeout, IPageManifestNode is null")}}jck(){this.Hue++;-1===this.Iue&&(this.Iue=window.setTimeout(Object(I.a)(this,this.GBk,"onCoauthLogTimer"),3E5))}GBk(){this.Iue=-1;xa.a.J(512495617,820,50,"TextLayoutManager::LogOnCoAuth, CoAuthRequestCount {0}",this.Hue);this.Hue=0}Xag(a){let b=
"";a.eK(c=>{(c=Object(qa.a)(kf.AParagraphNode,c))&&(b+=Db.ParagraphReader.text(c)+"\n")});return b.substr(0,b.length-1)}xEi(a){try{var b=Object,c=b.assign,f=new fr,l=this.UGb;const wa=[];var y,H=l.HRb.bodyPrField,Q=a.HRb.bodyPrField;let Ua=!1;H.anchorField!==Q.anchorField&&(Ua=!0);H.bInsField!==Q.bInsField&&(Ua=!0);H.tInsField!==Q.tInsField&&(Ua=!0);H.lInsField!==Q.lInsField&&(Ua=!0);H.rInsField!==Q.rInsField&&(Ua=!0);H.horzOverflowField!==Q.horzOverflowField&&(Ua=!0);H.vertOverflowField!==Q.vertOverflowField&&
(Ua=!0);De.c(H.normAutofitField)!==De.c(Q.normAutofitField)&&(Ua=!0);De.c(H.spAutoFitField)!==De.c(Q.spAutoFitField)&&(Ua=!0);H.rotField!==Q.rotField&&(Ua=!0);H.spcFirstLastParaField!==Q.spcFirstLastParaField&&(Ua=!0);H.wrapField!==Q.wrapField&&(Ua=!0);(y=Ua?Q:null)&&wa.push(Object.assign(new ev,{chngTyp:1,bodyPrChng:y}));const kb=new Or(l,a);var ia=wa.concat.apply(wa,kb.wEi());const Gb=c.call(b,f,{increq:ia});xa.a.J(512495616,820,50,"TextLayoutManager::FetchLineBreakInfo Incremental request size {0}",
De.c(Gb).length);return Gb}catch(wa){xa.a.J(512493795,820,10,"TextLayoutManager::Generate Incremental Requests Exception {0}",wa.message)}return null}S6d(a,b){if(this.la.iIh&&a)if(b&&xa.a.J(512493794,820,50,"TextLayoutManager::FetchLineBreakInfo, TextLayout- First request for this shape sent on Begin Edit."),this.Qfa.Bwi())if(0!==this.Qfa.Lzi(a,this.Ga))a.wnb(!1);else{if(!a.YDb)if(b)a.wnb(this.la.VPb);else return;if(!a.DB&&a.i9().length&&(a.HMa||4===a.hL))try{const c=this.lee(a),f=Object.assign(new gr,
{id:this.nextId.toString(),corr:Hg.a.create().toString()});if(this.la.sFl)if(!this.UGb||b||this.rye)this.UGb=new dv(this.Xag(a),c),this.rye=!1;else{const y=this.Xag(a),H=new dv(y,c),Q=Nt.a.Gxb(De.c(this.UGb.HRb));f.delta=this.xEi(H);f.delta&&(f.delta.bh=Q,f.delta.rh=Nt.a.Gxb(De.c(H.HRb)));if(f.delta&&!f.delta.increq.length)if(this.la.U5e)f.delta=null;else return;if(f.delta&&f.delta.increq.length)for(const ia of f.delta.increq)if(ia.repChar){ia.repChar.txtrng.len===this.UGb.shapeText.length&&(f.delta=
null);break}this.UGb=H}f.delta&&f.delta.increq.length&&!this.la.U5e||(f.full=Object.assign(new uy,{tb:c,w:a.HMa?a.HMa.Right:a.get_widthPersisted(),h:a.HMa?a.HMa.Bottom:a.get_heightPersisted()}));this.nextId+=1;-1!==this.OU&&window.clearTimeout(this.OU);this.OU=window.setTimeout(()=>{this.PM(a.slideId.sid,a.slideId.cid,a.get_shapeId())},this.la.uFl);f.h={["bStart"]:(new Date).getTime().toString()};f.h.shapeId=a.get_shapeId();f.h.sid=a.slideId.sid;f.h.cid=a.slideId.cid;f.h.timeoutId=this.OU;f.h.reqHash=
Nt.a.Gxb(De.c(c));f.h.reqSz=De.c(f).length;f.h.firstRequest=b;f.h.deltaCompare=this.la.U5e;const l=a.Tuj();b&&l&&(f.h.initialTextLayout=l.toString());this.LDg.fetch(f);this.la.ehh&&this.MDg.fetch(f)}catch(c){xa.a.J(512493793,820,10,"WebSocketTextLayoutFetcher::FetchLineBreakInfo Exception {0}",c.message)}}else this.jck(),a.wnb(!1)}DNf(a,b){switch(a.listType){case 16:b.buNoneField=new Ms;b.buCharField=null;b.buAutoNumField=null;break;case 0:b.buNoneField=null;b.buCharField=null;b.buAutoNumField=Object.assign(new Pt,
{startAtField:a.SA});b.buAutoNumField.typeField=8;break;default:b.buNoneField=null,b.buCharField=new bv,b.buCharField.charField="\u2022",b.buAutoNumField=null,b.buFontField=new Fk,b.buFontField.typefaceField=a.font}}iUa(a){const b=new Iw;b.__type=Bp.U8j;b.valField=Math.floor(1E5*a);return b}bIi(a){const b=new Ns;var c=new ob.GraphIterator;c.set(a);c.sc(11);c.Kg(11);a.Uf.Gv(c)?this.DNf(a.Uf.Gv(c),b):this.DNf(pe.a.NN(16,0),b);c=a.sa(Ab.a.nm,Df.a.leftMargin);const f=a.sa(Ab.a.CY,Df.a.rightMargin);b.indentField=
xe.a.Exd(a.sa(Ab.a.uo,Df.a.indent));b.indentFieldSpecified=!0;b.marLField=xe.a.Exd(c);b.marLFieldSpecified=!0;b.marRField=xe.a.Exd(f);b.marRFieldSpecified=!0;b.defTabSzField=xe.a.Exd(a.sa(Ab.a.Tvb,Bp.zLc));b.defTabSzFieldSpecified=!0;b.lvlField=a.sa(Ab.a.listLevel,Df.a.yFa);b.lvlFieldSpecified=!0;b.algnField=this.kFl(a.sa(ab.a.Vl,1));b.algnFieldSpecified=!0;2===this.Afa.VW(a).lineSpacing.unit&&(b.lnSpcField=new Qt,b.lnSpcField.itemField=this.iUa(this.Afa.VW(a).lineSpacing.value));2===this.Afa.VW(a).beforeSpacing.unit&&
(b.spcBefField=new Qt,b.spcBefField.itemField=this.iUa(this.Afa.VW(a).beforeSpacing.value));2===this.Afa.VW(a).afterSpacing.unit&&(b.spcAftField=new Qt,b.spcAftField.itemField=this.iUa(this.Afa.VW(a).afterSpacing.value));a=Za.OutlineElementNavigator.vB(a);a.properties.Ua(ab.a.BY)&&(b.rtlField=a.Rh(ab.a.BY));return b}kFl(a){switch(a){case 2:return 1;case 1:return 0;case 3:return 2;case 4:return 3;default:return 0}}lee(a){try{const b=Object.assign(new Bo,{bodyPrField:new Jw,pField:[]});b.bodyPrField.noAutofitField=
a.taa?new Hw:null;a.Ua(zb.a.m3)&&(b.bodyPrField.normAutofitField=new cv,b.bodyPrField.normAutofitField.fontScaleField=Math.floor(1E5*a.m3));a.Ua(zb.a.qsa)&&(b.bodyPrField.normAutofitField||(b.bodyPrField.normAutofitField=new cv),b.bodyPrField.normAutofitField.lnSpcReductionField=Math.floor(1E5*a.qsa));b.bodyPrField.rotField=Math.floor(a.X5e);b.bodyPrField.vertField=a.S6;b.bodyPrField.lInsField=Math.floor(Fb.a.fIb(a.vja));b.bodyPrField.tInsField=Math.floor(Fb.a.fIb(a.xja));b.bodyPrField.rInsField=
Math.floor(Fb.a.fIb(a.wja));b.bodyPrField.bInsField=Math.floor(Fb.a.fIb(a.uja));b.bodyPrField.anchorField=a.Mpa;b.bodyPrField.wrapField=a.m3c?0:1;this.Ga.eK(a,c=>{if(c=Object(qa.a)(kf.AParagraphNode,c)){var f=Object.assign(new Kw,{itemsField:[]});f.pPrField=this.bIi(c);for(var l=Db.ParagraphReader.text(c),y=0;y<c.Ta.length;){const Q=new Lm;Q.__type="CT_WebRegularTextRun:#Microsoft.Office.Server.Powerpoint.Interface.Edit";var H=c.Ta.ga(y);const ia=H.cp,wa=y<c.Ta.length-1?c.Ta.ga(y+1).cp:Db.ParagraphReader.textLength(c);
y++;H.formatting?Q.rPrField=this.vcg(H.formatting.cache):(H=sy.c(c.Ta,H.cp).j4c,Q.rPrField=H?this.vcg(H.cache):this.Wuj(a));Q.tField=ma.a.substring(l,ia,wa);f.itemsField.push(Q)}b.pField.push(f)}});return b}catch(b){throw xa.a.J(512493792,820,50,"WebSocketTextLayoutFetcher::GetWebTextBody Exception {0}",b.message),Error.create("GetWebTextBodyException");}}vcg(a){const b=new dr;b.bField=a.isBold;b.bFieldSpecified=a.PUa;b.iField=a.isItalic;b.iFieldSpecified=a.ebb;b.uField=a.xE;b.uFieldSpecified=a.Azb;
b.strikeFieldSpecified=a.zzb;b.strikeField=a.bG;b.szField=a.fontSize*Pf.a.Ioc*Pf.a.nbb;b.szFieldSpecified=a.sua;b.baselineFieldSpecified=a.Ua(zb.a.EN);b.baselineField=a.eb(zb.a.EN);b.capFieldSpecified=a.QUa;b.capField=a.capitalization;if(a.Kgg){const c=bb.a.He(a.language);b.langField=c?c.sxb:"en-US"}a.Ua(zb.a.latinFont)&&(b.latinField=Object.assign(new Fk,{typefaceField:a.eb(zb.a.latinFont)}));a.Ua(zb.a.eastAsianFont)&&(b.eaField=Object.assign(new Fk,{typefaceField:a.eb(zb.a.eastAsianFont)}));a.k4&&
(b.rawSolidFillField=Object.assign(new Ot.a,{srgbClrField:Object.assign(new Gw.a,{valField:rc.a.Itb(a.fontColor)})}));a.VUa&&(b.highlightField=Object.assign(new Rm.a,{srgbClrField:Object.assign(new Gw.a,{valField:rc.a.Itb(a.highlight)})}));a.Ua(zb.a.Iub)&&(b.spcField=a.eb(zb.a.Iub),b.spcFieldSpecified=!0);a.Ua(zb.a.fCb)&&(b.kernField=a.eb(zb.a.fCb),b.kernFieldSpecified=!0);return b}Wuj(a){const b=new dr;b.bField=a.isBold;b.bFieldSpecified=!0;b.iField=a.isItalic;b.iFieldSpecified=!0;b.uField=a.xE;
b.uFieldSpecified=!0;b.strikeFieldSpecified=!0;b.strikeField=a.bG;b.szField=a.pba*Pf.a.Ioc;b.szFieldSpecified=!!b.szField;const c=bb.a.He(a.aUa());b.langField=c?c.sxb:"en-US";a.Ua(zb.a.latinFont)&&(b.latinField=Object.assign(new Fk,{typefaceField:a.eb(zb.a.latinFont)}));a.Ua(zb.a.eastAsianFont)&&(b.eaField=Object.assign(new Fk,{typefaceField:a.eb(zb.a.eastAsianFont)}));b.baselineField=a.EN;b.baselineFieldSpecified=!0;return b}lck(a){if(a){xa.a.J(512493790,820,50,Me.c(a));var b=new Map;for(let l in a){var c=
l,f=a[l];"First"===c&&b.set(c,f.toString());"Telemetry"===c&&b.set(c,JSON.stringify(f))}$d.Health.instance.recordKpiUsage("TextLayoutServiceResponse",0,"pptotext",b)}else xa.a.J(512493791,820,50,"response data null")}kck(a){a?xa.a.J(512493788,820,50,"Dark Traffic"+Me.c(a)):xa.a.J(512493789,820,50,"Dark Traffic response data null")}v8g(){this.rye=!0}T5f(a){var b=this.oq.presentation;if(!b)throw Error.argumentNull("Presentation is null");const c=this.inb(a,"cid"),f=this.inb(a,"sid");a=this.inb(a,"shapeId");
if(!c||!f||!a)return xa.a.J(512493787,820,50,"GetCurrentShapeNode - slideId or shapeId is not present in Hints"),null;b=Object(qa.a)(118,b.ZC(Va.a.Uy(Number.parseInvariant(f),Number.parseInvariant(c))));return b?b.GQ(Number.parseInvariant(a)):(xa.a.J(512493786,820,50,"GetCurrentShapeNode - ISlide is null"),null)}wIk(a){if(!a||!a.l||!a.h)if(a&&7===a.resp&&a.h)xa.a.J(512493785,820,50,"OnTextLayoutReceived - State out of sync"),(a=this.T5f(a.h))?this.S6d(a,!0):xa.a.J(512493784,820,10,"OnTextLayoutReceived - shapenode null");
else{if(xa.a.J(512493783,820,50,"OnTextLayoutReceived - Response data layout is null"),a&&!a.l){var b=new Map;b.set("CorrelationId",a.corr);4===a.resp?$d.Health.instance.recordKpiFailure("TextLayoutServiceResponse","TextLayoutServiceWorkerFailure",!1,!0,Object.assign(new Mj.a,{extendedProperties:b})):(b.set("ResponseCode",a.resp.toString()),$d.Health.instance.recordKpiFailure("TextLayoutServiceResponse","TextLayoutServiceFailureResponse",!1,!0,Object.assign(new Mj.a,{extendedProperties:b})))}}else if(this.la.VPb){b=
this.inb(a.h,"timeoutId");var c=this.inb(a.h,"firstRequest");if(b&&-1!==this.OU&&this.OU===Number.parseInvariant(b))window.clearTimeout(this.OU),this.OU=-1;else if(!c||!Boolean.parse(c))return;if(b=this.T5f(a.h)){var f=this.inb(a.h,"initialTextLayout");c&&Boolean.parse(c)?f&&f!==a.l.toString()?(c=new Map,c.set("CorrelationId",a.corr),c.set("ResponseCode",a.resp.toString()),c.set("InitialTextLayoutValue",f),c.set("ResponseLayout",a.l.toString()),$d.Health.instance.recordKpiFailure("TextLayoutServiceResponse",
"ResponseMismatchForFirstShapeRequest",!1,!0,Object.assign(new Mj.a,{extendedProperties:c})),xa.a.J(512493781,820,50,"Fallback to HTML Text Layout for this shape - different service response on begin edit."),b.wnb(!1)):b.wnb(!0):(f=this.inb(a.h,"reqHash"))?(c=this.lee(b),Nt.a.Gxb(De.c(c))!==f?xa.a.J(512493779,820,50,"OnTextLayoutReceived - Response hash doesn't match the current shapetextbody"):(this.Lgb&&this.Lgb.Dml(f,a.l,b),b.Fyd(a.l))):xa.a.J(512493780,820,50,"OnTextLayoutReceived - missing request hash")}else xa.a.J(512493782,
820,50,"OnTextLayoutReceived - IShapeNode is null")}}inb(a,b){return b in a?a[b].toString():null}}Bp.U8j="CT_TextSpacingPercent:#Microsoft.Office.Server.Powerpoint.Interface.Edit";Bp.zLc=1440;Object(m.a)(Bp,"TextLayoutManager",null,[1262]);var Qs;(function(a){a[a.noWall=0]="noWall";a[a.coauth=1]="coauth";a[a.lineBreakBlobs=2]="lineBreakBlobs";a[a.table=3]="table";a[a.smartArt=4]="smartArt";a[a.nonRectShape=5]="nonRectShape"})(Qs||(Qs={}));Object(m.b)("TextLayoutWall",Qs);var Ow=d(884);class Pw{constructor(a,
b){this.ICe=new Jd.a(0);if(!a)throw Error.argumentNull("coauthManager");if(!b)throw Error.argumentNull("applicationSettings");this.iXa=a;this.Qfa=b.lIh}Kcc(a){switch(a){case 1:return!!this.Qfa.COAUTH;case 2:return!!this.Qfa.LINEBREAKBLOBS;case 3:return!!this.Qfa.TABLE;case 4:return!!this.Qfa.SMARTART;case 5:return!!this.Qfa.NONRECTSHAPE}return!1}Bwi(){return!this.Kcc(1)||this.iXa.EEa}Zzi(a,b){return a?this.Kcc(2)&&Ow.a.NZf(a,b)?2:this.Kcc(3)&&a.vd?3:this.Kcc(4)&&a.Wf?4:this.Kcc(5)&&4!==a.hL?5:0:0}Lzi(a,
b){b=this.Zzi(a,b);if(!this.ICe.Fb(a.aNa)||this.ICe.ga(a.aNa)!==b){const c=new Map;c.set("ShapeType",a.get_shapeTypeString());c.set("ShapeId",a.aNa.toString());c.set("IsShapeWalled",Qs[b]);$d.Health.instance.recordKpiUsage("TextLayoutServiceBlockedShapes",0,"pptotext",c);0!==b&&(c.set("TextLayoutWall",Qs[b]),$d.Health.instance.recordKpiFailure("TextLayoutServiceBlockedShapes","TextLayoutClientWall",!1,!0,Object.assign(new Mj.a,{extendedProperties:c})))}this.ICe.$(a.aNa,b);return b}}Object(m.a)(Pw,
"TextLayoutServiceWalls",null,[1261]);class iv{constructor(a,b,c,f){this.Us=a;this.We=b.Na;this.JO=c;this.G9c=f}initialize(){this.Us.GQa(Object(I.a)(this,this.pAf,"adjustShapeViews"))}dispose(){this.Us.aMb(Object(I.a)(this,this.pAf,"adjustShapeViews"))}pAf(a,b){if((a=b.xG)&&a.gd&&(a=a.gd.F_(c=>c.isEditable&&c.XQ))&&a.length)for(const c of a)if(a=Object(qa.a)(119,c.tg(this.We)))a.ROh(),c.vd&&a.io&&a.mQl(),!this.G9c||this.JO&&!b.$2c||a.pO||!a.CB||a.wGh()}}Object(m.a)(iv,"TextLocalRenderAdjustManager",
null,[107]);class jv{constructor(){this.Gkc=this.$Fb=null;this.Xzg=-1;this.Oec=Date.now()}mgg(){return 0<=this.Xzg}}Object(m.a)(jv,"LineBreakComparison",null,[]);class Tt{constructor(a){this.DH=new Jd.a;this.sLg=0;this.sGf="TextLayoutServiceAccuracy";this.pkc=a}Cml(a,b){try{if(a&&b){var c=a.nz(),f=Nt.a.Gxb(De.c(b.lee(a)));if(!(0>c.length)){b=[];for(let l=0;l<c.length;l++){const y=cl.a.ri(c[l],zb.a.UPb,null);y&&(b.push.apply(b,y.Lines),b.push(-1))}if(b.length){if(!this.DH.Fb(f))this.DH.add(f,new jv);
else if(this.DH.ga(f).mgg())return;this.DH.ga(f).$Fb=b;this.qMf(f,a)}}}}catch(l){xa.a.J(512493704,820,10,l.message)}}Dml(a,b,c){try{if(!this.DH.Fb(a))this.DH.add(a,new jv);else if(this.DH.ga(a).mgg())return;this.DH.ga(a).Gkc=b;this.qMf(a,c)}catch(f){xa.a.J(512493703,820,10,f.message)}}qMf(a,b){if(this.DH.ga(a)&&this.DH.ga(a).$Fb&&this.DH.ga(a).Gkc){var c=!0;if(this.DH.ga(a).$Fb.length!==this.DH.ga(a).Gkc.length)c=!1;else for(var f=0;f<this.DH.ga(a).$Fb.length;f++)if(this.DH.ga(a).$Fb[f]!==this.DH.ga(a).Gkc[f]){c=
!1;break}xa.a.J(512493702,820,50,JSON.stringify({["UniFiedResponseMatchWithLayoutServiceResponse"]:c}));f=new Map;f.set("UniFiedResponseMatchWithLayoutServiceResponse",String.format("{0}",c));b=0<=b.i9().indexOf("\u00a0");f.set("HasNoBreakSpace",b.toString());$d.Health.instance.recordKpiUsage(this.sGf,0,"pptotext",f);c||(f.set("UnifiedResponseLineCount",this.DH.ga(a).$Fb.length.toString()),f.set("TextLayoutResponseLineCount",this.DH.ga(a).Gkc.length.toString()),$d.Health.instance.recordKpiFailure(this.sGf,
"TextLayoutServiceResponseMismatchWithUnifiedResponse",!1,!0,Object.assign(new Mj.a,{extendedProperties:f})));this.DH.ga(a).Xzg=Date.now()}this.mAi()}mAi(){const a=Date.now();a-this.sLg<this.pkc||(this.DH.keys.forEach(b=>{a-this.DH.get(b).Oec>this.pkc&&this.DH.remove(b);return!0}),this.sLg=a)}}Object(m.a)(Tt,"ServiceComparisonLineBreakTelemetry",null,[1263]);class Rs{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TextEditing"}Yb(a){this.K=a;this.K.register(av,"PowerPointWebEditor.TextEditingRevisionInfoTracker").as("PowerPointWebEditor.ITextEditingRevisionInfoTracker").as("PowerPointWebEditor.ITextEditingRevisionInfoReader").ma().oa(()=>
new av(!a.resolve("Common.IAppSettingsManager").ka("DataSyncUseFluid")));this.K.register(Fw,"PowerPointWebEditor.ShapeViewElementTextEditHandler").ma().oa(()=>new Fw(a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.Ia("PowerpointPresence.ICoauthStateChangesHandler"),a.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),a.resolve("PowerPointWebEditor.ITablePartialEditController"),a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),
a.resolve("PowerPointWebEditor.IGraphUpdateStrategy"),a.resolve("Box4.IEditingView"),a.resolve("PowerPointWebEditor.IApplicationSettings").skipProofingSaveWithNoEditHappened,a.Ia("PowerPointWebEditor.ISessionLifetimeManager")));this.K.register(iv,"PowerPointWebEditor.TextLocalRenderAdjustManager").ma().oa(()=>new iv(a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptLayoutThrashingFixEnabled,
a.resolve("PowerPointWebEditor.IApplicationSettings").wng));const b=a.resolve("PowerPointWebEditor.IApplicationSettings").iIh;xa.a.J(590444175,820,50,"PPTWebEditorTextEditingPackage::Configure TextLayoutEnabled:{0}",b);b&&(this.K.register(1261,"PowerPointWebEditor.ITextLayoutServiceWallManager").ma().oa(()=>new Pw(a.resolve("PowerPointWebEditor.CoauthManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"))),this.K.register(1262,"PowerPointWebEditor.ITextLayoutManager").ma().oa(()=>{try{return new Bp(a.resolve("PowerPointWebEditor.IShapeReader"),
a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),w.AFrameworkApplication.Me,a.resolve("PowerPointWebEditor.ITextLayoutServiceWallManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.Ia("PowerPointWebEditor.ITextLayoutLineBreakTelemetry"),a.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"))}catch(c){return xa.a.J(593892503,820,10,"PPTWebEditorTextEditingPackage::Configure Exception creating TextLayoutManager: "+c),null}}),this.K.resolve("PowerPointWebEditor.ITextLayoutManager"),
this.K.register(1263,"PowerPointWebEditor.ITextLayoutLineBreakTelemetry").ma().oa(()=>new Tt(this.K.resolve("PowerPointWebEditor.IApplicationSettings").lFl)),this.K.resolve("PowerPointWebEditor.ITextLayoutLineBreakTelemetry"))}init(){this.K.resolve("PowerPointWebEditor.ITextEditingRevisionInfoTracker");this.K.resolve("PowerPointWebEditor.ShapeViewElementTextEditHandler");this.K.resolve("PowerPointWebEditor.TextLocalRenderAdjustManager").initialize()}dispose(){const a=this.K.resolve("PowerPointWebEditor.IApplicationSettings");
this.K.resolve("PowerPointWebEditor.ShapeViewElementTextEditHandler").dispose();a.wng&&this.K.resolve("PowerPointWebEditor.TextLocalRenderAdjustManager").dispose()}static main(){n.a.instance.Ac(new Rs)}}Object(m.a)(Rs,"PPTWebEditorTextEditingPackage",null,[2,3]);class Qw{constructor(){this.capabilities=2}}Object(m.a)(Qw,"IExternalPeopleAPI",null,[]);class Ut{constructor(a,b){this.OperationResult=a;this.Details=b}}Object(m.a)(Ut,"ExternalGrantAccessResponse",null,[]);class Cp{constructor(a,b,c,f){this.authorImageURL=
this.authorColor=this.authorID=this.authorName=null;this.authorName=a;this.authorID=b;this.authorColor=c;this.authorImageURL=f}}Object(m.a)(Cp,"PersonaIconProperties",null,[]);var kv=d(675),Dp=d(676),Rw=d(538);class lv extends Qw{constructor(a,b,c,f,l){super();this.XV=a;this.n4h=b;this.ghf=c;this.STh=l}qdh(a){this.XV.Zya=a}atMentionsEnabledAsync(){return new Promise((a,b)=>{this.XV.jmg.continueWith(c=>{c.ho||c.Dm?(ka.ULS.sendTraceTag(39068098,380,10,"AtMentionsEnabledAsync failed"),b(Dp.a.kt(-2130915318))):
a(this.XV.jmg.result)})})}checkUserAccess(a){return new Promise((b,c)=>{const f=this.XV.checkUserAccess([a]);f.continueWith(l=>{l.ho||l.Dm?(ka.ULS.sendTraceTag(36287067,380,10,"PeopleManager CheckUserAccess Failed"),c(Dp.a.kt(-2130915318))):b(f.result.Result[0])})})}grantUsersAccess(a){ka.ULS.sendTraceTag(37582727,380,15,"PeopleManager CheckUserAccessAndGrantPermissions usage");return new Promise((b,c)=>{const f=this.XV.YCa(a);f.continueWith(l=>{if(l.ho||l.Dm)ka.ULS.sendTraceTag(36287068,380,10,"PeopleManager CheckUserAccessAndGrantPermissions Failed"),
c(Dp.a.kt(-2130915318));else{l=f.result;var y=!l.Canceled;for(var H of l.Result)if(!H.UserCanWrite&&!H.UserCanReview){y=!1;break}H=new Ut(y,l);b(H)}})})}getContactsForMentions(a,b,c){return new Promise((f,l)=>{const y=this.XV.getUserContacts(a,b,0,c,"AtMentions");y.continueWith(H=>{H.ho||H.Dm?(ka.ULS.sendTraceTag(36287069,380,10,"PeopleManager GetUserContacts Failed"),l(Dp.a.kt(-2130915318))):f(y.result)})})}getAuthToken(){ka.ULS.sendTraceTag(539100293,380,15,"PeopleManager GetAuthToken usage");return new Promise((a,
b)=>{this.ghf.continueWith(c=>{c.ho||c.Dm?(ka.ULS.sendTraceTag(51658781,380,10,"getLokiTokenManagerTask Failed"),b(Dp.a.kt(-2130915318))):this.ghf.result.Jkj().then(f=>{f.isSuccess&&f.token&&0<f.token.length?(ka.ULS.sendTraceTag(539100294,380,15,"PeopleManager GetAuthToken use AAD token"),a(f.token)):w.AFrameworkApplication.fa.Ha("LokiUserDataSignature")?(ka.ULS.sendTraceTag(539100295,380,15,"PeopleManager GetAuthToken trying alternateauth token"),this.STh.execute(l=>{l.naj().then(y=>{void 0!==y&&
null!==y&&0<y.length?(ka.ULS.sendTraceTag(544556298,380,15,"Using LokiUserDataSignature from AlternateAuthHelper"),a(y)):0<w.AFrameworkApplication.fa.Ha("LokiUserDataSignature").length&&(ka.ULS.sendTraceTag(544556299,380,15,"Using boot LokiUserDataSignature since fail to get one from AlternateAuthHelper"),a(w.AFrameworkApplication.fa.Ha("LokiUserDataSignature")))})})):f.isSuccess?f.token&&f.token.length||(ka.ULS.sendTraceTag(51658783,380,10,"Token is null: {0}",JSON.stringify(f)),b(Dp.a.kt(-2130915318))):
(ka.ULS.sendTraceTag(51658782,380,10,"GetLokiToken Failed : {0}",JSON.stringify(f)),b(Dp.a.kt(-2130915318)))}).catch(f=>{ka.ULS.sendTraceTag(51658784,380,10,"Unexpected exception received from lokiTokenManager: {0}",JSON.stringify(f));b(Dp.a.kt(-2130915318))})})})}getPersonaIconPropertiesArray(a){return new Promise(b=>{const c=[];for(const l of a){let y=null;var f=l;let H=l.Email;H&&""!==H||!l.UserId||""===l.UserId||"AD"!==l.Provider||(H=Rw.a.a$a(l.UserId));H&&""!==H&&(y=this.XV.Fvb(H,l.Provider,
w.AFrameworkApplication.gh,0),f=new kv.a(H,void 0,l.DisplayName));f=this.n4h.oua(f,2);Array.add(c,new Cp(l.DisplayName,l.UserId,f,y))}b(c)})}}Object(m.a)(lv,"ExternalPeopleAPI",Qw,[]);class mv{constructor(){this.a7a={};this.epb={};this.oKd={}}get(a){let b=null;const c=this.normalize(a.DisplayName);a.UserId&&a.UserId in this.a7a?(b=this.a7a[a.UserId],!c||c in this.epb||(this.epb[c]=b)):c&&c in this.epb&&(b=this.epb[c],a.UserId&&(c in this.oKd?(delete this.oKd[c],this.a7a[a.UserId]=b):a.UserId in this.a7a||
(b=null)));return b}add(a,b){a.UserId&&(this.a7a[a.UserId]=b);const c=this.normalize(a.DisplayName);!c||c in this.epb||(this.epb[c]=b,a.UserId||(this.oKd[c]=!0))}Ecj(a){a=Array(a.bNc.length);for(var b=0;b<a.length;b++)a[b]=0;for(const c of ta.a.EL(this.a7a))b=this.a7a[c],b.sources.contains(1)&&a[b.BLf]++;return a}normalize(a){return a?a.toLowerCase():null}}Object(m.a)(mv,"ColorLookupDict",null,[]);class nv{constructor(a,b){this.BLf=a;this.sources=new Na.a;this.sources.add(b)}Udi(a){this.sources.contains(a)||
this.sources.add(a)}}Object(m.a)(nv,"ColorSource",null,[]);class ov{constructor(a){this.PSb=a;this.YQd=new mv;this.slf=-1;this.aUh=0}oua(a,b,c=!0){if(!this.PSb||!this.PSb.bNc.length)return ka.ULS.sendTraceTag(37053532,380,10,"Color table is null or empty"),null;if(a.IsAnonymous)a.UserId=a.ClientId||a.UserId||this.j9i();else if(!a.UserId&&!a.DisplayName)return ka.ULS.sendTraceTag(37009498,380,100,"GetUserColor: Both userId and displayName are null"),null;const f=this.YQd.get(a);if(f)c=f.BLf,f.Udi(b);
else{if(!c)return null;c=this.dmj();this.YQd.add(a,new nv(c,b));this.slf=c}return this.Lcj(this.PSb.bNc[c])}dmj(){const a=this.PSb.bNc.length,b=this.YQd.Ecj(this.PSb),c=this.hjg(this.slf,a);let f=c,l=!1;for(;f!==c||!l;)if(b[f])(f=this.hjg(f,a))||(l=!0);else break;l&&ka.ULS.sendTraceTag(37009497,380,50,"GetNextColorIndex: relooped the color table.");return f}hjg(a,b){return(a+1)%b}j9i(){return"anonymous"+ ++this.aUh}Lcj(a){return 16777215>=a?"#"+ma.a.tw((a&255)<<16|a&65280|(a&16711680)>>>16,6):null}}
Object(m.a)(ov,"PeopleColorUtils",null,[1306]);class Vt{constructor(a,b,c,f,l,y){this.kmg=new sk.a;this.mra=a;this.$6a=b;this.mvf=f;this.Oa=c;this.j7=l;this.qvf=y;this.Oa.ff(()=>{this.fullAppSettingsReady()})}fullAppSettingsReady(){const a=w.AFrameworkApplication.Anb||w.AFrameworkApplication.ZQ,b=this.Oa.ka("PeopleEndPointIsEnabled");let c=b&&!a&&(this.hoc||this.wPb&&this.xPb);const f=this.Oa.ka("DisableAtmentionsForTeams"),l=this.Oa.ka("ConsumerMentionsHostIsEnabled")||this.mvf.dGh;c=c&&l&&this.bGh&&
this.aGh&&!f;this.Oa.ka("ConsumerMentionsHostIsEnabled")&&(c=c&&this.Oa.ka("OneDriveConsumerMentionsIsEnabled"));ka.ULS.sendTraceTag(37083014,380,50,"isAtMentionsEnabled:{0}, PeopleEndPointIsEnabled:{1}, PermissionsPostMessage:{2}, SupportsCheckUserAccess:{3}, SupportsGrantUserAccess:{4}, SupportsAddActivities:{5}, IsAnonymousUser:{6}, SupportsActivitiesNotification:{7}",c,b,this.hoc,this.wPb,this.xPb,this.bGh,a,this.aGh);this.kmg.Og(c);c&&this.j7&&this.j7.Mj(4,Object(I.a)(this,this.mMe,"onInteractiveReady"))}mMe(){const a=
this.Oa.wc("NumberOfContactsToFetchOnBoot",100);0>=a||this.getUserContacts("",a,0,!1,"AtMentions").continueWith(b=>{(b.Dm||b.ho)&&ka.ULS.sendTraceTag(50402056,380,50,"Failed to prefetch contacts on boot")})}get wPb(){return this.$6a.wPb}get x3c(){return this.qvf.x3c}get xPb(){return this.$6a.xPb}get hoc(){return this.$6a.hoc}get bGh(){return this.Oa.ka("SupportsAddActivities")}get aGh(){return this.Oa.ka("SupportsActivitiesNotification")}YCa(a){return this.$6a.YCa(a)}q3b(a,b){return this.$6a.q3b(a,
b)}get jmg(){return this.kmg.task}get Zya(){return this.mra.Zya}set Zya(a){this.mra.Zya=a}checkUserAccess(a){ka.ULS.sendTraceTag(37083015,380,50,"CheckUserAccess");return this.$6a.checkUserAccess(a)}grantUserAccess(a,b,c,f,l){return this.$6a.grantUserAccess(a,b,c,f,l)}getUserContacts(a,b,c,f,l){return this.mvf.getUserContacts(a,b,c,f,l)}Fvb(a,b,c,f){return this.qvf.Fvb(a,b,c,f)}supportsExchangeRestApis(){const a=new sk.a,b=this.mra.supportsExchangeRestApis();b.continueWith(()=>{b.Dm||b.ho?a.Og(!1):
a.Og(!0)});return a.task}}Object(m.a)(Vt,"PeopleManager",null,[1305,1303]);var wq=d(384);class Pr{}Object(m.a)(Pr,"CheckUserAccessRequestItem",null,[]);class Sw extends wq.a{constructor(a,b,c){super(a,b);this.Users=null;this.Users=this.z0d(c)}z0d(a){const b=[];for(const c of a)Array.add(b,Object.assign(new Pr,{Id:c.UserId,Provider:c.Provider}));return b}pl(){return 1}}Object(m.a)(Sw,"CheckUserAccessRequest",wq.a,[]);class Tw extends wq.a{constructor(a,b,c,f,l,y,H){super(a,b);this.Filter=null;this.Skip=
this.Limit=0;this.SearchGal=!1;this.Scenario=null;this.Filter=c;this.Limit=f;this.SearchGal=y;this.Skip=l;this.Scenario=H}pl(){return 2}}Object(m.a)(Tw,"GetUserContactsRequest",wq.a,[]);class Uw extends wq.a{constructor(a,b,c,f,l,y,H){super(a,b);this.Scenario=this.Users=null;this.GrantReviewAccess=this.GrantWriteAccess=this.GrantReadAccess=!1;this.Users=this.z0d(c);this.Scenario=f;this.GrantReadAccess=l;this.GrantWriteAccess=y;this.GrantReviewAccess=H}z0d(a){const b=[];for(const c of a)Array.add(b,
Object.assign(new Pr,{Id:c.UserId,Provider:c.Provider}));return b}pl(){return 4}}Object(m.a)(Uw,"GrantUserAccessRequest",wq.a,[]);class Vw extends wq.a{constructor(a,b){super(a,b)}pl(){return 5}}Object(m.a)(Vw,"SupportsExchangeRestApisRequest",wq.a,[]);var Wt=d(537);class Ww{constructor(a,b,c,f){this.Zya=null;this.Q5h=a;this.H3a=b;this.Oa=c;this.R3a=f}get sal(){return this.Oa.wc("GetUserContactsRequestSentTimeoutMs",6E4)}checkUserAccess(a){if(!a||!a.length)return ka.ULS.sendTraceTag(37757202,380,
15,"no user in the request"),a=new sk.a,a.setException(Error.argumentNull("Can't pass empty list to checkUserAccess calls")),a.task;ka.ULS.sendTraceTag(37757203,380,50,"CheckUserAccess: num people:{0}",a.length);const b=new sk.a,c=this.R3a.execute(new Sw(this.H3a(),null,a),(f,l,y)=>this.rQc(f,l,y,"CheckUserAccess"),this.Zya);c.continueWith(()=>{if(c.ho||c.Dm)b.AG(c.ej);else{var f=this.$Mk(c.result.uj);b.Og(f)}});return b.task}grantUserAccess(a,b,c,f,l){if(!a||!a.length)return ka.ULS.sendTraceTag(37757204,
380,15,"no user in the request"),a=new sk.a,a.Og(null),a.task;ka.ULS.sendTraceTag(37757205,380,15,"GrantUserAccess: num people:{0}, scenario:{1}, read:{2}, write:{3}, review:{4}",a.length,b,c,f,l);const y=new sk.a,H=this.R3a.execute(new Uw(this.H3a(),null,a,b,c,f,l),(Q,ia,wa)=>this.rQc(Q,ia,wa,"GrantUserAccess"),this.Zya);H.continueWith(()=>{if(H.ho||H.Dm)ka.ULS.sendTraceTag(37028121,380,15,"GetUserAccess: request failed: {0}",H.ej),y.AG(H.ej);else{var Q=this.BMk(H.result.uj);y.Og(Q)}});return y.task}$Mk(a){if(!a.data)return ka.ULS.sendTraceTag(24749450,
380,10,"CheckUserAccessResponse: Data is null"),null;if(!a.data.ee)return ka.ULS.sendTraceTag(24749451,380,10,"CheckUserAccessResponse: ResponseData is null"),null;a=Wt.a.q9a(a.data.ee);return a?a.Result?a.Result:(ka.ULS.sendTraceTag(24749453,380,10,"CheckUserAccessResponse: Result field is null."),null):(ka.ULS.sendTraceTag(24749452,380,10,"CheckUserAccessResponse: Failed parsing the response"),null)}BMk(a){if(!a.data)return ka.ULS.sendTraceTag(33645598,380,10,"GrantUserAccessResponse: Data is null"),
null;if(!a.data.ee)return ka.ULS.sendTraceTag(33645599,380,10,"GrantUserAccessResponse: ResponseData is null"),null;a=Wt.a.q9a(a.data.ee);return a?a.Result?a.Result:(ka.ULS.sendTraceTag(33645601,380,10,"GrantUserAccessResponse: Result field is null."),null):(ka.ULS.sendTraceTag(33645600,380,10,"GrantUserAccessResponse: Failed parsing the response"),null)}getUserContacts(a,b,c,f,l){const y=new sk.a,H=this.R3a.execute(new Tw(this.H3a(),null,a,b,c,f,l),(Q,ia,wa)=>this.rQc(Q,ia,wa,"GetUserContacts"),
this.Zya);H.continueWith(()=>{if(H.ho||H.Dm)y.AG(H.ej);else{var Q=H.result;try{const ia=this.ZMk(Q.uj);y.Og(ia.Result)}catch(ia){y.AG(ia)}}});return y.task}ZMk(a){if(!a.data)throw Error.create("ParseUserContactsFromResponse: Data is null");if(!a.data.ee)throw Error.create("ParseUserContactsFromResponse: ResponseData is null");a=Wt.a.q9a(a.data.ee);if(!a)throw Error.create("ParseUserContactsFromResponse: Failed parsing the response");if(!a.Result)throw Error.create("ParseUserContactsFromResponse: Result field is null.");
return a}supportsExchangeRestApis(){const a=new sk.a,b=this.R3a.execute(new Vw(this.H3a(),null),(c,f,l)=>this.rQc(c,f,l,"SupportsExchangeRestApisRequest"),this.Zya);b.continueWith(()=>{b.ho||b.Dm?(a.AG(b.ej),ka.ULS.sendTraceTag(50657307,380,50,"SupportsExchangeRestApis: false")):(ka.ULS.sendTraceTag(50657308,380,50,"SupportsExchangeRestApis: true"),a.uK(!0))});return a.task}rQc(a,b,c,f){return this.Q5h.Csb(a,2,c,b,2,f,null,!1,null,this.sal)}}Object(m.a)(Ww,"PeopleRequestHandler",null,[1304]);class pv{constructor(a,
b){this.XV=a;this.Ca=b;this.Ca.ya(G.a.Szi,ie.a.frame,Object(I.a)(this,this.Nzi,"checkUserAccessAction"));this.Ca.ya(G.a.mwj,ie.a.frame,Object(I.a)(this,this.lwj,"getUserContactsAction"));this.Ca.ya(G.a.Rzi,ie.a.frame,Object(I.a)(this,this.Pzi,"checkUserAccessAndGrantPermissionsAction"));this.Ca.ya(G.a.rwj,ie.a.frame,Object(I.a)(this,this.qwj,"getUserProfilePictureAction"));this.Ca.ya(G.a.CCl,ie.a.frame,Object(I.a)(this,this.DCl,"supportsExchangeRestApisTestAction"))}DCl(){this.supportsExchangeRestApis();
return 32}Nzi(){const a=prompt("Check User Access:Enter user names separated by ;");this.checkUserAccess(a);return 32}lwj(){const a=prompt("Get user contacts:filter;limit;skip;searchGal");this.getUserContacts(a);return 32}Pzi(){const a=prompt("CheckUserAccessAndGrantPermissions PostMessage: u1;u2;u3");this.YCa(a);return 32}qwj(){const a=prompt("Get user profile picture: userid;provider;dimension (e.g 48, 64, 96)");this.bdg(a);return 32}Zsh(){const a=prompt("What's the operation you want to do:\r\n1) Check User Access \r\n2) Grant user access \r\n3) Check User Access And Grant Permissions \r\n4) GetUserContacts \r\n5) Get User Profile Picture \r\n6) SupportsExchangeRestApis \r\n7) Exit");
try{switch(a){case "1":this.checkUserAccess(prompt("Check User Access: u1;u2;u3"));break;case "2":this.grantUserAccess();break;case "3":this.YCa(prompt("CUAGP: u1;u2;u3"));break;case "4":this.getUserContacts(prompt("Get User Contacts:filter;limit;skip;searchGal"));break;case "5":this.bdg(prompt("Get User profile picture:userid;provider;dimension;"));break;case "6":this.supportsExchangeRestApis();break;case "7":return}}catch(b){alert(b.message)}Ql.Task.delay(5E3).continueWith(()=>{this.Zsh()})}Edl(){window.setTimeout(Object(I.a)(this,
this.Zsh,"runOperations"),1E4)}supportsExchangeRestApis(){const a=this.XV.supportsExchangeRestApis();a.continueWith(b=>{if(b.Dm)alert("Exception: "+b.ej.message);else{b=a.result;var c=new Ai.StandardDialog;c.Ad=0;c.Oe(1,"Close");document.createElement("pre").innerText=b.toString();c.Tx("SupportsExchangeRestApis check returned",b.toString(),3,null)}})}bdg(a){a=a.split(";");const b=a[0],c=a[1];a=a[2];let f;try{f=this.Ffj(a)}catch(l){alert("Invalid dimension value");return}Ib.a.instance.Ia("Common.App.People.IPeopleManager").execute(l=>
{var y=l.Fvb(b,c,w.AFrameworkApplication.gh,f);l=document.createElement("img");l.src=y;y=new Ai.StandardDialog;y.Ad=0;y.Oe(1,"Close");y.Tx("Profile photo",null,3,null,l)})}Ffj(a){if(!a)return 0;switch(a){case "48":return 1;case "64":return 2;case "96":return 3;case "120":return 4;case "240":return 5;case "360":return 6;case "432":return 7;case "504":return 8;case "default":return 0;default:throw Error.argumentOutOfRange("unknown dimension");}}checkUserAccess(a){a=a.split(";");a=this.XV.q3b(a,"O365");
const b=this.XV.checkUserAccess(a);b.continueWith(c=>{if(c.Dm)alert("Exception: "+c.ej.message);else{var f=b.result;c="";for(var l of f.Result)c+=l.Id+"=>"+(l.UserCanWrite?"Write":"No Write")+"\r\n";l=new Ai.StandardDialog;l.Ad=0;l.Oe(1,"Close");f=document.createElement("pre");f.innerText=c;l.Tx("Check User Access Results",null,3,null,f)}})}grantUserAccess(){var a=prompt("GRANT_USER_ACCESS\n\nEnter semicolon-separated user names.\n\nInclude CantGrant or NotExist in names to return CannnotGrantPermission and UserDoesNotExist on Blue Chicken.\n");
const b=prompt("Enter scenario (mention or share):"),c=prompt("Enter the list of permissions to grant (e.g. Read Write Review).");a=a.split(";");a=this.XV.q3b(a,"O365");const f=0<=c.toUpperCase().indexOf("READ"),l=0<=c.toUpperCase().indexOf("WRITE"),y=0<=c.toUpperCase().indexOf("REVIEW"),H=this.XV.grantUserAccess(a,b,f,l,y);H.continueWith(Q=>{if(Q.Dm)alert("Exception: "+Q.ej.message);else{Q=H.result;var ia="RESULTS OF GRANT_USER_ACCESS CALL\n==========================\nScenario: "+b+"\nRequested Permissions: "+
(f?"READ":"")+(l?f?" WRITE":"WRITE":"")+(y?f||l?" REVIEW":"REVIEW":"")+"\n==========================\n\n";for(const wa of Q.Result)ia+="User: "+wa.Id+"\nMessage: "+wa.Message+"\nStatus Code: "+wa.Status+"\nProvider: "+wa.Provider+"\n\n";alert(ia)}})}getUserContacts(a){var b=a.split(";");a=0<b.length?b[0]:"";var c=2<b.length?b[2]:"0",f=3<b.length?b[3]:"false";b=Number.parseInvariant(1<b.length?b[1]:"10");c=Number.parseInvariant(c);f=Boolean.parse(f);const l=this.XV.getUserContacts(a,b,c,f,"AtMentions");
l.continueWith(y=>{if(y.Dm)alert("Something went wrong"+y.ej.message);else if(y.ho)alert("Task was canceled");else{var H=l.result;y="";for(var Q of H)H="ID => "+Q.Id+" \n",H+="Provider => "+Q.Provider+" \n",H+="DisplayName => "+Q.DisplayName+" \n",H+="GivenName => "+Q.GivenName+" \n",H+="Surname => "+Q.Surname+" \n",H+="Email => "+Q.Email+" \n",H+="Title => "+Q.Title+" \n",y+=H+"----------------------\n";Q=new Ai.StandardDialog;Q.Ad=0;Q.Oe(1,"Close");H=document.createElement("pre");H.innerText=y;
Q.Tx("Contacts",null,3,null,H)}})}YCa(a){a=a.split(";");a=this.XV.q3b(a,"O365");const b=this.XV.YCa(a);b.continueWith(c=>{if(c.Dm)alert("Exception: "+c.ej.message);else{c=b.result;var f="";for(var l of c.Result){var y=[];Array.add(y,l.UserCanRead?"Read YES":"Read NO");Array.add(y,l.UserCanReview?"Review YES":"Review NO");Array.add(y,l.UserCanWrite?"Write YES":"Write NO");y=l.Id+"=>"+y.join(" | ");f+=y+"\r\n"}l=new Ai.StandardDialog;l.Ad=0;l.Oe(1,"Close");c=f+"\r\nDialog Canceled="+c.Canceled;f=document.createElement("pre");
f.innerText=c;l.Tx("Check User Access And Grant Permissions Post GrantUserAccessPrompt Results",null,3,null,f)}})}}Object(m.a)(pv,"PeopleTestHook",null,[]);var hr=d(199);class Xw{constructor(a,b,c){this.Id=a;this.Persons=b;this.UserPermissionsVerified=c}}Object(m.a)(Xw,"ShowSharingUiRequestBody",null,[]);class Xt{constructor(a,b){this.y6a=null;this.HFc=new sk.a;this.LYb=new Xw(this.GMi(),a,b);ka.ULS.sendTraceTag(25036160,380,50,"Creating request with {0} persons and UserPermissionsVerified {1}",this.LYb.Persons?
this.LYb.Persons.length:0,this.LYb.UserPermissionsVerified)}get Zbl(){return this.HFc.task}get id(){return this.LYb.Id}get payload(){return this.LYb}ynl(a){this.y6a=a;this.kTl()?this.HFc.uK(this.y6a):this.HFc.AG(Error.format("Format of the "+Qe.a.HYd+" body is not valid"))}setException(a){ka.ULS.sendTraceTag(37515586,380,10,"message:{0}",a.message);this.HFc.AG(a)}GMi(){return Xt.SZh++}lTl(a){if(void 0===a.Id)return ka.ULS.sendTraceTag(25036161,380,10,"Persons.Id field is missing from the postmessage showSharingUiResponse of the host"),
!1;if(void 0===a.Provider)return ka.ULS.sendTraceTag(25036162,380,10,"Persons.Provider field is missing from the postmessage showSharingUiResponse of the host"),!1;void 0===a.Reason&&(ka.ULS.sendTraceTag(25036163,380,50,"Persons.Reason field is missing from the postmessage showSharingUiResponse of the host"),a.Reason=null);return void 0===a.Status?(ka.ULS.sendTraceTag(25036164,380,10,"Person.Status field is undefined"),!1):ma.a.mBb(a.Status)?!0:(ka.ULS.sendTraceTag(25036165,380,10,"Person.Status field is not a number"),
!1)}kTl(){if(void 0===this.y6a.Persons)return ka.ULS.sendTraceTag(25036166,380,10,"Persons field is missing from the postmessage showSharingUiResponse of the host"),!1;if(!Yb.a.isArray(this.y6a.Persons))return ka.ULS.sendTraceTag(25036167,380,10,"Persons field is not an array"),!1;for(let a=0;a<this.y6a.Persons.length;a++)if(!this.lTl(this.y6a.Persons[a]))return!1;return void 0===this.y6a.DialogCanceled?(ka.ULS.sendTraceTag(25036168,380,10,"DialogCanceled field is missing from the postmessage showSharingUiResponse of the host"),
!1):void 0===this.id?(ka.ULS.sendTraceTag(25036169,380,10,"Id field is undefined"),!1):ma.a.mBb(this.id)?!0:(ka.ULS.sendTraceTag(25036170,380,10,"ID field is not a number"),!1)}}Xt.SZh=0;Object(m.a)(Xt,"PostmessageRequestState",null,[]);class qv{constructor(a){this.$Md=new hr.a;this.gVb=this.I4a=null;this.Kif=!1;this.EOa=a}fMj(){ka.ULS.sendTraceTag(25036171,380,50,"ShowSharingUiPostMessageHandler.InitAsync");if(this.gVb)return this.gVb.task;this.gVb=new sk.a;this.EOa.continueWith(()=>{ka.ULS.sendTraceTag(25036172,
380,50,"hostPostMessenger Resolved successfully");this.I4a=this.EOa.result;this.Phe();this.gVb.Og(!0)});return this.gVb.task}Phe(){this.Kif||(ka.ULS.sendTraceTag(25190624,380,50,"InitHostPostmessenger"),this.Kif=!0,this.I4a.Iu(Qe.a.HYd),this.I4a.dC(Qe.a.HYd,Object(I.a)(this,this.Qzi,"checkUserAccessAndGrantPermissionsPostmessageReceived")))}Qzi(a){if(a=a.Values)if(void 0===a.Id||null===a.Id)ka.ULS.sendTraceTag(25036176,380,15,"ResponseBodyTask ID is null or undefined",a.Id);else{var b=null;({value:b}=
this.$Md.wg(a.Id)).returnValue?(ka.ULS.sendTraceTag(25036178,380,50,"Detected ResponseBodyTask for message id {0}",a.Id),b.ynl(a),this.$Md.remove(a.Id)):ka.ULS.sendTraceTag(25036177,380,15,"Response does not match any postmessageRequestState in the queue. ID:{0}",a.Id)}else ka.ULS.sendTraceTag(25036175,380,15,"Postmessage ResponseBodyTask is null")}Ozi(a,b){const c=new Xt(a,b);this.fMj().continueWith(()=>{const f=Hg.a.create().toString(),l=String.format("PostMessageId:{0}, CorrelationId:{1}",c.id,
f);ka.ULS.sendTraceTag(25036179,380,50,l);this.I4a.sendMessage(Qe.a.YCa,c.payload,f)||c.setException(Error.create("Failed to send the postmessage"));this.$Md.add(c.id,c)});return c.Zbl}}Object(m.a)(qv,"ShowSharingUiPostMessageHandler",null,[]);class Qr{}Object(m.a)(Qr,"GrantUserAccessResponse",null,[]);var bi=d(79);class ir extends Sys.EventArgs{constructor(a,b,c,f){super();this.result=b;this.oOk=a;this.FMa=c;this.scenario=f}}Object(m.a)(ir,"ShareAndNotifyEventArgs",Sys.EventArgs,[]);class Yt{static FKi(a){return bi.a.VC(Yt.Fo,
CommonUIStrings.l_ShareAndNotifyDialogText,a)}}Yt.Fo="<span id='ShareAndNotifyDialogText' class='WACDialogSpan'>{0}</span> <br/> <br/> <span id='ShareAndNotifyDialogListOfUsers' class='WACDialogSpan'>{1}</span>";Object(m.a)(Yt,"ShareAndNotifyDialogHtml",null,[]);class Ss extends bi.a{constructor(a,b,c){super();this.kOa=!1;this.Ma=new Pc.a;this.p4h=a;this.p$h=Ss.U7i(a);this.lw=b;this.QZ=c}iii(a){this.Ma.addHandler("SNEK",a)}r2e(){this.sg=Yt.FKi(this.p$h);this.Ad=8;this.kg="ShareAndNotifyDialog";this.showDialog(CommonUIStrings.l_ShareAndNotifyDialogTitle,
Object(I.a)(this,this.Rql,"shareAndNotifyDialogResultHandler"));this.y6("ShareAndNotifyDialogTextId")}Jxa(){}dispose(){this.kOa||(super.dispose(),this.kOa=!0)}Rql(a){this.Ma.raiseEvent("SNEK",new ir(this.p4h,a,this.lw,this.QZ))}static U7i(a){const b=new Sys.StringBuilder;for(const c of a)b.append(0<c.DisplayName.length?c.DisplayName:c.Id),b.append(", ");return b.toString().substring(0,b.toString().length-2)}}Object(m.a)(Ss,"ShareAndNotifyDialog",bi.a,[]);class vy{constructor(a,b,c){this.Id=a;this.Provider=
b;this.DisplayName=c}}Object(m.a)(vy,"ShowSharingUiRequestPerson",null,[]);class Zt{constructor(a,b,c,f,l,y){this.mra=a;this.Oa=b;this.F7h=c;this.eW=f;this.XUh=l;this.Zd=y}get wPb(){return this.Oa.ka("SupportsCheckUserAccess")}get xPb(){return this.Oa.ka("SupportsGrantUserAccess")}get hoc(){return this.Oa.ka("PermissionsPostMessage")&&!this.Oa.ka("CrossDocumentMessengerDisabled")&&this.XUh()}YCa(a){const b=new sk.a;if(Yb.a.Xa(a))return b.Og(this.eW.VRa([])),b.task;let c;const f=({j1b:c}=this.eW.k$e(a)).returnValue,
l=Zt.cIi(f);0<f.length?this.hoc?this.gwl(f,b,c,l):this.wPb&&this.xPb&&this.r2e(l,b,"mention"):b.Og(this.eW.VRa(a));return b.task}gwl(a,b,c,f){const l=Date.now();ka.ULS.sendTraceTag(37822867,380,15,"ShowHostSharingUi-Usage");const y=this.F7h.Ozi(f,c);c=new dd.a(4,1,this.Oa.wc("GrantPermissionSharingDialogWatchdogInternal",12E4),Object(I.a)(this,this.checkToMakeSureDialogWasOpened,"checkToMakeSureDialogWasOpened"),100);this.Zd.Hb(c);c.customData=y;y.continueWith(H=>{if(H.Dm)ka.ULS.sendTraceTag(36300673,
380,15,"CheckUserAccessAndGrantPermissions via PostMessage failed with exception. {0}",H.ej?H.ej.message:"No inner exception"),b.AG(H.ej);else{H=y.result;this.eW.mNl(H);var Q=this.eW.VRa(a);Q.Canceled=H.DialogCanceled;b.Og(Q);ka.ULS.sendTraceTag(37791043,380,15,"CheckUserAccessAndGrantPermissions finished in {0}ms",Date.now()-l)}})}checkToMakeSureDialogWasOpened(a){ka.ULS.sendTraceTag(37822868,380,15,"ShowHostSharingUi-WatchDog-Usage");(a=a.customData)?a.ho?ka.ULS.sendTraceTag(37791045,380,10,"Show Sharing UI task is canceled"):
a.Dm?ka.ULS.sendTraceTag(37791046,380,10,"Show Sharing UI task has faulted"):a.isCompleted||ka.ULS.sendTraceTag(37791047,380,10,"We have not got a response from host in long time"):ka.ULS.sendTraceTag(37791044,380,10,"Response of Sharing UI is null")}r2e(a,b,c){a=new Ss(a,b,c);a.iii(Object(I.a)(this,this.MHk,"onShareAndNotify"));a.r2e()}MHk(a,b){let c;const f=Zt.gIi(b.oOk);switch(b.result){case 1:this.grantUserAccess(f,b.scenario,!0,!0,!0).continueWith(l=>{l.Dm?(ka.ULS.sendTraceTag(36300674,380,15,
"GrantUserAccess from OnShareAndNotify failed with exception. {0}",l.ej?l.ej.message:"No inner exception"),b.FMa.AG(l.ej)):(ka.ULS.sendTraceTag(36300675,380,50,"GrantUserAccess from OnShareAndNotify succeeded."),c=this.eW.VRa(f),c.Canceled=!1,b.FMa.Og(c))});break;default:ka.ULS.sendTraceTag(36300676,380,50,"User cancelled Share and Notify dialog"),c=this.eW.VRa(f),c.Canceled=!0,b.FMa.Og(c)}}checkUserAccess(a){const b=new sk.a;if(!this.wPb)return ka.ULS.sendTraceTag(36300677,380,15,"Performing a CheckUserAccess call on a host that doesn't support the operation."),
b.setException(Error.invalidOperation("CheckUserAccess is not supported on this host")),b.task;if(!a||!a.length)return b.Og(this.eW.VRa([])),b.task;let c;const f=({j1b:c}=this.eW.k$e(a)).returnValue;if(c)ka.ULS.sendTraceTag(36300680,380,50,"CheckUserAccess response populated from cache."),b.Og(this.eW.VRa(a));else{const l=this.mra.checkUserAccess(f);l.continueWith(()=>{if(l.ho||l.Dm)ka.ULS.sendTraceTag(36300678,380,10,"CheckUserAccess call failed."),b.setException(Error.create("CheckUserAccess Call failed."));
else{ka.ULS.sendTraceTag(36300679,380,50,"CheckUserAccess call succeeded.");var y=l.result;y&&this.eW.kNl(y);y=this.eW.VRa(a);b.Og(y)}})}return b.task}grantUserAccess(a,b,c,f,l){const y=new sk.a;if(!this.xPb)return ka.ULS.sendTraceTag(36300681,380,15,"Performing a GrantUserAccess call on a host that doesn't support the operation."),y.setException(Error.invalidOperation("GrantUserAccess is not supported on this host")),y.task;if(!a||!a.length)return y.Og(this.eW.bPf([])),y.task;let H;const Q=({j1b:H}=
this.eW.k$e(a)).returnValue;if(H)ka.ULS.sendTraceTag(36300684,380,50,"GrantUserAccess response populated from cache."),y.Og(this.eW.bPf(a));else{const ia=this.mra.grantUserAccess(Q,b,c,f,l);ia.continueWith(()=>{if(ia.ho||ia.Dm)ka.ULS.sendTraceTag(36300682,380,10,"GrantUserAccess call failed."),y.setException(Error.create("GrantUserAccess Call failed."));else{ka.ULS.sendTraceTag(36300683,380,50,"GrantUserAccess call succeeded.");var wa=ia.result;this.eW.lNl(wa,c,f,l);wa=Object.assign(new Qr,{Result:wa});
y.Og(wa)}})}return y.task}q3b(a,b){const c=[];for(const f of a)c.push(new kv.a(f,b));return c}static cIi(a){const b=[];for(const c of a)a=new vy(c.UserId,c.Provider,""),b.push(a);return b}static gIi(a){const b=[];for(const c of a)a=new kv.a(c.Id,c.Provider),b.push(a);return b}}Object(m.a)(Zt,"UserAccessUtils",null,[1303]);class wy{constructor(a=null){a&&(this.Id=a.Id,this.Provider=a.Provider,this.Email=a.Email,this.DisplayName=a.DisplayName,this.GivenName=a.GivenName,this.Surname=a.Surname,this.Title=
a.Title)}}Object(m.a)(wy,"PersonaProperties",null,[]);class $t{constructor(a,b){this.qsf=[];this.SBd=[];this.imf=-1;this.Oa=a;this.mra=b}get dGh(){return this.Oa.ka("IsContactsResolutionEnabled")}getUserContacts(a,b,c,f,l){ka.ULS.sendTraceTag(37611683,380,15,"GetUserContacts: limit:{0}, searchGal:{1}, scenario:{2}",b,f,l);const y=new Map;y.set("Limit",b.toString());y.set("SearchGal",f.toString());y.set("Scenario",l);$d.Health.instance.recordKpiUsageForAlertableKpi("PeopleEndPointGetUserContactsBrowser",
"wackpitesting",y);if(!this.dGh)return ka.ULS.sendTraceTag(39145936,380,10,"Trying to get user contacts when hosts doesn't support it"),$d.Health.instance.recordKpiFailure("PeopleEndPointGetUserContactsBrowser","TriedToGetUserContactsWhenHostDoesNotSupportIt",!0,!1,null),a=new sk.a,a.AG(Error.invalidOperation("People operations not supported by this host")),a.task;if(0>=b)return ka.ULS.sendTraceTag(39145937,380,10,"Limit should be > 0"),$d.Health.instance.recordKpiFailure("PeopleEndPointGetUserContactsBrowser",
"LimitShouldBeGreaterThanZero",!1,!0,null),a=new sk.a,a.AG(Error.invalidOperation("Limit should be > 0")),a.task;"Unknown"===l&&ka.ULS.sendTraceTag(37611712,380,15,"Scenario Name was not specified");if(b<=this.imf&&!a&&!f)return a=new sk.a,c=this.SBd.slice(0,Math.max(b-1,this.SBd.length-1)),c=this.I3g(this.qsf,c),a.Og(c),a.task;const H=new sk.a;let Q;try{Q=this.mra.getUserContacts(a,b,c,f,l)}catch(ia){return H.AG(ia),H.task}if(f||"AtMentions"!==l)return Q;Q.continueWith(ia=>{if(ia.ho||ia.Dm){ia=ia.ho?
"Canceled":ia.ej.message;ka.ULS.sendTraceTag(39145938,380,10,"Failed to get contacts from host {0}",ia);var wa=new Map;y.set("ErrorMessage",ia);wa=Object.assign(new Mj.a,{extendedProperties:wa});$d.Health.instance.recordKpiFailure("PeopleEndPointGetUserContactsBrowser","FailedToGetContactsFromHost",!1,!0,wa);H.AG(Error.create(ia))}else this.SBd=ia=Q.result,this.imf=b,ia=this.I3g(this.qsf,ia),H.Og(ia)});return H.task}I3g(a,b){if(!a&&!b)return[];if(!b)return a;if(!a)return b;const c={};a.forEach(f=>
{this.Cyf(f,c)});b.forEach(f=>{this.Cyf(f,c)});a=[];for(let f in c)Array.add(a,c[f]);return a}Cyf(a,b){if(a&&(a=new wy(a),a.Email&&a.DisplayName&&a.Id&&a.Provider)){const c=b[this.MPf(a)];c&&(a.Surname||(a.Surname=c.Surname),a.GivenName||(a.Surname=c.GivenName),a.Title||(a.Surname=c.Title));b[this.MPf(a)]=a}}MPf(a){return(a.Email+a.Provider).toLocaleLowerCase()}}Object(m.a)($t,"UserContactsUtils",null,[1302]);class au{}Object(m.a)(au,"CheckUserAccessResponse",null,[]);class xy{}Object(m.a)(xy,"GrantUserAccessResponseItem",
null,[]);class rv{}Object(m.a)(rv,"UserPermissions",null,[]);class Do{constructor(){this.sN=new Uc.a;this.t4e=0}k$e(a){let b;const c=[];if(!a)return ka.ULS.sendTraceTag(36299549,380,15,"UsersNotInCacheOrInCacheWithNoWriteOrReviewPermissions called with null people argument."),{returnValue:c,j1b:!1};if(!a.length)return ka.ULS.sendTraceTag(36299550,380,15,"UsersNotInCacheOrInCacheWithNoWriteOrReviewPermissions called with empty IPerson array."),{returnValue:c,j1b:!1};b=!0;const f={};for(const l of a){a=
Do.w0d(l);if(a in f)continue;f[a]=!0;const y=({value:a}=this.sN.wg(Do.w0d(l))).returnValue;y&&(!a||a.UserCanWrite||a.UserCanReview)||Array.add(c,l);b=b&&y}return{returnValue:c,j1b:b}}kNl(a){if(!a)throw Error.argumentNull("result");for(const b of a){if(void 0===b.Id||null===b.Id||!b.Id.length)throw Error.argument("item.Id");if(void 0===b.Provider||null===b.Provider||!b.Provider.length)throw Error.argument("item.Provider");this.sN.remove(Do.fOc(b));this.sN.add(Do.fOc(b),b)}}lNl(a,b,c,f){if(!a)throw Error.argumentNull("result");
for(const l of a){if(void 0===l.Id||null===l.Id||!l.Id.length)throw Error.argument("item.Id");if(void 0===l.Provider||null===l.Provider||!l.Provider.length)throw Error.argument("item.Provider");if(0===l.Status){const y=Do.x0d(l.Id,l.Provider);({value:a}=this.sN.wg(y)).returnValue?(a.UserCanRead=b,a.UserCanWrite=c,a.UserCanReview=f):(a=Object.assign(new rv,{Id:l.Id,Provider:l.Provider,UserCanRead:b,UserCanWrite:c,UserCanReview:f}),this.sN.remove(y),this.sN.add(y,a))}}}mNl(a){if(!a)throw Error.argumentNull("showSharingUiResponse");
a=a.Persons;if(!a)throw Error.argumentNull("showSharingUiResponse.Persons");for(let b=0;b<a.length;b++){const c=new rv,f=a[b];if(void 0===f.Id||null===f.Id)throw Error.argument("showSharingUiRepsonePerson.Id");void 0===f.Status||null===f.Status?ka.ULS.sendTraceTag(25036183,380,15,"ShowSharingUiResponsePerson.Status is null or undefined"):(c.UserCanRead=f.Status===this.t4e,c.UserCanWrite=f.Status===this.t4e,c.UserCanReview=f.Status===this.t4e,c.Id=f.Id,c.Provider=f.Provider,this.sN.remove(Do.fOc(c)),
this.sN.add(Do.fOc(c),c))}}adg(a){const b=[];for(const c of a)a=Do.w0d(c),this.sN.Fb(a)&&Array.add(b,this.sN.ga(a));return b}VRa(a){a=this.adg(a);return Object.assign(new au,{Result:a,Canceled:!1})}bPf(a){a=this.adg(a);const b=[];for(const c of a)b.push(Object.assign(new xy,{Id:c.Id,Provider:c.Provider,Message:"Success. User already exists in cache with requested permissions.",Status:0}));return Object.assign(new Qr,{Result:b,Canceled:!1})}static fOc(a){return Do.x0d(a.Id,a.Provider)}static w0d(a){return Do.x0d(a.UserId,
a.Provider)}static x0d(a,b){return b+a}}Object(m.a)(Do,"UserPermissionsCache",null,[1299]);class jr{constructor(a,b,c,f){this.mra=a;this.Oa=b;this.s$h=c;this.q$h=f}Fvb(a,b,c,f){var l=this.mra.Zya;l=l?String.format("{0}/{1}",l,"people.ashx"):"people.ashx";l=new Jh.QueryStringBuilder(l);l.jg("oid","3");l.jg("bdqs",c);(c=this.VHi(f))&&2<=c.length&&(f=c[1],l.jg("w",c[0]),l.jg("h",f));l.jg("uid",a);l.jg("p",b);l.jg("usid",this.s$h);l.jg("WacUserType",this.q$h);return l.toString()}VHi(a){switch(a){case 1:return["48",
"48"];case 2:return["64","64"];case 3:return["96","96"];case 4:return["120","120"];case 5:return["240","240"];case 6:return["360","360"];case 7:return["432","432"];case 8:return["504","504"];case 0:return[];default:throw Error.argumentOutOfRange("unknown dimension");}}get x3c(){return this.Oa.ka("IsUserProfilePictureResolutionEnabled")}}Object(m.a)(jr,"UserProfilePictureUtils",null,[1300,1301]);var Ph=d(580);class k{get name(){return"Common.App.People"}Yb(a){a.register(Ww,"Common.App.People.PeopleRequestHandler").as("Common.App.People.IPeopleRequestHandler").ma().oa(()=>
new Ww(w.AFrameworkApplication.Me,()=>w.AFrameworkApplication.gh,w.AFrameworkApplication.fa,new Wt.a));a.register(Do,"Common.App.People.UserPermissionsCache").as("Common.App.People.IUserPermissionsCache").ma();a.register(qv,"Common.App.People.ShowSharingUiPostMessageHandler").ma().oa(()=>new qv(Zq.a.Lt(a.Ia("Postmessage.IHostPostmessenger"))));a.register(Zt,"Common.App.People.UserAccessUtils").as("Common.App.People.IUserAccessUtils").ma().oa(()=>new Zt(a.resolve("Common.App.People.PeopleRequestHandler"),
w.AFrameworkApplication.fa,a.resolve("Common.App.People.ShowSharingUiPostMessageHandler"),a.resolve("Common.App.People.IUserPermissionsCache"),Ph.a,il.a.instance));a.register($t,"Common.App.People.UserContactsUtils").as("Common.App.People.IUserContactsUtils").ma().oa(()=>new $t(w.AFrameworkApplication.fa,a.resolve("Common.App.People.PeopleRequestHandler")));a.register(jr,"Common.App.People.UserProfilePictureUtils").as("Common.App.People.IUserProfilePictureUtilsV2").as("Common.App.People.IUserProfilePictureUtils").ma().oa(()=>
new jr(a.resolve("Common.App.People.PeopleRequestHandler"),w.AFrameworkApplication.fa,w.AFrameworkApplication.userSessionId,w.AFrameworkApplication.userType));a.register(ov,"Common.App.People.PeopleColorUtils").as("Common.App.People.IPeopleColorUtils").ma().oa(()=>new ov(a.qb("Common.IColorTable")));a.register(Vt,"Common.App.People.PeopleManager").as("Common.App.People.IPeopleManager").ma().oa(()=>new Vt(a.resolve("Common.App.People.PeopleRequestHandler"),a.resolve("Common.App.People.IUserAccessUtils"),
w.AFrameworkApplication.fa,a.resolve("Common.App.People.IUserContactsUtils"),Pd.a.get_instance(),a.resolve("Common.App.People.IUserProfilePictureUtilsV2")));a.register(lv,"Common.App.People.ExternalPeopleAPI").as("Common.App.People.IExternalPeopleAPI").ma().oa(()=>new lv(a.resolve("Common.App.People.IPeopleManager"),a.resolve("Common.App.People.IPeopleColorUtils"),Zq.a.Lt(a.Ia("Common.ILokiTokenManager")),w.AFrameworkApplication.fa,a.Ia("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper")))}init(){w.AFrameworkApplication.fa&&
w.AFrameworkApplication.fa.ff(Object(I.a)(this,this.en,"onFullAppSettingsReady"))}en(){const a=Ib.a.instance.resolve("Common.App.People.IPeopleManager");Ib.a.instance.resolve("Common.App.People.IExternalPeopleAPI");w.AFrameworkApplication.fa.ka("GetUserContactsTestHookIsEnabled")&&(new pv(a,w.AFrameworkApplication.Ra)).Edl()}dispose(){}static main(){n.a.instance.Ac(new k)}}Object(m.a)(k,"PeoplePackage",null,[2,3]);var E={};E.NRb=function(){function a(){return H()&&(dc()||3<=(kb()?Fc("version/"):0))}
function b(){return 0<=window.navigator.userAgent.indexOf("Windows")}function c(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function f(Rd){Rd=(new RegExp(Rd+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var gf=-1;null!=Rd&&2<=Rd.length&&(gf=parseFloat(Rd[1]),isNaN(gf)&&(gf=-1));return gf}function l(){Ep||(Ep=!0,Mm=f("Windows Phone"));return 8<=Mm}function y(){return"function"==typeof navigator.msLaunchUri&&!c()&&!ec()&&!Q()}function H(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}
function Q(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function ia(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function wa(){return ia()?8==window.document.documentMode:!1}function Ua(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function kb(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function Gb(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function ec(){var Rd=window.navigator.userAgent.toLowerCase();
return 0<=Rd.indexOf("android")&&0<=Rd.indexOf("chrome")}function dc(){return 3<=(Ua()?Fc("firefox/"):0)}function Fc(Rd){var gf=window.navigator.userAgent.toLowerCase(),Lf=gf.indexOf(Rd);return 0<=Lf?parseInt(gf.substring(Lf+Rd.length,gf.length)):0}function yc(Rd,gf,Lf,we,lh){if(we&&null!=gf)gf();else if(y())navigator.msLaunchUri(Rd,gf,Lf);else if(!(Gb()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&H())||Q())xd(Rd,gf,
Lf);else if(Gb()&&lh)a:{try{window.open(Rd,"_self")}catch(rj){null!=Lf&&Lf();break a}null!=gf&&gf()}else tc(Rd,gf,Lf)}function tc(Rd,gf,Lf){var we=document.getElementById("OICLinkTag");null==we&&(we=document.createElement("a"),we.id="OICLinkTag",we.style.visibility="hidden",we.href="",0==(oi.Options&yj.SupportsTopTargetNavigation)||oi.NoBrowserModalDialogs?we.target="_blank":we.target="_top",document.body.appendChild(we),null!=we.addEventListener&&we.addEventListener("click",function(lh){null!=lh.stopPropagation&&
lh.stopPropagation()},!1));try{we.href=Rd,we.dispatchEvent(new MouseEvent("click"))}catch(lh){null!=Lf&&Lf();return}null!=gf&&gf()}function xd(Rd,gf,Lf){var we=document.getElementById("OICFrame");null==we&&(we=document.createElement("iframe"),we.className="ObjectInDialog",we.style.visibility="hidden",we.src="about:blank",document.body.appendChild(we),we.id="OICFrame");try{we.contentWindow.location.href=Rd}catch(lh){null!=Lf&&Lf();return}null!=gf&&gf()}function Vd(Rd){return 0!=(Rd.Options&yj.SkipProtocolHandler)||
wa()}function Ld(Rd){return Rd===Nm.ReadOnly||Rd===Nm.ReadWrite}function ye(Rd,gf,Lf,we){var lh;try{var rj=new ActiveXObject("SharePoint.OpenDocuments.4");return(lh=rj.ViewDocument3(window.self,Rd,gf,we))?(Bm(zj.O14ActiveX),kh.None):kh.Failed}catch(Aj){}if(yj.O14Only===(Lf&yj.O14Only))return oi.DescriptiveUnattemptedEnums?kh.O14AttemptFailure:kh.Unattempted;try{return rj=new ActiveXObject("SharePoint.OpenDocuments.3"),(lh=rj.ViewDocument3(window.self,Rd,gf,we))?(Bm(zj.O12ActiveX),kh.None):kh.Failed}catch(Aj){}if(yj.O12UpOnly===
(Lf&yj.O12UpOnly))return oi.DescriptiveUnattemptedEnums?kh.O12UpOnlyFail:kh.Unattempted;try{return rj=new ActiveXObject("SharePoint.OpenDocuments.2"),(lh=Ld(gf)?rj.ViewDocument2(window.self,Rd,we):rj.EditDocument2(window.self,Rd,we))?(Bm(zj.O11ActiveX),kh.None):kh.Failed}catch(Aj){}return oi.DescriptiveUnattemptedEnums?kh.ActiveXUnattempted:kh.Unattempted}function Xd(Rd,gf,Lf,we,lh){Rd==zg.Visio&&Lf==Nm.ReadWrite&&(Lf=Nm.WriteOnly);we=we||c()&&!l();if(!we){we="";if(Rd==zg.PowerPoint){Rd=we;we=oi.DocumentExtension;
Lf=Ld(Lf);var rj=new Set([".pot",".potm",".potx"]),Aj=new Set([".pps",".ppsm",".ppsx"]);Lf=Lf&&rj.has(we)?"nft|ofc|":Lf&&Aj.has(we)?"ofv|ofs|t|":!Lf&&Aj.has(we)?"ofe|ofs|t|":Lf?"ofv|ofc|":"ofe|";Lf=Rd+Lf}else Lf=Ld(Lf)?we+"ofv|ofc|":we+"ofe|";we=Lf;oi.NewTelemetryDataIsEnabled&&(Lf=oi.SessionOrigin?"or|"+oi.SessionOrigin:"",Lf+=oi.ClickTime?"ct|"+oi.ClickTime:"",Lf+=oi.CorrelationId?"cid|"+oi.CorrelationId:"",lh+=ug(Lf));lh+=ug(we+"u|")}lh+=ug(gf);gf=window.location.href;Lf=gf.toLowerCase().indexOf("&wdlor=");
-1!=Lf?(Lf+=7,Rd=gf.indexOf("&",Lf),gf=-1==Rd?gf.substr(Lf):gf.substring(Lf,Rd)):gf=void 0;if(null!=gf&&"undefined"!=typeof gf){Lf="";try{Lf=decodeURIComponent(gf)}catch(sv){}0<Lf.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Lf)&&(lh=lh+"|f|"+Lf)}return lh}function Xf(Rd,gf,Lf,we,lh,rj){var Aj=vg(Rd);if(null==Aj)return xj(oi.DescriptiveUnattemptedEnums?kh.ProtocolHandlerIsNull:kh.Unattempted,oi.Application),!1;Rd=Xd(Rd,gf,Lf,we,Aj);yc(Rd,qg,Fg,lh,rj);return!0}function ug(Rd){if(H()&&
Gb()){var gf="";try{gf=decodeURI(Rd)}catch(Lf){}if(gf==Rd)return encodeURI(Rd)}return Rd}function qg(){Bm(zj.ProtocolHandler)}function Fg(){oi.Options|=yj.SkipProtocolHandler;rh(oi,Kl,lm)}function qf(){null!=zn&&zn(zj.RoamingProtocolHandler)}function bg(){null!=jl&&jl(kh.ControlNeeded)}function Kg(){var Rd=document.getElementById("npSharePointPlugin");if(null==Rd){Rd="application/x-sharepoint";H()&&3<=(kb()?Fc("version/"):0)&&rg("application/x-sharepoint-webkit",!0)&&(Rd="application/x-sharepoint-webkit");
if(!rg(Rd,!0))if(H()&&rg("application/officelive",!0))Rd="application/officelive";else return null;var gf=document.createElement("object");gf.id="npSharePointPlugin";gf.type=Rd;gf.style.width="0px";gf.style.height="0px";gf.style.setProperty("visibility","hidden","");document.body.appendChild(gf);Rd=document.getElementById("npSharePointPlugin")}return Rd}function rg(Rd,gf){var Lf=window.navigator.mimeTypes;if(null==Lf)return!1;Rd=Lf[Rd];return!Rd||gf&&!Rd.enabledPlugin?!1:!0}function ui(Rd){try{if(null!=
new ActiveXObject(Rd))return!0}catch(gf){}return!1}function Ik(Rd){switch(Rd){case zg.OneNote:return"OneNote.Notebook";default:return""}}function vg(Rd){if(Rd!=zg.OneNote&&c()&&!l())return"office:";switch(Rd){case zg.Excel:return"ms-excel:";case zg.OneNote:return"onenote:";case zg.PowerPoint:return"ms-powerpoint:";case zg.Visio:return"ms-visio:";case zg.Word:return"ms-word:";case zg.Project:return"ms-project:";case zg.Publisher:return"ms-publisher:";case zg.Infopath:return"ms-infopath:";case zg.Access:return"ms-access:";
default:return""}}function Lg(Rd){switch(Rd){case zg.Excel:return"root\\office15\\excel.exe";case zg.PowerPoint:return"root\\office15\\powerpnt.exe";case zg.Visio:return"root\\office15\\visio.exe";case zg.Word:return"root\\office15\\winword.exe";case zg.Project:return"root\\office15\\winproj.exe";case zg.Publisher:return"root\\office15\\mspub.exe";case zg.Infopath:return"root\\office15\\infopath.exe";case zg.Access:return"root\\office15\\msaccess.exe";default:return null}}function rh(Rd,gf,Lf){oi=
Rd;Kl=gf;lm=Lf;if(Rd.DocumentUrl){var we=Lf=gf=Rd.DocumentUrl;try{we=decodeURIComponent(Rd.DocumentUrl)}catch(tv){}try{Lf=encodeURI(Rd.DocumentUrl)}catch(tv){}gf=gf+""+Rd.CorrelationIdForWinClient;we+=Rd.CorrelationIdForWinClient;Lf+=Rd.CorrelationIdForWinClient;Rd.Mode===Nm.ReadWrite&&yj.CheckoutRequired===(Rd.Options&yj.CheckoutRequired)&&(Rd.Mode=Nm.ForceCheckout);yj.HostIsEditOnly===(Rd.Options&yj.HostIsEditOnly)&&(Rd.Mode=Nm.WriteOnly);if(Vd(Rd)?0:H()&&(Rd.Application==zg.OneNote||rg("application/x-sharepoint-protocolhandler",
!1)||rg("application/x-sharepoint-webkit-protocolhandler",!1))||y()||ec()||!(a()||dc()||"ActiveXObject"in window&&!c()||Gb())||15<=Cm())Xf(Rd.Application,Rd.EncodeUrl?Lf:gf,Rd.Mode,Rd.Application==zg.OneNote,Rd.SilentExternalHandler,Rd.NavigateUsingWindowOpen);else{var lh;if(lh=wa())a:{var rj=Rd.EncodeUrl?gf:we,Aj=Rd.Mode,sv=Ik(Rd.Application);try{lh=(new ActiveXObject("SharePoint.OpenDocuments.5")).ViewDocument3(window.self,rj,Aj,sv);break a}catch(tv){}lh=!1}if(lh)Bm(zj.O15ActiveX);else{if(a()||
dc()){var Dm=Rd.EncodeUrl?gf:we;we=Rd.Mode;lh=Ik(Rd.Application);rj=Kg();if(null==rj)Dm=oi.DescriptiveUnattemptedEnums?kh.PluginIsNull:kh.Unattempted;else{Aj=!1;try{Aj=rj.ViewDocument3(window.self,Dm,we,lh)}catch(tv){}if(!Aj)try{Aj=Ld(we)?rj.ViewDocument2(window.self,Dm,lh):rj.EditDocument2(window.self,Dm,lh)}catch(tv){}Aj?(Bm(zj.NpapiPlugin),Dm=kh.None):Dm=kh.Failed}}else{try{Dm=new ActiveXObject("IDBHO.IDBHOCtrl"),null!=Dm&&Dm.SaveSSOCreds()}catch(tv){}Dm=ye(Rd.EncodeUrl?gf:we,Rd.Mode,Rd.Options,
Ik(Rd.Application))}if(Dm!=kh.None){if(we=Rd.CouldUseRoamingApps)An||(An=!0,io=f("Windows NT")),we=6.1<=io&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(ia()||dc()||Gb());if(we&&Rd.Application!=zg.OneNote){if(!E.NRb.jWl()){xj(kh.ControlNeeded,oi.Application);return}if(Rd.RoamingAppsLauncher){"undefined"==typeof Rd.RoamingAppsLauncher||null==Rd.RoamingAppsLauncher?xj(oi.DescriptiveUnattemptedEnums?kh.RoamingLauncherIsNull:kh.Unattempted,oi.Application):"undefined"==typeof Rd.RoamingBitsUrl||
null==Rd.RoamingBitsUrl?E.NRb.qWl(Rd.DocumentUrl,Rd.RoamingAppsLauncher,Rd.Application,Rd.ApplicationParameters,Kl,lm):E.NRb.wSh(Rd.DocumentUrl,Rd.RoamingAppsLauncher,Rd.RoamingApplicationExe,Rd.ApplicationParameters,Rd.RoamingPlatform,Rd.RoamingBitsUrl,Kl,lm);return}if(!Rd.ContinueIfLauncherIsNull){xj(kh.LauncherNeeded,oi.Application);return}}yj.NoProtocolHandlerFallback==(Rd.Options&yj.NoProtocolHandlerFallback)||Vd(Rd)||ia()||H()&&!(oi.DescriptiveUnattemptedEnums?Dm>=kh.O14Unattempted&&Dm<=kh.DocumentUrlIsNull:
Dm==kh.Unattempted)?xj(Dm,oi.Application):Xf(Rd.Application,Rd.EncodeUrl?Lf:gf,Rd.Mode,Rd.Application==zg.OneNote,Rd.SilentExternalHandler,Rd.NavigateUsingWindowOpen)}}}}else xj(oi.DescriptiveUnattemptedEnums?kh.DocumentUrlIsNull:kh.Unattempted,oi.Application)}function Bm(Rd){null!=Kl&&Kl(Rd)}function xj(Rd,gf){"undefined"==typeof gf&&(gf=null);null!=lm&&lm(Rd,gf)}function Cm(){var Rd=0;if(a()||dc()||Gb()){var gf=Kg();try{null!=gf&&(Rd=gf.GetOfficeVersion())}catch(Lf){}}else ui("SharePoint.OpenDocuments.5")?
Rd=15:ui("SharePoint.OpenDocuments.4")?Rd=14:ui("SharePoint.OpenDocuments.3")?Rd=12:ui("SharePoint.OpenDocuments.2")&&(Rd=11);return Rd}function go(){return H()&&(rg("application/x-sharepoint",!0)||rg("application/x-sharepoint-webkit",!0))}var Tl="",ho="",Ul="",Kl,lm,zn,jl,oi,An,io,Ep,Mm,Nm={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},yj={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},
kh={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},zj={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},zg={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,
Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:Nm,OpenDocumentOptions:yj,OpenDocumentFailureType:kh,OpenDocumentControl:zj,OfficeApplication:zg,EditDocumentInClient:rh,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=zg.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=
this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.DocumentExtension=this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:Cm,IsO14MacPluginInstalled:go,OfferOfficeInDialog:function(){return b()&&11>=Cm()},OfferOfficeNoIntrusive:function(){return b()&&15>Cm()},OfferMacOffice:function(){return H()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&
!go()},InstallRoamingControl:function(){Ua()?window.InstallTrigger.install({Office:{URL:ho}}):xd(Ul,null,null)},CanUseRoamingControl:function(){if(y())return!0;if(Gb())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(Ua()){var Rd=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(Rd);var gf=document.createEvent("Events");gf.initEvent("RoamingOfficeInstalled",!0,!1);Rd.dispatchEvent(gf);
return!!Rd.getAttribute("installed")}if(ia())try{return(new ActiveXObject("RoamingOfficeActiveX.RoamingOffice")).HrExists()}catch(Lf){}return!1},InitUrls:function(Rd,gf,Lf){Tl=Rd;ho=Lf;Ul=gf},LaunchRoamingApps:function(Rd,gf,Lf,we,lh,rj){E.NRb.wSh(Rd,gf,Lg(Lf),we,"x86",Tl,lh,rj)},LaunchRoamingApps2:function(Rd,gf,Lf,we,lh,rj,Aj,sv){var Dm="";null!=we&&(Dm+=" "+we);null!=Rd&&(Dm+=' "'+Rd+'"');if(y()||Gb())zn=Aj,jl=sv,Aj='office: "'+(rj+'" "')+(Lf+'" "ROAMING"'),Aj+=' "'+gf+'"',Aj+=' "'+lh+'"',Aj+=
" "+Dm,yc(Aj,qf,bg,!1,!1);else if(Ua())Rd=document.createElement("RoamingExtensionElement"),Rd.setAttribute("cabUrl",rj),Rd.setAttribute("app",Lf),Rd.setAttribute("licensingEntitlements",gf),Rd.setAttribute("platform",lh),Rd.setAttribute("args",Dm),document.documentElement.appendChild(Rd),gf=document.createEvent("Events"),gf.initEvent("RoamingOfficeLaunch",!0,!1),Rd.dispatchEvent(gf),null!=Aj&&Aj(zj.RoamingFFExtension);else if(ia()){if(Rd=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=
Rd)try{Rd.HrConfigureSingle(rj,Lf,gf,lh,Dm),null!=Aj&&Aj(zj.RoamingActiveX)}catch(tv){}}else null!=sv&&sv(kh.Failed)},ShouldShowDialog:function(){return!c()},NavigateToUrlUsingClickingOnATag:tc,OpenDocumentWithProtocolHandler:Xf,OpenDocumentWithProtocolHandlerNoCallBack:function(Rd,gf,Lf,we){var lh=vg(Rd);if(null==lh)return xj(oi.DescriptiveUnattemptedEnums?kh.ProtocolHandlerNoCallbackIsNull:kh.Unattempted,oi.Application),!1;Rd=Xd(Rd,gf,Lf,we,lh);yc(Rd,null,null,!1,!1);return!0}}}();E.ClientUtils=
E.NRb;class X{constructor(a,b,c){this.Ca=a;this.q0h=b;this.NG=c}vb(){this.Ca.ya(G.a.tryMacOffice,ie.a.frame,Object(I.a)(this,this.KIk,"onTryMacOffice"));this.Ca.ya(G.a.QKh,ie.a.frame,Object(I.a)(this,this.kch,"onTryMacOfficeFromViewer"));this.Ca.ya(G.a.PKh,ie.a.frame,Object(I.a)(this,this.kch,"onTryMacOfficeFromViewer"))}KIk(a,b,c,f,l){if(1===c)return 32;l?(a=l.SourceControlId,"btnjTryMacOfficeForWordEditor"===a?Bd.a.En(yg.a.QEa(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===
a&&Bd.a.En(yg.a.QEa(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.Hug();return 32}kch(a,b,c){if(1===c)return 32;switch(a){case G.a.QKh:Bd.a.En(yg.a.QEa(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case G.a.PKh:Bd.a.En(yg.a.QEa(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}Hug(){Bd.a.En(X.ktk,"_blank",void 0,"LaunchMacTrialWindow")}get Ktc(){return this.q0h&&z.a.Ik&&!z.a.bpe&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get LAh(){const a=
this.Ktc;a||w.AFrameworkApplication.mj.qjl();return a}get Rsl(){return this.Ktc}static get ktk(){return yg.a.SW("522401")}}Object(m.a)(X,"MacOfficeOffer",null,[1312]);class ra{constructor(a,b,c){this.Ca=a;this.t0h=b;this.aBd=null;(this.LHc=w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&Ib.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(f=>{this.aBd=f});this.NG=c}vb(){this.Ca.ya(G.a.tryOffice,
ie.a.frame,Object(I.a)(this,this.LIk,"onTryOffice"));this.Ca.ya(G.a.V7e,ie.a.frame,Object(I.a)(this,this.V7e,"tryOfficeThroughTellMe"));this.Ca.ya(G.a.YKh,ie.a.frame,Object(I.a)(this,this.ZKh,"tryOfficeThroughViewer"));this.Ca.ya(G.a.XKh,ie.a.frame,Object(I.a)(this,this.ZKh,"tryOfficeThroughViewer"))}LIk(a,b,c,f,l){if(this.LHc&&1===c)return this.isFreemiumUpsellEnabled&&this.Ltc?32:8;2===c&&(l?(a=l.SourceControlId,"btnjTryOfficeForWordEditor"===a?Bd.a.En(yg.a.QEa(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):
"PptJewel.About.TryOffice"===a?Bd.a.En(yg.a.QEa(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.xre()):this.xre());return 32}V7e(a,b,c,f,l){if(this.LHc&&1===c)return this.isFreemiumUpsellEnabled&&this.Ltc?32:8;2===c&&(l?(a=l.SourceControlId,Bd.a.En(yg.a.SW("862405")+this.snj(a),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):Bd.a.En(yg.a.SW("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32}ZKh(a,b,c){if(this.LHc&&1===c)return this.isFreemiumUpsellEnabled&&
this.Ltc?32:8;if(2===c)switch(a){case G.a.YKh:Bd.a.En(yg.a.QEa(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case G.a.XKh:Bd.a.En(yg.a.QEa(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get Q6g(){return this.Ltc}get Kzk(){return this.Ltc&&MSOJS.ClientUtils.OfferOfficeInDialog()}get Ltc(){return this.t0h&&!z.a.Ik}get isFreemiumUpsellEnabled(){let a=!1;this.aBd&&(a=this.aBd.isFreemiumUpsellEnabled());return a}xre(a=null){let b=0;a&&(b=a);Bd.a.En(ra.ikj(b),"_blank",void 0,"LaunchOfficeOffer")}snj(a){let b=
0;switch(a){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":b=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":b=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":b=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":b=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":b=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":b=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":b=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":b=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":b=
9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":b=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":b=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":b=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":b=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":b=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":b=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":b=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":b=27;break;
case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":b=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":b=29}return 0===b?"":String.format("&pc={0:D}",b)}static ikj(a){if(z.a.Vi)switch(a){case 1:return yg.a.SW("393806");case 2:return yg.a.SW("393810");case 3:return yg.a.SW("393809");case 5:return yg.a.SW("393805")}else if(z.a.kJ)switch(a){case 1:return yg.a.SW("521979");case 3:return yg.a.SW("521980");case 5:return yg.a.SW("521978");case 2:return yg.a.SW("522490")}else{if(2===a)return yg.a.SW("517778");
if(1===a)return yg.a.QEa(30)}return yg.a.SW("522402")}}Object(m.a)(ra,"OfficeTrialExperience",null,[1311]);class Fa{Yb(a){a.register(ra,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").ma().oa(()=>new ra(w.AFrameworkApplication.Ra,w.AFrameworkApplication.Hoe,w.AFrameworkApplication.lcid));a.register(X,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").ma().oa(()=>new X(w.AFrameworkApplication.Ra,w.AFrameworkApplication.Dpg,w.AFrameworkApplication.lcid))}}
Object(m.a)(Fa,"OpenInClientConfiguration",null,[3]);var $a=d(185),rb=d(49);class bc{constructor(a,b,c){this.RX=this.ou=this.K=null;this.tf=a;this.jG=b;this.JFe=c}gPf(a,b,c){if(!this.tf)return null;if(!this.K){this.K=rb.a.$d();this.K.id=this.jG;this.K.className="HTMLSpinnerIndicator";const f=rb.a.$d();f.className="HtmlspinnerOverlay";this.ou=rb.a.$d();this.ou.className="HtmlspinnerInner";const l=rb.a.Il();l.className="BootSpinner";this.ou.appendChild(l);this.JFe&&(this.RX=rb.a.Il(),this.RX.id="htmlspinner_label",
this.ou.appendChild(this.RX));this.K.appendChild(f);this.K.appendChild(this.ou);this.tf.appendChild(this.K)}this.JFe&&(this.RX.innerText=a||ResourceStrings.l_Loading);this.OTd(b,c);return this.K}YQb(a){this.RX&&(this.RX.innerText=a)}OTd(a,b){this.K.style.left=rb.a.Pc(a);this.K.style.top=rb.a.Pc(b);this.ou.style.bottom=this.JFe?rb.a.Pc(this.tf.clientHeight/2+16):rb.a.Pc(this.tf.clientHeight/2+24)}}Object(m.a)(bc,"HtmlSpinnerIndicator",null,[]);class Ac extends bc{constructor(a,b,c){super(a,b,!1);this.LFe=
c}gPf(a,b,c){if(!this.tf)return null;if(!this.K){this.K=rb.a.$d();this.K.id=this.jG;this.K.className="HTMLProgressIndicator";const f=rb.a.$d();f.className="HtmlprogressOverlay";this.ou=rb.a.$d();this.ou.className="HtmlprogressInner";if(this.LFe){const l=rb.a.sB();l.src=$a.a.JN(se.a.Foa);l.width=se.a.HKb;l.height=se.a.vmd;this.ou.appendChild(l)}this.RX=rb.a.Il();this.ou.appendChild(this.RX);this.K.appendChild(f);this.K.appendChild(this.ou);this.tf.appendChild(this.K)}this.RX.innerText=a||ResourceStrings.l_Loading;
this.OTd(b,c);return this.K}OTd(a,b){this.K.style.left=rb.a.Pc(a);this.K.style.top=rb.a.Pc(b);this.K.style.display=wf.a.Rj;this.ou.style.position=wf.a.oba;a=this.ou.clientWidth;this.ou.style.top=rb.a.Pc(this.tf.clientHeight/2-this.ou.clientHeight/2);w.AFrameworkApplication.isRtl?(this.ou.style.right=rb.a.Pc(this.tf.clientWidth/2-a/2),this.ou.style.direction=wf.a.f2a):(this.ou.style.left=rb.a.Pc(this.tf.clientWidth/2-a/2),this.ou.style.direction=wf.a.PFh);this.K.style.display=wf.a.Pe}}Object(m.a)(Ac,
"HtmlProgressIndicator",bc,[]);class Tc{constructor(a,b){this.RJ=this.ZO=this.K=null;this.Ab=!0;this.GFg=a;this.yJ=b}MOb(a,b,c,f,l){w.AFrameworkApplication.SBb()||(this.K=this.GFg.gPf(a,c,f),b?(this.ZO&&(window.clearTimeout(this.ZO),this.ZO=null),this.RJ&&(window.clearTimeout(this.RJ),this.RJ=null),this.Z1e(l)):this.ZO||this.RJ||(this.ZO=window.setTimeout(()=>{this.x2e(l)},200)))}aZc(){this.ZO&&(window.clearTimeout(this.ZO),this.ZO=null);this.RJ&&(window.clearTimeout(this.RJ),this.RJ=null);this.K&&
(this.K.style.display=wf.a.Pe,this.K.style.opacity="0")}YQb(a){this.GFg.YQb(a)}Z1e(a){this.K&&(this.K.style.opacity="1.0",this.K.style.visibility=wf.a.Oz,this.Ab&&(this.K.style.display=wf.a.Rj),xa.a.J(512496862,811,15,"HtmlProgressIndicatorView::spinner shows up. actionName={0}",this.Bwc(a)))}x2e(a){this.ZO=null;this.K&&(this.K.style.visibility=wf.a.Oz,this.Ab&&(this.K.style.display=wf.a.Rj),this.K.style.opacity="0.0",this.RJ||(this.RJ=window.setTimeout(()=>{this.w2e(a)},1800)))}w2e(a){this.RJ=null;
this.K&&(this.K.style.opacity="1.0",this.Ab&&(this.K.style.display=wf.a.Rj),xa.a.J(512496861,811,15,"HtmlProgressIndicatorView::spinner shows up. actionName={0}",this.Bwc(a)))}Bwc(a){return a?Object.getType(a)===String?a:Object.getType(a)===Number?this.yJ.t6(a):null:null}get visible(){return this.Ab}set visible(a){this.Ab=a;this.K&&(this.K.style.display=a?wf.a.Rj:wf.a.Pe)}}Object(m.a)(Tc,"HtmlProgressIndicatorView",null,[1286]);class pd{constructor(){this.PresentationID=this.PodSessionID=this.PodEndpointUrl=
null}}Object(m.a)(pd,"UploadConvertedFileToHostParams",null,[]);var re=d(1040),He=d(78);const Te=a=>{for(let b=0;b<a.children.length;b++){const c=a.children[b];c.style.position="relative";c.style.top=(c.parentNode.offsetHeight-c.offsetHeight)/2+"px"}},Kf=a=>a.mc.keyCode===B.a.Dp||a.mc.keyCode===B.a.zK?(a.Bc.click(),!0):!1,ih=(a,b,c,f,l,y,H)=>{const Q=document.createElement("a");Q.className="ProtocolLaunchingDialogButtonAnchor";Q.className+=" OICDialog";Q.id=a;Q.setAttribute(Ve.a.hf,Ve.a.Ju);Q.style.padding=
"0";Q.style.margin="0";f&&Yi(l,b,c,f,Q);a=document.createElement("span");a.className="ProtocolLaunchingDialogButtonLabel";a.innerText=l;Q.appendChild(a);Q.tabIndex=0;y&&td.a.instance.rb(oa.a.click,Q,y);H&&x.KeyInputManager.instance.rb(oa.a.Tl,Q,H);return Q},Yi=(a,b,c,f,l)=>{var y=document.createElement("img");y.alt=a;y.className=He.getImageClassWithCluster(c,f);y.src=b;y.setAttribute(Ve.a.hf,Ve.a.iQ);a=document.createElement("span");a.className="ProtocolLaunchingDialogImg32Container";a.appendChild(y);
y=document.createElement("span");y.className="ProtocolLaunchingDialogIconContainer";y.appendChild(a);l.appendChild(y)};class mi{static get sg(){return bi.a.VC(mi.Fo,CommonUIStrings.l_OICLaunchDialogTitle)}}mi.Fo="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(m.a)(mi,"OICLaunchDialogHtml",null,[]);class Pk extends bi.a{constructor(a){super();this.wob=this.L3a=null;this.kOa=!1;this.px=a;this.sg=mi.sg;this.Ad=5;this.kg="OICLaunchDialog";this.showDialog("",Object(I.a)(this,this.Qzk,"oicLaunchDialogResultHandler"));this.Ywh();this.y6("ProtocolLaunchingDialogTitle");4!==w.AFrameworkApplication.Aa.ob.ita&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.eS(this.L3a);ka.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}Jxa(){this.L3a=ih("BtnRichClient",this.px.hwb,this.px.tbb,this.px.lhe,CommonUIStrings.l_OICLaunchRichClient,Object(I.a)(this,this.Jah,"onRichClientButtonClick"),Kf);document.getElementById("OICLaunchRichClient").appendChild(this.L3a);Te(this.L3a);this.wob=ih("BtnReturn",this.px.hwb,this.px.tbb,this.px.Wig,CommonUIStrings.l_OICReturnToOnlineClient,Object(I.a)(this,this.Hah,"onReturnButtonClick"),
Kf);document.getElementById("OICReturnToApp").appendChild(this.wob);Te(this.wob)}Hah(){this.hide();this.px.N0a();return!0}Jah(){ka.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();w.AFrameworkApplication.Ra.processAction(G.a.ykb,2);return!0}Qzk(){this.px.N0a()}dispose(){this.kOa||(this.L3a&&(td.a.instance.Bb(oa.a.click,this.L3a,Object(I.a)(this,this.Jah,"onRichClientButtonClick")),x.KeyInputManager.instance.Bb(oa.a.Tl,this.L3a,Kf)),this.wob&&(td.a.instance.Bb(oa.a.click,
this.wob,Object(I.a)(this,this.Hah,"onReturnButtonClick")),x.KeyInputManager.instance.Bb(oa.a.Tl,this.wob,Kf)),super.dispose(),this.kOa=!0)}}Object(m.a)(Pk,"OICLaunchDialog",bi.a,[]);class jh{static get sg(){return bi.a.VC(jh.Fo,CommonUIStrings.l_OICDialogTitle)}}jh.Fo="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(m.a)(jh,"ProtocolLaunchingDialogV2Html",null,[]);var Vm=d(202);class Po extends bi.a{constructor(a){super();this.vob=this.DAa=null;this.kOa=!1;this.QNa=null;this.px=a;this.sg=jh.sg;this.Ad=5;this.kg="ProtocolLaunchingDialog";this.Yzc="OICRetryDialog";w.AFrameworkApplication.Ae.tua&&w.AFrameworkApplication.Ae.rLa();w.AFrameworkApplication.Ae.Hb(new dd.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(I.a)(this,this.npc,"protocolLaunchingDialogResultHandler"));this.Ywh();
this.y6("Issues");this.I1f();ka.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}Jxa(){const a=document.getElementById("Issues");if(a){Yi("",this.px.hwb,this.px.tbb,this.px.lhe,a);const b=document.createElement("span");b.className="WACDialogSectionTitle";b.innerText=5===this.px.Ech?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;a.appendChild(b);Te(a);a.style.display="none"}w.AFrameworkApplication.Aa.ob.Fdg?
(this.vob=ih("GiveFeedback",this.px.hwb,this.px.tbb,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(I.a)(this,this.Fid,"onGiveFeedbackClick"),Object(I.a)(this,this.K9g,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.vob),Te(this.vob)):document.getElementById("ButtonGiveFeedback").style.display="none";0===w.AFrameworkApplication.Aa.ob.ita||w.AFrameworkApplication.CUi?document.getElementById("ButtonEdit").style.display="none":(this.DAa=
ih("Edit",this.px.hwb,this.px.tbb,"",2===w.AFrameworkApplication.Aa.ob.zk?4===w.AFrameworkApplication.Aa.ob.ita?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===w.AFrameworkApplication.Aa.ob.ita?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(I.a)(this,this.Y8g,"onEditClick"),Object(I.a)(this,this.b9g,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.DAa),Te(this.DAa));0===w.AFrameworkApplication.Aa.ob.ita&&
!w.AFrameworkApplication.Hoe&&a&&(a.style.display="none")}J1f(){return this.QNa?(this.eS(this.QNa),!0):!1}I1f(){return this.DAa?(this.eS(this.DAa),!0):!1}b9g(a){return this.eLe(a,0)}K9g(a){return this.eLe(a,2)}Gah(a){return this.eLe(a,1)}eLe(a,b){let c=!1;if(a.mc.keyCode===B.a.Dp||a.mc.keyCode===B.a.zK)a.Bc.click(),c=!0;else if(a.mc.keyCode===Sys.UI.Key.down||a.mc.keyCode===Sys.UI.Key.up)switch(b){case 1:c=this.I1f();break;case 0:c=this.J1f()}return c}Y8g(){this.hide();4===w.AFrameworkApplication.Aa.ob.ita?
(ka.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.px.N0a()):(ka.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.px.p9b());return!0}Fid(){ka.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");return!0}Ijd(){ka.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";w.AFrameworkApplication.Ra.processAction(G.a.ykb,2);return!0}npc(){this.px.N0a()}switchToBackupMode(){var a=document.getElementById("ProtocolLaunchingDialogTitle");
if(a){a.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(a=document.getElementById("Issues"))a.style.display="block";(a=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!a.children.length&&(this.QNa=ih("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(I.a)(this,this.Ijd,"onRetryOICClick"),Object(I.a)(this,this.Gah,"onRetryOICKeyUp")),a.appendChild(this.QNa),Te(this.QNa),this.DAa||this.J1f())}}dispose(){this.kOa||(this.DAa&&(td.a.instance.Bb(oa.a.click,this.DAa,Object(I.a)(this,
this.Y8g,"onEditClick")),x.KeyInputManager.instance.Bb(oa.a.Tl,this.DAa,Object(I.a)(this,this.b9g,"onEditKeyUp"))),this.vob&&(td.a.instance.Bb(oa.a.click,this.vob,Object(I.a)(this,this.Fid,"onGiveFeedbackClick")),x.KeyInputManager.instance.Bb(oa.a.Tl,this.vob,Object(I.a)(this,this.K9g,"onGiveFeedbackKeyUp"))),this.QNa&&(td.a.instance.Bb(oa.a.click,this.QNa,Object(I.a)(this,this.Ijd,"onRetryOICClick")),x.KeyInputManager.instance.Bb(oa.a.Tl,this.QNa,Object(I.a)(this,this.Gah,"onRetryOICKeyUp"))),super.dispose(),
this.kOa=!0)}}Object(m.a)(Po,"ProtocolLaunchingDialog",bi.a,[]);class Kn extends Ai.StandardDialog{constructor(a){super();this.px=a;this.kg="ProtocolLaunchingDialog";w.AFrameworkApplication.Ae.tua&&w.AFrameworkApplication.Ae.rLa();w.AFrameworkApplication.Aa.ob.Fdg&&this.iSd(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(I.a)(this,this.Fid,"onGiveFeedbackClick"));Kn.qgg?(this.Ad=12,this.Oe(1,CommonUIStrings.l_CloseFile),this.Oe(2,CommonUIStrings.l_OICDialogContinueHere),this.Oe(3,CommonUIStrings.l_OICDialogLaunchAgain)):
(this.Ad=4,this.Oe(1,CommonUIStrings.l_OICDialogContinueHere),this.Oe(2,CommonUIStrings.l_OICDialogLaunchAgain));this.THb(CommonUIStrings.l_OICDialog2ndTitle,5===this.px.Ech?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(I.a)(this,this.npc,"protocolLaunchingDialogResultHandler"),null)}Fid(a){ka.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");this.n9g(a)}Ijd(){ka.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");w.AFrameworkApplication.Ra.processAction(G.a.ykb,
2)}npc(a){Kn.qgg?3===a?this.Wrh():2===a||0===a?this.continueEditing():1===a&&this.closeDocument():2===a?this.Wrh():(1===a||0===a)&&this.continueEditing()}closeDocument(){ka.ULS.sendTraceTag(577783557,211,50,"Closing the document");w.AFrameworkApplication.Ra.Ka(G.a.close,2,Bi.a)}Wrh(){ka.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(I.a)(this,this.Ijd,"onRetryOICClick"),0)}continueEditing(){4===w.AFrameworkApplication.Aa.ob.ita||w.AFrameworkApplication.fa.ka("WordConsumptionViewToEditRedirectIsEnabled")&&
1===w.AFrameworkApplication.Aa.mode?(ka.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.px.N0a()):(ka.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.px.p9b())}static get qgg(){return w.AFrameworkApplication.fa.ka("OICDialogThreeActions")&&32===w.AFrameworkApplication.Ra.processAction(G.a.close,1)}}Object(m.a)(Kn,"StandardProtocolLaunchingDialog",Ai.StandardDialog,[]);var Qo=d(677);class Wm{}Object(m.a)(Wm,"EditDocumentInClientParams",null,[]);
class Xm{static FVf(a,b,c,f,l,y,H=!1,Q=!1,ia="",wa=!1,Ua=!1,kb=!1,Gb="",ec="",dc="",Fc=!1,yc=""){const tc=new Wm;tc.DocumentUrl=a;tc.DocumentExtension=yc;tc.Mode=b;tc.Options=c;tc.Application=f;tc.SilentExternalHandler=H;tc.EncodeUrl=Q;tc.CorrelationIdForWinClient=ia;tc.NavigateUsingWindowOpen=wa;tc.DescriptiveUnattemptedEnums=Ua;tc.NoBrowserModalDialogs=kb;tc.SessionOrigin=Gb;tc.CorrelationId=ec;tc.ClickTime=dc;tc.NewTelemetryDataIsEnabled=Fc;MSOJS.ClientUtils.EditDocumentInClient(tc,l,y)}}Object(m.a)(Xm,
"ClientUtils",null,[]);var rp=d(574),Qp=d(539),iq=d(112);class jq{constructor(a){this.zBa=this.GTb=this.LSb=null;this.tUb=!1;this.KDd=this.EJd=this.Cof=null;this.dzc=this.wqa=this.kGc="";this.application=this.ez=0;this.LCl=this.E4e=!1;this.BRl=a&&w.AFrameworkApplication.fa.ka("OICLaunchDialogIsEnabled");w.AFrameworkApplication.Ra.GT(G.a.ykb)||w.AFrameworkApplication.Ra.ya(G.a.ykb,ie.a.frame,Object(I.a)(this,this.Gcl,"retryOpenInClientAction"));this.hDh=!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("SilentExternalHandler")}get Ech(){return this.ez}Qol(a,
b="",c=""){this.wqa=c||Hg.a.create().toString();this.kGc=b||rp.a.D9f();this.dzc=a}Gcl(a,b,c){return b.contextId!==ie.a.frame?2:1===c?32:this.ykb()}get options(){let a=0;w.AFrameworkApplication.requiresCheckout&&(a|=1);w.AFrameworkApplication.Kch&&(a|=4);this.JCl()&&(a|=64);return a}JCl(){return!(2===this.application&&w.AFrameworkApplication.fa.ka("IsEmbeddedScenario"))}get hwb(){return w.AFrameworkApplication.Cm}get tbb(){return w.AFrameworkApplication.cO}get Wig(){return""}get lhe(){return""}get KCl(){return w.AFrameworkApplication.fa.ka("OneNoteMobileViewerIsEnabled")}get DFl(){return this.Cof||
(this.Cof=Ib.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.E4e||this.r0i()}N0a(){this.LCl||this.QYf()}a0k(a){return this.BRl&&z.a.Vi?(new Pk(this),32):this.evb(a)}evb(a){const b=({C2a:a}=this.N7j(a)).returnValue;ka.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===b,a);return b}begin(a,b,c,f,l,y,H=""){this.LSb=a;this.KDd=H;this.GTb=b;this.zBa=y;this.application=c;this.ez=f;return w.AFrameworkApplication.dVf?(this.Cug(),32):w.AFrameworkApplication.ZQ&&!w.AFrameworkApplication.Thg?
(w.AFrameworkApplication.MCh(),8):this.lEf(l)}get Pzk(){return!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}ykb(){this.Pzk&&this.lak();return this.evb(this.tUb)}svh(){const a=new Qp.a(Qe.a.openInClient);a.Values["ui-language"]=w.AFrameworkApplication.lcid.toString();a.Values[Qo.a.VQf]=w.AFrameworkApplication.userSessionId;return this.zBa.value.send(a)?32:8}lak(){$d.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new Mj.a,{inStaging:!0}))}Uhl(a){const b=new Qp.a(Qe.a.ZTl);b.Values["ui-language"]=w.AFrameworkApplication.lcid.toString();b.Values[Qo.a.VQf]=w.AFrameworkApplication.userSessionId;b.Values[ai.a.YTl]=a;this.zBa.value.send(b)}N7j(a){this.tUb=a;this.Uhl(5===this.ez?jq.EJk:jq.KJk);return 5===this.ez?this.M7j():this.O7j()}M7j(){this.Iug();return{returnValue:32,C2a:"HostEditUrl,"}}O7j(){let a;var b=a="";w.AFrameworkApplication.pyf&&(b="|f|"+w.AFrameworkApplication.userSessionId);
const c=w.AFrameworkApplication.fa.ka("IsAssignmentMode")&&w.AFrameworkApplication.fa.ka("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||w.AFrameworkApplication.Dcc||z.a.xGa,f=w.AFrameworkApplication.fa.ka("UnattemptedEnumIsEnabled"),l=w.AFrameworkApplication.fa.ka("NoBrowserModalDialogs");if(w.AFrameworkApplication.Ra.chd){var y=w.AFrameworkApplication.Ra.L8b(3588168074);y&&this.Qol(y.epochClickTime,y.sessionOrigin,y.correlationId);this.vwg()}if(w.AFrameworkApplication.lhh){a+="NewOrder,";
y=8;this.zBa&&this.zBa.value&&this.zBa.value.isEnabled()&&w.AFrameworkApplication.lxc&&(a+="Post,",y=this.svh());if(32===y)return{returnValue:y,C2a:a};ka.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return w.AFrameworkApplication.du.Vxa?(ka.ULS.shipAssertTag(5566816,211,!!w.AFrameworkApplication.du.Vxa),a+="HostUrl,",{returnValue:w.AFrameworkApplication.Aa.KM(!0,w.AFrameworkApplication.du.Vxa),C2a:a}):this.LSb?(ka.ULS.sendTraceTag(18715405,211,15,
"Try to open doc in rich client, SessionId {0}",w.AFrameworkApplication.userSessionId),a+="DocUrl,",Xm.FVf(this.LSb,this.ez,this.options,this.application,Object(I.a)(this,this.a9g,"onEditInClientSuccess"),Object(I.a)(this,this.$8g,"onEditInClientFailure"),this.hDh,w.AFrameworkApplication.fa.ka("OICEncodeUrlIsEnabled"),b,c,f,l,this.kGc,this.wqa,this.dzc,w.AFrameworkApplication.Ra.chd,this.KDd),{returnValue:32,C2a:a}):{returnValue:8,C2a:a}}a+="OldOrder,";if(!this.LSb&&w.AFrameworkApplication.du.Vxa)return this.zBa&&
this.zBa.value&&this.zBa.value.isEnabled()&&w.AFrameworkApplication.lxc?(a+="Post,",b=this.svh()):(ka.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),b=8),32!==b?(ka.ULS.shipAssertTag(22595484,211,!!w.AFrameworkApplication.du.Vxa),a+="HostUrl,",{returnValue:w.AFrameworkApplication.Aa.KM(!0,w.AFrameworkApplication.du.Vxa),C2a:a}):{returnValue:b,C2a:a};ka.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",w.AFrameworkApplication.userSessionId);
a+="DocUrl,";Xm.FVf(this.LSb,this.ez,this.options,this.application,Object(I.a)(this,this.a9g,"onEditInClientSuccess"),Object(I.a)(this,this.$8g,"onEditInClientFailure"),this.hDh,w.AFrameworkApplication.fa.ka("OICEncodeUrlIsEnabled"),b,c,f,l,this.kGc,this.wqa,this.dzc,w.AFrameworkApplication.Ra.chd,this.KDd);return{returnValue:32,C2a:a}}K$k(a){w.AFrameworkApplication.mj.setDw(8981,a)}a9g(a){this.K$k(a);ka.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===a&&MSOJS.ClientUtils.ShouldShowDialog()?
(this.KCl||this.Iug(),this.vwg()):this.E4e||this.closeApplication()}$8g(a,b=0){ka.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",a,b);if(5===a)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const c=!!this.GTb&&!this.tUb;let f=0;1===a&&(f=2);6<=a&&13>=a&&(f=1,1===b&&(this.E4e=!0));this.DFl.Kzk?(ka.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",f),re.a.instance.RMi(this.tUb?Object(I.a)(this,
this.Z6g,"oicErrorDialogHandlerCloseForced"):Object(I.a)(this,this.$6g,"oicErrorDialogHandlerNoCloseForced"),c?Object(I.a)(this,this.j$g,"onLaunchDownload"):null,this.HTf(!1)?Object(I.a)(this,this.NJj,"iHaveOfficeButtonHandler"):null,f,b)):(ka.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",f),re.a.instance.PMi(this.tUb?Object(I.a)(this,this.Z6g,"oicErrorDialogHandlerCloseForced"):Object(I.a)(this,this.$6g,"oicErrorDialogHandlerNoCloseForced"),c?Object(I.a)(this,this.j$g,
"onLaunchDownload"):null,f))}}vwg(){try{const a=[Object.assign(new iq.a,{name:"CorrelationId",string:this.wqa}),Object.assign(new iq.a,{name:"SessionOrigin",string:this.kGc}),Object.assign(new iq.a,{name:"ClickTime",string:this.dzc}),Object.assign(new iq.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];wn.a("OpenInClientCompleted",!0,0,a)}catch(a){ka.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+a.toString())}}Iug(){w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.ob.hD&&
w.AFrameworkApplication.fa.ka("StandardProtocolDialogIsEnabled")?new Kn(this):new Po(this)}Z6g(){this.closeApplication()}$6g(){this.N0a()}j$g(){this.Cug()}NJj(){return this.HTf(!0)}HTf(a){const b=(z.a.NVa||z.a.Ho)&&!!w.AFrameworkApplication.$Pc;b&&a&&(Bd.a.En(w.AFrameworkApplication.$Pc,"_blank",void 0,"OpenInClient"),this.closeApplication());return b}}jq.KJk="OpenInDesktop";jq.EJk="OpenInBrowser";Object(m.a)(jq,"AOpenInClientOperation",null,[]);class yt extends jq{constructor(a,b,c=!1){super(c);
this.b_h=a;this.a_h=b}get Wig(){return this.a_h}get lhe(){return this.b_h}r0i(){w.AFrameworkApplication.Ra.Ka(G.a.close,2,Bi.a)}QYf(){}lEf(a){return this.a0k(a)}Cug(){ka.ULS.shipAssertTag(5566817,211,!!this.GTb);w.AFrameworkApplication.rea?w.AFrameworkApplication.Aa.KM(!0,this.GTb):Bd.a.En(this.GTb,void 0,void 0,"LaunchDownload")}p9b(){w.AFrameworkApplication.Aa.ob.p9b()}}Object(m.a)(yt,"OpenInClientOperation",jq,[]);class Hu extends yt{constructor(a,b,c,f){super("PowerPoint_32x32x32","EditInPowerPointWebApp_32x32x32");
if(!a)throw Error.argumentNull("pathManager");this.nNg=b;this.ke=a;this.lo=c;this.ia=f}get hwb(){return this.ke.qk(this.tbb+".png")}get tbb(){return"prt2"}lEf(a){return this.nNg?this.nNg(a):this.evb(a)}QYf(){xa.a.J(512496860,801,50,"OpenInPowerPointOperation - restarting edit session");this.ia.Ka(ea.a.refresh,2,{refreshtrigger:"OpenInPowerPointOperation::ExecuteRestartApplication"})}evb(a){this.lo.ybc=!0;return super.evb(a)}}Object(m.a)(Hu,"OpenInPowerPointOperation",yt,[]);class ts{constructor(a,
b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye){this.DFg=null;this.ME=y;this.ia=a;this.Fa=b;this.pa=c;this.ke=f;this.mNg=new Hu(this.ke,Object(I.a)(this,this.npi,"beginSaveBeforeOpenInClient"),kb,a);H.execute(Xd=>{this.DFg=new Bb.a(()=>Xd)});this.PBg=l;this.Vu=Q;this.etk=ia;this.ta=wa;this.$b=Ua;this.Ea=Gb;this.Ya=ec;this.zfa=dc;this.Vb=Fc;this.Ud=yc;this.Ym=tc;this.Vv=xd;this.hgb=Vd;this.N$=Ld;this.wR=ye}vb(){this.ia.ya(ea.a.openInClient,hc.a.application,Object(I.a)(this,this.Gch,"openExternal"));
this.ia.ya(G.a.BNe,hc.a.application,Object(I.a)(this,this.Gch,"openExternal"));this.ia.ya(ea.a.convertAndEdit,hc.a.application,Object(I.a)(this,this.RHi,"convertBinaryFormat"));this.ia.ya(ea.a.repair,hc.a.application,Object(I.a)(this,this.e$k,"repairCorruptedFile"));this.ia.ya(ea.a.mrc,hc.a.application,Object(I.a)(this,this.mrc,"replaceOriginalFile"));this.ia.ya(ea.a.MMb,hc.a.application,Object(I.a)(this,this.MMb,"saveRepairedFile"));this.ia.ya(ea.a.V4b,hc.a.application,Object(I.a)(this,this.V4b,
"editAnyway"));this.ia.ya(ea.a.a9b,hc.a.application,Object(I.a)(this,this.a9b,"goToEditMode"));this.ia.he(ea.a.openInClient,12288)}npi(a){if(this.Ym.isPaused)return this.Fa.Bd(),this.cYe(a),32;this.pa.nh();this.Fa.Bd();if(1===this.Vb.mode&&this.Ea.erg)return this.F0f(a),32;this.ME.U3(a,!0,()=>{this.cYe(a)},()=>{this.cYe(a);return!0},3);this.Vu.show(!1,"OpenInClient");return 32}cYe(a){this.Vu.hide();this.F0f(a)}F0f(a){Nc.a.gxd();this.mNg.evb(a)}Gch(a,b,c){if(b.contextId!==hc.a.application)return 2;
b=!(!this.ke.documentUrl&&!this.PBg.Vxa&&!w.AFrameworkApplication.lxc);if(1===c)return b?32:8;if(!b)return 8;this.ick();if(this.$b.$c(this.etk.Ef))return 16;a=a===G.a.BNe?5:2;1===this.Vb.mode&&this.Ea.erg&&(a=1);return this.mNg.begin(this.ke.documentUrl,w.AFrameworkApplication.BSa,3,a,this.Ea.r_j,this.DFg,eb.a("OpenPPTTemplateInDesktopAppAsNFT")?ma.a.AQ(this.PBg.rx):"")}ick(){try{let a="";const b=this.ta.pk;b&&(a=b.toString());xa.a.J(509372432,801,50,"User clicked OpenInClient. Slide index: {0}. Slide stats:{1}",
this.ta.currentSlideIndex,a)}catch(a){xa.a.J(509372431,801,10,"Exception caught while logging slide stats for OpenInClient: {0}",a)}}RHi(a,b,c){xa.a.J(509372430,801,50,"PowerPointAppFrameCommandUIActor - ConvertBinaryFormat");if(b.contextId!==hc.a.application)return 2;if(1===c)return 32;const f=Object.assign(new pd,{PodEndpointUrl:this.Ea.podsWebServiceBase,PodSessionID:this.Ya.podSessionId,PresentationID:this.Ya.presentationId.string});this.zfa.Kyd(f,Object(I.a)(this,this.UIk,"onUploadConvertedFileToHostSucceeded"),
l=>{this.TIk(l,f.PodSessionID)});this.Vu.E2e(!0,ResourceStrings.L_FileConverting,a);return 32}UIk(a){xa.a.J(509372429,801,50,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded");this.Vu.hide();if(this.Vb)if(a=a.result,a.EditUrl){var b=!1,c=!1,f=!1;w.AFrameworkApplication.fa&&(b=w.AFrameworkApplication.fa.ka("IsUIEmbedMode"),c=w.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"),f=w.AFrameworkApplication.fa.ka("UiHostSupportsPPTConvertScenarios"));if(b&&c&&f){xa.a.J(509372426,
801,50,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded Sending DocumentRefresh post message.");const l={};l[ai.a.FLb]="1";l[ai.a.documentUrl]=a.EditUrl;l[ai.a.mode]="edit";l[ai.a.reason]=mw.a.convert;w.AFrameworkApplication.KT().execute(y=>{y.sendMessage(Qe.a.XDa,l)})}else this.Vb.KM(!0,a.EditUrl)}else xa.a.J(509372427,801,15,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded no EditUrl");else xa.a.J(509372428,801,15,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded no available app frame")}TIk(a,
b){a=$e.a.nL(a.error.Vm);xa.a.J(509372425,801,10,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostFailed error: {0}",a);this.Vu.hide();a=Object.assign(new Hj.a,{Code:a,Source:5});this.Ud.Ds(a,b,c=>{c.KC=1;c.bDa=6;c.title=ResourceStrings.L_FileConversionTitle;c.message=ResourceStrings.L_FileConversionError;return!1})}e$k(a,b,c){if(b.contextId!==hc.a.application)return 2;if(1===c)return 32;xa.a.J(509372424,801,50,"PowerPointAppFrameCommandUIActor - Start to repairCorruptedFile");this.g$k();
return 32}g$k(){const a=new Date;xa.a.J(509372423,801,50,"PowerPointAppFrameCommandUIActor::RepairFileInline: Starting Document repair. Start-time {0}",a);const b=Nc.a.kk("PowerPointAppFrameCommandUIActor.InlineDocumentRepair");this.wR.lub(()=>{xa.a.J(509372422,801,50,"PowerPointAppFrameCommandUIActor::RepairFileInline: Closed the pop session early that was triggered due to late detection (after open early success) of corruption. To avoid lock mismatch while writing to host for overwrite case is the reason we do proactively.")},
()=>{xa.a.J(509372421,801,15,"PowerPointAppFrameCommandUIActor::RepairFileInline: Closing the pop session early failed. This might lead to overwrite the file  issues with a lock mismatch error.")});this.hgb.Vph(b,()=>{xa.a.J(509372420,801,50,"PowerPointAppFrameCommandUIActor::RepairFileInline: Operation Successfull,Time-Taken {0}",+new Date-+a);b.finish();this.nIl()},c=>{xa.a.J(509372419,801,10,"PowerPointAppFrameCommandUIActor::RepairFileInline: Operation Failed,Time-Taken {0}, Error: {1}",+new Date-
+a,c);b.finish();this.CUk(c,this.Ya.podSessionId);return!0})}nIl(){var a={failedMachineId:null,isPlanedShutdown:!1};a.podSessionId=this.Ya.podSessionId;a.fromInlineDocumentRepair=!0;this.Vv.KZe();a=this.ia.Ka(ea.a.LLb,2,a);xa.a.J(509372418,801,50,"PowerPointAppFrameCommandUIActor::TriggerDocRefresh: Response-{0}",a)}CUk(a,b){a=Object.assign(new Hj.a,{Code:a,Source:5});this.Ud.Ds(a,b,c=>{c.KC=1;c.bDa=52;c.title=ResourceStrings.l_RepairFailDialogTitle;c.message=ResourceStrings.l_RepairFailedMessage;
return!1})}V4b(a,b,c,f,l){if(b.contextId!==hc.a.application)return 2;if(1===c)return 32;xa.a.J(509372417,801,50,"PowerPointAppFrameCommandUIActor - EditAnyway");a=this.Vv.cyb();0!==a&&(xa.a.J(509372416,801,15,"PowerPointAppFrameCommandUIActor::EditAnyway - Creating Pop session as emergencyViewModeEnabledReason: {0}",a),this.PPf());if(20===l)this.Vv.YNl();else return xa.a.J(509372387,801,10,"PowerPointAppFrameCommandUIActor - Unexpected EditAnyway operation"),8;return 32}MMb(a,b,c,f,l){if(b.contextId!==
hc.a.application)return xa.a.J(509372386,801,15,"PowerPointAppFrameCommandUIActor - SaveRepairedFile. Context id don't match with Application. ContextId: {0}",b.contextId),2;if(1===c)return this.ia.processAction(l,1);xa.a.J(509372385,801,50,"PowerPointAppFrameCommandUIActor - SaveRepairedFile - saveAsActionId : {0}",l);this.ubg(1,l);return 32}ubg(a,b){xa.a.J(509372384,801,50,"GetSnappedDownloadUrl for saving the repaired file");const c=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",
this.Ea.podsWebServiceBase,this.Ya.podSessionId),f={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};f["X-UserSessionId"]=w.AFrameworkApplication.userSessionId;const l=new Date;w.AFrameworkApplication.Me.zj(c,1,"",f,!1,0,y=>{this.$Le(y,l,b)},y=>{this.ZLe(y,a,b)},null,null)}$Le(a,b,c){xa.a.J(509372383,801,50,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlSucceeded. Time-Taken : {0}",+new Date-+b);a=JSON.parse(a.data.ee).downloadUrl;ma.a.Xa(a)?(xa.a.J(509372382,
801,10,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlSucceeded but downloadUrl is null or empty"),this.bEh()):(b={SkipSaveToHost:"true"},b.FileDownloadUrl=a,this.ia.Ka(c,2,b))}ZLe(a,b,c){a=a.data?a.data.Ke:-1;a===ua.a.Qoi&&0<b--?(xa.a.J(509372381,801,15,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlFailed : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",a),this.ubg(b,c)):(xa.a.J(509372380,801,10,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlFailed : HttpStatus: {0} , SaveAsActionId : {1}",
a,c),this.bEh())}bEh(){const a=Object.assign(new Hj.a,{Code:20,Source:6});this.Ud.Ds(a,this.Ya.podSessionId,b=>{b.KC=1;b.bDa=1;b.title=ResourceStrings.L_BizBarInlineRepairSaveAsFailedDialogTitle;b.message=ResourceStrings.L_BizBarInlineRepairSaveAsFailedDialogMessage;return!1})}mrc(a,b,c){if(b.contextId!==hc.a.application)return xa.a.J(509372379,801,15,"PowerPointAppFrameCommandUIActor - ReplaceOriginalFile. Context id don't match with Application. ContextId: {0}",b.contextId),2;if(1===c)return a=
w.AFrameworkApplication.fa.Ha("DocumentPermissions")||"",b=this.Ya.tdh&&-1<a.indexOf("W"),xa.a.J(509372378,801,b?50:15,"PowerPointAppFrameCommandUIActor::ReplaceOriginalFile- InlineRepairedFile case: IsReplaceRepairedEnabled : {0}, Document Permission : {1} ",this.Ya.tdh,a),b?32:8;xa.a.J(509372377,801,50,"PowerPointAppFrameCommandUIActor - ReplaceOriginalFile");this.Ya.Uk=this.N$.A$a(this.Ya.presentationId.string);a=Object.assign(new ue.a,{ForceCreatePods:!1,DoRehydrate:!1,IsRetrySession:!1,PodSessionID:this.Ya.podSessionId,
PresentationID:this.Ya.presentationId.string,PodEndpointUrl:this.Ea.podsWebServiceBase,PopSessionID:this.Ya.Uk,UrlOverrides:this.Ea.Caa,IsCreateNewSession:this.Ea.QL,UseSharedHostFile:this.Ea.pRb});this.N$.HLc(a,()=>{this.SCk()},Object(I.a)(this,this.SIb,"onEnsureHostSessionFailed"),0,!0);return 32}SCk(){xa.a.J(509372376,801,50,"PowerPointAppFrameCommandUIActor - OnEnsureHostSessionSuccess");this.Vv.Mal();this.Ya.bbl();0!==this.Vv.cyb()&&this.Vv.LZe(!1)}SIb(){xa.a.J(509372375,801,10,"PowerPointAppFrameCommandUIActor - OnEnsureHostSessionFailed");
this.Vv.KZe();0!==this.Vv.cyb()&&this.Vv.LZe(!0);return!1}a9b(a,b,c){if(b.contextId!==hc.a.application)return xa.a.J(509372374,801,15,"PowerPointAppFrameCommandUIActor - GoToEditMode. Context id don't match with Application. ContextId: {0}",b.contextId),2;if(1===c)return 32;a=new Date;this.PPf();xa.a.J(509372373,801,15,"PowerPointAppFrameCommandUIActor::GoToEditMode. Time-Taken to create pop session : {0}",+new Date-+a);return 32}PPf(){this.Ya.Uk=this.N$.A$a(this.Ya.presentationId.string);const a=
Object.assign(new ue.a,{ForceCreatePods:!1,DoRehydrate:!1,IsRetrySession:!1,PodSessionID:this.Ya.podSessionId,PresentationID:this.Ya.presentationId.string,PodEndpointUrl:this.Ea.podsWebServiceBase,PopSessionID:this.Ya.Uk,UrlOverrides:this.Ea.Caa,IsCreateNewSession:this.Ea.QL,UseSharedHostFile:this.Ea.pRb});this.N$.HLc(a,()=>{this.TCk()},null,15,!0);this.Vv.LZe(!1)}TCk(){xa.a.J(509372372,801,15,"PowerPointAppFrameCommandUIActor - OnEnsureHostSessionSuccessForEmergencyViewMode")}}Object(m.a)(ts,"PowerPointAppFrameCommandUIActor",
null,[]);var Yw=d(513);class yF{constructor(a,b,c){this.Gyg=a;this.C0=b;this.NEb=c}show(a,b){this.NEb?(b=new Yw.a(b),b.message=ResourceStrings.l_Saving,b.yog=!0,b.KOb=a,this.C0.UKa(b)):this.E2e(a,ResourceStrings.l_Saving,b)}E2e(a,b,c){this.NEb?(c=new Yw.a(c),c.message=b,c.KOb=a,this.C0.UKa(c)):this.Gyg.MOb(b,a,0,0,c)}hide(){this.NEb?this.C0.UKa(Object.assign(new Yw.a(null),{xog:!0})):this.Gyg.aZc()}}Object(m.a)(yF,"SaveBlockingUI",null,[1260]);var Ts=d(240);class Zw{constructor(a,b,c,f,l,y,H,Q,ia){this.Fhc=
Rc.App.pn;this.VLg=ha.a.nil;this.wb=a;this.ta=b;this.Mc=c;this.el=f;this.oM=l;this.gdd=y;this.Gz=Q;this.Ur=H;this.alk=ia.efl;this.Ulk=ia.pptNotShowSavingStatusOfProofingOnlyRevision;this.Mc.GC(Object(I.a)(this,this.WE,"onSessionEnd"));this.el.gTd(Object(I.a)(this,this.DOh,"updateSavingStatus"));this.el.Hzf(Object(I.a)(this,this.COh,"updateSavedStatus"));this.Ur.GI(Object(I.a)(this,this.Xpa,"updateSaveStatusDisplay"));this.psk=new dd.a(3,1,ia.dfl,Object(I.a)(this,this.updateSaveStatusText,"updateSaveStatusText"),
90,"28");this.oWa=!1;this.Pbd=ia.powerPointTextEditOnlyMode}initialize(){this.Xpa(this.Ur)}COh(){this.oWa||this.Gz.b0||this.Gz.Mrg||(this.wb.Hb(this.psk),this.oWa=!0)}DOh(a,b){this.Gz.b0||this.Gz.Mrg||(this.Ulk&&Zw.r1j(b.node)||this.gdd.updateSaveStatusText(!1),this.Fhc=new Date,this.VLg=b?b.revisionId:ha.a.nil)}updateSaveStatusText(){this.oWa=!1;const a=!this.oM.eX(this.ta.presentation);this.gdd.updateSaveStatusText(a);a&&(this.fqh(0,0),this.Fhc=Rc.App.pn);this.Pbd&&Zw.mOl(a)}Xpa(a){this.gdd.Xpa(!1,
1===a.mode?1:3)}WE(a,b){this.gdd.updateSaveStatusText(!0);this.fqh(1,b.GD);this.Fhc=Rc.App.pn}fqh(a,b){if(this.Fhc!==Rc.App.pn){var c=+new Date-+this.Fhc;c>=this.alk&&(c=String.format("SavingTime {0};Type {1};Revision {2};",c,a,this.VLg),1===a&&(c+=String.format("CloseReason {0};",b)),xa.a.J(21604228,811,50,c))}}dispose(){this.Mc.Laa(Object(I.a)(this,this.WE,"onSessionEnd"));this.el.vVe(Object(I.a)(this,this.DOh,"updateSavingStatus"));this.el.dph(Object(I.a)(this,this.COh,"updateSavedStatus"));this.Ur.IY(Object(I.a)(this,
this.Xpa,"updateSaveStatusDisplay"))}static mOl(a){const b=document.getElementById("TipStatus"),c=document.getElementById("TipStatusIcon"),f=document.getElementById("TipStatusText");b.style.display="block";a?(c.setAttribute("class","TipStatusSaved"),f.innerText=ResourceStrings.l_SavedShort):(c.setAttribute("class","TipStatusLoading"),f.innerText=ResourceStrings.l_SavingShort)}static r1j(a){return a.Ua(zb.a.xmd)&&!a.Ua(Ts.a.Kqd)}}Object(m.a)(Zw,"SaveStatusManager",null,[107]);class uA{constructor(){this.K=
null;this.zBe=!1}get name(){return"PowerPointWebEditor.Actors"}Yb(a){(new Fa).Yb(a);this.K=a;a.register(ts,"PowerPointWebEditor.PowerPointAppFrameCommandUIActor").ma().oa(()=>new ts(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPoint.IPathManager"),a.resolve("Common.IDocPropertiesProvider"),a.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),a.Ia("Postmessage.IHostPostmessenger"),
a.resolve("PowerPointWebEditor.ISaveBlockingUI"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("Box4.IAppFrame"),a.resolve("PowerPointWebEditor.IErrorHandler"),
a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionCoreManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionCoreManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager")));a.register(1260,"PowerPointWebEditor.ISaveBlockingUI").ma().oa(()=>new yF(new Tc(new Ac(a.resolve("PowerPointWebEditor.IPaneManager").va,"SaveBlockingUI",!0),a.resolve("PowerPointWebEditor.IActionNameResolver")),
a.resolve("PowerPointWebEditor.IGraphActionBlockingEventNotifier"),a.resolve("PowerPointWebEditor.IApplicationSettings").dqg));a.register(Zw,"PowerPointWebEditor.SaveStatusManager").ma().oa(()=>new Zw(a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("Common.App.SaveStatus.ISaveStatusUIHandler"),
a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("PowerPointWebEditor.IApplicationSettings")))}init(){(this.zBe=this.K.resolve("PowerPointWebEditor.IApplicationSettings").W0j)&&this.K.resolve("PowerPointWebEditor.SaveStatusManager").initialize();this.K.resolve("PowerPointWebEditor.PowerPointAppFrameCommandUIActor").vb();this.K.resolve("Common.IOfficeTrialExperience").vb();this.K.resolve("Common.IMacOfficeOffer").vb()}dispose(){this.zBe&&
this.K.resolve("PowerPointWebEditor.SaveStatusManager").dispose()}static main(){n.a.instance.Ac(new uA)}}Object(m.a)(uA,"PowerPointActorsPackage",null,[2,3]);var SP=d(1065),TP=d(1135);class vA{constructor(){this.sQa=this.XS=this.pBa=null;this.etf=!1;this.Qaf=null;this.Raf=this.AWb=0}get messageId(){return this.pBa}get values(){return this.XS}get userSessionId(){return this.sQa}get shouldRetry(){return this.etf}get eIc(){return this.Qaf}get wxa(){return this.AWb}get gai(){return this.Raf}static TNi(a,
b){var c=Qe.a.pRi;const f=new vA;f.pBa=a;f.XS={};f.sQa=b;f.etf=!0;f.Qaf=c;f.AWb=3;f.Raf=1E3;return f}}Object(m.a)(vA,"PostMessageData",null,[]);class wA{constructor(a,b,c){this.rPd={};this.Oa=a;this.dGd=c;this.q$j();this.o2k(b)}q$j(){if(this.Oa.ka("DocRebootIsSupported")||this.Oa.ka("UiHostSupportsDocRebootFeatures"))this.rPd[TP.a.refresh]=()=>this.Ghl(Qe.a.XDa)}o2k(a){a.ya(G.a.Rjh,ie.a.frame,Object(I.a)(this,this.chl,"sendActionToHostIfSupported"))}chl(a,b,c,f,l){if(2!==c)return 32;if(!l)return ka.ULS.sendTraceTag(41972610,
204,15,"HostActionExecutionManager - No actionData provided"),16;a=l.toLowerCase();return this.rPd[a]?(ka.ULS.sendTraceTag(41972611,204,50,"HostActionExecutionManager - executing host action for action id {0}",a),this.rPd[a]()):2}Ghl(a){const b=vA.TNi(a,w.AFrameworkApplication.userSessionId);this.dGd.execute(c=>{c.postMessage(b)});return 32}}Object(m.a)(wA,"HostActionExecutionManager",null,[]);var yy=d(121),xA=d(741);class yA extends Qo.a{constructor(a,b,c,f){super(a,b,c);this.RUb=this.x7=0;this.Zhf=
!1;this.TUb=0;this.cGd=this.GBc=null;this.$hf=this.aif=!1;this.Ca=f;this._name="HostIntegrationMessenger";this.create()}kJj(a){const b=a.message,c=a.Bj.origin;w.AFrameworkApplication.wopiHostOriginFromPostMessage||(w.AFrameworkApplication.wopiHostOriginFromPostMessage=c);switch(b.MessageId){case Qe.a.mWd:case Qe.a.oWd:this.eJj(b);break;case Qe.a.Dee:case Qe.a.Eee:this.oxd();break;case Qe.a.Mge:this.mJj(b);break;case Qe.a.Vcb:this.I6j(b);break;case Qe.a.B$e:this.epi(a);break;case Qe.a.F$e:this.QLl()}}oLl(a){switch(a.MessageId){case Qe.a.Ige:w.AFrameworkApplication.Ra.Ka(G.a.Xpd,
2,a.Values[ai.a.direction]);break;case Qe.a.Lzb:ka.ULS.sendTraceTag(42481157,204,50,"Host_Unload Received");w.AFrameworkApplication.Ra.Ka(G.a.Lzb,2,(new Date).getTime());break;case Qe.a.Jge:ka.ULS.sendTraceTag(544221062,204,50,"We received HostBackButtonPressed message in WAC");break;case Qe.a.Kge:ka.ULS.sendTraceTag(543459140,204,50,"Host_GetClientUrl Recieved");w.AFrameworkApplication.Ra.processAction(G.a.qcj,2);break;case Qe.a.e$b:ka.ULS.sendTraceTag(541894173,204,50,"Host_CopyLink Recieved");
w.AFrameworkApplication.Ra.processAction(G.a.e$b,2);break;case Qe.a.Lge:ka.ULS.sendTraceTag(539760468,204,50,"Host_GetWebUrl Received");w.AFrameworkApplication.Ra.processAction(G.a.bxj,2);break;case Qe.a.Pge:ka.ULS.sendTraceTag(537424842,204,50,"Host_SendChannelId Received")}}oxd(){v.FocusManager.instance()&&v.FocusManager.instance().Ee&&v.FocusManager.instance().Ee.name===w.AFrameworkApplication.Yib&&v.FocusManager.instance().q1(v.FocusManager.instance().Ee.name)}eJj(a){v.FocusManager.instance().XU(w.AFrameworkApplication.Yib,
!1);if(ai.a.Btc in a.Values){const b={};b[ai.a.Btc]=a.Values[ai.a.Btc];ka.ULS.sendTraceTag(38278996,204,50,De.c(b))}}mJj(a){if(!yg.a.JT(document.URL,w.AFrameworkApplication.ugd)&&a.Values){var b=0,c=0;try{b=a.Values[ai.a.nJj],c=a.Values[ai.a.oJj],ai.a.Yhg in a.Values?this.GBc=a.Values[ai.a.Yhg]:ai.a.Zhg in a.Values&&(this.GBc=a.Values[ai.a.Zhg]),ai.a.$hg in a.Values&&(this.cGd=a.Values[ai.a.$hg])}catch(f){return}this.RUb=b;this.TUb=c;this.x7&&this.hwg()}}I6j(a){ka.ULS.sendTraceTag(37536415,204,50,
"JsApiDiagnostics");var b=a.Values[ai.a.jJj];b&&Ji.a.instance.S0k(b);(b=a.Values[ai.a.kZd])&&Ji.a.instance.F0k(b);(a=a.Values[ai.a.Vcb])&&Ji.a.instance.X0k(a)}epi(a){ka.ULS.sendTraceTag(40433733,338,50,"Receive Wac_BeforeUnloadApp. Timestamp: {0}",Date.now());w.AFrameworkApplication.MBb=!0;w.AFrameworkApplication.Aa.d2.SKe(a.Bj.mc)}QLl(){ka.ULS.sendTraceTag(40433734,338,50,"Receive Wac_UnloadApp. Timestamp: {0}",Date.now());w.AFrameworkApplication.Aa.d2.yMe(null,Sys.EventArgs.Empty)}hwg(){this.vbk();
this.wbk();null!=this.GBc&&Ji.a.instance.T0k(this.GBc);null!=this.cGd&&Ji.a.instance.U0k(this.cGd)}vbk(){this.x7&&this.RUb&&!this.Zhf&&(this.Zhf=!0,this.RUb>this.x7||(w.AFrameworkApplication.mj.setDw(10324,this.x7-this.RUb),Ji.a.instance.Ulh(this.RUb)))}wbk(){this.x7&&this.TUb&&!this.aif&&(this.aif=!0,this.TUb>this.x7||(w.AFrameworkApplication.mj.setDw(10325,this.x7-this.TUb),Ji.a.instance.y1k(this.TUb)))}I$k(){var a=Bd.a.ldg();if(a){var b=0;a=a.fetchStart;void 0!==a&&null!==a&&(b=a);0>=b||b>this.x7||
w.AFrameworkApplication.mj.setDw(11045,this.x7-b)}}create(){w.AFrameworkApplication.fng&&this.disable();this.DMa!==xA.a.S_b&&this.qCa(this.DMa);this.Ca.ra(G.a.sVi,ie.a.frame,Object(I.a)(this,this.xVi,"disposeInstance"),96);this.Iu(Qe.a.mWd);this.Iu(Qe.a.oWd);this.Iu(Qe.a.Dee);this.Iu(Qe.a.Eee);this.Iu(Qe.a.Mge);this.Iu(Qe.a.Oge);this.Iu(Qe.a.pUd);const a=Object(I.a)(this,this.kJj,"hostMessageHandler");this.t0a(Qe.a.mWd,a);this.t0a(Qe.a.oWd,a);this.t0a(Qe.a.Dee,a);this.t0a(Qe.a.Eee,a);this.t0a(Qe.a.Mge,
a);w.AFrameworkApplication.fa.ka("OneNoteEmbedUnloadIsEnabled")&&(this.Lwf(Qe.a.B$e),this.Lwf(Qe.a.F$e),this.t0a(Qe.a.B$e,a),this.t0a(Qe.a.F$e,a));if(w.AFrameworkApplication.fa.ka("PostMessageEmbedded")||w.AFrameworkApplication.fa.ka("IsJsApi")){this.Iu(Qe.a.Lzb);const b=Object(I.a)(this,this.oLl,"uiHostMessageHandler");w.AFrameworkApplication.fa.ka("SupportsAccessibilityLoop")&&(this.Iu(Qe.a.Ige),this.dC(Qe.a.Ige,b));this.dC(Qe.a.Lzb,b);w.AFrameworkApplication.fa.ka("MobileEmbedViewerIsEnabled")&&
(this.Iu(Qe.a.Kge),this.dC(Qe.a.Kge,b),this.Iu(Qe.a.Jge),this.dC(Qe.a.Jge,b),this.Iu(Qe.a.e$b),this.dC(Qe.a.e$b,b),this.Iu(Qe.a.Lge),this.dC(Qe.a.Lge,b));w.AFrameworkApplication.fa.ka("OneNotePageLevelConversationInTeamsIsEnabled")&&(this.Iu(Qe.a.Pge),this.dC(Qe.a.Pge,b))}w.AFrameworkApplication.fa.ka("IsJsApi")&&(this.Iu(Qe.a.Vcb),this.t0a(Qe.a.Vcb,a))}xVi(a,b,c){if(2!==c)return 32;yy.a.Ry(this);return 32}reportDocumentLoadedTime(a){this.$hf||(this.x7=a,this.I$k(),this.DMa!==xA.a.S_b&&this.sendMessage(Qe.a.Yki,
{["DocumentLoadedTime"]:a}),this.hwg(),this.$hf=!0)}}Object(m.a)(yA,"HostIntegrationMessenger",Qo.a,[918,332,107]);class zF{constructor(){this.Da=null}get name(){return"Common.App.Postmessengers"}init(){w.AFrameworkApplication.fa.ff(()=>{this.Phe(this.Da)})}Phe(a){w.AFrameworkApplication.PQ=a.resolve("Common.App.Postmessengers.HostIntegrationMessenger");w.AFrameworkApplication.fa.ka("HostActionExecutionIsEnabled")&&a.resolve("Common.App.HostActionExecutionManager")}dispose(){}Yb(a){this.Da=a;a.register(yA,
"Common.App.Postmessengers.HostIntegrationMessenger").as("Postmessage.IHostPostmessenger").ma().oa(()=>{w.AFrameworkApplication.fa.z4||ka.ULS.sendTraceTag(5886165,204,10,"HostIntegrationMessenger instantiated before full app settings ready");const b=w.AFrameworkApplication.Boa?w.AFrameworkApplication.Boa:xA.a.S_b;ka.ULS.sendTraceTag(536987587,204,50,"HostIntegrationMessenger instantiating");return new yA(window.parent,b,SP.a.instance,w.AFrameworkApplication.Ra)});a.register(wA,"Common.App.HostActionExecutionManager").ma().oa(()=>
{w.AFrameworkApplication.fa.z4||ka.ULS.sendTraceTag(41972612,204,10,"HostSupportedActionManager instantiated before full app settings ready");return new wA(w.AFrameworkApplication.fa,w.AFrameworkApplication.Ra,a.Ia("Postmessage.IHostPostmessenger"))})}}Object(m.a)(zF,"PostmessengersPackage",null,[2,3]);var zA=d(412),On=d(319),Rk=d(272),hg=d(209);class AA extends hg.a{constructor(){super();this.PersonaId=this.DisplayName=null;this.IsAnonymous=!1}get ControlType(){return 4}}Object(m.a)(AA,"PersonaButtonProps",
hg.a,[]);class AF{s3b(a,b){if(a&&!(1>a.length)&&b){var c=Object.assign(new Rk.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.dLi(a,c.ControlList);b.push(c)}}dLi(a,b){const c=Object.assign(new zA.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new On.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(b,c);b=Object.assign(new Rk.a,{Title:"",ControlList:[]});Array.add(c.Menu.MenuSectionList,
b);this.nNi(a,b.ControlList)}nNi(a,b){for(let c=0;c<a.length;c++){const f=Object.assign(new AA,{ExternalId:String.format("CoauthorPersona_{0}",c),Command:"336231556",DisplayName:a[c].userName,LabelText:a[c].userName,ImageBackColor:a[c].color,PersonaId:a[c].email,IsAnonymous:a[c].isAnonymous});Array.add(b,f)}}}Object(m.a)(AF,"PresenceContextMenuSectionBuilder",null,[1196]);var BA=d(359);class CA{constructor(a,b,c,f){this.wZ=this.Gn=this.nn=this.Df=this.kqa=null;this.xGc=a;this.D7h=f;this.xGc.rme&&
(this.nn=new dd.a(3,2,5E3,Object(I.a)(this,this.roi,"authenticationCheckTask"),2),w.AFrameworkApplication.Ae.Hb(this.nn),this.vb(b,c));this.xGc.cfi(()=>{this.mmc()});this.xGc.Oyf(()=>{this.nmc()})}get businessBar(){return this.Gn||(this.Gn=Ib.a.instance.qb("CommonUI.IBusinessBar"))}get $Ff(){return this.wZ||(this.wZ=Ib.a.instance.qb("CommonUI.IBusinessBarEntryFactory"))}vb(a,b){const c=w.AFrameworkApplication.Ra;c.ra(G.a.PDf,ie.a.frame,a,96);c.ra(G.a.QDf,ie.a.frame,b,96);c.ya(G.a.xIf,ie.a.frame,vf.ActionManager.Bv);
c.ya(G.a.yIf,ie.a.frame,vf.ActionManager.Bv);c.ya(G.a.zre,ie.a.frame,vf.ActionManager.Bv)}mmc(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);w.AFrameworkApplication.Ra.processAction(G.a.PDf,2)}nmc(){this.FEl();w.AFrameworkApplication.Ra.processAction(G.a.QDf,2)}roi(){this.xGc.authenticationCheck()}FEl(){this.Df&&(this.Df.hide(),this.Df.dispose(),this.Df=null);this.kqa&&this.businessBar&&(w.AFrameworkApplication.Yg||this.businessBar.removeEntry(this.kqa),this.kqa.dispose(),this.kqa=
null)}showDialog(a){yy.a.Ry(this.Df);this.Df=new Ai.StandardDialog;this.D7h||(this.Df.Ir=!1,this.Df.Ad=0);this.Df.Oe(1,CommonUIStrings.l_SignIn);this.Df.sP(CommonUIStrings.l_DefaultDialogTitle,a,Object(I.a)(this,this.I3,"dialogHandler"))}I3(a){1===a?(BA.a.rld(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),w.AFrameworkApplication.Ra.processAction(G.a.zre,2)):(this.Vul(),w.AFrameworkApplication.Ra.processAction(G.a.yIf,2))}Vul(){this.businessBar&&this.$Ff&&(this.kqa=
this.$Ff.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.kqa.closeable=!0,this.kqa.addButton(CommonUIStrings.l_SignIn,CA.oti,""),this.kqa.u3=Object(I.a)(this,this.pti,"businessBarEntryCloseHandler"),this.businessBar.ji(this.kqa,!1))}pti(){this.JUi();w.AFrameworkApplication.Ra.processAction(G.a.xIf,2)}JUi(){this.nn&&(w.AFrameworkApplication.Ae.Lg(this.nn),this.nn=null)}dispose(){this.nn=this.Df=this.kqa=null}static oti(){BA.a.rld();w.AFrameworkApplication.Ra.processAction(G.a.zre,
2)}}Object(m.a)(CA,"SignOutResponseUI",null,[107]);class Rr{get name(){return"Common.App.UI"}Yb(a){a.register(AF,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").ma()}init(){}dispose(){yy.a.Ry(Rr.zca);Rr.zca=null}static main(){n.a.instance.Ac(new Rr)}static $Mj(a,b,c){Rr.Hul()&&(Rr.zca=new CA(BA.a.instance,a,b,c))}static Hul(){return w.AFrameworkApplication.u5g&&!w.AFrameworkApplication.isEmbedded}}Rr.zca=null;Object(m.a)(Rr,"CommonAppUIPackage",
null,[2,3]);class DA{constructor(a){this.KBa=this.EBa=this.PBa=this.OBa=null;this.Dhf=this.Lef=this.Fhf=this.Elf=this.SP=this.eca=!1;this.ZMd=this.Wlf=null;this.Plf=0;this.Oa=this.Ulf=null;this.Uha=a;this.EG=3;this.Upb=!0}initialize(a,b,c){this.OBa=this.Bce(a,b);this.PBa=CommonUIStrings.l_SavingStatus;this.EBa=CommonUIStrings.l_ReadOnlyStatus;this.KBa=CommonUIStrings.l_ReviewModeStatus;this.Uha&&this.Uha.execute(f=>{f.bJc(Object(I.a)(this,this.exc,"updateToSavingStatus"))});this.SP=!0;this.Oa=c;this.Lef=
this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIcons",!1);return!0}Xpa(a,b){this.eca=a;this.EG=b;this.updateSaveStatusText(this.Upb)}updateSaveStatusText(a){!this.Upb&&a&&(this.Ulf=new Date);this.Upb=a;this.Dhf=!1;a=null;3===this.EG&&(a=this.Upb?this.OBa:this.PBa);this.$Ui(a)}Bce(a,b){return a?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):b&&b.length?String.format(CommonUIStrings.l_SavedToStatus,b):CommonUIStrings.l_SavedStatus}exc(){this.updateSaveStatusText(!1)}wlj(){switch(this.EG){case 1:return this.EBa;
case 2:return this.KBa;default:return null}}vlj(){if(3!==this.EG)switch(this.EG){case 1:return"ReadOnly";case 2:return"ReviewOnly";default:return null}return this.Dhf?"FailedToSave":this.Upb?"Saved":"Saving"}AVj(a){return this.Elf===this.eca&&this.Plf===this.EG&&this.Wlf===a}L3d(a){appChrome.getHeaderApi().then(b=>{b.updateDocumentTitleStatus(this.eca,a,this.wlj(),this.Ulf,this.Upb,this.Lef?b.getHeaderSaveStatusIconProps(this.vlj()):null);this.Fhf=!0;return null});this.ZMd=null}$Ui(a){this.SP&&tg.c()&&
!this.AVj(a)&&(!this.Fhf&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.L3d(a):Bd.a.yWe()?(this.ZMd&&ka.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.ZMd=window.requestIdleCallback(()=>{this.L3d(a)})):window.requestAnimationFrame(()=>{this.L3d(a)}),this.Elf=this.eca,this.Wlf=a,this.Plf=this.EG)}}Object(m.a)(DA,"ReactSaveStatusUIHandler",null,[1290]);class EA{constructor(a,b){this.PQ=
null;this.OBa=CommonUIStrings.l_SavedStatus;this.PBa=CommonUIStrings.l_SavingStatus;this.EBa=CommonUIStrings.l_ReadOnlyStatus;this.KBa=CommonUIStrings.l_ReviewModeStatus;this.fBa=b;this.Uha=a;this.EG=3;this.WPa=!0}kP(){this.Uha&&this.Uha.execute(a=>{a.bJc(Object(I.a)(this,this.exc,"updateToSavingStatus"))});this.fBa.execute(a=>{this.PQ=a})}Xpa(a,b){this.EG=b;3===b?this.updateSaveStatusText(this.WPa):2===b?this.e8e(this.KBa):this.e8e(this.EBa)}exc(){this.updateSaveStatusText(!1)}updateSaveStatusText(a){this.WPa=
a;this.e8e(this.WPa?this.OBa:this.PBa)}e8e(a){this.PQ&&this.PQ.sendMessage(Qe.a.mLl,this.LGi(a))}LGi(a){const b={};b.StatusText=a;return b}}Object(m.a)(EA,"SaveStatusPostMessageHandler",null,[1290]);var Em=d(265);class FA{constructor(a,b,c,f){this.KBa=this.EBa=this.PBa=this.OBa=null;this.u5a=0;this.ZP=this.LNd=this.B3a=this.XAd=this.lQd=null;this.mf=a;this.Mqa=b;this.Uha=c;this.kl=f;this.Hjf=!0;this.eca=!1;this.EG=3;this.WPa=!0}initialize(a,b){if(!this.mf)return!1;this.OBa=this.Bce(a,b);this.PBa=
CommonUIStrings.l_SavingStatus;this.EBa=CommonUIStrings.l_ReadOnlyStatus;this.KBa=CommonUIStrings.l_ReviewModeStatus;this.kP();return!0}Bce(a,b){return a?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):b&&b.length?String.format(CommonUIStrings.l_SavedToStatus,b):CommonUIStrings.l_SavedStatus}kP(){this.Mqa&&this.Mqa.execute(a=>{a.qhi(Object(I.a)(this,this.mQf,"createStatusAndModeElements"));a.Ygi(Object(I.a)(this,this.ewl,"showHideSaveStatusElement"));a.gHl&&this.mQf(null,
null)});this.Uha&&this.Uha.execute(a=>{a.bJc(Object(I.a)(this,this.exc,"updateToSavingStatus"))})}iAa(){this.ZP&&this.mf&&this.mf.Sxd(this.ZP)}ewl(a,b){this.Xpa("true"===b,this.EG)}Xpa(a,b){this.eca=a;this.EG=b;this.XAd&&(this.XAd.style.display=this.eca||3===this.EG||!this.lQd?"none":"");this.B3a&&(this.B3a.style.display=this.eca||3===this.EG?"none":"",this.B3a.innerText=1===this.EG?this.EBa:this.KBa,this.B3a.title=1===this.EG?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);
this.LNd&&(this.LNd.style.display=this.eca||1===this.EG||!this.lQd&&!this.B3a?"none":"");this.ZP&&(this.ZP.style.display=this.eca||1===this.EG?"none":"",this.updateSaveStatusText(this.WPa),this.ZP.title=CommonUIStrings.l_SaveStatusTooltip)}mQf(a,b){a=document.getElementById(Em.CuiHelper.lIj);b&&b.FUl||!a||""===this.OBa||""===this.PBa||""===this.EBa||""===this.KBa||(this.lQd=document.getElementById(Em.CuiHelper.AWd),this.XAd=Em.CuiHelper.eOc(a,"BreadcrumbAppModeDash","-"),this.B3a=Em.CuiHelper.eOc(a,
"BreadcrumbAppModeStatus",1===this.EG?this.EBa:this.KBa),this.qNh(this.B3a),this.LNd=Em.CuiHelper.eOc(a,"BreadcrumbSaveStatusDash","-"),this.ZP=Em.CuiHelper.eOc(a,"BreadcrumbSaveStatus",this.OBa),this.qNh(this.ZP),this.Xpa(this.eca,this.EG))}exc(){this.updateSaveStatusText(!1)}updateSaveStatusText(a){this.WPa=a;this.bQl(this.WPa?this.OBa:this.PBa)}bQl(a){!this.ZP||3!==this.EG&&2!==this.EG||(this.Hjf&&!this.WPa?(this.u5a=this.ZP.offsetWidth<this.u5a?this.u5a:this.ZP.offsetWidth,this.VMl(this.PBa),
this.Hjf=!1):this.ZP.innerText=a)}qNh(a){a.style.direction=this.kl?"rtl":"ltr";a.style.width="auto";a.style.textAlign=this.kl?"right":"left";a.style.display=this.eca?"none":"";a.setAttribute("Unselectable","on")}VMl(a){this.ZP&&(this.ZP.style.width="",this.ZP.innerText=a,this.u5a=this.ZP.offsetWidth<this.u5a?this.u5a:this.ZP.offsetWidth,a=af.a.rt(this.ZP),this.ZP.style.width=this.u5a-Ea.a.TM(a.paddingLeft)-Ea.a.TM(a.paddingRight)+1+"px")}}Object(m.a)(FA,"SaveStatusUIHandler",null,[1290]);class BF{constructor(){this.MNd=
this.EMd=this.lYb=this.Da=null}get name(){return"Common.App.SaveStatus"}Yb(a){this.Da=a;w.AFrameworkApplication.fa.ka("PostMessageEmbedded")&&w.AFrameworkApplication.NT?this.Da.register(EA,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ma().oa(()=>new EA(this.Da.Ia("Common.App.HostNotification.EditNotificationEventSource"),this.Da.Ia("Postmessage.IHostPostmessenger"))):w.AFrameworkApplication.Aa.ob.qsg||(w.AFrameworkApplication.Aa.ob.mO?this.Da.register(DA,
"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ma().oa(()=>new DA(this.Da.Ia("Common.App.HostNotification.EditNotificationEventSource"))):this.Da.register(FA,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ma().oa(()=>new FA(Md.EventHandlerManager.instance,this.Da.Ia("Common.App.Header.HeaderEventSource"),this.Da.Ia("Common.App.HostNotification.EditNotificationEventSource"),w.AFrameworkApplication.isRtl)))}init(){w.AFrameworkApplication.fa.ff(Object(I.a)(this,
this.en,"onFullAppSettingsReady"))}en(){const a=w.AFrameworkApplication.fa,b=!!w.AFrameworkApplication.Aa.ob&&4===w.AFrameworkApplication.Aa.ob.zk;if(a.ka("WordEditorAutoSaveImprovementIsEnabled")||a.ka("PptEditorSaveStatusInHeaderEnabled")||b&&a.ka("SimplifiedReactRibbonUxIsEnabled")||a.ka("ExcelSaveStatusInHeaderEnabled")||a.ka("VisioSaveStatusInHeaderEnabled"))w.AFrameworkApplication.fa.ka("PostMessageEmbedded")&&w.AFrameworkApplication.NT?(this.MNd=this.Da.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&
this.MNd.kP():w.AFrameworkApplication.Aa.ob.qsg||a.ka("PreventSaveStatusInitializationWithHiddenHeader")&&w.AFrameworkApplication.hideHeader||(w.AFrameworkApplication.Aa.ob.mO?(this.EMd=this.Da.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.EMd.initialize(a.ka("IsSkyDrive"),a.Ha("HostNameToIncludeInSavedStatus"),w.AFrameworkApplication.fa):(this.lYb=this.Da.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.lYb.initialize(a.ka("IsSkyDrive"),a.Ha("HostNameToIncludeInSavedStatus")))}dispose(){this.lYb&&
this.lYb.iAa()}}Object(m.a)(BF,"PackageManager",null,[2,3]);window.PPTCampaignsObj_FromAppPackage=[{CampaignId:"7BC32D60-19AD-41B5-A039-4408D47C5884",LauncherType:"customervoice",StartTimeUtc:"2020-01-01T00:00:00Z",EndTimeUtc:"2023-12-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:1,NominationScheme:{Type:0,PercentageNumerator:.97,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},
FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SuiteUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"SuiteUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_Suite_RatingQuestion",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},
Question:{Question:"nps_QuestionQuestion"},CVSurveyParams:{CustomerVoiceFormId:"OQWcQhU2qEGdoz_3ZmewCih_e1uFIbpMs9-LxFTE8VpUOTdPWE9TQlVSMzRRMklBVE5XQVowSUE3OC4u"}}}},{CampaignId:"281ff77f-ec20-4b5b-88dc-674ede3473ee",LauncherType:"customervoice",StartTimeUtc:"2018-09-04T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:1,NominationScheme:{Type:0,PercentageNumerator:22,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296E3},
CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_RatingQuestion_PowerPoint",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3",
"nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_QuestionQuestion"},CVSurveyParams:{CustomerVoiceFormId:"OQWcQhU2qEGdoz_3ZmewCpFge6Cl3sRFoOMTPf8V7pNUMFpIMk1RSVo3WDhFQ0tPM0JPQ0VZOFc0Ty4u"}}}},{CampaignId:"39c281be-953d-4788-8878-2361b1574fe6",StartTimeUtc:"2019-02-25T00:00:00Z",EndTimeUtc:"2025-12-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,
IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CoauthContentMerge",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"Another person is editing the file with you right now.",Question:"We have just 2 questions.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Please rate your experience working with others at the same time in PowerPoint Online.",RatingValuesAscending:["1 - Not satisfied",
"2","3","4","5 - Very satisfied"]},Question:{Question:"Please describe how we can make real-time collaboration better for you."}}}},{CampaignId:"092b8d95-cf3f-4172-a11b-f5bbc03077ac",LauncherType:"customervoice",StartTimeUtc:"2019-04-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:.97,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296E3},CooldownPeriod:{Type:0,
IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SuiteUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"SuiteUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_Suite_RatingQuestion",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4",
"nps_Rating_Values_5"]},Question:{Question:"nps_Suite_QuestionQuestion"},CVSurveyParams:{CustomerVoiceFormId:"OQWcQhU2qEGdoz_3ZmewCrqS6vMqN69DhDipYQ7GG0BUQkU0RkYxUFEzTEJINlNaR0RDUTNDMzZHUC4u"}}}},{CampaignId:"99e8783d-e51c-401f-843f-b59f8ef58754",StartTimeUtc:"2019-03-01T00:00:00Z",EndTimeUtc:"2020-09-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},
CooldownPeriod:{Type:0,IntervalSeconds:2419200},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"VersionHistoryExited",IsAggregate:!0,Count:1},{Type:0,Activity:"VersionHistoryCheckExited",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on Version History.",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How would you rate your experience with using Version History?",
RatingValuesAscending:["1 - Extremely negative","2 - Somewhat negative","3 - Neither negative nor positive","4 - Somewhat positive","5 - Extremely positive"]},Question:{Question:"Please tell us why you chose that answer."}}}},{CampaignId:"75fcdcee-a30b-4545-969e-1e24599c8ceb",StartTimeUtc:"2020-09-23T00:00:00Z",EndTimeUtc:"2021-10-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,
NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"VersionHistoryRestoreCoauthFailed",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"VHRestore_Title",Question:"VHRestore_PromptQuestion",YesLabel:"VHRestore_Sure",NoLabel:"VHRestore_NotNow"},Rating:{Question:"VHRestore_SurveyQuestion",RatingValuesAscending:["VHRestore_Answer_Options_1","VHRestore_Answer_Options_2",
"VHRestore_Answer_Options_3","VHRestore_Answer_Options_4"]},Question:{Question:"VHRestore_WhyQuestion"}}}},{CampaignId:"254748d4-1af8-4c34-ab56-303ae10e6719",StartTimeUtc:"2019-03-11T00:00:00Z",EndTimeUtc:"2022-08-26T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:5184E3},FallbackSurveyDurationSeconds:120},
SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"LinkedInWACUsage",IsAggregate:!0,Count:300},{Type:0,Activity:"LinkedInWACUsageTimeSatisfied",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"Hey LinkedIn, we need your help to make Office better!",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with PowerPoint Online?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Somewhat dissatisfied","3 - Neither satisfied nor dissatisfied",
"4 - Somewhat satisfied","5 - Extremely satisfied"]},Question:{Question:"Tell us why you gave this rating"}}}},{CampaignId:"278833a1-5538-4739-8fe7-9a7e23336414",StartTimeUtc:"2019-02-25T00:00:00Z",EndTimeUtc:"2025-12-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},
SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"TranscriptionUsed",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on live captions & subtitles.",Question:"It will only take a few seconds.",YesLabel:"AtMentionFS_YesLabel",NoLabel:"AtMentionFS_NoLabel"},Rating:{Question:"How satisfied were you and your audience with the live captions or subtitles experience?",RatingValuesAscending:["1 - Not satisfied","nps_Rating_Values_2","nps_Rating_Values_3",
"nps_Rating_Values_4","5 - Very satisfied"]},Question:{Question:"Please tell us what you liked or didn't like."}}}},{CampaignId:"b698805c-10fa-46d5-a06b-9a41620c5427",StartTimeUtc:"2019-08-13T00:00:00Z",EndTimeUtc:"2024-12-31T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},
SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CatchUpChangesFeedback",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"CatchUpFPS_Title",Question:"CatchUpFPS_Question",YesLabel:"CatchUpFPS_YesLabel",NoLabel:"CatchUpFPS_NoLabel"},Rating:{Question:"CatchUpFPS_RatingQuestion",RatingValuesAscending:["CatchUpFPS_RatingValue_1","CatchUpFPS_RatingValue_2","CatchUpFPS_RatingValue_3","CatchUpFPS_RatingValue_4","CatchUpFPS_RatingValue_5"]},Question:{Question:"CatchUpFPS_WhyQuestion"}}}},
{CampaignId:"ceef766d-7ae7-4f83-bf61-a2254bb05e45",StartTimeUtc:"2022-02-21T00:00:00Z",EndTimeUtc:"2022-08-21T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"PPTWebCommitNewCommentActivity",
IsAggregate:!0,Count:5}]},Content:{Prompt:{Title:"Please tell us about your experience using the Comments feature in PowerPoint",Question:"We have just two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the Comments feature in PowerPoint for the web?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Satisfied","5 - Extremely satisfied"]},Question:{Question:"Please tell us why you chose that rating."}}}},
{CampaignId:"fbff816d-e00a-4269-89eb-21ed37f0b20d",StartTimeUtc:"2020-06-08T00:00:00Z",EndTimeUtc:"2021-08-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:1,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:31536E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:0,Activity:"UsageForWebAsDefaultFileOpenTeams",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"TeamsOpen_GreetingQuestion",
Question:"TeamsOpen_PromptTitle",YesLabel:"TeamsOpen_GreetingAnswer_Sure",NoLabel:"TeamsOpen_GreetingAnswer_NotNow"},Rating:{Question:"TeamsOpen_RatingQuestion_PowerPoint",RatingValuesAscending:["TeamsOpen_Rating_Browser","TeamsOpen_Rating_Teams"]},Question:{Question:"TeamsOpen_PromptQuestion"}}}},{CampaignId:"e7155ff8-0e35-49c8-ab37-4e230d9548e6",StartTimeUtc:"2020-10-05T00:00:00Z",EndTimeUtc:"2021-10-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:30,
PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ConvertWordToPresentationActivity",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love to get some quick feedback from you",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the experience of converting your document to a presentation?",
RatingValuesAscending:["1 - Not satisfied enough","2","3","4","5 - Very satisfied"]},Question:{Question:"What else would you like to share? We'll use your feedback to help improve the experience."}}}},{CampaignId:"826063c4-f637-4317-9dd4-ec099224b8cd",StartTimeUtc:"2021-04-01T00:00:00Z",EndTimeUtc:"2021-10-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,
IntervalSeconds:604800},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AgendaToPresentationActivity",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love to get some quick feedback from you",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the experience of adding slides automatically?",RatingValuesAscending:["1 - Not satisfied enough","2","3","4","5 - Very satisfied"]},
Question:{Question:"What else would you like to share? We'll use your feedback to help improve the experience."}}}},{CampaignId:"f4aa2c06-b017-4702-a6db-83036ab55495",StartTimeUtc:"2021-04-23T00:00:00Z",EndTimeUtc:"2021-10-23T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},
SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"PPTWebCommitTaskActivity",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"Please tell us about your experience using Tasks in PowerPoint",Question:"We have just two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with Tasks in PowerPoint for Web?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Satisfied","5 - Extremely satisfied"]},
Question:{Question:"Please tell us why you chose that rating."}}}},{CampaignId:"0fd1d222-ab1e-49a2-9c18-3cba5d97c7e6",StartTimeUtc:"2021-08-18T18:30:00Z",EndTimeUtc:"2025-06-30T18:30:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:2592E3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"ModernFontPickerExperience",
IsAggregate:!0,Count:4},Content:{Prompt:{Title:"FontPicker_FloodgatePromptTitle",Question:"FontPicker_FloodgatePromptQuestion",YesLabel:"FontPicker_FloodgatePromptYesLabel",NoLabel:"FontPicker_FloodgatePromptNoLabel"},Rating:{Question:"FontPicker_FloodgateRatingQuestion",RatingValuesAscending:["FontPicker_FloodgateRating1","FontPicker_FloodgateRating2","FontPicker_FloodgateRating3","FontPicker_FloodgateRating4","FontPicker_FloodgateRating5"]},Question:{Question:"FontPicker_FloodgateCommentQuestion"}}}},
{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",EndTimeUtc:"2028-06-03T00:00:00Z",GovernedChannelType:0,PrimaryPriority:2,Scope:{Languages:[{Type:0,Value:"cs-CZ"},{Type:0,Value:"de-DE"},{Type:0,Value:"en-GB"},{Type:0,Value:"es-ES"},{Type:0,Value:"fr-FR"},{Type:0,Value:"ja-JP"},{Type:0,Value:"nl-NL"},{Type:0,Value:"pl-PL"},{Type:0,Value:"ru-RU"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:1,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},
CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNLQS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",Question:"FloodgateNLQSPromptSubtitle",YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1",
"FloodgateNLQSRating2","FloodgateNLQSRating3","FloodgateNLQSRating4","FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",EndTimeUtc:"2028-06-03T00:00:00Z",GovernedChannelType:0,PrimaryPriority:2,Scope:{Languages:[{Type:0,Value:"ar-SA"},{Type:0,Value:"da-DK"},{Type:0,Value:"es-MX"},{Type:0,Value:"fi-FL"},{Type:0,Value:"he-IL"},{Type:0,Value:"hr-HR"},{Type:0,Value:"it-IT"},{Type:0,Value:"ko-KR"},
{Type:0,Value:"nb-NO"},{Type:0,Value:"pt-BR"},{Type:0,Value:"pt-PT"},{Type:0,Value:"sv-SE"},{Type:0,Value:"tr-TR"},{Type:0,Value:"zh-CN"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNLQS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",
IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",Question:"FloodgateNLQSPromptSubtitle",YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1","FloodgateNLQSRating2","FloodgateNLQSRating3","FloodgateNLQSRating4","FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",
EndTimeUtc:"2028-06-03T00:00:00Z",GovernedChannelType:0,PrimaryPriority:2,Scope:{Languages:[{Type:0,Value:"af-ZA"},{Type:0,Value:"am-ET"},{Type:0,Value:"as-IN"},{Type:0,Value:"az-Latn-AZ"},{Type:0,Value:"be-BY"},{Type:0,Value:"bg-BG"},{Type:0,Value:"bn-BD"},{Type:0,Value:"bn-IN"},{Type:0,Value:"bs-Latn-BA"},{Type:0,Value:"ca-ES"},{Type:0,Value:"chr-Cher-US"},{Type:0,Value:"cy-GB"},{Type:0,Value:"el-GR"},{Type:0,Value:"et-EE"},{Type:0,Value:"eu-ES"},{Type:0,Value:"fa-IR"},{Type:0,Value:"fil-PH"},{Type:0,
Value:"fr-CA"},{Type:0,Value:"ga-IE"},{Type:0,Value:"gd-GB"},{Type:0,Value:"gl-ES"},{Type:0,Value:"gu-IN"},{Type:0,Value:"ha-Latn-NG"},{Type:0,Value:"he-IN"},{Type:0,Value:"hu-HU"},{Type:0,Value:"hy-AM"},{Type:0,Value:"id-ID"},{Type:0,Value:"ig-NG"},{Type:0,Value:"is-IS"},{Type:0,Value:"ka-GE"},{Type:0,Value:"kk-KZ"},{Type:0,Value:"km-KH"},{Type:0,Value:"kn-IN"},{Type:0,Value:"kok-IN"},{Type:0,Value:"ku-Arab-IQ"},{Type:0,Value:"ky-KG"},{Type:0,Value:"lb-LU"},{Type:0,Value:"lo-LA"},{Type:0,Value:"lt-LT"},
{Type:0,Value:"lv-LV"},{Type:0,Value:"mi-NZ"},{Type:0,Value:"mk-MK"},{Type:0,Value:"ml-IN"},{Type:0,Value:"mn-MN"},{Type:0,Value:"mr-IN"},{Type:0,Value:"ms-MY"},{Type:0,Value:"mt-MT"},{Type:0,Value:"ne-NP"},{Type:0,Value:"nn-NO"},{Type:0,Value:"nso-ZA"},{Type:0,Value:"mso-ZA"},{Type:0,Value:"or-IN"},{Type:0,Value:"pa-IN"},{Type:0,Value:"prs-AF"},{Type:0,Value:"ps-AF"},{Type:0,Value:"quc-Latn-GT"},{Type:0,Value:"quz-PE"},{Type:0,Value:"ro-RO"},{Type:0,Value:"rw-RW"},{Type:0,Value:"sd-Arab-PK"},{Type:0,
Value:"si-LK"},{Type:0,Value:"sk-SK"},{Type:0,Value:"sl-SL"},{Type:0,Value:"sq-AL"},{Type:0,Value:"sr-Cyrl-BA"},{Type:0,Value:"sr-Cyrl-RS"},{Type:0,Value:"sr-Latn-RS"},{Type:0,Value:"sw-KE"},{Type:0,Value:"ta-IN"},{Type:0,Value:"te-IN"},{Type:0,Value:"tg-Cyrl-TJ"},{Type:0,Value:"th-TH"},{Type:0,Value:"ti-ET"},{Type:0,Value:"tk-TM"},{Type:0,Value:"tn-ZA"},{Type:0,Value:"tt-RU"},{Type:0,Value:"ug-CN"},{Type:0,Value:"uk-UA"},{Type:0,Value:"ur-PK"},{Type:0,Value:"uz-Latn-UZ"},{Type:0,Value:"vi-VN"},{Type:0,
Value:"wo-SN"},{Type:0,Value:"xh-ZA"},{Type:0,Value:"yo-NG"},{Type:0,Value:"zh-TW"},{Type:0,Value:"zu-ZA"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:5184E3},CooldownPeriod:{Type:0,IntervalSeconds:15552E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNLQS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",IsAggregate:!1,Count:1}]},
Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",Question:"FloodgateNLQSPromptSubtitle",YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1","FloodgateNLQSRating2","FloodgateNLQSRating3","FloodgateNLQSRating4","FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},{CampaignId:"c551d75c-10b1-4de2-83cc-cce22d7c06bd",LauncherType:"coachingux",StartTimeUtc:"2021-08-15T00:00:00Z",
EndTimeUtc:null,GovernedChannelType:3,Tags:["FirstRunExperienceV2"],PrimaryPriority:5,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:22,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowFirstRunExperienceUIV2",
Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{itemCount:3,surfaceType:"sequence",preFetchDelay:500,preventAutoDismiss:!0,backgroundColor:"#b7472a",buttonHoverColor:"#a92b1a",closeButtonAriaLabel:"Close",position:"left",anchorHint:5,surfaceType1:"teaching",anchorElementSelectors1:"#BreadcrumbSaveStatus #documentTitle #documentTitleContainer #WACRibbon-QATRowCenter #BreadcrumbSaveStatusDash #ResponsiveCenterRegion #AppHeaderPanel div[role='toolbar'] div[class*='cui-topBar1-transistionalHeaderUI'] #o365header #O365_NavHeader".split(" "),
title1:"Never lose your work",description1:"Your file is automatically saved online. Just click the title to rename or change the save location.",illustrationImage1:"https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE4yjj0",primaryButtonText1:"Next",delayLoad1:1E3,retryTimes1:3,retryInterval1:500,surfaceType2:"teaching",anchorElementSelectors2:["button[data-unique-id='Share']","button[aria-label='Share']"],title2:"Share and collaborate",description2:"Share your presentation so others can leave comments and feedback, even if they don't have Office themselves.",
illustrationImage2:"https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE4yrdA",primaryButtonText2:"Next",surfaceType3:"teaching",anchorElementSelectors3:["button[data-unique-id='Present']","button[aria-label='Present']"],title3:"Start presenting",description3:"When you're ready, click Present to start your slideshow.",illustrationImage3:"https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE4ytEj",primaryButtonText3:"Got it"}}}},{CampaignId:"7f5167e4-54e6-4353-a9d7-686741f379b7",LauncherType:"coachingux",
StartTimeUtc:"2022-01-20T00:00:00Z",EndTimeUtc:null,Tags:["ShowTeachingUIForAddinTab"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},SurveyTemplate:{Type:22,MaxLaunches:25,
ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForAddinTab",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",telemetryEventName:"8bf7d424",position:"Left",hasCoachMark:"False",userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[lpp-id='latestAddin']\"]",title:"New add-in from your admin\u200b",description:"An add-in was installed to add new capabilities and improve your experience with Office.",primaryButtonText:"Show add-in",
primaryButtonAction:"event:LaunchAddinTaskpane",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissCallout",closeButtonAction:"event:CloseCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"d7f1cbbb-3631-4cae-bc2d-177774aa1190",LauncherType:"coachingux",StartTimeUtc:"2022-01-20T00:00:00Z",EndTimeUtc:null,Tags:["ShowTeachingUIForAddinButton"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,
Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},SurveyTemplate:{Type:22,MaxLaunches:25,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForAddinButton",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",telemetryEventName:"8bf7d424",position:"Left",hasCoachMark:"False",
userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[lpp-id='latestAddin']\"]",title:"New add-in from your admin",description:"An add-in was installed to add new capabilities and improve your experience with Office.",primaryButtonText:"Try it",primaryButtonAction:"event:LaunchAddinTaskpane",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissCallout",closeButtonAction:"event:CloseCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"cbb7eaa0-6e95-422d-9647-2be7d2737d4a",
LauncherType:"coachingux",StartTimeUtc:"2022-01-20T08:00:00Z",EndTimeUtc:null,Tags:["ShowTeachingUIForContentAddin"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},
SurveyTemplate:{Type:22,MaxLaunches:25,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForContentAddin",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",telemetryEventName:"8bf7d424",position:"Left",hasCoachMark:"False",userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[data-unique-id='Ribbon-InsertAppsForOffice']\", \"button[data-unique-id='Ribbon-InsertAddIns']\", \"button[data-unique-id='Overflow-RibbonOverflowMenu-overflow']\"]",
title:"New add-in from your admin",description:"An add-in was installed to add new capabilities and improve your experience with Office.",primaryButtonText:"Try it",primaryButtonAction:"event:LaunchContentAddin",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissCallout",closeButtonAction:"event:CloseCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"974882c6-f67e-47be-9ba4-4db5c2374610",StartTimeUtc:"2022-04-01T00:00:00Z",EndTimeUtc:"2023-06-01T00:00:00Z",GovernedChannelType:0,
PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"MultipleGuestsCoauthoring",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"GuestCoauthoring_FloodgatePromptTitle",Question:"GuestCoauthoring_FloodgatePromptQuestion",YesLabel:"GuestCoauthoring_FloodgateYesLabel",
NoLabel:"GuestCoauthoring_FloodgateNoLabel"},Rating:{Question:"GuestCoauthoring_FloodgateQuestion",RatingValuesAscending:["GuestCoauthoring_FloodgateRatingValue_1","GuestCoauthoring_FloodgateRatingValue_2","GuestCoauthoring_FloodgateRatingValue_3","GuestCoauthoring_FloodgateRatingValue_4","GuestCoauthoring_FloodgateRatingValue_5"]},Question:{Question:"GuestCoauthoring_FloodgateRatingQuestion"}}}},{CampaignId:"21c77b4d-1446-4cfe-8881-fa67502a0f14",StartTimeUtc:"2022-05-04T00:00:00Z",EndTimeUtc:"2023-1-31T00:00:00Z",
GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"CollabCornerSurveyLogDownloadACopyCommandActivity",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"CollabCorner_Survey_DownloadCopies_Prompt_Line_1",Question:"CollabCorner_Survey_DownloadCopies_Prompt_Line_2",YesLabel:"CollabCorner_Survey_DownloadCopies_Prompt_YesLabel",
NoLabel:"CollabCorner_Survey_DownloadCopies_Prompt_NoLabel"},Rating:{Question:"CollabCorner_Survey_DownloadCopies_Rating_Question",RatingValuesAscending:["CollabCorner_Survey_DownloadCopies_Rating_Scale_1","CollabCorner_Survey_DownloadCopies_Rating_Scale_2","CollabCorner_Survey_DownloadCopies_Rating_Scale_3","CollabCorner_Survey_DownloadCopies_Rating_Scale_4","CollabCorner_Survey_DownloadCopies_Rating_Scale_5"]},Question:{Question:"CollabCorner_Survey_DownloadCopies_Comment_Question"}}}},{CampaignId:"bf20f28c-af0a-4d43-a87b-239b0419c65f",
StartTimeUtc:"2022-09-01T00:00:00Z",EndTimeUtc:"2023-06-30T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:5,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:2592E3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SimplicityEaseOfUseSurvey",IsAggregate:!0,Count:360},{Type:0,Activity:"SimplicityEaseOfUseSurveyTimeSatisfied",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"EaseOfUse_Floodgate_Prompt_Line1",
Question:"EaseOfUse_Floodgate_Prompt_Line2",YesLabel:"EaseOfUse_Floodgate_Prompt_Affirmative_Answer",NoLabel:"EaseOfUse_Floodgate_Prompt_Negative_Answer"},Rating:{Question:"EaseOfUse_Floodgate_Rating_Question",RatingValuesAscending:["EaseOfUse_Floodgate_Rating_Scale_1","EaseOfUse_Floodgate_Rating_Scale_2","EaseOfUse_Floodgate_Rating_Scale_3","EaseOfUse_Floodgate_Rating_Scale_4","EaseOfUse_Floodgate_Rating_Scale_5"]},Question:{Question:"EaseOfUse_Floodgate_Comment_Question"}}}},{CampaignId:"6e859e5f-99be-48cd-9a9a-da52d6ff7203",
StartTimeUtc:"2022-09-19T00:00:00Z",EndTimeUtc:"2023-05-01T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:1209600}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Fluent2StyleEnabledFPS",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"Fluent2Survey_Title",Question:"Fluent2Survey_Question",YesLabel:"Fluent2Survey_YesLabel",
NoLabel:"Fluent2Survey_NoLabel"},Rating:{Question:"Fluent2Survey_RatingQuestion",RatingValuesAscending:["Fluent2Survey_RatingValue_1","Fluent2Survey_RatingValue_2","Fluent2Survey_RatingValue_3","Fluent2Survey_RatingValue_4","Fluent2Survey_RatingValue_5"]},Question:{Question:"Fluent2Survey_WhyQuestion"}}}},{CampaignId:"e9434f43-d475-4b79-8213-88636e007433",StartTimeUtc:"2022-09-19T00:00:00Z",EndTimeUtc:"2023-05-01T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,
PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:1209600}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Fluent2StyleOptOutFPS",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"Fluent2OptOutSurvey_Title",Question:"Fluent2OptOutSurvey_Question",YesLabel:"Fluent2OptOutSurvey_YesLabel",NoLabel:"Fluent2OptOutSurvey_NoLabel"},Rating:{Question:"Fluent2OptOutSurvey_RatingQuestion",RatingValuesAscending:["Fluent2OptOutSurvey_RatingValue_1",
"Fluent2OptOutSurvey_RatingValue_2"]},Question:{Question:"Fluent2OptOutSurvey_WhyQuestion"}}}},{CampaignId:"26b1466b-2ac8-4d6f-8ee0-cd06c7594ce5",StartTimeUtc:"2022-09-01T00:00:00Z",EndTimeUtc:"2024-12-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296E3},CooldownPeriod:{Type:0,IntervalSeconds:2592E3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"AddPenStrokePPTO",
IsAggregate:!0,Count:4},Content:{Prompt:{Title:"PenInkSurvey_Prompt",Question:"PenInkSurvey_PromptQuestion",YesLabel:"PenInkSurvey_Prompt_Sure",NoLabel:"PenInkSurvey_Prompt_NoNow"},Rating:{Question:"PenInkSurvey_RatingQuestion",RatingValuesAscending:["PenInkSurvey_QuestionChoice_5","PenInkSurvey_QuestionChoice_4","PenInkSurvey_QuestionChoice_3","PenInkSurvey_QuestionChoice_2","PenInkSurvey_QuestionChoice_1"]},Question:{Question:"PenInkSurvey_WhyQuestion"}}}},{CampaignId:"c855ff69-ff13-48f9-83b8-e76d1b65ee6a",
StartTimeUtc:"2023-01-01T00:00:00Z",EndTimeUtc:"2024-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"InsertPicture",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"PPTO_Picture_FloodgatePromptTitle",
Question:"PPTO_Picture_FloodgatePromptQuestion",YesLabel:"PPTO_Picture_FloodgatePrompt_YesLabel",NoLabel:"PPTO_Picture_FloodgatePrompt_NoLabel"},Rating:{Question:"PPTO_Picture_FloodgateRatingQuestion",RatingValuesAscending:["PPTO_Picture_FloodgateRating_1","PPTO_Picture_FloodgateRating_2","PPTO_Picture_FloodgateRating_3","PPTO_Picture_FloodgateRating_4","PPTO_Picture_FloodgateRating_5"]},Question:{Question:"PPTO_Picture_FloodgateWhyQuestion"}}}}];var UP=d(678);class CF{S3f(){return null}Lbj(){return De.c(window.PPTCampaignsObj_FromAppPackage)}cee(a){return UP.a.cee(a,
"PPTUserInitiatedSurveysDictionary_FromAppPackage")}}Object(m.a)(CF,"PowerPointFeedbackAppData",null,[1204]);class GA{constructor(){this.Da=null}Yb(a){this.Da=a;a.register(1204,"Common.App.IAppSpecificFeedbackData").ma().oa(()=>new CF)}init(){this.Da.qb("Common.App.IAppSpecificFeedbackData")}dispose(){}get name(){return"PPTWebEditor.Feedback"}static main(){n.a.instance.Ac(new GA)}}Object(m.a)(GA,"PPTWebEditorFeedbackPackage",null,[2,3]);class HA{get name(){return"Box4.ListEditors"}Yb(){}init(){}dispose(){}static main(){n.a.instance.Ac(new HA)}}
Object(m.a)(HA,"Box4ListEditorsPackage",null,[2,3]);var Bj=d(141),uk=d(126);const IA=a=>{a=document.createElement(a);a.setAttribute("unselectable","on");return a};class DF{constructor(a){this.eRd=this.KFd=!1;this.$Na=null;this.vcf=!1;this.h7=null;this.dca=!1;this.u5h=a;ja.a.instance.rb(oa.a.mouseDown,this.p7b(),Object(I.a)(this,this.WBk,"onContextualUIMouseDown"));(a=Ib.a.instance.Ia("Common.IActionContextProvider"))&&a.execute(b=>{this.h7=b});w.AFrameworkApplication.fa.ka("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&
w.AFrameworkApplication.Aa.ob.mO?Pd.a.get_instance().Mj(16,()=>{this.hg?this.initializeContextualUI(this.p7b()):Pd.a.get_instance().Mj(7,()=>{this.initializeContextualUI(this.p7b())})}):Pd.a.get_instance().Mj(7,()=>{this.initializeContextualUI(this.p7b())})}get Sua(){return this.dca}get hg(){return w.AFrameworkApplication.fa.ka("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&w.AFrameworkApplication.Aa.ob.mO?Pd.a.get_instance().isCompleted(16)&&Pd.a.get_instance().isCompleted(7):Pd.a.get_instance().isCompleted(7)}Uwi(){if(this.vcf)return!0;
try{return Promise.resolve(null),this.vcf=!0}catch(a){return!1}}w8e(a){if(!this.hg||this.eRd)return this.Jse("Unable to launch contextual ui because ribbon hasn't loaded yet"),!0;if(!this.Uwi())return this.Jse("Unable to launch contextual ui because promise.resolve is not defined"),!0;if(w.AFrameworkApplication.zQc)return this.Jse("Unable to launch contextual ui because the feature to show contextual ui is disabled"),!0;this.eRd=!0;let b=G.a.ve;switch(a){case 1:b=G.a.showContextMenu;break;case 0:b=
G.a.showFloatie;break;case 2:b=G.a.Ytd}window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.eRd=!1;wn.c(b)},0)});return!1}kdg(a){return Bj.UISurfaces.KEa().then(b=>{if(appChrome.api.isSmallDevice()&&b.getBlockedSmallScreenFloatieGroupList){b=b.getBlockedSmallScreenFloatieGroupList();const c=[];for(const f of a)Array.contains(b,f)||c.push(f);return c}return a})}showFloatie(a,b,c,f=null){this.w8e(0)||this.kdg(b).then(l=>{if(0>=l.length)return null;this.m0e(l).then(()=>{const y={};y.target=
a;Bj.UISurfaces.KEa().then(H=>{appChrome.api.dispatch(H.showFloatie(y,c,void 0,this.mbe(),f));this.dca=!0;w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogFloatieMenuContextIsEnabled",!1)&&w.AFrameworkApplication.Ra&&w.AFrameworkApplication.Ra.processAction(G.a.sak,2);return null})});return null})}showContextMenu(a,b,c=null,f=null){this.w8e(1)||this.QBh(a,b,c,f)}QBh(a,b,c=null,f=null){this.m0e(null).then(()=>{const l={};l.target=a;f&&(l.directionalHint=f);Bj.UISurfaces.KEa().then(y=>
{appChrome.api.dispatch(y.showContextMenu(l,b,c,void 0,this.mbe()));return null})})}qza(a,b,c){this.w8e(2)||this.kdg(b).then(f=>{0>=f.length?this.QBh(a,c,null):this.m0e(f).then(()=>{const l={};l.target=a;const y={};y.target=a;Bj.UISurfaces.KEa().then(H=>{appChrome.api.dispatch(H.showContextualUI(l,y,c,void 0,null,this.mbe()));this.dca=!0;return null})});return null})}Jse(a){ka.ULS.sendTraceTag(561394519,340,15,a)}I3d(){this.hg&&Bj.UISurfaces.isLoaded()&&Bj.UISurfaces.KEa().then(a=>{appChrome.api.dispatch(a.hideContextMenu());
return null})}lE(){this.hg&&Bj.UISurfaces.isLoaded()&&Bj.UISurfaces.KEa().then(a=>{this.dca=!1;appChrome.api.dispatch(a.hideFloatie());return null})}v4b(){this.hg&&Bj.UISurfaces.isLoaded()&&Bj.UISurfaces.KEa().then(a=>{appChrome.api.dispatch(a.hideContextualUI());this.dca=!1;return null})}initializeContextualUI(a){return Bj.UISurfaces.KEa().then(b=>{this.KFd||(b.initializeContextualUI(a),this.KFd=!0);return null})}m0e(a){if(!this.KFd)return this.initializeContextualUI(this.p7b()).then(()=>{this.setActiveFloatieGroups(a);
return null});this.setActiveFloatieGroups(a);return Promise.resolve(null)}setActiveFloatieGroups(a){if(a&&a.length){var b=[];b.push(appChrome.actions.setActiveFloatieGroups(a));appChrome.api.dispatch(b);var c=[];Bj.UISurfaces.KEa().then(f=>{c.push.apply(c,this.u5h.CLb.GXc(f.selectors.getFloatieOnlyControlsMap(),9));0<c.length&&appChrome.api.dispatch(c);return null})}}p7b(){if(this.$Na)return this.$Na;this.$Na=IA("div");this.$Na.id="ReactContextualUIDiv";this.$Na.style.position="absolute";this.$Na.style.zIndex=
"1001";document.body.insertBefore(this.$Na,document.body.firstChild);return this.$Na}WBk(a){a.mc&&a.mc.target&&"input"===a.mc.target.tagName.toLowerCase()&&v.FocusManager.instance().fC("ribbon");return!1}mbe(){return this.h7?this.h7.contentType:"Unknown"}}Object(m.a)(DF,"ReactContextualUILauncher",null,[1197]);var sj=d(131);class JA{constructor(a){this.VXb=a}create(a,b){const c=new Sys.StringBuilder;this.w3b(c,a,b);this.Q0d(c,a);return c.toString()}ht(a,b){const c=[];this.v1d(c,a,b);this.R0d(c,a);
return c}w3b(a,b,c){switch(b.errorType){case 0:a.append(this.VXb.build());break;case 1:case 2:a.append(this.IWd(b,c))}}v1d(a,b,c){switch(b.errorType){case 0:a.push(this.VXb.GFf());break;case 1:case 2:a.push(this.Bri(b,c))}}Q0d(a,b){N.a.instance.ga(92)||(a.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),a.append(sj.a("btnIgrnoreSpellingError",(2===b.errorType?C.a.Uxd:C.a.kla).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,null)),a.append("</Controls></MenuSection>"))}R0d(a,
b){if(!N.a.instance.ga(92)){var c=Object.assign(new Rk.a,{ControlList:[]});b=2===b.errorType?"UnknownSpellingError":"IgnoreSpellingError";Array.add(c.ControlList,Object.assign(new hg.a,{ExternalId:b}));a.push(c)}}IWd(a,b){a=this.f$i(a.suggestions,b);return 0<a.length?sj.e("msUnknownWord",sj.c(null,a),"Menu16"):sj.e("msUnknownWord",sj.c(null,[sj.a("btnNoSuggestions","3587447601",Box4Intl.Box4Strings.l_NoSuggestions,null)]),"Menu16")}f$i(a,b){const c=[];if(a){const f=Math.min(b.length,a.length);for(let l=
0;l<f;++l)a[l]&&c.push(sj.a("btnCorrectWord"+l,b[l].toString(),a[l]))}return c}Bri(a,b){const c=Object.assign(new Rk.a,{Id:"Suggestions",ControlList:[]});this.e$i(a.suggestions,b,c.ControlList);0>=c.ControlList.length&&(a=Object.assign(new hg.a,{ExternalId:"NoSuggestions"}),Array.add(c.ControlList,a));return c}e$i(a,b,c){if(a){const f=Math.min(b.length,a.length);for(let l=0;l<f;++l){if(!a[l])continue;const y=Object.assign(new hg.a,{ExternalId:"btnCorrectWord"+l,Command:b[l].toString(),LabelText:a[l]});
Array.add(c,y)}}}}Object(m.a)(JA,"DefaultProofingContextMenuCreator",null,[]);class KA{constructor(a,b){this.Ydf=a;this.rff=b;this.gQa=[C.a.Pza,C.a.Qza,C.a.Rza,C.a.BMa,C.a.CMa]}create(a,b){return b?Object(Wa.a)(To.a,b)?this.rff.create(a,b,this.gQa):this.Ydf.create(b,this.gQa):""}s3b(a,b){return b?Object(Wa.a)(To.a,b)?this.rff.ht(a,b,this.gQa):this.Ydf.ht(b,this.gQa):null}}Object(m.a)(KA,"ProofingContextMenuSectionFactory",null,[1222]);class EF{build(){const a=[sj.a("btnDeleteRepeatedWord","2023591105",
Box4Intl.Box4Strings.l_DeleteRepeatedWord,null)];return sj.e("msRepeatedWord",sj.c(null,a),"Menu16")}GFf(){const a=Object.assign(new Rk.a,{ControlList:[]}),b=Object.assign(new hg.a,{ExternalId:"DeleteRepeatedWord"});Array.add(a.ControlList,b);return a}}Object(m.a)(EF,"ProofingRepeatedWordSectionBuilder",null,[1221]);var LA=d(1151);class Us{constructor(a,b){this.Y3a=a;this.Tm=b}get isVisible(){return this.Y3a.Sua}get controls(){return null}lE(){this.Y3a.lE();return!0}Q1e(a,b){this.Y3a.showFloatie(Object.assign(new LA.a,
{x:a.x,y:a.y}),this.T6b(b),b,null)}g7f(){return new Sys.UI.Bounds(0,0,0,0)}bta(){return this.lE()}T6b(){return[]}}Object(m.a)(Us,"ReactFloatie",null,[316,317]);class FF{constructor(a){this.Nzc=null;this.Y3a=a}dispose(){}bta(){this.Y3a.v4b();return!0}showContextMenu(a,b){this.B6(a,b.clientPoint,b.ng)}B6(a,b,c){this.Xtd(a,new Sys.UI.Bounds(b.x,b.y,0,0),c);ka.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",a)}Xtd(a,b,c,f=null){this.Nzc?this.Y3a.qza(Object.assign(new LA.a,{x:b.x,
y:b.y}),this.Nzc.T6b(c),c):this.Y3a.showContextMenu(Object.assign(new LA.a,{x:b.x,y:b.y}),c,void 0,f);this.Nzc=null}Ytd(a,b,c,f){this.Nzc=Object(qa.a)(Us,c);f.gba(a,b);return!0}}Object(m.a)(FF,"ReactContextMenuController",null,[1198,107]);var Sr=d(445);class zy{static get sg(){return bi.a.VC(zy.Fo,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,
Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)}}zy.Fo="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceTextAsYouType' >{1}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='\"\"' class='WACDialogLabel' for='CapitalizeFirstLetterOfSentences' >{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceOrdianalsWithSuperscript' >{5}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceHyphensWithDash' >{6}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceFractionsWithFractionCharacter' >{7}</label> </td> </tr> </table> </div>";
Object(m.a)(zy,"AutoCorrectOptionsDialogHTML",null,[]);class Ay{static get sg(){return bi.a.VC(Ay.Fo,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,
Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)}}Ay.Fo="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceTextAsYouType' >{1}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='\"\"' class='WACDialogLabel' for='CapitalizeFirstLetterOfSentences' >{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceOrdianalsWithSuperscript' >{5}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceHyphensWithDash' >{6}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceFractionsWithFractionCharacter' >{7}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceQuoteWithSmartQuote' >{8}</label> </td> </tr> </table> </div>";
Object(m.a)(Ay,"AutoCorrectOptionsDialogHTML2",null,[]);class GF extends bi.a{constructor(a,b){super();this.rS=a;this.Y2=b;this.kg="AutoCorrectOptionsDialog"}euc(){ka.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens.");this.sg=this.Y2?Ay.sg:zy.sg;const a={};a.ReplaceTextAsYouType=this.rS.kkb;a.CapitalizeFirstLetterOfSentences=this.rS.WLc;a.ReplaceOrdianalsWithSuperscript=this.rS.wpd;a.ReplaceHyphensWithDash=this.rS.lrc;a.ReplaceFractionsWithFractionCharacter=this.rS.upd;this.Y2&&
(a.ReplaceQuoteWithSmartQuote=this.rS.fWe);this.pj(Box4Intl.Box4Strings.l_AutoCorrectOptions,Object(I.a)(this,this.kjl,"setAutoCorrectOptionsHandler"),a)}kjl(a,b){N.a.instance.ga(70)&&(1!==a?ka.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes."):b.ReplaceTextAsYouType!==this.rS.kkb||b.CapitalizeFirstLetterOfSentences!==this.rS.WLc||b.ReplaceOrdianalsWithSuperscript!==this.rS.wpd||b.ReplaceHyphensWithDash!==this.rS.lrc||b.ReplaceFractionsWithFractionCharacter!==
this.rS.upd||this.Y2&&b.ReplaceQuoteWithSmartQuote!==this.rS.fWe?(a={},a.ReplaceTextAsYouType=b.ReplaceTextAsYouType,a.CapitalizeFirstLetterOfSentences=b.CapitalizeFirstLetterOfSentences,a.ReplaceOrdianalsWithSuperscript=b.ReplaceOrdianalsWithSuperscript,a.ReplaceHyphensWithDash=b.ReplaceHyphensWithDash,a.ReplaceFractionsWithFractionCharacter=b.ReplaceFractionsWithFractionCharacter,this.Y2&&(a.ReplaceQuoteWithSmartQuote=b.ReplaceQuoteWithSmartQuote),this.rS.Nel(a),ka.ULS.sendTraceTag(24523524,324,
50,"User close the option dialog and trigger to save the setting: {0}"+{["ReplaceTextAsYouType"]:b.ReplaceTextAsYouType,["CapitalizeFirstLetterOfSentences"]:b.CapitalizeFirstLetterOfSentences,["ReplaceOrdianalsWithSuperscript"]:b.ReplaceOrdianalsWithSuperscript,["ReplaceHyphensWithDash"]:b.ReplaceHyphensWithDash,["ReplaceFractionsWithFractionCharacter"]:b.ReplaceFractionsWithFractionCharacter,["ReplaceQuoteWIthSmartQuoteIsEnabled"]:this.Y2,["ReplaceQuoteWithSmartQuote"]:this.Y2&&b.ReplaceQuoteWithSmartQuote}),
Rc.App.Lb.updateCommandUI(!0)):ka.ULS.sendTraceTag(24523523,324,50,"User close the option dialog or cancle it without do any changes."))}}Object(m.a)(GF,"AutoCorrectOptionsDialog",bi.a,[1200]);class By{static get sg(){return bi.a.VC(By.Fo,CommonUIStrings.l_AlternativeTextTitleCaption,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}By.Fo="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(m.a)(By,"AltTextDialogWithDescriptionHtml",null,[]);class Cy{static get sg(){return bi.a.VC(Cy.Fo,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}Cy.Fo="<div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(m.a)(Cy,"AltTextDialogWithDescriptionNoTitleHtml",null,[]);class Yp extends bi.a{constructor(a=!1,b=!1){super(!1,!1,a);this.Jhg=!1;b?(this.Jhg=!0,this.sg=Cy.sg):this.sg=By.sg;this.kg=a?"AltTextDialog":"BaseAltTextDialogWithDescription"}uJi(a){this.pj(CommonUIStrings.l_AlternativeTextDialogTitle,Object(I.a)(this,this.aUd,"altTextDialogHandler"),this.XUc(a));a=document.getElementById(Yp.cUd)||document.getElementById(Yp.NJc);a.focus();a.select()}wJi(a){a={["id"]:"AltTextDialog",["bodyControls"]:this.XUc(a)};
this.pj(CommonUIStrings.l_AlternativeTextDialogTitle,Object(I.a)(this,this.aUd,"altTextDialogHandler"),a)}XUc(a){const b={};this.Jhg||(b[Yp.cUd]=this.getAltText(a));b[Yp.NJc]=this.i6f(a)||"";return b}SN(a){return a.Bc.id===Yp.NJc?!1:super.SN(a)}}Yp.cUd="titleText";Yp.NJc="descriptionText";Object(m.a)(Yp,"BaseAltTextDialogWithDescription",bi.a,[]);class bu extends Yp{constructor(a,b=!1,c=!1){super(b,c);this.kg=bu.XJj;b&&w.AFrameworkApplication.fa.ka("ReactAltTextDialogIsEnabled")?this.wJi(a):this.uJi(a)}}
bu.XJj="AAltTextDialogWithDescription";Object(m.a)(bu,"AAltTextDialogWithDescription",Yp,[]);class HF extends bu{constructor(a,b,c,f,l){super(a);this.Xrb=this.ZSb=null;this.bE=b;this.Jha=c;this.Lk=f;this.hd=l}i6f(a){this.ZSb=a.node;this.Xrb=cd.TableReader.dcg(a);return cd.TableReader.wde(this.Xrb)}getAltText(a){this.ZSb=a.node;this.Xrb=cd.TableReader.dcg(a);return cd.TableReader.xde(this.Xrb)}aUd(a){if(1===a){cd.TableReader.xde(this.Xrb);cd.TableReader.wde(this.Xrb);this.hide();a=this.Lk.je(15);try{a.ld(this.ZSb)}finally{a&&
a.dispose()}}N.a.instance.ga(50)&&this.Jha.Bw&&this.Jha.hZ.Qra(this.ZSb)}}Object(m.a)(HF,"TableAltTextDialog",bu,[]);class MA{constructor(a,b,c){this.bE=a;this.Lk=b;this.hd=c}create(a){return new HF(a,this.bE,Rc.App.Mh,this.Lk,this.hd)}}Object(m.a)(MA,"TableAltTextDialogFactory",null,[]);const VP=()=>{Rc.App.Bki=!0;return 32},WP=(a,b,c,f,l)=>{if(1===c)return 32;if(!({point:a,Pu:b}=IF(l)).returnValue)return 16;Rc.App.Lb.qza(a,b);return 32},XP=(a,b,c,f,l)=>{if(1===c)return 32;if(!({point:a,Pu:b}=IF(l)).returnValue)return 16;
Rc.App.Lb.C6(a,b);return 32},IF=a=>{let b,c;b=null;c=0;if(!a)return{returnValue:!1,point:b,Pu:c};a=a.split(",");if(3>a.length)return{returnValue:!1,point:b,Pu:c};b=new Sys.UI.Point(parseInt(a[0]),parseInt(a[1]));c=parseInt(a[2]);return{returnValue:!0,point:b,Pu:c}};var YP=d(1152);class JF extends Sys.EventArgs{constructor(a,b,c,f,l,y=0,H=0,Q=null){super();this.controlId=a;this.commandId=f;this.time=l;this.commandSurface=y;this.Pu=H;this.contentType=Q}}Object(m.a)(JF,"CommandClickEventArgs",Sys.EventArgs,
[]);class KF{constructor(a,b){this.aca=a.qej();this.eTb=a;this.BNa=b}RYf(a,b,c,f=null,l=null){c&&(this.BNa.eq=c.CommandLocation,this.BNa.XT=c.InvocationMethod,this.BNa.Dsa=c.CommandTabName);let y=this.eTb.K6f(parseInt(a),b,c);y.TE&&(y=this.eTb.K6f(y.Um,b,c));if(void 0!==y.tL&&null!==y.tL)return y.tL;if(y.hge)l=32;else{var H=null;this.aca&&this.aca.eQe&&(H=this.aca.eQe(y,l));y.lX||y.ipe?y.jr?l=16:(l=this.BNa.Ka(y.Um,y.hpe?2:1,y.zd,l),2===l&&(l=32)):y.jr?l=this.BNa.smd(null,y.Um,y.zd,Q=>{f&&f(Q.response)},
l):(l=this.BNa.Ka(y.Um,2,y.zd,l),f&&f(l));this.aca&&this.aca.zPe&&this.aca.zPe(y,l,H);if(b&&c&&-1!==c.InvocationMethod&&0!==c.InvocationMethod){c=b.LegacyId;if(void 0===c||null===c)c="";H=b.ParentMenuId;void 0!==H&&null!==H||!b.MenuId||(H=b.MenuId);let Q=b.SqmControlId;void 0!==Q&&null!==Q||!b.SourceControlId||(Q=b.SourceControlId);(void 0!==Q&&null!==Q||void 0!==H&&null!==H)&&YP.a.zXk(new JF(Q,c,H,a,Date.now()))}}y.lX&&32===l&&this.aca&&this.aca.g0b&&this.aca.g0b(y,b);y.ipe&&32===l&&this.aca&&this.aca.OUd&&
this.aca.OUd(y,b);return 32===l||1===l}Zbc(a,b=null){if(w.AFrameworkApplication.Yg||il.a.instance.Dw)return!1;const c=parseInt(a);b&&b.UILocation&&(this.BNa.eq=b.UILocation);if(!a||c===vf.ActionManager.j5b)return!0;a=this.eTb.lVc(c,b);a.TE&&(a=this.eTb.lVc(a.Um,b));if(void 0!==a.tL&&null!==a.tL)return a.tL;c===G.a.p7a&&b&&(a.zd=b);return 32===this.BNa.Ka(a.Um,1,a.zd)}clearCache(){this.eTb.clearCache()}}Object(m.a)(KF,"GeneralCuiUser",null,[1199,1220]);class LF{constructor(a,b,c,f){this.ouf=a;this.Ria=
b;this.zyc=c;this.g5a=f}Dag(){let a;a=this.g5a.Aoj(this.ouf);return{returnValue:this.g5a.YVc(this.ouf),Qih:a}}ayh(a,b){if(this.Ria){var c=new J.DictionaryPropertySet;this.zyc.execute(f=>{f.t5b(a)});c.setValue(ab.a.yt,a);c.setValue(N.a.instance.ga(20)?Ab.a.noProof:ee.a.Bxa,b);b=new pf.GraphTransaction(15);b.set(Rc.App.yP.uV);this.Ria.lV(c);b.dispose()}}}Object(m.a)(LF,"LanguageEditor",null,[474]);var pi=d(214);class kr{constructor(a=!1,b=0){this.PAd=null;this.FId=kr.vbg(bb.a.sej());this.hDc=new hr.a;
this.jra=[];this.arb=new Ma.a;this.Pqf=a;this.Qqf=0>=b?7:b;this.Oqf=this.MMd=0;this.yhf=!1;a&&(this.KOj(),w.AFrameworkApplication.Wga(()=>{this.Cck()}))}get languages(){return this.FId}KOj(){for(var a of this.FId)this.hDc.$(a.LCID,a);a=[];try{var b=pi.a.get("RecentlyUsedLcids");if(b&&""!==b){const f=decodeURIComponent(b).split(",").slice(0,this.Qqf);for(const l of f){let y;({value:y}=this.hDc.wg(parseInt(l))).returnValue&&a.push(y)}}}catch(f){ka.ULS.sendTraceTag(38385057,324,15,"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",
f.message),Array.clear(a)}if(a.length)for(var c of a)b=c.LCID,this.arb.contains(b)||(this.jra.push(c),this.arb.add(b));else c=w.AFrameworkApplication.lcid,({value:b}=this.hDc.wg(c)).returnValue&&(this.jra.push(b),this.arb.add(c));this.Yth()}Yth(){const a=Ia.toArray(Ia.select(Ia.asEnumerable(this.jra),b=>b.LCID)).join(",");pi.a.oK("RecentlyUsedLcids",a,180)}NPk(a,b){if(a&&!(0<a.options.length)){var c=-1,f=kr.vbg(this.jra);this.Pqf&&0<f.length&&(c=kr.BFf(f),c=kr.Txf(a,c,b),a.add(kr.Gri(),null));this.PAd||
(this.PAd=kr.BFf(this.FId));b=kr.Txf(a,this.PAd,b);-1===c&&(c=b);a.selectedIndex=c}}Nll(a,b){if(this.Pqf&&({value:c}=this.hDc.wg(a)).returnValue){b=a!==b;if(this.arb.contains(a))a=Array.indexOf(this.jra,c),0<=a&&(Array.removeAt(this.jra,a),this.jra.push(c)),b&&this.MMd++;else{this.arb.add(a);this.jra.push(c);if(this.jra.length>this.Qqf){var c=this.jra.shift();this.arb.remove(c.LCID)}b&&this.Oqf++}this.Yth()}}Cck(){const a=this.MMd+this.Oqf;!this.yhf&&0<a&&(ka.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",
100*this.MMd/a),this.yhf=!0)}static BFf(a){return Ia.toArray(Ia.select(Ia.asEnumerable(a),b=>{const c=document.createElement("OPTION");let f=b.displayName;c.value=b.LCID.toString();c.text=f;return c}))}static Gri(){const a=document.createElement("OPTION");a.text="\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500";
a.value="-1";a.disabled=!0;return a}static Txf(a,b,c){c=c.toString();let f=-1;for(const l of b)a.add(l,null),l.value===c&&(f=a.options.length-1);return f}static vbg(a){a=Array.clone(a);a.sort((b,c)=>b.displayName.localeCompare(c.displayName));return a}}Object(m.a)(kr,"LanguageListHelper",null,[1219]);var NA=d(241);class cu extends NA.a{constructor(){super();this.Type=this.Number=0}get ControlType(){return 10}}Object(m.a)(cu,"NumberButtonProps",NA.a,[]);class Tr{static get Bzl(){return Tr.ytf||(Tr.ytf=
Ib.a.instance.qb("Box4.ISpacingCommands"))}static get PAh(){return!!Tr.Bzl}static vb(){const a=w.AFrameworkApplication.Ra;a.ya(C.a.wKa,yb.a.view,Tr.wKa);a.he(C.a.wKa,1126)}static wKa(a,b,c,f,l){if(1===c||!Tr.PAh)return Tr.PAh?32:8;if(w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.ob.Qp)a=[],a.push(Object.assign(new cu,{ExternalId:"LineSpacing1_00",Number:1,Type:0})),a.push(Object.assign(new cu,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0})),a.push(Object.assign(new cu,{ExternalId:"LineSpacing1_50",
Number:1.5,Type:0})),a.push(Object.assign(new cu,{ExternalId:"LineSpacing2_00",Number:2,Type:0})),a.push(Object.assign(new cu,{ExternalId:"LineSpacing2_50",Number:2.5,Type:0})),a.push(Object.assign(new cu,{ExternalId:"LineSpacing3_00",Number:3,Type:0})),l.MenuItems=sj.d(a);else{a=sj.g("buttonLineSpacing1_00","1.00","2759860553","4080183461",1,0);b=sj.g("buttonLineSpacing1_15","1.15","2759860553","4080183461",1.15,0);c=sj.g("buttonLineSpacing1_50","1.50","2759860553","4080183461",1.5,0);f=sj.g("buttonLineSpacing2_00",
"2.00","2759860553","4080183461",2,0);const y=sj.g("buttonLineSpacing2_50","2.50","2759860553","4080183461",2.5,0),H=sj.g("buttonLineSpacing3_00","3.00","2759860553","4080183461",3,0),Q=sj.a("buttonParagraphDialog","2465215107",Box4Intl.Box4Strings.L_LineSpacingOptions);a=sj.c("LineSpacing.Menu.Controls",[a,b,c,f,y,H,Q]);a=sj.e("msLineSpacing",a,"Menu");a=sj.f([a]);l.PopulationXML=a}return 32}}Tr.ytf=null;Object(m.a)(Tr,"LineSpacingRibbonMenu",null,[]);var ZP=d(1150),$P=d(944);const aQ=(a,b,c)=>{if(1===
c)return 32;a=Rc.App.Lb.notificationBar.vDa("Automation test",!1);a.image=3;Rc.App.Lb.notificationBar.ji(a);return 32},cQ=(a,b,c,f,l)=>{let y;if(!({wPh:y}=bQ(l)).returnValue)return 16;Bj.UISurfaces.FL().then(H=>{let Q=null;var ia=Object.assign(new ZP.a,{label:"OK",onExecute:()=>{Q&&H.removeNotification(Q)}});ia=Object.assign(new $P.a,{target:"#"+M.AppFrame.jsh,content:"Here's the text for the callout",title:"Your title",primaryButtonProps:ia,useTeachingStyles:y});ia=H.callout(ia);Q=H.addNotification(ia);
return null},H=>{ka.ULS.sendTraceTag(541172639,383,15,"Failed to GetNotificationsAPIAsync: {0}",H);return null});return 32},bQ=a=>{let b;b=!1;if(!a)return{returnValue:!1,wPh:b};b=Boolean.parse(a);return{returnValue:!0,wPh:b}};class OA{constructor(a){this.kI=a}UQb(a){this.kI&&this.kI.BG(a)}}Object(m.a)(OA,"RibbonButtonUpdater",null,[1218]);var MF=d(290);class PA{constructor(){this.t7=this.Da=null}get name(){return"Box4.UI"}Yb(a){this.Da=a;a.register(1197,"Common.IReactContextualUILauncher").ma().oa(()=>
new DF(a.resolve("CommandUI.ReactRibbonRoot"),a.resolve("Common.IExternalUICommandDefinitionMapping")));a.register(1198,"Box4.IContextMenuController").ma().oa(()=>new FF(a.resolve("Common.IReactContextualUILauncher")));a.register(1199,"Box4.IGeneralCuiUser").oa(()=>new KF(a.resolve("Box4.UI.CuiActionBridge"),w.AFrameworkApplication.Ra)).ma();a.register(MA,"Box4.UI.TableAltTextDialogFactory").ma().oa(()=>new MA(a.resolve("Box4.ITableEditor"),new MF.a,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));
a.register(474,"Box4.UI.ILanguageEditor").oa(()=>new LF(ge.a.instance.Yj,a.qb("Box4.ITextFormattingCommands"),a.Ia("Box4.IAutoCorrectRules"),a.resolve("Box4.ILanguageReader")));a.register(1200,"Box4.UI.IAutoCorrectOptionsDialog").oa(()=>new GF(a.resolve("Box4.IAutoCorrectOptionsInfo"),w.AFrameworkApplication.fa.ka("ReplaceQuoteWithSmartQuoteIsEnabled")));a.register(kr,"Box4.UI.LanguageListHelper").as("Box4.UI.ILanguageListHelper").ma().oa(()=>new kr(w.AFrameworkApplication.fa.ka("RecentlyUsedLanguagesListIsEnabled")));
a.register(EF,"Box4.UI.ProofingRepeatedWordSectionBuilder").as("Box4.UI.IProofingRepeatedWordSectionBuilder").ma();a.register(JA,"Box4.UI.DefaultProofingContextMenuCreator").ma().oa(()=>new JA(a.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder")));a.register(KA,"Box4.UI.ProofingContextMenuSectionFactory").as("Box4.UI.IProofingContextMenuSectionFactory").ma().oa(()=>new KA(a.resolve("Box4.UI.DefaultProofingContextMenuCreator"),a.resolve("Box4.UI.EditorServiceProofingContextMenuCreator")));a.register(OA,
"Box4.RibbonButtonUpdater").as("Common.IRibbonButtonUpdater").ma().oa(()=>new OA(this.Da.resolve("Box4.IAppFrame")))}init(){var a=Rc.App.Lb;const b=a.ob;Rr.$Mj(Object(I.a)(b,b.mmc,"onAuthenticationLost"),Object(I.a)(b,b.nmc,"onAuthenticationRestored"),a.fxi);Sr.a.vb();a=w.AFrameworkApplication.Ra;a.ya(C.a.hTk,yb.a.application,VP);a.ra(C.a.nvl,yb.a.application,WP,96);a.ra(C.a.Rvl,yb.a.application,XP,96);a=w.AFrameworkApplication.Ra;a.ra(C.a.Cxl,yb.a.application,aQ,96);a.ra(C.a.avl,yb.a.application,
cQ,96);Tr.vb();this.t7=this.Da.qb("Box4.IContextMenuController")}dispose(){this.t7&&(this.t7.dispose(),this.t7=null)}static main(){n.a.instance.Ac(new PA,6)}}Object(m.a)(PA,"Box4UIPackage",null,[2,3]);var NF=d(465),dQ=d(896),Vs=d(207),eQ=d(552),uv=d(380),$m=d(320),gj=d(74);class OF{constructor(a){this.doa=a}}Object(m.a)(OF,"ValidParentData",null,[]);var Dy=d(374),fQ=d(828),vv=d(288),PF=d(827),wv=d(612),Fm=d(246),QF=d(361),xq=d(228);class RF{constructor(){this.Xvb=0}}Object(m.a)(RF,"BelowOutlineElementData",
null,[]);var Ws=d(424),gQ=d(600),hQ=d(486);class SF extends Ws.a{constructor(a,b,c,f){super(4,f);this.bXh=a;this.dAd=b;this.yBd=c}get EPc(){return this.bXh}get VZb(){return this.dAd}get dWd(){return this.yBd}fzb(){var a=this.EPc;if(!a)return ka.ULS.shipAssertTag(16819992,300,!1,"IParagraphStateWithChps not provided for DeletePara GetUpdateHintsForOperation"),null;const b=[],c=new gQ.a(this.EPc.id,this.EPc.yo,this.VZb?this.VZb.id:null);""!==a.characterData&&a.characterData&&(a=new hQ.DeleteTextUpdateHint(this.EPc.id,
0,a.characterData),Array.add(b,a));Array.add(b,c);return b}}Object(m.a)(SF,"DeleteParagraphOperation",Ws.a,[]);var iQ=d(599),jQ=d(485);class QA extends Ws.a{constructor(a,b,c,f,l){super(3,l);this.WKd=a;this.XKd=b;this.PWb=f}get MJa(){return this.WKd}get IIb(){return this.XKd}get DJa(){return this.PWb}fzb(){const a=[];var b=new iQ.AddParagraphUpdateHint(this.DJa.id,this.DJa.yo,this.MJa?this.MJa.id:null);Array.add(a,b);""!==this.DJa.characterData&&this.DJa.characterData&&(b=new jQ.a(this.DJa.id,0,this.DJa.characterData),
Array.add(a,b));return a}}Object(m.a)(QA,"InsertNewParagraphOperation",Ws.a,[]);var kQ=d(598);class TF extends Ws.a{constructor(a,b,c,f){super(2,f);this.WKd=a;this.XKd=b;this.G2h=c}get MJa(){return this.WKd}get IIb(){return this.XKd}get R3g(){return this.G2h}fzb(){const a=[],b=new kQ.MergeParagraphUpdateHint(this.MJa.id,this.MJa.yo,this.MJa.characterData.length,this.IIb.id,this.IIb.yo,this.R3g.id,this.R3g.yo);Array.add(a,b);return a}}Object(m.a)(TF,"MergeParagraphOperation",Ws.a,[]);var lQ=d(597);
class UF extends Ws.a{constructor(a,b,c,f,l){super(1,l);this.ZKd=a;this.$7h=b;this.dAd=c;this.yBd=f}get NJa(){return this.ZKd}get VZb(){return this.dAd}get dWd(){return this.yBd}get $zl(){return this.$7h}fzb(){const a=[],b=new lQ.a(this.NJa.id,this.NJa.yo,this.$zl,this.VZb.id,this.VZb.yo,this.dWd.id,this.dWd.yo);Array.add(a,b);return a}}Object(m.a)(UF,"SplitParagraphOperation",Ws.a,[]);var VF=d(323);class fk{constructor(a,b,c,f,l,y=null){this.hp=this.hd=null;this.ay=a;this.fp=b;this.fh=c;this.zWh=
f;this.D2h=l;this.Kqa=y}hai(a){N.a.instance.ga(50)&&Rc.App.Mh&&Rc.App.Mh.Bw&&Rc.App.Mh.hZ.Qra(a)}ilb(a,b,c){Za.OutlineElementNavigator.yi(a);Db.ParagraphReader.ql(a)?fk.paragraphEditor.Jv.ilb(a,b,c):cd.TableReader.iq(a)&&14===a.Bi&&(b=(new vv.a(1,c)).oN,this.Nol(Object(qa.a)(Dy.a,a.currentNode),b));Za.OutlineElementNavigator.Te(a)}Nol(a,b){a&&Object(Wa.a)(Dy.a,a)&&(a.nm=b)}get Jv(){return uv.a.Byb}get Xf(){return this.hd||(this.hd=Ib.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get W6(){return this.hp||
(this.hp=Ib.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get jq(){return this.fp.value}get Uf(){return this.fh.value}get aC(){return this.ay.value}get fj(){return bh.a.instance}c1d(){const a=eQ.a.instance.createInstance(393229);a.setValue(ab.a.YE,$m.a.first);a.setValue(ab.a.UPi,new Date);a.kyd();return a}$Mi(){const a=new dQ.a;a.setValue(ab.a.YE,$m.a.first);return a}Xrd(a,b,c){const f=a.Lh;if(f){f.id.equals(fk.hcf)||(fk.hcf=f.id,fk.Myc={});var l=fk.Myc[b];b in fk.Myc&&
f.gbb(l.id)&&f.xx&&f.xx.$_(l.id)||(l=new xq.a,l.setValue(ab.a.author,b),l=f.bLa(l));a.properties.setValue(c,l.id);fk.Myc[b]=l}}HNb(a,b){a.properties.setValue(ab.a.lastModifiedTime,b)}Q8e(a,b=null){const c=new pf.GraphTransaction(7);c.ld(a);b||(b=new Date);this.HNb(a,b);this.Xrd(a,this.JXc(),ab.a.x0b);""===Wd.OutlineElementReader.hUc(a,ab.a.AKc)&&this.Xrd(a,this.JXc(),ab.a.AKc);c.dispose()}JXc(){return Rc.App.g6e.name}C4d(a,b,c=!1){if(N.a.instance.ga(56))Wd.OutlineElementReader.wpe(a)?(a=Wd.OutlineElementReader.isRtl(a),
c?this.Esd(b,a):this.SLa(b,a)):this.M6k(b);else if(N.a.instance.ga(26)||N.a.instance.ga(89))a=Wd.OutlineElementReader.isRtl(a),c?this.Esd(b,a):this.SLa(b,a)}dOb(a,b){var c=new ob.GraphIterator;c.set(a);c.sc(11);c=c.Kg(11);Wd.OutlineElementReader.Gm(c)!==b&&(this.SLa(c,b),N.a.instance.ga(54)?a.anchor.Jr(4):(c=1,b&&(c=3),a.setValue(ab.a.Vl,c),a.setValue(ab.a.xJ,c)))}SLa(a,b){const c=new pf.GraphTransaction(7);c.ld(a);this.Esd(a,b);if(N.a.instance.ga(26)){var f=new ob.GraphIterator;f.set(a);f.Cb(2)&&
Db.ParagraphReader.ql(f)&&(f=f.currentNode,b?(f.ye($c.a.mod,!0),fk.paragraphEditor.nK(f,3)):(f.removeProperty($c.a.mod),fk.paragraphEditor.nK(f,1)))}f=new ob.GraphIterator;f.set(a);VF.a.instance.cRj(f);if(f.sc(10)){const l=f.Kg(10);f.Cb(1)===a&&this.aC.SLa(l,b)}c.dispose()}Esd(a,b){let c=null,f=null;if(this.Xf.ig&&a.isConnected){c=Db.ParagraphReader.CWc(a,!0,!0);f=new Na.a;for(let l=0;l<c.count;l++)12===c.ga(l).type&&f.add(c.ga(l).a9())}b?a.properties.setValue(ab.a.BY,!0):N.a.instance.ga(56)?a.properties.setValue(ab.a.BY,
!1):(N.a.instance.ga(26)||N.a.instance.ga(89))&&a.properties.removeProperty(ab.a.BY);if(this.Xf.ig&&c&&f)if(c.count!==f.count)ka.ULS.shipAssertTag(35973010,376,!1,"Paragraph count [{0}] doesn't match PreviousFormatProp count [{1}]",c.count,f.count);else for(a=0;a<c.count;a++)c.ga(a),f.ga(a)}M6k(a){a.properties.removeProperty(ab.a.BY)}nda(a,b=null,c=!1){let f=null,l=null;if(!Wd.OutlineElementReader.ih(a))return ka.ULS.sendTraceTag(40502923,307,15,"GraphIterator does not point to an outline element."),
null;var y=null;let H=null,Q=0;b&&(y=b.formatting,H=b.style,Q=b.languageId);c||({MJa:f,IIb:l}=this.y3f(a));b=Vs.a.instance.createInstance(393230);b.setValue(ab.a.tq,"");a.Hl(b,2);a.$k(b);fk.paragraphEditor.Uqc(b);fk.paragraphEditor.utk(b);fk.paragraphEditor.eRb(b);this.hai(b);y&&(b.Ta.first.formatting.Am=y);Q||(Q=w.AFrameworkApplication.lcid);a.currentNode.ye(ab.a.Akb,a.currentNode.sa(ab.a.Akb,Q));N.a.instance.ga(54)&&a.currentNode.setValue(Ab.a.Lnc,0);!N.a.instance.ga(71)||N.a.instance.ga(61)||H||
(y=fb.StyleReader.JL(b))&&(H=y.kH(fb.StyleReader.Jpa));this.zWh.j1i(a);H&&fk.wP.aba(H,b,!0);!c&&f&&(c=new QA(f,l,f,new wv.a(b),b.ASa),a.currentNode.jH().graphTransactionOperations.WZ(c));return b}y3f(a){let b;const c=new ob.GraphIterator;c.Tc(a);b=null;c.qog?c.currentNode.jH().graphTransactionOperations.tja(6):(Za.OutlineElementNavigator.zxa(c,!0,!1),b=this.BVc(c));c.Tc(a);a=this.l4f(c);return{MJa:b,IIb:a}}l4f(a){const b=new ob.GraphIterator;b.Tc(a);a=null;b.ZAb||(Za.OutlineElementNavigator.ZJ(b,
!0,!1),a=this.BVc(b));return a}BVc(a,b=!1){a=Za.OutlineElementNavigator.yi(a,!0);return a?this.C7f(a,b):(ka.ULS.sendTraceTag(8451733,355,15,"No paragraph node below OutlineElement"),null)}C7f(a,b=!1){if(12===a.type)return b?new wv.a(a):new PF.a(a);a.jH().graphTransactionOperations.tja(5);return new fQ.a(a)}TBi(a,b){var c=b.currentNode.clone();a.OL(c,null,1);a.$k(c);c.l_=b.currentNode;Za.OutlineElementNavigator.yi(b);b.bX&1&&b.currentNode.i3a(null);c=b.currentNode.clone();c.qV=b.currentNode.qV;a.OL(c,
null,2);a.$k(c);a.WT(1);c.l_=b.currentNode;N.a.instance.ga(55)&&c.setValue(Ab.a.yo,ah.a.m0a());b.eC(11)}Uqc(a){a.Cb(2)&&a.Ni()}Xph(a,b){const c=a.currentNode;Za.OutlineElementNavigator.yi(a);const f=a.currentNode;Za.OutlineElementNavigator.Te(a);b.zB(1);Za.OutlineElementNavigator.yi(b);a.Hl(b.currentNode,2);b.Ni();var l=new ob.GraphIterator;l.Tc(b);if(l.Cb(1)){const y=new ob.GraphIterator;y.Tc(a);const H=new OF(null);if(!this.Bwj(y,l.currentNode,H))return;Fm.h(y,null,1,1,l,-1)}b.Ni();l=null;a.WF(1)&&
(l=a.currentNode);for(a.Cc();xg.OutlineNavigator.saa(b);)a.OL(b.currentNode,l,1),l=b.currentNode,b.Ni();a.$k(c);a.$k(f);a.Ni()}cPb(a,b,c,f,l,y=!1){this.Uqc(b);const H=b.Bi;var Q=a.currentNode;let ia=null;var wa=null;let Ua=null,kb=!1;Za.OutlineElementNavigator.yi(a);const Gb=a.Bi;if(Db.ParagraphReader.ql(a)){var ec=a.currentNode;(wa=Object(qa.a)(kf.AParagraphNode,ec))?wa.Ta&&wa.Ta.length||ka.ULS.sendTraceTag(38925760,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",wa):ka.ULS.sendTraceTag(38925731,
307,15,"srcParaNode is null");wa=new wv.a(wa);(kb=c.Sa===Db.ParagraphReader.textLength(ec))&&(Ua=this.l4f(b));var dc=b.currentNode;ia=this.nda(b,void 0,!0);fk.paragraphEditor.s3e(a,b,c,l,!0,y);N.a.instance.ga(71)&&(f?(l=fb.StyleReader.tE(ec))&&fk.wP.aba(l,ia,!0):kb&&(l=fb.StyleReader.tE(ec))&&((ec=l.sa($c.a.K5g,null))?(l=fb.StyleReader.JL(ia).kH(ec),fk.wP.aba(l,ia,!1)):fk.wP.aba(l,ia,!0)));this.C4d(Q,dc);this.jq.A4d(Q,dc)}Za.OutlineElementNavigator.Te(a);Za.OutlineElementNavigator.Te(b);Q=Wd.OutlineElementReader.isEmpty(a,
!0);dc=Wd.OutlineElementReader.isEmpty(b,!0);N.a.instance.ga(27)&&Q&&!dc&&(b.bX&1&&(Q=new QF.a,Q.Tc(b),b.currentNode.i3a(Q)),this.Xrd(b.currentNode,Wd.OutlineElementReader.hUc(a.currentNode,ab.a.x0b),ab.a.x0b),this.Xrd(b.currentNode,Wd.OutlineElementReader.hUc(a.currentNode,ab.a.AKc),ab.a.AKc),this.HNb(b.currentNode,Wd.OutlineElementReader.Rjj(a.currentNode)));Za.OutlineElementNavigator.yi(a);(Q=Object(qa.a)(kf.AParagraphNode,a.currentNode))?Q.Ta&&Q.Ta.length||ka.ULS.sendTraceTag(38925762,307,15,
"srcParaNode: {0}. srcParaNode has no characterProperties",Q):ka.ULS.sendTraceTag(38925761,307,15,"srcPara is null");Q=new wv.a(Q);Za.OutlineElementNavigator.Te(a);(a=ia)?a.Ta&&a.Ta.length||ka.ULS.sendTraceTag(38925764,307,15,"paragraphNode: {0}. paragraphNode has no characterProperties.",a):(ka.ULS.sendTraceTag(38925763,307,15,"paragraphNode is null"),ka.ULS.sendTraceTag(40425482,307,50,"SplitAtIp state. {0}",{["splittingAtEnd"]:kb,["moveText"]:!0,["overrideParagraphStyle"]:f,["sourceOutlineElementContentNodeType"]:Gb,
["destinationOutlineElementNodeType"]:H,["alwaysMoveEopToDestinationPara"]:y}));kb?(c=new QA(wa,Ua,Q,new wv.a(a),a.ASa),b.currentNode.jH().graphTransactionOperations.WZ(c)):(c=new UF(wa,c.Sa,Q,new wv.a(a),a.ASa),b.currentNode.jH().graphTransactionOperations.WZ(c))}QHf(a,b){Za.OutlineElementNavigator.yi(a);let c=Db.ParagraphReader.vs(a.currentNode);const f=a.currentNode;N.a.instance.ga(14)&&(c=b?c&&!this.fj.BLk(f):c&&!this.fj.vLk(f));Za.OutlineElementNavigator.Te(a);return c}merge(a,b,c,f,l=null,y=
!1,H=!1,Q=!1){if(a.currentNode.id===b.currentNode.id)return!1;let ia,wa;var Ua=new ob.GraphIterator;Ua.Tc(b);ia=this.BVc(Ua);Ua.Tc(a);wa=this.BVc(Ua,!0);if(!this.QHf(b,!0)||!this.QHf(a,!1))return!1;if(this.Uf.ppc){var kb=Object(qa.a)(kf.AParagraphNode,a.currentNode);kb=(c||!kb||!kb.characterData.length)&&!Zb.ListReader.Hk(a)}else kb=this.D2h.KRl(c,a);Q||this.jq.merge(a,b,kb,l);Za.OutlineElementNavigator.yi(a);l=a.currentNode.ASa;Za.OutlineElementNavigator.yi(b);if(Db.ParagraphReader.ql(b)){if(N.a.instance.ga(50)&&
Rc.App.Mh.Bw){Q=b.currentNode;kb=a.currentNode;const Gb=NF.CoauthLockEditor.getInstance();if(Gb.AOb(this.fj.l7b(Q))||Gb.AOb(this.fj.l7b(kb)))return b.Cc(),a.Cc(),!1}Q=!1;Zb.ListReader.Fx&&(kb=a.parentNode)&&Wd.OutlineElementReader.I9(kb)&&(Q=Zb.ListReader.PVa(kb));N.a.instance.ga(71)&&(kb=(kb=Db.ParagraphReader.isEmpty(a)||c)&&!Q)&&(kb=fb.StyleReader.Nbg(b))&&fk.wP.aba(kb,a.currentNode,!0);c&&this.Kqa.Nvk(b.currentNode,a.currentNode,Q,H);c=fk.paragraphEditor.merge(a,b,c,f,y);f=Ua.currentNode;Ua=a.currentNode;
a.Cc();c&&Wd.OutlineElementReader.isEmpty(b,!0)&&this.RDa(b);a=new TF(wa,ia,new PF.a(f),l);Ua.jH().graphTransactionOperations.WZ(a);return!0}b.Cc();a.Cc();return!1}bQj(a){const b=new ob.GraphIterator;b.set(a.node);b.kf();Za.OutlineElementNavigator.Te(b);const c=this.V$b(b),f=this.V$b(b);this.cPb(b,c,a,!1,!0);Wd.OutlineElementReader.isEmpty(b,!1)&&(this.jq.Roa(b),b.Ni());Wd.OutlineElementReader.isEmpty(c,!1)&&!Wd.OutlineElementReader.vcb(c)&&(this.jq.Roa(c),c.Ni());return f}nea(a,b,c,f=null,l=!1){if(!this.Xwi(a))return null;
const y=a.currentNode,H=Zb.ListReader.Hk(a);b||l||Wd.OutlineElementReader.isEmpty(a,!1);l=this.jq.oul(H);b=b?a.WF(1):a.currentNode;a.Cc();c=this.aC.U$b(a,b,c,f);if(!c)return null;this.C4d(y,c);this.jq.A4d(y,c);l&&this.jq.PHl(a,y);return c}Xwi(a){return Wd.OutlineElementReader.ih(a)&&(a=a.parentNode,gj.OutlineReader.Cbc(a)||Wd.OutlineElementReader.I9(a)||Wd.OutlineElementReader.ava(a))?!0:!1}F5k(a){const b=new ob.GraphIterator;b.set(a);b.kf();b.eC(11);let c,f;({MJa:c,IIb:f}=this.y3f(b));let l=-1;12===
a.type&&(l=a.ASa);b.currentNode.jH().graphTransactionOperations.WZ(new SF(this.C7f(a,!0),c,f,l));this.RDa(b)}RDa(a){if(a.gJ(1)){const b=new RF,c=new ob.GraphIterator;c.Tc(a);this.bbj(c,b)&&this.Jv.JPc(a,-b.Xvb)}a.Ni();cd.TableReader.Gs(a)&&this.sQk(a)}Hie(a,b,c){if(!gj.OutlineReader.ku(a)&&!Wd.OutlineElementReader.ih(a))return null;const f=this.$Mi();0<c&&c<$m.a.last&&f.setValue(ab.a.YE,Math.min($m.a.nil,c));a.OL(f,b,1);return f}dQj(a,b){if(!Wd.OutlineElementReader.ih(a)&&!Wd.OutlineElementReader.pJ(a)||
!gj.OutlineReader.kX(a.parentNode)&&!Wd.OutlineElementReader.I9(a.parentNode))return null;const c=a.currentNode;let f;f=a.currentNode;a.Cc();b=this.Hie(a,f,b);a.$k(c);return b}sQk(a){Wd.OutlineElementReader.pJ(a)&&(a.gJ(1)||a.Ni());this.g1f(a,!1);this.mAf(a)}g1f(a,b){var c,f=null;for(c=a.Cb(1);c;){var l=!1;Wd.OutlineElementReader.ava(c)&&!a.gJ(1)&&(l=!0);var y=c;c=a.Nj(1);if(l)l=new ob.GraphIterator,l.set(y),l.kf(),l.Ni();else if(Wd.OutlineElementReader.ava(y)){if(f){l=new ob.GraphIterator;l.set(f);
var H=new ob.GraphIterator;H.set(y);H.kf();l.Hl(H.currentNode,1);H.Ni();H=Wd.OutlineElementReader.b4(y);H===$m.a.nil&&(H=1);(H=Math.max(0,Wd.OutlineElementReader.b4(y)-H))?y.setValue(ab.a.YE,Math.min($m.a.nil,H)):(l.$k(y),a.Cb(1),Fm.e(l),l.Cc());b&&this.g1f(l,!0)}}else f=y}b=null;f=$m.a.last+1;for(c=a.Cb(1);c;c=a.Nj(1))if(Wd.OutlineElementReader.pJ(a))y=Wd.OutlineElementReader.b4(c),f>y&&(f=y,b=c);else{a.Cc();return}if(b){for(c=a.Cb(1);c;c=a.Nj(1))c!==b&&a.currentNode.setValue(ab.a.YE,Math.min($m.a.nil,
Wd.OutlineElementReader.b4(c)-f));f+=Wd.OutlineElementReader.b4(a.currentNode);a.currentNode.setValue(ab.a.YE,Math.min($m.a.nil,f));c=new ob.GraphIterator;c.Tc(a);c.$k(b);c.Cb(1);Fm.e(c)}}Bwj(a,b,c){var f=Wd.OutlineElementReader.b4(a.currentNode);if(1===f)return!0;if(Wd.OutlineElementReader.pJ(a))return!1;if(!a.W8(1)||this.E_j(a,b))return a.currentNode.setValue(ab.a.YE,Math.min($m.a.nil,1)),!0;if(c.doa&&a.$k(c.doa)){if(Wd.OutlineElementReader.pJ(a)&&1===f+Wd.OutlineElementReader.b4(a.currentNode))return c.doa=
a.zB(1),a.Cc(),!0;a.Cc()}if(c.doa&&a.$k(c.doa)||!c.doa&&a.Cb(1)){if(a.currentNode!==b&&a.Gf(1)&&Wd.OutlineElementReader.pJ(a)&&1===f+Wd.OutlineElementReader.b4(a.currentNode))return c.doa=null,!0;a.Cc()}if(a.SUa(b)&&this.D_j(a,b)){for(c=a.Cb(1);c;c=a.Nj(1))c!==b&&c.setValue(ab.a.YE,Math.min($m.a.nil,Wd.OutlineElementReader.b4(c)+(f-1)));a.currentNode.setValue(ab.a.YE,Math.min($m.a.nil,1));return!0}if(1>f)return f=this.Hie(a,c.doa,1-f),a.$k(f),c.doa=null,!0;if(1<f){a.currentNode.setValue(ab.a.YE,Math.min($m.a.nil,
1));b=null;let l=a.Cb(1);for(;l;){if(Wd.OutlineElementReader.pJ(a)){l.setValue(ab.a.YE,Math.min($m.a.nil,f-1+Wd.OutlineElementReader.b4(l)));l=a.Nj(1);continue}b||(b=this.dQj(a,f-1));const y=l;l=Fm.j(a,b,1);l===b&&(l=a.Nj(1));c.doa===y&&(c.doa=b,b=null)}return!0}return!1}E_j(a,b){return ob.GraphIterator.Eda(()=>{if(1===a.W8(1)){const c=a.Cb(1);a.Cc();if(c===b)return!0}return!1})}D_j(a,b){return ob.GraphIterator.Eda(()=>{let c;for(c=a.Cb(1);c;c=a.Nj(1))if(c!==b&&!Wd.OutlineElementReader.pJ(a))return a.Cc(),
!1;return!0})}bbj(a,b){b.Xvb=0;do{const c=a.currentNode;if(a.Cb(1))b.Xvb-=Wd.OutlineElementReader.b4(c);else{if(gj.OutlineReader.ku(a)||null===a.currentNode)return!1;if(3!==a.role||!a.ala(1))for(;!a.Nj(1);)if(b.Xvb+=Wd.OutlineElementReader.b4(a.currentNode),gj.OutlineReader.ku(a)||null===a.currentNode)return!1}}while(Wd.OutlineElementReader.pJ(a));return!0}V$b(a,b=!1){return this.Gie(a,!1,b)}Gie(a,b,c=!1){const f=new ob.GraphIterator;f.Tc(a);a=new ob.GraphIterator;a.Tc(f);this.nea(a,b,!1,null,c);
a.currentNode.setValue(ab.a.YE,Math.min($m.a.nil,Wd.OutlineElementReader.b4(f.currentNode)));f.Cb(1)&&Fm.h(a,null,1,1,f,-1);return a}mAf(a){if(Wd.OutlineElementReader.zal(a)){1!==Wd.OutlineElementReader.b4(a.currentNode)&&a.currentNode.setValue(ab.a.YE,$m.a.first);for(var b=a.Cb(1);b;)if(Wd.OutlineElementReader.pJ(a)){b=new ob.GraphIterator;b.Tc(a);b.Cc();const c=new ob.GraphIterator;c.Tc(a);c.Cb(1);Fm.h(b,a.currentNode,1,1,c,-1);b=a.xSa(1)}else this.mAf(a),b=a.Nj(1)}}static get wP(){return fk.bL||
(fk.bL=Ib.a.instance.resolve("Box4.Styles.IStyleEditor"))}static set wP(a){fk.bL=a}static get paragraphEditor(){return fk.qx||(fk.qx=Ib.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(a){fk.qx=a}}fk.bL=null;fk.qx=null;fk.hcf=null;fk.Myc=null;Object(m.a)(fk,"OutlineElementEditor",null,[1271]);var $w=d(113),ax=d(416),WF=d(603),yq=d(257);class jo{constructor(a){this.opf=a}aNi(){const a=Vs.a.instance.createInstance(393228);a.setValue(ab.a.YE,$m.a.first);a.setValue(ab.a.bqi,0);
a.setValue(ab.a.Ix,gj.OutlineReader.PRf);(new WF.OutlineIndentInfo(!0)).buh(a);return a}nW(a,b,c=null){const f=a.currentNode;if(!a.zB(1))return this.U$b(a,null,b,c);Wd.OutlineElementReader.pJ(a)&&Za.OutlineElementNavigator.qJe(a,!0);return Wd.OutlineElementReader.ih(a)?jo.Wh.nea(a,!1,b,c):(a.Jrc(f),null)}Wwi(a){return gj.OutlineReader.Noe(a.currentNode)||Wd.OutlineElementReader.ih(a)||Wd.OutlineElementReader.pJ(a)||ae.isTableCell(a)}U$b(a,b=null,c=!1,f=null){if(!this.Wwi(a))return null;const l=jo.Wh.c1d();
this.Hnl(l,a);a.c_c(l,b,1,this.opf.j3f());a.$k(l);c&&(jo.Wh.nda(a,f),Za.OutlineElementNavigator.Te(a));N.a.instance.ga(25)&&jo.Wh.Q8e(a.currentNode);return l}Hnl(a,b){if(b=this.iqj(b))switch(b.type){case 11:jo.Wh.C4d(b,a,!0);break;case 8:b=jo.Tk.isRtl(b),jo.Wh.Esd(a,b)}}iqj(a){return this.opf.zce(a)}gfj(a,b){a=jo.Tk.fWc(a);return new ax.a(a.x+gj.OutlineReader.rPc*(b?-1:1),a.y+gj.OutlineReader.XRf)}wsd(a){if(N.a.instance.ga(17)){var b=new ob.GraphIterator;b.set(a);b.hv();b=this.gfj(b.origin,gj.OutlineReader.Gm(a));
yq.c(a,b.x,b.y)}}SLa(a,b){N.a.instance.ga(43)&&ze.c(a)||a.setValue(ab.a.xJ,b?11:9)}static get Tk(){return $w.PageReader.instance}static get Wh(){return jo.Ji||(jo.Ji=Ib.a.instance.resolve("Box4.IOutlineElementEditor"))}static set Wh(a){jo.Ji=a}}jo.Ji=null;jo.If=null;Object(m.a)(jo,"OutlineEditor",null,[1336]);const mQ=a=>{a.register(jo,"Box4.OutlineLevelEditors.OutlineEditor").as("Box4.IOutlineEditor").ma().oa(()=>new jo(a.resolve("Box4.IOutlineElementNodeIdFactory")));a.register(fk,"Box4.OutlineLevelEditors.OutlineElementEditor").as("Box4.IOutlineElementEditor").ma().oa(()=>
new fk(a.oe("Box4.IOutlineEditor"),a.oe("Box4.List.IListEditor"),a.oe("Box4.List.IListReader"),a.resolve("Box4.ICreateParagraphStrategy"),a.resolve("Box4.IMergeListEditorInOutlineElementStrategy"),a.resolve("Box4.IFormattingPropertyTransitStrategy")))};class RA{get name(){return"Box4.OutlineLevelEditors"}Yb(a){mQ(a)}init(){}dispose(){}static main(){n.a.instance.Ac(new RA)}}Object(m.a)(RA,"Box4OutlineLevelEditorsPackage",null,[2,3]);class SA{get name(){return"Box4.TableEditors"}Yb(){}init(){}dispose(){}static main(){n.a.instance.Ac(new SA)}}
Object(m.a)(SA,"Box4TableEditorsPackage",null,[2,3]);class TA{get name(){return"Box4.TextLevelEditors"}Yb(){}init(){}dispose(){}static main(){n.a.instance.Ac(new TA)}}Object(m.a)(TA,"Box4TextLevelEditorsPackage",null,[2,3]);class Ur{constructor(a,b,c){this.aLd=this.a6a=this.YKd=this.$5a=this.XId=null;this.GG=a;this.FXh=b;this.Uc=c;this.init()}init(){this.FXh.rb(Object(I.a)(this,this.TAj,"handleEditingViewUpdatesSafe"));this.$5a=new Jd.a;this.YKd=new Jd.a;this.a6a=new Jd.a;this.aLd=new qj.a}s0a(a){this.$5a.add(a.key,
a)}HUe(a){this.a6a.add(a.key,a)}TAj(a){try{this.SAj(a)}catch(b){a=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",b.message,b.stack),ka.ULS.sendTraceTag(5285580,334,10,a)}}SAj(a){let b;({c2d:b}=Ur.VJl(this.Uc.Pa.mb)).returnValue&&(a=Ur.Gdj(a,this.XId,b),this.VTk(a,b),this.XId=b)}VTk(a,b){a=this.Z$i(a,b);let c;({notification:c}=Ur.OJl(a)).returnValue&&this.GG.sendNotification(c,!1)}Z$i(a,b){const c=new Jd.a;c.$(1,new qj.a);c.$(0,new qj.a);a.forEach(f=>
{3===f?(ba.ImageReader.tH(b.node)||this.Eal(b),this.nnj(c,b)):0===f&&this.fej(c,b);return!0});return c}Eal(a){this.$5a.forEach((b,c)=>{c.reset(a);return!0})}fej(a,b){let c=new Jd.a;ba.ImageReader.tH(b.node)||(c=this.cej(b.Sa));this.dej(a,this.YKd,c,Ur.Yuh(this.XId,b));this.YKd=c}cej(a){const b=new Jd.a;this.$5a.forEach((c,f)=>{c=null;({pCa:c}=f.zwc(a)).returnValue&&b.$(f.key,c);return!0});return b}dej(a,b,c,f){const l=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;b.forEach((y,H)=>{const Q=
this.$5a.ga(y).y8||H.title;let ia;({value:ia}=c.wg(y)).returnValue?f&&ia.nQ!==H.nQ&&(Q&&a.ga(1).add(Q),y=this.$5a.ga(y).y8,y=String.format(l,ia.title,y),ia.description&&(y+=", "+ia.description),a.ga(0).add(y)):Q&&a.ga(1).add(Q);return!0});c.forEach((y,H)=>{b.Fb(y)||(y=this.$5a.ga(y).y8,y=String.format(l,H.title,y),H.description&&(y+=", "+H.description),a.ga(0).add(y));return!0})}nnj(a,b){b=this.rtj(b.node);b=this.PCi(b);this.stj(a,this.aLd,b);this.aLd=b}rtj(a){const b=new ob.GraphIterator;b.set(a);
if(!b.sc(1))return null;const c=new qj.a;for(;1!==b.Bi;)this.a6a.forEach((f,l)=>{let y;({kvb:y}=l.G7e(b)).returnValue&&c.add(y);return!0}),b.Cc();c.reverse();return c}PCi(a){a=a.toArray();let b=0;for(;b<a.length-1;){var c=a[b];if(c.u1===a[b+1].u1&&(this.a6a.ga(c.u1),({SCi:c}={returnValue:!1,SCi:null}).returnValue)){a.splice(b,2,c);continue}b++}return new qj.a(a)}stj(a,b,c){var f;for(f=0;f<Math.min(c.length,b.length)&&c.ga(f).contentId.equals(b.ga(f).contentId);f++){var l=this.a6a.ga(c.ga(f).u1).PUc(c.ga(f),
b.ga(f));l&&(c.ga(f).description&&(l+=", "+c.ga(f).description),a.ga(0).add(l))}for(l=f;l<c.length;l++){let y=this.a6a.ga(c.ga(l).u1).PUc(c.ga(l),null);y&&(c.ga(l).description&&(y+=", "+c.ga(l).description),a.ga(0).add(y))}for(c=f;c<b.length;c++)(f=this.a6a.ga(b.ga(c).u1).y8)&&a.ga(1).add(f)}static Gdj(a,b,c){const f=new qj.a;(a=a||Ur.Tgl(b,c))?(f.add(3),f.add(0)):Ur.Yuh(b,c)&&f.add(0);return f}static Tgl(a,b){return!a||!a.node.id.equals(b.node.id)}static Yuh(a,b){return!a||!a.equals(b)}static VJl(a){let b;
b=null;if(!a||!(Mb.SelectionEditor.Dx(a)||(a=Mb.SelectionEditor.fm(a,!0,!1),Mb.SelectionEditor.Dx(a)||a.Va&&ba.ImageReader.tH(a.Va.node))))return{returnValue:!1,c2d:b};b=a.Va;return{returnValue:!!b,c2d:b}}static OJl(a){const b=new qj.a;a.ga(1).forEach(c=>{c=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,c);b.add(c);return!0});a.ga(0).forEach(c=>{c=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,c);b.add(c);return!0});a=b.toArray().join(" ");return{returnValue:0<
b.length,notification:a}}}Object(m.a)(Ur,"AccessibilityContextManager",null,[1213]);class bx{constructor(a,b){this.tkf=!1;this.nYb=null;this.eGc=this.JHc=!1;this.qff=null;this.Zd=a;this.Kob=b}get OHj(){return!!this.nYb}rb(a){this.tkf||(this.Kob.$yf(Object(I.a)(this,this.EJc,"afterEditingViewValidateEventHandler")),this.tkf=!0);this.qff=a}EJc(a,b){(b.lN||b.gV)&&this.azk(b.lN,b.gV)}azk(a,b){this.OHj&&this.Zd.Lg(this.nYb);this.JHc=this.JHc||a;this.eGc=this.eGc||b;this.nYb=new dd.a(4,1,bx.h0i,()=>{this.qff(this.JHc,
this.eGc);this.reset()},126);this.Zd.Hb(this.nYb)}reset(){this.nYb=null;this.eGc=this.JHc=!1}}bx.h0i=100;Object(m.a)(bx,"EditingViewOnAfterValidateEventsConsolidator",null,[1209]);class UA{constructor(){this.Da=null}get name(){return"Box4.Accessibility"}init(){Rc.App.gDf&&this.Da.resolve("Box4.Accessibility.IAccessibilityContextManager")}dispose(){}Yb(a){this.Da=a;a.register(bx,"Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator").as("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator").ma().oa(()=>
new bx(w.AFrameworkApplication.Ae,a.resolve("Box4.ContentEditableViewEventSource")));a.register(Ur,"Box4.Accessibility.AccessibilityContextManager").as("Box4.Accessibility.IAccessibilityContextManager").ma().oa(()=>new Ur(a.resolve("Common.Utils.IAriaNotifier"),a.resolve("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator"),ge.a.instance))}static main(){n.a.instance.Ac(new UA)}}Object(m.a)(UA,"Box4AccessibilityPackage",null,[2,3]);class VA{constructor(a,b){this.Irf=a;this.Y2=b;this.erf=
this.brf=this.crf=this.drf=this.Ccf=this.frf=!0}get kkb(){return this.frf}get WLc(){return this.Ccf}get wpd(){return this.drf}get lrc(){return this.crf}get upd(){return this.brf}get fWe(){return this.erf}dHf(a){if(a)for(let c in a){var b=c;const f=Boolean.parse(a[c].toString()||"false");switch(b){case "ReplaceTextAsYouType":this.frf=f;break;case "CapitalizeFirstLetterOfSentences":this.Ccf=f;break;case "ReplaceOrdianalsWithSuperscript":this.drf=f;break;case "ReplaceHyphensWithDash":this.crf=f;break;
case "ReplaceFractionsWithFractionCharacter":this.brf=f;break;case "ReplaceQuoteWithSmartQuote":this.erf=this.Y2&&f}}}Naj(){this.Irf.dee("getAutoCorrectOptionsSettings","ReplaceTextAsYouType CapitalizeFirstLetterOfSentences ReplaceOrdianalsWithSuperscript ReplaceHyphensWithDash ReplaceFractionsWithFractionCharacter ReplaceQuoteWithSmartQuote".split(" ")).continueWith(Object(I.a)(this,this.CDk,"onGetRequestFinished"),8);ka.ULS.sendTraceTag(24523491,324,50,"Load to get autocorrect options from Roaming Service.")}Nel(a){this.Irf.Iyh("saveAutoCorrectOptionsSettings",
a);ka.ULS.sendTraceTag(24523520,324,50,"Try to save autocorrect options to Roaming Service.");this.dHf(a)}CDk(a){a.Dm?ka.ULS.sendTraceTag(24523522,324,15,"Fail to get autocorrect options from Roaming Service."):((a=a.result)&&this.dHf(a),ka.ULS.sendTraceTag(24523521,324,50,"Load to get autocorrect options from Roaming Service successfully, isUserSettingsEmpty: {0}",!a||!ta.a.count(a)))}}Object(m.a)(VA,"AutoCorrectOptionsInfo",null,[1217]);var Ey=d(220);class Cj{static get TDf(){Cj.mSb||(Cj.mSb=[],
Cj.SHb(bb.a.He("ar-sa")),Cj.SHb(bb.a.He("de-de")),Cj.SHb(bb.a.He("es-es")),Cj.JR(bb.a.He("en-029"),bb.a.He("en-us")),Cj.JR(bb.a.He("en-au"),bb.a.He("en-us")),Cj.JR(bb.a.He("en-bz"),bb.a.He("en-us")),Cj.JR(bb.a.He("en-ca"),bb.a.He("en-us")),Cj.JR(bb.a.He("en-gb"),bb.a.He("en-us")),Cj.JR(bb.a.He("en-id"),bb.a.He("en-us")),Cj.JR(bb.a.He("en-my"),bb.a.He("en-us")),Cj.JR(bb.a.He("en-ph"),bb.a.He("en-us")),Cj.JR(bb.a.He("zh-tw"),bb.a.He("en-us")),Cj.SHb(bb.a.He("fr-fr")),Cj.JR(bb.a.He("hr-ba"),bb.a.He("hr-hr")),
Cj.JR(bb.a.He("it-ch"),bb.a.He("it-it")),Cj.JR(bb.a.He("nb-no"),bb.a.He("nn-no")),Cj.SHb(bb.a.He("nl-nl")),Cj.JR(bb.a.He("ro-md"),bb.a.He("ro-ro")),Cj.JR(bb.a.He("ru-md"),bb.a.He("ru-ru")),Cj.JR(bb.a.He("sr-latn-ba"),bb.a.He("sr-latn-cs")),Cj.JR(bb.a.He("sr-latn-me"),bb.a.He("sr-latn-cs")),Cj.JR(bb.a.He("sr-latn-rs"),bb.a.He("sr-latn-cs")),Cj.SHb(bb.a.He("sr-cyrl-cs")),Cj.JR(bb.a.He("sv-fi"),bb.a.He("sv-se")));return Cj.mSb}static SHb(a){Cj.mSb[a.languageId]=a.LCID}static JR(a,b){Cj.mSb[a.LCID]=b.LCID}static Q6f(a){var b=
bb.a.He(a);if(!b)return 0;b=Cj.TDf[b.LCID]||Cj.TDf[b.languageId]||0;return b===a?0:b}}Cj.mSb=null;Object(m.a)(Cj,"AutoCorrectListFallback",null,[]);class ko{constructor(a,b,c,f,l){this.Ejf=!1;this.gmf=0;this.zOa=null;this.F6h=!1;this.amf=this.Unf=!0;this.Wif=null;this.fDc=!0;this.Lpb=a;this.AOa=b;this.t5a=c;this.H7=f;this.mh=l;this.cXb=a?a.innerText:Db.ParagraphReader.text(b)}get Cx(){throw Error.notImplemented("The inherit class should have the default value.");}set Cx(a){}get D4c(){return this.gmf}$yh(a){this.gmf=
a}get mb(){return this.zOa}set mb(a){this.zOa=a}get jig(){return this.Lpb}get keg(){return this.AOa}get KA(){return this.t5a}get KR(){return this.H7}get oIb(){return this.Unf}set oIb(a){this.Unf=a}get iog(){return this.Ejf}get $sg(){return!1}get voa(){return this.cXb}invoke(){this.Ejf=!0;if(this.Lpb&&this.Lpb.parentNode&&!this.Cx){var a=this.Lpb.innerText;if(this.oIb&&ma.a.substring(this.cXb,this.t5a,this.H7)!==ma.a.substring(a,this.t5a,this.H7))return 0;this.x9a(this.Lpb);this.$yh(this.Lpb.innerText.length-
a.length);return 1}this.fDc||mc.a.instance.Xb("MatchTextIsNotTheSame",{["Reason"]:"MatchTextIsNotTheSame"});if(!this.amf)return mc.a.instance.Xb("AbortedAction",{["Reason"]:this.Wif}),0;var b=Db.ParagraphReader.text(this.AOa);a=b.length;var c=this.cXb.length,f=ma.a.substring(this.cXb,this.t5a,this.H7).trimEnd();b=ma.a.substring(b,this.t5a,this.H7).trimEnd();f===b&&this.H7>c&&(this.H7=c);if(this.oIb&&f!==b)if(c=f.replace(RegExp('"',"g"),""),c===ma.a.substr(b,0,c.length))this.H7-=2;else return 0;if(N.a.instance.ga(50)&&
Rc.App.Mh.Bw&&NF.CoauthLockEditor.getInstance().AOb(ko.fj.l7b(this.AOa)))return 0;c=new pf.GraphTransaction(15);c.ld(this.AOa);c.fd=this.commandId;this.J8(this.AOa);this.$yh(Db.ParagraphReader.textLength(this.AOa)-a);this.zOa&&!this.F6h&&Mb.SelectionEditor.Dx(this.zOa)&&(b=this.zOa.Va,a=b.Sa,f=b.Mb,b=b.node,b===this.AOa&&this.D4c&&(a>=this.H7&&(a+=this.D4c),f>=this.H7&&(f+=this.D4c),this.zOa=Od.SelectionFactory.D3(b,a,f)));c.dispose();return 2}LPh(){this.fDc=this.yJf()}x9a(){}yJf(){var a=Db.ParagraphReader.text(this.AOa);
const b=ma.a.substring(this.cXb,this.t5a,this.H7).trimEnd();a=ma.a.substring(a,this.t5a,this.H7).trimEnd();return b===a}static get fj(){return bh.a.instance}}Object(m.a)(ko,"AutoCorrectAction",null,[1289]);class lo extends ko{constructor(a,b,c,f,l,y){super(a,b,c,f,y);this.pmf=null;this.Sna=l;this.GV=y}get IWa(){return this.pmf||(this.pmf=Ib.a.instance.qb("Box4.List.IListCommands"))}get jq(){return lo.fp||(lo.fp=Ib.a.instance.resolve("Box4.List.IListEditor"))}get Cx(){return!0}get commandId(){return C.a.OVd}set Cx(a){super.Cx=
a}}lo.fp=null;Object(m.a)(lo,"RegexCorrectAction",ko,[]);const xv={[0]:{"a)":{autonumberBulletType:2,Zi:[65533,4,41]},"a.":{autonumberBulletType:4,Zi:[65533,4,46]},"A.":{autonumberBulletType:5,Zi:[65533,3,46]},"1)":{autonumberBulletType:7,Zi:[65533,0,41]},"1.":{autonumberBulletType:8,Zi:[65533,0,46]},"i.":{autonumberBulletType:14,Zi:[65533,2,46]},"I.":{autonumberBulletType:15,Zi:[65533,1,46]}},[1]:{"*":{Zi:[8226],font:"Arial"},"-":{Zi:[45],font:"Calibri"},"--":{Zi:[167],font:"Wingdings"},">":{Zi:[216],
font:"Wingdings"},"<>":{Zi:[118],font:"Wingdings"}}};class Yo extends lo{constructor(a,b,c,f,l,y){super(a,b,c,f,l,y);Yo.WNa=y}get commandId(){return C.a.GVd}J8(a){if(this.IWa){var b=ob.GraphIterator.pb(a);b.kf();Za.OutlineElementNavigator.Te(b);var c=Yo.Uf.Gv(b),f=this.Sna[0];switch(ma.a.charAt(f,0)){case "*":var l=pe.a.NN(1,1);l.rsa="*";break;default:l=pe.a.NN(1,0)}c&&l.Pfe(c)||(c=new pf.GraphTransaction(15),c.Sy(b),b=this.zbj(l.listType,l.listStyle,f),null!=b&&this.IWa.nti(b)&&(ka.ULS.sendTraceTag(509747285,
393,50,"Found list insert matching string "+f),Yo.WNa.replaceTextRange(cb.a.createTextRange(a,this.KA,this.KR+1),"",!0,!1)),c.dispose())}}zbj(a,b,c){var f;let l=null===(f=null===xv||void 0===xv?void 0:xv[a])||void 0===f?void 0:f[c];if(null==l)return null;c=new J.DictionaryPropertySet;c.setValue(ee.a.zE,a);c.setValue(ee.a.Iea,b);c.setValue(ab.a.Zi,l.Zi);c.setValue(ab.a.font,l.font);return c}static get characterPropertiesEditor(){return Yo.WNa||(Yo.WNa=Ib.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Uf(){return Yo.fh||
(Yo.fh=Ib.a.instance.resolve("Box4.List.IListReader"))}static PC(a,b,c,f,l){return new Yo(null,a,b,c,f,l)}static pQ(a,b,c,f,l){return new Yo(a,rf.a(a).gb,b,c,f,l)}}Yo.WNa=null;Yo.fh=null;Object(m.a)(Yo,"BulletListAction",lo,[]);class eh extends lo{constructor(a,b,c,f,l,y){super(a,b,c,f,l,y);this.tVb=!1;this.Cx=!a;this.WNa=y;eh.Cl=new Uc.a}get Cx(){return this.tVb}set Cx(a){this.tVb=a}x9a(a){this.CYd(a.innerText,(b,c,f)=>{a.innerText=ma.a.substring(a.innerText,0,b)+f+ma.a.right(a.innerText,c)})}J8(a){this.CYd(Db.ParagraphReader.text(a).substring(this.KA,
this.KR),(b,c,f)=>{this.WNa.replaceTextRange(cb.a.createTextRange(a,this.KA+b,this.KA+c),f,!0,!1)})}CYd(a,b){if(!(2>this.Sna.length)&&this.Sna[1]){var c=this.Sna[1];eh.Cl.count||this.jgh();eh.Cl.Fb(c)&&(a=a.lastIndexOf(c),-1!==a&&b(a,a+c.length,eh.Cl.ga(c)))}}}eh.Cl=null;Object(m.a)(eh,"DictionarySequenceReplacerAction",lo,[]);class cx extends eh{constructor(a,b,c,f,l,y){super(a,b,c,f,l,y)}get commandId(){return C.a.y0b}jgh(){eh.Cl.$("--","\u2014");eh.Cl.$(" -- "," \u2013 ");eh.Cl.$(" - "," \u2013 ");
eh.Cl.$("-- ","\u2014");eh.Cl.$(" --"," \u2013");eh.Cl.$(" -"," \u2013")}static PC(a,b,c,f,l){return new cx(null,a,b,c,f,l)}static pQ(a,b,c,f,l){return new cx(a,rf.a(a).gb,b,c,f,l)}}Object(m.a)(cx,"DashAction",eh,[]);class du extends eh{constructor(a,b,c,f,l,y,H){super(a,b,c,f,l,y);this.Ca=H}get commandId(){return C.a.IVd}jgh(){eh.Cl.$(":)","\ud83d\ude0a");eh.Cl.$(":-)","\ud83d\ude0a");eh.Cl.$(":|","\ud83d\ude10");eh.Cl.$(":-|","\ud83d\ude10");eh.Cl.$(":(","\ud83d\ude41");eh.Cl.$(":-(","\ud83d\ude41");
eh.Cl.$(";)","\ud83d\ude09");eh.Cl.$(";-)","\ud83d\ude09");eh.Cl.$(":D","\ud83d\ude00");eh.Cl.$(":-D","\ud83d\ude00");eh.Cl.$(":')","\ud83d\ude02");eh.Cl.$("=D","\ud83d\ude03");eh.Cl.$(":>","\ud83d\ude06");eh.Cl.$(":->","\ud83d\ude06");eh.Cl.$(":3","\ud83d\ude0a");eh.Cl.$(":-3","\ud83d\ude0a");eh.Cl.$("B-)","\ud83d\ude0e");eh.Cl.$("*-*","\ud83d\ude0d");eh.Cl.$(":*","\ud83d\ude19");eh.Cl.$(":-*","\ud83d\ude19");eh.Cl.$(":X","\ud83d\ude36");eh.Cl.$(":-X","\ud83d\ude36");eh.Cl.$(":O","\ud83d\ude2e");
eh.Cl.$(":-O","\ud83d\ude2e");eh.Cl.$(":#","\ud83e\udd10");eh.Cl.$(":-#","\ud83e\udd10");eh.Cl.$(":P","\ud83d\ude1b");eh.Cl.$(":-P","\ud83d\ude1b");eh.Cl.$(";P","\ud83d\ude1c");eh.Cl.$(";-P","\ud83d\ude1c");eh.Cl.$(":-/","\ud83d\ude15");eh.Cl.$("$-$","\ud83e\udd11");eh.Cl.$(":S","\ud83d\ude16");eh.Cl.$(":-S","\ud83d\ude16");eh.Cl.$(":[","\ud83d\ude1f");eh.Cl.$(":-[","\ud83d\ude1f");eh.Cl.$(":\u2019(","\ud83d\ude22");eh.Cl.$(":'(","\ud83d\ude22");eh.Cl.$("@-@","\ud83d\ude31")}J8(a){this.CYd(Db.ParagraphReader.text(a).substring(this.KA,
this.KR),(b,c,f)=>{b=cb.a.createTextRange(a,this.KA+b,this.KA+c);c={};c.MenuItemId=f;this.Ca.ei(b,C.a.OPj,2,!1,null,c,null)})}static PC(a,b,c,f,l,y){return new du(null,a,b,c,f,l,y)}static pQ(a,b,c,f,l,y){return new du(a,rf.a(a).gb,b,c,f,l,y)}}Object(m.a)(du,"EmojiAction",eh,[]);class Zp{constructor(a,b,c,f){this.KK=a;this.yHc=b;this.llf=f;this.Wz=c}tqg(){if(!this.Wz)return!1;this.KK=this.KK.trimStart();return this.KK===this.Wz?!0:!1}r6j(){if(!this.KK)return!1;const a=this.KK.lastIndexOf(" ");return-1!==
a&&"."===this.KK.charAt(a-1)&&"."===this.KK.charAt(a-3)?!0:!1}q6j(){if(!this.KK)return!1;var a=this.KK.lastIndexOf(" ");return-1!==a&&(a=this.KK.substring(0,a-1).lastIndexOf(" "),"."===this.KK.charAt(a+2))?!0:!1}w_j(){return this.tqg()&&(1===this.Wz.length&&"."===this.yHc||"."===this.KK.charAt(1))?!0:!1}x_j(){return this.Wz?0<="\\/".indexOf(this.yHc)||3===this.Wz.length&&0<="\\/".indexOf(this.Wz.charAt(1))?!0:!1:!1}xZj(){return this.Wz?0<=this.Wz.indexOf("@")?!0:!1:!1}xt(){if(!this.Wz)return!1;for(const a of Zp.uee())if(ma.a.startsWith(this.Wz+
this.yHc,a))return!0;return!1}fZj(){return this.Wz?"i"===this.Wz&&0<=Zp.quotes.indexOf(this.yHc)?!0:!1:!1}zUj(){if(!this.KK)return!1;const a=ma.a.DGa(this.KK,this.KK.length-1);if(-1!==a&&this.KK.substring(a+1,this.KK.length)===this.Wz){const b=this.KK.charAt(a-1);if(0<=Zp.fZe.indexOf(b)||0<=Zp.quotes.indexOf(b)&&0<=Zp.fZe.indexOf(this.KK.charAt(a-2)))return!0}return!1}Jyi(){return!this.KK||this.r6j()||this.w_j()||this.x_j()||this.q6j()||this.xZj()||this.xt()?!1:this.tqg()||this.fZj()||this.zUj()?
!0:!1}static uee(){return Zp.omf||(Zp.omf="http: https: ftp:// mailto: \\\\ www.".split(" "))}}Zp.fZe=".!?";Zp.quotes="'\"";Zp.omf=null;Object(m.a)(Zp,"FirstLetterUpperCaseRules",null,[]);class zq{constructor(a){this.Wz=a}a8i(){if(!this.Wz)return null;for(let a=0;a<zq.wdg().length;a++)if(this.Wz===zq.wdg()[a])return zq.zxj()[a];return null}static wdg(){return zq.Wgf||(zq.Wgf=["1/2","1/4","3/4"])}static zxj(){return zq.Vgf||(zq.Vgf=["\u00bd","\u00bc","\u00be"])}}zq.Wgf=null;zq.Vgf=null;Object(m.a)(zq,
"FractionsCollection",null,[]);class WA extends ko{constructor(a,b,c,f,l,y){super(a,b,c,f,y);this.cTb=l;this.GV=y}get Cx(){return!0}get commandId(){return C.a.JVd}x9a(a){a.innerText=ma.a.substring(a.innerText,0,this.KA)+this.cTb+ma.a.right(a.innerText,this.KR)}J8(a){this.GV.replaceTextRange(cb.a.createTextRange(a,this.KA,this.KR),this.cTb,!0,!1)}set Cx(a){super.Cx=a}static PC(a,b,c,f,l){return new WA(null,a,b,c,f,l)}}Object(m.a)(WA,"FractionsReplaceCorrectAction",ko,[]);class Xs extends lo{constructor(a,
b,c,f,l,y){super(a,b,c,f,l,y)}get commandId(){return C.a.LVd}J8(a){if(this.IWa){var b=ob.GraphIterator.pb(a);b.kf();Za.OutlineElementNavigator.Te(b);var c=this.Sna[0],f=Xs.uzk(c),l=ma.a.Fcc(c.charAt(0))?4:2,y=cb.a.createTextRange(a,this.KA,this.KR+1);this.jq.cRa(a,b,l,f,y,c,this.IWa)}}static PC(a,b,c,f,l){return new Xs(null,a,b,c,f,l)}static pQ(a,b,c,f,l){return new Xs(a,rf.a(a).gb,b,c,f,l)}static uzk(a){if(!a)return 0;a=ma.a.rg(a);if(!ma.a.h0c(a.charAt(0)))return 0;const b=a.charCodeAt(0)-97+1;let c;
for(c=1;c<a.length&&a.charAt(c)===a.charAt(0);c++);return 26*(c-1)+b}}Object(m.a)(Xs,"LetterListAction",lo,[]);class dx extends lo{constructor(a,b,c,f,l,y){super(a,b,c,f,l,y)}get commandId(){return C.a.cRa}J8(a){if(this.IWa){var b=ob.GraphIterator.pb(a);b.kf();Za.OutlineElementNavigator.Te(b);var c=this.Sna[0],f=parseInt(c);if(!(99999999<=f)){var l=cb.a.createTextRange(a,this.KA,this.KR+1);this.jq.cRa(a,b,1,f,l,c,this.IWa)}}}static PC(a,b,c,f,l){return new dx(null,a,b,c,f,l)}static pQ(a,b,c,f,l){return new dx(a,
rf.a(a).gb,b,c,f,l)}}Object(m.a)(dx,"NumberListAction",lo,[]);class $p extends ko{constructor(a,b,c,f,l){super(a,b,c,f,l);$p.GV=l}get Cx(){return!0}get commandId(){return C.a.MVd}x9a(){}J8(a){const b=cb.a.createTextRange(a,this.KR-2,this.KR),c=new pf.GraphTransaction(15);c.ld(a);let f=!1,l=null,y=0;for(;y<a.Ta.length;){var H=a.Ta.ga(y),Q=!!H.To||H.Bea;let ia=!!H.fieldRangeEnd||H.V_;if(H.cp>=b.Sa){H.cp>b.Sa||!H.formatting?l=f?H.formatting:$p.GV.Tga(a,y,b.Sa,l):(l=H.formatting,ia&&(f=!1),Q&&(f=!0));
y++;break}H.formatting&&(l=H.formatting);ia&&(f=!1);Q&&(f=!0);y++}for(;y<a.Ta.length;){Q=a.Ta.ga(y);if(Q.cp>=b.Mb){if(Q.cp>b.Mb||!Q.formatting&&!Q.Vj)f||$p.GV.Tga(a,y,b.Mb,l);f||$p.oh.UY(l,!0);break}Q.formatting&&(f||$p.oh.UY(l,!0),l=Q.formatting);H=!!Q.To||Q.Bea;Q=!!Q.fieldRangeEnd||Q.V_;H&&(f=!0);!H&&Q&&(f=!1);y++}c.dispose()}set Cx(a){super.Cx=a}static get oh(){return $p.If||($p.If=Ib.a.instance.resolve("Box4.IFormattingEditor"))}static PC(a,b,c,f){return new $p(null,a,b,c,f)}}$p.GV=null;$p.If=
null;Object(m.a)($p,"OrdinalsReplaceCorrectAction",ko,[]);class wl extends lo{constructor(a,b,c,f,l,y){super(a,b,c,f,l,y);wl.$qb||wl.kBl();this.WNa=y}get commandId(){return C.a.NVd}J8(a){if(!a.VGj){var b=this.zOa.Va.node===a,c=-1,f=3;this.Sna[2]&&(c=parseInt(this.Sna[2]));this.Sna[1]&&(f=parseInt(this.Sna[1]));if(!(20<c||100<f)){a.jH().graphTransactionOperations.tja(7);var l=ob.GraphIterator.pb(a);l.kf();Za.OutlineElementNavigator.Te(l);wl.Wh.nea(l,!1,!1);wl.Wh.nda(l);for(let Q=0;Q<f;++Q){const ia=
[];var y=Q%wl.$qb.length,H=0<c?c:wl.$qb[y].length;for(let wa=0;wa<H;++wa)Array.add(ia,wl.$qb[y][wa%wl.$qb[y].length]);y=cb.a.Lj(l.currentNode,0);H=tb.a.Bs(y);2!==Rc.App.mode?wl.oh.u1a(H,1142):wl.oh.Pm(H,Ab.a.noProof,!0);this.WNa.replaceTextRange(y,ia.join(" "),!0,!1);Q<f-1&&(Za.OutlineElementNavigator.Te(l),wl.Wh.nea(l,!1,!1),wl.Wh.nda(l))}c=l.currentNode;l=ob.GraphIterator.pb(a);l.kf();Za.OutlineElementNavigator.Te(l);l.Ni();b&&(this.zOa=Od.SelectionFactory.Qg(c,Db.ParagraphReader.textLength(c)))}}}static get Wh(){return wl.Ji||
(wl.Ji=Ib.a.instance.resolve("Box4.IOutlineElementEditor"))}static get oh(){return wl.If||(wl.If=Ib.a.instance.resolve("Box4.IFormattingEditor"))}static kBl(){wl.$qb=[["Lorem ipsum dolor sit amet, consectetuer adipiscing elit.","Maecenas porttitor congue massa.","Fusce posuere, magna sed pulvinar ultricies, purus lectus malesuada libero, sit amet commodo magna eros quis urna."],["Nunc viverra imperdiet enim.","Fusce est.","Vivamus a tellus."],["Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.",
"Proin pharetra nonummy pede.","Mauris et orci."]]}static PC(a,b,c,f,l){return new wl(null,a,b,c,f,l)}static pQ(a,b,c,f,l){return new wl(a,rf.a(a).gb,b,c,f,l)}}wl.$qb=null;wl.Ji=null;wl.If=null;Object(m.a)(wl,"RandAction",lo,[]);class XF{constructor(a,b,c,f){this.pattern=f&8?new RegExp(a,"i"):new RegExp(a);this.AJj=b;this.uyj=c;this.flags=f}}Object(m.a)(XF,"RegexAutoCorrectEntry",null,[]);class Bn extends lo{constructor(a,b,c,f,l,y){super(a,b,c,f,l,y)}get commandId(){return C.a.PVd}J8(a){if(this.IWa){var b=
ob.GraphIterator.pb(a);b.kf();Za.OutlineElementNavigator.Te(b);var c=this.Sna[0],f=ma.a.substring(c,0,c.indexOf("."));f=Bn.vzk(f);if(!(0>=f)){var l=ma.a.Fcc(c.charAt(0))?5:3,y=cb.a.createTextRange(a,this.KA,this.KR+1);this.jq.cRa(a,b,l,f,y,c,this.IWa)}}}static PC(a,b,c,f,l){return new Bn(null,a,b,c,f,l)}static pQ(a,b,c,f,l){return new Bn(a,rf.a(a).gb,b,c,f,l)}static t_i(){Bn.qra||(Bn.qra={},Bn.qra.M=1E3,Bn.qra.D=500,Bn.qra.C=100,Bn.qra.L=50,Bn.qra.X=10,Bn.qra.V=5,Bn.qra.I=1)}static vzk(a){if(!a)return 0;
Bn.t_i();a=ma.a.nC(a);let b=0,c=0;for(let f=a.length-1;0<=f;f--){const l=Bn.qra[ma.a.charAt(a,f).toString()];c=l<b?c-l:c+l;b=l}return c}}Bn.qra=null;Object(m.a)(Bn,"RomanListAction",lo,[]);class ex extends ko{constructor(a,b,c,f,l,y){super(a,b,c,c+1,y);this.GV=y;this.F9h=f;this.Edf=l;this.oIb=!1}get Cx(){return!1}get commandId(){return C.a.toi}x9a(a){a.innerText=ma.a.substring(a.innerText,0,this.KA)+this.Edf+ma.a.right(a.innerText,this.KR)}J8(a){this.GV.replaceTextRange(cb.a.createTextRange(a,this.KA,
this.KR),this.F9h,!0,!1);this.GV.replaceTextRange(cb.a.createTextRange(a,this.KA,this.KA+1),this.Edf,!0,!1)}set Cx(a){super.Cx=a}static PC(a,b,c,f,l,y){if("'"!==c&&'"'!==c)return null;var H=ob.GraphIterator.pb(a);H.kf();Za.OutlineElementNavigator.Te(H);if(Wd.OutlineElementReader.Gm(H.currentNode))return null;f=!b||ma.a.Kqe(f)||-1!==Array.indexOf(ex.uJk,f);H="'"===c;return new ex(y,a,b,c+"",f?H?"\u2018":"\u201c":H?"\u2019":"\u201d",l)}}ex.uJk=["[","{","("];Object(m.a)(ex,"SmartQuoteCorrectAction",
ko,[]);class Ys extends ko{constructor(a,b,c,f,l,y){super(a,b,c,f,y);this.cTb=l;this.GV=y}get Cx(){return Ys.tVb}set Cx(a){Ys.tVb=a}get commandId(){return C.a.RVd}LPh(){this.fDc=this.yJf();this.fDc||(this.amf=!1,this.Wif="MatchTextIsNotTheSame")}x9a(a){a.innerText=ma.a.substring(a.innerText,0,this.KA)+this.cTb+ma.a.right(a.innerText,this.KR)}J8(a){this.GV.replaceTextRange(cb.a.createTextRange(a,this.KA,this.KR),this.cTb,!0,!1)}static pQ(a,b,c,f,l){const y=rf.a(a);return new Ys(a,y?y.gb:null,b,c,f,
l)}static PC(a,b,c,f,l){return new Ys(null,a,b,c,f,l)}}Ys.tVb=!1;Object(m.a)(Ys,"StringReplaceCorrectAction",ko,[]);class Fy extends ko{constructor(a,b,c,f,l,y,H,Q){super(a,b,c,f,l);this.GV=l;this.ZD=y;this.p0h=H;this.cE=Q}get Cx(){return!0}get commandId(){return C.a.TVd}x9a(a){let b=ma.a.substring(a.innerText,this.KA,this.KR);b.charAt(0)!==b.charAt(0).toUpperCase()&&(b=b.charAt(0).toUpperCase()+b.substring(1,b.length));a.innerText=ma.a.substring(a.innerText,0,this.KA)+b+ma.a.right(a.innerText,this.KR)}J8(a){const b=
this.KA,c=this.KA+1,f=a.characterData.substring(b,c).charAt(0);ma.a.Fcc(f)||(a=cb.a.createTextRange(a,b,c),this.QUj(a)||this.GV.replaceTextRange(a,f.toUpperCase().toString(),!0,!1))}QUj(a){return this.p0h?!!this.ZD&&this.ZD.Xua(a):!1}set Cx(a){super.Cx=a}static pQ(a,b,c,f){const l=rf.a(a);return new Fy(a,l?l.gb:null,b,c,f,null,!1,null)}static PC(a,b,c,f,l,y,H){return new Fy(null,a,b,c,f,l,y,H)}}Object(m.a)(Fy,"UpperFirstLetterAutoCorrect",ko,[]);class Vr{constructor(a,b){this.llf=b;this.Wz=a}QSl(){const a=
Number.parseInvariant(this.Wz.substring(0,this.Wz.length-2));switch(Number.parseInvariant(this.Wz.charAt(this.Wz.length-3).toString())){case 1:return 11===a?"th":"st";case 2:return 12===a?"th":"nd";case 3:return 13===a?"th":"rd";case 4:case 5:case 6:case 7:case 8:case 9:case 0:return"th";default:return""}}H_j(){var a=bb.a.He(this.llf);if(!a||!a.name.toLowerCase().startsWith("en")||!this.Wz||2>=this.Wz.length)return!1;for(a=0;a<Vr.TXc().length;a++)if(this.Wz.toLowerCase().endsWith(Vr.TXc()[a])){if(RegExp("^\\d+$").test(this.Wz.substr(0,
this.Wz.length-2))){const b=this.QSl();if(this.Wz.toLowerCase().endsWith(Vr.TXc()[a])&&b===Vr.TXc()[a])return!0}break}return!1}static TXc(){return Vr.$of||(Vr.$of=["st","nd","rd","th"])}}Vr.$of=null;Object(m.a)(Vr,"ValidateOrdinalsRule",null,[]);class an{constructor(a,b,c,f,l,y,H){this.Z5a=[];this.rob=[];this.lSb=[];this.kBd=[];this.Pqa=-1;this.pif=this.Y2=this.CAc=!1;this.LBc=a;this.mh=b;this.ZD=c;this.Ca=f;this.rS=y;this.cE=H;l?(this.CAc=l.ka("WordEditorEmoticonAutoCorrectIsEnabled")||l.ka("OneNoteInsertEmojiIsEnabled"),
this.Y2=l.ka("ReplaceQuoteWithSmartQuoteIsEnabled"),this.pif=l.ka("HyperlinkUrlValidationIsEnabled"),ka.ULS.sendTraceTag(23418953,324,50,"{0}",{["WordEditorEmoticonAutoCorrectIsEnabled"]:this.CAc,["ReplaceQuoteWithSmartQuoteIsEnabled"]:this.Y2})):(ka.ULS.sendTraceTag(23418954,324,50,"appSettingsManager is null.  Auto correct is disabled for: emoticons and smart quotes."),this.Y2=this.CAc=!1)}bne(a){return 0<=an.HVd.indexOf(a)}f5j(a){return 0<=an.SVd.indexOf(a)}Cpg(a){return a.toLowerCase()===a}Fcc(a){return a.toUpperCase()===
a}h0c(a){return a.toLowerCase()!==a.toUpperCase()}IWj(a,b,c,f){return(new Zp(a,b,c,f)).Jyi()}rej(a){do{if(a.getAttribute("xml:lang"))return bb.a.He(a.getAttribute("xml:lang"))||bb.a.gac;if(a.getAttribute("lang"))return bb.a.He(a.getAttribute("lang"))||bb.a.gac;a=a.parentNode}while(a&&1===a.nodeType);return bb.a.gac}l$d(a){return bb.a.He(tb.a.language(tb.a.Bs(a)))||bb.a.gac}KSc(a,b){0>b&&(b=0);let c=-1;const f=an.HVd.length;for(let l=0;l<f;++l){const y=a.lastIndexOf(ma.a.charAt(an.HVd,l),b);y>c&&(c=
y)}a=ma.a.DGa(a,b);a>c&&(c=a);return c}C4i(a){for(let b=0;b<a.length;++b)if(this.h0c(ma.a.charAt(a,b)))return b;return-1}B0f(a,b){if(!a||0>b)return-1;let c=b;c=c?this.KSc(a,c-1):-1;c=c>ma.a.DGa(a,b-1)?c:ma.a.DGa(a,b-1);c++;return c}u0f(a,b,c){if(!N.a.instance.ga(70))return null;this.t5b(b);if(!this.rob[b])if(b=Cj.Q6f(b),0<b){if(this.t5b(b),!this.rob[b])return null}else return null;if(c&&this.lSb[b]&&Array.contains(this.lSb[b],a+c))return null;c=this.rob[b][ma.a.rg(a)];if("string"!==typeof c||c===
a)return null;if(c){var f=this.C4i(a);if(0>f||this.Cpg(ma.a.charAt(a,f)))return c;b=!0;for(f+=1;f<a.length;++f){const l=ma.a.charAt(a,f);b&&!this.Fcc(l)&&(b=!1)}return b?ma.a.nC(c):ma.a.nC(ma.a.substring(c,0,1))+ma.a.right(c,1)}return null}K4i(a,b,c,f){pb.a.mark(4666);const l=this.rej(b).LCID;let y=0,H=a;const Q=b.innerText;var ia=Q.lastIndexOf(" ",a);if(this.vne(Q.substring(ia+1,a)))return pb.a.mark(4667),null;ia=null;var wa=!1;do{H=H?this.KSc(Q,H-1):-1;if(-1===H&&!c){wa=b;var Ua=null;if(!this.bne(Q.charAt(0))){do{for(;wa&&
!wa.previousSibling;)wa=wa.parentNode;wa&&(wa=wa.previousSibling,Ua=wa.innerText)}while(wa&&!Ua);if(wa&&Ua&&!this.bne(ma.a.charAt(Ua,Ua.length-1)))return pb.a.mark(4667),null}wa=!0}Ua=ma.a.substring(Q,H+1,a);++y;var kb=this.u0f(Ua,l,f.toString());if(kb)ia=Ys.pQ(b,H+1,a,kb,this.mh);else for(kb=0;kb<this.Z5a.length;++kb){const Gb=this.Z5a[kb];if(!(Gb.flags&1&&!(c&&1>H)||Gb.flags&4||Gb.flags&2&&" "!==f)){const ec=Gb.pattern.exec(Ua);if(ec){ia=Gb.AJj(b,H+1,a,ec,this.mh,this.Ca);break}}}}while(!wa&&!ia&&
y<an.e3g&&0<=H);pb.a.mark(4667);return ia}G4i(a,b,c){const f=a.node;let l=Db.ParagraphReader.text(f);0>b&&(b=a.Sa);a=this.l$d(a).LCID;if(this.vne(l.substring(ma.a.DGa(l,b)+1,b)))return null;var y=-1,H=wb.HyperlinkReader.D7b(f);for(var Q=0;Q<H.length;Q++)if(b>H[Q].Mb)y=H[Q].Mb;else{if(b>H[Q].Sa)return null;break}H=null;Q=(Q=b)?this.KSc(l,Q-1):-1;Q<y&&(Q=y-1);y=ma.a.substring(l,Q+1,b);y=y.trimStart();if(1>Q)for(let ia=0;ia<this.Z5a.length;++ia){const wa=this.Z5a[ia];let Ua=l;" "!==c&&(Ua=l+c);if(wa.pattern.exec(Ua))return null}l=
l.substring(0,b);if(!this.IWj(l,c.toString(),y,a))return null;y.charAt(0).toUpperCase()!==y.charAt(0)&&(H=Fy.PC(f,Q+1,b,this.mh,this.ZD,N.a.instance.ga(14),this.cE));return H}Z_f(a,b,c){a=Od.SelectionFactory.Aj(a,!1);if(!a)return null;a=a.jf;return Mb.SelectionEditor.Xg(a)?this.G4i(a,b,c):null}vne(a){return ma.a.C9(a)}w7d(a,b,c,f){pb.a.mark(4666);const l=a.node,y=this.l$d(a).LCID,H=Db.ParagraphReader.text(l);0>b&&(b=a.Sa);if(c&&!this.bne(ma.a.charAt(H,b))||this.vne(H.substring(ma.a.DGa(H,b)+1,b)))return pb.a.mark(4667),
null;a=-1;c=wb.HyperlinkReader.D7b(l);for(var Q=0;Q<c.length;Q++)if(b>c[Q].Mb)a=c[Q].Mb;else{if(b>c[Q].Sa)return null;break}c=0;Q=b;let ia=null;do{Q=Q?this.KSc(H,Q-1):-1;Q<a&&(Q=a-1);const Ua=ma.a.substring(H,Q+1,b);++c;var wa=this.u0f(Ua,y,f==B.a.nNa?".":null);if(wa)this.rS.kkb&&(ia=Ys.PC(l,Q+1,b,wa,this.mh));else for(wa=0;wa<this.Z5a.length;++wa){const kb=this.Z5a[wa];if(!(kb.flags&1&&!(0>Q)||kb.flags&4&&f!==B.a.Dp||kb.flags&2&&f!==B.a.zK)){const Gb=kb.pattern.exec(Ua);if(Gb){ia=kb.uyj(l,Q+1,b,
Gb,this.mh,this.Ca);if(ia.commandId!==C.a.y0b&&!this.rS.kkb||ia.commandId===C.a.y0b&&!this.rS.lrc)ia=null;break}}}}while(0<=Q&&Q>=a&&!ia&&c<an.e3g);pb.a.mark(4667);return ia}Y_f(a,b,c){a=Od.SelectionFactory.Aj(a,!1);if(!a)return null;a=a.jf;return Mb.SelectionEditor.Xg(a)?this.w7d(a,b,!1,c):null}e0f(a,b){a=Od.SelectionFactory.Aj(a,!1);if(!a)return null;a=a.jf;if(!Mb.SelectionEditor.Xg(a)||wb.HyperlinkReader.Hla(a,!1))return null;var c=Db.ParagraphReader.text(a.node);const f=0<b?ma.a.DGa(c,b-1)+1:
ma.a.DGa(c,c.length-1)+1;b=0<b?b:c.length;c=ma.a.substring(c,f,b);return!c||this.pif&&!wb.HyperlinkReader.Fqe(c)||!ma.a.C9(c)&&!ma.a.Nac(c)||!an.hyperlinkEditor.B6k(a,f,b)?null:this.LBc.FLi(a.node,f,b)}i0f(a,b){var c=Od.SelectionFactory.Aj(a,!1);if(!c)return null;var f=c.jf;if(!Mb.SelectionEditor.Xg(f))return null;0>b&&(b=f.Sa);var l=Db.ParagraphReader.text(f.node);c=this.B0f(l,b);const y=an.SVd.length;for(let H=0;H<y;++H){const Q=l.lastIndexOf(ma.a.charAt(an.SVd,H),b-1);Q>c&&(c=Q+1)}l=ma.a.substring(l,
c,b);if(!l)return null;f=this.l$d(f).LCID;return(new Vr(l,f)).H_j()?$p.PC(a,c,b,this.mh):null}X_f(a,b){var c=Od.SelectionFactory.Aj(a,!1);if(!c)return null;c=c.jf;if(!Mb.SelectionEditor.Xg(c))return null;0>b&&(b=c.Sa);var f=Db.ParagraphReader.text(c.node);c=this.B0f(f,b);f=ma.a.substring(f,c,b);return f?(f=(new zq(f)).a8i())?WA.PC(a,c,b,f,this.mh):null:null}p5i(a,b,c,f,l){var y=Od.SelectionFactory.Aj(a,!1);if(!y)return null;y=y.jf;if(c>b||!Mb.SelectionEditor.Xg(y))return null;0>b&&(b=y.Sa);if(0>b)return null;
y=Db.ParagraphReader.text(y.node);return ex.PC(a,c,l,b?y.charAt(b-1):"\x00",this.mh,f)}yCa(a,b,c,f){Array.add(this.Z5a,new XF("^"+a+"$",b,c,f))}BIe(a){if(this.rob[this.Pqa]){const b=this.rob[this.Pqa];for(let c in a)b[c]=a[c]}else this.rob[this.Pqa]=a}CIe(a){this.lSb[this.Pqa]?Array.addRange(this.lSb[this.Pqa],a):this.lSb[this.Pqa]=a}LWe(){this.Pqa=-1}QVd(){this.BZi(this.Pqa);this.Pqa=-1}w9j(a,b){this.kBd[b]||(this.kBd[b]=!0,this.Pqa=b,b=document.createElement("script"),b.type="text/javascript",b.src=
a,b.setAttribute("onload","ResetListLcid();"),b.setAttribute("onerror","AutoCorrectRulesFallbackLogic();"),document.body.appendChild(b))}BZi(a){a=Cj.Q6f(a);0<a&&this.t5b(a)}G9j(){N.a.instance.ga(70)&&(this.t5b(1033),this.yCa("=rand\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",wl.pQ,wl.PC,5),this.yCa("(\\d+)[\\.|\\)]",dx.pQ,dx.PC,3),this.yCa("(L|l|C|c|D|d|M|m){1}\\.",Xs.pQ,Xs.PC,3),this.yCa("^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})\\.",Bn.pQ,Bn.PC,11),this.yCa("([A-Za-z]){1}[\\.|\\)]",Xs.pQ,Xs.PC,
3),this.yCa("\\*{1}$|^\\-{1,2}$|^>{1}$|^<>",Yo.pQ,Yo.PC,3),this.yCa("[\\w\\d]+( ?\\-{1,2} ?)[\\w\\d]+",cx.pQ,cx.PC,0),this.CAc&&(this.yCa("(?:.*)([\\:\\;\\=][\\'\\-]??[DOPSX3>\\(\\)\\*#\\|\\[\\/])",du.pQ,du.PC,0),this.yCa("(?:.*)([\\@\\*\\$][\\-][\\@\\*\\$])",du.pQ,du.PC,0)))}t5b(a){this.kBd[a]||this.w9j(Ey.a.xqi(String.format("Acl/Acl{0}.js",a)),a)}static get hyperlinkEditor(){return an.In||(an.In=Ib.a.instance.resolve("Box4.IHyperlinkEditor"))}}an.HVd=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014";
an.SVd=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014/\\.!?\"'";an.fZe=".!?";an.e3g=5;an.In=null;Object(m.a)(an,"AutoCorrectRules",null,[1216]);class XA{constructor(a,b,c,f,l,y){this.Sqa=this.CF=null;this.EK=a;this.Uc=b;this.qd=c;this.Gbf=f.ka("AutoCorrectFirstLetterUpperCaseEnabled");this.Jbf=f.ka("AutoFormatOrdinalNumberAndFractionsEnabled");this.Y2=f.ka("ReplaceQuoteWithSmartQuoteIsEnabled");this.rca=l;this.zAa=!!y;this.gt=y;this.D5h=new hr.a;this.zAa&&this.Uc.fE(Object(I.a)(this,
this.iJb,"onSetSelectionFinished"))}Cwc(a,b,c=-1){if(this.rca.kkb||this.rca.lrc)if(b=this.EK.e0f(a,c)||this.EK.Y_f(a,c,b))this.CF||(this.CF=new oc),this.CF.ya(b);this.Gbf&&this.rca.WLc&&(b=this.EK.Z_f(a,c," "))&&(this.CF||(this.CF=new oc),0<this.CF.HGa&&(this.CF.Mta(0).Cx=!0,b.oIb=!1),this.CF.ya(b));this.Jbf&&(this.rca.wpd&&4!==Rc.App.mode&&(b=this.EK.i0f(a,c))&&(this.CF||(this.CF=new oc),this.CF.ya(b),ka.ULS.sendTraceTag(8271383,324,50,"Ordinal number autoformat action is created.")),this.rca.upd&&
(a=this.EK.X_f(a,c))&&(this.CF||(this.CF=new oc),this.CF.ya(a),ka.ULS.sendTraceTag(8271384,324,50,"Fractions autoformat action is created.")))}xOf(a,b,c,f,l,y){const H=new oc;if(0<b){if(!this.Gbf&&this.rca.kkb){var Q=this.EK.K4i(c,f,l,y);Q&&H.ya(Q)}else{if(this.rca.kkb||this.rca.lrc)if(Q=0," "===y?Q=B.a.zK:"."===y&&(Q=B.a.nNa),Q=this.EK.Y_f(a,b,Q))Q.Cx=!0,H.ya(Q);this.rca.WLc&&(Q=this.EK.Z_f(a,b,y))&&(0<H.HGa&&(Q.oIb=!1),H.ya(Q))}this.Jbf&&(this.rca.wpd&&4!==Rc.App.mode&&(Q=this.EK.i0f(a,b))&&(H.ya(Q),
ka.ULS.sendTraceTag(8704786,324,50,"Ordinal number autoformat action is created.")),this.rca.upd&&(Q=this.EK.X_f(a,b))&&(H.ya(Q),ka.ULS.sendTraceTag(8271385,324,50,"Fractions autoformat action is created.")))}0<=b&&("'"===y||'"'===y)&&this.Y2&&this.rca.fWe&&(Q=this.EK.p5i(a,b,c,f,y))&&(H.ya(Q),ka.ULS.sendTraceTag(37363807,324,50,"Smart quote action is created."));for(let ia of this.D5h.values)if((Q=ia.xOf(a,b,c,f,l,y))&&!Q.isEmpty())for(let wa=0;wa<Q.HGa;wa++)H.ya(Q.Mta(wa));return H}XHe(a,b){return this.EK.e0f(a,
b)}nuh(a){this.CF||(this.CF=new oc);this.CF.ya(a)}ERj(a){if(this.CF){var b=!1;for(var c=0;c<this.CF.HGa;c++){var f=this.CF.Mta(c);if(!f)return;if(!f.iog){b=!0;break}}if(b){b=this.Sqa=null;c=new pf.GraphTransaction(15);c.fd=a;a=!1;for(f=0;f<this.CF.HGa;f++){let l=this.CF.Mta(f);if(!l)return;if(l.iog)continue;this.zAa&&l.Cx&&l.$sg&&(b=l);a||(a=!0,c.ld(l.keg));l.mb=this.Uc.Pa.mb;const y=this.qd.Zp(l.commandId);l.invoke();y.end();this.Uc.setSelection(l.mb)}this.CF=null;this.Sqa=b?b.commandId:null;a&&
c.dispose()}}}FRj(a){this.Sqa=null;const b=new pf.GraphTransaction(15);b.ld(a.keg);b.fd=a.commandId;a.mb=this.Uc.Pa.mb;const c=this.qd.Zp(a.commandId);a.invoke();c.end();this.Uc.setSelection(a.mb);this.zAa&&a.Cx&&a.$sg&&(this.Sqa=a.commandId);b.dispose()}GRj(a){this.Sqa=null;return a.invoke()}ZHj(){return this.zAa&&!!this.Sqa}ZAk(a){if(!this.zAa||!this.Sqa)return!1;const b=this.Sqa;this.Sqa=null;if(!a||!this.gt.XW||this.gt.d2d!==b)return!1;this.gt.undo();return!0}iJb(){this.Sqa=null}}Object(m.a)(XA,
"AutoCorrectScheduler",null,[1215]);class Wr extends ko{constructor(a,b,c,f,l,y){super(a,b,c,f,l);this.$pf=this.O2=null;this.GV=l;this.hd=y}get s9(){return this.O2||(this.O2=Ib.a.instance.qb("Box4.IInternalLinkManager"))}get rgh(){return this.$pf||(this.$pf=Ib.a.instance.qb("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy"))}get Cx(){return!0}get commandId(){return C.a.KVd}J8(a){pb.a.mark(7012);const b=new pf.GraphTransaction(15);b.ld(a);var c=this.KA,f=this.KR,l=Db.ParagraphReader.text(a),y=l.substring(c,
f);const H=({Xlc:Q}=ma.a.X3e(y)).returnValue;y!==H&&(c+=Q,f=c+H.length);y=cb.a.createTextRange(a,c,f);var Q=l.substring(c,f);Wr.BYj(l,c,f)&&(this.GV.replaceTextRange(cb.a.createTextRange(a,c-1,f+1),Q,!0,!1),--c,--f,y=cb.a.createTextRange(a,c,f),c=Od.SelectionFactory.Qg(a,f),ge.a.instance.setSelection(c));c=wb.HyperlinkReader.aFa(Q);Wr.hyperlinkEditor.Sja(y,c,!1);l=Q="";f=!1;this.s9&&({hnh:Q,q8i:l}=this.s9.mKh(c,!0)).returnValue&&(c=Q,f=!0,Q=wb.HyperlinkReader.WC(y,!1),Wr.hyperlinkEditor.YM(Q[0].paragraph,
Q[0].hyperlink),""!==l&&(this.GV.replaceTextRange(y,l,!0,!1),y=cb.a.createTextRange(a,this.KA,this.KA+l.length),a=Od.SelectionFactory.Qg(a,this.KA+this.KA+l.length),ge.a.instance.setSelection(a)),Wr.hyperlinkEditor.Sja(y,c,!1));b.dispose();!f&&this.rgh&&this.rgh.eYl(y,c);pb.a.mark(7013)}set Cx(a){super.Cx=a}static get hyperlinkEditor(){return Wr.In||(Wr.In=Ib.a.instance.resolve("Box4.IHyperlinkEditor"))}static BYj(a,b,c){c=c!==a.length&&('"'===a.charAt(c)||"\u201d"===a.charAt(c));return!!b&&('"'===
a.charAt(b-1)||"\u201c"===a.charAt(b-1))&&c}}Wr.In=null;Object(m.a)(Wr,"HyperlinkAction",ko,[]);class YA{constructor(a,b){this.mh=a;this.hd=b}FLi(a,b,c){return new Wr(null,a,b,c,this.mh,this.hd)}}Object(m.a)(YA,"Factory",null,[1214]);class ZA{constructor(){this.Da=null}get name(){return"Box4.AutoCorrect"}Yb(a){this.Da=a;a.register(an,"Box4.AutoCorrect.AutoCorrectRules").as("Box4.IAutoCorrectRules").ma().oa(()=>new an(a.resolve("Box4.IHyperlinkActionFactory"),a.resolve("Box4.ICharacterPropertiesEditor"),
bh.a.instance,w.AFrameworkApplication.Ra,w.AFrameworkApplication.fa,a.resolve("Box4.IAutoCorrectOptionsInfo"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance));a.register(VA,"Box4.AutoCorrect.AutoCorrectOptionsInfo").as("Box4.IAutoCorrectOptionsInfo").ma().oa(()=>new VA(a.resolve("Box4.IRoamingServiceRequestManager"),w.AFrameworkApplication.fa.ka("ReplaceQuoteWithSmartQuoteIsEnabled")));a.register(XA,"Box4.AutoCorrect.AutoCorrectScheduler").as("Box4.IAutoCorrectScheduler").ma().oa(()=>
new XA(a.resolve("Box4.IAutoCorrectRules"),ge.a.instance,mc.a.instance,w.AFrameworkApplication.fa,a.resolve("Box4.IAutoCorrectOptionsInfo"),w.AFrameworkApplication.fa.ka("AutoCorrectUndoByBackspaceIsEnabled")?a.resolve("Box4.IUndoManager"):null));a.register(YA,"Box4.AutoCorrect.HyperlinkAction.Factory").as("Box4.IHyperlinkActionFactory").ma().oa(()=>new YA(a.resolve("Box4.ICharacterPropertiesEditor"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance))}init(){this.Da.resolve("Box4.IAutoCorrectRules").G9j();
const a=w.AFrameworkApplication.fa;a.ka("AutoCorrectOptionSettingIsEnabledForWordOnline")&&a.ka("IsRoamingServiceEnabled")&&this.Da.resolve("Box4.IAutoCorrectOptionsInfo").Naj()}dispose(){}static main(){n.a.instance.Ac(new ZA)}}Object(m.a)(ZA,"Box4AutoCorrectPackage",null,[2,3]);class $A{get name(){return"Box4.Clipboard"}init(){}dispose(){}Yb(){}static main(){n.a.instance.Ac(new $A)}}Object(m.a)($A,"Box4ClipboardPackage",null,[2,3]);var aB=d(590),fx=d(503),Zo=d(332);class Xr{}Xr.fontSize=0;Xr.bold=
!1;Xr.italic=!1;Xr.spacing=0;Object(m.a)(Xr,"DefaultTextCharPropertyBag",null,[]);class bB{constructor(a,b,c,f,l,y,H,Q){this.f6c=[ab.a.fontColor,zb.a.lxb];this.tad=[ab.a.Zi,ab.a.font,zb.a.autonumberBulletType,ab.a.LWa,ee.a.JWa];this.Okk=[new fx.a(zb.a.qX,zb.a.Jx),new fx.a(zb.a.ama,zb.a.Gea),new fx.a(zb.a.$la,zb.a.Fea)];this.xwa=a;this.IJ=b;this.Ihc=c;this.vi=f;this.YXa=l;this.lYa=y;this.Rb=H;this.Ga=Q}rub(a){return this.UXd(a,-1)}MLc(a){return this.UXd(a,1)}UXd(a,b){return ob.GraphIterator.Eda(()=>
this.lYa?Wd.OutlineElementReader.ih(a)&&!a.G9b(14)&&a.G9b(12)&&!this.pYj(a)&&this.cIf(a,b):Zb.ListReader.Hk(a)&&this.cIf(a,b))}pYj(a){return(a=this.Ga.vn(a.currentNode))?a.F4:!1}cIf(a,b){return ob.GraphIterator.Eda(()=>{const c=a.currentNode.sa(Ab.a.listLevel,Df.a.yFa)+b;if(0>c||c>=Zo.a.u8||!this.IJ.BQ(a,c))return!1;this.lYa||(Za.OutlineElementNavigator.yi(a),Za.OutlineElementNavigator.Te(a));return!0})}pjb(a,b){this.kdh(a,b)}JPc(a,b){this.kdh(a,b)}kdh(a,b){if(this.UXd(a,b)&&(this.lYa||Zb.ListReader.Hk(a))){var c=
a.Cb(2);a.Cc();(new ob.GraphIterator).Tc(a);const f=a.currentNode.sa(Ab.a.listLevel,Df.a.yFa);(0>f||f>=Zo.a.u8)&&xa.a.J(8959444,820,10,"OutlineElementIndentationEditor::OutlineElementPromoteDemote - level-{0} is out of bounds",f);(0>f+b||f+b>=Zo.a.u8)&&xa.a.J(8959447,820,10,"OutlineElementIndentationEditor::OutlineElementPromoteDemote - level-{0} + depth-{1} is out of bounds",f,b);const l=this.IJ.BQ(a,f),y=this.IJ.BQ(a,f+b);if(l&&y){a.currentNode.setValue(Ab.a.listLevel,f+b);c.setValue(Ab.a.listLevel,
f+b);for(b=0;b<c.Ta.length;b++)c.Ta.ga(b).formatting&&c.Ta.ga(b).formatting.Jle();this.Cji(c,l,y);this.uji(c,l,y);this.zji(c,l,y);c=a.Cb(4);a.Cc();c&&this.oji(c,l,y)}}}uji(a,b,c){b=c.sa(ab.a.fontSize,Xr.fontSize)-b.sa(ab.a.fontSize,Xr.fontSize);a.Ua(ab.a.fontSize)&&a.setValue(ab.a.fontSize,a.eb(ab.a.fontSize)+b);for(c=0;c<a.Ta.length;++c){const f=a.Ta.ga(c);f||xa.a.J(8959450,820,10,"OutlineElementIndentationEditor::AdjustFontSizeBasedOnIndentLevel - paraNode.CharacterProperties[{0}] is null",c);f&&
f.formatting&&f.formatting.dA&&f.formatting.dA.Ua(ab.a.fontSize)&&this.vi.Xq(f.formatting,f.formatting.dA.eb(ab.a.fontSize)+b)}this.YXa&&this.YXa.Ua(ab.a.fontSize)&&(a=this.YXa.fontSize(),this.YXa.Xq(a+b))}Cji(a,b,c){if(a.Ua(Ab.a.nm)){var f=a.eb(Ab.a.nm);let l=b.sa(Ab.a.nm,Df.a.leftMargin),y=c.sa(Ab.a.nm,Df.a.leftMargin);const H=this.Ga.vn(a);H&&!H.vd&&(l=b.sa(zb.a.c4b,Df.a.leftMargin),y=c.sa(zb.a.c4b,Df.a.leftMargin));f=f+y-l;0>f&&a.setValue(Ab.a.uo,a.sa(Ab.a.uo,Df.a.indent)+f);this.xwa.Jv.psd(a,
1,f)}this.bSc(a,b,Ab.a.uo)&&this.MZc(a,c,Ab.a.uo)}zji(a,b,c){for(const f of this.Okk)this.bSc(a,b,f.first,f.second)&&this.MZc(a,c,f.first,f.second)}oji(a,b,c){if(this.bSc(a,b,ab.a.Zi,ab.a.font)){if(0===this.Ihc.vyb(a)&&a.sa(zb.a.autonumberBulletType,8)!==b.sa(zb.a.autonumberBulletType,8))return;if(c.sa(ab.a.Zi,null))this.Ihc.U1b(a),a.vo.apply(a,this.tad),this.MZc.apply(this,[a,c].concat(this.tad));else{const f=this.Rb.Lc(a);f.sc(11);f.Ni()}}for(const f of this.f6c)this.bSc(a,b,f)&&(a.removeProperty(f),
this.MZc(a,c,f))}bSc(a,b,...c){for(const f of c)if(a.Ua(f)||b.Ua(f))if(!a.Ua(f)||!b.Ua(f)||!aB.APropertySet.Y_a(f.type,a.Rh(f),b.Rh(f)))return!1;return!0}MZc(a,b,...c){for(const f of c)b.Ua(f)&&a.ye(f,b.Rh(f))}}Object(m.a)(bB,"OutlineElementIndentationEditor",null,[1234]);var Gy=d(157);class Fp{constructor(a,b){this.hp=this.hd=this.Qt=null;this.fp=b;Fp.fh=a}get jq(){return this.fp.value}get insertionPointFormatting(){return this.Qt||(this.Qt=Ib.a.instance.qb("Box4.IInsertionPointFormatting"))}get Xf(){return this.hd||
(this.hd=Ib.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get W6(){return this.hp||(this.hp=Ib.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}kde(a){const b=a.node;var c=this.insertionPointFormatting?this.insertionPointFormatting.U4f():null;if(c&&!c.equals(ha.a.nil)){a=b.Lh;if(!a)return null;c=a.ze(c);if(!c||c&&1!==fb.StyleReader.mua(c))return null}else c=tb.a.Bs(a),c=tb.a.Pxb(c);return c}aba(a,b,c){if(Db.ParagraphReader.ae(b))if(a)if(fb.StyleReader.C3c(a))if(2!==
fb.StyleReader.mua(a))ka.ULS.shipAssertTag(7467991,324,!1);else{var f=fb.StyleReader.JL(b);if(f){var l=fb.StyleReader.HQ(a);if(!l)ka.ULS.shipAssertTag(7467993,324,!1);else if(f.kH(l)){l=null;this.Xf.ig&&b.a9();c||(l=this.jq.c0k(l),Fp.paragraphEditor.V1b(b,!0));this.bxc(b,f);N.a.instance.ga(61)||(a=f.kH(fb.StyleReader.HQ(a)));b.properties.setValue($c.a.paragraphStyle,a.id);b.qV=a;for(c=0;c<b.Ta.length;c++)b.Ta.ga(c).formatting&&b.Ta.ga(c).formatting.Jle();Fp.h5c.I4b(a)&&(l||(l=new ob.GraphIterator,
l.set(b),l.kf(),Za.OutlineElementNavigator.Te(l)),Zb.ListReader.Hk(l)||(b.vo(Ab.a.nm,Ab.a.aya,Ab.a.uo,Ab.a.fKa,Ab.a.Lnc,Ab.a.Odh),this.FUd(l,a)))}}else ka.ULS.shipAssertTag(7467992,324,!1)}else ka.ULS.shipAssertTag(7467990,324,!1);else ka.ULS.shipAssertTag(7467989,324,!1);else ka.ULS.shipAssertTag(7467988,324,!1)}FUd(){}CMc(a,b=!1){let c;c=ze.c(a)?ze.d(a)?fb.StyleReader.JL(a).kH(fb.StyleReader.jvd):fb.StyleReader.JL(a).kH(fb.StyleReader.lvd):fb.StyleReader.JL(a).kH(N.a.instance.ga(61)?fb.StyleReader.sNa:
fb.StyleReader.Jpa);this.aba(c,a,b)}N_e(a,b){const c=fb.StyleReader.JL(b);c&&c.kH(fb.StyleReader.HQ(a))&&(this.bxc(b,c),this.insertionPointFormatting&&(this.insertionPointFormatting.K0a(),this.insertionPointFormatting.Jga(a,b)))}bxc(a,b){return(a=Fp.lm.nIb(a))?b.Dol(a):!1}static get paragraphEditor(){return Fp.qx||(Fp.qx=Ib.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(a){Fp.qx=a}static get h5c(){return Fp.fh||(Fp.fh=Ib.a.instance.resolve("Box4.List.IListReader"))}static get lm(){return Gy.PageNavigator.instance}}
Fp.qx=null;Fp.fh=null;Object(m.a)(Fp,"StyleEditor",null,[1233]);class lr{static vee(){return lr.$dk}static jZf(a){return new ha.a(a,1)}static LNf(a){a=a.toString();a=a.split("-")[0]+"-0000-0000-0000-000000000000";return Hg.a.Jf(a)}}lr.$dk=[zb.a.bya,zb.a.cellId,zb.a.rowId,zb.a.shapeId];Object(m.a)(lr,"TransformHelper",null,[]);class cB{constructor(a,b){this.d6c=new Fp(a,b);this.AA=a;this.IJ=b.value}kde(a){return this.d6c.kde(a)}N_e(a,b){this.d6c.N_e(a,b)}aba(a,b){const c=new ob.GraphIterator;c.set(b);
c.hv();c.Cc();Fm.d(a,c.currentNode,[Ab.a.listLevel]);Fm.d(a,b,[ab.a.Vl,ab.a.xJ,Ab.a.uo,Ab.a.nm,zb.a.Jx,zb.a.qX,zb.a.ama,zb.a.Gea,zb.a.$la,zb.a.Fea]);if(this.AA.I4b(a)&&!Zb.ListReader.Hk(c)){a=pe.a.xDa(a,a);const f=pe.a.NN(a.listType,a.listStyle);f.SA=a.SA;a.propertySet.Ua(ab.a.Zi)&&f.propertySet.setValue(ab.a.Zi,a.propertySet.eb(ab.a.Zi));a.propertySet.Ua(ab.a.font)&&f.propertySet.setValue(ab.a.font,a.propertySet.eb(ab.a.font));a.propertySet.Ua(zb.a.autonumberBulletType)&&f.propertySet.setValue(zb.a.autonumberBulletType,
a.propertySet.eb(zb.a.autonumberBulletType));this.IJ.UQa(c,f,!1,!1,0);a=c.Cb(4);Fm.b(b,a,lr.vee());c.Cc()}}CMc(a,b=!1){this.d6c.CMc(a,b)}bxc(a,b){return this.d6c.bxc(a,b)}}Object(m.a)(cB,"StyleEditor",null,[1233]);class dB{constructor(a){this.VEg=a;this.VEg.gja(Object(I.a)(this,this.i_a,"onBeforeValidatePersistence"))}dispose(){this.VEg.cMb(Object(I.a)(this,this.i_a,"onBeforeValidatePersistence"))}i_a(a,b){10!==b.node.type&&60!==b.node.type||b.node.NNh()}}Object(m.a)(dB,"LockableGraphNodeEditBehavior",
null,[107]);class eB{constructor(){}j1i(a){const b=a.parentNode.eb(zb.a.shapeId),c=a.parentNode.eb(zb.a.bya);let f=null,l=null;const y=Object(qa.a)(5,a.currentNode);y&&y.Gs()&&(f=a.parentNode.eb(zb.a.rowId),l=a.parentNode.eb(zb.a.cellId));this.v_e(a.currentNode,b,c,f,l)}v_e(a,b,c,f,l){a.ye(zb.a.shapeId,b);a.ye(zb.a.bya,c);l&&(a.ye(zb.a.rowId,f),a.ye(zb.a.cellId,l))}}Object(m.a)(eB,"PptCreateParagraphStrategy",null,[1227]);var nQ=d(31);class fB{constructor(a){this.Pr=a;this.Pr.gja(Object(I.a)(this,
this.i_a,"onBeforeValidatePersistence"))}dispose(){this.Pr.cMb(Object(I.a)(this,this.i_a,"onBeforeValidatePersistence"))}i_a(a,b){Nc.a.Kb&&(a=Nc.a.Kb,a.vr&&Nc.a.Jaa(Nc.a.Kb),b.revisionId&&(b=Nc.a.sab(b.revisionId.toString()),"ReplicateOutbound"===a.actionName?ka.ULS.sendTraceTag(41714057,305,50,"Refuse to override RevisionId for ReplicateOutbound. RevisionId={0}; StackTrace={1}",b.toString(),nQ.Debug.gu()):a.oC(hh.a.LY,b.toString())))}}Object(m.a)(fB,"PresentationNodeEditBehavior",null,[107]);class gB{Hsc(a,
b,c){let f;({value:f}=a.wg(b)).returnValue||(f=new Na.a,a.$(b,f));f.add(c)}Dxd(a,b,c,f){if(a.count)for(let l of a)l&&l!==ha.a.nil&&(a=b.sWc(l,ha.a.nil),a=f.ga(a))&&(b.$(l,a),this.Hsc(c,a,l))}yxd(a,b,c){a.Fb(b)&&ha.a.hQ(a.ga(b),c)&&a.remove(b)}}Object(m.a)(gB,"GraphHotColdHelper",null,[1226]);var Yr=d(211),Hy;(function(a){a[a.presentation=0]="presentation";a[a.slide=1]="slide";a[a.slideChildren=2]="slideChildren";a[a.shapeLevel=3]="shapeLevel"})(Hy||(Hy={}));Object(m.b)("GraphNodeModificationType",
Hy);class YF{constructor(a,b,c,f,l,y){this.KYa=a;this.Dna=b;this.Ana=c;this.GU=f;this.oR=l;this.Kna=y;this.Hic=ha.a.nil}wG(a){return!!a&&(7===a.type||68===a.type)}Cmc(a,b){this.KYa.$(a.id,b);this.Kna.BJe(b)?this.Hic=a.id:this.oR.Hsc(this.GU,b,a.id)}D9e(a){if(this.Hic&&this.Hic!==ha.a.nil){let b;this.oR.Dxd((b=new Na.a,b.add(this.Hic),b),this.KYa,this.GU,a);this.Hic=ha.a.nil}}gJb(a,b){this.oR.yxd(this.KYa,a,b)}v4(a){return this.KYa.Fb(a.id)}eX(a){return this.v4(a)||0<this.Dna.count||0<this.Ana.count}}
Object(m.a)(YF,"PresentationHotColdHandler",null,[1268,1224]);class ZF extends Sys.EventArgs{constructor(a,b){super();this.revisionId=a;this.node=b}}Object(m.a)(ZF,"RevisionPersistArgs",Sys.EventArgs,[]);var $F=d(920);class aG{constructor(a,b,c,f,l,y,H){this.cxa=a;this.Ana=b;this.GU=c;this.oR=f;this.Kna=l;this.jc=y;this.Ga=H;this.wbd=new Na.a;this.yIa=new Na.a}wG(a){return!!a&&(10===a.type||60===a.type||39===a.type)}Cmc(a,b){let c=a;const f=this.jc.mg(a);60!==a.type&&39!==a.type&&(c=this.Ga.vn(a));
f&&c&&(this.Ana.$(c.id,b),this.cxa.$(f.id,b),this.Kna.BJe(b)?(this.wbd.contains(c.id)||this.wbd.add(c.id),this.yIa.contains(f.id)||this.yIa.add(f.id)):(this.oR.Hsc(this.GU,b,c.id),this.oR.Hsc(this.GU,b,f.id)))}D9e(a){this.oR.Dxd(this.wbd,this.Ana,this.GU,a);this.oR.Dxd(this.yIa,this.cxa,this.GU,a);this.wbd.clear();this.yIa.clear()}gJb(a,b){this.oR.yxd(this.Ana,a,b);this.oR.yxd(this.cxa,a,b)}v4(a){return this.wG(a)&&this.Ana.Fb(a.id)}eX(a){return this.v4(a)}}Object(m.a)(aG,"ShapeLevelHotColdHandler",
null,[1268,1224]);class bG{constructor(a,b,c,f,l){this.Dna=a;this.cxa=b;this.GU=c;this.oR=f;this.Kna=l;this.yIa=new Na.a}wG(a){return!!a&&8===a.type}Cmc(a,b){this.Dna.$(a.id,b);this.Kna.BJe(b)&&!this.yIa.contains(a.id)?this.yIa.add(a.id):this.oR.Hsc(this.GU,b,a.id)}D9e(a){this.oR.Dxd(this.yIa,this.Dna,this.GU,a);this.yIa.clear()}gJb(a,b){this.oR.yxd(this.Dna,a,b)}v4(a){return this.Dna.Fb(a.id)}eX(a){return this.v4(a)||this.aUj(a)}aUj(a){return this.cxa.Fb(a.id)}}Object(m.a)(bG,"SlideHotColdHandler",
null,[1268,1224]);class Iy{constructor(a,b,c,f,l,y,H,Q,ia,wa=null,Ua=null,kb=null){this.wl=this.GU=this.Ana=this.cxa=this.Dna=this.KYa=null;this.jc=a;this.Ga=b;this.Mc=c;this.Js=f;this.oR=l;this.Pr=y;this.SDe=!1;this.C0=H;this.ta=Q;this.Kna=ia;this.Js.MQa(Object(I.a)(this,this.Jjd,"onRevisionProcessedOnServerHandler"));this.Js.Uzf(Object(I.a)(this,this.Gid,"onGraphNodePersistHandler"));this.Pr.gja(Object(I.a)(this,this.Gid,"onGraphNodePersistHandler"));this.Mc.GC(Object(I.a)(this,this.WE,"onSessionEnd"));
this.Mc.ufi(Object(I.a)(this,this.j9g,"onFailoverHandler"));this.Mc.HC(Object(I.a)(this,this.Mo,"onSessionRehydrated"));this.initialize(wa,Ua,kb);this.OXa=new Jd.a}reset(){this.initialize();this.Js.zkh(new $F.a(null));this.BLh()}initialize(a=null,b=null,c=null){a||this.Wkj();this.GU=b||new Jd.a;this.wl=c||this.Lka()}j9g(){this.reset()}Jjd(a,b){b&&(a=b.FD)&&this.TMe(a)}Gid(a,b){this.Cmc(b.node,b.revisionId)}Cmc(a,b){if(!this.SDe&&(a.isDirty||10===a.type||60===a.type||39===a.type))for(const c of this.wl)if(c.wG(a)){c.Cmc(a,
b);this.Js.EXk(new ZF(b,a));break}}TMe(a){const b=ha.a.Jf(a.Id),c=this.GU.ga(b);if(c&&c.count){for(let f of c)for(const l of this.wl)l.gJb(f,b);this.GU.remove(b);this.Js.zkh(new $F.a(a));this.BLh()}}gXi(){const a={},b=Iy.lPj(a);b(0,this.KYa);b(1,this.Dna);b(2,this.cxa);b(3,this.Ana);ta.a.isEmpty(a)||xa.a.J(21112097,811,50,ta.a.toJSON(a))}eX(a){for(const b of this.wl)if(b.wG(a))return b.eX(a);return!1}v4(a){for(const b of this.wl)if(b.wG(a))return b.v4(a);return!1}QOh(a){if(0<a.count)for(const b of this.wl)b.D9e(a)}dispose(){this.Mc.Laa(Object(I.a)(this,
this.WE,"onSessionEnd"));this.Mc.q7k(Object(I.a)(this,this.j9g,"onFailoverHandler"));this.Pr.cMb(Object(I.a)(this,this.Gid,"onGraphNodePersistHandler"));this.Js.eMb(Object(I.a)(this,this.Jjd,"onRevisionProcessedOnServerHandler"));this.Js.rph(Object(I.a)(this,this.Gid,"onGraphNodePersistHandler"));this.Mc.zga(Object(I.a)(this,this.Mo,"onSessionRehydrated"));this.OXa&&0<this.OXa.count&&xa.a.J(22153251,822,15,String.format("Disposed with {0} listening node",this.OXa.count))}WE(){this.SDe=!0;this.gXi();
this.reset()}Mo(){this.ta.presentation.QWe();this.reset();this.SDe=!1;this.C0.UKa(new Yw.a("SessionRehydrated"))}Lka(){return[new aG(this.cxa,this.Ana,this.GU,this.oR,this.Kna,this.jc,this.Ga),new bG(this.Dna,this.cxa,this.GU,this.oR,this.Kna),new YF(this.KYa,this.Dna,this.Ana,this.GU,this.oR,this.Kna)]}Wkj(){this.KYa=new Jd.a;this.Dna=new Jd.a;this.cxa=new Jd.a;this.Ana=new Jd.a}A4b(a,b){var c=Object(qa.a)(493,a);c.vua+=1;({value:c}=this.OXa.wg(b.id)).returnValue||(c=new Na.a,this.OXa.add(b.id,c));
c.add(a)}BLh(){if(this.OXa.count&&this.ta.presentation&&this.ta.presentation.Lh){var a=this.ta.presentation.Lh;this.OXa.forEach((b,c)=>{if(!this.v4(Object(qa.a)(9,a.ze(b)))){for(let f of c)if(c=Object(qa.a)(493,f))--c.vua,this.iBb(c)&&(this.C0.UKa(new Yw.a("SessionRehydrated")),this.Bpd(f));this.OXa.remove(b)}return!0})}}iBb(a){return a?!a.vua&&!a.zka:!1}Bpd(a){var b=Object(qa.a)(493,a);a&&b&&(b=+new Date-+b.Mja,12E4<b&&xa.a.J(22153281,822,15,String.format("{0} been blocked {1}",a.type,b)))}static lPj(a){return(b,
c)=>{c=Yr.b(c.values.toArray(),f=>f.toString());c.length&&(a[Hy[b]]=c)}}}Object(m.a)(Iy,"GraphHotColdManager",null,[1223,1224,107,1225]);class hB{constructor(){this.K=null}get name(){return"PowerPointWebEditor.GraphEditor"}Yb(a){this.K=a;this.K.register(dB,"PowerPointWebEditor.GraphEditor.LockableGraphNodeEditBehavior").ma().oa(()=>new dB(this.K.resolve("Box4.Graph.IGraphInstance").CTa));this.K.register(fB,"PowerPointWebEditor.GraphEditor.PresentationNodeEditBehavior").ma().oa(()=>new fB(this.K.resolve("Box4.Graph.IGraphInstance").yd(7)));
this.K.register(bB,"PowerPointWebEditor.OutlineElementIndentationEditor").as("Box4.IOutlineElementIndentationEditor").oa(()=>new bB(this.K.resolve("Box4.IParagraphEditor"),this.K.resolve("PowerPointWebEditor.IPptListEditor"),this.K.resolve("PowerPointWebEditor.IListInfoHelper"),this.K.resolve("Box4.IFormattingEditor"),this.K.resolve("Box4.IInsertionPointFormatting"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").isPromoteDemoteOnParagraphEnabled,this.K.resolve("Box4.Graph.IGraphIteratorFactory"),
this.K.resolve("PowerPointWebEditor.IShapeReader")));this.K.register(cB,"PowerPointWebEditor.StyleEditor").as("Box4.Styles.IStyleEditor").ma().oa(()=>new cB(this.K.resolve("Box4.List.IListReader"),this.K.oe("Box4.List.IListEditor")));this.K.register(gB,"PowerPointWebEditor.GraphHotColdHelper").as("PowerPointWebEditor.IGraphHotColdHelper").oa(()=>new gB);this.K.register(Iy,"PowerPointWebEditor.GraphHotColdManager").as("PowerPointWebEditor.IGraphHotColdManager").as("PowerPointWebEditor.IGraphBlockContentHandler").ma().oa(()=>
new Iy(a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IGraphHotColdHelper"),a.resolve("Box4.Graph.IGraphInstance").CTa,a.resolve("PowerPointWebEditor.IGraphActionBlockingEventNotifier"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.ITextEditingRevisionInfoReader")));
this.K.register(eB,"PowerPointWebEditor.PptCreateParagraphStrategy").as("Box4.ICreateParagraphStrategy").ma().oa(()=>new eB(this.K.resolve("Box4.ITableCellReader")))}init(){this.K.resolve("PowerPointWebEditor.GraphEditor.LockableGraphNodeEditBehavior");this.K.resolve("PowerPointWebEditor.GraphEditor.PresentationNodeEditBehavior");this.K.resolve("PowerPointWebEditor.IGraphHotColdManager");this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager").addHandler(this.K.resolve("PowerPointWebEditor.IGraphBlockContentHandler"))}dispose(){this.K.resolve("PowerPointWebEditor.GraphEditor.LockableGraphNodeEditBehavior").dispose();
this.K.resolve("PowerPointWebEditor.GraphEditor.PresentationNodeEditBehavior").dispose()}static main(){n.a.instance.Ac(new hB)}}Object(m.a)(hB,"PPTWebEditorGraphEditorPackage",null,[2,3]);var oQ=d(790),Jy=d(792),pQ=d(791),mo=d(457);const cG=a=>{a.element.style.top=""};var yv=d(801);class dG{constructor(a,b,c){this.a8=!1;this.eOa=0;this.Lha=this.fpf=null;this.RS=a;this.J8h=b;this.Gn=c;this.PP=a.ownerDocument.createElement("div");this.htmlElement.className="WACBusinessBar";(this.Q2=!!w.AFrameworkApplication.Aa&&
w.AFrameworkApplication.Aa.ob.bva)&&!this.Gn.nQc&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer");this.htmlElement.id="WACBusinessBar";z.a.gg&&Sys.UI.DomElement.addCssClass(this.htmlElement,"FireFox")}get htmlElement(){return this.PP}get visible(){return this.a8}set_visible(a){if(this.a8!==a)return(this.a8=a)?this.CVd():this.l4b(),a}dispose(){this.visible&&this.l4b();Ea.a.$Ca(this.htmlElement);this.RS=this.PP=null}ZBh(a,b){const c=a.htmlElement||a.createElement();b===this.htmlElement.childNodes.length?
this.htmlElement.appendChild(c):this.htmlElement.insertBefore(c,this.htmlElement.childNodes[b]);a.wrh();this.eOa+=a.htmlElement.clientHeight;var f=this.htmlElement.childNodes,l=a.UAf,y=Object(I.a)(this,this.sAk,"onAfterShowEntry");mo.WacAirSpace.k1a(c,"Shared_BasicClass");var H=new pQ.a(c);H.P_b(0,1);const Q=new Jy.a(c);Q.Q_b(c.clientTop-30,c.clientTop);l?(mo.WacAirSpace.UZa(H,null,null),mo.WacAirSpace.UZa(Q,null,y)):(mo.WacAirSpace.animate(H,null,null),mo.WacAirSpace.animate(Q,null,y));for(b+=1;b<
f.length;b++)y=f[b],mo.WacAirSpace.k1a(y,"Shared_BasicClass"),H=new Jy.a(y),H.Q_b(y.clientTop-c.clientHeight,y.clientTop),l?mo.WacAirSpace.UZa(H,null,null):mo.WacAirSpace.animate(H,null,null);a.Cvl();this.set_visible(!0)}vhg(a){const b=a.htmlElement;if(Ea.a.LVa(b)){this.eOa-=a.htmlElement.clientHeight;var c=b.parentNode.children;a=a.UAf;var f=Object(I.a)(this,this.oAk,"onAfterHideEntry");mo.WacAirSpace.k1a(b,"Shared_BasicClass");var l=new oQ.a(b);l.P_b(1,0);a?mo.WacAirSpace.UZa(l,null,f):mo.WacAirSpace.animate(l,
null,f);f=!1;for(l=0;l<c.length;l++){if(f){const y=c[l];mo.WacAirSpace.k1a(y,"Shared_BasicClass");const H=new Jy.a(y);H.Q_b(y.clientTop,-b.clientHeight);a?mo.WacAirSpace.UZa(H,null,cG):mo.WacAirSpace.animate(H,null,cG)}f||c[l]!==b||(f=!0)}}}sAk(a){a.element.style.top="";w.AFrameworkApplication.Aa.yu()}oAk(a){a.element.parentNode.removeChild(a.element);this.htmlElement.hasChildNodes()||this.set_visible(!1);w.AFrameworkApplication.Aa.yu()}CVd(){""===this.RS.style.top.trim()&&(this.RS.style.top=this.RS.offsetTop+
"px");this.htmlElement.style.left=this.RS.style.left;this.htmlElement.style.top=this.RS.style.top;this.htmlElement.style.height="auto";this.htmlElement.style.visibility="visible";var a=Sys.UI.DomElement.getBounds(this.htmlElement);this.fpf=this.RS.style.top;this.eOa=a.height;this.Dyd();w.AFrameworkApplication.Aa.Nca(Object(I.a)(this,this.onResize,"onResize"));hd.a.addHandler(this.htmlElement,oa.a.ord,hd.a.uub);this.Lha=Object(I.a)(this,this.MC,"contextMenuHandler");w.AFrameworkApplication.Aa.qba.rb(this.htmlElement,
this.Lha,null);if(v.FocusManager.mN()){var b=v.FocusManager.instance();a=b.Fc(yv.a.c8a);a.parent=D.AFrame.Xi;const c=new sq.DOMFocusListing(()=>this.htmlElement);c.Ro(1);c.Ro(2);c.Ro(8);b.zja(()=>this.htmlElement,a,c);b=b.EQ(yv.a.c8a);b.Xjb();b.uX=!0;b.QRa=!0;const f=w.AFrameworkApplication.Aa.gx;a.o7a(()=>{f.Eo(yv.a.c8a)});f.bja(yv.a.c8a);(c.xka||w.AFrameworkApplication.fa.ka("ReactBusinessBarIsEnabled"))&&f.DI(yv.a.c8a)}}l4b(){this.ABh()&&(this.RS.style.top=this.fpf);this.htmlElement.style.visibility=
"hidden";w.AFrameworkApplication.Aa&&(v.FocusManager.mN()&&v.FocusManager.instance().YLb(yv.a.c8a),this.Lha&&(w.AFrameworkApplication.Aa.qba.Bb(this.htmlElement,this.Lha),this.Lha=null));hd.a.removeHandler(this.htmlElement,oa.a.ord,hd.a.uub)}Dyd(){if(this.ABh()&&this.visible){var a=this.RS,b=this.eOa+this.J8h;const c=Ea.a.TM(a.style.top);mo.WacAirSpace.k1a(a,"Shared_BasicClass");a=new Jy.a(a);a.Q_b(c,b);mo.WacAirSpace.animate(a,null,null)}}ABh(){return!this.Q2&&!this.Gn.nQc}onResize(){const a=this.Gn.entries.length,
b=Sys.UI.DomElement.getBounds(this.htmlElement).height;let c;for(let f=0;f<a;++f)c=this.Gn.entries[f],c.htmlElement&&c.wrh();this.eOa=Sys.UI.DomElement.getBounds(this.htmlElement).height;b!==this.eOa&&this.Dyd()}MC(){return!0}}Object(m.a)(dG,"BusinessBarDom",null,[948,107]);var eu;(function(a){a[a.none=0]="none";a[a.corruptPage=1]="corruptPage";a[a.currentPageStatus=2]="currentPageStatus";a[a.documentMarkedAsFinal=3]="documentMarkedAsFinal";a[a.documentSigned=4]="documentSigned";a[a.fileAccess=5]=
"fileAccess";a[a.kickoutWithDataLoss=6]="kickoutWithDataLoss";a[a.lostSession=7]="lostSession";a[a.malformedHyperlinkUris=8]="malformedHyperlinkUris";a[a.odt=9]="odt";a[a.readonlyRecommended=10]="readonlyRecommended";a[a.saveReplaySuccess=11]="saveReplaySuccess";a[a.saveReplayFailed=12]="saveReplayFailed";a[a.unsupportedObjects=13]="unsupportedObjects";a[a.word11Compat=14]="word11Compat";a[a.unsupportedBrowser=15]="unsupportedBrowser";a[a.applicationNotification=16]="applicationNotification";a[a.skypeDocChatFailed=
17]="skypeDocChatFailed";a[a.showDialogInNewWindowInfo=18]="showDialogInNewWindowInfo";a[a.sessionExpired=19]="sessionExpired";a[a.irmPolicyDescription=20]="irmPolicyDescription";a[a.policyWarningMessage=21]="policyWarningMessage";a[a.thirdPartyAddinDisabled=22]="thirdPartyAddinDisabled";a[a.gdprPrivacyNotice=23]="gdprPrivacyNotice";a[a.datacenterDecommissionWarning=24]="datacenterDecommissionWarning";a[a.graphMergePrompt=25]="graphMergePrompt";a[a.readOnlyDocument=26]="readOnlyDocument";a[a.dictationSilence=
27]="dictationSilence";a[a.autoSensitivityLabel=28]="autoSensitivityLabel";a[a.recommendedSensitivityLabel=29]="recommendedSensitivityLabel";a[a.dictationDebugInfo=30]="dictationDebugInfo";a[a.oneNoteCovid19Message=31]="oneNoteCovid19Message";a[a.citationStylePrompt=32]="citationStylePrompt";a[a.oneNoteViewModeMessage=33]="oneNoteViewModeMessage";a[a.oneNotePrintImagesDownloading=34]="oneNotePrintImagesDownloading";a[a.oneNotePagePrintReady=35]="oneNotePagePrintReady";a[a.irmPolicyCausedFeatureDisabled=
36]="irmPolicyCausedFeatureDisabled";a[a.mandatoryLabel=37]="mandatoryLabel";a[a.policyTip=38]="policyTip";a[a.minorVersionLimit=39]="minorVersionLimit";a[a.testEntry1=40]="testEntry1";a[a.testEntry2=41]="testEntry2";a[a.testEntry3=42]="testEntry3";a[a.testEntry4=43]="testEntry4";a[a.testEntry5=44]="testEntry5";a[a.testEntry6=45]="testEntry6";a[a.testEntry7=46]="testEntry7"})(eu||(eu={}));Object(m.b)("BusinessBarId",eu);class Aq{constructor(a,b=0,c=null,f=null){this.rkf=this.Kef=!1;this.Sqb=null;
this.MP=[];this.EAa=f||new dG(a,b,this);this.GOj(c)}GOj(a){if(a){this.Sqb={};a=a.ranking;for(let b=0;b<a.length;b++)this.Sqb[eu[a[b]]]=b}}dispose(){this.EAa.dispose();yy.a.Jqd(this.MP);this.MP=null}get htmlElement(){return this.EAa.htmlElement}get visible(){return this.EAa.visible}get nQc(){return this.Kef}set nQc(a){this.Kef=a}get kpe(){return this.rkf}set kpe(a){this.rkf=a}get entries(){return this.MP}set entries(a){this.MP=a}tea(a){for(let b=0;b<this.MP.length;b++)if(this.MP[b].id===a)return!0;
return!1}ji(a,b=!1,c=null){a.businessBar=this;let f=this.Uij(a.id);b&&!this.Sqb&&(f=0);f<Aq.zhb&&(this.EAa.ZBh(a,f),this.MP.length>=Aq.zhb&&this.EAa.vhg(this.MP[Aq.zhb-1]),this.EAa.Dyd());Array.insert(this.MP,f,a);ka.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",eu[a.id],void 0===a.lDa||null===a.lDa?"":a.lDa);a.errorCode&&w.AFrameworkApplication.Oo(a.errorCode,c,null,null)}removeEntry(a){const b=Array.indexOf(this.MP,a);-1!==b&&b<Aq.zhb&&(this.MP.length>Aq.zhb&&
this.EAa.ZBh(this.MP[Aq.zhb],Aq.zhb),this.EAa.vhg(a),this.EAa.Dyd());Array.remove(this.MP,a);a.businessBar=null;a.dispose()}Uij(a){if(!this.Sqb||0===a)return this.MP.length;a=this.Sqb[eu[a]];if(void 0===a||null===a)return this.MP.length;for(let b=0;b<this.MP.length;b++)if(a<this.Sqb[eu[this.MP[b].id]])return b;return this.MP.length}}Aq.zhb=2;Object(m.a)(Aq,"BusinessBar",null,[913,107,914]);class iB{constructor(a){this.fPc=null;this.V6g=a.Ha("OfficeOnlineChromeExtensionId");this.d7g=a.Ha("ChromeClipboardAccessExtensionId");
this.JTj=a.ka("OfficeOnlineChromeExtensionIsEnabled");this.Zsf=!this.v_j();this.fPc=this.lza?this.d7g:this.V6g}mVc(){return this.fPc}IWe(){this.fPc===this.V6g&&this.wpg&&(localStorage.removeItem("IsOfficeOnlineExtensionInstalled"),localStorage.removeItem("IsCopyPasteSupported"));this.fPc=this.d7g;this.Zsf=!0}get lza(){return this.Zsf}v_j(){if(this.JTj&&this.wpg){var a=localStorage.getItem("IsOfficeOnlineExtensionInstalled");if(a&&"true"===a)return a=localStorage.getItem("IsCopyPasteSupported"),!!a&&
"true"===a}return!1}get wpg(){let a=!1;try{localStorage.setItem("LocalStorageAccessiblityTest","LocalStorageAccessiblityTest"),a="LocalStorageAccessiblityTest"===localStorage.getItem("LocalStorageAccessiblityTest"),localStorage.removeItem("LocalStorageAccessiblityTest")}catch(b){ka.ULS.sendTraceTag(19452045,307,50,b.toString())}return a}}Object(m.a)(iB,"ChromeExtensionHelper",null,[1212]);class eG{constructor(a=null,b=null,c=null){this.uba=a||{};this.eKh=b||[];this.ZIl=c||{}}}Object(m.a)(eG,"RibbonTrimmingProperties",
null,[]);var qQ=d(462);class fG{create(a,b,c){return new qQ.a(a,b,c)}}Object(m.a)(fG,"Factory",null,[947]);class gG{constructor(){w.AFrameworkApplication.Ra.ya(G.a.rCb,ie.a.frame,Object(I.a)(this,this.r_k,"reactFileMenuOpenFromTellMe"))}r_k(a,b,c,f,l){if(1===c)return 32;w.AFrameworkApplication.ECb("54hi9858;4f638686");if(!l)return 32;a=l.SourceControlId;17!==l.UILocation||"New"!==a&&"Open"!==a||(l=[],tg.d("setFileMenuSelectedPage")&&("New"===a&&w.AFrameworkApplication.Aa?2===w.AFrameworkApplication.Aa.ob.zk?
l.push(appChrome.actions.setFileMenuSelectedPage("PptFileNewPage")):l.push(appChrome.actions.setFileMenuSelectedPage("FileNewPage")):"Open"===a&&w.AFrameworkApplication.Aa&&(2===w.AFrameworkApplication.Aa.ob.zk?l.push(appChrome.actions.setFileMenuSelectedPage("PptFileOpenPage")):l.push(appChrome.actions.setFileMenuSelectedPage("FileOpenPage")))),l.push(appChrome.actions.updateFileMenuExpandedValue(!0)),appChrome.api.dispatch(l));return 32}S7j(){appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0))}}
Object(m.a)(gG,"ReactFileMenu",null,[1269]);class hG{createFileMenu(){const a=new gG,b=[];b.push(appChrome.actions.updateFileMenuExpandedValue(!1));b.push(appChrome.actions.updateFileMenuDisabledValue(!1));appChrome.api.dispatch(b);return a}}Object(m.a)(hG,"ReactFileMenuFactory",null,[1230]);var wh=d(542);class iG{constructor(a,b,c,f,l,y,H){this.MHa=!1;this.sA=null;this.Rma=this.ted=this.mYa=!1;this.pEb="Edit";this.eYg=!1;this.pc=f;this.ia=a;this.Vv=b;this.Vb=l;this.Hh=H;this.Vb.GI(Object(I.a)(this,
this.vgd,"modeSwitched"));this.Ea=c;this.vb()}vb(){this.ia.ya(ea.a.o4g,ie.a.frame,Object(I.a)(this,this.ywk,"modeSwitcherHandler"));this.ia.ya(ea.a.Wuc,ie.a.frame,Object(I.a)(this,this.Wuc,"switchToDocumentEditMode"));this.ia.ya(ea.a.Yuc,ie.a.frame,Object(I.a)(this,this.Yuc,"switchToEmergencyViewMode"));this.ia.ya(ea.a.Xuc,ie.a.frame,Object(I.a)(this,this.Xuc,"switchToDocumentViewMode"));this.ia.ra(ea.a.BSe,ie.a.frame,Object(I.a)(this,this.ijh,"queryDocumentModeSwitchMenuItem"),96);this.ia.ra(ea.a.CSe,
ie.a.frame,Object(I.a)(this,this.ijh,"queryDocumentModeSwitchMenuItem"),96);this.ia.ya(ea.a.TDa,hc.a.application,Object(I.a)(this,this.TDa,"displayCallout"));this.ia.ya(G.a.sGh,ie.a.frame,Object(I.a)(this,this.WCl,"switchFromViewModeToEditMode"))}dispose(){this.Vb.IY(Object(I.a)(this,this.vgd,"modeSwitched"))}pe(){}ywk(){return 32}Xuc(a,b,c){if(1===c||"View"===this.R$a())return 32;this.Vv.yGh();this.Frd("View");this.ted=!0;return 32}Wuc(a,b,c){if(w.AFrameworkApplication.VQ)return 8;a=this.R$a();if(1===
c){if("Edit"===a||this.MHa||this.ted||this.mYa&&this.pc.getState(1))return 32;ka.ULS.sendTraceTag(512500510,306,10,"ModeSwitcherControlActor:SwitchToDocumentEditMode:: DocModeSwitcher Editing Option Disabled");return 8}if("Edit"===a)return 32;this.Vv.spl();c=this.mYa?this.ia.Ka(ea.a.V4b,2,20):this.ia.processAction(ea.a.a9b,2);this.MHa=this.mYa=this.ted=!1;this.Frd("Edit");return c}WCl(a,b,c){if(w.AFrameworkApplication.VQ)return 8;a=this.R$a();if(1===c){if("Edit"===a||this.MHa||this.ted||this.mYa&&
this.pc.getState(1))return 32;ka.ULS.sendTraceTag(512500509,306,10,"ModeSwitcherControlActor:SwitchFromViewModeToEditMode:: DocModeSwitcher Editing Option Disabled");return 8}if("Edit"===a)return 32;if(2!==c)return ka.ULS.sendTraceTag(512500508,306,15,String.format("Unexpected ActionBehavior {0} for switching to edit mode",c)),2;this.ia.Ka(ea.a.refresh,2,{refreshtrigger:"SwitchFromViewModeToEditMode"});return 32}Yuc(a,b,c){if(1===c)return 32;this.MHa=!0;return this.initialize()}ijh(a,b,c,f,l){b=this.R$a();
l[wh.a.On]=a===ea.a.BSe&&"Edit"===b||a===ea.a.CSe&&"View"===b?!0:!1;return 32}TDa(a,b,c,f,l){if(!l||!Object(Wa.a)(En,l))return 8;this.sA=l;this.initialize();this.Hh&&!this.eYg&&"View"===this.pEb&&(this.Hh.r7e(),this.eYg=!0);return this.initialize()}initialize(){if(!tg.c())return ka.ULS.sendTraceTag(512500507,306,10,"ModeSwitcherControlActor:Initialize:: Failed to Initialize DocModeSwitcher - AppChrome Actions being Null"),8;this.pEb=this.i8f();!this.Rma&&this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",
!1)&&this.R$a()!==this.pEb&&ka.ULS.sendTraceTag(512500506,306,50,"ModeSwitcher was initially rendered in the incorrect mode. Expected: {0}, Actual: {1}",this.pEb,this.R$a());var a=this.sA?this.sA.Lac||this.sA.Qac:!1,b=this.sA?this.sA.SVa:this.pc.getState(16);this.mYa=this.sA?this.sA.uoe:this.pc.getState(524288);var c=this.sA?this.sA.bbb:this.pc.getState(1);const f=this.MHa||a||this.mYa||b||!c,l={hidden:!1};l.hasEditPermission=c;l.activeMode=this.pEb;l.isMarkedAsFinal=b;l.isMarkedAsOpenReadOnly=this.mYa;
l.isReviewer=!1;l.isServiceDefaultedToView=this.MHa||a;l.forceShowNotificationByExternalTrigger=this.sA&&this.sA.e1c?!this.sA.e1c:f;a&&(a={},c={},c.title=ResourceStrings.L_BizBarTitle_Readonly,this.sA.Lac?c.text=ResourceStrings.L_BizBarMessage_PasswordProtected:this.sA.Qac&&(c.text=ResourceStrings.L_BizBarMessage_FileFormatNotEditable),c.confirmationButtonText=ResourceStrings.L_InsertTableDialogButtonText,c.icon="pptEditorSprite.CancelGlyph_16",c.label=ResourceStrings.L_Close,a.serviceDefaultedToViewCallout=
c,l.notificationCalloutProps=a);a=appChrome.actions.updateModeSwitcher(l);if(!a)return ka.ULS.sendTraceTag(512500505,306,10,"ModeSwitcherControlActor:Initialize:: Failed to Initialize DocModeSwitcher - Redux Action being Null"),8;ka.ULS.sendTraceTag(512500504,306,50,"ModeSwitcherControlActor:Initialize:: Dispatching Mode switcher action. ActionDataAvailable:{0}, HasEditPerm: {1}, Mode:{2}, MarkedFinal: {3}, MarkedOpenRO: {4}, EditProtected: {5}, FormatUnsupported: {6}, EmergencyMode: {7}, InReadingMode: {8}",
!!this.sA,l.hasEditPermission,this.pEb,b,this.mYa,!!this.sA&&this.sA.Lac,!!this.sA&&this.sA.Qac,this.MHa,this.Xlg());b=this.K3d(a);this.Rma=!0;return b}K3d(a){if(appChrome.api)return appChrome.api.dispatch(a),32;ka.ULS.sendTraceTag(512500503,306,10,"ModeSwitcherControlActor:DispatchAction:: Failed to Initialize DocModeSwitcher - PPT App Chrome API being Null");return 8}Xlg(){return!!w.AFrameworkApplication.Aa&&1===w.AFrameworkApplication.Aa.mode}i8f(){return this.sA?this.MHa||this.sA.SVa||this.sA.uoe||
this.sA.Lac||this.sA.Qac||this.sA.e1c?"View":this.sA.bbb?"Edit":"View":this.MHa||this.Xlg()?"View":"Edit"}R$a(){if(tg.c())switch(appChrome.selectors.getModeSwitcherMode()){case null:case "Edit":break;case "View":return"View";default:ka.ULS.sendTraceTag(512500502,306,15,"ModeSwitcherControlActor:GetCurrentDocumentMode:: ModeSwitcher Actor received an invalid active mode from the control.")}return"Edit"}Frd(a){if(tg.c()&&this.R$a()!==a){var b={};b.activeMode=a;ka.ULS.sendTraceTag(512500501,306,50,"ModeSwitcherControlActor:SendUpdateModeReduxAction:: ModeSwitcher control switching to mode {0}",
a);a=appChrome.actions.updateModeSwitcher(b);this.K3d(a)}}vgd(a){this.Rma&&(1===a.mode?this.Frd("View"):2===a.mode&&this.Frd("Edit"))}B9k(){const a={hidden:!1};a.activeMode=this.i8f();this.K3d(appChrome.actions.updateModeSwitcher(a))}}Object(m.a)(iG,"ModeSwitcherControlActor",null,[1189]);var jG=d(253);class jB{constructor(a,b,c,f){this.eCa=this.igf=this.Hqb=this.Cef=this.hOa=this.Fdf=null;this.Vuf=!1;this.Gn=a;this.wZ=b;this.Ca=c;this.Oa=f}fOk(){this.I1b();this.J1b();this.Mzi()}I1b(){const a=Rc.App.Lb.Kd.Di;
a&&(this.Fdf=this.Eyd(this.Fdf,1,2===Rc.App.Lb.mode&&a.E0c,Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent))}get n5j(){if(!Rc.App.DMh)return!1;z.a.iX&&w.AFrameworkApplication.uk("Microsoft.Office.SharedOnline.IE11SoftBlockConsumerIsEnabled");return z.a.Wj}Mzi(){this.n5j&&!this.Hqb&&(this.Hqb=this.wZ.create("",CommonUIStrings.l_UnsupportedBrowserDeadline,null),this.Hqb.id=15,this.Hqb.closeable=!0,this.Hqb.addButton(Box4Intl.Box4Strings.L_DownloadNow,M.AppFrame.BMl,""),wn.a("NewBrowserSuggestionShown"),
this.Gn.ji(this.Hqb,!1))}J1b(){let a=null;const b=Rc.App.Lb.Kd.Jca;if(b){const c=b.znc;jG.a.sac(c)?22===c?a=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:19===c||20===c?a=z.a.Vi?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===c?a=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===c?a=z.a.Vi?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===c&&(a=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):
2!==Rc.App.Lb.mode||jG.a.PYc(b.YZb)||Rc.App.Wbc||(a=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.igf=this.Eyd(this.igf,5,!!a,a)}tpl(a){!!this.eCa===a||this.Vuf||(a?(this.eCa=this.wZ.create("",Box4Intl.Box4Strings.l_BusinessBarUnsupportedObjectsOnPage,null),this.eCa.id=13,this.eCa.closeable=!0,this.eCa.u3=()=>{this.Vuf=!0;this.eCa=null},this.Gn.ji(this.eCa)):(this.Gn.removeEntry(this.eCa),this.eCa=null))}eCh(a,b,c,f){a=this.wZ.create(null,a,null);a.closeable=!0;a.id=23;a.image=3;a.Oxf(b,()=>
{Bd.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+c)});f&&(a.u3=f);this.Gn.ji(a,!0)}Yvl(a,b,c){this.eCh(a,b,c,null)}svl(a){a=this.wZ.create(null,a,null);a.closeable=!0;a.id=24;a.image=1;this.Gn.ji(a,!0)}iwl(a){a=this.wZ.create(null,a,null);a.closeable=!0;a.id=20;this.Gn.ji(a)}yvl(){var a=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,b=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage;this.hOa||(this.hOa=this.wZ.create(a,b,null),this.hOa.closeable=!0,this.hOa.id=27,this.Gn.ji(this.hOa))}DIj(){this.hOa&&
(this.hOa=this.Eyd(this.hOa,27,!1,""))}M1e(a){this.Cef=this.Eyd(this.Cef,30,!0,a)}Eyd(a,b,c,f){c?a?a.message=f:(a=this.wZ.create("",f,null),a.id=b,a.closeable=!1,this.Gn.ji(a,!1)):a&&(this.Gn.removeEntry(a),a=null);return a}}Object(m.a)(jB,"BusinessBarController",null,[1229]);var rQ=d(262);class kB extends jB{constructor(a,b,c,f,l,y,H,Q,ia){super(a,b,f,y);this.Vse=this.qFg=!1;this.gjc=[];this.PGa=0;this.WEe=null;this.V5k=wa=>{xa.a.J(509195598,801,50,"BusinessBarController.removeFilterPrivacyHandler");
rQ.a.Kkl(this.rok.presentationId.string,this.EGk,this.DGk);this.Gn.removeEntry(wa)};this.EGk=()=>{xa.a.J(509195597,801,50,"BusinessBarController.onRemoveFilterPrivacySucceeded")};this.DGk=wa=>{xa.a.J(509195596,801,10,"BusinessBarController.onRemoveFilterPrivacyFailed error: {0}",$e.a.nL(wa.error.Vm))};this.U6j=wa=>{xa.a.J(509182920,801,50,"BusinessBarController.keepFilterPrivacyHandler");this.Gn.removeEntry(wa)};this.Qse=c;this.ia=f;this.l$=l;this.Fa=H;this.yA=Q.YFa;this.Ric=Q.powerPointDragInsertMultipleImageQuantityLimit;
this.rok=ia}initialize(){this.Qse.GI(Object(I.a)(this,this.zu,"onAppFrameModeSwitched"))}dispose(){this.Qse.IY(Object(I.a)(this,this.zu,"onAppFrameModeSwitched"))}Av(a,...b){this.w4b.apply(this,[a,this.l$.OWc(a),this.l$.Sde(a),this.l$.obe(a)].concat(b))}w4b(a,b,c,f){0===a||this.WEe||(c=this.wZ.create(c,f||"",null),c.closeable=!0,c.errorCode=$e.a.Oh(a),c.u3=Object(I.a)(this,this.V_i,"errorEntryClosedHandler"),a=!!(b&8),b=!!(b&4),a&&c.addButton(ResourceStrings.L_Refresh,Object(I.a)(this,this.tod,"refreshActionHandler"),
""),b&&(a?c.CSd(ResourceStrings.L_OpenInPowerPoint,Object(I.a)(this,this.okd,"openInClientActionHandler")):c.addButton(ResourceStrings.L_OpenInPowerPoint,Object(I.a)(this,this.okd,"openInClientActionHandler"),"")),this.WEe=c,this.g_b(c))}rL(a){var b="";let c="",f=null,l="",y=null;var H=!1;let Q=!1;switch(a){case 0:b=ResourceStrings.L_BizBarTitle_MarkedAsFinal;a=ResourceStrings.L_BizBarMessage_MarkedAsFinal;H=!0;break;case 20:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.l_BizBarMessage_MarkedAsReadOnlyRecommended;
H=!0;break;case 1:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_EditPermissionDenied;H=!0;break;case 2:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_FileFormatNotEditable;H=!0;break;case 3:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_PptEditCheckedOutByAnother;H=!0;break;case 4:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_RequiresCheckout;H=!0;break;case 5:b=ResourceStrings.L_BizBarTitle_Readonly;
a=ResourceStrings.L_BizBarMessage_LockedForOfflineCheckout;H=!0;break;case 6:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_CannotAcquirePptEditLock;H=!0;break;case 7:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_CannotAcquirePptEditSharedLock;H=!0;break;case 8:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_NumberOfCoauthorsReachedMax;H=!0;break;case 9:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_PptEditExistingExclusiveLock;
H=!0;break;case 10:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_FileFormatConvertible;c=ResourceStrings.L_BizBarButton_Convert;f=Object(I.a)(this,this.OHi,"convertActionHandler");H=!0;break;case 11:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_PasswordProtected;H=!0;break;case 12:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_FontRestricted;H=!0;break;case 13:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_SessionRestricted;
H=!0;break;case 14:b=w.AFrameworkApplication.fa.appSettings.IrmPolicyTitle?w.AFrameworkApplication.fa.appSettings.IrmPolicyTitle:"";a=w.AFrameworkApplication.fa.appSettings.IrmPolicyDescription?w.AFrameworkApplication.fa.appSettings.IrmPolicyDescription:"";H=!0;break;case 15:b=ResourceStrings.L_BizBarTitle_SessionExpired;a=ResourceStrings.L_BizBarMessage_SessionAccessTokenExpired;H=!0;break;case 18:b=ResourceStrings.L_BizBarTitle_DragDropNotSupportFormat;a=ResourceStrings.L_BizBarMessage_DragDropNotSupportFormat;
H=!1;break;case 19:b=String.format(ResourceStrings.L_BizBarTitle_DragDropMoreFilesThanLimite,this.Ric);a=String.format(ResourceStrings.L_BizBarMessage_DragDropMoreFilesThanLimite,this.Ric);H=!1;break;case 22:b=ResourceStrings.L_BizBarTitle_Readonly;a=this.vqj();H=!1;a&&(this.PGa=a,a=this.ia.Ka(ea.a.MMb,1,this.PGa),8!==a&&16!==a&&(H=!0,c=ResourceStrings.L_BizBarInlineRepairSaveAsText,f=Object(I.a)(this,this.h$k,"repairSaveCopyHandler")));32===this.ia.processAction(ea.a.mrc,1)&&(H?(l=ResourceStrings.L_BizBarInlineRepairOverwriteFileText,
y=Object(I.a)(this,this.$ph,"replaceOriginalFileHandler")):(H=!0,c=ResourceStrings.L_BizBarInlineRepairOverwriteFileText,f=Object(I.a)(this,this.$ph,"replaceOriginalFileHandler")));a=H?ResourceStrings.L_BizBarInlineRepairWithSaveMessage:ResourceStrings.L_BizBarInlineRepairWithoutSaveMessage;H=!0;break;case 23:b=ResourceStrings.L_BizBarTitle_ViewOnly;a=ResourceStrings.L_BizBarEmergencyViewingModeMessage2;c=ResourceStrings.L_BizBarEmergencyViewingModeEditButton;f=Object(I.a)(this,this.iyj,"goToEditModeHandler");
H=!0;break;case 24:b=ResourceStrings.L_BizBarTitle_MinorVersionLimitReached;a=ResourceStrings.L_BizBarInlineMinorVersionLimitReached;c=ResourceStrings.L_LearnMore;f=Object(I.a)(this,this.aKk,"openVersioningPageHandler");break;case 25:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_UserNetworkLocationUnauthorized;break;case 26:a=ResourceStrings.L_BizBarMessage_CannotCropCurrentSelection;H=!1;break;case 27:Q=!0;a=ResourceStrings.L_BizBarInlineFilterPrivacy;c=ResourceStrings.L_RemoveSetting;
f=this.V5k;l=ResourceStrings.L_KeepSetting;y=this.U6j;break;default:return}b=this.wZ.create(b,a,null);b.image=3;b.closeable=!0;b.u3=H?Object(I.a)(this,this.qlh,"readOnlyInfoEntryClosedHandler"):Object(I.a)(this,this.qjg,"infoEntryClosedHandler");Q&&(b.Q1c=!1);f&&b.addButton(c,f,"");y&&b.CSd(l,y);this.g_b(b);H&&Array.add(this.gjc,b)}UDa(a){let b;switch(a){case 22:var c=CommonUIStrings.l_ThirdPartyAddinDisabledTitle;b=CommonUIStrings.l_ThirdPartyAddinDisabledMessage;break;case 36:c=CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledTitle;
b=CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledMessage;break;default:return}c=this.wZ.create(c,b,null);c.id=a;c.image=1;c.closeable=!0;this.g_b(c)}lQc(a,b){let c,f=!1,l=!1,y=!1,H=!1;switch(a){case 1:a=ResourceStrings.L_BizBarTitle_Readonly;c=ResourceStrings.L_BizBarMessage_EditPermissionDenied;b=1;break;case 0:a=ResourceStrings.L_BizBarTitle_MarkedAsFinal;c=b?ResourceStrings.L_BizBarMessage_MarkedAsFinal_DocIsEdited:ResourceStrings.L_BizBarMessage_MarkedAsFinal;l=b;b=1;break;case 20:a=ResourceStrings.L_BizBarTitle_Readonly;
c=ResourceStrings.l_BizBarMessage_MarkedAsReadOnlyRecommended;y=!0;b=3;break;case 16:a=ResourceStrings.L_BizBarTitle_CannotConnectToInternet;c=ResourceStrings.L_BizBarMessage_CannotConnectToInternet;f=!0;b=1;break;case 17:a=b?ResourceStrings.L_BizBarTitle_ChangesCannotBeSavedInThisFile:ResourceStrings.L_BizBarTitle_Readonly;c=b?ResourceStrings.L_BizBarMessage_ServerError_UserHasEditedDoc_Download:ResourceStrings.L_BizBarMessage_ServerError_UserNotEditedDoc;H=b;b=1;break;case 15:a=ResourceStrings.L_BizBarTitle_SessionExpired;
c=ResourceStrings.L_BizBarMessage_SessionAccessTokenExpired;f=!0;b=1;break;case 21:a=ResourceStrings.L_BizBarTitle_WopiTokenOutOfRefreshRange;c=ResourceStrings.L_BizBarMessage_WopiTokenOutOfRefreshRange;f=!0;b=1;break;default:return}a=this.wZ.create(a,c||"",null);a.closeable=!0;a.u3=Object(I.a)(this,this.qlh,"readOnlyInfoEntryClosedHandler");a.image=b;f?(xa.a.J(512263711,801,15,"Refresh button is show"),a.addButton(ResourceStrings.L_Refresh,Object(I.a)(this,this.tod,"refreshActionHandler"),"")):l?
(xa.a.J(512263710,801,15,"SaveACopy button is show"),a.addButton(ResourceStrings.L_BizBarButton_SaveACopy,Object(I.a)(this,this.Fel,"saveAsActionHandler"),"")):H?(xa.a.J(512263709,801,15,"DownloadACopy button is show"),a.addButton(ResourceStrings.L_DownloadCopy,Object(I.a)(this,this.AWi,"downloadACopyActionHandler"),"")):y&&(xa.a.J(512263708,801,15,"EditAnyway button is show"),a.addButton(ResourceStrings.l_BizBarButton_EditAnyway,Object(I.a)(this,this.pXi,"editAnywayActionHandler"),""));this.g_b(a);
Array.add(this.gjc,a)}tea(a){return this.Gn.tea(a)}vqj(){let a=0;if(this.Oa.ka("IsUIEmbedMode")||this.Oa.ka("DisablePrint")||!this.Oa.Ha("DownloadACopyUrl")||"true"===this.Oa.Ha("ProtectInClient")||z.a.Vi)return a;let b=!0;this.Oa.ka("SaveToAnotherFolderBrsIsEnabled")&&this.Oa.ka("SupportsGetMoreInfoForPersonalStorage")||(b=!1);let c=!0;this.Oa.ka("SaveACopyBrsIsEnabled")||(c=!1);let f=!0;this.Oa.ka("SaveAsToHostBrsIsEnabled")&&this.Oa.ka("UserCanWriteRelative")&&this.Oa.ka("SupportsEditing")||(f=
!1);a=b?G.a.Jkb:c?G.a.fsc:a;xa.a.J(512263707,801,(b||c)&&(b||f)&&(c||f)?15:50,"BusinessBarController::GetSaveAsCommand saveToSharePoint:{0}, saveACopy:{1}, saveAsToHost:{2}, CommandName: {3} ",b,c,f,a);return a}g_b(a){const b=this.Gn.visible;this.Gn.ji(a);b||this.Fa.tj(Oi.a.cXd,!0)}tod(a){xa.a.J(512263706,801,15,"Refresh button is clicked, ErrorCode:{0}",a.errorCode);this.ia.processAction(ea.a.refresh,2)}qjg(){this.Gn.entries.length||this.Fa.tj(Oi.a.cXd,!1)}V_i(){this.WEe=null;this.Gn.entries.length||
this.Fa.tj(Oi.a.cXd,!1)}qlh(a){Array.remove(this.gjc,a);this.qjg(a);xa.a.J(512263705,801,50,"Read-only info entry is closed")}okd(){this.ia.Ka(ea.a.openInClient,2,!0)}OHi(){this.ia.Ka(ea.a.convertAndEdit,2,!1)}h$k(){w.AFrameworkApplication.cC?this.o2e(CommonUIStrings.l_SensitivitySaveDocumentError):this.ia.Ka(ea.a.MMb,2,this.PGa)}$ph(){this.ia.processAction(ea.a.mrc,2)}iyj(){this.ia.processAction(ea.a.a9b,2)}Fel(){xa.a.J(512263704,801,15,"SaveACopy button is clicked");w.AFrameworkApplication.cC?this.o2e(CommonUIStrings.l_SensitivitySaveDocumentError):
this.ia.Ka(G.a.Jkb,2,!0)}AWi(){xa.a.J(512263703,801,15,"DownloadACopy button is clicked");w.AFrameworkApplication.cC?this.o2e(CommonUIStrings.l_SensitivityDownloadDocumentError):this.ia.Ka(G.a.downloadACopy,2,!0)}o2e(a){xa.a.J(512263702,801,50,"Unable to save/download ppt from business bar as document is protected");const b=new Ai.StandardDialog;b.Ad=0;b.Ty($e.a.lWi,nj.a.V3(ResourceStrings.l_GenericDialogTitle),nj.a.V3(a),null)}pXi(){xa.a.J(512263701,801,50,"EditAnyway button is clicked");this.ia.Ka(ea.a.V4b,
2,20)}aKk(){xa.a.J(512263700,801,50,"Learn More button is clicked");Vm.Redirect.showHelp("0f6cd105-974f-44a4-aadb-43ac5bdfd247")}yYd(){if(this.Qse.$ab&&!this.Vse&&!this.qFg){this.Vse=!0;var a=this.wZ.create("",CommonUIStrings.l_OdfFileCompatWarningBusinessBar,null);a.closeable=!0;a.u3=()=>{this.qFg=!0;this.Vse=!1};a.addButton(CommonUIStrings.l_OdfFileCompatWarningBusinessBarButton,Object(I.a)(this,this.OBk,"onCompatWarningButtonClick"),"");this.g_b(a)}}OBk(){Vm.Redirect.showHelp("PPTODF")}gUf(){for(const a of this.gjc)this.Gn.removeEntry(a);
Array.clear(this.gjc)}zu(a){this.yA&&2===a.mode&&this.gUf()}}Object(m.a)(kB,"BusinessBarController",jB,[1228,1229,107]);class kG{constructor(a,b){this.Gdb=null;this.Lok=b;this.nb=document.createElement("div");this.nb.className="BusinessBarPanel";this.nb.id="BusinessBarPanel";this.Ykc=document.createElement("div");this.Ykc.id="BusinessBarPanelWorking";this.nb.insertBefore(this.Ykc,this.nb.firstChild);a.execute(c=>{this.Gdb=c;this.Lok&&this.Gdb&&(this.Gdb.nQc=!0);this.Ykc.insertBefore(this.Gdb.htmlElement,
this.Ykc.firstChild)});this.nb.style.position=wf.a.Ouc}dispose(){}layout(a,b){if(!this.Gdb||!this.Gdb.visible)return this.Iq(),a;this.jVi(b);this.nb.style.height=rb.a.Pc(this.Gdb.htmlElement.offsetHeight);return a}Iq(){"none"!==this.nb.style.display&&(this.nb.style.display="none")}jVi(a){this.nb.style.display.length&&(this.nb.style.display="");a&&(this.nb.style.direction=wf.a.f2a)}get va(){return this.nb}get xVl(){return this.Ykc}get order(){return 2}}Object(m.a)(kG,"BusinessBarPane",null,[1193,587,
107]);var gx=d(578),lG=d(377);class $o{}$o.Value="value";$o.MinValue="MinValue";$o.MaxValue="MaxValue";$o.Text="Text";Object(m.a)($o,"SliderCommandProperties",null,[]);var ap=d(1154);class Fo{constructor(){this.iconSet=null;this.hidden=this.disabled=!1;this.customTooltip=this.keytip=this.fullDescriptionLabel=this.iconColor=null;this.shouldTakeFocus=!1}}Object(m.a)(Fo,"CommonOptionalButtonProperties",null,[]);class zv extends Fo{constructor(){super();this.role=this.commandValueId=null;this.supportsPreview=
this.hideLabel=!1;this.lang=null;this.dismissHostingSurfaceOnExecute=!1}}Object(m.a)(zv,"OptionalButtonProperties",Fo,[]);class mG extends zv{constructor(){super();this.animateTransition=!1}}Object(m.a)(mG,"AdditionalInkButtonProperties",zv,[]);class Ky extends Fo{constructor(){super();this.menuModel=null;this.hideLabel=!1;this.downChevronIcon=null;this.hideIcon=this.hideChevron=!1;this.labelInMenu=this.lang=null;this.toggled=!1;this.roleInMenu=null}}Object(m.a)(Ky,"OptionalFlyoutAnchorProperties",
Fo,[]);class nG extends Ky{constructor(){super();this.animateTransition=!1}}Object(m.a)(nG,"AdditionalInkFlyoutAnchorProperties",Ky,[]);class oG{constructor(){this.selected=!1;this.iconColor=null}}Object(m.a)(oG,"InkControlState",null,[]);class pG{constructor(){this.keytip=this.iconName=this.label=null}}Object(m.a)(pG,"InkFlyoutAnchorResources",null,[]);class Zr{constructor(){this.SCb=[]}ya(a){this.SCb.push(a)}commit(){appChrome.api.dispatch(this.SCb);Array.clear(this.SCb)}}Object(m.a)(Zr,"AppChromeTransaction",
null,[]);var Oe=d(663);class bp{constructor(a,b,c,f,l){this.CYa=this.EYa=this.DYa=bp.mLc;this.MBj=(y,H,Q)=>{if(1===Q)return 32;if(this.s$.ga(Oe.a.Dua).selected)return this.B3d(),32;!bp.XZc.some(ia=>this.s$.ga(ia).selected&&Oe.a.sla!==ia)&&this.r$.count&&(this.T1b(!1),y=new Zr,this.aI(this.BA,!0,!0,y,!0),this.ia.processAction(ea.a.qie,2),y.commit());return 32};this.n9=(y,H,Q,ia,wa)=>{if(1===Q)return this.Sve?8:32;H=this.s$.ga(Oe.a.sla).selected;y!==ea.a.krd&&this.T1b(y===ea.a.yLa);Q=new Zr;if(this.S0e(this.Woe(wa)))switch(y){case ea.a.ird:case ea.a.jrd:case ea.a.grd:case ea.a.frd:case ea.a.hrd:case ea.a.Zqd:case ea.a.$qd:case ea.a.brd:case ea.a.crd:case ea.a.drd:case ea.a.erd:this.aI(Oe.a.Dua,
!0,!1,Q,!1)}switch(y){case ea.a.ird:this.aI(Oe.a.hA,!0,!0,Q,!0);this.ia.Ka(ea.a.hA,2,wa);this.BA=Oe.a.hA;break;case ea.a.crd:this.aI(Oe.a.hA,!0,!0,Q,!0);this.VMb(Oe.a.hA,this.SXa,Oe.a.mea,[Oe.a.pla,Oe.a.qla],"#000000",wa,Q);this.ia.Ka(ea.a.pla,2,wa);this.BA=Oe.a.hA;break;case ea.a.Zqd:this.aI(Oe.a.hA,!0,!0,Q,!0);this.VMb(Oe.a.hA,this.SXa,Oe.a.mea,[Oe.a.pla,Oe.a.qla],"#000000",wa,Q);this.ia.Ka(ea.a.Cbb,2,wa);this.BA=Oe.a.hA;break;case ea.a.jrd:this.aI(Oe.a.dD,!0,!0,Q,!0);this.ia.Ka(ea.a.dD,2,wa);this.BA=
Oe.a.dD;break;case ea.a.drd:this.aI(Oe.a.dD,!0,!0,Q,!0);this.VMb(Oe.a.dD,this.SXa,Oe.a.mea,[Oe.a.pla,Oe.a.qla],"#e71224",wa,Q);this.ia.Ka(ea.a.qla,2,wa);this.BA=Oe.a.dD;break;case ea.a.$qd:this.VMb(Oe.a.dD,this.SXa,Oe.a.mea,[Oe.a.pla,Oe.a.qla],"#e71224",wa,Q);this.aI(Oe.a.dD,!0,!0,Q,!0);this.ia.Ka(ea.a.mea,2,wa);this.BA=Oe.a.dD;break;case ea.a.grd:this.aI(Oe.a.cD,!0,!0,Q,!0);this.ia.Ka(ea.a.cD,2,wa);this.BA=Oe.a.cD;break;case ea.a.erd:this.aI(Oe.a.cD,!0,!0,Q,!0);this.VMb(Oe.a.cD,this.sEb,Oe.a.Cua,
[Oe.a.DFa],"#fffc00",wa,Q);this.ia.Ka(ea.a.DFa,2,wa);this.BA=Oe.a.cD;break;case ea.a.brd:this.aI(Oe.a.cD,!0,!0,Q,!0);this.VMb(Oe.a.cD,this.sEb,Oe.a.Cua,[Oe.a.DFa],"#fffc00",wa,Q);this.ia.Ka(ea.a.Cua,2,wa);this.BA=Oe.a.cD;break;case ea.a.frd:this.aI(Oe.a.p9,!0,!1,Q,!1);this.ia.Ka(ea.a.p9,2,wa);break;case ea.a.krd:this.aI(Oe.a.sla,!H,!1,Q,!1);this.ia.Ka(ea.a.sla,2,wa);break;case ea.a.hrd:this.aI(Oe.a.q9,!0,!1,Q,!1);this.ia.Ka(ea.a.q9,2,wa);break;case ea.a.yLa:this.aI(Oe.a.EFa,!0,!1,Q,!1),this.aI(Oe.a.Dua,
!1,!1,Q,!1),this.ia.processAction(ea.a.EFa,2)}Q.commit();this.kkk&&gx.ShyRibbon.ARa(1,2);return 32};this.ia=a;this.kkk=f;this.la=l;this.s$=new Uc.a;this.r$=new Uc.a;for(const y of bp.XZc){a="";if(eb.a("PenColorRetentionEnabled"))(a=lG.a.instance.getItem(y+"Color"))||(a=bp.gel[y]);else switch(y){case Oe.a.hA:a="#000000";break;case Oe.a.dD:a="#E71224";break;case Oe.a.cD:a="#FFFC00"}this.s$.$(y,Object.assign(new oG,{selected:!1,iconColor:a}))}w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.ob&&
w.AFrameworkApplication.Aa.ob.Qp&&this.vb();this.SXa=new Na.a;this.SXa.add("#FFC114");this.SXa.add("#F6630D");this.SXa.add("#FF0066");this.SXa.add("#5B2D90");this.sEb=new Na.a;this.sEb.add("#00F900");this.sEb.add("#00FDFF");this.sEb.add("#FF40FF");this.sEb.add("#FF8517");this.BA=Oe.a.hA;b.fJc(Object(I.a)(this,this.SU,"onFocusChanged"));this.Sve=!c||!c.Jc}vb(){this.ia.ra(ea.a.rie,yb.a.application,Object(I.a)(this,this.wYi,"enableMRUPenAndDisableDrawWithTouch"),4);this.ia.ra(ea.a.bkg,yb.a.application,
Object(I.a)(this,this.DEj,"handleRefreshInkUIValues"),4);this.ia.ra(ea.a.YZc,yb.a.application,Object(I.a)(this,this.LBj,"handleInkSetInkRibbonManagerDisabledState"),4);this.ia.ra(ea.a.ird,yb.a.application,this.n9,4);this.ia.ra(ea.a.jrd,yb.a.application,this.n9,4);this.ia.ra(ea.a.grd,yb.a.application,this.n9,4);this.ia.ra(ea.a.krd,yb.a.application,this.n9,4);this.ia.ra(ea.a.Zqd,yb.a.application,this.n9,4);this.ia.ra(ea.a.$qd,yb.a.application,this.n9,4);this.ia.ra(ea.a.brd,yb.a.application,this.n9,
4);this.ia.ra(ea.a.crd,yb.a.application,this.n9,4);this.ia.ra(ea.a.drd,yb.a.application,this.n9,4);this.ia.ra(ea.a.erd,yb.a.application,this.n9,4);this.ia.ra(ea.a.JYe,yb.a.application,Object(I.a)(this,this.wfe,"handleThicknessSliderChanged"),4);this.ia.ra(ea.a.KYe,yb.a.application,Object(I.a)(this,this.wfe,"handleThicknessSliderChanged"),4);this.ia.ra(ea.a.LYe,yb.a.application,Object(I.a)(this,this.wfe,"handleThicknessSliderChanged"),4);this.ia.ra(ea.a.IYe,yb.a.application,Object(I.a)(this,this.JBj,
"handleInkDrawWithTouchSelected"),4);eb.a("PenDownHandlingEnabled")&&this.ia.ra(ea.a.Nuh,yb.a.application,this.MBj,4);this.ia.ra(ea.a.frd,yb.a.application,this.n9,4);this.ia.ra(ea.a.hrd,yb.a.application,this.n9,4);this.ia.ra(ea.a.yLa,yb.a.application,this.n9,4)}LBj(a,b,c,f,l){if(1===c)return 32;this.Sve=l;return 32}DEj(a,b,c){if(1===c)return 32;a=new Zr;this.FNb(Oe.a.FFa,this.DYa,a);this.FNb(Oe.a.GFa,this.EYa,a);this.FNb(Oe.a.HFa,this.CYa,a);a.commit();this.r$.count||this.W9j();return 32}JBj(a,b,
c,f,l){if(1===c)return this.Sve?8:32;a=l&&l.forceDisable?l.forceDisable:!1;this.s$.ga(Oe.a.Dua).selected||a?(this.T1b(!1),this.B3d()):(this.T1b(!1),a=new Zr,this.aI(Oe.a.Dua,!0,!1,a,!1),this.aI(this.BA,!0,!0,a,!0),a.commit(),this.ia.Ka(ea.a.oie,2,{enable:!0}));return 32}wfe(a,b,c,f,l){if(1===c)return 32;b=new Zr;eb.a("DrawWithTouchEnabledOnThicknessSliderMove")||this.aI(Oe.a.Dua,!0,!1,b,!1);l&&l&&(l[bp.Qyl]=$o.Value);switch(a){case ea.a.JYe:this.ia.Ka(ea.a.FFa,2,l);this.DYa=this.Eab(l);this.FNb(Oe.a.FFa,
this.DYa,b);this.BA=Oe.a.hA;break;case ea.a.KYe:this.ia.Ka(ea.a.GFa,2,l);this.EYa=this.Eab(l);this.FNb(Oe.a.GFa,this.EYa,b);this.BA=Oe.a.dD;break;case ea.a.LYe:this.ia.Ka(ea.a.HFa,2,l),this.CYa=this.Eab(l),this.FNb(Oe.a.HFa,this.CYa,b),this.BA=Oe.a.cD}b.commit();return 32}isEnabled(a){return this.s$.ga(a).selected}wYi(a,b,c){if(1===c)return 32;if(!tg.c())return xa.a.J(512493019,801,15,"Ribbon should be initialized when calling EnableMRUPenAndDisableDrawWithTouch."),8;if(!this.r$.count)return 32;this.T1b(!1);
this.B3d();this.s$.ga(this.BA).selected=!1;a=new Zr;this.aI(this.BA,!0,!0,a,!0);this.ia.processAction(ea.a.qie,2);a.commit();return 32}W9j(){for(const a of bp.XZc)switch(a){case Oe.a.hA:this.mdc(Oe.a.hA);break;case Oe.a.dD:this.mdc(Oe.a.dD);break;case Oe.a.cD:this.mdc(Oe.a.cD);break;case Oe.a.p9:this.mdc(Oe.a.p9);break;case Oe.a.q9:this.mdc(Oe.a.q9)}}mdc(a){const b=appChrome.selectors.getInkButtonState(a);this.r$.$(a,Object.assign(new pG,{label:Oe.a.A1f in b?Object(qa.a)(String,b[Oe.a.A1f]):"",iconName:Oe.a.y1f in
b?Object(qa.a)(String,b[Oe.a.y1f]):"",keytip:Oe.a.z1f in b?Object(qa.a)(String,b[Oe.a.z1f]):""}))}T1b(a){const b=new Zr;for(const c of bp.XZc)if(c!==Oe.a.sla)switch(this.aI(c,!1,!1,b,!0),c){case Oe.a.hA:this.cvb(Oe.a.hA,b,!0,a);break;case Oe.a.dD:this.cvb(Oe.a.dD,b,!0,a);break;case Oe.a.cD:this.cvb(Oe.a.cD,b,!0,a);break;case Oe.a.p9:this.cvb(Oe.a.p9,b,!0,a);break;case Oe.a.q9:this.cvb(Oe.a.q9,b,!0,a)}b.commit()}UOh(a,b,c){c.ya(appChrome.actions.toggleButton(a,b));this.s$.ga(a).selected=b}aI(a,b,c,
f,l){c?b?(b&&!this.s$.ga(a).selected&&this.LDi(a,f,l),this.UOh(a,b,f)):this.cvb(a,f,l,a!==Oe.a.EFa):this.UOh(a,b,f)}cvb(a,b,c,f){if(this.r$.Fb(a)){var l=this.r$.ga(a).iconName,y=this.r$.ga(a).keytip,H=this.r$.ga(a).label,Q=this.W9d(a);a=appChrome.api.createInkButtonModel(a,Q?Q:H,Object.assign(new mG,{iconSet:(new ap.a(l)).iconSet,iconColor:this.s$.ga(a).iconColor,keytip:y,animateTransition:c&&!f}));b.ya(appChrome.actions.addControls([a]))}}LDi(a,b,c){if(this.r$.Fb(a)){var f=this.W9d(a),l=this.r$.ga(a).iconName,
y=this.r$.ga(a).keytip,H=this.r$.ga(a).label;a=appChrome.api.createInkFlyoutAnchorModel(a,f?f:H,Object.assign(new nG,{iconSet:(new ap.a(l)).iconSet,iconColor:this.s$.ga(a).iconColor,keytip:y,menuModel:appChrome.getInkFlyoutAnchorMenuModel(a),animateTransition:c}));b.ya(appChrome.actions.addControls([a]))}}W9d(a){if(this.la.ka("InkColorLabelEnabled")){var b=void 0;switch(a){case Oe.a.hA:case Oe.a.dD:var c=appChrome.selectors.getColorPickerState(Oe.a.mea);break;case Oe.a.cD:c=appChrome.selectors.getColorPickerState(Oe.a.Cua)}c&&
(c=this.DOf(Array.isArray(c.colorCells)?c.colorCells:null),b=this.r$.ga(a).label,b=`${b.split(":")[0]}: ${c[this.s$.ga(a).iconColor].label}`);return b}}Dll(a,b,c){c.ya(appChrome.actions.updateIconColor(a,b));this.Ell(a,c)}Ell(a,b){let c=this.W9d(a);c&&b.ya(appChrome.actions.setControlLabel(a,c))}Fll(a,b,c){c.ya(appChrome.actions.populateColorPickerCells(a,b))}FNb(a,b,c){c.ya(appChrome.actions.updateSliderSelectedValue(a,b))}OPk(a,b,c,f){if(a=appChrome.selectors.getColorPickerState(a)){a=this.DOf(Array.isArray(a.colorCells)?
a.colorCells:null);for(const l of b)this.Fll(l,this.Qkj(a,c),f)}}Rkj(a,b){const c=a.indexOf(b);-1===c?a.removeAt(a.count-1):a.removeAt(c);a.insert(0,b)}DOf(a){const b={};for(const c of a)b[c.id]=c;return b}Qkj(a,b){const c=[];for(let f of b)f in a&&Array.add(c,a[f]);return c}Woe(a){return a&&a.InputMethod?a.InputMethod===Oe.a.uie:!1}S0e(a){return!a||z.a.Vi||z.a.yac}Jqj(a,b){a&&a.Color&&(b=6===Object(qa.a)(String,a.Color).length?"#"+a.Color:Object(qa.a)(String,a.Color));return b}VMb(a,b,c,f,l,y,H){l=
this.Jqj(y,l);this.s$.ga(a).iconColor=l;eb.a("PenColorRetentionEnabled")&&lG.a.instance.setItem(a+"Color",l);this.Dll(a,l,H);this.Rkj(b,l);this.OPk(c,f,b,H)}B3d(){const a=new Zr;this.aI(Oe.a.Dua,!1,!1,a,!1);this.ia.Ka(ea.a.oie,2,{enable:!1});a.commit()}SU(a,b){b.zKb===jb.a.jP&&b.Shb!==jb.a.jP&&this.ia.processAction(ea.a.$jg,2);b.zKb!==jb.a.vg&&b.Shb===jb.a.vg&&this.ia.processAction(ea.a.dkg,2)}Eab(a){return a&&a[$o.Value]?a[$o.Value]:bp.mLc}}bp.Qyl="SliderCommandPropertiesValueKey";bp.mLc=3;bp.XZc=
[Oe.a.hA,Oe.a.dD,Oe.a.Dua,Oe.a.p9,Oe.a.cD,Oe.a.sla,Oe.a.q9,Oe.a.EFa];bp.gel={[Oe.a.hA]:"#000000",[Oe.a.dD]:"#E71224",[Oe.a.cD]:"#FFFC00"};Object(m.a)(bp,"InkRibbonManager",null,[1195]);class qG{constructor(a){this.zue=a}get lza(){return this.zue.lza}mVc(){return this.zue.mVc()}IWe(){this.zue.IWe()}}Object(m.a)(qG,"PPTChromeExtensionHelper",null,[1188,1212]);var rG=d(1056);class Ly{}Ly.IGh="TabId";Object(m.a)(Ly,"RibbonSQMProperties",null,[]);class lB{constructor(a){this.Ca=a;this.Ca.ya(G.a.Cpd,ie.a.frame,
Object(I.a)(this,this.Cpd,"reportTabSwitch"));this.Ca.ya(G.a.Bqh,ie.a.frame,vf.ActionManager.Sg);this.Ca.ya(G.a.Dqh,ie.a.frame,vf.ActionManager.Sg)}Cpd(a,b,c,f,l){this.Ca.processAction(this.Lpj(l[Ly.IGh]),2);return 32}}Object(m.a)(lB,"RibbonSQMInformation",null,[1194]);class Ah{}Ah.CIc="PptRibbon.AddIns";Ah.animations="PptRibbon.Animation";Ah.design="PptRibbon.Design";Ah.RPc="PptRibbon.Developer";Ah.gYc="PptRibbon.Graphics";Ah.help="PptRibbon.Help";Ah.home="PptRibbon.Home";Ah.insert="PptRibbon.InsertTab";
Ah.picture="PptRibbon.PictureFormat";Ah.review="PptRibbon.Review";Ah.shape="PptRibbon.DrawingFormat";Ah.slideShow="PptRibbon.SlideShow";Ah.smartArt="PptRibbon.SmartArt";Ah.mHh="ContextualTabs.Tables.Design";Ah.tableLayout="ContextualTabs.Tables.Layout";Ah.D2a="PptRibbon.Transition";Ah.view="PptRibbon.View";Object(m.a)(Ah,"MLRTabIds",null,[]);class Dj{}Dj.CIc="AddIns";Dj.animations="Animations";Dj.design="Design";Dj.RPc="Developer";Dj.draw="Draw";Dj.gYc="Graphics";Dj.help="Help";Dj.home="Home";Dj.insert=
"Insert";Dj.picture="FormatPicture";Dj.review="Review";Dj.shape="FormatShape";Dj.slideShow="SlideShow";Dj.smartArt="SmartArtDesign";Dj.table="Table";Dj.D2a="Transitions";Dj.view="View";Object(m.a)(Dj,"SLRTabIds",null,[]);class sG extends lB{constructor(a){super(a)}v4k(){this.Ca.ya(G.a.nqh,ie.a.frame,vf.ActionManager.Sg);this.Ca.ya(ea.a.oqh,ie.a.frame,vf.ActionManager.Sg);this.Ca.ya(ea.a.pqh,ie.a.frame,vf.ActionManager.Sg);this.Ca.ya(G.a.qqh,ie.a.frame,vf.ActionManager.Sg);this.Ca.ya(ea.a.sqh,ie.a.frame,
vf.ActionManager.Sg);this.Ca.ya(G.a.tqh,ie.a.frame,vf.ActionManager.Sg);this.Ca.ya(G.a.uqh,ie.a.frame,vf.ActionManager.Sg);this.Ca.ya(G.a.vqh,ie.a.frame,vf.ActionManager.Sg);this.Ca.ya(ea.a.wqh,ie.a.frame,vf.ActionManager.Sg);this.Ca.ya(G.a.xqh,ie.a.frame,vf.ActionManager.Sg);this.Ca.ya(ea.a.yqh,ie.a.frame,vf.ActionManager.Sg);this.Ca.ya(ea.a.zqh,ie.a.frame,vf.ActionManager.Sg);this.Ca.ya(ea.a.Aqh,ie.a.frame,vf.ActionManager.Sg);this.Ca.ya(ea.a.qWe,ie.a.frame,vf.ActionManager.Sg);this.Ca.ya(ea.a.Cqh,
ie.a.frame,vf.ActionManager.Sg);this.Ca.ya(G.a.Eqh,ie.a.frame,vf.ActionManager.Sg)}Lpj(a){let b=G.a.Dqh,c="PptRibbon.Unknown";switch(a){case Ah.CIc:case Dj.CIc:c=Ah.CIc;b=G.a.nqh;break;case Ah.animations:case Dj.animations:c=Ah.animations;b=ea.a.oqh;break;case Ah.design:case Dj.design:c=Ah.design;b=ea.a.pqh;break;case Ah.RPc:case Dj.RPc:c=Ah.RPc;b=G.a.qqh;break;case Dj.draw:c=a;b=ea.a.rqh;break;case Ah.gYc:case Dj.gYc:c=Ah.gYc;b=ea.a.sqh;break;case Ah.help:case Dj.help:c=Ah.help;b=G.a.tqh;break;case Ah.home:case Dj.home:c=
Ah.home;b=G.a.uqh;break;case Ah.insert:case Dj.insert:c=Ah.insert;b=G.a.vqh;break;case Ah.picture:case Dj.picture:c=Ah.picture;b=ea.a.wqh;break;case Ah.review:case Dj.review:c=Ah.review;b=G.a.xqh;break;case Ah.shape:case Dj.shape:c=Ah.shape;b=ea.a.yqh;break;case Ah.slideShow:case Dj.slideShow:c=Ah.slideShow;b=ea.a.zqh;break;case Ah.smartArt:case Dj.smartArt:c=Ah.smartArt;b=ea.a.Aqh;break;case Ah.mHh:case Ah.tableLayout:c=a;b=ea.a.qWe;break;case Dj.table:c=Ah.mHh;b=ea.a.qWe;break;case Ah.D2a:case Dj.D2a:c=
Ah.D2a;b=ea.a.Cqh;break;case Ah.view:case Dj.view:c=Ah.view,b=G.a.Eqh}if(a=Nc.a.Kb)a.actionName=c,a.Oj=!0,a.vr=!1;return b}}Object(m.a)(sG,"PPTWebEditorRibbonSQMInformation",lB,[]);var Av=d(941);class mB{constructor(){this.TRb=null}EKl(){this.TRb||(this.TRb=Ib.a.instance.qb("Common.App.AccountSwitching.IAccountSwitching"))||ka.ULS.sendTraceTag(589050651,1300,10,"Unable to resolve IAccountSwitching")}z$i(){this.EKl();return this.TRb?this.TRb.getCustomAuthConfig():null}static kVj(){return w.AFrameworkApplication.fa.ka("UiHostSupportsCustomAuthConfig")}}
Object(m.a)(mB,"ReactSharedHeaderAccountSwitchingUtils",null,[]);class nB{constructor(){this.Ucc=this.cultureName=null}}Object(m.a)(nB,"HeaderCultureInfo",null,[]);var My=d(681);class tG{constructor(){this.getTokenRequestDictionary=this.userRing=this.loadTellMeResources=null}}Object(m.a)(tG,"SearchInitializationSettings",null,[]);class uG{constructor(){this.saveStatus=this.documentTitle=null;this.isVersionHistoryEnabled=!1;this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=
this.breadcrumbBrandName=null;this.hideDocumentTitleInput=!1;this.getCalloutAppProps=this.onFirstRender=this.onGetSuggestedTitle=this.documentExtension=null;this.isShared=!1}}Object(m.a)(uG,"DocumentTitleAppProps",null,[]);class vG{constructor(){this.documentExtension=this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.isMoveEnabled=this.isVersionHistoryEnabled=this.hideDocumentTitleInput=!1;this.renameDisableReason=this.message=this.onMove=
null;this.openBreadcrumbsInNewTab=!1}}Object(m.a)(vG,"DocumentTitleCalloutAppProps",null,[]);class wG{constructor(){this.language=this.culture=this.userID=this.emailAddress=this.userDisplayName=this.appName=null;this.defaultDocumentTitleToLeft=this.hideUserName=this.showDiscoverPremiumButton=this.showMeControl=this.showAppLauncher=this.isConsumer=!1;this.documentTitleAppProps=this.controls=this.assetsContainerOverride=null;this.showGoPremiumControl=this.enableSearchControl=this.showSearchControl=
this.showChatControl=!1;this.onFlexPaneClose=this.onFlexPaneOpen=this.getTokenRequestDictionary=this.signOutLink=this.signInLink=null;this.enableTheming=!1;this.userRing=null;this.testTraffic=!1;this.onLoadFailed=this.onFullyLoaded=this.onFirstRender=this.loadTellMeResources=null;this.showDocumentTitleControl=this.showRibbonToggle=this.showWorkflowButton=this.enableVanillaSearchBox=!1;this.shellAuthProviderConfigPromise=null;this.enableUpdatedRUMReporting=!1}}Object(m.a)(wG,"HeaderAppProps",null,
[]);class xG{constructor(){this.workflowButton=this.ribbonToggleId=null}}Object(m.a)(xG,"HeaderControls",null,[]);class yG{constructor(){this.command=this.label=null}}Object(m.a)(yG,"WorkflowButtonAppProps",null,[]);var Ny;(function(a){a[a.none=0]="none";a[a.readOnly=1]="readOnly";a[a.insufficientPermission=2]="insufficientPermission";a[a.incompatibleEditorsPresent=3]="incompatibleEditorsPresent";a[a.editorsPresent=4]="editorsPresent";a[a.notSupported=5]="notSupported"})(Ny||(Ny={}));Object(m.b)("RenameDisableReason",
Ny);class zG{constructor(a=""){this.uYe=this.documentTitleAppProps=this.V$e=null;this.g8h=""!==a?a:$a.a.vP}Xoj(a){const b=Ib.a.instance.qb("Common.IExternalUICommandDefinitionMapping").IEa(a);if(b&&0<b.length)return b[0].externalUxCommand;ka.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",a));return null}pee(){if(!this.V$e){const a=Av.a();if(a){const b=this.Xoj(a.command);b&&(this.V$e=Object.assign(new yG,{command:b,label:a.label}))}}return this.V$e}Pdj(){return Object.assign(new xG,
{workflowButton:this.pee()})}ICk(){Pd.a.get_instance().ZH(17)}onMove(){const a={};a.MoveButtonClickedTime=new Date;w.AFrameworkApplication.Ra.Ka(G.a.Nhb,2,a)}ypj(a){switch(a){case 1:return CommonUIStrings.l_CalloutRenameReadOnlyError;case 2:return CommonUIStrings.l_CalloutRenamePermissionError;case 3:case 4:return CommonUIStrings.l_CalloutRenameCoauthError;case 5:return null;default:return CommonUIStrings.l_CalloutRenameGenericError}}Sfj(){let a=null,b=null;var c=Ib.a.instance.qb("Common.IRenameProps");
c?(c=c.$$f(),0!==c&&(a=this.ypj(c),b=Ny[c])):ka.ULS.sendTraceTag(572375621,340,15,"IRenameProps not yet initialized");return Object.assign(new vG,{breadcrumbBrandName:w.AFrameworkApplication.du.breadcrumbBrandName,breadcrumbBrandUrl:w.AFrameworkApplication.du.breadcrumbBrandUrl,breadcrumbFolderName:w.AFrameworkApplication.du.breadcrumbFolderName,breadcrumbFolderUrl:w.AFrameworkApplication.du.breadcrumbFolderUrl,hideDocumentTitleInput:w.AFrameworkApplication.Aa.ob.EIj,isVersionHistoryEnabled:this.Wtl(),
documentExtension:ma.a.AQ(w.AFrameworkApplication.fileName),isMoveEnabled:32===w.AFrameworkApplication.Ra.processAction(G.a.Nhb,1),onMove:Object(I.a)(this,this.onMove,"onMove"),message:a,renameDisableReason:b,openBreadcrumbsInNewTab:w.AFrameworkApplication.fa.ka("OpenLinksInNewWindow")})}w6f(){if(!this.documentTitleAppProps){const a=w.AFrameworkApplication.du.rx;this.documentTitleAppProps=Object.assign(new uG,{documentTitle:w.AFrameworkApplication.AQc?a:ma.a.iH(a),onFirstRender:Object(I.a)(this,this.ICk,
"onDocumentTitleFirstRender"),getCalloutAppProps:Object(I.a)(this,this.Sfj,"getDocumentFlyoutProperties"),isShared:!1})}return this.documentTitleAppProps}Wtl(){return!!w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.ob.Srg}$rl(){return!!w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.ob.d3j}Gtl(){const a=!Av.b()&&!w.AFrameworkApplication.hideHeader&&!w.AFrameworkApplication.shg&&(w.AFrameworkApplication.fa.ka("SkypeWebControlIsEnabled")||w.AFrameworkApplication.fa.ka("TeamsChatIsEnabled"));
ka.ULS.sendTraceTag(592315859,215,50,"ShowChat is {0}",a);return a}HHi(a){appChrome.getHeaderApi().then(b=>{b.setNavBarData(a.result);return null});ka.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")}J2k(){appChrome.getHeaderApi().then(a=>{const b=Ib.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");a.setHeaderCommandHandler("OnFirstRender",()=>{this.onFirstRender()});a.setHeaderCommandHandler("OnFullyLoaded",()=>{this.onFullyLoaded()});a.setHeaderCommandHandler("OnFlexPaneOpen",
c=>{b.onFlexPaneOpen(c)});a.setHeaderCommandHandler("OnFlexPaneClose",c=>{b.onFlexPaneClose(c)});a.setHeaderCommandHandler("SetCookie",c=>pi.a.set(c.cookieName,c.value));a.setHeaderCommandHandler("GetCookie",c=>this.Qdj(c));a.setHeaderCommandHandler("QueryWorkflowButtonSettings",Object(I.a)(this,this.pee,"getWorkflowButtonAppProps"));a.setHeaderCommandHandler("QueryDocumentTitleAppProps",Object(I.a)(this,this.w6f,"getDocumentTitleAppProps"));a.setHeaderCommandHandler("OnDocumentTitleReducerReady",
()=>{this.JCk();return null});My.a.L2c()&&a.setHeaderCommandHandler("QuerySearchInitializationSettings",Object(I.a)(this,this.Aag,"getSearchInitializationSettings"))})}JCk(){Ib.a.instance.Ia("Common.App.SaveStatus.ISaveStatusUIHandler").execute(a=>{a.Xpa(!1,w.AFrameworkApplication.Ra.mode)})}Qdj(a){a=pi.a.get(a);void 0!==a&&null!==a&&0<a.length&&(a=decodeURIComponent(a));return a}Xtj(){return lk.AppChromeOverrideUtilities.isEnabled?lk.AppChromeOverrideUtilities.getPath("suiteux-shell",!1):this.g8h+
w.AFrameworkApplication.L1+"suiteux-shell"}onFirstRender(){Ib.a.instance.Ia("Common.App.O365Shell.IO365ShellActor").execute(a=>{a.jrl.continueWith(Object(I.a)(this,this.HHi,"continueShellServiceDataAsync"),3)});Pd.a.get_instance().ZH(15)}onFullyLoaded(){Pd.a.get_instance().ZH(16)}Hoj(){a:{try{var a=bb.a.He(w.AFrameworkApplication.lcid);if(a){var b=Object.assign(new nB,{cultureName:a.name,Ucc:a.Ucc});break a}}catch(c){ka.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+
w.AFrameworkApplication.lcid.toString())}b=Object.assign(new nB,{cultureName:"en-us",Ucc:"en"})}a=Ib.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");b=Object.assign(new wG,{appName:CommonUIStrings.l_AppNameShort,culture:b.cultureName,language:b.Ucc,isConsumer:!w.AFrameworkApplication.Syd,showAppLauncher:Av.f(),showMeControl:Av.e(),hideUserName:w.AFrameworkApplication.rge,defaultDocumentTitleToLeft:w.AFrameworkApplication.GRf,assetsContainerOverride:this.Xtj(),controls:this.Pdj(),
documentTitleAppProps:this.w6f(),showDocumentTitleControl:!0,showWorkflowButton:!!this.pee(),showChatControl:this.Gtl(),showGoPremiumControl:Av.g(),showDiscoverPremiumButton:Av.d(),enableSearchControl:My.a.B2j(),onFlexPaneOpen:Object(I.a)(a,a.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:Object(I.a)(a,a.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.$rl(),testTraffic:w.AFrameworkApplication.fa.ka("SharedHeaderTestTrafficIsEnabled"),onFirstRender:Object(I.a)(this,this.onFirstRender,"onFirstRender"),
onFullyLoaded:Object(I.a)(this,this.onFullyLoaded,"onFullyLoaded"),enableUpdatedRUMReporting:w.AFrameworkApplication.asl()});!w.AFrameworkApplication.Anb||w.AFrameworkApplication.J2e?(b.userDisplayName=w.AFrameworkApplication.userName,b.emailAddress=w.AFrameworkApplication.fa.Ha("UserPrincipalName"),b.userID=w.AFrameworkApplication.fa.Ha("Puid")||"",b.signOutLink=w.AFrameworkApplication.J2e):w.AFrameworkApplication.signInUrl&&(b.signInLink=w.AFrameworkApplication.signInUrl);My.a.L2c()&&(a=this.Aag(),
b.loadTellMeResources=a.loadTellMeResources,b.getTokenRequestDictionary=a.getTokenRequestDictionary,b.enableVanillaSearchBox=w.AFrameworkApplication.fa.ka("VanillaSearchUxInHeaderIsEnabled"),b.userRing=a.userRing);mB.kVj()&&(a=new mB,b.shellAuthProviderConfigPromise=Object(I.a)(a,a.z$i,"getAccountSwitchingConfig"));this.J2k();return b}Aag(){if(!this.uYe){const a=new My.a;let b=w.AFrameworkApplication.fa.Ha("Microsoft365Ring");b&&b.length||(b="generalAudience");this.uYe=Object.assign(new tG,{loadTellMeResources:a.r$j(),
getTokenRequestDictionary:Object(I.a)(a,a.uvj,"getTokenRequestDict"),userRing:b})}return this.uYe}}Object(m.a)(zG,"ReactSharedHeaderPropsHelper",null,[1108]);var wg=d(353),sQ=d(1270),tQ=d(1108);d(942);var AG=d(680);const fu=(a,b)=>{let c=0;for(;b()&&c<a.length;)a[c](),c++},BG=(a,b,c,f)=>{if(a&&a.parentNode&&a.parentNode.parentNode){var l=(l=af.a.rt(a))?Ea.a.TM(l.paddingLeft)+Ea.a.TM(l.paddingRight):0;var y=af.a.rt(a.parentNode);y=y?Ea.a.TM(y.paddingLeft)+Ea.a.TM(y.paddingRight):0;let H=0,Q=a;for(;Q.nextSibling;)Q=
Q.nextSibling,H+=Q.offsetWidth;l=l+y+H;"auto"!==a.parentNode.style.width&&(a.style.width=a.parentNode.offsetWidth-l+"px");y=f?c:b;c=f?b:c;f=Bd.a.ki(a.parentNode.parentNode);b=y?Bd.a.ki(y):new Sys.UI.Bounds(f.x,0,0,0);c=c?Bd.a.T$a(c):new Sys.UI.Point(f.x+f.width,0);"absolute"===a.parentNode.style.position?b=c.x-(b.x+b.width)-l-1:(f=Bd.a.ki(a.nextSibling?a.parentNode:a),f=f.x+f.width/2,b=2*Math.min(f-(b.x+b.width),c.x-f)-l-1);a.style.maxWidth=b+"px"}},Oy=a=>{a&&mr(a)&&(a.style.display="",a._isHidden=
"0")},kl=a=>{a&&!mr(a)&&(a.style.display="none",a._isHidden="1")},mr=a=>{if(!a)return!0;a=a._isHidden;return!(void 0===a||null===a||"0"===a)},Zs=(a,b,c)=>{if(a&&!mr(a)){var f=af.a.rt(a);f=Ea.a.TM(f.paddingLeft)+Ea.a.TM(f.paddingRight);c=a.offsetWidth-c-f;let l=0;for(;b&&b!==a;)(f=af.a.rt(b))&&(l+=Ea.a.TM(f.paddingLeft)+Ea.a.TM(f.paddingRight)),b=b.parentNode;c=Math.max(c,75+l);a.style.width=c+"px"}},$r=a=>{a&&(a.style.width="auto",a.style.maxWidth="none")},uQ=(a,b,c)=>{if(a&&b){let f=0,l=0;({left:f,
top:l}=Bd.a.D6f(b,f,l));b=c?f-a.offsetWidth:f+b.offsetWidth;a&&(a.style.position="absolute",a.style.left=b+"px")}},Bq=(a,b,c)=>!a||!b||mr(a)||mr(b)?!1:Bd.a.Rug(Bd.a.ki(a),Bd.a.ki(b),c),$s=(a,b,c)=>{let f=0;a&&b&&(f=Bd.a.Dre(Bd.a.ki(a),Bd.a.ki(b),c));return f};var at=d(368);class Py{constructor(a,b,c){this.xwb=this.i5b=this.wwb=this.K9a=this.XQc=this.h5b=this.eH=this.g5b=this.NSa=this.wQ=this.YQc=this.MSa=this.zda=this.Cv=this.uL=this.xT=this.LSa=this.J9a=this.I9a=this.bEa=null;this.zS=a;this.PTb=
b;this.kl=c}nfl(a){this.zS=a;this.PTb=null;this.H7d(this.zS);this.dMh();this.iuh()}X0a(){this.zS&&this.PTb&&this.PTb.clientHeight&&(this.H7d(this.zS),this.dMh(),this.iuh(),-1!==this.PTb.parentNode.parentNode.className.indexOf("cui-ribbon")&&(this.x0f(this.PTb),this.GLl(),this.rfl()))}H7d(a){if(a)for(let c=0;c<a.childNodes.length;c++){const f=a.childNodes[c],l=Ea.a.Hka(f),y=!!f.id;if(-1!==l.indexOf("cui-QATRowLeft"))this.bEa=f;else if(-1!==l.indexOf("OfficeOnlineBrandBreadcrumbSeparator"))this.I9a=
f;else if(f.id===Em.CuiHelper.yWd)this.J9a=f;else if(f.id===Em.CuiHelper.O1f)this.LSa=f;else if(f.id===Em.CuiHelper.zWd)this.xT=f;else if(-1!==l.indexOf("cui-QATRowCenter"))this.uL=f;else if(f.id===Em.CuiHelper.AWd)this.Cv=f;else if(-1!==l.indexOf("cui-QATRowRight"))this.zda=f;else{var b;if(b=y)b=f,b=!!b.id&&(b.id.startsWith(Em.CuiHelper.C0e)||b.id.startsWith(Em.CuiHelper.zpd));b?this.MSa=f:y&&f.id.startsWith(Em.CuiHelper.iyl)?this.YQc=f:-1!==l.indexOf("UsernameNameContainer")?this.wQ=f:-1!==l.indexOf("UsernameNameItem")&&
(this.NSa=f)}this.H7d(f)}}dMh(){var a=[this.uL,this.Cv,this.wQ],b=[this.I9a,this.J9a,this.LSa,this.xT,this.uL,this.Cv,this.zda,this.MSa,this.YQc,this.wQ];for(const c of b)Oy(c);for(const c of a)$r(c);if(a=this.uL)a.style.position="static",a.style.left="auto"}iuh(){this.N_d()?this.pfl():this.qfl();var a=this.LSa,b=this.xT;a&&b&&(a.style.marginTop=(b.offsetHeight-a.offsetHeight)/2+"px")}pfl(){let a;const b=this.V$d();a=[()=>{Zs(this.xT,this.xT,$s(this.bEa,b,this.kl))},()=>{kl(this.I9a);kl(this.J9a);
kl(this.LSa);kl(this.xT)}];fu(a,()=>Bq(this.xT,b,this.kl));Bq(this.eH,this.uL,this.kl)&&uQ(this.uL,this.eH,this.kl);this.Crh();a=[()=>{Zs(this.wQ,this.NSa,$s(this.eH,this.zda,this.kl))},()=>{kl(this.MSa)}];this.Drh();mr(this.uL)||mr(this.Cv)||BG(this.Cv,this.eH,this.zda,this.kl)}qfl(){const a=!!this.xT,b=!!this.Cv;let c=0;if((a||b)&&0<(c=$s(this.bEa,this.uL,this.kl))){let f=a;b&&(!a||this.Cv.offsetWidth>this.xT.offsetWidth)&&(f=!1);Zs(f?this.xT:this.Cv,f?this.xT:this.Cv,f?c:2*c);a&&b&&0<(c=$s(this.bEa,
this.uL,this.kl))&&(f=!f,Zs(f?this.xT:this.Cv,f?this.xT:this.Cv,f?c:2*c))}fu([()=>{kl(this.I9a);kl(this.J9a);kl(this.LSa);kl(this.xT);$r(this.Cv)},()=>{Zs(this.Cv,this.Cv,2*$s(this.bEa,this.uL,this.kl))},()=>{kl(this.Cv)}],()=>Bq(this.bEa,this.uL,this.kl));this.Crh();this.Drh();mr(this.uL)||mr(this.Cv)||BG(this.Cv,this.bEa,this.zda,this.kl)}Crh(){const a=mr(this.Cv);fu([()=>{this.WWe()},()=>{kl(this.MSa);$r(this.Cv);$r(this.wQ);a||Oy(this.Cv)},()=>{this.WWe()},()=>{kl(this.YQc);$r(this.Cv);$r(this.wQ);
a||Oy(this.Cv)},()=>{this.WWe()}],()=>Bq(this.uL,this.zda,this.kl))}WWe(){const a=!!this.Cv,b=!!this.wQ;let c=0;if((a||b)&&0<(c=$s(this.uL,this.zda,this.kl))){const f=!!this.uL&&"absolute"!==this.uL.style.position;let l=a;b&&(!a||this.wQ.offsetWidth>this.Cv.offsetWidth)&&(l=!1);Zs(l?this.Cv:this.wQ,l?this.Cv:this.NSa,l&&f?2*c:c);a&&b?(0<(c=$s(this.uL,this.zda,this.kl))&&(l=!l,Zs(l?this.Cv:this.wQ,l?this.Cv:this.NSa,l&&f?2*c:c)),Bq(this.uL,this.zda,this.kl)&&(kl(this.uL),$r(this.wQ))):a&&Bq(this.uL,
this.zda,this.kl)&&kl(this.Cv)}}Drh(){const a=()=>{Zs(this.wQ,this.NSa,$s(this.bEa,this.zda,this.kl))};fu([a,()=>{kl(this.MSa);$r(this.wQ)},a,()=>{kl(this.YQc);$r(this.wQ)},a,()=>{kl(this.wQ)}],()=>Bq(this.bEa,this.zda,this.kl))}N_d(){if(!this.eH)return!1;for(let a=0;a<this.eH.childNodes.length;a++)if(-1!==Ea.a.Hka(this.eH.childNodes[a]).indexOf("cui-cg"))return!0;return!1}V$d(){if(!this.eH)return null;let a=null;for(let b=this.eH.childNodes.length-1;0<=b;b--){const c=this.eH.childNodes[b];if(-1===
Ea.a.Hka(c).indexOf("cui-cg"))break;a=c}return a}x0f(a){if(a)for(let b=0;b<a.childNodes.length;b++){const c=a.childNodes[b],f=Ea.a.Hka(c),l=!!c.id;-1!==f.indexOf("cui-jewel-container")?this.g5b=c:-1!==f.indexOf("cui-tts")?this.eH=c:-1!==f.indexOf("cui-TabRowInline")?this.h5b=c:-1!==f.indexOf("cui-separator")?this.XQc=c:l&&c.id.startsWith(Em.CuiHelper.Jch)?this.K9a=c:l&&c.id.startsWith(Em.CuiHelper.r_f)?this.wwb=c:-1!==f.indexOf("cui-TabRowRight")?this.i5b=c:l&&c.id.startsWith(Em.CuiHelper.EOe)&&(this.xwb=
c);this.x0f(c)}}GLl(){var a=[this.eH,this.h5b,this.XQc,this.K9a,this.wwb,this.i5b,this.xwb];for(const b of a)Oy(b);this.bOb(0)}rfl(){let a;a=[()=>{kl(this.XQc);kl(this.K9a)},()=>{this.bOb(1)},()=>{this.bOb(2)},()=>{kl(this.h5b);this.bOb(0)}];fu(a,()=>Bq(this.eH,this.h5b,this.kl));a=[()=>{kl(this.XQc);kl(this.K9a)},()=>{kl(this.wwb)},()=>{kl(this.xwb)},()=>{kl(this.i5b)}];fu(a,()=>Bq(this.h5b,this.i5b,this.kl)||Bq(this.eH,this.i5b,this.kl));a=[()=>{this.bOb(1)},()=>{this.bOb(2)},()=>{kl(this.eH)}];
fu(a,()=>Bq(this.g5b,this.eH,this.kl))}bOb(a){this.eH&&(this.eH.className=Py.kDl[a],this.eH._scaleStep=a)}}Py.kDl=["cui-tts","cui-tts-scale-1","cui-tts-scale-2"];Object(m.a)(Py,"TopBarScalingManager",null,[]);class CG{constructor(a,b){this.zS=this.dBa=null;this._clientId=a;this.nrf=b}E_i(){if(!uk.b(this.zS))return this.zS;this.JZi();this.zS.style.display="block";this.nrf&&this.nrf.Nca(Object(I.a)(this,this.onResize,"onResize"));return this.zS}onResize(){this.X0a()}X0a(){this.dZi()?(document.getElementById("application").style.minWidth=
"0px",(new Py(this.zS,null,w.AFrameworkApplication.isRtl)).nfl(this.zS)):w.AFrameworkApplication.Aa.ob.mO||AG.a.ofl(this.zS,w.AFrameworkApplication.isRtl)}dZi(){return w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("EnhancedMobileViewIsEnabled"):!1}JZi(){if(uk.b(this.dBa)){var a;({V9b:a}=at.a.DQb(!w.AFrameworkApplication.NT)).returnValue?(this.dBa=IA("div"),this.dBa.className=at.a.o1i,this.dBa.id=Em.CuiHelper.p6d,a.appendChild(this.dBa),this.AZi(),w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.ob.dWa&&
!w.AFrameworkApplication.NT&&this.DZi(),this.D_i()):w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("ReactHeaderCrashLogs")&&ka.ULS.sendTraceTag(509116637,340,50,"HeaderSkeleton.EnsureHeaderDom: Couldn't ensure header dom since HeaderPanel doesn't exist")}}D_i(){uk.b(this.zS)&&(this.zS=IA("div"),this.zS.className=at.a.fHl,this.zS.style.display="none",this.dBa.appendChild(this.zS))}AZi(){Sys.UI.DomElement.addCssClass(this.dBa,at.a.p1i);if(w.AFrameworkApplication.isRtl){var a=this.dBa;if(!uk.b(a)){var b=
a.className;if(uk.b(b)||-1===b.indexOf("cui-rtl"))b=b.trim()+" cui-rtl",b=b.trim(),a.className=b}}}DZi(){Sys.UI.DomElement.addCssClass(this.dBa,"FlexBoxLayout")}}Object(m.a)(CG,"HeaderSkeleton",null,[]);var vQ=d(1302),oB=d(1246);class pB{constructor(){this.commandId=0;this.externalUxCommand=null}}Object(m.a)(pB,"CommandDefinition",null,[]);class DG{constructor(){this.addTabToMap=this.addIconToMap=this.addCommandToMaps=this.getDoNothingCommand=this.getCommandByExternalUxId=null}}Object(m.a)(DG,"CommandDefinitionMapping",
null,[]);const wQ=a=>Object.assign(new DG,{getCommandByExternalUxId:b=>{const c=a.getCommandByExternalUxId(b);return c?Object.assign(new pB,{commandId:parseInt(c.commandId),externalUxCommand:c.externalUxCommand}):Object.assign(new pB,{externalUxCommand:b})},getDoNothingCommand:()=>parseInt(G.a.ve),addCommandToMaps:Object(I.a)(a,a.addCommandToMaps,"addCommandToMaps"),addIconToMap:Object(I.a)(a,a.addIconToMap,"addIconToMap"),addTabToMap:Object(I.a)(a,a.addTabToMap,"addTabToMap")});var EG=d(952);class FG{}
Object(m.a)(FG,"RibbonInitState",null,[]);var xQ=d(469),GG=d(521);let bt;class Gp{static YIl(a){w.AFrameworkApplication.Aa.ob.Nmg||(a.ShowCommentsTopBar=!0);w.AFrameworkApplication.Aa.ob.Amg||(a.CatchUpWithChanges=!0)}static aKh(a){for(let b of Gp.GZh)a[b]=!0}static dRl(a,b){var c=w.AFrameworkApplication.h$b;if(w.AFrameworkApplication.fa.Lu(c)&&w.AFrameworkApplication.fa.Ha(c)){Gp.aKh(b);c=w.AFrameworkApplication.fa.eA("HostDefinedUIControls");for(let f=0;f<c.length;f++)Gp.eRl(a,b,c[f]);Gp.TIl(b);
Gp.SIl(b)}}static eRl(a,b,c){if(c.id in a){a=a[c.id];for(let f of a)1===c.visibility?b[f]=!1:c.visibility||(b[f]=!0)}}static TIl(a){a.HostMoreOptions=a.HostOpenInBrowser&&a.HostOpenInClient&&a.HostDownload?!0:!1}static kva(){const a=w.AFrameworkApplication.fa.Ha(w.AFrameworkApplication.wK);return!!a&&"teams"===a.toLowerCase()}static Ltl(){return w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeamsCollabDeclutterIsEnabled",!1)}static rul(){return w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeamsCollabDeclutterIsEnabled",
!1)||w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsPeripheralOverflowScalingEnabled",!1)}static SIl(a){Gp.kva()&&(Gp.Ltl()&&(a.HostOpenInClient=!1),Gp.rul()&&(a.HostMoreOptions=!0))}}Gp.GZh=(bt=new Na.a,bt.add("HostOpenInClient"),bt.add("HostConversation"),bt.add("HostClose"),bt.add("HostDownload"),bt.add("HostOpenInBrowser"),bt.add("HostMoreOptions"),bt);Object(m.a)(Gp,"CommandTrimmer",null,[]);class HG{constructor(){}flatten(a){const b=[];for(const c of a)b.push.apply(b,
c);return b}}Object(m.a)(HG,"ReactAsyncDispatcher",null,[]);class qB{}qB.Enc="PageId";Object(m.a)(qB,"FileMenuSQMProperties",null,[]);var rB=d(170);class IG{constructor(a,b){this.zq=null;this.xFc=!1;this.lPa=0;this.tlf="";this.XBd={};this.$Jd=a;this.Pd=b;this.Nof=Object(I.a)(this,this.xMe,"onModalMouseWheel");this.Fkf=!!w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.ob.zea;this.Q2=!!w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.ob.bva}XIb(){0<this.lPa?this.lPa++:(this.lPa++,w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayMenuFocusActionsUntilNextFrame",
!1)?window.requestAnimationFrame(()=>{window.setTimeout(Object(I.a)(this,this.$ih,"pushTransientFocusScope"),0)}):this.$ih(),this.showModal())}$ih(){this.Pd&&this.Pd.XU(D.AFrame.jP,!0)}Hbj(){const a=tg.f(),b=appChrome.selectors.getShyState();return String.format("{0}{1}",a,this.Fkf&&b.isActive&&1===b.state?"_ShyRibbon":"")}zvj(a){var b=0;if(this.Q2){if(this.XBd[a])return this.XBd[a];(b=document.getElementById("BusinessBar"))||ka.ULS.sendTraceTag(524142489,340,10,"Failed to propertly get region composer Business Bar Region for setting up Modal Div");
b=b?b.offsetTop:0;this.XBd[a]=b}return b}showModal(){if(!this.zq)if(this.zq=this.createElement("div"),this.zq.setAttribute("id","ReactModalDiv"),this.zq.style.position="absolute",this.zq.style.bottom="0px",this.zq.style.left="0px",this.zq.style.right="0px",this.zq.style.backgroundColor="white",this.zq.style.opacity="0.0",this.Q2){var a=document.getElementById("regionComposerRoot");a&&a.appendChild(this.zq)}else this.$Jd.appendChild(this.zq);a=this.Hbj();if(a!==this.tlf){const b=this.zvj(a),c=appChrome.selectors.getShyState();
this.Fkf&&c.isActive&&1===c.state&&tg.a("getRibbonHeight")?this.zq.style.top=String.format("{0}px",b+appChrome.api.getRibbonHeight(tg.f())):this.zq.style.top=String.format("{0}px",b);this.tlf=a}this.zq.style.display="block";this.zq.style.visibility="visible";this.zq.style.zIndex="1000";this.xFc||(window.addEventListener("wheel",this.Nof,!0),this.O1c()?xf.a.instance.rb(oa.a.WR,this.zq,Object(I.a)(this,this.gjd,"onModalPointerUp")):xf.a.instance.rb(oa.a.pointerDown,this.zq,Object(I.a)(this,this.fjd,
"onModalPointerDown")),this.xFc=!0)}SEk(){this.lPa--;0<this.lPa||(0>this.lPa?this.lPa=0:this.Chg())}pLe(){this.lPa=0;this.I3d();this.Chg()}createElement(a){a=document.createElement(a);a.setAttribute("unselectable","on");return a}Bhg(){this.Pd&&this.Pd.Ee&&this.Pd.Ee.name===D.AFrame.jP&&!w.AFrameworkApplication.Ae.Dw&&this.Pd.q1(D.AFrame.jP,!1);this.zq&&(this.zq.style.zIndex="-1",this.zq.style.visibility="hidden",this.zq.style.display="none");this.xFc&&(window.removeEventListener("wheel",this.Nof,
!0),this.O1c()?xf.a.instance.Bb(oa.a.WR,this.zq,Object(I.a)(this,this.gjd,"onModalPointerUp")):xf.a.instance.Bb(oa.a.pointerDown,this.zq,Object(I.a)(this,this.fjd,"onModalPointerDown")),this.xFc=!1)}Chg(){this.O1c()?window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.Bhg()},0)}):this.Bhg()}fjd(){this.v4b();this.iUf();this.pLe();this.HLa();return!0}gjd(){this.v4b();this.iUf();this.pLe();window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.HLa()},0)});return!0}HLa(){4===w.AFrameworkApplication.Aa.ob.zk&&
w.AFrameworkApplication.fa.ka("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")?w.AFrameworkApplication.Aa.HLa():this.Pd.vf(D.AFrame.JW)}xMe(a){a.stopPropagation()}v4b(){const a=Ib.a.instance.qb("Common.IReactContextualUILauncher");a&&a.v4b()}I3d(){const a=Ib.a.instance.qb("Common.IReactContextualUILauncher");a&&a.I3d()}iUf(){w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.ob.oGa&&(this.O1c()?appChrome.selectors.getFileMenuExpanded():1)&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))}O1c(){return w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactModalDivPerfImprovements",
!1)}}Object(m.a)(IG,"ReactModalDiv",null,[]);var bn=d(543);class JG{constructor(a,b){this.M7h=a;this.RVh=b}}Object(m.a)(JG,"ReactExecuteCommandContext",null,[]);class Bv{}Bv.Color="Color";Bv.IndexColorSelected="ColorSelected";Object(m.a)(Bv,"ColorPickerCommandProperties",null,[]);var no=d(946);class Pn{}Pn.SelectedFont="SelectedFont";Pn.Formatting="Format";Pn.RequestUpdateMru="RequestUpdateMru";Pn.FontPickerId="fontPickerId";Pn.IsPinned="IsPinned";Pn.Trigger="Trigger";Object(m.a)(Pn,"FontPickerCommandProperties",
null,[]);class cp{}cp.Trigger="FontTrigger";cp.Name="FontName";cp.Action="FontAction";cp.Level="FontLevel";cp.IsPinned="FontIsPinned";Object(m.a)(cp,"FontPickerLogProperties",null,[]);class hx{}hx.Rows="Rows";hx.Columns="Columns";Object(m.a)(hx,"InsertTableCommandProperties",null,[]);class cn{}cn.Alt="Alt";cn.Number="Number";cn.UnitType="UnitType";cn.Text="Text";cn.MaxValue="MaxValue";Object(m.a)(cn,"SpinnerCommandProperties",null,[]);class KG{constructor(a,b,c,f,l,y,H,Q,ia,wa=null,Ua=null){this.w5a=
null;this.$sf=!1;this.kEd=[];this.Mzc=-1;this.dHc=!1;this.w8h=0;this.SSb=null;this.lqf=!1;this.yzc=null;this.Mmf=!1;this.XP=a;this.OPa=b;this.uNd=Object(qa.a)(1539,a);this.Tm=c;this.Pd=f;l&&(this.w5a=new IG(l,f));this.h6h=y;this.rYh=H;this.QS=wa;this.Ca=Q;this.j5a={};this.Oa=ia;this.Kaf=Ua;ia&&(ia.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnqueueTasksWhenTaskMgrIsYielding",!1)||ia.ka("EnqueueTasksWhenTaskMgrIsYielding"))&&Ji.a.instance.fBf.CWR(()=>this.$sf=!0);ia&&(a=this.Oa.Ha("CommandControlIdPairsForLoggingOverride")||
"")&&0<=a.trim().length&&({Nu:this.SSb}=De.d(a));this.SSb||(this.SSb={})}get wrd(){return!!window.appChrome&&!!appChrome.selectors}puh(){-1!==this.Mzc&&window.clearTimeout(this.Mzc);this.Mzc=window.setTimeout(()=>{for(this.Mzc=-1;0<this.kEd.length;){if(il.a.instance.Dw){this.puh();break}const a=this.kEd.shift();a&&this.executeCommand(a.M7h,a.RVh)}},0)}executeCommand(a,b){if(il.a.instance.Dw){if(this.$sf){this.kEd.push(new JG(a,b));this.puh();return}ka.ULS.sendTraceTag(561394496,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",
a,b.modelType,ta.a.toJSON(b.payload));if(this.Oa.ka("WordEditorReactExecuteYieldReturnIsEnabled"))return}if(b){const c=this.Tm.getCommandByExternalUxId(a),f=b.modelType;this.Kaf&&this.Kaf.yak(a,b);c?this.t0i(a,c,f,b):this.u0i(a,f,b);this.Tyi(b);this.HIl(b);this.Itk(a,b)}}u0i(a,b,c){switch(b){case "GalleryModel":case "PreviewGalleryModel":this.EYf(c,a);break;case "ButtonModel":this.q0i(c,a)}}vPl(a,b,c,f,l){if(c.payload)switch(c.payload.type){case "CoauthorMenuPayload":a.MenuItemId=c.payload.coauthorId;
break;case "ButtonPayload":a.MenuItemId=b.menuItemId;a.CommandValueId=c.payload.commandValueId;a.TerminalParentControlId=c.payload.terminalParentControlId;this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)?(b=!0,uk.b(c.payload.dismissHostingSurfaceOnExecute)||(b=c.payload.dismissHostingSurfaceOnExecute),b&&this.dDa()):this.dDa();break;case "ButtonPreviewPayload":a.MenuItemId=b.menuItemId;a.CommandValueId=c.payload.commandValueId;l=b.commandPreviewId;break;
case "ButtonRevertPreviewPayload":a.MenuItemId=b.menuItemId;a.CommandValueId=c.payload.commandValueId;l=b.commandRevertId;break;default:a.MenuItemId=b.menuItemId}else a.MenuItemId=b.menuItemId;a.SourceControlId=f;return l}wPl(a,b,c){if(b.payload)switch(b.payload.type){case "MenuOpenPayload":a=this.Tm.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;break;case "MenuClosePayload":a=this.Tm.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case "TellMeMenuItemExecuted":c.CommandId=
b.payload.executedControl;c.ControlId=b.payload.executedControl;c.ParentControlId=b.payload.parentControl;c.CloseAllMenus=!0;this.dDa();break;case "TellMeSearchResultChangePayload":c.Value=b.payload.searchText;break;case "SmartLookupPayload":c.CommandValueId=b.payload.selectionContextJson}return a}t0i(a,b,c,f){var l=this.wPk(f,c),y=b.commandId;const H={},Q={};switch(c){case "SplitButtonModel":if(this.s9b(f.payload,Object(I.a)(this,this.BQl,"updateSplitButtonMenuState"),l))return;H.MenuItemId=b.menuItemId;
this.V_e(f,H);break;case "StatefulSplitButtonModel":if(this.s9b(f.payload,Object(I.a)(this,this.FQl,"updateStatefulSplitButtonMenuState"),l))return;c=f.payload.statefulData;l=f.payload.statefulMode;"color"===l?H.Color=c:"icon"===l&&(c=this.Tm.getCommandByExternalUxId(c))&&(H.MenuItemId=c.menuItemId);break;case "FileMenu":H.MenuItemId=b.menuItemId;H.SourceControlId=a;f.payload&&"FileMenuPageSwitchPayload"===f.payload.type&&this.iBj(y,f.payload,a);break;case "TellMe":y=this.wPl(y,f,H);H.SourceControlId=
a;H.Location=f.payload.location;break;case "ButtonModel":f.payload&&"TabSwitchPayload"===f.payload.type?this.VFj(H,f):y=this.vPl(H,b,f,a,y);break;case "CompoundButtonModel":H.MenuItemId=b.menuItemId;H.CommandValueId=f.payload.commandValueId;H.SourceControlId=a;this.V_e(f,H);this.dDa();break;case "ToggleButtonModel":case "InkButtonModel":H.MenuItemId=b.menuItemId;H.SourceControlId=a;this.V_e(f,H);this.dDa();break;case "FontPickerModel":switch(f.payload.type){case "MenuOpenPayload":y=this.Tm.getCommandByExternalUxId("FontPickerMenuOpen").commandId;
H[Pn.FontPickerId]=f.payload.launcherId;break;case "MenuClosePayload":y=this.Tm.getCommandByExternalUxId("FontPickerMenuClose").commandId;H[Pn.FontPickerId]=f.payload.launcherId;break;case "FontPickerFontSelectedPayload":c=f.payload.font;l=null;"string"===typeof c?(l=aa.FontUtils.pG(c),H.CommandValueId=l,l=aa.FontUtils.DOc(l)):(c.data?(H.CommandValueId=c.data.fontToApply,H.MenuItemId=c.data.themeIndex,H[Pn.Formatting]=c.data):H.CommandValueId=c.name,l=c);H.SourceControlId=a;H[Pn.RequestUpdateMru]=
l;Q[cp.Name]=f.payload.nameToLog?f.payload.nameToLog:"string"===typeof c?aa.FontUtils.z0c(c)?"*"+c:aa.FontUtils.nne(c)?"[EF]":"[MF]":"";Q[cp.IsPinned]=f.payload.isPinned;Q[cp.Level]=f.payload.level;this.pse();break;case "FontPickerFontInfoRequestedPayload":H.CommandValueId=f.payload.font.name;H[Pn.Trigger]=f.payload.trigger;Q[cp.Trigger]=f.payload.trigger;Q[cp.Name]=f.payload.nameToLog;this.pse();break;case "FontPickerFontPinningPayload":c=f.payload.isPinned;H.CommandValueId=f.payload.fontKey;H[Pn.IsPinned]=
c;Q[cp.Name]=f.payload.nameToLog;Q[cp.Action]=c?"pin":"unpin";Q[cp.Level]=f.payload.level;this.pse();break;default:return}break;case "ComboBoxModel":var ia=f.payload.type;switch(ia){case "MenuOpenPayload":case "MenuPopulatePayload":this.BOb(f.payload.launcherId,l)&&(y={},y[f.payload.launcherId]=c,this.OPa.roc(y,tg.g(f.payload)),this.j5a[a]=new Date);return;case "MenuClosePayload":return;case "ComboBoxPayload":case "ComboBoxPreviewPayload":c=f.payload.newValue;if(!c)return;c.value?(H[no.a.Value]=c.value,
H[no.a.IsFreeForm]=!0):(H[no.a.Value]=c.text,H.MenuItemId=c.key,H.CommandValueId=c.commandValueId);"ComboBoxPreviewPayload"===ia&&(y=b.commandPreviewId);break;case "ComboBoxRevertPreviewPayload":y=b.commandRevertId;break;default:return}break;case "FlyoutAnchorModel":switch(f.payload.type){case "ZeroTermContextMenuClosePayload":c=ta.a.EL(f.payload);for(ia of c)H[ia]=f.payload[ia];break;default:this.s9b(f.payload,Object(I.a)(this,this.oOl,"updateFlyoutAnchorMenuState"),l),H.launcherId=f.payload.launcherId}break;
case "InkFlyoutAnchorModel":this.s9b(f.payload,Object(I.a)(this,this.HOl,"updateInkFlyoutAnchorMenuState"),l);H.launcherId=f.payload.launcherId;break;case "ColorPickerModel":switch(f.payload.type){case "ColorPickerPayload":H[Bv.Color]=f.payload.selectedColorId;H.colorRGB=f.payload.color;break;case "ColorPickerPreviewPayload":y=b.commandPreviewId;H[Bv.Color]=f.payload.selectedColorId;break;case "ColorPickerRevertPreviewPayload":y=b.commandRevertId;break;default:return}break;case "SpinButtonModel":H[cn.Number]=
f.payload.value;H[cn.UnitType]=xe.a.R2b(f.payload.unitType.toLowerCase());H[cn.Text]=f.payload.reservedValue;break;case "SliderModel":H[$o.Value]=f.payload.value;break;case "InsertTableModel":H[hx.Rows]=f.payload.rows;H[hx.Columns]=f.payload.columns;break;case "CheckboxModel":H[wh.a.On]=f.payload.checked;H.MenuItemId=b.menuItemId;H.TerminalParentControlId=f.payload.terminalParentControlId;break;case "PreviewGalleryModel":if(this.s9b(f.payload,Object(I.a)(this,this.GPl,"updatePreviewGalleryMenuState"),
l)){H.launcherId=f.payload.launcherId;break}this.EYf(f,a);return;case "DocumentTitleModel":switch(f.payload.type){case "DocumentTitleRenamePayload":H.getNewDocumentTitle=f.payload.getNewDocumentTitle;break;case "MenuOpenPayload":y={};y[f.payload.launcherId]=c;this.OPa.roc(y,tg.g(f.payload));this.j5a[a]=new Date;return;case "MenuClosePayload":return;default:return}break;case "MRUCompoundButtonModel":H.MenuItemId=f.payload.url;this.gbk(f.payload.pageId);break;case "NewBlankDocumentModel":case "CustomTemplateModel":H.MenuItemId=
f.payload.assetId;H.SourceControlId=a;w.AFrameworkApplication.fa.ka("BackstagePremiumTemplateExperienceEnabled")&&(H.IsPremium=f.payload.isPremium||!1);this.hbk(f.payload.pageId);break;case "CoauthorGallery":H.RenderTime=f.triggerTime;break;case "PeopleWell":H.RenderTime=f.triggerTime;break;case "SyncStatus":H.SourceControlId=a;break;case "InputBoxModel":H.Text=f.payload.newValue;break;case "PersonaButtonModel":H.CommandValueId=f.payload.commandValueId;this.tDj(f.payload);break;case "MultiActionButtonModel":H.CommandValueId=
f.payload.commandValueId;H.Href=f.payload.href;H.Type=f.payload.type;H.TerminalParentControlId=f.payload.terminalParentControlId;this.dDa();break;default:return}y&&!this.isShadowMenuOpen(f.payload)&&(H.CommandValueId||(H.CommandValueId=H.MenuItemId),b.legacyControlId&&(H.LegacyId=b.legacyControlId),H.SourceControlId||(H.SqmControlId=a),this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&H.launcherId&&(b=this.Tm.getCommandByExternalUxId(H.launcherId))&&
(H.launcherCommandId=parseInt(b.commandId)),f.payload&&!uk.b(f.payload.PRIReadinessCheck)&&(H.PRIReadinessCheck=f.payload.PRIReadinessCheck,this.lqf=!0),f.payload&&!uk.b(f.payload.shouldTakeFocus)&&(H[bn.a.dba]=f.payload.shouldTakeFocus),b=this.qSd(f,H),uk.b(f.triggerTime)||(Q.TriggerTime=f.triggerTime),f.payload&&!uk.b(f.payload.userActionKey)&&(Q.userActionKey=f.payload.userActionKey),this.EZe(Q,f,a,y),this.uNd.executeCommand(y,H,this.getSelectedTabId(),b,!0,()=>{this.eJe(H,a)},Q,tg.g(f.payload)))}EZe(a,
b,c,f){if(this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableControlIdLoggingInUserActions",!1)&&c&&f&&b.payload){const l=!uk.b(b.payload.launcherId);c=this.Ith(this.umj(l?b.payload.launcherId:c,f),f,!1);a.ControlId=c;const y=b.payload.inputMethod,H=b.payload.location;uk.b(y)||uk.b(H)||this.Eak(1===y,2===y||3===y||4===y,l||"TabSwitchPayload"===b.payload.type,c,H)}this.Oa&&this.Oa.ka("TerminalParentControlIdLoggingInUserActionsIsEnabled")&&b.payload&&"terminalParentControlId"in
b.payload&&(a.TerminalParentControlId=this.Ith(b.payload.terminalParentControlId,f,!0))}Eak(a,b,c,f,l){this.yzc||(this.yzc={});const y=[];l=rB.a.E_("UILocation",l,2);Array.add(y,l);if(l=this.getSelectedTabId())l=rB.a.E_("Tab",l,2),Array.add(y,l);this.yzc[f]||(this.yzc[f]=1,b?c?this.DCb("DistinctUserInitiatedNavigationalCommand",y):this.DCb("DistinctUserInitiatedTerminalCommand",y):a&&this.DCb("DistinctUserInitiatedKeyboardCommand",y));b?c?this.DCb("UserInitiatedNavigationalCommand",y):this.DCb("UserInitiatedTerminalCommand",
y):a&&this.DCb("UserInitiatedKeyboardCommand",y)}DCb(a,b){wn.b(a,null,0,!0,0,b)}Ith(a,b,c){if(RegExp("^[a-zA-Z0-9_]*$").test(a))return a;ka.ULS.sendTraceTag(510247689,207,15,c?"CommandId: "+b+" has a parentControlId that is non-alphanumeric and may need to be changed":"CommandId: "+b+" has a controlId that is non-alphanumeric and may need to be changed");return"MalformedId"}umj(a,b){b=parseInt(b);b=vf.ActionManager.IZd(b)||vf.ActionManager.i7a(b)||"";return!uk.b(b)&&b in this.SSb?this.SSb[b]:100<
a.length?"":a}pse(){this.QS&&this.QS.execute(a=>{a.gse("ModernFontPickerExperience")})}qSd(a,b){let c=2;a.payload&&"inputMethod"in a.payload&&a.payload.inputMethod&&(c=a.payload.inputMethod,b[bn.a.Pu]=c);return c}eJe(a,b){const c=Object(qa.a)(D.AFrame,w.AFrameworkApplication.Aa);if(this.Pd&&this.JAh(a)){if(!this.Pd.Ee&&c){let f="null";if(a){const l=a.Value;delete a.Value;f=ta.a.toJSON(a);uk.b(l)||(a.Value=l)}ka.ULS.sendTraceTag(561394506,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",
b,f,c.uLa)}this.Pd.F1f()}(this.Pd&&this.Pd.Ee&&this.Pd.Ee.name!==D.AFrame.jP&&c&&this.Pd.Ee.name!==c.uLa||this.JAh(a))&&this.RCi(a)}JAh(a){return!!a&&!uk.b(a[bn.a.dba])&&a[bn.a.dba]}RCi(a){bn.a.Pu in a&&1===a[bn.a.Pu]&&gx.ShyRibbon.ARa(1,0)}VFj(a,b){tg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.CloseMenuOnUnmount")&&this.dDa();this.XP.qoc();if(this.h6h&&this.Ca){const c={};c[Ly.IGh]=b.payload.tabId;this.Ca.Ka(G.a.Cpd,2,c,this.L8b(b));uk.b(b.payload.inputMethod)||
(this.Ca.processAction(G.a.Bqh,2),this.dHc||this.xxl(b.payload.tabId))}b=b.payload.tabId;a.NewContextId=b;a.NewContextCommand=this.Tm.vde(b);ka.ULS.sendTraceTag(561394507,340,50,"HandleTabSwitch tabId: "+b);if(this.QS&&b){const c=b+"TabSwitchActivity";this.QS.execute(f=>{f.gse(c)})}}s9b(a,b,c){const f=a.type;return"MenuClosePayload"===f?!0:"MenuOpenPayload"===f?(b(a,c),!0):!1}tDj(a){a=a.type;"MenuOpenPayload"===a?w.AFrameworkApplication.jGh=!0:"MenuClosePayload"===a&&(w.AFrameworkApplication.jGh=
!1)}wPk(a,b){if(!a.payload||!a.payload.launcherId||"MenuOpenPayload"!==a.payload.type&&"MenuPopulatePayload"!==a.payload.type)return!1;const c=a.payload.launcherId,f=this.Tm.getCommandByExternalUxId(c);return f&&f.populationProps?((a=this.OPa.pPe(f,b,a.payload))&&c in this.j5a&&delete this.j5a[c],a):!1}oOl(a,b){const c=a.launcherId;this.BOb(c,b)&&(b=appChrome.selectors.getFlyoutAnchorMenuItems(c),this.$Qb(b,c,tg.g(a)))}HOl(a,b){const c=a.launcherId;this.BOb(c,b)&&(b=tg.j("getInkFlyoutAnchorMenuItems")?
appChrome.selectors.getInkFlyoutAnchorMenuItems(c):appChrome.selectors.getFlyoutAnchorMenuItems(c),this.$Qb(b,c,tg.g(a)))}GPl(a,b){const c=a.launcherId;this.BOb(c,b)&&(b=appChrome.selectors.getPreviewGalleryMenuItems(c),this.$Qb(b,c,tg.g(a)))}BQl(a,b){const c=a.launcherId;this.BOb(c,b)&&(b=appChrome.selectors.getSplitButtonMenuItems(c),this.$Qb(b,c,tg.g(a)))}FQl(a,b){const c=a.launcherId;this.BOb(c,b)&&(b=appChrome.selectors.getStatefulSplitButtonMenuItems(c),this.$Qb(b,c,tg.g(a)))}getSelectedTabId(){return this.wrd?
appChrome.selectors.getSelectedTabId():null}$Qb(a,b,c){this.OPa.roc(a,c);this.j5a[b]=new Date}BOb(a,b){let c=!0;a in this.j5a&&(c=this.j5a[a].getTime()<this.XP.l4c.getTime());return c&&!b&&this.wrd}EYf(a,b){const c={};var f=a.payload.selectedGalleryId;const l=this.Tm.getCommandByExternalUxId(f);if(l){c.SourceControlId=f;c.MenuItemId=l.menuItemId;c.SqmControlId=b;l.legacyControlId&&(c.LegacyId=l.legacyControlId);a.payload&&!uk.b(a.payload.shouldTakeFocus)&&(c[bn.a.dba]=a.payload.shouldTakeFocus);this.unj(a.payload,
c);(f=this.L8b(a))||(f={});this.EZe(f,a,b,l.commandId);const y=this.qSd(a,c);this.uNd.executeCommand(l.commandId,c,this.getSelectedTabId(),y,!0,()=>{this.eJe(c,b)},f,tg.g(a.payload))}}q0i(a,b){const c=this.Tm.getCommandByExternalUxId(b);if(c){const f={};f.SourceControlId=b;f.MenuItemId=b;f.SqmControlId=b;a.payload&&!uk.b(a.payload.shouldTakeFocus)&&(f[bn.a.dba]=a.payload.shouldTakeFocus);let l=this.L8b(a);l||(l={});this.EZe(l,a,b,c.commandId);const y=this.qSd(a,f);this.uNd.executeCommand(c.commandId,
f,this.getSelectedTabId(),y,!1,()=>{this.eJe(f,b)},l,tg.g(a.payload))}}unj(a,b){"CharacterGalleryPayload"===a.type&&(b.MenuItemId=a.character)}V_e(a,b){a.payload&&"toggled"in a.payload&&(b[wh.a.On]=a.payload.toggled)}Itk(a,b){"MenuOpen"===a?!this.w5a||"isShadowRendering"in b.payload&&b.payload.isShadowRendering||this.w5a.XIb():"MenuClose"===a&&this.w5a&&this.w5a.SEk()}dDa(){this.w5a&&this.w5a.pLe()}L8b(a){let b=null;uk.b(a.triggerTime)||(b={},b.TriggerTime=a.triggerTime);return b}iBj(a,b,c){if(this.rYh&&
this.Ca){const f={};f[qB.Enc]=c;this.Ca.Ka(G.a.P$k,2,f)}this.$Qb(b.pageControlIdMap,a,tg.g(b))}hbk(a){if(this.Ca)switch(a){case "FileHomePage":this.Ca.processAction(G.a.dal,2);break;case "FileNewPage":this.Ca.processAction(G.a.eal,2)}}gbk(a){if(this.Ca)switch(a){case "FileHomePage":this.Ca.processAction(G.a.X$k,2);break;case "FileOpenPage":this.Ca.processAction(G.a.Y$k,2)}}isShadowMenuOpen(a){return!!a&&"MenuOpenPayload"===a.type&&a.isShadowRendering}xxl(a){if(w.AFrameworkApplication.fa.ka("TellMeHelpCoachMarkActivityEnabled")&&
"Help"===a)this.QS.execute(b=>{b.logActivity("TellMeHelpCoachMarkActivity",null)}),this.dHc=!0;else{if(w.AFrameworkApplication.fa.ka("TellMe3TabSwitchCoachMarkActivityEnabled")&&(this.QS.execute(b=>{b.logActivity("TellMe3TabSwitchCoachMarkActivity",null)}),3===++this.w8h)){this.dHc=!0;return}w.AFrameworkApplication.fa.ka("TellMe1TabSwitchCoachMarkActivityEnabled")&&32===this.Ca.processAction(G.a.Tlb,2)&&(this.dHc=!0)}}Tyi(a){a&&a.payload&&a.payload.PRIReadinessCheck&&!this.lqf&&appChrome.PRIToastManager.dismissToast()}HIl(a){!this.Mmf&&
this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ToolBarFloodGate1",!1)&&(a=tg.g(a.payload),31===a||14===a||15===a||2===a)&&(window.requestAnimationFrame(()=>{window.setTimeout(()=>{const b=Ib.a.instance.Ia("Common.ISystemInitiatedFeedback");b&&b.execute(c=>{c.logActivity("SingleLineToolBarFPS","SingleLineToolBarFloodgateSurveyIsEnabled")})},0)}),this.Mmf=!0)}}Object(m.a)(KG,"ReactExecuteCommandHandler",null,[]);class LG{constructor(){this.fileMenu=null}get R9e(){return 0}X0a(){}bta(){return!1}j2(){return!1}get Wuh(){return null}dS(){}Sme(){return!1}iRa(){}TSa(){}refresh(){}get controls(){return null}mNc(){}qoc(){}get Saa(){return null}set Saa(a){}get inKeytipMode(){return!1}enterKeytipMode(){}exitKeytipMode(){}}
Object(m.a)(LG,"ReactRibbonExternal",null,[1191,1524,1525]);var yQ=d(270);class MG{constructor(a,b,c,f){this.Pd=a;this.Ca=b;this.Lvf=c;this.nrb=f}initialize(){this.Ca.ya(G.a.Mrc,ie.a.frame,Object(I.a)(this,this.ish,"ribbonMoveForwardAction"));this.Ca.ya(G.a.Lrc,ie.a.frame,Object(I.a)(this,this.hsh,"ribbonMoveBackwardAction"));this.Ca.ya(G.a.gqd,ie.a.frame,Object(I.a)(this,this.gsh,"ribbonEscAction"));var a=at.a.bie(this.nrb,null,this.Lvf,!1);a.uJ=!0;this.ELb(a,G.a.Mrc,G.a.Lrc);a.bindAction(x.KeyInputManager.Qa(B.a.mZ,
0),G.a.gqd);a=this.Pd.Fc(D.AFrame.jP);a.uJ=!0;this.ELb(a,G.a.eta,G.a.eta);ja.a.instance.rb(oa.a.mouseDown,this.Lvf,Object(I.a)(this,this.QGk,"onRibbonMouseDown"));a=yQ.a.instance;tg.a("enterKeytipMode")&&a.MNb(this.nrb,()=>{appChrome.api.enterKeytipMode(!1)});tg.a("exitKeytipMode")&&a.Qsc(this.nrb,()=>{appChrome.api.exitKeytipMode();gx.ShyRibbon.ARa(1,0)});w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.ob.zea&&(a=Object(qa.a)(v.FocusManager,this.Pd))&&a.Cgi(Object(I.a)(this,this.jDk,"onFocusScopeChanged"))}jDk(a,
b){if((a=Object(qa.a)(D.AFrame,w.AFrameworkApplication.Aa))&&b.I5g&&w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.ob.zea){const c=appChrome.selectors.getShyState();c.isActive&&b.I5g.name===a.uLa&&gx.ShyRibbon.ARa(c.state,1)}}ish(){return 4}hsh(){return 4}gsh(){tg.a("inKeytipMode")&&!appChrome.api.inKeytipMode()&&(w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.ob.zea&&appChrome.selectors.getShyState().isActive&&gx.ShyRibbon.ARa(1,0),this.Pd.vf(D.AFrame.JW));return 4}ELb(a,b,c){const f=
x.KeyInputManager.Qa(B.a.$q,0),l=x.KeyInputManager.Qa(B.a.$q,4);a.Bp(f);a.Bp(l);a.bindAction(f,b);a.bindAction(l,c)}QGk(a){a.mc&&a.mc.target&&"input"!==a.mc.target.tagName.toLowerCase()&&a.mc.preventDefault();return!1}dispose(){this.Ca.iK(G.a.Mrc,ie.a.frame,Object(I.a)(this,this.ish,"ribbonMoveForwardAction"));this.Ca.iK(G.a.Lrc,ie.a.frame,Object(I.a)(this,this.hsh,"ribbonMoveBackwardAction"));this.Ca.iK(G.a.gqd,ie.a.frame,Object(I.a)(this,this.gsh,"ribbonEscAction"))}}Object(m.a)(MG,"ReactRibbonFocusManager",
null,[107]);class sB{constructor(){this.CommandLocation=0;this.CommandTabName=null;this.InvocationMethod=0}}Object(m.a)(sB,"CommandSqmInfo",null,[]);var Yd=d(526),ix=d(360),jx;(function(a){a[a.UnspecifiedGallery=0]="UnspecifiedGallery";a[a.CharacterCodeGallery=1]="CharacterCodeGallery";a[a.FontStyleGallery=2]="FontStyleGallery";a[a.InkThicknessGallery=3]="InkThicknessGallery";a[a.IconGallery=4]="IconGallery";a[a.ListGallery=5]="ListGallery";a[a.TableStyleGallery=6]="TableStyleGallery";a[a.PageNumberGallery=
7]="PageNumberGallery";a[a.ChangeColorsGallery=8]="ChangeColorsGallery"})(jx||(jx={}));Object(m.b)("GalleryType",jx);class Go{constructor(){this.title=this.style=this.hidden=this.disabled=null}}Object(m.a)(Go,"CommonGalleryButtonProps",null,[]);class Qy extends Go{constructor(){super();this.tableStyles=this.tableCellStyles=null;this.columns=0}}Object(m.a)(Qy,"AdditionalTableStyleGalleryButtonProps",Go,[]);class NG extends Qy{constructor(){super()}}Object(m.a)(NG,"AdditionalChangeColorsGalleryButtonProps",
Qy,[]);class OG extends Go{constructor(){super();this.character=null}}Object(m.a)(OG,"AdditionalCharacterCodeGalleryButtonProps",Go,[]);class PG extends Go{constructor(){super();this.previewStyleLabel=this.styleDisplayName=null}}Object(m.a)(PG,"AdditionalFontStyleGalleryButtonProps",Go,[]);class QG{constructor(){this.selectedId=this.sections=this.hidden=this.disabled=null;this.level=this.columns=0;this.styles=null;this.galleryType="TableStyleGallery"}}Object(m.a)(QG,"AdditionalGalleryProperties",
null,[]);class RG extends Go{constructor(){super();this.largePreviewIconStyle=this.largeFullIconStyle=this.keytip=this.previewIconStyle=this.fullIconStyle=this.label=this.icon=null}}Object(m.a)(RG,"AdditionalIconButtonProperties",Go,[]);class SG extends Go{constructor(){super();this.styleDisplayName=null}}Object(m.a)(SG,"AdditionalInkThicknessGalleryButtonProps",Go,[]);class TG extends Go{constructor(){super();this.ariaLabel=this.infoAtLevel=null}}Object(m.a)(TG,"AdditionalListGallerButtonProps",
Go,[]);class UG extends Go{constructor(){super();this.text=null}}Object(m.a)(UG,"AdditionalPageNumberGalleryButtonProps",Go,[]);var Ry=d(679),mm=d(947),VG=d(1153);class tB{}tB.Text="Text";Object(m.a)(tB,"TextBoxCommandProperties",null,[]);var nm=d(299);const zQ=(a,b)=>{var c=appChrome.selectors.getActiveControlStates();if(c=Object(qa.a)(Object,c[a])){if((a=Object(qa.a)(String,c.value))&&a===b)return!1;a=Object(qa.a)(String,c.selectedKey);if(!b&&!a)return!1;if(a){c=Array.isArray(c.options)?c.options:
null;let f=null;for(let l=0;l<c.length;l++){const y=Object(qa.a)(Object,c[l]);if(Object(qa.a)(String,y.key)===a){f=y;break}}if(f&&Object(qa.a)(String,f.text)===b)return!1}}return!0},XG=(a,b,c,f)=>{if(0<(f&2)){f=[];switch(b){case "ToggleButtonModel":case "InkButtonModel":f.push(Sy(a,c[wh.a.On]));break;case "CheckboxModel":f.push(appChrome.actions.toggleCheckbox(a,c[wh.a.On]));break;case "ComboBoxModel":if(w.AFrameworkApplication.fa&&(w.AFrameworkApplication.fa.ka("ReactRibbonDispatchActionFilter")||
w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1))&&!zQ(a,c[no.a.Value]))break;(b=c[no.a.Key])?f.push(appChrome.actions.updateComboBoxKey(a,b,c[no.a.Value])):f.push(appChrome.actions.updateComboBoxValue(a,c[no.a.Value]));break;case "FontPickerModel":f.push(appChrome.actions.updateFontPickerSelectedFont(a,c[Pn.SelectedFont]));break;case "SplitButtonModel":f.push(Sy(a,c[VG.a.On]));break;case "SpinButtonModel":f.push(appChrome.actions.updateSpinButton(a,
c[cn.Number],xe.a.S2b(c[cn.UnitType]),c[cn.Text],c[cn.MaxValue],c[cn.Alt]));break;case "ColorPickerModel":f.push(appChrome.actions.updateColorPickerSelectedColor(a,c[Bv.IndexColorSelected]));break;case "PageNumberGalleryButtonModel":f.push(appChrome.actions.updatePageNumberGalleryButtonText(a,c[mm.a.Text]));break;case "CompoundButtonModel":c[wh.a.Description]&&f.push(appChrome.actions.updateCompoundButtonDescription(a,c[wh.a.Description]));wh.a.On in c&&f.push(Sy(a,c[wh.a.On]));break;case "SliderModel":c.snapToStep?
f.push(appChrome.actions.updateSliderSelectedValue(a,c[$o.Value])):f.push(appChrome.actions.updateSliderValue(a,c[$o.Value],c[$o.MinValue]||0,c[$o.MaxValue],c[$o.Text]));break;case "FlyoutAnchorModel":Ry.a.ImageIsVisible in c&&f.push(appChrome.actions.hideFlyoutAnchorIcon(a,!c[Ry.a.ImageIsVisible]));wh.a.On in c&&f.push(Sy(a,c[wh.a.On]));break;case "InputBoxModel":f.push(appChrome.actions.updateInputBoxValue(a,c[tB.Text]))}b=f;var l=Object(qa.a)(String,c[nm.a.iconColor]);void 0!==l&&null!==l&&b.push(appChrome.actions.updateIconColor(a,
l));WG(a,c,f);b=f;(l=Object(qa.a)(Object,c[nm.a.IconSet]))&&b.push(appChrome.actions.setControlIconSet(a,l));b=f;l=Object(qa.a)(String,c[nm.a.customTooltip]);void 0!==l&&null!==l&&b.push(appChrome.actions.setControlCustomTooltip(a,l));a=f;(c=Array.isArray(c[nm.a.gmh])?c[nm.a.gmh]:null)&&a.push.apply(a,c);return f}return null},gu=(a,b)=>appChrome.actions.updateControlEnabledDisabledState(a,b),Sy=(a,b)=>appChrome.actions.toggleButton(a,b),WG=(a,b,c)=>{b=Object(qa.a)(String,b[nm.a.Icon]);void 0!==b&&
null!==b&&c.push(appChrome.actions.setControlIcon(a,b))};class YG{constructor(a,b,c,f){this.Tm=f;this.rra=a;this.ZK=b;this.orb=c;this.PVb={}}GPk(a,b,c,f,l=null){const y=a.ExternalGalleryId||a.ExternalId;var H=a.ExternalId;f.push(y);if(appChrome.selectors.isControlDefined(y))a.GalleryStyle&&tg.d("setGalleryStyles")&&b.push(appChrome.actions.setGalleryStyles(y,a.GalleryStyle));else{if(4!==a.Type)return;c.push(appChrome.api.createGalleryModel(y,Object.assign(new QG,{columns:a.Width,sections:[appChrome.api.gallerySection([],
H)],styles:a.GalleryStyle,galleryType:"IconGallery"})))}c=0;f=!!w.AFrameworkApplication.fa&&(w.AFrameworkApplication.fa.ka("ReactRibbonDispatchActionFilter")||w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1));if(tg.d("setGallerySections")&&a.GallerySections&&0<a.GallerySections.length){H=[];const ia=[],wa=[],Ua={};for(var Q of a.GallerySections){H.push(appChrome.api.gallerySection([],Q.SectionId,Q.Title));0===c&&Q.GalleryButtons&&
0<Q.GalleryButtons.length&&(c=Q.GalleryButtons[0].Type);f&&this.x$f(Q.GalleryButtons,l,Ua);const kb=this.lSd(ia,Q.GalleryButtons,Ua);ia.push.apply(ia,this.cce(kb,y,Q.SectionId,!1,c,l,!0,Ua));wa.push.apply(wa,kb)}b.push(appChrome.actions.setGallerySections(y,H));b.push.apply(b,ia);b.push.apply(b,this.kae(y,jx[c],wa,null,5===a.Type,!0,null,Ua))}else a.GalleryItems&&0<a.GalleryItems.length&&(c=a.GalleryItems[0].Type),Q=f?this.x$f(a.GalleryItems,l,null):null,b.push.apply(b,this.cce(this.lSd(b,a.GalleryItems,
Q),y,H,!1,c,l,!1,Q))}roj(a,b){const c=[];let f=null,l=!1;if(!a)return null;const y=this.rra.poc(this.ZK,a.commandId,b);c.push(gu(a.externalUxCommand,!y));if(a.previewControlIds){const ia=[];for(let wa=0;wa<a.previewControlIds.length;wa++){var H={},Q=a.previewControlIds[wa];H.SourceControlId=Q;const Ua=this.Tm.getCommandByExternalUxId(Q);this.HWc(Ua||a,H);H[mm.a.On]&&(f=H.SourceControlId,H[mm.a.HighlightOn]&&(l=!0));WG(Q,H,c);if(H=Object(qa.a)(ix.a,H[mm.a.GalleryButtonProps]))ia.push(H),y&&(Q=this.rra.poc(this.ZK,
H.Command,b),H.IsDisabled=!Q)}0<ia.length&&c.push.apply(c,this.cce(this.lSd(c,ia),a.externalUxCommand,a.externalUxCommand,!0,ia[0].Type));c.push(appChrome.actions.updateGallerySelectedId(a.externalUxCommand,f));l&&(ka.ULS.sendTraceTag(561394453,340,50,"HighlightSelectedFontStyle fired for {0} button",f),c.push(appChrome.actions.highlightSelectedFontStyle(f)))}return c}lSd(a,b,c=null){const f=[],l=[];for(let H=0;H<b.length;H++){const Q=b[H],ia=uk.a(Q.ExternalId)?Q.Id:Q.ExternalId;f.push(ia);const wa=
c&&c[ia]?c[ia].result:-1;switch(Q.Type){case 1:var y=Q;l.push(appChrome.api.createCharacterCodeGalleryButtonModel(ia,Object.assign(new OG,{disabled:-1!==wa?1>(wa&1):y.IsDisabled,character:y.Character,style:y.Style,title:y.Alt})));break;case 2:y=Q;l.push(appChrome.api.createFontStylesGalleryButtonModel(ia,Object.assign(new PG,{disabled:-1!==wa?1>(wa&1):y.IsDisabled,styleDisplayName:y.LabelText,style:y.Style,title:y.Alt,previewStyleLabel:y.PreviewStyleLabel})));break;case 3:y=Q;l.push(appChrome.api.createInkThicknessGalleryButtonModel(ia,
Object.assign(new SG,{disabled:-1!==wa?1>(wa&1):y.IsDisabled,styleDisplayName:y.LabelText,style:y.Style,title:y.Alt})));break;case 4:y=Q;l.push(appChrome.api.createIconGalleryButtonModel(ia,Object.assign(new RG,{disabled:-1!==wa?1>(wa&1):y.IsDisabled,icon:[y.Icon],fullIconStyle:y.FullIconStyle,previewIconStyle:y.PreviewIconStyle,largePreviewIconStyle:y.LargePreviewIconStyle,label:y.LabelText,title:y.Alt})));break;case 5:y=Q;l.push(appChrome.api.createListGalleryButtonModel(ia,Object.assign(new TG,
{disabled:-1!==wa?1>(wa&1):y.IsDisabled,infoAtLevel:y.LevelInfo,ariaLabel:y.Alt})));break;case 6:y=Q;l.push(appChrome.api.createTableStyleGalleryButtonModel(ia,Object.assign(new Qy,{disabled:-1!==wa?1>(wa&1):y.IsDisabled,tableCellStyles:y.TableCellStyles,tableStyles:y.TableStyles,title:y.Alt,columns:y.columns})));break;case 8:y=Q;l.push(appChrome.api.createChangeColorsGalleryButtonModel(ia,Object.assign(new NG,{disabled:-1!==wa?1>(wa&1):y.IsDisabled,tableCellStyles:y.TableCellStyles,tableStyles:y.TableStyles,
title:y.Alt})));break;case 7:y=Q,l.push(appChrome.api.createPageNumberGalleryButtonModel(ia,Object.assign(new UG,{disabled:-1!==wa?1>(wa&1):y.IsDisabled,text:y.Text,title:y.Alt})))}this.Tm.addCommandToMaps(Object.assign(new Yd.a(ia,Q.Command),{queryCommandId:Q.QueryCommand,menuItemId:Q.MenuItemId}))}a.push(appChrome.actions.addControls(l));return f}cce(a,b,c,f,l,y=null,H=!1,Q=null){const ia=[];f?ia.push(appChrome.actions.populateGalleryItems(b,a)):(this.PVb[b]=!1,H||(f=!0,appChrome.selectors.isControlDefined(b)&&
(f=appChrome.selectors.getGalleryState(b),f=f.disableIndividualButtons?f.disableIndividualButtons:!0),ia.push.apply(ia,this.kae(b,jx[l],a,null,5===l,f,y,Q))),ia.push(appChrome.actions.updateGallerySectionItems(b,c,a)));return ia}Qhj(a){return this.kae(a.ExternalUxId,a.galleryType,a.items,a.sections,a.isListGallery,a.disableIndividualButtons?a.disableIndividualButtons:!0)}kae(a,b,c,f,l,y=!0,H=null,Q=null){const ia=[];if(a in this.PVb){if(this.PVb[a])return delete this.PVb[a],ia;this.PVb[a]=!0}let wa=
null,Ua=-1;if(c)({X2f:Ua,returnValue:wa}=this.xxf(b,c,ia,y,H,Q));else if(f)for(const kb of f)(c=({X2f:Ua}=this.xxf(b,kb.galleryButtons,ia,y,null,Q)).returnValue)&&(wa=c);ia.push(appChrome.actions.updateGallerySelectedId(a,wa));y&&ia.push(gu(a,!1));l&&0<Ua&&ia.push(appChrome.actions.updateListGalleryTextDirection(a,2===Ua));return ia}w$f(a,b=null){const c={},f={};f.SourceControlId=a;f.Location=b;a=this.Tm.getCommandByExternalUxId(a);if(!a)return c.result=-1,c.props=f,c;a=this.HWc(a,f);c.result=a;c.props=
f;return c}x$f(a,b=null,c=null){c||(c={});for(const f of a)a=uk.a(f.ExternalId)?f.Id:f.ExternalId,c[a]=this.w$f(a,b);return c}xxf(a,b,c,f,l=null,y=null){let H,Q=null;H=-1;let ia=!1;for(const Ua of b){var wa=this.Ohj(a);b=y&&y[Ua]&&-1!==y[Ua].result?y[Ua]:this.w$f(Ua,l);const kb=b.result;b=b.props;f&&c.push(gu(Ua,1>(kb&1)));(wa=XG(Ua,wa,b,kb))&&c.push.apply(c,wa);b[mm.a.On]&&(Q=Ua,b[mm.a.HighlightOn]&&b[mm.a.HighlightOn]&&(ia=!0));void 0!==b[nm.a.labelText]&&null!==b[nm.a.labelText]&&(wa=this.Tm.getCommandByExternalUxId(Ua),
c.push(appChrome.actions.setControlLabel(wa.externalUxCommand,b[nm.a.labelText])));b[mm.a.IsRtl]&&0>H&&(H=b[mm.a.IsRtl])}ia&&(ka.ULS.sendTraceTag(561394456,340,50,"HighlightSelectedFontStyle fired for {0} button",Q),c.push(appChrome.actions.highlightSelectedFontStyle(Q)));return{returnValue:Q,X2f:H}}Ohj(a){switch(a){case "CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";case "FontStyleGallery":return"FontStyleGalleryButtonModel";case "InkThicknessGallery":return"InkThicknessGalleryButtonModel";
case "IconGallery":return"IconGalleryButtonModel";case "ListGallery":return"ListGalleryButtonModel";case "TableStyleGallery":return"TableStyleGalleryButtonModel";case "ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";case "PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"}HWc(a,b){b.MenuItemId=a.menuItemId;return this.rra.Jld(this.ZK,this.orb,a.commandId,a.queryCommandId,b)}}Object(m.a)(YG,"ReactGalleryPoller",null,[]);var oo=d(927),AQ=d(592),Ty=d(808),BQ=d(810);class uB extends hg.a{constructor(){super()}get ControlType(){return 3}}
Object(m.a)(uB,"CompoundButtonProps",hg.a,[]);var CQ=d(948),Cq=d(591),DQ=d(593),EQ=d(949);class ZG{constructor(){this.initialPinnedFontKeys=this.mruList=this.fonts=this.commandId=null;this.isSubscriber=!1;this.previewFontFamily=null}}Object(m.a)(ZG,"PopulateFontPickerDataProps",null,[]);var as=d(413);class $G extends Fo{constructor(){super();this.ariaDescription=this.lang=this.roleInMenu=this.styles=this.commandValueId=null}}Object(m.a)($G,"OptionalCompoundButtonProperties",Fo,[]);class aH extends Fo{constructor(){super();
this.onRetryCommandId=this.retryButtonTitle=this.ariaDescription=this.label=null}}Object(m.a)(aH,"OptionalErrorViewProperties",Fo,[]);class bH extends Fo{constructor(){super();this.isBanner=null}}Object(m.a)(bH,"OptionalLabelProperties",Fo,[]);class cH extends Fo{constructor(){super();this.commandValueId=this.actionCommandValueId=this.actionText=this.actionId=this.details=this.links=this.description=this.actionCommandId=this.commandId=this.secondaryLabel=this.label=null}}Object(m.a)(cH,"OptionalMultipActionButtonProperties",
Fo,[]);class dH extends zv{constructor(){super();this.styles=this.secondaryText=null;this.flipIconInRtl=!1}}Object(m.a)(dH,"OptionalPersonaButtonProperties",zv,[]);class Uy extends Fo{constructor(){super();this.toggled=!1;this.roleInMenu=null;this.toggleUsingIcon=!1}}Object(m.a)(Uy,"OptionalToggleButtonProperties",Fo,[]);var FQ=d(951),GQ=d(950),Vy=d(482);class eH{constructor(){this.TLf=this.actions=null;this.AQh=!1}}Object(m.a)(eH,"PopulateActions",null,[]);class vB{Hbg(a,b){switch(b){case "ColorPickerModel":return appChrome.selectors.getColorPickerState(a);
case "ToggleButtonModel":return this.Loj(a);case "InkButtonModel":return this.Koj(a);case "GalleryModel":return appChrome.selectors.getGalleryState(a);case "SplitButtonModel":return appChrome.selectors.getSplitButtonState(a);case "SliderModel":return appChrome.selectors.getSliderState(a)}return{}}Loj(a){const b={};b[wh.a.On]=appChrome.selectors.getButtonToggleState(a);return b}Koj(a){const b={};b[wh.a.On]=tg.j("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(a):appChrome.selectors.getButtonToggleState(a);
return b}}Object(m.a)(vB,"ReactStatePropsSelector",null,[]);class Wy{constructor(a,b,c,f,l){this.rra=a;this.ZK=b;this.orb=c;this.Tm=f;this.qPd={};this.w5h=new vB;this.Y5a=l}oDh(a){const b=a.populationProps.populateQueryCommandId;return a.populationProps.populateOnlyOnce&&b in this.qPd}hpj(a,b,c=null){const f=[],l={};if(!this.oDh(a)){const y=a.populationProps.populateQueryCommandId,H={};H.MenuId=a.externalUxCommand;H.IsShadowMenuOpen=this.isShadowMenuOpen(c);if(0<(this.rra.Jld(this.ZK,this.orb,y,y,
H,this.djj(c))&1))if("FontPickerModel"===b)this.qPd[y]=!0,f.push(Wy.coj(a,H)),l[a.externalUxCommand]="FontPickerModel";else if(H.MenuItems)switch(this.qPd[y]=!0,b){case "ComboBoxModel":f.push(Wy.aoj(a,H));l[a.externalUxCommand]="ComboBoxModel";break;case "FlyoutAnchorModel":case "InkFlyoutAnchorModel":case "PreviewGalleryModel":case "SplitButtonModel":case "StatefulSplitButtonModel":f.push.apply(f,this.Vcg(a.externalUxCommand,b,H.MenuItems,l,c&&"location"in c?c.location:null))}}return Object.assign(new eH,
{actions:f,TLf:l,AQh:this.isShadowMenuOpen(c)})}d9f(a,b,c,f,l,y,H,Q,ia=null){let wa=null;const Ua=[];uk.b(a.Title)||(wa=a.Title);for(let kb=0;kb<a.ControlList.length;kb++){const Gb=Object(qa.a)(NA.a,a.ControlList[kb]);if(!Gb||Gb.ExternalId)y&&this.cdj(Gb,y),b.push.apply(b,this.boj(Gb,H,Ua,l,c,f,ia))}return Q?appChrome.api.menuSection(Ua,wa,a.Lang):null}Vcg(a,b,c,f,l=null){const y=[],H=[],Q=[],ia=[];for(var wa=0;wa<c.MenuSectionList.length;wa++){var Ua=Object(qa.a)(Rk.a,c.MenuSectionList[wa]);Ua&&
(Ua=this.d9f(Ua,y,a,b,ia,f,H,c.UpdateDynamically,l),c.UpdateDynamically&&Q.push(Ua))}wa=null;c.MenuFooterSection&&(wa=this.d9f(c.MenuFooterSection,y,a,b,ia,f,H,c.UpdateDynamically,l));c.UpdateDynamically&&y.push(appChrome.actions.updateMenu(a,Q,c.Title,c.AriaLabel,c.ShouldAutoOpen,c.AriaRoleDescription,c.MenuTargetDescriptor,wa));0<H.length&&y.splice(0,0,appChrome.actions.addControls(H));0<ia.length&&tg.d("setStatefulSplitButtonMruBypassControls")&&y.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(a,
ia));return y}cdj(a,b){switch(a.ControlType){case 1:case 3:b[a.ExternalId]=1===a.ControlType?"ButtonModel":"CompoundButtonModel";break;case 2:b[a.ExternalId]="ToggleButtonModel";break;case 6:b[a.ExternalId]="CheckboxModel";break;case 7:b[a.ExternalId]="ColorPickerModel";a=Object(qa.a)(Ty.a,a);a.McuLayout&&(b[a.McuExternalId]="ColorPickerModel");break;case 9:b[a.ExternalId]="FlyoutAnchorModel"}}boj(a,b,c,f,l,y,H=null){const Q=[];switch(a.ControlType){case 14:w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutBannerEnabled",
!1)&&this.MPk(Object(qa.a)(DQ.a,a),Q,b,c);break;case 1:case 3:f=Object(qa.a)(hg.a,a);this.oPk(f,Q,b,c);f.MenuItemsStatefulData&&tg.d("setStatefulSplitButtonMenuItemsStatefulData")&&Q.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(l,f.MenuItemsStatefulData));break;case 2:this.fQk(Object(qa.a)(Vy.a,a),Q,b,c);break;case 6:this.rPk(Object(qa.a)(AQ.a,a),Q,b,c);break;case 4:this.YPk(Object(qa.a)(AA,a),Q,b,c);break;case 7:this.sPk(Object(qa.a)(Ty.a,a),Q,b,c);break;case 12:this.yPk(Object(qa.a)(CQ.a,
a),Q,b,c);break;case 13:this.SPk(Object(qa.a)(EQ.a,a),Q,b,c);break;case 9:l=Object(qa.a)(zA.a,a);this.BPk(l,Q,b,c);"StatefulSplitButtonModel"===y&&f.push(l.ExternalId);break;case 8:this.Y5a.GPk(Object(qa.a)(Cq.a,a),Q,b,c,H)}return Q}MPk(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),a.IconName&&0<a.IconName.length&&b.push(appChrome.actions.setControlIcon(a.ExternalId,a.IconName))):(b=
null,a.IconName&&0<a.IconName.length&&(b=new ap.a(a.IconName)),c.push(appChrome.api.createLabelModel(a.ExternalId,a.LabelText,a.Id,Object.assign(new bH,{isBanner:a.IsBanner,iconSet:b?b.iconSet:null}))))}oPk(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),a.Description&&b.push(appChrome.actions.updateCompoundButtonDescription(a.ExternalId,a.Description)),a.CommandValueId&&b.push(appChrome.actions.setButtonCommandValueId(a.ExternalId,
a.CommandValueId)),this.MJc()&&((c=this.Zta(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new ap.a(c)).iconSet)),a.LabelText!==a.Alt&&b.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,a.Alt)))):(a.Description||Object(Wa.a)(uB,a)?c.push(appChrome.api.createCompoundButtonModel(a.ExternalId,a.LabelText,a.Description,Object.assign(new $G,{iconSet:(new ap.a(this.Zta(a))).iconSet,keytip:a.KeyTip,roleInMenu:a.RoleInMenu,ariaDescription:a.AriaDescription,customTooltip:a.LabelText!==
a.Alt?a.Alt:null}))):(f=a.DismissHostingSurfaceOnExecute,c.push(appChrome.api.createButtonModel(a.ExternalId,a.LabelText,Object.assign(new zv,{iconSet:(new ap.a(this.Zta(a))).iconSet,keytip:a.KeyTip,supportsPreview:!!a.CommandPreviewId&&!!a.CommandRevertId,customTooltip:a.LabelText!==a.Alt?a.Alt:null,commandValueId:a.CommandValueId,shouldTakeFocus:a.ShouldTakeFocus,dismissHostingSurfaceOnExecute:void 0!==f&&null!==f?f:!0})))),this.Tm.addCommandToMaps(Object.assign(new Yd.a(a.ExternalId,a.Command),
{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand,commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})));a.Lang&&tg.d("setControlLanguage")&&b.push(appChrome.actions.setControlLanguage(a.ExternalId,a.Lang))}rPk(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.MJc()&&((c=this.Zta(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new ap.a(c)).iconSet)),
a.IsChecked&&b.push(appChrome.actions.toggleButton(a.ExternalId,a.IsChecked)),a.LabelText!==a.Alt&&b.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,a.Alt)))):(c.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,Object.assign(new Uy,{iconSet:(new ap.a(this.Zta(a))).iconSet,keytip:a.KeyTip,toggled:a.IsChecked,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==a.Alt?a.Alt:null,toggleUsingIcon:!!a.CheckedImageClass}))),this.Tm.addCommandToMaps(Object.assign(new Yd.a(a.ExternalId,
a.Command),{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand})))}yPk(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.Label&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.Label)),a.IconName&&0<a.IconName.length&&b.push(appChrome.actions.setControlIcon(a.ExternalId,a.IconName))):(b=null,a.IconName&&0<a.IconName.length&&(b=new ap.a(a.IconName)),c.push(appChrome.api.createErrorViewModel(a.ExternalId,Object.assign(new aH,{label:a.Label,retryButtonTitle:a.RetryButtonTitle,
onRetryCommandId:a.OnRetryCommandId,ariaDescription:a.AriaDescription,iconSet:b?b.iconSet:null}))))}SPk(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(c={},a.Label&&(c.label=a.Label),a.SecondaryLabel&&(c.secondaryLabel=a.SecondaryLabel),a.Details&&(c.details=a.Details),a.Description&&(c.description=a.Description),a.iconSet&&(c.iconSet=a.iconSet),a.Links&&(c.links=a.Links),a.CommandValueId&&(c.commandValueId=a.CommandValueId),a.ActionCommandValueId&&(c.actionCommandValueId=
a.ActionCommandValueId),a.ActionCommandId&&(c.actionCommandId=a.ActionCommandId),a.CommandId&&(c.commandId=a.CommandId),b.push(appChrome.actions.updateMultiActionButton(a.ExternalId,c))):c.push(appChrome.api.createMultiActionButtonModel(a.Id,Object.assign(new cH,{label:a.Label,secondaryLabel:a.SecondaryLabel,actionText:a.ActionText,description:a.Description,iconSet:a.iconSet,links:a.Links,details:a.Details,actionId:a.ActionId,commandId:a.CommandId,actionCommandId:a.ActionCommandId||a.ActionId,commandValueId:a.CommandValueId,
actionCommandValueId:a.ActionCommandValueId||a.CommandValueId})))}fQk(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.MJc()&&((c=this.Zta(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new ap.a(c)).iconSet)),w.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")&&a.LabelText!==a.Alt&&b.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,
a.Alt)))):(w.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")?c.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,Object.assign(new Uy,{iconSet:(new ap.a(this.Zta(a))).iconSet,iconColor:a.IconColor,keytip:a.KeyTip,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==a.Alt?a.Alt:null}))):c.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,Object.assign(new Uy,{iconSet:(new ap.a(this.Zta(a))).iconSet,
iconColor:a.IconColor,keytip:a.KeyTip,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel}))),this.Tm.addCommandToMaps(Object.assign(new Yd.a(a.ExternalId,a.Command),{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand})))}YPk(a,b,c,f){f.push(a.ExternalId);f=this.Nnj(a);appChrome.selectors.isControlDefined(a.ExternalId)?a.LabelText&&b.push(appChrome.actions.setPersonaButtonCoauthor(a.ExternalId,f,a.LabelText)):tg.a("createPersonaButtonModel")&&c.push(appChrome.api.createPersonaButtonModel(a.ExternalId,
f,a.LabelText,Object.assign(new dH,{role:a.RoleInMenu,fullDescriptionLabel:a.AriaDescription,iconSet:{["default"]:"doughboywhiteglyph_20"}})))}BPk(a,b,c,f){f.push(a.ExternalId);if(appChrome.selectors.isControlDefined(a.ExternalId))a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.MJc()&&((c=this.Zta(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new ap.a(c)).iconSet)),void 0!==a.ImageIsVisible&&null!==a.ImageIsVisible&&b.push(appChrome.actions.hideFlyoutAnchorIcon(a.ExternalId,
!a.ImageIsVisible)),void 0!==a.Toggled&&null!==a.Toggled&&b.push(appChrome.actions.toggleButton(a.ExternalId,a.Toggled)));else{f=!(void 0===a.ImageIsVisible||null===a.ImageIsVisible)&&!a.ImageIsVisible;const l=!(void 0===a.Toggled||null===a.Toggled)&&a.Toggled;c.push(appChrome.api.createFlyoutAnchorModel(a.ExternalId,a.LabelText,Object.assign(new Ky,{iconSet:(new ap.a(this.Zta(a))).iconSet,keytip:a.KeyTip,hideIcon:f,toggled:l,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==a.Alt?a.Alt:null})));
this.Tm.addCommandToMaps(Object.assign(new Yd.a(a.ExternalId,a.Command),{queryCommandId:a.QueryCommand,populationProps:new oo.a(a.PopulateQueryCommand,a.PopulateOnlyOnce)}))}a.Menu&&b.push.apply(b,this.Vcg(a.ExternalId,"FlyoutAnchorModel",a.Menu,null));a.Lang&&b.push(appChrome.actions.setControlLanguage(a.ExternalId,a.Lang))}sPk(a,b,c,f){a.McuLayout&&f.push(a.McuExternalId);f.push(a.ExternalId);f=0;appChrome.selectors.isControlDefined(a.ExternalId)?a.McuLayout&&(f=this.w5h.Hbg(a.ExternalId,"ColorPickerModel").columnCount):
(a.McuLayout&&(c.push(appChrome.api.createColorPickerModel(a.McuExternalId,a.Width)),this.Tm.addCommandToMaps(Object.assign(new Yd.a(a.McuExternalId,a.Command),{commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})),f=a.Width),c.push(appChrome.api.createColorPickerModel(a.ExternalId,a.Width)),this.Tm.addCommandToMaps(Object.assign(new Yd.a(a.ExternalId,a.Command),{commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})));c=[];const l=[];for(let y=0;y<a.Colors.length;y++){const H=
a.Colors[y];y<f?c.push(appChrome.api.colorPickerCell(H.Color,H.DisplayColor,H.Alt)):l.push(appChrome.api.colorPickerCell(H.Color,H.DisplayColor,H.Alt))}0<c.length&&b.push(appChrome.actions.populateColorPickerCells(a.McuExternalId,c));b.push(appChrome.actions.populateColorPickerCells(a.ExternalId,l));a.SelectedColorId&&(0<c.length&&b.push(appChrome.actions.updateColorPickerSelectedColor(a.McuExternalId,a.SelectedColorId)),b.push(appChrome.actions.updateColorPickerSelectedColor(a.ExternalId,a.SelectedColorId)))}Zta(a){return a.Image32by32Class?
this.Tm.N6f(a.Image32by32Class):a.Image16by16Class?this.Tm.N6f(a.Image16by16Class):a.ExternalImageId}Nnj(a){return a?Object.assign(new GQ.a,{displayName:a.DisplayName,personaCoinColor:a.ImageBackColor,isUnauthenticatedSender:a.IsAnonymous,identifiers:Object.assign(new FQ.a,{PersonaType:"User",Smtp:a.PersonaId})}):null}djj(a){let b=2;a&&"inputMethod"in a&&a.inputMethod&&(b=a.inputMethod);return b}isShadowMenuOpen(a){return!!a&&a.isShadowRendering}MJc(){return w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowFullPropPopulation",
!1)}static coj(a,b){return appChrome.actions.populateFontPickerDataAsync(new Promise((c,f)=>{Ib.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(l=>{l.isFeatureEnabled(as.a.CWa,!1).then(y=>{let H=b.fonts;y||l.isFreemiumUpsellEnabled()||(H=Yb.a.dqa(H,Q=>Q.fontType!==as.a.iQe));y=Object.assign(new ZG,{commandId:a.externalUxCommand,fonts:H,isSubscriber:y,mruList:b.mruList,initialPinnedFontKeys:b.initialPinnedFontKeys,previewFontFamily:"msofp_hier_MSFontService"});
c(y)}).catch(f)})}))}static aoj(a,b){const c=[];for(let f=0;f<b.MenuItems.MenuSectionList.length;f++){const l=b.MenuItems.MenuSectionList[f];l.Title&&c.push(appChrome.api.comboBoxHeader("Header-"+f.toString(),l.Title));for(let y=0;y<l.ControlList.length;y++){const H=Object(qa.a)(BQ.a,l.ControlList[y]);H&&c.push(appChrome.api.comboBoxItem(H.MenuItemId,H.LabelText,H.Styles,H.CommandValueId,H.AriaLabel,H.Data,H.Disabled))}f<b.MenuItems.MenuSectionList.length-1&&c.push(appChrome.api.comboBoxDivider("Divider-"+
f.toString()))}return appChrome.actions.populateComboBoxOptions(a.externalUxCommand,c)}}Object(m.a)(Wy,"ReactPopulateQueryCommandPoller",null,[]);class fH{constructor(a,b,c,f,l){this.Tm=c;this.rra=a;this.ZK=b;this.orb=f;this.Y5a=l}gpj(a,b,c){const f=[];if(this.EUj(b))a=this.htj(a,b,c),void 0!==a&&null!==a&&f.push.apply(f,a);else if(a){var l=this.HWc(a,c);nm.a.visible in c&&f.push(appChrome.actions.updateControlHiddenState(a.externalUxCommand,!c[nm.a.visible]));f.push(gu(a.externalUxCommand,1>(l&1)));
void 0!==c[nm.a.labelText]&&null!==c[nm.a.labelText]&&f.push(appChrome.actions.setControlLabel(a.externalUxCommand,c[nm.a.labelText]));void 0!==b&&null!==b&&(l=XG(a.externalUxCommand,b,c,l),void 0!==l&&null!==l&&f.push.apply(f,l),"PeopleWell"===b&&this.fdi(a.externalUxCommand,c,f))}return f}xgj(a,b,c){const f=[];switch(b){case "FlyoutAnchorModel":var l=appChrome.selectors.getFlyoutAnchorMenuItems(a);break;case "SplitButtonModel":var y=appChrome.selectors.getSplitButtonState(a);if(y=this.Tm.getCommandByExternalUxId(y.command))c=
this.rra.poc(this.ZK,y.commandId,c),f.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(a,!c)),f.push(gu(a,!1));return f;default:return null}b=!1;for(y in l)if(l=this.Tm.getCommandByExternalUxId(y),uk.b(l))b=!0;else if(c.SourceControlId=l.externalUxCommand,this.rra.poc(this.ZK,l.commandId,c))return f.push(gu(a,!1)),f;f.push(gu(a,!b));return f}htj(a,b,c){switch(b){case "PreviewGalleryModel":return this.Y5a.roj(a,c);case "GalleryModel":return this.Y5a.Qhj(c)}return null}EUj(a){return"GalleryModel"===
a||"PreviewGalleryModel"===a}HWc(a,b){b.MenuItemId=a.menuItemId;return this.rra.Jld(this.ZK,this.orb,a.commandId,a.queryCommandId,b)}fdi(a,b,c){const f=b[Ry.a.LabelTextUserGeneratedPlaceholderReplacements];b=b[Ry.a.LabelText];f&&0<f.length&&(b=String.format.apply(null,[b].concat(f)));c.push(this.cwj(a,b))}cwj(a,b){return appChrome.actions.updatePeopleWell(this.Icj(a),b)}Icj(a){const b=[];var c={};a=this.Tm.getCommandByExternalUxId(a).populationProps.populateQueryCommandId;this.rra.Jld(this.ZK,this.orb,
"1285265560",a,c);c=c.MenuItems;if(!c)return b;c=c.MenuSectionList[0];for(a=0;a<c.ControlList.length;a++){const f=c.ControlList[a],l={};l.name=f.Alt;l.id=f.MenuItemId;l.description=f.Description;l.color=f.ImageBackColor;l.joinTime=f.JoinTimeInMS;l.imageUrl=f.ImageUrl;l.activeStatus=f.ActiveStatus;l.isAnonymous=f.IsAnonymous;l.canJump=f.CanJump;l.upn=f.Upn;b.push(l)}return b}}Object(m.a)(fH,"ReactQueryCommandPoller",null,[]);class gH{Jld(a,b,c,f,l,y){let H=0;a&&(this.poc(a,c,l)&&(H|=1),c=new sB,c.CommandLocation=
b,void 0!==y&&null!==y&&(c.InvocationMethod=y),!uk.b(f)&&a.RYf(f,l,c)&&(H|=2));return H}poc(a,b,c=null){return a?a.Zbc(b,c):!1}}Object(m.a)(gH,"RootPoller",null,[]);class hH{constructor(a,b,c){this.Tm=a;this.ZK=b;a=new gH;this.e8h=new vB;this.Y5a=new YG(a,this.ZK,c,this.Tm);this.Jqf=new Wy(a,this.ZK,c,this.Tm,this.Y5a);this.Eqf=new fH(a,this.ZK,this.Tm,c,this.Y5a)}jUa(){const a=[];if(!tg.c())return a;a.push.apply(a,this.awj());var b=this.Kfj();if(0<b.length)a.push.apply(a,b);else if(b=appChrome.selectors.getActiveControlIds(),
Object.keys(b).length){const c=this.Lfj();for(const f of c)a.push(appChrome.actions.updateControlEnabledDisabledState(f,!0)),delete b[f];a.push.apply(a,this.GXc(b))}return a}roc(a,b){tg.c()&&(a=this.GXc(a,b),appChrome.api.dispatch(a))}pPe(a,b,c=null){if(!uk.b(a)&&a.populationProps&&!this.Jqf.oDh(a)){a=this.Jqf.hpj(a,b,c);if(!a.AQh){let f;(f=a.actions).push.apply(f,this.GXc(a.TLf,tg.g(c)))}if(0<a.actions.length)return appChrome.api.dispatch(a.actions),!0}return!1}GXc(a,b=0){const c=[],f={};if(tg.a("isSharedUxGateEnabled")&&
appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DefaultRibbinUILocationPolling")&&""!==appChrome.selectors.getSelectedTabId())for(var l of appChrome.selectors.getActiveGroupIds())for(var y of appChrome.selectors.getVisibleControlsInGroup(l))f[y]=!0;for(let H in a)l=H,y=a[H],0===b&&f[l]&&(b=2),c.push.apply(c,this.$vj(l,y,b));return c}$vj(a,b,c=0){const f=[],l=this.Tm.getCommandByExternalUxId(a);let y={};appChrome.selectors.isControlDefined(a)&&(y=this.e8h.Hbg(a,b));y[bn.a.Ixd]=c;uk.b(l)?
(y.ExternalUxId=a,(a=this.Eqf.xgj(a,b,y))&&0<a.length&&f.push.apply(f,a)):(y.MenuItemId=l.menuItemId,y.SourceControlId=a);f.push.apply(f,this.Eqf.gpj(l,b,y));return f}awj(){const a=[],b=!!w.AFrameworkApplication.fa&&(w.AFrameworkApplication.fa.ka("ReactRibbonDispatchActionFilter")||w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1)),c=appChrome.selectors.getContextualTabIds();let f=[];b&&(f=appChrome.selectors.getActiveContextualTabIds());
for(let y=0;y<c.length;y++){var l=this.Tm.vde(c[y]);if(l){l=this.ZK.Zbc(l);let H=!0;b&&(H=0<=Array.indexOf(f,c[y]));b&&H===l||a.push(appChrome.actions.activateDeactivateContextualTab(c[y],l))}}return a}Kfj(){var a=appChrome.selectors.getSelectedTabId();const b=[],c=this.Tm.vde(a);c&&(this.ZK.Zbc(c)||b.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(a,!0)));return b}Lfj(){var a=appChrome.selectors.getActiveGroupIds();const b=[];for(const c of a)if(a=this.Tm.cij(c))for(const f of a)this.ZK.Zbc(f.commandId)||
((a=f.externalUxCommandIds)||(a=appChrome.selectors.getVisibleControlsInGroup(f.externalUxGroupId)),b.push.apply(b,a));return b}}Object(m.a)(hH,"ReactRibbonRootPoller",null,[1540]);class kx{constructor(a,b,c=null){this.ZK=this.aWb=this.OPa=null;this.t5h=b;a.Esb(this);this.Saa=c}get l4c(){this.aWb||(this.aWb=new Date,this.aWb.setTime(0));return this.aWb}set l4c(a){this.aWb=a}get edl(){return 2}get Saa(){return this.ZK}set Saa(a){this.ZK=a}get CLb(){this.OPa||(this.OPa=new hH(this.t5h,this.Saa,this.edl));
return this.OPa}mNc(){const a=document.activeElement;Ea.a.isEditable(a)&&a.blur()}executeCommand(a,b,c,f,l,y,H,Q=2){uk.b(this.Saa)||(l=new sB,l.CommandLocation=Q,l.InvocationMethod=f,l.CommandTabName=c,b[bn.a.Ixd]=Q,this.Saa.RYf(a,b,l,y,H),this.wak(a,b))}jUa(){return uk.b(this.Saa)?[]:this.CLb.jUa()}qoc(){const a=this.jUa();0<a.length&&(this.l4c=new Date,appChrome.api.dispatch(a))}aRb(){tg.c()&&this.CLb.roc({PeopleWell:"PeopleWell"},18)}wak(a,b){try{const c=Ib.a.instance.qb("Common.ISystemInitiatedFeedback");
if(c&&b){const f=b.SourceControlId||b.launcherId||b.LegacyId||b.NewContextId;let l=(f?"_"+f:"")+(b.SqmControlId?"_"+b.SqmControlId:"");l=l.length?l:"_"+a;c.gse("Ribbon"+l)}}catch(c){ka.ULS.sendTraceTag(527247309,356,10,"LogCommandActivity failed: "+(c?c.toString():""))}}}Object(m.a)(kx,"ReactRibbonRoot",null,[1525,1539]);class wB{constructor(){this.tra=[]}Esb(a){a&&!Array.contains(this.tra,a)&&Array.add(this.tra,a)}coh(a){Array.remove(this.tra,a)}mNc(){for(const a of this.tra)a.mNc()}dispose(){this.tra=
null}}Object(m.a)(wB,"RootManagerBase",null,[277,107]);class bs extends wB{constructor(){super()}static get instance(){return bs.La||bs.QOj()}static QOj(){bs.La=new bs;return bs.La}}bs.La=null;Object(m.a)(bs,"ReactRootManager",wB,[276,277]);class Hp{constructor(a,b,c,f,l,y,H,Q=null,ia=!0,wa=null,Ua=null){this.iUb=this.EHc=this.DCd=this.XP=null;this.Rsf=[];this.OFc=null;this.f6a=a;this.$Jd=b;this.nrb=c;this.Pd=f;this.Ca=l;this.Tm=y;this.XP=wa?wa:new kx(bs.instance,this.Tm);this.d5a=H;this.Hrf=new LG;
this.UPa=Q;this.zOd=ia;new HG;this.lgf=Ua;Pd.a.get_instance().Mj(7,Object(I.a)(this,this.Dnl,"setRibbonPostInteractiveReady"));Pd.a.get_instance().Mj(7,Object(I.a)(this,this.Jck,"logRibbonLoadedActivity"));Pd.a.get_instance().Mj(19,Object(I.a)(this,this.jak,"logAppLoadedActivity"));w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&Pd.a.get_instance().Mj(7,Object(I.a)(this,this.C4k,"registerSubComponentReporting"));Pd.a.get_instance().Mj(7,
Object(I.a)(this,this.$Wk,"queueSettingsDependentActions"))}initialize(a,b,c=null){this.zOd||this.ZH(5);c?c.then(()=>{this.Hph()}).catch(()=>ka.ULS.sendTraceTag(561394319,340,10,"Failed to load the resources for the Ribbon")):GG.a.AIh(GG.a.AIh(Ql.Task.WAA(this.yvg(a),this.xvg(Hp.VVh)),()=>this.xvg(Hp.bUh)),()=>this.yvg(b)).continueWith(()=>{this.Hph()},11)}dispose(){this.zLl();this.OFc&&this.OFc.dispose();for(const a of this.Rsf)Pd.a.get_instance().HAi(a);w.AFrameworkApplication.Ra.iK(G.a.Z$k,ie.a.frame,
vf.ActionManager.Sg)}xvg(a){return Ib.a.instance.resolve("Common.ISharedDependencyLoader").BCb(w.AFrameworkApplication.lj(a,2))}yvg(a){return""===a?Ql.Task.qt(!0):Ib.a.instance.resolve("Common.ISharedDependencyLoader").BCb(w.AFrameworkApplication.lj(a,3))}Tjg(){(this.UPa||this.d5a)&&appChrome.api.dispatch(this.Rcg());this.$_e();tg.a("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(w.AFrameworkApplication.Hpa);this.XP.qoc()}Hph(){this.Tjg();this.zOd&&(appChrome.renderAppChrome(this.f6a,
tg.e()),this.ZH(10));this.Rwf();this.ZKc();this.zOd&&this.ZH(5);this.VZc()}VZc(){this.Pd&&this.Ca&&this.nrb&&(this.OFc=new MG(this.Pd,this.Ca,this.f6a,this.nrb),this.OFc.initialize())}get Rcl(){return this.Hrf}setCommandDefinitionMapping(){if(tg.a("setCommandDefinitionMapping")){const a=wQ(this.Tm);appChrome.api.setCommandDefinitionMapping(a)}}registerOnShyRibbonStateChange(){w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.ob.zea&&tg.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((a,
b)=>{0===b&&this.TJb()})}Rwf(){this.setCommandDefinitionMapping();this.registerOnShyRibbonStateChange();const a=Object(qa.a)(kx,this.XP);this.DCd=new KG(this.XP,a.CLb,this.Tm,this.Pd,this.$Jd,Ib.a.instance.qb("Common.IRibbonSQMInformation"),Ib.a.instance.qb("Common.IFileMenuSQMInformation"),w.AFrameworkApplication.Ra,w.AFrameworkApplication.fa,Ib.a.instance.Ia("Common.ISystemInitiatedFeedback"),null);this.Ipi();this.Jzj()}Ipi(){this.EHc=appChrome.api.bindCommandHandler((a,b)=>{this.DCd.executeCommand(a,
b)})}zLl(){this.EHc&&(this.EHc(),this.EHc=null)}$_e(){appChrome.api.initializeLogger(new xQ.a)}jUa(){return this.XP?this.XP.jUa():[]}TJb(){Mf.a.instance.tG(()=>{let a=null;Mf.a.instance.tG(()=>{a=this.jUa()},"RB:GA");a&&0<a.length&&(this.XP.l4c=new Date,Mf.a.instance.tG(()=>{appChrome.api.dispatch(a)},"RB:DA"));this.iUb&&Mf.a.instance.tG(()=>{},"RB:J")},"RB:PFSU")}aRb(){this.XP.aRb()}rai(a){a=[appChrome.actions.activateDeactivateContextualTab(a,!0),appChrome.actions.setCurrentTab(a)];appChrome.api.dispatch(a)}setCurrentTab(a){a=
[appChrome.actions.setCurrentTab(a)];appChrome.api.dispatch(a)}Rcg(){var a=w.AFrameworkApplication.fa;const b=[];a.ka("EnableTellMeForOneLineRibbonIsEnabled")?a.ka("OcpsIsEnabled")&&Ib.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(c=>{c.isFeatureEnabled("ConnectedServices",!0).then(f=>{f&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",!1));return null})}):b.push(appChrome.actions.updateControlHiddenState("TellMeControl",!0));
b.push.apply(b,this.T6f());a=new EG.a(this.Tm);this.UPa.uba&&(Gp.YIl(this.UPa.uba),b.push.apply(b,a.c9d(this.UPa.uba)));if(this.UPa.eKh)for(const c of this.UPa.eKh)b.push(appChrome.actions.updateGallerySectionHiddenState(c.$8i,c.bF,c.$Il));b.push.apply(b,a.D$i(this.UPa.ZIl));return b}T6f(){const a=[];if(this.d5a&&this.d5a.uba){const c=this.d5a.uba;for(let f in c){var b=c[f];const l=this.Tm.H$d(f);if(l)for(let y of l)a.push(appChrome.actions.updateControlHiddenState(y,b))}}return a}UQb(a){a&&this.XP.CLb.roc(a,
0)}pPe(a){this.XP.CLb.pPe(this.Tm.getCommandByExternalUxId(a),appChrome.selectors.getModelType(a),{inputMethod:0})}Mul(a){Pd.a.get_instance().Mj(5,null).continueWith(()=>{appChrome.api.dispatch(this.esj(a))})}aVi(){const a=w.AFrameworkApplication.fa.ka("ShareMenuIsEnabled")?"ShareMenu":"Share",b=w.AFrameworkApplication.fa.appSettings;b&&appChrome.api.dispatch(this.oQl(a,"Shared"===(b.SharingStatus||"")))}$Wk(){w.AFrameworkApplication.fa.ff(()=>{this.aVi()})}oQl(a,b){return appChrome.actions.updateSharingStatusIndicator(a,
b)}esj(a){return appChrome.actions.updateControlHiddenState(a,!1)}fsj(){return appChrome.actions.updateControlHiddenState("CopyLink",!1)}ZH(a){Pd.a.get_instance().ZH(a);this.Rsf.push(a)}Dnl(){tg.d("updateRibbonInitializationState")&&appChrome.api.dispatch(appChrome.actions.updateRibbonInitializationState(Object.assign(new FG,{postRibbonInteractiveReady:!0})))}ZKc(){this.d5a&&this.lgf&&(this.iUb=this.lgf.createFileMenu(this.d5a,this.XP.Saa),this.Hrf.fileMenu=this.iUb)}X7j(){this.iUb&&this.iUb.S7j()}iqd(a,
b,c){if(1===c)return 32;this.Vsc(!0);this.TJb();w.AFrameworkApplication.Aa.updateCommandUI();return 32}jqd(a,b,c){if(1===c)return 32;this.Vsc(!1);this.Inl();this.TJb();w.AFrameworkApplication.Aa.updateCommandUI();return 32}p7e(a,b,c){if(1===c)return 32;(a=Ib.a.instance.Ia("Common.ISystemInitiatedFeedback"))&&a.execute(f=>{f.logActivity("DefaultFileOpenPreferenceOn",null)});return 32}Inl(){pi.a.oK(w.AFrameworkApplication.fa.Ha("IsSimplifiedRibbonOnCookieName"),"true",pi.a.XJ)}Vsc(a){pi.a.oK(w.AFrameworkApplication.fa.Ha("ReactRibbonMLRPreferenceCookieName"),
a.toString(),pi.a.XJ)}Jck(){if(w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.ob.Pp){const a=Ib.a.instance.Ia("Common.ISystemInitiatedFeedback");"SingleLine"===appChrome.selectors.getRibbonMode()?(a.execute(b=>{b.logActivity("SingleRibbonModeActivity",null)}),w.AFrameworkApplication.dM("d79fg304;61jba833;h856e313;f5i2f477;d613b829;da9b1202")):"Multiline"===appChrome.selectors.getRibbonMode()&&(a.execute(b=>{b.logActivity("MultiRibbonModeActivity",null)}),w.AFrameworkApplication.dM("69a7h198;dfd7j584"));
w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultToMLR",!1)&&Ib.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(b=>{b.isFreemiumUpsellEnabled()&&w.AFrameworkApplication.dM("5fjej882;e0jjh200")})}}jak(){this.Ca.ya(G.a.p7e,ie.a.frame,Object(I.a)(this,this.p7e,"triggerModeSwitcherTUI"));const a=pi.a.Y3(w.AFrameworkApplication.fa.Ha("VNextStyleOptOutCookieName"),!1);window.setTimeout(()=>{const b=Ib.a.instance.Ia("Common.ISystemInitiatedFeedback");
b&&(w.AFrameworkApplication.fa.ka("Fluent2StyleIsEnabled")?(b.execute(c=>{c.logActivity("VNextStylesOn",null)}),b.execute(c=>{c.logActivity("Fluent2StyleEnabledFPS","Fluent2StyleFloodgateSurveyIsEnabled")})):w.AFrameworkApplication.fa.ka("Fluent2StyleFGOnlyIsEnabled")&&a&&b.execute(c=>{c.logActivity("Fluent2StyleOptOutFPS","Fluent2StyleFloodgateSurveyIsEnabled")}))},5E3)}C4k(){Pd.a.get_instance().Mj(19,()=>{appChrome.api.setAsyncRequestStatus("appBoot",!1)});const a=appChrome.api.getRibbonSubComponentMappings();
for(let c in a){var b=c;const f=a[c];if(f)for(const l of f)w.AFrameworkApplication.Ra.GT(l)?appChrome.api.reportRibbonSubComponentBehaviorMapped(b):w.AFrameworkApplication.Ra.vml(l,this.UMi(b));else appChrome.api.reportRibbonSubComponentBehaviorMapped(b)}}UMi(a){return()=>{appChrome.api.reportRibbonSubComponentBehaviorMapped(a)}}Jzj(){if(w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&tg.a("isSharedUxGateEnabled")&&
appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&w.AFrameworkApplication.PJb.KRd){const a=w.AFrameworkApplication.PJb.KRd,b=w.AFrameworkApplication.PJb.Awf;b.payload||(b.payload={});const c=b.payload.launcherId?b.payload.launcherId:a;Hp.kqd.Fb(c)?Hp.kqd.ga(c)():"StatefulSplitButtonModel"===b.modelType?appChrome.PRIToastManager.dismissToast():(b.payload.PRIReadinessCheck=!0,this.DCd.executeCommand(a,b))}}}Hp.VVh="common";Hp.bUh="appChrome";Hp.kqd=new vQ.a(oB.a.ydg());
Object(m.a)(Hp,"ReactRibbonUser",null,[270,271,107]);class xB{constructor(){this.label=this.value=null}}Object(m.a)(xB,"TextInfoSectionField",null,[]);class iH{constructor(a,b){this.uba=b}}Object(m.a)(iH,"ReactRibbonJewelProperties",null,[]);class yB extends Hp{constructor(a,b,c,f,l,y,H,Q,ia=null,wa=!0,Ua=null,kb=null){super(a,b,f,l,y,H,Q,ia,wa,Ua,kb);this.nBc=null;this.oBc=c;this.oBc.execute(Gb=>{this.nBc=Gb});this.oBc.execute(Gb=>{this.XP.Saa=Gb})}jUa(){return this.nBc?(this.nBc.clearCache(),super.jUa()):
[]}}Object(m.a)(yB,"ReactRibbonUser",Hp,[]);var zB=d(911),cs=d(193),AB=d(379),HQ=d(729),BB=d(1149);class lx{static get zsg(){return"teams"===(w.AFrameworkApplication.fa.Ha(w.AFrameworkApplication.wK)||"").toLowerCase()}static get mAh(){return lx.zsg?(xa.a.J(576030427,811,50,"FileShareEnabled: {0}, CopyLinkForTeamsIsEnabled: {1}",w.AFrameworkApplication.mTa,w.AFrameworkApplication.svb),w.AFrameworkApplication.mTa&&w.AFrameworkApplication.svb):w.AFrameworkApplication.mTa}}Object(m.a)(lx,"CopyLinkHelper",
null,[]);class jH{constructor(a,b){this.eHe=null;this.la=a;this.Vpk=b}dispose(){this.eHe&&(Em.CuiHelper.DVi(this.eHe),this.eHe=null)}Avj(){if(w.AFrameworkApplication.workflowEnabled){let a="";switch(w.AFrameworkApplication.Ixc){case "Assign":a=CommonUIStrings.l_Assign;break;case "Submit":a=CommonUIStrings.l_Submit}if(a.length)return Object.assign(new BB.a,{command:"2988588587",label:a,id:"btnWorkflow"})}return w.AFrameworkApplication.rpe&&w.AFrameworkApplication.C0a||w.AFrameworkApplication.mxc?Object.assign(new BB.a,
{command:"1197060601",label:ResourceStrings.L_ReplyWithChanges,id:Em.CuiHelper.zpd}):w.AFrameworkApplication.mTa?Object.assign(new BB.a,{command:"981334692",label:ResourceStrings.L_Share,image:Em.CuiHelper.Sql,id:Em.CuiHelper.C0e}):null}Dtl(){if(lx.zsg&&!this.Vpk)return!1;const a=this.Avj();return a&&"981334692"===a.command?this.la.Tqg||this.la.Y0j:!1}Htl(){xa.a.J(512496021,820,50,"FileShareEnabled: {0}, CopyLinkForTeamsIsEnabled: {1}",w.AFrameworkApplication.mTa,w.AFrameworkApplication.svb);return w.AFrameworkApplication.mTa&&
(w.AFrameworkApplication.svb||w.AFrameworkApplication.fa.ka("ShareMenuIsEnabled"))}}Object(m.a)(jH,"CuiControlUser",null,[107]);var mx=d(275);class kH extends yB{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd){super(b,a.jka,f,jb.a.Raa,l,y,H,null,wa,!0,null,Gb);this.uzg=this.Pdc=this.Dyg=this.RDb=this.Hh=this.nIa=this.la=this.jh=this.fXa=this.Vcd=this.jve=this.Jze=null;this.TJg=!1;this.D8=0;this.EAe=this.a$c=this.x$=!1;this.Uu=this.Abd=this.jgb=null;this.AGf="hideTellMeWrapper";b=new AB.a("ReactRibbonUser::InitPptReactRibbon",
!1);try{this.nIa=kb,this.la=Ua,this.jve=new jH(this.la,Fc.ka("ShareMenuIsEnabled")),this.Jze=a,this.Vcd=ia,this.RDb=H,this.fXa=Q||new HQ.a,this.jh=this.fXa.d1d(2,"ReactRibbonUser"),this.D8=0,this.Dyg=wa.uba,this.x$=!!window.performance&&!!window.performance.now,this.Hh=ec,this.a$c=dc,this.jgb=Fc,this.EAe=yc,this.Abd=tc,this.Uu=xd,this.v9k(),Pd.a.get_instance().Mj(10,Object(I.a)(this,this.ZNj,"initializeFullPptRibbon"),11),Pd.a.get_instance().Mj(10,Object(I.a)(this,this.createHeader,"createHeader"),
3)}finally{b&&b.dispose()}}Sjg(){wg.a.instance.lc("InitRibbon",(new Date).getTime());xa.a.J(512496020,801,50,"Initialize SLR Iteration: {0}; IsReactMLRRendered: {1}",this.la.LRk?"2":"1",this.la.nza);this.la.iA&&this.la.ka("ActionAIRibbonLoadOn1stTimeEnabled")&&!this.la.ka("ActionAIRibbonLoadedOn1stTime")&&this.Jil();this.la.podsRibbonEarlyRendererExposureControl&&!this.la.eSf?PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RegisterOrInvokeOnInitializeEarlyRenderedPptRibbon(Object(I.a)(this,this.MNj,
"initializeEarlyRenderedPptRibbon")):(wg.a.instance.lc("RenderRibbonStart",Date.now()),this.Dkj(cs.a(Ib.a.instance)).catch(()=>{xa.a.J(512496019,801,10,"Failed to load the resources for the Ribbon.")}).then(()=>{wg.a.instance.lc("AppChromeReadyTime",Date.now());appChrome.setScriptLoader(cs.a(Ib.a.instance));tg.a("setCookieWithExpirationCallback")&&tg.a("setGetCookieValueCallback")&&(appChrome.api.setCookieWithExpirationCallback((a,b)=>pi.a.oK(a,b,pi.a.XJ)),appChrome.api.setGetCookieValueCallback(a=>
pi.a.get(a)));appChrome.setAppSettings(w.AFrameworkApplication.fa.appSettings);if(this.la.ka("DynamicBundlesIsEnabled")){const a=w.AFrameworkApplication.Hpa+"exp/";appResourceLoader.init(sQ.a.resolveScript,a);appChrome.api.setWebpackPublicPath(a)}PowerPointWebEditor.AppChromeSettingsLoadedHandler.OnAppChromeSettingsLoaded();this.$_e();appChrome.initializeRibbonStore(this.la.nza);this.Tjg();this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PerceivedRibbonInteractiveIsEnabled",!1)&&1!==w.AFrameworkApplication.Aa.mode&&
(this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PRIOnlyAfterInteractivityIsEnabled",!1)?this.Kmh():this.nie());this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&this.nIa&&this.nIa.B9k();appChrome.renderAppChrome(this.f6a,tg.e());this.la.AJa&&eb.a("ModernRibbonShimmerCGEnabled")&&PowerPointWebEditor.MinimalBoot.SetRealRibbon("ContentEditable");Pd.a.get_instance().ZH(5);Pd.a.get_instance().ZH(10);Pd.a.get_instance().ZH(6);this.Cwg();
wg.a.instance.lc("Stage1Ribbon",zB.a.L6d&&void 0!==PowerPointWebEditor.FakeRibbon.ShowTime&&null!==PowerPointWebEditor.FakeRibbon.ShowTime?PowerPointWebEditor.FakeRibbon.ShowTime:(new Date).getTime())}))}Kmh(){Pd.a.get_instance().Mj(4,()=>{Pd.a.get_instance().isCompleted(7)||this.nie()})}Jil(){pi.a.oK("PPTActionAIRibbonLoadedOnIstTime",(!0).toString(),pi.a.XJ)}Dkj(a){return a(this.la.nza?"powerpoint-ribbon-mlr-intl":"powerpoint-ribbon-intl").catch(()=>{}).then(()=>a("appChrome"))}MNj(){void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RenderStartTime&&
null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RenderStartTime&&wg.a.instance.lc("RenderRibbonStart",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RenderStartTime);void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.AppChromeReadyTime&&null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.AppChromeReadyTime&&wg.a.instance.lc("AppChromeReadyTime",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.AppChromeReadyTime);void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ShowTime&&null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ShowTime&&
wg.a.instance.lc("Stage1Ribbon",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ShowTime);PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.UnbindPerceivedRibbonInteractive?(PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.UnbindPerceivedRibbonInteractive(),this.nie()):this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PRIOnlyAfterInteractivityIsEnabled",!1)&&this.Kmh();PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveBlockedCommand&&PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveCommandHandlerData&&
this.Abd.Rvh(PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveBlockedCommand,PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveCommandHandlerData);void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.SkeletonDismissedTime&&null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.SkeletonDismissedTime?wg.a.instance.lc("AppInitStatus_ribbonSkeletonDismissed",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.SkeletonDismissedTime):this.Cwg();for(const a of PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.LogMessageCache)4===
a.length&&ka.ULS.sendTraceTag(a[0],a[1],a[2],a[3]);PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.LogMessageCache.length=0;this.$_e();Pd.a.get_instance().ZH(5);Pd.a.get_instance().ZH(10);Pd.a.get_instance().ZH(6);Mu.a.dispatch("RibbonVisible")}ZNj(){wg.a.instance.lc("InitFullRibbon",(new Date).getTime());appChrome.getLazyRibbonInitializationActions().then(a=>{wg.a.instance.lc("RibbonLazyPromiseFulfilled",(new Date).getTime());w.AFrameworkApplication.fa.ff(()=>{this.jve.Htl()?Pd.a.get_instance().Mj(7,
()=>{xa.a.J(512496018,801,50,"Render CopyLink button on Teams session after the full app settings and Chrome ready!");appChrome.api.dispatch(this.fsj())}):Pd.a.get_instance().Mj(7,()=>{appChrome.api.dispatch(appChrome.actions.removePeripheralControl("CopyLink"))})});this.UPa&&a.push.apply(a,this.Rcg());if(w.AFrameworkApplication.Aa.ob.zea){const b=[];b.push(document.getElementById("WACDocumentPanel"));a.push(appChrome.actions.setShyState(Object.assign(new tQ.a,{shyDismissalRegions:b})))}appChrome.api.dispatch(a);
this.K4k();this.oBc.execute(b=>{if(void 0===this.XP.Saa||null===this.XP.Saa)this.XP.Saa=b;this.Rwf()});this.m2k();this.ZKc();this.createFileMenu();this.nIa&&(a=this.nIa.initialize(),xa.a.J(512496017,801,50,"Doc Mode Switcher Initialize response: "+a.toString()));this.VZc();Pd.a.get_instance().ZH(7);wg.a.instance.lc("Stage3Ribbon",(new Date).getTime());this.x$&&wg.a.instance.lc("RibbonInteractivePerfMark",window.performance.now());this.Kck();this.R5k();this.$Nj();Ea.a.QI(this.Jze.SF(),"ScrollableRibbon");
return null})}Kck(){if(wg.a.instance.fbb)xa.a.J(512496016,813,15,"Ribbon Perf metrics: Cannot import metrics from PageLoadPerfRecorder since it has been logged and disposed.");else{var a={};wg.a.instance.Zn("Stage1Ribbon")&&(a.RibbonDisplayed=wg.a.instance.Tg("Stage1Ribbon"));wg.a.instance.Zn("Stage3Ribbon")&&(a.RibbonInteractive=wg.a.instance.Tg("Stage3Ribbon"));wg.a.instance.Zn("InitRibbon")&&(a.InitRibbon=wg.a.instance.Tg("InitRibbon"));wg.a.instance.Zn("InitFullRibbon")&&(a.InitFullRibbon=wg.a.instance.Tg("InitFullRibbon"));
wg.a.instance.Zn("RibbonLazyPromiseFulfilled")&&(a.RibbonLazyPromiseFulfilled=wg.a.instance.Tg("RibbonLazyPromiseFulfilled"));wg.a.instance.Zn("RenderRibbonStart")&&(a.RenderRibbonStart=wg.a.instance.Tg("RenderRibbonStart"));wg.a.instance.Zn("AppChromeReadyTime")&&(a.AppChromeReadyTime=wg.a.instance.Tg("AppChromeReadyTime"));wg.a.instance.Zn("AppInitStatus_ribbonSkeletonDismissed")&&(a.RibbonSkeletonDismissed=wg.a.instance.Tg("AppInitStatus_ribbonSkeletonDismissed"));xa.a.J(512496015,809,50,"Ribbon Perf metrics: "+
ta.a.toJSON(a))}}Tbk(){if(wg.a.instance.fbb)xa.a.J(512496014,813,15,"Lazy Ribbon Perf metrics: Cannot import metrics from PageLoadPerfRecorder since it has been logged and disposed.");else{var a={};wg.a.instance.Zn("Stage2Ribbon")&&(a.RibbonEnabled=wg.a.instance.Tg("Stage2Ribbon"));wg.a.instance.Zn("Stage4Ribbon")&&(a.RibbonFull=wg.a.instance.Tg("Stage4Ribbon"));xa.a.J(512496013,809,50,"Lazy Ribbon Perf metrics: "+ta.a.toJSON(a))}}$Nj(){appChrome.getExtRibbonInitializationActions().then(a=>{appChrome.api.dispatch(a);
wg.a.instance.lc("Stage4Ribbon",(new Date).getTime());this.Tbk();return null})}TJb(){this.nBc&&Pd.a.get_instance().isCompleted(7)&&(pb.a.mark(4893),super.TJb(),pb.a.mark(4894),this.TJg||(wg.a.instance.lc("Stage2RibbonStart",Date.now()),appChrome.api.dispatch(appChrome.actions.setControlBehaviorAttached(!0)),wg.a.instance.lc("Stage2Ribbon",Date.now()),this.TJg=!0))}PA(){this.TJb()}selectRibbonTabById(a){const b=pi.a.Y3(mx.a.M_a,!0);this.la.iA&&b&&eb.a("RemoveContextualFromActionAiRibbonMode")||this.rai(a)}get Wuh(){return appChrome.selectors.getSelectedTabId()}GYi(){this.JGb||
xa.a.J(509637252,801,10,"Ribbon top bar1 is set to null");this.JGb.classList.remove(this.AGf)}STf(){this.JGb||xa.a.J(509637251,801,10,"Ribbon top bar1 is set to null");this.JGb.classList.add(this.AGf)}WUi(){appChrome.getHeaderApi().then(a=>a.dismissPlaceholder())}createHeader(){const a=(new Date).getTime();w.AFrameworkApplication.fa.ff(()=>{if(!eb.a("PPTOHideLegacySharedHeaderBugFix")||!w.AFrameworkApplication.NT){var b=(new Date).getTime(),c=this.jh.Zt("createHeader"),f=w.AFrameworkApplication.Aa.ob.mO,
l=document.getElementById("HeaderPlaceholder");this.JGb=(new CG(se.a.xXi,this.Jze)).E_i();this.la.iA&&"SingleLine".match(appChrome.selectors.getRibbonMode())&&this.STf();if(f)try{xa.a.J(512496012,801,50,"Shared Header - Calling RenderSharedHeader");var y=new zG;appChrome.renderSharedHeader(this.JGb,y.Hoj()).then(()=>{this.dak(b,a);l&&this.WUi()})}catch(H){xa.a.J(512496011,801,10,"Exception while trying to render shared header {0}",H)}else throw xa.a.J(512496010,801,10,"Invalid request to render legacy Shared Header."),
Error.invalidOperation("Invalid request to render legacy Shared Header");w.AFrameworkApplication.NT||(y=at.a.bie(M.AppFrame.tFa,null,this.JGb,!0),f&&(y.uJ=!0,this.ELb(y,G.a.Mrc,G.a.Lrc),y.bindAction(x.KeyInputManager.Qa(B.a.mZ,0),G.a.gqd)));!l&&zB.a.k_f&&PowerPointWebEditor.FakeHeader.RemoveFakeHeader();this.jh.fu(c);this.D8|=1;this.Hwc()}})}dak(a,b){var c=(new Date).getTime();const f={};f.headerCallbackRegistrationTime=b;f.headerCallbackInvokedTime=a;f.headerRenderCompleteTime=c;xa.a.J(512496009,
809,50,"Create Header Perf metrics: "+ta.a.toJSON(f))}ELb(a,b,c){const f=x.KeyInputManager.Qa(B.a.$q,0),l=x.KeyInputManager.Qa(B.a.$q,4);a.Bp(f);a.Bp(l);a.bindAction(f,b);a.bindAction(l,c)}ZKc(){const a=()=>{const b=this.jh.Zt("createJewel");this.d5a=this.JOj();Hp.prototype.ZKc.call(this);this.jh.fu(b);this.D8|=2;this.Hwc()};this.a$c&&this.jgb?this.jgb.Nbb(a):w.AFrameworkApplication.fa.ff(a)}createFileMenu(){const a=(new Date).getTime(),b=()=>{const c=(new Date).getTime(),f=this.jh.Zt("createFileMenu"),
l=[];if(this.la.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var y=[Object.assign(new xB,{label:CommonUIStrings.L_DiagnosticsSessionId,value:w.AFrameworkApplication.userSessionId}),Object.assign(new xB,{label:CommonUIStrings.L_DiagnosticsBuild,value:w.AFrameworkApplication.buildVersion})];l.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",y))}l.push.apply(l,this.T6f());y=document.createElement("div");document.body.appendChild(y);appChrome.renderFileMenu(y,l);this.cak(c,a);this.jh.fu(f);
this.D8|=22;this.Hwc()};this.a$c&&this.jgb?this.jgb.Nbb(b):w.AFrameworkApplication.fa.ff(b)}cak(a,b){var c=(new Date).getTime();const f={};f.fileMenuCallbackRegistrationTime=b;f.fileMenuCallbackInvokedTime=a;f.fileMenuRenderCompleteTime=c;xa.a.J(512496008,809,50,"File Menu Perf metrics: "+ta.a.toJSON(f))}m2k(){const a=()=>{const b=this.jh.Zt("refreshRibbon");this.Pdc||(this.Pdc={},Gp.aKh(this.Pdc),this.Vcd.WOh(this.Pdc),this.uzg=this.Wbj(this.Dyg,this.Pdc));const c=new EG.a(this.RDb);appChrome.api.dispatch(c.c9d(this.uzg));
this.jh.fu(b);this.D8|=4;this.Hwc()};this.a$c&&this.jgb?this.jgb.Nbb(a):w.AFrameworkApplication.fa.ff(a)}Wbj(a,b){const c={};for(let l in b){var f=b[l];const y=l;f!==a[y]&&(c[y]=f,xa.a.J(512496007,801,50,"TrimedId changed after full settings ready, TrimId:{0} PreviousValue:{1} CurrentValue:{2}",y,a[y],f))}return c}JOj(){const a={};this.Vcd.Lll(a);this.Vcd.WOh(a);return new iH(null,a,"jewelPPTEditor")}R5k(){zB.a.L6d&&PowerPointWebEditor.FakeRibbon.RemoveFakeRibbon()}ioh(a){Pd.a.get_instance().Mj(7,
()=>{appChrome.api.dispatch(appChrome.actions.removePeripheralControl(a))})}v9k(){const a=this.la.ka("ShareMenuIsEnabled"),b=a?"ShareTopBar":"Share";w.AFrameworkApplication.svb?this.ioh(b):w.AFrameworkApplication.fa.ff(()=>{const c=this.jh.Zt("createShareAction"),f=this.jve.Dtl();f?this.Mul(b):(this.ioh(b),this.la.Fkb&&this.Hh.waa(this.Hh.v6,this.Hh.ttd));a&&(f?this.la.Fkb&&Pd.a.get_instance().Mj(7,()=>{this.Hh.dP(this.Hh.v6,this.Hh.ttd);this.Hh.vaa(this.Hh.v6,this.Hh.ttd)}):Pd.a.get_instance().Mj(7,
()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShareMenu",!f))}));this.jh.fu(c);this.D8|=8;this.Hwc()})}Hwc(){31===this.D8&&(this.fXa.d5c(2),this.D8=0)}nie(){this.Abd.Hpi();appChrome.api.dispatch(appChrome.actions.setControlBehaviorAttached(!0));Pd.a.get_instance().Mj(7,()=>{this.Abd.yLl();tg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&this.EAe||appChrome.PRIToastManager.dismissToast()},11)}Cwg(){Pd.a.get_instance().ZH(18);
Mu.a.dispatch("RibbonVisible")}v2g(){return()=>{this.Uu.eJc(()=>{appChrome.PRIToastManager.dismissToast()})}}K4k(){this.EAe&&(Hp.kqd.$("NewDefaultSlide",this.v2g()),Hp.kqd.$("ChangeLayoutFlyout",this.v2g()))}}Object(m.a)(kH,"ReactRibbonUser",yB,[1190,271,107]);class lH{constructor(a,b,c,f,l,y,H){this.gFb=null;this.wb=a;this.PNg=b;this.pa=c;this.uu=f;this.FO=l;this.ia=y;this.Up=H;this.PNg.fk(Object(I.a)(this,this.fsh,"ribbonChangeTabHandler"))}dispose(){this.PNg.Om(Object(I.a)(this,this.fsh,"ribbonChangeTabHandler"))}get lA(){return this.gFb}set lA(a){this.gFb!==
a&&a&&(this.gFb=a,this.FO.c0?this.FO.c0=!1:this.Up&&this.FO.rWa&&this.ia.processAction(C.a.Bka,2))}fsh(a,b){b.node.Ua(zb.a.shapeId)&&(a=b.node.eb(zb.a.shapeId),this.gFb&&this.gFb.id===b.node.id&&a&&(this.wb.Hb(new dd.a(2,1,0,()=>{const c=this.pa.Hqj(this.uu.Wuh,b.node);0<c.length&&this.uu.selectRibbonTabById(c)},90,"10")),this.gFb=null))}}Object(m.a)(lH,"RibbonChangeManager",null,[1192]);class mH{constructor(a,b,c){this.$8i=a;this.bF=b;this.$Il=c}}Object(m.a)(mH,"GallerySectionData",null,[]);let CB,
DB,Xy,EB,nx,FB,GB,HB,IB;class Cv{constructor(a,b,c,f,l,y){this.la=a;this.dbd=b;this.yad=c;this.iUg=f;this.TDb=l;this.Hh=y}Zsd(a){this.la.Lpg&&(a["PptRibbon.Home.Drawing.TextBox"]=!0,a["PptRibbon.Home.Drawing.Rectangle"]=!0,a["PptRibbon.Home.Drawing.RoundedRectangle"]=!0,a["PptRibbon.Home.Drawing.Ellipse"]=!0,a["PptRibbon.Home.Drawing.RoundedRectangleCallout"]=!0,a["PptRibbon.Home.Drawing.Star5"]=!0,a["PptRibbon.Home.Drawing.Triangle"]=!0,a["PptRibbon.Home.Drawing.Can"]=!0,a["PptRibbon.Home.Drawing.Cube"]=
!0,a["PptRibbon.Home.Drawing.StraightConnector"]=!0,a["PptRibbon.Home.Drawing.StraightConnectorArrow"]=!0,a["PptRibbon.Home.Drawing.StraightConnectorTwoArrow"]=!0,a["PptRibbon.Home.Drawing.RightArrow"]=!0,a["PptRibbon.Home.Drawing.DownArrow"]=!0,a["PptRibbon.Home.Drawing.LeftArrow"]=!0,a["PptRibbon.Home.Drawing.UpArrow"]=!0,a["PptRibbon.Home.Drawing.UpDownArrow"]=!0,a["PptRibbon.Home.Drawing.LeftRightArrow"]=!0,a["PptRibbon.Home.Drawing.MoreShapes"]=!0,a["PptRibbon.Home.Font.ChangeCase"]=!this.la.ayi,
a["PptRibbon.InsertTab.Illustrations.TextBox"]=!0,a["PptRibbon.InsertTab.Illustrations.Rectangle"]=!0,a["PptRibbon.InsertTab.Illustrations.RoundedRectangle"]=!0,a["PptRibbon.InsertTab.Illustrations.Ellipse"]=!0,a["PptRibbon.InsertTab.Illustrations.RoundedRectangleCallout"]=!0,a["PptRibbon.InsertTab.Illustrations.Star5"]=!0,a["PptRibbon.InsertTab.Illustrations.Triangle"]=!0,a["PptRibbon.InsertTab.Illustrations.Can"]=!0,a["PptRibbon.InsertTab.Illustrations.Cube"]=!0,a["PptRibbon.InsertTab.Illustrations.StraightConnector"]=
!0,a["PptRibbon.InsertTab.Illustrations.StraightConnectorArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.StraightConnectorTwoArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.RightArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.DownArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.LeftArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.UpArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.UpDownArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.LeftRightArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.MoreShapes"]=
!0,a["PptRibbon.DrawingFormat.InsertShapes.TextBox"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Rectangle"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.RoundedRectangle"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Ellipse"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.RoundedRectangleCallout"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Star5"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Triangle"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Can"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Cube"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.StraightConnector"]=
!0,a["PptRibbon.DrawingFormat.InsertShapes.StraightConnectorArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.StraightConnectorTwoArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.RightArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.DownArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.LeftArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.UpArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.UpDownArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.LeftRightArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.MoreShapes"]=
!0,a["PptRibbon.DrawingFormat.InsertShapes.Duplicate"]=!0);this.la.Lpg||(a["PptRibbon.Home.Drawing.AllShapes"]=!0,a["PptRibbon.InsertTab.Illustrations.AllShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.AllShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.TextBoxBig"]=!0);this.la.kqe||(a["PptRibbon.InsertTab.InsertTables"]=!0);a["ContextualTabs.Tables.Design"]=!0;a["ContextualTabs.Tables.Design.TableStyleOptions"]=!0;a.buttonFirstRow=!0;a.buttonFirstColumn=!0;a.buttonLastRow=!0;a.buttonLastColumn=
!0;a.buttonBandedRow=!0;a.buttonBandedColumn=!0;a["ContextualTabs.Tables.Design.TableStyles"]=!0;a.buttonTableStyleRibbon0=!0;a.buttonTableStyleRibbon1=!0;a.buttonTableStyleRibbon2=!0;a.buttonTableStyleRibbon3=!0;a.buttonTableStyleRibbon4=!0;a.buttonTableStyleRibbon5=!0;a.buttonTableStyleRibbon6=!0;a.fsfaMoreTableStyles=!0;a.fsfaTableStyleTheme=!0;a["ContextualTabs.Tables.Design.Shading"]=!0;a.cellShadingColor=!0;a["ContextualTabs.Tables.Design.TableBorderStyle"]=!0;a["ContextualTabs.Tables.Design.DrawBorders"]=
!0;a.TableBorders=!0;a.TableBordersPenColor=!0;a.TableBorderPenWeight=!0;a["ContextualTabs.Tables.Layout"]=!0;a["ContextualTabs.Tables.Layout.Table"]=!0;a.idTableSelect=!0;a.btnSelectTable=!0;a.btnSelectColumn=!0;a.btnSelectRow=!0;a["ContextualTabs.Tables.Layout.RowColumn"]=!0;a.idTableDelete=!0;a.btnTableDelete=!0;a.btnColumnDelete=!0;a.btnRowDelete=!0;a["ContextualTabs.Tables.Layout.MergeSplit"]=!0;a.btnMergeTableCells=!0;a.btnSplitTableCells=!0;a.btnInsertRowAbove=!0;a.btnInsertRowBelow=!0;a.btnInsertColumnLeft=
!0;a.btnInsertColumnRight=!0;a.btnDistributeRows=!0;a.btnDistributeColumns=!0;a["ContextualTabs.Tables.Layout.Alignment"]=!0;a["ContextualTabs.Tables.Layout.Alignment.Controls"]=!0;a.btnTableCellLeftJustify=!0;a.btnTableCellCenterJustify=!0;a.btnTableCellRightJustify=!0;a.btnTableCellTopAnchoring=!0;a.btnTableCellMiddleAnchoring=!0;a.btnTableCellBottomAnchoring=!0;if(this.la.iqe){if(this.la.jqe||this.la.XBb||this.la.hqe)a["ContextualTabs.Tables.Layout"]=!1;this.la.hqe&&(a["ContextualTabs.Tables.Layout.Alignment"]=
!1,a["ContextualTabs.Tables.Layout.Alignment.Controls"]=!1,a.btnTableCellLeftJustify=!1,a.btnTableCellCenterJustify=!1,a.btnTableCellRightJustify=!1,a.btnTableCellTopAnchoring=!1,a.btnTableCellMiddleAnchoring=!1,a.btnTableCellBottomAnchoring=!1);a["ContextualTabs.Tables.Design"]=!1;this.la.jqe&&(a["ContextualTabs.Tables.Layout.Table"]=!1,a.idTableSelect=!1,a.btnSelectTable=!1,a.btnSelectColumn=!1,a.btnSelectRow=!1);this.la.XBb&&(a["ContextualTabs.Tables.Layout.RowColumn"]=!1,a.idTableDelete=!1,a.btnTableDelete=
!1,a.btnColumnDelete=!1,a.btnRowDelete=!1,a.btnInsertRowAbove=!1,a.btnInsertRowBelow=!1,a.btnInsertColumnLeft=!1,a.btnInsertColumnRight=!1);a["ContextualTabs.Tables.Design.Shading"]=!1;a.cellShadingColor=!1;a["ContextualTabs.Tables.Design.TableStyleOptions"]=!1;a.buttonFirstRow=!1;a.buttonFirstColumn=!1;a.buttonLastRow=!1;a.buttonLastColumn=!1;a.buttonBandedRow=!1;a.buttonBandedColumn=!1;a["ContextualTabs.Tables.Design.TableStyles"]=!1;a.buttonTableStyleRibbon0=!1;a.buttonTableStyleRibbon1=!1;a.buttonTableStyleRibbon2=
!1;a.buttonTableStyleRibbon3=!1;a.buttonTableStyleRibbon4=!1;a.buttonTableStyleRibbon5=!1;a.buttonTableStyleRibbon6=!1;a.fsfaMoreTableStyles=!1;this.la.Faa&&(a["ContextualTabs.Tables.Design.TableBorderStyle"]=!1,a.TableBorders=!1,this.la.uKb&&(a["ContextualTabs.Tables.Design.DrawBorders"]=!1,a.TableBorderPenWeight=!1),this.la.ejb&&(a["ContextualTabs.Tables.Design.DrawBorders"]=!1,a.TableBordersPenColor=!1));this.la.g3c&&(a["ContextualTabs.Tables.Layout.MergeSplit"]=!1,a.btnMergeTableCells=!1);this.la.mqe&&
(a["ContextualTabs.Tables.Layout.MergeSplit"]=!1,a.btnSplitTableCells=!1);this.la.Woc&&(a.btnDistributeRows=!1,a.btnDistributeColumns=!1)}this.la.powerPointFullTextJustifyIsEnabled||(a["PptRibbon.Home.Paragraph.FullJustify"]=!0);this.la.powerPointSmartLookupIsEnabled||(a["PptRibbon.Review.SmartLookup"]=!0,a["PptRibbon.Review.Show.SmartLookup"]=!0,a["PptRibbon.Review.ShowHide.SmartLookup"]=!0);this.la.powerPointFormatBackgroundEnabled||(a["PptRibbon.Design.Customize.FormatBackgroundAnchor"]=!0);a["PptRibbon.InsertTab.Symbols"]=
!this.la.ka("InsertSymbolIsEnabled");this.la.Kqg||(a["PptRibbon.Home.Font.Shrink"]=!0,a["PptRibbon.Home.Font.Grow"]=!0);this.la.Q0j||(a["PptRibbon.Home.Font.Strikethrough"]=!0);this.la.Ime||(a["PptRibbon.InsertTab.Images.Clipart"]=!0);this.cKh(a,!0,!0,!0);this.bKh(a,!0);this.la.pptInsertOnlineVideoEnabled||(a["PptRibbon.InsertTab.Media.OnlineVideo"]=!0);this.la.pptInsertOnlineVideoEnabled||(a["PptRibbon.InsertTab.Media"]=!0);this.la.ahh||(a["PptRibbon.AudioPlayback"]=!0);this.la.sKb||(a["PptRibbon.AudioFormat"]=
!0);if(w.AFrameworkApplication.ata||!this.la.pptEditInsertAppsForOfficeEnabled||this.la.oBb)a["PptRibbon.InsertTab.AppForOffice"]=!0,a["PptRibbon.InsertTab.InsertAddinTransitionEntry"]=!0;this.la.NAb||(a["PptRibbon.View.Zoom"]=!0);this.la.hZj||(a["PptRibbon.Home.Paragraph.LineSpacing"]=!0);this.la.Slg||(a["ContextualTabs.Tables.Layout.Properties"]=!0,a["PptRibbon.PictureFormat.Properties"]=!0,a["PptRibbon.DrawingFormat.Properties"]=!0,a["PptRibbon.SmartArt.Properties"]=!0,a["PptRibbon.AudioFormat.Properties"]=
!0);var b=[];this.la.WMa&&(b=this.la.WMa.split(","));for(const c of b){const f=c.trim().substring(0,1).toUpperCase()+c.trim().substring(1,c.length);a["Transition"+f]=!0}Array.contains(b,"Wipe")&&Array.contains(b,"Shape")&&Array.contains(b,"Split")&&Array.contains(b,"RandomBars")&&(a.TransitionMore=!0);this.la.dVd||(a.AnimationMore=!0);this.la.e5j?a["PptRibbon.Transition.AllSlides"]=!0:a["PptRibbon.Transition.Timing"]=!0;this.la.powerPointEnableAccCheck||(a["PptRibbon.Review"]=!0);this.la.yg&&(a["PptRibbon.View.PresentationViews"]=
!0);this.iUg?a["PptRibbon.Home.Clipboard.Paste"]=!0:a["PptRibbon.Home.Clipboard.NewPaste"]=!0;this.la.Ppg?a["PptRibbon.Design.OldThemes"]=!0:a["PptRibbon.Design.Themes"]=!0;a["PptRibbon.View.ShowHide.CommentsSplitButton"]=!0;this.la.pptEditorConsistencyCheckIsEnabled||(a["PptRibbon.Review.Proofing.EditorPane"]=!0);this.la.proofingSettingIsEnabled||(a["PptRibbon.Review.Proofing.GrammarOptions"]=!0);this.la.pptHideProofingErrorIsEnabled||(a["PptRibbon.Review.Proofing.HideProofingErrors"]=!0);this.la.Koe||
(a["PptRibbon.Review.Activity"]=!0);a["PptRibbon.Review.Proofing.EditorPane"]?a["PptRibbon.Review.Proofing.GrammarOptions"]?a["PptRibbon.Review.Proofing"]=!0:a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!0:a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!0;(b=this.la.ka("HelpTabIsEnabled")&&!w.AFrameworkApplication.BPb&&!w.AFrameworkApplication.ata)||(a["PptRibbon.Help"]=!0);a.btnContactSupport=!(b&&this.la.ka("HelpTabContactSupportIsEnabled"));a.btnShowTraining=!(b&&this.la.ka("HelpTabShowTrainingIsEnabled"));
a.btnWhatsNew=!(b&&this.la.ka("HelpTabWhatsNewIsEnabled"));a.btnFeedbackPane=!0;this.la.Gbb&&this.la.k_c&&this.la.k_c.length||(a.InsertIconDialog=!0);a["PptRibbon.View.Subtitles.UseSubtitles"]=!0;a["PptRibbon.View.Subtitles.SubtitleSettings"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide"]=!0;a["PptRibbon.View.Subtitles.PopulateTranscriptionSpokenLanguage"]=
!0;a["PptRibbon.View.Subtitles.PopulateTranscriptionSubtitleLanguage"]=!0;a.AlwaysUseSubtitles=!0;a.UseSubtitles=!0;a["PptRibbon.View.Coach"]=!0;a["PptRibbon.View.Coach.RehearseWithCoach"]=!0;a["PptRibbon.View.Coach.RehearseWithCoachSplit"]=!0;a["PptRibbon.View.Coach.RehearseWithCoachTopBar"]=!0;a["PptRibbon.View.Coach.Menu.Vision"]=!0;a["PptRibbon.View.Coach.Menu.FeedbackSettings"]=!0;a["PptRibbon.View.Coach.Menu"]=!0;a["PptRibbon.View.StartSlideShow.PresentLive"]=!0;a.PresentLive=!0;a.PresentLiveConsumer=
!0;a.PresentLiveEnterprise=!0;a.PresentLiveTopBar=!0;this.TDb&&(a["PptRibbon.Review.Comments.Markers"]=!0);this.la.ka("OcpsIsEnabled")&&(a.TellMeControl=!0);a["PptRibbon.Review.Translate"]=!this.la.Pfh;a["PptRibbon.Review.Activity.ShowVersionHistory"]=!this.la.dSk;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic"]=!this.la.DKa;a["PptRibbon.Graphics.ContextMenu.FlyChangeGraphic"]=!this.la.DKa;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture"]=!this.la.DKa;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture"]=
!this.la.DKa;a["PptRibbon.PictureFormat.Adjust.ChangePicture"]=this.la.DKa;a.FixIt=!this.la.ZSc}qpl(a){if(!this.la.ka("HelpTabIsEnabled")||w.AFrameworkApplication.BPb||w.AFrameworkApplication.ata)a.Help=!0;a.Draw=!this.la.yg}Qvj(){const a=new Na.a;if(this.la.WMa){var b=this.la.WMa.split(",");for(const c of b)b=c.trim(),"MenuSection"===b.substring(0,11)&&a.add(new mH("TransitionMore","Transition"+b,!0))}return a.toArray()}Lll(a){a["PptJewel.Menu"]=!0;this.la.ka("WheresSaveButtonBrsIsEnabled")||(a["PptJewel.SaveACopy.WheresTheSaveButton"]=
!0);this.la.printingEnabled||(a["PptJewel.Print"]=!0,a["PptJewel.SaveACopy"]=!0,a["PptJewel.DownloadAs"]=!0,a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0,a["PptJewel.DownloadAs.DownloadACopy"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0,a["PptJewel.DownloadAs.DownloadAsImages"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0);a["PptJewel.Print.PrintToPdf"]=!0;this.dbd&&this.dbd.Q6g||(a["PptJewel.About.TryOffice"]=!0);
this.yad&&this.yad.LAh||(a["PptJewel.About.TryMacOffice"]=!0);this.la.ka("DocumentNameInJewelInfoMenuIsEnabled")&&w.AFrameworkApplication.du.rx||(a.lblBreadcrumbDocName=!0);this.la.ka("HelpTabIsEnabled")&&!w.AFrameworkApplication.BPb&&(a["PptJewel.Help"]=!0)}WOh(a){delete a["PptJewel.Menu"];const b=this.la.Ha(w.AFrameworkApplication.wK);if(b&&"teams"===b.toLowerCase()){a["PptJewel.Share"]=!0;a["PptJewel.Share.Embed"]=!0;var c=this.la.ka("SaveACopyIsEnabledForUiHost");const f=this.la.ka("UiHostSupportsDocRebootFeatures");
c&&f||(a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0)}w.AFrameworkApplication.Axa||(a["PptJewel.New"]=!0);w.AFrameworkApplication.JTe||(a["PptJewel.Open"]=!0);w.AFrameworkApplication.iF||(a["PptJewel.Help.GiveFeedback"]=!0,a.btnFeedback=!0,a.btnFeedbackPane=!0);w.AFrameworkApplication.dKh&&(a["PptJewel.Info.OpenInClient"]=!0,a.btnOpenInClient=!0);w.AFrameworkApplication.C0a||(a["PptJewel.Share.ReplyWithChanges"]=!0);w.AFrameworkApplication.j7d||
w.AFrameworkApplication.Y9e||(a["PptJewel.Info.FileVersion"]=!0);w.AFrameworkApplication.OBb?(a["PptJewel.Info.FileVersion"]=!0,w.AFrameworkApplication.uk("Microsoft.Office.PPT.Server.Flighting.PPTOneDriveConsumerSharedVersionHistoryIsEnabled"),ka.ULS.sendTraceTag(512262734,832,15,"PPT external version history menu item for OneDriveConsummer trimmed.")):w.AFrameworkApplication.D3c()?this.la.POk?(a["PptJewel.Info.VersionHistory"]=!0,ka.ULS.sendTraceTag(512262732,832,15,"PPT shared version history menu item trimmed for internet explorer.")):
this.la.yUi?this.la.ka("IsAnonymousUserCheckSupportedForVH")&&this.la.ka("IsAnonymousUser")&&(a["PptJewel.Info.VersionHistory"]=!0,ka.ULS.sendTraceTag(512262731,832,15,"PPT shared version history menu item due to anonymous user.")):this.la.ka("IsAnonymousUser")&&(a["PptJewel.Info.VersionHistory"]=!0,ka.ULS.sendTraceTag(512262730,832,15,"PPT shared version history menu item due to anonymous user.")):(a["PptJewel.Info.VersionHistory"]=!0,ka.ULS.sendTraceTag(512262733,832,15,"PPT shared version history menu item trimmed."));
a["PptJewel.Info.OpenInClient"]&&a["PptJewel.Info.FileVersion"]&&a["PptJewel.Info.VersionHistory"]&&(a["PptJewel.Info"]=!0);w.AFrameworkApplication.mTa||(a["PptJewel.Share.ShareWithPeople"]=!0);if(w.AFrameworkApplication.fK||!w.AFrameworkApplication.W9e&&!w.AFrameworkApplication.Kzb&&!w.AFrameworkApplication.$6d)a["PptJewel.Share.Embed"]=!0;a["PptJewel.Share.ShareWithPeople"]&&a["PptJewel.Share.Embed"]&&a["PptJewel.Share.ReplyWithChanges"]&&(a["PptJewel.Share"]=!0);w.AFrameworkApplication.VIl&&(a["PptJewel.SaveACopy"]=
!0,a["PptJewel.DownloadAs"]=!0,a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0,a["PptJewel.DownloadAs.DownloadACopy"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0,a["PptJewel.DownloadAs.DownloadAsImages"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0);this.la.ka("DisablePrint")&&(a["PptJewel.Print"]=!0,a["PptJewel.SaveACopy"]=!0,a["PptJewel.DownloadAs"]=!0,a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=
!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0,a["PptJewel.DownloadAs.DownloadACopy"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0,a["PptJewel.DownloadAs.DownloadAsImages"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0);w.AFrameworkApplication.fK&&(a["PptJewel.Print"]=!0,a["PptJewel.Share"]=!0);this.la.ka("SaveACopyBrsIsEnabled")||(a["PptJewel.SaveACopy.SaveACopy"]=!0);this.la.ka("SaveAsToHostBrsIsEnabled")&&this.la.ka("UserCanWriteRelative")&&this.la.ka("SupportsEditing")||(a["PptJewel.SaveACopy.SaveAsToHost"]=
!0);this.la.ka("SaveToAnotherFolderBrsIsEnabled")&&this.la.ka("SupportsGetMoreInfoForPersonalStorage")||(a["PptJewel.SaveACopy.SaveToSharePoint"]=!0);a["PptJewel.SaveACopy.SaveAsToHost"]&&a["PptJewel.SaveACopy.SaveACopy"]&&a["PptJewel.SaveACopy.SaveToSharePoint"]&&(a["PptJewel.SaveACopy"]=!0);this.la.V0j||(a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0);this.la.Sqg&&this.la.yg||(a["PptJewel.DownloadAs.DownloadAsImages"]=!0);if(!this.la.ka("153")||".odp"===this.la.Ha("152").toLowerCase()||w.AFrameworkApplication.fK)a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=
!0;this.la.ka("RenameDialogIsEnabled")&&w.AFrameworkApplication.Tbc()&&!w.AFrameworkApplication.fK||(a["PptJewel.Rename"]=!0);w.AFrameworkApplication.orc||(a["PptJewel.Help.ReportAbuse"]=!0);c=!w.AFrameworkApplication.kgd||!this.la.ka("1072");w.AFrameworkApplication.privacyUrl||!c||w.AFrameworkApplication.zvc||this.dbd&&this.dbd.Q6g||this.yad&&this.yad.LAh||this.la.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")||(a["PptJewel.About"]=!0);w.AFrameworkApplication.privacyUrl||(a["PptJewel.About.Privacy"]=
!0);a["PptJewel.About.TrustCenter"]=c;w.AFrameworkApplication.zvc||(a["PptJewel.About.TermsOfUse"]=!0);this.la.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")||(a["PptJewel.About.DiagnosticsSection"]=!0);w.AFrameworkApplication.rea||(a["PptJewel.SecondaryMenu"]=!0);c=!this.la.ka("248");a["PptRibbon.Design.Designer.New"]=c;a["PptRibbon.Design.ShowHide.Designer.New"]=c;a["PptRibbon.Home.Designer"]=c;(a["PptRibbon.Home.ShowHide.Designer"]=c)&&this.Hh&&this.Hh.waa(this.Hh.v6,this.Hh.j3d);c=!this.la.ka("822");
a["PptRibbon.Review.SmartLookup"]=c;a["PptRibbon.Review.Show.SmartLookup"]=c;(c=(a["PptRibbon.Review.ShowHide.SmartLookup"]=c)||!Cv.Z1j())||ka.ULS.sendTraceTag(512262729,1303,15,"ReuseSlides is not trimmed");a["PptRibbon.Home.Slides.InvokeFilesSerplet"]=c;a["PptRibbon.InsertTab.InvokeFilesSerplet"]=c;ka.ULS.sendTraceTag(512262728,352,50,"IsInsertOnlinePictureFromHostSupported: {0}; InsertOnlinePictureFromHostEnabled: {1}; HostSupportsInsertOnlinePictureFromHost: {2}; IsSkyDrive: {3}; AppSupportsInsertOnlinePictureFromHost: {4}; AppSupportsInsertOnlinePictureFromSharePoint: {5}",
w.AFrameworkApplication.ibc(),w.AFrameworkApplication.insertOnlinePictureFromHostEnabled,w.AFrameworkApplication.lZc,w.AFrameworkApplication.OBb,w.AFrameworkApplication.bKc,w.AFrameworkApplication.W_b);this.la.ka("671")&&this.cKh(a,this.la.pptInsertOnlinePictureEnabled,w.AFrameworkApplication.ibc(),this.la.Gbb);this.bKh(a,this.la.q_c);this.la.ka("670")&&(c=!this.la.ka("124"),a["PptRibbon.InsertTab.Media.OnlineVideo"]=c,a["PptRibbon.InsertTab.Media"]=!!c);a["PptRibbon.Review.Proofing.EditorPane"]=
!this.la.ka("809");a["PptRibbon.Review.Proofing.GrammarOptions"]=!this.la.ka("299");a["PptRibbon.Review.Proofing.HideProofingErrors"]=!this.la.ka("619");a["PptRibbon.Review.Proofing.EditorPane"]?a["PptRibbon.Review.Proofing.GrammarOptions"]?(a["PptRibbon.Review.Proofing"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!0):(a["PptRibbon.Review.Proofing"]=!1,a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=
!1):(a["PptRibbon.Review.Proofing"]=!1,a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!1);c=this.la.ka("LiveSubtitlesEnabled");this.la.Tla&&c&&(a["PptRibbon.View.Subtitles.UseSubtitles"]=!1,eb.a("ReactMLRSubtitleSettingsTeamsFix")||(a["PptRibbon.View.Subtitles.SubtitleSettings"]=!1),a["PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay"]=!1,a["PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay"]=!1,a["PptRibbon.View.Subtitles.PopulateTranscriptionSpokenLanguage"]=
!1,a["PptRibbon.View.Subtitles.PopulateTranscriptionSubtitleLanguage"]=!1,a["PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide"]=!1,a["PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide"]=!1);this.la.Bcc&&this.la.hrg&&(a["PptRibbon.View.Coach"]=!1,a["PptRibbon.View.Coach.RehearseWithCoachTopBar"]=!1,this.la.pptRehearsalVisionEnabled||this.la.tKb?(a["PptRibbon.View.Coach.Menu"]=!1,a["PptRibbon.View.Coach.RehearseWithCoachSplit"]=!1,this.la.pptRehearsalVisionEnabled&&(a["PptRibbon.View.Coach.Menu.Vision"]=
!1),this.la.tKb&&(a["PptRibbon.View.Coach.Menu.FeedbackSettings"]=!1)):a["PptRibbon.View.Coach.RehearseWithCoach"]=!1);this.la.c5j&&this.la.Tla&&c&&(!b||"teams"!==b.toLowerCase())&&(a.AlwaysUseSubtitles=!1,a.UseSubtitles=!1,eb.a("ReactMLRSubtitleSettingsTeamsFix")&&(a["PptRibbon.View.Subtitles.SubtitleSettings"]=!1));this.la.powerPointLiveBroadcastEnabled&&(a["PptRibbon.View.StartSlideShow.PresentLive"]=!1,a.PresentLive=!1,a.PresentLiveTopBar=!1);this.la.ka("WacLabelingPoliciesIsEnabled")&&this.la.ka("WacApplyManualPolicyLabelIsEnabled")&&
this.la.pptLabelingGetPolicyLabelsIsEnabled&&this.la.pptApplyManualPolicyLabelIsEnabled&&this.la.ka("SupportsPolicies")||(a["PptRibbon.Home.Sensitivity"]=!0,a.flySensitivity=!0,this.Hh&&this.Hh.waa(this.Hh.v6,this.Hh.Cvh));this.la.dictationIsEnabled&&z.a.iGh&&this.la.ka("UserCanUseDictation")?(a["PptRibbon.Home.Dictation"]=!1,a.btnStartDictation=!1):this.Hh&&this.Hh.waa(this.Hh.v6,this.Hh.pTf);a["PptJewel.Open"]&&a["PptJewel.New"]&&(a["PptJewel.Home"]=!0);a["PptJewel.SaveACopy.SaveAsToHost"]&&a["PptJewel.SaveACopy.SaveACopy"]&&
a["PptJewel.SaveACopy.SaveToSharePoint"]&&a["PptJewel.Rename"]&&a["PptJewel.DownloadAs.DownloadACopy"]&&a["PptJewel.DownloadAs.DownloadACopyAsPdf"]&&a["PptJewel.DownloadAs.DownloadACopyAsOdp"]&&a["PptJewel.DownloadAs.DownloadAsImages"]?a["PptJewel.SaveACopy"]=!0:a["PptJewel.SaveACopy"]&&delete a["PptJewel.SaveACopy"];a["PptRibbon.Review.Translate"]=!this.la.Pfh;a.FixIt=!this.la.ZSc;this.la.Lu("IsPresentToTeamsSupportedHost")&&!this.la.ka("IsPresentToTeamsSupportedHost")?(a.PresentToTeams=!0,a.PresentToTeamsTopBar=
!0):b&&"sharepointcom"!==b&&(a.PresentToTeams=!0,a.PresentToTeamsTopBar=!0);this.la.ka("IsAnonymousUser")&&(a.CatchUpWithChanges=!0);Gp.dRl(Cv.hJj,a);if(w.AFrameworkApplication.ata||!this.la.pptEditInsertAppsForOfficeEnabled||this.la.oBb)a["PptJewel.Addin"]=!0}cKh(a,b,c,f){a["PptRibbon.InsertTab.Images.FlyPicture"]=!1;a["PptRibbon.InsertTab.Images.FlyPicture.FromHost"]=!c;a["PptRibbon.InsertTab.Images.FlyPicture.FromSearch"]=!b;a["PptRibbon.InsertTab.Images.FlyPicture.FromM365Picture"]=!f;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromDevice"]=
!1;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromHost"]=!c;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromSearch"]=!b;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromM365Picture"]=!f;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromM365Icon"]=!f;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromDevice"]=!1;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromHost"]=!c;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromSearch"]=!b;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Picture"]=
!f;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Icon"]=!f;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromDevice"]=!1;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromHost"]=!c;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromSearch"]=!b;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Picture"]=!f;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Icon"]=!f}bKh(a,b){a.InsertPictureFromMobileDevice=!b;a.ChangePictureFromMobileDevice=!b}static Z1j(){const a=
w.AFrameworkApplication.fa.Ha("SovereignEnvironmentName"),b=w.AFrameworkApplication.fa.ka("IsTellMeUpSellEnterpriseEnabled");var c=w.AFrameworkApplication.fa.Ha(w.AFrameworkApplication.wK);c=!!c&&"teams"===c.toLowerCase();return(!a||!a.length)&&b&&!c}}Cv.hJj={["ellipsisOpenInApp"]:(IB=new Na.a,IB.add("HostOpenInClient"),IB),["ellipsisOpenInBrowser"]:(HB=new Na.a,HB.add("HostOpenInBrowser"),HB),["ellipsisDownload"]:(GB=new Na.a,GB.add("HostDownload"),GB),["conversation"]:(FB=new Na.a,FB.add("HostConversation"),
FB),["close"]:(nx=new Na.a,nx.add("HostClose"),nx.add("btnjClose"),nx.add("msJewelSecondary"),nx),["copyLink"]:(EB=new Na.a,EB.add("CopyLink"),EB),["share"]:(Xy=new Na.a,Xy.add("jbtnFileSharing"),Xy.add("btnFileSharing"),Xy),["docChat"]:(DB=new Na.a,DB.add("DocChat"),DB),["openInApp"]:(CB=new Na.a,CB.add("btnOpenInClient"),CB)};Object(m.a)(Cv,"RibbonCommandTrimmer",null,[1211]);class JB{constructor(){this.nIa=this.ul=this.K=null}get name(){return"PowerPointWebEditor.Ribbon"}Yb(a){this.K=a;w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.StatusBarPRIEnabled",
!1)||a.register(rG.a,"PowerPointWebEditor.Ribbon.PPTWebEditReactCommandDefinitionMapping").as("Common.IExternalUICommandDefinitionMapping").ma().oa(()=>new rG.a(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.IAppSettingsManager")));a.register(1188,"PowerPointWebEditor.Ribbon.IPPTChromeExtensionHelper").ma().oa(()=>new qG(new iB(w.AFrameworkApplication.fa)));let b=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pBb;z.a.ik&&(b=b&&!this.K.resolve("PowerPointWebEditor.Ribbon.IPPTChromeExtensionHelper").lza);
var c=this.K.resolve("PowerPointWebEditor.IFileInfo").Kja;let f=2===c||3===c||0===c;c=1===c;const l=a.resolve("PowerPointWebEditor.IApplicationSettings").Fkb?a.resolve("PowerPointWebEditor.IPPTRumTracker"):null;f=f&&!c;a.register(Cv,"PowerPointWebEditor.Ribbon.RibbonCommandTrimmer").ma().oa(()=>new Cv(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.IOfficeTrialExperience"),a.resolve("Common.IMacOfficeOffer"),b,f,l));a.register(1189,"PowerPointWebEditor.IModeSwitcherControlActor").ma().oa(()=>
new iG(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("Box4.IAppFrame"),Pd.a.get_instance(),l));a.register(1190,"PowerPointWebEditor.IRibbonUser").ma().oa(()=>{const y=a.resolve("PowerPointWebEditor.IApplicationSettings"),H=a.resolve("PowerPointWebEditor.Ribbon.RibbonCommandTrimmer");var Q={};H.Zsd(Q);var ia={};H.qpl(ia);Q=
new eG(Q,H.Qvj(),ia);ia=new hG;const wa=a.resolve("Common.IAppSettingsManager"),Ua=new kH(a.resolve("PowerPointWebEditor.AppFrame"),a.resolve("PowerPointWebEditor.IRibbonPane").va,a.resolve("PowerPoint.IPathManager"),a.Ia("Box4.IGeneralCuiUser"),a.resolve("Common.IFocusManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.IExternalUICommandDefinitionMapping"),a.qb("PowerPointWebEditor.Core.IBundleMetricRecorder"),H,Q,y,a.resolve("PowerPointWebEditor.IModeSwitcherControlActor"),ia,
l,wa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InvokeFullAppSettingsCallbackImmediately",!1),Object(Wa.a)(108,wa)?wa:null,wa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1),w.AFrameworkApplication.PJb,a.resolve("PowerPointWebEditor.IPresentationResourcesManager"));y.eSf?this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").tAb(()=>{Ua.Sjg()}):Ua.Sjg();return Ua});a.register(1191,"Common.IRibbonExternal").ma().oa(()=>a.resolve("PowerPointWebEditor.IRibbonUser").Rcl);
a.register(1192,"PowerPointWebEditor.IRibbonChangeManager").ma().oa(()=>new lH(a.resolve("Common.ITaskManager"),a.resolve("Box4.Graph.IGraphInstance").yd(10),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IRibbonUser"),a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled));a.register(kB,"PowerPointWebEditor.BusinessBarController").as("PowerPointWebEditor.IBusinessBarController").as("Box4.IBusinessBarController").ma().oa(()=>
new kB(a.resolve("CommonUI.IBusinessBar"),new fG,a.resolve("PowerPointWebEditor.AppFrame"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IErrorMapping"),w.AFrameworkApplication.fa,a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.PresentationContext")));a.register(1193,"PowerPointWebEditor.IBusinessBarPane").ma().oa(()=>new kG(a.Ia("CommonUI.IBusinessBar"),a.resolve("PowerPointWebEditor.IApplicationSettings").uqc));
a.register(Aq,"CommonUI.BusinessBar").as("CommonUI.IBusinessBar").ma().oa(()=>new Aq(a.resolve("PowerPointWebEditor.IBusinessBarPane").xVl));a.register(1194,"Common.IRibbonSQMInformation").ma().oa(()=>{const y=new sG(w.AFrameworkApplication.Ra);y.v4k();return y});a.register(1195,"PowerPointWebEditor.IInkRibbonManager").ma().oa(()=>{const y=a.resolve("PowerPointWebEditor.IApplicationSettings");return new bp(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.View.IViewEventHandlers"),
a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),w.AFrameworkApplication.Aa.ob.zea,y)})}init(){this.nIa=this.K.resolve("PowerPointWebEditor.IModeSwitcherControlActor");this.K.resolve("PowerPointWebEditor.BusinessBarController").fOk();this.ul=this.K.resolve("PowerPointWebEditor.IBusinessBarController");this.ul.initialize();w.AFrameworkApplication.fa.ka("EarlyInitRibbonUser")?(this.K.resolve("PowerPointWebEditor.IRibbonUser"),this.K.resolve("Common.IRibbonExternal")):this.K.Ia("PowerPointWebEditor.IRibbonUser").execute(()=>
{this.K.resolve("Common.IRibbonExternal")});const a=this.K.resolve("PowerPointWebEditor.IBusinessBarPane"),b=this.K.resolve("PowerPointWebEditor.IPaneManager");var c=document.getElementById("WACDocumentAndTaskPanel");this.K.resolve("PowerPointWebEditor.IApplicationSettings").Iqc?(c=document.getElementById("BusinessBarRegion"),b.CQa(a,c,null)):c?b.CQa(a,this.K.resolve("PowerPointWebEditor.AppFrame").q2,c):b.YZ(a);this.K.resolve("CommonUI.IBusinessBar");this.K.resolve("PowerPointWebEditor.IInkRibbonManager")}dispose(){this.ul&&
this.ul.dispose();this.nIa&&this.nIa.dispose()}static main(){n.a.instance.Ac(new JB)}}Object(m.a)(JB,"PPTWebEditorRibbonPackage",null,[2,3]);var ox=d(682);class nH{get name(){return"Box4.Insights"}init(){}dispose(){}Yb(a){a.register(ox.a,"Box4.Insights.Box4InsightsSelection").as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").ma().oa(()=>new ox.a)}}Object(m.a)(nH,"Box4InsightsPackage",null,[2,3]);class KB{constructor(a,b){this.AKd=0;this.xia=new Na.a;this.Ca=a;
this.qd=b}get Xc(){return this.qd}get the(){return 0<this.AKd}b6(a){this.Spg(a)&&this.AKd++;this.the?this.Xc.enabled=!1:this.xia.add(this.Xc.Zp(a.actionId))}a6(a){!this.the&&0<this.xia.count&&(this.xia.ga(this.xia.count-1),this.NWf(this.xia.count-1));this.Spg(a)&&this.AKd--;this.the||(this.Xc.enabled=!0)}NWf(a){if(0<this.xia.count&&0<=a&&a<this.xia.count){const b=this.xia.ga(a);this.xia.removeAt(a);b.end()}}$Bi(){let a=this.xia.count-1;for(;0<=a;){var b=this.xia.ga(a);(b=this.Ca.GT(b.activityName))&&
b.flags[128]&&this.NWf(a);a--}}Spg(a){if(2!==a.behavior)return!0;a=this.Ca.GT(a.actionId);return!!a&&a.flags[32]}}Object(m.a)(KB,"ActivityActionListener",null,[143]);var Yy;(function(a){a[a.timeOut=0]="timeOut";a[a.appClose=1]="appClose";a[a.appError=2]="appError"})(Yy||(Yy={}));Object(m.b)("ActivityAutoEndReason",Yy);class LB{constructor(a){this.Sia=new ul.a;this.bSb=a}uoi(){for(let a of this.Sia.keys)this.voi(a)}a2f(a){if(this.bSb.CKc)for(let b of this.Sia.keys){const c=Array.clone(this.Sia.ga(b));
for(let f=0;f<c.length;f++){const l=c[f];l.r8d();this.Klh(b,a,l.uniqueID)}}}voi(a){var b=this.Sia.ga(a);b=this.Okj(b);for(let c=0;c<b.length;c++){const f=b[c];f.r8d();this.Klh(a,0,f.uniqueID)}}Okj(a){const b=[];for(let c=0;c<a.length;c++){const f=a[c];(new Date).getTime()-f.startTime>f.d3g&&Array.add(b,f)}return b}Klh(a,b,c){const f={};f.AID=c;f.A=a;f.AE=Yy[b];mc.a.instance.Xb("AutoEnded",f)}hql(){if(this.bSb.CKc){var a=new dd.a(2,2,this.bSb.woi,Object(I.a)(this,this.uoi,"autoEndLongRunningActivities"),
67);w.AFrameworkApplication.Ae.Hb(a)}}register(a){if(this.bSb.CKc){var b=a.activityName;this.Sia.Fb(b)&&this.Sia.ga(b)||this.Sia.$(b,[]);Array.add(this.Sia.ga(b),a)}}unregister(a){if(this.bSb.CKc){var b=a.activityName;this.Sia.Fb(b)&&this.Sia.ga(b)&&Array.remove(this.Sia.ga(b),a)}}}Object(m.a)(LB,"ActivityAutoEndHelper",null,[1340]);class hu{constructor(a){this.Xaf=null;this.wDc=0;this.jEd=this.KG=!1;this.JQd=0;this.ey=new Uc.a;this.txb=new Uc.a;this.ATh=a}get ORd(){return this.Xaf||(this.Xaf=this.ATh())}get properties(){return this.ey}get d3g(){return this.wDc}get enabled(){return this.KG}get ended(){return this.jEd}get uniqueID(){return this.JQd}x2g(){const a=
{};a.ID=this.uniqueID;a.A=this.activityName;a.ST=this.startTime;a.ET=this.endTime;Ia.Ct(this.properties.keys)&&(a.P=hu.N$f(this.properties));Ia.Ct(this.txb.keys)&&(a.FP=hu.N$f(this.txb));return a}static N$f(a){const b={};for(let c of a)b[c.key]=c.value;return b}}Object(m.a)(hu,"AActivity",null,[1394,720]);class MB extends hu{constructor(a,b,c,f,l,y,H,Q){super(H);this.Pt=0;this.CTh=a;this.bYh=b;this.zha=c;this.Kj=(new Date).getTime();this.R2h=f;this.tAd=y;this.wDc=l;this.tAd.register(this);this.JQd=
Q()}get activityName(){return this.zha}get startTime(){return this.Kj}get endTime(){return this.Pt}XWf(a){this.Pt=(new Date).getTime();this.ended?this.a1k():(this.jEd=!0,this.Pt=(new Date).getTime(),this.Pt<this.Kj&&(ka.ULS.sendTraceTag(8184544,213,50,String.format("EndTime ({0}) is less than StartTime ({1}) for Activity ({2}).",this.Pt,this.Kj,this.zha)),this.Pt=this.Kj),this.tAd.unregister(this),this.R2h&&(!a&&this.ORd&&this.ORd.enabled?this.Isb():this.w2b()))}end(){this.XWf(!1)}r8d(){this.XWf(!0)}a1k(){const a=
{};a.AN=this.activityName;a.AT=(new Date).getTime();a.AID=this.uniqueID;this.bYh("AlreadyEnded",this.endTime,a)}Isb(){this.ORd.Isb()}w2b(){this.CTh(this.x2g())}cancel(){this.ended||(this.jEd=!0,this.tAd.unregister(this))}}Object(m.a)(MB,"ActivityImpl",hu,[]);class oH extends Sys.EventArgs{constructor(){super();this.name=this.properties=null}}Object(m.a)(oH,"ActivityRecordedEventArgs",Sys.EventArgs,[]);class iu{constructor(a,b,c){this.Ma=new Pc.a;this.KG=!0;this.settings=a;this.uAd=b;this.yAd=c}get enabled(){return this.KG&&
this.settings.enabled}set enabled(a){this.KG=a}Zp(a,b=-1){-1===b&&(b=this.settings.FRi);return this.uAd(Object(I.a)(this,this.w2b,"completeActivity"),Object(I.a)(this,this.Llh,"recordEventInternal"),a,this.$Rj(a.toString()),b)}Xb(a,b=null){this.Llh(a,(new Date).getTime(),b);this.Ma.raiseEvent("HHR",Object.assign(new oH,{name:a,properties:b}))}Llh(a,b,c){this.Rng(a)&&(a=this.Mag(a,c,b),ka.ULS.sendTraceTag(6068304,213,100,a))}Koa(a,b=null){this.Rng(a.toString())&&(a=this.Mag(a.toString(),b,(new Date).getTime()),
ka.ULS.sendTraceTag(6415520,213,100,a))}$Rj(a){return this.enabled&&!this.aSj(a)}Rng(a){return this.enabled&&!this.qWj(a)}aSj(a){return this.settings.MUi.contains(a)}qWj(a){return this.settings.NUi.contains(a)}w2b(a){if(this.yAd.ZHf(a.A.toString())){var b=[];Array.add(b,a);a=De.c(b);ka.ULS.sendTraceTag(5894867,213,100,a)}}Mag(a,b,c){const f={};f.ID=iu.Y8d();f.V=a;f.VT=c;b&&(f.P=b);a=[];Array.add(a,f);return De.c(a)}static Y8d(){return iu.V9h++}}iu.V9h=0;Object(m.a)(iu,"ActivityManagerImpl",null,[657]);
class dp{constructor(){this.KG=!1;this.aef=this.Ibf=0;this.Hbf=!1;this.Gef=new So.a;this.Hef=new So.a}K5b(a){this.KG=Boolean.parse(a[dp.kWj]||"false");this.Gef=this.peh(a[dp.LUi]);this.Hef=this.peh(a[dp.OUi]);this.w1i(a)}get enabled(){return this.KG}get MUi(){return this.Gef}get NUi(){return this.Hef}w1i(a){this.Hbf=Boolean.parse(a[dp.aTj]||"false");this.Ibf=parseInt(a[dp.xoi]||"60000");this.aef=parseInt(a[dp.GRi]||"5000")}get woi(){return this.Ibf}get FRi(){return this.aef}get CKc(){return this.Hbf}peh(a){const b=
new So.a;for(const c of(a||"").split(","))""!==c&&b.add(c);return b}}dp.kWj="ActivityLoggingIsEnabled";dp.LUi="DisabledClientActivityNames";dp.OUi="DisabledClientActivityEventNames";dp.aTj="ActivityAutoEndEnabled";dp.xoi="ActivityAutoEndTaskInterval";dp.GRi="ActivityDefaultMaxDuration";Object(m.a)(dp,"ActivitySettings",null,[1339]);class Dv{constructor(a){this.HDd=new So.a;this.iYb=new Uc.a;this.nHc=a;this.iql()}iql(){this.nHc.enabled&&(Dv.suf=new dd.a(2,2,this.nHc.interval,Object(I.a)(this,this.$Vi,
"doThrottle"),65),w.AFrameworkApplication.Ae.Hb(Dv.suf))}$Vi(){this.hbl()}hbl(){this.iYb=new Uc.a;this.HDd=new So.a}bSj(a){return this.HDd.contains(a)}kJl(a){if(this.iYb.Fb(a)){if(this.iYb.ga(a)>=this.nHc.Juk)return this.HDd.add(a),ka.ULS.sendTraceTag(7696902,213,50,"Activity {0} will be throttled due to too much logging.",a),!1;let b;(b=this.iYb).$(a,b.ga(a)+1)}else this.iYb.add(a,1);return!0}ZHf(a){return this.nHc.enabled?!this.bSj(a)&&this.kJl(a):!0}}Dv.suf=null;Object(m.a)(Dv,"ActivityThrottler",
null,[1267]);class ds{constructor(){this.KG=!1;this.Uif=this.bnf=0}K5b(a){this.KG=Boolean.parse(a[ds.b5d]||"false");this.bnf=parseInt(a[ds.Kuk]||"600");this.Uif=parseInt(a[ds.QQj]||"600000")}get enabled(){return this.KG}get Juk(){return this.bnf}get interval(){return this.Uif}}ds.b5d="ActivityThrottlerEnabled";ds.Kuk="ActivityThrottlerMaxActivities";ds.QQj="ActivityThrottlerInterval";Object(m.a)(ds,"ActivityThrottlerSettings",null,[1266]);class NB{constructor(){this.Da=null}get name(){return"Common.App.Activities"}init(){this.sNj()}sNj(){const a=
this.Da.resolve("Common.App.Activities.IActivitySettings"),b=w.AFrameworkApplication.fa.appSettings;a.K5b(b);this.Da.resolve("Common.App.Activities.IActivityThrottlerSettings").K5b(b);if(a.enabled){mc.a.instance=new iu(this.Da.resolve("Common.App.Activities.IActivitySettings"),(l,y,H,Q,ia)=>new MB(l,y,H,Q,ia,this.Da.resolve("Common.App.Activities.IActivityAutoEndHelper"),()=>this.Da.qb("Common.App.Activities.IActivityAggregationManager"),iu.Y8d),this.Da.resolve("Common.App.Activities.IActivityThrottler"));
var c=this.Da.resolve("Common.App.Activities.ActivityAutoEndHelper"),f=this.Da.resolve("Common.App.Activities.ActivityActionListener");c.hql();w.AFrameworkApplication.Wga(()=>{f.$Bi();c.a2f(1)});w.AFrameworkApplication.Ra.Kaa(f);w.AFrameworkApplication.ZIc((l,y)=>{mc.a.instance.Koa(y.errorCode,{["ErrorCause"]:y.O5d,["ErrorResolution"]:y.P5d});c.a2f(2)})}}dispose(){}Yb(a){this.Da=a;a.register(dp,"Common.App.Activities.ActivitySettings").as("Common.App.Activities.IActivitySettings").ma();a.register(LB,
"Common.App.Activities.ActivityAutoEndHelper").as("Common.App.Activities.IActivityAutoEndHelper").ma().oa(()=>new LB(a.resolve("Common.App.Activities.IActivitySettings")));a.register(KB,"Common.App.Activities.ActivityActionListener").oa(()=>new KB(w.AFrameworkApplication.Ra,a.resolve("Common.IActivityManager")));a.register(ds,"Common.App.Activities.ActivityThrottlerSettings").as("Common.App.Activities.IActivityThrottlerSettings").ma().oa(()=>new ds);a.register(Dv,"Common.App.Activities.ActivityThrottler").as("Common.App.Activities.IActivityThrottler").ma().oa(()=>
new Dv(a.resolve("Common.App.Activities.IActivityThrottlerSettings")))}static main(){n.a.instance.Ac(new NB)}}Object(m.a)(NB,"ActivitiesPackage",null,[2,3]);class pH{constructor(){this.jqa=new Uc.a}rZe(a,b){this.jqa.$(a,b)}h9d(a){({value:a}=this.jqa.wg(a));return a}}Object(m.a)(pH,"AggregationMethodsForActivityName",null,[]);class OB{constructor(){this.ZEc=new ul.a;this.jqa=new ul.a}rZe(a,b,c){this.jqa.Fb(a)&&this.jqa.ga(a)||this.jqa.$(a,new pH);this.jqa.ga(a).rZe(b,c)}h9d(a,b){return this.jqa.Fb(a)&&
this.jqa.ga(a)?this.jqa.ga(a).h9d(b):null}X7b(a){this.ZEc.Fb(a)&&this.ZEc.ga(a)||this.ZEc.$(a,new So.a);return this.ZEc.ga(a)}eRi(a,b){this.X7b(a).add(b)}}Object(m.a)(OB,"ActivityAggregationInfo",null,[1346]);class px extends hu{constructor(a,b){super(a);this.JQd=(this.BTh=b)?b.xhj():iu.Y8d()}get Yia(){return this.BTh}get activityName(){return this.Yia.name}get startTime(){return this.Yia.startTime}get endTime(){return this.Yia.endTime}end(){}cancel(){}r8d(){}sOl(){this.txb.$("AM",this.Yia.mode.toString());
this.txb.$("C",this.Yia.count.toString());this.txb.$("DA",this.Yia.zVf.toFixed(2));this.txb.$("DV",this.Yia.hXi.toFixed(2))}ece(a){return this.Yia.ece(a)}Ece(){return this.Yia.Ece()}Isb(){for(let a of this.Yia.Zia)a.Isb()}}Object(m.a)(px,"AggregatedActivity",hu,[]);class qH{constructor(a,b){this.MAd=0;this.zha=a;this.yAa=b}nki(a,b){this.MAd=b;for(b=0;b<a.count;b++){const c=a.ga(b);this.oki(c)}}oki(a){const b=Object(qa.a)(px,a);if(b)if(1===this.MAd)this.kki(b);else if(2===this.MAd){this.pki(b);for(let c of this.yAa.X7b(this.zha)){const f=
b.Yia.Zia.ga(0);f.properties.Fb(c)&&a.properties.$(c,f.properties.ga(c))}}}kki(a){for(let b of this.yAa.X7b(this.zha))this.Rsh(a,b)}pki(a){for(let b of a.Ece())this.Rsh(a,b)}Rsh(a,b){const c=this.yAa.h9d(this.zha,b);if(c){const f=a.ece(b);a.properties.$(b,c(f))}}}Object(m.a)(qH,"PropertyAggregationHelper",null,[]);class PB{constructor(a,b,c,f,l){this.gob=a;this.yAa=b;this.sdf=l;this.yAd=f;this.w1h=c}get Gwf(){return this.w1h.value}w2b(a){if(Object(Wa.a)(MB,a))a.w2b();else if(Object(Wa.a)(px,a)&&this.yAd.ZHf(a.activityName.toString())){a=
Object(qa.a)(px,a);a.sOl();a=a.x2g();var b=[];Array.add(b,a);a=De.c(b);ka.ULS.sendTraceTag(6907266,213,50,a)}}I_b(a,b){const c=(new Date).getTime();var f=this.sdf.list.ga(a);const l=({qki:f}=this.Y$i(f)).returnValue;this.sdf.list.$(a,new Na.a);b&&(f=this.$Ii(f,c,this.gob.Xdg));0<f.count&&(new qH(a,this.yAa)).nki(f,l)}$Ii(a,b,c){const f=new Na.a;for(let l=0;l<a.count;l++){const y=a.ga(l);y.startTime>b-c?y.Isb():f.add(y)}return f}Y$i(a){const b=this.Gwf.JIh(a);a=this.Gwf.eGl(a);const c=this.rki(b,a);
return{returnValue:c,qki:1===c?b:a}}rki(a,b){return a.count*this.gob.m4g<b.count?1:2}get enabled(){return this.gob.enabled}Isb(){}}Object(m.a)(PB,"ActivityAggregationManager",null,[1345]);class Ho{constructor(a){this.enabled=!1;this.k3g=500;this.T3g=2;this.Wvd=6E4;this.m4g=5;this.Xdg=3E4;this.K5b(a.appSettings)}K5b(a){this.enabled=Boolean.parse(a[Ho.b5d]||"false");this.k3g=parseInt(a[Ho.Zuk]||"500");this.T3g=parseInt(a[Ho.jwk]||"2");this.Wvd=parseInt(a[Ho.uEl]||"60000");this.m4g=parseInt(a[Ho.xwk]||
"5");this.Xdg=parseInt(a[Ho.ryj]||"30000")}}Ho.b5d="ActivityAggregationEnabled";Ho.Zuk="ActivityAggregationMaxInterval";Ho.jwk="ActivityAggregationMinChain";Ho.uEl="ActivityAggregationTaskInterval";Ho.xwk="ActivityAggregationModeFactor";Ho.ryj="ActivityAggregationGraceWindow";Object(m.a)(Ho,"ActivityAggregationParams",null,[]);class QB{constructor(a,b){this.yAa=a;this.Yaf=b}JIh(a,b=1){if(!a||!a.count)return a;const c=new Na.a;var f=null;for(let l=0;l<a.count;l++){const y=a.ga(l);if(!y)continue;const H=
y.activityName;f?f.l6j(y)?f.add(y):(f=f.process(),c.addRange(f),f=this.Yaf(H,b),f.add(y)):(f=this.Yaf(H,b),f.add(y))}f&&(a=f.process(),c.addRange(a));return c}eGl(a){if(!a||!a.count)return a;const b={};var c=null;for(let l=0;l<a.count;l++){const y=a.ga(l);if(y){if(!c){c=new Na.a;var f=this.yAa.X7b(y.activityName);for(let H of f)c.add(H)}f=this.Goj(y,c);null!==f&&(f in b&&b[f]||(b[f]=new Na.a),b[f].add(y))}}a=new Na.a;for(const l of ta.a.EL(b))c=this.JIh(b[l],2),a.addRange(c);return a}Goj(a,b){let c=
"";for(let f of b)c+=f,c=a.properties.Fb(f)&&void 0!==a.properties.ga(f)&&null!==a.properties.ga(f)?c+a.properties.ga(f):c+"null";return c}}Object(m.a)(QB,"ActivityAggregationSchemes",null,[1344]);class rH{constructor(a,b,c,f,l){this.Pt=this.Kj=0;this.gob=c;this.uAd=f;this.yAa=l;this.name=a;this.ez=b;this.Zia=new Na.a}get mode(){return this.ez}get count(){return this.Zia.count}get startTime(){return this.Kj}get endTime(){return this.Pt}get zVf(){if(!this.count)return 0;let a=0;for(let b of this.Zia)a+=
b.endTime-b.startTime;return a/this.count}get hXi(){if(!this.count)return 0;let a=0;const b=this.zVf;for(let c of this.Zia){const f=c.endTime-c.startTime;a+=(f-b)*(f-b)}return a/this.count}add(a){this.count?this.Pt=a.endTime>this.endTime?a.endTime:this.endTime:(this.Kj=a.startTime,this.Pt=a.endTime);this.Zia.add(a)}l6j(a){return 0>=this.count?!1:a.startTime-this.endTime<=this.gob.k3g}process(){if(this.count>=this.gob.T3g){const a=new Na.a,b=this.uAd(this);a.add(b);return a}return this.Zia}ece(a){const b=
new Na.a;for(let c of this.Zia)if(c.properties.Fb(a)){const f=c.properties.ga(a);b.add(f)}else b.add(null);return b}Ece(){const a=this.yAa.X7b(this.name),b=new So.a;for(let c of this.daj())a.contains(c)||b.add(c);return b}daj(){const a=new So.a;if(!this.Zia)return a;for(let b of this.Zia)for(let c of b.properties.keys)a.add(c);return a}xhj(){return this.Zia.ga(0).uniqueID}}Object(m.a)(rH,"ActivityCollection",null,[1343]);class RB{constructor(){this.S3a=new ul.a}get list(){return this.S3a}add(a){const b=
a.activityName;if(this.S3a.Fb(b)&&this.S3a.ga(b)){const c=this.Tij(this.S3a.ga(b),a);this.S3a.ga(b).insert(c,a)}else this.S3a.$(b,new Na.a),this.S3a.ga(b).add(a)}Tij(a,b){for(let c=a.count-1;0<=c;c--)if(b.startTime>a.ga(c).startTime)return c+1;return 0}}Object(m.a)(RB,"CompletedActivitiesHelper",null,[1342]);class SB{constructor(){this.Da=null}get name(){return"Common.App.ActivityAggregator"}init(){w.AFrameworkApplication.Wga(()=>{this.Da.resolve("Common.App.ActivityAggregator.ActivityAggregationManager")})}dispose(){}Yb(a){this.Da=
a;const b=f=>new px(()=>a.qb("Common.App.Activities.IActivityAggregationManager"),f),c=(f,l)=>new rH(f,l,a.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),b,a.resolve("Common.IActivityAggregationInfo"));a.register(PB,"Common.App.ActivityAggregator.ActivityAggregationManager").as("Common.App.Activities.IActivityAggregationManager").ma().oa(()=>new PB(a.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),a.resolve("Common.IActivityAggregationInfo"),a.oe("Common.App.ActivityAggregator.IActivityAggregationSchemes"),
a.resolve("Common.App.Activities.IActivityThrottler"),a.resolve("Common.App.ActivityAggregator.CompletedActivitiesHelper")));a.register(Ho,"Common.App.ActivityAggregator.ActivityAggregationParams").ma().oa(()=>new Ho(w.AFrameworkApplication.fa));a.register(OB,"Common.App.ActivityAggregator.ActivityAggregationInfo").as("Common.IActivityAggregationInfo").ma().oa(()=>new OB);a.register(QB,"Common.App.ActivityAggregator.ActivityAggregationSchemes").as("Common.App.ActivityAggregator.IActivityAggregationSchemes").ma().oa(()=>
new QB(a.resolve("Common.IActivityAggregationInfo"),c));a.register(RB,"Common.App.ActivityAggregator.CompletedActivitiesHelper").ma().oa(()=>new RB)}static main(){n.a.instance.Ac(new SB)}}Object(m.a)(SB,"ActivityAggregatorPackage",null,[2,3]);var sH=d(16);class nr{constructor(){this.adl="getAddinShortcutsPreference";this.bdl="saveAddinShortcutsPreference";this.cdl="{0}RoamingServiceHandler.ashx?action={1}&{2}";this.R$i=6E4;this.dhd=this.F8=this.XY=null}lag(a){return String.format(this.cdl,w.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||
"",a,w.AFrameworkApplication.gh)}executeRequest(a,b,c,f,l=null){return nr.ada.Csb(a,b,l,null,2,c,f,!1,null,this.R$i)}saveSetting(a,b,c,f,l){return this.Zth(a,b,c,null,f,l)}startBatchUpdateScope(){this.dhd=[]}saveShortcutInfoArrayBatch(a,b,c){this.Xel(c,a,b)}Xel(a,b,c){const f={action:"",addinId:"",ownerType:0};f.timestamp=(new Date).toUTCString();const l=this.getShortcutInfoArray(b.toString(),c.toString());a?(f.shortcutInfoArray=a,this.$Rd(b,c,a)):l&&(f.shortcutInfoArray=l);a={};a[b.toString()]=f;
b=new sH.a(c.toString(),a);this.dhd.push(b)}commitBatchUpdateScope(){return this.Vtc()?this.Zel().then(()=>{this.Vtb();return Promise.resolve(!0)}):this.afl().then(()=>{this.Vtb();return Promise.resolve(!0)})}Zel(){return this.getSetting().then(a=>{let b=null;if(a&&!({Nu:b}=De.d(a)).returnValue)return ka.ULS.sendTraceTag(522739852,0,10,"SaveSettingToLocalStorageBatch failed due to failed to deserialize the settings"),Promise.resolve(!1);b||(b={});for(const c of this.dhd){(a=b[c.key])||(a={});const f=
c.value;for(const l of ta.a.EL(f))a[l]=f[l];b[c.key]=a}this.XY=b;try{return localStorage.setItem("AddinShortcutPreferenceData",De.c(b)),Promise.resolve(!0)}catch(c){return ka.ULS.sendTraceTag(522739853,0,10,"SaveSettingToLocalStorageBatch failed",c),Promise.resolve(!1)}})}afl(){return this.kil().then(a=>this.Mqd(a))}kil(){return this.Kce().then(a=>{let b=null;a&&(({Nu:b}=De.d(a)).returnValue||ka.ULS.sendTraceTag(522739854,0,10,"SerializeNewSettingWithSavedRoamingSettingsBatch failed due to failed to deserialize the settings"));
b||(b={});for(const c of this.dhd){(a=b[c.key])||(a={});const f=c.value;for(const l of ta.a.EL(f))a[l]=f[l];b[c.key]=a}this.XY=b;return De.c(b)})}saveShortcutInfoArray(a,b,c){return this.Zth(0,"","",c,a,b)}Zth(a,b,c,f,l,y){const H=this.Vtc(),Q={};Q.action=c;Q.addinId=b;Q.ownerType=a;Q.timestamp=(new Date).toUTCString();b=this.getShortcutInfoArray(l.toString(),y.toString());0===a&&f?(Q.shortcutInfoArray=f,this.$Rd(l,y,f)):b&&(Q.shortcutInfoArray=b);a={};a[l.toString()]=Q;l=new sH.a(y.toString(),a);
return H?this.Yel(l):this.$el(l)}Yel(a){return this.getSetting().then(b=>{let c=null;if(b&&!({Nu:c}=De.d(b)).returnValue)return ka.ULS.sendTraceTag(522739855,0,10,"SaveSettingToLocalStorage failed due to failed to deserialize the settings"),Promise.resolve(!1);c||(c={});c[a.key]=a.value;this.XY=c;try{return localStorage.setItem("AddinShortcutPreferenceData",De.c(c)),Promise.resolve(!0)}catch(f){return ka.ULS.sendTraceTag(522739856,0,10,"SaveSettingToLocalStorage failed",f),Promise.resolve(!1)}})}$el(a){return this.jil(a).then(b=>
this.Mqd(b))}jil(a){return this.Kce().then(b=>{let c=null;b&&(({Nu:c}=De.d(b)).returnValue||ka.ULS.sendTraceTag(522739857,0,10,"SerializeNewSettingWithSavedRoamingSettings failed due to failed to deserialize the settings"));c||(c={});c[a.key]=a.value;this.XY=c;return De.c(c)})}saveSettings(a){this.XY=De.a(a);this.Vtb();return this.Vtc()?this.$th(a):this.Mqd(a)}$th(a){try{return localStorage.setItem("AddinShortcutPreferenceData",a),Promise.resolve(!0)}catch(b){return ka.ULS.sendTraceTag(522739858,
0,10,"SaveSettingToLocalStorage failed",b),Promise.resolve(!1)}}Mqd(a){const b={};b.Wac=a;const c=De.c(b);return new Promise(f=>{try{if(void 0===c||null===c||!c.length||1E6<=c.length)f(!1);else{var l=this.executeRequest(this.lag(this.bdl),2,"SaveAddinShortcutsPreferenceRequest","38",c);l.continueWith(()=>{if(l.ho||l.Dm)ka.ULS.sendTraceTag(522739859,0,10,"SaveAddinShortcutsPreference: Request failure"),f(!1);else{var y=l.result;void 0!==y.uj&&null!==y.uj&&void 0!==y.uj.data&&null!==y.uj.data&&y.uj.data.Ke===
ua.a.mx?f(!0):f(!1)}})}}catch(y){ka.ULS.sendTraceTag(522739860,0,10,"SaveAddinShortcutPerferrenceSettings: Exception = {0}",y.toString()),f(!1)}})}getSetting(){const a=this.Vtc();return this.XY?Promise.resolve(De.c(this.XY)):a?this.trj():this.Kce()}Vtc(){const a=w.AFrameworkApplication.fa.ka("IsAnonymousUser"),b=w.AFrameworkApplication.fa.ka("IsRoamingServiceEnabled");return a||!b}trj(){try{const a=localStorage.getItem("AddinShortcutPreferenceData");return Promise.resolve(a)}catch(a){return ka.ULS.sendTraceTag(522739861,
0,10,"GetSettingFromLocalStorage failed",a),Promise.resolve("")}}Kce(){return new Promise((a,b)=>{try{const c=this.executeRequest(this.lag(this.adl),1,"GetSettingRequest","37");c.continueWith(()=>{if(c.ho||c.Dm)ka.ULS.sendTraceTag(522739862,0,10,"GetSettingFromRoaming : Request failure");else{let l="";var f=c.result;f&&f.uj&&f.uj.data?f.uj.data.Ke!==ua.a.mx?ka.ULS.sendTraceTag(522739864,0,10,"GetSettingFromRoaming : Received error response {0}",f.uj.data.Ke):f.uj.data.ee?(f=De.a(f.uj.data.ee),f.Wac&&
(l=f.Wac)):ka.ULS.sendTraceTag(522739865,0,10,"GetSettingFromRoaming : ResponseData is null"):ka.ULS.sendTraceTag(522739863,0,10,"GetSettingFromRoaming : Data is null");a(l)}})}catch(c){ka.ULS.sendTraceTag(522739866,0,10,"GetSettingFromRoaming Exception handling request {0}",c.toString()),b("GetSettingFromRoaming Request Exception")}})}clearSettingByAddinId(a){const b=this.Vtc(),c=this;return this.getSetting().then(f=>{let l=null;f&&(l=De.a(f));if(!l)return ka.ULS.sendTraceTag(522739867,0,50,"savedRoamingSetting is empty and nothing to clear "),
Promise.resolve(!0);for(const y of ta.a.EL(l)){f=l[y.toString()];for(const H of ta.a.EL(f)){const Q=f[H];if(Q.addinId===a)delete f[H.toString()];else if(0===Q.ownerType&&Q.shortcutInfoArray){const ia=Q.shortcutInfoArray,wa=new Na.a;for(let Ua=0;Ua<ia.length;++Ua)ia[Ua].addinId!==a&&wa.add(ia[Ua]);Q.shortcutInfoArray=wa.toArray()}}ta.a.count(f)||delete f[y]}c.XY=l;c.J5k(a);return b?c.$th(De.c(l)):c.Mqd(De.c(l))})}Vtb(){if(this.XY){this.F8=null;const c=this.XY;for(let f in c){var a=f;const l=c[f];for(let y in l){var b=
y;const H=l[y];H.shortcutInfoArray&&this.$Rd(parseInt(b),parseInt(a),H.shortcutInfoArray)}}}}loadShortcutsPreferenceMappingTable(){return this.getSetting().then(a=>{let b=null;if(a&&!({Nu:b}=De.d(a)).returnValue)return ka.ULS.sendTraceTag(522739868,0,10,"LoadShortcutsPreferenceMappingTable is failed since savedRoamingSetting cannot be deserialized"),Promise.resolve(!1);this.XY=b;this.Vtb();return Promise.resolve(!0)})}getShortcutsPreferenceInfoByAddinId(a,b,c){return this.XY&&(c=this.XY[c])&&(b=c[b])&&
b.addinId===a?b:null}getShortcutInfoArray(a,b){return this.XY&&(b=this.XY[b])&&(a=b[a])&&a.shortcutInfoArray?a.shortcutInfoArray:null}setShortcutInfoWithinBatchUpdateScope(a,b,c){this.saveShortcutInfoArrayBatch(parseInt(a),parseInt(b),c)}setShortcutInfoArray(a,b,c){return this.saveShortcutInfoArray(parseInt(a),parseInt(b),c).then(()=>{this.Vtb();return Promise.resolve(!0)})}removeActionFromShortcutInfoArray(a,b){if(!this.F8)return Promise.resolve(!0);var c=this.F8[a];if(!c)return Promise.resolve(!0);
var f=c[b];c=f.modifiers;f=f.keyCode;const l=this.getShortcutInfoArray(c.toString(),f.toString());if(!l||!l.length)return Promise.resolve(!0);let y=0;for(const H of l){if(H.addinId===a&&H.action===b)break;++y}if(y>=l.length)return Promise.resolve(!0);l.splice(y,1);return this.saveShortcutInfoArray(c,f,l).then(()=>{this.Vtb();return Promise.resolve(!0)})}$Rd(a,b,c){this.F8||(this.F8={});for(const f of c){c=f.addinId;const l=f.action;let y=this.F8[c];y||(y={});const H={};H.modifiers=a;H.keyCode=b;y[l]=
H;this.F8[c]=y}}J5k(a){a in this.F8&&delete this.F8[a]}isActionCustomized(a,b){return this.F8&&(a=this.F8[a])&&a[b]?!!a[b]:!1}getShortcutByCustomizedAction(a,b){return this.F8&&(a=this.F8[a])?a[b]:null}getShortcutsPreferenceMappingTable(){return this.XY}static instance(){nr.HTd||(ka.ULS.sendTraceTag(522739851,0,50,"AddinShortcutsPreferenceSettingHelper"),nr.HTd=new nr,nr.ada=w.AFrameworkApplication.Me);return nr.HTd}}nr.HTd=null;nr.ada=null;Object(m.a)(nr,"AddinShortcutsPreferenceSettingHelper",null,
[]);class tH{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=
this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(m.a)(tH,"BrowserInfo",null,[]);class uH{constructor(){this.Version=this.Name=null}}Object(m.a)(uH,"PluginInfo",null,[]);class jk{static Kbk(){if(w.AFrameworkApplication.fa.ka("LogBrowserInfoIsEnabled")){var a=jk.c9i();try{const b=JSON.stringify(a);ka.ULS.sendTraceTag(6903563,102,50,b)}catch(b){ka.ULS.sendTraceTag(6903564,102,15,b.message)}}else ka.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static Vnj(){const a=
window.navigator.plugins;if(!a||!a.length)return null;const b=[];for(let c=0;c<a.length;c++){const f=a[c].name,l=a[c].version;Array.add(b,Object.assign(new uH,{Name:f,Version:l}))}return b}static c9i(){const a=new tH,b=new Sys.StringBuilder;jk.xB(c=>{a.DocElemClientHeight=c},()=>document.documentElement.clientHeight,b);jk.xB(c=>{a.DocElemClientWidth=c},()=>document.documentElement.clientWidth,b);jk.xB(c=>{a.DocElemOffsetHeight=c},()=>document.documentElement.offsetHeight,b);jk.xB(c=>{a.DocElemOffsetWidth=
c},()=>document.documentElement.offsetWidth,b);jk.xB(c=>{a.ScreenAvailHeight=c},()=>window.screen.availHeight,b);jk.xB(c=>{a.ScreenAvailWidth=c},()=>window.screen.availWidth,b);jk.xB(c=>{a.ScreenWidth=c},()=>window.screen.width,b);jk.xB(c=>{a.ScreenHeight=c},()=>window.screen.height,b);jk.xB(c=>{a.ScreenLogicalXdpi=c},()=>window.screen.logicalXDPI,b);jk.xB(c=>{a.ScreenLogicalYdpi=c},()=>window.screen.logicalYDPI,b);jk.xB(c=>{a.ScreenDeviceXdpi=c},()=>window.screen.deviceXDPI,b);jk.xB(c=>{a.ScreenDeviceYdpi=
c},()=>window.screen.deviceYDPI,b);jk.xB(c=>{a.WinInnerHeight=c},()=>window.self.innerHeight,b);jk.xB(c=>{a.WinInnerWidth=c},()=>window.self.innerWidth,b);jk.xB(c=>{a.WinOuterHeight=c},()=>window.self.outerHeight,b);jk.xB(c=>{a.WinOuterWidth=c},()=>window.self.outerWidth,b);jk.xB(c=>{a.WinOrientation=c},()=>window.self.orientation,b);jk.xB(c=>{a.WinDevicePixelRatio=c},()=>window.self.devicePixelRatio,b);jk.xB(c=>{a.SupportsTouch=c},()=>z.a.uMa,b);jk.xB(c=>{a.NavAppName=c},()=>window.navigator.appName,
b);jk.xB(c=>{a.NavAppVersion=c},()=>window.navigator.appVersion,b);jk.xB(c=>{a.NavLanguage=c},()=>window.navigator.browserLanguage||window.navigator.language,b);jk.xB(c=>{a.NavUserAgent=c},()=>window.navigator.userAgent,b);jk.xB(c=>{a.NavPlatform=c},()=>window.navigator.platform,b);jk.xB(c=>{a.NavPlugins=c},jk.Vnj,b);jk.xB(c=>{a.CalculatedDevicePixelRatio=c},()=>jk.devicePixelRatio,b);a.Error=b.toString();return a}static get devicePixelRatio(){const a=window.devicePixelRatio;return isNaN(a)?window.screen.deviceXDPI/
window.screen.logicalXDPI:a}static xB(a,b,c){try{const f=b();a(f)}catch(f){c.isEmpty()||c.append(" | "),c.append(f.message||"null")}}}Object(m.a)(jk,"BrowserInfoLogger",null,[]);class TB{get name(){return"Common.App.BrowserInfoLogger"}Yb(){}init(){jk.Kbk()}dispose(){}static main(){n.a.instance.Ac(new TB)}}Object(m.a)(TB,"BrowserInfoLoggerPackage",null,[2,3]);class UB{get name(){return"Common.App.DialogWithLinkToResource"}Yb(){}init(){}dispose(){}static main(){n.a.instance.Ac(new UB)}}Object(m.a)(UB,
"CommonAppDialogWithLinkToResourcePackage",null,[2,3]);var IQ=d(724);class VB{get name(){return"Common.App.EventsCachePackage"}Yb(){}init(){IQ.a.instance.init()}dispose(){}static main(){n.a.instance.Ac(new VB)}}Object(m.a)(VB,"EventsCachePackage",null,[2,3]);class WB{constructor(a,b,c){this.x6a=null;this.Zd=a;this.Ca=b;this.Egf=c.create()}Mqc(){this.x6a?ka.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(ka.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),
this.x6a=new dd.a(2,1,3E4,Object(I.a)(this,this.aud,"showFloatPane"),67),this.Zd.Hb(this.x6a))}aud(){this.x6a=null;ka.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.Egf.display()}zya(){this.Ca.ya(G.a.aud,ie.a.frame,Object(I.a)(this,this.Pvl,"showFloatPaneHandler"))}Pvl(a,b,c,f,l){return a!==G.a.aud?2:1===c?32:2===c&&l?(ka.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",l),l?this.Mqc():(this.x6a?(ka.ULS.sendTraceTag(23674914,
207,50,"Hide float pane via removing show task!"),this.Zd.Lg(this.x6a)):(ka.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.Egf.remove(null)),this.x6a=null),32):8}}Object(m.a)(WB,"FloatPaneActor",null,[1347]);class vH{constructor(a,b,c,f,l){this.lJd=this.QUb=this.AFc=this.GBa=this.U2=this.HAa=this.HBd=this.OZ=this.jXb=this.nWb=this.oWb=this.TEd=null;this.Zd=b;this.Oa=a;this.xq=c;this.Da=l;this.Bha=f}IOf(){this.OZ=document.createElement("div");this.OZ.className=String.format("{0} {1}",
"WACFloatPane","WACFloatPaneFadeIn");this.OZ.style.width=this.U2.width+"px";(this.lJd=this.Fmj(this.Bha))?(this.GBa=document.createElement("a"),this.GBa.setAttribute(Ve.a.hf,Ve.a.iQ),this.xq.rb(oa.a.click,this.GBa,Object(I.a)(this,this.rah,"onRedirectClick")),this.GBa.href=this.lJd,this.GBa.target="_blank",this.GBa.appendChild(this.U2),this.OZ.appendChild(this.GBa)):this.OZ.appendChild(this.U2);this.HAa=document.createElement("a");this.HAa.setAttribute(Ve.a.hf,Ve.a.Ju);this.HAa.className="StandardButton WACFloatPaneCloseButton";
this.HAa.title=CommonUIStrings.l_Close;this.HAa.tabIndex=-1;this.HBd=He.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",!0,null);this.HBd.setAttribute(Ve.a.hf,Ve.a.iQ);this.HAa.appendChild(this.HBd);this.xq.rb(oa.a.click,this.HAa,Object(I.a)(this,this.onClose,"onClose"));this.OZ.appendChild(this.HAa);this.jXb.appendChild(this.OZ)}qk(a){const b=this.Oa.ka("O365PromotionHasStarted");switch(a){case 2:return $a.a.JN(String.format("adppt{0}.png",
b?"sale":""));case 1:return $a.a.JN(String.format("adxls{0}.png",b?"sale":""));case 3:return $a.a.JN(String.format("addoc{0}.png",b?"sale":""))}return null}Fmj(a){const b=this.Oa.Ha("O365AdPaneRedirectedURL");switch(a){case 1:return String.format(b,"Excel");case 2:return String.format(b,"PowerPoint");case 3:return String.format(b,"Word")}return null}hide(a=null){this.QUb=null;this.OZ&&!this.AFc&&(a?ka.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):ka.ULS.sendTraceTag(23674903,
207,50,"User clicks button to close the float pane."),this.OZ.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.OZ.style.height="0px",this.AFc=new dd.a(2,1,1E3,Object(I.a)(this,this.remove,"remove"),67),this.Zd.Hb(this.AFc))}remove(){this.OZ&&this.jXb&&(this.GBa&&this.xq.Bb(oa.a.click,this.GBa,Object(I.a)(this,this.rah,"onRedirectClick")),this.xq.Bb(oa.a.click,this.HAa,Object(I.a)(this,this.onClose,"onClose")),this.jXb.removeChild(this.OZ),this.OZ=null);this.AFc=null}display(){if(this.TEd=
this.Da.qb("Common.IFloatPaneContainer"))if(this.jXb=this.TEd.container){var a=this.qk(this.Bha);a?(ka.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",a),this.U2=document.createElement("img"),this.U2.className="WACFloatPaneImage",this.oWb=Object(I.a)(this,this.LEk,"onLoadImageFinish"),hd.a.addHandler(this.U2,oa.a.load,this.oWb),this.nWb=Object(I.a)(this,this.KEk,"onLoadImageError"),hd.a.addHandler(this.U2,oa.a.error,this.nWb),this.U2.src=a):ka.ULS.sendTraceTag(23674907,
207,15,"The target image is empty, can't show the float pane.")}else ka.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else ka.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}LEk(){const a=this.Oa.wc("O365AdPaneShowingDuration",60);this.IOf();this.OZ.style.display="block";this.OZ.style.height=this.U2.height+"px";this.QUb=new dd.a(2,1,1E3*a,Object(I.a)(this,this.hide,"hide"),67);this.Zd.Hb(this.QUb);
this.Knh()}KEk(){ka.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.Knh();this.U2=null}Knh(){this.oWb&&this.U2&&hd.a.removeHandler(this.U2,oa.a.load,this.oWb);this.oWb=null;this.nWb&&this.U2&&hd.a.removeHandler(this.U2,oa.a.error,this.nWb);this.nWb=null}rah(){ka.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1}onClose(){this.QUb&&this.Zd.Lg(this.QUb);this.hide();return!0}dispose(){this.hide()}}
Object(m.a)(vH,"FloatPane",null,[1287]);class XB{constructor(a,b,c,f,l){this.Zd=b;this.Oa=a;this.xq=c;this.Da=l;this.Bha=f}create(){return new vH(this.Oa,this.Zd,this.xq,this.Bha,this.Da)}}Object(m.a)(XB,"FloatPaneFactory",null,[1265]);class YB{constructor(){this.Da=null}get name(){return"Common.App.FloatPane"}get uog(){return w.AFrameworkApplication.fa.ka("O365AdvertisementIsEnabled")&&w.AFrameworkApplication.fa.ka("IsShowAdvertisementPaneEnabled")}init(){this.uog&&(ka.ULS.sendTraceTag(23674944,
207,50,"Setup task to show the float pane."),this.Da.resolve("Common.App.FloatPane.IFloatPaneActor").Mqc(),ka.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.Da.resolve("Common.App.FloatPane.IFloatPaneActor").zya())}Yb(a){this.Da=a;this.uog&&(this.Da.register(XB,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").oa(()=>new XB(w.AFrameworkApplication.fa,w.AFrameworkApplication.Ae,td.a.instance,w.AFrameworkApplication.Aa.ob.zk,
this.Da)).ma(),this.Da.register(WB,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").oa(()=>new WB(w.AFrameworkApplication.Ae,w.AFrameworkApplication.Ra,this.Da.resolve("Common.App.FloatPane.IFloatPaneFactory"))).ma())}dispose(){}static main(){n.a.instance.Ac(new YB)}}Object(m.a)(YB,"FloatPanePackage",null,[2,3]);const wH=(a,b)=>{a=Math.atan2(b.y-a.y,b.x-a.x);0>a&&(a+=2*Math.PI);return a};class JQ{constructor(a,b,c){this.WP=this.ppb=this.Prb=null;this.BAa=this.bDd=
this.pqa=0;this.MG=this.tCc=this.cBc=this.bBc=!1;this.rGd=this.Cif=this.Eif=0;this.MOa=a;this.Ca=b;this.UZ=c}Mv(a){return Rc.App.Lb.Kd.isEditingAllowed?""!==this.FVc(a.Bc):!1}Yu(a){if(!this.Mv(a))return!1;this.BAa=this.MOa.pXl();this.vnl(a);this.wnl();({Vne:this.tCc,Gqe:this.MG}=this.Pxh(this.bDd));this.xnl();this.Prb=a.aF;this.WP=new Sys.UI.Point(0,0);({width:this.Eif,height:this.Cif}=this.MOa.aVc());ka.ULS.sendTraceTag(16802335,322,50,"Image resize drag started");return!0}Rw(a){this.ppb=a.aF;this.Evi();
var b=this.WP.x,c=this.WP.y;a=this.Eif;var f=this.Cif,l=this.tCc,y=this.MG,H=1;(b||c)&&a&&f&&(l&&y?(H=a+b,l=f+c,b=1/a,c=1/f,y=b>c?b:c,1>H?H=1:1920<H&&(H=1920),1>l?l=1:1280<l&&(l=1280),b=H-a,c=l-f,H=Math.abs(b/a)>Math.abs(c/f)?H/a:l/f,H<y&&(H=y)):l?(b=a+b,1>b?b=1:1920<b&&(b=1920),H=b/a):y&&(b=f+c,1>b?b=1:1280<b&&(b=1280),H=b/f));a=H;this.rGd=a;this.MOa.eZl(this.rGd,this.tCc,this.MG);return!0}to(){this.ah();ka.ULS.sendTraceTag(16802336,322,50,"Image resize drag succeeded")}Au(){this.MOa.tYl();ka.ULS.sendTraceTag(16802337,
322,50,"Image resize drag canceled")}wnl(){this.bDd=(Math.floor((this.BAa+22)/45)%8+this.pqa)%8}Pxh(a){let b,c;if(this.BAa&&90!==this.BAa&&180!==this.BAa&&270!==this.BAa&&360!==this.BAa||this.FYj(a))return{Vne:!0,Gqe:!0};c=b=!1;switch(a){case 1:case 5:c=!0;break;case 3:case 7:b=!0}return{Vne:b,Gqe:c}}xnl(){this.cBc=this.bBc=!1;switch(this.bDd){case 0:this.cBc=this.bBc=!0;break;case 1:case 2:this.cBc=!0;break;case 7:case 6:this.bBc=!0}}FYj(a){return!(a%2)}FVc(a){var b=a.className;-1===b.indexOf("WACImageResizeHandle")&&
a.parentNode&&(b=a.parentNode.className);a=b.split(" ");for(b=0;b<a.length;b++){const c=a[b].toString();if(c.startsWith("WACImageResizeHandle")&&"WACImageResizeHandles"!==c)return c}return""}vnl(a){switch(this.FVc(a.Bc)){case "WACImageResizeHandleNW":this.pqa=0;break;case "WACImageResizeHandleN":this.pqa=1;break;case "WACImageResizeHandleNE":this.pqa=2;break;case "WACImageResizeHandleE":this.pqa=3;break;case "WACImageResizeHandleSE":this.pqa=4;break;case "WACImageResizeHandleS":this.pqa=5;break;case "WACImageResizeHandleSW":this.pqa=
6;break;case "WACImageResizeHandleW":this.pqa=7}}Evi(){var a=1;this.UZ.instance&&(a=this.UZ.instance.G3);const b=(this.ppb.x-this.Prb.x)/a;a=(this.ppb.y-this.Prb.y)/a;this.WP.x=this.bBc?-b:b;this.WP.y=this.cBc?-a:a}ah(){const a=new J.DictionaryPropertySet;a.setValue(ee.a.eLj,100*this.rGd);a.setValue(ee.a.fLj,!0);if(90===this.BAa||270===this.BAa){let b,c;({Vne:b,Gqe:c}=this.Pxh(this.pqa));a.setValue(ee.a.Qig,b);a.setValue(ee.a.Rig,c)}else a.setValue(ee.a.Qig,this.tCc),a.setValue(ee.a.Rig,this.MG);
this.Ca.Ka(C.a.cLj,2,a)}}Object(m.a)(JQ,"ImageResizeDragAdapter",null,[274]);class ZB{constructor(a,b){this.Ca=a;this.UZ=b}}Object(m.a)(ZB,"ImageResizeDragAdapterFactory",null,[1232]);class xH{constructor(a,b,c,f,l,y){this.prb=this.SFc=this.uGd=this.ppb=this.Prb=this.TFc=null;this.vEc=this.$Hc=0;this.ey=null;this.Bo=!1;this.Ca=a;this.Uc=b;this.Pg=c;this.MOa=f;this.UZ=l;this.vmf=this.Iia=0;this.vrb=y}Mv(a){return Rc.App.Lb.Kd.isEditingAllowed&&a?(this.TFc=this.Uc.Yj)?!0:!1:!1}Yu(a){if(!this.Mv(a))return!1;
this.TFc=this.Uc.Yj;if(this.ey=ba.ImageReader.REa(this.TFc))return this.Prb=this.Sta(a),this.uGd=Sys.UI.DomElement.getBounds(this.vrb),this.$Hc=0<ba.ImageReader.W7f(this.ey)?ba.ImageReader.W7f(this.ey):0,this.vEc=ba.ImageReader.Lij(this.ey),ka.ULS.sendTraceTag(22052886,322,50,"Image rotate drag event started."),!0;ka.ULS.sendTraceTag(24496074,322,15,"Drag start cancelled. Attempted to rotate with null img. properties.");return!1}Rw(a){this.ppb=this.Sta(a);this.Gvi();if(this.MOa)return this.MOa.WPl(this.Iia,
this.vmf),ka.ULS.sendTraceTag(25179723,322,50,"Image rotate drag move is happening."),!0;ka.ULS.sendTraceTag(25179724,322,50,"Image rotate drag move aborted because img presenter is null.");return!1}to(){var a=this.Iia;a%=360;0>a&&(a+=360);this.$Hc=this.Iia=a;this.setRotation();ka.ULS.sendTraceTag(22052887,322,50,"Image rotate drag event ended.")}Au(){this.MOa.WPl(this.vEc,0);ka.ULS.sendTraceTag(22052888,322,50,"Image rotate drag event canceled.")}Sta(a){return this.Pg.Gka(a)}Gvi(){var a=1;this.UZ&&
this.UZ.instance&&(a=this.UZ.instance.G3);var b=new Sys.UI.Point(this.uGd.x+this.vrb.clientWidth/2*a,this.uGd.y+this.vrb.clientHeight/2*a);a=wH(this.Prb,b);b=wH(this.ppb,b);this.Iia=Math.round(xe.a.XM(b-a));0<this.$Hc&&(this.Iia+=this.$Hc-this.vEc);this.vmf=this.Iia;this.Iia+=this.vEc}setRotation(){const a=new J.DictionaryPropertySet;a.setValue(ee.a.dLj,0);a.setValue(ee.a.x$b,this.Iia);this.Ca.Ka(C.a.imageRotate,2,a)}dispose(){ka.ULS.sendTraceTag(50597973,322,50,"ImageRotateDragAdapter is disposed.");
this.Bo||(this.prb&&(this.SFc&&this.prb.contains(this.SFc)&&(this.prb.removeChild(this.SFc),this.SFc=null),this.vrb&&this.vrb.contains(this.prb)&&(this.vrb.removeChild(this.prb),this.prb=null)),this.Bo=!0)}}Object(m.a)(xH,"ImageRotateDragAdapter",null,[1270,274,107]);class $B{constructor(a,b,c){this.Ca=a;this.Uc=b;this.UZ=c}create(a,b,c){return new xH(this.Ca,this.Uc,a,b,this.UZ,c)}}Object(m.a)($B,"ImageRotateDragAdapterFactory",null,[1231]);class aC{constructor(){this.Da=null}get name(){return"Box4.Images"}Yb(a){this.Da=
a;this.Da.register(ZB,"Box4.Images.ImageResizeDragAdapterFactory").as("Box4.Images.IImageResizeDragAdapterFactory").ma().oa(()=>new ZB(w.AFrameworkApplication.Ra,Ib.a.instance.Ia("Common.IZoomManager")));this.Da.register($B,"Box4.Images.ImageRotateDragAdapterFactory").as("Box4.Images.IImageRotateDragAdapterFactory").ma().oa(()=>new $B(w.AFrameworkApplication.Ra,ge.a.instance,Ib.a.instance.Ia("Common.IZoomManager")))}init(){this.Da.resolve("Box4.Images.IImageRotateDragAdapterFactory")}dispose(){}static main(){n.a.instance.Ac(new aC)}}
Object(m.a)(aC,"Box4ImagesPackage",null,[2,3]);class yH{create(a){return new wd.a(a)}}Object(m.a)(yH,"Factory",null,[1242]);var Zy=d(446);class zH{constructor(){this.Qi=null}get key(){return"COMMENTTEXTANCHOR"}get y8(){return Box4Intl.Box4Strings.l_CommentContentTitle}reset(a){this.Qi=Object(qa.a)(kf.AParagraphNode,a.node)}zwc(a){a=(a=this.edj(a))?Object.assign(new Zy.a,{u1:this.key,nQ:a}):null;return{returnValue:!!a,pCa:a}}edj(a){if(!this.Qi.Ta)return null;const b=new Na.a;for(let c=0;c<this.Qi.Ta.length;c++){const f=
this.Qi.Ta.ga(c);if(f.cp>a)break;if(f.Bg)for(let l=0;l<f.Bg.length;l++){const y=f.Bg.ga(l);y.Jk?b.add(y.LI.guid.toString()):b.remove(y.LI.guid.toString())}}return 0<b.count?b.ga(0):null}}Object(m.a)(zH,"CommentTextAnchorDetailsProvider",null,[612,477]);class qx{constructor(){this.Qi=null}get y8(){return null}getTitle(){return null}h6f(){return null}reset(a){this.Qi=a.node}zwc(a){const b=cg.d(this.Qi,a);a=null;if(!b||b.Bq!==this.Bq)return{returnValue:!1,pCa:a};a=Object.assign(new Zy.a,{u1:this.key,
nQ:b,title:this.getTitle(b),description:this.h6f(b)});return{returnValue:!0,pCa:a}}}Object(m.a)(qx,"BlobDetailsProvider",null,[612,477]);class AH extends qx{constructor(){super()}get key(){return"EQUATION"}get Bq(){return 11}get y8(){return Box4Intl.Box4Strings.l_EquationContentTitle}}Object(m.a)(AH,"EquationDetailsProvider",qx,[]);class BH{constructor(){this.oif=null}get key(){return"LINK"}get y8(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle}reset(a){this.oif=wb.HyperlinkReader.D7b(a.node)}zwc(a){let b;
b=null;for(const c of this.oif)if(c.Sa<=a&&a<c.Mb)return b=Object.assign(new Zy.a,{u1:this.key,nQ:c.hyperlink}),{returnValue:!0,pCa:b};return{returnValue:!1,pCa:b}}}Object(m.a)(BH,"HyperlinkDetailsProvider",null,[612,477]);class CH extends qx{constructor(){super()}get key(){return"IMAGE"}get Bq(){return 5}get y8(){return Box4Intl.Box4Strings.l_ImageContentTitle}getTitle(a){return ba.ImageReader.JVc(a.properties)}h6f(a){return ba.ImageReader.wae(a.properties)}}Object(m.a)(CH,"ImageDetailsProvider",
qx,[]);class $y{constructor(){this.description=this.contentId=this.nQ=this.u1=null}}Object(m.a)($y,"StructuralContentDetails",null,[524]);class DH{get key(){return"IMAGENODE"}get y8(){return Box4Intl.Box4Strings.l_ImageContentTitle}G7e(a){let b;b=null;if(!a||!ba.ImageReader.tH(a.currentNode))return{returnValue:!1,kvb:b};b=Object.assign(new $y,{u1:this.key,contentId:a.currentNode.id,nQ:a.currentNode});return{returnValue:!0,kvb:b}}PUc(a,b){a=a.nQ;const c=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;
let f="";b&&a.id===b.nQ.id||(f=String.format(c,ba.ImageReader.JVc(a.properties),Box4Intl.Box4Strings.l_ImageContentTitle));return f}}Object(m.a)(DH,"ImageNodeDetailsProvider",null,[476,477]);let rx,sx;class es{constructor(a,b){this.Off=null;this.Rm=b;this.vMd=a;this.QVb=es.keys.ga(a);this.kWh=es.xHi.ga(a)}get key(){return this.QVb}get y8(){return this.kWh}reset(a){this.Off=this.Rm.TF(a.node)}zwc(a){var b=es.P5i(this.Off||[],c=>this.cVj(a,c));b=this.rKi(b);return{returnValue:!!b,pCa:b}}cVj(a,b){return b.begin<=
a&&a<b.end&&(!b.Eh||this.vMd===b.Eh.proofingType)}rKi(a){return a?Object.assign(new Zy.a,{u1:this.key,nQ:a.Eh,description:this.c$d()}):null}c$d(){return w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}static P5i(a,b){for(const c of a)if(b(c))return c;return null}}es.keys=(sx=new Pb.a,sx.add(1,"SPELLINGERROR"),sx.add(2,"GRAMMATICALERROR"),sx.add(3,"ADVANCEDERROR"),sx);es.xHi=(rx=new Pb.a,
rx.add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),rx.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),rx.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),rx);Object(m.a)(es,"ProofingDetailsProvider",null,[612,477]);class EH{constructor(){this.tableNode=null;this.TMc=this.sqd=this.columns=this.rows=0}}Object(m.a)(EH,"TableInfo",null,[]);var Qn=d(148),Sd=d(85),vk=d(128);class FH{get key(){return"TABLE"}get y8(){return Box4Intl.Box4Strings.l_TableContentTitle}G7e(a){var b=
null;if(!ae.isTableCell(a))return{returnValue:!1,kvb:b};b=new ob.GraphIterator;b.Tc(a);a=new EH;a.sqd=vk.c(b)+1;a.TMc=Qn.a(b)+1;Sd.returnToContainingTable(b);a.tableNode=b.currentNode;a.columns=cd.TableReader.Gi(a.tableNode);a.rows=cd.TableReader.Gk(a.tableNode);b=Object.assign(new $y,{u1:this.key,contentId:a.tableNode.id,nQ:a});return{returnValue:!0,kvb:b}}PUc(a,b){a=a.nQ;const c=new qj.a;b||c.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,a.columns,a.rows));b&&b.nQ.TMc===a.TMc||
c.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,a.TMc));b&&b.nQ.sqd===a.sqd||c.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,a.sqd));return c.toArray().join(" ")}}Object(m.a)(FH,"TableDetailsProvider",null,[476,477]);class bC{constructor(a,b){this.UYh=a;this.Rm=b}vUe(){this.UYh.execute(a=>{a.s0a(new BH);a.s0a(new es(1,this.Rm));a.s0a(new es(2,this.Rm));a.s0a(new es(3,this.Rm));a.s0a(new AH);a.s0a(new CH);a.s0a(new zH);a.HUe(new FH);a.HUe(new DH)})}}
Object(m.a)(bC,"AccessibilityActor",null,[]);class cC{constructor(a,b,c){this.jZb=a;this.qd=b;this.DUh=c}vb(){this.jZb.ra(C.a.sJk,yb.a.view,Object(I.a)(this,this.tJk,"openAutoCorrectOptionsView"),1028)}tJk(a,b,c){if(1===c)return 32;this.DUh().euc();return 32}}Object(m.a)(cC,"AutoCorrectActor",null,[]);class dC{constructor(a){this.x0h=a}Y_j(a){if(!a||!a.xw||1>a.xw.count)return!1;const b=[xc.a.kQi,xc.a.jQi];return!!this.xUc(a.xw,1,c=>this.yNc(c,b))}Gng(a){return!a||!a.xw||1>a.xw.count?!1:!!this.xUc(a.xw,
1,b=>this.yNc(b,[xc.a.VN]))}nYj(a){return!a||!a.xw||1>a.xw.count?!1:!!this.xUc(a.xw,2,b=>this.yNc(b,[xc.a.fdc]))}ql(a){return!a||!a.xw||1>a.xw.count?!1:!!this.xUc(a.xw,1,b=>this.yNc(b,[xc.a.mga]))}m1c(a){if(!a||!a.xw)return!1;a=a.xw;for(let b=0;b<a.count;++b)if(!a.ga(b)||0<a.ga(b).goi)return!1;return!0}Z_i(a,b){return this.Gng(b)||this.nYj(b)?"":a}get k2c(){return this.x0h}xUc(a,b,c){if(a&&0<a.count)for(let f=a.count-1;0<=f;--f){if(c(a.ga(f)))return a.ga(f);if(a.count-f>=b)break}return null}yNc(a,
b){a=a&&a.fig?a.fig.split(" "):null;if(!a)return!1;for(const c of b)if(0<=Array.indexOf(a,c))return!0;return!1}}Object(m.a)(dC,"Box4PasteStewardUtils",null,[1317]);class GH{constructor(){this.lZ=0;this.wCb=Array(9)}}Object(m.a)(GH,"FullListMetadata",null,[]);class az{constructor(){this.level=0;this.rNa=null;this.lZ=0;this.U2i=this.wnc=null;this.LJb=!1}}Object(m.a)(az,"ListItemMetadata",null,[]);class ju{constructor(){this.rZ=[]}F5f(){const a=new ju;for(let b=0;b<this.rZ.length;b++)a.add(this.ga(b));
return a}get count(){return this.rZ.length}ga(a){return this.rZ[a]}$(a,b){return this.rZ[a]=b}add(a){Array.add(this.rZ,a)}clear(){Array.clear(this.rZ)}contains(a){return Array.contains(this.rZ,a)}indexOf(a){return Array.indexOf(this.rZ,a)}insert(a,b){Array.insert(this.rZ,a,b)}remove(a){return Array.remove(this.rZ,a)}removeAt(a){Array.removeAt(this.rZ,a)}removeRange(a,b){for(let c=0;c<b;c++)Array.removeAt(this.rZ,a)}reverse(){this.rZ.reverse()}sort(){this.rZ.sort()}toArray(){return Array.clone(this.rZ)}}
Object(m.a)(ju,"List",null,[]);class HH{constructor(){this.level=0;this.tagName="UL";this.TZa=null;this.ignore=!1;this.emc=0;this.listStyle="BulletListStyle1";this.S9=new ju;this.font=this.levelText=""}}Object(m.a)(HH,"ListLevelMetadata",null,[]);class eC{constructor(){this.rvg={};this.ePc=-1}}Object(m.a)(eC,"LevelLists",null,[]);class fC{constructor(a){this.nodes=a;this.E3=0;this.lists={};this.S9=[];this.lCb=null;this.Xja=[];this.Xja[0]=new eC}}Object(m.a)(fC,"WordConverterArguments",null,[]);class IH{constructor(){this.y=
this.x=0;this.top=this.left=null}}Object(m.a)(IH,"AbsolutePosition",null,[]);class dn{constructor(a,b,c,f,l){this.cultureName=this.g6=this.xw=this.TU=null;a&&(this.TU=a);b&&(this.xw=b);this.g6=c?c:new Na.a;f&&""!==f&&(this.cultureName=f);this.Wia=l}}Object(m.a)(dn,"GlobalAttributesArgs",null,[]);class ku{constructor(a,b,c="",f=0){this.kw=!1;this.fif=this.gif=null;let l=!1;ku.KXj(a)&&(l=!0,this.gif=a);ku.ZXj(b)&&(this.fif=b);this.LZh=c;this.yUh=f;this.kw=l&&this.j$b?!0:!1}get isValid(){return this.kw}get hig(){return this.gif}get j$b(){return this.fif}get fig(){return this.LZh}get goi(){return this.yUh}static KXj(a){return a?
-1===a.indexOf(" ")&&0<a.length:!0}static ZXj(a){return a?-1===a.indexOf(" ")&&0<a.length:!1}}Object(m.a)(ku,"HtmlElementInfo",null,[]);class JH{constructor(a){this.next=null;this.data=a}}Object(m.a)(JH,"StackNode",null,[]);class tx{constructor(){this.sv=null;this.il=0}get count(){return this.il}get isEmpty(){return!this.il||!this.sv}push(a){a=new JH(a);a.next=this.sv;this.sv=a;this.il++}peek(){return this.isEmpty?null:this.sv.data}pop(){if(this.isEmpty)return null;const a=this.sv;this.sv=a.next;
this.il--;return a.data}clear(){this.sv=null;this.il=0}toArray(){const a=Array(this.count);let b=this.sv;for(let c=this.count-1;0<=c&&b;c--)a[c]=b.data,b=b.next;return a}}Object(m.a)(tx,"Stack",null,[]);class mh{constructor(a){this.xUb=this.mEc=null;this.yAc=!1;this.Ng=a}get hSa(){return this.xUb.peek()}reset(){this.Ng.reset();this.mEc=new tx;this.xUb=new tx;this.xUb.push(this.Ng.b4b);this.yAc=!1}Lhd(){this.yAc=!1}ED(a){this.yAc||(this.mEc.push(null),this.yAc=!0);this.mEc.push(a)}onClose(){for(;;){const a=
this.mEc.pop();if(!a)break;a()}}Ewh(){return!1}dzk(){this.Hq(()=>!0)}Hq(a){const b=this.hSa.clone();return a(b)?(this.xUb.push(b),this.Ng.moa(b),this.ED(Object(I.a)(this,this.nDk,"onFormattingEnd")),!0):!1}Ree(a){return a.style?this.Hq(b=>this.Ewh(b,a))?1:2:2}nDk(){this.xUb.pop();this.Ng.moa(this.hSa)}m1(){}Ehd(){return 2}AKe(){return 2}BKe(){return 2}CKe(){return 2}JKe(){return 3}MKe(){}Jhd(){return 2}NKe(){}OKe(){}PKe(){return 2}Phd(){return 2}Qhd(){return 2}aLe(){return 2}Rhd(){}fLe(){return 2}Shd(){return 2}Uhd(){return 2}Xhd(){return 2}Zhd(){return 2}rLe(){}sLe(){return 2}bid(){return 2}did(){return 2}fid(){return 2}hid(){return 2}jid(){return 2}kid(){return 2}lid(){return 2}qid(){return 2}PLe(){return 2}Did(){return 2}VLe(){return 2}WLe(){}XLe(){return 2}Iid(){return 2}Jid(){return 2}Kid(){return 2}Lid(){return 2}Mid(){return 2}Nid(){return 2}aMe(){return 3}Oid(){}cMe(){return 2}Qid(){return 2}eMe(){return 3}Rid(){}hMe(){}Tid(){return 2}oMe(){return 3}Uid(){return 2}Wid(){return 2}Yid(){return 2}Zid(){return 2}sMe(){}tMe(){return 3}cjd(){return 2}XIb(){return 2}wMe(){}zMe(){return 2}AMe(){return 2}BMe(){return 3}jjd(){return 2}CMe(){return 2}njd(){return 2}qjd(){return 2}DMe(){}Cjd(){return 2}LMe(){return 2}Kjd(){return 2}Ljd(){return 2}WMe(){return 3}XMe(){return 2}Ujd(){return 2}Vjd(){return 2}Wjd(){return 2}Xjd(){return 2}cNe(){return 3}Yjd(){return 2}$jd(){return 2}dkd(){return 2}fNe(){return 2}knc(){return 2}hNe(){return 2}iNe(){return 2}ekd(){return 2}jNe(){return 2}lNe(){return 3}fkd(){return 2}ikd(){return 2}jkd(){return 2}kkd(){return 2}mkd(){return 2}static hua(a){return a&&
-1!==a.indexOf("px")&&(a=parseInt(ma.a.substring(a,0,a.indexOf("px"))),!isNaN(a))?a:0}static nsj(a){if(!a||""===a)return-1;const b=ma.a.rg(a);if(-1!==b.indexOf("pt")){if(a=parseFloat(ma.a.substring(a,0,b.indexOf("pt"))),!isNaN(a))return a}else if(-1!==b.indexOf("px")&&(a=parseFloat(ma.a.substring(a,0,b.indexOf("px"))),!isNaN(a)))return 3*a/4;return-1}static z$f(a){return a&&""!==a?mh.hua(a):null}static Ly(a){let b=null,c=null,f=null,l=null;a&&a.Yf&&(b=mh.Xta(a.Yf,"id"),c=mh.Xta(a.Yf,"lang"),f=a.Yf.tagName,
a.Ali&&(l=Object.assign(new IH,{x:mh.hua(a.Yf.style.left),y:mh.hua(a.Yf.style.top),left:mh.z$f(a.Yf.style.left),top:mh.z$f(a.Yf.style.top)})),void 0===b&&(b=""),void 0===c&&(c=""));return new dn(new ku(b,f),a.xw,null,c,l)}static Xta(a,b){return a[b]}}Object(m.a)(mh,"AHtmlTranslator",null,[1315]);class KH extends dn{constructor(a,b,c,f=0,l=0,y=null){super(y?y.TU:null,y?y.xw:null,y?y.g6:null,y?y.cultureName:null,y?y.Wia:null);this.width=f;this.height=l}}Object(m.a)(KH,"AugmentationSemanticArgs",dn,
[]);class LH{constructor(){this.stop=this.color=null}}Object(m.a)(LH,"ColorStopPair",null,[]);class bz{constructor(a,b){this.value=a;this.r8i=b}get n1c(){return this.r8i}}Object(m.a)(bz,"ElementValueWrapper",null,[]);class MH extends bz{constructor(a,b,c){super(a,b);this.jrg=c}}Object(m.a)(MH,"DimensionWrapper",bz,[]);class gC{constructor(a=0,b=0,c=0,f=0,l="",y="",H="",Q="",ia="0pt",wa="0pt",Ua="0pt",kb="0pt"){this.borderTopStyle=a;this.borderRightStyle=b;this.borderBottomStyle=c;this.borderLeftStyle=
f;this.borderTopColor=l;this.borderRightColor=y;this.borderBottomColor=H;this.borderLeftColor=Q;this.borderTopWidth=ia;this.borderRightWidth=wa;this.borderBottomWidth=Ua;this.borderLeftWidth=kb}}Object(m.a)(gC,"TableCellBorderProperties",null,[]);class hC{constructor(a="",b="",c="",f=""){this.Uxi=a;this.Txi=b;this.Rxi=c;this.Sxi=f}}Object(m.a)(hC,"TableCellMarginProperties",null,[]);class Vg{static get gig(){return Vg.NZh}static get Kvd(){return Vg.A8h}static get Gvd(){return Vg.y8h}static gee(a,
b,...c){b=Vg.edg(b);let f=!1;b||(b=Vg.Hwj.apply(null,[a].concat(c)),f=!!b);return new bz(b,f)}static edg(a){for(const b of a)if(void 0!==b&&null!==b&&""!==b)return b.trim();return null}static Hwj(a,...b){for(const c of b)if(b=a.getAttribute(c),void 0!==b&&null!==b&&(b+="",void 0!==b&&null!==b&&""!==b))return b.trim();return null}static Pnj(a,b){b=parseFloat(b);if(isNaN(b))return 0;switch(a){case "px":return Math.round(b);case "pt":return Math.round(Fb.a.Daa(b,0,!1));case "in":return Math.round(Fb.a.P_(b,
0,!1));case "cm":return Math.round(Fb.a.P_(xe.a.WIf(b),0,!1));case "mm":return Math.round(Fb.a.P_(xe.a.WIf(.1*b),0,!1));default:return b}}static Zpd(a,b,...c){a=Vg.gee.apply(null,[a,b].concat(c));c=0;b=!1;if(a.value){b=a.value.endsWith("%");let f;b?(c="%",f=ma.a.substring(a.value,0,a.value.length-1)):a.n1c?(c="px",f=a.value):(c=a.value.substr(a.value.length-2),isNaN(parseFloat(c))?f=ma.a.substring(a.value,0,a.value.length-2):(c="px",f=a.value));c=Vg.Pnj(c,f)}return new MH(c,a.n1c,b)}static gzb(a){return Vg.Zpd(a,
[a.style.width],"width","WIDTH","Width")}static aab(a){return Vg.Zpd(a,[a.style.height],"height","HEIGHT","Height")}static fbe(a){return Vg.Zpd(a,[a.style.marginLeft],"leftmargin","LEFTMARGIN","LeftMargin")}static gbe(a){return Vg.Zpd(a,[a.style.marginRight],"rightmargin","RIGHTMARGIN","RightMargin")}static Nwj(a){a=Vg.gee(a,[a.style.verticalAlign],"vAlign","valign","VALIGN","VAlign");return a.value&&a.value in Vg.Kvd&&void 0!==Vg.Kvd[a.value]&&null!==Vg.Kvd[a.value]?Vg.Kvd[a.value]:0}static l4j(a){a=
Vg.edg([a.style.borderCollapse]);return!!a&&!(void 0===a||null===a)&&("collapse"===a||"COLLAPSE"===a||"Collapse"===a)}static Saj(a){return Vg.gee(a,[a.style.backgroundColor,a.style.background],"bgcolor","BGCOLOR","BgColor","BGColor").value}static fIi(a){const b=ma.a.substring(a,0,1),c=ma.a.substring(a,1,2);a=ma.a.substring(a,2,3);return b+b+c+c+a+a}static hda(a){let b="";if(!a||""===a)return b;b=a.trim();if(b.startsWith("rgb")){b=ma.a.substring(b,b.indexOf("(")+1,b.length-1);a=b.split(",");if(3!==
a.length)return"";b="";for(let f=0;f<a.length;f++){var c=parseInt(a[f]);if(isNaN(c)||0>c||255<c)return"";c=c.toString(16);1===c.length&&(c="0"+c);b+=c}return ma.a.nC(b)}if(Vg.gig[ma.a.rg(b)])return Vg.gig[ma.a.rg(b)];b.startsWith("#")&&(b=ma.a.substring(b,1,b.length));if(isNaN(parseInt(b,16)))return"";3===b.length&&(b=Vg.fIi(b));return 6!==b.length?"":b}static IMk(a){var b=a.indexOf("mso-tab-count");if(-1===b)return 0;const c=RegExp("([\\d])");let f="";for(b=b+13+1;b<a.length;b++){const l=a.charAt(b).toString();
if(c.test(l))f+=l;else break}a=0;""!==f&&(a=parseInt(f));return a}static kYc(a,b){const c=Vg.Saj(a);c&&""!==c&&b.Hq(f=>f.$rd(Vg.hda(c)))}static I4f(a){a=a.style;if(!a)return null;const b=Vg.Gvd[a.borderTopStyle],c=Vg.hda(a.borderTopColor),f=a.borderTopWidth,l=Vg.Gvd[a.borderRightStyle],y=Vg.hda(a.borderRightColor),H=a.borderRightWidth,Q=Vg.Gvd[a.borderBottomStyle],ia=Vg.hda(a.borderBottomColor),wa=a.borderBottomWidth,Ua=Vg.Gvd[a.borderLeftStyle],kb=Vg.hda(a.borderLeftColor);return new gC(b,l,Q,Ua,
c,y,ia,kb,f,H,wa,a.borderLeftWidth)}static Qbj(a){const b=a.firstChild;return(a=b&&b.className&&-1!==b.className.indexOf("TableCellContent")?a.firstChild.style:a.style)?new hC(a.paddingTop,a.paddingRight,a.paddingBottom,a.paddingLeft):null}}Vg.NZh=ta.a.eI("aliceblue","F0F8FF","antiquewhite","FAEBD7","aqua","00FFFF","aquamarine","7FFFD4","azure","F0FFFF","beige","F5F5DC","bisque","FFE4C4","black","000000","blanchedalmond","FFEBCD","blue","0000FF","blueviolet","8A2BE2","brown","A52A2A","burlywood",
"DEB887","cadetblue","5F9EA0","chartreuse","7FFF00","chocolate","D2691E","coral","FF7F50","cornflowerblue","6495ED","cornsilk","FFF8DC","crimson","DC143C","cyan","00FFFF","darkblue","00008B","darkcyan","008B8B","darkgoldenrod","B8860B","darkgray","A9A9A9","darkgrey","A9A9A9","darkgreen","006400","darkkhaki","BDB76B","darkmagenta","8B008B","darkolivegreen","556B2F","darkorange","FF8C00","darkorchid","9932CC","darkred","8B0000","darksalmon","E9967A","darkseagreen","8FBC8F","darkslateblue","483D8B",
"darkslategray","2F4F4F","darkslategrey","2F4F4F","darkturquoise","00CED1","darkviolet","9400D3","deeppink","FF1493","deepskyblue","00BFFF","dimgray","696969","dimgrey","696969","dodgerblue","1E90FF","firebrick","B22222","floralwhite","FFFAF0","forestgreen","228B22","fuchsia","FF00FF","gainsboro","DCDCDC","ghostwhite","F8F8FF","gold","FFD700","goldenrod","DAA520","gray","808080","grey","808080","green","008000","greenyellow","ADFF2F","honeydew","F0FFF0","hotpink","FF69B4","indianred","CD5C5C","indigo",
"4B0082","ivory","FFFFF0","khaki","F0E68C","lavender","E6E6FA","lavenderblush","FFF0F5","lawngreen","7CFC00","lemonchiffon","FFFACD","lightblue","ADD8E6","lightcoral","F08080","lightcyan","E0FFFF","lightgoldenrodyellow","FAFAD2","lightgray","D3D3D3","lightgrey","D3D3D3","lightgreen","90EE90","lightpink","FFB6C1","lightsalmon","FFA07A","lightseagreen","20B2AA","lightskyblue","87CEFA","lightslategray","778899","lightslategrey","778899","lightsteelblue","B0C4DE","lightyellow","FFFFE0","lime","00FF00",
"limegreen","32CD32","linen","FAF0E6","magenta","FF00FF","maroon","800000","mediumaquamarine","66CDAA","mediumblue","0000CD","mediumorchid","BA55D3","mediumpurple","9370D8","mediumseagreen","3CB371","mediumslateblue","7B68EE","mediumspringgreen","00FA9A","mediumturquoise","48D1CC","mediumvioletred","C71585","midnightblue","191970","mintcream","F5FFFA","mistyrose","FFE4E1","moccasin","FFE4B5","navajowhite","FFDEAD","navy","000080","oldlace","FDF5E6","olive","808000","olivedrab","6B8E23","orange","FFA500",
"orangered","FF4500","orchid","DA70D6","palegoldenrod","EEE8AA","palegreen","98FB98","paleturquoise","AFEEEE","palevioletred","D87093","papayawhip","FFEFD5","peachpuff","FFDAB9","peru","CD853F","pink","FFC0CB","plum","DDA0DD","powderblue","B0E0E6","purple","800080","red","FF0000","rosybrown","BC8F8F","royalblue","4169E1","saddlebrown","8B4513","salmon","FA8072","sandybrown","F4A460","seagreen","2E8B57","seashell","FFF5EE","sienna","A0522D","silver","C0C0C0","skyblue","87CEEB","slateblue","6A5ACD",
"slategray","708090","slategrey","708090","snow","FFFAFA","springgreen","00FF7F","steelblue","4682B4","tan","D2B48C","teal","008080","thistle","D8BFD8","tomato","FF6347","turquoise","40E0D0","violet","EE82EE","wheat","F5DEB3","white","FFFFFF","whitesmoke","F5F5F5","yellow","FFFF00","yellowgreen","9ACD32");Vg.A8h=ta.a.eI("",0,"unset",1,"top",1,"middle",2,"bottom",3,"start",2,"baseline",1,"sub",3,"super",1,"initial",1,"inherit",2,"text-top",1,"text-bottom",3);Vg.y8h=ta.a.eI("",0,"initial",3,"inherit",
11,"nil",1,"dotted",5,"dashed",4,"solid",11,"double",6,"groove",7,"ridge",10,"inset",8,"outset",9,"none",1,"hidden",2);Object(m.a)(Vg,"DefaultHtmlTranslatorHelper",null,[]);class NH{constructor(){this.direction=null;this.l2b=new ju}Agg(){return!!this.direction&&0<this.direction.length}}Object(m.a)(NH,"LinearGradient",null,[]);class iC{constructor(){this.Uoe=this.Dac=!1}}Object(m.a)(iC,"HtmlTranslatorContext",null,[]);class jC{constructor(a=!1,b=!1,c=!1,f=!1,l=!1,y=!1,H=!0,Q=!1,ia=!0,wa=!0,Ua=!0,kb=
!1,Gb=!1,ec=!1,dc=!1,Fc=!1,yc=!1,tc=!1,xd=!1,Vd=null,Ld=null,ye=null,Xd=null,Xf=null,ug=null,qg=null){this.Dac=!1;this.hul=Fg=>this.Voe&&Fg.Uoe;this.h4h=a;this.m4h=b;this.e4h=c;this.l4h=f;this.d7h=l;this.b7h=y;this.X6h=H;this.Y6h=Q;this.$6h=ia;this.a7h=wa;this.Z6h=Ua;this.m7h=kb;this.A7h=Gb;this.l7h=ec;this.p8h=dc;this.g7h=Fc;this.l_h=yc;this.X_h=tc;this.BCc=xd;this.f7h=Vd;this.k7h=Ld;this.c7h=ug;this.i7h=Xd;this.e7h=Xf;this.h7h=qg;this.j7h=ye}get C_a(){return this.h4h}get ANk(){return this.m4h}get Beh(){return this.e4h}get zNk(){return this.l4h}get tAh(){return this.d7h}get sAh(){return this.b7h}get hsl(){return this.X6h}get isl(){return this.Y6h}get ksl(){return this.$6h}get msl(){return this.a7h}get jsl(){return this.Z6h}get O1a(){return this.g7h}get APj(){return this.l_h}get xAh(){return this.m7h}get Ytl(){return this.A7h}get usl(){return this.l7h}get ACl(){return this.p8h}get IVa(){return this.X_h}get Voe(){return this.BCc}get uAh(){return this.f7h||
Object(I.a)(this,this.bqd,"returnFalse")}get tsl(){return this.k7h||Object(I.a)(this,this.bqd,"returnFalse")}get ssl(){return this.i7h||Object(I.a)(this,this.lXe,"returnTrue")}get osl(){return this.e7h||Object(I.a)(this,this.lXe,"returnTrue")}get nsl(){return this.c7h||Object(I.a)(this,this.bqd,"returnFalse")}get rsl(){return this.h7h||Object(I.a)(this,this.lXe,"returnTrue")}get wAh(){return this.j7h||this.hul||Object(I.a)(this,this.bqd,"returnFalse")}lXe(){return!0}bqd(){return!1}}Object(m.a)(jC,
"HtmlTranslatorSettings",null,[348]);class OH extends dn{constructor(a,b,c,f,l=null,y=0,H=0,Q=null,ia=null){super(l?l.TU:null,l?l.xw:null,l?l.g6:null,l?l.cultureName:null,l?l.Wia:null);this.src=a;this.alt=b;this.width=c;this.height=f;this.maxWidth=y;this.maxHeight=H;this.href=Q;this.desc=ia}}Object(m.a)(OH,"ImageSemanticArgs",dn,[]);class PH{constructor(a,b){this.zzl=a;this.yzl=b}}Object(m.a)(PH,"IndentationProperties",null,[]);class ux extends dn{constructor(a,b,c,f=0,l=-1,y=!1,H=!1,Q="",ia="",wa=
null,Ua=-1){super(c?c.TU:null,c?c.xw:null,c?c.g6:null,c?c.cultureName:null,c?c.Wia:null);this.cpf=a;this.kWb=0;this.ZOd=b;this.mVb=1===b&&-1===l&&!this.s4a;this.mJd=f;this.nJd=l;this.KLd=y;this.s4a=H;this.k5a=Q;this.xpb=ia;this.$yc=wa;this.Jyc=Ua;this.Vob=-1;this.NHc=!0}get listStyleType(){return this.lZj?this.kWb:this.cpf}get lZj(){return 0!==this.kWb}get SAl(){return this.ZOd}get listLevel(){return this.nJd}set listLevel(a){this.nJd=a}get listId(){return this.mJd}set listId(a){this.mJd=a}get LJb(){return this.KLd}set LJb(a){this.KLd=
a}get $9a(){return this.s4a}set $9a(a){this.s4a=a}get levelText(){return this.k5a}set levelText(a){this.k5a=a}get font(){return this.xpb}set font(a){this.xpb=a}get BRa(){return this.$yc}set BRa(a){this.$yc=a}get Ttb(){return this.Jyc}set Ttb(a){this.Jyc=a}get spg(){return 6<=this.listStyleType}get bTj(){return this.mVb}get yQi(){return this.NHc?this.ZOd+this.Vob:this.Vob}clone(){const a=new ux(this.cpf,this.ZOd,new dn(this.TU,this.xw,this.g6,this.cultureName,this.Wia),this.mJd,this.nJd,this.KLd,this.s4a);
a.kWb=this.kWb;a.mVb=this.mVb;a.Vob=this.Vob;a.NHc=this.NHc;a.k5a=this.k5a;a.xpb=this.xpb;a.$yc=this.$yc;a.Jyc=this.Jyc;return a}$li(a,b,c){this.kWb=a;0<b?(this.mVb=!1,this.Vob=b,this.NHc=!1):(this.Vob++,this.mVb=!c)}}Object(m.a)(ux,"ListSemanticArgs",dn,[]);class cz extends dn{constructor(a,b,c,f,l=null,y=0,H=null,Q=null,ia=!1,wa=!1,Ua=69905,kb=null){super(kb?kb.TU:null,kb?kb.xw:null,kb?kb.g6:null,kb?kb.cultureName:null,kb?kb.Wia:null);this.colSpan=a;this.rowSpan=b;this.width=c;this.NBb=wa;this.height=
f;this.pGa=ia;this.ntc=l;this.verticalAlignment=y;this.M6=H;this.Hvd=Q;this.ZLc=Ua}}Object(m.a)(cz,"TableCellSemanticArgs",dn,[]);class kC extends dn{constructor(a,b=null){super(b?b.TU:null,b?b.xw:null,b?b.g6:null,b?b.cultureName:null,b?b.Wia:null);this.height=a}}Object(m.a)(kC,"TableRowSemanticArgs",dn,[]);class lC extends dn{constructor(a,b,c,f,l,y,H,Q,ia,wa=null,Ua=-1,kb=null){super(kb?kb.TU:null,kb?kb.xw:null,kb?kb.g6:null,kb?kb.cultureName:null,kb?kb.Wia:null);this.KRa=null;this.dV=a;this.Bsa=
b;this.width=c;if(l)for(this.KRa=Array(l.length),a=0;a<l.length;++a)this.KRa[a]=l[a];this.rmg=y;this.Z4e=Q;this.uTj=H;this.pGa=f;this.Ihe=ia;this.QFh=wa;this.tableLook=Ua}}Object(m.a)(lC,"TableSemanticArgs",dn,[]);let fs;class xl extends mh{constructor(a,b=null,c=null,f=null){super(a);this.p5a=null;this.Q1h=ta.a.eI("none",1,"disc",3,"circle",4,"square",5,"1",7,"A",10,"a",8,"I",11,"i",9,"armenian",7,"decimal",7,"decimal-leading-zero",7,"georgian",7,"lower-alpha",8,"lower-greek",8,"lower-latin",8,"lower-roman",
9,"upper-alpha",10,"upper-latin",10,"upper-roman",11);this.Yc=b||new jC;this.Ot=c||new iC;this.pJd=f}get nvg(){return this.Q1h}T8f(a,b){var c;if((c=a.style?a.style.listStyleType:"")&&""!==c&&(c=this.nvg[ma.a.rg(c)])||(c=mh.Xta(a,"type"))&&""!==c&&(c=this.nvg[c]))return c;if(this.Yc.C_a&&(c=a.tagName.toLowerCase())&&("ol"===c||"ul"===c)&&(a=a.className)&&""!==a)if("ul"===c)switch(a=xl.DXc(a,"BulletListStyle"),a){case "BulletListStyle1":return 3;case "BulletListStyle2":return 4;case "BulletListStyle3":return 5}else if("ol"===
c)switch(a=xl.DXc(a,"NumberListStyle"),a){case "NumberListStyle1":return 7;case "NumberListStyle2":return 8;case "NumberListStyle3":return 9;case "NumberListStyle4":return 10;case "NumberListStyle5":return 11}return b}M8f(a){let b=-1,c=a.tagName.toLowerCase();if("ol"===c||"ul"===c){a=Ea.a.X6f(a,"li");if(!a)return b;c="li"}if("li"===c){b=(b=this.gUc(a,"data-aria-level",0))?b:-1;if(0<b)return b-1;if(a=Ea.a.X6f(a,"p"))return xl.okj(a)-1}return b}gUc(a,b,c){a=this.Yc.C_a?a.getAttribute(b):mh.Xta(a,b);
a=parseInt(a);return isNaN(a)||0>a?c:a}GEk(){this.p5a.pop();this.Ng.poa()}r9b(a,b){this.Hq(l=>l.QLa(0,0));const c=this.T8f(a.Yf,b?6:2);let f=1;b&&(f=this.gUc(a.Yf,"start",1));b=!1;this.Yc.C_a&&(b=a.Yf.getAttribute("data-pasteFromRc"),(b=!!b&&"true"===b)&&a.Yf.removeAttribute("data-pasteFromRc"),(z.a.bU||z.a.gg)&&xl.AMc(a.Yf));a=new ux(c,f,mh.Ly(a),0,-1,b,this.Yc.C_a);this.p5a.push(a);this.Ng.roa(a);this.ED(Object(I.a)(this,this.GEk,"onListElementClose"));return 1}reset(){super.reset();this.p5a=new tx}Ewh(a,
b){let c=!1;try{var f=b.getAttribute("xml:lang")||mh.Xta(b,"lang")}catch(ia){f=null}f&&""!==f&&(c=a.b_e(f)||c);(f=mh.Xta(b,"dir"))&&(c=a.dOb(f)||c);f=b.style;var l=this.Yc.Voe&&this.Ot.Uoe;if(f){if(f.fontWeight){var y=ma.a.nC(f.fontWeight),H=parseInt(y);isNaN(H)?"BOLD"===y?c=a.$H(!0)||c:"NORMAL"===y&&(c=a.$H(!1)||c):c=600<=H?a.$H(!0)||c:a.$H(!1)||c}this.Yc.sAh&&f.fontSize&&!l&&(y=Math.round(mh.nsj(f.fontSize)),0<y&&(c=a.rNb(Math.floor(2*y))||c));this.Yc.ssl(this.Ot)&&(this.Yc.xAh&&b.getAttribute?
(y=b.getAttribute("data-indent"))&&0<y.length&&(y=Fb.a.vK(parseInt(y),0)+"px",c=a.Usd(y)||c):f.textIndent&&(c=a.Usd(f.textIndent)||c));this.Yc.osl(this.Ot)&&f.marginLeft&&(this.Yc.xAh&&b.getAttribute?(y=b.getAttribute("data-margin"))&&0<y.length&&(c=a.Psc(f.marginLeft)||c):"TABLE"!==b.tagName&&(c=a.Psc(f.marginLeft)||c));this.Yc.nsl(this.Ot)&&f.lineHeight&&(c=a.R1(f.lineHeight)||c);if(this.Yc.jsl)if(y=f.fontVariantCaps?ma.a.rg(f.fontVariantCaps):null,H=f.fontVariant?ma.a.rg(f.fontVariant):null,"uppercase"===
(f.textTransform?ma.a.rg(f.textTransform):null))c=a.Tsd("uppercase")||c;else if("small-caps"===y||H&&0<=H.indexOf("small-caps"))c=a.Tsd("small-caps")||c;this.Yc.rsl(this.Ot)&&f.textAlign&&(c=a.vlb(ma.a.rg(f.textAlign))||c);f.fontStyle&&(y=ma.a.nC(f.fontStyle),"ITALIC"===y||"OBLIQUE"===y?c=a.t1a(!0)||c:"NORMAL"===y&&(c=a.t1a(!1)||c));y=xl.Kuj(b);if(f.textDecoration||y){H=ma.a.rg(f.textDecoration||"");y=ma.a.rg(y||"");if(b.parentNode&&b.parentNode.tagName&&"a"===ma.a.rg(b.parentNode.tagName)){var Q=
(b.querySelector(".TextRun")||b).className;Q&&-1<Q.indexOf("Underlined")&&(c=a.VY(!0)||c)}else if(f.YYl||xl.xE(H)||xl.xE(y))c=a.VY(!0)||c;if(f.XYl||xl.rpg(H)||xl.rpg(y))c=a.TY(!0)||c}if(f.verticalAlign){y=ma.a.nC(f.verticalAlign);if("SUB"===y||this.Yc.wAh(this.Ot)&&b.className&&-1<b.className.indexOf("Subscript"))c=a.A6(!0)||c;else if("SUPER"===y||this.Yc.wAh(this.Ot)&&b.className&&-1<b.className.indexOf("Superscript"))c=a.UY(!0)||c;this.Yc.sAh&&("SUB"===y||"SUPER"===y)&&b.getAttribute&&(y=parseFloat(b.getAttribute("data-fontsize")),
isNaN(y)||(c=a.TZe(Math.floor(2*y))||c))}this.Yc.msl&&f.fontFamily&&!l&&(this.Yc.IVa?c=this.SZe(a,f.fontFamily,c):this.Yc.usl&&b.getAttribute?(y=b.getAttribute("data-usefontface"))&&"true"===y&&(c=this.SZe(a,f.fontFamily,c)):c=this.SZe(a,f.fontFamily,c));y=null;this.Yc.ksl&&f.color&&(y=Vg.hda(f.color));H=!!y;this.Yc.tsl(this.Ot)&&b.getAttribute&&(H=b.getAttribute("data-scheme-color"),y=null!==H?H:y,H="inherit"!=f.color&&(""!==y||!this.Ot.Dac||xl.I4j(b))&&!l);H&&(c=a.sr(y)||c);this.Yc.hsl&&!this.Ot.Dac&&
f.backgroundColor&&!l&&(this.Yc.ANk&&b.tagName&&xl.nEl.contains(ma.a.nC(b.tagName))||(c=a.ppa(Vg.hda(f.backgroundColor))||c));if(this.Yc.isl&&f.backgroundImage&&b.className&&-1<b.className.indexOf("Highlight")&&!l&&(l=xl.Iwj(f.backgroundImage))&&0<l.l2b.count){y=l.l2b.ga(0).color;H=!0;for(Q=0;Q<l.l2b.count&&(H=H&&y===l.l2b.ga(Q).color,H);Q++);H&&(ka.ULS.sendTraceTag(41707206,307,50,"Paste text with highlight"),c=a.ppa(Vg.hda(y))||c)}}this.Yc.uAh(this.Ot)&&b.getAttribute&&(l=b.getAttribute("data-ccp-props"))&&
(c=a.rpa(l)||c);if(b.getAttribute){if(l=b.getAttribute("data-ccp-charstyle"))w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordCopyPasteParagraphCharacterStyleIdSettings"),this.Yc.O1a&&(c=a.Jga(l)||c);if(l=b.getAttribute("data-ccp-parastyle"))w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordCopyPasteParagraphCharacterStyleIdSettings"),this.Yc.O1a&&(c=a.ysd(l)||c);"true"==b.getAttribute("data-hyperlinkhascustomcolor")&&(ka.ULS.sendTraceTag(508900183,307,
50,"Paste hyperlink with custom color"),b=null,f.color&&(b=Vg.hda(f.color),a.s1a(!1)),c=a.sr(b)||c)}return c}Xtl(a){if(this.Yc.Ytl)for(a=a.parentNode;a&&a.tagName;){if(a.className&&Object.getType(a.className)===String&&-1<ma.a.nC(a.className).indexOf("MSOCOM"))return!0;if("DIV"===ma.a.nC(a.tagName))break;a=a.parentNode}return!1}SZe(a,b,c){b=this.l7f(b);return a.JLa(b,this.Yc.ACl)||c}m1(a,b){"\u200b"===a&&(a="\u00a0");b&&b.Yf&&this.Xtl(b.Yf)&&(a="");this.Ng.m1(a,mh.Ly(b))}Ehd(a){const b=mh.Xta(a.Yf,
"href");return b&&""!==b?(this.Ng.Gxa(b,mh.Ly(a)),this.ED(Object(I.a)(this.Ng,this.Ng.Fxa,"onAnchorEnd")),1):2}Jhd(){return this.Hq(a=>a.$H(!0))?1:2}Phd(){return this.Hq(a=>a.Nee())?1:2}Qhd(a){this.Ng.NA(mh.Ly(a));this.ED(Object(I.a)(this.Ng,this.Ng.MA,"onParagraphEnd"));return 1}Rhd(a){this.Ng.ooa(mh.Ly(a))}Shd(a){this.Ng.NA(mh.Ly(a));this.ED(Object(I.a)(this.Ng,this.Ng.MA,"onParagraphEnd"));return 1}Xhd(){return this.Hq(a=>a.t1a(!0))?1:2}Uhd(a){this.Hq(b=>b.vlb("center"));this.Ng.NA(mh.Ly(a));this.ED(Object(I.a)(this.Ng,
this.Ng.MA,"onParagraphEnd"));return 1}Zhd(){return this.Hq(a=>a.JLa("consolas"))?1:2}did(){return this.Hq(a=>a.TY(!0))?1:2}bid(a){return this.r9b(a,!1)}fid(){return this.Hq(a=>a.t1a(!0))?1:2}hid(a){return this.r9b(a,!1)}jid(a){var b=a.Yf.getAttribute("data-render-src");const c=a.Yf.getAttribute("data-render-method");if(b&&""!==b&&c&&""!==c){const H=a.Yf.getAttribute("data-render-fallback");let Q=0,ia=0;if(a.Yf.currentStyle){var f=a.Yf.currentStyle.width,l=a.Yf.currentStyle.height;f&&-1!==f.indexOf("px")&&
(f=parseInt(ma.a.substring(f,0,f.indexOf("px"))),isNaN(f)||(Q=f));l&&-1!==l.indexOf("px")&&(l=parseInt(ma.a.substring(l,0,l.indexOf("px"))),isNaN(l)||(ia=l))}a=new KH(b,c,H,Q,ia,mh.Ly(a));this.Ng.r_a(a);return 2}this.Yc.C_a&&(z.a.bU||z.a.gg)&&(b=a.Yf.className.match(RegExp("^SCX[0-9a-zA-Z]+$")),this.Yc.C_a&&b&&b.length&&xl.AMc(a.Yf));const y=a.Yf.getAttribute("align");this.Hq(H=>H.vlb(y));this.Ng.NA(mh.Ly(a));this.ED(Object(I.a)(this.Ng,this.Ng.MA,"onParagraphEnd"));return 1}kid(a){this.Ng.NA(mh.Ly(a));
this.ED(Object(I.a)(this.Ng,this.Ng.MA,"onParagraphEnd"));return 1}lid(a){this.Ng.NA(mh.Ly(a));this.ED(Object(I.a)(this.Ng,this.Ng.MA,"onParagraphEnd"));return 1}qid(){return this.Hq(a=>a.t1a(!0))?1:2}Did(a){return this.Hq(b=>{var c=this.l7f(a.Yf.getAttribute("face"));c=b.JLa(c);b=b.sr(Vg.hda(a.Yf.getAttribute("color")));return c||b})?1:2}Iid(a){this.Hq(b=>this.Yc.O1a?b.z1a(1):b.A1a(1));this.Ng.NA(mh.Ly(a));this.ED(Object(I.a)(this.Ng,this.Ng.MA,"onParagraphEnd"));return 1}Jid(a){this.Hq(b=>this.Yc.O1a?
b.z1a(2):b.A1a(2));this.Ng.NA(mh.Ly(a));this.ED(Object(I.a)(this.Ng,this.Ng.MA,"onParagraphEnd"));return 1}Kid(a){this.Hq(b=>this.Yc.O1a?b.z1a(3):b.A1a(3));this.Ng.NA(mh.Ly(a));this.ED(Object(I.a)(this.Ng,this.Ng.MA,"onParagraphEnd"));return 1}Lid(a){this.Hq(b=>this.Yc.O1a?b.z1a(4):b.A1a(4));this.Ng.NA(mh.Ly(a));this.ED(Object(I.a)(this.Ng,this.Ng.MA,"onParagraphEnd"));return 1}Mid(a){this.Hq(b=>this.Yc.O1a?b.z1a(5):b.A1a(5));this.Ng.NA(mh.Ly(a));this.ED(Object(I.a)(this.Ng,this.Ng.MA,"onParagraphEnd"));
return 1}Nid(a){this.Hq(b=>this.Yc.O1a?b.z1a(6):b.A1a(6));this.Ng.NA(mh.Ly(a));this.ED(Object(I.a)(this.Ng,this.Ng.MA,"onParagraphEnd"));return 1}Oid(a){this.Ng.ooa(mh.Ly(a))}Rid(a){var b=a.Yf;const c=b.src,f=b.alt,l=b.MXl;let y=0,H=0;b.style&&(y=mh.hua(b.style.width),H=mh.hua(b.style.height));y&&H||(y=b.width,H=b.height);let Q=b=0;a.Yf.currentStyle&&(y||H||(y=mh.hua(a.Yf.currentStyle.width),H=mh.hua(a.Yf.currentStyle.height)),b=mh.hua(a.Yf.currentStyle.maxWidth),Q=mh.hua(a.Yf.currentStyle.maxHeight));
a=new OH(c,f,y,H,mh.Ly(a),b,Q,l);this.Ng.noa(a)}Qid(){return this.Hq(a=>a.t1a(!0))?1:2}Tid(){return this.Hq(a=>a.VY(!0))?1:2}Uid(){return this.Hq(a=>a.JLa("consolas"))?1:2}Wid(a){this.Ng.NA(mh.Ly(a));this.ED(Object(I.a)(this.Ng,this.Ng.MA,"onParagraphEnd"));return 1}Yid(a){this.Ng.NA(mh.Ly(a));this.ED(Object(I.a)(this.Ng,this.Ng.MA,"onParagraphEnd"));return 1}Zid(a){let b;const c=this.T8f(a.Yf,0);let f=this.gUc(a.Yf,"value",0);var l=!1;0<this.p5a.count?b=this.p5a.peek():(b=new ux(2,1,mh.Ly(a)),f||
(f=1));if(this.Yc.C_a){l=b.listLevel;let ia=b.listId;this.Yc.tAh?(l=this.M8f(a.Yf),l=0>l&&0>b.listLevel&&0<this.p5a.count?b.listLevel=this.p5a.count-1:b.listLevel=0<=l?l:b.listLevel,this.pJd&&this.pJd.b<l&&(this.pJd.b=l)):0>l&&(l=b.listLevel=this.M8f(a.Yf));1>ia&&(ia=b.listId=this.gUc(a.Yf,"data-listid",0));a.Yf.getAttribute("data-leveltext")&&(b.levelText=a.Yf.getAttribute("data-leveltext"));var y=a.Yf.getAttribute("data-font");y&&(b.font=y);y=!1;w.AFrameworkApplication.fa&&(y=w.AFrameworkApplication.fa.ka("FollowDestinationThemePasteIsEnabled"));
if(y){var H=a.Yf.getAttribute("data-charcodes");y=[];if(H&&""!==H)if(-1<H.indexOf(",")){H=H.split(",");for(var Q=0;Q<H.length;Q++)Array.add(y,parseInt(H[Q]))}else Array.add(y,parseInt(H));if(y&&0<y.length){H=Array(y.length);for(Q=0;Q<y.length;Q++)H[Q]=y[Q];b.BRa=H}(y=a.Yf.getAttribute("data-buAutoNum"))&&0<y.length&&(b.Ttb=parseInt(y))}(l=0<=l&&0<ia)&&xl.AMc(a.Yf)}b.$li(c,f,l);this.Ng.Kxa(b.clone());this.ED(Object(I.a)(this.Ng,this.Ng.qoa,"onListItemEnd"));return 1}XIb(a){return this.r9b(a,!1)}cjd(a){if(this.Hq(b=>
b.LNb(!0))){const b=a.Yf.getAttribute("OuterHtml");this.Ng.Lxa(b,mh.Ly(a));this.ED(Object(I.a)(this.Ng,this.Ng.YJa,"onMathEnd"))}return 1}jjd(a){return this.r9b(a,!0)}njd(a){this.Ng.NA(mh.Ly(a));this.ED(Object(I.a)(this.Ng,this.Ng.MA,"onParagraphEnd"));return 1}qjd(a){const b=a.Yf.getAttribute("align");this.Hq(c=>c.vlb(b));if(this.Yc.C_a){const c=a.Yf.parentNode;c&&c.tagName.toLowerCase().startsWith("li")&&xl.AMc(a.Yf,z.a.bU||z.a.gg)}this.Ng.NA(mh.Ly(a));this.ED(Object(I.a)(this.Ng,this.Ng.MA,"onParagraphEnd"));
return 1}Cjd(){this.Hq(a=>a.JLa("consolas"));this.Ng.q_a();this.ED(Object(I.a)(this.Ng,this.Ng.p_a,"onPreFormattedTextEnd"));return 1}Kjd(){return this.Hq(a=>a.TY(!0))?1:2}Ljd(){return this.Hq(a=>a.JLa("consolas"))?1:2}Ujd(){return this.Hq(a=>a.H2e())?1:2}Vjd(a){var b=a.Yf.attributes.getNamedItem("style"),c="";b&&b.value&&(c=b.value);b=Vg.IMk(c);if(0<b&&this.Yc.APj){for(c=0;c<b;c++)this.Ng.u_a(mh.Ly(a));return 3}return 2}Wjd(){return this.Hq(a=>a.TY(!0))?1:2}Xjd(){return this.Hq(a=>a.$H(!0))?1:2}Yjd(){return this.Hq(a=>
a.A6(!0))?1:2}$jd(){return this.Hq(a=>a.UY(!0))?1:2}dkd(a){this.Hq(Ua=>Ua.clearFormatting()&&Ua.KWe());Vg.kYc(a.Yf,this);const b=Vg.gzb(a.Yf),c=Vg.I4f(a.Yf),f=Vg.fbe(a.Yf),l=Vg.gbe(a.Yf),y=!parseInt(mh.Xta(a.Yf,"border")),H=Vg.l4j(a.Yf);let Q=-1,ia="";var wa=-1;a.Yf.attributes.hasOwnProperty("style")&&-1!==(wa=a.Yf.attributes.getNamedItem("style").value.indexOf("mso-yfti-tbllook:"))?Q=parseInt(a.Yf.attributes.getNamedItem("style").value.substr(wa+17)):a.Yf.attributes.hasOwnProperty(va.a.p2d.toString())&&
(Q=parseInt(a.Yf.attributes.getNamedItem(va.a.p2d.toString()).value));wa=-1;a.Yf.attributes.hasOwnProperty("class")&&-1!==(wa=a.Yf.attributes.getNamedItem("class").value.indexOf("Mso"))?ia=a.Yf.attributes.getNamedItem("class").value.substr(wa).split(" ")[0]:a.Yf.attributes.hasOwnProperty(va.a.q2d.toString())&&(ia=a.Yf.attributes.getNamedItem(va.a.q2d.toString()).value);this.Ng.zY(new lC(0,0,b.value,b.jrg,null,y,H,c,new PH(f.value,l.value),ia,Q,mh.Ly(a)));this.ED(Object(I.a)(this.Ng,this.Ng.wY,"onTableEnd"));
w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordPasteTableCellMarginImprovementsSettings");return 1}knc(a){const b=Vg.aab(a.Yf),c=Vg.gzb(a.Yf);if(!c.value&&c.n1c&&(w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this.Yc.Beh))return 3;let f=parseInt(mh.Xta(a.Yf,"colSpan"));if(void 0===f||null===f||""===f+"")f=c.value?1:0;let l=parseInt(mh.Xta(a.Yf,"rowSpan"));if(void 0===l||null===l||""===l+"")l=b.value?1:0;let y=!1;a.Yf.attributes.hasOwnProperty("style")&&
(y=-1!==a.Yf.attributes.getNamedItem("style").value.indexOf("mso-cell-special:placeholder")||-1!==a.Yf.attributes.getNamedItem("style").value.indexOf("mso-cell-special: placeholder"));!y&&a.Yf.attributes.hasOwnProperty("class")&&(y=-1!==a.Yf.attributes.getNamedItem("class").value.indexOf("SkippedGhostCell"));let H=69905;if(a.Yf.attributes.hasOwnProperty(va.a.o2d.toString())){var Q=parseInt(a.Yf.attributes.getNamedItem(va.a.o2d.toString()).value);isNaN(Q)||(H=Q)}Q=Vg.hda(a.Yf.style.backgroundColor);
const ia=Vg.Nwj(a.Yf);this.Hq(kb=>kb.QLa(0,0));Vg.kYc(a.Yf,this);const wa=Vg.I4f(a.Yf),Ua=this.Yc.zNk?Vg.Qbj(a.Yf):null;a=new cz(f,l,c.value,b.value,Q,ia,wa,Ua,c.jrg,y,H,mh.Ly(a));this.Ng.vY(a);this.ED(Object(I.a)(this.Ng,this.Ng.uY,"onTableCellEnd"));this.dzk();return 1}ekd(a){const b=this.knc(a);if(3===b)return b;this.Hq(c=>{const f=c.$H(!0);c=c.vlb("center");return f||c});Vg.kYc(a.Yf,this);return 1}fkd(a){Vg.kYc(a.Yf,this);const b=Vg.aab(a.Yf);if(b.n1c&&!b.value&&(w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),
this.Yc.Beh))return 3;this.Ng.yY(new kC(b.value,mh.Ly(a)));this.ED(Object(I.a)(this.Ng,this.Ng.xY,"onTableRowEnd"));return 1}ikd(){return this.Hq(a=>a.JLa("consolas"))?1:2}jkd(){return this.Hq(a=>a.VY(!0))?1:2}kkd(a){return this.r9b(a,!1)}mkd(){return this.Hq(a=>a.VY(!0))?1:2}qgj(a){if(!a)return null;a=a.split(",");return this.Yc.IVa&&a[0].startsWith("WordVisi")&&1<a.length?a[1].trim():a[0]}static UIl(a){if(!a)return null;a=ma.a.lVe(a,'"');return a=ma.a.lVe(a,"'")}l7f(a){if(!a)return null;a=this.qgj(a);
return a=xl.UIl(a)}static vyf(a,b){b=b.trim();var c=b.match(RegExp("^-?[0-9]+deg$"));if(c&&0<c.length){if(a.Agg())return!1;a.direction=b;return!0}if((c=b.match(RegExp("^to +(left|right|top|bottom|lefttop|leftbottom|righttop|rightbottom)$")))&&0<c.length){if(a.Agg())return!1;a.direction=b;return!0}var f=(c=b.match(RegExp("^rgb\\(.*\\)")))&&0<c.length?b.indexOf(")")+1:b.indexOf(" ");c=-1===f?b:Vg.hda(b.substr(0,f).trim());if(!c||""===c)return!1;b=-1===f?"":b.substr(f).trim();f=new LH;f.color=c;f.stop=
b;a.l2b.add(f);return!0}static Iwj(a){try{if(!a)return null;a=a.trim();if(!a.startsWith("linear-gradient(")||!a.endsWith(")"))return null;let b=a.substr(16);b=b.substr(0,b.lastIndexOf(")"));const c=new NH;for(;0<b.trim().length;){let f=b.indexOf(",");const l=b.indexOf("(");if(0<l&&l<f){const y=b.indexOf(")");if(y<l)return null;f=b.indexOf(",",y)}if(-1===f){if(!xl.vyf(c,b))return null;b=""}else{const y=b.substr(0,f);b=b.substr(f+1);if(!xl.vyf(c,y))return null}}return c}catch(b){return null}}static DXc(a,
b){a=a.split(" ");if(0<a.length)for(let c=0;c<a.length;c++)if(0<=a[c].indexOf(b))return a[c];return""}static AMc(a,b=!1){a&&3!==a.nodeType&&(a.style.margin="",b&&xl.mKf(a,b))}static mKf(a,b){if(a)for(a=a.firstChild;a;)3!==a.nodeType&&(a.style&&(a.style.margin=""),b&&xl.mKf(a,b)),a=a.nextSibling}static okj(a){if("p"!==a.tagName.toLowerCase())return-1;if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf("mso-list")){a=a.split(";");for(let c=0;c<a.length;c++){var b=a[c].split(":");if(2===b.length&&
"mso-list"===b[0].trim()&&(b=b[1].trim().split(" "),3===b.length))return Number.parseInvariant(b[1].substr(5))}}return-1}static I4j(a){return!(void 0===a.className||null===a.className)&&a.className.startsWith("TextRun")}static Kuj(a){a=a.style.textDecorationLine;return void 0===a||null===a?null:a}static rpg(a){return 0<=a.indexOf("line-through")}static xE(a){return 0<=a.indexOf("underline")}}xl.nEl=(fs=new Na.a,fs.add("TABLE"),fs.add("THEAD"),fs.add("TBODY"),fs.add("TFOOT"),fs.add("TR"),fs.add("TH"),
fs.add("TD"),fs);Object(m.a)(xl,"DefaultHtmlTranslator",mh,[]);var Om=d(314);class gk{constructor(a=null){this.VS=a||Om.a.oee("");this.VDc=Number.parseInvariant((new Date).format("HHmmss"))}get Ob(){return this.VS}process(a,b){if(a&&a.querySelectorAll){const y=a.querySelectorAll("p");if(y&&0<y.length){for(var c=0,f=!1,l=y[0].parentNode;5>c&&l&&l!==a;){c++;const H=l.id.toLowerCase();if(H&&H.length&&-1!==H.indexOf("_editingelement")&&Sys.UI.DomElement.containsCssClass(l,"WACEditing")&&Sys.UI.DomElement.containsCssClass(l,
"EditingSurfaceBody")){f=!0;break}l=l.parentNode}if(f&&l!==a){c=a.firstChild;for(f=!1;0<l.children.length&&l.children[0]!==c;)a.insertBefore(l.children[0],c),f=!0;if(f)for(;c;)l=c.nextSibling,a.removeChild(c),c=l}a=new Lh.a(b,Object(I.a)(this,this.YQe,"processNodesDiscovery"),new fC(y));a.$l("Word Converter Operation");a.Wi=!b||b.Wi;a.run()}}}YQe(a,b){const c=b.nodes[b.E3];var f=gk.Rae(c);if(f){let y=f.rNa.replace(RegExp("level[0-9]"),"").trim();y=y&&y.length?y:f.rNa;let H=b.lists[y];H||(H=new GH,
H.lZ=this.VDc++);let Q=H.wCb[f.level-1];Q||(Q=new HH,Q.level=f.level);var l=c.parentNode;if(l&&"li"===l.tagName.toLowerCase()){if(l=l.parentNode)!(l=l.tagName.toUpperCase())||"OL"!==l&&"UL"!==l||(Q.tagName=l)}else Q.TZa=gk.P6f(c,5),Q.TZa&&Q.TZa.length||(Q.TZa=gk.sde(c,5)),Q.ignore=!Q.TZa||!Q.TZa.length,Q.tagName=gk.nVc(Q.TZa);f.lZ=H.lZ;Q.emc++;Q.ignore||"li"===c.parentNode.tagName.toLowerCase()||(l=(l=gk.sde(c,5))?l:Q.TZa)&&l.length&&(f.U2i=l,(l=gk.bml(c,l,Q.listStyle,f.level-1))&&l.length&&(Q.listStyle=
l));b.S9[b.S9.length]=f;Q.S9.contains(f)||Q.S9.add(f);if(void 0===H.wCb[f.level-1]||null===H.wCb[f.level-1]||H.wCb[f.level-1]!==Q)H.wCb[f.level-1]=Q;b.lists[y]&&b.lists[y]===H||(b.lists[y]=H);b.lCb=c}else if((f=b.lCb)&&gk.b8b(c)===f&&c.tagName===f.tagName&&c.className===f.className){f.appendChild(f.ownerDocument.createElement("BR"));for(f.appendChild(f.ownerDocument.createElement("BR"));c.firstChild;)f.appendChild(c.firstChild);c.parentNode.removeChild(c)}b.E3++;if(b.nodes.length<=b.E3){if(!b.S9.length)return!1;
b.E3=0;a.hh(Object(I.a)(this,this.XQe,"processNodeConvert"))}return!0}XQe(a,b){a=b.S9[b.E3];var c=a.wnc,f=a.rNa.replace(RegExp("level[0-9]"),"").trim();f=f&&f.length?f:a.rNa;f=b.lists[f];var l=f.wCb[a.level-1],y=c.parentNode.tagName.toLowerCase();if(!l.ignore&&c.parentNode&&"li"!==y){if(y=gk.cMi(c,l)){gk.P1b(c,5);const H=c.ownerDocument.createElement("LI");H.setAttribute("data-aria-level",String.format("{0}",a.level));for(H.setAttribute("data-listid",String.format("{0}",f.lZ));c.firstChild;)H.appendChild(c.firstChild);
y.appendChild(H);c.parentNode.removeChild(c);"UL"===l.tagName?this.Ob.b++:this.Ob.c++}}else"li"===y&&(l=l.tagName,c=c.parentNode,a.LJb&&(a=c.parentNode)&&a.tagName.toUpperCase()===l&&a.setAttribute("data-pasteFromRc","true"),c.setAttribute("data-listid",String.format("{0}",f.lZ)),"UL"===l?this.Ob.b++:this.Ob.c++);b.E3++;return b.E3<b.S9.length}static cMi(a,b){a=gk.$Li(a,b.tagName);return gk.T_d(a,b)}static T_d(a,b){if(b.tagName!==a.tagName){for(b=a.ownerDocument.createElement(b.tagName);a.firstChild;)b.appendChild(a.firstChild);
a.parentNode.insertBefore(b,a);a.parentNode.removeChild(a);a=b}return a}static $Li(a,b){b=a.ownerDocument.createElement(b?b:"UL");var c=a.getAttribute("start");c&&0<c.length&&(b.setAttribute("start",c),a.removeAttribute("start"));(c=a.className)&&0<c.length&&(c="OL"===b.tagName?xl.DXc(c,"NumberListStyle"):xl.DXc(c,"BulletListStyle"),0<c.length&&(Sys.UI.DomElement.addCssClass(b,c),Sys.UI.DomElement.removeCssClass(a,c)));a.parentNode.insertBefore(b,a);return b}static P1b(a,b){for(let c=0;c<a.childNodes.length;c++){const f=
a.childNodes[c];1===f.nodeType&&1<b&&gk.P1b(f,b-1);if(gk.pne(f)||gk.dbc(f))a.removeChild(f),c--}}static Rae(a){if(1===a.nodeType){var b=gk.D8b(a,"mso-list");if(b&&0<b.length)try{var c=b.split(" ");if(3===c.length){var f=new az;f.level=Number.parseInvariant(c[1].substr(5));f.rNa=b;f.wnc=a;f.LJb=!0;return f}}catch(l){}else if((c=a.parentNode)&&"li"===c.tagName.toLocaleLowerCase()&&(b=c.getAttribute("data-"+Ve.a.n0b),c=c.getAttribute("data-listid"),b&&c&&0<b.length&&0<c.length))return f=new az,f.level=
Number.parseInvariant(b),f.rNa=c+" level"+b,f.wnc=a,f.LJb=!1,f}return null}static bml(a,b,c,f){if("p"===a.tagName.toLowerCase()&&b&&b.length){if("UL"===gk.nVc(b))return c=gk.Abj(b),Sys.UI.DomElement.addCssClass(a,c),c;var l;return(l=b.match(RegExp("^[0-9]+")))&&l.length?(c="NumberListStyle1",Sys.UI.DomElement.addCssClass(a,c),a.setAttribute("start",l[0]),c):(l=b.match(RegExp("^[a-zA-Z]+")))&&l.length&&(l=l[0],f=(b=l.match(RegExp("^[ivxlcdmIVXLCDM]+")))&&b.length?gk.Qpj(c,f):1,1!==f&&((c=gk.LNc(a,
l,RegExp("^[ivxlcdm]+"),ma.a.BNf,"NumberListStyle3"))||(c=gk.LNc(a,l,RegExp("^[IVXLCDM]+"),ma.a.BNf,"NumberListStyle5")))||f&&((c=gk.LNc(a,l,RegExp("^[a-z]+"),ma.a.ANf,"NumberListStyle2"))||(c=gk.LNc(a,l,RegExp("^[A-Z]+"),ma.a.ANf,"NumberListStyle4"))))?c:"NumberListStyle1"}return null}static Abj(a){switch(a){case "o":return"BulletListStyle2";case "\u00a7":return"BulletListStyle3";default:return"BulletListStyle1"}}static Qpj(a,b){a&&a.length||(a="");switch(a){case "NumberListStyle2":case "NumberListStyle4":a=
1;break;case "NumberListStyle3":case "NumberListStyle5":a=0;break;default:a=-1}if(0>a)switch(b%3){case 0:a=0;break;case 1:a=1;break;case 2:a=0;break;default:a=0}return a}static LNc(a,b,c,f,l){return(b=b.match(c))&&b.length?(f=f(b[0]),f=1>f?1:f,Sys.UI.DomElement.addCssClass(a,l),a.setAttribute("start",f+""),l):null}static nVc(a){return a&&"o"!==a&&"\u00b7"!==a&&"\u00a7"!==a&&"-"!==a?"OL":"UL"}static sde(a,b){let c=null;var f;let l,y;for(let H=-1;!c&&H<a.childNodes.length;H++){const Q=-1===H?a:a.childNodes[H];
if(Q)if((f=Q.innerHTML)&&0<f.length){if(l=f.indexOf("\x3c!--[if !supportLists]--\x3e"),0<=l&&(y=f.indexOf("\x3c!--[endif]--\x3e"),0<=y)){f=f.substring(l,y+14);Q.innerHTML=Q.innerHTML.replace(f,"");if(f.length){a=a.ownerDocument.createElement("span");a.innerHTML=f;c=a.innerText.trim();break}c&&c.length||(c="o")}}else 0<=H&&1===Q.nodeType&&1<b&&(c=gk.sde(Q,b-1))}return c}static P6f(a,b){let c=null;for(let f=0;!c&&f<a.childNodes.length;f++){const l=a.childNodes[f];gk.dbc(l)?(c="string"===typeof l.innerText?
l.innerText.trim():l.textContent.trim(),c.length||(c="o"),l.parentNode.removeChild(l)):1===l.nodeType&&1<b&&(c=gk.P6f(l,b-1))}return c}static dbc(a){return 1===a.nodeType&&(a=gk.D8b(a,"mso-list"))&&0<a.length&&"ignore"===a.trim().toLowerCase()?!0:!1}static pne(a){return 1===a.nodeType&&!a.firstChild&&"SPAN"===a.tagName.toUpperCase()}static D8b(a,b){if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf(b)){a=a.split(";");for(let c=0;c<a.length;c++){const f=a[c].split(":");if(2===f.length&&f[0].trim()===
b)return f[1].trim()}}return null}static b8b(a){do a=a.previousSibling;while(a&&gk.Oac(a));return a}static Oac(a){return a?3===a.nodeType?(a=a.nodeValue,a=a.replace(gk.kJd,""),!a.trim().length):1!==a.nodeType||a.firstChild!==a.lastChild||"SPAN"!==a.tagName&&"FONT"!==a.tagName?!1:gk.Oac(a.firstChild):!0}}gk.kJd=RegExp("[\n|\r]","gi");Object(m.a)(gk,"WacAndRichClientWordConverter",null,[1337]);class QH{constructor(){this.lZ=0;this.tagName="UL";this.l6b=null;this.ignore=!1;this.emc=0}}Object(m.a)(QH,
"ListMetadata",null,[]);class ll{constructor(a=null){this.VDc=1;this.VS=a||Om.a.oee("")}get Ob(){return this.VS}process(a,b){a&&a.querySelectorAll&&(a=a.querySelectorAll("p"))&&0<a.length&&(a=new Lh.a(b,Object(I.a)(this,this.YQe,"processNodesDiscovery"),new fC(a)),a.$l("Word Converter Operation"),a.Wi=!b||b.Wi,a.run())}YQe(a,b){const c=b.nodes[b.E3];var f=ll.Rae(c);if(f){let l=b.Xja[f.level-1];l||(l=new eC,b.Xja[f.level-1]=l);b.lCb&&ll.b8b(c)!==b.lCb&&ll.Kal(b);let y=l.rvg[f.rNa];if(!y)y=new QH,y.lZ=
this.VDc++,y.l6b=ll.J$d(c,5),y.ignore=!y.l6b||!y.l6b.length,y.tagName=ll.nVc(y.l6b),l.rvg[f.rNa]=y,b.lists[y.lZ.toString()]=y;else if(!y.ignore&&1===y.emc){const H=ll.J$d(c,5);y.tagName=y.l6b===H?"UL":"OL"}f.lZ=y.lZ;y.ignore||"OL"===y.tagName&&0<y.emc&&l.ePc!==f.lZ?(y.ignore=!0,b.Xja[0].ePc=-1,b.Xja=b.Xja.slice(0,1)):(b.Xja.length>f.level&&(b.Xja=b.Xja.slice(0,f.level)),l.ePc=f.lZ,b.S9[b.S9.length]=f,y.emc++);b.lCb=c}else if((f=b.lCb)&&ll.b8b(c)===f&&c.tagName===f.tagName&&c.className===f.className){f.appendChild(f.ownerDocument.createElement("BR"));
for(f.appendChild(f.ownerDocument.createElement("BR"));c.firstChild;)f.appendChild(c.firstChild);c.parentNode.removeChild(c)}b.E3++;if(b.nodes.length<=b.E3){if(!b.S9.length)return!1;b.E3=0;a.hh(Object(I.a)(this,this.XQe,"processNodeConvert"))}return!0}XQe(a,b){var c=b.S9[b.E3];a=c.wnc;const f=b.lists[c.lZ.toString()];if(!f.ignore&&(c=ll.Tmj(a,c,f))){ll.P1b(a,5);const l=a.ownerDocument.createElement("LI");for(;a.firstChild;)l.appendChild(a.firstChild);c.appendChild(l);a.parentNode.removeChild(a);"UL"===
f.tagName?this.Ob.b++:this.Ob.c++}b.E3++;return b.E3<b.S9.length}static Tmj(a,b,c){let f=ll.amh(a,b.level,c);const l=L.a.ze(f,"UniqueListId");if(l&&l!==b.lZ||!l&&f.firstChild)a=a.ownerDocument.createElement(c.tagName),f.parentNode.insertBefore(a,f.nextSibling),f=a;L.a.aw(f,"UniqueListId",b.lZ);return ll.T_d(f,c)}static T_d(a,b){if(b.tagName!==a.tagName){b=a.ownerDocument.createElement(b.tagName);for(L.a.aw(b,"UniqueListId",L.a.ze(a,"UniqueListId"));a.firstChild;)b.appendChild(a.firstChild);a.parentNode.insertBefore(b,
a);a.parentNode.removeChild(a);a=b}return a}static amh(a,b,c){let f=null,l;1===b?l=ll.b8b(a):(f=ll.amh(a,b-1,null),l=f.lastChild);if(l&&1===l.nodeType){const y=l.tagName.toUpperCase();if("UL"===y||"OL"===y)return l}c=a.ownerDocument.createElement(c?c.tagName:"UL");1===b?a.parentNode.insertBefore(c,a):f.appendChild(c);return c}static P1b(a,b){for(let c=0;c<a.childNodes.length;c++){const f=a.childNodes[c];1===f.nodeType&&1<b&&ll.P1b(f,b-1);if(ll.pne(f)||ll.dbc(f))a.removeChild(f),c--}}static Rae(a){if(1===
a.nodeType){const b=ll.D8b(a,"mso-list");if(b&&0<b.length)try{const c=b.split(" ");if(3===c.length){const f=new az;f.level=Number.parseInvariant(c[1].substr(5));f.rNa=b;f.wnc=a;return f}}catch(c){}}return null}static nVc(a){return"o"!==a&&"\u00b7"!==a&&"\u00a7"!==a&&"-"!==a?"OL":"UL"}static J$d(a,b){let c=null;for(let f=0;!c&&f<a.childNodes.length;f++){const l=a.childNodes[f];ll.dbc(l)?(c="string"===typeof l.innerText?l.innerText.trim():l.textContent.trim(),c.length||(c="o")):1===l.nodeType&&1<b&&
(c=ll.J$d(l,b-1))}return c}static dbc(a){return 1===a.nodeType&&(a=ll.D8b(a,"mso-list"))&&0<a.length&&"ignore"===a.trim().toLowerCase()?!0:!1}static pne(a){return 1===a.nodeType&&!a.firstChild&&"SPAN"===a.tagName.toUpperCase()}static D8b(a,b){if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf(b)){a=a.split(";");for(let c=0;c<a.length;c++){const f=a[c].split(":");if(2===f.length&&f[0].trim()===b)return f[1].trim()}}return null}static b8b(a){do a=a.previousSibling;while(a&&ll.Oac(a));return a}static Oac(a){return a?
3===a.nodeType?(a=a.nodeValue,a=a.replace(ll.kJd,""),!a.trim().length):1!==a.nodeType||a.firstChild!==a.lastChild||"SPAN"!==a.tagName&&"FONT"!==a.tagName?!1:ll.Oac(a.firstChild):!0}static Kal(a){for(let b=0;b<a.Xja.length;b++){const c=a.Xja[b];c&&(c.ePc=-1)}}}ll.kJd=RegExp("[\n|\r]","gi");Object(m.a)(ll,"WordConverter",null,[1337]);class mC{constructor(a){this.s4a=a.ka("ExternalPasteImprovementsEnabled")&&a.ka("ListMarkerIsEnabled")}get $9a(){return this.s4a}create(a=null){return this.s4a?new gk(a):
new ll(a)}}Object(m.a)(mC,"Box4WordConverterFactory",null,[1316]);var RH=d(716);class SH{constructor(a,b,c,f,l){this.Iff=0;this.qd=a;this.ud=b;this.pCd=l;this.bW=c;this.eQa=f}Kzi(a,b,c){ka.ULS.sendTraceTag(9037318,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",b,c,this.ud.iz);a.Wi&&this.ud.ik&&window.chrome&&ka.ULS.sendTraceTag(18354842,307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",b);this.bW.Cda(!!(b&16));this.eQa.create(a,Object(I.a)(this,
this.H$e,"waitingForEnsureAccessOperationResult"),null).$l("ClipboardPreProcess");this.Iff=Date.now()}mbl(){this.bW.reset()}H$e(a){let b=!0;const c=this.bW.m_i,f=null==this.bW.UZi;null!=c?(a.e6=c,b=!1):Date.now()-this.Iff>this.pCd&&!f&&(ka.ULS.sendTraceTag(18354843,307,50,null),this.qd.Xb(Kd.a.ska,{["Reason"]:Qd.a.$ch}),b=a.e6=!1);return b}}Object(m.a)(SH,"ClipboardOperationClipboardAccessHelper",null,[1245]);class dz{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc){this.Ca=a;this.qd=b;this.ls=
c;this.Ji=f;this.Uc=l;this.bW=y;this.Cr=H;this.rf=Q;this.yia=ia;this.SK=wa;this.zia=Ua;this.crb=kb;this.m6a=Gb;this.lk=dc;this.cVb=ec?ec.ka("ImageDataURLSkippedForSafari12IsEnabled"):!1;this.vVb=ec?ec.ka("PasteKeepSourceFontSizeFixIsEnabled"):!1;this.JVb=ec?ec.ka("TextLayoutServiceUseResponse"):!1;this.FAc=ec?ec.ka("EnhancedTextCCPEnabled"):!1;this.ud=Fc;this.jd=yc}get Wh(){return this.Ji}get Xc(){return this.qd}iUl(a){a.eqa();return!0}QNf(a,b){a=b.Ip;ka.ULS.shipAssertTag(18130960,307,!!(a&16));if(a&
256){z.a.cva&&w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings");let c=null;b.Nf&&b.Nf.Cg&&(c=b.Nf.Cg.ao);let f=!1;this.cVb&&z.a.cva&&this.lk.vpd(c,"data-src","data-srcurl");this.vVb&&(f=this.lk.v1b(b.Nf.Cg.ao,b.Nf.Md,!0));this.JVb&&this.lk.lyd(c,!1);this.FAc?(hd.a.addHandler(c,oa.a.copy,Object(I.a)(this,this.gRf,"cutCopyHandlerForRibbon")),a=this.bW.copy(),hd.a.removeHandler(c,oa.a.copy,Object(I.a)(this,this.gRf,"cutCopyHandlerForRibbon"))):a=
this.bW.copy();this.cVb&&z.a.cva&&this.lk.vpd(c,"data-srcurl","data-src");this.vVb&&f&&this.lk.v1b(b.Nf.Cg.ao,b.Nf.Md,!1);this.JVb&&this.lk.lyd(c,!0);if(!a)return ka.ULS.sendTraceTag(6305540,307,50,"SystemClipboard didn't copy"),this.Xc.Xb(Kd.a.e$a,{["Reason"]:Qd.a.X4e}),b.o1&&b.o1.fail("SystemClipboard did not copy",!1),b.failed=!0,!1}return!0}gRf(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:null;if(b&&b.setData){var c=null;c=this.H9d();({X3b:c}=this.lk.lKh(c));c&&(a.preventDefault(),a.stopPropagation(),
b.setData("text/html",Hb.c(c)),b.setData("text/plain",c.innerText))}}H9d(){if(this.ud.lS){const a=this.jd.Wta();if(a&&a.Jl)return a.Jl.getSelection()}ka.ULS.sendTraceTag(509109137,307,10,"Browser don't support DomL2Selection");return null}V2b(a,b){const c=b.Nf;ka.ULS.shipAssertTag(18130961,307,!!(b.Ip&16));b.$xl?this.ls.sKf():this.ls.d0d(c,a);return!0}zPc(a,b){var c=b.context,f=b.zd;const l=b.kK;var y=!1;a=this.Uc.Pa.mb.jf;if(this.Cr.Fm(a)||this.rf.im(a)){const H=this.SK.Lc(a.node);let Q=H.kf();ka.ULS.shipAssertTag(18130962,
307,Q);this.yia.Te(H);this.zia.vcb(H)&&(y=!0)}f=b.Ip&64?new J.DictionaryPropertySet:f||new J.DictionaryPropertySet;f.setValue(ee.a.jwb,!1);c=this.Ca.ei(c,C.a.pL,2,!0,l,f);8===c&&(ka.ULS.sendTraceTag(18130963,307,50,"DeleteKey failed"),this.Xc.Xb(Kd.a.ska,{["Reason"]:Qd.a.sSf}),b.o1&&b.o1.fail("DeleteKey failed",!1),b.failed=!0);32===c&&y&&(b=this.Uc.Pa.mb,this.rf.Dx(b)&&b.Va.node===a.node&&!this.Cr.textLength(b.Va.node)&&(b=this.SK.Lc(b.Va.node),a=this.rf.Mt(b),ka.ULS.shipAssertTag(18130964,307,a),
this.yia.Te(b),this.zia.SAb(b)||(a=this.crb.create(),a.Tc(b),this.yia.zxa(a,!1,!1),y=this.yia.yi(a),this.Cr.ae(y)&&(this.yia.Te(a),this.Wh.merge(a,b,!1,!1),this.Uc.setSelection(this.m6a.Qg(y,this.Cr.textLength(y)))))));return!0}}Object(m.a)(dz,"ClipboardOperationCutCopy",null,[522]);class TH{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc){this.Ca=a;this.qd=b;this.ls=c;this.bW=y;this.Uc=l;this.Ji=f;this.Cr=H;this.rf=Q;this.yia=ia;this.SK=wa;this.zia=Ua;this.crb=kb;this.m6a=Gb;this.Oa=ec;this.lk=
dc;this.ud=Fc;this.jd=yc}create(){return new dz(this.Ca,this.qd,this.ls,this.Ji,this.Uc,this.bW,this.Cr,this.rf,this.yia,this.SK,this.zia,this.crb,this.m6a,this.Oa,this.lk,this.ud,this.jd)}}Object(m.a)(TH,"Factory",null,[335]);class UH{jAh(){return!0}}Object(m.a)(UH,"ClipboardOperationCutStrategy",null,[356]);var ct=d(472),nC=d(1265),oC=d(230);class ep{constructor(a,b,c,f,l,y=null,H="",Q=!0){this.Ata=this.Wud=this.X_a=this.ypd=null;this.hbc=!1;this.Ahe=null;this.pKe=0;this.context=a;this.Nf=a.view;
this.Ip=b;this.zd=l;this.o1=c;this.kK=f;this.YMb=this.failed=!1;this.skd=null;this.ccb=this.nBb=!1;this.$xl=ep.G_d(a);this.browserName=H;this.vPh=Q;this.iNa=!1;this.URa=0;this.pZd=ha.a.create().toString();if(a=Object(Wa.a)(10,l)?l:null){this.X_a=new J.DictionaryPropertySet;this.X_a.ny(a);if(a.sa(ee.a.kld,!1)){this.nBb=!0;this.ccb=a.sa(ee.a.ccb,!1);this.skd=y;for(y=this.Nf.Nb.Yj;y.Bx;)y=y.getContext(0);if(l=Object(qa.a)(kf.AParagraphNode,y.node)){c=0;f=Db.ParagraphReader.textLength(l);switch(y.contextId){case yb.a.textRange:c=
y.Sa;f=y.Mb;break;case yb.a.endOfParagraph:c=f}this.ypd=tb.a.mhj(y.node,c);ka.ULS.shipAssertTag(6305503,307,!!this.ypd);l=wb.HyperlinkReader.D7b(l);for(const ia of l)ia.Mb<=c||ia.Sa>=f||ep.hyperlinkEditor.YM(y.node,ia.hyperlink)}}this.YMb=a.sa(ee.a.YMb,!1);this.iNa=a.sa(ee.a.iNa,!1)}b&64&&(this.YMb=!0)}static get Xc(){return mc.a.instance}static get hyperlinkEditor(){return ep.In||(ep.In=Ib.a.instance.resolve("Box4.IHyperlinkEditor"))}static G_d(a){if(a){if(a.Bx){for(let b=0;b<a.length;b++)if(ep.G_d(a.getContext(b)))return!0;
return!1}if(Object(Wa.a)(oC.a,a))return ep.G_d(a.UE);if(Db.ParagraphReader.ae(a.node)&&a.node.LC)return!0}return!1}}ep.In=null;Object(m.a)(ep,"ClipboardActionArguments",null,[]);var Ev;(function(a){a[a.paste=1]="paste";a[a.textOnly=2]="textOnly";a[a.overtype=4]="overtype";a[a.copy=16]="copy";a[a.deleteSelection=32]="deleteSelection";a[a.move=64]="move";a[a.useSystemClipboard=256]="useSystemClipboard";a[a.forceInternalClipboard=512]="forceInternalClipboard";a[a.reformatPastedContent=4096]="reformatPastedContent";
a[a.pasteAsPlainText=8192]="pasteAsPlainText";a[a.pasteAsMerge=16384]="pasteAsMerge";a[a.showPlaceholderGlossary=65536]="showPlaceholderGlossary"})(Ev||(Ev={}));Object(m.b)("ClipboardActionFlags",Ev);const VH=a=>{a=a.Pa.clone();const b=[];for(let c=0;c<a.length;c++)Array.addRange(b,a.ga(c).toArray());return b},WH=a=>{const b={};let c;for(let f=0;f<a.length;f++)c=Object.getType(a[f].node).getName(),b[c]=b[c]?b[c]+1:1;a="";for(let f in b)a+=b[f]+" "+f+" elements,";return a=a.substring(0,a.length-1)};
class XH extends ct.a{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye,Xd,Xf,ug,qg,Fg=!0){super();this.YNd=this.qca=this.q7=this.zC=null;this.init(a);this.$l("ClipboardOperation");this.zFa(ia,b,l,y,H);this.qd=wa;this.rf=Ua;this.ud=kb;this.Lk=Gb;this.Vcf=ec;this.Ycf=dc;this.Wcf=Fc;this.Zcf=yc;this.fzc=tc;this.wCd=xd;this.KSb=Q;this.CSb=Vd;this.eQa=Ld;this.j$h=Fg;this.cE=ye;this.hd=Xd;this.gt=Xf;this.tca=ug;this.Ot=f;this.aCa=qg;H&&Object(Wa.a)(10,H)&&(this.qca=Object(qa.a)(1335,
H.sa(ee.a.HRa,null)));this.qca||(this.qca=this.aCa.E3e());this.u3a=void 0===c||null===c?"NotAvailable":Object(nC.a)(Ev,c);this.qca.pli(this.u3a.split(", "));a=this.Ot;a.view.Sh?(this.Pg=a.view,this.Pg.Nb?(this.yI=0,this.DV=c,this.Zrb=yc.NJb,!Fg||this.Zrb&&this.Zrb.mb&&this.Zrb.length?(yc=Mb.SelectionEditor.Dx(this.Zrb.mb),yc=!(this.DV&16&&yc),yc=xd.mUj(c,this.Yj)&&yc,1!==this.behavior&&yc||(yc||this.qca.fail("Clipboard operation disabled for selection",!0),this.gp=yc?32:8,this.RY())):(this.qd.Xb(Kd.a.zh,
{["Reason"]:Qd.a.noSelection}),this.qca.fail("No selection when one required",!0),this.gp=8,this.finish())):(this.qd.Xb(Kd.a.zh,{["Reason"]:Qd.a.noSelection}),this.qca.fail("No selection manager",!1),this.gp=8,this.finish())):(this.qd.Xb(Kd.a.zh,{["Reason"]:Qd.a.ohd}),this.qca.fail("Not in interactive view",!0),this.gp=8,this.finish())}get Yj(){this.YNd||(this.YNd=ge.a.Wtb(this.Zrb));return this.YNd}B1(){super.B1();this.Zrb=null}run(){0===this.yI&&this.setup();1===this.yI&&this.process();2===this.yI&&
this.teardownSync();3===this.yI&&this.teardownAsync();4===this.yI&&this.finish()}setup(){if(this.DV&256&&this.KSb){this.ux||this.fzc.Kzi(this,this.DV,this.u3a);this.ux.run();if(this.ux.inProgress)return;const a=this.ux.e6;this.vMc();if(!a){this.qca.fail("No access to system clipboard",!0);this.gp=8;this.yI=4;this.Fak();return}}else ka.ULS.sendTraceTag(9037319,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",this.DV,this.u3a,this.ud.iz);this.DV&32&&!this.rf.J0c(this.Pg.Nb.Yj)?(ka.ULS.sendTraceTag(6305506,
307,50,"Cut not allowed"),this.qd.Xb(Kd.a.zh,{["Reason"]:Qd.a.m2d}),this.qca.fail("Cut not allowed",!0),this.CSb.show(),this.gp=8,this.yI=4):(this.DV&4096&&(this.tca.BLb(Object.assign(new ij.a,{vog:!0,Aeh:this.u3a})),this.gt.undo()),this.wCd.GSk(this.DV),this.zC=this.Lk.je(15),this.zC.ld(this.Pg.Ag),this.yI=1)}process(){if(!this.ux){ka.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",this.DV,this.u3a,this.ud.iz);ka.ULS.shipAssertTag(6305507,307,!this.q7);this.q7=
new ep(this.Ot,this.DV,this.qca,this.kK,this.DG,void 0,this.ud.iz,this.j$h);let a;a=this.DV&65536?Object(I.a)(this.Vcf,this.Vcf.process,"process"):this.DV&64?Object(I.a)(this.Ycf,this.Ycf.process,"process"):this.DV&1?Object(I.a)(this.Zcf,this.Zcf.process,"process"):Object(I.a)(this.Wcf,this.Wcf.process,"process");this.DV&16&&this.Pg.Nb.Npa.u8d();this.eQa.create(this,a,this.q7).$l("ClipboardAction")}ka.ULS.shipAssertTag(6305536,307,!!this.ux);this.ux.run();this.ux.inProgress||(this.vMc(),this.yI=this.Wi?
2:3)}teardownSync(){this.q7.nBb&&(this.zC.fd=C.a.typing);this.q7.hbc&&this.zC.Kfd(this.q7.Ahe,this.q7.pKe);this.zC.dispose();this.gp=this.q7.failed?8:32;this.yI=4}teardownAsync(){if(this.ux){if(this.ux.run(),this.ux.inProgress)return}else if(this.q7.nBb&&(this.zC.fd=C.a.typing),this.zC.iV(this),this.q7.hbc&&this.zC.Kfd(this.q7.Ahe,this.q7.pKe),this.zC.dispose(),this.qIc)return;this.gp=this.q7.failed?8:32;this.yI=4}finish(){this.tca.BLb(Object.assign(new ij.a,{vog:!1}));this.RY();32===this.response?
ka.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",+this.endTime-+this.startTime,this.DV,this.u3a,this.ud.iz):ka.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",+this.endTime-+this.startTime,this.DV,this.u3a,this.ud.iz);this.aCa.eEa(this.qca)}Fak(){var a=!!(this.DV&1),b=this.Ot.view;if(b){var c=b.Nb;b=this.ud.iz;w.AFrameworkApplication.Ra.processAction(C.a.hRf,2);a?ka.ULS.sendTraceTag(18617483,
307,50,"CopyPasteShortcutDialog showed for paste operation in {0}.",b):(ka.ULS.sendTraceTag(18617484,307,50,"CopyPasteShortcutDialog showed for copy operation in {0}.",b),a=VH(c),1===a.length?ka.ULS.sendTraceTag(18425100,307,50,"CopyPasteShortcutDialog showed for copying 1 {0} element in {1}.",Object.getType(a[0].node).getName(),b):(c=WH(a),ka.ULS.sendTraceTag(18425101,307,50,"CopyPasteShortcutDialog showed for copying {0} elements: {1} in {2}.",a.length,c,b)))}}}Object(m.a)(XH,"ClipboardOperation",
ct.a,[]);class YH{constructor(a,b){this.tzc=null;this.ls=a;this.IV=b;this.uC=0}process(a,b){this.uC||(this.tzc=[Object(I.a)(this,this.FIi,"copyGlossarySelection"),Object(I.a)(this.IV,this.IV.oNk,"pasteGlossaryPlaceholder")]);let c=!0;this.uC<this.tzc.length&&(c=this.tzc[this.uC++](a,b));return c?this.uC<this.tzc.length:!1}FIi(a,b){if(!Object(Wa.a)(10,b.zd))return!1;const c=Object(qa.a)(10,b.zd);if(!c.Ua(ee.a.Gdg))return!1;const f=c.eb(ee.a.Gdg),l=b.Nf,y=l.Nb;this.ls.MRl();y.yqd(()=>{y.setSelection(f,
void 0,!0);this.ls.d0d(l,a)},!0);return!0}}Object(m.a)(YH,"ClipboardOperationContentControlShowPlaceholderProcessor",null,[1334]);class ZH{constructor(a){this.c4a=null;this.tS=a;this.uC=-1}process(a,b){-1===this.uC&&(this.OQi(a,b),this.uC=0);let c=!1;this.uC<this.c4a.length&&(c=this.c4a[this.uC++](a,b));return c?this.uC<this.c4a.length:!1}OQi(a,b){z.a.H9||b.Ip&512?(this.c4a=[Object(I.a)(this.tS,this.tS.V2b,"copyInternal")],ka.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):
!a.Wi&&b.Ip&256?(this.c4a=[Object(I.a)(this.tS,this.tS.iUl,"waitBeforeCopy"),Object(I.a)(this.tS,this.tS.QNf,"copyExternal"),Object(I.a)(this.tS,this.tS.V2b,"copyInternal")],ka.ULS.sendTraceTag(18158307,307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):(this.c4a=[Object(I.a)(this.tS,this.tS.QNf,"copyExternal"),Object(I.a)(this.tS,this.tS.V2b,"copyInternal")],ka.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal."));
b.Ip&32&&(a=Object(I.a)(this.tS,this.tS.zPc,"deleteForCut"),this.c4a.push(a),ka.ULS.sendTraceTag(18158337,307,50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut."));a=b.browserName;ka.ULS.sendTraceTag(18617485,307,50,"Copy operation in {0}.",a);if(b.Nf)if(b=VH(b.Nf.Nb),1===b.length)ka.ULS.sendTraceTag(18425102,307,50,"Copy 1 {0} element in {1}.",Object.getType(b[0].node).getName(),a);else{const c=WH(b);ka.ULS.sendTraceTag(18425103,307,50,"Copy {0} elements: {1} in {2}.",
b.length,c,a)}}}Object(m.a)(ZH,"ClipboardOperationCutCopyProcessor",null,[1332]);class $H{constructor(a,b,c,f){this.QDc=null;this.ls=a;this.Uc=b;this.tS=c;this.IV=f;this.uC=0}process(a,b){this.uC||(this.QDc=[Object(I.a)(this,this.JIi,"copyMovedSelection"),Object(I.a)(this.tS,this.tS.zPc,"deleteForCut"),Object(I.a)(this,this.E4g,"moveIp"),Object(I.a)(this.IV,this.IV.Jeh,"pasteInternal"),Object(I.a)(this.IV,this.IV.dyh,"setSelectionAfterPaste")]);let c=!0;this.uC<this.QDc.length&&(c=this.QDc[this.uC++](a,
b));return c?this.uC<this.QDc.length:!1}JIi(a,b){b=b.Nf;this.ls.zRl();this.ls.d0d(b,a);return!0}E4g(a,b){b=new Lb.Selection([b.zd],!0);this.Uc.setSelection(b,a);return!0}}Object(m.a)($H,"ClipboardOperationMoveProcessor",null,[1331]);class aI{constructor(a,b,c,f,l,y){this.JLd=null;this.dqf=0;this.qd=f;this.ud=b;this.IV=l;this.gGd=c;this.KSb=w.AFrameworkApplication.Ttd()&&!(z.a.$T&&w.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix"));this.pCd=a.appSettings.ChromeClipboardAccessOperationTimeout;
this.uC=0;this.DVh=y}get NJb(){return this.IV.NJb}process(a,b){if(0===this.uC)return this.wNk(b);if(1===this.uC)return this.prepareForPaste(a,b);if(2===this.uC)return this.uC=3,this.JLd(a,b);3===this.uC&&this.IV.dyh(a,b);return!1}wNk(a){this.ud.H9||a.Ip&512?(this.JLd=a.Ip&2?Object(I.a)(this.IV,this.IV.paste,"paste"):Object(I.a)(this.IV,this.IV.Jeh,"pasteInternal"),this.uC=2):(this.KSb?(this.uC=1,this.dqf=Date.now()):this.uC=2,this.JLd=Object(I.a)(this.IV,this.IV.paste,"paste"));ka.ULS.sendTraceTag(18617486,
307,50,"Paste operation in {0}.",a.browserName);return!0}prepareForPaste(a,b){a=!0;if(this.gGd.value.ohh())this.uC=2;else{const c=Date.now()-this.dqf;c>this.pCd&&(ka.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",c),this.qd.Xb(Kd.a.ska,{["Reason"]:Qd.a.$ch}),b.o1&&b.o1.fail("Prepare for paste timed out",!1),b.failed=!0,a=!1,this.DVh.mbl())}return a}}Object(m.a)(aI,"ClipboardOperationPasteProcessor",null,[1330]);class bI{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc){this.ls=a;this.Ca=
b;this.KSb=c;this.qd=f;this.rf=l;this.ud=y;this.Lk=H;this.HVh=Q;this.FVh=ia;this.fzc=wa;this.wCd=Ua;this.CSb=kb;this.eQa=Gb;this.cE=ec;this.hd=dc;this.gt=Fc;this.tca=yc;this.aCa=tc}create(a,b,c,f,l,y,H,Q,ia=!0){const wa=this.HVh.create(f,Object(qa.a)(10,Q));var Ua=this.FVh.create();const kb=new YH(this.ls,wa),Gb=new $H(this.ls,ge.a.instance,Ua,wa);Ua=new ZH(Ua);f=new aI(w.AFrameworkApplication.fa,Qc.a.instance,f,mc.a.instance,wa,this.fzc);return new XH(a,b,c,l,y,H,Q,this.KSb,this.Ca,this.qd,this.rf,
this.ud,this.Lk,kb,Gb,Ua,f,this.fzc,this.wCd,this.CSb,this.eQa,this.cE,this.hd,this.gt,this.tca,this.aCa,ia)}}Object(m.a)(bI,"Factory",null,[1247]);class ez{constructor(a,b){this.Oab=a.DVc(b);this.m0d=a.gej(b);this.v8a=a.uUc(b);this.jRa=a.jUc(b)}static PW(a){return ez.Fr(a)}static Fr(a){return new ez(Zd.a.instance,a)}}Object(m.a)(ez,"CpUsageHelper",null,[]);var dt=d(179);class cI{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb){this.qd=a;this.ls=b;this.pXb=c;this.Gca=f;this.Uc=l;this.Ca=y;this.gGd=H;this.CZb=
ia;this.MLd=Q;this.MDd=wa;this.vCd=Ua;this.hd=kb}get Vn(){return this.CZb.value}get Bba(){return this.Gca}get Xc(){return this.qd}get NJb(){return this.MLd.NJb}paste(a,b){const c=this.hd.Htb();try{const f=b.Nf;ka.ULS.shipAssertTag(18131010,307,!!(b.Ip&1));Object(Wa.a)(10,b.zd)&&b.zd.setValue(dt.a.Y4b,f.Cg.ao.clientWidth);this.vCd.SKl(a,b);let l;if(!({FNc:l}=this.gGd.value.AKh()).returnValue)return b.o1&&b.o1.fail("HTML import strategy failed",!1),b.failed=!0,!1;this.Vn.Aw();let y=!0,H=null;const Q=
this.MDd.create(l),ia=b.vPh;f.Nb.yqd(()=>{ia&&2===this.Ca.processAction(C.a.LDa,2)?y=!1:(H=ia?this.Uc.Pa.mb.Va:b.zd,ka.ULS.shipAssertTag(18158338,307,Mb.SelectionEditor.Xg(H)),this.pwg(H,"paste"))},this.MLd.Cqg);if(!y)return!1;f.editingView.disable(!0,25);Q.restore();this.pXb.jNk(l,H,a);return!0}finally{c&&c.dispose()}}oNk(a,b){this.Vn.Aw();const c=(new MF.a).je(15);c.ld(this.ls.e6e);b=Object(qa.a)(10,b.zd).eb(ee.a.byj);ka.ULS.shipAssertTag(20492440,307,Mb.SelectionEditor.Xg(b));this.pXb.$kg(b,a);
this.ls.sKf();c.dispose();return!0}Jeh(a){this.Vn.Aw();this.Ca.processAction(C.a.LDa,2);const b=this.Uc.Pa.mb.Va;ka.ULS.shipAssertTag(18158339,307,Mb.SelectionEditor.Xg(b));this.pwg(b,"intPaste");this.pXb.$kg(b,a);return!0}pwg(a,b){b=ez.PW(b);this.Bba.L0k(b,a.node,a.Sa);this.Bba.Gak(b.m0d);this.Bba.qse(b.Oab);this.Bba.kse(b.v8a);this.Bba.jse(b.jRa)}dyh(a,b){if(!b.vPh)return!1;b.Ip&64&&this.ls.LRl();if(!b.Ata)return ka.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.Xc.Xb(Kd.a.h2,
{["Reason"]:Qd.a.glg}),b.o1&&b.o1.fail("No selection after paste",!1),b.failed=!0,!1;this.MLd.rRl(b);this.Vn.Aw();return!1}}Object(m.a)(cI,"ClipboardOperationPaste",null,[1296]);class dI{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua){this.qd=a;this.ls=b;this.pXb=c;this.Gca=f;this.Uc=l;this.Ca=y;this.CZb=Q;this.k4h=H;this.MDd=ia;this.vCd=wa;this.hd=Ua}create(a,b){b=this.k4h.create(this.Uc,b);return new cI(this.qd,this.ls,this.pXb,this.Gca,this.Uc,this.Ca,a,b,this.CZb,this.MDd,this.vCd,this.hd)}}Object(m.a)(dI,
"Factory",null,[1244]);class eI{constructor(a,b){this.m8h=a;this.$3h=b}get stylePropertySet(){return this.m8h}get fMk(){return this.$3h}}Object(m.a)(eI,"ParagraphFormatStore",null,[]);class fI{constructor(a,b,c,f){this.Uc=a;this.Cr=b;this.cL=c;this.N0h=f}SKl(a,b){if(b.nBb&&this.N0h){b=a.e6;var c=this.Uc.Pa.mb.Va.node,f=null;this.Cr.ae(c)&&(f=this.cL.tE(c),c=this.Cr.gua(c),f=new eI(f,c));b=new ep(b.context,b.Ip,b.o1,b.kK,b.zd,f);a.e6=b}}}Object(m.a)(fI,"ClipboardOperationPasteOvertypeStrategy",null,
[1243]);class vx{constructor(a){this.qJd=null;this.Uc=a;a.yqd(b=>{this.qJd=b},!1)}get Cqg(){return!1}rRl(a){a=this.H_b(a);this.setSelection(this.Uc,a)}H_b(a){let b=a.Ata;(a.iNa||a.YMb)&&a.Wud&&(b=Od.SelectionFactory.WN(a.Wud,b.Va));return b}setSelection(a,b){a.setSelection(b)}}Object(m.a)(vx,"AClipboardOperationPasteStrategy",null,[1314]);class gI extends vx{constructor(a){super(a)}get NJb(){return this.qJd}}Object(m.a)(gI,"ClipboardOperationPasteToLiveSelectionStrategy",vx,[]);class hI extends vx{constructor(a,
b){super(a);this.dRd=null;this.HWb=b;a.yqd(c=>{this.dRd=c},!0)}get Cqg(){return!0}get NJb(){return this.dRd}H_b(a){let b=super.H_b(a);a.zd.setValue(ee.a.CNk,b);return b=this.HWb.tXl(this.qJd.mb,this.dRd.mb,b)}}Object(m.a)(hI,"ClipboardOperationPasteToVirtualSelectionStrategy",vx,[]);class iI{constructor(a){this.HWb=null;this.cRd=a.ka("EnableVirtualSelectionInSelectionManager")}create(a,b){return b&&b.sa(ee.a.iNa,!1)&&this.cRd?new hI(a,this.OTl):new gI(a)}get OTl(){this.HWb||(this.HWb=Ib.a.instance.qb("Box4.Actors.IVirtualSelectionMerger"));
return this.HWb}}Object(m.a)(iI,"ClipboardOperationPasteStrategyFactory",null,[1246]);class pC{constructor(a,b,c,f,l,y){this.qd=a;this.Uc=b;this.Jha=c;this.ZD=f;this.o0h=l;this.b1h=y}GSk(a){this.b1h&&(a&1||a&32)&&this.Jha.Bw&&this.Uc.ZZb()}mUj(a,b){return this.o0h?a&1&&this.ZD.R8a(b)?(this.qd.Xb(Kd.a.zh,{["Reason"]:Qd.a.kE}),!1):!0:!0}}Object(m.a)(pC,"ClipboardOperationWordStrategy",null,[]);class jI{constructor(a){this.EWh=a.ka("CssConverterFidelityImprovementIsEnabledIsEnabled")}iIi(a,b){if(b)if(b=
b.sheet)if(b=b.cssRules){var c=Array.clone(b);w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordCssConverterFidelityImprovementIsEnabledSettings");this.EWh&&c.reverse();var f=b=0,l=0,y=0;for(const Q of c){c=Q.style;var H=Q.selectorText;c=c?c.cssText:null;H=H?H.split(","):null;if(c&&H&&Q.type===Q.STYLE_RULE){y+=H.length;for(const ia of H){0<=ia.indexOf("#")&&b++;0<=ia.indexOf(".")&&f++;0>ia.indexOf("#")&&0>ia.indexOf(".")&&l++;H=null;try{H=a.querySelectorAll(ia)}catch(wa){ka.ULS.sendTraceTag(41427107,
307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",ia,wa.message)}if(H)for(let wa=0;wa<H.length;wa++)H[wa].setAttribute("style",c+(H[wa].getAttribute("style")||""))}}}ka.ULS.sendTraceTag(51245663,307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",y,b,f,l)}else this.Iwg();else this.Iwg()}Iwg(){ka.ULS.sendTraceTag(41211202,307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",
z.a.iz)}}Object(m.a)(jI,"ExternalPasteCssConverter",null,[1251]);var fz=d(1273);class wx{constructor(a){this.MV=this.NVb=null;this.fZb=a.currentNode;const b=new ob.GraphIterator;b.Tc(a);this.qLd=new ob.GraphIterator;this.qLd.Tc(a);this.nLd=b.origin;this.mCd=Array(b.depth);this.Fob=Array(b.depth);this.nCd=Array(b.depth);for(a=b.depth-1;0<=a;--a){const c=b.currentNode;this.Fob[a]=b.role;this.nCd[a]=c;b.Cc();this.mCd[a]=b.hcj(c,this.Fob[a])}}qm(a,b){this.NVb=a;this.MV=b}restore(a){const b=new fz.a,c=
new fz.a;this.Krh(a,b,c);return c.value}Krh(a,b,c){b.value=!0;if(this.qLd.isValid)a.Tc(this.qLd),c.value=!1;else{for(let f=this.nCd.length-1;0<=f;--f){const l=this.nCd[f];if(l.anchor&&!l.anchor.qJ&&(a.set(l),a.vba(this.nLd)||this.nLd.Sne&&a.xLh())){c.value=this.hZf(a,f+1);return}b.value=!1}a.set(this.nLd);c.value=this.hZf(a,0)}}hZf(a,b){let c=!1,f,l;f=this.mCd[b];l=this.Fob[b];const y=a.W8(l);if(f<y)a.gq(f,l);else if(c=!0,!a.zB(l))return!0;if(!this.K4g(a,l))return c;for(b+=1;b<this.mCd.length;++b){if(c){if(!a.zB(this.Fob[b]))return!0}else if(!a.Cb(this.Fob[b]))return!1;
if(!this.K4g(a,this.Fob[b]))break}return c}K4g(a,b){if(this.NVb&&!this.NVb(a,this.MV)){const c=new ob.GraphIterator;c.Tc(a);let f=!0;do if(!a.Gf(b)){f=!1;break}while(!this.NVb(a,this.MV));if(!f){a.Tc(c);do if(!a.WF(b))return a.Cc(),!1;while(!this.NVb(a,this.MV))}}return!0}}Object(m.a)(wx,"NodeReference",null,[]);var Cn=d(188);class Pj{constructor(a,b,c,f){this.PYb=this.fp=this.fh=this.qx=this.bL=this.zI=null;this.PGd=!1;this.OWh=100;this.crb=this.PLd=this.VNa=this.hd=this.cE=this.hp=this.eJh=null;
this.wfl=()=>{this.PGd&&this.Tyc&&il.a.instance.Lg(this.Tyc);this.Tyc||(this.Tyc=new dd.a(3,1,this.OWh,()=>{this.HXd();this.PGd=!1},215));il.a.instance.Hb(this.Tyc);this.PGd=!0;return!1};this.wAb=a;this.h8d=this.fjb=null;this.ag=b;this.transaction=c;this.Via=f}get fa(){return w.AFrameworkApplication.fa}get wP(){return this.bL||(this.bL=Ib.a.instance.resolve("Box4.Styles.IStyleEditor"))}get paragraphEditor(){return this.qx||(this.qx=Ib.a.instance.resolve("Box4.IParagraphEditor"))}get cK(){return this.zI||
(this.zI=Ib.a.instance.resolve("Box4.Pages.IPageContentEditor"))}get aC(){return Pj.ay||(Pj.ay=Ib.a.instance.resolve("Box4.IOutlineEditor"))}get Uf(){return this.fh||(this.fh=Ib.a.instance.resolve("Box4.List.IListReader"))}get jq(){return this.fp||(this.fp=Ib.a.instance.resolve("Box4.List.IListEditor"))}get ouc(){return this.PYb||(this.PYb=Ib.a.instance.qb("Box4.List.ISingleLevelListEditor"))}get W6(){return this.hp||(this.hp=Ib.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get owc(){return this.cE||
(this.cE=Ib.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}get Xf(){return this.hd||(this.hd=Ib.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get lYd(){return this.VNa||(this.VNa=Ib.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor"))}get Feh(){return this.tca||(this.tca=Ib.a.instance.resolve("Box4.IPasteFloatieEventSource"))}get Gmb(){return this.f9h||(this.f9h=Ib.a.instance.resolve("Box4.ITextPasteFloatieManager"))}get jld(){return this.PLd||
(this.PLd=Ib.a.instance.qb("Box4.IPastedParagraphSpaceHandler"))}set jld(a){this.PLd=a}get cfh(){return!1}get vAh(){return this.fa.ka("WordEditorAutoResizeImageIsEnabled")}KYf(){}Oeh(a){var b=void 0===this.ag.Ip||null===this.ag.Ip?"not available":Object(nC.a)(Ev,this.ag.Ip);ka.ULS.sendTraceTag(8765522,307,50,"PasteSetup: {0} [{1}].",this.ag.Ip,b);ka.ULS.shipAssertTag(6305487,307,Mb.SelectionEditor.Xg(this.wAb));if(this.shd)return ka.ULS.sendTraceTag(6305488,307,50,"NothingToPaste"),this.ag.Ata=Od.SelectionFactory.Mu(this.wAb),
a.hh(Object(I.a)(this,this.D_a,"pasteTeardown")),!0;b=new ob.GraphIterator;b.set(this.wAb.node);Mb.SelectionEditor.Mt(b);Za.OutlineElementNavigator.Te(b);this.eJh=b.origin;if(this.cfh)return b.eC(10),this.KYf(b,a),a.hh(Object(I.a)(this,this.Vnl,"setSelectionAfterPastingOutlines")),!0;if(ze.b(b)){if(this.Vmg)return this.ag.Ata=this.vNk(this.wAb,this.dNf),a.hh(Object(I.a)(this,this.D_a,"pasteTeardown")),!0;this.wAb=this.Qwk(b).ga(0)}this.dAl(this.wAb);const c=new Cn.a;c.Tc(b);Za.OutlineElementNavigator.ZJ(c,
!1,!1);this.fjb=new wx(b);this.h8d=new wx(c);a.hh(Object(I.a)(this,this.mNk,"pasteExecution"));return!0}mNk(a){pb.a.mark(5568);this.JYf(a);let b=Object(I.a)(this,this.uvk,"mergeAfterPaste");if(this.Ipg){const c=this.jBh();c&&(b=Object(I.a)(this,this.D_a,"pasteTeardown"));ka.ULS.sendTraceTag(40387030,307,50,"ExecutePaste: shouldSkipMerge: {0}.",c)}a.hh(b);return!0}jBh(){return!1}get Ipg(){return this.fa.ka("PptCcpFix2IsEnabled")}get qsl(){return this.fa.ka("CopyAndPasteOneParagraphIndentationFixIsEnabled")}uvk(a){pb.a.mark(5569);
var b=new ob.GraphIterator;this.fjb.restore(b);this.fjb=null;var c=new ob.GraphIterator;this.h8d.restore(c);this.h8d=null;ka.ULS.shipAssertTag(6305489,307,Wd.OutlineElementReader.ih(b));ka.ULS.shipAssertTag(6305490,307,Wd.OutlineElementReader.ih(c));Za.OutlineElementNavigator.yi(b);Db.ParagraphReader.ql(b)&&Db.ParagraphReader.textLength(b.currentNode);Za.OutlineElementNavigator.Te(b);Za.OutlineElementNavigator.yi(c);ka.ULS.shipAssertTag(6305491,307,Db.ParagraphReader.ql(c));var f=Db.ParagraphReader.textLength(c.currentNode);
Za.OutlineElementNavigator.Te(c);const l=this.HAh;var y=new Cn.a;y.Tc(b);Za.OutlineElementNavigator.ZJ(y,!1,!1);var H=y.currentNode===c.currentNode;var Q=!!this.ag&&!!(this.ag.Ip&8192);let ia=!1;!Q&&this.ag.zd&&Object(Wa.a)(J.DictionaryPropertySet,this.ag.zd)&&2===Rc.App.mode&&(Q=(Q=this.ag.zd.Rh(ee.a.Mib))&&""!==Q?!0:!1);if(H)y=ob.GraphIterator.pb(b.currentNode),Db.ParagraphReader.vs(Za.OutlineElementNavigator.yi(y))||(b=c),b.currentNode.id!==c.currentNode.id&&(ka.ULS.sendTraceTag(40691869,307,50,
"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",Zb.ListReader.Hk(b),Zb.ListReader.Hk(c)),y=Pj.Wh.merge(b,c,!0,Q),ka.ULS.shipAssertTag(6305492,307,y)),c=b,Q=!0;else{var wa=!!(this.ag.Ip&4);H=this.Xf.ig&&this.Xf.jz&&wa&&this.ag.ccb;this.jld&&this.ag&&2===Rc.App.mode&&!wa&&(this.jld.JFj(b,!1),this.jld.JFj(c,!0));Za.OutlineElementNavigator.yi(y);Db.ParagraphReader.ql(y)&&Db.ParagraphReader.textLength(y.currentNode);Za.OutlineElementNavigator.Te(y);this.Emi(y,
b,c);if(this.lYd.r1b||this.qsl)if(wa=new Cn.a,wa.Tc(y),Za.OutlineElementNavigator.ZJ(wa,!1,!1),wa.Cq.id!==c.Cq.id){for(;y.currentNode.id!==c.currentNode.id;)Za.OutlineElementNavigator.yi(y,!1),cb.a.create(y.currentNode),y.Cc(),Za.OutlineElementNavigator.ZJ(y,!1,!1);y.Tc(b);Za.OutlineElementNavigator.ZJ(y,!1,!1)}else ia=!0;if(this.ag.ypd&&(ka.ULS.shipAssertTag(6305493,307,this.ag.nBb),wa=new ob.GraphIterator,wa.Tc(y),wa=Za.OutlineElementNavigator.yi(wa))){var Ua=this.ag.ypd.fe(wa.Ta.ga(0));wa.Ta.ga(0).formatting=
Ua}Zb.ListReader.Hk(b)?(Pj.cM.gcc&&this.ouc&&this.ouc.DXl(b),wa=Zb.ListReader.Hk(y)?this.IAh:!0):Wd.OutlineElementReader.isEmpty(b,!0)?(Pj.Wh.RDa(b),wa=!1):wa=Zb.ListReader.Fx||!Zb.ListReader.Hk(y);this.ag.Wud=null;if(this.ag.YMb||this.ag.iNa)this.ag.Wud=this.ctj(wa?b.currentNode:y.currentNode,wa);if(wa&&(Ua=Zb.ListReader.Hk(b),ka.ULS.sendTraceTag(40691870,307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",Ua,Zb.ListReader.Hk(c)),Pj.Wh.merge(b,y,!0,Q,c,void 0,
ia,H),Zb.ListReader.Hk(b)&&this.Uf.ppc)){var kb=new Cn.a;kb.Tc(b);Za.OutlineElementNavigator.ZJ(kb,!1,!1);if(kb.Cq.id!==c.Cq.id){var Gb=this.Uf.Gv(b);this.Uf.Wna(b);const Fc=b.currentNode.sa(Ab.a.listID,0);b.Cc();for(Gb.SA=Ed.a.ax;kb.currentNode.id!==c.currentNode.id;){if(!Zb.ListReader.Hk(kb))({ybb:Gb}=this.jq.itb(Gb.propertySet,kb,Gb));else if(Ua){var ec=this.Uf.pkj(kb),dc=this.Uf.Vae(b.currentNode,Fc,ec);dc=dc?pe.a.xDa(dc,null):Gb;ec=pe.a.NN(dc.listType,Gb.listStyle,null,0,ec,"","");ec.Izk=b.currentNode;
this.jq.Tml(ec);this.jq.d_e(kb,!0)}Za.OutlineElementNavigator.ZJ(kb,!1,!1)}}}l?(Ua=new Cn.a,Ua.Tc(c),Za.OutlineElementNavigator.zxa(Ua,!1,!1),kb=Zb.ListReader.Hk(Ua),Gb=Zb.ListReader.Hk(c),Q=Pj.Wh.merge(Ua,c,!0,Q,void 0,!0,void 0,H),ka.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}, MergeSucceeded: {2}",kb,Gb,Q?"True":"False, will cause IP to reset to zero."),c=Q?Ua:c):(Q=!1,ka.ULS.sendTraceTag(51463189,307,50,"No merge, will cause IP to reset to zero."));
this.lYd.r1b&&ia&&(wa?(y=new ob.GraphIterator,y.Tc(b),Za.OutlineElementNavigator.yi(y)):l?(b=new ob.GraphIterator,b.Tc(y),Za.OutlineElementNavigator.yi(b)):(b=new ob.GraphIterator,b.Tc(y),b=Za.OutlineElementNavigator.yi(b),cb.a.create(b)))}ka.ULS.shipAssertTag(6305494,307,c.isValid);b=Za.OutlineElementNavigator.yi(c);f=Q?Db.ParagraphReader.textLength(b)-f:0;y=!1;Object(Wa.a)(10,this.ag.zd)&&(y=this.ag.zd.sa(ee.a.y1c,!1));y&&N.a.instance.ga(11)?this.ag.Ata=Od.SelectionFactory.D3(b,f-1,f):this.ag.Ata=
Od.SelectionFactory.Qg(b,f);N.a.instance.ga(71)&&this.ag&&this.ag.nBb&&Db.ParagraphReader.ae(b)&&this.ag.skd&&((f=this.ag.skd.stylePropertySet)&&this.wP.aba(f,b,!0),(f=this.ag.skd.fMk)&&this.paragraphEditor.rCf(b,f));a.hh(Object(I.a)(this,this.D_a,"pasteTeardown"));return!0}Emi(a,b,c){var f=!1;this.Xf.ig&&this.Xf.jz&&(f=!0);if(f){for(;a.currentNode!==c.currentNode;){Za.OutlineElementNavigator.yi(a,!1);f=this.owc.Xzl(cb.a.create(a.currentNode));f.Ucg();for(let l=0;l<f.length;l++){let y;const H=({Usg:y}=
f.getContext(l)).returnValue;y&&Pj.hyperlinkEditor.AIb(H,1)}a.Cc();Za.OutlineElementNavigator.ZJ(a,!1,!1)}a.Tc(b);Za.OutlineElementNavigator.ZJ(a,!1,!1)}}ctj(a,b){a=ob.GraphIterator.pb(a);Za.OutlineElementNavigator.yi(a);return Db.ParagraphReader.ae(a.currentNode)?(b=b?Db.ParagraphReader.textLength(a.currentNode):0,Od.SelectionFactory.Qg(a.currentNode,b)):cd.TableReader.Ocb(a.currentNode)?Od.SelectionFactory.nl(a.currentNode):null}Vnl(a){const b=ob.GraphIterator.pb(this.eJh);b.zB(1);this.ag.Ata=Od.SelectionFactory.Aj(b.currentNode,
!1);a.hh(Object(I.a)(this,this.D_a,"pasteTeardown"));return!0}D_a(a){var b=void 0===this.ag.Ip||null===this.ag.Ip?"not available":Object(nC.a)(Ev,this.ag.Ip);ka.ULS.sendTraceTag(8765523,307,50,"PasteTeardown: {0} [{1}].",this.ag.Ip,b);ka.ULS.shipAssertTag(6305497,307,!!this.ag.Ata);this.transaction.dispose();b=this.Via.fL;if(!b.Sh||!b.editingView.hm)return!1;b.editingView.DEl();return!this.fa.ka("IsPasteTextFloatieEnabled")||this.ag&&this.ag.Ip&&this.ag.Ip&4&&this.ag.Ip&2?!1:(a.hh(this.wfl,"scheduleCallPasteFloatieTask"),
!0)}HXd(){if(this.Gmb.Sua){const a=new ij.a;a.Ttc=!0;this.Feh.BLb(a)}else this.Feh.xTe(new Cg(1,w.AFrameworkApplication.isRtl));this.ag&&this.ag.Ip&&(1===this.ag.Ip?this.Gmb.vH=C.a.t8:257===this.ag.Ip?this.Gmb.vH=C.a.paste:8449===this.ag.Ip?this.Gmb.vH=C.a.j6:4097===this.ag.Ip?this.Gmb.vH=C.a.reformatPastedContent:12289==this.ag.Ip?this.Gmb.vH=C.a.r0a:this.fa.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled")&&this.ag.Ip&16384&&(this.Gmb.vH=C.a.JLb))}Crl(a,b){const c=new ob.GraphIterator;c.Tc(a);
a=Za.OutlineElementNavigator.yi(c);b=Db.ParagraphReader.ae(a)&&b===Db.ParagraphReader.textLength(a);ka.ULS.sendTraceTag(50384992,307,50,"IsPasteAtEndofParagraph: {0}",b);return b}dAl(a){ka.ULS.shipAssertTag(6305498,307,Mb.SelectionEditor.Xg(a));const b=ob.GraphIterator.pb(a.node);var c=b.kf();Za.OutlineElementNavigator.Te(b);ka.ULS.sendTraceTag(40425481,307,50,"sourceOE GraphIterator setup. {0}",{["tryToRootAtOutlineAncestorSuccess"]:c,["ipContextNodeType"]:a.node.type});c=Pj.Wh.V$b(b,!0);const f=
this.Crl(b,a.Sa);Pj.Wh.cPb(b,c,a,!1,!1,f)}vNk(a,b){ka.ULS.shipAssertTag(6305500,307,a.contextId===yb.a.Mf);const c=a.node;b=b.replace(ma.a.kDc," ");Pj.characterPropertiesEditor.replaceTextRange(a,b);return Od.SelectionFactory.Qg(c,a.Sa+b.length)}Qwk(a){a.hv();Pj.lm.sLa(a);const b=Pj.Tk.X9f(a),c=this.cK.p3b(a);b?yq.c(a.currentNode,b+1,b+2):this.aC.wsd(c,Rc.App.Lb.Kd.Mn.X8b());this.aC.U$b(a,null,!0);return Od.SelectionFactory.Aj(a.currentNode,!0)}static get lm(){return Gy.PageNavigator.instance}static get characterPropertiesEditor(){return Pj.mh||
(Pj.mh=Ib.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get hyperlinkEditor(){return Pj.In||(Pj.In=Ib.a.instance.resolve("Box4.IHyperlinkEditor"))}static get Tk(){return $w.PageReader.instance}static get Wh(){return Pj.Ji||(Pj.Ji=Ib.a.instance.resolve("Box4.IOutlineElementEditor"))}static get cM(){return Pj.UK||(Pj.UK=Ib.a.instance.qb("Box4.List.ListSettings"))}static get Be(){return Pj.kd||(Pj.kd=Ib.a.instance.qb("Box4.IFeatureHelper"))}}Pj.ay=null;Pj.kd=null;Pj.Ji=null;Pj.mh=null;
Pj.In=null;Pj.UK=null;Object(m.a)(Pj,"APasteExecutionManager",null,[]);var KQ=d(1272);class kI{constructor(){this.Ip=0;this.W2b=6;this.J8d=this.I8d=this.r2f=this.H8d=this.G8d=this.F8d=this.E8d=!1;this.uRe=null;this.q2f=this.v$a=this.J6b=this.p2f=this.t2f=!1;this.Weh=this.KJb=0;this.GNe=this.platform=null;this.K4a={}}get i3e(){if(this.J8d)return"Word Online";if(this.H8d)return"Google Docs";if(this.I8d||this.F8d||this.G8d)return"PowerPoint Online";if(this.E8d)return"Excel Online";switch(this.uRe){case "Word.Document":return"Word";
case "OneNote.File":return"OneNote";case "Excel.Sheet":return"Excel";case "PowerPoint.Slide":return"PowerPoint"}return"Other"}zbk(){ka.ULS.sendTraceTag(51406241,307,50,JSON.stringify(this.Yri()))}Abk(){const a=this.K4a;for(let c in a){var b=c;const f=a[c];f&&(f.SourceApp=this.i3e,f.Browser=KQ.a[this.KJb],f.TagName=b,f.OperationId=this.GNe,ka.ULS.sendTraceTag(51406242,307,50,JSON.stringify(f)))}}MLj(a,b){a&&a.length&&b&&b.length&&(a=a.toLowerCase(),b=b.toLowerCase(),a in this.K4a||(this.K4a[a]={}),
this.K4a[a][b]=this.ytj(a,b)+1)}ytj(a,b){if(!(a&&a.length&&b&&b.length&&this.K4a&&a in this.K4a))return 0;a=a.toLowerCase();b=b.toLowerCase();return(a=this.K4a[a])&&b in a?a[b]:0}Yri(){const a={};a.ActionIdFlags=this.Ip;a.FoundDataCcpTimestampAttribute=this.E8d;a.FoundDataClipserviceCcpidAttribute=this.F8d;a.FoundDataShapeIdsAttribute=this.G8d;a.FoundGoogleDocsInternalGuidId=this.H8d;a.FoundOneNoteOnlineSequenceClass=this.r2f;a.FoundPowerPointOnlineSequenceClass=this.I8d;a.FoundWordOnlineSequenceClass=
this.J8d;a.ProgId=this.uRe;a.SourceApp=this.i3e;a.FoundText=this.t2f;a.FoundEquation=this.p2f;a.FoundList=this.J6b;a.FoundTable=this.v$a;a.FoundImage=this.q2f;a.CopySourceBrowser=this.W2b;a.PasteBrowser=this.KJb;a.IsSameBrowserPaste=this.o2j(this.W2b,this.KJb);a.IsCrossBrowserPaste=this.fVj(this.W2b,this.KJb);a.IsUncategorizedBrowserPaste=this.j5j(this.W2b,this.KJb);a.Platform=this.platform;a.PastedHtmlLength=this.Weh;a.OperationId=this.GNe;return a}o2j(a,b){return 5===a||6===a?!1:a===b}fVj(a,b){return 6===
a?!1:a!==b}j5j(a,b){return 5===a&&5===b}}Object(m.a)(kI,"HtmlContentMetadata",null,[]);class gz{constructor(a,b,c=!1){this.Yf=a;this.xw=b;this.Ali=c}}Object(m.a)(gz,"TagEventParam",null,[]);class qC{constructor(a,b=null){this.pAc=this.Bqf=this.FQd=this.Gvf=null;this.Nc=a;this.VS=b||Om.a.O7f("");this.vpl()}get Ob(){return this.VS}szk(a,b,c){this.FQd[b]?this.u6g():(this.Ob.e++,(b=this.pAc[b])&&b(new gz(a,c,!1)),this.Ob.b++)}u6g(){this.Ob.d++}lzk(){this.Ob.c++}bzk(a,b,c){if(this.FQd[b])this.u6g();else{if(b=
this.pAc[b])return this.Ob.b++,b(new gz(a,c,!1));this.Ob.f++}return 2}vpl(){this.Gvf=ta.a.eI("AREA",!0,"BASE",!0,"BASEFONT",!0,"BR",!0,"COL",!0,"FRAME",!0,"HR",!0,"IMG",!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",!0);this.FQd=ta.a.eI("ABBR",!0,"ACRONYM",!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,"HTML",!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0);this.Bqf=ta.a.eI("APPLET",!0,"AREA",!0,"BASE",!0,"BASEFONT",!0,"FRAME",!0,"HEAD",
!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,"TITLE",!0);let a=this.Nc,b=this.Nc,c=this.Nc,f=this.Nc,l=this.Nc,y=this.Nc,H=this.Nc,Q=this.Nc,ia=this.Nc,wa=this.Nc,Ua=this.Nc,kb=this.Nc,Gb=this.Nc,ec=this.Nc,dc=this.Nc,Fc=this.Nc,yc=this.Nc,tc=this.Nc,xd=this.Nc,Vd=this.Nc;this.pAc=ta.a.eI("A",Object(I.a)(this.Nc,this.Nc.Ehd,"onAOpen"),"ABBR",Object(I.a)(this.Nc,this.Nc.AKe,"onAbbrOpen"),"ACRONYM",Object(I.a)(this.Nc,this.Nc.BKe,
"onAcronymOpen"),"ADDRESS",Object(I.a)(this.Nc,this.Nc.CKe,"onAddressOpen"),"APPLET",Object(I.a)(this.Nc,this.Nc.JKe,"onAppletOpen"),"AREA",Object(I.a)(this.Nc,this.Nc.MKe,"onAreaTag"),"B",Object(I.a)(this.Nc,this.Nc.Jhd,"onBOpen"),"BASE",Object(I.a)(this.Nc,this.Nc.NKe,"onBaseTag"),"BASEFONT",Object(I.a)(this.Nc,this.Nc.OKe,"onBasefontTag"),"BDO",Object(I.a)(this.Nc,this.Nc.PKe,"onBdoOpen"),"BIG",Object(I.a)(this.Nc,this.Nc.Phd,"onBigOpen"),"BLOCKQUOTE",Object(I.a)(this.Nc,this.Nc.Qhd,"onBlockquoteOpen"),
"BODY",Object(I.a)(this.Nc,this.Nc.aLe,"onBodyOpen"),"BR",Object(I.a)(this.Nc,this.Nc.Rhd,"onBrTag"),"BUTTON",Object(I.a)(this.Nc,this.Nc.fLe,"onButtonOpen"),"CAPTION",Object(I.a)(this.Nc,this.Nc.Shd,"onCaptionOpen"),"CENTER",Object(I.a)(this.Nc,this.Nc.Uhd,"onCenterOpen"),"CITE",Object(I.a)(this.Nc,this.Nc.Xhd,"onCiteOpen"),"CODE",Object(I.a)(this.Nc,this.Nc.Zhd,"onCodeOpen"),"COL",Object(I.a)(this.Nc,this.Nc.rLe,"onColTag"),"COLGROUP",Object(I.a)(this.Nc,this.Nc.sLe,"onColgroupOpen"),"DD",Object(I.a)(this.Nc,
this.Nc.bid,"onDdOpen"),"DEL",Object(I.a)(this.Nc,this.Nc.did,"onDelOpen"),"DFN",Object(I.a)(this.Nc,this.Nc.fid,"onDfnOpen"),"DIR",Object(I.a)(this.Nc,this.Nc.hid,"onDirOpen"),"DIV",Object(I.a)(this.Nc,this.Nc.jid,"onDivOpen"),"DL",Object(I.a)(this.Nc,this.Nc.kid,"onDlOpen"),"DT",Object(I.a)(this.Nc,this.Nc.lid,"onDtOpen"),"EM",Object(I.a)(this.Nc,this.Nc.qid,"onEmOpen"),"FIELDSET",Object(I.a)(this.Nc,this.Nc.PLe,"onFieldsetOpen"),"FONT",Object(I.a)(this.Nc,this.Nc.Did,"onFontOpen"),"FORM",Object(I.a)(this.Nc,
this.Nc.VLe,"onFormOpen"),"FRAME",Object(I.a)(this.Nc,this.Nc.WLe,"onFrameTag"),"FRAMESET",Object(I.a)(this.Nc,this.Nc.XLe,"onFramesetOpen"),"H1",Object(I.a)(this.Nc,this.Nc.Iid,"onH1Open"),"H2",Object(I.a)(this.Nc,this.Nc.Jid,"onH2Open"),"H3",Object(I.a)(this.Nc,this.Nc.Kid,"onH3Open"),"H4",Object(I.a)(this.Nc,this.Nc.Lid,"onH4Open"),"H5",Object(I.a)(this.Nc,this.Nc.Mid,"onH5Open"),"H6",Object(I.a)(this.Nc,this.Nc.Nid,"onH6Open"),"HEAD",Object(I.a)(this.Nc,this.Nc.aMe,"onHeadOpen"),"HR",Object(I.a)(this.Nc,
this.Nc.Oid,"onHrTag"),"HTML",Object(I.a)(this.Nc,this.Nc.cMe,"onHtmlOpen"),"I",Object(I.a)(this.Nc,this.Nc.Qid,"onIOpen"),"IFRAME",Object(I.a)(this.Nc,this.Nc.eMe,"onIframeOpen"),"IMG",Object(I.a)(this.Nc,this.Nc.Rid,"onImgTag"),"INPUT",Object(I.a)(this.Nc,this.Nc.hMe,"onInputTag"),"INS",Object(I.a)(this.Nc,this.Nc.Tid,"onInsOpen"),"ISINDEX",Object(I.a)(this.Nc,this.Nc.oMe,"onIsindexOpen"),"KBD",Object(I.a)(this.Nc,this.Nc.Uid,"onKbdOpen"),"LABEL",Object(I.a)(this.Nc,this.Nc.Wid,"onLabelOpen"),"LEGEND",
Object(I.a)(this.Nc,this.Nc.Yid,"onLegendOpen"),"LI",Object(I.a)(this.Nc,this.Nc.Zid,"onLiOpen"),"LINK",Object(I.a)(this.Nc,this.Nc.sMe,"onLinkTag"),"MAP",Object(I.a)(this.Nc,this.Nc.tMe,"onMapOpen"),"MATH",Object(I.a)(this.Nc,this.Nc.cjd,"onMathOpen"),"MENU",Object(I.a)(this.Nc,this.Nc.XIb,"onMenuOpen"),"META",Object(I.a)(this.Nc,this.Nc.wMe,"onMetaTag"),"NOFRAMES",Object(I.a)(this.Nc,this.Nc.zMe,"onNoframesOpen"),"NOSCRIPT",Object(I.a)(this.Nc,this.Nc.AMe,"onNoscriptOpen"),"OBJECT",Object(I.a)(this.Nc,
this.Nc.BMe,"onObjectOpen"),"OL",Object(I.a)(this.Nc,this.Nc.jjd,"onOlOpen"),"OPTGROUP",Object(I.a)(this.Nc,this.Nc.CMe,"onOptgroupOpen"),"OPTION",Object(I.a)(this.Nc,this.Nc.njd,"onOptionOpen"),"P",Object(I.a)(this.Nc,this.Nc.qjd,"onPOpen"),"PARAM",Object(I.a)(this.Nc,this.Nc.DMe,"onParamTag"),"PRE",Object(I.a)(this.Nc,this.Nc.Cjd,"onPreOpen"),"Q",Object(I.a)(this.Nc,this.Nc.LMe,"onQOpen"),"S",Object(I.a)(this.Nc,this.Nc.Kjd,"onSOpen"),"SAMP",Object(I.a)(this.Nc,this.Nc.Ljd,"onSampOpen"),"SCRIPT",
Object(I.a)(this.Nc,this.Nc.WMe,"onScriptOpen"),"SELECT",Object(I.a)(this.Nc,this.Nc.XMe,"onSelectOpen"),"SMALL",Object(I.a)(a,a.Ujd,"onSmallOpen"),"SPAN",Object(I.a)(b,b.Vjd,"onSpanOpen"),"STRIKE",Object(I.a)(c,c.Wjd,"onStrikeOpen"),"STRONG",Object(I.a)(f,f.Xjd,"onStrongOpen"),"STYLE",Object(I.a)(l,l.cNe,"onStyleOpen"),"SUB",Object(I.a)(y,y.Yjd,"onSubOpen"),"SUP",Object(I.a)(H,H.$jd,"onSupOpen"),"TABLE",Object(I.a)(Q,Q.dkd,"onTableOpen"),"TBODY",Object(I.a)(ia,ia.fNe,"onTbodyOpen"),"TD",Object(I.a)(wa,
wa.knc,"onTdOpen"),"TEXTAREA",Object(I.a)(Ua,Ua.hNe,"onTextareaOpen"),"TFOOT",Object(I.a)(kb,kb.iNe,"onTfootOpen"),"TH",Object(I.a)(Gb,Gb.ekd,"onThOpen"),"THEAD",Object(I.a)(ec,ec.jNe,"onTheadOpen"),"TITLE",Object(I.a)(dc,dc.lNe,"onTitleOpen"),"TR",Object(I.a)(Fc,Fc.fkd,"onTrOpen"),"TT",Object(I.a)(yc,yc.ikd,"onTtOpen"),"U",Object(I.a)(tc,tc.jkd,"onUOpen"),"UL",Object(I.a)(xd,xd.kkd,"onUlOpen"),"VAR",Object(I.a)(Vd,Vd.mkd,"onVarOpen"))}}Object(m.a)(qC,"AHtmlProcessor",null,[]);class rC{constructor(a,
b){this.childNodes=a.childNodes;this.xw=b;this.U1d=0;this.G0c=!1}}Object(m.a)(rC,"HtmlProcessorArguments",null,[]);class or extends qC{constructor(a,b=null){super(a,b);this.KHd=null}get q0j(){null==this.KHd&&(this.KHd=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("CopyAndPasteTextFromWordWin32FixIsEnabled"):!1);return this.KHd}process(a,b=null){a&&(this.Nc.reset(),this.hih(new rC(a,new ju),b))}hih(a,b){a.childNodes.length&&(a=new Lh.a(b,Object(I.a)(this,this.STk,"processChild"),a),a.$l("HTML Processing Operation"),
b||(a.Wi=!0),a.run())}STk(a,b){const c=b.childNodes[b.U1d];if(3===c.nodeType)return this.Nc.Lhd(),this.Nc.m1(c.nodeValue,new gz(c,b.xw.F5f())),or.IQb(b);if(1!==c.nodeType)return or.IQb(b);if(!b.G0c){const l=ma.a.nC(c.tagName);if(!or.RGj(c))if(this.Bqf[l])this.lzk();else{or.Wtk(c);this.Nc.Lhd();var f=c.id;const y=c.tagName,H=b.xw.F5f(),Q=c.getAttribute?c.getAttribute("class"):null;f=new ku(f,y,Q?Q:"",c.attributes?c.attributes.length:0);f.isValid&&H.add(f);if(this.Gvf[l])return this.szk(c,l,H),or.IQb(b);
f=!1;switch(this.bzk(c,l,H)){case 1:f=!0;break;case 3:return or.IQb(b)}switch(this.Nc.Ree(c)){case 1:f=!0}b.G0c=f;this.hih(new rC(c,H),a);if(!a.Wi)return!0}}if(b.G0c){if(this.q0j&&!this.pAc[ma.a.nC(c.tagName)])return or.IQb(b);this.Nc.onClose()}return or.IQb(b)}static Wtk(a){3!==a.nodeType&&L.a.aw(a,"alreadyPasted",!0)}static RGj(a){return 3!==a.nodeType&&L.a.ze(a,"alreadyPasted")}static IQb(a){a.U1d++;a.G0c=!1;return a.U1d<a.childNodes.length}}Object(m.a)(or,"HtmlProcessor",qC,[]);var gs=d(954);
class lI{constructor(a,b=null,c=null,f=null){this.ie=a;this.VS=b||Om.a.N7f(z.a.Z7a,"");this.yq=c;this.yra=f?f.ka("ParseStyleForHtmlTagEventIsEnabled"):!1}get Ob(){return this.VS}get $n(){return this.yq}Kf(a){return a?a+1:1}reset(){this.ie.reset()}Lhd(){this.ie.Lhd()}Ree(a){if(a&&this.$n&&(a.getAttribute&&(a.getAttribute(gs.a.mRf)&&(this.$n.E8d=!0),a.getAttribute(gs.a.nRf)&&(this.$n.F8d=!0),a.getAttribute(gs.a.rRf)&&(this.$n.G8d=!0)),a.id&&a.id.startsWith&&a.id.startsWith(gs.a.Vdg)&&(this.$n.H8d=!0),
a.className&&a.className.split))for(const b of a.className.split(" ")){b.startsWith(gs.a.xch)&&(this.$n.r2f=!0);b.startsWith(gs.a.Igh)&&(this.$n.I8d=!0);b.startsWith(gs.a.PQh)&&(this.$n.J8d=!0);if(b.startsWith(z.a.K0b)&&b.length===z.a.K0b.length+1){const c=parseInt(ma.a.substring(b,b.length-1,b.length));isNaN(c)||(this.$n.W2b=c)}if(b===gs.a.g5g||b===gs.a.h5g)this.$n.J6b=!0}return this.ie.Ree(a)}onClose(){this.ie.onClose()}m1(a,b){this.$n&&(this.$n.t2f=!0);this.Ob.d=this.Kf(this.Ob.d);this.yra&&this.dya(b);
this.ie.m1(a,b)}Ehd(a){this.Ob.e=this.Kf(this.Ob.e);this.yra&&this.dya(a);return this.ie.Ehd(a)}AKe(a){this.Ob.f=this.Kf(this.Ob.f);return this.ie.AKe(a)}BKe(a){this.Ob.g=this.Kf(this.Ob.g);return this.ie.BKe(a)}CKe(a){this.Ob.h=this.Kf(this.Ob.h);return this.ie.CKe(a)}JKe(a){this.Ob.i=this.Kf(this.Ob.i);return this.ie.JKe(a)}MKe(a){this.Ob.j=this.Kf(this.Ob.j);this.ie.MKe(a)}Jhd(a){this.Ob.k=this.Kf(this.Ob.k);return this.ie.Jhd(a)}NKe(a){this.Ob.l=this.Kf(this.Ob.l);this.ie.NKe(a)}OKe(a){this.Ob.m=
this.Kf(this.Ob.m);this.ie.OKe(a)}PKe(a){this.Ob.n=this.Kf(this.Ob.n);return this.ie.PKe(a)}Phd(a){this.Ob.o=this.Kf(this.Ob.o);return this.ie.Phd(a)}Qhd(a){this.Ob.p=this.Kf(this.Ob.p);return this.ie.Qhd(a)}aLe(a){this.Ob.q=this.Kf(this.Ob.q);return this.ie.aLe(a)}Rhd(a){this.Ob.r=this.Kf(this.Ob.r);this.ie.Rhd(a)}fLe(a){this.Ob.s=this.Kf(this.Ob.s);return this.ie.fLe(a)}Shd(a){this.Ob.t=this.Kf(this.Ob.t);return this.ie.Shd(a)}Uhd(a){this.Ob.u=this.Kf(this.Ob.u);return this.ie.Uhd(a)}Xhd(a){this.Ob.v=
this.Kf(this.Ob.v);return this.ie.Xhd(a)}Zhd(a){this.Ob.w=this.Kf(this.Ob.w);return this.ie.Zhd(a)}rLe(a){this.Ob.x=this.Kf(this.Ob.x);this.ie.rLe(a)}sLe(a){this.Ob.y=this.Kf(this.Ob.y);return this.ie.sLe(a)}bid(a){this.Ob.z=this.Kf(this.Ob.z);return this.ie.bid(a)}did(a){this.Ob.ba=this.Kf(this.Ob.ba);return this.ie.did(a)}fid(a){this.Ob.bb=this.Kf(this.Ob.bb);return this.ie.fid(a)}hid(a){this.Ob.bc=this.Kf(this.Ob.bc);return this.ie.hid(a)}jid(a){this.Ob.bd=this.Kf(this.Ob.bd);return this.ie.jid(a)}kid(a){this.Ob.be=
this.Kf(this.Ob.be);return this.ie.kid(a)}lid(a){this.Ob.bf=this.Kf(this.Ob.bf);return this.ie.lid(a)}qid(a){this.Ob.bg=this.Kf(this.Ob.bg);return this.ie.qid(a)}PLe(a){this.Ob.bh=this.Kf(this.Ob.bh);return this.ie.PLe(a)}Did(a){this.Ob.bi=this.Kf(this.Ob.bi);return this.ie.Did(a)}VLe(a){this.Ob.bj=this.Kf(this.Ob.bj);return this.ie.VLe(a)}WLe(a){this.Ob.bk=this.Kf(this.Ob.bk);this.ie.WLe(a)}XLe(a){this.Ob.bl=this.Kf(this.Ob.bl);return this.ie.XLe(a)}Iid(a){this.Ob.bm=this.Kf(this.Ob.bm);return this.ie.Iid(a)}Jid(a){this.Ob.bm=
this.Kf(this.Ob.bm);return this.ie.Jid(a)}Kid(a){this.Ob.bm=this.Kf(this.Ob.bm);return this.ie.Kid(a)}Lid(a){this.Ob.bm=this.Kf(this.Ob.bm);return this.ie.Lid(a)}Mid(a){this.Ob.bm=this.Kf(this.Ob.bm);return this.ie.Mid(a)}Nid(a){this.Ob.bm=this.Kf(this.Ob.bm);return this.ie.Nid(a)}aMe(a){this.Ob.bn=this.Kf(this.Ob.bn);return this.ie.aMe(a)}Oid(a){this.Ob.bo=this.Kf(this.Ob.bo);this.ie.Oid(a)}cMe(a){this.Ob.bp=this.Kf(this.Ob.bp);return this.ie.cMe(a)}Qid(a){this.Ob.bq=this.Kf(this.Ob.bq);return this.ie.Qid(a)}eMe(a){this.Ob.br=
this.Kf(this.Ob.br);return this.ie.eMe(a)}Rid(a){this.$n&&(this.$n.q2f=!0);this.yra&&this.dya(a);this.Ob.bs=this.Kf(this.Ob.bs);this.ie.Rid(a)}hMe(a){this.Ob.bt=this.Kf(this.Ob.bt);this.ie.hMe(a)}Tid(a){this.Ob.bu=this.Kf(this.Ob.bu);return this.ie.Tid(a)}oMe(a){this.Ob.bv=this.Kf(this.Ob.bv);return this.ie.oMe(a)}Uid(a){this.Ob.bw=this.Kf(this.Ob.bw);return this.ie.Uid(a)}Wid(a){this.Ob.bx=this.Kf(this.Ob.bx);return this.ie.Wid(a)}Yid(a){this.Ob.by=this.Kf(this.Ob.by);return this.ie.Yid(a)}Zid(a){this.$n&&
(this.$n.J6b=!0);this.Ob.bz=this.Kf(this.Ob.bz);this.yra&&this.dya(a);return this.ie.Zid(a)}sMe(a){this.Ob.ca=this.Kf(this.Ob.ca);this.ie.sMe(a)}tMe(a){this.Ob.cb=this.Kf(this.Ob.cb);return this.ie.tMe(a)}cjd(a){this.$n&&(this.$n.p2f=!0);this.Ob.cc=this.Kf(this.Ob.cc);return this.ie.cjd(a)}XIb(a){this.Ob.cd=this.Kf(this.Ob.cd);return this.ie.XIb(a)}wMe(a){this.Ob.ce=this.Kf(this.Ob.ce);this.ie.wMe(a)}zMe(a){this.Ob.cf=this.Kf(this.Ob.cf);return this.ie.zMe(a)}AMe(a){this.Ob.cg=this.Kf(this.Ob.cg);
return this.ie.AMe(a)}BMe(a){this.Ob.ch=this.Kf(this.Ob.ch);return this.ie.BMe(a)}jjd(a){this.$n&&(this.$n.J6b=!0);this.Ob.ci=this.Kf(this.Ob.ci);this.yra&&this.dya(a);return this.ie.jjd(a)}CMe(a){this.Ob.cj=this.Kf(this.Ob.cj);return this.ie.CMe(a)}njd(a){this.Ob.ck=this.Kf(this.Ob.ck);return this.ie.njd(a)}qjd(a){this.Ob.cl=this.Kf(this.Ob.cl);this.yra&&this.dya(a);return this.ie.qjd(a)}DMe(a){this.Ob.cm=this.Kf(this.Ob.cm);this.ie.DMe(a)}Cjd(a){this.Ob.cn=this.Kf(this.Ob.cn);return this.ie.Cjd(a)}LMe(a){this.Ob.co=
this.Kf(this.Ob.co);return this.ie.LMe(a)}Kjd(a){this.Ob.cp=this.Kf(this.Ob.cp);return this.ie.Kjd(a)}Ljd(a){this.Ob.cq=this.Kf(this.Ob.cq);return this.ie.Ljd(a)}WMe(a){this.Ob.cr=this.Kf(this.Ob.cr);return this.ie.WMe(a)}XMe(a){this.Ob.cs=this.Kf(this.Ob.cs);return this.ie.XMe(a)}Ujd(a){this.Ob.ct=this.Kf(this.Ob.ct);return this.ie.Ujd(a)}Vjd(a){this.Ob.cu=this.Kf(this.Ob.cu);this.yra&&this.dya(a);return this.ie.Vjd(a)}Wjd(a){this.Ob.cv=this.Kf(this.Ob.cv);return this.ie.Wjd(a)}Xjd(a){this.Ob.cw=
this.Kf(this.Ob.cw);return this.ie.Xjd(a)}cNe(a){this.Ob.cx=this.Kf(this.Ob.cx);return this.ie.cNe(a)}Yjd(a){this.Ob.cy=this.Kf(this.Ob.cy);return this.ie.Yjd(a)}$jd(a){this.Ob.cz=this.Kf(this.Ob.cz);return this.ie.$jd(a)}dkd(a){this.$n&&(this.$n.v$a=!0);this.Ob.da=this.Kf(this.Ob.da);this.yra&&this.dya(a);return this.ie.dkd(a)}fNe(a){this.$n&&(this.$n.v$a=!0);this.Ob.db=this.Kf(this.Ob.db);this.yra&&this.dya(a);return this.ie.fNe(a)}knc(a){this.$n&&(this.$n.v$a=!0);this.Ob.dc=this.Kf(this.Ob.dc);
this.yra&&this.dya(a);return this.ie.knc(a)}hNe(a){this.Ob.dd=this.Kf(this.Ob.dd);return this.ie.hNe(a)}iNe(a){this.Ob.de=this.Kf(this.Ob.de);return this.ie.iNe(a)}ekd(a){this.$n&&(this.$n.v$a=!0);this.Ob.df=this.Kf(this.Ob.df);return this.ie.ekd(a)}jNe(a){this.$n&&(this.$n.v$a=!0);this.Ob.dg=this.Kf(this.Ob.dg);return this.ie.jNe(a)}lNe(a){this.Ob.dh=this.Kf(this.Ob.dh);return this.ie.lNe(a)}fkd(a){this.$n&&(this.$n.v$a=!0);this.Ob.di=this.Kf(this.Ob.di);return this.ie.fkd(a)}ikd(a){this.Ob.dj=this.Kf(this.Ob.dj);
return this.ie.ikd(a)}jkd(a){this.Ob.dk=this.Kf(this.Ob.dk);return this.ie.jkd(a)}kkd(a){this.$n&&(this.$n.J6b=!0);this.Ob.dl=this.Kf(this.Ob.dl);return this.ie.kkd(a)}mkd(a){this.Ob.dm=this.Kf(this.Ob.dm);return this.ie.mkd(a)}dya(a){if((a=a.Yf)&&a.style&&this.$n){var b=a.style;if(b)for(const c of b)c&&0<c.length&&this.$n.MLj(a.tagName,c)}}}Object(m.a)(lI,"HtmlEventUsageCollector",null,[1315]);class mI{constructor(a,b=null,c=null){this.ie=a;this.VS=b||Om.a.Kag("");this.F8h=c||Om.a.Lag("")}get Ob(){return this.VS}get i5e(){return this.F8h}zY(a){this.i5e.b++;
this.ie.zY(a)}wY(){this.ie.wY()}yY(a){this.i5e.c++;this.ie.yY(a)}xY(){this.ie.xY()}vY(a){this.i5e.d++;this.ie.vY(a)}uY(){this.ie.uY()}reset(){this.ie.reset()}get b4b(){return this.ie.b4b}m1(a,b){this.Ob.b++;this.ie.m1(a,b)}ooa(a){this.Ob.c++;this.ie.ooa(a)}u_a(a){this.Ob.b++;this.ie.u_a(a)}noa(a){this.Ob.d++;this.ie.noa(a)}moa(a){this.Ob.f++;this.ie.moa(a)}Gxa(a,b){this.Ob.g++;this.ie.Gxa(a,b)}Fxa(){this.ie.Fxa()}NA(a){this.Ob.h++;this.ie.NA(a)}MA(){this.ie.MA()}q_a(){this.ie.q_a()}p_a(){this.ie.p_a()}Lxa(a,
b){this.Ob.i++;this.ie.Lxa(a,b)}YJa(){this.ie.YJa()}roa(a){this.Ob.j++;this.ie.roa(a)}poa(){this.ie.poa()}Kxa(a){this.Ob.k++;this.ie.Kxa(a)}qoa(){this.ie.qoa()}r_a(a){this.Ob.l++;this.ie.r_a(a)}}Object(m.a)(mI,"SemanticEventUsageCollector",null,[1298,480]);class sC{constructor(a){this.Ah=a}reset(){this.Ah.reset()}get b4b(){return this.Ah.b4b}m1(a,b){this.Ah.m1(a,b)}ooa(a){this.Ah.ooa(a)}u_a(a){this.Ah.u_a(a)}noa(a){this.Ah.noa(a)}moa(a){this.Ah.moa(a)}Gxa(a,b){this.Ah.Gxa(a,b)}Fxa(){this.Ah.Fxa()}NA(a){this.Ah.NA(a)}MA(){this.Ah.MA()}q_a(){this.Ah.q_a()}p_a(){this.Ah.p_a()}roa(a){this.Ah.roa(a)}poa(){this.Ah.poa()}Kxa(a){this.Ah.Kxa(a)}qoa(){this.Ah.qoa()}r_a(a){this.Ah.r_a(a)}zY(a){this.Ah.zY(a)}wY(){this.Ah.wY()}yY(a){this.Ah.yY(a)}xY(){this.Ah.xY()}vY(a){this.Ah.vY(a)}uY(){this.Ah.uY()}Lxa(a,
b){this.Ah.Lxa(a,b)}YJa(){this.Ah.YJa()}}Object(m.a)(sC,"AHtmlNormalizer",null,[1298,480]);class tC extends sC{constructor(a){super(a);this.DD=!1}m1(a,b){this.DD?this.uG.MF(()=>{this.qRe(a,b)}):this.qRe(a,b)}qRe(a,b){this.Ah.m1(a,b)}ooa(a){this.DD?this.uG.MF(()=>{this.RQe(a)}):this.RQe(a)}RQe(a){this.Ah.ooa(a)}noa(a){this.DD?this.uG.MF(()=>{this.jpc(a)}):this.jpc(a)}jpc(a){this.Ah.noa(a)}moa(a){this.DD?this.uG.MF(()=>{this.QQe(a)}):this.QQe(a)}QQe(a){this.Ah.moa(a)}Gxa(a,b){this.DD?this.uG.MF(()=>
{this.LQe(a,b)}):this.LQe(a,b)}LQe(a,b){this.Ah.Gxa(a,b)}Fxa(){this.DD?this.uG.MF(Object(I.a)(this,this.KQe,"processAnchorEnd")):this.KQe()}KQe(){this.Ah.Fxa()}NA(a){this.DD?this.uG.MF(()=>{this.aRe(a)}):this.aRe(a)}aRe(a){this.Ah.NA(a)}MA(){this.DD?this.uG.MF(Object(I.a)(this,this.$Qe,"processParagraphEnd")):this.$Qe()}$Qe(){this.Ah.MA()}q_a(){this.DD?this.uG.MF(Object(I.a)(this,this.cRe,"processPreFormattedTextStart")):this.cRe()}cRe(){this.Ah.q_a()}p_a(){this.DD?this.uG.MF(Object(I.a)(this,this.bRe,
"processPreFormattedTextEnd")):this.bRe()}bRe(){this.Ah.p_a()}roa(a){this.DD?this.uG.MF(()=>{this.VQe(a)}):this.VQe(a)}VQe(a){this.Ah.roa(a)}poa(){this.DD?this.uG.MF(Object(I.a)(this,this.SQe,"processListEnd")):this.SQe()}SQe(){this.Ah.poa()}Kxa(a){this.DD?this.uG.MF(()=>{this.UQe(a)}):this.UQe(a)}UQe(a){this.Ah.Kxa(a)}qoa(){this.DD?this.uG.MF(Object(I.a)(this,this.TQe,"processListItemEnd")):this.TQe()}TQe(){this.Ah.qoa()}zY(a){this.DD?this.uG.MF(()=>{this.pRe(a)}):this.pRe(a)}pRe(a){this.Ah.zY(a)}wY(){this.DD?
this.uG.MF(Object(I.a)(this,this.mRe,"processTableEnd")):this.mRe()}mRe(){this.Ah.wY()}yY(a){this.DD?this.uG.MF(()=>{this.oRe(a)}):this.oRe(a)}oRe(a){this.Ah.yY(a)}xY(){this.DD?this.uG.MF(Object(I.a)(this,this.nRe,"processTableRowEnd")):this.nRe()}nRe(){this.Ah.xY()}vY(a){this.DD?this.uG.MF(()=>{this.lRe(a)}):this.lRe(a)}lRe(a){this.Ah.vY(a)}uY(){this.DD?this.uG.MF(Object(I.a)(this,this.kRe,"processTableCellEnd")):this.kRe()}kRe(){this.Ah.uY()}Lxa(a,b){this.DD?this.uG.MF(()=>{this.WQe(a,b)}):this.WQe(a,
b)}WQe(a,b){this.Ah.Lxa(a,b)}YJa(){this.DD?this.uG.MF(Object(I.a)(this,this.uih,"processMathEnd")):this.uih()}uih(){this.Ah.YJa()}}Object(m.a)(tC,"AQueuingHtmlNormalizer",sC,[]);class nI{constructor(a){this.next=null;this.data=a}}Object(m.a)(nI,"QueueNode",null,[]);class uC{constructor(){this.y4a=this.G3a=null;this.il=0}get count(){return this.il}get isEmpty(){return!this.il||!this.G3a||!this.y4a}enqueue(a){a=new nI(a);this.isEmpty?this.y4a=this.G3a=a:this.G3a=this.G3a.next=a;this.il++}back(){return this.isEmpty?
null:this.G3a.data}dequeue(){if(this.isEmpty)return null;const a=this.y4a;this.y4a=a.next;this.il--;this.y4a||(this.G3a=null);return a.data}clear(){this.y4a=this.G3a=null;this.il=0}toArray(){const a=Array(this.count);let b=this.y4a;for(let c=0;c<this.count&&b;c++)a[c]=b.data,b=b.next;return a}}Object(m.a)(uC,"Queue",null,[]);class xx{constructor(){this.AMd=new uC}MF(a){this.AMd.enqueue(a)}flush(a=!1){for(a&&this.csd();!this.AMd.isEmpty;)this.AMd.dequeue()();a&&this.Ipd()}csd(){}Ipd(){}}Object(m.a)(xx,
"QueuedEventManager",null,[]);class hz extends xx{constructor(a){super();this.id=void 0;this.Z1d=null;this.E1c=!1;this.Pnc="";this.D1c=this.x2c=!1;this.X1d=this.Kvb=null;this.Tlc=0;this.kbc=this.Ccc=this.wqe=!1;this.table=null;this.EJe=0;this.VP=a}get N_b(){return!!this.table}csd(){this.VP.tJb.push(this.VP.currentState);this.VP.currentState=this}Ipd(){this.VP.currentState=this.VP.tJb.pop()}}hz.nextId=void 0;Object(m.a)(hz,"ContentState",xx,[]);class oI{constructor(a,b,c){this.colSpan=a.colSpan;this.rowSpan=
a.rowSpan;this.width=a.width;this.height=a.height;this.pGa=a.pGa;this.ntc=a.ntc;this.verticalAlignment=a.verticalAlignment;this.M6=a.M6;this.Hvd=a.Hvd;this.NBb=a.NBb;this.ZLc=a.ZLc;this.contents=c;this.$xj=b}}Object(m.a)(oI,"TableCell",null,[]);class pI extends xx{constructor(a,b){super();this.VP=a;this.duf=new ju;this.IG=new ju;this.TJd=[];this.UFc=[];this.zqa=-1;this.NAa=0;this.L_h=b.rmg;this.K_h=b.uTj;this.x8h=b.Z4e;this.f7a=b.width;this.ukf=b.pGa;this.pZh=new dn(new ku(b.TU.hig,b.TU.j$b),b.xw,
b.g6,b.cultureName,b.Wia);this.h_h=b.Ihe;this.$Gc=b.QFh;this.D8h=b.tableLook}get Ah(){return this.VP.Ah}QSk(a){this.zqa++;this.duf.add(a);this.UFc[this.zqa]=a.height;this.NAa=0}get uQi(){for(;this.NAa>=this.IG.count;)this.IG.add(Array(this.zqa+1));return this.IG.ga(this.NAa)}WRd(a,b,c,f,l,y,H){if(0>this.zqa)return!1;for(;this.TJd[this.NAa]>=this.zqa;)this.NAa++;a=new oI(a,new dn(b,c,f,l,y),H);this.uQi[this.zqa]=a;if(1<a.rowSpan)for(b=this.zqa+a.rowSpan-1,f=this.NAa,c=this.NAa+a.colSpan-1;f<=c;f++)this.TJd[f]>=
b||(this.TJd[f]=b);this.NAa+=a.colSpan;this.UFc[this.zqa]<a.height&&(this.UFc[this.zqa]=a.height);return!0}csd(){this.VP.currentState.table=this}Ipd(){this.VP.currentState.table=null}x1f(){this.flush(!0);const a=this.zqa+1;var b=Array(a);for(var c=0;c<a;c++)b[c]=Array(this.IG.count);c=!0;var f=0;for(var l=0;l<this.IG.count;l++){var y=this.IG.ga(l),H=!0;for(var Q=0;Q<a;Q++){var ia=y[Q];ia&&(H=!1,b[Q][l+f]=new cz(ia.colSpan,ia.rowSpan,ia.width,ia.height,void 0,void 0,void 0,void 0,ia.pGa,ia.NBb))}H?
(this.IG.removeAt(l),l--,++f):c=!1}if(!c){(b=this.ukf?this.VP.CHf(b,this.f7a/100):this.VP.CHf(b))&&b.length!==this.IG.count&&(b=null);this.VP.gEa(!0);this.VP.LMc();this.Ah.zY(new lC(a,this.IG.count,this.f7a,this.ukf,b,this.L_h,this.K_h,this.x8h,this.h_h,this.$Gc,this.D8h,this.pZh));for(b=0;b<a;b++){c=this.duf.ga(b);this.Ah.yY(new kC(this.UFc[b],new dn(c.TU,c.xw,c.g6,c.cultureName,c.Wia)));for(c=0;c<this.IG.count;c++){f=this.IG.ga(c)[b];var wa=!!this.$Gc&&""!==this.$Gc&&"Custom"!==this.$Gc;l=f?f.colSpan:
0;y=f?f.rowSpan:0;H=f?f.width:0;Q=f?f.height:0;ia=f?f.ZLc:0;const Ua=f?f.pGa:!1,kb=f&&(65536&ia||!wa)?f.ntc:"",Gb=f?f.verticalAlignment:0,ec=f?f.NBb:!1;wa=f?this.VP.xmj(f.M6,c,b,this.IG,wa,f.ZLc):new gC;const dc=f?f.Hvd:new hC,Fc=f?f.$xj:null;this.Ah.vY(new cz(l,y,H,Q,kb,Gb,wa,dc,Ua,ec,ia,new dn(Fc?Fc.TU:null,Fc?Fc.xw:null,Fc?Fc.g6:null,Fc?Fc.cultureName:null,Fc?Fc.Wia:null)));f&&!f.NBb&&(f.contents.csd(),f.contents.flush(),this.VP.gEa(!1),this.VP.LMc(),f.contents.Ipd());this.Ah.uY()}this.Ah.xY()}this.Ah.wY();
this.VP.currentState.kbc=!1;this.VP.JXf(!1)}}}Object(m.a)(pI,"NormalizedTable",xx,[]);class vC{constructor(a=!1,b=!1){this.i0h=a;this.BI=b}get uYj(){return this.i0h}get nV(){return this.BI}}Object(m.a)(vC,"HtmlNormalizerSettings",null,[347]);class hs extends tC{constructor(a,b=null){super(a);this.currentState=null;this.tJb=new tx;this.Kpb=b||new vC}reset(){super.reset();this.currentState=new hz(this);this.tJb.clear();this.DD=!1}get uG(){return this.currentState&&this.currentState.N_b?this.currentState.table:
this.currentState}zRc(a=!1){this.currentState.E1c||(this.LMc(),this.Ah.NA(this.currentState.Z1d),this.currentState.E1c=!0,this.currentState.kbc=!1);a||!this.currentState.Kvb||this.currentState.D1c||(this.Ah.Gxa(this.currentState.Kvb,this.currentState.X1d),this.currentState.D1c=!0)}y5b(){this.currentState.D1c&&(this.Ah.Fxa(),this.currentState.D1c=!1)}n_i(){this.currentState.E1c&&(this.Ah.MA(),this.currentState.E1c=!1,this.currentState.Pnc="")}JXf(a){this.currentState.Ccc&&(this.currentState.kbc?a||
(this.Ah.NA(null),this.Ah.MA(),this.Ah.qoa(),this.currentState.Ccc=!1):(this.Ah.qoa(),this.currentState.Ccc=!1,this.currentState.kbc=!0))}gEa(a){this.y5b();this.n_i();this.JXf(a)}SJk(a){this.Ah.roa(new ux(2,1,a));this.currentState.Tlc++;this.currentState.wqe=!0}LMc(){!this.currentState.Ccc&&this.currentState.wqe&&(this.Ah.poa(),this.currentState.Tlc--,this.currentState.wqe=!1)}qRe(a,b){a=this.wyk(a);if(""!==a)if(this.zRc(),this.currentState.x2c)this.rRe(a,b);else{a=a.split(hs.gvi);for(let c=0;c<a.length-
1;c++)this.rRe(a[c],b),this.Ah.u_a(b);this.rRe(a[a.length-1],b)}}WQe(a,b){""!==a&&(this.zRc(),this.Ah.Lxa(a,b))}RQe(a){this.Kpb.nV||this.y5b();this.zRc(!0);this.Ah.ooa(a)}QQe(a){this.currentState.N_b||this.Ah.moa(a)}jpc(a){this.currentState.Kvb&&(a.href=this.currentState.Kvb);super.jpc(a)}LQe(a,b){this.y5b();this.currentState.Kvb=a;this.currentState.X1d=b}KQe(){this.y5b();this.currentState.Kvb=null;this.currentState.X1d=null}aRe(a){this.currentState.Z1d=a;this.gEa(!0)}$Qe(){this.currentState.Z1d=
null;this.gEa(!0)}cRe(){this.currentState.x2c=!0}bRe(){this.currentState.x2c=!1}VQe(a){this.gEa(!1);this.LMc();this.Ah.roa(a);this.currentState.Tlc++}SQe(){this.gEa(!1);this.Ah.poa();this.currentState.Tlc--}UQe(a){this.gEa(!1);this.currentState.Tlc||this.SJk(a);this.Ah.Kxa(a);this.currentState.Ccc=!0;this.currentState.kbc=!0}TQe(){this.gEa(!1)}zY(a){this.currentState.N_b||(this.DD=!0,this.currentState.table=new pI(this,a))}pRe(){}wY(){if(this.currentState.table){var a=this.currentState.table;this.currentState.table=
null;this.tJb.isEmpty?(this.DD=!1,a.x1f()):this.uG.MF(Object(I.a)(a,a.x1f,"flushTable"))}}mRe(){}yY(a){this.currentState.N_b&&this.currentState.table.QSk(a)}oRe(){}xY(){}nRe(){}vY(a){let b=!1;if(this.currentState.N_b){const c=new hz(this);this.currentState.table.WRd(a,new ku(a.TU.hig,a.TU.j$b),a.xw,a.g6,a.cultureName,a.Wia,c)?(this.tJb.push(this.currentState),this.currentState=c):b=!0}else b=!0;b&&this.currentState.EJe++}lRe(){}uY(){0<this.currentState.EJe?this.currentState.EJe--:this.currentState=
this.tJb.pop()}kRe(){}CHf(a,b=1){if(!a)return null;const c=a.length;if(!c)return null;const f=a[0].length;for(var l=1;l<c;l++)if(a[l].length!==f)return null;l=Array(f+1);l[0]=0;const y=Array(f+1);for(var H=0;H<y.length;H++)y[H]=!1;H=new Na.a;for(let ia=0;ia<f;ia++){for(var Q=0;Q<c;Q++)if(a[Q][ia]&&0<a[Q][ia].width){const wa=Math.min(ia+a[Q][ia].colSpan,f);l[wa]=l[ia]+a[Q][ia].width*(a[Q][ia].pGa?b:1);y[wa]=!0}if(y[ia+1]){Q=l[ia+1]-l[ia];if(0>=Q)return null;H.add(Q)}else l[ia+1]=l[ia]}return H.toArray()}vuk(a,
b){1&b||(a.borderTopStyle=12);16&b||(a.borderRightStyle=12);256&b||(a.borderBottomStyle=12);4096&b||(a.borderLeftStyle=12);return a}xmj(a,b,c,f,l,y){if(!a)return null;l&&(a=this.vuk(a,y));if(0>c||0>b||b>f.count-1)return a;0<=b-1&&c<=f.ga(b-1).length-1&&1===a.borderLeftStyle&&(l=f.ga(b-1)[c])&&1!==l.M6.borderRightStyle&&(a.borderLeftStyle=l.M6.borderRightStyle,a.borderLeftColor=l.M6.borderRightColor,a.borderLeftWidth=l.M6.borderRightWidth);0<=c-1&&c<=f.ga(b).length-1&&1===a.borderTopStyle&&(b=f.ga(b)[c-
1])&&1!==b.M6.borderBottomStyle&&(a.borderTopStyle=b.M6.borderBottomStyle,a.borderTopColor=b.M6.borderBottomColor,a.borderTopWidth=b.M6.borderBottomWidth);return a}wyk(a){this.currentState.x2c||(a=this.Kpb.uYj?a.replace(hs.GJj," "):a.replace(hs.FJj," "));a.startsWith(" ")&&(this.currentState.Pnc.endsWith(" ")||""===this.currentState.Pnc)&&(a=ma.a.substring(a,1,a.length));return a}rRe(a,b){""!==a&&(this.Ah.m1(a,b),this.currentState.Pnc+=a)}}hs.FJj=RegExp("[ \t\f\u200b\r\n]+","g");hs.GJj=RegExp("[ \f\u200b\r\n]+",
"g");hs.gvi="\t";Object(m.a)(hs,"DefaultHtmlNormalizer",tC,[]);class qI extends hs{constructor(a,b,c){super(a,c);this.Nhf=!1;this.N4a=b}jpc(a){this.N4a.vld&&(w.AFrameworkApplication.ZQ?this.Nhf||(a=new Ai.StandardDialog,a.Ad=0,a.Oe(1,CommonUIStrings.l_DialogClose),a.Tx(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,1,null),this.Nhf=!0):this.N4a.evk?this.N4a.n3g=!0:a.src&&""!==a.src?yg.a.DQ(a.src)===yg.a.DQ(window.location.href)?w.AFrameworkApplication.Ra.processAction(C.a.afh,
2):a.src.startsWith("data:")&&19922944<a.src.length?w.AFrameworkApplication.Ra.processAction(C.a.Zeh,2):a.src.startsWith("webkit-fake-url")?w.AFrameworkApplication.Ra.processAction(C.a.Yeh,2):(N.a.instance.ga(1)?this.gEa(!1):N.a.instance.ga(11)&&(this.y5b(),this.zRc(!0)),this.Ah.noa(a)):w.AFrameworkApplication.Ra.processAction(C.a.$eh,2))}}Object(m.a)(qI,"Box4HtmlNormalizer",hs,[]);class rI{constructor(a,b,c,f,l,y,H,Q,ia,wa){this.htmlProcessor=a;this.khe=b;this.OQh=c;this.Z7i=f;this.$gl=l;this.ahl=
y;this.nZc=H;this.zJj=Q;this.BJj=ia;this.q9j=wa}}Object(m.a)(rI,"ExecutePasteArguments",null,[]);class sI extends Pj{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb){super(b,c,f,Ua);this.C7=null;this.Eia=a;this.DBd=l;this.sGd=y;this.FPd=H;this.oRd=Q;this.Mpb=ia;this.Kpb=Gb;this.Oa=wa;this.hGd=Object.assign(new iC,{Dac:2===this.ag.URa||3===this.ag.URa});this.AEd=kb;this.DYb=wa.ka("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.U6h=wa.ka("ParseStyleFromRawHtmlHeadIsEnabled")}get shd(){return!1}get Vmg(){return!ma.a.YEl(ma.a.kDc,
this.Eia.innerText)}get dNf(){return this.Eia.innerText}JYf(a){this.C7=new ob.GraphIterator;this.fjb.restore(this.C7);ka.ULS.shipAssertTag(6305550,307,Wd.OutlineElementReader.ih(this.C7));this.ag.o1&&this.ag.o1.cKc("external");var b=this.ag.Ip&8192?1:0,c=this.sGd.value.create(b,this.C7);const f=this.FPd.value.create(b,this.C7),l=Om.a.oee(w.AFrameworkApplication.userSessionId),y=Om.a.hae(z.a.Z7a,this.ag.pZd),H=Om.a.Kag(w.AFrameworkApplication.userSessionId),Q=Om.a.Lag(w.AFrameworkApplication.userSessionId),
ia=this.DYb?this.gOj():null,wa=Om.a.N7f(z.a.Z7a,this.ag.pZd),Ua=Om.a.O7f(w.AFrameworkApplication.userSessionId),kb=this.Mpb.tAh?Om.a.Akj(w.AFrameworkApplication.userSessionId):null;b=this.DBd.value.create(b,this.C7,c,f,null,y);b=new mI(b,H,Q);b=new qI(b,c,this.Kpb);this.Mpb.Voe&&(this.hGd.Uoe=this.ag.Ip&16384?!0:!1);b=new xl(b,this.Mpb,this.hGd,kb);b=new lI(b,wa,ia,this.Oa);b=new or(b,Ua);c=new rI(b,c,l,y,H,Q,ia,wa,Ua,kb);c=new Lh.a(a,Object(I.a)(this,this.SSk,"preprocessStyle"),c);c.$l("paste and request pictures");
c.Wi=!a||a.Wi;c.run()}SSk(a){if(this.U6h){const b=this.Eia.getElementsByTagName("style");if(b&&0<b.length){ka.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let c=0;c<b.length;c++)this.AEd.iIi(this.Eia,b[c]),b[c]&&(b[c].parentNode.removeChild(b[c]),c--)}}a.hh(Object(I.a)(this,this.yIi,"convertWordListHtml"));return!0}yIi(a,b){this.oRd.value.create(b.OQh).process(this.Eia,a);a.hh(Object(I.a)(this,this.gUk,"processHtml"));return!0}gUk(a,
b){b.htmlProcessor.process(this.Eia,a);b=b.khe&&b.khe.vld?Object(I.a)(this,this.Gpd,"requestImages"):Object(I.a)(this,this.ZWf,"endPasteOperation");a.hh(b);return!0}Gpd(a,b){if(b=b.khe){let c=!1,f=!1,l=!1,y=!1,H=-1;const Q=new J.DictionaryPropertySet,ia=RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');if(Object(Wa.a)(10,this.ag.zd)){c=this.ag.zd.sa(Ab.a.Zne,!1);const wa=this.ag.zd.sa(ee.a.VU,"");l=this.ag.zd.sa(ee.a.y1c,!1);y=this.ag.zd.sa(ab.a.kO,!1);ia.test(wa)&&(f=!0);this.vAh&&(H=this.ag.zd.sa(dt.a.Y4b,
-1))}else this.ag.Ip&256&&this.Eia&&(c=!0,ia.test(this.Eia.innerHTML)&&(f=!0));Q.setValue(Ab.a.Zne,c);Q.setValue(ee.a.r5j,f);Q.setValue(ee.a.y1c,l);Q.setValue(dt.a.Y4b,H);Q.setValue(ab.a.kO,y);b.C6g&&(this.ag.hbc=!0,this.ag.Ahe=b.OPc,this.ag.pKe=b.C6g,w.AFrameworkApplication.Ra.processAction(C.a.Gpd,2))}a.hh(Object(I.a)(this,this.ZWf,"endPasteOperation"));return!0}ZWf(a,b){Om.a.Cdk(b.OQh);Om.a.Cbk(b.BJj);Om.a.Pck(b.$gl);Om.a.Qck(b.ahl);Om.a.Vbk(b.q9j);a="Others";b.nZc&&(b.nZc.zbk(),b.nZc.Abk(),a=
b.nZc.i3e);Om.a.Bbk(b.zJj,a);Om.a.qbk(b.Z7i,a);return!1}gOj(){const a=new kI;a.KJb=z.a.Z7a;this.ag&&(a.Ip=this.ag.Ip,a.GNe=this.ag.pZd,this.ag.zd&&(a.uRe=this.ag.zd.sa(ee.a.Xeh,"")));this.Eia&&this.Eia.innerHTML&&(a.Weh=this.Eia.innerHTML.length);w.AFrameworkApplication.Od&&(a.platform=w.AFrameworkApplication.Od.Platform);return a}get IAh(){return!0}get HAh(){ka.ULS.shipAssertTag(6305551,307,!!this.C7);if(this.Mpb.uAh(this.hGd)){let a=!1;Wd.OutlineElementReader.ih(this.C7)&&(this.C7.c9b(),a=!0);const b=
Db.ParagraphReader.ql(this.C7)&&!this.C7.currentNode.sa(ee.a.Png,!1);a&&this.C7.Cc();return b}return Db.ParagraphReader.ql(this.C7)}}Object(m.a)(sI,"ExternalPasteExecutionManager",Pj,[]);class tI{constructor(a,b,c,f,l,y,H,Q){this.DBd=a;this.sGd=b;this.FPd=c;this.oRd=f;this.Mpb=l;this.Oa=y;this.AEd=H;this.Kpb=Q}create(a,b,c,f){return new sI(a,b,c,f,this.DBd,this.sGd,this.FPd,this.oRd,this.Mpb,this.Oa,Rc.App.Lb.Kd,this.AEd,this.Kpb)}}Object(m.a)(tI,"Factory",null,[1248]);class iz{constructor(a){this.ula=
a.mjj();this.Oab=a.DVc("intCopy");this.Ikd=a.Obe("intCopy");this.v8a=a.uUc("intCopy");this.jRa=a.jUc("intCopy")}static PW(){return iz.Fr()}static Fr(){return new iz(Zd.a.instance)}}Object(m.a)(iz,"InternalCopyUsageHelper",null,[]);class yx{constructor(a,b,c){this.DN=iz.PW();this.oMc=null;this.Btd=this.Pyd=!1;this.egf=null;this.source=a;this.target=b;this.dOe=c}get e7(){return this.DN}get vL(){return this.egf}set vL(a){this.egf=a}}Object(m.a)(yx,"InternalCopyArguments",null,[]);class uI extends yx{constructor(a,
b,c,f){super(a,b,{});this.aNb=[];for(a=0;a<c.length;a++)Array.addRange(this.aNb,c.ga(a).toArray());this.Isa=0;this.zyj=f}}Object(m.a)(uI,"BasicInternalCopyArguments",yx,[]);class vI extends Sys.EventArgs{constructor(a){super();this.vL=a}}Object(m.a)(vI,"BeforePasteArguments",Sys.EventArgs,[]);class jz extends yx{constructor(a,b){super(a.source,a.target,a.dOe);this.ag=a;this.insertAfter=b}get e7(){return this.ag.e7}get vL(){return this.ag.vL}set vL(a){this.ag.vL=a}}Object(m.a)(jz,"CoreInternalCopyArguments",
yx,[]);class kz{constructor(a,b,c,f,l=null){this.source=a;this.target=b;this.insertAfter=c;this.ukd=f;this.vL=l||{}}}Object(m.a)(kz,"CoreInternalPasteArguments",null,[]);class wI{constructor(a,b,c,f,l,y,H,Q,ia){this.IPb=a;this.source=b;this.target=c;this.ukd=f;this.rowIndex=l;this.Jja=y;this.Leh=Q;this.Nf=ia}}Object(m.a)(wI,"CoreInternalTablePasteArguments",null,[]);class lz extends Sys.EventArgs{constructor(a,b,c,f,l){super();this.operation=a;this.clone=f;this.vL=l}}Object(m.a)(lz,"ParagraphCopyPasteArguments",
Sys.EventArgs,[]);var pr=d(210);class vi{static zr(){vi.GMb=new Pb.a;vi.GMb.$(88,!0);vi.GMb.$(4,!0)}static Kta(a,b,c){const f=[];if(N.a.instance.ga(104)&&a.Sl&&Od.SelectionFactory.r4j(a))a=ob.GraphIterator.pb(a.mb.qg.Va.node),a.sc(14),c=cb.a.create(a.origin),c=vi.uKc(c,!0,!0,null),a.set(c),Mb.SelectionEditor.Mt(a),vi.zTa(a,f);else for(let wa=0;wa<a.length&&!(c&&0<f.length);++wa){var l=a.ga(wa),y=vi.vVc(l,!0),H=vi.vVc(l,!1);if(!y||!H)continue;if(y===H&&y.contextId===yb.a.Mf){l=ob.GraphIterator.pb(y.node);
l.sc(11)&&vi.zTa(l,f);continue}var Q=void 0;Q=l=null;var ia=-1;let Ua;if(y.node===H.node)Ua=y.node,H=H.node;else{Q=vi.G3f(y.node);l=vi.G3f(H.node);for(ia=0;ia<Q.length&&ia<l.length&&Q[ia]===l[ia];++ia);Q=Q[ia-1];--ia;Ua=vi.uKc(y,!0,!1,Q);H=vi.uKc(H,!1,!0,Q)}if(Ua===H)l=Ua===y.node?y:cb.a.create(Ua),l=vi.uKc(l,!0,!0,null),y=new Cn.a,y.set(l),Mb.SelectionEditor.Mt(y),vi.zTa(y,f);else{y=new Cn.a;y.set(Ua);Mb.SelectionEditor.Mt(y);Ua===Q&&y.Oi();for(vi.zTa(y,f);y.parentNode!==Q;){for(;y.np();)vi.zTa(y,
f);y.Cc()}if(H===Q)for(;y.np();)vi.zTa(y,f);else{y.np();for(Q=ia+1;Q<l.length;++Q){for(;y.currentNode!==l[Q];)vi.zTa(y,f),y.np();if(H===l[Q])break;y.Oi()}vi.zTa(y,f)}}}if(0>=f.length)return null;if(b)for(b=new ob.GraphIterator,a=0;a<f.length;++a)b.set(f[a].node),Za.OutlineElementNavigator.yi(b),f[a]=cb.a.create(b.currentNode);return ub.a.cSa(f)}static vVc(a,b){if(b)for(b=0;b<a.length;++b){if(a.ga(b).Pk)return a.ga(b);if(a.ga(b).Bx){var c=a.ga(b);for(var f=0;f<c.length;++f)if(c.getContext(f).Pk)return c.getContext(f)}}else for(b=
a.length-1;0<=b;--b){if(a.ga(b).Pk)return a.ga(b);if(a.ga(b).Bx)for(c=a.ga(b),f=c.length-1;0<=f;--f)if(c.getContext(f).Pk)return c.getContext(f)}return null}static zTa(a,b){vi.yqg(a)?vi.s4i(a,b):vi.GMb.Fb(a.role)||(a=a.ix(11),!a||b.length&&b[b.length-1].node===a||Array.add(b,cb.a.create(a)))}static G3f(a){const b=[],c=new ob.GraphIterator;c.set(a);Mb.SelectionEditor.Mt(c);for(Array.add(b,a);c.Cc();)Array.add(b,c.currentNode);b.reverse();return b}static uKc(a,b,c,f){let l=a.node;if(Mb.SelectionEditor.tk(a)&&
(b&&0<a.Sa||c&&a.Mb<Db.ParagraphReader.textLength(l))||Mb.SelectionEditor.im(a)&&b&&0<Db.ParagraphReader.textLength(l))return l;a=new Cn.a;a.set(l);for(Mb.SelectionEditor.Mt(a);!a.mr;){l=a.currentNode;if(f===l||b&&!vi.LWj(a)||c&&!vi.ZYj(a))return l;a.Cc()}return a.currentNode}static ZYj(a){let b=!0;if(a.np())for(b=!1;vi.GMb.Fb(a.role)||N.a.instance.ga(77)&&16===a.Bi&&ae.isGhostCell(a);)if(!a.np()){b=!0;break}return b}static LWj(a){const b=a.currentNode;let c=!0;if(a.qua())for(c=!1;vi.GMb.Fb(a.role);)if(!a.qua()){c=
!0;break}a.Cc();a.$k(b);return c}static s4i(a,b){a=tk.a.xv(a);for(a.qm(vi.h4i,null);a.moveNext();)Wd.OutlineElementReader.I9(a.currentNode)&&Array.add(b,cb.a.create(a.currentNode))}static h4i(a){return vi.yqg(a)}static yqg(a){return a.mr||1===a.role||27===a.role}}vi.GMb=null;Object(m.a)(vi,"OutlineElementGeneralizer",null,[]);vi.zr();class xI{constructor(){this.controlCell=this.rn=null;this.colSpan=this.rowSpan=0;this.response=2}}Object(m.a)(xI,"ComplexCellData",null,[]);var zx=d(180);class wC{constructor(a){this.ln=
a;a.U$j()}dispose(){this.ln.VLl()}static pb(a){return new wC(a.gk)}}Object(m.a)(wC,"TempGraphAlgorithmLock",null,[107]);class Qh{constructor(a,b,c){this.Tef=this.zI=null;this.GEc=[];this.cAc=[];this.UGc=[];this.QSb={};this.$Kd={};this.WAd={};this.bE=null;this.L6a=Qh.yvj(a);this.L6a.Auk();this.Y8h=wC.pb(this.L6a);Qh.Uob=this;this.S7=1;this.mDd=b;this.f4a=c}get Yq(){return this.bE||(this.bE=Ib.a.instance.resolve("Box4.ITableEditor"))}get cK(){return this.zI||(this.zI=Ib.a.instance.resolve("Box4.Pages.IPageContentEditor"))}normalize(){if(!(0<
--this.S7)){var a=new pf.GraphTransaction(7);a.ld(this.L6a);this.vVk();this.wvk();this.$5i();N.a.instance.ga(63)&&this.xAi();this.b6i();a.dispose();this.r3()}}Jol(a){this.Tef=a}b6i(){var a=ob.GraphIterator.pb(this.L6a);if(!a.rFa()){const b=this.cK.p3b(a);Qh.aC.nW(a,!0);a=Rc.App.Lb.Kd.Mn;a.qp&&Qh.aC.wsd(b,a.X8b())}}cancel(){if(!(0<--this.S7)){var a=zx.a.bA(this.L6a);for(a.qm(Qh.ucf,null);a.moveNext();)a.iterator.mr||a.iterator.oZ(16,!1);this.r3()}}r3(){this.L6a.WLl();this.Y8h.dispose();Qh.Uob=null}Qpa(a){a.Pk?
(Qh.m5j(a)&&Array.add(this.GEc,a.node),this.rJh(a.node)):a.Bx&&this.uHl(a)}uHl(a){for(let b=0;b<a.length;++b)this.Qpa(a.getContext(b))}rJh(a){a.anchor.WT(16)}wvk(){for(let b=0;b<this.GEc.length;++b){var a=this.GEc[b];if(!a.anchor||a.anchor.qJ)continue;const c=new ob.GraphIterator;c.set(a);if(!Mb.SelectionEditor.Mt(c))continue;Za.OutlineElementNavigator.Te(c);if(this.f4a.Nwi(c)){Qh.Wh.RDa(c);continue}a=new Cn.a;a.Tc(c);if(!Za.OutlineElementNavigator.ZJ(a,!1,!1))continue;if(36===a.role)continue;Za.OutlineElementNavigator.yi(a);
if(a.currentNode.cX)continue;if(cd.TableReader.iq(a))continue;Za.OutlineElementNavigator.Te(a);const f=new ob.GraphIterator;f.Tc(a);f.Cc();Qh.Wh.merge(c,a,!1,!1);Wd.OutlineElementReader.pJ(f)&&!f.rFa()&&a.Ni()}Array.clear(this.GEc)}xAi(){for(let a=0;a<this.UGc.length;++a){const b=this.UGc[a];if(!b.anchor||b.anchor.qJ)continue;if(ae.isGhostCellNode(b))continue;const c=new ob.GraphIterator;c.set(b);c.zB(1);c.Cb(2);cd.TableReader.iq(c)&&(c.Cc(),Qh.Wh.nea(c,!1,!0,null))}Array.clear(this.UGc)}Scj(a){const b=
a.id.toString();if(this.QSb[b])return this.QSb[b];const c=Array(cd.TableReader.Gi(a));for(let f=0;f<cd.TableReader.Gi(a);++f)c[f]=0;this.QSb[b]=c;this.$Kd[b]=cd.TableReader.Gk(a);return c}vVk(){const a=zx.a.bA(this.L6a);a.qm(Qh.ucf,null);var b=a.moveNext();const c=new ob.GraphIterator;let f=0;for(;b;)if(a.iterator.mr)this.kAi(a.iterator),b=a.moveNext();else if(this.f4a.k0j(a.iterator)&&Array.add(this.cAc,a.iterator.currentNode),N.a.instance.ga(63)&&ae.isTableCell(a.iterator)&&Array.add(this.UGc,a.iterator.currentNode),
Qh.Ywi(a.iterator))switch(a.iterator.Bi){case 16:b=Sd.getContainingTable(a.iterator);if(this.mDd&&!cd.TableReader.wt(b)&&!ae.isGhostCell(a.iterator)){b=this.Scj(b);var l=Qn.a(a.iterator);++b[l]}b=a.moveNext();break;case 15:b=Sd.getContainingTable(a.iterator);this.mDd&&!cd.TableReader.wt(b)?(this.WAd[b.id.toString()]=!0,c.Tc(a.iterator),b=a.moveNext(),this.Yq.APc(c)):b=a.moveNext();break;case 14:a.iterator.currentNode!==this.Tef?(a.moveNext(),c.Tc(a.iterator),b=a.moveNext(),Qh.Wh.RDa(c)):(a.iterator.oZ(16,
!1),b=a.moveNext());break;case 23:c.Tc(a.iterator);b=a.moveNext();c.Ni();break;case 11:f++;ze.b(a.iterator)?(a.iterator.oZ(16,!1),b=a.moveNext()):(c.Tc(a.iterator),Zb.ListReader.Hk(c)&&!this.f4a.d1e(c,f)&&Qh.jq.Roa(c),c.gJ(2)?this.f4a.Esl(c,f)?b=a.moveNext():(c.Tc(a.iterator),b=a.moveNext(),Qh.Wh.RDa(c)):(b=a.moveNext(),Qh.Wh.RDa(c)));break;case 12:b=a.moveNext();break;default:b=a.moveNext()}else{l=!0;if(cd.TableReader.iq(a.iterator)&&this.mDd){var y=a.currentNode;let H=y.id.toString();const Q=this.QSb[H];
let ia=!1;if(Q){const wa=this.$Kd[H];for(y=cd.TableReader.Gi(y)-1;0<=y;--y)Q[y]===wa&&(this.Yq.yPc(a.iterator,y),ia=!0)}cd.TableReader.Gi(a.iterator.currentNode)?N.a.instance.ga(30)&&(ia||this.WAd[H])&&cd.TableReader.Ppe(a.iterator.currentNode)&&(c.Tc(a.iterator),Sd.moveToFirstRow(c),Sd.moveToFirstColumn(c),b=a.moveNext(),Qh.Wh.Xph(a.iterator,c)):(a.moveNext(),c.Tc(a.iterator),b=a.moveNext(),c.Ni(),l=!1)}l&&(a.iterator.oZ(16,!1),b=a.moveNext())}this.QSb={};this.$Kd={};this.WAd={}}kAi(a){if(a.Oi()){do a.oZ(16,
!1);while(a.oFa())}}$5i(){for(let b=0;b<this.cAc.length;++b){var a=this.cAc[b];if(a.anchor&&!a.anchor.qJ){const c=new ob.GraphIterator;c.set(a);xg.OutlineNavigator.saa(c)||(c.currentNode.setValue(ab.a.YE,$m.a.first),N.a.instance.ga(41)&&10===c.Bi&&(a=Qh.Wh.Hie(c,null,1),c.$k(a)),Qh.aC.nW(c,!0))}}Array.clear(this.cAc)}static get jq(){return Qh.fp||(Qh.fp=Ib.a.instance.resolve("Box4.List.IListEditor"))}static get aC(){return Qh.ay||(Qh.ay=Ib.a.instance.resolve("Box4.IOutlineEditor"))}static get Wh(){return Qh.Ji||
(Qh.Ji=Ib.a.instance.resolve("Box4.IOutlineElementEditor"))}static get hI(){return $h.a.instance}static get fj(){return bh.a.instance}static oWc(a,b){Qh.Uob?Qh.Uob.S7++:Qh.Uob=new Qh(a,b,Ib.a.instance.resolve("Box4.Actors.IDeleteOutlineElementNodeStrategy"));return Qh.Uob}static yvj(a){a=ob.GraphIterator.pb(a);Mb.SelectionEditor.Mt(a);a.BMb(b=>b.zcc);return a.currentNode}static m5j(a){let b=!1;Mb.SelectionEditor.im(a)&&(b=!N.a.instance.ga(14)||!Qh.fj.$0c(a));!b&&Db.ParagraphReader.Fm(a)&&(b=!N.a.instance.ga(14)||
!Qh.fj.f2c(a)&&!a.node.sa(Ab.a.Jcb,!1));return b}static Ywi(a){switch(a.Bi){case 12:return a.currentNode.LLc}if(!a.Oi())return Qh.hI.ctg(a)?Qh.hI.NXd(a.currentNode):!0;let b=!0;do{switch(a.role){case 2:case 1:case 3:case 86:case 87:a.bX&16||16===a.Bi&&ae.isGhostCell(a)||(b=!1)}a.oZ(16,!0)}while(a.oFa());b&&Qh.hI.ctg(a)&&(b=Qh.hI.NXd(a.currentNode));return b}static Mwi(a){return a.mr||!!(a.bX&16)}}Qh.ucf=Qh.Mwi;Qh.Uob=null;Qh.Ma=new Pc.a;Qh.ay=null;Qh.fp=null;Qh.Ji=null;Object(m.a)(Qh,"GraphStructureNormalizer",
null,[]);class is{constructor(){this.U1a=this.rn=this.RA=null;this.KJa=0;this.response=2}}Object(m.a)(is,"TableGeneralizeData",null,[]);class ii{static get ym(){return Ch.ContextSetEditor.instance}static k6(a,b,c,f,l,y,H){let Q=!1;y&&y[ii.zRb]&&y[ii.zRb]&&(Q=!0);if(!b.view.Sh)return 2;const ia=b.view;var wa=ia.Nb;if(1===c){if(!wa||!wa.Pa.mb)return 8;b=0===H?b.UE:ii.ym.N6b(b.UE,H,!0);return w.AFrameworkApplication.Ra.ei(b,a,c,!0,f,l)}y&&y[ii.bqa]&&pb.a.mark(y[ii.bqa]);const Ua=rn.SelectionReferenceFactory.instance.Nsa(),
kb=wa.Pa.mb.Va;wa=new pf.GraphTransaction(15);wa.ld(kb.node);wa.aza();b=0===H?b.UE:ii.ym.N6b(b.UE,H);a=w.AFrameworkApplication.Ra.ei(b,a,c,!0,f,l);32===a&&Ua.bV(Q);v.FocusManager.instance().vf(ia.VI);wa.dispose();Rc.App.Lb.updateCommandUI();y&&y[ii.aqa]&&pb.a.mark(y[ii.aqa]);return a}static Oib(a,b,c,f,l,y){var H=ge.a.instance;let Q,ia=!1;y&&y[ii.zRb]&&y[ii.zRb]&&(ia=!0);if(1===c)return H&&H.Pa.mb?(Q=vi.Kta(H.Pa,!1,!0))?w.AFrameworkApplication.Ra.ei(Q,a,c,!0,f,l):8:8;y&&y[ii.bqa]&&pb.a.mark(y[ii.bqa]);
const wa=rn.SelectionReferenceFactory.instance.Nsa(),Ua=H.Pa.mb.Va;Q=vi.Kta(H.Pa,!1);if(!Q)return 8;H=new pf.GraphTransaction(15);H.ld(Ua.node);H.aza();a=w.AFrameworkApplication.Ra.ei(Q,a,c,!0,f,l);32===a&&wa.bV(ia);(b=b.view)&&v.FocusManager.instance().vf(b.VI);H.dispose();Rc.App.Lb.updateCommandUI();y&&y[ii.aqa]&&pb.a.mark(y[ii.aqa]);return a}}ii.bqa="PerfMarkStart";ii.aqa="PerfMarkEnd";ii.zRb="CollapseIp";Object(m.a)(ii,"ViewActionHandler",null,[]);var yI=d(567);class zI{constructor(){this.controlCell=
null;this.xLf=this.Fsh=0;this.Q0f=this.R0f=null}}Object(m.a)(zI,"MergedCellInfo",null,[]);var Ax=d(322),AI=d(683),LQ=d(736),Rn=d(370);class Fv extends Jj.a{constructor(a){super(0,0,0);this.v3=a;this.XNa=Array(a)}Vcj(a){return this.XNa[a]}jwh(a,b){this.XNa[a]=b}copy(){const a=new Fv(this.v3);for(let b=0;b<this.v3;++b)a.XNa[b]=this.XNa[b];return a}Evk(){let a=Rn.a.ymb;for(let b=0;b<this.v3;++b)a+=this.XNa[b]+1;return a}static bDi(a,b){const c=new Fv(a.v3);for(let f=0;f<c.v3;f++)c.XNa[f]=Math.max(a.XNa[f],
b.XNa[f]);return c}}Object(m.a)(Fv,"TableRowViewSizeConstraints",Jj.a,[]);class lu extends sg.a{constructor(a,b,c,f,l,y=null){super(a,b,c);this.F3a=null;this.OCd=0;this.Zyc=-1;this.kd=f;this.hd=l;this.hc(this.Nd.lp(Ca.a.tr));this.htmlElement.className="TableRow";Hb.d(this.htmlElement,va.a.role,"row");this.Mph();this.eff=y}Yy(){this.gb.aeh=[];this.htmlElement.style.height=this.Dsh;this.Mph()}Mph(){this.kd&&this.kd.VFa(65)&&(this.gb.L2b?Sys.UI.DomElement.addCssClass(this.htmlElement,fc.p4):Sys.UI.DomElement.removeCssClass(this.htmlElement,
fc.p4))}Gjl(a){const b=this.Zyc!==a;this.Zyc=a;return b}YPl(){this.htmlElement.style.height=this.Esh+"px"}get Esh(){let a=0>=this.Zyc?lu.f4g:this.Zyc;this.gb.Ua(Ab.a.Fu)&&(a=Math.max(a,this.Nd.Md.Ne(this.gb.eb(Ab.a.Fu),1)));return a}get Dsh(){return this.gb.Ua(Ab.a.Fu)?this.Nd.Md.Ne(this.gb.eb(Ab.a.Fu),1)+"px":"auto"}$U(a){super.$U(a);var b=cd.TableReader.Gi(Sd.getContainingTable(a));let c=0;b=new Fv(b);if(a.Cb(1)){do b.jwh(c,a.fr.iMa.total),c++;while(a.Nj(1))}return b}yK(a){super.yK(a);this.aS.PU(this.htmlElement)}get author(){return this.F3a}R8e(a){let b=
!0;if(this.Qc.qp&&this.Qc.ZSj){a=tk.a.xv(a);for(var c={};a.moveNext();){if(!Wd.OutlineElementReader.ih(a.iterator)||Wd.OutlineElementReader.cge(a.iterator))continue;const f=Wd.OutlineElementReader.hUc(a.currentNode,ab.a.x0b);f&&(c[f]="")}a=ta.a.join(c,Box4Intl.Box4Strings.l_UserInitialsDelimeter,"");c=Sys.UI.DomElement.getBounds(this.htmlElement);0<c.height&&(this.F3a=a,this.OCd=c.height,b=!1)}b&&(this.F3a="",this.OCd=-1)}get D_d(){return this.OCd}A9k(){this.eff&&this.eff.bZl(this)}}lu.f4g=20;Object(m.a)(lu,
"TableRowViewElement",sg.a,[1153]);class Rh{constructor(a,b){Rh.ay=a;Rh.Ji=b}fbl(a){const b=a.Nvd.currentNode;this.tOl(b);let c=this.fJi(b);var f=this.tuj(b,c);let l=f.length;a.FPc=this.e5i(f);a.DPc=this.v4i(f);f=a.FPc.toArray().length;const y=a.DPc.toArray().length;if(0<f||0<y)l-=f,c-=y,this.LQl(a);this.ONb(Object(qa.a)(pg.a,b),l);this.yNb(Object(qa.a)(pg.a,b),c);this.Ial(a)}v4i(a){const b=new Na.a;for(let c=0;c<a[0].length;c++){let f=!0;for(let l=0;l<a.length;l++)if(1===a[l][c]){f=!1;break}f&&b.add(c)}return b}e5i(a){const b=
new Na.a;for(let c=0;c<a.length;c++){let f=!0;for(let l=0;l<a[c].length;l++)if(1===a[c][l]){f=!1;break}f&&b.add(c)}return b}fJi(a){let b=0;a=ob.GraphIterator.pb(a);Sd.moveToFirstRow(Object(qa.a)(ob.GraphIterator,a));Sd.moveToFirstColumn(Object(qa.a)(ob.GraphIterator,a));let c=Object(qa.a)(131,a.Cq),f=!1;for(;c;)!c.isGhostCell||ae.isSkippedCell(Object(qa.a)(pg.a,c))?(b+=c.Zab?c.colSpan:1,f=!0):f||b++,c=Object(qa.a)(131,Sd.moveToNextColumn(Object(qa.a)(ob.GraphIterator,a)));return b}LQl(a){const b=
ob.GraphIterator.pb(a.Nvd.Cq);let c=0;Sd.moveToFirstRow(Object(qa.a)(ob.GraphIterator,b));var f=b.Cq;const l=Fb.a.gf(lu.f4g,1);for(;f;){for(;a.FPc.contains(c);)c++;var y=1,H=a.xuc?a.xuc.rowIndex:0,Q=a.jEh[H+c];for(Q<l&&(Q=l);a.FPc.contains(c+y);){var ia=a.jEh[H+c+y];ia<l&&(ia=l);Q+=ia;y++}f.setValue(Ab.a.Fu,Q);f=y-1;y=0;Sd.moveToFirstColumn(Object(qa.a)(ob.GraphIterator,b));for(H=Object(qa.a)(131,b.Cq);H;){Q=H.Zab?H.colSpan:1;if(!H.isGhostCell||1<Q){0<f&&(H.rowSpan-=f,1>H.rowSpan&&(H.rowSpan=1));
ia=0;for(let wa=1;wa<Q;wa++)a.DPc.contains(y+wa)&&ia++;0<ia&&(H.colSpan-=ia,1>H.colSpan&&(H.colSpan=1))}y+=Q;H=Object(qa.a)(131,Sd.moveToNextColumn(Object(qa.a)(ob.GraphIterator,b)))}c++;Sd.moveToFirstColumn(Object(qa.a)(ob.GraphIterator,b));b.Cc();f=Sd.moveToNextRow(Object(qa.a)(ob.GraphIterator,b))}}tOl(a){const b=new Na.a;a=ob.GraphIterator.pb(a);Sd.moveToFirstRow(Object(qa.a)(ob.GraphIterator,a));for(var c=a.Cq;c;){c=!1;let l=0;Sd.moveToFirstColumn(Object(qa.a)(ob.GraphIterator,a));for(var f=
Object(qa.a)(Ax.TableCellNode,a.currentNode);f;){if(f.isGhostCell)f.Zab?(c=!0,b.contains(l)||(f.isGhostCell=!1,f.QYd())):ae.isSkippedCell(Object(qa.a)(pg.a,f))||b.contains(l)&&(c||N.a.instance.ga(77))||(f.isGhostCell=!1,f.QYd());else{c=!0;f=f.Zab?f.colSpan:1;for(let y=0;y<f;y++)b.contains(l+y)||b.add(l+y)}l++;f=Object(qa.a)(Ax.TableCellNode,Sd.moveToNextColumn(Object(qa.a)(ob.GraphIterator,a)))}Sd.moveToFirstColumn(Object(qa.a)(ob.GraphIterator,a));a.Cc();c=Sd.moveToNextRow(Object(qa.a)(ob.GraphIterator,
a))}}tuj(a,b){const c=[];let f=0;a=ob.GraphIterator.pb(a);Sd.moveToFirstRow(Object(qa.a)(ob.GraphIterator,a));for(var l=a.Cq;l;){l=0;Sd.moveToFirstColumn(Object(qa.a)(ob.GraphIterator,a));for(var y=Object(qa.a)(131,a.Cq);y;){if(!y.isGhostCell||ae.isSkippedCell(Object(qa.a)(pg.a,y))){const H=y.Zab?y.colSpan:1;for(y=y.Zfe?y.rowSpan:1;f<c.length&&2===c[f][l];)l++,(l%=b)||f++;for(let Q=0;Q<y;Q++){const ia=f+Q;ia===c.length&&Array.add(c,Array(b));for(let wa=0;wa<H;wa++)c[ia][l+wa]=0<Q||0<wa?2:1}l+=H}y=
Object(qa.a)(131,Sd.moveToNextColumn(Object(qa.a)(ob.GraphIterator,a)))}Sd.moveToFirstColumn(Object(qa.a)(ob.GraphIterator,a));a.Cc();l=Sd.moveToNextRow(Object(qa.a)(ob.GraphIterator,a));f++}return c}Ial(a){if(cd.TableReader.iq(a.Nvd)&&a.xuc&&a.hEh){var b=Object(qa.a)(129,a.Nvd.Cq),c=a.hEh,f=Array(b.v3),l=a.xuc.Jja;for(let y=0;y<f.length;y++)for(f[y]=c[l],l++;a.DPc.contains(l-a.xuc.Jja);)f[y]+=c[l],l++;b.NRa=f}}kAa(a){if(N.a.instance.ga(77)||N.a.instance.ga(63))Sd.forEachCellInTable(a,b=>{b.currentNode.zJa=
null;return!0}),Sd.forEachCellInTable(a,b=>{const c=b.currentNode;if(!c.isGhostCell){const f=c.rowSpan,l=c.colSpan;1<f||1<l?this.uMi(b,f,l):c.GWe()}return!0})}uMi(a,b,c){const f=a.currentNode,l=new ob.GraphIterator;l.Tc(a);Sd.forEachCell(l,b,c,(y,H,Q)=>{const ia=y.currentNode;if(ia!==f){ia.isGhostCell=!0;let Ua=!1;var wa=!0;const kb=Rh.Be;kb&&(Ua=kb.isFeatureEnabled(136),kb.pdb(136));do{y.Cb(1);if(Object(Wa.a)(yI.a,y.currentNode)){if((wa=wa&&Wd.OutlineElementReader.isEmpty(y,!1))||!Ua)wa=ob.GraphIterator.pb(y.Cq),
wa.sc(16),wa=!wa.Gf(1);wa||a.Hl(y.currentNode,1);y.Ni()}wa=!1}while(Ua&&y.gJ(1))}ia.zJa=Object.assign(new zI,{controlCell:f,Fsh:H,xLf:Q});1!==H||Q||(f.zJa.Q0f=ia);H||1!==Q||(f.zJa.R0f=ia);ia.GWe();Q||(ia.colSpan=c)});f.rowSpan=b;f.colSpan=c}zie(a){const b=new ob.GraphIterator;b.Tc(a);Sd.returnToContainingRow(b);var c=b.currentNode;b.Cb(1);const f=new ob.GraphIterator;f.Tc(a);Sd.returnToContainingTable(f);a=f.currentNode;this.kAa(f);const l=Vs.a.instance.createInstance(393251);this.W$b(f,l,c,c,!1);
f.$k(l);c=cd.TableReader.Gi(a);for(let y=0;y<c;++y){const H=b.currentNode,Q=this.Psa();this.i_b(f,Q,H,!1,!0);if(!Q.isGhostCell)if(H.isGhostCell){let ia;(ia=H.zJa.controlCell).rowSpan=ia.rowSpan+1}else H.rowSpan=2;b.Gf(1)}this.ONb(a,cd.TableReader.Gk(a)+1);Sd.returnToContainingTable(f);this.kAa(f);return l}yie(a){const b=ob.GraphIterator.pb(a.oPh());let c=cd.TableReader.Gi(b.currentNode);a=Qn.a(a);const f=a+1;this.kAa(b);b.Cb(1);do{const y=b.gq(a,1);b.Cc();const H=this.Psa();this.L$b(b,H,y,!1,!1);
if(!H.isGhostCell)if(y.isGhostCell){var l=void 0;(l=y.zJa.controlCell).colSpan=l.colSpan+1}else y.colSpan=2}while(b.Nj(1));this.kAa(b);(l=b.currentNode.sa(ab.a.ev,null))&&(l=Yb.a.clone(l));this.yNb(b.currentNode,++c);l&&(Array.insert(l,f,l[a]),b.currentNode.setValue(ab.a.ev,l));this.Emc(b.currentNode,f,!1,1,null)}Pod(a,b){cd.TableReader.wt(a.currentNode)&&N.a.instance.ga(63)&&this.vnh(a,c=>this.kij(c,b),(c,f)=>{c.ye(Ab.a.Fu,f)},Ab.a.complexTable)}SBj(a,b,c,f){let l=b;const y=b.zJa;N.a.instance.ga(77)&&
(a.isGhostCell=!1);if(y)if(Rh.qWc(y,!f))a.isGhostCell=!0;else{const H=Rh.Oxb(y.controlCell,f);!b.isGhostCell&&c||!c&&Rh.qWc(y,f)===H-1?(l=y.controlCell,!f&&l.Zfe&&(a.rowSpan=l.rowSpan)):(a.isGhostCell=!0,Rh.clb(y.controlCell,f,H+1));f&&l.Zab&&(a.colSpan=l.colSpan)}return l}vAj(a,b,c){var f=a.zJa;if(f)if(a.isGhostCell)this.vBj(f,b);else if(f=Rh.Oxb(a,b),1<f){const l=Rh.Oxb(a,!b),y=new ob.GraphIterator;y.set(a);y.sc(14);a=new ob.GraphIterator;a.Tc(y);const H=b?Sd.moveToNextRow(a):a.Gf(1);Rh.clb(H,b,
f-1);Rh.clb(H,!b,l);c(a,y)}}vBj(a,b){Rh.qWc(a,!b)||Rh.clb(a.controlCell,b,Rh.Oxb(a.controlCell,b)-1)}ZQb(a,b){let c=!1;Sd.forEachCellInTable(a,f=>ae.isGhostCell(f)?(c=!0,!1):!0);a.currentNode.ye(b,c)}vnh(a,b,c,f){var l=cd.TableReader.Gk(a.currentNode);const y=cd.TableReader.Gi(a.currentNode);if(l&&y){var H=!1,Q=!1,ia=Array(l);Sd.forEachCellInTable(a,(ec,dc,Fc)=>{Fc||(ia[dc]=Array(y));ec=ec.currentNode;ec.isGhostCell?ae.isSkippedCell(ec)?ia[dc][Fc]=2:ia[dc][Fc]=1:ia[dc][Fc]=0;return!0});var wa=Array(l),
Ua=Array(l);for(var kb=0;kb<l;kb++){var Gb=!!kb;let ec=!0;for(let dc=0;dc<y;dc++)if(ia[kb][dc])1===ia[kb][dc]?ec=!1:kb&&2===ia[kb-1][dc]||(Gb=!1);else{ec=Gb=!1;break}wa[kb]=Gb;Ua[kb]=ec}for(--l;0<=l;l--)Ua[l]?(a.gq(l,1),this.APc(a),Array.removeAt(ia,l),H=!0):wa[l]&&b&&(a.gq(l,1),H=a.W7b(1),kb=b(a.currentNode),Gb=b(H),c(H,kb+Gb),this.APc(a),Array.removeAt(ia,l),H=!0);l=ia.length;if(0<l){wa=Array(y);Ua=Array(y);for(b=0;b<y;b++){c=!!b;kb=!0;for(Gb=0;Gb<l;Gb++)if(ia[Gb][b])1===ia[Gb][b]?kb=!1:b&&2===
ia[Gb][b-1]||(c=!1);else{kb=c=!1;break}wa[b]=c;Ua[b]=kb}b=a.currentNode.sa(ab.a.ev,null);c=!1;if(b)for(c=!0,b=Array.clone(b),l=0;l<b.length;l++)if(!b[l]){c=!1;break}for(l=y-1;0<=l;l--)Ua[l]?(b&&Array.removeAt(b,l),this.yPc(a,l),Q=!0):wa[l]&&c&&(b[l-1]+=b[l],Array.removeAt(b,l),this.yPc(a,l),Q=!0);Q&&b&&a.currentNode.setValue(ab.a.ev,b)}(H||Q)&&this.ZQb(a,f)}}kij(a,b){let c=vk.b(a);c||(a=a.qc(b))&&(c=xe.a.RH(a.htmlElement.offsetHeight));return c}ONb(a,b){cd.TableReader.Gk(a)!==b&&a.properties.setValue(ab.a.Nza,
b)}yNb(a,b){const c=cd.TableReader.Gi(a);c!==b&&(b&&c&&a.properties.vo(ab.a.ev,ab.a.q2a),a.properties.setValue(ab.a.dha,b))}C3(a,b,c,f=null,l=!1,y=!1){a=this.pQf(a);N.a.instance.ga(71);this.D0f(a,b,c,f,l,y);N.a.instance.ga(71);return a}pQf(a){N.a.instance.ga(63)&&cd.TableReader.Gs(a)&&Sd.getContainingTable(a);const b=Vs.a.instance.createInstance(393250);a.Hl(b,2);a.$k(b);return b}B1k(a,b,c,f,l){a=this.pQf(a);N.a.instance.ga(71);this.D0f(a,b,c,f,!1,l);ka.ULS.sendTraceTag(50373653,324,50,String.format("Table pasted: TableId={0}, RowCount={1}, ColumnCount={2}",
a.id.toString(),b,c));return a}D0f(a,b,c,f=null,l=!1,y=!1){const H=ob.GraphIterator.pb(a);this.YPf(H,b,c,f,l);this.ONb(a,b);this.yNb(a,c);N.a.instance.ga(63);a.setValue(ab.a.xmb,!y)}YPf(a,b,c,f=null,l=!1){for(var y=0;y<b;++y){var H=new LQ.a;a.Hl(H,1);N.a.instance.ga(55)&&H.setValue(Ab.a.yo,ah.a.m0a())}b=null;y=!0;a.Cb(1);do for(H=0;H<c;++H){const Q=this.Psa();a.Hl(Q,1);({Buh:b,isFirst:y}=this.C0f(a,Q,l,f,b,y));Sd.returnToContainingRow(a)}while(a.Nj(1))}C0f(a,b,c,f,l,y){a.$k(b);l&&c?Rh.Ji.TBi(a,l):
(Rh.ay.nW(a,!0,f),!y&&c&&(l=new ob.GraphIterator,l.Tc(a)),y=!1);return{Buh:l,isFirst:y}}Kie(a,b,c,f){const l=new ob.GraphIterator;l.Tc(a);var y=l.currentNode;l.Cb(1);let H=vk.c(a);if(b)var Q=a.WF(1);else Q=a.currentNode,H++;const ia=a.Cc();N.a.instance.ga(63);this.kAa(a);let wa=null,Ua=null;for(var kb=0;kb<c;++kb){var Gb=Vs.a.instance.createInstance(393251);Ua||(Ua=Gb);wa=Gb;this.W$b(a,Gb,Q,y,b)}y=cd.TableReader.Gi(a.currentNode);Q=!0;do{Q?(a.$k(wa),Q=!1):a.Gf(1);for(kb=0;kb<y;++kb){Gb=this.Psa();
const ec=this.i_b(a,Gb,l.currentNode,b,!0);this.xBf(a,Gb,f(ec));l.Gf(1)}l.ala(1)}while(a.currentNode!==Ua);this.ONb(ia,cd.TableReader.Gk(ia)+c);this.jMe(ia,b,H,c)}APc(a){const b=vk.c(a);var c=b+1;a.Cc();N.a.instance.ga(63);this.kAa(a);for(--c;c>=b;--c){a.gq(c,1);let f=a.Cb(1);for(;f;)this.hLe(f,!0),f=a.Nj(1);a.Ni()}this.ONb(a.currentNode,cd.TableReader.Gk(a.currentNode)-1);this.CLe(a,b,1)}rkg(a,b,c,f,l){N.a.instance.ga(63);this.kAa(a);let y=cd.TableReader.Gi(a.currentNode);-1===b&&(b=y);const H=c?
b:b-1;a.Cb(1);do{const Q=a.gq(H,1);a.Cc();for(let ia=0;ia<f;++ia){const wa=this.Psa(),Ua=this.L$b(a,wa,Q,c,!1);this.xBf(a,wa,l(Ua))}}while(a.Nj(1));this.n0k(a,y+f,f,b,c);this.Emc(a.currentNode,b,c,f,l)}n0k(a,b,c,f,l){let y=a.currentNode.sa(ab.a.q2a,null),H=a.currentNode.sa(ab.a.ev,null);y&&(y=Yb.a.clone(y));H&&(H=Yb.a.clone(H));this.yNb(a.currentNode,b);if(N.a.instance.ga(30)&&y){const Q=Array(b);let ia=0;for(;ia<f;++ia)Q[ia]=y[ia];for(;ia<f+c;++ia)Q[ia]=!1;for(;ia<b;++ia)Q[ia]=y[ia-c];a.currentNode.setValue(ab.a.q2a,
Q)}H&&(b=this.FAf(a,H,b,f,l,c),a.currentNode.setValue(ab.a.ev,b))}FAf(a,b,c,f,l,y){a=Array(c);let H=l=0;for(;l<f;++l)a[l]=b[l],H+=a[l];for(;l<c;++l)a[l]=0>l-y?b[0]:b[l-y],H+=a[l];if(N.a.instance.ga(63)&&0<H)for(b=0/H,l=0;l<c;++l)a[l]=Math.max(Fb.a.gf(Rn.a.Ivd,0),a[l]*b);return a}Emc(){}jMe(){}W$b(a,b,c){a.c_c(b,c,1,Rh.z4a?Rh.z4a():null)}L$b(a,b,c,f){a.$k(c);f=f?a.W7b(1):c;a.Cc();a.c_c(b,f,1,Rh.z4a?Rh.z4a():null);return c}i_b(a,b,c){a.Wwf(b,1,Rh.z4a?Rh.z4a():null);return c}xBf(a,b,c){ae.isGhostCellNode(b)||
(a.$k(b),Rh.ay.nW(a,!0,c),Sd.returnToContainingRow(a))}yPc(a,b){N.a.instance.ga(63);this.kAa(a);let c=cd.TableReader.Gi(a.currentNode);-1===b&&(b=c-1);a.Cb(1);do for(let f=b+1-1;f>=b;--f)a.gq(f,1),this.hLe(a.currentNode,!1),a.Ni();while(a.Nj(1));this.m0k(a,c-1,b);this.BLe(a,b,1)}m0k(a,b,c){var f=a.currentNode.sa(ab.a.q2a,null);let l=a.currentNode.sa(ab.a.ev,null);f&&(f=Yb.a.clone(f));l&&(l=Yb.a.clone(l));this.yNb(a.currentNode,b);if(f){var y=Array(b);let H=0;for(;H<c;++H)y[H]=f[H];for(;H<b;++H)y[H]=
f[H+1];a.currentNode.setValue(ab.a.q2a,y)}if(l){f=Array(b);for(y=0;y<c;++y)f[y]=l[y];for(;y<b;++y)f[y]=l[y+1];a.currentNode.setValue(ab.a.ev,f)}}mergeCells(){}hLe(){}CLe(){}BLe(){}vSi(a){const b=Qn.a(a);a.Cc();a.Cc();this.yPc(a,b)}Psa(){const a=Vs.a.instance.createInstance(393252);a.setValue(ab.a.YE,$m.a.first);(new WF.OutlineIndentInfo(!0)).buh(a);return a}nK(a,b){a.setValue(ab.a.Vl,b);a.setValue(ab.a.xJ,b)}oKf(){}p1a(a,b,c){const f=cd.TableReader.Gi(a);let l=a.sa(ab.a.q2a,null);l=l?Yb.a.clone(l):
Array(f);let y=a.sa(ab.a.ev,null);y=y?Yb.a.clone(y):Array(f);l[b]=!0;y[b]=c;a.setValue(ab.a.ev,y);a.setValue(ab.a.q2a,l)}static get oh(){return Rh.If||(Rh.If=Ib.a.instance.resolve("Box4.IFormattingEditor"))}static get Be(){return Rh.kd||(Rh.kd=Ib.a.instance.qb("Box4.IFeatureHelper"))}static Z9f(a,b=!0){const c=new AI.a;if(a){let f=null;a=Od.SelectionFactory.Aj(a,b);if(!a)ka.ULS.sendTraceTag(19244694,315,10,"Unexpected null selection.");else for(b=0;b<a.length;b++)if(tb.a.RMf(a.ga(b))){f=a.ga(b);break}f&&
(a=tb.a.Bs(f),a.cache.xt&&(a=a.fe(null),Rh.oh.jK(a)),c.formatting=a.Am,c.languageId=tb.a.language(a),N.a.instance.ga(71)&&(c.style=fb.StyleReader.tE(f.node)))}return c}static clb(a,b,c){b?a.rowSpan=c:a.colSpan=c}static Oxb(a,b){return b?a.rowSpan:a.colSpan}static qWc(a,b){return b?a.Fsh:a.xLf}static nhj(a,b){return b?a.R0f:a.Q0f}static NAi(a,b,c){let f=a.sa(ab.a.ev,null);f=f?Yb.a.clone(f):Array(c);f[b]=0;a.setValue(ab.a.ev,f)}}Rh.If=null;Rh.kd=null;Rh.ay=null;Rh.Ji=null;Rh.z4a=null;Object(m.a)(Rh,
"TableEditor",null,[1166]);class qr{constructor(a){this.Cob=this.WP=0;Mb.SelectionEditor.Dx(a)||(a=Mb.SelectionEditor.fm(a,!0,!1));a=a.Va;const b=new ob.GraphIterator;b.set(a.node);Mb.SelectionEditor.Mt(b);Mb.SelectionEditor.Xg(a)&&(this.WP=a.Sa,this.Cob=a.kT);Mb.SelectionEditor.v9(a)&&b.Kg(12);this.fof=new wx(b)}restore(){var a=new ob.GraphIterator;this.fof.qm(Object(I.a)(this,this.Ggl,"selectableFilter"),null);var b=new fz.a;const c=new fz.a;this.fof.Krh(a,c,b);if(Db.ParagraphReader.vs(a.currentNode)){if(!c.value&&
b.value)return Od.SelectionFactory.Aj(a.currentNode,!1);b=cb.a.Lj(a.currentNode,this.WP);-1!==this.Cob&&(a=Db.ParagraphReader.OTa(a.currentNode,this.WP),0<this.Cob&&this.Cob<=a&&(b.kT=this.Cob,b.vsa=this.Cob));return Od.SelectionFactory.Mu(b)}return a.currentNode.EB?Mb.SelectionEditor.fm(Od.SelectionFactory.nl(a.currentNode),!b.value,!1):(a=Mb.SelectionEditor.uka(a,!b.value))?Db.ParagraphReader.vs(a)?Od.SelectionFactory.Qg(a,b.value?Db.ParagraphReader.textLength(a):0):Od.SelectionFactory.nl(a):null}Ggl(a){return a.currentNode.sGa||
a.currentNode.rJ}}Object(m.a)(qr,"IpReference",null,[]);class BI{constructor(){this.tableNode=null;this.columns=this.rows=0;this.b2j=!1}}Object(m.a)(BI,"TableActionData",null,[]);var MQ=d(186);class et{constructor(){this.I6b=!1}}Object(m.a)(et,"TrackChangeDeletionActionData",null,[]);class Gc{static get Tca(){return Gc.kv||(Gc.kv=Ib.a.instance.qb("Box4.IAutoCorrectScheduler"))}static get SM(){return Gc.OG||(Gc.OG=Ib.a.instance.resolve("Box4.IParagraphIndentationReader"))}static get nDl(){return Gc.buf||
(Gc.buf=Ib.a.instance.qb("Box4.UI.TableAltTextDialogFactory"))}static get FSi(){return Gc.gef||(Gc.gef=Ib.a.instance.resolve("Box4.Actors.IDeleteTableSegmentStrategy"))}static lr(){return Gc.Sm||(Gc.Sm=Ib.a.instance.Ia("Box4.IExternalSelectionManager"))}static get yyb(){return Gc.B4a||(Gc.B4a=a=>Rh.Z9f(a))}static set yyb(a){Gc.B4a=a}static get lce(){return Gc.rFd||(Gc.rFd=Gc.rpj)}static set lce(a){Gc.rFd=a}static get ice(){return Gc.oFd||(Gc.oFd=Gc.kpj)}static set ice(a){Gc.oFd=a}static get jce(){return Gc.pFd||
(Gc.pFd=Gc.mpj)}static set jce(a){Gc.pFd=a}static get kce(){return Gc.qFd||(Gc.qFd=Gc.opj)}static set kce(a){Gc.qFd=a}static get mce(){return Gc.sFd||(Gc.sFd=Gc.tpj)}static set mce(a){Gc.sFd=a}static get Cee(){return Gc.vFd||(Gc.vFd=Gc.qyj)}static set Cee(a){Gc.vFd=a}static get xce(){return Gc.tFd||(Gc.tFd=Gc.cqj)}static set xce(a){Gc.tFd=a}static get CBb(){return Gc.UHd||(Gc.UHd=Gc.h2j)}static set CBb(a){Gc.UHd=a}static get Be(){return Gc.kd||(Gc.kd=Ib.a.instance.qb("Box4.IFeatureHelper"))}static get oh(){return Gc.If||
(Gc.If=Ib.a.instance.resolve("Box4.IFormattingEditor"))}static get Xf(){return Gc.hd||(Gc.hd=Ib.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get W6(){return Gc.hp||(Gc.hp=Ib.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get lYd(){return Gc.VNa||(Gc.VNa=Ib.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor"))}static get hI(){return $h.a.instance}static get fj(){return bh.a.instance}static get Uf(){return Gc.fh||(Gc.fh=
Ib.a.instance.resolve("Box4.List.IListReader"))}static get jq(){return Gc.fp||(Gc.fp=Ib.a.instance.resolve("Box4.List.IListEditor"))}static get Wh(){return Gc.Ji||(Gc.Ji=Ib.a.instance.resolve("Box4.IOutlineElementEditor"))}static get ym(){return Gc.Mha||(Gc.Mha=Ch.ContextSetEditor.instance)}static set ym(a){Gc.Mha=a}static get Xc(){return mc.a.instance}static get Yq(){return Gc.bE||(Gc.bE=Ib.a.instance.resolve("Box4.ITableEditor"))}static get lu(){null==Gc.yF&&(Gc.yF=w.AFrameworkApplication.fa.ka("UnblockComplexTableIsEnabled")&&
!N.a.instance.ga(30));return Gc.yF}static vb(a){const b=y=>vi.Kta(y.Pa,!1),c=(y,H,Q,ia,wa)=>{const Ua=Rc.App.KMa.LOf(b);wa[Gc.KQf]={};return Ua(y,H,Q,ia,wa)};Gc.rNj();const f=w.AFrameworkApplication.Ra;a=a.MOf();f.ya(C.a.C3,yb.a.view,Gc.oPi);f.ya(C.a.C3,yb.a.Mf,Gc.C3);f.he(C.a.C3,1028);f.ya(C.a.Hua,yb.a.view,Gc.s_c);f.ya(C.a.Hua,yb.a.tableRow,Gc.insertRow);f.he(C.a.Hua,1028);f.ya(C.a.qVa,yb.a.view,Gc.s_c);f.ya(C.a.qVa,yb.a.tableRow,Gc.insertRow);f.he(C.a.qVa,1028);f.ya(C.a.Fbb,yb.a.view,Gc.s_c);f.ya(C.a.Fbb,
yb.a.tableRow,Gc.insertRow);f.he(C.a.Fbb,1028);f.ya(C.a.mVa,yb.a.view,Gc.fAb);f.ya(C.a.mVa,yb.a.tableCell,Gc.insertColumn);f.he(C.a.mVa,4);f.ya(C.a.N$b,yb.a.view,Gc.fAb);f.he(C.a.N$b,4);f.ya(C.a.Dbb,yb.a.view,Gc.fAb);f.ya(C.a.Dbb,yb.a.tableCell,Gc.insertColumn);f.he(C.a.Dbb,4);f.ya(C.a.M$b,yb.a.view,Gc.fAb);f.he(C.a.M$b,4);f.ya(C.a.pVa,yb.a.view,Gc.fAb);f.ya(C.a.pVa,yb.a.tableCell,Gc.insertColumn);f.he(C.a.pVa,1028);f.ya(C.a.KDa,yb.a.view,Gc.BSf);f.ya(C.a.KDa,yb.a.tableCell,Gc.KDa);f.he(C.a.KDa,4);
f.ya(C.a.deleteRow,yb.a.view,Gc.BSf);f.ya(C.a.deleteRow,yb.a.tableRow,Gc.deleteRow);f.he(C.a.deleteRow,1028);f.ya(C.a.H8,yb.a.view,Gc.GSi);f.ya(C.a.H8,yb.a.table,Gc.H8);f.he(C.a.H8,1028);f.ya(C.a.I8a,yb.a.table,Gc.I8a);f.ya(C.a.I8a,yb.a.view,a);f.he(C.a.I8a,4);f.ya(C.a.insertTable,yb.a.view,Gc.tQj);f.ya(C.a.insertTable,yb.a.Mf,Gc.insertTable);f.he(C.a.insertTable,1036);f.ya(C.a.mergeCells,yb.a.view,Gc.zvk);f.ya(C.a.mergeCells,yb.a.tableCell,Gc.mergeCells);f.he(C.a.mergeCells,4);f.ya(C.a.splitCells,
yb.a.view,Gc.aAl);f.ya(C.a.splitCells,yb.a.tableCell,Gc.splitCells);f.he(C.a.splitCells,4);f.ra(C.a.MWk,yb.a.view,Sr.a.z1,96);f.ra(C.a.OWk,yb.a.view,Sr.a.z1,96);f.ya(C.a.PDl,yb.a.view,Sr.a.oH);f.ya(C.a.bEl,yb.a.view,Sr.a.oH);f.ya(C.a.F_c,yb.a.view,Gc.F_c);f.he(C.a.F_c,1124);f.ya(C.a.PQc,yb.a.view,Gc.PQc);f.he(C.a.PQc,100);f.ya(C.a.ZMb,yb.a.view,Gc.ZMb);f.ya(C.a.osc,yb.a.view,Gc.Bgl);f.ya(C.a.Xqd,yb.a.view,Gc.Xqd);f.ya(C.a.DYe,yb.a.view,Gc.DYe);f.ya(C.a.dwc,yb.a.view,a);f.ya(C.a.dwc,yb.a.table,Gc.dwc);
f.he(C.a.dwc,4);f.ya(C.a.upc,yb.a.view,a);f.ya(C.a.upc,yb.a.table,Gc.upc);f.he(C.a.upc,96);N.a.instance.ga(30)&&(f.ya(C.a.Y1a,yb.a.view,Gc.fAb),f.ya(C.a.Y1a,yb.a.Mf,Gc.insertColumn),f.he(C.a.Y1a,4),f.ya(C.a.zuc,yb.a.Mf,Gc.insertRow),f.ya(C.a.zuc,yb.a.view,Gc.s_c),f.he(C.a.zuc,4));f.ya(C.a.vLb,yb.a.view,Gc.vLb);N.a.instance.ga(63)?f.he(C.a.vLb,96):f.he(C.a.vLb,1124);a=[C.a.Stg,C.a.Qtg,C.a.Utg,C.a.Rtg,C.a.Vtg,C.a.Ttg,C.a.Ptg,C.a.T3c,C.a.S3c,C.a.U3c,C.a.Q3c,C.a.P3c,C.a.R3c,C.a.M3c,C.a.L3c,C.a.N3c];for(var l of a)f.ya(l,
yb.a.view,Gc.Fka),f.ya(l,yb.a.tableCell,Gc.wmi),f.he(l,4);l=[C.a.eSe,C.a.dSe,C.a.fSe,C.a.bSe,C.a.aSe,C.a.cSe,C.a.ZRe,C.a.YRe,C.a.$Re];for(const y of l)f.ya(y,yb.a.view,c),f.ya(y,yb.a.paragraph,Gc.LVk),f.he(y,68)}static rNj(){Gc.RD.$(C.a.Vtg,Gc.RD.$(C.a.T3c,Gc.RD.$(C.a.S3c,Gc.RD.$(C.a.U3c,Gc.RD.$(C.a.eSe,Gc.RD.$(C.a.dSe,Gc.RD.$(C.a.fSe,Gc.dJh)))))));Gc.RD.$(C.a.Ttg,Gc.RD.$(C.a.Q3c,Gc.RD.$(C.a.P3c,Gc.RD.$(C.a.R3c,Gc.RD.$(C.a.bSe,Gc.RD.$(C.a.aSe,Gc.RD.$(C.a.cSe,Gc.gwk)))))));Gc.RD.$(C.a.Ptg,Gc.RD.$(C.a.M3c,
Gc.RD.$(C.a.L3c,Gc.RD.$(C.a.N3c,Gc.RD.$(C.a.ZRe,Gc.RD.$(C.a.YRe,Gc.RD.$(C.a.$Re,Gc.qqi)))))));Gc.sC.$(C.a.Stg,Gc.sC.$(C.a.T3c,Gc.sC.$(C.a.Q3c,Gc.sC.$(C.a.M3c,Gc.sC.$(C.a.eSe,Gc.sC.$(C.a.bSe,Gc.sC.$(C.a.ZRe,1)))))));Gc.sC.$(C.a.Qtg,Gc.sC.$(C.a.S3c,Gc.sC.$(C.a.P3c,Gc.sC.$(C.a.L3c,Gc.sC.$(C.a.dSe,Gc.sC.$(C.a.aSe,Gc.sC.$(C.a.YRe,2)))))));Gc.sC.$(C.a.Utg,Gc.sC.$(C.a.U3c,Gc.sC.$(C.a.R3c,Gc.sC.$(C.a.N3c,Gc.sC.$(C.a.fSe,Gc.sC.$(C.a.cSe,Gc.sC.$(C.a.$Re,3)))))));Gc.sC.$(C.a.Rtg,6)}static PQc(a,b,c){if(1===
c)return 32;if(!b.view.Sh)return 2;a=b.view;if(!a.Nb)return Gc.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.coa}),8;a=a.Nb.Yj;a=Gc.ym.l3(a,14);if(!a)return Gc.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.vta}),8;Gc.nDl.create(a);return 32}static ZMb(a,b,c){pb.a.mark(5756);if(!b.view.Sh)return 2;const f=b.view;if(!f.Nb)return Gc.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.coa}),8;a=f.Nb.Yj;a=Gc.ym.l3(a,14);if(!a)return Gc.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.vta}),8;if(2===c){let l=null;b=a.node;c=cd.TableReader.wt(b);const y=Gc.lu;if(!N.a.instance.ga(104)||
c&&!y)l=Od.SelectionFactory.nl(a.node);else if(N.a.instance.ga(77))c=Od.SelectionFactory.NOc(b,y),f.Nb.QNb(c,null);else{a=ob.GraphIterator.pb(b);a.Cb(1);for(b=[pr.TableNodeContext.create(a.currentNode)];a.Gf(1);)c&&vk.h(a)||Array.add(b,pr.TableNodeContext.create(a.currentNode));l=new Lb.Selection(b,!0)}l&&(c=new Lh.a(null,H=>{f.Nb.setSelection(l,H);return!1},null),c.$l("SelectTable"),c.run())}pb.a.mark(5757);return 32}static Bgl(a,b,c){pb.a.mark(5752);if(!b.view.Sh)return 2;a=b.view;if(!a.Nb)return Gc.Xc.Xb(Kd.a.zh,
{["Reason"]:Qd.a.coa}),8;b=a.Nb.Pa;if(!b)return Gc.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.noSelection}),2;b=Gc.mce(b);if(32!==b.response)return Gc.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.vta}),b.response;if(2===c){var f=b.RA;b=c=f[0].node;var l=ob.GraphIterator.pb(c);l.sc(14);let Q=null;var y=Sd.getContainingTable(l);y=cd.TableReader.wt(y);var H=Gc.lu;H=N.a.instance.ga(104)&&(!y||H);const ia=[];for(let wa=0;wa<f.length;++wa){const Ua=l.currentNode===f[wa].node;if(Ua||y&&vk.d(l))b=l.currentNode,!H||y&&vk.h(l)||Array.add(ia,
pr.TableNodeContext.create(l.currentNode)),Sd.moveToNextRow(l),Ua||--wa}f=a.Nb.Pa.mb;l=null;H?N.a.instance.ga(77)?(l=new ob.GraphIterator,H=new ob.GraphIterator,f.Af?(l.set(c),H.set(b)):(l.set(b),H.set(c)),l.sc(14),Sd.moveToFirstColumn(l),H.sc(14),Sd.moveToLastColumn(H),l=y?Od.SelectionFactory.y3b(l,H):Od.SelectionFactory.nQf(l,H)):Q=new Lb.Selection(ia,N.a.instance.ga(63)||f.Af):Q=Od.SelectionFactory.aQf(c,b);Q&&(l=new Ya.SelectionCollection([Q],0));a.Nb.QNb(l,null)}pb.a.mark(5753);return 32}static Xqd(a,
b,c){pb.a.mark(5754);if(!b.view.Sh)return 2;a=b.view;if(!a.Nb)return Gc.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.coa}),8;b=a.Nb.Pa;if(!b)return Gc.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.noSelection}),2;b=Gc.kce(b);if(32!==b.response)return Gc.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.vta}),b.response;if(2===c){c=[];var f=b.RA,l=new ob.GraphIterator;l.set(f[0].node);l.sc(14);b=Sd.getContainingTable(l);var y=Number.MAX_VALUE,H=0;if(f.length===cd.TableReader.Gi(Sd.getContainingTable(l)))H=null,N.a.instance.ga(104)&&(H=Od.SelectionFactory.NOc(b,
Gc.lu))?c=H.toArray():(H=Od.SelectionFactory.nl(b),Array.add(c,H)),y=0,H=cd.TableReader.Gi(b)-1;else{for(l=0;l<f.length;++l){var Q=ob.GraphIterator.pb(f[l].node);Q.sc(14);Q=Qn.a(Q);y=Math.min(y,Q);H=Math.max(H,Q)}f=ob.GraphIterator.pb(b);Sd.moveToFirstRow(f);Sd.moveToColumnByIndex(f,y);l=new ob.GraphIterator;l.Tc(f);Sd.moveToColumnByIndex(l,H);var ia;Q=b.Op();Q=N.a.instance.ga(104)&&(!Q||Gc.lu);do(ia=Q?Od.SelectionFactory.KOc(f,l,!0,!0):Od.SelectionFactory.aQf(f.currentNode,l.currentNode))&&Array.add(c,
ia),ia=!Sd.moveToNextRow(f),Sd.moveToNextRow(l);while(!ia)}f=ob.GraphIterator.pb(b);Sd.moveToCell(f,0,y);y=cd.TableReader.Gk(b);b=ob.GraphIterator.pb(b);Sd.moveToCell(b,y-1,H);c=new Ya.SelectionCollection(c,c.length-1,0,f,b);a.Nb.QNb(c,null)}pb.a.mark(5751);return 32}static DYe(a,b,c){pb.a.mark(5750);if(!b.view.Sh)return 2;a=b.view;if(!a.Nb)return Gc.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.coa}),8;b=a.Nb.Yj;if(!b)return Gc.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.noSelection}),2;var f=Gc.ym.mB(b);b={};for(var l=0;l<
f.length;++l)if(f[l].Pk){var y=ob.GraphIterator.pb(f[l].node);y.kf();if(!ae.isTableCellOrInside(y))return 8;Sd.returnToCell(y);b[y.currentNode.id.toString()]=y}if(2===c){if(N.a.instance.ga(104)){c=a.Nb.Pa;if(c.mb.qg)return pb.a.mark(5751),32;f=c.mb;y=f.Af?f.Va:f.jf;l=f.Af?f.jf:f.Va;c=new ob.GraphIterator;c.set(y.node);c.kf();y=new ob.GraphIterator;y.set(l.node);y.kf();l=null;if((l=Sd.returnToLowestCommonTable(c,y))&&!l.Op()){var H=Mb.SelectionEditor.fm(f,!0,!1);H=pr.TableNodeContext.create(c.currentNode,
H.Va);H=Od.SelectionFactory.u3b(Od.SelectionFactory.Mu(H));a.Nb.gF(H);pb.a.mark(5751);return 32}}c=[];for(H in b)f=Od.SelectionFactory.nl(b[H].currentNode),Array.add(c,f);0<c.length&&(H=new Ya.SelectionCollection(c,c.length-1),a.Nb.QNb(H,null))}pb.a.mark(5751);return 32}static huj(){return w.AFrameworkApplication.fa.ka("WacTableCellAlignmentIsEnabled")}static wmi(a,b,c,f,l){f=Gc.tki();if(1===c)return f?32:8;if(!(l&&f&&b&&b.node))return 2;b=b.node;if(ae.isGhostCellNode(b))return 32;Gc.RD.Fb(a)&&(c=
Gc.RD.ga(a),b.ye(Ab.a.b5e,c));Gc.sC.Fb(a)&&(a=Gc.sC.ga(a),Gc.lCf(b,a));return 32}static lCf(a,b){if(!ae.isGhostCellNode(a)&&(a=ob.GraphIterator.pb(a),xg.OutlineNavigator.saa(a))){do if(a.Cb(2)){const c=a.currentNode;12===c.type?c.ye(ab.a.Vl,b):14===c.type?cd.TableReader.h2f(c,f=>{Gc.lCf(f,b)}):ka.ULS.sendTraceTag(8439839,324,50,"Unsupported node type for justification set:{0}",MQ.a[c.type]);a.Cc()}while(a.np())}}static LVk(a,b,c,f,l){if(!l)return 2;if(1===c)return 32;c=l[Gc.KQf];if(Gc.o_d in c&&!c[Gc.o_d])return 32;
f=Gc.sC.ga(a);a=Gc.RD.ga(a);if(!b||!b.node)return 2;var y=b.node;b=Db.ParagraphReader.CL(y);y=ob.GraphIterator.pb(y);y.sc(16);y.Kg(16);y=y.currentNode.sa(Ab.a.b5e,Gc.dJh);c[Gc.o_d]=l[wh.a.On]=f===b&&a===y;return 32}static GSi(a,b,c,f,l){if(!b.view.Sh)return 2;a=b.view;if(!a.Nb)return Gc.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.coa}),8;let y=a.Nb.Yj;y=Gc.ym.l3(y,14);if(!y)return Gc.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.vta}),8;if(1===c)return w.AFrameworkApplication.Ra.ei(y,C.a.H8,c,!0,f,l);pb.a.mark(7117);const H=
new qr(Mb.SelectionEditor.fm(Od.SelectionFactory.Mu(y),!0,!1)),Q=new pf.GraphTransaction(15);try{Q.ld(b.view.Ag);const ia=Qh.oWc(y.node,!0);ia.Qpa(y);const wa=Object(qa.a)(et,l)||new et;let Ua=w.AFrameworkApplication.Ra.ei(y,C.a.H8,c,!0,f,Gc.Xf.ig?wa:l);const kb=!Gc.Xf.ig||!Gc.Xf.jz||wa.I6b;32===Ua&&2===c&&kb?(ia.normalize(),a.Nb.setSelection(H.restore()),v.FocusManager.instance().vf(a.VI)):ia.cancel()}finally{Q&&Q.dispose()}pb.a.mark(7118);return 32}static oPi(a,b,c,f,l){pb.a.mark(4943);let y=null;
2===c&&(y=new pf.GraphTransaction(15),y.ld(b.view.Ag));a=w.AFrameworkApplication.Ra.ei(b.UE,a,c,!0,f,l);if(32===a&&2===c){if(!b.view.Sh)return 2;b=b.view;c=b.Nb.Yj;c=Gc.ym.l3(c,16);f=new ob.GraphIterator;f.set(c.node);f.sc(14);Sd.moveToNextOrPreviousCell(f,!1);b.Nb.setSelection(Od.SelectionFactory.Aj(f.currentNode,!0))}y&&y.dispose();pb.a.mark(4944);return a}static fAb(a,b,c,f){if(!b.view.Sh)return 2;var l=b.view;if(!l.Nb||!l.Nb.Pa.mb)return Gc.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.noSelection}),8;pb.a.mark(4945);
var y=l.Nb.Yj;if(!y)return Gc.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.noSelection}),8;var H=a===C.a.mVa||a===C.a.Y1a;l=a===C.a.pVa;var Q=Gc.ym.mB(y);if(!Q||0>=Q.length)return Gc.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.noSelection}),8;Q=Q[0].node;if(!Q)return Gc.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.noSelection}),8;H=cd.TableReader.Gm(Q)?a===C.a.M$b||H:a===C.a.N$b||H;const ia=Gc.ice(y,l,H);if(32!==ia.response)return ia.response;y=ia.rn;Q=cd.TableReader.wt(y);const wa=a;let Ua;Ua=H?Object(qa.a)(190,ia.RA[ia.RA.length-1]):Object(qa.a)(190,
ia.RA[0]);a!==C.a.Y1a&&(a=l?C.a.pVa:H?C.a.mVa:C.a.Dbb);H=null;2===c&&(H=new pf.GraphTransaction(15),H.ld(b.view.Ag));a=w.AFrameworkApplication.Ra.ei(Ua,a,c,!0,f,ia.KJa);if(l){b={MenuItemId:"buttonFirstColumn"};b[wh.a.On]=!0;f=w.AFrameworkApplication.Ra.ei(cb.a.create(y),2===c?C.a.eT:C.a.Haa,2,!0,f,b);if(32!==f)return f;if(1===c&&b[wh.a.On])return 2}H&&H.dispose();2===c&&ka.ULS.sendTraceTag(9011547,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}, ColumnCount={6}",
wa,C.a.Hv(wa)||"Unknown",N.a.instance.ga(77),Q,a,y.id.toString(),cd.TableReader.Gi(y)));pb.a.mark(4946);return a}static s_c(a,b,c,f){if(!b.view.Sh)return 2;var l=a===C.a.zuc,y=a===C.a.Fbb;const H=y||a===C.a.qVa;pb.a.mark(4947);var Q=b.view;if(!Q.Nb)return Gc.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.coa}),8;const ia=Q.Nb.Yj;if(!ia)return Gc.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.noSelection}),8;Q=Gc.lce(ia,y,H);if(32!==Q.response)return Gc.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.vta}),Q.response;const wa=cd.TableReader.wt(Q.rn);
let Ua=null;2===c&&(Ua=new pf.GraphTransaction(15),Ua.ld(b.view.Ag));b=H?Object(qa.a)(190,Q.RA[0]):Object(qa.a)(190,Q.RA[Q.RA.length-1]);l=w.AFrameworkApplication.Ra.ei(l?ia:b,a,c,!1,f,Q.KJa);if(y){y={MenuItemId:"buttonFirstRow"};y[wh.a.On]=!0;f=w.AFrameworkApplication.Ra.ei(cb.a.create(Q.rn),2===c?C.a.eT:C.a.Haa,2,!0,f,y);if(32!==f)return f;if(1===c&&y[wh.a.On])return 2}Ua&&Ua.dispose();2===c&&ka.ULS.sendTraceTag(9011548,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}, RowCount={6}",
a,C.a.Hv(a)||"Unknown",N.a.instance.ga(77),wa,l,Q.rn.id.toString(),cd.TableReader.Gk(Q.rn)));pb.a.mark(4948);return l}static L4g(a){for(Sd.moveToFirstColumn(a);ae.isGhostCell(a)&&Sd.moveToPreviousRow(a););}static $wk(a){for(Sd.moveToFirstRow(a);ae.isGhostCell(a)&&Sd.moveToPreviousColumn(a););}static zvk(a,b,c,f){if(N.a.instance.ga(30)||!b.view.Sh)return 2;const l=b.view;if(!l.Nb||!l.Nb.Pa.mb)return Gc.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.noSelection}),8;const y=Gc.clj(l.Nb.Yj);if(32!==y.response)return Gc.Xc.Xb(Kd.a.zh,
{["Reason"]:Qd.a.vta}),y.response;let H=null,Q=null;2===c&&(H=new qr(l.Nb.Pa.mb),H.restore(),Q=new pf.GraphTransaction(15),Q.ld(b.view.Ag));a=w.AFrameworkApplication.Ra.ei(cb.a.create(y.controlCell),a,c,!1,f,y);2===c&&32===a&&(b=ob.GraphIterator.pb(y.rn),b.kf()&&Gc.Yq.Pod(b,l.Na),H&&(l.Nb.setSelection(Od.SelectionFactory.Aj(y.controlCell,!0)),v.FocusManager.instance().vf(l.VI)));Q&&Q.dispose();2===c&&ka.ULS.sendTraceTag(38397411,324,50,String.format("Merge Cells command run. Response={0}",a));return a}static clj(a){const b=
new xI;b.rn=null;b.controlCell=null;if(!a)return b.response=8,b;var c=Gc.ym.mB(a);if(1>=c.length)return b.response=2,b;const f=new Na.a;a={};for(let Q=0;Q<c.length;++Q)if(c[Q].Pk){const ia=ob.GraphIterator.pb(c[Q].node);ia.kf();if(!ae.isTableCellOrInside(ia))return b.response=8,b;var l=Object(qa.a)(kf.AParagraphNode,ia.currentNode);if(l&&!l.sa(Ab.a.Pne,!0))return b.response=8,b;Sd.returnToCell(ia);l=ia.currentNode;if(!f.contains(l.id.toString())){f.add(l.id.toString());var y=Sd.getContainingTable(ia),
H=Sd.getContainingTableRow(ia).id.toString();if(b.rn)if(b.rn!==y)if(ia.NUa(b.rn))continue;else if(ob.GraphIterator.pb(b.rn).vba(y))a={},b.rn=y,b.controlCell=l,a[H]=l.colSpan;else return b.response=8,b;else a[H]=H in a?a[H]+l.colSpan:l.colSpan;else a={},b.rn=y,b.controlCell=l,a[H]=l.colSpan;for(y=1;y<l.rowSpan;y++)Sd.moveToNextRow(ia),H=Sd.getContainingTableRow(ia).id.toString(),a[H]=H in a?a[H]+l.colSpan:l.colSpan}}if(!b.controlCell)return b.response=2,b;c=Object.keys(a);b.rowSpan=c.length;b.colSpan=
a[c[0]];for(const Q of c)if(b.colSpan!==a[Q])return b.response=2,b;b.response=32;return b}static aAl(a,b,c,f,l){if(N.a.instance.ga(30)||!b.view.Sh)return 2;const y=b.view;if(!y.Nb||!y.Nb.Pa.mb)return Gc.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.noSelection}),8;if(Mb.SelectionEditor.Dx(y.Nb.Pa.mb))var H=y.Nb.Pa.mb.Va.node;else{H=y.Nb.Yj;if(!H)return Gc.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.vta}),8;H=Gc.ym.mB(H);if(1!==H.length||!Object(Wa.a)(cb.a,H[0]))return Gc.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.WMf}),8;H=H[0].node}H=
ob.GraphIterator.pb(H);H.kf();if(!ae.isInTableCell(H))return 2;Sd.returnToContainingCell(H);H=H.currentNode;let Q=null,ia=null;2===c&&(Q=new qr(y.Nb.Pa.mb),Q.restore(),ia=new pf.GraphTransaction(15),ia.ld(b.view.Ag));b=cb.a.create(H);a=w.AFrameworkApplication.Ra.ei(b,a,c,!1,f,l);2===c&&32===a&&Q&&(y.Nb.setSelection(Od.SelectionFactory.Aj(H,!0)),v.FocusManager.instance().vf(y.VI));ia&&ia.dispose();2===c&&ka.ULS.sendTraceTag(38397440,324,50,String.format("Split Cells command run. Response={0}",a));
return a}static BSf(a,b,c,f,l){if(!b.view.Sh)return 2;const y=a===C.a.deleteRow;y?pb.a.mark(4951):pb.a.mark(4949);const H=b.view;if(!H.Nb||!H.Nb.Pa.mb)return Gc.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.noSelection}),8;var Q=H.Nb.Yj;const ia=Gc.xce(Q,y,H.Nb);if(32!==ia.response)return Gc.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.vta}),ia.response;const wa=cd.TableReader.wt(ia.rn);var Ua=null,kb=null,Gb=null;let ec=!1;var dc=!1;2===c&&(Ua=new qr(H.Nb.Pa.mb),dc=Ua.restore(),Gb=ob.GraphIterator.pb(dc.Va.node),Gb.sc(14),Sd.returnToContainingCell(Gb),
dc=ae.isLastCellInRow(Gb),Sd.returnToContainingRow(Gb),ec=vk.j(Gb),kb=Qh.oWc(b.view.Ag,!0),wa&&(Q=Gc.FSi.wYf(Q)),kb.Qpa(Q),Gb=new pf.GraphTransaction(15),Gb.ld(b.view.Ag));b=Object(qa.a)(et,l)||new et;f=w.AFrameworkApplication.Ra.ei(ub.a.cSa(ia.RA),a,c,!1,f,Gc.Xf.ig&&y?b:l);Q=!Gc.Xf.ig||!Gc.Xf.jz||!y||b.I6b;b=l=!1;if(2===c&&32===f&&Q){let Fc=ob.GraphIterator.pb(ia.rn);Fc.kf()&&Gc.Yq.Pod(Fc,H.Na)}2===c&&32===f&&N.a.instance.ga(30)&&cd.TableReader.Ppe(ia.rn)&&Q&&ob.GraphIterator.pb(ia.rn).kf()&&(Ua=
y?new qr(Od.SelectionFactory.Aj(ia.rn,!ec)):new qr(Od.SelectionFactory.Aj(ia.rn,!dc)),H.Nb.setSelection(Mb.SelectionEditor.fm(Od.SelectionFactory.nl(ia.rn),!1,!1)),w.AFrameworkApplication.Ra.processAction(C.a.I8a,2),b=l=!0);if(32===f&&2===c&&Q){if(!l&&0>=cd.TableReader.Gi(ia.rn)||0>=cd.TableReader.Gk(ia.rn))l=!0;kb.normalize();if(Ua){Ua=Ua.restore();if(l)Ua=b&&!y?Od.SelectionFactory.Aj(Ua.Va.node,!dc):Od.SelectionFactory.Aj(Ua.Va.node,!0);else if(kb=ob.GraphIterator.pb(Ua.Va.node),kb.sc(14),y)Sd.returnToContainingRow(kb),
ec&&!N.a.instance.ga(77)?(kb.kf(),Za.OutlineElementNavigator.Te(kb),Gc.Wh.nea(kb,!1,!0)):Gc.L4g(kb),Ua=Od.SelectionFactory.Aj(kb.currentNode,!0);else if(Sd.returnToCell(kb),dc&&N.a.instance.ga(30))Sd.moveToLastRow(kb),Ua=Od.SelectionFactory.Aj(kb.currentNode,!1);else if(N.a.instance.ga(63)||N.a.instance.ga(77))Gc.$wk(kb),Ua=Od.SelectionFactory.Aj(kb.currentNode,!0);H.Nb.setSelection(Ua);v.FocusManager.instance().vf(H.VI)}}else kb&&kb.cancel();Gb&&Gb.dispose();2===c&&ka.ULS.sendTraceTag(9011549,324,
50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}",a,C.a.Hv(a)||"Unknown",N.a.instance.ga(77),wa,f,ia.rn.id.toString()));y?pb.a.mark(4952):pb.a.mark(4950);return f}static qyj(a,b){Sd.moveToFirstRow(a);const c=Object(qa.a)(Ax.TableCellNode,a.currentNode).colSpan;if(b)for(b=0;b<c;b++)Sd.moveToNextColumn(a);else Sd.moveToPreviousColumn(a)}static rpj(a){return Gc.O6b(a,!1,!0)}static kpj(a){return Gc.O6b(a,!0,!0)}static mpj(a,b){let c=Qn.a(a);
b&&(c+=a.currentNode.colSpan-1);return c}static opj(a){a=ge.a.Wtb(a);return Gc.O6b(a,!0,N.a.instance.ga(104)&&Gc.lu)}static tpj(a){a=ge.a.Wtb(a);return Gc.O6b(a,!1,N.a.instance.ga(104)&&Gc.lu)}static cqj(a,b){return Gc.O6b(a,!b,!0)}static O6b(a,b,c){const f=new is;f.rn=null;if(!a)return f.response=8,f;var l={};let y=[],H=!1;a=Gc.ym.mB(a);1===a.length&&(H=!0);for(let Ua=0;Ua<a.length;++Ua)if(a[Ua].Pk){const kb=[];let Gb=ob.GraphIterator.pb(a[Ua].node);Gb.kf();if(!ae.isTableCellOrInside(Gb))return f.response=
8,f;if(b)Sd.returnToCell(Gb),c&&1<ae.getColSpan(Gb.currentNode)?ae.foreachMergedCells(Gb.currentNode,ec=>{ec=ob.GraphIterator.pb(ec);ec.kf();Sd.moveToFirstRow(ec);Array.add(kb,ec)},2):Array.add(kb,Gb),Sd.moveToFirstRow(Gb);else{ae.isTableCell(Gb)||Sd.returnToCell(Gb);var Q=Gb.currentNode.rowSpan;Sd.returnToContainingRow(Gb);if(1<Q)for(var ia=1;ia<Q;ia++){var wa=ob.GraphIterator.pb(Gb.currentNode);wa.kf();Array.add(kb,wa);Sd.moveToNextRow(Gb)}Array.add(kb,Gb)}for(Q=0;Q<kb.length;++Q)if(Gb=kb[Q],ia=
Sd.getContainingTable(Gb),wa=Gb.currentNode.id.toString(),!l[wa])if(l[wa]=!0,f.rn)if(f.rn!==ia)if(Gb.NUa(f.rn))Gc.Z2f(Gb,f.rn,b),wa=Gb.currentNode.id.toString(),l[wa]||(l[wa]=!0,Array.add(y,Gb));else if(l[wa]=!1,ob.GraphIterator.pb(f.rn).vba(ia)){const ec=[];for(let dc=0;dc<y.length;dc++){const Fc=y[dc];Gc.Z2f(Fc,ia,b);wa=Fc.currentNode.id.toString();l[wa]||(l[wa]=!0,Array.add(ec,Fc))}wa=Gb.currentNode.id.toString();l[wa]||(l[wa]=!0,Array.add(ec,Gb));f.rn=ia;Array.clear(y);y=ec}else return f.response=
8,f;else Array.add(y,Gb);else f.rn=ia,Array.add(y,Gb);Array.clear(kb)}if(!y.length)return f.response=8,f;f.U1a=y[0].currentNode;b=[];for(l=0;l<y.length;l++){a=y[l];if(!c&&cd.TableReader.VAb(a))return f.response=8,f;Array.add(b,cb.a.create(a.currentNode))}f.KJa=H?1:b.length;f.RA=b;f.response=32;return f}static Z2f(a,b,c){do c?Sd.returnToContainingCell(a):Sd.returnToContainingRow(a);while(Sd.getContainingTable(a)!==b);c&&Sd.moveToFirstRow(a)}static F_c(a,b,c,f,l){return 1===c?(a=b.UE)&&Mb.SelectionEditor.Xg(a)?
w.AFrameworkApplication.Ra.ei(a,C.a.insertTable,c,!0,f,l):2:32}static tQj(a,b,c,f,l){f.QC=0;f.RN=0;let y=-1,H=null,Q=null,ia=null;if(!b.view.Sh)return 2;const wa=b.view;if(!wa.Nb)return Gc.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.coa}),8;pb.a.mark(4941);if(2===c){const Ua=wa.Nb.Yj;Ua.Pk&&(ia=new pf.GraphTransaction(15),Q=VF.a.instance.Nvj(Ua.node),ia.Sy(Q),H=new ob.GraphIterator,H.Tc(Q),H.Cc(),y=H.LTa(Q.currentNode))}a=w.AFrameworkApplication.Ra.ei(b.UE,a,c,!0,f,l);32===a&&2===c&&(Q.isValid?(Za.OutlineElementNavigator.ZJ(Q,
!1,!1),Za.OutlineElementNavigator.yi(Q),c=Od.SelectionFactory.Aj(Q.currentNode,!0)):(H.Bee(y),Za.OutlineElementNavigator.yi(H),c=Od.SelectionFactory.Aj(H.currentNode,!0)),wa.Nb.setSelection(c),v.FocusManager.instance().vf(wa.VI));ia&&ia.dispose();pb.a.mark(4942);return a}static vLb(a,b){if(!b.view.Sh)return 8;a=b.view;if(!a.Nb)return 8;a=Gc.ym.mB(a.Nb.Yj);if(0>=a.length)return 8;b=new ob.GraphIterator;for(let c=0;c<a.length;++c)if(b.set(a[c].node),b.kf(),!cd.TableReader.Gs(b))return 8;return 32}static C3(a,
b,c){var f=b.contextId===yb.a.Mf;let l=null,y=null;if(f){l=b;if(wb.HyperlinkReader.Hla(l,!0))return Gc.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.SMf}),8;y=new ob.GraphIterator;y.set(l.node);Mb.SelectionEditor.Mt(y);ze.b(y)&&(Gc.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.x_d}),f=!1);!l.Sa&&y.qog&&(Gc.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.ilg}),f=!1)}if(1===c||!f)return f?32:8;pb.a.mark(4929);b=new pf.GraphTransaction(7);b.Sy(y);Za.OutlineElementNavigator.Te(y);c=y.currentNode;Gc.Wh.nea(y,!1,!1);f=Gc.Yq.C3(y,1,2);const H=new ob.GraphIterator;
H.set(c);H.kf();Sd.moveToCellContent(y,0,1);Gc.Wh.cPb(H,y,l,!0,!0);Sd.returnToContainingTable(y);Sd.moveToCellContent(y,0,0);y.Ni();Fm.i(H,y,null,H.role);Gc.jq.UQa(H,null);Sd.returnToContainingTable(y);Za.OutlineElementNavigator.Te(y);H.Cb(1)&&Fm.h(y,null,1,1,H,-1);Gc.Tca&&Gc.Tca.Cwc(c,B.a.$q);b.dispose();ka.ULS.sendTraceTag(42505434,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}",a,C.a.Hv(a)||"Unknown",N.a.instance.ga(77),f.id.toString()));pb.a.mark(4930);return 32}static insertColumn(a,
b,c,f,l){w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TestEcsFeatureIsEnabled",!1)?ka.ULS.sendTraceTag(509092047,324,50,"PPTO TestEcsFeature Client Flight Enabled. Box4."):ka.ULS.sendTraceTag(509092046,324,50,"PPTO TestEcsFeature Client Flight Disabled. Box4.");var y=Mb.SelectionEditor.Xg(b)&&a===C.a.Y1a||b.contextId===yb.a.tableCell;f=null;if(y&&(f=new ob.GraphIterator,f.set(b.node),f.sc(14),ae.isTableCellOrInside(f)||(Gc.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.K2b}),
y=!1),y&&!Gc.CBb(f,a)&&(Gc.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.I2b}),y=!1),y)){Sd.returnToContainingCell(f);var H=N.a.instance.ga(63)?63:255;if(cd.TableReader.Gi(Sd.getContainingTable(f))>=H)return Gc.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.f3g}),8}if(1===c||!y)return y?32:8;pb.a.mark(4931);c=a!==C.a.Dbb&&a!==C.a.pVa;H=a===C.a.pVa;y=new pf.GraphTransaction(15);y.Sy(f);b.node.jH().graphTransactionOperations.tja(2);const Q=new ob.GraphIterator;Q.set(f.currentNode);Q.sc(15);Sd.returnToContainingTable(f);let ia=Gc.jce(Q,
H,c);c&&ia++;Gc.Yq.rkg(f,ia,!c,!H&&l?l:1,Gc.yyb);f.set(b.node);f.sc(16);a===C.a.Y1a?(Sd.moveToNextColumn(Q),xg.OutlineNavigator.saa(Q),Za.OutlineElementNavigator.Te(f),Gc.Wh.Uqc(Q),Gc.Wh.cPb(f,Q,b,!0,!0),Gc.Tca&&Gc.Tca.Cwc(f.currentNode,B.a.$q)):(a=Rc.App.Lb.Kd,b=ob.GraphIterator.pb(b.node),b.kf(),Gc.Cee(b,c),a.Mn.Nb.setSelection(Od.SelectionFactory.Aj(b.currentNode,!0)));y.dispose();pb.a.mark(4932);return 32}static h2j(a){return!(N.a.instance.ga(14)&&cd.TableReader.oYj(a))&&!(N.a.instance.ga(30)&&
cd.TableReader.VAb(a))}static insertRow(a,b,c,f,l){const y=a===C.a.zuc,H=(f=a===C.a.Fbb)||a===C.a.qVa;var Q=b.node;const ia=new ob.GraphIterator;ia.set(Q);ia.kf();let wa=!0;vk.m(Q)||cd.TableReader.Gs(ia)||(Gc.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.j4d}),wa=!1);wa&&!Gc.CBb(ia,a)&&(Gc.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.I2b}),wa=!1);if(1===c||!wa)return wa?32:8;pb.a.mark(4933);a=new pf.GraphTransaction(15);a.Sy(ia);b.node.jH().graphTransactionOperations.tja(2);y?(l=new ob.GraphIterator,l.Tc(ia),Za.OutlineElementNavigator.Te(l),
Sd.returnToContainingRow(ia),Gc.Yq.Kie(ia,H,1,Gc.yyb),Sd.moveToFirstColumn(ia),xg.OutlineNavigator.saa(ia),Gc.Wh.cPb(l,ia,b,!1,!0),Sd.returnToContainingRow(ia),Gc.Tca&&Gc.Tca.Cwc(l.currentNode,B.a.$q)):Gc.Yq.Kie(ia,H,!f&&l?l:1,Gc.yyb);b=Rc.App.Lb.Kd;Q=ob.GraphIterator.pb(Q);Q.sc(14);vk.l(Q)||Sd.returnToContainingRow(Q);f?Sd.moveToFirstRow(Q):H?Sd.moveToPreviousRow(Q):Sd.moveToNextRow(Q);Gc.L4g(Q);b.Mn.Nb.setSelection(Od.SelectionFactory.Aj(Q.currentNode,!0));a.dispose();pb.a.mark(4934);return 32}static Fka(a,
b,c,f,l){b=ii.k6(a,b,c,f,l,{},16);2===c&&Gc.Bpa(a)&&ka.ULS.sendTraceTag(8791561,324,50,String.format("ActionId={0}, ActionName={1}, Response={2}",a,C.a.Hv(a)||"Unknown",b));return b}static Bpa(a){return a===C.a.T3c||a===C.a.S3c||a===C.a.U3c||a===C.a.Q3c||a===C.a.P3c||a===C.a.R3c||a===C.a.M3c||a===C.a.L3c||a===C.a.N3c}static KDa(a,b,c){const f=new ob.GraphIterator;let l=b.isValid;l&&(f.set(b.node),f.kf()||(Gc.Xc.Xb(Kd.a.h2,{["Reason"]:Qd.a.jSc}),l=!1),ae.isTableCellNode(b.node)||(Gc.Xc.Xb(Kd.a.$o,
{["Reason"]:Qd.a.K2b}),l=!1));l&&!Gc.CBb(f,a)&&(Gc.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.I2b}),l=!1);if(l&&!Gc.hI.eVd()){a=new ob.GraphIterator;a.Tc(f);do if(!Gc.hI.l1b(a.currentNode)){Gc.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.ENc});l=!1;break}while(Sd.moveToNextRow(a))}if(l&&(a=new ob.GraphIterator,a.Tc(f),1!==c&&N.a.instance.ga(50)&&Rc.App.Mh.Bw)){do for(b=tk.a.bA(a.currentNode);b.moveNext();){const y=b.currentNode;Db.ParagraphReader.ae(y)&&Rc.App.Mh.hZ.Qra(y)}while(Sd.moveToNextRow(a))}if(1===c)return l?32:8;
if(l){pb.a.mark(4935);c=new pf.GraphTransaction(7);try{c.Sy(f),Gc.Yq.vSi(f)}finally{c&&c.dispose()}pb.a.mark(4936);return 32}return 2}static mergeCells(a,b,c,f,l){a=new ob.GraphIterator;if(f=b.isValid){a.set(b.node);a.kf()||(Gc.Xc.Xb(Kd.a.h2,{["Reason"]:Qd.a.jSc}),f=!1);ae.isTableCellNode(b.node)||(Gc.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.K2b}),f=!1);if(f&&!Gc.hI.eVd()){b=new ob.GraphIterator;b.Tc(a);var y=new ob.GraphIterator;y.Tc(a);for(var H=0;H<l.rowSpan;H++){for(var Q=0;Q<l.colSpan;Q++){if(!Gc.hI.l1b(b.currentNode)){Gc.Xc.Xb(Kd.a.$o,
{["Reason"]:Qd.a.ENc});f=!1;break}b.Gf(1)}if(!f)break;Sd.moveToNextRow(y);b.Tc(y)}}if(f&&1!==c&&N.a.instance.ga(50)&&Rc.App.Mh.Bw)for(b=new ob.GraphIterator,b.Tc(a),y=new ob.GraphIterator,y.Tc(a),H=0;H<l.rowSpan;H++){for(Q=0;Q<l.colSpan;Q++)Rc.App.Mh.hZ.Qra(b.currentNode),b.Gf(1);if(!f)break;Sd.moveToNextRow(y);b.Tc(y)}}if(1===c)return f?32:8;if(f){c=new pf.GraphTransaction(7);try{c.Sy(a),Gc.Yq.mergeCells(a,l.rowSpan,l.colSpan)}finally{c&&c.dispose()}return 32}return 2}static splitCells(a,b,c){a=
new ob.GraphIterator;let f=b.isValid;f&&(a.set(b.node),a.kf()||(Gc.Xc.Xb(Kd.a.h2,{["Reason"]:Qd.a.jSc}),f=!1),ae.isTableCellNode(b.node)||(Gc.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.K2b}),f=!1),f&&1!==c&&N.a.instance.ga(50)&&Rc.App.Mh.Bw&&(b=new ob.GraphIterator,b.Tc(a),Rc.App.Mh.hZ.Qra(b.currentNode)));if(1===c)return f?32:8;if(f){c=new pf.GraphTransaction(7);try{c.Sy(a)}finally{c&&c.dispose()}return 32}return 2}static H8(a,b,c,f,l){b=b.node;f=!0;cd.TableReader.Ocb(b)||(Gc.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.CNc}),
f=!1);Gc.hI.l1b(b)||(Gc.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.ENc}),f=!1);f&&(N.a.instance.ga(14)||N.a.instance.ga(63))&&Gc.fj.lqe(b)&&(Gc.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.kE}),f=!1);if(1===c)return f?32:8;if(f){if(N.a.instance.ga(50)&&Rc.App.Mh.Bw)for(c=tk.a.bA(b);c.moveNext();)f=c.currentNode,12===f.type&&Rc.App.Mh.hZ.Qra(f);l=Object(qa.a)(et,l);c=new pf.GraphTransaction(7);c.ld(b);f=new ob.GraphIterator;f.set(b);f.kf();f.Cc();Gc.Wh.RDa(f);c.dispose();l&&(l.I6b=!0);ka.ULS.sendTraceTag(42505435,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}",
a,C.a.Hv(a)||"Unknown",N.a.instance.ga(77),b.id.toString()));return 32}return 2}static deleteRow(a,b,c,f,l){b=b.node;if(!Gc.hI.l1b(b))return 8;f=new ob.GraphIterator;f.set(b);f.kf();let y=vk.m(b);y||Gc.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.ZMf});y&&!Gc.CBb(f,a)&&(Gc.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.I2b}),y=!1);if(1===c)return y?32:8;if(y){if(N.a.instance.ga(50)&&!Rc.App.Mh.amIAlone)for(a=tk.a.bA(b);a.moveNext();)c=a.currentNode,12===c.type&&Rc.App.Mh.hZ.Qra(c);pb.a.mark(4937);l=Object(qa.a)(et,l);a=new pf.GraphTransaction(7);
a.ld(b);Gc.Yq.APc(f);a.dispose();l&&(l.I6b=!0);pb.a.mark(4938);return 32}return 2}static I8a(a,b,c){let f=!1;a=null;b.Pk&&(a=new ob.GraphIterator,a.set(b.node),(f=cd.TableReader.iq(a)&&cd.TableReader.Ppe(a.currentNode))?a.kf():Gc.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.YMf}));return 1===c?f?32:8:f?(pb.a.mark(4939),b=new ob.GraphIterator,b.Tc(a),Sd.moveToCell(b,0,0),Za.OutlineElementNavigator.Te(a),c=new pf.GraphTransaction(7),c.Sy(b),Gc.Wh.Xph(a,b),c.dispose(),pb.a.mark(4940),32):2}static insertTable(a,b,
c,f,l){if(!b.Pk||!Mb.SelectionEditor.Xg(b))return 2;if(N.a.instance.ga(14)&&Gc.fj.Xua(b))return Gc.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.kE}),2;if(Gc.lr()&&Gc.lr().instance&&Gc.lr().instance.fX(b))return 2;var y=new ob.GraphIterator;y.set(b.node);Mb.SelectionEditor.Mt(y);if(ze.b(y))return Gc.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.x_d}),2;if(1===c)return 32;c=1;y=2;l&&(c=l.rows,y=l.columns);f.QC=y;f.RN=c;if(Mb.SelectionEditor.Xg(b)){f=new pf.GraphTransaction(7);pb.a.mark(4927);f.ld(b.node);b.node.jH().graphTransactionOperations.tja(2);
const Q=new AI.a;N.a.instance.ga(50)&&Rc.App.Mh.Bw&&Rc.App.Mh.hZ.Qra(b.node);var H=tb.a.Bs(b);N.a.instance.ga(49)&&(H.cache.xt&&(H=H.fe(null),Gc.oh.jK(H)),Q.formatting=H.Am);Q.languageId=tb.a.language(H);N.a.instance.ga(71)&&(Q.style=fb.StyleReader.tE(b.node),Gc.Uf.I4b(Q.style)&&(H=fb.StyleReader.JL(b.node)))&&(Q.style=H.kH(fb.StyleReader.sNa));N.a.instance.ga(54)?(H=ob.GraphIterator.pb(b.node),H.sc(11),Gc.SM.c9(H.currentNode)):new vv.a(1,-1);b=Gc.Wh.bQj(b);H=l&&l.b2j?Gc.Yq.C3(b,c,y,Q):Gc.Yq.C3(b,
c,y,Q,!0);l&&(l.tableNode=H);Za.OutlineElementNavigator.Te(b);N.a.instance.ga(56)&&Q.style&&!Wd.OutlineElementReader.wpe(b.currentNode)&&Q.style.sa(ab.a.BY,!1)&&Gc.Wh.SLa(b.currentNode,!0);Gc.jq.UQa(b,null,!0,!1,-1);Wd.OutlineElementReader.vcb(b)&&Gc.Wh.nea(b,!1,!0,Q);f.dispose();ka.ULS.sendTraceTag(42505436,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}, RowCount={4}, ColumnCount={5}",a,C.a.Hv(a)||"Unknown",N.a.instance.ga(77),H.id.toString(),c,y));pb.a.mark(4928);
w.AFrameworkApplication.dM("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorGridTableDefaultStyleSettings");return 32}return 2}static dwc(a,b,c){if(1===c)return 32;pb.a.mark(5748);a=b.node;b=new pf.GraphTransaction(15);b.ld(a);a.setValue(ab.a.xmb,!a.sa(ab.a.xmb,!0));b.dispose();pb.a.mark(5749);return 32}static upc(a,b,c,f,l){l.setValue(ab.a.xmb,!b.node.sa(ab.a.xmb,!0));return 32}}Gc.dJh="top";Gc.gwk="center";Gc.qqi="bottom";Gc.KQf="__cumulative__";Gc.o_d="__consistent__";Gc.sC=new ul.a;Gc.RD=
new ul.a;Gc.Ji=null;Gc.kv=null;Gc.OG=null;Gc.buf=null;Gc.gef=null;Gc.yF=null;Gc.Sm=null;Gc.B4a=null;Gc.tki=Gc.huj;Gc.rFd=null;Gc.oFd=null;Gc.pFd=null;Gc.qFd=null;Gc.sFd=null;Gc.vFd=null;Gc.tFd=null;Gc.UHd=null;Gc.kd=null;Gc.If=null;Gc.hd=null;Gc.hp=null;Gc.VNa=null;Gc.fh=null;Gc.fp=null;Gc.Mha=null;Gc.bE=null;Object(m.a)(Gc,"TableActor",null,[]);var CI=d(311),NQ=d(839),DI=d(899),OQ=d(410),PQ=d(824);class EI{constructor(a,b,c,f){this.FPc=this.DPc=null;this.xuc=a;this.Nvd=b;this.hEh=c;this.jEh=f}}Object(m.a)(EI,
"TableSimplificationInformation",null,[]);var Gv=d(425),QQ=d(458),mu=d(255),Dq=d(219);class Uh{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc){this.fh=this.B4a=this.DN=this.Hp=null;this.yKd=!1;this.i3h=y;this.OG=H;this.Opb=a;this.bE=b;this.ay=c;this.Ji=f;this.fp=l;this.Oa=Q;this.Lk=wa;this.XQd=ia.create(2097162);this.uUe(this.XQd);this.gff=ia.create(2097162);this.uUe(this.gff);this.Cvf=ia.create(2097162);this.uUe(this.Cvf);this.A2=this.XQd;this.DPd=Ua;this.cE=kb;this.hd=Gb;this.yYb=ec;this.I6h=
ec.substr(0,3);this.Kqa=dc}get Uf(){return this.fh||(this.fh=Ib.a.instance.resolve("Box4.List.IListReader"))}get Zr(){return this.Hp?this.Hp.Zr:0}get O8a(){return this.Hp.mb.O8a}get oka(){return this.Hp.mb.oka}get e6e(){return this.A2}get w_d(){return this.Hp.uH&&!this.yKd}Tyh(){this.yKd=!0}get Ach(){return!this.Hp.uH}get Bba(){return Zd.a.instance}get p0j(){return this.Oa.ka("InternalPasteTableWithReplacingCellIsEnabled")&&N.a.instance.ga(63)||N.a.instance.ga(77)}uUe(a){var b=new QQ.a(-1);this.i3h.uV.Esb(b);
const c=new ob.GraphIterator;c.set(b);b=this.Lk.je(3);b.Sy(c);c.Hl(a,80);b.dispose()}d0d(a,b=null){a=a.Nb;this.Hp=a.Pa.clone();this.yKd=!1;a=ob.GraphIterator.pb(a.Kmb);const c=ob.GraphIterator.pb(this.A2),f=this.Lk.je(3);f.Sy(c);a.Cb(82);do a.currentNode.i3a(null);while(a.Nj(82));a=new Lh.a(b,Object(I.a)(this,this.bBi,"clearInternalClipboard"),new uI(a,c,this.Hp,f));a.$l("InternalCopy");a.Wi=!b||b.Wi;a.run()}bBi(a,b){pb.a.mark(5566);b=b.target;if(b.Oi())return b.Ni(),!0;a.hh(Object(I.a)(this,this.ORc,
"executeCopy"));return!0}ORc(a,b){b=new jz(b,null);b=new Lh.a(a,Object(I.a)(this,this.Y2b,"coreCopySetup"),b);b.$l("ExecuteCoreCopyToInternalClipboard");b.run();a.hh(Object(I.a)(this,this.XIl,"trimNewText"));return!0}Y2b(a,b){if(!b.source.Oi())return b.ag&&(b.ag.oMc=null),ka.ULS.shipAssertTag(6305560,307,!1),!1;a.hh(Object(I.a)(this,this.$Nf,"coreCopyIteration"));return!0}$Nf(a,b){const c=b.insertAfter,f=b.source,l=b.target,y=f.currentNode;var H=this.Ach;if(!y.Xoe)return a.hh(Object(I.a)(this,this.VNc,
"coreCopyIncrement")),!0;b.ag.Btd&&(b.Btd=!0);if(!b.Btd&&(y.G5b()&&b.e7.ula.c++,y.G5b()||H&&!y.qBb(this.Zr)))return a.hh(Object(I.a)(this,this.VNc,"coreCopyIncrement")),!0;if(!b.Btd&&H&&!y.Qy)return f.rFa()&&(b.Pyd=!0,b=new Lh.a(a,Object(I.a)(this,this.Y2b,"coreCopySetup"),new jz(b,c)),b.$l("RecursiveCoreCopyToInternalClipboard"),b.run()),a.hh(Object(I.a)(this,this.VNc,"coreCopyIncrement")),!0;H=l.currentNode.Vo().Fi;H=Fm.a(y,H,!0);this.Bba.Aqc(b.e7.Oab,H);l.OL(H,c,18===f.parentNode.type?1:f.role);
l.$k(H);b.insertAfter=H;Db.ParagraphReader.ae(H)&&(this.YTk(a,Object(I.a)(this,this.Y2b,"coreCopySetup"),y,H,b),this.XTk(y,H));this.VXf(y,H);f.rFa()&&(ka.ULS.shipAssertTag(6305562,307,!b.Pyd),b=new Lh.a(a,Object(I.a)(this,this.Y2b,"coreCopySetup"),new jz(b,null)),b.$l("RecursiveCoreCopyToInternalClipboard"),b.run());a.hh(Object(I.a)(this,this.TIi,"coreCopyIterationPostProcessing"));return!0}TIi(a,b){var c=b.source;const f=b.target;var l=f.currentNode,y=c.currentNode;Db.ParagraphReader.ql(f)&&(b.dOe[y.id.toString()]=
l);if(N.a.instance.ga(54)&&Db.ParagraphReader.ae(l)){if(0<Db.ParagraphReader.Ybg(y))if(0<this.OG.$$a(y).oN)y.setValue(Ab.a.Lnc,0);else{var H=this.OG.hyb(y).oN;Uh.paragraphEditor.Jv.hlb(l,H)}if(!this.Sbb&&this.Kqa.$kd){c.Cc();if(!cd.TableReader.Gs(f)&&c.ZAb&&!this.oka)for(var Q of this.Kqa.zLk)l.removeProperty(Q);c.$k(y)}}if(N.a.instance.ga(57)&&Db.ParagraphReader.ae(l)){H=[];Q=[];for(let ia=0;ia<l.wordRunProperties.length;ia++)l.wordRunProperties.NY.$(ia,CI.CharacterPropertiesEditor.Zfa),l.wordRunProperties.lga.$(ia,
CI.CharacterPropertiesEditor.Yfa),H[ia]=!0,Q[ia]=!1;l.ye(Ab.a.hhd,H);ka.ULS.shipAssertTag(6305563,307,H.length===l.wordRunProperties.length);ka.ULS.shipAssertTag(6305564,307,N.a.instance.ga(50));ka.ULS.shipAssertTag(6305565,307,!!Rc.App.Mh);N.a.instance.ga(50)&&Rc.App.Mh.Bw&&(l.ye(dt.a.Vw,Q),ka.ULS.shipAssertTag(6305566,307,Q.length===l.wordRunProperties.length));(this.hd.ig&&this.hd.jz||N.a.instance.ga(45)&&Rc.App.hE.rQb)&&l.setValue(Ab.a.sbc,!0);N.a.instance.ga(14)&&l.vo(Ab.a.W6d,Ab.a.oLk,Ab.a.qLk);
N.a.instance.ga(45)&&Db.ParagraphReader.ae(l)&&l.vo(Ab.a.Jcb)}this.ych(f)&&(H=f.currentNode.jH(),l=ba.ImageReader.EWc(f.currentNode.properties,H.Fi,!1),H=ba.ImageReader.EWc(f.currentNode.properties,H.Fi,!0),Q=null,Nb.EmbeddedFileReader.W0c(f)&&(Q=Nb.EmbeddedFileReader.iVc(f.currentNode)),this.Y6d(l,y),this.Y6d(H,y),this.Y6d(Q,y));this.Ach&&(this.UXf(f),cd.TableReader.iq(f)&&(y=this.Hp.FW(),y.moveNext(),(y=ae.getCellLocation(c,y.current.node))||(y=new PQ.a(0,0)),c=new EI(y,f,cd.TableReader.Wcj(c),
cd.TableReader.$pj(c)),this.bE.fbl(c)));Wd.OutlineElementReader.ih(f)&&!f.gJ(2)&&(this.Ji.nda(f),f.Cc());f.Cc();b.ag&&(b.ag.oMc=b.insertAfter);a.hh(Object(I.a)(this,this.VNc,"coreCopyIncrement"));return!0}VNc(a,b){b.Pyd&&(b.insertAfter=b.oMc,b.Pyd=!1);if(!b.source.oFa()){b.ag&&(b.ag.oMc=b.insertAfter);const c=b.source;11!==c.Bi||c.nWc(-1)||this.qUk(a,c.currentNode,b.target.currentNode,b);return!1}a.hh(Object(I.a)(this,this.$Nf,"coreCopyIteration"));return!0}XTk(a,b){a=cg.f(a);cg.f(b);for(b=0;b<a.length;b++)Object(I.a)(this,
this.Y2b,"coreCopySetup")}XIl(a,b){if(b.Isa>=b.aNb.length)return a.hh(Object(I.a)(this,this.SIi,"copyTeardown")),!0;a=b.aNb[b.Isa];var c=a.node,f=a.Sa,l=a.Mb;if(!Mb.SelectionEditor.ju(a))if(!b.Isa&&Mb.SelectionEditor.im(a))l=f=Db.ParagraphReader.textLength(c);else if(Db.ParagraphReader.Fm(a))f=0,l=Db.ParagraphReader.textLength(c);else if(Mb.SelectionEditor.v9(a)){ka.ULS.shipAssertTag(6305568,307,!b.Isa);var y=ob.GraphIterator.pb(c);f=y.sc(12);ka.ULS.shipAssertTag(6305569,307,f);c=y.origin;l=f=Db.ParagraphReader.textLength(c)}else{if(gj.OutlineReader.Abc(a))for(a=
zx.a.bA(a.node);a.moveNext();)y=a.currentNode,Db.ParagraphReader.ae(y)&&Array.add(b.aNb,cb.a.createTextRange(y,0,Db.ParagraphReader.textLength(y)));b.Isa++;return!0}y=b.dOe[c.id.toString()];ka.ULS.shipAssertTag(6305570,307,!!y);if(!y)return ka.ULS.sendTraceTag(21041548,307,15,"TrimNewTextParagraphCloneNull: {0}",{["ContextIndex"]:b.Isa,["SelectedContextsLength"]:b.aNb.length,["SelectedNodeType"]:c.type,["ContextId"]:a.contextId}),b.Isa++,!0;c=cg.f(y);let H,Q=!1;for(H=c.length-1;0<=H;H--)if(!c[H].KLc)if(4===
c[H].Bq)c[H].Je.blob=null,c[H].Je.blob=new Gv.a(c[H].Je,Gv.a.sPc),b.e7.ula.e++;else{c[H].Je.blob=null;if(N.a.instance.ga(57)&&-1!==c[H].ug){var ia=c[H].Je.formatting,wa=void 0,Ua=void 0;ia&&-1===ia.ug?(Ua=c[H].ug+1,wa=c[H].uaa-1,ia.ug=c[H].ug):(wa=c[H].uaa,Ua=c[H].ug);for(ia=0;ia<wa;ia++)y.wordRunProperties.removeAt(Ua,16);0<wa&&(Q=!0)}wa="";mu.f(c[H])?(wa=" ",b.e7.ula.f++):mu.g(c[H])&&(Ua=mu.b(c[H]))&&(wa=mu.a(Ua),b.e7.ula.g++);Ua=c[H].Je.cp;Ua>=f&&Ua<l&&(Uh.characterPropertiesEditor.replaceTextRange(cb.a.createTextRange(y,
Ua,Ua+1),wa),l=l-1+wa.length,b.e7.ula.i++)}Q&&y.jv();this.C6k(y);c=Db.ParagraphReader.textLength(y);l<c&&Uh.characterPropertiesEditor.replaceTextRange(cb.a.createTextRange(y,l,c),"");0<f&&Uh.characterPropertiesEditor.replaceTextRange(cb.a.createTextRange(y,0,f),"");f=0;l=ob.GraphIterator.pb(y);for(l.Cb(6);!l.mr;)c=l.currentNode,l.Nj(6),ba.ImageReader.tH(c)?ba.ImageReader.spe(c)?(Uh.paragraphEditor.vNf(c,cb.a.Lj(y,f)),f++,b.e7.ula.d++):(c=ob.GraphIterator.pb(c),c.sc(12),c.Ni(),b.e7.ula.h++):ka.ULS.shipAssertTag(6305571,
307,!1);!Db.ParagraphReader.textLength(y)&&b.Isa===b.aNb.length-1&&Mb.SelectionEditor.ju(a)&&(a=ob.GraphIterator.pb(y),a.sc(25)&&(Za.OutlineElementNavigator.Te(a),this.Ji.RDa(a),b.Isa&&(this.Hp.mb.oka=!0)));this.Bba.o0a(b.e7.Ikd,b.e7.v8a,b.e7.jRa,y);b.Isa++;return!0}C6k(a){const b=N.a.instance.ga(14),c=!this.hd.ig&&N.a.instance.ga(45),f=Uh.iO,l=a.Ta;if(N.a.instance.ga(57)&&l&&(b||c)){var y=new Na.a,H=new Na.a;for(let ia=0;ia<l.length;ia++){const wa=l.ga(ia);if(b){wa.Kl&&y.add(wa);if(f){if(wa.$h){for(var Q=
0;Q<wa.$h.length;Q++)H.add(wa.$h.ga(Q).ug);wa.$h=null}}else wa.fieldRangeEnd&&(H.add(wa.fieldRangeEnd.ug),wa.fieldRangeEnd=null),wa.To&&(H.add(wa.To.ug),wa.To=null);if(wa.Ck){for(Q=0;Q<wa.Ck.length;Q++)H.add(wa.Ck.ga(Q).ug);wa.Ck=null}}if(c){if(Rc.App.hE.rQb){wa.formatting&&Uh.oh.jK(wa.formatting);if(wa.hyperlink){for(Q=0;Q<wa.hyperlink.uaa;Q++)H.add(wa.hyperlink.ug+Q);wa.hyperlink=null}wa.zn=!1}wa.trackedChange=null;wa.sJ=!1}}a.dLa(!0,H);for(let ia of y)ia.Kl=null;c&&1<l.length&&(a=l.first,a.trackedChange=
new NQ.a(a),l.last.sJ=!0)}}SIi(a,b){this.A2.i3a(null);b.zyj.dispose();pb.a.mark(5567);this.qyk();this.DN=b.e7;this.Xvg("Copy");this.nUj&&ka.ULS.sendTraceTag(6305600,307,50,"Empty ClipboardRoot");return!1}get nUj(){return!ob.GraphIterator.pb(this.A2).Oi()}MRl(){this.A2=this.Cvf}LRl(){this.A2=this.XQd}zRl(){this.A2=this.gff}sKf(){const a=ob.GraphIterator.pb(this.A2);for(;a.Oi();)a.Ni()}Xvg(a){const b=this.DN.ula.b;a+="-"+b;this.DN.ula.b=a;this.DN.Oab.b=a;this.DN.Ikd.b=a;this.DN.v8a.b=a;this.DN.jRa.b=
a;this.Bba.Mbk(this.DN.ula);this.Bba.qse(this.DN.Oab);this.Bba.wwg(this.DN.Ikd);this.Bba.kse(this.DN.v8a);this.Bba.jse(this.DN.jRa);this.DN.ula.b=b;this.DN.Oab.b=b;this.DN.Ikd.b=b;this.DN.v8a.b=b;this.DN.jRa.b=b}Geh(a,b,c,f,l=null,y=null){this.Xvg("Paste");b=ob.GraphIterator.pb(b);const H=ob.GraphIterator.pb(this.A2);var Q=null;l&&(Q=new ax.a(gj.OutlineReader.rPc,gj.OutlineReader.XRf),Q=l.equals(new ax.a(-1,-1))?new ax.a(0,0):l.rV(Q));if(this.L_c())if(H.Oi(),ba.ImageReader.tH(H.currentNode))l=H.currentNode,
H.Cc(),H.OL(this.Ji.c1d(),null,1),H.Oi(),H.OL(l,null,2),H.Cc(),H.$k(l),H.Ni(),this.Opb.fDk(),this.Tyh();else if(Nb.EmbeddedFileReader.gcb(H.currentNode)){l=H.currentNode;H.Cc();H.OL(this.Ji.c1d(),null,1);H.Oi();var ia=this.Ji.nda(H);ia=cb.a.Lj(ia,0);Uh.characterPropertiesEditor.replaceTextRange(ia,"<<"+Nb.EmbeddedFileReader.jVc(l)+">>");H.Cc();H.Cc();H.$k(l);H.Ni();this.Tyh()}this.p0j&&this.Tsg(H,b)?(H.currentNode.i3a(null),ka.ULS.sendTraceTag(7869376,307,50,"Begin internal paste table in table"),
this.o$k(y,H,b,Q,a),ka.ULS.sendTraceTag(39699553,307,50,"The call to ReplaceTableCellsFromClipboardTable ended.")):(pb.a.mark(5564),H.currentNode.i3a(null),a={},a[Uh.aLj]=f,Zb.ListReader.PVa(c)&&this.Uf.ppc&&(a[DI.a.Ykg]=!0),c=new kz(H,b,c,Q,a),f=new Lh.a(y,Object(I.a)(this,this.Z2b,"corePasteSetup"),c),f.$l("ExecuteCorePasteFromInternalClipboard"),f.Wi=!y||y.Wi,this.OTk(c),f.run())}tsg(a){if(a&&a.isValid){const b=ob.GraphIterator.pb(this.A2);return this.Tsg(b,a)}return!1}Tsg(a,b){if(ae.isTableCellOrInside(b)&&
1===a.M$a()){a.Cb(1);if(Wd.OutlineElementReader.ih(a)){Za.OutlineElementNavigator.yi(a);if(cd.TableReader.iq(a)){cd.TableReader.wt(a.currentNode)&&ka.ULS.sendTraceTag(17835601,307,50,"Source table is a complex table.");if(b.sc(14)&&!cd.TableReader.wt(Sd.getContainingTable(b)))return ka.ULS.sendTraceTag(19269659,307,50,"Target table is not a complex table."),!0;ka.ULS.sendTraceTag(19269660,307,50,"Target table is a complex table.");if(this.Sbb)return!0}Za.OutlineElementNavigator.Te(a)}a.Cc()}return!1}o$k(a,
b,c,f,l){c.sc(14);const y=vk.c(c),H=Qn.a(c);c.Kg(14);var Q=cd.TableReader.Gk(c.currentNode);const ia=cd.TableReader.Gi(c.currentNode),wa=cd.TableReader.Gk(b.currentNode),Ua=cd.TableReader.Gi(b.currentNode);ka.ULS.sendTraceTag(8716373,307,50,"Target and source table row column counts: target: {0},{1}; source: {2},{3};",Q,ia,wa,Ua);this.B4a=Gc.yyb;if(this.o4j(y+wa,H+Ua)){var kb=y+wa-Q;0<kb&&(Sd.moveToLastRow(c),ka.ULS.sendTraceTag(8716374,307,50,"Begin insert rows: "+kb),this.bE.Kie(c,!1,kb,this.B4a),
ka.ULS.sendTraceTag(8716375,307,50,"Completed inserting rows."),c.Kg(14));kb=H+Ua-ia;if(0<kb){ka.ULS.sendTraceTag(8716376,307,50,"Begin insert columns: "+kb);try{this.bE.rkg(c,ia,!1,kb,this.B4a)}catch(Gb){throw ka.ULS.sendTraceTag(19269661,307,10,"Insert columns failed: {0}",Gb.toString()),Gb;}ka.ULS.sendTraceTag(8716377,307,50,"Completed inserting columns.")}Q=this.Vbj(Q,ia,wa,Ua,y,H);ka.ULS.sendTraceTag(8716378,307,50,"Begin paste cell contents");a=new Lh.a(this.Sbb?a:null,Object(I.a)(this,this.BNk,
"pasteTableOperationRun"),new wI(null,b,c,f,y,H,Q,null,l));a.$l("ExecuteCorePasteTableInTable");a.Wi=!1;a.run()}}o4j(a,b){if(!this.Upg)return!0;const c={};a>Uh.rLc&&(c.rowCount=a,c.c_maxTableRowColCount=Uh.rLc);b>Uh.rLc&&(c.columnCount=b,c.c_maxTableRowColCount=Uh.rLc);const f=a*b;f>Uh.LGf&&(c.rowCount=a,c.columnCount=b,c.cellsCount=f,c.c_maxTableCellCount=Uh.LGf);0<Dq.a(c).length&&ka.ULS.sendTraceTag(39716808,307,10,"IsTableDimensionValid: {0}",c);return!Dq.a(c).length}BNk(a,b){if(b.IPb){if(b.IPb.inProgress)return!0;
ae.isTableCell(b.source)||b.source.Kg(16);this.Upg&&ae.isFirstCellInTable(b.source)&&this.H_b(b.Nf,b.target.currentNode);if(ae.isLastCellInTable(b.source))return this.syk(Sd.getContainingTable(b.target)),ka.ULS.sendTraceTag(7869377,307,50,"End of internal paste table in table"),!1;ae.isTableCell(b.target)||b.target.Kg(16);const c=!this.Sbb;ae.isLastCellInRow(b.source)?(Sd.moveToNextRow(b.target),Sd.moveToColumnByIndex(b.target,b.Jja),ka.ULS.sendTraceTag(8716379,307,50,"Move to next row to replace cell contents")):
Sd.moveToNextOrPreviousCell(b.target,!1,c);Sd.moveToNextOrPreviousCell(b.source,!1,c)}else cd.TableReader.iq(b.target)||b.target.Kg(14),cd.TableReader.iq(b.source)||b.source.Kg(14),Sd.moveToCell(b.target,b.rowIndex,b.Jja),Sd.moveToCell(b.source,0,0);for(;b.target.Oi();)b.target.Ni();b.IPb=new Lh.a(a,b.Leh?b.Leh:Object(I.a)(this,this.Z2b,"corePasteSetup"),new kz(b.source,b.target,null,b.ukd));b.IPb.$l("ExecuteCorePasteCellContentInCell");b.IPb.Wi=!1;b.IPb.run();return!0}qyk(){if(this.Sbb){for(var a=
ob.GraphIterator.pb(this.e6e),b=a.currentNode;14!==a.Bi;)if(b=a.Oi(),!b){ka.ULS.sendTraceTag(39716809,307,50,"NormalizeCopiedTable: Couldn't find any Table graph node under this.TheClipboardRoot.");return}this.Y5g(b)}}syk(a){this.Sbb&&this.Y5g(a)}rGl(a){const b=ob.GraphIterator.pb(a);this.ay.U$b(b,null,!0);a.isGhostCell=!1;a.rowSpan=1;a.colSpan=1}Y5g(a){if(a&&14===a.type){ka.ULS.sendTraceTag(39716810,307,50,"NormalizeTable: start to normalize.");var b={},c=cd.TableReader.Gk(a),f=cd.TableReader.Gi(a),
l=ob.GraphIterator.pb(a);Sd.forEachCellInTable(l,(y,H,Q)=>{const ia={};y=y.currentNode;if(16===y.type)if(y.isGhostCell)Uh.wMf(H,Q)in b||(this.rGl(y),ia.IsGhostCell="->false");else{N.a.instance.ga(77);Uh.T1k(a,y,H,Q,c,(Ua,kb,Gb)=>{ia.rowSpan=String.format("{0}:{1}->{2}",Ua,kb,Gb)});Uh.S1k(a,y,Q,H,f,(Ua,kb,Gb)=>{ia.colSpan=String.format("{0}:{1}->{2}",Ua,kb,Gb)});const wa=String.format("{0},{1}-{2},{3}",H,Q,H+y.rowSpan,Q+y.colSpan);for(let Ua=0;Ua<y.rowSpan;Ua++)for(let kb=0;kb<y.colSpan;kb++)if(Ua||
kb)b[Uh.wMf(H+Ua,Q+kb)]=wa}if(0<Dq.a(ia).length){if(void 0===ia.IsGhostCell||null===ia.IsGhostCell){if(void 0===ia.rowSpan||null===ia.rowSpan)ia.rowSpan=y.rowSpan;if(void 0===ia.colSpan||null===ia.colSpan)ia.colSpan=y.colSpan}ka.ULS.sendTraceTag(39175904,307,50,"NormalizeTable: [{0},{1}]: {2}.",H,Q,ia)}return!0});Uh.cXi(b)}}get Upg(){return N.a.instance.ga(77)}get Sbb(){return!!this.Oa&&this.Oa.ka("ComplexTableCellPasteWithFormattingIsEnabled")}H_b(a,b){a?(b=ob.GraphIterator.pb(b),b.zB(1)?(b=b.Cb(2))?
(b=Od.SelectionFactory.Qg(b,0),a.Nb.setSelection(b)):ka.ULS.sendTraceTag(38843739,307,50,"AdjustSelectionAfterPaste: no child paragraph node was found."):ka.ULS.sendTraceTag(38843740,307,50,"AdjustSelectionAfterPaste: no child OE node was found.")):ka.ULS.sendTraceTag(38843738,307,50,"AdjustSelectionAfterPaste: interactiveView is null, abort.")}Vbj(a,b,c,f,l,y){const H=[];for(let Q=0;Q<Math.max(l+c,a);Q++){let ia=0,wa=y+f;for(Q<l?ia=b:Q>=l&&Q<Math.min(l+c,a)?ia=y:Q>=l+c&&Q<a?ia=b:wa=Math.max(y+f,
b);ia<wa;ia++)Array.add(H,Array(2)),H[H.length-1][0]=Q,H[H.length-1][1]=ia}return H}Z2b(a,b){if(!b.source.Oi())return a.hh(Object(I.a)(this,this.D_a,"pasteTeardown")),!0;a.hh(Object(I.a)(this,this.aOf,"corePasteIteration"));return!0}y$k(a,b){if(this.Sbb)if(!b||!a)ka.ULS.sendTraceTag(39175905,307,50,"ReplicateTableCellProperties: {0}",{["source"]:a,["table"]:b});else if(16===b.currentNode.type&&16===a.parentNode.type){b=b.currentNode;a=a.parentNode;var c={};b.isGhostCell!==a.isGhostCell&&(b.isGhostCell=
a.isGhostCell,c.IsGhostCell=b.isGhostCell);b.isSkippedCell!==a.isSkippedCell&&(b.isSkippedCell=a.isSkippedCell,c.IsSkippedCell=b.isSkippedCell);b.Jlb!==a.Jlb&&(b.Jlb=a.Jlb,c.ShouldRenderCell=b.Jlb);b.colSpan!==a.colSpan&&(c.ColSpan=String.format("{0}<={1}.",b.colSpan,a.colSpan),b.colSpan=a.colSpan);b.rowSpan!==a.rowSpan&&(c.RowSpan=String.format("{0}<={1}.",b.rowSpan,a.rowSpan),b.rowSpan=a.rowSpan);Dq.a(c)}}aOf(a,b){const c=b.source,f=b.target,l=c.currentNode;if(!l.Xoe||!l.pub)return a.hh(Object(I.a)(this,
this.WNc,"corePasteIncrement")),!0;if(this.hd.ig&&Wd.OutlineElementReader.ih(c)){if(!Za.OutlineElementNavigator.yi(c).pub)return Za.OutlineElementNavigator.Te(c),a.hh(Object(I.a)(this,this.WNc,"corePasteIncrement")),!0;Za.OutlineElementNavigator.Te(c)}ka.ULS.shipAssertTag(6305608,307,!l.G5b());var y=f.currentNode.Vo().Fi;y=Fm.a(l,y,!0);y.bib();this.y$k(c,f);f.OL(y,b.insertAfter,c.role);f.$k(y);b.insertAfter=y;N.a.instance.ga(50)&&Rc.App.Mh.Bw&&Rc.App.Mh.hZ.Qra(y);this.VXf(l,y);b=new Lh.a(a,Object(I.a)(this,
this.Z2b,"corePasteSetup"),new kz(c,f,null,b.ukd,b.vL));b.$l("RecursiveCorePasteOperation");b.run();a.hh(Object(I.a)(this,this.XIi,"corePasteIterationPostProcessing"));return!0}wUk(a,b,c){b=cg.f(b);c=cg.f(c);for(let f=b.length-1;0<=f;f--)b[f].ZKe(c[f],a,Object(I.a)(this,this.Z2b,"corePasteSetup"))}Y6d(a,b){a&&(ka.ULS.shipAssertTag(6305610,307,a.Ua(Ts.a.xnc)),a.Ua(Ts.a.xnc)||a.setValue(Ts.a.xnc,a.sa(Ts.a.K6g,"")),b=(b=OQ.SectionNavigator.Bag(b))?b.fileId:Rc.App.Lb.Kd.Jca?Rc.App.Lb.Kd.Jca.fileId:null,
!a.Ua(Ts.a.fileId)&&b&&a.setValue(Ts.a.fileId,b))}Z6d(a){a&&this.Opb.qml()}XIi(a,b){const c=b.target,f=c.currentNode,l=b.source.currentNode;Db.ParagraphReader.ae(f)&&(this.xUk(a,Object(I.a)(this,this.Z2b,"corePasteSetup"),l,f,b),this.wUk(a,l,f));f.u7g();b.vL[DI.a.Ykg]&&22===f.type&&f.setValue(Ab.a.listID,Number.MAX_VALUE);if(N.a.instance.ga(11)&&Db.ParagraphReader.ae(f)){var y=cg.j(f,5);if(0<y.length){for(var H of y)!H.properties.Ua(Ab.a.Jfh)&&H.properties.Ua(Ab.a.Hfh)&&H.properties.setValue(Ab.a.Jfh,
H.properties.eb(Ab.a.Hfh)),ba.ImageReader.ppe(H.properties)||this.Opb.mfl();f.Vo().contentReplicator.forceOutbound(null,null,null)}}N.a.instance.ga(25)&&Wd.OutlineElementReader.ih(c)&&this.Ji.Q8e(c.currentNode);N.a.instance.ga(10)&&gj.OutlineReader.a2c(f)&&(y=yq.b(f),b=b.ukd,yq.c(f,y.x+b.x,y.y+b.y));if(this.ych(c)){b=c.currentNode.jH();y=ba.ImageReader.EWc(c.currentNode.properties,b.Fi,!1);H=ba.ImageReader.EWc(c.currentNode.properties,b.Fi,!0);let Q=null;Nb.EmbeddedFileReader.W0c(c)&&(Q=Nb.EmbeddedFileReader.iVc(c.currentNode));
this.Z6d(y);this.Z6d(H);this.Z6d(Q);if(y||H||Q)b.A_j=!0,b.B_j=!0}N.a.instance.ga(24)&&Nb.EmbeddedFileReader.W0c(c)&&(b=c.currentNode,Nb.EmbeddedFileReader.QWj(c)?(c.Cc(),y=this.ay.aNi(),y.setValue(ab.a.xJ,Uh.Tk.isRtl(b)?11:9),H=yq.b(f),yq.c(y,H.x,H.y),c.OL(y,b,1),c.$k(b),c.cUf(),this.ay.nW(c,!1)):c.Ni(),y=this.Ji.nda(c),y=cb.a.Lj(y,0),Uh.characterPropertiesEditor.replaceTextRange(y,"<<"+Nb.EmbeddedFileReader.jVc(b)+">>"));this.UXf(c);this.MQl(l,f);c.Cc();a.hh(Object(I.a)(this,this.WNc,"corePasteIncrement"));
return!0}ych(a){return N.a.instance.ga(1)&&ba.ImageReader.ebc(a)||N.a.instance.ga(24)&&Nb.EmbeddedFileReader.W0c(a)}MQl(a,b){if(this.hd.ig&&cd.TableReader.Ocb(a)){let c=0;const f=cd.TableReader.Gk(a);for(let l of cd.TableReader.RWc(a,0,f-1))l.pwc&&c++;a=this.Lk.je(4);a.ld(b);b.properties.setValue(ab.a.Nza,f-c);a.dispose()}}WNc(a,b){if(!b.source.oFa())return a.hh(Object(I.a)(this,this.D_a,"pasteTeardown")),!0;a.hh(Object(I.a)(this,this.aOf,"corePasteIteration"));return!0}D_a(){pb.a.mark(5565);return!1}shd(){return!ob.GraphIterator.pb(this.A2).Oi()}L_c(){return this.w_d?
1===ob.GraphIterator.pb(this.A2).M$a():!1}LQj(){const a=ob.GraphIterator.pb(this.A2);this.L_c()&&a.Oi();return 1===a.M$a()&&(a.Oi(),Wd.OutlineElementReader.ih(a)&&1===a.M$a()&&a.Cb(2))?Db.ParagraphReader.ql(a)&&!Uh.hI.$Mf(a):!1}ucj(){const a=ob.GraphIterator.pb(this.A2);this.L_c()&&a.Oi();a.Oi();a.Oi();ka.ULS.shipAssertTag(6305614,307,Db.ParagraphReader.ql(a));return Db.ParagraphReader.text(a.currentNode)}H5f(a){try{return this.Udj(a)}catch(b){return ka.ULS.sendTraceTag(23643968,307,10,"GetCopySourceFromDOMTree failed with exception:{0}",
b.message),0}}Udj(a){let b=0;if(a&&(b=this.Tdj(a),0===b&&a.childNodes))for(let c=0;c<a.childNodes.length&&(b=this.H5f(a.childNodes[c]),0===b);c++);return b}Tdj(a){if(1===a.nodeType&&a.getAttribute){a=(a.getAttribute("class")||"").split(" ");for(const b of a)if(b.startsWith(this.I6h))return b.startsWith(this.yYb)?this.Zr&&b===this.yYb+this.Zr?3:2:1}return 0}YTk(a,b,c,f,l){l.vL||(l.vL={});Uh.Ma.raiseEvent("OnParagraphCopy",new lz(a,b,c,f,l.vL))}qUk(a,b,c,f){f.vL||(f.vL={});Uh.Ma.raiseEvent("OnCopyComplete",
new lz(a,null,b,c,f.vL))}OTk(a){a.vL||(a.vL={});Uh.Ma.raiseEvent("BeforePaste",new vI(a.vL))}xUk(a,b,c,f,l){Uh.Ma.raiseEvent("OnParagraphPaste",new lz(a,b,c,f,l.vL))}UXf(a){ae.isTableCell(a)&&(a.Cb(1)||this.ay.nW(a,!0),a.Cc())}VXf(a,b){this.DPd.isTableCellNode(b)&&(b.width=a.width)}static get oh(){return Uh.If||(Uh.If=Ib.a.instance.resolve("Box4.IFormattingEditor"))}static get characterPropertiesEditor(){return Uh.mh||(Uh.mh=Ib.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get paragraphEditor(){return Uh.qx||
(Uh.qx=Ib.a.instance.resolve("Box4.IParagraphEditor"))}static get iO(){const a=Ib.a.instance.qb("Box4.IFeatureHelper");return!!a&&a.isFeatureEnabled(79)}static get hI(){return $h.a.instance}static get Tk(){return $w.PageReader.instance}static cXi(a){const b={};for(const c of Dq.a(a)){const f=a[c];b[f]=f in b?String.format("{0}|{1}",b[f],c):c}1<=Dq.a(b).length&&ka.ULS.sendTraceTag(39204995,307,50,"NormalizeTable: ghostCells - {0}",b)}static S1k(a,b,c,f,l,y){b.colSpan>l-c&&(y&&y("A",b.colSpan,l-c),
b.colSpan=l-c);a=Uh.Oxl(a,b,f,c);b.colSpan!==a&&(y&&y("B",b.colSpan,a),b.colSpan=a)}static T1k(a,b,c,f,l,y){b.rowSpan>l-c&&(y&&y("A",b.rowSpan,l-c),b.rowSpan=l-c);a=Uh.Pxl(a,b,c,f);b.rowSpan!==a&&(y&&y("B",b.rowSpan,a),b.rowSpan=a)}static Oxl(a,b,c,f){return Uh.aDh(a,b.colSpan,(l,y)=>{Sd.moveToCell(l,c,f+y)})}static Pxl(a,b,c,f){return Uh.aDh(a,b.rowSpan,(l,y)=>{Sd.moveToCell(l,c+y,f)})}static aDh(a,b,c){if(14!==a.type)throw Error.argument("tableNode is not a Table.");if(!c)throw Error.argumentNull("MoveToCellAction");
for(let l=1;l<b;l++){var f=ob.GraphIterator.pb(a);c(f,l);f=f.currentNode;if(!f||16!==f.type||!f.isGhostCell)return l}return b}static wMf(a,b){return a+","+b}}Uh.Ma=new Pc.a;Uh.If=null;Uh.mh=null;Uh.qx=null;Uh.rLc=50;Uh.LGf=1225;Uh.aLj="PasteConstrainingWidth";Object(m.a)(Uh,"InternalClipboard",null,[]);class FI extends Pj{constructor(a,b,c,f,l,y){super(a,b,c,l);this.ls=f;this.gJd=y}get lsl(){return w.AFrameworkApplication.fa.ka("AutoResizeDragDropImageIsEnabled")}get sh(){return this.gJd.value}get shd(){return this.ls.shd()}get cfh(){const a=
this.ls;return a.w_d&&!a.L_c()}KYf(a,b){ka.ULS.shipAssertTag(6305616,307,gj.OutlineReader.ku(a));const c=yq.b(a.currentNode);if(gj.OutlineReader.isEmpty(a)){var f=cb.a.create(a.currentNode);a.eC(8);w.AFrameworkApplication.Ra.ei(f,C.a.pL,2,!0,null,null)}else a.eC(8);(f=a.zB(1))&&a.Cc();this.ls.Geh(this.ag.Nf,a.currentNode,f,-1,c,b)}get Vmg(){return this.ls.LQj()}get dNf(){return this.ls.ucj()}JYf(a){const b=new ob.GraphIterator;this.fjb.restore(b);ka.ULS.shipAssertTag(6305618,307,Wd.OutlineElementReader.ih(b));
this.ag.o1&&this.ag.o1.cKc("internal");let c=-1;if(this.vAh&&Object(Wa.a)(10,this.ag.zd))c=this.ag.zd.sa(dt.a.Y4b,-1);else if(this.lsl){const f=this.Kej(b.currentNode);c=f?f.clientWidth:c}this.ls.Geh(this.ag.Nf,b.parentNode,b.currentNode,c,null,a);this.Ipg&&(this.fjb.restore(b),Wd.OutlineElementReader.ih(b)&&this.ls.tsg(b)&&(a=Za.OutlineElementNavigator.yi(b)))&&(this.ag.Ata=Od.SelectionFactory.Qg(a,0))}Kej(a){return a?(a=a?a.qc(this.sh.Na):null)?a.htmlElement:null:null}jBh(){const a=new ob.GraphIterator;
this.fjb.restore(a);return this.ls.tsg(a)}get IAh(){return Zb.ListReader.Fx}get HAh(){return!this.ls.oka&&!this.ls.w_d}}Object(m.a)(FI,"InternalPasteExecutionManager",Pj,[]);class GI{constructor(a,b){this.ls=a;this.gJd=b}create(a,b,c){return new FI(a,b,c,this.ls,Rc.App.Lb.Kd,this.gJd)}}Object(m.a)(GI,"Factory",null,[1249]);var mz;(function(a){a[a.unknown=0]="unknown";a[a.differentBox4App=1]="differentBox4App";a[a.sameBox4AppDifferentSession=2]="sameBox4AppDifferentSession";a[a.sameBox4AppSameSession=
3]="sameBox4AppSameSession"})(mz||(mz={}));Object(m.b)("CopySource",mz);class js{constructor(a,b,c){this.ls=a;this.Sif=b;this.eYh=c}jNk(a,b,c){ka.ULS.shipAssertTag(6305620,307,!!a);ka.ULS.shipAssertTag(6305621,307,Mb.SelectionEditor.Xg(b));ka.ULS.shipAssertTag(6305622,307,!!c);ka.ULS.shipAssertTag(6305623,307,Object(Wa.a)(ep,c.e6));const f=c.e6;f.URa=this.ls.H5f(a);this.Lbk(a,f);const l=this.foe(a,b,f);if(l||this.V0e(a,b,f)){var y=new pf.GraphTransaction(7);y.ld(b.node);b.node.jH().graphTransactionOperations.tja(8);
l?(ka.ULS.sendTraceTag(40706500,307,50,"Internal paste operation starts. {0}; {1}",f.Ip,f.browserName),a=this.Sif.create(b,f,y)):(ka.ULS.sendTraceTag(40706501,307,50,"External paste operation starts. {0}; {1}; {2}",f.Ip,f.URa,f.browserName),js.Ebk(a),a=this.eYh.create(a,b,f,y));c=new Lh.a(c,Object(I.a)(a,a.Oeh,"pasteSetup"),null);c.$l("Paste");c.run()}else f.Ata=Od.SelectionFactory.Mu(b)}foe(a,b,c){return!this.Bqg(c)&&3===c.URa}V0e(){return!0}Bqg(a){return 1===(a.Ip&8192?1:0)}$kg(a,b){ka.ULS.shipAssertTag(6305624,
307,Mb.SelectionEditor.Xg(a));ka.ULS.shipAssertTag(6305625,307,!!b);ka.ULS.shipAssertTag(6305626,307,Object(Wa.a)(ep,b.e6));const c=new pf.GraphTransaction(7);c.ld(a.node);a=this.Sif.create(a,b.e6,c);b=new Lh.a(b,Object(I.a)(a,a.Oeh,"pasteSetup"),null);b.$l("InternalPasteAtIp");b.run()}Lbk(a,b){if(a){let c=!1,f=!1;a.innerHTML&&0<=a.innerHTML.indexOf("mso-tab-count")?f=!0:a.innerText&&0<=a.innerText.indexOf("\t")&&(c=!0);if(c||f)w.AFrameworkApplication.dM("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorInlineTabInsertionSettings"),
ka.ULS.sendTraceTag(42471960,307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",mz[b.URa],c,f)}}static Ebk(a){a&&js.I$h.test(a.innerText)&&ka.ULS.sendTraceTag(6350173,307,50,"External paste operation starts on WebUrl")}}js.I$h=RegExp("^[\\s]*(((http|https):\\/\\/)|(www\\.))[\\w\\-_]+(\\.[\\w\\-_]+)+[\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\s]*$");Object(m.a)(js,"PasteCoordinator",null,[]);class xC{constructor(a,b){this.lk=a;this.s7=b}}Object(m.a)(xC,"PasteFloatieFeatureSetBuilder",
null,[]);class po{constructor(a,b){this.vTb=a;this.CVh=b}get titleText(){return CommonUIStrings.l_ClipboardUseShortcutTitle}get m2f(){return CommonUIStrings.l_ClipboardUseShortcutMessage}get jPc(){return CommonUIStrings.l_ClipboardCut}get SHe(){return CommonUIStrings.l_ClipboardCut_Mac}get UNc(){return CommonUIStrings.l_ClipboardCopy}get RHe(){return CommonUIStrings.l_ClipboardCopy_Mac}get lKa(){return CommonUIStrings.l_ClipboardPaste}get THe(){return CommonUIStrings.l_ClipboardPaste_Mac}get j6(){return CommonUIStrings.l_ClipboardPasteText}get UHe(){return CommonUIStrings.l_ClipboardPasteText_Mac}get oZd(){return this.CVh}get TKf(){return CommonUIStrings.l_ClipboardExtensionLink}get GRa(){return CommonUIStrings.l_ClipboardExtensionSuggestion}nZf(){ka.ULS.sendTraceTag(8716421,
307,50,null);Bd.a.En(this.oZd,"_blank",void 0,"ClipboardAccessExtensionLink")}J1(a,b){let c=z.a.Ik;w.AFrameworkApplication.fa.ka("CcpFixIPadShortcutStringsIsEnabled")&&(c=z.a.Vi||c);return c?String.format(b,"\u2318"):a}dispose(){this.vTb=null}HTe(a){this.UNf(a)}C8j(a){this.UNf(a)}UNf(a){this.vTb&&this.vTb(a)}}po.id="CopyPasteShortcutDialog";po.gIh="CopyPasteText";Object(m.a)(po,"ACopyPasteShortcutDialog",null,[107]);class HI extends po{constructor(a,b,c){super(a,b);a=document.createElement("span");
a.className="WACCopyPasteShortcutDialogTextPanel";b=document.createElement("span");b.id=po.gIh;var f=document.createElement("span");f.innerText=this.m2f;var l=document.createElement("span");l.className="UIFontBold";l.innerText=this.J1(this.jPc,this.SHe);const y=document.createElement("span");y.className="UIFontBold";y.innerText=this.J1(this.UNc,this.RHe);const H=document.createElement("span");H.className="UIFontBold";H.innerText=this.J1(this.lKa,this.THe);b.appendChild(f);b.appendChild(document.createElement("br"));
b.appendChild(l);b.appendChild(y);b.appendChild(H);c.ka("PasteTextOnlyShortcutDialogIsEnabled")&&(z.a.ik||z.a.gg)&&(c=document.createElement("span"),c.className="UIFontBold",c.innerText=this.J1(this.j6,this.UHe),b.appendChild(c));a.appendChild(b);this.oZd?(ka.ULS.sendTraceTag(8716420,307,50,null),c=document.createElement("span"),b=document.createElement("a"),b.href="#",b.innerText=this.TKf,hd.a.addHandler(b,"click",Object(I.a)(this,this.nZf,"extensionLinkHandler")),c.appendChild(b),l=this.GRa.indexOf("{0}"),
-1!==l&&(f=this.GRa.substring(l+3,this.GRa.length),l=document.createTextNode(this.GRa.substring(0,l)),f=document.createTextNode(f),c.insertBefore(l,b),c.appendChild(f)),a.appendChild(document.createElement("br")),a.appendChild(c)):ka.ULS.sendTraceTag(8716422,307,50,null);c=new Ai.StandardDialog;c.Ad=0;c.kg=po.id;c.Tx(this.titleText,null,0,Object(I.a)(this,this.C8j,"legacyCopyPasteShortcutDialogHandler"),a);c.y6(po.gIh)}}Object(m.a)(HI,"CopyPasteShortcutDialog",po,[]);class II extends po{constructor(a,
b){super(a,b);b={};a=this.HQj;b.extensionStartText=this.n1i;b.extensionLink=null;b.extensionEndText=null;b.shortcutsMessageText=this.nrl;b.cutText=this.J1(this.jPc,this.SHe);b.copyText=this.J1(this.UNc,this.RHe);b.pasteText=this.J1(this.lKa,this.THe);4!==w.AFrameworkApplication.Aa.ob.zk&&(b.pasteTextOnly=this.J1(this.j6,this.UHe));b={["id"]:"CopyPasteInstallDialog",["bodyControls"]:b};const c=new bi.a(!1,!1,!0);c.kg="CopyPasteInstallDialog";c.Ad=0;c.Oe(1,this.GQj);c.dza(1);c.pj(a,Object(I.a)(this,
this.HTe,"reactCopyPasteShortcutDialogHandler"),b)}get nrl(){return CommonUIStrings.l_ClipboardInstallDialogShortcutsMessage}get GQj(){return CommonUIStrings.l_ClipboardInstallDialogInstallButton}get HQj(){return CommonUIStrings.l_ClipboardInstallDialogTitle}get n1i(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessage}}Object(m.a)(II,"ReactCopyPasteInstallDialog",po,[]);class JI extends po{constructor(a){super(a,null);this.Pug="https://prod.support.services.microsoft.com/en-us/office/troubleshoot-copy-and-paste-errors-in-powerpoint-for-the-web-0dc01da6-6988-40e5-96ea-0567c151ae2f?preview=true";
var b={};a=this.eyk;var c="";let f="";this.messageText&&(c=this.messageText.split(" {")[0],f=this.messageText.split("} ")[1]);b.startText=c;b.endText=f;b.cutText=this.RQi;b.copyText=this.IIi;b.pasteText=this.rNk;b.cutShortcutText=this.J1(this.SQi,this.jtk);b.copyShortcutText=this.J1(this.QIi,this.itk);b.pasteShortcutText=this.J1(this.xNk,this.ltk);b.imageSrc=$a.a.JN("NoClipboardAccessDialogImage.svg");b.imageAltText=this.xFa;b.primaryButtonLabel=this.CKb;this.Pug&&(ka.ULS.sendTraceTag(527986756,307,
50,"Learn more link is available"),b.learnMoreLink={["type"]:"AppLinkProps",["id"]:"learnMoreLink",["text"]:this.BWa,["onExecute"]:()=>{this.z8j()}});b={["id"]:"CopyPasteNoClipboardAccessDialog",["bodyControls"]:b};c=new bi.a(!1,!1,!0);c.Ad=0;c.kg="CopyPasteNoClipboardAccessDialog";c.pj(a,Object(I.a)(this,this.HTe,"reactCopyPasteShortcutDialogHandler"),b)}get eyk(){return CommonUIStrings.l_NoClipboardAccessDialogTitle}get messageText(){return CommonUIStrings.l_NoClipboardAccessDialogMessage}get BWa(){return CommonUIStrings.l_NoClipboardAccessDialogLearnMoreMessage}get xFa(){return CommonUIStrings.l_NoClipboardAccessDialogImageAltText}get CKb(){return CommonUIStrings.l_DialogOk}get RQi(){return CommonUIStrings.l_CutString}get SQi(){return CommonUIStrings.l_CutShortcut}get jtk(){return CommonUIStrings.l_CutShortcut_Mac}get IIi(){return CommonUIStrings.l_CopyString}get QIi(){return CommonUIStrings.l_CopyShortcut}get itk(){return CommonUIStrings.l_CopyShortcut_Mac}get rNk(){return CommonUIStrings.l_PasteString}get xNk(){return CommonUIStrings.l_PasteShortcut}get ltk(){return CommonUIStrings.l_PasteShortcut_Mac}z8j(){ka.ULS.sendTraceTag(527986757,
307,50,"Learn more link is clicked");Bd.a.En(this.Pug,"_blank",void 0,"learnMoreLink")}}Object(m.a)(JI,"ReactCopyPasteNoClipboardAccessDialog",po,[]);class KI extends po{constructor(a,b,c){super(a,b);a={};a.forwardElementText=this.m2f;a.cutText=this.J1(this.jPc,this.SHe);a.copyText=this.J1(this.UNc,this.RHe);a.pasteText=this.J1(this.lKa,this.THe);c.ka("PasteTextOnlyShortcutDialogIsEnabled")&&(z.a.ik||z.a.gg)&&(a.pasteTextOnly=this.J1(this.j6,this.UHe));this.oZd?(ka.ULS.sendTraceTag(40726914,307,50,
null),a.extensionLink={["type"]:"AppLinkProps",["id"]:"extensionLink",["text"]:this.TKf,["onExecute"]:f=>{this.nZf(f)}},c=this.GRa.indexOf("{0}"),-1!==c&&(a.suggestionPrefixElement=this.GRa.substring(0,c),a.suggestionSuffixElement=this.GRa.substring(c+3,this.GRa.length))):ka.ULS.sendTraceTag(40726915,307,50,null);c={["id"]:po.id,["bodyControls"]:a};a=new bi.a(!1,!1,!0);a.Ad=0;a.kg=po.id;a.pj(this.titleText,Object(I.a)(this,this.HTe,"reactCopyPasteShortcutDialogHandler"),c)}}Object(m.a)(KI,"ReactCopyPasteShortcutDialog",
po,[]);class Eq{constructor(){this.Qqa=!!w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.ob.hD}vvb(a,b,c=!1,f=!1){ka.ULS.sendTraceTag(594882645,307,50,String.format("_isReactDialogEnabled={0}, useInstallDialog={1}",this.Qqa,c));f?new JI(a):this.Qqa?c?new II(a,b):new KI(a,b,w.AFrameworkApplication.fa):new HI(a,b,w.AFrameworkApplication.fa)}static get instance(){return Eq.La||(Eq.La=new Eq)}}Eq.La=null;Object(m.a)(Eq,"CopyPasteShortcutDialogFactory",null,[1175]);class LI{constructor(a,b,c,f,
l,y,H){this.Ojf=this.fPd=!1;this.cZb=a;this.Pf=b;this.Via=c;this.Pd=f;this.jd=l;this.wf=y;this.ud=H}get gN(){return this.cZb}get aGa(){return this.Ojf}set aGa(a){this.Ojf=a;this.wf.uZc=a}Cda(a){this.gN.Cda(a);a||this.GMa(!0)}u8a(a){this.gN.u8a(a)}get m_i(){return this.gN.u6}get UZi(){return this.gN.ty}prepareForPaste(a){this.aGa=!0;this.gN.prepareForPaste(a,!1,this.m5e)}Oda(a,b){this.gN.Oda(a,!1,b)}reset(){this.aGa=!1}paste(){var a=this.Pf.Rd;a&&this.Pd.vf(a.VI);var b=this.Via.fL;if(!b.Sh||!b.editingView.hm)return null;
a=b.editingView;let c=this.jd.Bm();this.aGa=!0;b.pAa();b=null;try{a.FSk(),b=c=this.gN.S9a(this.m5e,c)}catch(f){ka.ULS.shipAssertTag(6305672,307,!1),this.o9b(!0)}this.aGa=!1;return b}copy(){var a=this.Pf.Rd;a&&this.Pd.vf(a.VI);a=this.Via.fL;if(!a.Sh||1!==a.editingView.mode)return!1;this.aGa=!0;let b;try{this.gN.PRc(this.m5e),b=!0}catch(c){ka.ULS.shipAssertTag(6305673,307,z.a.gg),ka.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",z.a.iz),b=!1}this.aGa=
!1;return b?!0:!1}GMa(a){if(this.fPd)return!0;var b=this.Via.fL;if(!b.Sh||!b.editingView.hm)return!1;const c=b.editingView;b=this.jd.Bm();this.aGa=!0;const f=new wd.a(b);let l=!1;try{l=this.gN.GMa(b,()=>{c.oBi()},()=>{c.xLa()})}catch(y){ka.ULS.shipAssertTag(6305674,307,!z.a.Wj)}f.restore();this.aGa=!1;l?this.fPd=!0:(ka.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",z.a.iz),z.a.Wj||this.o9b(a));return l}o9b(){this.fPd=!1;if(w.AFrameworkApplication.wacCopyPasteShortcutDialogIsEnabled)Eq.instance.vvb(null,
null);else{const a=new Ai.StandardDialog;a.Ad=0;a.sP(CommonUIStrings.l_ClipboardAccessDeniedTitle,CommonUIStrings.l_ClipboardAccessDenied,null)}}get m5e(){const a=this.jd.Wta();return a?a.Jl:null}}Object(m.a)(LI,"SystemClipboard",null,[1239]);class yC{constructor(a){this.Onb=2147483647;this.MSb=null;this.Pl=0;this.aJg=!0;this.Qnf=window.navigator.clipboard;this.Rnf=window.navigator.permissions;this.JS=a}getData(a,b){ka.ULS.sendTraceTag(538240020,307,50,"GetData: Started");try{if(this.MSb){var c=this.vcj(this.MSb,
a);c?this.MSb[0].getType(c).then(f=>{"image/png"===c?this.JS.Q2b([f],l=>{this.fMe(l,b,c)}):f.text().then(l=>{l="text/html"===c?this.c6i(l):l;ka.ULS.sendTraceTag(528859362,307,50,"GetData: Retrieved data with type: {0} and size: {1}",c,l.length);b(a,l)}).catch(()=>{this.tX(!1,"getDataFailed");b(a,null)})}).catch(()=>{this.tX(!1,"getDataFailed");b(a,null)}):(this.tX(!1,"unSupportedType"),b(a,null))}else this.tX(!1,"invalidClipboardItems"),b(a,null)}catch(f){this.tX(!1,"getDataFailed"),b(a,null)}}vcj(a,
b){let c=null;a&&0<a.length&&(a=a[0].types,b?c=Array.contains(a,b)?b:null:Array.contains(a,"text/html")?c="text/html":Array.contains(a,"image/png")?c="image/png":Array.contains(a,"text/plain")&&(c="text/plain"));return c}fMe(a,b,c){a&&this.JS.Mtc&&(a=String.format('<img src="{0}">',a));ka.ULS.sendTraceTag(528818690,307,50,"OnImageConverted: Retrieved data with type: {0} and size: {1}",c,a.length);b("image/png",a)}c6i(a){return this.trim(a,"\n")}trim(a,b){if(!a)return null;let c=0;for(;c<a.length&&
a.charAt(c)===b;)c++;let f=a.length-1;for(;f>c&&a.charAt(f)===b;)f--;return a.substr(c,f-c+1)}U7e(a,b,c){this.MSb=b;a(c)}txd(a){try{this.MSb=null,this.Qnf.read().then(b=>{let c;this.Pl&&(c=Date.now()-this.Pl,ka.ULS.sendTraceTag(526952409,307,50,"Time taken to read data: {0}",c));this.tX(!0,"none");this.U7e(a,b,!0)},()=>{this.tX(!1,"clipboardReadFailed");this.U7e(a,null,!1)}).catch(()=>{this.tX(!1,"clipboardReadFailed");this.U7e(a,null,!1)})}catch(b){this.tX(!1,"clipboardReadNotSupported"),a(!1)}}DJf(a,
b){this.aJg=a?!0:!1;if(this.Qnf)if(this.Rnf)try{this.Rnf.query({name:"clipboard-read"}).then(c=>{c?(c=c.state,"granted"===c?(this.Pl=Date.now(),this.txd(b)):"prompt"===c&&a?this.txd(b):(this.tX(!1,"permissionDenied"),b(!1))):(this.tX(!1,"invalidPermissionStatus"),b(!1))},()=>{this.tX(!1,"permissionQueryFailed");a?this.txd(b):b(!1)}).catch(()=>{this.tX(!1,"permissionQueryFailed");b(!1)})}catch(c){this.tX(!1,"permissionQueryNotSupported"),b(!1)}else this.tX(!1,"navigatorPermissionNotSupported"),a&&
this.txd(b);else this.tX(!1,"navigatorClipboardNotSupported"),b(!1)}tX(a,b){const c={};c.AsyncAPISuccess=a.toString();c.IsPasteEvent=this.aJg;"none"!==b&&(c.AsyncAPIFailureReason=b);ka.ULS.sendTraceTag(522814493,307,50,JSON.stringify(c))}}Object(m.a)(yC,"AsyncClipboardAPI",null,[]);class nz{constructor(){this.pptObjectData=this.pptObjectMetaData=this.pptSlide=this.text=this.html=this.img=null;this.isImageAvailable=!1}}Object(m.a)(nz,"ExtensionClipboardData",null,[]);class MI{constructor(a,b,c,f){this.R2=
this.Zz=this.Olf=this.rqa=null;this.bzc=a.ka("ChromeClipboardAccessExtensionSuggestionIsEnabled");a.ka("ChromeClipboardAccessRichFormatContentIsEnabled");a.ka("ChromeSingleTextRunCopyImprovementIsEnabled");this.qZh=a.Ha("ChromeClipboardAccessExtensionLink");this.pOa=b;this.lk=c;this.n3h=a.Ha("ChromeClipboardAccessExtensionId");this.JS=f;this.t2=new yC(this.JS);this.bUb=null;this.FAc=a.ka("EnhancedTextCCPEnabled");this.djf=l=>!!l.tagName&&"a"===l.tagName.toLowerCase()}Cda(a){a?this.Zz=!0:(this.R2=
this.Zz=null,chrome.runtime&&chrome.runtime.sendMessage?(this.bUb=this.pOa.mVc(),this.pOa.lza?this.sJf(!0,null):(this.Zz=!0,ka.ULS.sendTraceTag(19256732,307,50,ha.a.create().toString()))):this.t2?this.Lub(!0,null):(this.vPe(),this.Zz=!1))}u8a(a){this.R2=this.Zz=null;chrome.runtime&&chrome.runtime.sendMessage?(this.bUb=this.pOa.mVc(),this.pOa.lza?this.sJf(!1,a):(this.Zz=!0,ka.ULS.sendTraceTag(19256732,307,50,ha.a.create().toString()),a(this.u6))):this.t2?this.Lub(!1,a):(this.Zz=!1,a(this.u6))}get u6(){return this.Zz}get ty(){return this.R2}GMa(){return!0}PRc(a){ka.ULS.sendTraceTag(24402115,
307,50,"Execute chrome copy");Bd.a.R9a(a,"copy")||ka.ULS.sendTraceTag(24402116,307,10,String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,2)))}S9a(a,b){this.rqa&&(a=document.implementation.createHTMLDocument("doc"),a.body.innerHTML=this.rqa,b=a.body,this.rqa=null);return b}Pej(a){var b=this.lk.uag(a.html);if(null!=b&&""!=b)return b;b=a.img;if(null!=b&&""!=b)return b;a=a.text;if(null!=a&&""!=a)return a}Z5f(a,b){const c=ha.a.create();this.Olf=c;this.pOa.lza?
ka.ULS.sendTraceTag(7377737,307,50,c.toString()):ka.ULS.sendTraceTag(19256735,307,50,c.toString());const f={};f.command=b;chrome.runtime&&chrome.runtime.sendMessage?chrome.runtime.sendMessage(this.bUb,f,l=>{c.equals(this.Olf)?this.rqa=this.FAc?this.Pej(l):l:ka.ULS.sendTraceTag(7385868,307,50,null);ka.ULS.sendTraceTag(7377738,307,50,c.toString());chrome.runtime.lastError&&(this.ZWi(),this.pOa.lza?ka.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):ka.ULS.sendTraceTag(19256737,307,
10,chrome.runtime.lastError.message));a(l)}):(ka.ULS.sendTraceTag(509666774,307,10,"ChromeApi.RuntimeSendMessage not supported"),a(null))}prepareForPaste(a,b){const c=()=>{a(!1)},f=(l,y)=>{this.rqa=y;a(!0)};null!=this.ty&&this.ty?this.t2.getData(b?"image/png":null,f):this.Z5f(c,this.FAc?"getClipboardData":"paste")}Oda(a,b,c){a=(f,l)=>{const y=new nz;"image/png"==f?y.img=l:y.html=l;c(y)};null!=this.ty&&this.ty?this.t2.getData(b?"image/png":null,a):this.Z5f(c,"getClipboardData")}vPe(){ka.ULS.sendTraceTag(8716423,
307,50,null);Eq.instance.vvb(Object(I.a)(this,this.kQk,"popupInstallDialogHandler"),this.bzc?this.qZh+this.bUb:null)}kQk(a){1===a?ka.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",this.bzc)):0===a&&ka.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",this.bzc))}hQk(){ka.ULS.sendTraceTag(509666773,307,50,null);Eq.instance.vvb(Object(I.a)(this,this.iQk,"popupClipboardAccessDialogHandler"),null,!1,!0)}iQk(){ka.ULS.sendTraceTag(509666772,307,50,String.format("ClipboardAccessDialog OK Clicked",
this.bzc))}ZWi(){this.pOa.IWe();this.vPe()}xvh(a,b){const c={command:"test",object:"ping"};chrome.runtime&&chrome.runtime.sendMessage?chrome.runtime.sendMessage(a,c,b):(ka.ULS.sendTraceTag(509666771,307,10,"ChromeApi.RuntimeSendMessage not supported"),b(null))}Lub(a,b){ka.ULS.sendTraceTag(509666770,307,50,"CheckAsyncClipboardApiSupport");this.t2.DJf(a,c=>{this.R2=c;this.Zz=this.ty;a&&this.xvl();b&&b(this.u6)})}xvl(){null==this.ty||this.ty||this.hQk()}sJf(a,b){const c=ha.a.create();ka.ULS.sendTraceTag(7726105,
307,50,c.toString());this.xvh(this.bUb,f=>{ka.ULS.sendTraceTag(7726106,307,50,c.toString());f&&"ping"===f?this.Zz=!0:(f?"ping"!==f&&ka.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",f,chrome.runtime.lastError?chrome.runtime.lastError.message:null):ka.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.t2?this.Lub(a,b):(a&&this.vPe(),this.Zz=!1));b&&b(this.u6)})}lwg(a,
b){const c={};c.OfficeOnlineExtensionInstallationStatus=a;c.OfficeClipboardExtensionInstallationStatus=b;ka.ULS.sendTraceTag(51144839,307,50,JSON.stringify(c))}$ak(){if(chrome.runtime&&chrome.runtime.sendMessage){var a=!this.pOa.lza;this.xvh(this.n3h,b=>{this.lwg(a,!!b)})}else this.lwg(!1,!1)}}Object(m.a)(MI,"ChromeSystemClipboardAccessManager",null,[1238]);class NI{constructor(a,b,c,f){this.R2=this.Zz=this.jHc=this.rqa=this.t2=null;this.ud=a;this.Oa=b;this.Tbf=!this.Oa.ka("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&
this.Oa.ka("BlockCopyCutOnFirefoxIsEnabled");this.JS=c;this.lk=f;this.LJd=b.wc("ClipboardDataImageBlobLimitaton",10);z.a.z4e||(this.t2=new yC(this.JS))}Cda(a){this.Tbf&&a&&this.ud.gg?(Eq.instance.vvb(null,null),this.Zz=!1):(this.Zz=!0,this.R2=!1,this.t2&&(this.R2=this.Zz=null,this.Lub(!0,null)))}u8a(a){this.Tbf&&this.ud.gg&&(this.Zz=!1,a(this.u6));this.Zz=!0;this.R2=!1;this.t2?(this.R2=this.Zz=null,this.Lub(!1,a)):a(this.u6)}Lub(a,b){ka.ULS.sendTraceTag(512356674,307,50,"CheckAsyncClipboardApiSupport");
this.t2.DJf(a,c=>{this.R2=c;this.Zz=this.ty;a&&this.Rul();b&&b(this.u6)})}Rul(){null==this.ty||this.ty||this.gQk()}gQk(){Eq.instance.vvb(null,null)}get u6(){return this.Zz}get ty(){return this.R2}PRc(a){Bd.a.R9a(a,"copy")}S9a(a,b){if(this.rqa&&null!=this.ty&&this.ty)return a=document.implementation.createHTMLDocument("doc"),a.body.innerHTML=this.rqa,b=a.body,this.rqa=null,b;const c=Date.now(),f=Bd.a.R9a(a,"paste");b&&""===b.innerHTML&&(this.rcj(a),b.innerHTML=this.jHc?this.jHc:"",this.jHc="");ka.ULS.sendTraceTag(512356673,
307,50,"ExecutePasteCommand: time taken: {0}, result: {1}",Date.now()-c,f);return b}rcj(a){const b=c=>{if(c){c=c.clipboardData;const f=this.lk.B7b(c);this.jHc=f&&""!==f?f:this.lk.Vbe(c)}};window.addEventListener("paste",b,!1);Bd.a.R9a(a,"paste");window.removeEventListener("paste",b,!1)}prepareForPaste(a,b){const c=(f,l)=>{this.rqa=l;a(!0)};null!=this.ty&&this.ty?this.t2.getData(b?"image/png":null,c):a(!1)}Oda(a,b,c){if(c){var f=(l,y)=>{const H=new nz;"image/png"==l?H.img=y:H.html=y;c(H)};null!=this.ty&&
this.ty?this.t2.getData(null,f):z.a.z4e&&this.scj(a,b,c)}else ka.ULS.sendTraceTag(512356672,307,10,"GetClipboardData: null callback")}scj(a,b,c){ka.ULS.sendTraceTag(512356643,307,50,"GetClipboardDataViaExecCommand: called");a=a.contentWindow.document;Ea.a.vv(a.body);try{const f=l=>{const y=new nz;l=l.clipboardData;if(b){var H=null;({v$b:H}=this.lk.mxd(l,this.LJd,this.JS.ilc));H&&0<H.length&&(y.isImageAvailable=!0)}else H=this.lk.getData(l,"ppt/slides"),y.pptSlide=H,H&&""!==H||(l=(H=this.lk.B7b(l))&&
""!==H?H:this.lk.Vbe(l),y.html=l);c(y)};a.addEventListener("paste",f,!1);Bd.a.R9a(a,"paste");a.removeEventListener("paste",f,!1)}catch(f){ka.ULS.sendTraceTag(512356642,307,10,"GetClipboardDataViaExecCommand: failed to extract the data using exec command with exception : {0}",f)}}GMa(a,b,c){if(this.ud.$T&&!this.Oa.ka("ElectronClipboardAccessFix"))return this.Zz=!1;b();c();a=this.S9a(a.ownerDocument,a);b=a.innerHTML;a.innerHTML=Hg.a.create().toString();c();a=this.S9a(a.ownerDocument,a);a=b===a.innerHTML;
this.t2?a&&(this.Zz=!0):this.Zz=a;return a}}Object(m.a)(NI,"DefaultSystemClipboardAccessManager",null,[1238]);class OI{constructor(a,b,c,f){this.R2=this.Zz=this.SV=this.Qqb=this.Q7=this.xBa=this.ezc=null;this.lk=b;this.JS=c;this.LJd=a.wc("ClipboardDataImageBlobLimitaton",10);this.S_h=a.ka("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled");this.zXh=f;this.n7h=a.ka("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}Cda(a){this.n7h&&a&&(this.Zz=!0);this.R2=!1}u8a(a){a(!0)}get u6(){return this.Zz}get ty(){return this.R2}PRc(a){a&&
Bd.a.R9a(a,oa.a.copy)}S9a(a,b){this.xBa&&(b=this.xBa,this.xBa=null);return b}Oda(a,b,c){c?c(null):ka.ULS.sendTraceTag(540553600,307,10,"GetClipboardData null callback")}prepareForPaste(a,b,c=null){if(a&&c){this.ezc=a;this.Qqb=c;$addHandler(this.Qqb,oa.a.paste,Object(I.a)(this,this.aah,"onPasteEvent"));this.SV=this.Q7=null;this.S_h&&this.zXh.A5b();if(this.uxd(this.Qqb)){if(this.SV&&0<this.SV.length&&(!this.Q7||this.lk.Qyd(this.Q7))){this.JS.Q2b(this.SV,Object(I.a)(this,this.fMe,"onImageConverted"));
this.xBa&&!this.xBa.hasChildNodes()&&ka.ULS.sendTraceTag(42592151,307,50,"pastedContentDom has no child nodes.");return}this.Q7&&this.Q7.innerHTML&&((this.xBa=this.iig(this.Q7.innerHTML))&&!this.xBa.hasChildNodes()&&ka.ULS.sendTraceTag(42592152,307,50,"pastedContentDom has no child nodes."),Ea.a.vv(this.Q7))}this.G0f()}else a&&a(!1)}GMa(a){return this.Zz=a=this.uxd(a.ownerDocument)}aah(a){try{a&&a.rawEvent&&((this.Q7=a.rawEvent.target)&&this.Q7.id&&-1<this.Q7.id.indexOf("Paste")?(ka.ULS.sendTraceTag(40690080,
307,15,"The pasted target element of paste event: "+this.Q7.id),this.Q7=null):this.SV=this.Gij(a.rawEvent))}catch(b){ka.ULS.sendTraceTag(22073952,307,15,"Exception while processing context menu paste event: "+b.toString())}}fMe(a){a&&(this.JS.Mtc&&(a=String.format('<img src="{0}">',a)),this.xBa=this.iig(a));this.G0f()}G0f(){this.Qqb&&($removeHandler(this.Qqb,oa.a.paste,Object(I.a)(this,this.aah,"onPasteEvent")),this.Qqb=null);this.ezc&&(this.ezc(!1),this.ezc=null)}Gij(a){let b=null;(a=this.lk.R9d(a))&&
({v$b:b}=this.lk.mxd(a,this.LJd,this.JS.ilc));return b}uxd(a){return Bd.a.R9a(a,oa.a.paste)}iig(a){const b=document.implementation.createHTMLDocument("doc");b.body.innerHTML=a;return b.body}}Object(m.a)(OI,"EdgeSystemClipboardAccessManager",null,[1238]);class PI{constructor(a,b,c,f){this.Oa=a;this.zVh=b;this.lk=c;this.ud=f}create(){var a=null;a=this.ud.$T&&this.Oa.ka("ElectronClipboardAccessFix"),w.AFrameworkApplication.Ttd()&&this.ud.ik&&window.chrome&&!a?(ka.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),
a=new MI(this.Oa,this.zVh,this.lk,Ib.a.instance.resolve("Box4.IProcessImageStrategy")),this.Oa.ka("LogChromeExtensionInstallationStatusIsEnabled")&&a.$ak()):this.Oa.ka("EdgeContextMenuPasteFixIsEnabled")&&this.ud.Ho?(ka.ULS.sendTraceTag(22073953,307,50,"EdgeSystemClipboardAccessManager"),a=new OI(this.Oa,Ib.a.instance.resolve("Box4.IClipboardDataHelper"),Ib.a.instance.resolve("Box4.IProcessImageStrategy"),Ib.a.instance.resolve("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy"))):(ka.ULS.sendTraceTag(7377744,
307,50,"DefaultSystemClipboardAccessManager"),a=new NI(this.ud,this.Oa,Ib.a.instance.resolve("Box4.IProcessImageStrategy"),this.lk));return a}}Object(m.a)(PI,"SystemClipboardAccessManagerFactory",null,[1237]);class QI{wYf(a){return a}}Object(m.a)(QI,"DeleteTableSegmentStrategy",null,[357]);var RQ=d(1255),SQ=d(646);class Fq{constructor(a,b){this.jl=new J.DictionaryPropertySet;this.oHd=!1;this.Ria=this.Cia=this.V3a=null;this.QV=a;this.JYh=b}get v2a(){return this.Ria||(this.Ria=Ib.a.instance.qb("Box4.ITextFormattingCommands"))}get oh(){return Fq.If||
(Fq.If=Ib.a.instance.resolve("Box4.IFormattingEditor"))}K0a(){this.oHd||(this.jl.SUe(),this.V3a=null,this.l6k())}PIi(a){a=tb.a.Bs(a);if(!a.cache.xt){var b=a.dA;if(b){var c=new J.DictionaryPropertySet;c.ny(b);c.ny(this.jl);c.Ua($c.a.q3)&&(this.V3a=a.paragraph.Lh);this.jl=c}}}Ua(a){return this.jl.Ua(a)}Yfe(){return 0<this.jl.w2}get Obb(){return this.jl}freeze(){this.oHd=!0}d6e(){this.oHd=!1}bJ(a,b){return this.Obb.sa(a,b)}Xq(a){this.jl.setValue(ab.a.fontSize,this.oh.E2b(a));this.fS()}fontSize(){return this.jl.sa(ab.a.fontSize,
sd.Font.MI)}msd(a){this.jl.setValue(ab.a.font,a);this.JYh.msd(this.jl,a);this.QV&&this.QV.enabled&&(We.c(40506690,306,50,"InsertionPointFomatting: Set font slot values"),this.QV.IYl(this.jl,a));this.fS()}XLa(a){this.jl.setValue(Ab.a.wV,a);this.QV&&this.QV.enabled&&(We.c(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this.QV.MYl(this.jl,a));this.fS()}sr(a){a=SQ.a.instance.GZd(ge.a.instance.Pa.mb.Va.node,a);this.jl.setValue(ab.a.fontColor,a);this.fS()}zW(){this.jl.setValue(ab.a.fontColor,
rc.a.auto);this.fS()}fontColor(){return this.jl.sa(ab.a.fontColor,rc.a.nil)}ppa(a){this.jl.setValue(ab.a.highlight,parseInt(a,16));this.fS()}R1b(){this.jl.setValue(ab.a.highlight,rc.a.auto);this.fS()}isBold(){return this.jl.sa(ab.a.bold,!1)}$H(a){this.jl.setValue(ab.a.bold,a);this.fS()}isItalic(){return this.jl.sa(ab.a.italic,!1)}setItalic(a){this.jl.setValue(ab.a.italic,a);this.fS()}xE(){return this.jl.sa(ab.a.underline,!1)}VY(a){this.jl.setValue(ab.a.underline,a);this.jl.setValue(ab.a.gw,a?sd.Font.Oxd:
sd.Font.BV);this.fS()}gw(){return this.jl.sa(ab.a.gw,sd.Font.BV)}vpa(a){a<sd.Font.Oxd||a>sd.Font.BV||(this.jl.setValue(ab.a.underline,a!==sd.Font.BV),this.jl.setValue(ab.a.gw,a),this.fS())}isSuperscript(){return this.jl.sa(ab.a.superscript,!1)}UY(a){this.jl.setValue(ab.a.superscript,a);a&&this.isSuperscript()&&this.jl.setValue(ab.a.subscript,!1);this.fS()}cG(){return this.jl.sa(ab.a.subscript,!1)}A6(a){this.jl.setValue(ab.a.subscript,a);a&&this.cG()&&this.jl.setValue(ab.a.superscript,!1);this.fS()}bG(){return this.jl.sa(ab.a.strikethrough,
!1)}TY(a){this.jl.setValue(ab.a.strikethrough,a);this.fS()}U_(){return this.jl.sa($c.a.nt,!1)}flb(a){this.jl.setValue($c.a.nt,a);this.fS()}U4f(){return this.jl.sa($c.a.q3,null)}Jga(a,b){this.jl.SUe();this.jl.setValue($c.a.q3,a.id);this.V3a=b.Lh;this.fS()}lV(a){let b=ab.a.yt;if(N.a.instance.ga(13)){const c=RQ.a.cdc(a);switch(c){case 1:b=Ab.a.hCb;break;case 2:b=Ab.a.iCb}this.jl.setValue(Ab.a.languageHint,c)}this.jl.setValue(b,a);this.fS()}language(){let a=ab.a.yt;if(N.a.instance.ga(13))switch(this.jl.sa(Ab.a.languageHint,
0)){case 1:a=Ab.a.hCb;break;case 2:a=Ab.a.iCb}return this.jl.sa(a,0)}sml(a){this.jl.setValue(Fq.QJe,a);this.fS()}XVa(){return this.jl.sa(Fq.QJe,!1)}i_j(){return this.jl.Ua(Fq.QJe)}XYj(){return N.a.instance.ga(13)?this.jl.Ua(ab.a.yt)||this.jl.Ua(Ab.a.hCb)||this.jl.Ua(Ab.a.iCb):this.jl.Ua(ab.a.yt)}fS(){if(z.a.zPb){var a=ge.a.instance.Pa.mb.Va,b=a.node;if(b===this.Cia)this.Cia.Kv(16,!0);else{this.Cia=b;b=this.Cia.m2a();try{this.Cia.Ewb(a.Sa).B4=!0}finally{b&&b.dispose()}}}}l6k(){if(z.a.zPb&&this.Cia){var a=
0,b=this.Cia.m2a();try{for(let c=this.Cia.Ta.length-1;0<=c;c--){const f=this.Cia.Ta.ga(c);f.B4&&(f.B4=!1,a++,f.isEmpty&&this.Cia.Ta.removeAt(c))}}finally{b&&b.dispose()}this.Cia=null}}zHi(a){if(a.Sa!==a.Mb)return!1;a=a.node.Ta.HT(a.Sa);return!!a&&a.B4}Uli(a){if(this.v2a){this.freeze();var b=new pf.GraphTransaction(7);b.ld(a.node);this.v2a.DNb(a);this.d6e();this.K0a();b.dispose()}}l8b(a){const b=Db.ParagraphReader.text(a.node);return a.Sa&&a.Sa!==b.length&&!ma.a.uz(b.charCodeAt(a.Sa))&&Wq.a.instance.zVc(b,
a.Sa-1)!==a.Sa&&Mb.SelectionEditor.IBb(a)?(a=Mb.SelectionEditor.ZSa(a,!1))?1<a.length||Mb.SelectionEditor.tk(a.Va)?a:null:null:null}static get QJe(){return N.a.instance.ga(20)?Ab.a.noProof:ee.a.Bxa}}Fq.If=null;Object(m.a)(Fq,"InsertionPointFormatting",null,[345]);class RI{constructor(a){this.Ca=a}get qn(){return this.Ca}nti(a){return 32===this.qn.Ka(C.a.iN,2,a)}numbering(a){return 32===this.qn.Ka(C.a.zP,2,a)}}Object(m.a)(RI,"ListCommands",null,[1250]);class zC{constructor(a){this.rf=a}t8a(a){a=Object(qa.a)(oC.a,
a);return!!a&&!!a.view&&a.view.Sh}jih(){return!0}ZQe(){return!0}kih(){}oEh(a){if(a.mr)return!0;a=a.role;return 1===a||2===a||3===a||4===a||5===a}Doj(a){if(!a||!this.rf)return a;const b=new Cn.a;b.set(a);if(this.rf.Mt(b)){for(;!b.mr;)b.Cc();return b.currentNode}return a}}Object(m.a)(zC,"SimpleProofingWholeDocumentCallBacks",null,[1326]);class SI{constructor(a){this.value=a}}Object(m.a)(SI,"RefBool",null,[]);class oz{constructor(){this.HRc=this.uIb=null;this.ZLh=new SI(!1)}}Object(m.a)(oz,"FindNextErrorOperationParam",
null,[]);class TI extends zC{constructor(a,b){super(b);this.Rm=a}jih(a,b){return!this.dse(a.node,a.Sa,b)}ZQe(a,b){return!this.dse(a,0,b)}kih(a,b){this.dse(a.node,0,b);Object(qa.a)(oz,b)}dse(a,b,c){c=Object(qa.a)(oz,c);if(Db.ParagraphReader.ae(a)&&!a.cX)if(tb.a.Bs(cb.a.Lj(a,b)).cache.XVa)c.ZLh.value=!0;else{const f=w.AFrameworkApplication.fa.ka("SkipIgnoredProofingErrorsFromRibbon"),l=this.Rm.TF(a);for(let y=0;y<l.length;y++){const H=l[y],Q=f&&H.Eh.Yne();if(H.begin>=b&&!Q)return c.uIb=H,c.HRc=a,!0}}return!1}}
Object(m.a)(TI,"FindNextErrorCallbackSteps",zC,[]);class UI extends ct.a{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua){super();this.Xqb=this.Ri=this.PAa=null;this.init(a);this.$l(Ua);this.zFa(Q,b,f,l,y);this.DG=y;this.Ot=c;this.Uc=ia;this.rf=wa;this.gra=H;this.yI=0}run(){this.t8a();0===this.yI&&this.r0e();1===this.yI&&this.iRe();2===this.yI&&this.r5e();3===this.yI&&this.J7d()}t8a(){this.Uc.Pa&&this.Uc.Pa.mb?1===this.behavior&&(this.gra.t8a(this.Ot)?this.gp=32:this.gp=2,this.yI=3):(ka.ULS.sendTraceTag(20321351,
324,15,"No selection for ignore all"),this.gp=2,this.yI=3)}r0e(){this.Bsi();this.Xri();this.yI=1}iRe(){this.ux||new Lh.a(this,Object(I.a)(this,this.ZTk,"processCurrentNodeAtBegin"),this.DG);do if(this.ux.run(),this.ux.inProgress&&!this.Wi)return;while(this.ux.inProgress);this.vMc();this.yI=2}r5e(){this.gp=32;this.yI=3}J7d(){this.RY()}ZTk(a,b){b=this.gra.jih(this.PAa,b);a.hh(Object(I.a)(this,this.A8i,"fromHereToEnd"));return b}A8i(a,b){if(this.Ri.moveNext())return a=this.Ri.currentNode,12!==a.type||
a===this.PAa.node?!0:this.gra.ZQe(a,b);this.Tsi();a.hh(Object(I.a)(this,this.K8i,"fromStartToHere"));return!0}K8i(a,b){if(this.Ri.moveNext()){const c=this.Ri.currentNode;return 12!==c.type?!0:c===this.PAa.node?(a.hh(Object(I.a)(this,this.$Tk,"processCurrentNodeAtEnd")),!0):this.gra.ZQe(c,b)}return!1}$Tk(a,b){this.gra.kih(this.PAa,b);return!1}Bsi(){let a=this.Uc.Pa.mb;if(a=this.rf.fm(a,!0,!1))this.PAa=a.Va;this.PAa&&this.PAa.node&&(this.Xqb=this.gra.Doj(this.PAa.node))}Xri(){if(!this.Xqb)throw Error.argumentNull("_proofingWholeDocumentRootNode");
const a=new Cn.a;a.set(this.PAa.node);a.sc(this.Xqb.type);this.Ri=zx.a.B3(a,this.Xqb);this.Ri.qm(Object(I.a)(this.gra,this.gra.oEh,"spellErrorFilter"),null)}Tsi(){if(!this.Xqb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const a=new Cn.a;a.set(this.Xqb);this.Ri=zx.a.xv(a);this.Ri.qm(Object(I.a)(this.gra,this.gra.oEh,"spellErrorFilter"),null)}}Object(m.a)(UI,"ProofingWholeDocumentOperation",ct.a,[]);class AC{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc){this.Ca=b;this.Rm=a;this.r1h=
c;this.mh=f;this.Lk=l;this.Uc=y;this.Sm=H;this.rf=Q;this.l6a=ia;this.ZD=wa;this.qd=Ua;this.ECc=Gb.gpe;this.vqf=ec;this.GP=dc;this.dyc=new Pb.a;this.dyc.$(1,C.a.pEh);this.dyc.$(2,C.a.Ydg);this.dyc.$(3,C.a.EFh);this.zFc=new Pb.a;this.zFc.$(1,C.a.qEh);this.zFc.$(2,C.a.Zdg);this.zFc.$(3,C.a.FFh)}vb(){const a=this.Ca,b=Object(I.a)(this,this.ZIi,"correctError"),c=Object(I.a)(this,this.OCi,"collapseIp");a.ra(C.a.NJk,yb.a.view,Object(I.a)(this,this.OJk,"openLanguageDialogView"),1028);a.ya(C.a.NDa,yb.a.Mf,
Object(I.a)(this,this.NDa,"deleteRepeatedWord"));a.ya(C.a.kla,yb.a.Mf,Object(I.a)(this,this.kla,"ignoreSpellingError"));a.ya(C.a.Pza,yb.a.Mf,b);a.ya(C.a.Qza,yb.a.Mf,b);a.ya(C.a.Rza,yb.a.Mf,b);a.ya(C.a.BMa,yb.a.Mf,b);a.ya(C.a.CMa,yb.a.Mf,b);a.ya(C.a.NDa,yb.a.view,c);a.ya(C.a.kla,yb.a.view,c);a.ya(C.a.Pza,yb.a.view,c);a.ya(C.a.Qza,yb.a.view,c);a.ya(C.a.Rza,yb.a.view,c);a.ya(C.a.BMa,yb.a.view,c);a.ya(C.a.CMa,yb.a.view,c);a.he(C.a.NDa,1028);a.he(C.a.kla,1028);a.he(C.a.Pza,1028);a.he(C.a.Qza,1028);a.he(C.a.Rza,
1028);a.he(C.a.BMa,1028);a.he(C.a.CMa,1028);a.ya(C.a.Svd,ie.a.frame,vf.ActionManager.Sg);this.ECc&&a.ra(C.a.sPe,yb.a.view,Object(I.a)(this,this.sPe,"populateProofingSecondaryMenu"),1124);w.AFrameworkApplication.fa.ka("WordEditorIdeasIsEnabled")&&w.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")||a.ra(C.a.jhd,yb.a.view,Object(I.a)(this,this.U4i,"findNextProofingError"),1028);this.Q3k([C.a.Ozl,C.a.pEh,C.a.qEh,C.a.syj,C.a.Ydg,C.a.Zdg,C.a.YBl,C.a.EFh,C.a.FFh])}Q3k(a){for(let b=0;b<a.length;b++)this.Ca.ra(a[b],
yb.a.view,vf.ActionManager.Bv,1028)}OCi(a,b,c,f,l){b=this.Uc.Pa.mb;if(!b)return this.qd.Xb(Kd.a.zh,{["Reason"]:Qd.a.noSelection}),2;b=this.rf.fm(b,!0,!1);return this.Ca.ei(b.Va,a,c,!1,f,l)}OJk(a,b,c){if(1===c)return this.Ca.processAction(C.a.lV,1);this.r1h().euc();return 32}O7e(a){return a?a.Eh?!1:(ka.ULS.sendTraceTag(7660829,324,10,"Ignore Spelling Error: No suggestions on flagged word"),this.qd.Xb(Kd.a.e$a,{["Reason"]:"ErrorRangeMissingErrorDetails"}),pb.a.mark(4671),!0):(ka.ULS.sendTraceTag(7660828,
324,10,"Ignore Spelling Error: No flagged word"),this.qd.Xb(Kd.a.e$a,{["Reason"]:"RequestedErrorRangeNotFound"}),pb.a.mark(4671),!0)}NDa(a,b,c){if(1===c)return 32;pb.a.mark(4670);c=this.Rm.UTa(b);if(this.O7e(c))return 8;b=b.node;const f=this.Lk.je(15);let l=c.begin;" "===Db.ParagraphReader.text(b).charAt(l-1)&&l--;f.ld(b);const y=this.mh.replaceTextRange(cb.a.createTextRange(b,0<c.begin?c.begin-1:0,c.end),"",!0,!1);this.Uc.setSelection(Od.SelectionFactory.Qg(b,y+l));f.dispose();c.Eh.UMa(a);pb.a.mark(4671);
return 32}Dck(a){let b;({value:b}=this.zFc.wg(a.Eh.proofingType,0)).returnValue&&this.Ca.processAction(b,2)}kla(a,b,c){if(1===c)return 32;ka.ULS.sendTraceTag(7660830,324,50,"Ignore spelling error triggerred");pb.a.mark(4670);c=this.Rm.UTa(b);if(this.O7e(c))return 8;b=b.node;const f=this.Lk.je(15);f.ld(b);this.Rm.fLa(b,[c],!0);b.setValue(ab.a.UMf,!0);f.dispose();c.Eh.UMa(a,1);pb.a.mark(4671);ka.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded");this.Dck(c);return 32}Ydj(a){switch(a){case C.a.Pza:return 0;
case C.a.Qza:return 1;case C.a.Rza:return 2;case C.a.BMa:return 3;case C.a.CMa:return 4;default:return-1}}V$j(a){let b;({value:b}=this.dyc.wg(a.Eh.proofingType,0)).returnValue&&this.Ca.processAction(b,2)}ZIi(a,b,c){var f=!0;this.GP.ga(14)&&(f=!this.ZD.Xua(b));this.Sm&&this.Sm.instance&&this.Sm.instance.fX(b)&&(f=!1);if(1===c||!f)return f?32:8;this.Ca.processAction(C.a.Svd,2);pb.a.mark(4670);f=this.Ydj(a);if(0>f)return 8;c=this.Rm.UTa(b);if(this.O7e(c))return 8;b=b.node;var l=c.Eh.suggestions;if(!l)return this.qd.Xb(Kd.a.e$a,
{["Reason"]:"NoSuggestionsFound"}),pb.a.mark(4671),8;f=f<l.length?l[f]:null;if(!f)return this.qd.Xb(Kd.a.e$a,{["Reason"]:"RequestedSuggestionIsNull"}),pb.a.mark(4671),8;this.GP.ga(50)&&Rc.App.Mh.Bw&&Rc.App.Mh.hZ.Qra(b);f=f.replace("  "," \u00a0");l=this.Lk.je(15);l.ld(b);const y=this.mh.replaceTextRange(cb.a.createTextRange(b,c.begin,c.end),f,!0,!1,C.a.Svd);this.Uc.setSelection(Od.SelectionFactory.Qg(b,c.begin+f.length+y));l.dispose();c.Eh.UMa(a);pb.a.mark(4671);this.V$j(c);return 32}Tfl(a,b,c,f){a.Tya();
(a=c.qc(a.Na))?(f=T.a.$t(a,w.AFrameworkApplication.isRtl?f.begin:f.end),this.l6a.gba(new Sys.UI.Point(f.x,f.y+f.height),b)):ka.ULS.sendTraceTag(5902807,324,50,"Failed to pop up proofing context menu")}U4i(a,b,c,f,l){if(!b.view.Sh)return 2;const y=b.view;if(!this.Uc.Pa.mb)return this.qd.Xb(Kd.a.zh,{["Reason"]:Qd.a.noSelection}),2;if(1===c)return 32;const H=new oz,Q=new TI(this.Rm,this.rf);b=new UI(null,a,b,c,f,H,Q,this.Ca,this.Uc,this.rf,null);b.Wi=!0;b.run();if(b.isCompleted&&H.uIb){if(b=Od.SelectionFactory.Qg(H.HRc,
H.uIb.begin),b=Od.SelectionFactory.WN(b,cb.a.Lj(H.HRc,H.uIb.end)),!this.vqf.instance||!this.vqf.instance.fYl(H.uIb,b,y)){this.Uc.setSelection(b);let ia=0;l&&(ia=l.Pu);y.Itd=!1;il.a.instance.Hb(new dd.a(1,1,1,()=>{this.Tfl(y,ia,H.HRc,H.uIb)}))}}else{const ia=new Ai.StandardDialog;ia.Ad=0;Rc.App.oS.Zpe?ia.Rlb(CommonUIStrings.l_DefaultDialogTitle,H.ZLh.value?Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,null):(ia.Rlb(CommonUIStrings.l_DefaultDialogTitle,
Box4Intl.Box4Strings.l_ProofingInProgress,null),Rc.App.oS.qdi(()=>{ia.WQ&&(ia.hide(),this.Ca.processAction(a,2))}))}return 32}sPe(){return 32}}Object(m.a)(AC,"ProofingActor",null,[]);var VI=d(733),TQ=d(1131);class nh{static Kxj(){nh.fN||(nh.fN=Array(nh.bCl),nh.fN[0]=ab.a.fontColor,nh.fN[1]=$c.a.gS,nh.fN[2]=ab.a.yt,nh.fN[3]=ab.a.underline,nh.fN[4]=ab.a.gw,nh.fN[5]=$c.a.nt,nh.fN[6]=ab.a.font,nh.fN[7]=ab.a.fontSize,nh.fN[8]=ab.a.superscript,nh.fN[9]=ab.a.subscript,nh.fN[10]=ab.a.yn,nh.fN[11]=Ab.a.noProof,
nh.fN[12]=ee.a.Bxa,nh.fN[13]=$c.a.capitalization,nh.fN[14]=ab.a.bold,nh.fN[15]=ab.a.italic,nh.fN[16]=ab.a.underline);return nh.fN}static Ixj(){nh.CD||(nh.CD=Array(nh.wLk),nh.CD[0]=Ab.a.uo,nh.CD[1]=Ab.a.fKa,nh.CD[2]=Ab.a.nm,nh.CD[3]=Ab.a.aya,nh.CD[4]=Ab.a.CY,nh.CD[5]=Ab.a.Gib,nh.CD[6]=Ab.a.xJb,nh.CD[7]=Ab.a.Fib,nh.CD[8]=$c.a.HJb,nh.CD[9]=$c.a.GJb,nh.CD[10]=Ab.a.DJb,nh.CD[11]=Ab.a.AJb,nh.CD[12]=Ab.a.EWa,nh.CD[13]=Ab.a.Jx,nh.CD[14]=Ab.a.Jib,nh.CD[15]=Ab.a.Iib,nh.CD[16]=Ab.a.Knc,nh.CD[17]=Ab.a.Jnc,nh.CD[18]=
ab.a.Vl,nh.CD[19]=ab.a.xJ,nh.CD[20]=$c.a.mod,nh.CD[21]=ab.a.BY);return nh.CD}}nh.bCl=17;nh.wLk=22;nh.fN=null;nh.CD=null;Object(m.a)(nh,"StyleConstants",null,[]);class rr{static get pVk(){return rr.IP||(rr.IP=new TQ.a)}static Cpe(a,b){if(!a||!a.node||!b)return!1;const c=tb.a.Bs(a);if(rr.Aog(c?c.dA:null,b,nh.Kxj()))return ka.ULS.sendTraceTag(51218398,324,50,"Difference in formatting attributes b/w text selection and style"),!0;a=a.node.a9();return rr.Aog(a,b,nh.Ixj())?(ka.ULS.sendTraceTag(51218399,
324,50,"Difference in paragraph attributes b/w text selection and style"),!0):!1}static Aog(a,b,c){let f=!1;if(a)for(const l of c)f=(a.Ua(l)?b.Ua(l)?!rr.pVk.compare(a,b,l):!0:!1)||f;return f}}rr.IP=null;Object(m.a)(rr,"StyleUtils",null,[]);class BC{constructor(a,b,c,f,l,y,H,Q,ia,wa){this.$4a=this.rPb=null;this.mh=a;this.bL=b;this.cL=c;this.If=f;this.Mha=l;this.Qt=y;this.ZD=H;this.qd=Q;this.jQa=ia;this.y$h=wa}get characterPropertiesEditor(){return this.mh}get wP(){return this.bL}get J6(){return this.cL}get ym(){return this.Mha}get insertionPointFormatting(){return this.Qt}get oh(){return this.If}get fj(){return this.ZD}get Xc(){return this.qd}get P5e(){return this.jQa}get Axc(){return this.y$h}get KVa(){null==
this.$4a&&(w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordHighlightStyleWhenDifferentFromSelectionSettings"),this.$4a=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("HighlightStyleWhenDifferentFromSelectionIsEnabled"):!1);return this.$4a}vb(){const a=w.AFrameworkApplication.Ra,b=Rc.App.KMa.lOc(12);N.a.instance.ga(61)&&(a.ya(C.a.I7a,yb.a.textRange,Object(I.a)(this,this.tmi,"applyStyleToTextRange")),a.ya(C.a.fqc,yb.a.textRange,Object(I.a)(this,this.GWk,"queryStyleTextRange")),
a.ya(C.a.I7a,yb.a.Mf,Object(I.a)(this,this.rmi,"applyStyleToIp")),a.ya(C.a.fqc,yb.a.Mf,Object(I.a)(this,this.EWk,"queryStyleIp")));a.ya(C.a.I7a,yb.a.paragraph,Object(I.a)(this,this.smi,"applyStyleToParagraph"));a.ya(C.a.I7a,yb.a.view,Object(I.a)(this,this.umi,"applyStyleView"));a.he(C.a.I7a,1036);a.ya(C.a.fqc,yb.a.view,Object(I.a)(this,this.HWk,"queryStyleView"));a.ya(C.a.fqc,yb.a.paragraph,Object(I.a)(this,this.FWk,"queryStyleParagraph"));a.he(C.a.fqc,99|(N.a.instance.ga(7)?0:4));a.ya(C.a.zoc,yb.a.view,
b);a.ya(C.a.zoc,yb.a.paragraph,Object(I.a)(this,this.zoc,"populateMenuMoreStyles"));a.he(C.a.zoc,1127);a.ra(C.a.PUd,yb.a.view,Object(I.a)(this,this.isa,"applyStyleShortcut"),4);a.ra(C.a.QUd,yb.a.view,Object(I.a)(this,this.isa,"applyStyleShortcut"),4);a.ra(C.a.RUd,yb.a.view,Object(I.a)(this,this.isa,"applyStyleShortcut"),4);a.ra(C.a.SUd,yb.a.view,Object(I.a)(this,this.isa,"applyStyleShortcut"),4);a.ra(C.a.TUd,yb.a.view,Object(I.a)(this,this.isa,"applyStyleShortcut"),4);a.ra(C.a.UUd,yb.a.view,Object(I.a)(this,
this.isa,"applyStyleShortcut"),4);a.ra(C.a.VUd,yb.a.view,Object(I.a)(this,this.isa,"applyStyleShortcut"),4);a.ra(C.a.ACf,yb.a.view,Object(I.a)(this,this.isa,"applyStyleShortcut"),4);a.ra(C.a.BCf,yb.a.view,Object(I.a)(this,this.isa,"applyStyleShortcut"),4);a.ra(C.a.CCf,yb.a.view,Object(I.a)(this,this.isa,"applyStyleShortcut"),4);this.rPb=Array(10);this.J6.M_e(this.rPb)}xtj(a){switch(a){case C.a.PUd:return 0;case C.a.QUd:return 1;case C.a.RUd:return 2;case C.a.SUd:return 3;case C.a.TUd:return 4;case C.a.UUd:return 5;
case C.a.VUd:return 6;case C.a.ACf:return 7;case C.a.BCf:return 8;case C.a.CCf:return 9;default:return-1}}isa(a,b,c,f){a=this.xtj(a);return 0>a||a>this.rPb.length?2:(a=this.rPb[a])?w.AFrameworkApplication.Ra.ei(b,C.a.I7a,c,!0,f,a):2}zoc(a,b,c,f,l){a=!0;b.contextId!==yb.a.paragraph&&b.contextId!==yb.a.textRange&&b.contextId!==yb.a.Mf&&(a=!1);if(1===c||!a)return a?32:8;if(2===c&&!l)return 8;b=this.J6.JL(b.node);c=N.a.instance.ga(61);w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.ob.Qp&&(l.MenuItems=
VI.StylePreviewGenerator.n9f(b,c));l.PopulationXML=VI.StylePreviewGenerator.S9i(b,c);return 32}FWk(a,b,c,f,l){a=!0;b.contextId!==yb.a.paragraph&&(a=!1);if(1===c&&!a)return 8;c=b.node;a=this.J6.tE(c);if(!a||!l)return ka.ULS.sendTraceTag(51218391,324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",l,c,a),8;l.k4e.ny(a);this.KVa&&(l.Une=rr.Cpe(b,a));return 32}smi(a,b,c,f,l){if(b.contextId!==yb.a.paragraph)return 8;if(N.a.instance.ga(14)&&this.fj.kGa(b))return this.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.kE}),
8;if(1===c)return 32;a=b.node;if(!l)return 8;b=this.nde(l,a);if(!b)return this.Xc.Xb(Kd.a.h2,{["Reason"]:Qd.a.T5b}),8;if(2!==this.J6.mua(b))return 2;c=new pf.GraphTransaction(15);c.ld(a);this.insertionPointFormatting.K0a();this.wP.aba(b,a,!1);c.dispose();l=ma.a.iL(l);f.QC=l>>>16^l&65535;return 32}GWk(a,b,c,f,l){a=!0;b.contextId!==yb.a.textRange&&(a=!1);if(1===c&&!a)return 2;c=b.node;a=tb.a.Bs(b);a=tb.a.Pxb(a);if(this.KVa){if(!l||!c)return ka.ULS.sendTraceTag(51218393,324,10,"actionData : {}, graphNode : {}",
l,c),8;a=a||this.J6.tE(c);if(!a)return ka.ULS.sendTraceTag(51218394,324,10,"No paragraph style for Text range context is found"),2;l.Une=rr.Cpe(b,a)}else{if(!a)return 2;if(!l)return 8}l.k4e.ny(a);return 32}tmi(a,b,c,f,l){if(b.contextId!==yb.a.textRange||!N.a.instance.ga(61))return 8;if(this.fj.kGa(b))return this.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.kE}),8;if(1===c)return 32;a=b.node;if(!l)return 8;const y=this.nde(l,b.node);if(!y)return this.Xc.Xb(Kd.a.h2,{["Reason"]:Qd.a.T5b}),8;if(1!==this.J6.mua(y))return 2;
c=this.J6.JL(a);if(!c)return this.Xc.Xb(Kd.a.h2,{["Reason"]:Qd.a.d_f}),8;if(!c.kH(this.J6.HQ(y)))return this.Xc.Xb(Kd.a.h2,{["Reason"]:Qd.a.T5b}),8;const H=new pf.GraphTransaction(7);try{H.ld(a),this.wP.bxc(a,c),this.P5e.fKc(b,Q=>{this.oh.ZCa(Q);this.oh.Jga(Q,y)})}finally{H&&H.dispose()}b=ma.a.iL(l);f.QC=b>>>16^b&65535;return 32}EWk(a,b,c,f,l){a=!0;b.contextId!==yb.a.Mf&&(a=!1);if(1===c&&!a)return 2;c=this.wP.kde(b);a=b.node;if(this.KVa){if(!l||!a)return ka.ULS.sendTraceTag(51218396,324,10,"actionData : {}, graphNode : {}",
l,a),8;c=c||this.J6.tE(a);if(!c)return ka.ULS.sendTraceTag(51218397,324,10,"No paragraph style for I/P context is found"),2;l.Une=rr.Cpe(b,c)}else{if(!c)return 2;if(!l)return 8}l.k4e.ny(c);return 32}rmi(a,b,c,f,l){if(b.contextId!==yb.a.Mf||!N.a.instance.ga(61))return 8;if(this.fj.kGa(b))return this.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.kE}),8;if(1===c)return 32;c=b.node;if(!l)return 8;const y=this.nde(l,b.node);if(!y)return this.Xc.Xb(Kd.a.h2,{["Reason"]:Qd.a.T5b}),8;const H=this.J6.mua(y);if(1!==H&&2!==
H)return 2;(b=this.insertionPointFormatting.l8b(b))?(c=ge.a.ZRa(b),a=w.AFrameworkApplication.Ra.ei(c,a,2,!1,f,l)):(a=new pf.GraphTransaction(7),a.ld(c),this.wP.N_e(y,c),a.dispose(),a=32);l=ma.a.iL(l);f.QC=l>>>16^l&65535;return a}HWk(a,b,c,f,l){if(N.a.instance.ga(61)){const y=this.Axc.k6(a,b,c,f,l,null,0);if(2!==y)return y}return this.Axc.k6(a,b,c,f,l,null,12)}umi(a,b,c,f,l){const y={};y[this.Axc.bqa]=6168;y[this.Axc.aqa]=6169;let H=12;if(N.a.instance.ga(61)){if(!b.view.Sh)return 2;var Q=b.view.Nb,
ia=Q?Q.Yj:null;if(!ia)return this.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.noSelection}),8;if(N.a.instance.ga(11)&&this.ym.Hsa(ba.ImageReader.BAb,ia))return this.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.H2b}),8;if(N.a.instance.ga(14)&&this.fj.D0c(ia))return this.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.kE}),8;ia=this.J6.Zyb();if(l&&ia){var wa=ia.kH(l);wa&&(ia=this.J6.Nae(wa,ia),wa=this.J6.mua(wa),ia&&(Q=Q.Pa.ga(0),Q.gda&&Q.Va.contextId===yb.a.textRange||2===Q.length&&Q.Va.contextId===yb.a.textRange&&Q.jf.contextId===yb.a.endOfParagraph)&&
(wa=1,l=ia.eb($c.a.IJb)),1===wa?H=0:3===wa&&(H=14))}}return this.Axc.k6(a,b,c,f,l,y,H)}nde(a,b){if(a&&b&&Db.ParagraphReader.ae(b))b=this.J6.JL(b);else return null;return b.kH(a)}}Object(m.a)(BC,"StyleActor",null,[]);const WI=a=>a.contextId===yb.a.W7d;class Mg{static get ym(){return Ch.ContextSetEditor.instance}static get fj(){return bh.a.instance}static get Xc(){return mc.a.instance}static get Be(){return Mg.kd||(Mg.kd=Ib.a.instance.resolve("Box4.IFeatureHelper"))}static lr(){return Mg.Sm||(Mg.Sm=
Ib.a.instance.Ia("Box4.IExternalSelectionManager"))}static get SM(){return Mg.OG||(Mg.OG=Ib.a.instance.resolve("Box4.IParagraphIndentationReader"))}static Obc(a){return w.AFrameworkApplication.fa.ka("FontPreviewEnabled")&&(a===C.a.FKa||a===C.a.P0a||a===C.a.n6||a===C.a.tLa)}static o8(a,b,c,f,l){var y=!0;if(!b.view.Sh)return 2;var H=b.view,Q=H.Nb;Q&&Q.Pa.mb||(Mg.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.noSelection}),y=!1);if(N.a.instance.ga(11)&&(Mg.ym.Hsa(ba.ImageReader.fbc,H.Nb.Yj)&&(Mg.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.v_d}),
y=!1),Mg.ym.Hsa(ba.ImageReader.BAb,H.Nb.Yj)))return Mg.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.H2b}),8;N.a.instance.ga(14)&&Mg.fj.D0c(H.Nb.Yj)&&(Mg.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.kE}),y=!1);Mg.ym.Hsa(ba.ImageReader.Gne,H.Nb.Yj)&&(Mg.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.PMf}),y=!1);Mg.ym.Hsa(mu.c,H.Nb.Yj)&&(Mg.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.QMf}),y=!1);Mg.ym.Hsa(WI,H.Nb.Yj)&&(Mg.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.OMf}),y=!1);Mg.lr()&&Mg.lr().instance&&Mg.lr().instance.fX(H.Nb.Yj)&&(Mg.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.externalSelection}),
y=!1);a!==C.a.R1||N.a.instance.ga(54)||N.a.instance.ga(84)||(y=!1);var ia=null;Q&&Q.Pa.mb&&(ia=Q.Pa.mb);a===C.a.Fzl&&ia&&ia.gda&&Db.ParagraphReader.gX(ia.Va.node)&&!Zb.ListReader.Fx&&(y=!1);if(1===c||!y||!ia)return y?32:8;y=a===C.a.Yla||a===C.a.Cja||a===C.a.gpa||a===C.a.BEa;H=a===C.a.YUk||a===C.a.JSi||a===C.a.Fnh;const wa=a===C.a.tlb||a===C.a.ulb||a===C.a.R1,Ua=new pf.GraphTransaction(15);Ua.ld(ia.Va.node);ia=new Na.a;let kb=!1;if(y||H||wa)pb.a.mark(7121),b=Mg.ym.f9i(b.UE);else{pb.a.mark(7119);b=
vi.Kta(Q.Pa,!0);if(!b)return Mg.Xc.Xb(Kd.a.ska,{["Reason"]:Qd.a.iSc}),Ua.dispose(),8;Q=a===C.a.OLj||a===C.a.PLj;b.Bx&&Q&&(kb=Mg.uHj(ia,b))}b.Bx&&1<b.length&&Mg.vHj(b)&&(l||(l={}),l.InContextSet=!0);w.AFrameworkApplication.Ra.ei(b,a,c,!0,f,l);kb&&Mg.ryk(ia,b,l);Ua.dispose();Rc.App.Lb.updateCommandUI();y||H||wa?pb.a.mark(7122):pb.a.mark(7120);return 32}static uHj(a,b){if(!b.Bx)return!1;let c=!1,f=!1;for(let y=0;y<b.length;y++)if(b.getContext(y).Pk){var l=b.getContext(y).node;if(l)if(l=Mg.SM.pyb(l),
2===l.specialIndentType)c=!0,a.add(y);else if(1===l.specialIndentType||0===l.specialIndentType)f=!0}return f&&c}static ryk(a,b,c){if(b.Bx)for(let l=0;l<a.count;l++){var f=b.getContext(a.ga(l));if(!f.Pk)continue;f=f.node;const y=Mg.SM.pyb(f);2!==y.specialIndentType||ah.a.qz(c.value,y.dO)||f.setValue(Ab.a.nm,y.dO-y.bPb)}}static dsl(a,b){let c=!0;b.contextId!==yb.a.paragraph?c=!1:N.a.instance.ga(14)&&Mg.fj.kGa(b)?(Mg.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.kE}),c=!1):Mg.lr()&&Mg.lr().instance&&Mg.lr().instance.fX(b)&&
(Mg.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.externalSelection}),c=!1);return{returnValue:1!==a&&c,GF:c?32:8}}static oAh(a,b){let c=!0;b.contextId!==yb.a.image&&b.contextId!==yb.a.embeddedFile&&(c=!1);N.a.instance.ga(11)&&(c=!1);return{returnValue:1!==a&&c,GF:c?32:8}}static vHj(a){if(!a.Bx)return!1;let b=1;for(let f=0;f<a.length;f++)if(a.getContext(f).Pk){var c=a.getContext(f).node;if(c)if(c=Db.ParagraphReader.CL(c),!f)b=c;else if(c!==b)return!0}return!1}}Mg.kd=null;Mg.Sm=null;Mg.OG=null;Object(m.a)(Mg,"FormattingActionHelper",
null,[]);class ft extends ct.a{constructor(a,b,c,f,l,y,H,Q){super();this.Csf=this.zC=null;this.init(a);this.$l("FormattingViewOperation");this.zFa(w.AFrameworkApplication.Ra,b,f,l,y);this.Ot=c;this.yNa=0;this.wC=!0;this.CYh=H;this.Sm=Q}get qta(){return this.Sm.instance}run(){const a=this.Ot.view;var b=null;a.Sh&&(b=a.Nb);if(b){var c=b.Pa.mb;!c||N.a.instance.ga(14)&&ft.fj.Hpe(c)?(ft.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.kE}),this.wC=!1):this.qta&&this.qta.RAb(c)&&(ft.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.externalSelection}),
this.wC=!1)}else ft.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.coa}),this.wC=!1;1!==this.behavior&&this.wC||(this.wC&&(c=b.Pa.mb,1===b.Pa.length&&1===c.length&&Mb.SelectionEditor.tk(c.Va)&&cg.b(c.Va)&&(ft.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.ANc}),this.wC=!1)),(c=this.wC)&&this.actionId===C.a.lV&&((c=Ia.AT(b.Pa.mb,tb.a.RMf))||ft.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.i4d})),this.gp=c?32:8,this.yNa=3);0===this.yNa&&(pb.a.mark(5730),this.Csf=rn.SelectionReferenceFactory.instance.Nsa(),c=b.Pa.mb.Va,this.zC=new pf.GraphTransaction(15),
this.zC.ld(c.node),this.yNa=1);if(1===this.yNa){this.ux||this.elb(this.Ot.UE);if(1===this.Eoa())return;this.yNa=2}if(2===this.yNa){if(this.actionId===C.a.lV)if(b=b.Yj,b.Bx)for(c=0;c<b.length;c++){let f=b.getContext(c);this.tLh(f)}else this.tLh(b);b=this.actionId===C.a.Q1||this.actionId===C.a.Gja||this.actionId===C.a.clearFormatting||this.actionId===C.a.zW;Mg.Obc(this.actionId)||this.Csf.bV(b);(b=Object(qa.a)(139,this.zd))&&!b.dba||v.FocusManager.instance().vf(a.VI);this.zC.dispose();this.zC=null;
Mg.Obc(this.actionId)||Rc.App.Lb.updateCommandUI();pb.a.mark(5731);this.yNa=3;this.gp=32}3===this.yNa&&(this.CYh.process(this.actionId,this.Ot,this.behavior,this.response),this.RY())}tLh(a){(Mb.SelectionEditor.ju(a)||Mb.SelectionEditor.im(a))&&Rc.App.oS.jS(a.node)}static get fj(){return bh.a.instance}static get Xc(){return mc.a.instance}}Object(m.a)(ft,"FormattingViewOperation",ct.a,[]);var UQ=d(489),VQ=d(418);class Fd{constructor(a,b,c,f,l){this.jBa=new Eb.ScriptSharpLegacyMap;this.rpl=y=>{y=wb.HyperlinkReader.yij(y,
this.XD);for(let H of y)(y=H.paragraph)&&y.Ta&&(y=y.Ta.HT(H.Sa))&&y.formatting&&Fd.oh.xrh(y.formatting)};this.OYh=a;this.Kff=b;this.mw=c;this.XD=f;if(!l)throw Error.argumentNull("interactiveViewManager");Fd.Pf=l;this.Xpb=!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("FontPreviewEnabled")}vb(){const a=w.AFrameworkApplication.Ra,b=Object(I.a)(this,this.fWk,"queryNonParagraphFormatting");N.a.instance.ga(105)&&(Fd.Be?Fd.Be.VFa(55):w.AFrameworkApplication.fa.ka("Box4EndOfParagraphFormattingIsEnabled"))?
(a.ya(C.a.font,yb.a.endOfParagraph,Object(I.a)(this,this.gQ,"applyFormattingEOP")),a.ya(C.a.Xq,yb.a.endOfParagraph,Object(I.a)(this,this.gQ,"applyFormattingEOP")),a.ya(C.a.mH,yb.a.endOfParagraph,Object(I.a)(this,this.gQ,"applyFormattingEOP")),a.ya(C.a.bI,yb.a.endOfParagraph,Object(I.a)(this,this.gQ,"applyFormattingEOP")),a.ya(C.a.sr,yb.a.endOfParagraph,Object(I.a)(this,this.gQ,"applyFormattingEOP")),a.ya(C.a.zW,yb.a.endOfParagraph,Object(I.a)(this,this.gQ,"applyFormattingEOP")),a.ya(C.a.Q1,yb.a.endOfParagraph,
Object(I.a)(this,this.gQ,"applyFormattingEOP")),a.ya(C.a.Gja,yb.a.endOfParagraph,Object(I.a)(this,this.gQ,"applyFormattingEOP")),a.ya(C.a.bold,yb.a.endOfParagraph,Object(I.a)(this,this.gQ,"applyFormattingEOP")),a.ya(C.a.setItalic,yb.a.endOfParagraph,Object(I.a)(this,this.gQ,"applyFormattingEOP")),a.ya(C.a.underline,yb.a.endOfParagraph,Object(I.a)(this,this.gQ,"applyFormattingEOP")),a.ya(C.a.vpa,yb.a.endOfParagraph,Object(I.a)(this,this.gQ,"applyFormattingEOP")),a.ya(C.a.superscript,yb.a.endOfParagraph,
Object(I.a)(this,this.gQ,"applyFormattingEOP")),a.ya(C.a.subscript,yb.a.endOfParagraph,Object(I.a)(this,this.gQ,"applyFormattingEOP")),a.ya(C.a.strikethrough,yb.a.endOfParagraph,Object(I.a)(this,this.gQ,"applyFormattingEOP")),a.ya(C.a.nt,yb.a.endOfParagraph,Object(I.a)(this,this.gQ,"applyFormattingEOP")),a.ya(C.a.lV,yb.a.endOfParagraph,Object(I.a)(this,this.gQ,"applyFormattingEOP")),a.ya(C.a.clearFormatting,yb.a.endOfParagraph,Object(I.a)(this,this.gQ,"applyFormattingEOP"))):Rc.App.gdb&&(a.ya(C.a.font,
yb.a.endOfParagraph,Object(I.a)(this,this.Pca,"applyListFormattingEOP")),a.ya(C.a.Xq,yb.a.endOfParagraph,Object(I.a)(this,this.Pca,"applyListFormattingEOP")),a.ya(C.a.sr,yb.a.endOfParagraph,Object(I.a)(this,this.Pca,"applyListFormattingEOP")),a.ya(C.a.zW,yb.a.endOfParagraph,Object(I.a)(this,this.Pca,"applyListFormattingEOP")),Zb.ListReader.Fx&&(a.ya(C.a.bold,yb.a.endOfParagraph,Object(I.a)(this,this.Pca,"applyListFormattingEOP")),a.ya(C.a.setItalic,yb.a.endOfParagraph,Object(I.a)(this,this.Pca,"applyListFormattingEOP")),
a.ya(C.a.superscript,yb.a.endOfParagraph,Object(I.a)(this,this.Pca,"applyListFormattingEOP")),a.ya(C.a.subscript,yb.a.endOfParagraph,Object(I.a)(this,this.Pca,"applyListFormattingEOP")),a.ya(C.a.strikethrough,yb.a.endOfParagraph,Object(I.a)(this,this.Pca,"applyListFormattingEOP")),a.ya(C.a.nt,yb.a.endOfParagraph,Object(I.a)(this,this.Pca,"applyListFormattingEOP"))),N.a.instance.ga(94)||N.a.instance.ga(96))&&(a.ya(C.a.mH,yb.a.endOfParagraph,Object(I.a)(this,this.Pca,"applyListFormattingEOP")),a.ya(C.a.bI,
yb.a.endOfParagraph,Object(I.a)(this,this.Pca,"applyListFormattingEOP")));const c=Rc.App.KMa.LOf(f=>vi.Kta(f.Pa,!0));a.ra(C.a.Gwd,yb.a.textRange,Object(I.a)(this,this.Gwd,"toggleChangeCase"),1028);N.a.instance.ga(77)||a.ya(C.a.rya,yb.a.table,Object(I.a)(this,this.NWk,"queryTableFormatting"));a.ya(C.a.RKb,yb.a.view,Object(I.a)(this,this.ejh,"queryCharacterFormatting"));a.ya(C.a.QRe,yb.a.view,Object(I.a)(this,this.ejh,"queryCharacterFormatting"));a.ya(C.a.rya,yb.a.view,c);a.ya(C.a.rya,yb.a.paragraph,
Object(I.a)(this,this.rya,"queryParagraphFormatting"));a.ya(C.a.rya,yb.a.image,Object(I.a)(this,this.YVk,"queryImageFormatting"));a.ya(C.a.rya,yb.a.unsupportedObject,b);a.he(C.a.RKb,99|(N.a.instance.ga(7)?0:1028));a.he(C.a.QRe,1127);a.he(C.a.rya,97|(N.a.instance.ga(7)?0:1028));w.AFrameworkApplication.fa.ka("RulerEnabled")&&(a.ya(C.a.UKb,yb.a.view,c),a.ya(C.a.UKb,yb.a.paragraph,Object(I.a)(this,this.UKb,"queryParagraphIndentation")),a.he(C.a.UKb,97|(N.a.instance.ga(7)?0:1028)));this.DC(a,C.a.font);
this.DC(a,C.a.Xq);this.Xpb&&(this.DC(a,C.a.FKa),this.DC(a,C.a.P0a),this.DC(a,C.a.n6),this.DC(a,C.a.tLa));if(N.a.instance.ga(94)||N.a.instance.ga(96))this.DC(a,C.a.mH),this.DC(a,C.a.bI);a.rCa(C.a.S1f,yb.a.view,Object(I.a)(this,this.BUd,"applyCharacterFormattingViewAsync"));a.he(C.a.S1f,1092);this.DC(a,C.a.sr);this.DC(a,C.a.zW);this.DC(a,C.a.Q1);this.DC(a,C.a.t1b);this.DC(a,C.a.Dub);this.DC(a,C.a.Eub);this.DC(a,C.a.o8a);this.DC(a,C.a.u1b);this.DC(a,C.a.Gja);this.DC(a,C.a.bold);a.Xkb(C.a.bold,Object(I.a)(this,
this.y$a,"generateActionArguments"));this.DC(a,C.a.setItalic);a.Xkb(C.a.setItalic,Object(I.a)(this,this.y$a,"generateActionArguments"));this.DC(a,C.a.underline);a.Xkb(C.a.underline,Object(I.a)(this,this.y$a,"generateActionArguments"));this.DC(a,C.a.vpa);this.DC(a,C.a.superscript);a.Xkb(C.a.superscript,Object(I.a)(this,this.y$a,"generateActionArguments"));this.DC(a,C.a.subscript);a.Xkb(C.a.subscript,Object(I.a)(this,this.y$a,"generateActionArguments"));this.DC(a,C.a.strikethrough);a.Xkb(C.a.strikethrough,
Object(I.a)(this,this.y$a,"generateActionArguments"));this.DC(a,C.a.nt);a.Xkb(C.a.nt,Object(I.a)(this,this.y$a,"generateActionArguments"));a.ra(C.a.Obb,yb.a.textRange,Object(I.a)(this,this.eKc,"applyCharacterFormatting"),96);a.rCa(C.a.lV,yb.a.view,Object(I.a)(this,this.BUd,"applyCharacterFormattingViewAsync"));a.ya(C.a.lV,yb.a.paragraph,Object(I.a)(this,this.IUd,"applyParagraphFormatting"));a.ya(C.a.lV,yb.a.textRange,Object(I.a)(this,this.eKc,"applyCharacterFormatting"));a.ya(C.a.lV,yb.a.Mf,Object(I.a)(this,
this.CUd,"applyFormattingIp"));a.ya(C.a.clearFormatting,yb.a.view,Object(I.a)(this,this.ZAi,"clearFormattingView"));a.ya(C.a.clearFormatting,yb.a.paragraph,Object(I.a)(this,this.YAi,"clearFormattingParagraph"));a.ya(C.a.clearFormatting,yb.a.textRange,Object(I.a)(this,this.eKc,"applyCharacterFormatting"));a.ya(C.a.clearFormatting,yb.a.Mf,Object(I.a)(this,this.CUd,"applyFormattingIp"));a.he(C.a.clearFormatting,1028);a.ya(C.a.y8a,yb.a.textRange,Object(I.a)(this,this.y8a,"clearFormattingParagraphLevel"));
a.ya(C.a.y8a,yb.a.Mf,Object(I.a)(this,this.y8a,"clearFormattingParagraphLevel"));a.ya(C.a.VYd,yb.a.view,Object(I.a)(this,this.VYd,"clearFormattingMultiParagraphLevel"));a.ya(C.a.WLa,yb.a.view,Mg.o8);a.ya(C.a.WLa,yb.a.paragraph,Object(I.a)(this,this.IUd,"applyParagraphFormatting"));a.ya(C.a.WLa,yb.a.image,Object(I.a)(this,this.FCf,"applyTextDirectionToImage"));a.ya(C.a.WLa,yb.a.unsupportedObject,Object(I.a)(this,this.GCf,"applyTextDirectionToNonParagraph"));a.he(C.a.WLa,1028);a.ya(C.a.F1a,yb.a.view,
Mg.o8);a.ya(C.a.F1a,yb.a.paragraph,Object(I.a)(this,this.IUd,"applyParagraphFormatting"));a.ya(C.a.F1a,yb.a.image,Object(I.a)(this,this.FCf,"applyTextDirectionToImage"));a.ya(C.a.F1a,yb.a.unsupportedObject,Object(I.a)(this,this.GCf,"applyTextDirectionToNonParagraph"));a.he(C.a.F1a,1028)}DC(a,b){a.rCa(b,yb.a.view,Object(I.a)(this,this.BUd,"applyCharacterFormattingViewAsync"));a.ya(b,yb.a.textRange,Object(I.a)(this,this.eKc,"applyCharacterFormatting"));a.ya(b,yb.a.Mf,Object(I.a)(this,this.CUd,"applyFormattingIp"));
a.he(b,1028)}y$a(){return new R(2)}Gwd(a,b,c){if(1===c)return 32;a=b.node.characterData.substr(b.Sa,b.Mb-b.Sa);return Fd.eqe(a,0,a.length)?this.bMc(b,C.a.Dub):Fd.Q3j(a)?this.bMc(b,C.a.o8a):this.bMc(b,C.a.Eub)}ejh(a,b,c,f,l){f=!0;b.contextId!==yb.a.view&&(f=!1);if(1===c&&!f)return 8;if(a===C.a.QRe)a=l.formatting,l=l.UYl;else{if(!b.view||!b.view.Sh)return 2;b=b.view;if(!b.Nb||!b.Nb.Pa.mb)return 8;a=l;l=b.Nb.Pa}this.qEi(l,a);return 32}qEi(a,b){for(let l of a){a=l.Sl;for(let y of l){let H=null;if(y.contextId===
yb.a.textRange){if(cg.b(y))continue;H=[];var c=y.node.Ta;if(c){var f=c.length-1;const Q=y.Sa,ia=y.Mb;let wa=!1;for(let Ua=0;Ua<f;Ua++){const kb=c.ga(Ua).cp,Gb=c.ga(Ua+1).cp;if(c.ga(Ua).formatting&&Math.max(kb,Q)<Math.min(Gb,ia))wa=!0,Array.add(H,c.ga(Ua).formatting);else if(wa)break}c.ga(f).formatting&&y.Mb>c.ga(f).cp&&Array.add(H,c.ga(f).formatting)}}else if(y.contextId===yb.a.paragraph){if(H=[],c=y.node.Ta)for(f=0;f<c.length;f++)c.ga(f).formatting&&Array.add(H,c.ga(f).formatting)}else if(y.contextId===
yb.a.endOfParagraph)H=[tb.a.Bs(y)];else if(y.contextId===yb.a.Mf){this.FVk(y,b);return}if(H&&0<H.length)for(const Q of H)if(tb.a.ayd(b,Q.cache,y,a))return}}}FVk(a,b){var c=tb.a.Bs(a);if(c){c=c.cache;var f=Fd.insertionPointFormatting.bJ(ab.a.bold,c.isBold);b.bold=f?1:0;f=Fd.insertionPointFormatting.bJ(ab.a.italic,c.isItalic);b.italic=f?1:0;f=Fd.insertionPointFormatting.bJ(ab.a.underline,c.xE);b.underline=f?1:0;b.gw=Fd.insertionPointFormatting.bJ(ab.a.gw,c.gw);f=Fd.insertionPointFormatting.bJ(ab.a.superscript,
c.isSuperscript);b.superscript=f?1:0;f=Fd.insertionPointFormatting.bJ(ab.a.subscript,c.cG);b.subscript=f?1:0;f=Fd.insertionPointFormatting.bJ(ab.a.strikethrough,c.bG);b.strikethrough=f?1:0;f=Fd.insertionPointFormatting.bJ($c.a.nt,c.U_);b.nt=f?1:0;b.fontName=sd.Font.PEa(Fd.insertionPointFormatting.bJ(ab.a.font,c.wL));b.Opa=c.wV;b.fontSize=this.mw.Y$a(Fd.insertionPointFormatting.bJ(ab.a.fontSize,c.fontSize),a.node);b.fontColor=Fd.insertionPointFormatting.bJ(ab.a.fontColor,c.fontColor);b.highlight=Fd.insertionPointFormatting.bJ(ab.a.highlight,
c.highlight)}}BUd(a,b,c,f,l,y){return new ft(a,b,c,f,l,y,this.OYh,Fd.lr())}eKc(a,b,c,f,l){f=!0;let y=b;b.contextId!==yb.a.textRange&&b.contextId!==yb.a.Mf?f=!1:(N.a.instance.ga(14)&&Fd.fj.Xua(y)&&(Fd.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.kE}),f=!1),Fd.lr()&&Fd.lr().instance&&Fd.lr().instance.fX(y)&&(f=!1),f&&Mb.SelectionEditor.tk(b)&&cg.b(y)&&(Fd.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.ANc}),f=!1));if(1===c||!f)return f?32:8;if(b.contextId===yb.a.Mf)return 2;this.mw.uBh(a)&&(b=Mb.SelectionEditor.AQb(y),Mb.SelectionEditor.Xg(b)||
(y=b));b=y.node;Mg.Obc(a)&&(b.Kpa=!0);a==C.a.sr&&N.a.instance.ga(119)&&w.AFrameworkApplication.fa.isChangeGateEnabled("HyperlinkPartialColorSupported")&&this.rpl(y);Fd.P5e.fKc(y,H=>{this.gwh(H,a,l,y.Mb)});Mg.Obc(a)&&(b.Kpa=!1);this.TTj(a)&&this.bMc(y,a);return 32}BWc(a){if(!this.Xpb||!a||!a.paragraph)return null;const b=Fd.Pf.Rd;if(!b)return null;a=Object(qa.a)(1029,a.paragraph.tg(b.Na));return a?(a=Object(qa.a)(1066,a))?a:null:null}NYc(a){return this.Xpb&&!!a&&!!a.Pi}Awh(a,b,c){if(a&&a.zd){var f=
b.cache,l=a.zd,y=-1;if("string"===typeof l)this.Xpb&&c===C.a.n6&&this.j8a(b,f.wL,ab.a.font),a=l;else if(this.Xpb&&c===C.a.n6&&(this.j8a(b,f.wL,ab.a.font),this.j8a(b,f.wV,Ab.a.wV)),a=l.fontName,y=l.Opa,sd.Font.VVa()){this.Xpb&&c===C.a.n6&&(this.j8a(b,f.isBold,ab.a.bold),this.j8a(b,f.isItalic,ab.a.italic));const H=1===l.bold;l=1===l.italic;if(H||l)Fd.oh.$H(b,H),Fd.oh.setItalic(b,l)}a=a.substr(0,31);Fd.oh.jV(b,a);N.a.instance.ga(53)&&(c===C.a.n6&&this.j8a(b,f.wV,Ab.a.wV),Fd.oh.XLa(b,y))}}j8a(a,b,c){this.jBa.Fb(a.Je.cp)||
this.jBa.$(a.Je.cp,new Eb.ScriptSharpLegacyMap);this.jBa.ga(a.Je.cp).Fb(c)||this.jBa.ga(a.Je.cp).$(c,b)}e7b(a,b){if(!this.jBa.Fb(a.Je.cp))return null;const c=this.jBa.ga(a.Je.cp).ga(b);this.jBa.ga(a.Je.cp).remove(b);this.jBa.ga(a.Je.cp).count||this.jBa.remove(a.Je.cp);return c}gwh(a,b,c,f){var l=a.cache,y=Object(qa.a)(139,c);switch(b){case C.a.bold:2===c.value&&(c.value=l.isBold?0:1);Fd.oh.$H(a,1===c.value);break;case C.a.setItalic:2===c.value&&(c.value=l.isItalic?0:1);Fd.oh.setItalic(a,1===c.value);
break;case C.a.underline:2===c.value&&(c.value=l.xE?0:1);Fd.oh.VY(a,1===c.value);break;case C.a.vpa:Fd.oh.vpa(a,c);break;case C.a.superscript:2===c.value&&(c.value=l.isSuperscript?0:1);Fd.oh.UY(a,1===c.value);break;case C.a.subscript:2===c.value&&(c.value=l.cG?0:1);Fd.oh.A6(a,1===c.value);break;case C.a.strikethrough:2===c.value&&(c.value=l.bG?0:1);Fd.oh.TY(a,1===c.value);break;case C.a.nt:2===c.value&&(c.value=l.U_?0:1);Fd.oh.flb(a,1===c.value);break;case C.a.font:this.Awh(y,a,C.a.font);break;case C.a.n6:c=
this.BWc(a);this.NYc(c)&&(this.Awh(y,a,C.a.n6),c.yK(null));break;case C.a.tLa:c=this.BWc(a);this.NYc(c)&&(y=this.e7b(a,ab.a.font))&&(l=this.e7b(a,ab.a.bold),f=this.e7b(a,ab.a.italic),l&&Fd.oh.$H(a,l),f&&Fd.oh.setItalic(a,f),y=y.substr(0,31),Fd.oh.jV(a,y),l=this.e7b(a,Ab.a.wV),N.a.instance.ga(53)&&l&&Fd.oh.XLa(a,l),c.yK(null));break;case C.a.sr:Fd.oh.sr(a,c,null);break;case C.a.zW:Fd.oh.zW(a);break;case C.a.Q1:Fd.oh.ppa(a,c);break;case C.a.Gja:Fd.oh.R1b(a);break;case C.a.Xq:Fd.oh.Xq(a,y.zd);break;
case C.a.FKa:c=this.BWc(a);this.NYc(c)&&(this.j8a(a,l.fontSize,ab.a.fontSize),Fd.oh.Xq(a,y.zd),c.yK(null));break;case C.a.P0a:c=this.BWc(a);this.NYc(c)&&(l=this.e7b(a,ab.a.fontSize))&&(Fd.oh.Xq(a,l),c.yK(null));break;case C.a.mH:Fd.oh.iYc(a);break;case C.a.bI:Fd.oh.xud(a);break;case C.a.lV:l=N.a.instance.ga(20)?Ab.a.noProof:ee.a.Bxa;Fd.oh.Nsc(a,c.eb(ab.a.yt),f,c.sa(l,!1));break;case C.a.Obb:Fd.oh.DNb(a);break;case C.a.clearFormatting:Fd.oh.ZCa(a);break;case C.a.Dub:case C.a.Eub:case C.a.t1b:case C.a.o8a:case C.a.u1b:l.QUa&&
2===l.capitalization&&Fd.oh.PYd(a)}}y8a(a,b,c){a=!0;b.contextId!==yb.a.textRange&&b.contextId!==yb.a.Mf?a=!1:(N.a.instance.ga(14)&&Fd.fj.Xua(b)&&(Fd.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.kE}),a=!1),a&&Mb.SelectionEditor.tk(b)&&cg.b(b)&&(Fd.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.ANc}),a=!1));if(1===c||!a)return a?32:8;Fd.paragraphEditor.V1b(b.node,!1);return 32}VYd(a,b,c,f,l){a={};a[ii.bqa]=6168;a[ii.aqa]=6169;const y=b.view;var H=null;y.qp&&(H=y);var Q=!0;let ia=32;H&&(H=H.Nb.Pa.mb)&&N.a.instance.ga(14)&&(Fd.fj.Hpe(H)?
(Fd.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.kE}),ia=8,Q=!1):1===c&&(ia=32,Q=!1));Q&&N.a.instance.ga(54)&&(Q=new pf.GraphTransaction(1===c?3:15),Q.ld(y.root),ia=ii.k6(C.a.y8a,b,c,f,l,a,12),Q.dispose());return ia}CUd(a,b,c,f,l){var y=!0,H=32;b.contextId!==yb.a.Mf?y=!1:N.a.instance.ga(14)&&Fd.fj.Xua(b)&&(Fd.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.kE}),y=!1);if(1===c||!y)return y?32:8;c=b.node;y=null;if(N.a.instance.ga(54)&&N.a.instance.ga(61)&&a===C.a.clearFormatting){Fd.jq.Tub(c);Fd.paragraphEditor.MKf(c);const Q=fb.StyleReader.JL(c).kH(fb.StyleReader.sNa);
Fd.wP.aba(Q,c,!0)}if(a!==C.a.clearFormatting||N.a.instance.ga(49))y=Fd.insertionPointFormatting.l8b(b);if(y)H=ge.a.ZRa(y),H=w.AFrameworkApplication.Ra.ei(H,a,2,!1,f,l);else switch(f=Object(qa.a)(139,l),b=tb.a.Bs(b).cache,a){case C.a.font:f&&f.zd&&(l=f.zd,f=-1,"string"===typeof l?b=l:(b=l.fontName,f=l.Opa),Fd.insertionPointFormatting.msd(b),N.a.instance.ga(53)&&Fd.insertionPointFormatting.XLa(f));break;case C.a.sr:Fd.insertionPointFormatting.sr(l);break;case C.a.zW:Fd.insertionPointFormatting.zW();
break;case C.a.Q1:Fd.insertionPointFormatting.ppa(l);break;case C.a.Gja:Fd.insertionPointFormatting.R1b();break;case C.a.Xq:Fd.insertionPointFormatting.Xq(f.zd);break;case C.a.mH:l=Fd.insertionPointFormatting.bJ(ab.a.fontSize,b.fontSize);Fd.insertionPointFormatting.Xq(Fd.oh.mH(l));break;case C.a.bI:l=Fd.insertionPointFormatting.bJ(ab.a.fontSize,b.fontSize);Fd.insertionPointFormatting.Xq(Fd.oh.bI(l));break;case C.a.bold:Fd.insertionPointFormatting.$H(!Fd.insertionPointFormatting.bJ(ab.a.bold,b.isBold));
break;case C.a.setItalic:Fd.insertionPointFormatting.setItalic(!Fd.insertionPointFormatting.bJ(ab.a.italic,b.isItalic));break;case C.a.underline:Fd.insertionPointFormatting.VY(!Fd.insertionPointFormatting.bJ(ab.a.underline,b.xE));break;case C.a.vpa:Fd.insertionPointFormatting.vpa(l);break;case C.a.superscript:Fd.insertionPointFormatting.UY(!Fd.insertionPointFormatting.bJ(ab.a.superscript,b.isSuperscript));break;case C.a.subscript:Fd.insertionPointFormatting.A6(!Fd.insertionPointFormatting.bJ(ab.a.subscript,
b.cG));break;case C.a.strikethrough:Fd.insertionPointFormatting.TY(!Fd.insertionPointFormatting.bJ(ab.a.strikethrough,b.bG));break;case C.a.nt:Fd.insertionPointFormatting.flb(!Fd.insertionPointFormatting.bJ($c.a.nt,b.U_));break;case C.a.clearFormatting:Fd.insertionPointFormatting.K0a();N.a.instance.ga(54)||(Fd.jq.Tub(c),Fd.paragraphEditor.V1b(c,!0),N.a.instance.ga(71)&&Fd.wP.CMc(c));break;case C.a.lV:l.Ua(ab.a.yt)&&Fd.insertionPointFormatting.lV(l.eb(ab.a.yt)),b=N.a.instance.ga(20)?Ab.a.noProof:ee.a.Bxa,
l.Ua(b)&&Fd.insertionPointFormatting.sml(l.eb(b))}Mg.Obc(a)||Rc.App.Lb.updateCommandUI();return H}I6k(a,b){C.a.clearFormatting===b&&Za.OutlineElementNavigator.vB(a).properties.removeProperty(ab.a.BY)}gQ(a,b,c,f,l){f=Fd.Xc.Zp(C.a.zkl);var y=!0;b.contextId!==yb.a.endOfParagraph&&(y=!1);if(1===c||!y)return y?32:8;c=b.node;b=ob.GraphIterator.pb(b.node);b.kf();y=b.ala(4);if((b=!!y&&Fd.Uf.xea(y))&&!Rc.App.gdb)return 8;const H=!Db.ParagraphReader.textLength(c);f.properties.$("Action",a.toString());f.properties.$("ListContext",
b.toString());f.properties.$("IsEmptyParagraph",H.toString());ka.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",a,b,H);this.Kff.hGh(b)?this.SNh(a,l,y):(b=c.Ta.last,this.I6k(c,a),y=b.formatting,c=Fd.characterPropertiesEditor.w5d(c),this.Kff.eqg(y)&&(c.fe(c.Je),this.gwh(c,a,l,b.cp)));f.end();return 32}SNh(a,b,c){const f=Object(qa.a)(139,b);switch(a){case C.a.sr:Fd.Hea.sr(c,b);break;case C.a.Xq:Fd.Hea.Xq(c,f.zd);break;case C.a.zW:Fd.Hea.zW(c);break;
case C.a.mH:Fd.Hea.mH(c);break;case C.a.bI:Fd.Hea.bI(c);break;case C.a.font:Fd.Hea.Ykl(c,f.zd);break;case C.a.bold:a=this.sMb(b,ab.a.bold,c);Fd.Hea.$H(c,a);break;case C.a.setItalic:a=this.sMb(b,ab.a.italic,c);Fd.Hea.setItalic(c,a);break;case C.a.subscript:a=this.sMb(b,ab.a.subscript,c);Fd.Hea.A6(c,a);break;case C.a.superscript:a=this.sMb(b,ab.a.superscript,c);Fd.Hea.UY(c,a);break;case C.a.strikethrough:a=this.sMb(b,ab.a.strikethrough,c);Fd.Hea.TY(c,a);break;case C.a.nt:a=this.sMb(b,$c.a.nt,c),Fd.Hea.flb(c,
a)}}sMb(a,b,c){2===a.value&&(a.value=c?c.sa(b,!1)?0:1:0);return 1===a.value}Pca(a,b,c,f,l){f=!0;const y=ob.GraphIterator.pb(b.node);y.kf();b.contextId===yb.a.endOfParagraph&&y.ala(4)||(Fd.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.Rre}),f=!1);b=y.currentNode;if(!Fd.Uf.xea(b))return 8;if(1===c||!f)return f?32:8;this.SNh(a,l,b);return 32}rya(a,b,c,f,l){a=!0;b.contextId!==yb.a.paragraph&&(a=!1);if(1===c&&!a)return 8;c=b.node;-1!==l.Vl?l.Vl!==Db.ParagraphReader.CL(c)&&(l.Vl=0):l.Vl=Db.ParagraphReader.CL(c);N.a.instance.ga(54)&&
(N.a.instance.ga(59)||N.a.instance.ga(34))&&(a=Fd.SM.pyb(c),l.BB?(!l.AXl&&this.wHj(l.BB,a)&&2===l.BB.specialIndentType&&(l.BB.specialIndentType=0),l.BB.IZc===a.IZc&&ah.a.qz(l.BB.dO,a.dO)||(l.BB.dO=Number.MAX_VALUE),l.BB.KZc===a.KZc&&ah.a.qz(l.BB.$zb,a.$zb)||(l.BB.$zb=Number.MAX_VALUE)):l.BB=a,b=Fd.ym.DDf(b.UE),void 0!==b&&null!==b&&(b=b.node,void 0!==b&&null!==b&&(b=UQ.WordSectionNavigator.instance.yJe(b),void 0!==b&&null!==b&&(b=Fd.R$e.fua(b)-(Fd.R$e.fbe(b)+Fd.R$e.gbe(b)+Rc.App.VUl),a.JZc=b-a.dO,
a.HZc=b-a.$zb,l.BB.HZc=Math.min(l.BB.HZc,a.HZc),l.BB.JZc=Math.min(l.BB.JZc,a.JZc)))));if(N.a.instance.ga(54)&&N.a.instance.ga(59)||N.a.instance.ga(84))b=Fd.T8j.VW(c),l.spacing?(l.spacing.beforeSpacing=Fd.gAf(b.beforeSpacing,l.spacing.beforeSpacing),l.spacing.afterSpacing=Fd.gAf(b.afterSpacing,l.spacing.afterSpacing),l.spacing.lineSpacing.unit===b.lineSpacing.unit&&ah.a.qz(l.spacing.lineSpacing.value,b.lineSpacing.value)||(l.spacing.lineSpacing.unit=0,l.spacing.lineSpacing.value=0)):l.spacing=b;b=
new ob.GraphIterator;b.set(c);b.sc(11);if(c=b.Kg(11))l.isRtl=Wd.OutlineElementReader.Gm(c);c=Fd.Uf.Gv(b);b=16;void 0!==c&&null!==c&&(b=c.listType);l.listType=Fd.tej(l.listType,b);l.hU=16===l.listType?null:c;return 32}wHj(a,b){return this.XCf(a,b)||this.XCf(b,a)}XCf(a,b){return(1===a.specialIndentType||0===a.specialIndentType)&&2===b.specialIndentType}fWk(a,b,c,f,l){a=Za.OutlineElementNavigator.vB(b.node);l.isRtl=Wd.OutlineElementReader.Gm(a);return 32}GCf(a,b,c){if(a===C.a.F1a)a=!0;else if(a===C.a.WLa)a=
!1;else return 2;a&&this.Dse(b);if(1===c)return 32;b=Za.OutlineElementNavigator.vB(b.node);Fd.Wh.SLa(b,a);return 32}YVk(a,b,c,f,l){a=b.node;b=Za.OutlineElementNavigator.vB(a);l.isRtl=Wd.OutlineElementReader.isRtl(b);l.Vl=ba.ImageReader.CL(a);return 32}NWk(a,b,c,f,l){a=b.node;b=Za.OutlineElementNavigator.vB(a);l.isRtl=Wd.OutlineElementReader.isRtl(b);l.Vl=cd.TableReader.CL(a);if(-1===l.Vl||0===l.Vl)l.Vl=l.isRtl?3:1;return 32}FCf(a,b,c){if(!({GF:c}=Mg.oAh(c,b)).returnValue)return c;c=b.node;switch(a){case C.a.WLa:case C.a.F1a:c=
Za.OutlineElementNavigator.vB(c);let f=!0;a===C.a.WLa&&(f=!1);Fd.Wh.SLa(c,f);f&&this.Dse(b)}return 32}IUd(a,b,c,f,l){let y;if(!({GF:y}=Mg.dsl(c,b)).returnValue)return y;const H=b.node;switch(a){case C.a.WLa:Fd.Wh.dOb(H,!1);break;case C.a.F1a:this.Dse(b);Fd.Wh.dOb(H,!0);break;case C.a.lV:y=w.AFrameworkApplication.Ra.ei(b.UE,a,c,!0,f,l),32===y&&Db.ParagraphReader.Fm(b)&&Fd.lpc&&Fd.lpc.jS(H)}return 32}ZAi(a,b,c,f,l){const y={};y[ii.bqa]=6168;y[ii.aqa]=6169;var H=b.view;const Q=new pf.GraphTransaction(1===
c?3:15);Q.ld(H.root);let ia=ii.k6(a,b,c,f,l,y,0),wa=null;H.qp&&(wa=H);H=!0;let Ua=null;wa&&(Ua=wa.Nb.Pa.mb)&&N.a.instance.ga(14)&&(Fd.fj.Hpe(Ua)?(Fd.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.kE}),ia=8,H=!1):1===c&&(ia=32,H=!1));H&&this.V3j(Ua)&&(ia=N.a.instance.ga(54)?ii.k6(C.a.y8a,b,c,f,l,y,12):ii.k6(a,b,c,f,l,y,12));Q.dispose();return ia}YAi(a,b,c){a=!0;b.contextId!==yb.a.paragraph&&b.contextId!==yb.a.Mf?a=!1:N.a.instance.ga(14)&&Fd.fj.kGa(b)&&(Fd.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.kE}),a=!1);if(1===c||!a)return a?
32:8;b=b.node;c=new pf.GraphTransaction(15);c.ld(b);Fd.jq.Tub(b);Fd.paragraphEditor.V1b(b,!0);Fd.wP.CMc(b);c.dispose();return 2}UKb(a,b,c,f,l){a=b.contextId===yb.a.paragraph;if(1===c&&!a)return 8;l.BB||(b=b.node,c=Fd.SM.pyb(b),l.BB=c,c=new ob.GraphIterator,c.set(b),c.sc(11),b=c.Kg(11),l.isRtl=b?Wd.OutlineElementReader.Gm(b):!1);return 32}V3j(a){return!a||Mb.SelectionEditor.Dx(a)||1===a.length&&Mb.SelectionEditor.tk(a.Va)&&!Mb.SelectionEditor.PAb(a.Va)?!1:!0}Dse(a){Fd.Xrf.Fb(a.contextId)||(ka.ULS.sendTraceTag(42276747,
340,50,"RTL Usage : {0}",a.contextId),Fd.Xrf.$(a.contextId,!0))}TTj(a){return a===C.a.t1b||a===C.a.Dub||a===C.a.Eub||a===C.a.o8a||a===C.a.u1b}bMc(a,b){const c=a.node;b=Fd.eFl(c.characterData.substr(a.Sa,a.Mb-a.Sa),b);c.characterData=c.characterData.substr(0,a.Sa)+b+c.characterData.substr(a.Mb);return 32}static get oh(){return Fd.If||(Fd.If=Ib.a.instance.resolve("Box4.IFormattingEditor"))}static get characterPropertiesEditor(){return Fd.mh||(Fd.mh=Ib.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get paragraphEditor(){return Fd.qx||
(Fd.qx=Ib.a.instance.resolve("Box4.IParagraphEditor"))}static get T8j(){return Fd.bPa||(Fd.bPa=Ib.a.instance.resolve("Box4.ILineSpacingHelper"))}static get wP(){return Fd.bL||(Fd.bL=Ib.a.instance.resolve("Box4.Styles.IStyleEditor"))}static get Wh(){return Fd.Ji||(Fd.Ji=Ib.a.instance.resolve("Box4.IOutlineElementEditor"))}static get insertionPointFormatting(){return Fd.Qt||(Fd.Qt=Ib.a.instance.resolve("Box4.IInsertionPointFormatting"))}static get Hea(){return Fd.tqb||(Fd.tqb=Ib.a.instance.resolve("Box4.List.IListFormattingEditor"))}static get SM(){return Fd.OG||
(Fd.OG=Ib.a.instance.resolve("Box4.IParagraphIndentationReader"))}static lr(){return Fd.Sm||(Fd.Sm=Ib.a.instance.Ia("Box4.IExternalSelectionManager"))}static get ym(){return Ch.ContextSetEditor.instance}static get fj(){return bh.a.instance}static get Xc(){return mc.a.instance}static get Be(){return Fd.kd||(Fd.kd=Ib.a.instance.qb("Box4.IFeatureHelper"))}static get lpc(){return Rc.App.oS}static get Xf(){return Fd.hd||(Fd.hd=Ib.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get W6(){return Fd.hp||
(Fd.hp=Ib.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get P5e(){return Fd.jQa||(Fd.jQa=Ib.a.instance.resolve("Box4.TextFormattingHelper"))}static get Uf(){return Fd.fh||(Fd.fh=Ib.a.instance.resolve("Box4.List.IListReader"))}static get jq(){return Fd.fp||(Fd.fp=Ib.a.instance.resolve("Box4.List.IListEditor"))}static get R$e(){return VQ.a.instance}static tej(a,b){return 42===a?b:a!==b||16===a?16:a}static gAf(a,b){a.Xmg||(b.Xmg?b=a:b.unit===a.unit&&ah.a.qz(b.value,
a.value)||(b.value=-1));return b}static eFl(a,b){switch(b){case C.a.Dub:return a.toLowerCase();case C.a.Eub:return a.toUpperCase();case C.a.t1b:case C.a.o8a:return Fd.pyi(a,b===C.a.o8a);case C.a.u1b:return Fd.NGl(a);default:return a}}static NGl(a){let b="";for(let c=0;c<a.length;c++)b=a.charAt(c)===a.charAt(c).toUpperCase()?b+a.charAt(c).toLowerCase():b+a.charAt(c).toUpperCase();return b}static pyi(a,b){let c,f,l=!0,y=a.length,H=0,Q=Fd.eqe(a,H,y);for(;0<y;){f=c=!1;var ia=y;let Ua;var wa=void 0;for(wa=
0;0<ia&&Fd.aAi(a.charAt(H+wa));wa++,ia--)f=Fd.S2c(a.charAt(H+wa));for(Ua=wa;0<ia&&!(c=Fd.S2c(a.charAt(H+wa)))&&" "!==a.charAt(H+wa)&&"/"!==a.charAt(H+wa);wa++,ia--);ia=wa-Ua;if(0>=ia)break;H+=Ua;wa=a.substr(H,ia);wa=wa===wa.toUpperCase();if(Q||!wa)a=l||f||b?a.substr(0,H)+a.charAt(H).toUpperCase()+a.substr(H+1,ia-1).toLowerCase()+a.substr(H+ia):a.substr(0,H)+a.substr(H,ia).toLowerCase()+a.substr(H+ia);y-=ia+Ua;H+=ia;if(l=c)H++,y--,Q=Fd.eqe(a,H,y)}return a}static eqe(a,b,c){for(;0<c&&!Fd.S2c(a.charAt(b));){if(a.charAt(b)!==
a.charAt(b).toUpperCase())return!1;b++;c--}return!0}static Q3j(a){for(var b=0;b<a.length&&!Fd.S2c(a.charAt(b));){if(a.charAt(b)!==a.charAt(b).toLowerCase())return!1;b++}return!0}static S2c(a){return"."===a||"!"===a||"?"===a?!0:!1}static aAi(a){return-1==="0123456789".indexOf(a)&&a.toUpperCase()===a.toLowerCase()}}Fd.If=null;Fd.Ji=null;Fd.Xrf=new ul.a;Fd.Pf=null;Fd.bPa=null;Fd.mh=null;Fd.qx=null;Fd.bL=null;Fd.Qt=null;Fd.tqb=null;Fd.OG=null;Fd.Sm=null;Fd.kd=null;Fd.hd=null;Fd.hp=null;Fd.jQa=null;Fd.fh=
null;Fd.fp=null;Object(m.a)(Fd,"TextFormattingActor",null,[]);class XI{constructor(a){this.Ca=a}get qn(){return this.Ca}DNb(a,b=!1){this.qn.ei(a,C.a.Obb,2,!0,null,b)}lV(a){this.qn.Ka(C.a.lV,2,a)}}Object(m.a)(XI,"TextFormattingCommands",null,[1253]);class nu{get bqa(){return ii.bqa}get aqa(){return ii.aqa}get zRb(){return ii.zRb}k6(a,b,c,f,l,y,H){return ii.k6(a,b,c,f,l,y,H)}Oib(a,b,c,f,l,y){return ii.Oib(a,b,c,f,l,y)}static get instance(){nu.La||(nu.La=new nu);return nu.La}}nu.La=null;Object(m.a)(nu,
"ViewActionHandlerProxy",null,[1277]);class YI{constructor(a){this.Ca=a}get qn(){return this.Ca}Mwk(a){if(4===a)a=C.a.leftArrow;else if(2===a)a=C.a.rightArrow;else if(1===a)a=C.a.upArrow;else if(3===a)a=C.a.downArrow;else return;this.qn.processAction(a,2)}pta(){this.qn.processAction(C.a.pta,2)}}Object(m.a)(YI,"SelectionCommands",null,[1252]);class ZI{Qg(a,b){return Od.SelectionFactory.Qg(a,b)}WN(a,b){return Od.SelectionFactory.WN(a,b)}Mu(a,b=!0){return Od.SelectionFactory.Mu(a,b)}D3(a,b,c){return Od.SelectionFactory.D3(a,
b,c)}nl(a){return Od.SelectionFactory.nl(a)}EQb(a,b,c=!1){return Od.SelectionFactory.EQb(a,b,c)}}Object(m.a)(ZI,"SelectionFactoryProxy",null,[1240]);var WQ=d(898),Bx=d(250),pz=d(1036);class $I extends pz.a{constructor(a,b,c,f,l,y,H=null,Q=null){super(a,y,H,Q);this.Ao=this.qx=this.O2=null;this.Jqa=!1;this.v4a=w.AFrameworkApplication.fa.ka("FollowDestinationFormattingPasteIsEnabled");this.A5a=0;this.JPd=new Na.a;We.a(8128527,307,Wd.OutlineElementReader.ih(a));this.DF=b;this.DF.Ktb(this);this.zGd=c;
this.fp=f;this.fh=l;this.pOk=Q;this.QLd=Zb.ListReader.Hk(this.zb)}get s9(){return this.O2||(this.O2=Ib.a.instance.qb("Box4.IInternalLinkManager"))}get paragraphEditor(){return this.qx||(this.qx=Ib.a.instance.resolve("Box4.IParagraphEditor"))}get hSa(){return null}get S8a(){return this.QLd&&!this.DF.sda}get g9a(){return 0<this.A5a}get Jv(){return this.zGd}get jq(){return this.fp}get Uf(){return this.fh}get SKc(){return this.pOk}m1(a,b){if(!this.vZ.N7e(b)){We.a(8701077,307,Db.ParagraphReader.ql(this.zb));
var c=this.zb.currentNode,f=cb.a.YRa(c);this.v4a&&this.Ao.u$a&&(c=c.Ta.last,this.Jqa&&(c.formatting=this.Ao.u$a.fe(c),this.Jqa=!1),a=this.vZ.ife(a,b),this.vZ.rpa(this.zb.currentNode,this.Ao.nga,b));this.characterPropertiesEditor.replaceTextRange(f,a)}}ooa(){We.a(8701078,307,Db.ParagraphReader.ql(this.zb));const a=cb.a.YRa(this.zb.currentNode);this.characterPropertiesEditor.a_c(a,b=>new Gv.a(b,Gv.a.sPc),kf.AParagraphNode.w_)}u_a(){}moa(){this.v4a&&(this.Jqa=!0)}Gxa(){We.a(8701079,307,Db.ParagraphReader.ql(this.zb))}Fxa(){We.a(8701080,
307,Db.ParagraphReader.ql(this.zb))}NA(a){this.DF.sda||(this.v4a?(this.uUd(a),this.Ao.exd(this.zb.currentNode),a&&"P"===a.TU.j$b&&this.SKc.QLa(this.zb.currentNode,this.Ao.Gkd),this.vZ.rpa(this.zb.currentNode,this.Ao.nga,a)):this.jpi(a))}MA(){this.DF.sda||this.N3()}Lxa(){}YJa(){}roa(){We.a(8701081,307,Wd.OutlineElementReader.ih(this.zb)||gj.OutlineReader.ku(this.zb)||Db.ParagraphReader.ql(this.zb)&&this.DF.sda);let a=!1;this.g9a||(a=this.S8a||!0);a||(this.UM+=1);this.A5a++}poa(){this.A5a--;let a=!1;
this.g9a||(a=this.S8a||!0);a||--this.UM}Kxa(a){We.a(8701082,307,Wd.OutlineElementReader.ih(this.zb)||gj.OutlineReader.ku(this.zb)||Db.ParagraphReader.ql(this.zb)&&this.DF.sda);We.a(8701083,307,0!==a.listStyleType)}qoa(){We.a(8701084,307,Wd.OutlineElementReader.ih(this.zb)||Db.ParagraphReader.ql(this.zb)&&this.DF.sda);this.DF.sda||We.a(8701085,307,this.zb.gJ(2))}zY(a){this.DF.zY(a)}wY(){this.DF.wY()}Rwd(a){this.JPd.add(a)}yY(a){this.DF.yY(a)}xY(){this.DF.xY()}vY(a){this.DF.vY(a)}uY(){this.DF.uY()}jpi(a){this.eIb(!1);
(new ob.GraphIterator).Tc(this.zb);a=pz.a.Wh.nda(this.zb,this.cUa(a));We.a(8128534,307,a===this.zb.currentNode);We.a(8128535,307,Db.ParagraphReader.ae(a))}N3(){We.a(8128536,307,Db.ParagraphReader.ql(this.zb));Za.OutlineElementNavigator.Te(this.zb)}reset(){this.v4a&&(super.reset(),this.Ao=this.s$d(!0))}uUd(a){this.eIb(!1);(new ob.GraphIterator).Tc(this.zb);a=pz.a.Wh.nda(this.zb,this.cUa(a));We.a(36577367,307,a===this.zb.currentNode);We.a(36577368,307,Db.ParagraphReader.ae(a));-1!==this.Ao.yE&&this.paragraphEditor.nK(a,
this.Ao.yE);this.Ao.lineSpacing&&this.SKc.R1(a,this.Ao.lineSpacing);this.Ao.Sga&&this.SKc.lyh(a,this.Ao.Sga);this.Ao.B4c&&this.SKc.axh(a,this.Ao.B4c);this.Jqa=!0;this.Ao.paragraph=a}static X_d(a,b){let c=0;switch(b){case 3:c=xe.a.Aua(a);break;case 7:c=Fb.a.qga(a,0);break;case 1:c=xe.a.hYd(a);break;case 5:c=xe.a.Aua(xe.a.Gld(a));break;default:ka.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",a,b)}return c}}Object(m.a)($I,"TextOnlyBox4PasteSteward",
pz.a,[]);class CC{constructor(a,b,c,f){this.eXb=a;this.fp=b;this.fh=c;this.vZ=f}create(a,b,c,f,l=null,y=null){return 1===a?new $I(b,f,this.eXb,this.fp,this.fh,l,y,this.vZ):new Bx.Box4PasteSteward(b,c,f,this.eXb,this.fp,this.fh,l,y,this.vZ)}}Object(m.a)(CC,"Box4PasteStewardFactory",null,[1275]);class Wg{static get xJj(){return Wg.MZh}static get DJj(){return Wg.PZh}static get CJj(){return Wg.OZh}static pUk(a,b){const c=a.currentNode;Sd.forEachCell(a,b.rowSpan,b.colSpan,(f,l,y)=>{const H=f.currentNode;
H!==c&&(H.isGhostCell=!0,Wg.VSf(f),!y&&1<=b.colSpan&&(H.colSpan=b.colSpan),Wg.Gwh(f,b.M6,l,y,b.rowSpan,b.colSpan))})}static JUk(a,b){Sd.forEachCell(a,b.rowSpan,b.colSpan,c=>{Wg.qmi(c);Wg.VSf(c)})}static qmi(a){a=a.currentNode;a.isGhostCell=!0;a.isSkippedCell=!0;a.Jlb=!0}static VSf(a){a&&(a.Cb(1),Object(Wa.a)(yI.a,a.currentNode)&&a.Ni())}static Hmi(a,b,c){0<b&&(a=Object(qa.a)(Ax.TableCellNode,a.currentNode))&&(a.width=c?b:Fb.a.gf(b,0))}static Rli(a,b,c){if(a=Object(qa.a)(Dy.a,a.currentNode))0<b&&(a.nm=
Fb.a.qga(b,0)),0<c&&(a.CY=Fb.a.qga(c,0))}static JCf(a,b){void 0!==b&&null!==b&&a.currentNode.properties.setValue(Ab.a.b5e,Wg.DJj[b+""])}static vCf(a,b){void 0!==b&&null!==b&&""!==b&&a.currentNode.properties.setValue(ab.a.$Lc,parseInt(Bx.Box4PasteSteward.U8a(b),16))}static hwj(a){const b=new ob.GraphIterator;b.Tc(a);return(a=xg.OutlineNavigator.cqd(b))&&gj.OutlineReader.ku(b)?a.Rh(Ab.a.TR)-a.Rh(Ab.a.marginLeft)-a.Rh(Ab.a.marginRight):0}static Q1j(a){return!(void 0===a||null===a||1===a)}static tjl(a,
b,c,f,l){if(void 0===b||null===b||""!==b){switch(b){case "thin":b=xe.a.Fld(.25);break;case "initial":case "medium":b=xe.a.Fld(.5);break;case "thick":b=xe.a.Fld(1);break;default:b=Wg.mtj(b,c,f)}l.currentNode.properties.setValue(a,b)}}static wZe(a,b,c){void 0!==b&&null!==b&&0!==b&&c.currentNode.properties.setValue(a,Wg.CJj[b+""])}static sjl(a,b,c){void 0!==b&&null!==b&&""!==b&&c.currentNode.properties.setValue(a,parseInt(Bx.Box4PasteSteward.U8a(b),16))}static mtj(a,b,c){let f=0;const l=({unit:a}=Bx.Box4PasteSteward.Qkd(a)).returnValue;
switch(a){case 5:f=xe.a.Fld(l);break;case 1:f=xe.a.Zxi(l);break;case 3:f=xe.a.fjg(l);break;case 7:f=Fb.a.JOk(l,c)}if(6===b||7===b||10===b)f/=3;return Math.round(f)}static ntj(a,b){let c=0;const f=({unit:a}=Bx.Box4PasteSteward.Qkd(a)).returnValue;switch(a){case 5:c=xe.a.RH(f);break;case 1:c=xe.a.$xi(f);break;case 3:c=xe.a.ZW(f);break;case 7:c=Fb.a.gf(f,b)}return c}static Yrd(a,b,c,f,l,y,H){if(l&&(!H||16===l.Bi||H||14!==l.Bi)&&12!==c){if(H)switch(f){case 7:f=Ab.a.$Gh;var Q=Ab.a.bHh;var ia=Ab.a.aHh;
var wa=0;break;case 6:f=Ab.a.XGh;Q=Ab.a.ZGh;ia=Ab.a.YGh;wa=1;break;case 0:f=Ab.a.NGh;Q=Ab.a.PGh;ia=Ab.a.OGh;wa=0;break;case 5:f=Ab.a.UGh;Q=Ab.a.WGh;ia=Ab.a.VGh;wa=1;break;default:return}else switch(f){case 7:f=Ab.a.KDl;Q=Ab.a.MDl;ia=Ab.a.LDl;wa=0;break;case 6:f=Ab.a.HDl;Q=Ab.a.JDl;ia=Ab.a.IDl;wa=1;break;case 0:f=Ab.a.BDl;Q=Ab.a.DDl;ia=Ab.a.CDl;wa=0;break;case 5:f=Ab.a.EDl;Q=Ab.a.GDl;ia=Ab.a.FDl;wa=1;break;default:return}void 0!==l.currentNode&&null!==l.currentNode&&(Wg.Q1j(c)?(Wg.sjl(f,a,l),Wg.wZe(Q,
c,l),Wg.tjl(ia,b,c,wa,l)):y||H||l.currentNode.properties.setValue(Q,"nil"))}}static Gwh(a,b,c,f,l,y){f||(Wg.pCf(b,a,!1,!1),Wg.LUd(b,a,!0,!1));f===y-1&&Wg.LUd(b,a,!0,!1);c||Wg.HCf(b,a,!0,!1);c===l-1&&Wg.jCf(b,a,!0,!1)}static hCf(a,b,c,f){a&&(Wg.HCf(a,b,c,f),Wg.LUd(a,b,c,f),Wg.jCf(a,b,c,f),Wg.pCf(a,b,c,f))}static HCf(a,b,c,f){Wg.Yrd(a.borderTopColor,a.borderTopWidth,a.borderTopStyle,7,b,c,f)}static LUd(a,b,c,f){Wg.Yrd(a.borderRightColor,a.borderRightWidth,a.borderRightStyle,6,b,c,f)}static jCf(a,b,
c,f){Wg.Yrd(a.borderBottomColor,a.borderBottomWidth,a.borderBottomStyle,0,b,c,f)}static pCf(a,b,c,f){Wg.Yrd(a.borderLeftColor,a.borderLeftWidth,a.borderLeftStyle,5,b,c,f)}static Zrd(a,b,c){if(c&&16===c.Bi&&""!==a){switch(b){case 3:b=Ab.a.KPb;var f=0;break;case 2:b=Ab.a.JPb;f=1;break;case 0:b=Ab.a.GPb;f=0;break;case 1:b=Ab.a.HPb;f=1;break;default:return}(a=Wg.ntj(a,f))&&c.currentNode.properties.setValue(b,a)}}static Bli(a,b){b&&(Wg.Cmi(b,a),Wg.jmi(b,a),Wg.Cli(b,a),Wg.Xli(b,a))}static Cmi(a,b){Wg.Zrd(a.Uxi,
3,b)}static jmi(a,b){Wg.Zrd(a.Txi,2,b)}static Cli(a,b){Wg.Zrd(a.Rxi,0,b)}static Xli(a,b){Wg.Zrd(a.Sxi,1,b)}}Wg.Dxk=8;Wg.VRi="Table Grid";Wg.MZh=ta.a.eI("MsoNormalTable","Normal Table","MsoTableGrid",Wg.VRi,"MsoTableGridLight","Grid Table Light","MsoTable15Plain1","Plain Table 1","MsoTable15Plain2","Plain Table 2","MsoTable15Plain3","Plain Table 3","MsoTable15Plain4","Plain Table 4","MsoTable15Plain5","Plain Table 5","MsoTable15Grid1Light","Grid Table 1 Light","MsoTable15Grid1LightAccent1","Grid Table 1 Light Accent 1",
"MsoTable15Grid1LightAccent2","Grid Table 1 Light Accent 2","MsoTable15Grid1LightAccent3","Grid Table 1 Light Accent 3","MsoTable15Grid1LightAccent4","Grid Table 1 Light Accent 4","MsoTable15Grid1LightAccent5","Grid Table 1 Light Accent 5","MsoTable15Grid1LightAccent6","Grid Table 1 Light Accent 6","MsoTable15Grid2","Grid Table 2","MsoTable15Grid2Accent1","Grid Table 2 Accent 1","MsoTable15Grid2Accent2","Grid Table 2 Accent 2","MsoTable15Grid2Accent3","Grid Table 2 Accent 3","MsoTable15Grid2Accent4",
"Grid Table 2 Accent 4","MsoTable15Grid2Accent5","Grid Table 2 Accent 5","MsoTable15Grid2Accent6","Grid Table 2 Accent 6","MsoTable15Grid3","Grid Table 3","MsoTable15Grid3Accent1","Grid Table 3 Accent 1","MsoTable15Grid3Accent2","Grid Table 3 Accent 2","MsoTable15Grid3Accent3","Grid Table 3 Accent 3","MsoTable15Grid3Accent4","Grid Table 3 Accent 4","MsoTable15Grid3Accent5","Grid Table 3 Accent 5","MsoTable15Grid3Accent6","Grid Table 3 Accent 6","MsoTable15Grid4","Grid Table 4","MsoTable15Grid4Accent1",
"Grid Table 4 Accent 1","MsoTable15Grid4Accent2","Grid Table 4 Accent 2","MsoTable15Grid4Accent3","Grid Table 4 Accent 3","MsoTable15Grid4Accent4","Grid Table 4 Accent 4","MsoTable15Grid4Accent5","Grid Table 4 Accent 5","MsoTable15Grid4Accent6","Grid Table 4 Accent 6","MsoTable15Grid5Dark","Grid Table 5 Dark","MsoTable15Grid5DarkAccent1","Grid Table 5 Dark Accent 1","MsoTable15Grid5DarkAccent2","Grid Table 5 Dark Accent 2","MsoTable15Grid5DarkAccent3","Grid Table 5 Dark Accent 3","MsoTable15Grid5DarkAccent4",
"Grid Table 5 Dark Accent 4","MsoTable15Grid5DarkAccent5","Grid Table 5 Dark Accent 5","MsoTable15Grid5DarkAccent6","Grid Table 5 Dark Accent 6","MsoTable15Grid6Colorful","Grid Table 6 Colorful","MsoTable15Grid6ColorfulAccent1","Grid Table 6 Colorful Accent 1","MsoTable15Grid6ColorfulAccent2","Grid Table 6 Colorful Accent 2","MsoTable15Grid6ColorfulAccent3","Grid Table 6 Colorful Accent 3","MsoTable15Grid6ColorfulAccent4","Grid Table 6 Colorful Accent 4","MsoTable15Grid6ColorfulAccent5","Grid Table 6 Colorful Accent 5",
"MsoTable15Grid6ColorfulAccent6","Grid Table 6 Colorful Accent 6","MsoTable15Grid7Colorful","Grid Table 7 Colorful","MsoTable15Grid7ColorfulAccent1","Grid Table 7 Colorful Accent 1","MsoTable15Grid7ColorfulAccent2","Grid Table 7 Colorful Accent 2","MsoTable15Grid7ColorfulAccent3","Grid Table 7 Colorful Accent 3","MsoTable15Grid7ColorfulAccent4","Grid Table 7 Colorful Accent 4","MsoTable15Grid7ColorfulAccent5","Grid Table 7 Colorful Accent 5","MsoTable15Grid7ColorfulAccent6","Grid Table 7 Colorful Accent 6",
"MsoTable15List1Light","List Table 1 Light","MsoTable15List1LightAccent1","List Table 1 Light Accent 1","MsoTable15List1LightAccent2","List Table 1 Light Accent 2","MsoTable15List1LightAccent3","List Table 1 Light Accent 3","MsoTable15List1LightAccent4","List Table 1 Light Accent 4","MsoTable15List1LightAccent5","List Table 1 Light Accent 5","MsoTable15List1LightAccent6","List Table 1 Light Accent 6","MsoTable15List2","List Table 2","MsoTable15List2Accent1","List Table 2 Accent 1","MsoTable15List2Accent2",
"List Table 2 Accent 2","MsoTable15List2Accent3","List Table 2 Accent 3","MsoTable15List2Accent4","List Table 2 Accent 4","MsoTable15List2Accent5","List Table 2 Accent 5","MsoTable15List2Accent6","List Table 2 Accent 6","MsoTable15List3","List Table 3","MsoTable15List3Accent1","List Table 3 Accent 1","MsoTable15List3Accent2","List Table 3 Accent 2","MsoTable15List3Accent3","List Table 3 Accent 3","MsoTable15List3Accent4","List Table 3 Accent 4","MsoTable15List3Accent5","List Table 3 Accent 5","MsoTable15List3Accent6",
"List Table 3 Accent 6","MsoTable15List4","List Table 4","MsoTable15List4Accent1","List Table 4 Accent 1","MsoTable15List4Accent2","List Table 4 Accent 2","MsoTable15List4Accent3","List Table 4 Accent 3","MsoTable15List4Accent4","List Table 4 Accent 4","MsoTable15List4Accent5","List Table 4 Accent 5","MsoTable15List4Accent6","List Table 4 Accent 6","MsoTable15List5Dark","List Table 5 Dark","MsoTable15List5DarkAccent1","List Table 5 Dark Accent 1","MsoTable15List5DarkAccent2","List Table 5 Dark Accent 2",
"MsoTable15List5DarkAccent3","List Table 5 Dark Accent 3","MsoTable15List5DarkAccent4","List Table 5 Dark Accent 4","MsoTable15List5DarkAccent5","List Table 5 Dark Accent 5","MsoTable15List5DarkAccent6","List Table 5 Dark Accent 6","MsoTable15List6Colorful","List Table 6 Colorful","MsoTable15List6ColorfulAccent1","List Table 6 Colorful Accent 1","MsoTable15List6ColorfulAccent2","List Table 6 Colorful Accent 2","MsoTable15List6ColorfulAccent3","List Table 6 Colorful Accent 3","MsoTable15List6ColorfulAccent4",
"List Table 6 Colorful Accent 4","MsoTable15List6ColorfulAccent5","List Table 6 Colorful Accent 5","MsoTable15List6ColorfulAccent6","List Table 6 Colorful Accent 6","MsoTable15List7Colorful","List Table 7 Colorful","MsoTable15List7ColorfulAccent1","List Table 7 Colorful Accent 1","MsoTable15List7ColorfulAccent2","List Table 7 Colorful Accent 2","MsoTable15List7ColorfulAccent3","List Table 7 Colorful Accent 3","MsoTable15List7ColorfulAccent4","List Table 7 Colorful Accent 4","MsoTable15List7ColorfulAccent5",
"List Table 7 Colorful Accent 5","MsoTable15List7ColorfulAccent6","List Table 7 Colorful Accent 6");Wg.PZh=ta.a.eI("0","center","1","top","2","center","3","bottom");Wg.OZh=ta.a.eI("0","nil","1","none","2","nil","3","single","5","dotted","4","dashed","11","single","6","double","7","double","10","double","8","inset","9","outset");Object(m.a)(Wg,"Box4TableStewardHelper",null,[]);class Cx{constructor(a,b,c,f=!1,l=!1,y=!1){this.iw=null;this.B5a=0;this.zb=a;this.jq=b;this.Yq=c;this.Wrb=f;this.oXb=l;this.NLd=
y}Ktb(a){this.iw=a}get sda(){return 0<this.B5a}zY(a){We.a(7869459,307,!!this.iw);We.a(7869460,307,Wd.OutlineElementReader.ih(this.zb)||gj.OutlineReader.ku(this.zb));We.c(38563978,307,50,"Table pasting started");this.iw.eIb(!0);const b=new ob.GraphIterator;b.Tc(this.zb);Object(qa.a)(String,Wg.xJj[a.QFh]);const c=this.Yq.B1k(this.zb,a.dV,a.Bsa,this.iw.cUa(a),a.rmg);if(this.Wrb&&(We.c(23938568,307,50,a.KRa?"Table-widths exist":"Table-widths missing, table may be invalid"),a.Z4e&&Wg.hCf(a.Z4e,this.zb,
!1,!0),Wg.Rli(this.zb,a.Ihe.zzl,a.Ihe.yzl),a.KRa)){var f=0;const Q=Array(a.KRa.length);var l=0;a.pGa&&N.a.instance.ga(63)&&(l=(l=xe.a.FLh(Wg.hwj(this.zb)))?l:1);for(var y=0;y<a.KRa.length;y++)Q[y]=0<l?l/100*a.KRa[y]:Fb.a.gf(a.KRa[y],0),f+=Q[y];l=c.eb(ab.a.ev);var H=new ob.GraphIterator;H.Tc(this.zb);a=0;if(ae.isInTableCell(H)){if(l=Sd.returnToContainingCell(H))a=l.width;y=Qn.a(H);H=Sd.returnToContainingTable(H);if(-1!==y&&y<=H.NRa.length){let ia=0;for(let wa=y;wa<y+l.colSpan&&wa<H.NRa.length;wa++)ia+=
H.NRa[wa];a=Math.min(a,ia);a===ia&&(a-=Fb.a.gf(Wg.Dxk,0))}}else if(l)for(y=0;y<l.length;y++)a+=l[y];if(0<a&&f>a&&f)for(f=a/f,a=0;a<Q.length;a++)Q[a]*=f;c.setValue(ab.a.ev,Q)}this.iw.hKc(b,!1);this.B5a++;N.a.instance.ga(63)&&Zb.ListReader.Hk(b)&&this.iw.Rwd(b.currentNode);We.a(7869461,307,cd.TableReader.iq(this.zb))}wY(){We.a(7869462,307,!!this.iw);We.a(7869463,307,vk.l(this.zb));We.c(38563979,307,50,"Table pasting finished");Za.OutlineElementNavigator.Te(this.zb);this.B5a--}yY(a){We.a(7869464,307,
!!this.iw);cd.TableReader.iq(this.zb)?Sd.moveToFirstRow(this.zb):vk.l(this.zb)&&Sd.moveToNextRow(this.zb);this.Wrb&&a.height&&this.zb.currentNode.setValue(Ab.a.Fu,Fb.a.gf(a.height,1));We.a(7869465,307,vk.l(this.zb))}xY(){We.a(7869466,307,!!this.iw);We.a(7869467,307,ae.isTableCell(this.zb));Sd.returnToContainingRow(this.zb)}vY(a){We.a(7869468,307,!!this.iw);We.a(7869469,307,!this.iw.UM);vk.l(this.zb)?Sd.moveToFirstColumn(this.zb):ae.isTableCell(this.zb)?Sd.moveToNextColumn(this.zb):We.a(7869471,307,
!1);w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings");if(this.oXb){if(!this.zb.currentNode)return;var b=Object(qa.a)(Ax.TableCellNode,this.zb.currentNode);We.a(50689760,307,!b&&16!==this.zb.currentNode.type||!!b&&16===this.zb.currentNode.type);if(!b)return;let c=new ob.GraphIterator;c.Tc(this.zb);if(!a.colSpan||!a.rowSpan)return;if(a.NBb){Wg.JUk(c,a);return}if(1<a.colSpan||1<a.rowSpan){const f=Sd.returnToContainingTable(c);if(!f)return;f.setValue(Ab.a.complexTable,
!0);c.Tc(this.zb);Wg.pUk(c,a);b.rowSpan=a.rowSpan;b.colSpan=a.colSpan}}this.Wrb&&(Wg.vCf(this.zb,a.ntc),Wg.JCf(this.zb,a.verticalAlignment),this.NLd&&Wg.Bli(this.zb,a.Hvd));this.oXb&&Wg.hCf(a.M6,this.zb,!a.colSpan&&!a.rowSpan,!1);this.Wrb&&(this.oXb||(b=new ob.GraphIterator,b.Tc(this.zb),Sd.forEachCell(b,a.rowSpan,a.colSpan,(c,f,l)=>{Wg.vCf(c,a.ntc);Wg.JCf(c,a.verticalAlignment);Wg.Gwh(c,a.M6,f,l,a.rowSpan,a.colSpan)})),Wg.Hmi(this.zb,a.width,a.pGa));We.a(7869472,307,gj.OutlineReader.ku(this.zb))}uY(){We.a(7869473,
307,!!this.iw);We.a(7869474,307,Wd.OutlineElementReader.ih(this.zb)||ae.isTableCell(this.zb));Sd.returnToCell(this.zb);We.a(7869475,307,0>=this.iw.UM);this.iw.YYd()}static get Wh(){return Cx.Ji||(Cx.Ji=Ib.a.instance.resolve("Box4.IOutlineElementEditor"))}}Cx.Ji=null;Object(m.a)(Cx,"Box4TableSteward",null,[479,480]);class ou{constructor(a,b,c){this.iw=null;this.B5a=0;this.zb=a;this.jq=b;this.Yq=c}Ktb(a){this.iw=a}get sda(){return 0<this.B5a}zY(){this.sda&&(We.a(8787101,307,Db.ParagraphReader.ql(this.zb)),
Za.OutlineElementNavigator.Te(this.zb));We.a(8701086,307,!!this.iw);We.a(8701087,307,Wd.OutlineElementReader.ih(this.zb)||gj.OutlineReader.ku(this.zb));this.B5a++}wY(){We.a(8701088,307,!!this.iw);Za.OutlineElementNavigator.Te(this.zb);this.B5a--;if(this.sda){this.iw.eIb(!0);const a=ou.Wh.nda(this.zb);We.a(8787102,307,a===this.zb.currentNode);We.a(8787103,307,Db.ParagraphReader.ql(this.zb))}}yY(a){We.a(8701089,307,!!this.iw);this.iw.eIb(!0);const b=new ob.GraphIterator;b.Tc(this.zb);this.iw.hKc(b,
!1);N.a.instance.ga(63)&&Zb.ListReader.Hk(b)&&this.iw.Rwd(b.currentNode);a=ou.Wh.nda(this.zb,this.iw.cUa(a));We.a(8701090,307,a===this.zb.currentNode);We.a(8701091,307,Db.ParagraphReader.ql(this.zb))}xY(){We.a(8701120,307,!!this.iw);We.a(8701121,307,Db.ParagraphReader.ql(this.zb));Za.OutlineElementNavigator.Te(this.zb)}vY(){We.a(8701122,307,!!this.iw);We.a(8701123,307,Db.ParagraphReader.ql(this.zb));We.a(8701124,307,!this.iw.UM);var a=this.zb.currentNode;Db.ParagraphReader.textLength(a)&&(a=cb.a.YRa(a),
this.iw.characterPropertiesEditor.replaceTextRange(a,", "))}uY(){We.a(8701125,307,!!this.iw);We.a(8701126,307,Db.ParagraphReader.ql(this.zb));We.a(8701127,307,0>=this.iw.UM);this.iw.YYd()}static get Wh(){return ou.Ji||(ou.Ji=Ib.a.instance.resolve("Box4.IOutlineElementEditor"))}}ou.Ji=null;Object(m.a)(ou,"TextOnlyBox4TableSteward",null,[479,480]);class DC{constructor(a,b,c=!1,f=!1,l=!1){this.fp=a;this.bE=b;this.Wrb=c;this.oXb=f;this.NLd=l}create(a,b){return 1===a?new ou(b,this.fp,this.bE):new Cx(b,
this.fp,this.bE,this.Wrb,this.oXb,this.NLd)}}Object(m.a)(DC,"Box4TableStewardFactory",null,[462]);class aJ{create(){return new Cn.a}}Object(m.a)(aJ,"Factory",null,[1241]);var EC=d(1111);class bJ{constructor(){this.ild=null;this.vOe=0}}Object(m.a)(bJ,"PasteFloatieAnchorData",null,[]);class cJ extends Us{constructor(a,b){super(a,b)}T6b(){return["PasteText"]}}Object(m.a)(cJ,"PasteTextFloatie",Us,[]);class dJ{constructor(a,b,c,f,l,y,H){this.CLg=0;this.PBe=this.gYa=this.Ied=!1;this.Wfk=100;this.gui=61;
this.hvi="PasteTextControl";this.Xui='[id*="PasteTextFloatie"]';this.Uui=86;this.Svl=(Q,ia)=>{this.pz()&&this.showFloatie(ia)};this.RUi=(Q,ia)=>{this.lE(ia)};this.U0i=()=>{this.XYf()};this.nOl=(Q,ia)=>{(null===ia||void 0===ia?0:ia.Ttc)&&this.wNh()};this.B8g=()=>{EC.a.instance.keyCode===B.a.Dba&&this.XYf()};this.G1=()=>{!this.gYa&&this.W4&&this.W4.isVisible&&this.bRi()};this.onSelectionChange=()=>{this.S_()||this.lE(new zd(!0))};this.K=a;this.wA=b;this.Grk=c;this.rbd=f;this.pa=l;this.ccd=y;this.Tb=
H}get vH(){return this.CLg}set vH(a){this.CLg=a}get Sua(){return!this.gYa&&this.W4&&this.W4.isVisible}G4k(){this.rbd.khi(this.Svl);this.rbd.rgi(this.RUi);this.rbd.xgi(this.U0i);this.rbd.Qgi(this.nOl)}H4k(){this.Ied||(this.pa.fE(this.onSelectionChange),this.Tb.aq.Nca(this.G1),this.ccd.kTd(this.B8g),this.Ied=!0)}pMl(){this.Ied&&(this.pa.GVe(this.onSelectionChange),this.Tb.aq.iLa(this.G1),this.ccd.f8k(this.B8g),this.Ied=!1)}b6(a){2===a.behavior&&(a=a.actionId,a===C.a.bold||a===C.a.centerJustify||a===
C.a.sr||a===C.a.Q1||a===C.a.Gja||a===C.a.setItalic||a===C.a.leftJustify||a===C.a.Xq||a===C.a.bI||a===C.a.mH||a===C.a.strikethrough||a===C.a.rightJustify||a===C.a.fullJustify||a===C.a.underline||a===C.a.My||a===C.a.TC||a===C.a.iN||a===C.a.zP||a===C.a.subscript||a===C.a.superscript||a===C.a.font||a===C.a.paste||a===C.a.j6)&&(this.Tb.aq.Ene||this.lE(new zd(!0)))}a6(){}showFloatie(a){this.W4||(this.W4=new cJ(this.K.resolve("Common.IReactContextualUILauncher"),this.K.resolve("Common.IExternalUICommandDefinitionMapping")));
if((this.gYa||!this.W4.isVisible)&&a){var b=a.location?a.location:this.kyb();b&&(this.W4.Q1e(b,a.Pu),this.H4k(),this.gYa=!1)}}lE(a){this.W4&&(!this.gYa||this.W4.isVisible)&&a&&(this.W4.lE(),this.gYa=!0,a.o7d&&(this.vH=null,this.pMl()))}kyb(){var a=this.Fnj();if(!a||!a.ild)return null;var b=this.wA.Rd;if(!b)return null;a=this.Aij(a,b);if(!a)return null;w.AFrameworkApplication.isRtl&&(b=this.g7f(),a.x-=b?b.width:this.Uui);return new Sys.UI.Point(a.x+a.width,a.y+a.height)}Fnj(){var a;if(!this.pa||!this.pa.Pa||
!this.pa.Pa.mb)return null;var b=this.pa.Pa.mb.Va;const c=!b.Sa&&!b.Mb;let f=b.node;if(f&&c){do f=this.toj(f);while(f&&f instanceof kf.AParagraphNode&&(null===(a=f.characterData)||void 0===a||!a.trim().length))}let l="";(a=f)&&a.characterData&&(l=a.characterData.length===b.Sa||c?a.characterData.trimEnd():a.characterData.substring(0,b.Sa).trimEnd());b=a&&a.characterData?l.length:b.Sa;return Object.assign(new bJ,{ild:a?a:f,vOe:b})}toj(a){const b=new ob.GraphIterator;if(!a.anchor)return null;b.set(a);
if(!b.kf())return null;b.Kg(11);return b.qua()?b.Cb(2):null}g7f(){const a=document.getElementById(this.hvi);if(!a)return null;const b=a.style.visibility,c=a.style.display;a.style.visibility="hidden";a.style.display="";const f=Bd.a.ki(a);a.style.display=c;a.style.visibility=b;return f}Aij(a,b){b=a.ild.tg(b.Na);if(!b)return null;let c=null;if(a.ild instanceof kf.AParagraphNode){if(!b)return null;try{c=this.Grk.tW(a.vOe,b,0<a.vOe,!1,!1,!1),c.height+=this.gui}catch(f){c=null}}c||(c=b.getBounds());return c}XYf(){if(!this.gYa&&
this.W4&&this.W4.isVisible){var a=document.querySelector(this.Xui);a&&(a.getAttribute(Ve.a.K7a)||"")===Ve.a.pja&&a.click()}}S_(){return this.pz()&&(Mb.SelectionEditor.ju(this.pa.Pa.mb.Va)||this.pa.Pa.mb.Va.contextId===yb.a.paragraph||this.pa.Pa.mb.Va.contextId===yb.a.endOfParagraph)}pz(){if(!this.pa.Pa||!this.pa.Pa.mb)return!1;const a=this.pa.Pa.mb;return!!a&&a.Va.contextId!==yb.a.outline&&!(a.Va.contextId===yb.a.notes||this.x9(a.Va.node))}x9(a){if(!a.anchor)return!1;const b=new ob.GraphIterator;
b.set(a);return b.sc(60)}bRi(){if(!this.PBe){const a=new dd.a(3,1,this.Wfk,()=>{this.wNh();this.PBe=!1},215);il.a.instance.Hb(a);this.PBe=!0}}wNh(){!this.gYa&&this.W4&&this.W4.isVisible&&(this.lE(new zd(!1)),this.showFloatie(new Cg(1,w.AFrameworkApplication.isRtl)))}}Object(m.a)(dJ,"TextPasteFloatieManager",null,[1236,143]);class eJ{Yb(a){a.register(CC,"Box4.Actors.Box4PasteStewardFactory").as("Box4.Actors.IBox4PasteStewardFactory").ma().oa(()=>new CC(uv.a.Byb,a.resolve("Box4.List.IListEditor"),a.resolve("Box4.List.IListReader"),
a.resolve("Box4.Actors.IBox4PasteStewardBridge")));a.register(dC,"Box4.Actors.Box4PasteStewardUtils").as("Box4.Actors.IBox4PasteStewardUtils").ma().oa(()=>new dC(w.AFrameworkApplication.fa.ka("WacPasteBrAsNewParagraphIsEnabled")));a.register(RH.ClipboardActor,"Box4.Actors.ClipboardActor").ma().oa(()=>new RH.ClipboardActor(a.oe("Box4.Actors.IClipboardOperationFactory"),a.resolve("Box4.Actors.ISystemClipboard"),mc.a.instance,a.resolve("Box4.IClipboardDataHelper"),ge.a.instance,w.AFrameworkApplication.Ra,
a.resolve("Box4.IUndoManager"),w.AFrameworkApplication.fa));w.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")&&a.register(1236,"Box4.ITextPasteFloatieManager").ma().oa(()=>new dJ(a,a.resolve("Box4.IInteractiveViewManager"),a.resolve("Box4.ITextMetricsAdapter"),a.resolve("Box4.IPasteFloatieEventHandler"),ge.a.instance,a.resolve("Common.PressOnlyKeyEvent"),Rc.App.Lb.Kd));a.register(1212,"Common.App.ChromeExtensionHelper.IChromeExtensionHelper").ma().oa(()=>new iB(w.AFrameworkApplication.fa));
a.register(1237,"Box4.Clipboard.ISystemClipboardAccessManagerFactory").ma().oa(()=>new PI(w.AFrameworkApplication.fa,a.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),a.resolve("Box4.IClipboardDataHelper"),Qc.a.instance));a.register(1238,"Box4.Clipboard.ISystemClipboardAccessManager").ma().oa(()=>a.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory").create());a.register(1239,"Box4.Actors.ISystemClipboard").ma().oa(()=>new LI(a.resolve("Box4.Clipboard.ISystemClipboardAccessManager"),
sa.InteractiveViewManager.instance,Rc.App.Lb.Kd,v.FocusManager.instance(),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IEditViewStateManager"),Qc.a.instance));a.register(356,"Box4.Clipboard.IClipboardOperationCutStrategy").ma().oa(()=>new UH);a.register(357,"Box4.Actors.IDeleteTableSegmentStrategy").ma().oa(()=>new QI);a.register(1240,"Box4.ISelectionFactory").ma().oa(()=>new ZI);a.register(1241,"Box4.IRenderOrderGraphIteratorFactory").ma().oa(()=>new aJ);a.register(1242,"Common.IDomElementContentStateFactory").ma().oa(()=>
new yH);a.register(1243,"Box4.Actors.IClipboardOperationPasteOvertypeStrategy").ma().oa(()=>new fI(ge.a.instance,a.resolve("Box4.IParagraphReader"),a.resolve("Box4.Styles.IStyleReader"),N.a.instance.ga(71)));a.register(xC,"Box4.Actors.PasteFloatieFeatureSetBuilder").ma().oa(()=>new xC(a.resolve("Box4.IClipboardDataHelper"),Rc.App.hE.nT));a.register(1244,"Box4.Actors.IClipboardOperationPasteFactory").ma().oa(()=>new dI(mc.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.Actors.PasteCoordinator"),
Zd.a.instance,ge.a.instance,w.AFrameworkApplication.Ra,a.resolve("Box4.Actors.IClipboardOperationPasteStrategyFactory"),a.oe("Box4.IUndoManager"),a.resolve("Common.IDomElementContentStateFactory"),a.resolve("Box4.Actors.IClipboardOperationPasteOvertypeStrategy"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(335,"Box4.Actors.IClipboardOperationCutCopyFactory").ma().oa(()=>new TH(w.AFrameworkApplication.Ra,mc.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.IOutlineElementEditor"),
ge.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Box4.IParagraphReader"),fi.a.instance,a.resolve("Box4.IOutlineElementNavigator"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.IOutlineElementReader"),a.resolve("Box4.IRenderOrderGraphIteratorFactory"),a.resolve("Box4.ISelectionFactory"),a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.IClipboardDataHelper"),Qc.a.instance,a.resolve("Box4.IEditingDomManager")));a.register(1245,"Box4.Actors.IClipboardOperationClipboardAccessHelper").ma().oa(()=>
new SH(mc.a.instance,Qc.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Common.ISimpleOperationFactory"),w.AFrameworkApplication.fa.appSettings.ChromeClipboardAccessOperationTimeout));a.register(1246,"Box4.Actors.IClipboardOperationPasteStrategyFactory").ma().oa(()=>new iI(w.AFrameworkApplication.fa));a.register(1247,"Box4.Actors.IClipboardOperationFactory").ma().oa(()=>new bI(a.resolve("Box4.Actors.InternalClipboard"),w.AFrameworkApplication.Ra,w.AFrameworkApplication.Ttd()&&!(z.a.$T&&
w.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix")),mc.a.instance,fi.a.instance,Qc.a.instance,a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.Actors.IClipboardOperationPasteFactory"),a.resolve("Box4.Actors.IClipboardOperationCutCopyFactory"),a.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),a.resolve("Box4.Actors.ClipboardOperationWordStrategy"),a.resolve("Box4.ICannotCutDialog"),a.resolve("Common.ISimpleOperationFactory"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,
a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IUndoManager"),a.resolve("Box4.IPasteFloatieEventSource"),a.resolve("Common.Utils.Telemetry.ITelemetry")));a.register(1248,"Box4.Actors.IExternalPasteExecutionManagerFactory").ma().oa(()=>new tI(a.oe("Box4.Actors.IBox4PasteStewardFactory"),a.oe("Box4.Actors.IBox4ImageStewardFactory"),a.oe("Box4.Actors.IBox4TableStewardFactory"),a.oe("Box4.Actors.IBox4WordConverterFactory"),a.resolve("HtmlImport.IHtmlTranslatorSettings"),
a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.Actors.IExternalPasteCssConverter"),a.resolve("HtmlImport.IHtmlNormalizerSettings")));a.register(Uh,"Box4.Actors.InternalClipboard").ma().oa(()=>new Uh(a.resolve("Box4.Images.IImageEditor"),a.resolve("Box4.ITableEditor"),a.resolve("Box4.IOutlineEditor"),a.resolve("Box4.IOutlineElementEditor"),a.resolve("Box4.List.IListEditor"),Rc.App.yP,a.resolve("Box4.IParagraphIndentationReader"),w.AFrameworkApplication.fa,a.resolve("Box4.Graph.IGraphNodeFactory"),
a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.ITableCellReader"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IConstantsProvider").Dvh,a.resolve("Box4.IFormattingPropertyTransitStrategy")));a.register(1249,"Box4.Actors.IInternalPasteExecutionManagerFactory").ma().oa(()=>new GI(a.resolve("Box4.Actors.InternalClipboard"),new Bb.a(()=>Rc.App.Lb.Kd.Mn)));a.register(1250,"Box4.List.IListCommands").ma().oa(()=>
new RI(w.AFrameworkApplication.Ra));a.register(js,"Box4.Actors.PasteCoordinator").ma().oa(()=>new js(a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),a.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory")));N.a.instance.ga(78)||a.register(DC,"Box4.Actors.Box4TableStewardFactory").as("Box4.Actors.IBox4TableStewardFactory").ma().oa(()=>new DC(Ib.a.instance.resolve("Box4.List.IListEditor"),Ib.a.instance.resolve("Box4.ITableEditor"),a.resolve("Common.IAppSettingsManager").ka("TablePasteRefactoringAndFixesIsEnabled"),
a.resolve("Common.IAppSettingsManager").ka("PasteComplexTablesIsEnabled"),a.resolve("Common.IAppSettingsManager").ka("PasteTableCellMarginImprovementsIsEnabled")));a.register(pC,"Box4.Actors.ClipboardOperationWordStrategy").ma().oa(()=>new pC(mc.a.instance,ge.a.instance,Rc.App.Mh,bh.a.instance,N.a.instance.ga(14),N.a.instance.ga(50)));a.register(mC,"Box4.Actors.Box4WordConverterFactory").as("Box4.Actors.IBox4WordConverterFactory").ma().oa(()=>new mC(w.AFrameworkApplication.fa));a.register(1251,"Box4.Actors.IExternalPasteCssConverter").ma().oa(()=>
new jI(w.AFrameworkApplication.fa));a.register(1252,"Box4.ISelectionCommands").ma().oa(()=>new YI(w.AFrameworkApplication.Ra));a.register(1253,"Box4.ITextFormattingCommands").ma().oa(()=>new XI(w.AFrameworkApplication.Ra));a.register(bC,"Box4.Actors.AccessibilityActor").ma().oa(()=>new bC(a.Ia("Box4.Accessibility.IAccessibilityContextManager"),a.resolve("Box4.Proofing.IErrorRangeEditor")));a.register(Fq,"Box4.Actors.InsertionPointFormatting").as("Box4.IInsertionPointFormatting").ma().oa(()=>new Fq(a.qb("Box4.IFontSlotProvider"),
a.resolve("Box4.Actors.IFontNameFormattingStrategy")));a.register(AC,"Box4.Actors.ProofingActor").ma().oa(()=>new AC(Ib.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),w.AFrameworkApplication.Ra,()=>Ib.a.instance.resolve("Box4.UI.ILanguageDialog"),Ib.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ib.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),ge.a.instance,Ib.a.instance.Ia("Box4.IExternalSelectionManager"),fi.a.instance,Ib.a.instance.resolve("Box4.ISelectionContextMenuProvider"),
bh.a.instance,mc.a.instance,Ib.a.instance.resolve("Box4.IContextMenuController"),Ib.a.instance.resolve("Box4.Proofing.IProofingFeatureConfiguration"),Ib.a.instance.Ia("Box4.Actors.IProofingErrorPresenter"),N.a.instance));a.register(BC,"Box4.Actors.StyleActor").ma().oa(()=>new BC(Ib.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ib.a.instance.resolve("Box4.Styles.IStyleEditor"),WQ.a.instance,Ib.a.instance.resolve("Box4.IFormattingEditor"),Ch.ContextSetEditor.instance,Ib.a.instance.resolve("Box4.IInsertionPointFormatting"),
bh.a.instance,mc.a.instance,Ib.a.instance.resolve("Box4.TextFormattingHelper"),nu.instance));a.register(Fd,"Box4.Actors.TextFormattingActor").ma().oa(()=>new Fd(a.resolve("Box4.Actors.IFormattingViewOperationFinishedStageProcessor"),a.resolve("Box4.Actors.IEopFormattingStrategy"),a.resolve("Box4.ITextRenderingStrategy"),a.resolve("Box4.IHyperlinkStrategy"),sa.InteractiveViewManager.instance));a.register(cC,"Box4.Actors.AutoCorrectActor").ma().oa(()=>new cC(w.AFrameworkApplication.Ra,mc.a.instance,
()=>Ib.a.instance.resolve("Box4.UI.IAutoCorrectOptionsDialog")))}}Object(m.a)(eJ,"Box4ActorsComponentConfiguration",null,[3]);const YQ=(a,b,c)=>Rc.App.C3d?8:2===c?(a=new Ai.StandardDialog,a.Ad=4,a.dza(1),a.Oe(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),a.Oe(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),a.Xwl(XQ),32):2,XQ=a=>{1===a&&w.AFrameworkApplication.Ra.processAction(C.a.o4d,2)},fJ=(a,b,c)=>{if(Rc.App.C3d)return 8;if(1===c)return b.node.Ua(ab.a.embeddedFileContainer)?32:
2;if(2===c&&(b.contextId===yb.a.view&&b.view.Nb&&(b=b.view.Nb.Yj),Nb.EmbeddedFileReader.aWj(b))){a=Nb.EmbeddedFileReader.R$d(b.node);pi.a.Mpl();try{ZQ(a)}catch(f){ka.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",f)}}return 32},ZQ=a=>{if(1!==Rc.App.mode||!w.AFrameworkApplication.fa.ka("OneNoteSaveFileThroughRequest")||w.AFrameworkApplication.fa.ka("IsTeamsSession")&&z.a.$T)window.open(a);else{var b=(new Jh.QueryStringBuilder(a)).rnj(),c=new XMLHttpRequest;c.onloadstart=()=>
{c.responseType="blob"};c.open("GET",a,!0);c.onload=()=>{try{const H=c.response;let Q=b;Q||(Q="GetImage",H.type&&-1!=H.type.indexOf("image/")&&"bmp gif ico jpeg png svg tiff webp".split(" ").forEach(ia=>{-1!=H.type.indexOf(ia)&&(Q="GetImage."+ia)}));Q=decodeURIComponent(escape(Q));if(z.a.bU)"undefined"!==typeof navigator.msSaveBlob?navigator.msSaveBlob(H,Q):window.open(a);else{var f=window.URL||window.webkitURL,l=f.createObjectURL(H),y=document.createElement("a");y.href=l;y.download=Q;document.body.appendChild(y);
y.click();setTimeout(()=>{document.body.removeChild(y);f.revokeObjectURL(l)},0)}}catch(H){window.open(a)}};c.send()}};var $Q=d(563),Gq=d(1274),Hv;(function(a){a[a.automatic=1]="automatic";a[a.clear=2]="clear";a[a.themeColors=3]="themeColors";a[a.standardColors=4]="standardColors";a[a.recentColors=5]="recentColors"})(Hv||(Hv={}));Object(m.b)("ColorMenuControls",Hv);class Dx{constructor(a){this.EWb=this.FWb=null;this.ozc={};this.T2=a}aac(){this.EWb=this.FWb=null}c3f(a,b){if(this.EWb)return this.EWb;
if(!a)return null;const c=Object.assign(new On.a,{Id:String.format("menu{0}Color",this.T2),ExternalId:String.format("{0}Color",this.T2)});c.MenuSectionList=[];Array.add(c.MenuSectionList,this.Mai());Array.add(c.MenuSectionList,this.Wai());Array.add(c.MenuSectionList,this.oei(a,b));Array.add(c.MenuSectionList,this.Xdi());return this.EWb=c}dKi(a,b){if(this.FWb)return this.FWb;a=this.c3f(a,b);return this.FWb=sj.l(a)}GIc(a,b){Hv[a]in this.ozc||(this.ozc[Hv[a]]=b)}sei(a){a.Uwf(Object(I.a)(this,this.aac,
"invalidateMenu"),1)}Mai(){if(!({actionId:b}=this.jxd(1)).returnValue)return null;const a=Object.assign(new Rk.a,{Id:String.format("{0}Color",this.T2),ControlsId:String.format("{0}.Color.Menu.Controls",this.T2),DisplayMode:"Menu16",ControlList:[]});var b=Object.assign(new hg.a,{Command:b.toString(),LabelText:ma.a.xe(Box4Intl.Box4Strings.L_Automatic),Image16by16:w.AFrameworkApplication.Cm,Image16by16Class:He.getImageClass("Automatic_16x16x32"),Id:"automatic",KeyTip:CommonUIStrings.l_AutomaticKeytip});
Array.add(a.ControlList,b);return a}Wai(){if(!({actionId:b}=this.jxd(2)).returnValue)return null;const a=Object.assign(new Rk.a,{Id:String.format("{0}Color",this.T2),ControlsId:String.format("{0}.Color.Menu.Controls",this.T2),DisplayMode:"Menu16",ControlList:[]});var b=Object.assign(new hg.a,{Command:b.toString(),LabelText:ma.a.xe(Box4Intl.Box4Strings.L_BtnClearShading),Image16by16:w.AFrameworkApplication.Cm,Image16by16Class:He.getImageClass("NoHighlight_16x16x32"),Id:"clear",KeyTip:CommonUIStrings.l_NoHighlightKeytip});
Array.add(a.ControlList,b);return a}oei(a,b){if(!({actionId:f}=this.jxd(3)).returnValue)return null;const c=Object.assign(new Rk.a,{Id:"Colors",ControlsId:String.format("{0}.Color.Menu.Controls",this.T2),ControlList:[]});var f=Object.assign(new Ty.a,{Id:String.format("Theme{0}ColorPicker",this.T2),ExternalId:String.format("Theme{0}ColorPicker",this.T2),McuExternalId:String.format("Theme{0}ColorPickerMCU",this.T2),McuLayout:!0,Command:f.toString(),Width:10});f.Colors=Dx.avj(a,b);Array.add(c.ControlList,
f);return c}Xdi(){if(!({actionId:b}=this.jxd(4)).returnValue)return null;const a=Object.assign(new Rk.a,{Id:String.format("{0}Colors",this.T2),ControlsId:String.format("{0}.Color.Menu.Controls",this.T2),Title:ma.a.xe(Box4Intl.Box4Strings.L_MenuStandardColors),ControlList:[]});var b=Object.assign(new Ty.a,{Id:String.format("Standard{0}ColorPicker",this.T2),ExternalId:String.format("Standard{0}ColorPicker",this.T2),Command:b.toString(),Width:10,Colors:[]});b.Colors=Dx.btj();Array.add(a.ControlList,
b);return a}jxd(a){a=Hv[a];return a in this.ozc?{returnValue:!0,actionId:this.ozc[a]}:{returnValue:!1,actionId:0}}static btj(){const a=[];a.push(Object.assign(new Gq.a,{Color:"0000C0",Alt:ma.a.xe(Box4Intl.Box4Strings.L_FontColorDarkRed),DisplayColor:"#C00000"}));a.push(Object.assign(new Gq.a,{Color:"0000FF",Alt:ma.a.xe(Box4Intl.Box4Strings.L_FontColorRed),DisplayColor:"#FF0000"}));a.push(Object.assign(new Gq.a,{Color:"00C0FF",Alt:ma.a.xe(Box4Intl.Box4Strings.L_FontColorOrange),DisplayColor:"#FFC000"}));
a.push(Object.assign(new Gq.a,{Color:"00FFFF",Alt:ma.a.xe(Box4Intl.Box4Strings.L_FontColorYellow),DisplayColor:"#FFFF00"}));a.push(Object.assign(new Gq.a,{Color:"50D092",Alt:ma.a.xe(Box4Intl.Box4Strings.L_FontColorLightGreen),DisplayColor:"#92D050"}));a.push(Object.assign(new Gq.a,{Color:"50B000",Alt:ma.a.xe(Box4Intl.Box4Strings.L_FontColorDarkGreen),DisplayColor:"#00B050"}));a.push(Object.assign(new Gq.a,{Color:"F0B000",Alt:ma.a.xe(Box4Intl.Box4Strings.L_FontColorLightBlue),DisplayColor:"#00B0F0"}));
a.push(Object.assign(new Gq.a,{Color:"C07000",Alt:ma.a.xe(Box4Intl.Box4Strings.L_FontColorBlue),DisplayColor:"#0070C0"}));a.push(Object.assign(new Gq.a,{Color:"602000",Alt:ma.a.xe(Box4Intl.Box4Strings.L_FontColorDarkBlue),DisplayColor:"#002060"}));a.push(Object.assign(new Gq.a,{Color:"A03070",Alt:ma.a.xe(Box4Intl.Box4Strings.L_FontColorPurple),DisplayColor:"#7030A0"}));return a}static avj(a,b){const c=a.properties.sa(Ab.a.themeColors,null);a=a.properties.eb(Ab.a.zIh).split(" ");const f=Array(10);
f[0]=Box4Intl.Box4Strings.l_ThemeLabel1;f[1]=Box4Intl.Box4Strings.l_ThemeLabel2;f[2]=Box4Intl.Box4Strings.l_ThemeLabel3;f[3]=Box4Intl.Box4Strings.l_ThemeLabel4;f[4]=Box4Intl.Box4Strings.l_ThemeLabel5;f[5]=Box4Intl.Box4Strings.l_ThemeLabel6;f[6]=Box4Intl.Box4Strings.l_ThemeLabel7;f[7]=Box4Intl.Box4Strings.l_ThemeLabel8;f[8]=Box4Intl.Box4Strings.l_ThemeLabel9;f[9]=Box4Intl.Box4Strings.l_ThemeLabel10;const l=[];for(let Q=0;6>Q;Q++)for(let ia=0;10>ia;ia++){var y=10*Q+ia,H=c[y];y=y+1<<24;H=H&4278190080|
(H&255)<<16|H&65280|(H&16711680)>>>16;const wa=Dx.cHl(f,Q,ia,b[a[ia]],c[ia]);l.push(Object.assign(new Gq.a,{Color:ma.a.tw(y,8),DisplayColor:"#"+ma.a.tw(H,6),Alt:ma.a.xe(wa)}))}return l}static cHl(a,b,c,f,l){if(b){var y=l&255,H=(l&65280)>>>8;l=(l&16711680)>>>16;y=Math.floor((Math.min(Math.min(y,H),l)+Math.max(Math.max(y,H),l))/2);--b;y?255===y?(y=!0,b=[242,217,191,166,127][b]):204<y?(y=!1,b=[229,191,127,64,25][b]):51>y?(y=!0,b=[25,64,127,191,229][b]):(H=[51,102,153],l=[191,127],b=(y=b<H.length)?H[b]:
l[b-H.length]):(y=!1,b=[127,166,191,217,242][b]);b=255-b;return String.format(y?Box4Intl.Box4Strings.l_ColorPickerTooltipTint:Box4Intl.Box4Strings.l_ColorPickerTooltipShade,f,a[c],Math.round(100*b/255))}return String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,f,a[c])}}Object(m.a)(Dx,"ColorMenu",null,[1273]);class sr{constructor(a){this.nzc=null;this.B2h=a}get R1f(){this.nzc||(this.nzc=new Dx(sr.WCi),this.qOj(this.nzc));return this.nzc}qOj(a){a.GIc(1,C.a.zW);a.GIc(3,C.a.sr);a.GIc(4,C.a.sr);
a.GIc(5,C.a.sr);a.sei(this.B2h)}vb(){const a=w.AFrameworkApplication.Ra;a.ya(C.a.UJb,yb.a.view,Object(I.a)(this,this.UJb,"populateFontColor"));a.he(C.a.UJb,1127)}UJb(a,b,c,f,l){if(1===c)return 32;if(2===c&&!l)return 8;a=sr.Tk.enj(b);if(w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.ob.Qp){b=this.R1f.c3f(a,Rc.App.CLf);if(!b)return 8;l.MenuItems=b}a=this.R1f.dKi(a,Rc.App.CLf);if(!a)return 8;l.PopulationXML=a;return 32}static Dhj(){return new sr($Q.a.instance)}static get instance(){return sr.Vt||
(sr.Vt=sr.Dhj())}static get Tk(){return $w.PageReader.instance}}sr.WCi="Font";sr.Vt=null;Object(m.a)(sr,"FontColorActor",null,[]);class Cf{constructor(a){this.$ha=this.hp=this.O2=null;this.qVb=!1;this.Pg=sa.InteractiveViewManager.instance.Rd;this.ek=a;Cf.$S&&Mb.SelectionEditor.tk(a)&&(a=Mb.SelectionEditor.vwc(this.ek),Mb.SelectionEditor.tk(a)?this.ek=a:ka.ULS.sendTraceTag(41522313,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak."));a=Mb.SelectionEditor.AQb(this.ek);
Mb.SelectionEditor.tk(a)&&(this.ek=a)}get s9(){return this.O2||(this.O2=Ib.a.instance.qb("Box4.IInternalLinkManager"))}get W6(){return this.hp||(this.hp=Ib.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get titleText(){return Box4Intl.Box4Strings.l_InsertLinkTitle}get okg(){return Box4Intl.Box4Strings.l_InsertLinkButtonText}dispose(){}$Yf(a,b,c){if(b!==this.ek.Mb||a!==this.ek.Sa)a=Od.SelectionFactory.D3(c,a,b),this.Pg.Nb.setSelection(a),this.ek=Mb.SelectionEditor.AQb(a.Va.clone())}m6f(a){let b,
c,f,l;l=wb.HyperlinkReader.k8b(this.ek);c=this.ek.Sa;f=this.ek.Mb;b="";if(!l.length)return this.$ha=a.substring(this.ek.Sa,this.ek.Mb),{returnValue:!0,trd:b,TRc:c,URc:f,rZc:l};if(l[0].hyperlink){let y,H=0,Q=Math.max(0,a.length-1),ia=0;for(let wa=0;wa<l.length;wa++)l[wa].Sa>=H&&({Sa:y,Mb:H}=Cf.hu.G_(this.ek,l[wa]),Q=Math.min(y,Q),ia=Math.max(H,ia));c=Math.min(Q,c);f=Math.max(ia,f);this.$ha=a.substring(c,f);c===Q&&(b=l[0].hyperlink.url);return{returnValue:!0,trd:b,TRc:c,URc:f,rZc:l}}return{returnValue:!1,
trd:b,TRc:c,URc:f,rZc:l}}g_c(a,b){if(this.Pg.Go){var c=Cf.yua?wb.HyperlinkReader.k8b(this.ek):wb.HyperlinkReader.WC(this.ek,!0);var f=this.Pg.Nb.Pa.mb;if(f){f=f.Va;Db.ParagraphReader.Fm(f)&&(f=cb.a.createTextRange(f.node,0,Db.ParagraphReader.textLength(f.node)));if(Cf.$S&&Mb.SelectionEditor.tk(f)){var l=Mb.SelectionEditor.vwc(f);Mb.SelectionEditor.tk(l)?f=l:ka.ULS.sendTraceTag(41522316,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak.")}l=Mb.SelectionEditor.AQb(f);
Mb.SelectionEditor.tk(l)&&(f=l);0===a||N.a.instance.ga(22)&&32!==w.AFrameworkApplication.Ra.ei(f,C.a.insertHyperlink,1,!0,null,null)||this.IYj(c)||!this.ek.equals(f)?this.Pg.mS():(pb.a.mark(5562),N.a.instance.ga(50)&&Rc.App.Mh&&Rc.App.Mh.Bw&&this.Pg.Nb.ZZb(),a=new pf.GraphTransaction(15),a.ld(this.ek.node),this.ek.node.jH().graphTransactionOperations.tja(4),f=b.txtDisplay,b=b.txtLink.trim(),this.insertLink(f,b,c),a.dispose(),pb.a.mark(5563),this.r3())}else ka.ULS.sendTraceTag(41522314,324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}}IYj(a){return Cf.yua?
!1:1<a.length||1===a.length&&(a[0].Sa>this.ek.Sa||a[0].Mb<this.ek.Mb)}insertLink(a,b,c){var f=null;a||(a=b);if(b&&(!c.length||b!==c[0].hyperlink.url)){b=wb.HyperlinkReader.aFa(b);var l="";this.s9&&({hnh:l}=this.s9.mKh(b,!1)).returnValue&&(b=l)}this.qVb||(a=Cf.hyperlinkEditor.u$k(a));if((!c.length||Cf.yua)&&b)(f=0<c.length)&&Cf.hu.VLb(this.ek,c),c=!0,Cf.UYj&&(c=Db.ParagraphReader.text(this.ek.node).substring(this.ek.Sa,this.ek.Mb)!==a),c&&Cf.characterPropertiesEditor.replaceTextRange(this.ek,a,!0),
c=cb.a.createTextRange(this.ek.node,this.ek.Sa,this.ek.Sa+a.length),Cf.hyperlinkEditor.Sja(c,b,f,!1),f=Od.SelectionFactory.Qg(this.ek.node,this.ek.Sa+a.length);else if(0<c.length){l=c[0];let y;const H=({Sa:c,Mb:y}=Cf.hu.G_(this.ek,l)).returnValue;if(b)if(l.hyperlink.UUa){if(b!==l.hyperlink.url)if(Cf.Xf.qQb){let Q=cb.a.createTextRange(this.ek.node,c,c+a.length);Cf.hyperlinkEditor.uXi(Q,l.hyperlink,b)}else Cf.hu.FNh(b,H);a!==this.$ha&&(Cf.hu.zJe()&&Cf.hu.VLb(this.ek,H),Cf.characterPropertiesEditor.replaceTextRange(cb.a.createTextRange(this.ek.node,
c,y),a,!0),f=cb.a.createTextRange(this.ek.node,c,c+a.length),Cf.hu.zJe()&&Cf.hyperlinkEditor.Sja(f,b,!1),f=Od.SelectionFactory.Qg(this.ek.node,c+a.length))}else Cf.hu.VLb(this.ek,H),Cf.characterPropertiesEditor.replaceTextRange(cb.a.createTextRange(this.ek.node,c,y),a,!0),f=cb.a.createTextRange(this.ek.node,c,c+a.length),Cf.hyperlinkEditor.Sja(f,b,!1),f=Od.SelectionFactory.Qg(this.ek.node,c+a.length);else Cf.hyperlinkEditor.YM(l.paragraph,l.hyperlink)}f&&this.Pg.Nb.setSelection(f)}static get hyperlinkEditor(){return Cf.In||
(Cf.In=Ib.a.instance.resolve("Box4.IHyperlinkEditor"))}static get characterPropertiesEditor(){return Cf.mh||(Cf.mh=Ib.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Xf(){return Cf.hd||(Cf.hd=Ib.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get hu(){return Cf.XD||(Cf.XD=Ib.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get yua(){null==Cf.q3a&&(Cf.q3a=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("HyperlinkExpandEditEnabled"):
!1);return Cf.q3a}static get UYj(){null==Cf.wHd&&(Cf.wHd=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("KeepHyperlinkFormatFixIsEnabled"):!1);return Cf.wHd}static get lcb(){null==Cf.a5a&&(Cf.a5a=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("HyperlinkUrlValidationIsEnabled"):!1);return Cf.a5a}static get $S(){null==Cf.rN&&(Cf.rN=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Cf.rN}}Cf.In=null;Cf.mh=null;Cf.hd=
null;Cf.XD=null;Cf.q3a=null;Cf.wHd=null;Cf.a5a=null;Cf.rN=null;Cf.source="Source";Cf.SLf="CommandingInterface";Cf.w9a="DisplayText";Cf.url="Url";Cf.id="InsertLinkDialog";Object(m.a)(Cf,"AInsertLinkDialog",null,[107]);class Ex{static get sg(){return bi.a.VC(Ex.Fo,Box4Intl.Box4Strings.l_InsertLinkDisplayText,Box4Intl.Box4Strings.l_InsertLinkAddress)}}Ex.Fo="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(m.a)(Ex,"InsertLinkDialogHtml",null,[]);class gJ extends Cf{constructor(a,b){super(a,b);this.Df=new bi.a;this.Df.kg=Cf.id;var c=this.$ha="";const f=Db.ParagraphReader.text(this.ek.node);let l=this.ek.Sa,y=this.ek.Mb,H;Cf.yua?{trd:c,TRc:l,URc:y,rZc:H}=this.m6f(f):(H=wb.HyperlinkReader.WC(this.ek,!0),1===H.length&&H[0].Sa<=this.ek.Sa&&H[0].Mb>=this.ek.Mb&&H[0].hyperlink?(this.$ha=Cf.hu.IVc(a,H[0],f),c=H[0].hyperlink.url):H.length||(this.$ha=f.substring(this.ek.Sa,this.ek.Mb)));(b=Object(qa.a)(Object,
b))&&(b[Cf.source]&&b[Cf.source]===Cf.SLf||b[Cf.url]&&b[Cf.w9a])?this.insertLink(b[Cf.w9a],b[Cf.url],H):(Cf.yua&&H[0]&&this.$Yf(l,y,H[0].paragraph),this.Df.sg=Ex.sg,""===c.trim()&&this.Df.Oe(1,this.okg),c={["txtLink"]:c,["txtDisplay"]:this.$ha},this.Df.WPc=Object(I.a)(this,this.SN,"dialogDefaultEnterKeyHandler"),this.Df.VPc=Object(I.a)(this,this.SN,"dialogDefaultEnterKeyHandler"),this.Df.pj(this.titleText,Object(I.a)(this,this.g_c,"insertLinkDialogHandler"),c),Cf.lcb&&(c=document.getElementById("txtLink"),
hd.a.addHandler(c,oa.a.input,Object(I.a)(this,this.XJa,"onLinkChanged")),hd.a.addHandler(c,oa.a.change,Object(I.a)(this,this.XJa,"onLinkChanged"))),document.getElementById("txtLink").focus(),Cf.$S?0<cg.h(cb.a.WRa(l,y,!1,this.ek.node)).length&&(this.qVb=!0,document.getElementById("txtDisplay").disabled=!0):1>=H.length&&Cf.hu.t_d(a,H[0],1===H.length)&&(this.qVb=!0,document.getElementById("txtDisplay").disabled=!0))}XJa(){if(this.Df){const a=document.getElementById("txtLink");this.Df.dF(1,!a||!a.value.length||
wb.HyperlinkReader.Fqe(a.value))}}SN(a){return this.Df?Cf.lcb?this.Df.u4f(this.Df.apb)?this.Df.SN(a):!1:this.Df.SN(a):!1}r3(){if(Cf.lcb){const a=document.getElementById("txtLink");a&&(hd.a.removeHandler(a,oa.a.change,Object(I.a)(this,this.XJa,"onLinkChanged")),hd.a.removeHandler(a,oa.a.input,Object(I.a)(this,this.XJa,"onLinkChanged")))}this.Df&&(this.Df=null)}}Object(m.a)(gJ,"InsertLinkDialog",Cf,[]);class hJ extends Cf{constructor(a,b,c){super(a,b);const f=new bi.a(!1,!1,!0),l={};l.displayTextLabel=
Box4Intl.Box4Strings.l_InsertLinkDisplayText;l.addressLabel=Box4Intl.Box4Strings.l_InsertLinkAddress;l.textDisplayInitialFocus=c;c=this.$ha="";const y=Db.ParagraphReader.text(this.ek.node);let H=this.ek.Sa,Q=this.ek.Mb,ia;Cf.yua?{trd:c,TRc:H,URc:Q,rZc:ia}=this.m6f(y):(ia=wb.HyperlinkReader.WC(this.ek,!0),1===ia.length&&ia[0].Sa<=this.ek.Sa&&ia[0].Mb>=this.ek.Mb&&ia[0].hyperlink?(this.$ha=Cf.hu.IVc(a,ia[0],y),c=ia[0].hyperlink.url):ia.length||(this.$ha=y.substring(this.ek.Sa,this.ek.Mb)));(b=Object(qa.a)(Object,
b))&&(b[Cf.source]&&b[Cf.source]===Cf.SLf||b[Cf.url]&&b[Cf.w9a])?this.insertLink(b[Cf.w9a],b[Cf.url],ia):(Cf.yua&&ia[0]&&this.$Yf(H,Q,ia[0].paragraph),b=CommonUIStrings.l_DialogOk,""===c.trim()&&(b=this.okg),f.Oe(1,b),l.txtLink=c,l.txtDisplay=this.$ha,Cf.$S?0<cg.h(cb.a.WRa(H,Q,!1,this.ek.node)).length&&(this.qVb=!0,l.textDisplayDisabled=!0):1>=ia.length&&Cf.hu.t_d(a,ia[0],1===ia.length)&&(this.qVb=!0,l.textDisplayDisabled=!0),a={["id"]:Cf.id,["bodyControls"]:l},f.pj(this.titleText,Object(I.a)(this,
this.g_c,"insertLinkDialogHandler"),a))}r3(){}}Object(m.a)(hJ,"ReactInsertLinkDialog",Cf,[]);class pu{constructor(){this.Qqa=!!w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.ob.hD}iPf(a,b,c){this.Qqa?new hJ(a,b,c):new gJ(a,b)}static get instance(){return pu.La||(pu.La=new pu)}}pu.La=null;Object(m.a)(pu,"InsertLinkDialogFactory",null,[1276]);class Sk extends bi.a{constructor(a){super();this.aL=a;this.Pg=sa.InteractiveViewManager.instance.Rd;this.dGc=this.Pg.Nb.Pa.mb;this.L7d=a[0].Sa;this.hre=
a[a.length-1].Mb;this.kg="InsertMultiParagraphLinkDialog";a=this.jOl();this.showDialog("",a)}showDialog(a,b){ka.ULS.sendTraceTag(41261264,324,50,"Insert multiple paragraph link dialog shows.");this.sg=Ex.sg;""===b.trim()&&this.Oe(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);a={["txtLink"]:b,["txtDisplay"]:a};this.pj(Box4Intl.Box4Strings.l_InsertLinkTitle,Object(I.a)(this,this.g_c,"insertLinkDialogHandler"),a);document.getElementById("txtLink").focus();document.getElementById("txtDisplay").disabled=
!0;Sk.lcb&&(a=document.getElementById("txtLink"),hd.a.addHandler(a,oa.a.input,Object(I.a)(this,this.XJa,"onLinkChanged")),hd.a.addHandler(a,oa.a.change,Object(I.a)(this,this.XJa,"onLinkChanged")))}hide(){if(Sk.lcb){const a=document.getElementById("txtLink");a&&(hd.a.removeHandler(a,oa.a.change,Object(I.a)(this,this.XJa,"onLinkChanged")),hd.a.removeHandler(a,oa.a.input,Object(I.a)(this,this.XJa,"onLinkChanged")))}super.hide()}XJa(){const a=document.getElementById("txtLink");this.dF(1,!a||!a.value.length||
wb.HyperlinkReader.Fqe(a.value))}SN(a){return Sk.lcb?this.u4f(this.apb)?super.SN(a):!1:super.SN(a)}jOl(){let a;let b;a="";const c=this.aL.length,f=wb.HyperlinkReader.WC(this.aL[0],!1);0<f.length&&({Sa:l,Mb:b}=Sk.hu.G_(this.aL[0],f[0]),l<=this.aL[0].Sa&&(a=f[0].hyperlink.url),this.L7d=Math.min(this.L7d,l));var l=wb.HyperlinkReader.WC(this.aL[c-1],!1);0<l.length&&({Sa:l,Mb:b}=Sk.hu.G_(this.aL[c-1],l[l.length-1]),this.hre=Math.max(this.hre,b));this.tJl(this.L7d,this.hre);return a}tJl(a,b){const c=this.aL.length;
if(a!==this.aL[0].Sa||b!==this.aL[c-1].Mb){a=cb.a.Lj(this.aL[0].node,a);a=Od.SelectionFactory.Mu(a);b=cb.a.Lj(this.aL[c-1].node,b);b=Od.SelectionFactory.WN(a,b);a=this.tcg(b.Va.clone());const f=this.tcg(b.jf.clone());a&&f&&(this.aL[0]=a,this.aL[c-1]=f,this.Pg.Nb.setSelection(b),this.dGc=b)}}g_c(a,b){if(this.Pg.Go){var c=this.Pg.Nb.Pa.mb;if(c)if(c.equals(this.dGc)&&0!==a){a=new pf.GraphTransaction(15);a.ld(this.aL[0].node);for(c=0;c<this.aL.length;c++)this.aL[c].node.jH().graphTransactionOperations.tja(4);
b=b.txtLink.trim();this.qSi();this.SPj(b);this.hide();a.dispose()}else this.Pg.mS()}}SPj(a){if(a){a=wb.HyperlinkReader.aFa(a);for(let c=0;c<this.aL.length;c++){var b=this.aL[c];if(Sk.$S&&Mb.SelectionEditor.tk(b)&&(b=Mb.SelectionEditor.vwc(b),!Mb.SelectionEditor.tk(b)))continue;b=cb.a.createTextRange(this.aL[c].node,b.Sa,b.Mb);Sk.hyperlinkEditor.Sja(b,a,!1)}}}tcg(a){return Db.ParagraphReader.Fm(a)&&!Mb.SelectionEditor.dX(a)&&Db.ParagraphReader.textLength(a.node)?cb.a.createTextRange(a.node,0,Db.ParagraphReader.textLength(a.node)):
Mb.SelectionEditor.tk(a)?a:null}qSi(){let a=!1;for(const b of this.aL){const c=wb.HyperlinkReader.WC(b,!1);c&&(a=Sk.hu.VLb(b,c)||a)}}static get hu(){return Sk.XD||(Sk.XD=Ib.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get Xf(){return Sk.hd||(Sk.hd=Ib.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get hyperlinkEditor(){return Sk.In||(Sk.In=Ib.a.instance.resolve("Box4.IHyperlinkEditor"))}static get $S(){null==Sk.rN&&(Sk.rN=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):
!1);return Sk.rN}static get lcb(){null==Sk.a5a&&(Sk.a5a=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("HyperlinkUrlValidationIsEnabled"):!1);return Sk.a5a}}Sk.XD=null;Sk.hd=null;Sk.In=null;Sk.rN=null;Sk.a5a=null;Object(m.a)(Sk,"InsertMultiParagraphLinkDialog",bi.a,[]);class Pe{static get fj(){return bh.a.instance}static get hyperlinkEditor(){return Pe.In||(Pe.In=Ib.a.instance.resolve("Box4.IHyperlinkEditor"))}static get hu(){return Pe.XD||(Pe.XD=Ib.a.instance.resolve("Box4.IHyperlinkStrategy"))}static lr(){return Pe.Sm||
(Pe.Sm=Ib.a.instance.Ia("Box4.IExternalSelectionManager"))}static get Xf(){return Pe.hd||(Pe.hd=Ib.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get owc(){return Pe.cE||(Pe.cE=Ib.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get ARb(){null==Pe.bAd&&(Pe.bAd=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("ViewAndOpenImageHyperlinksIsEnabled"):!1);return Pe.bAd}static get yua(){null==Pe.q3a&&(Pe.q3a=w.AFrameworkApplication.fa?
w.AFrameworkApplication.fa.ka("HyperlinkExpandEditEnabled"):!1);return Pe.q3a}static get Olc(){null==Pe.r3a&&(Pe.r3a=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("MultiParagraphHyperlinkEditEnabled"):!1);return Pe.r3a}static get $S(){null==Pe.rN&&(Pe.rN=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Pe.rN}static vb(){const a=w.AFrameworkApplication.Ra;a.ya(C.a.insertHyperlink,yb.a.view,Pe.Mzb);a.ya(C.a.insertHyperlink,
yb.a.Mf,Pe.insertLink);a.ya(C.a.insertHyperlink,yb.a.textRange,Pe.insertLink);a.he(C.a.insertHyperlink,1028);a.ya(C.a.YM,yb.a.view,Pe.Mzb);a.ya(C.a.YM,yb.a.Mf,Pe.Pnh);a.ya(C.a.YM,yb.a.textRange,Pe.Pnh);a.he(C.a.YM,1028);a.ya(C.a.Yqd,yb.a.view,Pe.Mzb);a.ya(C.a.Yqd,yb.a.Mf,Pe.Puh);a.ya(C.a.Yqd,yb.a.textRange,Pe.Puh);a.ya(C.a.bKa,yb.a.view,Pe.Mzb);a.ya(C.a.bKa,yb.a.Mf,Pe.Ych);a.ya(C.a.bKa,yb.a.textRange,Pe.Ych);a.ya(C.a.bKa,yb.a.image,Pe.ANe);a.ya(C.a.bKa,yb.a.w6b,Pe.ANe);a.ya(C.a.n$b,yb.a.view,Pe.Mzb);
a.ya(C.a.n$b,yb.a.Mf,Pe.linkText);a.ya(C.a.n$b,yb.a.textRange,Pe.linkText);a.he(C.a.n$b,1028);Pe.ARb&&a.ya(C.a.bKa,yb.a.anchoredObject,Pe.ANe);a.ya(C.a.RNc,yb.a.view,Pe.Mzb)}static Mzb(a,b,c,f,l){if(Pe.Olc)return Pe.LJj(a,b,c,f,l);if(!b.view.Sh)return 2;var y=b.view.Nb;if(!y||!y.Pa||!y.Pa.length)return 8;var H=y.Pa.mb;let Q=H.Va.clone();if(2===H.length){if(H=H.ga(1),!Mb.SelectionEditor.tk(Q)||!Mb.SelectionEditor.im(H)||Q.node!==H.node)return 8}else if(2<H.length)return 8;if(y.Pa.uH)return 8;Db.ParagraphReader.Fm(Q)&&
!Mb.SelectionEditor.dX(Q)&&(y=Q.node,Q=cb.a.createTextRange(y,0,Db.ParagraphReader.textLength(y)));return a===C.a.RNc?Pe.SNf(b,Q,c,f,l):w.AFrameworkApplication.Ra.ei(Q,a,c,!0,f,l)}static LJj(a,b,c,f,l){if(!b.view.Sh)return 2;var y=b.view.Nb;if(!y||!y.Pa||!y.Pa.length||y.Pa.uH)return 8;var H=y.Pa.mb;if(y=Pe.icc(H))H=Pe.Ide(H.Va.clone(),!0);else{let Q=H.ga(0).clone(),ia=1;for(;ia<H.length&&(!Db.ParagraphReader.textLength(Q.node)||Mb.SelectionEditor.im(Q)||Pe.$S&&cg.m(Q));)Q=H.ga(ia).clone(),ia++;H=
Pe.Ide(Q,!1)}return Pe.$S&&Mb.SelectionEditor.tk(H)&&cg.m(H)||!Mb.SelectionEditor.tk(H)&&!y?8:a===C.a.RNc?Pe.SNf(b,H,c,f,l):w.AFrameworkApplication.Ra.ei(H,a,c,!0,f,l)}static icc(a){if(1===a.length)return!0;if(2===a.length){const b=a.Va.clone();a=a.ga(1);return Mb.SelectionEditor.tk(b)&&Mb.SelectionEditor.im(a)&&b.node===a.node?!0:!1}return!1}static vMf(a){let b;b=null;const c=[];for(let f=0;f<a.length;f++){const l=Pe.Ide(a.ga(f).clone(),!1);if(Mb.SelectionEditor.tk(l))Pe.$S&&cg.m(l)||Array.add(c,
l);else if(!Mb.SelectionEditor.im(l)&&!Db.ParagraphReader.Fm(l))return{returnValue:!1,M_d:b}}b=Yb.a.cQb(c);return{returnValue:!Pe.$S||0<b.length?!0:!1,M_d:b}}static wkg(a,b,c,f){if(Pe.Olc)return Pe.XPj(a,b,c,f);if(!Pe.SXd()||!Pe.PLc(a)||ge.a.instance.Pa.uH)return 8;if(Pe.ARb&&Mb.SelectionEditor.cGa(a))return 2;let l;if(!({hyperlink:l}=Pe.vWa(a,!0)).returnValue||Pe.zNc())return 8;if(1===b)return 32;if(!l&&Mb.SelectionEditor.Xg(a)&&Mb.SelectionEditor.IBb(a)&&(b=Mb.SelectionEditor.ZSa(a,!1))&&(ge.a.instance.setSelection(b),
a=b.Va,Pe.zNc()))return 8;pu.instance.iPf(a,c,f);return 32}static XPj(a,b,c,f){var l=ge.a.instance.Pa.mb;const y=Pe.icc(l);if(y)a=[a];else if(!({M_d:a}=Pe.vMf(l)).returnValue)return 8;if(!Pe.SXd())return 8;for(l=0;l<a.length;l++)if(!Pe.PLc(a[l]))return 8;if(ge.a.instance.Pa.uH)return 8;l=Array(a.length);let H=null;for(let Q=0;Q<a.length;Q++)if(l[Q]=a[Q],!({hyperlink:H}=Pe.vWa(l[Q],!0)).returnValue||Pe.zNc())return 8;if(f&&!Pe.T5j(l[0]))return 8;if(1===b)return 32;if(!H&&1===l.length&&y&&Mb.SelectionEditor.Xg(l[0])&&
Mb.SelectionEditor.IBb(l[0])&&(b=Mb.SelectionEditor.ZSa(l[0],!1))&&(ge.a.instance.setSelection(b),l[0]=b.Va,Pe.zNc()))return 8;y?pu.instance.iPf(l[0],c,f):new Sk(l,c);return 32}static insertLink(a,b,c,f,l){return Pe.wkg(b,c,l,!1)}static linkText(a,b,c,f,l){return Pe.wkg(b,c,l,!0)}static Pnh(a,b,c){if(Pe.Olc)return Pe.r6k(a,b,c);if(!Pe.PLc(b)||Pe.ARb&&Mb.SelectionEditor.cGa(b))return 2;let f;if(!({hyperlink:f}=Pe.vWa(b,!1)).returnValue)return 2;if(2===c){c=new pf.GraphTransaction(15);try{c.fd=a,c.ld(f.paragraph),
Pe.yua?Pe.foh(b):Pe.hu.YM(b,f)}finally{c&&c.dispose()}}return 32}static r6k(a,b,c){var f=ge.a.instance.Pa.mb;if(Pe.icc(f))b=[b];else if(!({M_d:b}=Pe.vMf(f)).returnValue)return 8;if(!Pe.SXd())return 8;for(f=0;f<b.length;f++)if(!Pe.PLc(b[f]))return 8;if(1===c&&!Pe.vWa(b[0],!1).returnValue)return 2;if(2===c){for(c=0;c<b.length;c++)if(!Pe.vWa(b[c],!0).returnValue)return 2;c=new pf.GraphTransaction(15);try{let l=b[0];c.fd=a;c.ld(l.node);for(a=0;a<b.length;a++)Pe.foh(b[a])}finally{c&&c.dispose()}}return 32}static foh(a){const b=
wb.HyperlinkReader.k8b(a);let c=0;for(let f=0;f<b.length;f++)if(b[f].Sa>=c){const l=({Mb:c}=Pe.hu.G_(a,b[f])).returnValue;Pe.hu.VLb(a,l)}}static Puh(a,b,c){if(Pe.ARb&&ba.ImageReader.CAb(b)||!({hyperlink:a}=Pe.vWa(b,!1)).returnValue)return 2;2===c&&({Sa:b,Mb:c}=Pe.hu.G_(b,a),ge.a.instance.setSelection(Od.SelectionFactory.D3(a.paragraph,b,c)));return 32}static Ych(a,b,c){let f;if(Pe.ARb&&({hyperlink:f}=Pe.H5j(b)).returnValue)ka.ULS.sendTraceTag(50934737,324,50,"Logging for image blob object with hyperlink");
else if(!({hyperlink:f}=Pe.vWa(b,!1)).returnValue)return 2;2===c&&Rc.App.C6b(f.hyperlink.url);return 32}static ANe(a,b,c){a=ba.ImageReader.G_(b.node);if(!a)return 2;2===c&&Rc.App.C6b(a);return 32}static SNf(a,b,c,f,l){if(Pe.ARb&&ba.ImageReader.CAb(b))return 2;const y=sa.InteractiveViewManager.instance.editingView;if(!y.hm)return 2;let H;if(!({hyperlink:H}=Pe.vWa(b,!1)).returnValue)return 2;if(1===c)return 32;({Sa:b,Mb:c}=Pe.hu.G_(b,H));ge.a.instance.setSelection(Od.SelectionFactory.D3(H.paragraph,
b,c));var Q=y.ownerDocument;c=y.ao;b=new wd.a(c);Ea.a.vv(c);Q=Q.createElement("span");c.appendChild(Q);Q.innerText=H.hyperlink.url;y.xLa();y.Znl();a=w.AFrameworkApplication.Ra.ei(a,C.a.copy,2,!0,f,l);b.restore();return a}static vWa(a,b){let c;c=null;if(Mb.SelectionEditor.tk(a)){var f=cg.h(a);const l=Yb.a.all(f,y=>6===y.Bq);if(0<f.length&&(!Pe.$S||!l))return{returnValue:!1,hyperlink:c}}if(Pe.yua)return Pe.D5j(a,b);f=wb.HyperlinkReader.WC(a,!0);return 1===f.length&&f[0].Sa<=a.Sa&&f[0].Mb>=a.Mb&&f[0].hyperlink?
(c=f[0],{returnValue:!0,hyperlink:c}):{returnValue:!f.length&&b,hyperlink:c}}static H5j(a){let b;b=null;return ba.ImageReader.CAb(a)&&(b=wb.HyperlinkReader.KVc(a))?{returnValue:!0,hyperlink:b}:{returnValue:!1,hyperlink:b}}static D5j(a,b){let c;c=null;const f=wb.HyperlinkReader.k8b(a);return f.length?f[0].hyperlink?(c=f[0],a.Sa<f[0].Sa?{returnValue:b,hyperlink:c}:{returnValue:!0,hyperlink:c}):{returnValue:!1,hyperlink:c}:{returnValue:b,hyperlink:c}}static T5j(a){if(Mb.SelectionEditor.tk(a)){var b=
cg.h(a),c=Yb.a.all(b,f=>6===f.Bq);if(0<b.length&&!c)return!1}b=wb.HyperlinkReader.WC(a,!0);if(!(1===b.length&&b[0].Sa<=a.Sa&&b[0].Mb>=a.Mb&&b[0].hyperlink))return!1;c=Db.ParagraphReader.text(a.node);a=Pe.hu.IVc(a,b[0],c);return!(0<=a.indexOf("\r")||0<=a.indexOf("\n")||0<=a.indexOf("\x0B")||0<=a.indexOf("\ufffc"))}static zNc(){if(Pe.Xf.ig)for(let a=0;a<null.count;++a)if(2===null.ga(a).WWl.changeType)return!0;return!1}static SXd(){return Pe.Xf.ig?!0:!N.a.instance.ga(45)||!Rc.App.hE.rQb}static PLc(a){return N.a.instance.ga(14)&&
Pe.fj.R8a(a)||Pe.lr()&&Pe.lr().instance&&Pe.lr().instance.fX(a)?!1:!0}static Ide(a,b){return Db.ParagraphReader.Fm(a)&&!Mb.SelectionEditor.dX(a)&&(Db.ParagraphReader.textLength(a.node)||b)?cb.a.createTextRange(a.node,0,Db.ParagraphReader.textLength(a.node)):a}}Pe.In=null;Pe.XD=null;Pe.Sm=null;Pe.hd=null;Pe.cE=null;Pe.bAd=null;Pe.q3a=null;Pe.r3a=null;Pe.rN=null;Object(m.a)(Pe,"HyperlinkActor",null,[]);class Xg{static get Jv(){return uv.a.Byb}static get ym(){return Ch.ContextSetEditor.instance}static get fj(){return bh.a.instance}static get Xc(){return mc.a.instance}static lr(){return Xg.Sm||
(Xg.Sm=Ib.a.instance.Ia("Box4.IExternalSelectionManager"))}static get paragraphEditor(){return Xg.qx||(Xg.qx=Ib.a.instance.resolve("Box4.IParagraphEditor"))}static get h6(){return Xg.Cr||(Xg.Cr=Ib.a.instance.resolve("Box4.IParagraphReader"))}static get SM(){return Xg.OG||(Xg.OG=Ib.a.instance.resolve("Box4.IParagraphIndentationReader"))}static get xLk(){return Xg.paragraphEditor.Jv}static get Uf(){return Xg.fh||(Xg.fh=Ib.a.instance.resolve("Box4.List.IListReader"))}static vb(){const a=w.AFrameworkApplication.Ra;
a.ya(C.a.My,yb.a.view,Xg.tCf);a.ya(C.a.My,yb.a.outlineElement,Xg.sCf);a.he(C.a.My,1028);a.ya(C.a.TC,yb.a.view,Xg.tCf);a.ya(C.a.TC,yb.a.outlineElement,Xg.sCf);a.he(C.a.TC,1028)}static tCf(a,b,c,f,l){var y=b.view;if(!y.Sh)return 2;const H=y.Nb;if(!H)return Xg.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.coa}),8;var Q=H.Yj;if(!Q)return Xg.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.noSelection}),8;if(N.a.instance.ga(62)&&1===c)return 32;if(N.a.instance.ga(11)&&Xg.ym.Hsa(Xg.eUd,Q))return Xg.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.H2b}),
8;if(N.a.instance.ga(14)&&Xg.fj.D0c(Q))return Xg.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.kE}),8;if(Xg.lr()&&Xg.lr().instance&&Xg.lr().instance.fX(Q))return Xg.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.externalSelection}),8;Q={};Q[ii.bqa]=5794;Q[ii.aqa]=5795;let ia=2;if(w.AFrameworkApplication.fa.ka("Box4PartialPromoteDemoteIsEnabled")){y=Xg.dIf(a===C.a.My,b,!0);if(1===c)return y?32:8;y&&(ia=ii.Oib(a,b,c,f,l,Q))}else ia=ii.Oib(a,b,1,f,l,Q),1!==c&&32===ia?(y.Nb.YMe(),y=new pf.GraphTransaction(15),y.ld(b.view.Ag),ia=Xg.dIf(a===
C.a.My,b,!1)?ii.Oib(a,b,c,f,l,Q):8,y.dispose()):1!==c&&8===ia&&(y.Nb.YMe(),Xg.VDi(a,b,H));return ia}static dIf(a,b,c){b=b.view.Nb;if(!b||!b.Pa.mb)return Xg.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.ohd}),!1;if(b.Pa.uH)return Xg.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.XMf}),!1;b=vi.Kta(b.Pa,!1);if(!b)return Xg.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.iSc}),!1;let f=!1;for(let l=0;l<b.length;l++){const y=b.getContext(l),H=new ob.GraphIterator;H.set(y.node);Mb.SelectionEditor.Mt(H);if(!Wd.OutlineElementReader.ih(H))if(c)continue;
else return Xg.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.wda}),!1;if(a?!Xg.Jv.rub(H):!Xg.Jv.MLc(H))if(c)continue;else return Xg.Xc.Xb(Kd.a.D4b,{["Reason"]:Qd.a.CIf}),!1;f=!0}return c?f:!0}static sCf(a,b,c,f,l){if(b.contextId!==yb.a.outlineElement)return 2;if(N.a.instance.ga(14))if(f=b.clone().n3e(),cd.TableReader.usg(f)){if(Xg.fj.vsg(f))return Xg.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.kE}),8}else if(Xg.fj.kGa(f))return Xg.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.kE}),2;f=new ob.GraphIterator;f.set(b.node);Mb.SelectionEditor.Mt(f);
if(!Wd.OutlineElementReader.ih(f))return 2;switch(a){case C.a.My:b=Xg.Jv.rub(f);break;case C.a.TC:b=Xg.Jv.MLc(f);break;default:return 2}if(1===c||!b)return b?32:8;c=0;a===C.a.TC&&l&&l.sa(ee.a.UDf,!1)&&(c|=2);switch(a){case C.a.My:Xg.Jv.pjb(f,-1,c);break;case C.a.TC:Xg.Jv.JPc(f,1)}return 32}static VDi(a,b,c){const f=new pf.GraphTransaction(15);try{f.ld(b.view.Ag);b=!0;var l=vi.Kta(c.Pa,!1);for(let y=0;y<l.length;y++){const H=l.getContext(y);let Q=new ob.GraphIterator;Q.set(H.node);Mb.SelectionEditor.Mt(Q);
if(!Wd.OutlineElementReader.ih(Q))b=!1;else if(a===C.a.My?Xg.Jv.rub(Q):Xg.Jv.MLc(Q))switch(b=!1,a){case C.a.My:Xg.Jv.pjb(Q,-1,0);break;case C.a.TC:Xg.Jv.JPc(Q,1)}}if(b){const y=c.Pa.mb;for(c=0;c<y.length;c++){const H=y.ga(c);if(H.Pk){const Q=Xg.SM.pyb(H.node),ia=Q.bPb;if(a===C.a.My?Q.dO>ia:Q.dO<18*ia){let wa=new ob.GraphIterator;wa.set(H.node);l=ia;l=a===C.a.My?Q.dO>=2.5*ia?Q.dO-2*ia:ia:Q.dO<16*ia?Q.dO+2*ia:18*ia;Xg.xLk.ilb(wa,1,l)}}}}}finally{f&&f.dispose()}}}Xg.Sm=null;Xg.qx=null;Xg.Cr=null;Xg.OG=
null;Xg.fh=null;Xg.eUd=ba.ImageReader.BAb;Object(m.a)(Xg,"IndentationActor",null,[]);class ng{static get hhe(){return ng.Opb||(ng.Opb=Ib.a.instance.resolve("Box4.Images.IImageEditor"))}static get paragraphEditor(){return ng.qx||(ng.qx=Ib.a.instance.resolve("Box4.IParagraphEditor"))}static get Yq(){return ng.bE||(ng.bE=Ib.a.instance.resolve("Box4.ITableEditor"))}static get fj(){return bh.a.instance}static get Xc(){return mc.a.instance}static lr(){return ng.Sm||(ng.Sm=Ib.a.instance.Ia("Box4.IExternalSelectionManager"))}static vb(){const a=
w.AFrameworkApplication.Ra;N.a.instance.ga(77)||(a.ya(C.a.leftJustify,yb.a.table,ng.WUd),a.ya(C.a.centerJustify,yb.a.table,ng.WUd),a.ya(C.a.rightJustify,yb.a.table,ng.WUd));a.ya(C.a.leftJustify,yb.a.view,Mg.o8);a.ya(C.a.leftJustify,yb.a.paragraph,ng.mja);a.ya(C.a.leftJustify,yb.a.image,ng.HCa);a.ya(C.a.leftJustify,yb.a.embeddedFile,ng.HCa);a.he(C.a.leftJustify,1028);a.ya(C.a.centerJustify,yb.a.view,Mg.o8);a.ya(C.a.centerJustify,yb.a.paragraph,ng.mja);a.ya(C.a.centerJustify,yb.a.image,ng.HCa);a.ya(C.a.centerJustify,
yb.a.embeddedFile,ng.HCa);a.he(C.a.centerJustify,1028);a.ya(C.a.rightJustify,yb.a.view,Mg.o8);a.ya(C.a.rightJustify,yb.a.paragraph,ng.mja);a.ya(C.a.rightJustify,yb.a.image,ng.HCa);a.ya(C.a.rightJustify,yb.a.embeddedFile,ng.HCa);a.he(C.a.rightJustify,1028);N.a.instance.ga(54)&&(a.ya(C.a.fullJustify,yb.a.view,Mg.o8),a.ya(C.a.fullJustify,yb.a.paragraph,ng.mja),a.he(C.a.fullJustify,1028),a.ya(C.a.z4b,yb.a.view,Mg.o8),a.ya(C.a.z4b,yb.a.paragraph,ng.mja),a.he(C.a.z4b,1028),a.ya(C.a.Occ,yb.a.view,Mg.o8),
a.ya(C.a.Occ,yb.a.paragraph,ng.mja),a.he(C.a.Occ,1028),a.ya(C.a.htc,yb.a.view,Mg.o8),a.ya(C.a.htc,yb.a.paragraph,ng.mja),a.he(C.a.htc,1028));a.ya(C.a.Yla,yb.a.view,Mg.o8);a.ya(C.a.Yla,yb.a.paragraph,ng.mja);a.ya(C.a.Yla,yb.a.image,ng.HCa);a.he(C.a.Yla,1028);a.ya(C.a.Cja,yb.a.view,Mg.o8);a.ya(C.a.Cja,yb.a.paragraph,ng.mja);a.ya(C.a.Cja,yb.a.image,ng.HCa);a.he(C.a.Cja,1028);a.ya(C.a.gpa,yb.a.view,Mg.o8);a.ya(C.a.gpa,yb.a.paragraph,ng.mja);a.ya(C.a.gpa,yb.a.image,ng.HCa);a.he(C.a.gpa,1028);N.a.instance.ga(54)&&
(a.ya(C.a.BEa,yb.a.view,Mg.o8),a.ya(C.a.BEa,yb.a.paragraph,ng.mja),a.he(C.a.BEa,1028))}static WUd(a,b,c){let f=!0;if(!b)return 8;cd.TableReader.usg(b)?N.a.instance.ga(14)&&ng.fj.vsg(b)?(ng.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.kE}),f=!1):ng.lr()&&ng.lr().instance&&ng.lr().instance.fX(b)&&(ng.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.externalSelection}),f=!1):(ng.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.j4d}),f=!1);if(1===c||!f)return f?32:8;b=b.node;switch(a){case C.a.leftJustify:ng.Yq.nK(b,1);break;case C.a.centerJustify:ng.Yq.nK(b,
2);break;case C.a.rightJustify:ng.Yq.nK(b,3)}return 32}static HCa(a,b,c){if(!({GF:c}=Mg.oAh(c,b)).returnValue)return c;b=b.node;switch(a){case C.a.leftJustify:case C.a.Yla:ng.hhe.nK(b,1);break;case C.a.centerJustify:case C.a.Cja:ng.hhe.nK(b,2);break;case C.a.rightJustify:case C.a.gpa:ng.hhe.nK(b,3)}return 32}static mja(a,b,c,f,l){f=!0;b.contextId!==yb.a.paragraph?f=!1:N.a.instance.ga(14)&&ng.fj.kGa(b)?(ng.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.kE}),f=!1):ng.lr()&&ng.lr().instance&&ng.lr().instance.fX(b)&&
(ng.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.externalSelection}),f=!1);if(1===c||!f)return f?32:8;b=b.node;c=Db.ParagraphReader.CL(b);switch(a){case C.a.leftJustify:case C.a.Yla:ng.paragraphEditor.nK(b,1===c&&ng.o3c(l)?6:1);break;case C.a.centerJustify:case C.a.Cja:ng.paragraphEditor.nK(b,2===c&&ng.o3c(l)?1:2);break;case C.a.rightJustify:case C.a.gpa:ng.paragraphEditor.nK(b,3===c&&ng.o3c(l)?1:3);break;case C.a.fullJustify:case C.a.BEa:ng.paragraphEditor.nK(b,6===c&&ng.o3c(l)?1:6);break;case C.a.Occ:ng.paragraphEditor.nK(b,
11);break;case C.a.z4b:ng.paragraphEditor.nK(b,7);break;case C.a.htc:ng.paragraphEditor.nK(b,13)}return 32}static o3c(a){let b=!1;null!==a&&Object.getType(a)===Object&&a.hasOwnProperty("InContextSet")&&(b=a.InContextSet);return!b&&N.a.instance.ga(110)}}ng.Opb=null;ng.bE=null;ng.qx=null;ng.Sm=null;Object(m.a)(ng,"JustificationActor",null,[]);class qu{vb(){const a=w.AFrameworkApplication.Ra;a.ya(C.a.activateRibbonTab,yb.a.view,Object(I.a)(this,this.activateRibbonTab,"activateRibbonTab"));a.he(C.a.activateRibbonTab,
5);a.ya(C.a.Htg,yb.a.view,Object(I.a)(this,this.Y7j,"launchJewelOpenMenuShortcut"))}activateRibbonTab(){return 32}Y7j(){w.AFrameworkApplication.dM("Microsoft.Office.Web.SessionSettings.IWacWordTransformToWebPageSettings");Rc.App.hE.nT.Gtg();return 32}static get instance(){return qu.La||(qu.La=qu.XC())}static XC(){return new qu}}qu.La=null;Object(m.a)(qu,"RibbonActor",null,[]);class Sn{constructor(a,b,c){this.Fuf=!1;this.Ca=a;this.Oa=b;this.vBc=c}vb(){this.Ca.ra(G.a.jN,yb.a.view,Object(I.a)(this,this.oHl,
"touchStartHandler"),4);this.Ca&&this.Oa&&(this.Oa.ka("TouchImageGrippiesResizedIsEnabled")&&(this.Ca.ra(C.a.lJh,yb.a.view,Object(I.a)(this,this.kUk,"processImageOnTouchSelection"),4),this.Ca.ra(C.a.mJh,yb.a.view,Object(I.a)(this,this.jUk,"processImageOnClickSelection"),4)),this.Oa.ka("HideGrippersWhenPinchingIsEnabled")&&(this.Ca.ra(G.a.UAl,yb.a.application,Object(I.a)(this,this.LUk,"processStartPinchToZoom"),4),this.Ca.ra(G.a.VYi,yb.a.application,Object(I.a)(this,this.cUk,"processEndPinchToZoom"),
4)))}oHl(a,b,c){if(2!==c)return 2;this.Fuf||(this.Fuf=!0);w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordPinchZoomSettings");w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordViewerPinchZoomSettings");z.a.ik&&w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordForceSelectionIntoTopWhenTouchSettings");return 32}kUk(a,b,c,f,l){if(2!==c)return 2;this.qih(l,!0);return 32}jUk(a,b,c,f,l){if(2!==c)return 2;this.qih(l,!1);return 32}qih(a,
b){if(a)for(a=a.firstChild;a;){if("SPAN"===a.tagName&&Sys.UI.DomElement.containsCssClass(a,Sn.gLj)){for(a=a.firstChild;a;)this.yji(a,b),a=a.nextSibling;break}a=a.nextSibling}}yji(a,b){if(Sys.UI.DomElement.containsCssClass(a,Sn.Pig)){b&&!Sys.UI.DomElement.containsCssClass(a,Sn.AZc)?Sys.UI.DomElement.addCssClass(a,Sn.AZc):!b&&Sys.UI.DomElement.containsCssClass(a,Sn.AZc)&&Sys.UI.DomElement.removeCssClass(a,Sn.AZc);const c="WACImageResizeHandleTouch"+this.fij(a);b&&!Sys.UI.DomElement.containsCssClass(a,
c)?Sys.UI.DomElement.addCssClass(a,c):!b&&Sys.UI.DomElement.containsCssClass(a,c)&&Sys.UI.DomElement.removeCssClass(a,c)}}FVc(a){a=a.className.split(" ");for(let b=0;b<a.length;b++){const c=a[b].toString();if(c.startsWith("WACImageResizeHandle")&&c!==Sn.Pig)return c}return""}fij(a){a=this.FVc(a);return""!==a?ma.a.substring(a,20,a.length):""}LUk(a,b,c){if(2!==c)return 2;if(!this.vBc)return 8;this.vBc.IIj();return 32}cUk(a,b,c){if(2!==c)return 2;if(!this.vBc)return 8;this.vBc.jcl();return 32}static Ivj(){return new Sn(w.AFrameworkApplication.Ra,
w.AFrameworkApplication.fa,Xh.GrippersManager.instance)}static get instance(){return Sn.Vt||(Sn.Vt=Sn.Ivj())}}Sn.Pig="WACImageResizeHandles";Sn.AZc="WACImageResizeHandlesTouch";Sn.gLj="WACImgSelection";Sn.Vt=null;Object(m.a)(Sn,"TouchInputActor",null,[]);class tr{constructor(a){this.gt=null;this.SZ=a}get Vn(){return this.gt||(this.gt=this.SZ())}vb(){const a=w.AFrameworkApplication.Ra,b=Object(I.a)(this,this.undoRedo,"undoRedo");a.ra(C.a.undo,yb.a.view,b,1028);a.ra(C.a.redo,yb.a.view,b,1028)}undoRedo(a,
b,c,f,l){b=b.view;if(!b.Sh)return tr.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.ohd}),8;f=a===C.a.undo?this.Vn.XW:this.Vn.hla;if(1===c)return f?32:8;if(!f)return ka.ULS.sendTraceTag(17069441,365,50,"User attempted {0} without an undo stack",a===C.a.undo?"undo":"redo"),tr.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.DLl}),2;c=new pf.GraphTransaction(3);c.ld(b.Ag);c.$kb();a=a===C.a.undo?this.Vn.undo():this.Vn.redo();c.dispose();l&&Xh.GrippersManager.instance.b3a(l.Pu);if(a)return 32;tr.Xc.Xb(Kd.a.D4b,{["Reason"]:Qd.a.O5g});
return 8}static get instance(){return tr.La||(tr.La=tr.XC())}static XC(){const a=Ib.a.instance;return new tr(()=>a.resolve("Box4.IUndoManager"),a.oe("Box4.ICoauthCashTelemetry"))}static get Xc(){return mc.a.instance}}tr.La=null;Object(m.a)(tr,"UndoActor",null,[]);class FC{constructor(){this.Da=null}get name(){return"Box4.Actors"}Yb(a){this.Da=a;(new eJ).Yb(a)}init(){this.Da.resolve("Box4.Actors.ClipboardActor").vb();w.AFrameworkApplication.Ra.ya(C.a.EWi,yb.a.embeddedFile,YQ);w.AFrameworkApplication.Ra.ya(C.a.o4d,
yb.a.embeddedFile,fJ);w.AFrameworkApplication.Ra.ya(C.a.o4d,yb.a.v6b,fJ);sr.instance.vb();Pe.vb();Xg.vb();ng.vb();Sn.instance.vb();this.Da.resolve("Box4.ISelectAllHandlers").vb();N.a.instance.ga(70)&&this.Da.resolve("Box4.Actors.ProofingActor").vb();qu.instance.vb();const a=this.Da.qb("Box4.IFeatureHelper");a?a.vyj.continueWith(()=>{this.Pmh()}):this.Pmh();Gc.vb(Rc.App.KMa);this.Da.resolve("Box4.Actors.TextFormattingActor").vb();tr.instance.vb();this.Da.resolve("Box4.Actors.AccessibilityActor").vUe();
this.Da.resolve("Box4.IClipboardCommands");w.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")&&this.Da.resolve("Box4.ITextPasteFloatieManager").G4k();Rc.App.Lb.updateCommandUI()}Pmh(){N.a.instance.ga(71)&&this.Da.resolve("Box4.Actors.StyleActor").vb()}dispose(){}static main(){n.a.instance.Ac(new FC)}}Object(m.a)(FC,"Box4ActorsPackage",null,[2,3]);class Pm{constructor(a,b){this.K7=this.K1h=null;this.M1h=a;this.xpb=b}get omd(){return this.levelText}get edc(){return this.K1h}get levelText(){return this.M1h}get listStyle(){return 6}get yE(){return"left"}get Xna(){return this.K7}get font(){return this.xpb}}
Object(m.a)(Pm,"ListMarkerBullet",null,[1272]);class Vf{static get jq(){return Vf.fp||(Vf.fp=Ib.a.instance.resolve("Box4.List.IListEditor"))}static get Uf(){return Vf.fh||(Vf.fh=Ib.a.instance.resolve("Box4.List.IListReader"))}static get insertionPointFormatting(){return Vf.Qt||(Vf.Qt=Ib.a.instance.resolve("Box4.IInsertionPointFormatting"))}static lr(){return Vf.Sm||(Vf.Sm=Ib.a.instance.Ia("Box4.IExternalSelectionManager"))}static get ym(){return Ch.ContextSetEditor.instance}static get fj(){return bh.a.instance}static get Xc(){return mc.a.instance}static get cM(){return Vf.UK||
(Vf.UK=Ib.a.instance.qb("Box4.List.ListSettings"))}static get ouc(){return Vf.PYb||(Vf.PYb=Ib.a.instance.qb("Box4.List.ISingleLevelListEditor"))}static vb(){const a=w.AFrameworkApplication.Ra;a.ya(C.a.iN,yb.a.view,Vf.d0b);a.ya(C.a.iN,yb.a.outlineElement,Vf.itb);a.he(C.a.iN,1036);a.ya(C.a.zP,yb.a.view,Vf.d0b);a.ya(C.a.zP,yb.a.outlineElement,Vf.itb);a.he(C.a.zP,1036);Vf.Uf.idb&&(a.ya(C.a.ZZa,yb.a.view,Vf.d0b),a.ya(C.a.ZZa,yb.a.outlineElement,Vf.itb),a.he(C.a.ZZa,1036));a.ya(C.a.qCf,yb.a.view,vf.ActionManager.Sg);
a.ya(C.a.tKf,yb.a.view,vf.ActionManager.Sg);a.ya(C.a.joinList,yb.a.view,vf.ActionManager.Sg);a.ya(C.a.AUd,yb.a.view,vf.ActionManager.Sg);a.ya(C.a.HUd,yb.a.view,vf.ActionManager.Sg);a.ya(C.a.qGh,yb.a.view,vf.ActionManager.Sg);a.ya(C.a.rGh,yb.a.view,vf.ActionManager.Sg);a.ya(C.a.s8e,yb.a.view,vf.ActionManager.Sg)}static d0b(a,b,c,f,l){if(!b.view.Sh)return 2;const y=Vf.Xc.Zp(C.a.d0b);f.QC=42;f.RN=42;const H={};H[ii.bqa]=5796;H[ii.aqa]=5797;var Q=b.view;if(N.a.instance.ga(11)){if(Vf.ym.Hsa(Vf.JKj,Q.Nb.Yj))return Vf.Xc.Xb(Kd.a.zh,
{["Reason"]:Qd.a.v_d}),y.end(),8;if(Vf.ym.Hsa(Vf.eUd,Q.Nb.Yj))return Vf.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.H2b}),y.end(),8}if(N.a.instance.ga(14)&&Vf.fj.D0c(Q.Nb.Yj))return Vf.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.kE}),y.end(),8;if(Vf.lr()&&Vf.lr().instance&&Vf.lr().instance.fX(b))return Vf.Xc.Xb(Kd.a.zh,{["Reason"]:Qd.a.externalSelection}),y.end(),8;if(1===c)return y.end(),32;l||(l=new J.DictionaryPropertySet);let ia=null;var wa=2;if(2===c){ia=new pf.GraphTransaction(15);ia.ld(b.view.Ag);Vf.ucc=!1;const kb=
vi.Kta(Q.Nb.Pa,!1);if(!kb)return ia.dispose(),Vf.Xc.Xb(Kd.a.ska,{["Reason"]:Qd.a.iSc}),y.end(),8;w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings");1<kb.length&&l.setValue(ee.a.i5g,null);const Gb=l.sa(ee.a.iU,-1),ec=l.sa(ee.a.zE,-1);Vf.cM.gcc&&Vf.ouc&&Vf.ouc.XWl(kb);if(Vf.Uf.pGh){var Ua=Vf.Arl(Gb,ec,kb);Ua&&(l.setValue(ee.a.zE,16),l.setValue(ee.a.Iea,0));if(!Mb.SelectionEditor.Xg(Q.Nb.Yj)&&!Ua&&a!==C.a.ZZa&&0<kb.length&&Gb){Q=new ob.GraphIterator;
Ua=Array(kb.length);for(let dc=0;dc<kb.length;dc++)Q.set(kb.getContext(dc).node),Ua[dc]=Vf.Uf.Gv(Q);Vf.zrl(Ua,l)&&(wa=new J.DictionaryPropertySet,wa.setValue(ee.a.zE,16),wa.setValue(ee.a.Iea,0),wa=ii.k6(a,b,c,f,wa,H,11),w.AFrameworkApplication.Ra.processAction(C.a.rGh,2),ka.ULS.sendTraceTag(38544075,393,50,"List Actions: Switch List Style - Range Select"),Vf.ucc=!0)}}Q=new ob.GraphIterator;Q.set(kb.getContext(0).node);Q=Vf.Uf.Gv(Q);Vf.Ubk(Gb,ec,Q,kb.length)}N.a.instance.ga(63)||N.a.instance.ga(77)?
wa=ii.k6(a,b,c,f,l,H,11):N.a.instance.ga(30)&&(wa=ii.Oib(a,b,c,f,l,H));32===wa&&l.sa(ee.a.UDf,!1)&&(N.a.instance.ga(62)?wa=ii.k6(C.a.TC,b,c,f,l,H,11):N.a.instance.ga(29)?wa=ii.Oib(C.a.TC,b,c,f,l,H):N.a.instance.ga(76));ia&&ia.dispose();y.end();return wa}static zrl(a,b){let c=null;var f=!1;for(let l=a.length-1;0<=l&&(c?(f=a[l],f=-1!==b.sa(ee.a.iU,-3)?f?c.listType!==f.listType||c.listStyle!==f.listStyle:!0:f?c.listType!==f.listType:!0):c=a[l],!f);l--);return c&&(a=!1,f||(a=b.sa(ee.a.iU,-3),a=b.sa(ee.a.zE,
42)!==c.listType||0<a),f||a)?!0:!1}static Ubk(a,b,c,f){0>=f||Vf.ucc||(a?c?(c=c.listType,-1===a&&b===c?(w.AFrameworkApplication.Ra.processAction(C.a.s8e,2),ka.ULS.sendTraceTag(39715535,393,50,"List Actions: Clean List Style - Ribbon button")):0<a&&(0===b||1===b)&&(w.AFrameworkApplication.Ra.processAction(0===b?C.a.HUd:C.a.AUd,2),ka.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",0===b?"Numbering":"Bullet"))):(w.AFrameworkApplication.Ra.processAction(0===b?C.a.HUd:C.a.AUd,2),ka.ULS.sendTraceTag(39715534,
393,50,"List Actions: Apply {0} List Style",0===b?"Numbering":"Bullet")):(w.AFrameworkApplication.Ra.processAction(C.a.s8e,2),ka.ULS.sendTraceTag(39715533,393,50,"List Actions: Clean List Style - None list style")))}static Arl(a,b,c){if(-1!==a&&a||!c.length)return!1;a=new ob.GraphIterator;let f=null;for(let l=c.length-1;0<=l&&!(a.set(c.getContext(l).node),f=Vf.Uf.Gv(a));l--);return f&&b===f.listType?!0:!1}static itb(a,b,c,f,l){if(b.contextId!==yb.a.outlineElement)return 2;if(N.a.instance.ga(14)){var y=
b.clone().n3e();if(Vf.fj.kGa(y))return Vf.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.kE}),2}const H=new ob.GraphIterator;H.set(b.node);Mb.SelectionEditor.Mt(H);if(!Wd.OutlineElementReader.ih(H))return 2;if(1===c)switch(a){case C.a.iN:return 32;case C.a.zP:return 32;case C.a.ZZa:return 32;default:return 2}y=Vf.Uf.Gv(H);let Q=l;if(!Q)return 8;!Zb.ListReader.Fx&&a===C.a.zP&&H.qua()&&(H.gJ(4)||Q.setValue(ee.a.JWa,1),H.np());Vf.Uf.idb?(a===C.a.zP||a===C.a.iN?(Q=Vf.jq.XXf(a,Q),b=pe.a.NN(Q.eb(ee.a.zE),Q.eb(ee.a.Iea))):
b=a===C.a.ZZa?pe.a.NN(0,1):null,Vf.aR(a,Q),Vf.aml(b,Q)):(Q=Vf.jq.XXf(a,Q),b=pe.a.NN(Q.eb(ee.a.zE),Q.eb(ee.a.Iea)));Zb.ListReader.Fx||(b.SA=Q.sa(ab.a.LWa,Ed.a.ax));Vf.inl(Q,H);if(!({ybb:b}=Vf.jq.itb(Q,H,b,!1)).returnValue)return Vf.Xc.Xb(Kd.a.$o,{["Reason"]:Qd.a.Rre}),2;2===c&&(w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings"),a=l.sa(ee.a.zE,-1),b&&-1!==a&&((l=l.sa(Ab.a.j0,"Invalid MultiLevel Type"),y)?0!==b.listType&&1!==b.listType||
Vf.ucc||(w.AFrameworkApplication.Ra.processAction(C.a.qGh,2),ka.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",a?"Bullet":"Numbering",l)):16===b.listType?(w.AFrameworkApplication.Ra.processAction(C.a.tKf,2),ka.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",a?"Bullet":"Numbering",l)):0!==b.listType&&1!==b.listType||Vf.ucc||(w.AFrameworkApplication.Ra.processAction(C.a.qCf,2),ka.ULS.sendTraceTag(38544077,393,50,"List Actions: ApplyList Style - {0}, {1}",
a?"Bullet":"Numbering",l))),l=v.FocusManager.instance(),l.Ee.name===M.AppFrame.hqd&&l.fC(D.AFrame.JW));f.QC=b.listType;f.RN=b.listStyle;return 32}static inl(a,b){var c=new ob.GraphIterator;c.Tc(b);(b=c.Cb(2))&&Db.ParagraphReader.ae(b)&&(c=ge.a.instance.Pa.mb)&&c.Va&&c.Va.node===b&&Mb.SelectionEditor.R2c(c)&&(Vf.Zkl(a),Vf.Xkl(a))}static aml(a,b){b.Ua(Ab.a.j0)&&a.$ll(b.eb(Ab.a.j0));a.iU=b.sa(ee.a.iU,-1);a.bqe?(b=Vf.qkj(a,b),Vf.fnl(a,b)):Vf.hkl(a)}static hkl(a){if(a.$1c)a.HYc&&-1===a.iU||(a.levelText=
"%1.",a.propertySet.Ua(ab.a.Zi)||a.gza(0,1));else if(1===a.listType)a.HYc&&-1===a.iU||(a.font=Ed.a.sRi,a.levelText=Ed.a.defaultBullet,a.propertySet.Ua(ab.a.Zi)||a.gza(1,6));else return;a.yE="left"}static fnl(a,b){1===a.j0?Vf.oml(a,b):Vf.nll(a,b)}static oml(a,b){a.Xna=b.Xna}static nll(a,b){a.levelText=b.levelText;a.$1c?a.gza(0,b.listStyle):(a.font=b.font,a.gza(1,1));a.yE=b.yE}static qkj(a,b){let c=null;2===a.j0?c=a.$1c?Ib.a.instance.qb("Box4.ListMarkerGallery.ListMarkerNumberingLoader"):Ib.a.instance.qb("Box4.ListMarkerGallery.ListMarkerBulletLoader"):
1===a.j0&&(c=Ib.a.instance.qb("Box4.ListMarkerGallery.ListMarkerMultilevelLoader"));let f=c.ivg.value;a=a.iU+"";a in f||(f=c.i9j);return a in f||!b.Ua(ab.a.font)?f[a]:new Pm(ma.a.fromCharCode(parseInt(a)),b.sa(ab.a.font,""))}static Xkl(a){Vf.insertionPointFormatting.Ua(ab.a.fontColor)&&a.setValue(ab.a.fontColor,Vf.insertionPointFormatting.fontColor())}static Zkl(a){Vf.insertionPointFormatting.Ua(ab.a.fontSize)&&a.setValue(ab.a.fontSize,Vf.insertionPointFormatting.fontSize())}static aR(a,b){ka.ULS.sendTraceTag(22923024,
324,50,"{ListType:%1, ListStyleId:%2}",a===C.a.iN?0:a===C.a.zP?1:a===C.a.ZZa?2:-1,b.sa(ee.a.iU,-1))}}Vf.JKj=ba.ImageReader.fbc;Vf.eUd=ba.ImageReader.BAb;Vf.fp=null;Vf.fh=null;Vf.Qt=null;Vf.Sm=null;Vf.UK=null;Vf.PYb=null;Vf.ucc=!1;Object(m.a)(Vf,"ListActor",null,[]);var iJ=d(1247);class ru{constructor(){this.N1h=new Bb.a(Object(I.a)(this,this.V0d,"createListMarkerDictionary"));this.O1h={}}get ivg(){return this.N1h}get i9j(){return this.O1h}}Object(m.a)(ru,"AListMarkerGalleryLoader",null,[1274]);var jJ=
d(1275);class qz extends ix.a{constructor(){super();this.LevelInfo=null}get Type(){return 5}}Object(m.a)(qz,"ListGalleryButtonProps",ix.a,[]);class gt{constructor(a,b,c,f){this.jWb=null;this.SFf="BulletLibraryGallery";this.Czk="NumberingLibraryGallery";this.kxk="MultilevelGallery";this.q5a=a;this.P1h=b;switch(a){case 0:this.jWb="BulletStyle";break;case 1:this.jWb="NumberingStyle";break;case 2:this.jWb="MultilevelStyle";break;default:this.jWb="BulletStyle"}this.K0h=f}get j9j(){return this.P1h}Pxf(a){let b;
var c=1;switch(this.q5a){case 0:var f=Box4Intl.Box4Strings.L_BulletsLibraryTitle;var l=b="BulletsLibrary";break;case 1:f=Box4Intl.Box4Strings.L_NumberingLibraryTitle;b="NumberingLibrary";c=5;l="NumberingLibrary";break;case 2:f=Box4Intl.Box4Strings.L_ListLibraryTitle;b="MultilevelLibrary";c=5;l="Multilevel";break;default:f=Box4Intl.Box4Strings.L_BulletsLibraryTitle,l=b="BulletsLibrary"}f=Object.assign(new Rk.a,{Id:String.format("msListMarkersPosition{0}",b),Title:f,ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",
ControlList:[]});var y=0===this.q5a?"Size40by40":"Size48by48";c=Object.assign(new Cq.a,{Id:String.format("galleryListMarkersPosition{0}",b),ExternalId:l,ExternalGalleryId:this.jae(this.q5a),Type:c,Width:6,ElementDimensions:y,GalleryItems:[]});l=this.j9j.ivg.value;y=Dq.a(l);const H=Math.min(18,y.length);for(let Q=0;Q<H;Q++){const ia=l[y[Q]];this.K0h&&a&&((1===this.q5a||2===this.q5a)&&!ia.edc||0===this.q5a&&ia.levelText===Box4Intl.Box4Strings.L_ListStyleNone)||c.GalleryItems.push(this.iae(this.jWb+
b+"_"+Q,ia,this.q5a))}Array.add(f.ControlList,c);return f}jae(a){switch(a){case 0:return this.SFf;case 1:return this.Czk;case 2:return this.kxk;default:return this.SFf}}q7f(a){const b={},c=aa.FontUtils.Oja(a.font);b.fontFamily=aa.FontUtils.Ksb(c,a.font,!0,!1,!1);return b}iae(a,b,c){var f="";let l=!1;0===c&&b.levelText!==Box4Intl.Box4Strings.L_ListStyleNone&&(f=ma.a.tw(b.levelText.charCodeAt(0),4),f=gt.USj(b.font)&&!f.indexOf("f")?" 0x0"+f.substr(1):" 0x"+f,f=b.font+f,l=!0);let y,H;switch(c){case 0:c=
C.a.iN;y=C.a.tjh;H=Object.assign(new jJ.a,{Character:b.levelText,Style:this.q7f(b)});break;case 1:c=C.a.zP;y=C.a.bWk;H=Object.assign(new qz,{LevelInfo:b.edc});break;case 2:c=C.a.ZZa;y=C.a.aWk;H=Object.assign(new qz,{LevelInfo:b.edc});b.Xna&&(f=b.Xna.description,l=!0);break;default:c=C.a.iN,y=C.a.tjh,H=Object.assign(new jJ.a,{Character:b.levelText,Style:this.q7f(b)})}H.Id=a;H.Command=c.toString();H.QueryCommand=y.toString();H.Alt=f;H.InnerHTML=ma.a.xe(this.g9j(b));H.ShouldSetTitle=l.toString();return H}g9j(a){return String.format('<DIV class="ListMarkerPreview" style="{0}">{1}</DIV>',
this.Tae(a),this.Sae(a))}Tae(a){const b=new Sys.StringBuilder;b.append("position: relative; ");if(a.omd===Box4Intl.Box4Strings.L_ListStyleNone&&a.font===gt.elg)b.append("font-size: 12pt; "),b.append("top: 22%;");else{b.append("font-family: ");const c=aa.FontUtils.Oja(a.font);b.append(aa.FontUtils.Ksb(c,a.font,!0,!1,!1));b.append("; ");b.append("font-size: 24pt;")}return b.toString()}Sae(a){return a.omd}static USj(a){for(let b=0;b<gt.nDf.length;b++)if(a===gt.nDf[b])return!0;return!1}}gt.elg="EXYdHRyjlYTe8nDSGfyW";
gt.nDf=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"];Object(m.a)(gt,"ListMarkerGalleryUtility",null,[]);class GC extends ru{constructor(){super();new iJ.a(oB.a.Ml())}V0d(){const a={};a["0"]=new Pm(Box4Intl.Box4Strings.L_ListStyleNone,gt.elg);a["1"]=new Pm(String.fromCharCode(61623),"Symbol");a["2"]=new Pm(String.fromCharCode(111),"Courier New");a["3"]=new Pm(String.fromCharCode(61607),"Wingdings");a["4"]=new Pm(String.fromCharCode(9643),"Courier New");a["5"]=new Pm(String.fromCharCode(61611),
"Wingdings");a["6"]=new Pm(String.fromCharCode(61614),"Symbol");a["7"]=new Pm(String.fromCharCode(61483),"Symbol");a["8"]=new Pm(String.fromCharCode(61485),"Symbol");a["9"]=new Pm(String.fromCharCode(9830),"Courier New");a["10"]=new Pm(String.fromCharCode(61664),"Symbol");a["11"]=new Pm(String.fromCharCode(61558),"Wingdings");a["12"]=new Pm(String.fromCharCode(61656),"Wingdings");a["13"]=new Pm(String.fromCharCode(61514),"Wingdings");a["14"]=new Pm(String.fromCharCode(61516),"Wingdings");a["15"]=
new Pm(String.fromCharCode(61692),"Wingdings");a["16"]=new Pm(String.fromCharCode(61691),"Wingdings");a["17"]=new Pm(String.fromCharCode(61553),"Wingdings");return a}}Object(m.a)(GC,"ListMarkerBulletLoader",ru,[]);class Tk{constructor(){this.styleAtLevel=this.textAtLevel=null}}Object(m.a)(Tk,"InfoAtLevel",null,[]);class su{constructor(a){this.K7=a}get font(){return"Calibri"}get listStyle(){return 42}get yE(){return"left"}get Xna(){return this.K7}get omd(){return this.K7?this.jTk():this.lTk()}get edc(){return this.K7?
this.kTk():null}get levelText(){return""}rhj(a){switch(a){case 1:return"1";case 2:return"a";case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}}jTk(){let a="";for(let b=0;3>b;b++)a+=this.YEa(b);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',su.j$d(),a)}kTk(){const a=[];for(let b=0;3>b;b++)a.push(Object.assign(new Tk,{textAtLevel:this.D$f(b),styleAtLevel:this.ztj(b)}));return a}lTk(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',
su.k$d(),Box4Intl.Box4Strings.L_ListStyleNone)}D$f(a){a=this.K7.Uug[a];for(let b=0;9>b;b++)a=ma.a.replaceAll(a,"%"+(b+1),this.rhj(this.K7.I4c[b]));return a}ztj(a){const b={};b.fontFamily=6===this.K7.I4c[a]?this.K7.P1f[a]:this.font;return b}YEa(a){const b=this.D$f(a),c=new Sys.StringBuilder;6===this.K7.I4c[a]&&c.append(String.format("font-family:{0};",this.K7.P1f[a]));return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',
a,c.toString(),b)}static j$d(){const a=new Sys.StringBuilder;a.append("padding-left: 2pt; ");a.append("font-size: 9pt; ");return a}static k$d(){const a=new Sys.StringBuilder;a.append("text-align: center; ");a.append("margin-top: 22%; ");a.append("font-size: 12pt; ");return a}}Object(m.a)(su,"ListMarkerMultilevel",null,[1272]);class rz{constructor(a,b,c,f,l){this.Uug=a;this.I4c=b;this.P6j=f;this.P1f=c;this.description=l}}Object(m.a)(rz,"MultilevelDefInfo",null,[]);class kJ{zKi(){var a=Box4Intl.Box4Strings.L_MultilevelListLabelNumericalStyle;
let b="";const c=Array(9),f=Array(9),l=Array(9),y=Array(9);for(let H=0;9>H;H++)b+="%"+(H+1)+".",c[H]=b,f[H]=1,l[H]="left";return new rz(c,f,y,l,a)}MMi(){var a=Box4Intl.Box4Strings.L_MultilevelListLabelAlphanumericalStyle;const b=Array(9),c=Array(9);for(let f=0;9>f;f++)b[f]=2===f%3?"right":"left";return new rz("%1) %2) %3) (%4) (%5) (%6) %7. %8. %9.".split(" "),[1,2,3,1,2,3,1,2,3],c,b,a)}RJi(){var a=[61558,61656,61607,61623,9830,61656,61607,61623,9830],b=Box4Intl.Box4Strings.L_MultilevelListLabelBulletedStyle;
const c=Array(9),f=Array(9),l=Array(9);for(let y=0;9>y;y++)l[y]=String.fromCharCode(a[y]),c[y]=6,f[y]="left";return new rz(l,c,"Wingdings;Wingdings;Wingdings;Symbol;Courier New;Wingdings;Wingdings;Symbol;Courier New".split(";"),f,b)}}Object(m.a)(kJ,"MultilevelDefInfoAdaptor",null,[]);class HC extends ru{constructor(){super()}V0d(){const a=new kJ,b={};b["0"]=new su(null);b["1"]=new su(a.zKi());b["2"]=new su(a.MMi());b["3"]=new su(a.RJi());return b}}Object(m.a)(HC,"ListMarkerMultilevelLoader",ru,[]);
class en{constructor(a,b){this.K7=null;this.k5a=a;this.lDc=b}get font(){return"Calibri"}get listStyle(){return this.lDc}get yE(){switch(this.lDc){case 3:case 5:return"right";default:return"left"}}get Xna(){return this.K7}get omd(){switch(this.lDc){case 1:return this.GKa("1","2","3");case 2:return this.GKa("a","b","c");case 3:return this.GKa("i","ii","iii");case 4:return this.GKa("A","B","C");case 5:return this.GKa("I","II","III");case 0:return this.mTk();default:return this.GKa("1","2","3")}}get edc(){const a=
[],b={};b.fontFamily=aa.FontUtils.Oja(this.font);switch(this.lDc){case 1:return a.push(Object.assign(new Tk,{textAtLevel:this.YN("1"),styleAtLevel:b})),a.push(Object.assign(new Tk,{textAtLevel:this.YN("2"),styleAtLevel:b})),a.push(Object.assign(new Tk,{textAtLevel:this.YN("3"),styleAtLevel:b})),a;case 2:return a.push(Object.assign(new Tk,{textAtLevel:this.YN("a"),styleAtLevel:b})),a.push(Object.assign(new Tk,{textAtLevel:this.YN("b"),styleAtLevel:b})),a.push(Object.assign(new Tk,{textAtLevel:this.YN("c"),
styleAtLevel:b})),a;case 3:return a.push(Object.assign(new Tk,{textAtLevel:this.YN("i"),styleAtLevel:b})),a.push(Object.assign(new Tk,{textAtLevel:this.YN("ii"),styleAtLevel:b})),a.push(Object.assign(new Tk,{textAtLevel:this.YN("iii"),styleAtLevel:b})),a;case 4:return a.push(Object.assign(new Tk,{textAtLevel:this.YN("A"),styleAtLevel:b})),a.push(Object.assign(new Tk,{textAtLevel:this.YN("B"),styleAtLevel:b})),a.push(Object.assign(new Tk,{textAtLevel:this.YN("C"),styleAtLevel:b})),a;case 5:return a.push(Object.assign(new Tk,
{textAtLevel:this.YN("I"),styleAtLevel:b})),a.push(Object.assign(new Tk,{textAtLevel:this.YN("II"),styleAtLevel:b})),a.push(Object.assign(new Tk,{textAtLevel:this.YN("III"),styleAtLevel:b})),a;case 0:return null;default:return a.push(Object.assign(new Tk,{textAtLevel:this.YN("1"),styleAtLevel:b})),a.push(Object.assign(new Tk,{textAtLevel:this.YN("2"),styleAtLevel:b})),a.push(Object.assign(new Tk,{textAtLevel:this.YN("3"),styleAtLevel:b})),a}}get levelText(){return this.k5a}GKa(a,b,c){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',
en.j$d(),this.YEa(a),this.YEa(b),this.YEa(c))}mTk(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',en.k$d(),Box4Intl.Box4Strings.L_ListStyleNone)}YEa(a){a=this.YN(a);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',a)}YN(a){return ma.a.replaceAll(this.k5a,"%1",a)}static j$d(){const a=new Sys.StringBuilder;a.append("padding-left: 2pt; ");a.append("font-size: 9pt; ");return a}static k$d(){const a=
new Sys.StringBuilder;a.append("text-align: center; ");a.append("margin-top: 22%; ");a.append("font-size: 12pt; ");return a}}Object(m.a)(en,"ListMarkerNumbering",null,[1272]);class IC extends ru{constructor(){super();new iJ.a(oB.a.Ml())}V0d(){const a={};a["0"]=new en(Box4Intl.Box4Strings.L_ListStyleNone,0);a["1"]=new en("%1.",5);a["2"]=new en("%1.",4);a["3"]=new en("%1.",1);a["4"]=new en("%1.",2);a["5"]=new en("%1.",3);a["6"]=new en("%1)",5);a["7"]=new en("%1)",4);a["8"]=new en("%1)",1);a["9"]=new en("%1)",
2);a["10"]=new en("%1)",3);a["11"]=new en("(%1)",5);a["12"]=new en("(%1)",4);a["13"]=new en("(%1)",1);a["14"]=new en("(%1)",2);a["15"]=new en("(%1)",3);return a}}Object(m.a)(IC,"ListMarkerNumberingLoader",ru,[]);class JC{constructor(){this.Da=null}get name(){return"Box4.ListMarker"}init(){Vf.vb()}dispose(){}Yb(a){this.Da=a;this.Da.register(GC,"Box4.ListMarkerGallery.ListMarkerBulletLoader").ma().oa(()=>new GC);this.Da.register(IC,"Box4.ListMarkerGallery.ListMarkerNumberingLoader").ma().oa(()=>new IC);
this.Da.register(HC,"Box4.ListMarkerGallery.ListMarkerMultilevelLoader").ma().oa(()=>new HC)}static main(){n.a.instance.Ac(new JC)}}Object(m.a)(JC,"Box4ListMarkerPackage",null,[2,3]);class KC{constructor(a){this.RAd=a}Cng(a){if(!this.RAd)return!0;a=yg.a.GVc(a);if(!a)return!1;a=a.toLowerCase();for(let b=0;b<this.RAd.length;b++)if(a.endsWith(this.RAd[b]))return!0;return!1}}Object(m.a)(KC,"DomainAllowListManager",null,[]);class lJ{constructor(a,b){this.j2d=null;this.kQd=a;this.url=b}get T9e(){return yg.a.Poa(this.url)}get mC(){return this.kQd}B6e(){const a=
{},b=this.mC;a.a=this.T9e;a.b=this.round(b.navigationStart);a.c=this.round(b.unloadEventStart);a.d=this.round(b.unloadEventEnd);a.e=this.round(b.redirectStart);a.f=this.round(b.redirectEnd);a.g=this.round(b.fetchStart);a.h=this.round(b.domainLookupStart);a.i=this.round(b.domainLookupEnd);a.j=this.round(b.connectStart);a.k=this.round(b.connectEnd);a.l=void 0!==b.secureConnectionStart&&null!==b.secureConnectionStart?this.round(b.secureConnectionStart):0;a.m=this.round(b.requestStart);a.n=this.round(b.responseStart);
a.o=this.round(b.responseEnd);a.q=this.round(b.domInteractive);a.r=this.round(b.domContentLoadedEventStart);a.s=this.round(b.domContentLoadedEventEnd);a.t=this.round(b.domComplete);a.u=this.round(b.loadEventStart);a.v=this.round(b.loadEventEnd);a.w=this.j2d;return a}round(a){return Math.round(1E3*a)/1E3}}Object(m.a)(lJ,"PerformanceTimingEntry",null,[]);const mJ=(a,b)=>{const c={};let f=null;switch(a){case 0:f="ResourceTiming";a=b.a;null!=a&&(c.Url=a);a=b.b;null!=a&&(c.InitiatorType=a);a=null==b.c?
null:b.c.toString();null!=a&&(c.RedirectStart=a);a=null==b.d?null:b.d.toString();null!=a&&(c.RedirectEnd=a);a=null==b.e?null:b.e.toString();null!=a&&(c.FetchStart=a);a=null==b.f?null:b.f.toString();null!=a&&(c.DomainLookupStart=a);a=null==b.g?null:b.g.toString();null!=a&&(c.DomainLookupEnd=a);a=null==b.h?null:b.h.toString();null!=a&&(c.ConnectStart=a);a=null==b.i?null:b.i.toString();null!=a&&(c.ConnectEnd=a);a=null==b.j?null:b.j.toString();null!=a&&(c.SecureConnectionStart=a);a=null==b.k?null:b.k.toString();
null!=a&&(c.RequestStart=a);a=null==b.l?null:b.l.toString();null!=a&&(c.ResponseStart=a);a=null==b.m?null:b.m.toString();null!=a&&(c.ResponseEnd=a);a=b.n;null!=a&&(c.CustomText=a);a=null==b.o?null:b.o.toString();null!=a&&(c.DecodedBodySize=a);a=null==b.p?null:b.p.toString();null!=a&&(c.EncodedBodySize=a);b=null==b.q?null:b.q.toString();null!=b&&(c.TransferSize=b);break;case 1:f="PerformanceTiming",a=b.a,null!=a&&(c.Url=a),a=null==b.b?null:b.b.toString(),null!=a&&(c.NavigationStart=a),a=null==b.c?
null:b.c.toString(),null!=a&&(c.UnloadEventStart=a),a=null==b.d?null:b.d.toString(),null!=a&&(c.UnloadEventEnd=a),a=null==b.e?null:b.e.toString(),null!=a&&(c.RedirectStart=a),a=null==b.f?null:b.f.toString(),null!=a&&(c.RedirectEnd=a),a=null==b.g?null:b.g.toString(),null!=a&&(c.FetchStart=a),a=null==b.h?null:b.h.toString(),null!=a&&(c.DomainLookupStart=a),a=null==b.i?null:b.i.toString(),null!=a&&(c.DomainLookupEnd=a),a=null==b.j?null:b.j.toString(),null!=a&&(c.ConnectStart=a),a=null==b.k?null:b.k.toString(),
null!=a&&(c.ConnectEnd=a),a=null==b.l?null:b.l.toString(),null!=a&&(c.SecureConnectionStart=a),a=null==b.m?null:b.m.toString(),null!=a&&(c.RequestStart=a),a=null==b.n?null:b.n.toString(),null!=a&&(c.ResponseStart=a),a=null==b.o?null:b.o.toString(),null!=a&&(c.ResponseEnd=a),a=null==b.p?null:b.p.toString(),null!=a&&(c.DomLoading=a),a=null==b.q?null:b.q.toString(),null!=a&&(c.DomInteractive=a),a=null==b.r?null:b.r.toString(),null!=a&&(c.DomContentLoadedEventStart=a),a=null==b.s?null:b.s.toString(),
null!=a&&(c.DomContentLoadedEventEnd=a),a=null==b.t?null:b.t.toString(),null!=a&&(c.DomComplete=a),a=null==b.u?null:b.u.toString(),null!=a&&(c.LoadEventStart=a),a=null==b.v?null:b.v.toString(),null!=a&&(c.LoadEventEnd=a),b=b.w,null!=b&&(c.CustomText=b)}c.Table=f;return Sys.Serialization.JavaScriptSerializer.serialize(c)};var ci=d(285);class ks{constructor(a,b=null,c=null){this.pi=a;this.S9e=this;this.YYh=b||(()=>window.location.href);this.PDd=new KC(c)}run(){if(ks.QCa(window.performance))try{const l=
this.YYh();if(ks.w9h.exec(l)&&this.PDd.Cng(l)){var a=new lJ(window.performance.timing,l);Ji.a.instance.C0k(a.mC.fetchStart);Ji.a.instance.E0k(a.mC.navigationStart);Ji.a.instance.OZa(ci.a.c8i,"connectStart","requestStart");Ji.a.instance.OZa(ci.a.i8i,"requestStart","responseStart");Ji.a.instance.OZa(ci.a.k8i,"responseStart","responseEnd");this.S9e.mdb(1,a.B6e());this.pi.lc(ci.a.yEa,a.mC.fetchStart);this.pi.lc(ci.a.g8i,a.mC.domainLookupStart);this.pi.lc(ci.a.v2f,a.mC.domainLookupEnd);this.pi.lc(ci.a.e8i,
a.mC.connectStart);this.pi.lc(ci.a.l8i,a.mC.secureConnectionStart);this.pi.lc(ci.a.d8i,a.mC.connectEnd);this.pi.lc(ci.a.x2f,a.mC.requestStart);this.pi.lc(ci.a.ETc,a.mC.responseStart);this.pi.lc(ci.a.w2f,a.mC.responseEnd-a.mC.responseStart);this.pi.lc(ci.a.j8i,a.mC.responseStart-a.mC.requestStart);var b=0,c=0,f=0;({transferSize:b,d5d:c,s2d:f}=this.nKl(l)).returnValue&&(this.pi.lc(ci.a.m8i,b),this.pi.lc(ci.a.f8i,f),this.pi.lc(ci.a.h8i,c));this.pi.lc(ci.a.L6b,a.mC.navigationStart)}}catch(l){ka.ULS.sendTraceTag(4551814,
306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",l)}}nKl(a){let b,c,f;f=c=b=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:b,d5d:c,s2d:f};a=window.performance.getEntriesByName(a,"navigation");if(void 0===a||null===a||1!==a.length)return{returnValue:!1,transferSize:b,d5d:c,s2d:f};a=a[0];var l=a.transferSize;void 0!==b&&null!==b&&(b=l);l=a.decodedBodySize;void 0!==l&&null!==l&&(f=l);a=a.encodedBodySize;void 0!==
a&&null!==a&&(c=a);return{returnValue:!0,transferSize:b,d5d:c,s2d:f}}mdb(a,b){ka.ULS.sendTraceTag(4551815,306,50,mJ(a,b))}static get instance(){return ks.La||(ks.La=new ks(wg.a.instance,null,w.AFrameworkApplication.fa.ka("PerfTimingLoggerFilterDomainsIsEnabled")?w.AFrameworkApplication.fa.eA("ResourceLoggerDomainAllowList"):null))}static QCa(a){return!(void 0===a||null===a)&&!(void 0===a.timing||null===a.timing)}}ks.La=null;ks.w9h=RegExp("^https?://.*","i");Object(m.a)(ks,"PerformanceTimingLogger",
null,[521]);class ur{constructor(a,b){this.j2d=null;this.kQd=a;this.behavior=b;this.url=this.mC.name}get T9e(){return 2===this.behavior?this.url:yg.a.Poa(this.url)}get mC(){return this.kQd}B6e(){const a={},b=this.mC;a.a=this.T9e;a.b=b.initiatorType;a.c=this.round(b.redirectStart);a.d=this.round(b.redirectEnd);a.e=this.round(b.fetchStart);a.f=this.round(b.domainLookupStart);a.g=this.round(b.domainLookupEnd);a.h=this.round(b.connectStart);a.i=this.round(b.connectEnd);a.j=void 0!==b.secureConnectionStart&&
null!==b.secureConnectionStart?this.round(b.secureConnectionStart):0;a.k=this.round(b.requestStart);a.l=this.round(b.responseStart);a.m=this.round(b.responseEnd);a.o=this.round(ur.nUa(b,"decodedBodySize"));a.p=this.round(ur.nUa(b,"encodedBodySize"));a.q=this.round(ur.nUa(b,"transferSize"));a.n=this.j2d;return a}round(a){return Math.round(1E3*a)/1E3}static nUa(a,b){return a[b]}}Object(m.a)(ur,"ResourceTimingEntry",null,[540]);class nJ{constructor(a,b=null,c=100){this.sbf=a;this.FGc=b;this.FNa={};this.gVh=
c}fJl(a){var b=a.name.toLowerCase();const c=yg.a.R7b(b);this.Grh(c,b)&&(c in this.FNa?ka.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",c):(b={},b.fetchstart=a.fetchStart,b.responseend=a.responseEnd,b.iscached=this.Ssg(a),b.encodedsize=ur.nUa(a,"encodedBodySize"),b.decodedsize=ur.nUa(a,"decodedBodySize"),this.FNa[c]=b))}gJl(a){var b=a.name.toLowerCase();const c=yg.a.R7b(b);this.Xbl(c,b)&&(c in this.FNa?ka.ULS.sendTraceTag(508925201,306,50,"AppStaticResourceManager: file downloaded multiple times for filename: {0}",
c):(b={},b.fetchstart=a.fetchStart,b.responseend=a.responseEnd,b.iscached=this.Ssg(a),b.encodedsize=ur.nUa(a,"encodedBodySize"),b.decodedsize=ur.nUa(a,"decodedBodySize"),b.it=a.initiatorType,b.ress=a.responseStart,b.cs=a.connectStart,b.ce=a.connectEnd,b.dls=a.domainLookupStart,b.dle=a.domainLookupEnd,b.rs=a.redirectStart,b.re=a.redirectEnd,b.reqs=a.requestStart,b.scs=a.secureConnectionStart,this.FNa[c]=b))}Grh(a,b){if(this.sbf)return Array.contains(this.sbf,a);if(this.FGc)for(a=yg.a.wB(b),b=0;b<this.FGc.length;b++)if(this.FGc[b]&&
a.endsWith(this.FGc[b]))return!0;return!1}Xbl(a,b){return this.Grh(a,b)?a.endsWith(".js")||a.endsWith(".css"):!1}Ssg(a){try{const b=ur.nUa(a,"transferSize");if(void 0!==b&&null!==b)return!b;ka.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return a.responseEnd-a.fetchStart<this.gVh}catch(b){ka.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",b.message)}return!1}q1k(){if(ta.a.Xa(this.FNa))ka.ULS.sendTraceTag(575931855,
306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var a=w.AFrameworkApplication.flightId?w.AFrameworkApplication.flightId.split(";"):[],b=Object.assign(new Mj.a,{extendedProperties:$q.a.aA()});b.extendedProperties.set("Flights",De.c(a));this.Rbk(b,this.FNa,$d.Health.instance)}}g9d(a){let b=0,c=0,f=0,l=0;const y=this.FNa;for(let Q in y){var H=y[Q];Q.endsWith(".js")&&(H=Object(qa.a)(Object,H),H.responseend<a&&(b+=1,c+=H.decodedsize,l+=H.encodedsize,f+=H.iscached?0:H.encodedsize))}a=
{};a.filesLoaded=b;a.decodedBytes=c;a.transferredBytes=f;a.encodedBytes=l;return a}Rbk(a,b,c){if(b){var f=0,l=0,y=0,H=0,Q=0,ia=0,wa=0,Ua=0,kb=0,Gb=0,ec=0;for(let Fc in b){var dc=b[Fc];try{const yc=Object(qa.a)(Object,dc);if(!yc)continue;const tc=yc.iscached?Boolean.parse(yc.iscached.toString()):!1,xd=yc.fetchstart?this.parseFloat(yc.fetchstart.toString()):0,Vd=(yc.responseend?this.parseFloat(yc.responseend.toString()):0)-xd,Ld=yc.encodedsize?this.parseFloat(yc.encodedsize.toString()):0,ye=yc.decodedsize?
this.parseFloat(yc.decodedsize.toString()):0;f+=Vd;H+=Ld;wa+=ye;Gb++;tc?(y+=Vd,ia+=Ld,kb+=ye,ec++):(l+=Vd,Q+=Ld,Ua+=ye)}catch(yc){ka.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",yc.message)}}a.extendedProperties.set("StaticResources",De.c(b));a.extendedProperties.set("TotalResourceDownloadLatency",f.toString());a.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",l.toString());a.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",
y.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",H.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Q.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",ia.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",wa.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",Ua.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",kb.toString());
a.extendedProperties.set("TotalNumberOfResourcesDownloaded",Gb.toString());a.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",ec.toString());c.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);c.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",a)}}parseFloat(a){if(!a)return 0;a=parseFloat(a);return isNaN(a)?0:a}}Object(m.a)(nJ,"AppStaticResourceManager",null,[]);class oJ extends Sys.EventArgs{constructor(a){super();this.entries=
a}}Object(m.a)(oJ,"EntriesAvailableEventArgs",Sys.EventArgs,[]);class Iv{constructor(a,b,c=null,f=null,l=100,y=!1){this.nId=!1;this.nn=null;this.gTb=0;this.Ma=new Pc.a;this.C3a=null;this.lia=!1;this.xuf=0;this.Zd=a;this.Xdf=0;this.S9e=this;this.PDd=new KC(c);this.aE=b;f&&(this.C3a=new nJ(null,f,l));this.RTh=y}get gFf(){try{return!(void 0===this.aE||null===this.aE)&&!(void 0===this.aE.getEntriesByType||null===this.aE.getEntriesByType)}catch(a){return ka.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",
a),!1}}get qRi(){return this.Xdf}get isActive(){return this.lia}get r6e(){return this.xuf}Syf(a){this.Ma.addHandler(Iv.L5d,a)}soh(a){this.Ma.removeHandler(Iv.L5d,a)}Yb(a,b){const c=this.r6e!==a;this.xuf=a;this.isActive&&this.Zd&&c&&(this.Lg(),this.Hb());this.Xdf=b}activate(){!this.isActive&&this.gFf&&(this.Hb(),this.lia=!0)}deactivate(a){this.isActive&&(this.Lg(),a&&this.flush(),this.lia=!1)}flush(){if(this.isActive&&this.gFf)try{var a=window.performance.getEntriesByType("resource");0<a.length-this.gTb&&
ka.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",a.length-this.gTb);const b=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);b&&(window.performance.clearResourceTimings(),this.gTb=0);const c=[];for(let f=this.gTb;f<a.length;f++)this.PDd.Cng(a[f].name)&&(this.C3a&&(this.RTh?this.C3a.gJl(a[f]):this.C3a.fJl(a[f])),c.push(new ur(a[f],this.qRi)));b||(this.gTb=a.length);this.Ma.raiseEvent(Iv.L5d,
new oJ(c));for(a=0;a<c.length;a++)0!==c[a].behavior&&2!==c[a].behavior||this.S9e.mdb(0,c[a].B6e());0<c.length&&ka.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",c.length)}catch(b){ka.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",b)}}mdb(a,b){ka.ULS.sendTraceTag(4310804,306,50,mJ(a,b))}x0k(){this.C3a.q1k()}g9d(a){return this.C3a.g9d(a)}Hb(){this.Zd&&0<this.r6e&&(this.nn=new dd.a(3,2,1E3*this.r6e,
()=>{this.flush()},5),this.Zd.Hb(this.nn),this.nId=!0)}Lg(){this.nId&&(this.Zd.Lg(this.nn),this.nn=null,this.nId=!1)}}Iv.L5d="EntriesAvailable";Object(m.a)(Iv,"ResourceTimingLogger",null,[478,521]);class LC{constructor(){this.Da=null}get name(){return"Common.ResourceTiming"}init(){this.Da.resolve("Common.NetworkTiming.IResourceTimingLogger");ks.instance.run()}dispose(){}Yb(a){this.Da=a;let b=null;if(w.AFrameworkApplication.fa.ka("ResourceLoggerFilterDomainsIsEnabled"))try{b=w.AFrameworkApplication.fa.eA("ResourceLoggerDomainAllowList")}catch(y){ka.ULS.sendTraceTag(51652512,
306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const c=[];c.push(yg.a.wB($a.a.vP).toLowerCase());c.push(yg.a.wB($a.a.pOb).toLowerCase());const f=w.AFrameworkApplication.fa.wc("AppStaticResourceMonitorCacheThresholdInMs",100),l=w.AFrameworkApplication.fa.ka("PPTAggregateResourceTimingV2Enabled");a.register(478,"Common.NetworkTiming.IResourceTimingLogger").ma().oa(()=>new Iv(w.AFrameworkApplication.Ae,window.performance,b,c,f,l))}static main(){n.a.instance.Ac(new LC)}}Object(m.a)(LC,
"ResourceTimingPackage",null,[2,3]);class Jv{}Jv.visible="visible";Jv.hidden="hidden";Object(m.a)(Jv,"PlatformVisibilityState",null,[]);var sz=d(203);class pJ extends Sys.EventArgs{constructor(a,b){super();this.Bmf={};this.q3h=a;this.Z2h=b}get oldState(){return this.q3h}get newState(){return this.Z2h}mkb(a,b){this.Bmf[a]=b}toString(){return De.c(this.Bmf)}}Object(m.a)(pJ,"VisibilityStateChangeEventArgs",Sys.EventArgs,[]);class MC{constructor(a,b,c,f){this.vuf=this.qQa=null;this.btf=!0;this.Ma=new Pc.a;
this.Zd=a;this.nFd=b;this.eef=c;this.D$h=f;this.qkf=!1;w.AFrameworkApplication.fa&&(this.qkf=w.AFrameworkApplication.fa.ka("WordPriorityTaskLoggingOnComingOutOfFrozenIsEnabled"),this.btf=w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ListenToResumeEvents",!0));this.ubf=0;this.uuf=new Date;this.nFd()===Jv.hidden&&this.oOf();$addHandler(window,"focus",Object(I.a)(this,this.dah,"onPlatformFocusHandler"));$addHandler(window,"blur",Object(I.a)(this,this.yjd,"onPlatformBlurHandler"));
$addHandler(document,"freeze",Object(I.a)(this,this.eah,"onPlatformFreezeHandler"));$addHandler(document,"visibilitychange",Object(I.a)(this,this.fah,"onPlatformVisibilityChangeHandler"));this.btf&&($addHandler(document,"pageshow",Object(I.a)(this,this.yjd,"onPlatformBlurHandler")),$addHandler(document,"resume",Object(I.a)(this,this.yjd,"onPlatformBlurHandler")))}get E7a(){return this.ubf}get isVisible(){return 2!==this.E7a}lJc(a){this.Ma.addHandler("VST",a)}B8k(a){this.Ma.removeHandler("VST",a)}yjd(a){this.vQb(a.type,
this.iee())}dah(a){this.vQb(a.type,0)}eah(a){3!==this.E7a&&(this.IKf(),this.vQb(a.type,2),this.vQb(a.type,3),w.AFrameworkApplication.Rg.uuk())}iee(){return this.nFd()===Jv.hidden?2:document.hasFocus()?0:1}vQb(a,b){const c=this.E7a;this.ubf=b;if(c!==this.E7a){3===c&&this.qkf&&this.Bfl();const f=new Date,l=new pJ(c,this.E7a);l.mkb("FromState",Gn[c]);l.mkb("ToState",Gn[b]);l.mkb("OriginatingEvent",a);l.mkb("TimeInState",(+f-+this.uuf).toString());this.uuf=f;this.D$h.Nwg(l);this.Ma.raiseEvent("VST",l)}}fah(a){this.nFd()===
Jv.hidden?this.qQa?this.Zd.E1(this.qQa,this.eef):this.oOf():(this.IKf(),this.vQb(a?a.type:"",this.iee()))}dispose(){$removeHandler(window,"focus",Object(I.a)(this,this.dah,"onPlatformFocusHandler"));$removeHandler(window,"blur",Object(I.a)(this,this.yjd,"onPlatformBlurHandler"));$removeHandler(document,"freeze",Object(I.a)(this,this.eah,"onPlatformFreezeHandler"));$removeHandler(document,"visibilitychange",Object(I.a)(this,this.fah,"onPlatformVisibilityChangeHandler"))}IKf(){this.qQa&&(this.Zd.Lg(this.qQa),
this.qQa=null)}oOf(){this.qQa=new dd.a(4,1,this.eef,Object(I.a)(this,this.zGj,"handleVisibilityUpdate"),157);this.Zd.Hb(this.qQa)}zGj(){this.qQa=null;this.vQb("TaskItem",this.iee())}mdk(a){ka.ULS.sendTraceTag(557977793,324,50,"Time to execute task with Priority {0}:{1} Emergency View State: {2}",a.Vwg,+new Date-+this.vuf,sz.SessionStatusManager.instance.gla)}Bfl(){this.vuf=new Date;this.Zd.Hb(this.z3b(0,"Realtime"));this.Zd.Hb(this.z3b(1,"AboveNormal"));this.Zd.Hb(this.z3b(2,"Normal"));this.Zd.Hb(this.z3b(3,
"Background"));this.Zd.Hb(this.z3b(4,"Low"))}z3b(a,b){return new dd.a(a,1,0,Object(I.a)(this,this.mdk,"logTimeToExecuteTask"),0,b)}}Object(m.a)(MC,"VisibilityManager",null,[523,107]);class aR{Nwg(){}}Object(m.a)(aR,"NullVisibilityManagerTelemetry",null,[520]);class tz{constructor(){this.Ma=new Pc.a}Nwg(a){ka.ULS.sendTraceTag(590901976,324,50,a.toString())}static create(){return new tz}}Object(m.a)(tz,"VisibilityManagerTelemetry",null,[520]);class NC{constructor(){this.Da=null}get name(){return"Common.App.VisibilityManager"}init(){this.Da.resolve("Common.App.VisibilityManagement.IVisibilityManager")}dispose(){const a=
this.Da.qb("Common.App.VisibilityManagement.VisibilityManager");a&&a.dispose()}Yb(a){this.Da=a;this.Da.register(tz,"Common.App.VisibilityManagement.VisibilityManagerTelemetry").as("Common.App.VisibilityManagement.IVisibilityManagerTelemetry").oa(()=>tz.create()).ma();this.Da.register(MC,"Common.App.VisibilityManagement.VisibilityManager").as("Common.App.VisibilityManagement.IVisibilityManager").oa(()=>new MC(w.AFrameworkApplication.Ae,()=>window.document.visibilityState,6E4*w.AFrameworkApplication.fa.wc("VisibilityManagerDelayTransitionToHiddenInMin",
1),this.Da.resolve("Common.App.VisibilityManagement.VisibilityManagerTelemetry"))).ma()}static main(){n.a.instance.Ac(new NC)}}Object(m.a)(NC,"VisibilityManagerPackage",null,[2,3]);var bR=d(1262);class qJ{constructor(a,b){this.t7c=new Jd.a;this.w7c=new Jd.a;this.CIa=b;this.wXa=a}Np(a){!a||this.t7c.Fb(a.id)||this.w7c.Fb(a.id)||this.wXa.Np(a)}Bmh(a){this.Z2k(a)}Cmh(a){this.a3k(a)}Z2k(a){var b=null;this.CIa&&a&&(this.Np(a),b=b||Object(I.a)(this,this.ILe,"onDragOver"),this.t7c.$(a.id,b),this.wXa.rb(oa.a.drop,
a,b))}a3k(a){var b=null;this.CIa&&a&&(this.Np(a),b=b||Object(I.a)(this,this.JLe,"onDrop"),this.w7c.$(a.id,b),this.wXa.rb(oa.a.E9a,a,b))}Bb(a){this.CIa&&a&&(this.wXa.ir(a),this.t7c.ga(a.id)&&this.wXa.Bb(oa.a.E9a,a,this.t7c.ga(a.id)),this.w7c.ga(a.id)&&this.wXa.Bb(oa.a.drop,a,this.w7c.ga(a.id)))}MJj(){this.wXa&&this.wXa.dispose()}JLe(a){a=a.mc;a.preventDefault();a.stopPropagation();return!0}ILe(a){a=a.mc;a.preventDefault();a.stopPropagation();return!0}}Object(m.a)(qJ,"PPTDragDropInputHelper",null,[458]);
class OC{constructor(){this.K=null}get name(){return"PowerPointWebEditor.DragDrop"}Yb(a){if(!a)throw Error.argumentNull("container");this.K=a;this.K.register(458,"PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").ma().oa(()=>new qJ(bR.a.instance,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointDragInsertImageIsEnabled))}init(){const a=this.K.resolve("PowerPointWebEditor.AppFrame").vUd;a?(this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").Bmh(a),this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").Cmh(a)):
(this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").Bmh(this.K.resolve("PowerPointWebEditor.AppFrame").q2),this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").Cmh(this.K.resolve("PowerPointWebEditor.AppFrame").q2))}dispose(){this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").Bb(this.K.resolve("PowerPointWebEditor.AppFrame").vUd);this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").MJj()}static main(){n.a.instance.Ac(new OC)}}
Object(m.a)(OC,"PPTWebEditorDragDropPackage",null,[2,3]);class rJ{constructor(a){this.M4h=a}T0e(){return Math.random()<this.M4h}}Object(m.a)(rJ,"RandomSampler",null,[1541]);class sJ{constructor(a){this.zUb=null;this.w7h=a}I_b(a,b){if("ForceSample"===b||this.w7h())this.zUb||(this.zUb=[]),Array.add(this.zUb,a)}getData(){return this.zUb}reset(){this.zUb=null}}Object(m.a)(sJ,"SampleDataAggregator",null,[1536]);var tJ=d(544);class uJ{constructor(){this.metadata=null;this.duration=this.ths=this.timeStamp=
0;this.isCoauth=null}}Object(m.a)(uJ,"PPTEventTimingData",null,[]);class Hq{constructor(){this.DEe=!1;this.C$={};this.Jok=a=>{window.requestAnimationFrame(a)};this.PDb=[];this.C$.ArrowDown=!0;this.C$.ArrowLeft=!0;this.C$.ArrowRight=!0;this.C$.ArrowUp=!0;this.C$.Backspace=!0;this.C$.Delete=!0;this.C$.End=!0;this.C$.Enter=!0;this.C$.Home=!0;this.C$.PageDown=!0;this.C$.PageUp=!0;this.C$.Tab=!0}Itc(a){return a.ctrlKey&&"Control"!==a.key||a.altKey&&"Alt"!==a.key||a.key in this.C$}ksi(a){const b={};b.key=
this.Itc(a)?a.key:" "===a.key?"Space":"Char";b.alt=(void 0===a.altKey||null===a.altKey?!1:a.altKey).toString();b.ctrl=a.ctrlKey.toString();b.shift=a.shiftKey.toString();return b}aFh(a){const b=new uJ;b.metadata=this.ksi(a);b.ths=window.performance.now()-a.timeStamp;b.timeStamp=a.timeStamp;b.isCoauth=Hq.JRa?(!Hq.JRa.amIAlone).toString():"null";this.PDb.push(b);this.n4k()}tFh(a){if(this.PDb.length)for(const b of this.PDb)if(b.timeStamp===a.timeStamp){b.duration=window.performance.now()-a.timeStamp-
b.ths;break}}n4k(){this.DEe||(this.Jok(()=>{this.DEe=!1;window.dispatchEvent(tJ.a.instance.create(oa.a.WTd,this.PDb.slice(0,this.PDb.length)));this.PDb=[]}),this.DEe=!0)}keyPressedEventHandlerStart(a){Hq.b1c(a)&&!this.Itc(a)&&this.aFh(a)}keyPressedEventHandlerEnd(a){Hq.b1c(a)&&!this.Itc(a)&&this.tFh(a)}keyDownEventHandlerStart(a){Hq.b1c(a)&&this.Itc(a)&&this.aFh(a)}keyDownEventHandlerEnd(a){Hq.b1c(a)&&this.Itc(a)&&this.tFh(a)}static get JRa(){return Hq.sLf||(Hq.sLf=Ib.a.instance.qb("PowerPointWebEditor.ICoauthStateGetter"))}static b1c(a){return!!a&&
a.timeStamp<window.performance.now()}}Hq.sLf=null;Object(m.a)(Hq,"PPTEventTimingMeter",null,[456]);class ls{constructor(){this.cgc=[];this.wFb=this.W$c=this.kIa=this.Fcd=null;this.Ecd=0;this.B$c=!1}start(a){if(!this.B$c){Array.clear(this.cgc);for(let b=0;b<ls.K6b.length;++b)this.cgc.push(0);this.Fcd=window.setInterval(Object(I.a)(this,this.hqh,"reportMeasuredFrames"),1E3*a);this.Ecd=window.performance.now();this.s9e(null);$addHandler(window,"visibilitychange",Object(I.a)(this,this.s9e,"updateMeasureCurrentFrameLoop"));
this.B$c=!0}}stop(){this.B$c&&($removeHandler(window,"visibilitychange",Object(I.a)(this,this.s9e,"updateMeasureCurrentFrameLoop")),null!=this.Fcd&&(window.clearInterval(this.Fcd),this.Fcd=null),null!=this.kIa&&(window.cancelAnimationFrame(this.kIa),this.kIa=null),this.hqh(),this.B$c=!1)}hqh(){if(null!=this.wFb){var a={};for(var b=0;b<ls.K6b.length;++b)a[ls.K6b[b].toString()]=this.cgc[b],this.cgc[b]=0;b=window.performance.now();var c={};c.intervalStart=this.Ecd;c.duration=b-this.Ecd;c.maxFrameLengthMs=
this.wFb;c.frameData=a;window.dispatchEvent(tJ.a.instance.create(oa.a.pWe,c));this.wFb=null;this.Ecd=b}}s9e(){ls.a0j&&null==this.kIa?(this.W$c=null,this.kIa=window.requestAnimationFrame(Object(I.a)(this,this.z3g,"measureCurrentFrame"))):null!=this.kIa&&(window.cancelAnimationFrame(this.kIa),this.kIa=null)}z3g(a){if(null!=this.W$c){const b=a-this.W$c;if(null==this.wFb||this.wFb<b)this.wFb=b;for(let c=0;c<ls.K6b.length;++c)if(b<ls.K6b[c]){++this.cgc[c];break}}this.W$c=a;this.kIa=window.requestAnimationFrame(Object(I.a)(this,
this.z3g,"measureCurrentFrame"))}static get a0j(){return"visible"===window.document.visibilityState}}ls.K6b=[17,34,42,67,100,200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];Object(m.a)(ls,"PPTFrameTimingMeter",null,[457]);class PC{constructor(){this.rjc=this.Sdc=null;this.NHg=this.xHg=!1}Yb(a){window.performance&&window.performance.now&&window.requestAnimationFrame&&(w.AFrameworkApplication.fa.ka("PodEventTimingMeterIsEnabled")&&!z.a.Wj&&(a.register(456,"Common.IEventTimingMeter").ma().oa(()=>
new Hq),this.xHg=!0),a.resolve("PowerPointWebEditor.IApplicationSettings").podsFrameTimingMeterIsEnabled&&(a.register(457,"Common.IFrameTimingMeter").ma().oa(()=>new ls),this.NHg=!0))}get name(){return"PowerPointWebEditor.EventTimingMeter"}init(){if(this.xHg){var a=new rJ(w.AFrameworkApplication.fa.wc("PodEventTimingMeterEventSamplingPercent",0)/100);a=new sJ(Object(I.a)(a,a.T0e,"shouldBeInSample"));const b=bf.a.PW(16,1,a);this.Sdc=c=>{if(c&&(c=c.rawEvent.detail))for(const f of c)b.track(f,"EventTimingData")};
hd.a.addHandler(window.self,oa.a.WTd,this.Sdc)}this.NHg&&(this.rjc=b=>{b&&(b=b.rawEvent)&&xa.a.J(39706653,306,50,De.c(b.detail))},hd.a.addHandler(window.self,oa.a.pWe,this.rjc))}dispose(){this.Sdc&&(hd.a.removeHandler(window.self,oa.a.WTd,this.Sdc),this.Sdc=null);this.rjc&&(hd.a.removeHandler(window.self,oa.a.pWe,this.rjc),this.rjc=null)}static main(){n.a.instance.Ac(new PC)}}Object(m.a)(PC,"PPTEventTimingMeterPackage",null,[2,3]);var QC=d(459);class vJ{constructor(a){this.knf=new Jd.a(null);this.zYh=
a}ga(a){let b;({value:b}=this.knf.wg(a)).returnValue||(b=this.zYh(a),this.knf.$(a,b));return b}}Object(m.a)(vJ,"MemoizedLookup",null,[1570]);var cR=d(856),dR=d(725);class RC{constructor(a){this.bNk=0;this.cP=a}}Object(m.a)(RC,"GraphMergerResponse",null,[]);var eR=d(326);class SC extends Ig.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=this.BaseRevisions=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=0;this.RequestId=this.ObjectSpaceId=null;this.Reason=
this.Source=0}pl(){return 33}static construct(a,b,c,f,l,y,H,Q,ia){const wa=new SC;wa.BaseRevisions=a;wa.TheirRevisions=b;wa.YourRevisions=c;wa.IgnoreConflictsInLastServerRevision=f;wa.MergeHint=l;wa.ObjectSpaceId=y?Dk.a(y):null;wa.RequestId=H?Dk.a(H):null;wa.Source=Q;wa.Reason=ia;return wa}}Object(m.a)(SC,"CreateGraphMergeReplayRequest",Ig.a,[]);d(849);class uz{Ua(a){return a.Ua(void 0)}M$f(a,b){return a.sa(b,null)}LWc(a,b){a=(a=a.sa(b,null))?Array.clone(a):[];return new qj.a(a)}P$f(a,b){return a.sa(b,
"")}Hxh(a,b,c){a.setValue(b,c)}}Object(m.a)(uz,"MergeableObjectUtilities",null,[487]);class fR{constructor(a,b=null,c=null){this.SJd=b||new uz;c||Object(I.a)(this,this.UVi,"doParagraphMergeNoOP")}UVi(a,b){return{yYl:a,xYl:b}}}Object(m.a)(fR,"GraphMergeSelectionRecordUpdater",null,[]);class wJ{constructor(){this.source=0;this.Xu=this.JRb=this.NMa=null;this.rlc=0;this.vZc=!1;this.N3e=0}}Object(m.a)(wJ,"InputState",null,[]);class xJ{constructor(){this.timeout=this.succeeded=this.crash=!1;this.cP=null}}
Object(m.a)(xJ,"OutputState",null,[]);class yJ{constructor(){this.PTc=this.Ptd=this.Stc=!1;this.y2a=this.MLl=this.c3i=this.FIe=this.gMh=this.p_f=this.iEf=this.oNc=null}}Object(m.a)(yJ,"RuntimeState",null,[]);class zJ{constructor(){this.input=new wJ;this.runtime=new yJ;this.output=new xJ}}Object(m.a)(zJ,"MergeState",null,[]);var ad=d(1133);class Fx{constructor(a,b,c){this.d5h=a;this.r3h=b;this.$2h=c;this.ZGd=new Bb.a(Object(I.a)(this,this.$yi,"checkIfDifferent"))}get LKb(){return this.d5h}get oldValue(){return this.r3h}get newValue(){return this.$2h}get u9(){return!!this.newValue&&
!this.oldValue}get isDeleted(){return!this.newValue&&!!this.oldValue}get Ybb(){return this.u9||this.isDeleted||this.ZGd.value}$yi(){return this.u9||this.isDeleted?!0:!ad.a.aDf(this.LKb,this.oldValue,this.newValue)}}Object(m.a)(Fx,"PropertyDiff",null,[]);class Gx{constructor(a,b){this.o3h=a;this.X2h=b;this.ZGd=new Bb.a(()=>this.P0c(null));this.f5h=new Bb.a(Object(I.a)(this,this.e0i,"evaluatePropertyDiffs"))}get JIb(){return this.o3h}get W5(){return this.X2h}get u9(){return!!this.W5&&!this.JIb}get isDeleted(){return!this.W5&&
!!this.JIb}get Ybb(){return this.u9||this.isDeleted||this.ZGd.value}get W_a(){return this.f5h.value}P0c(a){let b=!1;this.W_a.forEach((c,f)=>{b=f.Ybb&&(!a||7!==a.ga(c));return!b});return b}e0i(){const a=new Jd.a;var b=this.W5,c=this.JIb;if(this.u9){c=b.mA();for(var f=0;f<c.length;f++){var l=c[f];a.$(ad.a.xb(l),new Fx(l,null,b.aua(l)))}}else if(this.isDeleted)for(b=c.mA(),f=0;f<b.length;f++)l=b[f],a.$(ad.a.xb(l),new Fx(l,c.aua(l),null));else{f=c.mA();for(l=0;l<f.length;l++){var y=f[l];a.$(ad.a.xb(y),
new Fx(y,c.aua(y),b.Ua(y)?b.aua(y):null))}f=b.mA();for(l=0;l<f.length;l++)y=f[l],c.Ua(y)||a.$(ad.a.xb(y),new Fx(y,null,b.aua(y)))}return a}}Object(m.a)(Gx,"MergeableObjectDiff",null,[]);class Hx{constructor(a,b){this.T5=b?a.E8a():a;this.uHc=new Ma.a}hpl(a){this.uHc=a}P3g(a){(new Gx(this.T5,a)).W_a.forEach((b,c)=>{c.Ybb&&!this.uHc.contains(b)&&(this.uHc.add(b),c.isDeleted?(c=this.T5,c.Ua(ad.a.Ita(b))&&c.removeProperty(ad.a.Ita(b))):this.T5.OLa(ad.a.Ita(b),c.newValue));return!0})}}Object(m.a)(Hx,"PartialMergeResult",
null,[]);class AJ extends Ig.a{constructor(){super();this.Location=null}pl(){return 34}static construct(a){const b=new AJ;b.Location=a;return b}}Object(m.a)(AJ,"PlayGraphMergeReplayRequest",Ig.a,[]);class Kv{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua){this.Xte=new cR.a;this.rpk=a;this.vlk=b;this.BYa=c(this.N7b());this.aik=f;this.bik=l;this.Qcd=y;this.Dad=H;this.qEg=Q;this.Yhk=Ua;this.Zhk=ia;this.$hk=wa}BL(){return(new Date).getTime()}mmb(a,...b){return String.format.apply(null,[a].concat(b))}PFl(a){throw Ka.a.invalidOperation(a);
}Ogj(a){return String.format("Name: {0}, Message: {1}, Stack: {2}",a.name,a.message,a.stack)}RCj(a,b,c,f){f.$(a,new Hx(b,!1));ka.ULS.sendTraceTag(19019783,808,50,"Merging Object: [Id: {0}] [ClassId: {1}]. Object wasn't in base revision, but was in conflict and favored.",a,c.Xe);return!0}TPl(a,b){const c=new Jn.a;c.id=ve.a.Cga;c.OLa(zb.a.fqd,5===b?2:4);a.iyf(c);a.Cwd().hza(c.id,4)}ehl(a){var b=!a.output.succeeded&&(this.Zhk||a.output.crash),c=!!a.input.NMa&&0<a.input.NMa.length;if(c=this.$hk&&c&&(this.Yhk||
b)){b=c?ha.a.create():ha.a.nil;c=c?String.format(" [Merge Request Id: {0}]",b):"";Kv.Zbk(a,c);var f,l;({Voi:y,JFl:f,OVl:l}=this.mOi(a,Object(I.a)(this,this.cQf,"createSerializedRevisionFrom")));c=Kv.Whj(a);b=SC.construct(y._list,f._list,l._list,a.input.vZc,a.input.rlc,a.input.Xu,b,a.input.source,c);var y=a.output.cP;3===c&&0<y.length&&(b.MergedRevision=this.cQf(a.output.cP.last()));a=new eR.a;a.TH=b;a.status=1;b=this.Xte.a7b(0,null);b.WZ(a);b.SDa()}}cQf(a){const b=a.sW,c=Rc.App.Lb.Kd.Di;return new dR.a(a,
b,c.Fi,null,c.Qqc,c.contextId,b?b.id:ha.a.nil,this.Qcd,!1,!0)}fgd(a,b,c,f,l,y,H){c=this.vMi(a,b,f,l,y,H);f=0;const Q=c.runtime.Ptd;try{if(Q){const ia=a.length?a.getItemAt(a.length-1):null,wa=b.length?b.getItemAt(b.length-1):null;ka.ULS.sendTraceTag(18641173,808,50,"MergeChanges: Begin.  [TheirChanges - Length:{0} Last:{1} Base:{2}] [YourChanges - Length:{3} Last:{4} Base:{5}] [MergeHint: {6}] [IgnoreConflictsInLastServerRevision: {7}] [MaxMergeTimeInMs: {8}] [FullPropertyLoggingIsEnabled: {9}] [Source: {10}]",
a.length,ia?ia.id:ha.a.nil,ia?ia.sW?ia.sW.id:ha.a.nil:ha.a.nil,b.length,wa?wa.id:ha.a.nil,wa?wa.sW?wa.sW.id:ha.a.nil:ha.a.nil,l,y,this.Dad,this.qEg,H)}for(a=!0;f<this.BYa.length&&a;f++)a=(0,this.BYa[f])(c);return new RC(c.output.cP)}catch(ia){const wa=!c.output.timeout;c.output.crash=wa;const Ua=String.format("Merge {0}!  Failing the merge.  [{1}] [Will continue: {2}]",wa?"Crashed":"Timed Out",this.Ogj(ia),!!c.output.cP);wa?ka.ULS.sendTraceTag(18613134,808,10,"MergeChanges Crash. [Error: {0}]",Ua):
ka.ULS.sendTraceTag(18613136,808,15,"MergeChanges Timeout. [Error: {0}]",Ua);if(c.output.cP)return new RC(c.output.cP);throw ia;}finally{c.output.succeeded?Q&&ka.ULS.sendTraceTag(18613138,808,50,this.v7b(c,f,"Succeeded")):c.output.timeout?ka.ULS.sendTraceTag(18641178,808,15,this.v7b(c,f,"Timeout")):c.output.crash?c.output.cP?ka.ULS.sendTraceTag(18613142,808,15,this.v7b(c,f,"Crash - Rejection")):ka.ULS.sendTraceTag(18613144,808,15,this.v7b(c,f,"Crash - Failed")):Q&&ka.ULS.sendTraceTag(18613140,808,
50,this.v7b(c,f,"Rejection")),this.ehl(c)}}v7b(a,b,c){const f=a.output.cP,l=f&&f.length?f.getItemAt(f.length-1):null;return this.mmb("MergeChanges: End. {0}. [ElapsedTime: {1}ms] [Function: {2}] [MergedRevisions - Length:{3} Last:{4} Base:{5}] [Source: {6}]",c,this.BL()-a.input.N3e,b,f?f.length:0,l?l.id:ha.a.nil,l?l.sW?l.sW.id:ha.a.nil:ha.a.nil,a.input.source)}vMi(a,b,c,f,l,y){const H=new zJ,Q=H.input;Q.NMa=a;Q.JRb=b;Q.Xu=c;Q.rlc=f;Q.vZc=l;Q.N3e=this.BL();Q.source=y;a=H.runtime;a.PTc=this.qEg;a.Stc=
!0;a.Ptd=!0;let ia="";a.y2a=wa=>{if(this.Dad){var Ua=this.BL()-Q.N3e,kb=Ua>this.Dad;ia+=this.mmb(" ({0}: {1})",wa,Ua);kb&&(H.output.timeout=!0,wa=this.mmb("Exceeded [MaxMergeTimeInMs: {0}] when we reached [Details: {1}] [Elapsed Time: {2}] [Timeline:{3}]",this.Dad,wa,Ua,ia),this.PFl(wa))}};return H}N7b(){return[Object(I.a)(this,this.nKk,"otherAuthorsHaveChangesToMerge"),Object(I.a)(this,this.xYj,"isInputValid"),Object(I.a)(this,this.yOj,"initializeOutputMergeState"),Object(I.a)(this,this.SOj,"initializeRuntimeMergeState"),
Object(I.a)(this,this.oKl,"tryObjectMerge"),Object(I.a)(this,this.Mci,"addMergeResultsToOutput")]}nKk(a){const b=a.input.NMa;a=a.output;return b?b.length?!0:(ka.ULS.sendTraceTag(18613150,808,100,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),a.cP=b,a.succeeded=!0,!1):(ka.ULS.sendTraceTag(18613148,808,100,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),a.cP=b,a.succeeded=!0,!1)}xYj(a){var b=a.input;const c=b.NMa,f=b.JRb,l=b.Xu,y=b.rlc;b=b.vZc;
a=a.output;if(!f||!f.length)return a.cP=c,!1;let H=!0;if(2!==y&&1!==y)return a.cP=c,!1;l&&l!==ha.a.nil||(H=!1);c.length<(b?2:1)&&(ka.ULS.sendTraceTag(18613155,808,100,"OtherAuthorsHaveChangesToMerge: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",b),H=!1);H||(a.cP=2===y?c:f);return H}SOj(a){var b=a.input,c=b.NMa,f=b.JRb;const l=b.rlc;let y,H;({IFl:y,NVl:H,oNc:b}=this.Sjj(a,c,f,b.vZc));if(!b)return ka.ULS.sendTraceTag(18613185,
808,15,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",y.id,H.id),this.Bwg(y,c.length,"TheirChanges"),this.Bwg(H,f.length,"YourChanges"),a.output.cP=2===l?c:f,!1;a.runtime.oNc=b;({KLl:c,a3i:f}=this.NTi(l,y,H));({LLl:b,b3i:c,Woi:f}=Kv.Clj(a,c,f,b));a.runtime.iEf=f;a.runtime.gMh=b;a.runtime.p_f=c;a.runtime.FIe=new Jd.a;return!0}Bwg(a,b,c){const f=new qj.a;for(;a;)f.add(a),a=a.sW;const l=new Sys.StringBuilder;l.append(this.mmb("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",
c,b,f.length));let y=f.length,H=0;f.forEach(Q=>({qig:y,Uwg:H}=this.Ndi(l,Q,f,y,H)).returnValue);ka.ULS.sendTraceTag(18613187,808,50,l.toString())}Ndi(a,b,c,f,l){a.append(this.mmb(" [{0} {1} {2}]",f,b.Rla?"S":"B",b.id));f--;l++;return 50<l&&c.length!==l?(a.append(" ...Truncated."),{returnValue:!1,qig:f,Uwg:l}):{returnValue:!0,qig:f,Uwg:l}}Sjj(a,b,c,f){b=b.getItemAt(b.length-1-(f?1:0));c=c.getItemAt(c.length-1);f=b.IUc(c);a.runtime.y2a("GetCommonBase");return{IFl:b,NVl:c,oNc:f}}NTi(a,b,c){2===a?(a=
b,b=c):a=c;return{KLl:b,a3i:a}}yOj(a){const b=a.input,c=b.NMa,f=b.JRb;a.output.cP=(2===b.rlc?c:f).xql();a.runtime.y2a("InitializeOutputMergeState");return!0}Mci(a){var b=a.input.Xu;const c=a.runtime.FIe,f=a.output.cP;b=this.wMi(a,f.getItemAt(f.length-1),b,ha.a.create());this.Y3i(a,b,c);this.TPl(b,a.input.source);f.add(b);return a.output.succeeded=!0}wMi(a,b,c,f){a.runtime.Ptd&&ka.ULS.sendTraceTag(18613189,808,50,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",
c,f);a=this.rpk(f);a.lpi(b,c);return a}Y3i(a,b,c){a.runtime.Ptd&&ka.ULS.sendTraceTag(18613191,808,50,"FillRevision: Adding {0} objects to merged revision.",c.count);c.forEach((f,l)=>{ve.a.Cga.equals(f)||b.iyf(l.T5);return!0})}oKl(a){const b=a.runtime,c=b.iEf,f=b.gMh,l=b.p_f,y=b.FIe;let H=!0;const Q=a.runtime.Stc;let ia=0,wa=0,Ua=0;f.forEach((kb,Gb)=>{Q&&ka.ULS.sendTraceTag(18613193,808,100,"Merging Object: [Id: {0}] [ClassId: {1}]",kb,Gb.Xe);wa++;50===wa&&(ia++,a.runtime.y2a(this.mmb("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}]",
ia,Ua)),wa=0);if(Kv.ayl(Gb.Xe))return!0;var ec=l.get(kb);if(!ec)return y.Fb(kb)?y.ga(kb).P3g(Gb):y.$(kb,new Hx(Gb,!1)),!0;if(!c.ga(kb))return H=this.RCj(kb,ec,Gb,y);const dc=y.sWc(kb,new Hx(c.ga(kb),!0));({raa:ec,returnValue:H}=this.bik.merge(a,this.aik,this.vlk,dc,ec,Gb));Ua++;H&&(a.runtime.y2a(this.mmb("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}]",kb,Gb.Xe,Ua,ia)),ec&&(y.Fb(ec.T5.id)?y.ga(ec.T5.id).P3g(ec.T5):y.$(ec.T5.id,ec)));return H});Q&&ka.ULS.sendTraceTag(18613199,
808,100,"TryObjectMerge: Merged {0} objects. {1} were complex merges.",f.count,Ua);return H}mOi(a,b){const c=new qj.a,f=new qj.a,l=new qj.a;var y=a.runtime.oNc;const H=y?y.id:ha.a.nil;this.Tre(y).forEach(Q=>{c.add(b(Q));return!0});y=a.input.NMa.getItemAt(a.input.NMa.length-1);this.Tre(y,H).forEach(Q=>{f.add(b(Q));return!0});a=a.input.JRb.getItemAt(a.input.JRb.length-1);this.Tre(a,H).forEach(Q=>{l.add(b(Q));return!0});return{Voi:c,JFl:f,OVl:l}}Tre(a,b=null){const c=new qj.a;b||(b=ha.a.nil);for(;a&&
!b.equals(a.id);)c.add(a),a=a.sW;c.reverse();return c}vb(){}get delayedMergeOperation(){return null}set delayedMergeOperation(a){}static Zbk(a,b){ka.ULS.sendTraceTag(18613146,808,50,"Sending merge backup. [Crash: {0}] [Timeout: {1}] {2}",a.output.crash,a.output.timeout,b)}static Whj(a){return a.output.crash?2:a.output.succeeded?3:1}static Clj(a,b,c,f){let l;({result:l}=b.hgd(f));a.runtime.y2a("GetUnfavoredChanges");let y;new Jd.a;({result:y}=c.hgd(f));5===a.input.source&&(a.runtime.c3i=QC.a.Z$f(c.Cwd()),
a.runtime.MLl=QC.a.Z$f(b.Cwd()));b=y;a.runtime.y2a("GetFavoredChanges");f=new vJ(Object(I.a)(f,f.wyb,"getMergeableObject"));a.runtime.y2a("GetModifiedObjects");return{LLl:l,b3i:b,Woi:f}}static ayl(a){switch(a){case 1074135137:case 1074135138:case 1074135140:return!0}return!1}}Object(m.a)(Kv,"GraphMerger",null,[575,455]);class BJ{get JDa(){return 8}get XKa(){return[]}get tNa(){return[ad.a.xb(zb.a.dN),ad.a.xb(zb.a.svc)]}get jNa(){return[]}get DRa(){return[ad.a.xb(ab.a.tB)]}get nSa(){return[]}wG(a){return 1074135126===
a.Xe}I2a(){return!0}get IDa(){return[ad.a.xb(zb.a.cid),ad.a.xb(zb.a.sid)]}get P1a(){return!0}}Object(m.a)(BJ,"CommentContentNodeComplexMerge",null,[488]);class CJ{get JDa(){return 8}get XKa(){return[]}get tNa(){return[ad.a.xb(zb.a.bvb),ad.a.xb(zb.a.WZd),ad.a.xb(zb.a.$ub),ad.a.xb(zb.a.s2b),ad.a.xb(zb.a.pQe),ad.a.xb(zb.a.oQe),ad.a.xb(zb.a.dN),ad.a.xb(zb.a.svc),ad.a.xb(zb.a.jZd)]}get jNa(){return[ad.a.xb(zb.a.eda),ad.a.xb(zb.a.Fsa),ad.a.xb(zb.a.MZd),ad.a.xb(zb.a.t2b),ad.a.xb(zb.a.fNc),ad.a.xb(zb.a.reactions)]}get DRa(){return[]}get nSa(){return[]}wG(a){return 1074135127===
a.Xe}I2a(){return!0}get IDa(){return[ad.a.xb(zb.a.cid),ad.a.xb(zb.a.sid),ad.a.xb(zb.a.commentId),ad.a.xb(zb.a.cya),ad.a.xb(Ab.a.NZd),ad.a.xb(zb.a.OZd),ad.a.xb(zb.a.t2b),ad.a.xb(zb.a.fNc),ad.a.xb(zb.a.reactions)]}get P1a(){return!0}}Object(m.a)(CJ,"CommentNodeComplexMerge",null,[488]);class DJ{constructor(a){this.Cdd=a}get JDa(){return 8}get XKa(){return[]}get tNa(){return this.Cdd.tNa}get jNa(){return[]}get DRa(){return[ad.a.xb(ab.a.tB)]}get nSa(){return[]}wG(a){return 393326===a.Xe}I2a(){return!0}get IDa(){const a=
new Na.a;Yr.a(a,this.Cdd.XKa);Yr.a(a,this.Cdd.IDa);Yr.a(a,this.Cdd.jNa);Yr.a(a,[ad.a.xb(zb.a.lBb),ad.a.xb(zb.a.rhd)]);return a.toArray()}get P1a(){return!0}}Object(m.a)(DJ,"NotesContentNodeComplexMerge",null,[488]);class EJ{get JDa(){return 8}get XKa(){return[ad.a.xb(zb.a.jWi),ad.a.xb(zb.a.dWi),ad.a.xb(zb.a.D$b),ad.a.xb(zb.a.grl)]}get tNa(){return[ad.a.xb(zb.a.Wsb),ad.a.xb(zb.a.Xsb),ad.a.xb(zb.a.gtb),ad.a.xb(zb.a.htb),ad.a.xb(zb.a.PDa),ad.a.xb(zb.a.sJe),ad.a.xb(zb.a.XIe),ad.a.xb(zb.a.tJe),ad.a.xb(zb.a.gMb),
ad.a.xb(zb.a.iMb),ad.a.xb(zb.a.Tzb),ad.a.xb(zb.a.Yvb),ad.a.xb(zb.a.SJb)]}get jNa(){return[]}get DRa(){return[ad.a.xb(ab.a.Q8a),ad.a.xb(Ab.a.appsNode)]}get nSa(){return[]}wG(a){return 393271===a.Xe}get IDa(){return[ad.a.xb(zb.a.presentationId),ad.a.xb(zb.a.slideWidth),ad.a.xb(zb.a.slideHeight),ad.a.xb(zb.a.JY),ad.a.xb(zb.a.Maa),ad.a.xb(zb.a.$ab),ad.a.xb(zb.a.OHb),ad.a.xb(zb.a.mY),ad.a.xb(zb.a.BIb),ad.a.xb(zb.a.aga),ad.a.xb(zb.a.embeddedFonts),ad.a.xb(zb.a.EKa)]}get P1a(){return!0}I2a(){return!0}}Object(m.a)(EJ,
"PresentationNodeComplexMerge",null,[488]);class FJ{get JDa(){return 8}get XKa(){return[ad.a.xb(zb.a.WKa),ad.a.xb(zb.a.DMb)]}get tNa(){return[ad.a.xb(ab.a.font),ad.a.xb(zb.a.bD),ad.a.xb(zb.a.VLc),ad.a.xb(zb.a.Qib),ad.a.xb(zb.a.dN),ad.a.xb(zb.a.b2a),ad.a.xb(zb.a.hn),ad.a.xb(zb.a.E_a),ad.a.xb(zb.a.Vzb),ad.a.xb(zb.a.jea),ad.a.xb(zb.a.fMa),ad.a.xb(zb.a.I1),ad.a.xb(zb.a.sha),ad.a.xb(zb.a.m4b),ad.a.xb(zb.a.pxb),ad.a.xb(zb.a.Iya),ad.a.xb(zb.a.xza),ad.a.xb(zb.a.Epa),ad.a.xb(zb.a.wza),ad.a.xb(zb.a.mediaType),
ad.a.xb(zb.a.Qib),ad.a.xb(zb.a.ZBb),ad.a.xb(zb.a.ldh),ad.a.xb(zb.a.ndh),ad.a.xb(zb.a.ypa),ad.a.xb(zb.a.Lga),ad.a.xb(zb.a.vzh),ad.a.xb(zb.a.rtd),ad.a.xb(ab.a.Vl),ad.a.xb(ab.a.xJ),ad.a.xb(zb.a.dIh),ad.a.xb(zb.a.eIh),ad.a.xb(zb.a.QPb),ad.a.xb(zb.a.IMa),ad.a.xb(zb.a.pba),ad.a.xb(zb.a.Gvc),ad.a.xb(zb.a.RM),ad.a.xb(zb.a.outlineWidth),ad.a.xb(Ts.a.Kqd),ad.a.xb(zb.a.xmd),ad.a.xb(km.a.xac),ad.a.xb(zb.a.IN),ad.a.xb(zb.a.mQ),ad.a.xb(zb.a.svc),ad.a.xb(zb.a.YOb),ad.a.xb(zb.a.uza),ad.a.xb(zb.a.Iub),ad.a.xb(zb.a.fCb),
ad.a.xb(zb.a.EN),ad.a.xb(zb.a.RDh),ad.a.xb(zb.a.Wzb)]}get jNa(){return[ad.a.xb(zb.a.alt),ad.a.xb(zb.a.esa),ad.a.xb(zb.a.taa),ad.a.xb(zb.a.Wne),ad.a.xb(zb.a.Hqe),ad.a.xb(zb.a.rla),ad.a.xb(zb.a.shapeType),ad.a.xb(zb.a.RPb),ad.a.xb(zb.a.rotation),ad.a.xb(zb.a.Urc),ad.a.xb(zb.a.yda),ad.a.xb(zb.a.xda),ad.a.xb(ab.a.Ix),ad.a.xb(ab.a.jD),ad.a.xb(ab.a.Iy),ad.a.xb(ab.a.Jy),ad.a.xb(zb.a.IRb),ad.a.xb(zb.a.Czb),ad.a.xb(zb.a.Z$e),ad.a.xb(zb.a.aaf),ad.a.xb(zb.a.m3),ad.a.xb(zb.a.xP),ad.a.xb(zb.a.vja),ad.a.xb(zb.a.uja),
ad.a.xb(zb.a.xja),ad.a.xb(zb.a.wja),ad.a.xb(zb.a.Y2e),ad.a.xb(zb.a.otd),ad.a.xb(zb.a.Dga),ad.a.xb(zb.a.qtd),ad.a.xb(zb.a.ova),ad.a.xb(zb.a.CJc)]}get DRa(){return[ad.a.xb(ab.a.tB)]}get nSa(){return[]}wG(a){return 1074135132===a.Xe}I2a(){return!0}get IDa(){return[ad.a.xb(zb.a.cid),ad.a.xb(zb.a.sid),ad.a.xb(zb.a.shapeId),ad.a.xb(zb.a.WVa),ad.a.xb(zb.a.y_a),ad.a.xb(zb.a.FJa),ad.a.xb(zb.a.eVj),ad.a.xb(zb.a.YL),ad.a.xb(zb.a.isResizable),ad.a.xb(zb.a.isEditable),ad.a.xb(zb.a.hva),ad.a.xb(zb.a.lJ),ad.a.xb(zb.a.Qj),
ad.a.xb(zb.a.ZR),ad.a.xb(zb.a.FSa),ad.a.xb(zb.a.GSa),ad.a.xb(zb.a.Yab),ad.a.xb(zb.a.jcc),ad.a.xb(zb.a.hasText),ad.a.xb(zb.a.YT),ad.a.xb(zb.a.nr),ad.a.xb(zb.a.isConnected),ad.a.xb(zb.a.Of),ad.a.xb(zb.a.bGa),ad.a.xb(zb.a.Jq),ad.a.xb(zb.a.rz),ad.a.xb(zb.a.pp),ad.a.xb(zb.a.yea),ad.a.xb(zb.a.rl),ad.a.xb(zb.a.cU),ad.a.xb(zb.a.qj),ad.a.xb(zb.a.Wf),ad.a.xb(zb.a.e0),ad.a.xb(zb.a.iq),ad.a.xb(zb.a.Hx),ad.a.xb(zb.a.qsa),ad.a.xb(zb.a.OJc),ad.a.xb(zb.a.Jub),ad.a.xb(ab.a.kO),ad.a.xb(Ab.a.i0),ad.a.xb(zb.a.D$b),ad.a.xb(zb.a.QVf),
ad.a.xb(zb.a.M4d),ad.a.xb(zb.a.Z9k),ad.a.xb(zb.a.mpd),ad.a.xb(zb.a.Vf),ad.a.xb(zb.a.mhd),ad.a.xb(zb.a.Mfe),ad.a.xb(zb.a.Bfe),ad.a.xb(zb.a.hL),ad.a.xb(zb.a.Mua),ad.a.xb(zb.a.G0b),ad.a.xb(zb.a.XQ),ad.a.xb(zb.a.NQb),ad.a.xb(zb.a.embeddedFonts),ad.a.xb(zb.a.SFa),ad.a.xb(zb.a.Fvc),ad.a.xb(zb.a.YQh),ad.a.xb(zb.a.Nih),ad.a.xb(zb.a.x4c),ad.a.xb(zb.a.ptd),ad.a.xb(zb.a.$fa),ad.a.xb(zb.a.Yoa),ad.a.xb(zb.a.r4),ad.a.xb(zb.a.wIb),ad.a.xb(zb.a.xIb),ad.a.xb(zb.a.yIb),ad.a.xb(zb.a.boa),ad.a.xb(zb.a.u4)]}get P1a(){return!0}}
Object(m.a)(FJ,"ShapeNodeComplexMerge",null,[488]);class Ix{constructor(a,b){this.dqk=a;this.Rqk=b}get JDa(){return this.Rqk}get XKa(){return[]}get tNa(){return[]}get jNa(){return[]}get DRa(){return[]}get nSa(){return[]}wG(a){return this.dqk(a)}I2a(){return!1}get IDa(){return[]}get P1a(){return!1}}Object(m.a)(Ix,"SimpleStrategyComplexMerge",null,[488]);class GJ{get JDa(){return 8}get XKa(){return[]}get tNa(){return[ad.a.xb(zb.a.backgroundColor),ad.a.xb(zb.a.gta),ad.a.xb(zb.a.h6e),ad.a.xb(zb.a.Fba),
ad.a.xb(zb.a.Doa),ad.a.xb(zb.a.Naa),ad.a.xb(zb.a.Ww),ad.a.xb(zb.a.gsa),ad.a.xb(zb.a.IN),ad.a.xb(zb.a.mQ),ad.a.xb(zb.a.dN),ad.a.xb(zb.a.zza)]}get jNa(){return[ad.a.xb(zb.a.D2a),ad.a.xb(zb.a.jj),ad.a.xb(zb.a.Ln),ad.a.xb(zb.a.Ed),ad.a.xb(zb.a.animations),ad.a.xb(zb.a.NTc),ad.a.xb(zb.a.hUd)]}get DRa(){return[ad.a.xb(ab.a.tB),ad.a.xb(zb.a.notesContentNode),ad.a.xb(Ab.a.commentContentNode)]}get nSa(){return[]}wG(a){return 393227===a.Xe}I2a(){return!0}get IDa(){return[ad.a.xb(zb.a.cid),ad.a.xb(zb.a.sid),
ad.a.xb(zb.a.gT),ad.a.xb(zb.a.rDh),ad.a.xb(ab.a.yn),ad.a.xb(zb.a.sWa),ad.a.xb(zb.a.eea),ad.a.xb(zb.a.qFa),ad.a.xb(zb.a.jbb),ad.a.xb(zb.a.title),ad.a.xb(zb.a.JY),ad.a.xb(zb.a.Maa),ad.a.xb(zb.a.D$b),ad.a.xb(zb.a.ibb),ad.a.xb(zb.a.abb),ad.a.xb(zb.a.Vf),ad.a.xb(zb.a.Yoa)]}get P1a(){return!0}}Object(m.a)(GJ,"SlideNodeComplexMerge",null,[488]);class HJ{constructor(a,b){this.HCg=a;this.bgk=b}ga(a){return this.HCg.sWc(a,this.bgk)}get T5d(){return this.HCg}}Object(m.a)(HJ,"PropertyMergeStrategies",null,[]);
const TC=(a,b,c,f,l)=>{if(b){f=f||new uz;if(!a){a=b=b.E8a();const y=a.mA();for(let H=0;H<y.length;H++){const Q=y[H];if(W.a.F2f(Q)===W.a.string){const ia=f.P$f(a,Q);f.Hxh(a,Q,ia?"Redacted: "+ia.length:"null")}}}ka.ULS.sendTraceTag(18613206,l,50,c,b.Bwd())}else ka.ULS.sendTraceTag(18613204,l,10,c,"{0}: Node was null.",c)};class IJ{constructor(a,b,c){this.zzg=new Ma.a;this.Gad=a;this.rwa=b;this.BYa=c(this.N7b());this.ulk=new Bb.a(Object(I.a)(this,this.T5d,"evalPropertyMergeStrategies"))}abk(a){if(!a.yQh){a.yQh=
!0;var b=a.igd.runtime.PTc,c=a.Xvk;TC(b,a.S7a.value.JIb,"Base",c,808);TC(b,a.S7a.value.W5,"Favored",c,808);TC(b,a.A0b.value.W5,"Conflict",c,808)}}jKl(a,b,c,f){this.Mea(a,c);const l=a.raa;if(2===f||7===f||a.tlc.contains(c))return!0;if(5===f)return!1;if(4===f||3===f){if(({value:y}=a.S7a.value.W_a.wg(c)).returnValue&&y.Ybb)return 4!==f;f=0}if(0===f){if(!b.isDeleted)return l.OLa(ad.a.Ita(c),b.newValue),!0;f=6}if(8===f){let H=a.uNc.value;b=!0;if(({value:y}=H.W_a.wg(c)).returnValue&&H.Ybb){var y=this.Gad.krj(a.igd.input.source,
y);void 0!==y&&null!==y?l.OLa(ad.a.Ita(c),y):(b=!1,f=6)}if(b)return!0}return 9===f&&(b=!0,({value:y}=a.uNc.value.W_a.wg(c)).returnValue&&(y=this.Gad.$cg(a.igd.input.source,y),void 0!==y&&null!==y?l.OLa(ad.a.Ita(c),y):(b=!1,f=6)),b)?!0:6===f?(l.removeProperty(ad.a.Ita(c)),!0):1===f?this.rwa.I2a(a,c):!1}KZa(a){return a}N7b(){return[Object(I.a)(this,this.sKl,"tryPreProcessFavoredRevision"),Object(I.a)(this,this.VBi,"cloneObjectAndRemoveNeededProperties"),Object(I.a)(this,this.iKl,"tryMergeNodeInternal")]}get Amd(){return this.ulk.value}hKl(a){const b=
a.S7a.value;ka.ULS.sendTraceTag(18659235,808,100,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",b.W5.id,b.W5.Xe);for(let c=0;c<this.BYa.length;c++)if(!(0,this.BYa[c])(a))return ka.ULS.sendTraceTag(18659265,808,50,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",b.W5.id,b.W5.Xe,c),this.abk(a),a.raa=null,!1;ka.ULS.sendTraceTag(18659267,808,100,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",b.W5.id,b.W5.Xe);
return!0}sKl(a){const b=a.S7a.value;if(!b.Ybb)return!0;const c=this.Amd;let f=!0;b.W_a.forEach((l,y)=>{if(!y.Ybb||a.tlc.contains(l))return!0;y=c.ga(l);if(5===y)return ka.ULS.sendTraceTag(18659269,808,50,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",b.JIb.Xe,l,y),f=!1;6===y&&a.yRe.add(l);return!0});return f}VBi(a){a.raa=a.S7a.value.W5.E8a();const b=a.yRe,c=a.raa;b&&b.forEach(f=>{c.removeProperty(ad.a.Ita(f));
return!0});return!0}iKl(a){const b=a.A0b.value,c=b.JIb.Xe,f=this.Amd;let l=!0;b.W_a.forEach((y,H)=>{if(this.rwa.P1a&&!this.Amd.T5d.Fb(y)){var Q=String.format("prop id: {0} is missed in merge handlers for class {1}, please add it",y,c);ka.ULS.sendTraceTag(18970259,808,50,Q)}Q=f.ga(y);l=this.jKl(a,H,y,Q);l||(a.raa=null,ka.ULS.sendTraceTag(18659271,808,50,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",c,y,Q));return l});return l}Eij(){return[ad.a.xb(ab.a.fXf),ad.a.xb(ab.a.lastModifiedTime),
ad.a.xb(ab.a.YE),ad.a.xb(ab.a.Akb),ad.a.xb(ab.a.csh),ad.a.xb($c.a.amc),ad.a.xb(Ab.a.HEi),ad.a.xb(Ab.a.PVf),ad.a.xb(dt.a.Vw)]}T5d(){var a=this.Eij(),b=this.rwa.XKa,c=this.rwa.tNa,f=this.rwa.jNa,l=this.rwa.nSa,y=this.rwa.DRa;const H=this.rwa.IDa,Q=new Jd.a(0);for(let ia=0;ia<a.length;ia++)Q.$(a[ia],this.KZa(7));for(a=0;a<b.length;a++)Q.$(b[a],this.KZa(8));for(b=0;b<c.length;b++)Q.$(c[b],this.KZa(7));for(c=0;c<f.length;c++)Q.$(f[c],this.KZa(9));for(f=0;f<l.length;f++)Q.$(l[f],this.KZa(1));for(l=0;l<
y.length;l++)Q.$(y[l],this.KZa(9)),this.zzg.add(y[l]);for(y=0;y<H.length;y++)Q.$(H[y],this.KZa(this.rwa.JDa));return new HJ(Q,this.KZa(this.rwa.JDa))}Mea(a,b){this.zzg.contains(b)&&(a=a.raa,ka.ULS.sendTraceTag(18956752,808,50,"Merge child nodes for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}] []",a.id,a.Xe,b))}}Object(m.a)(IJ,"GraphNodeComplexMerge",null,[526]);class JJ{constructor(a,b){this.wl=a;this.Y8c=b;this.Cfk=this.wLi()}wLi(){const a=[];this.wl.forEach(b=>{a.push(new IJ(this.Y8c,b,c=>c))});
return a}vLi(a){for(let b=0;b<this.wl.length;b++)if(this.wl[b].wG(a))return this.Cfk[b];return null}}Object(m.a)(JJ,"GraphNodeComplexMergeFactory",null,[453]);class KJ{krj(a,b){this.WPh(a);return 5===a?b.newValue:b.oldValue}$cg(a,b){this.WPh(a);return 5===a?b.oldValue:b.newValue}WPh(a){1!==a&&5!==a&&ka.ULS.sendTraceTag(18613264,808,15,"Unexpected merge source: {0}",a)}}Object(m.a)(KJ,"GraphNodeComplexMergeHelper",null,[489]);class LJ{constructor(a,b,c,f,l,y){this.yRe=this.tlc=null;this.scc=this.yQh=
!1;this.raa=null;this.Stc=a.runtime.Stc;this.igd=a;this.Xvk=b;this.S7a=c;this.A0b=f;this.uNc=l;this.eeg=y}}Object(m.a)(LJ,"GraphNodeComplexMergeState",null,[]);class MJ{constructor(a){this.BYa=a(this.N7b())}N7b(){return[Object(I.a)(this,this.Uxl,"simpleMerge"),Object(I.a)(this,this.YDi,"complexMerge")]}sql(a,b,c,f,l,y){a=new LJ(a,c,new Bb.a(()=>new Gx(f.T5,l)),new Bb.a(()=>new Gx(f.T5,y)),new Bb.a(()=>new Gx(y,l)),b.vLi(l));a.tlc=f.uHc;a.yRe=new qj.a;return a}merge(a,b,c,f,l,y){a=this.sql(a,b,c,f,
l,y);b=!0;for(c=0;c<this.BYa.length&&b;c++)b=(0,this.BYa[c])(a);(b=a.scc&&a.raa?new Hx(a.raa,!1):null)&&b.hpl(a.tlc);return{returnValue:a.scc,raa:b}}Uxl(a){var b=a.eeg.Amd;return a.A0b.value.P0c(b)&&a.uNc.value.P0c(b)?a.S7a.value.P0c(b)?!0:(b=a.A0b.value.W5,a.scc=!0,a.raa=b.E8a(),!1):(a.scc=!0,!1)}YDi(a){const b=a.A0b.value.W5;a.Stc&&ka.ULS.sendTraceTag(18613266,808,100,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",b.id,b.Xe);const c=a.eeg.hKl(a);a.scc=c;ka.ULS.sendTraceTag(18613268,808,c?100:50,
"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",c?"Succeeded":"Failed",b.id,b.Xe,!!a.raa);return c}}Object(m.a)(MJ,"GraphNodeMerge",null,[454]);class tu{constructor(a){this.Gad=a}MVi(a){const b=a.uNc.value,c=a.raa;a=a.igd.input.source;for(const l of tu.Hqd)if(({value:f}=b.W_a.wg(l)).returnValue){var f=this.Gad.$cg(a,f);void 0!==f&&null!==f?c.OLa(ad.a.Ita(l),f):c.removeProperty(ad.a.Ita(l))}}get XKa(){return[ad.a.xb(zb.a.cU),ad.a.xb(zb.a.$me),ad.a.xb(zb.a.ane),
ad.a.xb(zb.a.Bme)]}get tNa(){return[]}get jNa(){return[]}get DRa(){return[]}get nSa(){return tu.Hqd}get IDa(){return[]}get P1a(){return!1}get JDa(){return 9}wG(a){return 393230===a.Xe}I2a(a,b){return 0<=Array.indexOf(tu.Hqd,b)?(this.MVi(a),tu.Hqd.forEach(c=>{a.tlc.add(c)}),!0):!1}}tu.Hqd=[ad.a.xb(ab.a.tq),ad.a.xb(ab.a.Hmb),ad.a.xb(ab.a.Hvc),ad.a.xb(ab.a.pMa),ad.a.xb(ab.a.Cxa),ad.a.xb(Ab.a.V_a)];Object(m.a)(tu,"ParagraphNodeComplexMerge",null,[488]);class UC{constructor(){this.K=null}get name(){return"PowerPointWebEditor.GraphMerge"}Yb(a){this.K=
a;a.register(KJ,"PowerPointWebEditor.GraphMerge.GraphNodeComplexMergeHelper").as("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeHelper").ma();const b=[393229,393234,1074135136,131073,1179649,393252,393250,393251];a.register(453,"PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeFactory").ma().oa(()=>{const c=new FJ;return new JJ([new EJ,new GJ,c,new tu(a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeHelper")),new BJ,new CJ,new DJ(c),new Ix(f=>Array.contains(b,f.Xe),9),new Ix(f=>
131140===f.Xe,6),new Ix(f=>131164===f.Xe,8),new Ix(()=>!0,5)],a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeHelper"))});a.register(uz,"PowerPointWebEditor.GraphMerge.MergeableObjectUtilities").as("Box4.StorageObjectSpace.IMergeableObjectUtilities").ma();a.register(454,"PowerPointWebEditor.GraphMerge.IGraphNodeMerge").ma().oa(()=>new MJ(c=>c));a.register(455,"Box4.IBrowserGraphMerger").ma().oa(()=>new Kv(c=>new QC.a(c),a.resolve("Box4.StorageObjectSpace.IMergeableObjectUtilities"),
c=>c,a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeFactory"),a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeMerge"),(c,f,l)=>new A.a(c,f,l),a.resolve("PowerPointWebEditor.IApplicationSettings").cYc,a.resolve("PowerPointWebEditor.IApplicationSettings").Dog,a.resolve("PowerPointWebEditor.IApplicationSettings").BXj,a.resolve("PowerPointWebEditor.IApplicationSettings").zXj,a.resolve("PowerPointWebEditor.IApplicationSettings").AXj))}init(){const a=this.K.resolve("Box4.IBrowserGraphMerger");
Rc.App.LMa.Jpi(a)}dispose(){}static main(){n.a.instance.Ac(new UC)}}Object(m.a)(UC,"PPTWebEditorGraphMergePackage",null,[2,3]);class NJ{constructor(a,b){this.wl=a;this.FR=b}K9i(a){let b=null,c=null;if(a&&a.rootNode)for(const f of this.wl)if(f.cTj(a)){c=f;const l=this.FR.Ii("UserAction",f.name);b=f.H9i(a);l.stop();break}b||xa.a.J(21860568,307,15,"{0} processed {1} but did not generate any HTML",c?c.name:"NoHandler",a&&a.rootNode?a.rootNode.type:0);return b}J9i(a){if(!a||1>a.length)return null;const b=
document.createElement("div");for(const c of a)(a=this.K9i(c))&&b.appendChild(a);return b}}Object(m.a)(NJ,"HtmlExportProcessor",null,[450]);class VC{constructor(){this.RFc=null}get rootNode(){return this.RFc}clone(){return Object.assign(new VC,{RFc:this.rootNode})}}Object(m.a)(VC,"HtmlExportContext",null,[]);class OJ{I9i(a,b){const c=[];for(const f of a)b&&!b(f)||c.push(Object.assign(new VC,{RFc:f}));return c}}Object(m.a)(OJ,"HtmlExportUtils",null,[452]);class PJ{constructor(a){this.bwe=null;this.Pq=
a}get bXi(){return this.bwe=this.bwe||document.createElement("div")}L9i(a,b){if(!a||!a.rootNode||!b)return null;b.OCa(this.bXi);const c=this.Pq.je(3);try{c.ld(a.rootNode),c.YLa(b.Na),b.ly(a.rootNode),b.pAa()}finally{c&&c.dispose()}a=b.eZf;b.detach();return a}}Object(m.a)(PJ,"HtmlGenerator",null,[451]);class WC{constructor(a,b,c){this.tik=a;this.uik=b;this.Rb=c}get name(){return"PPTTableHtmlExportHandler"}cTj(a){return 14===a.rootNode.type?!0:10===a.rootNode.type?(a=Object(qa.a)(4,a.rootNode),!!a&&
a.vd):!1}H9i(a){return this.uik.L9i(this.quj(a),this.tik)}quj(a){if(10===a.rootNode.type){const b=a.clone();a=this.Rb.Lc(a.rootNode);a.Cb(1);b.RFc=a.Cb(2);return b}return a}}Object(m.a)(WC,"PPTTableHtmlExportHandler",null,[576]);class XC extends Hf.a{constructor(a,b){super(new F.a,a,b)}get eZf(){return this.tIh}}Object(m.a)(XC,"AHtmlExportView",Hf.a,[517,518,166,107]);class YC{}YC.g1i="ExportedPPTTable";Object(m.a)(YC,"HtmlExportConstants",null,[]);class ZC extends XC{constructor(a,b){super(a,b)}get eZf(){const a=
this.tIh.getElementsByTagName("table");return 0<a.length?(Sys.UI.DomElement.addCssClass(a[0],YC.g1i),a[0]):null}get hm(){return!0}get XF(){return 480}}Object(m.a)(ZC,"PPTTableHtmlExportView",XC,[]);class $C{constructor(){this.K=null}get name(){return"PowerPointWebEditor.HtmlExport"}Yb(a){this.K=a;this.K.register(450,"PowerPointWebEditor.HtmlExport.IHtmlExportProcessor").ma().oa(()=>new NJ([this.K.resolve("PowerPointWebEditor.HtmlExport.PPTTableHtmlExportHandler")],this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder")));
this.K.register(451,"PowerPointWebEditor.HtmlExport.IHtmlGenerator").ma().oa(()=>new PJ(this.K.resolve("Box4.Graph.IGraphTransactionFactory")));this.K.register(452,"PowerPointWebEditor.HtmlExport.IHtmlExportUtils").ma().oa(()=>new OJ);this.JFi()}init(){}dispose(){}JFi(){this.K.register(ZC,"PowerPointWebEditor.HtmlExport.PPTTableHtmlExportView").ma().oa(()=>new ZC(this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("Box4.IViewManager")));this.K.register(WC,"PowerPointWebEditor.HtmlExport.PPTTableHtmlExportHandler").ma().oa(()=>
new WC(this.K.resolve("PowerPointWebEditor.HtmlExport.PPTTableHtmlExportView"),this.K.resolve("PowerPointWebEditor.HtmlExport.IHtmlGenerator"),this.K.resolve("Box4.Graph.IGraphIteratorFactory")))}static main(){n.a.instance.Ac(new $C)}}Object(m.a)($C,"HtmlExportPackage",null,[2,3]);class vz extends bi.a{constructor(a,b){super();this.Ozc=0;this.EId=null;this.Fo="<div class='WACDialogRow' id='IntroBlock'> <label id='IntroLabel' class='WACDialogLabel' for='LanguageList' >{0}</label> </div> <div class='LanguagesListDiv' id='LanguageListDiv'> <select class='UIFont WACDialogList' id='LanguageList' size='11'> </select> <label id='SpellingLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogCheckBoxDiv' id='DoNotCheckSpellingBlock'> <input type='checkbox' id='DoNotCheckSpelling' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='DoNotCheckSpelling' >{2}</label> </div>";
this.olf=a;this.nlf=b;this.kg="LanguageDialog"}euc(){this.sg=this.Q8d();this.Ozc=({Qih:a}=this.olf.Dag()).returnValue;var a={["LanguageList"]:10,["DoNotCheckSpelling"]:!a};this.pj(Box4Intl.Box4Strings.l_Language,Object(I.a)(this,this.Pll,"setLanguageHandler"),a);this.EId=document.getElementById("LanguageList");this.nlf.NPk(this.EId,this.Ozc)}Q8d(){return bi.a.VC(this.Fo,Box4Intl.Box4Strings.l_MarkSelectedText,Box4Intl.Box4Strings.l_SpellingWillUseLanguage,Box4Intl.Box4Strings.l_DoNotCheckSpelling)}Pll(a,
b){if(N.a.instance.ga(70)){var c=mc.a.instance.Zp(C.a.Oll);1!==a?c.properties.$("canceled","true"):(a=b.DoNotCheckSpelling,0<=b.LanguageList&&(b=parseInt(this.EId.value),this.olf.ayh(b,a),c.properties.$("PreviousLCID",this.Ozc.toString()),c.properties.$("ChangedLCID",b.toString()),c.properties.$("NoProof",a.toString()),this.nlf.Nll(b,this.Ozc)),Rc.App.Lb.updateCommandUI(!0));c.end()}}}Object(m.a)(vz,"LanguageDialog",bi.a,[582]);class QJ{constructor(){this.B6j=["version","xmlns","xmlns:xlink","style"]}sanitize(a){try{const b=
{};b.inputString=a;b.unsupportedContentCallback=Object(I.a)(this,this.K6j,"jsanityUnsupportedCallBack");return jSanity.sanitize(b)}catch(b){xa.a.J(38398044,815,10,"Unexpected exception when converting svg: {0}, stack: {1}",b.message,b.stack)}return null}yel(a){var b=this.sanitize(a);let c=null;if(b&&b.innerHTML&&b.innerHTML.startsWith("<svg")){c=b.innerHTML;if(0<a.indexOf("viewBox")&&0>c.indexOf("viewBox"))if((b=a.match(RegExp('viewBox="[^"]*')))&&1===b.length&&b[0])c=c.replace("<svg",String.format('<svg {0}"',
b[0]));else return null;if(0<a.replace(" ","").indexOf('xmlns="http://www.w3.org/'))c=0<c.indexOf("xmlns=")?c:c.replace("<svg",String.format("<svg {0}",'xmlns ="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"'));else return null}return c}K6j(a,b){b=b.toLowerCase();for(const c of this.B6j)if(b===c)return;xa.a.J(38398046,822,50,"JSanity unsupported callback unsupportContentName: {0}, unsupportContentValue:{1} ",a,b)}}Object(m.a)(QJ,"JSanityHelper",null,[448]);class aD extends vz{constructor(a,
b,c){super(a,c);this.ghk=b}Q8d(){return this.ghk.wVa?bi.a.VC(this.Fo,Box4Intl.Box4Strings.l_MarkSelectedText,ResourceStrings.l_LanguageDialogDescription,ResourceStrings.l_DoNotCheckSpellingOrGrammar):super.Q8d()}}Object(m.a)(aD,"PPTLanguageDialog",vz,[]);class RJ{constructor(a,b,c,f){this.Rpk=a;this.agk=b;this.Ckk=c;this.nG=f}getInstance(a){return new aD((a?this.Rpk:this.agk)(),this.nG,this.Ckk)}}Object(m.a)(RJ,"PPTLanguageDialogFactory",null,[446]);var Ui=d(124);class SJ{constructor(){this.K4e="rect,circle,ellipse,line,polyline,polygon,path";
this.xvd=[];this.Zga=[[],[1,3],[4,3],[4,3,1,3],[8,3,1,3],[8,3],[8,3,1,3,1,3],[3,1],[1,1],[3,1,1,1],[3,1,1,1,1,1]];this.bPe=96}bLl(a,b=null){try{const c=this.Ace(a);if(!c)return null;const f=b?rc.a.bH(b.PD):"none",l=b?b.alpha:1;for(b=0;b<c.length;++b){if(!c[b])continue;const y=c[b];y.setAttribute(Ui.a.k7d,f);y.setAttribute(Ui.a.J_f,l)}return a}catch(c){return xa.a.J(38536015,815,10,"TryUpdateSVGDomelementFillIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",c.message,
c.stack),null}}CLh(a,b=null){try{const c=this.Ace(a);if(!c)return null;const f=b?rc.a.bH(b.PD):"none",l=b?b.alpha:1;for(b=0;b<c.length;++b){if(!c[b])continue;const y=c[b];y.setAttribute(Ui.a.gvd,f);y.setAttribute(Ui.a.BFh,l)}return a}catch(c){return xa.a.J(38536017,815,10,"TryUpdateSVGDomelementLineFillIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",c.message,c.stack),null}}cLl(a,b){try{const f=this.Ace(a);if(!f)return null;var c=this.oqj(b);let l="";for(const y of c)l+=
y+" ";for(c=0;c<f.length;++c){if(!f[c])continue;const y=f[c];y.setAttribute(Ui.a.AFh,l);y.setAttribute(Ui.a.Z3e,"miter");y.setAttribute(Ui.a.XBl,"4");switch(b){case 8:y.setAttribute(Ui.a.Y3e,"round");break;case 2:case 0:y.setAttribute(Ui.a.Y3e,"butt");break;default:y.setAttribute(Ui.a.Y3e,"round")}}return a}catch(f){return xa.a.J(38536019,815,10,"TryUpdateSVGDomelementLineDashIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",f.message,f.stack),null}}DLh(a,b,c,f){try{if(!a)return null;
this.qyh(c,b*this.bPe*f/xe.a.cEa,a);return a}catch(l){return xa.a.J(38536021,815,10,"TryUpdateSVGDomelementLineWidthIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",l.message,l.stack),null}}qqj(){if(!this.xvd||1>this.xvd.length)this.xvd=this.K4e.split(",");return this.xvd}Ace(a){if(!a)return null;a=a.querySelectorAll(this.K4e);return 1>a.length?null:a}qyh(a,b,c){if(c){var f=c.getAttribute(Ui.a.tQb)?c.getAttribute(Ui.a.tQb).toString():"";1<f.length?(f=f.substring(f.indexOf("(")+
1,f.indexOf(")")),f=f.split(","),6===f.length?(f=Math.sqrt(Math.abs(parseFloat(f[0])*parseFloat(f[3]))+Math.abs(parseFloat(f[1])*parseFloat(f[2]))),f*=a):f=a):f=a;a=c.tagName.toLowerCase();for(var l of this.qqj())if(l===a){c.setAttribute(Ui.a.$3e,(b/f).toString());break}if(c.children&&0<c.children.length)for(l=0;l<c.children.length;++l)this.qyh(f,b,c.children[l])}}oqj(a){switch(a){case 0:return this.Zga[0];case 1:return this.Zga[1];case 2:return this.Zga[2];case 3:return this.Zga[3];case 4:return this.Zga[4];
case 5:return this.Zga[5];case 6:return this.Zga[6];case 7:return this.Zga[7];case 8:return this.Zga[8];case 9:return this.Zga[9];case 10:return this.Zga[10];default:return xa.a.J(38536023,815,15,"GetSVGDashArray: unsupport ST_PresetLineDashVal."),this.Zga[0]}}}Object(m.a)(SJ,"SVGIconLocalEditor",null,[449]);class TJ{constructor(a,b){this.NYg=b;this.Ud=a}iD(a,b){if(!a)return!1;const c=a.F_(f=>!f.rl).length;return!this.Mrl(a.r4b,c+b)}KD(a){const b=a.ue+1;this.Ud.nH(222,c=>{c.KC=1;c.bTa=[b.toString(),
this.NYg.toString()];return!1})}Mrl(a,b){if(!a&&b<this.NYg)return!1;xa.a.J(22410754,822,50,"Can not edit. Shape count:{0}.",b);return!0}}Object(m.a)(TJ,"ShapeCountValidator",null,[447]);class bD{constructor(a,b,c,f,l,y){this.Jkk=a;this.Fa=b;this.k0g=c;this.Eb=f;this.OJ=l;this.Ga=y}get Nb(){return this.Jkk.value}Dag(){let a,b=0;a=!0;const c=this.Nb.Xd();1===c.length&&c[0].z2c&&(b=this.Ga.aUa(c[0]),a=!this.Ga.wbe(c[0]));return{returnValue:b,Qih:a}}ayh(a,b){const c=this.Nb.Xd();if(1===c.length&&c[0].z2c&&
this.k0g){var f=new J.DictionaryPropertySet;f.setValue(ab.a.yt,a);f.setValue(ee.a.Bxa,b);a=this.Eb.xd(15);try{a.hc(c[0]);c[0].Gta();const l=Object(qa.a)(4,c[0]);l&&this.OJ&&this.OJ.HPl(l,b);this.k0g.lV(f);this.Fa.Bd()}finally{a&&a.dispose()}}}}Object(m.a)(bD,"ShapeLanguageEditor",null,[474]);class cD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ShapeEdit"}Yb(a){this.K=a;const b=this.K.resolve("PowerPointWebEditor.IApplicationContext");this.K.register(vz,"Box4.UI.LanguageDialog").as("Box4.UI.ILanguageDialog").oa(()=>
new aD(this.K.resolve("Box4.UI.ILanguageEditor"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.resolve("Box4.UI.ILanguageListHelper")));this.K.register(446,"PowerPointWebEditor.IPPTLanguageDialogFactory").ma().oa(()=>new RJ(()=>this.K.resolve("PowerPointWebEditor.ShapeLanguageEditor"),()=>this.K.resolve("Box4.UI.ILanguageEditor"),this.K.resolve("Box4.UI.ILanguageListHelper"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration")));this.K.register(bD,"PowerPointWebEditor.ShapeLanguageEditor").ma().oa(()=>
new bD(this.K.oe("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.qb("Box4.ITextFormattingCommands"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),this.K.resolve("PowerPointWebEditor.IShapeReader")));this.K.register(447,"PowerPointWebEditor.ShapeEdit.IShapeCountValidator").ma().oa(()=>new TJ(Ib.a.instance.resolve("PowerPointWebEditor.IErrorHandler"),b.rd.powerPointEditServerEditableShapeCountThreshold));
this.K.register(448,"PowerPointWebEditor.IJSanityHelper").ma().oa(()=>new QJ);this.K.register(449,"PowerPointWebEditor.ShapeEdit.ISVGIconLocalEditor").ma().oa(()=>new SJ)}init(){this.K.resolve("PowerPointWebEditor.IJSanityHelper")}dispose(){}static main(){n.a.instance.Ac(new cD)}}Object(m.a)(cD,"PPTWebEditorShapeEditPackage",null,[2,3]);var dD=d(310);class ht{static get A_(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?
"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}static requestFullscreen(a){a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.msRequestFullscreen?a.msRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.requestFullscreen?a.requestFullscreen():ka.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")}static exitFullscreen(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():
document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():ka.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")}static get Vac(){return document.webkitFullscreenEnabled||document.msFullscreenEnabled||document.mozFullScreenEnabled||document.fullscreenEnabled}static get B9(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}Object(m.a)(ht,
"FullscreenUtils",null,[]);class UJ{get A_(){return ht.A_}requestFullscreen(a){ht.requestFullscreen(a)}exitFullscreen(){ht.exitFullscreen()}get Vac(){return ht.Vac}get B9(){return ht.B9}get XHf(){return this.Vac&&!z.a.Ex}}Object(m.a)(UJ,"FullscreenUtilsProxy",null,[438]);class VJ{bjj(a){return inkButton.InkButtonManagerFactory.createInkButtonManager(a)}}Object(m.a)(VJ,"InkButtonHelper",null,[443]);class WJ{constructor(){this.menuDefinition=null;this.autoOpenMenu=!1;this.menuHostId=null;this.autoOpenMenu=
!1;this.menuHostId="SlideshowToolbarCalloutMenuContainer"}}Object(m.a)(WJ,"FlyoutMenuExtraProps",null,[]);class Jx{}Jx.Wti="_136_16_N_20";Jx.Xti="none";Object(m.a)(Jx,"InkButtonConstants",null,[]);class wz{constructor(){this.menuDefinition=this.controlInMenuRendererFunction=this.menuHostId=this.selectedColor=this.selectedItem=this.icon=null}static create(){return{}}}Object(m.a)(wz,"InkButtonProps",null,[]);class eD{constructor(){this.onInkMenuActivity=null}}Object(m.a)(eD,"IInkButtonSettings",null,
[]);class XJ extends eD{constructor(){super()}}Object(m.a)(XJ,"InkButtonSettings",eD,[]);class YJ{constructor(){this.color=this.item=null}}Object(m.a)(YJ,"InkManagerActivity",null,[]);class xz{constructor(){this.JBe=!1;this.SFe=this.rGe=0;this.Tve=""}get D4(){return this.JBe}set D4(a){this.JBe=a}get startingSlideIndex(){return this.rGe}set startingSlideIndex(a){this.rGe=a}get vza(){return this.SFe}set vza(a){this.SFe=a}get VTf(){return this.Tve}set VTf(a){this.Tve=a}get U4k(){const a={};a.IsStartRehearsal=
this.JBe;a.StartingSlideIndex=this.rGe;a.SlideCount=this.SFe;a.DisabledRehearsalRealtimeFeaturesStr=this.Tve;return JSON.stringify(a)}}Object(m.a)(xz,"RehearsalContext",null,[441]);class yz extends bi.a{constructor(a,b,c){super(!1,!0);this.GDe=50001;this.jb=a;this.ke=b;this.Yo=new xz;this.Ya=c;this.jb.ija(Object(I.a)(this,this.jga,"onSlideshowExitHandler"));this.jb.C_b(Object(I.a)(this,this.ega,"onGetCurrentPositionHandler"));this.jb.getCurrentPosition();this.VHa=!1}dispose(){super.dispose();this.VHa||
this.jb.restoreFocus()}Bu(){super.Bu();document.getElementById("WACDialogOverlay").style.zIndex=String(this.GDe);const a=document.getElementById("WACDialogOuterContainer");Sys.UI.DomElement.addCssClass(a,"SlideshowSubtitleProactiveDialogContainer")}VA(){super.VA();var a=document.getElementById(this.Uh("WACDialogPanel"));a.style.minWidth=rb.a.Pc(300);a.style.width=rb.a.Pc(300);a=document.getElementById(this.Uh("WACDialogButtonPanel"));var b=document.getElementById(this.Uh("WACDialogActionButton"));
a&&b&&a.removeChild(b);if(a=document.getElementById(this.Uh("WACDialogCancelButton")))a.style.color="#ffffff",a.style.font="12pt",a.style.background="#A92B1A",a.innerText="Got it";if(a=document.getElementById(this.Uh("WACDialogPanel"))){b=rb.a.$d();b.style.position="absolute";b.style.bottom="20px";b.style.left="20px";const c=rb.a.kda();c.setAttribute("href","https://support.office.com/en-ie/article/present-with-real-time-automatic-captions-or-subtitles-in-powerpoint-68d20e49-aec3-456a-939d-34a79e8ddd5f#OfficeVersion=Online");
c.setAttribute("target","_blank");c.innerText="More Tips";b.appendChild(c);a.appendChild(b)}}open(){xa.a.J(512495708,830,50,"SlideshowSubtitleProactiveDialog: Open");var a=this.ke.qk("SubtitleProactive_clearly.png");const b=this.ke.qk("SubtitleProactive_network.png"),c=this.ke.qk("SubtitleProactive_noNoise.png");this.sg="<div id='subtitleDlg'><div id='captions' class='SubtitleProactiveCaptions'><label id='captionID'></label></div><div id='sectiontitle' class='SubtitleProactiveSectionTitle '><span id='sectiontitle1'><label id='str1ID'></label></span></br><span id='sectiontitle2'><label id='str2ID'></label></span></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+
a+"' style='width: 190px; height: 125px;'/><span id='block1_1' class='SubtitleProactiveBlockTitle'><label id='speakStr1ID'></label></span></br></br><span id='block1_2'><label id='speakStr2ID'></label></span></br></br></br></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+c+"' style='width: 190px; height: 125px;'/><span id='block2_1' class='SubtitleProactiveBlockTitle'><label id='noiseStr1ID'></label></span></br><span id='block2_2'><label id='noiseStr2ID'></label></span></br></br></br></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+
b+"' style='width: 190px; height: 125px;'/><span id='block3_1' class='SubtitleProactiveBlockTitle'><label id='networkStr1ID'></label></span></br></br><span id='block3_2'><label id='networkStr2ID'></label></span></br></br></br></div></div>";a={["captionID"]:ResourceStrings.L_SubtitleProactive_Caption,["str1ID"]:ResourceStrings.L_SubtitleProactive_Sectiontitle1,["str2ID"]:ResourceStrings.L_SubtitleProactive_Sectiontitle2,["speakStr1ID"]:ResourceStrings.L_SubtitleProactive_SpeakStr1,["speakStr2ID"]:ResourceStrings.L_SubtitleProactive_SpeakStr2,
["noiseStr1ID"]:ResourceStrings.L_SubtitleProactive_NoiseStr1,["noiseStr2ID"]:ResourceStrings.L_SubtitleProactive_NoiseStr2,["networkStr1ID"]:ResourceStrings.L_SubtitleProactive_NetworkStr1,["networkStr2ID"]:ResourceStrings.L_SubtitleProactive_NetworkStr2};this.pj("",Object(I.a)(this,this.dga,"onClickHandler"),a);this.jb.setVisibility(!0)}r8(){super.r8()}Ysa(){super.Ysa()}bkb(){}ega(){this.jb.ckb(Object(I.a)(this,this.ega,"onGetCurrentPositionHandler"));this.open()}jga(){this.VHa=!0;this.jb.yga(Object(I.a)(this,
this.jga,"onSlideshowExitHandler"));this.jb.ckb(Object(I.a)(this,this.ega,"onGetCurrentPositionHandler"));this.hide()}dga(a){0===a&&(a=Date.now(),this.jb.transcribe(w.AFrameworkApplication.userSessionId,this.Ya.podSessionId,this.Ya.Ek,w.AFrameworkApplication.gh,3,a,this.Yo))}static Aug(a,b,c){new yz(a,b,c)}}Object(m.a)(yz,"SlideshowSubtitleProactiveDialog",bi.a,[]);var fh=d(685);class ZJ{constructor(){this.buttonIdDictionary=null}}Object(m.a)(ZJ,"SlideshowToolbarSettings",null,[]);class Kx extends Sys.EventArgs{constructor(a){super();
this.text=a}}Object(m.a)(Kx,"ReadOutEventArgs",Sys.EventArgs,[]);class fD{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua){this.rEb=this.Yo=this.Hc=this.Tea=this.qe=this.x8c=this.hGe=this.Ci=null;this.IU=this.gZa=this.iZa=this.fEb=this.MXa=this.Dze=0;this.sM=!1;this.dze=!0;this.K9c=this.tR=this.aHe=this.que=!1;this.jb=c;this.tf=H;this.pu=Q;this.Ya=wa;this.ia=a;this.Ea=b;this.EHe=l;this.Ub=y;this.Pik=Ib.a.instance.Ia("PowerPointWebEditor.IInkButtonHelper");this.ke=f;this.nu=Ua}init(a,b){var c;xa.a.J(512495955,
830,50,"ReactSlideshowToolbar.Init");this.dze=!0;this.que=!1;var f={};f[fh.a.MicButton]=this.Ea.isMicButtonInSlideShowToolbarEnabled;f[fh.a.PrevButton]=!0;f[fh.a.NextButton]=!0;f[fh.a.GridButton]=!0;f[fh.a.InkButton]=!0;f[fh.a.SubtitlesButton]=!0;f[fh.a.LiveButton]=!0;f[fh.a.MoreButton]=!0;f[fh.a.CameraButton]=this.Ea.kta;f[fh.a.ExitButton]=!0;f[fh.a.CoachButton]=this.Ea.isCoachButtonInSlideShowToolbarEnabled;this.hGe=new ZJ;this.hGe.buttonIdDictionary=f;if(!document.getElementById("slideshow-toolbar")){this.qe=
document.createElement("div");this.qe.id="slideshow-toolbar";this.qe.className="ReactSlideshowToolbar";this.Ea.pptEditorVoiceUXEnabled&&(this.x8c=document.getElementById("slideshowfooterContainerElement"),this.qe.className="ReactSlideshowToolbarWithFooter");f=document.createElement("div");f.id="slideshow-toolbar-accessibility";f.style.position="absolute";f.style.left="0px";f.style.top="auto";f.style.width="0px";f.style.height="0px";f.style.overflow="hidden";f.setAttribute("aria-label",ResourceStrings.l_SlideShowToolbar);
this.Ea.pptEditorVoiceUXEnabled?this.x8c.appendChild(this.qe):this.tf.appendChild(this.qe);this.Ci=slideshowToolbar.SlideshowToolbarFactory.createToolbar(this.hGe,this.qe);if(!this.Ci){xa.a.J(512495954,830,10,"ReactSlideshowToolbar.Init m_slideshowToolbarManager is null.");const l=$e.a.Oh(359);w.AFrameworkApplication.Oo(l);$d.Health.instance.recordQosError($e.a.ida(l),["SlideShowACE"],!1,!0,!0,!1,null)}this.Ci.renderToolbar();this.qe.appendChild(f);this.qe.tabIndex=0}this.Tea||(this.Tea=document.createElement("div"),
this.Tea.id="SlideshowToolbarCalloutMenuContainer",this.Tea.className="SlideshowToolbarCalloutMenuContainer",this.pu()&&(this.Tea.style.direction=wf.a.f2a),this.tf.appendChild(this.Tea));this.Hc=a;this.Yo=b;this.Ci.registerButtonCallback(fh.a.MicButton,()=>{this.$Ek()});this.Ci.registerButtonCallback(fh.a.CoachButton,()=>{this.EBk()});this.Ea.kta&&(this.Ci.registerButtonCallback(fh.a.CameraButton,()=>{this.lBk()}),this.Yeb=null!==(c=this.Yeb)&&void 0!==c?c:!0,this.Ci.setToolbarButtonToggleState(fh.a.CameraButton,
this.Yeb),this.jb.yZe(this.Yeb),this.Ci.showToolbarButton(fh.a.CameraButton));this.Hc.Qh||this.Ub&&this.Ub.instance&&this.Ub.instance.kr?(this.tR=!0,this.Ci.setToolbarButtonToggleState(fh.a.MicButton,this.tR),this.Ci.showToolbarButton(fh.a.MicButton)):(this.tR=!1,this.Ci.setToolbarButtonToggleState(fh.a.MicButton,this.tR),this.Ci.hideToolbarButton(fh.a.MicButton));this.Ci.registerButtonCallback(fh.a.PrevButton,l=>{this.dJb(l)});this.Ci.registerButtonCallback(fh.a.NextButton,l=>{this.ZIb(l)});this.Ci.registerButtonCallback(fh.a.GridButton,
l=>{this.UIb(l)});this.Ci.showToolbarButton(fh.a.GridButton);this.Hc.Swb&&!this.Yo.D4&&(this.Ci.registerButtonCallback(fh.a.SubtitlesButton,l=>{this.gkd(l)}),this.Ci.setToolbarButtonToggleState(fh.a.SubtitlesButton,this.Hc.Qh),this.Ci.showToolbarButton(fh.a.SubtitlesButton));this.Ci.registerButtonCallback(fh.a.ExitButton,l=>{this.TIb(l)});this.Ea.isInkingInSlideShowEnabled&&this.Ea.isInkUIInSlideShowEnabled&&(a=wz.create(),a.icon=Jx.Wti,a.selectedColor=Jx.Xti,this.Ci.updateElementProps(fh.a.InkButton,
a),this.Ci.registerButtonCallback(fh.a.InkButton,()=>{this.zMj()}),this.Ci.showToolbarButton(fh.a.InkButton));this.Ub&&this.Ub.instance&&this.Ub.instance.Er&&!this.Yo.D4&&(this.Ci.registerButtonCallback(fh.a.LiveButton,()=>{this.IEk()}),this.Ci.updateFlyoutButtonCallback(fh.a.LiveButton,this.Ub.instance.kr),this.Ci.setToolbarButtonToggleState(fh.a.LiveButton,this.Ub.instance.kr),this.Ci.showToolbarButton(fh.a.LiveButton),this.Ub.instance.uzf(Object(I.a)(this,this.Kmc,"onLiveSessionStarted")),this.Ub.instance.szf(Object(I.a)(this,
this.Jmc,"onLiveSessionEnded")),this.Ub.instance.qzf(Object(I.a)(this,this.Imc,"onLiveRelaunchPausedSession")),this.Ub.instance.igi(Object(I.a)(this,this.o$g,"onLiveCalloutMenuDefintionChanged")));this.SQb();this.nxb();this.jb.ija(Object(I.a)(this,this.koa,"onExitHandler"));this.jb.fTd(Object(I.a)(this,this.cib,"onBrowserEventHandler"));this.jb.dJc(Object(I.a)(this,this.Ixa,"onGetCurrentSlideDimensionsHandler"));this.jb.iJc(Object(I.a)(this,this.Sxa,"onSpecialKeyHandler"));this.jb.hTd(Object(I.a)(this,
this.dib,"onContextMenuHandler"));this.jb.jTd(Object(I.a)(this,this.vid,"onEnterEndOfShowHandler"));this.jb.lTd(Object(I.a)(this,this.Xid,"onLeaveEndOfShowHandler"));hd.a.addHandler(this.qe,oa.a.qq,Object(I.a)(this,this.lib,"onMouseOverHandler"));hd.a.addHandler(this.qe,oa.a.Vs,Object(I.a)(this,this.Mmc,"onMouseOutHandler"));hd.a.addHandler(this.Tea,oa.a.click,Object(I.a)(this,this.dga,"onClickHandler"));hd.a.addHandler(this.qe,oa.a.Bf,Object(I.a)(this,this.WJa,"onKeyDownHandler"))}Awl(){window.clearTimeout(this.Dze);
this.Dze=window.setTimeout(Object(I.a)(this,this.KIj,"hideMouse"),3E3);this.jb.Pga(!0)}KIj(){this.sM||(window.clearTimeout(this.Dze),this.jb.Pga(!1))}dF(a,b){b?this.Ci.showToolbarButton(a):this.Ci.hideToolbarButton(a)}setToolbarButtonToggleState(a,b){this.Ci.setToolbarButtonToggleState(a,b)}show(){if(this.pu()){const a=document.getElementById("slideshow-toolbar");if(a){const b=(this.iZa+this.IU-16-this.Ci.getToolbarWidth()).toString()+"px";a.style.left=b}}this.Ci.showToolbar();this.Ci.enterFocusTrapZone();
window.clearTimeout(this.MXa);window.clearTimeout(this.fEb);this.dze?(this.MXa=window.setTimeout(Object(I.a)(this,this.hide,"hide"),2E3),this.dze=!1,this.que=!0):this.MXa=window.setTimeout(Object(I.a)(this,this.hide,"hide"),3E3);this.jb.Pga(!0)}XCh(){if(this.pu()){const a=document.getElementById("slideshow-toolbar");if(a){const b=(this.iZa+this.IU-16-this.Ci.getToolbarWidth()).toString()+"px";a.style.left=b}}this.Ci.showToolbar();this.Ci.enterFocusTrapZone();window.clearTimeout(this.MXa);window.clearTimeout(this.fEb);
this.fEb=window.setTimeout(Object(I.a)(this,this.hide,"hide"),1E4)}hide(){if(!this.sM){const a=document.getElementById("slideshow-toolbar");a&&!this.Ci.isAnyToolbarElementFocused()&&document.activeElement===a&&this.J2a(ResourceStrings.l_SlideShowToolbarDismissed);window.clearTimeout(this.MXa);window.clearTimeout(this.fEb);this.Ci.hideToolbar();this.jb.Pga(!1);this.qe.style.display===wf.a.Pe&&this.jb.restoreFocus()}}nxb(){this.sM||(this.que&&this.J2a(ResourceStrings.l_SlideShowToolbarDismissed),window.clearTimeout(this.MXa),
window.clearTimeout(this.fEb),this.Ci.forceHideToolbar(),this.jb.Pga(!1),this.qe.style.display===wf.a.Pe&&this.jb.restoreFocus())}remove(){this.Ci.closeToolbar();this.Tea.style.visibility=wf.a.Xs;this.K9c=!1;this.jb.yga(Object(I.a)(this,this.koa,"onExitHandler"));this.jb.uVe(Object(I.a)(this,this.cib,"onBrowserEventHandler"));this.jb.bpd(Object(I.a)(this,this.Ixa,"onGetCurrentSlideDimensionsHandler"));this.jb.epd(Object(I.a)(this,this.Sxa,"onSpecialKeyHandler"));this.jb.wVe(Object(I.a)(this,this.dib,
"onContextMenuHandler"));this.jb.xVe(Object(I.a)(this,this.vid,"onEnterEndOfShowHandler"));this.jb.zVe(Object(I.a)(this,this.Xid,"onLeaveEndOfShowHandler"));hd.a.removeHandler(this.qe,oa.a.qq,Object(I.a)(this,this.lib,"onMouseOverHandler"));hd.a.removeHandler(this.qe,oa.a.Vs,Object(I.a)(this,this.Mmc,"onMouseOutHandler"));hd.a.removeHandler(this.Tea,oa.a.click,Object(I.a)(this,this.dga,"onClickHandler"));hd.a.removeHandler(this.qe,oa.a.Bf,Object(I.a)(this,this.WJa,"onKeyDownHandler"));this.qe&&(this.tf.contains(this.qe)||
this.x8c&&this.x8c.contains(this.qe))&&(this.sM=!1);this.Ub&&this.Ub.instance&&this.Ub.instance.Er&&(this.Ub.instance.Roh(Object(I.a)(this,this.Kmc,"onLiveSessionStarted")),this.Ub.instance.Qoh(Object(I.a)(this,this.Jmc,"onLiveSessionEnded")),this.Ub.instance.Ooh(Object(I.a)(this,this.Imc,"onLiveRelaunchPausedSession")),this.Ub.instance.O7k(Object(I.a)(this,this.o$g,"onLiveCalloutMenuDefintionChanged")))}koa(){this.remove()}J2a(a){ma.a.Xa(a)?xa.a.J(512495953,830,15,"ReactSlideshowToolbar::TryRaiseSlideshowNavigationToolbarClickedEvent, Toolbar title is null"):
this.EHe.Rkh(new Kx(a))}Ixa(a,b){try{this.iZa=b.wDh;this.gZa=b.sDh;this.IU=b.slideWidth;if("NaN"===this.iZa.toString()||"NaN"===this.gZa.toString()){xa.a.J(512495952,830,10,"ReactSlideshowToolbar.OnGetCurrentSlideDimensionsHandler slide dimension info is null.");const c=$e.a.Oh(359);w.AFrameworkApplication.Oo(c);$d.Health.instance.recordQosError($e.a.ida(c),["SlideShowACE"],!1,!0,!0,!1,null)}else{const c=this.Ub.instance&&this.Ub.instance.kr&&!this.K9c?26:0;if(this.Ea.pptEditorVoiceUXEnabled){const f=
document.getElementById("slideshowfooterContainerElement");if(f){let l;l=this.pu()?(this.iZa+this.IU-16-this.Ci.getToolbarWidth()).toString()+"px":(this.iZa+2).toString()+"px";f.style.left=l;if(this.Hc.Qh&&"AboveSlide"===this.Hc.fw)f.style.bottom="0px";else{const H=Ea.a.NXc();a=0;const Q=document.getElementById("AppHeaderPanel");Q&&(a=Q.clientHeight);f.style.bottom=this.nu.B9?(H-this.gZa-c).toString()+"px":(H-this.gZa-a-c).toString()+"px"}f.style.top="auto";const y=document.getElementById("ReactToolbarInnerContainer");
y&&(y.style.position="relative")}}else{const f=document.getElementById("slideshow-toolbar");if(f){let l;l=this.pu()?(this.iZa+this.IU-16-this.Ci.getToolbarWidth()).toString()+"px":(this.iZa+2).toString()+"px";f.style.left=l;const y=this.Ub.instance&&this.Ub.instance.kr?(this.gZa+c).toString()+"px":this.gZa.toString()+"px";"AboveSlide"===this.Hc.fw?(f.style.bottom="0px",f.style.top="auto"):(f.style.top=y,f.style.bottom="auto");f.style.top=y}}}this.show()}catch(c){xa.a.J(512495951,830,10,"ReactSlideshowToolbar.OnGetCurrentSlideDimensionsHandler: Exception thrown when trying to access the OnGetCurrentSlideDimensionsEventArgs, exception: {0}",
c)}}vid(){this.K9c=!0}Xid(){this.K9c=!1}WJa(a){this.Ci.isAnyCalloutMenuOpen()||(this.sM=!1);try{this.qe.style.display===wf.a.Rj&&(a.keyCode===B.a.Tnb||a.keyCode===B.a.rC||a.keyCode===B.a.n2?this.jb.prev():a.keyCode===B.a.vAa||a.keyCode===B.a.qC||a.keyCode===B.a.m2?this.jb.next():a.keyCode===B.a.qS?this.pu()?this.jb.next():this.jb.prev():a.keyCode===B.a.BP?this.pu()?this.jb.prev():this.jb.next():a.keyCode===B.a.lNa?(this.aHe=!0,this.nxb()):a.shiftKey&&a.keyCode===B.a.gqa||a.keyCode===B.a.QRb?this.nxb():
this.jb.dZe(a))}catch(b){xa.a.J(512495950,822,10,"ReactSlideshowToolbar.OnKeyDownHandler Exception in KeyDownHandler : {0}.",b)}}Sxa(a,b){this.Ci.isAnyCalloutMenuOpen()||(this.sM=!1);if(b.key===B.a.QRb||b.shiftKey&&b.key===B.a.gqa)a="off",this.qe.style.display===wf.a.Pe?(this.XCh(),a="on"):this.nxb(),xa.a.J(512495949,830,50,"ReactSlideshowToolbar.OnSpecialKeyHandler: T key pressed, turned slideshow toolbar {0}",a)}dib(){if(this.aHe)this.aHe=!1;else{var a="off";this.qe.style.display===wf.a.Pe?(this.XCh(),
a="on"):this.Ci.isAnyCalloutMenuOpen()||this.nxb();xa.a.J(512495948,830,50,"ReactSlideshowToolbar.OnContextMenuHandler: ContextMenu event received, turned slideshow toolbar {0}",a)}}cib(a,b){this.Awl();b.clientY<this.gZa+8+20&&b.clientY>this.gZa-20-8&&this.show()}lib(a){(a=a.target)&&this.qe.contains(a)&&(this.sM=!0)}Mmc(a){a.target&&(this.Ci.isAnyCalloutMenuOpen()?this.Tea.style.visibility=wf.a.Oz:(this.sM=!1,this.show()));this.Ci.isAnyCalloutMenuOpen()||this.Ci.enterFocusTrapZone()}dga(a){this.sM=
!1;window.clearTimeout(this.MXa);window.clearTimeout(this.fEb);this.Tea.style.visibility=wf.a.Xs;this.MXa=window.setTimeout(Object(I.a)(this,this.hide,"hide"),3E3);"SlideshowToolbarCalloutMenuContainer"===a.target.id&&this.Ci.enterFocusTrapZone()}dJb(){xa.a.J(512495947,830,50,"ReactSlideshowToolbar.OnPrevClickHandler");this.jb.prev()}ZIb(){xa.a.J(512495946,830,50,"ReactSlideshowToolbar.OnNextClickHandler");this.jb.next()}TIb(){xa.a.J(512495945,830,50,"ReactSlideshowToolbar.OnExitClickHandler");this.Ci.closeToolbar();
this.jb.exit()}J6e(a){const b=!!this.Ub&&!!this.Ub.instance&&this.Ub.instance.kr;var c=this.Hc.CZf&&5!==a&&!b;5!==a&&(this.Hc.Qh&&(pi.a.oK("PPTCaptionDiscoverabiltyDoNotShowAgain","true",pi.a.XJ)||xa.a.J(512495944,822,10,"ReactSlideshowToolbar::ToggleTranscriber - Failed to set cookie for discoverability opt out to true")),this.Hc.Qh=!this.Hc.Qh);this.Ci.setToolbarButtonToggleState(fh.a.SubtitlesButton,this.Hc.Qh);xa.a.J(512495943,830,50,"ReactSlideshowToolbar.ToggleTranscriber m_subtitleContext FUseSubtitles is changed to: {0}",
this.Hc.Qh);this.Hc.Qh&&c&&yz.Aug(this.jb,this.ke,this.Ya);c||(c=Date.now(),b?this.tR||this.Ub.instance.Wwb()?this.jb.toggleTranscriberUIVisibility(null):(this.Ub.instance.jfg(),this.jb.transcribe(w.AFrameworkApplication.userSessionId,this.Ya.podSessionId,this.Ya.Ek,w.AFrameworkApplication.gh,a,c,this.Yo)):this.jb.transcribe(w.AFrameworkApplication.userSessionId,this.Ya.podSessionId,this.Ya.Ek,w.AFrameworkApplication.gh,a,c,this.Yo));this.tR=this.Hc.Qh||b;this.oyd();this.SQb()}oyd(){this.Ci.setToolbarButtonToggleState(fh.a.MicButton,
this.tR);this.tR?this.Ci.showToolbarButton(fh.a.MicButton):this.Ci.hideToolbarButton(fh.a.MicButton)}SQb(){const a=this.Hc.Qh,b=!!this.Ub&&!!this.Ub.instance&&this.Ub.instance.kr,c=this.Yo.D4,f=32!==this.ia.processAction(ea.a.wga,1);a||b||c||f?this.Ci.hideToolbarButton(fh.a.CoachButton):this.Ci.showToolbarButton(fh.a.CoachButton)}$Ek(){xa.a.J(512495942,830,50,"ReactSlideshowToolbar.OnMicToggleHandler");this.tR=!this.tR;this.Ci.setToolbarButtonToggleState(fh.a.MicButton,this.tR);this.jb.setMicrophoneState(!this.tR);
if(this.Ub&&this.Ub.instance&&this.Ub.instance.kr&&this.tR&&!this.Ub.instance.Wwb()){this.Ub.instance.jfg();const a=this.Hc.Qh;this.Ub.instance.Gda=!this.Hc.Qh;this.Hc.Qh=!0;this.jb.transcribe(w.AFrameworkApplication.userSessionId,this.Ya.podSessionId,this.Ya.Ek,w.AFrameworkApplication.gh,5,Date.now(),this.Yo);this.Hc.Qh=a}}lBk(){xa.a.J(509157450,830,50,"ReactSlideshowToolbar.OnCameraToggleHandler");this.Yeb=!this.Yeb;this.Ci.setToolbarButtonToggleState(fh.a.CameraButton,this.Yeb);this.jb.yZe(this.Yeb)}EBk(){xa.a.J(512495941,
830,50,"ReactSlideshowToolbar.OnCoachClickHandler");32===this.ia.Ka(ea.a.wga,2,{entryPoint:2})?this.Ea.pptEditorRehearsalSpeechClientEnabled||(this.Yo.D4=!0):xa.a.J(512495940,830,10,"ReactSlideshowToolbar.OnCoachClickHandler - Failed to start Rehearsal Session")}gkd(){xa.a.J(512495939,830,50,"ReactSlideshowToolbar.OnTranscribeHandler");this.J6e(3)}UIb(){xa.a.J(512495938,830,50,"ReactSlideshowToolbar.OnGridViewClickHandler");this.ia.Ka(ea.a.HOb,2,null)}IEk(){this.Ub&&this.Ub.instance&&(xa.a.J(512495937,
830,50,"FLiveBroadcastInUse is changed to: {0}",this.Ub.instance.kr),this.Ub.instance.kr||(this.Ub.instance.Duc(3,w.AFrameworkApplication.userSessionId,this.Ea.podsWebServiceBase,this.Ya.podSessionId,w.AFrameworkApplication.gh),this.Ub.instance.Gda=!this.Hc.Qh,this.Hc.Swb&&!this.Hc.Qh&&(xa.a.J(512495936,830,50,"Starting subtitle in OnLiveBroadcastHandler for starting live session."),this.Hc.Qh=!0,this.jb.transcribe(w.AFrameworkApplication.userSessionId,this.Ya.podSessionId,this.Ya.Ek,w.AFrameworkApplication.gh,
5,Date.now(),this.Yo),this.Hc.Qh=!1,this.tR=!0,this.oyd()),this.sM=!1,this.Ci.setToolbarButtonToggleState(fh.a.LiveButton,!0)));this.SQb()}Kmc(){this.Ci.setToolbarButtonToggleState(fh.a.LiveButton,!0);this.nyd(!1,!1);this.tR=!0;this.oyd();this.SQb();this.j5g()}Jmc(){this.Ci.setToolbarButtonToggleState(fh.a.LiveButton,!1);this.nyd(!1,!0);this.Ub&&this.Ub.instance&&this.Ub.instance.Gda&&!this.Hc.Qh&&(xa.a.J(512495907,830,50,"Stopping subtitle for stopping live session."),this.jb.transcribe(w.AFrameworkApplication.userSessionId,
this.Ya.podSessionId,this.Ya.Ek,w.AFrameworkApplication.gh,5,Date.now(),this.Yo));this.Ub.instance.Gda=!1;this.Hc.Qh||(this.tR=!1,this.oyd());this.SQb()}Imc(){this.Ub&&this.Ub.instance&&(this.sM=!0,this.show(),this.Tea.style.visibility=wf.a.Oz,this.nyd(!0,!1),this.j5g());this.SQb()}j5g(){this.Ea.emd&&!this.Ub.instance.Wwb()&&(this.tR=!1,this.Ci.setToolbarButtonToggleState(fh.a.MicButton,this.tR),this.Hc.Qh=!1,this.Ci.setToolbarButtonToggleState(fh.a.SubtitlesButton,this.Hc.Qh))}o$g(){this.nyd(!1,
!1)}nyd(a,b){if(this.Ub&&this.Ub.instance){const c=new WJ;c.menuDefinition=b?null:this.Ub.instance.getCalloutMenuDefinition();c.autoOpenMenu=a;this.Ci.updateElementProps(fh.a.LiveButton,c);this.Ci.updateFlyoutButtonCallback(fh.a.LiveButton,!b)}}zMj(){this.Pik.execute(Object(I.a)(this,this.yMj,"initInkButton"));const a=new YJ;a.item="Init";this.jb.CPe(a);this.Ci.registerButtonCallback(fh.a.InkButton,()=>{})}yMj(a){const b=new XJ;b.onInkMenuActivity=c=>{this.fEk(c)};this.rEb=a.bjj(b);a=wz.create();
a.icon=this.rEb.getIcon();a.menuDefinition=this.rEb.getControlsInMenu();a.menuHostId="SlideshowToolbarCalloutMenuContainer";this.Ci.updateElementProps(fh.a.InkButton,a)}fEk(a){this.jb.CPe(a);a=wz.create();a.selectedColor=this.rEb.getSelectedColor();a.icon=this.rEb.getIcon();a.menuDefinition=this.rEb.getControlsInMenu();this.Ci.updateElementProps(fh.a.InkButton,a);this.nxb()}}Object(m.a)(fD,"ReactSlideshowToolbar",null,[583,584]);class gD{constructor(a,b){this.Sk=a;this.Zfc=document.createElement("div");
this.Zfc.id="slideshowfooterContainerElement";this.Zfc.className="slideshowFooterContainer";this.ia=b}init(){xa.a.J(595198370,830,50,"SlideShowFooterContainer.Init");this.Sk&&this.Sk.appendChild(this.Zfc)}remove(){this.Sk&&this.Sk.contains(this.Zfc)&&this.Sk.removeChild(this.Zfc)}vb(){this.ia.ya(ea.a.dCh,hc.a.application,Object(I.a)(this,this.Wvl,"showFooterElements"));this.ia.ya(ea.a.xhg,hc.a.application,Object(I.a)(this,this.GIj,"hideFooterElements"))}Wvl(a,b,c){2===c&&(a=document.getElementById("slideshowfooterContainerElement"))&&
(a.style.display="flex");return 32}GIj(a,b,c){2===c&&(a=document.getElementById("slideshowfooterContainerElement"))&&(a.style.display=wf.a.Pe);return 32}}Object(m.a)(gD,"SlideShowFooterContainer",null,[586]);class $J{constructor(){this.hostElement=null;this.baseZIndex=0}}Object(m.a)($J,"IVoiceActorSettings",null,[]);class aK{constructor(){this.Tkc=this.Sk=this.thb=null}init(){xa.a.J(595198290,830,50,"SlideShowVoiceNotification.Init");this.thb=document.createElement("div");this.thb.id="voiceNotificationContainerElement";
this.thb.className="voiceNotificationContainer";(this.Sk=document.getElementById("slideshowfooterContainerElement"))&&this.Sk.insertBefore(this.thb,this.Sk.firstChild);const a=new $J;a.baseZIndex=50002;a.hostElement=this.thb;this.Tkc=voiceUI.VoiceActorFactory.CREATE_VOICE_ACTOR(a)}remove(){this.Sk&&this.Sk.contains(this.thb)&&this.Sk.removeChild(this.thb)}show(a,b){this.Tkc&&this.Tkc.showNotification(a,b)}hide(){this.Tkc&&this.Tkc.hideNotification()}}Object(m.a)(aK,"SlideShowVoiceNotification",null,
[444]);class hD extends bi.a{constructor(a,b){super(!1,!0);this.Xjc=null;this.deb=this.sXa=0;this.GDe=50001;this.aFb=null;this.jb=a;this.Ylk=b;this.jb.ija(Object(I.a)(this,this.jga,"onSlideshowExitHandler"));this.jb.C_b(Object(I.a)(this,this.ega,"onGetCurrentPositionHandler"));this.jb.getCurrentPosition();this.VHa=!1}get Dud(){if(void 0===this.Xjc||null===this.Xjc)this.Xjc=document.getElementById("GotoDlgInput");return this.Xjc}GSl(){if(!RegExp("^[0-9]+$").test(this.Dud.value))return this.Dud.value=
this.sXa.toString(),!1;this.deb=Number.parseInvariant(this.Dud.value);this.deb=Math.min(this.deb,this.Ylk);this.deb=Math.max(this.deb,1);return!0}dispose(){super.dispose();this.Xjc=null;this.VHa||this.jb.restoreFocus()}Bu(){super.Bu();document.getElementById("WACDialogOverlay").style.zIndex=String(this.GDe);const a=document.getElementById("WACDialogOuterContainer");Sys.UI.DomElement.addCssClass(a,"SlideShowGoToDialogContainer")}VA(){super.VA();const a=document.getElementById(this.Uh("WACDialogPanel"));
a.style.minWidth=rb.a.Pc(300);a.style.width=rb.a.Pc(300)}open(){xa.a.J(24133980,830,50,"SlideshowGoToDialog: Open");this.sg="<div id='GotoDlgLabelHolder'><label id='GotoDlgLabel'></label></div><input id='GotoDlgInput' type='text'/>";const a={["GotoDlgLabel"]:ResourceStrings.l_GotoSlideLabel,["GotoDlgInput"]:this.sXa.toString()};this.pj(ResourceStrings.L_GoTo,Object(I.a)(this,this.dga,"onClickHandler"),a);this.jb.setVisibility(!0);this.Dud.focus()}r8(){super.r8();this.aFb=Object(I.a)(this,this.WJa,
"onKeyDownHandler");w.AFrameworkApplication.Aa.zG.Bod(oa.a.Bf,window.document,this.aFb,null)}Ysa(){super.Ysa();void 0!==this.aFb&&null!==this.aFb&&w.AFrameworkApplication.Aa.zG.F8e(oa.a.Bf,window.document,this.aFb);this.aFb=null}bkb(){}ega(a,b){this.jb.ckb(Object(I.a)(this,this.ega,"onGetCurrentPositionHandler"));this.sXa=b.slideIndex+1;this.open()}jga(){this.VHa=!0;this.jb.yga(Object(I.a)(this,this.jga,"onSlideshowExitHandler"));this.jb.ckb(Object(I.a)(this,this.ega,"onGetCurrentPositionHandler"));
this.hide()}WJa(a){a=a.mc.keyCode;return a===B.a.Dp?(this.GSl()&&(this.zUa(this.deb),this.hide()),!0):a===B.a.RRb||a===B.a.nNa||a===B.a.IPh||a===B.a.Wyd?!0:!1}dga(a){1===a&&this.zUa(this.deb)}zUa(a){this.jb.zUa(a-1)}static a8j(a,b){1>=b||void 0!==Dl.a.wx&&null!==Dl.a.wx||new hD(a,b)}}Object(m.a)(hD,"SlideshowGoToDialog",bi.a,[]);class iD{constructor(a,b,c,f,l,y,H,Q,ia){this.o5=this.K=null;this.xEb=!1;this.X4=[];this.xXa=this.EE=this.dgc=null;this.jb=a;this.Sb=b;this.cwa=c;this.ia=f;this.le=l;this.tf=
y;this.pu=H;this.nu=Q;this.Ub=ia}init(){this.K||(this.K=document.createElement("div"),this.K.id="SlideshowContextMenuContainer",this.K.className="SlideshowContextMenuContainer");this.o5=document.createElement("div");this.o5.className="SlideshowContextMenu cui-menu";this.o5.tabIndex=0;const a=document.createElement("ul");a.className="SlideshowContextMenuList cui-menusection-items";const b=this.pu();let c=this.oL(ResourceStrings.L_Next,Object(I.a)(this,this.ZIb,"onNextClickHandler"),b);Array.add(this.X4,
c);a.appendChild(c);c=this.oL(ResourceStrings.L_Previous,Object(I.a)(this,this.dJb,"onPrevClickHandler"),b);Array.add(this.X4,c);a.appendChild(c);c=this.oL(ResourceStrings.l_GotoCell,Object(I.a)(this,this.RDk,"onGoToClickHandler"),b);Array.add(this.X4,c);a.appendChild(c);c=this.oL(ResourceStrings.L_GridView_SeeAllSlides,Object(I.a)(this,this.UIb,"onGridViewClickHandler"),b);Array.add(this.X4,c);a.appendChild(c);this.nu.XHf&&(this.dgc=this.oL(this.nu.B9?ResourceStrings.L_ExitFullscreen:ResourceStrings.L_EnterFullscreen,
Object(I.a)(this,this.VJa,"onFullscreenClickHandler"),b),Array.add(this.X4,this.dgc),a.appendChild(this.dgc),this.nu.A_&&!this.EE&&(this.EE=Object(I.a)(this,this.Bmc,"onFullscreenChangeHandler"),$addHandler(this.tf,this.nu.A_,this.EE)));c=this.oL(ResourceStrings.L_EndShow,Object(I.a)(this,this.TIb,"onExitClickHandler"),b);Array.add(this.X4,c);a.appendChild(c);this.Ub&&this.Ub.instance&&this.Ub.instance.Er&&(this.xXa=this.oL(ResourceStrings.l_EndLivePresentation,Object(I.a)(this,this.QCk,"onEndLivePresentationClickHandler"),
b),Array.add(this.X4,this.xXa));this.o5.appendChild(a);this.K.appendChild(this.o5);this.tf.appendChild(this.K);this.cwa.addHandler(this.K,oa.a.click,Object(I.a)(this,this.dga,"onClickHandler"));this.cwa.addHandler(this.K,oa.a.contextMenu,Object(I.a)(this,this.O9g,"onHostContextMenuHandler"));this.cwa.addHandler(this.o5,oa.a.qq,Object(I.a)(this,this.lib,"onMouseOverHandler"));this.jb.hTd(Object(I.a)(this,this.dib,"onContextMenuHandler"));this.jb.ija(Object(I.a)(this,this.koa,"onExitHandler"))}show(){if(this.Ub&&
this.Ub.instance&&this.Ub.instance.kr&&this.xXa&&!this.xXa.parentNode){const a=this.o5.getElementsByClassName("SlideshowContextMenuList cui-menusection-items");1===a.length&&a[0].appendChild(this.xXa)}this.xEb||(this.cwa.addHandler(window.document,oa.a.Bf,Object(I.a)(this,this.WJa,"onKeyDownHandler")),this.cwa.addHandler(window.document,oa.a.Tl,Object(I.a)(this,this.Hmc,"onKeyUpHandler")),this.xEb=!0);this.K.style.visibility=wf.a.Oz}hide(){this.cwa.removeHandler(window.document,oa.a.Bf,Object(I.a)(this,
this.WJa,"onKeyDownHandler"));this.cwa.removeHandler(window.document,oa.a.Tl,Object(I.a)(this,this.Hmc,"onKeyUpHandler"));this.xEb=!1;this.K.style.visibility=wf.a.Xs;if(this.xXa&&this.xXa.parentNode){const a=this.o5.getElementsByClassName("SlideshowContextMenuList cui-menusection-items");1===a.length&&a[0].removeChild(this.xXa)}}remove(){this.K&&(this.cwa.removeHandler(this.K,oa.a.click,Object(I.a)(this,this.dga,"onClickHandler")),this.cwa.removeHandler(this.K,oa.a.contextMenu,Object(I.a)(this,this.O9g,
"onHostContextMenuHandler")),this.tf.contains(this.K)&&this.tf.removeChild(this.K));this.K=null;Array.clear(this.X4)}koa(){this.jb.yga(Object(I.a)(this,this.koa,"onExitHandler"));this.jb.wVe(Object(I.a)(this,this.dib,"onContextMenuHandler"));this.dgc&&($removeHandler(this.tf,this.nu.A_,this.EE),this.EE=null);this.remove()}dga(a){"SlideshowContextMenuContainer"===a.target.id&&(this.hide(),this.jb.restoreFocus())}dib(a,b){this.Dch(b.clientX,b.clientY)}O9g(a){this.Dch(a.clientX,a.clientY)}lib(a){(a=
a.target)&&"li"===a.tagName.toLowerCase()&&(this.XUe(document.activeElement),this.eS(a))}WJa(a){const b=a.keyCode,c=a.shiftKey;b===B.a.$q||b===B.a.f7?this.k5g(!!(1^c)):b===B.a.nZ&&this.k5g(!!(0^c));a.preventDefault()}Hmc(a){var b=a.keyCode;b===B.a.Dp||b===B.a.zK?(b=document.activeElement,Array.contains(this.X4,b)&&b.click()):b===B.a.mZ&&this.jb.exit();a.preventDefault()}Dch(a,b){this.setPosition(a,b);this.XAi();this.show();this.o5.focus();this.le.Qkh(new Kx(ResourceStrings.L_ControlMenu))}setPosition(a,
b){if(this.o5){var c=this.o5.offsetWidth,f=this.o5.offsetHeight,l=this.K.clientHeight;a+c>this.K.clientWidth&&(a-=c);b+f>l&&(b-=f);this.o5.style.top=rb.a.Pc(b);this.o5.style.left=rb.a.Pc(a)}}oL(a,b,c){const f=document.createElement("li");f.className="SlideshowContextMenuItem cui-ctl-mediumlabel";f.innerText=a;f.style.direction=c?"rtl":"ltr";f.tabIndex=1;this.cwa.addHandler(f,oa.a.click,b);return f}dJb(){xa.a.J(24133957,830,50,"SlideshowContextMenu.OnPrevClickHandler");this.jb.prev();this.hide();this.jb.restoreFocus()}ZIb(){xa.a.J(24133959,
830,50,"SlideshowContextMenu.OnNextClickHandler");this.jb.next();this.hide();this.jb.restoreFocus()}RDk(){xa.a.J(24133961,830,50,"SlideshowContextMenu.OnGoToClickHandler");this.hide();hD.a8j(this.jb,this.Sb.Cj())}UIb(){xa.a.J(50602842,830,50,"SlideshowContextMenu.OnGridViewClickHandler");this.hide();this.ia.Ka(ea.a.HOb,2,null)}VJa(){xa.a.J(40935580,830,50,"SlideshowContextMenu.OnFullscreenClickHandler");this.jb.G6e();this.hide();this.jb.restoreFocus()}Bmc(){this.dgc.innerText=this.nu.B9?ResourceStrings.L_ExitFullscreen:
ResourceStrings.L_EnterFullscreen}TIb(){xa.a.J(24133963,830,50,"SlideshowContextMenu.OnExitClickHandler");this.hide();this.jb.exit()}QCk(){xa.a.J(50619421,830,50,"SlideshowContextMenu.OnEndLivePresentationClickHandler");this.hide();this.jb.restoreFocus();this.Ub&&this.Ub.instance&&this.Ub.instance.kr&&this.Ub.instance.showEndSessionDialog(()=>{this.Ub.instance.p5b(4)},()=>{})}k5g(a){const b=document.activeElement,c=Array.indexOf(this.X4,b);a=this.X4[((-1===c?a?0:-1:a?c+1:c-1)+this.X4.length)%this.X4.length];
void 0!==a&&null!==a&&(this.XUe(b),this.eS(a))}XAi(){this.X4.forEach(a=>{this.XUe(a)})}eS(a){void 0!==a&&null!==a&&(Sys.UI.DomElement.addCssClass(a,"SlideshowContextMenuItemFocus"),a.focus(),this.le.Qkh(new Kx(a.innerText)))}XUe(a){void 0!==a&&null!==a&&Sys.UI.DomElement.removeCssClass(a,"SlideshowContextMenuItemFocus")}}Object(m.a)(iD,"SlideshowContextMenu",null,[584]);var gR=d(1031),Lx=d(260);class bK{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd){this.xa=new Pc.a;this.EE=null;
this.fGe=this.gGe=this.Zdd=this.akc=-1;this.Yyg=this.$yg=this.Zyg=this.cFb=null;this.Ndc="";this.ufd=this.ded=-1;this.RLg=new Date(0);this.DLg="";this.TBg=null;this.ZDg=this.Ieb=this.Fye=this.JAe=!1;this.DIa=this.Yo=this.Hc=null;this.Wec=-1;this.mDg=this.CDg=!1;this.nu=a;this.jb=b;this.dfa=c;this.Sb=ia;this.la=H;this.Ifk=f;this.ai=l;this.Su=y;this.Ur=Q;this.Ya=wa;this.Bz=Ua;this.Ud=kb;this.bxa=Gb;this.Mc=ec;this.Bfd=dc;this.mxa=Fc;this.vu=this.Ur.SF();this.g_g=this.la.pptEditorHermesSlideShowStartTimeout;
this.KHe=this.la.slideShowWaitForRehydrationTimeoutInMs;this.Mc.GC(Object(I.a)(this,this.WE,"onSessionEnd"));this.Bz.rTd(Object(I.a)(this,this.cJb,"onPodSessionUnavailable"));this.Mc.HC(Object(I.a)(this,this.Mo,"onSessionRehydrated"));this.la.allowDisablingSlideShowButtonDueToRehydration&&(this.Bz.Lsb(Object(I.a)(this,this.fga,"onPodSessionRefreshed")),this.Bz.Czf(Object(I.a)(this,this.Ajd,"onPodSessionRefreshedFromBrowser")));this.ia=yc;this.Ub=tc;this.Xdd=xd;this.Xl=Vd;a=document.createElement("div");
a.id="HiddenFocusTrapAnchor";w.AFrameworkApplication.fa.ka("RegionComposerIsEnabled")||w.AFrameworkApplication.fa.ka("Fluent2StyleIsEnabled")?a.style.position="absolute":a.style.position="position: absolute";a.style.left="-10000px";a.style.top="auto";a.style.width="1px";a.style.height="1px";a.style.overflow="hidden";a.tabIndex=-1;this.vu.insertBefore(a,this.vu.firstChild)}dispose(){this.Mc.Laa(Object(I.a)(this,this.WE,"onSessionEnd"));this.Bz.G8k(Object(I.a)(this,this.cJb,"onPodSessionUnavailable"));
this.Mc.zga(Object(I.a)(this,this.Mo,"onSessionRehydrated"));this.la.allowDisablingSlideShowButtonDueToRehydration&&(this.Bz.fkb(Object(I.a)(this,this.fga,"onPodSessionRefreshed")),this.Bz.Yoh(Object(I.a)(this,this.Ajd,"onPodSessionRefreshedFromBrowser")))}bNj(a,b,c,f){this.TBg=b;"Legacy"==this.jb.f9()&&this.jb.init(a,b,c,this.Ya.podSessionId);this.Hc=f;this.Yo=new xz}f9(){return this.jb.f9()}mcc(){return!ma.a.Xa(this.Ndc)}get yge(){return this.Ieb}set yge(a){this.Ieb=a}nml(){this.mDg=!0}Sud(a,b,
c,f,l,y,H,Q,ia,wa,Ua,kb,Gb){$d.Health.instance.addQosPillar("Present");this.mcc()&&xa.a.J(512495816,830,15,"SlideshowManager:StartFrom starting a new SlideShow while one is already running");w.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")&&(this.DIa=Ib.a.instance.resolve("PowerPointWebEditor.PresenterView.IPresenterViewManager"))&&this.DIa.mfb&&(this.Wec=b,this.ia.processAction(ea.a.qud,2,null),this.DIa.Sgi(Object(I.a)(this,this.gGk,"onPresenterViewSyncMessageReceivedHandler")));const ec=
c;this.la.pptEditorRehearsalSpeechClientEnabled&&(c=!1);this.akc=wa;this.Zdd=Date.now();const dc=document.createElement("div");dc.id="startingSlideshowHiddenDiv";dc.style.position="position: absolute";dc.style.left="-10000px";dc.style.top="auto";dc.style.width="1px";dc.style.height="1px";dc.style.overflow="hidden";dc.tabIndex=-1;dc.setAttribute("aria-live","assertive");this.vu.insertBefore(dc,this.vu.firstChild);dc.innerText=ResourceStrings.l_StartingSlideShow;const Fc=Q+wa.toString();this.Ndc=Fc;
this.bxa&&this.bxa.btc(!0);this.la.s3j&&this.Bfd&&this.Bfd.btc(!0);this.Yo&&(this.Yo.D4=c,this.Yo.startingSlideIndex=b,this.Yo.vza=this.Sb.Cj(),this.Yo.VTf=this.la.V4k);this.la.pptEditorVoiceUXEnabled&&this.Xdd&&this.Xdd.init();this.la.pptEditorVoiceUXEnabled&&this.Xl&&this.Xl.execute(tc=>{tc.init()});this.dfa.execute(tc=>{tc.init(this.Hc,this.Yo)});this.Zyg=this.vu.style.top;this.vu.style.top=rb.a.Pc(0);this.la.ZVa&&(this.$yg=this.vu.style.width,this.Yyg=this.vu.style.height,this.vu.style.width=
"100%",this.vu.style.height="100%");this.jb.show();this.Eug();this.la.BDh&&at.a.DQb(!1);w.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")&&this.DIa&&this.DIa.mfb&&this.jb.KQa(Object(I.a)(this,this.Qjd,"onSlideChangedHandler"));this.jb.ija(Object(I.a)(this,this.koa,"onExitHandler"));this.jb.mzf(Object(I.a)(this,this.VJa,"onFullscreenClickHandler"));this.jb.hJc(Object(I.a)(this,this.Bbh,"onSlideshowReadyHandler"));this.jb.jzf(Object(I.a)(this,this.xid,"onErrorHandler"));this.jb.iJc(Object(I.a)(this,
this.Sxa,"onSpecialKeyHandler"));this.jb.mTd(Object(I.a)(this,this.zjd,"onPodSessionExpiredHandler"));this.jb.pzf(Object(I.a)(this,this.ajd,"onLogEndOfTranscriptionSessionHandler"));this.jb.ozf(Object(I.a)(this,this.$id,"onLiveSubtitlesDockedViewHandler"));this.jb.Gzf(Object(I.a)(this,this.rod,"recordQosErrorHandler"));this.la.allowDisablingSlideShowButtonDueToRehydration||(this.Bz.Lsb(Object(I.a)(this,this.fga,"onPodSessionRefreshed")),this.Bz.Czf(Object(I.a)(this,this.Ajd,"onPodSessionRefreshedFromBrowser")));
this.Kgi(Object(I.a)(this,this.Vid,"onKeydownHandler"));c=Date.now();let yc=!this.la.Hqg||Ua;yc||(yc=this.ai.SUc().bO());this.CDg=yc;wa=Date.now();xa.a.J(512495815,830,50,"SlideshowManager: Outbound decision time in {0} ms, fWaitForForceOutbound is {1}, fFailOverInProgress is {2}.",wa-c,yc?"True":"False",Ua?"True":"False");this.gGe=Date.now();this.ai.SUc().forceOutbound(()=>{xa.a.J(512495814,830,50,"SlideshowManager: Will notify Replication Cache to flush unsaved revisions.");this.ai.flush(()=>{this.fGe=
Date.now();xa.a.J(512495813,830,50,"SlideshowManager: Finished flushing in {0} ms.",this.fGe-this.gGe);this.Ndc===Fc&&yc&&(Ua&&kb&&(xa.a.J(512495812,830,50,"SlideshowManager: Refreshing the pod sessionId."),l=kb.Ek,y=kb.podSessionId),this.NEh(a,b,f,l,y,H,Q,ia,Gb,ec),xa.a.J(512495811,830,50,"SlideshowManager: Launched slideshow after ForceOutbound response."))},tc=>{xa.a.J(512495810,830,10,"SlideshowManager: Failed to make Replication Cache flush unsaved revisions. {0}",tc.ServerError);return!1})},
(tc,xd)=>{xa.a.J(512495809,830,10,"SlideshowManager: Failed to force outbound. {0}",xd)},null);this.Ndc!==Fc||yc||(this.NEh(a,b,f,l,y,H,Q,ia,Gb,ec),xa.a.J(512495808,830,50,"SlideshowManager: Launched slideshow without waiting for ForceOutbound."))}NEh(a,b,c,f,l,y,H,Q,ia,wa=!1){const Ua=Hg.a.create().toString();this.la.Kog&&this.SNk(c,l,H,Ua);const kb={};kb.SlideShowKind=this.jb.f9();kb.IsFrameNull=this.jb?"false":"true";kb.slideshowClickTimeMs=this.akc;void 0!==window.performance.timing&&null!==window.performance.timing&&
(kb.slideshowClickTimePerformanceAPI=this.akc-window.performance.timing.navigationStart);xa.a.J(590976135,830,15,"SlideshowManager:startFromInternal - "+JSON.stringify(kb));this.jb.Sud(a,b,f,l,y,H,Q,Ua,this.akc);0<this.g_g&&(this.ded=window.setTimeout(Object(I.a)(this,this.jIk,"onStartSlideshowTimeoutHandler"),this.g_g));this.Ub&&this.Ub.instance&&this.Ub.instance.Tjd(a,b,c,f,l,y,H,w.AFrameworkApplication.gh,ia);this.Hc&&this.Hc.cfl();wa&&(this.Hc.Qh=!1);eb.a("PresenterCoachTabFix")&&this.jb.vvh()}Sxa(a,
b){if(b.key===B.a.mZ)xa.a.J(512495779,830,50,"SlideshowManager.OnSpecialKeyHandler Esc key"),this.dfa.execute(c=>{c.remove()}),this.jb.exit();else if(b.key===B.a.ORb)this.ia.Ka(ea.a.Jwd,2,null);else if(b.key===B.a.Yzd&&this.la.Tla&&this.Hc&&this.Hc.mEa&&this.Yo&&this.Sb&&!this.Yo.D4&&this.la.$4j&&this.Hc.EZf)try{this.Hc.Qh&&(pi.a.oK("PPTCaptionDiscoverabiltyDoNotShowAgain","true",pi.a.XJ)||xa.a.J(512495778,822,10,"SlideShowManager::OnSpecialKeyHandler - Failed to set cookie for discoverability opt out to true"));
this.Hc.Qh=!this.Hc.Qh;xa.a.J(512495777,830,50,"SlideshowManager.OnSpecialKeyHandler m_subtitleContext FUseSubtitles is changed to: {0}",this.Hc.Qh);const c=document.getElementById("buttonSubtitle");if(c){const l=c.getElementsByTagName("span")[0].getElementsByTagName("img")[0];l&&(l.className=this.Hc.Qh?"prt2_SubtitleSlideShowToggleHover_40x40x32":"prt2_SubtitleSlideShowToggleOff_40x40x32")}const f=!!this.Ub&&!!this.Ub.instance&&this.Ub.instance.kr;if(f)this.jb.toggleTranscriberUIVisibility(null);
else{let l=Date.now();this.jb.transcribe(w.AFrameworkApplication.userSessionId,this.Ya.podSessionId,this.Ya.Ek,w.AFrameworkApplication.gh,4,l,this.Yo)}this.dfa.execute(l=>{l.setToolbarButtonToggleState(fh.a.SubtitlesButton,this.Hc.Qh);l.dF(fh.a.CoachButton,!this.Hc.Qh&&!f)})}catch(c){xa.a.J(512495776,830,10,"SlideshowManager.OnSpecialKeyHandler Exception thrown when pressing the J key: {0}",c)}else if(b.key===B.a.Xxc&&this.Ub&&this.Ub.instance&&this.Ub.instance.mEa&&this.Ub.instance.Q1i&&this.Yo&&
!this.Yo.D4)try{if(this.Ub.instance.kr)this.Ub.instance.showWelcomeScreen();else{this.Ub.instance.Gda=!this.Hc.Qh;if(this.Hc.Swb&&!this.Hc.Qh){this.Hc.Qh=!0;let c=Date.now();this.jb.transcribe(w.AFrameworkApplication.userSessionId,this.Ya.podSessionId,this.Ya.Ek,w.AFrameworkApplication.gh,5,c,this.Yo);this.Hc.Qh=!1}this.Ub.instance.Duc(4,w.AFrameworkApplication.userSessionId,this.la.podsWebServiceBase,this.Ya.podSessionId,w.AFrameworkApplication.gh)}}catch(c){xa.a.J(512495775,830,10,"SlideshowManager.OnSpecialKeyHandler Exception thrown when pressing the L key: {0}",
c)}}gGk(a,b){b&&(a=b.slideIndex,a!==this.Wec&&(this.Wec=a,this.jb.zUa(a)))}w_a(){xa.a.J(512495774,830,15,"SlideshowManager.OnVisibilityChangeHandler: Full screen exited due to tab visibility change.");this.JAe=!0}SNk(a,b,c,f){xa.a.J(512495773,830,50,"SlideshowManager.PauseResumeMerge. correlationId: {0}",f);a=String.format("{0}PodHandler.ashx?action=LockUnlockSession&PodSID={1}&locked={2}",a,b,!0);b={WaitForSessionTimeoutMs:"0"};b["X-UserSessionId"]=c;b["X-CorrelationID"]=f;b["X-WacCluster"]=this.TBg;
this.Su.zj(a,2,null,b,!1,2,()=>{xa.a.J(512495772,830,15,"SlideshowManager.PauseResumeMerge: Pause/resume merge succeeded. isPaused: {0}, userSessionId: {1}, correlationId: {2} ",!0,c,f)},()=>{xa.a.J(512495771,830,10,"SlideshowManager.PauseResumeMerge: Pause/resume merge failed. isPaused: {0}, userSessionId: {1}, correlationId: {2} ",!0,c,f)},null,void 0,void 0,void 0,void 0,Lx.a("14"))}ija(a){this.xa.addHandler("OnExitSlideshow",a)}yga(a){this.xa.removeHandler("OnExitSlideshow",a)}KQa(a){this.xa.addHandler("OnPositionChangeEventId",
a)}dkb(a){this.xa.removeHandler("OnPositionChangeEventId",a)}Kgi(a){this.cFb||(this.cFb=a,hd.a.addHandler(window.document.body,"keydown",this.cFb))}yVe(){this.cFb&&(hd.a.removeHandler(window.document.body,"keydown",this.cFb),this.cFb=null)}Bmc(){if(this.nu.B9)xa.a.J(512495770,830,50,"SlideshowManager.OnFullscreenChangeHandler still in full screen");else{this.eKf();this.jb.EVe(Object(I.a)(this,this.w_a,"onVisibilityChangeHandler"));xa.a.J(512495769,830,50,"SlideshowManager.OnFullscreenChangeHandler: Leaving full screen mode.");
var a=w.AFrameworkApplication.fa.Ha(w.AFrameworkApplication.wK);a=!!a&&"teams"===a.toLowerCase();this.JAe||this.Fye||!document.hasFocus()||a||(xa.a.J(512495768,830,15,"SlideshowManager.OnFullscreenChangeHandler: Exiting SlideshowFrame"),this.dfa.execute(b=>{b.remove()}),this.jb.exit());this.JAe=!1}this.Fye=!1}Qjd(a,b){b&&this.Wec!==b.slideIndex&&(this.Wec=b.slideIndex,this.DIa.Thl(b))}koa(a,b){xa.a.J(512495767,830,15,"SlideshowManager.OnExitHandler Exiting SlideShow.");this.HKf();var c=["WACInnerFrame",
"WACStatusBarContainer","WACDebugPanelFrame","ClipboardTarget","application_AssertiveNotifier"];for(var f of c)(c=document.getElementById(f))&&Sys.UI.DomElement.removeCssClass(c,"SlideShowAXItemNavigationFocusTrap");this.Ndc="";this.bxa&&this.bxa.btc(!1);this.Bfd&&this.Bfd.btc(!1);this.Hc&&this.Hc.pcl();this.jb.yga(Object(I.a)(this,this.koa,"onExitHandler"));this.jb.Joh(Object(I.a)(this,this.VJa,"onFullscreenClickHandler"));this.jb.dpd(Object(I.a)(this,this.Bbh,"onSlideshowReadyHandler"));this.jb.Goh(Object(I.a)(this,
this.xid,"onErrorHandler"));this.jb.epd(Object(I.a)(this,this.Sxa,"onSpecialKeyHandler"));this.jb.EVe(Object(I.a)(this,this.w_a,"onVisibilityChangeHandler"));this.jb.AVe(Object(I.a)(this,this.zjd,"onPodSessionExpiredHandler"));this.jb.Loh(Object(I.a)(this,this.ajd,"onLogEndOfTranscriptionSessionHandler"));this.jb.Koh(Object(I.a)(this,this.$id,"onLiveSubtitlesDockedViewHandler"));this.jb.cph(Object(I.a)(this,this.rod,"recordQosErrorHandler"));this.yVe(Object(I.a)(this,this.Vid,"onKeydownHandler"));
(f=document.getElementById("startingSlideshowHiddenDiv"))&&f.parentNode.removeChild(f);this.la.allowDisablingSlideShowButtonDueToRehydration||(this.Bz.fkb(Object(I.a)(this,this.fga,"onPodSessionRefreshed")),this.Bz.Yoh(Object(I.a)(this,this.Ajd,"onPodSessionRefreshedFromBrowser")));this.la.BDh&&(at.a.DQb(!0),this.nu.B9||AG.a.X0a(w.AFrameworkApplication.isRtl));this.eKf();ht.exitFullscreen();this.vu.style.top=this.Zyg;this.la.ZVa&&(this.vu.style.width=this.$yg,this.vu.style.height=this.Yyg);this.Ur.yu();
this.xa.raiseEvent("OnExitSlideshow",b,a);this.Ub&&this.Ub.instance&&this.Ub.instance.VHk();this.Yo&&this.Yo.D4&&b.summary&&this.ia.Ka(ea.a.hMa,2,b.summary);w.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")&&this.DIa&&this.DIa.mfb&&this.ia.processAction(ea.a.OMc,2,null);this.Yo&&(this.Yo.D4=!1);this.la.pptEditorVoiceUXEnabled&&this.Xl&&this.Xl.instance&&this.Xl.instance.remove();this.la.pptEditorVoiceUXEnabled&&this.Xdd&&this.Xdd.remove();this.fIl()}fIl(){w.AFrameworkApplication.fa.ka("798")&&
Ib.a.instance.Ia("Common.ISystemInitiatedFeedback").execute(a=>{window.setTimeout(()=>{xa.a.J(512495766,830,15,"SlideshowManager.Trigger NPS after slideshow");a.logActivity("AppUsageTimeSatisfiedNPS",null)},1E3)})}VJa(){this.Fye=!0;this.nu.B9?ht.exitFullscreen():this.Eug()}Eug(){this.nu.Vac&&(this.nu.A_&&!this.EE&&(this.EE=Object(I.a)(this,this.Bmc,"onFullscreenChangeHandler"),$addHandler(this.vu,this.nu.A_,this.EE)),this.nu.requestFullscreen(this.vu),this.jb.zzf(Object(I.a)(this,this.w_a,"onVisibilityChangeHandler")))}Bbh(){this.HKf();
var a=["WACInnerFrame","WACStatusBarContainer","WACDebugPanelFrame","ClipboardTarget","application_AssertiveNotifier"];for(var b of a)(a=document.getElementById(b))&&Sys.UI.DomElement.addCssClass(a,"SlideShowAXItemNavigationFocusTrap");if(-1===this.Zdd)xa.a.J(508924039,830,10,"SlideshowManager.onSlideshowReadyHandler returning early since slideshowStartTimeMs is -1");else{b=Date.now();xa.a.J(23098073,830,15,"SlideshowManager.slideshow ready in {0} ms",b-this.Zdd);a={};a.SlideshowClickTimeMs=this.akc;
a.SlideshowStartTimeMs=this.Zdd;a.SlideshowStartFlushTimeMs=this.gGe;a.SlideshowFinishFlushTimeMs=this.fGe;a.SlideShowFinishedTimeMs=b;a.NoBlockingOutBoundSetting=this.la.Hqg;a.NoBlockingOutBound=!this.CDg;xa.a.J(512495765,830,15,"SlideshowManager.onSlideshowReadyHandler"+JSON.stringify(a));this.dfa.execute(()=>{this.la.tbc&&this.jb.getCurrentSlideDimensions()});!this.la.yg||!this.la.$gh&&this.la.tbc||this.Ifk.init(this.Hc,this.Yo);b=!!this.Ub&&!!this.Ub.instance&&this.Ub.instance.Er&&this.Ub.instance.lEa;
a=!!this.Ub&&!!this.Ub.instance&&(this.Ub.instance.gTa||this.Ub.instance.kr);if((this.la.Tla||this.la.Bcc)&&this.Hc&&this.Yo&&this.Sb&&(this.Hc.Qh||this.Yo.D4||b||a)&&this.Hc.EZf){const c=Date.now();let f=2;w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.ob.Qp&&(f=1);const l=this.Hc.Qh;b||a?(this.Hc.Qh||(f=5),this.Ub.instance.Gda=!this.Hc.Qh,this.Hc.Qh=!0):this.Ub&&this.Ub.instance&&(this.Ub.instance.Gda=!1);this.jb.transcribe(w.AFrameworkApplication.userSessionId,this.Ya.podSessionId,this.Ya.Ek,
w.AFrameworkApplication.gh,f,c,this.Yo);this.Hc.Qh=l}b&&(this.Ub.instance.lEa=!1);this.yVe(Object(I.a)(this,this.Vid,"onKeydownHandler"));this.jb.Pga(!1);this.jb.setOsfLocalStorage()}}Vid(a){27===a.keyCode&&(xa.a.J(512495764,830,50,"SlideshowManager.OnKeydownHandler: Esc"),this.yVe(Object(I.a)(this,this.Vid,"onKeydownHandler")),this.dfa.execute(b=>{b.remove()}),this.jb.exit())}ajd(a,b){a={};try{const c=ta.a.EL(b.Xx);for(const f of c)try{a[f]=b.Xx[f]}catch(l){xa.a.J(512495763,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when adding transcription session telemetry value for key: {0}, exception: {1}",
f,l)}}catch(c){xa.a.J(512495762,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when logging transcription telemetry. Exception: {0}",c)}xa.a.J(512495761,830,15,"SlideshowManager.onLogEndOfTranscriptionSessionHandler"+JSON.stringify(a));try{!(this.Yo&&this.Yo.D4||!this.la.QRk||this.ZDg)&&a.WebSocketConnectionDurationMS&&6E4<parseInt(a.WebSocketConnectionDurationMS.toString())&&(xa.a.J(512495760,830,50,"SlideshowManager.Floodgate survey triggered for transcription."),
this.ZDg=!0,this.mxa.continueWith(()=>{this.mxa.result.logActivity("TranscriptionUsed","PPTTranscriptionFloodgateSurveyEnabled")}))}catch(c){xa.a.J(512495759,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when trying to trigger floodgate survey. Exception: {0}",c)}}$id(a,b){this.la.tbc||((a=document.getElementById("slideshow-toolbar"))?b.pcc?"BelowSlide"===b.fw?(a.style.bottom="15%",a.style.left="8%"):"AboveSlide"===b.fw?(a.style.bottom="6px",a.style.left="8%"):(a.style.left=
"0%",a.style.bottom="6px",a.style.top="auto"):(a.style.left="0%",a.style.bottom="6px",a.style.top="auto"):xa.a.J(512495758,830,10,"SlideshowManager.OnLiveSubtitlesDockedViewHandler: Can't find pptViewerAnchor-Met or slideshow-toolbar"))}zjd(a,b){xa.a.J(512495757,830,15,"SlideshowManager.OnPodSessionExpiredHandler ErrorCode: {0}, Reason: {1}, request PodSessionId: {2}",b.code,b.reason,b.podSessionId);if(b.podSessionId!==this.Ya.podSessionId)xa.a.J(512495756,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Failing request PODS ID and m_sessionInfoOwner PODS ID do not match, so will return. m_sessionInfoOwner has a newer PODS ID: {0}, and this failing request is coming from an old PODS ID: {1}.",
this.Ya.podSessionId,b.podSessionId);else{if((a=this.la.slideShowErrorsThatTriggerRehydration)&&0<a.length&&a[0]){var c=new Date(this.RLg.getTime()+1E3*this.la.slideShowMinimumTimeBetweenRehydrationAttemptsInSec);const f=new Date,l=f>c;xa.a.J(512495755,830,15,"SlideshowManager.OnPodSessionExpiredHandler: currentTime: {0} time after which rehydration is allowed: {1} canTriggerRehydration: {2}",f,c,l);if(l)for(c=0;c<a.length;c++){if(a[c]===b.code.toString()&&(xa.a.J(512495754,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Error from Slideshow: {0}",
b.code),this.Ud.Ds(Object.assign(new Hj.a,{Code:223,Source:4}),b.podSessionId),0<this.KHe)){xa.a.J(512495753,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Triggered rehydration and will wait for {0} ms before calling the timeout handler.",this.KHe);this.RLg=new Date;this.DLg=b.podSessionId;this.ufd=window.setTimeout(Object(I.a)(this,this.Z4k,"rehydrationTimeout"),this.KHe);return}}else if(this.DLg===b.podSessionId){xa.a.J(512495752,830,15,"SlideshowManager.OnPodSessionExpiredHandler: A request to rehydrate the session based on the pod session id: {0} has already been sent. Wait for rehydration to complete.",
b.podSessionId);return}}w.AFrameworkApplication.Oo($e.a.Oh(359));$d.Health.instance.recordQosError("SlideShowPodSessionExpiredFailure",["SlideShowACE"],!1,!1,!0,!1,null);this.la.podExitSlideshowOnError&&(xa.a.J(512495751,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Will exit slideshow. Error from Slideshow: {0}",b.code),this.dfa.execute(f=>{f.remove()}),this.jb.exit())}}xid(a,b){a=String.format("Category: {0}, Code: {1}, SessionId: {2}, CorrelationId: {3}, Message: {4}, ExtraInfo: {5}, IsApiError: {6}",
b.category,b.code,b.sessionId,b.correlationId,b.message,b.py,b.HSj.toString());xa.a.J(512495750,830,10,"SlideshowManager.OnErrorHandler: Error from Slideshow: {0}",a);w.AFrameworkApplication.Oo($e.a.Oh(359));$d.Health.instance.recordQosError("SlideShowFailure",["SlideShowACE"],!1,!0,!0,!0,null);this.la.podExitSlideshowOnError&&(xa.a.J(512495749,830,10,"SlideshowManager.OnErrorHandler: Will exit slideshow. Error from Slideshow: {0}",b.code),this.dfa.execute(c=>{c.remove()}),this.jb.exit())}eKf(){this.EE&&
(xa.a.J(512495748,830,50,"SlideshowManager.CleanupFullscreenChangeHandler"),$removeHandler(this.vu,this.nu.A_,this.EE),this.EE=null)}jIk(){xa.a.J(512495747,830,15,"SlideshowManager.OnStartSlideshowTimeoutHandler");w.AFrameworkApplication.Oo($e.a.Oh(360));$d.Health.instance.recordQosError("SlideShowTimeout",["SlideShowACE"],!1,!0,!0,!0,null);this.dfa.execute(a=>{a.remove()});this.jb.exit()}Z4k(){xa.a.J(512495746,830,15,"SlideshowManager.RehydrationTimeout");w.AFrameworkApplication.Oo($e.a.Oh(371));
$d.Health.instance.recordQosError("SlideShowWaitForRehydrationTimedOut",["SlideShowACE"],!1,!0,!0,!0,null);this.dfa.execute(a=>{a.remove()});this.jb.exit()}rod(a,b){a=0<b.durationMs?Object.assign(new Mj.a,{durationMs:b.durationMs}):null;$d.Health.instance.recordQosError(b.errorName,[b.vetoName],b.isIntentional,b.isInternal,b.alertOnPillar,b.isSessionEndingError,a)}fga(a,b){xa.a.J(512495745,830,15,"SlideshowManager.OnPodSessionRefreshed: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",
this.la.allowDisablingSlideShowButtonDueToRehydration);this.Ieb=!1;this.LKf();this.mcc()||"Legacy"!=this.jb.f9()?(xa.a.J(512495715,830,15,"SlideshowManager.OnPodSessionRefreshed: Refreshing PodSession. PodSessionId:{0}, WacCluster:{1}",b.qY,this.Ya.Ek),this.jb.refreshPodSession(b.qY,this.Ya.Ek)):xa.a.J(512495744,830,15,"SlideshowManager.OnPodSessionRefreshed: Skip updating due to not active.")}Ajd(a,b){xa.a.J(512495714,830,15,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",
this.la.allowDisablingSlideShowButtonDueToRehydration);this.Ieb=!1;this.LKf();this.mcc()||"Legacy"!=this.jb.f9()?(xa.a.J(512495712,830,15,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Refreshing PodSession. PodSessionId:{0}, WacCluster:{1}",b.qY,this.Ya.Ek),this.jb.refreshPodSession(b.qY,this.Ya.Ek)):xa.a.J(512495713,830,15,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Skip updating due to not active.")}Mo(){this.Ieb=!1;xa.a.J(512495711,830,15,"SlideshowManager.OnSessionRehydrated: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",
this.la.allowDisablingSlideShowButtonDueToRehydration)}WE(){this.Ieb=!0;xa.a.J(512495710,830,15,"SlideshowManager.OnSessionEnd: Disabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.la.allowDisablingSlideShowButtonDueToRehydration)}cJb(){this.Ieb=!0;xa.a.J(512495709,830,15,"SlideshowManager.OnPodSessionUnavailable: Disabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.la.allowDisablingSlideShowButtonDueToRehydration)}HKf(){-1!==
this.ded&&(window.clearTimeout(this.ded),this.ded=-1)}LKf(){-1!==this.ufd&&(window.clearTimeout(this.ufd),this.ufd=-1)}}Object(m.a)(bK,"SlideshowManager",null,[445]);class jD{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua){this.owa=this.igc=this.Wgb=this.QDb=this.oeb=this.yXa=this.FFb=this.lGb=this.Yo=this.Hc=this.qe=null;this.lgc=0;this.sM=!1;this.EE=null;this.jb=c;this.ke=f;this.EHe=l;this.tf=H;this.pu=Q;this.Ya=wa;this.nu=Ua;this.ia=a;this.Ea=b;this.yCe=null;this.fEe=ia;this.Ub=y}init(a,b){this.qe=document.createElement("div");
this.qe.id="slideshow-toolbar";this.qe.className="SlideshowToolbar";this.tf.appendChild(this.qe);this.Hc=a;this.Yo=b;this.pu()?(this.lGb=this.Lsa("buttonPrevSlide","navigationButton navigationButtonRtl","SlideShowNextServer",ResourceStrings.L_Next),this.FFb=this.Lsa("buttonNextSlide","navigationButton navigationButtonRtl","SlideShowPrevServer",ResourceStrings.L_Previous)):(this.lGb=this.Lsa("buttonPrevSlide","navigationButton navigationButtonLtr","SlideShowPrevServer",ResourceStrings.L_Previous),
this.FFb=this.Lsa("buttonNextSlide","navigationButton navigationButtonLtr","SlideShowNextServer",ResourceStrings.L_Next));this.qe.appendChild(this.lGb);this.qe.appendChild(this.FFb);hd.a.addHandler(this.lGb,oa.a.click,Object(I.a)(this,this.dJb,"onPrevClickHandler"));hd.a.addHandler(this.FFb,oa.a.click,Object(I.a)(this,this.ZIb,"onNextClickHandler"));this.igc=this.Lsa("buttonEnterGridView","navigationButton navigationButtonLtr","GridView",ResourceStrings.L_GridView_SeeAllSlides);this.qe.appendChild(this.igc);
hd.a.addHandler(this.igc,oa.a.click,Object(I.a)(this,this.UIb,"onGridViewClickHandler"));this.oeb=this.yXa=null;this.nu.XHf&&(this.yXa=this.Lsa("buttonEnterFullscreen","navigationButton navigationButtonLtr","SlideShowFullscreen",ResourceStrings.L_EnterFullscreen),this.oeb=this.Lsa("buttonExitFullscreen","navigationButton navigationButtonLtr","SlideShowBackToWindow",ResourceStrings.L_ExitFullscreen),a=this.nu.B9,this.yXa.style.display=a?wf.a.Pe:wf.a.Rj,this.oeb.style.display=a?wf.a.Rj:wf.a.Pe,this.qe.appendChild(this.yXa),
this.qe.appendChild(this.oeb),hd.a.addHandler(this.yXa,oa.a.click,Object(I.a)(this,this.VJa,"onFullscreenClickHandler")),hd.a.addHandler(this.oeb,oa.a.click,Object(I.a)(this,this.VJa,"onFullscreenClickHandler")),this.nu.A_&&!this.EE&&(this.EE=Object(I.a)(this,this.Bmc,"onFullscreenChangeHandler"),$addHandler(this.tf,this.nu.A_,this.EE)));this.Wgb=null;this.Hc.Swb&&!this.Yo.D4&&(this.Wgb=this.Lsa("buttonSubtitle","navigationButton navigationButtonLtr","SubtitleSlideShowToggleOff",ResourceStrings.L_UseSubtitles),
this.qe.appendChild(this.Wgb),hd.a.addHandler(this.Wgb,oa.a.click,Object(I.a)(this,this.gkd,"onTranscribeHandler")));this.QDb=this.Lsa("buttonExitSlideShow","navigationButton navigationButtonLtr","ExitSlideShowServer",ResourceStrings.L_EndShow);this.qe.appendChild(this.QDb);hd.a.addHandler(this.QDb,oa.a.click,Object(I.a)(this,this.TIb,"onExitClickHandler"));this.owa=null;this.Ub&&this.Ub.instance&&this.Ub.instance.Er&&!this.Yo.D4&&(this.Ub.instance.uzf(Object(I.a)(this,this.Kmc,"onLiveSessionStarted")),
this.Ub.instance.szf(Object(I.a)(this,this.Jmc,"onLiveSessionEnded")),this.Ub.instance.hgi(Object(I.a)(this,this.n$g,"onLiveCalloutDismissed")),this.Ub.instance.qzf(Object(I.a)(this,this.Imc,"onLiveRelaunchPausedSession")),this.Ub.instance.b$a?this.qPf():this.Ub.instance.bhi(Object(I.a)(this,this.p$g,"onLivePresenterResourcesLoaded")));this.sM=!1;this.hide();this.jb.ija(Object(I.a)(this,this.koa,"onExitHandler"));this.jb.fTd(Object(I.a)(this,this.cib,"onBrowserEventHandler"));hd.a.addHandler(this.qe,
oa.a.qq,Object(I.a)(this,this.lib,"onMouseOverHandler"));hd.a.addHandler(this.qe,oa.a.Vs,Object(I.a)(this,this.Mmc,"onMouseOutHandler"))}show(){this.qe.style.display=wf.a.Rj;window.clearTimeout(this.lgc);this.lgc=window.setTimeout(Object(I.a)(this,this.hide,"hide"),3E3);this.jb.Pga(!0)}hide(){this.sM||(window.clearTimeout(this.lgc),this.qe.style.display=wf.a.Pe,this.jb.Pga(!1))}remove(){this.qe&&this.tf.contains(this.qe)&&(this.tf.removeChild(this.qe),this.Ub&&this.Ub.instance&&this.Ub.instance.Er&&
(this.Ub.instance.Roh(Object(I.a)(this,this.Kmc,"onLiveSessionStarted")),this.Ub.instance.Qoh(Object(I.a)(this,this.Jmc,"onLiveSessionEnded")),this.Ub.instance.N7k(Object(I.a)(this,this.n$g,"onLiveCalloutDismissed")),this.Ub.instance.r8k(Object(I.a)(this,this.p$g,"onLivePresenterResourcesLoaded")),this.Ub.instance.Ooh(Object(I.a)(this,this.Imc,"onLiveRelaunchPausedSession"))),this.sM=!1)}dF(){}setToolbarButtonToggleState(){}koa(){this.jb.yga(Object(I.a)(this,this.koa,"onExitHandler"));this.jb.uVe(Object(I.a)(this,
this.cib,"onBrowserEventHandler"));hd.a.removeHandler(this.qe,oa.a.qq,Object(I.a)(this,this.lib,"onMouseOverHandler"));hd.a.removeHandler(this.qe,oa.a.Vs,Object(I.a)(this,this.Mmc,"onMouseOutHandler"));hd.a.removeHandler(this.lGb,oa.a.click,Object(I.a)(this,this.dJb,"onPrevClickHandler"));hd.a.removeHandler(this.FFb,oa.a.click,Object(I.a)(this,this.ZIb,"onNextClickHandler"));hd.a.removeHandler(this.QDb,oa.a.click,Object(I.a)(this,this.TIb,"onExitClickHandler"));this.owa&&hd.a.removeHandler(this.owa,
oa.a.click,Object(I.a)(this,this.m$g,"onLiveBroadcastHandler"));this.Wgb&&hd.a.removeHandler(this.Wgb,oa.a.click,Object(I.a)(this,this.gkd,"onTranscribeHandler"));this.yXa&&(hd.a.removeHandler(this.yXa,oa.a.click,Object(I.a)(this,this.VJa,"onFullscreenClickHandler")),hd.a.removeHandler(this.oeb,oa.a.click,Object(I.a)(this,this.VJa,"onFullscreenClickHandler")),$removeHandler(this.tf,this.nu.A_,this.EE),this.EE=null);this.igc&&hd.a.removeHandler(this.igc,oa.a.click,Object(I.a)(this,this.UIb,"onGridViewClickHandler"));
this.remove()}cib(){this.show()}Bmc(){const a=this.nu.B9;this.yXa.style.display=a?wf.a.Pe:wf.a.Rj;this.oeb.style.display=a?wf.a.Rj:wf.a.Pe}lib(a){if(a=a.target)a.className.startsWith("prt2_SubtitleSlideShowToggle")?a.className.startsWith("prt2_SubtitleSlideShowToggleOff_40x40x32")&&(a.className=a.className.replace("Off_40x40x32","Hover_40x40x32")):a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle")?a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle_40x40x32")&&(a.className=
a.className.replace("_40x40x32","Hover_40x40x32")):a.className=a.className.replace("_40x40x32","Hvr_40x40x32"),this.sM=!0}Mmc(a){if(a=a.target)a.className.startsWith("prt2_SubtitleSlideShowToggle")?!this.Hc.Qh&&a.className.startsWith("prt2_SubtitleSlideShowToggleHover_40x40x32")&&(a.className=a.className.replace("Hover_40x40x32","Off_40x40x32")):a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle")?this.Ub&&!this.Ub.instance.kr&&a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggleHover_40x40x32")&&
(a.className=a.className.replace("Hover_40x40x32","_40x40x32")):a.className=a.className.replace("Hvr_40x40x32","_40x40x32"),this.x6d()||(this.sM=!1);this.x6d()||this.jb.restoreFocus()}dJb(){xa.a.J(23954837,830,50,"SlideshowToolbar.OnPrevClickHandler");this.J2a(this.lGb.title);this.jb.prev();this.jb.restoreFocus()}ZIb(){xa.a.J(23954839,830,50,"SlideshowToolbar.OnNextClickHandler");this.J2a(this.FFb.title);this.jb.next();this.jb.restoreFocus()}TIb(){xa.a.J(23954841,830,50,"SlideshowToolbar.OnExitClickHandler");
this.J2a(this.QDb.title);this.jb.exit()}VJa(){xa.a.J(40449118,830,50,"SlideshowToolbar.OnFullscreenClickHandler");this.jb.G6e()}m$g(){this.Ub&&this.Ub.instance&&(this.J2a(this.owa.title),xa.a.J(41231116,830,50,"FLiveBroadcastInUse is changed to: {0}",this.Ub.instance.kr),this.Ub.instance.kr?(this.jb.pausePresentation(),this.Ub.instance.showCallout(this.owa)):(this.Ub.instance.Duc(3,w.AFrameworkApplication.userSessionId,this.fEe,this.Ya.podSessionId,w.AFrameworkApplication.gh),this.Ub.instance.Gda=
!this.Hc.Qh,this.Hc.Swb&&!this.Hc.Qh&&(xa.a.J(41682897,830,50,"Starting subtitle in OnLiveBroadcastHandler for starting live session."),this.Hc.Qh=!0,this.jb.transcribe(w.AFrameworkApplication.userSessionId,this.Ya.podSessionId,this.Ya.Ek,w.AFrameworkApplication.gh,5,Date.now(),this.Yo),this.Hc.Qh=!1)),this.o9e())}J6e(a,b){this.J2a(this.Wgb.title);const c=!!this.Ub&&!!this.Ub.instance&&this.Ub.instance.kr,f=this.Hc.CZf&&5!==a&&!c;5!==a&&(this.Hc.Qh=!this.Hc.Qh);xa.a.J(39682065,830,50,"SlideshowToolbar.ToggleTranscriber m_subtitleContext FUseSubtitles is changed to: {0}",
this.Hc.Qh);b&&(this.Hc.Qh?(b.className="prt2_SubtitleSlideShowToggleHover_40x40x32",f&&yz.Aug(this.jb,this.ke,this.Ya)):b.className="prt2_SubtitleSlideShowToggleOff_40x40x32");f||(b=Date.now(),c?this.jb.toggleTranscriberUIVisibility(null):this.jb.transcribe(w.AFrameworkApplication.userSessionId,this.Ya.podSessionId,this.Ya.Ek,w.AFrameworkApplication.gh,a,b,this.Yo))}gkd(a){this.J6e(3,a.target)}UIb(){xa.a.J(595204312,830,50,"SlideshowToolbar.OnGridViewClickHandler");this.ia.Ka(ea.a.HOb,2,null)}qPf(){this.owa||
(this.owa=this.Lsa("buttonLiveBroadcast","navigationButton navigationButtonLtr","PresentLiveSlideshowToolbarToggle",ResourceStrings.L_UseLiveBroadcast),this.qe.insertBefore(this.owa,this.QDb),hd.a.addHandler(this.owa,oa.a.click,Object(I.a)(this,this.m$g,"onLiveBroadcastHandler")))}Lsa(a,b,c,f){const l=document.createElement("div");l.id=a;l.className=b;if("buttonSubtitle"===a)return a=He.createClusteredImageFromCluster(40,40,"SubtitleSlideShowToggle"+(this.Hc.Qh?"Hover_40x40x32":"Off_40x40x32"),"prt2",
this.ke.qk("prt2.png"),null,null,!0,null),l.appendChild(a),l.title=f,l;if("buttonLiveBroadcast"===a)return a=He.createClusteredImageFromCluster(40,40,"PresentLiveSlideshowToolbarToggle"+(this.Ub&&this.Ub.instance&&this.Ub.instance.kr?"Hover_40x40x32":"_40x40x32"),"prt2",this.ke.qk("prt2.png"),null,null,!0,null),l.appendChild(a),l.title=f,1===a.children.length&&(this.yCe=a.children[0]),l;a=He.createClusteredImageFromCluster(40,40,c+"_40x40x32","prt2",this.ke.qk("prt2.png"),null,null,!0,null);l.appendChild(a);
l.title=f;return l}J2a(a){ma.a.Xa(a)?xa.a.J(23396621,830,15,"SlideshowToolbar::RaiseSlideshowNavigationToolbarClickedEvent, Toolbar title is null"):this.EHe.Rkh(new Kx(a))}x6d(){return!!this.Ub&&!!this.Ub.instance&&this.Ub.instance.f2i}o9e(){this.Ub&&this.Ub.instance&&this.yCe&&(this.yCe.className="prt2_PresentLiveSlideshowToolbarToggle"+(this.Ub.instance.kr?"Hover_40x40x32":"_40x40x32"))}p$g(){this.qPf()}Kmc(){this.o9e()}Jmc(){this.Ub&&this.Ub.instance&&this.Ub.instance.Gda&&!this.Hc.Qh&&(xa.a.J(41682899,
830,50,"Stopping subtitle for stopping live session."),this.jb.transcribe(w.AFrameworkApplication.userSessionId,this.Ya.podSessionId,this.Ya.Ek,w.AFrameworkApplication.gh,5,Date.now(),this.Yo));this.Ub.instance.Gda=!1;this.o9e()}Imc(){this.Ub&&this.Ub.instance&&(this.sM=!0,this.show(),this.jb.pausePresentation(),this.Ub.instance.showCallout(this.owa))}n$g(){this.sM=this.x6d();this.sM||(window.clearTimeout(this.lgc),this.lgc=window.setTimeout(Object(I.a)(this,this.hide,"hide"),3E3))}}Object(m.a)(jD,
"SlideshowToolbar",null,[583,584]);class uu{constructor(a){this.hEb=this.c1=this.FHb=null;this.AGe="BelowSlide";this.qeb=this.cDg=!1;this.Nfc=!0;this.j8c=-1;this.ADg=this.Afc=this.Cye=!1;this.zEe=this.CGe=this.EGe=this.DGe=null;this.la=a;w.AFrameworkApplication.fa.ff(Object(I.a)(this,this.en,"onFullAppSettingsReady"));a=De.b(w.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());this.ryg=a.Ring||"Unknown";this.Pyg=w.AFrameworkApplication.buildVersion||"Unknown";this.eMg=this.la.uKa||
"Unknown";this.R1g=a.Host||"Unknown";this.Q1g=a.WACDatacenter||"Unknown";this.$Zg=this.jfj();this.Dkc=this.mfj();this.T0g=this.LXc();this.XDb=uu.Z9e;switch(this.la.IHl){case "ByUIHostName":a=w.AFrameworkApplication.fa.Ha(w.AFrameworkApplication.wK);this.qeb=!(!a||"teams"!==a.toLowerCase());break;case "ByAppIsEmmbeded":this.qeb=w.AFrameworkApplication.isEmbedded;break;default:this.qeb=w.AFrameworkApplication.fa.ka("IsUIEmbedMode")}xa.a.J(40977669,822,50,"Initialized SubtitleContext with cookie: {0}, default position:{1}",
this.XDb,this.AGe)}en(){this.FHb=this.getUserId();this.c1=w.AFrameworkApplication.fa.Ha("TenantId");this.hEb=this.la.hostAuthType||w.AFrameworkApplication.fa.Ha("HostAuthType")||"Unknown"}getUserId(){let a=w.AFrameworkApplication.fa.Ha("PptEditingUserId");ma.a.Xa(a)&&(a=w.AFrameworkApplication.fa.Ha("LoggableUserId"),xa.a.J(593793674,822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",ma.a.Xa(a)));return a}get M5b(){return this.cDg}set M5b(a){xa.a.J(40407360,830,50,"SubtitleContext: Update FEnabledInBaseDoc to {0}",
a);this.cDg=a}get Qh(){return this.la.Tla&&this.M5b&&this.XDb&&!this.qeb}set Qh(a){this.XDb!==a&&(this.XDb=a,uu.Z9e=this.XDb)}get L5b(){return this.la.Tla&&this.Afc}set L5b(a){this.Afc!==a&&(this.Afc=a)}get XZf(){return this.ADg}get EZf(){return!this.qeb}get Ywb(){return this.Cye}set Ywb(a){this.Cye!==a&&(this.Cye=a)}get Swb(){return this.la.Tla&&this.M5b&&this.la.X4j&&!this.qeb}get CZf(){const a=pi.a.get("PPTLiveSubtitleEnabled");return this.la.Tla&&this.la.b5j&&ma.a.Xa(a)&&!this.qeb}get x4e(){if(!this.CGe){const b=
new Na.a;var a=this.la.Pgh;if(!ma.a.Xa(a)){a=a.split(",");for(const c of a)c.endsWith("*")||b.add(c)}this.CGe=uu.MAf(b)}return this.CGe}get w4e(){if(!this.zEe){const b=new Na.a;var a=this.la.Pgh;if(!ma.a.Xa(a)){a=a.split(",");for(const c of a)c.endsWith("*")&&b.add(c.replace("*"," ").trim())}this.zEe=uu.MAf(b)}return this.zEe}get vPb(){this.DGe||(this.DGe=ma.a.Xa(this.la.Qgh)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(this.la.Qgh,!0));return this.DGe}get h3e(){this.EGe||(this.EGe=uu.Eki(this.vPb));
return this.EGe}cfl(){this.j8c=this.XDb?1:0}pcl(){-1!==this.j8c&&(this.Qh=1===this.j8c?!0:!1,this.j8c=-1)}jfj(){try{const a=bb.a.He(w.AFrameworkApplication.lcid);if(!a)return xa.a.J(41158484,822,15,"SubtitleContext::GetDefaultSpeechLanguage Getting the culture info returned null. Language lcid: {0}: ",w.AFrameworkApplication.lcid),"en-us";const b=a.name.toLowerCase();for(let c of this.x4e)if(0<=c.toLowerCase().indexOf(b.toLowerCase()))return b;for(let c of this.w4e)if(0<=c.toLowerCase().indexOf(b.toLowerCase()))return b;
this.Afc=!0;return"en-us"}catch(a){xa.a.J(41158486,822,10,"SubtitleContext::GetDefaultSpeechLanguage Exception thrown when trying to get the culture info for language lcid: {0}, exception: {1}.",w.AFrameworkApplication.lcid,a)}this.Afc=!0;return"en-us"}mfj(){try{const a=bb.a.He(w.AFrameworkApplication.lcid);if(!a||ma.a.Xa(a.name))return xa.a.J(41158488,822,15,"SubtitleContext::GetDefaultTranslationLanguage Getting the culture info or culture info name returned null. Language lcid: {0}: ",w.AFrameworkApplication.lcid),
"en";const b=a.name.toLowerCase();if(!ma.a.Xa(b)&&this.vPb[b])return b;const c=bb.a.He(a.languageId);if(!c||ma.a.Xa(c.name))return xa.a.J(41158490,822,15,"SubtitleContext::GetDefaultTranslationLanguage Getting the two-letter culture info returned null. Language lcid: {0}: ",w.AFrameworkApplication.lcid),"en";let f=c.name.toLowerCase();this.vPb[f]||(xa.a.J(41972259,822,15,"SubtitleContext::GetDefaultTranslationLanguage No matching default language was found for the user's locale. Will default to English. User's culture info name: {0} User's culture info two letter name: {1} Language lcid: {2}: ",
b,f,w.AFrameworkApplication.lcid),f="en");return f}catch(a){xa.a.J(41158492,822,10,"SubtitleContext::GetDefaultTranslationLanguage Exception thrown when trying to get the culture info for language lcid: {0}, exception: {1}.",w.AFrameworkApplication.lcid,a)}return"en"}LXc(){try{if(ma.a.Xa(this.Dkc))return xa.a.J(41972290,822,10,"SubtitleContext::GetValueForTranslationLanguage m_translationLanguages is null. Language lcid: {0}",w.AFrameworkApplication.lcid),"en-us";const a=this.vPb[this.Dkc.toLowerCase()];
if(!ma.a.Xa(a))return a}catch(a){xa.a.J(41972292,822,10,"SubtitleContext::GetValueForTranslationLanguage Exception thrown when trying to get the value for key: {0} language lcid: {1}, exception: {2}.",this.Dkc,w.AFrameworkApplication.lcid,a)}return"en-us"}ycj(a){if(ma.a.Xa(a))return xa.a.J(595140824,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage Null or empty speech language code passed in."),null;var b=a.split("-");if(!b.length)return xa.a.J(595140822,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage Incorrect speech language code passed in: {0}.",
a),null;b=b[0];const c=this.vPb;var f=this.h3e;for(let l of f)if(f=c[l.toLowerCase()],f.startsWith(b))return f;xa.a.J(595140820,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage No matching translation language code found for speech language code: {0}.",a);return null}get Fpa(){return this.$Zg}set Fpa(a){this.$Zg=a;this.ADg=!0}get userId(){return this.FHb}set userId(a){this.FHb=a}get locale(){return this.eMg}set locale(a){this.eMg=a}get audienceGroup(){return this.ryg}set audienceGroup(a){this.ryg=
a}get buildVersion(){return this.Pyg}set buildVersion(a){this.Pyg=a}get identityProvider(){return this.hEb}set identityProvider(a){this.hEb=a}get wacHost(){return this.R1g}set wacHost(a){this.R1g=a}get wacDatacenter(){return this.Q1g}set wacDatacenter(a){this.Q1g=a}get tenantId(){return this.c1}set tenantId(a){this.c1=a}get bAa(){return this.Dkc}set bAa(a){this.Dkc=a}get anb(){return this.T0g}set anb(a){this.T0g=a}get fw(){return this.AGe}set fw(a){this.AGe=a}get pCl(){const a={};a.UserId=this.userId;
a.TenantId=this.tenantId;a.AudienceGroup=this.audienceGroup;a.BuildVersion=this.buildVersion;a.IdentityProvider=this.identityProvider;a.Locale=this.locale;a.WacHost=this.wacHost;a.WacDatacenter=this.wacDatacenter;a.SubtitlesPosition=this.fw;a.SpeechLanguage=this.Fpa;a.TranslationLanguages=this.anb;a.FUseSubtitles=this.Qh;return JSON.stringify(a)}get mEa(){return this.Nfc}set mEa(a){this.Nfc=a}get Y1i(){return 0<=this.la.pptEditorTranscribeRTLTranslationLanguages.indexOf(this.bAa)}static get Z9e(){const a=
pi.a.get("PPTLiveSubtitleEnabled");return a?"true"===a.toLowerCase():!1}static set Z9e(a){pi.a.oK("PPTLiveSubtitleEnabled",a.toString(),pi.a.XJ)||xa.a.J(40977672,822,10,"Failed to set cookie for use live subtitle to {0}",a.toString())}static MAf(a){const b={},c=new Na.a;for(let f of a)try{const l=bb.a.He(f).displayName;c.add(l);b[l]=f}catch(l){xa.a.J(40423770,822,10,"SubtitleContext::AlphabetizeSpokenLanguagesByLocale Exception when trying to show language: {0}, e: {1}.",f,l)}c.Sc((f,l)=>f.localeCompare(l));
a=new Na.a;for(let f of c)f&&0<f.length&&a.add(b[f]);return a}static Eki(a){const b=ta.a.EL(a);a={};const c=new Na.a;for(var f of b)try{const l=bb.a.He(f).displayName;ma.a.Xa(l)?xa.a.J(41972252,822,10,"SubtitleContext::AlphabetizeSubtitleLanguagesByLocale Couldn't get display name for language code: {0}, language lcid: {1}.",f,w.AFrameworkApplication.lcid):(c.add(l),a[l]=f)}catch(l){xa.a.J(40423772,822,10,"SubtitleContext::AlphabetizeSubtitleLanguagesByLocale Exception when trying to show language: {0}, e: {1}.",
f,l)}c.Sc((l,y)=>l.localeCompare(y));f=new Na.a;for(let l of c)l&&0<l.length&&f.add(a[l]);return f}}Object(m.a)(uu,"SubtitleContext",null,[440]);const kD=()=>{var a=window.navigator.userAgent.toLowerCase();(a=-1!==a.indexOf("windows nt 6.3")&&-1!==a.indexOf("rv:11.0"))||(a=window.navigator.userAgent.toLowerCase(),-1!==a.indexOf("windows")?(a=cK(a,"msie (\\d+)"),a=!isNaN(a)&&10>=a):a=!1);a||(a=window.navigator.userAgent.toLowerCase(),-1!==a.indexOf("iphone")||-1!==a.indexOf("ipad")||-1!==a.indexOf("ipod")?
(a=cK(a,"os (\\d+)_"),a=!isNaN(a)&&9>=a):a=!1);if(a||-1!==window.navigator.userAgent.indexOf("Windows NT 6.3; ARM"))return!1;try{const b=document.createElement("canvas");if(window.self.WebGLRenderingContext&&(b.getContext("webgl")||b.getContext("experimental-webgl")))return!0}catch(b){}return!1},cK=(a,b)=>(a=(new RegExp(b)).exec(a))&&2<=a.length?parseInt(a[1]):Number.NaN;class dK{constructor(a){this.Wo=a}Yqi(){return kD()}Xqi(){let a=!1;const b=this.Yqi();if(b&&!this.Wo.oO(1))try{const c=document.createElement("canvas"),
f=c.getContext("2d");if(f){const l=new Image;l.src="data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg'%3E%3C/svg%3E";f.drawImage(l,0,0,10,10);c.toDataURL("image/png");a=!0}}catch(c){}xa.a.J(33595541,830,50,"IsRenderingSVGInWebGLSupported - {0}",{["Browser"]:this.Wo.iz,["SupportWebGL"]:b,["SupportSVGInWebGL"]:a});return a}}Object(m.a)(dK,"WebGLHelperProxy",null,[439]);var eK=d(652),hR=d(742);class lD{constructor(){this.la=this.nb=this.K=null}get name(){return"PowerPointWebEditor.SlideShow"}Yb(a){this.K=
a;const b=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.nb=b.SF();this.la=this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.K.register(438,"PowerPointWebEditor.IFullscreenHelper").ma().oa(()=>new UJ);this.K.register(439,"PowerPointWebEditor.IWebGLHelper").ma().oa(()=>new dK(this.K.resolve("Common.IBrowserUtils")));this.K.register(440,"PowerPointWebEditor.ISubtitleContext").ma().oa(()=>new uu(this.la));this.K.register(441,"PowerPointWebEditor.IRehearsalContext").ma().oa(()=>
new xz);this.Bdc({["Type"]:"CheckBrowserStart"});a={};var c=this.GTj(a);const f=kD()&&this.la.fWa&&c&&this.FTj(),l=this.la.fWa&&this.ETj(),y=!f&&l;this.Bdc({["Type"]:"CheckBrowserEnd",["IsSupportedBrowser"]:f||l,["IsModernWebGLSupportedBrowser"]:f,["IsModernSupportedBrowser"]:l,["IsBrowserShapeBuilderCompatible"]:c,["log"]:a,["useSvg"]:y});if(this.la.ka("DefaultToModernSlideShow")&&(f||l)){this.K.register(442,"PowerPointWebEditor.ISlideshowFrame").ma().oa(()=>new hR.SlideShowCoreFrame(this.nb,this.la,
this.K.resolve("PowerPointWebEditor.ISubtitleContext"),this.K.resolve("Common.IDynamicScriptLoaderProvider").rI,this.K.Ia("PowerPointWebEditor.ISlideShowVoiceNotification"),this.K.Ia("PowerPointLive.ILivePresenter"),this.K.resolve("PowerPointWebEditor.IFullscreenHelper"),this.K.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),y,this.K.resolve("PowerPoint.IPathManager"),this.K.Ia("Common.App.HostNotification.EditNotificationEventSource"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),
this.K.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,w.AFrameworkApplication.Me));const wa={};wa.loadScriptStart=Date.now();a=dD.a.create(w.AFrameworkApplication.lj("powerpoint-slideshow-strings",3));$k.a.oy(a);Promise.all([new Promise((Ua,kb)=>{const Gb=document.createElement("script");Gb.async=!1;Gb.src=w.AFrameworkApplication.lj(String.format("slideshowcore{0}.js",".min"),5);Gb.addEventListener("load",()=>{xa.a.J(509636759,830,50,"PPTWebEditorSlideShowPackage::Loaded slideshowcore");
Ua(Gb)});Gb.addEventListener("error",()=>{xa.a.J(509636758,830,10,"PPTWebEditorSlideShowPackage::Failed to load slideshowcore");kb(Gb)});document.head.appendChild(Gb)}),new Promise((Ua,kb)=>{const Gb=document.createElement("script");Gb.async=!1;Gb.src=w.AFrameworkApplication.lj(String.format("podsproxy{0}.js",".min"),5);Gb.addEventListener("load",()=>{xa.a.J(509636757,830,50,"PPTWebEditorSlideShowPackage::Loaded podsproxy");Ua(Gb)});Gb.addEventListener("error",()=>{xa.a.J(509636756,830,10,"PPTWebEditorSlideShowPackage::Failed to load podsproxy");
kb(Gb)});document.head.appendChild(Gb)}),new Promise((Ua,kb)=>{const Gb=document.createElement("script");Gb.async=!1;Gb.src=w.AFrameworkApplication.lj(String.format("pptspeechclient{0}.js",".min"),5);Gb.addEventListener("load",()=>{xa.a.J(509636755,830,50,"PPTWebEditorSlideShowPackage::Loaded pptspeechclient");Ua(Gb)});Gb.addEventListener("error",()=>{xa.a.J(509636754,830,10,"PPTWebEditorSlideShowPackage::Failed to load pptspeechclient");kb(Gb)});document.head.appendChild(Gb)})]).then(()=>{wa.loadScriptEnd=
Date.now();const Ua={Type:"LoadedJS"};ta.a.forEach(wa,(kb,Gb)=>{Ua[kb]=Gb},null);this.Bdc(Ua);this.K.resolve("PowerPointWebEditor.ISlideshowManager").mDg||(xa.a.J(509636753,830,50,"PPTWebEditorSlideShowPackage::Initializing SlideShowCoreFrame on package registration"),this.K.resolve("PowerPointWebEditor.ISlideshowFrame").preloadShaders(),this.K.resolve("PowerPointWebEditor.ISlideshowFrame").init(w.AFrameworkApplication.buildVersion,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner").Ek,w.AFrameworkApplication.userSessionId,
this.K.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId),this.K.resolve("PowerPointWebEditor.ISlideshowManager").nml());return null}).catch(Ua=>{this.Bdc({["Type"]:"Error",["Reason"]:"FailedDownloadingResources"});xa.a.J(512309318,830,10,"PPTWebEditorSlideShowPackage::LoadSlideShowResources Failed to load the resources for SlideShowCore: {0}",Ua)})}else this.la.ka("DefaultToModernSlideShow")?this.Bdc({["Type"]:"Fallback",["Reason"]:"UnSupportedBrowser"}):xa.a.J(512309319,830,15,"PPTWebEditorSlideShowPackage::PptDefaultToModernSlideShow is disabled"),
this.K.register(442,"PowerPointWebEditor.ISlideshowFrame").ma().oa(()=>new gR.SlideshowFrame(this.K.resolve("PowerPointWebEditor.IWebGLHelper"),this.nb,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ISubtitleContext"),this.K.Ia("PowerPointLive.ILivePresenter"),this.K.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),this.K.Ia("PowerPointWebEditor.ISlideShowVoiceNotification"),this.K.resolve("Common.IDynamicScriptLoaderProvider").rI));this.K.register(gD,
"PowerPointWebEditor.SlideShowFooterContainer").oa(()=>new gD(this.nb,w.AFrameworkApplication.Ra));this.K.resolve("PowerPointWebEditor.SlideShowFooterContainer").vb();let H;if(!this.la.tbc||this.la.$gh)this.K.register(jD,"PowerPointWebEditor.SlideshowToolbar").as("PowerPointWebEditor.ISlideshowToolbar").ma().oa(()=>new jD(w.AFrameworkApplication.Ra,this.la,this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),
this.K.Ia("PowerPointLive.ILivePresenter"),this.nb,()=>w.AFrameworkApplication.isRtl,this.la.podsWebServiceBase,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IFullscreenHelper"))),this.K.resolve("PowerPointWebEditor.ISlideshowToolbar");else{a=cs.a(this.K);c=new Na.a;c.add(a("slideshowToolbar"));this.la.ARk&&c.add(a("uiFabricLazy"));Promise.all(c.toArray()).catch(Ua=>xa.a.J(50907106,830,10,"PPTWebEditorSlideShowPackage::Failed to load the resources for the slideshowToolbar feature: {0}",
Ua)).then(()=>this.cIk()).catch(Ua=>xa.a.J(50907136,830,10,"PPTWebEditorSlideShowPackage::Failed to load the React slideshowToolbar: {0}",Ua));this.la.isInkUIInSlideShowEnabled&&(a("inkButton").catch(Ua=>xa.a.J(51218050,830,10,"PPTWebEditorSlideShowPackage::Failed to load the resources for the ink button feature: {0}",Ua)).then(()=>this.gEk()).catch(Ua=>xa.a.J(51218052,830,10,"PPTWebEditorSlideShowPackage::Failed to load the React ink button: {0}",Ua)),this.K.register(443,"PowerPointWebEditor.IInkButtonHelper").ma().oa(()=>
new VJ));if(this.la.pptEditorVoiceUXEnabled){const Ua=this;a("voiceUI").catch(kb=>xa.a.J(595198419,830,10,"PPTWebEditorSlideShowPackage::Failed to load the resources for the voice UI feature: {0}",kb)).then(()=>Ua.dIk()).catch(kb=>xa.a.J(595198417,830,10,"PPTWebEditorSlideShowPackage::Failed to load the voice UI script: {0}",kb));this.K.register(444,"PowerPointWebEditor.ISlideShowVoiceNotification").ma().oa(()=>new aK)}const wa=this;this.K.register(fD,"PowerPointWebEditor.ReactSlideshowToolbar").as("PowerPointWebEditor.ISlideshowToolbar").ma().oa(()=>
new fD(w.AFrameworkApplication.Ra,wa.la,wa.K.resolve("PowerPointWebEditor.ISlideshowFrame"),wa.K.resolve("PowerPoint.IPathManager"),wa.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),wa.K.Ia("PowerPointLive.ILivePresenter"),wa.nb,()=>w.AFrameworkApplication.isRtl,wa.la.podsWebServiceBase,wa.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),wa.K.resolve("PowerPointWebEditor.IFullscreenHelper")))}H=this.K.Ia("PowerPointWebEditor.ISlideshowToolbar");const Q=this;this.K.register(iD,"PowerPointWebEditor.SlideshowContextMenu").oa(()=>
new iD(Q.K.resolve("PowerPointWebEditor.ISlideshowFrame"),Q.K.resolve("PowerPointWebEditor.IPresentationReader"),Q.K.resolve("PowerPointWebEditor.IInputHandlerManager"),w.AFrameworkApplication.Ra,Q.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),Q.nb,()=>w.AFrameworkApplication.isRtl,Q.K.resolve("PowerPointWebEditor.IFullscreenHelper"),Q.K.Ia("PowerPointLive.ILivePresenter")));const ia=this;this.K.register(445,"PowerPointWebEditor.ISlideshowManager").ma().oa(()=>new bK(ia.K.resolve("PowerPointWebEditor.IFullscreenHelper"),
ia.K.resolve("PowerPointWebEditor.ISlideshowFrame"),H,ia.K.resolve("PowerPointWebEditor.SlideshowContextMenu"),ia.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),w.AFrameworkApplication.Me,ia.la,b,ia.K.resolve("PowerPointWebEditor.IPresentationReader"),ia.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),ia.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),ia.K.resolve("PowerPointWebEditor.IErrorHandler"),Ib.a.instance.resolve("PowerPointWebEditor.ISlideCacheManager"),ia.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
ia.K.resolve("PowerPointWebEditor.IZoomContentFetcher"),Zq.a.Lt(Ib.a.instance.Ia("Common.ISystemInitiatedFeedback")),w.AFrameworkApplication.Ra,Ib.a.instance.Ia("PowerPointLive.ILivePresenter"),ia.K.resolve("PowerPointWebEditor.SlideShowFooterContainer"),ia.K.Ia("PowerPointWebEditor.ISlideShowVoiceNotification")))}Bdc(a){xa.a.J(594583632,830,15,"PPTWebEditorSlideShowPackage::logSlideShowSwitcherData "+JSON.stringify(a))}FTj(){const a=this.la.Ha("PptModernSlideShowWebGLBlockListForBrowserVersion").split(";"),
b=JSON.parse(this.la.Ha("SessionStartInfoJson").toString());xa.a.J(512309317,830,50,"PPTWebEditorSlideShowPackage::IsBrowserModernWebGLCompatible Browser:{0}, BrowserMajorVersion:{1}",b.Browser,b.BrowserMajorVersion);for(const c of a)if(c.split(":")[0].toLowerCase()===(b.Browser||"").toLowerCase()&&parseInt(b.BrowserMajorVersion||"",10)<parseInt(c.split(":")[1],10))return xa.a.J(512309316,830,50,"PPTWebEditorSlideShowPackage::IsBrowserModernWebGLCompatible Name {0}, Version {1}",b.Browser,b.BrowserMajorVersion),
!1;return!0}ETj(){const a=this.la.Ha("PptModernSlideShowBlockListForBrowserVersion").split(";"),b=JSON.parse(this.la.Ha("SessionStartInfoJson").toString());xa.a.J(512309315,830,50,"PPTWebEditorSlideShowPackage::IsBrowserModernCompatible Browser:{0}, BrowserMajorVersion:{1}",b.Browser,b.BrowserMajorVersion);for(const c of a)if(c.split(":")[0].toLowerCase()===(b.Browser||"").toLowerCase()&&parseInt(b.BrowserMajorVersion||"",10)<parseInt(c.split(":")[1],10))return xa.a.J(512309314,830,50,"PPTWebEditorSlideShowPackage::IsBrowserModernCompatible Name {0}, Version {1}",
b.Browser,b.BrowserMajorVersion),!1;return!0}GTj(a){return eK.a(a)}init(){this.K.resolve("Common.IAppSettingsManager").ff(Object(I.a)(this,this.en,"onFullAppSettingsReady"))}en(){Pd.a.get_instance().Mj(10,null).continueWith(()=>{if(!this.la.QL&&this.la.Wgh&&this.la.VSk)try{Zq.a.Lt(Ib.a.instance.Ia("Common.ISystemInitiatedFeedback")).continueWith(a=>{a.result.logActivity("HasPresentButtonSeen","PresentTeachingUIEnabled")}),xa.a.J(512495957,830,50,"PPTWebEditorSlideShowPackage::Present Teaching UI triggered")}catch(a){xa.a.J(512495956,
830,10,"PPTWebEditorSlideShowPackage::Exception thrown when trying to trigger Present teaching UI. Exception: {0}",a)}})}cIk(){this.K.resolve("PowerPointWebEditor.ISlideshowToolbar");return null}gEk(){this.K.resolve("PowerPointWebEditor.IInkButtonHelper");return null}dIk(){this.K.resolve("PowerPointWebEditor.ISlideShowVoiceNotification");return null}dispose(){}static main(){n.a.instance.Ac(new lD)}}Object(m.a)(lD,"PPTWebEditorSlideShowPackage",null,[2,3]);var iR=d(793);class fK{constructor(){this.lfc=
null}uvl(a,b){Bj.UISurfaces.FL().then(c=>{this.lfc=a.dVi(c,a.hNi(b),b,this.lfc)});xa.a.J(527303443,843,50,"{0} Toast is displayed",Object.getType(a).toString())}K5k(a){Bj.UISurfaces.FL().then(b=>{this.lfc=a.z5k(b,this.lfc)});xa.a.J(523871965,843,50,"{0} Toast is removed",this.lfc)}}Object(m.a)(fK,"DeferredNotificationCalloutVisibilityManager",null,[]);var gK=d(1054);const jR=a=>{const b={featureArea:"Partial Presentation"};b.sourceContext=a;a={};a.telemetryGroup=b;return a},kR=(a,b,c,f)=>{const l=
new Ai.StandardDialog;l.Ad=0;if(w.AFrameworkApplication.iF){const y=jR(b);l.iSd(ResourceStrings.L_GiveFeedback,void 0,void 0,y)}l.Tx(c,f,0,a?y=>{1===y?(xa.a.J(526989467,830,50,"User selected Present Anyway in {0}",b),a()):xa.a.J(526989468,830,50,"User selected Cancel in {0}",b)}:null)};class mD{constructor(a,b,c,f,l,y,H){this.f$={};this.dxa=new Jd.a;this.ecd=this.AEe=null;this.Bad=this.OCe=0;this.eDg=!1;this.vdd={};if(!H)throw Error.argumentNull("coreEventSource");this.DM=a;this.Mq=c;this.DM.fk(Object(I.a)(this,
this.$ah,"onShapeNodePropertyChanged"));this.DM.jja(Object(I.a)(this,this.anc,"onShapeNodeLoaded"));this.DM.hja(Object(I.a)(this,this.Zah,"onShapeNodeConnected"));this.zAg=new fK;this.Dg=l;b.VSd(Object(I.a)(this,this.oLe,"onClientError"));b.uTd(Object(I.a)(this,this.ZMe,"onServerError"));w.AFrameworkApplication.ZIc(Object(I.a)(this,this.MLe,"onErrorDialogDisplayed"));this.MBg=f;this.Hma=y;this.li=H;this.li.HC(Object(I.a)(this,this.Oah,"onSessionRehydratedHandler"))}Dyf(a,b){this.dxa.Fb(a)||this.dxa.$(a,
new Ma.a);const c=this.dxa.ga(a);c.add(b);this.dxa.$(a,c)}Gnh(a,b){if(this.dxa.Fb(a)){var c=this.dxa.ga(a);c.remove(b);this.dxa.$(a,c);this.Kfe(a)||this.dxa.remove(a);Dq.a(this.f$).length||xa.a.J(509150993,843,50,"DeferredContentManager::RemoveFromSlideDeferredInfo - no more deferred content in document")}else xa.a.J(509150994,843,15,"DeferredContentManager::RemoveFromSlideDeferredInfo - no deferred content on slideId:{0} shapeNodeId:{1}",a,b)}Kfe(a){return this.dxa.Fb(a)&&0<this.dxa.ga(a).count}qJf(a){if(a.slideId&&
a.slideId.sid&&a.Y4c){var b=a.Y4c;a.u4?(this.eDg||(this.eDg=!0,xa.a.J(509150992,843,50,"DeferredContentManager - deferred content detected: FForceShowDeferralUI: {0}",this.Hma)),b in this.f$||(this.f$[b]=new Date),this.Dyf(a.slideId.sid.toString(),b)):b in this.f$&&(delete this.f$[b],this.Gnh(a.slideId.sid.toString(),b),xa.a.J(509150991,843,15,"DeferredContentManager - Rehydration scenario, Node already in deferred list on load/connect."))}}anc(a,b){(a=Object(qa.a)(4,b.node))?this.qJf(a):xa.a.J(509150990,
843,10,"IDeferrable object is null")}Zah(a,b){(a=Object(qa.a)(4,b.node))?this.qJf(a):xa.a.J(509150989,843,10,"IDeferrable object is null")}$ah(a,b){var c=Object(qa.a)(4,b.node);if(!c)xa.a.J(509150988,843,10,"IDeferrable object is null");else if((b.property===zb.a.u4||this.Hma&&c.Y4c in this.f$&&!c.u4)&&c.slideId)if(b=c.Y4c,a=c.slideId.sid.toString(),c.u4)b in this.f$?xa.a.J(509150987,843,15,"ShapeNode is already deferred:{0}, FForceShowDeferralUI: {1}",b,this.Hma):(xa.a.J(509150986,843,50,"ShapeNode is deferred:{0}, FForceShowDeferralUI: {1}",
b,this.Hma),this.f$[b]=new Date,this.Dyf(a,b));else{if(c=this.f$[b])c=(new Date).getTime()-c.getTime(),xa.a.J(509150985,843,50,"ShapeNode:{0}, DeferredDurationMS:{1}, FForceShowDeferralUI:{2}",b,c,this.Hma),delete this.f$[b],this.Gnh(a,b),this.Bad=c>this.Bad?c:this.Bad;this.MBg&&!this.hasDeferredContent()&&(xa.a.J(509150984,843,50,"All deferred blobs loaded"),this.Xra("AllDeferredBlobsLoaded","true"),this.ecd&&(xa.a.J(509150983,843,50,"Previously called user requested actions triggered"),this.Xra("PreviouslyDeferredActionsTriggeredOnBlobsLoad",
"true"),this.ecd(),this.zAg.K5k(this.AEe),this.AEe=this.ecd=null))}}Oah(){xa.a.J(509150982,843,50,"Session rehydrated with {0} currently deferred blobs",Dq.a(this.f$).length)}J1e(a,b,c){this.MBg?(this.AEe=b,this.ecd=c,this.zAg.uvl(b,this.Dg)):(c=Object(Wa.a)(gK.a,b)?ResourceStrings.l_DeferredContentDownloadACopyWaitDialogTitle:ResourceStrings.l_DeferredContentWaitDialogTitle,b=Object(Wa.a)(gK.a,b)?ResourceStrings.l_DeferredContentDownloadACopyWaitDialogMessage:ResourceStrings.l_DeferredContentWaitDialogMessage,
kR(null,a.toString(),c,b));xa.a.J(509150979,801,100,"ShowDeferredContentWaitUI shown for :{0}",a)}Xra(a,b){this.vdd[a]&&xa.a.J(509150978,843,15,"DeferredContentManager - This action has been requested before. Key: {0}, Value: {1}",a,this.vdd[a]);this.vdd[a]=b}oLe(a,b){this.Koa("ClientError",b)}ZMe(a,b){this.Koa("ServerError",b)}MLe(a,b){(a=Object(qa.a)(iR.a,b))&&this.Koa("Crash",a.errorCode)}Koa(a,b){this.hasDeferredContent()&&xa.a.J(509150977,843,15,"DeferredContentManager - Error while there is deferred content: ErrorType:{0}, ErrorInfo:{1}, FForceShowDeferralUI:{2}",
a,b,this.Hma)}dispose(){this.DM.Om(Object(I.a)(this,this.$ah,"onShapeNodePropertyChanged"));this.DM.A0a(Object(I.a)(this,this.anc,"onShapeNodeLoaded"));this.DM.Woa(Object(I.a)(this,this.Zah,"onShapeNodeConnected"));this.li.zga(Object(I.a)(this,this.Oah,"onSessionRehydratedHandler"));this.log()}hasDeferredContent(){const a=Dq.a(this.f$),b=this.Hma&&0<a.length||0<this.Mq.m9a;if(b){const c={};c.DeferredNodeCount=a.length.toString();c.DeferredBlobCount=this.Mq.m9a.toString();c.FForceShowDeferralUI=this.Hma.toString();
xa.a.J(509150976,843,50,JSON.stringify(c));this.OCe=Math.max(this.Mq.m9a,this.OCe)}return b}ZGj(a){return Yb.a.any(a,b=>b.hasDeferredContent)?(xa.a.J(509150947,843,50,"{0} DeferredSlideCount: {1}, FForceShowDeferralUI: {2}","CutCopySlides",a.length,this.Hma),!0):!1}Jfe(a,b){return Yb.a.any(a,c=>c.u4)?(xa.a.J(509150946,843,50,"{0} DeferredShapeCount: {1}, FForceShowDeferralUI: {2}",b,a.length,this.Hma),!0):!1}log(){const a=Dq.a(this.f$),b={};b.MaxDeferredTime=this.Bad.toString();b.DeferredCountOnClose=
a.length.toString();b.MaxNumberOfDeferredBlobs=this.OCe.toString();b.FForceShowDeferralUI=this.Hma.toString();xa.a.J(509150945,843,15,"SessionLogs: {0}, PersistedLogs: {1}",JSON.stringify(b),JSON.stringify(this.vdd))}}Object(m.a)(mD,"DeferredContentManager",null,[473]);class nD{constructor(){this.Jw=this.K=null}get name(){return"PowerPointWebEditor.PartialDoc"}Yb(a){this.K=a;this.K.register(mD,"PowerPointWebEditor.DeferredContentManager").as("PowerPointWebEditor.IDeferredContentManager").ma().oa(()=>
new mD(this.K.resolve("Box4.Graph.IGraphInstance").yd(10),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("PowerPointWebEditor.ICoauthStateSetter"),this.K.resolve("Common.IAppSettingsManager").ka("UseToastForDeferredBlobsEnabled"),this.K.resolve("Common.IF6Manager"),0<this.K.resolve("Common.IAppSettingsManager").wc("ForceShowDeferralUIMS",0),this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource")))}init(){this.Jw=this.K.resolve("PowerPointWebEditor.IDeferredContentManager")}dispose(){this.Jw&&
this.Jw.dispose()}static main(){n.a.instance.Ac(new nD)}}Object(m.a)(nD,"PPTWebEditorPartialDocPackage",null,[2,3]);class Lv{constructor(a,b){this.shapeNode=a;this.position=b}}Object(m.a)(Lv,"MoveShapeData",null,[]);class hK{constructor(a,b){this.PO=null;this.yp=a;this.ia=b}start(){this.PO=[];for(let a=0;a<this.yp.length;++a)Array.add(this.PO,new Zc.a(this.yp[a].x,this.yp[a].y)),this.yp[a].mE(!1)}PXd(a,b){if(1!==a||this.yp.length!==b.length)return!1;for(a=0;a<b.length;a++)if(!this.WVj(b[a]))return!1;
return!0}WVj(a){for(let b=0;b<this.yp.length;b++)if(a.gb.equals(this.yp[b].gb))return!0;return!1}perform(a){for(let c=0;c<this.yp.length;c++){var b=new Zc.a(this.yp[c].x,this.yp[c].y);b=Zc.a.add(b,a);this.yp[c].setPosition(b.x,b.y,!0)}}end(){this.PO&&xa.a.J(17597603,815,50,"ShapeKeyboardDragManager::ShapeMoveAction - moving {0} shapes by ( {1}, {2} )",this.yp.length,this.yp[0].x-this.PO[0].x,this.yp[0].y-this.PO[0].y);const a=[];for(let b=0;b<this.yp.length;++b){const c=this.yp[b].wUc();Array.add(a,
new Lv(this.yp[b].shapeNode,c));this.yp[b].cA(!1)}this.ia.Ka(ea.a.BJa,2,a)}}Object(m.a)(hK,"ShapeMoveAction",null,[1032]);class zz{constructor(a,b,c=null,f=null){this.U1=a;this.I1=b;this.N4b=c;this.z4g=f}}Object(m.a)(zz,"ResizeShapeData",null,[]);class iK{constructor(a,b){this.TGa=this.jDb=this.qGe=null;this.oG=a;this.ia=b}start(){this.qGe=[];this.jDb=[];this.TGa=[];for(const c of this.oG){c.XL=!0;c.mE(!1);Array.add(this.qGe,c.e_a);Array.add(this.jDb,new Xi.a);var a=c.Mxb(),b=Zc.a.Ql(a.Tj(qe.a.Wu),
a.Tj(qe.a.VE));a=Zc.a.Ql(a.Tj(qe.a.Wu),a.Tj(qe.a.dI));Array.add(this.TGa,a?b/a:1);c.shapeNode.Of&&c.shapeNode.isEditable&&(b=c,b.Fk&&(b.Fk.visible=!0))}}PXd(a,b){if(2!==a)return!1;for(a=0;a<b.length;a++)if(b[a].Nl||!b[a].gb.equals(this.oG[a].gb))return!1;return!0}perform(a,b){for(let f=0;f<this.oG.length;f++){var c=a;let l=b;({deltaX:c,deltaY:l}=this.RNl(c,l,f));let y;(y=this.jDb[f]).right=y.right+c;let H;(H=this.jDb[f]).bottom=H.bottom+l;this.oG[f].setOffsets(Xi.a.add(this.qGe[f],this.jDb[f]),!0);
this.oG[f].shapeNode.Of&&this.oG[f].shapeNode.isEditable&&(c=this.oG[f],c.oge(),c.dZc())}}RNl(a,b,c){if(!this.oG[c].shapeNode.isAspectRatioLocked)return{deltaX:a,deltaY:b};b?a=b*this.TGa[c]:b=a/this.TGa[c];return{deltaX:a,deltaY:b}}end(){const a=[];for(let b=0;b<this.oG.length;b++)this.oG[b].Nl||(this.oG[b].shapeNode.Of&&this.oG[b].shapeNode.isEditable||(this.oG[b].XL=!1),this.oG[b].cA(!1),Array.add(a,new zz(this.oG[b].shapeNode,this.jDb[b])));this.ia.Ka(ea.a.qkb,2,a);this.oG=null}}Object(m.a)(iK,
"ShapeResizeAction",null,[1032]);class fp{constructor(a,b){this.shapeNode=a;this.K2d=b%fp.rnc}}fp.rnc=360;Object(m.a)(fp,"ShapeRotateData",null,[]);class jK{constructor(a,b){this.szg=null;this.ete=0;this.Yd=a;this.ia=b}start(){this.Yd.mE(!1);this.szg=this.Yd.Mxb().Zf()}PXd(a,b){return 3===a&&!this.Yd.Nl&&this.Yd.gb.equals(b[0].gb)}perform(a){this.ete=(this.Yd.rotation+a)%fp.rnc;this.Yd.setRotation(this.ete,this.szg)}end(){if(!this.Yd.Nl){this.Yd.cA(!1);var a=new fp(this.Yd.shapeNode,this.ete);this.ia.Ka(ea.a.Prc,
2,a)}}}Object(m.a)(jK,"ShapeRotateAction",null,[1032]);class Ip{constructor(a){this.nJa=this.bR=null;this.ia=a}dxc(){this.nJa&&Nc.a.Rub(this.nJa);this.nJa=Nc.a.bba(Object(I.a)(this,this.MWf,"endAction"),Ip.jvi)}n5d(a,b){this.bR&&!this.bR.PXd(a,b)&&(this.bR.end(),this.bR=null);if(!this.bR){this.bR=this.A$i(a,b);if(!this.bR)throw Error.invalidOperation("Could not create keyboard action");this.bR.start()}this.dxc();return this.bR}MWf(){this.bR&&(this.bR.end(),this.bR=null);this.nJa=null}move(a,b){a=
this.n5d(1,a);b=this.ITf(b);a.perform(b)}resize(a,b){a=this.n5d(2,a);b=this.ITf(b);a.perform(b.x,b.y)}rotate(a,b,c){a=this.n5d(3,a);c=c?Ip.Zui:Ip.Yui;a.perform(b?c:-1*c)}ITf(a){let b=0,c=0;a.equals(qe.a.north)?c=-1*Ip.sLc:a.equals(qe.a.east)?b=Ip.sLc:a.equals(qe.a.south)?c=Ip.sLc:a.equals(qe.a.west)&&(b=-1*Ip.sLc);return new Zc.a(b,c)}A$i(a,b){return b?1===a?new hK(b,this.ia):2===a?new iK(b,this.ia):3===a&&(1<b.length&&xa.a.J(17651872,815,15,"ShapeKeyboardDragManager::GetActionForType - Currently we don't support multi-shapes rotation, will only rotate the first shape by keyboard."),
3===a)?new jK(b[0],this.ia):null:null}}Ip.jvi=1E3;Ip.sLc=1;Ip.Yui=15;Ip.Zui=1;Object(m.a)(Ip,"ShapeKeyboardDragManager",null,[1004]);var Qg=d(154),it=d(523);const Dn=a=>{a&&Nc.a.Kb&&(Nc.a.Kb.neg=a.Of,Nc.a.Kb.WFh=a.Ug)};var Iq=d(237),kK=d(507),Mx=d(331);class oD{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd){if(!Fc)throw Error.argumentNull("ISessionInfoOwner is null");if(!yc)throw Error.argumentNull("IPPTUnitConversion is null");if(!tc)throw Error.argumentNull("IZoomContext is null");
dc||xa.a.J(509650844,815,10,"ShapeManipulationActor constructor null WebSocketFrontDoor");this.ia=a;this.qf=b;this.oq=c;this.Fa=f;this.kb=l;this.Bdd=y;this.Eb=H;this.Gb=Q;this.Ga=ia;this.le=wa;this.Js=Gb;this.zA=Ua;this.$cd=kb;this.Ea=ec;this.Bhc=new Eb.ScriptSharpLegacyMap;this.GZa=dc;this.Ya=Fc;this.wi=yc;this.ij=tc;this.Hi=xd;this.Zva=Vd}vb(){this.ia.ra(ea.a.z8a,hc.a.application,Object(I.a)(this,this.AAj,"handleDeleteSelectedShapes"),4);this.ia.ra(ea.a.h4b,hc.a.application,Object(I.a)(this,this.BAj,
"handleDeleteShapes"),4);this.ia.ra(ea.a.BJa,hc.a.application,Object(I.a)(this,this.HCj,"handleMoveShapes"),4);this.ia.ra(ea.a.qkb,hc.a.application,Object(I.a)(this,this.TEj,"handleResizeShapes"),4);this.ia.ra(ea.a.Prc,hc.a.application,Object(I.a)(this,this.qfe,"handleRotateShape"),4);this.ia.ra(ea.a.Ash,hc.a.application,Object(I.a)(this,this.rfe,"handleRotateShapes"),4);this.ia.ra(ea.a.ysh,hc.a.application,Object(I.a)(this,this.Mfg,"handleRotateShapeAnchor"),4);this.ia.ra(ea.a.zsh,hc.a.application,
Object(I.a)(this,this.Mfg,"handleRotateShapeAnchor"),4);this.ia.ra(ea.a.Taa,hc.a.application,Object(I.a)(this,this.Nfg,"handleRotateShapeByDirection"),4);this.ia.ra(ea.a.yXe,hc.a.application,Object(I.a)(this,this.Nfg,"handleRotateShapeByDirection"),4);eb.a("FlipInMultiSelectEnabledV2")?(this.ia.ra(ea.a.Rrc,hc.a.application,Object(I.a)(this,this.Teg,"handleFlipShape"),4),this.ia.ra(ea.a.Qrc,hc.a.application,Object(I.a)(this,this.Teg,"handleFlipShape"),4)):(this.ia.ra(ea.a.Rrc,hc.a.application,Object(I.a)(this,
this.Ueg,"handleFlipShapeForSingleSelection"),4),this.ia.ra(ea.a.Qrc,hc.a.application,Object(I.a)(this,this.Ueg,"handleFlipShapeForSingleSelection"),4));this.ia.ra(ea.a.K8a,hc.a.application,Object(I.a)(this,this.hAj,"handleCommitKeyboardShapeManipulation"),4);this.ia.ra(ea.a.Flc,yb.a.view,Object(I.a)(this,this.pYc,"handleMoveShapesKeyboard"),4);this.ia.ra(ea.a.Glc,yb.a.view,Object(I.a)(this,this.pYc,"handleMoveShapesKeyboard"),4);this.ia.ra(ea.a.Hlc,yb.a.view,Object(I.a)(this,this.pYc,"handleMoveShapesKeyboard"),
4);this.ia.ra(ea.a.Ilc,yb.a.view,Object(I.a)(this,this.pYc,"handleMoveShapesKeyboard"),4);this.ia.ra(ea.a.zrc,yb.a.view,Object(I.a)(this,this.vYc,"handleResizeShapesKeyboard"),4);this.ia.ra(ea.a.Arc,yb.a.view,Object(I.a)(this,this.vYc,"handleResizeShapesKeyboard"),4);this.ia.ra(ea.a.Brc,yb.a.view,Object(I.a)(this,this.vYc,"handleResizeShapesKeyboard"),4);this.ia.ra(ea.a.Crc,yb.a.view,Object(I.a)(this,this.vYc,"handleResizeShapesKeyboard"),4);this.ia.ra(ea.a.wXe,yb.a.view,Object(I.a)(this,this.wYc,
"handleRotateShapeKeyboard"),4);this.ia.ra(ea.a.qqd,yb.a.view,Object(I.a)(this,this.wYc,"handleRotateShapeKeyboard"),4);this.ia.ra(ea.a.pqd,yb.a.view,Object(I.a)(this,this.wYc,"handleRotateShapeKeyboard"),4);this.ia.ra(ea.a.Trc,yb.a.view,Object(I.a)(this,this.wYc,"handleRotateShapeKeyboard"),4);this.ia.ra(ea.a.tSe,hc.a.application,Object(I.a)(this,this.dfe,"handleIsDirectManipulationEnabled"),97);this.ia.ra(ea.a.vQe,hc.a.application,Object(I.a)(this,this.Bfg,"handlePreviewRotate"),4);this.ia.ra(ea.a.wQe,
hc.a.application,Object(I.a)(this,this.Bfg,"handlePreviewRotate"),4);this.ia.ra(ea.a.oXe,hc.a.application,Object(I.a)(this,this.WEj,"handleRevertPreviewRotate"),4)}pe(){const a=this.Fa.Fc(jb.a.vg);a.bindAction(x.KeyInputManager.Qa(B.a.f7,4),ea.a.zrc);a.bindAction(x.KeyInputManager.Qa(B.a.Eba,4),ea.a.Arc);a.bindAction(x.KeyInputManager.Qa(B.a.rha,4),ea.a.Brc);a.bindAction(x.KeyInputManager.Qa(B.a.nZ,4),ea.a.Crc);a.bindAction(x.KeyInputManager.Qa(B.a.Eba,5),ea.a.pqd);a.bindAction(x.KeyInputManager.Qa(B.a.rha,
5),ea.a.Trc);a.bindAction(x.KeyInputManager.Qa(B.a.Eba,1),ea.a.wXe);a.bindAction(x.KeyInputManager.Qa(B.a.rha,1),ea.a.qqd);a.bindAction(x.KeyInputManager.Qa(B.a.$pa,0),ea.a.z8a);a.bindAction(x.KeyInputManager.Qa(B.a.iI,0),ea.a.z8a);this.Fa.Fc(jb.a.Xi).bindAction(x.KeyInputManager.Qa(B.a.Eba,1),G.a.ve)}HCj(a,b,c,f,l){if(!l||!Object(Wa.a)(Array,l)||1>l.length)return 8;for(const H of l)if(b=H.shapeNode,this.VSa(b),b.get_smartArtModelId()&&(b=this.Ga.Gr(b)),!this.$Hf(b)||this.qf.$c(H.shapeNode))return 16;
if(1===c)return 32;if(Nc.a.Kb){Nc.a.Kb.Oj=!0;for(var y of l)if((c=y.shapeNode)&&(c.Of||c.Ug)){Dn(c);break}}y=this.Eb.xd(15,void 0,()=>{this.kb.kj();this.Fa.Bd()});try{y.hc(l[0].shapeNode);y.fd=a;const H=this.Gb.Md;for(const Q of l){const ia=new Zc.a(H.gf(Q.position.x,0),H.gf(Q.position.y,1));yq.c(Q.shapeNode.get_smartArtModelId()?this.Ga.Gr(Q.shapeNode):Q.shapeNode,ia.x,ia.y)}}finally{y&&y.dispose()}return 32}TEj(a,b,c,f,l){if(!l||!Object(Wa.a)(Array,l)||1>l.length)return 8;for(b=0;b<l.length;b++){if(!this.p1b(l[b].U1))return xa.a.J(509650842,
815,15,"ShapeManipulationActor::ResizeShapes - Try to execute HandleResizeShapes when {0} shape is not resizable.",l[b].U1.get_shapeId()),16;if(this.qf.$c(l[b].U1))return 16}if(1===c)return 32;if(Nc.a.Kb){Nc.a.Kb.Oj=!0;for(var y of l)if((c=y.U1)&&(c.Of||c.Ug)){Dn(c);break}}y=this.Eb.xd(15,void 0,()=>{this.kb.kj();const H=this.Fa.Ee;!H||H.name!==jb.a.vg&&H.name!==jb.a.Lz||this.Fa.Bd()});try{for(y.hc(l[0].U1),y.fd=a,a=0;a<l.length;a++)l[a].U1.uzh=l[a].I1}finally{y&&y.dispose()}if(this.kb.$L()&&(a=this.kb.dFa(),
(a=this.rk(a))&&Object(Wa.a)(it.a,a.Fk)&&Object(qa.a)(it.a,a.Fk).clearChildSelection(),this.GZa&&this.Ea.Wyl))for(const H of l)this.Phl(H);return 32}Phl(a){const b=a.U1;if(b&&b.Wf&&!b.Ug){var c=Nc.a.Kb?Nc.a.Kb.actionId:Hg.a.create().toString(),f=w.AFrameworkApplication.userSessionId,l=this.Ya.podSessionId,y=this.Pyl,H=this.Vlb,Q=H/y,ia=Fb.a.DY(this.wi.YH(a.I1.left,Q),0),wa=Fb.a.DY(this.wi.YH(a.I1.top,Q),1),Ua=Fb.a.DY(this.wi.YH(a.I1.right,Q),0);a=Fb.a.DY(this.wi.YH(a.I1.bottom,Q),1);Q=Math.abs(b.get_widthPersisted()+
Ua-ia);var kb=Math.abs(b.get_heightPersisted()+a-wa);Ua=el.o(b.slideCid,b.slideSid);a=el.b(b.get_shapeId(),null);var Gb=el.f(Ua,a);ia=el.m((b.get_xPersisted()+ia).toString(),(b.get_yPersisted()+wa).toString());ia=el.n(Q,kb,ia);ia=el.c(Gb,ia);wa=null;this.Hi&&this.Hi.highContrastColors&&(wa=el.k(el.j(this.Hi.highContrastColors.foregroundTextColor),el.j(this.Hi.highContrastColors.backgroundColor),el.j(this.Hi.highContrastColors.linkColor)));f=el.d(Ua,a,1,b.Vf,0,0,c,f,this.Hi.isInHighContrastMode,wa,
this.Ea.qvh&&this.Zva?this.Zva.Cjj():null);l=el.e(f,[],l);l.editOps.push(ia);l=el.q(null,l,null,null,this.Ya.Ek);f=Nc.a.jZ();Nc.a.Kb&&f&&(Nc.a.Kb.Wa("editOpCorrelationId",c),Nc.a.Kb.Wa("editOpRequestStartTick",f.toString()));this.GZa.Wx(l);xa.a.J(509650841,815,50,"ShapeManipulationActor::HandleResizeShapes Sent SmartArtEditOpRequest; correlationId:{0}, slideSid:{1}, slideCid:{2}, shapeId:{3}, slideZoomFactor:{4}, slideImageZoom:{5}, SendKnownGlyphsForSmartArtResizeEditOp:{6}",c,b.slideSid,b.slideCid,
b.get_shapeId(),y,H,this.Ea.qvh)}}get Pyl(){let a=this.ij.WG;this.oq&&this.oq.Ba&&this.oq.Ba.lx&&null!=this.oq.Ba.lx.gs&&(a=this.oq.Ba.lx.gs);a||(xa.a.J(509650840,815,15,"ShapeManipulationActor.SlideZoomFactor: zero slideZoomFactor"),a=1);return a}get Vlb(){let a=1;if(this.oq&&this.oq.Ba){const b=Object(qa.a)(340,this.oq.Ba.tg(this.Gb.Na));b?a=b.UT:xa.a.J(509650839,815,15,"ShapeManipulationActor.SlideImageZoom: no active ISlideViewElement; imageZoom:{0}",a)}else xa.a.J(509650838,815,15,"ShapeManipulationActor.SlideImageZoom: no active slide; imageZoom:{0}",
a);a||(xa.a.J(509650837,815,15,"ShapeManipulationActor.SlideImageZoom: zero imageZoom"),a=1);return a}Nfg(a,b,c,f,l){return 1===c?32:Qg.a("Rotate",a,()=>{xa.a.J(509650836,822,50,"ShapeManipulationActor::HandleRotateShapeByDirection, Rotate operation performed");const y=this.kb.Qf();if(!y)return xa.a.J(509650835,822,10,"ShapeManipulationActor::HandleRotateShapeByDirection, selected nodes: null"),16;this.$cd&&1===y.length&&this.VSa(y[0]);switch(a){case ea.a.Taa:xa.a.J(509650834,822,50,"ShapeManipulationActor::RotateLeft: Rotate Left is selected");
if(eb.a("FixUndoRotateMultipleShapes")){var H={};H.selectedNodes=y;H.rotateLeft=!0;this.rfe(a,b,c,f,H)}else for(H of y)l=new fp(H,Math.round(H.get_shapeRotation()+270)),this.qfe(a,b,c,f,l);break;case ea.a.yXe:xa.a.J(509650833,822,50,"ShapeManipulationActor::RotateRight: Rotate Right is selected");if(eb.a("FixUndoRotateMultipleShapes"))H={},H.selectedNodes=y,H.rotateRight=!0,this.rfe(a,b,c,f,H);else for(const Q of y)l=new fp(Q,Math.round(Q.get_shapeRotation()+90)),this.qfe(a,b,c,f,l);break;default:return 8}return 32})}rfe(a,
b,c,f,l){if(!l)return 8;b=l.selectedNodes;f=l.rotateData?l.rotateData:[];for(const y of b){const H=this.tub(y);if(1===c)return H?32:8;if(!H||this.qf.$c(y))return 16}if(l.rotateLeft||l.rotateRight)for(const y of b)Nc.a.Kb&&(Nc.a.Kb.Oj=!0,y&&(y.Of||y.Ug)&&Dn(y)),c=new fp(y,Math.round(y.get_shapeRotation()+(l.rotateLeft?270:90))),f.push(c);l=this.Eb.xd(15,void 0,()=>{this.kb.kj();const y=this.Fa.Ee;!y||y.name!==jb.a.vg&&y.name!==jb.a.Lz||this.Fa.Bd()});try{for(l.hc(b[0]),l.fd=a,a=0;a<b.length;a++)b[a].set_shapeRotation(f[a].K2d)}finally{l&&
l.dispose()}return 32}qfe(a,b,c,f,l){if(!l||!Object(Wa.a)(fp,l))return 8;b=l.shapeNode;f=this.tub(b);if(1===c)return f?32:8;if(!f||this.qf.$c(b))return 16;Nc.a.Kb&&(Nc.a.Kb.Oj=!0,b&&(b.Of||b.Ug)&&Dn(b));c=this.Eb.xd(15,void 0,()=>{this.kb.kj();const y=this.Fa.Ee;!y||y.name!==jb.a.vg&&y.name!==jb.a.Lz||this.Fa.Bd()});try{c.hc(b),c.fd=a,b.set_shapeRotation(l.K2d)}finally{c&&c.dispose()}return 32}Mfg(){const a=this.kb.Qf();return 0<a.length&&this.g2j(a)?32:8}Bfg(a,b,c){return this.Ea.Xoc?1===c?32:Qg.a("HandlePreviewRotate:",
a,()=>{var f=this.kb.Qf();for(const l of f){if(!l){xa.a.J(509650831,822,50,"HandlePreviewRotate, shape with shape id : {0} is null",l.get_shapeId());continue}if(l.vd)continue;this.Bhc.Fb(l.get_shapeId())?this.Bhc.$(l.get_shapeId(),l.get_shapeRotation()):this.Bhc.add(l.get_shapeId(),l.get_shapeRotation());f=this.rk(l);if(!f){xa.a.J(509650830,822,50,"HandlePreviewRotate, shapeViewElement with shape id : {0} is null",l.get_shapeId());continue}const y=f.Mxb().Zf();switch(a){case ea.a.vQe:f.setRotation((l.get_shapeRotation()+
270)%fp.rnc,y);break;case ea.a.wQe:f.setRotation((l.get_shapeRotation()+90)%fp.rnc,y)}}return 32}):2}WEj(a,b,c){if(!this.Ea.Xoc)return 2;if(1===c)return 32;a=this.kb.Qf();for(const f of a)if(!f)xa.a.J(509650829,822,50,"HandleRevertPreviewRotate, shape with shape id : {0} is null",f.get_shapeId());else if(!f.vd)if(a=this.rk(f))if(b=a.Mxb().Zf(),this.Bhc.Fb(f.get_shapeId()))a.setRotation(this.Bhc.ga(f.get_shapeId()),b);else return xa.a.J(509650827,815,10,"HandleRevertPreviewRotate: Revert Preview operation on the shape failed with id : {0}",
f.get_shapeId()),8;else xa.a.J(509650828,822,50,"HandleRevertPreviewRotate, shapeViewElement with shape id : {0} is null",f.get_shapeId());return 32}AAj(a,b,c,f,l){b=this.kb.Qf();if(1===b.length&&this.kb.pz())return 16;f=1===b.length&&!!b[0]&&b[0].Pbb();f=0<b.length&&!f;if(1===c)return f?32:8;if(!f)return 16;if(Nc.a.Kb){Nc.a.Kb.actionName="ClearPlaceholders";Nc.a.Kb.Oj=!0;for(const y of b)if(y.Of||y.Ug){Dn(y);break}}if(this.kb.$L()&&eb.a("EnableSmartArtSubShapeDeletion")&&this.Zee(b[0],a,l))return 32;
c=null;if(l=this.Ga.W$a(b))eb.a("SmartArtSubNodeEditing")?c=this.Ga.Gr(l):(this.kb.xpd(l),b=this.kb.Qf());return this.h4b(a,b,this.kb.hk(),c)?32:16}BAj(a,b,c,f,l){if(!l)return 1===c?8:16;b=this.oq.presentation;if(!b)throw Error.argumentNull("Presentation is null");l=Array.isArray(l.shapeNodes)?l.shapeNodes:null;if(!l)return 1===c?8:16;if(1===c)return 32;Nc.a.Kb&&(Nc.a.Kb.actionName="DeleteShapes",Nc.a.Kb.Oj=!0);return l.length&&this.h4b(a,l,Object(qa.a)(118,b.ZC(l[0].slideId)))?32:16}h4b(a,b,c,f=
null){if(!c||!b.length||this.qf.eD(b))return!1;let l=!1;for(var y of b)if(y.SFa){l=!0;break}y=this.Eb.xd(15,void 0,()=>{this.kb.nh()});try{f?y.ld(f):y.ld(c);y.fd=a;y.py[Iq.a.tzb]=l;for(const H of b)if(H&&H.Ug){const Q=this.Ga.Cs(H);if(Q){const ia=Kj.c(Q,this.Gb.Na);ia&&(ia.Fk.visible=!1)}}f?f.koh(b):c.YR(b)}finally{y&&y.dispose()}for(const H of b)this.Js.Hkh(new kK.a(H));return!0}Ueg(a,b,c){b=this.kb.Qf();const f=0<b.length?b[0]:null,l=1===b.length&&this.QXd(f);if(1===c)return l?32:8;if(!l||this.qf.$c(f))return 16;
this.VSa(f);for(const y of b)if(y.Of||y.Ug){Dn(y);break}return Qg.a("Rotate",a,()=>{let y,H;switch(a){case ea.a.Qrc:H=f.get_isVerticallyFlipped();y=!f.get_isHorizontallyFlipped();break;case ea.a.Rrc:H=!f.get_isVerticallyFlipped();y=f.get_isHorizontallyFlipped();break;default:return 8}const Q=this.Eb.xd(15,void 0,()=>{this.kb.kj();this.Fa.Bd()});try{Q.hc(f),Q.fd=a,f.set_isVerticallyFlipped(H),f.set_isHorizontallyFlipped(y)}finally{Q&&Q.dispose()}return 32})}Teg(a,b,c){const f=this.kb.Qf();b=!0;if(!f||
f&&!f.length)b=!1;for(const H of f)if(b=this.QXd(H),!b)break;if(1===c)return b?32:8;if(!b)return xa.a.J(509650822,815,10,"ShapeManipulationActor:: HandleFlipShape shape horizontal flip change with no rotateable shape selected"),16;for(const H of f){if(this.qf.$c(H))return 16;this.VSa(H)}for(const H of f)if(H.Of||H.Ug){Dn(H);break}const l=a===ea.a.Qrc,y=a===ea.a.Rrc;return l||y?Qg.a("Rotate",a,()=>{const H=Array(f.length),Q=Array(f.length);for(var ia=0;ia<f.length;ia++)Q[ia]=!!(y^f[ia].get_isVerticallyFlipped()),
H[ia]=!!(l^f[ia].get_isHorizontallyFlipped());ia=this.Eb.xd(15,void 0,()=>{this.kb.kj();this.Fa.Bd()});try{ia.hc(f[0]);ia.fd=a;for(let wa=0;wa<f.length;wa++)f[wa].set_isVerticallyFlipped(Q[wa]),f[wa].set_isHorizontallyFlipped(H[wa])}finally{ia&&ia.dispose()}return 32}):(xa.a.J(509650821,815,10,"ShapeManipulationActor:: HandleFlipShape Invalid request"),8)}hAj(){this.Bdd.MWf();return 32}pYc(a,b,c){const f=Kj.b(b);if(!f)return 16;b=this.kb.Qf();if(!b.length)return 16;let l=!0;const y=[];for(const H of b)if(H.get_smartArtModelId()){y.push(this.Ga.Gr(H));
break}else y.push(H);for(const H of y)if(!this.$Hf(H)){l=!1;break}if(1===c)return l?32:8;if(!l)return 16;c=Kj.d(y,f.Na);if(this.qf.eD(b))return 16;switch(a){case ea.a.Flc:a=qe.a.south;break;case ea.a.Glc:a=qe.a.west;break;case ea.a.Hlc:a=qe.a.east;break;case ea.a.Ilc:a=qe.a.north;break;default:return 8}this.Bdd.move(c,a);this.zA&&this.kb.$L()&&(a=this.kb.dFa(),this.le.Jjb(new Mx.a(a)));Nc.a.Kb&&(Nc.a.Kb.Oj=!0,Nc.a.Kb.FF=new Date);return 32}vYc(a,b,c){const f=Kj.b(b);b=this.kb.Qf();const l=[];for(var y of b){if(y.get_smartArtModelId()){this.kb.xpd(y);
Array.add(l,this.Ga.Gr(y));break}!y.isResizable||y.lJ||y.vd||Array.add(l,y)}y=Kj.d(l,f.Na);if(1===c)return 0<l.length?32:8;if(0>=b.length||this.qf.eD(l))return 16;switch(a){case ea.a.zrc:a=qe.a.south;break;case ea.a.Arc:a=qe.a.west;break;case ea.a.Brc:a=qe.a.east;break;case ea.a.Crc:a=qe.a.north;break;default:return 8}this.Bdd.resize(y,a);this.zA&&this.kb.$L()&&(a=this.kb.dFa(),this.le.Jjb(new Mx.a(a)));Nc.a.Kb&&(Nc.a.Kb.Oj=!0,Nc.a.Kb.FF=new Date);return 32}wYc(a,b,c){var f=this.kb.Qf();const l=0<
f.length?f[0]:null,y=1===f.length&&this.tub(l);if(1===c)return y?32:8;if(!y||this.qf.$c(l))return 16;b=Kj.b(b);f=Kj.d(f,b.Na);c=a===ea.a.qqd||a===ea.a.Trc;a=a===ea.a.pqd||a===ea.a.Trc;0<f.length&&f[0].shapeNode.Of&&f[0].shapeNode.isEditable&&(b=f[0].shapeNode.tg(b.Na))&&b.dZc();this.Bdd.rotate(f,c,a);Nc.a.Kb&&(Nc.a.Kb.Oj=!0,Nc.a.Kb.FF=new Date);return 32}dfe(a,b,c,f,l){return l&&Object(Wa.a)(9,l)?this.qf.$c(l)?16:32:8}g2j(a){for(const b of a)if(!this.tub(b)&&!this.QXd(b))return!1;return!0}$Hf(a){return!!a&&
a.oJ&&a.EB&&!a.lJ}p1b(a){return!!a&&a.isResizable&&a.EB&&!a.lJ}tub(a){return!!a&&a.YL&&!a.lJ}QXd(a){return!!a&&a.PWj&&!a.lJ}rk(a){return a?Object(qa.a)(119,a.qc(this.Gb.Na)):null}VSa(a){a&&a.Lv&&(a=this.rk(a))&&a.PY(!1)}Zee(a,b,c){return(a=this.rk(a))&&Object(Wa.a)(it.a,a.Fk)&&(a=Object(qa.a)(it.a,a.Fk))?a.goc(ea.a.Hv(b),c):!1}}Object(m.a)(oD,"ShapeManipulationActor",null,[]);var Mv=d(427),Ki=d(68);class pD extends Mv.DragSelectionDragAdapter{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb){super(a,b,
c);this.pa=f;this.Fa=l;this.la=Q;this.Ga=y;this.Rsk=H;this.xD=ia;this.Rb=wa;this.kq=Ua;this.Bfa=kb;this.zc=Gb;this.Qyc=this.Ryc=null}get CLc(){return this.Ryc}get BLc(){return this.Qyc}Yu(a){for(var b=this.M7e(),c=a.Bc,f=c,l=this.xD.$I(f);!l&&f;){l=this.xD.$I(f);if(Sys.UI.DomElement.containsCssClass(f,"Outline")&&Sys.UI.DomElement.containsCssClass(f,"OutlineSized"))break;f=f.parentNode}l||xa.a.J(39175171,820,15,"The element doesn't have a owner and it's parent don't have owner className: "+c.className+
" tagName: "+c.tagName);if(!b||!l)return!1;b=b.node;l=l.gb;c=this.Rb.Lc(l);if(b===l||c.kf()&&c.g3a()===b){l=super.Yu(a);if(!l)return l;this.Ga.x4(b)&&(c=this.zc.ZN(Object(qa.a)(4,b)))&&c.Op()&&(c=this.Bfa.x7d(a.clientPoint,c,null,null))&&(f=c.qc(this.Nf.Na),this.Nf.Y6(a.clientPoint,f,c,this.Nf,a.shiftKey));null!==this.kq&&(a=this.Ga.vd(b),this.kq.cza(Ki.a.mba),a&&(this.Ryc=this.Bfa.Zae(b),this.Qyc=this.Bfa.V8f(b)));return l}return!1}Au(a){super.Au(a);this.AXf();null!==this.kq&&this.kq.Eya();this.CLc&&
(this.Ryc=null);this.BLc&&(this.Qyc=null)}to(a){super.to(a);this.AXf();null!==this.kq&&this.kq.Eya();this.CLc&&(this.Ryc=null);this.BLc&&(this.Qyc=null)}zIb(a,b,c){({es:b,graphNode:c}=super.zIb(a,b,c));if(this.la.Drg&&(a=this.M7e())){const f=this.qdj(c);f&&f===a||(c=a,b=c.qc(this.Nf.Na))}return{es:b,graphNode:c}}Ewc(a){let b=super.Ewc(a);if(!b&&this.la.Drg){let c=this.M7e();if(c&&this.Ga.vd(c.node)){const f=this.pa.un();this.Bfa.v0c(a.clientPoint,f)&&(c=this.Bfa.x7d(a.clientPoint,f,this.CLc,this.BLc))}c&&
(b=c.qc(this.Nf.Na))}return b}qdj(a){return a?this.Ga.vn(a):null}M7e(){const a=this.Rsk.Gag(this.Nf.Na);return!a||a.uH?null:this.pa.fo()}AXf(){(this.pa.rH()||this.pa.Fs())&&this.Fa.Bd()}}Object(m.a)(pD,"PPTDragSelectionDragAdapter",Mv.DragSelectionDragAdapter,[1003,274]);class lK{constructor(a,b,c){this.We=a;this.h$=b;this.zc=c}v0c(a,b){if(!a||!b)return!1;b=b.qc(this.We);return b?(b=Bd.a.ki(b.htmlElement))?!!a&&!!b&&a.x>=b.x&&a.y>=b.y&&a.x<=b.x+b.width&&a.y<=b.y+b.height:!1:!1}x7d(a,b,c=null,f=null){return(a=
this.g0f(a,b,c,f))?a.mz():null}g0f(a,b,c=null,f=null){if(!a||!b)return null;c&&f||(f=this.V8f(b),c=this.Zae(b));if(!(c&&f&&c.length&&f.length))return null;var l=b.qc(this.We);if(!l)return null;var y=Bd.a.ki(l.htmlElement);if(!y)return null;l=a.x-y.x;y=a.y-y.y;var H=0;for(a=0;a<c.length&&!(H+=c[a],H>=y);a++);for(H=y=0;H<f.length&&!(y+=f[H],y>=l);H++);a=Math.min(a,c.length-1);H=Math.min(H,f.length-1);return 0>a||a>=c.length||0>H||H>=f.length?null:b.ef(a,H)}Zae(a){if(a){a=this.zc.Zka(a);if(!a||!a.length)return null;
const c=a.length,f=Array(c);for(let l=0;l<c;l++){var b=a[l].qc(this.We);if(!b)return null;b=Bd.a.ki(b.htmlElement);f[l]=b.height}return f}return null}V8f(a){if(a){a=Qn.b(Object(qa.a)(pg.a,a));if(!a||!a.length)return null;const b=a.length,c=Array(b);for(let f=0;f<b;f++)c[f]=this.h$.Ne(a[f],0);return c}return null}}Object(m.a)(lK,"PptTableDragSelectionHelper",null,[437]);var ms=d(657),Az=d(348);class mK{constructor(a,b,c,f,l,y,H){this.ua=this.Wm=null;if(!a)throw Error.argumentNull("actionManager");
if(!b)throw Error.argumentNull("activeSlideViewManager");if(!f)throw Error.argumentNull("pageView");if(!l)throw Error.argumentNull("insertShapeOverlayViewStateManager");if(!y)throw Error.argumentNull("insertShapeOverlayViewElement");if(!H)throw Error.argumentNull("graphTopologyManager");this.ia=a;this.Kc=b;this.wi=c;this.Gb=f;this.XXa=l;this.lfa=y;this.ta=H}Mv(a){try{return a?a.LA===Sys.UI.MouseButton.rightButton?!1:2===this.XXa.Fkg?!0:!1:(xa.a.J(512336010,822,10,"Event argument is null in isDragPossible for shapes"),
!1)}catch(b){throw xa.a.J(512336009,822,10,"Exception {0} occured in isDragPossible for shapes",b),b;}}Yu(a){try{if(!a)return xa.a.J(512336008,822,10,"Event argument is null in OnDragStart for shapes"),!1;if(!this.Mv(a))return!1;this.lfa.Al(Ki.a.jPb);this.Wm=ms.a(a.clientPoint,this.Kc.Jc);const b=new Xi.a;b.left=this.Wm.x;b.top=this.Wm.y;b.bottom=this.Wm.y+5;b.right=this.Wm.x+5;a={};a.offsets=b;a.insertShapeActionId=this.lfa.jAb;a.insertLocalShape=!0;if(32!=this.ia.Ka(ea.a.t_c,2,a))return!1;this.ua=
a.node;return!0}catch(b){throw xa.a.J(512336007,822,10,"Exception {0} occured in OnDragStart for shapes",b),b;}}Rw(a){try{if(!a)return xa.a.J(512336006,822,10,"Event argument is null in OnDragMove for shapes"),!1;if(!this.Gb.isActive)return!1;const b=ms.a(a.clientPoint,this.Kc.Jc),c=ms.b(this.Dwd(Math.min(this.Wm.y,b.y)-this.Wm.y),this.Dwd(Math.max(this.Wm.y,b.y)-this.Wm.y-5),this.Dwd(Math.min(this.Wm.x,b.x)-this.Wm.x),this.Dwd(Math.max(this.Wm.x,b.x)-this.Wm.x-5));Object(qa.a)(Az.a,this.ua.qc(0)).setOffsets(c,
!0);return!0}catch(b){throw xa.a.J(512336005,822,10,"Exception {0} occured in OnDragMove for shapes",b),b;}}to(a){try{if(a)if(this.Wm){var b=ms.a(a.clientPoint,this.Kc.Jc),c=ms.b(Math.min(this.Wm.y,b.y),Math.max(this.Wm.y,b.y),Math.min(this.Wm.x,b.x),Math.max(this.Wm.x,b.x));a={};a.offsets=c;a.insertShapeActionId=this.lfa.jAb;a.insertLocalShape=!1;this.tSf();this.ia.Ka(ea.a.t_c,2,a);this.lL()}else xa.a.J(512336003,822,10,"m_dragBeginPosition should not be null in OnDragEnd for shapes");else xa.a.J(512336004,
822,10,"Event argument is null in OnDragEnd for shapes")}catch(f){throw xa.a.J(512336002,822,10,"Exception {0} occured in OnDragEnd for shapes",f),f;}}Au(){this.lL()}dispose(){this.lL()}Dwd(a){return this.wi.cN(a,this.Kc.Jc.UT)}lL(){this.Wm=null;this.ua&&(this.tSf(),this.XXa.H6e(0),this.ua=null)}tSf(){this.ta.Ba.YR([this.ua])}}Object(m.a)(mK,"ShapeDrawDragAdapter",null,[274,107]);class Nx{constructor(a,b){this.ZBg=null;this.GDb=-1;this.RDe=a;this.Tgk=b}Yu(a){return this.W8g(a)?(this.RDe.lld(),!0):
!1}Rw(a){if(!a)return!1;this.Tgk?(this.ZBg=a,this.xfl()):this.HLe(a);return!0}to(a){this.jKh()&&this.oVf(0);this.T8g(a);this.RDe.Grc()}Au(){this.jKh();this.R8g();this.RDe.Grc()}xfl(){-1===this.GDb&&(this.GDb=window.requestAnimationFrame(Object(I.a)(this,this.oVf,"dragMoveTask")))}jKh(){return-1!==this.GDb?(window.cancelAnimationFrame(this.GDb),this.GDb=-1,!0):!1}oVf(){this.HLe(this.ZBg);this.GDb=-1}}Object(m.a)(Nx,"ShapeDragAdapter",null,[274]);class nK extends Nx{constructor(a,b,c,f,l,y,H,Q,ia,wa,
Ua,kb,Gb,ec,dc,Fc,yc,tc){super(ec,Fc);this.qfc=0;this.nfc=this.yp=this.PO=this.WBg=null;this.UHa=!1;this.Gb=a;this.ia=b;this.v0=c;this.Uq=f;this.Ts=l;this.qD=y;this.kb=H;this.IB=Q;this.xD=ia;this.Ga=wa;this.zc=Ua;this.le=kb;this.ckc=Gb;this.kq=dc;this.zA=yc;this.Up=tc}Mv(a){return this.mJ(a).returnValue}mJ(a){let b;var c=[];b=!1;if(!a||a.LA!==Sys.UI.MouseButton.leftButton||this.qD.c0)return{returnValue:!1,Clc:c,Pcc:b};const f=Object(qa.a)(341,this.xD.$I(a.Bc));if(!f||!f.jne(a.Bc))return{returnValue:!1,
Clc:c,Pcc:b};if((b=f.isSelected)||f.shapeNode.Ug){c=[];a=Object(qa.a)(119,this.xD.$I(a.Bc));a.shapeNode.Of&&this.kb.FSf(a.shapeNode);a=this.kb.Qf();for(const l of a)if(l.get_smartArtModelId()){c.push(this.Ga.Gr(l));break}else c.push(l);c=Kj.d(c,this.Gb.Na);for(const l of c)if(!this.Mng(l))return{returnValue:!1,Clc:c,Pcc:b}}else{if(!this.Mng(f))return{returnValue:!1,Clc:c,Pcc:b};Array.add(c,f)}return{returnValue:!0,Clc:c,Pcc:b}}Mng(a){return a&&a.gb&&a.gb.oJ&&a.gb.EB&&!a.shapeNode.lJ&&32===this.ia.Ka(ea.a.tSe,
1,a.gb)?!0:!1}W8g(a){var b;let c;if(!({Clc:b,Pcc:c}=this.mJ(a)).returnValue)return!1;this.ia.processAction(ea.a.K8a,2);this.WBg=Zc.a.yTa(a.clientPoint);this.nfc=Object(qa.a)(341,this.xD.$I(a.Bc));null!==this.v0&&this.v0.Al(3);if(!this.nfc||!b||!b.length)return!1;null!==this.kq&&this.kq.cza(Ki.a.Eza);this.nfc.shapeNode.Lv||(this.kb.kj(),this.IB.Bd());for(a=0;a<b.length;++a)this.HIc(b[a]);c||(this.kb.setSelection(Od.SelectionFactory.nl(this.yp[0].gb)),this.Ts.Aw());for(b=0;b<this.yp.length;++b)this.yp[b].mE(!0);
this.UHa=1<this.yp.length?!1:!0;this.qfc=Date.now();this.zA&&this.kb.$L()&&this.le.ATe();this.Up&&this.ia.processAction(C.a.Bka,2);return!0}HIc(a){this.yp||(this.yp=[]);this.PO||(this.PO=[]);Array.add(this.yp,a);Array.add(this.PO,new Zc.a(a.x,a.y))}HLe(a){if(a){var b=this.kWc(Zc.a.yTa(a.clientPoint),this.WBg);a=null;var c=this.UHa&&!this.nfc.shapeNode.Lv;for(let f=0;f<this.yp.length;++f)a=Zc.a.add(this.PO[f],b),this.yp[f].setPosition(a.x,a.y,!c);b=this.ckc.Tah(!1,this.UHa,this.yp[0],null);c&&!b&&
a&&this.yp[0].setPosition(a.x,a.y,!0)}}kWc(a,b){a=Zc.a.rV(a,b);return new Zc.a(this.Uq.om(a.x),this.Uq.om(a.y))}T8g(a){const b=[];for(var c=0;c<this.yp.length;++c){var f=this.yp[c].wUc();Array.add(b,new Lv(this.yp[c].shapeNode,f));this.yp[c].cA(!1);if(f=this.zc.ZN(this.yp[c].shapeNode))f=f.Op(),xa.a.J(512497684,815,50,"Drag to move table, isComplexTable:{0}",f)}this.nfc.shapeNode.Lv||(c={},a&&a.mc&&a.mc.rawEvent&&(c[hh.a.kEa]=a.mc.rawEvent.timeStamp),this.ia.Ka(ea.a.BJa,2,b,c));1===b.length&&(xa.a.J(512497683,
815,50,"ShapeMoveDragAdapter - moving shape {0} - timespan by {1}",this.yp[0].shapeNode?this.yp[0].shapeNode.Kr:"",(Date.now()-this.qfc).toString()),this.zA&&this.kb.$L()&&(a=this.kb.dFa(),this.le.Jjb(new Mx.a(a))));this.J3()}R8g(){if(this.yp){for(let a=0;a<this.yp.length;++a)this.yp[a].setPosition(this.PO[a].x,this.PO[a].y,!0),this.yp[a].cA(!0);this.J3()}}J3(){this.ckc.Xah(this.UHa);null!==this.v0&&this.v0.D1();this.Gb.mS();this.PO=this.yp=null;null!==this.kq&&this.kq.Eya()}}Object(m.a)(nK,"ShapeMoveDragAdapter",
Nx,[]);class qD{constructor(a){this.k7c=this.G0=this.e1=this.qic=this.O0=null;this.Yd=a}Eml(a,b,c,f,l){this.O0=a;this.qic=b;this.e1=c;this.G0=f;this.k7c=l}}Object(m.a)(qD,"ResizeShapesCalculationData",null,[]);var rD=d(633);class Uk{static CXd(a,b,c,f,l){return f?Uk.uHf(a,c):Uk.Wvi(a,b,c,l)}static uHf(a,b){const c=new Xi.a;if(a.equals(qe.a.Wu)||a.hBb(qe.a.Wu))c.left=b.x,c.top=b.y;else if(a.equals(qe.a.jF)||a.hBb(qe.a.jF))c.right=b.x,c.bottom=b.y;return c}static Wvi(a,b,c,f){b=a.Eac()?Uk.Mvi(a,b,c,
f):Uk.Yvi(a,b,c);c=new Xi.a;if(a.hBb(qe.a.north)||a.equals(qe.a.north))c.top=-1*b.y;if(a.hBb(qe.a.east)||a.equals(qe.a.east))c.right=b.x;if(a.hBb(qe.a.south)||a.equals(qe.a.south))c.bottom=b.y;if(a.hBb(qe.a.west)||a.equals(qe.a.west))c.left=-1*b.x;return c}static Mvi(a,b,c,f){var l=b.Tj(a),y=b.Tj(a.p$a()),H=b.Tj(a.F6i());a=b.Tj(a.G6i());var Q=new Zc.a(l._x+c.x,l._y+c.y);const ia=rD.b(y,H,Q);b=rD.b(y,a,Q);c=Uk.EYd(y,H,ia);l=Uk.EYd(y,a,b);b=Zc.a.Ql(b,Q);Q=Zc.a.Ql(ia,Q);H=Zc.a.Ql(y,H);y=Zc.a.Ql(y,a);
f?(y||(xa.a.J(8959632,822,10,"ResizeHelper - shape has height 0"),y=1),H||(xa.a.J(8959634,822,10,"ResizeHelper - shape has width 0"),H=1),f=H/y,!Q||b/Q>f?(b<Uk.p3&&(b=Uk.p3),Q=b/f,Q<Uk.p3&&(Q=Uk.p3,b=Q*f)):(Q<Uk.p3&&(Q=Uk.p3),b=Q*f,b<Uk.p3&&(b=Uk.p3,Q=b/f))):(b<Uk.p3&&(b=Uk.p3),Q<Uk.p3&&(Q=Uk.p3));return new Zc.a(b*c-H,Q*l-y)}static Yvi(a,b,c){var f=a.mWc();a=a.xyb();f=b.Tj(f);var l=b.Tj(a);b=b.Tj(a.p$a());a=Zc.a.lab(f,l);a.IM(c.x,c.y);c=rD.b(b,f,a);a=Zc.a.Ql(b,c);l=Zc.a.Ql(f,b);a<Uk.p3&&(a=Uk.p3);
f=a*Uk.EYd(b,f,c)-l;return new Zc.a(f,f)}static EYd(a,b,c){return b._x!==a._x?0>(c._x-a._x)/(b._x-a._x)?-1:1:0>(c._y-a._y)/(b._y-a._y)?-1:1}}Uk.p3=6;Object(m.a)(Uk,"ResizeHelper",null,[]);class jt extends Nx{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc){super(Ua,ec);this.nma=this.L0=this.aIa=this.Vte=this.Wte=this.Yd=this.oG=null;this.UHa=!1;this.zR=this.lR=null;this.Gb=a;this.ia=b;this.qD=c;this.$Ya=f;this.IB=l;this.xD=y;this.wi=H;this.le=Q;this.Ga=ia;this.ckc=wa;this.zA=dc;this.kq=kb;this.$e=
Gb;this.Up=Fc}Mv(a){if(!a||a.LA===Sys.UI.MouseButton.rightButton)return!1;this.zR=[];this.Yd=Object(qa.a)(119,this.xD.$I(a.Bc));if(!this.Yd||!this.Yd.aD(a.Bc))return!1;a=this.Yd.shapeNode;if(!a||!a.isResizable||this.qD.c0)return!1;this.oG=[];if(a.rz)Array.add(this.oG,this.Yd);else{var b=this.$Ya.Xd();(b=this.Ga.W$a(b))&&this.$Ya.xpd(b);a.Of&&this.$Ya.FSf(a);b=this.$Ya.Qf();this.oG=Kj.d(b,this.Gb.Na)}if(this.Ga.x4(this.Yd.shapeNode))Array.add(this.zR,new qD(this.Yd));else for(const c of this.oG){if(!this.Z2j(c))return this.zR=
null,!1;c.shapeNode.isResizable&&!c.shapeNode.vd&&Array.add(this.zR,new qD(c))}return!0}Z2j(a){return 32!==this.ia.Ka(ea.a.tSe,1,a.gb)||this.qD.c0||!a.OQ?!1:!0}W8g(a){if(!a||!this.Mv(a))return!1;this.$Ya.kj();this.IB.Bd();this.ia.processAction(ea.a.K8a,2);this.nma=this.Yd.c7b();if(!this.Yd.aD(a.Bc))return!1;null!==this.kq&&this.kq.cza(Ki.a.jPb);this.lR=this.K$f(this.Yd.aD(a.Bc),this.Yd,this.nma,!1);this.aIa=this.Ksa(a.clientPoint);({width:this.Wte,height:this.Vte}=this.EHf(this.nma,this.Yd.shapeNode.e0));
this.L0=new Zc.a(0,0);for(const c of this.zR){var b=c.Yd.c7b();a=c.Yd;let f,l;({width:f,height:l}=this.EHf(b,this.Yd.shapeNode.e0));const y=this.K$f(this.lR,a,b,!0);c.Eml(b,a.e_a,f,l,y);a.XL=!0;a.mE(!0);b=Kj.c(a.shapeNode,this.Gb.Na);a.shapeNode.Of&&b.Fk&&(b.Fk.visible=!0)}this.UHa=this.Ga.x4(this.Yd.shapeNode)?!0:1<this.oG.length?!1:!0;this.zA&&this.$Ya.$L()&&this.le.ATe();this.Up&&this.ia.processAction(C.a.Bka,2);return!0}HLe(a){if(a){var b=this.Ksa(a.clientPoint),c=Zc.a.rV(b,this.aIa);this.L0=
Zc.a.add(this.L0,this.L$f(c,this.nma,!1));var f=null;c=this.UHa&&!this.Yd.shapeNode.Lv;for(const l of this.zR){let y=new Zc.a(l.e1/this.Wte*this.L0.x,l.G0/this.Vte*this.L0.y);new Xi.a;if(l.Yd.shapeNode.rz){this.Yd.shapeNode.rz&&(y=this.L0);if(!l.k7c)continue;f=Uk.uHf(l.k7c,y)}else f=Uk.CXd(l.k7c,l.O0,this.L$f(y,l.O0,!0),l.Yd.shapeNode.rz,l.Yd.shapeNode.isAspectRatioLocked||a.shiftKey);f=Xi.a.add(l.qic,this.n1f(f,l.O0));l.Yd.setOffsets(f,!c);l.Yd.shapeNode.Of&&l.Yd.shapeNode.isEditable&&l.Yd.oge()}this.aIa=
b;a=this.ckc.Tah(!0,this.UHa,this.Yd,this.lR);c&&!a&&f&&this.Yd.setOffsets(f,!0)}}n1f(a,b){if(this.Ga.x4(this.Yd.shapeNode))return a;const c=new Xi.a;c.left=b.h1c?a.right:a.left;c.right=b.h1c?a.left:a.right;c.top=b.fcb?a.bottom:a.top;c.bottom=b.fcb?a.top:a.bottom;return c}T8g(a){const b=[];for(var c=0;c<this.zR.length;c++){let f=Xi.a.rV(this.zR[c].Yd.e_a,this.zR[c].qic);f=this.n1f(f,this.zR[c].O0);Array.add(b,new zz(this.zR[c].Yd.shapeNode,f,this.lR,this.L0));this.zR[c].Yd.shapeNode.Of&&this.zR[c].Yd.shapeNode.isEditable||
(this.zR[c].Yd.XL=!1);this.zR[c].Yd.cA(!1)}this.Yd.shapeNode.Lv?Rc.App.Lb.updateCommandUI():(c={},a&&a.mc&&a.mc.rawEvent&&(c[hh.a.kEa]=a.mc.rawEvent.timeStamp),this.Ga.x4(this.Yd.shapeNode)?(this.Yd.hEa(),this.ia.Ka(ea.a.vrh,2,b,c)):this.ia.Ka(ea.a.qkb,2,b,c));this.zA&&this.$Ya.$L()&&(a=this.$Ya.dFa(),this.le.Jjb(new Mx.a(a)));this.lL()}R8g(){if(this.zR){for(const a of this.zR)a.Yd.setOffsets(a.qic,!0),a.Yd.XL=!1,a.Yd.cA(!0);this.lL()}}lL(){this.ckc.Xah(this.UHa);this.nma=this.Vte=this.Wte=this.Yd=
this.oG=this.zR=this.lR=this.L0=this.aIa=null;null!==this.kq&&this.kq.Eya()}EHf(a,b){let c;var f=b?this.F9d(a):a;c=Zc.a.Ql(f.ga(0),f.ga(1));f=Zc.a.Ql(f.ga(0),f.ga(3));b||(a=xe.a.XM(Zc.a.JF(a.ga(0),a.ga(1))),Math.floor((a+45)/90)%2&&(a=f,f=c,c=a),c||(xa.a.J(17622149,822,10,"ShapeResizeDragAdapter - shape {0} has width 0",this.Yd.shapeNode.Kr),c=1),f||(xa.a.J(17622151,822,10,"ShapeResizeDragAdapter - shape {0} has height 0",this.Yd.shapeNode.Kr),f=1));return{width:c,height:f}}K$f(a,b,c,f){if(b.shapeNode.rz){if(this.Yd.shapeNode.rz)return a;
if(a.equals(qe.a.VE)||a.equals(qe.a.dI))return null;if(a.equals(qe.a.Wu)||a.equals(qe.a.jF))return c.ga(0).x>c.ga(1).x?a.p$a():a;if(b.shapeNode.e0){f=xe.a.XM(Zc.a.JF(c.ga(0),c.ga(1)));if(a.equals(qe.a.north)||a.equals(qe.a.south))return Math.abs(f-90)<jt.Whc||Math.abs(f-270)<jt.Whc?c.ga(0).y<c.ga(1).y?a:a.p$a():null;if(a.equals(qe.a.east)||a.equals(qe.a.west))if(Math.abs(f-180)<jt.Whc||360-f<jt.Whc||f<jt.Whc)return c.ga(0).x<c.ga(1).x?a:a.p$a()}return null}c=Zc.a.JF(c.ga(0),c.ga(1));c=Math.floor((c+
Math.PI/4)/(Math.PI/2));for(b=0;b<c;b++)a=f?a.mWc().mWc():a.xyb().xyb();return a}L$f(a,b,c){if(this.Yd.shapeNode.rz||this.Ga.x4(this.Yd.shapeNode))return a;var f=Zc.a.JF(b.ga(0),b.ga(1));const l=Math.floor((f+Math.PI/4)/(Math.PI/2))%4;f=b.ga(3-l);b=b.ga(3>l?2-l:3);f=Zc.a.JF(f,b);return c?new Zc.a(Math.cos(f)*a.x-Math.sin(f)*a.y,Math.sin(f)*a.x+Math.cos(f)*a.y):new Zc.a(Math.cos(f)*a.x+Math.sin(f)*a.y,Math.cos(f)*a.y-Math.sin(f)*a.x)}Ksa(a){var b=this.Yd.s3(this.wi.om(a.x)),c=this.Yd.s3(this.wi.om(a.y));
if(this.Ga.x4(this.Yd.shapeNode)){c=this.lR;this.lR.Eac()||(c=c.xyb());b=this.$e.ki(this.Yd.eRa);b.x+=se.a.jtd;b.y+=se.a.jtd;b.width-=2*se.a.jtd;b.height-=2*se.a.jtd;var f=fj.a.Lda(b);b=f.Tj(c);f=f.Tj(c.p$a());c=b.y<=f.y?Math.min(a.y,f.y):Math.max(a.y,f.y);b=this.Yd.s3(this.wi.om(b.x<=f.x?Math.min(a.x,f.x):Math.max(a.x,f.x)));c=this.Yd.s3(this.wi.om(c))}return new Zc.a(b,c)}F9d(a){const b=Zc.a.lab(a.ga(0),a.ga(3));a=Zc.a.lab(a.ga(1),a.ga(2));return new fj.a(new Zc.a(b.x,b.y),new Zc.a(a.x,b.y),new Zc.a(a.x,
a.y),new Zc.a(b.x,a.y))}}jt.Whc=3;Object(m.a)(jt,"ShapeResizeDragAdapter",Nx,[]);var oK=d(198);class Bz{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb){this.dCe=this.DDe=null;this.pic=0;this.jFe=this.Mjc=null;this.e7c=0;this.lNg=8;this.EWg=4;this.vek="AngleUIRendered";this.KE=this.Yd=null;this.Gb=a;this.ia=b;this.qD=f;this.v0=c;this.pa=l;this.IB=y;this.xD=H;this.wi=Q;this.jc=ia;this.ke=wa;this.kq=Ua;this.Up=kb;this.DHa=Gb}Mv(a){if(!a||a.LA!==Sys.UI.MouseButton.leftButton||this.qD.c0)return!1;this.Yd=
Object(qa.a)(119,this.xD.$I(a.Bc));return this.Yd&&this.Yd.vpe(a.Bc)?(this.KE=this.Yd.shapeNode)&&this.KE.YL&&this.Yd.OQ?!0:!1:!1}Yu(a){if(!a||!this.Mv(a))return!1;this.pa.kj();this.IB.Bd();this.ia.processAction(ea.a.K8a,2);null!==this.kq&&this.kq.cza(rb.a.QN(this.ke.qk("rotatehandlecursor.cur"),Ki.a.GFh));this.pic=this.KE.get_shapeRotation();this.Mjc=this.Yd.c7b().Zf();this.jFe=this.Yd.Mxb().Zf();this.DDe=this.Ksa(a.clientPoint);this.Yd.Qla=!0;this.DHa&&this.A_e(!0);this.Yd.mE(!0);this.Up&&this.ia.processAction(C.a.Bka,
2);return!0}Rw(a){if(!a)return!1;this.dCe=this.Ksa(a.clientPoint);if(!this.dCe)return!1;this.e7c=xe.a.XM(Zc.a.JF(this.dCe,this.Mjc))-xe.a.XM(Zc.a.JF(this.DDe,this.Mjc));let b=this.pic+this.e7c;this.DHa&&(b=this.aEh(b));this.Yd.setRotation(Math.round(b),this.jFe);this.DHa&&(a=this.Ksa(a.clientPoint,!1),this.VPl(a,Math.round(b)));return!0}aEh(a){return this.tpi(a)?10*Math.round(a/10):a}tpi(a){0>a&&(a=(a+360)%360);return(a+this.EWg/2)%90<=this.EWg?!0:!1}VPl(a,b){var c=this.jc.mg(this.Yd.gb);c=Kj.e(c,
this.Gb.Na);c.Vrc.jC(2);c.Vrc.setPosition(a.x+this.lNg,a.y+this.lNg);c.Vrc.va.style.position="absolute";0>b&&(b+=360);c.Vrc.va.innerText=(b%360).toString()+"\u00b0"}A_e(a){const b=this.jc.mg(this.Yd.gb);Kj.e(b,this.Gb.Na).Vrc.Sd(a)}to(a){this.DHa&&this.A_e(!1);this.Yd.Qla=!1;this.Yd.cA(!1);var b=this.pic+this.e7c;this.DHa&&(b=this.aEh(b));b=new fp(this.KE,Math.round(b));const c={};a&&a.mc&&a.mc.rawEvent&&(c[hh.a.kEa]=a.mc.rawEvent.timeStamp);this.DHa&&(c[this.vek]=1);this.ia.Ka(ea.a.Prc,2,b,c);this.J3()}Au(){this.Mjc&&
(this.Yd.setRotation(this.pic,this.jFe),this.DHa&&this.A_e(!1),this.Yd.Qla=!1,this.Yd.cA(!0),this.J3())}Ksa(a,b=!0){var c=this.jc.mg(this.Yd.gb);return(c=Kj.e(c,this.Gb.Na).gC)?(a=Zc.a.yTa(oK.a.RTa(a,c)),b?new Zc.a(this.Yd.s3(this.wi.om(a.x)),this.Yd.s3(this.wi.om(a.y))):a):null}J3(){null!==this.v0&&this.v0.D1();null!==this.kq&&this.kq.Eya();this.Gb.mS();this.DDe=null;this.pic=0;this.Mjc=null;this.e7c=0;this.Yd=this.KE=null}static getInstance(a){return Bz.XC(a)}static XC(a){return new Bz(a,Ib.a.instance.resolve("Common.IActionManagerExtended"),
Ib.a.instance.resolve("Common.ICursorPinningTool"),Ib.a.instance.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),Ib.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),Ib.a.instance.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),Ib.a.instance.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),Ib.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion"),Ib.a.instance.resolve("PowerPointWebEditor.ISlideReader"),Ib.a.instance.resolve("PowerPoint.IPathManager"),
Ib.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?Ib.a.instance.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,Ib.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,Ib.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").dQe)}}Object(m.a)(Bz,"ShapeRotateDragAdapter",null,[274]);var Ox=d(385);class pK{constructor(a,b,c,f,l){this.Wm=this.Rr=null;if(!a)throw Error.argumentNull("actionManager");
if(!b)throw Error.argumentNull("activeSlideViewManager");if(!c)throw Error.argumentNull("pageView");if(!f)throw Error.argumentNull("insertShapeOverlayViewStateManager");if(!l)throw Error.argumentNull("insertShapeOverlayViewElement");this.ia=a;this.Kc=b;this.Gb=c;this.XXa=f}f_i(){if(this.Rr)return this.Rr;this.Rr=new Im.a;this.Rr.Dr("MarqueeDiv");this.Rr.Zj(0);this.Rr.va.style.borderStyle="solid";this.Rr.va.style.borderWidth="thin";this.Rr.va.style.borderColor="black";this.Rr.va.style.opacity="0.5";
this.Rr.Sd(!1);return this.Rr}zLh(a,b){this.Rr&&this.Rr.ah(a,b)}yLh(a,b){this.Rr&&this.Rr.setPosition(a,b)}lL(){this.Wm=null;this.Rr&&(this.Rr.Sd(!1),this.Rr.Dq())}BVd(a){const b=this.Kc.Jc;if(!b||!b.we||!b.we.va)return xa.a.J(512497682,822,10,"Unable to attach marquee element to the slide view element"),!1;b.we.va.appendChild(a.va);a.jC(2+Ox.a.wha);a.Sd(!0);return!0}Mv(a){try{return a?a.LA===Sys.UI.MouseButton.rightButton?!1:1===this.XXa.Fkg?!0:!1:(xa.a.J(512497681,822,10,"Event argument is null in isDragPossible"),
!1)}catch(b){throw xa.a.J(512497680,822,10,"Exception {0} occured in isDragPossible",b),b;}}Yu(a){try{if(!a)return xa.a.J(512497679,822,10,"Event argument is null in OnDragStart"),!1;if(!this.Mv(a))return!1;this.Wm=ms.a(a.clientPoint,this.Kc.Jc);const b=this.f_i();if(!this.BVd(b))return!1;this.yLh(this.Wm.x,this.Wm.y);this.zLh(0,0);return!0}catch(b){throw xa.a.J(512497678,822,10,"Exception {0} occured in OnDragStart",b),b;}}Rw(a){try{if(!a)return xa.a.J(512497677,822,10,"Event argument is null in OnDragMove"),
!1;if(!this.Gb.isActive)return!1;const b=ms.a(a.clientPoint,this.Kc.Jc),c=Math.min(this.Wm.x,b.x),f=Math.min(this.Wm.y,b.y),l=Math.max(this.Wm.x,b.x),y=Math.max(this.Wm.y,b.y);this.yLh(c,f);this.zLh(l-c,y-f);return!0}catch(b){throw xa.a.J(512497676,822,10,"Exception {0} occured in OnDragMove",b),b;}}to(a){try{if(a)if(this.Wm){var b=ms.a(a.clientPoint,this.Kc.Jc),c=ms.b(Math.min(this.Wm.y,b.y),Math.max(this.Wm.y,b.y),Math.min(this.Wm.x,b.x),Math.max(this.Wm.x,b.x));this.ia.Ka(ea.a.D_c,2,c);eb.a("TelemetryForClickAndDragOperation")&&
xa.a.J(512497673,822,50,"TextboxDrawDragAdapter::OnDragEnd");this.lL()}else xa.a.J(512497674,822,10,"m_dragBeginPosition should not be null in OnDragEnd");else xa.a.J(512497675,822,10,"Event argument is null in OnDragEnd")}catch(f){throw xa.a.J(512497672,822,10,"Exception {0} occured in OnDragEnd",f),f;}}Au(){this.lL()}dispose(){this.lL();this.Rr=null}}Object(m.a)(pK,"TextboxDrawDragAdapter",null,[274,107]);class kt{constructor(a,b,c){this.kbd=0;this.PO=null;this.Hdc=!1;this.wDe=this.u7c=null;this.KFb=
new Zc.a(0,0);this.xna=1;this.ij=a;this.Kc=b;this.Mgk=c;this.Mgk.aT(Object(I.a)(this,this.t_a,"onSlideNavigation"))}qub(a){return a?!0:!1}t_a(){this.xna=1;this.KFb=new Zc.a(0,0);this.setTransform(new Zc.a(0,0))}gBb(a){if(!a)return!1;a=this.Ncg(a.mc);return!!a&&1<a.length}mNe(a){if(!a)return!1;this.kbd=this.ij.eV;if(!this.gBb(a))return!1;this.PO=this.FWc(a.mc);return!1}nnc(a){if(!a)return!1;this.gBb(a)?(a=this.FWc(a.mc),this.PO||(this.PO=a),this.Jzd(this.lwi(this.PO,a))):this.FIk(a);return!0}FIk(a){a&&
(a=this.FWc(a.mc),this.Hdc?(a=this.nHf(this.u7c,a),this.setTransform(a)):(this.Hdc=!0,this.u7c=a))}to(a){if(this.Hdc&&a){a=this.FWc(a.mc);var b=this.nHf(this.u7c,a);a=b.x+this.KFb.x;b=b.y+this.KFb.y;this.Hdc=!1;this.KFb=new Zc.a(a,b)}}nHf(a,b){return!a||1>a.length||!b||1>b.length?new Zc.a(0,0):new Zc.a(b[0].x-a[0].x,b[0].y-a[0].y)}setTransform(a){if(this.Kc&&this.Kc.Jc&&this.Kc.Jc.UU){var b=this.Kc.Jc.UU;this.wDe||(this.wDe=b.style.cssText);b.style.cssText=this.wDe+"  width:100%;height:100%; transform:translate("+
(a.x+this.KFb.x+"px,"+(a.y+this.KFb.y)+"px) scale("+this.xna+","+this.xna+")")}}Knl(){this.setTransform(new Zc.a(0,0))}lJb(a){if(!a)return!1;this.to(a);this.kHl();return!1}Jzd(a){this.kbd&&(a*=this.kbd,a<kt.X3g?a=kt.X3g:a>kt.r3g&&(a=kt.r3g),this.ij.Dla=!1,this.xna=this.ij.eV=a,this.Knl())}mHf(a){if(!a||1>=a.length)return-1;const b=a.length;return Math.sqrt(Math.pow(a[0].x-a[b-1].x,2)+Math.pow(a[0].y-a[b-1].y,2))}lwi(a,b){a=this.mHf(a);b=this.mHf(b);return-1!==a&&-1!==b&&a?b/a:0}Ncg(a){let b=null;
if(!a)return null;a=a.rawEvent?a.rawEvent:a;a.touches&&(b=a.touches,!b.length&&a.changedTouches&&(b=a.changedTouches));return b}FWc(a){let b=null;a=this.Ncg(a);if(!a)return b;b=[];for(const c of a)Array.add(b,new Zc.a(c.screenX,c.screenY));return b}kHl(){this.kbd=0;this.PO=null;this.Hdc=!1;this.u7c=null}}kt.X3g=1;kt.r3g=5;Object(m.a)(kt,"ZoomSettingTouchAdapter",null,[475]);var lR=d(428);class qK{constructor(a,b,c,f,l,y){this.MCe=!1;this.Wm=null;this.DBe=!1;this.Gb=a;this.WJ=b;this.kb=c;this.Kc=f;
this.Fa=l;this.ta=y;this.Rr=new Im.a;this.Rr.Dr("Marquee");this.Rr.Zj(0);this.Rr.va.style.backgroundColor="darkgrey";this.Rr.va.style.opacity="0.5";this.Rr.Sd(!1)}BVd(){this.Rr&&(this.Kc.Jc.we.va.appendChild(this.Rr.va),this.MCe=!0)}lL(){this.Wm=null;this.Rr&&(this.Rr.Sd(!1),this.Rr.Dq(),this.MCe=!1);this.DBe=!1}Mv(a){if(!a||a.LA===Sys.UI.MouseButton.rightButton)return!1;a=new lR.a(a,this.Gb);return this.Gb.lcc(a)}Yu(a){if(!a||!this.Gb.isActive||!this.Mv(a))return!1;this.WJ.Nkh(new Rp(!0));a.ctrlKey||
a.shiftKey?xa.a.J(8959586,816,50,"MarqueeSelectDragAdapter used: Ctrl {0}, Shift {1}",a.ctrlKey,a.shiftKey):this.kb.nh();this.Fa.Bd();this.DBe=a.shiftKey?!0:!1;this.Wm=this.Ksa(a.clientPoint);this.MCe||this.BVd();this.Rr.setPosition(this.Wm.x,this.Wm.y);this.Rr.ah(0,0);this.Rr.jC(1+Ox.a.wha);this.Rr.Sd(!0);return!0}Rw(a){if(!a||!this.Gb.isActive)return!1;var b=this.Ksa(a.clientPoint);a=Math.min(this.Wm.x,b.x);const c=Math.min(this.Wm.y,b.y),f=Math.max(this.Wm.x,b.x);b=Math.max(this.Wm.y,b.y);this.Rr.setPosition(a,
c);this.Rr.ah(f-a,b-c);return!0}to(a){if(a){var b=this.Ksa(a.clientPoint);a=Math.min(this.Wm.x,b.x);var c=Math.min(this.Wm.y,b.y),f=Math.max(this.Wm.x,b.x);b=Math.max(this.Wm.y,b.y);var l=this.ta.Ba,y=l?l.Uj():[];l=[];var H=[],Q=this.kb.Xd();for(const ia of y)(y=Object(qa.a)(119,ia.qc(this.Gb.Na)))&&y.OQ&&(y.hq?y.nud():(y=y.jee(!1),y.ic>=a&&y.kc>=c&&y.fc<=f&&y.Zb<=b&&(this.DBe?Array.contains(Q,ia)?H.push(ia):l.push(ia):Array.contains(Q,ia)||l.push(ia))));0<l.length&&this.kb.d1a(l,!1);0<H.length&&
this.kb.bka(H);this.lL()}}Au(){this.Wm&&this.lL()}Ksa(a){const b=this.Kc.Jc.gC;return b?Zc.a.yTa(oK.a.RTa(a,b)):Zc.a.yTa(a)}dispose(){this.Wm&&this.lL();this.Rr=null}}Object(m.a)(qK,"MarqueeSelectDragAdapter",null,[274,107]);class rK{constructor(a){this.EX=null;this.Dri(a);this.Ife=!1}Dri(a){null!==a&&(this.EX=rb.a.$d(),this.EX.style.position=Ki.a.absolute,this.EX.style.top="0px",this.EX.style.left="0px",a.appendChild(this.EX))}cza(a){null!==a&&null!==this.EX&&null!==this.EX.parentNode&&(this.EX.style.cursor=
a,this.EX.style.zIndex=String(Ki.a.PVl),this.EX.style.height="100%",this.EX.style.width="100%",this.Ife=!0)}Eya(){if(null!==this.EX||this.Ife)this.EX.style.height="0px",this.EX.style.width="0px",this.EX.style.cursor=Ki.a.GFh,this.EX.style.zIndex="-1",this.Ife=!1}}Object(m.a)(rK,"CursorContainerManager",null,[436]);class sD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ShapeManipulation"}Yb(a){this.K=a;a.register(436,"PowerPointWebEditor.ShapeManipulation.ICursorContainerManager").ma().oa(()=>
new rK(a.resolve("PowerPointWebEditor.AppFrame").q2));a.register(oD,"PowerPointWebEditor.ShapeManipulationActor").ma().oa(()=>new oD(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),new Ip(a.resolve("Common.IActionManagerExtended")),a.resolve("Common.Transaction.ITransactionFactory"),
a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,a.resolve("PowerPointWebEditor.IApplicationSettings").xXe,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor"),
a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IZoomContext"),a.resolve("Common.Utils.IHighContrastDetector"),a.resolve("Gc2.IGlyphStore")));a.register(pD,"PowerPointWebEditor.ShapeManipulation.PPTDragSelectionDragAdapter").as("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter").ma().oa(()=>new pD(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.IActivityManager"),
a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IShapeReader"),sa.InteractiveViewManager.instance,a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?this.K.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):
null,a.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),a.resolve("PowerPointWebEditor.Graph.ITableReader")));a.register(437,"PowerPointWebEditor.IPptTableDragSelectionHelper").ma().oa(()=>new lK(a.resolve("Box4.IPageView").Na,a.resolve("Box4.IPageView").Md,a.resolve("PowerPointWebEditor.Graph.ITableReader")))}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTextEditOnlyMode||this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTouchZoomEnabled||
this.qMj();this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTouchZoomEnabled&&this.iNj();this.dMj()}iNj(){const a=this.K.resolve("PowerPointWebEditor.IZoomContext");this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").Y2k(new kt(a,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")))}qMj(){var a=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");const b=this.K.resolve("Common.IActionManagerExtended");
var c=this.K.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext");const f=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),l=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?null:this.K.resolve("Common.CursorManager"),y=this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),H=this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),Q=this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),ia=this.K.resolve("PowerPointWebEditor.ISlideReader"),
wa=this.K.resolve("PowerPointWebEditor.IShapeReader"),Ua=this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),kb=this.K.resolve("PowerPointWebEditor.ISmartGuideManager"),Gb=this.K.resolve("PowerPointWebEditor.Core.IPauseTheWorldManager"),ec=this.K.resolve("PowerPoint.IPathManager"),dc=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?this.K.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,Fc=!!window.requestAnimationFrame&&
!!window.cancelAnimationFrame;this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").OLb(2,this.K.resolve("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter"));this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").OLb(1,new nK(a,b,l,Q,this.K.resolve("Box4.IUndoManager"),c,f,y,H,wa,this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),Ua,kb,Gb,dc,Fc,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled),
new jt(a,b,c,f,y,H,Q,Ua,wa,kb,Gb,dc,this.K.resolve("PowerPoint.IBrowserHelperManager"),Fc,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled),new Bz(a,b,l,c,f,y,H,Q,ia,ec,dc,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").dQe),new qK(a,this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),
f,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));c=new mK(b,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),a,this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewElement"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"));
this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").Emh(c);this.K.resolve("PowerPointWebEditor.IApplicationSettings").kAb&&(a=new pK(b,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),a,this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewElement")),this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").Emh(a));xa.a.J(509691227,813,50,"Shape manipulation drag adapter init complete")}dMj(){const a=
this.K.resolve("PowerPointWebEditor.ShapeManipulationActor");a.pe();a.vb()}dispose(){}static main(){n.a.instance.Ac(new sD)}}Object(m.a)(sD,"PPTWebEditorShapeManipulationPackage",null,[2,3]);var mR=d(1191),Px=d(1249),vr=d(116);class Qx{constructor(a,b,c,f,l,y,H,Q){this.lCe=null;this.$Be=new Date;this.bR=a;this.ylk=b;this.Yrk=c;this.hfk=f;this.ilk=l;this.oIa=y;H.Hb(new dd.a(Q,2,this.hfk,Object(I.a)(this,this.HJf,"checkTask"),90,"61"))}HJf(){this.vKl()}vKl(){var a=new Date;const b=+new Date-+this.lCe>
this.Yrk;if(!(this.$Be<this.lCe)||b){if(+a-+this.$Be<this.ylk)return;this.bR()}a=+new Date-+a;a>this.ilk&&xa.a.J(8958035,813,10,"PrefetchManager::PrefetchThrottler::TryPrefetchIfAppropriate() took too long to check  prefetch: {0}ms for {1}",a,this.oIa)}Yvd(){this.lCe=new Date}Uvd(){this.$Be=new Date}}Object(m.a)(Qx,"PrefetchThrottler",null,[]);class aq{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc){this.Iqd=250;this.tgc=this.Mec=null;this.Wgc=this.Fgc=!1;this.vGb=[];this.zui=5;this.JGf=10;
this.wGb=[];this.Aui=5;this.JYa=!1;this.q1g=this.zJ=this.E5c=null;this.K$c=!1;this.tEe=[];this.Tb=a;this.ta=b;this.KB=c;this.Ej=f;this.jXa=l;this.xz=yc;this.Ofa=y;this.Ea=H;this.wb=Q;this.jc=ia;this.Rv=wa;this.EM=Ua;this.nd=kb;this.pqk=Gb;this.Mc=ec;this.el=dc;this.vy=Fc;this.fqk=this.Ea.e1j;this.mok=w.AFrameworkApplication.fa.ka("PrefetchThrottlerNormalPriorityEnabled");this.lok=w.AFrameworkApplication.fa.ka("PrefetchLookaheadSlideEnabled");!z.a.Vi||this.Ea.f1j?this.setEnabled(this.Ea.LUj,this.Ea.iYj):
this.setEnabled(!1,!1);this.Ybd=this.Ea.prefetchSlideForwardMax;this.Xbd=this.Ea.prefetchSlideBackwardMax;this.lgk=w.AFrameworkApplication.fa.ka("PodDisableAlwaysPrefetchSlidesInVisibleRange");this.kel=w.AFrameworkApplication.fa.wc("SlidePrefetchLookaheadCount",0);this.KH=!1;this.Mc.GC(Object(I.a)(this,this.OM,"onSessionClosed"));this.Mc.OQa(Object(I.a)(this,this.k1,"onSessionRehydrating"));this.Mc.HC(Object(I.a)(this,this.Mo,"onSessionRehydrated"));w.AFrameworkApplication.fa.ka("SlidePrefetchThrottlerMinDelayReduced")&&
(this.Iqd=125);this.vy&&this.vy.NFa(()=>{this.WAl()})}WAl(){this.q1g=new dd.a(2,1,this.Iqd,Object(I.a)(this,this.updateSlidePrefetchRange,"updateSlidePrefetchRange"),90,"59");this.K$c=!1;const a=this.mok?2:3;this.Mec=new Qx(Object(I.a)(this,this.tKl,"tryPrefetchContentModel"),this.Iqd,aq.lel,aq.Bth,aq.vth,"content model",this.wb,a);this.nd.Nsb(Object(I.a)(this,this.x_a,"onVisibleThumbnailsChanged"));this.el.FI(Object(I.a)(this,this.YB,"onActiveSlideChanged"));this.tgc=new Qx(Object(I.a)(this,this.wKl,
"tryPrefetchImages"),this.Iqd,aq.jel,aq.Bth,aq.vth,"image",this.wb,3);this.EM&&(this.EM.jja(Object(I.a)(this,this.Gvg,"loadedHandler")),this.EM.fk(Object(I.a)(this,this.Sih,"propertyChangedHandler")))}get Ef(){this.E5c&&this.E5c.isConnected||(this.E5c=this.Tb.Ef);return this.E5c}get Ba(){this.zJ||(this.zJ=this.ta.Ba);return this.zJ}setEnabled(a,b){this.Fgc=a;this.Wgc=b}Ihd(){this.vGb=[];this.wGb=[];this.JYa=!1}dispose(){this.nd.qph(Object(I.a)(this,this.x_a,"onVisibleThumbnailsChanged"));this.el.s6(Object(I.a)(this,
this.YB,"onActiveSlideChanged"));this.Mc.Laa(Object(I.a)(this,this.OM,"onSessionClosed"));this.Mc.hpd(Object(I.a)(this,this.k1,"onSessionRehydrating"));this.Mc.zga(Object(I.a)(this,this.Mo,"onSessionRehydrated"));this.EM&&(this.EM.A0a(Object(I.a)(this,this.Gvg,"loadedHandler")),this.EM.Om(Object(I.a)(this,this.Sih,"propertyChangedHandler")))}OM(){this.KH=!0}k1(){this.Ihd()}Mo(){this.KH=!1}tKl(){this.Fgc&&this.QAh()&&this.nSk()}nSk(){var a=this.eee();const b=this.JYa?null:Yr.b(a,c=>c?c.Db:null);(a=
this.zfh(0,a))?(a=a.Db,this.Mec&&this.Mec.Yvd(),this.Rv.prefetchSlide(a,b,(c,f)=>{this.JYa=!0;eb.a("InvalidateThumbAfterSlideFetch")&&(xa.a.J(508903936,813,50,"prefetchBestSlide: Successfully fetched slide:{0}, isSlideStale:{1}",c,f),(f=this.Ofa.VF(c))?(f=f.getImageId(),this.KB.eac(c,f)):xa.a.J(508903907,813,10,"prefetchBestSlide: ThumbnailViewElement null for prefetched slide : {0}",c))}),this.yVk(a)):this.JYa||this.Rv.prefetchSlide(Va.a.empty,b,()=>{this.JYa=!0})}YB(){this.zJ=null;this.JYa=!1}x_a(){this.NIl();
this.JYa=!1}Gvg(a,b){(a=Object(qa.a)(118,b.node))&&a.uE&&this.vmc(a)}Sih(a,b){a=b.property;b.node&&a===zb.a.cid&&(this.JYa=!1)}vmc(a){if(a.isConnected){var b=Object(qa.a)(118,a);b&&(b.mGa=!0,this.wb.Hb(new dd.a(2,1,0,Object(I.a)(this.tgc,this.tgc.HJf,"checkTask"),90,"60")),w.AFrameworkApplication.fa.ka("PPTOTextPreloadServiceFonts")&&(Array.clear(this.tEe),this.LSd(b.U0f),this.LSd(b.BIh),this.LSd(b.jMh),b=new dd.a(3,1,0,Object(I.a)(this,this.uKl,"tryPrefetchFonts"),90,"114"),b.customData=this.tEe,
this.wb.Hb(b)))}this.Mec&&(this.Mec.Uvd(),this.vGb=[]);a.Xza=!0;this.Ofa.F2a()}yVk(a){this.vGb.length>=this.JGf&&(this.vGb=[]);Array.add(this.vGb,a)}LSd(a){if(!ma.a.Xa(a)){a=a.split(",");for(const b of a)this.tEe.push(b)}}zfh(a,b=null){const c=this.Ba;if(!c||!c.isConnected)return null;b||(b=this.eee());return this.hmj(c,a,b)}hmj(a,b,c){for(const f of c)if(f)if(c=f.Db,this.SHj(c))xa.a.J(512497862,813,50,"PrefetchManager::PickBestSlide() prefetching content model for slide={0} and fetchType={1} failed many times",
c,b);else if(this.Ysl(f,b)){const l=a.Db;a=this.jc.t8b(a);const y=this.jc.t8b(f);xa.a.J(512497861,813,50,"PrefetchManager::PickBestSlide() prefetching {0} at {1} with offset {2} from currentSlide {3} at {4} for fetchType={5}",c,y,y-a,l,a,b);return f}return null}SHj(a){let b=0;for(const c of this.vGb)a.equals(c)&&(b+=1);if(b>=this.zui)return!0;b=0;for(const c of this.wGb)a.equals(c)&&(b+=1);return b>=this.Aui}Ysl(a,b){if(!a)return!1;const c=a.Db;if(Va.a.Cw(c))return!1;const f=!!a&&a.uE;if(0===b)return!f;
if(!f||!a.mGa)return!1;b=a.hVa(new vr.a(a.Vp,a.Vk));if(null===b)return xa.a.J(512497860,813,50,"PrefetchManager::ShouldPrefetchSlide() null images for {0}",c),!1;for(const l of b)if(!this.KB.w$b.Hrc(l).data)return!0;return a.mGa=!1}wKl(){if(this.Wgc&&this.QAh()){const b=this.zfh(1);if(b){var a=b.Db;this.tgc.Yvd();this.v3i(b);this.zVk(a)}}}uKl(a){a=Array.isArray(a.customData)?a.customData:null;for(const b of a)this.xz.GWi(b)}QAh(){return this.KH||!this.fqk&&2===this.Ej.qda||!this.Ef||this.jXa.v4(this.Ef)||
!this.Ba||this.Ba.WL?!1:!0}zVk(a){this.wGb.length>=this.JGf&&(this.wGb=[]);Array.add(this.wGb,a)}v3i(a){if(a){var b=a.hVa(new vr.a(a.Vp,a.Vk));b&&0<b.length?this.KB.bxb(b,!0,()=>{this.tgc.Uvd();this.wGb=[];a.mGa=!1},w.AFrameworkApplication.fa.ka("FetchSlideImageBatchInRealTimeEnabled")):a.mGa=!1}}NIl(){this.K$c||(this.wb.Hb(this.q1g),this.K$c=!0)}updateSlidePrefetchRange(){this.K$c=!1;this.Rv.syncCurrentSlideIdAndPrefetchRange(this.Ba,null,this.Ofa.cqa,null)}Cwj(){return Yr.b(this.eee(),a=>a?a.Db:
null)}eee(){var a=this.Ba;if(!a||!a.isConnected)return[];a=this.jc.t8b(a);var b=this.ta.presentation;if(!b)throw Error.argumentNull("Presentation is null");b=b.slides||[];const c=b.length,f=[],l=[];if(!this.lgk)for(var y of this.Ofa.cqa.o4)y!==a&&y<c&&(Array.add(l,b[y]),f[y]=!0);if(this.lok&&!f.length)for(y=1;y<=this.kel;y++){const H=this.Ofa.cqa.lastIndex+y;H!==a&&H<c&&(Array.add(l,b[H]),f[H]=!0)}if(0<=a){a=this.pqk.cbg(a,b.length,this.Ybd,this.Xbd);for(const H of a)if(void 0===f[H]||null===f[H])f[H]=
!0,Array.add(l,b[H])}return l}}aq.Bth=1E3;aq.lel=2E3;aq.jel=6E4;aq.vth=500;Object(m.a)(aq,"PrefetchManager",null,[435,107]);class tD{constructor(a,b,c,f){this.ai=b;this.ME=c;this.pa=f;this.Mc=a;this.Mc.CCa(Object(I.a)(this,this.tib,"onSessionEnding"))}tib(a,b){if(this.pa.pz()){a=this.pa.Xd();if(!a.length){const c=this.pa.Eag();c&&a.push(c)}for(const c of a)this.ai.F8a(c)}this.ME.N7i(b.GD)}dispose(){this.Mc.gpd(Object(I.a)(this,this.tib,"onSessionEnding"))}}Object(m.a)(tD,"SessionCleanupHandler",null,
[107]);var sK=d(441),nR=d(968);class uD{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb){this.bId=this.ICc=this.OFe=!1;if(!b)throw Error.argumentNull("taskManager");if(!c)throw Error.argumentNull("context");this.Ea=a;this.Fjc=a.sessionTimeoutInMs;this.wb=b;this.DE=c;this.pa=f;this.HXa=l;this.mD=y;this.Ud=H;this.ta=Q;this.$b=ia;this.Ym=wa;this.LYg=Ua;this.Xo=kb;this.Rzg=Gb;this.Ejc=0}get Pda(){return this.HXa.instance}get b0(){return w.AFrameworkApplication.Yg}get Mrg(){return 1===this.Ejc}get JBb(){return this.ICc}get W2c(){return this.bId}get GD(){return this.Ejc}set GD(a){this.Ejc=
a}get fIf(){return this.Ea.podsSeamlessFailoverEnabled&&!!this.Xo.instance}start(){if(!this.b0){var a=new dd.a(4,2,3E4,Object(I.a)(this,this.z2g,"manageLifetime$p"),90,"56");this.wb.Hb(a)}}Jtk(){this.z2g(null)}z2g(){if(!this.OFe){var a=+new Date-+Nc.a.Ycc;a>this.Fjc&&this.d1i(a);w.AFrameworkApplication.jA&&w.AFrameworkApplication.fa.ka("WOPITokenRefreshStopWhenOutOfRangeIsEnabled")&&a>=this.Ea.wopiTokenRefreshMaxDurationInMs&&this.mD.e_k()}}d1i(a){this.b0||(this.gLf(2),this.fIf?this.Rzg.instance&&
this.Rzg.instance.Xab&&(xa.a.J(512360777,805,15,"SessionLifetimeManager::ExpireSession - ShowCustomizedTimeoutMessageForCommentDraft"),$d.Health.instance.recordQosError("TimeoutDialogForCommentDraft",["SessionExpired"],!0,!0,!1,!0,null),this.LYg.Axl()):this.LYg.zxl(),this.mD.gZk(),xa.a.J(512360776,801,15,"SessionLifetimeManager::ExpireSession - Session has expired after idle {0}, timeout {1}. CanRehydrate:{2}; ValidFailoverInstance:{3}; SeamlessFailoverEnabled:{4};",a,this.Fjc,this.fIf,!!this.Xo.instance,
this.Ea.podsSeamlessFailoverEnabled))}closeSession(a=1){this.gLf(a)}gLf(a){0===a&&xa.a.J(512360775,801,50,"SessionCloseReason should not be unknown!");if(!this.b0)try{this.ICc=!0,xa.a.J(512360774,801,15,"SessionLifetimeManager::CloseSession() - closing session, reason:{0}",sK.a[a]),this.Ejc=a,this.pa.setSelection(null),w.AFrameworkApplication.Yg=!0,this.DE.oab().wid=!0,this.Ud.disabled=!0,Dl.a.wx&&4!==a&&Dl.a.wx.hide(),this.mD.mTe(new nR.a(a)),this.Pda&&0<this.Pda.qEa.count&&this.Pda.Rqc(this.DE.lUa().presentationId,
"instanceId",!0,!1),this.Ea.podsSeamlessFailoverEnabled&&this.Xo.instance&&(1===a?this.Xo.instance.ARd("abortedOnExitApp"):this.Xo.instance.ARd("SessionClose_"+a)),this.wb.stop(),this.Ym.isPaused||this.Ym.pause(),4!==a&&2!==a&&this.$b.blockContent(this.ta.presentation,"CloseSession",!0),this.mD.cod(new xo.a(a))}finally{this.bId=this.ICc=!1}}gyl(){this.OFe=!0}zcl(){this.OFe=!1}markSessionClosingAtForceSave(a){xa.a.J(512360773,801,15,"SessionLifetimeManager::MarkSessionClosingAtForceSave reason:{0}",
sK.a[a]);this.bId=this.ICc=!0;this.Ejc=a}}Object(m.a)(uD,"SessionLifetimeManager",null,[1042]);var jg=d(430);class tK{constructor(){this.trigger=null;this.tba=this.fmb=this.j2a=0;this.h0d={}}}Object(m.a)(tK,"SuggestionsInfo",null,[]);class uK{constructor(){this.SessionID=this.SerializedUser=this.BaseDocQueryStringWithoutVersion=null}}Object(m.a)(uK,"StartRtcConnectionRequest",null,[]);class vK{constructor(){this.SessionID=null}}Object(m.a)(vK,"StopRtcConnectionRequest",null,[]);var oR=d(283);class wK{constructor(a,
b){this.slideId=a;this.imageId=oR.a.vOc(b)}}Object(m.a)(wK,"ThumbnailImageId",null,[]);var lt=d(292);const xK=a=>{let b,c,f;var l;let y,H;b=null;f=c=0;y=l=null;H=-1;return(a=a.match(RegExp("/IncSuggestion/(.*),(\\d+),(\\d+),(\\d+),(\\d+),(.*),(\\d+)")))&&8===a.length?(b=a[1],c=Number.parseInvariant(a[2]),f=Number.parseInvariant(a[3]),l=Object.assign(new lt.a,{Sid:Number.parseInvariant(a[4]),Cid:Number.parseInvariant(a[5])}),l=new Va.a(l),y=a[6],H=Number.parseInvariant(a[7]),{returnValue:!0,correlationID:b,
sV:c,tba:f,slideID:l,trigger:y,fmb:H}):{returnValue:!1,correlationID:b,sV:c,tba:f,slideID:l,trigger:y,fmb:H}},pR=a=>{const b=new Na.a;try{const c=De.a(a);for(const f of c.SlideSuggestions)b.add(f.Index)}catch(c){xa.a.J(42342594,829,10,"ContentKeyHelper:TryGetSuggestionIndexesListFromValue - parsing suggestionResults failed.")}return b};var Cz;(function(a){a[a.none=0]="none";a[a.alone=1]="alone";a[a.coauthoring=2]="coauthoring"})(Cz||(Cz={}));Object(m.b)("CoauthorStatus",Cz);class yK extends Sys.EventArgs{constructor(a){super();
this.lja=a}}Object(m.a)(yK,"AppliedPolicyIdEventArgs",Sys.EventArgs,[]);class zK extends Sys.EventArgs{constructor(a){super();this.ySc=a}}Object(m.a)(zK,"FileRevisionHistoryEventArgs",Sys.EventArgs,[]);class AK extends Sys.EventArgs{constructor(a,b,c,f,l){super();this.eYc=a;this.mSc=b;this.vXj=c;this.confidence=f;this.imageDescription=l}}Object(m.a)(AK,"ImageDescriptionReadyEventArgs",Sys.EventArgs,[]);class BK extends Sys.EventArgs{constructor(a){super();this.nbc=a}}Object(m.a)(BK,"IsManuallyAppliedEventArgs",
Sys.EventArgs,[]);class CK extends Sys.EventArgs{constructor(){super()}}Object(m.a)(CK,"CommentsChangedEventArgs",Sys.EventArgs,[]);class DK extends Sys.EventArgs{constructor(a){super();this.G7d=a}}Object(m.a)(DK,"FindRtcSessionEventArgs",Sys.EventArgs,[]);class EK extends Sys.EventArgs{constructor(){super()}}Object(m.a)(EK,"LastMergeEditUTCChangedEventArgs",Sys.EventArgs,[]);class FK extends Sys.EventArgs{constructor(){super()}}Object(m.a)(FK,"RealTimeEditEventArgs",Sys.EventArgs,[]);class vD extends Sys.EventArgs{constructor(a,
b=null){super();this.Yqk=a;this.Pgk=b}get EGh(){return this.Yqk}get t1i(){return this.Pgk}}Object(m.a)(vD,"SyncLoopStatusNotifiedEventArgs",Sys.EventArgs,[]);class GK extends Sys.EventArgs{constructor(a){super();this.ZSk=a}}Object(m.a)(GK,"PresentationLastModifiedTimeReceivedEventArgs",Sys.EventArgs,[]);var qR=d(895);class HK extends Sys.EventArgs{constructor(a){super();this.slideId=a}}Object(m.a)(HK,"DesignerSuggestionCoauthModifiedEventArgs",Sys.EventArgs,[]);class Dz extends Sys.EventArgs{constructor(a,
b,c,f,l,y,H){super();this.zhe=!1;this.Quc=null;this.correlationId=a;this.j2a=b;this.tba=c;this.trigger=l;this.slideId=y;this.WDa=H;this.rMa=f}}Object(m.a)(Dz,"DesignerSuggestionsUpdatedEventArgs",Sys.EventArgs,[]);class Rx extends Sys.EventArgs{constructor(a,b,c){super();this.correlationId=a;this.slideId=b;this.WDa=c}}Object(m.a)(Rx,"FixItSuggestionUpdatedEventArgs",Sys.EventArgs,[]);class IK extends Sys.EventArgs{constructor(a,b,c,f){super();this.slideId=a;this.bZ=c;this.shapeId=b;this.WDa=f}}Object(m.a)(IK,
"IconSuggestionUpdatedEventArgs",Sys.EventArgs,[]);class JK extends Sys.EventArgs{constructor(a,b,c,f,l,y){super();this.correlationId=a;this.Dea=b;this.slideId=c;this.shapeId=f;this.jLa=l;this.WDa=y}}Object(m.a)(JK,"ReplaceObjectUpdatedEventArgs",Sys.EventArgs,[]);class Ez extends Sys.EventArgs{constructor(a){super();this.upe=!1;this.upe=a}}Object(m.a)(Ez,"ToggleChatPPTPaneEventArgs",Sys.EventArgs,[]);class KK extends Sys.EventArgs{constructor(a){super();this.z0j=a}}Object(m.a)(KK,"PictureRenderSuccessEventArgs",
Sys.EventArgs,[]);var rR=d(386);class wD{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye,Xd,Xf,ug){this.Axe=this.txe=!1;this.uLg=null;this.XMg={};this.Ofa=b;this.ul=ug;this.Mq=l;this.I6c=y;this.Tb=Q;this.ta=ia;this.Rv=wa;this.Wbd=Ua;this.Ud=kb;this.mD=Gb;this.le=ec;this.M6c=dc;this.Tu=Fc;this.Ya=a;this.wR=yc;this.aGb=tc;this.Mc=xd;this.p7c=c;this.Ea=Vd;this.mu=Ld;this.wb=ye;this.Vv=Xd;this.pc=Xf;this.EIg=this.Ea.yg&&this.Ea.pptNoRtcConnectWhenReadOnlyEnabled;this.Mc.CCa(Object(I.a)(this,
this.WE,"onSessionEnd"));this.Mc.GC(Object(I.a)(this,this.Y7d,"flushOnSessionEnd"));this.p7c.nzf(Object(I.a)(this,this.G$g,"onNormalChannelDocNotifyClientItemsUpdated"));f&&f.nzf(Object(I.a)(this,this.G$g,"onNormalChannelDocNotifyClientItemsUpdated"));this.Ea.podsTriggerServerRtcConnectionFromBrowserIsEnabled&&this.Mc.HC(Object(I.a)(this,this.yaa,"onPodSessionRehydrated"));this.EIg&&this.Mc.i8(Object(I.a)(this,this.Sw,"onUnifiedAppStateChanged"))}G$g(a,b){this.ECk(b,this.I6c)}ECk(a,b){let c=!1;const f=
[],l=[],y=new tK;for(const tc of a.items){const xd=new Date,Vd=this.mu.$Fa;var H=void 0,Q=void 0,ia=void 0,wa=void 0,Ua=void 0,kb=void 0;if(tc.Key===jg.a.xhh)b.Hae(jg.a.xhh)>tc.TimeStamp||(xa.a.J(512497797,813,50,"Need to reload the whole presentation."),c=!0);else{var Gb=void 0;Gb=null;(Q=tc.Key.match(RegExp("/Thumb\\[(\\d+),(\\d+)\\]/ID\\[(\\d+),(\\d+)\\]")))&&5===Q.length?(Gb=new lt.a,Gb.Sid=Number.parseInvariant(Q[3]),Gb.Cid=Number.parseInvariant(Q[4]),Gb=new Va.a(Gb),Q={returnValue:!0,slideId:Gb}):
Q={returnValue:!1,slideId:Gb};if(({slideId:Q}=Q).returnValue)Q=jg.a.Nde(Q.sid,Q.cid),b.Hae(Q)>=tc.TimeStamp||(Q=Sys.Serialization.JavaScriptSerializer.deserialize(tc.Value),Array.add(f,new qR.a(Q,0<Q.SnapshotTimeStamp?Q.SnapshotTimeStamp:tc.TimeStamp)));else if(tc.Key.startsWith(jg.a.XVf))Q=Sys.Serialization.JavaScriptSerializer.deserialize(tc.Value),this.Mq.ZNh(Q),xa.a.J(512497796,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Notify clientID to websession; clientId: {0};",Q);else if(tc.Key===
jg.a.WXi)Q=Sys.Serialization.JavaScriptSerializer.deserialize(tc.Value),xa.a.J(512497795,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated - EditorTable; LastRequestCorrelationID:{0}; TimeStamp:{1}; EditorsCount:{2};",tc.LastRequestCorrelationID,tc.TimeStamp,Q.length),this.Mq.pNh(Q);else if(tc.Key===jg.a.xCi)Q=Sys.Serialization.JavaScriptSerializer.deserialize(tc.Value),xa.a.J(512497794,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated - CoauthStatus; LastRequestCorrelationID:{0}; TimeStamp:{1}; NewStatus:{2};",
tc.LastRequestCorrelationID,tc.TimeStamp,Cz[Q]),this.Mq.Swc(Q);else if(tc.Key===jg.a.yHi)xa.a.J(39913162,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated - Content update; LastEditorID:{0}; LastRequestCorrelationID:{1}; TimeStamp:{2}; RevisionId:{3}; IsFromRealTimeChannel:{4}",tc.LastEditorID,tc.LastRequestCorrelationID,tc.TimeStamp,tc.Value,!1),this.mD.FXk(),this.Rv.QF(this.Tb.Di),(this.Ea.iA||this.Ea.ZF)&&Object(eb.a)("showChatPPTPane")&&this.le.ETe(new Ez(!1));else{if(Gb=tc.Key.startsWith(jg.a.JSf)){a:{Gb=
void 0;Q=tc.Value;try{const Ld=Q?Q.split(","):[];if(3!==Ld.length){Gb=Va.a.Uy(0,0);xa.a.J(23089477,823,10,"ContentKeyHelper::TryGetSlideIdFromSuggestionCoauthModifiedKey - Coauth modified value member is not expected; value:{0}.",Q);var ec={returnValue:!1,slideId:Gb};break a}const ye=Number.parseInvariant(Ld[0]),Xd=Number.parseInvariant(Ld[1]),Xf=Ld[2];Gb=Va.a.Uy(Number.parseInvariant(Ld[0]),Number.parseInvariant(Ld[1]));xa.a.J(23089479,823,50,"ContentKeyHelper::TryGetSlideIdFromSuggestionCoauthModifiedKey - Sid:{0}, Cid:{1}, modified Guid:{2}.",
ye,Xd,Xf)}catch(Ld){xa.a.J(23089481,823,10,"ContentKeyHelper::TryGetSlideIdFromSuggestionCoauthModifiedKey - Cannot get slide id from coauth modified key. Value:{0}, exception log:{0}.",Q,Ld.toString());Gb=Va.a.Uy(0,0);ec={returnValue:!1,slideId:Gb};break a}ec={returnValue:!0,slideId:Gb}}Gb=({slideId:Q}=ec).returnValue}if(Gb)xa.a.J(512497793,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Coauth Modified notification returned, slide id:{0}",tc.Value),this.le.JXk(new HK(Q));else{if(Gb=
tc.Key.startsWith(jg.a.ZFh)){{var dc=void 0;let Ld;Q=null;H=0;dc=Ld=null;(Gb=tc.Key.match(RegExp("/Suggestion\\[(.*),(\\d+)]/ID\\[(\\d+),(\\d+),(.*),(.*)]")))&&7===Gb.length?(Q=Gb[1],H=Number.parseInvariant(Gb[2]),dc=Object.assign(new lt.a,{Sid:Number.parseInvariant(Gb[3]),Cid:Number.parseInvariant(Gb[4])}),Ld=new Va.a(dc),dc=Gb[6],H={returnValue:!0,correlationID:Q,sV:H,slideID:Ld,trigger:dc}):H={returnValue:!1,correlationID:Q,sV:H,slideID:Ld,trigger:dc}}Gb=({correlationID:H,sV:y.j2a,slideID:Q,trigger:y.trigger}=
H).returnValue}if(Gb)xa.a.J(512497792,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Designer suggestion notification returned, CorrelationId:{0}",H),Q=new Dz(H,y.j2a,y.j2a,0,y.trigger,Q,tc.Value),Q.Quc=new Na.a,this.jRe(Q);else if(this.Ea.designerIncrementalRenderEnabled&&tc.Key.startsWith(jg.a.Bhe)&&({correlationID:H,sV:y.j2a,tba:y.tba,slideID:Q,trigger:y.trigger,fmb:y.fmb}=xK(tc.Key)).returnValue)xa.a.J(512497763,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Designer incremental suggestion notification returned, CorrelationId: {0}; startIdx: {1}; Suggestions in notification: {2}; Expected total: {3}",
H,y.fmb,y.j2a,y.tba),Q=new Dz(H,y.j2a,y.tba,y.fmb,y.trigger,Q,tc.Value),H in y.h0d||(y.h0d[H]=this.Stj(H,a.items)),Q.Quc=y.h0d[H],Q.zhe=!0,this.jRe(Q);else{if(Gb=tc.Key.startsWith(jg.a.d1f))Q=H=null,(Gb=tc.Key.match(RegExp("/FixItSuggestion\\[(.*)]/ID\\[(\\d+),(\\d+),(.*)]")))&&5===Gb.length?(H=Gb[1],Q=Object.assign(new lt.a,{Sid:Number.parseInvariant(Gb[2]),Cid:Number.parseInvariant(Gb[3])}),Q=new Va.a(Q),H={returnValue:!0,correlationID:H,slideID:Q}):H={returnValue:!1,correlationID:H,slideID:Q},
Gb=({correlationID:H,slideID:Q}=H).returnValue;if(Gb)xa.a.J(512497762,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - FixIt suggestion notification returned, CorrelationId:{0}",H),this.jRe(new Rx(H,Q,tc.Value));else{if(Gb=tc.Key.startsWith(jg.a.Pkg))kb=null,ia=0,Gb=null,H=Q=0,(wa=tc.Key.match(RegExp("/Intelligence\\[(.*),(\\d+),(\\d+),(\\d+),(\\d+),(\\d+)]")))&&7===wa.length?(kb=wa[1],ia=Number.parseInvariant(wa[2]),H=Object.assign(new lt.a,{Sid:Number.parseInvariant(wa[3]),Cid:Number.parseInvariant(wa[4])}),
Gb=new Va.a(H),Q=Number.parseInvariant(wa[5]),H=Number.parseInvariant(wa[6]),ia={returnValue:!0,correlationID:kb,Dea:ia,slideID:Gb,shapeId:Q,jLa:H}):ia={returnValue:!1,correlationID:kb,Dea:ia,slideID:Gb,shapeId:Q,jLa:H},Gb=({correlationID:H,Dea:ia,slideID:Q,shapeId:wa,jLa:kb}=ia).returnValue;if(Gb)xa.a.J(512497761,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - ReplaceObject notification returned, CorrelationId:{0}",H),this.le.YYk(new JK(H,ia,Q,wa,kb,tc.Value));else if(tc.Key===jg.a.GVl)this.DGj();
else if(tc.Key===jg.a.i_f&&this.uLg!==tc.Value)this.gBj(tc);else if(tc.Key===jg.a.FGh)!ma.a.Xa(tc.Value)&&ma.a.mBb(tc.Value)?(Q=Sys.Serialization.JavaScriptSerializer.deserialize(tc.Value),xa.a.J(512497760,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Sync loop exited with status:{0}; PopSessionID:{1}; PodSessionID:{2}",Q,this.Ya.Uk,this.Ya.podSessionId),240===Q?this.wR.xga(1):(432!==Q||this.Axe||this.tUf(),this.aGb.Skh(new vD(Q)))):(Q=Sys.Serialization.JavaScriptSerializer.deserialize(tc.Value),
xa.a.J(512497759,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Sync loop exited with status:{0}; HasExtraErrorParams:{1}; PopSessionID:{2}; PodSessionID:{3}",Q.Code,!!Q.ExtraErrorParam,this.Ya.Uk,this.Ya.podSessionId),240===Q.Code?this.wR.xga(1):(432!==Q.Code||this.Axe||this.tUf(),this.aGb.Skh(new vD(Q.Code,Q.ExtraErrorParam))));else if(tc.Key===jg.a.xug)this.hCj(tc);else if(tc.Key===jg.a.tJj)xa.a.J(512497758,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Host Session Failover notification received oldsessionId:{0};",
this.Ya.Uk),this.wR.xga(1);else if(tc.Key===jg.a.$Sk)Q=Sys.Serialization.JavaScriptSerializer.deserialize(tc.Value),this.Tb.Ef.nQe=Q,this.Tu.QYk(new GK(Q));else if(tc.Key.startsWith(jg.a.hMf)){xa.a.J(512497757,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Comment has been createed or updated with key: {0}",tc.Key);a:{Q=tc.Key;try{const Ld=Q.match(RegExp("\\d+","g"));if(Ld&&0<Ld.length&&!(Ld.length%2)){Gb=[];for(dc=0;dc<Ld.length;dc+=2)Gb.push(Object.assign(new lt.a,{Sid:Number.parseInvariant(Ld[dc]),
Cid:Number.parseInvariant(Ld[dc+1])}));var Fc=Gb;break a}}catch(Ld){xa.a.J(25011930,805,10,"ContentKeyHelper::TryGetSlideIdsFromCommentPrefixKey - Cannot get slide id array from key. Key:{0}, Exception:{1}",Q,Ld)}Fc=null}(Q=Fc)&&0<Q.length&&this.mD.AXk(new CK(Q))}else if(tc.Key.startsWith(jg.a.Oig))this.FBj(tc);else if(tc.Key===jg.a.H_f)this.M6c.SXk(new zK(tc.Value));else{if(Gb=tc.Key.startsWith(jg.a.sig)){a:{Ua=tc.Key;Gb=null;Q=0;wa="";try{const Ld=Ua.match(RegExp("/IconSuggestion\\[(\\d+),(\\d+),(\\d+),{(.*)}]"));
if(Ld&&5===Ld.length){const ye=Object.assign(new lt.a,{Sid:Number.parseInvariant(Ld[1]),Cid:Number.parseInvariant(Ld[2])});Gb=new Va.a(ye);Q=Number.parseInvariant(Ld[3]);wa=Ld[4];var yc={returnValue:!0,slideID:Gb,shapeId:Q,nodeId:wa};break a}}catch(Ld){xa.a.J(38279246,823,10,"ContentKeyHelper::TryGetIconSuggestionInfoFromServiceKey - Cannot get IconSuggestionInfo from key. Value:{0}, exception log:{0}.",Ua,Ld.toString())}yc={returnValue:!1,slideID:Gb,shapeId:Q,nodeId:wa}}Gb=({slideID:Q,shapeId:wa,
nodeId:Ua}=yc).returnValue}if(Gb)xa.a.J(512497756,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - IconSuggestion notification returned."),this.le.cYk(new IK(Q,wa,Ua,tc.Value));else if(tc.Key===jg.a.f5i)this.aGb.TXk(new DK(tc.Value));else{if(Gb=tc.Key.startsWith(jg.a.GIh))Gb=null,(Q=tc.Key.match(RegExp("/ThumbImgId\\[(\\d+),(\\d+)\\]")))&&3===Q.length?(Gb=new lt.a,Gb.Sid=Number.parseInvariant(Q[1]),Gb.Cid=Number.parseInvariant(Q[2]),Gb=new Va.a(Gb),Q={returnValue:!0,slideId:Gb}):Q=
{returnValue:!1,slideId:Gb},Gb=({slideId:Q}=Q).returnValue;if(Gb)Q=new wK(Q,tc.Value),Q.imageId&&l.push(Q);else if(tc.Key===jg.a.fWi)this.Vv.a9e(parseInt(tc.Value));else if(tc.Key===jg.a.fCf)this.M6c.qXk(new yK(tc.Value));else if(tc.Key===jg.a.Fpg)this.M6c.kYk(new BK("true"===tc.Value.toLowerCase()));else if(tc.Key===jg.a.tdl)this.Mq.Ish=tc.Value,this.Mq.kah();else if(tc.Key===jg.a.rdl)try{this.Mq.Atd=Boolean.parse(tc.Value)}catch(Ld){xa.a.J(512497755,817,15,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Can't parse the notification message: {0}",
Ld)}else if(tc.Key===jg.a.oug)Q=Sys.Serialization.JavaScriptSerializer.deserialize(tc.Value),xa.a.J(512497754,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - LastMergeEditUTC updated: {0}",Q.toString()),this.mD.pYk(new EK(Q));else if(tc.Key===jg.a.wlh)Q=Sys.Serialization.JavaScriptSerializer.deserialize(tc.Value),xa.a.J(512497753,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated- Raising a RealTimeChannelEditEvent. UTC Time: {0}",Q.toString()),this.mD.TYk(new FK(Q));
else if(tc.Key===jg.a.yLj)try{this.Mq.Pme=Boolean.parse(tc.Value),xa.a.J(512497752,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - IsConnectedToOCS: {0}",this.Mq.Pme)}catch(Ld){xa.a.J(512497751,817,15,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Can't parse the notification message: {0}",Ld)}else if(tc.Key===jg.a.rJj)this.Mq.uoc=tc.Value,xa.a.J(512497750,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - PopsHostProtocol: {0}",this.Mq.uoc);else if(tc.Key===
jg.a.QVl)xa.a.J(512497749,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received ZeroByteFileEnsuredOnHost notification"),this.Mq.lRh=!0;else if(tc.Key===jg.a.S$j)xa.a.J(512497748,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received LockId: {0}",tc.Value),this.Mq.G4=tc.Value;else if(tc.Key===jg.a.T$j)xa.a.J(512497747,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received LockIsCoauthorable: {0}",tc.Value),this.Mq.Mvg=Boolean.parse(tc.Value);
else if(tc.Key===jg.a.aSf)try{this.Mq.m9a=Number.parseInvariant(tc.Value),xa.a.J(512497746,843,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - DeferredBlobCount: {0}",this.Mq.m9a)}catch(Ld){xa.a.J(512497745,843,15,"Can't parse the notification message: {0}",Ld)}else if(tc.Key===jg.a.KAf){let Ld;try{Ld=Boolean.parse(tc.Value),this.Mq.minorVersionLimitReached=Ld}catch(ye){Ld=this.Mq.minorVersionLimitReached=!1}Ld&&!this.txe&&(this.nVi(),this.txe=!0);xa.a.J(512497744,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received AllowSaveAtMinorVersionLimit: {0}, m_fIsMinorVersionLimitReachedDisplayed: {1}",
tc.Value,this.txe)}else xa.a.J(512497743,817,50,"Notification key ignored {0}",tc.Key)}}}}}}}xa.a.J(512497742,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated docItem.Key:{0}, ProcessNotificationStart:{1}, ProcessNotificationDuration:{2}",tc.Key,Nc.a.uf(xd),(+new Date-+xd).toString());Vd&&!this.mu.$Fa&&xa.a.J(512497741,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Dragging is stopped while processing docItem.Key:{0}",tc.Key);y.trigger===rR.a.insertPicture&&this.yUk(new KK(!0))}this.GNl(c,
f,b,l)}Stj(a,b){const c=new Na.a;b=Ak.e(b,f=>f.Key.startsWith(jg.a.Bhe));for(const f of b)b=xK(f.Key),b.returnValue&&b.correlationID===a&&(1===b.sV?c.add(b.fmb):1<b.sV&&c.addRange(pR(f.Value)));return c}nVi(){this.ul.rL(24);xa.a.J(512497740,809,50,"CoauthNotificationManager::DisplayVersionLimitHitInfo reached - business bar for MinorVersionLimit")}tUf(){this.Axe=!0;this.ul.rL(25);xa.a.J(512497739,809,15,"CoauthNotificationManager::DisplayNetworkLocationUnauthorizedInfo reached - business bar for UserNetworkLocationUnauthorized Shown")}yUk(a){this.le.MYk(a)}jRe(a){let b;
b=Object(Wa.a)(Rx,a)?()=>{this.le.raiseFixItSuggestionUpdatedEvent(Object(qa.a)(Rx,a))}:()=>{this.le.raiseDesignerSuggestionsUpdatedEvent(Object(qa.a)(Dz,a))};if(this.mu.$Fa&&this.Ea.processSuggestionNotificationInTaskIfInDragIsEnabled){const c=new dd.a(2,1,0,()=>{b()},90,Object(Wa.a)(Rx,a)?"114":"92");this.wb.Hb(c)}else b()}GNl(a,b,c,f){a&&(this.Ofa.Wyj(),this.Wbd.instance&&this.Wbd.instance.Ihd());b.forEach(l=>{const y=l.Z4b.Id;c.ENl(jg.a.Nde(y.Sid,y.Cid),l.Iga)});this.Ofa.hBj(b,f)}DGj(){xa.a.J(512497738,
817,10,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Document was already opened by antoher DC.");this.Tb.Di&&this.Tb.Di.contentReplicator&&(this.Tb.Di.contentReplicator.enabled=0);this.Ud.nH(158,a=>{a.KC=1;return!1})}gBj(a){xa.a.J(512497737,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Failover notification received");this.mD.RXk(new lj(!1,!0));let b=null;this.Wbd.instance&&(b=this.Wbd.instance.Cwj());this.Rv.syncCurrentSlideIdAndPrefetchRange(this.ta.Ba,b,null,null);
this.uLg=a.Value}hCj(a){a=Sys.Serialization.JavaScriptSerializer.deserialize(a.Value);if(this.Ya.podSessionId!==a)if(this.Ea.ignorePodSessionRefreshedFromPops)xa.a.J(512497736,817,50,"CoauthNotificationManager::HandleLatestPodSessionNotification - Ignore Pop rehydrated Pod session");else{const b=this.Ya.podSessionId;this.Ya.podSessionId=a;this.aGb.pkh(new wm.a(b,a))}else xa.a.J(512497735,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Same PodSessionId:{0}",a)}FBj(a){a=Sys.Serialization.JavaScriptSerializer.deserialize(a.Value);
try{if(a){const b=a.split(";",6);a=!0;for(let c=0;5>c;c++)if(!b[c]){a=!1;break}if(6>b.length||!a)xa.a.J(512497733,817,15,"Invalid format of image description notification");else{const c=ha.a.Jf(b[1]),f=Boolean.parse(b[2]),l=Boolean.parse(b[3]);this.M6c.dYk(new AK(c,f,l,parseFloat(b[4]),b[5]))}}else xa.a.J(512497734,817,15,"Response data is null")}catch(b){xa.a.J(512497732,817,15,"Can't parse the notification message: {0}",b)}}T6i(){let a=0;const b=[],c=(new Date).getTime(),f=this.XMg;for(let y in f){var l=
y;0<c-f[y]&&(a++,delete this.XMg[l])}(0<a||0<b.length)&&xa.a.J(512497731,817,50,"FlushDocNotifyTelemetry - normal channel only:{0}, normal channel delay:{1}",a,Yb.a.join(b,","))}Y7d(){this.T6i()}XEh(){if(this.EIg&&!this.pc.VL)xa.a.J(512497730,801,50,"StartServerRtcConnection: Do not start server RTC in readonly mode");else{var a=Ib.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,b=Hg.a.create().toString(),c=String.format("{0}PodHandler.ashx?action=StartRtcConnection&source=Browser",
this.Ea.podsWebServiceBase),f=Object.assign(new uK,{BaseDocQueryStringWithoutVersion:w.AFrameworkApplication.gh,SerializedUser:this.Ea.serializedBaseUser,SessionID:a}),l={};l.PodSID=a;l["X-UserSessionId"]=w.AFrameworkApplication.userSessionId;l["X-CorrelationID"]=b;a=De.c(f);w.AFrameworkApplication.Me.iW(c,2,a,l,[Dh.a.i6],0,y=>{this.Gwg(50,String.format("EnqueueTime:{0}; InvokedTime:{1}; CompletedTime: {2}; ResponseData:{3}",y.data.OI,y.data.iu,y.data.wv,y.data.ee))},y=>{const H=Ib.a.instance.resolve("PowerPointWebEditor.IJsonpHelperManager");
this.Gwg(10,H.Nka(y))},null,void 0,void 0,void 0,void 0,Lx.a("3"))}}rFh(){var a=Ib.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;const b=Hg.a.create().toString(),c=String.format("{0}PodHandler.ashx?action=StopRtcConnection",this.Ea.podsWebServiceBase),f={};f.PodSID=a;f["X-UserSessionId"]=w.AFrameworkApplication.userSessionId;f["X-CorrelationID"]=b;a=Object.assign(new vK,{SessionID:a});a=De.c(a);w.AFrameworkApplication.Me.iW(c,2,a,f,[Dh.a.i6],0,()=>{xa.a.J(38904456,801,50,
"StopServerRtcConnection - request succeeded")},l=>{const y=Ib.a.instance.resolve("PowerPointWebEditor.IJsonpHelperManager");xa.a.J(38904458,801,10,"StopServerRtcConnection -  Failed with status code: {0}",y.Nka(l))},null,void 0,void 0,void 0,void 0,Lx.a("9"))}Gwg(a,b){xa.a.J(512497729,801,a,"StartServerRtcResult: {0}",b)}yaa(){this.XEh()}Sw(a,b){b.boe&&!this.pc.VL&&(xa.a.J(512497728,801,50,"OnUnifiedAppStateChanged: Disconnect from server RTC in readonly mode"),this.rFh())}WE(){this.rFh()}}Object(m.a)(wD,
"CoauthNotificationManager",null,[]);class LK{constructor(a,b){this.MVh=a;this.edf=b}get coauthoringStartTime(){return this.MVh}get tLf(){return this.edf}Njl(a){this.edf=a}}Object(m.a)(LK,"CoauthoringDurationRecord",null,[]);var sR=d(966);class MK extends Sys.EventArgs{constructor(a,b,c=!1){super();this.mDf=a;this.Qug=b;this.JWj=c}}Object(m.a)(MK,"EditorTableChangedEventArgs",Sys.EventArgs,[]);class Fz{constructor(a,b,c){this.Nna=this.Dfb=null;this.Odb=[];this.Lzg=new sk.a;this.NMg=new sk.a;this.dDe=
null;this.YCg=!1;this.WCe=0;this.lDg=this.U7c=!1;this.Lbd="";this.Ish=null;this.minorVersionLimitReached=this.lRh=this.Jqg=this.Atd=this.WZf=!1;this.ECe=null;this.Mvg=!1;this.m9a=0;this.y2c=!1;this.aHa=a;this.Mc=b;this.S6c=0;this.jeb=[];this.Mc.sTd(Object(I.a)(this,this.oib,"onPopSessionClosed"));this.Ikk=c}get AD(){return this.Dfb}set AD(a){this.Dfb!==a&&(this.Dfb&&0<this.Dfb.length&&2===this.S6c&&xa.a.J(509670560,804,10,String.format("MyEditorID is changed from {0} to {1}",this.Dfb,a)),this.Dfb=
a)}get userName(){return this.Nna}get Pme(){return this.U7c}set Pme(a){(this.U7c=a)&&!this.lDg&&$d.Health.instance&&(this.lDg=!0,$d.Health.instance.addOrUpdatePartCDimension("IsOcsSession",this.U7c.toString()))}get uoc(){return this.Lbd}set uoc(a){a!==this.Lbd&&(this.Lbd=a,xa.a.J(509670558,804,50,"CoauthStateCache - PopsHostProtocol:{0}",this.Lbd))}get G4(){return this.ECe}set G4(a){this.ECe=a;(a=this.Ikk.value.instance)?(a.BZd=this.ECe,xa.a.J(509670557,804,50,"CoauthStateCache::LockId - renameProps.CoauthLockId: {0}",
a.BZd)):xa.a.J(509670556,804,50,"CoauthStateCache::LockId - renameProps == null");this.aHa.rYk()}get v_(){const a=[];Array.addRange(a,this.jeb);return a}get XRl(){return this.v_.length?this.v_.length:1}get amIAlone(){return 2!==this.qda}get Bw(){return this.Mvg}get qda(){return this.S6c}set qda(a){this.S6c!==a&&(xa.a.J(509670554,804,50,"Coauth State Changing to: {0}",1===a?"alone":"coauthoring"),this.S6c=a)}get iDa(){return this.Lzg.task}get ygd(){return this.NMg.task}get VSc(){return this.dDe}set VSc(a){this.dDe||
(this.dDe=a,this.NMg.Og(a.getTime()))}pNh(a){let b;({wVd:a,leaving:b}=this.dOl(a)).returnValue&&(a=new MK(a,b,!this.y2c),this.P0k(),this.aHa.NXk(a))}P0k(){const a=[],b=this.v_;for(const c of b)Array.add(a,c.ID)}Swc(a){const b=this.qda;2===a&&(this.VSc=new Date);0!==b||this.YCg||(xa.a.J(509670553,804,50,"Set coauthoring start point: {0}",1===a?"alone":"coauthoring"),this.YCg=!0,this.Lzg.Og(1===a?1:0));this.qda=a;b!==this.qda&&(this.aHa.yXk(new sR.a(this.qda)),this.rNl(this.qda))}rNl(a){var b=new Date;
2===a?(b=new LK(b,new Date(9999,12,31)),Array.add(this.Odb,b)):(a=this.Odb.length,0<a&&this.Odb[a-1].Njl(b))}ZNh(a){this.AD=a;xa.a.J(509670552,814,50,"App::UpdateMyEditorID; MyClientId: {0}; EditorTableCount: {1}",this.AD,this.v_.length);this.aHa.xXk()}jnb(a){let b;a&&(a=a.toLowerCase());b=null;for(let c=0;c<this.jeb.length;c++){const f=this.jeb[c];if(a===f.ID){b=f;break}}return{returnValue:!!b,editor:b}}dOl(a){let b,c;const f=[];b=[];c=[];let l=!1;const y=a?a.length:0;for(let H=0;H<y;H++){const Q=
a[H];Q&&Q.ID&&(Q.ID=Q.ID.toLowerCase());let ia;({editor:ia}=this.jnb(Q.ID)).returnValue?(l=l||!Fz.ZXi(Q,ia),Array.remove(this.jeb,ia)):(Q.ID!==this.Dfb?Array.add(b,Q):this.Nna=Q.Name,l=!0);Array.add(f,Q)}Array.addRange(c,this.jeb);l=l||0<c.length;this.jeb=f;this.WCe=Math.max(this.WCe,this.jeb.length);$d.Health.instance&&$d.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.WCe.toString());return{returnValue:l,wVd:b,leaving:c}}yUc(a,b){let c=0;const f=this.Odb.length;if(0<f&&a<this.Odb[f-
1].tLf){a=a.getTime();b=b.getTime();for(let l=0;l<f;++l){const y=Math.max(this.Odb[l].coauthoringStartTime.getTime(),a),H=Math.min(this.Odb[l].tLf.getTime(),b);y<H&&(c+=H-y)}}return c}kah(){this.Jqg=!0;this.aHa.PYk()}oib(){this.uoc=""}static ZXi(a,b){return a.EmailAddress===b.EmailAddress&&a.ColorIndex===b.ColorIndex&&a.Name===b.Name&&a.ID===b.ID&&a.SIPAddress===b.SIPAddress}}Object(m.a)(Fz,"CoauthStateCache",null,[1021,1022]);var vu=d(381);class yl{constructor(){this.KeyRoot=null;this.TimeStamp=
0}}Object(m.a)(yl,"KeyRootSubscription",null,[]);class Nv{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb){this.wkc=vu.a.empty;this.Qs=[];this.zHa=[];this.oDg=this.fxe=!1;this.p7c=a;this.Gze=b;this.Ig=c;this.e6c=wa.Kqi;this.Ofa=f;this.I6c=l;this.Ej=y;this.Xsk=H.K0d(1E3,Object(I.a)(this,this.L_i,"ensureVisibleThumbnailsSubscriptionImpl"));this.Mc=Q;this.nd=ia;this.Ya=wa;Ua.TRd(this);this.qcd=kb;this.mhc=Gb;this.KH=!1;this.qcd&&this.Mc.agi(Object(I.a)(this,this.SAk,"onBackendChanged"));this.Mc.GC(Object(I.a)(this,
this.OM,"onSessionClosed"));this.Mc.HC(Object(I.a)(this,this.Mo,"onSessionRehydrated"))}Oxa(){this.KH=!1;this.I6c.reset();this.Zjg()}Zjg(){Array.clear(this.Qs);this.wkc=vu.a.empty;this.qwd=this.Ofa.cqa;this.nd.Nsb(()=>{this.qwd=this.Ofa.cqa});const a=new yl;a.KeyRoot=jg.a.p4f(this.e6c);a.TimeStamp=0;this.Qs.push(a);var b=new yl;b.KeyRoot=jg.a.whh;b.TimeStamp=0;this.Qs.push(b);b=new yl;b.KeyRoot=jg.a.wCi;this.Qs.push(b);var c=new yl;c.KeyRoot=jg.a.ZFh;this.Qs.push(c);c=new yl;c.KeyRoot=jg.a.Bhe;this.Qs.push(c);
c=new yl;c.KeyRoot=jg.a.Pkg;this.Qs.push(c);c=new yl;c.KeyRoot=jg.a.JSf;this.Qs.push(c);c=new yl;c.KeyRoot=jg.a.i_f;this.Qs.push(c);c=new yl;c.KeyRoot=jg.a.FGh;this.Qs.push(c);const f=new yl;f.KeyRoot=jg.a.xug;this.Qs.push(f);const l=new yl;l.KeyRoot=jg.a.vJj;this.Qs.push(l);var y=new yl;y.KeyRoot=jg.a.hMf;this.Qs.push(y);y=new yl;y.KeyRoot=jg.a.Oig;this.Qs.push(y);y=Object.assign(new yl,{KeyRoot:jg.a.H_f,TimeStamp:0});this.Qs.push(y);y=new yl;y.KeyRoot=jg.a.sig;this.Qs.push(y);this.mhc&&(y=new yl,
y.KeyRoot=jg.a.GIh,this.Qs.push(y));y=new yl;y.KeyRoot=jg.a.fCf;this.Qs.push(y);y=new yl;y.KeyRoot=jg.a.Fpg;this.Qs.push(y);y=new yl;y.KeyRoot=jg.a.oug;this.Qs.push(y);y=new yl;y.KeyRoot=jg.a.wlh;this.Qs.push(y);y=new yl;y.KeyRoot=jg.a.d1f;this.Qs.push(y);y=new yl;y.KeyRoot=jg.a.KAf;this.Qs.push(y);const H=new yl;H.KeyRoot=jg.a.aSf;this.Qs.push(H);this.p7c.Rsd(this.Qs);this.Gze&&(Array.clear(this.zHa),this.zHa.push(b),this.zHa.push(a),this.zHa.push(c),this.zHa.push(f),this.zHa.push(l),this.zHa.push(y),
this.Ig.rG?(this.Gze.Rsd(this.zHa),this.fxe=!0):(this.Mc.tTd(Object(I.a)(this,this.o_a,"onPopSessionInitialized")),this.oDg=!0))}o_a(){this.fxe||(this.Gze.Rsd(this.zHa),this.fxe=!0)}get qwd(){return this.wkc}set qwd(a){vu.a.equals(this.wkc,a)||(vu.a.equals(a,vu.a.empty)?this.wkc=vu.a.empty:this.wkc=vu.a.vxb(a.BT,a.lastIndex),this.Xsk.perform())}SAk(a,b){this.KH||(a=b.hKk)&&0<a.length&&(xa.a.J(512497699,817,50,"CoauthManager::OnBackendChanged - Backend machine id changed from {0} to {1}",a,this.Ya.EKc),
this.Oxa())}OM(){this.KH=!0}Mo(){this.Oxa()}L_i(){const a=this.Qs;var b=this.I6c;const c=[];var f=null;for(const y of this.qwd.o4){var l=jg.a.nvj(y);f&&f.KeyRoot!==l&&(c.push(f),f=null);f||(f=new yl,f.KeyRoot=l,f.TimeStamp=Number.MAX_VALUE);if(l=this.Ofa.Xyb(y))l=b.Hae(jg.a.Nde(l.sid,l.cid)),f.TimeStamp>l&&(f.TimeStamp=l)}f&&c.push(f);Ak.d(a,Object(I.a)(this,this.w2i,"fNeedResetBrowserKeySubscription"),y=>{y.TimeStamp=0},1);b=Ak.e(a,y=>y.KeyRoot.startsWith(jg.a.HIh));f=Ak.a(c,b,Nv.Zqe);Ak.a(b,f,Nv.Zqe);
if(b.length||c.length)Ak.a(a,b,Nv.Zqe),Array.addRange(a,c),this.p7c.Rsd(a)}w2i(a){return a.KeyRoot.startsWith(jg.a.p4f(this.e6c))&&!this.Ej.AD?(xa.a.J(512497698,817,50,"CoauthSubscriptionManager::ResetBrowserKeyIfNeeded; Resetting timestamp of BrowserID Key subscription as clientId has not been received"),!0):!1}dispose(){this.Mc.Laa(Object(I.a)(this,this.OM,"onSessionClosed"));this.Mc.zga(Object(I.a)(this,this.Mo,"onSessionRehydrated"));this.oDg&&this.Mc.FVe(Object(I.a)(this,this.o_a,"onPopSessionInitialized"))}static Zqe(a,
b){return a.KeyRoot===b.KeyRoot}}Object(m.a)(Nv,"CoauthSubscriptionManager",null,[1020,107,1019]);class NK extends Sys.EventArgs{constructor(){super();this.items=null}}Object(m.a)(NK,"ItemsModifiedEventArgs",Sys.EventArgs,[]);class OK{constructor(a,b,c,f,l,y){this.id=Hg.a.create();this.s6c=a;this.Ve=b;this.Ya=c;this.Ea=l;this.Ud=f;this.dY=y}NEj(a,b){this.dY&&!this.s6c.a0&&this.dY.QPc(a.KY);a&&a.telemetry&&0<a.telemetry.length&&this.Ve.RZa(a.telemetry);Nc.a.NF(this.Ve,()=>{this.s6c.Eah(this.id,a.result,
a.KY,b)})}MEj(a,b,c){if(!this.s6c.a0&&(this.dY&&this.dY.QPc(a.KY),a&&a.error&&this.Ea.pptFailoverInLongPollingFailHandlerEnabled&&a.error.Vm===$e.a.Oh(223))){xa.a.J(35497247,801,15,"LongPollingResponseHandler::HandleRequestFailedEventHandler. The server is unable to find PodSessionId:{0}.",this.Ya.podSessionId||"NULL");this.Ud.Ds(Object.assign(new Hj.a,{Code:223,Source:6}),c);return}Nc.a.NF(this.Ve,()=>{this.s6c.Eah(this.id,null,a.KY,b)})}}Object(m.a)(OK,"LongPollingResponseHandler",null,[]);var tR=
d(894);class xD{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua){this.cIa=this.ZHa=null;this.HLg=Hg.a.nil;this.gHb=this.DXa=0;this.EAg=[10,100,1E3,1E4];this.uYa=null;this.TX=[];this.T4=Ua?"GetPopWacUpdates":"GetUpdates";this.D5=a;this.Ya=c;this.Ig=f;this.Mc=l;this.$ea=y;this.Ud=H;this.pc=Q;this.dY=ia;this.Mc.GC(Object(I.a)(this,this.OM,"onSessionClosed"));this.Mc.OQa(Object(I.a)(this,this.k1,"onSessionRehydrating"));this.Mc.HC(Object(I.a)(this,this.Mo,"onSessionRehydrated"));Ua&&(this.Mc.tTd(Object(I.a)(this,
this.o_a,"onPopSessionInitialized")),this.Mc.sTd(Object(I.a)(this,this.oib,"onPopSessionClosed")));this.WGe=a.bGl;this.k$c=a.T_j;this.cGb=a.$fh;this.bFb=[];b.oab().TRd(this);this.nsk=wa;this.B0h=Ua;this.tma=!1;this.YFb=Ua?3E4:6E4}OM(){this.close("SessionClosed")}k1(){this.uYa&&this.uYa.fxd()}Mo(){this.Kjb("SessionRehydrated")}Eah(a,b,c,f){this.ZHa=null;const l=+new Date-+this.cIa;if(this.tma)xa.a.J(512360732,801,50,"DocNotifyClient.PerformCall - {0} - ignore the server response since DocNotifyClient is closed.",
this.T4);else if(a.equals(this.HLg))if(this.D5.clientIgnoreClosePopsErrorCodeEnable&&this.a0&&this.tma)xa.a.J(512360730,801,50,"DocNotifyClient.PerformCall - {0} - ignore the server response since pops is closing.",this.T4);else if(a=this.Ig.Eea,f&&f.length&&a!==f)xa.a.J(512360729,801,15,"DocNotifyClient.PerformCall - {0} - Ignore {1} response since PopSessionId is changed. CurrentPopSession:{2}; LastAttemptedEnsureHostSessionId:{3}; RequestPopSession:{4}; RetryAttempts:{5}. Triggering another request in {6}ms.",
this.T4,b?"Success":"Failure",this.Ya.Uk,this.Ig.Eea,f,this.gHb,this.WGe),this.gHb++,this.PZf(l,this.gHb)||this.isc(this.WGe);else if(this.gHb=0,b){this.cIa=new Date;this.DXa=0;this.Ig.qre=this.cIa;this.Ig.pre=f;xa.a.J(512360727,801,50,"DocNotifyClient.OnResponseReceived - {0} - Success response. TimeSinceLastServerConnected:{1}, Now:{2}, PopSessionID:{3}",this.T4,l,Nc.a.uf(new Date),this.a0?this.Ya.Uk:"Not Applicable");c=0;f={};for(const y of b.Items)y.TimeStamp>c&&(c=y.TimeStamp),f[y.LastRequestCorrelationID]=
y.LastRequestCorrelationID in f?String.format("{0},{1}",f[y.LastRequestCorrelationID].toString(),y.Key):y.Key,Ak.d(this.bFb,H=>y.Key.startsWith(H.KeyRoot),H=>{y.TimeStamp>H.TimeStamp&&(H.TimeStamp=y.TimeStamp)},1);this.isc(this.WGe);0<Object.keys(f).length&&Nc.a.Ak("RequestCorrelationIDsAndKeyRoots",Me.c(f));c=new Date;Nc.a.NF(Nc.a.Kb,()=>{const y=Object.assign(new NK,{items:b.Items});for(const H of this.TX)try{H(this,y)}catch(Q){xa.a.J(512360726,801,15,"DocNotifyClient::OnResponseReceived - {0} - Unhandled exception notifying clients {1}, {2}",
this.T4,Q.toString(),Q.stack)}});Nc.a.Ak("ProcessItemStartTime",Nc.a.uf(c));Nc.a.Ak("ProcessItemDurationInMS",(+new Date-+c).toString());Nc.a.Kb.finish()}else xa.a.J(512360728,801,15,"DocNotifyClient.PerformCall - {0} - NULL response, TimeSinceLastServerConnected:{1}, RequestStatus:{2}, HttpStatusCode:{3}, PodSessionId:{4}, PopSessionId:{5}",this.T4,l,c?c.status:3,c?c.Ke:-1,this.Ya.podSessionId,this.a0?this.Ya.Uk:"Not Applicable"),this.PZf(l,this.DXa)||(f=3<=this.DXa?this.EAg[3]:this.EAg[this.DXa],
this.DXa++,this.isc(f),Nc.a.Ak("FailureCountSinceLastSuccess",this.DXa.toString()),Nc.a.Ak("NextDelayInMS",f.toString()),c&&(Nc.a.Ak("RequestStatus",mg.a[c.status]),Nc.a.Ak("HttpStatus",c.Ke.toString()),Nc.a.Ak("Duration",(+c.wv-+c.iu).toString())),Nc.a.Kb.finish());else xa.a.J(512360731,801,50,"DocNotifyClient.PerformCall - {0} - requestID not matched.",this.T4)}PZf(a,b){return this.a0&&(a>=this.cGb||b>this.D5.getHostSessionInfoMaxRetryCount)?(xa.a.J(512360725,801,15,"DocNotifyClient.PerformCall - {0} - Failed enough times, for a time long enough. FailureCount:{1}, PopSessionId:{2}, PopSessionInitialized:{3}",
this.T4,b,this.Ya.Uk,this.Ig.rG),!0):!1}close(a){xa.a.J(512360724,801,50,"DocNotifyClient.Close - {0} - Reason: {1}",this.T4,a);this.tma=!0;this.uYa&&this.uYa.fxd()}isc(a){const b=Nc.a.kk(this.T4,2);b.Wa("DelayInMS",a.toString());this.k$c?Nc.a.bba(()=>{Nc.a.NF(b,Object(I.a)(this,this.rfh,"performCall"))},a,0):window.setTimeout(()=>{Nc.a.NF(b,Object(I.a)(this,this.rfh,"performCall"))},a)}rfh(){if(!this.enabled||w.AFrameworkApplication.Yg||this.ZHa&&+new Date-+this.ZHa<this.YFb||this.a0&&!this.pc.VL||
this.$ea.T1c)xa.a.J(512360723,801,50,"DocNotifyClient.PerformCall - {0} - Skipped. Enabled:{1}, IsShuttingDown:{2}, LastCallStartTime:{3}, Now:{4}, PerformCallExpireTimeInMs:{5}, IsNonDismissibleDialogShown:{6}, AppInReadMode:{7}, AppInReadModeAndCanNotEditAnyway:{8}",this.T4,this.enabled,w.AFrameworkApplication.Yg,this.ZHa?Nc.a.uf(this.ZHa):"null",Nc.a.uf(new Date),this.YFb,this.$ea.T1c,!this.pc.Pn,!this.pc.VL);else{var a=Hg.a.create().toString();xa.a.J(512360722,801,50,"DocNotifyClient.PerformCall - {0} - Executed, LastCallStartTime:{1}, Now:{2}, PerformCallExpireTimeInMs:{3}, PopSessionId:{4}, CorrelationId:{5}",
this.T4,this.ZHa?Nc.a.uf(this.ZHa):"null",Nc.a.uf(new Date),this.YFb,this.a0?this.Ya.Uk:"Not Applicable",a);if(!this.a0){var b=Ak.e(this.bFb,y=>y.KeyRoot===jg.a.whh);b&&b.length&&xa.a.J(512360721,801,50,"Getupdates. CurrentTimestamp:{0}",b[0].TimeStamp)}this.ZHa=new Date;b=Nc.a.Kb;var c=new OK(this,b,this.Ya,this.Ud,this.D5,this.a0?null:this.dY);this.HLg=c.id;this.uYa=new tR.a;var f=this.a0?this.Ya.Uk:"",l=this.a0?"":this.Ya.podSessionId;b.Wa(hh.a.tvb,a);this.nsk(f,this.Ya.presentationId.string,this.bFb,
y=>{c.NEj(y,f)},y=>{c.MEj(y,f,l)},this.uYa,{["X-CorrelationId"]:a},null,this.YFb)}}get enabled(){return 0<this.bFb.length&&!this.tma}get a0(){return this.B0h}o_a(){this.Kjb("PopSessionInitialized")}oib(){this.close("PopsUninitialized")}Rsd(a){a||(a=[]);xa.a.J(512360719,801,50,"DocNotifyClient.SetSubscriptions - {0} - {1} subscriptions.",this.T4,a.length);for(const b of a);this.bFb=a;this.cIa=new Date;this.gHb=this.DXa=0;this.isc(0)}nzf(a){Array.add(this.TX,a)}Oxa(){this.Kjb("AppListener:OnReboot")}Kjb(a){xa.a.J(512360718,
801,50,"DocNotifyClient.Reboot - {0} - Reason: {1}, PopSession: {2}",this.T4,a,this.a0?this.Ya.Uk:"Not Applicable");this.a0&&"PopSessionInitialized"===a&&this.lbl();this.tma=!1;this.ZHa=null;this.cIa=new Date;this.gHb=this.DXa=0;this.uYa&&this.uYa.fxd();this.isc(0)}lbl(){for(const a of this.bFb)a.TimeStamp=0}dispose(){this.Mc.Laa(Object(I.a)(this,this.OM,"onSessionClosed"));this.Mc.hpd(Object(I.a)(this,this.k1,"onSessionRehydrating"));this.Mc.zga(Object(I.a)(this,this.Mo,"onSessionRehydrated"));this.a0&&
(this.Mc.Zoh(Object(I.a)(this,this.oib,"onPopSessionClosed")),this.Mc.FVe(Object(I.a)(this,this.o_a,"onPopSessionInitialized")))}}Object(m.a)(xD,"DocNotifyClient",null,[420,107,421,1019]);class yD{constructor(){this.n4c=0}}Object(m.a)(yD,"TimeStampData",null,[]);class PK{constructor(){this.fHa={}}reset(){this.fHa={}}copy(a){this.reset();a=a.fHa;for(let f in a){var b=f,c=a[f];const l=new yD;l.n4c=c.n4c;this.fHa[b]=l}}ENl(a,b){var c=a in this.fHa?this.fHa[a]:new yD;this.fHa[a]=c;c=this.fHa;for(let l in c){var f=
c[l];l.startsWith(a)&&(f.n4c=b)}}Hae(a){return a in this.fHa?this.fHa[a].n4c:0}}Object(m.a)(PK,"HermesContentTimeStampManager",null,[422]);var Sx=d(298);class Tx{constructor(a,b,c,f=null){this.koe=a;this.Ufa=b;this.Dlc=c;this.Ba=f}}Object(m.a)(Tx,"SlideMoveData",null,[]);var uR=d(655),Vj=d(296);class QK{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec){this.ofc=this.Tva=null;this.rU=0;this.hG=null;this.sze=0;this.t6c=null;this.Zze=this.R$c=this.nGg=this.pGg=0;this.zJ=this.WIa=this.GX=null;this.yna=this.Z$c=
0;this.pq=a;this.Fa=b;this.ia=c;this.Tb=f;this.ta=l;this.mu=y;this.oc=H;this.pc=Q;this.pu=ia;this.P0=this.pq.p1;this.jwa=wa;this.pa=Ua;this.Pq=kb;this.Bn=Gb;this.uva=ec}uNj(){this.rU=-1;this.Tva=document.createElement("div");this.Tva.style.visibility=wf.a.Xs;this.Tva.className=Vj.a.RWi;this.P0.appendChild(this.Tva);this.sze=this.yna=this.Z$c=0;if(this.uva){this.ofc=document.createElement("div");this.ofc.className=Vj.a.Wxj;const a=document.createElement("span");a.className=Vj.a.Xxj;this.ofc.appendChild(a)}}dispose(){this.P0.removeChild(this.Tva);
this.mu.oF(this.P0,this);this.Tva=this.hG=null}Mv(a){return a?this.mJ(a).returnValue:!1}mJ(a){var b=null;if(3===a.ng||a.LA!==Sys.UI.MouseButton.leftButton||!this.P0.contains(a.Bc)||!this.pc.Pn)return{returnValue:!1,pwb:b,m4:null};var c=a.clientPoint.y-this.P6e+this.P0.scrollTop;b=a.clientPoint.x-this.P0.offsetLeft;this.pu&&(b-=this.P0.offsetWidth-this.P0.clientWidth);b=this.lvj(b,c);if(!b||!b.UL)return{returnValue:!1,pwb:b,m4:null};if(this.uva){a=this.pa.Se();if(1>a.length)return{returnValue:!1,pwb:b,
m4:null};for(var f of a)if(f.gO||32!==this.ia.Ka(ea.a.wSe,1,f.Db))return{returnValue:!1,pwb:b,m4:null};f=this.pq.iZ-this.pa.Se().length+1;this.nGg=Math.min(this.E4f(c),f);this.pGg=Math.min(b.slideIndex,f-1)}else if(c=b.slideId,Va.a.Cw(c)||32!==this.ia.Ka(ea.a.wSe,1,c))return{returnValue:!1,pwb:b,m4:null};return{returnValue:!0,pwb:b,m4:null}}Yu(a){if(!a)return!1;this.Tva||this.uNj();this.t6c=uR.a(0,0);if(!({pwb:this.GX,m4:H}=this.mJ(a)).returnValue)return!1;if(this.Bn){var b=!1,c=this.GX.slideId,f=
this.pa.Se();for(var l of f)if(l.Db.equals(c)){b=!0;break}if(b){if(this.zJ=this.ta.Ba,1<f.length&&!this.uva)return!1}else this.pa.nh(),this.zJ=this.GX.gd,this.pa.rP(this.GX.gd)}if(this.uva){this.SOh();var y=this.GX.Rzb;var H=y.cloneNode(!0);b=H.getElementsByTagName("img")[0];this.Iwh(b,Vj.a.xee,Vj.a.wee,Vj.a.S0f,Vj.a.S0f);H.className=Vj.a.Edg;c=this.pa.Se();f=1;if(1<c.length){for(l=0;l<c.length;l++)if(this.GX.slideIndex!==c[l].slideIndex){f++;y=this.pq.IQ(c[l].slideIndex).Rzb;y=(y=y.getElementsByTagName("img"))&&
0<y.length?y[0].cloneNode(!0):b.cloneNode(!0);const Q=Vj.a.wee*f;this.Iwh(y,Vj.a.xee-f,Vj.a.wee-1,Q,Q);H.appendChild(y);if(3===f)break}H.appendChild(this.ofc);this.ofc.firstChild.innerText=this.pa.Se().length.toString()}this.hG?this.pq.p1.replaceChild(H,this.hG):this.pq.p1.appendChild(H);this.hG=H}else b=this.GX.Rzb,this.hG?(b=this.hG.getElementsByTagName("img"),H=H.cloneNode(!0),H.style.zIndex=String(Vj.a.xee),this.hG.replaceChild(H,b[0]),this.hG.style.zIndex=String(Vj.a.Uxj)):(this.hG=b.cloneNode(!0),
this.pq.p1.appendChild(this.hG),this.hG.className=Vj.a.Edg);this.sze=parseInt(af.a.rt(this.hG).height);rb.a.opa(this.hG,Vj.a.Ndh+Vj.a.idh+Vj.a.kkg,this.pu);this.hG.style.visibility=wf.a.Oz;this.hG.style.cursor=wf.a.nmb;w.AFrameworkApplication.uk("Microsoft.Office.Server.Powerpoint.Web.IPptSlideReorderingImprovementSettings");xa.a.J(512497671,819,50,"PPT drag slide start.");this.Rw(a);return!0}SOh(){this.R$c=this.nGg;this.Zze=this.pGg;let a=0;for(let b=0;b<this.pq.iZ;b++){const c=this.pq.IQ(b);c.isSelected?
c.cxc(-2):(a===this.GX.slideIndex&&(a+=1),c.cxc(a),a++)}}Iwh(a,b,c,f,l){a.className=Vj.a.Txj;a.style.zIndex=String(b);a.style.borderWidth=c.toString()+"px";a.style.top=f.toString()+"px";a.style.left=l.toString()+"px"}Rw(a){if(!a)return!1;var b=a.clientPoint,c=b.y-this.P6e+this.P0.scrollTop,f=this.sze/2;if(this.jwa){if(z.a.bU&&!a.mc.rawEvent.buttons)return xa.a.J(512497670,819,50,"PPT cancel drag slide in IE/Edge because release mouse button outside of the browser window."),!1;this.hG.style.top=Math.min(c-
f,this.uva?Sx.a.zV+(this.pq.iZ-this.pa.Se().length)*this.pq.dta:Sx.a.zV+this.pq.iZ*this.pq.dta)+"px"}else{a=this.Y8b(this.pq.iZ)+this.pq.dta/2;if(this.y2i(b.x)||c>a)return this.mxh(),!0;this.hG.style.top=c-f+"px"}this.Hwh(!0);this.Dyi(b.y);this.nkl(Math.min(this.E4f(c),this.uva?this.pq.iZ-this.pa.Se().length+1:this.pq.iZ));this.Tva.style.visibility=this.t2c(b)&&!this.uva?wf.a.Oz:wf.a.Xs;if(this.uva&&0<=this.rU)if(this.t2c(b)){this.hG.style.visibility=wf.a.Oz;if(this.R$c===this.rU)return!0;b=this.R$c<
this.rU?0>this.rU-1?0:this.rU-1:0>this.rU?0:this.rU;c=0;for(f=0;f<this.pq.iZ;f++)a=this.pq.IQ(f),a.isSelected||(c<b?a.cxc(c):a.cxc(c+1),c++);this.R$c=this.rU;this.Zze=b}else this.SOh(),this.hG.style.visibility=wf.a.Xs;return!0}to(a){if(!this.ta.presentation)throw Error.argumentNull("Presentation is null");var b=a.clientPoint;if(this.uva){if(a=this.pa.Se(),0<a.length&&0<=this.rU&&this.t2c(b)){b=[];for(const c of a)c&&b.push(Object(qa.a)(117,c));this.WFl(b,this.Bsj(this.Zze));xa.a.J(512497669,819,50,
"PPT drag slide succeed.")}}else 0<=this.rU&&this.GX&&this.t2c(b)&&this.GX.slideIndex!==this.rU&&this.GX.slideIndex+1!==this.rU&&(this.RFl(this.GX.slideIndex,this.rU),xa.a.J(512497668,819,50,"PPT drag slide succeed."));this.lL()}Bsj(a){let b=0;for(let c=0;c<this.pq.iZ;c++)if(!this.pq.IQ(c).isSelected&&(b++,a===b))return c+1;return 0}t2c(a){a=a.x>=this.P0.offsetLeft&&a.x<=this.P0.offsetLeft+this.P0.offsetWidth;return!this.jwa||a}Au(){this.lL()}lvj(a,b){if(!this.pq.dta)return null;var c=Math.floor((b-
Sx.a.zV)/this.pq.dta);if(0<=c&&c<=this.pq.iZ-1){c=this.pq.IQ(c);if(!c)return null;const f=c.Nmb;a=this.pu?a-parseInt(f.style.right.replace("px","")):a-parseInt(f.style.left.replace("px",""));b-=parseInt(f.style.top.replace("px",""));if(0<=a&&0<=b&&a<=f.clientWidth&&b<=f.clientHeight)return c}return null}y2i(a){return this.pu?this.t6c.width-Vj.a.pVf>a||this.t6c.width<a:0>a||Vj.a.pVf<a}Dyi(a){const b=a-this.P6e,c=this.t6c.height;if(Vj.a.XDf>b)this.yna=-Vj.a.WDf;else if(Vj.a.ZDf>b)this.yna=-Vj.a.YDf;
else if(Vj.a.aEf>b)this.yna=-Vj.a.$Df;else if(c-Vj.a.XDf<a)this.yna=Vj.a.WDf;else if(c-Vj.a.ZDf<a)this.yna=Vj.a.YDf;else if(c-Vj.a.aEf<a)this.yna=Vj.a.$Df;else{this.yna=0;return}this.qfh()}qfh(){if(0!==this.yna){const a=this.Z$c,b=(new Date).getTime();0<a&&(this.P0.scrollTop=Math.max(0,this.P0.scrollTop+Math.floor((b-a)*this.yna/1E3)));this.Z$c=b;window.setTimeout(Object(I.a)(this,this.qfh,"performAutoScrolling"),Vj.a.Boi)}else this.Z$c=0}Y8b(a){return this.pq.dta*a+Sx.a.zV*(this.jwa?.75:1)}E4f(a){a+=
this.pq.dta/2;a-=Sx.a.zV;a=Math.floor(a/this.pq.dta);return this.jwa?Math.max(0,a):a}nkl(a){this.rU!==a&&(this.rU=a,0>this.rU||(this.Tva.style.top=rb.a.Pc(this.Y8b(a))))}mxh(){this.Hwh(!1)}Hwh(a){this.hG.style.cursor=a?wf.a.nmb:wf.a.$Bl}RFl(a,b){const c=this.ta.presentation;if(!c)throw Error.argumentNull("Presentation is null");if((this.WIa=Yb.a.clone(this.ta.presentation.rK))&&!(b>this.WIa.length||a>=this.WIa.length)){var f=null;a=c.Yce(a);b&&(f=c.Yce(b-1));b=new Tx(!1,[a],f);this.ia.Ka(ea.a.Jlc,
2,b)}}WFl(a,b){const c=this.ta.presentation;if(!c)throw Error.argumentNull("Presentation is null");!(this.WIa=Yb.a.clone(this.ta.presentation.rK))||b>this.WIa.length||!this.LZj(a,b)||(b=b?c.Yce(b-1):null,a=new Tx(!1,a,b,this.zJ),this.ia.Ka(ea.a.Jlc,2,a))}LZj(a,b){const c=Object.assign(new Na.a,{});for(var f=0;f<a.length;f++)c.add(a[f].slideIndex);c.Sc((l,y)=>l-y);a=c.count;for(f=0;f<a-1;f++)if(1!==c.ga(f+1)-c.ga(f))return!0;return c.ga(0)<=b&&c.ga(a-1)+1>=b?!1:!0}lL(){this.HMl();this.mxh();this.hG.style.visibility=
wf.a.Xs;this.hG.style.top="0px";this.hG.style.cursor=wf.a.XA;this.Tva.style.visibility=wf.a.Xs;if(this.uva){const a=this.Pq.je(3);try{const b=this.ta.presentation;if(!b)throw Error.argumentNull("Presentation is null");a.ld(b);a.YLa(this.pq.Na);const c=b.slides||[];for(const f of c){const l=Object(qa.a)(118,f);l&&l.anchor.sk(this.pq.Na,16)}}finally{a&&a.dispose()}this.pq.Z0a()}this.yna=0;this.GX&&(this.GX=null);this.Fa.Ee&&this.Fa.Ee.name===jb.a.lF||this.Fa.vf(jb.a.lF)}HMl(){this.Bn?this.zJ&&(this.Tb.Ba=
this.oc.Zk(this.zJ.Db)):this.GX&&(this.Tb.Ba=this.GX.gd)}get P6e(){let a=this.P0,b=0;for(;a;)b+=a.offsetTop,a=a.offsetParent;return b}}Object(m.a)(QK,"ThumbnailNavPaneDragAdapter",null,[430,274,107]);class zD{}zD.lai=[ea.a.print,ea.a.find,ea.a.C1,ea.a.F9a,ea.a.Zld,ea.a.Yld,ea.a.bringForward,ea.a.bringToFront,ea.a.sendBackward,ea.a.sendToBack,ea.a.Lja,ea.a.rwd,ea.a.swd,ea.a.A2a,ea.a.z2a,ea.a.Pmb,ea.a.Omb,ea.a.V1a,ea.a.VOb,ea.a.MQb,ea.a.msc,ea.a.D6,ea.a.aZ,ea.a.rVa,ea.a.Wlb,ea.a.Xlb,ea.a.Ylb,ea.a.Zlb,
ea.a.zrc,ea.a.Arc,ea.a.Brc,ea.a.Crc,ea.a.pqd,ea.a.Trc,ea.a.wXe,ea.a.qqd,ea.a.z8a,ea.a.uTa,ea.a.Aka,ea.a.B1a,ea.a.C1a,ea.a.D1a,ea.a.wtc,ea.a.oOb,ea.a.SNb,ea.a.lOb,ea.a.slb,ea.a.Elb,ea.a.NI,ea.a.tQ,ea.a.X5,ea.a.Mhb,ea.a.Jhb,ea.a.Lhb,ea.a.Khb,ea.a.S_a,ea.a.R_a,ea.a.Yxk,ea.a.oTk,ea.a.LCi,ea.a.MCi,ea.a.$Ie,ea.a.aJe,ea.a.bJe,ea.a.cJe,ea.a.vJk,ea.a.rDi,ea.a.deleteComment,ea.a.nVa,ea.a.e_c,ea.a.D$k,ea.a.Zxk,ea.a.pTk,ea.a.Tvc,ea.a.Mvc,ea.a.Ovc,ea.a.Nvc,ea.a.Rvc,ea.a.Qvc];Object(m.a)(zD,"ActionHandledList",
null,[]);class mt{constructor(a,b,c,f){this.Z0=new ul.a;this.AFe=new ul.a;this.ia=a;this.Ea=b;this.pa=c;this.Dg=f;this.XMj();this.YMj()}OBj(a,b,c=null){this.Ea.remapShapeEditCommandEnabled&&((this.pa.rH()||this.pa.Fs())&&this.Z0.Fb(a)?a=this.Z0.ga(a):this.pa.pz()&&this.AFe.Fb(a)&&(a=this.AFe.ga(a)));if(this.Ea.podsTableRTTEnabled&&this.Ea.podsTableCellLockEnabled&&Array.contains(mt.Vdl,a)&&(this.pa.D9()||this.pa.vZj()))return 32;if(!Array.contains(zD.lai,a))return this.ia.Ka(a,2,b,c);const f=this.ia.eq,
l=this.ia.XT;let y=this.ia.Ka(a,1,b);32===y&&(this.Ea.pptDragCancelFix&&(this.ia.eq=f,this.ia.XT=l),y=this.ia.Ka(a,2,b,c));return y}esl(a){return this.Dg.Owb!==a&&this.Dg.Pwb!==a}fxb(a,b,c){return b&&b.name===jb.a.vg&&!this.pa.Fs()&&1===this.pa.Xd().length&&this.pa.pz()&&this.esl(c)?a.fxb(a.Fc(b.parent),c):a.fxb(b,c)}XMj(){this.Z0.$(C.a.upArrow,ea.a.Zlb);this.Z0.$(C.a.downArrow,ea.a.Wlb);this.Z0.$(C.a.leftArrow,ea.a.Xlb);this.Z0.$(C.a.rightArrow,ea.a.Ylb);this.Z0.$(C.a.qOb,ea.a.Crc);this.Z0.$(C.a.Flb,
ea.a.zrc);this.Z0.$(C.a.K1a,ea.a.Arc);this.Z0.$(C.a.L1a,ea.a.Brc);this.Z0.$(C.a.pta,ea.a.msc);this.Z0.$(C.a.WZa,ea.a.Pmb);this.Z0.$(C.a.VZa,ea.a.Omb);this.Z0.$(ea.a.Lja,ea.a.T7a);for(const a of mt.oel)this.Z0.$(a,G.a.ve)}YMj(){for(const a of mt.pel)this.AFe.$(a,G.a.ve)}}mt.oel=[C.a.BDa,C.a.CDa,C.a.L3b,C.a.Hvb,C.a.eSa,C.a.fSa,C.a.b9a,C.a.dSa,C.a.Ihb,C.a.aTa,C.a.X9a,C.a.Hhb,C.a.$Sa,C.a.W9a];mt.pel=[ea.a.F9a,ea.a.uTa,ea.a.Aka,ea.a.MQb];mt.Vdl=[C.a.backspace,C.a.pL,ea.a.z8a];Object(m.a)(mt,"ProcessInputStrategy",
null,[427]);class RK{get bNc(){return[361033,9175267,13924352,749464,2893476,15559503,11745730,8880899,3750201,748043,12084359,1837941,7632250,9195008,3036814,8288617,9967496,7363328]}}Object(m.a)(RK,"PPTColorTable",null,[419]);var vR=d(967);class SK{constructor(){this.cdd={}}y$d(a){return a&&a in this.cdd?this.cdd[a]:null}EFf(a,b){a&&b&&a!==b&&(a in this.cdd||(this.cdd[a]=b))}}Object(m.a)(SK,"PresenceEmailConverter",null,[1018]);var TK=d(914),Ux;(function(a){a[a.appInitInteractivityReady=0]="appInitInteractivityReady";
a[a.appInitChromeReady=1]="appInitChromeReady";a[a.B2I=2]="B2I";a[a.fHasTabSwitch=3]="fHasTabSwitch";a[a.presentationIdReady=4]="presentationIdReady";a[a.earlyDownloadEditorTableCount=5]="earlyDownloadEditorTableCount";a[a.earlyDownloadEditorTable=6]="earlyDownloadEditorTable";a[a.firstCoauthoringStatus=7]="firstCoauthoringStatus";a[a.presenceJsLoadStart=8]="presenceJsLoadStart";a[a.peoplesWellPackageRegister=9]="peoplesWellPackageRegister";a[a.peoplesWellPackageConfig=10]="peoplesWellPackageConfig";
a[a.peoplesWellInit=11]="peoplesWellInit";a[a.peoplesWellInited=12]="peoplesWellInited";a[a.peopleWellPageHiddenDuration=13]="peopleWellPageHiddenDuration";a[a.peoplesWellControlViewRefresh=14]="peoplesWellControlViewRefresh";a[a.peoplesWellUpdateTriggered=15]="peoplesWellUpdateTriggered";a[a.peoplesWellUpdateTriggeredAfterChromeReady=16]="peoplesWellUpdateTriggeredAfterChromeReady";a[a.peoplesWellDisplayed=17]="peoplesWellDisplayed";a[a.jquerySignalRLoadStart=18]="jquerySignalRLoadStart";a[a.jquerySignalRLoadEnd=
19]="jquerySignalRLoadEnd";a[a.presence1JsLoadStart=20]="presence1JsLoadStart";a[a.presencePackageRegister=21]="presencePackageRegister";a[a.presencePackageConfigure=22]="presencePackageConfigure";a[a.presencePackageInitInternalStart=23]="presencePackageInitInternalStart";a[a.presencePackageInit=24]="presencePackageInit";a[a.presencePackageInited=25]="presencePackageInited";a[a.usedEarlyFindSessionResult=26]="usedEarlyFindSessionResult";a[a.startRTCConnection=27]="startRTCConnection";a[a.rtcConnected=
28]="rtcConnected";a[a.rehydrationCount=29]="rehydrationCount";a[a.presenceCount=30]="presenceCount";a[a.presenceDisplayed=31]="presenceDisplayed";a[a.presencePageHiddenDuration=32]="presencePageHiddenDuration";a[a.presenceUpdateNotificationReceived=33]="presenceUpdateNotificationReceived";a[a.presenceUpdateProcessed=34]="presenceUpdateProcessed";a[a.presenceFirstMessageSent=35]="presenceFirstMessageSent";a[a.coauthoringStartTime=36]="coauthoringStartTime";a[a.isSecondUser=37]="isSecondUser";a[a.getFirstPresenceStateUserCount=
38]="getFirstPresenceStateUserCount";a[a.receivedCompletePeristentState=39]="receivedCompletePeristentState";a[a.networkConnectivityLoss=40]="networkConnectivityLoss"})(Ux||(Ux={}));Object(m.b)("EntryName",Ux);class UK{constructor(a,b,c,f){this.Xo=null;this.vEe=this.zbd=0;this.KBe=this.eHg=this.$Ae=this.v$c=!1;this.xte=this.yte=this.Cze=this.Ste=this.aze=0;this.w6c=this.exe=null;this.bcd=new sk.a;this.GWg=new sk.a;this.qOg=new sk.a;this.Vxe=this.$xe=!1;this.xic=a;this.$Ee=b;this.Ej=c;f.execute(l=>
{this.Xo=l});this.bY={};Ql.Task.WAA(this.Ej.iDa,this.bcd.task,this.GWg.task).continueWith(()=>{try{this.iwh(),this.rRc(this.bY),0<ta.a.count(this.bY)&&ka.ULS.sendTraceTag(51242144,814,15,ta.a.toJSON(this.bY)),this.$xe=!0}catch(l){ka.ULS.sendTraceTag(51242145,814,10,l.toString())}});Ql.Task.WAA(this.Ej.iDa,this.qOg.task).continueWith(()=>{try{this.iwh(),this.rRc(this.bY),0<ta.a.count(this.bY)&&ka.ULS.sendTraceTag(594879178,814,15,ta.a.toJSON(this.bY)),this.Vxe=!0}catch(l){ka.ULS.sendTraceTag(594879177,
814,10,l.toString())}});this.j7c={};this.hze={}}VZi(a){this.EIc(a,8,"g_hermesPresenceJS");this.EIc(a,20,"g_hermesPresence1JS");this.EIc(a,18,"g_JquerySignalRMergeJS");this.EIc(a,19,"g_JquerySignalRMergeJSEnd")}EIc(a,b,c){b=Ux[b];b in a||(c=this.tjj(c),0<c&&this.aja(a,b,c))}tjj(a){a=window[a];return void 0===a||null===a?-1:a.getTime()}dispose(){this.v1f();this.W6i();this.WLh();this.bY=this.hze=this.j7c=null}d_i(){this.uCa(25)}c_i(){this.uCa(12)}sck(){this.uCa(15);0<this.appInitChromeReady&&this.uCa(16)}ZZi(a){try{this.zbd||
(this.zbd=a,this.ji(17,this.zbd),this.ji(13,this.K7f(this.B2I,this.zbd)),this.qOg.uK(!0))}catch(b){ka.ULS.sendTraceTag(594879176,814,10,b.toString())}}Sak(a,b){this.ji(6,a);this.ji(5,b)}$Zi(){this.vEe||(this.vEe=Date.now(),this.ji(31,this.vEe),this.v1f())}a_i(){this.uCa(28)}b_i(){this.uCa(27)}lMk(a){const b=[];for(let f in a){var c=a[f];c&&Array.add(b,c.Presence)}return b}e_i(a){a&&(a=this.lMk(a),this.ji(38,a.length),this.ji(37,0<a.length),this.uCa(39));this.GWg.Og(!0)}kbk(a){try{this.bcd.task.isCompleted||
ta.a.Xa(a)||(this.uCa(34),this.bcd.uK(!0))}catch(b){ka.ULS.sendTraceTag(51242146,814,10,b.toString())}}lbk(a){if(!(ta.a.Xa(a)||"presenceUpdateNotificationReceived"in this.bY)){var b=Date.now();this.ji(33,b);this.Cze=this.K7f(this.B2I,b);this.ji(32,this.Cze);this.ji(30,ta.a.count(a));this.Xo&&this.ji(29,this.Xo.h_f)}}E2i(){return!this.bcd.task.isCompleted&&(!this.Xo||!this.Xo.h_f)&&!this.Cze}jbk(){this.uCa(35);this.Ej.VSc&&this.ji(36,this.Ej.VSc.getTime())}s_i(){this.$Ee&&!this.v$c&&(this.v$c=!0,this.$Ee.Syf(Object(I.a)(this,
this.Wmc,"onResourceTimingEntriesAvailable")))}Wmc(a,b){try{a={};for(let c=0;c<b.entries.length;c++){const f=b.entries[c],l=yg.a.Poa(f.url);!this.$Ae&&l.endsWith("rtc2/signalr/negotiate")?(this.$Ae=!0,this.UIc(a,"Negotiate",f.mC)):l.endsWith("rtc2/signalr/connect")?(this.eHg=!0,this.UIc(a,"Connect",f.mC)):!this.KBe&&l.endsWith("rtc2/signalr/start")?(this.KBe=!0,this.UIc(a,"Start",f.mC)):l.endsWith("rtc2/findsession")&&(this.UIc(a,this.aze.toString()+"_FindSession",f.mC),this.aze++)}if(this.$Ae||this.eHg||
this.KBe||0<this.aze)this.WLh(),this.u1f(a)}catch(c){ka.ULS.sendTraceTag(51242147,814,10,c.toString())}}UIc(a,b,c){this.aja(a,b+"FS",c.fetchStart);this.aja(a,b+"RS",c.responseStart);this.aja(a,b+"RE",c.responseEnd)}WLh(){this.v$c&&(this.v$c=!1,this.$Ee.soh(Object(I.a)(this,this.Wmc,"onResourceTimingEntriesAvailable")))}uCa(a){this.ji(a,Date.now())}ji(a,b){this.Nbi(Ux[a],b)}Nbi(a,b){this.aja(this.j7c,a,b);this.aja(this.bY,a,b)}aja(a,b,c){b in a||(a[b]=c)}rRc(a){this.VZi(a);this.aja(a,"B2I",this.B2I);
null!=this.fHasTabSwitch&&this.aja(a,"fHasTabSwitch",this.fHasTabSwitch);null!=this.w6c&&this.aja(a,"firstCoauthoringStatus",this.w6c);this.appInitInteractivityReady&&this.aja(a,"appInitInteractivityReady",this.appInitInteractivityReady);this.appInitChromeReady&&this.aja(a,"appInitChromeReady",this.appInitChromeReady)}iwh(){null==this.w6c&&(this.w6c=this.Ej.iDa.result)}v1f(){this.u1f({})}u1f(a){try{this.rRc(this.j7c),ta.a.forEach(this.j7c,(b,c)=>{b in this.hze||(this.hze[b]=c,a[b]=c)},null),0<ta.a.count(a)&&
ka.ULS.sendTraceTag(41239941,828,50,ta.a.toJSON(a))}catch(b){ka.ULS.sendTraceTag(51242176,814,10,b.toString())}}W6i(){ka.ULS.sendTraceTag(51242177,814,100,"FlushRecords: m_fPresenceUpdateLogged={0}, m_fPeoplesWellDisplayed={1}",this.$xe,this.Vxe);if(!this.$xe||!this.Vxe)try{this.rRc(this.bY),0<ta.a.count(this.bY)&&ka.ULS.sendTraceTag(51242178,814,50,ta.a.toJSON(this.bY))}catch(a){ka.ULS.sendTraceTag(51242179,814,10,a.toString())}}get B2I(){!this.Ste&&wg.a.instance.Zn(ci.a.contentEditable)&&(this.Ste=
wg.a.instance.Tg(ci.a.contentEditable));return this.Ste}get appInitInteractivityReady(){!this.yte&&wg.a.instance.Zn("AppInitStatus_interactivityReady")&&(this.yte=wg.a.instance.Tg("AppInitStatus_interactivityReady"));return this.yte}get appInitChromeReady(){!this.xte&&wg.a.instance.Zn("AppInitStatus_chromeReady")&&(this.xte=wg.a.instance.Tg("AppInitStatus_chromeReady"));return this.xte}get fHasTabSwitch(){null==this.exe&&wg.a.instance.Zn(ci.a.ozd)&&(this.exe=wg.a.instance.Tg(ci.a.ozd));return this.exe}K7f(a,
b){return this.xic?this.xic.d$f(new Date(a),new Date(b)):-1}}Object(m.a)(UK,"PresencePerfLogger",null,[424,107]);class VK{constructor(a,b,c){this.ZXg=this.ufc=this.D7c=this.Nna=null;this.xwe=!1;this.oFe=null;this.ui=a;this.D5=b;this.Mq=c}JXc(){this.Fwb();return this.Nna}igj(){this.Fwb();return this.D7c}getFindSessionResponse(){return this.ui?this.ui.FindSessionResponse:null}F6f(){this.Fwb();return this.ufc}hqj(){this.Fwb();return this.ZXg}fqj(){this.Fwb();return this.oFe}Atd(){this.Fwb();return this.xwe}qck(){if(this.ui){const a=
!!this.ui.PresenceException,b=!isNaN(this.ui.PresenceDownloadEditorTableHttpStatus)&&200!==this.ui.PresenceDownloadEditorTableHttpStatus||!isNaN(this.ui.PresenceFindSessionHttpStatus)&&200!==this.ui.PresenceFindSessionHttpStatus,c={};c.EarlyFindSessionEnabled=this.D5.presenceEarlyFindSessionEnabled;c.EditorCount=this.D7c?this.D7c.length:0;c.ShouldConnectToRtcByDefault=this.xwe;c.EditorTableHttpStatus=this.ui.PresenceDownloadEditorTableHttpStatus;c.FindSessionHttpStatus=this.ui.PresenceFindSessionHttpStatus;
c.CachedException=this.ui.PresenceException;c.IsFindSessionResponseEmpty=!this.ui.FindSessionResponse;c.IsEditorTableResponseEmpty=!this.ui.CoauthHandlerResponse;c.RtcBootTokenContainsValue=!!this.oFe;xa.a.J(41501202,804,a||b?15:50,ta.a.toJSON(c))}}Fwb(){if(this.ui&&!this.Nna)try{if(this.ui.CoauthHandlerResponse){const a=Sys.Serialization.JavaScriptSerializer.deserialize(this.ui.CoauthHandlerResponse);this.D7c=a.EditorTable;this.Nna=a.UserName;this.ufc=a.Email;this.ZXg=a.RtcEndpointUrl;this.xwe=a.FConnectByDefault;
this.oFe=a.RtcBootToken;this.Mq.kah()}}catch(a){xa.a.J(41501204,804,10,"PresencePrepCacheParser - caught exception when parse cache: "+a)}}}Object(m.a)(VK,"PresencePrepCacheParser",null,[433]);class AD{constructor(a,b,c,f=5E3){if(!a)throw Error.create("RTCParams : ClientId is null");this.clientId=a;this.userSessionId=w.AFrameworkApplication.userSessionId;this.wqd=w.AFrameworkApplication.wqd;this.ada=w.AFrameworkApplication.Me;this.ex=b;this.Kvh=c;this.Hsh=f}}Object(m.a)(AD,"RtcParams",null,[]);class WK{constructor(a,
b,c){this.Ydk=a;this.lFe=b;this.l5c=c}VAi(a,b,c){Ea.a.vv(a);Ea.a.vv(b);Ea.a.vv(c)}PTd(a,b,c,f){return f=!a&&0>b?f+Math.abs(b):this.Ydk?(c-b)/4:(c-b)/2}QTd(a,b,c){if(!this.l5c||!b)return c;if(0<=b.className.indexOf(xc.a.VN))if(b.previousSibling)b=b.previousSibling;else return c;const f=this.mXc(b,da.a.G4c),l=this.mXc(b,da.a.mTc);if(isNaN(f)||!f||isNaN(l)||!l||f>=l)return c;const y=new Sys.UI.Bounds(c.x,c.y,c.width,c.height);if(f>=.9*l)return c=(l-f)/2,y.y+=c,y.height-=2*c,y;a=this.ksj(b,a);if(isNaN(a)||
!a)return c;c=(a-f)/2;y.y+=c;y.height-=2*c;return y}Tsj(a,b){if(!this.l5c)return 0;a=this.mXc(a,da.a.G4c);b=Math.ceil((a-b)/2);if(isNaN(b)||0>b)b=0;return b}ksj(a,b){let c=Object(qa.a)(1014,b);b||(c=Object(qa.a)(1014,this.lFe.h8b(a)));if(c&&this.lFe.qUj(c))return this.mXc(a,da.a.mTc);b=0;const f=a.getClientRects();f&&0<f.length&&(b=f[0],b=new Sys.UI.Bounds(Math.floor(b.left),Math.floor(b.top),Math.floor(b.width),Math.floor(b.height)),b=this.lFe.iha(b,c,()=>a.offsetWidth/a.offsetHeight).height);return b}mXc(a,
b){let c=a;for(a=null;!a&&c&&"P"!==c.tagName;)a=L.a.ze(c,b),c=0<=c.className.indexOf(xc.a.fdc)?c.previousSibling:c.parentNode;b=0;a&&(b=parseInt(a.toString(),10));return b}}Object(m.a)(WK,"PptMeasureBoundsUsingSpansStrategy",null,[428]);class BD{constructor(){this.bJa=null}get ilc(){return this.bJa?this.bJa.ilc:0}get Mtc(){return this.bJa?this.bJa.Mtc:!1}get Etd(){return this.bJa?this.bJa.Etd:!1}Q2b(a,b){b&&(this.bJa?this.bJa.Q2b(a,b):b(null))}Gpi(a){this.bJa=a}}Object(m.a)(BD,"PPTProcessImageStrategyProxy",
null,[1012,1013]);class CD{constructor(a,b){this.X3h=a;this.tpf=b}get cLk(){return this.X3h}get VNe(){return this.tpf}Lml(a){this.tpf=a}}Object(m.a)(CD,"PageHiddenRecord",null,[]);class XK{constructor(){this.hna=[];xa.a.J(24440908,801,50,"Init PageHiddenMeter");if(this.hBe=window.document.hidden){const a=new CD(new Date,new Date(9999,12,31));this.hna.push(a)}Ib.a.instance.qb("Common.ITaskManager").Hb(new dd.a(4,2,9E5,Object(I.a)(this,this.maintainPageHiddenRecords,"maintainPageHiddenRecords"),90,
"2"));$addHandler(window,"visibilitychange",Object(I.a)(this,this.onVisibilityChange,"onVisibilityChange"))}d$f(a,b){const c=this.hna.length;let f=0;if(0<c&&a<this.hna[c-1].VNe){a=a.getTime();b=b.getTime();for(let l=0;l<c;++l){const y=Math.max(this.hna[l].cLk.getTime(),a),H=Math.min(this.hna[l].VNe.getTime(),b);y<H&&(f+=H-y)}}return f}onVisibilityChange(){xa.a.J(24440910,801,50,"Page hidden: {0}",window.document.hidden);this.g1k()}g1k(){var a=window.document.hidden,b=new Date;this.hBe!==a&&((this.hBe=
a)?(b=new CD(b,new Date(9999,12,31)),this.hna.push(b)):(a=this.hna.length,0<a&&this.hna[a-1].Lml(b)))}maintainPageHiddenRecords(){const a=new Date;for(;0<this.hna.length&&9E5<+a-+this.hna[0].VNe;)Array.removeAt(this.hna,0)}}Object(m.a)(XK,"PageHiddenMeter",null,[418]);class DD{t6(a){let b=ea.a.Hv(a);return b||(b=C.a.Hv(a))?b:(b=G.a.Hv(a))?b:""}}Object(m.a)(DD,"ActionNameResolver",null,[1011]);class ED{constructor(){this.xa=new Pc.a}xXk(){this.xa.raiseEvent("CIU",Sys.EventArgs.Empty)}yXk(a){this.xa.raiseEvent("CSC",
a)}NXk(a){this.xa.raiseEvent("ETC",a)}Xkh(a){this.xa.raiseEvent("TLSC",a)}PZk(a){this.xa.raiseEvent("TCVEL",a)}PYk(){this.xa.raiseEvent("PRTCC",null)}rYk(){this.xa.raiseEvent("LCK",null)}WSd(a){this.xa.addHandler("CSC",a)}qVe(a){this.xa.removeHandler("CSC",a)}XSd(a){this.xa.addHandler("ETC",a)}roh(a){this.xa.removeHandler("ETC",a)}Jii(a){this.xa.addHandler("TLSC",a)}o9k(a){this.xa.removeHandler("TLSC",a)}Bii(a){this.xa.addHandler("TCVEL",a)}Bhi(a){this.xa.addHandler("PRTCC",a)}$oh(a){this.xa.removeHandler("PRTCC",
a)}Ofi(a){this.xa.addHandler("LCK",a)}}Object(m.a)(ED,"CoauthEventSource",null,[1008,1009,1010]);class FD{constructor(){this.xa=new Pc.a}FZk(){var a=new Sys.EventArgs;this.xa.raiseEvent("OnShowHideAltTextPane",a)}dYk(a){this.xa.raiseEvent("OnImageDescriptionReady",a)}SXk(a){this.xa.raiseEvent("FRHRE",a)}qXk(a){this.xa.raiseEvent("APIRE",a)}kYk(a){this.xa.raiseEvent("IMARE",a)}wzf(a){this.xa.addHandler("OnShowHideAltTextPane",a)}Toh(a){this.xa.removeHandler("OnShowHideAltTextPane",a)}Ggi(a){this.xa.addHandler("OnImageDescriptionReady",
a)}c8k(a){this.xa.removeHandler("OnImageDescriptionReady",a)}zgi(a){this.xa.addHandler("FRHRE",a)}Y7k(a){this.xa.removeHandler("FRHRE",a)}Zfi(a){this.xa.addHandler("APIRE",a)}I7k(a){this.xa.removeHandler("APIRE",a)}Jgi(a){this.xa.addHandler("IMARE",a)}e8k(a){this.xa.removeHandler("IMARE",a)}}Object(m.a)(FD,"CoreExtEventSource",null,[1005,1006,1007]);var YK=d(1060);class GD extends YK.a{constructor(a,b,c,f,l,y,H){super(f,c,a,y,H);this.g6c=new Jd.a(0);this.fXa=b;this.FCe=l}MMj(a,b){let c;(c=this.g6c).$(b,
c.ga(b)+1);this.hXf(a.name,Object(I.a)(this,this.Cjg,"initPackageCallback"),a)}NMj(a,b){let c;(c=this.g6c).$(b,c.ga(b)+1);this.iXf(a.name,Object(I.a)(this,this.Cjg,"initPackageCallback"),1,a)}Cjg(a){a.LMj()}HBh(a,b){return!!a&&!!b&&a.context.XFf!==b.context.XFf}RLe(a,b){if(b>=this.FCe){const c=new Sys.StringBuilder;for(let f=0;f<a.length;++f)0<f&&c.append(","),c.append(String.format('{{"N":"{0}","D":{1}}}',a[f].name,ah.a.MY(a[f].duration,0)));ka.ULS.sendTraceTag(39966927,813,50,"{0}:{1}",c.toString(),
ah.a.MY(b,0))}}onIdle(a){const b=[];this.g6c.forEach((c,f)=>{0<f&&(b.push(c),this.g6c.$(c,0),this.fXa.d5c(c));return!0});ka.ULS.sendTraceTag(39966928,813,50,"[{0}]:{1}",b.join(","),ah.a.MY(a,0))}}Object(m.a)(GD,"DelayLoadedPackageInitializer",YK.a,[]);class Vx{constructor(a,b,c,f,l,y,H,Q,ia){this.NFe=this.MFe=null;this.Ea=a;this.CJ=b;this.Mq=c;this.Ej=f;this.ia=l;this.xH=y;this.Vb=H;this.ke=ia;this.jqk=Q;this.CJ.XSd(Object(I.a)(this,this.hWf,"editorTableUpdate"))}dispose(){this.CJ.roh(Object(I.a)(this,
this.hWf,"editorTableUpdate"))}hWf(){const a=this.Ej.v_;this.KXf();this.Mq.y2c&&(xa.a.J(512496593,814,50,"App::EditorTableUpdate; Refresh Peoples well; MyClientId: {0}; new editor table count: {1}",this.Ej.AD,a.length),this.ia.processAction(G.a.G8a,2))}KXf(){if(!this.Mq.y2c&&this.Ej.AD){xa.a.J(23437903,814,50,"App::EnsurePresence; Presence not loaded yet. Ensure presence on editor table update");try{if(!this.Vb)throw Error.create("Presence is being loaded before the app frame");this.pIl()}catch(a){xa.a.J(512496591,
814,10,"App : EnsurePresence; Exception loading presence: {0}",a)}}}pIl(){xa.a.J(512496590,814,50,"App::EnsurePresence: trigger download js");if(this.Ea.Nwc)Ib.a.instance.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Dda("pptedit.presence",null,()=>d.e(10).then(d.bind(null,1294)));else{const a=Px.a.create("pptedit.presence",this.zNi(),()=>d.e(10).then(d.bind(null,1294)));$k.a.oy(a)}}zNi(){this.fDh.kW((a,b)=>{this.jqk.Mpe=b.succeeded});return[this.fDh]}get Sxl(){this.NFe||(this.NFe=
this.f9f());return this.NFe}get fDh(){this.MFe||(this.MFe=this.yOi());return this.MFe}yOi(){return this.glj()}glj(){return dD.a.create(this.f9f(),null,null,Rc.App.Trg)}f9f(){return this.Ea.podsUseVersionLessJqueryAndSignalR?this.ke.Mwj("jquery.signalr.merge.1.1"+Vx.oXd):w.AFrameworkApplication.lj("jquery.signalr.merge.1.1",2)}}Vx.oXd=".min.js";Object(m.a)(Vx,"PresenceLoader",null,[]);class ZK{constructor(a,b,c,f,l,y,H,Q,ia){this.HHa=this.JHa=!1;this.Ama=this.uma=null;this.Ea=a;this.vy=b;this.HX=c;
this.Ga=f;this.yeb=l;this.nze=y;this.wb=H;this.yy=Q;this.wz=ia;this.g5=this.Ea.podsHtmlTextForEmbeddedFontsIsEnabled&&!!window.self.Promise&&this.yeb.jsg}Dod(a){if(this.g5&&a&&!a.Nl&&a.wBb)if(a.vqe)a.vqe=!1;else if(this.Ga.X0c(a.shapeNode)){var b=this.Ga.FXc(a.shapeNode);b.length&&(this.wz&&this.wz.isEnabled||this.wz&&this.wz.isEnabled?(this.uma=this.Ama=null,this.HHa=this.JHa=!1,this.wz&&this.wz.isEnabled&&this.wz.tT&&(this.wz.Lbb(c=>{xa.a.J(51217114,801,50,"CustomFontListDownloadAndParseCompleted");
this.Ama=c;this.tQc(a,b)}),this.wz.tT.Mbb(()=>{xa.a.J(51217116,801,15,"CustomFontWebRequestFailed");this.JHa=!0;this.tQc(a,b)})),this.yy&&this.yy.isEnabled&&this.yy.tT&&(this.yy.Lbb(c=>{xa.a.J(41521282,801,50,"CloudFontListDownloadAndParseCompleted");this.uma=c;this.tQc(a,b)}),this.yy.tT.Mbb(()=>{xa.a.J(41494535,801,15,"CloudFontWebRequestFailed");this.HHa=!0;this.tQc(a,b)}))):this.hLh(a,b,null,null))}}TFa(a){return a?!0:!1}tQc(a,b){(this.TFa(this.uma)&&this.TFa(this.Ama)||this.TFa(this.uma)&&this.JHa||
this.HHa&&this.TFa(this.Ama)||this.HHa&&this.JHa)&&this.hLh(a,b,this.uma,this.Ama)}hLh(a,b,c,f){a&&!a.Nl&&b&&b.length&&(xa.a.J(41521286,801,50,"TryRemoveFidelityViewOnEmbeddedFontsLoaded"),Promise.all(this.nze.CQh(b,c,Object(I.a)(this.yy,this.yy.createFontUrl,"createFontUrl"),f,Object(I.a)(this.wz,this.wz.createFontUrl,"createFontUrl"),this.HX.KPh,Object(I.a)(this.HX,this.HX.createFontUrl,"createFontUrl"))).then(()=>{xa.a.J(41521288,801,50,"WebFontsLoadCompleted");this.vy.NFa(()=>{this.wb.Hb(new dd.a(2,
1,0,()=>{a&&!a.Nl&&(xa.a.J(41494539,801,50,"TriggerDrawByRemoveFidelityViewOnEmbeddedFontsLoaded"),a.hEa(),a.vqe=!0,a.$A())},90,"109"))})},l=>{xa.a.J(41494541,801,10,"WebFontsLoad failed: {0}",l.toString());a&&!a.Nl&&a.shapeNode&&(a.shapeNode.XUa=!0)}))}}Object(m.a)(ZK,"RemoveShapeFidelityViewForEmbeddedFontController",null,[432]);class $K{constructor(a,b,c,f,l,y,H,Q,ia){this.HHa=this.JHa=!1;this.Ama=this.uma=null;this.ina=new Na.a;this.yva=a;this.An=b;this.HX=c;this.Ga=f;this.yeb=l;this.nze=y;this.wb=
H;this.yy=Q;this.wz=ia}T5k(a){window.self.Promise&&this.yeb.jsg?this.wb.Hb(new dd.a(2,1,0,()=>{try{this.removeFidelityViewOnWebFontsLoaded(a)}catch(b){xa.a.J(40429063,801,10,"RemoveFidelityViewOnWebFontsLoaded exception {0}",b),this.zQb(a)}},90,"102")):this.zQb(a)}zQb(a){if(a&&a.length){for(var b of a)b.Nl||(b.wBb=!0,b.$A()),this.An.xxh();b=0;wg.a.instance.Zn(ci.a.oQ)&&(b=(new Date).getTime()-wg.a.instance.Tg(ci.a.oQ));xa.a.J(560837531,801,50,"RemoveFidelityView - MissingFonts: {0}, Total Duration Since Viewable : {1}",
this.ina.count,b);if(0<this.ina.count){const c=new Map;c.set("PendingFontsCount",this.ina.count.toString());c.set("FidelityViewDuration",b.toString());$d.Health.instance.recordQosError("RemoveFidelityViewWithMissingFonts",["MissingFont"],!1,!1,!0,!1,Object.assign(new Mj.a,{extendedProperties:c}))}a.length=0;xa.a.J(40429065,801,50,"shapeViewElementsDuringBoot draw done")}}removeFidelityViewOnWebFontsLoaded(a){xa.a.J(40429067,801,50,"RemoveFidelityViewOnWebFontsLoadedAndBootComplete");for(var b of a)!b.Nl&&
b.CB&&b.hEa();b=new Date;for(const c of a)if(!c.Nl){const f=this.Ga.Gab(c.shapeNode);for(const l of f)this.ina.contains(l)||this.ina.add(l)}xa.a.J(40429069,801,50,"GetUnsupportedFontsDuration: {0}",+new Date-+b);if(this.ina.count){if(!this.wz||!this.wz.isEnabled)if(!eb.a("EnableRemoveFidelityCloudServiceCheck")||!this.yy||!this.yy.isEnabled){this.Enh(a,this.ina,null,null);return}this.uma=this.Ama=null;this.HHa=this.JHa=!1;this.wz&&this.wz.isEnabled&&(this.wz.Lbb(c=>{xa.a.J(51217157,801,50,"CustomFontListDownloadAndParseCompleted");
this.Ama=c;this.uQc(a,this.ina)}),this.wz.tT&&this.wz.tT.Mbb(()=>{xa.a.J(51217159,801,50,"CustomFontWebRequestFailed");this.JHa=!0;this.uQc(a,this.ina)}));this.yy&&this.yy.isEnabled&&(this.yy.Lbb(c=>{xa.a.J(40429075,801,50,"CloudFontListDownloadAndParseCompleted");this.uma=c;this.uQc(a,this.ina)}),this.yy.tT&&this.yy.tT.Mbb(()=>{xa.a.J(40429083,801,50,"CloudFontWebRequestFailed");this.HHa=!0;this.uQc(a,this.ina)}))}else xa.a.J(40429071,801,50,"No unsupported fonts"),this.zQb(a)}TFa(a){return a?!0:
!1}uQc(a,b){(this.TFa(this.uma)&&this.TFa(this.Ama)||this.TFa(this.uma)&&(this.JHa||eb.a("FidelityCustomServiceDisableCheck")&&!this.wz.isEnabled)||this.HHa&&this.TFa(this.Ama)||this.HHa&&this.JHa)&&this.Enh(a,b,this.uma,this.Ama)}Enh(a,b,c,f){b&&b.count?(xa.a.J(41521300,801,50,"RemoveFidelityViewOnWebFontsLoadedInternal"),Promise.all(this.nze.CQh(b.toArray(),c,Object(I.a)(this.yy,this.yy.createFontUrl,"createFontUrl"),f,Object(I.a)(this.wz,this.wz.createFontUrl,"createFontUrl"),this.HX.KPh,Object(I.a)(this.HX,
this.HX.createFontUrl,"createFontUrl"))).then(l=>{xa.a.J(40429079,801,50,"WebFontsLoadCompleted");if(l)for(let y=0;y<l.length;y++)if(l[y])for(let H=0;H<l[y].length;H++)if(l[y][H]){xa.a.J(40429081,801,50,"Status {0}",l[y][H].status);const Q=l[y][H].family;ma.a.Xa(Q)||l[y][H].status!==um.loaded||-1===Q.lastIndexOf("_")||b.remove(Q.substring(0,Q.lastIndexOf("_")))}this.zQb(a)},l=>{xa.a.J(41521304,801,10,"WebFontsLoad failed: {0}",l.toString());this.wb.Hb(new dd.a(2,1,this.yva.pptWaitForWebFontsLoadingTimeoutMs,
()=>{xa.a.J(40429073,801,50,"Check removing Fidelity View");this.zQb(a)},90,"103"))})):this.zQb(a)}}Object(m.a)($K,"RemoveShapeFidelityViewOnBootController",null,[431]);class aL{constructor(a){this.ia=a}zxl(){this.VCh(ResourceStrings.l_SessionTimeoutErrorMessage)}Axl(){this.VCh(ResourceStrings.l_SessionTimeoutErrorMessageForCommentDraft)}VCh(a){const b=new Ai.StandardDialog;b.Ad=4;b.kg="PPTTimeoutDialog";b.Oe(1,ResourceStrings.L_Refresh);b.Oe(2,ResourceStrings.L_Close);b.sP(ResourceStrings.l_GenericDialogTitle,
a,Object(I.a)(this,this.Hil,"sessionTimeoutDialogHandler"))}Hil(a,b){1===a?(xa.a.J(24261827,801,50,"Button={0};DontShowAgain={1}",a,b),this.dtl()?(xa.a.J(24655755,801,50,"Session Token is expired or about to expire, refresh the page."),this.ia.processAction(ea.a.refreshPage,2)):this.ia.Ka(ea.a.refresh,2,{refreshtrigger:"SessionTimeoutIndicator::SessionTimeoutDialogHandler"})):(xa.a.J(24261829,801,50,"Button={0};DontShowAgain={1}",a,b),this.ia.processAction(ea.a.mxb,2))}dtl(){const a=w.AFrameworkApplication.um,
b=w.AFrameworkApplication.Xia;return 0<a&&(new Date).getTime()>=a-1E3*b}}Object(m.a)(aL,"SessionTimeoutIndicator",null,[425]);class bL{constructor(){this.A$c=!1;this.nOg=[]}get Mpe(){return this.A$c}set Mpe(a){if(!this.A$c&&(this.A$c=a)){for(const b of this.nOg)b();Array.clear(this.nOg)}}}Object(m.a)(bL,"SignalRLoadCompletedListener",null,[426]);class Gz{constructor(a,b,c,f,l,y,H){this.KZg=this.lKg=!1;this.Kfa=this.ZFe=null;this.oNg=this.IBe=!1;this.LZg=this.MZg=this.RNg=this.SNg=0;this.ia=a;this.cgk=
b;this.Tp=f;this.lGe=y;this.Ic=l;this.ni=H;this.Ic.Wyf(Object(I.a)(this,this.FEk,"onLazySorterViewActorActionRegistrationHandler"))}vb(){this.ni||(this.ia.ya(ea.a.Qga,yb.a.application,Object(I.a)(this,this.oxl,"showStatusBarSorterView")),this.ia.ya(ea.a.Wub,yb.a.application,Object(I.a)(this,this.pCi,"closeStatusBarSorterView")))}oxl(a,b,c,f,l){if(2!==c)return 32;if(this.IBe)return this.lGe.instance.Qga(a,b,c,f,l);this.Ic.Wyf(Object(I.a)(this,this.fEh,"sorterViewEventHandler"));this.l$j();this.lKg||
(this.Zre(),this.oNg=!0);return 32}pCi(a,b,c,f,l){if(2!==c)return 32;this.Ic.B7k(Object(I.a)(this,this.fEh,"sorterViewEventHandler"));(this.Kfa=document.getElementById("SlideSorterViewLoadingElementId"))&&document.getElementById("WACDocumentPanel").removeChild(this.Kfa);return this.IBe?this.lGe.instance.Wub(a,b,c,f,l):32}Zre(){this.KZg||(this.KZg=!0,this.ZFe=this.k$j(),this.ZFe.kW(Object(I.a)(this,this.XHk,"onSlideSorterGridLoaded")),$k.a.oy(this.ZFe),this.SNg=Date.now())}XHk(){this.lKg=!0;this.Tp&&
this.Tp.p6("SlideSoterGridDownloadFinished");this.RNg=Date.now();const a=wg.a.instance;a&&(a.lc("SlideSorterOnDemandLoad",this.oNg),a.lc("SlideSorterPkgST",this.SNg),a.lc("SlideSorterPkgET",this.RNg))}l$j(){this.ia.processAction(ea.a.f2b,2);this.Kfa=rb.a.$d();this.Kfa.id="SlideSorterViewLoadingElementId";this.Kfa.className="sorterview-ui-loading-element-class";const a=rb.a.$d();a.className="sorterview-ui-loading-textmessage-class";a.innerText=ResourceStrings.l_SorterViewLoadingTextMessage;const b=
rb.a.$d();b.className="sorterview-ui-loading-spinner-class";const c=rb.a.$d();c.className="sorterview-ui-loading-spinner-inner-class";b.appendChild(c);this.Kfa.appendChild(b);this.Kfa.appendChild(a);document.getElementById("WACDocumentPanel").appendChild(this.Kfa);this.MZg=Date.now()}fEh(){(this.Kfa=document.getElementById("SlideSorterViewLoadingElementId"))&&document.getElementById("WACDocumentPanel").removeChild(this.Kfa);this.LZg=Date.now();this.lGe.instance.Qga(ea.a.Qga,null,2,null,null);const a=
wg.a.instance;a&&(a.lc("SlideSorterLoadingExpST",this.MZg),a.lc("SlideSorterLoadingExpET",this.LZg))}FEk(){this.IBe=!0}k$j(){var a=w.AFrameworkApplication.lj("slidegrid"+Gz.oXd,5);a=this.cgk.Bvb(a);return Px.a.create("pptedit.sorterGrid",this.ni?null:[a],()=>d.e(17).then(d.bind(null,1300)))}dispose(){}}Gz.oXd=".min.js";Object(m.a)(Gz,"SorterViewActorMain",null,[107,434]);class Ov{constructor(a){this.aof=a}onBlur(a,b){this.tse("OnBlur",a,b);(a=sa.InteractiveViewManager.instance.Rd)&&v.FocusManager.mN()&&
a.endEditing(!1,20)}setFocus(a,b){this.tse("SetFocus",a,b);const c=this.aof();c&&!c.isActive&&(a.name!==M.AppFrame.pIj&&a.name!==M.AppFrame.A7i||b.name!==D.AFrame.JW||(c.Itd=!1),c.K_i())}onFocus(a,b){this.tse("OnFocus",a,b);if(v.FocusManager.mN()&&(b=this.aof())&&b.isActive){var c=!!b.editingView;a=a?a.name:"";z.a.Vi&&(a.startsWith(Dl.a.o4b)&&(Xh.GrippersManager.instance.$9b=!0),a.startsWith(Dl.a.o4b)||a===D.AFrame.Fhb||a===D.AFrame.AGh)&&(c=!1);c&&this.J_i(b,a)}}J_i(a,b){const c=a.editingView,f=
v.FocusManager.instance();f.uhe=!0;a.mS();1===c.mode&&3!==w.AFrameworkApplication.Ra.mode&&b===D.AFrame.Fhb&&(a.Nb.Npa.u8d(),c.Qkb());f.uhe=!1}tse(a,b,c){a=String.format("InteractiveViewFocusScopeActions.{0} called. (Scope is moving from '{1}' to '{2}')",a,b?b.name:null,c?c.name:null);il.a.instance.Dw&&ka.ULS.sendTraceTag(38293642,321,15,String.format("{0} {1}","Handling focus/blur events while TaskManager.Instance.IsYielding!",a))}static HMf(a){const b=new Ov(()=>a),c=a.VI,f=v.FocusManager.instance();
f.Fc(c).vCa(Object(I.a)(b,b.onBlur,"onBlur"));f.Fc(c).f8(Object(I.a)(b,b.setFocus,"setFocus"));f.Fc(c).Lca(Object(I.a)(b,b.onFocus,"onFocus"))}}Object(m.a)(Ov,"InteractiveViewFocusScopeActions",null,[]);class HD extends Ov{constructor(a){super(()=>a);this.Gb=a}iLk(){this.Gb.isActive||this.Gb.o_i()}static rGi(a,b){const c=new HD(a);a=a.VI;b.Fc(a).vCa(Object(I.a)(c,c.onBlur,"onBlur"));b.Fc(a).f8(Object(I.a)(c,c.iLk,"pageViewSetFocus"));b.Fc(a).Lca(Object(I.a)(c,c.onFocus,"onFocus"))}}Object(m.a)(HD,
"PageViewInteractiveViewFocusScopeActions",Ov,[]);class Hz{constructor(){this.Ea=this.K=null;this.SJg=!1}get name(){return"PowerPointWebEditor.CoreExt"}Yb(a){this.K=a;this.Ea=a.resolve("PowerPointWebEditor.IApplicationSettings");this.Ea.Mlg&&a.register(418,"PowerPointWebEditor.IPageHiddenMeter").ma().oa(()=>new XK);Hz.OFi(this.K);a.register(ED,"PowerPointWebEditor.CoreExt.CoauthEventSource").as("PowerPointWebEditor.CoreExt.ICoauthEventSource").as("PowerPointWebEditor.CoreExt.ICoauthEventNotifier").as("PowerPointWebEditor.CoreExt.ICoauthEventHandler").ma().oa(()=>
new ED);a.register(FD,"PowerPointWebEditor.CoreExt.CoreExtEventSource").as("PowerPointWebEditor.CoreExt.ICoreExtEventSource").as("PowerPointWebEditor.CoreExt.ICoreExtEventNotifier").as("PowerPointWebEditor.CoreExt.ICoreExtEventHandler").ma().oa(()=>new FD);a.register(419,"Common.IColorTable").ma().oa(()=>new RK);a.register(Fz,"PowerPointWebEditor.CoauthStateCache").as("PowerPointWebEditor.ICoauthStateGetter").as("PowerPointWebEditor.ICoauthStateSetter").ma().oa(()=>new Fz(a.resolve("PowerPointWebEditor.CoreExt.ICoauthEventNotifier"),
a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),new Bb.a(()=>Ib.a.instance.Ia("Common.IRenameProps"))));a.register(420,"PowerPointWebEditor.IDocNotifyClient").ma().oa(()=>new xD(this.Ea,a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.IErrorDialog"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.Ea.yg?a.resolve("PowerPointWebEditor.PodsPopsCore.ISessionHealthManager"):null,(b,c,f,l,y,H)=>{a.resolve("PowerPointWebEditor.IPPTWebService").Zde(c,f,l,y,H)},!1));a.register(421,"PowerPointWebEditor.IPodsDocNotifyClient").ma().oa(()=>new xD(this.Ea,a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.IErrorDialog"),
a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.PodsPopsCore.ISessionHealthManager"),(b,c,f,l,y,H,Q,ia,wa)=>{a.resolve("PowerPointWebEditor.IPopWebService").IWc(b,c,f,l,y,H,Q,ia,wa)},!0));a.register(422,"PowerPointWebEditor.IContentTimeStampManager").ma().oa(()=>new PK);a.register(Nv,"PowerPointWebEditor.CoauthSubscriptionManager").as("PowerPointWebEditor.ICoauthSubscriptionManager").ma().oa(()=>new Nv(a.resolve("PowerPointWebEditor.IDocNotifyClient"),
this.Ea.yg?a.resolve("PowerPointWebEditor.IPodsDocNotifyClient"):null,a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IThumbnailNavigationViewController"),a.resolve("PowerPointWebEditor.IContentTimeStampManager"),a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.resolve("PowerPointWebEditor.IFunctionThrottlerFactory"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),
a.resolve("PowerPointWebEditor.NotificationManager"),this.Ea.gUe,this.Ea.podsPushThumbnailImageIds));a.register(wD,"PowerPointWebEditor.CoauthNotificationManager").ma().oa(()=>new wD(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IThumbnailNavigationViewController"),a.resolve("PowerPointWebEditor.IDocNotifyClient"),this.Ea.yg?a.resolve("PowerPointWebEditor.IPodsDocNotifyClient"):null,a.resolve("PowerPointWebEditor.ICoauthStateSetter"),a.resolve("PowerPointWebEditor.IContentTimeStampManager"),
a.resolve("PowerPointWebEditor.ICoauthSubscriptionManager"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IInboundHelper"),a.Ia("PowerPointWebEditor.IPrefetchManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.View.IViewEventNotifier"),a.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventNotifier"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventNotifier"),
a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager"),a.resolve("PowerPointWebEditor.Core.IPodsPopsEventNotifier"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.Ea,a.resolve("Common.DragInputManager"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.IBusinessBarController")));a.register(Vx,"PowerPointWebEditor.PresenceLoader").ma().oa(()=>new Vx(this.Ea,
a.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),a.resolve("PowerPointWebEditor.ICoauthStateSetter"),a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IPPTApp"),a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.ISignalRLoadCompletedListener"),a.resolve("PowerPoint.IPathManager")));a.register(SK,"PowerpointPresence.PresenceEmailConverter").as("PowerpointPresence.IPresenceEmailConverter").ma();
a.register(423,"PowerpointPresence.IPresenceColorProvider").ma().oa(()=>new vR.a(a.resolve("Common.App.People.IPeopleColorUtils"),a.resolve("PowerPointWebEditor.IApplicationSettings").i1j,a.resolve("PowerPointWebEditor.IApplicationSettings").podsDefaultToRtcForPresenceEnabled));a.register(424,"PowerpointPresence.IPresencePerfLogger").ma().oa(()=>new UK(a.qb("PowerPointWebEditor.IPageHiddenMeter"),a.resolve("PowerPointWebEditor.IApplicationSettings").podsLogRealTimeChannelResourceTiming?a.resolve("Common.NetworkTiming.IResourceTimingLogger"):
null,a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.Ia("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager")));a.register(AD,"PowerpointPresence.RtcParams").ma().oa(()=>new AD(a.resolve("PowerPointWebEditor.ICoauthStateGetter").AD,a.resolve("PowerPointWebEditor.IApplicationContext").Jbg(),a.Ia("Common.ISessionExpirationManager"),a.resolve("Common.IAppSettingsManager").wc("RTCReconnectionSlowDurationMilliseconds",5E3)));a.register(425,"PowerPointWebEditor.ISessionTimeoutIndicator").ma().oa(()=>
new aL(a.resolve("Common.IActionManager")));a.register(426,"PowerPointWebEditor.ISignalRLoadCompletedListener").ma().oa(()=>new bL);a.register(uD,"PowerPointWebEditor.SessionLifetimeManager").as("PowerPointWebEditor.ISessionLifetimeManager").ma().oa(()=>new uD(this.Ea,a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.Ia("PowerPointWebEditor.IGetDocumentCopyHelper"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),
a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.ISessionTimeoutIndicator"),a.Ia("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),a.Ia("PowerPointWebEditor.ICommentSessionManager")));a.register(tD,"PowerPointWebEditor.SessionCleanupHandler").ma().oa(()=>new tD(a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),a.resolve("PowerPointWebEditor.IPptSelectionManager")));a.register(427,"Common.IProcessInputStrategy").ma().oa(()=>new mt(a.resolve("Common.IActionManager"),this.Ea,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Common.IF6Manager")));this.Ea.Un||a.register(TK.a,"PowerpointPresence.PresenceEventSource").as("PowerpointPresence.IPresenceEventSource").as("PowerpointPresence.IPresenceEventNotifier").as("PowerpointPresence.IPresenceEventHandlers").ma().oa(()=>
new TK.a);a.register(428,"Box4.TextMetricsApi.IMeasureBoundsUsingSpansStrategy").ma().oa(()=>new WK(this.Ea.pptEditorDifferentLineHeightEnabled,a.resolve("Box4.IRotatingCoordinateConverter"),this.Ea.Mqg));a.register(429,"Box4.TextMetricsApi.ITextMetricsHelper").ma().oa(()=>new Z);a.register(430,"PowerPointWebEditor.IThumbnailNavPaneDragAdapter").ma().oa(()=>new QK(a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.DragInputManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),w.AFrameworkApplication.isRtl,this.Ea.Vqg,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.Ea.gD,this.Ea.epe));a.register(431,"PowerPointWebEditor.IRemoveShapeFidelityViewOnBootController").ma().oa(()=>
new $K(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IImageViewManager"),a.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Fonts.IFontFaceSetObserver"),a.resolve("PowerPointWebEditor.Fonts.IFontsObserver"),a.resolve("Common.ITaskManager"),a.resolve("Box4.CloudFontService"),a.resolve("Box4.CustomFontService")));a.register(432,"PowerPointWebEditor.IRemoveShapeFidelityViewForEmbeddedFontController").ma().oa(()=>
new ZK(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IAppBootCompletedListener"),a.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Fonts.IFontFaceSetObserver"),a.resolve("PowerPointWebEditor.Fonts.IFontsObserver"),a.resolve("Common.ITaskManager"),a.resolve("Box4.CloudFontService"),a.resolve("Box4.CustomFontService")));a.register(DD,"PowerPointWebEditor.ActionNameResolver").as("PowerPointWebEditor.IActionNameResolver").ma().oa(()=>
new DD);a.register(BD,"PowerPointWebEditor.PPTProcessImageStrategyProxy").as("PowerPointWebEditor.IPPTProcessImageStrategy").as("Box4.IProcessImageStrategy").ma().oa(()=>new BD);a.register(GD,"PowerPointWebEditor.DelayLoadedPackageInitializer").ma().oa(()=>{let b=2;const c=Ib.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptDelayLoadedPackageInitializerTaskPriority;0<=c&&6>c?b=c:xa.a.J(512360583,809,50,"Invalid delay loaded initializer task priority:{0}",c);return new GD(Ib.a.instance.resolve("Common.ITaskManager"),
Ib.a.instance.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder"),Ib.a.instance.resolve("PowerPointWebEditor.Core.IPerformanceHelper"),Ib.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").delayLoadedPackageInitTimeSliceInMs,Ib.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorCPUMeterProfilingLogThresholdInMS,b,94)});a.register(433,"PowerpointPresence.IPresencePrepCacheParser").ma().oa(()=>new VK(window.self,a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.ICoauthStateSetter")));a.register(434,"PowerPointWebEditor.ISorterViewActorMain").oa(()=>new Gz(w.AFrameworkApplication.Ra,a.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory"),a.resolve("PowerPointWebEditor.IPPTApp").Qqe,a.resolve("PowerPointWebEditor.ISessionState"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.Ia("PowerPointWebEditor.ISorterViewActorLazy"),a.resolve("PowerPointWebEditor.IApplicationSettings").Un)).ma();a.resolve("PowerPointWebEditor.ISorterViewActorMain")}init(){var a=
window.g_hermesExtJS;void 0!==a&&null!==a&&wg.a.instance.lc("FirstExtJsExecTime",a);a=new AB.a("CoreExtPackage::Init");try{this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").xla&&this.c8g();this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").NFa(()=>{this.K.resolve("Common.ITaskManager").Hb(new dd.a(0,1,0,Object(I.a)(this,this.fBk,"onBootComplete_DelayExecuted"),90,"21"))});this.Ea.Mlg&&this.K.resolve("PowerPointWebEditor.IPageHiddenMeter");this.K.resolve("Common.IProcessInputStrategy");
this.K.resolve("PowerPointWebEditor.SessionCleanupHandler");this.K.resolve("PowerPointWebEditor.Graph.GraphNodeDelayConnectValidator").disable();this.K.resolve("Box4.IEditingView");const b=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");HD.rGi(b,this.K.resolve("Common.IFocusManager"));b.PKi(this.K.resolve("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter"));this.K.resolve("PowerPointWebEditor.IThumbnailNavPaneDragAdapter");this.K.resolve("PowerPointWebEditor.DelayLoadedPackageInitializer");
this.K.resolve("PowerPointWebEditor.IRemoveShapeFidelityViewForEmbeddedFontController");this.K.resolve("PowerPointWebEditor.IPPTApp").dCk()}finally{a&&a.dispose()}}dispose(){this.K.resolve("PowerPointWebEditor.IPrefetchManager").dispose();this.K.resolve("PowerPointWebEditor.SessionCleanupHandler").dispose();this.K.resolve("PowerPointWebEditor.ICoauthSubscriptionManager").dispose();this.K.resolve("PowerPointWebEditor.IDocNotifyClient").dispose();this.K.resolve("PowerPointWebEditor.IPodsDocNotifyClient").dispose();
this.K.resolve("PowerPointWebEditor.PodsPops.IPopSessionInfoClient").dispose()}c8g(){const a=new AB.a("App::DelayLoadRibbon");try{this.K.resolve("PowerPointWebEditor.IRibbonUser")}finally{a&&a.dispose()}this.SJg=!0;eb.a("FixBootRequestForDeepLink")||this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").$0a(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba)}CIj(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableRibbon&&(document.getElementById("PptEditingRibbon").parentNode.style.display=
"none");this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableTitleBar&&(document.getElementById("AppHeaderPanel").style.display="none",document.getElementById("AppHeaderPanel").style.visibility="hidden");this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableStatusBar&&(document.getElementById("WACStatusBarContainer").style.display="none");this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableNotes&&(document.getElementById("EditingNotesPanel").parentNode.style.display=
"none")}Jli(){"bottom"===this.K.resolve("PowerPointWebEditor.IApplicationSettings").thumbnailPos&&(this.sUd("WACDocumentPanelContent","Horizontal"),this.sUd("EditingThumbnailsPanel","Horizontal"),this.sUd("EditingThumbnailsPanel","EditingThumbnailsPanelShadow"))}sUd(a,b){let c=document.getElementById(a).getAttribute("class").toString();c+=" "+b;document.getElementById(a).setAttribute("class",c)}Ole(){const a=this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba;if(a){const b=new pf.GraphTransaction(2);
try{b.ld(a),a.oea(16)}finally{b&&b.dispose()}}}ndc(a,b){const c=this.K.resolve("PowerPointWebEditor.ISessionState");a.kW(()=>{c&&c.p6(b+"DownloadFinished")});$k.a.oy(a)}C9j(){if(this.Ea.Nwc)this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Dda("pptedit.comment",null,()=>d.e(9).then(d.bind(null,1290)));else{const a=Px.a.create("pptedit.comment",null,()=>d.e(9).then(d.bind(null,1290)));this.ndc(a,"comment")}}B9j(){if(this.Ea.Nwc)this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Dda("pptedit.chronosslim",
null,()=>d.e(5).then(d.bind(null,1287)));else{const a=Px.a.create("pptedit.chronosslim",null,()=>d.e(5).then(d.bind(null,1287)));this.ndc(a,"chronosslim")}}fBk(){this.K.resolve("PowerPointWebEditor.IPrefetchManager");this.SJg||this.c8g();this.CIj();this.Jli();const a=this.K.resolve("PowerPointWebEditor.ISessionState");this.Ea.separateDownloadSignalREnabled&&this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Dda(this.K.resolve("PowerPointWebEditor.PresenceLoader").Sxl,(f,l)=>{Rc.App.Trg()&&
(this.K.resolve("PowerPointWebEditor.ISignalRLoadCompletedListener").Mpe=l.succeeded)},null);const b=()=>{xa.a.J(512360582,809,50,"Start to download chronos.js file");this.C9j();this.B9j();this.Ea.EDh||this.K.resolve("PowerPointWebEditor.ISorterViewActorMain").Zre()},c=()=>{this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").zlg(()=>{b()})};(new Uq.a(this.Ea.Caa)).k2j?this.K.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader").Bvg().continueWith(()=>{this.Ole()}).continueWith(()=>
{c()}):c();this.K.resolve("PowerPointWebEditor.ISessionTimeUpdater").s7e();this.K.resolve("PowerPointWebEditor.ISessionLifetimeManager").start();a&&a.p6("ChronosStartDownloadTime");try{if(this.Ea.wacAirSpaceResourceLink){const f=$a.a.dvb("wacairspaceanimationlibrary.js"),l=dD.a.create(f,null,null);$k.a.oy(l)}}catch(f){xa.a.J(512360581,814,10,"App : OnBootComplete; Exception loading wacAirSpace Resource: {0}",f)}this.Ea.yg&&this.K.resolve("PowerPointWebEditor.PodsPops.IPopSessionInfoClient").bOj();
w.AFrameworkApplication.fa.ff(()=>{mR.a.instance.Uzi()});MSOJS.ClientUtils.InitUrls(w.AFrameworkApplication.Zcl,w.AFrameworkApplication.Xcl,w.AFrameworkApplication.Ycl)}static main(){w.AFrameworkApplication.Yg&&z.a.gg?xa.a.J(512360580,809,15,"Firefox attempts to load core ext package when App is disposing"):n.a.instance.Ac(new Hz)}static OFi(a){a.register(435,"PowerPointWebEditor.IPrefetchManager").ma().oa(()=>new aq(a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
a.resolve("PowerPointWebEditor.Image.IImageManager"),a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("PowerPointWebEditor.IThumbnailNavigationViewController"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IInboundHelper"),a.resolve("Box4.Graph.IGraphInstance").yd(8),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
a.resolve("PowerPointWebEditor.ISlideCacheStrategy"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.IAppBootCompletedListener"),a.resolve("PowerPointWebEditor.IFontUtilsManager")))}}Object(m.a)(Hz,"CoreExtPackage",null,[2,3]);class cL{constructor(){this.c7c=this.tf=this.Rc=this.nb=null;this.xa=new Pc.a;this.Ab=!1}init(a,b){this.tf=a;this.Rc=b;this.nB()}dispose(){this.nb&&(this.visible=!1,this.Rc.Bb(oa.a.click,
this.nb,Object(I.a)(this,this.PJa,"onBackgroundClick")),this.tf&&this.nb&&(this.tf.removeChild(this.nb),this.nb=null),this.xa&&(this.xa.dispose(),this.xa=null))}nB(){this.nb=document.createElement("div");this.nb.className="EditingNotesDefaultView";w.AFrameworkApplication.isRtl&&(this.nb.style.direction=wf.a.f2a);this.tf.appendChild(this.nb);this.c7c=document.createElement("p");this.c7c.className="EditingNotesDefaultViewContent";this.c7c.innerText=ResourceStrings.l_ClickToAddNotes;this.nb.appendChild(this.c7c);
this.Rc.rb(oa.a.click,this.nb,Object(I.a)(this,this.PJa,"onBackgroundClick"))}PJa(a){this.xa.raiseEvent("OnBackgroundClick",a);return!0}czf(a){this.xa.addHandler("OnBackgroundClick",a)}onResize(){}get visible(){return this.Ab}set visible(a){this.Ab=a;this.nb.style.display=a?Ki.a.block:Ki.a.none}get va(){return this.nb}}Object(m.a)(cL,"NotesPromptView",null,[1045,1046,107]);class dL{constructor(a){this.ncd=this.tf=this.nb=null;this.i9c=this.Ab=!1;this.$jk=a}init(a,b){b.kBb&&(this.tf=a,this.nb=document.createElement("div"),
this.nb.className="EditingNotesReadOnlyView",this.$jk&&(this.nb.style.direction=wf.a.f2a),this.tf.appendChild(this.nb),this.ncd=document.createElement("div"),this.ncd.className="EditingNotesReadOnlyViewContent",a={},a.inputString=b.rhd,b=jSanity.sanitize(a),this.ncd.appendChild(b),this.nb.appendChild(this.ncd),this.i9c=!0)}dispose(){this.i9c&&(this.visible=!1,this.tf&&this.nb&&(this.tf.removeChild(this.nb),this.nb=null),this.i9c=!1)}get visible(){return this.Ab}set visible(a){this.i9c&&(this.Ab=a,
this.nb.style.display=a?Ki.a.block:Ki.a.none)}get va(){return this.nb}}Object(m.a)(dL,"NotesReadOnlyView",null,[1047,107]);var Iz=d(499),ID=d(651);class wr extends Iz.a{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd){super(a,b);this.GFb=this.og=this.vh=this.Efb=null;this.cYa=!1;this.lwa=Rc.App.pn;this.pIa=Object(qa.a)(461,b);this.nb=this.Nd.container;this.hc(this.nb);this.Rc=c;this.Fa=f;this.tgb=l;this.sGb=wa;this.jm=y;this.ai=H;this.Ts=Q;this.OJ=ia;this.kb=Ua;this.rdb=kb;this.v$=
Object(qa.a)(339,a);this.hgc=Gb;this.pc=ec;this.lEe=dc;this.Gwa=Fc;this.VJ=yc;this.ke=tc;this.Obd=xd;this.Up=Vd;this.B8c=this.ke.qk("formatpaintertext.cur");this.Up&&this.VJ.ATd(Object(I.a)(this,this.mnc,"onTextFPActiveChanged"));this.vh||this.nB()}dispose(){this.Rc.Bb(oa.a.click,this.nb.parentNode,Object(I.a)(this,this.PJa,"onBackgroundClick"));this.Up&&this.VJ.KVe(Object(I.a)(this,this.mnc,"onTextFPActiveChanged"));this.tgb&&(this.tgb.dispose(),this.tgb=null);this.sGb&&(this.sGb.dispose(),this.sGb=
null);super.dispose()}Yy(a){super.Yy(a);this.Uwc()}yba(a){this.nE(this.og,a,-1)}c7(){this.oud()}nB(){this.Obd&&(this.GFb=this.Nd.createElement("div"),this.GFb.className="NotesResizeHandle",rf.c(this.GFb,!0),Sys.UI.DomElement.addCssClass(this.GFb,"NotesResizeHandle"),this.htmlElement.appendChild(this.GFb),this.ap(this.GFb));this.Efb=this.Nd.createElement("div");this.Efb.className="NotesContentContainer";this.Efb.id="NotesContentContainer";this.ap(this.Efb);this.htmlElement.appendChild(this.Efb);this.vh=
this.Nd.createElement("div");Sys.UI.DomElement.addCssClass(this.vh,"NotesView");Sys.UI.DomElement.addCssClass(this.vh,"NotesEditViewVisible");this.Efb.appendChild(this.vh);this.ap(this.vh);this.og=this.Nd.createElement("div");Sys.UI.DomElement.addCssClass(this.og,"NotesViewContent");this.vh.appendChild(this.og);this.ap(this.og);w.AFrameworkApplication.isRtl&&(this.vh.style.direction=wf.a.f2a);this.Rc.rb(oa.a.click,this.nb.parentNode,Object(I.a)(this,this.PJa,"onBackgroundClick"));this.tgb.init(this.nb.parentNode,
this.Rc);this.sGb.init(this.nb.parentNode,this.pIa);this.oud();this.tgb.czf(Object(I.a)(this,this.hCk,"onDefaultViewClick"))}oud(){if(this.pIa.kBb)this.cMa(!1),this.m2e(!1),this.Ywl();else{var a=this.jm.Eoe(this.pIa);a=this.cYa||!a;this.cMa(a);this.m2e(!a);this.Up&&this.iC(wr.bfa)}}mnc(a,b){wr.bfa=b.DTc;this.iC(wr.bfa)}iC(a){const b=this.nb.querySelectorAll(".OutlineElement, .EditingSurfaceBody");if(2===a)for(this.nb.style.cursor=rb.a.QN(this.B8c,Ki.a.XA),this.og.style.cursor=rb.a.QN(this.B8c,Ki.a.XA),
a=0;a<b.length;a++)if(b[a].style.cursor!==rb.a.QN(this.B8c,Ki.a.XA))b[a].style.cursor=rb.a.QN(this.B8c,Ki.a.mba);else break;else for(this.nb.style.cursor=Ki.a.XA,this.og.style.cursor=Ki.a.XA,a=0;a<b.length;a++)b[a].style.cursor=Ki.a.mba}Uwc(){this.htmlElement.style.zIndex="0";const a=this.jm.hUa(this.pIa,this.Nd.Md),b=this.jm.G7b(this.pIa,this.Nd.Md);var c=a.width-b[1]-b[3];0>c&&(b[1]+=c/2,b[3]+=c/2);c=a.height-b[0]-b[2];0>c&&(b[1]+=c/2,b[3]+=c/2);wr.r_e(this.vh,b);wr.r_e(this.tgb.va,b);wr.r_e(this.sGb.va,
b);this.Gwa.olb(new Zc.a(a.x,a.y),w.AFrameworkApplication.isRtl,this.vh,!0)}Bib(){this.cYa=!0;this.PU();this.startEditing()}Cib(){this.cYa=!1;this.PU();this.endEditing()}iJ(){return this.cYa}startEditing(){this.Dxa.kBb?this.kb.kj():(this.oud(),this.Ypg()||(this.lwa=this.Dxa.CGa,this.OJ.uxh(this.pIa,!1),this.OJ.$Uk(this.pIa)))}endEditing(){if(!this.Dxa.kBb&&(this.rdb.setVisibility(!1),this.oud(),!this.Ypg())){this.g6g.endEditing(!0,14);this.hgc.x5d(this.v$);var a=this.lEe.Pua(this.Dxa,this.lwa),b=
!!this.Dxa&&this.Dxa.isConnected;a&&(b&&this.Dxa.Msd(),this.ai.F8a(this.Dxa),this.Ts.NYd());this.OJ.uxh(this.pIa,b&&this.Dxa.c1c)}}hCk(a,b){this.PJa(b)}PJa(){this.Fa.tj(Oi.a.o3,!0);this.cMa(!0);this.m2e(!1);this.g6g.mS();this.A2e();this.lwa=this.Dxa.CGa;return!0}Ypg(){return!this.pc.Pn}get va(){return this.htmlElement}get Dxa(){return this.pIa}get g6g(){return this.Qc}A2e(){this.Aba(!0)}Ywl(){this.sGb.visible=!0}m2e(a){this.tgb.visible=a}cMa(a){ID.b(a,this.Efb,"NotesContentContainerHidden","NotesContentContainerVisible")}Aba(a){ID.b(a,
this.vh,"NotesEditViewHidden","NotesEditViewVisible")}static r_e(a,b){a&&(a.style.paddingTop=rb.a.Pc(b[0]),a.style.paddingRight=rb.a.Pc(b[1]),a.style.paddingBottom=rb.a.Pc(b[2]),a.style.paddingLeft=rb.a.Pc(b[3]))}static m_j(a){return a?Sys.UI.DomElement.containsCssClass(a,"NotesResizeHandle"):!1}}wr.bfa=0;Object(m.a)(wr,"NotesViewElement",Iz.a,[1048,1030]);var ns=d(390),wR=d(620),xR=d(852),eL=d(497),Jz=d(496);class fL extends Jz.a{constructor(a,b){super(a,b);this.Zea=[];this.pfc=0}OLb(a,...b){Array.addRange(this.Zea,
b);this.pfc=a}Kqc(){if(this.Zea)for(const a of this.Zea)this.eu.Jqc(this.container,a,this.pfc);this.eu.hK(this.container,this.K3)}Pwc(){this.eu.oF(this.container,this.K3);for(const a of this.Zea)this.eu.oF(this.container,a)}}Object(m.a)(fL,"NotesViewDomManager",Jz.a,[]);var Kz=d(561);class gL extends Kz.ViewSelectionChangedHandler{constructor(a,b){super(a);this.pa=b}Cvb(){return[Object(I.a)(this,this.Zmc,"onSetup"),Object(I.a)(this,this.wmc,"onEnsurePageViewElementsCreated"),Object(I.a)(this,this.xmc,
"onEnsureSelectedContentViewElementsCreated"),Object(I.a)(this,this.Lmc,"onMainLoop"),Object(I.a)(this,this.pFk,"onNotesContentSelect"),Object(I.a)(this,this.rmc,"onCommit"),Object(I.a)(this,this.lnc,"onTearDown")]}pFk(a,b){this.Kga(b);a=Object(qa.a)(461,this.Dh.Ag);if(!a)return!0;a=Object(qa.a)(1048,a.qc(this.Dh.Na));if(!a)return!0;this.pa.Jla()?a.iJ()||a.Bib():a.iJ()&&a.Cib();return!0}}Object(m.a)(gL,"NotesViewSelectionChangedHandler",Kz.ViewSelectionChangedHandler,[]);class JD extends Mv.DragSelectionDragAdapter{constructor(a,
b,c,f,l,y){super(a,b,c);this.kq=f;this.Zse=y;this.jm=l}Yu(a){if(this.Zse){var b=this.Ewc(a);const c=b?b.gb:null;if(c){const f=this.jm.gGa(c)?Object(qa.a)(461,c):this.jm.Gyb(c);if(f&&this.jm.Eoe(f))return!1}if(a.ctrlKey&&b&&c&&(b=this.Nf.K2a(a.clientPoint,b,c,this.Nf,!1))&&wb.HyperlinkReader.Hla(b,!0))return!1}a=super.Yu(a);null!==this.kq&&a&&this.kq.cza(Ki.a.mba);return a}Au(a){super.Au(a);null!==this.kq&&this.kq.Eya()}to(a){super.to(a);null!==this.kq&&this.kq.Eya()}mJ(a){return this.Nf.isActive?
super.mJ(a):!1}static H7b(a){return new JD(a,Ib.a.instance.resolve("Common.IActionManagerExtended"),Ib.a.instance.resolve("Common.IActivityManager"),Ib.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?Ib.a.instance.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,Ib.a.instance.resolve("PowerPointWebEditor.Graph.INotesReader"),Ib.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptNoteDragSelectionFix)}}Object(m.a)(JD,
"NotesDragSelectionDragAdapter",Mv.DragSelectionDragAdapter,[]);var Lz=d(236);class KD{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua){this.HNg=this.jic=this.RBg=this.vDe=this.bIa=0;this.Y$=this.kfc=this.Vad=null;this.sec=this.czg=this.Ead=0;this.Xve=!1;this.v$=a;this.v0=b;this.wi=c;this.Vb=f;this.DA=l;this.Jg=y;this.oc=H;this.Kc=Q;this.Eb=ia;wa.IQa(Object(I.a)(this,this.Qmc,"onOutboundReplication"));this.ia=Ua}Mv(a){return a&&a.LA!==Sys.UI.MouseButton.rightButton?wr.m_j(a.Bc):!1}Yu(a){if(!this.Mv(a))return!1;
this.Xve=!0;this.Vad=this.DA.va;if(!this.Vad)return!1;this.Y$=this.Kc.Jc;if(this.Y$&&(this.kfc=this.Jg.va))this.RBg=this.kfc.clientHeight;else return!1;this.Ead=Math.floor(.75*(this.Vad.clientHeight+this.kfc.clientHeight));this.vDe=this.Vad.clientHeight;this.jic=this.bIa=a.clientPoint.y;this.HNg=this.Y$.UT;this.v0.Al(7);this.v$.endEditing(!0,14);return!0}Rw(a){if(!a)return!1;this.bIa=a.clientPoint.y;a=this.wHf(this.bIa);this.DA.aga=a;this.Vb.yu();a=this.RBg+this.vDe-a;this.kfc.style.height=a+"px";
this.Y$.Kml(a-1);this.Y$.Sol(this.HNg);return!0}to(a){this.v0.D1();this.v$.mS();this.sec=this.wHf(a?a.clientPoint.y:this.bIa);this.ia.Ka(ea.a.m_e,2,this.sec)}Au(){this.Xve&&(this.Xve=!1,this.to(null))}Qmc(){this.sec!==this.czg&&2===Rc.App.Lb.mode&&(this.czg=this.sec,this.vKk(this.sec))}vKk(a){const b=this.oc.tn,c=this.Eb.xd(4);try{c.hc(b),b.BIb=4320,b.aga=this.Svi(a)}finally{c&&c.dispose()}}wHf(a){a=this.vDe+this.wi.om(this.jic-a);0<this.Ead&&a>this.Ead?a=this.Ead:a<Lz.a.HSa&&a>se.a.OQc?a=Lz.a.HSa:
a<se.a.OQc&&(a=se.a.JVf);return a}Svi(a){return this.wi.cPe(a,1)}static H7b(a){return new KD(a,Ib.a.instance.resolve("Common.CursorManager"),Ib.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion"),Ib.a.instance.resolve("Box4.IAppFrame"),Ib.a.instance.resolve("PowerPointWebEditor.INotesPane"),Ib.a.instance.resolve("PowerPointWebEditor.ISlidePane"),Ib.a.instance.resolve("PowerPointWebEditor.IPresentationReader"),Ib.a.instance.resolve("PowerPointWebEditor.IActiveSlideViewManager"),Ib.a.instance.resolve("Common.Transaction.ITransactionFactory"),
Ib.a.instance.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),Ib.a.instance.resolve("Common.IActionManagerExtended"))}}Object(m.a)(KD,"NotesResizeDragAdapter",null,[274]);class hL extends ns.a{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec){super(Oi.a.o3,a,b,c,f,l,H,Q,kb);this.eBe=!1;this.qJa=y;this.pc=ia;this.$f=wa;this.FO=Ua;this.Zse=Gb;this.Up=ec}get qUd(){return w.AFrameworkApplication.fa}ly(a,b=null){this.Up&&this.$f.rb(oa.a.YJ,this.container,Object(I.a)(this,this.Agd,"mouseUpHandlerFilter"));
super.ly(a,b);(a=Object(qa.a)(461,a))&&a.kBb&&this.Cg&&this.Cg.ao&&this.Cg.ao.setAttribute("aria-readonly","true")}detach(){this.Up&&this.Go&&this.$f.Bb(oa.a.YJ,this.container,Object(I.a)(this,this.Agd,"mouseUpHandlerFilter"));super.detach()}O0b(a,b){return new fL(a,b)}lea(a){a=super.lea(a);a.K3=JD.H7b(this);a.OLb(1,KD.H7b(this));return a}nib(a){this.$Cc=a.ng;if(!this.wqc||this.isActive||!this.Zse||(a.mc.type===oa.a.mouseDown||a.mc.type===oa.a.nRa)&&a.LA!==Sys.UI.MouseButton.leftButton)return!1;var b=
a.Bc;if(b&&Sys.UI.DomElement.containsCssClass(b,"NotesResizeHandle"))return!1;let c=!1;ns.a.z8&&(c=ns.a.z8.bta());Rc.App.hE.nT&&Rc.App.hE.nT.rXe(f=>{f&&(c=!0)});b=!eb.a("DeprecateIE.NotesView")&&c&&z.a.iX;a=new wR.a(a,this,!0,b);this.zUk(a);return!1}zUk(a){this.jQe();this.z6(z.a.gg||z.a.NVa);this.Lp.raiseEvent(ns.a.K_c,new xR.a(a.graphNode));this.rTc(a.graphNode);this.q$e();const b=[Object(I.a)(this,this.VJe,"noneClickHandler"),Object(I.a)(this,this.Pyk,"notesSnapToContentClickHandler"),Object(I.a)(this,
this.Kyk,"notesDefaultClickHandler")];for(const c of b)if(c(a).j4){this.eBe=!0;break}}Agd(){return this.eBe&&this.FO.rWa?(this.Ca.processAction(C.a.Aka,2),!0):this.eBe=!1}Kyk(a){const b=ns.a.Xc.Zp(C.a.Uub);b.properties.$(lf.a.source,"DefaultClickHandler");this.Y6(a.tV,a.es,a.graphNode,a.Qc,a.Bj.shiftKey,a.Bj.ctrlKey,a.Bj.ng);b.end();a.oxb&&this.z6(!0);this.editingView.cdb(a.Bj.shiftKey,a.tV,a.Bj.ng);return qh.a.gm(!0)}Pyk(a){if(!a.es){const b=a.es,c=a.graphNode,f=ns.a.Xc.Zp(C.a.Uub);f.properties.$(lf.a.source,
"SnapToContentClickHandler");this.Y6(a.tV,b,c,this,a.Bj.shiftKey,a.Bj.ctrlKey,a.Bj.ng);f.end();a.oxb&&this.z6(!0);this.editingView.cdb(a.Bj.shiftKey,a.tV,a.Bj.ng);return qh.a.gm(!0)}return qh.a.notHandled}hoa(){super.hoa();this.Cg&&this.Cg.ao&&(this.qUd.ka("AccessibilityNotificationEnabledViaAriaLiveRegion")?this.Cg.Isc(Ve.a.tKc):this.Cg.pZe(Box4Intl.Box4Strings.l_EditingSurfaceScreenReaderTitleMessage,"",Ve.a.tKc),this.Cg.ao.setAttribute(Ve.a.er,ResourceStrings.l_NotesPane))}wvd(){this.xF.Rd===this&&
this.suspend()}Wpd(){this.xF.Rd===this&&this.resume()}ZWc(){return new gL(this,Ib.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"))}vUc(){return[Object(I.a)(this,this.VJe,"noneClickHandler"),Object(I.a)(this,this.snapToContentClickHandler,"snapToContentClickHandler"),Object(I.a)(this,this.tripleClickHandler,"tripleClickHandler"),Object(I.a)(this,this.defaultClickHandler,"defaultClickHandler")]}dVc(){return[Object(I.a)(this,this.VJe,"noneClickHandler"),Object(I.a)(this,this.defaultDoubleClickHandler,
"defaultDoubleClickHandler")]}VJe(a){return this.lBb(a)||this.n_j()?qh.a.gm(!0):qh.a.notHandled}RUc(){return[Object(I.a)(this,this.noContextMenuHandler,"noContextMenuHandler"),Object(I.a)(this,this.noViewElementContextMenuHandler,"noViewElementContextMenuHandler"),Object(I.a)(this,this.domElementSelectedContextMenuHandler,"domElementSelectedContextMenuHandler")]}qza(a){this.lBb(a)||super.qza(a)}noContextMenuHandler(a){return this.lBb(a)?sp.a.gm(null):sp.a.notHandled}lBb(a){return!!a&&!!a.graphNode&&
60===a.graphNode.type&&a.graphNode.kBb}n_j(){return!this.pc.Pn}wab(){return eL.a.KIe}get XF(){return super.XF|96}get vOb(){return!0}g7(a,b,c=null){this.qJa.oY(this)&&super.g7(a,b,c)}}Object(m.a)(hL,"NotesView",ns.a,[417,1043,518,166,107,339,814,998,999,1E3]);var iL=d(498),Mz=d(201);class LD{constructor(a,b,c,f){this.aNg=null;this.twa=a;this.ta=b;this.Vq=c;this.uze=f}sOj(){this.aNg=new iL.a(Mz.App.k7a.Nyk,"EditingNotesPanel","EditingNotesPanel InteractiveView");this.twa.OCa(this.aNg.sAa);Ov.HMf(this.twa);
this.xDf(this.ta.Ba);this.Vq.afi(Object(I.a)(this,this.M7g,"onAttachNotesView"))}M7g(a,b){this.l_i();this.xDf(b.gd)}xDf(a){this.ta.presentation&&a&&a.isConnected&&(a=this.uze.Y6f(a,27),this.twa.ly(a))}l_i(){this.twa.Go&&(this.twa.editingView.disable(!0,14),this.twa.detach())}dispose(){this.Vq.e7k(Object(I.a)(this,this.M7g,"onAttachNotesView"))}}Object(m.a)(LD,"NotesViewHelper",null,[107]);class MD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Notes"}Yb(a){this.K=a;this.K.register(417,
"PowerPointWebEditor.INotesView").ma().oa(()=>new hL(this.K.resolve("Box4.IWorkspace"),this.K.resolve("Box4.IInteractiveViewManager"),()=>this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("PowerPointWebEditor.View.IViewValidateStrategy"),this.K.resolve("Box4.IInteractiveEventNotifier"),this.K.Ia("Box4.ITextMetricsAdapter"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.K.resolve("Common.MouseInputManager"),this.K.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),this.K.resolve("Box4.IRotatingCoordinateConverter"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptNoteDragSelectionFix,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled));this.K.register(LD,"PowerPointWebEditor.Notes.NotesViewHelper").ma().oa(()=>new LD(this.K.resolve("PowerPointWebEditor.INotesView"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.Graph.IGraphNodeHelper")))}init(){this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393326,new bm.a((a,b)=>Object(Wa.a)(417,a)?new wr(a,b,this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),new cL,this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),
this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),new dL(w.AFrameworkApplication.isRtl),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IGrippersManager"),this.K.resolve("PowerPointWebEditor.IGraphUpdateStrategy"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoActionBehavior"),this.K.resolve("PowerPointWebEditor.ViewCore.IPPTPositionEditor"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"),
this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Cgh,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled):null));this.K.resolve("Box4.IEditingView");this.K.resolve("PowerPointWebEditor.Notes.NotesViewHelper").sOj()}dispose(){this.K.resolve("PowerPointWebEditor.Notes.NotesViewHelper").dispose()}static main(){n.a.instance.Ac(new MD)}}Object(m.a)(MD,"PPTWebEditorNotesPackage",null,[2,3]);class ND extends Mv.DragSelectionDragAdapter{constructor(a,
b,c,f){super(a,b,c);this.kq=f}Yu(a){a=super.Yu(a);null!==this.kq&&a&&this.kq.cza(Ki.a.mba);return a}Au(a){super.Au(a);null!==this.kq&&this.kq.Eya()}to(a){super.to(a);null!==this.kq&&this.kq.Eya()}mJ(a){return this.Nf.isActive?super.mJ(a):!1}static H7b(a){return new ND(a,Ib.a.instance.resolve("Common.IActionManagerExtended"),Ib.a.instance.resolve("Common.IActivityManager"),Ib.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?Ib.a.instance.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):
null)}}Object(m.a)(ND,"SmartArtTextViewDragSelectionDragAdapter",Mv.DragSelectionDragAdapter,[]);class jL extends Jz.a{constructor(a,b){super(a,b);this.Zea=[];this.pfc=0}OLb(a,...b){Array.addRange(this.Zea,b);this.pfc=a}Kqc(){if(this.Zea)for(const a of this.Zea)this.eu.Jqc(this.container,a,this.pfc);this.eu.hK(this.container,this.K3)}Pwc(){this.eu.oF(this.container,this.K3);for(const a of this.Zea)this.eu.oF(this.container,a)}}Object(m.a)(jL,"SmartArtTextViewDomManager",Jz.a,[]);class kL extends Kz.ViewSelectionChangedHandler{constructor(a,
b,c,f){super(a);this.pa=b;this.We=c;this.XO=f}Cvb(){return[Object(I.a)(this,this.Zmc,"onSetup"),Object(I.a)(this,this.wmc,"onEnsurePageViewElementsCreated"),Object(I.a)(this,this.xmc,"onEnsureSelectedContentViewElementsCreated"),Object(I.a)(this,this.Lmc,"onMainLoop"),Object(I.a)(this,this.fIk,"onSmartArtContentSelect"),Object(I.a)(this,this.rmc,"onCommit"),Object(I.a)(this,this.lnc,"onTearDown")]}fIk(a,b){this.Kga(b);b=Object(qa.a)(4,this.Dh.Ag);if(!b)return!1;a=Object(qa.a)(1049,b.qc(this.Dh.Na));
b=Object(qa.a)(119,b.qc(this.We));if(!a)return!1;this.pa.kWa()?a.iJ()||(a.Bib(),this.XO.Xp(!0),b&&b.Bib()):a.iJ()&&(a.Cib(),this.XO.Xp(!1),b&&b.Cib());return!0}}Object(m.a)(kL,"SmartArtTextViewSelectionChangedHandler",Kz.ViewSelectionChangedHandler,[]);class lL extends ns.a{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec){super(jb.a.iS,a,c,f,l,H,ia,wa,Ua);this.qJa=Q;this.pa=b;this.Pq=y;this.We=kb;this.XO=Gb;this.Fa=ec;this.Md.$9e=!0;this.Md.y8d=!1}get qUd(){return w.AFrameworkApplication.fa}O0b(a,b){return new jL(a,
b)}lea(a){a=super.lea(a);a.K3=ND.H7b(this);return a}hoa(){super.hoa();this.Cg&&this.Cg.ao&&(this.qUd.ka("AccessibilityNotificationEnabledViaAriaLiveRegion")?this.Cg.Isc(Ve.a.tKc):this.Cg.pZe(Box4Intl.Box4Strings.l_EditingSurfaceScreenReaderTitleMessage,Box4Intl.Box4Strings.l_EditingSurfaceF2ScreenReaderDescribedByMessage,Ve.a.tKc),this.Cg.ao.setAttribute(Ve.a.er,ResourceStrings.l_SmartArtTextPane))}wvd(){this.xF.Rd===this&&this.suspend()}Wpd(){this.xF.Rd===this&&this.resume()}ZWc(){return new kL(this,
Ib.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),this.We,this.XO)}Mub(){this.xF.Rd===this&&this.pa.BYd();return!1}vUc(){return[Object(I.a)(this,this.snapToContentClickHandler,"snapToContentClickHandler"),Object(I.a)(this,this.floatieClickHandler,"floatieClickHandler"),Object(I.a)(this,this.tripleClickHandler,"tripleClickHandler"),Object(I.a)(this,this.defaultClickHandler,"defaultClickHandler")]}dVc(){return[Object(I.a)(this,this.defaultDoubleClickHandler,"defaultDoubleClickHandler")]}RUc(){return[Object(I.a)(this,
this.noViewElementContextMenuHandler,"noViewElementContextMenuHandler"),Object(I.a)(this,this.domElementSelectedContextMenuHandler,"domElementSelectedContextMenuHandler")]}onClick(a){a=super.onClick(a);this.Fa.tj(jb.a.iS,!0);return a}wab(){return eL.a.KIe}get XF(){let a=super.XF;return a=eb.a("SmartArt.ListensToRenderOverlayInvalidations")?a|64:a|96}get vOb(){return!0}g7(a,b,c=null){this.qJa.oY(this)&&super.g7(a,b,c)}Ynl(a){const b=this.Pq.je(2);try{b.ld(a);let c=null;c=Od.SelectionFactory.Aj(a,!0);
this.setSelection(c)}finally{b&&b.dispose()}}}Object(m.a)(lL,"SmartArtTextView",ns.a,[415,1043,518,166,107,339,814,998,999,1E3]);class mL extends Iz.a{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua){super(a,b);this.og=this.vh=null;this.cYa=!1;this.lwa=Rc.App.pn;this.$dd=b;this.nb=this.Nd.container;this.hc(this.nb);this.Rc=c;this.Fa=f;this.ia=l;this.ai=y;this.Ts=H;this.OJ=Q;this.rdb=ia;this.v$=a;this.hgc=wa;this.nd=Ua;this.nB()}dispose(){this.Rc.Bb(oa.a.click,this.nb.parentNode,Object(I.a)(this,this.PJa,"onBackgroundClick"));
this.nd.g9k(Object(I.a)(this,this.Fbh,"onSmartArtTextPaneWidthChanged"));super.dispose()}Yy(a){super.Yy(a)}yba(a){this.nE(this.og,a,-1)}c7(){this.cMa(!0)}nB(){this.vh=this.Nd.createElement("div");Sys.UI.DomElement.addCssClass(this.vh,"SmartArtTextView");Sys.UI.DomElement.addCssClass(this.vh,"SmartArtTextViewVisible");this.htmlElement.appendChild(this.vh);this.ap(this.vh);this.og=this.Nd.createElement("div");Sys.UI.DomElement.addCssClass(this.og,"SmartArtTextViewContent");this.og.style.width=rb.a.Pc(se.a.tuc-
2*se.a.XOb-2*se.a.$2e-se.a.SDh);this.vh.appendChild(this.og);this.ap(this.og);w.AFrameworkApplication.isRtl&&(this.vh.style.direction=wf.a.f2a);this.cMa(!0);this.Rc.rb(oa.a.click,this.nb.parentNode,Object(I.a)(this,this.PJa,"onBackgroundClick"));this.nd.vii(Object(I.a)(this,this.Fbh,"onSmartArtTextPaneWidthChanged"))}Bib(){this.cYa=!0;this.PU();this.startEditing()}Cib(){this.cYa=!1;this.PU();this.endEditing()}iJ(){return this.cYa}startEditing(){this.cMa(!0);this.lwa=this.X1a.CGa;this.OJ.Rsc(this.$dd,
!1);this.OJ.wmd(this.$dd)}endEditing(){this.rdb.setVisibility(!1);this.cMa(!0);this.UDh.endEditing(!0,14);this.hgc.x5d(this.v$);const a=new Oj.a(this.X1a,this.lwa);this.ia.Ka(ea.a.vjb,2,a);const b=!!this.X1a&&this.X1a.isConnected;a.Pua&&(b&&this.X1a.Msd(),this.ai.F8a(this.X1a),this.Ts.NYd());this.OJ.Rsc(this.$dd,b&&this.X1a.c1c)}PJa(){this.Fa.tj(jb.a.iS,!0);this.UDh.mS();this.cMa(!0);this.lwa=this.X1a.CGa;return!0}get va(){return this.htmlElement}get X1a(){return this.$dd}get UDh(){return this.Qc}cMa(a){ID.b(a,
this.vh,"SmartArtTextViewHidden","SmartArtTextViewVisible")}Fbh(a,b){this.og.style.width=rb.a.Pc(rb.a.Nn(b.width))}}Object(m.a)(mL,"SmartArtTextViewElement",Iz.a,[1049,1030]);class nL{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb){this.UZg=this.Ddb=null;this.XO=a;this.ZIa=b;this.nd=c;this.Fa=f;this.Ts=l;this.DM=y;this.pa=H;this.Gb=Object(qa.a)(339,Q);this.Vq=ia;this.Dg=wa;this.pc=Ua;this.I0=kb}WOj(){this.UZg=new iL.a(this.XO.LVf,"SmartArtTextViewContainer","SmartArtTextViewContainer InteractiveView EditMode");
this.ZIa.OCa(this.UZg.sAa);Ov.HMf(this.ZIa);this.nd.mii(Object(I.a)(this,this.mbh,"onSingleSmartArtShapeViewElementSelected"));this.nd.nii(Object(I.a)(this,this.nbh,"onSingleSmartArtShapeViewElementSelectedAndEnterTextEdit"));this.nd.uii(Object(I.a)(this,this.Ebh,"onSmartArtShapeViewElementDeselected"));this.nd.E_b(Object(I.a)(this,this.Rjd,"onSlideHtmlUpdated"));this.nd.ifi(Object(I.a)(this,this.Dbh,"onSmartArtCommentsVisibilityChanged"));this.DM.h8(Object(I.a)(this,this.$mc,"onShapeDisconneted"));
this.Vq.fJc(Object(I.a)(this,this.SU,"onFocusChanged"));this.Vq.$Ic(Object(I.a)(this,this.SU,"onFocusChanged"));this.Gb.NQa((a,b)=>{this.Rjd(a,b)})}gva(){return!this.pc.Pn}v2e(a){if(this.I0){if(this.gva()||a.boa)return}else if(this.gva())return;a&&a.Wf&&!a.get_smartArtModelId()&&a.isConnected?(xa.a.J(38618783,822,50,"SmartArtTextViewHelper::ShowSmartArtTextPane - shapeNode is SmartArt"),a.X2e||(this.Ddb!==a&&(this.Ddb=a,this.F5d(),this.yDf(a)),this.XO.A9e(a),this.XO.Xp(!0))):xa.a.J(38618785,822,50,
"SmartArtTextViewHelper::ShowSmartArtTextPane - shapeNode is not SmartArt or not connected")}lxl(a){this.gva()||(a&&a.Wf&&!a.get_smartArtModelId()&&a.isConnected?(xa.a.J(38618787,822,50,"SmartArtTextViewHelper::ShowSmartArtTextPaneForEdit - shapeNode is SmartArt"),a.X2e||(this.Ddb!==a&&(this.Ddb=a,this.F5d(),this.yDf(a)),this.Fa.tj(jb.a.iS,!0),this.Ts.Aw(),this.ZIa.Ynl(a),this.XO.A9e(a),this.XO.Xp(!0))):xa.a.J(38618817,822,50,"SmartArtTextViewHelper::ShowSmartArtTextPaneForEdit - shapeNode is not SmartArt or not connected"))}lUf(){this.XO.isVisible&&
(xa.a.J(38618819,822,50,"SmartArtTextViewHelper::DismissSmartArtTextPane"),this.XO.Xp(!1))}mbh(a,b){this.gva()||this.v2e(b.shapeNode)}nbh(a,b){this.gva()||this.lxl(b.shapeNode)}Ebh(){this.gva()||this.lUf()}Rjd(){if(!this.gva()&&this.pa.$L()){const a=this.pa.dFa();xa.a.J(38618821,822,50,"SmartArtTextViewHelper::OnSlideHtmlUpdated");a&&this.XO.A9e(a)}}SU(a,b){this.gva()||(a=b.Shb,a===jb.a.iS?this.Dg.DI(jb.a.iS):this.Dg.Sac(a)&&this.Dg.Eo(jb.a.iS))}yDf(a){a&&a.isConnected&&this.ZIa.ly(a)}F5d(){this.ZIa.Go&&
(this.ZIa.editingView.disable(!0,14),this.ZIa.detach())}$mc(a,b){this.gva()||b.node!==this.Ddb||(this.Ddb=null,this.F5d(),this.XO.Xp(!1))}Dbh(a,b){this.gva()||((a=b.Dql)?a.Wf&&this.v2e(a):(a=this.pa.dFa())?this.Ddb!==a&&this.v2e(a):this.lUf())}dispose(){this.nd.Z8k(Object(I.a)(this,this.mbh,"onSingleSmartArtShapeViewElementSelected"));this.nd.$8k(Object(I.a)(this,this.nbh,"onSingleSmartArtShapeViewElementSelectedAndEnterTextEdit"));this.nd.f9k(Object(I.a)(this,this.Ebh,"onSmartArtShapeViewElementDeselected"));
this.nd.j7k(Object(I.a)(this,this.Dbh,"onSmartArtCommentsVisibilityChanged"));this.DM.hLa(Object(I.a)(this,this.$mc,"onShapeDisconneted"));this.Vq.BVe(Object(I.a)(this,this.SU,"onFocusChanged"));this.Vq.Zod(Object(I.a)(this,this.SU,"onFocusChanged"));this.nd.pph(Object(I.a)(this,this.Rjd,"onSlideHtmlUpdated"));this.Gb.crc((a,b)=>{this.Rjd(a,b)})}}Object(m.a)(nL,"SmartArtTextViewHelper",null,[416,107]);class OD{constructor(){this.K=null;this.zA=!1}get name(){return"PowerPointWebEditor.SmartArt"}Yb(a){this.K=
a;this.K.register(415,"PowerPointWebEditor.ISmartArtTextView").ma().oa(()=>new lL(this.K.resolve("Box4.IWorkspace"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IInteractiveViewManager"),()=>this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Graph.IGraphTransactionFactory"),this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("PowerPointWebEditor.View.IViewValidateStrategy"),this.K.resolve("Box4.IInteractiveEventNotifier"),
this.K.Ia("Box4.ITextMetricsAdapter"),this.K.resolve("Box4.IRotatingCoordinateConverter"),this.K.resolve("Box4.IPageView").Na,this.K.resolve("PowerPointWebEditor.View.ISmartArtTextPane"),this.K.resolve("PowerPointWebEditor.IFocusManager")));this.K.register(416,"PowerPointWebEditor.ISmartArtTextViewHelper").ma().oa(()=>new nL(this.K.resolve("PowerPointWebEditor.View.ISmartArtTextPane"),this.K.resolve("PowerPointWebEditor.ISmartArtTextView"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("Box4.Graph.IGraphInstance").yd(10),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IPageView"),this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").ela))}init(){const a=this.K.resolve("Common.IAppSettingsManager");
a.ff(()=>{if(this.zA=a.ka("341"))this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(1074135132,new bm.a((b,c)=>Object(Wa.a)(415,b)?(c=Object(qa.a)(4,c))&&c.Wf?new mL(b,c,this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),
this.K.resolve("Box4.IGrippersManager"),this.K.resolve("PowerPointWebEditor.IGraphUpdateStrategy"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")):null:null)),this.K.resolve("Box4.IEditingView"),this.K.resolve("PowerPointWebEditor.ISmartArtTextViewHelper").WOj()})}dispose(){this.zA&&(this.K.resolve("PowerPointWebEditor.ISmartArtTextViewHelper").dispose(),this.K.resolve("PowerPointWebEditor.ISmartArtTextView").dispose())}static main(){n.a.instance.Ac(new OD)}}Object(m.a)(OD,
"PPTWebEditorSmartArtPackage",null,[2,3]);class oL{constructor(){this.lvl9pPrField=this.lvl8pPrField=this.lvl7pPrField=this.lvl6pPrField=this.lvl5pPrField=this.lvl4pPrField=this.lvl3pPrField=this.lvl2pPrField=this.lvl1pPrField=this.defPPrField=null}}Object(m.a)(oL,"CT_WebTextListStyle",null,[]);var gp=d(350);class pL{constructor(a){this.qma=a}d_(a,b){const c=a.tableStyle;if(c){var f=a.tableLook,l=!!(f&32)&&!!c.firstRowField,y=!!(f&64)&&!!c.lastRowField,H=!!(f&128)&&!!c.firstColField,Q=!!(f&256)&&
!!c.lastColField,ia=l&&H&&!!c.nwCellField,wa=l&&Q&&!!c.neCellField,Ua=y&&H&&!!c.swCellField,kb=y&&Q&&!!c.seCellField,Gb=!!(f&512)&&!!c.band1HField,ec=!!(f&512)&&!!c.band2HField,dc=!!(f&1024)&&!!c.band1VField;f=!!(f&1024)&&!!c.band2VField;var Fc=!b.te,yc=b.eg===a.dV,tc=!b.me;a=b.Tf===a.Bsa;var xd=1===b.te%2===l;b=1===b.me%2===H;var Vd=!(l&&Fc)&&!(y&&yc),Ld=!(H&&tc)&&!(Q&&a);c.wholeTblField&&this.apply(c.wholeTblField);Vd&&(Gb&&xd||ec&&!xd)&&(xd?this.apply(c.band1HField):this.apply(c.band2HField));
Ld&&(dc&&b||f&&!b)&&(b?this.apply(c.band1VField):this.apply(c.band2VField));a&&Q&&this.apply(c.lastColField);tc&&H&&this.apply(c.firstColField);yc&&y&&(this.apply(c.lastRowField),a&&kb&&this.apply(c.seCellField),tc&&Ua&&this.apply(c.swCellField));Fc&&l&&(this.apply(c.firstRowField),a&&wa&&this.apply(c.neCellField),tc&&ia&&this.apply(c.nwCellField))}}apply(a){if(a.tcTxStyleField){var b=a.tcTxStyleField;a=Me.a(b);Ge.Box4ColorHelper.Rbb(a)||(gp.g(this.qma),this.qma.solidFillField=new Ot.a,Ge.Box4ColorHelper.Pli(this.qma.solidFillField,
a));a=b.bField;var c=b.iField;if(b.fontRefField){b=b.fontRefField.idxField;var f=this.qma;0===b||1===b?(f.latinField=ff.Evb(b,0),f.eaField=ff.Evb(b,1),f.csField=ff.Evb(b,2)):xa.a.J(8959121,820,10,"StyleResolverHelper::ResolveToThemeFont - Invalid font collection index encountered")}else b.fontField&&(b=b.fontField,null!==b.latinField&&(this.qma.latinField=b.latinField),null!==b.eaField&&(this.qma.eaField=b.eaField),null!==b.csField&&(this.qma.csField=b.csField));if(0===a||1===a)this.qma.bFieldSpecified=
!0,this.qma.bField=0===a;if(0===c||1===c)this.qma.iFieldSpecified=!0,this.qma.iField=0===c}}}Object(m.a)(pL,"CellTextStylePartApplier",null,[]);class nt{constructor(a){this.y0g=a}get value(){return this.y0g.valField/1E5}set value(a){this.y0g.valField=Math.floor(1E5*a)}get type(){return nt.h1b}}nt.h1b="CT_TextSpacingPercent:#Microsoft.Office.Server.Powerpoint.Interface.Edit";Object(m.a)(nt,"LineSpacingPercent",null,[1089,1090]);class xr{constructor(a){this.z0g=a}get value(){return this.z0g.valField/
100}set value(a){this.z0g.valField=Math.floor(100*a)}get type(){return xr.h1b}}xr.h1b="CT_TextSpacingPoint:#Microsoft.Office.Server.Powerpoint.Interface.Edit";Object(m.a)(xr,"LineSpacingPoint",null,[1089,1090]);class yR{constructor(){this.valField=0}}Object(m.a)(yR,"CT_TextSpacingPoint",null,[]);class ot{constructor(a){this.yue=a}get lineSpacing(){return this.yue}get value(){return this.yue.value}set value(a){this.yue.value=a}static n3b(a){if(a.__type===nt.h1b)return new ot(new nt(a));if(a.__type===
xr.h1b)return new ot(new xr(a));xa.a.J(8958300,820,10,"Unsupported line spacing format {0}",a.__type);return null}}Object(m.a)(ot,"LineSpacingWrapper",null,[]);const qL=(a,b)=>{switch(b){case 0:return a.defPPrField;case 1:return a.lvl1pPrField;case 2:return a.lvl2pPrField;case 3:return a.lvl3pPrField;case 4:return a.lvl4pPrField;case 5:return a.lvl5pPrField;case 6:return a.lvl6pPrField;case 7:return a.lvl7pPrField;case 8:return a.lvl8pPrField;case 9:return a.lvl9pPrField;default:return null}},rL=
(a,b)=>{b.baselineFieldSpecified&&(a.baselineFieldSpecified=!0,a.baselineField=b.baselineField);b.bFieldSpecified&&(a.bFieldSpecified=!0,a.bField=b.bField);b.capFieldSpecified&&(a.capFieldSpecified=!0,a.capField=b.capField);b.iFieldSpecified&&(a.iFieldSpecified=!0,a.iField=b.iField);b.noProofFieldSpecified&&(a.noProofFieldSpecified=!0,a.noProofField=b.noProofField);b.rtlFieldSpecified&&(a.rtlFieldSpecified=!0,a.rtlField=b.rtlField);b.strikeFieldSpecified&&(a.strikeFieldSpecified=!0,a.strikeField=
b.strikeField);b.szFieldSpecified&&(a.szFieldSpecified=!0,a.szField=b.szField);b.uFieldSpecified&&(a.uFieldSpecified=!0,a.uField=b.uField);b.altLangField&&(a.altLangField=b.altLangField);b.blipFillField&&(a.blipFillField=b.blipFillField);b.csField&&(a.csField=b.csField);a.dirtyField=b.dirtyField;b.eaField&&(a.eaField=b.eaField);a.errField=b.errField;b.gradFillField&&(a.gradFillField=b.gradFillField);b.grpFillField&&(a.grpFillField=b.grpFillField);b.highlightField&&(a.highlightField=b.highlightField);
b.hlinkClickField&&(a.hlinkClickField=b.hlinkClickField);b.hlinkMouseOverField&&(a.hlinkMouseOverField=b.hlinkMouseOverField);b.langField&&(a.langField=b.langField);b.latinField&&(a.latinField=b.latinField);b.noFillField&&(a.noFillField=b.noFillField);b.pattFillField&&(a.pattFillField=b.pattFillField);b.solidFillField&&(a.solidFillField=b.solidFillField);b.symField&&(a.symField=b.symField)},zR=a=>{switch(a){case 1:return 2;case 2:return 3;case 3:return 6;case 4:return 10;case 5:return 7;case 6:return 13;
default:return 1}};class Wx{constructor(){this.Hub=Array(Wx.hJh);this.aOe=Array(Wx.hJh)}}Wx.hJh=9;Object(m.a)(Wx,"TextListStyleCache",null,[]);class sL{constructor(){this.restartInfo=this.nextNumber=1;this.listStyle=this.nextListId=0;this.autonumberBulletType=8}}Object(m.a)(sL,"NumberingData",null,[]);class Pv{}Pv.SWd="\u2022";Pv.jti="p";Pv.kti="n";Object(m.a)(Pv,"ListFormats",null,[]);class tL{constructor(a,b,c,f){this.C1g=this.D1g=Rc.App.pn;this.bzg=null;this.jc=a;this.jm=b;this.yM=c;this.AA=f}get caches(){return this.bzg||
(this.bzg={})}K4f(a,b,c){const f=c-1;let l=a.i0;var y;const H=!!l&&!ha.a.nil.equals(l[f]);if(H&&(y=this.caches[l[f].toString()]))return y=y.clone(),b=ha.a.create(),a.Lh.ZE(y,b),y;if(!H)if(l)l=Array.clone(l);else for(l=Array(9),y=0;y<l.length;y++)l[y]=ha.a.nil;const Q=H?l[f]:ha.a.create();y=this.$Di(a,b,c);l[f]=Q;this.caches[Q.toString()]=y;H||(a.i0=l);a.Lh.ZE(y,Q);H&&(y=y.clone(),a.Lh.ZE(y,ha.a.create()));return y}$Di(a,b,c){const f=op.a.instance.createInstance(131073);if(b){var l=b.z4f(a.rowIndex,
a.Ai,a.rowSpan,a.colSpan);b=(b=(b=a.listStyle)?qL(b,c):null)||new Ns;if(l){var y=c-1;c=l.Hub[y];y=l.aOe[y];if(c||y){l=b.defRPrField||new dr;if(y){const H=De.a(De.c(y));y=H;b.algnFieldSpecified&&(y.algnFieldSpecified=!0,y.algnField=b.algnField);b.indentFieldSpecified&&(y.indentFieldSpecified=!0,y.indentField=b.indentField);b.lvlFieldSpecified&&(y.lvlFieldSpecified=!0,y.lvlField=b.lvlField);b.marLFieldSpecified&&(y.marLFieldSpecified=!0,y.marLField=b.marLField);b.marRFieldSpecified&&(y.marRFieldSpecified=
!0,y.marRField=b.marRField);b.rtlFieldSpecified&&(y.rtlFieldSpecified=!0,y.rtlField=b.rtlField);b.buAutoNumField&&(y.buAutoNumField=b.buAutoNumField);b.buCharField&&(y.buCharField=b.buCharField);b.buClrField&&(y.buClrField=b.buClrField);b.buClrTxField&&(y.buClrTxField=b.buClrTxField);b.buFontField&&(y.buFontField=b.buFontField);b.buFontTxField&&(y.buFontTxField=b.buFontTxField);b.buNoneField&&(y.buNoneField=b.buNoneField);b.buSzPctField&&(y.buSzPctField=b.buSzPctField);b.buSzPtsField&&(y.buSzPtsField=
b.buSzPtsField);b.buSzTxField&&(y.buSzTxField=b.buSzTxField);b.defRPrField&&(y.defRPrField=b.defRPrField);b.lnSpcField&&(y.lnSpcField=b.lnSpcField);b.spcAftField&&(y.spcAftField=b.spcAftField);b.spcBefField&&(y.spcBefField=b.spcBefField);b=H}c&&(c=De.a(De.c(c)),rL(c,l),b.defRPrField=c)}}a=Object(qa.a)(117,this.jc.mg(a));this.hEi(f,b,a?a.Ed:null)}f.ye(zb.a.E$b,!0);return f}hEi(a,b,c){this.gEi(a,b);if(b){if(b.algnFieldSpecified){var f=zR(b.algnField);a.setValue(ab.a.Vl,f);a.setValue(ab.a.xJ,f)}b.marLFieldSpecified&&
a.ye(Ab.a.nm,xe.a.zwb(b.marLField));b.marRFieldSpecified&&a.ye(Ab.a.CY,xe.a.zwb(b.marRField));b.indentFieldSpecified&&a.ye(Ab.a.uo,xe.a.zwb(b.indentField));b.defTabSzFieldSpecified&&a.setValue(Ab.a.Tvb,xe.a.zwb(b.defTabSzField));b.spcAftField&&(f=ot.n3b(b.spcAftField.itemField),Object(Wa.a)(nt,f.lineSpacing)?a.setValue(zb.a.$la,2):Object(Wa.a)(xr,f.lineSpacing)&&a.setValue(zb.a.$la,4),a.setValue(zb.a.Fea,f.value));b.spcBefField&&(f=ot.n3b(b.spcBefField.itemField),Object(Wa.a)(nt,f.lineSpacing)?a.setValue(zb.a.ama,
2):Object(Wa.a)(xr,f.lineSpacing)&&a.setValue(zb.a.ama,4),a.setValue(zb.a.Gea,f.value));b.lnSpcField&&(f=ot.n3b(b.lnSpcField.itemField),Object(Wa.a)(nt,f.lineSpacing)?a.setValue(zb.a.qX,2):Object(Wa.a)(xr,f.lineSpacing)&&a.setValue(zb.a.qX,4),a.setValue(zb.a.Jx,f.value))}else xa.a.J(8959502,820,10,"TextPropertyHelper::ComposeParagraphProperties - ParagraphProperties is null");b.defRPrField&&Lj.aEi(a,b.defRPrField,c)}Gal(a){if(a=a.i0)for(let b=0;b<a.length;b++){const c=a[b];c&&!ha.a.nil.equals(c)&&
delete this.caches[c.toString()]}}gEi(a,b){var c=this.Gv(b);a.ny(c.propertySet);b.marLFieldSpecified&&a.setValue(Ab.a.nm,xe.a.zwb(b.marLField));b.indentFieldSpecified&&a.setValue(Ab.a.uo,xe.a.zwb(b.indentField));b.defRPrField&&b.defRPrField.szFieldSpecified&&a.setValue(ab.a.fontSize,Lj.zNf(b.defRPrField.szField));b.spcAftField&&(c=ot.n3b(b.spcAftField.itemField),Object(Wa.a)(xr,c.lineSpacing)&&(a.setValue(zb.a.$la,4),a.setValue(zb.a.Fea,c.value)));b.spcBefField&&(b=ot.n3b(b.spcBefField.itemField),
Object(Wa.a)(xr,b.lineSpacing)&&(a.setValue(zb.a.ama,4),a.setValue(zb.a.Gea,b.value)))}Gv(a){let b;({Pse:b,Qdk:c}=this.Wae(a));var c=pe.a.NN(b,c);0===b&&(c.SA=c.oX=a.buAutoNumField.startAtField);return c}Wae(a){let b,c;b=16;c=1;if(a)if(a.buCharField)switch(b=1,a.buCharField.charField){case Pv.jti:case Pv.kti:c=3}else if(a.buAutoNumField)switch(b=0,a.buAutoNumField.typeField){case 9:case 8:case 6:case 7:c=1;break;case 4:case 0:case 2:c=2;break;case 14:case 10:case 12:c=3;break;case 5:case 1:case 3:c=
4;break;case 15:case 11:case 13:c=5}return{Pse:b,Qdk:c}}validate(a){if(Object(qa.a)(pg.a,a)&&(this.jm.gGa(a)||gj.OutlineReader.kX(a))&&a.isConnected){this.D1g=new Date;var b=Array(Zo.a.u8);for(var c=0;c<Zo.a.u8;++c)b[c]=new sL;c=-1;var f=0,l=!1;a=tk.a.bA(a);for(a.qm(Object(I.a)(this,this.l9j,"listOEFilter"),null);a.moveNext();){16===a.iterator.currentNode.type&&(c=-1,f=0,l=!1,this.P_c(b,0),this.Mle(b,0,0));if(11!==a.iterator.currentNode.type)continue;const y=a.iterator,H=this.Sda(y);let Q=b[H].nextListId,
ia=null;if(Zb.ListReader.Hk(y)){this.AA.Wna(y);ia=this.AA.Pae(y);const wa=this.Qaj(y);y.Cc();if(!ia){mc.a.instance.Xb("PossibleIncorrectListNumbering",{["Reason"]:"ListInfoNotFound"});continue}if(0===ia.listType){if(ia.SA!==Ed.a.ax&&b[H].restartInfo!==ia.SA||ia.listStyle!==b[H].listStyle||wa!==b[H].autonumberBulletType)l=!0,b[H].restartInfo=b[H].nextNumber=ia.SA===Ed.a.ax?1:ia.SA,Q=b[H].nextListId=0,b[H].listStyle=ia.listStyle,b[H].autonumberBulletType=wa;ia.oX=b[H].nextNumber;c!==H||l?(ia.kka=b[H].nextNumber,
l=!1):ia.kka=Ed.a.ax;this.yM.isEmpty(y,!1)?l=!0:b[H].nextNumber++}else 1!==ia.listType&&mc.a.instance.Xb("PossibleUnexpectedListAlteration",{["Reason"]:"UnknownListType"});Q||(Q=b[H].nextListId=++f);y.currentNode.listID=Q}c=H;ia?(0===ia.listType?this.P_c(b,H+1):this.P_c(b,H),this.Mle(b,H+1,Q)):(this.P_c(b,H),this.Mle(b,H,0))}this.C1g=new Date;xa.a.J(22344988,820,50,"ListCore::Validate {0}",+this.C1g-+this.D1g)}}Sda(a){this.yM.ih(a)||mc.a.instance.Xb("PossibleListLevelIncorrect",{["Reason"]:Qd.a.wda});
return a.currentNode.sa(Ab.a.listLevel,Df.a.yFa)}kkj(a){this.yM.ih(a)||mc.a.instance.Xb("PossibleLossOfAccessibilityInfoForList",{["Reason"]:Qd.a.wda});return a.currentNode.listID}l9j(a){return this.yM.ih(a)||cd.TableReader.iq(a)||vk.l(a)||ae.isTableCell(a)}P_c(a,b){for(;b<Zo.a.u8;++b)a[b].nextNumber=a[b].restartInfo=1}Mle(a,b,c){for(;b<Zo.a.u8;++b)a[b].nextListId=c}Qaj(a){return a.currentNode.sa(zb.a.autonumberBulletType,8)}}Object(m.a)(tL,"ListCore",null,[411]);class bq{constructor(a,b,c=null){this.Uf=
a;this.Ji=b;this.St=null;this.tqb=c}get gtl(){return!1}c0k(a){return a}INb(a){let b,c,f;b=Zb.ListReader.$9a;c=a.propertySet.sa(Ab.a.listID,0);f=a.propertySet.sa(Ab.a.listLevel,-1);if(N.a.instance.ga(85)||b&&0<c&&0<=f)this.St=a;else{let l=1;const y=a.listStyle;b&&42!==y&&0<y&&(l=y);this.St=pe.a.NN(a.listType,l,null,c,f,void 0,"")}}Tml(a){a&&(this.St=a)}A4d(){}createList(a){const b=mc.a.instance.Zp(C.a.createList);Wd.OutlineElementReader.ih(a)||mc.a.instance.Xb("PossiblyIncorrectListCreation",{["Reason"]:Qd.a.wda});
Zb.ListReader.Hk(a)&&mc.a.instance.Xb("PossiblyIncorrectListCreation",{["Reason"]:Qd.a.ZGi});const c=this.fMi();a.Hl(c,4);a.$k(c);b.end();return c}fMi(){return Vs.a.instance.createInstance(393234)}Roa(a){const b=mc.a.instance.Zp(C.a.Roa);Wd.OutlineElementReader.ih(a)||mc.a.instance.Xb("PossiblyIncorrectListRemoval",{["Reason"]:Qd.a.wda});Zb.ListReader.Hk(a)&&this.w6k(a);b.end()}w6k(a){this.Uf.Wna(a);a.Ni()}itb(a,b,c,f=!1){const l=mc.a.instance.Zp(C.a.Dli);if(!this.SHf(b,c))return{returnValue:!1,ybb:c};
this.Rxh(a,c,f);f=a.Ua(ee.a.i5g);var y=a.sa(ee.a.zmg,!1);let H=!1;1===c.j0&&c.bqe&&!c.iU&&(H=!0);const Q=c.propertySet.sa(Ab.a.idc,null);Q&&Q===Box4Intl.Box4Strings.L_ListStyleNone&&(1===c.listType?H=c.bqe&&!c.iU:0===c.listType&&(H=0===c.listStyle));y?H&&(c.gza(16,0),a.setValue(ee.a.zE,16),a.setValue(ee.a.Iea,0)):(y=this.Uf.Gv(b),this.qBh(c,y,f,H,a)&&(l.properties.$("ToggledOff","true"),c.gza(16,0),this.cml(a)),0===c.listType&&a.Ua(ee.a.JWa)&&(c.SA=a.eb(ee.a.JWa),a.removeProperty(ee.a.JWa)));if(f&&
(l.properties.$("MultipleOESelection","true"),({ybb:c}=this.hBh(b,c)).returnValue))return l.end(),{returnValue:!1,ybb:c};this.jji(b,c,a);a.setValue(ee.a.zmg,!0);l.end();return{returnValue:!0,ybb:c}}qBh(a,b,c,f){if(f)return!0;if(b){f=a.listType===b.listType;const l=0===a.listStyle&&a.SA===Ed.a.ax;a=a.listStyle===b.listStyle&&a.SA===b.SA;this.Uf.idb&&(a=a&&!c);return f&&(l||a)}return!1}cml(a){a.setValue(ee.a.zE,16);a.setValue(ee.a.Iea,0)}Rxh(){}SHf(){return!0}hBh(a,b){return{returnValue:16!==b.listType&&
Wd.OutlineElementReader.isEmpty(a,!0),ybb:b}}Tub(a){const b=mc.a.instance.Zp(C.a.Tub);Db.ParagraphReader.ae(a)||mc.a.instance.Xb("ClearingListFromNonParagraph",{["Reason"]:Qd.a.i4d});const c=new ob.GraphIterator;c.set(a);c.kf();c.eC(12);Za.OutlineElementNavigator.Te(c);this.UQa(c,null);b.end()}FUd(){}merge(a,b,c){const f=mc.a.instance.Zp(C.a.k9j);Wd.OutlineElementReader.ih(b)||mc.a.instance.Xb("PossibleIncorrectMergeOfOEs",{["Reason"]:"SrcIsNotOE"});Wd.OutlineElementReader.ih(a)||mc.a.instance.Xb("PossibleIncorrectMergeOfOEs",
{["Reason"]:"DestIsNotOE"});if(Zb.ListReader.Hk(b)){f.properties.$("UseSourceListWithNonlistDestination",c.toString());let l;l=Zb.ListReader.$9a;c&&this.gtl&&Zb.ListReader.Hk(a)&&this.Roa(a);if(!Zb.ListReader.Hk(a)||c&&l)c&&(w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings"),c=this.Oae(b),this.Uf.pGh&&c.propertySet.ye(ab.a.LWa,Ed.a.ax),1===c.j0&&c.IJf(),this.UQa(a,c),f.properties.$("MoveListInfoFromSrcToDestOE","true")),w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");
bq.cM.A2c&&this.Dxi(b,a);this.Roa(b);f.properties.$("RemoveListFromSrcOE","true")}f.end();return!0}Dxi(a,b){a=Db.ParagraphReader.iyb(a.currentNode);b=this.Uf.R8f(b);this.tsd(b,a,null)}Oae(a){return this.Uf.Gv(a)}tsd(a,b,c){if(a){b=cb.a.create(b);b=tb.a.Bs(b);this.w1a(a,ab.a.fontColor,c,b);this.w1a(a,ab.a.fontSize,c,b);if(this.tqb){let f,l;({value:f}=this.getPropertyValue(ab.a.font,c,b,"")).returnValue&&this.tqb.jV(a,f);({value:l}=this.getPropertyValue(Ab.a.wV,c,b,-1)).returnValue&&this.tqb.XLa(a,
l)}else this.w1a(a,ab.a.font,c,b),this.w1a(a,Ab.a.wV,c,b);w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");bq.cM.A2c&&(this.w1a(a,ab.a.bold,c,b),this.w1a(a,ab.a.italic,c,b),this.w1a(a,ab.a.superscript,c,b),this.w1a(a,ab.a.subscript,c,b))}}Fxh(){}w1a(a,b,c,f){c&&c.Ua(b)?a.setValue(b,c.eb(b)):f&&f.cache&&(c=f.cache,c.Ua(b)&&a.setValue(b,c.eb(b)))}getPropertyValue(a,b,c,f){if(b&&b.Ua(a))return f=b.eb(a),{returnValue:!0,value:f};if(!c||
!c.cache)return{returnValue:!1,value:f};b=c.cache;return b.Ua(a)?(f=b.eb(a),{returnValue:!0,value:f}):{returnValue:!1,value:f}}XXf(a,b){b.Ua(ee.a.zE)||(a===C.a.iN?b.setValue(ee.a.zE,1):a===C.a.zP&&b.setValue(ee.a.zE,0));b.Ua(ee.a.Iea)||b.setValue(ee.a.Iea,0);return b}cRa(a,b,c,f,l,y,H){a=mc.a.instance.Zp(C.a.cRa);const Q=this.Uf.Gv(b);c=pe.a.NN(0,c);c.SA=f;c.rsa=y;Q&&c.Pfe(Q)&&c.SA===Q.oX||(f=new pf.GraphTransaction(15),f.Sy(b),b=this.Emj(c),null!=b&&H.numbering(b)&&(ka.ULS.sendTraceTag(509747284,
393,50,"Found list insert matching string "+y),bq.characterPropertiesEditor.replaceTextRange(l,"")),f.dispose());a.end()}Emj(a){var b;let c=null===(b=null===xv||void 0===xv?void 0:xv[a.listType])||void 0===b?void 0:b[a.rsa];if(null==c)return null;b=new J.DictionaryPropertySet;b.setValue(ee.a.zE,a.listType);b.setValue(ee.a.Iea,a.listStyle);b.setValue(ee.a.JWa,a.SA);b.setValue(ab.a.Zi,c.Zi);this.ljl(b,c.autonumberBulletType);return b}static get characterPropertiesEditor(){return bq.mh||(bq.mh=Ib.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get cM(){return bq.UK||
(bq.UK=Ib.a.instance.qb("Box4.List.ListSettings"))}}bq.mh=null;bq.UK=null;Object(m.a)(bq,"ListEditor",null,[410]);class Tn{}Tn.aIe=80640;Tn.bIe=0;Tn.Ehe=80640;Tn.Fhe=-80640;Object(m.a)(Tn,"ParagraphConstants",null,[]);var Vl=d(189);class uL extends bq{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc){super(a,b);this.f6c=[ab.a.Zi,ab.a.font];this.tad=[ab.a.Zi,ab.a.font,ab.a.fontColor,zb.a.autonumberBulletType,zb.a.lxb];this.tIa=c;this.Ihc=f;this.OEb=l.oqg;this.yM=y;this.jm=H;this.HH=ia;this.JA=wa;this.vi=
Ua;this.xwa=kb;this.ehc=l.Poe;this.efb=l.qqg;this.pM=Gb;this.Rb=ec;this.Ga=dc;this.iwa=l.pptCopyPasteListMarkerEnabled;this.dhc=l.pptCopyPasteMarginAndIndentationEnabled;this.mJg=l.pptCopyPasteTextWithSpacingFromExternal}INb(a){super.INb(a);this.efb&&this.SNc(a.propertySet,this.St.propertySet)}d_e(a){if(this.OEb&&this.St&&this.St.propertySet){const b=this.St.propertySet.sa(Ab.a.listLevel,-1);-1!==b&&this.e_e(a,b)}this.iwa&&this.St&&(this.St.uxb=!0);this.mJg&&this.sxh(a);this.GUd(a,this.St);this.St=
null}exh(a,b,c){b=this.Ji.V$b(a);this.Ji.cPb(a,b,c,!1,!0)}SHf(a,b){if(!a||!b)return!1;if(a.Cb(4)){var c=this.Uf.Pae(a);this.tIa.Te(a);if(c&&c.listType===b.listType&&(1===b.listType||0===b.listType))return!0}c=a.Cb(2);const f=c.sa(Ab.a.uo,Df.a.indent),l=c.sa(Ab.a.nm,Df.a.leftMargin);this.tIa.Te(a);a=f;let y=l;({indent:a,margin:y}=this.zXd(Lj.NEf(Db.ParagraphReader.tka(c,ab.a.fontSize,0)),b.listType,f,l,a,y));return!!(this.yZj(y)&this.rYj(a))}$7f(a,b,c,f){if(!a)return xa.a.J(512496326,820,15,"ListEditor::GetIndentationFromListStyle - paragraphNode is null"),
{Ere:c,Dhe:f};b&&(c=b.sa(zb.a.c4b,Df.a.leftMargin),f=b.sa(zb.a.D2d,Df.a.indent),(a=this.Ga.vn(a))&&a.vd&&(c=b.sa(Ab.a.nm,Df.a.leftMargin),f=b.sa(Ab.a.uo,Df.a.indent)));return{Ere:c,Dhe:f}}kHf(a,b,c,f){if(!a||!this.yM.ih(b))return xa.a.J(512496325,820,15,"ListEditor::CalculateDefaultMarginAndIndent - paragraphNode is null or iterator is not outline element "),{q7d:c,p7d:f};var l=this.BQ(b,this.HH.Sda(b));if(l){const y=a.sa(Ab.a.nm,Df.a.leftMargin),H=a.sa(Ab.a.uo,Df.a.indent);c=y;f=H;let Q=Df.a.leftMargin,
ia=Df.a.indent;({Ere:Q,Dhe:ia}=this.$7f(a,l,Q,ia));l=pe.a.xDa(l,null).listType;const wa=y+(0<=H?0:H),Ua=Q+(0<=ia?0:ia),kb=b.Cb(4);let Gb=16;kb&&(Gb=this.Ihc.vyb(kb),b.Cc());ia&&wa===Ua&&l===Gb?(c=Q,f=ia):({indent:f,margin:c}=this.zXd(this.Y$a(a),Gb,H,y,f,c),c=Math.max(Math.min(c,Tn.aIe),Tn.bIe),f=Math.max(Math.min(f,Tn.Ehe),Tn.Fhe))}return{q7d:c,p7d:f}}ffj(a,b){if(!a||!this.yM.ih(b))return xa.a.J(512496324,820,15,"ListEditor::GetDefaultMargin - paragraphNode is null or iterator is not outline element "),
Df.a.leftMargin;let c=Df.a.leftMargin,f=Df.a.indent;({q7d:c,p7d:f}=this.kHf(a,b,c,f));0<c&&xa.a.J(512496323,820,50,"Get defaultMargin from liststyle");return c}bfj(a,b){if(!a||!this.yM.ih(b))return xa.a.J(512496322,820,15,"ListEditor::GetDefaultIndent - paragraphNode is null or iterator is not outline element "),Df.a.indent;let c=Df.a.leftMargin,f=Df.a.indent;({q7d:c,p7d:f}=this.kHf(a,b,c,f));0<f&&xa.a.J(512496321,820,50,"Get defaultIndent from liststyle");return f}hBh(a,b){return{returnValue:!1,
ybb:b}}qBh(a,b,c,f,l){return f?!0:!b||l&&l.Ua(ab.a.Zi)?!1:a.listType===b.listType}yZj(a){return a<Tn.aIe&&a>=Tn.bIe}rYj(a){return a<Tn.Ehe&&a>=Tn.Fhe}ljl(a,b){a.setValue(zb.a.autonumberBulletType,b)}oul(a){return a}A4d(a,b){a.Ua(Ab.a.listLevel)&&b.ye(Ab.a.listLevel,a.Rh(Ab.a.listLevel))}xkj(a,b){return Object(Wa.a)(Vl.TableCellNode,a)?this.HH.K4f(a,this.JA.uXc(a),b):this.pmj(a,b)}pmj(a,b){--b;const c=a.sa(Ab.a.i0,[]);return 0>b||b>=c.length?(xa.a.J(512496320,820,10,"ListEditor::DictionaryPropertySet - Level is out of bounds {0}",
b),mc.a.instance.Xb("PossibleLossOfListStyle",{["Reason"]:"ListLevelOutOfBounds"}),null):a.Lh.ze(c[b])}tsd(){}e_e(a,b){if(this.yM.ih(a)&&0<=b&&b<Zo.a.u8){const c=a.currentNode,f=a.Cb(2);c&&c.setValue(Ab.a.listLevel,b);f&&(f.setValue(Ab.a.listLevel,b),a.Cc())}}tml(a,b){if(this.yM.ih(a)&&b&&b.propertySet){var c=a.Cb(4);c&&(b.vzb&&b.R9&&(this.efb?(this.SNc(b.propertySet,c),this.iwa&&b.propertySet.Ua(zb.a.autonumberBulletType)&&c.setValue(zb.a.autonumberBulletType,b.propertySet.eb(zb.a.autonumberBulletType))):
c.setValue(ab.a.Zi,b.R9)),a.Cc())}}Fxh(a){if(this.yM.ih(a)){if(this.OEb&&this.St&&this.St.propertySet){const b=this.St.propertySet.sa(Ab.a.listLevel,-1);-1!==b&&this.e_e(a,b);this.tml(a,this.St)}this.dhc&&this.Ull(a);this.iwa&&(this.St&&this.St.propertySet?this.pXj(this.St)||(xa.a.J(512496285,820,50,"Copied from external, such as website."),this.f_e(a)):(xa.a.J(512496286,820,50,"Copied from external, such as win32 ppt."),this.f_e(a)));this.mJg&&this.sxh(a);this.St=null}else xa.a.J(512496288,820,10,
"ListEditorCssVersion::SetProperPendingListInfoAfterPaste - input GraphIterator is not outline element ")}sxh(a){const b=this.HH.Sda(a),c=this.BQ(a,b),f=a.Cb(2);c&&f&&0<=b&&b<Zo.a.u8&&(this.St&&this.St.propertySet&&this.St.propertySet.Ua(zb.a.Jx)||(xa.a.J(512496284,820,50,"Get master defined line-spacing "),f.setValue(zb.a.Jx,c.sa(zb.a.CRi,Df.a.lineSpacing)),f.setValue(zb.a.qX,c.sa(zb.a.DRi,2))),this.St&&this.St.propertySet&&this.St.propertySet.Ua(zb.a.Gea)||(xa.a.J(512496283,820,50,"Get master defined line-spacing before"),
f.setValue(zb.a.Gea,c.sa(zb.a.SRi,Df.a.Xug)),f.setValue(zb.a.ama,c.sa(zb.a.TRi,4))),this.St&&this.St.propertySet&&this.St.propertySet.Ua(zb.a.Fea)||(xa.a.J(512496282,820,50,"Get master defined line-spacing after"),f.setValue(zb.a.Fea,c.sa(zb.a.QRi,Df.a.Wug)),f.setValue(zb.a.$la,c.sa(zb.a.RRi,4))));a.Cc()}pXj(a){if(a.propertySet.Ua(ab.a.Zi)){const b=a.propertySet.eb(ab.a.Zi).length;if(1===b&&a.propertySet.Ua(ab.a.font)||3===b&&a.propertySet.Ua(zb.a.autonumberBulletType))return!0}return!1}Ull(a){var b=
this.HH.Sda(a);const c=this.BQ(a,b),f=a.Cb(2);c&&f&&0<=b&&b<Zo.a.u8&&(this.St&&this.St.propertySet&&this.St.propertySet.Ua(Ab.a.nm)||(xa.a.J(512496281,820,50,"Get master defined indent-left."),c.Ua(zb.a.c4b)&&f.setValue(Ab.a.nm,c.eb(zb.a.c4b)),(b=this.Ga.vn(f))&&b.vd&&f.setValue(Ab.a.nm,c.sa(Ab.a.nm,Df.a.leftMargin))),this.St&&this.St.propertySet&&this.St.propertySet.Ua(Ab.a.uo)||(xa.a.J(512496280,820,50,"Get master defined firstline indent."),c.Ua(zb.a.D2d)&&f.setValue(Ab.a.uo,c.eb(zb.a.D2d)),(b=
this.Ga.vn(f))&&b.vd&&f.setValue(Ab.a.uo,c.sa(Ab.a.uo,Df.a.leftMargin))));a.Cc()}f_e(a){const b=this.HH.Sda(a),c=this.BQ(a,b),f=a.Cb(4);c&&f&&0<=b&&b<Zo.a.u8&&(xa.a.J(512496279,820,50,"Get master defined list marker"),c.Ua(ab.a.Zi)?(f.setValue(ab.a.Zi,c.eb(ab.a.Zi)),c.Ua(ab.a.font)?f.setValue(ab.a.font,c.eb(ab.a.font)):c.Ua(zb.a.autonumberBulletType)&&f.setValue(zb.a.autonumberBulletType,c.eb(zb.a.autonumberBulletType))):(f.setValue(ab.a.font,og.RFf),f.setValue(ab.a.Zi,[og.SWd])));a.Cc()}H1c(a){return a?
16!==this.HH.Wae(a).Pse:!1}Tub(){xa.a.J(512496278,820,10,"ListEditor::ClearListFromParagraph - Ppt doesn't implement ClearFormatting command");mc.a.instance.Xb("FormattingNotCleared",{["Reason"]:Qd.a.clg})}v5k(a){if(this.yM.ih(a)){var b=a.Cb(4);b&&(1===this.Ihc.vyb(b)&&b.removeProperty(zb.a.autonumberBulletType),a.Cc())}}Rml(a){this.yM.ih(a)&&(a=a.currentNode)&&a.setValue(zb.a.J_j,!0)}merge(a,b,c,f){const l=this.HH.Sda(b),y=this.BQ(a,this.HH.Sda(a)),H=this.BQ(b,l);y&&a&&(a.Cb(2),a.currentNode&&(a.currentNode.Ua(Ab.a.nm)&&
y.Ua(Ab.a.nm)&&!aB.APropertySet.Y_a(Ab.a.nm.type,a.currentNode.Rh(Ab.a.nm),y.Rh(Ab.a.nm))&&y.ye(Ab.a.nm,a.currentNode.Rh(Ab.a.nm)),a.currentNode.Ua(Ab.a.uo)&&y.Ua(Ab.a.uo)&&!aB.APropertySet.Y_a(Ab.a.uo.type,a.currentNode.Rh(Ab.a.uo),y.Rh(Ab.a.uo))&&y.ye(Ab.a.uo,a.currentNode.Rh(Ab.a.uo))),a.Cc());super.merge(a,b,c);c&&this.OEb&&(this.e_e(a,l),this.Rml(a),this.v5k(a));this.vji(b,H,y);if(f&&(a.Cb(2),c=a.currentNode.sa(zb.a.WKa,""),a.Cc(),c.length))for(a=this.Rb.mae(b);a.Gf(1)&&a.currentNode!==f.currentNode;)a.Cb(2),
a.currentNode.setValue(zb.a.WKa,c),a.Cc();return!0}jji(a,b,c){const f=Nc.a.Kb;f&&(f.Oj=!0);this.GUd(a,b,c)}PHl(a,b){var c=ob.GraphIterator.pb(b);this.Uf.Wna(c);b=c.currentNode;c.Cc();c=this.createList(a);a.Cc();c.V8a(b,zb.a.shapeId,zb.a.bya)}UQa(a,b){this.GUd(a,b)}lAf(a,b,c){this.yM.ih(a)||mc.a.instance.Xb("PossibleIndentNotAdjusted",{["Reason"]:Qd.a.wda});const f=a.Cb(2),l=f.sa(Ab.a.uo,Df.a.indent),y=f.sa(Ab.a.nm,Df.a.leftMargin);this.tIa.Te(a);if(16===b)this.xwa.Jv.hlb(f,0),0>l&&(mc.a.instance.Xb("UnexpectedlyChangingLeftIdent",
{["Reason"]:"NegativeLeftIndent"}),this.Ji.ilb(a,1,Math.max(y+l,0)));else{var H=this.BQ(a,this.HH.Sda(a));H||(H=new J.DictionaryPropertySet,xa.a.J(512496273,820,50,"listStyle is null"));var Q=Df.a.indent;let ia=Df.a.leftMargin;c?{Ere:ia,Dhe:Q}=this.$7f(f,H,ia,Q):(Q=H.sa(Ab.a.uo,Df.a.indent),ia=H.sa(Ab.a.nm,Df.a.leftMargin));H=pe.a.xDa(H,null).listType;const wa=ia+(0<=Q?0:Q);Q&&y+(0<=l?0:l)===wa&&H===b?(this.xwa.Jv.hlb(f,Q),this.Ji.ilb(a,1,ia)):(Q=l,H=y,{indent:Q,margin:H}=this.zXd(this.Y$a(f),b,l,
y,Q,H),0<this.HH.Sda(a)&&c&&(H+=ia),H=Math.max(Math.min(H,Tn.aIe),Tn.bIe),Q=Math.max(Math.min(Q,Tn.Ehe),Tn.Fhe),this.xwa.Jv.hlb(f,Q),this.Ji.ilb(a,1,H))}}Y$a(a){if(!a)return 0;a=this.jm.x9(a)?this.jm.Luj(this.jm.Gyb(a)):Db.ParagraphReader.tka(a,ab.a.fontSize,0);return Lj.NEf(a)}zXd(a,b,c,f,l,y){let H=(b=1===b)?.3125:.375;0<a&&(H=12>=a?b?.1875:.25:12<a&&18>=a?b?.3125:.375:18<a&&25>=a?b?.375:.5:25<a&&35>=a?b?.5:.5625:35<a&&44>=a?b?.625:.8125:44<a&&56>=a?b?.75:1:56<a&&72>=a?b?.9375:1.25:b?1.25:1.5);
a=-1*xe.a.Aua(H);0>=c&&a<c?(y=a-c,l=c+y,y=f-y):0<c&&(l=a,y=f-a);return{indent:l,margin:y}}vji(a,b,c){if(b&&c){Za.OutlineElementNavigator.yi(a);var f=a.Cq;if(Db.ParagraphReader.ql(a)){b=b.sa(ab.a.fontSize,Xr.fontSize);c=c.sa(ab.a.fontSize,Xr.fontSize);for(let l=0;l<f.Ta.length;++l){const y=f.Ta.ga(l);y&&y.formatting&&y.formatting.dA&&y.formatting.dA.Ua(ab.a.fontSize)&&y.formatting.dA.eb(ab.a.fontSize)===b&&this.vi.Xq(y.formatting,c)}}Za.OutlineElementNavigator.Te(a)}}Oae(a){if(this.iwa){if(a=this.Uf.Gv(a))a.uxb=
!0;return a}return super.Oae(a)}GUd(a,b,c=null){if(this.yM.ih(a)){this.Bji(b,c,a);var f=a.Cb(4);if(!f||b&&16!==b.listType)if(b&&0!==b.listStyle){f?pe.a.xDa(f,f).U1b():f=this.createList(a);a.Cc();const l=a.Cb(2);a.Cc();this.ehc&&l.sa(ee.a.Fbc,!1)||this.iwa&&b.uxb?f.V8a(b.propertySet,zb.a.shapeId,zb.a.bya,Ab.a.listLevel,ab.a.Zi,ee.a.zE):f.V8a(b.propertySet,zb.a.shapeId,zb.a.bya,Ab.a.listLevel,zb.a.fGa);c&&c.Ua(zb.a.autonumberBulletType)&&f.setValue(zb.a.autonumberBulletType,c.eb(zb.a.autonumberBulletType));
this.iwa&&b.uxb&&b.vzb&&(3===b.R9.length&&b.propertySet.Ua(zb.a.autonumberBulletType)?(f.setValue(ab.a.Zi,b.R9),f.setValue(zb.a.autonumberBulletType,b.propertySet.eb(zb.a.autonumberBulletType)),xa.a.J(512496267,826,50,"Support CCP customized number list")):1===b.R9.length&&b.cbb?(f.setValue(ab.a.Zi,b.R9),f.setValue(ab.a.font,b.font),xa.a.J(512496266,826,50,"Support CCP customized bullet")):(xa.a.J(512496265,826,50,"Set list use dst master liststyle."),this.f_e(a)))}else return;else a.Ni();b&&b.B2f||
(this.ehc?(c=this.Uf.Gv(a),this.lAf(a,c?c.listType:16,b?b.uxb:!1)):this.lAf(a,b?b.listType:16,b?b.uxb:!1))}else xa.a.J(512496269,820,10,"ListEditor::ApplyListInfoInternal - iterator is not outline element "),mc.a.instance.Xb("FailedToApplyListProperties",{["Reason"]:Qd.a.wda})}Bji(a,b,c){b&&a&&(1===a.listType||0===a.listType)&&(this.pM.ny(b,a.propertySet,this.f6c),c=this.BQ(c,this.HH.Sda(c))||new J.DictionaryPropertySet,1===a.listType&&(a.propertySet.setValue(ee.a.Iea,6),b.Ua(ab.a.Zi)||(a.propertySet.setValue(ab.a.font,
og.RFf),a.propertySet.setValue(ab.a.Zi,[og.SWd]),c.Ua(ab.a.Zi)&&(b=c.eb(ab.a.Zi)[0],b!==og.i2d&&b!==og.JJa&&this.pM.ny(c,a.propertySet,this.f6c)))))}BQ(a,b){this.yM.ih(a)||mc.a.instance.Xb("PossibleLossOfListStyle",{["Reason"]:Qd.a.wda});a=this.Iuj(a);return a?this.xkj(a,1+b):(xa.a.J(512496263,820,10,"ListEditor::DictionaryPropertySet - Outline is null"),mc.a.instance.Xb("PossibleLossOfListStyle",{["Reason"]:Qd.a.NMf}),null)}Iuj(a){a=ob.GraphIterator.fH(a);a.X6(gj.OutlineReader.Cbc);const b=a.ix(16);
return b?b:a.g3a()}vyb(a){return this.HH.Wae(a).Pse}Rxh(a,b,c){c||0!==b.listType||(b.SA=a.sa(ab.a.LWa,Ed.a.ax))}SNc(a,b){this.pM.NIi(a,b,this.tad)}}Object(m.a)(uL,"ListEditor",bq,[409,410]);class pt{constructor(a,b){this.U0b=a;this.Xtb=b}}Object(m.a)(pt,"BulletMarker",null,[]);class qt{constructor(a,b){this.UFf=a;this.J6g=b}}Object(m.a)(qt,"ListMarkerPreview",null,[]);class rt{constructor(a,b,c){this.z6g=a;this.F6g=b;this.VVd=c}}Object(m.a)(rt,"NumberingMarker",null,[]);class vL{constructor(a,b){this.Rb=
a;this.sHb=b;this.Pkk=new Bb.a(Object(I.a)(this,this.aMi,"createListBulletDictionary"));this.Ukk=new Bb.a(Object(I.a)(this,this.gMi,"createListNumberingDictionary"));this.Tkk=new Bb.a(Object(I.a)(this,this.eMi,"createListMarkerPreviewDictionary"));this.Rkk=new Bb.a(Object(I.a)(this,this.dMi,"createListMarkerAltTextDictionary"))}aMi(){const a=new Jd.a;a.$(3,new pt(8226,"Arial"));a.$(4,new pt(111,"Courier New"));a.$(5,new pt(167,"Wingdings"));a.$(6,new pt(113,"Wingdings"));a.$(7,new pt(118,"Wingdings"));
a.$(8,new pt(216,"Wingdings"));a.$(9,new pt(252,"Wingdings"));return a}gMi(){const a=new Jd.a;a.$(11,new rt(0,".",8));a.$(12,new rt(0,")",7));a.$(13,new rt(1,".",15));a.$(14,new rt(3,".",5));a.$(15,new rt(4,")",2));a.$(16,new rt(4,".",4));a.$(17,new rt(2,".",14));return a}eMi(){const a=new Jd.a;a.$(1,new qt("\u2022",["1.","2.","3."]));a.$(2,new qt("o",["1)","2)","3)"]));a.$(3,new qt("\uf0a7",["I.","II.","III."]));a.$(4,new qt("\uf071",["A.","B.","C."]));a.$(5,new qt("\uf076",["a)","b)","c)"]));a.$(6,
new qt("\uf0d8",["a.","b.","c."]));a.$(7,new qt("\uf0fc",["i.","ii.","iii."]));return a}dMi(){const a=new Jd.a;a.$(3,ResourceStrings.l_ListMarkerAltText_Bullet_1);a.$(4,ResourceStrings.l_ListMarkerAltText_Bullet_2);a.$(5,ResourceStrings.l_ListMarkerAltText_Bullet_3);a.$(6,ResourceStrings.l_ListMarkerAltText_Bullet_4);a.$(7,ResourceStrings.l_ListMarkerAltText_Bullet_5);a.$(8,ResourceStrings.l_ListMarkerAltText_Bullet_6);a.$(9,ResourceStrings.l_ListMarkerAltText_Bullet_7);a.$(11,ResourceStrings.l_ListMarkerAltText_Numbered_1);
a.$(12,ResourceStrings.l_ListMarkerAltText_Numbered_2);a.$(13,ResourceStrings.l_ListMarkerAltText_Numbered_3);a.$(14,ResourceStrings.l_ListMarkerAltText_Numbered_4);a.$(15,ResourceStrings.l_ListMarkerAltText_Numbered_5);a.$(16,ResourceStrings.l_ListMarkerAltText_Numbered_6);a.$(17,ResourceStrings.l_ListMarkerAltText_Numbered_7);return a}get HWa(){return this.Pkk.value}get Ahd(){return this.Ukk.value}get H4c(){return this.Tkk.value}get fvg(){return this.Rkk.value}PCf(a,b){const c=this.Rb.Lc(a);c.set(a);
for(a=c.Cb(1);a;){var f=c.Cb(4);if(f){if(1===b){if(1!==f.sa(ee.a.zE,16))return!1}else if(2===b){if(0!==f.sa(ee.a.zE,16))return!1}else if(a=f.sa(ab.a.Zi,null),this.sHb.j0c(b)){f=f.sa(ab.a.font,"");const l=this.HWa.ga(b);if(!a||1!==a.length||l.U0b!==a[0]||l.Xtb!==f)return!1}else if(this.sHb.k0c(b)){if(f=this.Ahd.ga(b),!a||3!==a.length||f.z6g!==a[1]||f.F6g!==ma.a.fromCharCode(a[2]))return!1}else return!1;c.Cc()}else if(0!==b)return!1;a=c.Gf(1)}return!0}j0c(a){return this.sHb.j0c(a)}k0c(a){return this.sHb.k0c(a)}N8b(a){return this.sHb.N8b(a)}xXc(a){return this.sHb.xXc(a)}}
Object(m.a)(vL,"PptListMarkersLoader",null,[413,412]);class wL{KRl(a,b){if(!a)return!1;b.Cb(2);a=b.currentNode.sa(ee.a.Fbc,!1);b.Cc();return!a}}Object(m.a)(wL,"PptMergeListEditorInOutlineElementStrategy",null,[414]);class Nz{constructor(){this.iti=[0,3,4,5,6,7,8,9];this.Bzk=[0,11,12,13,14,15,16,17]}j0c(a){return 3<=a&&9>=a}k0c(a){return 11<=a&&17>=a}N8b(a){return Nz.qcg(a,this.iti,1)}xXc(a){return Nz.qcg(a,this.Bzk,2)}static qcg(a,b,c){return 0<=a&&a<b.length?b[a]:c}}Object(m.a)(Nz,"TextBulletTypeHelper",
null,[412]);class PD{get name(){return"PowerPointWebEditor.ListEditor"}Yb(a){a.register(409,"PowerPointWebEditor.IPptListEditor").ma().oa(()=>new uL(a.resolve("Box4.List.IListReader"),a.resolve("Box4.IOutlineElementEditor"),a.resolve("Box4.IOutlineElementNavigator"),a.resolve("PowerPointWebEditor.IListInfoHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Box4.IOutlineElementReader"),a.resolve("PowerPointWebEditor.Graph.INotesReader"),a.resolve("PowerPointWebEditor.ListReader"),
a.resolve("PowerPointWebEditor.IPptListCore"),a.resolve("PowerPointWebEditor.IPPTTableStyleReader"),a.resolve("Box4.IFormattingEditor"),a.resolve("Box4.IParagraphEditor"),a.resolve("PowerPointWebEditor.IGraphUtils"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("PowerPointWebEditor.IShapeReader")));a.register(410,"Box4.List.IListEditor").ma().oa(()=>a.resolve("PowerPointWebEditor.IPptListEditor"));a.register(411,"PowerPointWebEditor.IPptListCore").ma().oa(()=>new tL(a.resolve("PowerPointWebEditor.ISlideReader"),
a.resolve("PowerPointWebEditor.Graph.INotesReader"),a.resolve("Box4.IOutlineElementReader"),a.resolve("PowerPointWebEditor.ListReader")));a.register(412,"PowerPointWebEditor.ITextBulletTypeHelper").ma().oa(()=>new Nz);a.register(413,"PowerPointWebEditor.IPptListMarkersLoader").ma().oa(()=>new vL(a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("PowerPointWebEditor.ITextBulletTypeHelper")));a.register(414,"Box4.IMergeListEditorInOutlineElementStrategy").ma().oa(()=>new wL)}init(){}dispose(){}static main(){n.a.instance.Ac(new PD)}}
Object(m.a)(PD,"PPTWebEditorListEditorPackage",null,[2,3]);var AR=d(900);class xL{Gk(a){return cd.TableReader.Gk(a)}Gi(a){return cd.TableReader.Gi(a)}RWc(a,b,c){return cd.TableReader.RWc(a,b,c)}wt(a){return cd.TableReader.wt(a)}Ocb(a){return cd.TableReader.Ocb(a)}Gs(a){return cd.TableReader.Gs(a)}CL(a){return cd.TableReader.CL(a)}}Object(m.a)(xL,"TableReaderProxy",null,[1160]);class yL{ppg(){return vk.j(void 0)}aqj(a){return vk.c(a)}}Object(m.a)(yL,"TableRowReaderProxy",null,[1159]);class zL extends sg.a{constructor(a,
b,c,f,l){super(a,b);this.g1h=l;this.cL=f;a=l&&this.gb.sa(Ab.a.skippedCell,!1);b=this.Nd.lp(Ca.a.td);this.hc(b);a?this.htmlElement.className="SkippedGhostCell":(this.htmlElement.className=this.cL.xr?"GhostWithBorder":"Ghost",this.htmlElement.title=Box4Intl.Box4Strings.l_GhostCellTooltip);this.htmlElement.innerText="\u00a0";this.WTf()}$U(){return Jj.a.Zlc}Yy(){this.g1h&&this.gb.sa(Ab.a.skippedCell,!1)&&this.kol()}kol(){this.cL.xr&&(this.htmlElement.style.borderTop="",this.htmlElement.style.borderLeft=
"",this.htmlElement.style.borderBottom="",this.htmlElement.style.borderRight="")}}Object(m.a)(zL,"GhostTableCellViewElement",sg.a,[1157,1029,472,107]);class AL{constructor(a,b,c){this.DPd=a;this.cL=b;this.bpb=c}create(a,b){return ae.isGhostCellNode(b.node)?ae.shouldRenderGhostCellNode(b.node)?new zL(a,b,this.DPd,this.cL,N.a.instance.ga(63),N.a.instance.ga(77)):null:this.bpb.create(a,b)}}Object(m.a)(AL,"GhostTableCellViewElementFactory",null,[1044]);class BL{constructor(a,b,c){this.zc=a;this.Bfa=b;
this.hSg=c;this.gG=null;this.bEb=this.cEb=-1}Mol(a,b=null){this.Ool(a);this.gG&&this.ell(b)}pBi(){this.gG=null;this.bEb=this.cEb=-1}b5f(a,b,c){if(!a||!this.gG)return{row:b,column:c};var f=this.Bfa.g0f(a,this.gG,this.hSg.CLc,this.hSg.BLc);if(!f)return{row:b,column:c};let l=f.rowIndex;f=f.Ai;l===b||this.Bfa.v0c(a,this.gG)||(l=b);var y=0,H=this.zc.Gi(this.gG)-1;let Q=0,ia=this.zc.Gk(this.gG)-1;this.Bfa.v0c(a,this.gG)&&b>=Q&&b<=ia&&c>=y&&c<=H&&(a=(y=(y=this.gG.ef(b,c))?y.mz():null)?y.rowSpan:0,H=y?y.colSpan:
0,y=c,H=c+H-1,Q=b,ia=b+a-1);l>=Q&&l<=ia&&f>=y&&f<=H&&(b=l,c=f);return{row:b,column:c}}zxk(a){a=this.ccg(a);return!!a&&14===a.type&&a.Op()}Hji(a,b,c,f,l,y){if(!this.gG||!a||14!==a.type||this.gG!==a||!b)return{K2f:c,z2f:f,SIh:l,QIh:y};this.gG.ef(c,f).isControllingCell&&({rowIndex:c,Jja:f}=this.Lhj(c,f));if(this.gG.ef(l,y).isControllingCell||!this.Bfa.v0c(b,this.gG))({row:l,column:y}=this.b5f(b,l,y));xa.a.J(41209862,816,50,"Drag to select table cells in complex table.");return{K2f:c,z2f:f,SIh:l,QIh:y}}Ool(a){(a=
this.ccg(a))&&14===a.type&&(this.gG=a)}ccg(a){return 1074135132===a.Xe&&a.vd?this.zc.ZN(a):this.zc.I8b(a)}ell(a){this.gG&&a&&({row:this.cEb,column:this.bEb}=this.b5f(a,this.cEb,this.bEb))}Lhj(a,b){if(!this.gG)return{rowIndex:a,Jja:b};let c=null;0<=a&&a<this.zc.Gk(this.gG)&&0<=b&&b<this.zc.Gi(this.gG)&&(c=this.gG.ef(a,b));this.nXj(c)&&(a=this.cEb,b=this.bEb);return{rowIndex:a,Jja:b}}nXj(a){if(!this.gG)return!1;let b=0;var c=this.zc.Gi(this.gG)-1;let f=0;var l=this.zc.Gk(this.gG)-1;if(a){l=a.rowIndex;
c=a.Ai;const y=a.rowSpan;a=a.colSpan;b=c;c=c+a-1;f=l;l=l+y-1}return this.cEb>=f&&this.cEb<=l&&this.bEb>=b&&this.bEb<=c}}Object(m.a)(BL,"PptTableDragSelectionCellExtendStrategy",null,[397]);var CL=d(847),fn=d(242);class DL{constructor(){this.UYc=this.colSpan=this.tqd=0}}Object(m.a)(DL,"HeightInfo",null,[]);class EL{constructor(){this.zRa=null;this.rowSpan=this.height=this.width=this.top=this.offsetTop=this.left=0;this.rgg=this.Vgg=this.Uog=this.Wog=this.Vog=!1}}Object(m.a)(EL,"TableCellInfo",null,
[]);class FL{constructor(){this.qVh=[]}get cells(){return this.qVh}WRd(a){this.cells.push(a)}}Object(m.a)(FL,"TableRowInfo",null,[]);class GL{constructor(){this.zRa=null;this.height=this.width=this.left=this.top=this.offsetTop=0;this.jog=this.opg=this.pog=!1}}Object(m.a)(GL,"UpdateInfo",null,[]);var BR=d(1102),HL=d(565);class Qv extends HL.a{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec){super(a,b,kb);this.UOa=!1;this.U4a=this.Rrf=this.wNd=this.T4a=this.cHa=null;this.ZJd=0;this.Yxi=1;this.Wxi=16;
this.Nxi=256;this.Qxi=4096;this.Xxi=65536;this.cCc=this.vCc=this.HCc=this.QCc=!1;this.Vbf=this.Buf=this.PFc=this.jDc=this.Gha=0;this.Mve=this.Nve=null;this.z8h=Object(qa.a)(131,b);this.ica=c;this.Bca=ec;this.kd=Ua;this.cW=Gb;this.cL=wa;this.WGc=Q;this.zia=ia;this.yia=H;this.Cr=y;this.H9c=!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("PPTOTableCellDiagonalBordersEnabled");a=this.Nd.lp(Ca.a.td);this.hc(a);this.zZ=this.Nd.lp(Ca.a.div);a.appendChild(this.zZ);this.zZ.className="TableCellContent";
this.ap(this.zZ)}g7b(){return this.zZ.offsetHeight+this.zZ.offsetTop}Zwc(a,b,c,f){a=this.UOa?a:a+c;this.cHa||(this.cHa=this.iOc());this.cHa.style.left=a-2.5+"px";this.cHa.style.top=b+"px";this.cHa.style.height=f+"px"}VPf(){const a=this.Nd.lp(Ca.a.div);rf.c(a,!0);this.htmlElement.insertBefore(a,this.htmlElement.firstChild);return a}iOc(){const a=this.VPf();a.className="TableColumnResizeHandle";return a}l1d(){const a=this.Nd.lp(Ca.a.div);rf.c(a,!0);this.htmlElement.insertBefore(a,this.htmlElement.firstChild);
a.className=id.a.c5k;return a}tNl(a,b,c,f){f?(a=this.UOa?a:a+b,this.T4a||(this.T4a=this.eKi()),b=this.T4a.style,b.top=c+"px",b.left=a+"px"):this.T4a&&(this.gKf(this.T4a,!1),this.T4a=null);return this.T4a}eKi(){const a=this.l1d(),b=this.Nd.lp(Ca.a.div);rf.c(b,!0);b.className=id.a.sie;a.appendChild(b);return a}XPl(a,b,c,f){this.u_i();const l=this.wNd.style;l.top=c+"px";l.left=f+"px";c=this.Rrf.style;c.marginTop=b-2.5+"px";c.width=a+"px"}u_i(){if(!this.wNd){const a=this.l1d(),b=this.Nd.lp(Ca.a.div);
rf.c(b,!0);b.className=id.a.hkg;a.appendChild(b);this.wNd=a;this.Rrf=b}}aQl(a,b,c){c?(this.U4a||(this.U4a=this.$Ni()),c=this.U4a.style,c.top=a+b-10+"px",this.UOa?c.right="-15px":c.left="-15px"):this.U4a&&(this.gKf(this.U4a,!0),this.U4a=null);return this.U4a}$Ni(){const a=this.l1d(),b=this.Nd.lp(Ca.a.div);rf.c(b,!0);b.className=id.a.tie;a.appendChild(b);return a}xnh(a){(a=this.htmlElement.querySelector("."+a))&&this.htmlElement.removeChild(a.parentNode)}gKf(a,b){b?fn.a.DAi(a):fn.a.zAi(a);this.htmlElement.removeChild(a)}apg(a){a=
a?C.a.Hua:w.AFrameworkApplication.isRtl?C.a.Dbb:C.a.mVa;return 8!==w.AFrameworkApplication.Ra.ei(cb.a.create(this.gb),a,1,!0,new BR.a,null)}$U(a){super.$U(a);const b=super.$U(a);this.ZJd=this.kuj(a);if(this.Bca.Fx&&!this.Qc.hm){var c=Yf.a.pb(a.p2,a.currentNode);c.kf();this.yia.Te(c);a=this.WGc.getContainingTable(a);this.zia.ih(c)&&a&&!this.Cr.mDa(a)&&(c=c.fr)&&c.htmlElement&&this.ica.rOf(c.htmlElement,a,this.Na)}return new Jj.a(b.Una+this.jDc+Rn.a.ymb,Math.max(b.minWidth,this.ZJd),b.Vna+this.PFc+
Rn.a.ymb)}kuj(a){return cd.TableReader.VAb(a)?(a=this.Bca.Moe?this.gb.sa($c.a.eYd,1):1,a*Rn.a.a5e+(a-1)*(this.jDc+this.PFc+Rn.a.ymb)):Rn.a.a5e}c7(a){this.zZ.style.paddingLeft=a.Una-Rn.a.ymb+"px";this.zZ.style.paddingRight=a.Vna-Rn.a.ymb+"px";this.Bca.Y1c&&this.Bca.Moe&&(this.zZ.style.minWidth=this.ZJd+"px")}yba(a){this.nE(this.zZ,a,1)}Yy(){this.YMh();this.fwh();var a=ob.GraphIterator.pb(this.gb);a.sc(14);const b=Sd.getContainingTable(a),c=ae.isFirstCellInColumn(a);a=ae.isFirstCellInRow(a);let f="";
c&&Qv.xsg(b,32)&&(f="columnheader");a&&!c&&Qv.xsg(b,128)&&(f="rowheader");""!==f?Hb.d(this.htmlElement,va.a.role,f):this.htmlElement.removeAttribute(Ve.a.hf);this.kd&&this.kd.VFa(65)&&(this.gb.L2b?Sys.UI.DomElement.addCssClass(this.htmlElement,fc.p4):Sys.UI.DomElement.removeCssClass(this.htmlElement,fc.p4));this.cL.xr&&(this.htmlElement.style.border="",this.Fal(),this.Ejl(b),this.htmlElement.style.verticalAlign=this.cL.xr.Sbj(this.gb));this.Gnl();this.Bca.Y1c&&this.Bca.Moe&&(this.gb.Ua($c.a.UIf)?
this.Wxh():this.htmlElement.removeAttribute("rowspan"),this.gb.Ua($c.a.eYd)?this.kwh():this.htmlElement.removeAttribute("colspan"));this.Qc.hm&&this.Bca.m4j&&(this.htmlElement.style.width=this.Nd.Md.Ne(this.z8h.width,0)+"px")}Gnl(){if(this.Bca.R0j||this.Bca.v6j)this.gb.Zfe?this.Wxh():this.htmlElement.removeAttribute("rowspan"),this.gb.Zab?this.kwh():this.htmlElement.removeAttribute("colspan")}YMh(){let a=null;if(this.kd&&this.kd.VFa(65)){var b=ob.GraphIterator.pb(this.gb);b.sc(15);b=b.ix(15);if(b.pwc){Sys.UI.DomElement.addCssClass(this.htmlElement,
fc.sHh);return}if(b.Swd){Sys.UI.DomElement.addCssClass(this.htmlElement,fc.vHh);return}}this.gb.Ua(ab.a.$Lc)?(a=rc.a.bH(this.gb.sa(ab.a.$Lc,rc.a.nil)),this.Gha|=this.Xxi):this.Bca.P3j&&this.cL.xr&&(a=this.cL.xr.P4f(this.gb));a=a||"transparent";this.htmlElement.style.backgroundColor=a;"transparent"!==a&&4.5>rc.a.Mcj(a)?this.htmlElement.className="LowContrastShading":this.htmlElement.className=this.htmlElement.className.replace("LowContrastShading","");this.kd&&this.kd.VFa(65)&&(Sys.UI.DomElement.removeCssClass(this.htmlElement,
fc.sHh),Sys.UI.DomElement.removeCssClass(this.htmlElement,fc.vHh))}Wxh(){Hb.d(this.htmlElement,va.a.rowSpan,this.Bca.Y1c?this.gb.sa($c.a.UIf,1):this.gb.rowSpan)}kwh(){Hb.d(this.htmlElement,va.a.colSpan,this.Bca.Y1c?this.gb.sa($c.a.eYd,1):this.gb.colSpan)}Fal(){this.cCc=this.HCc=this.vCc=this.QCc=!1}Ejl(a){this.cL.xr&&(this.Jll(),this.htmlElement.style.border="0px none",this.vNb(this.gb,a,7),this.vNb(this.gb,a,5),this.vNb(this.gb,a,0),this.vNb(this.gb,a,6),this.H9c&&(this.vNb(this.gb,a,2),this.vNb(this.gb,
a,1)),Hb.d(this.htmlElement,va.a.o2d,this.Gha),this.H9k())}fwh(){var a=new ob.GraphIterator;a.set(this.gb);a.sc(14);a.Kg(14);a=a.currentNode;this.jDc=Rn.a.tXc(this.gb,a,Ab.a.HPb,this.cL.xr,Ab.a.jEl,0);this.PFc=Rn.a.tXc(this.gb,a,Ab.a.JPb,this.cL.xr,Ab.a.kEl,0);this.Buf=Rn.a.tXc(this.gb,a,Ab.a.KPb,this.cL.xr,Ab.a.lEl,1);this.Vbf=Rn.a.tXc(this.gb,a,Ab.a.GPb,this.cL.xr,Ab.a.fEl,1);this.zZ.style.paddingLeft=this.jDc+"px";this.zZ.style.paddingRight=this.PFc+"px";this.zZ.style.paddingTop=this.Buf+"px";
this.zZ.style.paddingBottom=this.Vbf+"px"}Jll(){var a=ob.GraphIterator.pb(this.gb);a.sc(14);a=this.WGc.getContainingTable(a);this.UOa=cd.TableReader.Gm(a)}vNb(a,b,c){this.cW&&this.cW.STj(b);a=this.cL.xr.ngj(a,c);b=a.pqi;const f=a.Fyj;if(""!==b)switch(""!==f&&Sys.UI.DomElement.addCssClass(this.htmlElement,f),c){case 7:this.htmlElement.style.borderTop=b;this.v1c(b)&&(this.QCc=!0);a.aQc&&(this.Gha|=this.Yxi);break;case 5:this.awh(5,b);this.v1c(b)&&(this.vCc=!0);a.aQc&&(this.Gha|=this.Qxi);break;case 0:this.htmlElement.style.borderBottom=
b;this.v1c(b)&&(this.cCc=!0);a.aQc&&(this.Gha|=this.Nxi);break;case 6:this.awh(6,b);this.v1c(b)&&(this.HCc=!0);a.aQc&&(this.Gha|=this.Wxi);break;case 2:this.Nve=b;break;case 1:this.Mve=b}}v1c(a){return!a||a.startsWith("0px none")?!1:!0}awh(a,b){if(5===a&&!this.UOa||6===a&&this.UOa)this.htmlElement.style.borderLeft=b;if(5===a&&this.UOa||6===a&&!this.UOa)this.htmlElement.style.borderRight=b}H9k(){if(this.Ktl()){var a=ob.GraphIterator.pb(this.gb);if(a.sc(14)){var b=ae.isFirstCellInRow(a),c=ae.isLastCellInRow(a);
this.QCc||(this.htmlElement.style.borderTop="solid 1px #c8cacc",this.QCc=!0);this.cCc||(this.htmlElement.style.borderBottom="solid 1px #c8cacc",this.cCc=!0);b=b?"solid 1px #c8cacc":"dashed 1px #c8cacc";c=c?"solid 1px #c8cacc":"dashed 1px #c8cacc";a=a.ix(14);a=!cd.TableReader.Gm(a);this.vCc||(this.htmlElement.style.borderLeft=a?b:c,this.vCc=!0);this.HCc||(this.htmlElement.style.borderRight=a?c:b,this.HCc=!0)}}}Ktl(){const a=this.Qc;return a.Sh&&a.features.Ttl?!0:!1}get Nja(){return this.zZ}yK(a){super.yK(a);
this.PU()}PU(){if(!this.Nd.hm&&this.EB){const a=Object(qa.a)(1152,this.aS);a&&a.Q2g(this.zZ)}}get Zub(){return this.cHa}static xsg(a,b){return null!==a&&a.Ua(Ab.a.tableLook)?!!(a.properties.eb(Ab.a.tableLook)&b):!1}}Object(m.a)(Qv,"TableCellViewElement",HL.a,[1156,1029,472,107]);class om extends sg.a{constructor(a,b,c,f=null){super(a,b);this.vS=null;this.Hyc=!0;this.Qm=[];this.mv=[];this.HHc=this.LG=null;this.gdf=this.Qrf=0;om.KWa=c;this.cW=f;b=this.Nd.lp(Ca.a.div);b.className="TableContainer";this.nk=
this.Nd.lp(Ca.a.table);b.appendChild(this.nk);this.nk.className="Table";Sys.UI.DomElement.addCssClass(this.nk,om.Fvd);this.yvf=a;this.ZBa=this.Nd.lp(Ca.a.div);this.ZBa.id=ha.a.create().toString();this.ZBa.className=om.QDl;this.ZBa.setAttribute(Ve.a.HI,Ve.a.lB);b.insertBefore(this.ZBa,this.nk);rf.c(this.ZBa,!0);a.hm&&Hb.d(this.nk,va.a.border,this.gb.sa(ab.a.xmb,!0)?"1":"0");this.hc(b);a.hm||(this.vS=this.Nd.lp(Ca.a.FCi),this.nk.appendChild(this.vS));this.SS=this.Nd.lp(Ca.a.MHh);this.nk.appendChild(this.SS);
this.ap(this.nk)}get b2(){return this.SS}get table(){return this.nk}get dNc(){return this.vS}Yy(a){this.nk.style.borderCollapse="collapse";if(fb.StyleReader.xr)Sys.UI.DomElement.removeCssClass(this.nk,om.Fvd),Sys.UI.DomElement.removeCssClass(this.nk,om.d5e);else{var b=this.gb.sa(ab.a.xmb,!0);b&&!this.Hyc?(Sys.UI.DomElement.removeCssClass(this.nk,om.d5e),Sys.UI.DomElement.addCssClass(this.nk,om.Fvd),this.Hyc=!0):!b&&this.Hyc&&(Sys.UI.DomElement.removeCssClass(this.nk,om.Fvd),Sys.UI.DomElement.addCssClass(this.nk,
om.d5e),this.Hyc=!1)}N.a.instance.ga(71)&&fb.StyleReader.xr&&(Hb.d(this.nk,va.a.q2d,"Custom"),Hb.d(this.nk,va.a.p2d,0));var c=this.vS?cd.TableReader.Gi(this.gb):0;b=this.vS?c-this.vS.childNodes.length:0;for(var f=0;f<b;++f){var l=this.Nd.lp(Ca.a.col);this.vS.appendChild(l)}for(f=0;f>b;--f)this.vS.removeChild(this.vS.firstChild);f=Qn.b(this.gb);var y=0;this.cW&&(y=this.cW.pce(this.gb));l=Array(c);var H=!0;b=0;for(var Q=0;Q<c;++Q){let ia=this.d9(Q);0<=f[Q]?(l[Q]=Math.max(ia,this.Nd.Md.Ne(f[Q],0)-y),
this.vS.childNodes[Q].style.width=l[Q]+"px",b+=l[Q]):(l[Q]=-1,H=!1,this.vS.childNodes[Q].style.width="",b+=ia)}if(N.a.instance.ga(63)||N.a.instance.ga(77))H?Sys.UI.DomElement.addCssClass(this.nk,om.VQh):Sys.UI.DomElement.removeCssClass(this.nk,om.VQh);if(this.Qm.length===c)for(y=this.sUc(),H=0;H<c;++H)Q=this.d9(H),this.Qm[H].childNodes[y].style.width=0<=f[H]?Math.max(Q,l[H])+"px":Q+"px";c=cd.TableReader.Gm(this.gb);if(this.gb.Ua(ab.a.Vl))switch(cd.TableReader.CL(this.gb)){case 1:this.nk.style.marginLeft=
"";this.nk.style.marginRight="auto";break;case 2:this.nk.style.marginLeft="auto";this.nk.style.marginRight="auto";break;case 3:this.nk.style.marginLeft="auto";this.nk.style.marginRight="";break;case 14:this.nk.style.marginLeft=c?"auto":"";this.nk.style.marginRight=c?"":"auto";break;case 15:this.nk.style.marginLeft=c?"":"auto";this.nk.style.marginRight=c?"auto":"";break;default:this.nk.style.marginLeft="",this.nk.style.marginRight=""}else this.nk.style.marginLeft="",this.nk.style.marginRight="",N.a.instance.ga(63)&&
this.gb.Ua(Ab.a.nm)&&(f=({unit:a}=cd.TableReader.Mka(a)).returnValue,a=(new vv.a(a,f)).tRb+"px",c?this.nk.style.marginRight=a:this.nk.style.marginLeft=a);(N.a.instance.ga(71)||N.a.instance.ga(77))&&this.Kol(fb.StyleReader.xr,this.gb,this.nk);this.gb.properties.sa(ab.a.Omg,!1)?(Sys.UI.DomElement.addCssClass(this.nk,om.FMf),Hb.d(this.nk,va.a.oni,"conflictSRDescription")):(Sys.UI.DomElement.removeCssClass(this.nk,om.FMf),this.nk.removeAttribute(Ve.a.Rca));(a=cd.TableReader.xde(this.gb))&&this.nk.setAttribute("title",
a);(a=cd.TableReader.wde(this.gb))?this.yvf.hm&&1===this.yvf.mode?this.nk.removeAttribute(Ve.a.Rca):(this.ZBa.innerText=a,this.nk.setAttribute(Ve.a.Rca,this.ZBa.id)):(this.ZBa.innerText="",this.nk.removeAttribute(Ve.a.Rca));Qc.a.instance.ik&&!N.a.instance.ga(30)&&(this.nk.style.width="0px");N.a.instance.ga(30)&&(this.nk.style.minWidth=b+"px");this.Ijl();this.Pol()}Ijl(){if(this.cW){const a=this.cW.hYl(this.gb);""!==a&&(this.nk.style["border-spacing"]=a);this.Eme&&(this.nk.style.borderCollapse="separate")}}get Eme(){return!!this.cW&&
this.cW.STj(this.gb)}M9d(a){return this.cW?this.cW.xXl(this.gb,a):0}Pol(){this.nk.style.borderTop="";this.nk.style.borderBottom="";this.nk.style.borderLeft="";this.nk.style.borderRight=""}d9(a){return(fb.StyleReader.xr?fb.StyleReader.xr.d9(this.gb,a):Rn.a.Ivd)+(this.cW?this.cW.pce(this.gb):0)}Kol(a,b,c){a&&(c.style.background=a.ruj(b))}yba(a){this.nE(this.htmlElement,a,88);1<this.htmlElement.children.length&&this.htmlElement.firstChild===this.nk&&(this.Tqc(this.htmlElement,this.nk),this.htmlElement.appendChild(this.nk));
this.nE(this.SS,a,1);let b=!1;this.SS.firstChild!==this.LG&&(this.LG=this.SS.firstChild,b=!0);N.a.instance.ga(30)&&cd.TableReader.wt(a.currentNode)||!this.vS||(w.AFrameworkApplication.fa.ka("IsComplexTableColumnSelectionHandleFixEnabled")?(a=!1,(this.Qm&&this.Qm.length?this.Qm[0].parentNode:null)!==(this.LG?this.LG.firstChild:null)&&(a=!0),this.zph(b||a)):this.y9k(b),fn.a.lu||this.SVe(b))}sUc(){let a=1;(N.a.instance.ga(63)||N.a.instance.ga(30))&&cd.TableReader.wt(this.gb)&&(a=0);return a}dispose(){N.a.instance.ga(50)&&
Rc.App.Mh&&Rc.App.Mh.Bw&&this.tnh();this.mv=this.Qm=this.nk=this.SS=this.vS=this.ZBa=this.LG=null;super.dispose()}$U(a){var b=Qn.b(this.gb),c=null;if(a.Cb(1)){do{var f=a.fr.iMa;c=c?Fv.bDi(c,f):f.copy()}while(a.Nj(1))}c||(c=new Fv(b.length));for(f=0;f<b.length;f++)-1<b[f]&&c.jwh(f,Math.max(c.Vcj(f),this.Nd.Md.Ne(b[f],0)));b=Rn.a.ymb;c=new Jj.a(b,Math.max(0,c.Evk()-2*b),b);b=new ob.GraphIterator;b.set(this.gb);f=!1;b.sc(16)&&(f=!0);c=f?new Jj.a(0,c.total,0):new Jj.a(c.Una,c.minWidth,c.Vna);a.Cb(88)&&
(c=Jj.a.max(c,a.fr.iMa),a.Cc());return c}dRj(){this.tnh();this.Qm=[];this.mv=[]}tnh(){if(this.mv)for(var a=0;a<this.mv.length;++a)L.a.cLa(this.mv[a]),Ea.a.lP(this.mv[a]);if(this.Qm)for(a=0;a<this.Qm.length;++a)L.a.cLa(this.Qm[a]),this.mv&&this.mv[a]&&this.mv[a].parentNode&&Ea.a.lP(this.Qm[a])}zph(a){if(this.Qm&&this.LG&&this.LG.firstChild){var b=z.a.Ex||z.a.Ho?"":" 16 20",c=String.format("url('{0}'){1}, pointer",Ey.a.box4Image("ColumnSelect.cur"),b);b=Qn.b(this.gb);var f=b.length,l=this.LG.firstChild;
if(a){a=Math.min(f,this.Qm.length);for(var y=0;y<a;y++)l.insertBefore(this.Qm[y],l.firstChild)}if(f>this.Qm.length)for(a=this.Qm.length;a<f;a++){y=this.Nd.createElement("div");y.className="TableColumnHandleAnchor";rf.c(y,!0);Array.add(this.Qm,y);var H=this.Nd.createElement("div");H.className=fn.a.c5e;H.style.cursor=c;y.appendChild(H);H=this.Nd.createElement("div");H.className="TableColumnWidthSpacer";y.appendChild(H);l.insertBefore(this.Qm[a],l.firstChild)}if(f<this.Qm.length){for(c=f;c<this.Qm.length;c++)L.a.cLa(this.Qm[c]),
Ea.a.lP(this.Qm[c]);c=[];for(l=0;l<f;l++)Array.add(c,this.Qm[l]);this.Qm=c}c=this.sUc();l=0;for(a=0;a<f;a++)y=this.d9(a),y=Math.max(y,this.Nd.Md.Ne(b[a],0)),this.Qm[a].childNodes[c].style.width=y+"px",this.Qm[a].style.left=l+"px",this.Qm[a].setAttribute("ColumnIndex",a.toString()),l+=y}}y9k(a){var b=z.a.Ex||z.a.Ho?"":" 16 20";b=String.format("url('{0}'){1}, pointer",Ey.a.box4Image("ColumnSelect.cur"),b);if(a){a=this.LG.firstChild;var c=Math.min(this.LG.childNodes.length,this.Qm.length);for(var f=
0;f<c;++f)a.insertBefore(this.Qm[f],a.firstChild),a=a.nextSibling}a=this.LG.childNodes.length;if(a>this.Qm.length){c=this.LG.firstChild;for(f=0;f<this.Qm.length;++f)c.insertBefore(this.Qm[f],c.firstChild),c=c.nextSibling;for(f=this.Qm.length;f<a;++f){const y=this.Nd.createElement("div");y.className="TableColumnHandleAnchor";rf.c(y,!0);Array.add(this.Qm,y);var l=this.Nd.createElement("div");l.className=fn.a.c5e;l.style.cursor=b;y.appendChild(l);l=this.Nd.createElement("div");l.className="TableColumnWidthSpacer";
y.appendChild(l);c.insertBefore(y,c.firstChild);c=c.nextSibling}}else if(a<this.Qm.length){for(b=a;b<this.Qm.length;++b)L.a.cLa(this.Qm[b]),Ea.a.lP(this.Qm[b]);b=[];for(c=0;c<a;++c)Array.add(b,this.Qm[c]);this.Qm=b;b=this.LG.firstChild;for(a=0;a<this.Qm.length;++a)b.insertBefore(this.Qm[a],b.firstChild),b=b.nextSibling}b=this.sUc();a=Qn.b(this.gb);for(c=0;c<this.Qm.length;++c)f=this.d9(c),this.Qm[c].childNodes[b].style.width=0<=a[c]?Math.max(f,this.Nd.Md.Ne(a[c],0))+"px":f+"px"}SVe(a){if(!this.mv.length){a=
this.Nd.createElement("div");a.innerText="\u00a0";a.className="TableLastResizeAnchor";var b=this.Nd.createElement("div");b.className=fn.a.Mvd+" Last";a.appendChild(b);Array.add(this.mv,a);rf.c(a,!0);a=!0}if(a){a=Math.min(this.mv.length,this.LG.childNodes.length);for(b=1;b<a;++b){var c=this.LG.childNodes[b];c.insertBefore(this.mv[b],c.firstChild)}(a=this.LG.lastChild)?a.insertBefore(this.mv[0],a.firstChild):ka.ULS.sendTraceTag(38285521,324,15,"Table first row has no child")}a=this.LG.childNodes.length;
if(a>this.mv.length){for(b=1;b<this.mv.length;++b)c=this.LG.childNodes[b],c.insertBefore(this.mv[b],c.firstChild);for(b=this.mv.length;b<a;++b){c=this.Nd.createElement("div");c.className=fn.a.Mvd;rf.c(c,!0);Array.add(this.mv,c);let f=this.LG.childNodes[b];f.insertBefore(c,f.firstChild)}a=this.LG.lastChild;a.insertBefore(this.mv[0],a.firstChild)}else if(a<this.mv.length){for(b=a;b<this.mv.length;++b)L.a.cLa(this.mv[b]),Ea.a.lP(this.mv[b]);b=[];for(c=0;c<a;++c)Array.add(b,this.mv[c]);this.mv=b;for(a=
1;a<this.mv.length;++a)b=this.LG.childNodes[a],b.insertBefore(this.mv[a],b.firstChild);(a=this.LG.lastChild)?a.insertBefore(this.mv[0],a.firstChild):ka.ULS.sendTraceTag(38285522,324,15,"Table first row has no child")}}EYe(a,b){let c=-1;if(cd.TableReader.Gm(this.gb))if(b<=Sys.UI.DomElement.getLocation(this.SS.firstChild.lastChild).x)c=this.SS.firstChild.childNodes.length-1;else for(var f=0;f<this.SS.firstChild.childNodes.length;++f){var l=Sys.UI.DomElement.getLocation(this.SS.firstChild.childNodes[f]);
if(b>=l.x){c=f;break}}else if(b<=Sys.UI.DomElement.getLocation(this.SS.firstChild.firstChild).x)c=0;else for(f=this.SS.firstChild.childNodes.length-1;0<=f;--f)if(l=Sys.UI.DomElement.getLocation(this.SS.firstChild.childNodes[f]),b>=l.x){c=f;break}c<a&&(b=c,c=a,a=b);f=[];l=ob.GraphIterator.pb(this.gb);const y=new ob.GraphIterator;b=new pf.GraphTransaction(2);b.Sy(l);Sd.moveToFirstRow(l);Sd.moveToColumnByIndex(l,a);y.Tc(l);Sd.moveToColumnByIndex(y,c);do(a=Od.SelectionFactory.KOc(l,y))&&Array.add(f,a),
Sd.moveToNextRow(y);while(Sd.moveToNextRow(l));a=new Ya.SelectionCollection(f,f.length-1,0);this.Qc.Nb.gF(a);b.dispose()}ftc(a,b){const c=this.sUc();this.Qm&&a<this.Qm.length&&this.Qm[a]&&(this.Qm[a].childNodes[c].style.width=Math.max(this.d9(a),b)+"px");this.vS.childNodes[a].style.width=Math.max(1,b)+"px"}wej(a){return this.SS.firstChild.childNodes[a]?this.SS.firstChild.childNodes[a].offsetWidth:(ka.ULS.sendTraceTag(36726402,341,10,"Column {0} does not exist in first row of table. Table Rows: {1} | First row view cells {2}",
a,this.SS.childNodes.length,this.SS.firstChild.childNodes.length),0)}zUc(a){a=parseInt(this.vS.childNodes[a].style.width);return isNaN(a)?Rn.a.a5e:a}c7(a){super.c7(a);N.a.instance.ga(63)&&this.ZPl();this.N9e()}N9e(){this.HHc||(this.HHc=new dd.a(3,1,0,Object(I.a)(this,this.updateTableDOMElements,"updateTableDOMElements"),119),w.AFrameworkApplication.Ae.Hb(this.HHc))}updateTableDOMElements(){this.HHc=null;this.b2&&(N.a.instance.ga(63)?this.TUk(this.X_k()):fn.a.lu&&this.fRe(this.sce()),w.AFrameworkApplication.fa.ka("IsComplexTableColumnSelectionHandleFixEnabled")&&
this.zph(!1))}iyd(){this.R9k()}Tbj(a){return a.offsetWidth+this.M9d(0)/2}sce(){const a=this.pUa(),b=a.length,c=[];let f=0,l=!1;const y=cd.TableReader.wt(this.gb);for(let Q=0;Q<b;Q++){const ia=a[Q];if(y){let Ua;({vqd:Ua}=this.nxd(ia)).returnValue&&(l=vk.f(Ua.gb))}const wa=ia.childNodes;for(let Ua=0;Ua<wa.length;Ua++){var H=wa[Ua];if(void 0!==H.colSpan&&null!==H.colSpan&&void 0!==H.rowSpan&&null!==H.rowSpan){let kb;({gYd:kb}=this.E7e(H)).returnValue&&(H=Object.assign(new GL,{zRa:kb,left:H.offsetLeft,
top:this.Eme?ia.offsetTop:f,width:this.Tbj(H),height:H.offsetHeight,pog:!Q,opg:Q+H.rowSpan===b,jog:!l&&!Ua}),c.push(H))}}f+=ia.offsetHeight}return c}ZPl(){if(this.b2){var a=new ob.GraphIterator;a.set(this.gb);if(cd.TableReader.aNf(a)&&this.vS){a=this.vS.childNodes.length;var b=Array(a),c=[],f=this.pUa(),l=f.length,y=0;for(let H=0;H<l;H++){let Q=0;const ia=f[H],wa=ia.childNodes;let Ua=0;for(let kb=0;kb<a;kb++){let Gb;if(b[kb]){let ec;(ec=b[kb]).UYc=ec.UYc-y;let dc;(dc=b[kb]).tqd=dc.tqd-1;Gb=b[kb].colSpan;
1===b[kb].tqd&&(Q=Math.max(Q,b[kb].UYc),b[kb]=null)}else{const ec=wa[Ua];Ua++;if(!ec)continue;let dc=0,Fc;({gYd:Fc}=this.E7e(ec)).returnValue&&(dc=Fc.g7b());Gb=ec.colSpan;1<ec.rowSpan?b[kb]=Object.assign(new DL,{colSpan:ec.colSpan,UYc:dc,tqd:ec.rowSpan}):Q=Math.max(Q,dc)}kb+=Gb-1}({vqd:y}=this.nxd(ia)).returnValue?(y.Gjl(Q)&&c.push(y),y=y.Esh):y=0}for(const H of c)H.YPl()}}}R9k(){const a=this.pUa();if(Rc.App.instance.T0c&&a.length&&!(a.length<=this.Qrf&&a[0].childNodes.length===this.gdf)){this.Qrf=
a.length;this.gdf=a[0].childNodes.length;var b;for(let c=0;c<a.length;c++)!Ea.a.Nda(a[c].firstChild,"DragHandle")&&({vqd:b}=this.nxd(a[c])).returnValue&&b.A9k()}}Dmg(a,b){b=a.querySelector("."+b);return!!b&&b.parentNode.parentNode===a}fRe(a){if(a)for(const b of a)b.zRa.Zwc(b.left,b.top,b.width,b.height,b.pog,b.opg,b.jog)}pUa(){return this.b2.children}E7e(a){let b;b=null;a&&(a=rf.a(a),b=Object(qa.a)(Qv,a));return{returnValue:!!b,gYd:b}}nxd(a){let b;b=null;a&&(a=rf.a(a),b=Object(qa.a)(lu,a));return{returnValue:!!b,
vqd:b}}X_k(){let a=0;const b=cd.TableReader.wt(this.gb),c=this.Eme,f=this.pUa(),l=[];let y=!1;for(let Q=0,ia=f.length;Q<ia;Q++){const wa=f[Q];if(!wa)continue;if(b){let ec;({vqd:ec}=this.nxd(wa)).returnValue&&(y=vk.f(ec.gb))}const Ua=new FL,kb=!Q,Gb=wa.childNodes;for(let ec=0,dc=Gb.length;ec<dc;ec++){var H=Gb[ec];let Fc;if(({gYd:Fc}=this.E7e(H)).returnValue){const yc=H.offsetTop,tc=H.rowSpan,xd=!ec;H=Object.assign(new EL,{zRa:Fc,left:H.offsetLeft,offsetTop:yc,top:c?yc:a,width:H.offsetWidth,height:H.offsetHeight,
rowSpan:tc,Vog:kb,Wog:Q+tc===ia,Uog:!y&&xd,Vgg:!xd&&this.Dmg(H,id.a.tie),rgg:!kb&&this.Dmg(H,id.a.sie)});Ua.WRd(H)}}a+=wa.offsetHeight;l.push(Ua)}return l}TUk(a){if(a.length){var b=this.M9d(1)/2,c=this.M9d(0)/2,f=a[0].cells[0].zRa,l=f.apg(!1);f=f.apg(!0);var y=[];for(var H of a[0].cells){var Q=H.zRa.tNl(H.left,H.width+c,H.offsetTop,l);Q&&y.push(Q)}fn.a.H2k(y);l=[];for(H=0;H<a.length;H++)y=a[H].cells[0],(Q=y.zRa.aQl(y.height+b,y.offsetTop,f))&&l.push(Q),1<y.rowSpan&&(H+=y.rowSpan-1);fn.a.w4k(l);for(const ia of a)for(const wa of ia.cells)a=
wa.zRa,f=wa.width,l=wa.height,a.XPl(f,l+b,wa.offsetTop,wa.left),a.Zwc(wa.left,wa.top,f+c,l,wa.Vog,wa.Wog,wa.Uog),wa.Vgg&&a.xnh(id.a.tie),wa.rgg&&a.xnh(id.a.sie)}}}om.Fvd="Border";om.d5e="NoBorder";om.FMf="Conflict";om.VQh="TableWordWrap";om.QDl="WACAltTextDescribedBy";om.KWa=null;Object(m.a)(om,"TableViewElement",sg.a,[1123,1029,472,107]);class Rv extends lu{constructor(a,b,c){super(a,b,c,null,null)}cOb(a){this.htmlElement.style.height=a+"px"}get Dsh(){return this.Nd.Md.Ne(this.gb.sa(zb.a.Fu,0),1)+
"px"}static idg(a){a=rf.a(a);let b=null;a&&(b=Object(qa.a)(Rv,a));return b}}Object(m.a)(Rv,"TableRowViewElement",lu,[]);class Xx{constructor(a,b,c=!1){this.pqi=a;this.Fyj=b;this.aQc=c}}Object(m.a)(Xx,"TableBorderProperty",null,[]);var zl=d(509);class cq{constructor(a,b,c,f,l){this.h$=a;this.jc=c;this.Rb=b;this.pHb=f;this.Hjk=l}foj(a){switch(a){case 0:a=Ab.a.GPb;break;case 1:a=Ab.a.HPb;break;case 2:a=Ab.a.JPb;break;case 3:a=Ab.a.KPb;break;default:a=null}return{returnValue:!!a,Utk:a}}Qta(a,b){let c=
0;if(!a)return c;let f;({Utk:f}=this.foj(b)).returnValue&&(c=3===b||0===b?a.sa(f,.1):a.sa(f,cq.aRk));return c}sHf(a){return.0555555555555556+this.Qta(a,1)+this.Qta(a,2)}AXd(a,b){const c=cd.TableReader.Gk(a);if(0>b||b>=c)return.0555555555555556;a=this.Rb.Lc(a).gq(b,1);return this.ELc(a)}ELc(a){let b=.0555555555555556;a=this.Rb.Lc(a);a.Cb(1);do{const c=a.currentNode;b=Math.max(b,.0555555555555556+this.Qta(c,0)+this.Qta(c,3))}while(a.Gf(1));return b}gub(a,b){var c=cd.TableReader.Gi(a);if(0>b||b>=c)return.0555555555555556;
c=.0555555555555556;a=this.Rb.Lc(a);a.Cb(1);do{const f=a.gq(b,1);c=Math.max(c,this.sHf(f));a.Cc()}while(a.Gf(1));return c}S$d(a){return a&&a.tblBgField&&a.tblBgField.fillField&&(a.tblBgField.fillField.solidFillField||a.tblBgField.fillField.gradFillField)?a.tblBgField.fillField:zl.a.Svb}yde(a,b){let c=b;if(this.Hjk&&b&&b.cellShading){let f;({Zla:f}=this.J7e(a,b.cellShading)).returnValue&&(b=Object(qa.a)(117,this.jc.mg(b)),c=this.pHb.Brh(a,b?b.Ed:null,f))}return c}b7b(a,b){let c=zl.a.Rvb;const f=cq.kUa(b);
f.returnValue&&(a=this.yde(b,a),a.Ua(f.kRa)&&(c=a.eb(f.kRa)));return c}P8d(a,b,c){if(c&&c.PD===rc.a.auto)return Ui.a.none;a=this.Nej(a);b=this.D9d(b);c=c.yV();return String.format("{0} {1}px {2}",a,b,c)}D9d(a){a=this.h$.Ne(a,0);z.a.nva&&0<a&&1>a&&(a=1);return a}Dtb(a,b,c=!1){let f=rc.a.pSa.yV();if(a.solidFillField){var l=Ge.Box4ColorHelper.UH(Ge.Box4ColorHelper.Rga(a.solidFillField),b);c&&(l.r=l.g=l.b=255);f=l.yV()}else if(a.gradFillField){a=gp.f(a.gradFillField,b);if(c)for(l of a.stops)l.color.r=
l.color.g=l.color.b=255;f=a.yV()}return f}fyj(a){const b=a.currentNode.Ai;a.Cc();const c=a.WF(1);a.gq(b,1);return c?a.currentNode:null}kyj(a){return a.WF(1)}J7e(a,b){switch(a){case 7:a=b.lnTField;break;case 0:a=b.lnBField;break;case 5:a=b.lnLField;break;case 6:a=b.lnRField;break;default:a=null}return{returnValue:!!a,Zla:a}}Nej(a){switch(a){case 2:case 3:case 4:case 5:case 6:case 7:case 9:case 10:return"dashed";case 1:case 8:return"dotted";default:return"solid"}}static kUa(a){let b,c;switch(a){case 7:a=
zb.a.Kza;b=zb.a.wMa;c=zb.a.uDl;break;case 0:a=zb.a.bha;b=zb.a.$ga;c=zb.a.pDl;break;case 5:a=zb.a.Jza;b=zb.a.vMa;c=zb.a.sDl;break;case 6:a=zb.a.cha;b=zb.a.aha;c=zb.a.tDl;break;case 2:a=zb.a.wmb;b=zb.a.umb;c=zb.a.rDl;break;case 1:a=zb.a.vmb;b=zb.a.tmb;c=zb.a.qDl;break;default:c=b=a=null}return{returnValue:!!a,kRa:a,Y7a:b,Mtb:c}}}cq.aRk=.2;Object(m.a)(cq,"TableStyleReaderHelper",null,[279]);class QD{constructor(a,b,c=-1){this.hY=a;this.ozg=b;this.jGg=c}}Object(m.a)(QD,"TableStyle",null,[]);var yr=d(336);
class Oz{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye){this.hY=new Jd.a;this.Aed=new Jd.a;this.zed=new Jd.a;this.ved=new Jd.a;this.j5e=[];this.Rb=a;this.HH=c;this.jc=b;this.gl=f;this.h$=l;this.b1=y;this.hJa=H;this.oc=Q;this.GGe=ia;this.rrk=wa;this.mrk=Ua;this.crk=kb;this.zc=Gb;this.uZa=ec;this.SJ=dc;this.Wo=Fc;this.Vq=yc;this.Veb=tc;this.D$c=xd;this.REb=Vd;this.SHa=Ld;this.pYa=ye;this.hJa.hja(Object(I.a)(this,this.ckd,"onTableConnectedOrDisconnected"));this.hJa.h8(Object(I.a)(this,
this.ckd,"onTableConnectedOrDisconnected"));this.hJa.fk(Object(I.a)(this,this.Xbh,"onTablePropertyChanged"));this.Vq.Pgi(Object(I.a)(this,this.U$g,"onPageViewBeforeValidate"))}dispose(){this.hJa.Woa(Object(I.a)(this,this.ckd,"onTableConnectedOrDisconnected"));this.hJa.hLa(Object(I.a)(this,this.ckd,"onTableConnectedOrDisconnected"));this.hJa.Om(Object(I.a)(this,this.Xbh,"onTablePropertyChanged"));this.Vq.j8k(Object(I.a)(this,this.U$g,"onPageViewBeforeValidate"))}O4f(a){if(!a||!a.length)return null;
const b=this.qUc(Object(qa.a)(pg.a,a[0]));if(!b)return null;for(let c=1;c<a.length;c++){const f=this.qUc(Object(qa.a)(pg.a,a[c]));if(!f||f.PD!==b.PD)return null}return b}lde(a){let b=null;if(a=this.J8b(a))b=new xq.a,b.ye(zb.a.tableStyle,new QD(a,Number.MAX_VALUE));return b}uXc(a){if(14!==a.type){a=this.Rb.Lc(a);a.sc(14);var b=a.Kg(14)}else b=a;a=b.id;this.zed.Fb(a)||(b=this.mde(b),this.zed.$(a,this.mrk(b)));return this.zed.ga(a)}ykj(a){return(a=this.oc.v8b(Object(qa.a)(117,this.jc.mg(a))))?a.TableListStyle:
null}mde(a){const b=Object(qa.a)(117,this.jc.mg(a));return this.GGe(()=>a.dV,()=>a.v3,()=>a.tableLook,()=>this.ykj(a),()=>b?b.Ed:null,()=>this.J8b(a))}ckd(a,b){this.qlg(b.node)}Xbh(a,b){a=b.property;b=b.node;if(a===zb.a.Oza||a===zb.a.ivc||a===ab.a.Nza||a===ab.a.dha||a===ab.a.tB){if(a===ab.a.Nza||a===ab.a.tB)b.jvc=!1;a!==zb.a.Oza&&a!==zb.a.ivc||this.qlg(b);this.$$b(b)}}wuk(a){Array.contains(this.j5e,a)||(this.$$b(a),this.j5e.push(a))}U$g(){Array.clear(this.j5e)}rRj(a){this.ved.remove(a.id)}qlg(a){a=
a.id;this.hY.remove(a);this.Aed.remove(a);this.zed.remove(a)}sXc(a){const b=a.id;this.ved.Fb(b)||this.ved.$(b,this.crk(this.mde(a)));return this.ved.ga(b)}J8b(a){const b=a.id;if(this.hY.Fb(b))return this.hY.ga(b);var c=a.sa(zb.a.Oza,null);if(!c)return null;let f=null;const l=lr.jZf(c);l&&a.Lh&&(f=a.Lh.ze(l));a=null;if(f)a=cl.a.NTa(f,zb.a.tableStyle);else if(c=this.b1.ecg("{"+c.toString()+"}"))a=c.hY;a&&this.hY.$(b,a);return a}dbe(a){return a.tableLook}d9(a,b){a=this.gl.gub(a,b);return this.h$.Ne(a,
0)}Sbj(a){if(a.Ua(zb.a.xP))switch(a.sa(zb.a.xP,0)){case 2:return"bottom";case 1:return"middle"}return"top"}P4f(a){var b=null;if(!a)return null;if(a.cellShading){var c=gp.a(a.cellShading);gp.e(c)||(b=c)}b||(b=this.$ka(a,zb.a.cellShading,zl.a.Svb));c=Object(qa.a)(117,this.jc.mg(a));b=this.gl.Dtb(b,c?c.Ed:null,this.Veb);a.rowIndex||1!==a.Ai||xa.a.J(509137695,822,50,"CellId={0} BGCss={1}",a.id.toString(),b);return b}qUc(a){var b=null;let c=null;if(!a)return null;if(a.cellShading){const f=gp.a(a.cellShading);
gp.e(f)||(b=f)}b||(b=this.$ka(a,zb.a.cellShading,zl.a.Svb));a=(a=Object(qa.a)(117,this.jc.mg(a)))?a.Ed:null;(b=b.solidFillField)&&(c=Ge.Box4ColorHelper.HEa(b,a));return c}Cab(a){var b=null;var c=Object(qa.a)(5,a);c&&(a=c.sa(Ab.a.listLevel,Df.a.yFa),c=this.Rb.Lc(c),c.sc(7)&&cd.TableReader.Gs(c)&&(c=Object(qa.a)(Vl.TableCellNode,c.Kg(16))))&&(this.qhh(c),b=1+a,b=this.HH.K4f(c,this.uXc(c),b));return{tableStyle:b,M8a:null}}ruj(a){let b=cl.a.ri(a,zb.a.cellShading,zl.a.Svb);if(gp.e(b)){const c=this.J8b(a);
c&&(b=this.gl.S$d(c))}a=Object(qa.a)(117,this.jc.mg(a));return this.gl.Dtb(b,a?a.Ed:null)}Vej(a){return!eb.a("PPTOEnableTableDiagonalBorders")||2!==a&&1!==a?zl.a.Rvb:zl.a.vRi}ngj(a,b){if(this.D$c&&this.Wo.bU&&!this.vTj(a,b))return new Xx("","");var c=Object(qa.a)(130,a);if(({kRa:y,Y7a:H,Mtb:Q}=cq.kUa(b)).returnValue)if(this.pYa&&eb.a("TableBordersLocalRenderingFix")){var f=this.$ka(c,y,this.Vej(b),!0);var l=this.$ka(c,Q,zl.a.Qvb,!0);var y=c.sa(y,f);f={};if(eb.a("FixClearTableBorder")){let ia=this.Rb.Lc(c);
ia.sc(14);if(ia.Kg(14).Ua(zb.a.Oza)){f.Color="##T,0,0,0";f=Ge.Box4ColorHelper.pS(f);f=this.$ka(c,H,f,!0);var H=cl.a.ri(c,H,f);H=Ge.Box4ColorHelper.Rga(H);a=this.jc.mg(a);a=(a=Ge.Box4ColorHelper.UH(H,a?a.Ed:null))?Ge.Box4ColorHelper.jha(a):null}else eb.a("FixTableBorderColor")?(f.Color="##T,1,0,0",f=Ge.Box4ColorHelper.pS(f),f=this.$ka(c,H,f,!0),H=cl.a.ri(c,H,f),H=Ge.Box4ColorHelper.Rga(H),a=this.jc.mg(a),a=(a=Ge.Box4ColorHelper.UH(H,a?a.Ed:null))?Ge.Box4ColorHelper.jha(a):null):(f.Color="#000000",
a=Ge.Box4ColorHelper.pS(f),a=Ge.Box4ColorHelper.Jta(a))}else f.Color="##T,0,0,0",f=Ge.Box4ColorHelper.pS(f),f=this.$ka(c,H,f,!0),H=cl.a.ri(c,H,f),H=Ge.Box4ColorHelper.Rga(H),a=this.jc.mg(a),a=(a=Ge.Box4ColorHelper.UH(H,a?a.Ed:null))?Ge.Box4ColorHelper.jha(a):null;l=c.sa(Q,l)}else l=this.gl.yde(b,c),y=l.Ua(y)?l.eb(y):this.$ka(c,y,zl.a.Rvb,!0),a=this.H4f(l,c,H),l=l.Ua(Q)?l.eb(Q):this.$ka(c,Q,zl.a.Qvb,!0);else y=zl.a.Rvb,a=zl.a.qPc,l=zl.a.Qvb;5!==b||a.PD===rc.a.auto||c.rowIndex||1!==c.Ai||xa.a.J(509137694,
822,50,"CellId={0} BGR={1} Alpha={2}",c.id.toString(),a.PD,a.alpha);var Q=!1;a.PD!==rc.a.auto||7!==b&&5!==b||(f=this.Rb.Lc(c),f.sc(14),7===b?(H=zb.a.$ga,f=this.gl.fyj(f)):(H=zb.a.aha,f=this.gl.kyj(f)),f&&(c=this.gl.yde(b,c),this.H4f(c,f,H).PD===rc.a.auto&&(l=zl.a.Qvb,y=zl.a.Eyj,a=zl.a.Dyj,Q=!0)));c=this.gl.P8d(l,y,a);return Q&&7===b?new Xx(c,"Top"):Q&&5===b?new Xx(c,"Left"):new Xx(c,"")}gVc(a,b){switch(b){case 7:b=zb.a.Kza;break;case 6:b=zb.a.cha;break;case 0:b=zb.a.bha;break;case 5:b=zb.a.Jza;break;
default:b=null}const c=this.$ka(a,b,zl.a.Rvb,!0);return a.sa(b,c)}vTj(a,b){if(!a||a.isGhostCell||2===b||1===b)return!0;const c=this.Rb.Lc(a);if(!c.sc(14))return!0;var f=c.ix(14);if(!f.Op())return!0;const l=a.rowSpan,y=a.colSpan;if(1===l&&1===y)return!0;f=this.zc.ouj(f);const H=new yr.a;H.te=this.uZa.aqj(c);H.eg=H.te+l;H.me=this.SJ.AUc(Object(qa.a)(130,a));H.Tf=H.me+y;switch(b){default:xa.a.J(509137693,822,15," Unknown position type: {0} ",b);break;case 5:if(!H.me||1===l)break;if(4!==(f.As(H.te,H.me-
1)&4)||8!==(f.As(H.eg-1,H.me-1)&8))break;for(a=H.te+1;a<H.eg;++a)if(4===(f.As(a,H.me-1)&4))return!1;break;case 6:if(H.Tf===f.PR||1===l)break;if(4!==(f.As(H.te,H.Tf)&4)||8!==(f.As(H.eg-1,H.Tf)&8))break;for(a=H.te+1;a<H.eg;++a)if(4===(f.As(a,H.Tf)&4))return!1;break;case 7:if(!H.te||1===y)break;if(1!==(f.As(H.te-1,H.me)&1)||2!==(f.As(H.te-1,H.Tf-1)&2))break;for(a=H.me+1;a<H.Tf;++a)if(1===(f.As(H.te-1,a)&1))return!1;break;case 0:if(H.eg!==f.fP&&1!==y&&1===(f.As(H.eg,H.me)&1)&&2===(f.As(H.eg,H.Tf-1)&2))for(a=
H.me+1;a<H.Tf;++a)if(1===(f.As(H.eg,a)&1))return!1}return!0}H4f(a,b,c){if(this.pYa){const f=Ge.Box4ColorHelper.pS({Color:"##T,0,0,0"});a=cl.a.ri(a,c,f);a=Ge.Box4ColorHelper.Rga(a);b=this.jc.mg(b);b=(b=Ge.Box4ColorHelper.UH(a,b?b.Ed:null))?Ge.Box4ColorHelper.jha(b):null}else a.Ua(c)?(b=a.Rh(c),b=Object(Wa.a)(rc.a,b)?b:new rc.a(a.eb(c))):b=this.$ka(b,c,zl.a.qPc,!0);this.Veb&&(b=new rc.a(0,b.alpha));return b}$$b(a){const b=this.SHa?this.Rb.Yae(a):this.Rb.Lc(a);let c=Object(qa.a)(155,b.Oi());for(a=Object(qa.a)(178,
a);c;)c.rqd=!1,c=Object(qa.a)(155,b.np());this.rRj(a);this.SHa?this.aRj(a):a.oea(4)}aRj(a){if(a&&a.isConnected)for(a=this.Rb.Yae(a),a=tk.a.xv(a);a.moveNext();)a.currentNode.anchor.Jr(4)}pUl(a){a&&(this.uXc(a),this.J8b(a),this.sXc(a))}$ka(a,b,c,f=!1){if(!a)return c;var l=this.Rb.Lc(a);l.sc(14);l=l.Kg(14);var y=l.id;if(this.REb&&f){if(!l.Ua(zb.a.Oza))return c;y=a.rowIndex;a=a.Ai;return(a=this.sXc(l).lbj(l,y,a))&&a.Ua(b)?a.Rh(b):c}this.qhh(a);f=a.qV;if(!f){if(!l.Ua(zb.a.Oza))return c;f=a.rowIndex;let H=
a.Ai;const Q=a.rowSpan,ia=a.colSpan;this.Aed.Fb(y)||this.Aed.$(y,this.rrk(this.mde(l)));f=this.Aed.ga(y).J9d(f,H,Q,ia);a.qV=f}return f&&f.Ua(b)?f.Rh(b):c}Dvi(a){const b=this.Rb.YTa();b.set(a);let c=0,f=Object(qa.a)(155,b.Cb(1));for(;f;)f.rowIndex=c,c++,f=Object(qa.a)(155,b.np());a.jvc=!0}PSk(a){let b=0;const c=a.rowIndex,f=this.Rb.YTa();f.set(a);let l=Object(qa.a)(130,f.Cb(1));for(;l;)l.rowIndex=c,l.Ai=b,l.qV=null,this.HH.Gal(l),l.qXf(),l=Object(qa.a)(130,f.np()),b++;a.rqd=!0}qhh(a){var b=this.Rb.Lc(a);
b.sc(14);a=Object(qa.a)(155,b.Kg(15));(b=Object(qa.a)(178,b.Kg(14)))&&!b.jvc&&this.Dvi(b);a&&!a.rqd&&this.PSk(a)}}Object(m.a)(Oz,"TableStyleReader",null,[1124,1125,1126]);class Ll extends om{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc){super(a,b,c);this.Q$c=this.Wv=this.MGb=this.Kva=this.zH=null;this.jkc=l;this.gl=y;this.Wo=H;this.$e=Q;this.X0=[];this.oc=f;this.ggb=kb;this.pc=Gb;this.jc=ec;this.ij=dc;this.UEb=wa.pptIsTableColumnRowResizeHandleRenderedByCSSEnabled;this.wAe=wa.pptComplexTableLayoutSyncEnabled;
this.I0=wa.ela;this.dVg=Ua;this.zc=Fc;this.Rb=yc;this.MBe=wa.Faa;this.F$c=wa.rHh;if(tc)this.Wv=tc;else throw Error.argumentNull("slideDimensionsHelper");if(this.Qc.qp){if(this.zH=ia?ia(a):null)this.zH.ULh(),this.Ok&&this.Ok.hV&&(this.zH.Lpi(this,this.Ok.hV,this.table),this.zH.Xw(!this.pc.Pn));eb.a("DeprecateIE.TableViewElement.ctor")||!this.Wo.qcb&&!this.Wo.scb||(this.htmlElement.style.backgroundColor="rgba(0,0,0,0)")}this.Ok&&(this.Ok.ugi(Object(I.a)(this,this.Vah,"onShapeEnterTextEditing")),this.Ok.Lzf(Object(I.a)(this,
this.dbh,"onShapeSelectionChanged")),this.Ok.wgi(Object(I.a)(this,this.Wah,"onShapeExitTextEditing")),this.Ok.Xfi(Object(I.a)(this,this.q7g,"onAfterDraw")),this.Ok.Ihi(Object(I.a)(this,this.pah,"onReadModeChanged")),this.Ok.sgi(Object(I.a)(this,this.O8g,"onDisplayOnActiveSlide")))}get dAi(){return this.zH}O8g(){this.W4e()}get Ok(){if(this.Kva)return this.Kva;if(this.Qc.qp){const a=Yf.a.pb(this.Qc.Na,this.gb);a.kf();a.O0a();this.Kva=Object(qa.a)(119,a.lSa)}return this.Kva}Wbe(){if(!this.F$c)return 1;
var a=this.jc.mg(this.gb);if(!a)return 1;var b=a.qc(this.Na);if(!b)return 1;b=b.fda?b.fda.va.style.visibility===Ki.a.visible:!1;var c=new vr.a(a.Vp,a.Vk);if(!this.Wv)return 1;b=this.Wv.s8b(c,b).qP;c=this.ij.WG;a=this.oc.hXc(a)*c;return b/a}huh(a){if(1!==a&&this.F$c){var b=this.zc.Zka(this.gb);for(var c of b)b=this.Nd.Md.Ne(c.sa(zb.a.Fu,0),1)*a,c.qc(this.Na).htmlElement.style.height=b+"px";c=Qn.b(this.gb);for(b=0;b<c.length;b++){const f=this.Nd.Md.Ne(c[b],0)*a;this.dNc.childNodes[b].style.width=f+
"px"}}}Yy(a){super.Yy(a);this.huh(this.Wbe());this.ZIh(this.ggb.KAb?!!this.Ok&&this.Ok.iJ()&&(this.Ok.CB||this.Ok.io):!!this.Ok&&this.Ok.io)}$U(){const a=this.jkc,b=Qn.b(this.gb),c=cd.TableReader.Gi(this.gb);let f=0;for(let l=0;l<c;l++)f+=Math.max(a.d9(this.gb,l),this.Nd.Md.Ne(b[l],0));return new Jj.a(0,f,0)}c7(a){super.c7(a);if(this.Qc.qp&&(a=this.dVg.aXc(this.gb,this.Na))&&0!==a.R_c){const b=this.gb;if(b.lO)return;this.wAe?a.QNh(b):a.R_c&2?a.QNh(b):a.SOl(b,c=>{c&&this.W4e()})}this.W4e()}W4e(){this.zH&&
this.Ok&&this.Ok.io&&this.V4e()}xyh(a,b){Object(qa.a)(Oz,fb.StyleReader.xr);if(1!==b)for(var c=0;c<this.b2.childNodes.length;c++){var f=this.b2.childNodes[c];if(!f||"TR"!==f.tagName.toUpperCase())continue;const y=f.offsetHeight*b;var l=this.gl.AXd(this.gb,c);l=this.Nd.Md.Ne(l,1);f.style.height=(y<l?0:y)+"px"}if(1!==a)for(b=0;b<this.dNc.childNodes.length;b++)c=rb.a.Nn(this.dNc.childNodes[b].style.width),f=this.gl.gub(this.gb,b),f=this.Nd.Md.Ne(f,0),this.ftc(b,Math.max(c*a,f))}Upj(a){a>this.b2.childNodes.length&&
Error.argumentOutOfRange("rowIdx");const b=this.b2.childNodes[a];b&&"TR"===b.tagName.toUpperCase()||Error.invalidOperation(String.format("Child node '{0}' is not a table row",a));return rb.a.Nn(b.style.height)}G8b(){return fj.a.Lda(this.$e.ki(this.table))}get bZj(){const a=this.dVg.aXc(this.gb,this.Na);return!a||0===a.R_c}qag(){const a=[0];for(let b=1;b<=this.b2.childNodes.length;++b)a[b]=a[b-1]+this.b2.childNodes[b-1].offsetHeight;return a}h5f(){const a=[0];for(let b=1;b<=this.dNc.childNodes.length;++b)a[b]=
a[b-1]+this.zUc(b-1);return a}SVe(a){if(14!==this.gb.type)xa.a.J(512497121,808,10,"The source node of the table view element is not a table node but {0}",this.gb.type);else if(this.gb.sa(zb.a.complexTable,!0))xa.a.J(512497118,808,50,"Disable column resizing for table with merged cells");else{super.SVe(a);a=new ob.GraphIterator;a.set(this.gb);Sd.moveToFirstRow(a);Sd.moveToFirstColumn(a);let b=1;const c=this.Nd.Md.Ne(this.gl.b7b(a.currentNode,6),0);for(;!ae.isLastCellInRow(a);){Sd.moveToNextColumn(a);
const f=this.mv[b++],l=rb.a.Pc(-1*c);cd.TableReader.Gm(this.gb)?f.style.marginRight=l:f.style.marginLeft=l}this.mv.length!==b&&xa.a.J(512497119,808,10,"Table has inconsistent column resize handles: {0} handles, {1} columns",this.mv.length,b)}}yba(a){super.yba(a);this.Qc.hm||this.T9k();this.gb.sa(zb.a.complexTable,!0)||fn.a.lu||this.S9k()}dispose(){super.dispose();this.zH&&(this.zH.dispose(),this.zH=null);this.Ok&&(this.Ok.W7k(Object(I.a)(this,this.Vah,"onShapeEnterTextEditing")),this.Ok.fph(Object(I.a)(this,
this.dbh,"onShapeSelectionChanged")),this.Ok.X7k(Object(I.a)(this,this.Wah,"onShapeExitTextEditing")),this.Ok.G7k(Object(I.a)(this,this.q7g,"onAfterDraw")),this.Ok.J8k(Object(I.a)(this,this.pah,"onReadModeChanged")),this.Ok.U7k(Object(I.a)(this,this.O8g,"onDisplayOnActiveSlide")));this.Kva=null}q7g(){this.Ok.pO&&this.V4e(!0)}byi(){if(this.MBe){var a=this.gb,b=a.Bab();if(a.jvc)for(const c of b){a=c;if(!a)continue;a=a.qc(this.Na);if(!a)continue;b=this.jkc.gVc(c,7);const f=this.jkc.gVc(c,6),l=this.jkc.gVc(c,
0),y=this.jkc.gVc(c,5);0===b&&a.xod("Top");0===f&&a.xod("Right");0===l&&a.xod("Bottom");0===y&&a.xod("Left")}}}dbh(a,b){this.ZIh(b.isSelected);a=this.table;this.byi();b.isSelected?Sys.UI.DomElement.containsCssClass(a,"Selected_Table")||Sys.UI.DomElement.addCssClass(a,"Selected_Table"):Sys.UI.DomElement.containsCssClass(a,"Selected_Table")&&Sys.UI.DomElement.removeCssClass(a,"Selected_Table")}pah(a,b){this.zH&&this.zH.Xw(b.D1j)}ZIh(a){if(this.zH)if(this.I0){const b=this.Rb.Lc(this.gb);b.kf();b.O0a().eb(zb.a.isResizable)?
this.zH.visible=a:this.zH.visible=!1}else this.zH.visible=a;this.Ok&&this.Ok.Rd&&this.Ok.shapeNode&&this.Ok.shapeNode.XQ&&(this.Ok.Rd.visible=a)}S9k(){if(!this.X0.length){var a=this.bSa();Sys.UI.DomElement.addCssClass(a,"First");this.X0.push(a);a=this.bOi();Sys.UI.DomElement.addCssClass(Ll.F7f(a),"Last");this.X0.push(a)}var b=this.pUa();a=b.length;var c=a+1-this.X0.length;if(!(0>=a)){if(0<c)for(var f=0;f<c;f++){let l=this.bSa();this.X0.splice(this.X0.length-1,0,l)}if(0>c){for(f=0;f<c;f++)this.ULb(this.X0[f+
1]);this.X0.splice(1,c)}for(c=0;c<a;c++)f=b[c].firstChild,f.insertBefore(this.X0[c],f.firstChild);b=b[a-1].firstChild;b.insertBefore(this.X0[a],b.firstChild);this.xji()}}xji(){const a=new ob.GraphIterator;a.set(this.gb);Sd.moveToFirstRow(a);Sd.moveToFirstColumn(a);let b=1;for(;b<this.X0.length;){var c=this.Nd.Md.Ne(this.gl.b7b(a.currentNode,5),0),f=this.Nd.Md.Ne(this.gl.b7b(a.currentNode,0),1);let l=this.X0[b];Ll.w4j(l)&&(l=Ll.F7f(l));c=rb.a.Pc(-1*c);f=rb.a.Pc(-1*f-(b===this.X0.length-1?4:0));cd.TableReader.Gm(this.gb)?
l.style.marginRight=c:l.style.marginLeft=c;l.style.marginTop=f;Sd.moveToNextRow(a);b++}}T9k(){if(!this.MGb){const a=String.format("url('{0}'), pointer",Ey.a.box4Image("RowSelect.cur"));this.MGb=this.Nd.createElement("div");this.MGb.className=fm.a.dEl;rf.c(this.MGb,!0);const b=this.Nd.createElement("div");b.className=fm.a.e5e;b.style.cursor=a;this.MGb.appendChild(b);this.table.appendChild(this.MGb)}}Vpj(){return this.pUa()}bSa(){const a=this.Nd.createElement("div");a.className="TableRowResizeHandle";
a.style.width="100%";rf.c(a,!0);return a}bOi(){const a=this.Nd.createElement("div");a.className="TableRowResizeAnchor";const b=this.bSa();a.appendChild(b);rf.c(a,!0);return a}ULb(a){L.a.cLa(a);Ea.a.lP(a)}guj(a){var b=this.jc.mg(this.gb);let c=this.ij.WG;b&&b.lx&&null!=b.lx.gs&&(c=b.lx.gs);b=this.oc.hXc(this.jc.mg(this.gb))*c;a=a.copy();a.move(-a.ic,-a.kc);a.scale(1/b,1/b);return a}Vah(){this.table.clientWidth&&this.V4e(!0);!this.ggb.KAb&&this.zH&&(this.zH.visible=!0,this.Ok&&this.Ok.Rd&&(this.Ok.Rd.visible=
!0));this.Ok&&this.Ok.iJ()&&!Sys.UI.DomElement.containsCssClass(this.table,"Selected_Table")&&Sys.UI.DomElement.addCssClass(this.table,"Selected_Table")}Wah(){this.zH&&(this.zH.visible=!1);this.Ok&&this.Ok.Rd&&(this.Ok.Rd.visible=!1)}V4e(a=!1){var b=this.G8b();let c=Xi.a.Izd;this.Q$c&&(c=fj.a.Q7b(b,this.Q$c));const f=Zc.a.baf;a=!!this.Ok&&(!this.Q$c||!f.equals(Zc.a.baf)||!c.equals(Xi.a.Izd)||a);this.Q$c=b;if(a&&(a=this.Ok.L8e,b=fj.a.Q7b(this.guj(b),a),this.Ok.setOffsets(b,!0),!eb.a("DeprecateIE.TableViewElement.SynchronizeViews")&&
this.Wo.qcb&&0<this.b2.childNodes.length))for(b=this.b2.childNodes[0].offsetWidth,a=0;a<this.X0.length;a++)this.X0[a].style.width=b+"px";this.zH&&this.zH.em();this.UEb||this.N9e()}sce(){return this.UEb?null:super.sce()}fRe(a){if(this.UEb){var b=this.zc.Gk(this.gb);a=Object(qa.a)(ob.GraphIterator,this.Rb.Lc(this.gb));Sd.forEachCellInTable(a,(c,f,l)=>{c=c.currentNode;const y=c.qc(this.Na);y&&y.Zwc(0,0,0,0,!f,f+c.rowSpan===b,!l);return!0})}else super.fRe(a)}Wlj(a){let b=-1;var c=cd.TableReader.Gi(this.gb),
f=Qn.b(this.gb);const l=Array(c);for(let y=0;y<c;y++)l[y]=Math.floor(this.Nd.Md.Ne(f[y],0));if(cd.TableReader.Gm(this.gb))if(a<=Sys.UI.DomElement.getLocation(this.b2.firstChild.lastChild).x)b=c-1;else{a-=Sys.UI.DomElement.getLocation(this.b2.firstChild.lastChild).x;for(--c;0<=c;c--)if(a>=l[c])a-=l[c];else{b=c;break}-1===b&&(b=0)}else if(a<=Sys.UI.DomElement.getLocation(this.b2.firstChild.firstChild).x)b=0;else{a-=Sys.UI.DomElement.getLocation(this.b2.firstChild.firstChild).x;for(f=0;f<c;f++)if(a>=
l[f])a-=l[f];else{b=f;break}-1===b&&(b=c-1)}return b}Tuh(a,b,c=!0){const f=ob.GraphIterator.pb(this.gb),l=new ob.GraphIterator,y=new pf.GraphTransaction(2);y.Sy(f);Sd.moveToFirstRow(f);c?(Sd.moveToRowByIndex(f,a),Sd.moveToFirstColumn(f)):Sd.moveToColumnByIndex(f,a);l.Tc(f);c?(Sd.moveToRowByIndex(l,b),Sd.moveToLastColumn(l)):(Sd.moveToColumnByIndex(l,b),Sd.moveToLastRow(l));a=Od.SelectionFactory.y3b(f,l);this.Qc.Nb.gF(a);y.dispose()}static Xpj(a){return Ll.Ypj(a,fn.a.lu)}static Ypj(a,b){return b?Ll.Wpj(a):
Ll.Zpj(a)}static Zpj(a){let b=a;for(;b;){if("tr"===b.nodeName.toLowerCase()){Ll.Ane(a)||Ll.moe(a)||(b=b.previousSibling);break}b=b.parentNode}return Rv.idg(b)}static Wpj(a){let b=a;for(;b;){if("tr"===b.nodeName.toLowerCase()){if(Ll.moe(a)){if((a=a.parentNode)&&void 0!==a.rowSpan&&null!==a.rowSpan){a=a.rowSpan;for(let c=1;c<a&&b;c++)b=b.nextSibling}}else Ll.Ane(a)||(b=b.previousSibling);break}b=b.parentNode}return b?Rv.idg(b):null}static E4(a){return Sys.UI.DomElement.containsCssClass(a,"TableColumnResizeHandle")}static nWa(a){return Sys.UI.DomElement.containsCssClass(a,
"TableRowResizeHandle")}static w4j(a){return Sys.UI.DomElement.containsCssClass(a,"TableRowResizeAnchor")}static jva(a){return Sys.UI.DomElement.containsCssClass(a,"TableColumnHandle")}static wcc(a){return Sys.UI.DomElement.containsCssClass(a,fm.a.e5e)}static nuj(a){for(;a;){if("TABLE"===a.nodeName.toUpperCase())return a;a=a.parentNode}return null}static Ane(a){return Sys.UI.DomElement.containsCssClass(a,"First")}static moe(a){return Sys.UI.DomElement.containsCssClass(a,"Last")}static kog(a){return Sys.UI.DomElement.containsCssClass(a,
"FirstLeft")}static F7f(a){return a.firstChild}}Object(m.a)(Ll,"TableViewElement",om,[1121,1122,1123,1029,472,107]);class IL extends CL.a{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua){super(a,b);this.qGf="ShowDashedLine";this.fna=this.ge=this.Yd=this.DNg=this.xNg=this.LNg=this.Qfb=this.CDe=this.BDe=this.qe=this.FNg=null;this.tXg=this.sXg=this.B5=this.A5=this.wgb=this.Efa=0;this.caa=c;this.ffb=f;this.Rs=l;this.zc=y;this.pa=H;this.JA=Q;this.ia=ia;this.Up=Ua;this.Ygc=this.CAe=!1;this.nkk=wa}get TWe(){this.CJf();
return this.qe.offsetLeft}set TWe(a){this.CJf();this.qe.style.left=rb.a.Pc(a)}get zoom(){return 1}Yu(a){const b=super.Yu(a);if(b&&this.zN){this.vXd(a.Bc);Sys.UI.DomElement.addCssClass(this.qe,this.qGf);if(this.cca=Ll.kog(a.Bc))this.zi=0,this.AF=this.Gl.zUc(this.zi);this.Yd=this.Gl.Ok;this.ge=this.zc.I8b(this.Yd.gb);this.Ygc=!1;this.Q0e()&&this.Ucj(a)}else b&&!this.zN&&(a=a.Bc,Ll.jva(a)&&(xa.a.J(512497184,816,50,"Drag from table column handle"),this.zi=parseInt(a.parentNode.getAttribute("columnindex").toString())));
b&&this.Up&&this.ia.processAction(C.a.Bka,2);return b}Rw(a){this.zN?(a=this.tHf(a.clientPoint.x),this.TWe=this.FNg+(a-this.AF)*(this.cca?-1:1)):(a=this.Gl.Wlj(a.clientPoint.x),this.Gl.Tuh(this.zi,a,!1));return!0}to(a){if(this.zN){const f=this.caa.Ii("UserAction","PPTColumnResize");a&&xa.a.J(8959051,822,50,String.format("Start Column resize for table: {0}, IsComplex: {1}",this.Gl.gb.sa(zb.a.ZHb,""),this.Gl.gb.Op()));const l=new pf.GraphTransaction(15);l.ld(this.Gl.gb);const y=this.Gl.gb.sa(ab.a.ev,
null);var b=this.tHf(a.clientPoint.x),c=this.Gl.Nd.Md;const H=c.gf(b,0);(this.cca||this.zi===this.IG-1)&&this.Rs.p1a(this.Gl.gb,this.zi,H);if(this.cca&&b!==this.AF&&(b=this.AF-b)){this.Yd.setPosition(this.Yd.x+b,this.Yd.y,!0);b=c.gf(this.Yd.x,0);c=c.gf(this.Yd.y,1);const Q=this.Gl.Ok.shapeNode;Q.Iy=b;Q.Jy=c}!this.cca&&this.zi<this.IG-1&&this.O_e(H,y);this.lwc();l.dispose();Rc.App.Lb.updateCommandUI();this.end();this.ge?this.Rs.q0a(this.ge):xa.a.J(512497183,822,15," OnDragEnd: m_tableNode is null. Unable to Redraw Diagonal borders.");
f&&f.stop();a&&xa.a.J(8959053,822,50,String.format("End Column resize for table: {0}, IsComplex: {1}, IsFirstColumnLeftResizeHandle: {2}",this.Gl.gb.sa(zb.a.ZHb,""),this.Gl.gb.Op(),this.cca))}else a&&Rc.App.Lb.C6(a.clientPoint,a.ng),super.to(a)}Au(a){super.Au(a);this.zN&&this.lwc()}$bg(){return null}CJf(){if(!this.qe)throw Error.argumentNull("m_element","Try to use the resize handle before it is initialized");if(!fn.a.E4(this.qe))throw Error.invalidOperation("Element is not the table column resize handle");
}vXd(a){this.qe=a;this.FNg=this.TWe;this.BDe=this.qe.style.marginLeft;this.CDe=this.qe.style.marginRight;this.Qfb=this.qe.style.height;this.LNg=this.qe.style.top;this.xNg=this.qe.style.bottom;this.DNg=this.qe.style.left;this.qe.style.marginLeft=this.qe.style.marginRight="auto";this.qe.style.top="0";this.qe.style.height="auto";this.qe.style.bottom="0";this.ffb&&(a=fn.a.K8b(a))&&(this.qe.style.top=-a.offsetTop+"px",this.qe.style.bottom=-(this.Gl.getBounds().height-a.offsetTop-a.offsetHeight)+"px")}lwc(){this.qe&&
(Sys.UI.DomElement.removeCssClass(this.qe,this.qGf),this.qe.style.marginLeft=this.BDe,this.qe.style.marginRight=this.CDe,this.BDe=this.CDe="auto",this.qe.style.left=this.nkk?this.DNg:"auto",this.qe.style.top=this.LNg,this.qe.style.height=this.Qfb,this.qe.style.bottom=this.xNg,this.qe=null)}Ucj(a){this.Ygc=this.CAe=!1;a=a.Bc;if(fn.a.E4(a)){var b=null,c=null;({edb:b,Bkb:c}=this.Tcj(a,b,c)).returnValue&&this.Hdj(b,c)&&this.rce()&&this.ge&&(a=this.zc.Gi(this.ge),b=this.zc.Gk(this.ge),0<=this.Efa&&this.Efa<
b&&0<=this.wgb&&this.wgb<b&&0<=this.A5&&this.A5<a&&0<=this.B5&&this.B5<a&&(this.Ygc=!0))}}Tcj(a,b,c){if(!fn.a.E4(a)||!this.ge)return{returnValue:!1,edb:b,Bkb:c};var f=fn.a.K8b(a);f=rf.a(f);this.fna=Object(qa.a)(Vl.TableCellNode,f.gb);if(!this.fna)return{returnValue:!1,edb:b,Bkb:c};f=this.ZVc(this.fna);if(0>f||f>=this.zc.Gi(this.ge))return{returnValue:!1,edb:b,Bkb:c};const l=this.fna.rowIndex;if(0>l||l>=this.zc.Gk(this.ge))return{returnValue:!1,edb:b,Bkb:c};if(Ll.kog(a))return{returnValue:!1,edb:null,
Bkb:c};b=this.ge.ef(l,f);if(f===this.zc.Gi(this.ge)-1)return{returnValue:!1,edb:b,Bkb:null};c=this.ge.ef(l,f+1);return{returnValue:!0,edb:b,Bkb:c}}Hdj(a,b){if(!this.ge||!a||!b)return!1;this.Efa=a.rowIndex;if(0>this.Efa||this.Efa>=this.zc.Gk(this.ge))return!1;this.wgb=this.Efa;this.A5=this.q7b(a);if(0>this.A5||this.A5>=this.zc.Gi(this.ge))return!1;this.B5=this.ZVc(b);if(0>this.B5||this.B5>=this.zc.Gi(this.ge))return!1;var c=this.t$i(a,b);a=c?this.abj(a,b):!1;if(c=c&&a)this.CAe=this.HVj(b.Ai);return c}HVj(a){let b=
!0;if(0<this.Efa)for(var c=this.Efa-1;0<=c;){var f=this.ge.ef(c,a);if(f&&!f.isGhostCell){b=!1;break}--c}if(this.wgb<this.ge.dV-1)for(c=this.Efa+1;c<=this.ge.dV-1;){if((f=this.ge.ef(c,a))&&!f.isGhostCell){b=!1;break}c+=1}return b}rce(){if(!this.ge)return!1;const a=this.zc.Gi(this.ge);if(0>this.A5||this.A5>=a||0>this.B5||this.B5>=a||0>this.zi||this.zi>=a||0>this.zi+1||this.zi+1>=a)return!1;this.sXg=this.mee(this.ge,this.A5,this.zi)-this.pbe(this.ge,this.A5);this.tXg=this.mee(this.ge,this.B5,this.zi+
1)-this.pbe(this.ge,this.B5);return!0}mee(a,b,c){if(b>c)return this.mee(a,c,b);if(!a||0>b||b>=this.zc.Gi(a)||0>c||c>=this.zc.Gi(a))return-1;a=a.U9d;let f=0;for(;b<=c;b++)f+=a[b];return Math.floor(this.Gl.Nd.Md.Ne(f,0))}pbe(a,b){return fb.StyleReader.xr?fb.StyleReader.xr.d9(a,b):Rn.a.Ivd}UEa(a,b){return this.Gl.Nd.Md.gf(this.pbe(a,b),0)}t$i(a,b){if(!a||!b)return!1;a=a.i7b();const c=b.Ai;for(b=b.i7b();b&&(!b.isGhostCell||this.q7b(b)===c);)this.Efa--,this.A5=Math.max(this.A5,this.q7b(a)),this.B5=Math.min(this.B5,
this.ZVc(b)),a=a.i7b(),b=b.i7b();return!0}abj(a,b){if(!a||!b)return!1;a=a.oUc();const c=b.Ai;for(b=b.oUc();b&&(!a.isGhostCell||this.q7b(b)===c);)this.wgb++,this.A5=Math.max(this.A5,this.q7b(a)),this.B5=Math.min(this.B5,this.ZVc(b)),a=a.oUc(),b=b.oUc();return!0}q7b(a){return a?(a=a.mz())?a.Ai:-1:-1}ZVc(a){if(!a)return-1;let b=a;a.isGhostCell&&(b=a.mz());a=null;b&&(a=b.Eae(2));return a?a.Ai:-1}tHf(a){this.Q0e()&&this.Ygc?(a=this.Gl.gb.i2j?Math.floor((this.N7-a)/this.zoom)+this.AF:Math.floor((a-this.N7)/
this.zoom)+this.AF,a=Math.min(a,this.AF+this.tXg),a=Math.max(a,this.AF-this.sXg)):a=this.BXd(a);return a}O_e(a,b){if(this.Q0e()&&this.Ygc){if(!this.pa.rH()){var c=Od.SelectionFactory.Qg(Object(qa.a)(pg.a,this.fna.m6b),0);this.pa.setSelection(c)}let f=c=-1,l=-1;({kVf:c,CUf:f,DUf:l}=this.Xfj(a-b[this.zi],b,c,f,l));this.CAe&&(c===this.zi&&Math.abs(f)>=this.UEa(this.ge,c)||c===this.zi+1&&c<this.zc.Gi(this.ge)-1&&Math.abs(l)>=this.UEa(this.ge,c+1)||c===this.zi+1&&c===this.zc.Gi(this.ge)-1)?(xa.a.J(512497182,
815,50,"DragAcrossColumn: scenario-1, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",this.zi.toString(),c.toString(),f.toString(),l.toString()),a=b[this.zi]+b[this.zi+1],c===this.zi?(f=Math.max(f,this.UEa(this.ge,c)),l=a-f):c===this.zi+1&&(l=Math.max(l,this.UEa(this.ge,c)),f=a-l),this.Rs.p1a(this.ge,this.zi,f),this.Rs.p1a(this.ge,this.zi+1,l)):(c>this.A5&&Math.abs(f)<this.UEa(this.ge,c)?(xa.a.J(512497181,815,50,"DragAcrossColumn: scenario-2, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",
this.zi.toString(),c.toString(),f.toString(),l.toString()),this.Chb(c,this.zi+1)):c<this.B5&&Math.abs(l)<this.UEa(this.ge,c+1)?(xa.a.J(512497180,815,50,"DragAcrossColumn: scenario-3, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",this.zi.toString(),c.toString(),f.toString(),l.toString()),this.Chb(c+1,this.zi+1)):(xa.a.J(512497179,815,50,"DragAcrossColumn: scenario-4, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",
this.zi.toString(),c.toString(),f.toString(),l.toString()),this.Vzl(c,f,l)),this.Rs.mVe(this.ge),a=ob.GraphIterator.pb(this.ge),this.Rs.T8e(a),this.ge.oea(511),this.JA.$$b(this.ge))}else this.Rs.p1a(this.ge,this.zi,a),this.Rs.p1a(this.ge,this.zi+1,b[this.zi]+b[this.zi+1]-a)}Xfj(a,b,c,f,l){if(!a)return c=this.zi,f=b[this.zi],{kVf:c,CUf:f,DUf:0};f=0;if(0<a){for(c=this.zi;f<=a;)c++,f+=b[c];l=f-a;f=b[c]-l}else{for(c=this.zi+1;f>a;)c--,f-=b[c];f=a-f;l=b[c]-f}return{kVf:c,CUf:f,DUf:l}}Chb(a,b){if(b!==a){var c=
this.Jdj(b-1);for(let f=this.Efa;f<=this.wgb;f++){const l=this.ge.ef(f,b),y=this.ge.ef(f,a);this.ZIe(c[f],l,y)}}}ZIe(a,b,c){if(c.isGhostCell){var f=b.rowSpan,l=a.colSpan+c.Ai-b.Ai,y=a.colSpan+b.colSpan-l;Fm.c(Object(qa.a)(pg.a,b),Object(qa.a)(pg.a,c),this.Rs.fYd);Fm.c(Object(qa.a)(pg.a,b),Object(qa.a)(pg.a,c),[zb.a.WKa]);var H=ob.GraphIterator.pb(c);H.kf();var Q=new ob.GraphIterator;Q.set(Object(qa.a)(pg.a,b));Q.Cb(1)&&Fm.h(H,null,1,1,Q,-1);c.isGhostCell=b.isGhostCell;this.P7d(H);b.vo(zb.a.rowSpan,
zb.a.colSpan);b.isGhostCell=!0;c.isGhostCell||(c.colSpan=y,c.rowSpan=f);a.rowIndex===c.rowIndex&&(a.colSpan=l)}}P7d(a){const b=a.currentNode.eb(zb.a.rowId),c=a.currentNode.eb(zb.a.cellId);for(a=tk.a.xv(a);a.moveNext();){const f=a.currentNode.sa(zb.a.cellId,null);a.currentNode.sa(zb.a.rowId,null)&&a.currentNode.setValue(zb.a.rowId,b);f&&a.currentNode.setValue(zb.a.cellId,c)}}Vzl(a,b,c){var f=ob.GraphIterator.pb(this.ge);Sd.moveToFirstRow(f);f.gq(a,1);this.Rs.yie(f);if(f=this.ge.sa(ab.a.ev,null))f=
Yb.a.clone(f),b<this.UEa(this.ge,a)?(b=this.UEa(this.ge,a),c=f[a]-b):(c=Math.max(c,this.UEa(this.ge,a+1)),b=f[a]-c),f[a]=b,f[a+1]=c,this.ge.setValue(ab.a.ev,f);b=this.zi+1;a+=1;a<=b&&(b+=1);this.Chb(a,b)}Jdj(a){const b=Array(this.zc.Gk(this.ge));for(let c=this.Efa;c<=this.wgb;c++){const f=this.ge.ef(c,a);b[c]=f.mz()}return b}Q0e(){return!!this.ge&&this.ge.Op()&&!this.cca&&this.zi<this.IG-1}}Object(m.a)(IL,"PowerPointColumnDragAdapter",CL.a,[]);class RD{constructor(a,b){this.Sx=this.N5=null;this.jic=
this.Lfb=0;this.BGb=!1;this.v$=a;this.v0=b}Mv(a){if(3===a.ng)return!1;a=a.Bc;return Ll.nWa(a)||Ll.wcc(a)}Au(){if(this.BGb){const a=new pf.GraphTransaction(3);a.ld(this.N5.gb);this.N5.source.Kv(4,!0);a.dispose()}this.end()}end(){this.v$.mS()}dispose(){this.N5=null}}Object(m.a)(RD,"CommonRowHandleDragAdapter",null,[274,107]);class JL extends RD{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec){super(a,b);this.UAe=this.GEb=!1;this.ANg=this.bIa=0;this.fna=this.ge=this.Yd=this.Rwa=this.ENg=this.CNg=this.yNg=
this.BNg=this.zNg=null;this.KNg=this.We=this.rXg=this.qXg=this.z5=this.y5=this.HIa=this.U0=this.FA=0;this.caa=f;this.Uq=c;this.gl=l;this.ffb=y;this.Rs=H;this.zc=Q;this.pa=ia;this.JA=wa;this.irk=Ua;this.ia=Gb;this.Up=ec;this.sZa=null;this.Zgc=this.I9c=this.s9c=!1;this.rr=kb}Yu(a){if(!this.Mv(a))return!1;const b=a.Bc;if(Ll.wcc(b)){xa.a.J(512497178,816,50,"drag from table row handle");this.BGb=!1;var c=Ll.nuj(b);if(!c)return!1;this.ge=rf.a(c).gb;this.Sx=this.ge.qc(this.We);if(!this.Sx)return xa.a.J(512497177,
816,10,"OnDragStart : m_tableViewElement is null"),!1;this.KNg=this.rr.tbe(this.Sx,a.clientPoint);this.v0.wld(b);return!0}this.N5=Ll.Xpj(b);if(!this.N5)return!1;c=Object(qa.a)(155,this.N5.gb);this.We=this.N5.Na;this.ge=c?c.getContainingTable():null;if(!this.ge)return!1;this.Sx=this.ge.qc(this.We);this.sZa=this.irk.Zae(this.ge);if(!this.Sx||!this.sZa)return!1;this.GEb=Ll.Ane(b);this.UAe=Ll.moe(b);this.Lfb=this.N5.htmlElement.offsetHeight;this.jic=this.bIa=a.clientPoint.y;this.v0.Al(21);this.v$.endEditing(!0,
14);this.Yd=this.Sx.Ok;this.I9c=this.s9c=this.Zgc=!1;this.BGb=!0;this.R0e()&&this.eqj(b);this.vXd(b);this.Up&&this.ia.processAction(C.a.Bka,2);return!0}Rw(a){this.BGb?(this.bIa=a.clientPoint.y,a=(this.xHf(this.bIa)-this.Lfb)*(this.GEb?-1:1)+this.ANg,this.Rwa.style.top=a+"px"):(a=this.rr.tbe(this.Sx,a.clientPoint),this.Sx.Tuh(this.KNg,a));return!0}to(a){let b=null;a&&(b=this.caa.Ii("UserAction","PPTRowResize"),xa.a.J(512497175,822,50,String.format("Start Row resize for table: {0}, IsComplex: {1}",
this.Sx.gb.sa(zb.a.ZHb,""),this.Sx.gb.Op())));if(this.BGb){var c=this.xHf(a?a.clientPoint.y:this.bIa),f=new pf.GraphTransaction(15);if(this.R0e()&&this.Zgc&&this.I9c)pb.a.mark(11077),f.ld(this.ge),this.O_e(c);else{this.N5.cOb(c);var l=this.N5.htmlElement.offsetHeight;pb.a.mark(11077);var y=this.N5.gb;f.ld(y);c=this.v$.Md;y.setValue(zb.a.Fu,c.gf(l,1));this.GEb&&l!==this.Lfb&&(l=this.Lfb-l)&&(this.Yd.setPosition(this.Yd.x,this.Yd.y+l,!0),l=c.gf(this.Yd.x,0),c=c.gf(this.Yd.y,1),y=this.Sx.Ok.shapeNode,
y.Iy=l,y.Jy=c)}this.lwc();f.dispose();Rc.App.Lb.updateCommandUI();pb.a.mark(11078);this.end();this.ge?this.Rs.q0a(this.ge):xa.a.J(512497174,822,15," OnDragEnd: m_tableNode is null. Unable to Redraw Diagonal borders.");b&&b.stop();a&&xa.a.J(512497173,822,50,String.format("End Row resize for table: {0}, IsComplex: {1}",this.Sx.gb.sa(zb.a.ZHb,""),this.Sx.gb.Op()))}else a&&Rc.App.Lb.C6(a.clientPoint,a.ng),this.v0.D1()}Au(a){a.t7e?(super.Au(a),this.BGb&&this.lwc()):this.to(null)}end(){this.v0.D1();super.end()}xHf(a){a=
this.Lfb+this.Uq.om(a-this.jic)*(this.GEb?-1:1);if(this.R0e()&&this.Zgc&&this.I9c)a=Math.min(a,this.Lfb+this.rXg),a=Math.max(a,this.Lfb-this.qXg);else{var b=this.gl.ELc(this.N5.gb);b=this.N5.Nd.Md.Ne(b,1);a=Math.max(b,a)}return a}vXd(a){this.Rwa=a;Sys.UI.DomElement.addCssClass(this.Rwa,"ShowDashedLine");this.ANg=a.offsetTop;this.ENg=a.style.marginTop;this.CNg=a.style.width;this.zNg=a.style.left;this.BNg=a.style.top;this.yNg=a.style.bottom;a.style.marginTop="auto";a.style.width="auto";a.style.right=
a.style.left="0";a.style.bottom="auto";if(this.ffb){const b=fn.a.K8b(a);b&&(a.style.left=-b.offsetLeft+"px",a.style.right=-(this.N5.getBounds().width-b.offsetLeft-b.offsetWidth)+"px")}}lwc(){Sys.UI.DomElement.removeCssClass(this.Rwa,"ShowDashedLine");this.Rwa.style.marginTop=this.ENg;this.Rwa.style.width=this.CNg;this.Rwa.style.left=this.zNg;this.Rwa.style.right="auto";this.Rwa.style.top=this.BNg;this.Rwa.style.bottom=this.yNg}eqj(a){this.Zgc=this.s9c=!1;if(this.ge&&Ll.nWa(a)){var b=null,c=null;({h7a:b,
X7a:c}=this.dqj(a,b,c)).returnValue&&this.Idj(b,c)&&this.rce()&&(a=this.zc.Gi(this.ge),b=this.zc.Gk(this.ge),0<=this.U0&&this.U0<a&&0<=this.HIa&&this.HIa<a&&0<=this.y5&&this.y5<b&&0<=this.z5&&this.z5<b&&(this.Zgc=!0),this.I9c=0<this.U0||this.HIa<a-1?!0:!1)}}dqj(a,b,c){if(!Ll.nWa(a)||!this.ge)return{returnValue:!1,h7a:b,X7a:c};a=fn.a.K8b(a);a=rf.a(a);this.fna=Object(qa.a)(Vl.TableCellNode,a.gb);if(!this.fna)return{returnValue:!1,h7a:b,X7a:c};a=this.FA=this.fna.rowIndex-1;if(0>a||a>=this.zc.Gk(this.ge))return{returnValue:!1,
h7a:b,X7a:c};const f=this.fna.Ai;if(0>f||f>=this.zc.Gi(this.ge))return{returnValue:!1,h7a:b,X7a:c};if(this.GEb)return{returnValue:!1,h7a:null,X7a:c};b=this.ge.ef(a,f);if(this.UAe)return{returnValue:!1,h7a:b,X7a:null};c=this.ge.ef(a+1,f);return{returnValue:!0,h7a:b,X7a:c}}Idj(a,b){if(!this.ge||!a||!b)return!1;this.U0=a.Ai;if(0>this.U0||this.U0>=this.zc.Gi(this.ge))return!1;this.HIa=this.U0;var c=a.mz();this.y5=c?c.rowIndex:-1;if(0>this.y5||this.y5>=this.zc.Gk(this.ge))return!1;this.z5=this.Fae(b);
if(0>this.z5||this.z5>=this.zc.Gk(this.ge))return!1;a=(c=this.Xjj(a,b))?this.Npj(a,b):!1;if(a=c&&a)this.s9c=this.IVj(b.rowIndex);return a}rce(){if(!this.ge)return!1;const a=this.zc.Gk(this.ge);if(0>this.y5||this.y5>=a||0>this.z5||this.z5>=a)return!1;this.qXg=this.qae(this.ge,this.y5,this.FA)-this.bUa(this.ge,this.y5);this.rXg=this.qae(this.ge,this.z5,this.FA+1)-this.bUa(this.ge,this.z5);return!0}Xjj(a,b){if(!a||!b)return!1;a=a.L$a();const c=b.rowIndex;for(b=b.L$a();b&&a;){var f=b.mz();if(b.isGhostCell&&
f&&f.rowIndex!==c)break;this.U0--;if(f=a.mz())this.y5=Math.max(this.y5,f.rowIndex);this.z5=Math.min(this.z5,this.Fae(b));a=a.L$a();b=b.L$a()}return!0}Npj(a,b){if(!a||!b)return!1;a=a.D_();const c=b.rowIndex;for(b=b.D_();b&&(!b.isGhostCell||b.mz().rowIndex===c);)this.HIa++,this.y5=Math.max(this.y5,a.mz().rowIndex),this.z5=Math.min(this.z5,this.Fae(b)),a=a.D_(),b=b.D_();return!0}IVj(a){let b=!0,c;if(0<this.U0)for((c=this.ge.ef(a,this.U0))&&(c=c.L$a());c;){if(!c.isGhostCell){b=!1;break}c=c.L$a()}if(this.HIa<
this.ge.v3-1)for((c=this.ge.ef(a,this.HIa))&&(c=c.D_());c;){if(!c.isGhostCell){b=!1;break}c=c.D_()}return b}Fae(a){if(!a)return-1;let b=a;a.isGhostCell&&(b=a.mz());return b&&(b=b.Eae(1))?b.rowIndex:-1}qae(a,b,c){if(b>c)return this.qae(a,c,b);if(!a||0>b||b>=this.zc.Gk(a)||0>c||c>=this.zc.Gk(a))return-1;for(a=0;b<=c;b++)a+=this.sZa[b];return Math.floor(a)}bUa(a,b){a=this.gl.AXd(a,b);return Math.floor(this.v$.Md.Ne(a,1))}O_e(a){if(!this.pa.rH()){var b=this.fna.i7b().mz().m6b;b=Od.SelectionFactory.Qg(Object(qa.a)(pg.a,
b),0);this.pa.setSelection(b)}let c=b=-1;var f=-1;({lVf:b,AUf:c,BUf:f}=this.Yfj(a-this.sZa[this.FA],this.sZa,b,c,f));if(this.s9c&&(b===this.FA&&Math.abs(c)>=this.bUa(this.ge,this.FA)||b===this.FA+1&&b<this.zc.Gk(this.ge)&&Math.abs(f)>=this.bUa(this.ge,this.FA+1)||b===this.FA+1&&b===this.zc.Gk(this.ge)-1)){xa.a.J(512497172,815,50,"DragAcrossRow: scenario-1, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.FA.toString(),b.toString(),c.toString(),
f.toString());f=ob.GraphIterator.pb(this.ge);this.Nlc(f,this.FA);a=f.currentNode;var l=this.sZa[this.FA];const H=a.qc(this.We);Sd.moveToNextRow(f);f=f.currentNode;var y=this.sZa[this.FA+1];const Q=f.qc(this.We);y=l+y;l=this.v$.Md;b===this.FA+1&&(c+=this.sZa[this.FA]);H.cOb(Math.floor(c));b=H.htmlElement.offsetHeight;a.setValue(zb.a.Fu,l.gf(b,1));b=y-b;b=Math.max(b,this.bUa(this.ge,this.FA+1));Q.cOb(Math.floor(b));f.setValue(zb.a.Fu,l.gf(Q.htmlElement.offsetHeight,1))}else b>this.y5&&Math.abs(c)<this.bUa(this.ge,
b)?(xa.a.J(512497171,815,50,"DragAcrossRow: scenario-2, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.FA.toString(),b.toString(),c.toString(),f.toString()),this.Chb(b,this.FA+1)):b<this.z5&&Math.abs(f)<this.bUa(this.ge,b+1)?(xa.a.J(512497170,815,50,"DragAcrossRow: scenario-3, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.FA.toString(),b.toString(),c.toString(),f.toString()),
this.Chb(b+1,this.FA+1)):(xa.a.J(512497169,815,50,"DragAcrossRow: scenario-4, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.FA.toString(),b.toString(),c.toString(),f.toString()),this.Wzl(b,c,f)),this.Rs.mVe(this.ge),b=ob.GraphIterator.pb(this.ge),this.Rs.T8e(b),this.ge.oea(511),this.JA.$$b(this.ge)}Yfj(a,b,c,f,l){if(!a)return c=this.FA,f=b[this.FA],{lVf:c,AUf:f,BUf:0};f=0;if(0<a){for(c=this.FA;f<a;)c++,f+=b[c];l=f-a;f=b[c]-l}else{for(c=
this.FA+1;f>a;)c--,f-=b[c];f=a-f;l=b[c]-f}return{lVf:c,AUf:f,BUf:l}}Chb(a,b){if(b!==a){var c=this.Kdj(b-1);b=this.ge.ef(b,this.U0);a=this.ge.ef(a,this.U0);for(let f=this.U0;f<=this.HIa;f++)this.ZIe(c[f],b,a),b=b.D_(),a=a.D_()}}ZIe(a,b,c){if(c.isGhostCell){var f=b.colSpan,l=a.rowSpan+c.rowIndex-b.rowIndex,y=a.rowSpan+b.rowSpan-l;Fm.c(Object(qa.a)(pg.a,b),Object(qa.a)(pg.a,c),this.Rs.fYd);Fm.c(Object(qa.a)(pg.a,b),Object(qa.a)(pg.a,c),[zb.a.WKa]);var H=ob.GraphIterator.pb(c);H.kf();var Q=new ob.GraphIterator;
Q.set(Object(qa.a)(pg.a,b));Q.Cb(1)&&Fm.h(H,null,1,1,Q,-1);c.isGhostCell=b.isGhostCell;this.P7d(H);b.vo(zb.a.rowSpan,zb.a.colSpan);b.isGhostCell=!0;c.isGhostCell||(c.colSpan=f,c.rowSpan=y);a.Ai===H.Cq.Ai&&(a.rowSpan=l)}}P7d(a){const b=a.currentNode.eb(zb.a.rowId),c=a.currentNode.eb(zb.a.cellId);for(a=tk.a.xv(a);a.moveNext();){const f=a.currentNode.sa(zb.a.cellId,null);a.currentNode.sa(zb.a.rowId,null)&&a.currentNode.setValue(zb.a.rowId,b);f&&a.currentNode.setValue(zb.a.cellId,c)}}Wzl(a,b,c){var f=
ob.GraphIterator.pb(this.ge);this.Nlc(f,a);const l=f.currentNode;f=this.Rs.zie(f);const y=this.v$.Md,H=l.qc(this.We);H.cOb(Math.floor(b));l.setValue(zb.a.Fu,y.gf(H.htmlElement.offsetHeight,1));c=Math.max(c,this.bUa(this.ge,a+1));f.setValue(zb.a.Fu,y.gf(Math.floor(c),1));b=this.FA+1;a+=1;a<=b&&(b+=1);this.Chb(a,b)}Nlc(a,b){if(!(14!==a.Bi||0>b||b>=this.zc.Gk(a.currentNode)))for(Sd.moveToFirstRow(a);0<b--;)Sd.moveToNextRow(a)}Kdj(a){a=this.ge.ef(a,this.U0);const b=Array(this.zc.Gi(this.ge));for(let c=
this.U0;c<=this.HIa;c++)b[c]=a.mz(),a=a.D_();return b}R0e(){return!!this.ge&&this.ge.Op()&&!this.GEb&&!this.UAe}}Object(m.a)(JL,"PowerpointRowHandleDragAdapter",RD,[]);class SD{constructor(a,b,c,f){this.JA=f;this.yHa=a;this.yHa.fk(Object(I.a)(this,this.$g,"onPropertyChanged"))}$g(a,b){a=b.property;(b=Object(qa.a)(130,b.node))&&(a===zb.a.colSpan||a===zb.a.rowSpan)&&(b=b.getContainingTable())&&(this.JA.wuk(b),b.eZ=null)}dispose(){this.yHa.Om(Object(I.a)(this,this.$g,"onPropertyChanged"))}}Object(m.a)(SD,
"TableCellNodeBehavior",null,[107]);class KL extends Xb.a{constructor(a,b){super(a,b,"TableCellSelected")}Q2g(a){this.selected&&!Sys.UI.DomElement.containsCssClass(a,this.e1a)?Sys.UI.DomElement.addCssClass(a,this.e1a):!this.selected&&Sys.UI.DomElement.containsCssClass(a,this.e1a)&&Sys.UI.DomElement.removeCssClass(a,this.e1a)}}Object(m.a)(KL,"TableCellSelectionBehavior",Xb.a,[1152,1024]);class LL extends Sys.EventArgs{constructor(a){super();this.B8h=a}get tableCellNode(){return this.ODl.tableCellNode}get ODl(){return this.B8h}}
Object(m.a)(LL,"TableCellViewElementLockedEventArgs",Sys.EventArgs,[]);class TD extends Sys.EventArgs{constructor(a){super();this.EQi=a}}Object(m.a)(TD,"TypingLockStatusChangedEventArgs",Sys.EventArgs,[]);var dq=d(192);class st extends Qv{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc){super(a,b,f,l,Ib.a.instance.resolve("Box4.ITableCellReader"),Ib.a.instance.resolve("Box4.IParagraphReader"),Ib.a.instance.resolve("Box4.IOutlineElementNavigator"),Ib.a.instance.resolve("Box4.ITableNavigator"),Ib.a.instance.resolve("Box4.IOutlineElementReader"),
Ib.a.instance.resolve("Box4.Styles.IStyleReader"),Ib.a.instance.qb("Box4.IFeatureHelper"),new KL(a,b),Ib.a.instance.qb("Box4.Styles.ITableCellspacingReader"),Ib.a.instance.resolve("Box4.TableCellViewElementSettings"));this.uCe=this.vCe=this.ped=this.wed=this.nHb=this.Ih=this.$gb=this.DO=this.MO=this.W0=null;this.Uma=!1;this.xma=null;this.rj=Object(qa.a)(130,b);this.Ga=c;this.JA=y;this.gl=H;this.Ic=Q;this.aHa=ia;this.zc=wa;this.ffb=Ua;this.UEb=kb;this.I0=Gb;this.E$c=ec;this.Lgc=eb.a("PPTOEnableTableDiagonalBorders");
this.pa=dc;this.Kva=this.B5f();(this.ffb||this.UEb)&&Sys.UI.DomElement.addCssClass(this.htmlElement,"TableCellRelativePosition")}c7(){}Yy(a){super.Yy(a);this.ffb&&!this.Nd.hm&&this.Fjl()}GEa(a,b){return a&&a.length&&"none"!==a&&b&&b.length&&b.endsWith("px")?parseFloat(b.substr(0,b.length-2)):0}zqg(){const a=this.pa.eaj(),b=this.rj.getContainingTable();return b?Array.contains(a,b):!1}g2k(a){switch(a){case "Top":this.Ih.style.top="-0.5px";this.Ih.style.borderTopWidth="1px";break;case "Right":this.Ih.style.right=
"-0.5px";this.Ih.style.borderRightWidth="1px";break;case "Bottom":this.Ih.style.bottom="-0.5px";this.Ih.style.borderBottomWidth="1px";break;case "Left":this.Ih.style.left="-0.5px",this.Ih.style.borderLeftWidth="1px"}}f2k(a){switch(a){case "Top":this.Ih.style.top="0px";this.Ih.style.borderTopWidth="0px";break;case "Right":this.Ih.style.right="0px";this.Ih.style.borderRightWidth="0px";break;case "Bottom":this.Ih.style.bottom="0px";this.Ih.style.borderBottomWidth="0px";break;case "Left":this.Ih.style.left=
"0px",this.Ih.style.borderLeftWidth="0px"}}xod(a){this.Ih&&(this.zqg()?this.g2k(a):this.f2k(a))}Djl(a,b,c){const f=!eb.a("TableBorderOutsideBorderHalfClippingDisabled");this.G5d();var l=ob.GraphIterator.pb(this.gb);l.sc(14);var y=l.Kg(14);l=this.zc.Gk(y);y=this.zc.Gi(y);c=c?c.yV():"";switch(a){case "Top":b=this.Nd.Md.Ne(b,1);!this.rj.rowIndex&&f?(this.Ih.style.top="0px",this.Ih.style.borderTopWidth=b/2+"px"):(this.Ih.style.top=-b/2+"px",this.Ih.style.borderTopWidth=b+"px");this.Ih.style.borderTopColor=
c;break;case "Bottom":b=this.Nd.Md.Ne(b,1);this.rj.rowIndex+this.rj.rowSpan===l&&f?(this.Ih.style.bottom="0px",this.Ih.style.borderBottomWidth=b/2+"px"):(this.Ih.style.bottom=-b/2+"px",this.Ih.style.borderBottomWidth=b+"px");this.Ih.style.borderBottomColor=c;break;case "Left":b=this.Nd.Md.Ne(b,0);!this.rj.Ai&&f?(this.Ih.style.left="0px",this.Ih.style.borderLeftWidth=b/2+"px"):(this.Ih.style.left=-b/2+"px",this.Ih.style.borderLeftWidth=b+"px");this.Ih.style.borderLeftColor=c;break;case "Right":b=this.Nd.Md.Ne(b,
0);this.rj.Ai+this.rj.colSpan===y&&f?(this.Ih.style.right="0px",this.Ih.style.borderRightWidth=b/2+"px"):(this.Ih.style.right=-b/2+"px",this.Ih.style.borderRightWidth=b+"px");this.Ih.style.borderRightColor=c;break;case "DiagonalUp":this.Lgc&&(b=this.Nd.Md.Ne(b,0),this.vVf(a,b,c));break;case "DiagonalDown":this.Lgc&&(b=this.Nd.Md.Ne(b,0),this.uVf(a,b,c))}this.Qyh()}vVf(a,b,c){this.sXf();this.vCe||(this.vCe=this.POf());this.swh(this.vCe,a,b,c)}uVf(a,b,c){this.sXf();this.uCe||(this.uCe=this.POf());this.swh(this.uCe,
a,b,c)}POf(){const a=new cm.a;this.wed.appendChild(a.va);this.ap(a.va);return a}swh(a,b,c,f){b=this.xKi(b);a.QY(b);a.dv(f);a.ur(c)}xKi(a){switch(a){case "DiagonalUp":return String.format("M 0 {0} L {1} 0",this.L9d(),this.N9d());case "DiagonalDown":return String.format("M 0 0 L {0} {1}",this.N9d(),this.L9d())}xa.a.J(571479943,822,10,"CreateDAttrib : Unknown borderType "+a);return null}sXf(){this.G5d();this.nHb||(this.nHb=this.Nd.lp(Ca.a.div),this.nHb.className="PPTTableDiagonalBorder",this.$gb.appendChild(this.nHb),
this.ap(this.nHb));this.ped||(this.ped=new nn.a,this.wed=this.ped.va,this.nHb.appendChild(this.wed),this.ap(this.wed));this.ped.xpa(String.format("0 0 {0} {1}",this.N9d(),this.L9d()))}G5d(){this.$gb||(this.$gb=this.Nd.lp(Ca.a.div),this.$gb.className="PPTTableBorderContainer",this.htmlElement.insertBefore(this.$gb,this.htmlElement.firstChild),this.ap(this.$gb));this.Ih||(this.Ih=this.Nd.lp(Ca.a.div),this.Ih.className="PPTTableBorder",this.$gb.appendChild(this.Ih),this.ap(this.Ih))}Qyh(){this.E$c&&
eb.a("MergeDifferentBordersFixEnabled")?this.Ih.style.zIndex=this.WBb(this.rj)?"1":(this.BVa(this.rj.Kza)||this.BVa(this.rj.bha))&&(this.BVa(this.rj.Jza)||this.BVa(this.rj.cha))?"3":"2":this.Ih.style.zIndex=(this.BVa(this.rj.Kza)||this.BVa(this.rj.bha))&&(this.BVa(this.rj.Jza)||this.BVa(this.rj.cha))?"1":"0"}WBb(a){return 1<a.rowSpan||1<a.colSpan}vVj(a){return"DiagonalUp"===a||"DiagonalDown"===a}FLa(a,b,c,f){const l=this.E$c&&eb.a("MergeDifferentBordersFixEnabled")&&this.WBb(this.rj);this.E$c&&!this.vVj(a)&&
this.zqg()&&0===b&&(b=1,c="rgb(255, 255, 255)");switch(a){case "Top":l&&!this.GSj()&&(b=0);this.Ih.style.borderTopWidth=b+"px";this.Ih.style.borderTopColor=c;this.Ih.style.borderTopStyle=f;this.Ih.style.top=-b/2+"px";break;case "Right":l&&!this.FSj()&&(b=0);this.Ih.style.borderRightWidth=b+"px";this.Ih.style.borderRightColor=c;this.Ih.style.borderRightStyle=f;this.Ih.style.right=-b/2+"px";break;case "Bottom":l&&!this.zSj()&&(b=0);this.Ih.style.borderBottomWidth=b+"px";this.Ih.style.borderBottomColor=
c;this.Ih.style.borderBottomStyle=f;this.Ih.style.bottom=-b/2+"px";break;case "Left":l&&!this.BSj()&&(b=0);this.Ih.style.borderLeftWidth=b+"px";this.Ih.style.borderLeftColor=c;this.Ih.style.borderLeftStyle=f;this.Ih.style.left=-b/2+"px";break;case "DiagonalUp":this.Lgc&&this.vVf(a,b,c);break;case "DiagonalDown":this.Lgc&&this.uVf(a,b,c)}}N9d(){var a=0;for(let b=0;b<this.rj.colSpan;b++)a+=this.rj.getContainingTable().U9d[this.rj.Ai+b];a=this.Nd.Md.Ne(a,0);return Math.round(100*a)/100}L9d(){var a=this.zc.RWc(this.rj.getContainingTable(),
this.rj.rowIndex,this.rj.rowIndex+this.rj.rowSpan-1);let b=0;for(let c of a)Object(Wa.a)(155,c)?b+=c.sa(zb.a.Fu,0):xa.a.J(571479944,822,15,String.format("GetCellHeight : node {0} is not of the type ITableRowNode",c));this.rj.marginTop+this.rj.marginBottom>b&&xa.a.J(559724693,822,15,String.format("GetCellHeight :: degenerate case : cell height : {0} is less than sum of margins top : {1}  and bottom : {2} ",b,this.rj.marginTop,this.rj.marginBottom));b=Math.max(b,this.rj.marginTop+this.rj.marginBottom);
a=this.Nd.Md.Ne(b,1);return Math.round(100*a)/100}GSj(){if(!this.rj.rowIndex)return!0;const a=this.rj.getContainingTable();if(!a)return!0;const b=this.rj.rowIndex-1;var c=this.rj.Ai;const f=c+this.rj.colSpan-1;for(;c<=f;c++){const l=a.ef(b,c);if(l&&(l.isGhostCell||this.WBb(l)))return!0}return!1}BSj(){if(!this.rj.Ai)return!0;const a=this.rj.getContainingTable();if(!a)return!0;const b=this.rj.Ai-1;var c=this.rj.rowIndex;const f=c+this.rj.rowSpan-1;for(;c<=f;c++){const l=a.ef(c,b);if(l&&(l.isGhostCell||
this.WBb(l)))return!0}return!1}FSj(){const a=this.rj.getContainingTable();if(!a||this.rj.Ai+this.rj.colSpan===this.zc.Gi(a))return!0;const b=this.rj.Ai+this.rj.colSpan;var c=this.rj.rowIndex;const f=c+this.rj.rowSpan-1;for(;c<=f;c++){const l=a.ef(c,b);if(l&&(l.isGhostCell||this.WBb(l)))return!0}return!1}zSj(){const a=this.rj.getContainingTable();if(!a||this.rj.rowIndex+this.rj.rowSpan===this.zc.Gk(a))return!0;const b=this.rj.rowIndex+this.rj.rowSpan;var c=this.rj.Ai;const f=c+this.rj.colSpan-1;for(;c<=
f;c++){const l=a.ef(b,c);if(l&&(l.isGhostCell||this.WBb(l)))return!0}return!1}Fjl(){var a=!eb.a("TableBorderOutsideBorderHalfClippingDisabled");this.G5d();if(a){a=ob.GraphIterator.pb(this.gb);a.sc(14);var b=a.Kg(14);a=this.zc.Gk(b);b=this.zc.Gi(b);var c=this.GEa(this.htmlElement.style.borderLeft,this.htmlElement.style.borderLeftWidth);this.FLa("Left",c,this.htmlElement.style.borderLeftColor,this.htmlElement.style.borderLeftStyle);this.rj.Ai?this.Ih.style.left=-c/2+"px":(this.Ih.style.left="0px",this.Ih.style.borderLeftWidth=
c/2+"px");c=this.GEa(this.htmlElement.style.borderRight,this.htmlElement.style.borderRightWidth);this.FLa("Right",c,this.htmlElement.style.borderRightColor,this.htmlElement.style.borderRightStyle);this.rj.Ai+this.rj.colSpan===b?(this.Ih.style.right="0px",this.Ih.style.borderRightWidth=c/2+"px"):this.Ih.style.right=-c/2+"px";b=this.GEa(this.htmlElement.style.borderTop,this.htmlElement.style.borderTopWidth);this.FLa("Top",b,this.htmlElement.style.borderTopColor,this.htmlElement.style.borderTopStyle);
this.rj.rowIndex?this.Ih.style.top=-b/2+"px":(this.Ih.style.top="0px",this.Ih.style.borderTopWidth=b/2+"px");b=this.GEa(this.htmlElement.style.borderBottom,this.htmlElement.style.borderBottomWidth);this.FLa("Bottom",b,this.htmlElement.style.borderBottomColor,this.htmlElement.style.borderBottomStyle);this.rj.rowIndex+this.rj.rowSpan===a?(this.Ih.style.bottom="0px",this.Ih.style.borderBottomWidth=b/2+"px"):this.Ih.style.bottom=-b/2+"px"}else a=this.GEa(this.htmlElement.style.borderLeft,this.htmlElement.style.borderLeftWidth),
this.FLa("Left",a,this.htmlElement.style.borderLeftColor,this.htmlElement.style.borderLeftStyle),a=this.GEa(this.htmlElement.style.borderRight,this.htmlElement.style.borderRightWidth),this.FLa("Right",a,this.htmlElement.style.borderRightColor,this.htmlElement.style.borderRightStyle),a=this.GEa(this.htmlElement.style.borderTop,this.htmlElement.style.borderTopWidth),this.FLa("Top",a,this.htmlElement.style.borderTopColor,this.htmlElement.style.borderTopStyle),a=this.GEa(this.htmlElement.style.borderBottom,
this.htmlElement.style.borderBottomWidth),this.FLa("Bottom",a,this.htmlElement.style.borderBottomColor,this.htmlElement.style.borderBottomStyle);this.tVf();this.E$c&&this.Qyh();this.htmlElement.style.border=""}tVf(){this.Lgc&&(this.Nve&&this.rwh("DiagonalUp",this.Nve),this.Mve&&this.rwh("DiagonalDown",this.Mve))}BVa(a){return!!a}rwh(a,b){const c=b.split(" ");if(3!==c.length)xa.a.J(570832849,822,10,String.format("SetDiagonalBorderProps : split of string [ {0} ] has greater or less than 3 sub-parts",
b));else{var f=c[0];b=this.GEa(b,c[1]);this.FLa(a,b,c[2],f)}}Zwc(a,b,c,f,l,y,H){if(!this.I0||this.Ga.vn(this.rj).eb(zb.a.isResizable))this.UEb?this.RPl(l,y,H):this.QPl(a,b,c,f,l,y,H)}RPl(a,b,c){this.cHa||(this.cHa=this.iOc(),this.ap(this.cHa));this.W0||(this.W0=this.bSa(),this.ap(this.W0));a?Sys.UI.DomElement.addCssClass(this.W0,"First"):Sys.UI.DomElement.removeCssClass(this.W0,"First");b^!!this.MO&&(b?(this.MO=this.bSa(),this.ap(this.MO)):(this.ULb(this.MO),this.MO=null));this.MO&&Sys.UI.DomElement.addCssClass(this.MO,
"Last");c^!!this.DO&&(c?(this.DO=this.iOc(),this.ap(this.DO)):(this.ULb(this.DO),this.DO=null));this.DO&&Sys.UI.DomElement.addCssClass(this.DO,"FirstLeft")}QPl(a,b,c,f,l,y,H){super.Zwc(a,b,c,f,l,y,H);this.Zub&&this.ap(this.Zub);this.W0||(this.W0=this.bSa(),this.ap(this.W0));this.W0.style.left=a+"px";this.W0.style.top=b+"px";this.W0.style.width=c+"px";l?Sys.UI.DomElement.addCssClass(this.W0,"First"):Sys.UI.DomElement.removeCssClass(this.W0,"First");y^!!this.MO&&(y?(this.MO=this.bSa(),this.ap(this.MO)):
(this.ULb(this.MO),this.MO=null));this.MO&&(this.MO.style.bottom="0",this.MO.style.left=a+"px",this.MO.style.width=c+"px",Sys.UI.DomElement.addCssClass(this.MO,"Last"));H^!!this.DO&&(H?(this.DO=this.iOc(),this.ap(this.DO)):(this.ULb(this.DO),this.DO=null));this.DO&&(this.DO.style.left="0",this.DO.style.top=b+"px",this.DO.style.height=f+"px",Sys.UI.DomElement.addCssClass(this.DO,"FirstLeft"));this.ffb&&(this.W0.style.left="0",this.W0.style.top="0",this.Zub&&(this.Zub.style.left=c+"px",this.Zub.style.top=
"0",this.Zub.style.height=f+"px"),this.MO&&(this.MO.style.left="0"),this.DO&&(this.DO.style.top="0"))}fwh(){var a=this.Nd.Md,b=a.Ne(this.gl.Qta(this.gb,3),1);this.Nja.style.paddingTop=b+"px";b=a.Ne(this.gl.Qta(this.gb,0),1);this.Nja.style.paddingBottom=b+"px";b=a.Ne(this.gl.Qta(this.gb,1),0);this.Nja.style.paddingLeft=b+"px";a=a.Ne(this.gl.Qta(this.gb,2),0);this.Nja.style.paddingRight=a+"px"}Hjl(a,b){const c=this.Nd.Md;switch(b){case ea.a.gvc:a=c.P_(a.marginTop,1);this.Nja.style.paddingTop=a+"px";
break;case ea.a.avc:a=c.P_(a.marginBottom,1);this.Nja.style.paddingBottom=a+"px";break;case ea.a.bvc:a=c.P_(a.marginLeft,0);this.Nja.style.paddingLeft=a+"px";break;case ea.a.fvc:a=c.P_(a.marginRight,0),this.Nja.style.paddingRight=a+"px"}}$U(){var a=this.gl.Qta(this.gb,1),b=this.gl.Qta(this.gb,2);const c=this.gl.b7b(this.gb,5),f=this.gl.b7b(this.gb,6);var l=this.Nd.Md;a=l.Ne(a+c,0);b=l.Ne(b+f,0);l=l.Ne(this.gl.sHf(this.gb),0);return new Jj.a(a,l,b)}YMh(){this.htmlElement.style.background=this.JA.P4f(this.gb)}PU(){if(!this.Ih)super.PU();
else if(!this.Nd.hm&&this.EB){const a=Object(qa.a)(1152,this.aS);a&&a.Q2g(this.Ih)}}bSa(){const a=this.VPf();a.className="TableRowResizeHandle";return a}ULb(a){L.a.cLa(a);Ea.a.lP(a)}get tableCellNode(){return this.rj}get Q4c(){return this.xma}get Ok(){this.Kva||(this.Kva=this.B5f());return this.Kva}set Ok(a){this.Kva=a}get hq(){return this.Uma}iOb(a){this.Uma=a;this.tableCellNode.FAb=a}lock(a){this.hq&&this.xma===a||(this.Ok.yvd(),this.xma=a,this.iOb(!0),this.Ic.Py(new dq.a(7)),this.aHa.Xkh(new TD(a)),
this.aHa.PZk(new LL(this)))}unlock(){this.hq&&(this.xma=null,this.iOb(!1),this.Ic.Py(new dq.a(7)),this.aHa.Xkh(new TD(null)))}B5f(){let a=null;const b=this.Ga.vn(this.rj);b&&(a=Object(qa.a)(119,b.tg(this.Na)));return a}}Object(m.a)(st,"TableCellViewElement",Qv,[1128,1029,472,107]);var Pz=d(295),CR=d(511);class pm extends Rh{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua){super(a,b);Rh.z4a=()=>lr.jZf(Hg.a.create());this.gl=c;this.Yl=f;this.SJ=y;this.uZa=l;this.zc=H;this.M5=Q;this.rZa=ia;this.REb=wa;this.We=
Ua;this.H9c=eb.a("PPTOEnableTableDiagonalBorders")}oKf(a,b){Rh.NAi(a,b,cd.TableReader.Gi(a))}YPf(a,b,c,f=null,l=!1){const y=a.parentNode.eb(zb.a.shapeId);a.currentNode.setValue(zb.a.shapeId,y);for(var H=0;H<b;++H){var Q=new CR.a;a.Hl(Q,1);Q.setValue(zb.a.shapeId,y);Q.setValue(zb.a.rowId,Hg.a.create())}b=null;H=!0;a.Cb(1);do{Q=a.currentNode.eb(zb.a.rowId);for(let ia=0;ia<c;++ia){const wa=this.Psa();a.Hl(wa,1);wa.setValue(zb.a.shapeId,y);wa.setValue(zb.a.rowId,Q);wa.setValue(zb.a.cellId,Hg.a.create());
({Buh:b,isFirst:H}=this.C0f(a,wa,l,f,b,H));Sd.returnToContainingRow(a)}}while(a.Nj(1))}q0a(a){if(this.H9c&&a&&(a=this.zc.UF(a)))for(const b of a)b&&!b.isGhostCell&&(a=Object(qa.a)(st,b.qc(this.We)))&&a.tVf()}UWe(a,b,c,f,l){var y=this.SJ.BUc(a);for(var H=0;H<y.length;H++){const Q=this.gl.gub(a,H);y[H]=Math.max(Q,y[H]*b)}a.setValue(ab.a.ev,y);if(1!==c)for((new ob.GraphIterator).set(a),b=a?a.firstRow:null,c=0;b;){y=l.gf(f.Upj(c),1);H=this.gl.AXd(a,c);y<=H&&(y=0);b.setValue(zb.a.Fu,y);if(b.ppg())break;
else b=b.EJa;c++}this.q0a(a)}Cjl(a,b){a=this.zc.UF(a);for(let c=0;c<a.length;c++){const f=a[c].cellShading;f.anchorField=b;a[c].cellShading=f;a[c].Mpa=b}}Bjl(a,b){for(let f=0;f<a.length;f++){const l=a.ga(f);for(let y=0;y<l.length;y++){var c=l.ga(y).iterator;c.sc(16);c.Kg(16);c=c.Cq;const H=c.cellShading;H.anchorField=b;c.cellShading=H;c.Mpa=b}}}W$b(a,b,c,f,l){super.W$b(a,b,c,f,l);c=[];Array.add(c,zb.a.Fu);Fm.b(f,b,c);c=a.currentNode.eb(zb.a.shapeId);const y=a.Cq.eb(zb.a.sid);a=a.Cq.eb(zb.a.cid);const H=
lr.LNf(Hg.a.create());b.setValue(zb.a.sid,y);b.setValue(zb.a.cid,a);b.setValue(zb.a.shapeId,c);b.setValue(zb.a.rowId,H);this.$Pl(f,b,l)}L$b(a,b,c,f,l){super.L$b(a,b,c,f,l);return this.Thd(a.currentNode,b,c,f,!1,!1)}i_b(a,b,c,f,l){super.i_b(a,b,c,f,l);return this.Thd(a.currentNode,b,c,f,l,!1)}get fYd(){if(!pm.Vaa){pm.Vaa=[];let a,b,c;for(const f of pm.b6c)if(this.H9c||2!==f&&1!==f)({kRa:b,Y7a:a,Mtb:c}=cq.kUa(f)),Array.add(pm.Vaa,b),Array.add(pm.Vaa,a),Array.add(pm.Vaa,c);Array.add(pm.Vaa,ab.a.YE);
Array.add(pm.Vaa,zb.a.cellShading);Array.add(pm.Vaa,Ab.a.HPb);Array.add(pm.Vaa,Ab.a.JPb);Array.add(pm.Vaa,Ab.a.KPb);Array.add(pm.Vaa,Ab.a.GPb);Array.add(pm.Vaa,zb.a.xP)}return pm.Vaa}Thd(a,b,c,f,l,y){c=y?this.RBj(b,c,l):this.SBj(b,c,f,l);Fm.c(c,b,this.fYd);f=a.eb(zb.a.cid);y=a.eb(zb.a.shapeId);const H=c.eb(zb.a.cellId),Q=a.eb(zb.a.rowId);b.setValue(zb.a.sid,a.eb(zb.a.sid));b.setValue(zb.a.cid,f);b.setValue(zb.a.shapeId,y);b.setValue(zb.a.rowId,Q);l?b.setValue(zb.a.cellId,H):b.setValue(zb.a.cellId,
b.id.guid);return c}FAf(a,b,c,f,l,y){a=a.currentNode;const H=Array(c);let Q=0,ia=0,wa=0;for(;Q<f;Q++)H[Q]=b[Q],ia+=H[Q];for(l=l?b[f]:b[f-1];Q<f+y;Q++)H[Q]=l,wa+=H[Q];for(;Q<c;Q++)H[Q]=b[Q-y],ia+=H[Q];b=ia/(wa+ia);for(Q=0;Q<c;Q++)H[Q]=Math.max(H[Q]*b,this.gl.gub(a,Q));return H}Emc(a,b,c,f,l){super.Emc(a,b,c,f,l);var y=a.eb(zb.a.zmb);l=Array(y.length+f);let H=0;for(;H<b;H++)l[H]=y[H];for(;H<b+f;H++)l[H]=pm.EMi();for(;H<l.length;H++)l[H]=y[H-f];a.setValue(zb.a.zmb,l);y=c?l[b+f]:l[b-1];a=Object(qa.a)(Pz.TableNode,
a);this.sNl(a,y,l.slice(b,f+b),b,c);if(this.REb)for(l=this.rZa.create(a),f=b+f,y=(!c||!b)&&b<this.zc.Gi(a)-1,b+=c?1:0,f+=c?1:0,c=b;c<f;c++)this.M5.S7d(a,l,c,0,this.zc.Gk(a),y)}jMe(a,b,c,f){super.jMe(a,b,c,f);if(this.REb){a=Object(qa.a)(178,a);const l=this.rZa.create(a);f=c+f;const y=(!b||!c)&&c<this.zc.Gk(a)-1;c+=b?1:0;f+=b?1:0;for(b=c;b<f;b++)this.M5.Q7d(a,l,b,0,this.zc.Gi(a),y)}}CLe(a,b,c){super.CLe(a,b,c);this.ZQb(a,zb.a.complexTable);this.REb&&(a=Object(qa.a)(178,a.currentNode),c=this.rZa.create(a),
this.M5.Q7d(a,c,b,0,this.zc.Gi(a),!0))}BLe(a,b,c){super.BLe(a,b,c);const f=a.currentNode.eb(zb.a.zmb),l=Array(f.length-c);let y=0;for(;y<b;y++)l[y]=f[y];for(;y<l.length;y++)l[y]=f[y+c];a.currentNode.setValue(zb.a.zmb,l);this.ZQb(a,zb.a.complexTable);this.REb&&(a=Object(qa.a)(178,a.currentNode),c=this.rZa.create(a),this.M5.S7d(a,c,b,0,this.zc.Gk(a),!0))}$Pl(a,b,c){b.setValue(zb.a.K1k,a.eb(zb.a.rowId));b.setValue(zb.a.insertBefore,c)}sNl(a,b,c,f,l){a=a.firstRow;do for(let y=0;y<c.length;++y){const H=
ob.GraphIterator.pb(a),Q=H.gq(f+y,1);Q.setValue(zb.a.J1k,b);Q.setValue(zb.a.insertBefore,l);Q.setValue(zb.a.cellId,c[y]);pm.Ixh(H,zb.a.cellId,c[y])}while(a=a.EJa)}Psa(){const a=super.Psa();a.isGhostCell=!0;a.rowSpan=1;a.colSpan=1;return a}hLe(a,b){this.vAj(a,b,c=>{c.currentNode.isGhostCell=!1;Rh.ay.U$b(c,null,!0);const f=c.currentNode.eb(zb.a.rowId),l=c.currentNode.eb(zb.a.cellId);for(c=tk.a.xv(c);c.moveNext();){const y=c.currentNode.sa(zb.a.cellId,null);c.currentNode.sa(zb.a.rowId,null)&&c.currentNode.setValue(zb.a.rowId,
f);y&&c.currentNode.setValue(zb.a.cellId,l)}})}Pod(a){cd.TableReader.wt(a.currentNode)&&this.vnh(a,b=>b.Rh(zb.a.Fu),(b,c)=>{b.ye(zb.a.Fu,c)},zb.a.complexTable)}mVe(a){a&&(a=ob.GraphIterator.pb(a),this.Pod(a,0))}tpa(a,b){if(a)for(a=this.Yl.Msa(a),a.qm(c=>15===c.Bi,null);a.moveNext();){const c=Object(qa.a)(155,a.iterator.currentNode),f=this.uZa.aab(c);c.setValue(zb.a.Fu,f*b)}}VLa(a,b){if(a&&14===a.type){const c=this.SJ.BUc(a);for(let f=0;f<c.length;f++){const l=this.gl.gub(a,f);c[f]=Math.max(l,c[f]*
b)}a.setValue(ab.a.ev,c)}}uyh(a,b){if(a&&0<a.length)for(const c of a)c.setValue(zb.a.Fu,xe.a.ZW(b))}tyh(a,b,c){if(a&&b&&0<b.length){const f=this.SJ.BUc(a);for(let l=0;l<b.length;l++)f[b[l]]=xe.a.ZW(c);a.setValue(ab.a.ev,f)}}zie(a){const b=new ob.GraphIterator;b.Tc(a);var c=b.currentNode;b.Cb(1);const f=a.Cc();this.kAa(a);const l=Vs.a.instance.createInstance(393251);this.W$b(a,l,c,c,!1);a.$k(l);c=this.zc.Gi(f);for(let y=0;y<c;++y){const H=this.Psa();super.i_b(a,H,b.currentNode,!1,!0);this.Thd(l,H,
b.currentNode,!1,!0,!0);b.Gf(1)}this.ONb(f,this.zc.Gk(f)+1);return a.currentNode}yie(a){const b=ob.GraphIterator.pb(a.oPh());let c=this.zc.Gi(b.currentNode);var f=this.SJ.AUc(Object(qa.a)(130,a.currentNode));a=f+1;this.kAa(b);b.Cb(1);do{const l=b.gq(f,1);b.Cc();const y=this.Psa();super.L$b(b,y,l,!1,!1);this.Thd(b.currentNode,y,l,!1,!1,!0)}while(b.Nj(1));(f=b.currentNode.sa(ab.a.ev,null))&&(f=Yb.a.clone(f));this.yNb(b.currentNode,++c);f&&(Array.insert(f,a,0),b.currentNode.setValue(ab.a.ev,f));this.Emc(b.currentNode,
a,!1,1,null)}T8e(a){this.ZQb(a,zb.a.complexTable)}RBj(a,b,c){let f=b;const l=b.zJa;if(l)if(b.isGhostCell)Rh.qWc(l,!c)||Rh.clb(l.controlCell,c,Rh.Oxb(l.controlCell,c)+1);else{let y=Rh.Oxb(b,c);1<y&&(f=Rh.nhj(l,!c));Rh.clb(b,c,y+1)}else Rh.clb(b,c,2);a.isGhostCell=!0;return f}static Ixh(a,b,c){a.currentNode.ye(b,c);let f=a.Oi();if(f){for(;f;)pm.Ixh(a,b,c),f=a.np();a.Cc()}}static EMi(){return lr.LNf(Hg.a.create())}}pm.Vaa=null;pm.b6c=[5,6,7,0,2,1];Object(m.a)(pm,"TableEditor",Rh,[1155]);const ML=(a,
b,c,f,l)=>{const y=l.dV,H=l.Bsa;var Q=l.tableLook;const ia=0<(Q&32);l=0<(Q&128);const wa=0<(Q&64),Ua=0<(Q&256),kb=ia?1:0,Gb=l?1:0;Q=a?a===y-c?wa?3:(a-kb)%2+kb:(a-kb)%2+kb:0;y-c||(Q=ia?0:wa?3:(a-kb)%2+kb);a=b?b===H-f?Ua?3:(b-Gb)%2+Gb:(b-Gb)%2+Gb:0;H-f||(a=l?0:Ua?3:(b-Gb)%2+Gb);return{gHf:Q,eHf:a}};class UD{constructor(a){this.a1=a;this.uad=Array(4);for(a=0;4>a;a++)this.uad[a]=Array(4)}z4f(a,b,c,f){let l,y;({gHf:l,eHf:y}=ML(a,b,c,f,this.a1));if(!this.uad[l][y]){c=Object.assign(new yr.a,{me:b,Tf:b+f,
te:a,eg:a+c});a=this.uad[l];b=y;f=this.a1;var H=f.tableStyle,Q=new dr;Q.latinField=ff.Evb(1,0);Q.eaField=ff.Evb(1,1);Q.csField=ff.Evb(1,2);Q.solidFillField=Object.assign(new Ot.a,{schemeClrField:Object.assign(new Zf.a,{valField:1})});H&&(new pL(Q)).d_(f,c);c=Q;H=f.p9j;f=new Wx;H=H||new oL;for(Q=1;9>=Q;Q++){var ia=qL(H,Q);const wa=Q-1;f.aOe[wa]=ia?De.a(De.c(ia)):new Ns;ia=f.aOe[wa].defRPrField;f.Hub[wa]=ia?De.a(De.c(ia)):new dr}for(H=1;9>=H;H++)rL(f.Hub[H-1],c);a[b]=f}return this.uad[l][y]}d6f(a,b,
c,f,l){let y=rc.a.pSa;a&&(b=this.z4f(b,c,f,l))&&b.Hub&&0<b.Hub.length&&(b=b.Hub[0])&&(y=Ge.Box4ColorHelper.rMb(b,a));return y}}Object(m.a)(UD,"TableListStyleCache",null,[1154]);class VD{constructor(a,b,c,f){this.yHa=a;this.L_g=b;this.yHa.fk(Object(I.a)(this,this.$g,"onPropertyChanged"));this.yHa.hja(Object(I.a)(this,this.onConnected,"onConnected"));this.We=c;this.MAe=f}onConnected(a,b){a=Object(qa.a)(178,b.node);this.L_g.bPh(a)}$g(a,b){a=b.property;b=Object(qa.a)(178,b.node);a===ab.a.ev?this.L_g.bPh(b):
a===ab.a.Nza||a===ab.a.dha||a===ab.a.tB?b.eZ=null:!this.MAe||a!==zb.a.WVa&&a!==zb.a.isResizable&&a!==zb.a.YL||b.qc(this.We).N9e()}dispose(){this.yHa.Om(Object(I.a)(this,this.$g,"onPropertyChanged"));this.yHa.Woa(Object(I.a)(this,this.onConnected,"onConnected"))}}Object(m.a)(VD,"TableNodeBehavior",null,[107]);var WD=d(181);class Sv{constructor(a,b,c,f,l,y,H,Q){this.O0=this.lR=this.Tn=this.aIa=this.L0=this.yed=this.rHa=null;this.Qfb=this.jbd=0;this.GNg=this.qic=this.Yd=this.Sx=null;this.FO=a;this.ia=
c;this.Uq=f;this.Rs=l;this.xD=y;this.caa=b;this.kq=H;this.Up=Q}lL(){this.O0=this.lR=this.Tn=this.L0=this.aIa=null;null!==this.kq&&this.kq.Eya()}Mv(a){if(!a||a.LA===Sys.UI.MouseButton.rightButton||this.FO.c0)return!1;this.Yd=(this.Sx=Object(qa.a)(1122,this.xD.$I(a.Bc)))?this.Sx.Ok:null;if(!this.Yd)return!1;this.rHa=this.Sx.dAi;if(!this.rHa)return!1;this.lR=this.rHa.Cig(a.Bc);if(!this.lR)return!1;this.Up&&this.ia.processAction(C.a.Bka,2);return!0}Yu(a){if(!a||!this.Mv(a))return!1;this.yed=this.Sx=this.xD.$I(this.rHa.va);
if(!this.Sx)return xa.a.J(8959070,808,10,"The draggable chrome should be owned by Box4 TableViewElement"),!1;this.ia.processAction(ea.a.K8a,2);this.rHa.mE(!0);this.Yd.mE(!0);null!==this.kq&&this.kq.cza(Ki.a.jPb);this.O0=this.yed.G8b();this.jbd=this.Uq.om(Zc.a.Ql(this.O0.ga(0),this.O0.ga(1)));this.Qfb=this.Uq.om(Zc.a.Ql(this.O0.ga(0),this.O0.ga(3)));this.aIa=this.JNf(a.clientPoint);this.L0=new Zc.a(0,0);this.Tn=new Xi.a;this.GNg=new Zc.a(this.Yd.x+this.jbd,this.Yd.y+this.Qfb);return!0}Rw(a){if(!a)return!1;
a=this.JNf(a.clientPoint);var b=Zc.a.rV(a,this.aIa);this.L0=Zc.a.add(this.L0,b);b=Uk.CXd(this.lR,this.O0,this.L0,!1,!1);this.Tn=Object.assign(new Xi.a,{bottom:this.Uq.om(b.bottom),left:this.Uq.om(b.left),right:this.Uq.om(b.right),top:this.Uq.om(b.top)});let c;({fRh:b,jRh:c}=this.yHf());const f=new WD.a;f.Mca(b,c);f.FC(this.Tn.left,this.Tn.top);this.rHa.vq(f);this.aIa=a;return!0}to(a){let b=null;a&&(b=this.caa.Ii("UserAction","PPTTableResize"),xa.a.J(19142416,822,50,String.format("Start Table resize for table: {0}, IsComplex: {1}",
this.Sx.gb.sa(zb.a.ZHb,""),cd.TableReader.wt(this.Sx.gb))));this.rHa.cA(!1);({fRh:l,jRh:y}=this.yHf());this.Sx.xyh(l,y);this.U4e();const c=new pf.GraphTransaction(15);c.ld(this.Sx.gb);var f=this.Sx.Nd.Md;this.Rs.UWe(Object(qa.a)(Pz.TableNode,this.Sx.gb),l,y,this.yed,f);if(Sv.OFa(this.lR)||Sv.OFa(this.lR,!0)){var l=this.Sx.Ok.shapeNode;var y=f.gf(this.Yd.x,0);f=f.gf(this.Yd.y,1);l.Iy=y;l.Jy=f}this.Yd.cA(!1);c.dispose();this.lL();Rc.App.Lb.updateCommandUI();b&&b.stop();a&&xa.a.J(8959107,822,50,String.format("End Table resize for table: {0}, IsComplex: {1}",
this.Sx.gb.sa(zb.a.ZHb,""),cd.TableReader.wt(this.Sx.gb)))}U4e(){var a=Sv.OFa(this.lR),b=Sv.OFa(this.lR,!0);if(a||b){b=this.yed.G8b();a=this.Uq.om(b.fc-b.ic);b=this.Uq.om(b.Zb-b.kc);const c=this.GNg;c._x+=this.Tn.right;c._y+=this.Tn.bottom;this.Yd.setPosition(c.x-a,c.y-b,!0)}}Au(){this.L0&&(this.rHa.cA(!0),this.rHa.vq(null),this.Yd.cA(!0),this.lL())}yHf(){return{fRh:this.jbd?1+(this.Tn.right-this.Tn.left)/this.jbd:1,jRh:this.Qfb?1+(this.Tn.bottom-this.Tn.top)/this.Qfb:1}}JNf(a){a=Zc.a.yTa(a);var b=
this.lR;this.lR.Eac()||(b=b.xyb());const c=this.O0.Tj(b);b=this.O0.Tj(b.p$a());return a=new Zc.a(c.x<=b.x?Math.min(a.x,b.x):Math.max(a.x,b.x),c.y<=b.y?Math.min(a.y,b.y):Math.max(a.y,b.y))}static OFa(a,b=!1){return a.equals(qe.a.Wu)?!0:b?a.equals(qe.a.north)||a.equals(qe.a.VE):a.equals(qe.a.west)||a.equals(qe.a.dI)}}Object(m.a)(Sv,"TableResizeDragAdapter",null,[274]);class XD{constructor(a,b){this.a1=a;this.pHb=b;this.ui=Array(4);for(a=0;4>a;a++)this.ui[a]=Array(4);this.NHe=Array(16)}J9d(a,b,c,f){let l,
y;({gHf:l,eHf:y}=ML(a,b,c,f,this.a1));this.ui[l][y]||(this.ui[l][y]=this.pHb.wbl(this.a1,a,b,c,f));c=this.ui[l][y].clone();if(a=this.cxj(a,b))for(const H of a.mA())c.Ua(H)||c.ye(H,a.Rh(H));return c}clear(){for(let a=0;4>a;a++)this.ui[a]=Array(4);this.NHe=Array(16)}cxj(a,b){var c=a===this.a1.dV-1;const f=b===this.a1.Bsa-1;let l=0;a||(l|=8);!b&&(l|=4);c&&(l|=2);f&&(l|=1);(c=this.NHe[l])||(this.NHe[l]=c=this.pHb.Sbl(this.a1,a,b));return c}}Object(m.a)(XD,"TableStyleCache",null,[1127]);class NL{constructor(a){this.pYa=
a}wbl(a,b,c,f,l){const y=a.dV;var H=a.Bsa,Q=a.tableLook;const ia=a.tableStyle;a=a.Ed;const wa=new xq.a,Ua=0<(Q&32),kb=0<(Q&128),Gb=!b&&Ua,ec=!c&&kb;f=b===y-f&&0<(Q&64);l=c===H-l&&0<(Q&256);H=!(Q&512)&&!Gb&&!f;Q=!(Q&1024)&&!ec&&!l;this.Tbl(ia.wholeTblField,wa);H&&this.Kya((Ua?1!==(b&1):b&1)?ia.band2HField:ia.band1HField,a,wa);Q&&this.Kya((kb?1!==(c&1):c&1)?ia.band2VField:ia.band1VField,a,wa);l&&this.Kya(ia.lastColField,a,wa);ec&&this.Kya(ia.firstColField,a,wa);f&&(this.Kya(ia.lastRowField,a,wa),l&&
this.Kya(ia.seCellField,a,wa),ec&&this.Kya(ia.swCellField,a,wa));Gb&&(this.Kya(ia.firstRowField,a,wa),l&&this.Kya(ia.neCellField,a,wa),ec&&this.Kya(ia.nwCellField,a,wa));return wa}Sbl(a,b,c){var f=a.dV;const l=a.Bsa;var y=a.tableStyle;a=a.Ed;const H=new xq.a;if(y&&0<=b&&b<f&&0<=c&&c<l){const Q=!c;f=b===f-1;c=c===l-1;(y=y.wholeTblField)&&y.tcStyleField&&(y=y.tcStyleField.tcBdrField)&&(this.L0a(7,b?y.insideHField:y.topField,a,H),this.L0a(0,f?y.bottomField:y.insideHField,a,H),this.L0a(5,Q?y.leftField:
y.insideVField,a,H),this.L0a(6,c?y.rightField:y.insideVField,a,H))}return H}Brh(a,b,c){const f=new xq.a;this.yrh(a,c,b,f);return f}Tbl(a,b){a&&a.tcStyleField&&a.tcStyleField.fillField&&b.ye(zb.a.cellShading,a.tcStyleField.fillField)}Kya(a,b,c){a&&a.tcStyleField&&(a.tcStyleField.fillField&&c.ye(zb.a.cellShading,a.tcStyleField.fillField),a=a.tcStyleField.tcBdrField)&&(this.L0a(7,a.topField,b,c),this.L0a(0,a.bottomField,b,c),this.L0a(5,a.leftField,b,c),this.L0a(6,a.rightField,b,c))}L0a(a,b,c,f){b&&b.itemField&&
this.yrh(a,b.itemField,c,f)}yrh(a,b,c,f){let l;({kRa:l,Y7a:a}=cq.kUa(a));b.wFieldSpecified&&f.ye(l,xe.a.X4d(b.wField));if(b.solidFillField)if(this.pYa)f.ye(a,b.solidFillField);else{if(b=Ge.Box4ColorHelper.rkb(b.solidFillField,c))b=Ge.Box4ColorHelper.jha(b),f.ye(a,b)}else b.noFillField&&(this.pYa&&eb.a("TableBordersLocalRenderingFix")?(b=Ge.Box4ColorHelper.pS({Color:"##T,0,0,0"}),f.ye(a,b),f.ye(l,0)):f.ye(a,rc.a.pSa))}}Object(m.a)(NL,"TableStyleResolver",null,[402]);var OL=d(333),Qz=d(191);class Yx{constructor(a,
b,c,f=null){this.uxa=!1;this.JB=this.qo=this.nb=this.Czg=this.K1g=null;this.tD=[];this.Rk=this.xA=!1;this.BR=null;this.Sn=this.Xeb=!1;this.Fa=b;this.cOg=a;this.Rc=f;this.tU=(this.y9c=c)?10:6;this.uFe=c?2:se.a.hF}get visible(){return this.uxa}set visible(a){this.uxa!==a&&(this.uxa=a,this.Sxh())}get va(){return this.nb.viewport.va}Lpi(a,b,c){this.K1g=a;this.Czg=c;this.xm();this.Rc.rb(oa.a.click,this.va,Object(I.a)(this,this.t6g,"notifySelectShapeByClick"));b.appendChild(this.nb.viewport);this.K1g.sK(this.va,
!0);this.Xeb=!0;this.setZIndex(2+Ox.a.wha+1)}ULh(){this.Xeb&&this.nb&&this.Rc.Bb(oa.a.click,this.va,Object(I.a)(this,this.t6g,"notifySelectShapeByClick"));this.Xeb=!1}setZIndex(a){this.Xeb&&this.nb.jC(a)}xm(){this.nb||(this.nb=new Qz.a,this.qo=new cm.a,this.qo.eF(Ui.a.none),this.qo.dv(se.a.T1),this.qo.ur(se.a.hF),this.nb.Al(Ki.a.XA),this.nb.appendChild(this.qo),this.JB=new Hn.a,this.v3b(this.JB),this.nb.appendChild(this.JB),this.nb.Sd(!1),this.nb.viewport.va.setAttribute(Ui.a.QJb,Ui.a.none))}em(){if(this.Xeb){var a=
this.drj(this.Czg);this.xA?(this.BR&&this.BR.ll(a),this.qo.Jt(a.points)):(a=a.points,this.qo.Jt(a),a=new fj.a(a[0],a[1],a[2],a[3]));this.EY(a);this.nb.em()}}v3b(a){for(let f=0;8>f;++f){var b="selectionHandle"+f;const l=new Hn.a;l.va.id=b;if(z.a.uMa){var c=new OL.a;c.va.id=b;c.va.setAttribute("class",fm.a.Ovd);c.setVisibility(!1);c.setPosition(-10,-10);c.ah(20,20);l.appendChild(c)}c=new OL.a;c.va.id=b;c.va.setAttribute("class",fm.a.Ovd);b=this.tU/2*-1;c.setPosition(b,b);c.ah(this.tU,this.tU);this.y9c&&
c.Vxh(this.tU/2,this.tU/2);c.eF("white");c.dv(se.a.T1);c.ur(this.uFe);c.pyh();l.appendChild(c);l.Zj(1);this.tD[f]=l;a.appendChild(l)}}EY(a){for(let b=0;8>b;++b){const c=this.tD[b];c.Al(Yx.asc[b]);this.KLa(c,a.Tj(new qe.a(b)))}}drj(a){return new fj.a(new Zc.a(0,0),new Zc.a(a.offsetWidth,0),new Zc.a(a.offsetWidth,a.offsetHeight),new Zc.a(0,a.offsetHeight))}JD(a){this.Sn||((this.xA=a)?(this.qo.eF(se.a.qVf),this.qo.dv(se.a.T1),this.qo.ur(se.a.hF),this.JB.Sd(!1),this.cOg.endEditing(!0,14)):(this.qo.eF(Ui.a.none),
this.qo.dv(se.a.T1),this.qo.ur(se.a.hF),this.JB.Sd(!0),this.Fa.vf(jb.a.vg),this.cOg.mS()))}dispose(){this.Rk||(this.ULh(),this.qo=this.nb=null,Array.clear(this.tD),this.JB=null,this.Xeb=!1,this.Rk=!0)}Cig(a){if(!this.Xeb)return null;for(let b=0;8>b;++b)if(this.tD[b].va.id===a.id)return new qe.a(b);return null}KLa(a,b){a.setPosition(b.x,b.y)}t6g(a){return this.Cig(a.Bc)?!0:!1}mE(a){this.JD(!0,a)}cA(){this.JD(!1)}vq(a){this.BR&&this.BR.clear();this.BR=a;this.em()}Xw(a){this.Sn=a;this.Sxh()}Sxh(){this.nb&&
this.nb.Sd(!this.Sn&&this.uxa)}static f3b(a){return new Yx(a,Ib.a.instance.resolve("PowerPointWebEditor.IFocusManager"),Ib.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptChangeResizeHandleEnabled,w.AFrameworkApplication.Aa.Wy)}}Yx.asc=[Ki.a.e4e,Ki.a.d4e,Ki.a.c4e,Ki.a.b4e,Ki.a.f4e,Ki.a.g4e,Ki.a.h4e,Ki.a.i4e];Object(m.a)(Yx,"DraggablePandoraChromeView",null,[1130]);class PL{}Object(m.a)(PL,"TableStyleCategoryInfo",null,[]);class Tf{static z_i(){if(Tf.lh)return Tf.lh;Tf.lh=new Uc.a;
Tf.lh.$("No Style, No Grid",ResourceStrings.l_TableThemedStyle1);Tf.lh.$("Themed Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,1));Tf.lh.$("Themed Style 1 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,2));Tf.lh.$("Themed Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,3));Tf.lh.$("Themed Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleThemed,1,4));Tf.lh.$("Themed Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,5));Tf.lh.$("Themed Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,6));Tf.lh.$("No Style, Table Grid",ResourceStrings.l_TableThemedStyle2);Tf.lh.$("Themed Style 2 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,1));Tf.lh.$("Themed Style 2 - Accent 2",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,2));Tf.lh.$("Themed Style 2 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,3));Tf.lh.$("Themed Style 2 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,4));Tf.lh.$("Themed Style 2 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,5));Tf.lh.$("Themed Style 2 - Accent 6",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleThemed,2,6));Tf.lh.$("Light Style 1",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleLight,1));Tf.lh.$("Light Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,1));Tf.lh.$("Light Style 1 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,2));Tf.lh.$("Light Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,
1,3));Tf.lh.$("Light Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,4));Tf.lh.$("Light Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,5));Tf.lh.$("Light Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,6));Tf.lh.$("Light Style 2",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleLight,2));Tf.lh.$("Light Style 2 - Accent 1",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,1));Tf.lh.$("Light Style 2 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,2));Tf.lh.$("Light Style 2 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,3));Tf.lh.$("Light Style 2 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,4));Tf.lh.$("Light Style 2 - Accent 5",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleLight,2,5));Tf.lh.$("Light Style 2 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,6));Tf.lh.$("Light Style 3",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleLight,3));Tf.lh.$("Light Style 3 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,1));Tf.lh.$("Light Style 3 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,
3,2));Tf.lh.$("Light Style 3 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,3));Tf.lh.$("Light Style 3 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,4));Tf.lh.$("Light Style 3 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,5));Tf.lh.$("Light Style 3 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,6));Tf.lh.$("Medium Style 1",
String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,1));Tf.lh.$("Medium Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,1));Tf.lh.$("Medium Style 1 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,2));Tf.lh.$("Medium Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,3));Tf.lh.$("Medium Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleMedium,1,4));Tf.lh.$("Medium Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,5));Tf.lh.$("Medium Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,6));Tf.lh.$("Medium Style 2",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,2));Tf.lh.$("Medium Style 2 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,
2,1));Tf.lh.$("Medium Style 2 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,2));Tf.lh.$("Medium Style 2 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,3));Tf.lh.$("Medium Style 2 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,4));Tf.lh.$("Medium Style 2 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,5));
Tf.lh.$("Medium Style 2 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,6));Tf.lh.$("Medium Style 3",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,3));Tf.lh.$("Medium Style 3 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,1));Tf.lh.$("Medium Style 3 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,2));Tf.lh.$("Medium Style 3 - Accent 3",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,3));Tf.lh.$("Medium Style 3 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,4));Tf.lh.$("Medium Style 3 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,5));Tf.lh.$("Medium Style 3 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,6));Tf.lh.$("Medium Style 4",String.format(ResourceStrings.l_TableStyleNoAccent,
ResourceStrings.l_TableStyleMedium,4));Tf.lh.$("Medium Style 4 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,1));Tf.lh.$("Medium Style 4 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,2));Tf.lh.$("Medium Style 4 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,3));Tf.lh.$("Medium Style 4 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,
4,4));Tf.lh.$("Medium Style 4 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,5));Tf.lh.$("Medium Style 4 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,6));Tf.lh.$("Dark Style 1",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleDark,2));Tf.lh.$("Dark Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,1));Tf.lh.$("Dark Style 1 - Accent 2",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,2));Tf.lh.$("Dark Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,3));Tf.lh.$("Dark Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,4));Tf.lh.$("Dark Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,5));Tf.lh.$("Dark Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleDark,1,6));Tf.lh.$("Dark Style 2",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleDark,2));Tf.lh.$("Dark Style 2 - Accent 1/Accent 2",String.format(ResourceStrings.l_TableStyleNameAccent,ResourceStrings.l_TableStyleDark,2,1,2));Tf.lh.$("Dark Style 2 - Accent 3/Accent 4",String.format(ResourceStrings.l_TableStyleNameAccent,ResourceStrings.l_TableStyleDark,2,2,3));Tf.lh.$("Dark Style 2 - Accent 5/Accent 6",String.format(ResourceStrings.l_TableStyleNameAccent,
ResourceStrings.l_TableStyleDark,2,4,5));return Tf.lh}static fcg(a){const b=Tf.z_i();return b.Fb(a)?b.ga(a):a}}Tf.lh=null;Object(m.a)(Tf,"TableStyleNameReader",null,[]);class QL{constructor(a){this.XCg=!1;this.iDb=[];this.Lze=new Jd.a(0);this.nue=[];this.vXg=a}q5d(){this.XCg||(this.XCg=this.pPk())}pPk(){const a=this.vXg.instance?this.vXg.instance.hEl:null;if(a&&a.tblStyleCategoriesField){let b=0;this.iDb=[];this.Lze=new Jd.a(0);this.nue=[];for(let c=0;c<a.tblStyleCategoriesField.length;c++){const f=
a.tblStyleCategoriesField[c];if(f.tblStylesField&&0<f.tblStylesField.length){Array.add(this.nue,Object.assign(new PL,{id:f.idField,begin:b,end:b+f.tblStylesField.length-1}));for(let l=0;l<f.tblStylesField.length;l++){const y=f.tblStylesField[l],H=new J.DictionaryPropertySet,Q=new QD(y,f.idField,l);H.ye(zb.a.tableStyle,Q);this.iDb.push(H);this.Lze.$(y.styleIdField.toLowerCase(),b++)}}}return!0}return!1}$Tc(){return this.iDb}Yyb(a){return 0<=a&&a<this.iDb.length?this.iDb[a]:null}ttj(a,b){let c=null;
for(const f of this.nue)if(f.id===a){c=f;break}return c&&(a=c.begin+b,a<=c.end)?this.Yyb(a):null}Dtj(a){return this.C8b(a).hY.styleIdField}Etj(a){return(a=this.C8b(a).hY.styleNameField)?eb.a("TableStyleNameLocalization")?Tf.fcg(a):a:""}wtj(a){return this.C8b(a).ozg}C8b(a){return a.Rh(zb.a.tableStyle)}ecg(a){return(a=this.vuj(a))?a.Rh(zb.a.tableStyle):null}vuj(a){this.q5d();return this.iDb[this.Lze.ga(a.toLowerCase())]}}Object(m.a)(QL,"TableStyleGalleryManager",null,[403]);class RL{constructor(a,b,
c,f,l){this.fM=0;f||(f=Object.assign(new yr.a,{te:0,eg:c.fP,me:0,Tf:c.PR}));this.wue=a;this.brk=b;this.Ina=c;this.JE=f;this.qA=new yr.a;this.VO=this.fM=-1;this.p8c=l}get org(){return-1===this.VO||-1===this.fM}moveNext(){this.org&&(this.VO=this.JE.te,this.qA.Tf=this.JE.me);for(;;){this.fM=this.qA.Tf;if(this.fM>=this.JE.Tf&&(this.fM=this.JE.me,++this.VO>=this.JE.eg))return this.reset(),!1;this.qA=this.wue.TI(this.Ina,this.VO,this.fM);if(this.VO===this.JE.te||this.VO===this.qA.te)if(!this.p8c||this.p8c.BRd(this))return!0}}Vwk(){this.org&&
(this.fM=this.JE.me,this.qA.eg=this.JE.te);for(;;){this.VO=this.qA.eg;if(this.VO>=this.JE.eg&&(this.VO=this.JE.te,++this.fM>=this.JE.Tf)){this.reset();break}this.qA=this.wue.TI(this.Ina,this.VO,this.fM);if(this.fM===this.JE.me||this.fM===this.qA.me)if(!this.p8c||this.p8c.BRd(this))break}}moveTo(a,b){this.qA=this.wue.TI(this.Ina,a,b);if(!this.qA.c2i(this.JE))return this.reset(),!1;this.VO=Math.min(Math.max(a,this.JE.te),this.JE.eg-1);this.fM=Math.min(Math.max(b,this.JE.me),this.JE.Tf-1);return!0}reset(){this.VO=
this.fM=-1}f7b(){return this.brk.ef(this.qA.te,this.qA.me)}}Object(m.a)(RL,"CellIterator",null,[1135]);class SL{constructor(a){this.Sq=a}iEa(a,b,c,f=null){return new RL(this.Sq,a,b,c,f)}}Object(m.a)(SL,"CellIteratorFactory",null,[398]);class YD{constructor(a,b,c){this.Sq=b;this.Ina=c;this.pD=this.Sq.VRc(this.Ina,a.JE);this.W9=Array(this.pD.PR*(this.pD.fP+1));this.VO=this.pD.te;this.Pdb=this.pD.me;this.nDb=this.pD.me-1;this.Tq=0;this.$he(a)}$he(a){const b=a.JE;for(;a.moveNext();){const f=a.qA;for(let l=
f.me;l<f.Tf;l++){var c=this.FEa(f.te,l);this.W9[c]=0!==this.W9[c]?2:l<b.me&&f.te>b.te?16:l>=b.Tf&&f.te>b.te?64:1;c=this.FEa(f.eg,l);this.W9[c]=0!==this.W9[c]?2:l<b.me&&f.eg<b.eg?16:l>=b.Tf&&f.eg<b.eg?64:4}}}FEa(a,b){return this.pD.PR*(a-this.pD.te)+(b-this.pD.me)}moveNext(){this.Pdb=this.nDb;do{this.Pdb++;this.Pdb>=this.pD.Tf&&(this.VO++,this.Pdb=this.pD.me);if(this.VO>this.pD.eg)return!1;this.Tq=this.W9[this.FEa(this.VO,this.Pdb)]}while(0===this.Tq);for(this.nDb=this.Pdb;this.nDb+1<this.pD.Tf&&this.W9[this.FEa(this.VO,
this.nDb+1)]===this.Tq;)this.nDb++;return!0}Jcj(){return this.nDb+1}J$a(){return this.Tq}static Lme(a){return!!(a&87)}}Object(m.a)(YD,"HorizontalTableBorderIterator",null,[1076,508]);class TL{constructor(a){this.Sq=a}BLi(a,b){return new YD(a,this.Sq,b)}}Object(m.a)(TL,"HorizontalTableBorderIteratorFactory",null,[399]);var Rz;(function(a){a[a.none=0]="none";a[a.firstLayout=1]="firstLayout";a[a.paragraphPropertyChange=2]="paragraphPropertyChange";a[a.cellChildTopoChange=3]="cellChildTopoChange";a[a.rowPropertyChange=
4]="rowPropertyChange";a[a.cellPropertyChange=5]="cellPropertyChange";a[a.panelLayoutChange=6]="panelLayoutChange";a[a.tablePropertyChange=7]="tablePropertyChange";a[a.tableNodeConnected=8]="tableNodeConnected";a[a.tableViewElementDisconnected=9]="tableViewElementDisconnected";a[a.tableComplexityChange=10]="tableComplexityChange";a[a.slideInvalidateRenderSize=11]="slideInvalidateRenderSize"})(Rz||(Rz={}));Object(m.b)("LayoutInvalidateTrigger",Rz);class UL{constructor(){this.Jja=this.sWd=this.kwc=
this.D_d=0}get rowSpan(){return this.sWd-this.kwc}toString(){return String.format("C[{0}][{1}]",this.kwc,this.Jja)}}Object(m.a)(UL,"CellInfo",null,[]);class zr{constructor(){this.m0c=!1;this.Vc=this.VIf=this.telemetry=null;this.ddb=this.Ptc=!1;this.Qvd=null;this.v3g=0;this.tableNode=this.Are=this.Bza=null;this.D6d=!1}}Object(m.a)(zr,"LayoutContext",null,[]);class VL{constructor(){this.pDh=this.pzd=0}}Object(m.a)(VL,"LayoutTelemtry",null,[]);class ZD{constructor(){this.offset=this.wlc=this.index=0}toString(){return String.format("Index {0}, H {1}, O {2}",
this.index,this.wlc,this.offset)}}Object(m.a)(ZD,"RowSeamInfo",null,[]);class Eh{constructor(a,b,c,f,l,y,H){this.sD=null;this.wEb=[];this.NIa=[];this.OX=0;this.Rk=this.had=!1;this.cgb=null;this.b$c=!1;this.lad=0;this.Ve=null;this.Iz=a;this.wb=f;this.gl=y;this.Rb=c;this.fY=H;this.Z$b(1)}bRj(a,b){if(!this.had&&!this.b$c)try{2!==this.OX&&(1===this.OX?this.wEb[0]!==a&&this.Z$b(b):(this.wEb[this.wEb.length]=a,this.OX=1,this.lad=b))}catch(c){this.Z$b(0),xa.a.J(512495695,808,10,"PPTTableLayoutService::InvalidateCell failed {0}",
c.toString())}}Z$b(a){this.b$c||2===this.OX||this.had||(this.OX=2,this.wEb=[],this.lad=a)}Wfe(){return 0!==this.OX&&!this.had}get R_c(){return this.OX}QNh(a){this.Wfe()&&(a=Object.assign(new zr,{tableNode:a}),this.layout(a))}SOl(a,b){this.Wfe()?this.cgb||(this.cgb=new dd.a(3,1,0,Object(I.a)(this,this.gOk,"performLayout"),90,"9"),this.cgb.customData=Object.assign(new zr,{tableNode:a,m0c:!0,Are:b}),this.wb.Hb(this.cgb)):b&&b(!1)}gOk(a){this.layout(Object(qa.a)(zr,a.customData))}layout(a){this.b$c=!0;
const b=new Lh.a(null,Object(I.a)(this,this.mOj,"initializeLayoutState"),a);b.Wi=!a.m0c;b.run()}mOj(a,b){b=Object(qa.a)(zr,b);try{this.XZi();b.Vc=this.Ve;b.telemetry=new VL;this.VSl();if(!this.Wfe())return a.hh(Object(I.a)(this,this.Tza,"tearDownLayout")),!0;this.OX=0;if(!b.tableNode.isConnected)return a.hh(Object(I.a)(this,this.Tza,"tearDownLayout")),!0;const c=Object(qa.a)(1122,b.tableNode.qc(this.Iz));if(!c)return a.hh(Object(I.a)(this,this.Tza,"tearDownLayout")),!0;b.Qvd=c;b.Vc.Wa(Eh.Jni,b.m0c.toString());
b.tableNode.Op()?(b.Vc.Wa(Eh.Nug,Rz[this.lad]),a.hh(Object(I.a)(this,this.OSk,"prepareTableMetrics"))):(b.Vc.Wa(Eh.Nug,"tableComplexityChange"),b.Ptc=!0,b.ddb=!0,a.hh(Object(I.a)(this,this.Tza,"tearDownLayout")))}catch(c){b.Vc.Wa(Eh.bdc,c.message),a.hh(Object(I.a)(this,this.Tza,"tearDownLayout"))}return!0}OSk(a,b){b=Object(qa.a)(zr,b);try{b.Bza=new Date,this.fY.thh(b.tableNode,this.Iz),b.Vc.Wa(Eh.ISk,(+new Date-+b.Bza).toString()),b.Vc.Wa(Eh.dwk,this.fY.oVj.toString()),a.hh(Object(I.a)(this,this.h8j,
"layoutBaselineTable"))}catch(c){b.Vc.Wa(Eh.bdc,c.message),a.hh(Object(I.a)(this,this.Tza,"tearDownLayout"))}return!0}h8j(a,b){b=Object(qa.a)(zr,b);try{b.Bza=new Date;b.D6d=!0;b.v3g=Eh.mvk;this.sD=[];this.sD[this.sD.length]=Object.assign(new ZD,{index:0,wlc:0,offset:0});const c=new Yf.a(this.Iz);c.set(b.tableNode);if(!c.Cb(1))throw Error.invalidOperation(Eh.j_f);const f=b.tableNode;let l=c.currentNode,y=l,H=0,Q=0,ia=0;for(;l;){15===l.type&&(y=l,ia=H=0,l=c.Cb(1));const wa=l;if(!wa)throw xa.a.J(512495690,
808,10,"PPTTableLayoutService::LayoutBaselineTable Cell is Null"),Error.argumentNull("Casting of GraphNode to cell is null");if(1===wa.rowSpan){const Ua=Object(qa.a)(st,l.qc(this.Iz));H=Math.max(H,this.fY.g7b(f,Ua.Nja,Q,ia))}l=c.Nj(1);ia++;if(!l){const Ua=Object.assign(new ZD,{index:this.sD.length});let kb=y.sa(zb.a.Fu,0);kb=Math.max(kb,this.gl.ELc(y));let Gb=b.Qvd.Nd.Md.Ne(kb,1);Gb=Math.max(Gb,H);Ua.offset=Gb+this.sD[Ua.index-1].offset;Ua.wlc=Gb;this.sD[this.sD.length]=Ua;l=c.Gf(1);Q++}}a.hh(Object(I.a)(this,
this.m8j,"layoutRowSeams"));b.Vc.Wa(Eh.k8j,(+new Date-+b.Bza).toString())}catch(c){b.Vc.Wa(Eh.bdc,c.message),b.Ptc=!0,a.hh(Object(I.a)(this,this.Tza,"tearDownLayout"))}return!0}m8j(a,b){b=Object(qa.a)(zr,b);try{if(1===this.sD.length)throw Error.create(Eh.R2i);let c=b.VIf;if(!c){b.Bza=new Date;c=new Yf.a(this.Iz);c.set(b.tableNode);if(!c.Cb(1))throw Error.invalidOperation(Eh.j_f);b.VIf=c}const f=b.tableNode;let l=c.currentNode,y=0,H=0,Q=0;for(;l&&y<b.v3g;){15===l.type&&(l=c.Cb(1),H=0);const ia=l;if(!ia)throw xa.a.J(512495687,
808,10,"PPTTableLayoutService::LayoutRowSeams Cell is Null"),Error.argumentNull("Casting of GraphNode to cell is null");y++;b.telemetry.pzd++;1===ia.rowSpan||gj.OutlineReader.isEmpty(c)?b.telemetry.pDh++:this.o8j(this.VJi(f,ia,Q,H),b.Vc);l=c.Nj(1);H++;l||(l=c.Gf(1),Q++)}l||(this.fDl(),a.hh(Object(I.a)(this,this.z6i,"fixupTableMinRowHeight")),b.Vc.Wa(Eh.n8j,(+new Date-+b.Bza).toString()))}catch(c){b.Vc.Wa(Eh.bdc,c.message),b.Ptc=!0,a.hh(Object(I.a)(this,this.Tza,"tearDownLayout"))}return!0}z6i(a,b){b=
Object(qa.a)(zr,b);try{const l=b.Qvd;b.Bza=new Date;const y=[];var c=new Yf.a(this.Iz);c.set(b.tableNode);for(var f=c.Cb(1);f;)y[y.length]=c.fr,f=c.Nj(1);if(this.NIa.length===y.length){c=[];for(f=0;f<y.length;++f)c[f]=0,1<Math.abs(this.NIa[f]-y[f].htmlElement.offsetHeight)&&(c[f]=this.NIa[f]);for(f=0;f<c.length;++f)0<c[f]&&y[f].cOb(c[f]*l.Wbe())}else throw Error.invalidOperation(String.format("RowMisMatch{0},{1}",this.NIa.length,y.length));a.hh(Object(I.a)(this,this.Tza,"tearDownLayout"));b.Vc.Wa(Eh.v6i,
(+new Date-+b.Bza).toString());b.ddb=!0}catch(l){b.Vc.Wa(Eh.bdc,l.message),b.Ptc=!0,a.hh(Object(I.a)(this,this.Tza,"tearDownLayout"))}return!0}Tza(a,b){a=Object(qa.a)(zr,b);a.Bza=new Date;a.Ptc?(this.mcl(a.Vc,a.tableNode,a.Qvd),a.D6d=!0):a.Vc&&(a.Vc.Wa(Eh.q8j,a.telemetry.pzd.toString()),a.Vc.Wa(Eh.p8j,a.telemetry.pDh.toString()));this.cgb&&!a.m0c&&this.wb.Lg(this.cgb);this.b$c=!1;this.cgb=null;this.lad=0;a.Vc&&(a.Vc.Wa(Eh.ddb,a.ddb.toString()),!a.ddb&&a.Vc&&a.Vc.Wa(Eh.tableLayout,this.fY.z4d(a.tableNode)),
a.Vc.Wa(Eh.EEl,(+new Date-+a.Bza).toString()),a.Vc.finish());a.ddb||(this.had=!0);this.sD=null;this.wEb=[];this.Ve=null;this.fY.reset();a.Are&&a.Are(a.D6d);return!1}mcl(a,b,c){if(b.isConnected)try{const f=new Yf.a(this.Iz);f.set(b);let l=f.Cb(1);for(;l;){const y=Object(qa.a)(Rv,f.lSa);if(!y)throw Error.argument("tableRowViewElement");let H=c.Nd.Md.Ne(l.sa(zb.a.Fu,0),1);const Q=c.Wbe();H*=Q;y.cOb(H);l=f.Nj(1)}}catch(f){a&&a.Wa(Eh.lcl,f.message)}}o8j(a,b){if(!a)throw Error.create(Eh.Q2i);var c=this.sD[a.kwc];
const f=this.sD[a.sWd];c=Math.max(this.plj(c,f),a.D_d)-(f.offset-c.offset);if(!(0>=c)&&(this.Jji(f.index,c),f.offset<=this.sD[f.index-1].offset)){b.Wa(Eh.Pxi,a.toString());for(a=0;a<=f.index;++a)b.Wa(Eh.Vfl,this.sD[a].toString());throw Error.create(Eh.S2i);}}fDl(){if(this.sD){this.NIa=[];for(let a=1;a<this.sD.length;++a)this.NIa[this.NIa.length]=this.sD[a].offset-this.sD[a-1].offset}else this.NIa=null}Jji(a,b){if(b)for(var c=a,f=0;c<this.sD.length;){b=c===a?b:b+this.sD[c].wlc-this.sD[c].offset+f;
if(0>=b)break;f=this.sD[c].offset;this.sD[c].offset+=b;c++}}plj(a,b){if(a.index>=b.index)return 0;let c=0;for(a=a.index;a<b.index;)c+=this.sD[a+1].wlc,a++;return c}VJi(a,b,c,f){if(!b||!b.isConnected)return null;const l=Object(qa.a)(st,b.qc(this.Iz)),y=this.Rb.Lc(b);y.sc(14);a=Object.assign(new UL,{D_d:this.fY.g7b(a,l.Nja,c,f),kwc:vk.c(y),Jja:f});a.sWd=a.kwc+b.rowSpan;return a}dispose(){this.Rk||(this.wEb=this.sD=this.NIa=null,this.OX=0,this.Rk=!0)}VSl(){if(this.Rk)throw Error.invalidOperation("table layout service is already disposed");
}XZi(){this.Ve||(this.Ve=Nc.a.kk("TableLayout"))}get Na(){return this.Iz}}Eh.mvk=25;Eh.bdc="FailureReason";Eh.lcl="RestoreFailureReason";Eh.tableLayout="Layout";Eh.Vfl="SI";Eh.Pxi="CI";Eh.Jni="FAsync";Eh.q8j="CellVisited";Eh.p8j="CellSkipped";Eh.ddb="Succeeded";Eh.k8j="LETD";Eh.n8j="LRST";Eh.v6i="FMTR";Eh.EEl="TDLD";Eh.ISk="PM";Eh.Nug="Trigger";Eh.dwk="MC";Eh.Q2i="CellDisconnected";Eh.R2i="ChildOfTableNotLoaded";Eh.S2i="SeamPositionInvariant";Eh.j_f="NoRowViewElement";Object(m.a)(Eh,"PPTTableLayoutService",
null,[1134,107]);class XL{constructor(a,b,c,f,l){this.Rb=a;this.wb=b;this.grk=c;this.gl=f;this.fY=l}create(a,b){return new Eh(a,b,this.Rb,this.wb,this.grk,this.gl,this.fY)}}Object(m.a)(XL,"PPTTableLayoutServiceFactory",null,[405]);class YL{constructor(a,b,c,f,l,y,H,Q,ia){this.fok=a;this.Wo=b;this.Rb=c;this.tZa=f;this.P_g=l;this.ahb=y;this.Bic=H;this.Us=Q;this.v9c=!0;this.wAe=ia;this.nwa=new Uc.a;this.Wo.dG&&!this.Wo.ik&&(this.v9c=!1);this.v9c&&(this.tZa.eTd(Object(I.a)(this,this.Y7g,"onBeforeTableViewElementDisconnected")),
this.tZa.hja(Object(I.a)(this,this.Ubh,"onTableNodeConnected")),this.tZa.fk(Object(I.a)(this,this.Wbh,"onTableNodePropertyChanged")),this.tZa.h8(Object(I.a)(this,this.Vbh,"onTableNodeDisconnected")),this.P_g.fk(Object(I.a)(this,this.Ybh,"onTableRowNodePropertyChanged")),this.ahb.fk(Object(I.a)(this,this.akd,"onTableCellNodePropertyChanged")),this.ahb.IF(Object(I.a)(this,this.Tbh,"onTableCellNodeChildTopoChanged")),this.Bic.fk(Object(I.a)(this,this.X$g,"onParagraphNodePropertyChanged")),this.Us.rii(Object(I.a)(this,
this.qbh,"onSlideInvalidateRenderSize")))}aXc(a,b){if(!this.v9c)return null;var c=a.id.toString();this.nwa.Fb(c)||this.nwa.$(c,new hr.a);c=this.nwa.ga(c);var f=a.Op();f=this.wAe?f&&cd.TableReader.aNf(Object(qa.a)(ob.GraphIterator,this.Rb.Lc(a))):f;if(c.Fb(b))return b=c.ga(b),f||0!==b.R_c||(this.Onh(a),b=null),b;if(f)c.$(b,this.fok.create(b,a.id));else return null;return c.ga(b)}qAb(a,b,c){a.Op()?this.flg(a.id.toString(),b,c):10===c&&this.flg(a.id.toString(),b,c)}flg(a,b,c){if(this.nwa.Fb(a))for(let f of this.nwa.ga(a).values)b?
f.bRj(b,c):f.Z$b(c)}Hle(a,b,c){a.isConnected&&(a=this.Rb.Lc(a),a.sc(14)&&this.qAb(a.ix(14),b,c))}UQj(a){a.isConnected&&(a=this.Rb.Lc(a),a.sc(14)&&this.qAb(a.ix(14),a.ix(16),2))}Y7g(a,b){b.es.Qc.qp&&this.qAb(b.es.gb,null,9)}Ubh(a,b){this.qAb(b.node,null,8);a=Object(qa.a)(Pz.TableNode,b.node);a=!!a&&a.Op();xa.a.J(41007133,808,50,"Render table, isComplexTable: {0}",a)}Vbh(a,b){this.Onh(b.node)}Onh(a){a=a.id.toString();if(this.nwa.Fb(a)){const b=this.nwa.ga(a);for(let c of b.values)c&&c.dispose();this.nwa.remove(a)}}Wbh(a,
b){a=b.property;b.node.isConnected&&(a===ab.a.ev||a===ab.a.dha||a===ab.a.tB||a===zb.a.zmb||a===zb.a.cid||a===zb.a.Oza||a===zb.a.ivc?this.qAb(b.node,null,7):a===zb.a.complexTable&&this.qAb(b.node,null,10))}Ybh(a,b){a=b.property;b.node.isConnected&&a===zb.a.Fu&&this.Hle(b.node,null,4)}akd(a,b){a=b.property;!b.node.isConnected||a!==zb.a.rowSpan&&a!==zb.a.colSpan||this.Hle(b.node,null,5)}Tbh(a,b){b.node.isConnected&&1===b.yW&&this.Hle(b.node,b.node,3)}X$g(a,b){a=Object(qa.a)(5,b.node);b=b.property;a&&
a.isConnected&&a.Ua(zb.a.cellId)&&!a.mpc&&(b===ab.a.tq||b===ab.a.Hmb)&&this.UQj(a)}qbh(){for(let a of this.nwa.keys)for(let b of this.nwa.ga(a).values)b.Z$b(11)}dispose(){this.v9c&&(this.tZa.tVe(Object(I.a)(this,this.Y7g,"onBeforeTableViewElementDisconnected")),this.tZa.Woa(Object(I.a)(this,this.Ubh,"onTableNodeConnected")),this.tZa.Om(Object(I.a)(this,this.Wbh,"onTableNodePropertyChanged")),this.tZa.hLa(Object(I.a)(this,this.Vbh,"onTableNodeDisconnected")),this.P_g.Om(Object(I.a)(this,this.Ybh,"onTableRowNodePropertyChanged")),
this.ahb.Om(Object(I.a)(this,this.akd,"onTableCellNodePropertyChanged")),this.ahb.oP(Object(I.a)(this,this.Tbh,"onTableCellNodeChildTopoChanged")),this.Bic.Om(Object(I.a)(this,this.X$g,"onParagraphNodePropertyChanged")),this.Us.c9k(Object(I.a)(this,this.qbh,"onSlideInvalidateRenderSize")))}}Object(m.a)(YL,"PPTTableLayoutServiceManager",null,[406,107]);class $D{constructor(a,b,c){this.Sq=b;this.Ina=c;this.pD=this.Sq.VRc(this.Ina,a.JE);this.W9=Array(this.pD.fP*(this.pD.PR+1));this.fM=this.pD.me;this.Dgb=
this.pD.te;this.LGb=this.pD.te-1;this.Tq=0;this.$he(a)}$he(a){const b=a.JE;for(;a.moveNext();){const f=a.qA;for(let l=f.te;l<f.eg;l++){var c=this.FEa(l,f.me);this.W9[c]=0!==this.W9[c]?32:l<b.te&&f.me>b.me?1:l>=b.eg&&f.me>b.me?4:16;c=this.FEa(l,f.Tf);this.W9[c]=0!==this.W9[c]?32:l<b.te&&f.Tf<b.Tf?1:l>=b.eg&&f.Tf<b.Tf?4:64}}}FEa(a,b){return this.pD.fP*(b-this.pD.me)+(a-this.pD.te)}moveNext(){this.Dgb=this.LGb;do{this.Dgb++;this.Dgb>=this.pD.eg&&(this.fM++,this.Dgb=this.pD.te);if(this.fM>this.pD.Tf)return!1;
this.Tq=this.W9[this.FEa(this.Dgb,this.fM)]}while(0===this.Tq);for(this.LGb=this.Dgb;this.LGb+1<this.pD.eg&&this.W9[this.FEa(this.LGb+1,this.fM)]===this.Tq;)this.LGb++;return!0}bqj(){return this.LGb+1}J$a(){return this.Tq}static Lme(a){return!!(a&117)}}Object(m.a)($D,"VerticalTableBorderIterator",null,[507,508]);class Al{constructor(a,b,c,f,l,y,H){this.gl=a;this.Sq=b;this.Rb=c;this.JA=f;this.Uea=l;this.oik=y;this.Gsk=H}oNl(a,b,c){const f=b.getContainingTable();f&&(this.pJl(b,f,a,c.Tf,c.te),this.oJl(b,
f,a,c.eg,c.me))}Q7d(a,b,c,f,l,y){if(c&&c!==b.fP)for(;f<l;f++)if(9===(b.As(c-1,f)&9)&&5===(b.As(c,f)&5)){var H=this.Sq.TI(b,c-1,f),Q=this.Sq.TI(b,c,f);H=a.ef(H.te,H.me);Q=a.ef(Q.te,Q.me);y?this.rvb(Q,H,7,0):this.rvb(H,Q,0,7)}}wZe(a,b,c,f,l){l=this.Uea.iEa(a,b,c,l);c=f.mbj();if($D.Lme(c)){let y=this.Gsk.IPi(l,b);for(;y.moveNext();)0!==(c&y.J$a())&&this.c0e(a,b,y.fM,y.Dgb,y.bqj(),f.Yyb(y.J$a()),!0)}if(YD.Lme(c))for(l=this.oik.BLi(l,b);l.moveNext();)0!==(c&l.J$a())&&this.ZZe(a,b,l.VO,l.Pdb,l.Jcj(),f.Yyb(l.J$a()),
!0)}c0e(a,b,c,f,l,y,H=!1){let Q=this.JA.sXc(a),ia=null;0<c&&(ia=a.ef(f,c-1));let wa=null;for(c<b.PR&&(wa=a.ef(f,c));f<l;){if(ia){if(6===(b.As(f,c-1)&6)){var Ua=this.Sq.TI(b,f,c-1),kb=a.ef(Ua.te,Ua.me);H&&Q?Q=this.wNb(Q,kb,Ua.te,Ua.me,6,y):Al.etc(6,kb,y)}f+1<l&&(ia=a.ef(f+1,c-1))}wa&&(5===(b.As(f,c)&5)&&(Ua=this.Sq.TI(b,f,c),kb=a.ef(Ua.te,Ua.me),H&&Q?Q=this.wNb(Q,kb,Ua.te,Ua.me,5,y):Al.etc(5,kb,y)),f+1<l&&(wa=a.ef(f+1,c)));f+=1}}S7d(a,b,c,f,l,y){if(c&&c!==b.PR)for(;f<l;f++)if(6===(b.As(f,c-1)&6)&&
5===(b.As(f,c)&5)){var H=this.Sq.TI(b,f,c-1),Q=this.Sq.TI(b,f,c);H=a.ef(H.te,H.me);Q=a.ef(Q.te,Q.me);y?this.rvb(Q,H,5,6):this.rvb(H,Q,6,5)}}ZZe(a,b,c,f,l,y,H=!1){let Q=this.JA.sXc(a),ia=null;0<c&&(ia=a.ef(c-1,f));let wa=null;for(c<b.fP&&(wa=a.ef(c,f));f<l;){if(ia){if(9===(b.As(c-1,f)&9)){var Ua=this.Sq.TI(b,c-1,f),kb=a.ef(Ua.te,Ua.me);H&&Q?Q=this.wNb(Q,kb,Ua.te,Ua.me,0,y):Al.etc(0,kb,y)}f+1<l&&(ia=a.ef(c-1,f))}wa&&(5===(b.As(c,f)&5)&&(Ua=this.Sq.TI(b,c,f),kb=a.ef(Ua.te,Ua.me),H&&Q?Q=this.wNb(Q,kb,
Ua.te,Ua.me,7,y):Al.etc(7,kb,y)),f+1<l&&(wa=a.ef(c,f)));f+=1}}vKh(a,b,c,f){var l=null;if(!({te:f}=Al.IKh(b,c,f)).returnValue)return{returnValue:!1,Zla:l};l=6;0<c&&Al.TAb(b,f,c-1)?(b=this.Sq.TI(b,f,c-1),a=this.Rb.Lc(a.ef(b.te,b.me))):(l=5,b=this.Sq.TI(b,f,c),a=this.Rb.Lc(a.ef(b.te,b.me)));l=this.I8f(a,l);return{returnValue:!0,Zla:l}}rKh(a,b,c,f){const l=Al.BKh(b,c,f);if(!l.returnValue)return{returnValue:!1,Zla:null};f=0;0<c&&Al.Ucb(b,l.me,c-1)?(b=this.Sq.TI(b,c-1,l.me),a=this.Rb.Lc(a.ef(b.te,b.me))):
(f=7,b=this.Sq.TI(b,c,l.me),a=this.Rb.Lc(a.ef(b.te,b.me)));return{returnValue:!0,Zla:this.I8f(a,f)}}wNb(a,b,c,f,l,y){const H=b.rowSpan;b=b.colSpan;for(let Q=c;Q<c+H;Q++)for(let ia=f;ia<f+b;ia++)a.wNb(Q,ia,l,y);return a}I8f(a,b){a=a.Cq;if(!a||!a.cellShading)return null;let c=null;({Zla:c}=this.gl.J7e(b,a.cellShading));return c}rvb(a,b,c,f){if(a!==b&&!a.id.equals(b.id)){var l=null;b.cellShading&&(l=cl.a.NTa(b,zb.a.cellShading));l&&({Zla:b}=this.gl.J7e(f,l),Al.etc(c,a,b))}}pJl(a,b,c,f,l){let y;({te:y}=
Al.IKh(c,f,l)).returnValue&&(l=6,0<f&&Al.TAb(c,y,f-1)?c=this.Sq.TI(c,y,f-1):(l=5,c=this.Sq.TI(c,y,f)),b=b.ef(c.te,c.me),this.rvb(a,b,6,l))}oJl(a,b,c,f,l){let y;({me:y}=Al.BKh(c,f,l)).returnValue&&(l=0,0<f&&Al.Ucb(c,y,f-1)?c=this.Sq.TI(c,f-1,y):(l=7,c=this.Sq.TI(c,f,y)),b=b.ef(c.te,c.me),this.rvb(a,b,0,l))}static etc(a,b,c){let f=null;b.cellShading&&(f=b.cellShading);if(f){switch(a){case 7:f.lnTField=c;break;case 0:f.lnBField=c;break;case 5:f.lnLField=c;break;case 6:f.lnRField=c}b.cellShading=f}}static IKh(a,
b,c){let f,l;f=c;l=c+1;if(!Al.Ucb(a,b,c))return{returnValue:!1,te:f,eg:l};for(;0<f&&!(0<b&&Al.TAb(a,f,b-1))&&!(b<a.PR&&Al.TAb(a,f,b));f--);for(;l<a.fP&&!(0<b&&Al.TAb(a,l,b-1))&&!(b<a.PR&&Al.TAb(a,l,b));l++);return{returnValue:!0,te:f,eg:l}}static BKh(a,b,c){let f;f=c;for(c+=1;0<f&&!(0<b&&Al.Ucb(a,f,b-1))&&!(b<a.fP&&Al.Ucb(a,f,b));f--);for(;c<a.PR&&!(0<b&&Al.Ucb(a,c,b-1))&&!(b<a.fP&&Al.Ucb(a,c,b));c++);return{returnValue:!0,me:f,Tf:c}}static Ucb(a,b,c){return 0<b&&!(a.As(c,b-1)&2)||b<a.PR&&!(a.As(c,
b)&1)?!1:!0}static TAb(a,b,c){return 0<b&&!(a.As(b-1,c)&8)||b<a.fP&&!(a.As(b,c)&4)?!1:!0}}Object(m.a)(Al,"TableBorderEditor",null,[1050,1051]);class ZL{constructor(a,b,c,f){this.mue=!1;this.a1=a;this.erk=b;this.pHb=c;this.MBe=f;this.ui=Array(this.a1.dV);for(a=0;a<this.a1.dV;a++)for(this.ui[a]=Array(this.a1.Bsa),b=0;b<this.a1.Bsa;b++)this.ui[a][b]=new xq.a}lbj(a,b,c){this.mue||(this.erk.Jbl(a,this.a1),this.mue=!0);if(eb.a("BugFixCacheInvalidIndex")){if(this.ui&&0<=b&&b<this.ui.length&&this.ui[b]&&
0<=c&&c<this.ui[b].length)return this.ui[b][c];a=String.format("GetBorderStylePropertySet : Illegal cache access m_cache : {0} ,  row : {1}, col : {2} ",this.ui,b,c);this.ui&&(a+=String.format(" m_cache.Length : {0} ",this.ui.length),a=this.ui[b]?a+String.format(" m_cache[ row ].Length : {0} ",this.ui[b].length):a+" m_cache[ row ] is null ");xa.a.J(559724692,822,15,a);return null}return this.ui[b][c]}wNb(a,b,c,f){var l=this.pHb.Brh(c,this.a1.Ed,f);a=this.ui[a][b];for(var y of l.mA())a.ye(y,l.Rh(y));
this.MBe&&eb.a("TableBordersLocalRenderingFix")&&({kRa:l,Y7a:c,Mtb:y}=cq.kUa(c),f.wFieldSpecified&&(f.noFillField?a.ye(l,0):a.ye(l,xe.a.X4d(f.wField))),f.solidFillField&&a.ye(c,f.solidFillField),f.prstDashField&&a.ye(y,f.prstDashField))}dispose(){this.ui=null;this.mue=!1}}Object(m.a)(ZL,"TableBorderStyleCache",null,[1052,107]);class aE{constructor(a){this.ODe=a?1:0}BRd(a){const b=a.qA;a=a.JE;return b.me%2===this.ODe&&a.Rwb(b)}}Object(m.a)(aE,"BandedColumnFilter",null,[514]);class bE{constructor(a){this.ODe=
a?1:0}BRd(a){const b=a.qA;a=a.JE;return b.te%2===this.ODe&&a.Rwb(b)}}Object(m.a)(bE,"BandedRowFilter",null,[514]);class $L{constructor(){this.diagBL2TR=this.right=this.insideVer=this.left=this.diagTL2BR=this.bottom=this.insideHor=this.top=null}mbj(){let a=0;this.top&&(a|=1);this.insideHor&&(a|=2);this.bottom&&(a|=4);this.diagTL2BR&&(a|=8);this.left&&(a|=16);this.insideVer&&(a|=32);this.right&&(a|=64);this.diagBL2TR&&(a|=128);return a}Yyb(a){switch(a){case 1:return this.top;case 2:return this.insideHor;
case 4:return this.bottom;case 8:return this.diagTL2BR;case 16:return this.left;case 32:return this.insideVer;case 64:return this.right;case 128:return this.diagBL2TR;default:return null}}}Object(m.a)($L,"TableBorderSet",null,[]);class aM{constructor(a,b){this.M5=a;this.krk=b}Jbl(a,b){const c=b.dV,f=b.Bsa;var l=b.tableLook;b=b.tableStyle;const y=this.krk.create(a),H=!!(l&32)&&!!b.firstRowField,Q=!!(l&64)&&!!b.lastRowField,ia=!!(l&128)&&!!b.firstColField,wa=!!(l&256)&&!!b.lastColField,Ua=H&&ia&&!!b.nwCellField,
kb=H&&wa&&!!b.neCellField,Gb=Q&&ia&&!!b.swCellField,ec=Q&&wa&&!!b.seCellField;var dc=!(l&512)&&!!b.band1HField,Fc=!(l&512)&&!!b.band2HField,yc=!(l&1024)&&!!b.band1VField;const tc=!(l&1024)&&!!b.band2VField;l=new yr.a;b.wholeTblField&&(l.te=0,l.eg=c,l.me=0,l.Tf=f,this.apply(a,y,b.wholeTblField,l));l.te=H?1:0;l.eg=c-(Q?1:0);l.me=0;l.Tf=f;dc&&(dc=new bE(H),this.apply(a,y,b.band1HField,l,dc));Fc&&(Fc=new bE(!H),this.apply(a,y,b.band2HField,l,Fc));l.te=0;l.eg=c;l.me=ia?1:0;l.Tf=f-(wa?1:0);yc&&(yc=new aE(ia),
this.apply(a,y,b.band1VField,l,yc));tc&&(yc=new aE(!tc),this.apply(a,y,b.band2VField,l,yc));wa&&(l.te=0,l.eg=c,l.me=f-1,l.Tf=f,this.apply(a,y,b.lastColField,l));ia&&(l.te=0,l.eg=c,l.me=0,l.Tf=1,this.apply(a,y,b.firstColField,l));Q&&(l.te=c-1,l.eg=c,l.me=0,l.Tf=f,this.apply(a,y,b.lastRowField,l),ec&&(l.me=f-1,l.Tf=f,this.apply(a,y,b.seCellField,l)),Gb&&(l.me=0,l.Tf=1,this.apply(a,y,b.swCellField,l)));H&&(l.te=0,l.eg=1,l.me=0,l.Tf=f,this.apply(a,y,b.firstRowField,l),kb&&(l.me=f-1,l.Tf=f,this.apply(a,
y,b.neCellField,l)),Ua&&(l.me=0,l.Tf=1,this.apply(a,y,b.nwCellField,l)))}apply(a,b,c,f,l=null){if(!f.eTa()&&c&&c.tcStyleField&&(c=c.tcStyleField.tcBdrField)){const y=new $L;c.topField&&c.topField.itemField&&(y.top=c.topField.itemField);c.bottomField&&c.bottomField.itemField&&(y.bottom=c.bottomField.itemField);c.insideHField&&c.insideHField.itemField&&(y.insideHor=c.insideHField.itemField);c.leftField&&c.leftField.itemField&&(y.left=c.leftField.itemField);c.rightField&&c.rightField.itemField&&(y.right=
c.rightField.itemField);c.insideVField&&c.insideVField.itemField&&(y.insideVer=c.insideVField.itemField);this.M5.wZe(a,b,f,y,l)}}}Object(m.a)(aM,"TableBorderStyleResolver",null,[401]);class Tv{constructor(){}vxi(a,b){const c=new yr.a;if(a.eTa())return c;const f=Tv.r0f(b,a,a.te,!0),l=Tv.r0f(b,a,a.eg-1,!1),y=Tv.T_f(b,a,a.me,!0);a=Tv.T_f(b,a,a.Tf-1,!1);c.te=f;c.eg=l+1;c.me=y;c.Tf=a+1;return c}RTj(a,b){for(var c=a.te;c<a.eg;++c)if(!(b.As(c,a.me)&1&&b.As(c,a.Tf-1)&2))return!1;for(c=a.me;c<a.Tf;++c)if(!(b.As(a.te,
c)&4&&b.As(a.eg-1,c)&8))return!1;return!0}M4f(a){let b;b=null;const c=new yr.a;if(!(a&&a.Sl&&a.mb&&a.N6))return{returnValue:c,tableNode:b};var f=a.ga(0).qg.Va,l=Object(qa.a)(Vl.TableCellNode,f.node);l&&(b=l.getContainingTable());if(!l||!b)return{returnValue:c,tableNode:b};f=l.rowIndex;l=l.Ai;var y=Object(qa.a)(Vl.TableCellNode,a.ga(0).qg.jf.node);var H=0;y&&(H=y.Ai+1);if(b.Op()&&1!==a.length){H=Object(qa.a)(Vl.TableCellNode,a.c2a.currentNode);f=Object(qa.a)(Vl.TableCellNode,a.nka.currentNode);if(!H||
!f)return{returnValue:c,tableNode:b};l=H.rowIndex;a=H.Ai;y=f.rowIndex;H=f.Ai;f=Math.min(l,y);y=Math.max(l,y)+1;l=Math.min(a,H);H=Math.max(H,a)+1}else y=f+a.length;c.te=f;c.eg=y;c.me=l;c.Tf=H;return{returnValue:c,tableNode:b}}TI(a,b,c){b=Object.assign(new yr.a,{te:b,eg:b+1,me:c,Tf:c+1});return this.VRc(a,b)}VRc(a,b){const c=new yr.a;let f=b.te,l=b.eg-1;for(var y=b.me;y<b.Tf;y++){for(var H=b.te;0<H&&!(a.As(H,y)&4);H--);H<f&&(f=H);H=b.eg-1;for(var Q=a.fP-1;H<Q&&!(a.As(H,y)&8);H++);H>l&&(l=H)}y=b.me;
H=b.Tf-1;for(Q=b.te;Q<b.eg;Q++){let ia=b.me;for(;0<ia&&!(a.As(Q,ia)&1);ia--);ia<y&&(y=ia);ia=b.Tf-1;for(const wa=a.PR-1;ia<wa&&!(a.As(Q,ia)&2);ia++);ia>H&&(H=ia)}c.te=f;c.me=y;c.Tf=H+1;c.eg=l+1;return c}static r0f(a,b,c,f){if(f)for(;0<c;c--)for(f=b.me;f<b.Tf;++f){if(a.As(c,f)&4)return c}else for(f=a.fP-1;c<f;c++)for(let l=b.me;l<b.Tf;++l)if(a.As(c,l)&8)return c;return c}static T_f(a,b,c,f){if(f)for(;0<c;c--)for(f=b.te;f<b.eg;++f){if(a.As(f,c)&1)return c}else for(f=a.PR-1;c<f;++c)for(let l=b.te;l<
b.eg;++l)if(a.As(l,c)&2)return c;return c}}Object(m.a)(Tv,"TableCellSelectionHelper",null,[396]);class bM{constructor(a,b,c){this.fR=null;this.S4=!1;if(!a||!a.isConnected||14!==a.type)throw Error.argument("tableNode");this.ge=a;this.zc=b;this.fY=c;this.OX=3}o$e(){try{var a=ob.GraphIterator.pb(this.ge);Sd.forEachCellInTable(a,(b,c,f)=>{var l=Object(qa.a)(130,b.currentNode);if(l&&!l.isGhostCell){b=l.rowSpan+c;l=l.colSpan+f;for(let y=c;y<b;++y)for(let H=f;H<l;++H)y===c&&(this.fR[y][H]|=4),y===b-1&&(this.fR[y][H]|=
8),H===f&&(this.fR[y][H]|=1),H===l-1&&(this.fR[y][H]|=2)}return!0})}catch(b){a=this.fY.z4d(this.ge),xa.a.J(38043909,822,15,"TableLayoutInfo:{0}, Message:{1}",a,b.message)}}validate(){if(this.S4)throw Error.invalidOperation("cache disposed");if(0!==this.OX){if(3===(this.OX&3)){const a=this.zc.Gk(this.ge),b=this.zc.Gi(this.ge);this.fR=Array(a);for(let c=0;c<a;++c){this.fR[c]=Array(b);for(let f=0;f<b;++f)this.fR[c][f]=0}}1===(this.OX&1)&&this.o$e();this.OX=0}}As(a,b){try{this.validate();var c=this.fR[a][b]}catch(f){c=
this.fY.z4d(this.ge),xa.a.J(38043911,822,15,"NumRows:{0} NumCols:{1} Row:{2} Col:{3}, TableLayoutInfo:{4}, Message:{5}",this.fP,this.PR,a,b,c,f.message),c=0}return c}vVa(a){this.OX|=a}dispose(){this.S4=!0;this.fR=null}get fP(){this.validate();return this.fR?this.fR.length:0}get PR(){this.validate();return this.fR&&this.fR.length?this.fR[0].length:0}}Object(m.a)(bM,"TableInfoCache",null,[512,107]);class cM{constructor(a,b){this.zc=a;this.fY=b}create(a){return new bM(a,this.zc,this.fY)}}Object(m.a)(cM,
"TableInfoCacheFactory",null,[407]);class Sz{constructor(a,b,c,f,l,y){this.zpk=a;this.ufk=b;this.nrk=c;this.Vkk=f;this.Mrk=l;this.srk=y}get dV(){return this.zpk()}get Bsa(){return this.ufk()}get tableLook(){return this.nrk()}get p9j(){return this.Vkk()}get Ed(){return this.Mrk()}get tableStyle(){return this.srk()}static qQf(a,b,c,f,l,y){return new Sz(a,b,c,f,l,y)}}Object(m.a)(Sz,"TableListStyleParams",null,[466]);class dM{constructor(a){this.Qna=null;this.V9c=!1;this.FGe=this.mDb=null;this.Rb=a}get oVj(){return!!this.mDb}thh(a,
b){this.FGe=a.id.toString();this.V9c=!this.Rb.Vhj(a).currentNode.qc(b).d2c();this.mDb=null;this.V9c&&(a=a.qc(b),this.j_i(),Ea.a.T2b(a.htmlElement,this.Qna),this.mDb=this.r5i(this.Qna))}g7b(a,b,c,f){if(a.id.toString()!==this.FGe)throw Error.argument("table","Wrong table metrics");if(this.V9c){if(!this.mDb)throw Error.invalidOperation("m_clonedTableNode is null");a=this.mDb.rows[c].cells[f];c=a.lastChild;c.className!==b.className&&(ka.ULS.sendTraceTag(587465758,808,10,"Cell content DOM structure changed, last child {0}",
c.className),c=Ea.a.Nda(a,b.className));if(!c)throw Error.invalidOperation("No content");b=c}return b.offsetHeight}reset(){Ea.a.LVa(this.Qna)&&this.Qna.parentNode.removeChild(this.Qna);this.mDb=this.Qna=null;this.V9c=!1;this.FGe=null}z4d(a){const b=new Sys.StringBuilder;try{b.append(String.format("Row:{0},Col:{1},",a.properties.sa(ab.a.Nza,0),a.properties.sa(ab.a.dha,0)));const c=this.Rb.Lc(a);Sd.forEachCellInTable(c,(f,l,y)=>{var H=f.currentNode;f=H.rowSpan;H=H.colSpan;(1<f||1<H)&&b.append(String.format("C[{0}][{1}]:{2}|{3},",
l,y,f,H));return!0});return b.toString()}catch(c){return b.append(c.message),b.toString()}}j_i(){this.Qna||(this.Qna=document.createElement("div"),this.Qna.className="TableMetricsWorkingDiv",document.body.appendChild(this.Qna));Ea.a.$Ca(this.Qna)}r5i(a){for(a=a.firstChild;a;){if("table"===a.nodeName.toLowerCase())return a;a=a.nextSibling}return null}}Object(m.a)(dM,"TableMetrics",null,[404]);class eM{constructor(a){this.JA=a}Kbl(a,b,c){return b&&a&&c&&(a=this.JA.uXc(a).d6f(c,b.rowIndex,b.Ai,b.rowSpan,
b.colSpan))&&a!==rc.a.auto?a.PD:-1}}Object(m.a)(eM,"TableThemeColorHelper",null,[408]);class fM{constructor(a){this.Sq=a}IPi(a,b){return new $D(a,this.Sq,b)}}Object(m.a)(fM,"VerticalTableBorderIteratorFactory",null,[400]);class cE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Table"}Yb(a){this.K=a;this.K.register(396,"PowerPointWebEditor.ITableCellSelectionHelper").ma().oa(()=>new Tv);a.register(397,"Box4.ITableDragSelectionCellExtendStrategy").ma().oa(()=>new BL(this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),
this.K.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),this.K.resolve("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter")));this.K.register(Al,"PowerPointWebEditor.TableBorderEditor").as("PowerPointWebEditor.ITableBorderEditor").as("PowerPointWebEditor.ITableBorderHelper").ma().oa(()=>new Al(this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader"),
this.K.resolve("PowerPointWebEditor.ICellIteratorFactory"),this.K.resolve("PowerPointWebEditor.IHorizontalTableBorderIteratorFactory"),this.K.resolve("PowerPointWebEditor.IVerticalTableBorderIteratorFactory")));this.K.register(398,"PowerPointWebEditor.ICellIteratorFactory").ma().oa(()=>new SL(this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));this.K.register(399,"PowerPointWebEditor.IHorizontalTableBorderIteratorFactory").ma().oa(()=>new TL(this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));
this.K.register(400,"PowerPointWebEditor.IVerticalTableBorderIteratorFactory").ma().oa(()=>new fM(this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));this.K.register(401,"PowerPointWebEditor.ITableBorderStyleResolver").ma().oa(()=>new aM(this.K.resolve("PowerPointWebEditor.ITableBorderEditor"),this.K.resolve("PowerPointWebEditor.ITableInfoCacheFactory")));this.K.register(pm,"PowerPointWebEditor.TableEditor").as("PowerPointWebEditor.ITableEditor").as("Box4.ITableEditor").ma().oa(()=>
new pm(this.K.resolve("Box4.IOutlineEditor"),this.K.resolve("Box4.IOutlineElementEditor"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("PowerPointWebEditor.Graph.ITableRowReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerPointWebEditor.ITableBorderEditor"),this.K.resolve("PowerPointWebEditor.ITableInfoCacheFactory"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,this.K.resolve("Box4.IPageView").Na));this.K.register(VD,"PowerPointWebEditor.TableNodeBehavior").ma().oa(()=>new VD(this.K.resolve("Box4.Graph.IGraphInstance").yd(14),this.K.resolve("Box4.ITableNodeBehaviorHelper"),this.K.resolve("Box4.IPageView").Na,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Kee));this.K.register(279,"PowerPointWebEditor.ITableStyleReaderHelper").ma().oa(()=>new cq(this.K.resolve("Box4.IPageView").Md,
this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.ITableStyleResolver"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").g3c));this.K.register(Oz,"PowerPointWebEditor.TableStyleReader").as("Box4.Styles.ITableStyleReader").as("PowerPointWebEditor.IPPTTableStyleReader").as("PowerPointWebEditor.ITableStyleCacheHelper").ma().oa(()=>new Oz(this.K.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),
this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IPptListCore"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("Box4.IPageView").Md,this.K.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),this.K.resolve("Box4.Graph.IGraphInstance").yd(14),this.K.resolve("PowerPointWebEditor.IPresentationReader"),Sz.qQf,b=>new XD(b,a.resolve("PowerPointWebEditor.ITableStyleResolver")),b=>new UD(b),b=>new ZL(b,a.resolve("PowerPointWebEditor.ITableBorderStyleResolver"),
a.resolve("PowerPointWebEditor.ITableStyleResolver"),a.resolve("PowerPointWebEditor.IApplicationSettings").Faa),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.ITableRowReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").qmg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").k4j,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptNewResolveTableBorderStyleEnabled,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptRenderNonActiveTableAsyncEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Faa));this.K.register(402,"PowerPointWebEditor.ITableStyleResolver").ma().oa(()=>new NL(this.K.resolve("PowerPointWebEditor.IApplicationSettings").Faa));this.K.register(403,"PowerPointWebEditor.ITableStyleGalleryManager").ma().oa(()=>new QL(this.K.Ia("PowerPointWebEditor.IPresentationResourcesManager")));this.K.register(404,"PowerPointWebEditor.ITableMetrics").ma().oa(()=>
new dM(this.K.resolve("Box4.Graph.IGraphIteratorFactory")));this.K.register(405,"PowerPointWebEditor.IPPTTableLayoutServiceFactory").ma().oa(()=>new XL(this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Box4.ITableCellReader"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.ITableMetrics")));this.K.register(406,"PowerPointWebEditor.IPPTTableLayoutServiceManager").ma().oa(()=>new YL(this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceFactory"),
this.K.resolve("Common.IBrowserUtils"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.Graph.IGraphInstance").yd(14),this.K.resolve("Box4.Graph.IGraphInstance").yd(15),this.K.resolve("Box4.Graph.IGraphInstance").yd(16),this.K.resolve("Box4.Graph.IGraphInstance").yd(12),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptComplexTableLayoutSyncEnabled));this.K.register(SD,"PowerPointWebEditor.TableCellNodeBehavior").ma().oa(()=>
new SD(this.K.resolve("Box4.Graph.IGraphInstance").yd(16),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.ITableNavigator"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader")));this.K.register(xL,"Box4.TableReaderProxy").as("Box4.ITableReader").ma();this.K.register(yL,"Box4.TableRowReaderProxy").as("Box4.ITableRowReader").ma();this.K.register(AR.a,"Box4.TableCellReaderProxy").as("Box4.ITableCellReader").ma();this.K.register(407,"PowerPointWebEditor.ITableInfoCacheFactory").ma().oa(()=>
new cM(this.K.resolve("Box4.ITableReader"),this.K.resolve("PowerPointWebEditor.ITableMetrics")));this.K.register(408,"PowerPointWebEditor.ITableThemeColorHelper").ma().oa(()=>new eM(this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader")))}init(){const a=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,b=this.K.resolve("Common.IActionManagerExtended");this.K.resolve("PowerPointWebEditor.ITableThemeColorHelper");this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").OLb(1,
new Sv(this.K.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("PowerPointWebEditor.ITableEditor"),this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?this.K.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):
null,a),new JL(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("Common.CursorManager"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,this.K.resolve("PowerPointWebEditor.TableEditor"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("Box4.Styles.ITableStyleReader"),this.K.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),this.K.resolve("PowerPointWebEditor.IViewElementHelper"),b,a),new IL(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("Common.CursorManager"),this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,this.K.resolve("PowerPointWebEditor.TableEditor"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),
this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.Styles.ITableStyleReader"),b,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptIsTableColumnRowResizeHandleRenderedByCSSEnabled,a));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393250,new bm.a((c,f)=>new Ll(c,f,this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader"),
this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPoint.IBrowserHelperManager"),l=>Yx.f3b(l),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceManager"),this.K.resolve("PowerPointWebEditor.Core.IPkgLoadStatusContext"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IZoomContext"),
this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ISlideDimensionsHelper"))));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393251,new bm.a((c,f)=>new Rv(c,f,new Xb.a(c,f,Xb.a.cEl))));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393252,new AL(this.K.resolve("Box4.ITableCellReader"),this.K.resolve("Box4.Styles.IStyleReader"),
new bm.a((c,f)=>new st(c,f,this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventNotifier"),this.K.resolve("Box4.ITableReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptIsTableColumnRowResizeHandleRenderedByCSSEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").ela,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Faa,this.K.resolve("PowerPointWebEditor.IPptSelectionManager")))));fb.StyleReader.xr=this.K.resolve("Box4.Styles.ITableStyleReader");this.K.resolve("PowerPointWebEditor.TableNodeBehavior");this.K.resolve("PowerPointWebEditor.TableCellNodeBehavior");this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceManager")}dispose(){this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceManager").dispose()}static main(){n.a.instance.Ac(new cE)}}
Object(m.a)(cE,"PPTWebEditorTablePackage",null,[2,3]);var DR=d(1276),Vh=d(111);class gM{constructor(){this.podsUrl=this.fileUrl=null}}Object(m.a)(gM,"IFileInfo",null,[]);class hM extends Sys.EventArgs{constructor(a){super();this.slideIndex=a.SlideIndex}}Object(m.a)(hM,"OnPresenterViewSyncMessageEventArgs",Sys.EventArgs,[]);class iM{constructor(){this.messageType=0;this.data=this.sender=null}}Object(m.a)(iM,"IPresentationMessage",null,[]);class jM{constructor(){this.useDefaultResourceProvider=this.thumbnailsEnabled=
!1;this.presenterWindowWidth=this.presenterWindowHeight=0}}Object(m.a)(jM,"IPresenterViewSettings",null,[]);class kM{constructor(){this.uiHost=this.userSessionId=null}}Object(m.a)(kM,"ISessionInfo",null,[]);var ER=d(545);class lM{constructor(a,b,c){this.BO="";this.x0=null;this.mfb=!1;this.kGb=null;this.xa=new Pc.a;this.ia=a;this.la=b;this.Ic=c;this.ESk()}vb(){this.ia.ra(ea.a.ALb,hc.a.application,Object(I.a)(this,this.ALb,"queryUsePresenterView"),96);this.ia.ya(ea.a.a$e,hc.a.application,Object(I.a)(this,
this.QGl,"toggleUsePresenterView"));this.ia.ya(ea.a.qud,yb.a.application,Object(I.a)(this,this.qud,"showPresenterView"));this.ia.ya(ea.a.OMc,hc.a.application,Object(I.a)(this,this.OMc,"closePresenterView"));this.mfb=w.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")}ALb(a,b,c,f,l){(a=Object(qa.a)(Vh.a,l))&&a.Hf(this.mfb);return 32}QGl(a,b,c){if(1===c&&!w.AFrameworkApplication.fa.ka("PptPresenterViewEnabled"))return xa.a.J(512496092,830,10,"PresenterViewManager: presenter view is not enabled but ToggleUsePresenterView is triggered."),
8;2===c&&(this.mfb=!this.mfb,this.Ic.Py(new dq.a(1)));return 32}qud(a,b,c){try{if(!w.AFrameworkApplication.fa.ka("PptPresenterViewEnabled"))return xa.a.J(512496091,822,10,"PresenterViewManager: ShowPresenterView triggered but feature is disabled by BRS."),2;if(2===c&&0<this.BO.length){if(!this.kGb){const f=this.la.podsWebServiceBase,l=String.format("{0}presenter.aspx",f),y=new gM;y.fileUrl=this.BO;y.podsUrl=f;const H=new kM;H.userSessionId=w.AFrameworkApplication.userSessionId;H.uiHost="UnifiedApp";
const Q=new jM;Q.presenterWindowWidth=1024;Q.presenterWindowHeight=576;this.kGb=new PresenterView.PresentationProxy(2,l,y,H,Q)}this.kGb.startPresentation();this.kGb.subscribe(Object(I.a)(this,this.dGk,"onPresentationChannelMessageHandler"))}return 32}catch(f){return xa.a.J(512496090,822,10,"PresenterViewManager: Failed to handle ShowPresenterView: {0}",f),16}}OMc(a,b,c){2===c&&(xa.a.J(512496089,822,50,"PresenterViewManager: ClosePresenterView called"),this.kGb.terminatePresentation());return 32}Sgi(a){this.xa.addHandler("OnPresenterViewSyncMessageReceived",
a)}Thl(a){a=this.Ani(a);this.kGb.sendMessage(a)}Ani(a){const b=new iM;b.sender="slideshow";b.messageType=1;b.data=JSON.stringify({["slideLocation"]:{["slideId"]:{["sid"]:a.slideId,["cid"]:0},["slideIndex"]:a.slideIndex},["timelineMappings"]:a.$vc});return b}dGk(a){try{if(!a||0>=a.length)xa.a.J(512496088,830,15,"No message");else{var b=JSON.parse(a),c=b.sender;if(c&&"slideshow"!==c)switch(b.messageType||xa.a.J(512496087,830,15,"No message"),b.messageType){case 1:const l=b.data;if(l&&!(0>=l.length)){var f=
JSON.parse(l).slideLocation.slideIndex;this.xa.raiseEvent("OnPresenterViewSyncMessageReceived",new hM({["SlideIndex"]:f}))}}}}catch(l){xa.a.J(512496086,830,10,"Exception: {0}",l)}}ESk(){var a=Ib.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,b=Ib.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;a=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",b,a);b=new DR.a(w.AFrameworkApplication.Me);this.x0=ER.b(b.cZe(a));this.x0.then(c=>
{try{const f=JSON.parse(c),l=f.downloadUrl;ma.a.Xa(l)?xa.a.J(512496085,822,10,"PresenterViewManager: GetSnappedDownloadLink returned a bad response: {0}",f):this.BO=l}catch(f){xa.a.J(512496084,822,10,"PresenterViewManager: Failed to retreive document download URL: {0}",f)}return null})}}Object(m.a)(lM,"PresenterViewManager",null,[237]);class dE{constructor(){this.nb=this.la=this.K=null;this.GJg=!1}get name(){return"PowerPointWebEditor.PresenterView"}Yb(a){this.K=a;this.la=this.K.resolve("PowerPointWebEditor.IApplicationSettings");
this.nb=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame").SF()}init(){w.AFrameworkApplication.fa.ff(Object(I.a)(this,this.en,"onFullAppSettingsReady"))}en(){try{(this.GJg=w.AFrameworkApplication.fa.ka("PptPresenterViewEnabled"))&&this.K.resolve("Common.IDynamicScriptLoaderProvider").rI.loadScript("presenterView").catch(a=>xa.a.J(594031833,830,10,"Failed to load presenterView js: {0}",a)).then(()=>this.fGk()).catch(a=>xa.a.J(594031831,830,10,"Failure in OnPresenterScriptLoaded: {0}",a))}catch(a){ka.ULS.sendTraceTag(594031830,
811,10,"PPTWebEditorPresenterViewPackage: exception in OnFullAppSettingsReady: {0}",a)}}fGk(){this.g3b();return null}g3b(){const a=document.createElement("link");a.setAttribute("rel","stylesheet");a.setAttribute("type","text/css");a.setAttribute("href",w.AFrameworkApplication.fa.Ha("PPTPresenterViewCssUrl"));this.nb.appendChild(a);this.K.register(237,"PowerPointWebEditor.PresenterView.IPresenterViewManager").oa(()=>new lM(w.AFrameworkApplication.Ra,this.la,this.K.resolve("PowerPointWebEditor.View.IViewEventSource"))).ma();
this.K.resolve("PowerPointWebEditor.PresenterView.IPresenterViewManager").vb()}dispose(){}static main(){n.a.instance.Ac(new dE)}}Object(m.a)(dE,"PPTWebEditorPresenterViewPackage",null,[2,3]);class mM{constructor(a){this.Uea=a}jPi(a,b,c){if(c.eTa())return null;a=this.Uea.iEa(a,b,c);for(b=Array(b.fP);a.moveNext();){c=a.f7b();var f=a.qA;b[f.te]||(b[f.te]=[]);f=b[f.te];f[f.length]=pr.TableNodeContext.create(c)}a=[];for(c=0;c<b.length;++c)b[c]&&(a[a.length]=new Lb.Selection(b[c],!0));return new Ya.SelectionCollection(a,
a.length-1,0)}}Object(m.a)(mM,"PPTSelectionFactory",null,[235]);class nM{constructor(a,b,c,f){this.sBe=this.Ina=this.rue=null;this.E8h=a;this.pVh=b;this.Sq=c;this.rZa=f}get Vxi(){return this.pVh}get yub(){this.rue||(this.rue=this.Sq.vxi(this.Vxi,this.eZ));return this.rue}get tableNode(){return this.E8h}get eZ(){this.Ina||(this.Ina=this.rZa.create(this.tableNode));return this.Ina}get M1j(){this.sBe||(this.sBe=this.Sq.RTj(this.yub,this.eZ));return this.sBe}}Object(m.a)(nM,"TableCellSelectionInfo",null,
[]);class oM{constructor(a,b){this.rZa=a;this.Sq=b}create(a,b){return new nM(b,a,this.Sq,this.rZa)}}Object(m.a)(oM,"TableCellSelectionInfoFactory",null,[233]);var FR=d(1039);class pM{constructor(a,b,c){this.F_g=a;this.Sq=b;this.gHa=c}H8b(a){let b=null;const c=new Date,f=({tableNode:a}=this.Sq.M4f(a)).returnValue,l=!f.eTa();l&&(b=this.F_g.create(f,a),Nc.a.Kb&&Nc.a.Kb.Wa("CellRange",f.toString()));xa.a.J(512495623,808,l?50:10,"Table cell selection range {0}, took {1}",f.toString(),+new Date-+c);return b}jsj(a){if(!a)return null;
var b=this.gHa.mB(a);let c=a=null;for(let l=0;l<b.length;++l)if(b[l].Pk){var f=Object(qa.a)(5,b[l].node);if(f){f=f.AL();if(!f)return null;if(!a)a=f,c=a.id.toString();else if(c!==f.id.toString())return null}}if(!a)return null;b=Object.assign(new yr.a,{te:a.rowIndex,me:a.Ai});b.eg=b.te+1;b.Tf=b.me+1;return this.F_g.create(b,a.getContainingTable())}}Object(m.a)(pM,"TableSelectionAdapter",null,[234]);class eE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TableMergeSplit"}Yb(a){this.K=
a;this.K.register(233,"PowerPointWebEditor.ITableCellSelectionInfoFactory").ma().oa(()=>new oM(this.K.resolve("PowerPointWebEditor.ITableInfoCacheFactory"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));this.K.register(234,"PowerPointWebEditor.ITableSelectionAdapter").ma().oa(()=>new pM(this.K.resolve("PowerPointWebEditor.ITableCellSelectionInfoFactory"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),this.K.resolve("Box4.IContextSetEditor"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),
this.K.resolve("Box4.ITableRowReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),this.K.resolve("Box4.ITableNavigator")));this.K.register(235,"PowerPointWebEditor.ISelectionFactory").ma().oa(()=>new mM(this.K.resolve("PowerPointWebEditor.ICellIteratorFactory")));this.K.register(236,"PowerPointWebEditor.ITableMergeSplitEditor").ma().oa(()=>new FR.TableMergeSplitEditor(this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.ITableNavigator"),this.K.resolve("Box4.Styles.ITableStyleReader"),
this.K.resolve("PowerPointWebEditor.ITableBorderEditor"),this.K.resolve("PowerPointWebEditor.ITableBorderHelper"),this.K.resolve("PowerPointWebEditor.IGraphUtils"),this.K.resolve("PowerPointWebEditor.ITableEditor"),this.K.resolve("Box4.ITableCellReader"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),this.K.resolve("PowerPointWebEditor.ICellIteratorFactory"),this.K.resolve("Box4.IOutlineEditor"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("Common.Transaction.ITransactionFactory"),
this.K.resolve("Box4.ISelectionManager"),this.K.resolve("PowerPointWebEditor.ISelectionFactory")))}init(){}dispose(){}static main(){n.a.instance.Ac(new eE)}}Object(m.a)(eE,"PPTWebEditorTableMergeSplitPackage",null,[2,3]);class ml{constructor(a,b,c,f,l,y,H,Q){this.Yrb=a;this.IPd=b;this.Ca=c;this.GPd=f;this.Lk=l;this.Qt=y;this.hd=H;this.S0h=Q}vb(){this.yod(Rc.App.KMa.MOf())}yod(a){this.Ca.ya(C.a.uLb,yb.a.view,a);this.Ca.ya(C.a.uLb,yb.a.table,Object(I.a)(this,this.uLb,"queryTableStyle"));this.Ca.he(C.a.uLb,
103);this.Ca.ya(C.a.d_,yb.a.view,Object(I.a)(this,this.g5e,"tableStyleGenericViewActionHandler"));this.Ca.ya(C.a.d_,yb.a.table,Object(I.a)(this,this.d_,"applyTableStyle"));this.Ca.he(C.a.d_,6);this.Ca.ya(C.a.I7a,yb.a.table,Object(I.a)(this,this.d_,"applyTableStyle"));this.Ca.ya(C.a.eT,yb.a.view,Object(I.a)(this,this.g5e,"tableStyleGenericViewActionHandler"));this.Ca.ya(C.a.eT,yb.a.table,Object(I.a)(this,this.eT,"applyTableStyleOption"));this.Ca.he(C.a.eT,14);this.Ca.ya(C.a.Haa,yb.a.view,a);this.Ca.ya(C.a.Haa,
yb.a.table,Object(I.a)(this,this.Haa,"queryTableStyleOption"));this.Ca.he(C.a.Haa,103);this.Ca.ya(C.a.WJb,yb.a.view,a);this.Ca.ya(C.a.WJb,yb.a.table,Object(I.a)(this,this.WJb,"populateMenuMoreTableStyles"));this.Ca.he(C.a.WJb,102);this.Ca.ya(C.a.A8a,yb.a.view,Object(I.a)(this,this.g5e,"tableStyleGenericViewActionHandler"));this.Ca.ya(C.a.A8a,yb.a.table,Object(I.a)(this,this.A8a,"clearTableFormatting"));this.Ca.he(C.a.A8a,4)}uLb(a,b,c,f,l){if(!({GF:a}=this.Etc(b,c,l,!0,!0)).returnValue)return a;this.IPd.nLi(l,
b.node);return 32}Haa(a,b,c,f,l){return this.bgg(b,c,f,l,!0)}WJb(a,b,c,f,l){if(!({GF:a}=this.Etc(b,c,l,!1,!0)).returnValue)return a;this.IPd.sMi(l,b.node);ka.ULS.sendTraceTag(7878019,324,50,"Gallery expanded");return 32}d_(a,b,c,f,l){if(!({GF:c}=this.Etc(b,c,l,!1,!0)).returnValue)return c;const y=b.node;let H=null;(H=a===C.a.d_?this.IPd.Pvd(l[wh.a.SourceControlId],y):null)?(this.IOe(y,()=>{this.GPd.Bol(H,y)}),c=32):c=8;a===C.a.d_&&32===c&&ka.ULS.sendTraceTag(38410445,311,50,"ApplyTableStyle succeeded");
ka.ULS.shipAssertTag(541172699,324,32===c);return c}eT(a,b,c,f,l){return this.bgg(b,c,f,l,!1)}bgg(a,b,c,f,l){if(!({GF:b}=this.Etc(a,b,f,l,!0)).returnValue)return b;a=a.node;b=this.Yrb.dbe(a);const y=f[wh.a.On],H=ml.puj(w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.ob.Qp?f.MenuItemId:f[wh.a.SourceControlId]);l?f[wh.a.On]=ml.ztl(b,H):(this.xmi(b,H,y,a),c.QC=H,c.RN=y?0:1,ka.ULS.shipAssertTag(541172700,324,0!==H));return 32}g5e(a,b,c,f,l){return ii.k6(a,b,c,f,l,{},14)}IOe(a,b){const c=this.Lk.je(15);
try{c.ld(a),this.Qt.K0a(),b()}finally{c&&c.dispose()}}Etc(a,b,c,f,l){return this.x4j(a,b,c,f,l)?{returnValue:f||2===b,GF:32}:{returnValue:!1,GF:8}}x4j(a,b,c,f,l){if(a.contextId!==yb.a.table)return!1;if(f||2===b)if(l&&!c||!Object(Wa.a)(Dy.a,a.node)||this.S0h(a.node))return!1;return!0}xmi(a,b,c,f){const l=(512===b||1024===b?!c:c)?a|b:a&~b;l!==a&&this.IOe(f,()=>{this.GPd.dml(l,f)})}A8a(a,b,c,f,l){if(!({GF:a}=this.Etc(b,c,l,!1,!1)).returnValue)return a;const y=b.node;this.IOe(y,()=>{this.GPd.rBi(y)});
return 32}static zr(){ml.fQa[ml.S5i]=32;ml.fQa[ml.N5i]=128;ml.fQa[ml.D7j]=64;ml.fQa[ml.v7j]=256;ml.fQa[ml.Toi]=512;ml.fQa[ml.Soi]=1024}static ztl(a,b){a=!!(a&b);if(512===b||1024===b)a=!a;return a}static puj(a){let b=0;a in ml.fQa&&(b=ml.fQa[a]);return b}}ml.S5i="buttonFirstRow";ml.N5i="buttonFirstColumn";ml.D7j="buttonLastRow";ml.v7j="buttonLastColumn";ml.Toi="buttonBandedRow";ml.Soi="buttonBandedColumn";ml.fQa={};Object(m.a)(ml,"TableStyleActor",null,[]);ml.zr();class Jp{constructor(a){this.b1=a}Bol(a,
b){a=this.b1.C8b(a);Jp.pKf(b);b.setValue(zb.a.Oza,Hg.a.Jf(a.hY.styleIdField))}dml(a,b){b.setValue(zb.a.ivc,a)}rBi(a){Jp.pKf(a);a.removeProperty(zb.a.Oza)}static pKf(a){if(a=Object(qa.a)(Pz.TableNode,a)){a=a.Bab();for(const b of a){b.cellShading&&((a=gp.d(b.cellShading))?(gp.c(a),b.cellShading=a):xa.a.J(22078240,822,15,"Encountered null cell shading."));for(const c of Jp.oqi){let f,l;({kRa:f,Y7a:a,Mtb:l}=cq.kUa(c));b.removeProperty(a);b.removeProperty(f);b.removeProperty(l)}Jp.SAi(Object(qa.a)(pg.a,
b))}}else xa.a.J(587531030,822,10,"Casting of GraphNode to ITableNode is null")}static SAi(a){const b=new QF.a;b.set(a);for(a=b.Cb(1);a;){for(a=b.Cb(2);a;)12===a.type&&Jp.TAi(a),a=b.Nj(2);a=b.Nj(1)}}static TAi(a){if(a.Ta&&0<a.Ta.length)for(let b=0;b<a.Ta.length;b++)a.Ta.ga(b)&&Jp.UAi(a.Ta.ga(b))}static UAi(a){if(a=a.formatting){const f=a.paragraph.Lh;if(f){var b=a.dA,c=!1;if(b){for(let l=0;l<Jp.XXe.length;l++)b.Ua(Jp.XXe[l])&&(c||(c=!0,b=b.clone()),b.removeProperty(Jp.XXe[l]));c&&(b=f.bLa(b),a.Am=
b.id)}}}}}Jp.XXe=[ab.a.font,zb.a.latinFont,zb.a.eastAsianFont,zb.a.complexScriptFont,zb.a.FPb,ab.a.fontColor,ab.a.bold,ab.a.italic,zb.a.schemeColor];Jp.oqi=[5,6,7,0];Object(m.a)(Jp,"PPTTableStyleEditor",null,[260]);class fE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TableStyleEditor"}Yb(a){this.K=a}init(){(new ml(this.K.resolve("Box4.Styles.ITableStyleReader"),this.K.resolve("Box4.TableEditors.ITableStyleRibbonControls"),this.K.resolve("Common.IActionManagerExtended"),new Jp(this.K.resolve("PowerPointWebEditor.ITableStyleGalleryManager")),
this.K.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.K.resolve("Box4.IInsertionPointFormatting"),this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,()=>!1)).vb()}dispose(){}static main(){n.a.instance.Ac(new fE)}}Object(m.a)(fE,"PPTWebEditorTableStyleEditorPackage",null,[2,3]);class gE{constructor(a,b,c){this.jHe=0;this.zze=!1;this.el=a;this.Pr=b;this.pa=c;this.el.Uyf(Object(I.a)(this,this.mEf,"beforeForceOutboundGraphTransactionInitialize"));this.el.zCa(Object(I.a)(this,
this.leg,"graphTransactionDisposed"));this.Pr.gja(Object(I.a)(this,this.i_a,"onBeforeValidatePersistence"))}dispose(){this.el.toh(Object(I.a)(this,this.mEf,"beforeForceOutboundGraphTransactionInitialize"));this.el.z0a(Object(I.a)(this,this.leg,"graphTransactionDisposed"));this.Pr.cMb(Object(I.a)(this,this.i_a,"onBeforeValidatePersistence"))}mEf(){this.jHe++}i_a(){0<this.jHe&&(this.zze=!0)}leg(){if(!(0<--this.jHe)&&this.zze){this.zze=!1;var a=Nc.a.Kb;if(a){const b=this.pa.Xd();let c=0;for(const f of b)f.ZL&&
c++;a.Wa("ShapeCount",b.length.toString());a.Wa("SupportSVGCount",c.toString())}}}}Object(m.a)(gE,"SVGShapeTelemetry",null,[107]);class hE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Telemetry"}Yb(a){this.K=a;this.K.register(gE,"PowerPointWebEditor.Telemetry.SVGShapeTelemetry").ma().oa(()=>new gE(this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").yd(10),this.K.resolve("PowerPointWebEditor.IPptSelectionManager")))}init(){this.K.resolve("PowerPointWebEditor.Telemetry.SVGShapeTelemetry")}dispose(){this.K.resolve("PowerPointWebEditor.Telemetry.SVGShapeTelemetry").dispose()}static main(){n.a.instance.Ac(new hE)}}
Object(m.a)(hE,"PPTWebEditorTelemetryPackage",null,[2,3]);class Tz{}Tz.Rih="faProofing";Object(m.a)(Tz,"ContextMenuControlId",null,[]);class iE{constructor(a,b,c,f,l,y,H){this.yN=b;this.VXb=a;this.iCc=b.BVj;this.ECc=b.gpe;this.d0h=y;this.SBc=f;this.UBc=l;this.KOa=c;this.OP=H;this.GOa=new Pb.a;this.GOa.$(1,"SpellingIssue_16x16x32");this.GOa.$(2,"GrammarIssue_16x16x32");this.GOa.$(3,"WritingIssue_16x16x32");this.GOa.$(4,null);this.GOa.$(0,null)}create(a,b,c){b=Object(qa.a)(To.a,b);if(!b)return ka.ULS.sendTraceTag(25007833,
375,15,"Expect EditorServiceErrorDetails."),"";const f=new Sys.StringBuilder;a=this.w8f(a);this.w3b(f,b,c,a);this.Q0d(f,b);this.CNi(f,b,a);return f.toString()}ht(a,b,c){b=Object(qa.a)(To.a,b);if(!b)return ka.ULS.sendTraceTag(39188232,375,15,"Expect EditorServiceErrorDetails."),[];const f=[];a=this.w8f(a);this.v1d(f,b,c,a);this.R0d(f,b);this.DNi(f,b,a);return f}w3b(a,b,c,f=null){0===b.errorType?a.append(this.VXb.build()):1===b.errorType&&(this.XSa(b)||a.append(this.IWd(b,c,f)))}v1d(a,b,c,f=null){0===
b.errorType?a.push(this.VXb.GFf()):1===b.errorType&&(this.XSa(b)||a.push(this.Ari(b,c,f)))}Q0d(a,b){if(!N.a.instance.ga(92)){const c=new Sys.StringBuilder;this.KCh(b)?c.append(sj.a("btnIgnoreAllSpellingError",(2===b.errorType?C.a.Uxd:C.a.$ge).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,null)):this.XSa(b)||c.append(sj.a("btnIgrnoreSpellingError",this.U7f(b.errorType).toString(),Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,null));this.OCh(b)&&(this.yN.fne&&c.append(sj.a("btnDoNotCheckForThisIssue",
"2157977488",Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,null)),c.append(sj.a("btnGrammarOptions","3380187414",ma.a.xe(Box4Intl.Box4Strings.l_GrammarOptions),null)));c.isEmpty()||(a.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),a.append(c.toString()),a.append("</Controls></MenuSection>"))}}R0d(a,b){if(!N.a.instance.ga(92)){const f=Object.assign(new Rk.a,{ControlList:[]});if(this.KCh(b)){var c=Object.assign(new hg.a,{ExternalId:2===b.errorType?"UnknownAllSpellingError":
"IgnoreAllSpellingError"});Array.add(f.ControlList,c)}else this.XSa(b)||(c=Object.assign(new hg.a,{ExternalId:"btnIgrnoreSpellingError",Command:this.U7f(b.errorType).toString(),LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError}),Array.add(f.ControlList,c));this.OCh(b)&&(this.yN.fne&&(b=Object.assign(new hg.a,{ExternalId:"DoNotCheckForThisIssue",Command:"2157977488",LabelText:Box4Intl.Box4Strings.l_DoNotCheckForThisIssue}),Array.add(f.ControlList,b)),b=Object.assign(new hg.a,{ExternalId:"GrammerSettingsContext",
Command:"3380187414",LabelText:Box4Intl.Box4Strings.l_GrammarOptions}),Array.add(f.ControlList,b));a.push(f)}}w8f(a){if(!this.OP)return null;a=this.OP.language(this.OP.Bs(a.Va));return bb.a.He(a).name}U7f(a){return 2===a?C.a.Uxd:this.yN.Nog?C.a.xZc:C.a.kla}CNi(a,b,c=null){if(this.X0e(b)){var f=ma.a.xe(b.ON.CategoryTitle);f=sj.j(Tz.Rih,G.a.m8,this.GOa.ga(b.proofingType),""!==f?f:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,[a.toString()],this.SBc,this.UBc);f=sj.c("cgProofingOuter",[f]);
a.clear();a.append(sj.e("msProofingOuter",f,"Menu16",void 0,void 0,c,"ariaLabelledById"));ka.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",b.proofingType,b.typeId)}}DNi(a,b,c=null){if(this.X0e(b)){var f=ma.a.xe(b.ON.CategoryTitle);c=Object.assign(new zA.a,{ExternalId:String.format("{0}_{1}",Tz.Rih,b.proofingType),Command:"798637440",Image16by16Class:this.GOa.ga(b.proofingType),LabelText:""!==f?f:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,Lang:c,
Menu:Object.assign(new On.a,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,AriaLabel:this.Iaj(b),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,MenuSectionList:[]})});Array.addRange(c.Menu.MenuSectionList,a);Array.clear(a);f=Object.assign(new Rk.a,{ControlList:[]});Array.add(f.ControlList,c);a.push(f);ka.ULS.sendTraceTag(39188234,375,50,"Show 2-level context menu of type {0}, critique id {1}",b.proofingType,b.typeId)}}IWd(a,b,c=null){const f=this.Bgj(a);
var l=[];let y=!1;var H=a.ON.Suggestions;if(H)if(H=H.slice(0,Math.min(3,H.length)),this.iCc&&(y=!Yb.a.any(H,Q=>!Q||!Q.Description)),1===H.length&&0===H[0].Action)b=ma.a.xe(H[0].Text),l.push(sj.a("btnCorrectWord0","3587447601",b,null,null,null,null,null,null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,f,b)));else{let Q=0,ia=null;y&&(ia="font-weight: bold;");for(const wa of H){if(!wa)continue;H=null;let Ua="",kb=ma.a.xe(wa.Text);y&&(H=this.t4f(wa.Description),
Ua=this.s4f(wa.Description));l.push(sj.a("btnCorrectWord"+Q,b[Q].toString(),kb,null,null,null,null,null,ia,null,H,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,f,kb),"ariaLabelledById",String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,a.token,this.HNf(a.token)),"ariaDescribedById",Ua));Q++}}b="Menu16";0<l.length?y&&(b="Menu16DescriptionEnabled"):l=[sj.a("btnNoSuggestions","3587447601",Box4Intl.Box4Strings.l_NoSuggestions,
null)];return sj.e("msUnknownWord",sj.c(null,l),b,f,this.alj(a),c,"ariaLabelledById")}Ari(a,b,c=null){var f=1!==a.proofingType&&0!==a.proofingType?a.ON.ExplanationTitle:"";f=Object.assign(new Rk.a,{Title:f,Lang:c,ControlList:[]});let l=!1;var y=a.ON.Suggestions;if(y)if(y=y.slice(0,Math.min(3,y.length)),this.iCc&&(l=!Yb.a.any(y,H=>!H||!H.Description)),1===y.length&&0===y[0].Action)a=y[0],a=Object.assign(new hg.a,{ExternalId:"NoSuggestion",Command:"3587447601",LabelText:a.Text}),Array.add(f.ControlList,
a);else{let H=0;for(const Q of y){if(!Q)continue;y=null;let ia="";l&&(y=this.t4f(Q.Description),ia=this.s4f(Q.Description));if(H>=b.length)break;y?(y=Object.assign(new uB,{ExternalId:String.format("{0}{1}_{2}_compoundButton","btnCorrectWord",H,a.proofingType),Command:b[H].toString(),LabelText:Q.Text,Description:y,Lang:c,AriaDescription:ia}),Array.add(f.ControlList,y)):(y=Object.assign(new hg.a,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",H,a.proofingType),Command:b[H].toString(),
LabelText:Q.Text,Lang:c,RoleInMenu:"menuitem"}),Array.add(f.ControlList,y));H++}}0>=f.ControlList.length&&Array.add(f.ControlList,Object.assign(new hg.a,{ExternalId:"btnNoSuggestions",Command:"3587447601",LabelText:Box4Intl.Box4Strings.l_NoSuggestions}));return f}Bgj(a){return ma.a.xe(1!==a.proofingType&&0!==a.proofingType?a.ON.ExplanationTitle:"")}alj(a){return this.X0e(a)?null:this.GOa.ga(a.proofingType)}X0e(a){return this.ECc&&2!==a.errorType&&(1!==a.errorType||!this.XSa(a))}KCh(a){return this.d0h&&
0!==a.errorType&&1===a.proofingType&&!this.XSa(a)}Iaj(a){return 1===a.proofingType?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,a.token,this.HNf(a.token)):""}OCh(a){return this.yN.aWa&&this.ECc&&1===a.errorType&&(2===a.proofingType||3===a.proofingType)}XSa(a){return 0!==a.errorType&&!!this.KOa&&this.KOa.contains(a.token,a.lcid)}t4f(a){return""===a?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):a}s4f(a){return""!==a?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,
a):""}HNf(a){let b="";if(a){let c;for(c=0;c<a.length-1;c++)b=b+a.charAt(c)+",";b+=a.charAt(c)}return b}}Object(m.a)(iE,"EditorServiceProofingContextMenuCreator",null,[]);class Jq{gba(a,b){this.exi&&this.pvl(a,b,Jq.H3g,Jq.mb)}pvl(a,b,c,f){switch(c){case 1:case 6:case 2:case 3:case 4:case 5:Jq.zXi.show(f,a,b)}}F3g(){switch(Jq.H3g){case 5:case 1:return!0;default:return!1}}get exi(){return 1!==Rc.App.Lb.state}static get zXi(){return Jq.mff||(Jq.mff=Ib.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu"))}static blj(a){if(!a)return 0;
if(2===Rc.App.Lb.mode)if(N.a.instance.ga(17)&&1===a.length&&gj.OutlineReader.Abc(a.Va)&&Rc.App.Lb.Kd.Mn&&Rc.App.Lb.Kd.Mn.qp){if(a=ob.GraphIterator.pb(a.Va.node),a.hv(),!ze.b(a))return 5}else{const b=a.Va.node;let c=ob.GraphIterator.pb(b);c.hv();return mu.e(c.currentNode)?2:w.AFrameworkApplication.Anb||!Nb.EmbeddedFileReader.bcb(b)||Nb.EmbeddedFileReader.jO(b)?a.Va.contextId===yb.a.iFrame||WI(a.Va)?6:1:3}else return 4;return 0}static get mb(){return ge.a.instance.Pa.mb}static get H3g(){return Jq.blj(Jq.mb)}}
Jq.mff=null;Object(m.a)(Jq,"SelectionContextMenuProvider",null,[223]);class qM{constructor(a){this.la=a}$7d(a,b,c,f,l){const y=c?w.AFrameworkApplication.Cm:"";c=c?He.getImageClass(c):"";return String.format('<FlyoutAnchor Id="{0}" Command="{1}" Image16by16="{2}" \r\n              Image16by16Class="{3}" LabelText="{4}"> {5} </FlyoutAnchor>',a,b,y,c,ma.a.xe(f),l)}menu(a,b){return String.format('<Menu Id="{0}"> {1} </Menu>',a,b)}menuSection(a,b){return String.format('<MenuSection Id="{0}" DisplayMode="Menu16"><Controls> {1} </Controls></MenuSection>',
a,b)}QOi(){let a=ResourceStrings.l_ContextMenuSmartLookup;var b=(new ox.a).getSelectedText();b=(b=b.neighborhood.substr(b.mentionStart,b.mentionLength))?b.trim():null;let c=20;b&&0<b.length&&(b.length>c&&(c=ma.a.Gx(b,c)?c-1:c),b=b.length>c?b.substr(0,c).trim()+"...":b);b&&0<b.length&&(a=String.format(ResourceStrings.l_ContextMenuTextSmartLookup,b));return a}izi(){var a=(new ox.a).getSelectedText();a=a.neighborhood.substr(a.mentionStart,a.mentionLength);return!(a&&0<a.trim().length)}gPi(){let a=ResourceStrings.l_SynonymsSerpletContextMenu;
var b=(new ox.a).getSelectedText();b=b.neighborhood.substr(b.mentionStart,b.mentionLength);if(!b)return a;b=b.trim();let c=14;0<b.length&&(b.length>c&&(c=ma.a.Gx(b,c)?c-1:c),b=b.length>c?b.substr(0,c).trim()+"...":b,a=String.format(ResourceStrings.l_ContextMenuTextSynonyms,b));return a}}Object(m.a)(qM,"ContextMenuHelper",null,[227]);class Zx extends Us{constructor(a,b,c,f){super(a,c);this.Pzg=b;this.nXa=f}T6b(a){let b=null,c=!1;var f=ge.a.instance.Pa.mb;f=Ib.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu").Gfe(f,
a);switch(this.nXa){case 7:b=["Picture","Comment"];c=!0;break;case 15:case 6:case 10:case 5:b=["Shape","Comment"];c=!0;break;case 8:b=["SmartArtStylesOptions","Comment"];c=!0;break;case 13:case 11:b=["SVG","Comment"];c=!0;break;default:const l=!!this.Pzg&&this.Pzg.qrg("1898844988"),y=Ib.a.instance.resolve("Box4.ISelectionContextMenuProvider").F3g(),H=w.AFrameworkApplication.fa.ka("PPTOTableCellBordersEnabled");l?b=H?3===a&&f?"Paste FontFormatting Table TableStyle Comment ContextMenu".split(" "):["FontFormatting",
"Table","TableStyle","Comment"]:3===a&&f?["Paste","FontFormatting","Table","Comment","ContextMenu"]:["FontFormatting","Table","Comment"]:y&&(b=3===a&&f?["Paste","FontFormatting","Comment","ContextMenu"]:["FontFormatting","Comment"])}3===a&&f&&c&&b.push("ContextMenu");return b}static QNj(a,b,c,f){a.Fpi(()=>Zx.EGi(b,c,f))}static EGi(a,b,c){return new Zx(a,b,c,0)}}Object(m.a)(Zx,"PowerPointReactFloatie",Us,[]);class rM{constructor(a,b){this.bCg=b;this.fve=a}dispose(){}PA(){}kUf(){this.fve.bta()}B6(a,
b,c,f){this.bCg.nwh(f);this.fve.B6(a,b,c)}qvl(a,b,c,f){14===f?this.B6(a,b,c,f):(this.bCg.nwh(f),a=new Zx(Ib.a.instance.qb("Common.IReactContextualUILauncher"),Rc.App.hE.nT,Ib.a.instance.qb("Common.IExternalUICommandDefinitionMapping"),f),this.fve.Ytd(b,c,a,Ib.a.instance.qb("Box4.ISelectionContextMenuProvider")))}}Object(m.a)(rM,"ReactContextMenuUser",null,[225]);var GR=d(1045),HR=d(926);class jE{constructor(){this.Orf=null}get vsh(){return this.Orf||(this.Orf=Ib.a.instance.qb("Common.IRootManager"))}vb(){}pe(){}Gtg(){}fdl(){this.vsh&&
this.vsh.mNc()}}Object(m.a)(jE,"ABox4BridgeCommandUi",null,[226,107]);class sM extends jE{constructor(a,b,c,f){super();this.iAg=a;this.uu=b;this.ia=c;this.Wcd=f}BG(a){Object(qa.a)(270,this.uu).UQb(a)}j2(a){return 32===this.ia.Ka(ea.a.j2,2,a)}gPk(){this.iAg.clearCache();this.uu.PA()}aRb(){this.uu.aRb()}rXe(a){a?a(this.Wcd.bta()):this.Wcd.bta()}qrg(a){return this.iAg.Zbc(a)}Gtg(){const a=Object(qa.a)(270,this.uu);a&&a.X7j()}dispose(){}}Object(m.a)(sM,"Box4BridgeCommandUi",jE,[]);var kE=d(1159);class Ar{static get z8(){return Ar.t7||
(Ar.t7=Ib.a.instance.resolve("Box4.IContextMenuController"))}static showContextMenu(a,b){Ar.z8.showContextMenu(a,b)}static B6(a,b,c){Ar.z8.B6(a,b,c)}static Xtd(a,b,c,f=null){Ar.z8.Xtd(a,b,c,f)}}Ar.t7=null;Object(m.a)(Ar,"BaseContextMenu",null,[]);var tM=d(1271);class Kp extends tM.a{constructor(){super();this.XRd();this.JSd()}XRd(){this.addCommandToMaps(Object.assign(new Yd.a("AlignCenter","4284004393"),{legacyControlId:"CenterJustify",queryCommandId:"3263071675"}));this.addCommandToMaps(Object.assign(new Yd.a("AlignLeft",
"2539120357"),{legacyControlId:"LeftJustify",queryCommandId:"3797776291"}));this.addCommandToMaps(Object.assign(new Yd.a("AlignRight","393413924"),{legacyControlId:"RightJustify",queryCommandId:"2003732276"}));this.addCommandToMaps(Object.assign(new Yd.a("AlignTableTopLeft","428881244"),{legacyControlId:"TableCellJustifyTopLeft",queryCommandId:"1001772032"}));this.addCommandToMaps(Object.assign(new Yd.a("AlignTableTopCenter","1718508548"),{legacyControlId:"TableCellJustifyTopCenter",queryCommandId:"43364900"}));
this.addCommandToMaps(Object.assign(new Yd.a("AlignTableTopRight","1925534309"),{legacyControlId:"TableCellJustifyTopRight",queryCommandId:"948656099"}));this.addCommandToMaps(Object.assign(new Yd.a("AlignTableCenterLeft","150838934"),{legacyControlId:"TableCellJustifyMiddleLeft",queryCommandId:"3335457338"}));this.addCommandToMaps(Object.assign(new Yd.a("AlignTableCenter","3219509138"),{legacyControlId:"TableCellJustifyMiddleCenter",queryCommandId:"296402530"}));this.addCommandToMaps(Object.assign(new Yd.a("AlignTableCenterRight",
"4038626531"),{legacyControlId:"TableCellJustifyMiddleRight",queryCommandId:"2444984437"}));this.addCommandToMaps(Object.assign(new Yd.a("AlignTableBottomLeft","12275744"),{legacyControlId:"TableCellJustifyBottomLeft",queryCommandId:"3942794232"}));this.addCommandToMaps(Object.assign(new Yd.a("AlignTableBottomCenter","1910316280"),{legacyControlId:"TableCellJustifyBottomCenter",queryCommandId:"812840340"}));this.addCommandToMaps(Object.assign(new Yd.a("AlignTableBottomRight","719753309"),{legacyControlId:"TableCellJustifyBottomRight",
queryCommandId:"347437379"}));this.addCommandToMaps(Object.assign(new Yd.a("AlignTableTopLeft_MLR","428881244"),{legacyControlId:"TableCellJustifyTopLeft",queryCommandId:"1001772032"}));this.addCommandToMaps(Object.assign(new Yd.a("AlignTableTopCenter_MLR","1718508548"),{legacyControlId:"TableCellJustifyTopCenter",queryCommandId:"43364900"}));this.addCommandToMaps(Object.assign(new Yd.a("AlignTableTopRight_MLR","1925534309"),{legacyControlId:"TableCellJustifyTopRight",queryCommandId:"948656099"}));
this.addCommandToMaps(Object.assign(new Yd.a("AlignTableCenterLeft_MLR","150838934"),{legacyControlId:"TableCellJustifyMiddleLeft",queryCommandId:"3335457338"}));this.addCommandToMaps(Object.assign(new Yd.a("AlignTableCenter_MLR","3219509138"),{legacyControlId:"TableCellJustifyMiddleCenter",queryCommandId:"296402530"}));this.addCommandToMaps(Object.assign(new Yd.a("AlignTableCenterRight_MLR","4038626531"),{legacyControlId:"TableCellJustifyMiddleRight",queryCommandId:"2444984437"}));this.addCommandToMaps(Object.assign(new Yd.a("AlignTableBottomLeft_MLR",
"12275744"),{legacyControlId:"TableCellJustifyBottomLeft",queryCommandId:"3942794232"}));this.addCommandToMaps(Object.assign(new Yd.a("AlignTableBottomCenter_MLR","1910316280"),{legacyControlId:"TableCellJustifyBottomCenter",queryCommandId:"812840340"}));this.addCommandToMaps(Object.assign(new Yd.a("AlignTableBottomRight_MLR","719753309"),{legacyControlId:"TableCellJustifyBottomRight",queryCommandId:"347437379"}));this.addCommandToMaps(Object.assign(new Yd.a("ApplyStyle","1040747875"),{queryCommandId:"3123760305",
populationProps:new oo.a("681481568",!1),previewControlIds:["buttonStyle0","buttonStyle1","buttonStyle2","buttonStyle3","buttonStyle4"]}));this.addCommandToMaps(Object.assign(new Yd.a("AutoCorrectOptions","880879461"),{legacyControlId:"fseaOpenAutoCorrectOptionsDialog"}));this.addCommandToMaps(Object.assign(new Yd.a("AutomaticFontColor","3491966299"),{legacyControlId:"fontColor"}));this.addCommandToMaps(Object.assign(new Yd.a("Bold","4143129361"),{legacyControlId:"fsbcBold",queryCommandId:"1465813983"}));
this.addCommandToMaps(Object.assign(new Yd.a("BulletLibrary","3552651681"),{queryCommandId:"3827179399",populationProps:new oo.a("2466004410",!1)}));this.addCommandToMaps(Object.assign(new Yd.a("BulletNone","3552651681"),{queryCommandId:"990335323",menuItemId:"BulletStyleBulletsLibrary_0"}));this.addCommandToMaps(Object.assign(new Yd.a("CellShading","2765388691"),{legacyControlId:"cellShadingColor",populationProps:new oo.a("462656847",!1)}));this.addCommandToMaps(Object.assign(new Yd.a("ClearFormatting",
"2319895756"),{legacyControlId:"fseaClearFormatting"}));this.addCommandToMaps(Object.assign(new Yd.a("ClearShadingColor","3275596206"),{legacyControlId:"clear"}));this.addCommandToMaps(new Yd.a("ClearStyleFormatting","2319895756"));this.addCommandToMaps(Object.assign(new Yd.a("ClearTableFormatting","3835123874"),{legacyControlId:"fseaClearTableFormatting"}));this.addCommandToMaps(Object.assign(new Yd.a(Kp.EIi,"3383614517"),{legacyControlId:"fseaCopy"}));this.addCommandToMaps(Object.assign(new Yd.a(Kp.QQi,
"2309168610"),{legacyControlId:"fseaCut"}));this.addCommandToMaps(Object.assign(new Yd.a("DecreaseIndent","3376107472"),{legacyControlId:"fseaOutdent",queryCommandId:"1599543798"}));this.addCommandToMaps(Object.assign(new Yd.a("DeleteColumn","2983091615"),{legacyControlId:"btnColumnDelete"}));this.addCommandToMaps(Object.assign(new Yd.a("DeleteRow","1368263559"),{legacyControlId:"btnRowDelete"}));this.addCommandToMaps(Object.assign(new Yd.a("DeleteTable","1819681963"),{legacyControlId:"btnTableDelete"}));
this.addCommandToMaps(Object.assign(new Yd.a("Dictation","1394650145"),{legacyControlId:"btnStartDictation",queryCommandId:"2417470717",populationProps:new oo.a("1546254036",!0)}));this.addCommandToMaps(Object.assign(new Yd.a("DictationFloatieToggle","1394650145"),{legacyControlId:"btnDictationFloatieToggle",queryCommandId:"2417470717"}));this.addCommandToMaps(Object.assign(new Yd.a("DictationSettingsLanguages","3662249320"),{queryCommandId:"569982264",populationProps:new oo.a("3836866597",!0)}));
this.addCommandToMaps(new Yd.a("DictationSettingsHelp","3819824931"));this.addCommandToMaps(new Yd.a("DictationSettingsHelpShowCommands","2729830074"));this.addCommandToMaps(Object.assign(new Yd.a("DictationSettingsAutoPunctuation","992784617"),{queryCommandId:"1118940415"}));this.addCommandToMaps(Object.assign(new Yd.a("EditInApp","3588168074"),{legacyControlId:"btnOpenInClient"}));this.addCommandToMaps(Object.assign(new Yd.a("EditingView","329275380"),{legacyControlId:"btnEditOnWeb",queryCommandId:"214409533"}));
this.addCommandToMaps(Object.assign(new Yd.a("EditTableAltText","868579142"),{legacyControlId:"btnTableAltText"}));this.addCommandToMaps(Object.assign(new Yd.a("FlipHorizontal","2545543284"),{legacyControlId:"buttonFlipHorizontal",menuItemId:"buttonFlipHorizontal"}));this.addCommandToMaps(Object.assign(new Yd.a("FlipVertical","2545543284"),{legacyControlId:"buttonFlipVertical",menuItemId:"buttonFlipVertical"}));this.addCommandToMaps(Object.assign(new Yd.a("FontColor","1970784898"),{legacyControlId:"fontColor",
populationProps:new oo.a("2077552168",!1)}));w.AFrameworkApplication.fa.ka("FontPreviewEnabled")?(this.addCommandToMaps(Object.assign(new Yd.a("FontName","3430668515"),{legacyControlId:"fontName",queryCommandId:"1223894949",populationProps:new oo.a("179506844",!1),commandPreviewId:"2655634065",commandRevertId:"1138852411"})),this.addCommandToMaps(Object.assign(new Yd.a("FontSize","3217001754"),{legacyControlId:"fontSize",queryCommandId:"3829328462",commandPreviewId:"1666858098",commandRevertId:"1250696292"}))):
(this.addCommandToMaps(Object.assign(new Yd.a("FontName","3430668515"),{legacyControlId:"fontName",queryCommandId:"1223894949",populationProps:new oo.a("179506844",!1)})),this.addCommandToMaps(Object.assign(new Yd.a("FontSize","3217001754"),{legacyControlId:"fontSize",queryCommandId:"3829328462"})));this.addCommandToMaps(Object.assign(new Yd.a("FormatPainter","2458503775"),{legacyControlId:"fseaFormatPainter",queryCommandId:"2544399836"}));this.addCommandToMaps(Object.assign(new Yd.a("GrammarSettings",
"3380187414"),{legacyControlId:"btnGrammarSettings"}));this.addCommandToMaps(Object.assign(new Yd.a("GrowFontSize","286819199"),{legacyControlId:"fseaGrowFontSize"}));this.addCommandToMaps(Object.assign(new Yd.a("Highlighter","1784019754"),{legacyControlId:"fontBackgroundColor"}));this.addCommandToMaps(new Yd.a("HighlighterColor","1784019754"));this.addCommandToMaps(Object.assign(new Yd.a("ImmersiveReader","1925081555"),{legacyControlId:"btnImmersiveMode"}));this.addCommandToMaps(Object.assign(new Yd.a("IncreaseIndent",
"4073520836"),{legacyControlId:"fseaIndent",queryCommandId:"2667230914"}));this.addCommandToMaps(Object.assign(new Yd.a("IndentFirstLine","682091331"),{legacyControlId:"buttonSpecialIndentFirstLine",queryCommandId:"1728659747"}));this.addCommandToMaps(Object.assign(new Yd.a("IndentHanging","4114875119"),{legacyControlId:"buttonSpecialIndentHanging",queryCommandId:"4115573199"}));this.addCommandToMaps(Object.assign(new Yd.a("IndentLeft","3058254979"),{legacyControlId:"spnIndentBefore",queryCommandId:"2987841675"}));
this.addCommandToMaps(Object.assign(new Yd.a("IndentNone","3839386673"),{legacyControlId:"buttonSpecialIndentNone",queryCommandId:"738769293"}));this.addCommandToMaps(Object.assign(new Yd.a("IndentRight","1217598046"),{legacyControlId:"spnIndentAfter",queryCommandId:"3085515826"}));this.addCommandToMaps(Object.assign(new Yd.a("InsertAbove","2167983890"),{legacyControlId:"btnInsertRowAbove"}));this.addCommandToMaps(Object.assign(new Yd.a("InsertBelow","3709283166"),{legacyControlId:"btnInsertRowBelow"}));
this.addCommandToMaps(Object.assign(new Yd.a("InsertCameraPicture","2935789186"),{legacyControlId:"fseaInsertCameraPicture"}));this.addCommandToMaps(Object.assign(new Yd.a("InsertEmoji","2994090608"),{legacyControlId:"flyInsertEmojis",queryCommandId:"35811376",populationProps:new oo.a("1124716226",!0)}));this.addCommandToMaps(Object.assign(new Yd.a("InsertLeft","1006902144"),{legacyControlId:"btnInsertColumnLeft"}));this.addCommandToMaps(Object.assign(new Yd.a("InsertRight","1735639577"),{legacyControlId:"btnInsertColumnRight"}));
this.addCommandToMaps(Object.assign(new Yd.a("InsertLink","2711544537"),{legacyControlId:"fseaInsertHyperlink"}));this.addCommandToMaps(Object.assign(new Yd.a("InsertPicture","2670646631"),{legacyControlId:"fseaInsertPicture"}));this.addCommandToMaps(Object.assign(new Yd.a("InsertOnlinePicture","1685987254"),{legacyControlId:"fseaFlyInsertOnlinePictureFromSearch"}));this.addCommandToMaps(Object.assign(new Yd.a("InsertPictureFromHost","720118144"),{legacyControlId:"fseaFlyInsertOnlinePictureFromHost",
queryCommandId:"3612507612"}));let a;this.addCommandToMaps((a=new Yd.a("InsertSymbol","3471878106"),a.legacyControlId="flyInsertSymbols",a.populationProps=new oo.a("1256496096",!0),a));let b;this.addCommandToMaps((b=new Yd.a("InsertTable","975293073"),b.legacyControlId="flyInsertTable",b));let c;this.addCommandToMaps((c=new Yd.a("Italic","3569444222"),c.legacyControlId="fsbcItalic",c.queryCommandId="4231335074",c));let f;this.addCommandToMaps((f=new Yd.a("Justify","1733835213"),f.legacyControlId=
"FullJustify",f.queryCommandId="1257252315",f));let l;this.addCommandToMaps((l=new Yd.a("LeftToRightTextDirection","927903232"),l.legacyControlId="TextDirLTR",l.queryCommandId="1154761034",l));let y;this.addCommandToMaps((y=new Yd.a("LineSpacing","2222099814"),y.legacyControlId="flyLineSpacing",y.populationProps=new oo.a("2818132660",!0),y));let H;this.addCommandToMaps((H=new Yd.a("LineSpacingOptions","2465215107"),H.legacyControlId="grpParagraphDialogLauncherButton",H));let Q;this.addCommandToMaps((Q=
new Yd.a("LockAspectRatio","3369422509"),Q.legacyControlId="toggleBtnLockAspectRatio",Q.queryCommandId="4201275867",Q));let ia;this.addCommandToMaps((ia=new Yd.a("Margins","1451516907"),ia.legacyControlId="flyMargins",ia));let wa;this.addCommandToMaps((wa=new Yd.a("MergeCells","4127468093"),wa.legacyControlId="btnMergeTableCells",wa));this.addCommandToMaps(new Yd.a("MoreEmojis","1145444901"));this.addCommandToMaps(new Yd.a("MoreStyles","3340688468"));let Ua;this.addCommandToMaps((Ua=new Yd.a("MoreSymbols",
"3574218963"),Ua.legacyControlId="btnMoreSymbols",Ua));let kb;this.addCommandToMaps((kb=new Yd.a("MultilevelStyle1","3062940477"),kb.queryCommandId="1240192421",kb.menuItemId="MultilevelStyleMultilevelLibrary_1",kb));let Gb;this.addCommandToMaps((Gb=new Yd.a("MultilevelStyle2","3062940477"),Gb.queryCommandId="1240192421",Gb.menuItemId="MultilevelStyleMultilevelLibrary_2",Gb));let ec;this.addCommandToMaps((ec=new Yd.a("MultilevelStyle3","3062940477"),ec.queryCommandId="1240192421",ec.menuItemId="MultilevelStyleMultilevelLibrary_3",
ec));let dc;this.addCommandToMaps((dc=new Yd.a("NoHighlight","562361573"),dc.legacyControlId="noFontBackgroundColor",dc));let Fc;this.addCommandToMaps((Fc=new Yd.a("NumberingLibrary","2213049770"),Fc.queryCommandId="3488367157",Fc.populationProps=new oo.a("3149136033",!1),Fc));let yc;this.addCommandToMaps((yc=new Yd.a("Orientation","1451516907"),yc.legacyControlId="flyOrientation",yc));let tc;this.addCommandToMaps((tc=new Yd.a("ParagraphOptions","2465215107"),tc.legacyControlId="grpLayoutParagraphDialogLauncherButton",
tc));this.addCommandToMaps(new Yd.a(Kp.nNk,"237279923"));let xd;this.addCommandToMaps((xd=new Yd.a(Kp.iNk,"1656143904"),xd.legacyControlId="fseaNewPaste",xd));this.addCommandToMaps(new Yd.a(Kp.hNk,"1656143904"));let Vd;this.addCommandToMaps((Vd=new Yd.a("PageSize","1451516907"),Vd.legacyControlId="flySize",Vd));this.addCommandToMaps(new Yd.a("Photos","2670646631"));let Ld;this.addCommandToMaps((Ld=new Yd.a("PictureAbsoluteHeight","2808088361"),Ld.legacyControlId="spnAbsoluteHeight",Ld.queryCommandId=
"2181343285",Ld));let ye;this.addCommandToMaps((ye=new Yd.a("PictureAbsoluteWidth","3108736954"),ye.legacyControlId="spnAbsoluteWidth",ye.queryCommandId="1960824158",ye));this.addCommandToMaps(new Yd.a("Print","1588554917"));let Xd;this.addCommandToMaps((Xd=new Yd.a("PrintToWeb","1997662572"),Xd.legacyControlId="jbtnDigitalPrint",Xd));let Xf;this.addCommandToMaps((Xf=new Yd.a("ReadingView","3849298593"),Xf.legacyControlId="btnReadingMode",Xf));let ug;this.addCommandToMaps((ug=new Yd.a("Redo","4183277502"),
ug.legacyControlId="btnRedo",ug));let qg;this.addCommandToMaps((qg=new Yd.a("ResetPicture","2916220093"),qg.legacyControlId="btnResetPicture",qg));let Fg;this.addCommandToMaps((Fg=new Yd.a("RightToLeftTextDirection","2632572640"),Fg.legacyControlId="TextDirRTL",Fg.queryCommandId="1154760330",Fg));let qf;this.addCommandToMaps((qf=new Yd.a("RotatePictureMenu","2545543284"),qf.legacyControlId="flyRotate",qf));let bg;this.addCommandToMaps((bg=new Yd.a("RotateLeft90","2545543284"),bg.legacyControlId="buttonRotateLeft90",
bg.menuItemId="buttonRotateLeft90",bg));let Kg;this.addCommandToMaps((Kg=new Yd.a("RotateRight90","2545543284"),Kg.legacyControlId="buttonRotateRight90",Kg.menuItemId="buttonRotateRight90",Kg));let rg;this.addCommandToMaps((rg=new Yd.a("SelectCell","111222446"),rg.legacyControlId="btnSelectCell",rg));let ui;this.addCommandToMaps((ui=new Yd.a("SelectColumn","2341852628"),ui.legacyControlId="btnSelectColumn",ui));let Ik;this.addCommandToMaps((Ik=new Yd.a("SelectRow","3508003794"),Ik.legacyControlId=
"btnSelectRow",Ik));let vg;this.addCommandToMaps((vg=new Yd.a("SelectTable","2306914518"),vg.legacyControlId="btnSelectTable",vg));let Lg;this.addCommandToMaps((Lg=new Yd.a("ShrinkFontSize","3575191971"),Lg.legacyControlId="fseaShrinkFontSize",Lg));let rh;this.addCommandToMaps((rh=new Yd.a("SetProofingLanguage","510284732"),rh.legacyControlId="fseaOpenLanguageDialog",rh));let Bm;this.addCommandToMaps((Bm=new Yd.a("SpacingAfter","2322582597"),Bm.legacyControlId="spnSpacingAfter",Bm.queryCommandId=
"2340669283",Bm));let xj;this.addCommandToMaps((xj=new Yd.a("SpacingBefore","1804274502"),xj.legacyControlId="spnSpacingBefore",xj.queryCommandId="26138520",xj));let Cm;this.addCommandToMaps((Cm=new Yd.a("SpecialIndent","2798144440"),Cm.legacyControlId="flySpecialIndent",Cm));let go;this.addCommandToMaps((go=new Yd.a("Spelling","2646312425"),go.legacyControlId="fseaNextSpellingError",go));let Tl;this.addCommandToMaps((Tl=new Yd.a("StandardShadingColorPicker","2765388691"),Tl.legacyControlId="cellShadingColorTable",
Tl));this.addCommandToMaps(new Yd.a("StandardFontColorPicker","1970784898"));this.addCommandToMaps(new Yd.a("RecentFontColorPicker","1970784898"));let ho;this.addCommandToMaps((ho=new Yd.a("Strikethrough","4169095173"),ho.legacyControlId="fsbcStrikethrough",ho.queryCommandId="2742230607",ho));let Ul;this.addCommandToMaps((Ul=new Yd.a("StyleOptionsBandedColumns","1583455318"),Ul.legacyControlId="buttonBandedColumn",Ul.queryCommandId="1762426222",Ul.menuItemId="buttonBandedColumn",Ul));let Kl;this.addCommandToMaps((Kl=
new Yd.a("StyleOptionsBandedRows","1583455318"),Kl.legacyControlId="buttonBandedRow",Kl.queryCommandId="1762426222",Kl.menuItemId="buttonBandedRow",Kl));let lm;this.addCommandToMaps((lm=new Yd.a("StyleOptionsFirstColumn","1583455318"),lm.legacyControlId="buttonFirstColumn",lm.queryCommandId="1762426222",lm.menuItemId="buttonFirstColumn",lm));let zn;this.addCommandToMaps((zn=new Yd.a("StyleOptionsHeaderRow","1583455318"),zn.legacyControlId="buttonFirstRow",zn.queryCommandId="1762426222",zn.menuItemId=
"buttonFirstRow",zn));let jl;this.addCommandToMaps((jl=new Yd.a("StyleOptionsLastColumn","1583455318"),jl.legacyControlId="buttonLastColumn",jl.queryCommandId="1762426222",jl.menuItemId="buttonLastColumn",jl));let oi;this.addCommandToMaps((oi=new Yd.a("StyleOptionsTotalRow","1583455318"),oi.legacyControlId="buttonLastRow",oi.queryCommandId="1762426222",oi.menuItemId="buttonLastRow",oi));let An;this.addCommandToMaps((An=new Yd.a("Subscript","1455408143"),An.legacyControlId="fsbcSubscript",An.queryCommandId=
"3960255053",An));let io;this.addCommandToMaps((io=new Yd.a("Superscript","1107614"),io.legacyControlId="fsbcSuperscript",io.queryCommandId="692901994",io));let Ep;this.addCommandToMaps((Ep=new Yd.a("Table","28738965"),Ep.legacyControlId="flyInsertTable",Ep));let Mm;this.addCommandToMaps((Mm=new Yd.a("TableStyles","4171428777"),Mm.queryCommandId="2135594455",Mm.populationProps=new oo.a("3359297384",!1),Mm.previewControlIds="buttonTableStyleRibbon0 buttonTableStyleRibbon1 buttonTableStyleRibbon2 buttonTableStyleRibbon3 buttonTableStyleRibbon4 buttonTableStyleRibbon5 buttonTableStyleRibbon6".split(" "),
Mm));this.addCommandToMaps(Object.assign(new Yd.a("TextAlignmentAnchor",null),{legacyControlId:"legacyTextAlignmentAnchor"}));this.addCommandToMaps(Object.assign(new Yd.a("TextAlignmentCenterJustify","4284004393"),{legacyControlId:"legacyTextAlignmentCenterJustify",queryCommandId:"3263071675"}));this.addCommandToMaps(Object.assign(new Yd.a("TextAlignmentFullJustify","1733835213"),{legacyControlId:"legacyTextAlignmentFullJustify",queryCommandId:"1257252315"}));this.addCommandToMaps(Object.assign(new Yd.a("TextAlignmentLeftJustify",
"2539120357"),{legacyControlId:"legacyTextAlignmentLeftJustify",queryCommandId:"3797776291"}));this.addCommandToMaps(Object.assign(new Yd.a("TextAlignmentRightJustify","393413924"),{legacyControlId:"legacyTextAlignmentRightJustify",queryCommandId:"2003732276"}));this.addCommandToMaps(new Yd.a("ThemeShadingColorPicker","2765388691"));this.addCommandToMaps(new Yd.a("ThemeShadingColorPickerMCU","2765388691"));this.addCommandToMaps(new Yd.a("ThemeFontColorPicker","1970784898"));this.addCommandToMaps(new Yd.a("ThemeFontColorPickerMCU",
"1970784898"));this.addCommandToMaps(new Yd.a("ToggleChangeCase","1208649786"));this.addCommandToMaps(Object.assign(new Yd.a("Underline","1863297734"),{legacyControlId:"fsbcUnderline",queryCommandId:"2302164066"}));this.addCommandToMaps(Object.assign(new Yd.a("Undo","2792113512"),{legacyControlId:"btnUndo"}));this.addCommandToMaps(new Yd.a("OpenInClientUpsell","3588168074"));this.addCommandToMaps(Object.assign(new Yd.a("SelectAll","344786228"),{legacyControlId:"SelectAllButton"}));this.addCommandToMaps(Object.assign(new Yd.a("EditInClient",
"3588168074"),{legacyControlId:"btnjEditInClient"}));this.addCommandToMaps(Object.assign(new Yd.a("OpenInClient","3588168074"),{legacyControlId:"btnjOpenInClient"}));let Nm;this.addCommandToMaps((Nm=new Yd.a("PrintDocument","1588554917"),Nm.legacyControlId="jbtnDirectPrint",Nm));let yj;this.addCommandToMaps((yj=new Yd.a("PrintToPdf","1588554917"),yj.legacyControlId="jbtnPrintToPdf",yj));let kh;this.addCommandToMaps((kh=new Yd.a("ProtectDocument","1642700244"),kh.legacyControlId="btnProtectDocument",
kh.queryCommandId="3993403020",kh));let zj;this.addCommandToMaps((zj=new Yd.a("TransformToWebPage","1997662572"),zj.legacyControlId="jbtnTransformToWeb",zj));let zg;this.addCommandToMaps((zg=new Yd.a("OpenInClientWithIcon","3588168074"),zg.legacyControlId="btnOpenInClient",zg));let Rd;this.addCommandToMaps((Rd=new Yd.a("BulletLibrary_MLR","3552651681"),Rd.queryCommandId="3827179399",Rd.populationProps=new oo.a("2466004410",!1),Rd));let gf;this.addCommandToMaps((gf=new Yd.a("InsertPicture_MLR","2670646631"),
gf.legacyControlId="fseaInsertPicture",gf));let Lf;this.addCommandToMaps((Lf=new Yd.a("NumberingLibrary_MLR","2213049770"),Lf.queryCommandId="3488367157",Lf.populationProps=new oo.a("3149136033",!1),Lf));let we;this.addCommandToMaps((we=new Yd.a("PasteStandalone","237279923"),we.legacyControlId="fseaPaste",we));let lh;this.addCommandToMaps((lh=new Yd.a("Clipboard_MLR","237279923"),lh.legacyControlId="fseaNewPaste",lh));let rj;this.addCommandToMaps((rj=new Yd.a("InsertOnlinePictureStandalone","1685987254"),
rj.legacyControlId="fseaInsertOnlinePicture",rj));let Aj;this.addCommandToMaps((Aj=new Yd.a("InsertPictureFromHostStandalone","720118144"),Aj.legacyControlId="fseaInsertOnlinePictureFromHost",Aj.queryCommandId="3612507612",Aj))}JSd(){this.addTabToMap("Picture","3523575366");this.addTabToMap("Table","1898844988")}}Kp.QQi="Cut";Kp.EIi="Copy";Kp.nNk="Paste";Kp.iNk="PasteAsTextOnly";Kp.hNk="PasteAsTextOnlyContextMenu";Object(m.a)(Kp,"Box4ReactCommandDefinitionMapping",tM.a,[]);class Qj extends Ar{constructor(a,
b,c){super();this.uqf=b;this.Rm=c;this.vb(a)}vb(a){a.ra(C.a.Mld,yb.a.application,Object(I.a)(this,this.bgh,"populateContextMenu"),96);a.ra(C.a.ggh,yb.a.application,Object(I.a)(this,this.bgh,"populateContextMenu"),96)}show(a,b,c){let f=null,l=new Sys.UI.Bounds(0,0,0,0);const y=this.Coj(a);if(y&&(a=a.Va.node)&&(a=a.qc(sa.InteractiveViewManager.instance.Rd.Na))){l=T.a.$t(a,y.end);if(w.AFrameworkApplication.isRtl&&l.x>b.x||!w.AFrameworkApplication.isRtl&&l.x+l.width<b.x||l.y+l.height<b.y)l=T.a.$t(a,y.end-
1);b.x=l.x+(w.AFrameworkApplication.isRtl?0:l.width);b.y=l.y+l.height;f=6}Ar.Xtd("mnuSpellingError",new Sys.UI.Bounds(b.x,b.y,l.width,l.height),c,f)}bgh(a,b,c,f,l){if(1===c)return 32;a=l.Pu;l=l.zd;b=Object.assign(new On.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]});this.tMi(b,a);l.MenuItems=b;return 32}Gfe(a,b){return this.QCh(a)||Qj.kJf(C.a.mergeCells)||Qj.kJf(C.a.splitCells)||this.uxl(a,b)||this.evl(a,b)||Qj.swl()||Qj.tCh(a).returnValue}QCh(a){return 2===Rc.App.Lb.mode&&
this.P1c(a)}w3b(a,b,c,f=null){if(this.QCh(a)){c=this.Boj(a);var l=bb.a.He(c.lcid);l=l?l.name:"UNKNOWN";var y=Object(Wa.a)(To.a,c)?c.typeId:"";ka.ULS.sendTraceTag(8712398,324,50,"ErrorType:{0}, ProofingType:{1}, CritiqueId:{2}, CultureTag:{3}",c.errorType,c.proofingType,y,l);f?(a=this.uqf.s3b(a,c))&&f.push.apply(f,a):b.append(this.uqf.create(a,c))}}Boj(a){return this.Rm.UTa(a.Va).Eh}P1c(a){return this.Rm.qsc(a)}p6f(){return null}Coj(a){return this.P1c(a)?this.Rm.UTa(a.Va):(a=this.p6f(a))?new gl.a(a.LN,
a.Mb):null}uxl(a,b){if(2!==Rc.App.Lb.mode||!a||!Qj.y_j&&this.vxl(a,b))return!1;a=ub.a.cSa(a.toArray());return!!Qj.ym.l3(a,14)}vxl(a,b){return 2===b||3===b&&!this.P1c(a)}evl(a,b){return 3!==b||this.P1c(a)}static get Uf(){return Qj.fh||(Qj.fh=Ib.a.instance.resolve("Box4.List.IListReader"))}static get ym(){return Ch.ContextSetEditor.instance}static get y_j(){return 1===Rc.App.mode}static get aYj(){null==Qj.qHd&&(Qj.qHd=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("HyperlinkContextMenuOnEOPFixIsEnabled"):
!1);return Qj.qHd}static get Olc(){null==Qj.r3a&&(Qj.r3a=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("MultiParagraphHyperlinkEditEnabled"):!1);return Qj.r3a}static get $S(){null==Qj.rN&&(Qj.rN=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Qj.rN}static kJf(a){return 32===w.AFrameworkApplication.Ra.processAction(a,1)}static swl(){return 2===Rc.App.Lb.mode&&!!Rc.App.hE.nT&&Rc.App.hE.nT.qrg("510284732")}static tCh(a){let b,
c;b=c=!1;if(!a)return{returnValue:!1,WUa:b,l$b:c};if(Qj.Olc)return Qj.hwl(a);if(!(a.gda||Qj.aYj&&2===a.length&&a.jf.contextId===yb.a.endOfParagraph))return{returnValue:!1,WUa:b,l$b:c};a=a.Va.clone();b=32===w.AFrameworkApplication.Ra.ei(a,C.a.bKa,1,!0,null,null);c=32===w.AFrameworkApplication.Ra.ei(a,C.a.insertHyperlink,1,!0,null,null);return{returnValue:b||c,WUa:b,l$b:c}}static hwl(a){let b;let c;var f=a.Va.clone();c=Qj.$S&&cg.m(f);b=!c&&32===w.AFrameworkApplication.Ra.ei(f,C.a.bKa,1,!0,null,null);
if(a.gda||2===a.length&&a.jf.contextId===yb.a.endOfParagraph)f=!c&&32===w.AFrameworkApplication.Ra.ei(f,C.a.insertHyperlink,1,!0,null,null);else{f=!0;const l=a.length;for(let y=0;y<l;y++){const H=a.ga(y).clone();if(H.contextId===yb.a.paragraph||H.contextId===yb.a.textRange)(c=Qj.$S&&cg.m(H))||(f=32===w.AFrameworkApplication.Ra.ei(H,C.a.insertHyperlink,1,!0,null,null)&&f);else if(H.contextId!==yb.a.endOfParagraph)return f=b=!1,{returnValue:!1,WUa:b,l$b:f}}}return{returnValue:b||f,WUa:b,l$b:f}}static HLi(a,
b){let c=!1,f=!1;({WUa:c,l$b:f}=Qj.tCh(a)).returnValue&&(c?f?b.push(Qj.lbe(["EditHyperlink","SelectHyperlink","OpenHyperlink","CopyHyperlink","RemoveHyperlink"])):b.push(Qj.lbe(["OpenHyperlink"])):f&&b.push(Qj.lbe(["InsertLink"])))}static lbe(a){const b=Object.assign(new Rk.a,{ControlList:[]});for(const c of a)Array.add(b.ControlList,Object.assign(new hg.a,{ExternalId:c}));return b}}Qj.qHd=null;Qj.fh=null;Qj.r3a=null;Qj.rN=null;Object(m.a)(Qj,"AEditSurfaceContextMenu",Ar,[]);class Uz extends Qj{constructor(a,
b,c,f,l,y,H,Q,ia,wa){super(a,c,b,void 0,wa);this.nXa=0;this.gve=f;this.gHa=l;this.la=y;this.kcd=this.la.JKb;this.ugc=this.la.A$b;this.J_g=this.la.g3c;this.Q_g=this.la.mqe;this.VYa=this.la.Ekb;this.ogk=this.la.Woc;this.iUg=wa;this.oD=b;this.iWg=H;this.LE=Q;this.Sb=ia;this.Ebd=this.la.FOk}tMi(a,b){const c=[];switch(this.nXa){case 4:this.Tra(c,!0);this.Nxf(c);this.$bi(c);this.rci(c);this.VYa&&this.Bdi(c);this.o_b(c);this.EQa(c);break;case 7:case 8:case 13:case 15:case 11:case 14:case 16:this.Tra(c,!1);
this.GSd(c,this.nXa);this.o_b(c);this.EQa(c);this.Avb(c);break;case 6:case 5:this.la.b3e&&this.ayf(c);this.Tra(c,!1);this.GSd(c,this.nXa);this.la.JKb&&this.la.tzh&&this.Kxf(c);this.EQa(c);this.Avb(c);break;case 2:this.Tra(c,!0);this.QIc(c,!0);this.la.Un&&this.PIc(c);break;case 1:this.Tra(c,!1);this.QIc(c,!1);this.la.$Fh&&this.aei(c);this.Nxf(c);this.Dxf(c);lx.mAh&&this.uyf(c);this.la.Un&&this.PIc(c);this.o_b(c);this.EQa(c);this.Avb(c);break;case 3:this.Oai(c);this.Avb(c);break;case 19:this.Tdi(c);
this.QIc(c,!1);this.Dxf(c);lx.mAh&&this.uyf(c);w.AFrameworkApplication.fa.ka("PPTSorterViewSectionMenuEnabled")&&this.PIc(c);this.o_b(c);break;case 21:this.Hei(c);break;case 20:this.Tra(c,!0);this.QIc(c,!0);w.AFrameworkApplication.fa.ka("PPTSorterViewSectionMenuEnabled")&&this.PIc(c);this.o_b(c);break;case 9:this.Tra(c,!1);this.EQa(c);break;case 22:this.Tra(c,!1);this.GSd(c,this.nXa);this.EQa(c);break;case 10:this.Tra(c,!1);this.Pci(c);this.EQa(c);this.Avb(c);break;case 17:this.Kci(c);break;case 18:this.Lci(c);
break;case 0:if(this.Sb.Cj()){this.la.b3e&&this.ayf(c);var f=sa.InteractiveViewManager.instance.Rd.Nb.Pa.mb;this.w3b(f,null,b,c);this.Tra(c,!1);this.la.powerPointSmartLookupIsEnabled&&(this.Sdi(c),this.fei(c));3===b&&this.GZj(f)&&this.Cbi(c);this.ddi(c);Qj.HLi(f,c);this.lPi(f,c);this.kPi(f,c);this.kcd&&this.Kxf(c);this.nKi(c);this.EQa(c);this.Avb(c)}}for(const l of c)Array.add(a.MenuSectionList,l);this.nXa=0}nwh(a){this.nXa=a}ht(){return Object.assign(new Rk.a,{ControlList:[]})}txl(a){if(!this.J_g&&
!this.Q_g||2!==Rc.App.Lb.mode)return!1;a=ub.a.cSa(a.toArray());return!!this.gHa.l3(a,14)}sxl(a){if(!a||!this.ogk||2!==Rc.App.Lb.mode)return!1;a=ub.a.cSa(a.toArray());return!!this.gHa.l3(a,14)}Tra(a,b){const c=this.ht();b||(Array.add(c.ControlList,Object.assign(new hg.a,{ExternalId:"Cut"})),Array.add(c.ControlList,Object.assign(new hg.a,{ExternalId:"Copy"})));this.Yxf(a,c)}Yxf(a,b){const c=Object.assign(new Rk.a,{DisplayMode:"Size24by24",ControlList:[],Title:ResourceStrings.L_PasteOptions,ShowMenuSectionTitleIcon:!1,
ShowMenuSectionTitleBackground:!1,MenuSectionTitleFocusable:!1}),f=Object.assign(new Cq.a,{Id:"PasteOptions",ExternalId:"PasteOptionsSection",ExternalGalleryId:"PasteOptionsGallery",Type:4,Width:5,ElementDimensions:"Size24by24",GalleryItems:[]});Array.add(c.ControlList,f);for(let l=1;5>=l;l++)f.GalleryItems.push(this.Fxb(l));a.push(b);a.push(c)}Fxb(a){const b={root:{width:"24px",height:"24px"}};let c,f,l;switch(a){case 1:l="ContextMenu.Paste";a="Paste_20";c="3642315978";f=ResourceStrings.L_Paste;
break;case 2:l="ContextMenu.PasteKeepingDestinationTheme";a="Pastedestinationtheme_20";c="4207422373";f=ResourceStrings.L_PasteWithDestinationTheme;break;case 3:l="ContextMenu.PasteKeepingSourceFormatting";a="Pastesourceformatting_20";c="2529825506";f=ResourceStrings.l_PasteWithSourceTheme;break;case 4:l="ContextMenu.PasteAsImage";a="Pasteaspicture_20";c="1302928870";f=ResourceStrings.l_PasteAsImage;break;case 5:l="ContextMenu.PasteTextOnly";a="PasteTextOnly_20";c="2061487721";f=ResourceStrings.L_PasteTextOnly;
break;default:l="ContextMenu.Paste",a="Paste_20",c="3642315978",f=ResourceStrings.L_Paste}return Object.assign(new kE.a,{Id:l,Icon:a,Alt:f,PreviewIconStyle:b,FullIconStyle:b,Command:c})}Hei(a){const b=this.ht();Array.add(b.ControlList,Object.assign(new hg.a,{ExternalId:"CopyInVersionHistory"}));a.push(b)}Tdi(a){const b=this.ht();Array.add(b.ControlList,Object.assign(new hg.a,{ExternalId:"Cut"}));Array.add(b.ControlList,Object.assign(new hg.a,{ExternalId:"Copy"}));this.Yxf(a,b)}QIc(a,b){const c=this.ht();
Array.add(c.ControlList,Object.assign(new hg.a,{ExternalId:"NewSlideWithoutDialog"}));b||(Array.add(c.ControlList,Object.assign(new hg.a,{ExternalId:"DuplicateSlide"})),Array.add(c.ControlList,Object.assign(new hg.a,{ExternalId:"DeleteSlide"})));a.push(c)}$bi(a){if(this.Ebd){const b=this.ht();b.ControlList.push(Object.assign(new hg.a,{ExternalId:"FormatBackground"}));a.push(b)}}Oai(a){const b=this.ht();Array.add(b.ControlList,Object.assign(new hg.a,{ExternalId:"Paste"}));Array.add(b.ControlList,Object.assign(new hg.a,
{ExternalId:"NewSlideWithoutDialog"}));a.push(b)}Dxf(a){const b=this.ht();Array.add(b.ControlList,Object.assign(new hg.a,{ExternalId:"HideSlide"}));this.la.xge&&Array.add(b.ControlList,Object.assign(new hg.a,{ExternalId:"UnhideSlide"}));a.push(b)}uyf(a){const b=this.ht();Array.add(b.ControlList,Object.assign(new hg.a,{ExternalId:"ShareSlide"}));a.push(b)}Lci(a){const b=this.v5f();a.push(b)}PIc(a){const b=this.ht();Array.add(b.ControlList,Object.assign(new hg.a,{ExternalId:"AddSection"}));a.push(b)}GSd(a,
b){const c=this.ht();7===b?(this.la.DKa?Array.add(c.ControlList,Object.assign(new hg.a,{ExternalId:"ChangePictureContextMenu"})):Array.add(c.ControlList,Object.assign(new hg.a,{ExternalId:"ChangePicture"})),this.la.qxb&&this.aci(c),this.la.Wua&&!this.la.j3&&Array.add(c.ControlList,Object.assign(new hg.a,{ExternalId:"AlternativeText"}))):13===b?this.la.DKa&&Array.add(c.ControlList,Object.assign(new hg.a,{ExternalId:"ChangeGraphicContextMenu"})):8===b?Array.add(c.ControlList,Object.assign(new hg.a,
{ExternalId:"SmartArtEditText"})):14!==b&&15!==b&&16!==b&&22!==b&&Array.add(c.ControlList,Object.assign(new hg.a,{ExternalId:"BeginEditShapeText"}));22!==b&&(this.Bxf(c),this.la.ZSc&&this.txf(c));this.la.Wua&&this.la.j3&&14!==b&&(b=new hg.a,b.ExternalId="AlternativeText",c.ControlList.push(b));this.gxf(c);this.YEf(c);this.zvh(c);a.push(c)}Nxf(a){const b=this.ht();Array.add(b.ControlList,Object.assign(new hg.a,{ExternalId:this.la.n0a?"ChangeLayoutFlyout":"ChangeLayout"}));a.push(b)}Kxf(a){const b=
this.ht();this.ugc&&Array.add(b.ControlList,Object.assign(new hg.a,{ExternalId:"ImmersiveReader"}));Array.add(b.ControlList,Object.assign(new hg.a,{ExternalId:"OpenPowerPointLanguageDialog"}));a.push(b)}o_b(a){if(this.ugc){var b=this.ht();Array.add(b.ControlList,Object.assign(new hg.a,{ExternalId:"ImmersiveReader"}));a.push(b)}}zvh(a){Array.add(a.ControlList,Object.assign(new hg.a,{ExternalId:"SendToBackFlyout"}))}YEf(a){Array.add(a.ControlList,Object.assign(new hg.a,{ExternalId:"BringToFrontFlyout"}))}Bxf(a){Array.add(a.ControlList,
Object.assign(new hg.a,{ExternalId:"GroupAnchor"}))}gxf(a){Array.add(a.ControlList,Object.assign(new hg.a,{ExternalId:"ShowHideFormatShapePane"}))}aci(a){Array.add(a.ControlList,Object.assign(new hg.a,{ExternalId:"FormatPicture"}))}txf(a){Array.add(a.ControlList,Object.assign(new hg.a,{ExternalId:"FixIt"}))}Pci(a){const b=this.ht();this.Bxf(b);this.la.ZSc&&this.txf(b);this.gxf(b);this.YEf(b);this.zvh(b);if(this.la.Wua&&this.la.j3){let c=new hg.a;c.ExternalId="AlternativeText";b.ControlList.push(c)}a.push(b)}EQa(a){const b=
this.ht();Array.add(b.ControlList,Object.assign(new hg.a,{ExternalId:"InsertComment"}));a.push(b)}rci(a){const b=this.ht();Array.add(b.ControlList,Object.assign(new hg.a,{ExternalId:"DesignerHome"}));a.push(b)}Bdi(a){const b=this.ht();Array.add(b.ControlList,Object.assign(new hg.a,{ExternalId:"ShowHideRuler"}));a.push(b)}QLi(){const a=this.gve.QOi();return Object.assign(new hg.a,{ExternalId:"SmartLookupContextMenu",LabelText:a})}Sdi(a){const b=this.ht();Array.add(b.ControlList,this.QLi());a.push(b)}fei(a){if(!this.gve.izi()){var b=
this.gve.gPi();if(b){var c=this.ht();Array.add(c.ControlList,Object.assign(new hg.a,{ExternalId:"SmartLookupSynonyms",LabelText:b}));a.push(c)}}}ayf(a){const b=this.ht();b.ControlList.push(Object.assign(new hg.a,{ExternalId:"RecommendationContextMenuFlyout"}));a.push(b)}ddi(a){const b=this.ht();Array.add(b.ControlList,Object.assign(new hg.a,{ExternalId:"ParagraphOptions"}));a.push(b)}Cbi(a){const b=this.ht();Array.add(b.ControlList,Object.assign(new hg.a,{ExternalId:"Delete"}));a.push(b)}aei(a){const b=
this.ht();Array.add(b.ControlList,Object.assign(new hg.a,{ExternalId:"SummarizeSlides"}));a.push(b)}nKi(a){var b=Ib.a.instance.qb("PowerPointWebEditor.IContextMenuExtensibilityHandler");b&&(b=b.x9i())&&a.push(b)}lPi(a,b){a&&this.txl(a)&&(a=this.ht(),this.J_g&&Array.add(a.ControlList,Object.assign(new hg.a,{ExternalId:"MergeTableCells"})),this.Q_g&&Array.add(a.ControlList,Object.assign(new hg.a,{ExternalId:"SplitTableCells"})),b.push(a))}kPi(a,b){this.sxl(a)&&(a=this.ht(),Array.add(a.ControlList,Object.assign(new hg.a,
{ExternalId:"SetSizeAnchor"})),Array.add(a.ControlList,Object.assign(new hg.a,{ExternalId:"TableDistribute"})),b.push(a))}GZj(a){return this.oD.qsc(a)}Kci(a){const b=this.v5f();Array.add(b.ControlList,Object.assign(new hg.a,{ExternalId:"NewSlideWithoutDialog"}));a.push(b)}v5f(){const a=this.ht();Array.add(a.ControlList,Object.assign(new hg.a,{ExternalId:"RenameSection"}));Array.add(a.ControlList,Object.assign(new hg.a,{ExternalId:"RemoveSection"}));Array.add(a.ControlList,Object.assign(new hg.a,{ExternalId:"MoveSectionUp"}));
Array.add(a.ControlList,Object.assign(new hg.a,{ExternalId:"MoveSectionDown"}));return a}Avb(a){this.iWg&&this.iWg.s3b(this.W6b(),a)}W6b(){return this.LE.instance?this.LE.instance.W6b():[]}}Object(m.a)(Uz,"EditSurfaceContextMenu",Qj,[]);class uM{constructor(a,b,c,f,l,y,H,Q,ia,wa){this.Gjc=null;this.KGb=0;this.YO=b;this.uu=c;this.N4=f;this.wb=y;this.Pfk=H;this.ia=ia;this.Ic=Q;this.Ic.kfi(Object(I.a)(this,this.g8g,"onCUIStatusChanged"));this.Ic.$Ic(Object(I.a)(this,this.SU,"onFocusChanged"));this.Ic.fJc(Object(I.a)(this,
this.uib,"onSetFocus"));this.Wcd=wa}get inKeytipMode(){return appChrome.api.inKeytipMode()}dispose(){this.Ic.k7k(Object(I.a)(this,this.g8g,"onCUIStatusChanged"));this.Ic.Zod(Object(I.a)(this,this.SU,"onFocusChanged"));this.Ic.BVe(Object(I.a)(this,this.uib,"onSetFocus"))}initialize(){this.vb();this.PA()}SU(){}uib(a,b){b.Shb!==jb.a.Raa||b.zKb===D.AFrame.Fhb||b.zKb.endsWith("/modal")||appChrome.api.enterKeytipMode()}CIl(a){this.KGb|=a;this.Gjc||(this.Gjc=new dd.a(0,1,0,Object(I.a)(this,this.apl,"setTimeOutWithCurrentActionContext"),
90,"11"),this.Gjc.customData=new Date,this.wb.Hb(this.Gjc))}vb(){this.ia.ra(ea.a.j2,hc.a.application,Object(I.a)(this,this.UCj,"handleOpenMenu"),64)}UCj(a,b,c,f,l){return this.j2(l)?32:8}apl(a){Nc.a.o0i(Object(I.a)(this,this.PA,"poll"),Object(qa.a)(Date,a.customData));this.Gjc=null}g8g(a,b){this.CIl(b.qBl)}PA(){this.Pfk.clearCache();0!==(this.KGb&1)&&this.uu.PA();0!==(this.KGb&2)&&this.YO.PA();0!==(this.KGb&4)&&this.N4.PA();this.KGb=0}j2(a){return this.Wcd.j2(a)}}Object(m.a)(uM,"CUIManager",null,
[224,107]);var lE=d(1277),mE=d(1248),IR=d(1103),nE=d(1124);class tt{constructor(){this.italic=0;this.H3c=!1;this.underline=0;this.BV=this.Lxd=!1;this.superscript=0;this.rvd=!1;this.subscript=0;this.nvd=!1;this.strikethrough=0;this.fvd=!1;this.nt=0;this.GQc=!1;this.fontName=null;this.D6b=this.owd=this.lTc=this.kTc=!1;this.highlight=0;this.hZc=!1;this.bold=this.italic=this.underline=this.strikethrough=this.nt=this.superscript=this.subscript=2;this.fontColor=this.highlight=this.fontSize=-1;this.gw=sd.Font.ZQj;
this.Opa=-1;this.pWd=this.H3c=this.Lxd=this.BV=this.rvd=this.nvd=this.fvd=this.GQc=this.kTc=this.lTc=this.owd=this.D6b=this.hZc=!1}}Object(m.a)(tt,"FormattingData",null,[]);var oE=d(843),JR=d(809);class Vk{constructor(){this.Um=this.Aib=0;this.zd=null;this.TE=!1;this.tL=null}}Object(m.a)(Vk,"CuiEnabledInfo",null,[]);class $g{constructor(){this.Um=this.Aib=0;this.zd=null;this.TE=this.hpe=this.ipe=this.lX=this.jr=this.hge=!1;this.tL=null}}Object(m.a)($g,"CuiExecuteInfo",null,[]);class KR{constructor(){this.k4e=
new xq.a;this.Une=!1}}Object(m.a)(KR,"TextRangeStyleData",null,[]);class Dg{constructor(){this.hb=new Jd.a;this.Zc=new Jd.a;this.Tgf=new tt;this.ypf=new oE.a;this.IFd=this.HFd=!1}initialize(){Dg.BGh=Dg.w1d();this.hb.$(C.a.undo,Dg.K$b);this.hb.$(C.a.redo,Dg.K$b);this.hb.$(C.a.jhd,Dg.K$b);this.hb.$(C.a.ggh,Dg.mHl);this.hb.$(C.a.openInClient,Dg.GJk);this.hb.$(G.a.close,Dg.iCi);this.hb.$(C.a.pL,Dg.pUi);this.hb.$(C.a.font,Dg.j8d);this.hb.$(C.a.Xq,Object(I.a)(this,this.Z8d,"genericFontSizeExecuteBridge"));
w.AFrameworkApplication.fa.ka("FontPreviewEnabled")&&(this.hb.$(C.a.n6,Dg.j8d),this.hb.$(C.a.tLa,Dg.j8d),this.hb.$(C.a.FKa,Object(I.a)(this,this.Z8d,"genericFontSizeExecuteBridge")),this.hb.$(C.a.P0a,Object(I.a)(this,this.Kcl,"revertPreviewFontSizeExecuteBridge")));this.hb.$(C.a.bold,Dg.rxb);this.hb.$(C.a.setItalic,Dg.rxb);this.hb.$(C.a.underline,Dg.rxb);this.hb.$(C.a.strikethrough,Dg.rxb);this.hb.$(C.a.superscript,Dg.rxb);this.hb.$(C.a.subscript,Dg.rxb);this.hb.$(C.a.tpc,Object(I.a)(this,this.qya,
"queryFormattingExecuteBridge"));this.hb.$(C.a.Dpc,Object(I.a)(this,this.qya,"queryFormattingExecuteBridge"));this.hb.$(C.a.oqc,Object(I.a)(this,this.qya,"queryFormattingExecuteBridge"));this.hb.$(C.a.eqc,Object(I.a)(this,this.qya,"queryFormattingExecuteBridge"));this.hb.$(C.a.gqc,Object(I.a)(this,this.qya,"queryFormattingExecuteBridge"));this.hb.$(C.a.ASe,Object(I.a)(this,this.qya,"queryFormattingExecuteBridge"));this.hb.$(C.a.hqc,Object(I.a)(this,this.qya,"queryFormattingExecuteBridge"));this.hb.$(C.a.Jmd,
Object(I.a)(this,this.qya,"queryFormattingExecuteBridge"));this.hb.$(C.a.xpc,Object(I.a)(this,this.qya,"queryFormattingExecuteBridge"));this.hb.$(C.a.Kmd,Object(I.a)(this,this.qya,"queryFormattingExecuteBridge"));this.hb.$(C.a.PRe,Object(I.a)(this,this.VVk,"queryFormatPainterExecuteBridge"));this.hb.$(C.a.Epc,Object(I.a)(this,this.Umd,"queryParaFormattingExecuteBridge"));this.hb.$(C.a.Rpc,Object(I.a)(this,this.Umd,"queryParaFormattingExecuteBridge"));this.hb.$(C.a.wpc,Object(I.a)(this,this.Umd,"queryParaFormattingExecuteBridge"));
this.hb.$(C.a.ypc,Object(I.a)(this,this.Umd,"queryParaFormattingExecuteBridge"));this.hb.$(C.a.TC,Dg.yYf);this.hb.$(C.a.My,Dg.yYf);this.hb.$(G.a.EZd,Dg.vpc);this.hb.$(C.a.sCb,Dg.K$b);this.Zc.$(C.a.UJb,Dg.ZPc);this.Zc.$(C.a.VJb,Dg.ZPc);this.Zc.$(C.a.xoc,Dg.ZPc);this.Zc.$(C.a.woc,Dg.ZPc);this.Zc.$(C.a.tpc,Dg.Cya);this.Zc.$(C.a.Dpc,Dg.Cya);this.Zc.$(C.a.oqc,Dg.Cya);this.Zc.$(C.a.eqc,Dg.Cya);this.Zc.$(C.a.gqc,Dg.Cya);this.Zc.$(C.a.ASe,Dg.Cya);this.Zc.$(C.a.hqc,Dg.Cya);this.Zc.$(C.a.Jmd,Dg.Cya);this.Zc.$(C.a.xpc,
Dg.Cya);this.Zc.$(C.a.Kmd,Dg.Cya);this.Zc.$(C.a.Epc,Dg.Kod);this.Zc.$(C.a.wpc,Dg.Kod);this.Zc.$(C.a.Rpc,Dg.Kod);this.Zc.$(C.a.ypc,Dg.Kod);this.hb.$(C.a.NLf,Object(I.a)(this,this.QPj,"insertHyperLinkBridge"));this.hb.$(C.a.KZd,Object(I.a)(this,this.MLf,"commandingInputMethodExecuteBridge"));this.hb.$(C.a.RLf,Object(I.a)(this,this.MLf,"commandingInputMethodExecuteBridge"));this.hb.$(C.a.OLf,Object(I.a)(this,this.ZPj,"insertOnLinePictureExecuteBridge"));this.hb.$(C.a.PLf,Object(I.a)(this,this.oQj,"insertSymbolBridge"));
this.hb.$(C.a.QLf,Object(I.a)(this,this.pDi,"commandingInsertTableExecuteBridge"));this.hb.$(C.a.qDi,Object(I.a)(this,this.pxk,"navToPageExecuteBridge"));this.hb.$(C.a.LLf,Dg.KLf);this.hb.$(C.a.JZd,Dg.KLf);w.AFrameworkApplication.fa.ka("CuiActionBridgeBridgeFunctionEnabledInWebEditor")&&this.Zc.$(G.a.QMb,Dg.$fl)}clearCache(){this.Tgf=new tt;this.ypf=new oE.a;this.IFd=this.HFd=!1}K6f(a,b,c){const f=this.hb.ga(a);f?c=f(a,b,c):(c=new $g,c.zd=b);c.Aib=a;c.Um||(c.Um=Dg.Ntk(a));tg.a("isSharedUxGateEnabled")&&
appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.FlagExclusivelyMappedCommands")&&this.iDi(a,b)&&(c.zd||(c.zd={}),"object"===typeof c.zd&&(c.zd.MappedCommand=!0));return c}lVc(a,b=null){const c=this.Zc.ga(a);b=c?c(a,b):new Vk;b.Aib=a;b.Um||(b.Um=a);return b}qya(){const a=new $g;a.hge=this.IFd;this.IFd=!0;a.Um=C.a.RKb;a.zd=this.Tgf;a.lX=!0;return a}Umd(){const a=new $g;a.hge=this.HFd;this.HFd=!0;a.Um=C.a.rya;a.zd=this.ypf;a.hpe=!0;a.lX=!0;return a}Z8d(a,b){const c=new $g;c.jr=!0;let f=
0;({number:f}=ma.a.JMk(b.CommandValueId||b.Value,w.AFrameworkApplication.numberFormat));if(isNaN(f))return Rc.App.Lb.updateCommandUI(),c.tL=!1,c;a===C.a.FKa&&(b[bn.a.dba]=!1);c.zd=Dg.n0d(Math.floor(2*f),b);return c}Kcl(a,b){a=new $g;a.jr=!0;b[bn.a.dba]=!1;a.zd=Dg.n0d(0,b);return a}MLf(a){var b={Visible:!0};a===C.a.KZd?(b.LabelText="Undo",b.SourceControlId="btnUndo"):(b.LabelText="Redo",b.SourceControlId="btnRedo");a=new mE.a(b,2);b=new $g;b.zd=a;return b}ZPj(a,b){a=new $g;const c=new J.DictionaryPropertySet;
b=b.Value?b.Value:null;if(!b||""===b)return null;b=String.format("<img src={0}>",b);c.setValue(ee.a.VU,b);a.zd=c;return a}QPj(a,b){a=new $g;b.Source="CommandingInterface";a.zd=b;return a}pDi(a,b){a=new $g;a.jr=!0;const c=new BI;c.rows=b.Row;c.columns=b.Col;a.zd=c;return a}oQj(a,b){a=new $g;a.jr=!0;b=b.Value;a.zd=new J.DictionaryPropertySet;const c=this.rXc(b),f={};f.SourceControlId="symbol_"+b+"_"+c;f.InnerHtml=String.format('<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>',
c);a.zd=f;return a}pxk(a,b){a=new $g;a.zd=b.Value?b.Value:"";return a}VVk(){const a=new $g;a.zd=Ib.a.instance.qb("Box4.IFormatPainter");a.lX=!0;return a}rXc(a){return Dg.BGh[a.toString()]}iDi(a,b){a=b&&b.launcherCommandId?b.launcherCommandId:a;b=!!this.Zc.ga(a)||!!this.hb.ga(a);return!w.AFrameworkApplication.Ra.GT(a)&&b}static w1d(){return{0:"\u2022",1:"\u20ac",2:"\u00a3",3:"\u00a5",4:"\u00a9",5:"\u00ae",6:"\u2122",7:"\u00b1",8:"\u2260",9:"\u2264",10:"\u2265",11:"\u00f7",12:"\u00d7",13:"\u221e",14:"\u00b5",
15:"\u03b1",16:"\u03b2",17:"\u03c0",18:"\u03a9",19:"\u03a3",20:"\u00b0",21:"\u0394",22:"\u263a",23:"\u2665",24:"\u20b9"}}static g0b(a,b){var c=Object(qa.a)(tt,a.zd),f=Object(qa.a)(oE.a,a.zd);let l=!0;switch(a.Aib){default:l=!1;break;case C.a.djh:b[wh.a.On]=!0;break;case C.a.tpc:b[wh.a.On]=1===c.bold;break;case C.a.Dpc:b[wh.a.On]=1===c.italic;break;case C.a.oqc:b[wh.a.On]=1===c.underline;break;case C.a.ASe:b[VG.a.On]=1===c.subscript;break;case C.a.gqc:b[wh.a.On]=1===c.subscript;break;case C.a.hqc:b[wh.a.On]=
1===c.superscript;break;case C.a.eqc:b[wh.a.On]=1===c.strikethrough||1===c.nt;break;case C.a.Jmd:b[no.a.IsFreeForm]=!0;b[no.a.Value]=void 0!==c.fontName&&null!==c.fontName?tb.a.r6f(c.fontName,c.Opa):"";break;case C.a.xpc:a="";-1!==c.fontSize&&(a=ma.a.yTc(c.fontSize/2,0,w.AFrameworkApplication.numberFormat));b[no.a.IsFreeForm]=!0;b[no.a.Value]=a;break;case C.a.Kmd:if(void 0!==c.fontName&&null!==c.fontName){if(a=1===c.bold,f=1===c.italic,a=aa.FontUtils.WVk(c.fontName,a,f,a&&f?Box4Intl.Box4Strings.L_FontNameBoldItalic:
a?Box4Intl.Box4Strings.L_FontNameBold:f?Box4Intl.Box4Strings.L_FontNameItalic:"{0}"),void 0===c.fontName||null===c.fontName)a=tb.a.r6f(c.fontName,c.Opa),a=appChrome.api.selectedFont(a,c.fontName)}else a=appChrome.api.selectedFont("");void 0!==a.isMissingFont&&null!==a.isMissingFont||void 0===a.name||null===a.name||""===a.name||(a.isMissingFont=aa.FontUtils.isMissingFont(void 0!==a.key&&null!==a.key&&""!==a.key?a.key:a.name));b[Pn.SelectedFont]=a;break;case C.a.Epc:b[wh.a.On]=1===f.Vl;break;case C.a.wpc:b[wh.a.On]=
2===f.Vl;break;case C.a.Rpc:b[wh.a.On]=3===f.Vl;break;case C.a.ypc:b[wh.a.On]=6===f.Vl;break;case C.a.PRe:if(c=Object(qa.a)(312,a.zd))b[wh.a.On]=c.PL;case G.a.EZd:}return l}static yYf(){return new $g}static vpc(a,b){a=new $g;a.zd=b;a.lX=!0;return a}static K$b(a,b,c){a=new mE.a(b,c.InvocationMethod);b=new $g;b.zd=a;return b}static mHl(a,b){a=new mE.a(b,3);b=new $g;b.zd=a;return b}static GJk(a,b,c){a=new $g;IR.a.Lvg(c.CommandLocation)||26===c.CommandLocation||(a.zd=!1);return a}static IRe(){const a=
new $g;a.zd=new J.DictionaryPropertySet;a.lX=!0;return a}static pUi(){const a=new $g;a.zd=new J.DictionaryPropertySet;return a}static iCi(){const a=new $g;a.zd=Bi.b;return a}static ZPc(){const a=new Vk;a.zd=new J.DictionaryPropertySet;return a}static $fl(a,b=null){a=new Vk;a.zd=b;return a}static rxb(){const a=new $g;a.zd=new R(2);a.jr=!0;return a}static Kod(){const a=new Vk;a.Um=C.a.rya;return a}static Cya(){const a=new Vk;a.Um=C.a.RKb;return a}static j8d(a,b){const c=new $g;c.jr=!0;var f=b.CommandValueId?
b.CommandValueId:b.Value;c.zd=f;if(sd.Font.VVa()){const y=new tt;var l=b.MenuItemId;l&&(y.Opa=sd.Font.bvj(l));(l=Object(qa.a)(JR.a,b[Pn.Formatting]))&&(l.isBold||l.isItalic)&&(y.bold=l.isBold?1:0,y.italic=l.isItalic?1:0);y.fontName=f;c.zd=y}Dg.pbk(b);(a=w.AFrameworkApplication.fa.ka("FontPreviewEnabled")&&(a===C.a.n6||a===C.a.tLa))&&(b[bn.a.dba]=!1);c.zd=Dg.n0d(c.zd,b);a||(aa.FontUtils.IIc(f),f=b[Pn.RequestUpdateMru],void 0!==f&&null!==f&&appChrome.api.dispatch(appChrome.actions.addFontToMru(b.SourceControlId,
f)));return c}static pbk(a){void 0!==a[no.a.IsFreeForm]&&null!==a[no.a.IsFreeForm]&&a[no.a.IsFreeForm]?ka.ULS.sendTraceTag(51390360,324,50,"Font applied is not a valid menu item"):void 0!==a.MenuItemId&&null!==a.MenuItemId&&ka.ULS.sendTraceTag(51390361,324,50,String.format("Font applied is in MenuItemID:{0}",a.MenuItemId))}static KLf(a,b){a=new $g;b=b.Color?b.Color:null;if(!b||6!==b.length)return null;a.zd=Dg.U8a(b);a.jr=!0;return a}static U8a(a){return 6!==a.length?null:a.substring(4,6)+a.substring(2,
4)+a.substring(0,2)}static Ntk(a){switch(a){case C.a.KZd:return C.a.undo;case C.a.RLf:return C.a.redo;case C.a.QLf:return C.a.insertTable;case C.a.OLf:return C.a.t8;case C.a.PLf:return C.a.sVa;case C.a.NLf:return C.a.insertHyperlink;case C.a.LLf:return C.a.sr;case C.a.JZd:return C.a.Q1;default:return a}}static n0d(a,b){const c=new nE.a(a);return w.AFrameworkApplication.Aa.ob.Qp?new nE.a(a,b[bn.a.dba]):c}}Dg.BGh={};Object(m.a)(Dg,"CuiActionBridge",null,[]);class vM{constructor(){this.OUd=this.g0b=
this.zPe=this.eQe=null}}Object(m.a)(vM,"GeneralCuiUserHooks",null,[]);var LR=d(508);class Uv{constructor(){this.mV=this.h0a=null;this.menuItemId=0}}Object(m.a)(Uv,"QueryData",null,[]);let Bf;class Dd extends Dg{constructor(a,b,c,f,l,y,H,Q,ia){super();this.QUe=wa=>{let Ua=new $g;({pY:wa}=this.DKl(wa)).returnValue&&(Ua.TE=!0,Ua.Um=wa);return Ua};this.la=a;this.pa=b;this.aek=c;this.fGb=f;this.zc=l;this.Sb=y;this.Gb=H;this.TXa=Q;if(this.la.ka("IsPasteTextFloatieEnabled")&&!ia)throw Error.argumentNull("textPasteFloatieManager");
this.iY=ia}initialize(){super.initialize();this.ROj();this.iPj();this.jOj();this.VOj();this.yNj();this.fPj();this.BOj();this.BNj();this.aOj();this.JNj()}lVc(a,b=null){if(w.AFrameworkApplication.fa.ka("CuiActionBridgeBridgeFunctionEnabledInWebEditor")){const c=this.Zc.ga(a);b=c?c(a,b):new Vk;b.Aib=a;b.Um||(b.Um=a);b&&this.Gb&&1===this.Gb.ol&&!Dd.Jme(a)&&(b.tL=!1);return b}(b=super.lVc(a))&&this.Gb&&1===this.Gb.ol&&!Dd.Jme(a)&&(b.tL=!1);return b}ROj(){this.la.Fkb&&(this.Zc.$(ea.a.jjb,Object(I.a)(this,
this.Ooa,"remapRumTrackerEnabledBridge")),this.Zc.$(ea.a.yKb,Object(I.a)(this,this.Ooa,"remapRumTrackerEnabledBridge")),this.Zc.$(G.a.eQb,Object(I.a)(this,this.Ooa,"remapRumTrackerEnabledBridge")),this.Zc.$(ea.a.buc,Object(I.a)(this,this.Ooa,"remapRumTrackerEnabledBridge")),this.Zc.$(C.a.Umb,Object(I.a)(this,this.Ooa,"remapRumTrackerEnabledBridge")),this.Zc.$(G.a.zta,Object(I.a)(this,this.Ooa,"remapRumTrackerEnabledBridge")));this.Zc.$(ea.a.dMa,Object(I.a)(this,this.Ooa,"remapRumTrackerEnabledBridge"));
this.Zc.$(ea.a.bMa,Object(I.a)(this,this.Ooa,"remapRumTrackerEnabledBridge"));this.Zc.$(ea.a.Qga,Object(I.a)(this,this.Ooa,"remapRumTrackerEnabledBridge"));this.Zc.$(ea.a.Aza,Object(I.a)(this,this.Ooa,"remapRumTrackerEnabledBridge"));this.Zc.$(ea.a.Lxc,Object(I.a)(this,this.Ooa,"remapRumTrackerEnabledBridge"))}iPj(){this.hb.$(ea.a.ZKb,Object(I.a)(this,this.$E,"remapTextQueryExecute"));this.hb.$(ea.a.cLb,Object(I.a)(this,this.$E,"remapTextQueryExecute"));this.hb.$(ea.a.fLb,Object(I.a)(this,this.$E,
"remapTextQueryExecute"));this.hb.$(ea.a.LKa,Object(I.a)(this,this.$E,"remapTextQueryExecute"));this.hb.$(ea.a.MKa,Object(I.a)(this,this.$E,"remapTextQueryExecute"));this.hb.$(ea.a.OKa,Object(I.a)(this,this.$E,"remapTextQueryExecute"));this.hb.$(ea.a.yjb,Object(I.a)(this,this.$E,"remapTextQueryExecute"));this.hb.$(ea.a.RKa,Object(I.a)(this,this.$E,"remapTextQueryExecute"));this.hb.$(ea.a.QKa,Object(I.a)(this,this.$E,"remapTextQueryExecute"));this.hb.$(ea.a.PKa,Object(I.a)(this,this.$E,"remapTextQueryExecute"));
this.hb.$(ea.a.wjb,Object(I.a)(this,this.$E,"remapTextQueryExecute"));this.hb.$(ea.a.xjb,Object(I.a)(this,this.$E,"remapTextQueryExecute"));this.hb.$(ea.a.$Kb,Object(I.a)(this,this.$E,"remapTextQueryExecute"));this.hb.$(ea.a.dLb,Object(I.a)(this,this.$E,"remapTextQueryExecute"));this.hb.$(ea.a.NKa,Object(I.a)(this,this.$E,"remapTextQueryExecute"));this.hb.$(ea.a.zjb,Object(I.a)(this,this.$E,"remapTextQueryExecute"));this.hb.$(ea.a.bLb,Object(I.a)(this,this.$E,"remapTextQueryExecute"));this.hb.$(ea.a.aLb,
Object(I.a)(this,this.$E,"remapTextQueryExecute"));this.hb.$(ea.a.lSe,Dd.af);this.hb.$(ea.a.eLb,Object(I.a)(this,this.$E,"remapTextQueryExecute"));this.hb.$(ea.a.tya,Object(I.a)(this,this.$E,"remapTextQueryExecute"));this.hb.$(ea.a.oSe,Object(I.a)(this,this.$E,"remapTextQueryExecute"));this.hb.$(ea.a.Zmd,Object(I.a)(this,this.$E,"remapTextQueryExecute"));this.hb.$(ea.a.f0a,Object(I.a)(this,this.$E,"remapTextQueryExecute"));this.hb.$(ea.a.g0a,Object(I.a)(this,this.$E,"remapTextQueryExecute"));this.Zc.$(ea.a.ZKb,
Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.cLb,Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.fLb,Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.LKa,Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.MKa,Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.OKa,Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.yjb,Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.RKa,Object(I.a)(this,
this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.QKa,Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.PKa,Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.wjb,Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.xjb,Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.$Kb,Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.dLb,Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.NKa,Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));
this.Zc.$(ea.a.zjb,Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.bLb,Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.aLb,Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.eLb,Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.tya,Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.oSe,Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.Zmd,Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.f0a,
Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.g0a,Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));this.hb.$(ea.a.$Jb,Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.fKb,Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.rKb,Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.jya,Object(I.a)(this,this.O3c,"justifyExecuteBridge"));this.hb.$(ea.a.lya,Object(I.a)(this,this.O3c,"justifyExecuteBridge"));this.hb.$(ea.a.nya,Object(I.a)(this,this.O3c,
"justifyExecuteBridge"));this.hb.$(ea.a.L_a,Object(I.a)(this,this.O3c,"justifyExecuteBridge"));this.hb.$(ea.a.J_a,Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.iKb,Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.lKb,Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.K_a,Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.jKb,Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.mKb,Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.cjb,
Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.Zib,Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.t1,Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.s1,Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.r1,Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.oKb,Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.gKb,Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.bjb,Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.Koc,
Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.hKb,Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.Loc,Dd.gvg);this.hb.$(ea.a.Moc,Dd.gvg);this.hb.$(ea.a.Coa,Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.AKa,Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.kOb,Object(I.a)(this,this.hvg,"listMarkerGalleryShapeExecuteBridge"));this.hb.$(ea.a.TNb,Object(I.a)(this,this.hvg,"listMarkerGalleryShapeExecuteBridge"));this.hb.$(ea.a.Eoc,Object(I.a)(this,
this.Ht,"remapTextExecute"));this.hb.$(ea.a.Foc,Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.kya,Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.eKb,Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.Goc,Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.dKb,Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.kKb,Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.Poc,Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.nKb,
Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.insertHyperlink,Object(I.a)(this,this.i5k,"remapInsertHyperlinkExecute"));this.hb.$(ea.a.mya,Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.$ib,Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.pKb,Object(I.a)(this,this.Ht,"remapTextExecute"));this.hb.$(ea.a.qKb,Object(I.a)(this,this.Ht,"remapTextExecute"));this.Zc.$(ea.a.$Jb,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.fKb,Object(I.a)(this,this.Ws,
"remapTextEnabled"));this.Zc.$(ea.a.rKb,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.jya,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.lya,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.nya,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.L_a,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.J_a,Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.iKb,Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.lKb,
Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.K_a,Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.jKb,Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.mKb,Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.cjb,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.Zib,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.t1,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.s1,Object(I.a)(this,this.Ws,"remapTextEnabled"));
this.Zc.$(ea.a.r1,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.oKb,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.gKb,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.bjb,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.Koc,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.hKb,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.Coa,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.AKa,Object(I.a)(this,this.Ws,"remapTextEnabled"));
this.Zc.$(ea.a.Eoc,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.Foc,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.kya,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.eKb,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.Goc,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.dKb,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.kKb,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.Poc,Object(I.a)(this,this.Ws,"remapTextEnabled"));
this.Zc.$(ea.a.nKb,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.mya,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.$ib,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.insertHyperlink,Object(I.a)(this,this.h5k,"remapInsertHyperlinkEnabled"));this.Zc.$(ea.a.f0a,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.g0a,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.pKb,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.qKb,Object(I.a)(this,
this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.f0a,Object(I.a)(this,this.Ws,"remapTextEnabled"));this.Zc.$(ea.a.g0a,Object(I.a)(this,this.Ws,"remapTextEnabled"))}jOj(){this.hb.$(ea.a.XRe,Object(I.a)(this,this.ujb,"queryInkControlToggledExecuteBridge"));this.hb.$(ea.a.RRe,Object(I.a)(this,this.ujb,"queryInkControlToggledExecuteBridge"));this.hb.$(ea.a.URe,Object(I.a)(this,this.ujb,"queryInkControlToggledExecuteBridge"));this.hb.$(ea.a.SRe,Object(I.a)(this,this.ujb,"queryInkControlToggledExecuteBridge"));
this.hb.$(ea.a.VRe,Object(I.a)(this,this.ujb,"queryInkControlToggledExecuteBridge"));this.hb.$(ea.a.WRe,Object(I.a)(this,this.ujb,"queryInkControlToggledExecuteBridge"));this.hb.$(ea.a.TRe,Object(I.a)(this,this.ujb,"queryInkControlToggledExecuteBridge"))}VOj(){this.hb.$(ea.a.Xpc,Dd.af);this.hb.$(ea.a.Ypc,Dd.af);this.hb.$(ea.a.$pc,Dd.af);this.hb.$(ea.a.ind,Dd.af);this.hb.$(ea.a.hnd,Dd.af);this.hb.$(ea.a.jnd,Dd.af);this.hb.$(ea.a.knd,Dd.af);this.hb.$(ea.a.mnd,Dd.af);this.hb.$(ea.a.gnd,Dd.af);this.hb.$(ea.a.ond,
Dd.af);this.hb.$(ea.a.lnd,Dd.af);this.hb.$(ea.a.vnd,Dd.af);this.hb.$(ea.a.und,Dd.af);this.hb.$(ea.a.tnd,Dd.af);this.hb.$(ea.a.Cjb,Dd.af);this.hb.$(ea.a.Djb,Dd.af);this.hb.$(ea.a.d0a,Object(I.a)(this,this.Omd,"queryListMarkerQueryDataExecuteBridge"));this.hb.$(ea.a.e0a,Object(I.a)(this,this.Omd,"queryListMarkerQueryDataExecuteBridge"));this.hb.$(ea.a.mLb,Dd.af);this.hb.$(ea.a.lLb,Dd.af);this.hb.$(ea.a.Zpc,Dd.af);this.hb.$(ea.a.qnd,Dd.af);this.hb.$(ea.a.snd,Dd.af);this.Zc.$(ea.a.qlb,Dd.Ny);this.Zc.$(ea.a.rlb,
Dd.Ny);this.Zc.$(ea.a.RNb,Dd.Ny);this.Zc.$(ea.a.Clb,Dd.Ny);this.Zc.$(ea.a.mOb,Dd.Ny);this.Zc.$(ea.a.v0e,Dd.Ny);this.hb.$(ea.a.qlb,Object(I.a)(this,this.n7i,"fontNameExecuteBridge"));this.hb.$(ea.a.rlb,Object(I.a)(this,this.Z8d,"genericFontSizeExecuteBridge"));this.hb.$(ea.a.RNb,Dd.Q4e);this.hb.$(ea.a.Clb,Dd.Q4e);this.hb.$(ea.a.mOb,Dd.Q4e);this.Zc.$(ea.a.wCf,Dd.I1a);this.Zc.$(ea.a.xCf,Dd.I1a);this.Zc.$(ea.a.nKc,Dd.I1a);this.Zc.$(ea.a.kKc,Dd.I1a);this.Zc.$(ea.a.mKc,Dd.I1a);this.Zc.$(ea.a.lKc,Dd.I1a);
this.Zc.$(ea.a.NUd,Dd.I1a);this.Zc.$(ea.a.DUd,Dd.I1a);this.hb.$(ea.a.Isd,Dd.Yug);this.hb.$(ea.a.c0a,Dd.rjh);this.hb.$(ea.a.nnd,Dd.rjh);this.hb.$(ea.a.woa,Dd.Yug)}yNj(){this.hb.$(ea.a.Hj,Object(I.a)(this,this.uya,"queryQueryTransitionResultExecuteBridge"));this.hb.$(ea.a.Ioa,Object(I.a)(this,this.uya,"queryQueryTransitionResultExecuteBridge"));this.hb.$(ea.a.wya,Object(I.a)(this,this.uya,"queryQueryTransitionResultExecuteBridge"));this.hb.$(ea.a.zLb,Object(I.a)(this,this.uya,"queryQueryTransitionResultExecuteBridge"));
this.hb.$(ea.a.Ijb,Object(I.a)(this,this.uya,"queryQueryTransitionResultExecuteBridge"));this.hb.$(ea.a.Knd,Object(I.a)(this,this.uya,"queryQueryTransitionResultExecuteBridge"));this.hb.$(ea.a.vya,Dd.ZU);this.hb.$(ea.a.$j,Object(I.a)(this,this.$wd,"transitionExecuteBridge"));this.hb.$(ea.a.wlb,Object(I.a)(this,this.$wd,"transitionExecuteBridge"));this.Zc.$(ea.a.$j,Dd.Ny);this.Zc.$(ea.a.upa,Dd.Ny);this.Zc.$(ea.a.jza,Dd.Ny);this.Zc.$(ea.a.itc,Dd.Ny);this.Zc.$(ea.a.xlb,Dd.Ny);this.hb.$(ea.a.Goa,Object(I.a)(this,
this.uya,"queryQueryTransitionResultExecuteBridge"));this.hb.$(ea.a.Z_a,Object(I.a)(this,this.uya,"queryQueryTransitionResultExecuteBridge"));this.hb.$(ea.a.$_a,Object(I.a)(this,this.uya,"queryQueryTransitionResultExecuteBridge"));this.hb.$(ea.a.Hoa,Object(I.a)(this,this.uya,"queryQueryTransitionResultExecuteBridge"));this.hb.$(ea.a.Ww,Object(I.a)(this,this.$wd,"transitionExecuteBridge"));this.hb.$(ea.a.sNb,Object(I.a)(this,this.$wd,"transitionExecuteBridge"));this.Zc.$(ea.a.Ww,Dd.Ny);this.Zc.$(ea.a.bza,
Dd.Ny);this.Zc.$(ea.a.sNb,Dd.Ny);this.Zc.$(ea.a.tNb,Dd.Ny);this.Zc.$(ea.a.n1a,Dd.Ny);this.hb.$(ea.a.JKa,Dd.ZU);this.Zc.$(ea.a.Bsc,Dd.Ny);this.Zc.$(ea.a.l1a,Dd.Ny);this.hb.$(ea.a.KKa,Dd.ZU);this.Zc.$(ea.a.Csc,Dd.Ny);this.Zc.$(ea.a.m1a,Dd.Ny);this.Zc.$(ea.a.R_b,Dd.Ny);this.hb.$(ea.a.OKb,Dd.af);this.Zc.$(ea.a.Trd,Dd.Ny);this.Zc.$(ea.a.Urd,Dd.Ny);this.Zc.$(ea.a.Vrd,Dd.Ny);this.Zc.$(ea.a.Wrd,Dd.Ny)}fPj(){this.hb.$(C.a.vLb,Dg.IRe);this.hb.$(ea.a.pSe,Dg.IRe);this.hb.$(ea.a.sLb,Dd.ZU);this.hb.$(ea.a.tLb,
Dd.ZU);this.hb.$(ea.a.mqc,Dd.ZU);this.hb.$(ea.a.Ind,Dd.ZU);this.hb.$(ea.a.jqc,Dd.ZU);this.hb.$(ea.a.kqc,Dd.ZU);this.hb.$(ea.a.lqc,Dd.ZU);this.hb.$(ea.a.iqc,Dd.ZU);this.hb.$(ea.a.Hoc,Object(I.a)(this,this.Jod,"remapTableExecute"));this.hb.$(C.a.H8,Object(I.a)(this,this.Jod,"remapTableExecute"));this.hb.$(C.a.ZMb,Object(I.a)(this,this.Jod,"remapTableExecute"));this.hb.$(C.a.insertTable,Object(I.a)(this,this.Jod,"remapTableExecute"));this.Zc.$(C.a.insertTable,Object(I.a)(this,this.lzi,"checkInsertTableRibbonEnabledBridge"));
this.Zc.$(C.a.H8,Object(I.a)(this,this.Oub,"checkWholeTableLockEnabledBridge"));this.Zc.$(C.a.d_,Object(I.a)(this,this.Oub,"checkWholeTableLockEnabledBridge"));this.Zc.$(C.a.eT,Object(I.a)(this,this.Oub,"checkWholeTableLockEnabledBridge"));this.Zc.$(ea.a.Bgh,Object(I.a)(this,this.Oub,"checkWholeTableLockEnabledBridge"));this.Zc.$(ea.a.l6,Object(I.a)(this,this.Oub,"checkWholeTableLockEnabledBridge"));this.Zc.$(ea.a.CKa,Object(I.a)(this,this.Oub,"checkWholeTableLockEnabledBridge"));this.hb.$(C.a.d_,
Object(I.a)(this,this.CRa,"checkSelectionBeforeExecute"));this.hb.$(C.a.eT,Object(I.a)(this,this.CRa,"checkSelectionBeforeExecute"));this.hb.$(C.a.A8a,Object(I.a)(this,this.CRa,"checkSelectionBeforeExecute"));this.hb.$(ea.a.Soc,Object(I.a)(this,this.CRa,"checkSelectionBeforeExecute"));this.hb.$(ea.a.Roc,Object(I.a)(this,this.CRa,"checkSelectionBeforeExecute"));this.hb.$(ea.a.Qoc,Object(I.a)(this,this.CRa,"checkSelectionBeforeExecute"));this.hb.$(ea.a.l6,Object(I.a)(this,this.CRa,"checkSelectionBeforeExecute"));
this.hb.$(ea.a.CKa,Object(I.a)(this,this.CRa,"checkSelectionBeforeExecute"));this.hb.$(ea.a.QSe,Dd.af);this.hb.$(ea.a.RSe,Dd.af);this.hb.$(ea.a.SSe,Dd.af);this.hb.$(ea.a.TSe,Dd.af);this.hb.$(ea.a.USe,Dd.af);this.hb.$(ea.a.VSe,Dd.af);this.hb.$(ea.a.WSe,Dd.af);this.hb.$(ea.a.XSe,Dd.af);this.hb.$(ea.a.YSe,Dd.af);this.hb.$(ea.a.ESe,Dd.af);this.hb.$(ea.a.FSe,Dd.af);this.hb.$(ea.a.GSe,Dd.af);this.hb.$(ea.a.HSe,Dd.af);this.hb.$(ea.a.ISe,Dd.af);this.hb.$(ea.a.JSe,Dd.af);this.hb.$(ea.a.KSe,Dd.af);this.hb.$(ea.a.LSe,
Dd.af);this.hb.$(ea.a.MSe,Dd.af);this.hb.$(ea.a.NSe,Dd.af);this.hb.$(ea.a.OSe,Dd.af);this.hb.$(ea.a.PSe,Dd.af);this.hb.$(ea.a.Gnd,Dd.af);this.hb.$(ea.a.Fnd,Dd.af);this.hb.$(ea.a.Dnd,Dd.af);this.hb.$(ea.a.Hnd,Dd.af)}BOj(){this.Zc.$(ea.a.cnd,Dd.Ny);this.hb.$(ea.a.cnd,Dd.af);this.Zc.$(ea.a.Ble,Dd.g5k);this.hb.$(ea.a.JFa,Object(I.a)(this,this.Ukd,"parseSmartArtParametersBridge"));this.hb.$(ea.a.D1b,Object(I.a)(this,this.Ukd,"parseSmartArtParametersBridge"));this.hb.$(ea.a.E1b,Object(I.a)(this,this.Ukd,
"parseSmartArtParametersBridge"));this.hb.$(ea.a.jL,Object(I.a)(this,this.Ukd,"parseSmartArtParametersBridge"));this.Zc.$(ea.a.Gmd,Dd.Ny);this.hb.$(ea.a.Gmd,Dd.af);this.hb.$(ea.a.wsa,Object(I.a)(this,this.lyi,"changePictureStyleExecuteBridge"));this.hb.$(ea.a.pLb,Dd.af);this.hb.$(ea.a.VKb,Dd.ZU);this.hb.$(ea.a.XKb,Dd.ZU);this.hb.$(ea.a.WKb,Dd.ZU);this.hb.$(ea.a.Kpc,Dd.ZU)}BNj(){this.hb.$(ea.a.zjh,Dg.IRe);this.hb.$(ea.a.spc,Dd.af);this.hb.$(ea.a.Mpc,Dd.af);this.hb.$(ea.a.Ipc,Dd.af);this.hb.$(ea.a.Upc,
Dd.af);this.hb.$(ea.a.Vpc,Dd.af);this.hb.$(ea.a.Tpc,Dd.af);this.hb.$(ea.a.Wpc,Dd.af);this.hb.$(ea.a.dqc,Dd.af);this.hb.$(ea.a.Lpc,Dd.af);this.hb.$(ea.a.Gpc,Dd.af);this.hb.$(ea.a.Apc,Dd.af);this.hb.$(ea.a.Qpc,Dd.af)}aOj(){this.hb.$(ea.a.Emd,Dd.af);this.hb.$(ea.a.Tmd,Dd.af);this.hb.$(ea.a.Opc,Object(I.a)(this,this.Omd,"queryListMarkerQueryDataExecuteBridge"));this.hb.$(ea.a.Ppc,Object(I.a)(this,this.Omd,"queryListMarkerQueryDataExecuteBridge"));this.hb.$(ea.a.yLb,Dd.af);this.hb.$(ea.a.xLb,Dd.af);this.hb.$(ea.a.wLb,
Dd.af);this.hb.$(ea.a.ynd,Dd.af);this.hb.$(ea.a.LWk,Dd.af);this.hb.$(ea.a.Oy,Dd.$md);this.hb.$(ea.a.nqc,Dd.$md);this.hb.$(ea.a.pnd,Dd.$md);this.hb.$(ea.a.Lmd,Dd.$md);this.hb.$(ea.a.qLb,Object(I.a)(this,this.j5k,"remapRumTrackerExecuteQueryBridge"));this.hb.$(ea.a.TKb,Dd.af);this.hb.$(ea.a.fnd,Dg.vpc);this.hb.$(ea.a.Smd,Dd.af);this.hb.$(ea.a.Jpc,Dd.af);this.hb.$(ea.a.PKb,Dd.af);this.hb.$(ea.a.jLb,Dd.af);this.hb.$(ea.a.rLb,Dd.af);this.hb.$(ea.a.eTe,Dg.vpc);this.hb.$(ea.a.Bnd,Dd.af);this.hb.$(ea.a.znd,
Dd.af);this.hb.$(ea.a.ySe,Dd.af);this.hb.$(ea.a.j0a,Dd.af);this.hb.$(ea.a.Gjb,Dd.af);this.hb.$(ea.a.Hjb,Dd.af);this.hb.$(ea.a.Fjb,Dd.af);this.hb.$(ea.a.Ejb,Dd.af);this.hb.$(ea.a.gLb,Dd.af);this.hb.$(ea.a.nLb,Dd.af);this.hb.$(ea.a.hLb,Dd.af);this.hb.$(G.a.NKb,Dg.vpc);this.Zc.$(ea.a.$Ne,Dd.Ny);this.hb.$(ea.a.uv,Dd.Iud);this.hb.$(ea.a.WCa,Dd.Iud);this.hb.$(ea.a.ptb,Dd.Iud);this.hb.$(ea.a.f0b,Dd.Iud);this.Zc.$(ea.a.j2f,Dd.O7i);this.hb.$(ea.a.yc,Dd.eWk);this.Zc.$(ea.a.Ymd,Dd.Ny);this.hb.$(ea.a.Ymd,Dd.af);
this.Zc.$(ea.a.uTa,Object(I.a)(this,this.Tw,"remapTextQueryEnabled"));this.hb.$(ea.a.SKa,Dg.vpc);this.hb.$(ea.a.vSe,Dd.af);this.hb.$(ea.a.bqc,Dd.af);this.hb.$(ea.a.mSe,Dd.af);this.hb.$(ea.a.nSe,Dd.af);this.hb.$(ea.a.ALb,Dd.af);this.hb.$(ea.a.ORe,Dd.af);this.hb.$(C.a.Mld,Dg.K$b);this.hb.$(C.a.cut,Object(I.a)(this,this.iPc,"cutCopyPasteExecuteBridge"));this.hb.$(C.a.copy,Object(I.a)(this,this.iPc,"cutCopyPasteExecuteBridge"));this.hb.$(C.a.paste,Object(I.a)(this,this.iPc,"cutCopyPasteExecuteBridge"));
this.hb.$(C.a.j6,Object(I.a)(this,this.iPc,"cutCopyPasteExecuteBridge"));this.hb.$(C.a.openInClient,Object(I.a)(this,this.MJk,"openInPowerPointExecuteBridge"));this.hb.$(C.a.Nmd,Dd.af);this.hb.$(ea.a.Fpc,Dd.af);this.hb.$(ea.a.Toc,Object(I.a)(this,this.knh,"remapUndoRedoExecute"));this.hb.$(ea.a.Noc,Object(I.a)(this,this.knh,"remapUndoRedoExecute"));this.hb.$(ea.a.bKb,Object(I.a)(this,this.Iod,"remapCutCopyPasteExecute"));this.hb.$(ea.a.aKb,Object(I.a)(this,this.Iod,"remapCutCopyPasteExecute"));this.hb.$(ea.a.BKa,
Object(I.a)(this,this.Iod,"remapCutCopyPasteExecute"));this.hb.$(ea.a.ajb,Object(I.a)(this,this.Iod,"remapCutCopyPasteExecute"));this.la.ka("IsPasteTextFloatieEnabled")&&(this.hb.$(ea.a.fld,this.QUe),this.hb.$(ea.a.hld,this.QUe),this.la.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled")&&this.hb.$(ea.a.gld,this.QUe));this.Zc.$(ea.a.Toc,Object(I.a)(this,this.jnh,"remapUndoRedoEnabled"));this.Zc.$(ea.a.Noc,Object(I.a)(this,this.jnh,"remapUndoRedoEnabled"));this.Zc.$(ea.a.bKb,Object(I.a)(this,this.Vjb,
"remapCutCopyPasteEnabled"));this.Zc.$(ea.a.aKb,Object(I.a)(this,this.Vjb,"remapCutCopyPasteEnabled"));this.Zc.$(ea.a.BKa,Object(I.a)(this,this.Vjb,"remapCutCopyPasteEnabled"));this.Zc.$(ea.a.ajb,Object(I.a)(this,this.Vjb,"remapCutCopyPasteEnabled"));this.Zc.$(C.a.cut,Object(I.a)(this,this.Vjb,"remapCutCopyPasteEnabled"));this.Zc.$(C.a.paste,Object(I.a)(this,this.Vjb,"remapCutCopyPasteEnabled"));this.Zc.$(C.a.j6,Object(I.a)(this,this.Vjb,"remapCutCopyPasteEnabled"));this.hb.$(C.a.Q1,Dd.sDf);this.hb.$(C.a.sr,
Dd.sDf);this.hb.$(C.a.iN,Object(I.a)(this,this.pvg,"listsExecuteBridge"));this.hb.$(C.a.zP,Object(I.a)(this,this.pvg,"listsExecuteBridge"));this.hb.$(ea.a.R1a,Dd.bwl);this.hb.$(ea.a.qjb,Dd.ZU);this.hb.$(ea.a.rjb,Dd.ZU);this.hb.$(ea.a.kLb,Dd.af);this.hb.$(ea.a.QKb,Dd.af);this.hb.$(ea.a.zpc,Dd.af);this.hb.$(ea.a.iLb,Dd.af);this.la.atb&&this.hb.$(ea.a.rpc,Dd.af);(this.la.iA||this.la.ZF)&&eb.a("ShowEnabledStateOfChatPPT")&&this.hb.$(ea.a.aqc,Dd.af);this.la.Ele&&this.hb.$(ea.a.Cpc,Dd.af);this.la.t2d&&
this.hb.$(ea.a.Hpc,Dd.af);this.la.j3&&this.hb.$(ea.a.sjb,Dd.af)}JNj(){this.Zc.$(ea.a.Ckg,Object(I.a)(this,this.E4b,"doPresentationCheckEnableRemap"));this.Zc.$(ea.a.oYd,Object(I.a)(this,this.E4b,"doPresentationCheckEnableRemap"));this.Zc.$(ea.a.jYd,Object(I.a)(this,this.E4b,"doPresentationCheckEnableRemap"));this.Zc.$(ea.a.Ekg,Object(I.a)(this,this.E4b,"doPresentationCheckEnableRemap"));this.Zc.$(ea.a.Ikg,Object(I.a)(this,this.E4b,"doPresentationCheckEnableRemap"))}E4b(a){const b=new Vk;this.Gb&&
1===this.Gb.ol&&!Dd.Jme(a)?b.tL=!1:(b.TE=!0,b.Um=ea.a.y9a);return b}qej(){const a=new vM;a.g0b=Dd.AQk;a.OUd=Dd.BQk;a.eQe=Object(I.a)(this,this.ZQk,"powerPointPreExecCommand");a.zPe=null;return a}ZQk(a,b){var c=this.pa.Xd();c=1===c.length&&c[0].vd&&this.pa.rH()&&!c[0].XQ;switch(a.Um){case C.a.font:case C.a.n6:case C.a.tLa:case C.a.bold:case C.a.setItalic:case C.a.underline:case C.a.strikethrough:case C.a.sr:case C.a.Q1:case C.a.Gja:case C.a.mH:case C.a.bI:case C.a.FKa:case C.a.P0a:case C.a.TC:case C.a.My:case C.a.iN:case C.a.zP:case C.a.Cja:case C.a.Yla:case C.a.gpa:case C.a.BEa:case ea.a.woa:case ea.a.t1:case ea.a.s1:case ea.a.r1:case C.a.NDa:case C.a.kla:case C.a.Pza:case C.a.Qza:case C.a.Rza:case C.a.BMa:case C.a.CMa:case C.a.eT:case C.a.d_:case ea.a.l6:case ea.a.CKa:case ea.a.E1a:case ea.a.ULa:case ea.a.tpa:case ea.a.VLa:case ea.a.Lud:case ea.a.Kud:b||
(b={}),b[hh.a.nIc]=!(this.pa.kWa()||c),b[hh.a.pwf]=!!this.pa.Yka()}return null}hvg(a,b,c){const f=new $g;b=b.MenuItemId;f.zd=this.$He(b,a);b&&xa.a.J(512493027,820,50,"ListGallery Set on Shape from {0}",c.CommandLocation);return f}$He(a,b){a=a?parseInt(a):-1;switch(b){case ea.a.kOb:case C.a.iN:case ea.a.Opc:case ea.a.d0a:return this.fGb.N8b(a);case ea.a.TNb:case C.a.zP:case ea.a.Ppc:case ea.a.e0a:return this.fGb.xXc(a);default:return 18}}n7i(a,b){a=new $g;a.zd=b.CommandValueId;return a}Omd(a,b){const c=
new $g,f=new Uv;f.h0a=new Vh.a;f.menuItemId=this.$He(b.MenuItemId,a);c.zd=f;c.lX=!0;return c}uya(a,b){a=new $g;const c={};c.queryResult=new Vh.a;const f=b.SourceControlId;c.SourceControlId=f.startsWith("Animation")?f.substring(9,f.length):f;c.MenuItemId=b.MenuItemId;a.zd=c;a.lX=!0;return a}$wd(a,b){a=new $g;const c={},f=b.SourceControlId;c.SourceControlId=f.startsWith("Animation")?f.substring(9,f.length):f;c.MenuItemId=b.MenuItemId;a.zd=c;return a}lyi(a,b){a=new $g;a.zd=parseFloat(b[b.MenuItemId?
"MenuItemId":"SourceControlId"]);return a}ujb(a){const b=new $g,c={},f=new Vh.a;switch(a){case ea.a.XRe:f.Hf(this.TXa.isEnabled(Oe.a.EFa));break;case ea.a.RRe:f.Hf(this.TXa.isEnabled(Oe.a.Dua));break;case ea.a.URe:f.Hf(this.TXa.isEnabled(Oe.a.q9));break;case ea.a.SRe:f.Hf(this.TXa.isEnabled(Oe.a.p9));break;case ea.a.VRe:f.Hf(this.TXa.isEnabled(Oe.a.hA));break;case ea.a.WRe:f.Hf(this.TXa.isEnabled(Oe.a.dD));break;case ea.a.TRe:f.Hf(this.TXa.isEnabled(Oe.a.cD));break;case ea.a.njh:f.Hf(this.TXa.isEnabled(Oe.a.sla))}c.queryResult=
f;b.zd=c;b.lX=!0;return b}pvg(a,b,c){const f=new $g;f.zd=new J.DictionaryPropertySet;b=b.MenuItemId;this.XOl(f.zd,a,this.$He(b,a));b&&xa.a.J(512493026,820,50,"ListGallery Set in Box4 View from {0}",c.CommandLocation);return f}lzi(){return Object.assign(new Vk,{zd:new Vh.a,tL:!!this.aek.Ba})}Oub(){const a=new Vk,b=this.pa.un();if(!b)return a;this.zc.nme(b)&&(a.TE=!1,a.tL=!1,a.Um=vf.ActionManager.j5b);return a}XOl(a,b,c){let f=14,l=0;0===c?(f=16,l=0):b===C.a.iN?(l=f=1,this.fGb.j0c(c)&&(b=this.fGb.HWa.ga(c),
a.setValue(ab.a.Zi,[b.U0b]),a.setValue(ab.a.font,b.Xtb))):b===C.a.zP&&(f=0,l=1,a.setValue(ab.a.LWa,1),a.setValue(zb.a.autonumberBulletType,8),this.fGb.k0c(c)&&(b=this.fGb.Ahd.ga(c),a.setValue(zb.a.autonumberBulletType,b.VVd),a.setValue(ab.a.Zi,[65533,b.z6g,ma.a.charCodeAt(b.F6g,0)])));a.setValue(ee.a.zE,f);a.setValue(ee.a.Iea,l)}xxd(a){let b;if(this.GAh()||this.pa.Yka()){if(({Ge:b}=Dd.rxd(a,this.pa.pz())).returnValue)return{returnValue:!0,pY:b}}else if(this.Ksl()&&({Ge:b}=Dd.SKh(a)).returnValue)return{returnValue:!0,
pY:b};return{returnValue:!1,pY:0}}a8e(a){let b;b=0;a===ea.a.Toc?b=ea.a.S_a:a===ea.a.Noc&&(b=ea.a.R_a);return{returnValue:!!b,pY:b}}$7e(a){let b;b=0;this.GAh()?a===ea.a.bKb?b=C.a.cut:a===ea.a.aKb?b=C.a.copy:a===ea.a.BKa?b=C.a.paste:a===ea.a.ajb&&(b=C.a.j6):(a===ea.a.bKb&&(b=ea.a.Ovb),a===ea.a.aKb?b=ea.a.X2b:a===ea.a.BKa?b=ea.a.zoa:w.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")&&a===ea.a.ajb&&(b=ea.a.pasteAsPlainText));return{returnValue:!!b,pY:b}}fLh(a){switch(a){case C.a.H8:return a=ea.a.cKb,
{returnValue:!0,Ge:a};case C.a.ZMb:return a=ea.a.QPe,{returnValue:!0,Ge:a};case C.a.insertTable:return a=ea.a.Fgh,{returnValue:!0,Ge:a}}a=vf.ActionManager.Z5;return{returnValue:!1,Ge:a}}Ht(a){let b=new $g;if(({result:b}=this.zAb(a)).returnValue)return b;({pY:a}=this.xxd(a)).returnValue&&(b.TE=!0,b.Um=a);return b}aAh(a){switch(a){case ea.a.K_a:case ea.a.jKb:case ea.a.mKb:case ea.a.Zib:case ea.a.cjb:case ea.a.$ib:if(this.pa.Jla()||this.pa.$L())return Object.assign(new Vk,{TE:!1,tL:!1});break;case ea.a.bLb:case ea.a.aLb:case ea.a.iKb:case ea.a.lKb:case ea.a.J_a:if(this.pa.Jla())return Object.assign(new Vk,
{TE:!1,tL:!1});break;case ea.a.AKa:case ea.a.Coa:case ea.a.$ld:case ea.a.jya:case ea.a.lya:case ea.a.nya:case ea.a.L_a:case ea.a.kKb:case ea.a.dKb:if(this.pa.$L())return Object.assign(new Vk,{TE:!1,tL:!1});break;case ea.a.nKb:case ea.a.Poc:if(this.pa.$L()){var b=this.pa.Pa.mb;if(b)for(let c of b)if(c&&c.node&&(b=c.node.sa(Ab.a.listLevel,0),a===ea.a.nKb&&!b||Zo.a.nog(c.node)))return Object.assign(new Vk,{TE:!1,tL:!1})}}return null}Ws(a){let b;new Vk;if(({result:b}=this.gme(a)).returnValue)return this.usd(b,
a);b=this.aAh(a);if(!b){let c;b=new Vk;({pY:c}=this.xxd(a)).returnValue&&(b.TE=!0,b.Um=c)}return this.usd(b,a)}Ooa(a,b=null){const c={};c.OriginalActionId=a;c.Properties=b;return Object.assign(new Vk,{Aib:a,Um:ea.a.FXe,zd:c})}j5k(a,b){const c={};c.OriginalActionId=a;c.Properties=b;return Object.assign(new $g,{Um:ea.a.FXe,zd:c,lX:!0})}$E(a){let b=new $g;if(({result:b}=this.zAb(a)).returnValue)return b;({pY:a}=this.xxd(a)).returnValue?(b.TE=!0,b.Um=a):(b.zd=new Vh.a,b.lX=!0);return b}Tw(a){let b;new Vk;
if(({result:b}=this.gme(a)).returnValue)return this.usd(b,a);b=this.aAh(a);if(!b){let c;b=new Vk;({pY:c}=this.xxd(a)).returnValue?(b.TE=!0,b.Um=c):b.zd=new Vh.a}return this.usd(b,a)}knh(a){const b=new $g;({pY:a}=this.a8e(a)).returnValue&&(b.TE=!0,b.Um=a);return b}jnh(a){const b=new Vk;({pY:a}=this.a8e(a)).returnValue&&(b.TE=!0,b.Um=a);return b}h5k(){const a=new Vk;a.TE=!0;a.Um=ea.a.JPe;return a}i5k(){const a=new $g;a.TE=!0;a.Um=ea.a.JPe;return a}DKl(a){let b;b=0;const c=this.iY.vH;if(c===ea.a.zoa||
c===ea.a.pasteAsPlainText||c===ea.a.hya)a==ea.a.fld?b=ea.a.Fqc:a==ea.a.hld?b=ea.a.Dqc:a==ea.a.gld&&(b=ea.a.Eqc);return{returnValue:!!b,pY:b}}Iod(a){let b=new $g;if(({result:b}=this.zAb(a)).returnValue)return b;({pY:a}=this.$7e(a)).returnValue&&(b.TE=!0,b.Um=a);return b}Jod(a){let b=new $g;if(({result:b}=this.zAb(a)).returnValue)return b;({Ge:a}=this.fLh(a)).returnValue&&(b.TE=!0,b.Um=a);return b}CRa(a,b){let c=new $g;if(({result:c}=this.zAb(a)).returnValue)return c;if(this.pa.Fs())return c.TE=!0,
c.Um=vf.ActionManager.j5b,c;c.Um=a;c.zd=b;return c}Vjb(a){let b=new Vk;if(!this.Sb.Cj())return b.tL=!1,b;if(({result:b}=this.gme(a)).returnValue)return b;({pY:a}=this.$7e(a)).returnValue&&(b.TE=!0,b.Um=a);return b}GAh(){return this.pa.pz()}Ksl(){return this.pa.rH()}Ukd(a,b){const c=new $g;if(!b)throw Error.argumentNull();b=b[b.MenuItemId?"MenuItemId":"SourceControlId"].split(",");b=Object.assign(new LR.a,{Uri:b[0],Category:b[1]});const f=b.Uri;a!==ea.a.JFa&&a!==ea.a.E1b||xa.a.J(512493024,801,50,(a===
ea.a.JFa?"InsertSmartArt: ":"ChangeSmartArtLayout: ")+"{0}",f);c.zd=b;return c}O3c(a,b,c){return this.Ht(a,b,c)}iPc(a){let b=new $g;if(({result:b}=this.zAb(a)).returnValue)return b;b.jr=this.la.t0c||this.la.Ing&&this.la.MVj&&z.a.Ho;return b}MJk(a,b,c){a=new $g;xa.a.J(512493023,801,50,"CuiActionBridge::OpenInPowerPointExecuteBridge - Open In PowerPoint from {0}",c.CommandLocation);return a}zAb(a){let b;b=new $g;return this.Flg(a)?(b.TE=!1,b.tL=!1,b.Um=vf.ActionManager.j5b,{returnValue:!0,result:b}):
{returnValue:!1,result:b}}gme(a){let b;b=new Vk;return this.Flg(a)?(b.TE=!1,b.tL=!1,b.Um=vf.ActionManager.j5b,{returnValue:!0,result:b}):{returnValue:!1,result:b}}Flg(a){return this.TRj(a)}TRj(a){return this.la.podsTableCellLockEnabled&&this.la.podsTableRTTEnabled&&Dd.Sti.contains(a)?this.pa.D9()?!0:!1:!1}usd(a,b){if(eb.a("SetMappedCommandActionData")){let c=0;if(({Ge:c}=Dd.rxd(b,this.pa.pz())).returnValue||({Ge:c}=Dd.SKh(b)).returnValue||({pY:c}=this.a8e(b)).returnValue||({pY:c}=this.$7e(b)).returnValue||
({Ge:c}=this.fLh(b)).returnValue)a.zd||(a.zd={}),a.zd.MappedCommand=c}return a}static Jme(a){const b=Dd.Ssj();let c=!1;for(const f of b)if(f===a){c=!0;break}return c}static Ssj(){Dd.dkc||(Dd.dkc=[ea.a.Toc,ea.a.Noc,ea.a.BKa,ea.a.jKa,ea.a.kKa,ea.a.aKb,ea.a.deleteObject,ea.a.B4d,ea.a.y9a,ea.a.$na,ea.a.a$b,ea.a.z8e,ea.a.tQ,ea.a.print,ea.a.wTk,ea.a.AQe,ea.a.CQe,ea.a.Ooc,ea.a.OPe,ea.a.PPe,ea.a.downloadACopy,ea.a.K4b,ea.a.L4b,ea.a.M4b,ea.a.uv,ea.a.Qmd,ea.a.WCa,ea.a.Psd,ea.a.Osd,ea.a.CNe,ea.a.YJb,ea.a.zLb,
ea.a.vya,ea.a.Ijb,ea.a.Hj,ea.a.Ioa,ea.a.$j,ea.a.wlb,ea.a.itc,ea.a.xlb,ea.a.upa,ea.a.ePb,ea.a.Aza,ea.a.SMa,ea.a.j0a,ea.a.kjb,ea.a.P_a,ea.a.cpc,ea.a.hLb,ea.a.Q_a,ea.a.gLb,ea.a.nLb,ea.a.Cnd,ea.a.Wib,ea.a.Xib,ea.a.iQb,ea.a.Gjb,ea.a.jQb,ea.a.Hjb,ea.a.hQb,ea.a.Fjb,ea.a.gQb,ea.a.Ejb,ea.a.fQb,ea.a.jLb,ea.a.wga,ea.a.Nqc,ea.a.ALb,ea.a.a$e,ea.a.nhe,G.a.m8,G.a.Dmd,ea.a.openInClient,G.a.juc,G.a.rJb,G.a.DKb,G.a.QOb,G.a.ROb,ea.a.bMa,ea.a.Qga,ea.a.pkd,ea.a.TKb,ea.a.Wuc,ea.a.Xuc,C.a.Mld,ea.a.vPk,ea.a.X5,ea.a.j2f,
ea.a.tQ,ea.a.NI,ea.a.lpd,ea.a.iVe,ea.a.Jgd,ea.a.Igd,ea.a.F9e,ea.a.s7a,ea.a.immersiveReader,C.a.copy,C.a.paste,ea.a.Ovb,ea.a.X2b,ea.a.zoa,ea.a.S_a,ea.a.R_a,ea.a.std,G.a.zta,G.a.renameFile,G.a.nNc,G.a.n2e,ea.a.jjb,ea.a.sQe,ea.a.loc,ea.a.dpc,ea.a.Oqc,ea.a.k2a,G.a.F6e,G.a.ve]);Dd.dkc.push(ea.a.ctc);if(w.AFrameworkApplication.fa.ka("ReactNewSlideLayoutEnabled")){const a=[ea.a.XJb,ea.a.Rmd,ea.a.E_c];let b;(b=Dd.dkc).push.apply(b,a)}return Dd.dkc}static BQk(a,b){const c=a.Aib;let f=!0,l=null;if(null===a||
null===a.zd)return!1;a=a.zd;null!==a.queryResult&&(l=a.queryResult);if(null!==l&&null!==l.iba)switch(c){case ea.a.vya:case ea.a.sLb:case ea.a.tLb:case ea.a.mqc:case ea.a.Ind:case ea.a.jqc:case ea.a.kqc:case ea.a.lqc:case ea.a.iqc:case ea.a.VKb:case ea.a.XKb:case ea.a.WKb:case ea.a.Kpc:case ea.a.qjb:case ea.a.rjb:case ea.a.JKa:case ea.a.KKa:a=parseFloat(l.iba);0<a||c===ea.a.vya||c===ea.a.VKb||c===ea.a.XKb||c===ea.a.WKb||c===ea.a.Kpc||c===ea.a.qjb||c===ea.a.rjb||c===ea.a.JKa||c===ea.a.KKa||0<=a&&(c===
ea.a.jqc||c===ea.a.kqc||c===ea.a.lqc||c===ea.a.iqc)?(b[cn.Text]=l.iba,b[cn.Number]=a):(b[cn.Text]="",b[cn.Number]=Number.NaN);b[cn.UnitType]=c===ea.a.vya||c===ea.a.JKa||c===ea.a.KKa?8:3;break;default:f=!1}return f}static AQk(a,b){if(Dg.g0b(a,b))return!0;if(!a||!a.zd)return!1;var c=null;Object(Wa.a)(Vh.a,a.zd)?c=a.zd:Object(Wa.a)(Uv,a.zd)?(c=a.zd,b.SourceControlId=c.mV,c=c.h0a):Object(Wa.a)(Object,a.zd)&&(a=a.zd,a.queryResult&&(c=a.queryResult));c&&(b[wh.a.On]=c.Fwd?c.Fwd.value:!1,c.eNc&&(b[no.a.IsFreeForm]=
c.eNc.value),c.CEa&&(b[mm.a.InnerHTML]=c.CEa),c.Cxb&&(b[mm.a.Alt]=c.Cxb),c.STc&&(b[mm.a.On]=c.STc.value),void 0!==c.m_&&null!==c.m_&&(b[no.a.Value]=c.m_),void 0!==c.fLc&&null!==c.fLc&&(b[lE.a.LabelText]=c.fLc),c.W3&&(b[mm.a.GalleryButtonProps]=c.W3),c.cGf&&(b[lE.a.Image32by32Class]=c.cGf),void 0!==c.x$a&&null!==c.x$a&&(b[nm.a.labelText]=c.x$a));return!0}static Ny(){const a=new Vk;a.zd=new Vh.a;return a}static af(){const a=new $g;a.zd=new Vh.a;a.lX=!0;return a}static gvg(a,b,c){xa.a.J(512493021,820,
50,"ListGallery Dropdown from {0}",c.CommandLocation);a=new $g;a.zd=b;return a}static Q4e(a,b){a=new $g;a.zd=b.Color;return a}static sDf(a,b){a=new $g;a.zd=b.Color;a.jr=!0;return a}static bwl(){const a=new $g;a.zd={InvokeSource:0,ShowRevisionTrackingStatus:1};return a}static $md(a,b){a=new $g;const c=new Uv;c.h0a=new Vh.a;c.mV=b.SourceControlId;a.zd=c;a.lX=!0;return a}static Iud(a,b){a=new $g;a.zd=b.SourceControlId;return a}static ZU(){const a=new $g,b={},c=new Vh.a;b.queryResult=c;a.zd=b;a.ipe=!0;
return a}static I1a(a){const b=new Vk;switch(a){case ea.a.wCf:b.Um=ea.a.ICa;break;case ea.a.xCf:b.Um=ea.a.nja;break;case ea.a.nKc:b.Um=ea.a.WQa;break;case ea.a.kKc:b.Um=ea.a.G7a;break;case ea.a.mKc:b.Um=ea.a.H7a;break;case ea.a.lKc:b.Um=ea.a.oja;break;case ea.a.NUd:b.Um=ea.a.ptb;break;case ea.a.DUd:b.Um=ea.a.f0b}return b}static O7i(){const a=new Vk;a.Um=ea.a.Hta;return a}static eWk(){const a=new $g,b={},c=new Vh.a;c.Hf(!1);b.queryResult=c;a.zd=b;a.lX=!0;return a}static rxd(a,b){switch(a){case ea.a.$Jb:return a=
C.a.bold,{returnValue:!0,Ge:a};case ea.a.jya:return a=C.a.Cja,{returnValue:!0,Ge:a};case ea.a.J_a:return a=C.a.font,{returnValue:!0,Ge:a};case ea.a.iKb:return a=C.a.n6,{returnValue:!0,Ge:a};case ea.a.lKb:return a=C.a.tLa,{returnValue:!0,Ge:a};case ea.a.kya:return a=C.a.sr,{returnValue:!0,Ge:a};case ea.a.eKb:return a=C.a.Q1,{returnValue:!0,Ge:a};case ea.a.Goc:return a=C.a.Gja,{returnValue:!0,Ge:a};case ea.a.fKb:return a=C.a.setItalic,{returnValue:!0,Ge:a};case ea.a.lya:return a=C.a.Yla,{returnValue:!0,
Ge:a};case ea.a.gKb:return a=ea.a.$Ne,{returnValue:!0,Ge:a};case ea.a.bjb:return a=C.a.VJb,{returnValue:!0,Ge:a};case ea.a.K_a:return a=C.a.Xq,{returnValue:!0,Ge:a};case ea.a.jKb:return a=C.a.FKa,{returnValue:!0,Ge:a};case ea.a.mKb:return a=C.a.P0a,{returnValue:!0,Ge:a};case ea.a.cjb:return a=C.a.bI,{returnValue:!0,Ge:a};case ea.a.Zib:return a=C.a.mH,{returnValue:!0,Ge:a};case ea.a.oKb:return a=C.a.strikethrough,{returnValue:!0,Ge:a};case ea.a.Koc:return a=ea.a.Mdh,{returnValue:!0,Ge:a};case ea.a.hKb:return a=
ea.a.wKa,{returnValue:!0,Ge:a};case ea.a.nya:return a=C.a.gpa,{returnValue:!0,Ge:a};case ea.a.L_a:return a=C.a.BEa,{returnValue:!0,Ge:a};case ea.a.rKb:return a=C.a.underline,{returnValue:!0,Ge:a};case ea.a.kKb:return a=C.a.My,{returnValue:!0,Ge:a};case ea.a.dKb:return a=C.a.TC,{returnValue:!0,Ge:a};case ea.a.nKb:return a=C.a.My,{returnValue:!0,Ge:a};case ea.a.Poc:return a=C.a.TC,{returnValue:!0,Ge:a};case ea.a.Coa:return a=C.a.iN,{returnValue:!0,Ge:a};case ea.a.AKa:return a=C.a.zP,{returnValue:!0,
Ge:a};case ea.a.mya:return a=ea.a.woa,{returnValue:!0,Ge:a};case ea.a.$ib:return a=ea.a.Ire,{returnValue:!0,Ge:a};case ea.a.uTa:return a=C.a.zTc,{returnValue:!0,Ge:a};case ea.a.pKb:return a=C.a.subscript,{returnValue:!0,Ge:a};case ea.a.qKb:return a=C.a.superscript,{returnValue:!0,Ge:a}}return b?Dd.gKl(a):Dd.RKh(a)}static SKh(a){switch(a){case ea.a.$Jb:return a=ea.a.B1a,{returnValue:!0,Ge:a};case ea.a.jya:return a=ea.a.lOb,{returnValue:!0,Ge:a};case ea.a.J_a:return a=ea.a.qlb,{returnValue:!0,Ge:a};
case ea.a.K_a:return a=ea.a.rlb,{returnValue:!0,Ge:a};case ea.a.fKb:return a=ea.a.C1a,{returnValue:!0,Ge:a};case ea.a.lya:return a=ea.a.slb,{returnValue:!0,Ge:a};case ea.a.nya:return a=ea.a.Elb,{returnValue:!0,Ge:a};case ea.a.L_a:return a=ea.a.SNb,{returnValue:!0,Ge:a};case ea.a.rKb:return a=ea.a.D1a,{returnValue:!0,Ge:a};case ea.a.Coa:return a=ea.a.kOb,{returnValue:!0,Ge:a};case ea.a.Eoc:return a=ea.a.vtc,{returnValue:!0,Ge:a};case ea.a.Foc:return a=ea.a.ntd,{returnValue:!0,Ge:a};case ea.a.kya:return a=
ea.a.RNb,{returnValue:!0,Ge:a};case ea.a.eKb:return a=ea.a.Clb,{returnValue:!0,Ge:a};case ea.a.Goc:return a=ea.a.mOb,{returnValue:!0,Ge:a};case ea.a.AKa:return a=ea.a.TNb,{returnValue:!0,Ge:a};case ea.a.bjb:return a=ea.a.v0e,{returnValue:!0,Ge:a};case ea.a.cjb:return a=ea.a.oOb,{returnValue:!0,Ge:a};case ea.a.Zib:return a=ea.a.wtc,{returnValue:!0,Ge:a};case ea.a.oKb:return a=ea.a.UNb,{returnValue:!0,Ge:a};case ea.a.t1:return a=ea.a.Lsd,{returnValue:!0,Ge:a};case ea.a.s1:return a=ea.a.Ksd,{returnValue:!0,
Ge:a};case ea.a.r1:return a=ea.a.Jsd,{returnValue:!0,Ge:a};case ea.a.Koc:case ea.a.gKb:return Dd.rxd(a,!0);case ea.a.hKb:return Dd.rxd(a,!0);case ea.a.mya:return a=ea.a.Isd,{returnValue:!0,Ge:a};case ea.a.$ib:return a=ea.a.t0e,{returnValue:!0,Ge:a};case ea.a.pKb:return a=ea.a.ztc,{returnValue:!0,Ge:a};case ea.a.qKb:return a=ea.a.Atc,{returnValue:!0,Ge:a}}return Dd.RKh(a)}static gKl(a){switch(a){case ea.a.ZKb:return a=C.a.tpc,{returnValue:!0,Ge:a};case ea.a.LKa:return a=C.a.wpc,{returnValue:!0,Ge:a};
case ea.a.cLb:return a=C.a.Dpc,{returnValue:!0,Ge:a};case ea.a.bLb:return a=G.a.m8,{returnValue:!0,Ge:a};case ea.a.aLb:return a=G.a.m8,{returnValue:!0,Ge:a};case ea.a.wjb:return a=C.a.Jmd,{returnValue:!0,Ge:a};case ea.a.xjb:return a=C.a.xpc,{returnValue:!0,Ge:a};case ea.a.MKa:return a=C.a.Epc,{returnValue:!0,Ge:a};case ea.a.OKa:return a=C.a.Rpc,{returnValue:!0,Ge:a};case ea.a.yjb:return a=C.a.ypc,{returnValue:!0,Ge:a};case ea.a.RKa:return a=ea.a.yLb,{returnValue:!0,Ge:a};case ea.a.QKa:return a=ea.a.xLb,
{returnValue:!0,Ge:a};case ea.a.PKa:return a=ea.a.wLb,{returnValue:!0,Ge:a};case ea.a.fLb:return a=C.a.oqc,{returnValue:!0,Ge:a};case ea.a.$Kb:return a=ea.a.Emd,{returnValue:!0,Ge:a};case ea.a.dLb:return a=ea.a.Tmd,{returnValue:!0,Ge:a};case ea.a.NKa:return a=ea.a.Opc,{returnValue:!0,Ge:a};case ea.a.zjb:return a=ea.a.Ppc,{returnValue:!0,Ge:a};case ea.a.eLb:return a=C.a.eqc,{returnValue:!0,Ge:a};case ea.a.tya:return a=ea.a.c0a,{returnValue:!0,Ge:a};case ea.a.f0a:return a=C.a.gqc,{returnValue:!0,Ge:a};
case ea.a.g0a:return a=C.a.hqc,{returnValue:!0,Ge:a}}a=vf.ActionManager.Z5;return{returnValue:!1,Ge:a}}static RKh(a){switch(a){case ea.a.ZKb:return a=ea.a.Xpc,{returnValue:!0,Ge:a};case ea.a.LKa:return a=ea.a.gnd,{returnValue:!0,Ge:a};case ea.a.cLb:return a=ea.a.Ypc,{returnValue:!0,Ge:a};case ea.a.wjb:return a=ea.a.jnd,{returnValue:!0,Ge:a};case ea.a.xjb:return a=ea.a.knd,{returnValue:!0,Ge:a};case ea.a.MKa:return a=ea.a.mnd,{returnValue:!0,Ge:a};case ea.a.OKa:return a=ea.a.ond,{returnValue:!0,Ge:a};
case ea.a.yjb:return a=ea.a.lnd,{returnValue:!0,Ge:a};case ea.a.RKa:return a=ea.a.vnd,{returnValue:!0,Ge:a};case ea.a.QKa:return a=ea.a.und,{returnValue:!0,Ge:a};case ea.a.PKa:return a=ea.a.tnd,{returnValue:!0,Ge:a};case ea.a.fLb:return a=ea.a.$pc,{returnValue:!0,Ge:a};case ea.a.$Kb:return a=ea.a.Cjb,{returnValue:!0,Ge:a};case ea.a.bLb:return a=ea.a.ind,{returnValue:!0,Ge:a};case ea.a.aLb:return a=ea.a.hnd,{returnValue:!0,Ge:a};case ea.a.dLb:return a=ea.a.Djb,{returnValue:!0,Ge:a};case ea.a.NKa:return a=
ea.a.d0a,{returnValue:!0,Ge:a};case ea.a.zjb:return a=ea.a.e0a,{returnValue:!0,Ge:a};case ea.a.eLb:return a=ea.a.Zpc,{returnValue:!0,Ge:a};case ea.a.tya:return a=ea.a.nnd,{returnValue:!0,Ge:a};case ea.a.f0a:return a=ea.a.qnd,{returnValue:!0,Ge:a};case ea.a.g0a:return a=ea.a.snd,{returnValue:!0,Ge:a}}a=vf.ActionManager.Z5;return{returnValue:!1,Ge:a}}static g5k(a){const b=new Vk;switch(a){case ea.a.Ble:b.Um=ea.a.JFa}return b}static Yug(a,b){a=new $g;if(!b)throw Error.argumentNull();a.zd=Dd.J8f(b.MenuItemId);
return a}static rjh(a,b){a=new $g;const c={},f=new Vh.a;f.Hf(!1);c.queryResult=f;c.MenuItemId=Dd.J8f(b.MenuItemId);c.LineSpacingValue=-1;c.LineSpacingUnit=0;a.zd=c;a.lX=!0;a.hpe=!0;return a}static J8f(a){return parseFloat(a)}}Dd.dkc=null;Dd.Sti=(Bf=new Na.a,Bf.add(C.a.cut),Bf.add(C.a.paste),Bf.add(C.a.j6),Bf.add(C.a.H8),Bf.add(C.a.Q1),Bf.add(C.a.JZd),Bf.add(C.a.Gja),Bf.add(C.a.n6),Bf.add(C.a.tLa),Bf.add(C.a.FKa),Bf.add(C.a.P0a),Bf.add(ea.a.ZKb),Bf.add(ea.a.cLb),Bf.add(ea.a.fLb),Bf.add(ea.a.LKa),Bf.add(ea.a.MKa),
Bf.add(ea.a.OKa),Bf.add(ea.a.yjb),Bf.add(ea.a.RKa),Bf.add(ea.a.QKa),Bf.add(ea.a.PKa),Bf.add(ea.a.wjb),Bf.add(ea.a.xjb),Bf.add(ea.a.$Kb),Bf.add(ea.a.dLb),Bf.add(ea.a.NKa),Bf.add(ea.a.zjb),Bf.add(ea.a.bLb),Bf.add(ea.a.aLb),Bf.add(ea.a.eLb),Bf.add(ea.a.tya),Bf.add(ea.a.f0a),Bf.add(ea.a.g0a),Bf.add(ea.a.Ajh),Bf.add(ea.a.Cjh),Bf.add(ea.a.Bjh),Bf.add(ea.a.oSe),Bf.add(ea.a.Zmd),Bf.add(ea.a.$Jb),Bf.add(ea.a.fKb),Bf.add(ea.a.rKb),Bf.add(ea.a.jya),Bf.add(ea.a.lya),Bf.add(ea.a.nya),Bf.add(ea.a.L_a),Bf.add(ea.a.eKb),
Bf.add(ea.a.Goc),Bf.add(ea.a.J_a),Bf.add(ea.a.iKb),Bf.add(ea.a.lKb),Bf.add(ea.a.K_a),Bf.add(ea.a.jKb),Bf.add(ea.a.mKb),Bf.add(ea.a.cjb),Bf.add(ea.a.Zib),Bf.add(ea.a.t1),Bf.add(ea.a.s1),Bf.add(ea.a.r1),Bf.add(ea.a.oKb),Bf.add(ea.a.gKb),Bf.add(ea.a.bjb),Bf.add(ea.a.Koc),Bf.add(ea.a.hKb),Bf.add(ea.a.Loc),Bf.add(ea.a.Moc),Bf.add(ea.a.Coa),Bf.add(ea.a.AKa),Bf.add(ea.a.kOb),Bf.add(ea.a.Clb),Bf.add(ea.a.mOb),Bf.add(ea.a.TNb),Bf.add(ea.a.Eoc),Bf.add(ea.a.Foc),Bf.add(ea.a.kya),Bf.add(ea.a.dKb),Bf.add(ea.a.kKb),
Bf.add(ea.a.insertHyperlink),Bf.add(ea.a.mya),Bf.add(ea.a.$ib),Bf.add(ea.a.pKb),Bf.add(ea.a.qKb),Bf.add(ea.a.bKb),Bf.add(ea.a.BKa),Bf.add(ea.a.ajb),Bf.add(ea.a.cKb),Bf.add(ea.a.Vld),Bf.add(ea.a.Hoc),Bf.add(ea.a.Soc),Bf.add(ea.a.Roc),Bf.add(ea.a.Qoc),Bf);Object(m.a)(Dd,"CuiActionBridge",Dg,[]);class pE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.UI"}Yb(a){this.K=a;this.K.register(223,"Box4.ISelectionContextMenuProvider").ma().oa(()=>new Jq);let b=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pBb;
z.a.ik&&(b=b&&!this.K.resolve("PowerPointWebEditor.Ribbon.IPPTChromeExtensionHelper").lza);this.K.register(Uz,"PowerPointWebEditor.EditSurfaceContextMenu").as("Box4.UI.AEditSurfaceContextMenu").ma().oa(()=>new Uz(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("Box4.UI.IProofingContextMenuSectionFactory"),this.K.resolve("PowerPointWebEditor.IContextMenuHelper"),this.K.resolve("Box4.IContextSetEditor"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder"),this.K.Ia("PowerpointPresence.IPresenceManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),b));a.register(224,"PowerPointWebEditor.ICUIManager").ma().oa(()=>new uM(a.resolve("PowerPoint.IPathManager"),a.resolve("PowerPointWebEditor.IStatusBarUser"),a.resolve("PowerPointWebEditor.IRibbonUser"),a.resolve("PowerPointWebEditor.IContextMenuUser"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.ITaskManager"),
a.resolve("PowerPointWebEditor.CuiActionBridge"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.IRibbonExternal")));a.register(Dd,"PowerPointWebEditor.CuiActionBridge").as("Box4.UI.CuiActionBridge").ma().oa(()=>new Dd(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPptListMarkersLoader"),
a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IInkRibbonManager"),w.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")?a.resolve("Box4.ITextPasteFloatieManager"):null));w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.StatusBarPRIEnabled",!1)||(this.K.register(94,"PowerPointWebEditor.IStatusBarUserHelper").ma().oa(()=>
new HR.a(a.resolve("PowerPointWebEditor.IApplicationSettings"))),a.register(95,"PowerPointWebEditor.IStatusBarUser").ma().oa(()=>new GR.a(a.resolve("PowerPointWebEditor.IStatusBarPane").va,a.resolve("Box4.Graph.IGraphInstance").yd(7),a.qb("PowerPointWebEditor.Core.IBundleMetricRecorder"),this.K.resolve("PowerPointWebEditor.IPPTRumTracker"),a.resolve("Common.IExternalUICommandDefinitionMapping"),a.resolve("PowerPointWebEditor.IStatusBarUserHelper"),a.resolve("Common.IAppSettingsManager"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),
!1,a.resolve("Common.IAppSettingsManager").getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.RenderStatusBarIndependentOfFullAppSettings",!1))));a.register(kx,"CommandUI.ReactRibbonRoot").ma().oa(()=>new kx(bs.instance,a.resolve("Common.IExternalUICommandDefinitionMapping"),a.resolve("Box4.IGeneralCuiUser")));a.register(225,"PowerPointWebEditor.IContextMenuUser").ma().oa(()=>new rM(a.resolve("Box4.IContextMenuController"),Object(qa.a)(Uz,a.resolve("Box4.UI.AEditSurfaceContextMenu"))));a.register(226,
"Box4.IBox4BridgeCommandUi").ma().oa(()=>new sM(a.resolve("Box4.IGeneralCuiUser"),a.resolve("PowerPointWebEditor.IRibbonUser"),a.resolve("Common.IActionManager"),a.resolve("Common.IRibbonExternal")));this.K.register(227,"PowerPointWebEditor.IContextMenuHelper").ma().oa(()=>new qM(a.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(iE,"Box4.UI.EditorServiceProofingContextMenuCreator").ma().oa(()=>new iE(a.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"),a.resolve("Box4.Proofing.IProofingFeatureConfiguration"),
a.qb("Box4.Proofing.IIgnoreAllKeywords"),"pegal",a.resolve("PowerPoint.IPathManager").qk("pegal.png"),!1,a.resolve("Box4.IFormattingReader")))}init(){wg.a.instance.lc("PPTWebEditorUIPackageInit",(new Date).getTime());this.K.resolve("PowerPointWebEditor.ActionCommandsRumTrackerReporter");this.K.resolve("PowerPointWebEditor.CuiActionBridge").initialize();this.K.resolve("PowerPointWebEditor.ICUIManager").initialize();this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame").Cpi(this.K.resolve("Box4.IBox4BridgeCommandUi"));
this.K.resolve("PowerPointWebEditor.View.IViewEventSource").uXk()}dispose(){this.K.resolve("PowerPointWebEditor.ICUIManager").dispose();this.K.resolve("PowerPointWebEditor.IStatusBarUser").dispose();this.K.resolve("PowerPointWebEditor.IContextMenuUser").dispose()}static main(){n.a.instance.Ac(new pE)}}Object(m.a)(pE,"PPTWebEditorUIPackage",null,[2,3]);class wM{constructor(a){this.SVh="FontPicker";this.xHd=null;this.HNa=a;this.OAc=this.HNa.v0a(as.a.CWa,Object(I.a)(this,this.$wb,"featureStateChangeCallback"));
this.HNa.isFeatureEnabled(as.a.CWa,!1).then(b=>{this.xHd=b})}get isLicensed(){return this.xHd}$wb(a){this.xHd=a.isEnabled;a=appChrome.actions.updateFontPickerLicenseState(this.SVh,a.isEnabled);appChrome.api.dispatch(a)}dispose(){this.HNa.akb(as.a.CWa,this.OAc)}}Object(m.a)(wM,"ModernFontPickerFeatureHelper",null,[228,107]);class Vz{constructor(a){this.AIa=null;a?Object.getType(a)===String?this.AIa=Vz.deserialize(a):this.AIa=a:(ka.ULS.sendTraceTag(543475146,3021,10,"Failed to populate pinned fonts."),
this.AIa=[]);this.LHa=!1}get isDirty(){return this.LHa}get xld(){return Array.clone(this.AIa)}Wbi(a){Array.contains(this.AIa,a)||(Array.add(this.AIa,a),this.LHa=!0)}X5k(a){Array.contains(this.AIa,a)&&(Array.remove(this.AIa,a),this.LHa=!0)}serialize(){return JSON.stringify(this.AIa)}Lal(){this.LHa=!1}static deserialize(a){try{return JSON.parse(a)}catch(b){return ka.ULS.sendTraceTag(543475147,3021,10,"Deserialize failed: {0}",b.toString()),[]}}}Object(m.a)(Vz,"PinnedFontStore",null,[]);class xM{constructor(a,
b,c,f){this.ia=a;this.la=c;this.UXg=b;this.wb=f;this.t5=null}initialize(){this.ia.ya(G.a.koc,ie.a.frame,Object(I.a)(this,this.koc,"pinOrUnpinFont"));this.ia.ra(G.a.U1f,ie.a.frame,Object(I.a)(this,this.G9g,"onFontPickerMenuClose"),96);this.UXg.dee("getPPTPinnedFontsSettings").continueWith(Object(I.a)(this,this.RGk,"onRoamingSettingLoaded"))}d2j(a){return a.ho?!1:a.Dm?(ka.ULS.sendTraceTag(543273993,3021,10,"Load setting failed with exception {0}",a.ej),!1):!0}RGk(a){this.d2j(a)?this.t5=new Vz(a.result||
this.A$f()):this.t5=new Vz(this.A$f());this.ajh()}ajh(){appChrome.api.dispatch(appChrome.actions.updatePinnedFonts("FontPicker",this.xld))}get xld(){return this.t5?this.t5.xld:[]}A$f(){return this.la.Ha("RecommendedFonts")}koc(a,b,c,f,l){if(!this.t5)return ka.ULS.sendTraceTag(543475150,3021,50,"Roaming setting is not available yet"),64;(a=l.CommandValueId)&&(l.IsPinned?this.t5.Wbi(a):this.t5.X5k(a));return 32}G9g(){if(!this.t5||!this.t5.isDirty)return 32;const a=dd.a.FOc(10,Object(I.a)(this,this.updatePinnedFonts,
"updatePinnedFonts"));this.wb.Hb(a);return 32}updatePinnedFonts(){this.t5&&(this.ajh(),this.Xth(),this.t5.Lal())}Xth(){if(this.t5&&this.t5.isDirty){var a=this.t5.serialize();this.UXg.zpl(a)}}dispose(){this.Xth();this.ia.iK(G.a.koc,ie.a.frame,Object(I.a)(this,this.koc,"pinOrUnpinFont"));this.ia.iK(G.a.U1f,ie.a.frame,Object(I.a)(this,this.G9g,"onFontPickerMenuClose"))}}Object(m.a)(xM,"FontPinningHandler",null,[229,107]);class Kq{static get Dkd(){return CommonUIStrings.l_ModernFontPicker_FontInfoPaneTitle}}
Kq.wEa="fontInfoTaskPane";Kq.b1i="modernfontpicker";Object(m.a)(Kq,"FontInfoPaneConstants",null,[]);class yM{constructor(){this.type="FontInfoTaskPaneProps";this.onUpsellButtonClicked=null;this.isLicensed=!1;this.paneId=this.helpArticleUrl=this.trigger=this.fontName=null}}Object(m.a)(yM,"FontInfoTaskPaneProps",null,[]);var wu=d(656);class Wz{constructor(a,b,c,f=null){this.U6a=this.OV=this.OAc=null;this._state=this.oqb=0;this.v1h=a;this.HNa=b;this.LUh=c;this.Pd=f}get qn(){return this.v1h.value}initialize(){this.qn.ya(G.a.wWe,
ie.a.frame,Object(I.a)(this,this.wWe,"requestFontInfo"));this.OAc=this.HNa.v0a(as.a.CWa,Object(I.a)(this,this.$wb,"featureStateChangeCallback"));this.Alb()}hl(a=!1){const b=Bj.UISurfaces.Gq(),c=this.HNa.isFeatureEnabled(as.a.CWa,!1),f=[];f.push(b);f.push(c);Promise.all(f).then(l=>{l[0].showTaskPane(Kq.wEa,this.pda(l[1]));a&&this.Zq()})}lOh(a){Bj.UISurfaces.Gq().then(b=>{b.updateTaskPane(Kq.wEa,this.pda(a));return null})}$wb(a){this.lOh(a.isEnabled)}wWe(a,b,c,f,l){this.OV=l.CommandValueId;this.U6a=
l.Trigger;this.oqb=l.InputMethod;this.hl(2===this._state&&1===this.oqb);return 32}pda(a){const b=new yM;b.onUpsellButtonClicked=Object(I.a)(this,this.onUpsellButtonClicked,"onUpsellButtonClicked");b.fontName=this.OV;b.isLicensed=a;b.trigger=this.U6a;b.helpArticleUrl=this.HGi();b.paneId=Kq.wEa;a=this.gNj();a.contentProps=b;return a}gNj(){return Object.assign(new wu.a,{title:Kq.Dkd,hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:Object(I.a)(this,
this.onOpen,"onOpen"),onClose:Object(I.a)(this,this.onClose,"onClose"),onShow:Object(I.a)(this,this.onShow,"onShow"),onHide:Object(I.a)(this,this.onHide,"onHide")})}Alb(){if(this.Pd){var a=this.Pd.Fc(Kq.wEa);a.parent=D.AFrame.Xi;a.uJ=!0}}onOpen(){this._state=2;this.Zq()}onShow(a){0!==this._state&&(this._state=2,1===a&&(this.oqb=a),this.Zq())}onClose(){this.oqb=this._state=0;this.blur()}onHide(){this._state=1;this.oqb=0}Zq(){this.Pd&&1===this.oqb&&this.Pd.vf(Kq.wEa)}blur(){this.Pd&&this.Pd.Ee&&this.Pd.Ee.name===
Kq.wEa&&this.Pd.vf(this.Pd.G8)}onUpsellButtonClicked(){this.HNa.launchUpsellExperience(Kq.b1i)}dispose(){this.HNa.akb(as.a.CWa,this.OAc)}HGi(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&uilcid={3}",this.LUh,this.lij(),"PPWAENDUSER",w.AFrameworkApplication.lcid)}lij(){switch(this.U6a){case "missing":return"hlpFontInfoMissingFont";case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";case "theme":return"hlpFontInfoThemeFont"}return Wz.jri(this.OV)}static jri(a){let b=
"hlpFontInfo";for(let c=0;c<a.length;++c){const f=ma.a.charAt(a,c);if(255<a.charCodeAt(c)||ma.a.Rlg(f))b+=f}return b}}Object(m.a)(Wz,"FontInfoPane",null,[230,107]);class zM extends Wz{constructor(a,b,c,f){super(a,b,c.Ha("FontInfoHelpBaseUrl"),f)}$wb(a){this.lOh(a.isEnabled)}}Object(m.a)(zM,"PPTFontInfoPane",Wz,[]);class qE{constructor(){this.Mad=this.Xfc=this.Yfc=this.K=null}get name(){return"PowerPointWebEditor.ModernFontPicker"}Yb(a){this.K=a;this.K.register(228,"Common.ModernFontPicker.IModernFontPickerFeatureHelper").ma().oa(()=>
new wM(this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")));this.K.register(229,"Box4.IFontPinningStore").ma().oa(()=>new xM(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IRoamingServiceRequestManager"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("Common.ITaskManager")));this.K.register(230,"Common.ModernFontPicker.IFontInfoPane").ma().oa(()=>new zM(new Bb.a(()=>w.AFrameworkApplication.Ra),this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("Common.IFocusManager")))}init(){const a=this.K.resolve("Common.IAppSettingsManager");a.ff(()=>{this.K.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(b=>{a.ka("PPTOModernFontPickerIsEnabled")&&(this.Mad=this.K.resolve("Common.ModernFontPicker.IModernFontPickerFeatureHelper"),this.Xfc=this.K.resolve("Common.ModernFontPicker.IFontInfoPane"),this.Xfc.initialize(),b.isFeatureEnabled(as.a.CWa,!1).then(c=>{!w.AFrameworkApplication.fa.ka("IsAnonymousUser")&&
c&&(this.Yfc=this.K.resolve("Box4.IFontPinningStore"),this.Yfc.initialize())}),Rc.App.Lb.updateCommandUI())})})}dispose(){this.Xfc&&(this.Xfc.dispose(),this.Xfc=null);this.Yfc&&(this.Yfc.dispose(),this.Yfc=null);this.Mad&&(this.Mad.dispose(),this.Mad=null)}static main(){n.a.instance.Ac(new qE)}}Object(m.a)(qE,"PPTModernFontPickerPackage",null,[2,3]);var rE=d(1112);class AM{constructor(a){this.caa=a;this.Vgb=this.caa.RHb("UserAction","ImageProcessor");this.Uek=67}uvg(a,b){if(b)if(a&&this.i5j){let c=
new Image;c.onload=()=>{b(c);URL.revokeObjectURL(c.src);c=null};(a=URL.createObjectURL(a))?c.src=a:b(null)}else b(null)}$Ch(a,b,c){c-=this.Uek;if(0>=c||!a)return null;let f=a.width,l=a.height;if(0>=f||0>=l)return null;let y=null,H=1,Q=0;try{const ia=Math.ceil(1.37*b);if(c<=ia){const wa=Math.sqrt(c/(1.3*ia));f=Math.floor(a.width*wa);l=Math.floor(a.height*wa)}if(y=this.PUf(a,f,l))if(Q=y.length,y.length>=c){const wa=this.bbg(a.width,a.height);wa*Math.floor(a.width)*wa*Math.floor(a.height)>=f*l?y=null:
(H++,(y=this.Nxl(a))&&y.length>=c&&(y=null))}}catch(ia){y=null,ka.ULS.sendTraceTag(20841025,826,15,"ShrinkImageBySize failed. Error message: "+ia.message+", Call stack: "+ia.stack)}a=String.format("ShrinkImageBySize: BlobSize={0},numTry={1},Base64AfterFirstShrink={2},FinalBase64Length={3}",b,H,Q,y?y.length:0);ka.ULS.sendTraceTag(20841026,826,50,a);return y}Nxl(a){let b=null;if(a){let c=a.width,f=a.height;const l=this.bbg(c,f);c=Math.floor(c*l);f=Math.floor(f*l);try{b=this.PUf(a,c,f)}catch(y){ka.ULS.sendTraceTag(20841027,
826,15,"ShrinkHTML5ImageByResolution failed. Error message: "+y.message+", Call stack: "+y.stack)}}return b}PUf(a,b,c){if(0>=b||0>=c)return null;let f;this.Vgb.start();var l=document.createElement("canvas");l.width=b;l.height=c;var y=l.getContext("2d");f=this.Vgb.dr;y.drawImage(a,0,0,b,c);y=this.Vgb.dr-f;l=l.toDataURL("image/png");a=String.format("DoShrink: Before={0}x{1},After={2}x{3},CreateCanvas={4}ms,DrawImage={5}ms,ToDataURL={6}ms",a.width,a.height,b,c,f,y,this.Vgb.dr-(f+y));ka.ULS.sendTraceTag(20841028,
813,50,a);return l}bbg(a,b){return 0>=a||0>=b?0:1280<a||1280<b?Math.min(1280/a,1280/b):1}get i5j(){return!!this.URL&&!!this.URL.createObjectURL&&!!this.URL.revokeObjectURL}get URL(){return window.URL||window.webkitURL}}Object(m.a)(AM,"ImageProcessor",null,[376]);class sE{constructor(a,b,c,f,l){this.Ca=a;this.WUh=b;this.VUh=c;this.acf=f;this.g4h=l}get qn(){return this.Ca}Gqi(a){this.qn.smd(a,this.WUh,null,null)}Eqi(a){this.qn.smd(a,this.VUh,null,null)}t8(a,b,c){c?this.qn.smd(a,this.acf,b,null):this.qn.Ka(this.acf,
2,b)}Ieh(a,b=!1){const c=new J.DictionaryPropertySet;c.setValue(ee.a.VU,a);c.setValue(ee.a.kld,!0);c.setValue(ee.a.ccb,b);this.qn.Ka(this.g4h,2,c)}}Object(m.a)(sE,"ClipboardCommands",null,[346]);class tE{A5b(){}}Object(m.a)(tE,"NoOpEdgeSystemClipboardSelectionEnsureStrategy",null,[1187]);class Lq{constructor(a,b,c,f,l,y){this.ZD=a;this.mh=b;this.kv=c;this.Sm=f;this.hp=l;this.hd=y}WPj(a,b){a=b.view;b=b.UE;if(!b||N.a.instance.ga(14)&&!this.ZD.Ong(b,!0)||this.Sm&&this.Sm.instance&&this.Sm.instance.fX(b))return 2;
var c=Lq.nV?!Lq.hu.Hla(b):!0;this.kv&&c&&this.kv.Cwc(b.node,B.a.Dp,b.Sa);this.mh.a_c(b,l=>new Gv.a(l,Gv.a.sPc),kf.AParagraphNode.w_);if(this.hd.ig&&this.hd.jz){c=new pf.GraphTransaction(15);try{c.ld(b.node)}finally{c&&c.dispose()}}var f=b.node;c=b.Mb+1;" "===Db.ParagraphReader.text(f).charAt(c)&&(f=cb.a.createTextRange(f,c,c+1),this.mh.replaceTextRange(f,"\u00a0"));b=cb.a.Lj(b.node,c);a.Nb.setSelection(Od.SelectionFactory.Mu(b));return 32}static get hu(){return Lq.XD||(Lq.XD=Ib.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get nV(){null==
Lq.BI&&(Lq.BI=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("SplitHyperlinkFixWithEnterIsEnabled"):!1);return Lq.BI}}Lq.XD=null;Lq.BI=null;Object(m.a)(Lq,"InsertLineBreakStrategy",null,[]);class Un{static get Wh(){return Un.Ji||(Un.Ji=Ib.a.instance.resolve("Box4.IOutlineElementEditor"))}static get ym(){return Ch.ContextSetEditor.instance}static get W6(){return Un.hp||(Un.hp=Ib.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get Xf(){return Un.hd||(Un.hd=
Ib.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static cQj(a,b,c,f,l){if(l&&l.Ua(ee.a.targetObject)){var y=b.view.Ag.Lh.ze(l.eb(ee.a.targetObject));y=cb.a.create(y)}else y=Un.ym.l3(b.UE,11);if(!y)return 8;a=w.AFrameworkApplication.Ra.ei(y,a,c,!0,f,l);if(32===a&&2===c){if(!b.view.Sh)return 2;b=b.view;f=b.Nb.Yj;if(f=Un.ym.l3(f,11)){c=new Cn.a;c.set(f.node);c.kf();if(l&&l.Ua(ee.a.targetObject))for(l=l.Rh(ee.a.targetObject);!c.currentNode.id.equals(l)&&c.Cc()&&(Za.OutlineElementNavigator.Te(c),
11===c.Bi););Za.OutlineElementNavigator.zxa(c,!1,!1);l=Mb.SelectionEditor.uka(c,!0);l=Db.ParagraphReader.vs(l)?Od.SelectionFactory.Qg(l,0):Od.SelectionFactory.nl(l);b.Nb.setSelection(l)}}return a}static Gie(a,b,c,f,l){a=a===C.a.R$b;b=b.node;if(l&&l.Ua(ee.a.targetObject)&&!b.id.equals(l.Rh(ee.a.targetObject)))return 2;if(1===c)return 32;c=new ob.GraphIterator;c.set(b);c.sc(10);Un.Wh.nea(c,a,!0);Un.Xf.ig&&Un.Xf.jz&&Za.OutlineElementNavigator.yi(c);return 32}}Un.Ji=null;Un.hp=null;Un.hd=null;Object(m.a)(Un,
"InsertOutlineElementStrategy",null,[]);var MR=d(420);class Xz{constructor(a,b,c,f,l,y,H,Q){this.kv=b;this.VXh=a;this.Qt=l;this.fp=f;this.Ji=c;this.ZD=y;this.Uc=H;this.m6a=Q}Pxk(a,b,c,f,l){if(!b.view.Sh)return 2;b=b.view;let y=null;b.qp&&(y=b);const H=b.Nb.Yj;let Q=!0,ia=!1,wa=null;if(!H)return 2;const Ua=new pf.GraphTransaction(15);Ua.ld(b.Ag);let kb=null;2===c&&(kb=new Cn.a,kb.set(H.node),kb.kf(),wa=new wx(kb),2===Rc.App.mode&&Mb.SelectionEditor.Xg(H)&&(kb.eC(11)&&Zb.ListReader.Hk(kb)&&Wd.OutlineElementReader.isEmpty(kb,
!1)&&(Q=!1),Q&&Rc.App.Mh.Bw&&Wd.OutlineElementReader.fD(kb,H,!1)&&!Wd.OutlineElementReader.fD(kb,H,!0)&&(Q=!1)),Za.OutlineElementNavigator.Te(kb),Wd.OutlineElementReader.isEmpty(kb,!1)&&(MR.a.L_j(kb)&&(Q=!1),1===Rc.App.mode&&Zb.ListReader.Hk(kb)&&(ia=!0)));a=w.AFrameworkApplication.Ra.ei(H,a,c,!1,f,l);Q&&32===a&&2===c&&(ia||Za.OutlineElementNavigator.CJa(kb,!1,!Mb.SelectionEditor.Xg(H),!1),ia&&wa&&wa.restore(kb),N.a.instance.ga(101)&&this.Qt.freeze(),b.Nb.setSelection(Od.SelectionFactory.Aj(kb.currentNode,
!0)),N.a.instance.ga(101)&&this.Qt.d6e(),this.VXh.Vn.Aw());y&&(Q||y.Tya());Xh.GrippersManager.instance.b3a(1);Ua.dispose();return a}XB(a,b,c){a=!1;if(ba.ImageReader.cGa(b)||ba.ImageReader.BAb(b))b=this.$Hi(b),a=!0;const f=b;b=Mb.SelectionEditor.Xg(b);if(1===c)return 32;const l=f.node,y=new ob.GraphIterator;y.set(l);y.kf();Za.OutlineElementNavigator.Te(y);c=new pf.GraphTransaction(15);c.Sy(y);b?(b=!0,N.a.instance.ga(101)&&Db.ParagraphReader.ae(l)&&f.Sa===Db.ParagraphReader.textLength(l)&&cg.n(f)&&
9===Db.ParagraphReader.wWc(l)&&this.Qt.PIi(f),1===Rc.App.mode&&Wd.OutlineElementReader.isEmpty(y,!1)&&Zb.ListReader.Hk(y)&&(b=!1),this.fp.exh(y,b,f,l),this.kv&&this.kv.Cwc(l,B.a.Dp,f.Sa),a&&(Za.OutlineElementNavigator.ZJ(y,!1,!1),a=y.Cb(2),(a=this.m6a.Qg(a,0))&&this.Uc.setSelection(a))):this.Ji.nea(y,!0,!0);c.dispose();Rc.App.Lb&&Rc.App.Lb.updateCommandUI();return 32}$Hi(a){if(ba.ImageReader.cGa(a))var b=cb.a.Lj(a.node,a.Sa);else b=Db.ParagraphReader.mDa(a.node),a=Xz.eej(a.node.properties.eb(Ab.a.runId),
b.properties.Rh(Ab.a.NY),b.Ta),b=cb.a.Lj(b,a);return b}static g5i(a,b){let c=0;for(;c<b.length&&!(a<b[c]);)c++;return c}static eej(a,b,c){let f=0;a=Xz.g5i(a,b);let l=0;if(a===b.length)l=c.length-1;else for(;l<c.length;){b=c.ga(l);if(b.formatting&&b.formatting.ug===a)break;l++}l<c.length&&(f=c.ga(l).cp);return f}}Object(m.a)(Xz,"NewLineStrategy",null,[]);class xu{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb){this.gt=null;this.SZ=a;this.HAc=y;this.UDc=new Xz(this,b,c,f,l,H,wa,Ua);this.Qif=new Lq(H,Q,
b,ia,kb,Gb)}get Vn(){return this.gt||(this.gt=this.SZ())}vb(){const a=w.AFrameworkApplication.Ra,b=Object(I.a)(this.UDc,this.UDc.XB,"newLine");a.ra(C.a.enter,yb.a.view,Object(I.a)(this.HAc.value,this.HAc.value.P_i,"enterView"),1124);a.ra(C.a.vtd,yb.a.view,Object(I.a)(this.HAc.value,this.HAc.value.lrl,"shiftEnterView"),1124);a.ya(C.a.XB,yb.a.view,Object(I.a)(this.UDc,this.UDc.Pxk,"newLineView"));a.ya(C.a.XB,yb.a.Mf,b);a.ya(C.a.XB,yb.a.image,b);a.ya(C.a.XB,yb.a.textRange,b);a.ya(C.a.XB,yb.a.anchoredObject,
b);a.ya(C.a.XB,yb.a.embeddedFile,b);a.ya(C.a.XB,yb.a.ink,b);a.ya(C.a.XB,yb.a.paragraph,b);a.ya(C.a.XB,yb.a.iFrame,b);a.ya(C.a.XB,yb.a.unsupportedObject,b);a.he(C.a.XB,1124);a.ra(C.a.P$b,yb.a.view,Object(I.a)(this.Qif,this.Qif.WPj,"insertLineBreakView"),1028);a.ya(C.a.R$b,yb.a.view,Un.cQj);a.ya(C.a.R$b,yb.a.outlineElement,Un.Gie);a.he(C.a.R$b,1092)}static get instance(){return xu.La||(xu.La=xu.XC())}static XC(){return new xu(()=>Ib.a.instance.resolve("Box4.IUndoManager"),Ib.a.instance.qb("Box4.IAutoCorrectScheduler"),
Ib.a.instance.resolve("Box4.IOutlineElementEditor"),Ib.a.instance.resolve("Box4.List.IListEditor"),Ib.a.instance.resolve("Box4.IInsertionPointFormatting"),Ib.a.instance.oe("Box4.Actors.IEnterViewStrategy"),bh.a.instance,Ib.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ib.a.instance.Ia("Box4.IExternalSelectionManager"),ge.a.instance,Ib.a.instance.resolve("Box4.ISelectionFactory"),Ib.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,Ib.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}}
xu.La=null;Object(m.a)(xu,"EnterActor",null,[]);class BM{hGh(a){return a}eqg(){return!0}}Object(m.a)(BM,"EopFormattingStrategy",null,[352]);var CM=d(155);class uE{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb){this.DPa=this.nXb=this.Dob=null;this.QOd=0;this.OGd=!1;this.Ma=new Pc.a;this.vUb=null;this.bL=a;this.Qt=b;this.If=c;this.qx=f;this.Cr=l;this.fp=y;this.fh=H;this.mh=Q;this.ZD=ia;this.kd=wa;this.hd=Ua;this.hp=kb;this.jQa=Gb}get TYi(){return N.a.instance.ga(105)?this.kd?this.kd.isFeatureEnabled(55):
w.AFrameworkApplication.fa.ka("Box4EndOfParagraphFormattingIsEnabled"):!1}get Kda(){return this.vUb||(this.vUb=Ib.a.instance.resolve("Box4.IFormatPainterStrategy"))}get PL(){return this.OGd}set PL(a){this.OGd!==a&&(this.OGd=a,this.Ma.raiseEvent("FormatPainterBrushActiveStatusChanged"))}ffi(a){this.Ma.addHandler("FormatPainterBrushActiveStatusChanged",a)}Bfh(a){const b=a.Va;ka.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",b.contextId);this.reset();var c=b.node;a=this.Mpg(a);if(this.Kda.OAh(b.contextId,
a))try{this.DPa=this.Cr.gua(c)}catch(f){throw ka.ULS.sendTraceTag(22832029,354,10,"GetParagraphProperties error: {0}",f.message),f;}this.nXb=fb.StyleReader.tE(c);c=tb.a.Bs(b);c.dA&&(this.Dob=Object(qa.a)(xq.a,c.dA.clone()));this.QOd=a?yb.a.paragraph:b.contextId;this.Kda.kAf(b.node,this.DPa,this.Dob)}nCf(a){const b=N.a.instance.ga(14),c=this.Mpg(a);for(let Q=0;Q<a.length;Q++){var f=a.ga(Q);if(f.Pk){var l=void 0;if(f.contextId===yb.a.Mf||f.contextId===yb.a.textRange)l=b&&this.ZD.Xua(f);else if(f.contextId===
yb.a.paragraph)l=b&&this.ZD.f2c(f);else if(f.contextId===yb.a.endOfParagraph)l=b&&this.ZD.$0c(f);else{ka.ULS.sendTraceTag(22832033,354,50,"Skipped applying format to context: {0}",f.contextId);continue}ka.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",f.contextId);if(l)ka.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");else{l=Object(qa.a)(kf.AParagraphNode,f.node);var y=!1;l&&(y=f.contextId===yb.a.textRange&&!!l&&!f.Sa&&f.Mb===this.Cr.textLength(l));
if(y=this.Kda.dAh(this.QOd,f.contextId,c,y))try{Db.ParagraphReader.ae(l)?(this.nXb&&this.bL.aba(this.nXb,l,!0),this.qx.rCf(l,this.DPa)):ka.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",f.node.type)}catch(ia){throw ka.ULS.sendTraceTag(22832065,354,10,"ApplyParagraphProperties error: {0}",ia.message),ia;}var H=f;f.contextId===yb.a.paragraph?H=cb.a.createTextRange(l,0,Db.ParagraphReader.textLength(l)):f.contextId===yb.a.Mf&&(H=this.Qt.l8b(f),
H=ge.a.ZRa(H));if(H&&H.contextId===yb.a.textRange)try{this.Oli(H,this.Dob,y?null:this.nXb)}catch(ia){throw ka.ULS.sendTraceTag(22832066,354,10,"ApplyFormattingsToTextRange error: {0}",ia.message),ia;}if(f.contextId===yb.a.paragraph||f.contextId===yb.a.endOfParagraph){y=new ob.GraphIterator;y.set(l);y.kf();y.Kg(11);H=Zb.ListReader.Hk(y);const ia=!Db.ParagraphReader.textLength(l);ka.ULS.sendTraceTag(22832067,354,50,"Applied format to EOP: InList - {0}, IsEmpty - {1}.",H,ia);H?(this.fh.Wna(y),f=y.currentNode,
this.fh.xea(f)&&this.fp.tsd(f,l,this.Dob)):this.TYi&&this.Nli(f,this.Dob)}}}else ka.ULS.sendTraceTag(22832068,354,50,"Attempt to apply format to non-graph-node context: {0}",f.contextId)}}Nli(a,b){b&&(a=this.mh.w5d(a.node),a.fe(a.Je),this.oCf(a,b,null))}Oli(a,b,c){if(b||c)0<cg.h(a).length&&ka.ULS.sendTraceTag(22832071,354,50,"User tried to apply format on Blob objects"),this.jQa.fKc(a,f=>{this.oCf(f,b,c)})}oCf(a,b,c){this.If.ZCa(a);a.dA&&a.dA.removeProperty(ab.a.highlight);this.If.uMc(a);this.ny(a,
c);this.ny(a,b)}ny(a,b){if(b){var c=a.paragraph.Lh;if(c){var f=a.dA;f=f?Object(qa.a)(CM.a,f.clone()):xq.a.kDa(1179725);for(const y of b.mA())if(y!==Ab.a.YG&&y!==Ab.a.fieldInstruction&&y!==ab.a.xt&&y!==ab.a.X_&&y!==Ab.a.Vbb&&y!==ab.a.yt&&y!==Ab.a.languageHint&&y!==Ab.a.noProof){if(y===$c.a.q3){var l=b.sa($c.a.q3,ha.a.nil);if(l!==ha.a.nil&&(l=Object(qa.a)(xq.a,c.ze(l)),l=fb.StyleReader.qXc(l),l===Box4Intl.Box4Strings.L_StyleWordHyperlink)){l=fb.StyleReader.JL(a.paragraph).vtj(l);f.ny(l);continue}}f.setValue(y,
b.Rh(y))}f.Kcb?b=c.bLa(f):(c.ZE(f),b=f);a.Am=b.id}}}Mpg(a){return!a.gda&&a.jf.contextId!==yb.a.endOfParagraph}reset(){this.DPa=this.nXb=this.Dob=null;this.QOd=yb.a.none}}Object(m.a)(uE,"FormatPainter",null,[312]);class Yz{constructor(a){this.zl=this.transaction=null;this.Nf=a;this.nvb=this.wq=0}}Object(m.a)(Yz,"SelectAllArguments",null,[]);class os{constructor(a,b,c,f,l){this.W3h=a;this.oia=b;this.Lk=c;this.dHd=f;this.LVb=l}get TNe(){return this.W3h}get Vn(){return this.oia.value}get lgl(){return this.dHd?
this.LVb?Object(I.a)(this,this.Y0i,"expandSelectionOneNote"):Object(I.a)(this,this.Z0i,"expandSelectionWord"):Object(I.a)(this,this.Iuh,"selectAllInOutline")}get Juh(){return this.LVb?Object(I.a)(this,this.Vqd,"selectAllOutlines"):null}vb(){const a=w.AFrameworkApplication.Ra;this.Juh&&a.ra(C.a.Vqd,yb.a.view,this.Juh,2);a.ya(C.a.gba,ie.a.frame,os.PBh);a.ya(C.a.wtd,ie.a.frame,os.PBh);a.ra(C.a.pta,yb.a.view,this.lgl,2);a.ra(C.a.SAf,yb.a.view,D.AFrame.ve,100);a.ra(C.a.hJe,yb.a.view,os.hJe,4)}Y0i(a,b,
c){return this.pta(b,c,null)}pta(a,b,c){if(1===b)return 32;if(!a.view.Sh)return 2;b=a.view;if(!b.Nb)return 8;const f=b.Nb.Pa;if(!f||!f.length)return 8;pb.a.mark(5798);Rc.App.Lb.Kd.isEditingAllowed||Rc.App.Lb.Kd.sz?a=Mb.SelectionEditor.vbe(f):(v.FocusManager.instance().fC(D.AFrame.JW),a=Od.SelectionFactory.CYe(b.Ag));if(!a)return 8;this.dHd&&!f.Qsa&&ka.ULS.sendTraceTag(39098305,324,50,"Progress selection start");c&&this.TNe.Acb(Mb.SelectionEditor.S5f(a))?c=c(b):(c=new Yz(b),c.zl=a,c=new Lh.a(null,
Object(I.a)(this,this.FKb,"processSetSelection"),c),c.$l("ExpandSelection"),c.run());return c.inProgress?1:32}Z0i(a,b,c,f,l){return b.view.qp?this.pta(b,c,Object(I.a)(this,this.SEh,"startOperationOfSelectAllInOutline")):this.Iuh(a,b,c,f,l)}FKb(a,b){return 0===b.wq?(b.transaction=this.Lk.je(2),b.transaction.ld(b.Nf.Ag),b.wq=1,!0):1===b.wq?(b.Nf.Nb.QNb(b.zl,a),b.wq=2,!0):2===b.wq?(b.Nf.Nb.Pa.Qsa=b.zl.Qsa,this.Vn.Aw(),b.transaction.iV(a),b.wq=3,b.transaction.dispose(),pb.a.mark(5799),!0):!1}Iuh(a,b,
c){if(1===c)return 32;if(!b.view.Sh)return 2;a=b.view;return a.Nb&&a.Nb.Pa&&a.Nb.Pa.mb?this.SEh(a).inProgress?1:32:8}SEh(a){w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IQoETinyWinsSelectAllSettings");this.dHd&&a.qp&&ka.ULS.sendTraceTag(39098306,324,50,"Progress select all reach top");a=new Lh.a(null,Object(I.a)(this,this.FUk,"processSelectAllInOutline"),new Yz(a));a.$l("SelectAllInOutline");a.run();return a}FUk(a,b){if(0===b.wq)return b.zl=Od.SelectionFactory.mgl(b.Nf.Nb.Pa.mb),
b.transaction=this.Lk.je(2),b.transaction.ld(b.Nf.Ag),b.wq=1,!0;if(1===b.wq){if(!b.nvb)return N.a.instance.ga(77)&&N.a.instance.ga(104)&&b.zl.Sl?(b.Nf.Nb.QNb(b.zl,a),b.nvb=b.zl.length):(b.Nf.Nb.setSelection(b.zl.ga(0),a),++b.nvb),!0;if(b.nvb<b.zl.length)return b.Nf.Nb.oyf(b.zl.ga(b.nvb),a),++b.nvb,!0;b.wq=2}return 2===b.wq?(b.Nf.Nb.Pa.Qsa=b.zl.Qsa,this.Vn.Aw(),b.transaction.iV(a),b.wq=3,b.transaction.dispose(),!0):!1}Vqd(a,b,c){if(1===c)return 32;if(!b.view.Sh)return 2;b=b.view;a=Od.SelectionFactory.CYe(b.Ag);
if(!a)return 8;b=new Yz(b);b.zl=a;a=new Lh.a(null,Object(I.a)(this,this.FKb,"processSetSelection"),b);a.$l("ExpandSelection");a.run();return a.inProgress?1:32}static get Tkb(){return os.l6a||(os.l6a=Ib.a.instance.resolve("Box4.ISelectionContextMenuProvider"))}static hJe(a,b,c){if(1===c)return 32;if(!b.view.Sh)return 8;a=b.view;b=Od.SelectionFactory.Aj(a.root.graphNode,!0);if(!b)return 8;a.Nb.setSelection(b);return 32}static PBh(){if(!N.a.instance.ga(75))return 2;var a=Rc.App.Lb.Kd.fL;if(!a.Sh)return 2;
if(a.Sh&&1!==Rc.App.Lb.state){pb.a.mark(4668);var b=a.Nb.Pa.mb;if(!b&&w.AFrameworkApplication.fa.ka("ContextMenuOnSelectionFixIsEnabled"))return 2;b=Mb.SelectionEditor.yja(b);let c=b.x,f=b.y+b.height;if(!a.container)return 8;a=Sys.UI.DomElement.getBounds(a.container);if(b.y<a.y||b.y>a.y+a.height||b.x<a.x||b.x>a.x+a.width)c=a.x,f=a.y;os.Tkb.gba(new Sys.UI.Point(c,f),1);pb.a.mark(4669)}return 32}}os.l6a=null;Object(m.a)(os,"SelectAllHandlers",null,[353]);class DM extends Ai.StandardDialog{constructor(a,
b,c=null){super();this.Ad=1;b?(b=CommonUIStrings.l_GoToClassicRibbonDialogMesage,this.iSd(CommonUIStrings.l_ToggleRibbonUXDialogTellUsWhy,c)):b=CommonUIStrings.l_GoToSingleLineRibbonDialogMessage;this.THb(CommonUIStrings.l_ToggleRibbonUXDialogTitle,b,null,null,a,null)}}Object(m.a)(DM,"ToggleRibbonUXDialog",Ai.StandardDialog,[]);const PR=()=>{const a=w.AFrameworkApplication.Ra;a.ra(G.a.uWk,ie.a.frame,NR,101);a.ya(G.a.JGl,ie.a.frame,OR)},OR=(a,b,c)=>{if(1===c)return 32;if(b.contextId!==ie.a.frame)return 2;
ka.ULS.sendTraceTag(25523336,340,50,"User opened the toggle Ribbon UX dialog from the {0}",w.AFrameworkApplication.Aa.ob.Qp?"Single Line Ribbon":"Classic Ribbon");new DM(f=>{1===f&&w.AFrameworkApplication.Ra.processAction(G.a.cJh,2)},w.AFrameworkApplication.Aa.ob.Qp);return 32},NR=(a,b,c,f,l)=>{l[wh.a.On]=w.AFrameworkApplication.Aa.ob.Qp;return 32};class vE{constructor(a){this.If=a}WZe(a,b){this.If.jV(a,b.cache.wL);this.If.Xq(a,b.cache.fontSize)}HZe(){}Lae(){return null}VW(){return null}tUa(){return null}c9(){return null}iBh(){return!1}}
Object(m.a)(vE,"FormattingStewardBridge",null,[342]);var EM=d(746),QR=d(697);class FM{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc){this.pe=()=>{};this.hFa=()=>{const yc=this.kb.hk();return yc?yc.hFa():null};this.onShapeSelected=(yc,tc)=>{this.Js.kph(this.onShapeSelected);tc.shapeNode.F4?32!==this.ia.processAction(ea.a.T7a,2)&&xa.a.J(509724675,822,10,"Not able to begin edit shape text on title placeholder"):xa.a.J(509724674,822,10,"After selecting title placeholder, the selected shape is not the title placeholder")};
this.Kuh=()=>{const yc=this.hFa();return yc?(this.Js.Pzf(this.onShapeSelected),this.kb.selectShape(yc,!0),!0):!1};this.Kng=()=>{const yc=this.kb.Se();return!!yc&&1===yc.length&&!!this.hFa()};this.Nrg=()=>{var yc=this.kb.Xd();if(1!==yc.length)return!1;yc=yc[0];return!yc.F4&&!yc.Of&&!yc.Ug&&!yc.Wf&&yc.hasText&&0<yc.textLength()};this.Nyj=(yc,tc,xd,Vd,Ld)=>{if(1===xd)return 32;var ye=this.hFa();const Xd=this.kb.Xd(),Xf=1===Xd.length?Xd[0]:null;0<Xd.length&&Xf!==ye?this.Nrg()?(ye=3,yc=this.Rfg(yc,tc,
xd,Vd,Ld)):(ye=4,yc=32):this.Kng()?(ye=1,yc=this.Meg(yc,tc,xd,Vd,Ld)):this.Llg()?(ye=2,yc=this.qeg(yc,tc,xd,Vd,Ld)):(xa.a.J(509724673,822,10,"SlideTitle performed no action since none were enabled"),ye=5,yc=8);Object(eb.a)("RefactorSlideTitleTelemetry")?Vd&&(Vd.QC=ye):wn.a("AddEditOrSetAsSlideTitle",32===yc,void 0,[Object.assign(new iq.a,{name:"SubAction",int64:ye})]);return yc};this.Meg=(yc,tc,xd)=>1===xd?this.Kng()?32:2:this.Kuh()?32:8;this.seg=(yc,tc,xd)=>{if(1===tc)return this.Llg()?32:2;tc=new Date;
const Vd=this.Eb.xd(15,void 0,void 0,()=>{const Ld=this.kb.Se();if(Ld&&1===Ld.length){const ye=new Date;let Xd=0;Xd=window.setInterval(()=>{this.Kuh()?window.clearInterval(Xd):2E3<+new Date-+ye&&(xa.a.J(509724672,822,50,"AddSlideTitle or AddHiddenSlideTitle couldn't find title placeholder {0}ms after executing",2E3),window.clearInterval(Xd))},100)}});try{xa.a.J(509724643,822,50,"HandleAddSlideTitle called with isOffSlideTitle {0}",xd);Vd.hc(this.u5.Ef);Vd.fd=yc;for(const Ld of this.kb.Se())Ld&&!Ld.hFa()&&
(Ld.hGa=xd)}finally{Vd&&Vd.dispose()}yc=new Date;xa.a.J(509724642,822,50,"HandleAddSlideTitle completed with isOffSlideTitle {0}",xd);if(xd=Nc.a.Kb)xd.vm("AddSlideTitleStart",tc),xd.vm("AddSlideTitleEnd",yc),xd.Oj=!1,xd.vr=!0,Nc.a.Jaa(xd);return 32};this.qeg=(yc,tc,xd)=>this.seg(yc,xd,!1);this.Pyj=(yc,tc,xd)=>this.seg(yc,xd,!0);this.Rfg=(yc,tc,xd)=>{if(1===xd)return this.Nrg()?32:2;xd=this.kb.hk();const Vd=this.kb.Xd();if(1!==Vd.length)return xa.a.J(509724641,822,10,"SetAsSlideTitle should only be enabled with 1 shape selected"),
8;tc=new Date;const Ld=this.Eb.xd(15);try{xa.a.J(509724640,822,50,"HandleSetAsSlideTitle called for SlideId.Cid {0} with shapeId {1}",xd.Db.cid,Vd[0].get_shapeId()),Ld.hc(xd),Ld.fd=yc,xd.ZLa=Vd[0].get_shapeId()}finally{Ld&&Ld.dispose()}yc=new Date;xa.a.J(509724639,822,50,"HandleSetAsSlideTitle completed for SlideId.Cid {0} with shapeId {1}",xd.Db.cid,Vd[0].get_shapeId());if(xd=Nc.a.Kb)xd.vm("SetAsSlideTitleStart",tc),xd.vm("SetAsSlideTitleEnd",yc),xd.Oj=!1,xd.vr=!0,Nc.a.Jaa(xd);32!==this.ia.processAction(ea.a.T7a,
2)&&xa.a.J(509724638,822,10,"Not able to begin edit shape text after Set as Slide Title");return 32};this.BBj=(yc,tc,xd)=>this.kb.S_()?this.ia.processAction(C.a.n$b,xd):this.ia.processAction(this.ima?ea.a.NQc:ea.a.fsa,xd);this.Kyj=(yc,tc,xd)=>{if(1===xd)return 32;yc={};this.u5c&&(yc.query="AssetID="+this.u5c);tc={};tc.ZA=ResourceStrings.L_Help;tc.assetId="FA000000012";tc.nonPersistedSettings=yc;tc.c$e=!1;return this.ia.Ka(ea.a.Oga,2,tc)};this.AYj=()=>{if(!this.Pkc)return!1;const yc=this.kb.Qf();return 1!==
yc.length?!1:yc[0].rO};this.egg=(yc,tc,xd)=>{const Vd=this.ta.Ba;if(!Vd||this.$b.$c(Vd))return 8;if(1===xd)return this.AYj()?32:2;tc=Nc.a.kk("Captions::Insert");try{return QR.a.B2e(".vtt",EM.e,()=>EM.d(yc,this.KPj,"captions",this.Ie,Vd),"captions",Vd,this.ta.presentation,this.$b,this.Ud,tc,!1,this.Cfb,50,10,3),tc&&tc.Wa("CaptionsDialogInitialized","true"),32}catch(Ld){xa.a.J(509724637,818,10,"Error while rendering new captions selection dialog.")}tc&&(tc.Wa("CaptionsDialogInitialized","false"),tc.finish(),
tc=null);return 8};this.KPj=(yc,tc,xd,Vd,Ld,ye,Xd)=>{Vd.hO(xd)&&xa.a.J(509724636,822,15,"Captions::InsertCaptionsSuccessAfterUpload:Presentation was blocked with loader for {0} milliseconds",+new Date-+xd.Mja);Vd.xK(xd);Ld&&Ld.Wa("CaptionsUploadToRC","true");Object(eb.a)("FixForInsertMediaSlideNavigationIssue")||(Xd=this.ta.Ba);if(Xd&&Xd.isConnected&&(ye=ye.files[0].name,Vd=xd="",Xd=ye.split("."),2<=Xd.length&&(Vd=Xd[Xd.length-2]),bb.a.He(Vd)||(xd=ye.lastIndexOf("."),xd=0<=xd?ye.substring(0,xd):ye,
Vd=""),ye=this.kb.Qf(),1===ye.length)){ye=ye[0];Xd=this.Eb.xd(15);try{Xd.hc(ye),Xd.fd=yc,Ld&&Ld.Wa("InsertCaptionsInProgress","true"),ye.Bub=tc,ye.zub=xd,ye.Aub=Vd}finally{Xd&&Xd.dispose()}Ld&&(Ld.Wa("InsertCaptionsSuccessful","true"),Ld.finish())}};this.N1j=()=>{if(!this.Pkc)return!1;const yc=this.kb.Qf();return 1!==yc.length?!1:yc[0].rO};this.EEj=(yc,tc,xd)=>{if(1===xd)return this.N1j()?32:2;tc=this.kb.Qf();if(1!==tc.length)return 16;xd=tc[0];tc=new Date;const Vd=this.Eb.xd(15);try{xa.a.J(509724635,
822,50,"RemoveAllCaptions started"),Vd.hc(xd),Vd.fd=yc,xd.yBb=!0}finally{Vd&&Vd.dispose()}yc=new Date;xa.a.J(509724634,822,50,"RemoveAllCaptions completed");if(xd=Nc.a.Kb)xd.vm("RemoveAllCaptionsStart",tc),xd.vm("RemoveAllCaptionsEnd",yc),xd.Oj=!1,xd.vr=!0,Nc.a.Jaa(xd);return 32};this.isInHighContrastMode=()=>window.matchMedia("screen and (forced-colors: active)").matches;this.bCj=(yc,tc,xd,Vd)=>{if(this.isInHighContrastMode())return 2;if(1===xd)return 32;yc=document.getElementById("WACDocumentPanel");
(tc=Sys.UI.DomElement.containsCssClass(yc,"GrayscaleDocumentContent"))?Sys.UI.DomElement.removeCssClass(yc,"GrayscaleDocumentContent"):Sys.UI.DomElement.addCssClass(yc,"GrayscaleDocumentContent");this.uu.PA();Vd&&(Vd.QC=tc?0:1);return 32};this.Cpc=(yc,tc,xd,Vd,Ld)=>{Ld.Hf(Sys.UI.DomElement.containsCssClass(document.getElementById("WACDocumentPanel"),"GrayscaleDocumentContent")&&!this.isInHighContrastMode());return 32};this.avh=()=>{const yc=this.kb.Qf();return 0===yc.length?!1:!yc.some(tc=>!tc||!tc.RL)};
this.qCj=(yc,tc,xd,Vd)=>{tc=this.kb.Qf();if(1===xd)return 0<tc.length?32:2;xd=new Date;const Ld=this.Eb.xd(15);try{xa.a.J(509092049,822,50,"handleMarkAsDecorative started");Ld.hc(this.kb.hk());Ld.fd=yc;let ye=this.avh();for(const Xd of tc)Xd&&Xd.RL===ye&&(Xd.RL=!ye);Vd&&(Vd.QC=ye?0:1)}finally{Ld&&Ld.dispose()}yc=new Date;xa.a.J(509092048,822,50,"HandleMarkAsDecorative completed");if(Vd=Nc.a.Kb)Vd.vm("MarkAsDecorativeStart",xd),Vd.vm("MarkAsDecorativeEnd",yc),Vd.Oj=!1,Vd.vr=!1,Nc.a.Jaa(Vd);return 32};
this.Hpc=(yc,tc,xd,Vd,Ld)=>{Ld.Hf(this.avh());return 32};if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("pptSelectionManager");if(!c)throw Error.argumentNull("transactionFactory");if(!f)throw Error.argumentNull("pptWorkspace");if(!l)throw Error.argumentNull("graphOperationEventSource");if(!y)throw Error.argumentNull("graphTopologyManager");if(!H)throw Error.argumentNull("graphActionBlockingManager");if(!Q)throw Error.argumentNull("errorHandler");if(!ia)throw Error.argumentNull("sessionInfo");
if(!wa)throw Error.argumentNull("ribbonUser");this.ia=a;this.kb=b;this.Eb=c;this.u5=f;this.Js=l;this.ta=y;this.$b=H;this.Ud=Q;this.Ie=ia;this.uu=wa;this.u5c=Ua;this.Pkc=kb;this.m9c=Gb;this.b7c=ec;this.ima=dc;this.Cfb=Fc}vb(){this.ia.ra(ea.a.ixf,hc.a.application,this.Nyj,12);this.ia.ra(ea.a.editSlideTitle,hc.a.application,this.Meg,4);this.ia.ra(ea.a.addSlideTitle,hc.a.application,this.qeg,4);this.ia.ra(ea.a.Cxf,hc.a.application,this.Pyj,4);this.ia.ra(ea.a.setAsSlideTitle,hc.a.application,this.Rfg,
4);this.ia.ra(ea.a.Egh,hc.a.application,this.BBj,4);this.ia.ya(ea.a.jwf,hc.a.application,this.Kyj);this.ia.ra(ea.a.pkg,yb.a.application,this.egg,4);this.ia.ra(ea.a.qkg,yb.a.application,this.egg,4);this.ia.ra(ea.a.onh,hc.a.application,this.EEj,4);this.m9c&&(this.ia.ra(ea.a.Lkg,yb.a.application,this.bCj,12),this.ia.ra(ea.a.Cpc,yb.a.application,this.Cpc,96));this.b7c&&(this.ia.ra(ea.a.gIe,yb.a.application,this.qCj,12),this.ia.ra(ea.a.Hpc,yb.a.application,this.Hpc,96))}Llg(){for(const a of this.kb.Se())if(a&&
!a.hFa())return!0;return!1}}Object(m.a)(FM,"AccessibleAuthoringActor",null,[251]);var RR=d(142),SR=d(184);class GM{constructor(a,b,c,f){this.r9c=!1;this.e$="";this.CEb=!1;this.eZa=null;this.J6c=-1;this.KEb=!1;this.ema=[];this.Jb=b;this.la=c;this.gfd=f;a&&this.Jb.ff(()=>{a.fE(Object(I.a)(this,this.lHk,"onSelectionChangeFinished"))})}vb(){}pe(){}i8b(a,b,c){const f=[];for(const l of a)f.push(appChrome.actions.addScalingStepInTab("Home",{["type"]:b,["controlId"]:l},c));return f}KWc(a){const b=[];for(let c=
0;4>c;c++){const f={["type"]:"DropPreviewItemFromGallery",["controlId"]:a};let l=null;2>c&&(l=0);b.push(appChrome.actions.addScalingStepInTab("Home",f,l))}b.push(appChrome.actions.addScalingStepInTab("Home",{["type"]:"GalleryToFlyout",["controlId"]:a},null));return b}yag(a){const b=[];let c=!1;if(a){switch(this.e$){case "FormatPicture":Array.addRange(b,this.KWc("PictureStyles"));c=!0;break;case "Table":this.KEb||Array.addRange(b,this.KWc("TableStyles"));c=!0;break;case "SmartArtDesign":Array.addRange(b,
this.KWc("ChangeSmartArtLayoutAnchor"));c=!0;break;case "Graphics":Array.addRange(b,this.KWc("GraphicsStylePreviewGallery"));c=!0;break;case "Audio":c=!0;break;case "FormatShape":Array.addRange(b,this.i8b(["InsertShapeTextBoxBig","AlternativeText"],"DropLabel",0)),Array.addRange(b,this.i8b(["InsertShapeTextBoxBig","AlternativeText"],"MoveToOverflow",0)),Array.addRange(b,this.i8b(["SetWidth","SetHeight"],"MoveToOverflow",null))}c&&(a=null,this.KEb&&(a=0),Array.addRange(b,this.i8b(this.eZa,"DropLabel",
a)),a=this.eZa.slice(0,this.eZa.length).reverse(),Array.addRange(b,this.i8b(a,"MoveToOverflow",null)))}else for(const f of this.eZa)b.push(appChrome.actions.removeControlScalingStepsFromTab(f,"Home"));return b}f$d(a){const b={};for(const c of a)try{b[c]=appChrome.selectors.getModelType(c)}catch(f){return this.MGa("Error","GetModelType failed for "+c),null}return b}r$d(a){switch(a){case "FormatPicture":case "SmartArtDesign":case "Audio":case "Graphics":return["Font","Paragraph","Drawing"]}return[]}TQb(a){this.gfd&&
(a=this.f$d(a))&&this.gfd(a)}LMl(a){if(a.length){if(this.gfd){var b=this.f$d(a);if(!b)return;var c=this.r$d(this.e$);if(0<c.length&&!this.CEb){for(var f of c)this.ema.push(appChrome.actions.updateGroupHiddenState(f,!0));this.CEb=!0}else if(this.CEb&&!c.length){c=[];f=this.r$d("FormatPicture");for(var l of f)this.ema.push(appChrome.actions.updateGroupHiddenState(l,!1)),Array.addRange(c,appChrome.selectors.getVisibleControlsInGroup(l));if(l=this.f$d(c))for(let y in l)b[y]=l[y];this.CEb=!1}this.gfd(b)}this.eZa=
a;b=[];for(const y of a)appChrome.selectors.isControlDisabled(y)&&b.push(y);0<b.length&&this.MGa("Disabled",b.join(","));0<this.eZa.length&&(this.ema.push(appChrome.actions.updateGroupHiddenState("Adaptive",!1)),this.ema.push(appChrome.actions.updateControlsInGroup("Adaptive",this.eZa)),Array.addRange(this.ema,this.yag(!0)),this.r9c=!0)}}crh(a){""!==this.e$&&this.e$!==a&&Array.addRange(this.ema,this.yag(!1))}O8e(a,b){if(a||this.r9c)if(this.ema.push(appChrome.actions.updateGroupHiddenState("Adaptive",
!a)),this.r9c=a,b=this.r$d(b),a&&0<b.length||this.CEb){for(var c of b)this.ema.push(appChrome.actions.updateGroupHiddenState(c,a));a||(c=appChrome.selectors.getVisibleControlsInGroup("Font"),Array.addRange(c,appChrome.selectors.getVisibleControlsInGroup("Paragraph")),this.TQb(c));this.CEb=a}}nUf(){0<this.ema.length&&(appChrome.api.dispatch(this.ema),this.ema=[])}Bzi(a,b){if(0>Array.indexOf(a,b)||"SmartArtDesign"===b&&(this.TQb(["SmartArtEditText"]),appChrome.selectors.getButtonToggleState("SmartArtEditText")))return!1;
a=!1;if("Table"===b&&Lk.a.instance.mb){const c=!Lk.a.instance.mb.Sl&&!Lk.a.instance.mb.i3c;if(a=(""===this.e$||this.e$===b)&&c!==this.KEb)this.KEb=c}a?this.crh("TableCellEdit"):this.crh(b);this.e$=b;return!0}tgl(){const a="Table FormatPicture SmartArtDesign Audio Graphics FormatShape".split(" ");let b=!1;const c=appChrome.selectors.getActiveContextualTabIds();for(const f of a)if(this.Bzi(c,f)){b=!0;break}return b?this.e$:""}Haj(){switch(this.e$){case "FormatPicture":return"ChangePictureFlyout ChangePicture ResetPicture PictureStyles PictureBorders AlternativeText ArrangeAnchor PictureCropAnchor SetWidth SetHeight".split(" ");
case "Table":return this.KEb?["Select","TableDelete","TableInsert","TableAlignmentAnchor"]:"Select TableDelete TableInsert MergeTableCells SplitTableCells SetSizeAnchor TableDistribute TableAlignmentAnchor TableCellMarginAnchor ApplyTableStyleOptionAnchor TableStyles PowerPointCellShadingMenuOpen TableAlternativeText TableBordersMenuOpen TableBorderWidthAnchor SetCellBorderColor".split(" ");case "SmartArtDesign":return"SmartArtEditText SmartArtPromote SmartArtDemote SmartArtReverse ChangeSmartArtLayoutAnchor ChangeSmartArtColorAnchor SmartArtStyles SmartArtResetGraphic AlternativeText SetWidth SetHeight".split(" ");
case "FormatShape":return["SetWidth","SetHeight","InsertShapeTextBoxBig","AlternativeText"];case "Audio":return"AudioPlay AudioPause SetVolume StartAudio SetAudioOptions PlayInBackground NoAudioStyle ChangePictureFlyout ChangePicture ResetPicture AudioPictureStyles PictureBorders AlternativeText ArrangeAnchor PictureCropAnchor SetWidth SetHeight".split(" ");case "Graphics":return"GraphicsStylePreviewGallery ChangeGraphicFlyout GraphicsFill GraphicsOutline AlternativeText ArrangeAnchor SetWidth SetHeight".split(" ")}return[]}lHk(a,
b){if(!this.la.nza&&"Home"===appChrome.selectors.getSelectedTabId()&&b.zl&&b.zl.mb&&b.zl.length){var c=()=>{const f=this.e$;""===this.tgl()?this.O8e(!1,f):this.KEb||""===f||f!==this.e$?this.LMl(this.Haj()):this.r9c||(this.TQb(this.eZa),this.O8e(!0,this.e$));this.nUf()};-1!==this.J6c&&window.clearTimeout(this.J6c);this.J6c=window.setTimeout(()=>{this.J6c=-1;let f=!1;try{window.self.requestIdleCallback(c)}catch(l){f=!0}f&&window.self.requestAnimationFrame(c)},250)}else this.O8e(!1,this.e$),this.nUf()}MGa(a,
b){a={["Time"]:window.performance.now(),["Event"]:a,["Message"]:b,["Scenario"]:"AdaptiveTabGroup"};RR.a.sendActivityEvent(Object.assign(new SR.a,{name:"Office.TellMe.TellMeWAC.Events",dataFields:rB.a.kz(a),durationMs:window.performance.now()}))}}Object(m.a)(GM,"AdaptiveTabGroupUpdaterActor",null,[251]);class HM extends bu{constructor(a,b){super(a);this.u9h=b;this.Ot=a}getAltText(a){return(a=this.FQ(a))?a.get_altTitle():""}i6f(a){return(a=this.FQ(a))?a.get_alt():""}aUd(a,b){if(1===a)if(this.hide(),
a=this.FQ(this.Ot)){const c=this.u9h.je(15);c.hc(a);a.uza=!1;a.set_altTitle(b[Yp.cUd]);a.set_alt(b[Yp.NJc]);c.dispose()}else xa.a.J(17876899,822,10,"Try to set alternative text on a null shape.")}FQ(a){let b;return(a=(a=Kj.b(a))?a.Nb:null)&&(b=a.Xd())&&1===b.length?b[0]:null}}Object(m.a)(HM,"ShapeAltTextDialog",bu,[]);class IM{constructor(a,b,c,f,l,y,H){this.Mda=()=>this.AHa?this.AHa:this.AHa=Ib.a.instance.qb("PowerPointWebEditor.IImageDescriptionPane");this.Fki=(Q,ia,wa)=>{if(Q!==ea.a.fsa)return 16;
Q=this.kb.Xd();if(!Q||1!==Q.length||this.$b.$c(Q[0]))return xa.a.J(509088275,822,50,"No or multiple shapes selected or the selected shape is blocked. Disable the alternative text button."),16;if(1===wa)return 32;xa.a.J(509088274,822,50,"Begin setting the alternative text for shape.");Q[0].qj&&!Q[0].get_isSVGBlipFilled()&&this.la.Wua?this.Lva.FZk():this.laj(ia);return 32};this.Zyj=(Q,ia,wa,Ua)=>{if(Q!==ea.a.fsa)return 16;if(!this.Mda())return 8;if(1===wa)return 32;this.Mda().S1e();Ua&&(Ua.QC=this.Mda().isVisible?
1:0);return 32};this.sjb=(Q,ia,wa,Ua,kb)=>{if(Q!==ea.a.sjb)return 16;kb&&kb.Hf(this.Mda()?this.Mda().isVisible:!1);return 32};this.zzj=(Q,ia,wa,Ua)=>{if(Q!==ea.a.oKc)return 16;if(!this.Mda())return 8;if(1===wa)return 32;this.Mda().MCf();Ua&&(Ua.QC=1);return 32};this.QAj=(Q,ia,wa)=>{if(Q!==ea.a.NQc)return 16;if(!this.Mda())return 8;if(1===wa)return 32;this.Mda().H4d();return 32};if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("appSettings");if(!c)throw Error.argumentNull("coreExtEventSource");
if(!f)throw Error.argumentNull("selectionManager");if(!l)throw Error.argumentNull("transactionFactory");if(!y)throw Error.argumentNull("graphActionBlockingManager");this.ia=a;this.la=b;this.Lva=c;this.kb=f;this.Eb=l;this.$b=y;this.ima=H}vb(){this.ia.ra(ea.a.fsa,yb.a.view,this.ima?this.Zyj:this.Fki,12);this.la.Slg&&(this.ia.ra(ea.a.sjb,yb.a.application,this.sjb,96),this.ia.ra(ea.a.oKc,yb.a.view,this.zzj,12),this.ia.ra(ea.a.NQc,yb.a.view,this.QAj,4))}pe(){}laj(a){new HM(a,this.Eb)}}Object(m.a)(IM,"AltTextActor",
null,[251]);class JM{constructor(a,b,c,f,l,y,H,Q){this.BE=null;this.ia=a;this.kb=b;this.Fa=c;this.Eb=f;this.Edb=l;this.ewa=y;this.pc=Q;this.Edb&&this.Edb.execute(ia=>{this.BE=ia})}vb(){this.ia.ra(ea.a.yKc,hc.a.application,Object(I.a)(this,this.Bzj,"handleAudioPlay"),96);this.ia.ra(ea.a.t0b,hc.a.application,Object(I.a)(this,this.Azj,"handleAudioPause"),96);this.ia.ra(ea.a.JDf,hc.a.application,Object(I.a)(this,this.joi,"audioPlayPauseCommandHandler"),96);this.ia.ra(ea.a.Zvh,hc.a.application,Object(I.a)(this,
this.w9b,"handleSetAudioOptions"),96);this.ia.ra(ea.a.spc,hc.a.application,Object(I.a)(this,this.spc,"queryAudioOptions"),96);this.ia.ra(ea.a.playAcrossSlides,hc.a.application,Object(I.a)(this,this.w9b,"handleSetAudioOptions"),96);this.ia.ra(ea.a.Lpc,hc.a.application,Object(I.a)(this,this.Lpc,"queryPlayAcrossSlides"),96);this.ia.ra(ea.a.loopUntilStopped,hc.a.application,Object(I.a)(this,this.w9b,"handleSetAudioOptions"),96);this.ia.ra(ea.a.Gpc,hc.a.application,Object(I.a)(this,this.Gpc,"queryLoopUntilStopped"),
96);this.ia.ra(ea.a.hideDuringShow,hc.a.application,Object(I.a)(this,this.w9b,"handleSetAudioOptions"),96);this.ia.ra(ea.a.Apc,hc.a.application,Object(I.a)(this,this.Apc,"queryHideDuringShow"),96);this.ia.ra(ea.a.rewindAfterPlaying,hc.a.application,Object(I.a)(this,this.w9b,"handleSetAudioOptions"),96);this.ia.ra(ea.a.Qpc,hc.a.application,Object(I.a)(this,this.Qpc,"queryRewindAfterPlaying"),96);this.ia.ya(ea.a.playInBackground,hc.a.application,Object(I.a)(this,this.Sfg,"handleSetAudioStyles"));this.ia.ya(ea.a.noAudioStyle,
hc.a.application,Object(I.a)(this,this.Sfg,"handleSetAudioStyles"));this.ia.ra(ea.a.Mpc,hc.a.application,Object(I.a)(this,this.Mpc,"queryPlayInBackground"),96);this.ia.ra(ea.a.Ipc,hc.a.application,Object(I.a)(this,this.Ipc,"queryNoAudioStyle"),96);this.ia.ra(ea.a.setVolume,hc.a.application,Object(I.a)(this,this.x9b,"handleSetVolume"),96);this.ia.ra(ea.a.ctd,hc.a.application,Object(I.a)(this,this.x9b,"handleSetVolume"),96);this.ia.ra(ea.a.Upc,hc.a.application,Object(I.a)(this,this.Upc,"querySetVolumeLow"),
96);this.ia.ra(ea.a.dtd,hc.a.application,Object(I.a)(this,this.x9b,"handleSetVolume"),96);this.ia.ra(ea.a.Vpc,hc.a.application,Object(I.a)(this,this.Vpc,"querySetVolumeMedium"),96);this.ia.ra(ea.a.btd,hc.a.application,Object(I.a)(this,this.x9b,"handleSetVolume"),96);this.ia.ra(ea.a.Tpc,hc.a.application,Object(I.a)(this,this.Tpc,"querySetVolumeHigh"),96);this.ia.ra(ea.a.etd,hc.a.application,Object(I.a)(this,this.x9b,"handleSetVolume"),96);this.ia.ra(ea.a.Wpc,hc.a.application,Object(I.a)(this,this.Wpc,
"querySetVolumeMute"),96);this.ia.ra(ea.a.CEh,hc.a.application,Object(I.a)(this,this.MFj,"handleStartAudio"),96);this.ia.ra(ea.a.dqc,hc.a.application,Object(I.a)(this,this.dqc,"queryStartAudio"),96)}pe(){}Bzj(a,b,c,f,l){b=this.kb.Xd();if(1<b.length||!this.BE)return 16;const y=this.BE.yL(b[0]);if(!y||!y.isPlayerReady())return 16;if(1===c)return 32;let H=!1;l&&(H=!!l.ActionFromPlayer);return Qg.b("AudioPlaybackOptionsActor::HandleAudioPlay ActionFromPlayer",H.toString(),a,()=>{y&&!H&&y.startPlaying();
const Q=[appChrome.actions.updateControlHiddenState("AudioPlay",!0),appChrome.actions.updateControlEnabledDisabledState("AudioPause",!1),appChrome.actions.updateControlHiddenState("AudioPause",!1)];appChrome.api.dispatch(Q);return 32})}Azj(a,b,c,f,l){const y=this.kb.Xd();if(1<y.length||!this.BE)return 16;if(1===c)return 32;let H=!1;l&&(H=!!l.ActionFromPlayer);return Qg.b("AudioPlaybackOptionsActor::HandleAudioPause ActionFromPlayer",H.toString(),a,()=>{var Q=this.BE.yL(y[0]);Q&&!H&&Q.pause();Q=[appChrome.actions.updateControlEnabledDisabledState("AudioPlay",
!1),appChrome.actions.updateControlHiddenState("AudioPlay",!1),appChrome.actions.updateControlHiddenState("AudioPause",!0)];appChrome.api.dispatch(Q);return 32})}joi(){var a=this.kb.gXc();if(!a||!this.BE)return 2;(a=this.BE.yL(a))&&!a.isPlayerFocused()&&(a.isAudioPlaying()?this.ia.processAction(ea.a.t0b,2):this.ia.processAction(ea.a.yKc,2));return 32}w9b(a,b,c,f,l){if(1===c)return 32;if(!l)return xa.a.J(512500762,822,10,"AudioPlaybackOptionsActor::HandleSetAudioOptions actionData is null"),8;const y=
l.On;return Qg.b("AudioPlaybackOptionsActor::HandleSetAudioOptions audioOption: ",l.SqmControlId,a,()=>{const H=this.kb.Qf();if(H&&0<H.length){const Q=this.Eb.xd(15,void 0,()=>{this.kb.kj();this.Fa.Bd()});try{Q.hc(H[0]);for(const ia of H){if(!ia||!ia.media)continue;const wa=ia.media;switch(a){case ea.a.playAcrossSlides:wa.plyAcrssSldsField=y;break;case ea.a.loopUntilStopped:wa.repeatField=y;break;case ea.a.hideDuringShow:wa.hideDrngShwField=y;break;case ea.a.rewindAfterPlaying:wa.rewindField=y}ia.media=
wa;if(this.ewa&&this.BE&&(a===ea.a.loopUntilStopped||a===ea.a.rewindAfterPlaying)){const Ua=this.BE.yL(ia);Ua&&(a===ea.a.loopUntilStopped?Ua.setRepeat(wa.repeatField):a===ea.a.rewindAfterPlaying&&Ua.setRewind(wa.rewindField))}}}finally{Q&&Q.dispose()}}return 32})}Sfg(a,b,c,f,l){return 1===c?32:l?Qg.b("AudioPlaybackOptionsActor::HandleSetAudioStyles",l.SourceControlId,a,()=>{const y=this.kb.Qf();if(y&&0<y.length){const H=this.Eb.xd(15,void 0,()=>{this.kb.kj();this.Fa.Bd()});try{H.hc(y[0]);for(const Q of y){if(!Q||
!Q.media||Q.Ug)continue;const ia=Q.media;switch(a){case ea.a.playInBackground:ia.plyAcrssSldsField=!0;ia.repeatField=!0;ia.hideDrngShwField=!0;ia.strtField=0;break;case ea.a.noAudioStyle:ia.plyAcrssSldsField=!1,ia.repeatField=!1,ia.hideDrngShwField=!1,ia.strtField=2}Q.media=ia}}finally{H&&H.dispose()}}return 32}):(xa.a.J(512500761,822,10,"AudioPlaybackOptionsActor::HandleSetAudioStyles actionData is null"),8)}MFj(a,b,c,f,l){if(1===c)return 32;if(!l)return xa.a.J(512500760,822,10,"AudioPlaybackOptionsActor::HandleStartAudio actionData is null"),
8;const y=l.CommandValueId;return Qg.b("AudioPlaybackOptionsActor::HandleStartAudio Start Option: ",y,a,()=>{if(!y||""===y.trim())return 32;const H=this.kb.Qf();if(H&&0<H.length){const Q=this.Eb.xd(15,void 0,()=>{this.kb.kj();this.Fa.Bd()});try{Q.hc(H[0]);for(const ia of H){if(!ia||!ia.media||ia.Ug)continue;const wa=ia.media;wa.strtField="Automatically"===y?0:2;ia.media=wa}}finally{Q&&Q.dispose()}}return 32})}Mpc(a,b,c,f,l){return this.sya(l,1)}Ipc(a,b,c,f,l){return this.sya(l,0)}x9b(a,b,c,f,l){return 1===
c?32:l?Qg.b("AudioPlaybackOptionsActor::HandleSetVolume Volume: ",l.SourceControlId,a,()=>{const y=this.kb.Qf();if(y&&0<y.length){const H=this.Eb.xd(15,void 0,()=>{this.kb.kj();this.Fa.Bd()});try{H.hc(y[0]);for(const Q of y){if(!Q||!Q.media)continue;const ia=Q.media;switch(a){case ea.a.etd:ia.mteField=!0;break;case ea.a.ctd:ia.vlmField=.2;ia.mteField=!1;break;case ea.a.dtd:ia.vlmField=.5;ia.mteField=!1;break;case ea.a.btd:ia.vlmField=.8,ia.mteField=!1}this.pc.VL&&(Q.media=ia);const wa=l.ActionFromPlayer;
if(this.ewa&&this.BE&&!wa){const Ua=this.BE.yL(Q);Ua&&(Ua.setMute(ia.mteField),Ua.setVolume(ia.vlmField))}}}finally{H&&H.dispose()}}return 32}):(xa.a.J(512500759,822,10,"AudioPlaybackOptionsActor::HandleSetVolume actionData is null"),8)}Upc(a,b,c,f,l){return this.sya(l,2)}Vpc(a,b,c,f,l){return this.sya(l,3)}Tpc(a,b,c,f,l){return this.sya(l,4)}Wpc(a,b,c,f,l){return this.sya(l,5)}dqc(a,b,c,f,l){if(a=Object(qa.a)(Vh.a,l))c=this.kb.Qf(),b=this.Fqg(c,2),c=this.Fqg(c,0),b?(a.m_=ResourceStrings.L_AudioStartWhenClickedOn,
a.Dsc()):c&&(a.m_=ResourceStrings.L_AudioStartAutomatically,a.Dsc());return 32}spc(){this.fcc()&&Rc.App.Lb.BG({PlayAcrossSlides:"CheckboxModel",LoopUntilStopped:"CheckboxModel",RewindAfterPlaying:"CheckboxModel",HideDuringShow:"CheckboxModel"});return 32}Lpc(a,b,c,f,l){return this.sya(l,6)}Gpc(a,b,c,f,l){return this.sya(l,7)}Apc(a,b,c,f,l){return this.sya(l,9)}Qpc(a,b,c,f,l){return this.sya(l,8)}yYi(a){return a.media.plyAcrssSldsField&&a.media.repeatField&&!a.media.strtField}xYi(a){return!a.media.plyAcrssSldsField&&
!a.media.repeatField&&!!a.media.strtField}Fqg(a,b){if(a&&0<a.length){for(const c of a)if(!c||!c.media||c.media.strtField!==b)return!1;return!0}return!1}sya(a,b){if(a=Object(qa.a)(Vh.a,a)){const c=this.kb.Qf();if(c&&0<c.length){let f=!1;for(const l of c)if(l&&l.media){switch(b){case 0:f=this.xYi(l);break;case 1:f=this.yYi(l);break;case 5:f=l.media.mteField;break;case 2:f=!l.media.mteField&&.2>=l.media.vlmField;break;case 3:f=!l.media.mteField&&.2<l.media.vlmField&&.8>l.media.vlmField;break;case 4:f=
!l.media.mteField&&.8<=l.media.vlmField;break;case 6:f=l.media.plyAcrssSldsField;break;case 7:f=l.media.repeatField;break;case 8:f=l.media.rewindField;break;case 9:f=l.media.hideDrngShwField;break;default:f=!1}if(!f)break}a.Hf(f)}}return 32}fcc(){return!!w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.ob.Qp}}Object(m.a)(JM,"AudioPlaybackOptionsActor",null,[251]);class KM{constructor(){this.type="AudioSettingsTaskPaneProps";this.hiddenSettings=this.onSubtitleLanguageUpdated=this.onSpokenLanguageUpdated=
this.onSpeakersUpdated=this.onMicrophoneUpdated=this.availableSubtitleLanguages=this.availableSpokenLanguages=this.deviceSpeakers=this.deviceMicrophones=null;this.disableDeviceDropdown=!0;this.showDeviceErrorMessage=!1}}Object(m.a)(KM,"AudioSettingsTaskPaneProps",null,[]);class yu{constructor(){this.text=this.key=null;this.itemType=0;this.selected=!1}}Object(m.a)(yu,"DropdownOption",null,[]);class LM{constructor(a,b,c,f,l){this.CM=null;this.PHa=this.Ab=!1;a("audio-settings-strings").then(()=>{this.PHa=
!0;xa.a.J(509138197,833,50,"audio-settings-strings loaded successfully")}).catch(y=>{xa.a.J(509138196,833,10,"Failed to load audio-settings-strings "+y.toString())});this.ia=b;this.IB=f;this.Hc=c;this.xO=l}vb(){this.ia.ya(ea.a.bud,hc.a.application,Object(I.a)(this,this.bud,"showHideAudioSettingsPane"));this.ia.ra(ea.a.nLb,hc.a.application,Object(I.a)(this,this.nLb,"queryShowHideAudioSettingsPane"),96)}pe(){}bud(a,b,c){return b.contextId===hc.a.application&&this.PHa?1===c?32:Qg.a("AudioSettingsPaneToggle",
a,()=>{(this.Ab=!this.Ab)?(this.hl(),this.xO.bfi(Object(I.a)(this,this.N7g,"onAudioDevicesChanged")),xa.a.J(509138195,833,50,"AudioSettingsPaneActor::ShowHideAudioSettingsPane show")):(this.xO.f7k(Object(I.a)(this,this.N7g,"onAudioDevicesChanged")),this.aH(),xa.a.J(509138194,833,50,"AudioSettingsPaneActor::ShowHideAudioSettingsPane close"));return 32}):2}nLb(a,b,c,f,l){if(!Object(Wa.a)(Vh.a,l))return 8;l.Hf(this.Ab);return 32}hl(a=!1){a||this.fA();const b=Object.assign(new wu.a,{title:ResourceStrings.L_AudioSettings,
hideHeader:!1,width:320,location:2,contentProps:this.CM,onOpen:()=>{},onClose:()=>{this.Ab=!1},isModernPane:!0}),c=document.getElementById("AudioSettingsPaneFocus-panel");this.IB.q4(jb.a.KCa,jb.a.Xi,c,()=>{this.TA(!0)},()=>{this.TA(!1)});Bj.UISurfaces.Gq().then(f=>{a?this.Ab&&f.updateTaskPane(jb.a.KCa,b):f.showTaskPane(jb.a.KCa,b);return null}).catch(f=>{xa.a.J(509138193,833,10,"AudioSettingsPaneActor::ShowPane exception: {0}",f.toString())})}aH(){Bj.UISurfaces.Gq().then(a=>{a.hideTaskPane(jb.a.KCa,
2);return null}).catch(a=>{xa.a.J(509138192,833,10,"AudioSettingsPaneActor::ClosePane exception: {0}",a.toString())})}fA(){this.CM=Object.assign(new KM,{deviceMicrophones:[],deviceSpeakers:[],availableSpokenLanguages:this.Zsj(),availableSubtitleLanguages:this.Mtj(),onMicrophoneUpdated:Object(I.a)(this,this.fPl,"updateMicrophone"),onSpeakersUpdated:Object(I.a)(this,this.zQl,"updateSpeaker"),onSpokenLanguageUpdated:Object(I.a)(this,this.CQl,"updateSpokenLanguage"),onSubtitleLanguageUpdated:Object(I.a)(this,
this.IQl,"updateSubtitleLanguage"),hiddenSettings:["Speaker"],disableDeviceDropdown:!0,showDeviceErrorMessage:!1});this.xO.enumerateDevices(Object(I.a)(this,this.ymc,"onEnumerateDevicesSuccess"),Object(I.a)(this,this.m_a,"onDevicesFailure"),Object(I.a)(this,this.v_a,"onUnsupported"))}TA(a){const b=document.getElementById("TaskPaneCloseBtnAudioSettingsPaneFocus");a&&b&&b.focus()}ymc(a){if(0!==a.length)if(ma.a.Xa(a[0].label))this.xO.requestPermission(Object(I.a)(this,this.KGk,"onRequestPermissionSuccess"),
Object(I.a)(this,this.m_a,"onDevicesFailure"),Object(I.a)(this,this.v_a,"onUnsupported")),xa.a.J(509138191,833,50,"AudioSettingsPaneActor::OnEnumerateDevicesSuccess requesting device permission");else{var b=new Na.a,c=new Na.a;for(const f of a)ma.a.Xa(f.deviceId)||(a=Object.assign(new yu,{key:f.deviceId,text:ma.a.Xa(f.label)?f.deviceId:f.label}),"audiooutput"===f.kind?c.add(a):"audioinput"===f.kind&&b.add(a));0<b.count&&(b.ga(0).selected=!0);0<c.count&&(c.ga(0).selected=!0);this.CM.deviceMicrophones=
b.toArray();this.CM.deviceSpeakers=c.toArray();this.CM.disableDeviceDropdown=!1;this.CM.showDeviceErrorMessage=!1;this.hl(!0)}}KGk(){this.xO.enumerateDevices(Object(I.a)(this,this.ymc,"onEnumerateDevicesSuccess"),Object(I.a)(this,this.m_a,"onDevicesFailure"),Object(I.a)(this,this.v_a,"onUnsupported"));xa.a.J(509138190,833,50,"AudioSettingsPaneActor::OnRequestPermissionSuccess successfully received permissions")}m_a(a){this.CM.disableDeviceDropdown=!0;this.CM.showDeviceErrorMessage=!0;this.hl(!0);
xa.a.J(509138189,833,10,"AudioSettingsPaneActor::OnDevicesFailure unable to get devices. Error: {0}",a.toString())}v_a(){this.CM.disableDeviceDropdown=!0;this.hl(!0);xa.a.J(509138188,833,10,"AudioSettingsPaneActor::OnDevicesUnsupported mediaDevices API not available for browser: {0}",z.a.iz)}fPl(a){this.xO.microphoneDeviceId=a.key;xa.a.J(509138187,833,50,"AudioSettingsPaneActor::UpdateMicrophone user updated microphone")}zQl(){xa.a.J(509138186,833,50,"AudioSettingsPaneActor::UpdateSpeaker user updated speaker")}N7g(a,
b){b.rvk&&this.xO.enumerateDevices(Object(I.a)(this,this.ymc,"onEnumerateDevicesSuccess"),Object(I.a)(this,this.m_a,"onDevicesFailure"),Object(I.a)(this,this.v_a,"onUnsupported"))}Zsj(){const a=new Na.a;for(let b of this.Hc.x4e)a.add(Object.assign(new yu,{key:b,text:bb.a.He(b).displayName,selected:this.Hc.Fpa.toLowerCase()===b.toLowerCase()}));a.add(Object.assign(new yu,{key:"seperator",text:"-",itemType:1}));a.add(Object.assign(new yu,{key:"header",text:ResourceStrings.L_SubtitlesPreviewSpokenLanguageSectionTitle,
itemType:2}));for(let b of this.Hc.w4e)a.add(Object.assign(new yu,{key:b,text:bb.a.He(b).displayName,selected:this.Hc.Fpa.toLowerCase()===b.toLowerCase()}));return a.toArray()}Mtj(){const a=new Na.a;for(let b of this.Hc.h3e)a.add(Object.assign(new yu,{key:b,text:bb.a.He(b).displayName,selected:this.Hc.bAa.toLowerCase()===b.toLowerCase()}));return a.toArray()}CQl(a){this.Hc.Fpa=a.key;xa.a.J(509138185,833,50,"AudioSettingsPaneActor::UpdateSpokenLanguage user updated spoken language")}IQl(a){this.Hc.bAa=
a.key;this.Hc.anb=this.Hc.LXc();xa.a.J(509138184,833,50,"AudioSettingsPaneActor::UpdateSpeaker user updated subtitle language")}}Object(m.a)(LM,"AudioSettingsPaneActor",null,[251]);class MM{constructor(){this.type="CaptionDiscoverabilityTaskPaneProps";this.podiumPresentationImageUrl=null;this.enableDoNotShowAgain=!1;this.onLaunchSlideShowButtonClicked=this.onDismissButtonClicked=this.onTurnOnButtonClicked=null}}Object(m.a)(MM,"CaptionDiscoverabilityTaskPaneProps",null,[]);class Vv{constructor(a,b,
c,f,l,y,H,Q,ia,wa){this.rKg=!1;a("powerpoint-discoverability-strings").then(()=>{this.rKg=!0;xa.a.J(509138209,801,50,"powerpoint-discoverability-strings is loaded successfully")}).catch(Ua=>{xa.a.J(509138208,801,10,"Failed to load powerpoint-discoverability-strings "+Ua.toString())});this.ia=b;this.Ic=c;this.oc=f;this.ke=l;this.IB=y;this.Hc=H;this.xO=Q;this.Ekk=wa;this.Cqk=ia;this.dZg=pi.a.get("PPTCaptionDiscoverabilityLastShownTime")?!0:!1;this.Pgc=!1;this.Ic.w7a(Object(I.a)(this,this.iga,"onRibbonTabSwitched"))}dispose(){this.Ic.brc(Object(I.a)(this,
this.iga,"onRibbonTabSwitched"))}vb(){this.ia.ya(ea.a.Xtc,hc.a.application,Object(I.a)(this,this.Xtc,"showCaptionDiscoverabilityPane"))}pe(){}Xtc(a,b,c){if(b.contextId!==hc.a.application||!this.rKg)return 2;if(1===c)return 32;if(Vv.aoe||Vv.$3d||!this.u2i()||!this.t2i())return 8;this.Pgc||this.Cyi(a);return 32}Cyi(a){Qg.a("CaptionDiscoverabilityPaneActor::CheckAudioAndShowPane",a,()=>{this.Pgc=!0;this.xO.enumerateDevices(Object(I.a)(this,this.PAk,"onAudioInputAvailable"),Object(I.a)(this,this.m_a,
"onDevicesFailure"),Object(I.a)(this,this.v_a,"onUnsupported"));return 32})}PAk(a){if(a.length){for(const b of a)if("audioinput"===b.kind&&!this.Cqk.jWa()){Vv.aoe=!0;this.hl();break}this.Pgc=!1}}m_a(a){this.Pgc=!1;xa.a.J(509138207,822,10,"CaptionDiscoverabilityPaneActor::OnDevicesFailure exception: {0}",a.toString())}v_a(){this.Pgc=!1;xa.a.J(509138206,822,15,"CaptionDiscoverabilityPaneActor::OnUnsupported mediaDevices API not available for browser: {0}",z.a.iz)}hl(){const a=this.fA(),b=Object.assign(new wu.a,
{title:ResourceStrings.l_CaptionDiscoverabilityPane,hideHeader:!1,width:320,location:2,contentProps:a,onOpen:()=>{xa.a.J(509138205,822,50,"CaptionDiscoverabilityPaneActor::ShowPane")},onClose:()=>{xa.a.J(509138204,822,50,"CaptionDiscoverabilityPaneActor::ClosePane")},isModernPane:!0});this.IB.q4(jb.a.vRa,jb.a.Xi,null,()=>{},()=>{});Bj.UISurfaces.Gq().then(c=>{c.showTaskPane(jb.a.vRa,b);return null}).catch(c=>{xa.a.J(509138203,822,10,"CaptionDiscoverabilityPaneActor::ShowPane exception: {0}",c.toString())})}Iq(){Bj.UISurfaces.Gq().then(a=>
{a.hideTaskPane(jb.a.vRa,2);return null}).catch(a=>{xa.a.J(509138202,822,10,"CaptionDiscoverabilityPaneActor::HidePane exception: {0}",a.toString())})}fA(){return Object.assign(new MM,{podiumPresentationImageUrl:this.ke.qk("CaptionDiscoverabilityPromptViewImage.png"),enableDoNotShowAgain:this.dZg,onTurnOnButtonClicked:Object(I.a)(this,this.onTurnOnButtonClicked,"onTurnOnButtonClicked"),onDismissButtonClicked:Object(I.a)(this,this.onDismissButtonClicked,"onDismissButtonClicked"),onLaunchSlideShowButtonClicked:Object(I.a)(this,
this.onLaunchSlideShowButtonClicked,"onLaunchSlideShowButtonClicked")})}onTurnOnButtonClicked(){Qg.a("CaptionDiscoverabilityPaneTurnOn",ea.a.SMa,()=>{let a=8;this.Hc.Qh||(a=this.ia.Ka(ea.a.SMa,2,{}));this.Ekk&&8!==a||this.Iq();return a})}onDismissButtonClicked(){this.dZg&&(Vv.$3d=!0,xa.a.J(509138201,822,50,"CaptionDiscoverabilityPaneActor::DoNotShowAgain"));this.Iq()}onLaunchSlideShowButtonClicked(){Qg.a("CaptionDiscoverabilityPaneLaunchSlideshow",ea.a.ePb,()=>{this.Iq();return this.ia.processAction(ea.a.ePb,
2)})}iga(a,b){2!==b.Pu&&3!==b.Pu&&4!==b.Pu||!b.Xfa||"SlideShow"!==b.Xfa||Qg.a("OnRibbonTabSwitched",ea.a.Xtc,()=>this.ia.processAction(ea.a.Xtc,2))}t2i(){let a=0,b=!1,c=!1;for(var f of this.oc.ETa()){if(f.yn){b=!0;break}if(f.qFa&&(a+=f.uQ.length,4<=a))break;if(f.jbb){c=!0;break}}f=c||b||4<=a;xa.a.J(509138200,822,50,"CaptionDiscoverabilityPaneActor::FMeetsIntentToPresent - Result: {0}; Animation Count: {1}; Hidden slide: {2}, Transition: {3}",f.toString(),a.toString(),b.toString(),c.toString());return f}u2i(){return!this.Hc.Qh&&
this.b2i()}b2i(){const a=bb.a.He(w.AFrameworkApplication.lcid);return!a||ma.a.Xa(a.name)?!1:a.name.toLowerCase()===this.Hc.Fpa}static get aoe(){var a=pi.a.get("PPTCaptionDiscoverabilityLastShownTime");if(!a)return!1;const b=new Date;a=new Date(decodeURIComponent(a));return 14>(+b-+a)/864E5}static set aoe(a){pi.a.oK("PPTCaptionDiscoverabilityLastShownTime",(new Date).toUTCString(),pi.a.XJ)||xa.a.J(509138199,822,10,"Failed to set cookie for discoverability last shown time to {0}",a.toString())}static get $3d(){const a=
pi.a.get("PPTCaptionDiscoverabiltyDoNotShowAgain");return a?"true"===a.toLowerCase():!1}static set $3d(a){pi.a.oK("PPTCaptionDiscoverabiltyDoNotShowAgain",a.toString(),pi.a.XJ)||xa.a.J(509138198,822,10,"Failed to set cookie for discoverability opt out to {0}",a.toString())}}Object(m.a)(Vv,"CaptionDiscoverabilityPaneActor",null,[251]);var NM=d(744);class ut{constructor(a,b){this.id=a;this.version=b}}Object(m.a)(ut,"PackageAccessKey",null,[]);const Wv=a=>a?De.c({["I"]:a.id,["V"]:a.version}):null;var Lp=
d(338),OM=d(972);class $x extends OM.a{constructor(a,b,c){super(a,b);this.cba=c}}Object(m.a)($x,"ClipServiceShapeCopyParams",OM.a,[]);var wE=d(688),xE=d(726),yE=d(450);class ay{constructor(a,b,c){this.ia=a;this.Fa=b;this.wIa=c}xQ(a){a=ay.x7b(a);return this.wIa.oac(this.Fa)&&!!a&&!!a.src}paste(a){w.AFrameworkApplication.ZQ?yE.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):this.ia.Ka(ea.a.Znc,2,a)}static x7b(a){if(!a||!a.hn)return xa.a.J(558445148,826,15,"ImagePasteHandler: User attempted to paste null content."),
null;a=a.hn.getElementsByTagName(rb.a.n4);if(!a.length)return null;a=a[0];return a.src?a:null}}Object(m.a)(ay,"ImagePasteHandler",null,[525]);var qm=d(439);class zE{constructor(){this.Ihh=this.k4d=null}}Object(m.a)(zE,"PasteSlideAsImageData",null,[]);class AE{constructor(){this.pastedContent=this.fya=null}}Object(m.a)(AE,"PasteSlideAsImageFromRibbonData",null,[]);var BE=d(693);class CE extends Sys.EventArgs{constructor(a,b,c){super();this.Jp=a;this.Jxi=b;this.Kxi=c}}Object(m.a)(CE,"UpdateCcpInfoEventArgs",
Sys.EventArgs,[]);class PM{constructor(){this.ShapeId=this.Cid=this.Sid=0}}Object(m.a)(PM,"CopiedShape",null,[]);class QM{constructor(){this.Cid=this.Sid=0}}Object(m.a)(QM,"CopiedSlide",null,[]);class DE extends Ig.a{constructor(){super();this.Shapes=this.Slides=this.Location=this.CcpId=null;this.MultiSlideCopy=!1;this.PackageAccessKey=this.CcpCorrelation=null}pl(){return 65}}Object(m.a)(DE,"CopyRequest",Ig.a,[]);class by{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye,Xd,Xf,
ug,qg,Fg,qf){this.eCe=this.swa=null;this.ia=a;this.yO=f;this.Fa=l;this.$b=y;this.ta=H;this.Eb=Q;this.oM=tc;this.ai=ia;this.Tb=wa;this.Mx=Ua;this.iHa=kb;this.Gb=Gb;this.hj=ec;this.la=b;this.pa=dc;this.qzg=Fc;this.Emk=xd;this.De=yc;this.Sb=Vd;this.Fmk=Ld;this.Ks=ye;this.QDe=this.la.Wqg;this.gFe=this.la.nsh;this.Js=Xd;this.Ec=Xf;this.EA=ug;this.Uv=qg;this.kOg=Fg;this.yH=qf;if(!this.EA)throw xa.a.J(512356641,826,10,"ClipServiceActor pastemanager is null"),Error.argumentNull("ClipServiceActor pastemanager is null");
}vb(){this.ia.ra(ea.a.e0d,hc.a.application,Object(I.a)(this,this.pAj,"handleCopySlidesToClipService"),0);this.ia.ra(ea.a.eld,hc.a.application,Object(I.a)(this,this.lfe,"handlePasteSlidesFromClipService"),4);this.ia.ra(ea.a.$nc,hc.a.application,Object(I.a)(this,this.kDj,"handlePasteSlideKeepingDestinationThemeFromFloatie"),4);this.ia.ra(ea.a.MJb,hc.a.application,Object(I.a)(this,this.lDj,"handlePasteSlideKeepingSourceFormattingFromFloatie"),4);this.ia.ra(ea.a.kSe,hc.a.application,Object(I.a)(this,
this.Wmd,"queryPasteOptions"),97);this.ia.ra(ea.a.XNf,hc.a.application,Object(I.a)(this,this.oAj,"handleCopyShapesToClipService"),0);this.ia.ra(ea.a.Qeh,hc.a.application,Object(I.a)(this,this.hDj,"handlePasteShapesFromClipService"),4);this.ia.ra(ea.a.Seh,hc.a.application,Object(I.a)(this,this.kfe,"handlePasteSlideFromDesktop"),4);this.ia.ra(ea.a.dld,hc.a.application,Object(I.a)(this,this.iDj,"handlePasteSlideAsImage"),4);this.ia.ra(ea.a.Reh,hc.a.application,Object(I.a)(this,this.jDj,"handlePasteSlideAsImageFromRibbon"),
4);this.ia.ra(ea.a.iRf,hc.a.application,Object(I.a)(this,this.qAj,"handleCutShapes"),4);this.ia.ra(ea.a.g6d,hc.a.application,Object(I.a)(this,this.g6d,"expandPasteFloatieMenu"),96);this.ia.ra(ea.a.jRf,yb.a.application,Object(I.a)(this,this.rAj,"handleCutSlides"),4);this.ia.ra(ea.a.Veh,yb.a.application,Object(I.a)(this,this.aDj,"handlePasteCancelledByUser"),2048)}pe(){}jDj(a,b,c,f,l){xa.a.J(512356640,826,50,"HandlePasteSlideAsImageFromRibbon called");a=Object(qa.a)(AE,l);if(!a||!a.fya)return xa.a.J(512356639,
826,10,"HandlePasteSlideAsImageFromRibbon pasteSlideAsImageFromRibbonData is invalid"),8;if(1===c)return 32;c=a.fya.Wb;b=this.Ec.uP(2,1,"HandlePasteSlideAsImageFromRibbon");this.Ec.ji("PasteSlideAsImageFromRibbon",c,b);a.fya.Wb=b;this.EA.paste(a.fya,a.pastedContent,!0);return 32}iDj(a,b,c,f,l){a=Object(qa.a)(zE,l);if(!a||!a.k4d)return xa.a.J(512356638,826,10,"HandlePasteSlideAsImage PasteSlideAsImageData is null"),8;if(1===c)return 32;this.EA.dld(a.k4d,a.Ihh);return 32}g6d(a,b,c){if(1===c)return 32;
this.Emk.QXk();return 32}Wmd(a,b,c,f,l){if(!this.Ks||!this.Ks.Kib)return 8;a=this.Ks.Kib.UA;l.SourceControlId&&("PasteSlideKeepDestinationFromClipService"===l.SourceControlId?l[wh.a.On]=null!=a&&!a:"PasteSlideKeepSourceFromClipService"===l.SourceControlId&&(l[wh.a.On]=null!=a&&a));return 32}lDj(a,b,c,f){if(1===c)return 32;const l=this.Ks.Kib;if(!l)return 8;const y=l.Ku,H=l.VM;if(!y&&!H)return 8;if(null!=l.UA&&l.UA)return 32;l.Wb=this.Ec.uP(2,2,"HandlePasteSlideKeepingSourceFormattingFromFloatie");
l.UA=!0;const Q=this.Sb.gA(this.Ks.pOe);xa.a.J(512356637,307,50,"HandlePasteSlideKeepingSourceFormattingFromFloatie - KeepSource set to true");if(H)return H.skipUndo=!0,H.selectionSlide=Q,this.kfe(a,b,c,f,l);y.skipUndo=!0;y.selectionSlide=Q;return this.lfe(a,b,c,f,l)}kDj(a,b,c,f){if(1===c)return 32;const l=this.Ks.Kib;if(!l)return 8;const y=l.Ku,H=l.VM;if(!y&&!H)return 8;if(null!=l.UA&&!l.UA)return 32;l.Wb=this.Ec.uP(2,2,"HandlePasteSlideKeepingDestinationThemeFromFloatie");l.UA=!1;const Q=this.Sb.gA(this.Ks.pOe);
xa.a.J(512356636,307,50,"HandlePasteSlideKeepingDestinationThemeFromFloatie - KeepSource set to false");if(H)return H.skipUndo=!0,H.selectionSlide=Q,this.kfe(a,b,c,f,l);y.skipUndo=!0;y.selectionSlide=Q;return this.lfe(a,b,c,f,l)}oAj(a,b,c,f,l){a=Object(qa.a)($x,l);if(!a)return xa.a.J(512356635,307,50,"ClipServiceCopyParams are null."),8;b=a.Ku;c=a.cba;if(!b||!c||!c.length)return xa.a.J(512356634,307,50,"Copied shapes are empty."),this.Ec.Mg(!1,a.Wb,23),8;if(this.$b.EVa())return this.Ec.Mg(!1,a.Wb,
2),16;if(Yb.a.any(c,H=>H.u4))return xa.a.J(512356633,826,15,"HandleCopyShapesToClipService: deferred content detected."),8;f=[];for(var y of c)f.push(Object.assign(new PM,{Sid:y.slideSid,Cid:y.slideCid,ShapeId:y.get_shapeId()}));y=Object.assign(new DE,{CcpId:b.Jp,Location:b.location,Shapes:f,CcpCorrelation:a.Wb,PackageAccessKey:Wv(new ut(a.Ku.Ky,b.version))});this.ORc(y,2,a.Wb);return 32}hDj(a,b,c,f,l){b=Object(qa.a)(qm.a,l);if(!b)return 8;3!==b.Ku.dataType?this.Ec.hC(2,b.Wb):(this.Ec.hC(7,b.Wb),
this.Ec.Yw(5,b.Wb));c=b.Ku;if(!c)return this.Ec.Mg(!1,b.Wb,16),xa.a.J(512356632,307,50,"HandlePasteShapesFromClipService: Cross-session pasted shapes are empty."),8;3!==b.Ku.dataType&&this.Ec.Yw(xE.ClipboardHelper.Gmg(c)?2:3,b.Wb);f=this.ta.Ba;if(!f||!f.isConnected)return this.Ec.Mg(!1,b.Wb,3),xa.a.J(512356631,307,50,"HandlePasteShapesFromClipService: targetSlide: {0}.",f?"not null":"null"),16;if(this.$b.$c(f))return this.Ec.Mg(!1,b.Wb,3),xa.a.J(512356630,307,50,"HandlePasteShapesFromClipService: failed since the targetSlide is blocked."),
2;if(!this.hj.iD(f,c.objectCount))return this.Ec.Mg(!1,b.Wb,8),xa.a.J(512356629,307,50,"HandlePasteShapesFromClipService: failed since there are too many shapes on the target slide."),this.hj.KD(f),16;this.VRd(c.Jp,b.Wb);Nc.a.gAa("PasteShapesFromClipService",!0);Nc.a.AP(!1,!1);this.eCe&&this.eCe===c.Jp||(this.swa=new Jd.a(0));f.IN=c.Jp;f.mQ=c.location;f.t3=c.QD;f.j_=by.u6e(c.rta);f.Ky=Wv(new ut(c.Ky,c.version));l=null;this.Ec.Ybc(b.Wb)&&(l=ay.x7b(b));if(this.gFe&&3===b.Ku.dataType)try{let y=0;this.swa&&
this.swa.Fb(f.Db)&&(y=this.swa.ga(f.Db));this.$b.iWd(f,a,y);xa.a.J(512356628,307,50,"HandlePasteShapesFromClipService: shimmer view successful")}catch(y){xa.a.J(512356627,307,10,"HandlePasteShapesFromClipService: failed to show shimmer view")}this.iHa.XPi(f,c,this.swa,a,b.Wb,l);this.eCe=c.Jp;this.Ec.Mg(!0,b.Wb);return 32}qAj(a,b,c,f,l){if(this.$b.EVa())return 16;if(1===c)return 32;Nc.a.AP(!0,!0);const y=this.pa.Qf();b=this.pa.hk();var H=f=c=null;let Q=[];l=Object(qa.a)($x,l);if(!l)return 8;if(l.Ku){var ia=
l.Ku;Q=l.cba;if(!Q||!Q.length)return 8;c=ia.Jp;H=ia.version;f=ia.location;H=Wv(new ut(ia.Ky,H))}else for(ia of y)ia.e3c&&Q.push(ia);for(var wa of Q)if(wa.Of||wa.Ug){Dn(wa);break}wa=this.Eb.xd(15,void 0,()=>{this.pa.nh()});try{wa.hc(b),wa.fd=a,this.qzg.Zkh(new CE(c,f,H)),b.Wb=l.Wb,b.YR(Q)}finally{wa&&wa.dispose()}for(const Ua of Q)this.Js.Hkh(new kK.a(Ua));this.yO.gre=c;return 32}rAj(a,b,c,f,l){b=this.pa.Se();if(!b||!b.length||!this.ta.Ba)return 16;for(var y of b)if(!y||this.$b.$c(y)||!y.isConnected)return 16;
if(1===c)return 32;Nc.a.Kb&&(Nc.a.Kb.actionName="CutSlide",Nc.a.Kb.vr=!1,Nc.a.Kb.Oj=!0,Nc.a.Kb.FF=new Date,Nc.a.Kb.Wa("SlideCount",b.length.toString()));f=y=c=null;var H=[];l=Object(qa.a)(wE.a,l);if(!l)return 8;if(l.Ku){f=l.Ku;H=l.yDh;if(!H||!H.length)return 8;c=f.Jp;H=f.version;y=f.location;f=Wv(new ut(f.Ky,H))}H=this.Tb.Ef;if(!H)return 16;const Q=this.Eb.xd(15,void 0,()=>{this.pa.nh()});try{this.qzg.Zkh(new CE(c,y,f));Q.hc(H);for(const ia of b)ia&&!ia.Db.equals(this.ta.Ba.Db)&&H.NI(ia);H.NI(this.ta.Ba);
Q.fd=a;H.Wb=l.Wb}finally{Q&&Q.dispose()}this.la.unblockContentWhenDeletingSlideEnabled||this.$b.rw(H,a);this.Js?this.Js.eod(new BE.a(b)):xa.a.J(512356626,826,10,"HandleCutSlides: graphOperationEventNotifier is null for raising event.");this.yO.gre=c;return 32}ORc(a,b){this.yO.WAk(a);var c=[String.format("{0}={1}","CcpId",a.CcpId),String.format("{0}={1}",Lp.a.type,NM.a(b))];Nc.a.Ak("CcpId",a.CcpId);c=new th.a(a,()=>{this.cCk(a)},f=>this.bCk(f,a,b),f=>0===f.StatusCode,void 0,c);xa.a.J(512356625,307,
50,String.format("Created task: {0} for ccpid: {1}",c.id,a.CcpId));this.ai.Hb(c)}cCk(a){this.yO.p7g(!0,a)}bCk(a,b,c){xa.a.J(512356624,307,10,String.format("Failed to copy {0} for ccpid: {1} with statuscode: {2}.",NM.a(c),b.CcpId,a.StatusCode));this.yO.p7g(!1,b);return!0}VRd(a,b){const c=Nc.a.Kb;c&&(c.Wa("CcpId",a),this.Ec.ji("CcpId",a,b))}pAj(a,b,c,f,l){a=Object(qa.a)(wE.a,l);if(!a||!a.Ku)return xa.a.J(512356623,307,50,"HandleCopySlidesToClipService: either copyParams '{0}' or copyParams.ClipServiceObject is null.",
a?"not null":"null"),8;xa.a.J(512356622,307,50,"HandleCopySlidesToClipService: executing for ccpid: {0}",a.Ku.Jp);b=a.yDh;if(!b||!b.length||0>=Ak.e(b,y=>Object(Wa.a)(118,y)).length)return xa.a.J(512356621,307,50,"HandleCopySlidesToClipService: no slide is copied"),8;if(Yb.a.any(b,y=>y.hasDeferredContent))return xa.a.J(512356620,826,15,"HandleCopySlidesToClipService: trying to copy slides with deferred content to clipboard service"),8;b=Object.assign(new DE,{CcpId:a.Ku.Jp,Location:a.Ku.location,MultiSlideCopy:!0,
Slides:Ak.c(b,y=>Object.assign(new QM,{Sid:y.sid,Cid:y.cid})),CcpCorrelation:a.Wb,PackageAccessKey:Wv(new ut(a.Ku.Ky,a.Ku.version))});this.ORc(b,1,a.Wb);return 32}kfe(a,b,c,f,l){if(1===c)return 32;b=Object(qa.a)(qm.a,l);if(!b)return xa.a.J(512356619,826,10,"HandlePasteSlideFromDesktop: PasteParams is null."),8;c=b.VM;if(!c||ma.a.Xa(c.ccpid)||ma.a.Xa(c.data))return xa.a.J(512356618,826,10,String.format("HandlePasteSlideFromDesktop: Invalid pickling data ccpid: {0}",c?c.ccpid:"null")),this.Ec.Mg(!1,
b.Wb,28),8;Nc.a.gAa("PasteSlideFromDesktop",!0);this.VRd(c.ccpid,b.Wb);this.Ec.Yw(12,b.Wb);f={};f.CcpCorrId=b.Wb;return this.xfg(b,a,c.skipUndo,c.selectionSlide,c.objectCount,null!=b.UA?b.UA:!0,c.ccpid,null,null,w.AFrameworkApplication.userSessionId,0,f,c.data,c.isDataCompressed)}lfe(a,b,c,f,l){if(1===c)return 32;b=Object(qa.a)(qm.a,l);if(!b)return xa.a.J(51520671,307,10,"HandlePasteSlidesFromClipService: PasteParams is null."),8;Nc.a.gAa("PasteSlidesFromClipService",!0);c=b.Ku;if(!c)return this.Ec.Mg(!1,
b.Wb,16),xa.a.J(512356617,307,10,"HandlePasteSlidesFromClipService: Cross-session pasted slides are empty."),8;this.Ec.Yw(xE.ClipboardHelper.Gmg(c)?2:3,b.Wb);this.VRd(c.Jp,b.Wb);f=this.Mx.Xme(c);return!this.la.Rqg&&f?(this.Ec.Mg(!1,b.Wb,17),xa.a.J(34481168,307,10,"HandlePasteSlidesFromClipService: Don't support cross-dc paste slide: {0}",c),16):this.xfg(b,a,c.skipUndo,c.selectionSlide,c.objectCount,null!=b.UA?b.UA:!0,c.Jp,c.location,c.QD,c.Ky,c.version,c.rta,null,!1)}xfg(a,b,c,f,l,y,H,Q,ia,wa,Ua,
kb,Gb,ec){this.Ec.hC(19,a.Wb);const dc=this.ta.presentation;if(!dc)return this.Ec.Mg(!1,a.Wb,3),xa.a.J(512356616,307,10,"HandlePasteSlide: Failed because presentation node is null"),16;if(this.$b.$c(dc))return this.Ec.Mg(!1,a.Wb,3),xa.a.J(512356615,307,10,"HandlePasteSlide: Can't continue because the presentation was being blocked."),2;var Fc=this.ta.Ba;if(Fc&&!Fc.isConnected)return this.Ec.Mg(!1,a.Wb,3),xa.a.J(512356614,307,10,"HandlePasteSlide: Failed since the selected slide is disconnected."),
16;xa.a.J(512356613,307,50,String.format("HandlePasteSlide skipUndo: {0} and keepSource value is: {1}",c.toString(),y.toString()));this.QDe&&!this.Mx.omg(a)&&this.Fmk.Idi();this.Ks.f4c=Date.now();this.oM.eX(this.Sb.tn)&&xa.a.J(512356612,307,50,"cross session paste slide happened before last action server result is not returned");Nc.a.AP(!1,!1);let yc;var tc=null;Fc=this.la.Eud&&!ma.a.Xa(Gb)&&1!==this.Gb.ol;if(c)tc=f,yc=null;else{tc=this.ta.presentation;if(!tc)throw Error.argumentNull("Presentation is null");
yc=Array.isArray(tc.iQf(l,a.Wb,Fc))?tc.iQf(l,a.Wb,Fc):null;f=tc=this.Enj();this.Ks.position=null;this.Ks.pOe=tc?tc.slideIndex:0}l=null;c||(l=()=>{let xd;(xd=this.pa).rP.apply(xd,yc)});l=this.Eb.xd(15,void 0,()=>{this.Fa.vf(jb.a.lF)},l);try{if(l.hc(dc),l.fd=c?dc.Wcb?ea.a.MJb:ea.a.$nc:b,Fc?(dc.Oua=!0,this.Uv.init(H)):(dc.IN=H,dc.Wcb=y,dc.nOe=tc?tc.Db:null,dc.mQ=Q,dc.t3=ia,dc.j_=by.u6e(kb),dc.skipUndo=c,dc.Ky=Wv(new ut(wa,Ua)),dc.rBb=null==ec?!1:ec,dc.aoc=Gb,dc.Wb=a.Wb),!c){Q=tc;for(ia=0;ia<yc.length;ia++)this.la.Un?
dc.Ibb(yc[ia],Q,null,!0):dc.Ibb(yc[ia],Q,null),Q=yc[ia],Fc&&(yc[ia].Oua=!0,this.Uv.bla.add(yc[ia].id));this.Tb.Ba=yc[yc.length-1];this.De.N9a=!0}}finally{l&&l.dispose()}Fc?(this.Uv.Wxd(!0),this.$b.blockContent(dc,b)):this.$b.rw(dc,b);this.Ks.Kib=a;this.Ks.DOb=!0;this.Ks.nKa=null;this.De.N9a=!0;this.Ks.P3b=this.Sb.tn.rK;Fc&&(this.Ec.ji("DisplayNewPasteProgressUX","true",a.Wb),this.$Qi(Gb,w.AFrameworkApplication.userSessionId,tc,c,y,H,kb,ec,a.Wb));this.Ec.Mg(!0,a.Wb);return 32}$Qi(a,b,c,f,l,y,H,Q,ia){const wa=
this.Ec.uP(2,0,"DataUploadInit");this.Ec.Yw(13,wa);this.Ec.hC(19,wa);this.Ec.ji("DataUploadInitOldCcpCorrId",ia,wa);this.Uv.nNl(wa);const Ua=(new Date).getTime();this.kOg.hBl(a,b,y,()=>{const kb=(new Date).getTime()-Ua;xa.a.J(512356611,826,50,"DataUploadInit: Upload pasted data successful for ccpid: {0} time: {1}",y,kb);this.Ec.ji("DataUploadTime",kb.toString(),wa);this.ZQi(wa,b,c,f,l,y,H,Q)},kb=>{xa.a.J(512356610,826,10,"DataUploadInit: Upload pasted data failed for ccpid: {0}, error:{1} time: {2}",
y,te.a[kb.error.Code],(new Date).getTime()-Ua);this.sAj();this.Ec.Mg(!1,wa,30)})}ZQi(a,b,c,f,l,y,H,Q){const ia=this.ta.presentation;if(ia){this.Uv.Yyk();Nc.a.AP(!1,!1);xa.a.J(512356608,307,50,"DataUploadFinish: FakeSlideIds: {0}",this.Uv.bla.toArray().join(",").toString());var wa=this.Eb.xd(15);try{wa.hc(ia),wa.fd=ea.a.MJb,ia.nOe=c?c.Db:null,ia.N1b=b,ia.boc=this.Uv.bla.toArray().join(",").toString(),ia.IN=y,ia.j_=by.u6e(H),ia.skipUndo=f,ia.rBb=null==Q?!1:Q,ia.Wcb=l,ia.Wb=a}finally{wa&&wa.dispose()}this.Ec.Mg(!0,
a)}else xa.a.J(512356609,307,10,"DataUploadFinish: Failed because presentation node is null")}aDj(a,b,c,f,l){if(1===c)return 32;if(!(l&&"UploadId"in l&&"CcpCorrId"in l))return xa.a.J(512356579,307,10,"HandlePasteCancelledByUser: actionDataDictionary invalid {0}",l),8;a=l.UploadId;l=l.CcpCorrId;xa.a.J(512356578,307,50,"HandlePasteCancelledByUser: uploadId: {0}",a);this.kOg.txi(a);this.Ec.Mg(!1,l,31);return 32}sAj(){this.Uv.tIf(!0);this.yH.fba(ResourceStrings.l_SomethingWentWrongCalloutTitle,ResourceStrings.errorTitle_PasteSlideFailed,
!1,null,!1,null,0,0,null,null,!0,20,!1,null)}tzl(a){a.sort((b,c)=>c.slideIndex-b.slideIndex)}Enj(){const a=this.pa.Se();return 0<a.length&&(this.tzl(a),a[0])?a[0]:this.ta.Ba}static u6e(a){return JSON.stringify(a)}}Object(m.a)(by,"ClipServiceActor",null,[251]);class EE{constructor(){this.actionId=0;this.context=null;this.behavior=0;this.zd=this.kK=null}}Object(m.a)(EE,"AActionArgs",null,[]);class FE extends EE{constructor(){super()}}Object(m.a)(FE,"ActionArgs$2",EE,[]);class GE extends FE{constructor(){super()}}
Object(m.a)(GE,"ActionArgs$1",FE,[]);var Mq=d(398),zu=d(391);class vt{constructor(a,b=!1){this.Ymg=!0;this.Wb=null;this.dataType=0;this.r2i=a;this.sea=b}}Object(m.a)(vt,"CutCopyParams",null,[]);var Xv=d(449),RM=d(448);class Zz{constructor(a,b,c,f){this.ia=a;this.Nkk=f;this.wIa=c;this.Fa=b}xQ(a){return this.wIa.oac(this.Fa)&&!!Zz.c7f(a)}paste(a){this.Nkk?yE.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):(xa.a.J(17310402,826,50,"TablePasteHandler: Execute command to paste table from clipboard."),
this.ia.Ka(ea.a.gya,2,a))}static c7f(a){return a&&a.hn?(a=a.hn.getElementsByTagName(rb.a.Bmb))&&a.length?a[0]:null:null}}Object(m.a)(Zz,"TablePasteHandler",null,[525]);class Wk{static get YA(){return Ib.a.instance.qb("PowerPointWebEditor.ISystemClipboard")}}Object(m.a)(Wk,"SystemClipboardFactory",null,[]);class SM{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye,Xd,Xf,ug,qg,Fg,qf,bg,Kg,rg,ui,Ik){this.swa=this.S$c=null;this.ACg=0;this.H$c=!1;this.wEj=(vg,Lg,rh,Bm,xj)=>{if(1===
rh)return 32;vg=this.iY.vH;xj&&xj.SourceControlId&&("PasteAsPlainText"==xj.SourceControlId?xj[wh.a.On]=vg===C.a.j6||vg===C.a.r0a||vg===ea.a.pasteAsPlainText:"PasteTextKeepingSourceFormatting"==xj.SourceControlId?xj[wh.a.On]=vg===C.a.t8||vg===C.a.paste||vg===C.a.reformatPastedContent||vg===ea.a.zoa:this.la.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled")&&"PasteTextMergeFormatting"==xj.SourceControlId&&(xj[wh.a.On]=vg===C.a.JLb||vg===ea.a.hya));return 32};this.rDj=(vg,Lg,rh)=>{if(2==rh){vg=
this.iY.vH;if(vg===C.a.j6||vg===C.a.r0a)return 32;this.ia.processAction(C.a.r0a,rh)}return 32};this.pDj=(vg,Lg,rh)=>{if(2==rh){vg=this.iY.vH;if(vg===C.a.t8||vg===C.a.paste||vg===C.a.reformatPastedContent)return 32;this.ia.processAction(C.a.reformatPastedContent,rh)}return 32};this.AEj=(vg,Lg,rh)=>{if(1==rh||this.iY.vH===ea.a.pasteAsPlainText)return 32;this.NSd(vg);this.Ts.undo();return 32};this.CEj=(vg,Lg,rh)=>{if(1==rh||this.iY.vH===ea.a.zoa)return 32;this.NSd(vg);this.Ts.undo();return 32};this.BEj=
(vg,Lg,rh)=>{if(1==rh||this.iY.vH===ea.a.hya)return 32;this.NSd(vg);this.Ts.undo();return 32};this.qDj=(vg,Lg,rh)=>{if(1==rh)return 32;if(2==rh){if(this.iY.vH===C.a.JLb)return 32;this.ia.processAction(C.a.JLb,rh)}return 32};this.Vth=(vg,Lg)=>{vg=Lg.node;null!=vg&&vg==this.hFb&&(this.hFb=vg,this.zLg=Lg.revisionId.toString())};this.euh=(vg,Lg)=>{Lg&&Lg.revisionId&&(this.lFb=Lg.revisionId.toString())};this.TJh=(vg,Lg)=>{Lg.FD&&Lg.FD.Id&&Lg.FD.Id==this.lFb&&(this.jXa.v4(this.Tb.Ef)||setTimeout(()=>{this.ia.processAction(ea.a.pasteAsPlainText,
2);this.nVe(ea.a.Dqc);this.lFb=null},0))};this.UJh=(vg,Lg)=>{Lg.FD&&Lg.FD.Id&&Lg.FD.Id==this.lFb&&(this.jXa.v4(this.Tb.Ef)||setTimeout(()=>{this.ia.processAction(ea.a.zoa,2);this.nVe(ea.a.Fqc);this.lFb=null},0))};this.SJh=(vg,Lg)=>{Lg.FD&&Lg.FD.Id&&Lg.FD.Id==this.lFb&&(this.jXa.v4(this.Tb.Ef)||setTimeout(()=>{this.ia.processAction(ea.a.hya,2);this.nVe(ea.a.Eqc);this.lFb=null},0))};this.C4g=(vg,Lg)=>{Lg.FD&&Lg.FD.Id&&this.zLg==Lg.FD.Id&&(null==this.hFb||this.jXa.v4(this.hFb)||setTimeout(()=>{this.ia.processAction(ea.a.T7a,
2);if(this.iY.Sua){const rh=new ij.a;rh.Ttc=!0;this.UFb.BLb(rh)}else this.UFb.xTe(new Cg(1,w.AFrameworkApplication.isRtl));this.m6k();this.zLg=this.hFb=null},0))};if(!Fg)throw Error.argumentNull("DeferredContentManager");if(Q.ka("IsPasteTextFloatieEnabled")){if(!bg)throw Error.argumentNull("pasteFloatieEventSource");if(!Kg)throw Error.argumentNull("coldHotManager");if(!rg)throw Error.argumentNull("shapeGraphNodeEventHandlers");if(!ui)throw Error.argumentNull("graphOperationEventHandler");if(!Ik)throw Error.argumentNull("undoManager");
}this.ia=a;this.Fa=b;this.pa=c;this.Zg=Gb;this.$b=wa;this.Bma=Ua;this.EA=kb;this.Tb=f;this.oq=l;this.Jw=Fg;this.Eb=y;this.tA=H;this.Qq=ia;this.iHa=ec;this.Sb=dc;this.xk=Fc;this.Gb=yc;this.wBg=tc;this.Mdb=xd;this.hj=Vd;this.gR=Ld;this.VXa=Xd;this.wb=Xf;this.u$=ug;this.Ec=qg;this.la=Q;this.iY=qf;this.UFb=bg;this.jXa=Kg;this.Ojc=rg;this.Rf=ui;this.Ts=Ik}vb(){this.la.t0c?(this.ia.ra(ea.a.Ovb,hc.a.application,Object(I.a)(this,this.Ieg,"handleCutCopyToSystemClipboardAsync"),4),this.ia.ra(ea.a.X2b,hc.a.application,
Object(I.a)(this,this.Ieg,"handleCutCopyToSystemClipboardAsync"),0),this.ia.ra(ea.a.zoa,hc.a.application,Object(I.a)(this,this.ozb,"handlePasteFromSystemClipboardAsync"),4),this.ia.ra(ea.a.jKa,hc.a.application,Object(I.a)(this,this.ozb,"handlePasteFromSystemClipboardAsync"),4),this.ia.ra(ea.a.kKa,hc.a.application,Object(I.a)(this,this.ozb,"handlePasteFromSystemClipboardAsync"),4),this.ia.ra(ea.a.B_a,hc.a.application,Object(I.a)(this,this.ozb,"handlePasteFromSystemClipboardAsync"),4),this.la.ka("IsPasteTextFloatieEnabled")&&
(this.ia.ra(ea.a.pasteAsPlainText,hc.a.application,Object(I.a)(this,this.ozb,"handlePasteFromSystemClipboardAsync"),4),this.la.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled")&&this.ia.ra(ea.a.hya,hc.a.application,Object(I.a)(this,this.ozb,"handlePasteFromSystemClipboardAsync"),4))):(this.ia.ra(ea.a.Ovb,hc.a.application,Object(I.a)(this,this.Heg,"handleCutCopyToSystemClipboard"),4),this.ia.ra(ea.a.X2b,hc.a.application,Object(I.a)(this,this.Heg,"handleCutCopyToSystemClipboard"),0),this.ia.ra(ea.a.zoa,
hc.a.application,Object(I.a)(this,this.nzb,"handlePasteFromSystemClipboard"),4),this.ia.ra(ea.a.jKa,hc.a.application,Object(I.a)(this,this.nzb,"handlePasteFromSystemClipboard"),4),this.ia.ra(ea.a.kKa,hc.a.application,Object(I.a)(this,this.nzb,"handlePasteFromSystemClipboard"),4),this.ia.ra(ea.a.B_a,hc.a.application,Object(I.a)(this,this.nzb,"handlePasteFromSystemClipboard"),4),this.la.ka("IsPasteTextFloatieEnabled")&&(this.ia.ra(ea.a.pasteAsPlainText,hc.a.application,Object(I.a)(this,this.nzb,"handlePasteFromSystemClipboard"),
4),this.la.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled")&&this.ia.ra(ea.a.hya,hc.a.application,Object(I.a)(this,this.nzb,"handlePasteFromSystemClipboard"),4)));this.ia.ra(ea.a.WNf,hc.a.application,Object(I.a)(this,this.nAj,"handleCopyShapes"),0);this.ia.ra(ea.a.ald,yb.a.application,Object(I.a)(this,this.gDj,"handlePasteShapes"),4);this.ia.ra(ea.a.Znc,hc.a.application,Object(I.a)(this,this.fDj,"handlePastePicture"),4);this.ia.ra(ea.a.gya,yb.a.application,Object(I.a)(this,this.nDj,"handlePasteTable"),
4);this.ia.ra(ea.a.bld,hc.a.application,Object(I.a)(this,this.mDj,"handlePasteSlides"),4);this.ia.ra(ea.a.sOe,hc.a.application,Object(I.a)(this,this.oDj,"handlePasteTextIntoNewShape"),4);this.ia.YS(ea.a.zgh,hc.a.application,Object(I.a)(this,this.Lzj,"handleBrowserCut"),4);this.ia.YS(ea.a.Sld,hc.a.application,Object(I.a)(this,this.Kzj,"handleBrowserCopy"),0);this.ia.YS(ea.a.Tld,hc.a.application,Object(I.a)(this,this.Mzj,"handleBrowserPaste"),4);this.ia.YS(ea.a.Jgh,hc.a.application,Object(I.a)(this,
this.dDj,"handlePasteGivenText"),4);this.ia.ra(ea.a.Ceh,hc.a.application,Object(I.a)(this,this.cDj,"handlePasteContentFromPandora"),4);this.ia.ra(ea.a.eya,yb.a.application,Object(I.a)(this,this.handlePasteHtml,"handlePasteHtml"),4);this.ia.ra(ea.a.Zkd,yb.a.application,Object(I.a)(this,this.eDj,"handlePasteHtmlAsync"),4);this.ia.ra(ea.a.c0d,ie.a.frame,Object(I.a)(this,this.bDj,"handlePasteChartAsImage"),4);this.ia.ya(ea.a.n2d,ie.a.frame,Object(I.a)(this,this.Geg,"handleCutCopyThroughShortcuts"));this.ia.ya(ea.a.ZNf,
ie.a.frame,Object(I.a)(this,this.Geg,"handleCutCopyThroughShortcuts"));this.ia.ra(ea.a.Ueh,ie.a.frame,Object(I.a)(this,this.sDj,"handlePasteThroughShortcuts"),4);this.la.ka("IsPasteTextFloatieEnabled")&&(this.ia.ra(ea.a.fld,ie.a.frame,this.pDj,4),this.ia.ra(ea.a.hld,ie.a.frame,this.rDj,4),this.ia.ra(ea.a.Jnd,ie.a.frame,this.wEj,4),this.ia.ra(ea.a.Dqc,hc.a.application,this.AEj,4),this.ia.ra(ea.a.Fqc,hc.a.application,this.CEj,4),this.la.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled")&&(this.ia.ra(ea.a.gld,
hc.a.application,this.qDj,4),this.ia.ra(ea.a.Eqc,hc.a.application,this.BEj,4)))}pe(){if(eb.a("ShortcutsFixInMac")&&z.a.bcc){const a=[this.Fa.Fc(Oi.a.iE),this.Fa.Fc(jb.a.vg)];for(const b of a)b.bindAction(x.KeyInputManager.Qa(B.a.tAa,x.KeyInputManager.Re),ea.a.ZNf),b.bindAction(x.KeyInputManager.Qa(B.a.n3a,x.KeyInputManager.Re),ea.a.Ueh)}}Geg(a){a=ea.a.n2d===a;const b=this.Ec.uP(a?1:0,0,a?"OnBrowserCut":"OnBrowserCopy");this.Bma.fta(Object.assign(new vt(!1,a),{Wb:b}));return 32}sDj(){const a=this.Ec.uP(2,
0,"OnBrowserPaste");this.EA.paste(Object.assign(new qm.a(!0),{Wb:a}),null,!1);return 32}Ieg(a,b,c,f){let l,y;if(!({GF:l,hPc:y}=this.qNf(c,a)).returnValue)return l;if(!Wk.YA)return this.Ec.Mg(!1,y.Wb,1),8;this.Cda(a,b,c,f,!0,y.Wb);return 32}ozb(a,b,c,f){if(1===c)return this.pa.zVa()?2:a===ea.a.jKa?2:a===ea.a.kKa?this.Glb(!1):a===ea.a.B_a?this.Glb(!0):a===ea.a.pasteAsPlainText?this.Glb(!1,!0):32;const l=this.Ec.uP(2,1,"HandlePasteFromSystemClipboardAsync");if(this.pa.D9())return this.Ec.Mg(!1,l,3),
16;if(!Wk.YA)return this.Ec.Mg(!1,l,1),8;this.Cda(a,b,c,f,!1,l);Nc.a.AP(!0,!1);return 32}Glb(a,b=!1){xa.a.J(512356577,826,50,"ShouldEnablePasteAsOptions called");return this.pa.S_()?(xa.a.J(512356576,826,15,"ShouldEnablePasteAsOptions: inside textbox hence disabled"),2):this.EA.yyi(a,b)?32:2}IUf(a,b){a===ea.a.Ovb?this.Bma.fta(Object.assign(new vt(!1,!0),{Wb:b})):a===ea.a.X2b?this.Bma.fta(Object.assign(new vt(!1),{Wb:b})):a===ea.a.zoa?this.EA.paste(Object.assign(new qm.a(!1),{Wb:b}),null,!1):a===ea.a.jKa?
this.EA.paste(Object.assign(new qm.a(!1),{Wb:b,UA:!1}),null,!1):a===ea.a.kKa?this.EA.paste(Object.assign(new qm.a(!1),{Wb:b,UA:!0}),null,!1):a===ea.a.B_a?this.EA.paste(Object.assign(new qm.a(!1),{Wb:b,c$a:!0}),null,!1):a===ea.a.pasteAsPlainText?this.EA.paste(Object.assign(new qm.a(!1),{Wb:b,O5b:!0}),null,!1):a===ea.a.hya?(a=new qm.a(!1),a.Wb=b,a.P5b=!0,this.EA.paste(a,null,!1)):(xa.a.J(512356575,826,50,"Only Copy or Paste command are accepted."),this.Ec.Mg(!1,b,5))}Cda(a,b,c,f,l,y){Wk.YA.Cda(l);l=
Wk.YA.u6;null!=l&&l?this.IUf(a,y):(a=new Lh.a(null,Object(I.a)(this,this.H$e,"waitingForEnsureAccessOperationResult"),Object.assign(new GE,{actionId:a,context:b,behavior:c,kK:f,zd:y})),a.$l("ClipboardPreProcess"),this.ACg=Date.now(),a.run())}H$e(a,b){a=!0;let c=!1;const f=b.zd.toString(),l=Wk.YA.u6,y=Wk.YA.ty;null!=l?(a=!1,l?this.IUf(b.actionId,f):c=!0):Date.now()-this.ACg>this.la.SJf&&null!=y&&(xa.a.J(512356574,826,15,"Timeout while trying to execute SystemClipboardAccessManager.EnsureSystemClipboardAccess method."),
a=!1,c=!0);c&&this.Ec.Mg(!1,f,29);return a}Heg(a,b,c){if(!({GF:a,hPc:b}=this.qNf(c,a)).returnValue)return a;this.Bma.fta(b);return 32}qNf(a,b){let c;c=32;const f=ea.a.Ovb===b;b=new vt(!1,f);const l=!!this.Bma&&this.Bma.xQ(b);if(1===a)return c=this.pa.zVa()?2:l?32:16,{returnValue:!1,GF:c,hPc:b};a=this.Ec.uP(f?1:0,1,"HandleCutCopyToSystemClipboard");this.Ec.Yw(1,a);b.Wb=a;return!l||this.$b.EVa()?(this.Ec.Mg(!1,a,2),{returnValue:!1,GF:16,hPc:b}):{returnValue:!0,GF:c,hPc:b}}nzb(a,b,c){if(1===c)return this.pa.zVa()?
2:a===ea.a.jKa?this.Glb(!1):a===ea.a.kKa?this.Glb(!1):a===ea.a.B_a?this.Glb(!0):a===ea.a.pasteAsPlainText?this.Glb(!1,!0):32;b=this.Ec.uP(2,1,"HandlePasteFromSystemClipboard");c=this.oq.Ba;if(!c||this.$b.$c(c)||this.pa.D9())return this.Ec.Mg(!1,b,3),16;c=null;let f=!1,l=!1,y=!1;a===ea.a.jKa?c=!1:a===ea.a.kKa?c=!0:a===ea.a.B_a?f=!0:a===ea.a.pasteAsPlainText?l=!0:a===ea.a.hya&&(y=!0);this.EA.paste(Object.assign(new qm.a(!1),{Wb:b,UA:c,c$a:f,O5b:l,P5b:y}),null,!1);return 32}nAj(a,b,c){if(this.$b.EVa())return 16;
if(1===c)return 32;a=this.pa.Qf();for(const f of a)if(f.Of||f.Ug){Dn(f);break}this.QOl(a);return 32}QOl(a){if(!a||!a.length)this.swa=this.S$c=null;else if(!this.S$c||!this.ani(this.S$c,a)){const b=[];for(const c of a)b.push(c);this.swa=new Jd.a(0);this.swa.$(b[0].slideId,1);this.S$c=b}}ani(a,b){if(a.length!==b.length)return!1;for(let c=0;c<b.length;c++)if(a[c]!==b[c])return!1;return!0}Grj(a,b,c,f){let l;l=b?b.zyb(110,75):this.Sb.Rka(c.clientWidth,c.clientHeight);a=this.xk.e1d(a.Db.cid,a.Db.sid,!0,
l._x,l._y,c.width,c.height,a.zs()+1,c.src,c.alt&&c.alt.length?c.alt:"image",f);b&&(a.v8=b.id);return a}fDj(a,b,c,f,l){b=this.oq.Ba;if(!b)return xa.a.J(512356573,826,50,"Active Slide is null"),8;if(1===c)return this.$b.$c(b)?16:32;if(!l)return 16;this.Ec.hC(5,l.Wb);if(!this.hj.iD(b,1))return this.Ec.Mg(!1,l.Wb,8),this.hj.KD(b),16;Nc.a.gAa("PastePicture",!1);f=ay.x7b(l);if(!f||!f.src)return this.Ec.Mg(!1,l.Wb,10),8;if((c=b.C_(this.pa.Xd()))&&this.$b.$c(c))return this.Ec.Mg(!1,l.Wb,3),16;const y=this.Grj(b,
c,f,l.Wb);f=this.Eb.xd(15,void 0,()=>{this.pa.au();this.Fa.Bd()},()=>{this.pa.selectShape(y,!0)});try{f.hc(b),f.fd=a,f.py[Iq.a.L9b]=!0,c&&b.YR([c]),b.jB(y)}finally{f&&f.dispose()}this.Ec.Mg(!0,l.Wb);return 32}fbj(){if(!this.oq.Ba)return null;const a=this.oq.Ba.Uj();for(const b of a)if(b.OLc)return b;return null}nDj(a,b,c,f,l){b=this.oq.Ba;if(!b)return xa.a.J(512356572,826,50,"Active Slide is null"),8;if(1===c)return b&&!this.$b.$c(b)?32:16;if(!l)return 8;this.Ec.hC(6,l.Wb);if(!this.hj.iD(b,1))return this.hj.KD(b),
this.Ec.Mg(!1,l.Wb,8),16;const y=this.fbj();if(y){if(this.$b.$c(y))return this.Ec.Mg(!1,l.Wb,3),16;if(y.lJ)return xa.a.J(512356571,826,50,"Unable to block placeholder because the shape {0} is changing ShapeIds",y.id),this.Ec.Mg(!1,l.Wb,3),32}f=Zz.c7f(l);if(!(f&&f.innerHTML&&f.rows&&f.rows.length&&f.getElementsByTagName(rb.a.Jvd).length))return this.Ec.Mg(!1,l.Wb,24),8;c=document.createElement("div");if(!c)return this.Ec.Mg(!1,l.Wb,24),8;c.appendChild(f.cloneNode(!0));c=c.innerHTML;if(!c||0>=c.length)return this.Ec.Mg(!1,
l.Wb,24),8;xa.a.J(512356570,826,50,"Paste table with {0} rows, table length {1}",f.rows.length,c.length);var H=this.l8f();f=H.x-55;H=H.y-37.5;if(y){b=this.Eb.xd(15,void 0,()=>{this.pa.au();this.pa.nh();this.Fa.Bd()},()=>{this.pa.selectShape(y,!0)});try{b.hc(y),b.fd=a,b.py[Iq.a.M9b]=!0,y.Wb=l.Wb,y.E_a=c}finally{b&&b.dispose()}this.$b.rw(y,a)}else c=b.iNi(f,H,b.zs()+1,c,l.Wb),c.Wb=l.Wb,this.tA.zT([Object(qa.a)(4,c)],Object(qa.a)(118,b),a);this.Ec.Mg(!0,l.Wb);return 32}eDj(a,b,c,f,l){if(1===c)return 32;
b=l?Object(qa.a)(RM.a,l):null;if(!b)return xa.a.J(512356569,826,50,"Html paste context should not be null."),8;c=this.oq.Ba;if(!c)return xa.a.J(512356568,826,50,"Active Slide is null"),8;if(!c||this.$b.$c(c))return this.Ec.Mg(!1,b.Wb,3),16;Nc.a.gAa("PasteHtmlAsync",!0);xa.a.J(512356567,826,50,"Paste html start");return this.NUf(b,c,a)}handlePasteHtml(a,b,c,f,l){if(1===c)return this.pa.zVa()?2:32;const y=l?Object(qa.a)(RM.a,l):null;if(!y)return xa.a.J(512356566,826,50,"Html paste context should not be null"),
8;b=this.oq.Ba;if(!b)return xa.a.J(512356565,826,50,"Active Slide is null"),8;if(!b||this.$b.$c(b))return this.Ec.Mg(!1,y.Wb,3),16;xa.a.J(512356564,826,50,"Paste html start");Nc.a.AP(!1,!1);Nc.a.gAa("PasteHtml",!0);Nc.a.Ak(hh.a.sNk,"Image:"+y.hea.length.toString()+",Table:"+y.r2a.length.toString()+",Text:"+(y.gZ?y.gZ.length.toString():"0"));f=this.pa.Xd();a=Mq.a.arh(0<y.hea.length?!0:!1,!1,0<y.r2a.length?!0:!1,!1,this.la.dAa,a);if(y.COb)return xa.a.J(512356563,826,50,"Will replace text"),this.Ec.hC(1,
y.Wb),a=this.XVi(y,f[0],a),16!==a?this.Ec.Mg(!0,y.Wb):this.Ec.Mg(!1,y.Wb,15),a;xa.a.J(512356562,826,50,"Will paste html into new shapes");if(y.m2c){if(this.la.Pqg){const H=Nc.a.Kb;this.wb.Hb(new dd.a(2,1,0,()=>{Nc.a.NF(H,()=>{this.ia.Ka(ea.a.Zkd,c,y)})},90,"66"));return 64}return this.NUf(y,b,a)}return this.VVi(y,b,f,a)}XVi(a,b,c){if(this.$b.$c(b))return 16;if(a.gZ&&0<a.gZ.length){xa.a.J(512356561,826,50,String.format("ReplaceText: {0}",this.iHa.DXd([b])));if(this.Nsg(a.gZ))return 16;this.$b.rw(b,
c);const f=this.Eb.xd(15);try{b.Wb=a.Wb,f.hc(b),f.fd=c,b.jMb=a.gZ,Object(Wa.a)(1178,f)&&b.id&&(Object(qa.a)(1178,f).py[Iq.a.bfh]=b.id.toString())}finally{f&&f.dispose()}}return 32}VVi(a,b,c,f){const l=[],y=b.zs();var H=this.l8f(),Q=H.x,ia=H.y;H=0;for(var wa=0;wa<a.r2a.length;++wa)H=this.xk.f1d(!0,b.cid,b.sid,!1,Q,ia,110,75,y+1,a.r2a[wa],a.Wb),l.push(H),H=6;Q=a.hea;ia=1===Q.length?0:Mq.a.jT;for(wa=0;wa<Q.length;wa++){const Ua=this.xk.e1d(b.cid,b.sid,!1,ia,ia,Q[wa].width,Q[wa].height,y+1,Q[wa].src,
Q[wa].alt,a.Wb);l.push(Ua);ia+=Mq.a.jT;H=0===H?5:20}if(a.gZ&&0<a.gZ.length)if(xa.a.J(512356560,826,50,String.format("PasteTextIntoNewTextbox: {0}",this.iHa.DXd(c))),!this.Nsg(a.gZ))c=this.xk.g1d(b.cid,b.sid,y+1,a.gZ,a.Wb),l.push(c),H=0===H?1:20;else if(!l.length)return this.Ec.hC(1,a.Wb),this.Ec.Mg(!1,a.Wb,7),16;this.Ec.hC(H,a.Wb);if(0<l.length){if(!this.hj.iD(b,l.length))return this.hj.KD(b),this.Ec.Mg(!1,a.Wb,8),16;1===l.length&&a&&this.la.insertVideoWithPasteEnabled?(c=a.gZ,this.u$.ptg(c)?(this.Ec.hC(8,
a.Wb),xa.a.J(512356559,826,50,String.format("[Insert Online Video]: Inserting online video by paste!")),this.tA.zT(l,b,f),this.u$.dKl(c,Object(I.a)(this,this.zTl,"videoInsertionFail"))):(this.la.ka("IsPasteTextFloatieEnabled")&&1===H&&(this.Lxf(),this.hFb=l[0],a.Gbc?this.iY.vH=ea.a.pasteAsPlainText:this.la.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled")&&a.Hbc?this.iY.vH=ea.a.hya:this.iY.vH=ea.a.zoa),this.tA.zT(l,b,f),this.$b.rw(b,f))):(this.la.ka("IsPasteTextFloatieEnabled")&&1===H&&1===
l.length&&a&&(this.Lxf(),this.hFb=l[0],a.Gbc?this.iY.vH=ea.a.pasteAsPlainText:this.la.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled")&&a.Hbc?this.iY.vH=ea.a.hya:this.iY.vH=ea.a.zoa),this.tA.zT(l,b,f),this.$b.rw(b,f));this.Ec.Mg(!0,a.Wb)}else this.Ec.Mg(!1,a.Wb,9);return 32}Lxf(){this.SAe||(this.Ojc.gja(this.Vth),this.Rf.MQa(this.C4g),this.SAe=!0)}NSd(a){this.H$c||(this.Rf.Uzf(this.euh),a===ea.a.Dqc?this.Rf.MQa(this.TJh):a===ea.a.Fqc?this.Rf.MQa(this.UJh):a===ea.a.Eqc&&this.Rf.MQa(this.SJh),
this.H$c=!0)}nVe(a){this.H$c&&(this.Rf.rph(this.euh),a===ea.a.Dqc?this.Rf.eMb(this.TJh):a===ea.a.Fqc?this.Rf.eMb(this.UJh):a===ea.a.Eqc&&this.Rf.eMb(this.SJh),this.H$c=!1)}m6k(){this.SAe&&(this.Ojc.cMb(this.Vth),this.Rf.eMb(this.C4g),this.SAe=!1)}zTl(){xa.a.J(512356557,826,50,String.format("[Insert Online Video] Failed to insert online video by paste!"))}NUf(a,b,c){this.Ec.hC(5,a.Wb);if(Yb.a.Xa(a.hea))return this.Ec.Mg(!1,a.Wb,10),16;if(!b)return 16;var f=Object(qa.a)(340,b.qc(this.Gb.Na));if(!f)return this.Ec.Mg(!1,
a.Wb,3),8;var l=Nc.a.Kb;l&&(l.actionName="SinglePicturePaste",l.vr=!0,l.Oj=!0,l.Wa("PreloadImageDuration",a.rOe.toString()));l=a.hea[0];const y=b.C_(this.pa.Xd());var H=b.zs();let Q,ia;({V6d:ia,kC:Q}=this.VXa.k_d(y,l.width,l.height));H=this.xk.e1d(b.cid,b.sid,!1,Q.x,Q.y,ia.width,ia.height,H+1,l.src,l.alt,a.Wb);Nc.a.Ak("ImageSrcSize",l.src.length.toString());f=this.VXa.tWd(this.Gb.Md,ia,Q,f.UT);H.ZR=f;y&&(H.v8=y.id);H.isResizable=!0;H.rbc=!0;H.YL=!0;H.FJa=!0;H.Lea=l.src;this.tA.zT([H],b,c,null,y);
this.Ec.Mg(!0,a.Wb);return 32}Nsg(a){return 65535<a.length?(xa.a.J(512356556,826,50,"Exceed text size limit: {0}",a.length),!0):!1}gDj(a,b,c,f,l){b=this.oq.presentation;if(!b)throw Error.argumentNull("Presentation is null");if(1===c)return 32;c=Object(qa.a)(qm.a,l);if(!c)return 8;f=c.aX;if(Yb.a.Xa(f))return this.Ec.Mg(!1,c.Wb,11),8;this.Ec.hC(2,c.Wb);this.Ec.Yw(2,c.Wb);l=this.oq.Ba;if(!l||this.$b.$c(l))return this.Ec.Mg(!1,c.Wb,3),16;Nc.a.gAa("PasteShape",!1);if(!this.hj.iD(l,f.length))return this.hj.KD(l),
this.Ec.Mg(!1,c.Wb,8),16;xa.a.J(512356555,826,50,"Start Handle paste shapes");var y=Yr.b(f,ia=>ia.shapeNode);this.Jw.Jfe(y,"HandlePasteShapes");for(var H of f){if(!H||!H.shapeNode.isConnected)return xa.a.J(512356554,826,50,"Paste deleted shapes"),this.wBg.luc(ResourceStrings.l_CannotPasteDeletedObjectsTitle,String.format(ResourceStrings.l_CannotPasteDeletedObjectsMessage),null),this.Ec.Mg(!1,c.Wb,12),16;if(this.$b.hO(H.shapeNode))return this.Ec.Mg(!1,c.Wb,3),16;if(!H.shapeNode.get_shapeId())return this.Ec.Mg(!1,
c.Wb,12),16}H=[];for(y=0;y<f.length;y++)H.push(f[y].shapeNode);for(var Q of H)if(Q.Of||Q.Ug){Dn(Q);break}Q=Object(qa.a)(118,b.ZC(f[0].shapeNode.slideId));this.iHa.Peh(Q,l,H,this.swa,a,c.Wb);xa.a.J(512356553,826,50,({contentType:a}=this.iHa.EXd(H)).returnValue);this.Ec.hC(a,c.Wb);Nc.a.AP(!0,!0);this.Ec.Mg(!0,c.Wb);return 32}bDj(a,b,c,f,l){(a=Object(qa.a)(qm.a,l))&&this.EA.kNk(a.Wb);return 32}mDj(a,b,c,f,l){if(1===c)return 32;b=Object(qa.a)(qm.a,l);if(!b)return 8;this.Ec.hC(19,b.Wb);this.Ec.Yw(2,b.Wb);
if(Yb.a.Xa(b.aX))return this.Ec.Mg(!1,b.Wb,11),8;Nc.a.gAa("PasteSlide",!0);if(c=Array.isArray(b.aX)?b.aX:null){let H=0;c.forEach(Q=>{Q.gd&&Q.gd.hasDeferredContent&&H++});0<H&&xa.a.J(512356552,843,50,"HandlePasteSlides total: {0}, deferredSlideCount: {1}",c.length,H)}c=[];for(var y of b.aX){f=Object(qa.a)(Xv.a,y);if(!f)return this.Ec.Mg(!1,b.Wb,11),8;f=f.gd;if(!f||!f.isConnected)return xa.a.J(512356551,826,50,"Paste deleted slide"),this.wBg.luc(ResourceStrings.l_CannotPasteDeletedObjectsTitle,String.format(ResourceStrings.l_CannotPasteDeletedObjectsMessage),
null),b.Cch&&(this.Qq.hr=null),this.Ec.Mg(!1,b.Wb,13),16;if(this.$b.$c(f))return this.Ec.Mg(!1,b.Wb,3),16;Array.add(c,f)}y=Array.clone(this.pa.Se());y.sort((H,Q)=>H.ue-Q.ue);y=y[y.length-1];if(!y)return xa.a.J(512356550,826,50,"Paste slides with no slide selected"),this.Ec.Mg(!1,b.Wb,13),8;Nc.a.Ak("SlideCount",c.length.toString());y=this.tA.DYf(c,a,y,b.Wb,!1);c=!0;for(const H of y)if(!H.nO){c=!1;break}c||this.$b.rw(this.Tb.Ef,a);Nc.a.AP(!0,!0);this.Ec.Mg(!0,b.Wb);return 32}h1e(){return this.pa.Fs()||
this.pa.rH()}Lsl(){if(this.pa.Fs())return!0;if(this.pa.rH()){const a=this.pa.Xd();return 1!==a.length||!a[0].isEditable}return!1}Lzj(a,b,c,f,l,y){const H=this.Ec.uP(1,0,"HandleBrowserCut");this.Ec.hC(1,H);this.h1e()?(a=this.Mdb(a,this.ia,b,c,f,l,y,this.Ec,H),a.L8a(16)):(Nc.a.AP(!0,!0),this.Ec.dlc(H),a=this.Mdb(a,this.ia,C.a.L0b,c,f,l,y,this.Ec,H),a.NZc());return a}Kzj(a,b,c,f,l,y){const H=this.Ec.uP(0,0,"HandleBrowserCopy");this.Ec.hC(1,H);this.h1e()?(a=this.Mdb(a,this.ia,b,c,f,l,y,this.Ec,H),2===
f&&this.Bma.fta(Object.assign(new vt(!0),{Ymg:!1,Wb:H})),a.L8a(32)):(this.Ec.dlc(H),a=this.Mdb(a,this.ia,C.a.TKc,c,f,l,y,this.Ec,H),a.NZc());return a}Mzj(a,b,c,f,l,y){const H=this.Ec.uP(2,0,"HandleBrowserPaste"),Q=this.h1e();a=this.Mdb(a,this.ia,Q?b:C.a.t8,c,f,l,y,this.Ec,H);y=Object(qa.a)(10,y);Nc.a.AP(!0,!1);if(this.pa.D9())return a.L8a(16),this.Ec.Mg(!1,H,3),a;y&&y.Ua(ee.a.VU)?2===f&&this.uxd(y,H)?a.L8a(32):Q?(2===f&&this.EA.paste(Object.assign(new qm.a(!0),{Aqg:!1}),y.eb(ee.a.VU),!1),a.L8a(32)):
a.NZc():(xa.a.J(512356549,826,50,"Invalid action data for browser paste, expect PastedHtmlContent"),a.L8a(16),this.Ec.Mg(!1,H,14));return a}dDj(a,b,c,f,l,y){Nc.a.gAa("PasteGivenText",!1);this.Lsl()?(a=this.Mdb(a,this.ia,b,c,f,l,y,this.Ec,""),a.L8a(16)):(Nc.a.AP(!0,!0),a=this.Mdb(a,this.ia,C.a.Ykd,c,f,l,y,this.Ec,""),a.NZc());return a}oDj(a,b,c,f,l){if(1===c)return 32;if((b=this.pa.Xd())&&0<b.length)return xa.a.J(512356548,826,50,"HandlePasteTextIntoNewShape: do not paste text into a new textbox since a shape is selected. {0}",
this.iHa.DXd(b)),16;xa.a.J(512356547,826,50,"HandlePasteTextIntoNewShape: a. Paste text as new shape.");if(!(l&&l.hn&&l.hn.innerHTML&&l.hn.innerHTML.length))return xa.a.J(512356546,826,50,"HandlePasteTextIntoNewShape: a. User attempted to paste null content."),8;Nc.a.gAa("PasteTextIntoNewShape",!0);b=this.oq.Ba;if(!b)return xa.a.J(512356545,826,50,"insert shape with no slide selected"),16;if(!this.hj.iD(b,1))return this.hj.KD(b),16;l=this.xk.g1d(b.cid,b.sid,b.zs()+1,l.hn.innerHTML,l.Wb);this.tA.zT([l],
b,a);return 32}l8f(){const a=this.Sb.Ou();return new Zc.a(Math.floor(a.width/2),Math.floor(a.height/2))}cDj(a,b,c,f,l){if(1===c)return 32;a="";l&&(a=l.getAttribute(zu.a.QIf).toString());this.Ec.$Bb(a)||(a=this.Ec.uP(2,1,"HandlePasteContentFromPandora"));b=this.ia.processAction(ea.a.Lja,2);if(32!==b)return this.Ec.Mg(!1,a,15),xa.a.J(512356544,826,50,"Exit from box4 failed."),b;a=Object.assign(new qm.a(!0),{Wb:a});this.gR.wXj(l)?a.hn=l:(rb.a.S1b(this.Zg),this.Zg.contentWindow.document.body.appendChild(l));
this.EA.paste(a,null,!1);xa.a.J(512356515,826,50,null);return 32}uxd(a,b){if(a){if(this.la.Ame){const c=a.sa(ee.a.zZc,"");if(c.startsWith("data:image/"))return this.Ec.hC(5,b),this.EA.qOe(c,b)}a=a.eb(ee.a.VU);ma.a.Xa(a)||(a=this.gR.hKa(a),this.Ec.Rol(a,b))}return!1}}Object(m.a)(SM,"ClipboardActor",null,[251]);var Mp=d(1168);class TM{constructor(a,b){this.ia=a;this.Mq=b;this.vb()}vb(){this.ia.ra(ea.a.fjh,ie.a.frame,Object(I.a)(this,this.Swc,"updateCoauthStatus"),96)}pe(){}Swc(a,b,c,f,l){if(1===c)return 32;
a=this.Mq.uoc;ma.a.Xa(a)&&(a="NotConnected");this.Mq.m9a&&(a=String.format("{0} ~:{1}",a,this.Mq.m9a));l[Mp.a.Value]=a;l[nm.a.labelText]=a;l[Mp.a.Visible]=!0;return 32}}Object(m.a)(TM,"CoauthActor",null,[251]);var Au=d(232),Xk=d(355);class UM{constructor(a,b,c,f){this.OHa=!1;a("powerpoint-editor-intl").then(()=>{xa.a.J(509117583,801,50,"Icons and strings script is loaded successfully");a("colorPickerManager").then(()=>{xa.a.J(509117582,801,50,"Color Picker Manager script is loaded successfully");
this.OHa=!0}).catch(l=>{xa.a.J(509117581,801,10,"Failed to load colorpickerManager "+l.toString())})}).catch(l=>{xa.a.J(509117580,801,10,"Failed to load powerpoint-editor-intl "+l.toString())});this.ia=b;this.Fa=c;this.Tb=f}vb(){this.ia.ya(ea.a.renderColorPicker,hc.a.application,Object(I.a)(this,this.renderColorPicker,"renderColorPicker"));this.ia.ya(ea.a.xCa,hc.a.application,Object(I.a)(this,this.xCa,"addRecentColor"))}pe(){}renderColorPicker(a,b,c,f,l){if(1===c)return this.OHa?32:8;a=!1;b=l.currentColor;
c=l.handleCommand;l.hideAlphaSlider&&(a=!0);this.x9k(b,c,a);return 32}xCa(a,b,c,f,l){if(a=Au.a.parse(l.Color)){b=this.Tb.Ef;if(!b)return xa.a.J(509117579,822,10,"AddRecentColor: pagemanifestnode is null"),8;b.ye(zb.a.JQi,a.RGBColor);b.ye(zb.a.dda,JSON.stringify(Xk.g(b.dda,a.RGBColor)))}else return xa.a.J(509117578,822,10,"AddRecentColor: failed to parse colorinfo, colorInfo is null"),8;return 32}x9k(a,b,c){let f="#000000",l=100;a&&(f=rc.a.bH(a.PD),l=100*a.alpha);a=document.getElementById("colorPickerDiv");
a||(a=document.createElement("div"),a.id="colorPickerDiv",document.getElementById("WACInnerFrame").appendChild(a),this.Fa.SZc(jb.a.k2b,jb.a.Xi,a));const y=colorPickerManager.FactoryGlobal.getColorPickerManagerInstance();if(y)if(y.addEventListener("onColorChange",ia=>{const wa={};wa.Color=ia;wa.sourceControlId="CustomColors";let Ua=8;Qg.a("ColorPicker_ColorApplied",b,()=>Ua=this.ia.Ka(b,2,wa));32===Ua?xa.a.J(509117576,822,50,"RenderColorPickerDialog: Color applied successfully from color picker dialog through {0} command.",
b):xa.a.J(509117575,822,50,"RenderColorPickerDialog: Color not applied successfully from color picker dialog through {0} command.",b);this.Fa.tj(jb.a.k2b,!1)}),y.addEventListener("onCancel",()=>{this.Fa.tj(jb.a.k2b,!1)}),Qg.a("ColorPicker_DialogInvocation",b,()=>{y.render("colorPickerDiv",f,l,c);return 32}),xa.a.J(509117574,822,50,"RenderColorPickerDialog: Color Picker Dialog invoked through {0} command.",b),this.Fa.tj(jb.a.k2b,!0),a=this.Fa.Fc(jb.a.k2b)){a.uJ=!0;var H=x.KeyInputManager.Qa(B.a.$q,
0),Q=x.KeyInputManager.Qa(B.a.$q,4);a.Bp(H);a.Bp(Q);a.bindAction(H,G.a.eta);a.bindAction(Q,G.a.eta)}else xa.a.J(509117573,822,10,"RenderColorPickerDialog: colorPickerScope is null");else xa.a.J(509117577,822,10,"RenderColorPickerDialog: colorPickerManagerInstace is null")}}Object(m.a)(UM,"ColorPickerActor",null,[251]);var TR=d(1074);class VM{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb=!1,Gb=!1){this.ia=a;this.cfc=b;this.jR=c;this.xZa=l.Pvc;this.N4=f;this.ta=y;this.Ga=H;this.pa=Q;this.Fa=ia;this.N0=wa;
this.rjk=kb;this.Gb=Ua;this.ni=Gb}vb(){this.ia.ya(ea.a.GNc,hc.a.application,Object(I.a)(this,this.fGj,"handleThumbnailPanelContextMenu"));this.ia.ya(ea.a.L_d,hc.a.application,Object(I.a)(this,this.HFj,"handleSorterViewThumbnailContextMenu"));this.ia.ya(ea.a.mNf,hc.a.application,Object(I.a)(this,this.GFj,"handleSorterViewBlankSpaceMenu"));this.ia.ya(ea.a.I_d,hc.a.application,Object(I.a)(this,this.bFj,"handleSectionContextMenu"));this.ia.ya(ea.a.K_d,yb.a.view,Object(I.a)(this,this.yFj,"handleSlidePanelContextMenu"));
this.ia.ya(ea.a.J_d,yb.a.view,Object(I.a)(this,this.KCj,"handleMultiSelectShapeContextMenu"));this.ia.ya(ea.a.oNf,hc.a.application,Object(I.a)(this,this.yGj,"handleVersionHistoryThumbnailContextMenu"));this.ia.he(ea.a.GNc,2048)}pe(){this.rjk&&z.a.ik&&(this.Fa.Fc(M.AppFrame.KW).bindAction(x.KeyInputManager.Qa(B.a.lNa,0),C.a.gba),this.Fa.Fc(M.AppFrame.KTe).bindAction(x.KeyInputManager.Qa(B.a.lNa,0),C.a.gba))}fGj(a,b,c,f,l){if(1===c)return 32;if(this.ia.jX)return this.N0.show(1,-1),32;this.cfc.r$a();
if(l.Bc&&Sys.UI.DomElement.containsCssClass(l.Bc,Eg.a.GCa))return 16;if(this.jR.R_||!l.Bc)return 32;2===l.ng||3===l.ng?(a=l.clientPoint.y-wf.a.Omj(this.xZa.p1)+this.xZa.p1.scrollTop,a=this.xZa.H6d(a),b=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y)):(a=0>this.xZa.selectedIndex?2:1,b=Sys.UI.DomElement.getLocation(this.xZa.p1),b=new Sys.UI.Point(b.x+se.a.Jsa,b.y+se.a.Jsa));this.N4.value.B6(se.a.hta,b,l.ng,a);return 32}yGj(a,b,c,f,l){if(1===c)return 32;if(l.Bc&&Sys.UI.DomElement.containsCssClass(l.Bc,
Eg.a.GCa))return 16;if(!l.Bc)return 32;a=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y);this.N4.value.B6(se.a.hta,a,l.ng,21);return 32}GFj(a,b,c,f,l){if(1===c)return 32;a=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y);b=20;this.ni&&0===this.Gb.ol&&(b=2);this.N4.value.B6(se.a.hta,a,l.ng,b);return 32}HFj(a,b,c,f,l){if(1===c)return 32;if(l.Bc&&Sys.UI.DomElement.containsCssClass(l.Bc,Eg.a.GCa))return 16;if(this.jR.R_||!l.Bc)return 32;if(2===l.ng||3===l.ng||1===l.ng)a=19,this.ni&&0===this.Gb.ol&&
(a=1),b=eb.a("ContextMenuPositionBugFixed")&&1===l.ng?this.B3f():new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y),this.N4.value.B6(se.a.hta,b,l.ng,a);return 32}bFj(a,b,c,f,l){if(1===c)return 32;w.AFrameworkApplication.fa.ka("PPTSorterViewSectionMenuEnabled")&&(a=l.contextMenuArgs,b=eb.a("ContextMenuPositionBugFixed")&&1===a.ng?this.B3f():new Sys.UI.Point(a.clientPoint.x,a.clientPoint.y),l.isEmptySection?this.N4.value.B6(se.a.hta,b,a.ng,17):this.N4.value.B6(se.a.hta,b,a.ng,18));return 32}yFj(a,b,
c,f,l){if(1===c)return 32;this.cfc.r$a();if(l.Bc&&Sys.UI.DomElement.containsCssClass(l.Bc,Eg.a.GCa))return 16;if(this.jR.R_||!l.Bc)return 32;if(2===l.ng||3===l.ng)a=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y);else{a=Kj.b(b);a=Kj.e(this.ta.Ba,a.Na);if(!a)return 16;a=Sys.UI.DomElement.getLocation(a.gC);a=new Sys.UI.Point(a.x+se.a.Jsa,a.y+se.a.Jsa)}this.N4.value.B6(se.a.hta,a,l.ng,4);return 32}KCj(a,b,c,f,l){if(1===c||l.Bc&&Sys.UI.DomElement.containsCssClass(l.Bc,se.a.Pki))return 32;this.cfc.r$a();
if(l.Bc&&Sys.UI.DomElement.containsCssClass(l.Bc,Eg.a.GCa))return 16;if(this.jR.R_||!l.Bc)return 32;b=Kj.b(b);var y;if(!(b&&b.Nb&&(y=this.pa.Qf())&&y.length))return 16;a=this.omj(y);if(2===l.ng||3===l.ng)y=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y);else{y=Kj.c(y[0],b.Na);if(!y||!y.va)return 16;y=Bd.a.ki(y.va.va);b=Bd.a.ki(b.container);c=y.x+se.a.Jsa<b.x?b.x:y.x+se.a.Jsa;y=y.y+se.a.Jsa<b.y?b.y:y.y+se.a.Jsa;c=c>b.x+b.width?b.x+b.width:c;y=y>b.y+b.height?b.y+b.height:y;y=new Sys.UI.Point(c,y)}1===
l.ng||4===a?this.N4.value.B6(se.a.hta,y,l.ng,a):this.N4.value.qvl(se.a.hta,y,l.ng,a);return 32}B3f(){const a=document.activeElement.getBoundingClientRect();return new Sys.UI.Point(a.x,a.y)}omj(a){let b=a[0];b.get_smartArtModelId()&&(b=this.Ga.Gr(b));return 1<a.length?this.Ga.JJc(a)?11:10:b.rz||!b.hva||b.Of?5:b.get_isSVGBlipFilled()?13:b.qj||1===b.mediaType?7:b.Wf?8:b.Hx?6:b.Jq?22:b.nr?9:b.vd?14:b.pp?15:b.r4?16:0}}Object(m.a)(VM,"ContextMenuActor",null,[251]);class WM{constructor(a,b,c,f,l,y,H,Q,ia){this.Mda=
()=>this.AHa?this.AHa:this.AHa=Ib.a.instance.qb("PowerPointWebEditor.IImageDescriptionPane");if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("selectionManager");if(!c)throw Error.argumentNull("shapeReader");if(!f)throw Error.argumentNull("accCheckPane");this.ia=a;this.pa=b;this.Ga=c;this.sdb=f;this.Sjk=l;this.oAe=y;this.vU=H;this.ima=Q;this.Rjk=ia}vb(){this.ia.ra(ea.a.Ifh,hc.a.application,Object(I.a)(this,this.BOk,"pictureToolsTabViewHandler"),this.Rjk?2052:4);this.ia.ra(ea.a.xVf,
hc.a.application,Object(I.a)(this,this.XWi,"drawingToolsTabViewHandler"),4);this.ia.ra(ea.a.KDf,hc.a.application,Object(I.a)(this,this.koi,"audioPlaybackToolsTabViewHandler"),4);this.ia.ra(ea.a.IDf,hc.a.application,Object(I.a)(this,this.ioi,"audioFormatToolsTabViewHandler"),4);this.ia.ra(ea.a.LDf,hc.a.application,Object(I.a)(this,this.loi,"audioSettingsTabViewHandler"),4);this.ia.ra(ea.a.kjh,hc.a.application,Object(I.a)(this,this.Cyj,"graphicsTabViewHandler"),100);this.ia.ra(ea.a.pSe,hc.a.application,
Object(I.a)(this,this.mEl,"tableTabViewHandler"),100);this.ia.ra(ea.a.zjh,hc.a.application,Object(I.a)(this,this.hoi,"audioContextualGroupHandler"),100);this.ia.ra(ea.a.dIc,hc.a.application,Object(I.a)(this,this.eai,"accessibleAuthoringViewHandler"),4)}pe(){}BOk(){return this.EXj()?32:this.Eqg(this.pa.Qf())?32:8}XWi(){const a=this.pa.Qf();return a&&a.length?1===a.length?this.zog(a)?32:16:this.uki(a)||this.YSj(a)&&this.zog(a)?32:this.Ysb(a)||this.CZj(a)?16:32:16}koi(){return this.oAe?this.r1c()?32:
this.Ysb(this.pa.Qf())?32:8:2}ioi(){return this.vU?this.r1c()?32:this.Ysb(this.pa.Qf())?32:8:2}loi(){return this.vU&&this.oAe?this.r1c()?32:this.Ysb(this.pa.Qf())?32:8:2}Cyj(){return this.Sjk?this.FXj()?32:this.Ga.Vuc(this.pa.Qf())?32:16:2}mEl(){const a=this.pa.Xd();return a&&1===a.length&&a[0].vd?32:8}hoi(){return this.vU||this.oAe?this.r1c()?32:this.Ysb(this.pa.Qf())?32:8:2}eai(){const a=this.ima&&this.Mda()&&this.Mda().isVisible;return this.sdb&&this.sdb.isVisible||a?32:2}CZj(a){if(!a)return!1;
let b=!0;for(const c of a){if(c.pp||1===c.mediaType)return!0;c.qj||(b=!1)}return b}uki(a){if(!a)return!1;for(const b of a)if(!b.pp)return!1;return!0}Eqg(a){if(!a)return!1;let b=!1;for(const c of a)if(c)if(c.qj&&!c.get_isSVGBlipFilled())b=!0;else if(c.pp)return!1;return b}Ysb(a){if(!a||!a.length)return!1;for(const b of a)if(b&&1!==b.mediaType)return!1;return!0}YSj(a){if(!a||!a.length)return!1;for(const b of a)if(b&&1===b.mediaType)return!0;return!1}zog(a){if(!a)return!1;for(const b of a)if(b&&(b.Tua||
b.r4))return!0;return!1}EXj(){return this.Tne(this.pa.Qf())&&this.Eqg(this.pa.mP(this.pa.Xd()))}FXj(){return this.Tne(this.pa.Qf())&&this.l2j(this.pa.mP(this.pa.Xd()))}r1c(){return this.Tne(this.pa.Qf())&&this.Ysb(this.pa.mP(this.pa.Xd()))}l2j(a){if(!a)return!1;for(const b of a)if(b&&b.Ug&&b.get_isSVGBlipFilled())return!0;return!1}Tne(a){if(!a)return!1;for(const b of a)if(b&&b.Of)return!0;return!1}}Object(m.a)(WM,"ContextualTabsActor",null,[251]);class XM{constructor(a,b,c,f){this.fFe=null;this.ia=
a;this.ta=b;this.Eb=c;this.TCg=f;this.TCg.fk(Object(I.a)(this,this.Iah,"onRichApiResponseReceived"))}vb(){this.ia.ra(ea.a.NRc,yb.a.application,Object(I.a)(this,this.bBj,"handleExecuteAddinBatchOperation"),4)}pe(){}dispose(){this.TCg.Om(Object(I.a)(this,this.Iah,"onRichApiResponseReceived"))}Iah(a,b){this.fFe&&(a=Object(qa.a)(1177,b.node))&&a.tkb&&this.fFe(a.tkb)}bBj(a,b,c,f,l){b=this.ta.presentation;if(1===c)return b?32:8;if(!b)return xa.a.J(509364444,802,10,"HandleExecuteAddinBatchOperation with null IPageManifestNode."),
16;if(!l)return xa.a.J(509364443,802,10,"HandleExecuteAddinBatchOperation with null action data."),16;this.fFe=l.promiseToResolve;c=this.Eb.xd(15,void 0,void 0,void 0,!0);try{c.hc(b),c.fd=a,b.wSd(l.requestBody)}finally{c&&c.dispose()}return 32}}Object(m.a)(XM,"ExtensibilityActor",null,[251]);var cy;(function(a){a[a.height=0]="height";a[a.width=1]="width";a[a.rotation=2]="rotation";a[a.leftMargin=3]="leftMargin";a[a.rightMargin=4]="rightMargin";a[a.topMargin=5]="topMargin";a[a.bottomMargin=6]="bottomMargin"})(cy||
(cy={}));Object(m.b)("FormatPaneProperty",cy);class $z{constructor(a,b){this.U1=a;this.paa=b}}Object(m.a)($z,"MarginShapeData",null,[]);class HE{constructor(){this.type="FormatShapeTaskPaneProps";this.onToggleAspectRatio=this.onChange=this.bottomMargin=this.topMargin=this.rightMargin=this.leftMargin=this.rotation=this.width=this.height=this.numberFormatInfo=null;this.isMarginFieldEnabled=this.isAspectRatioFeatureEnabled=this.isAspectRatioDisabled=this.isAspectRatioLocked=!1;this.emptyValueFields=
this.disabled=0}}Object(m.a)(HE,"FormatShapeTaskPaneProps",null,[]);class YM{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc){this.nJa=this.UYa=this.UX=this.Qwa=null;this.KLg=0;this.Ab=!1;this.OIa=null;this.EHa=this.dwa=!1;this.Jjk=!0;this.kb=b;this.Vb=c;this.ia=f;this.Fa=l;this.Rf=H;this.nd=Q;this.Ic=ia;this.Gb=wa;this.NGa=Ua;this.Tb=kb;this.Rf.FI(Object(I.a)(this,this.Hxa,"onChangeRenderFormatShapePane"));this.Rf.zCa(Object(I.a)(this,this.Hxa,"onChangeRenderFormatShapePane"));this.Ic.LQa(Object(I.a)(this,
this.Hxa,"onChangeRenderFormatShapePane"));this.nd.DCa(Object(I.a)(this,this.Hxa,"onChangeRenderFormatShapePane"));this.Vb.GI(Object(I.a)(this,this.zu,"onAppFrameModeSwitched"));this.VGg=ec;this.J7c=dc;this.Ga=Gb;this.I0=Fc;this.An=yc;eb.a("FixHeightAndWidthButtonValues")&&this.An&&this.An.YSd(Object(I.a)(this,this.Hxa,"onChangeRenderFormatShapePane"))}dispose(){this.Rf.s6(Object(I.a)(this,this.Hxa,"onChangeRenderFormatShapePane"));this.Rf.z0a(Object(I.a)(this,this.Hxa,"onChangeRenderFormatShapePane"));
this.Ic.ekb(Object(I.a)(this,this.Hxa,"onChangeRenderFormatShapePane"));this.nd.gkb(Object(I.a)(this,this.Hxa,"onChangeRenderFormatShapePane"));this.Vb.IY(Object(I.a)(this,this.zu,"onAppFrameModeSwitched"));eb.a("FixHeightAndWidthButtonValues")&&this.An.$od(Object(I.a)(this,this.Hxa,"onChangeRenderFormatShapePane"))}vb(){this.ia.ra(ea.a.auc,hc.a.application,Object(I.a)(this,this.auc,"showHideFormatShapePane"),4);this.ia.ra(ea.a.Ord,hc.a.application,Object(I.a)(this,this.Ord,"setAbsoluteHeight"),4);
this.ia.ra(ea.a.p3e,hc.a.application,Object(I.a)(this,this.p3e,"spinAbsoluteHeight"),4);this.ia.ra(ea.a.qjb,hc.a.application,Object(I.a)(this,this.qjb,"queryAbsoluteHeight"),100);this.ia.ra(ea.a.Prd,hc.a.application,Object(I.a)(this,this.Prd,"setAbsoluteWidth"),4);this.ia.ra(ea.a.q3e,hc.a.application,Object(I.a)(this,this.q3e,"spinAbsoluteWidth"),4);this.ia.ra(ea.a.rjb,hc.a.application,Object(I.a)(this,this.rjb,"queryAbsoluteWidth"),100);this.ia.ra(ea.a.QKb,hc.a.application,Object(I.a)(this,this.QKb,
"queryFormatShapePane"),96)}pe(){}Hxa(){this.Ab&&this.hl(!0)}zu(a){1===a.mode&&this.Ab&&(this.Ab=!1,this.Iq(),this.Fa.tj(jb.a.OW,this.Ab))}iXj(a){return this.Tb.isEditingAllowed&&this.Jjk&&!this.k1e(a)}QKb(a,b,c,f,l){(a=Object(qa.a)(Vh.a,l))&&a.Hf(this.Ab);return 32}auc(a,b,c){b=this.kb.Qf();return 1===c?b.length&&this.iXj(b)?32:8:Qg.b("FormatShapePaneActor::ShowHideFormatShapePane PaneOpen:",this.Ab.toString(),a,()=>{(this.Ab=!this.Ab)?this.hl():this.Iq();return 32})}Ord(a,b,c,f,l){b=this.kb.Qf();
return 1===c?this.kAh(b)?8:32:Qg.a("FormatShapePaneActor::SetAbsoluteHeight",a,()=>{if(!l)return xa.a.J(512500608,822,10,"FormatShapePaneActor::SetAbsoluteHeight actionData == null"),8;const y=l.Number;void 0===y||null===y||isNaN(y)||this.Nxa(y,0);return 32})}p3e(a,b,c,f,l){if(!l)return 8;l.Increment&&(this.Nxa(0,0),this.F7a());return 32}qjb(a,b,c,f,l){if(!l)return xa.a.J(512500579,822,10,"FormatShapePaneActor::QueryAbsoluteHeight actionData is null"),8;if(a=l.queryResult)b=this.fA(),a.iba=b.height.toFixed(2).toString()+
'"',1===(b.emptyValueFields&1)&&(a.iba="");return 32}Prd(a,b,c,f,l){b=this.kb.Qf();return 1===c?this.kAh(b)?8:32:Qg.a("FormatShapePaneActor::SetAbsoluteWidth",a,()=>{if(!l)return xa.a.J(512500578,822,10,"FormatShapePaneActor::SetAbsoluteWidth actionData == null"),8;const y=l.Number;void 0===y||null===y||isNaN(y)||this.Nxa(y,1);return 32})}q3e(a,b,c,f,l){if(!l)return 8;l.Increment&&(this.Nxa(0,1),this.F7a());return 32}rjb(a,b,c,f,l){if(!l)return xa.a.J(512500577,822,10,"FormatShapePaneActor::QueryAbsoluteWidth actionData is null"),
8;if(a=l.queryResult)b=this.fA(),a.iba=b.width.toFixed(2).toString()+'"',2===(b.emptyValueFields&2)&&(a.iba="");return 32}hl(a=!1){const b=this.fA(),c=Object.assign(new wu.a,{title:ResourceStrings.l_FormatOptions,hideHeader:!1,width:320,location:2,contentProps:b,onOpen:()=>{},onClose:()=>{this.Ab=!1},isModernPane:!0});Bj.UISurfaces.Gq().then(f=>{a?f.updateTaskPane(jb.a.OW,c):f.showTaskPane(jb.a.OW,c);return null})}Iq(){Bj.UISurfaces.Gq().then(a=>{a.hideTaskPane(jb.a.OW,2);return null})}fA(){const a=
this.kb.Qf();var b=[];for(var c of a)c.Of?b=Array.isArray(b.concat.apply(b,this.Ga.yx(c)))?b.concat.apply(b,this.Ga.yx(c)):null:b.push(c);if(!(c=this.rk(a[0]))||this.k1e(a))return this.EHa=!0,this.Dwh(0,0,0,0,0,0,0,127,127);var f=this.getBounds(a[0]),l=c.od;c=this.rae(f);c=this.MNc(c,1,l);f=this.nee(f);f=this.MNc(f,0,l);this.EHa=0===c||0===f?!0:!1;l=Math.round(a[0].get_shapeRotation());l=0>l&&eb.a("fixBugOfNegativeAngle")?l+360:l;b=this.rk(b[0]);let y=0,H=0,Q=0,ia=0;b&&(y=b.jVa[0],H=b.jVa[1],Q=b.jVa[2],
ia=b.jVa[3]);c=this.Dwh(c,f,l,y,H,Q,ia,this.Mfj(a),0);this.KPl(a,c);return c}Mfj(a){let b=[];for(var c of a)c.Of?b=Array.isArray(b.concat.apply(b,this.Ga.yx(c)))?b.concat.apply(b,this.Ga.yx(c)):null:b.push(c);c=0;for(let f=0;f<a.length;f++)this.tub(a[f])||(c|=4),this.I0&&!this.p1b(a[f])&&(c|=1,c|=2);for(a=0;a<b.length;a++)if(!b[a].YBb){c|=120;break}return c}tub(a){return!!a&&a.YL&&!a.lJ}p1b(a){return!!a&&a.isResizable&&!a.lJ}kAh(a){if(0>=a.length)return!0;let b=!1;if(this.I0){b=!0;for(let c=0;c<a.length;c++)if(a[c]&&
this.p1b(a[c])){b=!1;break}}return b||this.k1e(a)}k1e(a){if(!a.length)return!0;let b=!1;for(let c=0;c<a.length;c++)if(a[c]&&a[c].vd){b=!0;break}return b}KPl(a,b){if(this.J7c){var c=[];for(var f of a)f.Of?c=Array.isArray(c.concat.apply(c,this.Ga.yx(f)))?c.concat.apply(c,this.Ga.yx(f)):null:c.push(f);var l=f=!0,y=!0,H=!0;if(2<=c.length)for(var Q=1;Q<c.length;Q++){var ia=c[Q];if(!ia)continue;if(!this.getBounds(ia))continue;ia=this.rk(ia);let wa=0,Ua=0,kb=0,Gb=0;ia&&(wa=ia.jVa[0],Ua=ia.jVa[1],kb=ia.jVa[2],
Gb=ia.jVa[3]);f&&b.leftMargin!==wa&&(b.leftMargin=0,b.emptyValueFields|=8,f=!1);l&&b.rightMargin!==Ua&&(b.rightMargin=0,b.emptyValueFields|=16,l=!1);y&&b.topMargin!==kb&&(b.topMargin=0,b.emptyValueFields|=32,y=!1);H&&b.bottomMargin!==Gb&&(b.bottomMargin=0,b.emptyValueFields|=64,H=!1);if(!(f||l||y||H))break}}if(!(2>a.length))for(l=f=c=!0,y=1;y<a.length;y++)if(H=a[y])if(Q=this.getBounds(H))if(ia=this.rk(H).od,H=this.rae(Q),H=this.MNc(H,1,ia),Q=this.nee(Q),Q=this.MNc(Q,0,ia),ia=a[y].get_shapeRotation(),
c&&b.height.toFixed(2).localeCompare(H.toFixed(2))&&(b.height=0,b.emptyValueFields|=1,c=!1),f&&b.width.toFixed(2).localeCompare(Q.toFixed(2))&&(b.width=0,b.emptyValueFields|=2,f=!1),l&&b.rotation!==ia&&(b.rotation=0,b.emptyValueFields|=4,l=!1),!(c||f||l))break}bll(a,b,c,f,l,y,H,Q,ia){const wa=new HE,Ua=Object(qa.a)(Object,tg.e().numberFormatInfo);wa.numberFormatInfo=Ua;wa.height=a;wa.width=b;wa.rotation=c;wa.leftMargin=f;wa.rightMargin=l;wa.topMargin=y;wa.bottomMargin=H;wa.disabled=Q;wa.onChange=
Object(I.a)(this,this.Nxa,"onPropertyChange");wa.emptyValueFields=ia;wa.isAspectRatioLocked=this.dwa;wa.isAspectRatioDisabled=this.EHa;wa.onToggleAspectRatio=Object(I.a)(this,this.onToggleAspectRatio,"onToggleAspectRatio");wa.isAspectRatioFeatureEnabled=this.VGg;wa.isMarginFieldEnabled=this.J7c;return wa}cll(a,b,c,f,l){const y=new HE,H=Object(qa.a)(Object,tg.e().numberFormatInfo);y.numberFormatInfo=H;y.height=a;y.width=b;y.rotation=c;y.disabled=f;y.onChange=Object(I.a)(this,this.Nxa,"onPropertyChange");
y.emptyValueFields=l;y.isAspectRatioLocked=this.dwa;y.isAspectRatioDisabled=this.EHa;y.onToggleAspectRatio=Object(I.a)(this,this.onToggleAspectRatio,"onToggleAspectRatio");y.isAspectRatioFeatureEnabled=this.VGg;return y}Dwh(a,b,c,f,l,y,H,Q,ia){return this.J7c?this.bll(a,b,c,f,l,y,H,Q,ia):this.cll(a,b,c,Q,ia)}Nxa(a,b){const c=this.kb.Qf();this.KLg!==b&&(this.F7a(),this.KLg=b);switch(b){case 0:case 1:this.resize(a,c,b);break;case 3:case 4:case 5:case 6:this.fyi(a,c,b);break;case 2:this.rotate(a,c)}}onToggleAspectRatio(a){this.dwa=
a}lHf(a,b,c,f){a/=b;return c?Math.round(c/a):Math.round(f*a)}fyi(a,b,c){let f=[];for(const y of b)y.Of?f=Array.isArray(f.concat.apply(f,this.Ga.yx(y)))?f.concat.apply(f,this.Ga.yx(y)):null:f.push(y);this.OIa=b=f;let l=!0;this.UX||(this.UX=[],l=!1);Qg.b("FormatShapePaneActor::ChangeMargin Property:",cy[c]+"; AspectRatioLocked: "+(!this.EHa&&this.dwa),ea.a.gtc,()=>{for(let y=0;y<b.length;y++){const H=b[y],Q=this.rk(H);if(!Q)continue;l||this.UX.push(new $z(H,new Xi.a));this.UX.length===y&&this.UX.push(new $z(H,
new Xi.a));this.UX[y]||(this.UX[y]=new $z(H,new Xi.a));const ia=this.UX[y];ia.paa.left=H.vja;ia.paa.right=H.wja;ia.paa.top=H.xja;ia.paa.bottom=H.uja;3===c&&(this.UX[y].paa.left=a);4===c&&(this.UX[y].paa.right=a);5===c&&(this.UX[y].paa.top=a);6===c&&(this.UX[y].paa.bottom=a);Q.lAa(this.UX[y].paa)}return 32});this.dxc()}resize(a,b,c){this.OIa=b;let f=!0;const l=[],y=[];this.Qwa||(this.Qwa=[],f=!1);0===a&&(this.EHa=!0);Qg.b("FormatShapePaneActor::Resize Property:",cy[c]+"; AspectRatioLocked: "+(!this.EHa&&
this.dwa),ea.a.qkb,()=>{for(let wa=0;wa<b.length;wa++){var H=b[wa];const Ua=this.rk(H);if(this.I0){if(!Ua||!this.p1b(H))continue}else if(!Ua)continue;var Q=this.getBounds(H),ia=this.rae(Q);Q=this.nee(Q);f||(Array.add(this.Qwa,new zz(H,new Xi.a)),Ua.XL=!0,Ua.mE(!1));Array.add(l,Ua.e_a);Array.add(y,new Xi.a);Ua.shapeNode.Of&&Ua.shapeNode.isEditable&&Ua.Fk&&(Ua.Fk.visible=!0);H=Ua.od;if(0===c){H=this.CNf(a,1,H);H=Math.round(H-ia);y[wa].bottom=H;let kb;(kb=this.Qwa[wa].I1).bottom=kb.bottom+H;if(!this.EHa&&
this.dwa){ia=this.lHf(Q,ia,0,H);y[wa].right=ia;let Gb;(Gb=this.Qwa[wa].I1).right=Gb.right+ia}}else{H=this.CNf(a,0,H);H=Math.round(H-Q);y[wa].right=H;let kb;(kb=this.Qwa[wa].I1).right=kb.right+H;if(!this.EHa&&this.dwa){ia=this.lHf(Q,ia,H,0);y[wa].bottom=ia;let Gb;(Gb=this.Qwa[wa].I1).bottom=Gb.bottom+ia}}Ua.setOffsets(Xi.a.add(l[wa],y[wa]),!0);Ua.shapeNode.Of&&Ua.shapeNode.isEditable&&(Ua.oge(),Ua.dZc())}return 32});this.dxc()}rotate(a,b){this.OIa=b;let c=!0;a=Math.round(a);this.UYa||(this.UYa=[],
c=!1);Qg.a("FormatShapePaneActor::Rotate",ea.a.Prc,()=>{for(let f=0;f<b.length;f++){const l=b[f],y=this.rk(l);if(!y)continue;const H=y.Mxb().Zf(),Q=a%fp.rnc;c||(y.mE(!1),Array.add(this.UYa,new fp(l,Q)));this.UYa[f].K2d=Q;y.setRotation(Q,H)}return 32});this.dxc()}rk(a){return a?Object(qa.a)(Az.a,a.tg(this.Gb.Na)):(xa.a.J(512500576,822,10,"shapeNode == null"),null)}getBounds(a){var b=this.rk(a);if(!b)return xa.a.J(512500575,822,10,"shapeViewElement == null"),null;b=b.c7b();a.e0&&(b=this.F9d(b));return b}CNf(a,
b,c){return this.NGa.cN(this.Gb.Md.P_(a,b),c)}MNc(a,b,c){a=this.Gb.Md.gf(this.NGa.YH(a,c),b);return xe.a.Zv(a)}rae(a){a=Zc.a.Ql(a.Tj(qe.a.Wu),a.Tj(qe.a.dI));return 1>=a?0:a}nee(a){a=Zc.a.Ql(a.Tj(qe.a.Wu),a.Tj(qe.a.VE));return 1>=a?0:a}F7a(){this.J7c&&this.UX&&(this.ia.Ka(ea.a.gtc,2,this.UX),this.UX=null);if(this.Qwa){for(var a=0;a<this.OIa.length;a++){var b=this.rk(this.OIa[a]);b&&!b.Nl&&(b.shapeNode.Of&&b.shapeNode.isEditable||(b.XL=!1),b.cA(!1))}this.ia.Ka(ea.a.qkb,2,this.Qwa);this.Qwa=null}if(this.UYa){a=
[];for(b=0;b<this.OIa.length;b++){let c=this.rk(this.OIa[b]);c&&!c.Nl&&(c.cA(!1),eb.a("FixUndoRotateMultipleShapes")?a.push(this.OIa[b]):this.ia.Ka(ea.a.Prc,2,this.UYa[b]))}eb.a("FixUndoRotateMultipleShapes")&&(b={},b.selectedNodes=a,b.rotateData=this.UYa,this.ia.Ka(ea.a.Ash,2,b));this.UYa=null}this.nJa=this.OIa=null}dxc(){this.nJa&&Nc.a.Rub(this.nJa);this.nJa=Nc.a.bba(Object(I.a)(this,this.F7a,"applyPendingChangesToServerIfRequired"),1E3)}F9d(a){const b=Zc.a.lab(a.ga(0),a.ga(3));a=Zc.a.lab(a.ga(1),
a.ga(2));return new fj.a(new Zc.a(b.x,b.y),new Zc.a(a.x,b.y),new Zc.a(a.x,a.y),new Zc.a(b.x,a.y))}}Object(m.a)(YM,"FormatShapePaneActor",null,[107,251]);class aA{constructor(a,b,c,f,l,y,H){this.type="FormatTableTaskPaneProps";this.onChange=this.bottomMargin=this.topMargin=this.rightMargin=this.leftMargin=this.tableWidth=this.tableHeight=this.cellWidth=this.cellHeight=this.numberFormatInfo=null;this.isAspectRatioLocked=!1;this.onToggleAspectRatio=null;this.disabled=!1;this.emptyValueFields=0;const Q=
Object(qa.a)(Object,tg.e().numberFormatInfo);if(!Q)throw Error.argumentNull("numberFormatInfo");this.numberFormatInfo=Q;this.cellHeight=b;this.cellWidth=c;this.tableHeight=f;this.tableWidth=l;this.leftMargin=a.leftMargin;this.rightMargin=a.rightMargin;this.topMargin=a.topMargin;this.bottomMargin=a.bottomMargin;this.disabled=y;this.emptyValueFields=H}}Object(m.a)(aA,"FormatTableTaskPaneProps",null,[]);class ZM{constructor(){this.bottomMargin=this.topMargin=this.rightMargin=this.leftMargin=0;this.Bhh=
this.Ehh=this.Dhh=this.Chh=-1}}Object(m.a)(ZM,"Margins",null,[]);class $M{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc){this.dwa=this.Ab=!1;this.lui=320;this.XYa=!1;if(!a)throw Error.argumentNull("pptSelectionManager");if(!b)throw Error.argumentNull("appFrame");if(!c)throw Error.argumentNull("actionManager");if(!f)throw Error.argumentNull("focusManager");if(!l)throw Error.argumentNull("formatTablePane");if(!y)throw Error.argumentNull("graphOperationEventHandler");if(!H)throw Error.argumentNull("viewElementEventHandlers");
if(!Q)throw Error.argumentNull("viewEventSource");if(!ia)throw Error.argumentNull("pageView");if(!wa)throw Error.argumentNull("unitConversion");if(!Ua)throw Error.argumentNull("workspace");if(!Gb)throw Error.argumentNull("tableReader");if(!ec)throw Error.argumentNull("rowReader");if(!dc)throw Error.argumentNull("columnReader");if(!kb)throw Error.argumentNull("loadScript");kb("powerpoint-editor-intl").then(()=>{this.XYa=!0}).catch(Fc=>{xa.a.J(512500574,801,10,"Failed to load powerpoint-editor-intl "+
Fc.toString())});this.kb=a;this.Vb=b;this.ia=c;this.Fa=f;this.Rf=y;this.nd=H;this.Ic=Q;this.Rf.FI(Object(I.a)(this,this.j_a,"onChangeRenderFormatTablePane"));this.Rf.zCa(Object(I.a)(this,this.j_a,"onChangeRenderFormatTablePane"));this.Ic.LQa(Object(I.a)(this,this.j_a,"onChangeRenderFormatTablePane"));this.nd.DCa(Object(I.a)(this,this.j_a,"onChangeRenderFormatTablePane"));this.Vb.GI(Object(I.a)(this,this.zu,"onAppFrameModeSwitched"));this.SJ=dc;this.uZa=ec;this.zc=Gb}dispose(){this.Rf.s6(Object(I.a)(this,
this.j_a,"onChangeRenderFormatTablePane"));this.Rf.z0a(Object(I.a)(this,this.j_a,"onChangeRenderFormatTablePane"));this.Ic.ekb(Object(I.a)(this,this.j_a,"onChangeRenderFormatTablePane"));this.nd.gkb(Object(I.a)(this,this.j_a,"onChangeRenderFormatTablePane"));this.Vb.IY(Object(I.a)(this,this.zu,"onAppFrameModeSwitched"))}vb(){this.ia.ra(ea.a.cuc,hc.a.application,Object(I.a)(this,this.cuc,"showHideReactFormatTablePane"),4);this.ia.ra(ea.a.iLb,hc.a.application,Object(I.a)(this,this.iLb,"queryReactFormatTablePane"),
96)}pe(){}j_a(){this.Ab&&this.hl(!0)}zu(a){1===a.mode&&this.Ab&&(this.Ab=!1,this.Iq(),this.Fa.tj(jb.a.Mza,this.Ab))}iLb(a,b,c,f,l){(a=Object(qa.a)(Vh.a,l))&&a.Hf(this.Ab);return 32}cuc(a,b,c){if(!this.XYa)return 8;b=this.kb.Qf();if(1===c)return b.length?32:8;this.Ab=!this.Ab;return Qg.b("FormatTablePaneActor::ShowHideFormatTablePane PaneOpen: ",this.Ab.toString(),a,()=>{this.Ab?this.hl():this.Iq();return 32})}hl(a=!1){const b=this.fA(),c=Object.assign(new wu.a,{title:ResourceStrings.L_FormatTable,
hideHeader:!1,width:this.lui,location:2,contentProps:b,onOpen:()=>{xa.a.J(512500573,833,50,"FormatTablePaneActor::ShowHideReactFormatTablePane pane is now visible")},onClose:()=>{this.Ab=!1;xa.a.J(512500572,833,50,"FormatTablePaneActor::ShowHideReactFormatTablePane pane is now hidden")},isModernPane:!0});Bj.UISurfaces.Gq().then(f=>{a?f.updateTaskPane(jb.a.Mza,c):f.showTaskPane(jb.a.Mza,c);return null}).catch(f=>{xa.a.J(512500571,822,10,"FormatTablePaneActor::ShowPane, Failed to show format table pane. Exception: "+
f.toString())})}Iq(){Bj.UISurfaces.Gq().then(a=>{a.hideTaskPane(jb.a.Mza,2);return null}).catch(a=>{xa.a.J(512500570,822,10,"FormatTablePaneActor::HidePane, Failed to hide format table pane. Exception: "+a.toString())})}fA(){var a=this.kb.un();const b=new ZM;if(!a)return a=new aA(b,0,0,0,0,!0,255),this.UZe(a);let c=0,f=0;({cellHeight:c,cellWidth:f}=this.Joj(a,c,f));const l=xe.a.Zv(this.zc.Cde(a)),y=xe.a.Zv(this.zc.Ede(a));let H=this.kb.Ev();H&&H.length||(H=this.zc.UF(a));if(!H||!H.length)return a=
new aA(b,c,f,l,y,!0,255),this.UZe(a);this.Ioj(H,b);a=new aA(b,c,f,l,y,!1,0);this.UZe(a);this.JPl(a);return a}UZe(a){a.onChange=Object(I.a)(this,this.Nxa,"onPropertyChange");a.isAspectRatioLocked=this.dwa;a.onToggleAspectRatio=Object(I.a)(this,this.onToggleAspectRatio,"onToggleAspectRatio");return a}Joj(a,b,c){let f=this.kb.XWc(),l=this.kb.Syb();f&&f.length||(f=this.zc.Zka(a));l&&l.length||(l=this.azb(a));f.length&&(b=xe.a.Zv(this.uZa.u5f(f)));l.length&&(c=xe.a.Zv(this.SJ.w5f(a,l)));return{cellHeight:b,
cellWidth:c}}Ioj(a,b){let c=!0,f=!0,l=!0,y=!0;for(const H of a)H&&!H.isGhostCell&&({q0c:c,cellMargin:b.leftMargin,nmd:b.Chh}=this.Yxd(c,b.leftMargin,H.marginLeft,b.Chh),{q0c:f,cellMargin:b.rightMargin,nmd:b.Dhh}=this.Yxd(f,b.rightMargin,H.marginRight,b.Dhh),{q0c:l,cellMargin:b.topMargin,nmd:b.Ehh}=this.Yxd(l,b.topMargin,H.marginTop,b.Ehh),{q0c:y,cellMargin:b.bottomMargin,nmd:b.Bhh}=this.Yxd(y,b.bottomMargin,H.marginBottom,b.Bhh))}Yxd(a,b,c,f){a&&(b=xe.a.Zv(c),0<=f&&f!==b&&(b=-1,a=!1),f=b);return{q0c:a,
cellMargin:b,nmd:f}}JPl(a){0>a.cellHeight&&(a.emptyValueFields|=1);0>a.cellWidth&&(a.emptyValueFields|=2);0>a.leftMargin&&(a.emptyValueFields|=16);0>a.rightMargin&&(a.emptyValueFields|=32);0>a.topMargin&&(a.emptyValueFields|=64);0>a.bottomMargin&&(a.emptyValueFields|=128)}Nxa(a,b){const c={};c.Number=a;switch(b){case 0:this.ia.Ka(ea.a.E1a,2,c);break;case 1:this.ia.Ka(ea.a.ULa,2,c);break;case 2:this.ia.Ka(ea.a.tpa,2,c);break;case 3:this.ia.Ka(ea.a.VLa,2,c);break;case 4:this.ia.Ka(ea.a.bvc,2,c);break;
case 5:this.ia.Ka(ea.a.fvc,2,c);break;case 6:this.ia.Ka(ea.a.gvc,2,c);break;case 7:this.ia.Ka(ea.a.avc,2,c)}}onToggleAspectRatio(a){this.dwa=a;this.ia.Ka(ea.a.Osc,2,null)}azb(a){let b=null;a&&14===a.type&&(b=this.zc.Ade(a.firstRow));return b}}Object(m.a)($M,"FormatTablePaneActor",null,[107,251]);class bA{constructor(a,b,c){this.pa=a;this.Gb=b;this.Ga=c}process(a,b,c,f){2===c&&32===f&&b.contextId===yb.a.view&&Array.contains(bA.cel,a)&&(a=this.pa.Xd(),0<a.length&&0<this.Ga.textLength(a[0])&&this.Eyi(a[0]))}Eyi(a){if(!a.taa){var b=
Od.SelectionFactory.nl(a);b=Mb.SelectionEditor.f6b(b);var c=Mb.SelectionEditor.e6b(b,!1);b=Od.SelectionFactory.WN(b,c.Va,!1);if((c=this.pa.Pa)&&c.mb&&c.mb.contains(b)&&2===a.Nz){var f=Object(qa.a)(119,a.qc(this.Gb.Na));if(f){b=a.Nz;c=a.W1;var l=a.X1;a.Nz=1;a.W1=1;a.X1=0;f=f.lXf();f.vEf();f.zDf();f.pAa();f.AZf()&&(a.Nz=b,a.W1=c,a.X1=l);f.detach();f.x8e()}}}}}bA.cel=[C.a.Xq,C.a.mH,C.a.bI];Object(m.a)(bA,"FormattingViewOperationFinishedStageProcessor",null,[378]);var UR=d(627);class aN extends Sys.EventArgs{constructor(a){super();
this.section=a}}Object(m.a)(aN,"SectionNodeChangedArgs",Sys.EventArgs,[]);class bN{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb){this.hR=null;this.lq=a;this.Eb=b;this.Tb=c;this.pa=f;this.Fa=l;this.la=Q;this.Bn=this.la.gD;this.De=H;this.rfa=this.la.epe;this.Sb=y;this.J$c=this.la.Ecc;this.$b=ia;this.Tu=wa;this.ta=Ua;this.Gb=kb;Gb.execute(ec=>{this.hR=ec})}F0i(a,b,c){if(a&&a.length){for(var f of a)if(!f||Va.a.Cw(f.Db))return;f=this.la.Un?!0:w.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Gb&&
1===this.Gb.ol;var l=this.Eb.xd(15,void 0,()=>{this.Fa.vf(Oi.a.iE);this.pa.nh()});try{l.hc(this.lq),this.rfa?this.lq.nJe(a,b,c,f):this.lq.mJe(a[0],b,c,f)}finally{l&&l.dispose()}}}HYf(a,b){var c=this.Sb.tn;if(c&&c.Wp)if(b&&!a||!b&&a===c.Wp.length-1)xa.a.J(509364431,822,50,"ExecuteMoveSectionGraphTransaction: User has attempted to move a section out of range.");else{var f=eb.a("FixSectionMoveBug")?c.egl:c.Wp;var l=Date.now(),y=this.Eb.xd(15,void 0,()=>{},()=>{});try{y.hc(this.lq);const H=f[a],Q=b?f[a-
1]:f[a+1];c.setValue(zb.a.cxk,H);c.setValue(zb.a.Iwk,Q);if(H&&Q){let ia=-1,wa=-1;for(let Ua=0;Ua<f.length&&!(H===f[Ua]&&(ia=Ua),Q===f[Ua]&&(wa=Ua),0<=ia&&0<=wa);Ua++);Array.removeAt(f,ia);Array.insert(f,wa,H);c.anchor?c.anchor.smb(f,34,!1):xa.a.J(509364430,822,10,"ExecuteMoveSectionGraphTransaction: Presentation node should have valid anchor.")}}finally{y&&y.dispose()}this.ta.yv=b?0<=a-1?a-1:0:a+1;c=Date.now();xa.a.J(509364429,822,50,"ExecuteMoveSectionGraphTransaction: selectedSectionIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}, isMoveUp: {4}",
a,l,c,c-l,b);this.Tu?this.Tu.vTe():xa.a.J(509364428,822,10,"ExecuteMoveSectionGraphTransaction: graphOperationEventNotifier is null for raising event.")}else xa.a.J(509364432,808,10,"ExecuteMoveSectionGraphTransaction: pageManifest or SectionNodes are null.")}l0i(a,b){if(a||eb.a("AllowSectionAfterLastSlide")){var c=this.Sb.tn;if(c){var f=c.Wp;f&&f.length||xa.a.J(509364425,822,50,"ExecuteAddSectionGraphTransaction: User has added first section.");c=Date.now();var l=this.Eb.xd(15,void 0,()=>{},()=>
{});try{l.hc(this.lq);l.fd=b;const y=f&&f.length?a?this.De.WW(a.Db):f.length-1:0;this.lq.s7a(a,y)}finally{l&&l.dispose()}this.$b.rw(this.lq,b);b=Date.now();xa.a.J(509364424,822,50,"ExecuteAddSectionGraphTransaction: selectedSlideIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}",a.slideIndex,c,b,b-c);this.Tu?this.Tu.vTe():xa.a.J(509364423,822,10,"ExecuteAddSectionGraphTransaction: graphOperationEventNotifier is null for raising event.")}else xa.a.J(509364426,808,10,"ExecuteAddSectionGraphTransaction: pageManifest is null.")}else xa.a.J(509364427,
808,10,"ExecuteAddSectionGraphTransaction: selectedSlideNode is null.")}R0i(a){var b=this.Sb.tn;if(b&&b.Wp){var c=b.Wp;if(!a||a.sectionIndex>=c.length)xa.a.J(509364421,808,10,"ExecuteUpdateSectionGraphTransaction: invalid .");else{var f=b.Cag(a.sectionIndex);c=null;f&&(c=Object(qa.a)(UR.a,b.Dqj(f.bF)));b=Date.now();f=this.Eb.xd(15,void 0,()=>{this.Fa.Bd();this.pa.nh()},()=>{});try{f.hc(c),c.title=a.qRl}finally{f&&f.dispose()}c=Date.now();xa.a.J(509364420,822,50,"ExecuteUpdateSectionGraphTransaction: updateSectionIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}, ",
a.sectionIndex,b,c,c-b)}}else xa.a.J(509364422,808,10,"ExecuteUpdateSectionGraphTransaction: pageManifest or SectionNodes are null.")}K0i(a,b){const c=this.Sb.tn;if(c&&c.Wp){var f=c.Wp,l=this.ta.Jca,y=Date.now(),H=f.length,Q=this.Eb.xd(15,void 0,()=>{},()=>{});try{Q.hc(this.lq);Q.fd=b;if(a){const ia=this.Sb.Qyb(a-1);let wa=l.WA;if(ia&&wa){const Ua=ia.WA?ia.WA:[];for(let kb=0;kb<wa.length;kb++)Array.insert(Ua,Ua.length,wa[kb]);wa=[];ia.WA=Ua}}Array.removeAt(f,a);c.xSf(l)}finally{Q&&Q.dispose()}this.ta.yv=
0<=a-1?a-1:0;this.$b.rw(this.lq,b);b=Date.now();xa.a.J(509364418,822,50,"ExecuteRemoveSectionGraphTransaction: selectedSectionIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}, initialSectionArrayLength: {4}, finialSectionArrayLength: {5}",a,y,b,b-y,H,f.length);this.Tu?this.Tu.dZk(new aN(l)):xa.a.J(509364417,822,10,"ExecuteRemoveSectionGraphTransaction: graphOperationEventNotifier is null for raising event.")}else xa.a.J(509364419,808,10,"ExecuteRemoveSectionGraphTransaction: pageManifest or SectionNodes are null.")}SRc(a,
b,c,f){if(!b||!this.J$c&&!c)return null;let l=null;const y=this.Eb.xd(15,void 0,()=>{eb.a("FixDocumentFocusIssue")||this.Fa.Bd();this.pa.nh()},()=>{1!==this.Gb.ol&&(eb.a("FixDocumentFocusIssue")?this.Fa.vf(this.Fa.Ee.name):this.Fa.vf(Oi.a.iE))});try{let H;H=this.la.Un?!0:w.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Gb&&1===this.Gb.ol;let Q;Q=eb.a("SlideSorterInsertionAfterFirstSlide")?!!this.Gb&&1===this.Gb.ol&&-1===this.Tb.iya:!!this.Gb&&1===this.Gb.ol&&!this.Tb.iya;const ia=this.ta.Jca;
if(H&&ia&&(!ia.rK||!ia.rK.length)||Q)Q&&(this.Tb.iya=-1),a=null;y.hc(this.Tb.Ef);y.fd=f;l=Object(qa.a)(118,this.lq.q_b(a,ia,b,c,H));this.Bn&&this.pa.rP(l);this.Tb.Ba=l;this.Tb.Ef.removeProperty(zb.a.oOe)}finally{y&&y.dispose()}return l}E0i(a,b,c,f,l,y){if(5!==f)throw Error.invalidOperation();const H=Object(qa.a)(118,this.lq.t1d(a,b,c));if(!H)return xa.a.J(509364416,822,10,"CreateSlideNodeForInsertion returned null"),null;b=this.la.Un?!0:w.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Gb&&
1===this.Gb.ol;c=this.Eb.xd(15,void 0,()=>{this.Fa.Bd();this.pa.nh()},()=>{this.Bn&&this.pa.rP(H);this.Fa.vf(Oi.a.iE)});try{c.hc(this.Tb.Ef),c.fd=y,this.lq.Ibb(H,a,null,b),l&&(this.Tb.Ba=H)}finally{c&&c.dispose()}return H}y0i(a,b){var c=null;if(!a)throw Error.argumentNull("srcSlideNode");c||(c=a);let f;f=this.la.Un?!0:w.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Gb&&1===this.Gb.ol;let l=null;const y=this.Eb.xd(15,void 0,()=>{this.Fa.Bd();this.pa.nh()},()=>{1!==this.Gb.ol&&(this.la.Un?
this.Fa.vf(jb.a.lC):this.Fa.vf(Oi.a.iE))});try{y.hc(this.Tb.Ef),y.fd=b,l=Object(qa.a)(118,this.lq.tQ(Object(qa.a)(117,a),Object(qa.a)(117,c),f,!0)),this.hR&&this.hR.eTf([l]),this.Bn&&this.pa.rP(l),this.Tb.Ba=l}finally{y&&y.dispose()}return l}DYf(a,b,c,f,l){if(!a||!a.length)throw Error.argumentNull("srcSlideNodes");const y=[];a=Array.clone(a);a.sort((ia,wa)=>wa.ue-ia.ue);c||(c=a[0]);let H;H=this.la.Un?!0:w.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Gb&&1===this.Gb.ol;const Q=this.Eb.xd(15,
void 0,()=>{this.Fa.Bd();this.pa.nh()},()=>{1!==this.Gb.ol&&(this.la.Un?this.Fa.vf(jb.a.lC):this.Fa.vf(Oi.a.iE))});try{Q.hc(this.Tb.Ef);Q.fd=b;for(b=0;b<a.length;b++){if(!a[b])continue;const wa=Object(qa.a)(118,this.lq.tQ(Object(qa.a)(117,a[b]),Object(qa.a)(117,c),H,l));ma.a.Xa(f)||(wa.Wb=f);Array.add(y,wa)}0<y.length&&this.hR&&this.hR.eTf(y);let ia;(ia=this.pa).rP.apply(ia,y);this.Tb.Ba=y[y.length-1];this.De.N9a=!0}finally{Q&&Q.dispose()}return y}zT(a,b,c,f=null,l=null,y=!0){if(!a)throw Error.argumentNull("shapeNodes");
if(!a.length)throw Error.argumentOutOfRange("shapeNodes.Length",a.length);if(!b)throw Error.argumentNull("slideNode");if(f&&a.length!==f.length)throw Error.invalidOperation();let H=null;y&&1!==this.Gb.ol&&(H=()=>{this.pa.d1a(a,!0)});y=this.Eb.xd(15,void 0,()=>{this.pa.au();this.pa.nh();this.Fa.Bd()},H);try{y.hc(b);y.fd=c;this.zei(y,a);const Q=new Sys.StringBuilder;for(c=0;c<a.length;c++){const ia=f?f[c]:null;a[c]&&(b.jB(a[c],ia),a[c].id&&Q.append(a[c].id.toString()+";"))}y.py[Iq.a.bfh]=Q.toString();
l&&b.YR([l])}finally{y&&y.dispose()}}zei(a,b){if(1!==b.length||!b[0].vd&&ma.a.Xa(b[0].E_a))for(const c of b){if(c.Ccb||c.qj)a.py[Iq.a.L9b]=!0;if(c.pp||2===c.mediaType||1===c.mediaType)a.py[Iq.a.KYc]=!0;c.nr&&(a.py[Iq.a.JYc]=!0)}else a.py[Iq.a.M9b]=!0}U9a(a,b){if(!(1>b.length)){var c=this.Eb.xd(15);try{c.hc(b[0]);const f=this.pa.mP(Array.isArray(b)?b:null);for(const l of f)a(l)}finally{c&&c.dispose()}}}pka(a,b){this.U9a(c=>{(c=Object(qa.a)(4,c))&&a(c)},b)}}Object(m.a)(bN,"GraphTransactionHelperProxy",
null,[343]);var IE=d(293),eq=d(294);class cN{constructor(a,b,c,f){this.Yrc=a;this.Zrc=b;this.Z3c=c;this.$3c=f}w9e(a,b,c,f){a<this.Yrc&&(this.Yrc=a);b<this.Zrc&&(this.Zrc=b);a+c>this.Z3c&&(this.Z3c=a+c);b+f>this.$3c&&(this.$3c=b+f)}}Object(m.a)(cN,"GroupShapeOffset",null,[]);class dN{constructor(a,b,c,f,l,y,H,Q,ia,wa){this.ia=a;this.Eb=b;this.pa=c;this.Ga=f;this.ta=l;this.xk=y;this.Gb=H;this.wi=Q;this.FJ=ia;this.la=wa}vb(){this.ia.ra(ea.a.IPe,hc.a.application,Object(I.a)(this,this.xBj,"handleGroupShapes"),
4);this.ia.ra(ea.a.RPe,hc.a.application,Object(I.a)(this,this.lGj,"handleUngroupShapes"),4);this.ia.ra(ea.a.HPe,hc.a.application,Object(I.a)(this,this.wBj,"handleGroupFlyoutAnchor"),4)}pe(){const a=this.FJ.Uo.Fc(jb.a.vg);a.bindAction(x.KeyInputManager.Qa(B.a.ORb,x.KeyInputManager.Re),ea.a.IPe);a.bindAction(x.KeyInputManager.Qa(B.a.ORb,x.KeyInputManager.Re|4),ea.a.RPe)}WHf(a){let b=1<a.length&&!a[0].Ug&&!a[1].Ug;if(b)for(const c of a)if(this.la.ela){if(c.xIb||c.rl||c.vd){b=!1;break}}else if(c.rl||
c.vd){b=!1;break}return b}wmj(a){a=a.get_shapeRotation()%180;0<=a&&45>a?a=0:45<=a&&135>a?a=90:135<=a&&180>a&&(a=0);return a}xBj(a,b,c){const f=this.pa.Xd();return this.WHf(f)?1===c?32:Qg.a("GroupOperations_GroupShapes",a,()=>{const l=[];for(var y of f)l.push(y.id);y=Object(qa.a)(118,this.ta.Ba);if(!y)throw Error.argumentNull("ActiveSlide is null");const H=y.zs(),Q=new cN(y.Vp,y.Vk,0,0);var ia=0;let wa=ia=0;for(var Ua of f)(ia=this.wmj(Ua),Ua.rz)?(ia=Ua.Iy,wa=Ua.Jy,Q.w9e(ia,wa,Ua.yda,Ua.xda)):ia?90===
ia&&(ia=Ua.Iy+Ua.Ix/2-Ua.jD/2,wa=Ua.Jy+Ua.jD/2-Ua.Ix/2,Q.w9e(ia,wa,Ua.jD,Ua.Ix)):(ia=Ua.Iy,wa=Ua.Jy,Q.w9e(ia,wa,Ua.Ix,Ua.jD));const kb=this.xk.ADa(!1,y.Db.cid,y.Db.sid,0,10,Q.Yrc,Q.Zrc,Q.Z3c-Q.Yrc,Q.$3c-Q.Zrc,H+1);xa.a.J(595359714,822,50,"GroupUngroupShapesActor::HandleGroupShapes : Group Action performed on {0}",f.length);this.gQj(kb,y.Db,Q.Z3c-Q.Yrc,Q.$3c-Q.Zrc);y.jB(kb);Ua=this.Eb.xd(15,void 0,void 0,()=>{this.pa.selectShape(kb,!0)});try{Ua.hc(y),Ua.fd=a,1<l.length&&(y.l9=l)}finally{Ua&&Ua.dispose()}return 32}):
8}lIf(a){for(const b of a)if(this.la.ela){if(b.Of&&!b.yIb)return!0}else if(b.Of)return!0;return!1}lGj(a,b,c){const f=this.pa.Xd();return this.lIf(f)?1===c?32:Qg.a("GroupOperations_UngroupShapes",a,()=>{const l=[];var y=[];for(const Q of f)if(Q.Of){l.push(Q.id);const ia=this.Ga.yx(Q);for(const wa of ia)y.push(wa);this.pa.I8(Q)}for(var H of y)y=Kj.c(H,this.Gb.Na),this.pa.I8(H),y.ila(),y.XMb=!0;H=this.ta.Ba;xa.a.J(595359712,822,50,"GroupUngroupShapesActor::HandleUngroupShapes : Ungroup Action performed on {0}",
f.length);y=this.Eb.xd(15);try{y.hc(H),y.fd=a,H.Upa=l}finally{y&&y.dispose()}return 32}):8}wBj(a,b,c){b=this.pa.Xd();a=this.WHf(b);b=this.lIf(b);return 1===c?a||b?32:8:32}gQj(a,b,c,f){var l=Object(qa.a)(340,Object(qa.a)(118,this.ta.Ba).tg(this.Gb.Na));const y=this.Gb.Md,H=Math.round(this.wi.cN(y.Ne(c,0),l.UT));l=Math.round(this.wi.cN(y.Ne(f,1),l.UT));a.setValue(ab.a.Ix,c);a.setValue(ab.a.jD,f);a.setValue(zb.a.IRb,c);a.setValue(zb.a.Czb,f);a.isEditable=!0;a.Of=!0;a.setValue(zb.a.hL,4);a.setValue(zb.a.mpd,
!0);a.yda=Fb.a.sKa(H,0);a.xda=Fb.a.sKa(l,1);a.setValue(zb.a.FSa,0);a.setValue(zb.a.GSa,0);a.setValue(zb.a.WVa,!0);a.setValue(zb.a.isResizable,!0);a.setValue(zb.a.YL,!0);a.kO=!0;a.QVa=!0;a.YL=!0;a.isResizable=!0;a.yG=Va.a.Uy(b.sid,b.cid);a.cmb=a.get_shapeId();a.setValue(zb.a.Mua,!0);b=Object.assign(new IE.a,{TopLeft:Object.assign(new eq.a,{X:0,Y:0}),TopRight:Object.assign(new eq.a,{X:H,Y:0}),BottomLeft:Object.assign(new eq.a,{X:0,Y:l}),BottomRight:Object.assign(new eq.a,{X:H,Y:l})});a.ZR=b;this.Ga.ZL(a)&&
Nc.a.Kb&&(Nc.a.Kb.Oj=!0)}}Object(m.a)(dN,"GroupUngroupShapesActor",null,[251]);class eN{constructor(){this.isFooterInsert=this.omitOnTitle=!1;this.sFooterName=null;this.isMultipleSlidesSelected=this.isSlideNumInsert=!1}}Object(m.a)(eN,"FooterPaneInfo",null,[]);var fN=d(625);class JE{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.IsToggled=this.IsSlideNumInsert=this.IsOmitOnTitlePh=this.IsFooterInsert=!1;this.SFooterName=null}}Object(m.a)(JE,"PresFooterInfo",null,[]);var gN=d(653);class hN{constructor(a,
b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb){this.Nma=null;a("powerpoint-editor-intl").then(()=>{xa.a.J(509117598,801,50,"Icons and strings script is loaded successfully");a("headerFooterManager").then(()=>{xa.a.J(509117597,801,50,"Header Footer Pane Manager script is loaded successfully");this.Nma=headerFooterManager.FactoryGlobal.getHeaderFooterManagerInstance();this.A3k()}).catch(ec=>{xa.a.J(509117596,801,10,"Failed to load headerfooter pane manager "+ec.toString())})}).catch(ec=>{xa.a.J(509117595,801,10,"Failed to load powerpoint-editor-intl "+
ec.toString())});this.kb=b;this.Vb=c;this.ia=f;this.Tb=l;this.ta=y;this.Fa=H;this.Qv=Q;this.Rf=ia;this.nd=wa;this.Ic=Ua;this.Eb=kb;this.Rf.FI(Object(I.a)(this,this.aK,"onChangeRenderHeaderFooterPane"));this.Rf.y7a(Object(I.a)(this,this.aK,"onChangeRenderHeaderFooterPane"));this.Rf.zCa(Object(I.a)(this,this.aK,"onChangeRenderHeaderFooterPane"));this.Ic.LQa(Object(I.a)(this,this.aK,"onChangeRenderHeaderFooterPane"));this.nd.DCa(Object(I.a)(this,this.aK,"onChangeRenderHeaderFooterPane"));this.Vb.GI(Object(I.a)(this,
this.zu,"onAppFrameModeSwitched"));this.yz=null;this.BFb=!1;this.ZGb=Gb}dispose(){this.Rf.s6(Object(I.a)(this,this.aK,"onChangeRenderHeaderFooterPane"));this.Rf.drc(Object(I.a)(this,this.aK,"onChangeRenderHeaderFooterPane"));this.Rf.z0a(Object(I.a)(this,this.aK,"onChangeRenderHeaderFooterPane"));this.Ic.ekb(Object(I.a)(this,this.aK,"onChangeRenderHeaderFooterPane"));this.nd.gkb(Object(I.a)(this,this.aK,"onChangeRenderHeaderFooterPane"));this.Vb.IY(Object(I.a)(this,this.zu,"onAppFrameModeSwitched"))}pe(){}vb(){this.ia.ra(ea.a.Ebb,
hc.a.application,Object(I.a)(this,this.Ebb,"insertFooterFlyoutMenu"),4);this.ia.ra(ea.a.aZ,hc.a.application,Object(I.a)(this,this.aZ,"showHideHeaderFooterPane"),4);this.ia.ra(ea.a.rVa,hc.a.application,Object(I.a)(this,this.rVa,"insertSlideNumber"),4);this.ia.ra(ea.a.zpc,hc.a.application,Object(I.a)(this,this.zpc,"queryHeaderFooterPane"),96)}zpc(a,b,c,f,l){(a=Object(qa.a)(Vh.a,l))&&a.Hf(this.Qv.isVisible);return 32}Ebb(){return this.Nma&&this.Tb&&this.ta.Ba&&this.Tb.isEditingAllowed?32:8}aZ(a,b,c){if(1===
c)return this.Qv&&this.ta.Ba?32:8;if(!this.Qv)return 8;this.yz=null;this.Qv.isVisible=!this.Qv.isVisible;this.Qv.isVisible?(Qg.a("FooterPaneOpen",a,()=>{this.grc();return 32}),this.ZGb||(this.Fa.tj(jb.a.jJ,!0),this.Nma.focus())):this.Fa.tj(jb.a.jJ,!1);return 32}rVa(a,b,c,f,l){return 1===c?this.ta.Ba?32:8:Qg.a("FooterPaneInsertSldNumber",a,()=>{const y=this.yoc();this.$wc(y.OmitOnTitlePh,y.IsFooterInsert,y.SFooterName,!0);return this.aZ(a,b,c,f,l)})}zu(a){1===a.mode&&this.Qv&&this.Qv.isVisible&&(this.yz=
null,this.Qv.isVisible=!1,this.Fa.tj(jb.a.jJ,!1))}Rbe(a){const b=new Na.a;a=a.nz();for(const c of a)(a=Db.ParagraphReader.text(c))&&0<a.length&&b.add(a);return b.toArray().join(" ")}yoc(){const a=new fN.a;a.IsSlideNumInsert=!1;a.IsFooterInsert=!1;a.SFooterName="";var b=this.ta.Ba;if(!b)return a;if((b=b.Uj(!0))&&0<b.length)for(const c of b)!c.isLocal&&c.rl&&(5===c.Qj?a.IsSlideNumInsert=!0:6===c.Qj&&(a.IsFooterInsert=!0,b=c.isEditable&&!c.DB?this.Rbe(c):"",0<b.length?a.SFooterName=b:xa.a.J(509117594,
822,50,"Footer string is empty")));a.OmitOnTitlePh=this.Tb.Ef.OJa;return a}isMultipleSlidesSelected(){const a=this.kb.Se();return a&&1<a.length?!0:!1}grc(){if(this.Qv.isVisible)if(this.ta.Ba){var a=this.yoc(),b=this.isMultipleSlidesSelected();if(!this.yz||a.IsFooterInsert!==this.yz.IsFooterInsert||a.IsSlideNumInsert!==this.yz.IsSlideNumInsert||a.OmitOnTitlePh!==this.yz.OmitOnTitlePh||a.SFooterName.localeCompare(this.yz.SFooterName)||b!==this.BFb){this.yz=a;this.BFb=b;var c=new eN;c.isFooterInsert=
a.IsFooterInsert;c.isSlideNumInsert=a.IsSlideNumInsert;c.sFooterName=a.SFooterName;c.omitOnTitle=a.OmitOnTitlePh;c.isMultipleSlidesSelected=b;this.Nma.renderHeaderFooterTaskPane(gN.a.Vge,c)}}else this.Qv.isVisible=!1,this.yz=null}aK(){this.grc()}A3k(){this.Nma.addCloseHeaderFooterPaneEventListener(()=>{this.Qv.isVisible=!1;this.yz=null});this.Nma.addFocusHeaderFooterPaneListener(()=>{this.Fa.tj(jb.a.jJ,!0)});this.Nma.addUpdateHeaderFooterListener((a,b,c,f,l)=>{this.h9e(a,b,c,f,l)});this.Nma.addUpdateMultiSlideHeaderFooterListener((a,
b,c,f)=>{this.t9e(a,b,c,f)})}h9e(a,b,c,f,l){this.ta.Ba&&(l?this.B9e(a,b,c,f):this.$wc(a,b,c,f))}t9e(a,b,c,f){this.ta.Ba&&Qg.a("FooterPaneMultiSlide",ea.a.aZ,()=>{const l=this.Eb.xd(15,void 0,()=>{this.kb.kj()});try{l.hc(this.ta.Ba);const y=this.kb.Se();if(y&&1<y.length){for(const H of y){const Q=H.Q8;Q.IsSlideNumInsert=f;Q.IsFooterInsert=b;Q.OmitOnTitlePh=a;Q.SFooterName=c;Q.IsToggled=!Q.IsToggled;H.Q8=Q}this.Tb.Ef.OJa=a}}finally{l&&l.dispose()}return 32})}$wc(a,b,c,f){let l="FooterPaneSingleSlide";
const y=this.ta.Ba,H=y.Q8;if(a||b||f)H.OmitOnTitlePh!==a?l+="_OPH":H.IsSlideNumInsert!==f?l+="_ISN":H.IsFooterInsert!==b&&(l+="_IFT");Qg.a(l,ea.a.aZ,()=>{const Q=this.Eb.xd(15,void 0,()=>{this.kb.kj()});try{Q.hc(this.ta.Ba),H.IsSlideNumInsert=f,H.IsFooterInsert=b,H.OmitOnTitlePh=a,H.SFooterName=c,H.IsToggled=!H.IsToggled,this.Tb.Ef.OJa=a,y.Q8=H}finally{Q&&Q.dispose()}return 32})}B9e(a,b,c,f){Qg.a("FooterPaneAllSlides",ea.a.aZ,()=>{const l=this.Eb.xd(15,void 0,()=>{this.kb.kj()});try{const y=this.Tb.Ef;
l.hc(y);let H=y.EKa;H||(H=new JE);const Q=this.ta.Ba;H.ActiveSlideCid=Q.cid;H.ActiveSlideSid=Q.sid;H.IsSlideNumInsert=f;H.IsFooterInsert=b;H.IsOmitOnTitlePh=a;H.SFooterName=c;H.IsToggled=!H.IsToggled;y.OJa=a;y.EKa=H}finally{l&&l.dispose()}return 32})}}Object(m.a)(hN,"HeaderFooterPaneActor",null,[251]);class iN{constructor(){this.isFooterInsert=!1;this.sFooterName=null;this.isMultipleSlidesSelected=this.omitOnTitle=this.isSlideNumInsert=!1}}Object(m.a)(iN,"FooterPaneInfo",null,[]);class jN{constructor(){this.type=
"HeaderFooterContentProps";this.onFocusPane=this.onUpdateMultiSlideHeaderFooter=this.onUpdateHeaderFooter=this.activeSlideFooterInfo=null}}Object(m.a)(jN,"HeaderFooterContentProps",null,[]);class kN{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb){this.X8c=!1;Gb?this.X8c=!0:a("powerpoint-editor-intl").then(()=>{xa.a.J(509117590,801,50,"Icons and strings script is loaded successfully");a("powerpoint-ribbon-intl").then(()=>{xa.a.J(509117589,801,50,"Ribbon script is loaded successfully");a("taskPanes").then(()=>
{xa.a.J(509117588,801,50,"Header Footer Pane script is loaded successfully");this.X8c=!0}).catch(()=>{xa.a.J(509117587,801,10,"Failed to load Header Footer Pane script")})}).catch(()=>{xa.a.J(509117586,801,10,"Failed to load Ribbon script")})}).catch(ec=>{xa.a.J(509117585,801,10,"Failed to load powerpoint-editor-intl "+ec.toString())});this.kb=b;this.Vb=c;this.ia=f;this.Tb=l;this.ta=y;this.Qv=Q;this.Rf=ia;this.nd=wa;this.Ic=Ua;this.Eb=kb;this.Rf.FI(Object(I.a)(this,this.aK,"onChangeRenderHeaderFooterPane"));
this.Rf.y7a(Object(I.a)(this,this.aK,"onChangeRenderHeaderFooterPane"));this.Rf.zCa(Object(I.a)(this,this.aK,"onChangeRenderHeaderFooterPane"));this.Ic.LQa(Object(I.a)(this,this.aK,"onChangeRenderHeaderFooterPane"));this.nd.DCa(Object(I.a)(this,this.aK,"onChangeRenderHeaderFooterPane"));this.Vb.GI(Object(I.a)(this,this.zu,"onAppFrameModeSwitched"));this.yz=null;this.BFb=!1;this.ZGb=Gb}dispose(){this.Rf.s6(Object(I.a)(this,this.aK,"onChangeRenderHeaderFooterPane"));this.Rf.drc(Object(I.a)(this,this.aK,
"onChangeRenderHeaderFooterPane"));this.Rf.z0a(Object(I.a)(this,this.aK,"onChangeRenderHeaderFooterPane"));this.Ic.ekb(Object(I.a)(this,this.aK,"onChangeRenderHeaderFooterPane"));this.nd.gkb(Object(I.a)(this,this.aK,"onChangeRenderHeaderFooterPane"));this.Vb.IY(Object(I.a)(this,this.zu,"onAppFrameModeSwitched"))}pe(){}vb(){this.ia.ra(ea.a.Ebb,hc.a.application,Object(I.a)(this,this.Ebb,"insertFooterFlyoutMenu"),4);this.ia.ra(ea.a.aZ,hc.a.application,Object(I.a)(this,this.aZ,"showHideHeaderFooterPane"),
4);this.ia.ra(ea.a.rVa,hc.a.application,Object(I.a)(this,this.rVa,"insertSlideNumber"),4)}Ebb(){return this.Tb&&this.ta.Ba&&this.Tb.isEditingAllowed?32:8}aZ(a,b,c){if(1===c)return this.X8c?32:8;if(!this.Qv)return 8;this.yz=null;this.Qv.isVisible=!this.Qv.isVisible;this.Qv.isVisible?Qg.a("WACFooterPaneOpen:: IsTabbedPaneEnabled: "+this.ZGb.toString(),a,()=>{this.grc();return 32}):this.Iq();return 32}zu(a){1===a.mode&&this.Qv&&this.Qv.isVisible&&(this.yz=null,this.Qv.isVisible=!1,this.Iq())}hl(a=!1){const b=
this.fA(),c=Object.assign(new wu.a,{title:ResourceStrings.l_InsertFooter,hideHeader:!1,width:320,location:2,contentProps:b,onOpen:()=>{},onClose:()=>{this.Qv.isVisible=!1},isModernPane:!0});this.ZGb?Bj.UISurfaces.Gq().then(f=>{a?f.updateTaskPane(jb.a.jJ,c):f.showTaskPane(jb.a.jJ,c);return null}):(this.Qv.isVisible=!0,taskPanes.taskPane.renderTaskPane(gN.a.Vge,c))}Iq(){this.ZGb&&Bj.UISurfaces.Gq().then(a=>{a.hideTaskPane(jb.a.jJ,2);return null})}fA(){const a=new iN;a.isFooterInsert=this.yz.IsFooterInsert;
a.sFooterName=this.yz.SFooterName;a.isSlideNumInsert=this.yz.IsSlideNumInsert;a.omitOnTitle=this.yz.OmitOnTitlePh;a.isMultipleSlidesSelected=this.BFb;const b=new jN;b.activeSlideFooterInfo=a;b.onUpdateHeaderFooter=Object(I.a)(this,this.h9e,"updateFooterInfo");b.onUpdateMultiSlideHeaderFooter=Object(I.a)(this,this.t9e,"updateMultiSlidesFooterInfo");return b}rVa(a,b,c,f,l){return 1===c?this.X8c?32:8:Qg.a("WACFooterPaneInsertSldNumber:: IsTabbedPaneEnabled: "+this.ZGb.toString(),a,()=>{const y=this.yoc();
this.$wc(y.OmitOnTitlePh,y.IsFooterInsert,y.SFooterName,!0);return this.aZ(a,b,c,f,l)})}Rbe(a){const b=new Na.a;a=a.nz();for(const c of a)(a=Db.ParagraphReader.text(c))&&0<a.length&&b.add(a);return b.toArray().join(" ")}yoc(){const a=new fN.a;a.IsSlideNumInsert=!1;a.IsFooterInsert=!1;a.SFooterName="";var b=this.ta.Ba;if(!b)return a;if((b=b.Uj(!0))&&0<b.length)for(const c of b)!c.isLocal&&c.rl&&(5===c.Qj?a.IsSlideNumInsert=!0:6===c.Qj&&(a.IsFooterInsert=!0,b=c.isEditable&&!c.DB?this.Rbe(c):"",0<b.length?
a.SFooterName=b:xa.a.J(509117584,822,50,"Footer string is empty")));a.OmitOnTitlePh=this.Tb.Ef.OJa;return a}isMultipleSlidesSelected(){const a=this.kb.Se();return a&&1<a.length?!0:!1}grc(a=!1){if(this.Qv.isVisible)if(this.ta.Ba){var b=this.yoc(),c=this.isMultipleSlidesSelected();if(!this.yz||b.IsFooterInsert!==this.yz.IsFooterInsert||b.IsSlideNumInsert!==this.yz.IsSlideNumInsert||b.OmitOnTitlePh!==this.yz.OmitOnTitlePh||b.SFooterName.localeCompare(this.yz.SFooterName)||c!==this.BFb)this.yz=b,this.BFb=
c,this.hl(a)}else this.Qv.isVisible=!1,this.yz=null}aK(){this.grc(!0)}h9e(a,b,c,f,l){this.ta.Ba&&(f?this.B9e(a,b,l,c):this.$wc(a,b,l,c))}t9e(a,b,c,f){this.ta.Ba&&Qg.a("FooterPaneMultiSlide",ea.a.aZ,()=>{const l=this.Eb.xd(15,void 0,()=>{this.kb.kj()});try{l.hc(this.ta.Ba);const y=this.kb.Se();if(y&&1<y.length){for(const H of y){const Q=H.Q8;Q.IsSlideNumInsert=c;Q.IsFooterInsert=b;Q.OmitOnTitlePh=a;Q.SFooterName=f;Q.IsToggled=!Q.IsToggled;H.Q8=Q}this.Tb.Ef.OJa=a}}finally{l&&l.dispose()}return 32})}$wc(a,
b,c,f){let l="FooterPaneSingleSlide";const y=this.ta.Ba,H=y.Q8;if(a||b||f)H.OmitOnTitlePh!==a?l+="_OPH":H.IsSlideNumInsert!==f?l+="_ISN":H.IsFooterInsert!==b&&(l+="_IFT");Qg.a(l,ea.a.aZ,()=>{const Q=this.Eb.xd(15,void 0,()=>{this.kb.kj()});try{Q.hc(this.ta.Ba),H.IsSlideNumInsert=f,H.IsFooterInsert=b,H.OmitOnTitlePh=a,H.SFooterName=c,H.IsToggled=!H.IsToggled,this.Tb.Ef.OJa=a,y.Q8=H}finally{Q&&Q.dispose()}return 32})}B9e(a,b,c,f){Qg.a("FooterPaneAllSlides",ea.a.aZ,()=>{const l=this.Eb.xd(15,void 0,
()=>{this.kb.kj()});try{const y=this.Tb.Ef;l.hc(y);let H=y.EKa;H||(H=new JE);const Q=this.ta.Ba;H.ActiveSlideCid=Q.cid;H.ActiveSlideSid=Q.sid;H.IsSlideNumInsert=f;H.IsFooterInsert=b;H.IsOmitOnTitlePh=a;H.SFooterName=c;H.IsToggled=!H.IsToggled;y.OJa=a;y.EKa=H}finally{l&&l.dispose()}return 32})}}Object(m.a)(kN,"HeaderFooterPaneWacActor",null,[251]);class lN{constructor(a,b,c,f,l){this.qr=a;this.ia=b;this.Tb=c;this.ta=f;this.$b=l}vb(){this.ia.ra(ea.a.e_c,yb.a.application,Object(I.a)(this,this.TBj,"handleInsertContentFromStream"),
4)}pe(){}TBj(a,b,c,f,l){b=this.ta.Ba;if(this.$b.$c(b))return 16;if(1===c)return 32;Nc.a.Ak("SlideCount","1");c=this.qr.E0i(b,l.streamUrl,l.formatType,l.objectType,l.renderAfterInsert,a);l.renderAfterInsert&&c&&!c.nO&&this.$b.rw(this.Tb.Ef,a);return 32}}Object(m.a)(lN,"InsertContentFromStreamActor",null,[251]);class mN{constructor(a,b){this.wi=a;this.Sb=b}tWd(a,b,c,f){const l=H=>this.wi.cN(a.Ne(Fb.a.gf(H,0),0),f),y=Math.round(l(c.x+b.width))-Math.round(l(c.x));b=Math.round(l(c.y+b.height))-Math.round(l(c.y));
return Object.assign(new IE.a,{TopLeft:Object.assign(new eq.a,{X:0,Y:0}),TopRight:Object.assign(new eq.a,{X:y,Y:0}),BottomLeft:Object.assign(new eq.a,{X:0,Y:b}),BottomRight:Object.assign(new eq.a,{X:y,Y:b})})}k_d(a,b,c){var f=a?a.kge:9;const l=Fb.a.Ne(a?a.M$e:6,0,!1);f=Fb.a.Ne(f,1,!1);b=this.BEi(l,f,b,c);a=a?a.zyb(b.width,b.height,!0):this.Sb.Rka(b.width,b.height);return{V6d:b,kC:a}}BEi(a,b,c,f){let l=0,y=0;0<c&&0<f&&(a=Math.min(1*a/c,1*b/f,1),l=Math.max(c*a,1),y=Math.max(f*a,1));return new vr.a(l,
y)}}Object(m.a)(mN,"InsertImageHelper",null,[383]);var ke=d(692),cA=d(691);class nN{Sag(a,b,c,f){b=a.right-a.left;let l=a.bottom-a.top;b=Math.max(b,1);l=Math.max(l,1);eb.a("FixInkDotInsertionAtHighZooms")?(a=f.cN(b,c),c=f.cN(l,c)):(a=Math.round(f.cN(b,c)),c=Math.round(f.cN(l,c)));return{xzh:a,pzh:c}}yOf(a,b,c){return Object.assign(new IE.a,{TopLeft:Object.assign(new eq.a,{X:0,Y:0}),TopRight:Object.assign(new eq.a,{X:a*c,Y:0}),BottomLeft:Object.assign(new eq.a,{X:0,Y:b*c}),BottomRight:Object.assign(new eq.a,
{X:a*c,Y:b*c})})}cxh(){}nxh(){}}Object(m.a)(nN,"InsertInkActorHelper",null,[506]);var VR=d(512);class dA{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb){this.t$=Gb;this.qr=a;this.ia=b;this.ta=c;this.$b=f;this.Gb=l;this.Rq=Q;this.xk=ia;this.hj=wa;this.Ga=Ua;this.wi=kb}dispose(){}vb(){this.ia.ra(ea.a.vkg,yb.a.application,Object(I.a)(this,this.UBj,"handleInsertInk"),4)}pe(){}UBj(a,b,c,f,l){if(!l)return 16;b=l.gd;if(!b)return xa.a.J(595080221,822,15,"HandleInsertInk was called with invalid slideNode!"),8;
f=b.Db;if(Va.a.Cw(f)||this.$b.$c(b))return 16;if(1===c)return 32;c=this.I$a(a);if(!c)return 8;if(!this.hj.iD(b,1))return this.hj.KD(b),16;var y=l.VPj;if(!y)return xa.a.J(595153805,822,15,"HandleInsertInk was called with invalid actionData!"),8;if(!y.count)return xa.a.J(595153803,822,15,"HandleInsertInk was called with 0 ink objects!"),8;l=new Na.a;for(let Ua of y){y=Ua.sqi;if(!y)return 16;var H=b.lx;H=H&&null!=H.gs?H.gs:1;y.right=y.left+(y.right-y.left)/(1/H);y.bottom=y.top+(y.bottom-y.top)/(1/H);
var Q=y.right-y.left,ia=y.bottom-y.top;Q=Math.max(Q,1);ia=Math.max(ia,1);var wa=this.Gb.Md;Q=Fb.a.gf(Q,0);ia=Fb.a.gf(ia,1);const kb=wa.gf(y.left,0);wa=wa.gf(y.top,1);const Gb=b.zs();y=cA.a.LOc(f,c,H,y,new nN,kb,wa,Q,ia,Gb,this.Ga,this.xk,this.Gb,this.ta,this.wi);y.setValue(zb.a.rla,Ua.json);y.setValue(zb.a.bGa,!0);Nc.a.Kb&&(Nc.a.Kb.actionName=dA.hYc);y.JI=new VR.a([Ua.stroke],Ua.json,!1);l.add(y)}this.qr.zT(l.toArray(),b,a,void 0,void 0,!1);for(let Ua of l)this.t$.registerInkWithStrokeCollection(Ua.JI.Cza,
Ua.id);this.Rq.lA=l.ga(l.count-1);return 32}I$a(){return new ke.a(4,10,1,1)}}dA.hYc="InsertInk";Object(m.a)(dA,"InsertInkActor",null,[251,107]);class oN{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua){this.Kj=null;this.D9c=!1;this.Gb=a;this.xk=b;this.Fa=c;this.ta=f;this.Sb=l;this.pa=H;this.Rq=Q;this.hj=ia;this.Eb=wa;this.$b=Ua;this.la=y;this.yRl=y.insertOnlineVideoUrlPatterns;this.Qqh=y.insertOnlineVideoEndpoint;this.Su=w.AFrameworkApplication.Me;this.lGl=3E4}get startTime(){return this.Kj}K1i(a){if(!a)return null;
const b=a.trim();this.dYj(b)&&(xa.a.J(38322700,352,50,"[Insert Online Video] Used iframe instead of url"),a=this.L1i(b));return a}ptg(a){if(!a)return!1;a=a.trim();for(const b of this.yRl)if((new RegExp(b)).test(a))return!0;return!1}$5j(a){if(!a)return!1;a=a.trim();a=yg.a.wB(a).toLowerCase();return!this.la.ecb&&"shorts.flipgrid.com"===a||"flipgrid.com"===a||"www.flipgrid.com"===a||!this.la.VBb&&("embed.ted.com"===a||"www.ted.com"===a||"ted.com"===a)?!1:!0}dKl(a,b){this.requestVideoData(a,c=>{this.Jkg(c)},
b)}requestVideoData(a,b,c){this.D9c?xa.a.J(38901280,352,15,"[Insert Online Video] Multiple videos at the same time!"):(this.D9c=!0,c=c||Object(I.a)(this,this.TVi,"doNothingCallback"),this.Kj=new Date,a=ma.a.Qe(a),a=this.Qqh+(0<this.Qqh.indexOf("?")?"&":"?")+"url="+a,this.Su.zj(a,1,null,null,!1,2,f=>{b(f);this.D9c=!1},f=>{c(f);this.D9c=!1},null,void 0,void 0,void 0,this.lGl,Lx.a("1")))}Jkg(a){var b=+new Date-+this.startTime;xa.a.J(38322702,352,50,"[Insert Online Video] Success!!! Hubble call completed in {0}ms",
b);Nc.a.Ak("HubbleCallDuration",b.toString());if((b=this.ta.Ba)&&!this.$b.$c(b)&&this.hj.iD(b,1))try{const Q=b.C_(this.pa.Xd());if(!Q||!this.$b.$c(Q)){var c=this.xab(b,Q),f=JSON.parse(a.data.ee),l=f.width,y=f.height;c.p_e(f.embed_url,f.thumbnail_url,f.title,f.description,0<l?l:0,0<y?y:0);var H=this.Eb.xd(15,void 0,()=>{this.pa.au();this.pa.nh();this.Fa.Bd()},()=>{this.pa.selectShape(c,!0)});try{H.ld(b),this.la.kIl&&(H.fd=ea.a.Gua,H.py[Iq.a.mka]=Iq.a.online),Q&&b.YR([Q]),b.jB(c)}finally{H&&H.dispose()}this.$b.rw(b,
"InsertOnlineVideo");this.Rq.lA=c;xa.a.J(38322704,352,50,"[Insert Online Video] Video inserted")}}catch(Q){xa.a.J(38322706,352,10,"[Insert Online Video] Exception after successful Hubble callback: Exception = [{0}], stack = {1}.",Q.message,Q.stack)}else this.hj.KD(b)}TVi(){}xab(a,b){if(!a)return null;var c=a.Db;a=a.zs();let f;const l=se.a.LR,y=se.a.nY;f=b?b.zyb(se.a.LR,se.a.nY):this.Sb.Rka(se.a.LR,se.a.nY);const H=b?0:0*Mq.a.jT;c=this.xk.Uja(!0,c.cid,c.sid,0,f.x+H,f.y+H,l,y,a+1,!0);b&&(c.v8=b.id);
return c}L1i(a){if(!a)return null;a=RegExp("src\\s*=\\s*['\"][^'\"]*").exec(a);if(!a||1!==a.length)return xa.a.J(38322708,352,10,"[Insert Online Video] iframe error"),null;a=a[0];let b=a.indexOf('"');-1===b&&(b=a.indexOf("'"));return a=a.substr(b+1)}dYj(a){return a?RegExp(".*iframe.*").test(a):!1}y6f(a){if(!a)return"NA";let b=a.indexOf(".com/");if(-1===b)return"NA";if(a.startsWith("https://"))a=a.substring(8,b);else if(a.startsWith("http://"))a=a.substring(7,b);else return"NA";b=a.lastIndexOf(".");
return-1===b?a:a.substr(b+1)}}Object(m.a)(oN,"InsertOnlineVideoDialogHelper",null,[344]);var pN=d(1055);class Wj{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye,Xd,Xf,ug){this.yFb=this.jIa=0;if(!tc)throw Error.argumentNull("insertShapeOverlayViewStateManager");if(!ye)throw Error.argumentNull("appFrame");if(!Xd)throw Error.argumentNull("viewEventNotifier");this.qr=a;this.ia=b;this.Fa=c;this.pa=f;this.AO=0;this.ta=ia;this.$b=l;this.Gb=y;this.iHa=H;this.Rq=Ua;this.fWg=Q;this.Rf=
wa;this.lq=ia.presentation;this.xk=kb;this.hj=Gb;this.Y9c=ec;this.bZa=dc;this.Ga=Fc;this.wi=yc;this.XXa=tc;this.lfa=xd;this.Xgc=Vd;this.k9c=Ld;this.Vb=ye;this.le=Xd;this.jXa=Xf;this.Ojc=ug;this.Rf.FI(Object(I.a)(this,this.t_a,"onSlideNavigation"));this.fWg.fk(Object(I.a)(this,this.qib,"onPresentationPropertyChanged"));this.Xgc&&(this.Vb.GI(Object(I.a)(this,this.zu,"onAppFrameModeSwitched")),this.le.w7a(Object(I.a)(this,this.iga,"onRibbonTabSwitched")),this.le.rfi(Object(I.a)(this,this.g9g,"onEscapeKeyPressed")));
Wj.qhd.push(ea.a.A_c);Wj.qhd.push(ea.a.y_c);this.qHf()}dispose(){this.fWg.Om(Object(I.a)(this,this.qib,"onPresentationPropertyChanged"));this.Rf.s6(Object(I.a)(this,this.t_a,"onSlideNavigation"));this.Xgc&&(this.Vb.IY(Object(I.a)(this,this.zu,"onAppFrameModeSwitched")),this.le.brc(Object(I.a)(this,this.iga,"onRibbonTabSwitched")),this.le.n7k(Object(I.a)(this,this.g9g,"onEscapeKeyPressed")))}vb(){for(const a of Wj.gFl)this.ia.ra(a,yb.a.application,Object(I.a)(this,this.efg,"handleInsertShape"),4);
for(const a of Wj.phd)this.ia.ra(a,yb.a.application,Object(I.a)(this,this.efg,"handleInsertShape"),4);this.ia.ra(ea.a.t_c,yb.a.application,Object(I.a)(this,this.WBj,"handleInsertShapeAtSpecifiedLocation"),4);this.ia.ra(ea.a.D_c,yb.a.application,Object(I.a)(this,this.XBj,"handleInsertShapeTextBoxAtSpecifiedLocation"),4);this.ia.ra(ea.a.pxi,yb.a.application,Object(I.a)(this,this.zeg,"handleCancelInsertShape"),4);this.ia.ra(ea.a.sIf,yb.a.application,Object(I.a)(this,this.zeg,"handleCancelInsertShape"),
4);this.ia.ra(ea.a.F9a,yb.a.application,Object(I.a)(this,this.NAj,"handleDuplicateShape"),4)}pe(){this.Fa.Fc(jb.a.vg).bindAction(x.KeyInputManager.Qa(B.a.xNa,x.KeyInputManager.Re),ea.a.F9a);this.Fa.Fc(jb.a.vQ).bindAction(x.KeyInputManager.Qa(B.a.xNa,x.KeyInputManager.Re),ea.a.F9a)}qHf(){if(this.lq){var a=Math.min(this.lq.IDh,this.lq.uDh);a=Math.max(a-50,0);this.jIa=Math.floor(a/(2*Mq.a.jT))-1;this.jIa=Math.max(this.jIa,0);this.yFb=-1*this.jIa}else this.jIa=1,this.yFb=-1}qib(a,b){b.property!==zb.a.slideWidth&&
b.property!==zb.a.slideHeight||this.qHf()}t_a(){this.AO=0;this.Xgc&&this.kha(0)}zu(a){1===a.mode&&this.kha(0)}iga(){this.kha(0)}g9g(){this.kha(0)}kha(a){1===a&&this.Fa.Bd();this.XXa.H6e(a)}efg(a,b,c,f,l){b=this.ta.Ba;if(!b)return 16;f=b.Db;if(Va.a.Cw(f)||this.$b.$c(b))return 16;if(1===c)return 32;c=this.I$a(a);if(!c)return 8;if(!this.hj.iD(b,1))return this.hj.KD(b),16;const y=this.Y9c&&this.bZa.nJ;var H=b.Ed.HasDefaultShape,Q=b.Ed.HasDefaultLine,ia=95===c.Uga||97===c.Uga||Array.contains(cA.a.Hre,
c.Uga);Q=Q&&ia;H=H&&!ia;ia=!1;l&&(bn.a.Pu in l?l=l[bn.a.Pu]:(xa.a.J(512349792,829,15,"actionData {0} does not contain the InputMethod",l),l=0),ia=!Array.contains(Wj.Eyk,l));if(ia){if(a===ea.a.IFa)return this.kha(1),this.lfa.instance.jAb=-1,32;if(y&&!Array.contains(Wj.qhd,a)&&!H&&!Q){this.kha(2);if(null==this.lfa.instance)throw Error.argumentNull("insertShapeOverlayViewElement");this.lfa.instance.jAb=a;return 32}}this.kha(0);let wa,Ua;var kb=this.lq.slideWidth,Gb=this.lq.slideHeight;ia=new Zc.a((kb-
c.width*xe.a.zD)/2,(Gb-c.height*xe.a.zD)/2);l=ia.x+Fb.a.gf(this.AO*Mq.a.jT,0);Ua=ia.y+Fb.a.gf(this.AO*Mq.a.jT,1);y?(ia=c.width*xe.a.zD,wa=c.height*xe.a.zD):(ia=Fb.a.gf(Wj.f1b,0),wa=Fb.a.gf(Wj.e1b,1),l=kb/2-Fb.a.gf(Wj.f1b/2-this.AO*Mq.a.jT,0),Ua=Gb/2-Fb.a.gf(Wj.e1b/2-this.AO*Mq.a.jT,1));this.AO++;this.AO>this.jIa&&(this.AO=this.yFb);kb=b.zs();Gb=Object(qa.a)(340,this.ta.Ba.tg(this.Gb.Na));Nc.a.Kb&&(Q||H)&&Nc.a.Kb.Wa(hh.a.N6d,Q?"HasDefaultLine":"HasDefaultShape");!y||a===ea.a.IFa||Array.contains(Wj.qhd,
a)||H||Q?f=this.xk.ADa(!1,f.cid,f.sid,0,c.shapeType,l,Ua,ia,wa,kb+1):(f=cA.a.LOc(f,c,Gb.UT,null,new pN.a,l,Ua,ia,wa,kb,this.Ga,this.xk,this.Gb,this.ta,this.wi),Nc.a.Kb&&(Nc.a.Kb.actionName=Wj.hYc));eb.a("MoveCursorToTextboxAfterKeyboardInsert")&&a===ea.a.IFa&&(this.Mxf(),this.rfb=f);f.isEditable=!Array.contains(Wj.phd,a);this.qr.zT([f],b,a);this.Rq.lA=f;this.twc();return 32}Mxf(){this.TAe||(this.Ojc.gja(this.Wth.bind(this)),this.Rf.MQa(this.B4g.bind(this)),this.TAe=!0)}n6k(){this.TAe&&(this.Ojc.cMb(this.Wth.bind(this)),
this.Rf.eMb(this.B4g.bind(this)),this.TAe=!1)}Wth(a,b){a=b.node;null!=a&&a==this.rfb&&(this.rfb=a,this.ALg=b.revisionId.toString())}B4g(a,b){b.FD&&b.FD.Id&&this.ALg==b.FD.Id&&(null==this.rfb||this.jXa.v4(this.rfb)||setTimeout(()=>{this.ia.Ka(ea.a.hRa,2,new Ro.a(this.rfb,!0,null));this.n6k();this.ALg=this.rfb=null},0))}XBj(a,b,c,f,l){if(1===c)return 2;this.kha(0);b=this.ta.Ba;if(!b)return 16;f=b.Db;if(Va.a.Cw(f)||this.$b.$c(b))return 16;c=this.I$a(a);if(!c)return 16;if(!this.hj.iD(b,1))return this.hj.KD(b),
16;this.AO++;this.AO>this.jIa&&(this.AO=this.yFb);if(!eb.a("IsAnyOffsetZeroForTextbox")){if(!(l&&l.left&&l.right&&l.bottom&&l.top))return xa.a.J(512349791,829,10,"Invalid offsets : {0}",l),16}else if(!l)return xa.a.J(512336011,829,10,"Invalid offsets"),16;const y=this.ta.Ba.lx.gs;let H=Fb.a.gf(this.wi.cN(l.right-l.left,y),0),Q=Fb.a.gf(this.wi.cN(l.bottom-l.top,y),1);Q||H||(this.k9c?(H=c.width*xe.a.zD,Q=c.height*xe.a.zD):(H=Fb.a.gf(Wj.Zti,0),Q=Fb.a.gf(Wj.Yti,1)));H=H?H:Fb.a.gf(Wj.Dui,0);Q=Q?Q:Fb.a.gf(Wj.Cui,
1);const ia=Fb.a.gf(this.wi.cN(l.left,y),0);l=Fb.a.gf(this.wi.cN(l.top,y),1);l=this.xk.ADa(!1,f.cid,f.sid,0,c.shapeType,ia,l,H,Q,b.zs()+1);if(!l)return xa.a.J(512349790,829,10,"Unable to create shape node as CreateShapeNode returned null"),16;eb.a("FixNarratorTextBoxBug")&&(l.setValue(zb.a.hL,c.Uga),l.setValue(zb.a.Hx,!0));eb.a("MoveCursorToTextboxAfterInsert")&&this.Mxf();l.isEditable=!Array.contains(Wj.phd,a);this.rfb=l;this.qr.zT([l],b,a);this.Rq.lA=l;this.twc();xa.a.J(512349789,829,50,"Successfully inserted the textbox at specified location");
return 32}WBj(a,b,c,f,l){if(1===c)return xa.a.J(512349511,829,10,"behavior is ActionBehavior.isEnabled"),2;this.kha(0);b=this.ta.Ba;if(!b)return xa.a.J(512349510,829,10,"slideNode is null"),16;c=b.Db;if(Va.a.Cw(c))return xa.a.J(512349509,829,10,"slideNode is fake"),16;if(this.$b.$c(b))return xa.a.J(512349508,829,10,"GraphNodeAndParent is blocked"),16;f=this.I$a(l.insertShapeActionId);if(!f)return xa.a.J(512349507,829,10,"autoShapeProps is null"),16;if(!this.hj.iD(b,1))return this.hj.KD(b),16;var y=
l.offsets;if(!y)return xa.a.J(512349788,829,10,"Invalid offsets"),16;const H=this.ta.Ba.tg(this.Gb.Na);let Q=this.Gb.Md.gf(y.right-y.left,0),ia=this.Gb.Md.gf(y.bottom-y.top,1);ia||Q||(Q=f.width*xe.a.zD,ia=f.height*xe.a.zD);const wa=this.Gb.Md.gf(y.left,0);y=this.Gb.Md.gf(y.top,1);f.height=ia/xe.a.zD;f.width=Q/xe.a.zD;const Ua=b.zs();c=cA.a.LOc(c,f,H.UT,null,new pN.a,wa,y,Q,ia,Ua,this.Ga,this.xk,this.Gb,this.ta,this.wi);Nc.a.Kb&&(Nc.a.Kb.actionName=Wj.hYc);if(!c)return xa.a.J(512349787,829,10,"Unable to create shape node as CreateShapeNode returned null"),
16;c.isEditable=!Array.contains(Wj.phd,a);l.insertLocalShape?b.jB(c,null):(this.qr.zT([c],b,a),this.lfa.instance.jAb=-1,this.Rq.lA=c,this.twc());l.node=c;xa.a.J(512349786,829,50,"Successfully inserted the shape at specified location");return 32}zeg(a,b,c){if(1===c)return 32;this.kha(0);return 32}I$a(a){switch(a){case ea.a.IFa:return new ke.a(4,16,.5,3);case ea.a.D_c:return new ke.a(4,16,.5,3);case ea.a.yje:return new ke.a(34,9,1,1);case ea.a.tle:return new ke.a(2,17,1,1.16);case ea.a.Nke:return new ke.a(3,
55,1,1);case ea.a.xke:return new ke.a(6,56,1,1.33);case ea.a.sle:return new ke.a(7,57,1.33,1);case ea.a.mje:return new ke.a(5,58,1,1);case ea.a.Tke:return new ke.a(9,59,1,1.05);case ea.a.Hje:return new ke.a(10,60,1,1.16);case ea.a.Gje:return new ke.a(11,61,1,1);case ea.a.tke:return new ke.a(12,62,1,1);case ea.a.ije:return new ke.a(13,63,1,1);case ea.a.qje:return new ke.a(14,64,1,1);case ea.a.zke:return new ke.a(39,65,1,1);case ea.a.Uie:return new ke.a(87,66,1,1);case ea.a.qle:return new ke.a(35,67,
1,1);case ea.a.Dje:return new ke.a(83,68,1,1);case ea.a.Eje:return new ke.a(84,69,1,1);case ea.a.Kje:return new ke.a(85,70,1,1);case ea.a.lje:return new ke.a(86,71,1,1);case ea.a.$ie:return new ke.a(130,72,1,1);case ea.a.Ake:return new ke.a(33,73,1,1);case ea.a.Rie:return new ke.a(73,7,1.33,1);case ea.a.aje:return new ke.a(72,8,1.33,1.33);case ea.a.Pie:return new ke.a(82,74,1.14,1.14);case ea.a.rje:return new ke.a(41,75,1,1);case ea.a.rke:return new ke.a(42,76,1,1);case ea.a.Qie:return new ke.a(40,
77,1,1);case ea.a.Cje:return new ke.a(81,78,1,1);case ea.a.Vke:return new ke.a(78,79,1,1);case ea.a.Fje:return new ke.a(75,18,1,1);case ea.a.Tje:return new ke.a(74,80,1,1);case ea.a.ple:return new ke.a(76,81,1,1);case ea.a.pke:return new ke.a(77,82,1,.5);case ea.a.Wie:return new ke.a(120,83,1,1);case ea.a.Mie:return new ke.a(88,84,1,1);case ea.a.tje:return new ke.a(93,85,1,1);case ea.a.sje:return new ke.a(94,86,1,1.17);case ea.a.Oje:return new ke.a(89,87,1,.08);case ea.a.Mke:return new ke.a(90,88,
1,.08);case ea.a.Nje:return new ke.a(91,89,1,.17);case ea.a.Lke:return new ke.a(92,90,1,.17);case ea.a.nke:return new ke.a(175,19,1,1);case ea.a.kke:return new ke.a(176,20,1,1);case ea.a.lke:return new ke.a(177,21,1,1);case ea.a.ike:return new ke.a(178,22,1,1);case ea.a.jke:return new ke.a(179,23,1,1);case ea.a.mke:return new ke.a(180,24,1,1);case ea.a.A_c:return new ke.a(95,12,1,1);case ea.a.B_c:return new ke.a(95,13,1,1);case ea.a.C_c:return new ke.a(95,14,1,1);case ea.a.y_c:return new ke.a(97,
26,1,1);case ea.a.x_c:return new ke.a(97,155,1,1);case ea.a.z_c:return new ke.a(97,156,1,1);case ea.a.v_c:return new ke.a(101,25,1,1);case ea.a.u_c:return new ke.a(101,153,1,1);case ea.a.w_c:return new ke.a(101,154,1,1);case ea.a.vje:return new ke.a(46,0,1.07,.53);case ea.a.Lje:return new ke.a(44,1,.53,1.07);case ea.a.Pje:return new ke.a(50,2,.53,1.33);case ea.a.Jke:return new ke.a(43,3,.53,1.07);case ea.a.vle:return new ke.a(45,4,1.07,.53);case ea.a.xle:return new ke.a(51,5,1.33,.53);case ea.a.Rje:return new ke.a(53,
27,.93,1.33);case ea.a.Nie:return new ke.a(62,28,.95,.89);case ea.a.ule:return new ke.a(63,29,.96,.97);case ea.a.Sje:return new ke.a(52,30,.93,.93);case ea.a.Oie:return new ke.a(49,31,.8,.93);case ea.a.eje:return new ke.a(67,32,1.33,.8);case ea.a.dje:return new ke.a(68,33,1.33,.8);case ea.a.fje:return new ke.a(69,34,.8,1.33);case ea.a.bje:return new ke.a(70,46,.8,1.33);case ea.a.mle:return new ke.a(47,35,.53,1.07);case ea.a.ske:return new ke.a(48,36,.53,1.07);case ea.a.yke:return new ke.a(36,37,.53,
1.07);case ea.a.Tie:return new ke.a(37,38,.53,.53);case ea.a.Kke:return new ke.a(56,39,1,1);case ea.a.wje:return new ke.a(58,40,1,1);case ea.a.Mje:return new ke.a(55,41,1,1);case ea.a.wle:return new ke.a(57,42,1,1);case ea.a.Qje:return new ke.a(59,43,.63,1.33);case ea.a.Gke:return new ke.a(61,44,1.33,1.33);case ea.a.Vie:return new ke.a(64,45,1.07,1.07);case ea.a.Fke:return new ke.a(54,47,1.33,1.33);case ea.a.Hke:return new ke.a(4,10,1,1);case ea.a.Rke:return new ke.a(25,11,1,1);case ea.a.Oke:return new ke.a(28,
48,1,1);case ea.a.Pke:return new ke.a(27,49,1,1);case ea.a.Qke:return new ke.a(26,50,1,1);case ea.a.Xke:return new ke.a(29,51,1,1);case ea.a.Wke:return new ke.a(32,52,1,1);case ea.a.Yke:return new ke.a(31,53,1,1);case ea.a.Zke:return new ke.a(30,54,1,1);case ea.a.Ike:return new ke.a(116,91,.67,1);case ea.a.Ske:return new ke.a(117,6,.67,1);case ea.a.wke:return new ke.a(118,92,.67,1);case ea.a.Xie:return new ke.a(119,93,.67,1);case ea.a.Uje:return new ke.a(104,94,.67,1);case ea.a.Yje:return new ke.a(105,
95,.67,1);case ea.a.bke:return new ke.a(106,96,.67,1);case ea.a.Vje:return new ke.a(107,97,.67,1);case ea.a.Zje:return new ke.a(108,98,.67,1);case ea.a.cke:return new ke.a(109,99,.67,1);case ea.a.Wje:return new ke.a(110,100,.67,1);case ea.a.$je:return new ke.a(111,101,.67,1);case ea.a.dke:return new ke.a(112,102,.67,1);case ea.a.Xje:return new ke.a(113,103,.67,1);case ea.a.ake:return new ke.a(114,104,.67,1);case ea.a.eke:return new ke.a(115,105,.67,1);case ea.a.zje:return new ke.a(79,106,1,1);case ea.a.Aje:return new ke.a(80,
107,1,1);case ea.a.gle:return new ke.a(15,108,1,1);case ea.a.hle:return new ke.a(16,15,1,1);case ea.a.ile:return new ke.a(17,109,1,1);case ea.a.jle:return new ke.a(18,110,1,1);case ea.a.kle:return new ke.a(19,111,1,1);case ea.a.ale:return new ke.a(20,112,1,1);case ea.a.ble:return new ke.a(21,113,1,1);case ea.a.cle:return new ke.a(22,114,1,1);case ea.a.ele:return new ke.a(23,115,1,1);case ea.a.fle:return new ke.a(24,116,1,1);case ea.a.yle:return new ke.a(122,117,.67,1.33);case ea.a.xje:return new ke.a(121,
118,.67,1.33);case ea.a.gje:return new ke.a(124,119,.83,1.33);case ea.a.cje:return new ke.a(123,120,.83,1.33);case ea.a.zle:return new ke.a(126,121,1.25,1.13);case ea.a.Ije:return new ke.a(127,122,1.13,1.25);case ea.a.Ale:return new ke.a(128,123,1,1);case ea.a.uje:return new ke.a(129,124,1,1);case ea.a.Dke:return new ke.a(131,125,.67,1);case ea.a.Lie:return new ke.a(158,126,.67,1);case ea.a.jje:return new ke.a(132,127,.67,1);case ea.a.hje:return new ke.a(133,128,.67,1);case ea.a.Bke:return new ke.a(134,
129,.67,1);case ea.a.Jje:return new ke.a(135,130,.67,.67);case ea.a.pje:return new ke.a(136,131,.67,1);case ea.a.qke:return new ke.a(137,132,.83,1.16);case ea.a.rle:return new ke.a(138,133,.33,1);case ea.a.Cke:return new ke.a(139,134,.67,1.16);case ea.a.gke:return new ke.a(140,135,.5,1);case ea.a.hke:return new ke.a(141,136,.67,1);case ea.a.Zie:return new ke.a(142,137,.5,.5);case ea.a.uke:return new ke.a(159,138,.67,.67);case ea.a.Sie:return new ke.a(143,139,.88,1);case ea.a.Eke:return new ke.a(144,
140,.88,1);case ea.a.nle:return new ke.a(145,141,.67,.67);case ea.a.vke:return new ke.a(146,142,.67,.67);case ea.a.Yie:return new ke.a(147,143,1,.5);case ea.a.$ke:return new ke.a(148,144,1,.5);case ea.a.Bje:return new ke.a(149,145,.75,.75);case ea.a.oke:return new ke.a(150,146,.75,.75);case ea.a.lle:return new ke.a(152,147,.67,1);case ea.a.kje:return new ke.a(157,148,.67,.67);case ea.a.Uke:return new ke.a(153,149,.67,.67);case ea.a.fke:return new ke.a(154,150,.67,1);case ea.a.nje:return new ke.a(155,
151,.75,1);case ea.a.oje:return new ke.a(156,152,.67,1);default:return null}}NAj(a,b,c){b=this.pa.Qf();if(!(b&&0<b.length&&Mq.a.Igl(b)))return 16;if(1===c)return 32;c=this.ta.Ba;if(!c)return 16;if(!this.hj.iD(c,b.length))return this.hj.KD(c),16;if(this.$b.$c(c))return 16;this.iHa.Peh(c,c,b,null,a);return 32}twc(){try{const a=Ib.a.instance.Ia("Common.ISystemInitiatedFeedback");a&&a.execute(b=>{b.logActivity("InsertShapeActivity",null)})}catch(a){xa.a.J(512349783,829,10,"Exception thrown while triggering InsertShapeActivity. Exception: {0}",
a)}}}Wj.f1b=110;Wj.e1b=75;Wj.Zti=19;Wj.Yti=38;Wj.Dui=4;Wj.Cui=4;Wj.hYc="InsertShape";Wj.gFl=[ea.a.nke,ea.a.kke,ea.a.lke,ea.a.ike,ea.a.jke,ea.a.mke,ea.a.IFa,ea.a.yje,ea.a.tle,ea.a.Nke,ea.a.xke,ea.a.sle,ea.a.mje,ea.a.Tke,ea.a.Hje,ea.a.Gje,ea.a.tke,ea.a.ije,ea.a.qje,ea.a.zke,ea.a.Uie,ea.a.qle,ea.a.Dje,ea.a.Eje,ea.a.Kje,ea.a.lje,ea.a.$ie,ea.a.Ake,ea.a.Rie,ea.a.aje,ea.a.Pie,ea.a.rje,ea.a.rke,ea.a.Qie,ea.a.Cje,ea.a.Vke,ea.a.Fje,ea.a.Tje,ea.a.ple,ea.a.pke,ea.a.Wie,ea.a.Mie,ea.a.tje,ea.a.sje,ea.a.Oje,ea.a.Mke,
ea.a.Nje,ea.a.Lke,ea.a.Hke,ea.a.Rke,ea.a.Oke,ea.a.Pke,ea.a.Qke,ea.a.Xke,ea.a.Wke,ea.a.Yke,ea.a.Zke,ea.a.Ike,ea.a.Ske,ea.a.wke,ea.a.Xie,ea.a.Uje,ea.a.Yje,ea.a.bke,ea.a.Vje,ea.a.Zje,ea.a.cke,ea.a.Xje,ea.a.ake,ea.a.eke,ea.a.Wje,ea.a.$je,ea.a.dke,ea.a.zje,ea.a.Aje,ea.a.gle,ea.a.hle,ea.a.ile,ea.a.jle,ea.a.kle,ea.a.ale,ea.a.ble,ea.a.cle,ea.a.ele,ea.a.fle,ea.a.yle,ea.a.xje,ea.a.gje,ea.a.cje,ea.a.zle,ea.a.Ije,ea.a.Ale,ea.a.uje,ea.a.Dke,ea.a.Lie,ea.a.jje,ea.a.hje,ea.a.Bke,ea.a.Jje,ea.a.pje,ea.a.qke,ea.a.rle,
ea.a.Cke,ea.a.gke,ea.a.hke,ea.a.Zie,ea.a.uke,ea.a.Sie,ea.a.Eke,ea.a.nle,ea.a.vke,ea.a.Yie,ea.a.$ke,ea.a.Bje,ea.a.oke,ea.a.lle,ea.a.kje,ea.a.Uke,ea.a.fke,ea.a.nje,ea.a.oje,ea.a.Jke,ea.a.vje,ea.a.Lje,ea.a.vle,ea.a.xle,ea.a.Pje,ea.a.Rje,ea.a.Nie,ea.a.ule,ea.a.Sje,ea.a.Oie,ea.a.eje,ea.a.dje,ea.a.bje,ea.a.fje,ea.a.mle,ea.a.ske,ea.a.yke,ea.a.Tie,ea.a.Kke,ea.a.wje,ea.a.Mje,ea.a.wle,ea.a.Qje,ea.a.Gke,ea.a.Vie,ea.a.Fke];Wj.phd=[ea.a.A_c,ea.a.B_c,ea.a.C_c,ea.a.v_c,ea.a.u_c,ea.a.w_c,ea.a.y_c,ea.a.x_c,ea.a.z_c];
Wj.qhd=[ea.a.B_c,ea.a.C_c,ea.a.v_c,ea.a.u_c,ea.a.w_c,ea.a.x_c,ea.a.z_c];Wj.Eyk=[1,5];Object(m.a)(Wj,"InsertShapeActor",null,[251,107]);class qN{constructor(a,b,c,f){this.UBe=null;this.sEk=(l,y)=>{this.UBe&&((l=Object(qa.a)(1174,y.node))&&l.tkb?this.UBe(l.tkb):xa.a.J(508901219,803,10,"onJOfcCommandPayloadResponseReceived: Cannot resolve promise"))};this.cBj=(l,y,H,Q,ia)=>{y=this.ta.presentation;if(1===H)return y?32:8;if(!y)return xa.a.J(508908367,803,10,"handleExecuteInternalBatchCommands with null IPageManifestNode."),
16;if(!ia||!ia.promiseToResolve||!ia.requestBody)return xa.a.J(508908366,803,10,"handleExecuteInternalBatchCommands with null action data."),16;this.UBe=ia.promiseToResolve;H=this.Eb.xd(15,void 0,void 0,void 0,!0);try{H.hc(y),H.fd=l,y.xSd(ia.requestBody)}catch(wa){return xa.a.J(508901218,803,10,"handleExecuteInternalBatchCommands: Exception: {0}.",wa.toString()),16}finally{H&&H.dispose()}return 32};this.ia=a;this.ta=b;this.Eb=c;this.xkk=f;this.xkk.fk(this.sEk)}vb(){this.ia.ra(ea.a.d6d,yb.a.application,
this.cBj,4)}pe(){}}Object(m.a)(qN,"JOfcCommandPayloadActor",null,[251]);class rN{constructor(){this.type="LivePollTaskPaneProps";this.formsUrl=this.onCloseButtonClicked=null}}Object(m.a)(rN,"LivePollTaskPaneProps",null,[]);class sN{constructor(a,b,c,f,l,y,H,Q){this.CM=null;this.PHa=this.Ab=!1;a("powerpoint-live-strings").then(()=>{this.PHa=!0;xa.a.J(512500544,833,50,"powerpoint-live-strings loaded successfully")}).catch(ia=>{xa.a.J(512500515,833,10,"Failed to load powerpoint-live-strings "+ia.toString())});
if(!b)throw Error.argumentNull("formsDesignPageUrl LivePollPaneActor is null");if(!c)throw Error.argumentNull("formsResultsPageUrl for LivePollPaneActor is null");if(!f)throw Error.argumentNull("actionManager for LivePollPaneActor is null");if(!l)throw Error.argumentNull("actionBlockingManager for LivePollPaneActor is null");if(!y)throw Error.argumentNull("graphTopologyManager for LivePollPaneActor is null");if(!H)throw Error.argumentNull("selectionManager for LivePollPaneActor is null");if(!Q)throw Error.argumentNull("shapeCountValidator for LivePollPaneActor is null");
this.Ehk=b;this.Fhk=c;this.ia=f;this.ta=y;this.qf=l;this.pa=H;this.hj=Q;this.$Ng=Object(I.a)(this,this.wEl,"taskPaneMessageHandler")}vb(){this.ia.ya(ea.a.cud,hc.a.application,Object(I.a)(this,this.cud,"showHideLivePollPane"))}pe(){}cud(a,b,c){return b.contextId===hc.a.application&&this.PHa?1===c?32:Qg.a("LivePollPaneToggle",a,()=>{(this.Ab=!this.Ab)?(this.hl(),xa.a.J(512500514,833,50,"LivePollPaneActor::ShowHideLivePollPane show")):(this.aH(),xa.a.J(512500513,833,50,"LivePollPanePaneActor::ShowHideLivePollPanePane close"));
return 32}):2}hl(){this.fA();const a=Object.assign(new wu.a,{title:ResourceStrings.L_LivePollTaskPane,hideHeader:!1,width:320,location:2,contentProps:this.CM,onOpen:()=>{},onClose:()=>{this.Ab=!1},isModernPane:!0});Bj.UISurfaces.Gq().then(b=>{b.showTaskPane("LivePollTaskPaneProps",a);window.addEventListener("message",this.$Ng,!1);return null}).catch(b=>{xa.a.J(512500512,833,10,"LivePollPaneActor::ShowPane exception: {0}",b.toString())})}aH(){Bj.UISurfaces.Gq().then(a=>{a.hideTaskPane("LivePollTaskPaneProps",
2);window.removeEventListener("message",this.$Ng);return null}).catch(a=>{xa.a.J(512500511,833,10,"LivePollPaneActor::ClosePane exception: {0}",a.toString())})}fA(){this.CM=Object.assign(new rN,{onCloseButtonClicked:Object(I.a)(this,this.onCloseButtonClicked,"onCloseButtonClicked"),formsUrl:this.Ihj()})}Ihj(){return String.format("{0}{1}{2}",this.Ehk,"&auth_upn=",w.AFrameworkApplication.fa.Ha("UserPrincipalName"))}onCloseButtonClicked(){this.aH()}wEl(a){if("data"in a){var b;({Nu:b}=De.d(a.data)).returnValue&&
b&&"type"in b&&"PollCreated"===b.type&&"payload"in b&&(a=b.payload,"formId"in a&&(a=String.format("{0}{1}{2}{3}{4}",this.Fhk,"?Id=",a.formId,"&auth_pvr=OrgId&auth_upn=",w.AFrameworkApplication.fa.Ha("UserPrincipalName")),this.VBj(a)))}}VBj(a){const b=this.ta.Ba;if(b&&!this.qf.$c(b))if(this.hj.iD(b,1)){var c=b.Db;b.NMi(c.sid,c.cid,a,b.zs());b.C_(this.pa.Xd())}else this.hj.KD(b)}}Object(m.a)(sN,"LivePollPaneActor",null,[251]);var WR=d(983);class dy{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb){this.DA=f;
this.twa=l;this.ia=a;this.$b=b;this.Fa=c;this.FJ=Q;this.Tb=y;this.ta=H;this.Kc=ia;this.Vb=wa;this.bxa=Ua;this.Gb=kb}vb(){this.ia.ya(ea.a.dMa,hc.a.application,Object(I.a)(this,this.dMa,"showHideNotes"));this.ia.ra(ea.a.Smd,hc.a.application,Object(I.a)(this,this.gWk,"queryNotesPaneState"),96);this.ia.ra(ea.a.Zld,hc.a.application,Object(I.a)(this,this.Gdh,"pageScrollNotesPane"),64);this.ia.ra(ea.a.Yld,hc.a.application,Object(I.a)(this,this.Gdh,"pageScrollNotesPane"),64);this.ia.ya(ea.a.m_e,hc.a.application,
Object(I.a)(this,this.Oyk,"notesResize"))}pe(){const a=this.Fa.Fc(Oi.a.o3);a.bindAction(x.KeyInputManager.Qa(B.a.rC,0),ea.a.Zld);a.bindAction(x.KeyInputManager.Qa(B.a.qC,0),ea.a.Yld)}dMa(a,b,c,f,l){if(this.Gb&&0!==this.Gb.ol)return 2;a=this.Tb.Ef;if(!this.ta.Ba||!a||this.$b.hO(a))return 16;if(1===c)return 32;l&&Object(Wa.a)(WR.a,l)?l.Qtc?this.DA.h2e():this.DA.LIj():(this.DA.CIk(),this.DA.j0b()&&this.twa.Go?this.Fa.tj(Oi.a.o3,!0):this.Fa.tj(Oi.a.o3,!1));this.FJ.Vab();return 32}gWk(a,b,c,f,l){if(!l||
!Object(Wa.a)(Vh.a,l))return 8;l.Hf(this.DA.j0b());return 32}Gdh(a,b,c){return 1===c?32:this.DA?(a===ea.a.Yld?this.DA.va.scrollTop+=dy.WGf:a===ea.a.Zld&&(this.DA.va.scrollTop-=dy.WGf),32):8}Oyk(a,b,c,f,l){xa.a.J(37524685,822,50,"Notes Resize Begin");if(!this.DA||!l||"number"!==typeof l)return xa.a.J(37524687,822,50,"Notes Resize Fail"),8;this.DA.aga=l;this.Kc.Jc.iyh(1);this.Vb.yu();this.bxa.bTl();xa.a.J(37524689,822,50,"Notes Resize Success, Notes status:{0}, Notes Height:{1}",this.DA.Myk?"On":"Off",
this.DA.aga);return 32}}dy.WGf=80;Object(m.a)(dy,"NotesActor",null,[251]);class tN{constructor(a,b,c,f){this.ia=a;this.iic=b;this.la=c;this.PLg=0;this.YO=f}pe(){}vb(){this.ia.ra(ea.a.ujh,ie.a.frame,Object(I.a)(this,this.hWk,"queryOfflineStatusHandler"),2144)}hWk(a,b,c,f,l){if(1===c)return 32;switch(this.iic.status){case 0:1===this.PLg&&(l[Mp.a.Value]=CommonUIStrings.L_Connected,l[nm.a.labelText]=CommonUIStrings.L_Connected,l[Mp.a.Visible]=!0,this.hideIcon(),il.a.instance.Hb(new dd.a(2,1,this.la.offlineLabelTimeoutInMs,
()=>{this.jwl();this.YO.dS("GetOfflineStatus",!1);this.YO.PA()},90,"108")));break;case 2:l[Mp.a.Value]=CommonUIStrings.L_Disconnected;l[nm.a.labelText]=CommonUIStrings.L_Disconnected;l[Mp.a.Visible]=!0;break;case 1:l[Mp.a.Value]=CommonUIStrings.L_Reconnecting,l[nm.a.labelText]=CommonUIStrings.L_Reconnecting,l[Mp.a.Visible]=!0}this.PLg=this.iic.status;return 32}hideIcon(){this.Pwh(Ki.a.hidden)}jwl(){this.Pwh(Ki.a.visible)}Pwh(a){const b=document.querySelector("[data-icon-name='SBVBASecurity_16']");
b&&(b.style.visibility=a)}}Object(m.a)(tN,"OfflineStatusLabelActor",null,[251]);class uN{constructor(a,b,c,f,l,y,H,Q){this.ZJg=!1;this.Cve=null;this.ia=a;this.qf=b;this.FJ=c;this.Fa=c.Uo;this.Eb=f;this.pa=l;this.Ga=y;this.oq=H;this.D0=Q}vb(){this.ia.ra(ea.a.bringForward,hc.a.application,Object(I.a)(this,this.qYc,"handleOrganizeAction"),4);this.ia.ra(ea.a.bringToFront,hc.a.application,Object(I.a)(this,this.qYc,"handleOrganizeAction"),4);this.ia.ra(ea.a.sendBackward,hc.a.application,Object(I.a)(this,
this.qYc,"handleOrganizeAction"),4);this.ia.ra(ea.a.sendToBack,hc.a.application,Object(I.a)(this,this.qYc,"handleOrganizeAction"),4);this.ia.ra(ea.a.WEf,hc.a.application,Object(I.a)(this,this.Veg,"handleFrontBackFlyout"),4);this.ia.ra(ea.a.yvh,hc.a.application,Object(I.a)(this,this.Veg,"handleFrontBackFlyout"),4);w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&eb.a("DelayRegisterArrangeShapesAction")?this.Cve=()=>{this.ia.ra(ea.a.ttb,hc.a.application,
Object(I.a)(this,this.ufg,"handleOrganizeShapeAnchor"),4)}:this.ia.ra(ea.a.ttb,hc.a.application,Object(I.a)(this,this.ufg,"handleOrganizeShapeAnchor"),4)}pe(){const a=this.FJ.Uo.Fc(jb.a.vg);a.bindAction(x.KeyInputManager.Qa(B.a.vxc,x.KeyInputManager.Re),ea.a.bringForward);a.bindAction(x.KeyInputManager.Qa(B.a.vxc,x.KeyInputManager.Re|4),ea.a.bringToFront);a.bindAction(x.KeyInputManager.Qa(B.a.txc,x.KeyInputManager.Re),ea.a.sendBackward);a.bindAction(x.KeyInputManager.Qa(B.a.txc,x.KeyInputManager.Re|
4),ea.a.sendToBack)}Veg(a,b,c){return 1===c?this.pa.s4()?32:8:32}ufg(){return this.ZJg?32:this.pa.s4()?32:16}qYc(a,b,c){b=this.oq.presentation;if(!b)throw Error.argumentNull("Presentation is null");let f=this.pa.Qf();var l=this.Ga.W$a(f);l&&(this.pa.xpd(l),f=this.pa.Qf());if(!this.pa.s4()||this.qf.eD(f))return 16;if(1===c)return 32;switch(a){case ea.a.bringForward:c=1;break;case ea.a.bringToFront:c=0;break;case ea.a.sendBackward:c=3;break;case ea.a.sendToBack:c=2;break;default:return 8}Nc.a.Kb&&(Nc.a.Kb.vr=
!1,Nc.a.Kb.Oj=!0);1===f.length?xa.a.J(17598029,815,50,"OrganizeShapesActor::HandleOrganizeAction Organizing only one shape."):1<f.length&&xa.a.J(17598031,815,50,"OrganizeShapesActor::HandleOrganizeAction Organizing {0} shapes.",f.length);l=this.Eb.xd(15,void 0,()=>{this.pa.kj();this.Fa.Bd()});try{l.hc(f[0]);l.fd=a;const y=Object(qa.a)(118,b.ZC(f[0].slideId));this.gKk(y,f,c)}finally{l&&l.dispose()}return 32}Wwk(a,b){const c=this.Eb.xd(15,void 0,()=>{this.pa.kj();this.Fa.Bd()});try{const f=this.oq.Ba,
l=f.YC(a),y=f.YC(b);c.hc(l);this.Xwk(f,l.id,y.id)}finally{c&&c.dispose()}}Xnl(){this.ZJg=!0;eb.a("DelayRegisterArrangeShapesAction")&&this.Cve&&this.Cve()}gKk(a,b,c){a&&b&&0<b.length&&xa.a.J(51164099,815,50,"OrganizeShapes has invalid params");let f=Yb.a.clone(a.eb(ab.a.tB));const l=[];let y=null;Yb.a.dqa(b,H=>!H.Ug).length||(y=this.Ga.Cs(b[0]))&&(f=Yb.a.clone(y.eb(ab.a.tB)));for(const H of b)l.push(H.id);a.N5b(c,f,l)&&(y&&y.anchor?y.anchor.smb(f,1,!1):a.anchor?a.anchor.smb(f,1,!1):xa.a.J(51164101,
815,50,"slideNode/groupNode should have valid anchor"))}fKk(a,b,c){var f=this.pa.Xd(),l=this.pgj(f,b);a.reverse();b=new Na.a;f=[];let y=-1,H=!1;for(let ia=0;ia<a.length;ia++){let wa=!1;for(var Q of l)if(Q.equals(a[ia])){b.add(Q);wa=H=!0;break}wa||f.push(a[ia]);c.equals(a[ia])&&(y=ia)}if(H)if(-1===y)xa.a.J(593514880,815,10,"Invalid param endShapeId"),H=!1;else{c=0;Q=a.length;for(l=0;c<y;)a[c++]=f[l++];for(let ia of b)a[c++]=ia;for(;c<Q;)a[c++]=f[l++]}a.reverse();return H}pgj(a,b){let c=[],f=!1;for(const l of a)l.id.equals(b)&&
(f=!0),c.push(l.id);f||(c=[],c.push(b));return c}Xwk(a,b,c){if(a){var f=Yb.a.clone(a.eb(ab.a.tB));var l=this.D0.Vda(b);var y=this.D0.Vda(c);l=this.Ga.Cs(l);y=this.Ga.Cs(y);l?y===l&&(f=Yb.a.clone(l.eb(ab.a.tB))):y&&(c=y.id);this.fKk(f,b,c)&&(xa.a.J(51385985,815,50,"ReorderShapeInSelectionPane : Reorder shape"),l?l.anchor?l.anchor.smb(f,1,!1):xa.a.J(594023564,815,10,"shapeNode should have valid anchor"):a.anchor?a.anchor.smb(f,1,!1):xa.a.J(51385987,815,10,"slideNode should have valid anchor"))}else xa.a.J(51385955,
815,10,"MoveShapeOnTopOfShape has invalid params")}}Object(m.a)(uN,"OrganizeShapesActor",null,[251]);class vN extends ct.a{constructor(a,b,c,f,l,y,H,Q,ia){super();this.bed=0;this.Ve=f;this.Ec=Q;this.pzg=ia;this.init(a);this.$l("PPTClipboardActionOperation");(a=Object(qa.a)(10,H))||(a=new J.DictionaryPropertySet);a.setValue(km.a.Wb,ia);this.zFa(b,c,l,y,a)}NZc(){this.elb(this.Ve)}L8a(a){this.gp=a;this.bed=1}run(){if(0===this.bed){if(1===this.Eoa())return;this.bed=1}1===this.bed&&this.RY();this.Ec.ATj(this.pzg)&&
this.Ec.Mg(!0,this.pzg)}}Object(m.a)(vN,"PPTClipboardActionOperation",ct.a,[1173,337,338]);var wN=d(376),KE=d(546);class Bu{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye,Xd,Xf,ug,qg,Fg,qf,bg){this.ia=a;this.pa=b;this.Fa=c;this.AA=f;this.wfb=l;this.Eb=y;this.YEg=H;this.Rb=Q;this.xfa=ia;this.NFb=wa;this.Ga=Ua;this.gHa=kb;this.tM=Gb;this.o$c=ec;this.lYa=dc;this.wfk=Fc;this.lhc=yc;this.zc=tc;this.Up=xd;this.Rs=Vd;this.eR=Ld;this.Vb=ye;this.Tb=Xd;this.FO=Xf;this.YXa=ug;this.FU=
qg;if(eb.a("RulerIndentBugFix")){if(!Fg)throw Error.argumentNull("paragraphIndentationReader");if(!qf)throw Error.argumentNull("paragraphEditor");}this.J$=Fg;this.xwa=qf;this.VYa=bg}vb(){this.ia.ra(ea.a.$Ne,hc.a.application,Object(I.a)(this,this.zDj,"handlePopulateFontColorDropdown"),101);this.ia.ra(ea.a.Mdh,hc.a.application,Object(I.a)(this,this.BDj,"handlePopulateFontSizeDropdown"),100);this.ia.ra(ea.a.Lja,hc.a.application,Object(I.a)(this,this.jAj,"handleCommitShapeText"),4);this.ia.ra(ea.a.Emd,
hc.a.application,Object(I.a)(this,this.sjh,"queryListCommonLevel"),96);this.ia.ra(ea.a.Tmd,hc.a.application,Object(I.a)(this,this.sjh,"queryListCommonLevel"),96);this.ia.ra(ea.a.Opc,hc.a.application,Object(I.a)(this,this.Mjh,"queryTextListMarkerGallery"),96);this.ia.ra(ea.a.Ppc,hc.a.application,Object(I.a)(this,this.Mjh,"queryTextListMarkerGallery"),96);this.ia.ra(ea.a.Loc,hc.a.application,Object(I.a)(this,this.Afg,"handlePopulateListMarkerDropdown"),100);this.ia.ra(ea.a.Moc,hc.a.application,Object(I.a)(this,
this.Afg,"handlePopulateListMarkerDropdown"),100);this.ia.ra(ea.a.Ire,yb.a.view,Object(I.a)(this,this.oCj,"handleLineSpacingMenuOpen"),68);this.ia.ra(ea.a.v4g,hc.a.application,Object(I.a)(this,this.zCj,"handleMoreFontColors"),96);this.ia.ra(ea.a.Joc,hc.a.application,Object(I.a)(this,this.ACj,"handleMoreFontColorsResponse"),96);this.ia.ya(ea.a.c0a,yb.a.paragraph,Object(I.a)(this,this.c0a,"queryLineSpacing"));this.ia.ya(ea.a.c0a,yb.a.view,this.xfa);this.ia.he(ea.a.c0a,96);this.ia.ya(ea.a.woa,yb.a.paragraph,
Object(I.a)(this,this.R1,"setLineSpacing"));this.ia.ya(ea.a.woa,yb.a.view,this.xfa);this.ia.he(ea.a.woa,68);this.ia.ya(ea.a.wKa,hc.a.application,Object(I.a)(this,this.wKa,"populateLineSpacingFlyout"));this.ia.ya(ea.a.Ldh,hc.a.application,Object(I.a)(this,this.YCj,"handlePandoraEscapeKeyPressed"));this.ia.ya(ea.a.ulb,yb.a.paragraph,Object(I.a)(this,this.zCf,"applySpacingToParagraph"));this.ia.ya(ea.a.ulb,yb.a.view,this.xfa);this.ia.he(ea.a.ulb,4);this.ia.ya(ea.a.tlb,yb.a.paragraph,Object(I.a)(this,
this.zCf,"applySpacingToParagraph"));this.ia.ya(ea.a.tlb,yb.a.view,this.xfa);this.ia.he(ea.a.tlb,4);this.ia.ya(ea.a.nla,yb.a.paragraph,Object(I.a)(this,this.ntb,"applyIndentationToParagraph"));this.ia.ya(ea.a.nla,yb.a.view,this.xfa);this.ia.he(ea.a.nla,4);this.ia.ya(ea.a.WNb,yb.a.paragraph,Object(I.a)(this,this.ntb,"applyIndentationToParagraph"));this.ia.ya(ea.a.WNb,yb.a.view,this.xfa);this.ia.he(ea.a.WNb,4);this.ia.ya(ea.a.YNb,yb.a.paragraph,Object(I.a)(this,this.ntb,"applyIndentationToParagraph"));
this.ia.ya(ea.a.YNb,yb.a.view,this.xfa);this.ia.he(ea.a.YNb,4);this.ia.ya(ea.a.$Nb,yb.a.paragraph,Object(I.a)(this,this.ntb,"applyIndentationToParagraph"));this.ia.ya(ea.a.$Nb,yb.a.view,this.xfa);this.ia.he(ea.a.$Nb,4);this.VYa&&(this.ia.ya(ea.a.XNb,yb.a.paragraph,Object(I.a)(this,this.ntb,"applyIndentationToParagraph")),this.ia.ya(ea.a.XNb,yb.a.view,this.xfa),this.ia.he(ea.a.XNb,4),this.ia.ya(ea.a.ZNb,yb.a.paragraph,Object(I.a)(this,this.ntb,"applyIndentationToParagraph")),this.ia.ya(ea.a.ZNb,yb.a.view,
this.xfa),this.ia.he(ea.a.ZNb,4));this.ia.ra(ea.a.xgh,hc.a.application,Object(I.a)(this,this.IDj,"handlePowerPointTextAlignmentAnchor"),4);this.ia.ra(ea.a.$ld,hc.a.application,Object(I.a)(this,this.JDj,"handlePowerPointTextAnchoringAnchor"),4);this.ia.ya(ea.a.t1,yb.a.view,this.NFb);this.ia.ya(ea.a.s1,yb.a.view,this.NFb);this.ia.ya(ea.a.r1,yb.a.view,this.NFb);this.ia.ya(ea.a.t1,yb.a.outline,Object(I.a)(this,this.nfe,"handlePowerPointTextAnchoring"));this.ia.ya(ea.a.s1,yb.a.outline,Object(I.a)(this,
this.nfe,"handlePowerPointTextAnchoring"));this.ia.ya(ea.a.r1,yb.a.outline,Object(I.a)(this,this.nfe,"handlePowerPointTextAnchoring"));this.ia.he(ea.a.t1,4);this.ia.he(ea.a.s1,4);this.ia.he(ea.a.r1,4);this.ia.ya(ea.a.yLb,yb.a.view,this.NFb);this.ia.ya(ea.a.yLb,yb.a.outline,Object(I.a)(this,this.$Se,"queryTextAnchoring"));this.ia.he(ea.a.yLb,96);this.ia.ya(ea.a.xLb,yb.a.view,this.NFb);this.ia.ya(ea.a.xLb,yb.a.outline,Object(I.a)(this,this.$Se,"queryTextAnchoring"));this.ia.he(ea.a.xLb,96);this.ia.ya(ea.a.wLb,
yb.a.view,this.NFb);this.ia.ya(ea.a.wLb,yb.a.outline,Object(I.a)(this,this.$Se,"queryTextAnchoring"));this.ia.he(ea.a.wLb,96);this.Up&&(this.ia.ra(C.a.zTc,yb.a.view,Object(I.a)(this,this.pBj,"handleFormatPainterPick"),4),this.ia.ra(ea.a.C8d,yb.a.view,Object(I.a)(this,this.kzj,"handleApplyFormatToText"),4),this.ia.ra(C.a.Bka,yb.a.view,Object(I.a)(this,this.oBj,"handleFormatPainterCancel"),4),this.eR.ffi(()=>{this.FO.rWa=this.eR.PL;this.Vb.updateCommandUI()}))}pe(){var a=this.Fa.Fc(jb.a.vQ);const b=
this.Fa.Fc(Oi.a.o3),c=this.Fa.Fc(jb.a.iS),f=x.KeyInputManager.Qa(B.a.mZ,0);a.bindAction(x.KeyInputManager.Qa(B.a.Sxc,0),ea.a.Lja);a.bindAction(f,ea.a.Ldh);c.bindAction(f,ea.a.Lja);b.bindAction(x.KeyInputManager.Qa(B.a.Zxc,2),G.a.ve);a.bindAction(x.KeyInputManager.Qa(B.a.Zxc,2),G.a.ve);this.lYa&&(a.bindAction(x.KeyInputManager.Qa(B.a.rha,5),ea.a.TC),a.bindAction(x.KeyInputManager.Qa(B.a.Eba,5),ea.a.My));this.Up&&(a=this.Fa.Fc(Oi.a.iE),a.Bp(f),a.bindAction(f,C.a.Bka))}pBj(a,b,c){a=this.pa.fo();b=!1;
let f=null,l=this.pa.Pa.mb;const y=!!this.pa.Pa&&this.pa.Pa.Sl;y&&(l=this.pa.Pa.ga(0));l&&(f=l.Va);if(f){switch(f.contextId){case yb.a.textRange:case yb.a.paragraph:case yb.a.endOfParagraph:case yb.a.Mf:b=!0}b&&Mb.SelectionEditor.tk(f)&&cg.b(f)&&(b=!1);f.contextId===yb.a.outline&&a.vd&&(b=!0);a&&!a.fGh&&(b=!1)}if(1===c||!b)return b?32:8;6!==this.ia.eq?(this.eR.PL?xa.a.J(40703699,820,50,"User deactivated the Format Painter button"):(xa.a.J(40703697,820,50,"User activated the Format Painter button"),
this.Afh(l,y,a)),this.eR.PL=!this.eR.PL):(xa.a.J(40703701,820,50,"User picked format from keyboard shortcut"),this.Afh(l,y,a));return 32}Afh(a,b,c){this.eR.Bfh(a);var f=a.Va;const l=Object(qa.a)(kf.AParagraphNode,f.node);var y=Object(qa.a)(875,this.Vb.Kd);let H=null;if(l&&y&&(H=y.Di)){y=this.Eb.je(4);const ia=H.Fi;y.hc(H);var Q=this.Rb.Lc(l);Q.sc(8);const wa=this.zc.Gs(Q);let Ua=f.Sa,kb=f.Mb-f.Sa;a=!a.gda&&a.jf.contextId!==yb.a.endOfParagraph;b?(Ua=0,kb=Db.ParagraphReader.textLength(l)+1):({selectionStart:Ua,
bvh:kb}=this.zHf(f,l,Q,Ua,kb,null,!1),a&&f.contextId===yb.a.textRange&&kb++);b=this.FU.$Ea(ia);f=null;wa&&(Q.Kg(16),f=Object(qa.a)(130,Q.currentNode));Q.eC(8);Q=Object(qa.a)(118,Q.currentNode);this.FU.E9e(b,!0,l.sa(zb.a.fGa,!1),Q,c,f,null,Ua,kb);(c=ia.opc(b))&&H.ACb(c);y.dispose()}}zHf(a,b,c,f,l,y,H){switch(a.contextId){case yb.a.Mf:l=null;H&&(l=this.YXa.l8b(a))?(l=l.Va,f=l.Sa,l=l.Mb-l.Sa):(f=0<f?f-1:0,l=1);break;case yb.a.paragraph:f=0;l=Db.ParagraphReader.textLength(b)+1;break;case yb.a.endOfParagraph:f=
Db.ParagraphReader.textLength(b),l=1}for(c.eC(11);c.qua();)c.Cb(2),(a=Object(qa.a)(kf.AParagraphNode,c.currentNode))&&(f+=Db.ParagraphReader.textLength(a)+1),c.eC(11);if(H)for(c=1;c<y.length;c++)if((H=Object(qa.a)(cb.a,y.ga(c)))&&Db.ParagraphReader.ae(H.node))switch(H.contextId){case yb.a.textRange:l+=H.Mb-H.Sa;break;case yb.a.Mf:l+=1;break;case yb.a.paragraph:l+=Db.ParagraphReader.textLength(H.node)+1;break;case yb.a.endOfParagraph:l+=1}return{selectionStart:f,bvh:l}}kzj(a){if(6===this.ia.eq||this.eR.PL){xa.a.J(40703703,
820,50,"User applied the Format Painter from command location: {0}",this.ia.eq);const H=this.pa.fo();if(H&&!Bu.c3j(H))return 2;var b=this.pa.Pa.mb;if(b&&b.Va){var c=b.Va;const Q=Object(qa.a)(kf.AParagraphNode,c.node);var f=Object(qa.a)(875,this.Vb.Kd),l=null;if(Q&&f&&(l=f.Di)){f=this.Eb.je(15);f.hc(l);f.fd=a;const ia=this.pa.Pa.Sl;a=Q.sa(zb.a.fGa,!1);if(ia)for(var y of this.pa.Pa)this.eR.nCf(y);else this.eR.nCf(b);Nc.a.Kb&&(Nc.a.Kb.Oj=!1,Nc.a.Kb.actionName="FormatPainterApplyToText",Nc.a.Kb.FF=new Date);
const wa=this.Rb.Lc(Q);wa.sc(8);y=c.Sa;let Ua=c.Mb-c.Sa;ia?y=Ua=-1:{selectionStart:y,bvh:Ua}=this.zHf(c,Q,wa,y,Ua,b,!0);wa.Kg(8);b=Object(qa.a)(118,wa.currentNode);c=this.pa.Ev();l=this.FU.$Ea(l.Fi);this.FU.E9e(l,!1,a,b,H,null,c,y,Ua);6!==this.ia.eq&&(this.eR.PL=!1);f.dispose()}}}return 32}YCj(a,b,c,f,l){this.Up&&this.ia.Ka(C.a.Bka,c,l);eb.a("PandoraEscapeKeyPressed")&&this.ia.Ka(ea.a.Lja,c,l);return 32}oBj(){this.FO.rWa&&(this.eR.PL=!1);return 32}IDj(){return this.FWf()}JDj(){return this.FWf()}nfe(a,
b,c){let f=!1;b=this.YEg.Hrj(b);var l=this.pa.un();if(b&&b.YBb||l)f=!0;if(!f)return 16;if(1===c)return 32;switch(a){case ea.a.t1:c=0;break;case ea.a.s1:c=1;break;case ea.a.r1:c=2;break;default:return 8}if(l)this.pa.rH()?this.Rs.Cjl(l,c):(b=this.Eb.je(15),b.hc(l),b.fd=a,this.Rs.Bjl(this.pa.Pa,c),b.dispose());else{l=this.Eb.je(15);try{l.hc(b),l.fd=a,b.setValue(zb.a.xP,c)}finally{l&&l.dispose()}}return 32}$Se(a,b,c,f,l){c=!1;b=this.YEg.B7f(b);f=this.pa.Pa;let y=0;const H=this.pa.un();if(b.Ua(zb.a.xP)||
H){switch(a){case ea.a.yLb:c=H?({Yxa:y}=this.zc.lxd(f)).returnValue&&0===y:0===b.eb(zb.a.xP);break;case ea.a.xLb:c=H?({Yxa:y}=this.zc.lxd(f)).returnValue&&1===y:1===b.eb(zb.a.xP);break;case ea.a.wLb:c=H?({Yxa:y}=this.zc.lxd(f)).returnValue&&2===y:2===b.eb(zb.a.xP)}l.Hf(c);return 32}return 8}sjh(a,b,c,f,l){if(this.pa.Fs())return l.Hf(!1),32;b=this.gHa.mB(this.pa.Yj);c=!0;for(const y of b)if((b=y.Pk?y.node:null)?(c=this.Rb.Lc(b),c.set(b),c.sc(11),c.Kg(11),c=(b=this.AA.Gv(c))?a===ea.a.Emd?1===b.listType:
a===ea.a.Tmd?0===b.listType:!1:!1):c=!1,!c)break;l.Hf(c);return 32}Mjh(a,b,c,f,l){b=l.h0a;l=l.menuItemId;if(this.pa.Fs())return b.Hf(!1),32;f=this.gHa.mB(this.pa.Yj);c=!0;for(const H of f){if(f=H.Pk?H.node:null){var y=this.Rb.Lc(f);y.set(f);y.sc(11);y.Kg(11);if(f=this.AA.Gv(y)){if(0===l){c=!1;break}a===ea.a.Opc?(c=this.tM.HWa.ga(l).U0b,y=this.tM.HWa.ga(l).Xtb,c=f.vzb&&0<f.R9.length&&f.R9[0]===c&&f.cbb&&f.font===y):a===ea.a.Ppc?(c=this.tM.Ahd.ga(l).VVd,c=!!f.propertySet&&f.propertySet.Ua(zb.a.autonumberBulletType)&&
f.propertySet.eb(zb.a.autonumberBulletType)===c):c=!1}else 0!==l&&(c=!1)}if(!c)break}b.Hf(c);return 32}BDj(a,b,c,f,l){if(1===c)return 32;l.PopulationXML=String.format("<Menu Id='menuFontSize'>\r\n               <MenuSection Id='fontSizes'>\r\n                    <Controls Id='ctrlFontSizes'>\r\n                        <Button MenuItemId='8'  Id='8'  Command='{0}' LabelText='8'/>\r\n                        <Button MenuItemId='9'  Id='9'  Command='{0}' LabelText='9'/>\r\n                        <Button MenuItemId='10' Id='10' Command='{0}' LabelText='10'/>\r\n                        <Button MenuItemId='10.5' Id='10.5' Command='{0}' LabelText='10.5'/>\r\n                        <Button MenuItemId='11' Id='11' Command='{0}' LabelText='11'/>\r\n                        <Button MenuItemId='12' Id='12' Command='{0}' LabelText='12'/>\r\n                        <Button MenuItemId='14' Id='14' Command='{0}' LabelText='14'/>\r\n                        <Button MenuItemId='16' Id='16' Command='{0}' LabelText='16'/>\r\n                        <Button MenuItemId='18' Id='18' Command='{0}' LabelText='18'/>\r\n                        <Button MenuItemId='20' Id='20' Command='{0}' LabelText='20'/>\r\n                        <Button MenuItemId='24' Id='24' Command='{0}' LabelText='24'/>\r\n                        <Button MenuItemId='28' Id='28' Command='{0}' LabelText='28'/>\r\n                        <Button MenuItemId='32' Id='32' Command='{0}' LabelText='32'/>\r\n                        <Button MenuItemId='36' Id='36' Command='{0}' LabelText='36'/>\r\n                        <Button MenuItemId='40' Id='40' Command='{0}' LabelText='40'/>\r\n                        <Button MenuItemId='44' Id='44' Command='{0}' LabelText='44'/>\r\n                        <Button MenuItemId='48' Id='48' Command='{0}' LabelText='48'/>\r\n                        <Button MenuItemId='54' Id='54' Command='{0}' LabelText='54'/>\r\n                        <Button MenuItemId='60' Id='60' Command='{0}' LabelText='60'/>\r\n                        <Button MenuItemId='66' Id='66' Command='{0}' LabelText='66'/>\r\n                        <Button MenuItemId='72' Id='72' Command='{0}' LabelText='72'/>\r\n                        <Button MenuItemId='80' Id='80' Command='{0}' LabelText='80'/>\r\n                        <Button MenuItemId='88' Id='88' Command='{0}' LabelText='88'/>\r\n                        <Button MenuItemId='96' Id='96' Command='{0}' LabelText='96'/>\r\n                     </Controls>\r\n               </MenuSection>\r\n            </Menu>",
"2016320825");return 32}zCj(a,b,c,f,l){if(1===c)return this.ia.Ka(ea.a.renderColorPicker,1,l);w.AFrameworkApplication.Ra.Ka(C.a.RKb,2,l);a=new rc.a(l&&0<=l.fontColor&&16777215>=l.fontColor?l.fontColor:0);b={};b.currentColor=a;b.handleCommand=ea.a.Joc;b.hideAlphaSlider=!0;return this.ia.Ka(ea.a.renderColorPicker,2,b)}ACj(a,b,c,f,l){if(1===c)return this.ia.Ka(ea.a.sr,c,l);if(!l)return xa.a.J(595186523,820,10,"HandleMoreFontColorsResponse: actionData is null"),16;if(a=Au.a.parse(l.Color))return a=this.ia.Ka(ea.a.sr,
c,"@"+a.RGBColor),32===a&&this.ia.Ka(ea.a.xCa,c,l),a;xa.a.J(595186521,820,10,"HandleMoreFontColorsResponse: failed to parse colorinfo, colorInfo is null");return 8}zDj(a,b,c,f,l){if(1===c)return 32;a=(a=this.pa.hk())?a.Ed:null;b=ea.a.kya;var y=ea.a.Joc;c=this.Tb.Ef.dda;if(!l.MenuId||0>ma.a.rg(l.MenuId).indexOf("floatie")){f=b.toString();y=y.toString();b=Object.assign(new On.a,{Id:"menuFontColor",MenuSectionList:[]});const H=eb.a("ColorPickerHighlighterFix")?KE.a.themeColors:"Colors";Array.add(b.MenuSectionList,
Xk.e(a,H,"Font.Color.Menu.Controls","fontColor","ThemeFontColorPicker",f,0,!this.lhc));Array.add(b.MenuSectionList,Xk.d("fontColor","Font.Color.Menu.Controls","fontColor","StandardFontColorPicker",f,!0));c&&0<c.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FontRecentColors",!1)),Array.add(b.MenuSectionList,Xk.c(c,"Recent Colors","Font.Color.Menu.Controls","recentColor","FontRecentColors",y,!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FontRecentColors",
!0));Array.add(b.MenuSectionList,Xk.a("More Font Color","Font.Color.Menu.Controls","862825906",ResourceStrings.l_MoreFontColors,"Color.Menu.MoreFontColors","MoreFontColors","per_AppointmentColor0_16x16x32",ResourceStrings.l_MoreFontColorsKeytip));if(eb.a("ColorPickerHighlighterFix")&&(c=new tt,32===w.AFrameworkApplication.Ra.Ka(C.a.RKb,2,c)&&c&&!c.D6b))if(c=c.fontColor,-1===c)Xk.h(b,null,a);else if(c=Si.i(c)||"",c=Au.a.parse(c))c=Ge.Box4ColorHelper.HEa(c.RMa(),a),Xk.h(b,c,a);l.MenuItems=b}else a=
this.wfk.l5f(a,!this.lhc),l.PopulationXML=a.hti(b,c,ea.a.Joc);return 32}jAj(a,b,c){if(!this.pa.pz())return 16;if(1===c)return 32;a=this.pa.Xd();if(!a||1!==a.length)return 16;this.pa.selectShape(a[0],!0);this.Fa.Bd();return 32}oCj(){return 32}wKa(a,b,c,f,l){if(1===c)return 32;a=new On.a;a.MenuSectionList=[];b=Object.assign(new Rk.a,{ControlList:[]});for(c=0;5>c;++c)f=Object.assign(new Vy.a,{Id:"buttonLineSpacing"+Bu.Jre[c].replace(".","_"),LabelText:Bu.Jre[c].substring(0,3),ExternalId:"LineSpacingButton"+
Bu.Jre[c].replace(".","_")}),Array.add(b.ControlList,f);Array.add(a.MenuSectionList,b);l.MenuItems=a;return 32}Afg(a,b,c,f,l){if(1===c)return 32;a=a===ea.a.Loc?1:a===ea.a.Moc?0:14;Nc.a.Kb&&(1===a?Nc.a.Kb.actionName="PowerPointPopulateListMarkerBulletsDropDown":0===a&&(Nc.a.Kb.actionName="PowerPointPopulateListMarkerNumberingsDropDown"));!l.MenuId||0>ma.a.rg(l.MenuId).indexOf("floatie")?l.MenuItems=this.bEi(a):l.PopulationXML=this.cEi(a);return 32}c0a(a,b,c,f,l){var y=l.MenuItemId;a=l.queryResult;
c=l.LineSpacingValue;f=l.LineSpacingUnit;let H=!1;b=this.wfb.VW(b.node);y=ah.a.qz(b.lineSpacing.value,y)&&2===b.lineSpacing.unit;if(-1===c)f=b.lineSpacing.unit,c=b.lineSpacing.value;else if(c!==b.lineSpacing.value||f!==b.lineSpacing.unit)c=f=0;0!==f&&(H=y);a.Hf(H);l.LineSpacingUnit=f;l.LineSpacingValue=c;return 32}R1(a,b,c,f,l){if(1===c)return 32;if(void 0===l||null===l)return xa.a.J(8955530,820,10,"PandoraActor::SetLineSpacing - Null action data passed. "),8;c=this.Eb.je(15);b=b.node;c.hc(b);c.fd=
a;b.setValue(zb.a.qX,2);a=l;this.o$c&&(a+=this.Ga.s9d(this.Ga.vn(b)));b.setValue(zb.a.Jx,a);c.dispose();return 32}zCf(a,b,c,f,l){b=b.node;if(12!==b.type||!l)return 8;c=new wN.a(l.unit,l.value);l=c.unit;c=c.value;switch(a){case ea.a.ulb:b.setValue(zb.a.Gea,c);b.setValue(zb.a.ama,l);break;case ea.a.tlb:b.setValue(zb.a.Fea,c),b.setValue(zb.a.$la,l)}return 32}ntb(a,b,c,f,l){b=b.node;if(12!==b.type||!l)return 8;l=(new vv.a(l.unit,l.value)).oN;c=this.J$.c9(b).oN;f=this.J$.tUa(b);switch(a){case ea.a.nla:b.setValue(Ab.a.nm,
l);break;case ea.a.WNb:b.setValue(Ab.a.uo,l);break;case ea.a.YNb:b.setValue(Ab.a.uo,-l);break;case ea.a.$Nb:b.setValue(Ab.a.uo,0);break;case ea.a.XNb:this.VYa&&b.setValue(Ab.a.uo,l-c);break;case ea.a.ZNb:this.VYa&&(this.xwa.Jv.hlb(b,(1===f.specialIndentType?c+f.oN:c-f.oN)-l),this.xwa.Jv.psd(b,1,l))}return 32}cEi(a){const b=new Sys.StringBuilder;b.append('<Menu Id="menuListMarkersDropDown">');b.append('<MenuSection Id="msListMarkersPosition" ShowMenuSectionSeparator="false" DispalyMode="Menu16">');
b.append('<Gallery Id="galleryListMarkersPosition" Width="3" ElementDimensions="Size48by48">');let c,f,l;switch(a){case 1:c="BulletsLibrary_";f=ea.a.Coa;l=ea.a.NKa;break;case 0:c="NumberingLibrary_";f=ea.a.AKa;l=ea.a.zjb;break;default:c="BulletsLibrary_",f=ea.a.Coa,l=ea.a.NKa}for(let y=0;8>y;++y)b.append(String.format('<GalleryButton Id="{0}" Command="{1}" QueryCommand="{2}" InnerHTML="{3}" Alt="{4}" MenuItemId="{5}" ShouldSetTitle="true" />',c+y,f,l,ma.a.xe(String.format('<DIV class="ListMarkerPreview" style="{0}">{1}</DIV>',
this.Tae(a,y),this.Sae(a,y))),this.N8f(a,y),y));b.append("</Gallery>");b.append("</MenuSection>");b.append("</Menu>");return b.toString()}bEi(a){const b=Object.assign(new On.a,{Id:"menuListMarkersDropDown",MenuSectionList:[]});Array.add(b.MenuSectionList,this.Pxf(a));return b}Pxf(a){var b="",c="";let f="",l=ea.a.Coa,y=ea.a.NKa;switch(a){case 1:b="Bullets Library";f="BulletsLibrary_";l=ea.a.Coa;y=ea.a.NKa;c="BulletLibrarySection";break;case 0:b="Numbering Library",f="NumberingLibrary_",l=ea.a.AKa,
y=ea.a.zjb,c="NumberingLibrarySection"}b=Object.assign(new Rk.a,{Id:"msListMarkersPosition",Title:b,ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]});c=Object.assign(new Cq.a,{Id:"galleryListMarkersPosition",ExternalId:c,ExternalGalleryId:this.jae(a),Type:5,Width:3,ElementDimensions:"Size48by48",GalleryItems:[]});for(let H=0;8>H;++H)c.GalleryItems.push(this.iae(a,H,f+H,l.toString(),y.toString(),this.N8f(a,H)));Array.add(b.ControlList,c);return b}jae(a){switch(a){case 1:return"BulletLibraryGallery";
case 0:return"NumberingLibraryGallery";default:return""}}iae(a,b,c,f,l,y){a=Object.assign(new qz,{LevelInfo:this.$jj(a,b)});a.Id=c;a.Command=f;a.QueryCommand=l;a.Alt=y;a.ShouldSetTitle="true";a.MenuItemId=b.toString();return a}$jj(a,b){const c=[],f={};f.fontFamily=aa.FontUtils.Oja("Calibri");if(!b)return Object.assign(new Tk,{textAtLevel:Box4Intl.Box4Strings.L_ListStyleNone,styleAtLevel:f});f.fontFamily=aa.FontUtils.Oja(this.P8f(a,b));1===a?(a=this.tM.H4c.ga(b).UFf,c.push(Object.assign(new Tk,{textAtLevel:a,
styleAtLevel:f})),c.push(Object.assign(new Tk,{textAtLevel:a,styleAtLevel:f})),c.push(Object.assign(new Tk,{textAtLevel:a,styleAtLevel:f}))):0===a&&(a=this.tM.H4c.ga(b).J6g,c.push(Object.assign(new Tk,{textAtLevel:a[0],styleAtLevel:f})),c.push(Object.assign(new Tk,{textAtLevel:a[1],styleAtLevel:f})),c.push(Object.assign(new Tk,{textAtLevel:a[2],styleAtLevel:f})));return c}N8f(a,b){return 1===a?this.tM.fvg.ga(this.tM.N8b(b)):0===a?this.tM.fvg.ga(this.tM.xXc(b)):""}Sae(a,b){return b?1===a?(a=this.tM.H4c.ga(b).UFf,
this.GKa([a,a,a])):0===a?(a=this.tM.H4c.ga(b).J6g,this.GKa(a)):"":Box4Intl.Box4Strings.L_ListStyleNone}GKa(a){return a&&3===a.length?String.format('<DIV class="ListNumberPreview" style="padding-left: 2pt; font-size: 9pt; ">{0}{1}{2}</DIV>',this.YEa(a[0]),this.YEa(a[1]),this.YEa(a[2])):""}YEa(a){return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',a)}Tae(a,b){const c=new Sys.StringBuilder;c.append("position: relative; ");b?
(c.append("font-family: "),c.append(aa.FontUtils.Oja(this.P8f(a,b))),c.append("; "),c.append("font-size: 24pt;")):(c.append("font-size: 12pt; "),c.append("top: 22%;"));c.append("color: black;");return c.toString()}P8f(a,b){return 1===a?this.tM.HWa.ga(this.tM.N8b(b)).Xtb:0===a?"Calibri":""}FWf(){let a=16;if(this.pa.D9())return 16;const b=this.pa.fo(),c=this.pa.un();if(b&&b.YBb||c)a=32;return a}static c3j(a){return!!a&&(a.eGh||a.vd)}}Bu.Jre=["1.00","1.50","2.00","2.50","3.00"];Object(m.a)(Bu,"PandoraActor",
null,[251]);const xN=a=>{const b=new Sys.StringBuilder;for(let c of a.keys)b.append(String.format('"{0}": "{1}"',c,a.ga(c)));return"{"+b.toString(",")+"}"};var YR=d(763);class ps{constructor(a,b){this.eGd=this.I4a=null;this.Ca=a;this.fBa=b;if(this.vze=w.AFrameworkApplication.fa.ka("HandleRaceConditionInHostManagerInit"))this.eGd=YR.a.create();this.QS=Ib.a.instance.Ia("Common.ISystemInitiatedFeedback")}get PQ(){return this.I4a}vb(){this.Ca.ra(G.a.close,ie.a.frame,Object(I.a)(this,this.closeDocument,
"closeDocument"),2176);this.Ca.ra(G.a.X5b,ie.a.frame,Object(I.a)(this,this.X5b,"fileProperties"),128);this.Ca.ya(G.a.zta,ie.a.frame,Object(I.a)(this,this.zta,"fileSharing"));this.Ca.ya(G.a.zZd,ie.a.frame,Object(I.a)(this,this.zZd,"coEditInTeams"));this.Ca.ra(G.a.copyAndEdit,ie.a.frame,Object(I.a)(this,this.copyAndEdit,"copyAndEdit"),128);this.Ca.ra(G.a.mMb,ie.a.frame,Object(I.a)(this,this.mMb,"replyWithChanges"),128);this.Ca.ra(G.a.Ztc,ie.a.frame,Object(I.a)(this,this.V3i,"fileVersion"),128);this.Ca.ya(G.a.downloadACopy,
ie.a.frame,Object(I.a)(this,this.downloadACopy,"downloadACopy"));this.Ca.ya(G.a.BWi,ie.a.frame,vf.ActionManager.Sg);this.Ca.ra(G.a.mWe,ie.a.frame,Object(I.a)(this,this.mWe,"reportAbuseLink"),128);this.Ca.ra(G.a.zud,ie.a.frame,Object(I.a)(this,this.muc,"signInInternal"),128);this.Ca.ya(G.a.workflow,ie.a.frame,Object(I.a)(this,this.workflow,"workflow"));w.AFrameworkApplication.fa.ka("DocumentNameInJewelInfoMenuIsEnabled")&&this.Ca.ra(G.a.Dmd,ie.a.frame,Object(I.a)(this,this.Dmd,"queryBreadcrumbDocName"),
96);this.Ca.ra(G.a.GRe,ie.a.frame,Object(I.a)(this,this.GRe,"queryCopyAndEditButton"),96);w.AFrameworkApplication.fa.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")&&(this.Ca.ra(G.a.DRe,ie.a.frame,Object(I.a)(this,this.DRe,"queryBuildVersion"),2144),this.Ca.ra(G.a.sSe,ie.a.frame,Object(I.a)(this,this.sSe,"querySessionId"),2144));this.Ca.ya(G.a.O2b,ie.a.frame,Object(I.a)(this,this.O2b,"conversation"));this.fBa.execute(Object(I.a)(this,this.Dmc,"onHostPostmessengerCreated"));ka.ULS.sendTraceTag(536987588,
306,50,"WebAppFrameCommandUIActor-RegisterActions done.")}Dmc(a){this.I4a=a;this.vze&&(this.eGd.instance=a);ka.ULS.sendTraceTag(536987589,306,this.PQ?50:10,String.format("OnHostPostmessengerCreated - Setting OnHostPostmessengerCreated as null value = {0}",!this.PQ))}closeDocument(a,b,c,f,l){a=2===c;c=Bi.h;l&&(c=l);return b&&a&&!this.KKc(c)?8:this.hCi(a,c)}KKc(){return!0}hCi(a,b){if(w.AFrameworkApplication.Aa.ob.U0e("3033402446"))return ka.ULS.sendTraceTag(41231952,306,50,"CloseDocumentInternal - Sending FileClose postMessage to give the host control of closing the page"),
this.lpa(a,Qe.a.A_f,!0,{});if(w.AFrameworkApplication.orc&&b&&b===Bi.f)return ka.ULS.sendTraceTag(6070357,306,50,"CloseDocumentInternal - navigating to ReportAbuseUrl"),w.AFrameworkApplication.Aa.KM(a,w.AFrameworkApplication.orc);if(w.AFrameworkApplication.isEmbedded)return a&&ka.ULS.sendTraceTag(6070358,306,50,"CloseDocumentInternal - cannot close because application is embedded"),8;if(w.AFrameworkApplication.kLf){if(!a)return 32;ka.ULS.sendTraceTag(6070359,306,50,"CloseDocumentInternal - closing the window");
try{return window.top.close(),32}catch(l){return ka.ULS.sendTraceTag(6070360,306,10,"CloseDocumentInternal - encountered unexpected exception: {0}",l),8}}let c=w.AFrameworkApplication.PMc;if(!c)return a&&ka.ULS.sendTraceTag(6070361,306,50,"CloseDocumentInternal - no closeUrl found"),8;b||(b=Bi.h);if(b===Bi.c||b===Bi.h)return w.AFrameworkApplication.Aa.KM(a,c);let f;if(w.AFrameworkApplication.C0a)return a&&ka.ULS.sendTraceTag(6070362,306,50,"CloseDocumentInternal - Using ReplyWithChanges postmessage"),
f=b===Bi.d||b===Bi.b?this.lpa(a,Qe.a.mMb,w.AFrameworkApplication.mxc,{["event_source"]:b}):2,32!==f?(c=b?yg.a.Ti(w.AFrameworkApplication.C0a,Bi.e,b):w.AFrameworkApplication.C0a,w.AFrameworkApplication.Aa.KM(a,c)):f;a&&ka.ULS.sendTraceTag(6070363,306,50,"CloseDocumentInternal - Using FileClose postmessage");f=b===Bi.b?this.lpa(a,Qe.a.A_f,w.AFrameworkApplication.V9e,null):2;return 32!==f?w.AFrameworkApplication.Aa.KM(a,c):f}muc(a,b,c,f,l){a=this.lpa(2===c,Qe.a.zud,!0,l);8===a&&(window.top.location=
w.AFrameworkApplication.signInUrl,a=32);return a}X5b(a,b,c){a=this.lpa(2===c,Qe.a.X5b,w.AFrameworkApplication.nPh,null);return 32!==a?w.AFrameworkApplication.Aa.KM(2===c,w.AFrameworkApplication.F_f):a}zta(a,b,c,f,l){if(1===c)return sz.SessionStatusManager.instance.gla?8:32;a=G.a.Uql;b=Hg.a.create().toString();f={};f.event_source=l;f[ai.a.Btc]=b;var y=l?l.nav:null;y&&(f[ai.a.Xql]=y);(y=l?l.scenarioId:null)&&(f[ai.a.Yql]=y);l&&"CopyLink"===l.SourceControlId&&(l.mode="copy",a=G.a.Tql);l&&"ManageAccess"===
l.SourceControlId&&(l.mode="manageAccess",a=G.a.Vql);l&&"ShareTopBar"===l.SourceControlId&&w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.isTUIEnabledOnShare",!1)&&ps.Lp.raiseEvent(ps.Myi);(y=l?l.mode:null)&&(f[ai.a.Wql]=y);if(w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShareWithSummaryIsEnabled",!1)){var H=l?l.additionalData:null;H&&(f[ai.a.fji]=H)}2===c&&(H={},H[ai.a.Btc]=b,y&&(H.mode=y),ka.ULS.sendTraceTag(38278995,306,50,De.c(H)));
b=this.lpa(2===c,Qe.a.irl,w.AFrameworkApplication.X9e,f);if(32!==b){if(w.AFrameworkApplication.Y5b)return l=l?yg.a.Ti(w.AFrameworkApplication.Y5b,Bi.e,l):w.AFrameworkApplication.Y5b,w.AFrameworkApplication.Aa.KM(2===c,l,!0);ka.ULS.sendTraceTag(7985242,306,50,"Sharing PostMessage didn't succeed but there is no FileSharingURL to fallback to.",{["Result"]:b})}c=pi.a.Y3("PPTIsSimplifiedRibbonOn",!1);ka.ULS.sendTraceTag(509441175,306,15,"ActionName=FileSharing;SimplifiedRibbonMode={0}",c);wn.c(a);return b}zZd(a,
b,c){ka.ULS.sendTraceTag(509613976,230,50,"Attempting to Launch the currently active document in the browser tab in a Word Live Teams Meeting");try{var f=Hg.a.create().toString(),l=ps.UUl,y=w.AFrameworkApplication.fa.Ha("LiveInTeamsWordAppSharingUrl");const dc=new Jh.QueryStringBuilder("https://teams.microsoft.com/l/meeting-share");dc.jg("deeplinkId",f);dc.jg("lm","deeplink");a=dc;var H=a.jg;const Fc=new Uc.a;var Q=Fc.$;const yc=new Jh.QueryStringBuilder(y);yc.jg("auth","2");yc.jg("flight","officeunihost");
yc.jg("source","TEAMS-ELECTRON.meetingStage.deeplink");const tc=new Uc.a;tc.$("fileType",ma.a.AQ(w.AFrameworkApplication.fileName).substring(1,w.AFrameworkApplication.fileName.length));tc.$("objectUrl",w.AFrameworkApplication.fa.Ha("EditDocInClientUrl"));tc.$("baseUrl",w.AFrameworkApplication.du.breadcrumbBrandUrl);y=tc;var ia=y.$;{let Vd=w.AFrameworkApplication.fa.Ha("RootFileId"),Ld=decodeURIComponent(Vd);for(;Vd!==Ld;)Vd=Ld,Ld=decodeURIComponent(Vd);if(32>Vd.length){ka.ULS.sendTraceTag(509440723,
230,15,"Decoded fileId does not match expected format. Decoded id: ${fullyDecodedId}");var wa=""}else{var Ua=Vd.substring(Vd.length-32,Vd.length),kb=Ua.substring(0,8)+"-"+Ua.substring(8,12)+"-"+Ua.substring(12,16)+"-"+Ua.substring(16,20)+"-"+Ua.substring(20,32);RegExp("^(\\{){0,1}[0-9a-fA-F]{8}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{12}(\\}){0,1}$").test(kb)?wa=kb:(ka.ULS.sendTraceTag(509203084,230,15,"Unable to parse the fileId from the WOPISrc ParsedFileId: ${fileIdGuid}"),
wa="")}}ia.call(y,"fileId",wa);const xd=De.c(xN(tc));yc.jg("subEntityId",xd.substring(1,xd.length-1));Q.call(Fc,"appSharingUrl",yc.toString());Fc.$("appId",l);var Gb=xN(Fc);H.call(a,"appContext",Gb);var ec=dc.toString();ka.ULS.sendTraceTag(509138050,230,50,"Launched the currently active document in the browser tab in a Word Live Teams Meeting");return w.AFrameworkApplication.Aa.KM(2===c,ec)}catch(dc){return ka.ULS.sendTraceTag(509138049,230,10,"Failed to launch the currently active document in a Word Live Teams Meeting {0}",
dc),8}}O2b(a,b,c){return this.lpa(2===c,Qe.a.O2b,!0,{})}workflow(a,b,c){a=this.lpa(2===c,Qe.a.workflow,w.AFrameworkApplication.e$e,{["WorkflowType"]:w.AFrameworkApplication.Ixc});if(32!==a){if(w.AFrameworkApplication.Dzd)return w.AFrameworkApplication.Aa.KM(2===c,w.AFrameworkApplication.Dzd,!0);ka.ULS.sendTraceTag(19781538,306,50,"Workflow PostMessage didn't succeed.",{["Result"]:a})}return a}mWe(a,b,c){a=2===c;return b&&a&&!this.KKc(Bi.f)?8:w.AFrameworkApplication.Aa.KM(a,w.AFrameworkApplication.orc)}copyAndEdit(a,
b,c){a={};2===c&&(a=w.AFrameworkApplication.Aa.ob.G5f());a=this.lpa(2===c,Qe.a.copyAndEdit,w.AFrameworkApplication.mPh,a);return 32!==a?w.AFrameworkApplication.Aa.KM(2===c,w.AFrameworkApplication.a0d,w.AFrameworkApplication.hideHeader):a}downloadACopy(a,b,c){return 1===c?w.AFrameworkApplication.cC||w.AFrameworkApplication.VQ||sz.SessionStatusManager.instance.gla?8:32:w.AFrameworkApplication.Aa.KM(2===c,w.AFrameworkApplication.BSa,!0)}mMb(a,b,c){a=2===c;if(b&&a&&!this.KKc(Bi.d))return 8;b=this.lpa(a,
Qe.a.mMb,w.AFrameworkApplication.mxc,{["event_source"]:Bi.d});return 32!==b?(b=yg.a.Ti(w.AFrameworkApplication.C0a,Bi.e,Bi.d),w.AFrameworkApplication.Aa.KM(a,b)):b}V3i(a,b,c){a=this.lpa(2===c,Qe.a.W3i,w.AFrameworkApplication.Y9e,null);return 32!==a?w.AFrameworkApplication.Aa.KM(2===c,w.AFrameworkApplication.j7d):a}Dmd(a,b,c,f,l){if(2===c){if(!l)return 8;l.Value=ma.a.iH(w.AFrameworkApplication.du.rx)}return 32}DRe(a,b,c,f,l){if(2===c){if(!l)return 8;l.Text=w.AFrameworkApplication.instance.PTi}return 32}sSe(a,
b,c,f,l){if(2===c){if(!l)return 8;l.Text=w.AFrameworkApplication.instance.QTi}return 32}lpa(a,b,c,f){return this.vze?this.Ihl(a,b,c,f):c?a?this.PQ.sendMessage(b,f)?32:8:32:2}Ihl(a,b,c,f){return c?a?this.PQ?this.PQ.sendMessage(b,f)?32:8:(ka.ULS.sendTraceTag(528234241,306,15,"SendPostmessage called when HostPostmessenger was not initialized yet.Queueing the request."),this.eGd.execute(()=>{ka.ULS.sendTraceTag(528234242,306,50,"HostPostmessenger now available. Executing the request.");this.PQ.sendMessage(b,
f)}),32):32:2}GRe(a,b,c,f,l){if(2===c){if(!l)return 8;w.AFrameworkApplication.fa.ka("IsEditAndReplyFlow")&&(l.LabelText=CommonUIStrings.l_EditAndReply)}return 32}}ps.Lp=new Pc.a;ps.Myi="CheckEditorSuggestions";ps.UUl="d7958adf-f419-46fa-941b-1b946497ef84";Object(m.a)(ps,"WebAppFrameCommandUIActor",null,[]);class yN extends ps{constructor(a,b,c,f,l,y,H){super(a,b);this.Vu=c;this.ME=f;this.pa=l;this.Ea=y;this.Ya=H}vb(){super.vb();this.Ea.pptEnablePreviousVersionsOptionForOneDriveConsumer&&this.Ca.ya(ea.a.Lgh,
ie.a.frame,Object(I.a)(this,this.$Pe,"pptoShowFileVersion"))}$Pe(a,b,c){return 1===c&&this.Ya.vea?2:this.Ca.processAction(G.a.Ztc,c)}workflow(a,b,c,f,l){if(1===c)return 32;this.pa.nh();this.Vu.E2e(!0,ResourceStrings.l_Loading,a);xa.a.J(20187205,801,50,"PPT save and launch workflow");this.ME.U3(!1,!0,()=>{this.wwi(l)},Object(I.a)(this,this.Qya,"saveFailureCallback"));return 32}KKc(a){return a!==Bi.a||w.AFrameworkApplication.isEmbedded||w.AFrameworkApplication.kLf||w.AFrameworkApplication.PMc||this.s_j()?
!0:(xa.a.J(37007442,306,15,"PptWebAppFrameCommandUIActor::BeforeCloseDocument - CloseUrl is null, fallback to RefreshPage"),this.Ca.Ka(ea.a.refresh,2,{refreshtrigger:"PptWebAppFrameCommandUIActor::BeforeCloseDocument"}),!1)}s_j(){var a=w.AFrameworkApplication.fa.Ha(w.AFrameworkApplication.wK);a=w.AFrameworkApplication.Scb&&!!a&&"teams"===a.toLowerCase();return eb.a("ReactDialogsProtocolLaunchingTeamsFix")&&this.Ea.$4d&&a&&w.AFrameworkApplication.Aa.ob.U0e("3033402446")}wwi(a){this.Vu.hide();super.workflow(0,
null,2,null,a)}Qya(){this.Vu.hide();return!1}}Object(m.a)(yN,"PptWebAppFrameCommandUIActor",ps,[]);class zN{constructor(a,b,c){if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("focusManager");if(!c)throw Error.argumentNull("presentationReader");this.ia=a;this.Fa=b;this.oc=c}vb(){this.ia.ra(ea.a.tpd,hc.a.application,Object(I.a)(this,this.tpd,"replaceFonts"),4)}pe(){const a=[this.Fa.Fc(Oi.a.iE),this.Fa.Fc(Oi.a.o3),this.Fa.Fc(jb.a.vg),this.Fa.Fc(jb.a.vQ)];for(const b of a)b.bindAction(x.KeyInputManager.Qa(B.a.PRb,
x.KeyInputManager.Re),ea.a.tpd)}tpd(a,b,c){return b.contextId!==hc.a.application?2:1===c?this.oc.Cj()?32:8:32}}Object(m.a)(zN,"ReplaceFontsActor",null,[]);class AN extends Sys.EventArgs{constructor(a,b,c){super();this.c7g=a;this.Xfa=b;this.Pu=c}}Object(m.a)(AN,"RibbonTabSwitchedEventArgs",Sys.EventArgs,[]);class BN{constructor(a,b,c,f,l,y,H,Q,ia){if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("frameContext");if(!c)throw Error.argumentNull("ribbonUser");if(!f)throw Error.argumentNull("focusManager");
if(!H)throw Error.argumentNull("ribbonExternal");this.Fa=f;this.ia=a;this.FJ=b;this.uu=c;this.hAg=l;this.le=y;this.uek=Q;this.GHa=ia}vb(){this.ia.ya(G.a.sXe,ie.a.frame,Object(I.a)(this,this.PGk,"onRibbonFocus"));this.ia.ra(G.a.Tcl,ie.a.frame,Object(I.a)(this,this.YEj,"handleRibbonStateChanged"),64);this.ia.ya(G.a.Lwd,hc.a.application,Object(I.a)(this,this.Lwd,"toggleRibbonState"));this.ia.ya(G.a.msh,yb.a.view,Object(I.a)(this,this.ZEj,"handleRibbonTabSwitched"));this.ia.ya(G.a.iqd,yb.a.view,Object(I.a)(this,
this.iqd,"ribbonModeToggledToMLR"));this.ia.ya(G.a.jqd,yb.a.view,Object(I.a)(this,this.jqd,"ribbonModeToggledToSLR"));Pd.a.get_instance().Mj(7,Object(I.a)(this,this.registerOnShyRibbonStateChange,"registerOnShyRibbonStateChange"))}pe(){const a=v.FocusManager.instance().Fc(Oi.a.mGf);D.AFrame.Bk(a,x.KeyInputManager.Qa(B.a.Txc,x.KeyInputManager.Re),G.a.Lwd);D.AFrame.Bk(a,x.KeyInputManager.Qa(z.a.Ik?B.a.Dba:B.a.czd,1),G.a.sXe);D.AFrame.Bk(a,x.KeyInputManager.Qa(B.a.nNa,z.a.Ik?2:1),G.a.sXe);this.uek&&
(this.FJ.Xcb.Bod(oa.a.Tl,window.document,Object(I.a)(this,this.BKj,"ignoreAltKeyUpOnDocument")),rE.a.instance().kTd(Object(I.a)(this,this.vFk,"onOnlyAltKeyPressed")))}iqd(a,b,c){try{if(1===c)return 32;eb.a("ReactMLRReuseSLRCookieForMLR")?this.Yxh(!1):this.Vsc(!0);xa.a.J(512500443,822,50,"[ReactRibbon] - Ribbon mode toggled to MLR");this.GHa&&(this.uu.GYi(),eb.a("toggleChatPPTPane")&&(this.le.ETe(new Ez(!0)),this.Eyf("ChatPPT-Exit")));this.FJ.Vab()}catch(f){xa.a.J(512500442,822,10,"[ReactRibbon] - Error when Ribbon mode toggled to MLR",
f)}return 32}jqd(a,b,c){try{if(1===c)return 32;eb.a("ReactMLRReuseSLRCookieForMLR")||this.Vsc(!1);this.Yxh(!0);xa.a.J(512500441,822,50,"[ReactRibbon] - Ribbon mode toggled to SLR");this.GHa&&(this.uu.STf(),eb.a("toggleChatPPTPane")&&(this.le.ETe(new Ez(!0)),this.Eyf("ChatPPT-Entry")));this.FJ.Vab()}catch(f){xa.a.J(512500440,822,10,"[ReactRibbon] - Error when Ribbon mode toggled to SLR",f)}return 32}Yxh(a){pi.a.oK(w.AFrameworkApplication.fa.Ha("IsSimplifiedRibbonOnCookieName"),a.toString(),pi.a.XJ)}Vsc(a){pi.a.oK(w.AFrameworkApplication.fa.Ha("ReactRibbonMLRPreferenceCookieName"),
a.toString(),pi.a.XJ)}Eyf(a){xa.a.J(509616535,811,15,a)}YEj(a,b,c){if(1===c)return 32;this.FJ.Vab();return 32}Lwd(){return 32}ZEj(a,b,c,f,l){if(!l)return 8;l&&l.NewContextId!==l.OldContextId&&(a=0,l&&l[bn.a.Pu]&&(a=l[bn.a.Pu]),this.le.bZk(new AN(l.OldContextId,l.NewContextId,a)));this.Fa.Ee&&2===l[bn.a.Pu]&&this.Fa.Ee.name===jb.a.Raa&&(b=b.view)&&!ma.a.Xa(b.VI)&&this.Fa.vf(b.VI);return 32}vFk(){EC.a.instance.keyCode===B.a.kNa&&(appChrome.api.inKeytipMode()?appChrome.api.exitKeytipMode():appChrome.api.enterKeytipMode(),
this.Lfg())}BKj(a){return a.mc.keyCode===B.a.kNa}Lfg(){if(document.activeElement&&document.activeElement.id!==se.a.c2b)return this.Fa.aJh(!this.hAg.inKeytipMode,!1),32;this.Fa.Ee&&this.Fa.aJh(this.Fa.Ee.name===jb.a.Raa||this.hAg.inKeytipMode,!0);return 32}PGk(a,b,c){return 1===c?32:this.Lfg()}registerOnShyRibbonStateChange(){w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.ob.Pp&&tg.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((a,b)=>{if(3===a&&3!==b||0===
a&&3===b)xa.a.J(512500439,822,50,"[ReactRibbon] - Ribbon shy mode toggled. Relayout the app."),this.FJ.Vab()})}}Object(m.a)(BN,"RibbonStateActor",null,[251]);class eA{constructor(a,b){this.sectionIndex=a;this.slideIndex=b}}Object(m.a)(eA,"SelectSectionAndSlidesData",null,[]);class CN{constructor(a,b,c,f,l,y,H,Q,ia,wa){this.ZYa=null;if(ia){if(!y)throw Error.argumentNull("SectionActor.workspace");if(!H)throw Error.argumentNull("SectionActor.presentationReader");if(!Q)throw Error.argumentNull("SectionActor.selectionManager");
}this.ia=a;this.tA=b;this.ta=c;this.Yic=f;this.Tu=l;this.Tb=y;this.oc=H;this.pa=Q;this.E5=ia;this.Bn=wa;this.Yic.IF(Object(I.a)(this,this.$B,"onChildTopologyChanged"));this.ta.presentation&&(this.ZYa=this.ta.presentation.Wp)}vb(){this.ia.ra(ea.a.iVe,yb.a.application,Object(I.a)(this,this.GEj,"handleRemoveSection"),4);this.ia.ra(ea.a.Jgd,yb.a.application,Object(I.a)(this,this.FCj,"handleMoveSectionUp"),4);this.ia.ra(ea.a.Igd,yb.a.application,Object(I.a)(this,this.ECj,"handleMoveSectionDown"),4);this.ia.ra(ea.a.F9e,
yb.a.application,Object(I.a)(this,this.rGj,"handleUpdateSectionTitle"),4);this.ia.ra(ea.a.s7a,yb.a.application,Object(I.a)(this,this.Syj,"handleAddSection"),4)}pe(){}rGj(a,b,c,f,l){if(1===c)return(a=this.ta.presentation)&&a.Wp&&a.Wp.length?32:8;if(!l)return xa.a.J(509368192,822,10,"HandleUpdateSectionTitle with null action data."),8;this.tA.R0i(l);return 32}GEj(a,b,c){b=this.ta.yv;const f=this.ta.Jca;if(1===c){const l=this.ta.presentation;if(!l||!l.Wp||!l.Wp.length)return 8;if(!b&&1<l.Wp.length)return f&&
!f.rK.length?32:8}if(2===c){xa.a.J(509368163,822,50,"HandleRemoveSection called.");try{f&&this.tA.K0i(b,a),this.ZYa=this.ta.presentation.Wp,this.ia.Ka(ea.a.nrd,2,new eA(this.ta.yv,this.ta.Ba.slideIndex))}catch(l){xa.a.J(509368162,822,10,"SectionActor: Exception in HandleRemoveSection: {0}.",l)}}return 32}FCj(a,b,c){a=this.ta.yv;if(1===c)return c=this.ta.presentation,!c||!c.Wp||!c.Wp.length||0>=a?8:32;if(2===c){xa.a.J(509368161,822,50,"HandleMoveSectionUp called.");try{-1!==a&&(this.tA.HYf(a,!0),this.ia.Ka(ea.a.nrd,
2,new eA(this.ta.yv,this.ta.Ba.slideIndex)))}catch(f){xa.a.J(509368160,822,10,"SectionActor: Exception in HandleMoveSectionUp: {0}.",f)}}return 32}ECj(a,b,c){a=this.ta.yv;if(1===c)return(c=this.ta.presentation)&&c.Wp&&c.Wp.length&&a!==c.Wp.length-1&&-1!==a?32:8;if(2===c){xa.a.J(509368159,822,50,"HandleMoveSectionDown called.");try{-1!==a&&(this.tA.HYf(a,!1),this.ia.Ka(ea.a.nrd,2,new eA(this.ta.yv,this.ta.Ba.slideIndex)))}catch(f){xa.a.J(509368158,822,10,"SectionActor: Exception in HandleMoveSectionDown: {0}.",
f)}}return 32}Syj(a,b,c){if(2===c){b=-1;c=this.ta.yv;xa.a.J(509368157,822,50,"HandleAddSection called.");try{let f;f=this.E5&&0<=this.Tb.iya?this.oc.gA(this.Tb.iya+1):this.ta.Ba;this.tA.l0i(f,a);b=this.ta.yv;if(this.E5&&(-1!==this.Tb.iya&&(this.Tb.iya=-1,this.Tb.Ba=f),this.Bn)){const l=this.oc.DEa(b).map(H=>this.oc.gA(H));let y;(y=this.pa).rP.apply(y,l)}}catch(f){xa.a.J(509368156,822,10,"SectionActor: Exception in HandleAddSection: {0}.",f)}-1!==b&&b!==c&&this.ia.processAction(ea.a.q7e,2)}return 32}$B(a,
b){try{if(34===b.yW&&!b.node.isDirty){const c=this.ZYa?Array.clone(this.ZYa):null;this.ZYa=Array.clone(this.ta.presentation.Wp);if(!c&&this.ZYa||c.length<this.ZYa.length)2===this.ZYa.length&&-1===this.ta.yv&&(this.ta.yv=1),this.Tu?this.Tu.vTe():xa.a.J(509368155,822,10,"SectionActor: graphOperationEventNotifier is null for raising event."),this.ia.processAction(ea.a.q7e,2)}}catch(c){xa.a.J(509368154,822,10,"SectionActor: Exception in OnChildTopologyChanged: {0}.",c)}}dispose(){this.Yic.oP(Object(I.a)(this,
this.$B,"onChildTopologyChanged"))}}Object(m.a)(CN,"SectionActor",null,[251]);var DN=d(638);class EN{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd){if(!tc)throw Error.argumentNull("viewEventNotifier");this.ia=a;this.qf=b;this.Fa=c;this.jR=f;this.Tb=l;this.ta=y;this.kb=H;this.qD=Q;this.Sb=ia;this.aXa=wa;this.De=Ua;this.Bn=kb;this.WJ=Gb;this.Ga=ec;this.Lw=dc;this.laa=Fc;this.ewa=yc;this.le=tc;this.mjk=xd}vb(){this.ia.ya(ea.a.rwd,hc.a.application,Object(I.a)(this,this.WMb,"selectNextSlideHandler"));
this.ia.ya(ea.a.swd,hc.a.application,Object(I.a)(this,this.WMb,"selectNextSlideHandler"));this.ia.ya(ea.a.A2a,hc.a.application,Object(I.a)(this,this.WMb,"selectNextSlideHandler"));this.ia.ya(ea.a.z2a,hc.a.application,Object(I.a)(this,this.WMb,"selectNextSlideHandler"));this.ia.ya(ea.a.Pmb,hc.a.application,Object(I.a)(this,this.WMb,"selectNextSlideHandler"));this.ia.ya(ea.a.Omb,hc.a.application,Object(I.a)(this,this.WMb,"selectNextSlideHandler"));this.Bn&&(this.ia.ya(ea.a.Tvc,hc.a.application,Object(I.a)(this,
this.lzb,"handleKeyboardMultiSelectSlides")),this.ia.ya(ea.a.Mvc,hc.a.application,Object(I.a)(this,this.lzb,"handleKeyboardMultiSelectSlides")),this.ia.ya(ea.a.Ovc,hc.a.application,Object(I.a)(this,this.lzb,"handleKeyboardMultiSelectSlides")),this.ia.ya(ea.a.Nvc,hc.a.application,Object(I.a)(this,this.lzb,"handleKeyboardMultiSelectSlides")),this.ia.ya(ea.a.Rvc,hc.a.application,Object(I.a)(this,this.lzb,"handleKeyboardMultiSelectSlides")),this.ia.ya(ea.a.Qvc,hc.a.application,Object(I.a)(this,this.lzb,
"handleKeyboardMultiSelectSlides")),this.ia.ya(ea.a.Wqd,hc.a.application,Object(I.a)(this,this.ogl,"selectAllSlidesHandler")),this.ia.ya(ea.a.Z0a,hc.a.application,Object(I.a)(this,this.aFj,"handleScrollSelectedThumbnailsIntoView")));this.ia.ya(ea.a.Lkb,hc.a.application,Object(I.a)(this,this.$Ej,"handleScrollActiveThumbnailIntoViewSlim"));this.ia.ya(ea.a.V1a,hc.a.application,Object(I.a)(this,this.Quh,"selectNextShapeHandler"));this.ia.ya(ea.a.VOb,hc.a.application,Object(I.a)(this,this.Quh,"selectNextShapeHandler"));
this.ia.ya(ea.a.MQb,hc.a.application,Object(I.a)(this,this.yMl,"unselectShapesHandler"));this.ia.ya(ea.a.msc,hc.a.application,Object(I.a)(this,this.ngl,"selectAllShapesHandler"));this.ia.ya(ea.a.ozh,hc.a.application,Object(I.a)(this,this.Bql,"shapeEscapeKeyPressedHandler"));this.ia.ya(ea.a.Wlb,hc.a.application,Object(I.a)(this,this.yYc,"handleSlideScopeArrowKeyboard"));this.ia.ya(ea.a.Xlb,hc.a.application,Object(I.a)(this,this.yYc,"handleSlideScopeArrowKeyboard"));this.ia.ya(ea.a.Ylb,hc.a.application,
Object(I.a)(this,this.yYc,"handleSlideScopeArrowKeyboard"));this.ia.ya(ea.a.Zlb,hc.a.application,Object(I.a)(this,this.yYc,"handleSlideScopeArrowKeyboard"));this.ia.ya(ea.a.kEh,hc.a.application,Object(I.a)(this,this.IFj,"handleSpaceKeyPressed"));this.ia.ya(ea.a.Lfh,hc.a.application,Object(I.a)(this,this.OOk,"playVideoCommandHandler"))}pe(){var a=this.Fa.Fc(Oi.a.iE);const b=this.Fa.Fc(jb.a.vg),c=this.Fa.Fc(jb.a.vQ);a.bindAction(x.KeyInputManager.Qa(B.a.$q,0),ea.a.rwd);a.bindAction(x.KeyInputManager.Qa(B.a.$q,
4),ea.a.swd);a.bindAction(x.KeyInputManager.Qa(B.a.rC,0),ea.a.A2a);a.bindAction(x.KeyInputManager.Qa(B.a.n2,0),ea.a.A2a);a.bindAction(x.KeyInputManager.Qa(B.a.qC,0),ea.a.z2a);a.bindAction(x.KeyInputManager.Qa(B.a.m2,0),ea.a.z2a);a.bindAction(x.KeyInputManager.Qa(B.a.pF,0),ea.a.Pmb);a.bindAction(x.KeyInputManager.Qa(B.a.jx,0),ea.a.Omb);this.Bn&&(a.bindAction(x.KeyInputManager.Qa(B.a.n2,4),ea.a.Tvc),a.bindAction(x.KeyInputManager.Qa(B.a.m2,4),ea.a.Mvc),a.bindAction(x.KeyInputManager.Qa(B.a.pF,4),ea.a.Ovc),
a.bindAction(x.KeyInputManager.Qa(B.a.jx,4),ea.a.Nvc),a.bindAction(x.KeyInputManager.Qa(B.a.rC,4),ea.a.Rvc),a.bindAction(x.KeyInputManager.Qa(B.a.qC,4),ea.a.Qvc),a.bindAction(x.KeyInputManager.Qa(B.a.wNa,2),ea.a.Wqd));b.bindAction(x.KeyInputManager.Qa(B.a.rC,0),ea.a.A2a);b.bindAction(x.KeyInputManager.Qa(B.a.qC,0),ea.a.z2a);b.bindAction(x.KeyInputManager.Qa(B.a.pF,0),ea.a.Pmb);b.bindAction(x.KeyInputManager.Qa(B.a.jx,0),ea.a.Omb);b.bindAction(x.KeyInputManager.Qa(B.a.$q,0),ea.a.V1a);b.bindAction(x.KeyInputManager.Qa(B.a.$q,
4),ea.a.VOb);b.bindAction(x.KeyInputManager.Qa(B.a.mZ,0),ea.a.ozh);b.bindAction(x.KeyInputManager.Qa(B.a.wNa,2),ea.a.msc);b.bindAction(x.KeyInputManager.Qa(B.a.f7,0),ea.a.Wlb);b.bindAction(x.KeyInputManager.Qa(B.a.Eba,0),ea.a.Xlb);b.bindAction(x.KeyInputManager.Qa(B.a.rha,0),ea.a.Ylb);b.bindAction(x.KeyInputManager.Qa(B.a.nZ,0),ea.a.Zlb);a=x.KeyInputManager.Qa(B.a.rC,0);c.Bp(a);c.bindAction(a,ea.a.A2a);a=x.KeyInputManager.Qa(B.a.qC,0);c.Bp(a);c.bindAction(a,ea.a.z2a);b.bindAction(x.KeyInputManager.Qa(B.a.zK,
0),ea.a.kEh)}WMb(a,b,c){if(this.jR.R_||this.qf.$c(this.Tb.Ef))return 16;if(1===c)return 32;if(!this.Tb.Ef||!this.ta.Ba)return 16;32===this.ia.processAction(ea.a.Llc,1)&&this.ia.processAction(ea.a.Klc,2);b=this.nmj(this.ta.Ba,a);if(b===this.ta.Ba.ue)return 32;if(this.Lw&&a!==ea.a.Pmb&&a!==ea.a.Omb&&(a=this.De.IQ(b),!a||!a.UL))return 16;this.Fa.C8===jb.a.vg&&this.Fa.Bd();return this.De.$J(b)}nmj(a,b){a=a.ue;const c=this.Sb.Cj();switch(b){case ea.a.z2a:a=Math.min(a+1,c-1);break;case ea.a.rwd:a=a+1>c-
1?0:a+1;break;case ea.a.A2a:a=Math.max(a-1,0);break;case ea.a.swd:a=0>a-1?c-1:a-1;break;case ea.a.Pmb:a=0;break;case ea.a.Omb:a=c-1}return a}lzb(a,b,c){if(this.jR.R_||this.qf.$c(this.Tb.Ef)||!this.Tb.Ef||!this.ta.Ba)return 16;if(1===c)return 32;32===this.ia.processAction(ea.a.Llc,1)&&this.ia.processAction(ea.a.Klc,2);if(1>=this.Sb.Cj())return 32;xa.a.J(34395531,816,50,"Selected multiple Slides by Shift+Up/Down, Shift+Home/End and Shift+PageUp/PageDown");switch(a){case ea.a.Tvc:case ea.a.Mvc:case ea.a.Ovc:case ea.a.Nvc:this.pGj(a);
break;case ea.a.Rvc:case ea.a.Qvc:this.XCj(a);break;default:return xa.a.J(25751680,816,50,"SelectionActor::HandleKeyboardMultiSelectSlides does not recognize this action"),8}return 32}Fsj(a,b){const c=[];var f=this.Sb.Cj();for(b=b>f-1?f-1:b;a<=b;a++)(f=this.Sb.gA(a))&&c.push(f);return c}pGj(a){if(!this.ta.Ba)throw Error.argumentNull("ActiveSlide is null");const b=this.kb.Se();b.sort((Ua,kb)=>Ua.ue-kb.ue);const c=b[0].ue,f=b[b.length-1].ue,l=this.ta.Ba.ue,y=this.Sb.Cj();var H=[];let Q=l,ia=l,wa=l;
H=!0;switch(a){case ea.a.Tvc:1===b.length?wa=Q=0<=l-1?l-1:l:l===c?ia=0<=f-1?f-1:f:c?wa=Q=c-1:H=!1;break;case ea.a.Mvc:1===b.length?wa=ia=l<y-1?l+1:l:l===c&&f<y-1?wa=ia=f+1:l===c&&f===y-1?H=!1:Q=c+1;break;case ea.a.Ovc:Q=0;break;case ea.a.Nvc:ia=y-1}if(this.Lw&&wa!==l&&(a=this.De.IQ(wa),!a||!a.UL))return;if(H){H=this.Fsj(Q,ia);let Ua;(Ua=this.kb).rP.apply(Ua,H);this.De.Uya(Q===l?ia:Q)}}XCj(a){const b=this.kb.Se();b.sort((ia,wa)=>ia.ue-wa.ue);const c=b[0].ue,f=b[b.length-1].ue,l=this.ta.Ba;if(!l)throw Error.argumentNull("ActiveSlide is null");
const y=l.ue,H=this.Sb.Cj();let Q=null;if(!(1>=H)){switch(a){case ea.a.Rvc:if(!y)break;(Q=this.Sb.gA(y-1))&&1<b.length&&y===f&&this.rtb(b)&&this.kb.Xqc(l);break;case ea.a.Qvc:y!==H-1&&(Q=this.Sb.gA(y+1))&&1<b.length&&y===c&&this.rtb(b)&&this.kb.Xqc(l)}if(Q){if(this.Lw&&(a=Q.tg(this.De.Na),!a||!a.UL))return;this.Tb.Ba=Q;this.kb.t7a(Q);this.De.Uya(Q.ue)}}}rtb(a){if(!a||!a.length)return!1;if(1<a.length)for(let b=0;b<a.length-1;b++)if(1!==a[b+1].ue-a[b].ue)return!1;return!0}aFj(a,b,c){if(!this.Tb.Ef||
!this.ta.Ba||this.qf.$c(this.Tb.Ef))return 16;2===c&&this.De.Z0a();return 32}$Ej(a,b,c){if(!this.Tb.Ef||!this.ta.Ba||this.qf.$c(this.Tb.Ef))return 16;2===c&&this.De.Rqd();return 32}yYc(a,b,c){return this.kb.s4()?this.GCj(a,c):this.gFj(a,c)}gFj(a,b){if(this.Bn&&1!==this.kb.Se().length)return 8;let c;switch(a){case ea.a.Wlb:case ea.a.Ylb:a=ea.a.z2a;c="ThumbnailPageDownNavigation";break;case ea.a.Zlb:case ea.a.Xlb:a=ea.a.A2a;c="ThumbnailPageUpNavigation";break;default:return xa.a.J(8955553,816,50,"SelectionActor::HandleSelectSlideKeyboard does not recognize this action"),
8}Nc.a.Kb&&(Nc.a.Kb.actionName=c,Nc.a.Kb.Oj=!1,Nc.a.Kb.vr=!0);return this.ia.processAction(a,b)}GCj(a,b){switch(a){case ea.a.Wlb:a=ea.a.Flc;break;case ea.a.Xlb:a=ea.a.Glc;break;case ea.a.Ylb:a=ea.a.Hlc;break;case ea.a.Zlb:a=ea.a.Ilc;break;default:return xa.a.J(8955555,816,50,"SelectionActor::HandleMoveShapeKeyboard does not recognize this action"),8}return this.ia.processAction(a,b)}Quh(a,b,c,f,l){if(this.jR.R_)return 16;if(1===c)return 32;b=this.ta.Ba;if(!b)return 16;c=b.Uj();if(!c||!c.length)return 16;
this.Bd();f=this.kb.Qf();if(this.kb.bNb){if(c=this.kb.bNb.tg(this.Tb.fL.Na))c.uge(),c.Pvh(!1);f.length||f.push(this.kb.bNb);this.kb.bNb=null}f&&this.gMa(f,!1);c=null;a===ea.a.V1a?c=l?l:b.nab(f,!1,0):a===ea.a.VOb&&(c=b.nab(f,!0,0));if(!c)return ka.ULS.sendTraceTag(587563472,816,10,"SelectionActor.SelectNextShapeHandler: failed to find next shape to select"),16;if(this.mjk){l=Object(qa.a)(Az.a,c.tg(this.Tb.fL.Na));if(c.Yua&&l&&a===ea.a.VOb){const y=document.getElementById(DN.a.NNe+l.QT);if(y&&document.activeElement!==
y)return l.gMa(),y.focus(),32}if(f.length&&(l=f[0],f=Object(qa.a)(Az.a,l.tg(this.Tb.fL.Na)),l.Yua&&f&&a===ea.a.V1a&&(a=document.getElementById(DN.a.NNe+f.QT))&&document.activeElement!==a))return a.focus(),32}return this.Dih(c,b)}ngl(a,b,c){if(this.jR.R_)return 16;if(1===c)return 32;a=this.ta.Ba;if(!a)return 16;b=a.Uj();if(!b.length)return 16;a=[];for(const f of b)(b=Object(qa.a)(119,f.tg(this.Tb.fL.Na)))&&b.hq?b.gMa():(b&&b.shapeNode&&b.shapeNode.Lv&&b.PY(!1),a.push(f));this.kb.d1a(a,!0);this.WJ.EZk();
this.gMa(a,!0);this.Bd();return 32}ogl(a,b,c){if(1===c)return 32;a=this.ta.presentation;if(!a)throw Error.argumentNull("Presentation is null");a=a.slides||[];if(!a.length)return 16;xa.a.J(34358608,816,50,"Selected All Slides");let f;(f=this.kb).rP.apply(f,a);this.De.Uya(this.Sb.Cj()-1);return 32}Bql(a,b,c){if(1===c)return 32;this.ia.processAction(ea.a.rie,2);this.ia.processAction(ea.a.MQb,2);eb.a("RaiseEscapeKeyPressedEvent")&&this.le.OXk();return 32}yMl(a,b,c){if(!this.kb.rH())return 16;if(1===c)return 32;
this.qD.uRa();a=this.kb.Xd();if(b=this.Ga.W$a(a))return a=this.Ga.Gr(b),this.Dih(a,this.ta.Ba);this.gMa(a,!1);this.kb.nh();this.Bd();return 32}IFj(){this.ia.processAction(ea.a.Lfh,2);this.ewa&&this.ia.processAction(ea.a.JDf,2);return 32}OOk(){if(!this.kb.Nmi()&&!this.kb.Omi())return 2;const a=this.kb.Xd();if(1<a.length)return 2;for(let b=0;b<a.length;b++){const c=this.laa.yUa(a[b]);c&&c.startPlaying()}return 32}Dih(a,b){const c=a.tg(this.Tb.fL.Na);if(c){if(c.hq)return this.kb.nh(),c.gMa(),c.Pvh(!0),
c.eS(),b=null,c.Q4c?b=String.format(ResourceStrings.L_CannotEditHint,c.Q4c.userName):xa.a.J(19140689,828,10,"Shape is locked but the LockOwner is null. Shape: {0}.",c.shapeNode?c.shapeNode.get_shapeId().toString():""),this.aXa.vlh(a,b),this.kb.bNb=a,32}else return ka.ULS.sendTraceTag(587563469,816,10,"SelectionActor.SelectNextShapeHandler: ShapeViewElement of next shape is null"),8;this.kb.selectShape(a,!0);(a=b.tg(this.Tb.fL.Na))&&a.Tya();c&&(c.gMa(),c.eS());return 32}Bd(){this.Tb.fL.qp||this.Fa.Bd()}gMa(a,
b){for(const c of a)(a=c.tg(this.Tb.fL.Na))&&(b?a.gMa():a.uge())}}Object(m.a)(EN,"SelectionActor",null,[251]);class fA{constructor(){this.isHiddenShape=!1;this.shapeName=null;this.shapeId=0;this.key=null;this.isFocussedShape=!1;this.children=null}}Object(m.a)(fA,"SelectionPaneShapeNode",null,[]);var ZR=d(907);class FN{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc){this.aic=this.DR=null;a("powerpoint-editor-intl").then(()=>{xa.a.J(512500438,801,50,"Icons and strings script is loaded successfully");
a("selectionPaneManager").then(()=>{xa.a.J(512500437,801,50,"selection Pane Manager script is loaded successfully");this.DR=selectionPaneManager.FactoryGlobal.getSelectionPaneManagerInstance();this.y4k();ia.Xnl()}).catch(tc=>{xa.a.J(512500436,801,10,"Failed to load selectionPaneManager "+tc.toString())})}).catch(tc=>{xa.a.J(512500435,801,10,"Failed to load powerpoint-editor-intl "+tc.toString())});this.kb=b;this.Vb=c;this.ia=f;this.ta=l;this.Fa=y;this.HA=H;this.XYg=Q;this.pmk=ia;this.Rf=wa;this.nd=
Ua;this.Ic=kb;this.caa=Gb;this.FJ=ec;this.Ga=dc;this.Iz=Fc;this.Eb=yc;this.dxg=!1;this.Rf.FI(Object(I.a)(this,this.k_a,"onChangeRenderSelectionPane"));this.Rf.zCa(Object(I.a)(this,this.k_a,"onChangeRenderSelectionPane"));this.Ic.LQa(Object(I.a)(this,this.k_a,"onChangeRenderSelectionPane"));this.nd.DCa(Object(I.a)(this,this.k_a,"onChangeRenderSelectionPane"));this.Vb.GI(Object(I.a)(this,this.zu,"onAppFrameModeSwitched"));this.SWa=!1;this.tWg=null}dispose(){this.Rf.s6(Object(I.a)(this,this.k_a,"onChangeRenderSelectionPane"));
this.Rf.z0a(Object(I.a)(this,this.k_a,"onChangeRenderSelectionPane"));this.Ic.ekb(Object(I.a)(this,this.k_a,"onChangeRenderSelectionPane"));this.nd.gkb(Object(I.a)(this,this.k_a,"onChangeRenderSelectionPane"));this.Vb.IY(Object(I.a)(this,this.zu,"onAppFrameModeSwitched"))}pe(){const a=this.Fa.Fc(jb.a.cF);a.bindAction(x.KeyInputManager.Qa(B.a.m3a,6),ea.a.ssc);a.bindAction(x.KeyInputManager.Qa(B.a.fqa,6),ea.a.J0b)}ssc(a){return Qg.a("SelectionPaneBringBackward",a,()=>{this.SWa=!0;this.ia.processAction(ea.a.sendBackward,
2);xa.a.J(512500434,822,50,"SelectionPane SendBackwardSelectionPane action is generated");return 32})}J0b(a){return Qg.a("SelectionPaneBringForward",a,()=>{this.SWa=!0;this.ia.processAction(ea.a.bringForward,2);xa.a.J(512500433,822,50,"SelectionPane BringForwardSelectionPane action is generated");return 32})}vb(){this.ia.ra(ea.a.D6,hc.a.application,Object(I.a)(this,this.D6,"showHideSelectionPane"),4);this.ia.ra(ea.a.kLb,hc.a.application,Object(I.a)(this,this.kLb,"querySelectionPane"),96);this.ia.ya(ea.a.ssc,
hc.a.application,Object(I.a)(this,this.ssc,"sendBackwardSelectionPane"));this.ia.ya(ea.a.J0b,hc.a.application,Object(I.a)(this,this.J0b,"bringForwardSelectionPane"))}kLb(a,b,c,f,l){(a=Object(qa.a)(Vh.a,l))&&a.Hf(this.HA.isVisible);return 32}D6(a,b,c){return 1===c?this.DR&&this.ta.Ba?32:8:Qg.a("SelectionPaneOpen",a,()=>{this.HA.isVisible=!this.HA.isVisible;this.Lph();this.HA.isVisible?(this.FJ.notesPane&&this.FJ.notesPane.j0b()&&this.Fa.Bd(),this.Fa.tj(jb.a.cF,!0),this.DR.focusShowAllButton()):this.Fa.tj(jb.a.cF,
!1);return 32})}zu(a){1===a.mode&&this.HA&&this.HA.isVisible&&(this.HA.isVisible=!1,this.Fa.tj(jb.a.cF,!1))}OGi(){const a={};this.aic=new Eb.ScriptSharpLegacyMap;var b=this.ta.Ba,c=b?b.Uj(!0):null;b=this.kb.Qf();const f=new Na.a;let l=0;if(c){c.reverse();for(const H of c)if(!H.isLocal)if(c=this.Iag(H,b),H.Of){if(l++,c=this.Ga.yx(H)){c.reverse();for(const Q of c){c=this.Iag(Q,b);let ia=null;for(const wa of Q.AB){var y=void 0;wa.ShapeId.toString()in a?(y=Object(qa.a)(fA,a[wa.ShapeId.toString()]),this.aic.ga(wa.ShapeId).push(Q.get_shapeId())):
(y=[Q.get_shapeId()],this.aic.add(wa.ShapeId,y),y=this.crj(wa,b),a[wa.ShapeId.toString()]=y,ia?ia.children.push(y):f.add(y));ia=y}ia.children.push(c)}}}else f.add(c)}0<l&&!this.dxg&&(xa.a.J(512500432,822,50,"SelectionPane Group count:{0}",l),this.dxg=!0);return f}Iag(a,b){const c=new fA;c.shapeId=a.get_shapeId();c.key=a.get_shapeId().toString();c.shapeName=a.shapeName;c.isHiddenShape=a.isHiddenShape;c.isFocussedShape=Array.contains(b,a);c.children=[];return c}crj(a,b){const c=new fA;c.shapeId=a.ShapeId;
c.shapeName=a.ShapeName;c.isHiddenShape=a.IsHidden;c.isFocussedShape=!1;const f=this.ta.Ba;if(!f)throw Error.argumentNull("ActiveSlide is null");if(a=f.YC(a.ShapeId))c.isFocussedShape=Array.contains(b,a),c.shapeName=a.shapeName,c.isHiddenShape=a.isHiddenShape;c.children=[];return c}Lph(){if(!this.ta.Ba)this.HA.isVisible=!1;else if(this.HA.isVisible){var a=this.OGi();if(this.YCf(a?a.toArray():null,this.tWg)){this.tWg=a?a.toArray():null;var b=this.caa.Ii("UserAction","SelectionPane Rendering started");
this.DR.renderSelectionPane(ZR.a.cvh,a.toArray());a=b.dr.toString();b.stop();xa.a.J(512500430,822,50,"SelectionPane Rendering Completed. Time(in ms) : {0}",a)}else xa.a.J(512500431,822,50,"SelectionPane Rendering not required.")}}YCf(a,b){if(!a&&b||a&&!b)return!0;if(!a&&!b||!a.length&&!b.length)return!1;if(a.length!==b.length)return!0;for(let c=0;c<a.length;c++){const f=a[c],l=b[c];if(f||l)if(!f&&l||f&&!l||f.shapeId!==l.shapeId||f.key!==l.key||f.shapeName!==l.shapeName||f.isHiddenShape!==l.isHiddenShape||
f.isFocussedShape!==l.isFocussedShape||this.YCf(f.children,l.children))return!0}return!1}k_a(){this.Lph();this.SWa&&(this.HA.isVisible?this.Fa.tj(jb.a.cF,!0):this.Fa.tj(jb.a.cF,!1));this.SWa=!1}W1e(a,b,c){let f;const l=c.AB.length,y=[];f=!1;for(let H=0;H<l;H++){const Q=c.AB[H];Q.ShapeId===a&&(2===b?(Q.IsHidden=!Q.IsHidden,f=Q.IsHidden):0===b?f=Q.IsHidden=!0:1===b&&(f=Q.IsHidden=!1));y.push(Q)}return{returnValue:y,UZj:f}}gyi(a){var b=this.ta.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");
var c=this.aic.ga(a);if(!c||1>=c.length)xa.a.J(512500429,801,10,"There should be atleast 2 child shapes in the nested group");else{var f=b.YC(c[0]);if(f){var l=!1;a=({UZj:l}=this.W1e(a,2,f)).returnValue;for(const y of c){const H=(c=b.YC(y))?Object(qa.a)(119,c.qc(this.Iz)):null;H&&(l?(H.ila(),this.kb.mX(c)&&this.kb.I8(c)):!l&&H.hAa())}b=this.Eb.xd(15);try{b.hc(f),f.AB=a}finally{b&&b.dispose()}}else xa.a.J(512500428,801,10,"ChildShapeNode for nested group with the given Id should not be NULL")}}jCh(a){const b=
this.ta.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");var c=b.Uj(!0),f=[];for(const l of c)if(l.Of){const y=this.Ga.yx(l);f=f.concat.apply(f,y)}if((c=c.concat.apply(c,f))&&c.length){a&&(this.kb.kj(),this.kb.bka(c));for(const l of c)!a&&l.isHiddenShape?Object(qa.a)(119,l.qc(this.Iz)).hAa():a&&!l.isHiddenShape&&Object(qa.a)(119,l.qc(this.Iz)).ila();f=this.Eb.xd(15);try{f.hc(b);for(const l of c)!a&&l.isHiddenShape?l.isHiddenShape=!1:a&&!l.isHiddenShape&&(l.isHiddenShape=!0);for(let l of this.aic)if(!b.YC(l.key)){const y=
l.value;if(!y||1>=y.length){xa.a.J(512500427,801,10,"There should be atleast 2 child shapes in the nested group");continue}const H=b.YC(y[0]);H?(c=[],c=a?this.W1e(l.key,0,H).returnValue:this.W1e(l.key,1,H).returnValue,H.AB=c):xa.a.J(512500426,801,10,"ChildShapeNode for nested group with the given Id should not be NULL")}}finally{f&&f.dispose()}}}y4k(){this.DR.addCloseSelectionPaneEventListener(()=>{xa.a.J(512500425,822,50,"SelectionPane AddCloseSelectionPaneEventListener event is generated");this.HA.isVisible=
!1});this.DR.addFocusSelectionPaneListener(()=>{xa.a.J(512500424,822,50,"SelectionPane AddFocusSelectionPaneListener event is generated");this.Fa.tj(jb.a.cF,!0)});this.DR.addSelectShapeEventListener(a=>{xa.a.J(512500423,822,50,"SelectionPane AddSelectShapeEventListener event is generated");const b=this.ta.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");(a=b.YC(a))&&(a.isHiddenShape||this.kb.selectShape(a,!0))});this.DR.addSelectMultipleShapesEventListener(a=>{xa.a.J(512500422,822,50,"SelectionPane AddSelectMultipleShapesEventListener event is generated");
const b=this.ta.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");Qg.a("SelectionPaneMultiSelect",ea.a.D6,()=>{if(!a.length){var c=this.kb.Xd();this.kb.bka(c)}c=0;for(const f of a){const l=b.YC(f);l&&!l.isHiddenShape&&(c?this.kb.selectShape(l,!1):(this.kb.selectShape(l,!0),c++))}return 32})});this.DR.addToggleVisibilityListener(a=>{xa.a.J(512500421,822,50,"SelectionPane ToggleShapeVisibility event is generated");var b=this.ta.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");const c=
b.YC(a);b="";if(!c||c.Ug||c.Of)b="Group";Qg.b("SelectionPaneToggleVisibilty",b,ea.a.D6,()=>{c?this.XYg.LGl(a):this.gyi(a);return 32})});this.DR.addShapeRenameListener((a,b)=>{xa.a.J(512500420,822,50,"SelectionPane AddShapeRenameListener event is generated");var c=this.ta.Ba;if(!c)throw Error.argumentNull("ActiveSlide is null");c=c.YC(a);let f="";if(!c||c.Ug||c.Of)f="Group";Qg.b("SelectionPaneRename",f,ea.a.D6,()=>{this.XYg.eol(a,b);return 32})});this.DR.addShapeReorderListener((a,b)=>{xa.a.J(512500419,
822,50,"SelectionPane AddShapeReorderListener event is generated");var c=this.ta.Ba;if(!c)throw Error.argumentNull("ActiveSlide is null");const f=c.YC(a);let l="";if(!f||f.Ug||f.Of)l="Group";else if(c=c.YC(b),!c||c.Ug||c.Of)l="Group";Qg.b("SelectionPaneReorder",l,ea.a.D6,()=>{this.pmk.Wwk(a,b);return 32})});this.DR.addShowAllButtonEventListener(()=>{this.SWa=!0;xa.a.J(512500418,822,50,"SelectionPane ShowOrHideAllShapes event is generated");Qg.a("SelectionPaneShowAll",ea.a.D6,()=>{this.jCh(!1);return 32})});
this.DR.addHideAllButtonEventListener(()=>{this.SWa=!0;xa.a.J(512500417,822,50,"SelectionPane AddHideAllButtonEventListener event is generated");Qg.a("SelectionPaneHideAll",ea.a.D6,()=>{this.jCh(!0);return 32})});this.DR.addBringForwardButtonEventListener(()=>{this.SWa=!0;xa.a.J(512500416,822,50,"SelectionPane AddBringForwardButtonEventListener event is generated");Qg.a("SelectionPaneBringForward",ea.a.D6,()=>{this.ia.processAction(ea.a.bringForward,2);return 32})});this.DR.addBringBackwardButtonEventListener(()=>
{this.SWa=!0;xa.a.J(512500387,822,50,"SelectionPane AddBringBackwardButtonEventListener event is generated");Qg.a("SelectionPaneBringBackward",ea.a.D6,()=>{this.ia.processAction(ea.a.sendBackward,2);return 32})});xa.a.J(512500386,822,50,"SelectionPane RegisterSelectionPaneEventListeners is finished")}}Object(m.a)(FN,"SelectionPaneActor",null,[251]);class GN{constructor(a,b,c,f){this.Qea=!1;this.Ghc="ShapeAlignToSelectedObjects";this.ia=a;this.Gb=c;this.kb=b;this.I0=f}vb(){xa.a.J(50630811,822,50,"ShapeAlignmentActor::RegisterActions() - OptIn: True");
this.ia.ra(ea.a.GAf,hc.a.application,Object(I.a)(this,this.MUa,"handleShapesAlignment"),4);this.ia.ra(ea.a.kzh,hc.a.application,Object(I.a)(this,this.MUa,"handleShapesAlignment"),4);this.ia.ra(ea.a.htd,hc.a.application,Object(I.a)(this,this.MUa,"handleShapesAlignment"),4);this.ia.ra(ea.a.stc,hc.a.application,Object(I.a)(this,this.MUa,"handleShapesAlignment"),4);this.ia.ra(ea.a.itd,hc.a.application,Object(I.a)(this,this.MUa,"handleShapesAlignment"),4);this.ia.ra(ea.a.ptc,hc.a.application,Object(I.a)(this,
this.MUa,"handleShapesAlignment"),4);this.ia.ra(ea.a.qtc,hc.a.application,Object(I.a)(this,this.MUa,"handleShapesAlignment"),4);this.ia.ra(ea.a.rtc,hc.a.application,Object(I.a)(this,this.MUa,"handleShapesAlignment"),4);this.ia.ra(ea.a.VDa,hc.a.application,Object(I.a)(this,this.Ufg,"handleShapesDistribution"),4);this.ia.ra(ea.a.y4b,hc.a.application,Object(I.a)(this,this.Ufg,"handleShapesDistribution"),4);this.ia.ra(ea.a.mLb,hc.a.application,Object(I.a)(this,this.mLb,"queryShapeAlignToSlide"),96);this.ia.ya(ea.a.gwc,
hc.a.application,Object(I.a)(this,this.gwc,"toggleShapeAlignToSlide"));this.ia.ra(ea.a.lLb,hc.a.application,Object(I.a)(this,this.lLb,"queryShapeAlignToSelectedObjects"),96);this.ia.ya(ea.a.fwc,hc.a.application,Object(I.a)(this,this.fwc,"toggleShapeAlignToSelectedObjects"))}pe(){}fcc(){return w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.ob.Qp?!0:!1}MUa(a,b,c){if(this.I0){b=this.kb.Xd();for(const l of b)if(!l.eb(zb.a.WVa))return 16}const f=this.kb.Qf();return f?1===c?f.length?32:8:Qg.a("Align",
a,()=>{xa.a.J(50598728,822,50,"ShapeAlignmentActor::HandleShapesAlignment, Align operation performed");const l=[],y=1===f.length||this.Qea?this.p0f(a):this.o0f(a,f);if(null===y)return xa.a.J(50598730,822,10,"ShapeAlignmentActor::HandleShapesAlignment, error in finding reference point"),16;for(const H of f)l.push(new Lv(H,this.Klj(a,H,y)));if(!l[0].shapeNode.Ug)for(const H of l)this.rk(H.shapeNode).setPosition(H.position.x,H.position.y,!0);this.ia.Ka(ea.a.BJa,2,l);return 32}):(xa.a.J(50598726,822,
10,"ShapeAlignmentActor::HandleShapesAlignment, selected nodes: null"),16)}mLb(a,b,c,f,l){if(!l||!Object(Wa.a)(Vh.a,l))return xa.a.J(50598732,822,10,"ShapeAlignmentActor::QueryShapeAlignToSlide Invalid actionData"),8;l.Hf(this.Qea);xa.a.J(50598734,822,50,"ShapeAlignmentActor::QueryShapeAlignToSlide: Align to Slide button is selected");return 32}gwc(a,b,c,f,l){a=this.kb.Qf();if(1===c)return 2>a.length&&(this.Qea=!0,this.Ghc="ShapeAlignToSlide",xa.a.J(50598736,822,50,"ShapeAlignmentActor::ToggleShapeAlignToSlide single shape selected, enable Align to slide button")),
32;if(!l||"object"!==typeof l)return xa.a.J(50598738,822,10,"ShapeAlignmentActor::ToggleShapeAlignToSlide requires actionData"),8;this.KMh(l)&&(this.Qea=!0,xa.a.J(50598740,822,50,"ShapeAlignmentActor::ToggleShapeAlignToSlide: Align to slide is enabled"));return 32}lLb(a,b,c,f,l){if(!l||!Object(Wa.a)(Vh.a,l))return xa.a.J(50598742,822,10,"ShapeAlignmentActor::QueryShapeAlignToSelectedObjects Invalid actionData"),8;l.Hf(!this.Qea);xa.a.J(50598744,822,50,"ShapeAlignmentActor::QueryShapeAlignToSelectedObjects: Align Selected Objects button is enabled");
return 32}fwc(a,b,c,f,l){a=this.kb.Qf();if(1===c)return 1<a.length?32:8;if(!l||"object"!==typeof l)return xa.a.J(50598746,822,10,"ShapeAlignmentActor::ToggleShapeAlignToSelectedObjects requires actionData"),8;this.KMh(l)&&(this.Qea=!1,xa.a.J(50598748,822,50,"ShapeAlignmentActor::ToggleShapeAlignToSelectedObjects: Align Selected Objects is enabled"));return 32}Klj(a,b,c){let f=null;var l=this.rk(b);b=l.wUc();l=l.ys();switch(a){case ea.a.htd:xa.a.J(50598750,822,50,"ShapeAlignmentActor::ShapeAlignLeft: Align Left is selected ");
f=new Zc.a(b.x-l.ic+c,b.y);break;case ea.a.stc:xa.a.J(50598752,822,50,"ShapeAlignmentActor::ShapeAlignRight: Align Right is selected");f=new Zc.a(b.x+(c-l.fc),b.y);break;case ea.a.itd:xa.a.J(50598754,822,50,"ShapeAlignmentActor::ShapeAlignTop: Align Top is selected");f=new Zc.a(b.x,b.y-l.kc+c);break;case ea.a.ptc:xa.a.J(50598784,822,50,"ShapeAlignmentActor::ShapeAlignBottom: Align Bottom is selected");f=new Zc.a(b.x,b.y+(c-l.Zb));break;case ea.a.qtc:xa.a.J(50598786,822,50,"ShapeAlignmentActor::ShapeAlignCenter: Align Center is selected");
f=new Zc.a(b.x+(c-l.Zf().x),b.y);break;case ea.a.rtc:xa.a.J(50598788,822,50,"ShapeAlignmentActor::ShapeAlignMiddle: Align Middle is selected"),f=new Zc.a(b.x,b.y+(c-l.Zf().y))}return f}Ufg(a,b,c){const f=this.kb.Qf();return f?1===c?!f.length||2===f.length&&!this.Qea?8:32:Qg.a("Align",a,()=>{xa.a.J(50902275,822,50,"ShapeAlignmentActor::HandleShapesDistribution, Distribute operation performed");this.g3e(f,a,0,f.length-1);var l=1===f.length||2===f.length||this.Qea?this.p0f(a):this.o0f(a,f);if(null===
l)return xa.a.J(527013341,815,10,"ShapeAlignmentActor::HandleShapesDistribution, error in finding reference point"),16;var y=l-this.gwi(a,f);l=this.Qvi(f,y);y=this.Uvi(a,f,y,l);this.GVi(a,f,f.length-1,l,y);return 32}):(xa.a.J(50902273,822,10,"ShapeAlignmentActor::HandleShapesDistribution, selected nodes: null"),16)}gwi(a,b){return a===ea.a.VDa?this.hwi(b):this.iwi(b)}hwi(a){let b=0;for(const c of a)a=this.rk(c),b+=a.ys().Zb-a.ys().kc;return b}iwi(a){let b=0;for(const c of a)a=this.rk(c),b+=a.ys().fc-
a.ys().ic;return b}Uvi(a,b,c,f){if(1===b.length||this.Qea)return 0<c?f:0;b=this.rk(b[0]);return a===ea.a.VDa?b.ys().Zb+f:b.ys().fc+f}Qvi(a,b){return(1===a.length||this.Qea)&&0<b?1*b/(a.length+1):1*b/(a.length-1)}GVi(a,b,c,f,l){var y=0;const H=[];1<b.length&&!this.Qea?(xa.a.J(50902277,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute: Align to Selected Objects"),y++,c--):xa.a.J(50902279,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute: Align to Slide");for(a===ea.a.VDa?xa.a.J(50902281,
822,50,"ShapeAlignmentActor::DistributeShapes, Distribute Vertically"):xa.a.J(50902283,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute Horizontally");y<=c;y++){const ia=b[y];if(!ia)continue;let wa=this.rk(ia);if(wa){var Q=wa.wUc();a===ea.a.VDa?(Q=new Zc.a(Q.x,l),H.push(new Lv(ia,Q)),l+=wa.ys().Zb-wa.ys().kc+f):(Q=new Zc.a(l,Q.y),H.push(new Lv(ia,Q)),l+=wa.ys().fc-wa.ys().ic+f)}}if(H[0]&&!H[0].shapeNode.Ug)for(const ia of H)this.rk(ia.shapeNode).setPosition(ia.position.x,ia.position.y,!0);
this.ia.Ka(ea.a.BJa,2,H)}p0f(a){const b=Object(qa.a)(340,this.kb.hk().qc(this.Gb.Na));if(!b)return xa.a.J(51500956,822,10,"ShapeAlignmentActor::FindReferencePointRelativeToSlide,Error in finding reference point: SlideViewElement is NULL, ActionID: {0}",a),null;switch(a){case ea.a.stc:case ea.a.y4b:return b.gC.clientWidth;case ea.a.ptc:case ea.a.VDa:return b.gC.clientHeight;case ea.a.qtc:return b.gC.clientWidth/2;case ea.a.rtc:return b.gC.clientHeight/2;default:return xa.a.J(51500958,822,10,"ShapeAlignmentActor::FindReferencePointRelativeToSlide, Error in finding reference point, ActionID: {0}",
a),0}}o0f(a,b){switch(a){case ea.a.htd:var c=Number.MAX_VALUE;for(const y of b)b=this.rk(y),c=Math.min(b.ys().ic,c);return c;case ea.a.stc:c=-Number.MAX_VALUE;for(const y of b)b=this.rk(y),c=Math.max(b.ys().fc,c);return c;case ea.a.itd:c=Number.MAX_VALUE;for(const y of b)b=this.rk(y),c=Math.min(b.ys().kc,c);return c;case ea.a.ptc:c=-Number.MAX_VALUE;for(const y of b)b=this.rk(y),c=Math.max(b.ys().Zb,c);return c;case ea.a.qtc:var f=Number.MAX_VALUE,l=-Number.MAX_VALUE;for(c of b)b=this.rk(c),f=Math.min(b.ys().ic,
f),l=Math.max(b.ys().fc,l);return f+(l-f)/2;case ea.a.rtc:c=Number.MAX_VALUE;l=-Number.MAX_VALUE;for(f of b)b=this.rk(f),c=Math.min(b.ys().kc,c),l=Math.max(b.ys().Zb,l);return c+(l-c)/2;case ea.a.VDa:c=Number.MAX_VALUE;f=-Number.MAX_VALUE;for(l of b)b=this.rk(l),c=Math.min(c,b.ys().kc),f=Math.max(b.ys().Zb,f);return f-c;case ea.a.y4b:c=Number.MAX_VALUE;f=-Number.MAX_VALUE;for(const y of b)b=this.rk(y),c=Math.min(c,b.ys().ic),f=Math.max(b.ys().fc,f);return f-c;default:return xa.a.J(51500960,822,10,
"ShapeAlignmentActor::FindReferencePointRelativeToSelectedObjects, Error in finding reference point, ActionID: {0}, No of selectedNodes: {1}",a,b.length),null}}g3e(a,b,c,f){if(!(c>=f)){var l=this.dNk(a,b,c,f);this.g3e(a,b,c,l-1);this.g3e(a,b,l+1,f)}}dNk(a,b,c,f){if(b===ea.a.VDa)return this.fNk(a,c,f);if(b===ea.a.y4b)return this.eNk(a,c,f);xa.a.J(50902285,822,10,"ShapeAlignmentActor::SortSelectedShapes:PartitionSelectedNodesList, actionId not supported");return-1}fNk(a,b,c){var f=this.rk(a[c]).ys().Zf().y;
let l=b-1;for(;b<=c-1;b++)if(this.rk(a[b]).ys().Zf().y<f){l++;const y=a[l];a[l]=a[b];a[b]=y}f=a[l+1];a[l+1]=a[c];a[c]=f;return l+1}eNk(a,b,c){var f=this.rk(a[c]).ys().Zf().x;let l=b-1;for(;b<=c-1;b++)if(this.rk(a[b]).ys().Zf().x<f){l++;const y=a[l];a[l]=a[b];a[b]=y}f=a[l+1];a[l+1]=a[c];a[c]=f;return l+1}KMh(a){const b=a.SourceControlId;return a[wh.a.On]&&this.Ghc!==b?(this.Qea="ShapeAlignToSelectedObjects"===this.Ghc,this.fcc()&&(a={},a[b]="ToggleButtonModel",a[this.Ghc]="ToggleButtonModel",Rc.App.Lb.BG(a)),
this.Ghc=b,!0):!1}rk(a){return a?Object(qa.a)(119,a.qc(this.Gb.Na)):null}}Object(m.a)(GN,"ShapeAlignmentActor",null,[251]);var HN=d(510),$R=d(977);class ey{}Object(m.a)(ey,"CT_NoFillProperties",null,[]);var aS=d(978);class gA{constructor(a,b){this.TEl=a;this.rvc=b}}Object(m.a)(gA,"FormatPainterData",null,[]);var IN=d(745);class qi{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye){this.RCl="data:image/svg+xml;charset=utf8,";this.bPe=96;this.ia=a;this.pa=H;this.ke=f;this.Eb=c;this.Fa=
b;this.qD=l;this.$b=y;this.Eze=ia;this.AJ=Q;this.VBe=Ua;this.sKg=(a=!tc||!tc.isInHighContrastMode)&&yc.vme;this.PX=yc.powerPointGraphicToolTabIsEnabled;this.yBe=a&&yc.svgIconLocalEditingIsEnabled;this.Ygb=wa;this.Iz=ye;this.Ga=kb;this.eR=Gb;this.FU=ec;this.Tb=dc;this.ta=Fc;this.zc=xd;this.Up=yc.pptTextFormatPainterIsEnabled;this.hEg=yc.formatPainterApplyRemappedIsEnabled;this.fKg=yc.Y2c;this.lfb=yc.cSk;this.vU=yc.sKb;this.la=yc;this.ij=Vd;this.Ahc=new Eb.ScriptSharpLegacyMap;this.JA=Ld}vb(){this.ia.ra(ea.a.tPe,
hc.a.application,Object(I.a)(this,this.DDj,"handlePopulateShapeFillMenu"),96);this.ia.ra(ea.a.RIe,hc.a.application,Object(I.a)(this,this.yCj,"handleMoreFillColors"),96);this.ia.ra(ea.a.SIe,hc.a.application,Object(I.a)(this,this.DCj,"handleMoreOutlineColors"),96);this.ia.ra(ea.a.ICa,hc.a.application,Object(I.a)(this,this.veg,"handleApplyShapeFillColor"),4);this.ia.ra(ea.a.iKc,hc.a.application,Object(I.a)(this,this.rzj,"handleApplyShapeFillCustomColor"),4);this.ia.ra(ea.a.ltb,hc.a.application,Object(I.a)(this,
this.veg,"handleApplyShapeFillColor"),4);this.ia.ra(ea.a.Uod,hc.a.application,Object(I.a)(this,this.Efg,"handleRemoveShapeFill"),4);this.ia.ra(ea.a.YUe,hc.a.application,Object(I.a)(this,this.Efg,"handleRemoveShapeFill"),4);this.ia.ra(ea.a.Pld,hc.a.application,Object(I.a)(this,this.EDj,"handlePopulateShapeOutlineMenu"),96);this.ia.ra(ea.a.nja,hc.a.application,Object(I.a)(this,this.weg,"handleApplyShapeOutlineColor"),4);this.ia.ra(ea.a.jKc,hc.a.application,Object(I.a)(this,this.szj,"handleApplyShapeOutlineCustomColor"),
4);this.ia.ra(ea.a.mtb,hc.a.application,Object(I.a)(this,this.weg,"handleApplyShapeOutlineColor"),4);this.ia.ra(ea.a.WQa,hc.a.application,Object(I.a)(this,this.wzj,"handleApplyShapeOutlineWidth"),4);this.ia.ra(ea.a.G7a,hc.a.application,Object(I.a)(this,this.tzj,"handleApplyShapeOutlineDashStyle"),4);this.fKg&&this.ia.ra(ea.a.H7a,hc.a.application,Object(I.a)(this,this.vzj,"handleApplyShapeOutlineSketchStyle"),4);this.ia.ra(ea.a.oja,hc.a.application,Object(I.a)(this,this.uzj,"handleApplyShapeOutlineEndStyle"),
4);this.ia.ra(ea.a.Vod,hc.a.application,Object(I.a)(this,this.Ffg,"handleRemoveShapeOutline"),4);this.ia.ra(ea.a.ZUe,hc.a.application,Object(I.a)(this,this.Ffg,"handleRemoveShapeOutline"),4);this.ia.ra(ea.a.uTa,hc.a.application,Object(I.a)(this,this.hGj,"handleToggleFormatPainterActive"),4);this.ia.ra(ea.a.Aka,hc.a.application,Object(I.a)(this,this.izj,"handleApplyFormat"),4);this.ia.ra(ea.a.B8d,hc.a.application,Object(I.a)(this,this.jzj,"handleApplyFormatToShape"),5);this.ia.ra(ea.a.Ymd,hc.a.application,
Object(I.a)(this,this.VDj,"handleQueryFormatPainter"),97);this.ia.ra(ea.a.AKb,hc.a.application,Object(I.a)(this,this.KDj,"handlePreviewShapeFillColor"),4);this.ia.ra(ea.a.CMb,hc.a.application,Object(I.a)(this,this.XEj,"handleRevertPreviewShapeFillColor"),4)}pe(){const a=this.Fa.Fc(jb.a.vg);a.bindAction(x.KeyInputManager.Qa(B.a.tAa,6),ea.a.uTa);const b=this.Fa.Fc(jb.a.vQ);let c=x.KeyInputManager.Qa(B.a.tAa,6);b.Bp(c);this.Up?b.bindAction(c,C.a.zTc):b.bindAction(c,ea.a.uTa);xa.a.J(512500379,815,50,
"formatPainterApplyRemapped: {0}",this.hEg);this.hEg||(c=x.KeyInputManager.Qa(B.a.n3a,6),a.bindAction(c,ea.a.Aka),b.Bp(c),this.Up?b.bindAction(c,ea.a.C8d):b.bindAction(c,ea.a.Aka))}lyb(a,b){const c=[];if(a)for(const f of a)(f.Tua||b&&f.get_isSVGBlipFilled()||f.qj||this.vU&&1===f.mediaType)&&Array.add(c,f);return c}Z$a(a,b){const c=[];if(a)for(const f of a)(f.Tua&&!f.rz||b&&f.get_isSVGBlipFilled()||this.lfb&&f.vd)&&Array.add(c,f);return c}DDj(a,b,c,f,l){if(!this.pa.s4()||this.$b.eD(this.pa.Xd()))return 16;
if(1===c)return 32;if(!l)return 8;b=this.ta.presentation;if(!b)throw Error.argumentNull("Presentation is null");a=b.dda;b=(c=this.pa.fo())?b.ZC(c.slideId):null;if(!b)return 16;var y=!!l.MenuId&&-1!==l.MenuId.indexOf("Graphics");c=y?ea.a.ltb:ea.a.ICa;f=y?ea.a.YUe:ea.a.Uod;const H=ea.a.RIe;if(l.MenuId&&"fill"===l.MenuId){var Q=new IN.a(b.Ed);y=new Sys.StringBuilder;y.append(String.format(qi.NGf,"PptRibbon.Drawing.ShapeFill"));if(!b.Ed)return 8;y.append(Q.qee(c,a,ea.a.iKc));y.append(qi.TGf);y.append(String.format(qi.RGf,
f,w.AFrameworkApplication.Cm,ResourceStrings.L_RemoveShapeFill,CommonUIStrings.l_RemoveShapeFillKeytip));y.append(qi.SGf);y.append(qi.Gui);y.append(String.format(qi.Eui,H,w.AFrameworkApplication.Cm,ResourceStrings.L_MoreFillColors,CommonUIStrings.l_MoreFillColorsKeytip));y.append(qi.Fui);y.append(qi.MGf);l.PopulationXML=y.toString()}else{Q=Object.assign(new On.a,{Id:"PptRibbon.Drawing.ShapeFill",MenuSectionList:[]});const ia=y?"StandardGraphicFillColorPicker":"StandardShapeFillColorPicker",wa=y?"GraphicNoFill":
"ShapeNoFill";Array.add(Q.MenuSectionList,Xk.f(b.Ed,KE.a.themeColors,"Color.Menu.Controls","themeColor",y?"ThemeGraphicFillColorPicker":"ThemeShapeFillColorPicker",c.toString(),1));Array.add(Q.MenuSectionList,Xk.d("Standard Colors","Color.Menu.Controls","standardColor",ia,c.toString(),!1));a&&0<a.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeFillRecentColors",!1)),Array.add(Q.MenuSectionList,Xk.c(a,"Recent Colors","Color.Menu.Controls","recentColor","ShapeFillRecentColors",
"3745557472",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeFillRecentColors",!0));Array.add(Q.MenuSectionList,Xk.b("Remove Color","Color.Menu.Controls",f.toString(),ResourceStrings.L_RemoveShapeFill,"Color.Menu.RemoveColor",wa,"per_AppointmentColor0_16x16x32",CommonUIStrings.l_RemoveShapeFillKeytip));Array.add(Q.MenuSectionList,Xk.a("More Fill Color","Color.Menu.Controls",H.toString(),ResourceStrings.L_MoreFillColors,"Color.Menu.MoreFillColor","MoreFillColors","per_AppointmentColor0_16x16x32",
CommonUIStrings.l_MoreFillColorsKeytip));eb.a("ColorPickerHighlighterFix")&&(a=this.Oqj(b.Ed),Xk.h(Q,a,b.Ed));l.MenuItems=Q}return 32}EDj(a,b,c,f,l){a=this.ta.presentation;if(!a)throw Error.argumentNull("Presentation is null");if(!this.pa.s4()||this.$b.eD(this.pa.Xd()))return 16;if(1===c)return 32;if(!l)return 8;c=(c=this.pa.fo())?a.ZC(c.slideId):null;if(!c||!c.Ed)return 8;a=a.dda;var y=this.ke.qk("pegal.png"),H=!!l.MenuId&&-1!==l.MenuId.indexOf("Graphics");b=H?ea.a.mtb:ea.a.nja;f=H?ea.a.ZUe:ea.a.Vod;
const Q=ea.a.SIe;if(l.MenuId&&"outline"===l.MenuId){var ia=new Sys.StringBuilder;ia.append(String.format(qi.NGf,"PptRibbon.Drawing.ShapeOutline"));c=new IN.a(c.Ed);ia.append(c.qee(b,a,ea.a.jKc));ia.append(qi.TGf);ia.append(String.format(qi.RGf,f,w.AFrameworkApplication.Cm,ResourceStrings.L_RemoveShapeOutline,CommonUIStrings.l_RemoveShapeOutlineKeytip));ia.append(qi.SGf);ia.append(qi.Jui);ia.append(String.format(qi.Hui,Q,w.AFrameworkApplication.Cm,ResourceStrings.L_MoreOutlineColors,CommonUIStrings.l_MoreOutlineColorsKeytip));
ia.append(qi.Iui);c=this.pa.Xd();a=qi.pqj(c,this.PX);if(!a||!a.length||c&&c.length!==a.length)ia.append('<MenuSection Id="OutlineEffects"><Controls Id="OutlineControls">'),ia.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineWeightAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_GalLineWidth_16x16x32"\r\n                   LabelText="{3}"\r\n                   Keytip="{9}">\r\n                   <Menu Id="MenuOutlineWeight">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineWeight" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineWeight.Controls">\r\n                         <Button\r\n                            Id="OutlineWidthPresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle1_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineWidthPresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle2_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineWidthPresent,3"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle3_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         <Button\r\n                            Id="OutlineWidthPresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle4_16x16x32"\r\n                            LabelText="{7}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
ea.a.nKc,ea.a.WQa,w.AFrameworkApplication.Cm,ResourceStrings.L_ApplyShapeOutlineWidth,ResourceStrings.L_ApplyShapeOutlineWidth_1,ResourceStrings.L_ApplyShapeOutlineWidth_2,ResourceStrings.L_ApplyShapeOutlineWidth_3,ResourceStrings.L_ApplyShapeOutlineWidth_4,y,CommonUIStrings.l_ApplyShapeOutlineWidthKeytip)),ia.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineDashesAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_DashStyle_16x16x32"\r\n                   LabelText="{3}"\r\n                   Keytip="{8}">\r\n                   <Menu Id="MenuOutlineDashStyle">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineDashStyle" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineDashStyle.Controls">\r\n                         <Button\r\n                            Id="OutlineDashStylePresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{7}"\r\n                            Image16by16Class="pegal_DashStyle1_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineDashStylePresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{7}"\r\n                            Image16by16Class="pegal_DashStyle2_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineDashStylePresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{7}"\r\n                            Image16by16Class="pegal_DashStyle3_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
ea.a.kKc,ea.a.G7a,w.AFrameworkApplication.Cm,ResourceStrings.L_ApplyShapeOutlineDashStyle,ResourceStrings.L_ApplyShapeOutlineDashStyle_1,ResourceStrings.L_ApplyShapeOutlineDashStyle_2,ResourceStrings.L_ApplyShapeOutlineDashStyle_3,y,CommonUIStrings.l_PPTApplyShapeOutlineDashStyleKeytip)),this.fKg&&ia.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineSketchesAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_GalLineSketchy_16x16x32"\r\n                   LabelText="{3}">\r\n                   Keytip="{9}">\r\n                   <Menu Id="MenuOutlineSketchStyle">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineSketchStyle" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineSketchStyle.Controls">\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchNone_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchSubtleCurve_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,3"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchSubtleWave_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchIntenseWave_16x16x32"\r\n                            LabelText="{7}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
ea.a.mKc,ea.a.H7a,w.AFrameworkApplication.Cm,ResourceStrings.l_ApplyShapeOutlineSketchStyle,ResourceStrings.l_ApplyShapeOutlineSketchStyle_1,ResourceStrings.l_ApplyShapeOutlineSketchStyle_2,ResourceStrings.l_ApplyShapeOutlineSketchStyle_3,ResourceStrings.l_ApplyShapeOutlineSketchStyle_4,y,CommonUIStrings.l_PPTApplyShapeOutlineSketchStyleKeytip)),ia.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineArrowsAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_ArrowStyle_16x16x32"\r\n                   LabelText="{3}"\r\n                   Keytip="{12}">\r\n                   <Menu Id="MenuOutlineEndStyle">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineEndStyle" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineEndStyle.Controls">\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle1_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle2_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,3"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle3_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle4_16x16x32"\r\n                            LabelText="{7}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,5"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle5_16x16x32"\r\n                            LabelText="{8}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,6"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle6_16x16x32"\r\n                            LabelText="{9}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,7"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle7_16x16x32"\r\n                            LabelText="{10}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
ea.a.lKc,ea.a.oja,w.AFrameworkApplication.Cm,ResourceStrings.L_ApplyShapeOutlineEndStyle,ResourceStrings.L_ApplyShapeOutlineEndStyle_1,ResourceStrings.L_ApplyShapeOutlineEndStyle_2,ResourceStrings.L_ApplyShapeOutlineEndStyle_3,ResourceStrings.L_ApplyShapeOutlineEndStyle_4,ResourceStrings.L_ApplyShapeOutlineEndStyle_5,ResourceStrings.L_ApplyShapeOutlineEndStyle_6,ResourceStrings.L_ApplyShapeOutlineEndStyle_7,y,CommonUIStrings.l_ApplyShapeOutlineEndStyleKeytip)),ia.append("</Controls></MenuSection>");
ia.append(qi.MGf);l.PopulationXML=ia.toString()}else{y=H?"ThemeGraphicOutlineColorPicker":"ThemeShapeOutlineColorPicker";ia=H?"StandardGraphicOutlineColorPicker":"StandardShapeOutlineColorPicker";const wa=H?"GraphicNoOutline":"ShapeNoOutline";H=Object.assign(new On.a,{Id:"PptRibbon.Drawing.ShapeOutline",MenuSectionList:[]});Array.add(H.MenuSectionList,Xk.f(c.Ed,"Theme Colors","Color.Menu.Controls","themeColor",y,b.toString(),1));Array.add(H.MenuSectionList,Xk.d("Standard Colors","standardColor","Standard Colors",
ia,b.toString(),!1));a&&0<a.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeOutlineRecentColors",!1)),Array.add(H.MenuSectionList,Xk.c(a,"Recent Colors","Color.Menu.Controls","recentColor","ShapeOutlineRecentColors","1244537109",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeOutlineRecentColors",!0));Array.add(H.MenuSectionList,Xk.b("Remove Color","Color.Menu.Controls",f.toString(),ResourceStrings.L_RemoveShapeOutline,"Color.Menu.RemoveColor",
wa,"per_AppointmentColor0_16x16x32",CommonUIStrings.l_RemoveShapeOutlineKeytip));Array.add(H.MenuSectionList,Xk.a("More Outline Color","Color.Menu.Controls",Q.toString(),ResourceStrings.L_MoreOutlineColors,"Color.Menu.MoreOutlineColor","MoreOutlineColors","per_AppointmentColor0_16x16x32",CommonUIStrings.l_MoreOutlineColorsKeytip));eb.a("ColorPickerHighlighterFix")&&(a=this.Nqj(c.Ed),Xk.h(H,a,c.Ed));l.MenuItems=H}return 32}KDj(a,b,c,f,l){if(!l)return xa.a.J(512500374,815,10,"HandlePreviewShapeFillColor: action data cannot be null."),
8;if(!this.la.Voc)return 2;b=this.pa.Qf();const y=this.Z$a(b,this.PX);return y&&y.length?this.lfb&&1===y.length&&y[0].vd?(xa.a.J(512500372,815,50,"HandlePreviewShapeFillColor: Preview for table shapes to be handled separately."),32):Qg.a("HandlePreviewShapeFillColor:",a,()=>{const H=this.pa.mP(y),Q=this.AJ.pS(l),ia=Object.assign(new HN.a,{});ia.solidFillField=Q;for(const wa of H)wa?wa.vd||(this.Ahc.Fb(wa.get_shapeId())?this.Ahc.$(wa.get_shapeId(),wa.fill):this.Ahc.add(wa.get_shapeId(),wa.fill),wa.fill=
ia,wa.Dga=null):xa.a.J(512500371,822,50,"HandlePreviewShapeFillColor, shape with shape id : {0} is null",wa.get_shapeId());return 32}):(xa.a.J(512500373,815,50,"HandlePreviewShapeFillColor: No shape is selected to show preview color."),16)}XEj(a,b,c,f,l){if(!l)return xa.a.J(512500370,815,10,"HandleRevertPreviewShapeFillColor: action data cannot be null."),8;if(!this.la.Voc)return 2;a=this.pa.Qf();a=this.Z$a(a,this.PX);if(!a||!a.length)return xa.a.J(512500369,815,50,"HandleRevertPreviewShapeFillColor: No shape is selected to show preview color."),
16;if(this.lfb&&1===a.length&&a[0].vd)return xa.a.J(512500368,815,50,"HandleRevertPreviewShapeFillColor: Preview for table shapes to be handled separately."),32;a=this.pa.mP(a);for(const y of a)if(!y)xa.a.J(512500367,822,50,"HandleRevertPreviewShapeFillColor, shape with shape id : {0} is null",y.get_shapeId());else if(!y.vd)if(this.Ahc.Fb(y.get_shapeId()))y.fill=this.Ahc.ga(y.get_shapeId()),y.Dga=null;else return xa.a.J(512500366,815,10,"HandleRevertPreviewShapeFillColor: last applied shape fill color cannot be empty."),
8;return 32}veg(a,b,c,f,l){var y=this.ta.presentation;if(!y)throw Error.argumentNull("Presentation is null");f=this.pa.Qf();b=this.Z$a(f,this.PX);const H={type:"ColorPickerPayload",color:""};l&&(H.color=l.Color);if(!(b&&0<b.length||this.pa.$L()&&this.Zrg(f[0],a,H))||this.$b.eD(b))return 16;const Q=this.pa.fo();y=Q?y.ZC(Q.slideId):null;if(!y||!y.Ed||!y.Ed.PresetSchemeColorMapping)return 16;if(1===c)return 32;if(!l)return 8;if(this.lfb&&1===b.length&&b[0].vd)return xa.a.J(512500364,815,50,"HandleApplyShapeFillColor: send PowerPointCellShadingColor"),
this.ia.Ka(ea.a.l6,c,l);c=qi.Okd(l);if(!c)return 8;1<f.length?xa.a.J(512500362,815,50,"HandleApplyShapeFillColor: Apply shape fill color on {0} selected shapes.",f.length):xa.a.J(512500361,815,50,"HandleApplyShapeFillColor: Apply shape fill color on one selected shape.");for(var ia of f)if(ia.Of||ia.Ug){Dn(ia);break}if(this.pa.$L()&&this.Zrg(f[0],a,H)&&this.Zee(f[0],a,H))return 32;ia=this.Eb.xd(15,void 0,()=>{this.pa.kj();this.Fa.Bd()});try{ia.hc(b[0]);ia.fd=a;const wa=this.AJ.pS(l),Ua=this.pa.mP(b);
for(const kb of Ua)if(kb.vd){if(!this.lfb)continue;xa.a.J(512500360,815,50,"HandleApplyShapeFillColor: Process table");const Gb=this.zc.ZN(kb);if(!Gb){xa.a.J(512500359,815,10,"HandleApplyShapeFillColor: Table Node from shape is null");continue}const ec=Gb.Bab();for(const dc of ec){const Fc=dc.cellShading;gp.b(Fc);Fc.solidFillField=wa;dc.cellShading=Fc}}else{const Gb=this.RXf(kb);Gb&&(this.AJ.PSa(Gb),Gb.solidFillField=wa,kb.fill=Gb,kb.Dga=null,this.AOh(kb,Gb));kb.Lga=JSON.stringify(c);this.pNb(kb)}}finally{ia&&
ia.dispose()}return 32}yCj(a,b,c,f,l){if(1===c)return this.ia.Ka(ea.a.renderColorPicker,1,l);a=this.Mqj();b={};b.currentColor=a;b.handleCommand=ea.a.iKc;return this.ia.Ka(ea.a.renderColorPicker,2,b)}rzj(a,b,c,f,l){if(1===c)return this.ia.Ka(ea.a.ICa,c,l);if(!l)return xa.a.J(512500358,815,10,"HandleApplyShapeFillCustomColor: actionData is null"),16;a=this.ia.Ka(ea.a.ICa,c,l);32===a&&this.ia.Ka(ea.a.xCa,c,l);return a}DCj(a,b,c,f,l){a=this.pa.Qf();a=eb.a("FixColorPickerPictureBorderColor")?this.lyb(a,
this.PX):this.Z$a(a,this.PX);a=this.pa.mP(a);if(1===c)return this.ia.Ka(ea.a.renderColorPicker,1,l);c=null;1===a.length&&a[0].ova&&(c=Ge.Box4ColorHelper.Jta(a[0].ova));l={};l.currentColor=c;l.handleCommand=ea.a.jKc;return this.ia.Ka(ea.a.renderColorPicker,2,l)}Efg(a,b,c,f,l){f=this.pa.Qf();b=this.Z$a(f,this.PX);const y=!!b&&0<b.length;if(this.$b.eD(b))return 16;if(1===c)return y?32:8;if(!y)return 16;1<f.length?xa.a.J(512500357,815,50,"HandleRemoveShapeFill: Remove shape fill on {0} selected shapes.",
f.length):xa.a.J(512500356,815,50,"HandleRemoveShapeFill: Remove shape fill on one selected shape.");if(this.lfb&&1===b.length&&b[0].vd)return xa.a.J(512500355,815,50,"HandleRemoveShapeFill: send PowerPointRemoveCellShading"),this.ia.Ka(ea.a.CKa,c,l);c=this.Eb.xd(15,void 0,()=>{this.pa.kj();this.Fa.Bd()});try{c.hc(b[0]);c.fd=a;const H=this.pa.mP(b);for(const Q of H)if(Q.vd){if(!this.lfb)continue;xa.a.J(512500354,815,50,"HandleRemoveShapeFill: Process table");const ia=this.zc.ZN(Q);if(!ia){xa.a.J(512500353,
815,10,"HandleRemoveShapeFill: Table Node from shape is null");continue}const wa=ia.Bab();for(const Ua of wa){const kb=Ua.cellShading;gp.b(kb);kb.noFillField=new ey;Ua.cellShading=kb}}else{const ia=this.RXf(Q);ia&&(this.AJ.PSa(ia),ia.noFillField=new ey,Q.fill=ia,Q.Dga=null,this.AOh(Q,ia));Q.U5k();this.pNb(Q)}}finally{c&&c.dispose()}return 32}weg(a,b,c,f,l){var y=this.ta.presentation;if(!y)throw Error.argumentNull("Presentation is null");f=this.pa.Qf();b=this.lyb(f,this.PX);if(!(b&&0<b.length)||this.$b.eD(b))return 16;
const H=this.pa.fo();y=H?y.ZC(H.slideId):null;if(!y||!y.Ed||!y.Ed.PresetSchemeColorMapping)return 16;if(1===c)return 32;if(!l)return 8;c=qi.Okd(l);if(!c)return 8;1<f.length?xa.a.J(512500322,815,50,"HandleApplyShapeOutlineColor: Apply shape outline color on {0} selected shapes.",f.length):xa.a.J(512500321,815,50,"HandleApplyShapeOutlineColor: Apply shape outline color on one selected shape.");for(var Q of f)if(Q.Of||Q.Ug){Dn(Q);break}Q=this.Eb.xd(15,void 0,()=>{this.pa.kj();this.Fa.Bd()});try{Q.hc(b[0]);
Q.fd=a;const ia=this.pa.mP(b);for(const wa of ia){const Ua=this.E5d(wa);if(Ua){this.AJ.PSa(Ua);const kb=this.AJ.pS(l);Ua.solidFillField=kb;wa.lineStyle=Ua;wa.ova=null;this.Ayd(wa,Ua)}wa.ypa=JSON.stringify(c);this.pNb(wa)}}finally{Q&&Q.dispose()}return 32}szj(a,b,c,f,l){if(1===c)return this.ia.Ka(ea.a.nja,c,l);if(!l)return xa.a.J(512500320,815,10,"HandleApplyShapeOutlineCustomColor: actionData is null"),16;a=this.ia.Ka(ea.a.nja,c,l);32===a&&this.ia.Ka(ea.a.xCa,c,l);return a}wzj(a,b,c,f,l){f=this.pa.Qf();
b=this.lyb(f,this.PX);if(!(b&&0<b.length)||this.$b.eD(b))return 16;if(1===c)return 32;if(!l)return 8;c=this.EXc(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);c=parseInt(c)-1;if(c>=qi.Eth.length||0>c)return 8;1<f.length?xa.a.J(512500317,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline width on {0} selected shapes.",f.length):xa.a.J(512500316,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline width on one selected shape.");l=this.Eb.xd(15,void 0,()=>{this.pa.kj();this.Fa.Bd()});try{l.hc(b[0]);
l.fd=a;const y=this.pa.mP(b);for(const H of y){const Q=this.E5d(H);Q&&(Q.wField=qi.xel[c],Q.wFieldSpecified=!0,this.Ayd(H,Q),this.IXf(Q),H.lineStyle=Q);H.outlineWidth=qi.Eth[c];this.pNb(H)}}finally{l&&l.dispose()}return 32}pNb(a){this.Ga.ZL(a)&&Nc.a.Kb&&(Nc.a.Kb.Oj=!0)}RXf(a){if(!this.sKg)return null;let b=a.fill;b||!a.ZL&&!a.get_isSVGBlipFilled()||(b=new HN.a);return b}E5d(a){var b=this.ta.presentation;if(!b)throw Error.argumentNull("Presentation is null");if(!this.sKg)return null;let c=a.lineStyle;
if(this.yBe&&a.H2c()&&c&&c.wFieldSpecified){b=Object(qa.a)(118,b.ZC(a.slideId));var f=this.ij.WG;b&&b.lx&&null!=b.lx.gs&&(f=b.lx.gs);b=c.wField/f;f=this.o8b(a);if(!f||!f.eRa||!f.DKc)return c.wField=b,c;var l;(l=f.Fk&&f.Fk.wH&&f.Fk.wH.TL()&&1===f.Fk.wH.va.childNodes.length?f.Fk.wH.va.childNodes[0].getAttribute("width"):f.eRa.getAttribute("width"))&&!ma.a.Xa(l.toString())&&(l=parseFloat(l.toString()),isNaN(l)||(f=Math.sqrt(l*l/(f.Foi*f.DKc)),1E-6<f&&(b/=f)));c.wField=b}c||!a.ZL&&!a.get_isSVGBlipFilled()||
(c=new $R.a);return c}IXf(a){if(a.noFillField||gp.e(a))a.noFillField=null,a.solidFillField=Object.assign(new Ot.a,{schemeClrField:Object.assign(new Zf.a,{valField:1})})}tzj(a,b,c,f,l){f=this.pa.Qf();b=this.lyb(f,this.PX);if(!(b&&0<b.length)||this.$b.eD(b))return 16;if(1===c)return 32;if(!l)return 8;c=this.EXc(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);c=parseInt(c)-1;if(0>c)return 8;1<f.length?xa.a.J(512500313,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline dash style on {0} selected shapes.",
f.length):xa.a.J(512500312,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline dash style on one selected shape.");l=this.Eb.xd(15,void 0,()=>{this.pa.kj();this.Fa.Bd()});try{l.hc(b[0]);l.fd=a;const y=this.pa.mP(b);for(const H of y){const Q=this.E5d(H);Q&&(Q.prstDashField=Q.prstDashField||new aS.a,Q.prstDashField.valField=this.qoj(c),Q.prstDashField.valFieldSpecified=!0,Q.custDashField=null,this.Ayd(H,Q),this.IXf(Q),H.lineStyle=Q);H.RM=c;this.pNb(H)}}finally{l&&l.dispose()}return 32}qoj(a){switch(a){case 0:return 0;
case 1:return 8;case 3:return 2;default:return 0}}uzj(a,b,c,f,l){f=this.pa.Qf();b=qi.gkj(f);if(!(b&&0<b.length)||this.$b.eD(b))return 16;if(1===c)return 32;if(!l)return 8;c=this.EXc(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);l=parseInt(c)-1;if(0>l||l>=qi.rth.length)return 8;c=qi.rth[l];l=qi.tel[l];1<f.length?xa.a.J(512500308,815,50,"HandleApplyShapeOutlineEndStyle: Apply shape outline end style on {0} selected shapes.",f.length):xa.a.J(512500307,815,50,"HandleApplyShapeOutlineEndStyle: Apply shape outline end style on one selected shapes.");
f=this.Eb.xd(15,void 0,()=>{this.pa.kj();this.Fa.Bd()});try{f.hc(b[0]);f.fd=a;const y=this.pa.mP(Array.isArray(b)?b:null);for(const H of y)H.fol(c,l)}finally{f&&f.dispose()}return 32}Ffg(a,b,c){const f=this.pa.Qf();b=this.lyb(f,this.PX);if(!(b&&0<b.length)||this.$b.eD(b))return 16;if(1===c)return 32;1<f.length?xa.a.J(512500306,815,50,"HandleRemoveShapeOutline: Remove shape outline on {0} selected shapes.",f.length):xa.a.J(512500305,815,50,"HandleRemoveShapeOutline: Remove shape outline on one selected shape.");
c=this.Eb.xd(15,void 0,()=>{this.pa.kj();this.Fa.Bd()});try{c.hc(b[0]);c.fd=a;const l=this.pa.mP(b);for(const y of l){const H=y.lineStyle;H&&(this.AJ.PSa(H),H.noFillField=new ey,y.lineStyle=H,y.ova=null,this.Ayd(y,H));y.A6k();this.pNb(y)}}finally{c&&c.dispose()}return 32}vzj(a,b,c,f,l){f=this.pa.Qf();b=this.lyb(f,this.PX);if(!(b&&0<b.length)||qi.Jgl(f))return 8;if(this.$b.eD(b))return 16;if(1===c)return 32;if(!l)return xa.a.J(512500304,815,50,"HandleApplyShapeOutlineSketchStyle requires actionData"),
8;c=this.EXc(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);c=parseInt(c)-1;if(0>c)return xa.a.J(512500303,815,50,"Invalid outline sketch style ",c),8;1<f.length?xa.a.J(512500301,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline sketch style on {0} selected shapes.",f.length):xa.a.J(512500300,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline sketch style on one selected shape.");l=this.Eb.xd(15,void 0,()=>{this.pa.kj();this.Fa.Bd()});try{l.hc(b[0]);l.fd=a;for(const y of b)y.Anc=c,
y.setValue(zb.a.jcc,!0)}finally{l&&l.dispose()}return 32}hGj(a,b,c){b=this.pa.Qf();a=this.pa.fo();if(!(this.qD.isActive||1===b.length&&a&&a.fGh||this.Up&&this.pa.Jla()))return 16;if(1===c)return 32;if(this.$b.$c(a))return 16;c=32;if(this.qD.isActive)this.qD.uRa();else if(this.Up)if(this.eR.PL)this.eR.PL=!1;else{b=this.pa.Pa.mb;var f=null;if(b&&(f=b.Va)&&(f.contextId===yb.a.Mf||f.contextId===yb.a.textRange||f.contextId===yb.a.endOfParagraph||f.contextId===yb.a.paragraph))c=this.ia.processAction(C.a.zTc,
2);else if(a.vd&&this.pa.d0(this.pa.Pa)){if(b=a.$yb())if(b=b.ef(0,0)){b.$kl(this.eR);var l=b.m6b;f=-1;l&&(f=Db.ParagraphReader.textLength(Object(qa.a)(pg.a,l))+1);if(l=this.Tb.Di){const y=this.Eb.je(4),H=l.Fi;y.hc(l);const Q=this.FU.$Ea(H),ia=Object(qa.a)(118,this.Eze.jbg(b));this.FU.E9e(Q,!0,!1,ia,a,b,null,0,f);(a=H.opc(Q))&&l.ACb(a);y.dispose()}}}else this.qD.Efh(a)}else this.qD.Efh(a);Rc.App.Lb.updateCommandUI();return c}izj(a,b,c){return this.Up&&(a=this.pa.Pa.mb)&&(a=a.Va)&&(a.contextId===yb.a.Mf||
a.contextId===yb.a.textRange||a.contextId===yb.a.endOfParagraph||a.contextId===yb.a.paragraph)?(this.qD.uRa(),this.ia.processAction(ea.a.C8d,2)):(a=this.pa.fo())?this.ia.Ka(ea.a.B8d,c,new gA(this.qD.SEl,a)):16}jzj(a,b,c,f,l){if(!l||!Object(Wa.a)(gA,l))return xa.a.J(512500299,822,10,"Invalid ActionData. Type: {0}",l?Object.getType(l).getName():"null"),8;if(this.Up&&this.eR.PL)return this.eR.PL=!1,16;b=l.rvc;if(!(this.qD.isActive&&b&&b.eGh))return this.qD.uRa(),16;if(this.$b.$c(b))return 16;if(1===
c)return 32;Nc.a.Kb&&(Nc.a.Kb.Oj=!1,Nc.a.Kb.actionName="FormatPainterApplyToShape",Nc.a.Kb.vr=!0);c=this.Eb.xd(15,void 0,()=>{this.pa.kj();this.Fa.Bd()});try{c.hc(l.rvc),c.fd=a,l.rvc.pxb=l.TEl.id}finally{c&&c.dispose()}this.qD.uRa();return 32}VDj(a,b,c,f,l){if(!l||!Object(Wa.a)(Vh.a,l))return 8;l.Hf(this.qD.isActive||(this.Up?this.eR.PL:!1));return 32}XVk(a,b,c){return(a=this.o8b(a))&&Object(Wa.a)(it.a,a.Fk)&&(a=Object(qa.a)(it.a,a.Fk))?a.FRe(ea.a.Hv(b),c):!1}Zee(a,b,c){return(a=this.o8b(a))&&Object(Wa.a)(it.a,
a.Fk)&&(a=Object(qa.a)(it.a,a.Fk))?a.goc(ea.a.Hv(b),c):!1}EXc(a){return a.split(",")[1]}AOh(a,b){if(this.yBe&&a.H2c()){var c=this.o8b(a),f=this.GNf(c,a);a=b.noFillField?null:this.UH(b,a);f=this.Ygb.bLl(f,a);this.vBf(c,f)}}Ayd(a,b){var c=this.ta.presentation;if(!c)throw Error.argumentNull("Presentation is null");if(this.yBe&&a.H2c()){var f=this.o8b(a),l=this.GNf(f,a);if(null!==l){if(b.noFillField)l=this.Ygb.CLh(l);else{if(b.wFieldSpecified){var y=Object(qa.a)(118,c.ZC(a.slideId)),H=this.ij.WG;y&&y.lx&&
null!=y.lx.gs&&(H=y.lx.gs);l=this.Ygb.DLh(l,b.wField,f.od,H)}b.prstDashField&&b.prstDashField.valFieldSpecified&&(l=this.Ygb.cLl(l,b.prstDashField.valField));if(b.solidFillField){b=this.UH(b,a);l=this.Ygb.CLh(l,b);if(!l)return;b=l.querySelectorAll(this.Ygb.K4e);y=!0;for(H=0;H<b.length;++H){const Q=b[H].getAttribute("stroke-width");if(Q&&!ma.a.Xa(Q.toString())){y=!1;break}}y&&(a=Object(qa.a)(118,c.ZC(a.slideId)),c=this.ij.WG,a&&a.lx&&null!=a.lx.gs&&(c=a.lx.gs),l=this.Ygb.DLh(l,xe.a.jPe/this.bPe,f.od,
c))}}this.vBf(f,l)}}}UH(a,b){const c=this.ta.presentation;if(!c)throw Error.argumentNull("Presentation is null");b=c.ZC(b.slideId);return this.AJ.rMb(a,b.Ed)}vBf(a,b){if(b&&a&&a.Fk){a.Fk.g_.Sd(!1);var c=a.Fk.wH.va.childNodes;for(let f=0;f<c.length;++f)a.Fk.wH.va.removeChild(c[f]);a.Fk.wH.va.appendChild(b);(b=a.eRa.getAttribute("transform"))&&a.Fk.wH.va.setAttribute("transform",b.toString());a.Fk.wH.Sd(!0);Nc.a.Kb&&(Nc.a.Kb.Oj=!0,Nc.a.Kb.FF=new Date)}}Zrg(a,b,c){return eb.a("EnableSmartArtFillColor")&&
this.XVk(a,b,c)}Mqj(){var a=this.pa.Qf();a=this.Z$a(a,this.PX);var b=this.pa.mP(a),c=null;a=null;eb.a("FixColorPickerSelectedColor")&&(a=this.ta.Ba);if(1===b.length){if(b[0].Dga)c=Ge.Box4ColorHelper.Jta(b[0].Dga);else if(b[0].vd&&eb.a("FixColorPickerSelectedColor")){const f=this.pa.Ev();if(!f||!f.length){if(b=this.pa.un())b=b.ef(0,0),c=Ge.Box4ColorHelper.HEa(b.cellShading.solidFillField,a.Ed);return c}c=f[0];c=c.cellShading&&c.cellShading.solidFillField&&a?Ge.Box4ColorHelper.HEa(c.cellShading.solidFillField,
a.Ed):this.JA.qUc(Object(qa.a)(pg.a,c))}!c&&eb.a("FixColorPickerSelectedColor")&&b[0].fill&&b[0].fill.solidFillField&&(c=Ge.Box4ColorHelper.HEa(b[0].fill.solidFillField,a.Ed))}return c}LGl(a){var b=this.ta.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");b=b.YC(a).isHiddenShape;this.hol(a,b)}KGl(a,b){a.isHiddenShape=!b;const c=Object(qa.a)(119,a.qc(this.Iz));b?c.hAa():(c.ila(),this.pa.mX(a)&&this.pa.I8(a))}hol(a,b){const c=this.Eb.xd(15,void 0,()=>{this.pa.kj()});try{const f=this.ta.Ba;if(!f)throw Error.argumentNull("ActiveSlide is null");
const l=f.YC(a);c.hc(l);this.KGl(l,b)}finally{c&&c.dispose()}}eol(a,b){const c=this.Eb.xd(15,void 0,()=>{this.pa.kj()});try{const f=this.ta.Ba;if(!f)throw Error.argumentNull("ActiveSlide is null");const l=f.YC(a);c.hc(l);l.shapeName=b}finally{c&&c.dispose()}}Kqj(){var a=this.pa.Qf();a=this.Z$a(a,this.PX);return this.pa.mP(a)}Oqj(a){const b=this.Kqj();return b&&1===b.length?b[0].vd?this.JA.O4f(this.pa.Ev()):b[0].fill&&b[0].fill.solidFillField?Ge.Box4ColorHelper.HEa(b[0].fill.solidFillField,a):null:
null}Nqj(a){const b=this.pa.Qf();return b&&1===b.length&&b[0].lineStyle&&b[0].lineStyle.solidFillField?Ge.Box4ColorHelper.HEa(b[0].lineStyle.solidFillField,a):null}o8b(a){return a?Object(qa.a)(119,a.qc(this.Iz)):null}GNf(a,b){try{if(!(a&&a.eRa&&a.Fk&&a.Fk.wH))return null;if(a.Fk.wH.TL()){if(!a.Fk.wH.va)return null;const l=a.Fk.wH.va.childNodes;for(a=0;a<l.length;++a)if("svg"===l[a].tagName.toLowerCase())return l[a];return null}if(!a.eRa.getAttribute(Ui.a.y$b))return null;let c=a.eRa.getAttribute(Ui.a.y$b).toString();
if(!c.toLowerCase().startsWith(this.RCl))return null;c=decodeURIComponent(c.substr(c.indexOf(",")+1));const f=this.VBe.sanitize(c);return f&&1===f.children.length?f.children[0]:(b.ZUa=!0,null)}catch(c){return xa.a.J(512500295,815,10,"ConvertSourceToDOMElement Unexpected exception when update svg domelement fill: {0}, stack: {1}",c.message,c.stack),null}}static pqj(a,b){const c=[];if(a)for(const f of a)b&&f.get_isSVGBlipFilled()&&Array.add(c,f);return c}static gkj(a){if(!a)return null;const b=[];for(const c of a)c.rz&&
Array.add(b,c);return b}static Jgl(a){let b;for(let c=0;c<a.length;c++){if(!a[c])return!0;b=a[c].shapeType;if(127===b||121===b||124===b)return!0}return!1}static Okd(a){return Au.a.parse(a.Color)}}qi.Eth=[.5,1,2.25,4.5];qi.xel=[6350,12700,28575,57150];qi.rth=[0,0,2,2,0,1,1];qi.tel=[0,2,0,2,1,0,1];qi.NGf='<Menu Id="{0}">';qi.TGf='<MenuSection Id="Remove Color"><Controls Id="Color.Menu.Controls">';qi.RGf='<Button Id="Color.Menu.RemoveColor" Command="{0}" Image16by16="{1}" Image16by16Class="per_AppointmentColor0_16x16x32" LabelText="{2}" Keytip="{3}" />';
qi.SGf="</Controls> </MenuSection>";qi.Gui='<MenuSection Id="More Fill Colors"><Controls Id="Color.Menu.Controls">';qi.Eui='<Button Id="Color.Menu.MoreFillColors" Command="{0}" Image16by16="{1}" Image16by16Class="per_MoreColors_16x16x32" LabelText="{2}" Keytip="{3}" />';qi.Fui="</Controls> </MenuSection>";qi.Jui='<MenuSection Id="More Outline Colors"><Controls Id="Color.Menu.Controls">';qi.Hui='<Button Id="Color.Menu.MoreOutlineColors" Command="{0}" Image16by16="{1}" Image16by16Class="per_MoreColors_16x16x32" LabelText="{2}" Keytip="{3}" />';
qi.Iui="</Controls> </MenuSection>";qi.MGf="</Menu>";Object(m.a)(qi,"ShapesFormatActor",null,[251]);var hj=d(231);class wi{constructor(a,b,c){this.zdd=Array(wi.vW);this.rad=Array(wi.vW);this.ate=Array(wi.vW);if(!a)throw Error.argumentNull("mainMasterResources");if(!b)throw Error.argumentNull("theme");if(!c)throw Error.argumentNull("resourceViewElementResolver");this.JJ=a;this.Nm=b;this.pfd=c;this.Mwa={}}dispose(){Array.clear(this.zdd);Array.clear(this.rad);this.Nm=this.JJ=null;const a=ta.a.EL(this.Mwa);
a.length&&appChrome.api.unregisterIcons(a);this.Mwa=null}get jj(){return this.JJ.MasterId}$7b(a,b,c){const f=Object.assign(new On.a,{Id:"PptRibbon.DrawingFormat.StylesMenu",MenuSectionList:[]});var l=Object.assign(new Rk.a,{Id:"MenuSectionShapeStyles",ControlsId:"MenuSectionShapeStyles.Controls",Title:"Quick Styles",DisplayMode:"Size48by48",ControlList:[]});Array.add(f.MenuSectionList,l);var y=c?"GraphicsStyleSection":"ApplyShapeStyleSection",H=c?"GraphicsStyleGallery":"ApplyShapeStyleGallery";y=
Object.assign(new Cq.a,{Id:"ControlsShapeStyles",ExternalId:y,ExternalGalleryId:H,Type:4,Width:wi.vW,ElementDimensions:"Size48by48",GalleryItems:[]});Array.add(l.ControlList,y);l=wi.vW*(a?wi.lGf:wi.pGf);c&&(l=wi.vW*wi.oGf);for(H=0;H<l;++H){const Q=c?"ApplyGraphicsStyle"+H:"ApplyShapeStyle"+H;Array.add(y.GalleryItems,c?this.X8d(Q,H,a,b,!0):this.X8d(Q,H,a,b,!1))}return f}X8d(a,b,c,f,l){if(l){var y=this.JJ?this.JJ.SVGStyles[b]:null;c="SVGStyle";y=y?y.ToolTip:""}else y=this.JJ?this.JJ.ShapeStyles[b]:
null,c=c?"LineStyle":"ShapeStyle",y=y?this.Tce(y.StyleId):"";return Object.assign(new kE.a,{Id:a,ExternalId:a,Icon:wi.a8b(c,f,b),PreviewIconStyle:wi.soj(),Command:l?"2748140308":"1963674920",QueryCommand:l?"1903137544":"2375118752",Alt:y})}Cod(a){this.addIconToMap(this.JJ.ShapeStyles,"ShapeStyle");this.addIconToMap(this.JJ.LineStyles,"LineStyle");a&&this.addIconToMap(this.JJ.SVGStyles,"SVGStyle");appChrome.api.registerIconProvider(()=>this.Mwa)}wrj(a){if(a<wi.vW&&this.zdd[a])return this.zdd[a];if(a>=
this.JJ.ShapeStyles.length)return"";var b=this.JJ.ShapeStyles[a];const c=String.format("width:{0}px; height:{1}px; position:relative; overflow:hidden; display:inline-block;",b.Icon.Clip.Bounds.Right-b.Icon.Clip.Bounds.Left,b.Icon.Clip.Bounds.Bottom-b.Icon.Clip.Bounds.Top),f=String.format("position:absolute; top:{0}px; left:{1}px;",-1*b.Icon.Clip.Bounds.Top,-1*b.Icon.Clip.Bounds.Left),l=this.Tce(b.StyleId);b=String.format('<Span Style="{0}"><Img Src="{1}" Alt="{2}" Style="{3}"></Span>',c,this.B$d(this.pfd.resolve(Dh.a.rwb,
b.Icon.ImgId,"StyleGallery")),l,f);a<wi.vW&&(this.zdd[a]=b);return b}nqj(a){if(a<wi.vW&&this.ate[a])return this.ate[a];if(a>=this.JJ.SVGStyles.length)return"";var b=this.JJ.SVGStyles[a];const c=String.format("width:{0}px; height:{1}px; position:relative; overflow:hidden; display:inline-block;",b.Icon.Clip.Bounds.Right-b.Icon.Clip.Bounds.Left,b.Icon.Clip.Bounds.Bottom-b.Icon.Clip.Bounds.Top),f=String.format("position:absolute; top:{0}px; left:{1}px;",-1*b.Icon.Clip.Bounds.Top,-1*b.Icon.Clip.Bounds.Left),
l=this.sag(b.StyleId);b=String.format('<Span Style="{0}"><Img Src="{1}" Alt="{2}" Style="{3}"></Span>',c,this.B$d(this.pfd.resolve(Dh.a.rwb,b.Icon.ImgId,"StyleGallery")),l,f);a<wi.vW&&(this.ate[a]=b);return b}ekj(a){if(a<wi.vW&&this.rad[a])return this.rad[a];if(a>=this.JJ.LineStyles.length)return"";var b=this.JJ.LineStyles[a];const c=String.format("width:{0}px; height:{1}px; position:relative; overflow:hidden; display:inline-block;",b.Icon.Clip.Bounds.Right-b.Icon.Clip.Bounds.Left,b.Icon.Clip.Bounds.Bottom-
b.Icon.Clip.Bounds.Top),f=String.format("position:absolute; top:{0}px; left:{1}px;",-1*b.Icon.Clip.Bounds.Top,-1*b.Icon.Clip.Bounds.Left),l=this.K8f(b.StyleId);b=String.format('<Span Style="{0}"><Img Src="{1}" Alt="{2}" Style="{3}"></Span>',c,this.B$d(this.pfd.resolve(Dh.a.rwb,b.Icon.ImgId,"StyleGallery")),l,f);a<wi.vW&&(this.rad[a]=b);return b}Tce(a){let b=null;switch(parseInt(String(a/wi.vW))){case 0:b=ResourceStrings.l_ShapeStyleColoredOutline;break;case 1:b=ResourceStrings.l_ShapeStyleColoredFill;
break;case 2:b=ResourceStrings.l_ShapeStyleLightOutlineColoredFill;break;case 3:b=ResourceStrings.l_ShapeStyleSubtleEffect;break;case 4:b=ResourceStrings.l_ShapeStyleModerateEffect;break;case 5:b=ResourceStrings.l_ShapeStyleIntenseEffect}let c;({color:a,wIh:c}=this.j5f(a));return String.format(b,a.toString(),c)}sag(a){return(a=this.JJ?this.JJ.SVGStyles[a]:null)?a.ToolTip:""}K8f(a){let b=null;switch(parseInt(String(a/wi.vW))){case 0:b=ResourceStrings.l_LineStyleSubtleEffect;break;case 1:b=ResourceStrings.l_LineStyleModerateEffect;
break;case 2:b=ResourceStrings.l_LineStyleIntenseEffect}let c;({color:a,wIh:c}=this.j5f(a));return String.format(b,a.toString(),c)}B$d(a){return null===a?"":ma.a.i$b(a)}addIconToMap(a,b){for(let f=0;f<a.length;++f){var c=a[f];const l=wi.a8b(b,this.jj,f),y={},H={};H.top=String.format("-{0}px",c.Icon.Clip.Bounds.Top);H.left=String.format("-{0}px",c.Icon.Clip.Bounds.Left);H.position="absolute";y.root=H;c=appChrome.buildImageIconFromUrl(this.pfd.resolve(Dh.a.rwb,c.Icon.ImgId,"StyleGallery"),y);this.Mwa[l]=
c}}j5f(a){let b,c;c=b=null;a%=wi.vW;switch(a){case 0:b=hj.Color.$i(this.Nm.Dark1);c=String.format(ResourceStrings.l_DarkFormat,1);break;case 1:b=hj.Color.$i(this.Nm.Accent1);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 2:b=hj.Color.$i(this.Nm.Accent2);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 3:b=hj.Color.$i(this.Nm.Accent3);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 4:b=hj.Color.$i(this.Nm.Accent4);c=String.format(ResourceStrings.L_AccentFormat,
a);break;case 5:b=hj.Color.$i(this.Nm.Accent5);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 6:b=hj.Color.$i(this.Nm.Accent6),c=String.format(ResourceStrings.L_AccentFormat,a)}return{color:b,wIh:c}}static get Opi(){return wi.Tdl}static get Mpi(){return wi.Rdl}static get Npi(){return wi.Sdl}static soj(){const a={},b=28/48,c=(28-28*b)/2,f={};f.width=String.format("{0}px",28);f.height=String.format("{0}px",28);f.transform=String.format("matrix({0},0,0,{1},-{2},-{3})",b,b,c,c);a.root=f;
return a}static A9d(a,b){const c=new Sys.StringBuilder;c.append('<Menu Id="PptRibbon.DrawingFormat.StylesMenu">');c.append('<MenuSection Id="MenuSectionShapeStyles"><Gallery Id="ControlsShapeStyles" ElementDimensions="Size48by48" Width="7">');a*=wi.vW;for(let f=0;f<a;++f)c.append(String.format('<GalleryButton Id="Style{0}" ElementDimensions="Size48by48" Command="{1}" QueryCommand="{2}" Alt="" InnerHTML=""/>',f,b?ea.a.f0b:ea.a.ptb,b?ea.a.Lmd:ea.a.pnd));c.append("</Gallery> </MenuSection>");c.append("</Menu>");
return c.toString()}static a8b(a,b,c){return String.format("{0}_{1}_{2}",a,b,c)}}wi.vW=7;wi.pGf=6;wi.oGf=4;wi.lGf=3;wi.Tdl=wi.A9d(wi.pGf,!1);wi.Sdl=wi.A9d(wi.lGf,!1);wi.Rdl=wi.A9d(wi.oGf,!0);Object(m.a)(wi,"StyleGalleryBuilder",null,[107]);class JN{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb){this.jHb="";this.dEb=[];this.ia=a;this.oq=b;this.qf=c;this.Fa=l;this.Eb=f;this.Uu=y;this.CGb=H;this.pa=Q;this.Ga=ia;this.Ya=wa;this.PX=Ua;kb.HC(Object(I.a)(this,this.Mo,"onSessionRehydrated"));this.Ya.tzf(Object(I.a)(this,
this.Njd,"onSessionInfoChanged"))}vb(){this.ia.ra(ea.a.pnd,hc.a.application,Object(I.a)(this,this.YDj,"handleQueryShapesStyle"),97);this.ia.ra(ea.a.uPe,hc.a.application,Object(I.a)(this,this.FDj,"handlePopulateShapesStyles"),96);this.ia.ra(ea.a.ptb,hc.a.application,Object(I.a)(this,this.xzj,"handleApplyShapesStyle"),4);this.ia.ra(ea.a.Lmd,hc.a.application,Object(I.a)(this,this.WDj,"handleQueryGraphicsStyle"),97);this.ia.ra(ea.a.rPe,hc.a.application,Object(I.a)(this,this.CDj,"handlePopulateGraphicsStyles"),
96);this.ia.ra(ea.a.f0b,hc.a.application,Object(I.a)(this,this.lzj,"handleApplyGraphicsStyle"),4)}pe(){}WDj(a,b,c,f,l){return this.NYf(l,!0)}YDj(a,b,c,f,l){return this.NYf(l,!1)}NYf(a,b){var c=this.oq.presentation;if(!c)throw Error.argumentNull("Presentation is null");if(!a||!Object(Wa.a)(Uv,a))return 8;var f=a.mV.startsWith("Style")?"Style":b?"ApplyGraphicsStyle":"ApplyShapeStyle";f=parseInt(a.mV.substr(f.length));if(isNaN(f)||0>f)return xa.a.J(509678939,822,10,"ExecuteQuery{0}Style: Invalid style id recieved from the gallery",
b?"Graphics":"Shapes"),8;var l=this.pa.Qf();if(!l||!l.length)return 16;const y=a.h0a;if(!y)return 8;var H=c.ZC(l[0].slideId);if(!H)return 16;c=H.jj;H=this.z7f(H);a.mV.startsWith(b?"ApplyGraphicsStyle":"ApplyShapeStyle")?(this.jHb=(l=this.K_b(l))?"SGT_Line":"SGT_Shape",y.W3=H?H.X8d(a.mV,f,l,c,b?!0:!1):null):H?(this.K_b(l)?(this.jHb="SGT_Line",y.CEa=H.ekj(f),y.Cxb=H.K8f(f)):b?(this.jHb="SGT_SVG",y.CEa=H.nqj(f),y.Cxb=H.sag(f)):(this.jHb="SGT_Shape",y.CEa=H.wrj(f),y.Cxb=H.Tce(f)),y.kV(!1)):(y.CEa="",
y.Cxb="");return 32}CDj(a,b,c,f,l){return this.LYf(c,l,!0)}FDj(a,b,c,f,l){return this.pa.zVa()?8:this.LYf(c,l,!1)}LYf(a,b,c){var f=this.oq.presentation;if(!f)throw Error.argumentNull("Presentation is null");if(1===a)return 32;if(!b)return xa.a.J(509678937,822,10,"ExecutePopulate{0}Styles - Invalid action data",c?"Graphics":"Shapes"),8;a=this.pa.Qf();f=a[0]?f.ZC(a[0].slideId):null;const l=this.z7f(f);if(b.MenuId&&"style"===b.MenuId)this.K_b(a)?b.PopulationXML=wi.Npi:b.PopulationXML=c?wi.Mpi:wi.Opi;
else{this.jHb=(a=this.K_b(a))?"SGT_Line":"SGT_Shape";if(!f)return 16;b.MenuItems=l?l.$7b(a,f.jj,c?!0:!1):null}return 32}lzj(a,b,c,f,l){if(eb.a("FixForPictureAndGraphicsStyleForGrpShapes")){if(0>=this.Pqj().length)return 8}else if(!this.Ga.Vuc(this.pa.Qf()))return 16;return this.xeg(a,c,l,!0)}Pqj(){var a=this.pa.Xd();const b=[];let c=!1;for(const f of a){if(!f)return b.length=0,b;f.Ug&&(c=!0)}if(c)for(const f of a)f.Ug&&this.Ga.Vuc([f])&&b.push(f);else for(const f of a)if(this.Ga.Vuc([f]))b.push(f);
else if(f.Of){a=this.Ga.yx(f);for(const l of a)this.Ga.Vuc([l])&&b.push(l)}return b}xzj(a,b,c,f,l){return this.Gql(this.pa.Qf())?this.xeg(a,c,l,!1):16}xeg(a,b,c,f){var l=this.oq.presentation;if(!l)throw Error.argumentNull("Presentation is null");const y=this.pa.Qf();if(!y||!y.length||this.qf.eD(y))return 16;l=l.ZC(y[0].slideId);var H=this.Uu.a9f(l);if(!H)return this.Uu.NAl(l),xa.a.J(509678936,822,15,"HandleApply{0}Style - MainMasterResources are missing",f?"Graphics":"Shapes"),8;if(1===b)return 32;
if(!c)return xa.a.J(509678935,822,10,"HandleApply{0}Style - Invalid action data",f?"Graphics":"Shapes"),8;b=this.K_b(y)?H.LineStyles.length:H.ShapeStyles.length;H=c.startsWith("Style")?"Style":f?"ApplyGraphicsStyle":"ApplyShapeStyle";c=parseInt(c.substr(H.length));if(isNaN(c)||0>c||c>=b)return xa.a.J(509678934,822,10,"HandleApply{0}Style - Invalid style id recieved from gallery",f?"Graphics":"Shapes"),16;1===y.length?xa.a.J(509678933,815,50,"ShapesStyleActor::HandleApply{0}Style Applying style on only one {1}.",
f?"Graphics":"Shapes",f?"SVG":"Shape"):1<y.length&&xa.a.J(509678932,815,50,"ShapesStyleActor::HandleApply{0}Style Applying style on {1} {2}.",f?"Graphics":"Shapes",y.length,f?"SVGs":"Shapes");f=this.Eb.xd(15,void 0,()=>{this.Fa.Bd();this.pa.kj()});try{f.hc(Object(qa.a)(118,l));f.fd=a;const Q=this.pa.mP(Array.isArray(y)?y:null);for(const ia of Q)ia&&ia.gol(c,this.jHb)}finally{f&&f.dispose()}return 32}Njd(){for(const a of this.dEb)a.dispose();Array.clear(this.dEb)}z7f(a){const b=this.Uu.a9f(a);if(!b||
!a)return xa.a.J(509678931,815,15,"ShapesStyleActor::GetGalleryBuilderForCurrentSlide: MainMasterResource is null now!"),null;for(const c of this.dEb)if(c.jj===a.jj)return c;a=new wi(b,a.Ed,this.CGb);Array.add(this.dEb,a);a.Cod(this.PX);return a}Gql(a){if(!a||!a.length||this.Ga.JJc(a))return!1;for(const b of a)if(b.Tua)return!0;return!1}K_b(a){if(!a)return!1;for(const b of a)if(!b.rz)return!1;return!0}Mo(){this.Oxa()}Oxa(){this.Uu.clearCache();for(const a of this.dEb)a.dispose();Array.clear(this.dEb)}}
Object(m.a)(JN,"ShapesStyleActor",null,[251,1019]);class Yv{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb){this.Nx=this.Pl=-1;this.qr=a;this.ia=b;this.Fa=c;this.qf=f;this.xz=l;this.pa=y;this.vi=H;this.Ga=Q;this.ojk=ia;this.tjk=wa;this.Tma=Ua;this.zc=kb}get Nb(){return this.pa}vb(){this.ia.ra(ea.a.B1a,hc.a.application,Object(I.a)(this,this.DUa,"handleFontFormatAction"),4);this.ia.ra(ea.a.C1a,hc.a.application,Object(I.a)(this,this.DUa,"handleFontFormatAction"),4);this.ia.ra(ea.a.D1a,hc.a.application,Object(I.a)(this,
this.DUa,"handleFontFormatAction"),4);this.ia.ra(ea.a.wtc,hc.a.application,Object(I.a)(this,this.DUa,"handleFontFormatAction"),4);this.ia.ra(ea.a.oOb,hc.a.application,Object(I.a)(this,this.DUa,"handleFontFormatAction"),4);this.ia.ra(ea.a.UNb,hc.a.application,Object(I.a)(this,this.DUa,"handleFontFormatAction"),4);this.ia.ra(ea.a.RNb,hc.a.application,Object(I.a)(this,this.q9b,"handleFont"),5);this.ia.ra(ea.a.qlb,hc.a.application,Object(I.a)(this,this.q9b,"handleFont"),5);this.ia.ra(ea.a.rlb,hc.a.application,
Object(I.a)(this,this.q9b,"handleFont"),5);this.ia.ra(ea.a.v0e,hc.a.application,Object(I.a)(this,this.ADj,"handlePopulateFontNameDropdown"),97);this.ia.ra(ea.a.Clb,hc.a.application,Object(I.a)(this,this.q9b,"handleFont"),4);this.ia.ra(ea.a.mOb,hc.a.application,Object(I.a)(this,this.q9b,"handleFont"),4);this.ia.ra(ea.a.Atc,hc.a.application,Object(I.a)(this,this.DUa,"handleFontFormatAction"),4);this.ia.ra(ea.a.ztc,hc.a.application,Object(I.a)(this,this.DUa,"handleFontFormatAction"),4);this.ia.ra(ea.a.Xpc,
hc.a.application,Object(I.a)(this,this.pzb,"handleQueryFontToggleButton"),97);this.ia.ra(ea.a.Ypc,hc.a.application,Object(I.a)(this,this.pzb,"handleQueryFontToggleButton"),97);this.ia.ra(ea.a.$pc,hc.a.application,Object(I.a)(this,this.pzb,"handleQueryFontToggleButton"),97);this.ia.ra(ea.a.Zpc,hc.a.application,Object(I.a)(this,this.pzb,"handleQueryFontToggleButton"),97);this.ia.ra(ea.a.ind,hc.a.application,Object(I.a)(this,this.rYc,"handleQueryFont"),100);this.ia.ra(ea.a.hnd,hc.a.application,Object(I.a)(this,
this.rYc,"handleQueryFont"),100);this.ia.ra(ea.a.jnd,hc.a.application,Object(I.a)(this,this.rYc,"handleQueryFont"),97);this.ia.ra(ea.a.knd,hc.a.application,Object(I.a)(this,this.rYc,"handleQueryFont"),97);this.ia.ra(ea.a.snd,hc.a.application,Object(I.a)(this,this.pzb,"handleQueryFontToggleButton"),97);this.ia.ra(ea.a.qnd,hc.a.application,Object(I.a)(this,this.pzb,"handleQueryFontToggleButton"),97)}pe(){const a=this.Fa.Fc(jb.a.vg);a.bindAction(x.KeyInputManager.ww(ResourceStrings.l_HK_Bold),ea.a.B1a);
a.bindAction(x.KeyInputManager.ww(ResourceStrings.l_HK_Italic),ea.a.C1a);a.bindAction(x.KeyInputManager.ww(ResourceStrings.l_HK_Underline),ea.a.D1a);a.bindAction(x.KeyInputManager.Qa(B.a.nNa,x.KeyInputManager.Re|4),ea.a.wtc);a.bindAction(x.KeyInputManager.Qa(B.a.Wyd,x.KeyInputManager.Re|4),ea.a.oOb)}rYc(a,b,c,f,l){c=this.Nb.Qf();if(!c||1>c.length)return 16;f=this.Ga.K_(c);var y=this.Nb.Yka();if(1>f.length&&!y)return 16;b=null;this.Pl=Date.now();y&&(b=this.zc.A5f(y,new tt),this.Nx=Date.now(),xa.a.J(512500294,
815,50,"Query table shape font timespan by {0}",(this.Nx-this.Pl).toString()));c=y?[c[0]]:f;for(const H of c){switch(a){case ea.a.ind:case ea.a.hnd:break;case ea.a.jnd:c=this.xz.K7b(H.vd&&b?b.fontName:H.SPb);if(l.m_&&l.m_!==c){l.m_="";break}l.m_=c;l.Dsc();break;case ea.a.knd:c="";H.vd&&b?-1!==b.fontSize&&(c=ma.a.yTc(b.fontSize/2,0,w.AFrameworkApplication.numberFormat)):c=H.pba?Yv.y5f(H).toString():"";f=parseFloat(c);if(!isNaN(f)&&(y=l.m_)&&y!==c){y=Math.min(f,parseFloat(y)).toString()+"+";l.m_=y;
break}l.m_=c;l.Dsc();break;default:return xa.a.J(512500293,820,10,"Unexpected actionId for HandleQueryFont"),8}if(l&&l.m_&&!l.m_.length)break}return 32}pzb(a,b,c,f,l){b=this.Nb.Qf();if(!b||1>b.length)return 16;b=this.Ga.K_(b);c=this.Nb.Yka();if(1>b.length&&!c)return 16;a=c?this.PWk(c,a,new tt):this.Djh(b,a);l.Hf("select"===a);return"disable"!==a?32:8}q9b(a,b,c,f,l){b=this.Nb.Qf();if(!b||1>b.length)return 16;const y=this.Nb.Yka();f=this.Ga.K_(b);if(1>f.length&&!y||this.qf.eD(f)||this.qf.eD([y]))return 16;
if(1===c)return 32;this.Nb.kj();this.Fa.Bd();switch(a){case ea.a.RNb:const Q=this.jua(l,!0);if(!Q)return 8;1<b.length?xa.a.J(512500292,815,50,"Set {0} shapes font color.",b.length):xa.a.J(512500291,815,50,"Set one shape font color.");for(const kb of b)if(kb.Of||kb.Ug){Dn(kb);break}this.qr.pka(kb=>{kb.IMa=Q},f);break;case ea.a.Clb:case ea.a.mOb:let ia;if(a===ea.a.Clb){if(ia=this.jua(l,!1),!ia)return 8}else ia="";1<b.length?xa.a.J(512500290,815,50,"Set {0} shapes highlight.",b.length):xa.a.J(512500289,
815,50,"Set one shape highlight.");this.qr.pka(kb=>{kb.highlight=ia},f);break;case ea.a.qlb:if(!l)return 8;const wa=this.xz.K7b(l);if(wa.length){1<b.length?xa.a.J(512500288,815,50,"Set {0} shapes font name.",b.length):xa.a.J(512500259,815,50,"Set one shape font name.");var H=null;for(const kb of b)if(kb.Of||kb.Ug)Dn(kb),kb.Of&&(H=kb);if(1>this.m9f(f,a,wa).length)return 16;this.qr.pka(kb=>{kb.SPb=wa},f);H&&(H.SPb=wa);this.xz.IIc(l)}break;case ea.a.rlb:l=Object(qa.a)(nE.a,l);if(!l||!l.zd)return 8;const Ua=
this.vi.E2b(l.zd);if(isNaN(Ua))return 8;1<b.length?xa.a.J(512500258,815,50,"Set {0} shapes font size.",b.length):xa.a.J(512500257,815,50,"Set one shape font size.");l=null;for(H of b)if(H.Of||H.Ug)Dn(H),H.Of&&(l=H);if(1>this.m9f(f,a,Ua*Pf.a.nbb).length)return 16;this.qr.pka(kb=>{kb.zyh(Ua)},f);l&&l.zyh(Ua);break;default:return xa.a.J(512500256,820,10,"Unexpected actionId for HandleFont"),8}return 32}DUa(a,b,c){b=this.Nb.Qf();if(!b||1>b.length)return 16;const f=this.Nb.Yka(),l=this.Ga.K_(b);if(1>l.length&&
!f||this.qf.eD(l)||this.qf.eD([f]))return 16;if(1===c)return 32;const y="select"!==this.Djh(this.Ga.K_(b),a);this.Nb.kj();this.Fa.Bd();switch(a){case ea.a.B1a:1<b.length?xa.a.J(512500255,815,50,"Set {0} shapes bold.",b.length):xa.a.J(512500254,815,50,"Set one shape bold.");f&&Object(eb.a)("FixTableModifyFontShortcut")&&this.ia.processAction(ea.a.bold,2);this.qr.pka(Q=>{Q.isBold=y},l);break;case ea.a.C1a:1<b.length?xa.a.J(512500253,815,50,"Set {0} shapes italic.",b.length):xa.a.J(512500252,815,50,
"Set one shape italic.");f&&Object(eb.a)("FixTableModifyFontShortcut")&&this.ia.processAction(ea.a.setItalic,2);this.qr.pka(Q=>{Q.isItalic=y},l);break;case ea.a.D1a:1<b.length?xa.a.J(512500251,815,50,"Set {0} shapes underline.",b.length):xa.a.J(512500250,815,50,"Set one shape underline.");f&&Object(eb.a)("FixTableModifyFontShortcut")&&this.ia.processAction(ea.a.underline,2);this.qr.pka(Q=>{Q.xE=y},l);break;case ea.a.UNb:1<b.length?xa.a.J(512500249,815,50,"Set {0} shapes strikethrough.",b.length):
xa.a.J(512500248,815,50,"Set one shape strikethrough.");this.qr.pka(Q=>{Q.bG=y},l);break;case ea.a.wtc:case ea.a.oOb:const H=a===ea.a.oOb?!1:!0;1<b.length?xa.a.J(512500247,815,50,"Step {0} shapes font size.",b.length):xa.a.J(512500246,815,50,"Step one shape font size.");this.qr.pka(Q=>{Q.ZBb=H},l);break;case ea.a.Atc:1<b.length?xa.a.J(512500245,815,50,"Step {0} shapes superscript.",b.length):xa.a.J(512500244,815,50,"Step one shape superscript.");this.qr.pka(Q=>{Q.EN=y?3E4:0},l);break;case ea.a.ztc:1<
b.length?xa.a.J(512500243,815,50,"Step {0} shapes subscript.",b.length):xa.a.J(512500242,815,50,"Step one shape subscript.");this.qr.pka(Q=>{Q.EN=y?-25E3:0},l);break;default:return 8}return 32}ADj(a,b,c,f,l){if(1===c)return 32;sd.Font.fie(b);l.MenuItems=aa.FontUtils.h3f(Yv.Otd,Yv.BTc,this.ojk,this.Tma,this.tjk);return 32}Djh(a,b){let c="select";for(const f of a){switch(b){case ea.a.Xpc:case ea.a.B1a:c=f.isBold?"select":"normal";break;case ea.a.Ypc:case ea.a.C1a:c=f.isItalic?"select":"normal";break;
case ea.a.$pc:case ea.a.D1a:c=f.xE?"select":"normal";break;case ea.a.Zpc:case ea.a.UNb:c=f.bG?"select":"normal";break;case ea.a.snd:case ea.a.Atc:c=0<f.EN?"select":"normal";break;case ea.a.qnd:case ea.a.ztc:c=0>f.EN?"select":"normal";break;default:return"disable"}if("select"!==c)break}return c}PWk(a,b,c){this.Pl=Date.now();c=this.zc.A5f(a,c);switch(b){case ea.a.Xpc:a=1===c.bold?"select":"normal";break;case ea.a.Ypc:a=1===c.italic?"select":"normal";break;case ea.a.$pc:a=1===c.underline?"select":"normal";
break;case ea.a.Zpc:a=1===c.strikethrough?"select":"normal";break;default:return"disable"}this.Nx=Date.now();xa.a.J(512500241,815,50,"Query table shape font state timespan by {0}",(this.Nx-this.Pl).toString());return a}m9f(a,b,c){const f=[];for(const l of a)switch(b){case ea.a.B1a:l.isBold!==c&&Array.add(f,l);break;case ea.a.C1a:l.isItalic!==c&&Array.add(f,l);break;case ea.a.D1a:l.xE!==c&&Array.add(f,l);break;case ea.a.UNb:l.bG!==c&&Array.add(f,l);break;case ea.a.qlb:l.SPb!==c&&Array.add(f,l);break;
case ea.a.rlb:Yv.y5f(l)!==c&&Array.add(f,l);break;case ea.a.Atc:0<l.EN!==c&&Array.add(f,l);break;case ea.a.ztc:0>l.EN!==c&&Array.add(f,l);break;default:xa.a.J(512500240,820,10,"ShapesTextFontActor::GetModifiedShapeMonikers unsupported action Id: {0}.",b)}return f}jua(a,b){if(b)return b=Fn.SchemeColor.parse(a),b&&b.rua?Si.i(Si.g(b.lQ)):(xa.a.J(512500239,820,10,"Font color '{0}' is incorrect",a),null);b=Au.a.parse(a);return b&&b.RGBColor?b.RGBColor:(xa.a.J(512500238,820,10,"Color '{0}' is incorrect",
a),null)}static BTc(a,b){return b}static Otd(){return!1}static y5f(a){const b=a.m3;return ah.a.qz(b,1)?a.pba:Math.round(a.pba)*b}}Object(m.a)(Yv,"ShapesTextFontActor",null,[251]);class KN{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb){this.Nx=this.Pl=-1;this.qr=a;this.ia=b;this.Fa=c;this.qf=f;this.pa=l;this.Ga=y;this.wfb=H;this.tM=Q;this.Rb=ia;this.Eb=wa;this.m5c=Ua;this.zc=kb;this.AA=Gb}get Nb(){return this.pa}vb(){this.ia.ra(ea.a.kOb,hc.a.application,Object(I.a)(this,this.m9,"handleFormatAction"),
4);this.ia.ra(ea.a.TNb,hc.a.application,Object(I.a)(this,this.m9,"handleFormatAction"),4);this.ia.ra(ea.a.slb,hc.a.application,Object(I.a)(this,this.m9,"handleFormatAction"),4);this.ia.ra(ea.a.lOb,hc.a.application,Object(I.a)(this,this.m9,"handleFormatAction"),4);this.ia.ra(ea.a.Elb,hc.a.application,Object(I.a)(this,this.m9,"handleFormatAction"),4);this.ia.ra(ea.a.SNb,hc.a.application,Object(I.a)(this,this.m9,"handleFormatAction"),4);this.ia.ra(ea.a.vtc,hc.a.application,Object(I.a)(this,this.m9,"handleFormatAction"),
4);this.ia.ra(ea.a.ntd,hc.a.application,Object(I.a)(this,this.m9,"handleFormatAction"),4);this.ia.ra(ea.a.Lsd,hc.a.application,Object(I.a)(this,this.m9,"handleFormatAction"),4);this.ia.ra(ea.a.Ksd,hc.a.application,Object(I.a)(this,this.m9,"handleFormatAction"),4);this.ia.ra(ea.a.Jsd,hc.a.application,Object(I.a)(this,this.m9,"handleFormatAction"),4);this.ia.ra(ea.a.Isd,hc.a.application,Object(I.a)(this,this.m9,"handleFormatAction"),4);this.ia.ra(ea.a.t0e,hc.a.application,Object(I.a)(this,this.Cfg,
"handleQueryLineSpacing"),4);this.ia.ra(ea.a.gtc,hc.a.application,Object(I.a)(this,this.m9,"handleFormatAction"),4);this.ia.ra(ea.a.Cjb,hc.a.application,Object(I.a)(this,this.EUa,"handleQueryToggleButton"),97);this.ia.ra(ea.a.Djb,hc.a.application,Object(I.a)(this,this.EUa,"handleQueryToggleButton"),97);this.ia.ra(ea.a.d0a,hc.a.application,Object(I.a)(this,this.EUa,"handleQueryToggleButton"),97);this.ia.ra(ea.a.e0a,hc.a.application,Object(I.a)(this,this.EUa,"handleQueryToggleButton"),97);this.ia.ra(ea.a.mnd,
hc.a.application,Object(I.a)(this,this.EUa,"handleQueryToggleButton"),97);this.ia.ra(ea.a.gnd,hc.a.application,Object(I.a)(this,this.EUa,"handleQueryToggleButton"),97);this.ia.ra(ea.a.ond,hc.a.application,Object(I.a)(this,this.EUa,"handleQueryToggleButton"),97);this.ia.ra(ea.a.lnd,hc.a.application,Object(I.a)(this,this.EUa,"handleQueryToggleButton"),97);this.ia.ra(ea.a.vnd,hc.a.application,Object(I.a)(this,this.ofe,"handleQueryTextAnchoring"),97);this.ia.ra(ea.a.und,hc.a.application,Object(I.a)(this,
this.ofe,"handleQueryTextAnchoring"),97);this.ia.ra(ea.a.tnd,hc.a.application,Object(I.a)(this,this.ofe,"handleQueryTextAnchoring"),97);this.ia.ra(ea.a.nnd,hc.a.application,Object(I.a)(this,this.Cfg,"handleQueryLineSpacing"),97)}pe(){const a=this.Fa.Fc(jb.a.vg);a.bindAction(x.KeyInputManager.ww(ResourceStrings.l_HK_FullJustify),ea.a.SNb);a.bindAction(x.KeyInputManager.ww(ResourceStrings.l_HK_CenterJustify),ea.a.lOb);z.a.Ik?(a.bindAction(x.KeyInputManager.ww(ResourceStrings.l_HK_LeftJustify_Mac),ea.a.slb),
a.bindAction(x.KeyInputManager.ww(ResourceStrings.l_HK_RightJustify_Mac),ea.a.Elb)):(a.bindAction(x.KeyInputManager.ww(ResourceStrings.l_HK_LeftJustify),ea.a.slb),a.bindAction(x.KeyInputManager.ww(ResourceStrings.l_HK_RightJustify),ea.a.Elb))}EUa(a,b,c,f,l){const y=this.Nb.Qf();if(!y||1>y.length)return 16;b=this.Nb.Yka();const H=this.Ga.K_(y);if(1>H.length&&!b)return 16;f=c=null;let Q=a===ea.a.Cjb?1:a===ea.a.Djb?2:18;Object(Wa.a)(Vh.a,l)?f=l:Object(Wa.a)(Uv,l)&&(f=l.h0a,Q=l.menuItemId);l=b?[y[0]]:
H;this.Pl=Date.now();for(const ia of l){switch(a){case ea.a.Cjb:c=ia.vd?this.Dde(Q,a):this.Pce(Q,ia,a);break;case ea.a.Djb:c=ia.vd?this.Dde(Q,a):this.Pce(Q,ia,a);break;case ea.a.d0a:case ea.a.e0a:c=ia.vd?this.Dde(Q,a):this.Pce(Q,ia,a);break;case ea.a.mnd:c=ia.vd?1===this.zc.JUc(b)?"select":"normal":1===ia.Vl?"select":"normal";break;case ea.a.gnd:c=ia.vd?2===this.zc.JUc(b)?"select":"normal":2===ia.Vl?"select":"normal";break;case ea.a.ond:c=ia.vd?3===this.zc.JUc(b)?"select":"normal":3===ia.Vl?"select":
"normal";break;case ea.a.lnd:c=ia.vd?6===this.zc.JUc(b)?"select":"normal":4===ia.Vl?"select":"normal";break;default:c="disable"}if("normal"===c)break}f.Hf("select"===c);this.Nx=Date.now();b&&xa.a.J(512500237,815,50,"Query table shape timespan by {0}",(this.Nx-this.Pl).toString());return"disable"!==c?32:8}Pce(a,b,c){return c===ea.a.d0a||c===ea.a.Cjb||c===ea.a.e0a||c===ea.a.Djb?this.tM.PCf(b,a)?"select":"normal":"normal"}Dde(a,b){var c=!0,f=this.Nb.Yka();f=Od.SelectionFactory.sOc(Object(qa.a)(pg.a,
f));for(const l of f){if(c=l.Pk?l.node:null)if(f=this.Rb.Lc(c),f.set(c),f.sc(11),f.Kg(11),c=this.AA.Gv(f)){if(0===a){c=!1;break}if(b===ea.a.Cjb)c=1===c.listType;else if(b===ea.a.Djb)c=0===c.listType;else if(b===ea.a.d0a){f=this.tM.HWa.ga(a).U0b;const y=this.tM.HWa.ga(a).Xtb;c=c.vzb&&0<c.R9.length&&c.R9[0]===f&&c.cbb&&c.font===y}else b===ea.a.e0a?(f=this.tM.Ahd.ga(a).VVd,c=!!c.propertySet&&c.propertySet.Ua(zb.a.autonumberBulletType)&&c.propertySet.eb(zb.a.autonumberBulletType)===f):c=!1}else c=0===
a?b===ea.a.d0a||b===ea.a.e0a?!0:!1:!1;else c=!1;if(!c)break}return c?"select":"normal"}m9(a,b,c,f,l){f=this.Nb.Qf();if(!f||1>f.length)return 16;b=this.Ga.K_(f);const y=this.Nb.Yka(),H=!!y&&(a===ea.a.vtc||a===ea.a.ntd);if(!b.length&&!y||H||this.qf.eD(b)||this.qf.eD([y]))return 16;if(1===c)return 32;this.Nb.kj();a!==ea.a.gtc&&this.Fa.Bd();switch(a){case ea.a.kOb:case ea.a.TNb:if(Object.getType(l)!==Number)return 8;this.dol(f,b,l);break;case ea.a.slb:case ea.a.lOb:case ea.a.Elb:case ea.a.SNb:var Q=this.ESf(b);
this.aol(b,a,l);Q&&this.pa.selectShape(Q,!1);Nc.a.AP(!0,!1);break;case ea.a.vtc:case ea.a.ntd:l=[];const ia=a===ea.a.vtc?1:2;for(Q of b)Array.add(l,Q);1<f.length?xa.a.J(512500236,815,50,"Set {0} shapes text direction.",f.length):xa.a.J(512500235,815,50,"Set one shape text direction.");this.qr.U9a(Ua=>{if(Ua=Object(qa.a)(4,Ua))Ua.RPb=ia},l);break;case ea.a.gtc:if(!l||!Object(Wa.a)(Array,l)||1>l.length)return 8;Nc.a.Kb&&(Nc.a.Kb.Oj=!0);b=this.Eb.xd(15);try{for(b.hc(l[0].U1),b.fd=a,a=0;a<l.length;a++)l[a].U1.vja=
l[a].paa.left,l[a].U1.wja=l[a].paa.right,l[a].U1.xja=l[a].paa.top,l[a].U1.uja=l[a].paa.bottom}finally{b&&b.dispose()}Nc.a.AP(!0,!1);break;case ea.a.Lsd:case ea.a.Ksd:case ea.a.Jsd:l=[];let wa=1;switch(a){case ea.a.Lsd:wa=0;break;case ea.a.Ksd:wa=1;break;case ea.a.Jsd:wa=2}for(const Ua of b)Array.add(l,Ua);xa.a.J(512500234,815,50,"Set text anchoring, shape count: {0}.",f.length);this.qr.U9a(Ua=>{if(Ua=Object(qa.a)(4,Ua))Ua.Mpa=wa},l);Nc.a.AP(!0,!1);break;case ea.a.Isd:if(!l||Object.getType(l)!==Number)return 8;
Q=this.ESf(b);this.bol(b,l,a);Q&&this.pa.selectShape(Q,!1);Nc.a.AP(!0,!1);break;default:return 8}return 32}ofe(a,b,c,f,l){b=this.Nb.Qf();if(!b||1>b.length)return 16;b=this.Nb.xVc(b);f=b.YBb;c=0;const y=this.Nb.Yka();if(!f&&!y)return 16;switch(a){case ea.a.vnd:a=y?({Yxa:c}=this.zc.F7e(y)).returnValue&&0===c?"select":"normal":0===b.Mpa?"select":"normal";break;case ea.a.und:a=y?({Yxa:c}=this.zc.F7e(y)).returnValue&&1===c?"select":"normal":1===b.Mpa?"select":"normal";break;case ea.a.tnd:a=y?({Yxa:c}=
this.zc.F7e(y)).returnValue&&2===c?"select":"normal":2===b.Mpa?"select":"normal";break;default:a="disable"}l.Hf("select"===a);return"disable"!==a?32:8}Cfg(a,b,c,f,l){c=this.Nb.Qf();if(!c||1>c.length)return 16;b=this.Nb.Yka();c=this.Ga.K_(c);if(!c.length&&!b)return 16;this.Pl=Date.now();switch(a){case ea.a.t0e:break;case ea.a.nnd:a=new wN.a;a.unit=2;a.value=l.MenuItemId;f=!0;b&&(f=this.nul(b,l),this.Nx=Date.now(),xa.a.J(512500233,815,50,"Query table shape timespan by {0}",(this.Nx-this.Pl).toString()));
for(const y of c){b=this.Ga.Oce(y);if(!b||!this.wfb.VCf(b,a)){f=!1;break}this.m5c&&2===b.unit&&(b.value=Math.max(0,b.value-this.Ga.s9d(y)))}l.queryResult.Hf(f);break;default:return 8}return 32}bol(a,b,c){const f=this.Eb.xd(15);try{f.hc(a[0]);f.fd=c;for(const l of a)l.Gta();this.ia.Ka(ea.a.woa,2,b)}finally{f&&f.dispose()}}aol(a,b,c){const f=[];let l=0,y=0;switch(b){case ea.a.slb:l=1;y=C.a.Yla;break;case ea.a.lOb:l=2;y=C.a.Cja;break;case ea.a.Elb:l=3;y=C.a.gpa;break;case ea.a.SNb:l=4,y=C.a.BEa}a=this.pa.mP(a);
for(const H of a)H.Vl!==l&&Array.add(f,H);if(y&&f.length){for(const H of a)if(H.Of||H.Ug){Dn(H);break}a=this.Eb.xd(15);try{a.hc(f[0]);for(const H of f)H.Gta(),H.Tol(l);this.ia.Ka(y,2,c)}finally{a&&a.dispose()}}}dol(a,b,c){const f=[];let l=1===c||2===c;for(const H of b)this.tM.PCf(H,c)||(l=!1,Array.add(f,H));1<a.length?xa.a.J(512500231,815,50,"ListGallery enabled, set {0} shapes bullet.",a.length):xa.a.J(512500230,815,50,"ListGallery enabled, set one shape bullet.");for(const H of a)if(H.Of||H.Ug){Dn(H);
break}a=l?b:f;2!==c||l||(a=b,c=11);if(l||0===c)c=18;const y=this.tM.HWa.ga(c);0<a.length&&this.qr.U9a(H=>{H.setValue(zb.a.QPb,c);y&&(H.setValue(zb.a.eIh,y.Xtb),H.setValue(zb.a.dIh,y.U0b))},a)}nul(a,b){let c=!1;const f=b.MenuItemId;let l=b.LineSpacingValue;b=b.LineSpacingUnit;a=Od.SelectionFactory.sOc(Object(qa.a)(pg.a,a));for(const y of a){if(a=y.Pk?y.node:null){a=this.wfb.VW(a);const H=ah.a.qz(a.lineSpacing.value,f)&&2===a.lineSpacing.unit;if(-1===l)b=a.lineSpacing.unit,l=a.lineSpacing.value;else if(l!==
a.lineSpacing.value||b!==a.lineSpacing.unit)l=b=0,c=!1;0!==b&&(c=H)}if(!c)break}return c}ESf(a){return 0<a.length&&a[0].Ug&&(a=this.Ga.Cs(a[0]))?(this.pa.I8(a),a):null}}Object(m.a)(KN,"ShapesTextParagraphActor",null,[251]);var bS=d(694);class LN{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb){this.ia=a;this.qf=b;this.Eb=c;this.tA=f;this.Fa=l;this.pa=y;this.Tb=H;this.ta=Q;this.Sb=ia;this.Ea=wa;this.Tu=Ua;this.Gb=kb;if(!Gb)throw Error.argumentNull("GraphOperationEventHandler is null");this.Rf=Gb}vb(){this.ia.ra(ea.a.deleteObject,
yb.a.application,Object(I.a)(this,this.tAj,"handleDelete"),4);this.Ea.podsEnableSlideScoreCard&&this.ia.ra(ea.a.Fjh,ie.a.frame,Object(I.a)(this,this.uQl,"updateSlideScore"),96);this.ia.ra(ea.a.B4d,hc.a.application,Object(I.a)(this,this.MAj,"handleDuplicate"),4);this.ia.ra(ea.a.rxf,hc.a.application,Object(I.a)(this,this.Oyj,"handleAddFirstSlide"),4);this.Ea.$0j?(this.ia.ra(ea.a.NI,yb.a.application,Object(I.a)(this,this.DAj,"handleDeleteSlides"),4),this.ia.ra(ea.a.tQ,hc.a.application,Object(I.a)(this,
this.PAj,"handleDuplicateSlides"),4),this.Ea.xge?(this.ia.ra(ea.a.a$b,hc.a.application,Object(I.a)(this,this.ABj,"handleHideSlides"),4),this.ia.ra(ea.a.z8e,hc.a.application,Object(I.a)(this,this.mGj,"handleUnhideSlides"),4),this.Rf.y7a(Object(I.a)(this,this.Ryl,"slidesSelectionChangedHandler"))):this.ia.ra(ea.a.a$b,hc.a.application,Object(I.a)(this,this.$ee,"handleHideSlidesOld"),4),this.ia.ra(ea.a.ynd,yb.a.application,Object(I.a)(this,this.aEj,"handleQuerySlidesHidden"),96)):(this.ia.ra(ea.a.NI,
yb.a.application,Object(I.a)(this,this.CAj,"handleDeleteSlide"),4),this.ia.ra(ea.a.tQ,hc.a.application,Object(I.a)(this,this.OAj,"handleDuplicateSlide"),4),this.ia.ra(ea.a.a$b,hc.a.application,Object(I.a)(this,this.zBj,"handleHideSlide"),4),this.ia.ra(ea.a.ynd,yb.a.application,Object(I.a)(this,this.$Dj,"handleQuerySlideHidden"),96));this.ia.ra(ea.a.T2d,yb.a.application,Object(I.a)(this,this.wAj,"handleDeleteFakeSlides"),2048);this.ia.ra(ea.a.kKf,yb.a.application,Object(I.a)(this,this.bAj,"handleClearAndResizeSlideCanvas"),
2048);this.ia.ya(ea.a.std,hc.a.application,Object(I.a)(this,this.tFj,"handleShareSlide"));this.ia.ra(ea.a.wSe,yb.a.application,Object(I.a)(this,this.dfe,"handleIsDirectManipulationEnabled"),97)}pe(){const a=this.Fa.Fc(Oi.a.iE);a.bindAction(x.KeyInputManager.Qa(B.a.$pa,0),ea.a.NI);a.bindAction(x.KeyInputManager.Qa(B.a.iI,0),ea.a.NI);a.bindAction(x.KeyInputManager.Qa(B.a.xNa,x.KeyInputManager.Re),ea.a.tQ)}tAj(a,b,c,f,l){if(this.Fa.Ee)if(this.Fa.C8===Oi.a.iE||1===this.Gb.ol||this.Ea.Un&&this.Fa.C8===
jb.a.lC)a=ea.a.NI;else if(this.Fa.C8===jb.a.vg)a=ea.a.z8a;else return 8;else return 8;return this.ia.Ka(a,c,l)}CAj(a,b,c){b=this.ta.Ba;if(!b||this.qf.$c(b)||this.Ea.gD&&1!==this.pa.Se().length)return 16;if(1===c)return 32;if(!b.isConnected)return 16;Nc.a.Kb&&(Nc.a.Kb.actionName="DeleteSlide",Nc.a.Kb.vr=!1,Nc.a.Kb.Oj=!0,Nc.a.Kb.Wa("SlideCount","1"));c=this.Tb.Ef;if(!c)return 16;const f=this.Eb.xd(15,void 0,()=>{this.pa.nh()});try{f.hc(c),f.fd=a,c.NI(b)}finally{f&&f.dispose()}this.qf.rw(c,a);a=[];a.push(b);
this.Tu?this.Tu.eod(new BE.a(a)):xa.a.J(512313375,822,10,"HandleDeleteSlide: graphOperationEventNotifier is null for raising event.");return 32}bAj(a,b,c){a=this.Sb.gA(this.ta.e4c?this.ta.e4c.slideIndex:0);if(!a)return xa.a.J(512313374,822,50,"HandleClearAndResizeSlideCanvas: slideNode null"),8;a=Object(qa.a)(340,a.qc(this.Gb.Na));if(!a)return xa.a.J(512313373,822,50,"HandleClearAndResizeSlideCanvas: slideViewElement null"),16;if(1===c)return 32;xa.a.J(512313372,822,50,"HandleClearAndResizeSlideCanvas: updating slideViewElement");
a.s_e(!1);a.updateOffSlideView(0,!0);return 32}wAj(a,b,c){b=[];for(const f of this.Sb.ETa())f.gO&&Array.add(b,f);if(!b.length||!this.ta.Ba)return xa.a.J(512313371,822,50,"HandleDeleteFakeSlides: empty fake slides"),8;if(1===c)return 32;xa.a.J(512313370,822,50,"HandleDeleteFakeSlides: deleting fake slides");return this.ASf(b,"DeleteFakeSlide",a)}DAj(a,b,c){b=this.pa.Se();if(!b||!b.length||!this.ta.Ba)return 16;for(const f of b)if(!f||this.qf.$c(f))return 16;if(1===c)return 32;for(const f of b)if(!f.isConnected)return 16;
return this.ASf(b,"DeleteSlide",a)}ASf(a,b,c){Nc.a.Kb&&(Nc.a.Kb.actionName=b,Nc.a.Kb.vr=!1,Nc.a.Kb.Oj=!0,Nc.a.Kb.Wa("SlideCount",a.length.toString()));1<a.length?xa.a.J(512313369,822,50,"HandleDeleteSlides: Selected slidenodes: {0}",a.length):xa.a.J(512313368,822,50,"HandleDeleteSlides: Selected one slidenode.");b=this.Tb.Ef;if(!b)return 16;this.ESi(b,a,c,()=>{this.pa.nh()});return 32}ESi(a,b,c,f){f=this.Eb.xd(15,void 0,f);try{f.hc(a);for(const l of b)l&&!l.Db.equals(this.ta.Ba.Db)&&a.NI(l);a.NI(this.ta.Ba);
f.fd=c}finally{f&&f.dispose()}this.Ea.unblockContentWhenDeletingSlideEnabled||this.qf.rw(a,c);this.Tu?this.Tu.eod(new BE.a(b)):xa.a.J(512313367,822,10,"HandleDeleteSlides: graphOperationEventNotifier is null for raising event.")}$Dj(a,b,c,f,l){a=this.ta.Ba;if(!a)return 16;l.Hf(a.yn);return 32}aEj(a,b,c,f,l){a=this.pa.Se();if(!a||!a.length)return 16;a=this.gVd(a);l.Hf(a);return 32}tFj(a,b,c,f,l){a=this.ta.Ba;if(!a||this.qf.$c(a)||1!==this.pa.Se().length)return 16;if(1===c)return 32;Nc.a.Kb&&(Nc.a.Kb.vr=
!1,Nc.a.Kb.Wa("SlideCount","1"));c=a.Db;if(!c)return 16;c=JSON.stringify({["sId"]:c.sid,["cId"]:c.cid});l.nav=bS.a(c);l.mode="copy";xa.a.J(512313364,822,50,"HandleShareSlide: nav:{0}",c);this.ia.Ka(G.a.zta,2,l);return 32}zBj(a,b,c){b=this.ta.Ba;if(!b||this.qf.$c(b)||this.Ea.gD&&1!==this.pa.Se().length)return 16;if(1===c)return 32;Nc.a.Kb&&(Nc.a.Kb.vr=!1,Nc.a.Kb.Wa("SlideCount","1"));c=this.Eb.xd(15,void 0,()=>{this.Fa.Bd();this.pa.nh()},()=>{1!==this.Gb.ol&&(this.Ea.Un?this.Fa.vf(jb.a.lC):this.Fa.vf(Oi.a.iE))});
try{c.hc(b),c.fd=a,b.yn=!b.yn}finally{c&&c.dispose()}return 32}$ee(a,b,c){b=this.pa.Se();if(!b||!b.length)return 16;for(var f of b)if(!f||this.qf.$c(f))return 8;if(1===c)return 32;xa.a.J(512313363,822,50,"HandleHideSlidesOld: Selected slidenodes: {0}",b.length);Nc.a.Kb&&(Nc.a.Kb.vr=!1,Nc.a.Kb.Wa("SlideCount",b.length.toString()));c=!this.gVd(b);f=this.Eb.xd(15,void 0,()=>{this.Fa.Bd();this.pa.nh()},()=>{1!==this.Gb.ol&&(this.Ea.Un?this.Fa.vf(jb.a.lC):this.Fa.vf(Oi.a.iE))});try{f.hc(this.Tb.Ef);f.fd=
a;for(const l of b)l.yn=c}finally{f&&f.dispose()}return 32}ABj(a,b,c,f,l){const y=this.pa.Se();if(!y||!y.length)return 16;for(const H of y)if(!H||this.qf.$c(H))return 8;if(this.gVd(y))return this.BYc(),32;this.$ee(a,b,c,f,l);this.BYc();return 32}mGj(a,b,c,f,l){const y=this.pa.Se();if(!y||!y.length)return 16;for(const H of y)if(!H||this.qf.$c(H))return 8;if(1===c)return 32;this.$ee(a,b,c,f,l);this.BYc();return 32}BYc(){var a=this.pa.Se();if(a&&a.length){for(var b of a)if(!b||this.qf.$c(b))return;if(tg.c()){b=
!0;for(const c of a)if(!c.yn){b=!1;break}a=[appChrome.actions.updateControlHiddenState("HideSlide",b),appChrome.actions.updateControlEnabledDisabledState("UnhideSlide",!b),appChrome.actions.updateControlHiddenState("UnhideSlide",!b)];appChrome.api.dispatch(a)}else xa.a.J(512313362,822,50,"HandleToggleHiddenBehavior: appChrome not defined")}}Ryl(){this.BYc()}uQl(a,b,c,f,l){if(1===c)return 32;this.ta.Ba&&(a="Slide Complex: "+this.ta.Ba.sa(zb.a.Yoa,0).toString(),l[Mp.a.Value]=a,l[nm.a.labelText]=a,l[Mp.a.Visible]=
!0);return 32}MAj(a,b,c,f,l){if(this.Fa.Ee)if(this.Fa.C8===Oi.a.iE)a=ea.a.tQ;else if(this.Fa.C8===jb.a.vg)a=ea.a.F9a;else return 8;else return 8;return this.ia.Ka(a,c,l)}OAj(a,b,c){b=this.ta.Ba;if(!b||this.qf.$c(b)||this.Ea.gD&&1!==this.pa.Se().length)return 16;if(1===c)return 32;Nc.a.Ak("SlideCount","1");this.tA.y0i(b,a).nO||this.qf.rw(this.Tb.Ef,a);return 32}PAj(a,b,c){b=this.pa.Se();if(!b||!b.length)return 16;for(var f of b)if(!f||this.qf.$c(f))return 16;if(1===c)return 32;1<b.length?xa.a.J(512313361,
822,50,"HandleDuplicateSlides: Selected slidenodes: {0}",b.length):xa.a.J(512313360,822,50,"HandleDuplicateSlides: Selected one slidenode.");Nc.a.Ak("SlideCount",b.length.toString());c=this.tA.DYf(b,a,null,null,!0);f=!0;for(const l of c)if(!l.nO){f=!1;break}f||this.qf.rw(this.Tb.Ef,a);return 32}Oyj(){try{xa.a.J(512313359,801,50,"SlideActor: HandleAddFirstSlide called.");const a=this.Sb.XI();a&&0<a.length&&this.tA.SRc(null,a[0].Id,this.Ea.Ecc?0:a[0].ContentMasters[0].Id,ea.a.sIb);return 32}catch(a){return xa.a.J(512313358,
801,10,"Exception in HandleAddFirstSlide: {0}.",a),8}}dfe(a,b,c,f,l){return l&&Object(Wa.a)(Va.a,l)?this.qf.$c(this.Sb.Zk(l))?16:32:8}gVd(a){for(const b of a)if(!b.yn)return!1;return!0}}Object(m.a)(LN,"SlideActor",null,[251]);var cS=d(1167);const LE=()=>{appChrome.PRIToastManager.dismissToast()};class ME{constructor(a,b,c){this.slideId=a;this.otk=b;this.rHi=c}}Object(m.a)(ME,"NewSlideWithLayoutData",null,[]);class $i{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec){this.mwa=0;this.d9c={};this.uYg=this.vYg=
0;this.ia=a;this.$b=b;this.Fa=c;this.wjk=$i.LVj(f);this.pa=l;this.Eb=y;this.tA=H;this.Tb=Q;this.ta=ia;this.Sb=wa;this.Ove=Ua;this.Uu=kb;this.Uu.eJc(Object(I.a)(this,this.Ich,"openIgnoredDialog"));this.Ea=Gb;this.CGb=ec;this.Mwa={}}vb(){this.Ea.Z0j?this.ia.ra(ea.a.Dja,hc.a.application,Object(I.a)(this,this.Yfg,"handleSlidesChangeLayout"),4):this.ia.ra(ea.a.Dja,hc.a.application,Object(I.a)(this,this.Uzj,"handleChangeLayout"),4);this.ia.ra(ea.a.$na,hc.a.application,Object(I.a)(this,this.pfg,"handleNewSlideWithLayoutOptions"),
4);this.ia.ra(ea.a.X5,hc.a.application,Object(I.a)(this,this.ofg,"handleNewSlideWithDefaultLayout"),4);this.ia.ra(ea.a.sIb,hc.a.application,Object(I.a)(this,this.ofg,"handleNewSlideWithDefaultLayout"),4);this.ia.ra(ea.a.bhd,hc.a.application,Object(I.a)(this,this.PCj,"handleNewSlideWithLayout"),4);this.ia.ra(ea.a.XJb,hc.a.application,Object(I.a)(this,this.pfg,"handleNewSlideWithLayoutOptions"),4);this.ia.ra(ea.a.E_c,hc.a.application,Object(I.a)(this,this.yEj,"handleReactInsertSlideWithLayout"),4);
this.ia.ra(ea.a.nPe,hc.a.application,Object(I.a)(this,this.Yfg,"handleSlidesChangeLayout"),4);this.ia.ra(ea.a.pYd,hc.a.application,Object(I.a)(this,this.xEj,"handleReactChangeSlideLayout"),4);this.ia.ra(ea.a.Rmd,hc.a.application,Object(I.a)(this,this.Rmd,"queryNewSlideLayout"),4);this.ia.ra(ea.a.ERe,hc.a.application,Object(I.a)(this,this.ERe,"queryChangeSlideLayout"),4)}pe(){const a=this.Fa.Fc(Oi.a.iE),b=this.Fa.Fc(Oi.a.o3),c=this.Fa.Fc(jb.a.vg),f=this.Fa.Fc(jb.a.vQ);a.bindAction(x.KeyInputManager.Qa(B.a.Dp,
0),ea.a.X5);a.bindAction(x.KeyInputManager.Qa(B.a.xha,x.KeyInputManager.Re),ea.a.X5);c.bindAction(x.KeyInputManager.Qa(B.a.xha,x.KeyInputManager.Re),ea.a.X5);b.bindAction(x.KeyInputManager.Qa(B.a.xha,x.KeyInputManager.Re),ea.a.X5);f.bindAction(x.KeyInputManager.Qa(B.a.xha,x.KeyInputManager.Re),ea.a.X5)}Rtc(){return this.wjk||this.Sb.Lfe()}Uzj(a,b,c){const f=this.ta.Ba;if(!f||this.$b.$c(f)||this.Ea.gD&&1!==this.pa.Se().length)return 16;a=f.jj;if(!a)return 8;b=this.Sb.XI();if(!this.Ea.iWa){if(!b)return xa.a.J(512500229,
822,10,"SlideLayoutActor::HandleChangeLayout fails to get mainMasters"),8;if(!this.Cnb(b,a))return 8}if(1===c)return 32;if((!this.Ea.iWa||b&&this.Cnb(b,a))&&this.Uu.bP.Fb(a)&&this.Bre()){this.mwa=0;c=f.Ln;if(!c)return xa.a.J(512500227,822,10,"SlideLayoutActor::HandleChangeLayout fails to get contentMasterId"),8;this.Ove.D0d(0,this.Sb.Ou(),b,this.Uu.bP,a,Object(I.a)(this,this.pYd,"changeSlideLayout"),this.Rtc(),w.AFrameworkApplication.isRtl).mud(c)}else xa.a.J(512500228,822,50,"SlideLayoutActor::HandleChangeLayout does not have MainMasterResources ready yet"),
this.Uu.D3e(a),this.mwa=ea.a.Dja;return 32}Yfg(a,b,c,f,l){b=this.pa.Se();if(!b||!b.length)return 8;f=0;const y=[],H=this.Sb.XI();if(!H)return xa.a.J(512500226,822,10,"SlideLayoutActor::HandleSlidesChangeLayout fails to get mainMasters"),8;for(var Q of b){if(this.$b.$c(Q)||!Q)return 16;f=Q.jj;if(!f)return xa.a.J(512500225,822,50,"SlideLayoutActor::HandleSlidesChangeLayout MainmasterId is 0"),8;y.push(f);if(!this.Ea.iWa&&!this.Cnb(H,f))return xa.a.J(512500224,822,50,"SlideLayoutActor::HandleSlidesChangeLayout fails to validate masters"),
8}if(1===c&&!this.Ea.n0a)return 32;for(const ia of y)if(this.Ea.iWa&&!this.Cnb(H,f)||!this.Uu.bP.Fb(ia)){xa.a.J(512500195,822,50,"SlideLayoutActor::HandleSlidesChangeLayout does not have MainMasterResources ready yet");this.Uu.D3e(f);if(this.Ea.n0a)return this.xfe(a,c,()=>{this.Uu.eJc(LE)},l);this.mwa=ea.a.Dja;return 32}Q=this.mwa=0;for(const ia of b)if(Q=ia.Ln,!Q)return xa.a.J(512500194,822,10,"SlideLayoutActor::HandleSlidesChangeLayout fails to get contentMasterId"),8;1<b.length?xa.a.J(512500193,
822,50,"HandleSlidesChangeLayout: Selected slidenodes: {0}",b.length):xa.a.J(512500192,822,50,"HandleSlidesChangeLayout: Selected one slidenode.");1<b.length&&(Q=0);if(!this.Bre())return xa.a.J(512500191,822,50,"HandleSlidesChangeLayout: Layout masters not ready yet "),eb.a("RaiseFirstMasterRetrievedEvent")?this.xfe(a,c,()=>{this.Uu.Agi(LE)},l):8;if(this.Ea.n0a){if(1===c)return 32;if(!l)return 8;this.uYg=Q;this.Nld(l,H,f,!0)}else this.Ove.D0d(0,this.Sb.Ou(),H,this.Uu.bP,f,Object(I.a)(this,this.bJf,
"changeSlidesLayout"),this.Rtc(),w.AFrameworkApplication.isRtl).mud(Q);return 32}pYd(a,b){const c=this.ta.Ba;if(c){var f=()=>{this.Fa.Bd();this.pa.nh()},l=()=>{this.Fa.vf(Oi.a.iE)};a=parseInt(a);b=parseInt(b);if(a!==c.jj||b!==c.Ln){const y=Nc.a.Kb;Nc.a.Axd("ChangeSlideLayout");Nc.a.Kb&&(Nc.a.Kb.vr=!0,Nc.a.Kb.Wa("SlideCount","1"));f=this.Eb.xd(15,void 0,f,l);try{f.hc(c),f.fd=ea.a.Dja,c.jj=a,c.Ln=b}finally{f&&f.dispose()}this.$b.rw(c,"ChangeSlideLayout");Nc.a.Kb=y}}}bJf(a,b){const c=this.pa.Se();if(c&&
c.length){a=parseInt(a);b=parseInt(b);var f=Nc.a.Kb;Nc.a.Axd("ChangeSlidesLayout");Nc.a.Kb.vr=!0;var l=[];for(var y of c)a===y.jj&&b===y.Ln||l.push(y);if(l.length){Nc.a.Ak("SlideCount",l.length.toString());y=this.Eb.xd(15,void 0,()=>{this.Fa.Bd();this.pa.nh()},()=>{this.Fa.vf(Oi.a.iE)});try{y.hc(this.ta.Ba);y.fd=ea.a.Dja;for(const H of l)H.jj=a,H.Ln=b}finally{y&&y.dispose()}for(const H of c)this.$b.rw(H,"ChangeSlidesLayout");Nc.a.Kb=f}}}xEj(a,b,c,f,l){if(1===c)return 32;if(!l)return 8;try{let y,H;
if(!({masterId:y,layoutId:H}=this.X7e(l.SourceControlId)).returnValue)return 8;xa.a.J(512500189,822,50,"SlideLayoutActor:: React Change Layout Dropdown invoked command to Change Layout.");this.bJf(y,H)}catch(y){return xa.a.J(512500188,822,10,"SlideLayoutActor:: react change slide layout failed with Exception {0} ",y),8}return 32}pfg(a,b,c,f,l){f=this.Tb.Ef;if((b=this.ta.Ba)&&this.$b.$c(b)||this.$b.$c(f))return xa.a.J(512500187,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutOptions Graph node blocked"),
16;f=this.Sb.XI();if(!f||!f.length)return xa.a.J(512500186,822,10,"SlideLayoutActor::HandleNewSlideWithLayoutDialog fails to get mainMasters"),8;let y=0;if(b){if(y=b.jj,!y)return xa.a.J(512500185,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutDialog MainMasterId is 0"),8}else y=f[0].Id;let H=0;({jj:y,Ln:H}=this.WUc(f,b));if(!this.Ea.iWa&&!this.Cnb(f,y))return xa.a.J(512500184,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutDialog fails to validate mainMasters"),8;if(1===c){if(!this.Sb.Cj())return 8;
if(!this.Ea.n0a)return 32}if(this.Ea.iWa&&!this.Cnb(f,y)||!this.Uu.bP.Fb(y)||!this.Bre()){xa.a.J(512500183,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutDialog does not have MainMasterResources ready yet");this.Uu.D3e(y);if(this.Ea.n0a)return this.xfe(a,c,()=>{this.Uu.eJc(LE)},l);this.mwa=ea.a.$na}else if(this.mwa=0,this.Ea.n0a){if(1===c)return 32;if(!l)return 8;this.vYg=H;this.Nld(l,f,y,!1)}else this.Ove.D0d(1,this.Sb.Ou(),f,this.Uu.bP,y,Object(I.a)(this,this.E_c,"insertSlideWithLayout"),this.Rtc(),
w.AFrameworkApplication.isRtl).mud(H);return 32}Nld(a,b,c,f){a.MenuId&&"style"===a.MenuId||(a.MenuItems=eb.a("ReactSlideLayoutSectionsAPIEnabled")?this.$7b(b,c,f):this.Zoj(b,c,f));xa.a.J(512500182,822,50,"SlideLayoutActor:: React Slide Layout DropDown Invoked. Type : IsChangeLayout : {0}  ",f)}Cce(){const a=this.Sb.Ou();if(!a||!a.width||!a.height)return xa.a.J(512500181,822,15,"SlideLayoutActor:: Slide size is null or 0"),new vr.a($i.HGf,$i.rui);const b=$i.HGf;return new vr.a(b,a.height/a.width*b)}AVc(){const a=
{},b={},c=this.Cce();b.root=this.n1d(c.width+$i.PGf,c.height+$i.PGf+$i.kui+$i.yui);b.flexContainer={flexDirection:"column"};b.label=$i.U0d();a.galleryButtonInExpanded=b;return a}n1d(a,b){const c={};c.width=a;c.height=b;c.backgroundColor="transparent";return c}Zoj(a,b,c){this.Cod();const f=Object.assign(new On.a,{Id:c?"PptRibbon.ChangeLayout":"PptRibbon.NewSlideLayout",MenuSectionList:[],UpdateDynamically:!0});let l=0,y=!1;const H=a.length;if(!H||1===H&&a&&a[0]&&!a[0].InContent)return f;for(var Q=
0;Q<H;Q++)a[Q].Id===b&&(l=Q,y=!0);y&&(b=this.e9f(a[l],b,c,l),Array.add(f.MenuSectionList,b));for(b=0;b<H;b++)y&&b===l||(Q=this.e9f(a[b],a[b].Id,c,b),Array.add(f.MenuSectionList,Q));return f}e9f(a,b,c,f){const l=Object.assign(new Rk.a,{ControlList:[],Title:a.Name});if(!(a.InContent&&this.Uu.bP&&this.Uu.bP.Fb(a.Id)))return l;var y=this.AVc(),H=c?"ChangeLayout":"NewSlide",Q=c?"ChangeLayoutControls":"NewSlideLayoutControls";$i.dfd++;f=eb.a("ReactSlideLayoutUniqueIdFix")?f.toString():b.toString()+"_"+
$i.dfd.toString();y=Object.assign(new Cq.a,{Id:Q,ExternalId:H+"_"+f,Type:4,Title:a.Name,GalleryStyle:y,Width:3,GalleryItems:[]});a=a.ContentMasters;if(!a)return l;H=a.length;for(Q=0;Q<H;Q++)f=a[Q],!f||!this.Rtc()&&this.Sb.Zbb(f)||Array.add(y.GalleryItems,this.Fxb(f,b,c));Array.add(l.ControlList,y);return l}aBi(){try{const a=[],b=this.Mwa;for(let c in b)a.push(c);this.Mwa={};this.d9c={};appChrome.api.unregisterIcons(a)}catch(a){xa.a.J(512500180,822,15,"SlideLayoutActor::Failed to unregister icons for react new slide layout {0}",
a)}}Cod(){this.aBi();try{const a=this.Sb.XI();if(a){for(let b=0;b<a.length;b++){const c=a[b];c&&this.Uu.bP&&this.Uu.bP.count&&this.Uu.bP.Fb(c.Id)&&this.addIconToMap(this.Uu.bP.ga(c.Id).LayoutIcons,c.Id)}appChrome.api.registerIconProvider(()=>this.Mwa)}}catch(a){xa.a.J(512500179,822,15,"SlideLayoutActor::Failed to register icons for react new slide layout {0}",a)}}a8b(a,b){a=String.format("{0}_{1}_{2}",$i.TJj,a,b);a in this.d9c||($i.dfd++,this.d9c[a]=a+"_"+$i.dfd.toString());return this.d9c[a]}addIconToMap(a,
b){if(this.ta.Ba&&a)for(let f=0;f<a.length;++f){var c=a[f];if(!c)continue;const l=this.a8b(b,c.LayoutId),y={},H={};c.Icon&&c.Icon.Clip&&c.Icon.Clip.Bounds&&(H.top=String.format("-{0}px",c.Icon.Clip.Bounds.Top),w.AFrameworkApplication.isRtl&&eb.a("ReactSlideLayoutRTLFix")?H.right=String.format("-{0}px",c.Icon.Clip.Bounds.Left):H.left=String.format("-{0}px",c.Icon.Clip.Bounds.Left));H.position="absolute";const Q={},ia={},wa=this.Cce();ia.height=wa.height.toString()+"px";ia.width=wa.width.toString()+
"px";ia.position="relative";ia.overflow="hidden";ia.display="inline-block";Q.root=ia;y.root=H;this.CGb&&c.Icon&&(c=appChrome.buildLayoutImageIconFromUrlWithStyles(this.CGb.resolve(Dh.a.rwb,c.Icon.ImgId,$i.evi),y,Q),this.Mwa[l]=c)}}$7b(a,b,c){this.Cod();const f=Object.assign(new On.a,{Id:c?"PptRibbon.ChangeLayout":"PptRibbon.NewSlideLayout",MenuSectionList:[],UpdateDynamically:!0});var l=Object.assign(new Rk.a,{Id:c?"ChangeLayoutMenuSection":"NewSlideLayoutMenuSection",ControlsId:c?"ChangeLayoutMenuSection.Controls":
"NewSlideLayoutMenuSection.Controls",ControlList:[]});Array.add(f.MenuSectionList,l);var y=this.AVc();y=Object.assign(new Cq.a,{Id:c?"ChangeLayoutControls":"NewSlideLayoutControls",ExternalId:c?"ChangeLayoutSection":"NewSlideSection",ExternalGalleryId:c?"ChangeLayoutGallery":"NewSlideGallery",GalleryStyle:y,Width:3,Type:4,GallerySections:[]});Array.add(l.ControlList,y);l=0;let H=!1;const Q=a.length;xa.a.J(512500178,822,50,"React Slide layout: Count of main masters :{0}",Q);if(!Q||1===Q&&a&&a[0]&&
!a[0].InContent)return xa.a.J(512500177,822,10,"React Slide layout rendered empty as main masters not loaded; Type: IsChangelayout:{0} cMainMasters: {1} InContent: {2} ",c,Q,1===Q&&!!a&&!!a[0]&&a[0].InContent),f;for(var ia=0;ia<Q;ia++)a[ia].Id===b&&(l=ia,H=!0);H&&(b=this.hgh(a[l],b,c),y.GallerySections.push(b));for(b=0;b<Q;b++)H&&b===l||(ia=this.hgh(a[b],a[b].Id,c),y.GallerySections.push(ia));return f}hgh(a,b,c){const f=Object.assign(new cS.a,{SectionId:b.toString(),Title:a.Name,GalleryButtons:[]});
if(!(a.InContent&&this.Uu.bP&&this.Uu.bP.Fb(a.Id)))return xa.a.J(512500176,822,50,"React Slide layout: Gallery section rendered empty as main masters not loaded;Type: IsChangelayout:{0} , mainMaster.InContent: {1} , presentatonresourcemanager contains main master : {2} ",c,a.InContent,!!this.Uu.bP&&this.Uu.bP.Fb(a.Id)),f;a=a.ContentMasters;if(!a)return xa.a.J(512500175,822,50,"React Slide layout: Gallery section rendered empty as content master is null ;Type: IsChangelayout:{0} ",c),f;const l=a.length;
for(let y=0;y<l;y++){const H=a[y];!H||!this.Rtc()&&this.Sb.Zbb(H)||Array.add(f.GalleryButtons,this.Fxb(H,b,c))}return f}LEa(a,b,c){return eb.a($i.ZIf)?(c?"ChangeLayoutButton_":"NewSlideLayoutButton_")+a+"_"+b:a+"_"+b}Fxb(a,b,c){const f=a.Id,l=this.LEa(b.toString(),f.toString(),c),y={},H={},Q=this.Cce();H.width=Q.width.toString()+"px";H.height=Q.height.toString()+"px";eb.a("ReactNewSlideLayoutIconBorderFix")||(H.border="#858585 1px solid");y.root=H;return Object.assign(new kE.a,{Id:l,ExternalId:l,
Icon:this.a8b(b,f),Command:c?"3430900587":"1579226270",QueryCommand:eb.a("NewSlideLayoutShowCurrentLayout")?c?"630989293":"2230133927":null,LabelText:a.Name,FullIconStyle:y,Alt:a.Name})}ofg(a,b,c){if(this.$b.hO(this.Tb.Ef))return 16;b=this.Sb.XI();if(!b)return 8;let f=null;if(this.Ea.gD){var l=this.pa.Se();1<=l.length&&(l.sort((H,Q)=>H.ue-Q.ue),a!==ea.a.sIb&&(f=l[l.length-1]))}else a!==ea.a.sIb&&(f=this.ta.Ba);if(this.$b.$c(f))return 16;let y;({jj:l,Ln:y}=this.WUc(b,this.ta.Ba));if(!this.Cnb(b,l))return 8;
if(1===c)return 32;c=this.tA.SRc(Object(qa.a)(118,f),l,y,a);this.Hxf(l,y);c.nO||this.$b.rw(c,a);return 32}PCj(a,b,c,f,l){if(this.$b.hO(this.Tb.Ef))return 16;if(1===c)return 32;if(!l)return 8;c=l.slideId;b=l.otk;l=l.rHi;f=null;this.Ea.gD?(c=this.pa.Se(),1<=c.length&&(c.sort((y,H)=>y.ue-H.ue),f=c[c.length-1])):f=this.Sb.Zk(c);c=this.tA.SRc(f,b,l,a);this.Hxf(b,l);c.nO||this.$b.rw(c,a);return 32}dispose(){this.Uu.h8k(Object(I.a)(this,this.Ich,"openIgnoredDialog"));this.Mwa=null}E_c(a,b){const c=this.ta.Ba;
let f=Va.a.empty;c&&(f=c.Db);const l=this.Sb.XI();l&&("0"===a||"0"===b?{jj:a,Ln:b}=this.WUc(l,c):(a=parseInt(a),b=parseInt(b)),this.ia.Ka(ea.a.bhd,2,new ME(f,a,b)))}yEj(a,b,c,f,l){if(1===c)return 32;if(!l||!({masterId:c,layoutId:b}=this.X7e(l.SourceControlId)).returnValue)return 8;f=this.ta.Ba;a=Va.a.empty;f&&(a=f.Db);l=this.Sb.XI();if(!l)return 8;"0"===c||"0"===b?{jj:c,Ln:b}=this.WUc(l,f):(c=parseInt(c),b=parseInt(b));xa.a.J(512500172,822,50,"SlideLayoutActor:: React New Slide Dropdown invoked command to insert new slide.");
return this.ia.Ka(ea.a.bhd,2,new ME(a,c,b))}WUc(a,b){let c,f;f=c=0;if(!this.V1i(a))return{jj:c,Ln:f};if(b){c=b.jj;if(!c)return{jj:c,Ln:f};if(!this.Ea.Ecc||this.s2i(c)){f=b.Ln;if(!f)return{jj:c,Ln:f};if(b.sWa)for(b=0;b<a.length;b++)if(a[b].Id===c&&1<a[b].ContentMasters.length){f=a[b].ContentMasters[1].Id;break}}}else c=a[0].Id,f=this.Ea.Ecc?0:a[0].ContentMasters[0].Id;return{jj:c,Ln:f}}MYf(a,b,c){if(1===a)return 32;a=this.X7e(b.SourceControlId);if(!a.returnValue)return 8;a.layoutId&&"0"!==a.layoutId&&
(b[mm.a.On]=a.layoutId===(c?this.uYg.toString():this.vYg.toString()));return 32}Rmd(a,b,c,f,l){return this.MYf(c,l,!1)}ERe(a,b,c,f,l){return this.MYf(c,l,!0)}X7e(a){let b,c;c=b=null;if(!a)return xa.a.J(512500171,822,10,"SlideLayoutActor::Unable to get master id and layout id from action data"),{returnValue:!1,masterId:b,layoutId:c};a=a.split("_");const f=eb.a($i.ZIf),l=f?1:0,y=f?2:1;if(!a||a.length!==(f?3:2))return xa.a.J(512500170,822,10,"SlideLayoutActor::Unable to get master id and layout id from action data"),
{returnValue:!1,masterId:b,layoutId:c};b=a[l];c=a[y];return{returnValue:!0,masterId:b,layoutId:c}}V1i(a){if(0===a.length)return!1;for(let b=0;b<a.length;++b)if(0!==a[b].ContentMasters.length)return!0;return!1}Ich(){this.mwa&&(xa.a.J(512500169,822,50,"SlideLayoutActor::OpenIgnoredDialog is auto-opening dialog {0}",this.mwa===ea.a.Dja?"ChangeLayout":"NewSlide"),this.ia.processAction(this.mwa,2));this.mwa=0}Cnb(a,b){for(let c=0;c<a.length;c++)if(a[c].Id===b)return!0;return!1}Hxf(a,b){Nc.a.Ak("MainMasterId",
a.toString());Nc.a.Ak("ContentMasterId",b.toString());const c=this.Sb.XI(),f=new Sys.StringBuilder;if(c){for(let l=0;l<c.length;l++)f.appendLine(String.format("MainMasterId={0}, ContentMasterCount={1}; ",c[l].Id,c[l].ContentMasters.length));xa.a.J(512500168,813,50,"Insert slide with layout: MainMasterCount={0}. {1}. SelectedMainMasterId={2}, SelectedContentMasterId={3}",c.length,f,a,b)}}Bre(){return this.Uu.vDf()}s2i(a){if(0===a)return!1;const b=this.Sb.Hxb();if(b&&0<b.length)for(const c of b)if(c.idField===
a&&0<c.layoutCountField)return!0;return!1}xfe(a,b,c,f){this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)?1===b?a=32:2===b?(b={},f=!!f&&f.IsShadowMenuOpen,b.payload={["isShadowRendering"]:f},w.AFrameworkApplication.PJb.handleCommand(vf.ActionManager.i7a(a),b),f||c(),a=2):a=8:a=8;return a}static LVj(a){return a===$i.vui||a===$i.wui||a===$i.tui||a===$i.xui||a===$i.uui}static U0d(){return{"margin-top":"5px","max-width":"100px","font-size":"10px"}}}$i.vui=1041;$i.wui=
1042;$i.tui=2052;$i.xui=1028;$i.uui=3076;$i.TJj="LayoutIcon";$i.ZIf="ReactSlideLayoutButtonIdChange";$i.evi="SlideLayoutActor";$i.HGf=145;$i.rui=82;$i.PGf=24;$i.kui=14;$i.yui=5;$i.dfd=1;Object(m.a)($i,"SlideLayoutActor",null,[251,107]);class MN{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb){this.mG=this.L$=this.dgb=this.M$=null;this.ia=a;this.jR=b;this.Fa=c;this.$b=f;this.tA=l;this.Tb=y;this.ta=H;this.oc=Q;this.De=ia;this.Eve=wa(500,Object(I.a)(this,this.pld,"performKeyboardThumbnailReorder"));this.pa=
Ua;this.Bn=kb;this.rfa=Gb}vb(){this.ia.ra(ea.a.Jlc,yb.a.application,Object(I.a)(this,this.ICj,"handleMoveSlide"),4);this.ia.ra(ea.a.I4g,yb.a.application,Object(I.a)(this,this.JCj,"handleMoveSlideById"),4);this.ia.ra(ea.a.Mhb,hc.a.application,Object(I.a)(this,this.uYc,"handleReorderSlide"),4);this.ia.ra(ea.a.Jhb,hc.a.application,Object(I.a)(this,this.uYc,"handleReorderSlide"),4);this.ia.ra(ea.a.Lhb,hc.a.application,Object(I.a)(this,this.uYc,"handleReorderSlide"),4);this.ia.ra(ea.a.Khb,hc.a.application,
Object(I.a)(this,this.uYc,"handleReorderSlide"),4);this.ia.ra(ea.a.Klc,hc.a.application,Object(I.a)(this,this.iAj,"handleCommitPendingMoveSlideData"),4);this.ia.ra(ea.a.Llc,hc.a.application,Object(I.a)(this,this.SDj,"handleQueryCommitMoveSlideDataEnabled"),100)}pe(){const a=this.Fa.Fc(Oi.a.iE);a.bindAction(x.KeyInputManager.Qa(B.a.n2,x.KeyInputManager.Re),ea.a.Mhb);a.bindAction(x.KeyInputManager.Qa(B.a.m2,x.KeyInputManager.Re),ea.a.Jhb);a.bindAction(x.KeyInputManager.Qa(B.a.n2,x.KeyInputManager.Re|
4),ea.a.Lhb);a.bindAction(x.KeyInputManager.Qa(B.a.m2,x.KeyInputManager.Re|4),ea.a.Khb)}JCj(a,b,c,f,l){a=this.ta.presentation;if(!a)throw Error.argumentNull("Presentation is null");if(!this.rfa&&(this.Bn&&1<this.pa.Se().length||this.$b.EVa()))return 16;if(1===c)return 32;if(!l)return xa.a.J(50348433,822,10,"HandleMoveSlideById with no null action data."),8;b=l.Ufa;c=[];for(var y of b)(b=a.ZC(y))?c.push(b):xa.a.J(50348435,822,15,"HandleMoveSlideById: slide node is null for given Sid:{0}, Cid:{1}.",
y.sid,y.cid);y=l.Ba?a.ZC(l.Ba):null;b=a.ZC(l.Dlc);f=null;0<=l.sectionIndex&&(f=a.Cag(l.sectionIndex));return this.mfg(c,b,y,f,l.koe)}ICj(a,b,c,f,l){return!this.rfa&&(this.Bn&&1<this.pa.Se().length||this.$b.EVa())?16:1===c?32:l?this.mfg(l.Ufa,l.Dlc,l.Ba,null,l.koe):8}mfg(a,b,c,f,l){if(this.rfa)for(var y of a)if(!y||this.$b.$c(this.oc.Zk(y.Db)))return 16;y=[];for(var H of a){if(!H)continue;const Q=this.oc.Zk(H.Db);Q?y.push(Q):xa.a.J(591737178,822,15,"HandleMoveSlideById: slide node is null for given Sid:{0}, Cid:{1}.",
H.Db.sid,H.Db.cid)}if(H=Nc.a.Kb)H.Oj=!0,H.FF||(H.FF=new Date),y&&H.Wa("SlideCount",a.length.toString());H=null;l||(this.rfa?c&&(H=c):a&&0<a.length&&(H=a[0]),H&&!this.Tb.Ba.Db.equals(H.Db)&&(this.Tb.Ba=this.oc.Zk(H.Db)));a=b?this.oc.Zk(b.Db):null;this.tA.F0i(y,a,f);return 32}uYc(a,b,c){if(this.jR.R_||!this.ta.Ba||this.$b.$c(this.Tb.Ef)||!this.rfa&&this.Bn&&1<this.pa.Se().length)return 16;if(1===c)return 32;if(this.rfa){b=this.pa.Se();if(!b||!b.length)return 16;this.XFl(b,a)}else this.SFl(this.ta.Ba,
a);return 32}iAj(a,b,c){if(this.$b.$c(this.Tb.Ef)||!this.zJf())return 16;if(1===c)return 32;this.pld();return 32}SDj(){return this.M$?32:16}rtb(a){if(!a||!a.length)return!1;if(1<a.length)for(let b=0;b<a.length-1;b++)if(1!==a[b+1].slideIndex-a[b].slideIndex)return!1;return!0}SFl(a,b){var c=this.ta.presentation;if(!c)throw Error.argumentNull("Presentation is null");var f=this.De.iZ;if(!(1>=f)){var l=!1;this.dgb||(this.dgb=a,this.mG=c.slides||[],l=!0);a=-1;for(c=0;c<f;c++)if(this.mG[c]&&this.dgb.Db.equals(this.mG[c].Db)){a=
c;break}if((b!==ea.a.Mhb&&b!==ea.a.Lhb||a)&&(b!==ea.a.Jhb&&b!==ea.a.Khb||a!==f-1)){switch(b){case ea.a.Mhb:b=a-1;break;case ea.a.Jhb:b=a+1;break;case ea.a.Lhb:b=0;break;case ea.a.Khb:b=f-1;break;default:return}Array.removeAt(this.mG,a);Array.insert(this.mG,b,this.dgb);for(l=0;l<f;l++)this.mG[l]?this.mG[l].ue=l:xa.a.J(576758465,822,50,"Attempted to set ThumbnailSlideIndex on a null slide - slide {0} of {1} is null",l,f);this.De.Uya(b);f=new Tx(!0,[this.dgb],0<b?this.mG[b-1]:null);this.BDf(f)}else l&&
(this.mG=this.dgb=null)}}XFl(a,b){var c=this.ta.presentation;if(!c)throw Error.argumentNull("Presentation is null");var f=this.De.iZ;if(!(1>=f)&&(a.sort((y,H)=>y.slideIndex-H.slideIndex),this.rtb(a))){var l=!1;this.L$||(this.L$=a,this.mG=c.slides||[],l=!0);a=this.iXc(this.L$[0],this.mG);c=this.iXc(this.L$[this.L$.length-1],this.mG);if((b!==ea.a.Mhb&&b!==ea.a.Lhb||a)&&(b!==ea.a.Jhb&&b!==ea.a.Khb||c!==f-1)){l=null;switch(b){case ea.a.Mhb:l=0<=a-2?this.mG[a-2]:null;b=a-1;break;case ea.a.Jhb:b=a+this.L$.length<
f?a+this.L$.length:f-1;l=this.mG[b];break;case ea.a.Lhb:l=null;b=0;break;case ea.a.Khb:l=this.mG[f-1];b=f-1;break;default:return}for(a=this.L$.length-1;0<=a;a--)this.Pji(this.L$[a],l);for(a=0;a<f;a++)this.mG[a]?this.mG[a].ue=a:xa.a.J(576758466,822,50,"Attempted to set ThumbnailSlideIndex on a null slide - slide {0} of {1} is null",a,f);this.De.Uya(b);f=new Tx(!0,this.L$,l);this.BDf(f)}else l&&(this.mG=this.L$=null)}}Pji(a,b){const c=this.iXc(a,this.mG);Array.removeAt(this.mG,c);b=this.iXc(b,this.mG)+
1;Array.insert(this.mG,b,a)}iXc(a,b){if(a&&b)for(let c=0;c<b.length;c++)if(a.Db.equals(b[c].Db))return c;return-1}eni(a,b){if(!a||!b)return a!==b?!1:!0;if(a.length!==b.length)return!1;for(const c of a){a=!1;for(const f of b)if(c&&f&&c.Db.equals(f.Db)){a=!0;break}if(!a)return!1}return!0}BDf(a){if(!a)throw Error.argumentNull("moveData");this.rfa?this.eni(this.L$,a.Ufa)||this.pld():this.M$&&this.M$.Ufa&&a.Ufa&&this.M$.Ufa[0]&&a.Ufa[0]&&!this.M$.Ufa[0].Db.equals(a.Ufa[0].Db)&&this.pld();this.M$=a;this.Eve.perform()}pld(){if(this.zJf()){var a=
this.M$;this.L$=this.dgb=this.M$=null;Array.clear(this.mG);this.ia.Ka(ea.a.Jlc,2,a)}}zJf(){const a=this.ta.presentation;if(!a)throw Error.argumentNull("Presentation is null");if(!this.M$)return!1;let b=!0,c=!this.M$.Dlc;for(let f=0;f<this.M$.Ufa.length;f++)b=!!a.ZC(this.M$.Ufa[f].Db)&&b;c||(c=!!a.ZC(this.M$.Dlc.Db));return b&&c}}Object(m.a)(MN,"SlideMoveActor",null,[251]);class fy extends ix.a{constructor(){super();this.TableStyles=this.TableCellStyles=null;this.columns=0}}Object(m.a)(fy,"TableGalleryButtonProps",
ix.a,[]);class NN extends fy{constructor(){super()}get Type(){return 8}}Object(m.a)(NN,"ChangeColorsGalleryButtonProps",fy,[]);class ON{constructor(){this.hasMath=this.fReverseEnabled=this.fReverseChecked=!1;this.SemanticNodes=null;this.SmartArtLayout=0}}Object(m.a)(ON,"SmartArtInfo",null,[]);var wt=d(501);class Pi{constructor(a,b,c){this.jG=a;this.Cmk=b;this.mpk=c}get id(){return this.jG}get parameter(){return this.Cmk}get Frh(){return this.mpk}}Object(m.a)(Pi,"SmartArtColorInfo",null,[]);class PN{constructor(a,
b,c,f,l,y,H,Q,ia,wa,Ua,kb){this.nq=[];this.ia=a;this.$b=b;this.kb=c;this.Eb=f;this.Fa=l;this.ta=y;this.Rq=H;this.Sb=Q;this.Gb=wa;this.hj=Ua;this.Ga=kb;this.bQk()}vb(){this.ia.ra(ea.a.JFa,yb.a.view,Object(I.a)(this,this.YBj,"handleInsertSmartArt"),4);this.ia.ra(ea.a.VDh,yb.a.application,Object(I.a)(this,this.FFj,"handleSmartArtToolsTabViewHandler"),4);this.ia.ra(ea.a.E1b,yb.a.application,Object(I.a)(this,this.Zzj,"handleChangeSmartArtLayout"),4);this.ia.ra(ea.a.kgh,yb.a.application,Object(I.a)(this,
this.GDj,"handlePopulateSmartArtColorStyles"),96);this.ia.ra(ea.a.D1b,yb.a.application,Object(I.a)(this,this.Xzj,"handleChangeSmartArtColor"),4);this.ia.ra(ea.a.cJf,yb.a.application,Object(I.a)(this,this.Yzj,"handleChangeSmartArtColorAnchor"),4);this.ia.ra(ea.a.jL,yb.a.application,Object(I.a)(this,this.$zj,"handleChangeSmartArtStyle"),4);this.ia.ra(ea.a.Iya,yb.a.application,Object(I.a)(this,this.REj,"handleResetSmartArt"),4);this.ia.ra(ea.a.mXe,yb.a.application,Object(I.a)(this,this.VEj,"handleReverseSmartArt"),
4);this.ia.ra(ea.a.cnd,yb.a.application,Object(I.a)(this,this.XDj,"handleQueryReverseSmartArt"),97);this.ia.ra(ea.a.MVf,yb.a.application,Object(I.a)(this,this.RAj,"handleEditSmartArtText"),4);this.ia.ra(ea.a.Gmd,yb.a.application,Object(I.a)(this,this.TDj,"handleQueryEditSmartArtText"),96)}pe(){}YBj(a,b,c,f,l){b=this.ta.Ba;if(!b||this.$b.$c(b))return 16;if(1===c)return 32;this.Tkd(l,a);if(!l)return 8;if((c=b.C_(this.kb.Xd()))&&this.$b.$c(c))return 16;if(!this.hj.iD(b,1))return this.hj.KD(b),16;const y=
this.Ksj(b,c,l);l=this.Eb.xd(15,void 0,()=>{this.kb.au();this.kb.nh();this.Fa.Bd()},()=>{this.kb.selectShape(Object(qa.a)(4,y),!0)});try{l.hc(b),l.fd=a,c&&b.YR([c]),b.jB(Object(qa.a)(4,y))}finally{l&&l.dispose()}this.Rq.lA=Object(qa.a)(4,y);return 32}FFj(){return Object(qa.a)(494,this.fAa())?32:16}Zzj(a,b,c,f,l){b=this.fAa();if(!b||this.$b.$c(b))return 16;if(1===c)return 32;c=this.kb.Xd();for(var y of c){if(y.Wf){b=y;break}if(y.get_smartArtModelId()){b=this.Ga.Gr(y);this.kb.I8(y);this.kb.selectShape(b,
!1);break}}this.Tkd(l,a);y=this.Eb.xd(15,void 0,()=>{this.kb.kj();this.Fa.Bd()});try{y.hc(b),y.fd=a,Object(qa.a)(494,b).ensureModelData().get_elementCollection().documentElement.Epa=l}finally{y&&y.dispose()}return 32}GDj(a,b,c,f,l){if(!this.fAa())return 16;a=this.kb.hk();if(!a)return 16;if(1===c)return 32;if(!l)return 8;l.MenuId&&"color"===l.MenuId?l.PopulationXML=this.Rsi(a):l.MenuItems=this.Gsi(a);return 32}Xzj(a,b,c,f,l){b=this.fAa();if(!b||this.$b.$c(b))return 16;if(1===c)return 32;this.Tkd(l,
a);c=this.Eb.xd(15,void 0,()=>{this.kb.kj();this.Fa.Bd()});try{c.hc(b),c.fd=a,Object(qa.a)(494,b).ensureModelData().get_elementCollection().documentElement.wza=l}finally{c&&c.dispose()}return 32}Yzj(){return this.fAa()?32:16}$zj(a,b,c,f,l){b=this.fAa();if(!b||this.$b.$c(b))return 16;if(1===c)return 32;this.Tkd(l,a);c=this.Eb.xd(15,void 0,()=>{this.kb.kj();this.Fa.Bd()});try{c.hc(b),c.fd=a,Object(qa.a)(494,b).ensureModelData().get_elementCollection().documentElement.xza=l}finally{c&&c.dispose()}return 32}REj(a,
b,c){b=Object(qa.a)(494,this.fAa());if(!b||this.$b.$c(Object(qa.a)(4,b)))return 16;if(1===c)return 32;c=this.Eb.xd(15,void 0,()=>{this.kb.kj();this.Fa.Bd()});try{c.hc(b),c.fd=a,b.Iya=!0}finally{c&&c.dispose()}return 32}VEj(a,b,c){b=this.fAa();if(!b||!b.Vpe||this.$b.$c(b))return 16;if(1===c)return 32;c=new ON;c.fReverseEnabled=b.Vpe;c.fReverseChecked=!b.Upe;const f=this.Eb.xd(15,void 0,()=>{this.kb.kj();this.Fa.Bd()});try{f.hc(b),f.fd=a,Object(qa.a)(494,b).ensureModelData().get_elementCollection().documentElement.smartArtInfo=
c}finally{f&&f.dispose()}return 32}XDj(a,b,c,f,l){a=this.fAa();a=!!a&&a.Upe;if(!Object(Wa.a)(Vh.a,l))return 8;l.Hf(a);return 32}RAj(a,b,c){a=this.fAa();if(!a||this.$b.$c(a))return 16;if(1===c)return 32;this.ia.Ka(ea.a.hRa,2,new Ro.a(a,!0,null));return 32}TDj(a,b,c,f,l){a=this.kb.pz();if(!Object(Wa.a)(Vh.a,l))return 8;l.Hf(a);return 32}Ksj(a,b,c){if(!a)return null;const f=a.zs();let l;l=b?b.zyb(se.a.LR,se.a.nY):this.Sb.Rka(se.a.LR,se.a.nY);return a.u1d(!0,0,b,c,l.x,l.y,se.a.LR,se.a.nY,f+1)}fAa(){const a=
this.kb.Xd();for(const b of a){if(b.Wf)return b;if(b.get_smartArtModelId())return this.Ga.Gr(b)}return null}bQk(){Array.add(this.nq,new Pi(0,"accent0_1,mainScheme",ResourceStrings.L_SmartArtDark1Outline));Array.add(this.nq,new Pi(1,"accent0_2,mainScheme",ResourceStrings.L_SmartArtDark2Outline));Array.add(this.nq,new Pi(2,"accent0_3,mainScheme",ResourceStrings.L_SmartArtDark2Fill));Array.add(this.nq,new Pi(3,"colorful1,colorful",ResourceStrings.L_SmartArtColorful1));Array.add(this.nq,new Pi(4,"colorful2,colorful",
ResourceStrings.L_SmartArtColorful2));Array.add(this.nq,new Pi(5,"colorful3,colorful",ResourceStrings.L_SmartArtColorful3));Array.add(this.nq,new Pi(6,"colorful4,colorful",ResourceStrings.L_SmartArtColorful4));Array.add(this.nq,new Pi(7,"colorful5,colorful",ResourceStrings.L_SmartArtColorful5));Array.add(this.nq,new Pi(8,"accent1_1,accent1",ResourceStrings.L_SmartArtColoredOutline1));Array.add(this.nq,new Pi(9,"accent1_2,accent1",ResourceStrings.L_SmartArtColoredFill1));Array.add(this.nq,new Pi(10,
"accent1_3,accent1",ResourceStrings.L_SmartArtGradientRange1));Array.add(this.nq,new Pi(11,"accent1_4,accent1",ResourceStrings.L_SmartArtGradientLoop1));Array.add(this.nq,new Pi(12,"accent1_5,accent1",ResourceStrings.L_SmartArtTransparentGradientRange1));Array.add(this.nq,new Pi(13,"accent2_1,accent2",ResourceStrings.L_SmartArtColoredOutline2));Array.add(this.nq,new Pi(14,"accent2_2,accent2",ResourceStrings.L_SmartArtColoredFill2));Array.add(this.nq,new Pi(15,"accent2_3,accent2",ResourceStrings.L_SmartArtGradientRange2));
Array.add(this.nq,new Pi(16,"accent2_4,accent2",ResourceStrings.L_SmartArtGradientLoop2));Array.add(this.nq,new Pi(17,"accent2_5,accent2",ResourceStrings.L_SmartArtTransparentGradientRange2));Array.add(this.nq,new Pi(18,"accent3_1,accent3",ResourceStrings.L_SmartArtColoredOutline3));Array.add(this.nq,new Pi(19,"accent3_2,accent3",ResourceStrings.L_SmartArtColoredFill3));Array.add(this.nq,new Pi(20,"accent3_3,accent3",ResourceStrings.L_SmartArtGradientRange3));Array.add(this.nq,new Pi(21,"accent3_4,accent3",
ResourceStrings.L_SmartArtGradientLoop3));Array.add(this.nq,new Pi(22,"accent3_5,accent3",ResourceStrings.L_SmartArtTransparentGradientRange3));Array.add(this.nq,new Pi(23,"accent4_1,accent4",ResourceStrings.L_SmartArtColoredOutline4));Array.add(this.nq,new Pi(24,"accent4_2,accent4",ResourceStrings.L_SmartArtColoredFill4));Array.add(this.nq,new Pi(25,"accent4_3,accent4",ResourceStrings.L_SmartArtGradientRange4));Array.add(this.nq,new Pi(26,"accent4_4,accent4",ResourceStrings.L_SmartArtGradientLoop4));
Array.add(this.nq,new Pi(27,"accent4_5,accent4",ResourceStrings.L_SmartArtTransparentGradientRange4));Array.add(this.nq,new Pi(28,"accent5_1,accent5",ResourceStrings.L_SmartArtColoredOutline5));Array.add(this.nq,new Pi(29,"accent5_2,accent5",ResourceStrings.L_SmartArtColoredFill5));Array.add(this.nq,new Pi(30,"accent5_3,accent5",ResourceStrings.L_SmartArtGradientRange5));Array.add(this.nq,new Pi(31,"accent5_4,accent5",ResourceStrings.L_SmartArtGradientLoop5));Array.add(this.nq,new Pi(32,"accent5_5,accent5",
ResourceStrings.L_SmartArtTransparentGradientRange5));Array.add(this.nq,new Pi(33,"accent6_1,accent6",ResourceStrings.L_SmartArtColoredOutline6));Array.add(this.nq,new Pi(34,"accent6_2,accent6",ResourceStrings.L_SmartArtColoredFill6));Array.add(this.nq,new Pi(35,"accent6_3,accent6",ResourceStrings.L_SmartArtGradientRange6));Array.add(this.nq,new Pi(36,"accent6_4,accent6",ResourceStrings.L_SmartArtGradientLoop6));Array.add(this.nq,new Pi(37,"accent6_5,accent6",ResourceStrings.L_SmartArtTransparentGradientRange6))}Gsi(a){const b=
Object.assign(new On.a,{Id:"ControlsChangeSmartArtColor",MenuSectionList:[]}),c=Object.assign(new Rk.a,{Id:"MenuSectionChangeSmartArtColor",ControlList:[]});Array.add(b.MenuSectionList,c);const f=hj.Color.$i(a.Ed.Light1),l=hj.Color.$i(a.Ed.Dark1),y=hj.Color.$i(a.Ed.Light2),H=hj.Color.$i(a.Ed.Dark2),Q=Array(6);Q[0]=hj.Color.$i(a.Ed.Accent1);Q[1]=hj.Color.$i(a.Ed.Accent2);Q[2]=hj.Color.$i(a.Ed.Accent3);Q[3]=hj.Color.$i(a.Ed.Accent4);Q[4]=hj.Color.$i(a.Ed.Accent5);Q[5]=hj.Color.$i(a.Ed.Accent6);a=0;
Array.add(c.ControlList,({r$b:a}=this.Asi(a,f,l,y,H)).returnValue);Array.add(c.ControlList,({r$b:a}=this.sri(a,f,Q)).returnValue);Array.addRange(c.ControlList,({r$b:a}=this.cri(a,f,Q)).returnValue);return b}Asi(a,b,c,f,l){const y=Object.assign(new Cq.a,{Id:"PrimaryThemeColorsGallery",ExternalId:"ChangeSmartArtColorGalleryPrimary",ExternalGalleryId:"ChangeSmartArtColorGallery",Title:ResourceStrings.L_PrimaryThemeColors,Type:8,Width:5,ElementDimensions:"Size64by48",GalleryItems:[]});Array.add(y.GalleryItems,
this.blc(b,c,a++));Array.add(y.GalleryItems,this.blc(b,l,a++));Array.add(y.GalleryItems,this.blc(l,f,a++));return{returnValue:y,r$b:a}}sri(a,b,c){const f=Object.assign(new Cq.a,{Id:"ColorfulGallery",ExternalId:"ChangeSmartArtColorGalleryColorful",ExternalGalleryId:"ChangeSmartArtColorGallery",Title:ResourceStrings.L_Colorful,Type:8,Width:5,ElementDimensions:"Size64by48",GalleryItems:[]});Array.add(f.GalleryItems,this.Mfd(c[1],c[2],c[3],c[4],c[5],c[1],b,a++));for(let l=1;5>l;l++)Array.add(f.GalleryItems,
this.ZHe(c[l],c[l+1],b,a++));return{returnValue:f,r$b:a}}cri(a,b,c){const f=[];for(let H=0;6>H;H++){const Q=Object.assign(new Cq.a,{Id:"ColorfulGallery"+(H+1),ExternalId:"ChangeSmartArtColorGalleryAccent"+(H+1),ExternalGalleryId:"ChangeSmartArtColorGallery",Title:String.format(ResourceStrings.L_AccentFormat,H+1),Type:8,Width:5,ElementDimensions:"Size64by48",GalleryItems:[]});var l=new hj.Color;l.r=l.g=l.b=255;var y=new hj.Color;l=hj.Color.i_(c[H],l,.5);y=hj.Color.i_(c[H],y,.25);Array.add(Q.GalleryItems,
this.blc(b,c[H],a++));Array.add(Q.GalleryItems,this.blc(c[H],b,a++));Array.add(Q.GalleryItems,this.ZHe(c[H],l,b,a++));Array.add(Q.GalleryItems,this.Ctk(y,c[H],l,b,a++));Array.add(Q.GalleryItems,this.ZHe(c[H],l,b,a++));Array.add(f,Q)}return{returnValue:f,r$b:a}}blc(a,b,c){return this.Mfd(a,a,a,a,a,a,b,c)}ZHe(a,b,c,f){const l=wt.a.i_(a,b,2/6),y=wt.a.i_(a,b,.5),H=wt.a.i_(a,b,4/6),Q=wt.a.i_(a,b,5/6);return this.Mfd(a,l,y,H,Q,b,c,f)}Ctk(a,b,c,f,l){const y=hj.Color.i_(b,c,.5);return this.Mfd(a,b,y,c,y,
b,f,l)}Mfd(a,b,c,f,l,y,H,Q){Q=this.qbg(Q);const ia="ChangeSmartArtColor__"+Q.parameter.replace(",","__");return Object.assign(new NN,{Id:ia,ExternalId:ia,MenuItemId:Q.parameter,Command:"367274693",QueryCommand:"1384172858",Alt:Q.Frh,TableCellStyles:[this.PHb(a,H),this.PHb(b,H),this.PHb(c,H),this.PHb(f,H),this.PHb(l,H),this.PHb(y,H)]})}PHb(a,b){const c={};c.backgroundColor=this.FLf(a);c.border=String.format("1px solid {0}",this.FLf(b));return c}FLf(a){return String.format("rgb( {0:d},{1:d},{2:d} )",
a.r,a.g,a.b)}Rsi(a){const b=new Sys.StringBuilder;b.append('<Menu Id="ControlsChangeSmartArtColor">');const c=new hj.Color;c.r=c.g=c.b=255;const f=new hj.Color,l=hj.Color.$i(a.Ed.Light1);var y=hj.Color.$i(a.Ed.Dark1),H=hj.Color.$i(a.Ed.Light2),Q=hj.Color.$i(a.Ed.Dark2);const ia=Array(6);ia[0]=hj.Color.$i(a.Ed.Accent1);ia[1]=hj.Color.$i(a.Ed.Accent2);ia[2]=hj.Color.$i(a.Ed.Accent3);ia[3]=hj.Color.$i(a.Ed.Accent4);ia[4]=hj.Color.$i(a.Ed.Accent5);ia[5]=hj.Color.$i(a.Ed.Accent6);a=0;b.append(String.format('<MenuSection Id="PrimaryThemeColors" Title="{0}">',
ResourceStrings.L_PrimaryThemeColors));b.append('<Gallery Id="PrimaryThemeColorsGallery" ElementDimensions="Size64by48" Width="5">');this.alc(b,l,y,a++);this.alc(b,l,Q,a++);this.alc(b,Q,H,a++);b.append("</Gallery>");b.append("</MenuSection>");b.append(String.format('<MenuSection Id="Colorful" Title="{0}">',ResourceStrings.L_Colorful));b.append('<Gallery Id="ColorfulGallery" ElementDimensions="Size64by48" Width="5">');this.Ifd(b,ia[1],ia[2],ia[3],ia[4],ia[5],ia[1],l,a++);for(y=1;5>y;y++)this.VHe(b,
ia[y],ia[y+1],l,a++);b.append("</Gallery>");b.append("</MenuSection>");for(y=0;6>y;y++)H=String.format(ResourceStrings.L_AccentFormat,y+1),b.append(String.format('<MenuSection Id="Accent{0}" Title="{1}">',y+1,H)),b.append(String.format('<Gallery Id="ColorfulGallery{0}" ElementDimensions="Size64by48" Width="5">',y+1)),H=hj.Color.i_(ia[y],c,.5),Q=hj.Color.i_(ia[y],f,.25),this.alc(b,l,ia[y],a++),this.alc(b,ia[y],l,a++),this.VHe(b,ia[y],H,l,a++),this.xtk(b,Q,ia[y],H,l,a++),this.VHe(b,ia[y],H,l,a++),b.append("</Gallery>"),
b.append("</MenuSection>");b.append("</Menu>");return b.toString()}alc(a,b,c,f){this.Ifd(a,b,b,b,b,b,b,c,f)}VHe(a,b,c,f,l){const y=wt.a.i_(b,c,2/6),H=wt.a.i_(b,c,.5),Q=wt.a.i_(b,c,4/6),ia=wt.a.i_(b,c,5/6);this.Ifd(a,b,y,H,Q,ia,c,f,l)}xtk(a,b,c,f,l,y){const H=hj.Color.i_(c,f,.5);this.Ifd(a,b,c,H,f,H,c,l,y)}Ifd(a,b,c,f,l,y,H,Q,ia){ia=this.qbg(ia);a.append('<GalleryButton Id="');a.append(ia.parameter);a.append('" Command="');a.append(ea.a.D1b.toString());a.append('" QueryCommand="');a.append(ea.a.yc.toString());
a.append('" InnerHTML="');a.append("&lt;div style=&quot;width:64px;height:48px;position:relative;font-size:1px;&quot;&gt;");this.QHb(a,b,Q,8,-1);this.QHb(a,c,Q,34,-1);this.QHb(a,f,Q,8,16);this.QHb(a,l,Q,34,16);this.QHb(a,y,Q,8,33);this.QHb(a,H,Q,34,33);a.append("&lt;/div&gt;");a.append('" Alt="');a.append(ia.Frh);a.append('"/>')}Tkd(a,b){a.Uri=b===ea.a.D1b?"urn:microsoft.com/office/officeart/2005/8/colors/"+a.Uri:b===ea.a.jL?"3d8"===a.Uri?"urn:microsoft.com/office/officeart/2009/2/quickstyle/3d8":
"urn:microsoft.com/office/officeart/2005/8/quickstyle/"+a.Uri:"timeline"===a.Category?"BasicTimeline"===a.Uri||"HexagonTimeline"===a.Uri||"RoundedRectangleTimeline"===a.Uri||"AccentHomeChevronProcess"===a.Uri?"urn:microsoft.com/office/officeart/2016/7/layout/"+a.Uri:"urn:microsoft.com/office/officeart/2017/3/layout/"+a.Uri:"urn:microsoft.com/office/officeart/2005/8/layout/"+a.Uri}qbg(a){let b;for(let c=0;c<this.nq.length;c++)if(b=this.nq[c],b.id===a)return b;return new Pi(-1,"","")}QHb(a,b,c,f,l){a.append("&lt;div style=&quot;");
b.B6d()||(b=String.format("rgb( {0:d},{1:d},{2:d} )",b.r,b.g,b.b),a.append("background-color:"),a.append(b),a.append(";"));a.append("left:");a.append(f.toString());a.append("px;top:");a.append(l.toString());a.append("px;width:22px;height:14px;position:absolute;");c.B6d()||(c=String.format("rgb( {0:d},{1:d},{2:d} )",c.r,c.g,c.b),a.append("border:solid 1px "),a.append(c),a.append(";"));a.append("&quot;&gt;&lt;/div&gt;")}}Object(m.a)(PN,"SmartArtActor",null,[251]);class gy{constructor(a,b,c,f){this.iGe=
"BottomOverlaid";this.ia=a;this.Hc=f;this.oc=b;this.Ic=c;this.jGe="productionSpokenLanguages_"+this.Hc.Fpa;this.kGe="productionSubtitleLanguages_"+this.Hc.bAa}vb(){xa.a.J(512500167,822,50,"SubtitleActor::RegisterActions - OptIn: True, FUseSubtitles:{0}",this.Hc.Qh);this.ia.ra(ea.a.j0a,hc.a.application,Object(I.a)(this,this.j0a,"querySubtitleIsEnabled"),96);this.ia.ya(ea.a.SMa,hc.a.application,Object(I.a)(this,this.SMa,"toggleUseSubtitles"));this.ia.ra(ea.a.Cnd,hc.a.application,Object(I.a)(this,this.IWk,
"querySubtitleSettingsIsEnabled"),96);this.ia.ra(ea.a.Xib,hc.a.application,Object(I.a)(this,this.Xib,"populateTranscriptionSubtitleLanguage"),96);this.ia.ra(ea.a.Wib,hc.a.application,Object(I.a)(this,this.Wib,"populateTranscriptionSpokenLanguage"),96);this.ia.ya(ea.a.OGl,hc.a.application,Object(I.a)(this,this.iGj,"handleToggleTranscriptionSpokenLanguage"));this.ia.ya(ea.a.PGl,hc.a.application,Object(I.a)(this,this.jGj,"handleToggleTranscriptionSubtitleLanguage"));this.ia.ra(ea.a.cTe,hc.a.application,
Object(I.a)(this,this.cTe,"queryToggleTranscriptionSpokenLanguage"),96);this.ia.ra(ea.a.dTe,hc.a.application,Object(I.a)(this,this.dTe,"queryToggleTranscriptionSubtitleLanguage"),96);this.ia.ra(ea.a.Gjb,hc.a.application,Object(I.a)(this,this.Gjb,"querySubtitlesBottomOverlay"),96);this.ia.ya(ea.a.iQb,hc.a.application,Object(I.a)(this,this.iQb,"toggleSubtitlesBottomOverlay"));this.ia.ra(ea.a.Hjb,hc.a.application,Object(I.a)(this,this.Hjb,"querySubtitlesTopOverlay"),96);this.ia.ya(ea.a.jQb,hc.a.application,
Object(I.a)(this,this.jQb,"toggleSubtitlesTopOverlay"));this.ia.ra(ea.a.Fjb,hc.a.application,Object(I.a)(this,this.Fjb,"querySubtitlesBelowSlide"),96);this.ia.ya(ea.a.hQb,hc.a.application,Object(I.a)(this,this.hQb,"toggleSubtitlesBelowSlide"));this.ia.ra(ea.a.Ejb,hc.a.application,Object(I.a)(this,this.Ejb,"querySubtitlesAboveSlide"),96);this.ia.ya(ea.a.gQb,hc.a.application,Object(I.a)(this,this.gQb,"toggleSubtitlesAboveSlide"))}pe(){}j0a(a,b,c,f,l){if(!l||!Object(Wa.a)(Vh.a,l))return 8;l.Hf(this.Hc.Qh);
return 32}IWk(a,b,c,f,l){return 1===c?this.oc.Cj()?32:8:l&&"object"===typeof l?this.Hc&&this.Hc.M5b?32:(xa.a.J(512500164,822,10,"QuerySubtitleSettingsIsEnabled requires valid subtitleContext"),8):(xa.a.J(512500165,822,10,"QuerySubtitleSettingsIsEnabled requires actionData"),8)}Gjb(a,b,c,f,l){if(!l||!Object(Wa.a)(Vh.a,l))return xa.a.J(512500163,822,10,"SubtitleActor::QuerySubtitlesBottomOverlay requires actionData"),8;l.Hf("BottomOverlay"===this.Hc.fw);xa.a.J(512500162,822,50,"SubtitleActor::QuerySubtitlesBottomOverlay: subtitles position is {0}",
this.Hc.fw);return 32}Hjb(a,b,c,f,l){if(!l||!Object(Wa.a)(Vh.a,l))return 8;l.Hf("TopOverlay"===this.Hc.fw);xa.a.J(512500160,822,50,"SubtitleActor::QuerySubtitlesTopOverlay: subtitles position is {0}",this.Hc.fw);return 32}Fjb(a,b,c,f,l){try{l&&l.Hf("BelowSlide"===this.Hc.fw)}catch(y){xa.a.J(512500131,822,10,"Exception in QuerySubtitlesBelowSlide: {0}.",y)}return 32}Ejb(a,b,c,f,l){try{l&&l.Hf("AboveSlide"===this.Hc.fw)}catch(y){xa.a.J(512500130,822,10,"Exception in QuerySubtitlesBelowSlide: {0}.",
y)}return 32}SMa(a,b,c,f,l){if(1===c)return this.oc.Cj()?32:8;if(!l||"object"!==typeof l)return 8;this.Hc.Qh&&(pi.a.oK("PPTCaptionDiscoverabiltyDoNotShowAgain","true",pi.a.XJ)||xa.a.J(512500128,822,10,"SubtitleActor::ToggleUseSubtitles - Failed to set cookie for discoverability opt out to true"));this.Hc.Qh=!this.Hc.Qh;xa.a.J(512500127,822,50,"SubtitleActor::HandleToggleUseSubtitles: Changed UseSubtitles status to:{0}",this.Hc.Qh);Rc.App.Lb.BG({AlwaysUseSubtitles:"SplitButtonModel",UseSubtitles:"CheckboxModel"});
return 32}Xib(a,b,c,f,l){try{if(1===c)return 32;if(!l)return xa.a.J(512500126,822,10,"PopulateTranscriptionSubtitleLanguage requires actionData"),8;this.igh(l,!1)}catch(y){xa.a.J(512500125,822,10,"Exception in PopulateTranscriptionSubtitleLanguage: {0}.",y)}return 32}Wib(a,b,c,f,l){try{if(1===c)return 32;if(!l)return xa.a.J(512500124,822,10,"PopulateTranscriptionSpokenLanguage requires actionData"),8;this.igh(l,!0)}catch(y){xa.a.J(512500123,822,10,"Exception in PopulateTranscriptionSpokenLanguage: {0}.",
y)}return 32}jGj(a,b,c,f,l){try{if(l){this.Hc.bAa=l.MenuItemId;this.Hc.anb=this.Hc.LXc();const y=l.SourceControlId;this.kGe!==y&&(a={},a[y]="ToggleButtonModel",a[this.kGe]="ToggleButtonModel",Rc.App.Lb.BG(a),this.kGe=y)}}catch(y){xa.a.J(512500122,822,10,"Exception in HandleToggleTranscriptionSubtitleLanguage: {0}.",y)}return 32}dTe(a,b,c,f,l){try{l&&(l[wh.a.On]=l.MenuItemId.toLowerCase()===this.Hc.bAa.toLowerCase())}catch(y){xa.a.J(512500121,822,10,"Exception in QueryToggleTranscriptionSubtitleLanguage: {0}.",
y)}return 32}iGj(a,b,c,f,l){try{if(l){this.Hc.Fpa=l.MenuItemId;const y=l.SourceControlId;this.jGe!==y&&(a={},a[y]="ToggleButtonModel",a[this.jGe]="ToggleButtonModel",Rc.App.Lb.BG(a),this.jGe=y)}}catch(y){xa.a.J(512500120,822,10,"Exception in HandleToggleTranscriptionSpokenLanguage: {0}.",y)}return 32}cTe(a,b,c,f,l){try{l&&(l[wh.a.On]=l.MenuItemId.toLowerCase()===this.Hc.Fpa.toLowerCase())}catch(y){xa.a.J(512500119,822,10,"Exception in QueryToggleTranscriptionSpokenLanguage: {0}.",y)}return 32}iQb(a,
b,c,f,l){if(1===c)return 32;if(!l||"object"!==typeof l)return xa.a.J(512500118,822,10,"SubtitleActor::ToggleSubtitlesBottomOverlay requires actionData"),8;l[wh.a.On]&&(this.Hc.fw="BottomOverlay",xa.a.J(512500117,822,50,"SubtitleActor::ToggleSubtitlesBottomOverlay: Bottom overlay is enabled"));this.Cyd(l.SourceControlId);return 32}jQb(a,b,c,f,l){if(1===c)return 32;if(!l||"object"!==typeof l)return xa.a.J(512500116,822,10,"SubtitleActor::ToggleSubtitlesTopOverlay requires actionData"),8;l[wh.a.On]&&
(this.Hc.fw="TopOverlay",xa.a.J(512500115,822,50,"SubtitleActor::ToggleSubtitlesTopOverlay: Top overlay is enabled"));this.Cyd(l.SourceControlId);return 32}hQb(a,b,c,f,l){if(1===c)return 32;if(!l||"object"!==typeof l)return xa.a.J(512500114,822,10,"SubtitleActor::ToggleSubtitlesBelowSlide requires actionData"),8;l[wh.a.On]&&(this.Hc.fw="BelowSlide",xa.a.J(512500113,822,50,"SubtitleActor::ToggleSubtitlesBelowSlide: Below Slide is enabled"));this.Cyd(l.SourceControlId);return 32}gQb(a,b,c,f,l){if(1===
c)return 32;if(!l||"object"!==typeof l)return xa.a.J(512500112,822,10,"SubtitleActor::ToggleSubtitlesAboveSlide requires actionData"),8;l[wh.a.On]&&(this.Hc.fw="AboveSlide",xa.a.J(512500111,822,50,"SubtitleActor::ToggleSubtitlesAboveSlide: Above Slide is enabled"));this.Cyd(l.SourceControlId);return 32}igh(a,b){a.MenuItems=Object.assign(new On.a,{Id:b?"SpokenLanguageList":"SubtitleLanguageList",MenuSectionList:[],UpdateDynamically:!0});b?((b=this.Hc.x4e)&&0<b.count&&(b=gy.kQf(b,"productionSpokenLanguages",
""),Array.add(a.MenuItems.MenuSectionList,b)),(b=this.Hc.w4e)&&0<b.count&&(b=gy.kQf(b,"previewSpokenLanguages",ResourceStrings.L_SubtitlesPreviewSpokenLanguageSectionTitle),Array.add(a.MenuItems.MenuSectionList,b))):(b=this.Hc.vPb)&&0<ta.a.count(b)&&(b=gy.bPi(this.Hc.h3e),Array.add(a.MenuItems.MenuSectionList,b));a.PopulationXML=sj.l(a.MenuItems)}Cyd(a){if(this.iGe!==a){const b={};b[a]="ToggleButtonModel";b[this.iGe]="ToggleButtonModel";Rc.App.Lb.BG(b);this.iGe=a;this.Ic.Py(new dq.a(1))}}static kQf(a,
b,c){c=Object.assign(new Rk.a,{DisplayMode:"Menu",Title:c,Id:b,ControlsId:"ctr"+b,ControlList:[]});for(let f of a)try{const l=f.toLowerCase(),y=Object.assign(new Vy.a,{Id:b+"_"+l,ExternalId:b+"_"+l,LabelText:bb.a.He(f).displayName,Command:"892576938",MenuItemId:l,QueryCommand:"1887433262",Visible:!0,AriaLabel:Ve.a.stb});Array.add(c.ControlList,y)}catch(l){xa.a.J(512500110,822,10,"SubtitleActor::CreateSpokenLanaguageMenuSection Exception when trying to show language: {0}, e: {1}.",f,l)}return c}static bPi(a){const b=
Object.assign(new Rk.a,{DisplayMode:"Menu",Title:"",Id:"productionSubtitleLanguages",ControlsId:"ctrproductionSubtitleLanguages",ControlList:[]});for(let c of a)try{const f=Object.assign(new Vy.a,{Id:"productionSubtitleLanguages_"+c,ExternalId:"productionSubtitleLanguages_"+c,LabelText:bb.a.He(c).displayName,Command:"2717950896",MenuItemId:c,QueryCommand:"4282741576",Visible:!0,AriaLabel:Ve.a.stb});Array.add(b.ControlList,f)}catch(f){xa.a.J(512500109,822,10,"SubtitleActor::CreateSubtitleLanaguageMenuSection Exception when trying to show language: {0}, e: {1}.",
c,f)}return b}}Object(m.a)(gy,"SubtitleActor",null,[251]);var dS=d(411);class qo{constructor(a){this.ay=this.gt=this.kv=this.EK=this.zI=null;this.SZ=a}get z0b(){return this.EK||(this.EK=Ib.a.instance.qb("Box4.IAutoCorrectRules"))}get Tca(){return this.kv||(this.kv=Ib.a.instance.qb("Box4.IAutoCorrectScheduler"))}get cK(){return this.zI||(this.zI=Ib.a.instance.qb("Box4.Pages.IPageContentEditor"))}get aC(){return this.ay||(this.ay=Ib.a.instance.qb("Box4.IOutlineEditor"))}get Vn(){return this.gt||(this.gt=
this.SZ())}uCb(a,b,c){if(this.aC&&qo.oh){var f=Ch.ContextSetEditor.Dae(b);a=f.node;Mb.SelectionEditor.im(f)&&(f=cb.a.Lj(a,Db.ParagraphReader.textLength(a)));var l=tb.a.language(tb.a.Bs(f));f=ob.GraphIterator.pb(c.Ag);qo.lm.sLa(f);var y=a=null;if(f)for(let H=f.Cb(1);H&&!y;H=f.Nj(1))gj.OutlineReader.kX(H)&&(y=H);if(f&&!y){if(!this.cK||!this.aC)return;a=new pf.GraphTransaction(7);a.Sy(f);y=this.cK.p3b(f);this.aC.wsd(y,c.X8b());this.aC.nW(f,!0);l&&(Za.OutlineElementNavigator.yi(f),f=cb.a.Lj(f.currentNode,
0),qo.oh.u1a(tb.a.Bs(f),l))}l=Od.SelectionFactory.Aj(y,!0);c.Nb.setSelection(l);Mb.SelectionEditor.Xg(b)&&(c=ob.GraphIterator.pb(b.node),c.hv(),xg.OutlineNavigator.cqd(c),this.z0b&&this.Tca&&gj.OutlineReader.fD(c,b,!0)&&(b=this.z0b.w7d(b,-1,!1,B.a.$q))&&this.Tca.nuh(b));this.Vn&&this.Vn.Aw();a&&a.dispose()}}K5d(a,b,c){a=ob.GraphIterator.pb(c.Ag);a=dS.a(a);a=Od.SelectionFactory.Aj(a,!1);c.Nb.setSelection(a)}static get oh(){return qo.If||(qo.If=Ib.a.instance.qb("Box4.IFormattingEditor"))}static get instance(){return qo.La||
(qo.La=qo.XC())}static XC(){return new qo(()=>Ib.a.instance.qb("Box4.IUndoManager"))}static get lm(){return Gy.PageNavigator.instance}}qo.La=null;qo.If=null;Object(m.a)(qo,"TitleViewEditor",null,[]);class Cu{constructor(a,b,c,f=null,l=null,y,H,Q=null,ia=null){this.gt=null;this.pvf=!1;this.SZ=a;this.BPd=b;this.Sm=c;this.EK=f;this.kv=l;this.kd=Q;this.Lk=ia}get Vn(){return this.gt||(this.gt=this.SZ())}vb(){const a=w.AFrameworkApplication.Ra,b=Object(I.a)(this,this.mDl,"tabView");a.ra(C.a.tab,yb.a.view,
b,1124);a.ra(C.a.Dtc,yb.a.view,b,1124);a.ya(C.a.jkg,yb.a.view,vf.ActionManager.Sg)}mDl(a,b,c,f,l){if(1===c)return 32;const y=a===C.a.Dtc;if(!b.view.Sh)return 2;const H=b.view,Q=H.Nb;var ia=Q.Yj;if(!ia||N.a.instance.ga(14)&&Cu.fj.R8a(ia))return 2;if(this.Sm&&this.Sm.instance&&this.Sm.instance.fX(ia))return 4;var wa=null,Ua=vf.ActionManager.Z5,kb=!1,Gb=Mb.SelectionEditor.Xg(ia);if(ia.Bx){if(Q.Pa.uH&&(Ua=ia.getContext(0),wa=new ob.GraphIterator,wa.set(Ua.node),wa.hv(),Ua=y?C.a.OYe:C.a.mrd),Ua=this.BPd.ATk(Ua,
y?C.a.My:C.a.TC),Ua===vf.ActionManager.Z5){var ec=Cu.ym.l3(ia,16);if(ec)y&&(Ua=C.a.Wgd),wa=new ob.GraphIterator,wa.set(ec.node),wa.kf();else{if(N.a.instance.ga(77))return 2;if(Cu.TUj(ia)){if(y)return 2;Ua=C.a.uCb}else Ua=y?C.a.My:C.a.TC}}}else if(ia.Pk)wa=new ob.GraphIterator,wa.set(ia.node),Mb.SelectionEditor.Mt(wa),gj.OutlineReader.Kla(ia)?Ua=y?C.a.OYe:C.a.mrd:(Ua=y?this.BPd.yyj(wa,ia,Ua):this.BPd.xyj(wa,ia,Ua),Wd.OutlineElementReader.ih(wa)&&ia.contextId===yb.a.Mf&&(kb=Wd.OutlineElementReader.fD(wa,
ia,!1)),(ec=Zb.ListReader.Hk(wa)&&kb)&&ka.ULS.sendTraceTag(509659340,383,50,"Tab pressed at starting of list item IsLevelIncreased:{0}",Ua===C.a.TC),Ua!==vf.ActionManager.Z5||ae.isTableCellOrInside(wa)||ec||(this.pvf||(ka.ULS.sendTraceTag(39662619,383,50,"User tried to insert inline tabs"),this.pvf=!0),w.AFrameworkApplication.Ra.processAction(C.a.jkg,2),w.AFrameworkApplication.dM("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorInlineTabInsertionSettings"),this.kd&&this.kd.isFeatureEnabled(84)&&
this.kd.isFeatureEnabled(83)));else return 2;if(!y&&Ua===vf.ActionManager.Z5&&ae.isTableCellOrInside(wa))if(Sd.returnToCell(wa),ae.isLastCellInTable(wa)||cd.TableReader.VAb(wa)&&ae.isLastCellInTableIgnoringGhostCells(wa)){if(Ua=this.IRd(wa,ia),!Ua)return 2}else Ua=C.a.l5g;if(Ua===vf.ActionManager.Z5)return 2;switch(Ua){case C.a.uCb:qo.instance.uCb(a,ia,b.view);ia=32;break;case C.a.K5d:qo.instance.K5d(a,ia,b.view);ia=32;break;case C.a.l5g:case C.a.Wgd:kb=Ua===C.a.Wgd;Gb&&this.EK&&this.kv&&(Gb=this.EK.w7d(ia,
-1,!0,B.a.$q))&&this.kv.nuh(Gb);ia=32;Sd.returnToCell(wa);Sd.moveToNextOrPreviousCell(wa,kb)&&(Gb=!0,kb=!1,gj.OutlineReader.IYc(wa)||(xg.OutlineNavigator.pJe(wa,!1),Za.OutlineElementNavigator.yi(wa),Db.ParagraphReader.vs(wa.currentNode)&&(Gb=!1,Db.ParagraphReader.textLength(wa.currentNode)||(kb=!0)),kb||Sd.returnToCell(wa)),kb?wa=Od.SelectionFactory.Qg(wa.currentNode,0):(wa=Od.SelectionFactory.nl(wa.currentNode),!Gb&&Mb.SelectionEditor.im(wa.jf)&&(Gb=wa.toArray(),Array.removeAt(Gb,Gb.length-1),wa=
new Lb.Selection(Gb,wa.Af))),Q.setSelection(wa));break;case C.a.OYe:case C.a.mrd:Ua===C.a.mrd?xg.OutlineNavigator.Q4g(wa,!1):xg.OutlineNavigator.Q4g(wa,!0);Q.setSelection(Od.SelectionFactory.nl(wa.currentNode));ia=32;break;case C.a.Y1a:ia=w.AFrameworkApplication.Ra.ei(b,Ua,c,!0,f,l);1===Rc.App.mode&&Sd.moveToNextOrPreviousCell(wa,!1)&&(Sd.returnToCell(wa),wa=Od.SelectionFactory.Aj(wa.currentNode,!0),Mb.SelectionEditor.im(wa.jf)&&(Gb=wa.toArray(),Array.removeAt(Gb,Gb.length-1),wa=new Lb.Selection(Gb,
wa.Af)),Q.setSelection(wa));break;default:if(ia=w.AFrameworkApplication.Ra.ei(b,Ua,c,!0,f,l),!kb&&Gb&&(Ua===C.a.My||Ua===C.a.TC)){const dc=Mb.SelectionEditor.yja(Q.Pa.mb).y;Rc.App.s2k(()=>{this.Uwk(Q,H,dc)})}}32===ia&&b.view.Sh&&this.Vn.Aw();return ia}Uwk(a,b,c){if(a&&b){var f=a.Pa.mb;Mb.SelectionEditor.yja(f).y<c?(b=Mb.SelectionEditor.b6b(b,f,!1),b=Mb.SelectionEditor.Bta(b,!1,!1,!1,!0)):b=Mb.SelectionEditor.LSc(b,f,!1);a.setSelection(b)}}IRd(){return C.a.Hua}E4g(a,b,c){if(a&&b){var f=a.Pa.mb;Mb.SelectionEditor.yja(f).y<
c?(b=Mb.SelectionEditor.b6b(b,f,!1),b=Mb.SelectionEditor.Bta(b,!1,!1,!1,!0)):b=Mb.SelectionEditor.Bta(f,!1,!1,!1,!0);a.setSelection(b)}}static get fj(){return bh.a.instance}static get ym(){return Ch.ContextSetEditor.instance}static TUj(a){a=Cu.ym.l3(a,10);return!!a&&ze.a(a)}}Object(m.a)(Cu,"TabActor",null,[]);class QN extends Cu{constructor(a,b,c,f){super(a,b,c);this.la=f}IRd(a,b){return this.la.XBb?super.IRd(a,b):0}}Object(m.a)(QN,"Box4TabActor",Cu,[]);class RN{constructor(a,b,c,f){this.ark=new QN(a,
b,c,f)}vb(){this.ark.vb()}pe(){}}Object(m.a)(RN,"TabActor",null,[251]);class SN{constructor(a,b,c){this.iGg=b;this.pa=a;this.gHa=c}ATk(a,b){const c=this.pa.Yj;return c&&this.gHa.l3(c,16)?a:this.$0e(b)?b:G.a.ve}yyj(a,b,c){(c=Object(qa.a)(5,b.node))&&c.Gs()?c=C.a.Wgd:(Za.OutlineElementNavigator.Te(a),c=(Mb.SelectionEditor.tk(b)||Mb.SelectionEditor.Xg(b)&&Wd.OutlineElementReader.fD(a,b,!1))&&this.iGg.rub(a)&&this.$0e(C.a.My)?C.a.My:G.a.ve,xa.a.J(8955994,820,50,"TabActorPromoteDemoteStrategy::GraphNodePlanPromote actionToTake={0}",
c===C.a.My?"Promote":"DoNothing"));return c}xyj(a,b,c){const f=Object(qa.a)(5,a.Cq);if(f&&f.Gs())return c;Za.OutlineElementNavigator.Te(a);c=(Mb.SelectionEditor.tk(b)||Mb.SelectionEditor.Xg(b)&&Wd.OutlineElementReader.fD(a,b,!1))&&this.iGg.MLc(a)&&this.$0e(C.a.TC)?C.a.TC:G.a.ve;xa.a.J(8955996,820,50,"TabActorPromoteDemoteStrategy::GraphNodePlanDemote actionToTake={0}",c===C.a.My?"Demote":"DoNothing");return c}$0e(a){var b=this.pa.Pa.mb;let c=!1;if(b)for(let f of b)if(f&&f.node)if(Db.ParagraphReader.gX(f.node)){if(b=
f.node.sa(Ab.a.listLevel,0),a===C.a.TC&&b>=Zo.a.u8-1||a===C.a.My&&!b||this.pa.$L()&&Zo.a.nog(f.node)){c=!0;break}}else{c=!0;break}return!c}}Object(m.a)(SN,"TabActorPromoteDemoteStrategy",null,[1165]);var TN=d(403),eS=d(874),UN=d(985);class Zv extends bi.a{constructor(a,b,c,f,l,y,H,Q,ia){super(void 0,void 0,!0);this.Sva=null;this.kgk=b;this.GMg=f;this.EMg=l;this.zMg=y;this.tMg=H;this.vAg=Q;this.uAg=ia;this.pxa=a;this.Jdb=c}Ztd(){this.kg=this.kgk;const a={};a.bodyControls=this.B9d();this.pj(this.pxa,
Object(I.a)(this,this.u3d,"dialogResultHandler"),a)}u3d(a,b){1===a&&this.Jdb(parseInt(this.pUa(b)),parseInt(this.Xcj(b)));this.dispose()}B9d(){this.Sva=Zv.t$d();const a={};this.VFi(a);this.ZEi(a);return a}VFi(a){const b=String.format(ResourceStrings.l_InsertTableMouseHoverMessage,this.GMg,this.zMg),c=[UN.a("None",0,this.GMg,this.zMg,1)];a.rowsSpinButtonProps={["type"]:"AppSpinButtonProps",["id"]:"TableSizeDialogRowSpinner",["label"]:ResourceStrings.l_InsertTableDialogRowLabelText,["customTooltip"]:b,
["unitType"]:"None",["value"]:this.vAg,["validUnits"]:c,["numberFormatInfo"]:this.Sva,["validReservedValues"]:[""]}}ZEi(a){const b=String.format(ResourceStrings.l_InsertTableMouseHoverMessage,this.EMg,this.tMg),c=[UN.a("None",0,this.EMg,this.tMg,1)];a.columnsSpinButtonProps={["type"]:"AppSpinButtonProps",["id"]:"TableSizeDialogColumnSpinner",["label"]:ResourceStrings.l_InsertTableDialogColumnLabelText,["customTooltip"]:b,["unitType"]:"None",["value"]:this.uAg,["validUnits"]:c,["numberFormatInfo"]:this.Sva,
["validReservedValues"]:[""]}}pUa(a){return a.rows&&""!==a.rows.toString()?a.rows.toString():this.vAg.toString()}Xcj(a){return a.columns&&""!==a.columns.toString()?a.columns.toString():this.uAg.toString()}static t$d(){return{["negativeSign"]:"-",["numberDecimalDigits"]:0,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}}}Object(m.a)(Zv,"AReactTableSizeDialog",bi.a,[]);class VN extends Zv{constructor(a){super(ResourceStrings.L_InsertTableDialogTitleText,
"InsertTableDialog",a,1,1,35,35,2,5)}}Object(m.a)(VN,"ReactInsertTableDialog",Zv,[]);class WN extends Zv{constructor(a,b,c){super(ResourceStrings.L_SplitTableCells,"SplitTableCellsDialog",a,1,1,b,c,1,Math.min(2,c))}}Object(m.a)(WN,"ReactSplitTableCellsDialog",Zv,[]);var $v=d(628),XN=d(970);class wF{constructor(a){this.PGa=a;if(!a)throw Error.argumentNull("m_actionData");}Fs(){return!1}un(){return this.PGa.TableNode}Ev(){var a;return null!==(a=this.PGa.CellNodes)&&void 0!==a?a:this.un().Bab()}YY(a){return a&&
!!a.Ba}}Object(m.a)(wF,"TableActionDataContextHelper",null,[1176]);class xF{constructor(a){this.pa=a;if(!a)throw Error.argumentNull("m_selectionManager");}Fs(){return this.pa.Fs()}un(){return this.pa.un()}Ev(){return this.pa.Ev()}YY(a){let b=!1;a&&a.Ba&&(a=this.pa.fo(),b=!!a&&a.vd);return b}}Object(m.a)(xF,"TableSelectionManagerContextHelper",null,[1176]);class Du{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye,Xd,Xf,ug,qg,Fg){this.WWa={};this.Mhc=!1;this.Vbd=null;this.$z=[0,
.25,.5,.75,1,1.5,2.25,3,4.5,6];this.YF=new Eb.ScriptSharpLegacyMap;this.ppj=(qf,bg,Kg)=>{const rg=new is;rg.response=8;const ui=[];qf=qf.$yb();if(!qf)return rg;bg=bg||Kg?qf.firstRow:qf.pag(qf.dV-1);if(!bg)return rg;ui.push(cb.a.create(bg));rg.RA=ui;rg.U1a=bg;rg.rn=qf;rg.KJa=ui.length;if(this.Ea.lu||!cd.TableReader.wt(rg.rn))rg.response=32;return rg};this.ipj=(qf,bg,Kg)=>{const rg=new is;rg.response=8;const ui=[];qf=qf.$yb();if(!qf)return rg;bg=bg||!Kg?qf.ef(0,0):qf.ef(0,qf.v3-1);if(!bg)return rg;
Array.add(ui,cb.a.create(bg));rg.RA=ui;rg.U1a=bg;rg.rn=qf;rg.KJa=1;if(this.Ea.lu||!cd.TableReader.wt(rg.rn))rg.response=32;return rg};this.Tb=ec;this.ta=dc;this.Rb=b;this.ia=a;this.qf=c;this.pa=Fc;this.Fa=f;this.AA=l;this.Ga=y;this.Rs=Ua;this.xk=wa;this.Ea=kb;this.Eb=Gb;this.SJ=ia;this.uZa=Q;this.zc=H;this.hj=yc;this.oHb=tc;this.K_g=xd;this.Uea=Vd;this.Gb=Ld;this.NGa=ye;this.Rq=Xd;this.fY=Xf;this.mIg=ug;this.LH=1;this.Rx=Ge.Box4ColorHelper.pS({Color:"##T,1,0,0"});this.uu=qg;this.JA=Fg}vb(){this.WWa["465284484"]=
0;this.WWa["212166888"]=1;this.WWa["530759702"]=2;this.WWa["1915511548"]=0;this.WWa["2003354004"]=1;this.WWa["2257534378"]=2;Gc.xce=Object(I.a)(this,this.wce,"getRowOrColumnsForDelete");Gc.lce=Object(I.a)(this,this.qpj,"getRefRowWhenInsertRow");Gc.ice=Object(I.a)(this,this.jpj,"getRefCellWhenInsertColumn");Gc.jce=Object(I.a)(this,this.lpj,"getRefColumnFromRefCell");Gc.kce=Object(I.a)(this,this.npj,"getRefColumnsWhenSelectColumn");Gc.mce=Object(I.a)(this,this.spj,"getRefRowsWhenSelectRow");Gc.Cee=
Object(I.a)(this,this.pyj,"gotoFocusCellAfterInsertColumn");Gc.yyb=Object(I.a)(this,this.t9f,"getNewOutlineElementInfoFromCell");Gc.CBb=a=>this.Ea.lu||!cd.TableReader.VAb(a);this.ia.ra(ea.a.cKb,hc.a.application,Object(I.a)(this,this.EAj,"handleDeleteTable"),4);this.ia.ra(ea.a.Hoc,yb.a.view,Object(I.a)(this,this.GAj,"handleDeleteTableRow"),4);this.ia.ra(ea.a.Vld,yb.a.view,Object(I.a)(this,this.FAj,"handleDeleteTableColumn"),4);this.ia.ra(ea.a.QPe,hc.a.application,Object(I.a)(this,this.hFj,"handleSelectTable"),
4);this.ia.ra(ea.a.Wld,hc.a.application,Object(I.a)(this,this.ZBj,"handleInsertTable"),4);this.ia.ra(ea.a.KPe,hc.a.application,Object(I.a)(this,this.$Bj,"handleInsertTableDialog"),4);this.ia.ra(ea.a.Fgh,hc.a.application,Object(I.a)(this,this.aCj,"handleInsertTableFromRibbon"),4);this.ia.ra(ea.a.bRk,hc.a.application,Sr.a.oH,4);this.ia.ra(ea.a.cRk,hc.a.application,Sr.a.oH,4);this.ia.ra(ea.a.lWk,hc.a.application,Sr.a.z1,96);this.ia.ra(ea.a.mWk,hc.a.application,Sr.a.z1,96);this.ia.ra(ea.a.Cjh,yb.a.view,
Object(I.a)(this,this.ZSe,"queryTableCellAnchoring"),96);this.ia.ra(ea.a.Bjh,yb.a.view,Object(I.a)(this,this.ZSe,"queryTableCellAnchoring"),96);this.ia.ra(ea.a.Ajh,yb.a.view,Object(I.a)(this,this.ZSe,"queryTableCellAnchoring"),96);this.ia.ya(ea.a.Soc,yb.a.view,Gc.Fka);this.ia.ya(ea.a.Roc,yb.a.view,Gc.Fka);this.ia.ya(ea.a.Qoc,yb.a.view,Gc.Fka);this.ia.ya(ea.a.Soc,yb.a.tableCell,Object(I.a)(this,this.vfe,"handleTableCellAnchoring"));this.ia.ya(ea.a.Roc,yb.a.tableCell,Object(I.a)(this,this.vfe,"handleTableCellAnchoring"));
this.ia.ya(ea.a.Qoc,yb.a.tableCell,Object(I.a)(this,this.vfe,"handleTableCellAnchoring"));this.ia.he(ea.a.Soc,4);this.ia.he(ea.a.Roc,4);this.ia.he(ea.a.Qoc,4);this.ia.ya(ea.a.Bgh,yb.a.view,Object(I.a)(this,this.Qzj,"handleCellShadingMenuOpen"));this.ia.ra(ea.a.Kgh,yb.a.view,Object(I.a)(this,this.xDj,"handlePopulateCellShadingColor"),96);this.ia.ya(ea.a.l6,yb.a.view,Gc.Fka);this.ia.ya(ea.a.l6,yb.a.tableCell,Object(I.a)(this,this.Ozj,"handleCellShadingColor"));this.ia.ya(ea.a.Hgh,yb.a.view,Object(I.a)(this,
this.xCj,"handleMoreCellShadingColor"));this.ia.ya(ea.a.Uld,yb.a.view,Gc.Fka);this.ia.ya(ea.a.Uld,yb.a.tableCell,Object(I.a)(this,this.Pzj,"handleCellShadingCustomColor"));this.ia.ya(ea.a.CKa,yb.a.view,Gc.Fka);this.ia.ya(ea.a.CKa,yb.a.tableCell,Object(I.a)(this,this.FEj,"handleRemoveCellShading"));this.ia.he(ea.a.l6,4);this.ia.he(ea.a.CKa,4);this.ia.ra(ea.a.Fpc,yb.a.application,Object(I.a)(this,this.Fpc,"queryLockAspectRatio"),96);this.ia.ra(ea.a.Osc,yb.a.application,Object(I.a)(this,this.Osc,"setLockAspectRatio"),
4);this.ia.ra(ea.a.tLb,yb.a.view,Object(I.a)(this,this.tLb,"queryTableRowHeight"),96);this.ia.ra(ea.a.sLb,yb.a.view,Object(I.a)(this,this.sLb,"queryTableColumnWidth"),96);this.ia.ra(ea.a.E1a,yb.a.view,Object(I.a)(this,this.E1a,"setTableRowHeight"),4);this.ia.ra(ea.a.ULa,yb.a.view,Object(I.a)(this,this.ULa,"setTableColumnWidth"),4);this.ia.ra(ea.a.Lud,yb.a.view,Object(I.a)(this,this.E1a,"setTableRowHeight"),4);this.ia.ra(ea.a.Kud,yb.a.view,Object(I.a)(this,this.ULa,"setTableColumnWidth"),4);this.ia.ra(ea.a.vrh,
hc.a.application,Object(I.a)(this,this.SEj,"handleResizeFallbackTable"),4);this.ia.ra(ea.a.mqc,yb.a.view,Object(I.a)(this,this.Ljh,"queryTableSize"),96);this.ia.ra(ea.a.Ind,yb.a.view,Object(I.a)(this,this.Ljh,"queryTableSize"),96);this.ia.ra(ea.a.tpa,yb.a.view,Object(I.a)(this,this.vyh,"setTableSize"),4);this.ia.ra(ea.a.VLa,yb.a.view,Object(I.a)(this,this.vyh,"setTableSize"),4);this.ia.ra(ea.a.mergeTableCells,yb.a.view,Object(I.a)(this,this.tCj,"handleMergeTableCells"),4);this.ia.ra(ea.a.splitTableCells,
yb.a.view,Object(I.a)(this,this.LFj,"handleSplitTableCells"),4);this.ia.ra(ea.a.FUf,yb.a.view,Object(I.a)(this,this.Keg,"handleDistributeRows"),4);this.ia.ra(ea.a.EUf,yb.a.view,Object(I.a)(this,this.IAj,"handleDistributeColumns"),4);this.ia.ra(ea.a.nHh,yb.a.view,Object(I.a)(this,this.Keg,"handleDistributeRows"),4);this.ia.ra(ea.a.agh,yb.a.view,Object(I.a)(this,this.wDj,"handlePopulateCellBorderColorMenu"),96);this.ia.ra(ea.a.Agh,yb.a.view,Object(I.a)(this,this.Nzj,"handleCellBorderRecentColor"),96);
this.ia.ra(ea.a.u4g,yb.a.view,Object(I.a)(this,this.wCj,"handleMoreCellBorderColors"),96);this.ia.ra(ea.a.dHh,yb.a.view,Object(I.a)(this,this.YFj,"handleTableBorderWidthAnchor"),4);this.ia.ra(ea.a.Iza,yb.a.view,Object(I.a)(this,this.jFj,"handleSelectTableBorderWidth"),4);this.ia.ra(ea.a.QGh,yb.a.view,Object(I.a)(this,this.WFj,"handleTableBorderColorAnchor"),4);this.ia.ra(ea.a.p2a,yb.a.view,Object(I.a)(this,this.iFj,"handleSelectTableBorderColor"),4);this.ia.ra(ea.a.cHh,yb.a.view,Object(I.a)(this,
this.XFj,"handleTableBorderTypeAnchor"),4);this.ia.ra(ea.a.Lpa,yb.a.view,Object(I.a)(this,this.xYc,"handleSelectTableBorderType"),4);this.ia.ra(ea.a.SGh,yb.a.view,Object(I.a)(this,this.eFj,"handleSelectInsideTableBorderType"),4);this.ia.ra(ea.a.RGh,yb.a.view,Object(I.a)(this,this.Pfg,"handleSelectInsideHorizontalTableBorderType"),4);this.ia.ra(ea.a.TGh,yb.a.view,Object(I.a)(this,this.Qfg,"handleSelectInsideVerticalTableBorderType"),4);this.ia.ra(ea.a.QSe,yb.a.view,Object(I.a)(this,this.nEj,"handleQueryTableBorderWidth_1"),
96);this.ia.ra(ea.a.RSe,yb.a.view,Object(I.a)(this,this.oEj,"handleQueryTableBorderWidth_2"),96);this.ia.ra(ea.a.SSe,yb.a.view,Object(I.a)(this,this.pEj,"handleQueryTableBorderWidth_3"),96);this.ia.ra(ea.a.TSe,yb.a.view,Object(I.a)(this,this.qEj,"handleQueryTableBorderWidth_4"),96);this.ia.ra(ea.a.USe,yb.a.view,Object(I.a)(this,this.rEj,"handleQueryTableBorderWidth_5"),96);this.ia.ra(ea.a.VSe,yb.a.view,Object(I.a)(this,this.sEj,"handleQueryTableBorderWidth_6"),96);this.ia.ra(ea.a.WSe,yb.a.view,Object(I.a)(this,
this.tEj,"handleQueryTableBorderWidth_7"),96);this.ia.ra(ea.a.XSe,yb.a.view,Object(I.a)(this,this.uEj,"handleQueryTableBorderWidth_8"),96);this.ia.ra(ea.a.YSe,yb.a.view,Object(I.a)(this,this.vEj,"handleQueryTableBorderWidth_9"),96);this.ia.ra(ea.a.LSe,yb.a.view,Object(I.a)(this,this.iEj,"handleQueryTableBorderType_LeftBorder"),96);this.ia.ra(ea.a.OSe,yb.a.view,Object(I.a)(this,this.lEj,"handleQueryTableBorderType_RightBorder"),96);this.ia.ra(ea.a.PSe,yb.a.view,Object(I.a)(this,this.mEj,"handleQueryTableBorderType_TopBorder"),
96);this.ia.ra(ea.a.FSe,yb.a.view,Object(I.a)(this,this.cEj,"handleQueryTableBorderType_BottomBorder"),96);this.ia.ra(ea.a.HSe,yb.a.view,Object(I.a)(this,this.eEj,"handleQueryTableBorderType_DiagonalUpBorder"),96);this.ia.ra(ea.a.GSe,yb.a.view,Object(I.a)(this,this.dEj,"handleQueryTableBorderType_DiagonalDownBorder"),96);this.ia.ra(ea.a.JSe,yb.a.view,Object(I.a)(this,this.gEj,"handleQueryTableBorderType_InsideHorizontalBorder"),96);this.ia.ra(ea.a.KSe,yb.a.view,Object(I.a)(this,this.hEj,"handleQueryTableBorderType_InsideVerticalBorder"),
96);this.ia.ra(ea.a.ISe,yb.a.view,Object(I.a)(this,this.fEj,"handleQueryTableBorderType_InsideBorder"),96);this.ia.ra(ea.a.NSe,yb.a.view,Object(I.a)(this,this.kEj,"handleQueryTableBorderType_OutsideBorder"),96);this.ia.ra(ea.a.ESe,yb.a.view,Object(I.a)(this,this.bEj,"handleQueryTableBorderType_AllBorder"),96);this.ia.ra(ea.a.MSe,yb.a.view,Object(I.a)(this,this.jEj,"handleQueryTableBorderType_NoBorder"),96)}pe(){}ksa(a){return a.Op()?eb.a("TableBordersComplexTableFixEnabled"):!0}YY(){var a=!1;this.ta.Ba&&
(a=this.pa.fo(),a=!!a&&a.vd);return a}Qzj(){return this.YY()?32:8}xDj(a,b,c,f,l){if(!this.YY())return 16;if(1===c)return 32;if(!l)return 8;a=this.ta.Ba;if(!a)throw Error.argumentNull("ActiveSlide is null");c=this.Tb.Ef.dda;b=Object.assign(new On.a,{Id:"PptRibbon.TableDesign.Shading",MenuSectionList:[]});Array.add(b.MenuSectionList,Xk.f(a.Ed,KE.a.themeColors,"Color.Menu.Controls","themeColor","ThemeCellShadingColorPicker","3704601382",1));Array.add(b.MenuSectionList,Xk.d("Standard Colors","Color.Menu.Controls",
"standardColor","StandardCellShadingColorPicker","3704601382",!1));Array.add(b.MenuSectionList,Xk.b("Remove Color","Color.Menu.Controls","2292419401",ResourceStrings.L_RemoveShapeFill,"Color.Menu.RemoveColor","ShapeNoFill","per_AppointmentColor0_16x16x32",CommonUIStrings.l_RemoveShapeFillKeytip));c&&0<c.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellShadingRecentColors",!1)),Array.add(b.MenuSectionList,Xk.c(c,"Recent Colors","Color.Menu.Controls","recentColor","CellShadingRecentColors",
"4078162917",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellShadingRecentColors",!0));eb.a("ColorPickerHighlighterFix")&&(c=this.JA.O4f(this.pa.Ev()),Xk.h(b,c,a.Ed));l.MenuItems=b;return 32}xCj(a,b,c,f,l){if(!this.YY())return xa.a.J(512500107,822,10,"HandleMoreCellShadingColor: ShouldExecuteTableEditAction returned false"),16;if(1===c)return this.ia.Ka(ea.a.renderColorPicker,1,l);a=this.Iqj();b={};b.currentColor=a;b.handleCommand=ea.a.Uld;return this.ia.Ka(ea.a.renderColorPicker,
2,b)}Pzj(a,b,c,f,l){if(1===c)return this.ia.Ka(ea.a.l6,c,l);if(!l)return xa.a.J(512500106,822,10,"HandleCellShadingCustomColor: actionData is null"),16;a=this.ia.Ka(ea.a.l6,c,l);32===a&&this.ia.Ka(ea.a.xCa,c,l);return a}Ozj(a,b,c,f,l){if(!this.YY())return 16;if(1===c)return 32;if(!l)return 8;b=b.node;l=Ge.Box4ColorHelper.pS(l);if(!l)return 8;c=this.Eb.je(15);c.hc(b);c.fd=a;a=b.cellShading;gp.b(a);a.solidFillField=l;b.cellShading=a;c.dispose();xa.a.J(573437397,822,15,String.format("HandleCellShadingColor: EntryPoint:{0} ",
TN.a[this.ia.eq]));return 32}FEj(a,b,c){if(!this.YY())return 16;if(1===c)return 32;b=b.node;c=this.Eb.je(15);c.hc(b);c.fd=a;a=cl.a.ri(b,zb.a.cellShading,new eS.a);gp.b(a);a.noFillField=new ey;b.cellShading=a;c.dispose();return 32}YFj(){const a=this.pa.un();return a&&this.YY()&&this.Ea.uKb&&this.ksa(a)?32:8}jFj(a,b,c,f,l){a=this.pa.un();if(!(a&&this.YY()&&this.ksa(a)&&this.Ea.uKb))return 16;if(1===c)return 32;if(!l)return 8;switch(l.SourceControlId){case "TableBorderWidth_1":this.LH=this.$z[1];break;
case "TableBorderWidth_2":this.LH=this.$z[2];break;case "TableBorderWidth_3":this.LH=this.$z[3];break;case "TableBorderWidth_4":this.LH=this.$z[4];break;case "TableBorderWidth_5":this.LH=this.$z[5];break;case "TableBorderWidth_6":this.LH=this.$z[6];break;case "TableBorderWidth_7":this.LH=this.$z[7];break;case "TableBorderWidth_8":this.LH=this.$z[8];break;case "TableBorderWidth_9":this.LH=this.$z[9]}this.uu.PA();return 32}IKa(a,b){return(a=Object(qa.a)(Vh.a,a))?(this.LH===b?a.Hf(!0):a.Hf(!1),32):8}nEj(a,
b,c,f,l){return this.IKa(l,this.$z[1])}oEj(a,b,c,f,l){return this.IKa(l,this.$z[2])}pEj(a,b,c,f,l){return this.IKa(l,this.$z[3])}qEj(a,b,c,f,l){return this.IKa(l,this.$z[4])}rEj(a,b,c,f,l){return this.IKa(l,this.$z[5])}sEj(a,b,c,f,l){return this.IKa(l,this.$z[6])}tEj(a,b,c,f,l){return this.IKa(l,this.$z[7])}uEj(a,b,c,f,l){return this.IKa(l,this.$z[8])}vEj(a,b,c,f,l){return this.IKa(l,this.$z[9])}WFj(){const a=this.pa.un();return a&&this.YY()&&this.Ea.ejb&&this.ksa(a)?32:8}iFj(a,b,c,f,l){a=e(this.pa,
l);b=a.un();if(!(b&&a.YY(this.ta)&&this.ksa(b)&&this.Ea.ejb))return 16;if(1===c)return 32;if(!l)return 8;this.Rx=Ge.Box4ColorHelper.pS(l);this.uu.PA();return 32}wDj(a,b,c,f,l){a=this.pa.un();if(!(a&&this.YY()&&this.ksa(a)))return 16;if(1===c)return 32;if(!l)return 8;c=this.ta.Ba;if(!c)throw Error.argumentNull("ActiveSlide is null");a=this.Tb.Ef.dda;b=Object.assign(new On.a,{Id:"PptRibbon.TableDesign.CellBorderColors",MenuSectionList:[]});Array.add(b.MenuSectionList,Xk.f(c.Ed,"Theme Colors","Color.Menu.Controls",
"themeColor","CellBorderColorPicker","71763897",1));Array.add(b.MenuSectionList,Xk.d("Standard Colors","Color.Menu.Controls","standardColor","StandardCellBorderColorPicker","71763897",!1));a&&0<a.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellBorderRecentColors",!1)),Array.add(b.MenuSectionList,Xk.c(a,"Recent Colors","Color.Menu.Controls","recentColor","CellBorderRecentColors","1124206375",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellBorderRecentColors",
!0));l.MenuItems=b;return 32}Nzj(a,b,c,f,l){if(1===c)return this.ia.Ka(ea.a.p2a,c,l);if(!l)return xa.a.J(512500100,822,10,"HandleCellBorderRecentColor: actionData is null"),16;a=this.ia.Ka(ea.a.p2a,c,l);32===a&&this.ia.Ka(ea.a.xCa,c,l);return a}wCj(a,b,c,f,l){a=this.pa.un();if(!(a&&this.YY()&&this.Ea.ejb&&this.ksa(a)))return xa.a.J(512500099,822,10,"HandleMoreCellBorderColors: ShouldExecuteTableEditAction returned false"),16;if(1===c)return this.ia.Ka(ea.a.renderColorPicker,1,l);c=null;b.Pk&&(b=b.node)&&
b.cellShading&&b.cellShading.solidFillField&&(c=Ge.Box4ColorHelper.Jta(b.cellShading.solidFillField));b={};b.currentColor=c;b.handleCommand=ea.a.p2a;return this.ia.Ka(ea.a.renderColorPicker,2,b)}XFj(){const a=this.pa.un();return a&&this.YY()&&this.Ea.Faa&&this.ksa(a)?32:8}eFj(a,b,c,f,l){if(2===c)return this.xYc(a,b,c,f,l);const y=this.Pfg(a,b,c,f,l);a=this.Qfg(a,b,c,f,l);return 32===y||32===a?32:8}Pfg(a,b,c,f,l){if(2===c)return this.xYc(a,b,c,f,l);c=this.pa.un();a=!!c&&this.YY()&&this.Ea.Faa&&this.ksa(c);
if(!a)return 8;if(this.pa.Fs())return 16;b=this.pa.Ev();if(!b)return 16;b.length||(b=this.zc.UF(c));if(!b||!b.length)return 16;a=!1;c=b[0].rowIndex;for(const y of b)if(c!==y.rowIndex){a=!0;break}return a?32:8}Qfg(a,b,c,f,l){if(2===c)return this.xYc(a,b,c,f,l);c=this.pa.un();a=!!c&&this.YY()&&this.Ea.Faa&&this.ksa(c);if(!a)return 8;if(this.pa.Fs())return 16;b=this.pa.Ev();if(!b)return 16;b.length||(b=this.zc.UF(c));if(!b||!b.length)return 16;a=!1;c=b[0].Ai;for(const y of b)if(c!==y.Ai){a=!0;break}return a?
32:8}xYc(a,b,c,f,l){var y;b=e(this.pa,l);if(b.Fs())return 16;const H=b.un();if(!H)return 16;if(1===c)return this.ksa(H)?32:8;if(!l)return xa.a.J(512500098,822,10,"HandleSelectTableBorderType: actionData is null"),16;let Q=b.Ev();if(!Q)return 16;Q.length||(Q=this.rEa(this.zc.UF(H)));if(!Q||!Q.length)return xa.a.J(512500097,822,10,"HandleSelectTableBorderType: unable to get valid cellNodes"),16;c=this.LH;let ia=xe.a.RH(c),wa=null!==(y=l.BorderColor)&&void 0!==y?y:this.Rx;const Ua=l.SourceControlId,
kb=!!l.DoNotCreateTransaction;if(!Ua||!wa)return xa.a.J(512500096,822,10,String.format("HandleSelectTableBorderType: Invalid Table Border params recorded.")),8;this.YF.Fb(Ua)&&this.YF.ga(Ua)&&(ia=c=0,wa=Au.a.parse("000000").RMa());return Du.D0i(a,Ua,c.toString(),this.nIi(wa),TN.a[this.ia.eq],()=>{let Gb;kb||(Gb=this.Eb.je(15),Gb.hc(H),Gb.fd=a);this.KQl(a,Ua,H,Q,ia,wa);Gb&&Gb.dispose();return 32})}KQl(a,b,c,f,l,y){switch(b){case "TableBordersTopBorder":this.LUa(c,f,l,y,!1,!1);break;case "TableBordersBottomBorder":this.GUa(c,
f,l,y,!1,!1);break;case "TableBordersLeftBorder":this.JUa(c,f,l,y,!1,!1);break;case "TableBordersRightBorder":this.KUa(c,f,l,y,!1,!1);break;case "TableBordersInsideHorizontalBorder":this.HUa(c,f,l,y,!1,!1,!1);break;case "TableBordersInsideVerticalBorder":this.IUa(c,f,l,y,!1,!1,!1);break;case "TableBordersInsideBorders":this.HUa(c,f,l,y,!1,!1,!1);this.IUa(c,f,l,y,!1,!1,!1);break;case "TableBordersOutsideBorders":this.LUa(c,f,l,y,!1,!1);this.GUa(c,f,l,y,!1,!1);this.JUa(c,f,l,y,!1,!1);this.KUa(c,f,l,
y,!1,!1);break;case "TableBordersNoBorder":l=0;y=Au.a.parse("000000").RMa();this.LUa(c,f,l,y,!1,!1);this.GUa(c,f,l,y,!1,!1);this.JUa(c,f,l,y,!1,!1);this.KUa(c,f,l,y,!1,!1);this.HUa(c,f,l,y,!1,!1,!1);this.IUa(c,f,l,y,!1,!1,!1);this.Ea.bQe&&(this.ueg(f,l,y),this.teg(f,l,y));break;case "TableBordersAllBorders":this.LUa(c,f,l,y,!1,!1);this.GUa(c,f,l,y,!1,!1);this.JUa(c,f,l,y,!1,!1);this.KUa(c,f,l,y,!1,!1);this.HUa(c,f,l,y,!1,!1,!1);this.IUa(c,f,l,y,!1,!1,!1);break;case "TableBordersDiagonalUpBorder":this.ueg(f,
l,y);break;case "TableBordersDiagonalDownBorder":this.teg(f,l,y);break;default:xa.a.J(512500067,822,10,String.format("HandleSelectTableBorderType: Invalid Table borderType : {0} with actionId : {1} ",b,a))}}rEa(a){const b=[];for(const c of a)c.isGhostCell||b.push(c);return b}iEj(a,b,c,f,l){a=this.pa.un();if(!a)return 16;b=this.pa.Ev();if(!b)return 16;b.length||(b=this.rEa(this.zc.UF(a)));if(!b||!b.length)return xa.a.J(512500066,822,10,"HandleQueryTableBorderType_LeftBorder: unable to get valid cellNodes"),
16;l=Object(qa.a)(Vh.a,l);c=xe.a.RH(this.LH);return l?(this.JUa(a,b,c,this.Rx,!0,!1)?(this.YF.$("TableBordersLeftBorder",!0),l.Hf(!0)):(this.YF.$("TableBordersLeftBorder",!1),l.Hf(!1)),32):8}lEj(a,b,c,f,l){a=this.pa.un();if(!a)return 16;b=this.pa.Ev();if(!b)return 16;b.length||(b=this.rEa(this.zc.UF(a)));if(!b||!b.length)return xa.a.J(512500065,822,10,"HandleQueryTableBorderType_RightBorder: unable to get valid cellNodes"),16;l=Object(qa.a)(Vh.a,l);c=xe.a.RH(this.LH);return l?(this.KUa(a,b,c,this.Rx,
!0,!1)?(this.YF.$("TableBordersRightBorder",!0),l.Hf(!0)):(this.YF.$("TableBordersRightBorder",!1),l.Hf(!1)),32):8}mEj(a,b,c,f,l){a=this.pa.un();if(!a)return 16;b=this.pa.Ev();if(!b)return 16;b.length||(b=this.rEa(this.zc.UF(a)));if(!b||!b.length)return xa.a.J(512500064,822,10,"HandleQueryTableBorderType_TopBorder: unable to get valid cellNodes"),16;l=Object(qa.a)(Vh.a,l);c=xe.a.RH(this.LH);return l?(this.LUa(a,b,c,this.Rx,!0,!1)?(this.YF.$("TableBordersTopBorder",!0),l.Hf(!0)):(this.YF.$("TableBordersTopBorder",
!1),l.Hf(!1)),32):8}cEj(a,b,c,f,l){a=this.pa.un();if(!a)return 16;b=this.pa.Ev();if(!b)return 16;b.length||(b=this.rEa(this.zc.UF(a)));if(!b||!b.length)return xa.a.J(512500063,822,10,"HandleQueryTableBorderType_BottomBorder: unable to get valid cellNodes"),16;l=Object(qa.a)(Vh.a,l);c=xe.a.RH(this.LH);return l?(this.GUa(a,b,c,this.Rx,!0,!1)?(this.YF.$("TableBordersBottomBorder",!0),l.Hf(!0)):(this.YF.$("TableBordersBottomBorder",!1),l.Hf(!1)),32):8}gEj(a,b,c,f,l){a=this.pa.un();if(!a)return 16;b=this.pa.Ev();
if(!b)return 16;b.length||(b=this.zc.UF(a));if(!b||!b.length)return xa.a.J(512500062,822,10,"HandleQueryTableBorderType_InsideHorizontalBorder: unable to get valid cellNodes"),16;l=Object(qa.a)(Vh.a,l);c=xe.a.RH(this.LH);return l?(this.HUa(a,b,c,this.Rx,!0,!1,!1)?(this.YF.$("TableBordersInsideHorizontalBorder",!0),l.Hf(!0)):(this.YF.$("TableBordersInsideHorizontalBorder",!1),l.Hf(!1)),32):8}hEj(a,b,c,f,l){a=this.pa.un();if(!a)return 16;b=this.pa.Ev();if(!b)return 16;b.length||(b=this.zc.UF(a));if(!b||
!b.length)return xa.a.J(512500061,822,10,"HandleQueryTableBorderType_InsideVerticalBorder: unable to get valid cellNodes"),16;l=Object(qa.a)(Vh.a,l);c=xe.a.RH(this.LH);return l?(this.IUa(a,b,c,this.Rx,!0,!1,!1)?(this.YF.$("TableBordersInsideVerticalBorder",!0),l.Hf(!0)):(this.YF.$("TableBordersInsideVerticalBorder",!1),l.Hf(!1)),32):8}eEj(a,b,c,f,l){return this.Dfg(l,"TableBordersDiagonalUpBorder")}dEj(a,b,c,f,l){return this.Dfg(l,"TableBordersDiagonalDownBorder")}Dfg(a,b){if(!this.Ea.bQe)return 8;
const c=this.pa.un();if(!c||!a)return 16;var f=this.pa.Ev();if(!f)return 16;f.length||(f=this.rEa(this.zc.UF(c)));if(!f||!f.length)return xa.a.J(512500060,822,10,String.format("HandleQueryTableBorderType: unable to get valid cellNodes, borderType : {0} ",b)),16;a=Object(qa.a)(Vh.a,a);if(null===a)return 8;f=this.tTj(b,f,xe.a.RH(this.LH));this.YF.$(b,f);a.Hf(f);return 32}tTj(a,b,c){switch(a){case "TableBordersDiagonalUpBorder":return this.yng(b,c,this.Rx,!1);case "TableBordersDiagonalDownBorder":return this.xng(b,
c,this.Rx,!1);default:return xa.a.J(512500059,822,10,String.format("IsBorderApplied: Invalid Table borderType : {0} ",a)),!1}}fEj(a,b,c,f,l){a=this.pa.un();if(!a)return 16;b=this.pa.Ev();if(!b)return 16;b.length||(b=this.zc.UF(a));if(!b||!b.length)return xa.a.J(512500058,822,10,"HandleQueryTableBorderType_InsideBorder: unable to get valid cellNodes"),16;l=Object(qa.a)(Vh.a,l);c=xe.a.RH(this.LH);return l?(1<b.length&&this.IUa(a,b,c,this.Rx,!0,!1,!0)&&this.HUa(a,b,c,this.Rx,!0,!1,!0)?(this.YF.$("TableBordersInsideBorders",
!0),l.Hf(!0)):(this.YF.$("TableBordersInsideBorders",!1),l.Hf(!1)),32):8}kEj(a,b,c,f,l){a=this.pa.un();if(!a)return 16;b=this.pa.Ev();if(!b)return 16;b.length||(b=this.rEa(this.zc.UF(a)));if(!b||!b.length)return xa.a.J(512500057,822,10,"HandleQueryTableBorderType_OutsideBorder: unable to get valid cellNodes"),16;l=Object(qa.a)(Vh.a,l);c=xe.a.RH(this.LH);return l?(this.LUa(a,b,c,this.Rx,!0,!1)&&this.KUa(a,b,c,this.Rx,!0,!1)&&this.GUa(a,b,c,this.Rx,!0,!1)&&this.JUa(a,b,c,this.Rx,!0,!1)?(this.YF.$("TableBordersOutsideBorders",
!0),l.Hf(!0)):(this.YF.$("TableBordersOutsideBorders",!1),l.Hf(!1)),32):8}bEj(a,b,c,f,l){a=this.pa.un();if(!a)return 16;b=this.pa.Ev();if(!b)return 16;b.length||(b=this.rEa(this.zc.UF(a)));if(!b||!b.length)return xa.a.J(512500056,822,10,"HandleQueryTableBorderType_AllBorder: unable to get valid cellNodes"),16;l=Object(qa.a)(Vh.a,l);c=xe.a.RH(this.LH);return l?(this.LUa(a,b,c,this.Rx,!0,!1)&&this.KUa(a,b,c,this.Rx,!0,!1)&&this.GUa(a,b,c,this.Rx,!0,!1)&&this.JUa(a,b,c,this.Rx,!0,!1)&&this.HUa(a,b,c,
this.Rx,!0,!1,!0)&&this.IUa(a,b,c,this.Rx,!0,!1,!0)?(this.YF.$("TableBordersAllBorders",!0),l.Hf(!0)):(this.YF.$("TableBordersAllBorders",!1),l.Hf(!1)),32):8}jEj(a,b,c,f,l){a=this.pa.un();if(!a)return 16;b=this.pa.Ev();if(!b)return 16;b.length||(b=this.rEa(this.zc.UF(a)));if(!b||!b.length)return xa.a.J(512500055,822,10,"HandleQueryTableBorderType_NoBorder: unable to get valid cellNodes"),16;l=Object(qa.a)(Vh.a,l);c=xe.a.RH(this.LH);return l?(f=!0,this.Ea.bQe&&(f=this.yng(b,c,this.Rx,!0)&&this.xng(b,
c,this.Rx,!0)),f&&this.LUa(a,b,c,this.Rx,!0,!0)&&this.KUa(a,b,c,this.Rx,!0,!0)&&this.GUa(a,b,c,this.Rx,!0,!0)&&this.JUa(a,b,c,this.Rx,!0,!0)&&this.HUa(a,b,c,this.Rx,!0,!0,!0)&&this.IUa(a,b,c,this.Rx,!0,!0,!0)?(this.YF.$("TableBordersNoBorder",!0),l.Hf(!0)):(this.YF.$("TableBordersNoBorder",!1),l.Hf(!1)),32):8}sFa(a,b){if(!a)return!1;const c=Ge.Box4ColorHelper.Rga(a),f=Ge.Box4ColorHelper.Rga(b);a=Ge.Box4ColorHelper.Jta(a);b=Ge.Box4ColorHelper.Jta(b);return c.schemeClrField&&f.schemeClrField&&!a&&!b&&
c.schemeClrField.valField===f.schemeClrField.valField?!0:a&&b?a.alpha===b.alpha&&a.PD===b.PD:!1}nIi(a){a=Ge.Box4ColorHelper.Rga(a);const b=this.ta.Ba;return(a=Ge.Box4ColorHelper.UH(a,b?b.Ed:null))&&Ge.Box4ColorHelper.jha(a)?Ge.Box4ColorHelper.jha(a).yV():null}qwb(a,b,c,f){if(a=Object(qa.a)(st,a.qc(this.Gb.Na))){f=Ge.Box4ColorHelper.Rga(f);var l=this.ta.Ba;f=(f=Ge.Box4ColorHelper.UH(f,l?l.Ed:null))?Ge.Box4ColorHelper.jha(f):null;a.Djl(b,c,f)}}tv(a,b,c,f){if(a)switch(b){case "Top":a.Kza=c;a.wMa=f;this.qwb(a,
"Top",c,f);break;case "Right":a.cha=c;a.aha=f;this.qwb(a,"Right",c,f);break;case "Bottom":a.bha=c;a.$ga=f;this.qwb(a,"Bottom",c,f);break;case "Left":a.Jza=c;a.vMa=f;this.qwb(a,"Left",c,f);break;case "DiagonalUp":a.wmb=c;a.umb=f;this.qwb(a,"DiagonalUp",c,f);break;case "DiagonalDown":a.vmb=c,a.tmb=f,this.qwb(a,"DiagonalDown",c,f)}}LUa(a,b,c,f,l,y){const H=new Eb.ScriptSharpLegacyMap;let Q=Number.MAX_VALUE,ia=-1;for(const wa of b)b=wa.Ai,Q=Math.min(Q,b),ia=Math.max(ia,b),H.Fb(b)?H.$(b,Math.min(H.ga(b),
wa.rowIndex)):H.$(b,wa.rowIndex);if(l)return this.V4j(a,c,f,Q,ia,H,y);this.yzj(a,c,f,Q,ia,H);return!0}yzj(a,b,c,f,l,y){if(eb.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const Q=a.ef(y.ga(f),f);this.tv(Q,"Top",b,c);let ia=f;const wa=f+Q.colSpan;for(;ia<wa;){var H=a.ef(y.ga(f)-1,ia);H?H.isGhostCell?(H=H.mz(),H.Ai<f?ia+=1:(this.tv(H,"Bottom",b,c),ia+=H.colSpan)):(this.tv(H,"Bottom",b,c),ia+=H.colSpan):ia+=1}f+=Q.colSpan}else for(;f<=l;++f)this.tv(a.ef(y.ga(f),f),"Top",b,c),this.tv(a.ef(y.ga(f)-
1,f),"Bottom",b,c)}V4j(a,b,c,f,l,y,H){for(;f<=l;){const Q=a.ef(y.ga(f),f),ia=Q.wMa,wa=xe.a.JM(Q.Kza),Ua=xe.a.JM(b);if(H){if(wa!==this.$z[0])return!1}else if(wa!==Ua||!this.sFa(ia,c))return!1;f+=Q.colSpan}return!0}GUa(a,b,c,f,l,y){const H=new Eb.ScriptSharpLegacyMap;let Q=Number.MAX_VALUE,ia=-1;for(const wa of b)b=wa.Ai,Q=Math.min(Q,b),ia=Math.max(ia,b),H.Fb(b)?H.$(b,Math.max(H.ga(b),wa.rowIndex)):H.$(b,wa.rowIndex);if(l)return this.wTj(a,c,f,Q,ia,H,y);this.hzj(a,c,f,Q,ia,H);return!0}hzj(a,b,c,f,l,
y){if(eb.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const Q=a.ef(y.ga(f),f);this.tv(Q,"Bottom",b,c);let ia=f;const wa=f+Q.colSpan;for(;ia<wa;){var H=a.ef(y.ga(f)+Q.rowSpan,ia);H?H.isGhostCell?(H=H.mz(),H.Ai<f?ia+=1:(this.tv(H,"Top",b,c),ia+=H.colSpan)):(this.tv(H,"Top",b,c),ia+=H.colSpan):ia+=1}f+=Q.colSpan}else for(;f<=l;++f)this.tv(a.ef(y.ga(f),f),"Bottom",b,c),this.tv(a.ef(y.ga(f)+1,f),"Top",b,c)}wTj(a,b,c,f,l,y,H){for(;f<=l;){const Q=a.ef(y.ga(f),f),ia=Q.$ga,wa=xe.a.JM(Q.bha),Ua=xe.a.JM(b);
if(H){if(wa!==this.$z[0])return!1}else if(wa!==Ua||!this.sFa(ia,c))return!1;f+=Q.colSpan}return!0}JUa(a,b,c,f,l,y){const H=new Eb.ScriptSharpLegacyMap;let Q=Number.MAX_VALUE,ia=-1;for(const wa of b)b=wa.rowIndex,Q=Math.min(Q,b),ia=Math.max(ia,b),H.Fb(b)?H.$(b,Math.min(H.ga(b),wa.Ai)):H.$(b,wa.Ai);if(l)return this.dZj(a,c,f,Q,ia,H,y);this.ozj(a,c,f,Q,ia,H);return!0}ozj(a,b,c,f,l,y){if(eb.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const Q=a.ef(f,y.ga(f));this.tv(Q,"Left",b,c);let ia=f;const wa=
f+Q.rowSpan;for(;ia<wa;){var H=a.ef(ia,y.ga(f)-1);H?H.isGhostCell?(H=H.mz(),H.rowIndex<f?ia+=1:(this.tv(H,"Right",b,c),ia+=H.rowSpan)):(this.tv(H,"Right",b,c),ia+=H.rowSpan):ia+=1}f+=Q.rowSpan}else for(;f<=l;++f)this.tv(a.ef(f,y.ga(f)),"Left",b,c),this.tv(a.ef(f,y.ga(f)-1),"Right",b,c)}dZj(a,b,c,f,l,y,H){for(;f<=l;){const Q=a.ef(f,y.ga(f)),ia=Q.vMa,wa=xe.a.JM(Q.Jza),Ua=xe.a.JM(b);if(H){if(wa!==this.$z[0])return!1}else if(wa!==Ua||!this.sFa(ia,c))return!1;f+=Q.rowSpan}return!0}KUa(a,b,c,f,l,y){const H=
new Eb.ScriptSharpLegacyMap;let Q=Number.MAX_VALUE,ia=-1;for(const wa of b)b=wa.rowIndex,Q=Math.min(Q,b),ia=Math.max(ia,b),H.Fb(b)?H.$(b,Math.max(H.ga(b),wa.Ai)):H.$(b,wa.Ai);if(l)return this.c2j(a,c,f,Q,ia,H,y);this.pzj(a,c,f,Q,ia,H);return!0}pzj(a,b,c,f,l,y){if(eb.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const Q=a.ef(f,y.ga(f));this.tv(Q,"Right",b,c);let ia=f;const wa=f+Q.rowSpan;for(;ia<wa;){var H=a.ef(ia,y.ga(f)+Q.colSpan);H?H.isGhostCell?(H=H.mz(),H.rowIndex<f?ia+=1:(this.tv(H,"Left",
b,c),ia+=H.rowSpan)):(this.tv(H,"Left",b,c),ia+=H.rowSpan):ia+=1}f+=Q.rowSpan}else for(;f<=l;++f)this.tv(a.ef(f,y.ga(f)),"Right",b,c),this.tv(a.ef(f,y.ga(f)+1),"Left",b,c)}c2j(a,b,c,f,l,y,H){for(;f<=l;){const Q=a.ef(f,y.ga(f)),ia=Q.aha,wa=xe.a.JM(Q.cha),Ua=xe.a.JM(b);if(H){if(wa!==this.$z[0])return!1}else if(wa!==Ua||!this.sFa(ia,c))return!1;f+=Q.rowSpan}return!0}IUa(a,b,c,f,l,y,H){b=this.pa.Syb();if(!b)return!1;b.length||(b=this.zc.UF(a));if(!b||!b.length)return xa.a.J(512500054,822,10,"HandleSelectionInsideVerticalBorders: unable to get valid cellNodes"),
!1;const Q=new Eb.ScriptSharpLegacyMap,ia=new Eb.ScriptSharpLegacyMap;let wa=Number.MAX_VALUE,Ua=-1;for(const kb of b)b=kb.rowIndex,wa=Math.min(wa,b),Ua=Math.max(Ua,b),Q.Fb(b)?Q.$(b,Math.min(Q.ga(b),kb.Ai)):Q.$(b,kb.Ai),ia.Fb(b)?ia.$(b,Math.max(ia.ga(b),kb.Ai)):ia.$(b,kb.Ai);if(l)return this.DYj(a,c,f,wa,Ua,Q,ia,y,H);this.nzj(a,c,f,wa,Ua,Q,ia);return!0}nzj(a,b,c,f,l,y,H){if(eb.a("TableBordersComplexTableFixEnabled"))for(;f<=l;f++){if(y.Fb(f)&&H.Fb(f))for(var Q=y.ga(f),ia=H.ga(f);Q<ia;){const Ua=a.ef(f,
Q);if(!Ua.isGhostCell&&Ua.Ai+Ua.colSpan<=ia){this.tv(Ua,"Right",b,c);let kb=f;const Gb=f+Ua.rowSpan;for(;kb<Gb;){var wa=a.ef(kb,Q+Ua.colSpan);wa?wa.isGhostCell?(wa=wa.mz(),wa.rowIndex<f?kb+=1:(this.tv(wa,"Left",b,c),kb+=wa.rowSpan)):(this.tv(wa,"Left",b,c),kb+=wa.rowSpan):kb+=1}}Q+=Ua.colSpan}}else for(;f<=l;++f)for(Q=y.ga(f),ia=H.ga(f);Q<ia;++Q)this.tv(a.ef(f,Q),"Right",b,c),this.tv(a.ef(f,Q+1),"Left",b,c)}DYj(a,b,c,f,l,y,H,Q,ia){if(eb.a("TableBordersComplexTableFixEnabled")){for(var wa=!1;f<=l;f++)if(y.Fb(f)&&
H.Fb(f))for(var Ua=y.ga(f),kb=H.ga(f);Ua<kb;){var Gb=a.ef(f,Ua);if(!Gb.isGhostCell&&Gb.Ai+Gb.colSpan<=kb){var ec=Gb.aha;let dc=xe.a.JM(Gb.cha),Fc=xe.a.JM(b);wa=!0;if(Q){if(dc!==this.$z[0])return!1}else if(dc!==Fc||!this.sFa(ec,c))return!1}Ua+=Gb.colSpan}return wa?!0:ia}for(wa=f;wa<=l;++wa){kb=y.ga(wa);f=H.ga(wa);if(kb===f)return ia?!0:!1;for(;kb<f;++kb)if(Gb=a.ef(wa,kb),Ua=Gb.aha,Gb=xe.a.JM(Gb.cha),ec=xe.a.JM(b),Q){if(Gb!==this.$z[0])return!1}else if(Gb!==ec||!this.sFa(Ua,c))return!1}return!0}HUa(a,
b,c,f,l,y,H){b=this.pa.Syb();if(!b)return!1;b.length||(b=this.zc.UF(a));if(!b||!b.length)return xa.a.J(512500053,822,10,"HandleSelectionInsideHorizontalBorders: unable to get valid cellNodes"),!1;const Q=new Eb.ScriptSharpLegacyMap,ia=new Eb.ScriptSharpLegacyMap;let wa=Number.MAX_VALUE,Ua=-1;for(const kb of b)b=kb.Ai,wa=Math.min(wa,b),Ua=Math.max(Ua,b),Q.Fb(b)?Q.$(b,Math.min(Q.ga(b),kb.rowIndex)):Q.$(b,kb.rowIndex),ia.Fb(b)?ia.$(b,Math.max(ia.ga(b),kb.rowIndex)):ia.$(b,kb.rowIndex);if(l)return this.CYj(a,
c,f,wa,Ua,Q,ia,y,H);this.mzj(a,c,f,wa,Ua,Q,ia);return!0}mzj(a,b,c,f,l,y,H){if(eb.a("TableBordersComplexTableFixEnabled"))for(;f<=l;f++){if(y.Fb(f)&&H.Fb(f))for(var Q=y.ga(f),ia=H.ga(f);Q<ia;){const Ua=a.ef(Q,f);if(!Ua.isGhostCell&&Ua.rowIndex+Ua.rowSpan<=ia){this.tv(Ua,"Bottom",b,c);let kb=f;const Gb=f+Ua.colSpan;for(;kb<Gb;){var wa=a.ef(Q+Ua.rowSpan,kb);wa?wa.isGhostCell?(wa=wa.mz(),wa.Ai<f?kb+=1:(this.tv(wa,"Top",b,c),kb+=wa.colSpan)):(this.tv(wa,"Top",b,c),kb+=wa.colSpan):kb+=1}}Q+=Ua.rowSpan}}else for(;f<=
l;++f)for(Q=y.ga(f),ia=H.ga(f);Q<ia;++Q)this.tv(a.ef(Q,f),"Bottom",b,c),this.tv(a.ef(Q+1,f),"Top",b,c)}CYj(a,b,c,f,l,y,H,Q,ia){if(eb.a("TableBordersComplexTableFixEnabled")){for(var wa=!1;f<=l;f++)if(y.Fb(f)&&H.Fb(f))for(var Ua=y.ga(f),kb=H.ga(f);Ua<kb;){var Gb=a.ef(Ua,f);if(!Gb.isGhostCell&&Gb.rowIndex+Gb.rowSpan<=kb){var ec=Gb.$ga;let dc=xe.a.JM(Gb.bha),Fc=xe.a.JM(b);wa=!0;if(Q){if(dc!==this.$z[0])return!1}else if(dc!==Fc||!this.sFa(ec,c))return!1}Ua+=Gb.rowSpan}return wa?!0:ia}for(wa=f;wa<=l;++wa){kb=
y.ga(wa);f=H.ga(wa);if(kb===f)return ia?!0:!1;for(;kb<f;++kb)if(Gb=a.ef(kb,wa),Ua=Gb.$ga,Gb=xe.a.JM(Gb.bha),ec=xe.a.JM(b),Q){if(Gb!==this.$z[0])return!1}else if(Gb!==ec||!this.sFa(Ua,c))return!1}return!0}ueg(a,b,c){for(const f of a)this.tv(f,"DiagonalUp",b,c)}yng(a,b,c,f){for(const l of a)if(!this.yrg(xe.a.JM(l.wmb),xe.a.JM(b),l.umb,c,f))return!1;return!0}teg(a,b,c){for(const f of a)this.tv(f,"DiagonalDown",b,c)}xng(a,b,c,f){for(const l of a)if(!this.yrg(xe.a.JM(l.vmb),xe.a.JM(b),l.tmb,c,f))return!1;
return!0}yrg(a,b,c,f,l){if(l){if(a!==this.$z[0])return!1}else if(a!==b||!this.sFa(c,f))return!1;return!0}ZSe(a,b,c,f,l){if(!l)return 8;if(1===c)return 32;l[wh.a.On]=!1;a=this.WWa[a.toString()];if(!this.pa||!this.pa.Pa.mb||this.pa.D9())return 16;b=0;({Yxa:b}=this.zc.lxd(this.pa.Pa)).returnValue&&b===a&&(l[wh.a.On]=!0);return 32}Tsc(a,b){a=a.queryResult;null!==a&&(a.iba=parseFloat(b.toFixed(2)).toString())}Fpc(a,b,c,f,l){if(!l)return 16;l.Hf(this.Mhc);return 32}Osc(a,b,c){if(1===c)return 32;2===c&&
(this.Mhc=!this.Mhc);Rc.App.Lb.BG({SetLockAspectRatio:"CheckboxModel"});return 32}Ljh(a,b,c,f,l){if(!l)return 16;b=this.pa.un();if(!b)return 8;a=a===ea.a.mqc?this.zc.Cde(b):this.zc.Ede(b);this.Tsc(l,xe.a.Zv(a));return 32}vyh(a,b,c,f,l){const y=this.pa.un();return a!==ea.a.tpa&&a!==ea.a.VLa||!y?16:1===c?32:Qg.a(String.format("{0}::Entry point:{1}",ea.a.Hv(a),this.ia.eq),a,()=>{if(!l)return xa.a.J(512500052,822,10,"TableActor::SetTableSize actionData == null"),8;var H=xe.a.ZW(l.Number);var Q=a===ea.a.tpa?
this.zc.Cde(y):this.zc.Ede(y);if(H<$v.a.pgd||Q<$v.a.pgd)return 16;H/=Q;Q=this.Eb.je(15);try{Q.hc(y),Q.fd=a,a===ea.a.tpa?(this.Rs.tpa(y,H),this.Mhc&&this.Rs.VLa(y,H)):(this.Rs.VLa(y,H),this.Mhc&&this.Rs.tpa(y,H)),this.Rs.q0a(y)}finally{Q&&Q.dispose()}return 32})}tLb(a,b,c,f,l){a=this.pa.un();if(!a)return 16;b=this.pa.XWc();if(!b)return 16;b.length||(b=this.zc.Zka(a));if(!b.length)return 16;a=this.uZa.u5f(b);this.Tsc(l,xe.a.Zv(a));return 32}E1a(a,b,c,f,l){const y=this.pa.un();return y?1===c?32:Qg.a(String.format("SetTableRowHeight::Entry point:{0}",
this.ia.eq),a,()=>{if(null===l)return xa.a.J(512500051,822,10,"TableActor::SetTableRowHeight actionData == null"),16;let H=this.pa.XWc();if(!H)return xa.a.J(512500050,822,10,"TableActor::SetTableRowHeight, selected table row nodes == null"),16;H.length||(H=this.zc.Zka(y));if(!H.length)return 16;let Q=$v.a.d4g;a!==ea.a.Lud&&(Q=l.Number);const ia=this.Eb.je(15);try{ia.hc(y),ia.fd=a,this.Rs.uyh(H,Q)}finally{ia&&ia.dispose()}this.Rs.q0a(y);return 32}):16}sLb(a,b,c,f,l){a=this.pa.un();if(!a)return 16;
b=this.pa.Syb();if(!b)return 16;b.length||(b=this.azb(a));if(!b.length)return 16;a=this.SJ.w5f(a,b);this.Tsc(l,xe.a.Zv(a));return 32}ULa(a,b,c,f,l){const y=this.pa.un();return y?1===c?32:Qg.a(String.format("SetTableColumnWidth::Entry point:{0}",this.ia.eq),a,()=>{if(null===l)return xa.a.J(512500049,822,10,"TableActor::SetTableColumnWidth actionData == null"),16;var H=this.pa.Syb();if(!H)return xa.a.J(512500048,822,10,"TableActor::SetTableColumnWidth, selected column node == null"),16;H.length||(H=
this.azb(y));if(!H.length)return 16;let Q=$v.a.c4g;a!==ea.a.Kud&&(Q=l.Number);H=this.SJ.Y9d(H);const ia=this.Eb.je(15);try{ia.hc(y),ia.fd=a,this.Rs.tyh(y,H,Q)}finally{ia&&ia.dispose()}this.Rs.q0a(y);return 32}):16}Keg(a,b,c,f,l){const y=this.pa.un();return y?1===c?eb.a("DistributeRowsAndColumnsComplexTableFixEnabled")?32:y.Op()?8:32:Qg.a("HandleDistributeRows:Entry point:"+this.ia.eq,a,()=>{if(2===c){if(null===l)return 16;let ia=this.pa.XWc();if(!ia)return 16;var H=this.pa.Ev();if(!H)return 16;ia.length&&
1!==H.length||(ia=this.zc.Zka(y));if(!ia)return 16;if(!ia.length)return xa.a.J(512500047,822,50,"HandleDistributeRows: unable to get valid tableRowNodes"),16;H=0;for(var Q of ia)Q&&(H+=this.uZa.aab(Q));Q=this.nlj(ia,y);const wa=ia.length;H=H<wa*Q?Q:H/wa;Q=this.Eb.je(15);try{Q.hc(y),Q.fd=a,this.Rs.uyh(ia,xe.a.Zv(H))}finally{Q&&Q.dispose()}xa.a.J(512500046,822,50,"HandleDistributeRows: Table Rows Distributed with height: {0}, from Entry Point: {1}",xe.a.Zv(H),this.ia.eq);this.Rs.q0a(y)}return 32}):
16}nlj(a,b){let c=xe.a.ZW($v.a.d4g);for(const l of a){a=this.zc.Aab(l);for(const y of a)if(y&&(a=y.m6b)&&(a=Db.ParagraphReader.text(a))&&0<a.length){var f=y.rowIndex;const H=y.Ai;if(a=Object(qa.a)(st,y.qc(this.Gb.Na)))this.fY.thh(b,this.Gb.Na),f=this.fY.g7b(b,a.Nja,f,H),a=a.Nd.Md.gf(f,1),eb.a("DistributeRowsAndColumnsComplexTableFixEnabled")&&1<y.rowSpan&&(a/=y.rowSpan),c=Math.max(c,a)}}return c}IAj(a,b,c,f,l){const y=this.pa.un();return y?1===c?eb.a("DistributeRowsAndColumnsComplexTableFixEnabled")?
32:y.Op()?8:32:Qg.a("HandleDistributeColumns:Entry point:"+this.ia.eq,a,()=>{if(2===c){if(null===l)return 16;var H=this.pa.Syb();H.length||(H=this.azb(y));if(!H)return 16;var Q=this.pa.Ev();if(!Q)return 16;H.length&&1!==Q.length||(H=this.azb(y));if(!H.length)return xa.a.J(512500045,822,50,"HandleDistributeColumns: unable to get valid tableColumnNodes"),16;Q=0;H=this.SJ.Y9d(H);if(!H)return xa.a.J(512500044,822,50,"HandleDistributeColumns: table columnIndex array is null"),16;var ia=y.U9d;if(!ia)return xa.a.J(512500043,
822,50,"HandleDistributeColumns: table columnWidths array is null"),16;for(let wa=0;wa<H.length;wa++)Q+=ia[H[wa]];Q/=H.length;if(xe.a.Zv(Q)<$v.a.c4g)return 16;ia=this.Eb.je(15);try{ia.hc(y),ia.fd=a,this.Rs.tyh(y,H,xe.a.Zv(Q))}finally{ia&&ia.dispose()}xa.a.J(512500042,822,50,"HandleDistributeColumns: Table Columns Distributed with width: {0}, from Entry Point: {1}",xe.a.Zv(Q),this.ia.eq);this.Rs.q0a(y)}return 32}):16}vfe(a,b,c,f,l){if(!this.Ea.hqe||this.pa.D9())return 16;if(1===c)return 32;if(!l)return 8;
c=this.WWa[a.toString()];b=b.node;f=this.Eb.je(15);f.hc(b);f.fd=a;a=b.cellShading;a.anchorField=c;b.cellShading=a;b.Mpa=c;f.dispose();return 32}ZBj(a,b,c,f,l){b=this.ta.Ba;if(!b||this.qf.$c(b))return 16;if(!this.hj.iD(b,1))return this.hj.KD(b),16;c=l.Rows;f=l.Columns;l=l.From;var y=b.Db;y=b.C3(y.sid,y.cid,0,c,f,b.zs());var H=b.C_(this.pa.Xd());if(H){if(this.qf.$c(H)||this.Ga.lJ(H))return 16;this.xk.Ajl(y,H.id);this.qf.rw(H,a)}H=this.Eb.xd(15,void 0,()=>{this.pa.au();this.pa.nh();this.Fa.Bd()});try{H.hc(b),
H.fd=a,b.jB(y)}finally{H&&H.dispose()}this.pa.selectShape(y,!0);xa.a.J(512500040,822,50,"Insert {0}x{1} table from {2}",f,c,l);this.Rq.lA=y;return 32}$Bj(){(new VN((a,b)=>{const c={};c.Rows=a;c.Columns=b;c.From="Placeholder";this.ia.Ka(ea.a.Wld,2,c)})).Ztd();return 32}aCj(a,b,c,f,l){l.From="Ribbon";return this.ia.Ka(ea.a.Wld,c,l)}EAj(a,b,c){b=this.ta.Ba;if(!b||this.pa.D9())return 16;const f=this.pa.fo();if(!f||!f.vd||this.qf.$c(f))return 16;if(1===c)return 32;Nc.a.AP(!0,!0);c=this.Eb.xd(15,void 0,
()=>{this.pa.setSelection(null);this.Fa.Bd()});try{c.hc(b),c.fd=a,this.xk.gQc(f)}finally{c&&c.dispose()}this.qf.rw(b,a);return 32}GAj(a,b,c,f,l){if(this.pa.Fs())return 16;a=this.wce(this.pa.Yj,!0,this.pa);return this.DSj(a)?16:32!==a.response?8:a.RA&&a.RA.length===cd.TableReader.Gk(a.rn)?this.ia.processAction(ea.a.cKb,c):this.ia.ei(b,C.a.deleteRow,c,!1,f,l)}FAj(a,b,c,f,l){if(this.pa.Fs())return 16;a=this.wce(this.pa.Yj,!1,this.pa);return this.CSj(a)?16:32!==a.response?8:a.RA&&a.RA.length===cd.TableReader.Gi(a.rn)?
this.ia.processAction(ea.a.cKb,c):this.ia.ei(b,C.a.KDa,c,!1,f,l)}hFj(a,b,c,f,l){return 1===c?32:this.ia.ei(b,ea.a.Lja,c,!1,f,l)}tCj(a,b,c){if(this.pa.Fs()||this.pa.D9()||!this.Ea.g3c)return 16;b=this.pa.Pa;if(!b||!b.Sl||1===b.length&&1===b.ga(0).length)return 16;b=this.oHb.H8b(b);if(!b)return xa.a.J(36721626,822,50,"Unable to get cell selection info"),8;if(!b.M1j)return 16;if(1===c)return 32;Nc.a.Kb&&(Nc.a.Kb.Oj=!0,Nc.a.Kb.FF=new Date);xa.a.J(36721628,822,50,"Perform table merge cells");const f=b.tableNode;
c=this.Eb.je(15);c.hc(f);c.fd=a;a=this.K_g.merge(f,b.yub,b.eZ);a=pr.TableNodeContext.create(a);a=Od.SelectionFactory.u3b(Od.SelectionFactory.Mu(a));this.pa.gF(a);c.dispose();xa.a.J(36721630,822,50,"Table merge cells succeeded");return 32}LFj(a,b,c,f,l){if(this.pa.Fs()||this.pa.D9()||!this.Ea.mqe)return 16;f=null;f=this.pa.Pa.Sl?this.oHb.H8b(this.pa.Pa):this.oHb.jsj(b.view.Nb.Yj);if(!f)return 16;const y=f.tableNode.tg(this.Gb.Na);if(y&&!y.bZj)return xa.a.J(512500037,822,50,"Suspend split cells as table layout service is running"),
16;const H=Object(qa.a)(178,f.tableNode);if(this.zc.nme(H))return 16;const Q=f.yub;if(!({rows:b,cols:a}=this.QJl(H,Q)).returnValue)return 8;if(1===c)return 1<b||1<a?32:16;const ia=f.eZ,wa=new Date;({rows:c,cols:f}=this.ocj(H,ia,Q,y));const Ua=Nc.a.Kb;Ua&&(Ua.Wa("GetClientSplitLimit",(+new Date-+wa).toString()),Ua.vr=!1);const kb=(Gb,ec)=>{this.K_g.Yzl(H,Q,Gb,ec,ia,y,this.Gb.Md,Object(I.a)(this,this.t9f,"getNewOutlineElementInfoFromCell"),()=>{})};l&&l.rows&&l.columns&&!Number.isNaN(l.rows)&&!Number.isNaN(l.columns)?
(b=Number.parseInt(l.rows),l=Number.parseInt(l.columns),l>f&&(l=f),b>c&&(b=c),kb(b,l)):(new WN((Gb,ec)=>{kb(Gb,ec)},Math.min(b,c),Math.min(a,f))).Ztd();return 32}SEj(a,b,c,f,l){if(!l||!Object(Wa.a)(Array,l))return 8;if(1!==l.length)return xa.a.J(512500036,822,50,"Fallback table resize fail: reiszeShapeData length is {0}.",l.length),8;if(this.qf.$c(l[0].U1))return 16;b=l[0].U1;if(!(b&&b.isConnected&&b.isResizable&&b.vd)||b.lJ)return xa.a.J(512500035,822,50,"Fallback table resize: try to resize shape {0} which is not resizeable",
b.get_shapeId()),16;f=Object(qa.a)(119,b.qc(this.Gb.Na));if(!f)return xa.a.J(512500034,822,50,"Fallback table resize fail: shape {0} has no shapeviewelement",b.get_shapeId()),8;const y=this.zc.ZN(b);if(!y)return xa.a.J(512500033,822,50,"Fallback table resize fail: shape {0} has no table node",b.get_shapeId()),8;const H=y.qc(this.Gb.Na);if(!H)return xa.a.J(512500032,822,50,"Fallback table resize fail: fallback table shape {0} has no tableviewelement and no rendered",b.get_shapeId()),8;if(!l[0].N4b)return f&&
f.setOffsets(new Xi.a,!0),xa.a.J(512500003,822,50,"Fallback table resize fail: resizeShapeData no drag direction"),8;if(1===c)return 32;let Q=c=1;try{f.Fk.juh.ivb.length||(this.Vbd=new Xi.a);f.setOffsets(new Xi.a,!0);var ia=H.G8b();const wa=this.NGa.om(ia.fc-ia.ic),Ua=this.NGa.om(ia.Zb-ia.kc),kb=new Zc.a(f.x+wa,f.y+Ua),Gb=new Zc.a(f.Hga(l[0].z4g.x),f.Hga(l[0].z4g.y)),ec=Uk.CXd(l[0].N4b,ia,Gb,!1,!1);c=wa?1+(ec.right-ec.left)/wa:1;Q=Ua?1+(ec.bottom-ec.top)/Ua:1;H.xyh(c,Q);const dc=H.G8b();let Fc=fj.a.Q7b(dc,
ia);Fc.Ij(1/f.od);this.Vbd&&(Fc=Xi.a.add(Fc,this.Vbd));f.setOffsets(Fc,!0);this.Vbd=Fc;l[0].I1.Ij(f.od);this.U4e(l[0].N4b,f,dc,kb,l[0].I1)}catch(wa){return xa.a.J(512500002,822,50,"Fallback table resize fail: ",wa.toString()),8}ia=this.Eb.je(15);ia.hc(y);ia.fd=a;a=H.Nd.Md;this.Rs.UWe(y,c,Q,H,a);if(Du.OFa(l[0].N4b)||Du.OFa(l[0].N4b,!0))l=a.gf(f.x,0),a=a.gf(f.y,1),b.Iy=l,b.Jy=a;ia.dispose();return 32}QJl(a,b){let c,f;c=f=1;try{return c=Math.max(1,Math.floor((35-this.zc.Gk(a))/b.fP)+1),f=Math.max(1,
Math.floor((35-this.zc.Gi(a))/b.PR)+1),{returnValue:!0,rows:c,cols:f}}catch(l){xa.a.J(512500001,822,10,"Failed to get server split limits, Exception: {0}",l.toString())}return{returnValue:!1,rows:c,cols:f}}ocj(a,b,c,f){a=this.Uea.iEa(a,b,c);b=f.qag();f=f.h5f();let l=c=Number.MAX_VALUE;for(;a.moveNext();){const y=a.qA;l=Math.min(l,b[y.eg]-b[y.te]);c=Math.min(c,f[y.Tf]-f[y.me])}return{rows:Math.max(1,Math.floor(l/XN.a)),cols:Math.max(1,Math.floor(c/XN.a))}}t9f(a){const b=Rh.Z9f(a,!1);b.style||(b.style=
new xq.a);a=Object(qa.a)(ob.GraphIterator,this.Rb.Lc(a));a.hv();if(a.zB(1)){if(Zb.ListReader.Hk(a)){const f=this.AA.Gv(a),l=pe.a.NN(f.listType,f.listStyle);0===l.listType&&(l.SA=l.oX=f.SA);f.propertySet.Ua(ab.a.Zi)&&l.propertySet.setValue(ab.a.Zi,f.propertySet.eb(ab.a.Zi));f.propertySet.Ua(ab.a.font)&&l.propertySet.setValue(ab.a.font,f.propertySet.eb(ab.a.font));f.propertySet.Ua(zb.a.autonumberBulletType)&&l.propertySet.setValue(zb.a.autonumberBulletType,f.propertySet.eb(zb.a.autonumberBulletType));
b.style.ny(l.propertySet)}var c;(c=b.style).V8a.apply(c,[a.currentNode].concat(lr.vee()));if(c=a.zB(2)){let f;(f=b.style).V8a.apply(f,[c].concat(lr.vee()));a.Cc()}}return b}qpj(a,b,c){const f=new is;f.response=8;if(!a)return f;var l=Ch.ContextSetEditor.instance.mB(a);if(eb.a("EnableInsertRowColOnWholeTable")&&1===l.length&&l[0].Pk&&(a=l[0].node)&&a.vd)return this.ppj(a,b,c);let y=a=null,H=!1;const Q=[];for(var ia=0;ia<l.length;++ia)if(l[ia].Pk){var wa=Object(qa.a)(5,l[ia].node);if(!wa||!wa.Gs())return f;
wa=wa.AL();a||(a=b?wa.getContainingTable().firstRow:wa.LUc());y?y!==wa&&(H=!0):y=wa}if(!a)return f;ia=a.getContainingTable();if(!ia)return f;if(H){c=new Na.a;if(this.mIg){l=this.oHb.H8b(this.pa.Pa).yub;if(l.eTa())return f;if(b)c.add(0);else for(b=l.te;b<l.eg;b++)c.add(b);xa.a.J(5125E5,822,50,"Insert {0} rows",c.count)}else if(c=this.kdj(l),1!==c.count)return f;b=ia.pag(c.ga(0));for(l=0;l<c.count;l++)Array.add(Q,cb.a.create(Object(qa.a)(pg.a,b))),b=b.EJa}else{if(!c)for(b=y.rowSpan;0<--b;)a=a.EJa;Array.add(Q,
cb.a.create(Object(qa.a)(pg.a,a)))}f.RA=Q;f.U1a=Object(qa.a)(pg.a,a);f.rn=Object(qa.a)(pg.a,ia);f.KJa=Q.length;if(this.Ea.lu||!cd.TableReader.wt(f.rn))f.response=32;return f}jpj(a,b,c){const f=new is;f.response=8;if(!a)return f;var l=Ch.ContextSetEditor.instance.mB(a);if(eb.a("EnableInsertRowColOnWholeTable")&&1===l.length&&l[0].Pk&&(a=l[0].node)&&a.vd)return this.ipj(a,b,c);var y=null;let H=null,Q=!1;a=[];for(let wa=0;wa<l.length;++wa)if(l[wa].Pk){var ia=Object(qa.a)(5,l[wa].node);if(!ia||!ia.Gs())return f;
ia=ia.AL();y||(y=b?ia.getContainingTable().ef(0,0):ia.C5f());H?H!==ia&&(Q=!0):H=b?ia.getContainingTable().ef(0,0):ia}if(!H||!y)return f;y=y.getContainingTable();if(!y)return f;if(Q){c=new Na.a;if(this.mIg){l=this.oHb.H8b(this.pa.Pa).yub;if(l.eTa())return f;if(b)c.add(0);else for(b=l.me;b<l.Tf;b++)c.add(b);xa.a.J(512499998,822,50,"Insert {0} columns",c.count)}else if(b?c.add(0):c=this.idj(l),1!==c.count)return f;H=y.ef(0,c.ga(0));for(b=0;b<c.count;b++)Array.add(a,cb.a.create(Object(qa.a)(pg.a,H))),
H=H.D_()}else c&&(H=y.ef(0,H.Ai+H.colSpan-1)),Array.add(a,cb.a.create(Object(qa.a)(pg.a,H)));f.RA=a;f.U1a=Object(qa.a)(pg.a,H);f.rn=Object(qa.a)(pg.a,y);f.KJa=a.length;if(this.Ea.lu||!y.Op())f.response=32;return f}kdj(a){const b=new Na.a,c=new Eb.ScriptSharpLegacyMap;let f=0;for(let H=0;H<a.length;++H)if(a[H].Pk){var l=Object(qa.a)(5,a[H].node);if(l&&l.Gs()){f++;var y=l.AL();l=y.rowIndex;for(y=l+y.rowSpan;l<y;l++)if(c.Fb(l)){let Q;c.$(Q=l,c.ga(Q)+1)}else c.add(l,1)}}for(let H of c.keys)c.ga(H)===
f&&b.add(H);return b}idj(a){const b=new Na.a,c=new Eb.ScriptSharpLegacyMap;let f=0;for(let H=0;H<a.length;++H)if(a[H].Pk){var l=Object(qa.a)(5,a[H].node);if(l&&l.Gs()){f++;var y=l.AL();l=y.Ai;for(y=l+y.colSpan;l<y;l++)if(c.Fb(l)){let Q;c.$(Q=l,c.ga(Q)+1)}else c.add(l,1)}}for(let H of c.keys)c.ga(H)===f&&b.add(H);return b}lpj(a){return Qn.a(a)}npj(a){const b=new is;b.response=8;if(!a)return b;if(a.Sl){var c=a.c2a;a=a.nka;if(!c||!a)return b;c=Object(qa.a)(130,c.currentNode);a=Object(qa.a)(130,a.currentNode);
if(!c||!a)return b;var f=c.Ai;a=a.Ai;if(f>a){var l=f;f=a;a=l}}else{c=ge.a.Wtb(a);c=Ch.ContextSetEditor.instance.mB(c);if(!c||1>c.length||!c[0].Pk)return b;c=Object(qa.a)(5,c[0].node);if(!c||!c.Gs())return b;c=c.AL();a=f=c.Ai}l=this.zc.I8b(c);if(!l||14!==l.type||0>f||0>a)return b;const y=[];let H=l.ef(0,f);if(!H)return b;for(;f<=a;)Array.add(y,cb.a.create(Object(qa.a)(pg.a,H))),H=H.D_(),f++;b.RA=y;b.U1a=Object(qa.a)(pg.a,c);b.rn=Object(qa.a)(pg.a,l);b.KJa=y.length;if(this.Ea.lu||!l.Op())b.response=
32;return b}spj(a){const b=new is;b.response=8;if(!a)return b;if(a.Sl){var c=a.c2a;a=a.nka;if(!c||!a)return b;var f=vk.c(c);a=vk.c(a);c=Object(qa.a)(Vl.TableCellNode,c.currentNode);if(f>a){var l=f;f=a;a=l}}else{a=ge.a.Wtb(a);a=Ch.ContextSetEditor.instance.mB(a);if(!a||1>a.length||!a[0].Pk)return b;a=Object(qa.a)(5,a[0].node);if(!a||!a.Gs())return b;c=a.AL();a=f=c.rowIndex}if(!c)throw xa.a.J(512499997,822,10,"TypeCasting to ITableCellNode failed"),Error.argumentNull("TypeCasting to ITableCellNode failed");
l=c.getContainingTable();if(!l||14!==l.type||0>f||0>a)return b;const y=[];let H=l.ef(f,0).LUc();for(;f<=a;)Array.add(y,cb.a.create(Object(qa.a)(pg.a,H))),H=H.EJa,f++;b.RA=y;b.U1a=Object(qa.a)(pg.a,c);b.rn=Object(qa.a)(pg.a,l);b.KJa=y.length;if(this.Ea.lu||!cd.TableReader.wt(b.rn))b.response=32;return b}pyj(a,b){if(a=Object(qa.a)(Vl.TableCellNode,a.currentNode)){if(b)for(b=a.colSpan;0<b--;)a=a.D_();else a=a.L$a();a&&(b=a.getContainingTable().firstRow,a=a.getContainingTable().ef(b.rowIndex,a.Ai),a=
a.mz(),ob.GraphIterator.pb(Object(qa.a)(pg.a,a)))}}wce(a,b,c){const f=new is;f.response=8;if(!a||!c||!c.Pa)return f;const l=[],y=[];c=c.Pa;if(c.Sl){if(c=this.oHb.H8b(c))if(a=c.yub,c=c.tableNode.firstRow,b)for(b=0;b<=a.nre;b++){var H=c.rowIndex;H>=a.V0f&&H<=a.nre&&l.push(c);c=c.EJa}else for(b=c.N0f,c=0;c<=a.fre;c++)H=b.Ai,H>=a.O0f&&H<=a.fre&&y.push(b),b=b.D_()}else for(a=Ch.ContextSetEditor.instance.mB(a),c=0;c<a.length;++c)if(a[c].Pk){H=Object(qa.a)(5,a[c].node);if(!H||!H.Gs())return f;var Q=H.AL();
if(b)for(H=Q.rowSpan,Q=Q.LUc();0<H--;)Array.contains(l,Q)||l.push(Q),Q=Q.EJa;else for(H=Q.colSpan,Q=Q.C5f();0<H--;)Array.contains(y,Q)||y.push(Q),Q=Q.D_()}if(!l.length&&!y.length)return f;b=[];for(a=0;a<l.length;a++)Array.add(b,cb.a.create(Object(qa.a)(pg.a,l[a])));for(a=0;a<y.length;a++)Array.add(b,cb.a.create(Object(qa.a)(pg.a,y[a])));f.RA=b;f.U1a=0<l.length?Object(qa.a)(pg.a,l[0]):Object(qa.a)(pg.a,y[0]);f.rn=0<l.length?Object(qa.a)(pg.a,l[0].getContainingTable()):Object(qa.a)(pg.a,y[0].getContainingTable());
if(this.Ea.lu||!Object(qa.a)(178,f.rn).Op())f.response=32;return f}DSj(a){if(!a.RA)return!1;for(let c=0;c<a.RA.length;c++){var b=Object(qa.a)(cb.a,a.RA[c]);if(b&&(b=Object(qa.a)(155,b.node))){b=this.zc.Aab(b);for(const f of b)if(f&&f.FAb)return!0}}return!1}CSj(a){if(!a.RA)return!1;var b=Object(qa.a)(178,a.rn);if(!b)return!1;var c=Object(qa.a)(cb.a,a.RA[0]);if(!c)return!1;c=Object(qa.a)(130,c.node);if(!c)return!1;c=Object(qa.a)(ob.GraphIterator,this.Rb.Lc(c));c.sc(14);b=this.zc.Gk(b);a=a.RA.length;
const f=new ob.GraphIterator;f.Tc(c);for(let l=0;l<b;l++){for(let y=0;y<a;y++){const H=Object(qa.a)(130,c.currentNode);if(H&&H.FAb)return!0;c.Gf(1)}Sd.moveToNextRow(f);c.Tc(f)}return!1}azb(a){let b=null;a&&14===a.type&&(b=this.zc.Ade(a.firstRow));return b}U4e(a,b,c,f,l){var y=Du.OFa(a);a=Du.OFa(a,!0);if(y||a)y=this.NGa.om(c.fc-c.ic),c=this.NGa.om(c.Zb-c.kc),f._x+=this.NGa.om(l.right),f._y+=this.NGa.om(l.bottom),b.setPosition(f.x-y,f.y-c,!0)}Iqj(){var a=null;const b=this.ta.Ba;var c=this.pa.Ev();if(eb.a("FixColorPickerSelectedColor")){if(!c||
!c.length){if(c=this.pa.un())a=c.ef(0,0),a=Ge.Box4ColorHelper.HEa(a.cellShading.solidFillField,b.Ed);return a}(c=c[0])&&(a=c.cellShading&&c.cellShading.solidFillField?Ge.Box4ColorHelper.HEa(c.cellShading.solidFillField,b.Ed):this.JA.qUc(Object(qa.a)(pg.a,c)))}return a}static D0i(a,b,c,f,l,y){const H=Nc.a.kk("HandleSelectTableBorderType");H.Wa("CommandId",a.toString());H.Wa("BorderType",b);H.Wa("BorderWidth",c);H.Wa("BorderColor",f);H.Wa("CommandLocation",l);try{return y()}finally{H.finish(!0)}}static OFa(a,
b=!1){return a.equals(qe.a.Wu)?!0:b?a.equals(qe.a.north)||a.equals(qe.a.VE):a.equals(qe.a.west)||a.equals(qe.a.dI)}}Object(m.a)(Du,"TableActor",null,[251]);class aw{constructor(){this.marginRight=this.marginLeft=this.marginBottom=this.marginTop=0}}Object(m.a)(aw,"TableCellMargin",null,[]);class bw{constructor(a,b,c,f,l,y,H,Q){this.gJa=null;this.P$c=0;this.RVl=xe.a.Gld(2);this.ORf=Object.assign(new aw,{marginTop:.05,marginBottom:.05,marginLeft:.1,marginRight:.1});this.NRf=Object.assign(new aw,{marginTop:0,
marginBottom:0,marginLeft:0,marginRight:0});this.MRf=Object.assign(new aw,{marginTop:.05,marginBottom:.05,marginLeft:.05,marginRight:.05});this.YRf=Object.assign(new aw,{marginTop:.15,marginBottom:.15,marginLeft:.15,marginRight:.15});this.pMh=Object.assign(new aw,{marginTop:-1,marginBottom:-1,marginLeft:-1,marginRight:-1});if(a)if(b)if(c)if(f)if(l)if(y){if(!H)throw xa.a.J(512499990,822,50,"Table Cell Margin Actor constructor argument:functionThrottlerFactory cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:functionThrottlerFactory cannot be null");
if(!Q)throw xa.a.J(512499989,822,50,"Table Cell Margin Actor constructor argument:pageView cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:pageView cannot be null");}else throw xa.a.J(512499991,822,50,"Table Cell Margin Actor constructor argument:tableReader cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:tableReader cannot be null");else throw xa.a.J(512499992,822,50,"Table Cell Margin Actor constructor argument:selectionManager cannot be null"),
Error.argumentNull("Table Cell Margin Actor constructor argument:selectionManager cannot be null");else throw xa.a.J(512499993,822,50,"Table Cell Margin Actor constructor argument:graphTopologyManager cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:graphTopologyManager cannot be null");else throw xa.a.J(512499994,822,50,"Table Cell Margin Actor constructor argument:transactionFactory cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:transactionFactory cannot be null");
else throw xa.a.J(512499995,822,50,"Table Cell Margin Actor constructor argument:applicationSettings cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:applicationSettings cannot be null");else throw xa.a.J(512499996,822,50,"Table Cell Margin Actor constructor argument:actionManager cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:actionManager cannot be null");this.ia=a;this.Ea=b;this.Eb=c;this.ta=f;this.pa=l;this.zc=y;this.Rfk=H.K0d(50,
Object(I.a)(this,this.F7a,"applyPendingChangesToServerIfRequired"));this.Gb=Q}vb(){this.ia.ra(ea.a.$4e,yb.a.view,Object(I.a)(this,this.y9b,"handleTableCellMargins"),4);this.ia.ra(ea.a.evc,yb.a.tableCell,Object(I.a)(this,this.y9b,"handleTableCellMargins"),4);this.ia.ra(ea.a.Gnd,hc.a.application,Object(I.a)(this,this.tYc,"handleQueryTableCellDefaultMargins"),96);this.ia.ra(ea.a.dvc,yb.a.tableCell,Object(I.a)(this,this.y9b,"handleTableCellMargins"),4);this.ia.ra(ea.a.Fnd,hc.a.application,Object(I.a)(this,
this.tYc,"handleQueryTableCellDefaultMargins"),96);this.ia.ra(ea.a.cvc,yb.a.tableCell,Object(I.a)(this,this.y9b,"handleTableCellMargins"),4);this.ia.ra(ea.a.Dnd,hc.a.application,Object(I.a)(this,this.tYc,"handleQueryTableCellDefaultMargins"),96);this.ia.ra(ea.a.hvc,yb.a.tableCell,Object(I.a)(this,this.y9b,"handleTableCellMargins"),4);this.ia.ra(ea.a.Hnd,hc.a.application,Object(I.a)(this,this.tYc,"handleQueryTableCellDefaultMargins"),96);this.ia.ya(ea.a.evc,yb.a.view,Gc.Fka);this.ia.ya(ea.a.dvc,yb.a.view,
Gc.Fka);this.ia.ya(ea.a.cvc,yb.a.view,Gc.Fka);this.ia.ya(ea.a.hvc,yb.a.view,Gc.Fka);this.ia.ra(ea.a.bvc,yb.a.view,Object(I.a)(this,this.AYc,"handleTableCellCustomMargins"),4);this.ia.ra(ea.a.jqc,yb.a.view,Object(I.a)(this,this.sYc,"handleQueryTableCellCustomMargins"),96);this.ia.ra(ea.a.fvc,yb.a.view,Object(I.a)(this,this.AYc,"handleTableCellCustomMargins"),4);this.ia.ra(ea.a.kqc,yb.a.view,Object(I.a)(this,this.sYc,"handleQueryTableCellCustomMargins"),96);this.ia.ra(ea.a.gvc,yb.a.view,Object(I.a)(this,
this.AYc,"handleTableCellCustomMargins"),4);this.ia.ra(ea.a.lqc,yb.a.view,Object(I.a)(this,this.sYc,"handleQueryTableCellCustomMargins"),96);this.ia.ra(ea.a.avc,yb.a.view,Object(I.a)(this,this.AYc,"handleTableCellCustomMargins"),4);this.ia.ra(ea.a.iqc,yb.a.view,Object(I.a)(this,this.sYc,"handleQueryTableCellCustomMargins"),96)}pe(){}y9b(a,b,c,f,l){return this.pAh(a)?1===c?32:Qg.a("HandleTableCellMargins:Entry point:"+this.ia.eq,a,()=>{if(!l)return xa.a.J(512499987,822,50,"HandleTableCellMargins: actionData cannot be null"),
16;if(!b||!b.node)return xa.a.J(512499986,822,50,"HandleTableCellMargins: Either node context is null or unable to extract Table cell node from context"),16;const y=b.node,H=this.x1i(a);if(!H)return xa.a.J(512499985,822,50,"HandleTableCellMargins: unable to get Table cell margins"),16;const Q=this.Eb.je(15);Q.hc(y);Q.fd=a;this.mCf(y,H);Q.dispose();xa.a.J(512499984,822,50,"HandleTableCellMargins: EntryPoint={1} ActionId={2}",this.ia.eq,a);return 32}):(xa.a.J(512499988,822,50,"HandleTableCellMargins: ShouldExecuteTableEditMarginsAction returned false"),
8)}tYc(a,b,c,f,l){if(!this.Ea.LPb)return 8;b=Object(qa.a)(Vh.a,l);if(!b)return 16;f=this.pa.un();if(!f)return xa.a.J(512499983,822,50,"QueryTableCellDefaultMarginsOptions: unable to get valid tableNode"),16;c=this.pa.Ev();if(!c)return 16;c.length||(c=this.zc.UF(f));if(!c||!c.length)return xa.a.J(512499982,822,50,"QueryTableCellDefaultMarginsOptions: unable to get valid cellNodes"),16;f=!1;switch(a){case ea.a.Gnd:f=this.HUc(c,this.ORf);break;case ea.a.Fnd:f=this.HUc(c,this.NRf);break;case ea.a.Dnd:f=
this.HUc(c,this.MRf);break;case ea.a.Hnd:f=this.HUc(c,this.YRf)}b.Hf(f);return 32}HUc(a,b){for(const c of a)if(c&&!c.isGhostCell&&(xe.a.Zv(c.marginTop)!==b.marginTop||xe.a.Zv(c.marginBottom)!==b.marginBottom||xe.a.Zv(c.marginLeft)!==b.marginLeft||xe.a.Zv(c.marginRight)!==b.marginRight))return!1;return!0}x1i(a){let b=Me.b(this.pMh);switch(a){case ea.a.evc:b=this.ORf;break;case ea.a.dvc:b=this.NRf;break;case ea.a.cvc:b=this.MRf;break;case ea.a.hvc:b=this.YRf}return b}mCf(a,b){0<=b.marginLeft&&(a.marginLeft=
xe.a.ZW(b.marginLeft));0<=b.marginRight&&(a.marginRight=xe.a.ZW(b.marginRight));0<=b.marginTop&&(a.marginTop=xe.a.ZW(b.marginTop));0<=b.marginBottom&&(a.marginBottom=xe.a.ZW(b.marginBottom))}Oji(a,b){b=Math.max(xe.a.ZW(this.RVl+b.marginLeft+b.marginRight),a);ah.a.qz(b,a)||(a={},a.Number=xe.a.Zv(b),this.ia.Ka(ea.a.ULa,2,a))}pAh(a){if(!this.ta.Ba)return!1;const b=this.pa.fo();return!!b&&b.vd&&(this.Ea.LPb&&Array.contains(bw.Odl,a)||this.Ea.Amb&&Array.contains(bw.Zdl,a))}sYc(a,b,c,f,l){if(!this.Ea.Amb)return 8;
b=this.pa.un();if(!b)return xa.a.J(512499981,822,50,"HandleQueryTableCellCustomMargins: unable to get valid tableNode"),16;c=this.pa.Ev();if(!c)return xa.a.J(512499980,822,50,"HandleQueryTableCellCustomMargins: unable to get selected table cells"),16;c.length||(c=this.zc.UF(b));if(!c||!c.length)return xa.a.J(512499979,822,50,"HandleQueryTableCellCustomMargins: unable to get valid cellNodes"),16;b=this.Uqj(c,a);this.Tsc(l,xe.a.Zv(b));xa.a.J(512499978,822,50,"HandleQueryTableCellCustomMargins: EntryPoint={1} ActionId={2}",
this.ia.eq,a);return 32}Uqj(a,b){let c=-1,f=-1;for(const l of a)if(l&&!l.isGhostCell){switch(b){case ea.a.jqc:c=l.marginLeft;break;case ea.a.kqc:c=l.marginRight;break;case ea.a.lqc:c=l.marginTop;break;case ea.a.iqc:c=l.marginBottom}if(0<=f&&f!==c)return-1;f=c}return c}Tsc(a,b){a=a.queryResult;null!==a&&(a.iba=parseFloat(b.toFixed(2)).toString())}AYc(a,b,c,f,l){return this.pAh(a)?1===c?32:Qg.a("HandleTableCellCustomMargins:Entry point:"+this.ia.eq,a,()=>{if(!l)return xa.a.J(512499976,822,50,"HandleTableCellCustomMargins: actionData cannot be null"),
16;const y=this.pa.un();if(!y)return xa.a.J(512499975,822,50,"HandleTableCellCustomMargins: unable to get valid tableNode"),16;let H=this.pa.Ev();if(!H)return xa.a.J(512499974,822,50,"HandleTableCellCustomMargins: unable to get selected table cells"),16;H.length||(H=this.zc.UF(y));this.eCk(a,H,l);xa.a.J(512499973,822,50,"HandleTableCellCustomMargins: EntryPoint={1} ActionId={2}",this.ia.eq,a);return 32}):(xa.a.J(512499977,822,50,"HandleTableCellCustomMargins: ShouldExecuteTableEditMarginsAction returned false"),
8)}eCk(a,b,c){this.P$c!==a&&(this.F7a(),this.P$c=a);this.gJa||(this.gJa=[]);Qg.a("OnCustomMarginChange:Entry point:"+this.ia.eq,a,()=>{for(let l=0;l<b.length;l++){var f=b[l];if(!f||!f||f.isGhostCell)continue;const y=Object(qa.a)(st,f.qc(this.Gb.Na));if(y){this.gJa[l]||(this.gJa[l]=new fx.a(f,this.iuj(f)));f=this.gJa[l];switch(a){case ea.a.bvc:f.second.marginLeft=c.Number;break;case ea.a.fvc:f.second.marginRight=c.Number;break;case ea.a.gvc:f.second.marginTop=c.Number;break;case ea.a.avc:f.second.marginBottom=
c.Number}y.Hjl(f.second,a)}}return 32});this.Rfk.perform()}F7a(){this.Ea.Amb&&this.gJa&&this.gJa.length&&(Qg.a("ApplyPendingChangesToServerIfRequired:Entry point:"+this.ia.eq,this.P$c,()=>{const a=this.Eb.je(15);try{a.fd=this.P$c;let b=null;for(const c of this.gJa)b||(b=c.first.getContainingTable(),a.hc(b)),this.mCf(c.first,c.second),this.Oji(c.first.width,c.second);a.dispose()}finally{a&&a.dispose()}return 32}),this.gJa=null)}iuj(a){const b=Me.b(this.pMh);b.marginLeft=xe.a.Zv(a.marginLeft);b.marginRight=
xe.a.Zv(a.marginRight);b.marginTop=xe.a.Zv(a.marginTop);b.marginBottom=xe.a.Zv(a.marginBottom);return b}}bw.Odl=[ea.a.$4e,ea.a.evc,ea.a.dvc,ea.a.cvc,ea.a.hvc];bw.Zdl=[ea.a.bvc,ea.a.fvc,ea.a.gvc,ea.a.avc];Object(m.a)(bw,"TableCellMarginActor",null,[251]);class Nq{constructor(a,b,c,f,l,y,H,Q){this.Nm=this.ikc=null;this.I_g=0;this.T8c=!1;this.xCe=this.yGe=this.h0g=this.Ayg=this.g0g=this.zyg=null;this.JA=a;this.gl=b;this.Eze=c;this.b1=f;this.GGe=l;this.qrk=y;this.lrk=H;this.pYa=Q}iEl(a,b){const c=new Sys.StringBuilder('<div class="PreviewStyleContainer" aria-hidden="true" style="display:table-cell; text-align:center; vertical-align:middle;">');
this.hie(a,b);try{c.append(String.format('<table class="TableStylePreview" style="background:{0}">',this.gl.Dtb(this.gl.S$d(this.ikc),this.Nm)));for(a=0;5>a;a++){c.append("<tr>");for(b=0;5>b;b++){const f=this.yGe.J9d(a,b,1,1),l=this.k7f(this.xCe,this.Nm,a,b),y=this.gl.Dtb(f.Ua(zb.a.cellShading)?f.Rh(zb.a.cellShading):zl.a.Svb,this.Nm),H=new Sys.StringBuilder;for(let Q=0;Q<Nq.kec.length;Q++){const ia=cq.kUa(Nq.b6c[Q]),wa=f.sa(ia.Y7a,zl.a.qPc),Ua=f.sa(ia.Mtb,zl.a.Qvb);H.append(Nq.kec[Q]);if(wa.PD===
rc.a.auto){const kb=this.gl.D9d(.0277777777777778);H.append(String.format("inset {0}px transparent",kb))}else H.append(this.gl.P8d(Ua,.0277777777777778,wa));H.append(";")}c.append(String.format('<td style="color: {0}; background-color: {1}; {2}">',l,y,H));c.append("<div>&#x2014;</div>");c.append("</td>")}c.append("</tr>")}c.append("</table></div>")}finally{this.T8c&&this.Nrh()}return c.toString()}Rbj(a,b){const c=[];this.hie(a,b);try{for(a=0;5>a;a++)for(b=0;5>b;b++){const f={},l=this.yGe.J9d(a,b,
1,1),y=this.k7f(this.xCe,this.Nm,a,b);f.color=y;const H=this.gl.Dtb(l.Ua(zb.a.cellShading)?l.Rh(zb.a.cellShading):zl.a.Svb,this.Nm);f["background-color"]=H;f.overflow="visible";for(let Q=0;Q<Nq.kec.length;Q++){let ia=null,wa=null,Ua=null;({kRa:ia,Y7a:wa,Mtb:Ua}=cq.kUa(Nq.b6c[Q]));let kb;if(this.pYa){const yc=Ge.Box4ColorHelper.pS({Color:"##T,0,0,0"}),tc=cl.a.ri(l,wa,yc),xd=Ge.Box4ColorHelper.Rga(tc),Vd=Ge.Box4ColorHelper.UH(xd,this.Nm);kb=Vd?Ge.Box4ColorHelper.jha(Vd):null}else kb=l.sa(wa,zl.a.qPc);
const Gb=l.sa(Ua,zl.a.Qvb),ec=Nq.kec[Q].substring(0,Nq.kec[Q].length-1),dc=l.sa(ia,zl.a.Rvb),Fc=this.pYa&&eb.a("TableBordersLocalRenderingFix");if(Fc&&!dc||!Fc&&kb.PD===rc.a.auto){const yc=this.gl.D9d(.0277777777777778);f[ec]=String.format("inset {0}px transparent",yc)}else f[ec]=this.gl.P8d(Gb,.0277777777777778,kb)}c.push(f)}}finally{this.T8c&&this.Nrh()}return c}vXc(a,b){this.hie(a,b);a={};a.background=this.gl.Dtb(this.gl.S$d(this.ikc),this.Nm);return a}hie(a,b){this.ikc=this.b1.C8b(a).hY;this.I_g=
this.JA.dbe(b);this.Nm=this.Eze.jbg(b).Ed;this.T8c=this.YHj(this.ikc);this.zyg=this.Nm.PresetSchemeColorMapping.Background1;this.g0g=this.Nm.PresetSchemeColorMapping.Text1;this.Ayg=this.Nm.PresetSchemeColorMapping.Background2;this.h0g=this.Nm.PresetSchemeColorMapping.Text2;this.T8c&&(this.Nm.PresetSchemeColorMapping.Background1=this.Nm.PresetSchemeColorMapping.Light1,this.Nm.PresetSchemeColorMapping.Text1=this.Nm.PresetSchemeColorMapping.Dark1,this.Nm.PresetSchemeColorMapping.Background2=this.Nm.PresetSchemeColorMapping.Light2,
this.Nm.PresetSchemeColorMapping.Text2=this.Nm.PresetSchemeColorMapping.Dark2);a=this.GGe(()=>5,()=>5,()=>this.I_g,()=>null,()=>this.Nm,()=>this.ikc);this.yGe=this.qrk(a);this.xCe=this.lrk(a)}Nrh(){this.Nm.PresetSchemeColorMapping.Background1=this.zyg;this.Nm.PresetSchemeColorMapping.Text1=this.g0g;this.Nm.PresetSchemeColorMapping.Background2=this.Ayg;this.Nm.PresetSchemeColorMapping.Text2=this.h0g}YHj(a){if(a.tblBgField&&a.tblBgField.fillField)return!1;if(!a.wholeTblField||!a.wholeTblField.tcStyleField)return!0;
a=a.wholeTblField.tcStyleField.fillField;return!a||a.noFillField?!0:!1}k7f(a,b,c,f){let l="black";a&&(l=a.d6f(b,c,f,1,1).yV());return l}}Nq.kec=["border-top:","border-left:","border-bottom:","border-right:"];Nq.b6c=[7,5,0,6];Object(m.a)(Nq,"TableStylePreviewGenerator",null,[374]);class NE extends fy{constructor(){super()}get Type(){return 6}}Object(m.a)(NE,"TableStyleGalleryButtonProps",fy,[]);class OE{}OE.zyk=2147483647;Object(m.a)(OE,"TableStyleUtil",null,[]);class hp{constructor(a,b,c,f,l){this.cZd=
"Clear";this.Z9a=null;this.Yrb=a;this.jhf=c;this.khf=f;this.iZh=l;this.HPd=b;this.cO=w.AFrameworkApplication.cO;this.Cm=w.AFrameworkApplication.Cm}v5b(){}dci(a,b){this.v5b();const c=this.$Tc(),f=c.length;if(!(0>=f)){var l=OE.zyk,y=null;for(let wa=0;wa<f;wa++){var H=c[wa],Q=this.iZh(H);l!==Q&&(l=Object.assign(new Rk.a,{Id:"msMoreTableStyles"+Q,Title:this.uuj(Q),ControlList:[]}),y=Object.assign(new Cq.a,{Type:6,Id:"galleryMoreTableStyles"+Q,ExternalGalleryId:"TableStylesGallery",Width:hp.UFh,ElementDimensions:"Size64by48",
GalleryItems:[]}),w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.ob.Qp&&this.Z9a&&(y.ExternalId=this.Z9a[Q.toString()]),Array.add(l.ControlList,y),Array.add(b.MenuSectionList,l),l=Q);var ia=this.khf(H);H=hp.f5e+wa;Q=!!w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.ob.Qp;ia=Object.assign(new NE,{Id:H,ExternalId:H,Command:"4171428777",QueryCommand:"2135594455",LabelText:ia?ma.a.xe(ia):"",Alt:Q?ia:null,VerticalCenterAlign:"true"});Q&&(ia.TableCellStyles=this.bcg(H,a),ia.TableStyles=this.vXc(H,
a));y&&y.GalleryItems.push(ia)}}}bci(a){const b=Object.assign(new Rk.a,{Id:"msMoreTableStyleCommands",DisplayMode:"Menu16",ControlsId:"ctrlMoreTableStyleCommands",ControlList:[]}),c=Object.assign(new hg.a,{Id:"fseaClearTableFormatting",Command:"3835123874",LabelText:ma.a.xe(this.cZd),Alt:ma.a.xe(this.cZd),Image16by16:this.Cm,Image16by16Class:He.getImageClassWithCluster(this.cO,hp.qBi),KeyTip:CommonUIStrings.l_ClearTableFormattingKeytip});Array.add(b.ControlList,c);Array.add(a.MenuSectionList,b)}nLi(a,
b){this.v5b();const c=a[wh.a.SourceControlId],f=this.Pvd(c,b);if(f){var l=this.Yrb.lde(b);l=l?this.jhf(l):null;var y=this.khf(f),H=this.jhf(f);a[mm.a.Alt]=y;a[mm.a.On]=H===l;w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.ob.Qp?(b=Object.assign(new NE,{Id:c,ExternalId:c,Command:"4171428777",QueryCommand:"2135594455",TableCellStyles:this.bcg(c,b),TableStyles:this.vXc(c,b),Alt:y}),a[mm.a.GalleryButtonProps]=b):(b=this.HPd.iEl(f,b),a[mm.a.InnerHTML]=b)}else a[mm.a.InnerHTML]=null,a[mm.a.Alt]=
null,a[mm.a.On]=!1,a[mm.a.GalleryButtonProps]=null}bcg(a,b){this.v5b();return(a=this.Pvd(a,b))?this.HPd.Rbj(a,b):null}vXc(a,b){this.v5b();return(a=this.Pvd(a,b))?this.HPd.vXc(a,b):null}sMi(a,b){w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.ob.Qp?a.MenuItems=this.o9f(b):a.PopulationXML=sj.l(this.o9f(b))}o9f(a){const b=Object.assign(new On.a,{Id:"menuMoreTableStyles",MenuSectionList:[]});this.dci(a,b);this.bci(b);return b}Pvd(a,b){return a?a.startsWith(hp.f5e)?this.Ftj(parseInt(a.substr(hp.f5e.length))):
this.Gbl(parseInt(a.substr(hp.gEl.length)),b):null}}hp.f5e="buttonTableStyleMenu";hp.gEl="buttonTableStyleRibbon";hp.UFh=7;hp.qBi="ClearTableStyle_16x16x32";Object(m.a)(hp,"ATableStyleRibbonControl",null,[375]);class YN extends hp{constructor(a,b,c,f,l){super(a,l,Object(I.a)(f,f.Dtj,"getStyleIdFromStyleContainer"),Object(I.a)(f,f.Etj,"getStyleNameFromStyleContainer"),Object(I.a)(f,f.wtj,"getStyleCatogeryFromStyleContainer"));this.JA=a;this.b1=f;this.cZd=ResourceStrings.L_ClearTableStyle;this.cO=se.a.eoc;
this.Cm=c.qk(se.a.nld);this.APk()}uuj(a){switch(a){case 1:return ResourceStrings.L_Themed;case 2:return ResourceStrings.L_Light;case 3:return ResourceStrings.L_Medium;case 4:return ResourceStrings.L_Dark;case 5:return ResourceStrings.L_Customize;default:return ResourceStrings.L_Customize}}Gbl(a,b){let c=null;(b=this.JA.J8b(b))&&(c=this.b1.ecg(b.styleIdField));return c?this.b1.ttj(c.ozg,c.jGg-c.jGg%hp.UFh+a):this.b1.Yyb(a)}$Tc(){return this.b1.$Tc()}Ftj(a){return this.b1.Yyb(a)}v5b(){this.b1.q5d()}APk(){this.Z9a=
{};this.Z9a["1"]="TableStylesBestMatch";this.Z9a["2"]="TableStylesLight";this.Z9a["3"]="TableStylesMedium";this.Z9a["4"]="TableStylesDark"}}Object(m.a)(YN,"TableStyleRibbonControls",hp,[]);class ZN{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc){this.BE=this.wZa=null;this.ia=a;this.qf=b;this.Ea=c;this.Fa=f;this.pa=l;this.Ts=y;this.Oc=H;this.Ydc=Q;this.Gb=ia;this.Ga=wa;this.le=Ua;this.Bfa=Gb;this.zc=ec;this.Lfa=dc;this.GZa=yc;this.zA=kb;Fc.execute(xd=>{this.wZa=xd});this.Ea.kQ&&tc.execute(xd=>
{this.BE=xd})}get Gd(){return this.Oc.instance}get KF(){return this.Ydc.value}vb(){this.ia.ra(ea.a.pEf,hc.a.application,Object(I.a)(this,this.Dzj,"handleBeginEditShapeTextByF2"),4);this.ia.ra(ea.a.T7a,hc.a.application,Object(I.a)(this,this.Czj,"handleBeginEditShapeText"),4);this.ia.ra(ea.a.hRa,yb.a.view,Object(I.a)(this,this.Ezj,"handleBeginEditShapeTextForShapeMoniker"),5)}pe(){const a=this.Fa.Fc(jb.a.vg),b=this.Fa.Fc(Oi.a.o3);a.bindAction(x.KeyInputManager.Qa(B.a.Sxc,0),ea.a.pEf);a.bindAction(x.KeyInputManager.Qa(B.a.Dp,
0),ea.a.T7a);b.bindAction(x.KeyInputManager.Qa(B.a.Sxc,0),ea.a.ipi)}Czj(a,b,c){if(this.Lfa&&this.Lfa.isVisible())return xa.a.J(40735957,820,50,"The slideless pane is shown, hide and replace it with new slide on default master by VK_Enter."),this.Lfa.hide(2,!0),32;if(1===c&&this.pa.zVa())return 2;a=this.pa.fo();if(!a)return 16;b=Object(qa.a)(4,a.vhj(eb.a("EnableRetrieveFirstIcon")));if(a.get_smartArtModelId())a=this.Ga.Gr(a);else{if(a.Wf&&b)return this.ia.Ka(ea.a.V1a,c,b);if(a.Of){var f=this.Ga.yx(a);
if(0<f.length)return this.ia.Ka(ea.a.V1a,c,f[0])}else if(this.Ea.kQ&&1===a.mediaType&&!a.Ug&&this.BE)return(f=this.BE.yL(a))&&f.setFocusOnPlayer(),32}return this.ia.Ka(ea.a.hRa,c,new Ro.a(a,!1))}Dzj(a,b,c){a=this.pa.fo();if(!a)return 16;a.get_smartArtModelId()&&(a=this.Ga.Gr(a));return this.ia.Ka(ea.a.hRa,c,new Ro.a(a,!1))}Ezj(a,b,c,f,l){if(!l||!Object(Wa.a)(Ro.a,l))return xa.a.J(8956046,820,10,"Invalid ActionData"),8;a=l.shapeNode;if(!a||!(a.isEditable&&!a.$fa||a.Jq)||this.qf.$c(a))return 16;if(1===
c)return 32;a.vd&&(c=this.zc.ZN(a),c=!!c&&c.Op(),xa.a.J(41007122,820,50,"Entering table edit mode, isComplexTable:{0}",c),this.ia.processAction(ea.a.K8a,2));if(a.Jq){if(this.KF&&this.Gd)return l=this.KF.z3(a),this.Gd.notifyAgave(l.id,11),32;xa.a.J(18989144,820,10,"AppForOffice package should have already been loaded.");return 8}c=a.tg(this.Gb.Na);if(!c)return 16;this.wZa&&this.wZa.S6d(a,!0);this.GZa&&this.Ea.cil&&this.GZa.ping();Nc.a.Kb&&(Nc.a.Kb.actionName="BeginEditShapeText",(a.Of||a.Ug)&&Dn(a));
if(this.zA&&a.Wf&&c.iJ())Nc.a.Ak(hh.a.nIc,"false"),this.le.Lkh(new Mx.a(a));else{this.Fa.vf(jb.a.vg,l.fsl);this.Ts.Aw();c.A2e();if(a.vd&&l.GMc&&(c=this.zc.ZN(a))&&c.Op())return(a=this.Bfa.x7d(l.GMc.clientPoint,c,null,null))?(c=a.qc(this.Gb.Na),this.Gb.Y6(l.GMc.clientPoint,c,a,this.Gb,!1,!1,0),32):8;a.Ug&&(c=this.Ga.Cs(a))&&(c=c.tg(this.Gb.Na))&&c.Rd&&c.Rd.ENb(!0);this.Gb.Fgl(a,l.GMc)}return 32}}Object(m.a)(ZN,"TextEditorLaunchingActor",null,[251]);class PE{constructor(a,b,c,f,l,y,H,Q){this.ia=a;this.Fa=
b;this.Ga=c;this.qr=f;this.qf=l;this.pa=y;this.YXa=H;this.Gh=Q}vb(){this.ia.ya(ea.a.YIf,hc.a.application,Object(I.a)(this,this.Szj,"handleChangeCaseMenu"));this.ia.ya(ea.a.JPe,hc.a.application,Object(I.a)(this,this.HDj,"handlePowerPointInsertHyperlink"));this.ia.ra(ea.a.clearFormatting,hc.a.application,Object(I.a)(this,this.cAj,"handleClearFormatting"),4)}pe(){this.Fa.Fc(jb.a.vQ).bindAction(x.KeyInputManager.Qa(B.a.zK,2),ea.a.clearFormatting)}Szj(){var a=this.pa.Pa.mb;return a&&(a=a.Va)&&(a.contextId===
yb.a.Mf||a.contextId===yb.a.textRange)?32:this.ZPh(!0)?32:8}HDj(a,b,c,f,l){return(a=this.pa.Pa.mb)&&this.pa.fXj()?8:!a||this.pa.kWa()&&!PE.icc(a)?8:this.ia.Ka(ea.a.insertHyperlink,c,l)}cAj(a,b,c){if(!this.ZPh(!1))return 16;a=this.pa.Pa.mb;if(!a)return 8;2===c&&this.ZCa(a);return 32}ZCa(a){xa.a.J(593892321,820,50,"TextOperationsActor: Clear Formatting Triggered");var b=this.pa.Xd();let c;if((c=this.Wrj(b))&&c.length){if(1===c.length){b=a.Va;if(!b){xa.a.J(594614167,820,50,"TextOperationsActor: ClearCharacterFormatting - Could not create GraphNodeContext");
return}if(b.contextId===yb.a.Mf){this.Eli(b,c[0]);return}if(b.contextId===yb.a.textRange||b.contextId===yb.a.paragraph){this.Gli(a,c);return}}this.Fli(c)}else b.length?this.CNc(b)?xa.a.J(593892317,820,50,"ClearFormatting on table(s)"):xa.a.J(593892315,820,50,"ClearFormatting attempted on non table and non text formattable shape"):xa.a.J(593892319,820,50,"ClearFormatting triggered when nothing selected")}Wrj(a){a=this.Ga.K_(a,!1);const b=[];let c=!0;for(const f of a)f.Of&&(c=!1,1!==a.length&&this.Qql(f,
a)?b.push.apply(b,this.Inh(f,a,!1)):b.push.apply(b,this.Inh(f,a,!0)));return c?a:b}Qql(a,b){for(const c of b)if(c&&!c.Of&&(b=c.Cs(),!b||a!==b))return!1;return!0}Inh(a,b,c=!1){const f=[];for(const l of b)if(l!==a)f.push(l);else if(c){const y=this.Ga.K_(this.pa.mP(b),!1);f.push.apply(f,y)}return f}Fli(a){this.qr.U9a(b=>{this.AZe(b,0,this.Orj(b))},a)}Gli(a,b){const c=a.Va,f=this.f8f(c,b[0]);if(c.contextId===yb.a.paragraph||-1!==f){var l=this.Yuj(a);this.qr.U9a(y=>{this.AZe(y,f,l)},b)}}Eli(a,b){const c=
this.YXa.l8b(a);if(c){var f=c.Va,l=this.f8f(a,b)+f.Sa;this.qr.U9a(y=>{this.AZe(y,l,f.Mb-f.Sa)},[b])}}AZe(a,b,c){a.ye(zb.a.clearFormatting,!0);a.ye(zb.a.a6e,b);a.ye(zb.a.$5e,c)}f8f(a,b){let c=0,f=!1;if(!this.Gh.ae(a.node))return-1;const l=a.node;this.Ga.eK(b,y=>{y===l?f=!0:f||(c+=this.Gh.textLength(y)+1)});return f?a.contextId===yb.a.paragraph||a.contextId===yb.a.Mf?c:c+a.Sa:-1}Yuj(a){let b=0;for(let c=0;c<a.length;c++){const f=a.ga(c);f.contextId===yb.a.textRange?b+=f.Mb-f.Sa:f.contextId===yb.a.paragraph?
b+=this.Gh.textLength(f.node)+1:f.contextId===yb.a.endOfParagraph&&b++}return b}Orj(a){let b=0;if(a.DB)return 1;this.Ga.eK(a,c=>{b+=this.Gh.textLength(c)+1});return b}CNc(a){for(const b of a)if(b.vd)return!0;return!1}ZPh(a){const b=this.pa.Xd();if(!b||1>b.length)return!1;const c=this.pa.un();if(c&&!a&&1===b.length)return!1;a=this.Ga.K_(b);return 1>a.length&&!c||this.qf.eD(a)||this.qf.eD([c])?!1:!0}static icc(a){if(1===a.length)return!0;if(2===a.length){const b=a.Va;a=a.ga(1);return!(!Mb.SelectionEditor.tk(b)||
!Mb.SelectionEditor.im(a)||b.node!==a.node)}return!1}}Object(m.a)(PE,"TextOperationsActor",null,[251]);class QE{W2d(a,b,c){return 1===c?32:QE.BSi(b.node)}static BSi(a){const b=new ob.GraphIterator;b.set(a);b.hv();if(ze.b(b))return 2;a=new pf.GraphTransaction(7);a.Sy(b);b.Ni();a.dispose();return 32}}Object(m.a)(QE,"DeleteOutlineLevelContentStrategy",null,[]);class nl{constructor(){this.aXh=new QE}vb(a){const b=Object(I.a)(this.BPc,this.BPc.X2d,"deleteView"),c=Object(I.a)(this,this.W2d,"deleteOutlineLevelContent"),
f=Object(I.a)(this.uSf,this.uSf.CSi,"deleteParagraphContent");a.ya(C.a.backspace,yb.a.Mf,f);a.ya(C.a.backspace,yb.a.textRange,f);a.ya(C.a.backspace,yb.a.endOfParagraph,vf.ActionManager.Bv);a.ya(C.a.backspace,yb.a.outline,c);a.ya(C.a.backspace,yb.a.view,b);a.he(C.a.backspace,1124);a.ya(C.a.MDa,yb.a.Mf,vf.ActionManager.Bv);a.ya(C.a.MDa,yb.a.textRange,f);a.ya(C.a.MDa,yb.a.endOfParagraph,vf.ActionManager.Bv);a.ya(C.a.MDa,yb.a.outline,c);a.ya(C.a.MDa,yb.a.view,b);a.ra(C.a.Gvb,yb.a.view,b,1124);a.ya(C.a.pL,
yb.a.Mf,f);a.ya(C.a.pL,yb.a.textRange,f);a.ya(C.a.pL,yb.a.endOfParagraph,vf.ActionManager.Bv);a.ya(C.a.pL,yb.a.outline,c);a.ya(C.a.pL,yb.a.view,b);a.he(C.a.pL,1124);a.ra(C.a.K3b,yb.a.view,b,1124);a.ra(C.a.LDa,yb.a.view,nl.LDa,1028);a.ya(C.a.uSa,yb.a.view,Object(I.a)(this.BPc,this.BPc.uSa,"deleteFromInputEvent"));a.ya(C.a.uSa,yb.a.textRange,f);a.he(C.a.uSa,1028)}W2d(a,b,c,f,l){return this.aXh.W2d(a,b,c,f,l)}static get lm(){return Gy.PageNavigator.instance}static get Wh(){return nl.Ji||(nl.Ji=Ib.a.instance.resolve("Box4.IOutlineElementEditor"))}static get cK(){return nl.zI||
(nl.zI=Ib.a.instance.resolve("Box4.Pages.IPageContentEditor"))}static get ASi(){return nl.f4a||(nl.f4a=Ib.a.instance.resolve("Box4.Actors.IDeleteOutlineElementNodeStrategy"))}static get aC(){return nl.ay||(nl.ay=Ib.a.instance.resolve("Box4.IOutlineEditor"))}static get Be(){return nl.kd||(nl.kd=Ib.a.instance.qb("Box4.IFeatureHelper"))}static LDa(a,b,c,f,l){f=b.view;if(!f.Nb||!f.Nb.Pa.mb||Mb.SelectionEditor.Dx(f.Nb.Pa.mb))return 8;if(1===c)return 32;c=f.Nb.Pa;const y=c.mb;var H=y.Va;let Q=!1;var ia=
null,wa=!1;if(c.uH)if(ze.a(H))Q=!0;else{if(H.contextId===yb.a.outline&&1===c.length){for(a=ob.GraphIterator.pb(H.node);a.Oi();)a.Ni();nl.aC.nW(a,!0);Za.OutlineElementNavigator.yi(a);a=Od.SelectionFactory.Qg(a.currentNode,0);f.Nb.setSelection(a);return 32}var Ua=H.node;ia=null;if(mu.c(H)){var kb=Ua.qc(f.Na);kb&&(kb=kb.mYl)&&0<=kb.width&&0<=kb.height&&(ia=new ax.a(Fb.a.gf(kb.x,0),Fb.a.gf(kb.y,1)));ia||(ia=yq.b(Ua))}else ia=yq.b(H.node);H=ob.GraphIterator.pb(H.node);H.hv();nl.lm.sLa(H);Ua=nl.cK.p3b(H);
yq.c(Ua,ia.x,ia.y);nl.aC.nW(H,!0);ia=Od.SelectionFactory.Aj(Ua,!0)}else if(1===c.length){wa=c.last;H=ge.a.ZRa(wa);if(nl.Be&&nl.Be.isFeatureEnabled(33)&&Ch.ContextSetEditor.instance.G2e(H).returnValue)return 2;wa=wa.jf;wa=!ze.a(wa)&&!c.Sl&&(Mb.SelectionEditor.im(wa)||Db.ParagraphReader.Fm(wa)||Mb.SelectionEditor.dX(wa))}wa&&(wa=Mb.SelectionEditor.fm(y,!1,!1,void 0,nl.ASi.d1e(null,1)),f.Nb.setSelection(wa),w.AFrameworkApplication.Ra.ei(b,C.a.XB,2,!1,null,l),ia=f.Nb.Pa.mb,f.Nb.setSelection(y));l||(l=
new J.DictionaryPropertySet);l.setValue(ee.a.jwb,!0);w.AFrameworkApplication.Ra.ei(b,C.a.pL,2,!0,null,l);if(ia&&ia.Va.isValid)return f.Nb.setSelection(ia),32;c.uH&&(Q||qo.instance.uCb(a,b.UE,f));Mb.SelectionEditor.Dx(f.Nb.Pa.mb)||w.AFrameworkApplication.Ra.ei(b,C.a.XB,2,!1,null,l);return 32}}nl.zI=null;nl.Ji=null;nl.f4a=null;nl.ay=null;nl.kd=null;Object(m.a)(nl,"ADeleteActor",null,[]);class Yk{get fj(){return bh.a.instance}CSi(a,b,c,f,l){if(1===c)return 32;f=a===C.a.backspace||a===C.a.uSa;if(Yk.lr()&&
Yk.lr().instance&&Yk.lr().instance.fX(b))return 4;c=b.node;var y=b.Sa;b=b.Mb;const H=Db.ParagraphReader.text(c),Q=H.length;let ia=!1;if(y===b){if(f&&!y||!f&&y===Q)return 2;f?(N.a.instance.ga(14)&&({cp:y,returnValue:ia}=this.fj.Twk(c,y)),ia||(y--,ma.a.Gx(H,y)&&y--),a=C.a.NCa):(N.a.instance.ga(14)&&({cp:b,returnValue:ia}=this.fj.Swk(c,b)),ia||(b++,ma.a.Gx(H,b)&&b++),a=C.a.tSa)}y=y===b?cb.a.Lj(c,y):cb.a.createTextRange(c,y,b);f=new pf.GraphTransaction(15);f.fd=a;f.ld(c);c=Object(Wa.a)(et,l)&&l.I6b;if(Yk.Xf.ig&&
Yk.Xf.jz&&!c){c=Yk.Xf.Htb();try{let wa;if(({type:wa}=null.Ucg()).returnValue){const Ua=Object(qa.a)(10,l);if(Ua&&Ua.sa(dt.a.qng,!1)||1===wa)Yk.Xf.ifh=wa}l=0;for(let Ua=null.length-1;0<=Ua;--Ua){let kb;const Gb=({Usg:kb}=null.getContext(Ua)).returnValue;kb?(Yk.hyperlinkEditor.AIb(Gb,null),l+=0,Yk.W6.k0d=b+l):this.vSf(Gb)}}finally{c&&c.dispose()}}else this.vSf(y);f.dispose();return 32}static get Xf(){return Yk.hd||(Yk.hd=Ib.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get W6(){return Yk.hp||
(Yk.hp=Ib.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get owc(){return Yk.cE||(Yk.cE=Ib.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get hyperlinkEditor(){return Yk.In||(Yk.In=Ib.a.instance.resolve("Box4.IHyperlinkEditor"))}static lr(){return Yk.Sm||(Yk.Sm=Ib.a.instance.Ia("Box4.IExternalSelectionManager"))}}Yk.hd=null;Yk.hp=null;Yk.cE=null;Yk.In=null;Yk.Sm=null;Object(m.a)(Yk,"ADeleteParagraphContentStrategy",null,[]);class cw extends Yk{constructor(){super()}vSf(a){cw.characterPropertiesEditor.replaceTextRange(a,
"")}static get characterPropertiesEditor(){return cw.fth||(cw.fth=Ib.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}}cw.fth=null;Object(m.a)(cw,"DeleteParagraphContentStrategy",Yk,[]);var fS=d(479);class $N{constructor(a,b,c,f){this.v$e=a;this.kK=c;this.zd=f;this.actionId=b}}Object(m.a)($N,"DeleteActionData",null,[]);class tf{get QBi(){return tf.Xcf||(tf.Xcf=Ib.a.instance.resolve("Box4.Clipboard.IClipboardOperationCutStrategy"))}tHl(a){return!Mb.SelectionEditor.tk(a)}erj(a,b,c){if(!a)return null;
if(!c)return a;b=Mb.SelectionEditor.nTa(a,!1,!b,!0,!0,!0);return Od.SelectionFactory.WN(a,b.Va,!1)}X2d(a,b,c,f,l){if(1===c)return 32;var y=!1;a===C.a.K3b&&(a=C.a.pL,y=!0);a===C.a.Gvb&&(a=C.a.backspace,y=!0);a===C.a.MDa&&(b=new oC.a(Rc.App.Lb.Kd.Mn));var H=b;if(!H.view.Sh)return 2;var Q=H.view.Nb;Xh.GrippersManager.instance.setVisibility(!1);H=a===C.a.pL;Q=0<Q.Pa.length?Q.Pa.ga(0):null;y=this.erj(Q,H,y);return this.DSf(a,b,c,f,l,y,H)}DSf(a,b,c,f,l,y,H){const Q=b.view,ia=Q.Nb;var wa=l,Ua=l;a===C.a.MDa&&
(Ua=wa=null,y=new Lb.Selection(l,!0));if(!y)return 32;const kb=new $N(b,a,f,Ua),Gb=this.Krl(wa,H,ia);wa=!1;if(({FVa:wa}=this.NAh(a,Gb,ia)).returnValue)return a=wa?C.a.KDa:C.a.deleteRow,w.AFrameworkApplication.Ra.ei(b,a,c,!1,f,l);let ec;H?pb.a.mark(ec=5009):pb.a.mark(ec=5011);c=new pf.GraphTransaction(15);c.fd=a;c.ld(Q.Ag);wa=null;let dc=({ifl:wa}=this.Fdj(a,l,ia,y)).returnValue;Ua=null;({yud:Ua}=Ch.ContextSetEditor.instance.G2e(dc)).returnValue&&(dc=Ua);if(!dc)return c.dispose(),32;this.pJh(dc);const Fc=
this.U$i(y,H);let yc=null;H?yc=new qr(y):Fc&&(yc=new qr(Fc));Ua=!1;if(Mb.SelectionEditor.Xg(dc)){if(a===C.a.uSa)return 2;const tc=Qh.oWc(Q.Ag,Gb);tf.pT.tG(()=>{this.tSi(b,f,l,dc,H,yc,y,tc,ia,Gb,kb,Fc)},"DeleteViewStrategy:DeleteAtInsertionPointContext")}else tf.Xf.ig&&tf.Xf.jz?(this.sHl(a,Q.Ag,dc,H,y,ia,Gb,kb,yc),Ua=!0):Ua=this.tfh(a,Q.Ag,dc,ia,Gb,kb,yc,wa);tf.Z5i(ia);this.lrh(dc);c.dispose();pb.a.mark(ec+1);return a===C.a.MDa?Ua?32:8:32}uSa(a,b,c,f,l){return b.view.Sh?this.DSf(a,b,c,f,null,l,!1):
2}tfh(a,b,c,f,l,y,H,Q){b=Qh.oWc(b,l);this.tHl(c)&&b.Qpa(c);a=tf.Xc.Zp(a);a.properties.$("CountOfParagraphsDeleted",tf.h6.i0d(c).toString());c=tf.ZUi(tf.Orl,Object(I.a)(this,this.Nrl,"shouldDispatchNoSpecialize"),c,f,l,b,y,H,Q);a.end();return c}sHl(a,b,c,f,l,y,H,Q,ia){var wa=0,Ua=null;const kb=Ch.ContextSetEditor.instance.mB(c),Gb=kb[kb.length-1];if(Gb.contextId===yb.a.paragraph||Gb.contextId===yb.a.endOfParagraph){var ec=ob.GraphIterator.pb(Gb.node);ec.kf();Za.OutlineElementNavigator.Te(ec);Za.OutlineElementNavigator.ZJ(ec,
!0,!1)&&(Ua=Za.OutlineElementNavigator.yi(ec))&&(wa=tf.h6.textLength(Ua))}else wa=tf.h6.textLength(Gb.node)-Gb.Mb;if((ec=Object(qa.a)(10,Q.zd))&&ec.sa(dt.a.qng,!1))this.sfh(a,b,c,y,H,Q,ia,!1);else{ec=tf.Xf.Htb();try{this.sfh(a,b,c,y,H,Q,ia,!0)}finally{ec&&ec.dispose()}}if(f){if(c.Bx){a=kb.length-1;do l=kb[a],a--;while(!l.node.isConnected&&0<=a)}else l=c;if(!tf.h6.ae(l.node))return;switch(Gb.contextId){case yb.a.paragraph:case yb.a.endOfParagraph:wa=Ua&&Ua.isConnected?0:wa;break;case yb.a.Mf:case yb.a.textRange:break;
default:wa=0}wa=Od.SelectionFactory.Qg(l.node,tf.h6.textLength(l.node)-wa);l.wQa===wa.Va.Sa&&(wa.Va.kT=l.kT)}else{wa=l.Va.node;if(!tf.h6.ae(wa))return;Ua=l.Va.contextId===yb.a.paragraph?0:l.Va.contextId===yb.a.endOfParagraph?tf.h6.textLength(wa):l.Va.Sa;wa=Od.SelectionFactory.Qg(wa,Ua)}ge.a.instance.setSelection(wa)}sfh(a,b,c,f,l,y,H,Q){this.e9i(f,c);!({type:ia}=null.Ucg()).returnValue||Q&&1!==ia||(tf.Xf.ifh=ia);for(c=null.length-1;0<=c;--c){var ia=({Usg:Q}=null.getContext(c)).returnValue;Q?tf.hyperlinkEditor.AIb(ia,
2):this.tfh(a,b,ia,f,l,y,H,null)}}e9i(a,b){if(Object(Wa.a)(fS.a,b))for(a=vi.Kta(a.Pa,!0),b=0;b<a.length&&a.getContext(b).contextId!==yb.a.table;b++);}Fdj(a,b,c,f){a===C.a.MDa?(c=ub.a.cSa(b),a=rn.SelectionReferenceFactory.instance.Nsa()):(a=null,c=1===c.Pa.length?ge.a.ZRa(f):c.Yj);return{returnValue:c,ifl:a}}Owi(a){return!a.Pk||a.contextId!==yb.a.paragraph||!tf.h6.ae(a.node)||tf.Xf.ig&&tf.Xf.jz||N.a.instance.ga(14)&&tf.fj.f2c(a)?!1:!0}pJh(a){if(a.Bx)for(let b=0;b<a.length;b++)this.pJh(a.getContext(b));
else this.Owi(a)&&(a.node.LLc=!0)}lrh(a){if(a.Bx)for(let b=0;b<a.length;b++)this.lrh(a.getContext(b));else a.Pk&&(a=a.node)&&tf.h6.ae(a)&&(a.LLc=!1)}tSi(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb){const Gb=new ob.GraphIterator,ec=f.node;Gb.set(ec);Gb.kf();Mb.SelectionEditor.fD(Gb.currentNode,f,l)?this.xSi(a,b,c,f,l,y,H,Q,ia,Ua,kb,Gb,ec):tf.ySi(f,l,y,H,Q,ia,wa,Ua)}oYc(a,b,c,f){return!a&&Zb.ListReader.Hk(b)?(f=tf.Roa(b,c),{returnValue:!0,response:f}):{returnValue:!1,response:f}}HBj(a,b,c,f,l,y){return N.a.instance.ga(65)&&
!a&&0<Wd.OutlineElementReader.hyb(b)?(y=w.AFrameworkApplication.Ra.ei(c,C.a.Fnh,2,!1,f,l),{returnValue:!0,response:y}):{returnValue:!1,response:y}}CGj(a,b,c,f,l,y){return N.a.instance.ga(54)&&!a&&0<Wd.OutlineElementReader.$$a(b)?(y=w.AFrameworkApplication.Ra.ei(c,C.a.a6k,2,!1,f,l),{returnValue:!0,response:y}):{returnValue:!1,response:y}}PDj(a,b,c,f,l,y){return N.a.instance.ga(80)&&!a&&tf.Jv.rub(b)?(y=w.AFrameworkApplication.Ra.ei(c,C.a.My,2,!1,f,l),{returnValue:!0,response:y}):{returnValue:!1,response:y}}Vyj(a,
b,c,f,l,y,H,Q,ia,wa,Ua){const kb=new Cn.a;kb.Tc(b);if(Za.OutlineElementNavigator.CJa(kb,!1,!a,!1)){Ua=!0;wa=32;const Gb=new ob.GraphIterator;Gb.Tc(kb);Za.OutlineElementNavigator.yi(kb);y&&f&&Mb.SelectionEditor.dX(f.Va)?(c.Qpa(l),tf.Wh.F5k(b.currentNode)):kb.currentNode.cX?(N.a.instance.ga(68)&&c.Qpa(l),Za.OutlineElementNavigator.Te(kb),kb.Ni()):N.a.instance.ga(66)&&a&&y?tf.fj.wqg(Q)&&!({oza:Ua}=this.nih(a,Q,kb.currentNode,f,Ua)).returnValue&&(c.Qpa(l),tf.jq.Roa(b),b.Ni()):cd.TableReader.iq(kb)?(c.Qpa(l),
this.CSf&&({response:wa,returnValue:Ua}=this.CSf.eXl(a,Gb,b,kb,H,ia,wa))):tf.h6.ae(kb.currentNode)&&(({oza:Ua}=this.nih(a,Q,kb.currentNode,f,Ua)).returnValue||this.wSf&&this.wSf.uSi(a,c,l,b,Q,kb));return{returnValue:!0,response:wa,oza:Ua}}return{returnValue:!1,response:wa,oza:Ua}}nih(a,b,c,f,l){return tf.Xf.ig&&tf.Xf.jz&&(a=(a?b:c).Ta.last,b=w.AFrameworkApplication.userName,!a.Qo||a.Qo.authorName!==b)?(f&&(ge.a.instance.setSelection(f),l=!1),{returnValue:!0,oza:l}):{returnValue:!1,oza:l}}$Fj(a,b,
c,f,l,y,H,Q){return N.a.instance.ga(67)&&Wd.OutlineElementReader.mog(b,a)?(ae.isInTableCell(b)&&(Sd.returnToContainingCell(b),ae.isEmpty(b)&&c.Qpa(f),{Psl:a,returnValue:Q}=tf.Dwk(b,H,a,l,y),a||(Q=2)),{returnValue:!0,response:Q}):{returnValue:!1,response:Q}}dCj(a,b,c,f,l,y,H,Q){Wd.OutlineElementReader.mog(b,a)||({response:H,oza:Q}=tf.LVi(c,f,a,y,l,H,Q));return{returnValue:!1,response:H,oza:Q}}xSi(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb){let ec=!1,dc=2;const Fc=tf.h6.isEmpty(kb),yc=kb.currentNode;Za.OutlineElementNavigator.Te(kb);
({response:dc}=this.oYc(l,kb,wa,dc)).returnValue||({response:dc}=this.HBj(l,kb,a,b,c,dc)).returnValue||({response:dc}=this.CGj(l,kb,a,b,c,dc)).returnValue||({response:dc}=this.PDj(l,kb,a,b,c,dc)).returnValue||({response:dc,oza:ec}=this.Vyj(l,kb,Q,Ua,f,Fc,yc,Gb,ia,dc,ec)).returnValue||({response:dc}=this.$Fj(l,kb,Q,f,ia,wa,yc,dc)).returnValue||({response:dc,oza:ec}=this.dCj(l,kb,b,c,Q,H,dc,ec));tf.W5g(Q,32===dc);ec&&tf.bV(ia,y)}Krl(a,b,c){return a&&a.Ua(ee.a.jwb)?this.QBi.jAh()||a.eb(ee.a.jwb)?!a.sa(ee.a.jwb,
!1):this.f6f(!1,c):this.f6f(b,c)}NAh(){return{returnValue:!1,FVa:!1}}static get characterPropertiesEditor(){return tf.mh||(tf.mh=Ib.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Uf(){return tf.fh||(tf.fh=Ib.a.instance.resolve("Box4.List.IListReader"))}static get h6(){return tf.Cr||(tf.Cr=Ib.a.instance.resolve("Box4.IParagraphReader"))}static get hyperlinkEditor(){return tf.In||(tf.In=Ib.a.instance.resolve("Box4.IHyperlinkEditor"))}static get jq(){return tf.fp||(tf.fp=Ib.a.instance.resolve("Box4.List.IListEditor"))}static get Wh(){return tf.mpf||
(tf.mpf=Ib.a.instance.resolve("Box4.IOutlineElementEditor"))}static get hI(){return $h.a.instance}static get Jv(){return uv.a.Byb}static get Xf(){return tf.hd||(tf.hd=Ib.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get W6(){return tf.hp||(tf.hp=Ib.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get owc(){return tf.cE||(tf.cE=Ib.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get Xc(){return mc.a.instance}static get fj(){return bh.a.instance}static get hu(){return tf.XD||
(tf.XD=Ib.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get pT(){return Mf.a.instance}static Z5i(a){if(1===a.Pa.length&&(a=a.Pa.ga(0),Mb.SelectionEditor.Dx(a))){var b=a.Va;a=b.node;b=b.Sa;var c=tf.h6.text(a);b<c.length&&0<b&&" "===c.charAt(b-1)&&" "===c.charAt(b)&&tf.characterPropertiesEditor.replaceTextRange(cb.a.createTextRange(a,b-1,b),"\u00a0")}}static Moi(a,b){if(!b.hyperlink.WAb){const c=new pf.GraphTransaction(15);try{c.ld(a.node),tf.hu.YM(a,b)}finally{c&&c.dispose()}}}static Roa(a,
b){a=tf.Uf.Gv(a).$1c?C.a.zP:C.a.iN;return w.AFrameworkApplication.Ra.ei(b.v$e,a,2,!1,b.kK,b.zd)}static LVi(a,b,c,f,l,y,H){if(c=Mb.SelectionEditor.nTa(f,!1,!c,!1,!1,!0)){f=Od.SelectionFactory.WN(f,c.Va);y=32;for(c=0;c<f.length;++c){l.Qpa(f.ga(c));const Q=w.AFrameworkApplication.Ra.ei(f.ga(c),C.a.pL,2,!0,a,b);2!==Q&&(y=Q)}32===y&&(H=!0)}return{response:y,oza:H}}static ZUi(a,b,c,f,l,y,H,Q,ia){let wa=!1;a(c)?(wa=tf.N3d(c,!0,f,l,y,H))&&tf.fNa(Q,f,ia):b(c)?(wa=tf.N3d(c,!1,f,l,y,H))&&tf.fNa(Q,f,ia):(y.normalize(),
tf.fNa(Q,f,ia));return wa}static fNa(a,b,c){c&&c.bV()||tf.bV(b,a)}static N3d(a,b,c,f,l,y){f||gj.OutlineReader.Kla(a)||(c=tf.WKl(c))&&l.Jol(c);a=32===w.AFrameworkApplication.Ra.ei(a,y.actionId,2,b,y.kK,y.zd);tf.W5g(l,a);return a}static W5g(a,b){b?a.normalize():a.cancel()}static bV(a,b){b&&(b=b.restore())&&a.setSelection(b)}static ySi(a,b,c,f,l,y,H,Q){let ia;!b&&({m$b:ia}=tf.hu.tcb(a)).returnValue?(c=new qr(f),tf.Moi(a,ia),l.normalize(),tf.bV(y,c)):tf.N3d(a,!1,y,H,l,Q)&&(b&&tf.Xf.ig&&tf.Xf.jz?(b=tf.W6.k0d)?
(y.setSelection(Od.SelectionFactory.Qg(a.node,b)),tf.W6.k0d=null):tf.bV(y,c):tf.bV(y,c))}static Dwk(a,b,c,f,l){let y,H=2;y=!0;if(ae.isEmpty(a)){const Q=Sd.getContainingTable(a),ia=cd.TableReader.Gk(Q),wa=cd.TableReader.Gi(Q);1===ia&&1===wa?(H=w.AFrameworkApplication.Ra.ei(cb.a.create(Q),C.a.I8a,2,!1,l.kK,l.zd),f.setSelection(Od.SelectionFactory.Qg(b,0)),y=!1):1===ia?H=w.AFrameworkApplication.Ra.ei(l.v$e,C.a.KDa,2,!1,l.kK,l.zd):(b=ae.isEmptyIncludingTheRestOfTheRow(a),ae.isFirstCellInRow(a)&&b?H=w.AFrameworkApplication.Ra.ei(l.v$e,
C.a.deleteRow,2,!1,l.kK,l.zd):!c&&b&&(H=32,a=Mb.SelectionEditor.Cta(f.Pa.mb,!1,!1,!1,!0),f.setSelection(a),y=!1))}return{returnValue:H,Psl:y}}static Orl(a){return a.Bx||gj.OutlineReader.Kla(a)||tf.h6.Fm(a)}static WKl(a){return(a=vi.Kta(a.Pa,!0))&&1===a.length&&(a=a.getContext(0).node,cd.TableReader.Ocb(a))?a:null}}tf.fh=null;tf.mh=null;tf.mpf=null;tf.Cr=null;tf.In=null;tf.fp=null;tf.hd=null;tf.hp=null;tf.cE=null;tf.Xcf=null;tf.XD=null;Object(m.a)(tf,"ADeleteViewStrategy",null,[]);class Eu{constructor(a,
b){this.Rb=a;this.Gh=b}uSi(a,b,c,f,l,y){l=this.Rb.Lc(l);a&&!this.Gh.isEmpty(l)?(Za.OutlineElementNavigator.Te(y),b.rJh(y.currentNode),Eu.Wh.merge(f,y,!1,!1)):(Za.OutlineElementNavigator.Te(y),b.Qpa(c),Eu.Wh.merge(y,f,!1,!1))}static get Wh(){return Eu.Ji||(Eu.Ji=Ib.a.instance.resolve("Box4.IOutlineElementEditor"))}}Eu.Ji=null;Object(m.a)(Eu,"DeleteParagraphNodeStrategy",null,[1201]);class aO extends tf{constructor(a,b,c,f){super();this.ggk=new Eu(c,f);this.la=a;this.NNg=b;this.Rb=c}get CSf(){throw Error.notImplemented();
}get wSf(){return this.ggk}U$i(a,b){return Mb.SelectionEditor.nTa(a,!0,!b,!1,!1,!0)}Nrl(a){return Mb.SelectionEditor.tk(a)}f6f(a,b){if(!this.la.iqe||!this.la.XBb||!this.la.jqe||a)return!1;a=this.suj(b);return 1===(a&1)&&2!==(a&2)}suj(a){var b=a.Pa;if(!b.length)return 0;a=Object(qa.a)(5,b.ga(0).Va.node);if(!a||!a.Gs())return 0;a=(a=(a=a.AL())?a.Kcg():null)?a.getContainingTable():null;if(!a)return 0;const c=[];for(var f=0;f<b.length;++f){var l=b.ga(f);if(l){var y=vi.vVc(l,!0),H=vi.vVc(l,!1);if(y&&H){if(Mb.SelectionEditor.ju(y)&&
!Mb.SelectionEditor.PAb(y)||!Db.ParagraphReader.zne(y.node)||y!==H&&Mb.SelectionEditor.ju(H)&&!Mb.SelectionEditor.PAb(H)||!Db.ParagraphReader.YYj(H.node))return 0;if(l=Object(qa.a)(ub.a,Ch.ContextSetEditor.instance.N6b(ub.a.cSa(l.toArray()),16,!1)))for(y=0;y<l.length;++y)H=Object(qa.a)(Vl.TableCellNode,l.getContext(y).node),a.Op()&&H.isControllingCell?this.vRj(H,c):H.isGhostCell||Array.add(c,H)}}}if(!c.length)return 0;b=a.dV;f=a.v3;y=l=0;H=Array(b);const Q=Array(f);for(var ia=0;ia<b;++ia)H[ia]=0;
for(ia=0;ia<f;++ia)Q[ia]=0;for(ia=0;ia<c.length;++ia){const wa=c[ia].Kcg();++H[wa.rowIndex]===f&&++l;++Q[wa.Ai]===b&&++y}if(0<l&&0<y){if(l===b&&y===f)return 3}else if(l||y){if(0<l){if(!a.Op())for(a=0;a<f;++a)if(Q[a]!==l)return 0;return 1}if(0<y){if(!a.Op())for(a=0;a<b;++a)if(H[a]!==y)return 0;return 1}}return 0}vRj(a,b){ae.foreachMergedCells(Object(qa.a)(pg.a,a),c=>{Array.add(b,c)})}oYc(a,b,c,f){if(!a&&Zb.ListReader.Hk(b)){var l=this.Rb.YTa();l.Tc(b);if((l=Object(qa.a)(4,l.Kg(10)))&&l.Wf){if(this.NNg.rub(b))this.NNg.pjb(b,
-1,0),f=32;else if(b.WF(1)){if(b.Gf(1),({response:f}=super.oYc(a,b,c,f)).returnValue)return{returnValue:!1,response:f}}else f=32;return{returnValue:!0,response:f}}return super.oYc(a,b,c,f)}return{returnValue:!1,response:f}}NAh(a,b,c){if(!(b&&a===C.a.backspace&&c.Pa&&c.Pa.length&&c.Pa.Sl))return{returnValue:!1,FVa:!1};b=c.un();if(!b||!b.Op())return{returnValue:!1,FVa:!1};a=b.dV;b=b.v3;let f=a,l=0,y=b,H=0;c=Ch.ContextSetEditor.instance.mB(c.Yj);for(let wa=0;wa<c.length;wa++){if(!c[wa].Pk)return a=!1,
{returnValue:!1,FVa:a};var Q=Object(qa.a)(5,c[wa].node);if(!Q||!Q.Gs())return a=!1,{returnValue:!1,FVa:a};var ia=(Q=Q.AL())?Q.mz():null;if(!ia)return a=!1,{returnValue:!1,FVa:a};Q=ia.rowIndex;const Ua=ia.Ai,kb=ia.rowSpan;ia=ia.colSpan;f=Math.min(f,Q);l=Math.max(l,Q+kb-1);y=Math.min(y,Ua);H=Math.max(H,Ua+ia-1)}return l-f+1!==a&&H-y+1!==b?{returnValue:!1,FVa:!1}:{returnValue:!0,FVa:l-f+1===a?!0:!1}}}Object(m.a)(aO,"DeleteViewStrategy",tf,[]);class bO extends nl{constructor(a,b,c,f){super();this.hgk=
new aO(a,b,c,f);this.fgk=new cw}get BPc(){return this.hgk}get uSf(){return this.fgk}}Object(m.a)(bO,"Box4DeleteActor",nl,[]);class cO{constructor(a,b,c,f,l){this.ia=a;this.egk=new bO(b,c,f,l);sa.InteractiveViewManager.instance.editingView.f4b=!0}vb(){this.egk.vb(this.ia)}pe(){var a=C.a.backspace;const b=v.FocusManager.instance().Fc(M.AppFrame.KW);b.bindAction(x.KeyInputManager.Qa(B.a.iI,0),a);b.bindAction(x.KeyInputManager.Qa(B.a.iI,4),C.a.backspace);b.bindAction(x.KeyInputManager.Qa(B.a.iI,4|x.KeyInputManager.Re),
G.a.ve);b.bindAction(x.KeyInputManager.Qa(B.a.iI,x.KeyInputManager.Re),C.a.Gvb);b.bindAction(x.KeyInputManager.Qa(B.a.$pa,0),C.a.pL);b.bindAction(x.KeyInputManager.Qa(B.a.$pa,x.KeyInputManager.Re),C.a.K3b);z.a.Ik&&(b.bindAction(x.KeyInputManager.Qa(B.a.iI,3),C.a.backspace),b.bindAction(x.KeyInputManager.Qa(B.a.iI,7),C.a.backspace),b.bindAction(x.KeyInputManager.Qa(B.a.iI,5),C.a.backspace),b.bindAction(x.KeyInputManager.Qa(B.a.iI,1),C.a.Gvb))}}Object(m.a)(cO,"DeleteActor",null,[251]);class dO{constructor(a){this.Yek=
a}vb(){this.Yek.vb()}pe(){}}Object(m.a)(dO,"EnterActor",null,[251]);class fq{constructor(a,b,c){this.kv=a;this.CZb=b;this.Sm=c}get Vn(){return this.CZb.value}P_i(a,b,c,f,l){var y;if(!({Nf:c,selected:y,GF:ia}=this.RAh(b,c,!1)).returnValue)return ia;pb.a.mark(5013);var H=fq.ym.mB(y);for(var Q=0;Q<H.length;++Q){if(!H[Q].isValid)continue;let wa=H[Q].iterator;wa.hv();if(gj.OutlineReader.ku(wa))return this.ZXf(c,wa);if(ze.b(wa))return qo.instance.uCb(a,y,c),this.Vn.Aw(),pb.a.mark(5014),32}H=this.Fgj(y);
if(y.Bx||Mb.SelectionEditor.tk(y)||Db.ParagraphReader.Fm(y)&&!Mb.SelectionEditor.dX(y)){if(fq.Be&&fq.Be.isFeatureEnabled(33)&&Ch.ContextSetEditor.instance.G2e(y).returnValue)return 8;var ia=this.$Xf(b,c,a,f,l,H)}else if(Mb.SelectionEditor.im(y))ia=this.YXf(b,c,a,f,l,H);else if(Mb.SelectionEditor.Xg(y)){ia=new ob.GraphIterator;ia.set(y.node);ia.sc(10);if(this.Bxk()&&(Q=wb.HyperlinkReader.WC(y,!1),0<Q.length)){if(!Q[0].hyperlink)return ka.ULS.sendTraceTag(38835461,324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",
Q[0].Sa,Q[0].Mb),8;Rc.App.C6b(Q[0].hyperlink.url);return 32}ae.isInTableCell(ia)&&!N.a.instance.ga(77)&&(Sd.returnToContainingCell(ia),N.a.instance.ga(30)&&ae.isLastCellInTable(ia)&&!gj.OutlineReader.IYc(ia)&&gj.OutlineReader.fD(ia,y,!0)&&(xg.OutlineNavigator.saa(ia),Zb.ListReader.Hk(ia)||(H=C.a.Hua),Sd.returnToCell(ia)),ae.isFirstCellInRow(ia)&&(Q=new ob.GraphIterator,Q.Tc(ia),Sd.returnToContainingRow(Q),N.a.instance.ga(30)&&vk.j(Q)&&vk.e(Q)&&1<cd.TableReader.Gk(Sd.getContainingTable(Q))?H=C.a.deleteRow:
gj.OutlineReader.fD(ia,y,!1)&&(vk.g(Q)&&0>=y.kT?(H=C.a.R$b,Sd.returnToContainingTable(ia),Za.OutlineElementNavigator.Te(ia),l||(l=new J.DictionaryPropertySet),l.ye(ee.a.targetObject,ia.currentNode.id)):N.a.instance.ga(30)&&(H=C.a.qVa))));ia=this.bYf(b,c,a,f,l,H)}else Mb.SelectionEditor.dX(y)&&(ia=w.AFrameworkApplication.Ra.ei(b,C.a.XB,2,!1,f,l));pb.a.mark(5014);return ia}RAh(a,b,c){let f,l;l=f=null;if(1===b)return{returnValue:!1,Nf:f,selected:l,GF:32};if(!a.view.Sh)return{returnValue:!1,Nf:f,selected:l,
GF:2};f=a.view;l=f.Nb.Yj;return!l||N.a.instance.ga(14)&&!fq.fj.Ong(l,c)?{returnValue:!1,Nf:f,selected:l,GF:2}:this.Sm&&this.Sm.instance&&this.Sm.instance.fX(l)?{returnValue:!1,Nf:f,selected:l,GF:4}:{returnValue:!0,Nf:f,selected:l,GF:2}}lrl(a,b,c,f,l){let y,H;if(!({Nf:c,selected:y,GF:H}=this.RAh(b,c,!0)).returnValue)return H;const Q=fq.ym.mB(y);for(let ia=0;ia<Q.length;++ia){if(!Q[ia].isValid)continue;const wa=Q[ia].iterator;wa.hv();if(gj.OutlineReader.ku(wa))return this.ZXf(c,wa)}y.Bx||Mb.SelectionEditor.tk(y)?
H=this.$Xf(b,c,a,f,l,C.a.P$b):Mb.SelectionEditor.im(y)?H=this.YXf(b,c,a,f,l,C.a.P$b):Mb.SelectionEditor.Xg(y)?H=this.bYf(b,c,a,f,l,C.a.P$b):Mb.SelectionEditor.dX(y)&&(H=w.AFrameworkApplication.Ra.ei(b,C.a.XB,2,!1,f,l));return H}ZXf(a,b){a.Nb.setSelection(Od.SelectionFactory.Aj(b.currentNode,!1));return 32}$Xf(a,b,c,f,l,y){const H=new pf.GraphTransaction(15);H.fd=c;H.ld(b.Ag);b=new J.DictionaryPropertySet;b.setValue(ee.a.jwb,!0);b=w.AFrameworkApplication.Ra.ei(a,C.a.pL,2,!0,f,b);32===b&&(b=w.AFrameworkApplication.Ra.ei(a,
y,2,!1,f,l));H.dispose();return b}YXf(a,b,c,f,l,y){const H=new pf.GraphTransaction(15);H.fd=c;H.ld(b.Ag);b.Nb.setSelection(Mb.SelectionEditor.fm(b.Nb.Pa.ga(0),!1,!1));a=w.AFrameworkApplication.Ra.ei(a,y,2,!1,f,l);H.dispose();return a}bYf(a,b,c,f,l,y){const H=new pf.GraphTransaction(15,c);H.fd=c;H.ld(b.Ag);a=w.AFrameworkApplication.Ra.ei(a,y,2,!1,f,l);H.dispose();return a}static get ym(){return Ch.ContextSetEditor.instance}static get fj(){return bh.a.instance}static get Be(){return fq.kd||(fq.kd=Ib.a.instance.qb("Box4.IFeatureHelper"))}}
fq.kd=null;Object(m.a)(fq,"AEnterViewStrategy",null,[1172]);class xt extends fq{constructor(a,b,c){super(a,b,c)}Fgj(a){let b=C.a.XB;if(a&&(a=fq.ym.mB(a))&&0<a.length){const c=new ob.GraphIterator;c.set(a[0].node);c.sc(10);(a=c.g3a())&&a.Ua(zb.a.Qj)&&(a=a.eb(zb.a.Qj),0===a||2===a)&&(b=C.a.P$b)}return b}Bxk(){return xt.nV?!1:!0}static get nV(){null==xt.BI&&(xt.BI=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("SplitHyperlinkFixWithEnterIsEnabled"):!1);return xt.BI}}xt.BI=null;Object(m.a)(xt,
"EnterViewStrategy",fq,[]);class RE{constructor(a){this.Dhk=a}msd(a,b){this.Dhk.jV(a,b)}}Object(m.a)(RE,"PPTFontNameFormattingStrategy",null,[1164]);class eO{jAh(){return!1}}Object(m.a)(eO,"PptClipboardOperationCutStrategy",null,[356]);class fO{constructor(a,b){this.yM=a;this.pa=b}k0j(a){return 10===a.Bi||16===a.Bi||60===a.Bi}Nwi(a){if(this.yM.vcb(a)&&this.yM.SAb(a))return!1;let b=a=null;this.pa.Pa.mb&&(b=this.pa.Pa.mb.Va,a=this.pa.Pa.mb.jf);return this.Lqe(b)&&this.Lqe(a)}Lqe(a){if(a){if(a.contextId===
yb.a.paragraph)return!0;if(a.contextId===yb.a.endOfParagraph&&(a=a.node))return ma.a.Xa(a.characterData)}return!1}Esl(a,b){return this.d1e(a,b)}d1e(a,b){let c=null;this.pa.Pa.mb&&(c=this.pa.Pa.mb.Va);return this.Lqe(c)?!!a&&this.yM.SAb(a)||1===b:!1}}Object(m.a)(fO,"PptDeleteOutlineElementNodeStrategy",null,[354]);class gO{constructor(a,b,c){this.Sq=a;this.SJ=b;this.kb=c}wYf(a){if(this.kb.Pa&&this.kb.Pa.Sl){const f=this.Sq.M4f(this.kb.Pa).returnValue;if(!f.eTa()&&a.Bx){a=new ub.a;var b=this.kb.Ev();
for(const l of b)if(b=Object(qa.a)(Vl.TableCellNode,l)){var c=ob.GraphIterator.pb(b);if(c.kf()){const y=vk.c(c);c=this.SJ.AUc(Object(qa.a)(130,c.currentNode));f.U1i(y,c)&&a.$ia(ge.a.ZRa(Od.SelectionFactory.nl(b)))}}}}return a}}Object(m.a)(gO,"PptDeleteTableSegmentStrategy",null,[357]);class hO{hGh(){return!1}eqg(a){return!!a&&!a.Am.equals(ha.a.nil)}}Object(m.a)(hO,"PptEopFormattingStrategy",null,[352]);class iO{constructor(a,b,c){this.M$c=!1;this.Ga=a;this.IJ=b;this.pa=c}rLh(a,b){a&&b&&(b.beforeSpacing&&
(a.setValue(zb.a.Gea,b.beforeSpacing.value),a.setValue(zb.a.ama,b.beforeSpacing.unit)),b.afterSpacing&&(a.setValue(zb.a.Fea,b.afterSpacing.value),a.setValue(zb.a.$la,b.afterSpacing.unit)),b.lineSpacing&&(a.setValue(zb.a.Jx,b.lineSpacing.value),a.setValue(zb.a.qX,b.lineSpacing.unit)));return!0}gAh(){return!1}UAh(){return!1}cAh(){return!this.M$c}OAh(a,b){return a===yb.a.paragraph||a===yb.a.endOfParagraph||b}dAh(a,b,c){this.pa.Pa&&this.pa.Pa.mb&&(c=!this.pa.Pa.mb.gda);return a!==yb.a.textRange&&(b===
yb.a.paragraph||c)}kAf(a,b,c){this.M$c=!1;if(a.Gs()&&this.pa.Pa.mb){var f=this.pa.Pa.mb.Va;this.pa.Pa&&this.pa.Pa.Sl&&this.pa.Pa.ga(0)&&(f=this.pa.Pa.ga(0).Va);if(f=tb.a.Bs(Db.ParagraphReader.ae(f.node)?f:Od.SelectionFactory.nl(a).Va))if(f=f.cache)!c.Ua(zb.a.latinFont)&&f.Ua(zb.a.latinFont)&&c.setValue(zb.a.latinFont,f.wL),!c.Ua(ab.a.fontColor)&&f.k4&&c.setValue(ab.a.fontColor,f.fontColor),!c.Ua(ab.a.fontSize)&&f.sua&&c.setValue(ab.a.fontSize,f.fontSize),!c.Ua(ab.a.bold)&&f.PUa&&c.setValue(ab.a.bold,
f.isBold)}if(b){if(f=a.BQ(this.IJ)){b.hU||a.sa(zb.a.Bme,!1)||f.sa(zb.a.Bme,!1)||(this.M$c=!0);const l=b.spacing;l&&(!l.beforeSpacing||l.beforeSpacing.value||f.Ua(zb.a.Gea)||(l.beforeSpacing=null),!l.afterSpacing||l.afterSpacing.value||f.Ua(zb.a.Fea)||(l.afterSpacing=null),l.lineSpacing&&2===l.lineSpacing.unit&&1===l.lineSpacing.value&&!f.Ua(zb.a.Jx)&&(l.lineSpacing=null))}this.M$c||(b.hU||(b.hU=pe.a.NN(16,0)),b.hU.B2f=!0)}if((f=a.Pag())&&!f.taa&&(c.Ua(ab.a.fontSize)&&(f=this.Ga.JEa(this.Ga.vn(a)),
c.setValue(ab.a.fontSize,c.eb(ab.a.fontSize)*f)),b&&b.spacing&&b.spacing.lineSpacing&&2===b.spacing.lineSpacing.unit)){let l;(l=b.spacing.lineSpacing).value=l.value-this.Ga.Uxb(this.Ga.vn(a))}c.sa(ab.a.xt,!1)&&c.setValue(ab.a.xt,!1);c.sa(ab.a.X_,!1)&&c.setValue(ab.a.X_,!1)}}Object(m.a)(iO,"PptFormatPainterStrategy",null,[355]);class hA{constructor(a,b,c,f,l,y,H){this.ia=a;this.Fa=f;this.pa=b;this.ME=c;this.Vu=l;this.Gz=y;this.WYa=!H.yg;this.FBe=H.Uqg}vb(){this.ia.ra(G.a.cJh,ie.a.frame,Object(I.a)(this,
this.PRk,"pptToggleRibbonUXHandler"),128);this.ia.ya(G.a.mqh,ie.a.frame,vf.ActionManager.Sg);this.ia.ya(G.a.lqh,ie.a.frame,vf.ActionManager.Sg)}pe(){}PRk(a,b){if(b.contextId!==ie.a.frame)return 2;this.pa.nh();this.Fa.Bd();this.Vu.show(!0,a);this.FBe?(xa.a.J(33859651,340,50,"User is switching to the Classic Ribbon from Single Line Ribbon"),w.AFrameworkApplication.Ra.processAction(G.a.mqh,2)):(xa.a.J(33859653,340,50,"User is switching to the Single Line Ribbon from Classic Ribbon"),w.AFrameworkApplication.Ra.processAction(G.a.lqh,
2));w.AFrameworkApplication.fv&&w.AFrameworkApplication.fv.P8();this.Gz.b0&&2===this.Gz.GD?hA.Qth(this.ia,this.FBe,mx.a.M_a):this.ME.U3(!1,this.WYa,()=>{hA.Qth(this.ia,this.FBe,mx.a.M_a)},null);return 32}static Qth(a,b,c){pi.a.oK(c,(!b).toString(),pi.a.XJ);a.processAction(ea.a.refresh,2)}}Object(m.a)(hA,"ToggleRibbonUXActor",null,[251]);class jO extends Sys.EventArgs{constructor(a,b,c){super();this.actionId=a;this.y8e=b;this.Tcb=c}}Object(m.a)(jO,"UndoRedoEventArgs",Sys.EventArgs,[]);class kO{constructor(a,
b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec){this.ia=a;this.qf=b;this.pa=c;this.Fa=f;this.Ts=l;this.g$c=y;this.tnk=H;this.pWg=Q;this.LE=ia;this.bhb=wa;this.yJ=Ua;this.iik=kb;this.le=ec}vb(){this.ia.ra(ea.a.S_a,hc.a.application,Object(I.a)(this,this.dgg,"handleUndoRedo"),4);this.ia.ra(ea.a.R_a,hc.a.application,Object(I.a)(this,this.dgg,"handleUndoRedo"),4)}pe(){const a=this.Fa.Fc(jb.a.Xi);a.OKc(x.KeyInputManager.Qa(B.a.Unb,x.KeyInputManager.Re),ea.a.S_a,()=>!0);a.bindAction(x.KeyInputManager.Qa(B.a.ayc,x.KeyInputManager.Re),
ea.a.R_a)}dgg(a,b,c,f,l){b=!0;a===ea.a.R_a&&(b=!1);if(this.qf.$c(this.pWg)||!this.vrl(b,l))return 16;if(!this.wrl())return this.Ts.fpa(),16;if(1===c)return 32;if(c=!this.Ts.hVj(b))this.pa.kj(),this.Qal();f=this.Ts.UUc(b);(l=this.yJ.t6(f))&&Nc.a.Ak("UndoRedoActionName",l);this.bhb.Ohd(!c);this.le.VZk(new jO(a,f,b));(f=this.Ts.o$d(b))&&f.H6!==ha.a.nil&&Nc.a.Ak("UndoRedoRevision",Nc.a.sab(f.H6.toString()).toString());this.iik.Ohd(f,l,b);if(b?!this.Ts.undo():!this.Ts.redo())return ka.ULS.sendTraceTag(512499928,
801,10,"User perform {0} failed!!",a===ea.a.undo?"undo":"redo"),8;c&&this.qf.rw(this.pWg,a);return 32}vrl(a,b){a&&!this.Ts.XW&&b&&ka.ULS.sendTraceTag(512499927,801,50,"User pressed ctrl+z, but no undo entry left. Is in box4? {0}",this.Ts.ncb());return(a?this.Ts.XW:this.Ts.hla)&&!(this.Fa.Ee&&this.Fa.Ee.name===jb.a.bUd)&&this.xrl()}wrl(){return this.g$c||!this.jYj()}jYj(){return!this.tnk.EEa&&!!this.LE.instance&&this.LE.instance.j1j()}xrl(){return!this.kYj()}kYj(){const a=this.pa.fo();return a?a.Lv:
!1}Qal(){const a=this.Fa.Ee;!a||a.name!==jb.a.vg&&a.name!==jb.a.eoa||this.Fa.Bd()}}Object(m.a)(kO,"UndoRedoActor",null,[251]);class lO{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye,Xd,Xf,ug,qg,Fg,qf,bg,Kg,rg,ui,Ik,vg,Lg){this.tHa=this.Awa=this.Ncd=null;this.zFb=0;this.yFg=this.FAe=!1;if(ec.Un&&!Lg)throw Error.argumentNull("sorterViewActorLazy");this.ME=y;this.ia=a;this.pDb=b;this.Fa=c;this.Dg=f;this.pa=l;this.qf=H;this.ke=Q;this.Tb=ia;this.ta=wa;this.Sb=Ua;this.Wkc=kb;this.Jb=
Gb;this.la=ec;this.Vu=dc;this.Ya=Fc;this.Gz=yc;this.De=tc;this.lZa=xd;this.WNg=Vd;this.Rv=Ld;this.wb=ye;this.Su=Xd;this.L$c=Xf;this.ZHg=ec.Kog;this.Ic=ug;this.Rdb=qg;this.Xo=Fg;this.Hc=qf;this.Ub=bg;this.Gb=Kg;this.YO=rg;this.Vb=ui;this.vD=Ik;this.Jw=vg;this.Gna=Lg;this.Vyi()}vb(){this.ia.ra(ea.a.PKb,hc.a.application,Object(I.a)(this,this.PKb,"queryEdit"),96);this.ia.ra(ea.a.rLb,hc.a.application,Object(I.a)(this,this.rLb,"querySorterView"),96);this.ia.ra(ea.a.qLb,hc.a.application,Object(I.a)(this,
this.qLb,"querySlideInformation"),96);this.ia.ya(ea.a.lod,hc.a.application,Object(I.a)(this,this.ZCl,"switchToReadingMode"));this.ia.ya(ea.a.ePb,hc.a.application,Object(I.a)(this,this.dBl,"startSlideShowFromBegnning"));this.ia.ya(ea.a.yKb,hc.a.application,Object(I.a)(this,this.yKb,"present"));this.ia.ya(ea.a.jjb,hc.a.application,Object(I.a)(this,this.jjb,"presentDropDown"));this.ia.ya(ea.a.loc,hc.a.application,Object(I.a)(this,this.loc,"playFromBeginningTopBar"));this.ia.ya(ea.a.Aza,hc.a.application,
Object(I.a)(this,this.Aza,"startSlideShowFromCurrentSlide"));this.ia.ya(ea.a.mxb,hc.a.application,Object(I.a)(this,this.mxb,"forceClose"));this.ia.ya(ea.a.wga,hc.a.application,Object(I.a)(this,this.wga,"rehearsePresentation"));this.ia.ya(ea.a.Oqc,hc.a.application,Object(I.a)(this,this.Oqc,"rehearsePresentationTopBar"));this.la.pptEditorRehearsalSpeechClientEnabled&&(this.ia.ya(ea.a.iRc,hc.a.application,Object(I.a)(this,this.iRc,"enableSubtitlesKeyboardShortcut")),this.ia.ya(ea.a.hRc,hc.a.application,
Object(I.a)(this,this.hRc,"enableLivePresenterKeyboardShortcut")));this.Fci();this.ia.ya(ea.a.bMa,hc.a.application,Object(I.a)(this,this.bMa,"showEditTriPaneView"));this.Jb.ka("PPTSorterViewEnabled")&&(this.FAe=this.Jb.ka("FeedbackPaneExperienceIsEnabled")&&this.Jb.ka("HelpTabIsEnabled"),this.ia.ya(ea.a.f2b,hc.a.application,Object(I.a)(this,this.f2b,"closeEditTriPaneView")));this.la.s1c&&this.lZa.bNj(w.AFrameworkApplication.buildVersion,this.Ya.Ek,w.AFrameworkApplication.userSessionId,this.Hc)}pe(){if(this.Jb.ka("SlideShowByShortcutEnabled")){const a=
this.Fa.Fc(D.AFrame.Xi);D.AFrame.Bk(a,x.KeyInputManager.Qa(B.a.Uxc,x.KeyInputManager.Re|4),ea.a.Aza);D.AFrame.Bk(a,x.KeyInputManager.Qa(B.a.Uxc,x.KeyInputManager.Re),ea.a.ePb)}}Fci(){this.ia.ya(ea.a.P_a,hc.a.application,Object(I.a)(this,this.P_a,"presentLive"));this.ia.ya(ea.a.dpc,hc.a.application,Object(I.a)(this,this.dpc,"presentLiveTopBar"));this.ia.ya(ea.a.Q_a,hc.a.application,Object(I.a)(this,this.Q_a,"presentLiveSetAccessControlAnyone"));this.ia.ya(ea.a.cpc,hc.a.application,Object(I.a)(this,
this.cpc,"presentLiveSetAccessControlOrganization"));this.ia.ra(ea.a.gLb,hc.a.application,Object(I.a)(this,this.gLb,"queryPresentLiveAccessControlAnyone"),96);this.ia.ra(ea.a.hLb,hc.a.application,Object(I.a)(this,this.hLb,"queryPresentLiveAccessControlOrganization"),96);Ib.a.instance.Ia("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(a=>{a.Z3("L_PublicLivePresentations",!0).then(b=>{b||(xa.a.J(512499926,822,15,"Public Live Presentations is disabled by publiclivepresentations policy"),
this.ia.iK(ea.a.Q_a,yb.a.application,Object(I.a)(this,this.Q_a,"presentLiveSetAccessControlAnyone")),Rc.App.Lb.X2a(ea.a.Q_a,Object(I.a)(new Kp,(new Kp).IEa,"getCommandById")));return null},b=>{xa.a.J(512499925,822,10,"Could not get publiclivepresentations policy {0}",b);return null})})}qLb(a,b,c,f,l){a=(a=this.ta.Ba)?a.ue+1:0;a=(b=this.Sb.Cj())?String.format(ResourceStrings.l_SlideMenuButtonLabel,a,b):ResourceStrings.l_Slide;l[Mp.a.Value]=a;l[nm.a.labelText]=a;return 32}PKb(a,b,c,f,l){this.Gb&&0!==
this.Gb.ol?l.Hf(!1):l.Hf(!0);return 32}rLb(a,b,c,f,l){(a=Object(qa.a)(Vh.a,l))&&(1!==this.Gb.ol?a.Hf(!1):a.Hf(!0));return 32}bMa(a,b,c){try{if(1===c)return 32;2===c&&0!==this.Gb.ol&&(xa.a.J(512499924,822,50,"ViewSwitchingActor: ShowEditTriPaneView."),this.Gb.ol=0,this.Vb&&(this.Vb.slidePane.hl(),this.la.Un||this.Vb.thumbnailPane.hl(),this.Vb.notesPane.hl(),this.vD&&this.vD.setVisibility(!0)),this.ia.processAction(ea.a.Lkb,2),this.ia.processAction(ea.a.Wub,2),this.YO.dS("PptEditingStatusBar.Notes",
!0),this.YO.dS("PptEditingStatusBar.ZoomScale",!0),this.YO.dS("PptEditingStatusBar.FitToWindow",!0),this.FAe?this.YO.dS("PptEditingStatusBar.GiveFeedbackPane",!0):this.YO.dS("PptEditingStatusBar.GiveFeedback",!0),this.Ic.Py(new dq.a(2)),this.Ic.Py(new dq.a(1)),this.la.Un||this.Dg.DI(jb.a.lF),this.Dg.DI(jb.a.eoa),this.Dg.DI(jb.a.vg),this.Dg.DI(jb.a.vQ))}catch(f){xa.a.J(512499923,822,10,"ViewSwitchingActor - Expcetion in ShowEditTriPaneView: {0}.",f)}return 32}f2b(a,b,c){try{if(1===c)return 32;2===
c&&(this.Vb&&(this.Vb.slidePane.Iq(),this.Vb.thumbnailPane.Iq(),this.Vb.notesPane.Iq(),this.vD&&this.vD.setVisibility(!1)),this.YO.dS("PptEditingStatusBar.Notes",!1),this.YO.dS("PptEditingStatusBar.ZoomScale",!1),this.YO.dS("PptEditingStatusBar.FitToWindow",!1),this.FAe?this.YO.dS("PptEditingStatusBar.GiveFeedbackPane",!1):this.YO.dS("PptEditingStatusBar.GiveFeedback",!1),this.Ic.Py(new dq.a(2)),this.Ic.Py(new dq.a(1)),this.la.Un||this.Dg.Eo(jb.a.lF),this.Dg.Eo(jb.a.eoa),this.Dg.Eo(jb.a.vg),this.Dg.Eo(jb.a.vQ),
this.pa.nh())}catch(f){xa.a.J(512499922,822,10,"ViewSwitchingActor - Exception in CloseEditTriPaneView: {0}.",f)}return 32}ZCl(a,b,c){if(this.qf.$c(this.Tb.Ef))return 16;if(1===c)return this.ta.Ba?32:16;b=(new Date).getTime();let f=yg.a.Ti(window.document.URL,Dh.a.leh,Dh.a.readingView,!0);if(!this.ta.Ba)throw Error.argumentNull("ActiveSlide is null");c=this.ta.Ba.Db;f=yg.a.Ti(f,Dh.a.Vnc,c?c.sid.toString():"",!0);f=this.pDb.instance&&this.pDb.instance.isVisible?yg.a.Ti(f,Dh.a.keh,"1",!0):yg.a.removeParameter(f,
Dh.a.keh,!0);this.Uyi();f=yg.a.Ti(f,w.AFrameworkApplication.ugd,b.toString(),!0);this.pa.nh();this.Fa.Bd();this.Vu.show(!0,a);this.ME.U3(!1,!0,()=>{this.VEh(f)},()=>{xa.a.J(512499921,818,10,"SwitchingToReadingMode: ForceSave triggered failed.");this.VEh(f);return!0});return 32}VEh(a){this.Wkc.openWindow(1,a,!1)||this.Vu.hide()}yKb(a,b,c){return this.gmb(a,c,null)}jjb(a,b,c){return this.gmb(a,c,null)}loc(a,b,c){return this.gmb(a,c,null)}dBl(a,b,c){return this.gmb(a,c,null)}Aza(a,b,c){return this.gmb(a,
c,this.ta.Ba?this.ta.Ba.Db:null)}gmb(a,b,c,f=!1,l=!1){if(!this.la.s1c)return this.LAl(a,b,c);if(this.qf.$c(this.Tb.Ef)||!this.Sb.Cj()||this.la.preventDuplicateSlideShowLaunches&&this.lZa.mcc()||this.la.allowDisablingSlideShowButtonDueToRehydration&&this.lZa.yge)return 16;if(1===b)return 32;this.la.Eng&&!eb.a("DummyChangeGateForTest")&&xa.a.J(512499920,830,100,"StartSlideShow::DummyChangeGateForTest is disabled");this.Jw.hasDeferredContent()&&xa.a.J(512499919,830,100,"StartSlideShow attemped with deferred content");
this.cBl(c,f,l);return 32}cBl(a,b,c){this.zFb=(new Date).getTime();this.pa.nh();this.Fa.vf(jb.a.gE);this.Ic.Okh();xa.a.J(512499918,830,15,"ViewSwitchActor.StartSlideShowFrom Should HideSlideShowButton: {0}",this.lZa.yge);const f=a?a.sid:-1;a=(a=a?Object(qa.a)(117,this.Sb.eFa(a.sid)):null)?a.ue+1:-1;let l=!1;this.Xo.instance?l=this.Xo.instance.z_?!0:!1:xa.a.J(512499917,818,15,"StartSlideShowFrom: m_podSeamlessFailoverManager is null.");this.lZa.Sud(f,a,b,this.Jb.Ha("361"),this.Ya.Ek,this.Ya.podSessionId,
this.Jb.Ha("387"),w.AFrameworkApplication.userSessionId,this.la.h1j,this.zFb,l,this.Ya,c);this.lZa.ija(Object(I.a)(this,this.yid,"onExitSlideshowHandler"));this.Gz.gyl()}Oqc(a,b,c,f){return this.wga(a,b,c,f,{entryPoint:4})}wga(a,b,c,f,l){switch(c){case 2:if(!this.ta.Ba)throw Error.argumentNull("ActiveSlide is null");this.la.pptEditorRehearsalSpeechClientEnabled&&(b=0,l&&(b=l&&"entryPoint"in l?l.entryPoint:1),this.ia.Ka(ea.a.Guc,2,b),this.Hc&&(this.Hc.mEa=!1),this.Ub&&this.Ub.instance&&(this.Ub.instance.mEa=
!1));return this.lZa.mcc()?(this.Hc&&(this.Hc.Qh=!1),32):this.gmb(a,c,this.ta.Ba.Db,!0);case 1:if(0<this.Sb.Cj())if(this.la.pptEditorRehearsalSpeechClientEnabled){if(32===this.ia.processAction(ea.a.hMa,1)&&32===this.ia.processAction(ea.a.Guc,1))return 32;break}else return this.ia.processAction(ea.a.hMa,1);else break;default:xa.a.J(512499916,822,10,"RehearsePresentation: Unimplemented action behavior")}return 8}iRc(a,b,c){switch(c){case 2:if(this.la.pptEditorRehearsalSpeechClientEnabled&&this.Hc)return this.Hc.mEa=
!0,32;break;case 1:return this.la.pptEditorRehearsalSpeechClientEnabled?32:8;default:xa.a.J(512499915,822,10,"EnableSubtitlesKeyboardShortcut: Unimplemented action behavior")}return 8}hRc(a,b,c){switch(c){case 2:if(this.la.pptEditorRehearsalSpeechClientEnabled&&this.Ub&&this.Ub.instance)return this.Ub.instance.mEa=!0,32;break;case 1:return this.la.pptEditorRehearsalSpeechClientEnabled?32:8;default:xa.a.J(512499914,822,10,"EnableLivePresenterKeyboardShortcut: Unimplemented action behavior")}return 8}dpc(a,
b,c,f,l){return this.P_a(a,b,c,f,l)}P_a(a,b,c){if(this.yFg){try{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLive",!0))}catch(f){xa.a.J(512499913,833,10,"ViewSwitchingActor::PresentLive unhandled exception: {0}",f)}return 8}if(1===c)return this.Ub&&this.Ub.instance&&this.Ub.instance.Er&&this.Ub.instance.b$a?0<this.Sb.Cj()?32:8:8;this.Ub&&this.Ub.instance&&this.Ub.instance.Er&&(this.Ub.instance.lEa=!0);if(!this.ta.Ba)throw Error.argumentNull("ActiveSlide is null");return this.gmb(a,
c,this.ta.Ba.Db,!1,!0)}Q_a(a,b,c){if(1===c)return this.Ub&&this.Ub.instance&&this.Ub.instance.Er&&this.Ub.instance.b$a?32:8;this.Ub.instance.kr&&0!==this.Ub.instance.accessControl?this.Ub.instance.showEndSessionDialog(()=>{this.Ub.instance.p5b(5);this.Ub.instance.accessControl=0;this.Ic.Py(new dq.a(1))},()=>{}):(this.Ub.instance.accessControl=0,this.Ic.Py(new dq.a(1)));return 32}cpc(a,b,c){if(1===c)return this.Ub&&this.Ub.instance&&this.Ub.instance.Er&&this.Ub.instance.b$a&&this.Ub.instance.LZf?32:
8;this.Ub.instance.kr&&1!==this.Ub.instance.accessControl?this.Ub.instance.showEndSessionDialog(()=>{this.Ub.instance.p5b(5);this.Ub.instance.accessControl=1;this.Ic.Py(new dq.a(1))},()=>{}):(this.Ub.instance.accessControl=1,this.Ic.Py(new dq.a(1)));return 32}gLb(a,b,c,f,l){try{const y=Object(qa.a)(Vh.a,l);y&&this.Ub.instance&&y.Hf(0===this.Ub.instance.accessControl)}catch(y){xa.a.J(512499912,833,10,"ViewSwitchingActor::QueryPresentLiveAccessControlAnyone unhandled exception: {0}",y)}return 32}hLb(a,
b,c,f,l){try{const y=Object(qa.a)(Vh.a,l);y&&this.Ub.instance&&y.Hf(1===this.Ub.instance.accessControl)}catch(y){xa.a.J(512499911,833,10,"ViewSwitchingActor::QueryPresentLiveAccessControlOrganization unhandled exception: {0}",y)}return 32}LAl(a,b,c){if(this.qf.$c(this.Tb.Ef))return 16;if(1===b)return this.Sb.Cj()?32:16;this.zFb=(new Date).getTime();this.pa.nh();this.Fa.vf(jb.a.gE);this.Ic.Okh();this.Vu.show(!0,a);this.ME.U3(!1,!0,()=>{this.Pth(c,this.zFb)},()=>{xa.a.J(512499910,818,10,"StartSlideShowFrom: ForceSave triggered failed.");
this.Pth(c,this.zFb);return!0});return 32}yid(a,b){a=((new Date).getTime()-this.zFb).toString();xa.a.J(512499909,830,15,"ViewSwitchingActor.OnExitSlideshowHandler: Exit slideshow. Duration: {0}. HasDeferredContentInFile: {1}, HasDeferredContentOnSlide: {2}",a,this.Jw.hasDeferredContent(),b.slideId?this.Jw.Kfe(b.slideId.toString()):"Missing slideId");this.Jw.hasDeferredContent()||b.slideId&&this.Jw.Kfe(b.slideId.toString())?this.Jw.Xra("DeferredExitSlideshowDuration",a):this.Jw.Xra("ExitSlideshowDuration",
a);this.lZa.yga(Object(I.a)(this,this.yid,"onExitSlideshowHandler"));(this.Awa=b)&&!this.Awa.mTj&&!this.Awa.mXj&&0<this.Awa.slideId&&0<=this.Awa.slideIndex&&this.qxk(this.Awa.slideId,this.Awa.slideIndex);this.Fa.Bd();this.ZHg?(this.tHa=Nc.a.kk("ExitSlideshow"),this.qf.blockContent(this.Tb.Ef,"ExitSlideshow"),this.WNg.fk(Object(I.a)(this,this.S$g,"onPageManifestNodePropertyChanged")),this.tHa.Wa("UnlockPodsSessionStartTime",Nc.a.uf(new Date)),this.unlockPodsSession(c=>{this.tHa&&(this.tHa.Wa("UnlockPodsSessionWithMerge",
c.toString()),this.tHa.Wa("UnlockPodsSessionEndTime",Nc.a.uf(new Date)));c?this.Rv.F7i():this.bXe()})):this.bXe()}bXe(a=null){a&&(this.Ncd=null);this.Awa&&(this.ZHg&&(this.WNg.Om(Object(I.a)(this,this.S$g,"onPageManifestNodePropertyChanged")),this.qf.xK(this.Tb.Ef),this.tHa&&(this.tHa.Wa("InboundPresentationEndTime",Nc.a.uf(new Date)),this.tHa.finish(),this.tHa=null)),this.Awa=null,this.Gz.zcl())}unlockPodsSession(a){const b=Hg.a.create().toString();xa.a.J(512499907,830,50,"ViewSwitchingActor.UnlockPodsSession: Unlock Pods session, correlation={0}",
b);const c=String.format("{0}PodHandler.ashx?action=LockUnlockSession&PodSID={1}&locked=false",w.AFrameworkApplication.fa.appSettings["361"],this.Ya.podSessionId),f={WaitForSessionTimeoutMs:"0"};f["X-UserSessionId"]=w.AFrameworkApplication.userSessionId;f["X-CorrelationID"]=b;f["X-WacCluster"]=this.Ya.Ek;this.Bvh(c,f,0,a)}Bvh(a,b,c,f){this.Su.zj(a,2,null,b,!1,2,l=>{this.ULl(l,c,f)},l=>{this.mMh(l,a,b,c,f)},null,void 0,void 0,void 0,void 0,Lx.a("2"))}ULl(a,b,c){if(b)xa.a.J(512499905,830,50,"ViewSwitchingActor.UnlockPodsSession: Succeed with retry: {0}",
b);else{b=!1;try{a.data.ee&&0<a.data.ee.length&&(b=JSON.parse(a.data.ee).FMerged)}catch(f){xa.a.J(512499906,830,10,"ViewSwitchingActor.UnlockPodsSession: Failed to deserialize unlock Pods session response: {0}",a.toString())}c(b)}}mMh(a,b,c,f,l){f||l(!1);3>f?this.Bvh(b,c,f+1,l):xa.a.J(512499904,830,10,"ViewSwitchingActor.UnlockPodsSession: Failed with status code: {0}, retry count: {1}",this.L$c.Nka(a),f)}S$g(a,b){this.Ncd||b.property!==zb.a.D$b||(this.Ncd=new dd.a(2,1,0,Object(I.a)(this,this.bXe,
"resumeEditor"),90,"65"),this.wb.Hb(this.Ncd))}Pth(a,b){this.Vu.hide();let c=!0,f=!1,l=this.ke.slideShowUrl;l||(l=yg.a.Ti(window.document.URL,Dh.a.leh,Dh.a.slideShowView,!0),f=!0);l=yg.a.removeParameter(l,Dh.a.WLk);l=a?yg.a.Ti(l,Dh.a.Vnc,a.sid.toString(),!0):yg.a.removeParameter(l,Dh.a.Vnc);0<b&&(l=yg.a.Ti(l,w.AFrameworkApplication.ugd,b.toString(),!0));a=String.format("menubar=false,fullscreen=yes,scrollbars=yes,resizable=yes,left=0,top=0,width={0},height={1}",window.screen.width,window.screen.height);
b=null;try{b=this.Wkc.DNe(4,l,"SlideShowWindow",a,f,!1)}catch(y){xa.a.J(512499875,818,10,"StartSlideShowFrom: Exception throw trying to open the window. {0}",y),c=!1}b||(xa.a.J(512499874,818,10,"StartSlideshowFrom:: failed to open slide show window"),c=!1);Nc.a.Ak("Window Opened",c.toString());Nc.a.gxd()}mxb(a,b,c){if(2!==c)return this.ia.processAction(G.a.close,c);a=this.ia.processAction(G.a.close,2);32!==a&&(xa.a.J(512499873,801,50,"Close action failed to execute. Response: {0}",a),window.location=
"about:blank");return 32}qxk(a,b){xa.a.J(512499872,830,50,"ViewSwitchingActor.NavigateAtSlideshowExit: SlideIndex={0}",b);(a=this.Sb.eFa(a))?this.la.Un?this.Gna.value.$J(a.ue):this.De.$J(a.ue):(xa.a.J(512499871,830,50,"ViewSwitchingActor.NavigateAtSlideshowExit: SlideId does not exist.  Navigate to slide index {0}.",b),a=this.Sb.Cj()-1,b=b>a?a:b,0>b||(this.la.Un?this.Gna.value.$J(b):this.De.$J(b)))}Uyi(){this.Rdb.instance&&this.Rdb.instance.HVa&&(this.Rdb.instance.aPc.UC?this.Rdb.instance.endCommentSession(this.Rdb.instance.aPc.UC.draftId,
7):this.Rdb.instance.endCommentSession("",7),this.Rdb.instance.byf())}Vyi(){this.la.powerPointLiveBroadcastEnabled&&Ib.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(a=>{a.isFeatureEnabled("PowerPointLivePresentations",!1).then(b=>{b||(xa.a.J(512499870,822,15," User doesn't have license for PPTLive, Hiding Present Live button"),this.yFg=!0);return null})})}}Object(m.a)(lO,"ViewSwitchingActor",null,[251]);class mO{constructor(a,b){this.Zue=null;this.Ya=a;this.Pna=
b;this.kFf();this.Ya.tzf(Object(I.a)(this,this.Njd,"onSessionInfoChanged"))}kFf(){const a=new Sys.StringBuilder;a.append(String.format("?{0}",this.Ya.presentationId.string));a.append(String.format("&{0}={1}",Dh.a.yil,this.Ya.swb));a.append(String.format("&{0}={1}",Dh.a.xoa,"368"in w.AFrameworkApplication.fa.appSettings?void 0===this.Ya.sessionInfo||null===this.Ya.sessionInfo?"undefined":this.Ya.sessionInfo:this.Ya.sessionInfo));this.Ya.Ek&&a.append(String.format("&{0}={1}",Dh.a.meh,this.Ya.Ek));this.Ya.podSessionId&&
a.append(String.format("&{0}={1}",Dh.a.Aaa,this.Ya.podSessionId));this.Zue=a.toString()}Njd(){this.kFf()}resolve(a,b,c){if(!b||!b.length)return null;if(b.startsWith("./"+a))return b;const f=eb.a("FixInvalidOperationErrorInEditImageHandler")?encodeURIComponent(b):b;return c?this.Pna+a+this.Zue+`&cl=${c}&${Dh.a.ieh}=${f}`:this.Pna+a+this.Zue+String.format("&{0}={1}",Dh.a.ieh,b)}dispose(){this.Ya.v8k(Object(I.a)(this,this.Njd,"onSessionInfoChanged"))}}Object(m.a)(mO,"ResourceViewElementResolver",null,
[385,107]);var gS=d(1073),hS=d(971);class nO{constructor(a,b){this.C5c=this.R4=0;this.pLg=null;this.qLg=-1;this.rLg=null;this.Hva=a;this.Ec=b}get Vme(){return 0<this.C5c}get hug(){return this.pLg}WAk(a){this.C5c++;this.Ec.TEh(a.CcpId,a.CcpCorrelation)}get gre(){return this.rLg}set gre(a){this.rLg=a}p7g(a,b){if(!a){const c=this.Kwj(b);c>this.qLg&&(this.qLg=c,this.pLg=b.CcpId)}0<this.C5c?this.C5c--:xa.a.J(20760084,307,15,"ClipServiceManager - bad state");this.Ec.YWf(b.CcpId,a,0)}hOc(a,b,c=!1,f=!1){a=
Object.assign(new hS.a,{DW:32,Jp:Hg.a.create().toString(),version:this.R4++,location:this.Hva.ccpInfo,QD:this.Hva.Ek||Lp.a.uQh,dataType:a,objectCount:b,WFa:c,UFa:f,Ky:Hg.a.create().toString()});xa.a.J(24945860,307,50,"CreateClipServiceObject: A ClipServiceObject was just created for Ccpid: {0}.",a);return a}Kwj(a){let b=null;a:{var c=a.PackageAccessKey;let l;l=null;if(c)try{const y=De.a(c);if(y&&"I"in y&&"V"in y){l=new ut(y.I,parseInt(y.V));var f={returnValue:!0,Ky:l};break a}}catch(y){}f={returnValue:!1,
Ky:l}}if(({Ky:b}=f).returnValue&&b)return b.version;xa.a.J(21066257,307,15,"Fail to parse packageAccessKeyString for ccpid: {0}",a.CcpId);return-1}}Object(m.a)(nO,"ClipServiceManager",null,[373]);class oO{constructor(a,b,c,f,l,y,H,Q,ia){this.Zg=a;this.egc=c;this.mHb=f;this.gue=l;this.Qr=y;this.Ec=H;this.N0=Q;this.ia=ia;this.wl=b;this.Sea=this.Zg.contentWindow.document.body;this.Qr.addHandler(this.Sea,oa.a.cut,Object(I.a)(this,this.e8g,"onBrowserCut"));this.Qr.addHandler(this.Sea,oa.a.copy,Object(I.a)(this,
this.d8g,"onBrowserCopy"))}get Jc(){return this.egc.Jc}dispose(){this.Zg&&this.Zg.contentWindow&&(this.Qr.removeHandler(this.Sea,oa.a.cut,Object(I.a)(this,this.e8g,"onBrowserCut")),this.Qr.removeHandler(this.Sea,oa.a.copy,Object(I.a)(this,this.d8g,"onBrowserCopy")));this.Zg=null}e8g(){if(Wk.YA&&!Wk.YA.w6d){var a=this.Ec.uP(1,0,"OnBrowserCut");this.fta(Object.assign(new vt(!0,!0),{Wb:a}))}}d8g(){if(Wk.YA&&!Wk.YA.w6d){var a=this.Ec.uP(0,0,"OnBrowserCopy");this.fta(Object.assign(new vt(!0),{Wb:a}))}}xQ(a){if((w.AFrameworkApplication.fK||
w.AFrameworkApplication.cC)&&!w.AFrameworkApplication.QSa)return!1;for(let b=0;b<this.wl.length;b++)if(this.wl[b].xQ(a))return!0;return!1}fta(a){if(this.ia.jX)this.N0?(this.N0.show(5,-1),this.Ec.Mg(!1,a.Wb,26)):xa.a.J(509444690,826,10,"m_offlineModalCallout is null");else if(!w.AFrameworkApplication.fK&&!w.AFrameworkApplication.cC||w.AFrameworkApplication.QSa){var b=0,c=!1;for(var f=0;f<this.wl.length;f++)if(this.wl[f].xQ(a)){c=!0;this.wl[f].fta(a)||(b=21);break}switch(a.dataType){case 2:f=2;break;
case 1:f=19;break;default:f=0}this.Ec.hC(f,a.Wb);if(c){if(a.Ymg&&(this.gue.c1a(this.Zg),!a.r2i)){if(!this.mHb){this.Ec.Mg(!1,a.Wb,1);return}this.mHb.copy(this.Zg)||0!==b||(b=22)}this.Ec.Mg(0===b,a.Wb,b)}else this.Ec.Mg(!1,a.Wb,20)}else this.Ec.Mg(!1,a.Wb,32)}}Object(m.a)(oO,"CutCopyManager",null,[368,107]);var iS=d(924);class pO{constructor(a,b,c){this.eY=a;this.eY.fk(Object(I.a)(this,this.$g,"onPropertyChanged"));this.EM=b;this.EM.fk(Object(I.a)(this,this.$g,"onPropertyChanged"));this.Qq=c}$g(a,
b){this.Qq.hr&&0<this.Qq.hr.length&&(this.Qq.hr=Yb.a.dqa(this.Qq.hr,c=>!(ha.a.hQ(c.id,b.node.id)||Object(Wa.a)(Xv.a,c))));this.Qq.hr&&!this.Qq.hr.length&&(this.Qq.hr=null)}}Object(m.a)(pO,"GraphNodeChangeListener",null,[]);class qO{constructor(a,b){this.Uec=null;a&&b&&new pO(a,b,this)}get hr(){return this.Uec}set hr(a){const b=this.Uec&&0<this.Uec.length?this.Uec[0]:null,c=a?a[0]:null,f=!!b&&!!c&&b.id.equals(c.id)&&b.NAf;this.Uec=a;c&&(c.NAf=f,c.VKf=f&&b?b.VKf:iS.a.create().toString())}}Object(m.a)(qO,
"InternalClipboard",null,[367]);class rO{constructor(a,b,c,f,l,y,H,Q,ia,wa){this.Iyg=a;this.vi=b;this.Afa=c;this.vIa=f;this.J$=l;this.Ga=y;this.gBe=H;this.khc=Q;this.Tjk=ia;this.n$c=wa}HZe(a,b,c){this.Iyg.HZe(a,b,c);b=new CM.a;this.gBe&&c||(b.setValue(ab.a.bold,!1),b.setValue(ab.a.underline,!1),b.setValue(ab.a.gw,sd.Font.BV),b.setValue(ab.a.strikethrough,!1),b.setValue(ab.a.italic,!1),b.setValue(ab.a.xt,!1),b.setValue(ab.a.X_,!1));this.vi.Q_e(a,b)}WZe(a,b,c){const f=b.cache;if(this.n$c){var l=this.afj(b);
ma.a.Xa(l)||c?f.propertySet.Ua(ab.a.font)&&(f.sa(zb.a.K0c,!1)||c)&&this.vi.jV(a,f.wL):this.vi.jV(a,l);f.sua&&this.vi.Xq(a,f.fontSize)}else this.Iyg.WZe(a,b,c);(!this.khc||this.gBe&&c)&&f.k4&&(this.vi.Pm(a,ab.a.fontColor,f.fontColor),this.khc&&(l=Fn.SchemeColor.create(null,f.fontColor),this.vi.Pm(a,zb.a.schemeColor,l.toString())));this.gBe&&c&&(this.vi.$H(a,f.isBold),this.vi.setItalic(a,f.isItalic),this.vi.TY(a,f.bG),this.vi.flb(a,f.U_),this.vi.VY(a,f.xE),this.vi.vpa(a,f.gw),this.vi.v1a(a,f.xt),this.vi.jlb(a,
f.X_),this.vi.A6(a,f.cG),this.vi.UY(a,f.isSuperscript),this.vi.fza(a,f.yn));this.vi.v1a(a,!1);this.knl(a,b)}Lae(a){return this.Afa.iUa(a)}VW(a){return this.Afa.VW(a)}tUa(a){return this.vIa.tUa(a)}c9(a){return this.J$.c9(a)}knl(a,b){b=b.dA;if(null!==b&&b.Ua(zb.a.WKa)){b=b.eb(zb.a.WKa);var c=a.dA;null===c?this.vi.Pm(a,zb.a.WKa,b):c.setValue(zb.a.WKa,b)}}iBh(a){return this.Tjk&&a&&(a=a.paragraph)&&(a=this.Ga.vn(a))&&a.Wf?!0:!1}afj(a){if(!this.n$c||!a)return null;let b="";var c=a.paragraph;if(!c)return null;
var f=this.Ga.vn(c);if(!f)return null;a=f.sa(Ab.a.i0,[]);c=c.sa(Ab.a.listLevel,Df.a.yFa);a&&0<=c&&c<a.length&&(f=f.Lh)&&(a=f.ze(a[c]))&&(a.Ua(zb.a.E2d)?b=a.eb(zb.a.E2d):a.Ua(zb.a.B2d)?b=a.eb(zb.a.B2d):a.Ua(zb.a.y2d)?b=a.eb(zb.a.y2d):a.Ua(zb.a.I2d)&&(b=a.eb(zb.a.I2d)));return b}}Object(m.a)(rO,"PPTFormattingStewardBridge",null,[342]);class sO{constructor(a,b,c,f){this.jc=c;this.JA=f}}Object(m.a)(sO,"PPTFormattingStewardHelper",null,[351]);class tO{constructor(a,b,c,f,l){this.zmk=[Ab.a.nm,Ab.a.uo];
this.la=a;this.dDb=b;this.mEg=c;this.IJ=f;this.Rb=l;this.efb=a.qqg;this.iwa=a.pptCopyPasteListMarkerEnabled;this.dhc=a.pptCopyPasteMarginAndIndentationEnabled}N7e(a){return this.dDb.Y_j(a)}ife(a,b){return this.dDb.Z_i(a,b)}rpa(a,b,c,f=null,l=null){if(this.mEg.$kd)if(this.dDb.Gng(c))a.setValue(ee.a.Png,!0);else if(this.dDb.ql(c)){if(this.dhc&&a&&b){var y=this.Rb.Lc(a);y.sc(11);y.Kg(11);c=Zb.ListReader.Hk(y);const H=this.IJ.ffj(a,y);y=this.IJ.bfj(a,y);c&&(f||(xa.a.J(41219841,826,50,"Default marginLeft for internal"),
b[Ab.a.nm.id.toString()]=H),l||(xa.a.J(41219843,826,50,"Default textIndent for internal"),b[Ab.a.uo.id.toString()]=y));f&&xa.a.J(41018240,826,50,"Customized marginLeft");l&&xa.a.J(41018242,826,50,"Customized textIndent")}this.mEg.rpa(a,b)}if(this.la.B1c&&!Db.ParagraphReader.gX(a))for(const H of this.zmk)void 0===a.Rh(H)&&a.ye(H,0)}INb(a,b,c){if(this.efb){var f=b.propertySet.Ua(ab.a.Zi)?b.propertySet.eb(ab.a.Zi).length:1;if(a=this.IJ.BQ(a,b.propertySet.sa(Ab.a.listLevel,0)))if(this.iwa&&(0<c.Ttb||
c.BRa&&0<c.BRa.length)){f="";b.cbb&&!b.Lgg&&(f=c.font);let l=null;c.BRa&&0<c.BRa.length&&(l=c.BRa,1===c.BRa.length&&xa.a.J(41219847,826,50,"Customized bullet."));let y=-1;0<c.Ttb&&(y=c.Ttb,xa.a.J(41219849,826,50,"Customized number list."));this.IJ.SNc(a,b.propertySet);l&&b.propertySet.setValue(ab.a.Zi,l);ma.a.Xa(f)||b.propertySet.setValue(ab.a.font,f);0<y&&b.propertySet.setValue(zb.a.autonumberBulletType,y)}else a.sa(ab.a.Zi,[]).length===f&&this.IJ.SNc(a,b.propertySet)}}m1c(a){return this.dDb.m1c(a)}get k2c(){return this.dDb.k2c}R1(a,
b){2===b.unit?(a.setValue(zb.a.qX,2),a.setValue(zb.a.Jx,b.value)):xa.a.J(36779851,826,50,"the un-support text spacing unit")}QLa(a,b){b.beforeSpacing.value&&(a.setValue(zb.a.Gea,b.beforeSpacing.value),a.setValue(zb.a.ama,4));b.afterSpacing.value&&(a.setValue(zb.a.Fea,b.afterSpacing.value),a.setValue(zb.a.$la,4))}lyh(a,b){const c=(new vv.a(b.unit,b.value)).oN;1===b.specialIndentType?a.setValue(Ab.a.uo,c):2===b.specialIndentType?a.setValue(Ab.a.uo,-c):0===b.specialIndentType&&a.setValue(Ab.a.uo,0)}axh(a,
b){b=(new vv.a(b.unit,b.value)).oN;a.setValue(Ab.a.nm,b)}get lBh(){return!0}}Object(m.a)(tO,"PPTPasteStewardBridge",null,[349]);class uO extends Us{constructor(a,b){super(a,b)}T6b(){return["PasteSlide"]}}Object(m.a)(uO,"PasteSlideReactFloatie",Us,[]);class vO{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye,Xd){this.ogg=!1;this.CR=[];this.yjc=[];this.rte=[];this.Zve=0;this.O7c=!1;this.oc=c;this.pa=f;this.dhb=l;this.Rc=Q;this.QDe=xd;this.nd=a;this.Lrk=b;this.el=Ua;this.ook=ia;
this.Tb=kb;this.Fa=Gb;this.Ks=ec;this.cik=dc;this.Vhk=Fc;this.$b=yc;this.QXg=tc;this.Jb=Vd;this.ccd=Ld;this.Zg=Xd;this.oXa=Ib.a.instance.qb("Common.IReactContextualUILauncher");this.RDb=Ib.a.instance.qb("Common.IExternalUICommandDefinitionMapping");this.Med=(this.ni=Vd.ka("ReplaceThumbnailWithSlideSorter"))?document.getElementById("pptonline-sorter-view-id"):y.va}b6(a){2===a.behavior&&(a=a.actionId,a!==ea.a.uv&&a!==ea.a.WCa&&a!==ea.a.$na&&a!==ea.a.X5&&a!==ea.a.Dja&&a!==ea.a.tQ&&a!==ea.a.insertPicture&&
a!==ea.a.$na&&a!==ea.a.Hta&&a!==ea.a.A8d&&a!==ea.a.z8d&&a!==ea.a.insertPicture&&a!==ea.a.wTc&&a!==ea.a.xTc&&a!==ea.a.qPe&&a!==ea.a.bld||this.lE(null,new zd(!0)))}a6(){}Idi(){this.QDe&&!this.ogg&&(this.pa.fE(Object(I.a)(this,this.onSelectionChange,"onSelectionChange")),this.Lrk.yd(7).IF(Object(I.a)(this,this.$B,"onChildTopologyChanged")),this.nd.DCa(Object(I.a)(this,this.AY,"onThumbnailDrawCompleted")),hd.a.addHandler(this.Med,"scroll",Object(I.a)(this,this.Y0a,"scrollHandler")),hd.a.addHandler(this.ni?
this.Med:this.Zg.contentWindow.document.body,oa.a.Bf,Object(I.a)(this,this.onKeyDown,"onKeyDown")),this.ni||this.Rc.rb(oa.a.click,this.Med,Object(I.a)(this,this.JC,"clickHandler")),w.AFrameworkApplication.Aa.Nca(Object(I.a)(this,this.G1,"resizeHandler")),this.ook.x7a(Object(I.a)(this,this.l1,"onSlidePresenceChanged")),this.el.Azf(Object(I.a)(this,this.bNe,"onSlidesIdReturned")),this.cik.MQa(Object(I.a)(this,this.Jjd,"onRevisionProcessedOnServerHandler")),this.Vhk.ggi(Object(I.a)(this,this.eBk,"onBlockingHandler")),
this.ccd.kTd(Object(I.a)(this,this.wFk,"onOnlyKeyPressed")),this.ogg=!0)}wFk(){if(EC.a.instance.keyCode===B.a.Dba&&this.oXa.Sua){const c=document.getElementById("PasteSlideControl-Floatie");if(c){var a=Bd.a.ki(c),b=this.QXg.va.style.height;a.y+a.height+61+2<parseInt(b.substr(0,b.length-2))+Lz.a.B8e?xa.a.J(512497815,826,10,"recoveryUIElement rendering to wrong place"):(a=c.getAttribute(Ve.a.K7a)||"",Ve.a.pja===a&&c.click(),!this.O7c&&this.ni&&(hd.a.addHandler(c,oa.a.Bf,this.onKeyDown.bind(this)),this.O7c=
!0))}else xa.a.J(512497816,826,10,"recoveryUIElement is null")}}onKeyDown(a){a.keyCode===B.a.mZ&&(this.O7c&&(a=document.getElementById("PasteSlideControl-Floatie"),hd.a.removeHandler(a,oa.a.Bf,this.onKeyDown.bind(this)),this.O7c=!1),this.lE(null,new zd(!0)))}eBk(a,b){1===b.block?this.lE(a,null):2===b.block&&this.lE(a,new zd(!0))}Jjd(a,b){b&&(a=b.FD)&&a.ActionInformation.ActionId!==""+ea.a.$nc&&a.ActionInformation.ActionId!==""+ea.a.MJb&&a.ActionInformation.ActionId!==""+ea.a.eld&&this.Ks.f4c&&this.Ks.f4c<
parseInt(a.ActionInformation.ActionTime)&&this.lE(null,new zd(!0))}l1(a,b){this.t0f(b.slideId.sid,this.CR)&&(this.lE(null,new zd(!0)),this.Ks.DOb=!1)}t0f(a,b){for(const c of b)if(c.sid===a)return!0;return!1}bNe(a,b){if(b&&b.c_a){if(this.rte.length>=b.c_a.length&&!this.oXa.Sua&&(this.setSelection(b.c_a),this.CR.length===b.c_a.length)){this.showFloatie({},new Cg(1,w.AFrameworkApplication.isRtl));let c;(c=this.pa).t7a.apply(c,this.CR)}this.Ks.nKa.length||(this.Ks.nKa=b.c_a,Array.clear(this.CR),Array.clear(this.yjc))}}onSelectionChange(a,
b){if(this.Ks.DOb){for(a=0;a<b.XE.length;a++)if(Object(qa.a)(4,b.XE[a].context.node)){this.lE(null,new zd(!0));return}!this.Fa.Ee||this.Fa.Ee.name!==Oi.a.o3&&this.Fa.Ee.name!==Oi.a.nGf&&this.Fa.Ee.name!==Oi.a.kGf&&this.Fa.Ee.name!==jb.a.cF&&this.Fa.Ee.name!==jb.a.jJ&&this.Fa.Ee.name!==jb.a.OW||this.lE(null,new zd(!0))}}G1(){this.OTe()}Y0a(){this.OTe()}JC(){this.OTe();return!0}OTe(){if(this.oXa.Sua){const a=new Cg(1,w.AFrameworkApplication.isRtl);this.showFloatie(null,a)}}AY(a,b){a=this.Ks.nKa;this.rte.push(b.gd);
if(!this.oXa.Sua&&this.Ks.DOb&&a&&a.length>=this.yjc.length&&b.succeeded)for(var c of a)if((b=this.oc.Zk(new Va.a(c)))&&!this.t0f(b.sid,this.yjc)&&(this.yjc.push(b),this.Zve++,b=a.length,this.Zve===b)){this.pa.p9a();this.setSelection(a);var f=void 0;(f=this.pa).t7a.apply(f,this.CR);if(c=this.shj())this.Tb.Ba=c;this.Zve=0;c=!0;for(f=0;f<b;f++)(a=this.CR[f].tg(this.dhb))&&a.ijb&&a.ijb.e9()&&0<a.ijb.e9().length&&(c=!1);c&&this.showFloatie({},new Cg(1,w.AFrameworkApplication.isRtl));break}}shj(){let a=
this.CR.length;if(!a&&(this.setSelection(this.Ks.nKa),a=this.CR.length,!a))return xa.a.J(512497814,826,50,"GetLastPastedSlideNode and selectedNode is empty"),null;let b=this.CR[0];for(let c=1;c<a;c++)b.slideIndex>this.CR[c].slideIndex&&(b=this.CR[c]);return b}setSelection(a){if(a&&a.length){Array.clear(this.CR);for(const b of a)(a=this.oc.Zk(new Va.a(b)))?this.CR.push(a):xa.a.J(512497813,826,50,"Cannot find the slide")}}y8f(){let a=this.CR.length;if(!a&&(this.setSelection(this.Ks.nKa),a=this.CR.length,
!a))return xa.a.J(512497812,826,50,"GetLastPastedSlideNode and selectedNode is empty"),null;xa.a.J(512497811,826,50,String.format("Pasted slides count is: {0} ",a));let b=this.CR[0];for(let c=1;c<a;c++)b.slideIndex<this.CR[c].slideIndex&&(b=this.CR[c]);return b}showFloatie(a,b){b.location=this.kyb();if(b.location){const c=this.$b.$c(this.oc.tn);if(!c||c&&a)xa.a.J(512497810,826,50,"ShowFloatie number"),this.Jb.ka("ReactSlidePasteFloatieEnabled")&&(new uO(this.oXa,this.RDb)).Q1e(b.location,b.Pu),Array.clear(this.rte)}}lE(a,
b){this.oXa.Sua&&(this.oXa.lE(),b&&(this.Ks.DOb=!b.o7d,b.o7d&&this.Ks.Kib&&(a=this.Ks.Kib.UA,null!=a&&xa.a.J(512497809,826,50,String.format("last user selcted keepSource:{0}",a.toString()))),this.Ks.DOb||(this.Ks.f4c=0)))}SDi(a){if(!this.Ks.P3b)return!0;a=a.rK;if(a.length!==this.Ks.P3b.length)return!0;let b=0;for(let c=0;c<a.length;c++)if(a[c]&&!a[c].equals(this.Ks.P3b[c])||!a[c]&&this.Ks.P3b[c])if(b++,b>this.yjc.length)return!0;return!1}$B(a,b){this.oXa.Sua&&(a=Object(qa.a)(482,b.node))&&this.SDi(a)&&
this.lE(null,null)}kyb(){var a=this.ni?this.jvj():this.kvj();if(!a)return null;a=Bd.a.ki(a);const b=a.x+a.width-86;let c=a.y+a.height+61+2;const f=this.Med.style.height;var l=this.QXg.va.style.height;l=parseInt(l.substr(0,l.length-2))+Lz.a.B8e;if(c>parseInt(f.substr(0,f.length-2))+l)c=c-a.height/2-2;else if(c<l)return this.lE(null,new zd(!1)),null;this.Ks.position=new Sys.UI.Point(b,c);return this.Ks.position}jvj(){const a=this.y8f();if(!a)return xa.a.J(509089690,826,50,null),null;let b=document.querySelectorAll("#pptonline-sorter-view-id .grid-content-thumbnail-view-visible-class");
return b&&b.length>a.slideIndex?b[a.slideIndex]:null}kvj(){var a=this.y8f();if(!a)return xa.a.J(512497808,826,50,null),null;a=a.tg(this.dhb);return a?a.Nmb:(xa.a.J(512497807,826,50,null),null)}}Object(m.a)(vO,"PasteFloatieHelper",null,[350,143]);class SE{constructor(){this.DOb=!1;this.f4c=0;this.Kib=null;this.pOe=0;this.Zfb=[];this.position=this.P3b=null}get nKa(){return this.Zfb}set nKa(a){a?this.Zfb=a:Array.clear(this.Zfb)}}Object(m.a)(SE,"PasteFromFloatieArgs",null,[]);var jS=d(1071);class wO{oac(a){a=
a.C8;return a===jb.a.vg||a===jb.a.lF||a===jb.a.lC}}Object(m.a)(wO,"PasteHandlerUtil",null,[371]);class xO{constructor(a,b,c,f,l,y){this.qU=0;this.ia=a;this.n5=b;this.wIa=c;this.Mx=f;this.BEb=l;this.sjk=y}xQ(a){if(!this.wIa.oac(this.n5.value))return!1;if(this.Mx.gTj(a)){a=Array.isArray(a.aX)?a.aX:null;if(this.$Gj(a)&&!this.yHj(a))return!1;this.qU=1}else if(this.BEb&&(this.Mx.eTj(a)||this.Mx.dTj(a))){a=this.Mx.Xme(a.Ku);if(!this.sjk&&a)return ka.ULS.sendTraceTag(36558551,307,50,"Cross-dc shape pasting is not allowed since its BRS is off."),
this.qU=0,!1;this.qU=2}else this.qU=0;return 0!==this.qU}paste(a){1===this.qU?this.ia.Ka(ea.a.ald,2,a):2===this.qU&&this.ia.Ka(ea.a.Qeh,2,a)}$Gj(a){for(const b of a)if(!b.isConnected)return!0;return!1}yHj(a){for(const b of a)if(a=b.shapeNode,!a.qj&&!a.vd)return!0;return!1}}Object(m.a)(xO,"ShapePasteHandler",null,[525]);class yO{constructor(a,b,c){this.qU=0;this.ia=a;this.Mx=b;this.aYa=c}xQ(a){this.Mx.omg(a)?this.qU=1:this.aYa&&this.Mx.fTj(a)?this.qU=2:this.qU=this.Mx.iTj(a)?3:0;return 0!==this.qU}paste(a){a.UA=
null!=a.UA?a.UA:!0;eb.a("UseClipServiceForDestinationThemePaste")&&1===this.qU&&!a.UA&&a.Ku&&(this.qU=2);1===this.qU?this.ia.Ka(ea.a.bld,2,a):2===this.qU?(a.Ku?xa.a.J(512356509,826,50,"SlidePasteHandler:Paste FromClipService, pasteParams keepsource value {0}",a.UA):xa.a.J(512356508,826,50,"SlidePasteHandler:Paste FromClipService, pasteParams is null"),this.ia.Ka(ea.a.eld,2,a)):3===this.qU&&this.ia.Ka(ea.a.Seh,2,a)}}Object(m.a)(yO,"SlidePasteHandler",null,[525]);class TE{constructor(a,b,c,f){this.KBg=
[rb.a.Dig,rb.a.Bmb,rb.a.xHh,rb.a.Jvd];this.ia=a;this.Fa=b;this.wIa=c;this.Mx=f}xQ(a){if(!this.wIa.oac(this.Fa)||TE.r0j(a)||this.Mx.K5j(a))return!1;a.xQ=!this.XGi(a.hn);return a.xQ}XGi(a){for(let b=0;b<this.KBg.length;++b)if(0<a.getElementsByTagName(this.KBg[b]).length)return!0;return!1}paste(a){xa.a.J(17310408,826,50,"TextPasteHandler: Execute command to paste text as new shape.");this.ia.Ka(ea.a.sOe,2,a)}static r0j(a){if(!a||!a.hn)return xa.a.J(17310404,826,15,"TextPasteHandler: User attempted to paste null content."),
!0;a=Hb.b(a.hn);return a&&a.length?!1:(xa.a.J(17310406,826,15,"TextPasteHandler: User attempted to paste empty content."),!0)}}Object(m.a)(TE,"TextPasteHandler",null,[525]);var kS=d(901),lS=d(973),mS=d(447),iA=d(687);class zO{constructor(a,b){this.fya=a;this.pastedContent=b}}Object(m.a)(zO,"PasteContext",null,[]);class AO{constructor(a){this.gCe=0;this.vHb=null;this.Nqk=a;this.Vgb=this.Nqk.RHb("UserAction","TimingLogger");this.reset()}start(){this.reset();this.Vgb.start()}r_b(a){if(a&&0<a.length){this.vHb||
(this.vHb={});const b=this.Vgb.dr;this.vHb[a]=b-this.gCe;this.gCe=b}}flush(a=null){let b="";a&&0<a.length&&(b=a+":");if(this.vHb){a=this.vHb;for(let c in a)b+=String.format(" {0}={1}ms,",c,a[c])}0<b.length&&xa.a.J(20570128,826,50,b);this.reset()}reset(){this.gCe=0;this.vHb=null}}Object(m.a)(AO,"TimingLogger",null,[]);class gq{constructor(){this.objectCount=0;this.data=this.ccpid=null;this.contentType=this.dataSize=this.errorInCopying=0;this.packageSize=this.packageKey=this.isDataCompressed=null;this.skipUndo=
!1;this.selectionSlide=null}static pNi(a){if(!a)return null;a=a.getData(gq.Eti);return gq.Djg(gq.tlh(a))}static qNi(a){return a?gq.Djg(gq.tlh(a.pptSlide)):null}static Djg(a){if(!a||0===a.contentType)return xa.a.J(541405764,826,15,"InitPicklingClipboardObject mimetype not supported"),null;a.dataSize=a.data?a.data.length/gq.zti:Number.MAX_VALUE;a.skipUndo=!1;xa.a.J(540932290,826,50,"InitPicklingClipboardObject successful ccpid: {0}, datasize: {1}, objectCount: {2}, errorCode: {3}",a.ccpid,a.dataSize,
a.objectCount,a.errorInCopying);return a}static Q5j(a){return!!a&&0<a.objectCount&&!!a.ccpid&&(!!a.data||!a.data&&!!a.errorInCopying)&&null!=a.isDataCompressed}static tlh(a){try{let b=null;if(!a)return null;b=JSON.parse(a);if(gq.Q5j(b))return b.contentType=1,b.errorInCopying=void 0===b.errorInCopying||null===b.errorInCopying?0:b.errorInCopying,b}catch(b){xa.a.J(541405765,826,15,"ReadPicklingData exception occured in parsing")}return null}}gq.zti=1048576;gq.Eti="ppt/slides";Object(m.a)(gq,"PicklingClipboardObject",
null,[]);var nS=d(689);class Ng{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld){this.oBe=!1;this.eWg=0;this.cZa=null;this.Sjc=!1;this.fCe=null;this.iBe=!1;this.n5=a;this.Zg=b;this.Qq=c;this.ZGa=l;this.la=f;this.wl=y;this.Qr=H;this.Sea=this.Zg.contentWindow.document.body;this.Qr.addHandler(this.Sea,oa.a.paste,Object(I.a)(this,this.dLe,"onBrowserPaste"));this.Ud=Q;this.Wo=ia;this.sgc=Gb;this.Mna=new AO(wa);this.oma=kb;this.Fic=null;this.G$c=f.F4j;this.VJg=this.Wo.oO(7);this.Mx=Ua;
this.yO=ec;this.gR=dc;this.Ga=yc;this.jc=Fc;this.Ec=tc;this.N0=xd;this.ia=Vd;this.VCe=f.pptEditingImageMaxSizeInBytes;this.wMg=Math.floor(f.pptEditingImageMaxSizeInBytes*Ng.hEf);this.Cgc=f.tmg;this.aYa=f.Hme;this.z9c=f.eUj;this.fZg=f.C1j&&this.Wo.iX;this.EBe=this.z$c=!1;this.BEb=f.Gme;this.Mgc=f.Ing&&this.Wo.Ho;this.cqk=f.uij&&this.Wo.gg;this.Zdk=f.pptCopyPasteRotateImageOnSafariFixIsEnabled&&this.Wo.cva;this.P9c=this.la.MWj;this.yH=Ld;this.kYa=this.la.ka("IsPasteTextFloatieEnabled")}dispose(){this.Zg&&
this.Qr.removeHandler(this.Sea,oa.a.paste,Object(I.a)(this,this.dLe,"onBrowserPaste"));this.Mna=this.Zg=null}kNk(a){a===this.fCe.Wb&&this.ia.Ka(ea.a.Znc,2,this.fCe)}dLe(a){const b=this.Ec.uP(2,0,"OnBrowserPaste");this.Mna.start();this.z$c=this.iBe=!1;if(Wk&&Wk.YA&&!Wk.YA.w6d){!this.Wo.dG||this.Wo.ik||this.Zdk?rb.a.S1b(this.Zg):this.ZGa.c1a(this.Zg);var c=this.gR.Oda(a);c=this.Mx.l2c()?gq.pNi(c):null;var f=new zE;f.k4d=a;f.Ihh=b;null!=this.cZa&&(this.Ec.ji(Ng.uGf,"menu",b),this.Ec.ji(Ng.tGf,this.cZa?
Ng.Jti:Ng.Hti,b));this.Sjc&&(this.Ec.ji(Ng.uGf,"menu",b),this.Ec.ji(Ng.tGf,Ng.Iti,b));var l=this.kYa&&this.DFe,y=this.la.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled")&&this.EFe;this.Sjc||l||y||!c||!this.Eeh(c,null,b,ea.a.dld,f)?(this.Deh(a,b),this.cZa=null,this.Sjc=!1,this.kYa&&(this.DFe=!1,this.la.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled")&&(this.EFe=!1))):this.cZa=null}}Deh(a,b){var c=this.gR.Oda(a);const f=this.gR.rZf(c);this.Ec.P_e(f,b);if(!this.jJl(a,b)){var l=Object.assign(new qm.a(!0),
{Wb:b,UA:this.cZa});this.kYa&&(l.O5b=this.DFe,this.la.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled")&&(l.P5b=this.EFe));var y=null;w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SlideSorterPasteViaKeyboardEnabled",!1)&&document.activeElement.classList.contains("grid-content-editable-cursor-hide-class")&&(xa.a.J(509669642,826,50,"Getting html from dom event for slide sorter"),(y=a=this.gR.B7b(c))||(y=c.getData("text/plain")));this.cqk&&(xa.a.J(512356507,
826,50,"OnBrowserPaste::Getting html data from Clipboard"),c=this.gR.B7b(c),a=this.gR.hKa(c),c?(this.JJf(a)&&(this.Qq.hr[0].D8a=a.firstChild.className,l.aX=null),l.hn=a):xa.a.J(512356506,826,15,"OnBrowserPaste::htmlString is empty"));this.fCe=l;Nc.a.bba(()=>{this.DKe(void 0,l,y)},0,this.la.V_j?0:2)}}yyi(a,b){let c=!1;Wk.YA.u8a(f=>{xa.a.J(512356505,826,50,"CheckAndEnablePasteAsOptions: isAccessible : {0}",f);null!=f&&f&&(c=this.Fyi(a,b))});return c}Fyi(a,b){const c=Date.now();let f=!1;Wk.YA.Oda(this.Zg,
a,l=>{xa.a.J(512356504,826,50,"CheckClipboardDataToEnablePasteAsOptions: GetClipboardData returned, time taken : "+(Date.now()-c));if(l){var y=this.la.ka("IsPasteTextFloatieEnabled")&&b;if(!a&&!y)l.html&&l.html.length<=Ng.Bui?-1!==l.html.indexOf(Ng.XGf)&&(f=!0):l.pptSlide&&l.pptSlide.length&&(f=!0);else if(y)l.text&&0<l.text.length?f=!0:this.BHj(l.html)&&(f=!0);else if(l.img||l.isImageAvailable)f=!0;f&&(l=[],a?(l.push(appChrome.actions.updateControlEnabledDisabledState(Ng.Pui,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(Ng.Oui,
!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(Ng.Nui,!1))):y?(l.push(appChrome.actions.updateControlEnabledDisabledState(Ng.Sui,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(Ng.Rui,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(Ng.Qui,!1))):(l.push(appChrome.actions.updateControlEnabledDisabledState(Ng.aui,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(Ng.bvi,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(Ng.cui,
!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(Ng.dvi,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(Ng.bui,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(Ng.cvi,!1))),appChrome.api.dispatch(l));xa.a.J(512356502,826,50,"CheckClipboardDataAndEnablePasteAsOptions: isCopiedDataCompatible={0}, time taken : {1}",f,Date.now()-c)}else xa.a.J(512356503,826,50,"CheckClipboardDataToEnablePasteAsOptions: GetClipboardData returned, clipboardObject is null")});
return f}BHj(a){if(!a||0==a.length||0<=a.indexOf(Ng.$ui)||0<=a.indexOf(Ng.XGf))return!1;a=this.gR.hKa(a);if(!a)return xa.a.J(509089756,826,15,"hasOnlyTextContent:: html element is null"),!1;const b=a.getElementsByTagName(rb.a.Bmb).length;return 0===a.getElementsByTagName(rb.a.n4).length&&0===b}Eeh(a,b,c,f,l){b||(b=Object.assign(new qm.a(!0),{Wb:c,UA:this.cZa}));b.VM=a;this.Ec.ji(Ng.objectCount,a.objectCount.toString(),c);this.Ec.ji(Ng.isDataCompressed,null==a.isDataCompressed?!1:a.isDataCompressed.toString(),
c);this.Ec.ji(Ng.Tui,(b.VM.packageSize?null==b.VM.packageSize?0:b.VM.packageSize/Ng.hEf:b.VM.dataSize).toString(),b.Wb);return 0!==b.VM.errorInCopying?(xa.a.J(541647952,826,15,"PastePicklingData invalid package ccpid: {0}, objectCount: {1}, error: {2}",b.VM.ccpid,b.VM.objectCount,b.VM.errorInCopying),this.$Bh(b.VM.errorInCopying,f,l,b),!0):this.Mx.w0j(b.VM.dataSize)?this.P3d(b):(xa.a.J(541647953,826,15,"PastePicklingData package size exceeds limit ccpid: {0}, size: {1}, objectCount: {2}",b.VM.ccpid,
b.VM.dataSize,b.VM.objectCount),this.$Bh(1,f,l,b),!0)}$Bh(a,b,c,f){switch(a){case 1:this.Ec.Mg(!1,f.Wb,27);this.yH.fba(ResourceStrings.l_PasteAsImageErrorCalloutTitle,ResourceStrings.l_PasteAsImageErrorCalloutMessage,!0,ResourceStrings.l_PasteAsImageButtonTitle,!0,CommonUIStrings.l_DialogCancel,b,0,c,null,!1,Ng.lLc,!1,null);break;default:this.Ec.Mg(!1,f.Wb,28),this.yH.fba(ResourceStrings.l_SomethingWentWrongCalloutTitle,ResourceStrings.errorTitle_PasteSlideFailed,!1,null,!1,null,0,0,null,null,!0,
Ng.lLc,!1,null)}}dld(a,b){xa.a.J(512356499,826,50,"PasteSlideAsImage called");const c=this.Ec.uP(2,0,"PasteSlideAsImage");this.Ec.ji("PasteSlideAsImage",b,c);this.Mna.start();this.z$c=this.iBe=!1;this.Deh(a,c)}Hzi(a){a=a.split("+");const b=this.jc.mg(this.Qq.hr[0].gd).Db;return b.cid.toString()===a[0]&&b.sid.toString()===a[1]}jJl(a,b){let c=!1,f=this.Sjc;var l=this.gR.R9d(a.rawEvent,this.Zg.contentWindow);if(l){let y=null;({v$b:y,D6g:l}=this.gR.mxd(l,this.la.clipboardDataImageBlobNumberLimitaton,
this.Cgc?50*Ng.ySh:this.wMg));this.Mna.r_b("GetBlob");0<l&&(xa.a.J(512356498,826,50,"Blob is too large"),this.kud(b),c=!0);y&&1===y.length&&(Nc.a.bba(()=>{this.pwi(y,b,f)},0),this.fZg&&a.preventDefault(),c=!0)}else this.G$c&&this.VJg&&(this.Fic=this.oma.MJl(a.rawEvent));c&&this.Ec.hC(5,b);return c}pwi(a,b,c){if(c||a&&(this.gR.Qyd(this.Sea)||this.fZg)){const f=a[0],l=Nc.a.Kb;Nc.a.Ak(hh.a.Qpi,f.size.toString());this.Cgc&&f.size>=this.wMg?(this.EBe&&xa.a.J(512356497,826,50,"Ctrl-v pressed while shrinking image"),
this.sgc.uvg(f,y=>{Nc.a.NF(l,()=>{y&&this.Mxl(y,f.size,b)||(this.z$c=!0,this.DKe(b));this.EBe=!1})}),this.EBe=!0):(new kS.a).CKh(a,y=>{Nc.a.NF(l,()=>{this.Rij(y,b)})})}else this.DKe(b)}Rij(a,b){this.Mna.r_b("GetDataUrl");this.qKl(a,b)||(xa.a.J(512356496,826,15,"Paste image data uri failed"),this.paste(Object.assign(new qm.a(!0),{Wb:b}),null,!1))}DKe(a="",b=null,c=null){this.paste(b||Object.assign(new qm.a(!0),{Wb:a}),c,!1)}uNk(a,b){if(Wk.YA){xa.a.J(512356495,826,50,"PasteManager::PastePicklingData called ccpCorrId: {0}",
a.Wb);var c=Date.now();Wk.YA.Oda(this.Zg,a.c$a,f=>{a.c$a&&(f.html=null,f.pptSlide=null,f.text=null);this.vak(f,c);if(f=gq.qNi(f)){var l=new AE;l.pastedContent=b;l.fya=a;this.Eeh(f,a,a.Wb,ea.a.Reh,l)}else this.paste(a,b,!0)})}}vak(a,b){if(a){var c=a.img?a.img.length:0,f=a.html?a.html.length:0,l=a.text?a.text.length:0;a=a.pptSlide?a.pptSlide.length:0;xa.a.J(512356493,826,50,"LogClipboardObjectLength:: timeTaken: {0}, imgLength: {1}, htmlLength: {2}, textLength: {3}, pptSlideLength: {4}",Date.now()-
b,c,f,l,a)}else xa.a.J(512356494,826,50,"clipboardObject is null")}paste(a,b,c){if(this.ia.jX)this.N0.show(5,-1),this.Ec.Mg(!1,a.Wb,26);else if(a.t6d)this.jfe(a,b);else if(Wk.YA){var f=this.Wo.$T&&w.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix");this.la.t0c&&!f||this.Mgc?(a.VM=null,this.Mx.l2c()&&!c?this.uNk(a,b):(xa.a.J(512356492,826,50,"Paste::m_isEdgeContextMenuPasteFixEnabled {0} or IsChromeClipboardAccessEnabled: {1} is enabled",this.Mgc,this.la.t0c),this.JXe(a,b))):(this.cZa=a.UA,
this.Sjc=a.c$a,this.kYa&&(this.DFe=a.O5b,this.la.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled")&&(this.EFe=a.P5b)),this.Mx.l2c()&&Wk.YA.AIl(this.Zg,a.Wb)?(this.Ec.ji(Ng.DNk,"true",a.Wb),this.Ec.Mg(!0,a.Wb)):(this.cZa=null,({content:b}=Wk.YA.paste(this.Zg,this.n5.value,a.Wb,!1)).returnValue?this.jfe(a,b):(Wk.YA.Cda(!1),b=Wk.YA.ty,null==b?(a=new Lh.a(null,Object(I.a)(this,this.K2i,"fWaitForAsyncAPIResult"),Object.assign(new GE,{zd:a.Wb})),a.$l("ClipboardPreProcessForAsyncAPI"),a.run()):null!=
b&&b&&this.JXe(a,null))))}else this.Ec.Mg(!1,a.Wb,1)}K2i(a,b){a=Wk.YA.ty;if(null==a)return!0;b=b.zd.toString();a?this.JXe(Object.assign(new qm.a(!1),{Wb:b}),null):this.Ec.Mg(!1,b,29);return!1}JXe(a,b){this.eWg=Date.now();this.oBe=!1;Wk.YA.prepareForPaste(a.c$a,c=>{this.Ec.ji("isPasteFromAsyncApi",c.toString(),a.Wb);this.oBe=!0});b=new zO(a,b);(new Lh.a(null,Object(I.a)(this,this.prepareForPaste,"prepareForPaste"),b)).run()}qOe(a,b){return a&&0<a.length?(a=Object.assign(new qm.a(!0),{Wb:b,ehe:a,gSc:!0}),
this.P3d(a),!0):!1}prepareForPaste(a,b){a=!0;let c=!1;if(this.oBe){let f;({content:f}=Wk.YA.paste(this.Zg,this.n5.value,b.fya.Wb,b.fya.c$a)).returnValue&&f?this.jfe(b.fya,f):c=!0;a=!1}else Date.now()-this.eWg>this.la.SJf&&(xa.a.J(512356491,826,50,null),a=!1,c=!0,Wk.YA.reset());c&&this.Ec.Mg(!1,b.fya.Wb,29);return a}get psl(){return this.Wo.Wj&&this.la.KTj}jfe(a,b){if(!a.hn)if(xa.a.J(512356490,826,50,"HandlePasteContent::pasteParams.PastedHtml is empty"),!b||a.Aqg&&this.psl)if(this.Tsl()){b=rb.a.sB();
b.src=this.Fic;this.Fic=null;var c=rb.a.$d();c.appendChild(b);a.hn=c}else this.JJf(this.Sea)&&(xa.a.J(512356488,826,50,"HandlePasteContent::CheckWhetherFixClipboardId is true"),this.Qq.hr[0].D8a=this.Sea.firstChild.className,a.aX=null),xa.a.J(512356487,826,50,"HandlePasteContent::Using m_body for PastedHTML."),a.hn=this.Sea;else xa.a.J(512356489,826,50,"HandlePasteContent::Paste not from IFrame Clipboard or !ShouldGetPastedContentFromClipboardTargetDOM"),c=rb.a.$d(),lS.a.qsd(c,b,"PasteManager"),a.hn=
c;this.JWd(a);b=this.Mx.eWj(a.hn.firstChild);c=this.Mx.hWj(a.hn.firstChild);if(b||c)xa.a.J(512356486,826,50,"HandlePasteContent:pasteParams.PastedHtml is empty clipboard {0} / empty placeholder {1}",b,c),this.Ec.Mg(!0,a.Wb);else if(this.Y5i(a.hn),b=a.hn.innerHTML.startsWith("<img"),c=a.hn.innerHTML.length,a.t6d&&b&&(this.Mna.r_b("ConvertDataUrlToDOMNode"),this.Mna.flush(String.format("Browser={0}, Length={1}, IsFromBlob={2}",this.Wo.iz,c,this.iBe))),!c&&this.z$c)this.kud(a.Wb);else{var f=0,l=!1;({nZd:f,
z6d:l}=this.hJl(a));1===f?(xa.a.J(512356485,843,15,"Failed to attach clipServiceObject due to deferred content, IsSlidePaste: {0}",l),this.Ec.Mg(!1,a.Wb,25)):!a.aX&&!a.Ku&&c>this.VCe?(eb.a("PasteManagerOacr73010Fix")?(this.Zg.contentWindow.document.body.innerText="",a.hn.innerText=""):(this.Zg.contentWindow.document.body.innerHTML=null,a.hn.innerHTML=null),b?(xa.a.J(512356484,826,50,"Image too large"),this.kud(a.Wb)):(xa.a.J(512356483,826,50,String.format("Paste content size is {0} which is too big.",
c)),this.Ec.Mg(!1,a.Wb,7))):(a.Ku?(xa.a.J(512356482,826,50,"HandlePasteContent - Before DispatchPaste,  pasteParams keepsource value {0}",a.UA),this.Ec.ji(Lp.a.Jp,a.Ku.Jp,a.Wb)):xa.a.J(512356481,826,50,"HandlePasteContent - Before DispatchPaste,  pasteParams ClipServiceObject is null"),this.P3d(a))}}JWd(a){a?a.hn?a.hn.firstChild?a.hn.firstChild.getAttribute||xa.a.J(512356449,826,50,"BuildDiagnosticInfo:pasteParams.PastedHtml.FirstChild.getAttribute is null"):xa.a.J(512356450,826,50,"BuildDiagnosticInfo:pasteParams.PastedHtml.FirstChild is null"):
xa.a.J(512356451,826,50,"BuildDiagnosticInfo:pasteParams.PastedHtml is null"):xa.a.J(512356480,826,50,"BuildDiagnosticInfo:pasteParams is null")}JJf(a){if(!(this.z9c&&a.firstChild&&a.firstChild.tagName&&"A"===a.firstChild.tagName.toUpperCase()&&a.firstChild.getAttribute(Lp.a.type)&&a.firstChild.getAttribute(Lp.a.Dlb)&&this.Qq.hr))return!1;const b=a.firstChild.className;return a.firstChild.getAttribute(Lp.a.sessionId).toString()===this.Qq.hr[0].sessionId&&b.startsWith("CID")&&b!==this.Qq.hr[0].D8a&&
(Object(Wa.a)(iA.a,this.Qq.hr[0])&&"shape"===a.firstChild.getAttribute(Lp.a.type).toString()&&this.Fzi(a.firstChild.getAttribute(Lp.a.Dlb).toString())||Object(Wa.a)(Xv.a,this.Qq.hr[0])&&"slide"===a.firstChild.getAttribute(Lp.a.type).toString()&&this.Hzi(a.firstChild.getAttribute(Lp.a.slideId).toString()))}Fzi(a){a=a.split(",");let b=0;if(a.length!==this.Qq.hr.length)return!1;for(const c of a)for(const f of this.Qq.hr)if(c===this.Ga.Vyb(f.shapeNode).toString()){b++;break}return b===a.length}P3d(a){let b=
!1;for(let c=0;c<this.wl.length;c++)if(this.wl[c].xQ(a)){b=!0;this.wl[c].paste(a);break}b||this.Ec.Mg(!1,a.Wb,19);return b}Mxl(a,b,c){if(a){const f=new nS.a("ShrinkImage",!0);a=this.sgc.$Ch(a,b,this.VCe);f.stop();if(a)return this.Mna.r_b("LoadAndShrinkImage"),this.Mna.flush(String.format("Browser={0}, Length={1}",this.Wo.iz,a.length)),Nc.a.Ak(hh.a.jLj,f.jba.toFixed(0)),Nc.a.Ak(hh.a.iLj,f.KQc.toFixed(0)),Nc.a.Ak(hh.a.kLj,a.length.toString()),this.qOe(a,c)}return!1}Y5i(a){this.P9c&&a&&(a=a.ownerDocument)&&
(a=a.getElementById(Lp.a.Xig))&&a.parentNode&&a.parentNode.removeChild(a)}hJl(a){let b,c;b=0;c=!1;if(a&&a.hn&&a.hn.firstChild&&a.hn.firstChild.getAttribute){var f=a.hn.firstChild;const l=f.getAttribute(Lp.a.Jp),y=this.Qq.hr;if(y&&0<y.length&&y[0]&&Sys.UI.DomElement.containsCssClass(f,y[0].D8a)){let H=!1;(this.aYa&&Object(Wa.a)(Xv.a,y[0])||this.BEb&&Object(Wa.a)(iA.a,y[0]))&&this.GYj(y)&&(this.iUj(l)?H=!0:(a.Cch=!1,xa.a.J(512356448,826,50,"Cannot use ClipService due to copy failure: ccpCorrId: {0}.",
a.Wb)),xa.a.J(512356447,826,50,"The copied graph nodes has been deleted, try to fall back to clip service; ccpCorrId: {0}, useClipService: {1}.",a.Wb,H));if(H)xa.a.J(512356446,826,50,"TryAttachClipboardObjects: Using clip service for ccpCorrId: {0} for in-session COPY/PASTE but actually use clip service to fulfill the request.",a.Wb),this.Qq.hr=null;else if(xa.a.J(512356445,826,50,"TryAttachClipboardObjects: Using internal objects for in-session COPY/PASTE for ccpCorrId: {0}.",a.Wb),a.aX=y,!eb.a("UseClipServiceForDestinationThemePaste"))return{returnValue:!0,
nZd:b,z6d:c}}else xa.a.J(512356444,826,50,"it is not an internal paste, use ClipService instead; ccpId: {0}, ccpCorrId: {1} .",l,a.Wb);f=this.Mx.y1i(f,a.Wb);b=f.TRa;c=1===f.dataType;if(this.Mx.B5j(f)&&void 0!==f&&null!==f&&32===f.DW)return a.Ku=f,xa.a.J(512356443,826,50,"This is IsValidClipServiceObject and copy action has succeeded, clipServiceObject.DataType {0}, pasteParams keepsource value {1} ",f.dataType,a.UA),{returnValue:!0,nZd:b,z6d:c};xa.a.J(512356442,826,10,"Failed to use clip service, ClipServiceObject: [{0}].",
f?f.toString():"(null)")}xa.a.J(512356441,826,50,"TryAttachClipboardObjects::Failed to attach ClipboardObjects.");return{returnValue:!1,nZd:b,z6d:c}}qKl(a,b){let c=!1;if(this.oma.fsg(a))if(a.length>=this.VCe)this.kud(b),c=!0;else{if(a=this.oma.wJl(a))this.Mna.r_b("ExtractDataUri"),this.Mna.flush(String.format("Browser={0}, Length={1}, IsFromBlob=true",this.Wo.iz,a.length));c=this.qOe(a,b)}return c}GYj(a){for(const b of a)if(b.$pg)return!0;return!1}iUj(a){if(this.yO.Vme)return xa.a.J(512356439,826,
50,"Cannot predict copy result due to incompletion"),!1;xa.a.J(512356440,826,50,"ccpId: {0}, LastCopyFailureCcpId: {1}.",a,this.yO.hug);return!!a&&a!==this.yO.hug}kud(a){this.Ec.Mg(!1,a,18);this.Ud.nH(60,null)}Tsl(){let a=!1;if(this.Fic&&0<this.Fic.length&&this.VJg){const b=this.Sea.getElementsByTagName(rb.a.n4);if(b){for(let c=0;c<b.length;c++){const f=b[c];if(f.src&&f.src.toLowerCase().startsWith("webkit-fake-url:")){a=!0;break}}xa.a.J(512356438,826,50,"Get image url in Safari "+(a?"Succeeded":
"Failed"))}}return a}}Ng.ySh=1048576;Ng.hEf=.75;Ng.Bui=5E3;Ng.DNk="PasteViaTriggeringEvent";Ng.objectCount="ObjectCount";Ng.isDataCompressed="IsDataCompressed";Ng.Tui="PastedObjectDataSize";Ng.tGf="ActionName";Ng.uGf="CcpMethod";Ng.Jti="PasteKeepingSourceFormatting";Ng.Hti="PasteKeepingDestinationTheme";Ng.Iti="PasteAsImage";Ng.XGf='data-clipservice-type="slide"';Ng.$ui='data-clipservice-type="shape"';Ng.aui="ContextMenu.PasteKeepingDestinationTheme";Ng.bvi="ContextMenu.PasteKeepingSourceFormatting";
Ng.cui="PasteKeepingDestinationTheme";Ng.dvi="PasteKeepingSourceFormatting";Ng.bui="PasteKeepingDestinationThemeMLR";Ng.cvi="PasteKeepingSourceFormattingMLR";Ng.lLc=20;Ng.Pui="PasteAsImageSLR";Ng.Oui="PasteAsImageMLR";Ng.Nui="ContextMenu.PasteAsImage";Ng.Sui="PasteTextOnlySLR";Ng.Rui="PasteTextOnlyMLR";Ng.Qui="ContextMenu.PasteTextOnly";Object(m.a)(Ng,"PasteManager",null,[369,107]);class BO{constructor(a,b){this.rAg=a;this.Ea=b}hBl(a,b,c,f,l){this.rAg.Y1(this.Ea.eAi,a,b,c,this.Ea.fAi,this.Ea.gAi,
this.Ea.hAi,f,l)}txi(a){this.rAg.sxi(a)}}Object(m.a)(BO,"PastedDataUploader",null,[365]);class UE{static create(a){const b=new UE;b.Prg=Yr.b(a,c=>c.isEditable);return b}}Object(m.a)(UE,"ShapeCopyPasteParams",null,[]);class CO{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye,Xd){if(!a)throw Error.argumentNull("selectionManager");if(!b)throw Error.argumentNull("clipboardTarget");if(!c)throw Error.argumentNull("lazyFocusManager");if(!l)throw Error.argumentNull("internalClipBoard");
if(!f)throw Error.argumentNull("activeSlideViewManager");if(!y)throw Error.argumentNull("ccpUtils");if(!H)throw Error.argumentNull("clipboardHelper");if(!Q)throw Error.argumentNull("clipServiceManager");if(!ia)throw Error.argumentNull("actionManager");if(!wa)throw Error.argumentNull("htmlExportProcessor");if(!Ua)throw Error.argumentNull("htmlExportUtils");if(!yc)throw Error.argumentNull("shapeReader");if(!tc)throw Error.argumentNull("clipboardTelemetry");if(!Vd)throw Error.argumentNull("pptFileReaderHelper");
if(!ye)throw Error.argumentNull("systemClipboard");if(!Xd)throw Error.argumentNull("browserHelperManager");if(!xd)throw Error.argumentNull("deferredContentManager");this.pa=a;this.Zg=b;this.n5=c;this.Qq=l;this.egc=f;this.oma=y;this.Mx=H;this.yO=Q;this.ia=ia;this.rik=wa;this.sik=Ua;this.Dgc=kb;this.Igc=Gb;this.A9c=ec;this.zAe=dc;this.PIa=Fc;this.Ga=yc;this.Ec=tc;this.Jw=xd;this.Tic=Vd;this.KAe=Ld;this.mHb=ye;this.ZGa=Xd}xQ(a){const b=this.pa.Qf();let c=!1;b&&0<b.length&&this.n5.value.C8===jb.a.vg&&
(a.dataType=2,c=a.sea?this.N1i(b):!this.pa.zVa());return c}N1i(a){let b=!0;for(const c of a){if(c.e3c&&!c.isLocal)return!0;c.DB||(b=!1)}return b}fta(a){w.AFrameworkApplication.uk("Microsoft.Office.Server.Powerpoint.Web.IPPTEditorPasteShapesWithEmbeddedClipServiceSettings");const b=this.pa.Qf();if(!b||!b.length)return this.Qq.hr=null,!1;var c;let f=({contentType:c}=this.oma.EXd(b)).returnValue;this.Ec.hC(c,a.Wb);a.sea?({Blb:f,returnValue:c}=this.NVi(b,a,f),f="Cut:"+f):({Blb:f,returnValue:c}=this.KVi(b,
a,f),f="Copy:"+f);this.Jw.Jfe(b,"DoCutCopy")&&(xa.a.J(509210822,826,50,"ShapeCutCopyHandler: DoCutCopy HasDeferredContentOnShape: True"),a.sea?this.Jw.Xra("ShapeCutCopyHandlerHasDeferredContentIsCut","true"):this.Jw.Xra("ShapeCutCopyHandlerHasDeferredContentIsCopy","true"));xa.a.J(509210821,307,50,f);return c}NVi(a,b,c){var f=!0;let l=[];for(const y of a)y.e3c&&l.push(y),y.DB||(f=!1);l=f?a:l;f=({Blb:c}=this.ZQh(l,l,!0,!0,c,b.Wb,f)).returnValue;this.VNf(l,b.sea);this.Igc&&this.YNf(a);return{returnValue:32===
this.ia.Ka(ea.a.iRf,2,f),Blb:c}}KVi(a,b,c){if(this.Dgc&&this.UUj(this.Jrj(),a))return{returnValue:!0,Blb:c};var f=[];for(const l of a)l.e3c&&f.push(l);f=({Blb:c}=this.ZQh(a,f,this.Dgc,!1,c,b.Wb)).returnValue;f.Ku&&this.ia.Ka(ea.a.XNf,2,f);this.VNf(a,b.sea);this.Igc&&this.YNf(a);return{returnValue:32===this.ia.processAction(ea.a.WNf,2),Blb:c}}UUj(a,b){if(!this.yO.Vme||a.length!==b.length)return!1;for(let c=0;c<b.length;c++)if(!a[c].id||!a[c].id.equals(b[c].id))return!1;return!0}lul(a){if(!a.length)return!0;
let b=0,c=0;for(let f=0;f<a.length;f++){const l=a[f];if(l.isLocal)return!0;!l.qj||l.get_isSVGBlipFilled()||l.isGif||b++;l.vd&&c++}return this.A9c?c===a.length:b+c===a.length}ljj(a){const b=[];for(const c of a)c&&(a=new iA.a(c),a.sessionId=this.PIa,b.push(a));return b}Jrj(){const a=[];if(this.Qq.hr&&this.Qq.hr.length)for(const b of this.Qq.hr){const c=Object(qa.a)(iA.a,b);if(c&&c.shapeNode)a.push(c.shapeNode);else return[]}return a}ZQh(a,b,c,f,l,y,H=!1){let Q=new $x(null,y,null);this.Qq.hr=this.ljj(a);
!c||this.lul(b)?(c&&(xa.a.J(509210820,307,50,"Clip service shapes cut/copy is throttled"),this.Ec.ji(zu.a.SKf,"true",y)),this.Mx.Ezd(this.Zg,this.Qq.hr,null,this.PIa,this.Uag(a),null,y)):(this.oma.dEh(b),c=this.yO.hOc(2,b.length,f,H),c.fmc=UE.create(b),this.zAe&&this.Jw.Jfe(a,f?"ShapeCutCopyHandler_DoCut":"ShapeCutCopyHandler_DoCopy")&&(c.TRa=1,c.DW=8),this.Ec.ji(zu.a.Jp,c.Jp,y),l+=String.format(", CcpId={0}",c.Jp),this.Mx.Ezd(this.Zg,this.Qq.hr,c,this.PIa,this.Uag(a),null,y),Q=new $x(c,y,b));return{returnValue:Q,
Blb:l}}Uag(a){const b=[];for(const c of a)Array.add(b,this.Ga.Vyb(c));return b}VNf(a,b){for(const c of a)if(c&&c.qj&&(a=Kj.c(c,this.egc.Jc.Na))&&!a.Nl&&(a=a.eRa))if(eb.a("FixForIpadImageCCP")){let f;this.KAe&&(f=this.Ycg(a));f||(f=a.getAttribute(Ui.a.y$b));f&&(a=f.toString())&&(a.startsWith("data:image/")?this.tUd(a,c):this.V7f(a,c,b))}else(a=this.KAe?this.Ycg(a):a.getAttribute(Ui.a.y$b))&&(this.KAe?this.V7f(a,c,b):this.tUd(a.toString(),c))}V7f(a,b,c){try{fetch(a).then(f=>{f.blob().then(l=>{this.Tic.plh(l,
y=>{y=y.target.result;c&&rb.a.S1b(this.Zg);this.tUd(y,b);this.ZGa.c1a(this.Zg);this.mHb.copy(this.Zg)})}).catch(l=>{xa.a.J(509207576,307,10,"ShapeCutCopyHandler::getImageDataFromGC2Url exception in getting blob from response: {0}",l.toString())})}).catch(f=>{xa.a.J(509207575,307,10,"ShapeCutCopyHandler::getImageDataFromGC2Url exception in fetching blob from url: {0}",f.toString())})}catch(f){xa.a.J(509210634,826,10,"ShapeCutCopyHandler::getImageDataFromGC2Url exception in fetching blob: {0}",f)}}Ycg(a){if((a=
a.querySelectorAll("image"))&&a.length&&(a=a[0].getAttribute("href")))try{if("blob:"===(new URL(a)).protocol)return a}catch(b){xa.a.J(509207881,826,10,"Exception {0} while converting to URL.",b)}return null}tUd(a,b){let c=rb.a.sB();c.src=a;b.get_shapeRotation()||this.oma.vll(c,b.Ix,b.jD);c.className+=this.Qq.hr[0].D8a;this.Zg.contentWindow.document.body.appendChild(c)}YNf(a){(a=this.sik.I9i(a,b=>!!b&&b.vd))&&0<a.length&&(a=this.rik.J9i(a))&&this.Zg.contentWindow.document.body.appendChild(a)}}Object(m.a)(CO,
"ShapeCutCopyHandler",null,[1163]);class qs{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb){this.Zg=b;this.n5=c;this.Qq=f;this.ta=l;this.ia=y;this.Mx=H;this.yO=Q;this.B9c=ia;this.zAe=wa;this.pa=a;this.PIa=Ua;this.Ec=kb;this.Jw=Gb}xQ(a){var b=this.n5.value.C8;if(b=!!this.ta.Ba&&!!b&&b===Oi.a.iE||b===jb.a.vg&&!this.pa.Xd().length||b===jb.a.lC)a.dataType=1;return b}fta(a){this.Ec.hC(19,a.Wb);return this.PQi(a)}get Nb(){return this.pa}PQi(a){var b=this.Nb.Se();if(!b||!b.length)return this.Qq.hr=null,ka.ULS.sendTraceTag(512497806,
826,10,"Tried to copy slides but no slides were selected."),!1;var c=qs.z5f(b,!0);if(!c.length)return a=this.kbg(b).join(","),ka.ULS.sendTraceTag(512497805,826,10,"Tried to copy slides but all of them were disconnected: '{0}'.",a),!1;b.length!==c.length&&(b=qs.z5f(b,!1),b=this.kbg(b).join(","),ka.ULS.sendTraceTag(512497804,826,15,"Tried to copy slides but some of them were disconnected: '{0}', ignore them and continue",b));var f=qs.getSlides(this.Qq),l=qs.TLi(this.PIa,c);this.Qq.hr=qs.vGl(l);b=(b=
c[0])?b.Db:null;const y=this.Jw.ZGj(c);this.B9c?this.z1e(f,l)?(xa.a.J(512497801,307,50,"Clip service slide copy is throttled for ccopCorrId: {0}",a.Wb),this.Ec.ji(zu.a.SKf,"true",a.Wb)):(f=this.yO.hOc(1,c.length,a.sea),c=new wE.a(f,a.Wb,c),this.Ec.ji(zu.a.Jp,f.Jp,a.Wb),l=8,y?this.zAe&&(f.TRa=1,f.DW=8):a.sea||(l=this.ia.Ka(ea.a.e0d,2,c),f.DW=l),this.Mx.Ezd(this.Zg,this.Qq.hr,f,this.PIa,null,b,a.Wb),!y&&a.sea&&(l=this.ia.Ka(ea.a.jRf,2,c)),xa.a.J(512497802,307,32!==l?10:50,"Clip service slide isCut: {0} status: {1} for ccpid: {2}",
a.sea,f.DW,f.Jp),a.sea?this.Jw.Xra("DeferredSlideCutStatus",f.DW.toString()):this.Jw.Xra("DeferredSlideCopyStatus",f.DW.toString())):(this.Mx.Ezd(this.Zg,this.Qq.hr,null,this.PIa,null,b,a.Wb),xa.a.J(576745568,307,15,"Clip service has been disabled. CcpCorId: {0}",a.Wb));return!0}kbg(a){return Ak.c(a,b=>b?b.Db.toString():null)}z1e(a,b){if(!b||!b.length||qs.Lmi(b))return!0;if(this.yO.Vme){if(!a||a.length!==b.length)return!1;for(let c=0;c<b.length;c++)if(!qs.cni(a[c],b[c]))return!1;return!0}return!1}static z5f(a,
b){const c=new Na.a;for(const f of a)f.isConnected===b&&c.add(f);return c.toArray()}static getSlides(a){const b=[];if(!a||!a.hr||!a.hr.length)return b;for(let c=0;c<a.hr.length;c++)b.push(Object(qa.a)(Xv.a,a.hr[c]));return b}static cni(a,b){return!a&&!b||!!a&&!a.gd&&!!b&&!b.gd||!!a&&!!a.gd&&!!b&&!!b.gd&&(!a.gd.id&&!b.gd.id||!!a.gd.id&&!!b.gd.id&&a.gd.id.equals(b.gd.id))}static Lmi(a){for(let b=0;b<a.length;b++)if(a[b]&&a[b].gd&&!Va.a.Cw(a[b].gd.Db))return!1;return!0}static vGl(a){const b=[];for(const c of a)b.push(c);
return b}static TLi(a,b){const c=[];for(const f of b)c.push(Object.assign(new Xv.a(f),{sessionId:a}));return c}}Object(m.a)(qs,"SlideCopyHandler",null,[1163]);class DO{constructor(a,b,c,f){this.Ima=this.uye=!1;this.cZb=null;this.ZGa=a;this.$qk=b;this.cfc=c;this.Ec=f}get gN(){this.cZb||(this.cZb=this.$qk.create());return this.cZb}get w6d(){return this.Ima}Cda(a){this.gN.Cda(a)}u8a(a){this.gN.u8a(a)}get u6(){return this.gN.u6}get ty(){return this.gN.ty}prepareForPaste(a,b){this.Ima=!0;this.gN.prepareForPaste(b,
a,this.cfc.cDa.contentWindow.document)}Oda(a,b,c){this.Ima=!0;this.gN.Oda(a,b,c);this.Ima=!1}reset(){this.Ima=!1}AIl(a,b){if(!this.GMa(a,b))return!1;try{const c=a.contentWindow.document;let f=c.body;Ea.a.vv(f);this.gN.S9a(c,f);return!0}catch(c){xa.a.J(512497800,826,10,"TriggerPasteRequest: We failed to generate the system clipboard event, even though we thought we had access!")}return!1}paste(a,b,c){let f;f="";b.vf(jb.a.vg);if(!this.GMa(a,c)&&(null==this.ty||null!=this.ty&&!this.ty))return{returnValue:!1,
content:f};b=a.contentWindow.document;let l=b.body;this.Ima=!0;Ea.a.vv(l);let y=!1;try{this.ZGa.c1a(a),l=this.gN.S9a(b,l),f=l.innerHTML,y=!0}catch(H){this.o9b(c)}this.Ima=!1;return{returnValue:y,content:f}}copy(a){a.contentWindow.focus();this.Ima=!0;let b;try{this.gN.PRc(a.contentWindow.document),b=!0}catch(c){b=!1}this.Ima=!1;return b?!0:!1}GMa(a,b){if(this.uye)return!0;this.Ima=!0;let c=!1;try{c=this.gN.GMa(a.contentWindow.document.body,()=>{Ea.a.vv(a.contentWindow.document.body)},()=>{this.ZGa.c1a(a)})}catch(f){}this.Ima=
!1;c?this.uye=!0:z.a.Wj||null==this.ty||this.ty||this.o9b(b);return c}o9b(a){this.uye=!1;Eq.instance.vvb(null,null);this.Ec.Mg(!1,a,29)}}Object(m.a)(DO,"SystemClipboard",null,[366]);class EO{constructor(a,b,c,f,l,y,H,Q){this.aBe=!0;this.fEg=!1;l.pptOfflineModeEnabled&&a.cTd(Object(I.a)(this,this.YIb,"onNetworkHealthStateChanged"));this.Ur=b;this.ia=c;this.N0=f;this.la=l;this.YO=y;this.oM=H;this.ta=Q;this.SG=0;this.dfb=!1;this.q6c=0;this.OLg=new Date}get status(){return this.SG}YIb(a,b){this.aBe=b.Doe;
this.fEg||this.Nwh(this.aBe,"NetworkHealthStateChanged")}d2f(a){this.fEg=!a;this.aBe&&this.Nwh(a,"PodSeamlessFailoverManager")}Nwh(a,b){a&&this.dfb&&(this.N0.Qtc=!1,this.SG=1,this.YO.PA());const c=!a,f=this.q6c+1;il.a.instance.Hb(new dd.a(2,1,c?this.la.switchToOfflineDelayInMs:this.la.switchToOnlineDelayInMs,()=>{this.y1a(c,f)},90,"107"));this.q6c++;ka.ULS.sendTraceTag(508913122,813,50,Me.c({["Current state"]:this.dfb.toString(),["Received signal"]:a.toString(),["Change id"]:f.toString(),["State change source"]:b}))}y1a(a,
b){this.q6c===b&&this.dfb!==a&&(this.N0.Qtc=a,a&&3!==this.ia.mode||((this.dfb=a)?(this.SG=2,this.YO.PA(),this.oM.eX(this.ta.presentation)&&this.N0.show(0,-1)):(this.SG=0,this.N0.dismiss(),this.YO.PA()),eb.a("PersistSelectionInOfflineMode")?this.Ur.Zkb(a,!0):this.Ur.y1a(a),ka.ULS.sendTraceTag(508913121,813,50,"PPTO switches to {0}. The change id is {1} and the last state switching time is {2}",a?"Offline":"Online",this.q6c,Nc.a.uf(this.OLg)),this.OLg=new Date))}}Object(m.a)(EO,"PPTOfflineManager",
null,[387]);class FO{luc(a,b,c){yE.a(a,b,c)}}Object(m.a)(FO,"WarningDialogProxy",null,[362]);var oS=d(277);class hy extends bi.a{constructor(a,b,c,f,l,y,H,Q,ia){super();this.S7c=!1;this.Aec=null;this.vfb=0;this.mad=this.uhc=this.jad=this.gad=this.Ycd=this.qad=this.r7c=this.ffd=this.wYa=this.sCe=this.NCe=this.Y0=this.m5=null;this.Fna=a;this.Ohc=b;this.JJ=c;this.glk=f;this.Sdk=l;this.bhk=ia;this.Fa=y;this.jZg=Q;this.oc=H}dispose(){this.sCe=this.NCe=this.Y0=this.m5=null;super.dispose()}XBh(a){this.BMh();
this.pj(a,Object(I.a)(this,this.QYi,"endDialogHandler"),{["MasterId"]:0,["LayoutId"]:0})}Ouh(a){if(a)for(let b=0;b<this.wYa.length;b++){const c=document.getElementById(this.wYa[b]);if(parseInt(c.getAttribute("LayoutId"))===a){this.TMb(c);break}}}Bu(){super.Bu();rb.a.$d().appendChild(this.VLi());const a=document.getElementById(this.Uh("WACDialogPanel"));a&&a.removeAttribute(Ve.a.Rca)}VA(){super.VA();var a=document.getElementById(this.Uh("WACDialogPanel"));a.style.width=rb.a.Pc(532);a=parseInt(af.a.rt(a).top);
this.m5.style.height=rb.a.Pc(Math.min(Math.max(0,Dl.a.hP-a-100),398));this.sg=this.m5.parentNode.innerHTML}r8(){super.r8();this.NCe=document.getElementById("MasterId");this.sCe=document.getElementById("LayoutId");this.uhc=Object(I.a)(this,this.Ycb,"keyPressHandler");w.AFrameworkApplication.Aa.zG.Bod(oa.a.Bf,window.document,this.uhc,null);this.gad=Object(I.a)(this,this.i8j,"layoutClickHandler");this.jad=Object(I.a)(this,this.j8j,"layoutDoubleClickHandler");this.mad=Object(I.a)(this,this.l8j,"layoutOnFocus");
for(let a=0;a<this.wYa.length;a++){const b=document.getElementById(this.wYa[a]);this.Hn.rb(oa.a.click,b,this.gad);this.Hn.rb(oa.a.doubleClick,b,this.jad);hd.a.addHandler(b.firstChild,"focus",this.mad)}}Ysa(){super.Ysa();this.uhc&&w.AFrameworkApplication.Aa.zG.F8e(oa.a.Bf,window.document,this.uhc);this.uhc=null;for(let a=0;a<this.wYa.length;a++){const b=document.getElementById(this.wYa[a]);this.Hn.Bb(oa.a.click,b,this.gad);this.Hn.Bb(oa.a.doubleClick,b,this.jad);hd.a.removeHandler(b.firstChild,"focus",
this.mad)}this.mad=this.jad=this.gad=null}VLi(){if(this.m5)return this.m5;this.m5=rb.a.$d();this.m5.id="LayoutPickerDiv";this.m5.className="LayoutPicker";this.vfb=0;this.wYa=[];var a=this.Ohc.length;if(!a||1===a&&!this.Ohc[0].InContent)return xa.a.J(509654401,822,10,"Legacy LayoutDialog:: Master not loaded."),this.m5;var b=0;let c=!1;for(var f=0;f<a;f++)this.Ohc[f].Id===this.glk&&(b=f,c=!0);c&&this.cxf(this.Ohc[b],1!==a);for(f=0;f<a;f++)c&&f===b||this.cxf(this.Ohc[f],1!==a);a=rb.a.wOc();a.id="MasterId";
a.type="hidden";b=rb.a.wOc();b.id="LayoutId";b.type="hidden";this.m5.appendChild(a);this.m5.appendChild(b);return this.m5}cxf(a,b){a.InContent&&this.JJ.Fb(a.Id)&&(b&&this.m5.appendChild(this.nMi(a)),this.m5.appendChild(this.jKi(a)))}nMi(a){const b=rb.a.$d();b.className="MasterSlideTitleBar";b.innerText=a.Name;return b}jKi(a){const b=a.Id;a=a.ContentMasters;if(!this.JJ.Fb(b))return null;const c=this.JJ.ga(b),f=rb.a.$d();f.className="LayoutTableContainer";var l=rb.a.oQf();const y=rb.a.iPi();let H=null;
f.appendChild(l);l.appendChild(y);l=this.Fna.width;let Q=this.Fna.height,ia;l||(l=1);Q||(Q=1);ia=Q/l*145;let wa=0;const Ua=a.length;for(var kb=0;kb<Ua;kb++)!this.jZg&&this.oc.Zbb(a[kb])||wa++;kb=1;for(let yc=0;yc<Ua;yc++){var Gb=a[yc];if(!this.jZg&&this.oc.Zbb(Gb))continue;1===kb%3&&(H=rb.a.x1d(),y.appendChild(H));var ec=Gb.Id.toString();const tc=Gb.Name,xd=rb.a.MOc();xd.id="Layout"+this.vfb;xd.setAttribute("LayoutIndex",this.vfb);xd.setAttribute("MasterId",b);xd.setAttribute("LayoutId",ec);xd.setAttribute(Ve.a.hf,
Ve.a.iQ);Array.add(this.wYa,xd.id);var dc=null;if(ec=!!c.LayoutIcons&&c.LayoutIcons.length>yc&&!!c.LayoutIcons[yc].Icon){dc=-1;for(var Fc=0;Fc<c.LayoutIcons.length;Fc++)if(c.LayoutIcons[Fc].LayoutId===Gb.Id){dc=Fc;break}-1===dc&&(dc=yc);dc=c.LayoutIcons[dc].Icon;Fc=new oS.a(dc.Clip.Bounds.Left,dc.Clip.Bounds.Top,145,ia);Gb=rb.a.sB();Gb.src=Ib.a.instance.resolve("PPTe.IResourceViewElementResolver").resolve(Dh.a.rwb,dc.ImgId,"LayoutPicker");Gb.title=tc;Gb.style.clip=this.G1k(Fc);Gb.style.left=rb.a.Pc(-Fc.o3a);
Gb.style.overflow=wf.a.Xs;Gb.style.position=wf.a.oba;Gb.style.top=rb.a.Pc(-Fc.p3a);Gb.style.zIndex="0";l<Q&&(Gb.style.height=rb.a.Pc(ia));Gb.setAttribute(Ve.a.hf,Ve.a.$Qa);dc=document.createElement("span");dc.style.width=rb.a.Pc(145);dc.style.height=rb.a.Pc(ia);dc.setAttribute("Unselectable","on");dc.style.zIndex="0";dc.style.overflow=wf.a.Xs;dc.style.display=wf.a.aCl;dc.style.position=wf.a.Ouc;dc.appendChild(Gb);dc.setAttribute(Ve.a.HI,Ve.a.lB)}Gb=rb.a.$d();Gb.id="title_Layout"+this.vfb;Gb.className=
"LayoutTitle LayoutTitleHighContrast";Gb.innerText=tc;Fc=rb.a.kda();Fc.setAttribute("tabindex","0");Fc.setAttribute("onclick","return false;");Fc.setAttribute("unselectable","on");Fc.setAttribute(Ve.a.er,tc);Fc.setAttribute(Ve.a.hf,Ve.a.$Qa);Fc.setAttribute(Ve.a.tVd,kb);Fc.setAttribute(Ve.a.uVd,wa);ec&&Fc.appendChild(dc);Fc.appendChild(Gb);H.appendChild(xd);xd.appendChild(Fc);this.vfb++;kb++}Ua%3&&(this.vfb+=3-Ua%3);return f}G1k(a){let b;b="rect( "+(rb.a.Pc(a.p3a)+", ");b+=rb.a.Pc(a.cTh)+", ";b+=
rb.a.Pc(a.dTh)+", ";return b+=rb.a.Pc(a.o3a)+")"}QYi(a,b){this.S7c&&(Nc.a.Rub(this.Aec),this.S7c=!1,this.Aec=null);1===a&&this.Sdk(b.MasterId,b.LayoutId)}l8j(a){a=a.target.parentNode;this.Y0&&a.id===this.Y0.id||this.TMb(a)}Ycb(a){a=a.mc;var b=this.Vlj(a);if(b===B.a.RRb)return!0;if(b===B.a.Dp)return(a=this.Fa.Ll())&&"WACDialogCancelButton"!==a.Dj.q_.id?(this.Vqa(1),this.hide(),!0):!1;a.preventDefault();if(!this.Y0)return a=document.getElementById("Layout0"),this.TMb(a),!0;a=parseInt(this.Y0.getAttribute("LayoutIndex"));
b=this.Vjj(b);for(let c=0;c<b.length;c++){const f=document.getElementById("Layout"+(a+b[c]));if(f){this.TMb(f);break}}return!0}Vlj(a){let b=B.a.RRb;switch(a.keyCode){case B.a.n2:b=B.a.n2;break;case B.a.m2:b=B.a.m2;break;case B.a.qS:b=B.a.qS;break;case B.a.BP:b=B.a.BP;break;case B.a.Dp:b=B.a.Dp}this.bhk&&(b===B.a.BP?b=B.a.qS:b===B.a.qS&&(b=B.a.BP));return b}Vjj(a){let b=[0];switch(a){case B.a.n2:if(!this.ffd)for(this.ffd=Array(3),a=0;3>a;a++)this.ffd[a]=-3-a;b=this.ffd;break;case B.a.qS:if(!this.qad)for(this.qad=
Array(3),a=0;3>a;a++)this.qad[a]=-1-a;b=this.qad;break;case B.a.BP:if(!this.Ycd)for(this.Ycd=Array(3),a=0;3>a;a++)this.Ycd[a]=a+1;b=this.Ycd;break;case B.a.m2:if(!this.r7c)for(this.r7c=Array(3),a=0;3>a;a++)this.r7c[a]=3-a;b=this.r7c}return b}i8j(a){this.TMb(a.IC);return!0}j8j(a){a=a.IC;a!==this.Y0&&this.TMb(a);this.Vqa(1);this.hide();return!0}TMb(a){this.BMh();this.Y0=a;const b=this.Fa.Ll();b?b.Dj.mF(a.firstChild):xa.a.J(509654368,807,10,"LayoutDialog::SelectElement cannot find current FocusRegion");
Sys.UI.DomElement.addCssClass(this.Y0,"Selected");this.INl();this.S7c=!0;this.Aec||(this.Aec=Nc.a.bba(Object(I.a)(this,this.vgl,"selectElement_Finish"),0))}vgl(){this.Y0&&this.Rfl(this.Y0);this.S7c=!1;this.Aec=null}BMh(){this.Y0&&(Sys.UI.DomElement.removeCssClass(this.Y0,"Selected"),this.Y0=null)}Rfl(a){const b=document.getElementById("LayoutPickerDiv");if(b){var c=b.scrollTop,f=b.offsetHeight,l=rb.a.W6g(b,a)._y,y=a.offsetHeight;l<c?3>a.getAttribute("LayoutIndex")?b.scrollTop=0:b.scrollTop=l:(a=f+
c,l=y+l,l>a&&(b.scrollTop=c+(l-a)))}}INl(){this.NCe.value=this.Y0.getAttribute("MasterId");this.sCe.value=this.Y0.getAttribute("LayoutId")}}Object(m.a)(hy,"LayoutPicker",bi.a,[]);class GO extends hy{constructor(a,b,c,f,l,y,H,Q,ia){super(a,b,c,f,l,y,H,Q,ia)}dispose(){super.dispose()}mud(a){this.XBh(ResourceStrings.l_NewSlideTitle);this.Ouh(a)}Bu(){this.Oe(1,ResourceStrings.l_AddSlide);super.Bu()}}Object(m.a)(GO,"AddSlideDialog",hy,[1170]);class HO extends hy{constructor(a,b,c,f,l,y,H,Q,ia){super(a,
b,c,f,l,y,H,Q,ia)}dispose(){super.dispose()}mud(a){this.XBh(ResourceStrings.L_SlideLayoutDialog);this.Ouh(a)}Bu(){this.Oe(1,ResourceStrings.L_ChangeLayout);super.Bu()}}Object(m.a)(HO,"ChangeLayoutDialog",hy,[1170]);class IO{constructor(a,b){this.Fa=a;this.oc=b}D0d(a,b,c,f,l,y,H,Q){switch(a){case 1:return new GO(b,c,f,l,y,this.Fa,this.oc,H,Q);case 0:return new HO(b,c,f,l,y,this.Fa,this.oc,H,Q);default:return null}}}Object(m.a)(IO,"DialogFactory",null,[1162]);class JO{constructor(a,b,c,f,l){this.Jna=
null;this.ia=a;this.DM=b;this.Us=c;this.FO=f;this.Up=l;this.DM.h8(Object(I.a)(this,this.$mc,"onShapeDisconneted"));this.Us.zTd(Object(I.a)(this,this.fnc,"onSlideBackgroundClicked"));this.Us.aii(Object(I.a)(this,this.hbh,"onShapeViewElementBackgroundClicked"))}Efh(a){if(!a)throw Error.argumentNull("template");this.Jna=a;xa.a.J(18368227,822,50,"FormatPainter::PickupFormat Template shape {0}",a.get_shapeId());this.FO.c0=!0}Lli(a){if(!a)throw Error.argumentNull("target");let b=!1;!this.Jna||a.id.equals(this.Jna.id)?
b=!0:a.get_isSVGBlipFilled()&&(this.Jna.Hx||!this.Jna.Pla&&!this.Jna.get_isSVGBlipFilled())&&(b=!0);b?this.uRa():(xa.a.J(18368260,822,50,"FormatPainter::ApplyFormat Template shape {0} Target shape {1}",this.Jna.get_shapeId(),a.get_shapeId()),this.ia.Ka(ea.a.B8d,2,new gA(this.Jna,a)))}uRa(){this.isActive&&(xa.a.J(18368262,822,50,"FormatPainter::CancelFormat"),this.Jna=null,this.FO.c0=!1)}dispose(){this.DM.hLa(Object(I.a)(this,this.$mc,"onShapeDisconneted"));this.Us.nph(Object(I.a)(this,this.fnc,"onSlideBackgroundClicked"));
this.Us.S8k(Object(I.a)(this,this.hbh,"onShapeViewElementBackgroundClicked"))}$mc(a,b){b.node===this.Jna&&this.uRa()}fnc(){const a=this.isActive;this.uRa();this.Up&&a&&this.ia.processAction(C.a.Bka,2)}hbh(a,b){this.isActive&&this.Lli(b.$w.shapeNode)}get isActive(){return this.FO.c0}get SEl(){return this.Jna}}Object(m.a)(JO,"FormatPainter",null,[384,107]);var pS=d(1192),jA;(function(a){a[a.unsaved=0]="unsaved";a[a.rightClickThumbnailPanel=1]="rightClickThumbnailPanel";a[a.rightClickCanvas=2]="rightClickCanvas";
a[a.clickObjectOnCanvas=3]="clickObjectOnCanvas";a[a.tokenRefresh=4]="tokenRefresh";a[a.clipServiceCopy=5]="clipServiceCopy"})(jA||(jA={}));Object(m.b)("OfflineModalCalloutTrigger",jA);class KO{constructor(a){this.Io=null;this.Qtc=!1;this.Vb=a;a=document.createElementNS(Ui.a.L4e,"polyline");a.setAttribute(Ui.a.Wfh,"1,1 15,14 30,1");a.setAttribute(Ui.a.gvd,"rgb(234,234,234)");a.setAttribute(Ui.a.$3e,"2");a.setAttribute(Ui.a.k7d,"white");a.setAttribute(Ui.a.Z3e,"bevel");this.Yte=new nn.a;this.Yte.ah(32,
16);this.Yte.va.appendChild(a);this.vec=document.createElement("p");this.vec.innerText=CommonUIStrings.l_ModalCalloutContentWhenDisconnected;this.vec.style.width="258px";this.vec.style.color="black";this.vec.style.fontSize="14px"}dismiss(){this.Io&&(this.Io.dismiss(),this.Io=null)}show(a,b){ka.ULS.sendTraceTag(512497097,813,50,"OfflineModalCallout.Show is triggered by {0}",jA[a]);if(this.Qtc){if(this.Io){if(this.Io.TL)return;this.Io.dispose()}let c=null;c=document.querySelector("[data-unique-id='GetOfflineStatus']");
eb.a("OfflineModalCalloutCrashFix")&&!c?ka.ULS.sendTraceTag(512497096,813,10,"[Offline Modal Callout] Call out not shown as top element is null"):(a=Bd.a.ki(c),this.Io=pS.a.Y0d(a,c,this.Vb.Zud,2),this.Io.h_=4,0<b&&(this.Io.p6e=b),this.Io.Ir=!0,this.Io.content=this.vec,this.Io.vZd=()=>{ka.ULS.sendTraceTag(512497095,813,50,"The user clicks the button to close the callout.");this.Io&&(this.Io.dispose(),this.Io=null)},this.Io.Pjd=()=>{if(this.Io&&this.Io.content){this.Io.content.parentNode.style.width=
"258px";this.Io.bK.style.borderColor="rgb(234,234,234)";for(var f=this.Io.Ftb;f.firstChild;)f.removeChild(f.firstChild);f.appendChild(this.Yte.va);this.Io.J_e()}else ka.ULS.sendTraceTag(512497094,813,50,"callout content is empty in OnShowCallback")},this.Io.show(),ka.ULS.sendTraceTag(512497093,813,50,"Display the callout control"))}}}Object(m.a)(KO,"OfflineModalCallout",null,[386]);var LO=d(297),kA=d(212);class MO{constructor(a,b,c){this.kh=this.GO=this.yb=null;this.Ab=!0;this.ua=a;this.veb=b;this.tDe=
a.Uwb?a.Lea:null;this.pfa=c}dispose(){this.pfa&&this.GO&&($removeHandler(this.GO.va,"error",Object(I.a)(this,this.V9g,"onImageLoadError")),this.GO.dispose(),this.GO=null);this.yb&&this.yb.Dq();this.GO=this.kh=this.yb=null;this.tDe&&(this.veb.revokeObjectURL(this.tDe),this.tDe=null)}xm(a){this.yb=new Qz.a;this.yb.npa(Ki.a.l4e);a.appendChild(this.yb.viewport);this.GO=new LO.a;this.GO.Zj(0);this.yb.appendChild(this.GO);this.GO.Yw(this.ua.Lea);$addHandler(this.GO.va,"error",Object(I.a)(this,this.V9g,
"onImageLoadError"));a=this.ua.Jn;const b=fj.a.UIh(a);this.GO.setPosition(a.ic,a.kc);this.GO.ah(b.width,b.height);this.GO.Sd(!0);this.kh=new cm.a;this.kh.Zj(1);this.kh.setVisibility(!1);this.kh.va.setAttribute("class","ShapeMoveHandle");this.kh.Sd(!0);this.kh.Jt(a.points);this.kh.$aa("cursor: move");this.yb.appendChild(this.kh);this.yb.em()}V9g(){xa.a.J(34182307,826,15,"Locally rendered a broken image, IsPastingPicture={0}",this.ua.Ccb)}setPosition(a,b){this.yb.setPosition(a,b)}iC(){}Ij(a){this.yb.Ij(a)}vq(a){this.yb.fF(a,
kA.a.Wca)}Eu(a){this.yb.fF(a,kA.a.eub)}setZIndex(a){this.yb.jC(a)}my(){}aD(){return null}QA(){return[]}draw(){}JD(){}Mp(){return this.Ab?this.yb.Mp():null}get visible(){return this.Ab}set visible(a){this.Ab=a;this.yb.Sd(this.Ab)}get uq(){return this.kh}get we(){return this.yb}KL(a){return a.Bc===this.uq.va}Xw(){}setSelection(){}}Object(m.a)(MO,"LocalImageView",null,[1169,239,240,107]);class NO{constructor(a,b){this.veb=a;this.Eik=b}create(a){return new MO(a,this.veb,this.Eik)}}Object(m.a)(NO,"Factory",
null,[379]);class OO{constructor(a){this.Ab=!0;this.dXa=this.PXa=this.yb=null;this.Yd=a}dispose(){this.yb&&this.yb.Dq();this.PXa=this.dXa=this.yb=null;this.Ab=!1}xm(a){this.yb=new Qz.a;this.yb.npa(Ki.a.l4e);a.appendChild(this.yb.viewport);this.dXa=new cm.a;this.yb.appendChild(this.dXa);this.dXa.eF(Ui.a.none);a=this.Yd.shapeNode.Jn;this.dXa.dv(se.a.T1);this.dXa.ur(se.a.hF);this.dXa.spa("2,2");this.dXa.Jt(a.points);this.PXa=new LO.a;this.PXa.Zj(0);this.yb.appendChild(this.PXa);this.PXa.Yw($a.a.JN(se.a.Foa));
a=fj.a.UIh(a);const b=se.a.HKb,c=se.a.vmd;this.PXa.setPosition(a.width/2-b/2,a.height/2-c/2);this.PXa.ah(b,c);this.PXa.Sd(!0);this.yb.em()}setPosition(a,b){this.yb.setPosition(a,b)}iC(){}Ij(){}vq(a){this.yb.fF(a,kA.a.Wca)}Eu(a){this.yb.fF(a,kA.a.eub)}setZIndex(a){this.yb.jC(a)}my(){}aD(){return null}QA(){return[]}draw(){}JD(){}Mp(){return this.Ab?this.yb.Mp():null}get visible(){return this.Ab}set visible(a){this.Ab=a;this.yb.Sd(this.Ab)}get we(){return this.yb}KL(){return!1}Xw(){}setSelection(){}}
Object(m.a)(OO,"ShapeProgressIndicatorView",null,[1168,239,240,107]);class PO{create(a){return new OO(a)}}Object(m.a)(PO,"Factory",null,[380]);var rs=d(329);class VE{constructor(){this.oz=null;this.ysa=this.GN=this.zsa=0;this.startTime=this.umd=this.ot=this.VH=this.bD=this.V5b=null}Ylc(){return this.GN<this.oz.NL?Object.assign(new VE,{oz:this.oz,zsa:this.GN,GN:this.GN+Math.min(this.ysa,this.oz.NL-this.GN),ysa:this.ysa,V5b:this.V5b,bD:this.bD,VH:this.VH,ot:this.ot,umd:this.umd}):null}}Object(m.a)(VE,
"ChunkUploadingContext",null,[]);var ss=d(514);class dw{constructor(a,b,c,f){this.zf=this.TJ=this.NH=null;this.thc=b;this.zec=c;this.fgb=f;this.wb=a}get M9(){return!!this.NH}Y1(a,b,c,f,l,y,H,Q=null,ia=null){this.M9?H(new ss.a(Object.assign(new rs.a,{Code:59}))):(ia&&ia.register(Object(I.a)(this,this.abort,"abort")),0<l&&(this.TJ=Object.assign(new dd.a(2,1,l,Object(I.a)(this,this.PM,"onTimeout"),90,"85"),{customData:H}),this.wb.Hb(this.TJ)),(this.NH=Object.assign(new VE,{oz:a,V5b:c,zsa:0,GN:0,ysa:b,
bD:f,VH:y,ot:H,umd:Q,startTime:new Date}).Ylc())?this.jRb(this.NH):H(new ss.a(Object.assign(new rs.a,{Code:92}))))}jRb(a){this.thc();if(this.zec()||!this.M9)this.reset();else{this.O_a();var b=a.oz,c=a.bD,f=a.zsa,l=a.GN,y=a.ysa,H=!f&&l===b.NL,Q=new FormData;Q.append("Type","2");Q.append("FileName",a.oz.fileName);c&&Q.append("ImageToken",c);Q.append("Content-Range","bytes "+f+"-"+(l-1)+"/"+b.NL);xa.a.J(34420808,818,50,"ChunkedPictureUploader::UploadChunk - upload chunkStart:{0}, chunkEnd:{1}, chunkSize:{2}, fileSize:{3}",
f,l,y,b.NL);this.zf.onreadystatechange=()=>{this.zf&&4===this.zf.readyState&&this.lLe(a,this.zf.status)};b=H?a.V5b:a.V5b.slice(f,l);Q.append("chunk",b);this.zf.send(Q)}}lLe(a,b){let c=Object.assign(new rs.a,{Code:94});if(200===b){this.fgb.Rwc(this.zf.getResponseHeader(dw.WXd));b=a.umd;let f=null;try{f=Sys.Serialization.JavaScriptSerializer.deserialize(this.zf.responseText)}catch(l){xa.a.J(34420810,818,10,"ChunkedPictureUploader::UploadChunk - failed to deserialize response {0}",l)}if(f&&!f.Error&&
f.Result){const l=f.Result;a.bD=l.ItemId;const y=a.Ylc();a.zsa===l.XOffset&&l.ItemId?y?(b&&b.iGk(100*a.GN/a.oz.NL,!1),c=null,this.jRb(y)):(b&&b.iGk(100,!0),c=null,xa.a.J(34420812,818,50,"ChunkedPictureUploader::UploadChunk - upload completed, duration:{0}",+new Date-+a.startTime),this.reset(),a.VH(new Sm.a(f.Result))):c.Code=152}else f&&f.Error&&(c=f.Error)}else xa.a.J(34869445,818,10,"ChunkedPictureUploader::UploadChunk - upload failed, status:{0}, imageToken:{1}",b,a.bD||"");c&&(this.reset(),a.ot(new ss.a(c)))}O_a(){this.zf=
new XMLHttpRequest;this.zf.open("POST",this.fgb.Hab(),!0);w.AFrameworkApplication.accessToken&&(this.zf.setRequestHeader("X-AccessToken",w.AFrameworkApplication.accessToken),this.zf.setRequestHeader("X-AccessTokenTtl",w.AFrameworkApplication.b8.toString()));w.AFrameworkApplication.canary&&this.zf.setRequestHeader(dw.hxi,w.AFrameworkApplication.canary)}PM(a){xa.a.J(34420816,818,15,"ChunkedPictureUploader::OnTimeout - upload timeout");this.TJ=null;this.abort();(a=a.customData)&&a(new ss.a(Object.assign(new rs.a,
{Code:299})))}abort(){if(this.M9){xa.a.J(34420818,818,15,"ChunkedPictureUploader::Aborting upload");const a=this.zf;this.reset();a&&a.abort()}}reset(){this.TJ&&(this.wb.Lg(this.TJ),this.TJ=null);this.NH=this.zf=null}}dw.hxi="X-Key";dw.WXd="X-NewKey";Object(m.a)(dw,"ChunkedPictureUploader",null,[361]);class QO{constructor(a,b,c,f){this.wb=a;this.khk=b;this.sgc=c;this.UCe=f.pptEditingImageMaxSizeInBytes;this.FMg=Math.floor(.75*this.UCe);this.llk=52428800;this.eKg=f.tmg&&f.Ame;this.Bgc=f.Ame;this.Q9c=
f.NWj;this.jhc=f.Pqg}get ilc(){return this.eKg?this.llk:this.FMg}get Mtc(){return this.Bgc}get Etd(){return this.Q9c}Q2b(a,b){if(b)if(a&&1===a.length){const c=a[0];c.size<this.FMg?this.convertToBase64AndCallback(a,b):this.eKg?this.shrinkToBase64AndCallback(c,b):b(null)}else b(null)}convertToBase64AndCallback(a,b){const c=this.khk.create();this.Bgc?c.NJl(a,f=>{let l=f&&0<f.length?f[0]:null;l&&l.length>=this.UCe&&(l=null);this.jhc?b(l):this.wb.Hb(new dd.a(2,1,0,()=>{b(l)},90,"83"))}):c.CKh(a,b)}shrinkToBase64AndCallback(a,
b){this.sgc.uvg(a,c=>{const f=this.sgc.$Ch(c,a.size,this.UCe);this.jhc?b(f):this.wb.Hb(new dd.a(2,1,0,()=>{b(f)},90,"84"))})}}Object(m.a)(QO,"PPTProcessImageStrategy",null,[1013]);var qS=d(1161);class lA{static get sg(){return bi.a.VC(lA.Fo,ResourceStrings.l_ImageUploadMessage,ResourceStrings.l_NoImageSpecifiedErrorMessage)}}lA.Fo="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='block2'> <input type='file' id='fileInput' name='fileInput' class='WACDialogInputFile'/> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";
Object(m.a)(lA,"InsertImageDialogHtml",null,[]);class RO extends bi.a{constructor(a){super();this.Wl=null;this.ow=[];this.NB=a;this.auf=!1;this.WXa=w.AFrameworkApplication.fa.ka("InsertLocalPictureMultiSelectionEnabled")}mwl(a){this.sg=lA.sg;this.Oe(1,ResourceStrings.L_Insert);this.showDialog(ResourceStrings.L_InsertPicture,Object(I.a)(this,this.TPj,"insertImageDialogHandler"));if(this.Wl=document.getElementById("fileInput"))this.Wl.setAttribute("accept","image/*"),this.WXa&&a&&this.Wl.setAttribute("multiple",
"multiple");a=[];this.Wl&&(hd.a.addHandler(this.Wl,oa.a.Bf,Object(I.a)(this,this.onKeyDown,"onKeyDown")),a.push(this.Wl));var b=this.lUc(1);b&&a.push(b);(b=this.lUc(0))&&a.push(b);this.ow=a;this.bPl()}validate(){const a=this.NB.dzd(this.Wl.value);if(0!==a){const b=document.getElementById("errorText");b.innerText=this.NB.Mgj(a);b.style.display="inline-block";return!1}return!0}dispose(){this.Wl&&hd.a.removeHandler(this.Wl,oa.a.Bf,Object(I.a)(this,this.onKeyDown,"onKeyDown"));super.dispose()}TPj(a){1===
a&&this.NB.UFk(this.Wl);this.Wl=null}bPl(){if(0<this.ow.length){const a=new qS.a(this.ow),b=v.FocusManager.instance().Ll();b&&(this.ow[0].focus(),b.Dj=a,b.uX=!0)}}onKeyDown(a){4!==v.FocusManager.instance().rih(a)&&a.preventDefault()}}Object(m.a)(RO,"InsertImageDialog",bi.a,[]);class WE{constructor(){this.yZc=this.file=this.fileName=null;this.VZf=!1;this.GIb=null;this.NL=this.imageHeight=this.imageWidth=0;this.u6d=!1}}Object(m.a)(WE,"ImageType",null,[]);class SO{constructor(a,b,c,f,l,y,H,Q,ia,wa){this.kRb=
0;this.i7c=this.Mic=this.dMg=this.Hlb=!1;this.mM=[];this.UXa="image/*";this.ia=a;this.Ufb=b?b.va:null;this.oJa=null;this.Ud=c;this.Tic=f;this.uHe=l;this.Dbd=Q.pptEditingUploadedImageMaxSizeInBytes;this.veb=y;this.jfk=H;this.bEe=Q.pptEditingUploadLargeImageMaxSizeInBytes;this.Jmk=Q.pptEditingUploadLargeImageChunkSizeInBytes;this.Kmk=1E3*Q.pptEditingUploadLargeImageTimeoutInSeconds;if(this.lhb=Q.EOk)this.UXa=this.lhb.join(",");this.WXa=Q.YPj;this.fgb=ia;this.Ie=wa;this.ifc=Q.xUi}get P4c(){return this.dMg}set P4c(a){this.dMg=
a;this.Mic=0<this.bEe&&this.veb.t_j&&a}get DOk(){return this.Mic}UFk(a){this.Xwf(a);this.Ufb&&this.uHe.D1d(this.Ufb,a,Object(I.a)(this,this.rNe,"onUploadFrameInitialized"),Object(I.a)(this,this.$be,"getPictureUploadEndPoint"),this.UXa,!1,!1)}aIf(){return!(void 0===window.self.FormData||null===window.self.FormData)}Mih(a){if(this.Ufb){if(this.ifc){if(this.aIf()){this.uHe.D1d(this.Ufb,null,Object(I.a)(this,this.rNe,"onUploadFrameInitialized"),Object(I.a)(this,this.$be,"getPictureUploadEndPoint"),this.UXa,
a&&this.WXa,!0);this.i7c=!1;return}xa.a.J(558445203,822,10,"Browser does not support directly opening file dialog. Falling back to the old method")}z.a.Wj||z.a.DBb||z.a.GAb&&72>z.a.rMc?(this.uHe.D1d(this.Ufb,null,Object(I.a)(this,this.rNe,"onUploadFrameInitialized"),Object(I.a)(this,this.$be,"getPictureUploadEndPoint"),this.UXa,!1,!1),this.i7c=!1):((new RO(this)).mwl(a),this.i7c=!0)}else xa.a.J(18643099,822,15,"PictureUploader initialize failed.")}QWi(a){this.Myd&&(Array.addRange(this.mM,a),this.fPh())}get Myd(){return 1>
this.mM.length}fPh(){if(!this.Myd){const a=new WE,b=this.mM[0];b?(a.fileName=this.q6d(b.name),a.u6d=!0,this.rlh(a)):(xa.a.J(40993185,822,15,"PictureUploader.UploadNextImage File is null. Count of files: {0}.",this.mM.length.toString()),Array.clear(this.mM))}}$be(){return this.fgb.Hab()}rNe(a){this.oJa=a;if(!this.i7c){if(this.ifc&&this.aIf()){a.Z3d(Object(I.a)(this,this.kFk,"onMultipleFileChosen"));return}if(z.a.dG){a.Z3d(Object(I.a)(this,this.THk,"onSingleFileChosen"));return}a=a.Z3d(null);if(!a)return;
this.mM.push(a.files[0])}this.TTd()}Xwf(a){if(a)if(this.WXa)for(const b of a.files)this.mM.push(b);else this.mM.push(a.files[0])}kFk(a){this.Xwf(a);this.TTd()}aWi(a){a=this.dzd(a.fileName);return 0!==a?(this.oJa&&this.oJa.xPc(),2!==a&&3!==a||this.Kt(90,a),!1):!0}$5b(a){let b=!0;this.P4c&&a.yZc&&!this.ESl(a)&&(this.oJa&&(this.oJa.Hcc=!1),b=!1);!a.GIb||!this.Hlb&&b||(this.veb.revokeObjectURL(a.GIb),a.GIb=null);if(b){switch(this.kRb){case 0:this.ia.Ka(ea.a.HSc,2,a);break;case 1:this.ia.Ka(ea.a.z8d,2,
a)}this.fPh()}else Array.clear(this.mM)}q6d(a){if(a){let b=-1;const c=a.lastIndexOf("\\"),f=a.lastIndexOf("/");-1!==f?b=f:-1!==c&&(b=c);return a.substr(b+1)}return null}ESl(a){if(a.NL>this.Dbd){if(this.Mic&&a.NL<this.bEe)return xa.a.J(34420823,822,50,"Upload large image: {0}",a.NL),a.u6d=!0;xa.a.J(20828424,822,50,"Image size is: {0} MB, bigger than {1} MB ",a.NL/1024/1024,this.Dbd/1024/1024);this.Kt(87,4);return!1}return!0}z1i(a){if(!a)return null;const b=a.lastIndexOf(".");return-1===b?null:a.substr(b+
1)}I3e(a,b,c,f=null){if(a.u6d||this.WXa&&1<this.mM.length){const l=this.oJa,y=this.mM[0];Array.remove(this.mM,y);const H=Nc.a.Kb;H&&H.Wa("FChuckedPictureUpload","True");this.jfk().Y1(a,this.Jmk,y,f,this.Kmk,Q=>{l&&(l.Hcc=!1,l.dispose());b(Q)},Q=>{l&&(l.Hcc=!1,l.dispose());Array.clear(this.mM);c(Q)})}else this.oJa&&(a=this.doj(f),this.oJa.hCl(b,c,a)),Array.clear(this.mM)}doj(a){const b=new Uc.a;b.$("PresentationId",this.Ie.presentationId.string);b.$(Dh.a.xoa,this.Ie.sessionInfo);b.$("Canary",w.AFrameworkApplication.canary);
b.$("access_token",w.AFrameworkApplication.accessToken);b.$("Type",this.kRb.toString());a&&b.$("ImageToken",a);return b}THk(a){a&&(Array.add(this.mM,a.files[0]),this.TTd())}TTd(){if(this.Myd||!this.mM[0])Array.clear(this.mM);else{var a=new WE;a.fileName=this.q6d(this.mM[0].name);this.oJa.Hcc=!0;this.rlh(a)}}rlh(a){this.aWi(a)?this.P4c?this.T_k(a):this.$5b(a):Array.clear(this.mM)}dzd(a,b=!1){if(a&&a.length){if(1===this.kRb&&this.f4j(a))return xa.a.J(39154959,822,50,"Try to set background picture using svg file but not supported."),
3;if(this.ehg(a))return 0;this.z1i(a)?xa.a.J(20471823,822,50,"Insert local picture with invalid extension forCopyPaste: {0}",b):xa.a.J(20471825,822,50,"Insert local picture with empty extension, forCopyPaste: {0}",b);return 1===this.kRb?3:2}return 1}f4j(a){return!!a&&0<a.length&&ma.a.rg(a).endsWith(".svg")}Mgj(a){switch(a){case 1:return ResourceStrings.l_NoImageSpecifiedErrorMessage;case 2:return this.nsg()?ResourceStrings.l_InvalidImageErrorWithSvgSupportedMessage:ResourceStrings.l_InvalidImageErrorMessage;
case 3:return ResourceStrings.l_InvalidImageErrorMessage;default:return""}}nsg(){return this.ehg(".svg")}ehg(a){a=ma.a.rg(a);for(let b=0;b<this.lhb.length;++b)if(this.lhb[b]&&0<this.lhb[b].length&&a.endsWith(this.lhb[b].trim().toLowerCase()))return!0;return!1}Kt(a,b){if(87===a){const c=this.Mic?this.bEe:this.Dbd;this.Ud.nH(a,f=>{f.KC=1;f.bTa=[(c/1024/1024).toString()];return!1})}else{const c=this.Lgj(b);this.Ud.nH(a,f=>{f.KC=1;f.message=c;return!1})}}Lgj(a){return 2===a&&this.nsg()?String.format(ResourceStrings.imageFileNotListedInPptPictureUploadSupportedExtensions,
this.lhb.join(", ")):ResourceStrings.invalidImageFileError}T_k(a){let b=this.mM[0];if(b){a.NL=b.size;a.file=b;if(b.size>this.Dbd&&this.Mic)try{b=b.slice(0,6),a.VZf=!0}catch(c){xa.a.J(34420828,822,50,"File.slice throw exception"),this.Hlb=!0,this.$5b(a)}this.Tic.plh(b,c=>{this.Waj(c,a)})}}Waj(a,b){try{let c=a.target.result;b.yZc=c;b.VZf&&(c=this.veb.createObjectURL(b.file),b.GIb=c);let f=new Image;f.onload=()=>{b.imageWidth=f.width;b.imageHeight=f.height;this.uSj(b.yZc)&&(this.Hlb=!0,xa.a.J(22880261,
822,50,"Fallback for gif"));f.onload=f.onerror=null;f.src="";f=null;this.$5b(b)};f.onerror=()=>{xa.a.J(20828428,822,50,"Read image failed");this.Hlb=!0;this.$5b(b)};f.src=c}catch(c){xa.a.J(20828430,822,50,"GetBase64Image throw exception"),this.Hlb=!0,this.$5b(b)}}uSj(a){return 0<a.indexOf("base64,R0lGODlh")||0<a.indexOf("base64,R0lGODdh")}}Object(m.a)(SO,"PictureUploader",null,[360]);class TO{constructor(a){this.Ie=a}Hab(){let a="pptPictureUpload.ashx";if(Rc.App.webServiceBase)a=Rc.App.webServiceBase+
a;else if(z.a.gg||z.a.nva)a=yg.a.Lta(a);a+=String.format("?{0}&{1}&{2}",w.AFrameworkApplication.qUa(),this.Ie.presentationId.string,w.AFrameworkApplication.d7b());this.Ie.podSessionId&&(a+=String.format("&{0}={1}",Dh.a.Aaa,this.Ie.podSessionId));this.Ie.Ek&&(a+=String.format("&waccluster={0}",this.Ie.Ek));return a}Rwc(a){if(a){var b=a.split(",");if(4===b.length){const c=b[0].trim()+","+b[1].trim();b=b[2].trim()+","+b[3].trim();a=c===b?c:a}w.AFrameworkApplication.canary=a;w.AFrameworkApplication.tdc&&
xa.a.J(37818512,818,50,"PictureUploaderHelper::UpdateCanary - New canary in response: {0}",a)}}}Object(m.a)(TO,"PictureUploaderHelper",null,[359]);class mA{constructor(a,b,c,f,l,y,H,Q,ia,wa){this.Hcc=!1;this.uU=null;this.Rma=!1;this.zf=this.XX=this.GYa=this.Sfc=this.Jkc=this.Wl=this.Px=this.Sye=null;this.tf=a;this.Oik=f;this.Ie=c;this.i$=l;this.HEb=y;b&&(this.Wl=b.cloneNode(!0));this.Shk=H;this.UXa=Q;this.Klk=ia;(this.heb=wa)?this.BXf():this.qJi()}qJi(){this.uU=document.createElement("iframe");this.uU.style.visibility=
Ki.a.hidden;this.uU.id=mA.ovi;this.uU.className="ObjectInDialog";this.tf.appendChild(this.uU);this.Jkc=Object(I.a)(this,this.qch,"onUploadFrameLoad");hd.a.addHandler(this.uU,"load",this.Jkc);z.a.dG&&this.qch(null)}Z3d(a){w.AFrameworkApplication.Aa.hjb();if(!this.Wl)return null;this.heb?hd.a.addHandler(this.Wl,"change",()=>{this.L3i(a)}):z.a.dG&&(this.Sye=a,this.Sfc=Object(I.a)(this,this.uSc,"fileInputChange"),hd.a.addHandler(this.Wl,"change",this.Sfc));try{this.Wl.click()}catch(b){const c=String.format("UploadFrame::DoFileOpenDialog failed. Message: {0}. Stack: {1}",
b.message,b.stack);xa.a.J(19505501,818,10,c);return null}return this.Wl}L3i(a){a&&a(this.Wl)}uSc(){this.Sye&&this.Sye(this.Wl)}hCl(a,b,c){a||xa.a.J(590210183,818,10,"UploadFrame::SubmitForm - The responseHandler value is null.");b||xa.a.J(590210181,818,10,"UploadFrame::SubmitForm - The errorHandler value is null.");this.GYa=a;this.XX=b;if(c.Fb("ImageToken")||c.Fb("AudioToken"))a=this.Px.action,a+=String.format("&{0}={1}",Dh.a.MLk,1),this.Ie.podSessionId&&(a+=String.format("&{0}={1}","NoAuth","1")),
this.Px.action=a;for(let f of c.keys)this.mci(f,c.ga(f));this.heb?this.iCl():this.Px.submit()}iCl(){try{xa.a.J(558445200,818,50,"SubmitFormWithRequest is preparing to send an upload request");const a=new (Type.parse("FormData"))(this.Px);this.Hhl(a)}catch(a){xa.a.J(558445201,818,10,"SubmitFormWithRequest failed to send the request with exception "+a.message),this.hxc("SubmitFormWithRequest failed to send the request with exception "+a.message),this.xPc()}}Hhl(a){if(a){const b=this.Px.action;this.zf=
new XMLHttpRequest;this.zf.open("POST",b);this.zf.onreadystatechange=Object(I.a)(this,this.YIk,"onUploadResponseReceived");this.zf.send(a)}}YIk(){4===this.zf.readyState&&(this.zf.status===ua.a.mx?this.hxc(this.zf.responseText):(xa.a.J(558445202,818,10,"Upload request failed with status: {0} [isResponseNull: {1}]",this.zf.status,this.zf.responseText?!1:!0),this.hxc("Upload request failed")),this.xPc())}dispose(){this.i$(this);this.heb&&this.tf?this.tf.removeChild(this.Px):this.tf&&this.uU&&(this.tf.contains(this.uU)&&
this.tf.removeChild(this.uU),this.Jkc&&hd.a.removeHandler(this.uU,"load",this.Jkc),this.Jkc=null);this.Sfc&&(hd.a.removeHandler(this.Wl,"change",this.Sfc),this.Sfc=null);this.uU=this.Wl=this.Px=this.tf=null}mci(a,b){const c=this.PLi();c.type="hidden";c.id=a;c.name=a;c.value=b;this.Px.appendChild(c)}PLi(){return this.heb?document.createElement("input"):this.uU.contentWindow.document.createElement("input")}qch(a){try{if(!this.uU.contentWindow.document.body)return}catch(b){xa.a.J(8958480,818,10,"UploadFrame::OnUploadFrameLoaded - Javascript exception thrown while accessing the document body: {0}",
b.toString());this.hxc("0;Javascript exception thrown accessing the document body.");this.dispose();return}this.Rma?this.GYa?(this.hxc(this.dwj(this.uU.contentWindow.document.body)),this.xPc()):xa.a.J(35984990,818,10,"UploadFrame::OnUploadFrameLoaded - Triggered by {0}",a?"load event":"explicit call"):this.BXf()}BXf(){if(!this.Rma){const a=this.Shk();this.heb?(this.Px=document.createElement("form"),this.tf.appendChild(this.Px)):(this.Px=this.uU.contentWindow.document.createElement("form"),this.uU.contentWindow.document.body.appendChild(this.Px));
this.$Ki();this.Px.id="formId";this.Px.method="post";this.Px.encoding="multipart/form-data";this.Px.action=a;this.Px.appendChild(this.Wl);this.Rma=!0;this.Oik(this)}}$Ki(){this.Wl||(this.heb?(this.Wl=document.createElement("input"),this.Wl.style.opacity="0",this.Klk&&(this.Wl.multiple="multiple")):this.Wl=this.uU.contentWindow.document.createElement("input"),this.Wl.type="file",this.Wl.accept=this.UXa,this.Wl.id="fileInputId",this.Wl.name="fileInputId")}delayedDispose(){this.dispose()}xPc(){const a=
new dd.a(2,1,0,Object(I.a)(this,this.delayedDispose,"delayedDispose"),90,"82");w.AFrameworkApplication.Ae.Hb(a)}hxc(a){let b=null;try{b=Sys.Serialization.JavaScriptSerializer.deserialize(a)}catch(c){xa.a.J(8958484,818,10,"UploadFrame::UploadResponseReceived - Exception when deserializing response. Response: {0}",a)}b&&!b.Error?this.GYa?this.GYa(new Sm.a(b.Result)):xa.a.J(8958482,818,10,"UploadFrame::SubmitInsertPictureForm - The m_onFinished value is null."):(a=b&&b.Error?b.Error:Object.assign(new rs.a,
{Code:94}),this.XX?this.XX(new ss.a(a)):xa.a.J(8958486,818,10,"UploadFrame::SubmitForm - The m_onError value is null."))}Prl(){return this.Rma&&!this.Hcc}dwj(a){let b=null;this.HEb?(this.o6k(a,c=>3!==c.nodeType||!!c.nodeValue&&!c.nodeValue.trim().length),a.firstChild&&3===a.firstChild.nodeType&&(b=a.firstChild.nodeValue)):b=z.a.Wj?a.innerText:a.innerHTML;return b||"No response got from server"}o6k(a,b){for(;a.firstChild&&b(a.firstChild);)a.removeChild(a.firstChild)}}mA.ovi="ppt_uploadframe";Object(m.a)(mA,
"UploadFrame",null,[509,510,511]);class UO{constructor(a,b){this.aEb=[];this.Ie=a;this.HEb=b}D1d(a,b,c,f,l,y,H){if(0<this.aEb.length)for(let Q=this.aEb.length-1;0<=Q;Q--)this.aEb[Q].Prl()&&this.aEb[Q].dispose();a=new mA(a,b,this.Ie,c,Object(I.a)(this,this.uVi,"disposeHandler"),this.HEb,f,l,y,H);Array.add(this.aEb,a)}uVi(a){Array.remove(this.aEb,a)}}Object(m.a)(UO,"UploadFrameFactory",null,[358]);class VO extends Fq{constructor(a,b,c,f,l){super(a,b);this.jc=c;this.pa=f;this.Hgc=l}sr(a){var b="";if(this.Hgc){const c=
Fn.SchemeColor.parse(a);c&&(c.color&&!c.rua&&(b=Object(qa.a)(117,this.jc.mg(this.pa.Pa.mb.Va.node)),(b=c.resolve(b?b.Ed:null))?c.lQ=Si.g(b.Q0a):xa.a.J(38061255,826,15,"PptInsertionPointFormatting: SetFontColor: Couldn't resolve font color: {0}",Si.c(a))),b=c.toString());xa.a.J(41267233,826,50,"PptInsertionPointFormatting: SetFontColor: set SchemeColor to: {0}",Si.c(b));this.jl.setValue(zb.a.schemeColor,b);c&&c.rua&&(a=Si.i(c.lQ))}ma.a.Xa(a)||super.sr(a)}}Object(m.a)(VO,"PptInsertionPointFormatting",
Fq,[]);class XE{constructor(){this.ysa=this.GN=this.zsa=0;this.packageKey=this.Yx=this.Zpa=null;this.yMb=this.NZa=this.f_=0;this.startTime=this.ot=this.VH=null}Ylc(){return this.GN<this.Zpa.length?Object.assign(new XE,{zsa:this.GN,GN:this.GN+Math.min(this.ysa,this.Zpa.length-this.GN),ysa:this.ysa,Zpa:this.Zpa,Yx:this.Yx,packageKey:this.packageKey,VH:this.VH,ot:this.ot,f_:0,NZa:this.NZa,yMb:this.yMb,startTime:new Date}):null}}Object(m.a)(XE,"ChunkContext",null,[]);class WO{constructor(a,b,c,f,l){this.zf=
this.TJ=this.NH=null;this.thc=b;this.zec=c;this.wb=a;this.Ie=f;this.Uv=l}get M9(){return!!this.NH}Y1(a,b,c,f,l,y,H,Q,ia){this.M9?(xa.a.J(512496902,818,15,"ChunkedDataUploader::StartUpload - already uploading with uploadId: {0}, not starting new upload for uploadId: {1}",this.NH.Yx,f),ia&&ia(new ss.a(Object.assign(new rs.a,{Code:59})))):(0<l&&(this.TJ=Object.assign(new dd.a(2,1,l,Object(I.a)(this,this.PM,"onTimeout"),90,"85"),{customData:ia}),this.wb.Hb(this.TJ)),(this.NH=Object.assign(new XE,{zsa:0,
GN:0,ysa:a,Zpa:b,packageKey:c,Yx:f,VH:Q,ot:ia,f_:0,NZa:y,yMb:H,startTime:new Date}).Ylc())?this.jRb(this.NH):(xa.a.J(512496901,818,10,"ChunkedDataUploader::StartUpload - m_uploadingContext is null for uploadId: {0}",f),ia&&ia(new ss.a(Object.assign(new rs.a,{Code:437})))))}sxi(a){this.M9&&(xa.a.J(512496900,818,50,"ChunkedDataUploader::CancelUpload - cancelling upload for uploadId: {0}",this.NH.Yx),this.NH.Yx===a&&this.abort())}jRb(a){this.thc();if(this.zec()||!this.M9)xa.a.J(512496899,818,15,"ChunkedDataUploader::UploadChunk - session expired or not uploading for uploadId: {0}",
a.Yx),this.reset();else{var b=this.O_a(a);this.zf.onreadystatechange=()=>{this.zf&&4===this.zf.readyState&&this.lLe(a,this.zf.status)};this.zf.send(b)}}lLe(a,b){let c=Object.assign(new rs.a,{Code:94});if(200===b){b=null;try{b=Sys.Serialization.JavaScriptSerializer.deserialize(this.zf.responseText)}catch(f){xa.a.J(512496898,818,10,"ChunkedDataUploader::OnChunkUploadComplete - failed to deserialize response {0}, uploadId: {1}",f,a.Yx)}if(b&&!b.Error&&b.Result){const f=a.Ylc();f?(this.Uv.eNa(100*a.GN/
a.Zpa.length),this.jRb(f)):(xa.a.J(512496897,818,50,"ChunkedDataUploader::OnChunkUploadComplete - upload completed, duration:{0}, uploadId: {1}",+new Date-+a.startTime,a.Yx),this.Uv.eNa(100),this.reset(),a.VH&&a.VH(new Sm.a(b.Result)))}b&&(c=b.Error)}else xa.a.J(512496896,818,10,"ChunkedDataUploader::OnChunkUploadComplete - upload failed, status:{0}, uploadId:{1}",b,a.Yx);c&&(a.f_<a.NZa?(xa.a.J(512496867,818,15,"ChunkedDataUploader::OnChunkUploadComplete - Retrying a chunk to upload again - upload chunkStart:{0}, chunkEnd:{1}, uploadId:{2}",
a.zsa,a.GN,a.Yx),window.setTimeout(()=>{a.f_++;this.jRb(a)},a.yMb)):(xa.a.J(512496866,818,10,"ChunkedDataUploader::OnChunkUploadComplete - Retry count exceeded - upload chunkStart:{0}, chunkEnd:{1}, uploadId:{2}",a.zsa,a.GN,a.Yx),this.reset(),a.ot&&a.ot(new ss.a(c))))}O_a(a){this.zf=new XMLHttpRequest;this.zf.open("POST",this.Hab(),!0);w.AFrameworkApplication.accessToken&&(this.zf.setRequestHeader("X-AccessToken",w.AFrameworkApplication.accessToken),this.zf.setRequestHeader("X-AccessTokenTtl",w.AFrameworkApplication.b8.toString()));
const b=a.packageKey,c=a.zsa,f=a.GN,l=!c&&f===a.Zpa.length,y=new FormData;y.append("FileName",a.Yx);b&&y.append("PackageKey",b);y.append("Content-Range","bytes "+c+"-"+(f-1)+"/"+a.Zpa.length);xa.a.J(512496865,818,50,"ChunkedDataUploader::UploadChunk - upload chunkStart:{0}, chunkEnd:{1}, uploadLength: {2}, uploadId:{3}",c,f,a.Zpa.length,a.Yx);a=l?a.Zpa:a.Zpa.slice(c,f);y.append("ChunkData",a);return y}Hab(){let a="PastedDataUpload.ashx";if(Rc.App.webServiceBase)a=Rc.App.webServiceBase+a;else if(z.a.gg||
z.a.nva)a=yg.a.Lta(a);a+=String.format("?{0}&{1}&{2}",w.AFrameworkApplication.qUa(),this.Ie.presentationId.string,w.AFrameworkApplication.d7b());this.Ie.podSessionId&&(a+=String.format("&{0}={1}",Dh.a.Aaa,this.Ie.podSessionId));this.Ie.Ek&&(a+=String.format("&waccluster={0}",this.Ie.Ek));return a}PM(a){xa.a.J(512496864,818,15,"ChunkedDataUploader::OnTimeout - upload timeout for uploadId: {0}",this.NH.Yx);this.TJ=null;this.abort();(a=a.customData)&&a(new ss.a(Object.assign(new rs.a,{Code:299})))}abort(){if(this.M9){xa.a.J(512496863,
818,15,"ChunkedDataUploader::Aborting upload for uploadId: {0}",this.NH.Yx);const a=this.zf;this.reset();a&&a.abort()}}reset(){this.TJ&&(this.wb.Lg(this.TJ),this.TJ=null);this.NH=this.zf=null}}Object(m.a)(WO,"ChunkedDataUploader",null,[364]);class XO{constructor(){this.Xgk=new Bb.a(Object(I.a)(this,this.CTj,"isBrowerSupportObjectUrl"))}get t_j(){return this.Xgk.value}CTj(){return!!this.URL&&!!this.URL.createObjectURL&&!!this.URL.revokeObjectURL}createObjectURL(a){return URL.createObjectURL(a)}revokeObjectURL(a){URL.revokeObjectURL(a)}get URL(){return window.URL||
window.webkitURL}}Object(m.a)(XO,"PPTFileApiHelper",null,[382]);class YO{HTj(){return window.FileReader?!0:!1}plh(a,b){const c=new FileReader;c.onload=b;c.readAsDataURL(a)}readAsArrayBuffer(a,b){const c=new FileReader;c.onload=b;c.readAsArrayBuffer(a)}q6d(a){var b=null;if(a){b=-1;const c=a.lastIndexOf("\\"),f=a.lastIndexOf("/");-1!==f?b=f:-1!==c&&(b=c);b=a.substr(b+1)}return b}}Object(m.a)(YO,"PPTFileReaderHelper",null,[377]);var rS=d(984),sS=d(630),ro;(function(a){a.Accent1="#4472C4";a.Accent2="#ED7D31";
a.Accent3="#A5A5A5";a.Accent4="#FFC000";a.Accent5="#5B9BD5";a.Accent6="#70AD47";a.Hyperlink="#0563C1";a.ClickedHyperlink="#954F72";a.LightBackground="#FFFFFF";a.DarkBackground="#000000";a.TextColorLight="#E7E6E6";a.TextColorDark="#44546A";a.ColorPaletteName="Office"})(ro||(ro={}));Object(m.b)("DefaultOfficeThemeColorScheme",ro);var nA;(function(a){a.ThemeFamilyId="{62F939B6-93AF-4DB8-9C6B-D6C7DFDC589F}";a.VariantId="{4A3C46E8-61CC-4603-A589-7422A47A8E4A}"})(nA||(nA={}));Object(m.b)("DefaultOfficeThemeFamily",
nA);const Ml=a=>{if(a)return"#"+(16777216+(a.r<<16)+(a.g<<8)+a.b).toString(16).slice(1);xa.a.J(509207453,811,10,"Color is null")};var tS=d(341),uS=d(451),vS=d(300),ZO=d(547),Fu;(function(a){a.Insert="Insert";a.ReplaceAll="ReplaceAll"})(Fu||(Fu={}));Object(m.b)("MergeAction",Fu);var ip;(function(a){a.ChatPPTExitClicked="ChatPPTExitClicked";a.ChatPPTLikeClicked="ChatPPTLikeClicked";a.ChatPPTDislikeClicked="ChatPPTDislikeClicked";a.ChatPPTSuggestionClicked="ChatPPTSuggestionClicked";a.ChatPPTShowDesigner=
"ChatPPTShowDesigner";a.ChatPPTQueryExecutionStart="ChatPPTQueryExecutionStart";a.ChatPPTQueryExecutionComplete="ChatPPTQueryExecutionComplete";a.ChatPPTExecuteInsertSlideOperation="ChatPPTExecuteInsertSlideOperation";a.ChatPPTInsertSlideCompleted="ChatPPTInsertSlideCompleted";a.ChatPPTSearchClicked="ChatPPTSearchClicked";a.ChatPPTSearchCompleted="ChatPPTSearchCompleted";a.ChatPPTSlideUpdateCheckSuccessful="ChatPPTSlideUpdateCheckSuccessful"})(ip||(ip={}));Object(m.b)("ChatPPTEvents",ip);class $O{constructor(a,
b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb){this.zna={};this.J0=this.$Ig=!1;this.Tfb=null;this.hed=[];this.vfd=!1;this.Lbh=(ec,dc)=>{var Fc;if(dc&&dc.iPb){if("NotHandled"!==dc.iPb.status&&this.hed.push(dc.iPb),"Success"===dc.iPb.status||"NotHandled"===dc.iPb.status||"Cancelled"===dc.iPb.status)null===(Fc=this.j_g)||void 0===Fc?void 0:Fc.Moh(this.Lbh),this.showTaskPane(!0),this.hed=[],this.Vb.GI(yc=>{this.zu(yc)})}else xa.a.J(509097375,811,15,"Copilot: StoryTellerEventArgs is null")};this.zu=ec=>{const dc=pi.a.Y3(mx.a.M_a,
!1);Object(eb.a)("ToggleRibbonModeOnModeSwitch")&&1!==ec.mode&&(this.la.iA&&dc||this.la.ZF)&&!this.J0&&this.showTaskPane(!1)};this.uHk=ec=>{ec&&(this.J0=!1,xa.a.J(509166466,811,50,"Copilot: Close SDX in offline mode"))};this.GGl=(ec,dc)=>{this.J0||this.$Ig||!(this.la.iA&&"SingleLine".match(appChrome.selectors.getRibbonMode())||this.la.ZF)?this.J0&&"Multiline".match(appChrome.selectors.getRibbonMode())&&dc.upe?this.iLf():!this.J0&&"SingleLine".match(appChrome.selectors.getRibbonMode())&&dc.upe&&this.showTaskPane(!1):
this.showTaskPane(!1)};this.X1e=(ec,dc,Fc)=>{if(1==Fc)return 32;this.J0?(this.Jwg(!1),this.iLf()):(this.Jwg(!0),this.showTaskPane(!1));return 32};this.aqc=(ec,dc,Fc,yc,tc)=>{if(!tc)return 8;null===tc||void 0===tc?void 0:tc.Hf(this.J0);return 32};this.XCa=(ec,dc,Fc)=>{if(1==Fc)return 32;this.ywh();return 32};this.X$d=ec=>{const dc={};dc.ZA=this.la.ZF?"Copilot (Preview)":"What do you want to do? [Beta]";dc.JHh=this.la.ZF?"Copilot (Preview)":"What do you want to do?";dc.assetId=this.vzg;dc.nonPersistedSettings=
Object(eb.a)("CacheNonPersistedProperties")?this.zna:this.bcj(ec);dc.c6=this.mib;Object(eb.a)("AddClassOnSDXPaneContainer")&&(dc.GHh="ActionAITaskPane");Object(eb.a)("AddInPaneHeaderEnhancement")&&(dc.HHh="PPTCoPilot_24");return dc};this.ZJa=(ec,dc)=>{dc&&(ec=dc.instanceId)&&ec.length&&this.Tfb===ec&&(this.J0=!1,this.Tfb=null,Object(eb.a)("EnableChatPPTEventListenerFromSDX")&&this.tBl())};this.mib=()=>{this.Tfb=this.$Ta();this.$Ig=this.J0=!0;Object(eb.a)("EnableChatPPTEventListenerFromSDX")&&this.zAl()};
this.ywh=()=>{Bj.UISurfaces.Gq().then(ec=>{const dc=this.$Ta();dc&&ec.setSelectedTaskPane(dc);return null}).catch(ec=>{xa.a.J(509354912,811,10,"ChatPPTPane::SelectPane exception: {0}",ec.toString())})};this.hRk=ec=>Object(vj.a)(this,void 0,void 0,function*(){var dc,Fc,yc,tc,xd,Vd,Ld,ye,Xd=ec.slides;let Xf=[];for(var ug of Xd){var qg=ug;Xd=this.la.ka("ChatPPTEnableHubbleImageSearch");var Fg=this.la.ka("ChatPPTEnableTextToImage");if(!qg)throw Error.argumentNull("slideData");var qf=qg.Images,bg=[],Kg=
[];for(var rg of qf)rg&&(bg.push(rg.Prompt),Kg.push({Url:rg.Url,Format:void 0}));qf=qg.Title;const ui=qg.KeyPoints;qg=qg.Notes;qf&&ui||xa.a.J(509207452,811,15,"Copilot:InvalidOutlineInfo={0}{1}",qf?"":"slideTitle;",ui?"":"keyPoints;");Xf.push({Title:qf,ImagesQuery:Xd?bg:void 0,Images:Fg?Kg:void 0,KeyPoints:ui,Notes:qg})}rg={Title:"",Slides:Xf};Xd=this.ta.Ba;ug=this.ta.currentSlideIndex;Xd||xa.a.J(509207493,811,15,"Slide Node is Null. Using Office Default Theme Values");Fg=this.la.ka("ChatPPTUseColorSwapFix");
Xd&&Xd.Ed?Fg=Fg?{["Accent1"]:Ml(Xd.Ed.Accent1),["Accent2"]:Ml(Xd.Ed.Accent2),["Accent3"]:Ml(Xd.Ed.Accent3),["Accent4"]:Ml(Xd.Ed.Accent4),["Accent5"]:Ml(Xd.Ed.Accent5),["Accent6"]:Ml(Xd.Ed.Accent6),["Hyperlink"]:Ml(Xd.Ed.Hyperlink),["ClickedHyperlink"]:Ml(Xd.Ed.FollowedHyperlink),["TextColorLight"]:Ml(Xd.Ed.Light1),["TextColorDark"]:Ml(Xd.Ed.Dark1),["LightBackground"]:Ml(Xd.Ed.Light2),["DarkBackground"]:Ml(Xd.Ed.Dark2),["ColorPaletteName"]:Object(eb.a)("PptOutlineToPptUsesColorSchemeName")?Xd.Ed.ColorSchemeName:
void 0}:{["Accent1"]:Ml(Xd.Ed.Accent1),["Accent2"]:Ml(Xd.Ed.Accent2),["Accent3"]:Ml(Xd.Ed.Accent3),["Accent4"]:Ml(Xd.Ed.Accent4),["Accent5"]:Ml(Xd.Ed.Accent5),["Accent6"]:Ml(Xd.Ed.Accent6),["Hyperlink"]:Ml(Xd.Ed.Hyperlink),["ClickedHyperlink"]:Ml(Xd.Ed.FollowedHyperlink),["LightBackground"]:Ml(Xd.Ed.Light1),["DarkBackground"]:Ml(Xd.Ed.Dark1),["TextColorLight"]:Ml(Xd.Ed.Light2),["TextColorDark"]:Ml(Xd.Ed.Dark2),["ColorPaletteName"]:Object(eb.a)("PptOutlineToPptUsesColorSchemeName")?Xd.Ed.ColorSchemeName:
void 0}:(xa.a.J(509207489,811,50,"Slide Node is Null. Using Default Office Theme Color Scheme"),Fg={["Accent1"]:ro.Accent1,["Accent2"]:ro.Accent2,["Accent3"]:ro.Accent3,["Accent4"]:ro.Accent4,["Accent5"]:ro.Accent5,["Accent6"]:ro.Accent6,["Hyperlink"]:ro.Hyperlink,["ClickedHyperlink"]:ro.ClickedHyperlink,["LightBackground"]:ro.LightBackground,["DarkBackground"]:ro.DarkBackground,["TextColorLight"]:ro.TextColorLight,["TextColorDark"]:ro.TextColorDark,["ColorPaletteName"]:Object(eb.a)("PptOutlineToPptUsesColorSchemeName")?
ro.ColorPaletteName:void 0});bg=this.ta;Xd&&(null===bg||void 0===bg?0:bg.presentation)&&bg.presentation.v8b(Xd)?bg="{"+bg.presentation.v8b(Xd).ThemeFamilyId+"}":(xa.a.J(509207490,811,50,"Slide Node is Null. Using Default Office Theme Family Id"),bg=nA.ThemeFamilyId);bg=[bg];qg=Kg=void 0;qf=ec.mergeAction?ec.mergeAction:Fu.Insert;Object(eb.a)("PptOutlineToPptUseFontName")&&qf==Fu.Insert&&(Kg=null===(tc=null===(yc=null===(Fc=null===(dc=null===Xd||void 0===Xd?void 0:Xd.Ed)||void 0===dc?void 0:dc.FontScheme)||
void 0===Fc?void 0:Fc.majorFontField)||void 0===yc?void 0:yc.latinField)||void 0===tc?void 0:tc.typefaceField,qg=null===(ye=null===(Ld=null===(Vd=null===(xd=null===Xd||void 0===Xd?void 0:Xd.Ed)||void 0===xd?void 0:xd.FontScheme)||void 0===Vd?void 0:Vd.minorFontField)||void 0===Ld?void 0:Ld.latinField)||void 0===ye?void 0:ye.typefaceField);dc={OutlineInput:{ColorScheme:Fg,PresOutline:rg,ThemeIds:bg,MajorFont:Kg,MinorFont:qg,FRenderFirstThumb:!0},RequestOptions:{ClientName:"ChatPPT",MergeAction:qf,
CorrelationId:void 0,InsertPosition:{ReferenceSlide:{Cid:null===Xd||void 0===Xd?void 0:Xd.cid,Sid:null===Xd||void 0===Xd?void 0:Xd.sid},InsertBefore:!1}}};xa.a.J(509166875,811,15,"Copilot:MergeAction={0}",ec.mergeAction);dc=yield this.pXa.a3f(dc);return{slideIndex:-1===ug||ec.mergeAction===Fu.ReplaceAll?Xf.length-1:ug+Xf.length,success:dc}});this.Zol=ec=>{ec||xa.a.J(509166874,811,10,"No data received from SDX");try{const dc=JSON.parse(ec),Fc=dc.mergeAction===Fu.ReplaceAll?1:dc.slideIndex;!Fc||!this.oc.Cj()||
Fc>this.oc.Cj()?xa.a.J(509166371,811,10,"Copilot:Invalid Slide Index provided to set focus"):this.la.Un?this.Gna.value.$J(Fc):this.De.$J(Fc)}catch(dc){xa.a.J(509166873,811,10,"Copilot:Unexpected Error Occurred setting slideIndex:{0}",dc.toString())}};this.kQj=ec=>{if(null==ec)xa.a.J(509207492,811,10,"No message received from SDX");else if(Object(eb.a)("pptCreatorServiceForCopilotEnabled")){let dc;try{dc=JSON.parse(ec)}catch(Fc){xa.a.J(509207491,811,10,"Unexpected error parsing sdx request data {0}",
Fc.toString());return}this.hRk(dc).then(Fc=>{Fc?(xa.a.J(509211359,811,15,"Copilot:InsertSlideSuccessful={0}",Fc.success),this.khl(JSON.stringify(Fc))):xa.a.J(509166872,811,10,"Copilot:No Response From API")}).catch(Fc=>{xa.a.J(509211358,811,10,"Copilot: Unexpected error in insert slide operation from copilot?: {0}",Fc.toString())})}};this.khl=ec=>{if(this.Tfb){var dc=document.getElementById(this.Tfb);null==dc?xa.a.J(509196E3,811,10,"Copilot: SDX pane not found. IsPaneVisible={0}",this.J0):(ec={type:ip.ChatPPTInsertSlideCompleted,
message:ec},dc.contentWindow&&dc.contentWindow.postMessage(ec,"*"))}else xa.a.J(509166871,811,10,"Copilot: SDX instance id is null",this.J0)};this.jJf=ec=>{if(null!==ec&&void 0!==ec&&ec.data)switch(ec.data.type){case ip.ChatPPTExecuteInsertSlideOperation:this.kQj(ec.data.message);break;case ip.ChatPPTShowDesigner:this.ia.processAction(ea.a.Rch,2);break;case ip.ChatPPTQueryExecutionStart:this.la.iA&&this.ia.processAction(ea.a.cxb,2);break;case ip.ChatPPTQueryExecutionComplete:this.la.iA&&this.ywh();
break;case ip.ChatPPTExitClicked:this.S0i();break;case ip.ChatPPTLikeClicked:Object(eb.a)("EnableFeedbackInChatPPTMode")&&this.BIi(ec.data.message);break;case ip.ChatPPTDislikeClicked:Object(eb.a)("EnableFeedbackInChatPPTMode")&&this.AIi(ec.data.message);break;case ip.ChatPPTSearchClicked:this.aBl(ec.data.message);break;case ip.ChatPPTSlideUpdateCheckSuccessful:Object(eb.a)("SetFocusFromSDX")&&this.Zol(ec.data.message)}};if(!Q)throw Error.argumentNull("graphTopologyManager");if(!ia)throw Error.argumentNull("copilotProxy");
if(!y)throw Error.argumentNull("appSettings");if(y.Un&&!wa)throw Error.argumentNull("sorterViewActorLazy");if(!y.Un&&!Ua)throw Error.argumentNull("thumbnailNavigationPaneView");if(!kb)throw Error.argumentNull("presentationReader");if(!c)throw Error.argumentNull("appFrame");this.ia=a;this.Oc=b;this.la=y;this.nZg=H;this.xxg=l;this.Vb=c;this.ta=Q;this.pXa=ia;this.De=Ua;this.Gna=wa;this.oc=kb;this.j_g=Gb;this.le=f;this.vzg=this.la.ZUj?"FA000000129":"FA000000121";this.Gt();this.UMj()}vb(){this.ia.ya(ea.a.Kub,
yb.a.view,this.X1e);this.ia.ya(ea.a.Kub,yb.a.notes,this.X1e);this.ia.ya(ea.a.Kub,yb.a.Mf,this.X1e);this.ia.he(ea.a.Kub,4);Object(eb.a)("ShowEnabledStateOfChatPPT")&&this.ia.ra(ea.a.aqc,yb.a.application,this.aqc,96);this.ia.ya(ea.a.XCa,yb.a.view,this.XCa);this.ia.ya(ea.a.XCa,yb.a.notes,this.XCa);this.ia.ya(ea.a.XCa,yb.a.Mf,this.XCa);this.ia.he(ea.a.XCa,4)}pe(){}Gt(){var a;this.Oc.execute(b=>{b.cJc(this.ZJa)});!Object(eb.a)("DisableLazyBootLogic")&&this.le&&this.le.Iii(this.GGl);Object(eb.a)("EnableChatPPTPaneOnEditingMode")&&
!this.lWa()&&this.Vb.GI(b=>{this.zu(b)});(this.la.ZF||this.la.iA)&&Object(eb.a)("EnhancementOfSDXPaneBootTime")&&!this.lWa()&&Pd.a.get_instance().Mj(8,()=>{this.showTaskPane(!1)});Object(eb.a)("FixAddInPaneVisibilityInOfflineMode")&&this.Vb.JQa(this.uHk);Object(eb.a)("StoryTellerToSDXTransition")&&this.la.ZF&&this.la.lWa&&(null===(a=this.j_g)||void 0===a?void 0:a.ohi(this.Lbh))}UMj(){this.zna.AugloopClouldALServiceUrl=this.la.Ha("AugLoopCloudALServiceUrl");this.zna.ShouldUseEnvSpecificALUrl=this.nZg.toString();
this.zna.PPTCreatorEnabled=(Object(eb.a)("pptCreatorServiceForCopilotEnabled")&&(this.la.ZF||this.la.iA)).toString();this.zna.PPTClientOrigin=window.location.origin;this.zna.PPTCopilotSearchEnabled=(!Object(eb.a)("pptCopilotSearch")).toString();this.zna.PPTCopilotEnableTextToImage=this.la.ka("ChatPPTEnableTextToImage").toString();this.zna.PPTShowSuggestionsPill=this.la.ka("ChatPPTSuggestionsPillEnabled").toString();this.zna.PPTEnableFluentVisualRefresh=(this.la.ubc&&this.la.ka("EnablePPTOBgColorRefresh")).toString()}lWa(){return Object(eb.a)("StoryTellerToSDXTransition")&&
(this.la.QL&&this.la.lWa||this.la.icb)}Jwg(a){Object(eb.a)("logTelemetryForOpenClosePane")&&xa.a.J(509613323,811,15,"ChatPPT-IsOpen:"+a)}showTaskPane(a){if(this.J0)return 8;this.zna.ChatPPTSessionID=Hg.a.create().toString();this.zna.PPTStoryTellerExecutionResponse=a?JSON.stringify(this.hed):"[]";a=Object(eb.a)("StoryTellerToSDXTransition")&&this.Is?this.Is:this.Is=this.X$d(a);if(!a)return 8;this.ia.Ka(ea.a.Oga,2,a);return 32}iLf(){this.J0&&this.Tfb?this.ia.Ka(ea.a.Vub,2,this.Tfb):this.J0=!1}bcj(a){return{ChatPPTSessionID:Hg.a.create().toString(),
AugloopClouldALServiceUrl:this.la.Ha("AugLoopCloudALServiceUrl"),ShouldUseEnvSpecificALUrl:this.nZg?"true":"false",PPTCreatorEnabled:Object(eb.a)("pptCreatorServiceForCopilotEnabled")&&(this.la.ZF||this.la.iA)?"true":"false",PPTClientOrigin:window.location.origin,PPTCopilotSearchEnabled:!Object(eb.a)("pptCopilotSearch"),PPTCopilotEnableTextToImage:this.la.ka("ChatPPTEnableTextToImage")?"true":"false",PPTStoryTellerExecutionResponse:a?JSON.stringify(this.hed):"[]"}}$Ta(){var a;if(null!==(a=this.Oc)&&
void 0!==a&&a.instance)return a=this.Oc.instance.zQ(this.vzg),null===a||void 0===a?void 0:a.instanceId;xa.a.J(509207495,811,10,"Instance is null")}IGl(){appChrome.onRibbonModeToggle()}S0i(){this.IGl()}BIi(a){xa.a.J(508904391,811,15,"Copilot: Like button clicked for {0}",a);this.$td(!0,a)}AIi(a){xa.a.J(508904390,811,15,"Copilot: Dislike button clicked for {0}",a);this.$td(!1,a)}$td(a,b){if(this.xxg)try{this.xxg.$td(a,b,null)}catch(c){xa.a.J(508904389,811,10,"Feedback dialog failed to open with error={0}; isLikeDialog={1}; featureArea={2}",
c.toString(),a,b)}else xa.a.J(509613464,811,10,"ActionAIFeedback is received as null")}aBl(a){a&&!Object(eb.a)("pptCopilotSearch")&&(a=Object.assign(new tS.a,{selection:Object.assign(new uS.a,{neighborhood:a,mentionStart:0,mentionLength:null===a||void 0===a?void 0:a.length}),launchData:Object.assign(new vS.a,{landingTab:Object(eb.a)("pptCopilotSearchLandingTab")?"File":"All"}),entryPoint:Object(eb.a)("Microsoft.Office.SharedOnline.ChangeGate.UseCopilotEntrypointForDeckGen")?ZO.a.powerPointCopilot:
ZO.a.searchBoxGenerateDeck}),this.ia.Ka(G.a.Y_c,2,a),a=document.getElementById(this.$Ta()),null==a&&xa.a.J(509196033,811,10,"Copilot: SDX pane not found. IsPaneVisible={0}",this.J0),a.contentWindow.postMessage({type:ip.ChatPPTSearchCompleted,message:"1"},"*"))}zAl(){this.vfd||(window.addEventListener("message",this.jJf),this.vfd=!0)}tBl(){this.vfd&&(window.removeEventListener("message",this.jJf),this.vfd=!1)}}Object(m.a)($O,"ActionAIActor",null,[251]);class aP{constructor(a,b){this.QNl=(c,f,l,y,H)=>
{if(1===l)return 32;c=this.la.GDa?"DataSync: Fluid":"DataSync: Box4";H[Mp.a.Value]=c;H[nm.a.labelText]=c;H[Mp.a.Visible]=!0;return 32};if(!a||!b)throw ka.ULS.sendTraceTag(509384847,844,10,"DataSyncActor:IActor: ActionManager or appSettings should not be null."),Error.argumentNull("actionManager and appSettings cannot be null.");this.ia=a;this.la=b}vb(){this.ia.ra(ea.a.gjh,ie.a.frame,this.QNl,96)}pe(){}}Object(m.a)(aP,"DataSyncActor",null,[251]);class bP{constructor(a){this.uve=a}$td(a,b,c){const f=
this.ifj(b);f.initialFeedbackType=a?"Smile":"Idea";this.showDialog(f,a,b,c)}showDialog(a,b,c,f){function l(H){xa.a.J(508904388,811,20,"Feedback dialog dismissed. IsFeedbackSent={0}; FeatureArea={1}; IsLikeDialog={2}",H,c,b);f&&f(H,c)}const y=this.ot;Bj.UISurfaces.L9f().then(H=>{H.initializeFeedbackModal(a,l,y)})}ot(a){xa.a.J(509613318,811,10,"Error in submitting feedback: "+a)}ifj(a){var b={};w.AFrameworkApplication.fa.pSd(b);b=this.uve.getContext(b)||{};b.uiType="Modal";b.screenshot=!0;b.showEmailAddress=
!0;const c=b.telemetryGroup||{};c.processSessionId=b.sessionId;c.officeBuild=b.build;c.featureArea=a;b.telemetryGroup=c;return b}}Object(m.a)(bP,"ActionAIFeedback",null,[]);var wS=d(1048),xS=d(1305);class cP{constructor(a){this.k2a=(b,c,f)=>{var l;c=new wS.a(new Bb.a(()=>Rc.App.Lb?Rc.App.Lb.Kd.Di:null),sa.InteractiveViewManager.instance,Ib.a.instance.qb("Box4.ISelectionFactory"),Ib.a.instance.qb("PowerPointWebEditor.ISlideReader"),Ib.a.instance.qb("PowerPointWebEditor.IPPTWorkspace"),Ib.a.instance.qb("PowerPointWebEditor.Graph.IGraphTopologyManager"),
new xS.a,Ib.a.instance.qb("Common.IActionManagerExtended"),Ib.a.instance.qb("PowerPointWebEditor.IPptSelectionManager"),Ib.a.instance.qb("PowerPointWebEditor.IClipServiceManager"),Ib.a.instance.qb("PowerPointWebEditor.IPresentationReader"));b=b===ea.a.k2a?c.getSelectedSlidesAsPPTXStream():c.getAllSlidesAsPPTXStream();if(null===(l=null===b||void 0===b?void 0:b.selectedSlideIDs)||void 0===l||!l.length)return 16;if(1===f)return 2>b.selectedSlideIDs.length?16:32;this.ia.Ka(G.a.b0c,2,b);return 32};if(!a)throw Error.argumentNull("actionManager");
this.ia=a;this.vb()}vb(){this.ia.ya(ea.a.k2a,hc.a.application,this.k2a);this.ia.ya(ea.a.u4e,hc.a.application,this.k2a)}pe(){}}Object(m.a)(cP,"AICopilotActor",null,[251]);var dP=d(1072),yS=d(1032),zS=d(992),ew=d(982),eP=d(313),fP=d(334),AS=d(1067);class gP{constructor(a,b,c,f,l,y,H){this.pcd=[];this.zEj=()=>{this.Pal();this.submitOperation(this.o3b(this.getSelectedText()));return 32};this.qzb=(Q,ia,wa,Ua,kb)=>{2==wa&&this.ghb&&(Q=JSON.stringify(this.pcd[(Number(kb.SourceControlId.substring(kb.SourceControlId.length-
1))-1).toString()].data),this.ghb.imi(Q));return 32};this.d$d=()=>{const Q=this.uDe.d$d();return JSON.stringify(Q)};if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("augLoopRunTimeManager");if(!c)throw Error.argumentNull("pptSelectionManager");if(!f)throw Error.argumentNull("appOfficeManager");if(!l)throw Error.argumentNull("shapeReader");if(!y)throw Error.argumentNull("appSettingsManager");if(!H)throw Error.argumentNull("transformer");this.ia=a;this.Nv=b;this.Nv.execute(Q=>
{Q.VZ(ew.ActionRecommendationAnnotation.getTypeName());Q.Moa(ew.ActionRecommendationAnnotation.getTypeName(),this.MQ.bind(this))});this.kb=c;this.Hek=f;this.Ga=l;this.Jb=y;this.uDe=new zS.a(this.Hek,this.kb,this.Ga);this.dok=new AS.a(this.kb,this.Ga,this.Jb);this.ghb=H;this.vb()}vb(){this.ia.ya(ea.a.qwf,hc.a.application,this.qzb);this.ia.ya(ea.a.rwf,hc.a.application,this.qzb);this.ia.ya(ea.a.swf,hc.a.application,this.qzb);this.ia.ya(ea.a.twf,hc.a.application,this.qzb);this.ia.ya(ea.a.uwf,hc.a.application,
this.qzb);this.ia.ya(ea.a.vwf,hc.a.application,this.qzb);this.ia.ya(ea.a.Alh,hc.a.application,this.zEj)}pe(){}MQ(a){try{var b=a.modelResult;a=[];let c=1;this.pcd&&(this.pcd=[]);let f=[];for(let l of b)if(this.SYj(l)){l=JSON.parse(l);for(const y of l){const H=y.scenario;b=y;if(H){this.pcd.push({query:H,data:b});const Q="ActionRecommendation"+c.toString();f.push(Q);appChrome.api.dispatch(appChrome.actions.setControlLabel(Q,H.charAt(0).toUpperCase()+H.substr(1)));c++}}}a.push(appChrome.api.menuSection(f,
"",null,null));appChrome.api.dispatch(appChrome.actions.updateMenu("RecommendationContextMenuFlyout",a))}catch(c){}}SYj(a){try{JSON.parse(a)}catch(b){return!1}return!0}submitOperation(a){this.Nv.execute(b=>{b.submitOperation(a)})}o3b(a){const b=this.QUc();return Object.assign(new eP.a,{parentPath:["Signal",ew.ActionRecommendationSignal.getTypeName()],items:[Object.assign(new fP.a,{body:Object.assign(new ew.ActionRecommendationSignal,{query:a,context:this.d$d(),useDirectLLMCall:!0,gZl:w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ContentRecommendationFetchImageEnabled",
!1),trigger:"Paragraph"===b?ew.ActionRecommendationTrigger.TextSelection:"TextBoxSelection"})})]})}getSelectedText(){const a=JSON.parse(this.ghb.epj(ew.ActionRecommendationTrigger.TextSelection));return a.shapeText?a.shapeText:a.selectedText}QUc(){const a=this.dok.contentType.split(",");for(const b of a)if("Paragraph"===b||"SlideTextBox"===b||"SlideShape"===b)return b;return"Unknown"}Pal(){appChrome.api.dispatch(appChrome.actions.updateMenu("RecommendationContextMenuFlyout",[]))}}Object(m.a)(gP,"SmartRecommendationActor",
null,[251]);var hP=d(981),iP=d(976),jP=d(979),kP=d(1075),lP=d(975),mP=d(339),nP=d(980);class oP{constructor(){this.gLg=this.SCg=this.jdd=this.$ze=this.aAe=this.UFe=this.EA=this.Bma=this.K=null}get name(){return"PowerPointWebEditor.Actor"}zla(a){return a.resolve("PowerPointWebEditor.IApplicationSettings").iA||a.resolve("PowerPointWebEditor.IApplicationSettings").ZF}Yb(a){this.K=a;const b=a.resolve("PowerPointWebEditor.IApplicationContext");a.resolve("PowerPointWebEditor.IApplicationSettings").RXj?
a.register(342,"Box4.Actors.IFormattingStewardBridge").ma().oa(()=>new rO(new vE(a.resolve("Box4.IFormattingEditor")),a.resolve("Box4.IFormattingEditor"),a.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"),a.resolve("PowerPointWebEditor.IPPTParagraphReader"),a.resolve("Box4.IParagraphIndentationReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IApplicationSettings").pBb,a.resolve("PowerPointWebEditor.IApplicationSettings").Qqg,a.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteTextWithHighlight,
a.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteFontFamilyEnabled)):a.register(342,"Box4.Actors.IFormattingStewardBridge").ma().oa(()=>new vE(a.resolve("Box4.IFormattingEditor")));this.zla(this.K)&&eb.a("EnhancementOfSDXPaneBootTime")&&a.register(dP.a,"PowerPointWebEditor.AppForOfficeManagerFactory").as("PowerPointWebEditor.IAppForOfficeManagerFactory").oa(()=>new dP.a(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),
this.K.resolve("PowerPointWebEditor.IPPTApp"),this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory"),this.zla(this.K))).ma();a.register(343,"PowerPointWebEditor.IGraphTransactionHelper").ma().oa(()=>new bN(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").presentation,a.resolve("Common.Transaction.ITransactionFactory"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),
a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.Ia("PowerPointWeb.Comments.ICommentFrame")));a.register(344,"PowerPointWebEditor.IInsertOnlineVideoDialogHelper").ma().oa(()=>
new oN(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IRibbonChangeManager"),a.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),a.resolve("Common.Transaction.ITransactionFactory"),
a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager")));a.register(345,"Box4.IInsertionPointFormatting").ma().oa(()=>new VO(a.qb("Box4.IFontSlotProvider"),a.resolve("Box4.Actors.IFontNameFormattingStrategy"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IApplicationSettings").v2c));a.register(346,"Box4.IClipboardCommands").ma().oa(()=>a.resolve("PowerPointWebEditor.IApplicationSettings").remapShapeEditCommandEnabled?
new sE(w.AFrameworkApplication.Ra,ea.a.zgh,ea.a.Sld,ea.a.Tld,ea.a.Jgh):new sE(w.AFrameworkApplication.Ra,C.a.L0b,C.a.TKc,C.a.t8,C.a.Ykd));a.register(347,"HtmlImport.IHtmlNormalizerSettings").ma().oa(()=>new vC(!1,a.resolve("Common.IAppSettingsManager").ka("SplitHyperlinkFixWithEnterIsEnabled")));a.register(348,"HtmlImport.IHtmlTranslatorSettings").ma().oa(()=>{const c=a.resolve("PowerPointWebEditor.IApplicationSettings");return new jC(c.oqg&&a.resolve("Common.IAppSettingsManager").ka("ListMarkerIsEnabled"),
void 0,void 0,void 0,!0,c.IVa||c.qNk,!1,c.pptCopyPasteTextWithHighlight,c.IVa,c.IVa||c.pptCopyPasteFontFamilyEnabled,void 0,c.pptCopyPasteMarginAndIndentationEnabled,a.resolve("Common.IAppSettingsManager").ka("CopyAndPasteTextFromWordWin32FixIsEnabled"),c.pptCopyPasteFontFamilyEnabled,a.resolve("Common.IAppSettingsManager").ka("SupportCloudFontInExternalPasteIsEnabled"),void 0,void 0,c.IVa,c.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled"),f=>f.Dac&&c.Poe,()=>c.cpe,()=>c.IVa)});a.register(349,
"Box4.Actors.IBox4PasteStewardBridge").ma().oa(()=>new tO(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Box4.Actors.IBox4PasteStewardUtils"),a.resolve("Box4.IFormattingPropertyTransitStrategy"),a.resolve("PowerPointWebEditor.IPptListEditor"),a.resolve("Box4.Graph.IGraphIteratorFactory")));a.register(rE.a,"Common.PressOnlyKeyEvent").ma().oa(()=>rE.a.instance());a.register(SE,"PowerPointWebEditor.PasteFromFloatieArgs").ma().oa(()=>new SE);a.register(350,"PowerPointWebEditor.IPasteFloatieHelper").ma().oa(()=>
new vO(a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("Box4.Graph.IGraphInstance"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Na,a.resolve("PowerPointWebEditor.IThumbnailPane"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("Common.IClickInputManager"),a.resolve("PowerpointPresence.IPresenceEventSource"),a.resolve("PowerPointWebEditor.IDialogManager"),
a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.PasteFromFloatieArgs"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IRibbonPane"),a.resolve("PowerPointWebEditor.IApplicationSettings").Wqg,
a.resolve("Common.IAppSettingsManager"),a.resolve("Common.PressOnlyKeyEvent"),a.resolve("Box4.IPasteFloatieEventNotifier"),a.resolve("PowerPointWebEditor.IDesignModeManager").cDa));a.register(tE,"Box4.Clipboard.NoOpEdgeSystemClipboardSelectionEnsureStrategy").as("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy").ma().oa(()=>new tE);a.register(231,"Box4.IContextSetEditor").ma().oa(()=>Ch.ContextSetEditor.instance);a.register(351,"PowerPointWebEditor.IPPTFormattingStewardHelper").ma().oa(()=>
new sO(a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.ITableCellReader"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IPPTTableStyleReader")));a.register(xt,"PowerPointWebEditor.EnterViewStrategy").as("Box4.Actors.IEnterViewStrategy").ma().oa(()=>new xt(a.qb("Box4.IAutoCorrectScheduler"),a.oe("Box4.IUndoManager"),a.Ia("Box4.IExternalSelectionManager")));a.register(RE,"PowerPointWebEditor.PPTFontNameFormattingStrategy").as("Box4.Actors.IFontNameFormattingStrategy").ma().oa(()=>
new RE(a.resolve("PowerPointWebEditor.IFormattingHelper")));a.register(352,"Box4.Actors.IEopFormattingStrategy").ma().oa(()=>a.resolve("PowerPointWebEditor.IApplicationSettings").gdb?Object(qa.a)(352,new hO):Object(qa.a)(352,new BM));a.register(353,"Box4.ISelectAllHandlers").ma().oa(()=>new os($w.PageReader.instance,a.oe("Box4.IUndoManager"),a.resolve("Box4.Graph.IGraphTransactionFactory"),!1,!0));a.register(354,"Box4.Actors.IDeleteOutlineElementNodeStrategy").ma().oa(()=>new fO(a.resolve("Box4.IOutlineElementReader"),
a.resolve("Box4.ISelectionManager")));a.register(355,"Box4.IFormatPainterStrategy").ma().oa(()=>new iO(a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPptListEditor"),a.resolve("PowerPointWebEditor.IPptSelectionManager")));a.register(356,"Box4.Clipboard.IClipboardOperationCutStrategy").ma().oa(()=>new eO);a.register(357,"Box4.Actors.IDeleteTableSegmentStrategy").ma().oa(()=>new gO(a.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),a.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),
a.resolve("PowerPointWebEditor.IPptSelectionManager")));a.register(358,"PowerPointWebEditor.IUploadFrameFactory").ma().oa(()=>new UO(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings").OWj));a.register(359,"PowerPointWebEditor.IPictureUploaderHelper").ma().oa(()=>new TO(a.resolve("PowerPointWebEditor.ISessionInfoOwner")));a.register(360,"PowerPointWebEditor.IPictureUploader").ma().oa(()=>new SO(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ISlidePane"),
a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.IPPTFileReaderHelper"),a.resolve("PowerPointWebEditor.IUploadFrameFactory"),a.resolve("PowerPointWebEditor.IFileApiHelper"),()=>a.resolve("PowerPointWebEditor.IChunkedPictureUploader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IPictureUploaderHelper"),a.resolve("PowerPointWebEditor.ISessionInfoOwner")));a.register(361,"PowerPointWebEditor.IChunkedPictureUploader").oa(()=>new dw(a.resolve("Common.ITaskManager"),
()=>{Nc.a.zGa()},Object(I.a)(Cd.a.instance,Cd.a.instance.s8a,"checkAndTriggerSessionHasExpired"),a.resolve("PowerPointWebEditor.IPictureUploaderHelper")));a.register(362,"PowerPointWebEditor.IWarningDialog").ma().oa(()=>new FO);a.register(363,"PowerPointWebEditor.ICalloutNotificationAdapter").ma().oa(()=>new gS.a(a.resolve("Common.App.CalloutNotification.ICalloutNotification"),a.resolve("PowerPointWebEditor.IRibbonPane").va));a.register(364,"PowerPointWebEditor.IDataUploader").oa(()=>new WO(a.resolve("Common.ITaskManager"),
()=>{Nc.a.zGa()},Object(I.a)(Cd.a.instance,Cd.a.instance.s8a,"checkAndTriggerSessionHasExpired"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.Core.IPasteProgressManager")));a.register(365,"PowerPointWebEditor.IPastedDataUploader").ma().oa(()=>new BO(a.resolve("PowerPointWebEditor.IDataUploader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Core.IPasteProgressManager")));a.register(157,"PowerPointWebEditor.IMediaUploader").oa(()=>
new sS.a(a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.Core.IPasteProgressManager"),()=>{Nc.a.zGa()},Cd.a.instance.s8a.bind(Cd.a.instance)));a.register(366,"PowerPointWebEditor.ISystemClipboard").ma().oa(()=>new DO(a.resolve("PowerPoint.IBrowserHelperManager"),a.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory"),a.resolve("PowerPointWebEditor.IDesignModeManager"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IApplicationSettings")));
a.register(367,"PowerPointWebEditor.IInternalClipboard").ma().oa(()=>new qO(a.resolve("PowerPointWebEditor.IApplicationSettings").sog?a.resolve("Box4.Graph.IGraphInstance").yd(10):null,a.resolve("PowerPointWebEditor.IApplicationSettings").sog?a.resolve("Box4.Graph.IGraphInstance").yd(8):null));a.register(368,"PowerPointWebEditor.ICutCopyManager").ma().oa(()=>new oO(a.resolve("PowerPointWebEditor.IDesignModeManager").cDa,[new CO(a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IDesignModeManager").cDa,
a.oe("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),a.resolve("PowerPointWebEditor.IInternalClipboard"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IClipServiceManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.HtmlExport.IHtmlExportProcessor"),a.resolve("PowerPointWebEditor.HtmlExport.IHtmlExportUtils"),a.resolve("PowerPointWebEditor.IApplicationSettings").kUj,
a.resolve("PowerPointWebEditor.IApplicationSettings").bVj,a.resolve("PowerPointWebEditor.IApplicationSettings").jUj,a.resolve("Common.IAppSettingsManager").ka("UseToastForDeferredBlobsEnabled"),w.AFrameworkApplication.userSessionId,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IDeferredContentManager"),a.resolve("PowerPointWebEditor.IPPTFileReaderHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").Axb,a.resolve("PowerPointWebEditor.ISystemClipboard"),
a.resolve("PowerPoint.IBrowserHelperManager")),new qs(a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IDesignModeManager").cDa,a.oe("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IInternalClipboard"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IClipServiceManager"),a.resolve("PowerPointWebEditor.IApplicationSettings").lUj,
a.resolve("Common.IAppSettingsManager").ka("UseToastForDeferredBlobsEnabled"),w.AFrameworkApplication.userSessionId,a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IDeferredContentManager"))],a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),a.resolve("PowerPointWebEditor.ISystemClipboard"),a.resolve("PowerPoint.IBrowserHelperManager"),a.resolve("PowerPointWebEditor.IInputHandlerManager"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),
a.resolve("Common.IActionManagerExtended")));a.register(369,"PowerPointWebEditor.IPasteManager").ma().oa(()=>new Ng(a.oe("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IDesignModeManager").cDa,a.resolve("PowerPointWebEditor.IInternalClipboard"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPoint.IBrowserHelperManager"),[new xO(a.resolve("Common.IActionManagerExtended"),a.oe("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),
a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").Gme,a.resolve("PowerPointWebEditor.IApplicationSettings").Rqg),new yO(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").Hme),new jS.a(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.IWarningDialog"),a.resolve("Common.IBrowserUtils"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("PowerPointWebEditor.IApplicationSettings").n0j,a.resolve("PowerPointWebEditor.IApplicationSettings").R1j,a.resolve("PowerPoint.IBrowserHelperManager"),a.resolve("PowerPointWebEditor.IPictureUploader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")),new ay(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil")),
new Zz(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),w.AFrameworkApplication.ZQ),new TE(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),a.resolve("PowerPointWebEditor.IClipboardHelper"))],a.resolve("PowerPointWebEditor.IInputHandlerManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("Common.IBrowserUtils"),
a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("Common.App.ImageProcessor.IImageProcessor"),a.resolve("PowerPointWebEditor.IClipServiceManager"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),
a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")));a.register(370,"PowerPointWebEditor.ICopyPasteUtility").ma().oa(()=>new Mq.a(a.resolve("PowerPointWebEditor.IGraphTransactionHelper"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IPresentationReader")));a.register(371,"PowerPointWebEditor.IPasteHandlerUtil").ma().oa(()=>new wO);a.register(372,"PowerPointWebEditor.IClipboardHelper").ma().oa(()=>new xE.ClipboardHelper(a.resolve("PowerPointWebEditor.IInternalClipboard"),b.lUa().Ek||Lp.a.uQh,a.resolve("Common.IAppSettingsManager").Ha("RedisCacheServiceEnabledDatacenters"),a.resolve("Common.IAppSettingsManager").wc("ClipServiceItemExpireTimeInMinutes",
60),a.resolve("Common.IAppSettingsManager").ka("PptEditingSlideCopyAsImageUrlEnabled"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));a.register(373,"PowerPointWebEditor.IClipServiceManager").ma().oa(()=>new nO(b.lUa(),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));a.register(374,"Box4.TableEditors.ITableStylePreviewGenerator").ma().oa(()=>new Nq(a.resolve("Box4.Styles.ITableStyleReader"),a.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),a.resolve("PowerPointWebEditor.DataModel.IHierarchyHelper"),
a.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),Sz.qQf,c=>new XD(c,a.resolve("PowerPointWebEditor.ITableStyleResolver")),c=>new UD(c),a.resolve("PowerPointWebEditor.IApplicationSettings").Faa));a.register(375,"Box4.TableEditors.ITableStyleRibbonControls").ma().oa(()=>new YN(a.resolve("PowerPointWebEditor.IPPTTableStyleReader"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPoint.IPathManager"),a.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),a.resolve("Box4.TableEditors.ITableStylePreviewGenerator")));
a.register(376,"Common.App.ImageProcessor.IImageProcessor").ma().oa(()=>new AM(a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder")));a.register(377,"PowerPointWebEditor.IPPTFileReaderHelper").ma().oa(()=>new YO);a.register(378,"Box4.Actors.IFormattingViewOperationFinishedStageProcessor").ma().oa(()=>new bA(a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Box4.IPageView"),a.resolve("PowerPointWebEditor.IShapeReader")));a.register(379,"PowerPointWebEditor.ILocalImageViewFactory").ma().oa(()=>
new NO(a.resolve("PowerPointWebEditor.IFileApiHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").mcb));a.register(380,"PowerPointWebEditor.IShapeProgressIndicatorViewFactory").ma().oa(()=>new PO);a.register(381,"PPTe.IColorPickerBuilderFactory").ma().oa(()=>new TR.a);a.register(382,"PowerPointWebEditor.IFileApiHelper").ma().oa(()=>new XO);a.register(383,"PowerPointWebEditor.IInsertImageHelper").ma().oa(()=>new mN(a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IPresentationReader")));
a.register(uE,"Box4.Actors.FormatPainter").as("Box4.IFormatPainter").ma().oa(()=>new uE(a.resolve("Box4.Styles.IStyleEditor"),a.resolve("Box4.IInsertionPointFormatting"),a.resolve("Box4.IFormattingEditor"),a.resolve("Box4.IParagraphEditor"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.List.IListEditor"),a.resolve("Box4.List.IListReader"),a.resolve("Box4.ICharacterPropertiesEditor"),bh.a.instance,a.qb("Box4.IFeatureHelper"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,
a.resolve("Box4.TextFormattingHelper")));a.register(384,"PowerPointWebEditor.IFormatPainter").ma().oa(()=>new JO(a.resolve("Common.IActionManagerExtended"),a.resolve("Box4.Graph.IGraphInstance").yd(10),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled));a.register(385,"PPTe.IResourceViewElementResolver").ma().oa(()=>new mO(b.lUa(),
Rc.App.webServiceBase));a.register(386,"PowerPointWebEditor.IOfflineModalCallout").ma().oa(()=>new KO(a.resolve("Box4.IAppFrame")));a.register(387,"PowerPointWebEditor.IPPTOfflineManager").ma().oa(()=>new EO(a.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IStatusBarUser"),
a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));a.register(388,"PowerPointWebEditor.IClipboardTelemetry").ma().oa(()=>new zu.a(a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("Box4.Graph.IGraphInstance").yd(8),a.resolve("Box4.Graph.IGraphInstance").yd(10),
a.resolve("Box4.Graph.IGraphInstance").yd(12),a.resolve("Box4.Graph.IGraphInstance").yd(60),a.resolve("Box4.Graph.IGraphInstance").yd(7),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ICalloutNotificationAdapter"),a.resolve("PowerPointWebEditor.Core.IPasteProgressManager")));w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableHALO",!1)&&(a.register(mP.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper").as("PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper").ma().oa(()=>
new mP.a(a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.IOutlineEditor"),a.resolve("Box4.IOutlineElementNavigator"),a.resolve("Box4.ICharacterPropertiesEditor"))),a.register(lP.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText").ma().oa(()=>new lP.a(a.Ia("PowerPointWebEditor.AppForOfficeManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Box4.IFormattingEditor"),a.resolve("Box4.IParagraphEditor"),
a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("Box4.List.IListEditor"),a.resolve("Box4.ICharacterPropertiesEditor"),a.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper"))),a.register(iP.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape").ma().oa(()=>new iP.a(a.Ia("PowerPointWebEditor.AppForOfficeManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),
a.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),a.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IGraphTransactionHelper"),a.resolve("PowerPointWebEditor.IRibbonChangeManager"))),a.register(jP.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide").ma().oa(()=>
new jP.a(a.Ia("PowerPointWebEditor.AppForOfficeManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventNotifier"))),a.register(kP.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable").ma().oa(()=>new kP.a(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.IRibbonChangeManager"),a.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IGraphTransactionHelper"),a.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper"))),
a.register(nP.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage").ma().oa(()=>new nP.a(a.Ia("PowerPointWebEditor.AppForOfficeManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"))),a.register(hP.a,"PowerPointWebEditor.SmartLookup.Recommendations.SmartRecommendations").as("PowerPointWebEditor.SmartLookup.Recommendations.SmartRecommendations").ma().oa(()=>new hP.a(a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.Transaction.ITransactionFactory"),a.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText"),a.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape"),a.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide"),a.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable"),a.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage"))))}init(){const a=this.K;
var b=a.resolve("Common.AFrameworkApplication");const c=b.dT;var f=b.aq;const l=c.rd;var y=a.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventSource"),H=f.Nib;const Q=a.resolve("Common.IActionManagerExtended"),ia=a.resolve("PowerPointWebEditor.IFrameContext"),wa=a.resolve("PowerPointWebEditor.IFocusManager"),Ua=a.resolve("PowerPointWebEditor.IFormatPainter"),kb=a.resolve("PowerPointWebEditor.CoauthManager"),Gb=a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),ec=Ib.a.instance.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),
dc=Ib.a.instance.resolve("PowerPointWebEditor.IDialogManager"),Fc=Ib.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),yc=Ib.a.instance.resolve("Box4.ISelectionManager"),tc=Ib.a.instance.Ia("Box4.IExternalSelectionManager"),xd=Ib.a.instance.resolve("PowerPoint.IPathManager");var Vd=Ib.a.instance.resolve("PowerPointWebEditor.IInternalClipboard");const Ld=f.Kd,ye=Ib.a.instance.resolve("PowerPointWebEditor.IRibbonChangeManager");b=Ib.a.instance.resolve("PowerPointWebEditor.ISaveBlockingUI");
const Xd=Ib.a.instance.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),Xf=Ib.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),ug=Ib.a.instance.resolve("PowerPointWebEditor.INotesView"),qg=Ib.a.instance.resolve("Box4.IFormatPainter"),Fg=a.resolve("PowerPointWebEditor.IRevisionMetadataHelper"),qf=a.resolve("Common.Transaction.ITransactionFactory"),bg=a.resolve("PowerPointWebEditor.IPresentationReader"),Kg=a.resolve("PowerPointWebEditor.IShapeReader"),rg=a.resolve("PowerPointWebEditor.Graph.ITableReader"),
ui=a.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),Ik=a.resolve("PowerPointWebEditor.Graph.ITableRowReader");var vg=a.resolve("PowerPointWebEditor.ITableEditor");const Lg=Ib.a.instance.resolve("PowerPointWebEditor.IShapeEditor"),rh=Ib.a.instance.resolve("PowerPointWebEditor.IGraphTransactionHelper"),Bm=a.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),xj=a.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),Cm=a.resolve("PowerPointWebEditor.Graph.IGraphNodeContextHelper"),
go=Ib.a.instance.resolve("Box4.List.IListReader");var Tl=a.resolve("Box4.Graph.IGraphIteratorFactory");const ho=a.resolve("PPTe.IColorPickerBuilderFactory"),Ul=a.resolve("PowerPointWebEditor.View.IPPTPageView");this.Bma=Ib.a.instance.resolve("PowerPointWebEditor.ICutCopyManager");this.EA=Ib.a.instance.resolve("PowerPointWebEditor.IPasteManager");const Kl=Ib.a.instance.resolve("PowerPointWebEditor.IPresentationResourcesManager"),lm=Ib.a.instance.resolve("PPTe.IResourceViewElementResolver");Ib.a.instance.resolve("PowerPointWebEditor.ILocalImageViewFactory");
Ib.a.instance.resolve("PowerPointWebEditor.IShapeProgressIndicatorViewFactory");const zn=Ib.a.instance.resolve("PowerPointWebEditor.IGraphHotColdManager"),jl=Ib.a.instance.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),oi=a.resolve("Common.Utils.IHighContrastDetector"),An=Ib.a.instance.resolve("PowerPointWebEditor.ISubtitleContext"),io=a.resolve("PowerPointWebEditor.IRibbonUser"),Ep=a.resolve("Box4.CloudFontService"),Mm=a.resolve("Box4.CustomFontService");this.UFe=new $i(Q,ec,wa,ia.LCID,
Fc,qf,rh,Ld,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),bg,new IO(Ib.a.instance.resolve("PowerPointWebEditor.IFocusManager"),Ib.a.instance.resolve("PowerPointWebEditor.IPresentationReader")),Kl,l,lm);this.aAe=new Wj(rh,Q,wa,Fc,ec,Ul,a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("Box4.Graph.IGraphInstance").yd(7),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),ye,Lg,jl,a.resolve("PowerPointWebEditor.IApplicationSettings").zYj,
a.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),a.Ia("PowerPointWebEditor.IInsertShapeOverlayViewElement"),a.resolve("PowerPointWebEditor.IApplicationSettings").kAb,l.vQj,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),
a.resolve("Box4.Graph.IGraphInstance").yd(10));this.$ze=new dA(rh,Q,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ec,Ul,a.resolve("Box4.Graph.IGraphInstance").yd(7),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").presentation,ye,Lg,jl,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IInkDryStore"));Vd=new SM(Q,wa,a.resolve("PowerPointWebEditor.IPptSelectionManager"),Ld,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
qf,a.resolve("PowerPointWebEditor.IGraphTransactionHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),Vd,ec,this.Bma,this.EA,a.resolve("PowerPointWebEditor.IDesignModeManager").cDa,a.resolve("PowerPointWebEditor.ICopyPasteUtility"),bg,Lg,Ul,a.resolve("PowerPointWebEditor.IWarningDialog"),(zj,zg,Rd,gf,Lf,we,lh,rj,Aj)=>new vN(zj,zg,Rd,gf,Lf,we,lh,rj,Aj),jl,a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.ISystemClipboard"),a.resolve("PowerPointWebEditor.IInsertImageHelper"),
a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.IInsertOnlineVideoDialogHelper"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IDeferredContentManager"),w.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")?a.resolve("Box4.ITextPasteFloatieManager"):null,w.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")?Ib.a.instance.resolve("Box4.IPasteFloatieEventSource"):null,w.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")?a.resolve("PowerPointWebEditor.IGraphHotColdManager"):
null,w.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")?a.resolve("Box4.Graph.IGraphInstance").yd(10):null,w.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")?a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"):null,w.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")?a.resolve("Box4.IUndoManager"):null);const Nm=new qi(Q,wa,qf,H,Ua,ec,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IBox4ColorHelper"),a.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper"),
a.resolve("PowerPointWebEditor.ShapeEdit.ISVGIconLocalEditor"),a.resolve("PowerPointWebEditor.IJSanityHelper"),a.resolve("PowerPointWebEditor.IShapeReader"),qg,Fg,Ld,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),oi,a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.IZoomContext"),a.resolve("Box4.Styles.ITableStyleReader"),a.resolve("Box4.IPageView").Na),yj=new uN(Q,ec,ia,qf,Fc,a.resolve("PowerPointWebEditor.IShapeReader"),
a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper"));H=new dN(Q,qf,Fc,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),ia,a.resolve("PowerPointWebEditor.IApplicationSettings"));y=[new IM(Q,l,y,Fc,qf,ec,l.j3),Vd,new by(Q,l,w.AFrameworkApplication.fa.ka("UseToastForDeferredBlobsEnabled"),
a.resolve("PowerPointWebEditor.IClipServiceManager"),wa,ec,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),qf,Bm,Ld,a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),Ul,jl,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.ICcpEventNotifier"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),zn,a.resolve("Box4.IPasteFloatieEventNotifier"),a.resolve("PowerPointWebEditor.IPresentationReader"),
a.resolve("PowerPointWebEditor.IPasteFloatieHelper"),a.resolve("PowerPointWebEditor.PasteFromFloatieArgs"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),this.EA,a.resolve("PowerPointWebEditor.Core.IPasteProgressManager"),a.resolve("PowerPointWebEditor.IPastedDataUploader"),a.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")),new VM(Q,Ib.a.instance.resolve("PowerPointWebEditor.IDesignModeManager"),dc,a.oe("PowerPointWebEditor.IContextMenuUser"),
Ld,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),wa,a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),l.pptContextMenuOnSelectionFixIsEnabled,l.Un),new WM(Q,Fc,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.View.IAccCheckPane"),l.powerPointGraphicToolTabIsEnabled,l.ahh,l.sKb,l.j3,l.ka("PictureBGREnabled")),
new cO(Q,l,uv.a.Byb,Tl,a.resolve("Box4.IParagraphReader")),new dO(xu.instance),this.aAe,this.$ze,H,new dy(Q,ec,wa,ia.notesPane,ug,Ld,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ia,a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),f,Ib.a.instance.resolve("PowerPointWebEditor.ISlideCacheManager"),a.resolve("PowerPointWebEditor.View.IPPTPageView")),new tN(Q,a.resolve("PowerPointWebEditor.IPPTOfflineManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IStatusBarUser")),
yj,new BN(Q,ia,io,wa,a.resolve("PowerPointWebEditor.ICUIManager"),a.resolve("PowerPointWebEditor.View.IViewEventNotifier"),a.resolve("Common.IRibbonExternal"),a.resolve("Common.IAppSettingsManager").ka("AltForKeytipEnabled"),a.resolve("PowerPointWebEditor.IApplicationSettings").iA),new EN(Q,ec,wa,dc,Ld,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),Ua,a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IAriaManager"),
a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),l.gD,a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.IShapeReader"),l.podsNewThumbnailVisibleRangeFetchExperience,a.resolve("PowerPointWebEditor.IVideoManagerStore"),l.kQ,a.resolve("PowerPointWebEditor.View.IViewEventSource"),l.m8a),Nm,new JN(Q,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ec,qf,wa,Kl,lm,Fc,Kg,a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings").powerPointGraphicToolTabIsEnabled,
a.resolve("PowerPointWebEditor.Core.ICoreEventHandler")),new Yv(rh,Q,wa,ec,a.resolve("PowerPointWebEditor.IFontUtilsManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Box4.IFormattingEditor"),Kg,!!Ep&&Ep.isEnabled,!!Mm&&Mm.isEnabled,a.resolve("PowerPointWebEditor.IApplicationSettings").podsHtmlTextForEmbeddedFontsIsEnabled,a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.IApplicationSettings")),new KN(rh,Q,wa,ec,Fc,Kg,a.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"),
a.resolve("PowerPointWebEditor.IPptListMarkersLoader"),a.resolve("Box4.Graph.IGraphIteratorFactory"),qf,l.dpe,a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("Box4.List.IListReader"),a.resolve("PowerPointWebEditor.IApplicationSettings")),this.UFe,new LN(Q,ec,qf,rh,wa,Fc,Ld,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),bg,l,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers")),
new MN(Q,dc,wa,ec,rh,Ld,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),bg,Xd,(zj,zg)=>new rS.a(zj,zg),a.resolve("PowerPointWebEditor.IPptSelectionManager"),l.gD,l.epe),new PN(Q,ec,Fc,qf,wa,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ye,bg,Lg,Ul,jl,a.resolve("PowerPointWebEditor.IShapeReader")),new RN(()=>Xf,new SN(yc,uv.a.Byb,a.resolve("Box4.IContextSetEditor")),tc,l),new ZN(Q,ec,l,wa,Fc,Xf,a.Ia("PowerPointWebEditor.IAppForOfficeManager"),a.oe("PowerPointWebEditor.IAppforOfficeClassFactory"),
Ul,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,a.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.ISlidelessPane"),a.Ia("PowerPointWebEditor.ITextLayoutManager"),a.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor"),a.Ia("PowerPointWebEditor.IAudioManagerStore")),
new hA(Q,Fc,xj,wa,b,Gb,Ib.a.instance.resolve("PowerPointWebEditor.IApplicationSettings")),new lO(Q,a.Ia("PowerPointWebEditor.ICommentsPane"),wa,a.resolve("Common.IF6Manager"),Fc,xj,ec,xd,Ld,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),bg,a.resolve("PowerPointWebEditor.IWindowUtils"),w.AFrameworkApplication.fa,l,b,c.lUa(),Gb,Xd,Ib.a.instance.resolve("PowerPointWebEditor.ISlideshowManager"),Ib.a.instance.resolve("Box4.Graph.IGraphInstance").yd(7),Ib.a.instance.resolve("PowerPointWebEditor.IInboundHelper"),
Ib.a.instance.resolve("Common.ITaskManager"),w.AFrameworkApplication.Me,Ib.a.instance.resolve("PowerPointWebEditor.IJsonpHelperManager"),Ib.a.instance.resolve("PowerPointWebEditor.View.IViewEventSource"),a.Ia("PowerPointWeb.Comments.ICommentFrame"),a.Ia("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),An,Ib.a.instance.Ia("PowerPointLive.ILivePresenter"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IStatusBarUser"),f,a.resolve("PowerPointWebEditor.ITaskPaneManager"),
a.resolve("PowerPointWebEditor.IDeferredContentManager"),l.Un?a.oe("PowerPointWebEditor.ISorterViewActorLazy"):null)];vg=new Du(Q,Tl,ec,wa,go,Kg,rg,Ik,ui,Lg,vg,l,qf,Ld,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Fc,jl,a.resolve("PowerPointWebEditor.ITableSelectionAdapter"),a.resolve("PowerPointWebEditor.ITableMergeSplitEditor"),a.resolve("PowerPointWebEditor.ICellIteratorFactory"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),
a.resolve("PowerPointWebEditor.IRibbonChangeManager"),a.resolve("PowerPointWebEditor.ITableMetrics"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptIsInsertMultiRowColumnEnabled,io,a.resolve("Box4.Styles.ITableStyleReader"));y.push(new Bu(Q,Fc,wa,go,a.resolve("Box4.ILineSpacingHelper"),qf,Cm,Tl,Rc.App.KMa.lOc(12),Rc.App.KMa.lOc(10),Kg,a.resolve("Box4.IContextSetEditor"),a.resolve("PowerPointWebEditor.IPptListMarkersLoader"),l.dpe,l.isPromoteDemoteOnParagraphEnabled,ho,l.v2c,a.resolve("PowerPointWebEditor.Graph.ITableReader"),
a.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,a.resolve("PowerPointWebEditor.ITableEditor"),qg,f,Ld,a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),a.resolve("Box4.IInsertionPointFormatting"),Fg,a.resolve("Box4.IParagraphIndentationReader"),a.resolve("Box4.IParagraphEditor"),a.resolve("PowerPointWebEditor.IApplicationSettings").Ekb));y.push(vg);f=new PE(Q,wa,Kg,rh,ec,Fc,a.resolve("Box4.IInsertionPointFormatting"),a.resolve("Box4.IParagraphReader"));
y.push(f);l.k$k&&y.push(new zN(Q,wa,a.resolve("PowerPointWebEditor.IPresentationReader")));l.URk&&y.push(new TM(Q,a.resolve("PowerPointWebEditor.ICoauthStateSetter"),l));(l.LPb||l.Amb)&&y.push(new bw(Q,l,qf,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Fc,rg,a.resolve("PowerPointWebEditor.IFunctionThrottlerFactory"),a.resolve("PowerPointWebEditor.View.IPPTPageView")));l.Bai&&y.push(new GM(Fc,w.AFrameworkApplication.fa,l,Object(I.a)(Mz.App.k7a,Mz.App.k7a.g2f,"forceUpdateRibbonControls")));
this.zla(this.K)&&eb.a("EnhancementOfSDXPaneBootTime")&&y.push(new yS.a(l,this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IGraphTransactionHelper"),Q,Ld,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),qf,this.K.oe("PowerPointWebEditor.IClassFactory"),this.K.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory"),this.K.Ia("PowerPointWebEditor.IAppForOfficeManager"),Tl,ec,jl));!this.zla(this.K)||w.AFrameworkApplication.fK||w.AFrameworkApplication.cC||
(Tl=null,Object(eb.a)("EnableFeedbackInChatPPTMode")&&(Tl=this.K.resolve("Common.App.ICustomerFeedbackUiWrapper"),Tl=new bP(Tl)),f=!1,Object(eb.a)("NewSettingsForChatPPT")&&(f=a.resolve("PowerPointWebEditor.IApplicationSettings").h3j),y.push(new $O(this.K.resolve("Common.IActionManagerExtended"),this.K.Ia("PowerPointWebEditor.IAppForOfficeManager"),a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),Tl,a.resolve("PowerPointWebEditor.IApplicationSettings"),
f,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.ICopilotProxy"),l.Un?a.oe("PowerPointWebEditor.ISorterViewActorLazy"):null,a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("PowerPointWebEditor.IPresentationReader"),l.lWa?a.resolve("PowerPointWebEditor.IStorytellerEventListener"):null)));l.$Fh&&y.push(new cP(Q));l.b3e&&y.push(new gP(Q,this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.Ia("PowerPointWebEditor.IAppForOfficeManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("Common.IAppSettingsManager"),a.resolve("PowerPointWebEditor.SmartLookup.Recommendations.SmartRecommendations")));eb.a("DataSyncModeOnStatusBar")&&"inner"===w.AFrameworkApplication.fa.Ha("Microsoft365Ring")&&y.push(new aP(Q,l));for(const zj of y)zj.vb(),zj.pe();Ib.a.instance.Ia("PowerPointWebEditor.ISorterViewActorMain").execute(zj=>{zj.vb()});a.resolve("PowerPointWebEditor.IPPTProcessImageStrategy").Gpi(new QO(a.resolve("Common.ITaskManager"),
a.resolve("Box4.IFileReaderHelperFactory"),a.resolve("Common.App.ImageProcessor.IImageProcessor"),a.resolve("PowerPointWebEditor.IApplicationSettings")));const kh=this;w.AFrameworkApplication.fa.ff(()=>{const zj=cs.a(a),zg=[new kO(Q,ec,Fc,wa,Xf,l.PZj,kb,Ld.Ef,a.Ia("PowerpointPresence.IPresenceManager"),a.resolve("PowerPointWebEditor.ITablePartialEditController"),a.resolve("PowerPointWebEditor.IActionNameResolver"),a.resolve("PowerPointWebEditor.IGroupUngroupUndoRedoActionController"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.View.IViewEventNotifier"))],Rd=w.AFrameworkApplication.fa.ka("LiveSubtitlesEnabled");l.Tla&&Rd&&zg.push(new gy(Q,a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),An));kh.jdd=new CN(Q,rh,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Box4.Graph.IGraphInstance").yd(7),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.IPresentationReader"),
Fc,a.resolve("PowerPointWebEditor.IApplicationSettings").Un,a.resolve("PowerPointWebEditor.IApplicationSettings").gD);zg.push(kh.jdd);zg.push(new GN(Q,Fc,Ul,a.resolve("PowerPointWebEditor.IApplicationSettings").ela));zg.push(new FN(zj,Fc,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),Q,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),wa,a.resolve("PowerPointWebEditor.View.ISelectionPane"),Nm,yj,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),ia,Kg,a.resolve("Box4.IPageView").Na,a.resolve("Common.Transaction.ITransactionFactory")));zg.push(new YM(zj,Fc,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),Q,wa,a.resolve("PowerPointWebEditor.View.IFormatShapePane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),
a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),Kg,l.Q7i,l.Hql,l.ela,a.resolve("PowerPointWebEditor.IImageViewManager")));zg.push(new $M(Fc,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),Q,wa,a.resolve("PowerPointWebEditor.View.IFormatTablePane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),
a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),cs.a(this.K),rg,Ik,ui));l.pqg?zg.push(new kN(zj,Fc,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),Q,Ld,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),wa,a.resolve("PowerPointWebEditor.View.IHeaderFooterPane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
a.resolve("PowerPointWebEditor.View.IViewEventSource"),qf,l.ZPe)):zg.push(new hN(zj,Fc,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),Q,Ld,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),wa,a.resolve("PowerPointWebEditor.View.IHeaderFooterPane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),qf,l.ZPe));zg.push(new UM(zj,Q,wa,Ld));l.powerPointSmartLookupIsEnabled&&
zg.push(new lN(rh,Q,Ld,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ec));l.RRk&&zg.push(new LM(cs.a(this.K),Q,a.resolve("PowerPointWebEditor.ISubtitleContext"),a.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),a.resolve("PowerPointWebEditor.Core.IAudioSettingsContext")));zg.push(new JM(Q,Fc,wa,qf,a.Ia("PowerPointWebEditor.IAudioManagerStore"),l.kQ,a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState")));zg.push(new FM(Q,
Fc,qf,Ld,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),io,l.dai,l.BTl,l.Ele,l.t2d,l.j3,()=>this.K.resolve("PowerPointWebEditor.IMediaUploader")));l.XRk&&zg.push(new sN(cs.a(this.K),l.VRk,l.WRk,Q,ec,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
Fc,jl));l.pptoCaptionDiscoverabilityPaneEnabled&&zg.push(new Vv(cs.a(this.K),Q,a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPoint.IPathManager"),a.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),a.resolve("PowerPointWebEditor.ISubtitleContext"),a.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),a.resolve("PowerPointWebEditor.ISlideshowFrame"),l.SRk));kh.SCg=new XM(Q,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
qf,a.resolve("Box4.Graph.IGraphInstance").yd(82));zg.push(kh.SCg);eb.a("PptJOfcBrowserGraphNode")&&(kh.gLg=new qN(Q,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),qf,a.resolve("Box4.Graph.IGraphInstance").yd(83)),zg.push(kh.gLg));for(const gf of zg)gf.vb(),gf.pe();An.M5b=Rd});(new yN(c.gH(),c.sae(),b,xj,Fc,a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IActionNameResolver"))).vb();w.AFrameworkApplication.Aa&&
w.AFrameworkApplication.Aa.ob.Npe&&PR()}dispose(){this.Bma.dispose();this.EA.dispose();this.UFe.dispose();this.aAe.dispose();this.$ze.dispose();this.jdd&&this.jdd.dispose();const a=this.K.Ia("PowerPointWebEditor.IDesignerManager").instance;a&&a.dispose()}}Object(m.a)(oP,"ActorPackage",null,[2,3]);class pP{constructor(a,b,c,f,l,y,H,Q,ia,wa){this.KH=!1;this.Tb=a;this.ta=b;this.Rf=c;this.KB=f;this.Sb=l;this.Rv=y;this.wb=H;this.vwa=Q;this.AZg=ia;this.Mc=wa;this.sEe=[0,1,2,3];this.F5=new Jd.a;for(const Ua of this.sEe)this.F5.$(Ua,
[]);this.F5.$(4,[]);this.Rf.FI(Object(I.a)(this,this.YB,"onActiveSlideChanged"));this.vwa.fk(Object(I.a)(this,this.bjd,"onMainMastersLoaded"));this.AZg.jja(Object(I.a)(this,this.aNe,"onSlideLoaded"));this.AZg.fk(Object(I.a)(this,this.toa,"onSlidePropertyChanged"));this.Mc.GC(Object(I.a)(this,this.OM,"onSessionClosed"));this.Mc.OQa(Object(I.a)(this,this.k1,"onSessionRehydrating"));this.Mc.HC(Object(I.a)(this,this.Mo,"onSessionRehydrated"));this.dWg=new Qx(Object(I.a)(this,this.qSk,"prefetchSlideMasterNode"),
250,15E3,8E3,500,"slide master node",this.wb,3);this.cWg=new Qx(Object(I.a)(this,this.pSk,"prefetchSlideMasterImage"),250,6E4,8E3,500,"slide master image",this.wb,3);this.YB(null,null)}YB(){this.p5d()}p5d(){const a=this.ta.Ba;a&&8===a.type&&a.Ua(zb.a.jj)&&a.Ua(zb.a.Ln)&&this.xKl(a.jj,a.Ln)}qSk(){if(!this.KH){var a=this.F5.ga(0),b=this.F5.ga(1);if(0<a.length){const c=a.length-1,f=a[c];this.B3j(f.first,f.second)&&(Array.removeAt(a,c),Array.add(b,f),this.dWg.Yvd(),this.Rv.oSk(f.first,f.second))}}}pSk(){if(!this.KH){this.Xwd(1,
2,c=>!!this.Sb.m$a(c.first,c.second));var a=this.F5.ga(2);if(0<a.length){const c=a[0];var b=this.Sb.m$a(c.first,c.second);b&&this.m1e(b)?(b=b.Uzb(new vr.a(b.Vp,b.Vk)),this.cWg.Yvd(),Array.removeAt(a,0),Array.add(this.F5.ga(3),c),this.KB.bxb(b,!0,()=>{this.Xwd(3,4,f=>!this.m1e(this.Sb.m$a(f.first,f.second)));this.cWg.Uvd()})):(Array.removeAt(a,0),Array.add(this.F5.ga(4),c))}this.Xwd(3,4,c=>!this.m1e(this.Sb.m$a(c.first,c.second)))}}BKf(){for(const a of this.sEe)Array.clear(this.F5.ga(a));Array.clear(this.F5.ga(4))}aNe(a,
b){(a=Object(qa.a)(118,b.node))&&a.uE&&this.vmc(a)}toa(a,b){a=b.property;b.node&&a===zb.a.Ln&&b.node===this.ta.Ba&&this.p5d()}vmc(a){if(this.y3j(a)&&a){const b=a.jj,c=a.Ln;b&&c&&(this.Xwd(1,2,f=>f.first===b&&f.second===c),this.dWg.Uvd())}}bjd(a,b){a=b.property;if(a===zb.a.OHb||a===zb.a.JY)this.BKf(),this.p5d()}OM(){this.KH=!0}k1(){this.BKf()}Mo(){this.KH=!1}xKl(a,b){this.z3j(a,b)||this.A3j(a,b)||Array.add(this.F5.ga(0),new fx.a(a,b))}A3j(a,b){for(const c of this.sEe)for(const f of this.F5.ga(c))if(f.first===
a&&f.second===b)return!0;return!1}z3j(a,b){for(const c of this.F5.ga(4))if(c.first===a&&c.second===b)return!0;return!1}Xwd(a,b,c){a=this.F5.ga(a);b=this.F5.ga(b);for(let f=a.length-1;0<=f;--f)if(c(a[f])){const l=a[f];Array.removeAt(a,f);Array.add(b,l)}}m1e(a){if(!a)return!1;a=a.Uzb(new vr.a(a.Vp,a.Vk));if(null===a)return!1;for(const b of a)if(!this.KB.w$b.Hrc(b).data)return!0;return!1}y3j(a){const b=this.Tb.Ef.sa(zb.a.xDh,null);if(!b)return!1;for(let c=0;c<b.length;++c)if(b[c].equals(a.id))return!0;
return!1}B3j(a,b){var c=this.Sb.XI();if(!c)return!1;for(let f=0;f<c.length;++f)if(c[f].Id===a){a=c[f].ContentMasters;if(!a)break;for(c=0;c<a.length;++c)if(a[c].Id===b)return!0;break}return!1}}Object(m.a)(pP,"SlideMasterPrefetchManager",null,[221]);var BS=d(994);class qP{constructor(a,b,c,f,l,y,H){this.Ab=!1;this.CX=null;if(!b)throw Error.argumentNull("appFrame");if(!f)throw Error.argumentNull("viewElementEventSource");if(!y)throw Error.argumentNull("taskManager");if(!l)throw Error.argumentNull("viewElementEventHandlers");
this.wb=y;this.Nr=a;this.Vb=b;this.pu=c;this.Gy=f;this.nd=l;this.dHg=H;this.Xok=new dd.a(0,1,0,Object(I.a)(this,this.z9k,"renderCommentShimmerHandler"),90,"115")}get isVisible(){return this.Ab}gxl(){if(!this.Ab&&this.Nr&&this.Nr.va){this.CX=this.wri();this.dHg||this.Nr.va.appendChild(this.CX);this.Nr.setVisibility(!0);this.dHg&&this.nd.ezf(Object(I.a)(this,this.$hd,"onCommentContainersChanged"));var a=new BS.a(!0);this.Gy.Xjh(a);this.Vb.Vhb(1);this.Ab=!0}}$hd(){this.Vb.gJc(Object(I.a)(this,this.Bph,
"renderCommentShimmerOnSlideResize"));this.nd.Q7k(Object(I.a)(this,this.$hd,"onCommentContainersChanged"))}Bph(){this.wb.Hb(this.Xok);this.Vb.cpd(Object(I.a)(this,this.Bph,"renderCommentShimmerOnSlideResize"))}z9k(){!this.CX||this.BZf()?xa.a.J(522724993,805,10,"Either CommentShimmerView is null or the Element is already added to DOM"):this.Nr.va.appendChild(this.CX)}Ihg(){if(this.Ab&&this.Nr&&this.Nr.va&&this.BZf()){this.Nr.va.removeChild(this.CX);this.CX=null;this.Ab=!1;var a={};a.commentShimmerHideTime=
(new Date).getTime();xa.a.J(523352018,809,50,ta.a.toJSON(a))}}N2i(){this.Ab&&this.Nr&&this.Nr.va&&(this.CX.className+=" CommentShimmerFadeAwayStyles",window.setTimeout(Object(I.a)(this,this.Ihg,"hideShimmerUX"),600))}wri(){const a=document.createElement("div");a.className="CommentShimmerFrameStyles";for(let b=0;2>b;b++)a.appendChild(this.xri());return a}xri(){const a=document.createElement("div");a.className=this.pu?"CommentShimmerContainerRtlStyles":"CommentShimmerContainerStyles";a.id="CommentShimmerContainer";
const b=document.createElement("div");b.className="CommentShimmerPersonaStyles";const c=document.createElement("div");c.className="CommentShimmerHeaderStyles";const f=document.createElement("div");f.className="CommentShimmerBodyDiv1Styles";const l=document.createElement("div");l.className="CommentShimmerBodyDiv2Styles";const y=document.createElement("div");y.className="CommentShimmerActionStyles";a.appendChild(b);a.appendChild(c);a.appendChild(f);a.appendChild(l);a.appendChild(y);return a}BZf(){return!!document.getElementById("CommentShimmerContainer")}}
Object(m.a)(qP,"CommentShimmerView",null,[222]);class YE{constructor(a,b){this.Vb=a;this.sxa=b;this.sxa.Izf(Object(I.a)(this,this.guh,"scaleOnUIChanged"))}dispose(){this.sxa.eph(Object(I.a)(this,this.guh,"scaleOnUIChanged"))}b6(){}a6(a){2===a.behavior&&(a=a.actionId,a!==ea.a.t1&&a!==ea.a.s1&&a!==ea.a.r1&&a!==ea.a.woa||this.updateCommandUI())}guh(){this.updateCommandUI()}updateCommandUI(){this.Vb.updateCommandUI()}}Object(m.a)(YE,"UpdateCommandUIActionListener",null,[143,107]);class ZE{constructor(){this.correlationId=
this.sessionId=this.yMd=null;this.actionId=0;this.zd=null}get Cf(){return this.yMd?this.yMd:""}set Cf(a){this.yMd=a}}Object(m.a)(ZE,"AssistanceSearchVariableUrlParameterSet",null,[]);class Br{constructor(){this.SP=!1;this.RP=!0;this.msf=this.iSb=null}get isInitialized(){return this.SP}initialize(a,b){const c=!!a&&!!b;c&&(this.iSb=a,this.msf=b);this.SP=c;w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1)||Ib.a.instance.Ia("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(f=>{f.Z3("Enabled").then(l=>{this.RP=l;return null},()=>null)})}vb(a){a||(a=w.AFrameworkApplication.Ra);w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)&&(this.RP=w.AFrameworkApplication.iF,Ib.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(b=>{b.isFeatureEnabled("mso_sendASmile",
!0).then(c=>{this.RP=w.AFrameworkApplication.iF&&c;(c=w.AFrameworkApplication.Aa)&&c.updateCommandUI();return null},()=>null)}));a.ya(G.a.QMb,ie.a.frame,Object(I.a)(this,this.dxl,"showSearchResults"))}dxl(a,b,c,f,l){if(1===c)return w.AFrameworkApplication.fa.ka("IsFeedbackExperiencesAvailable")||(this.RP=!1),l&&"SourceControlId"in l&&(l=l.SourceControlId,("GiveFeedback"===l||"btnFeedback"===l||"btnFeedbackPane"===l||"PptEditingStatusBar.GiveFeedbackPane"===l||"GiveFeedbackPane"===l)&&!this.RP)?8:
sz.SessionStatusManager.instance.gla?8:32;ka.ULS.sendTraceTag(4761738,1302,50,"");pb.a.mark(4771);if(this.isInitialized){a=l.CommandValueId;b=l.SourceControlId;l=Object.assign(new ZE,{actionId:G.a.QMb,zd:l});if(void 0!==a&&null!==a)l=Br.fwj(a);else if(void 0!==b&&null!==b)switch(b){case "btnFeedback":case "btnFeedbackPane":case "PptEditingStatusBar.GiveFeedbackPane":case "GiveFeedbackPane":case "GiveFeedback":l.actionId=G.a.giveFeedback;break;case "btnContactSupport":case "ContactSupport":l.actionId=
G.a.r_d;break;case "btnShowTraining":case "Training":l.actionId=G.a.tJh;break;case "btnWhatsNew":case "WhatsNew":l.actionId=G.a.FQh}this.iSb.jvl(this.msf,l);pb.a.mark(4772);return 32}pb.a.mark(4772);return 8}dispose(){this.iSb&&(this.iSb.dispose(),this.iSb=null)}static get instance(){Br.La||(Br.La=new Br);return Br.La}static fwj(a){const b=new ZE,c=a.indexOf("|");b.sessionId=a.substring(0,c);const f=a.indexOf("|",c+1);b.correlationId=a.substring(c+1,f);b.Cf=a.substr(f+1);return b}}Br.La=null;Object(m.a)(Br,
"AssistanceActor",null,[107]);class $E{constructor(){this.Bbf=this.Oa=this.oob=null;this.BLd=!1}jvl(a,b){if(b.actionId!==G.a.giveFeedback||w.AFrameworkApplication.iF)if(this.BLd&&!w.AFrameworkApplication.ata)this.oob||(this.oob=this.Bbf()),this.oob.hl(a,b);else if(b.actionId===G.a.giveFeedback)this.Uul();else{a=a.IXc(b);b=null;try{ma.a.C9(a)&&(b=Bd.a.En(a,"_blank","height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no",
"AssistanceDisplayManager:HelpWindow"))}catch(c){throw ka.ULS.sendTraceTag(4543175,1302,10,"An exception has occured while trying to launch the Online Assistance window: "+c.message),c;}b?ka.ULS.sendTraceTag(4543177,1302,50,"Window.Open() returned a window when opened with URL {0}",a):ka.ULS.sendTraceTag(4543176,1302,15,"Window.Open() returned a null window when opened with URL {0} and help options {1}",a,"height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no")}else ka.ULS.sendTraceTag(554295451,
356,15,"ShowFeedbackButton is false, but ShowContent got called, some feedback entry point is still visible")}dispose(){this.oob&&(this.oob.dispose(),this.oob=null)}ezh(a,b,c){c&&uk.b(a)?this.BLd=!1:(this.Bbf=a,this.BLd=c);this.Oa=b}Uul(){w.AFrameworkApplication.Ra.processAction(G.a.giveFeedback,2)}static createInstance(a,b,c=null){const f=new $E;null==c?f.ezh(a,b,w.AFrameworkApplication.qDf||b.ka("HelpTabIsEnabled")):f.ezh(a,b,c);return f}}Object(m.a)($E,"AssistanceDisplayManager",null,[513,107]);
class fw{constructor(a,b,c,f,l){this.NG=a;this.Q2h=b;this.uDc=c;this.gUh=f;this.xmf=l}get lcid(){return this.NG}get namespace(){return this.Q2h}get wJa(){return this.uDc}get Imi(){return this.gUh}get locale(){return this.xmf}static Ovj(a){const b=a.indexOf(".");return 0<=b&&b<a.length&&(a=parseInt(a.substring(0,b)),!isNaN(a))?a:fw.Gni}static createInstance(a){return new fw(w.AFrameworkApplication.lcid,a,fw.Ovj(w.AFrameworkApplication.buildVersion),"WDWAENDUSER,XLWAENDUSER,PPWAENDUSER,ONWAENDUSER",
bb.a.He(w.AFrameworkApplication.lcid).name)}}fw.Gni=16;Object(m.a)(fw,"AssistanceSearchUrlParameterSet",null,[]);class aF{constructor(a,b){a=new Jh.QueryStringBuilder(a);a.jg("clid",b.lcid.toString());a.jg("p1",b.namespace);a.jg("ver",b.wJa.toString());a.jg("apps",b.Imi);a.jg("lc",b.locale);this._url=a.toString()}IXc(a){const b=new Jh.QueryStringBuilder(this._url);b.jg("src","TellMe");b.jg("query",a.Cf);b.jg("sessionid",a.sessionId);b.jg("correlationid",a.correlationId);return b.toString()}static createInstance(a){return new aF(w.AFrameworkApplication.rDf,
a)}}Object(m.a)(aF,"AssistanceSearchUrlProvider",null,[484]);class bF{Yb(){}init(){w.AFrameworkApplication.wtb&&!w.AFrameworkApplication.BPb&&Br.instance.vb(w.AFrameworkApplication.Ra)}dispose(){Br.instance.dispose()}Jjg(a){Br.instance.initialize($E.createInstance(a,w.AFrameworkApplication.fa),aF.createInstance(fw.createInstance("PPWAEndUser")))}}Object(m.a)(bF,"AssistancePackage",null,[2,3]);var CS=d(1046);class rP{constructor(a,b,c,f,l,y){this.ia=a;this.Oc=b;this.uve=c;this.Tfk=f;this.Qye=l;this.V9=
y}hl(a,b){if(b&&this.ia){a={};let c;switch(b.actionId){case G.a.r_d:a.query="contactsupport";c=ResourceStrings.L_ContactSupport;break;case G.a.giveFeedback:a.feedback=this.DGi(b);a.query="givefeedback";c=ResourceStrings.L_GiveFeedback;break;case G.a.tJh:a.query="showtraining";c=ResourceStrings.L_Training;break;case G.a.FQh:a.query="whatsnew";c=ResourceStrings.L_WhatsNew;break;default:a.query=b.Cf,c=ResourceStrings.L_Help}const f={};f.ZA=c;f.assetId="FA000000012";this.V9.W1c&&b.actionId===G.a.giveFeedback&&
(f.sourceLocationOverrideResourceId="Help.GiveFeedback.Url");f.nonPersistedSettings=a;f.c$e=!1;b.actionId==G.a.r_d&&(f.sourceLocationOverrideResourceId="Help.ContactSupport.Url");this.ia.Ka(ea.a.Oga,2,f)}}Iq(){const a=this.Cyb();a&&this.ia&&this.ia.Ka(ea.a.Vub,2,a)}dispose(){}Cyb(){if(this.Oc.instance){const a=this.Oc.instance.zQ("FA000000012");if(a)return a.instanceId}return null}DGi(a){this.V9.W1c||(this.Qye?this.Qye.OVb?this.HIf():this.Tfk.p4d(Object(I.a)(this,this.g3i,"feedbackDownloaded")):xa.a.J(512324302,
1302,15,"feedbackFormManager is undefined"));a=a.zd?a.zd:{};w.AFrameworkApplication.fa.pSd(a);a=this.uve.getContext(a);let b={};"telemetryGroup"in a&&(b=a.telemetryGroup);b.processSessionId=a.sessionId;b.officeBuild=a.build;a.telemetryGroup=b;if(void 0===a.feedbackType||null===a.feedbackType)a.feedbackType=-1;"disableIncludeScreenshot"in a||(a.disableIncludeScreenshot=!1);"screenshot"in a||(a.screenshot=!0);a.disableScreenshotPreview=!1;a.includeScreenshotSelectedDefault=!0;return a}HIf(){if(CS.a.S6g())xa.a.J(512324300,
1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(Object(I.a)(this,this.wgh,"postScreenshotData"));return}catch(a){xa.a.J(512324299,1302,15,"Failed to use createScreenshot. "+(a?"Message: "+a.message+" Stack: "+a.stack:null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(Object(I.a)(this,this.wgh,"postScreenshotData"))}catch(a){xa.a.J(512324298,1302,15,"Failed to use html2canvas. "+(a?"Message: "+a.message+" Stack: "+a.stack:null))}}}g3i(a){a&&
(this.Qye.Mtg(a),this.HIf())}wgh(a){a=a.toDataURL("image/jpeg");const b=this.Cyb(),c={};c.screenshot=a;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(b,"onScreenshot",c,null)}}Object(m.a)(rP,"AgaveAssistancePane",null,[459,107]);class sP extends bF{constructor(){super();this.xbf=this.hgf=this.Rdf=this.Sdf=this.Da=null;this.Load=this.load}get name(){return"PowerPointEditor.Assistance"}Yb(a){this.Da=a}load(){this.init()}init(){super.init();!w.AFrameworkApplication.wtb&&w.AFrameworkApplication.BPb?
xa.a.J(512258326,1302,50,"Not initializing the PowerPoint Assistance package because the feature is disabled."):(xa.a.J(512258325,1302,50,"Initializing the PowerPoint Assistance package (the feature is enabled)."),w.AFrameworkApplication.fa.ka("HelpTabIsEnabled")?(this.Sdf=this.Da.resolve("Common.App.ICustomerFeedbackUiWrapper"),this.Rdf=this.Da.resolve("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"),this.hgf=this.Da.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager"),
this.xbf=this.Da.resolve("PowerPointWebEditor.IApplicationSettings"),this.Jjg(()=>new rP(this.Da.resolve("Common.IActionManagerExtended"),this.Da.Ia("PowerPointWebEditor.IAppForOfficeManager"),this.Sdf,this.Rdf,this.hgf,this.xbf))):this.Jjg(null))}}Object(m.a)(sP,"PowerPointAssistancePackage",bF,[336]);class cF{A5i(a,b,c){return a?this.A4i(b,c):this.B5i(b,c)}n0f(a,b,c){return a?this.c5i(b,c):this.V4i(b,c)}T4i(a){var b=a.Af?a.qg.jf:a.qg.Va;const c=new ob.GraphIterator;a.rq?c.Tc(a.rq):c.set(b.node);
c.sc(14);a=new ob.GraphIterator;a.Tc(c);a.sc(14);b=ae.findControllingCellFromNode(c.currentNode);let f=null,l=!1;if(!ae.isLastCellInRow(a)){do if((f=Sd.moveToNextColumn(a))&&ae.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!ae.isLastCellInRow(a))}if(!l&&!ae.isLastCellInColumn(c)){do if((f=Sd.moveToNextRow(c))&&ae.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!ae.isLastCellInColumn(c))}return l?f:null}a5i(a){var b=a.Af?a.qg.jf:a.qg.Va;const c=new ob.GraphIterator;a.rq?c.Tc(a.rq):
c.set(b.node);c.sc(14);a=new ob.GraphIterator;a.Tc(c);a.sc(14);b=ae.findControllingCellFromNode(c.currentNode);let f=null,l=!1;if(!ae.isFirstCellInRow(a)){do if((f=Sd.moveToPreviousColumn(a))&&ae.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!ae.isFirstCellInRow(a))}if(!l&&!ae.isFirstCellInColumn(c)){do if((f=Sd.moveToPreviousRow(c))&&ae.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!ae.isFirstCellInColumn(c))}return l?f:null}PSc(a,b){var c=a.Af?a.qg.jf:a.qg.Va;const f=new ob.GraphIterator;
a.rq?f.Tc(a.rq):f.set(c.node);f.sc(14);a=ae.findControllingCellFromNode(c.node);c=null;if(b){do{if(ae.isFirstCellInColumn(f))break;c=Sd.moveToPreviousRow(f)}while(c&&ae.findControllingCellFromNode(c)===a)}else{do{if(ae.isLastCellInColumn(f))break;c=Sd.moveToNextRow(f)}while(c&&ae.findControllingCellFromNode(c)===a)}return c}m0f(a,b){if(!vk.l(a))return null;a=ob.GraphIterator.pb(a.currentNode);a.sc(14);let c;const f=cd.TableReader.wt(a.origin);do c=b?Sd.moveToPreviousRow(a):Sd.moveToNextRow(a);while(f&&
c&&vk.h(a));return c}YZa(a,b,c,f,l){let y=null;Za.OutlineElementNavigator.Te(a);const H=Wd.OutlineElementReader.isRtl(a.currentNode);if(c)if(Sd.returnToCell(a),b=ae.isLastCellInRow(a),c=ae.isFirstCellInRow(a),l||!H&&c||H&&f&&b)Sd.returnToContainingRow(a),(f=this.m0f(a,!0))?y=Od.SelectionFactory.Aj(f,!b):l&&(Za.OutlineElementNavigator.Te(a),l=new Cn.a,l.Tc(a),(a=Za.OutlineElementNavigator.zxa(l,!1,!1))&&(y=Od.SelectionFactory.Aj(a,!1)));else{do H?Sd.moveToNextColumn(a):Sd.moveToPreviousColumn(a);while(ae.isGhostCell(a)&&
!ae.isFirstCellInColumn(a));ae.isGhostCell(a)||(y=Od.SelectionFactory.Aj(a.currentNode,!H))}else Wd.OutlineElementReader.fD(a,b,H)||Mb.SelectionEditor.Xg(b)||Sd.returnToCell(a),y=Od.SelectionFactory.Aj(a.currentNode,!H);return y}XZa(a,b,c,f,l){let y=null;Za.OutlineElementNavigator.Te(a);const H=Wd.OutlineElementReader.isRtl(a.currentNode);if(c)if(Sd.returnToCell(a),c=ae.isLastCellInRow(a),b=ae.isFirstCellInRow(a),l||!H&&f&&c||H&&!f&&b)Sd.returnToContainingRow(a),(f=this.m0f(a,!1))?y=Od.SelectionFactory.Aj(f,
b):(Za.OutlineElementNavigator.Te(a),f=new Cn.a,f.Tc(a),(a=Za.OutlineElementNavigator.ZJ(f,!1,!1))&&(y=Od.SelectionFactory.Aj(a,!0)));else{do H?Sd.moveToPreviousColumn(a):Sd.moveToNextColumn(a);while(ae.isGhostCell(a)&&!ae.isLastCellInRow(a));ae.isGhostCell(a)||(y=Od.SelectionFactory.Aj(a.currentNode,H))}else Wd.OutlineElementReader.fD(a,b,!H)||Mb.SelectionEditor.Xg(b)||Sd.returnToCell(a),y=Od.SelectionFactory.Aj(a.currentNode,H);return y}}Object(m.a)(cF,"ATableCellSelectionStrategy",null,[483]);
class dF extends cF{constructor(){super()}V4i(a,b){var c=a.mb;let f=null;if(a.Sl){let l=null;if(b){if(c.rq=a.nka,a=Object(qa.a)(Vl.TableCellNode,this.T4i(c)))a.isGhostCell&&(l=a,a=a.mz()),f=c.ZG.isValid&&c.ZG.node&&a===c.ZG.node?Od.SelectionFactory.Aj(c.ZG.node,!c.Af):Od.SelectionFactory.Mu(pr.TableNodeContext.create(Object(qa.a)(pg.a,a)),c.Af)}else if(c=a.ga(Math.max(0,Math.min(a.Zja,a.Lza))),c=Object(qa.a)(Vl.TableCellNode,c.qg.jf.node),c.isControllingCell&&(c=c.Eae(2)),a=c.D_(),b=c.LUc().EJa,!a&&
b&&(c=b.N0f),a=c)a.isGhostCell&&(l=a,a=a.mz()),f=Mb.SelectionEditor.fm(Od.SelectionFactory.nl(Object(qa.a)(pg.a,a)),!0,!1);f&&l&&(f.rq=ob.GraphIterator.pb(l))}return f}c5i(a,b){let c=a.mb,f=null;a.Sl&&(b?(c.rq=a.nka,a=Object(qa.a)(Vl.TableCellNode,this.a5i(c)),b=null,a&&(a.isGhostCell&&(b=a,a=a.mz()),(f=c.ZG&&c.ZG.isValid&&a===Object(qa.a)(130,c.ZG.node)?Od.SelectionFactory.Aj(c.ZG.node,!c.Af):Od.SelectionFactory.Mu(pr.TableNodeContext.create(Object(qa.a)(pg.a,a)),c.Af))&&b&&(f.rq=ob.GraphIterator.pb(Object(qa.a)(pg.a,
b))))):(a.Zja>a.Lza?(c=a.N6,c.rq=c.Af?a.c2a:null):c.rq=c.Af?null:a.nka,f=Mb.SelectionEditor.fm(Od.SelectionFactory.nl(c.qg.Va.node),!0,!1),f.rq=c.rq));return f}B5i(a,b){let c=a.mb;var f=null;if(a.Sl){const l=a.Zja>a.Lza;let y=null;if(b){if(c.rq=a.nka,a=Object(qa.a)(Vl.TableCellNode,this.PSc(c,!0)))a.isGhostCell&&(y=a,a=a.mz()),f=l&&c.ZG&&c.ZG.isValid&&a===c.ZG.node?Od.SelectionFactory.Aj(c.ZG.node,!c.Af):Od.SelectionFactory.Mu(pr.TableNodeContext.create(Object(qa.a)(pg.a,a)),c.Af)}else l?(c=a.N6,
c.Af&&(c=c.hxb(),c.rq=a.c2a)):c.Af?c=c.hxb():c.rq=a.nka,f=Object(qa.a)(Vl.TableCellNode,this.PSc(c,!0)),f?f.isGhostCell&&(y=f,f=f.mz()):(f=Object(qa.a)(Vl.TableCellNode,c.qg.Va.node),y=c.rq?Object(qa.a)(Vl.TableCellNode,c.rq.currentNode):null),f=Od.SelectionFactory.Aj(Object(qa.a)(pg.a,f),!0);f&&y&&(f.rq=ob.GraphIterator.pb(Object(qa.a)(pg.a,y)))}return f}A4i(a,b){let c=a.mb;var f=null;if(a.Sl){const l=a.Zja<a.Lza;let y=null;if(b){if(c.rq=a.nka,a=Object(qa.a)(Vl.TableCellNode,this.PSc(c,!1)))a.isGhostCell&&
(y=a,a=a.mz()),f=l&&c.ZG&&c.ZG.isValid&&a===Object(qa.a)(130,c.ZG.node)?Od.SelectionFactory.Aj(c.ZG.node,!c.Af):Od.SelectionFactory.Mu(pr.TableNodeContext.create(Object(qa.a)(pg.a,a)),c.Af)}else l?(c=a.N6,c.Af&&(c=c.hxb(),c.rq=a.c2a)):c.Af?c=c.hxb():c.rq=a.nka,f=Object(qa.a)(Vl.TableCellNode,this.PSc(c,!1)),f?f&&f.isGhostCell&&(y=f,f=f.mz()):(f=Object(qa.a)(Vl.TableCellNode,c.qg.Va.node),y=c.rq?Object(qa.a)(Vl.TableCellNode,c.rq.currentNode):null),f=Od.SelectionFactory.Aj(Object(qa.a)(pg.a,f),!0);
f&&y&&(f.rq=ob.GraphIterator.pb(Object(qa.a)(pg.a,y)))}return f}}Object(m.a)(dF,"TableCellSelectionStrategy",cF,[]);class tP extends dz{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc){super(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,yc,tc);this.D6h=l;this.u_h=c;this.gzc=Fc}V2b(a,b){var c=Object(qa.a)(ep,b);c&&c.X_a&&this.Yyi(this.u_h.e6e)&&(c=c.X_a.sa(km.a.Wb,""),this.gzc.dlc(c),this.gzc.hC(6,c));return super.V2b(a,b)}Yyi(a){const b=new uC;for(b.enqueue(a);0<b.count;){a=b.dequeue();if(14===a.type)return!0;
a=ob.GraphIterator.pb(a);let c=a.Oi();for(;c;)b.enqueue(c),c=a.np()}return!1}zPc(a,b){var c=Object(qa.a)(ep,b);if(c&&c.X_a){c=c.X_a.sa(km.a.Wb,"");const f=Object(qa.a)(5,this.D6h.Pa.mb.jf.node);f&&(f.Wb=c)}return super.zPc(a,b)}}Object(m.a)(tP,"PPTClipboardOperationCutCopy",dz,[]);class uP{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc,yc,tc){this.Ca=a;this.qd=b;this.ls=c;this.bW=y;this.Uc=l;this.Ji=f;this.Cr=H;this.rf=Q;this.yia=ia;this.SK=wa;this.zia=Ua;this.crb=kb;this.m6a=Gb;this.Oa=ec;this.lk=
dc;this.gzc=Fc;this.ud=yc;this.jd=tc}create(){return new tP(this.Ca,this.qd,this.ls,this.Ji,this.Uc,this.bW,this.Cr,this.rf,this.yia,this.SK,this.zia,this.crb,this.m6a,this.Oa,this.lk,this.gzc,this.ud,this.jd)}}Object(m.a)(uP,"Factory",null,[335]);class vP{constructor(){}get vld(){return!1}Ktb(){}get n3g(){return!1}set n3g(a){}get evk(){return!1}noa(){}r_a(){}get C6g(){return-1}get OPc(){return null}}Object(m.a)(vP,"NoImageSteward",null,[481]);class eF{constructor(a){this.hhc=a}create(a,b){return this.hhc||
1!==a?new vP(b):null}}Object(m.a)(eF,"PPTImageStewardFactory",null,[463]);class Oq extends js{constructor(a,b,c,f,l,y,H){super(a,b,c);this.ia=f;this.Mx=l;this.Ec=H;this.Njk=y.lNk;this.aYa=y.Hme;this.njk=y.Gme;this.hhc=y.pBb;this.Ojk=y.S0j}foe(a,b,c){const f=Oq.G4f(c);a=(!N.a.instance.ga(82)||this.W_j(a,b,f))&&super.foe(a,b,c);3===c.URa?this.Ec.Yw(2,f):2===c.URa&&this.Ec.Yw(3,f);a&&(this.Ec.dlc(f),this.XMh(b,f));return a}V0e(a,b,c){const f=Oq.G4f(c);a.setAttribute(zu.a.QIf,f);let l=!1;const y=Oq.U_j(a);
if(y)xa.a.J(17310354,826,50,null),l=!0;else if(this.Ojk&&1===a.getElementsByTagName("Table").length&&!b.iterator.sc(60))this.Ec.hC(6,f),l=!0;else{const H=Hb.b(a);H&&H.length||!Oq.x7b(a)||(xa.a.J(17310356,826,50,null),l=!0)}l&&!Oq.qth&&(w.AFrameworkApplication.dM("Microsoft.Office.Server.Powerpoint.Web.IPasteContentFromPandoraSettings"),Oq.qth=!0);if(!this.Njk)return!0;l&&(this.hhc&&this.Bqg(c)?xa.a.J(36779848,826,50,"Paste text only action."):(xa.a.J(17310358,826,50,null),this.I0i(a.cloneNode(!0),
y)));if(a=!l&&super.V0e(a,b,c))this.Ec.dlc(f),this.Ec.hC(1,f),this.XMh(b,f);return a}I0i(a,b){b&&a.firstChild&&a.firstChild.className&&(a.className=a.firstChild.className,(this.aYa||this.njk)&&this.Mx.SBi(a.firstChild,a));Nc.a.bba(()=>{this.ia.Ka(ea.a.Ceh,2,a)},100)}W_j(a,b,c){if(w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("ComplexTableCellPasteWithFormattingIsEnabled")){a=Oq.wuj(a);if(1!==a.count)return!1;this.Ec.hC(6,c);a=a.ga(0);return!w.AFrameworkApplication.fa.ka("ComplexTableCellPasteFromComplexTableIsEnabled")&&
this.UGj(a)?!1:Oq.o0j(b)}c=Object(qa.a)(5,b.iterator.currentNode);let f=null;c&&(f=(c=c.AL())?c.getContainingTable():null);return!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("PPTInternalPasteTableInTableIsEnabled")&&b.Pk&&b.node.Ua(zb.a.cellId)&&1===a.getElementsByTagName("Table").length&&!!f&&!f.Op()}UGj(a){a=a.getElementsByTagName("Table");if(1===a.length){a=a[0].getElementsByTagName("td");for(let c=0;c<a.length;c++){var b=a[c];if(!b)continue;const f=b.attributes.getNamedItem("rowspan");
if(!f||!f.specified||"1"!==f.value)return!0;b=b.attributes.getNamedItem("colspan");if(!b||!b.specified||"1"!==b.value)return!0}}return!1}XMh(a,b){if(Object(qa.a)(5,a.node)&&a.iterator)if(a.iterator.sc(10)){if(a=Object(qa.a)(4,a.iterator.ix(10)))a.Wb=b}else a.iterator.sc(60)&&(a=Object(qa.a)(461,a.iterator.ix(60)))&&(a.Wb=b)}static wuj(a){a=a.getElementsByTagName("Table");if(1===a.length){var b;return b=new Na.a,b.add(a[0]),b}b=new Na.a;if(2===a.length){for(let c=0;c<a.length;c++){if(0<a[c].getElementsByTagName("Table").length){if(0<=
a[c].className.indexOf("Selected_Table"))continue;b.clear();break}b.add(a[c])}1<b.count&&b.clear()}return b}static o0j(a){return a.Pk&&a.node.Ua(zb.a.cellId)&&a.iterator.sc(14)?!0:!1}static x7b(a){a=a.getElementsByTagName(rb.a.n4);if(!a.length)return null;a=a[0];return a.src?a:null}static U_j(a){return!!a.firstChild&&!!a.firstChild.className&&mS.a.Elg(a.firstChild.className)}static G4f(a){let b="";a&&a.X_a&&(b=a.X_a.sa(km.a.Wb,""));return b}}Oq.qth=!1;Object(m.a)(Oq,"PPTPasteCoordinator",js,[]);class wP{constructor(){}Ktb(){}get sda(){return!1}zY(){}wY(){}yY(){}xY(){}vY(){}uY(){}}
Object(m.a)(wP,"TextOnlyTableSteward",null,[479,480]);class fF{constructor(a){this.hhc=a}create(a,b){return this.hhc||1!==a?new wP(b):null}}Object(m.a)(fF,"PPTTableStewardFactory",null,[462]);class gF{constructor(a,b,c){this.Jhk=a;this.Hkk=b;this.la=c}vUe(){this.Jhk.execute(a=>{this.la.Soe&&a.HUe(this.Hkk.value)})}}Object(m.a)(gF,"AccessibilityActor",null,[]);class Gu{get key(){return"LIST"}get y8(){return Box4Intl.Box4Strings.l_ListContentTitle}G7e(a){let b;b=null;const c=Gu.Uf.Gv(a);if(!c)return{returnValue:!1,
kvb:b};a=this.mkj(a,c);b=Object.assign(new $y,{u1:this.key,contentId:a.listId,nQ:a});return{returnValue:!0,kvb:b}}PUc(a,b){a=a.nQ;const c=this.rjj(a.hU),f=new qj.a;b?(b=b.nQ,b.level!==a.level?(f.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,a.level)),f.add(c)):b.id.equals(a.id)&&b.hU.listType===a.hU.listType||f.add(c)):(f.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),f.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,a.level)),f.add(c));
return f.toArray().join(" ")}rjj(a){let b="";const c=a.listStyle;if(0===a.listType)b=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,a.oX);else if(1===a.listType)switch(c){case 1:b=this.VFf;break;case 2:b=this.lti;break;case 3:b=this.mti;break;default:b=this.VFf}return b}static get Uf(){return Gu.fh||(Gu.fh=Ib.a.instance.resolve("Box4.List.IListReader"))}}Gu.fh=null;Object(m.a)(Gu,"ListDetailsProvider",null,[476,477]);class xP{constructor(){this.hU=this.listId=this.id=null;this.level=
0}}Object(m.a)(xP,"ListItemInfo",null,[]);class hF extends Gu{constructor(a){super();this.HH=a}get VFf(){return ResourceStrings.l_BulletStyle1}get lti(){return ResourceStrings.l_BulletStyle1}get mti(){return ResourceStrings.l_BulletStyle1}mkj(a,b){const c=this.HH.Sda(a),f=this.HH.kkj(a);return Object.assign(new xP,{id:a.currentNode.id,listId:new ha.a(Hg.a.nil,f),hU:b,level:c+1})}}Object(m.a)(hF,"ListDetailsProvider",Gu,[]);class yP{constructor(){this.xH=this.K=null}dispose(){}Yb(a){this.K=a;this.xH=
this.K.resolve("Common.AFrameworkApplication");a.register(eF,"PowerPointWebEditor.PPTImageStewardFactory").as("Box4.Actors.IBox4ImageStewardFactory").ma().oa(()=>new eF(a.resolve("PowerPointWebEditor.IApplicationSettings").pBb));a.register(fF,"PowerPointWebEditor.PPTTableStewardFactory").as("Box4.Actors.IBox4TableStewardFactory").ma().oa(()=>new fF(a.resolve("PowerPointWebEditor.IApplicationSettings").pBb));a.register(js,"Box4.Actors.PasteCoordinator").ma().oa(()=>new Oq(a.resolve("Box4.Actors.InternalClipboard"),
a.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),a.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));a.register(335,"Box4.Actors.IClipboardOperationCutCopyFactory").ma().oa(()=>new uP(w.AFrameworkApplication.Ra,mc.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.IOutlineElementEditor"),
ge.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Box4.IParagraphReader"),fi.a.instance,a.resolve("Box4.IOutlineElementNavigator"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.IOutlineElementReader"),a.resolve("Box4.IRenderOrderGraphIteratorFactory"),a.resolve("Box4.ISelectionFactory"),a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),Qc.a.instance,a.resolve("Box4.IEditingDomManager")));
a.register(hF,"PowerPointWebEditor.ListDetailsProvider").oa(()=>new hF(a.resolve("PowerPointWebEditor.IPptListCore")));a.register(gF,"PowerPointWebEditor.AccessibilityActor").ma().oa(()=>new gF(a.Ia("Box4.Accessibility.IAccessibilityContextManager"),a.oe("PowerPointWebEditor.ListDetailsProvider"),this.xH.dT.rd));a.register(dF,"PowerPointWebEditor.TableCellSelectionStrategy").as("Box4.ITableCellSelectionStrategy").ma().oa(()=>new dF)}init(){const a=Rc.App.hE.nT;Zx.QNj(this.xH.aq,this.K.resolve("Common.IReactContextualUILauncher"),
a,this.K.resolve("Common.IExternalUICommandDefinitionMapping"));this.K.resolve("PowerPointWebEditor.AccessibilityActor").vUe()}get name(){return"PowerPointWebEditor.Box4DelayedLoadedPackage"}}Object(m.a)(yP,"Box4DelayedLoadedPackage",null,[2,3]);class zP{constructor(a,b,c,f,l,y,H,Q){this.Wdb=this.Mva=null;this.z5c=0;this.v5c=new Jd.a(0);this.meb=this.mwe=this.yfc=null;this.w5c=!1;this.KCg=[oa.a.contextMenu,oa.a.$za,oa.a.jN,oa.a.mouseDown,oa.a.pointerDown,oa.a.nRa,oa.a.Phb,oa.a.paste];this.a1g=[oa.a.Bf,
oa.a.Tl,oa.a.uy,oa.a.click,oa.a.doubleClick,oa.a.WR,oa.a.CWd,oa.a.YJ,oa.a.Sgd];this.yJ=a;this.fte=c||[];this.jek=f||[];this.Oue=l||[];this.eZg=y;this.Mc=b;this.Mc.Xei(Object(I.a)(this,this.E7g,"onAppClosing"));this.Mc.GC(Object(I.a)(this,this.WE,"onSessionEnd"));this.Hbd=H;Q&&(Md.EventHandlerManager.instance.CUe(this.KCg,Object(I.a)(this,this.XAk,"onBeforeEventActionContextCreated")),Md.EventHandlerManager.instance.Nmh(this.KCg,Object(I.a)(this,this.kAk,"onAfterEventActionContextCreated")),Md.EventHandlerManager.instance.CUe(this.a1g,
Object(I.a)(this,this.YAk,"onBeforeEventTriggered")),Md.EventHandlerManager.instance.Nmh(this.a1g,Object(I.a)(this,this.lAk,"onAfterEventTriggered")));this.bBe=!1}b6(a){if(2===a.behavior){var b=a.actionId;if(this.Bpa(b)){var c=this.getCommandName(b);xa.a.J(18956760,817,50,"ActionContextListener::OnBeforeAction "+this.nig(a,c,"",!1)+"; Current Event: "+(this.meb||"")+"; Current ActionContext: "+(Nc.a.Kb?Nc.a.Kb.toString():""));if(!this.z5c)if(this.w5c=!0,this.Frl(a)){this.Mva=Nc.a.Axd(c);this.bBe=
!0;a=a.telemetryData;c=this.yfc;let f=this.mwe;null===c&&a&&a[hh.a.kEa]&&(c=a[hh.a.kEa],f=Nc.a.knb(c));null!==f&&(this.Mva.Wa(hh.a.j7a,f.toFixed(2)),null!==c&&this.Mva.Wa(hh.a.kEa,c.toFixed(2)));a&&ta.a.forEach(a,(l,y)=>{this.Mva.eAa(l,(null===y||void 0===y?void 0:y.toString())||"")},null);c=!1;Array.contains(dl.Ngl,b)?c=!0:this.Mva.vr=!0;c=c||this.Oj(b,a);this.Mva.Oj=c}else this.Mva=Nc.a.Kb}this.z5c++}}a6(a){if(2===a.behavior){var b=a.actionId;if(this.Bpa(b)){var c=Nc.a.Kb;const f=c?c.tK(hh.a.pwf).toString():
"";xa.a.J(18956762,817,50,"ActionContextListener::OnAfterAction "+this.nig(a,this.getCommandName(b),f,!0)+";Result:"+a.response.toString()+";Current Event:"+(this.meb||"")+";Current ActionContext:"+(c?c.toString():"")+";RevisionId: "+(c?c.tK(hh.a.LY).toString():""))}this.gul(b)&&(c=this.v5c.sWc(b,0),this.v5c.add(b,c+1));this.z5c--;0<this.z5c||!Nc.a.Kb||!this.Mva||(Nc.a.Ak(hh.a.qai,a.response.toString()),Nc.a.Kb!==this.Mva||this.Wdb||this.y7g(),this.Mva=null)}}y7g(){const a=Nc.a.Kb;if(a){var b=new Date;
a.Oj&&!a.zOb&&null===a.FF&&(a.FF=b);a.eAa(hh.a.kai,(+b-+a.dE).toString());a.vr?0<a.tK(hh.a.LY).length&&Nc.a.Jaa(a):Nc.a.gxd();this.bBe&&(Nc.a.Kb=null,this.bBe=!1)}}Bpa(a){if(!this.eZg)return!1;if(Array.contains(this.fte,a))return!0;a=w.AFrameworkApplication.Ra.GT(a);return!!a&&!(a.flags[32]||a.flags[64])}Oj(a,b){return Array.contains(this.jek,a)?b&&hh.a.nIc in b?b[hh.a.nIc]:!0:!1}gul(a){return this.eZg&&Array.contains(this.Oue,a)}Frl(a){return this.Hbd?!Nc.a.Kb:!Nc.a.Kb&&a.Wi}nig(a,b,c,f){if(null===
a)return"null";b="ActionName="+b+", IsTableShapeSelected="+c+", ActionId="+a.actionId+", BeginMode="+a.LKc+", InvocationMethod="+a.XT+", CommandLocation="+a.eq+", CommandTabName="+a.Dsa;return f?"Response="+a.response+", "+b:b}getCommandName(a){const b=this.yJ?this.yJ.t6(a):null;return b?b:a.toString()}E7g(){if(!(1>this.v5c.count)){var a={};this.v5c.forEach((b,c)=>{b=this.getCommandName(b);a[b]=c;return!0});xa.a.J(512491875,817,15,"ActionContextListener::OnAppClosed {0}",De.c(a));this.Mc.d7k(Object(I.a)(this,
this.E7g,"onAppClosing"))}}WE(){Nc.a.rAi()}XAk(a){this.meb=a.type;this.Wdb=Nc.a.Axd(this.meb);this.Wdb.Oj=!0;this.w5c=!1;a=Nc.a.kxd(a);null!==a&&Nc.a.bJl(a)&&this.Wdb.Wa(hh.a.kEa,a.toFixed(2))}kAk(){this.Wdb&&Nc.a.Kb===this.Wdb&&this.w5c&&this.y7g();Nc.a.Kb=null;this.w5c=!1;this.Wdb=this.meb=null}YAk(a){this.meb=a.type;this.yfc=Nc.a.kxd(a);null!==this.yfc&&(this.mwe=Nc.a.knb(this.yfc))}lAk(){this.meb=this.mwe=this.yfc=null}}Object(m.a)(zP,"ActionContextListener",null,[143]);var DS=d(378);class iF{constructor(){this.K=
null;this.NBg=[];this.el=null;this.Cwa="";this.zjk=!1;this.YX=[new yP,new oP];this.x$=!!window.performance&&!!window.performance.now}get name(){return"PowerPointWebEditor.EditingPackage"}Yb(a){this.Cwa=String.format("EditingPackage ConfigureStart:{0}",(new Date).getTime());wg.a.instance.lc("EditingPackageConfigureStart",Date.now());this.K=a;this.vb();for(const b of this.YX)b.Yb(a);this.K.resolve("PowerPointWebEditor.IApplicationSettings").Jog&&this.K.register(221,"PowerPointWebEditor.ISlideMasterPrefetchManager").ma().oa(()=>
new pP(this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.Image.IImageManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IInboundHelper"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Box4.Graph.IGraphInstance").yd(7),this.K.resolve("Box4.Graph.IGraphInstance").yd(8),
this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler")));this.K.register(YE,"PowerPointWebEditor.UpdateCommandUIActionListener").ma().oa(()=>new YE(this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers")))}LAj(a,b,c){return 1===c?32:2===c?(this.kOj(),xa.a.J(512497352,822,50,"Draw tab was clicked."),this.K.resolve("Common.IActionManagerExtended").processAction(ea.a.bkg,2),32):8}GNj(){const a=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");
a.yu();this.K.resolve("Box4.IGeneralCuiUser");a.updateCommandUI()}Vjg(a){const b=this.K.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader");b.AQf=!0;b.oGh=a;b.Bvg()}u9j(a,b){xa.a.J(512497351,835,50,"Init GC2 started");const c=new Date,f=this.K.resolve("PowerPointWebEditor.GraphicalContentComponents.IGraphicalContentComponentsDependencyLoader");f.Y9j().continueWith(l=>{var y=new Date;xa.a.J(512497350,813,50,"gc2 dependency loader loadJS starts: {0}, ends: {1}, durationMS: {2}",Nc.a.uf(c),
Nc.a.uf(y),+y-+c);if(6===l.status){l=eK.a({});const H=(y=kD())&&l&&(b||a);xa.a.J(512497349,835,50,"{0}",{["message"]:"InitializeGraphicalContentComponents",["gc2ShapeBuilderImageRenderingEnabled"]:a,["gc2PreloadShadersEnabled"]:b,["isBrowserShapeBuilderCompatible"]:l,["browserSupportsWebGL"]:y,["shouldUseShapeBuilder"]:H});l=H?document.createElement("canvas"):null;f.dOj(l,this.K.resolve("Gc2.IGlyphStore"))}}).continueWith(l=>{6!==l.status&&xa.a.J(512497348,835,10,"Exception: {0}",l.ej)})}nPj(){this.K.resolve("PowerPointWebEditor.Video.IVideoDependencyLoader").Fvg()}kOj(){this.K.resolve("PowerPointWebEditor.Ink.IInkDependencyLoader").jdb().continueWith(()=>
{this.K.resolve("PowerPointWebEditor.WetInkView")})}vb(){this.K.resolve("Common.IActionManagerExtended").ya(ea.a.rqh,ie.a.frame,Object(I.a)(this,this.LAj,"handleDrawTabClicked"))}init(){const a=!this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").presentation;this.Cwa=String.format("{0}, InitStart:{1}, OpenEarlyNotBack:{2}",this.Cwa,(new Date).getTime(),a);wg.a.instance.lc("EditingPackageInitStart",Date.now());a?(this.el=this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
this.el.Ezf(Object(I.a)(this,this.xjg,"initEditingPackage"))):this.yjg()}xjg(){this.el.bph(Object(I.a)(this,this.xjg,"initEditingPackage"));this.yjg()}yjg(){const a=this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener");this.Cwa=String.format("{0}, IsBootComplete:{1}, OnBootCompleteTime:{2}",this.Cwa,a.xla,(new Date).getTime());a.NFa(()=>{this.tMj(a)});a.zlg(()=>{this.sGi()})}tMj(a){this.Cwa=String.format("{0}, InitStartInternal:{1}",this.Cwa,(new Date).getTime());wg.a.instance.lc("EditingPackageInitStartInternal",
Date.now());var b=this.K.resolve("Common.AFrameworkApplication");const c=this.K.resolve("PowerPointWebEditor.IApplicationSettings"),f=new sP;f.Yb(this.K);f.load(b);for(const y of this.YX)y.init();c.pptSkipFidelityImageFetchDuringBootIfRemoveFidelityEnabled&&(Ib.a.instance.resolve("PowerPointWebEditor.IImageViewManager").emb(),c.UVa&&b.aq.Khg());this.GNj();this.K.resolve("Common.IActionManagerExtended").Kaa(new zP(this.K.resolve("PowerPointWebEditor.IActionNameResolver"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
dl.Qvg,dl.O$j,c.kDi,c.d0j,c.podsEnableAyncActionContext,c.actionContextEnableEventCallbacks));if(c.AJa){let y=null;(b=this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba)?(b=Kj.e(b,this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Na))?y=b.fda:xa.a.J(512497347,809,10,"slideViewElement is null."):xa.a.J(512497346,809,15,"activeSlide is null. SlideCount: "+this.K.resolve("PowerPointWebEditor.IPresentationReader").Cj());this.K.register(222,"PowerPointWebEditor.ICommentShimmerView").ma().oa(()=>
new qP(y,this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),w.AFrameworkApplication.isRtl,this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("Common.ITaskManager"),c.FDi))}this.K.resolve("Common.IActionManagerExtended").Kaa(this.K.resolve("PowerPointWebEditor.UpdateCommandUIActionListener"));a.Kua||(Ji.a.instance.QTe((new Date).getTime()),c.podsRibbonEarlyRendererExposureControl&&
c.AJa&&PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RegisterOrInvokeOnInitializeEarlyRenderedPptRibbon(()=>{PowerPointWebEditor.MinimalBoot.SetRealRibbon("OnContentEditable")}),DS.a.z0k(),this.K.resolve("PowerPointWebEditor.ISessionState").p6("AppInteractive"),this.x$&&wg.a.instance.lc("ContentEditablePerfMark",window.performance.now()),this.K.resolve("PowerPointWebEditor.IPPTRumTracker").vaa("canvas","slide"),c.podTransmitMetricsBeaconOnBoot&&(Mz.App.iNb(null,ci.a.contentEditable),this.pak()),
Pd.a.get_instance().ZH(4),a.Kua=!0);c.AJa&&this.Jlg()&&(this.K.resolve("PowerPointWebEditor.ICommentShimmerView").gxl(),xa.a.J(512497345,809,50,"CommentLandingSlide: true"));w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.CommentTTVRImprovementIsEnabled",!1)&&this.yUj()&&this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").tSk();this.zjk&&(c.Nwc?this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Dda("pptedit.extcommon",null,
()=>d.e(12).then(d.t.bind(null,1283,7))):(a=Px.a.create("pptedit.extcommon",null,()=>d.e(12).then(d.t.bind(null,1283,7))),$k.a.oy(a)));this.nPj();(a=this.K.resolve("Common.Utils.IHighContrastDetector"))&&a.isInHighContrastMode&&xa.a.J(512497315,809,50,"HighContrastMode enabled");!c.vme||a&&a.isInHighContrastMode?c.jie&&c.vme&&this.Vjg(!1):this.Vjg(!0);c.j9b&&(this.NBg.push(this.K.resolve("PowerPointWebEditor.GraphicalContentComponents.Gc2WebSocketFrontDoorResponseHandler")),this.u9j(c.QTc,c.X8i));
w.AFrameworkApplication.fv||(w.AFrameworkApplication.fv=xa.a.l3b());c.Jog&&this.K.resolve("PowerPointWebEditor.ISlideMasterPrefetchManager");const l=this.K.qb("Common.IFrameTimingMeter");l&&(xa.a.J(512497314,809,50,"Frame timing meter start:{0}",window.performance.now()),l.start(this.K.resolve("PowerPointWebEditor.IApplicationSettings").podsFrameTimingMeterReportingIntervalInSeconds),this.K.resolve("Common.ITaskManager").Hb(new dd.a(3,1,this.K.resolve("PowerPointWebEditor.IApplicationSettings").podsFrameTimingMeterRunningTimeInMiliseconds,
()=>{l.stop()},90,"93")));this.Cwa=String.format("{0}, InitDone:{1}",this.Cwa,(new Date).getTime());wg.a.instance.lc("EditingPackageInitDone",Date.now());xa.a.J(512497313,809,50,this.Cwa)}Jlg(){var a=this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba;if(a){if(a=a.qE(),this.K.resolve("PowerPointWebEditor.Graph.ICommentReader").igg(a))return!0}else xa.a.J(512497344,809,10,"activeSlide is null");return!1}yUj(){return this.K.resolve("PowerPointWebEditor.IApplicationSettings").ka("IsDeepLinkSession")||
this.Jlg()}sGi(){const a=this.K.resolve("PowerPointWebEditor.IApplicationSettings");xa.a.J(39370892,809,50,"Connect RTC by default: BrowserToServerRtc:{0}",a.podsTriggerServerRtcConnectionFromBrowserIsEnabled);const b=Date.now(),c=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter");c.ZNh("{"+w.AFrameworkApplication.userSessionId+"}");const f=this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").igj();f&&(c.Swc(0<f.length?2:1),c.pNh(f),this.K.resolve("PowerpointPresence.IPresencePerfLogger").Sak(Date.now(),
f.length));this.K.resolve("PowerPointWebEditor.PresenceLoader").KXf();this.K.resolve("PowerPointWebEditor.CoauthNotificationManager");this.K.resolve("PowerPointWebEditor.ICoauthSubscriptionManager").Zjg();xa.a.J(512497312,828,50,"PresenceCallback took {0}ms",Date.now()-b);a.podsTriggerServerRtcConnectionFromBrowserIsEnabled&&w.AFrameworkApplication.fa.ff(Object(I.a)(this.K.resolve("PowerPointWebEditor.CoauthNotificationManager"),this.K.resolve("PowerPointWebEditor.CoauthNotificationManager").XEh,
"startServerRtcConnection"))}pak(){if(wg.a.instance.fbb)xa.a.J(512497311,813,15,"LogBootMetrics: Cannot import metrics from PageLoadPerfRecorder since it has been logged and disposed.");else{var a={};for(var b of[ci.a.yEa,ci.a.v2f,ci.a.x2f,ci.a.ETc,ci.a.w2f,ci.a.ctb,ci.a.UJc,ci.a.vda,ci.a.oQ,ci.a.contentEditable,ci.a.pxc,"UserClickTime","DocPageNavigationStart","DocPageFetchStart","DocPageResponseStart","DocPageResponseEnd","DocPageNavigationRedirects","BootJsStartTime","BootJsEndTime",ci.a.Opd,"BootSegments",
"BootOperations","EditingPackageInitStartInternal","FirstExtJsExecTime","PageViewValidationStart","PageViewValidationDuration","AllViewsValidationDuration","ViewValidationYieldTime","ViewValidationYieldCount","ThumbnailNavigationPaneViewValidationStart","ThumbnailNavigationPaneViewValidationDuration","TMYielded","MicrosoftAjaxLoadStartTime","HermesIntlLoadStartTime","EditCoreJsExecStartTime","EditCoreJsLoadStartTime","EditCoreJsLoadEndTime","EditingPackageConfigureStart","EditingPackageInitStart",
"EditExtSliceTaskRegTime",ci.a.n6b,ci.a.o6b,"MBootFirstImgReqStart","MBootFirstImgReqEnd","MBootFirstImgDrawEnd","MBootRetryCount","MBootCacheHit","NPLT","SplashScreenShown","LogoScreenHideTime","SplashScreenHideSource","SplashScreenTextShownTime","OpenEarlyRequestServerReceived","OpenEarlyRequestServerEnd","OpenEarlyImagesRequestStartTime","OpenEarlyImagesRequestEndTime","OpenEarlyImagesRequestImagesCount","OpenEarlyClientRequestSentTime","OpenEarlyClientResponseReceivedTime","TimeDiffToOpenEarly",
"OpenEarlyCacheDisposed","DocModelManagerLoadAsyncStart","DocModelManagerLoadDocModelEnd","DocModelManagerGetObjectsStart","DocModelManagerGetObjectsEnd","DocModelManagerOnDocModelChanged","DocModelManagerGetHeadersEnd","FluidNewContainerStart","FluidNewContainerAfterCreateDocModel","FluidNewContainerBeforeAttach","FluidNewContainerAfterAttach","FluidNewContainerEnd","ParseOpenEarlyServerResponseStart","ParseOpenEarlyServerResponseEnd","AppBootCompleted","FirstDrawStarted","EditingPackageRegisterTime",
"PackageConfigurerAndInitiatorStartTime","CalculateVisibleThumbRangeWaitTime","CalculateVisibleThumbRangeStartTime","DeepLinkSlideIndex","CalculateVisibleThumbRangeEndTime"])wg.a.instance.Zn(b)&&(a[b]=wg.a.instance.Tg(b));w.AFrameworkApplication.fa.Ha("PodSID")&&(a.PodSessionID=w.AFrameworkApplication.fa.Ha("PodSID"));(b=window.self.RealRibbonDisplayTime)&&(a.RealRibbonDisplayTime=b);(b=window.self.RealRibbonDisplaySource)&&(a.RealRibbonDisplaySource=b);(b=window.self.ThumbnailShimmerHideTime)?a.ThumbnailShimmerHideTime=
b:wg.a.instance.Zn("ThumbnailShimmerHideTime")&&(a.ThumbnailShimmerHideTime=wg.a.instance.Tg("ThumbnailShimmerHideTime"));xa.a.J(39184516,809,50,"Perf metrics: "+ta.a.toJSON(a));b=this.K.resolve("PowerPointWebEditor.IApplicationSettings");b.wZj&&this.nck(a,b)}}nck(a,b){if(a[ci.a.oQ])if(a[ci.a.contentEditable])if(a.UserClickTime||a.DocPageFetchStart){if(a[ci.a.contentEditable]-a[ci.a.oQ]>b.Goi){var c=new Map;c.set("ContentEditable",a[ci.a.contentEditable].toString());c.set("ContentViewable",a[ci.a.oQ].toString());
$d.Health.instance.recordQosError("InteractiveOpenSlowError",["InteractiveOpenSlow"],!1,!0,!1,!1,Object.assign(new Mj.a,{extendedProperties:c}))}c=b.c0i;b=a.UserClickTime?a.UserClickTime:a.DocPageFetchStart;a[ci.a.oQ]-b>c&&(c=new Map,c.set("TimingOrigin",b.toString()),c.set("ContentViewable",a[ci.a.oQ].toString()),$d.Health.instance.recordQosError("PerceivedOpenSlowError",["PerceivedOpenSlow"],!1,!0,!1,!1,Object.assign(new Mj.a,{extendedProperties:c})))}else xa.a.J(512497308,809,15,"Both UserClickTime and DocPageFetchStart are null");
else xa.a.J(512497309,809,15,"ContentEditable is null");else xa.a.J(512497310,809,15,"ContentViewable is null")}dispose(){for(const a of this.YX)a.dispose();for(const a of this.NBg)a.dispose();this.K.resolve("PowerPointWebEditor.UpdateCommandUIActionListener").dispose()}static main(){const a=(new Date).getTime();xa.a.J(38876352,809,50,"EditingPackage::Register time:{0}",a);wg.a.instance.lc("EditingPackageRegisterTime",a);n.a.instance.Ac(new iF)}}Object(m.a)(iF,"EditingPackage",null,[2,3]);var ES=
d(586);class jF{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec,dc,Fc){this.Wma=this.A$=!1;this.CM={};this.a5=this.HJ=null;this.Uxa=()=>{this.A$&&this.renderRuler()};if(!a)throw Error.argumentNull("appFrame");if(!b)throw Error.argumentNull("activeSlideViewManager");if(!c)throw Error.argumentNull("browserHelper");if(!f)throw Error.argumentNull("viewPanelContainer");if(!l)throw Error.argumentNull("selectionManager");if(!y)throw Error.argumentNull("shapeReader");if(!H)throw Error.argumentNull("pageView");
if(!Q)throw Error.argumentNull("actionManager");if(!ia)throw Error.argumentNull("slideDimensionsHelper");if(!wa)throw Error.argumentNull("presentationReader");if(!Ua)throw Error.argumentNull("transactionFactory");if(!kb)throw Error.argumentNull("pptPageView");if(!Gb)throw Error.argumentNull("applicationSettings");if(!ec)throw Error.argumentNull("viewElementEventHandlers");if(!dc)throw Error.argumentNull("viewCoreEventHandlers");this.Vb=a;this.Kc=b;this.$e=c;this.pJa=f;this.pa=l;this.Ga=y;this.Gb=
H;this.ia=Q;this.pu=Fc;this.Wv=ia;this.oc=wa;this.Eb=Ua;this.Uic=kb;this.iFe=Gb.Qsh;this.kFe=Gb.Psh;this.nd=ec;this.VJ=dc}get Ukc(){return document.getElementById(M.AppFrame.oQh)}dispose(){this.A$=!1;this.Vb.Aoh(Object(I.a)(this,this.renderRuler,"renderRuler"));hd.a.removeHandler(this.Ukc,oa.a.scroll,Object(I.a)(this,this.unb,"updateRulerLocation"));this.nd.HVe(Object(I.a)(this,this.qmc,"onCloseTextEditView"));this.nd.jpd(Object(I.a)(this,this.Pmc,"onOpenTextEditView"));this.VJ.Yod(this.Uxa);this.HJ&&
this.a5?(Ea.a.eLa(this.HJ,"ShowWACHorizontalRulerContainer"),Ea.a.QI(this.HJ,"HideWACHorizontalRulerContainer"),Bj.UISurfaces.SWc().then(a=>{a.dispose(this.a5);return null}),this.HJ.removeChild(this.a5),this.pJa.removeChild(this.HJ),this.a5=this.HJ=null):xa.a.J(512496006,824,50,"Ruler container div / Ruler div null")}renderRuler(){const a=window.performance.now();if(this.HJ&&this.a5){Ea.a.eLa(this.HJ,"HideWACHorizontalRulerContainer");Ea.a.QI(this.HJ,"ShowWACHorizontalRulerContainer");var b=this.Kc.Jc;
if(b&&b.gd){var c=b.gd;c=new vr.a(c.Vp,c.Vk);b=this.Wv.s8b(c,b.fda?b.fda.va.style.visibility===Ki.a.visible:!1).width;c=this.$e.ki(this.Kc.Jc.gC).width;1===this.Uic.ol||0>=b||0>=c?xa.a.J(512496003,824,50,"Ruler should not be rendered"):(this.CM.rulerCanvasProps=this.qPk(Fb.a.qga(b,0)),c=Object(I.a)(this,this.cEk,"onIndentChange"),this.CM.onIndentChange=c,this.CM.indents=this.CM.rulerCanvasProps.textEditableArea?this.XPk():null,this.CM.rtl=this.Wma?!this.pu:this.pu,this.CM.inverted=this.Wma?!this.pu:
this.pu,this.a5.style.width=this.$e.Pc(b),this.unb(null),Bj.UISurfaces.SWc().then(f=>{f.renderRuler(this.a5,this.CM);return null}),b=window.performance.now(),xa.a.J(512496002,824,15,"HorizontalRenderRulerDuration:{0}",(b-a).toString()))}else xa.a.J(512496004,824,50,"Unable to get slideViewElement")}else xa.a.J(512496005,824,50,"Ruler container div / Ruler div null")}qPk(a){const b={},c=xe.a.Zv(this.oc.tn.eb(zb.a.slideWidth));var f=a/2;let l=0,y=Fb.a.vK(a,0);b.zeroScale=Fb.a.vK(f,0);this.Wma=!1;b.textEditableArea=
!1;if(this.pa.S_()&&!this.pa.kWa()){f=this.pa.I_();var H=f.qc(this.Gb.Na),Q=H.rotation;Q>this.iFe&&Q<this.kFe&&(this.Wma=!0);const ia=H.htmlElement.querySelector(".ShapeViewContent"),wa=this.Ga.aWc(f,this.Gb.Md);Q=0;f.Ug&&(Q=f.Cs().qc(this.Gb.Na).htmlElement.offsetLeft);Q+=H.htmlElement.offsetLeft+ia.parentNode.offsetLeft+(wa?wa.e:0);H=Q+ia.offsetWidth;f=(this.Wma?!this.pu:this.pu)?H:Q;Q>=l&&Q<=y&&H>=l&&H<=y&&(l=Q,y=H,b.zeroScale=f,b.textEditableArea=!0)}Q=xe.a.Aua(c)/a;a=Q*Fb.a.qga(y-l,0);Q*=Fb.a.qga(l,
0);b.leftMargin=l;b.rightMargin=y;b.precision=.0625;b.scale=c;b.rulerType="Horizontal";b.rightBoundary=xe.a.ZMa(a);b.leftBoundary=xe.a.ZMa(Q);return b}Pmc(){this.A$&&this.renderRuler()}qmc(){this.A$&&this.renderRuler()}XPk(){var a={};if(32!==this.ia.Ka(C.a.UKb,2,a))return xa.a.J(512496001,824,10,"Unable to read paragraph indentation for Ruler"),null;const b={type:"FirstLineIndent"},c={type:"HangingIndent"},f={type:"LeftIndent"};a=a.BB;if(!a)return xa.a.J(512496E3,824,10,"indentInfo is null"),null;
b.value=1===a.specialIndentType?xe.a.ZMa(a.bPb+a.dO):2===a.specialIndentType?xe.a.ZMa(a.dO-a.bPb):xe.a.ZMa(a.dO);c.value=xe.a.ZMa(a.dO);f.value=xe.a.ZMa(a.dO);return[b,c,f]}cEk(a,b){const c=new ES.a;c.unit=1;c.value=xe.a.Aua(b);this.QLj(a,c)}QLj(a,b){var c=this.pa.I_();if(a&&b&&c){var f=window.performance.now(),l=this.Eb.je(15);l.hc(c);c=8;switch(a){case "FirstLineIndent":c=this.ia.Ka(ea.a.XNb,2,b);l.fd=ea.a.XNb;break;case "HangingIndent":c=this.ia.Ka(ea.a.ZNb,2,b);l.fd=ea.a.ZNb;break;case "LeftIndent":c=
this.ia.Ka(ea.a.nla,2,b);l.fd=ea.a.nla;break;default:xa.a.J(512495970,824,10,"IndentChangeHandler called with invalid type")}l.dispose();b=window.performance.now();xa.a.J(512495969,824,15,"Indent type:{0} indentChangeDuration: {1}",a,(b-f).toString());32!==c&&xa.a.J(512495968,824,10,"Indent operation: {0} failed",c)}else xa.a.J(512495971,824,10,"IndentChangeHandler called with invalid params")}kP(){this.BSd();this.A$=!0;this.Vb.dzf(Object(I.a)(this,this.renderRuler,"renderRuler"));hd.a.addHandler(this.Ukc,
oa.a.scroll,Object(I.a)(this,this.unb,"updateRulerLocation"));this.nd.oJc(Object(I.a)(this,this.qmc,"onCloseTextEditView"));this.nd.D_b(Object(I.a)(this,this.Pmc,"onOpenTextEditView"));this.VJ.YIc(this.Uxa)}unb(){if(this.A$){var a=this.Kc.Jc;a&&a.gC&&window.requestAnimationFrame(()=>{const b=Bd.a.T$a(a.gC),c=Bd.a.T$a(this.pJa);this.a5.style.marginLeft=this.$e.Pc(b.x-c.x+1)})}else xa.a.J(512495967,824,10,"UpdateRulerLocation called with cookie value false")}LZi(){if(this.HJ)return this.HJ;this.HJ=
document.createElement("div");this.HJ.id="WACHorizontalRulerContainer";this.HJ.className="WACHorizontalRulerContainer";this.HJ.setAttribute(Ve.a.er,"ruler");this.HJ.setAttribute(Ve.a.hf,Ve.a.lsa);Sys.UI.DomElement.addCssClass(this.HJ,"HideWACHorizontalRulerContainer");return this.HJ}MZi(){if(this.a5)return this.a5;this.a5=document.createElement("div");this.a5.className="WACHorizontalRuler";this.a5.id="WACHorizontalRuler";return this.a5}BSd(){this.HJ=this.LZi();this.HJ.appendChild(this.MZi());this.pJa.insertBefore(this.HJ,
this.pJa.firstChild)}}Object(m.a)(jF,"HorizontalRuler",null,[259]);class kF{constructor(a,b,c,f,l){this.rVj=!0;if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("activeAppFrame");if(!c)throw Error.argumentNull("rulerFactory");if(!f)throw Error.argumentNull("horizontalRuler");if(!l)throw Error.argumentNull("verticalRuler");this.ia=a;this.Vb=b;this.bYg=c;this.$8c=f;this.lfd=l}vb(){this.ia.ra(ea.a.gud,yb.a.application,Object(I.a)(this,this.gud,"showHideRuler"),4);this.ia.ra(ea.a.dnd,
yb.a.application,Object(I.a)(this,this.dnd,"queryRulerToggle"),96)}RMj(){this.G2c()&&(xa.a.J(523351431,824,15,"Ruler init is called"),this.bYg.Ujg())}gud(a,b,c){return this.G2c()?this.QIj(c):this.cxl(c)}xOh(){this.Vb.BG({ShowHideRuler:"ToggleButtonModel"})}cxl(a){if(1===a)return 32;xa.a.J(523351432,824,15,"ShowRuler called");this.bYg.Ujg();this.Xxh(!0);this.Vb.yu();this.xOh();return 32}QIj(a){if(1===a)return 32;xa.a.J(523351433,824,15,"HideRuler called");this.AVi();this.Xxh(!1);this.Vb.yu();this.xOh();
return 32}AVi(){this.G2c()&&(this.$8c.dispose(),this.lfd.dispose(),this.Vb.yu())}dnd(a,b,c,f,l){if(1===c)return 32;l&&(l[wh.a.On]=this.G2c());return 32}G2c(){return pi.a.Y3(mx.a.Xgh,this.rVj)}Xxh(a){pi.a.oK(w.AFrameworkApplication.fa.Ha("IsRulerOnCookieName"),a.toString(),pi.a.XJ)}}Object(m.a)(kF,"RulerActor",null,[]);class AP{constructor(a,b,c){if(!a)throw Error.argumentNull("horizontalRuler");if(!b)throw Error.argumentNull("verticalRuler");if(!c)throw Error.argumentNull("appFrame");this.$8c=a;this.lfd=
b;this.Vb=c}Ujg(){this.$8c.kP();this.lfd.kP();this.Vb.yu();this.$8c.renderRuler();this.lfd.renderRuler()}}Object(m.a)(AP,"RulerFactory",null,[220]);class Pq{constructor(a,b,c,f,l,y,H,Q,ia,wa,Ua,kb,Gb,ec){this.jXd="HideWACVerticalRulerContainer";this.ZGf="ShowWACVerticalRulerContainer";this.Wma=this.A$=!1;this.Q5=this.UJ=null;this.Uxa=()=>{this.A$&&this.renderRuler()};if(!a)throw Error.argumentNull("appFrame");if(!b)throw Error.argumentNull("activeSlideViewManager");if(!c)throw Error.argumentNull("browserHelper");
if(!l)throw Error.argumentNull("selectionManager");if(!y)throw Error.argumentNull("shapeReader");if(!H)throw Error.argumentNull("pageView");if(!Q)throw Error.argumentNull("slideDimensionsHelper");if(!ia)throw Error.argumentNull("presentationReader");if(!wa)throw Error.argumentNull("pptPageView");if(!Ua)throw Error.argumentNull("applicationSettings");if(!kb)throw Error.argumentNull("viewElementEventHandlers");if(!Gb)throw Error.argumentNull("viewCoreEventHandlers");this.Vb=a;this.Kc=b;this.$e=c;this.pJa=
f;this.pa=l;this.Gb=H;this.oc=ia;this.pu=ec;this.Wv=Q;this.Uic=wa;this.iFe=Ua.Qsh;this.kFe=Ua.Psh;this.nd=kb;this.VJ=Gb}get Ukc(){return document.getElementById(M.AppFrame.oQh)}dispose(){this.A$=!1;hd.a.removeHandler(this.Ukc,oa.a.scroll,Object(I.a)(this,this.unb,"updateRulerLocation"));this.Vb.Aoh(Object(I.a)(this,this.renderRuler,"renderRuler"));this.nd.HVe(Object(I.a)(this,this.qmc,"onCloseTextEditView"));this.nd.jpd(Object(I.a)(this,this.Pmc,"onOpenTextEditView"));this.VJ.Yod(this.Uxa);this.UJ&&
this.Q5?(Ea.a.eLa(this.UJ,this.ZGf),Ea.a.QI(this.UJ,this.jXd),Bj.UISurfaces.SWc().then(a=>{a.dispose(this.Q5);return null}),this.UJ.removeChild(this.Q5),this.pJa.removeChild(this.UJ),this.Q5=this.UJ=null):xa.a.J(512495966,824,50,"Ruler container div / Ruler div null")}renderRuler(){const a=window.performance.now();if(this.UJ&&this.Q5){Ea.a.eLa(this.UJ,this.jXd);Ea.a.QI(this.UJ,this.ZGf);var b=this.Kc.Jc;if(b&&b.gd){var c=b.gd;c=new vr.a(c.Vp,c.Vk);b=this.Wv.s8b(c,b.fda?b.fda.va.style.visibility===
Ki.a.visible:!1).height;c=this.$e.ki(this.Kc.Jc.gC).height;if(1===this.Uic.ol||0>=b||0>=c)xa.a.J(512495963,824,50,"Ruler should not be rendered");else{var f={};f.rulerCanvasProps=this.ZPk(Fb.a.qga(b,1));f.rtl=this.Wma?!this.pu:this.pu;f.inverted=this.Wma?!this.pu:this.pu;this.Q5.style.height=this.$e.Pc(b);this.unb(null);Bj.UISurfaces.SWc().then(l=>{l.renderRuler(this.Q5,f);return null});b=window.performance.now();xa.a.J(512495962,824,15,"VerticalRenderRulerDuration:{0}",(b-a).toString())}}else xa.a.J(512495964,
824,50,"Unable to get slideViewElement")}else xa.a.J(512495965,824,50,"Ruler container div / Ruler div null")}ZPk(a){const b={},c=xe.a.Zv(this.oc.tn.eb(zb.a.slideHeight));var f=a/2;let l=0;a=Fb.a.vK(a,0);b.zeroScale=Fb.a.vK(f,0);this.Wma=!1;b.textEditableArea=!1;if(this.pa.S_()&&!this.pa.kWa()){f=this.pa.I_();var y=f.qc(this.Gb.Na);const Q=y.htmlElement.querySelector(".ShapeViewContent");var H=y.rotation;H>this.iFe&&H<this.kFe&&(this.Wma=!0);H=0;f.Ug&&(H=f.Cs().qc(this.Gb.Na).htmlElement.offsetTop);
H+=y.htmlElement.offsetTop+Q.parentNode.offsetTop+Q.offsetTop;y=H+Q.offsetHeight;f=(this.Wma?!this.pu:this.pu)?y:H;H>=l&&H<=a&&y>=l&&y<=a&&(l=H,a=y,b.zeroScale=f,b.textEditableArea=!0)}b.precision=.0625;b.topMargin=l;b.bottomMargin=a;b.rulerType="Vertical";b.scale=c;return b}kP(){this.BSd();this.A$=!0;hd.a.addHandler(this.Ukc,oa.a.scroll,Object(I.a)(this,this.unb,"updateRulerLocation"));this.Vb.dzf(Object(I.a)(this,this.renderRuler,"renderRuler"));this.nd.oJc(Object(I.a)(this,this.qmc,"onCloseTextEditView"));
this.nd.D_b(Object(I.a)(this,this.Pmc,"onOpenTextEditView"));this.VJ.YIc(this.Uxa)}unb(){if(this.A$){var a=this.Kc.Jc;a&&a.gC&&window.requestAnimationFrame(()=>{const b=Bd.a.T$a(a.gC),c=Bd.a.T$a(this.pJa);this.Q5.style.marginTop=this.$e.Pc(b.y-c.y+1)})}else xa.a.J(512495961,824,10,"UpdateRulerLocation called with cookie value false")}Pmc(){this.A$&&this.renderRuler()}qmc(){this.A$&&this.renderRuler()}BSd(){this.UJ=this.H_i();this.UJ.appendChild(this.I_i());this.pJa.insertBefore(this.UJ,this.pJa.firstChild)}H_i(){if(this.UJ)return this.UJ;
this.UJ=document.createElement("div");this.UJ.id=Pq.rvi;this.UJ.className=Pq.qvi;this.UJ.setAttribute(Ve.a.er,"ruler");this.UJ.setAttribute(Ve.a.hf,Ve.a.lsa);Sys.UI.DomElement.addCssClass(this.UJ,this.jXd);return this.UJ}I_i(){if(this.Q5)return this.Q5;this.Q5=document.createElement("div");this.Q5.className=Pq.pvi;this.Q5.id=Pq.svi;return this.Q5}}Pq.rvi="WACVerticalRulerContainer";Pq.qvi="WACVerticalRulerContainer";Pq.svi="WACVerticalRuler";Pq.pvi="WACVerticalRuler";Object(m.a)(Pq,"VerticalRuler",
null,[259]);class lF{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Ruler"}Yb(a){this.K=a}init(){if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").Ekb){var a=this.K.resolve("PowerPointWebEditor.AppFrame");this.K.register(jF,"PowerPointWebEditor.Ruler.HorizontalRuler").ma().oa(()=>new jF(a,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPoint.IBrowserHelperManager"),a?a.Bxc:null,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IPageView"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.ISlideDimensionsHelper"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"),
w.AFrameworkApplication.isRtl));this.K.register(Pq,"PowerPointWebEditor.Ruler.VerticalRuler").ma().oa(()=>new Pq(a,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPoint.IBrowserHelperManager"),a?a.Bxc:null,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IPageView"),this.K.resolve("PowerPointWebEditor.ISlideDimensionsHelper"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),
this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"),w.AFrameworkApplication.isRtl));this.K.register(220,"PowerPointWebEditor.Ruler.IRulerFactory").ma().oa(()=>new AP(this.K.resolve("PowerPointWebEditor.Ruler.HorizontalRuler"),this.K.resolve("PowerPointWebEditor.Ruler.VerticalRuler"),a));this.K.register(kF,
"PowerPointWebEditor.Ruler.RulerActor").ma().oa(()=>new kF(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.Ruler.IRulerFactory"),this.K.resolve("PowerPointWebEditor.Ruler.HorizontalRuler"),this.K.resolve("PowerPointWebEditor.Ruler.VerticalRuler")));this.K.resolve("PowerPointWebEditor.Ruler.RulerActor").vb();Pd.a.get_instance().Mj(8,()=>{this.bLe()})}}bLe(){this.K.resolve("PowerPointWebEditor.Ruler.RulerActor").RMj()}dispose(){}static main(){n.a.instance.Ac(new lF)}}
Object(m.a)(lF,"PPTWebEditorRulerPackage",null,[2,3]);class oA{static get YVl(){return oA.ZVl}}oA.ZVl="<div class='WACZoomDialogRadioRow' id='ZoomDlgBlock{0}'> <input type='radio' id='radiobox{0}' name='{2}' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ZoomDlgList{0}' class='WACDialogLabel' for='radiobox{0}' >{1}</label> </div>";Object(m.a)(oA,"ZoomDialogHtml",null,[]);class iy extends bi.a{constructor(a,b,c,f,l=!1){super(!1,!1,l);this.UZb=this.TZb=this.Da=this.iyc=null;this.TVl=
"ZoomDialogBoxGroup";this.vQa=a;this.cIc=b;this.awf=c;this.Pd=f;this.sg=this.Eri();this.Ad=1;this.kg="ZoomDialog"}get kTe(){return"ListRadioBox"}get pqc(){return"radiobox"}get Qjh(){return"WACZoomDialogRadioRow"}get jTe(){return"WACZoomDialogRadioRow-highlight"}get Uo(){return this.Pd}get c8(){return this.iyc}ZCh(a,b){if(this.dL)this.Lxl(a,b);else{const c={};for(let f=0;f<this.vQa.length;f++)c[this.pqc+f]=this.cIc[f]===b?!0:!1;this.pj(a,Object(I.a)(this,this.VVl,"zoomDialogHandler"),c);this.NTe();
this.xUe()}}Lxl(a,b){var c=Array(this.vQa.length);let f="";for(let l=0;l<this.vQa.length;l++){const y=l.toString();c[l]={["key"]:y,["text"]:this.vQa[l]};b===this.cIc[l]&&(f=y)}b={};b.dialogChoiceGroupProps={["id"]:this.TVl,["defaultSelectedKey"]:f,["options"]:c};c={["id"]:"OptionsDialog",["bodyControls"]:b};this.pj(a,Object(I.a)(this,this.$Vl,"zoomDialogReactHandler"),c)}ygl(){this.iyc=document.getElementsByName(this.kTe)[0];this.iTc(this.c8)}r8(){this.Da||(this.Da=document.getElementById("WACDialogText"));
this.Da&&(this.TZb||(this.TZb=Object(I.a)(this,this.UVl,"zoomDialogClickHandler"),this.Hn.rb(oa.a.click,this.Da,this.TZb)),this.UZb||(this.UZb=Object(I.a)(this,this.WVl,"zoomDialogKeyDownHandler"),this.Wg.rb(oa.a.Bf,this.Da,this.UZb)));super.r8();this.Ib&&this.Wg.rb(oa.a.Tl,this.Ib,Object(I.a)(this,this.SN,"dialogDefaultEnterKeyHandler"))}NTe(){this.Uo.Ll().scope.Bp(v.FocusManager.instance().Bra);this.Uo.Ll().scope.Bp(v.FocusManager.instance().Cra);this.Uo.Ll().scope.bindAction(v.FocusManager.instance().Bra,
G.a.Kxc);this.Uo.Ll().scope.bindAction(v.FocusManager.instance().Cra,G.a.Jxc)}xUe(){const a=document.getElementsByName(this.kTe);for(let b=0;b<a.length;b++){const c=a[b];hd.a.addHandler(c,oa.a.focus,Object(I.a)(this,this.Lnd,"radioButtonFocusHandler"));c.checked&&(this.iyc=c)}}VVl(a,b){if(1===a)for(a=0;a<this.vQa.length;a++)if(b[this.pqc+a]){this.awf(this.cIc[a]);break}}Lnd(a){this.iTc(a.target)}UVl(a){a=a.Bc;if(!a||!a.parentNode||"label"!==a.tagName.toLowerCase()&&!a.className.startsWith(this.Qjh))return!1;
a=this.b8f(a);a=document.getElementById(this.pqc+a);this.iTc(a);return!0}$Vl(a,b){1===a&&(a=Number.parseInvariant(b.selectedOption.toString()),this.awf(this.cIc[a]))}WVl(a){a=a.mc.keyCode;if(a!==Sys.UI.Key.down&&a!==Sys.UI.Key.right&&a!==Sys.UI.Key.up&&a!==Sys.UI.Key.left)return!1;let b=this.b8f(this.c8);const c=this.vQa.length-1;if(a===Sys.UI.Key.down||a===Sys.UI.Key.right)b=b<c?b+1:0;else if(a===Sys.UI.Key.up||a===Sys.UI.Key.left)b=0<b?b-1:c;a=document.getElementById(this.pqc+b);this.iTc(a);return!0}SN(a){return a.eventName===
oa.a.Tl&&a.mc.keyCode===Sys.UI.Key.enter?(super.SN(a),!0):!1}iTc(a){a&&(a.checked=!0,this.Uo.Ee&&this.Uo.Ee.name===this.xL||this.Uo.vf(this.xL),this.Uo.Ll().Dj.mF(a),a.focus(),this.c8&&Sys.UI.DomElement.removeCssClass(this.c8.parentNode,this.jTe),Sys.UI.DomElement.addCssClass(a.parentNode,this.jTe),this.iyc=a)}b8f(a){return Number.parseInvariant(ma.a.substr(a.id,a.id.length-1,1))}VA(){super.VA();const a=document.getElementById(this.Uh("WACDialogPanel"));a.style.minWidth=String.format("{0}px",200);
a.style.width=String.format("{0}px",200)}Eri(){let a="";for(let b=0;b<this.vQa.length;b++)a+=bi.a.VC(iy.XVl,b.toString(),this.vQa[b],this.kTe);return a}dispose(){this.Da&&(this.Hn&&this.TZb&&this.Hn.Bb(oa.a.click,this.Da,this.TZb),this.Wg&&this.UZb&&this.Wg.Bb(oa.a.Bf,this.Da,this.UZb));this.Hn&&this.Ib&&this.Wg.Bb(oa.a.Tl,this.Ib,Object(I.a)(this,this.SN,"dialogDefaultEnterKeyHandler"));super.dispose()}}iy.XVl=oA.YVl;Object(m.a)(iy,"ZoomDialog",bi.a,[301]);class mF{constructor(){this.Df=null}create(a,
b,c,f){return this.Df=new iy(a,b,c,f)}}Object(m.a)(mF,"ZoomDialogFactory",null,[280]);class nF{constructor(){this.Da=null}get name(){return"Common.App.Zoom"}init(){}dispose(){}Yb(a){this.Da=a;this.Da.register(mF,"Common.App.Zoom.ZoomDialogFactory").as("Common.App.Zoom.IZoomDialogFactory").oa(()=>new mF).ma()}static main(){n.a.instance.Ac(new nF)}}Object(m.a)(nF,"ZoomPackage",null,[2,3]);class BP{constructor(a,b,c,f,l,y,H){this.gtk=[ResourceStrings.L_ZoomDialogFit,"400%","200%","150%","100%","66%",
"50%","33%"];this.Dfd="fittowindow 4 2 1.5 1 0.66 0.5 0.33".split(" ");this.Df=null;this.ia=a;this.Fa=b;this.oc=l;this.ij=c;this.Vb=f;this.Hh=y;this.iyg=H}vb(){this.ia.ra(ea.a.eTe,hc.a.application,Object(I.a)(this,this.XWk,"queryZoom"),96);this.ia.ya(ea.a.ENe,hc.a.application,Object(I.a)(this,this.EGj,"handleZoomConfig"));this.ia.ya(ea.a.Lxc,hc.a.application,Object(I.a)(this,this.FGj,"handleZoomToFit"));this.ia.ya(G.a.Kxc,ie.a.frame,Object(I.a)(this,this.mRh,"zoomDialogTabFocusHandler"));this.ia.ya(G.a.Jxc,
ie.a.frame,Object(I.a)(this,this.mRh,"zoomDialogTabFocusHandler"));w.AFrameworkApplication.fa.ka("ZoomSliderIsEnabled")&&(this.ia.ya(G.a.Pvb,ie.a.frame,Object(I.a)(this,this.Pvb,"decreaseZoom")),this.ia.ya(G.a.Yzb,ie.a.frame,Object(I.a)(this,this.Yzb,"increaseZoom")),this.ia.ya(G.a.aWl,ie.a.frame,Object(I.a)(this,this.mJk,"onZoomToPercentage")),this.ia.ra(G.a.YWk,ie.a.frame,Object(I.a)(this,this.mGk,"onQueryZoomPercentage"),96),eb.a("ZoomShortCutsEnabled")&&(this.ia.ya(C.a.FQf,ie.a.frame,vf.ActionManager.Sg),
this.ia.ya(C.a.EQf,ie.a.frame,vf.ActionManager.Sg)))}pe(){if(w.AFrameworkApplication.fa.ka("ZoomSliderIsEnabled")&&eb.a("ZoomShortCutsEnabled")){const a=this.Fa.Fc(jb.a.Xi);a.bindAction(x.KeyInputManager.Qa(B.a.Yyd,x.KeyInputManager.Re),G.a.Yzb);a.bindAction(x.KeyInputManager.Qa(B.a.azd,x.KeyInputManager.Re),G.a.Yzb);a.bindAction(x.KeyInputManager.Qa(B.a.Zyd,x.KeyInputManager.Re),G.a.Pvb);a.bindAction(x.KeyInputManager.Qa(B.a.uxc,x.KeyInputManager.Re),G.a.Pvb);this.iyg&&ja.a.instance.rb(oa.a.aIb,
this.iyg,Object(I.a)(this,this.Vji,"adjustZoomOnMouseWheel"))}}Vji(a){return a?a.n_?(0<a.GQh?this.hNa(this.L5g):0>a.GQh&&this.hNa(this.M5g),!0):!1:!1}get e9a(){return Math.round(100*this.ij.eV)}get M5g(){return Math.floor(this.e9a/10)/10+.1}get L5g(){return Math.ceil(this.e9a/10)/10-.1}XWk(a,b,c,f,l){if(!l||isNaN(this.e9a)||0==this.e9a)return 8;l[lE.a.LabelText]=Math.round(100*this.ij.eV)+"%";this.Hh&&(this.Hh.dP(this.Hh.I6,this.Hh.caf),this.Hh.vaa(this.Hh.I6,this.Hh.caf));return 32}EGj(a,b,c,f,l){if(1===
c)return this.oc.Cj()?32:8;if(!l)return 8;this.Df=new iy(this.gtk,this.Dfd,Object(I.a)(this,this.Jzd,"zoomSettingAction"),v.FocusManager.instance(),!0);this.Df.ZCh(CommonUIStrings.l_ZoomDialogTitle,this.ij.Dla?this.Dfd[0]:this.ij.eV.toString());return 32}Jzd(a){if(a!==this.Dfd[0]){const b=parseFloat(a);if(isNaN(b)){xa.a.J(512288459,827,10,"Invalid Zoom Value: {0}",a);return}this.ij.Dla=!1;this.ij.eV=b;this.ij.Inb=2}else this.ij.Dla=!0;this.Vb.yu();xa.a.J(512288458,827,50,"Succeeded to Zoom: {0}",
a)}FGj(a,b,c,f,l){if(1===c)return this.oc.tn&&!this.oc.Cj()?8:32;if(!l)return 8;if(!this.oc.tn)return xa.a.J(509212699,827,50,"Content Editable hasn't reached yet as presentation node hasn't been set"),8;this.Jzd(this.Dfd[0]);return 32}mRh(a){if(!this.Df)return 8;var b=this.Df.Uo.Ll().Dj.q_;if(b===this.Df.jw&&a===G.a.Kxc||b===this.Df.SD&&a===G.a.Jxc)this.Df.c8||this.Df.ygl(),this.Df.Uo.Ll().Dj.mF(this.Df.c8);else if(b.id.startsWith(this.Df.pqc)||b.className.startsWith(this.Df.Qjh))b=null,a===G.a.Kxc?
b=this.Df.SD:a===G.a.Jxc&&(b=this.Df.jw),this.Df.Uo.Ll().Dj.mF(b),Sys.UI.DomElement.removeCssClass(this.Df.c8.parentNode,this.Df.jTe);else if(a===G.a.Kxc)this.Df.Uo.Ll().dIb();else if(a===G.a.Jxc)this.Df.Uo.Ll().bIb();else return 16;return 32}Yzb(a,b,c){if(1===c)return 32;this.hNa(this.M5g);xa.a.J(512288456,827,50,"Increase Zoom triggered via ZoomIn");return 32}Pvb(a,b,c){if(1===c)return 32;this.hNa(this.L5g);xa.a.J(512288455,827,50,"Decrease Zoom triggered via ZoomOut");return 32}mJk(a,b,c,f,l){if(1===
c)return 32;a=l.value/100;this.hNa(a);xa.a.J(512288454,827,50,"Zoom changed via zoom slider: {0}",a);f&&(f.QC=Math.floor(100*a));return 32}mGk(a,b,c,f,l){if(isNaN(this.e9a)||0==this.e9a)return 8;l.MinValue=10;l.MaxValue=400;l.value=this.e9a;return 32}hNa(a){.1>a?a=.1:4<a&&(a=4);this.ij.Dla=!1;this.ij.eV=a;this.ij.Inb=2;this.Vb.yu()}}Object(m.a)(BP,"ZoomActor",null,[251]);class oF{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Zoom"}Yb(a){this.K=a}init(){var a=this.K.resolve("PowerPointWebEditor.AppFrame");
const b=this.K.resolve("Common.IActionManagerExtended"),c=this.K.resolve("PowerPointWebEditor.IFocusManager");a=new BP(b,c,this.K.resolve("PowerPointWebEditor.IZoomContext"),a,this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IPPTRumTracker"),a.vUd);a.vb();a.pe()}dispose(){}static main(){n.a.instance.Ac(new oF)}}Object(m.a)(oF,"PPTWebEditorZoomPackage",null,[2,3]);var CP=d(525);class DP{constructor(a){this.ke=a}aPf(a,b,c,f,l,y){const H=this.ke.qk(c+".png");
c=He.getImageClassWithCluster(c,f);return He.createClusteredImageFromClusterWithImageClass(a,b,c,H,32===a&&32===b?"cui-img-cont-float cui-img-32by32":"cui-img-cont-float cui-img-16by16","",!1,l,null,y)}}Object(m.a)(DP,"ShapeGlyphImageFactory",null,[194]);var EP=d(698);class FP{constructor(a,b){this.v8c=this.B0=null;this.zve=this.aMg=0;this.$e=a;this.Kc=b}dispose(){this.clear();this.B0.parentNode.removeChild(this.B0)}add(a,b){this.PZe(!1);a=this.Dci(a,b);this.VWj()||this.D3j(a)?this.OZe(-1*(Math.ceil(a.offsetWidth)+
2)):this.OZe(this.zve);this.PZe(!0)}clear(){this.$e.vv(this.v8c);this.PZe(!1);this.OZe(0)}qRa(a,b,c){this.aMg=c;this.zve=b;this.B0=this.$e.$d();this.B0.className="prFlyout UISmallFont";a.appendChild(this.B0);this.v8c=this.$e.B3b();this.B0.appendChild(this.v8c)}Dci(a,b){const c=this.$e.nPf();c.style.backgroundColor=a;c.style.lineHeight=this.$e.Pc(this.aMg);this.$e.Mz(c,b);this.v8c.appendChild(c);return c}D3j(a){a=this.$e.ki(a);const b=this.$e.ki(this.Kc.Jc.gC);return a.x+a.width+this.zve>b.x+b.width}VWj(){return 0>
this.$e.Nn(this.B0.style.left)}PZe(a){this.B0.style.visibility=a?Ki.a.visible:Ki.a.hidden}OZe(a){this.B0.style.left=this.$e.Pc(a)}}Object(m.a)(FP,"ShapePawnFlyout",null,[265]);var FS=d(996),GS=d(1306),HS=d(1297);class pF{constructor(a,b,c,f,l){this.bXd=1;this.ajc=[];this.Vdb=null;this.Rec=this.iGb=!1;this.Ajc=this.Sk=this.ru=null;(this.Sv=w.AFrameworkApplication.fa.ka("PPTCanvasPresenceBubbleUXEnabled"))?(this.Sk=a,this.Ajc=l,this.yNi()):this.Fy=Object(qa.a)(EP.a,f.eQf(a,b,c,Object(I.a)(this,this.NM,
"onPointerOver"),Object(I.a)(this,this.qG,"onPointerOut"),l))}e9(){if(this.Sv)return this.noj();const a=Array.clone(this.sga);if(this.GW){let b=!1;for(const c of this.sga)if(c.clientId===this.GW.clientId){b=!0;break}b||Array.add(a,this.GW)}return a}dispose(){this.Sv?this.rVi():(this.ajc=this.Vdb=null,this.Fy.dispose())}kB(a){if(this.Sv)this.Gei(a);else if(a){for(const b of this.sga)if(b.clientId===a.clientId)return;Array.add(this.sga,a);this.refresh()}}nP(a){if(this.Sv)this.W6k(a);else if(a)for(const b of this.sga)if(b.clientId===
a.clientId){Array.remove(this.sga,b);this.refresh();break}}clear(){this.Sv?this.JAi():(this.ajc=[],this.Fy.clear())}get GW(){return this.Vdb}set GW(a){this.Vdb!==a&&(this.Vdb=a,this.Vdb||(this.Rec=!1),this.Sv||this.refresh())}N1e(){this.Sv||(this.GW?(this.Rec=!0,this.MLb()):xa.a.J(22675491,828,10,"ShapePresencePawn.ShowEditorFlyout: Trying to show editing flyout when current editor is null"))}l2e(){this.Sv?this.Qwl():(this.iGb=!0,this.Vdb&&(this.Rec=!0),this.MLb())}tge(){this.Sv?this.PIj():(this.iGb=
!1,this.MLb())}setZIndex(a){this.Sv?this.Ppl(a):this.Fy.setZIndex(a)}get F_a(){return this.GW?this.GW.color:this.sga&&this.sga.length?this.sga[this.sga.length-1].color:Ui.a.none}DYc(){return!!this.Vdb||0<this.ajc.length}get sga(){return this.Sv?this.ru.xKb:this.ajc}FIj(){this.Fy.$We();this.Fy.TYd()}qG(){this.DYc()&&(this.iGb=!1,this.MLb());return!0}NM(){this.DYc()&&(this.iGb=!0,this.MLb());return!0}uOl(){this.DYc()?this.Fy.Jwh(1<this.ajc.length?"MoreUsersGlyph_16x16x32":"SingleCollabUserGlyph_16x16x32",
this.F_a):this.Fy.ERa()}refresh(){this.uOl();this.MLb()}MLb(){this.FIj();if(this.iGb)if(this.GW){this.Fy.n_b(this.GW.color,String.format(ResourceStrings.l_TypingHint,this.GW.userName));for(const a of this.sga)this.GW.clientId!==a.clientId&&this.Fy.n_b(a.color,a.userName)}else for(const a of this.sga)this.Fy.n_b(a.color,a.userName);else this.Rec&&(this.GW?this.Fy.n_b(this.GW.color,String.format(ResourceStrings.l_TypingHint,this.GW.userName)):xa.a.J(42472531,828,10,"ShapePresencePawn.RefreshFlyout: Trying to show editing flyout when current editor is null"));
(this.iGb||this.Rec)&&this.Fy.uIe()}gOb(a,b){this.ru&&this.ru.gOb(a,b)}rVi(){this.ru&&this.ru.dispose()}qQe(){return rb.a.ki(document.body)}Gei(a){a?this.ru?(xa.a.J(42472535,814,50,"ShapePresencePawn:AddUser at PresencePawn for ClientId { presenceUser.ClientId}",a.clientId),this.ru.kB(a)):xa.a.J(42472533,814,10,"ShapePresencePawn:AddUser - Presence tool tip is null, skipping AddUser for ClientID {presenceUser.ClientId}"):xa.a.J(50340754,814,10,"ShapePresencePawn:AddUser - user is null, skipping AddUser")}W6k(a){a?
this.ru?(xa.a.J(42472539,814,50,"ShapePresencePawn:RemoveUser at PresencePawn for ClientId { presenceUser.ClientId}",a.clientId),this.ru.nP(a.clientId)):xa.a.J(42472537,814,15,"ShapePresencePawn:RemoveUser - Presence tool tip is null, skipping RemoveUser {presenceUser.ClientId}"):xa.a.J(50340758,814,15,"ShapePresencePawn:RemoveUser - user is null, skipping RemoveUser")}JAi(){if(this.ru){xa.a.J(42472543,814,50,"ShapePresencePawn:Clear at PresencePawn ");var a=this.e9();if(a)for(const b of a)this.nP(b);
else xa.a.J(42472545,814,50,"ShapePresencePawn:Clear - Pawn has no users")}else xa.a.J(42472541,814,15,"ShapePresencePawn:Clear - Presence tool tip is null, skipping ClearPresence ")}noj(){return this.ru?this.ru.xKb:null}Qwl(){this.ru&&(this.ru.eMa(),this.ru.aMa())}PIj(){this.ru&&this.ru.eMa()}Ppl(a){this.Sk.style.zIndex=String(a)}xvj(a){const b=new GS.a;b.add(0,He.getImageClassWithCluster(w.AFrameworkApplication.cO,"MoreUsersGlyph_16x16x32"));b.add(5,w.AFrameworkApplication.Cm);b.add(1,He.getImageClassWithCluster(w.AFrameworkApplication.cO,
"DoughboyWhiteGlyph_20x20x32"));b.add(4,w.AFrameworkApplication.Cm);b.add(6,20);b.add(8,w.AFrameworkApplication.isRtl);b.add(12,a);b.add(11,!1);b.add(16,Object(I.a)(this,this.qQe,"presenceViewportBoundsCallback"));return new HS.a(b)}yNi(){this.ru=this.xvj(this.c9f()).h3b(this.Sk);Sys.UI.DomElement.addCssClass(this.ru.element,"ShapePawnContainer")}vBi(){const a=this.e9();if(a)for(const b of a)this.gOb(b.clientId,!1)}c9f(){return this.bXd+Ox.a.wha+Ox.a.wha}uIe(){this.Ajc.va.style.zIndex=String(this.c9f())}}
Object(m.a)(pF,"ShapePresencePawn",null,[263,264,107,192]);var IS=d(995);class GP{constructor(a,b,c,f,l){this.Sr=a;this.Rc=b;this.$e=c;this.Jgb=f;this.Kc=l}rOi(a,b,c,f){this.$e.addCssClass(a,"ShapeModernCatchupPawnContainer");return new IS.a(a,b,"pegal",this,c,f)}pOi(a,b,c){this.$e.addCssClass(a,"ShapePawnContainer");return new pF(a,b,"per",this,c)}eQf(a,b,c,f,l,y){return new EP.a(a,b,c,f,l,null,this,this.Jgb,this.$e,this.Sr,this.Rc,y)}nOi(){return new FP(this.$e,this.Kc)}oOi(){return new FS.a(this.$e)}}
Object(m.a)(GP,"ShapePawnFactory",null,[193]);var so=d(650);class HP{constructor(a,b,c,f,l,y=16){this.YGg=!1;this.km=null;this.bfb=!1;this.Zkc=this.WB=this.VB=0;this.od=1;this.Kfc=!1;this.Ab=this.lec=!0;this.xA=!1;this.xU=!0;this.pwe=!1;this.c5=y;this.TIa=new Im.a;this.p0=new Qz.a;this.Kx=new cm.a;this.iG=new cm.a;this.EH=new cm.a;this.s5=new Im.a;this.NE=new WD.a;this.Vr=new WD.a;this.kb=a;this.Fy=b?b(this.s5.va,this.c5,l):null;this.ua=c;this.i$=f}dispose(){this.i$();this.TIa&&(this.TIa.va.parentNode&&
this.TIa.Dq(),this.p0&&this.p0.viewport&&this.p0.viewport.Dq(),this.Kx&&this.Kx.Dq(),this.iG&&this.iG.Dq(),this.EH&&this.iG.Dq());this.Fy&&this.Fy.dispose();this.s5=this.EH=this.iG=this.Kx=this.p0=this.TIa=null;this.Ab=!1}get szh(){return this.Fy}get shape(){return this.ua}get Qbb(){return this.YGg}set Qbb(a){this.c5=a?20:16;this.YGg=a}get Kpg(){return this.bfb}set Kpg(a){this.c5=16;this.bfb=a}xm(a){this.TIa.appendChild(this.p0.viewport);this.TIa.appendChild(this.s5);this.Kx.eF(Ui.a.none);this.bfb?
this.Kx.ur(se.a.u0e):this.Kx.ur(se.a.x0e);this.iG.eF(Ui.a.none);this.iG.ur(so.a.iNc);this.EH.eF(Ui.a.none);this.EH.ur(so.a.QZd);this.p0.appendChild(this.EH);this.p0.appendChild(this.iG);this.p0.appendChild(this.Kx);this.setVisibility();this.sVf();a.appendChild(this.TIa)}iC(){}Mp(){return this.p0.Mp()}EAb(){return!1}Xw(){}setVisibility(){const a=this.Ab&&(!this.xA||!this.xU);this.s5.Sd(a);this.Kx.Sd(a);this.iG.Sd(a);this.EH.Sd(a);this.TIa.Sd(this.Ab)}my(){}aD(){return null}QA(){return[]}sVf(){this.km=
this.ua.Jn.copy();this.Kx.ur(this.pwe?so.a.gMf:this.bfb?se.a.u0e:se.a.x0e);this.iG.ur(so.a.iNc);this.EH.ur(so.a.QZd);this.ds();this.setVisibility()}draw(){this.visible=!0;this.sVf()}get visible(){return this.Ab}set visible(a){this.Ab!==a&&(this.Ab=a,this.setVisibility(),this.ds())}get Ntb(){return this.lec}set Ntb(a){this.lec=a;this.Kx.Sd(this.Ab&&this.lec);this.iG.Sd(this.Ab&&this.lec);this.EH.Sd(this.Ab&&this.lec)}setPosition(a,b){this.VB=a;this.WB=b;this.ds()}Ij(a){this.od=a;this.ds()}vq(a){this.NE=
a;this.ds()}Eu(a){this.Vr=a;this.ds()}setZIndex(a){this.Zkc=a;this.TIa.jC(this.Zkc);this.p0.jC(this.Zkc);this.s5.jC(this.Zkc);this.Fy&&this.Fy.setZIndex(this.Zkc)}JD(a,b){this.xA=a;this.xU=b;this.setVisibility()}QQb(a=null){this.Fy&&this.Kx.dv(a||this.Fy.F_a);this.Kx&&(this.Kx.spa(""),this.Kx.eF(Ui.a.none),this.bfb?this.Kx.ur(se.a.u0e):this.Kx.ur(se.a.x0e),this.Kx.$aa(""))}GAi(){this.Kx&&this.iG&&this.EH&&(this.pwe=!1,this.Kx.$aa(""),this.iG.$aa(""),this.Kx.dv(Ui.a.none),this.Kx.iza(0),this.iG.dv(Ui.a.none),
this.iG.iza(0),this.EH.dv(Ui.a.none),this.EH.iza(0))}P8e(a,b=!1){if(this.Kx&&this.iG&&this.EH){this.pwe=!0;var c=0===a;this.Kx.ur(so.a.gMf);this.iG.ur(2===a?so.a.zDi:so.a.iNc);this.EH.ur(so.a.QZd);this.Kx.dv(c?Ui.a.none:so.a.xDi);this.iG.dv(c?Ui.a.none:so.a.tDi);switch(a){case 2:this.EH.dv(so.a.wDi);break;case 1:this.EH.dv(so.a.uDi);break;default:this.EH.dv(so.a.vDi)}1===a?this.ZZf():b?this.ZZf():(this.Kx.iza(1),this.iG.iza(1),this.EH.iza(1))}}ZZf(){this.$Zf(0)}$Zf(a){this.Kx&&this.iG&&this.EH&&!(1<
a)&&(a+=.05,this.Kx.iza(a),this.iG.iza(a),this.EH.iza(a),window.setTimeout(()=>{this.$Zf(a)},10))}ds(){if(this.km){var a=this.km.copy();this.NE.ll(a);this.Vr.ll(a);a.move(this.VB,this.WB);a.scale(this.od,this.od);this.gNl(a);this.yPl(a)}}gNl(a){if(this.Kx&&this.iG&&this.EH&&a){var b=this.pHf(so.a.yDi,a),c=this.pHf(so.a.iNc,b);this.EH.Jt(c.points);this.p0.em();this.EH.Sd(this.Ab&&(!this.xA||!this.xU));this.iG.Jt(b.points);this.p0.em();this.iG.Sd(this.Ab&&(!this.xA||!this.xU));this.Kx.Jt(a.points);
this.p0.em();this.Kx.Sd(this.Ab&&(!this.xA||!this.xU));z.a.scb&&this.ua&&this.ua.vd&&this.kb.Ulg()&&this.p0.viewport.ah(this.p0.viewport.width,0)}}Elc(){if(this.Qbb){var a=this.s5.x,b=this.s5.y;this.kb.mX(this.ua)&&!this.Kfc&&(this.s5.setPosition(a,b-18),this.Kfc=!0)}}kJe(){if(this.Qbb){var a=this.s5.x,b=this.s5.y;this.Kfc&&!this.kb.mX(this.ua)&&(this.s5.setPosition(a,b+18),this.Kfc=!1)}}pHf(a,b){var c=b.Tj(qe.a.VE),f=b.Tj(qe.a.Wu);c=xe.a.XM(Zc.a.JF(f,c));new Zc.a(0,0);let l;new Zc.a(0,0);let y;new Zc.a(0,
0);new Zc.a(0,0);b.rotate(-c);const H=b.points;f=new Zc.a(H[0]._x+a,H[0]._y+a);l=new Zc.a(H[1]._x-a,H[1]._y+a);y=new Zc.a(H[2]._x-a,H[2]._y-a);a=new Zc.a(H[3]._x+a,H[3]._y-a);a=new fj.a(f,l,y,a);a.rotate(c);b.rotate(c);return a}yPl(a){if(a){var b=a.Tj(qe.a.VE),c=a.Tj(qe.a.Wu),f=xe.a.XM(Zc.a.JF(c,b));b=a.Tj(qe.a.VE);c=a.Tj(qe.a.Wu);90<=f&&(b=a.Tj(qe.a.Wu),c=a.Tj(qe.a.dI));180<=f&&(b=a.Tj(qe.a.dI),c=a.Tj(qe.a.jF));270<=f&&(b=a.Tj(qe.a.jF),c=a.Tj(qe.a.VE));f=Zc.a.JF(c,b);var l=this.Knj(f);a=Math.cos(f)*
l;f=Math.sin(f)*l;l=this.Qbb?this.c5/2-1:this.bfb?this.c5/2:this.c5;this.bfb?this.s5.setPosition(c.x-l,c.y-l):this.s5.setPosition(b.x-a,b.y-f-l);this.s5.Sd(this.Ab&&(!this.xA||!this.xU));this.Qbb&&(this.Kfc=!1,this.Elc())}}Knj(a){return(this.Qbb?10:15)-xe.a.XM(a)/6}}Object(m.a)(HP,"ShapePawnView",null,[261]);class IP{s1d(a,b,c,f,l){return new HP(a,b,c,f,l,16)}}Object(m.a)(IP,"ShapePawnViewFactory",null,[195]);class JP extends Sys.EventArgs{constructor(a){super();this.shape=a}}Object(m.a)(JP,"ShapeViewElementPresenceStateChangedEventArgs",
Sys.EventArgs,[]);class KP{constructor(a,b){this.Eg=a;this.ua=this.Eg.shape;this.ua.Es=!1;this.Wyg=new JP(this.ua);this.gj=Object(qa.a)(pF,this.Eg.szh);this.L1g=b;(this.WCg=w.AFrameworkApplication.fa.ka("PPTCanvasPresenceBubbleUXEnabled"))&&this.Eg&&(this.Eg.Qbb=!0)}xm(a){this.Eg.xm(a)}iC(a){this.Eg.iC(a)}Mp(){return this.Eg.Mp()}KL(a){return this.Eg.EAb(a)}Xw(a){this.Eg.Xw(a)}Elc(){this.Eg.Elc()}kJe(){this.Eg.kJe()}dispose(){this.Eg.dispose()}my(){this.Eg.my()}aD(a){return this.Eg.aD(a)}QA(a){return this.Eg.QA(a)}draw(a,
b){this.Eg.draw(a,b)}get visible(){return this.Eg.visible}set visible(a){this.Eg.visible=a}setPosition(a,b){this.Eg.setPosition(a,b)}Ij(a){this.Eg.Ij(a)}vq(a){this.Eg.vq(a)}Eu(a){this.Eg.Eu(a)}setZIndex(a){this.Eg.setZIndex(a)}JD(a,b){this.Eg.JD(a,b)}setSelection(){}fja(a){a&&(this.fRa(),this.gj.kB(a),this.Eg.QQb(),this.Eg.setVisibility(),xa.a.J(22675524,814,50,"ShapePresenceView::AddPresence; Added User: {0}; Pawn and Border Color: {1}; shape: {2}",a.clientId,this.gj.F_a,this.ua?this.ua.Kr:"null_moniker"))}x0a(a){if(a&&
this.gj){this.gj.nP(a);this.Eg.QQb();var b=this.gj.e9();b&&b.length?xa.a.J(22675528,814,50,"ShapePresenceView::RemovePresence - Remove user from shape presence view; User: {0}, Current Pawn and Border color: {1}; shape: {2}",a.clientId,this.gj.F_a,this.ua?this.ua.Kr:""):xa.a.J(22675526,814,50,"ShapePresenceView::RemovePresence - Removed last user, removed pawn and border, User: {0}, shape: {1}",a.clientId,this.ua?this.ua.Kr:"null_moniker");this.Eg.setVisibility();this.FCa()}}CKf(){this.gj.clear();
this.Eg.QQb();this.FCa()}N1e(){this.gj.N1e()}Qul(){this.gj.l2e()}fea(){this.gj.tge()}Byd(a){a&&this.fRa();this.gj&&(this.gj.GW=a);this.Eg.QQb();this.WCg&&this.gj&&(this.gj.GW?this.gj.gOb(a.clientId,!0):this.gj.vBi());a||this.FCa()}get ijb(){return this.gj}get Xfe(){return this.gj.DYc()}get Ntb(){return this.Eg.Ntb}set Ntb(a){this.Eg.Ntb=a}fRa(){this.ua.Es||this.Xfe||(this.ua.Es=!0,this.L1g.Jkh(this.Wyg))}FCa(){this.ua.Es&&!this.Xfe&&(this.ua.Es=!1,this.L1g.Jkh(this.Wyg))}}Object(m.a)(KP,"ShapePresenceView",
null,[238,239,240,107]);var JS=d(342);class pA{get name(){return"PowerPointWebEditor.ShapePresence"}Yb(a){a.register(191,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>").ma().oa(()=>new JS.a((b,c)=>{let f=null;const l=Object(qa.a)(119,b.qc(a.resolve("Box4.IPageView").Na));l&&!l.Nl&&(b=a.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").s1d(a.resolve("PowerPointWebEditor.IPptSelectionManager"),(y,H,Q)=>Object(qa.a)(192,a.resolve("PowerPointWebEditor.ShapePresence.IShapePawnFactory").pOi(y,
H,Q)),b,c,l.hV),f=new KP(b,a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier")),f.xm(l.hV),l.Yra(f,1),f.visible=l.OQ||l.io);return f}));a.register(193,"PowerPointWebEditor.ShapePresence.IShapePawnFactory").ma().oa(()=>new GP(a.resolve("Common.IPointerInputManager"),a.resolve("Common.IClickInputManager"),a.resolve("PowerPoint.IBrowserHelperManager"),a.resolve("PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory"),a.resolve("PowerPointWebEditor.IActiveSlideViewManager")));
a.register(194,"PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory").ma().oa(()=>new DP(a.resolve("PowerPoint.IPathManager")));a.register(195,"PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").ma().oa(()=>new IP)}init(){}dispose(){}static main(){n.a.instance.Ac(new pA)}}Object(m.a)(pA,"PPTWebEditorShapePresencePackage",null,[2,3]);class qF{constructor(){this.K=null;this.YX=[new pA]}get name(){return"PowerPointWebEditor.ExtCommonPackage"}Yb(a){this.K=a;for(const b of this.YX)b.Yb(a)}init(){for(const a of this.YX)a.init();
this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").$ng=!0;wg.a.instance.lc(CP.a.k6d,(new Date).getTime())}dispose(){}static main(){wg.a.instance.lc(CP.a.l6d,(new Date).getTime());n.a.instance.Ac(new qF)}}Object(m.a)(qF,"PptExtCommonPackage",null,[2,3]);var LP=d(669),KS=d(143);class gw extends LP.a{constructor(){super();this.contextId=this.context=this.numSlides=this.prompt=null;this.H_=Object.assign(new KS.a,{T_:gw.getTypeName(),B_:gw.getBaseTypes()})}static getTypeName(){return"AugLoop_Storyteller_StorytellerSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(m.a)(gw,"StorytellerSignal",LP.a,[]);class LS{}Object(m.a)(LS,"StorytellerDebugParams",null,[]);class MS{constructor(){this.colorsModel=this.outlineModel=null}}Object(m.a)(MS,"StorytellerSettingParams",null,[]);const Eo=new Map;class MP{constructor(a){this.bTk=new Promise((b,c)=>{this.Cbl=f=>{r("AugLoopPresentationOutlineSucceeded",new Date);xa.a.J(508909145,817,50,`AugLoopGetPresentationOutlineSucceeded: ${JSON.stringify({events:Eo})}`);b(f)};this.fnh=f=>{r("AugLoopPresentationOutlineFailed",
new Date);xa.a.J(508909144,817,50,`AugLoopGetPresentationOutlineFailed: ${JSON.stringify({reason:f,events:Eo})}`);c(f)}});this.Lih=new Promise((b,c)=>{this.Fbl=f=>{r("AugLoopGetQuestionsSucceeded",new Date);xa.a.J(509118087,817,50,`AugLoopGetQuestionsSucceeded: ${JSON.stringify({events:Eo})}`);b(f)};this.MUe=f=>{r("AugLoopGetQuestionsFailed",new Date);xa.a.J(509118086,817,10,`AugLoopGetQuestionsFailed: ${JSON.stringify({reason:f,events:Eo})}`);c(f)}});this.Aok=new Promise((b,c)=>{this.Bbl=f=>{r("AugLoopGetOutlineSucceeded",
new Date);xa.a.J(509118085,817,50,`AugLoopGetOutlineSucceeded: ${JSON.stringify({events:Eo})}`);b(f)};this.enh=f=>{r("AugLoopGetOutlineFailed",new Date);xa.a.J(509118084,817,10,`AugLoopGetOutlineFailed: ${JSON.stringify({reason:f,events:Eo})}`);c(f)}});this.zok=new Promise((b,c)=>{this.ubl=f=>{r("AugLoopGetColorsSucceeded",new Date);xa.a.J(509118083,817,50,`AugLoopGetColorsSucceeded: ${JSON.stringify({events:Eo})}`);b(f)};this.dnh=f=>{r("AugLoopGetColorsFailed",new Date);xa.a.J(509118082,817,10,`AugLoopGetColorsFailed: ${JSON.stringify({reason:f,
events:Eo})}`);c(f)}});this.Bok=new Promise((b,c)=>{this.Mbl=f=>{r("AugLoopGetTemplatesSucceeded",new Date);xa.a.J(509118081,817,50,`AugLoopGetTemplatesSucceeded: ${JSON.stringify({events:Eo})}`);b(f)};this.gnh=f=>{r("AugLoopGetTemplatesFailed",new Date);xa.a.J(509118080,817,10,`AugLoopGetTemplatesFailed: ${JSON.stringify({reason:f,events:Eo})}`);c(f)}});this.promise=Promise.allSettled([this.Aok,this.zok,this.Bok]);this.smk=window.setTimeout(()=>{this.enh(`Timeout outlinePromise after ${a.fTe} ms`)},
a.DKk);this.xfk=window.setTimeout(()=>{this.dnh(`Timeout colorsPromise after ${a.GLf} ms`)},a.GLf);this.zrk=window.setTimeout(()=>{this.gnh(`Timeout templatePromise after ${a.bIh} ms`)},a.bIh);this.Hok=window.setTimeout(()=>{this.MUe(`Timeout questionsPromise after ${a.fTe} ms`)},a.fTe);this.sok=window.setTimeout(()=>{this.fnh(`Timeout presentationOutlinePromise after ${a.yhh} ms`)},a.yhh)}}Object(m.a)(MP,"DeferredStorytellerAugLoopPromise",null,[]);class qA{constructor(a,b,c){this.Bve=new Map;this.tte=
new Map;this.la=a;this.Jb=b;this.Nv=c;this.Nv.execute(f=>{this.la.ka("StoryTellerShowQuestions")&&(f.VZ("AugLoop_Storyteller_StorytellerQuestionsResponse"),f.Moa("AugLoop_Storyteller_StorytellerQuestionsResponse",this.MQ.bind(this)));this.la.ka("StoryTellerUsePresentationOutlineJSON")?(xa.a.J(508908557,817,50,"StorytellerAugLoopManager: activating and registering presentationOutlineAnnotation"),f.VZ("AugLoop_Storyteller_StorytellerPresentationOutlineResponse"),f.Moa("AugLoop_Storyteller_StorytellerPresentationOutlineResponse",
this.MQ.bind(this))):(f.VZ("AugLoop_Storyteller_StorytellerOutlineResponse"),f.Moa("AugLoop_Storyteller_StorytellerOutlineResponse",this.MQ.bind(this)),f.VZ("AugLoop_Storyteller_StorytellerColorsResponse"),f.Moa("AugLoop_Storyteller_StorytellerColorsResponse",this.MQ.bind(this)),f.VZ("AugLoop_Storyteller_StorytellerTemplatesResponse"),f.Moa("AugLoop_Storyteller_StorytellerTemplatesResponse",this.MQ.bind(this)))})}Shl(a,b,c,f){var l;if(a.contextId){var y=Object.assign(new gw,Object.assign(Object.assign({},
a),{debugParams:{debugMetadataEnabled:this.la.icb,outlinePromptTemplate:0<(null===(l=this.la.wFh)||void 0===l?void 0:l.length)?this.la.wFh:void 0},settingParams:{textToImageEnabled:this.la.ka("StoryTellerEnableTextToImage"),outlineModel:this.Jb.getStringFeatureGate("Microsoft.Office.PowerPointOnline.AugLoop.StorytellerOutlineModel",null),colorsModel:this.Jb.getStringFeatureGate("Microsoft.Office.PowerPointOnline.AugLoop.StorytellerColorsModel",null)}})),H=Object.assign(new eP.a,{parentPath:["Signal",
gw.getTypeName()],items:[Object.assign(new fP.a,{body:y})]});l=new MP({yhh:this.la.wc("StorytellerPresentationOutlineAnnotationTimeout",3E4),fTe:this.la.wc("StoryTellerQuestionsAnnotationTimeout",1E4),DKk:this.la.wc("StoryTellerOutlineAnnotationTimeout",2E4),GLf:this.la.wc("StoryTellerColorsAnnotationTimeout",1E4),bIh:this.la.wc("StoryTellerTemplatesAnnotationTimeout",1E4)});this.la.ka("StoryTellerShowQuestions")||l.MUe("ShowStoryTellerQuestions disabled");Promise.allSettled([l.Lih,l.promise]).then(()=>
{this.Bve.delete(a.contextId);this.tte.delete(a.contextId)});l.bTk.then(Q=>qA.ntg(Q)?f(Q.presentationOutline):(xa.a.J(508909143,817,10,"StorytellerAugLoopManager:sendStorytellerSignal Promise rejected"),f(void 0))).catch(Q=>{Q=this.la.icb?"":JSON.stringify(Q);xa.a.J(508909142,817,10,`StorytellerAugLoopManager:sendStorytellerSignal presentationOutlinePromise Exception ${Q}`)});l.Lih.then(Q=>b(Q.questionsResponse)).catch(Q=>{Q=this.la.icb?"":JSON.stringify(Q);xa.a.J(509214794,817,10,`StorytellerAugLoopManager:sendStorytellerSignal questionsPromise Exception ${Q}`)});
l.promise.then(([Q,ia,wa])=>{var Ua,kb,Gb,ec,dc,Fc,yc,tc,xd,Vd,Ld,ye,Xd,Xf;if("rejected"==Q.status)return xa.a.J(509195422,817,10,`StorytellerAugLoopManager:sendStorytellerSignal Promise rejected - outline:${Q.status}, colors:${ia.status}, templates:${wa.status}`),c(void 0);const ug={ColorScheme:"fulfilled"==ia.status?{Accent1:null===(Ua=ia.value.colorPalette)||void 0===Ua?void 0:Ua.accent1,Accent2:null===(kb=ia.value.colorPalette)||void 0===kb?void 0:kb.accent2,Accent3:null===(Gb=ia.value.colorPalette)||
void 0===Gb?void 0:Gb.accent3,Accent4:null===(ec=ia.value.colorPalette)||void 0===ec?void 0:ec.accent4,Accent5:null===(dc=ia.value.colorPalette)||void 0===dc?void 0:dc.accent5,Accent6:null===(Fc=ia.value.colorPalette)||void 0===Fc?void 0:Fc.accent6,Hyperlink:null===(yc=ia.value.colorPalette)||void 0===yc?void 0:yc.hyperlink,ClickedHyperlink:null===(tc=ia.value.colorPalette)||void 0===tc?void 0:tc.clickedHyperlink,LightBackground:null===(xd=ia.value.colorPalette)||void 0===xd?void 0:xd.lightBackground,
DarkBackground:null===(Vd=ia.value.colorPalette)||void 0===Vd?void 0:Vd.darkBackground,TextColorLight:null===(Ld=ia.value.colorPalette)||void 0===Ld?void 0:Ld.textColorLight,TextColorDark:null===(ye=ia.value.colorPalette)||void 0===ye?void 0:ye.textColorDark}:{},PresOutline:{Title:null===(Xd=Q.value.presentation)||void 0===Xd?void 0:Xd.title,Slides:null===(Xf=Q.value.presentation)||void 0===Xf?void 0:Xf.slides.map(qg=>{var Fg;return{Title:qg.title,Notes:qg.notes,KeyPoints:qg.keyPoints,ImagesQuery:this.la.ka("StoryTellerEnableHubbleImageSearch")?
qg.images:void 0,Images:null===(Fg=qg.imageUrls)||void 0===Fg?void 0:Fg.map(qf=>({Url:qf,Format:""}))}})},ThemeIds:"fulfilled"==wa.status?wa.value.templateIds:void 0};return c(ug)}).catch(Q=>{Q=this.la.icb?"":JSON.stringify(Q);xa.a.J(509214863,817,10,`StorytellerAugLoopManager:sendStorytellerSignal outlinePromise Exception ${JSON.stringify(Q)}`)});this.Bve.set(a.contextId,l);this.tte.set(a.contextId,new Date);this.Nv.execute(Q=>{Q.submitOperation(H);r("AugLoopOpSubmitted",new Date)})}else xa.a.J(509214865,
817,10,"StorytellerAugLoopManager:sendStorytellerSignal No contextId")}MQ(a){var b;if(a.contextId){var c=this.Bve.get(a.contextId),f=this.tte.get(a.contextId);if(c&&f){var l=null!==(b=a.loggableMetadata)&&void 0!==b?b:{};l.annotationType=a.ownerId;l.ZYl=(+new Date-+f).toString();xa.a.J(509207583,817,15,`StorytellerAugLoopManager:handleAnnotationEvent ${JSON.stringify(l)}`);a.debugMetadata&&0<Object.keys(a.debugMetadata).length&&console.log(`Storyteller Debug Info for ${a.ownerId}: ${JSON.stringify(a.debugMetadata)}`);
return qA.ntg(a)?this.zrh(!0,a,c):this.zrh(!1,a,c)}xa.a.J(509214861,817,10,"StorytellerAugLoopManager:handleAnnotationEvent No deferredPromise found")}else xa.a.J(509214862,817,10,"StorytellerAugLoopManager:handleAnnotationEvent No contextId")}zrh(a,b,c){switch(b.ownerId){case "StorytellerQuestions":clearTimeout(c.Hok);a?c.Fbl(b):c.MUe(b);break;case "StorytellerOutline":clearTimeout(c.smk);a?c.Bbl(b):c.enh(b);break;case "StorytellerColors":clearTimeout(c.xfk);a?c.ubl(b):c.dnh(b);break;case "StorytellerTemplates":clearTimeout(c.zrk);
a?c.Mbl(b):c.gnh(b);break;case "Storyteller":clearTimeout(c.sok);a?c.Cbl(b):c.fnh(b);break;default:xa.a.J(509214860,817,10,`StorytellerAugLoopManager:resolveOrRejectDeferredPromise Invalid type:${b.ownerId}, resolve:${a}`)}}static ntg(a){if(!a)return xa.a.J(509214859,822,10,"StorytellerAugLoopManager:isValidStorytellerAnnotation annotationItem is undefined."),!1;const b=null===a||void 0===a?void 0:a.status;if(!b||0!==b.code)return xa.a.J(509214858,817,10,`StorytellerAugLoopManager:isValidStorytellerAnnotation type:${a.ownerId} error response. status: ${b?
JSON.stringify(b):""}`),!1;xa.a.J(509214857,817,15,`StorytellerAugLoopManager:isValidStorytellerAnnotation type:${a.ownerId} is valid.`);return!0}dispose(){}}Object(m.a)(qA,"StorytellerAugLoopManager",null,[]);class hw extends Sys.EventArgs{constructor(a){super();this.A2i=a}}Object(m.a)(hw,"QueueShowingPanesEventEventArgs",Sys.EventArgs,[]);class rA extends Sys.EventArgs{constructor(a){super();this.iPb=a}}Object(m.a)(rA,"StoryTellerEventArgs",Sys.EventArgs,[]);class rF{GBh(){return this.la.ka("StoryTellerWaitForThumbnailRefreshForDismissDialog")}constructor(a,
b,c,f,l,y){this.jGb=5;this.jcd=new Date;this.Ite=0;this.Qgc=this.i8c=this.Pfc=!1;this.Txa=()=>{this.nd.LVe(this.Txa);this.i8c=!0};this.NGk=()=>{wn.c(ea.a.Ecl,!0)};this.onClose=()=>{this.Pfc=!0;this.la.ka("StoryTellerRaiseQueueShowingPanesEvent")&&this.le.sqc(new hw(!1));this.GBh()&&(this.nd.LVe(this.Txa),this.i8c=!1);Object(eb.a)("StoryTellerToSDXTransition")&&this.la.ZF&&this.ied.BTe(new rA({query:this.sgb,status:this.Qgc?"Cancelled":"NotHandled"}));wn.c(ea.a.fCi,!0)};this.dNe=(H,Q)=>{wn.c(ea.a.gCl,
!0);void 0!=this.sgb&&this.la.ka("StoryTellerShowQuestions")||(this.sgb=H,this.Ite++,this.jcd=new Date,r("PromptSubmitted",this.jcd));if(Q)switch(Q.presentationLength){case "shortLength":this.jGb=5;break;case "mediumLength":this.jGb=8;break;case "longLength":this.jGb=11}this.Qgc=!0;const ia=Object.assign(new gw,{prompt:this.sgb,numSlides:this.jGb,context:null===Q||void 0===Q?void 0:Q.additionalContext,contextId:Hg.a.create().toString()});let wa=()=>{},Ua=()=>{};Q=new Promise((kb,Gb)=>{wa=(ec,dc)=>
{xa.a.J(509158928,817,15,`Storyteller${dc}Succeeded: ${JSON.stringify({totalDurationMs:+new Date-+this.jcd,augLoopContextId:ia.contextId,attemptCount:this.Ite,presentationLength:this.jGb,events:Eo})}`);"PromptToOutlineFlow"===dc&&Eo.clear();kb(ec)};Ua=ec=>{xa.a.J(509158927,817,10,`StorytellerFailed: ${JSON.stringify({reason:ec,totalDurationMs:+new Date-+this.jcd,augLoopContextId:ia.contextId,attemptCount:this.Ite,presentationLength:this.jGb,events:Eo})}`);this.Qgc=!1;Object(eb.a)("StoryTellerToSDXTransition")&&
this.la.ZF&&this.ied.BTe(new rA({query:this.sgb,status:"Fail"}));Eo.clear();Gb(ec)}});this.Oqk.Shl(ia,kb=>Object(vj.a)(this,void 0,void 0,function*(){this.ZWk(wa,Ua,H,kb)}),kb=>Object(vj.a)(this,void 0,void 0,function*(){this.yKk(wa,Ua,H,kb)}),()=>Object(vj.a)(this,void 0,void 0,function*(){this.aTk()}));return Q};this.pXa=a;this.Oqk=b;this.la=c;this.le=f;this.nd=l;this.ied=y}dispose(){}H9j(){r("LoadDialog",new Date);const a=document.createElement("div");a.style.height="0px";a.style.width="0px";a.style.display=
"none";document.body.appendChild(a);const b={enableTryAgainButton:this.la.ka("StoryTellerEnableTryAgainButton"),promptCharacterLimit:this.la.wc("StoryTellerPromptCharacterLimit",200),disableBlankInputOnInitialPrompt:this.la.ka("StoryTellerDisableBlankInputOnInitialPrompt"),disableInputFieldEditOnBlur:this.la.ka("StoryTellerDisableInputFieldEditOnBlur"),enablePromptCharacterLimit:this.la.ka("StoryTellerEnablePromptCharacterLimit")};this.Qgc=!1;(new storytellerDialog.StorytellerDialogManager(a,this.dNe,
{settings:b},this.onClose,this.NGk)).showDialog()}lUl(a,b){return Object(vj.a)(this,void 0,void 0,function*(){function c(l=1E3){return new Promise(y=>{setTimeout(y,l)})}let f=0;for(;!this.i8c&&f<a;)yield c(b),f+=b;this.i8c||xa.a.J(509141907,817,10,`StorytellerView:waitForThumbnailRefresh never received thumbnail refresh event; maxWaitTimeMs: ${a}`);xa.a.J(509141906,817,50,`StorytellerView:waitForThumbnailRefresh finished; currentWaitTimeMs: ${f}`)})}J4k(){this.nd.qJc(this.Txa)}aTk(){Object(vj.a)(this,
void 0,void 0,function*(){})}yKk(a,b,c,f){Object(vj.a)(this,void 0,void 0,function*(){if(this.Pfc)return xa.a.J(509118089,817,15,"StorytellerView:onSubmit:outlineCallback User closed StoryTeller dialog before Augloop response"),r("UserClosedBeforeOutlineCallback",new Date),b("UserClosedBeforeOutlineCallback");if(!f)return xa.a.J(509195420,817,10,"StorytellerView:onSubmit:outlineCallback outlineAnnotation failed"),r("AugLoopGetOutlineFailed",new Date),b("outlineAnnotation failed");if(this.sgb!=c||
!this.la.ka("ShowStoryTellerQuestions"))try{const l={ClientName:"StoryTeller",MergeAction:"ReplaceAll"};r("Send2ndOutlineToPPT",new Date);const y=yield this.pXa.T8d(f,l);r("Send2ndMergeSlides",new Date);if(this.Pfc)return xa.a.J(509118088,817,15,"StorytellerView:onSubmit:outlineCallback User closed StoryTeller dialog before Merge request"),r("UserClosedBeforeMergeOutlineCallback",new Date),b("UserClosedBeforeMergeOutlineCallback");if(!(yield this.pXa.EIe(y,l)))return b("MergeSlidesFailure");this.ied.sYk();
this.la.ka("StoryTellerRaiseQueueShowingPanesEvent")&&this.le.sqc(new hw(!1));this.GBh()&&(this.J4k(),yield this.lUl(this.la.wc("StoryTellerDialogDismissTimeoutMs",3E3),this.la.wc("StoryTellerDialogDismissPollIntervalMs",200)));r("2ndMergeSlidesSucceeded",new Date);this.Qgc=!1;Object(eb.a)("StoryTellerToSDXTransition")&&this.la.ZF&&this.ied.BTe(new rA({query:this.sgb,status:"Success"}));return a({prompts:[],fShouldDismiss:!0},"PromptToOutlineFlow")}catch(l){return xa.a.J(509211013,817,10,`StorytellerView:onSubmit:outlineCallback Exception ${l}`),
r("OutlineCallbackFailed",new Date),this.la.ka("StoryTellerRaiseQueueShowingPanesEvent")&&this.le.sqc(new hw(!1)),b(`${l}`)}})}ZWk(a,b,c,f){Object(vj.a)(this,void 0,void 0,function*(){if(!this.la.ka("StoryTellerShowQuestions"))return xa.a.J(509159458,817,10,"StorytellerView:onSubmit:questionsCallback ShowStoryTellerQuestions disabled"),b("ShowStoryTellerQuestions disabled");if(this.Pfc)return xa.a.J(509118091,817,15,"StorytellerView:onSubmit:questionsCallback User closed StoryTeller dialog before Augloop response"),
r("UserClosedBeforeQuestionsCallback",new Date),b("UserClosedBeforeQuestionsCallback");if(!f)return xa.a.J(509195421,817,10,"StorytellerView:onSubmit:questionsCallback questionsAnnotation failed"),r("AugLoopGetQuestionsFailed",new Date),b("questionsAnnotation failed");if(this.sgb==c){const l={ColorScheme:{},PresOutline:{Title:void 0,Slides:[{Title:f.slide.title,Notes:f.slide.notes,KeyPoints:f.slide.keyPoints,ImagesQuery:this.la.ka("StoryTellerEnableHubbleImageSearch")?f.slide.images:void 0}]},ThemeIds:void 0};
try{const y={ClientName:"StoryTeller",MergeAction:"ReplaceAll"};r("Send1stOutlineToPPT",new Date);const H=yield this.pXa.T8d(l,y);r("Send1stMergeSlides",new Date);if(this.Pfc)return xa.a.J(509118090,817,15,"StorytellerView:onSubmit:questionsCallback User closed StoryTeller dialog before Merge request"),r("UserClosedBeforeMergeQuestionsCallback",new Date),b("UserClosedBeforeMergeQuestionsCallback");this.pXa.EIe(H,y)}catch(y){return xa.a.J(509211014,817,10,`StorytellerView:onSubmit:questionsCallback Exception ${y}`),
r("QuestionsCallbackFailed",new Date),b(`${y}`)}r("QuestionsCallbackSucceeded",new Date);return a({prompts:f.qList,fShouldDismiss:!1},"PromptToQuestionFlow")}})}}Object(m.a)(rF,"StorytellerView",null,[]);class sF{constructor(){this.xa=new Pc.a}sYk(){var a=new Sys.EventArgs;this.xa.raiseEvent("MSS",a)}Mgi(a){this.xa.addHandler("MSS",a)}Moh(a){this.xa.removeHandler("MSS",a)}BTe(a){this.xa.raiseEvent("STEC",a)}ohi(a){this.xa.addHandler("STEC",a)}}Object(m.a)(sF,"StorytellerEventSource",null,[393,394]);
class NP{constructor(a,b,c,f,l){this.tGe=[];this.fGg=!1;this.w$g=()=>{this.k_g.Moh(this.w$g);this.aFg.pTd(this.Nbh);this.Mc.CCa(this.RJa)};this.Nbh=()=>{this.fGg=!0;this.aFg.Voh(this.Nbh);this.oc.ETa().forEach(y=>{this.tGe.push(Va.a.Uy(y.sid,y.cid))});setTimeout(()=>{this.gqh("onTimer")},1E3*this.Jb.wc("StoryTellerReportKeptRateTimerInSeconds",300))};this.RJa=(y,H)=>{this.Mc.gpd(this.RJa);this.fGg?this.gqh("onSessionEnd"):xa.a.J(509125888,817,15,`StorytellerKeepRateTracker::onBeforeSessionEnd session ended before inbound happen, sessionCloseReason: ${H.GD}`)};
this.gqh=y=>{let H=0;for(let Q of this.tGe)this.oc.Zk(Q)&&H++;xa.a.J(509125859,817,15,`StorytellerKeepRateTracker::reportKeptSlideCount source:${y}, addedSlideCount:${this.tGe.length}, keptSlideCount:${H}`)};this.Jb=a;this.k_g=b;this.aFg=c;this.oc=f;this.Mc=l;this.k_g.Mgi(this.w$g)}}Object(m.a)(NP,"StorytellerKeepRateTracker",null,[]);var NS=d(460);class tF{get name(){return"PowerPointWebEditor.Storyteller"}Yb(a){this.K=a;const b=this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.K.register(sF,
"PowerPointWebEditor.IStorytellerEventNotifier").as("PowerPointWebEditor.IStorytellerEventListener").ma().oa(()=>new sF);this.K.register(rF,"PowerPointWebEditor.StorytellerView").as("PowerPointWebEditor.IStorytellerView").ma().oa(()=>new rF(this.K.resolve("PowerPointWebEditor.ICopilotProxy"),new qA(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IAppSettingsManager"),this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IStorytellerEventNotifier")));const c=w.AFrameworkApplication.fK||w.AFrameworkApplication.cC;b.lWa?this.Cvg(b,c):b.ka("CopilotStartLicenseCheckEnabled")&&this.K.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(f=>{f.isFeatureEnabled("Copilot",!1).then(l=>{l?this.Cvg(b,c):xa.a.J(508900954,817,50,"PPTWebEditorStorytellerPackage:configure not loading Storyteller script since user is not licensed for Copilot.")})})}Cvg(a,
b){if(!1===a.ka("CopilotStartMasterSwitch"))xa.a.J(508900953,817,50,"PPTWebEditorStorytellerPackage: not loading Storyteller script since Copilot Start master switch disabled.");else if(a.QL&&(""==a.u2a||"blank"==a.u2a)&&!b||a.icb)a.ka("StoryTellerRaiseQueueShowingPanesEvent")&&this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier").sqc(new hw(!0)),this.loadScript()}loadScript(){r("LoadDialogScript",new Date);Pd.a.get_instance().Mj(7,()=>Object(vj.a)(this,void 0,void 0,function*(){const a=cs.a(this.K);
yield a("storytellerDialog");a("storytellerDialog").then(()=>{this.K.resolve("PowerPointWebEditor.IStorytellerView").H9j()}).catch(b=>{xa.a.J(509154954,817,10,`PPTWebEditorStorytellerPackage:loadScript Exception while loading storytellerDialog ${JSON.stringify(b)}`);this.K.resolve("PowerPointWebEditor.IApplicationSettings").ka("StoryTellerRaiseQueueShowingPanesEvent")&&this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier").sqc(new hw(!1))})}))}init(){this.Qqk=this.K.resolve("PowerPointWebEditor.IStorytellerView");
Object(eb.a)("EnableStoryTellerKeepRateTracker")&&new NP(this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IStorytellerEventListener"),NS.a.instance,this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"))}dispose(){this.Qqk.dispose()}static main(){w.AFrameworkApplication.fa.ka("EnableStoryTeller")&&n.a.instance.Ac(new tF)}}Object(m.a)(tF,"PPTWebEditorStorytellerPackage",null,[2,3]);var OS=d(553),OP=d(686),
PP=d(227);class uF{get name(){return"Common.App.OAuth.OAuthPackage"}Yb(a){a.register(232,"Common.App.OAuth.IOAuthManager").ma().oa(()=>new OS.OAuthManager)}init(){const a=Ib.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.VKl(a)}VKl(a){const b=w.AFrameworkApplication.fa.Ha("FileSource");if(w.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||w.AFrameworkApplication.fa.ka("IsO365CommercialHost")||"WopiTest"===b){var c=PP.OAuthManagerSettings.f0d;if(c&&c.IsEnabled){var f=c.Application,l=PP.OAuthManagerSettings.authority;
if(void 0!==f&&null!==f&&f.length&&void 0!==l&&null!==l&&l.length){var y=OP.a[a.tZ],H=z.a.iz,Q=a.pE();try{var ia=new Map;void 0!==ia&&null!==ia?(ia.set("SupportStatus",y),ia.set("Browser",H),ia.set("AuthStrategy",Q)):ia=null}catch(Ua){ia=null}$d.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",ia);var wa=Bd.a.vj();a.gI("Core",f).then(Ua=>{const kb=Math.floor(Bd.a.vj()-wa);y=OP.a[a.tZ];H=z.a.iz;Q=a.pE();ka.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',
kb,Ua.IsSuccess,y,Ua.ErrorCode,b,H,Q);ia&&(ia.set("SupportStatus",y),ia.set("Browser",H),ia.set("AuthStrategy",Q));var Gb=Object.assign(new Mj.a,{durationMs:kb,extendedProperties:ia});if(Ua.IsSuccess){if($d.Health.instance.recordKpiSuccess("WacCorePFT",Gb),Ua="Bearer "+Ua.Token,w.AFrameworkApplication.Me.G$e=Ua,Gb=c.Endpoint){var ec=Bd.a.vj();w.AFrameworkApplication.Me.Csb(Gb,1,null,{["Authorization"]:Ua},2,"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(dc=>{var Fc=Math.floor(Bd.a.vj()-
ec),yc=null;dc.ho?dc="Canceled":dc.Dm?dc="Faulted":(yc=dc.result,dc=yc.succeeded?"Completed":"Failed");Fc={["TaskResult"]:dc,["BrowserTokenDurationMS"]:kb,["BrowserValidationDurationMS"]:Fc};yc&&(Fc.HttpStatus=yc.uj.data.Ke,yc.succeeded&&(yc=De.a(yc.uj.data.ee),Fc.ServerValidationDurationMS=yc.ElapsedMilliseconds,Fc.ServerValidationResult=yc.ValidatedToken,Fc.KMSI=yc.KMSI,Fc.Scopes=yc.Scopes,Fc.TokenExpirationS=Math.floor(parseInt(yc.Expiration)-(new Date).getTime()/1E3)));ka.ULS.sendTraceTag(520632322,
3E3,"Completed"===dc?50:15,ta.a.toJSON(Fc))})}}else $d.Health.instance.recordKpiFailure("WacCorePFT",Ua.ErrorCode,!1,!1,Gb)}).catch(Ua=>{var kb=Math.floor(Bd.a.vj()-wa);kb=Object.assign(new Mj.a,{durationMs:kb,extendedProperties:ia});$d.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+Ua.toString(),!1,!1,kb)})}}}}dispose(){}static main(){n.a.instance.Ac(new uF)}}Object(m.a)(uF,"OAuthPackage",null,[2,3]);var QP=d(13);Type.registerNamespace("B4A11Y");Type.registerNamespace("B4Ac");
Type.registerNamespace("B4AuC");Type.registerNamespace("B4Im");Type.registerNamespace("B4LE");Type.registerNamespace("B4OLE");Type.registerNamespace("B4Proofing");Type.registerNamespace("B4TLE");Type.registerNamespace("B4TM");Type.registerNamespace("B4TaE");Type.registerNamespace("B4TaVE");Type.registerNamespace("B4UI");Type.registerNamespace("B4UndoRedo");Type.registerNamespace("B4Up");Type.registerNamespace("Box3");Type.registerNamespace("Box4");Type.registerNamespace("Box4.Clipboard");Type.registerNamespace("Box4.ContentEditable");
Type.registerNamespace("Box4.Insights");Type.registerNamespace("Box4.ListMarker");Type.registerNamespace("Box4.ListMarkerGallery");Type.registerNamespace("Box4.ParagraphRenderElements");Type.registerNamespace("Box4.Shortcuts");Type.registerNamespace("Box4.WordPrediction");Type.registerNamespace("Box4.WordPrediction.Telemetry");Type.registerNamespace("ColorPickerManager");Type.registerNamespace("Microsoft.Office.Infrared");Type.registerNamespace("PPTe");Type.registerNamespace("PowerPoint");Type.registerNamespace("PowerPointLive");
Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.Aria");Type.registerNamespace("PowerPointWebEditor.Assistance");Type.registerNamespace("PowerPointWebEditor.AugmentationLoop");Type.registerNamespace("PowerPointWebEditor.AutoFit");Type.registerNamespace("PowerPointWebEditor.CoreExt");Type.registerNamespace("PowerPointWebEditor.DragDrop");Type.registerNamespace("PowerPointWebEditor.DynamicScriptLoader");Type.registerNamespace("PowerPointWebEditor.ErrorHandling");
Type.registerNamespace("PowerPointWebEditor.EventTiming");Type.registerNamespace("PowerPointWebEditor.Fonts");Type.registerNamespace("PowerPointWebEditor.GraphEditor");Type.registerNamespace("PowerPointWebEditor.GraphMerge");Type.registerNamespace("PowerPointWebEditor.HtmlExport");Type.registerNamespace("PowerPointWebEditor.Infrared");Type.registerNamespace("PowerPointWebEditor.ModernFontPicker");Type.registerNamespace("PowerPointWebEditor.Notes");Type.registerNamespace("PowerPointWebEditor.Paragraph");
Type.registerNamespace("PowerPointWebEditor.PodsPops");Type.registerNamespace("PowerPointWebEditor.PowerPointFeedback");Type.registerNamespace("PowerPointWebEditor.PresenterView");Type.registerNamespace("PowerPointWebEditor.Proofing");Type.registerNamespace("PowerPointWebEditor.Proofing.CloudAL");Type.registerNamespace("PowerPointWebEditor.ReplaceObject");Type.registerNamespace("PowerPointWebEditor.Ribbon");Type.registerNamespace("PowerPointWebEditor.Ruler");Type.registerNamespace("PowerPointWebEditor.ShapeEdit");
Type.registerNamespace("PowerPointWebEditor.ShapeManipulation");Type.registerNamespace("PowerPointWebEditor.SlideShow");Type.registerNamespace("PowerPointWebEditor.SmartArt");Type.registerNamespace("PowerPointWebEditor.SmartGuide");Type.registerNamespace("PowerPointWebEditor.Storage");Type.registerNamespace("PowerPointWebEditor.Table");Type.registerNamespace("PowerPointWebEditor.TableStyleEditor");Type.registerNamespace("PowerPointWebEditor.Telemetry");Type.registerNamespace("PowerPointWebEditor.TextEditing");
Type.registerNamespace("PowerPointWebEditor.TextFormatting");Type.registerNamespace("PowerPointWebEditor.UI");Type.registerNamespace("PowerPointWebEditor.UndoRedo");Type.registerNamespace("PowerPointWebEditor.UnifiedApp");Type.registerNamespace("PowerPointWebEditor.ViewEventHandler");Type.registerNamespace("PowerPointWebEditor.WebSocketFrontDoor");Type.registerNamespace("PowerpointPresence");Type.registerNamespace("TableCellMargin");Type.registerNamespace("PowerPointWebEditor.Zoom");Type.registerNamespace("PowerPointWebEditor");
Type.registerNamespace("PowerPointWebEditor.ShapePresence");window.g_hermesExtJS=Date.now();Object(QP.c)("Ext");S.main();fa.main();Ke.main();Xa.main();Cl.main();ol.main();n.a.instance.Ac(new Ri);yd.main();tF.main();Mk.main();Sf.main();Gl.main();vo.main();xm.main();pj.main();bo.main();mp.main();us.main();Dr.main();Gr.main();Up.main();Type.registerNamespace("Common.App.AccountSwitching");qq.main();Type.registerNamespace("Common.App.AltTextDialog");Type.registerNamespace("Common.App.ChromeExtensionHelper");
Type.registerNamespace("CommonUI");Type.registerNamespace("Common.App.HostNotification");Wp.main();Type.registerNamespace("Common");Lu.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");Nu.main();Type.registerNamespace("Common.App.ImageProcessor");Type.registerNamespace("Common.App.NewAndOpen.Core");n.a.instance.Ac(new pw);Type.registerNamespace("Common");Type.registerNamespace("Common.App.People");ar.main();Nn.main();Rs.main();Type.registerNamespace("Common.App.People");k.main();
Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");window.MSOJS=E;uA.main();Type.registerNamespace("Common");n.a.instance.Ac(new zF);Type.registerNamespace("CAUI");Rr.main();Type.registerNamespace("Common.App.SaveStatus");n.a.instance.Ac(new BF);Type.registerNamespace("Fdbk");Type.registerNamespace("Common.App.CustomerFeedback");d(1182).CustomerFeedbackPackage.main();Type.registerNamespace("Common.App.Zoom");nF.main();window.PPTUserInitiatedSurveysDictionary_FromAppPackage=
{PPTIdeasSurvey:{campaignId:"00832D36-A8AF-4883-B8C2-7FD77D1E3829",commentQuestion:"Why did you choose that answer?",isZeroBased:!1,promptQuestion:"Not Used",promptNoButtonText:"Not Used",promptYesButtonText:"Not Used",ratingQuestion:"Overall how do you feel while using Ideas to get suggestions for improving your slides?",ratingValuesAscending:["Extremely negative","Somewhat negative","Neither negative nor positive","Somewhat positive","Extremely positive"],showPrompt:!1,surveyType:4,title:"Thanks for using Ideas"},
PPTRehearsePresentationSurvey:{campaignId:"2c3d6424-b363-4328-8dec-a07edda7a808",commentQuestion:"Why did you choose that answer?",isZeroBased:!1,promptQuestion:"Not Used",promptNoButtonText:"Not Used",promptYesButtonText:"Not Used",ratingQuestion:"Overall, how do you feel while using Presenter Coach?",ratingValuesAscending:["Extremely negative","Somewhat negative","Neither negative nor positive","Somewhat positive","Extremely positive"],showPrompt:!1,surveyType:4,title:"Thanks for using Presenter Coach"},
TellMeSurvey:{campaignId:"e55e81b0-5645-4111-b08e-18d7cdaf2bef",commentQuestion:"Please tell us more. Why did you choose that answer?",isZeroBased:!1,promptQuestion:"We have two questions for you.",promptNoButtonText:"Not now",promptYesButtonText:"Sure",ratingQuestion:"How satisfied are you with using Microsoft Search in PowerPoint?",ratingValuesAscending:["Very dissatisfied","Dissatisfied ","Neutral","Satisfied","Very satisfied"],showEmailRequest:!0,showPrompt:!1,surveyType:4,title:"We'd love your feedback on Microsoft Search in PowerPoint"},
AddinFlyoutFeedbackSurvey:{campaignId:"327596a8-5cb9-4b12-b62a-b976921fc4ec",commentQuestion:"Please tell us what kind of add-ins would be useful to you.",isZeroBased:!1,promptQuestion:"We have two questions for you.",promptNoButtonText:"Not now",promptYesButtonText:"Sure",ratingQuestion:"Please let us know why you didn\u2019t try any add-ins at this time.",ratingValuesAscending:["Skipped it for now, will take a look later","Need bigger selection of add-ins ","These add-ins aren\u2019t useful to me",
"Need more info about each add-in","Not interested in add-ins"],showEmailRequest:!0,showPrompt:!1,surveyType:4,title:"We\u2019d love your feedback on the new look for add-ins!"}};GA.main();Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.Controls");Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.React");HA.main();PA.main();RA.main();SA.main();TA.main();UA.main();ZA.main();$A.main();hB.main();window.PowerPointEditingJewelRibbonData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},
children:[{name:"Jewel",attrs:{Alt:"STR@L_JewelText",Id:"PptJewel",DefaultSelection:"PptJewel.Open",TextDirection:"STR@L_TextDirection",LabelText:"STR@L_JewelText",Keytip:"STR@l_JewelTextKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptJewel.PrimaryMenu",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"PptJewel.PrimaryMenu.Controls"},children:[{name:"Button",attrs:{Alt:"STR@L_CloseMenu",Id:"jbtnBackArrow",Image32by32:"IMGMAP@prt2@CloseFileMenuPowerPoint_32x32x32",
Command:"0x2F9A3D80"}},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Info",LabelText:"STR@L_Info",Command:"0x2F9A3D80",Keytip:"STR@l_InfoKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Info.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"MenuFileName",Title:"STR@L_Info",ShowMenuSectionSeparator:"false"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblBreadcrumbDocName",QueryCommand:"0xE55B9734",LabelText:""}}]}]},{name:"MenuSection",attrs:{DisplayMode:"Menu48",ShowMenuSectionSeparator:"false"},
children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Info.OpenInClient",LabelText:"STR@L_OpenInPowerPoint",Description:"STR@L_OpenInPowerPointDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A",Keytip:"STR@l_EditInPowerPointKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Info.VersionHistory",LabelText:"STR@L_FileHistory",Description:"STR@L_FileHistoryDescription",Image48by48:"IMGMAP@prt2@History_48x48x32",Command:"0x1BD57F1B",Keytip:"STR@l_FileVersionKeytip"}},
{name:"Button",attrs:{Id:"PptJewel.Info.FileVersion",LabelText:"STR@L_FileVersion",Description:"STR@L_FileVersionDescription",Image48by48:"IMGMAP@prt2@Versions_48x48x32",Command:"0xFF30AFCC",Keytip:"STR@l_FileVersionKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.New",LabelText:"STR@L_New",Command:"0x2F9A3D80",PopulateDynamically:"true",PopulateOnlyOnce:"false",AllowDefaultContent:"true",PopulateQueryCommand:"0x7BA0BBA5",Keytip:"STR@l_NewKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelNew"},
children:[{name:"MenuSection",attrs:{Id:"menuLoadingNew",DisplayMode:"MenuLoading",Title:"STR@L_New"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblNewButtonsLoading"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Open",LabelText:"STR@L_Open",Command:"0x2F9A3D80",PopulateDynamically:"true",PopulateOnlyOnce:"false",AllowDefaultContent:"true",PopulateQueryCommand:"0xA6D756C7",Keytip:"STR@l_OpenKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelOpen"},children:[{name:"MenuSection",
attrs:{Id:"menuLoadingMru",DisplayMode:"MenuLoading",Title:"STR@L_Open"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblMruButtonsLoading"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Rename",LabelText:"STR@L_RenameButtonTitle",Command:"0x2F9A3D80",Keytip:"STR@l_RenameButtonTitleKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Rename.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_RenameButtonTitle"},children:[{name:"Controls",attrs:{},
children:[{name:"Button",attrs:{Id:"PptJewel.Rename.RenameDialog",LabelText:"STR@L_RenameButtonTitle",Description:"STR@L_RenameButtonDescription",Image48by48:"IMGMAP@prt2@RenameColumn_48x48x32",Command:"0x8E08F41F",Keytip:"STR@l_RenameButtonTitleKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.SaveACopy",LabelText:"STR@L_SaveACopy",Command:"0x2F9A3D80",Keytip:"STR@l_SaveAsKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.SaveACopy.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",
Title:"STR@L_SaveACopy"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.SaveACopy.SaveACopy",LabelText:"STR@L_SaveACopy",Description:"STR@L_SaveAsButtonDescription",Image48by48:"IMGMAP@prt2@SaveAs_48x48x32",Command:"0x72B6A68C",Keytip:"STR@l_SaveAsKeytip"}},{name:"Button",attrs:{Id:"PptJewel.SaveACopy.SaveAsToHost",LabelText:"STR@L_SaveACopy",Description:"STR@L_SaveACopyOnline",Image48by48:"IMGMAP@prt2@SaveAs_48x48x32",Command:"0xB8A8271F",Keytip:"STR@l_SaveAsKeytip"}},
{name:"Button",attrs:{Id:"PptJewel.SaveACopy.SaveToSharePoint",LabelText:"STR@L_SaveACopy",Description:"STR@L_SaveACopyOnline",Image48by48:"IMGMAP@prt2@SaveAs_48x48x32",Command:"0xBAA2DFAC",Keytip:"STR@l_SaveAsKeytip"}}]}]},{name:"MenuSection",attrs:{Id:"SaveAsInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"MenuSaveButton"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"PptJewel.SaveACopy.WheresTheSaveButton",LabelText:"STR@L_WheresTheSaveButton",Description:"STR@L_WheresTheSaveButtonDescription"}}]}]}]}]},
{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Print",LabelText:"STR@L_Print",Command:"0x2F9A3D80",Keytip:"STR@l_PrintKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Print.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Print"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Print.PrintToPdf",LabelText:"STR@L_Print",Description:"STR@L_PrintDescription",Image48by48:"IMGMAP@prt2@Print_48x48x32",Command:"0x5EAF6CA5",Keytip:"STR@l_PrintToPdfKeytip"}},
{name:"Button",attrs:{Id:"PptJewel.Print.PrintFullSlide",LabelText:"STR@L_PrintFullSlide",Description:"STR@L_PrintFullSlideDescription",Image48by48:"IMGMAP@prt2@HandoutsLandscapeSlides_48x48x32",Command:"0x5EAF6CA5",Keytip:"STR@l_PrintToPdfKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Print.PrintNotes",LabelText:"STR@L_PrintNotes",Description:"STR@L_PrintNotesDescription",Image48by48:"IMGMAP@prt2@HandoutsPortraitNotesLandscapePaper_48x48x32",Command:"0x108EE012",Keytip:"STR@l_PrintToPdfKeytip"}},{name:"Button",
attrs:{Id:"PptJewel.Print.PrintHandouts",LabelText:"STR@L_PrintHandouts",Description:"STR@L_PrintHandoutsDescription",Image48by48:"IMGMAP@prt2@HandoutsPortraitOnPortrait3_48x48x32",Command:"0x866D929F",Keytip:"STR@l_PrintToPdfKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Share",LabelText:"STR@L_Share",Command:"0x2F9A3D80",Keytip:"STR@l_ShareKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Share.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Share"},children:[{name:"Controls",
attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Share.ShareWithPeople",LabelText:"STR@L_ShareWithPeople",Description:"STR@L_ShareWithPeopleDescription",Image48by48:"IMGMAP@prt2@ShareDoc_48x48x32",Command:"0x3A7DFAA4",Keytip:"STR@l_ShareWithPeopleKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Share.Embed",LabelText:"STR@L_Embed",Description:"STR@L_EmbedDescription",Image48by48:"IMGMAP@prt2@EmbedDocument15_48x48x32",Command:"0x3A7B8B90",Keytip:"STR@l_EmbedKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Share.ReplyWithChanges",
LabelText:"STR@L_ReplyWithChanges",Description:"STR@L_ReplyWithChangesDescription",Image48by48:"IMGMAP@prt2@SendAsLink_48x48x32",Command:"0x4759B1F9",Keytip:"STR@l_ReplyWithChangesKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.DownloadAs",LabelText:"STR@L_DownloadAs",Command:"0x2F9A3D80",Keytip:"STR@l_DownloadAsKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.DownloadAs.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_DownloadAs"},children:[{name:"Controls",
attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadACopy",LabelText:"STR@L_DownloadCopy",Description:"STR@L_DownloadCopyDescription",Image48by48:"IMGMAP@prt2@SaveAsPowerPointPptx_48x48x32",Command:"0xD3EF8F78",Keytip:"STR@l_DownloadCopyKeytip"}},{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadACopyAsPdf",LabelText:"STR@L_DownloadAsPdf",Description:"STR@L_DownloadCopyAsPdfDescription",Image48by48:"IMGMAP@prt2@PDF_file_48x48x32",Command:"0x91656D12",Keytip:"STR@l_DownloadAsPDFKeytip"}},
{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadACopyAsOdp",LabelText:"STR@L_DownloadAsOdp",Description:"STR@L_DownloadCopyAsOdpDescription",Image48by48:"IMGMAP@prt2@SaveAsPowerPointOdp_48x48x32",Command:"0x4A7CCC65",Keytip:"STR@l_DownloadAsOdpKeytip"}},{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadAsImages",LabelText:"STR@L_DownloadAsImages",Description:"STR@L_DownloadAsImagesDescription",Image48by48:"IMGMAP@prt2@Downloadasimage_48x48x32",Command:"0x47057070",Keytip:"STR@l_DownloadAsImagesKeytip"}}]}]}]}]},
{name:"FlyoutAnchor",attrs:{Id:"PptJewel.About",LabelText:"STR@L_AboutOffice",Command:"0x2F9A3D80",Keytip:"STR@l_AboutOfficeKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.About.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_AboutOffice"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.About.TermsOfUse",LabelText:"STR@L_TermsOfUse",Description:"STR@L_TermsOfUseDescription",Image48by48:"IMGMAP@prt2@Info_48x48x32",Command:"0x8C0EBBB3",
Keytip:"STR@l_TermsOfUseKeytip"}},{name:"Button",attrs:{Id:"PptJewel.About.Privacy",LabelText:"STR@L_Privacy",Description:"STR@L_PrivacyDescription",Image48by48:"IMGMAP@prt2@ProtectForm_48x48x32",Command:"0x48091446",Keytip:"STR@l_PrivacyKeytip"}},{name:"Button",attrs:{Id:"PptJewel.About.TrustCenter",LabelText:"STR@L_TrustCenter",Description:"STR@L_TrustCenterDescription",Image48by48:"IMGMAP@prt2@ProtectForm_48x48x32",Command:"0x9A00EB4E",Keytip:"STR@l_TrustCenterKeytip"}},{name:"Button",attrs:{Id:"PptJewel.About.ThirdPartyNotices",
LabelText:"STR@l_ThirdPartyNotices",Description:"STR@l_ThirdPartyNoticesDescription",Image48by48:"IMGMAP@prt2@Info_48x48x32",Command:"0x8458E357",Keytip:"STR@l_ThirdPartyNoticesKeytip"}}]}]},{name:"MenuSection",attrs:{Id:"PptJewel.About.DiagnosticsSection",ShowMenuSectionSeparator:"false",DisplayMode:"MenuDiagnostics"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"PptJewel.About.Diagnostics",LabelText:"STR@L_Diagnostics",Description:"STR@L_DiagnosticsDescription",LabelCss:"padding-bottom: 12px; padding-top: 0px;"}},
{name:"TextBox",attrs:{Id:"PptJewel.About.SessionId",LabelText:"STR@L_DiagnosticsSessionId",QueryCommand:"0xA67B8E1D",ControlCss:"padding-top: 0px; padding-bottom: 0px;"}},{name:"TextBox",attrs:{Id:"PptJewel.About.Build",LabelText:"STR@L_DiagnosticsBuild",QueryCommand:"0xE6F12176",ControlCss:"padding-top: 0px;"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Help",LabelText:"STR@L_Help",Command:"0x2F9A3D80",Keytip:"STR@l_TabHelpKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Help.Menu"},children:[{name:"MenuSection",
attrs:{DisplayMode:"Menu48",Title:"STR@L_Help"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Help.Help",LabelText:"STR@L_Help",Description:"STR@L_HelpDescription",Image48by48:"IMGMAP@prt2@OfficeAssistant_48x48x32",Command:"0x56B04A51",Keytip:"STR@l_HelpKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Help.GiveFeedback",LabelText:"STR@L_GiveFeedback",Description:"STR@L_GiveFeedbackDescription",Image48by48:"IMGMAP@prt2@GiveFeedback_48x48x32",Command:"0x2FD6BDE0",Keytip:"STR@l_GiveFeedbackKeytip"}},
{name:"Button",attrs:{Id:"PptJewel.Help.ReportAbuse",LabelText:"STR@L_ReportAbuse",Description:"STR@L_ReportAbuseDescription",Image48by48:"IMGMAP@prt2@ReportAbuse_48x48x32",Command:"0xC0F351AE",Keytip:"STR@l_ReportAbuseKeytip"}}]}]}]}]}]}]},{name:"MenuSection",attrs:{Id:"PptJewel.SecondaryMenu",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"PptJewel.SecondaryMenu.Controls"},children:[{name:"Button",attrs:{Id:"PptJewel.Close",Command:"0xB4CE0C4E",LabelText:"STR@L_Exit",Keytip:"STR@l_ExitKeytip"}}]}]}]}]}]};
JB.main();Type.registerNamespace("Common.App.Insights");n.a.instance.Ac(new nH);Type.registerNamespace("Common.App.Activities");NB.main();Type.registerNamespace("Common.App.ActivityAggregator");SB.main();Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=nr;Type.registerNamespace("Common.App.Assistance");Type.registerNamespace("Common.App.BrowserInfoLogger");TB.main();Type.registerNamespace("Common.App.CommandUIActors");Type.registerNamespace("CADWLTR");
UB.main();Type.registerNamespace("Common.App.EventsCacheManager");VB.main();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.FloatPane");YB.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");aC.main();FC.main();JC.main();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("CNT");LC.main();Type.registerNamespace("Common.App.VisibilityManagement");
NC.main();Type.registerNamespace("Common.ModernFontPicker");OC.main();PC.main();UC.main();$C.main();cD.main();lD.main();nD.main();sD.main();Hz.main();MD.main();OD.main();PD.main();cE.main();dE.main();eE.main();fE.main();hE.main();pE.main();qE.main();Type.registerNamespace("Common.App.OAuth");uF.main();iF.main();lF.main();oF.main();Type.registerNamespace("Common.App.CollabControls");qF.main();pA.main();Object(QP.b)("Ext")},1297:function(K,U,d){K=d(0);var h=d(392),e=d(7),r=d(301),m=d(302);class n{static Lej(I){return n.Mej(I)}static Mej(I){const sa=
document.createElementNS(n.$$e,"svg");sa.setAttribute("viewBox",String.format(n.UQi,n.gQh,n.fQh));sa.appendChild(n.$tj(I));return sa}static $tj(I){const sa=n.gQh/I,ka=2*sa,Ma=n.fQh/2;I=(I-12-8)*sa/2;const Ea=document.createElementNS(n.$$e,"g");Sys.UI.DomElement.addCssClass(Ea,n.TQi);for(let ma=1;3>=ma;ma++)Ea.appendChild(n.lcj(ma,ka,I+(6*ma-2)*sa,Ma));return Ea}static lcj(I,sa,ka,Ma){const Ea=document.createElementNS(n.$$e,"circle");Sys.UI.DomElement.addCssClass(Ea,String.format("{0}-{1}",n.iAi,I));
Ea.setAttribute("cx",String.format("{0}",ka));Ea.setAttribute("cy",String.format("{0}",Ma));Ea.setAttribute("r",String.format("{0}",sa));return Ea}}n.$$e="http://www.w3.org/2000/svg";n.TQi="prDancingDots";n.iAi="prAnimateCircle";n.UQi="0 0 {0} {1}";n.fQh=40;n.gQh=120;Object(K.a)(n,"ModernPresenceTooltipDancingDots",null,[]);var z=d(27),v=d(185),x=d(78),B=d(67),D=d(139),w=d(226),J=d(99),G=d(47),M=d(3);class N extends r.a{constructor(I,sa){super(I);this.jvf=this.rOa=this.qCd=this.LZ=this.CZ=this.Xz=
this.xq=null;this.wca=sa.get(8,!1);this.Rha=sa.get(6,0);this.g$h=sa.get(15,!1);this.Yc=sa;this.$ff=0;this.element=I;this.element.className=N.B6b;this.NS=document.createElement("span");this.element.appendChild(this.NS);this.CXh=n.Lej(sa.get(6,0));this.kP(sa);this._state=5}g8(I){this.addHandler(m.a.zw,I)}Voa(I){this.removeHandler(m.a.zw,I)}get user(){return this.jvf}get state(){return this._state}dispose(){this.element&&(this.xq.Bb(B.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.xq.Bb(B.a.doubleClick,
this.element,Object(e.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior")),this.Xz.Bb(B.a.pointerDown,this.element,Object(e.a)(this,this.nib,"onPointerDown")),this.Xz.Bb(B.a.pointerOut,this.element,Object(e.a)(this,this.qG,"onPointerOut")),this.Xz.Bb(B.a.pointerOver,this.element,Object(e.a)(this,this.NM,"onPointerOver")),this.CZ.Bb(this.element,Object(e.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}kP(I){this.xq=I.get(10);this.xq.rb(B.a.click,this.element,Object(e.a)(this,
this.onClick,"onClick"));this.xq.rb(B.a.doubleClick,this.element,Object(e.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior"));this.Xz=I.get(9);this.Xz.rb(B.a.pointerOver,this.element,Object(e.a)(this,this.NM,"onPointerOver"));this.Xz.rb(B.a.pointerOut,this.element,Object(e.a)(this,this.qG,"onPointerOut"));this.Xz.rb(B.a.pointerDown,this.element,Object(e.a)(this,this.nib,"onPointerDown"));this.CZ=I.get(13);this.CZ.rb(this.element,Object(e.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior"))}hide(I=
null,sa=0,ka=0){this.g$h&&I?this.kwl(I,sa,ka):(3===this.state&&this.Cnh(),this.visible=!1,this._state=5)}kwl(I,sa,ka=0){this.show(I,sa,15,4,void 0,ka)}OBh(I,sa,ka=!1,Ma=!1,Ea=!1,ma=0){this.show(I,sa,20,ka?2:Ma?1:0,Ea,ma)}Hvl(I,sa,ka,Ma=!1,Ea=0){this.show(I,sa,ka+20,3,Ma,Ea)}show(I,sa,ka,Ma=3,Ea=!1,ma=0){!I||Ma===this.state&&this.NHj(sa,ka)||(this.Vai(Ma,Ea,ma),this.kB(I,Ma,ma),this._state=Ma,4===ma||0===ma&&!this.wca?this.element.style.left=sa+"px":this.element.style.right=sa+"px",this.element.style.top=
ka+"px",this.visible=!0)}kB(I,sa,ka){this.jvf=I;J.a.vv(this.NS);w.a.nBi(this.NS);this.NS.id="fly_"+I.clientId;this.NS.style.backgroundColor=I.color;4!==sa?(this.NS.style.height=this.Rha+"px",this.NS.style.lineHeight=this.Rha+"px",w.a.$aa(this.NS,"border-radius",this.Rha+"px")):4===ka||0===ka&&!this.wca?this.NS.style.left="0px":this.NS.style.right="0px";2!==sa&&(4===sa?J.a.Mz(this.NS,""):1===sa?this.NS.appendChild(this.CXh):(this.NS.setAttribute("dir","auto"),ka=G.a.j8f(I.userName,!1),(!I.isAnonymous||
z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1))&&ka||0!==sa?(I=I.userName,0===sa&&(I=ka,w.a.$aa(this.NS,"text-align","center")),J.a.Mz(this.NS,I)):(this.LZ||(this.LZ=this.AJi()),this.NS.appendChild(this.LZ),w.a.$aa(this.NS,"text-align","start"))))}onClick(I){if(0===this.state)return this.raiseEvent(m.a.zw,new m.a(1,I)),!0;3===this.state&&h.ULS.sendTraceTag(50436114,302,50,"User clicked on presence pill.");return!1}qG(I){3===this.state&&
this.raiseEvent(m.a.zw,new m.a(3,I));return!1}NM(I){3!==I.ng&&this.raiseEvent(m.a.zw,new m.a(2,I));return!1}nib(I){if(3!==I.ng)return!0;this.raiseEvent(m.a.zw,new m.a(4,I));return!1}AJi(){const I=document.createElement("img");I.src=v.a.JN("doughperson_white_glyph.svg");I.setAttribute("Unselectable","on");D.a.bS(I,D.a.hf,D.a.iQ);return x.createClusteredImageFromClusterWithImageClass(this.Rha,this.Rha,null,null,N.c7i,"",!1,"",this.element.ownerDocument,I)}Vai(I,sa=!1,ka=0){if(!this.Bac(this.state)||
!this.Bac(I))switch(Sys.UI.DomElement.removeCssClass(this.element,this.qCd),this.state){case 4:3===I?this.sCa(N.b8d,N.C1f):this.Bac(I)&&this.sCa(N.a8d,N.C1f);break;case 3:4===I?this.sCa(N.d8d,N.B1f):this.Bac(I)&&(sa&&this.Cnh(),this.sCa(N.a8d,N.B1f,sa?N.b7i:""));break;case 0:case 1:case 2:4===I?this.sCa(N.d8d,N.c8d):3===I&&(sa&&this.Rbi(),this.sCa(N.b8d,N.c8d,sa?N.D1f:"",3===ka?N.e7i:N.d7i));break;default:4===I?this.sCa(N.d8d):3===I?this.sCa(N.b8d):this.Bac(I)&&this.sCa(N.a8d)}}sCa(...I){this.qCd=
I.join(" ");Sys.UI.DomElement.addCssClass(this.element,this.qCd)}Rbi(){this.$ff=window.setTimeout(()=>{this.element&&(this.rOa=this.element.cloneNode(!0),this.element.parentNode.appendChild(this.rOa),this.element.style.zIndex="2",this.rOa.style.zIndex="1")},300)}Cnh(){window.clearTimeout(this.$ff);this.rOa&&(Sys.UI.DomElement.removeCssClass(this.rOa,N.c8d+" "+N.D1f),Sys.UI.DomElement.addCssClass(this.rOa,N.a7i),M.Task.delay(300).continueWith(()=>{this.element&&this.element.parentNode===this.rOa.parentNode&&
this.element.parentNode.removeChild(this.rOa)}),w.a.kVe(this.element,"z-index"))}Bac(I){return 0===I||1===I||2===I}NHj(I,sa){const ka=w.a.yoa(this.element.style.top);return w.a.yoa(this.element.style.left)===I&&ka===sa}EWe(I){3===I&&w.a.xW(this.element,"left")?(I=w.a.yoa(this.element.style.left),w.a.kVe(this.element,"left"),this.element.style.right=-1*I+"px"):4===I&&w.a.xW(this.element,"right")&&(I=w.a.yoa(this.element.style.right),w.a.kVe(this.element,"right"),this.element.style.left=-1*I+"px")}}
N.B6b="prModernFlyout UIFont";N.d8d="flyoutIdle";N.b8d="flyoutExpanded";N.a8d="flyoutCollapsed";N.C1f="flyoutFromIdle";N.B1f="flyoutFromExpanded";N.c8d="flyoutFromCollapsed";N.D1f="flyoutStacked";N.b7i="flyoutFromStacked";N.a7i="flyoutFadeOut";N.c7i="cui-img-cont-float cui-img-20by20";N.d7i="flyoutLtrDir";N.e7i="flyoutRtlDir";Object(K.a)(N,"ModernPresenceTooltipFlyoutControl",r.a,[]);class R{constructor(I,sa,ka=2,Ma=4){this.offsetTop=I;this.offsetLeft=sa;this.bQh=ka;this.Shg=Ma}}Object(K.a)(R,"FlyoutsPositioningInfo",
null,[]);var C=d(65);class O{constructor(I=!1,sa=!1){this.kl=I;this.SEd=sa}Ujj(I,sa,ka,Ma,Ea){const ma=Ea.y,va=Ea.height;var Ca=this.rbj(Ma);const oa=Ca+sa,Da=I*ka+2*(I-1);ka=null;1===I||this.Qwi(Ca,Da,ma,va)?I=new R(0,0,2):(I=this.X5i(oa,Da,ma,va),I.offsetTop-=Ca);this.SEd?ka=new R(0,0,void 0,this.kl?4:3):(Ma=this.qbj(Ma,Ea),Ca=Math.max(0,Ea.x),Ea=Ea.width,sa=Ma+sa,this.Rwi(Ma,Ca,Ea)?ka=new R(0,0,void 0,this.kl?3:4):this.Swi(sa,Ca)&&(ka=new R(0,0,void 0,this.kl?4:3)),ka||(ka=this.W5i(Ma,sa,Ca,Ea)));
return new R(I.offsetTop,ka.offsetLeft,I.bQh,ka.Shg)}rbj(I){return C.a.G9d(I)}qbj(I,sa){return this.kl?sa.width-C.a.pbj(I):C.a.E9d(I)}Qwi(I,sa,ka,Ma){return I+sa<=ka+Ma}X5i(I,sa,ka,Ma){let Ea=1,ma=Math.max(ka,I-sa);sa>I-ka&&(Ea=2,ma=sa<Ma?Ma-sa:ka);return new R(ma,0,Ea)}Rwi(I,sa,ka){return I+150<=sa+ka}Swi(I,sa){return 150<=I-sa}W5i(I,sa,ka,Ma){Ma-sa>=I-ka?I=4:(sa=I,I=3);return new R(0,sa,void 0,I)}}Object(K.a)(O,"ModernPresenceTooltipPositioner",null,[]);class S{constructor(I,sa,ka,Ma,Ea,ma,va){this.JZ=
I;this._parent=sa;this.hdf=ka;this.OVh=Ma;this.VZh=Ea;this.$rb=ma;this.wca=va;this._element=document.createElement("div");this.element.className="prTouchTarget"}get element(){return this._element}update(I,sa){if(3!==I)if(5!==I&&this.JZ&&this.JZ.length){if(4===I){var ka=this.VZh;var Ma=(this.$rb-ka)/2;this.element.style.height=this.$rb+"px";this.element.style.width=this.$rb+"px";I=w.a.yoa(this.JZ[0].element.style.top);sa=w.a.yoa(this.wca?this.JZ[0].element.style.right:this.JZ[0].element.style.left)}else ka=
this.hdf,Ma=(this.$rb-ka)/2,this.element.style.height=this.$rb+"px",this.element.style.width=this.Kcj()+2*Ma+"px",I=w.a.yoa(this.JZ[this.JZ.length-1].element.style.top),sa=this.fwi(this.JZ[this.JZ.length-1].element,ka,sa);w.a.$aa(this.element,"border-radius",this.$rb+"px");this.element.style.top=I-Ma-ka+"px";this.wca?this.element.style.right=sa-Ma+"px":this.element.style.left=sa-Ma+"px";this.element.parentNode||this._parent.insertBefore(this.element,this._parent.firstChild)}else this.element.parentNode&&
this.element.parentNode.removeChild(this.element)}fwi(I,sa,ka){return this.wca&&!ka?w.a.yoa(I.style.right):this.wca||ka?this.wca&&ka?-w.a.yoa(I.style.left)-sa:-w.a.yoa(I.style.right)-sa:w.a.yoa(I.style.left)}Kcj(){return this.JZ&&this.JZ.length?this.hdf+Math.min(this.JZ.length-1,2)*this.OVh:0}}Object(K.a)(S,"ModernPresenceTooltipTarget",null,[]);var T=d(70),ca=d(121),L=d(205);class da extends r.a{constructor(I,sa,ka){super(I);this.drb=this.Oqa=this.Gif=this.x4a=!1;this.Ch=[];this.PBc={};this.Yc=ka;
this.kl=ka.get(8,!1);this.Vhf=ka.get(15,!1);this.TWh=ka.get(12,0);this.oRa=ka.get(6,0);this.Hrb=sa;this.Bvf=ka.get(16);this.SEd=ka.get(17,!1);this.WZh=ka.get(19,!1);this.C4h=ka.get(20,!1);this.aDc=0;this.y4h=new O(this.kl,this.SEd);this.XRb=this.c6f();this.VLd=!1;this.wAa=[];this.aVb=[];this.element.id=da.R6b();this.element.className=r.a.p1d(this.kl);this.defaultZIndex&&(this.zIndex=this.defaultZIndex);this.rtl=this.kl;this.Esc(sa);this.Xha=this.createElement("div");this.Xha.className="prFlyoutContainer";
this.element.appendChild(this.Xha);this.JZ=[];this.DOa=new S(this.DT,this.element,this.oRa,4,6,32,this.kl);this.Xz=ka.get(9);this.Xz.rb(B.a.pointerDown,this.DOa.element,Object(e.a)(this,this.VIb,"onHitTarget"));this.Xz.rb(B.a.pointerOver,this.DOa.element,Object(e.a)(this,this.VIb,"onHitTarget"));this.Xz.rb(B.a.pointerOut,this.DOa.element,Object(e.a)(this,this.VIb,"onHitTarget"))}get xKb(){return L.a.clone(this.Ch)}get DT(){return this.JZ}get defaultZIndex(){return this.TWh}get vEa(){return this.DT?
this.DT.length:0}get B2a(){return 0<this.vEa?this.DT[0].state:5}get wne(){return 3===this.B2a&&!this.x4a}g8(I){this.addHandler(m.a.zw,I)}Voa(I){this.removeHandler(m.a.zw,I)}dispose(){if(this.wne)this.VLd=!0;else{if(this.DT)for(const I of this.DT)I.Voa(Object(e.a)(this,this.sY,"onInteractivityChanged")),ca.a.Ry(I);this.JZ=null;this.Xz.Bb(B.a.pointerDown,this.DOa.element,Object(e.a)(this,this.VIb,"onHitTarget"));this.Xz.Bb(B.a.pointerOver,this.DOa.element,Object(e.a)(this,this.VIb,"onHitTarget"));this.Xz.Bb(B.a.pointerOut,
this.DOa.element,Object(e.a)(this,this.VIb,"onHitTarget"));super.dispose()}}eMa(){this.H8a();this.visible=!0}hud(){this.visible=!0;this.YYf();this.x4a=!0}aMa(){this.hud()}hide(){this.Wnh();this.YW();this.DOa.update(this.B2a,this.drb)}kB(I){const sa=this.B2a,ka=this.x4a;I.clientId||(I.clientId=(da.OOa++).toString());if(I.clientId in this.PBc){var Ma=this.wka(I.clientId);if(0<=Ma){Ma=this.Ch[Ma];if(Ma.color===I.color&&Ma.userName===I.userName)return;this.nP(I.clientId)}}this.hide();Ma=new N(this.createElement("div"),
this.Yc);Ma.g8(Object(e.a)(this,this.sY,"onInteractivityChanged"));this.Xha.insertBefore(Ma.element,this.Xha.firstChild);this.PBc[I.clientId]=Ma;Array.add(this.Ch,I);Array.add(this.DT,Ma);this.VOh(sa,ka);this.visible=!0}nP(I){if(this.wne)Array.add(this.aVb,I);else{var sa=this.B2a,ka=this.x4a;this.hide();this.y0a(I);this.VOh(sa,ka)}}Rgd(I){const sa=this.wka(I);if(!(0>=sa)){var ka=this.Ch[sa];I=this.PBc[I];Array.removeAt(this.Ch,sa);Array.insert(this.Ch,0,ka);Array.removeAt(this.DT,sa);Array.insert(this.DT,
0,I);this.Xha.removeChild(I.element);this.Xha.appendChild(I.element);this.H8a()}}VOh(I,sa){0>=this.Ch.length?this.hide():3===I&&sa?this.hud():this.eMa()}gOb(I,sa){sa?this.Eai(I):this.nnh(I)}JRc(I){if(this.wne&&this.WZh)return!1;I=da.c8b(I);if(this.Xha!==I&&J.a.GVa(this.Xha,I))return!0;for(const sa of this.DT)if(J.a.GVa(sa.element,I))return!0;return!1}position(I,sa){this.element.style.top=sa+"px";this.element.style.left=I+"px"}H8a(I=!1){if(!I||this.Oqa){this.Gif&&this.eyh(!0);var sa=Math.min(3,this.vEa)-
1;I=0;var ka=1,Ma=0;this.drb&&(I=this.XRb,ka=-1,Ma=-this.oRa);for(let Ea=this.vEa-1;Ea>sa;Ea--)this.DT[Ea].OBh(this.Ch[Ea],-4*sa*ka+Ma,!0,!1,!0,I);for(;0<=sa;sa--)this.DT[sa].OBh(this.Ch[sa],-4*sa*ka+Ma,0<sa,Array.contains(this.wAa,this.Ch[sa].clientId),sa!==this.aDc,I);this.aDc=0;this.DOa.update(0,this.drb);this.zIndex=this.defaultZIndex;this.x4a=!1;this.Wnh(0);this.VLd&&this.dispose()}}YYf(){this.Gif&&this.eyh(!1);this.zIndex=this.defaultZIndex+1;let I,sa,ka;({offsetX:sa,offsetY:I,Rhg:ka}=this.Sll());
for(let Ma=0;Ma<this.vEa;Ma++)this.DT[Ma].Hvl(this.Ch[Ma],sa,I+(this.oRa+2)*Ma,Ma!==this.aDc,ka)}YW(){let I=0,sa=0;this.drb&&(I=this.XRb,sa=-6);for(let ka=0;ka<this.vEa;ka++)this.DT[ka].hide(this.Ch[ka],sa,I);this.zIndex=this.defaultZIndex;this.visible=this.x4a=!1;this.VLd&&this.dispose()}FZd(I=0){I?(this.Oqa=!0,M.Task.delay(I).continueWith(()=>{this.Vhf?this.TIj():this.H8a(!0);this.Oqa=!1})):this.Vhf?this.hide():this.H8a()}TIj(){this.Oqa&&this.hide()}Tpi(){if(z.AFrameworkApplication.Aa&&z.AFrameworkApplication.Aa.ob.zea&&
T.c()){const I=appChrome.selectors.getShyState();return I.isActive&&0!==I.state}return!1}sY(I,sa){I=this.B2a;this.Tpi()||2!==sa.type&&(4!==sa.type||3===I)?4===sa.type&&3===I?(this.Oqa&&(this.Oqa=!1),this.FZd()):3!==sa.type||3!==I||this.x4a||(1<this.vEa?(this.Oqa=!0,M.Task.delay(250).continueWith(()=>{this.H8a(!0);this.Oqa=!1})):this.FZd()):(this.Oqa&&(this.Oqa=!1),3!==I&&(this.YYf(),3===sa.Bj.ng&&this.FZd(2E3)));this.raiseEvent(m.a.zw,sa)}VIb(I){3===I.ng?this.sY(this,new m.a(4,I)):I.eventName===B.a.pointerOver?
this.sY(this,new m.a(2,I)):I.eventName===B.a.pointerOut&&this.sY(this,new m.a(3,I));return!1}Esc(I){this.element.style.width=I+"px";this.element.style.height=this.oRa+"px"}y0a(I){this.nnh(I);I=this.wka(I);if(!(0>I)){var sa=this.Ch[I];Array.removeAt(this.Ch,I);delete this.PBc[sa.clientId];sa=this.DT[I];this.Xha.removeChild(sa.element);this.Yc.get(18,!1)&&sa.Voa(Object(e.a)(this,this.sY,"onInteractivityChanged"));Array.removeAt(this.DT,I);sa.dispose()}}Wnh(I=5){if(this.aVb.length){this.visible&&this.YW();
for(let sa=0;sa<this.aVb.length;sa++)this.y0a(this.aVb[sa]);Array.clear(this.aVb);0>=this.Ch.length||5===I?this.hide():0===I&&this.eMa()}}wka(I){for(let sa=0;sa<this.Ch.length;sa++)if(this.Ch[sa].clientId===I)return sa;return-1}Eai(I){if(-1===this.wka(I))h.ULS.sendTraceTag(41706451,302,15,"Cannot set active editor because client id is invalid");else{if(Array.contains(this.wAa,I)){if(this.Ch[0].clientId===I)return;Array.remove(this.wAa,I)}Array.add(this.wAa,I);this.Rgd(I);1!==this.B2a&&this.H8a()}}nnh(I){-1===
this.wka(I)?h.ULS.sendTraceTag(41706452,302,50,"Cannot remove active editor because client id is invalid"):Array.contains(this.wAa,I)&&(Array.remove(this.wAa,I),this.Ch[0].clientId===I&&0<this.wAa.length&&this.Rgd(this.wAa[this.wAa.length-1]),this.Ch[0].clientId===I&&1===this.B2a&&this.H8a())}eyh(I){I?Sys.UI.DomElement.addCssClass(this.Xha,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(this.Xha,"prBackgroundSelection")}Sll(){let I,sa;sa=I=0;var ka=this.XRb;if(this.Bvf){const Ma=this.Bvf(this);
if(!Ma)return{offsetX:I,offsetY:sa,Rhg:ka};const Ea=4===this.B2a;ka=this.y4h.Ujj(this.vEa,Ea?6:this.oRa,this.oRa,this.element,Ma);sa=ka.offsetTop;this.aDc=this.Zij(ka.bQh,ka.offsetTop);ka=ka.Shg;ka!==this.XRb&&(this.EWe(ka),this.element.dir=3===ka?"rtl":"ltr",this.XRb=ka);ka!==this.c6f()?(I=this.C4h?-2:Ea?-6:-this.oRa,this.drb=!0):this.drb=!1}return{offsetX:I,offsetY:sa,Rhg:ka}}Zij(I,sa){if(1===I)return this.vEa-1;I=Math.abs(sa);return 0<I?I/(this.oRa+2):0}EWe(I){for(let sa=0;sa<this.vEa;sa++)this.DT[sa].EWe(I)}c6f(){return this.kl?
3:4}static R6b(){return String.format("{0}-{1}","presencetooltip",da.OOa++)}static c8b(I){return I.mc.rawEvent.relatedTarget}}da.OOa=0;Object(K.a)(da,"ModernPresenceTooltipControl",r.a,[325,107]);var Z=d(239),fa=d(318),aa=d(281);d.d(U,"a",function(){return ja});class ja{constructor(I){this.Yc=I;this.Yc.$Z(10,Z.a.instance);this.Yc.$Z(9,aa.a.instance);this.Yc.$Z(6,20);this.Yc.$Z(13,fa.a.instance);this.Yc.$Z(17,!1)}G0d(I,sa){this.Yc.$Z(15,!1);return new da(I,sa,this.Yc)}h3b(I){this.Yc.$Z(15,!1);return new da(I,
20,this.Yc)}}Object(K.a)(ja,"ModernPresenceTooltipFactory",null,[324])},1305:function(K,U,d){K=d(0);class h{constructor(r,m,n,z){this.mWh=r;this.a6h=m;this.$5h=n;this.b6h=z}get FHi(){return this.mWh}get ucl(){return this.a6h}get rcl(){return this.$5h}get resultType(){return this.b6h}}Object(K.a)(h,"SearchContext",null,[580]);d.d(U,"a",function(){return e});class e{gOi(r,m,n){var z=n-m;let v;if(100<=z)z=m,v=n;else{z=Math.max(0,m+Math.ceil(z/2)-50);v=Math.min(r.length,z+100);z=Math.max(0,v-100);let B;
if(z&&" "!==r.charAt(z-1)){B=Math.min(m,z+10);for(var x=z;x<B;++x)if(" "===r.charAt(x)){z=x+1;break}}if(v!==r.length&&" "!==r.charAt(v))for(B=Math.max(n,v-10),x=v-1;x>=B;--x)if(" "===r.charAt(x)){v=x;break}}return new h(r.substring(z,v),m-z,n-z,"")}}Object(K.a)(e,"SearchContextFactory",null,[548])},1306:function(K,U,d){K=d(0);var h;(function(r){r[r.multipleBrowsersImageClassName=0]="multipleBrowsersImageClassName";r[r.peopleImageClassName=1]="peopleImageClassName";r[r.peopleImageClusterPath=4]="peopleImageClusterPath";
r[r.multipleBrowserImageClusterPath=5]="multipleBrowserImageClusterPath";r[r.imageDimension=6]="imageDimension";r[r.rtl=8]="rtl";r[r.pointerInputManager=9]="pointerInputManager";r[r.clickInputManager=10]="clickInputManager";r[r.vertical=11]="vertical";r[r.zIndex=12]="zIndex";r[r.contextMenuInputManager=13]="contextMenuInputManager";r[r.imageDomElement=14]="imageDomElement";r[r.useIdleTooltip=15]="useIdleTooltip";r[r.viewportBoundsCallback=16]="viewportBoundsCallback";r[r.flipHorizontalDirection=17]=
"flipHorizontalDirection";r[r.fixRemoveFadeOutElementCrash=18]="fixRemoveFadeOutElementCrash";r[r.ignoreEventOnExpandedTooltip=19]="ignoreEventOnExpandedTooltip";r[r.ipWidthAdjustForFlyout=20]="ipWidthAdjustForFlyout"})(h||(h={}));Object(K.b)("PresenceTooltipSettingKeys",h);d.d(U,"a",function(){return e});class e{constructor(){this.I2={}}get(r,m=null){r=h[r];return"number"===typeof m?(m=this.I2[r])?Number.parseInvariant(m.toString()):0:this.I2[r]}add(r,m){this.I2[h[r]]=m}$Z(r,m){h[r]in this.I2||(this.I2[h[r]]=
m)}remove(r){delete this.I2[h[r]]}}Object(K.a)(e,"PresenceTooltipSettings",null,[])},154:function(K,U,d){d.d(U,"a",function(){return e});d.d(U,"b",function(){return r});var h=d(43);const e=(m,n,z)=>{m=h.a.kk(m);m.Wa("CommandId",n.toString());try{return z()}finally{m.finish(!0)}},r=(m,n,z,v)=>e(m+n,z,v)},194:function(K,U,d){d.d(U,"a",function(){return m});K=d(0);var h=d(27),e=d(1160),r=d(47);class m{static f7f(){return m.Yii+"_"+e.a.d$b+"_"+r.a.iL(h.AFrameworkApplication.userName)+"_"}static WTc(n){return n+
"_"+e.a.d$b+"_"+r.a.iL(h.AFrameworkApplication.userName)+"_"}static H$f(){return m.JTk+"_"+e.a.d$b+"_"+r.a.iL(h.AFrameworkApplication.userName)+"_"}}m.j8="ack0";m.k8="ack1";m.uJc="ack2";m.Yii="ack3";m.F_b="ack4";m.Wzf="ack7";m.tre="ack8";m.NBh="ack9";m.UVd="ack10";m.H1e="ack13";m.Ssb="AddinDetailsRefreshed";m.Wii="DdaMethod";m.Vii="ControlId";m.yJc="SecurityOrigin";m.B7a="ak0";m.ETd="ak1";m.GTd="ak2";m.Rsb="ak4";m.Vzf="Office.AutoShowTaskpaneWithDocument";m.DTd="refreshRequired";m.Xzf="value";m.bji=
"errorCode";m.F4d="SolutionId";m.D4d="MethodData";m.E4d="DynamicAddinCommandsMethodDispatchId";m.lXi="SourceControlId";m.jXi="OsfControl";m.kXi="RibbonUpdaterData";m.pwd="AddinShared";m.JTk="__OSF_PRIVATECATALOG_ADDINIDS";Object(K.a)(m,"AddinConstantsString",null,[])},238:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}h.GJc="AfterValidate";h.autoCorrect="AutoCorrect";h.fpi="BeforeValidate";h.NQi="CutAction";h.EXi="EditingElementContainerDisconnectingFromView";h.endEditing="EndEditing";
h.H5i="FinishingSelectionValidation";h.oLj="ImeTypingEnd";h.qLj="ImeTypingStart";h.NRj="IpMode";h.uy="KeyPress";h.Bf="KeyDown";h.Ayk="NotFinishingSelectionValidation";h.UKk="OvertypeEnd";h.WKk="OvertypeStart";h.ZKk="PaddingChanged";h.Xdh="ParagraphContentUpdated";h.gNk="PasteAction";h.lml="SetMode";h.typingProcess="TypingProcess";h.OBi="ClipboardModeBegin";h.PBi="ClipboardModeEnd";Object(K.a)(h,"EditEventKeys",null,[])},250:function(K,U,d){d.r(U);K=d(0);var h=d(392),e=d(56),r=d(27),m=d(47),n=d(589),
z=d(1252),v=d(18);d(1244);var x=d(1036),B=d(29),D=d(75),w=d(123),J=d(34),G=d(42),M=d(38),N=d(76),R=d(54),C=d(74),O=d(59),S=d(88);d(423);var T=d(51),ca=d(425);class L{constructor(aa,ja,I,sa,ka){this.ELd=aa;this.h9h=I;this.g9h=ja;this.NYh=sa;this.l3h=ka}Tel(aa,ja){ja.Uel(aa,this.ELd,this.g9h,this.h9h,this.NYh,this.l3h)}}Object(K.a)(L,"MathPropertyObject",null,[]);var da=d(32),Z=d(109);d.d(U,"Box4PasteSteward",function(){return fa});class fa extends x.a{constructor(aa,ja,I,sa,ka,Ma,Ea,ma=null,va=null){super(aa,
Ea,ma,va);this.Ao=this.O2=null;this.Jqa=!1;this.J4a=null;this.Jpb=-1;this.A5a=0;this.JPd=new v.a;Z.a(4223754,307,O.OutlineElementReader.ih(aa));this.N4a=ja;this.N4a.Ktb(this);this.DF=I;this.DF.Ktb(this);this.zGd=sa;this.fp=ka;this.a2h=Ma;this.QLd=N.ListReader.Hk(this.zb);fa.zOj();fa.nOj();fa.dPj()}get s9(){return this.O2||(this.O2=e.a.instance.qb("Box4.IInternalLinkManager"))}get hSa(){return this.Ao}get S8a(){return this.QLd&&!this.DF.sda}get g9a(){return 0<this.A5a}get Jv(){return this.zGd}get jq(){return this.fp}get h5c(){return this.a2h}get vqi(){return!!r.AFrameworkApplication.fa&&
r.AFrameworkApplication.fa.ka("Box4EnsurePasteFormatOnTextIsEnabled")}reset(){super.reset();this.Ao=this.s$d(!1)}uUd(aa){Z.a(4223762,307,O.OutlineElementReader.ih(this.zb)||C.OutlineReader.ku(this.zb));this.eIb(!1);var ja=new da.GraphIterator;ja.Tc(this.zb);aa=x.a.Wh.nda(this.zb,this.cUa(aa));this.hKc(ja,!1);Z.a(4223763,307,aa===this.zb.currentNode);Z.a(4223764,307,J.ParagraphReader.ae(aa));-1!==this.Ao.yE&&fa.paragraphEditor.nK(aa,this.Ao.yE);if(fa.paragraphEditor.Jv&&!this.vZ.lBh){if(this.Ao.textIndent){let ka;
({unit:sa,returnValue:ka}=fa.Qkd(this.Ao.textIndent));var I=!1;if(ka||!N.ListReader.$9a){0>ka&&(I=!0,ka*=-1);var sa=fa.X_d(ka,sa);I||fa.paragraphEditor.Jv.hlb(aa,sa)}}!this.Ao.marginLeft||fa.cM.A2c||N.ListReader.Hk(ja)||({unit:ja,returnValue:I}=fa.Qkd(this.Ao.marginLeft),ja=fa.X_d(I,ja),fa.paragraphEditor.Jv.psd(aa,1,ja))}(fa.Xf.ig&&fa.Xf.jz||M.a.instance.ga(45)&&B.App.hE.rQb)&&aa.setValue(G.a.sbc,!0);this.Ao.lineSpacing&&fa.paragraphEditor.R1(aa,this.Ao.lineSpacing);this.Ao.paragraph=aa;this.Jqa=
!0}hKc(aa,ja){Z.a(8128518,307,!ja);this.UM&&!M.a.instance.ga(76)&&(0<this.UM&&this.Jv.JPc(aa,this.UM),0>this.UM&&this.Jv.pjb(aa,this.UM,0));M.a.instance.ga(29)&&(this.zb.Tc(aa),R.OutlineElementNavigator.yi(this.zb));!this.S8a||2===B.App.mode&&this.h5c.ppc?aa&&this.jq.d_e(aa,this.g9a):this.jq.Fxh(aa);this.UM=0}Rwd(aa){this.JPd.add(aa)}YYd(){this.UM=0}m1(aa,ja=null){Z.a(4223772,307,J.ParagraphReader.ql(this.zb));const I=this.zb.currentNode;this.Ao.A7e(I);if(!this.vZ.N7e(ja)){r.AFrameworkApplication.uk("Microsoft.Office.Web.Common.Flighting.IBox4EnsurePasteFormatOnTextSettings");
var sa=I.Ta.last,ka=T.a.YRa(I),Ma=!1;this.Jqa&&(sa.formatting=this.Ao.u$a.fe(sa),M.a.instance.ga(57)&&I.jv(),this.Jqa=!1,Ma=!0);aa=this.vZ.ife(aa,ja);this.vZ.rpa(this.zb.currentNode,this.Ao.nga,ja);this.characterPropertiesEditor.replaceTextRange(ka,aa);this.vqi&&Ma&&(aa=I.Ewb(ka.Sa),aa.formatting=this.Ao.u$a.fe(aa));M.a.instance.ga(2)}}ooa(aa){this.vZ.k2c&&this.vZ.m1c(aa)?(this.MA(),this.NA(aa)):(Z.a(4223773,307,J.ParagraphReader.ql(this.zb)),aa=T.a.YRa(this.zb.currentNode),this.characterPropertiesEditor.a_c(aa,
ja=>new ca.a(ja,ca.a.sPc),D.AParagraphNode.w_))}u_a(){}noa(aa){this.N4a.noa(aa)}moa(aa){this.Ao=aa;this.Jqa=!0}Gxa(aa){Z.a(4223774,307,J.ParagraphReader.ql(this.zb));Z.a(4223775,307,!this.J4a);Z.a(4223776,307,0>this.Jpb);this.J4a=aa;this.Jpb=J.ParagraphReader.textLength(this.zb.currentNode)}Fxa(){Z.a(4223777,307,J.ParagraphReader.ql(this.zb));Z.a(4223778,307,!!this.J4a);Z.a(4223779,307,0<=this.Jpb);let aa=T.a.createTextRange(this.zb.currentNode,this.Jpb,J.ParagraphReader.textLength(this.zb.currentNode)),
ja="",I="";this.s9&&({hnh:ja,q8i:I}=this.s9.mKh(w.HyperlinkReader.aFa(this.J4a),!0)).returnValue&&(this.J4a=ja,I&&(this.characterPropertiesEditor.replaceTextRange(aa,I),aa=T.a.createTextRange(this.zb.currentNode,this.Jpb,J.ParagraphReader.textLength(this.zb.currentNode))));fa.hyperlinkEditor.Sja(aa,this.J4a,!1);this.Jqa=!0;this.J4a=null;this.Jpb=-1}NA(aa){this.uUd(aa);this.Ao.exd(this.zb.currentNode);aa&&"P"===aa.TU.j$b&&fa.paragraphEditor.QLa(this.zb.currentNode,this.Ao.Gkd);this.vZ.rpa(this.zb.currentNode,
this.Ao.nga,aa,this.Ao.marginLeft,this.Ao.textIndent)}MA(){Z.a(4223808,307,J.ParagraphReader.ql(this.zb));fa.hyperlinkEditor.PZi(this.zb.currentNode);R.OutlineElementNavigator.Te(this.zb)}q_a(){}p_a(){}Lxa(){}YJa(){}roa(){Z.a(4223809,307,O.OutlineElementReader.ih(this.zb)||C.OutlineReader.ku(this.zb));let aa=!1;this.g9a||(aa=this.S8a||!0);aa||(this.UM+=1);this.A5a++}poa(){this.A5a--;let aa=!1;this.g9a||(aa=this.S8a||!0);aa||--this.UM}Kxa(aa){Z.a(4223810,307,O.OutlineElementReader.ih(this.zb)||C.OutlineReader.ku(this.zb));
Z.a(4223811,307,0!==aa.listStyleType);this.jq.INb(this.d9j(aa))}qoa(){Z.a(4223813,307,O.OutlineElementReader.ih(this.zb));r.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");if(fa.cM.A2c&&N.ListReader.Hk(this.zb)){const aa=J.ParagraphReader.iyb(this.zb.currentNode),ja=this.h5c.R8f(this.zb);this.jq.tsd(ja,aa,null)}}r_a(aa){this.N4a.r_a(aa)}zY(aa){this.DF.zY(aa)}wY(){this.DF.wY()}yY(aa){this.DF.yY(aa)}xY(){this.DF.xY()}vY(aa){this.DF.vY(aa)}uY(){this.DF.uY()}static get paragraphEditor(){return fa.qx||
(fa.qx=e.a.instance.resolve("Box4.IParagraphEditor"))}static get hyperlinkEditor(){return fa.In||(fa.In=e.a.instance.resolve("Box4.IHyperlinkEditor"))}static get Xf(){return fa.hd||(fa.hd=e.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get uPb(){return fa.Xtf}static get cM(){return fa.UK||(fa.UK=e.a.instance.qb("Box4.List.ListSettings"))}static zOj(){const aa=M.a.instance.ga(61);fa.gKa[1]=aa?S.StyleReader.wzd:S.StyleReader.kPb;fa.gKa[2]=aa?S.StyleReader.xzd:S.StyleReader.lPb;
fa.gKa[3]=aa?S.StyleReader.yzd:S.StyleReader.mPb;fa.gKa[4]=aa?S.StyleReader.zzd:S.StyleReader.nPb;fa.gKa[5]=aa?S.StyleReader.Azd:S.StyleReader.oPb;fa.gKa[6]=aa?S.StyleReader.Bzd:S.StyleReader.pPb;fa.gKa[7]=aa?null:S.StyleReader.Luc}static nOj(){fa.Jea.unspecified=0;fa.Jea.defaultUnordered=1;fa.Jea.defaultOrdered=1;fa.Jea.none=0;fa.Jea.disc=1;fa.Jea.circle=2;fa.Jea.square=3;fa.Jea.decimal=1;fa.Jea.lowerAlpha=2;fa.Jea.lowerRoman=3;fa.Jea.upperAlpha=4;fa.Jea.upperRoman=5}static dPj(){fa.Xtf=S.StyleReader.Zyb()}static U8a(aa){return m.a.substring(aa,
4,6)+m.a.substring(aa,2,4)+m.a.substring(aa,0,2)}static Qkd(aa){let ja,I;ja=0;const sa=aa.length;I=parseFloat(m.a.substring(aa,0,sa-2));aa=m.a.substr(aa,sa-2,2);switch(aa){case "in":ja=3;break;case "px":ja=7;break;case "cm":ja=1;break;case "pt":ja=5;break;default:h.ULS.sendTraceTag(8208450,307,50,"Pasted DOM with unrecognized css length unit {0}, will default to UnitType.None and value 0",aa),I=0}return{returnValue:I,unit:ja}}static X_d(aa,ja){let I=0;switch(ja){case 3:I=n.a.Aua(aa);break;case 7:I=
z.a.qga(aa,0);break;case 1:I=n.a.hYd(aa);break;case 5:I=n.a.Aua(n.a.Gld(aa));break;default:h.ULS.sendTraceTag(8208451,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",aa,ja)}return I}}fa.qx=null;fa.In=null;fa.hd=null;fa.gKa=Array(8);fa.Jea={};fa.Xtf=null;fa.UK=null;Object(K.a)(fa,"Box4PasteSteward",x.a,[])},265:function(K,U,d){d.r(U);K=d(0);d(392);var h=d(941);d(942);var e=d(27),r=d(99),m=d(56),n=d(37);class z{}Object(K.a)(z,"RibbonUpsellButtonCreator",
null,[]);class v extends Sys.EventArgs{constructor(ca){super();this.FUl=ca}}Object(K.a)(v,"TopRowCreatedEventArgs",Sys.EventArgs,[]);d(393);var x=d(368);d(185);var B=d(131);d(315);d(78);var D=d(239),w=d(168),J=d(67);class G{constructor(ca,L){this.cluster=ca;this.VOc=L}}Object(K.a)(G,"ImageInfo",null,[]);class M{constructor(ca,L,da,Z,fa,aa,ja,I,sa,ka,Ma,Ea,ma,va,Ca=null,oa=null){this.id=ca;this.gIc=L;this.kIc=da;this.jIc=Z;this.iIc=fa;this.hIc=aa;this.mIc=ja;this.HRd=I;this.TOb=new G(sa,ka);this.Aud=
new G(Ma,Ea);this.Ugd=new G(ma,va);Ca&&oa&&new G(Ca,oa)}}Object(K.a)(M,"PeoplesWellBaseSettings",null,[]);class N{constructor(){this.SEf=null}}Object(K.a)(N,"BreadcrumbControls",null,[]);class R{constructor(ca){this.id=ca}}new R("DocChat",void 0,void 0,void 0,void 0,"WACSkypeDocChat_16x16x32","WACSkypeDocChatUnread_16x16x32");Object(K.a)(R,"ChatButtonSettings",null,[]);class C{constructor(){this.id=this.image=this.label=this.command=null}}Object(K.a)(C,"SkypeButtonInfo",null,[]);class O{constructor(){this.g$e=
this.OIh=this.xWd=null}}Object(K.a)(O,"TopRowControls",null,[]);var S=d(205);d(47);d.d(U,"CuiHelper",function(){return T});class T{constructor(ca,L,da=null,Z,fa=null){this.fia=ca;this.v_h=S.a.Wvk(L,fa);this.v_h.push(CommonUIStrings);h.b();T.Ca=void 0===da||null===da?e.AFrameworkApplication.Ra:da}static get nIj(){return T.Mqa||(T.Mqa=m.a.instance.resolve("Common.App.Header.HeaderEventSource"))}static Mnj(ca,L,da){return new M(T.EOe,n.a.yCi,n.a.EZd,n.a.BCi,n.a.ACi,n.a.zCi,n.a.CCi,n.a.G8a,ca,"per_SingleCollabUserGlyph_16x16x32",
L,"per_SingleCollabUserGlyph_32x32x32",da,"per_MoreUsersGlyph_16x16x32",null,null)}static DVi(ca){ca.xWd&&(T.CVi(ca.xWd),ca.xWd=null);ca.OIh&&(T.BVi(),ca.OIh=null);ca.g$e&&(T.EVi(ca.g$e),ca.g$e=null);T.nIj.BYk();let L;({V9b:L}=x.a.DQb(!1)).returnValue&&r.a.$Ca(L)}static G$b(){e.AFrameworkApplication.Ra.processAction(n.a.G$b,2)}static BVi(){e.AFrameworkApplication.FQc&&w.EventHandlerManager.instance.Sxd(e.AFrameworkApplication.FQc)}static addButton(ca,L,da,Z,fa,aa,ja,I){L=B.a(ca,L,da,Z,null,null,null,
aa,null,null,void 0,void 0,fa);(ca=I.hostControl(ca,L,aa))&&ja.appendChild(ca);return ca}static eOc(ca,L,da){let Z;Z=document.createElement("span");Z.className="BreadcrumbItem";Z.id=L;Z.innerText=da;Z.setAttribute("dir","auto");ca.appendChild(Z);return Z}static CVi(ca){ca.SEf&&w.EventHandlerManager.instance.$Ll(ca.SEf)}static EVi(ca){D.a.instance.vMh(J.a.click,ca,T.PHk,!0)}static PHk(){e.AFrameworkApplication.d$e?(e.AFrameworkApplication.Aa.muc(e.AFrameworkApplication.Aa.ob.dbg()),e.AFrameworkApplication.d$e=
!1):window.top.location=e.AFrameworkApplication.signInUrl;return!0}static r3c(){return!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.ob.r3c}}T.Mqa=null;T.Sql="ShareServerWhite_20x20x32";T.p6d="ExternalHeaderFullTopBars";T.sIj="HeaderTopBars";T.yWd="BreadcrumbBrand";T.zWd="BreadcrumbFolder";T.AWd="BreadcrumbTitle";T.O1f="FolderSeparator";T.I5e="sbTellMe";T.K2e="TellMe-SearchBox";T.Jch="btnOpenInClient";T.C0e="btnFileSharing";T.iyl="BasicChat";T.zpd="btnReplyWithChanges";T.r_f="jbtnGiveFeedback";
T.EOe="PeoplesWellControl";T.OVf="EditableBreadcrumbItem";T.Ca=null;T.B8e=50;T.lIj=null;Object(K.a)(T,"CuiHelper",null,[637])},299:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}h.alt="Alt";h.iconColor="IconColor";h.Qzb="Image16by16Class";h.GKj="Image30by30Class";h.wFa="Image32by32Class";h.dhe="Image48by48Class";h.labelText="LabelText";h.q7j="LabelTextUserGeneratedPlaceholderReplacements";h.visible="Visible";h.mV="SourceControlId";h.customTooltip="CustomTooltip";h.Icon="Icon";h.IconSet=
"IconSet";h.gmh="ReduxActions";Object(K.a)(h,"SharedControlCommandProperties",null,[])},300:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.data=this.landingTab=null}}Object(K.a)(h,"LaunchData",null,[])},301:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);d=d(77);class h extends d.a{constructor(e){super();this._element=null;this.element=e}get element(){return this._element}set element(e){this._element=e}get visible(){return"visible"===this.element.style.visibility}set visible(e){this.element.style.visibility=
e?"visible":"hidden"}get rtl(){return"rtl"===this.element.dir.toLowerCase()}set rtl(e){this.element.dir=e?"rtl":"ltr"}get zIndex(){return this.element.style.zIndex}set zIndex(e){this.element.style.zIndex=String(e)}dispose(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;super.dispose()}createElement(e){return this.element.ownerDocument.createElement(e)}kF(){return!0}static p1d(e){return"prControl"+(e?"Rtl":"")}}Object(K.a)(h,"BasePresenceControl",
d.a,[107,323])},302:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e,r){super();this.type=e;this.Bj=r}}h.zw="InteractivityChanged";Object(K.a)(h,"InteractivityChangedEventArgs",Sys.EventArgs,[])},304:function(K,U,d){K=d(0);var h=d(56),e=d(393),r=d(602),m=d(129),n=d(392),z=d(99),v=d(664),x=d(406),B=d(47),D=d(226),w=d(55),J=d(1144),G=d(27),M=d(162);class N{constructor(ma,va){this.cp=ma;this.distance=va}}Object(K.a)(N,"CpDistanceResult",null,[]);class R{constructor(){this.pFa=
0;this.zt=null;this.Lvb=this.Mvb=this.kSa=this.DDa=0;this.Dvc=this.GGa=this.oMa=null;this.mCb=this.Hda=this.Wfd=0;this.I$e=this.w3d=!1;this.R3b=this.uEa=this.Wja=this.F3=this.gpc=0;this.oRh=this.Z0f=this.yuc=this.ZOb=!1;this.result=null;this.e3b=this.l0d=this.W8a=this.A8=this.jda=0;this.Cla=this.$Nc=!1;this.pP=null}}Object(K.a)(R,"CpFromPointState",null,[]);class C{constructor(ma,va,Ca,oa,Da,ta,ha,Ha=null,bb=0,Na=null){this.rDa=this.cp=this.Sa=0;this.d3b=-1;this.deltaX=this.gOf=Number.MAX_VALUE;this.g_a=
0;this.FWa=-Number.MAX_VALUE;this.DWa=-Number.MAX_VALUE;this.O6d=this.F5b=this.Jtb=this.wLe=!1;this.element=ma;this.point=Ca;this.fdb=oa;this.sUe=Da;this.rUe=ta;this.Ukg=ha;this.Aja=Ha;this.i8a=bb;this.originalText=va;this.cKa=this.originalText.length;this.Mb=this.cKa-1;this.jbc=4===this.fdb||3===this.fdb;this.pP=Na}}Object(K.a)(C,"CpFromPointElementState",null,[]);var O=d(44);class S{constructor(ma,va,Ca){this.CpBegin=ma;this.CpEnd=va;this.IsEop=Ca}}Object(K.a)(S,"CpFromPointResult",null,[]);class T{constructor(ma,
va,Ca){this.LineBounds=ma;this.ClientRects=va;this.IsRangeMultipleLines=Ca}}Object(K.a)(T,"LineCoordinateResult",null,[]);class ca{constructor(ma,va,Ca,oa,Da,ta){this.uob={};this.nVb=!0;this.iug=this.gEc=this.BGc=this.Lrb=this.z6a=null;this.qd=ma;this.KZ=va;this.X0h=Ca?Ca.ka("TextFidelityLayoutFixesEnabled"):!1;this.c0h=Ca?Ca.ka("HyperlinkFirstCharacterSelectionFixIsEnabled"):!1;this.O_h=Ca?Ca.ka("CharacterBeforeEOPSelectionFixIsEnabled"):!1;(this.kPa=oa)||n.ULS.sendTraceTag(21051272,324,10,"_measureBoundsUsingSpansStrategy is null");
this.YP=Da;this.e9h=ta}pea(){this.nVb=!1}X8a(ma,va,Ca,oa=null){this.iug=[];var Da=ma.R6;if(!ma.textLength)return this.XAj(ma,va,Ca,oa);oa=Object.assign(new R,{oMa:Array(Da.length),GGa:Array(Da.length),Dvc:Array(Da.length),w3d:!0,zt:Da,pP:oa});for(var ta=0;ta<=Da.length;ta++){oa.DDa=0;oa.kSa=0;oa.Mvb=0;oa.Lvb=0;oa.pFa=0;oa.ZOb=!1;oa.yuc=!1;if(ta<Da.length){if(!this.Q4i(ma,oa,ta))continue}else{oa.mCb=ta-1;break}if(this.s5i(va,oa,ta))break}if(oa.I$e&&oa.gpc<va.y&&va.y<oa.F3)return this.agl(ma,va,Ca,
oa);oa.result=null;oa.jda=-1;oa.A8=oa.uEa;oa.W8a=Number.MAX_VALUE;oa.l0d=0;oa.e3b=0;oa.$Nc=!1;oa.Cla=!1;for(Da=oa.Hda;Da<=oa.mCb;Da++)if(ta=this.q5i(ma,va,Ca,Da,oa))return ta;return this.Fzj(ma,va,Ca,oa)}XAj(ma,va,Ca,oa){const Da=ma.isRtl;if(!Ca)return new S(0,0,!1);ma=this.mRa(ma,oa);return!Da&&va.x>ma.x+ma.width/2||Da&&va.x<ma.x+ma.width/2?new S(-1,-1,!0):new S(0,0,!0)}Q4i(ma,va,Ca){if(this.xzi(va.zt[Ca].htmlElement)||va.zt[Ca].DAb)return!1;var oa=this.vWd(va.zt[Ca],va.pP);va.oMa[Ca]=oa;var Da=
oa.y;let ta=oa.y+oa.height;va.zt[Ca].Nng||va.zt[Ca].Cla||va.zt[Ca].t4&&!va.zt[Ca].OVa?({YQf:Da,XQf:ta}=this.jAf(va.zt[Ca].htmlElement,Da,ta),va.DDa=va.Mvb=Da,va.kSa=va.Lvb=ta,va.GGa[Ca]=ta-Da,va.Dvc[Ca]=va.GGa[Ca]):(this.zul(ma,Ca)?(oa=this.$t(ma,va.R3b,void 0,void 0,void 0,va.pP),Da=this.C7b(va.zt[Ca].htmlElement),ma=1<Da?this.$t(ma,va.R3b+Da-1,void 0,void 0,void 0,va.pP):oa,va.DDa=Da=oa.y,va.kSa=oa.y+oa.height,va.Mvb=ma.y,va.Lvb=ma.y+ma.height,va.GGa[Ca]=oa.height,va.Dvc[Ca]=oa.height):(ma=this.e9h.Ouj(va.zt[Ca].htmlElement),
va.pFa=this.kPa.Tsj(va.zt[Ca].htmlElement,ma),{YQf:Da,XQf:ta}=this.jAf(va.zt[Ca].htmlElement,Da,ta),va.oRh=1<Math.abs(oa.width-this.wij(va.zt[Ca].htmlElement))||1<Math.abs(oa.height-this.vij(va.zt[Ca].htmlElement)),va.oRh&&this.KZ.instance&&(ma=Math.round(ma*this.KZ.instance.G3),va.pFa=Math.round(va.pFa*this.KZ.instance.G3)),va.DDa=Da-va.pFa,va.kSa=Da+ma+va.pFa,va.Mvb=ta-ma-va.pFa,va.Lvb=ta+va.pFa,va.GGa[Ca]=ma+2*va.pFa,va.Dvc[Ca]=ma),va.Wfd=Math.max(va.Wfd,va.GGa[Ca]));va.Z0f||(va.F3=va.DDa,va.Wja=
va.kSa,va.Z0f=!0);va.yuc=va.Mvb>(va.DDa+va.kSa)/2;Ca=ca.Ota(va.Wfd);this.X0h&&(Ca=this.PTd(va,Ca));va.ZOb=this.zTj(va.F3,va.Wja,Da,Ca);return!0}zTj(ma,va,Ca,oa){return ma===va?Ca>va:Ca>=va-oa}PTd(ma,va){return va=this.kPa.PTd(!!ma.pP&&ma.pP.BBb,ma.DDa,ma.kSa,va)}s5i(ma,va,Ca){if(va.ZOb||va.yuc){va.ZOb?va.mCb=Ca-1:(va.F3=Math.min(va.F3,va.DDa),va.Wja=Math.max(va.Wja,va.kSa),va.mCb=Ca);Array.add(this.iug,va.Wja);if(ma.y<=va.Wja)return!0;va.gpc=va.Wja;va.F3=va.Mvb;va.Wja=va.Lvb;va.Hda=Ca;va.uEa=va.R3b;
va.w3d=va.ZOb;va.I$e=va.yuc;va.Wfd=va.zt[Ca].Cla||va.zt[Ca].t4&&!va.zt[Ca].OVa?0:va.GGa[Ca]}else va.F3=Math.min(va.F3,va.DDa),va.Wja=Math.max(va.Wja,va.Lvb);ma.y>va.gpc&&ma.y<va.F3&&!va.zt[va.Hda].Cla&&!va.zt[va.Hda].t4&&va.F3-va.gpc<va.Dvc[va.Hda]/2&&(va.F3=ma.y);va.R3b+=this.DQi(va.zt[Ca]);return!1}agl(ma,va,Ca,oa){if(oa.zt[oa.Hda].t4)return Ca?new S(oa.uEa,oa.uEa,!1):new S(oa.uEa,oa.uEa+1,!1);if(Ca=this.fOf(oa.zt[oa.Hda].htmlElement,oa.oMa[oa.Hda],va,oa.w3d?4:3,oa.gpc,oa.F3,oa.GGa[oa.Hda],ma.isRtl,
ma.Aja,oa.uEa,oa.pP))return Ca=oa.uEa+Ca.cp,Ca=this.fAf(ma,va,Ca,oa.Hda,oa.uEa,void 0,void 0,oa.pP),new S(Ca,Ca,!1);this.qd.Xb(v.a.cyk,{["Reason"]:r.a.g_f});return null}q5i(ma,va,Ca,oa,Da){if(Da.zt[oa].DAb)return null;const ta=Da.zt[oa].t4,ha=Da.zt[oa].Cla;let Ha=!1;if(ta){if(Da.oMa[oa].y>=Da.F3&&(Da.zt[oa].OVa||Da.zt[oa].c2c)){var bb=Da.oMa[oa];const Na=bb.x+bb.width/2,Ia=Math.abs(va.x-Na);if(Ia<Da.W8a||!bb.width&&Ia===Da.W8a)Da.$Nc=!0,Da.W8a=Ia,Da.Cla=!1,Da.jda=!Ca||!ma.isRtl&&va.x<Na||ma.isRtl&&
va.x>Na?Da.A8:Da.A8+1}if(!Da.zt[oa].OVa&&!Da.zt[oa].c2c){bb=Da.oMa[oa];if(!Ca&&va.x>bb.x&&va.x<bb.x+bb.width&&!Da.zt[oa].bYj)return new S(Da.A8,Da.A8+1,!1);Da.result=va.x<bb.x+bb.width/2?new N(ma.isRtl?1:0,Math.max(bb.x-va.x,0)):new N(ma.isRtl?0:1,Math.max(va.x-bb.x-bb.width,0))}}else ha?(ma=this.mRa(ma,Da.pP),Ha=1>ma.width,Da.result=new N(-1,x.a.pQc(va,ma))):Da.result=this.fOf(Da.zt[oa].htmlElement,Da.oMa[oa],va,oa===Da.Hda&&Da.I$e?1:oa===Da.mCb&&!Da.ZOb&&Da.yuc?0:2,Da.F3,Da.Wja,Da.GGa[oa],ma.isRtl,
ma.Aja,Da.A8,Da.pP);Da.result&&(Da.result.distance<Da.W8a||Ha&&Da.result.distance<=Da.W8a+1)&&(Da.jda=Da.result.cp+Da.A8,Da.Cla=ha,Da.W8a=Da.result.distance,Da.l0d=Da.A8,Da.e3b=oa,Da.$Nc=ta);Da.A8=ta?Da.A8+1:Da.A8+this.C7b(Da.zt[oa].htmlElement);return null}Fzj(ma,va,Ca,oa){if(-1===oa.jda)return this.qd.Xb(v.a.TQj,{["Reason"]:r.a.b_f}),null;const Da=ma.textLength;if(oa.Cla){if(Ca)return Ca=oa.oMa[oa.oMa.length-1],!ma.isRtl&&va.x<Ca.x+Ca.width/2||ma.isRtl&&va.x>Ca.x+Ca.width/2?new S(Da,Da,!1):new S(-1,
-1,!0);oa.jda=Da}oa.jda>Da&&(oa.jda=Da);!oa.$Nc&&oa.jda<Da&&(oa.jda=this.fAf(ma,va,oa.jda,oa.e3b,oa.l0d,oa.e3b===oa.Hda,oa.e3b===oa.mCb,oa.pP));return new S(oa.jda,oa.jda,!1)}fAf(ma,va,Ca,oa,Da,ta=!1,ha=!1,Ha=null){const bb=ma.isRtl,Na=ma.characterData,Ia=ma.textLength;Ca=B.a.Gx(Na,Ca)?Ca-1:Ca;const Qa=B.a.VXj(Na,Ca)?Ca+2:Ca+1,qa=this.$t(ma,Ca,void 0,void 0,void 0,Ha);va=va.x>qa.x+qa.width/2;if(Ca-Da===this.C7b(ma.R6[oa].htmlElement)&&ma.R6.length>oa+1&&ma.R6[oa+1].t4)return Ca;if(ma.R6[oa].KUj)return++Ca;
if(ma.R6[oa].JUj)return Ca;let Wa=null,Hb=!1;0<Ca&&(Wa=this.$t(ma,B.a.Gx(Na,Ca-1)?Ca-2:Ca-1,void 0,void 0,void 0,Ha),0<Ca-Da?Hb=Wa.y+Wa.height/2>qa.y:ta||ma.R6[oa-1].t4||(Hb=!0));ta=null;let jc=!1;if(this.O_h?Qa<=Ia:Qa<Ia)ta=this.$t(ma,Qa,void 0,void 0,void 0,Ha),Qa-Da<this.C7b(ma.R6[oa].htmlElement)?jc=ta.y+ta.height/2<qa.y+qa.height:ha||ma.R6[oa+1].OVa||ma.R6[oa+1].c2c||(jc=!0);Hb&&jc?Wa.x<=qa.x&&ta.x>=qa.x?va&&(Ca=Qa):Wa.x>=qa.x&&ta.x<=qa.x?va||(Ca=Qa):Wa.x<ta.x?va||(Ca=Qa):ta.x<Wa.x&&va&&(Ca=
Qa):Hb||(jc?ta.x>=qa.x&&va?Ca=Qa:ta.x<=qa.x&&!va&&(Ca=Qa):!B.a.uz(Na.charCodeAt(Ca))&&(!bb&&va||bb&&!va)&&(Ca=Qa));return Ca}tij(ma){return z.a.Fv(ma)}vij(ma){return ma.offsetHeight}wij(ma){return ma.offsetWidth}xzi(ma){return!ma.parentNode}C7b(ma){return z.a.U$a(ma)}zul(ma,va){va=ma.R6[va];if(va.t4)return!1;ma=ma.htmlElement;Sys.UI.DomElement.containsCssClass(ma,"Paragraph")||(ma=ma.firstChild);return""!==ma.style.lineHeight&&ma.style.lineHeight!==va.htmlElement.style.lineHeight}DQi(ma){return ma.t4?
1:z.a.U$a(ma.htmlElement)}jAf(ma,va,Ca){Ca=new Sys.UI.Bounds(0,va,0,Ca-va);this.pji(ma,[Ca]);va=Ca.y;Ca=Ca.y+Ca.height;return{YQf:va,XQf:Ca}}pji(ma,va){if(ma=D.a.rt(ma)){var Ca=ma.borderTopWidth,oa=Ca.indexOf("px");if(-1<oa)for(Ca=parseInt(Ca.substr(0,oa)),oa=0;oa<va.length;oa++)va[oa].y+=Ca,va[oa].height-=Ca;ma=ma.borderBottomWidth;Ca=ma.indexOf("px");if(-1<Ca)for(ma=parseInt(ma.substr(0,Ca)),Ca=0;Ca<va.length;Ca++)va[Ca].height-=ma}}fOf(ma,va,Ca,oa,Da,ta,ha,Ha,bb,Na,Ia=null){if(this.HWj(ma))return this.qd.Xb(v.a.M5i,
{["Reason"]:r.a.f_f}),new N(0,x.a.pQc(Ca,va));if(this.GWj(ma))return this.qd.Xb(v.a.USc,{["Reason"]:r.a.USc}),null;ma=this.sKi(ma,Ca,oa,Da,ta,ha,bb,Na,Ia);if(1>=ma.cKa)return new N(0,x.a.pQc(ma.point,va));this.qcl(ma);do{if(ma.Sa>ma.Mb)return this.vMb(),this.qd.Xb(v.a.byk,{["Reason"]:r.a.N5g}),null;this.Zwk(ma)}while(!ma.wLe);for(ma.rDa=!Ha&&ma.g_a<ma.point.x||Ha&&ma.g_a>ma.point.x?ma.Mb:ma.Sa;!ma.Jtb&&!this.Api(ma););if(ma.O6d)for(ma.cp=ma.Sa;ma.cp<=ma.Mb&&!this.W8j(ma);ma.cp++);return this.tAi(ma)}sKi(ma,
va,Ca,oa,Da,ta,ha,Ha,bb=null){return new C(ma,this.tij(ma),va,Ca,oa,Da,ta,ha,Ha,bb)}HWj(ma){return!ma.firstChild}GWj(ma){return 3!==ma.firstChild.nodeType}qcl(ma){let va;if(0===ma.fdb){ma.FWa=ma.sUe;ma.DWa=ma.rUe;for(var Ca=40;Ca<ma.cKa;Ca+=40)if(va=this.lRa(ma.element,ma.originalText,Ca,ma.Aja,ma.i8a,void 0,void 0,ma.pP),va.height&&va.y+va.height/2>ma.DWa){ma.Mb=Ca;break}}else if(1===ma.fdb)for(ma.Mb=ma.cKa-1,ma.FWa=ma.sUe,ma.DWa=ma.rUe,Ca=ma.cKa-40;0<=Ca;Ca-=40){if(va=this.lRa(ma.element,ma.originalText,
Ca,ma.Aja,ma.i8a,void 0,void 0,ma.pP),va.height&&va.y+va.height/2<ma.FWa){ma.Sa=Ca;break}}else if(2===ma.fdb)ma.Mb=ma.cKa-1,ma.FWa=ma.sUe,ma.DWa=ma.rUe;else if(3===ma.fdb||4===ma.fdb)for(Ca=0;Ca<ma.cKa+40;Ca+=40){const oa=Ca<ma.cKa?Ca:ma.cKa-1;va=this.lRa(ma.element,ma.originalText,oa,ma.Aja,ma.i8a,void 0,void 0,ma.pP);if(va.height&&(va.y+va.height<ma.point.y&&(ma.Sa=oa),va.y>ma.point.y)){ma.Mb=oa;break}}}Zwk(ma){const va=Math.floor((ma.Sa+ma.Mb)/2);ma.cp=va;let Ca=this.lRa(ma.element,ma.originalText,
ma.cp,ma.Aja,ma.i8a,void 0,void 0,ma.pP);for(;ma.cp<ma.Mb&&!Ca.height;)ma.cp++,Ca=this.lRa(ma.element,ma.originalText,ma.cp,ma.Aja,ma.i8a,void 0,void 0,ma.pP);ma.cp!==ma.Mb||Ca.height?!ma.jbc&&Ca.y+Ca.height/2<ma.FWa||ma.jbc&&Ca.y+ma.Ukg<ma.point.y?ma.Sa=ma.cp+1:!ma.jbc&&Ca.y+Ca.height/2>ma.DWa||ma.jbc&&Ca.y>ma.point.y?ma.Mb=ma.cp-1:Ca.x<=ma.point.x&&Ca.x+Ca.width>=ma.point.x?(ma.Jtb=!0,ma.F5b=!0,ma.wLe=!0):(ma.wLe=!0,ma.g_a=Ca.x+Ca.width/2,ma.d3b=ma.cp,ma.deltaX=Math.abs(ma.g_a-ma.point.x),ma.jbc&&
(ma.FWa=Ca.y,ma.DWa=Ca.y+ma.Ukg)):ma.Mb=va-1}Api(ma){var va=Math.abs(ma.rDa-ma.cp);if(va<ma.gOf)ma.gOf=va;else return ma.Jtb=!0,ma.O6d=!0;va=Math.floor((ma.cp+ma.rDa)/2);va===ma.cp&&(va=ma.rDa);var Ca=this.lRa(ma.element,ma.originalText,va,ma.Aja,ma.i8a,void 0,void 0,ma.pP);if(0<Ca.height&&Ca.y+Ca.height/2<=ma.FWa||Ca.y+Ca.height/2>=ma.DWa)ma.rDa=ma.cp<ma.rDa?va-1:va+1;else if(Ca.x<=ma.point.x&&Ca.x+Ca.width>=ma.point.x)ma.cp=va,ma.F5b=!0,ma.Jtb=!0;else{Ca=Ca.x+Ca.width/2;const oa=Math.abs(ma.g_a-
Ca),Da=Math.abs(ma.g_a-ma.point.x),ta=Math.abs(Ca-ma.point.x);ta<ma.deltaX&&(ma.d3b=va,ma.deltaX=ta);oa+ta===Da?(ma.cp=va,ma.g_a=Ca):Da+ta===oa?(ma.rDa=ma.cp<ma.rDa?ma.cp+1:ma.cp-1,ma.cp=va,ma.g_a=Ca):oa+Da===ta&&(ma.Jtb=!0,ma.O6d=!0)}ma.rDa===ma.cp&&(ma.Jtb=!0);return!1}W8j(ma){var va=this.lRa(ma.element,ma.originalText,ma.cp,ma.Aja,ma.i8a,void 0,void 0,ma.pP);if(0<va.height&&va.y+va.height/2<=ma.FWa||va.y+va.height/2>=ma.DWa)return!1;if(va.x<=ma.point.x&&va.x+va.width>=ma.point.x)return ma.F5b=
!0;va=Math.abs(va.x+va.width/2-ma.point.x);va<ma.deltaX&&(ma.d3b=ma.cp,ma.deltaX=va);return!1}tAi(ma){if(!ma.F5b&&-1===ma.d3b)return this.vMb(),this.qd.Xb(v.a.dyk,{["Reason"]:r.a.c_f}),null;ma.F5b?ma.deltaX=0:ma.cp=ma.d3b;B.a.Gx(ma.originalText,ma.cp)&&ma.cp--;this.vMb();return new N(ma.cp,ma.deltaX)}$t(ma,va,Ca=!1,oa=!1,Da=!1,ta=null){let ha;ma||n.ULS.sendTraceTag(6870734,315,50,"paragraphElement is null");let Ha=({i:qa,zt:ha,A8:Da,Gxk:va}=this.ybg(ma,va,Da)).returnValue,bb="";bb=ma.Aja;ma=z.a.Fv(Ha.htmlElement);
let Na=ma.length,Ia,Qa=!1;if(!Na)if(Ia=Sys.UI.DomElement.getBounds(Ha.htmlElement),Qa=!0,!Ia.height&&qa<ha.length-1)qa++,Ha=ha[qa],ma=M.b(Ha.htmlElement),Na=ma.length;else if(!Ha.htmlElement.firstChild||Ha.Nng)return this.YP.iha(Ia,ta,()=>Ha.htmlElement.offsetWidth/Ha.htmlElement.offsetHeight);var qa=!1;!Qa&&va>=Na&&(va=Na-1,qa=!0);if(Ia=Ha.t4||!Ha.htmlElement.firstChild||Ha.Tmg?this.vWd(Ha,ta):this.lRa(Ha.htmlElement,ma,va,bb,Da,Ca,oa,ta))Qa?Ia.width=1:qa&&(Ia.x+=Ia.width,Ia.width=1);this.vMb();
return Ia}fFa(ma,va,Ca=!1,oa=!0){return this.ybg(ma,va,Ca,oa).returnValue}ccc(ma,va){return va.y>ma.y+ma.height-ca.Ota(ma.height)}ybg(ma,va,Ca=!1,oa=!0){let Da,ta,ha=ma;Da=ma.R6;for(ma=ta=0;ma<Da.length;ma++){if(Da[ma].DAb)continue;let Ha;if(Da[ma].t4){if(!va){Ca||this.cZj(Da,ma)?ha=Da[ma]:(ha=Da[ma-1],va=Ha=z.a.U$a(ha.htmlElement),ta-=Ha);break}va--;ta++;continue}Ha=z.a.U$a(Da[ma].htmlElement);let bb=!1;if(this.c0h){const Na=Da[ma].htmlElement,Ia=Na.nextSibling;Ia&&(bb=Sys.UI.DomElement.containsCssClass(Na,
"EmptyTextRun")&&Sys.UI.DomElement.containsCssClass(Ia,"Hyperlink"))}if(va<Ha||!va&&oa&&!bb||ma>=Da.length-1){ha=Da[ma];break}else va-=Ha,ta+=Ha}return{returnValue:ha,i:ma,zt:Da,A8:ta,Gxk:va}}cZj(ma,va){if(!va)return!0;const Ca=this.Otb(ma[va-1].htmlElement);ma=this.Otb(ma[va].htmlElement);return this.ccc(Ca,ma)}lRa(ma,va,Ca,oa,Da,ta=!1,ha=!1,Ha=null){let bb=Ca+1;Ca||va.length?B.a.Gx(va,Ca)?Ca--:B.a.Gx(va,bb)&&bb++:bb=0;if(""!==oa)if(oa=Da+Ca+"-"+oa,this.nVb){if(Da=this.uob[oa],void 0!==Da&&null!==
Da)return oa=this.YP.iha(Da,Ha,()=>this.YP.S4f(ma,Ca)),oa=this.kPa.QTd(Ha,ma,oa)}else this.uob={},this.nVb=!0;Da=this.jxc(ma,Ca,bb);ta=ta&&(w.a.Wj||w.a.Ho);if(!Da&&!ha||ta)va=this.pvk(ma,va,Ca,bb),Da||(Da=va),ta&&Da&&(Da.y=va.y,Da.height=va.height);""!==oa&&Da&&(this.uob[oa]=new Sys.UI.Bounds(Da.x,Da.y,Da.width,Da.height));oa=this.YP.iha(Da,Ha,()=>this.YP.S4f(ma,Ca));return oa=this.kPa.QTd(Ha,ma,oa)}jxc(ma,va,Ca){let oa=null;if(this.C7b(ma)<Ca)return null;w.a.lS&&(oa=this.ovk(ma,va,Ca));!oa&&w.a.Wj&&
(oa=this.qvk(ma,va,Ca));return oa}KEf(ma,va=null){return this.Otb(ma.htmlElement.firstChild,va)}vWd(ma,va=null){return ma.OVa?this.KEf(ma,va):this.Otb(ma.htmlElement,va)}Otb(ma,va=null){var Ca=Sys.UI.DomElement.getBounds(ma);Ca=this.YP.iha(Ca,va,()=>ma.offsetWidth/ma.offsetHeight);return Ca=this.kPa.QTd(va,ma,Ca)}tW(ma,va,Ca,oa,Da,ta){return ma!==va.characterData.length||Ca?this.uqi(ma,va,Ca,oa,Da,ta):this.tqi(va)}tqi(ma){const va=this.mRa(ma);return this.U6f(va,!ma.isRtl)}uqi(ma,va,Ca,oa,Da,ta){var ha=
va.textLength;if(w.a.bU&&Ca&&0<ma&&ma<ha){var Ha=this.fFa(va,ma-1,!0),bb=this.fFa(va,ma,!0);Ha===bb&&(Ca=!1)}var Na=Ca?ma-1:ma;B.a.Gx(va.characterData,Na)&&--Na;var Ia=!0;bb=this.fFa(va,Na,!0,!1);if(bb.t4)if(bb.OVa){if(Ca)return this.tW(ma,va,!1,oa,!1,ta);Ha=this.KEf(bb)}else if(bb.c2c){if(Ca)return this.tW(ma,va,!1,oa,!1,ta);if(ma)return this.tW(ma,va,!0,oa,!1,ta);Ha=this.vWd(bb)}else Ha=this.Otb(bb.htmlElement),bb.sYj&&(Ia=!1);else{bb=Na;do{Ha=this.$t(va,bb,Da,ta);if(!Ha)return null;bb+=1}while(!Ha.height&&
bb<=ha)}bb=ha=va.isRtl;if(Ia){Ia=this.AJc(va,Na,-1,Da,ta);Da=this.AJc(va,Na,1,Da,ta);ta=new Sys.UI.Point(Ha.x+Ha.width/2,Ha.y+Ha.height/2);Na=Ha.y;var Qa=Ha.y+Ha.height;Na=!Ia||Ia.y+Ia.height<=Na;Qa=!Da||Da.y>=Qa;let qa=!1;Na||Qa?Na||B.a.uz(va.characterData.charCodeAt(ma))?Qa||(Da.x>=ta.x?bb=!1:Da.x<=ta.x&&(bb=!0),qa=bb!==ha):(Ia.x<=ta.x?bb=!1:Ia.x>=ta.x&&(bb=!0),qa=bb!==ha):Ia.x<=ta.x&&ta.x<=Da.x?bb=!1:Da.x<=ta.x&&ta.x<=Ia.x?bb=!0:Ia.x<Da.x?(bb=!0,qa=Ca?ta.x<Ia.x:Ia.x<ta.x):Da.x<Ia.x&&(bb=!1,qa=
Ca?Ia.x<ta.x:ta.x<Ia.x);if(qa&&w.a.dG){if(Ca&&!oa)return this.tW(ma,va,!1,!1);ma||(Ha=this.Ifj(va,ha))}}return this.U6f(Ha,bb===Ca)}AJc(ma,va,Ca,oa,Da){if(0>Ca&&0>=va||0<Ca&&va>=ma.characterData.length-1)return null;const ta=va+Ca;return B.a.Gx(ma.characterData,ta)?this.AJc(ma,ta,Ca,oa,Da):this.fFa(ma,va,!0,!1).OVa?null:(va=this.$t(ma,ta,oa,Da))?va.height&&va.width?va:this.AJc(ma,ta,Ca,oa,Da):null}Ifj(ma,va){let Ca=null;for(var oa=0;oa<ma.R6.length;oa++){const Da=ma.R6[oa];if(!Da.DAb){Ca=Da.htmlElement;
break}}for(oa=Ca.childNodes[0];oa&&1===oa.nodeType;)Ca=oa,oa=Ca.childNodes[0];oa=z.a.Fv(Ca);z.a.Mz(Ca,(va?"\u202e":"\u202d")+oa);this.pea();ma=this.$t(ma,0);z.a.Mz(Ca,oa);this.pea();return ma}U6f(ma,va){return new Sys.UI.Bounds(va?ma.x:ma.x+ma.width,ma.y,0,ma.height)}mRa(ma,va=null){return this.Otb(ma.cYf.htmlElement,va)}ovk(ma,va,Ca){this.vMb();try{const oa=ma.firstChild,Da=oa.ownerDocument.createRange();Da.setStart(oa,va);Da.setEnd(oa,Ca);const ta=this.Hmj(Da,(ha,Ha)=>(0<ha||va===Ca)&&0<Ha);if(!ta||
!ta.length)return null;this.eAf(oa,ta[0]);Da.detach();return ta[0]}catch(oa){return null}}Hmj(ma,va){this.vMb();try{let Ca;Ca=ma.getClientRects();ma=[];for(let oa=0;oa<Ca.length;oa++){const Da=Ca[oa];if(Da){const ta=Math.floor(Da.width/1),ha=Math.floor(Da.height/1);if(va(ta,ha)){const Ha=new Sys.UI.Bounds(Math.floor(Da.left/1),Math.floor(Da.top/1),ta,ha);Array.add(ma,Ha)}}}return ma}catch(Ca){return null}}qvk(ma,va,Ca){if(!w.a.APb)return null;let oa=null;try{oa=ma.ownerDocument.body.createTextRange(),
oa.moveToElementText(ma)}catch(Da){return null}if(oa.collapse&&oa.move&&oa.moveEnd)oa.collapse(),oa.move("character",va),oa.moveEnd("character",Ca-va);else return null;va=new Sys.UI.Bounds(oa.boundingLeft,oa.boundingTop,oa.boundingWidth,oa.boundingHeight);if(!(va.x||va.y||va.width||va.height))return null;this.eAf(ma,va);ma=window.screen.deviceXDPI/window.screen.logicalXDPI;1!==ma&&(va.x=Math.round(va.x/ma),va.y=Math.round(va.y/ma),va.width=Math.round(va.width/ma),va.height=Math.round(va.height/ma));
return va}pvk(ma,va,Ca,oa){this.z6a&&this.z6a.ownerDocument===ma.ownerDocument||(this.z6a=ma.ownerDocument.createElement("SPAN"),this.Lrb=ma.ownerDocument.createElement("SPAN"),this.BGc=ma.ownerDocument.createElement("SPAN"));ma.firstChild!==this.z6a&&(this.gEc=new J.a(ma),z.a.vv(ma),this.kPa&&this.kPa.VAi(this.z6a,this.Lrb,this.BGc),ma.appendChild(this.z6a),ma.appendChild(this.Lrb),ma.appendChild(this.BGc));z.a.Mz(this.z6a,B.a.substring(va,0,Ca));z.a.Mz(this.Lrb,B.a.substring(va,Ca,oa));z.a.Mz(this.BGc,
B.a.substring(va,oa,va.length));G.AFrameworkApplication.fa.ka("ChromiumSpanIssueFixIsEnabled")&&w.a.ik&&w.a.cUj&&" "===B.a.substring(va,Ca,oa)&&Sys.UI.DomElement.addCssClass(this.Lrb,"WhiteSpaceSpanElement");return Sys.UI.DomElement.getBounds(this.Lrb)}eAf(ma,va){this.kji(ma,[va])}kji(ma,va){try{if(void 0!==ma.ownerDocument.parentWindow){var Ca=ma.ownerDocument.parentWindow.frameElement;if(Ca&&("0"===Ca.frameBorder||"no"===Ca.frameBorder))for(ma=0;ma<va.length;ma++)va[ma].x+=2,va[ma].y+=2}}catch(oa){}}vMb(){this.gEc&&
this.gEc.restore();this.gEc=null}Ptb(ma,va){if(""!==va){let Ca;if(this.nVb){if(Ca=this.uob["VE-"+va])return ma=new Sys.UI.Bounds(Ca.x,Ca.y,Ca.width,Ca.height)}else this.uob={},this.nVb=!0;Ca=Sys.UI.DomElement.getBounds(ma);this.uob["VE-"+va]=Ca;return ma=new Sys.UI.Bounds(Ca.x,Ca.y,Ca.width,Ca.height)}return Sys.UI.DomElement.getBounds(ma)}static get instance(){return ca.La||(ca.La=new ca(e.a.instance,h.a.instance.Ia("Common.IZoomManager"),G.AFrameworkApplication.fa,h.a.instance.resolve("Box4.TextMetricsApi.IMeasureBoundsUsingSpansStrategy"),
h.a.instance.resolve("Box4.IRotatingCoordinateConverter"),h.a.instance.resolve("Box4.TextMetricsApi.ITextMetricsHelper")))}static Ota(ma){return O.SelectionEditor.Ota(ma)}}ca.La=null;Object(K.a)(ca,"TextMetrics",null,[]);var L=d(98);class da{get OVa(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,L.a.fdc)}get t4(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,L.a.FN)}get c2c(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,L.a.aLk)}get sYj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,
L.a.xPj)||Sys.UI.DomElement.containsCssClass(this.htmlElement,L.a.wPj)||Sys.UI.DomElement.containsCssClass(this.htmlElement,L.a.uPj)}get Nng(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,L.a.W4d)}get Tmg(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,L.a.fNf)}}Object(K.a)(da,"ATextMetricsElement",null,[315]);var Z=d(34),fa=d(153);class aa extends da{constructor(ma){super();this.PP=ma}get htmlElement(){return this.PP}get Cla(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,
L.a.VN)}get DAb(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,fa.a.pW)}get bYj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,L.a.PRj)}get KUj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,L.a.Spi)||Sys.UI.DomElement.containsCssClass(this.htmlElement,L.a.zPj)}get JUj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,L.a.Rpi)||Sys.UI.DomElement.containsCssClass(this.htmlElement,L.a.yPj)}}Object(K.a)(aa,"TextMetricsLeafElement",da,[330,315]);var ja=
d(54),I=d(59);class sa extends da{constructor(ma){super();this.Nqb=ma;this.Qi=this.Nqb.gb;this.iZb=Array(ma.At.length);for(ma=0;ma<this.Nqb.At.length;ma++){const va=new aa(this.Nqb.At[ma]);this.iZb[ma]=va}}get R6(){return this.iZb}get paragraphId(){return this.Qi.id.toString()}get htmlElement(){return this.Nqb.htmlElement}get Aja(){return this.Nqb.Qc.Sh?this.Nqb.gb.id.toString():""}get textLength(){return Z.ParagraphReader.textLength(this.Qi)}get isRtl(){return I.OutlineElementReader.Gm(ja.OutlineElementNavigator.vB(this.Qi))}get vs(){return Z.ParagraphReader.ae(this.Qi)&&
!this.Qi.cX}get characterData(){return this.Qi.characterData}get cYf(){return this.iZb.length?this.iZb[this.iZb.length-1]:null}static a9a(ma){return new sa(ma)}}Object(K.a)(sa,"TextMetricsParagraphElement",da,[314,315]);var ka=d(51),Ma=d(35);d.d(U,"a",function(){return Ea});class Ea{static get c3b(){return Ea.aB||(Ea.aB=h.a.instance.qb("Box4.CharacterPointConverter"))}static get Xc(){return e.a.instance}static $t(ma,va,Ca=!1,oa=!1,Da=!1,ta=null){ma=sa.a9a(ma);return ca.instance.$t(ma,va,Ca,oa,Da,
ta)}static jxc(ma,va,Ca){return ca.instance.jxc(ma,va,Ca)}static Ptb(ma,va){return ca.instance.Ptb(ma,va)}static tW(ma,va,Ca,oa,Da=!1,ta=!1){va=sa.a9a(va);return ca.instance.tW(ma,va,Ca,oa,Da,ta)}static mRa(ma,va=null){ma=sa.a9a(ma);return ca.instance.mRa(ma,va)}static pea(){ca.instance.pea()}static X8a(ma,va,Ca,oa=null){let Da=null,ta=null;try{const ha=sa.a9a(ma);let Ha=null;Da=Ea.Xc.Zp(Ma.a.Zbj);(Ha=ca.instance.X8a(ha,va,Ca,oa))&&(ta=Ea.c3b?Ea.c3b.aXl(Ha,ma.gb):ka.a.WRa(Ha.CpBegin,Ha.CpEnd,Ha.IsEop,
ma.gb))}catch(ha){Ea.Xc.Xb(m.a.HVl,{["Reason"]:r.a.j0i,["ExceptionMessage"]:ha.message,["ExceptionCallstack"]:ha.stack}),ta=null}Da&&Da.end();return ta}static fFa(ma,va,Ca=!1,oa=!0){ma=sa.a9a(ma);return ca.instance.fFa(ma,va,Ca,oa).htmlElement}static ccc(ma,va){return ca.instance.ccc(ma,va)}}Ea.aB=null;Object(K.a)(Ea,"TextMetricsAdapter",null,[])},305:function(K,U,d){d.r(U);var h;(function(Ia){Ia[Ia.Undefined=0]="Undefined";Ia[Ia.Created=10]="Created";Ia[Ia.Sent=20]="Sent";Ia[Ia.Duplicated=30]="Duplicated";
Ia[Ia.Seen=40]="Seen";Ia[Ia.Tried=50]="Tried";Ia[Ia.Kept=60]="Kept";Ia[Ia.Rejected=70]="Rejected"})(h||(h={}));var e;(function(Ia){Ia[Ia.None=0]="None";Ia[Ia.Added=1]="Added";Ia[Ia.Updated=2]="Updated";Ia[Ia.Deleted=3]="Deleted"})(e||(e={}));var r;(function(Ia){Ia[Ia.ContentChanged=0]="ContentChanged";Ia[Ia.ContentWasEmpty=1]="ContentWasEmpty";Ia[Ia.FormattingChanged=2]="FormattingChanged";Ia[Ia.ContentWasInsideOfTheTable=3]="ContentWasInsideOfTheTable"})(r||(r={}));var m;(function(Ia){Ia[Ia.None=
0]="None";Ia[Ia.HttpsGetDownloadUrl=1]="HttpsGetDownloadUrl";Ia[Ia.AlCodedLocation=2]="AlCodedLocation"})(m||(m={}));var n;(function(Ia){Ia[Ia.NewDocument=0]="NewDocument";Ia[Ia.EditDocument=1]="EditDocument";Ia[Ia.ViewOnlyDocument=2]="ViewOnlyDocument"})(n||(n={}));class z{}z.lowerIndexBound=1;z.maxNumberOfRows=1048576;z.maxNumberOfColumns=16384;z.firstColumnName="A";z.lastColumnName="XFD";var v=d(335);class x{constructor(Ia){v.a.assign(x,this,Ia)}get metadata(){return this.M_}set metadata(Ia){this.M_=
Ia}static getTypeName(){return"AugLoop_Core_Annotation"}static getBaseTypes(){return[]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,[x.getTypeName()])}}x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()};class B{constructor(Ia){v.a.assign(B,this,Ia)}get metadata(){return this.M_}set metadata(Ia){this.M_=Ia}static getTypeName(){return"AugLoop_Core_BinaryClassificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,[B.getTypeName()])}}
B.H_={T_:B.getTypeName(),B_:B.getBaseTypes()};class D{constructor(Ia){v.a.assign(D,this,Ia)}static getTypeName(){return"AugLoop_Core_Event"}static getBaseTypes(){return[]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,[D.getTypeName()])}}D.H_={T_:D.getTypeName(),B_:D.getBaseTypes()};class w{constructor(Ia){v.a.assign(w,this,Ia)}static getTypeName(){return"AugLoop_Core_UserCommand"}static getBaseTypes(){return["AugLoop_Core_Event"]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,[w.getTypeName()])}}
w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class J{constructor(Ia){v.a.assign(J,this,Ia)}static getTypeName(){return"AugLoop_Core_ItemDelta"}static getBaseTypes(){return[]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,[J.getTypeName()])}}J.H_={T_:J.getTypeName(),B_:J.getBaseTypes()};class G{constructor(Ia){v.a.assign(G,this,Ia)}static getTypeName(){return"AugLoop_Core_ItemChangesDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,
[G.getTypeName()])}}G.H_={T_:G.getTypeName(),B_:G.getBaseTypes()};class M{constructor(Ia){v.a.assign(M,this,Ia)}static getTypeName(){return"AugLoop_Core_Operation"}static getBaseTypes(){return[]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,[M.getTypeName()])}}M.H_={T_:M.getTypeName(),B_:M.getBaseTypes()};class N{constructor(Ia){v.a.assign(N,this,Ia)}static getTypeName(){return"AugLoop_Core_OperationWithSiblingContext"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,
[N.getTypeName()])}}N.H_={T_:N.getTypeName(),B_:N.getBaseTypes()};class R{constructor(Ia){v.a.assign(R,this,Ia)}static getTypeName(){return"AugLoop_Core_AddOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,[R.getTypeName()])}}R.H_={T_:R.getTypeName(),B_:R.getBaseTypes()};class C{constructor(Ia){v.a.assign(C,this,Ia)}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext",
"AugLoop_Core_Operation"]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,[C.getTypeName()])}}C.H_={T_:C.getTypeName(),B_:C.getBaseTypes()};class O{constructor(Ia){v.a.assign(O,this,Ia)}static getTypeName(){return"AugLoop_Core_UpdateAnnotationMetaDataOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,[O.getTypeName()])}}O.H_={T_:O.getTypeName(),B_:O.getBaseTypes()};class S{constructor(Ia){v.a.assign(S,this,Ia)}static getTypeName(){return"AugLoop_Core_UpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,
[S.getTypeName()])}}S.H_={T_:S.getTypeName(),B_:S.getBaseTypes()};class T{constructor(Ia){v.a.assign(T,this,Ia)}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class ca{constructor(Ia){v.a.assign(ca,this,Ia)}static getTypeName(){return"AugLoop_Core_PurgeOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,
[ca.getTypeName()])}}ca.H_={T_:ca.getTypeName(),B_:ca.getBaseTypes()};class L{constructor(Ia){v.a.assign(L,this,Ia)}static getTypeName(){return"AugLoop_Core_FocusOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,[L.getTypeName()])}}L.H_={T_:L.getTypeName(),B_:L.getBaseTypes()};class da{constructor(Ia){v.a.assign(da,this,Ia)}static getTypeName(){return"AugLoop_Core_VisibilityOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,
[da.getTypeName()])}}da.H_={T_:da.getTypeName(),B_:da.getBaseTypes()};class Z{constructor(Ia){v.a.assign(Z,this,Ia)}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,[Z.getTypeName()])}}Z.H_={T_:Z.getTypeName(),B_:Z.getBaseTypes()};class fa{constructor(Ia){v.a.assign(fa,this,Ia)}static getTypeName(){return"AugLoop_Core_MicroSyncOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,
[fa.getTypeName()])}}fa.H_={T_:fa.getTypeName(),B_:fa.getBaseTypes()};class aa{constructor(Ia){v.a.assign(aa,this,Ia)}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,[aa.getTypeName()])}}aa.H_={T_:aa.getTypeName(),B_:aa.getBaseTypes()};class ja{constructor(Ia){v.a.assign(ja,this,Ia)}static getTypeName(){return"AugLoop_Signals_Signal"}static getBaseTypes(){return[]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,
[ja.getTypeName()])}}ja.H_={T_:ja.getTypeName(),B_:ja.getBaseTypes()};class I{constructor(Ia){v.a.assign(I,this,Ia)}static getTypeName(){return"AugLoop_Core_Blob"}static getBaseTypes(){return[]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,[I.getTypeName()])}}I.H_={T_:I.getTypeName(),B_:I.getBaseTypes()};class sa{constructor(Ia){v.a.assign(sa,this,Ia)}static getTypeName(){return"AugLoop_Core_Binary"}static getBaseTypes(){return[]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,[sa.getTypeName()])}}
sa.H_={T_:sa.getTypeName(),B_:sa.getBaseTypes()};class ka{constructor(Ia){v.a.assign(ka,this,Ia)}static getTypeName(){return"AugLoop_Core_TileGroup"}static getBaseTypes(){return[]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,[ka.getTypeName()])}}ka.H_={T_:ka.getTypeName(),B_:ka.getBaseTypes()};class Ma{constructor(Ia){v.a.assign(Ma,this,Ia)}static getTypeName(){return"AugLoop_Core_Session"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,
[Ma.getTypeName()])}}Ma.H_={T_:Ma.getTypeName(),B_:Ma.getBaseTypes()};class Ea{constructor(Ia){v.a.assign(Ea,this,Ia)}static getTypeName(){return"AugLoop_Core_Document"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,[Ea.getTypeName()])}}Ea.H_={T_:Ea.getTypeName(),B_:Ea.getBaseTypes()};class ma{constructor(Ia){v.a.assign(ma,this,Ia)}static getTypeName(){return"AugLoop_Core_SubDocument"}static getBaseTypes(){return[]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,
[ma.getTypeName()])}}ma.H_={T_:ma.getTypeName(),B_:ma.getBaseTypes()};class va{constructor(Ia){v.a.assign(va,this,Ia)}static getTypeName(){return"AugLoop_Core_GridCell"}static getBaseTypes(){return[]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,[va.getTypeName()])}}va.H_={T_:va.getTypeName(),B_:va.getBaseTypes()};class Ca{constructor(Ia){v.a.assign(Ca,this,Ia)}static getTypeName(){return"AugLoop_Core_GridNeighborhoodContext"}static getBaseTypes(){return[]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,
[Ca.getTypeName()])}}Ca.H_={T_:Ca.getTypeName(),B_:Ca.getBaseTypes()};class oa{constructor(Ia){v.a.assign(oa,this,Ia)}static getTypeName(){return"AugLoop_Core_ItemFilter"}static getBaseTypes(){return[]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,[oa.getTypeName()])}}oa.H_={T_:oa.getTypeName(),B_:oa.getBaseTypes()};class Da{constructor(Ia){v.a.assign(Da,this,Ia)}static getTypeName(){return"AugLoop_Core_DynamicContext"}static getBaseTypes(){return[]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,
[Da.getTypeName()])}}Da.H_={T_:Da.getTypeName(),B_:Da.getBaseTypes()};class ta{constructor(Ia){v.a.assign(ta,this,Ia)}static getTypeName(){return"AugLoop_Core_ContextHolder"}static getBaseTypes(){return[]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,[ta.getTypeName()])}}ta.H_={T_:ta.getTypeName(),B_:ta.getBaseTypes()};class ha{constructor(Ia){v.a.assign(ha,this,Ia)}static getTypeName(){return"AugLoop_Core_UserContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,
[ha.getTypeName()])}}ha.H_={T_:ha.getTypeName(),B_:ha.getBaseTypes()};class Ha{constructor(Ia){v.a.assign(Ha,this,Ia)}static getTypeName(){return"AugLoop_Core_TenantContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,[Ha.getTypeName()])}}Ha.H_={T_:Ha.getTypeName(),B_:Ha.getBaseTypes()};class bb{constructor(Ia){v.a.assign(bb,this,Ia)}static getTypeName(){return"AugLoop_Core_EventsHolder"}static getBaseTypes(){return[]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,
[bb.getTypeName()])}}bb.H_={T_:bb.getTypeName(),B_:bb.getBaseTypes()};class Na{constructor(Ia){v.a.assign(Na,this,Ia)}static getTypeName(){return"AugLoop_Core_UserCommandsHolder"}static getBaseTypes(){return["AugLoop_Core_EventsHolder"]}static typeGuard(Ia){return v.a.matchesTypesFor(Ia,[Na.getTypeName()])}}Na.H_={T_:Na.getTypeName(),B_:Na.getBaseTypes()};d.d(U,"AnnotationState",function(){return h});d.d(U,"ItemOperation",function(){return e});d.d(U,"ItemChanges",function(){return r});d.d(U,"BlobRefType",
function(){return m});d.d(U,"OpenType",function(){return n});d.d(U,"GridConstants",function(){return z});d.d(U,"Annotation",function(){return x});d.d(U,"BinaryClassificationAnnotation",function(){return B});d.d(U,"Event",function(){return D});d.d(U,"UserCommand",function(){return w});d.d(U,"ItemDelta",function(){return J});d.d(U,"ItemChangesDelta",function(){return G});d.d(U,"Operation",function(){return M});d.d(U,"OperationWithSiblingContext",function(){return N});d.d(U,"AddOperation",function(){return R});
d.d(U,"MoveOperation",function(){return C});d.d(U,"UpdateAnnotationMetaDataOperation",function(){return O});d.d(U,"UpdateOperation",function(){return S});d.d(U,"DeleteOperation",function(){return T});d.d(U,"PurgeOperation",function(){return ca});d.d(U,"FocusOperation",function(){return L});d.d(U,"VisibilityOperation",function(){return da});d.d(U,"DeltaUpdateOperation",function(){return Z});d.d(U,"MicroSyncOperation",function(){return fa});d.d(U,"SignalOperation",function(){return aa});d.d(U,"SchemaObject",
function(){return v.a});d.d(U,"Signal",function(){return ja});d.d(U,"Blob",function(){return I});d.d(U,"Binary",function(){return sa});d.d(U,"TileGroup",function(){return ka});d.d(U,"Session",function(){return Ma});d.d(U,"Document",function(){return Ea});d.d(U,"SubDocument",function(){return ma});d.d(U,"GridCell",function(){return va});d.d(U,"GridNeighborhoodContext",function(){return Ca});d.d(U,"ItemFilter",function(){return oa});d.d(U,"DynamicContext",function(){return Da});d.d(U,"ContextHolder",
function(){return ta});d.d(U,"UserContextHolder",function(){return ha});d.d(U,"TenantContextHolder",function(){return Ha});d.d(U,"EventsHolder",function(){return bb});d.d(U,"UserCommandsHolder",function(){return Na})},313:function(K,U,d){K=d(0);var h=d(529),e=d(143);class r extends h.a{constructor(){super();this.nextId=this.prevId=null;this.H_=Object.assign(new e.a,{T_:r.getTypeName(),B_:r.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_OperationWithSiblingContext"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}
Object(K.a)(r,"OperationWithSiblingContext",h.a,[]);d.d(U,"a",function(){return m});class m extends r{constructor(){super();this.isTriggeredBySyncDelta=null;this.H_=Object.assign(new e.a,{T_:m.getTypeName(),B_:m.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_AddOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}}Object(K.a)(m,"AddOperation",r,[])},314:function(K,U,d){K=d(0);var h=d(392),e=d(27),r=d(1272);const m=(z,v)=>{const x=
{};let B=null;switch(z){case 0:B="HtmlProcessor";var D=v.a;null!=D&&(x.SessionID=D);var w=v.b.toString();null!=w&&(x.Elements=w);var J=v.c.toString();null!=J&&(x.PrunedElements=J);var G=v.d.toString();null!=G&&(x.TransparentElements=G);var M=v.e.toString();null!=M&&(x.VoidElements=M);var N=v.f.toString();null!=N&&(x.UnknownElements=N);break;case 1:B="WordConverter";var R=v.a;null!=R&&(x.SessionID=R);var C=v.b.toString();null!=C&&(x.BulletsConverted=C);var O=v.c.toString();null!=O&&(x.NumberedConverted=
O);break;case 2:B="FormattingSteward";var S=v.a;null!=S&&(x.SourceApp=S);var T=v.b;null!=T&&(x.Browser=T);var ca=v.c;null!=ca&&(x.OperationId=ca);var L=v.d.toString();null!=L&&(x.Lang=L);var da=v.e.toString();null!=da&&(x.TextDir=da);var Z=v.f.toString();null!=Z&&(x.Bold=Z);var fa=v.g.toString();null!=fa&&(x.Math=fa);var aa=v.h.toString();null!=aa&&(x.Italics=aa);var ja=v.i.toString();null!=ja&&(x.Underline=ja);var I=v.j.toString();null!=I&&(x.Strikethrough=I);var sa=v.k.toString();null!=sa&&(x.Subscript=
sa);var ka=v.l.toString();null!=ka&&(x.Superscript=ka);var Ma=v.m.toString();null!=Ma&&(x.Fontsize=Ma);var Ea=v.n.toString();null!=Ea&&(x.Fontface=Ea);var ma=v.o.toString();null!=ma&&(x.GrowFontsize=ma);var va=v.p.toString();null!=va&&(x.ShrinkFontsize=va);var Ca=v.q.toString();null!=Ca&&(x.FontColor=Ca);var oa=v.r.toString();null!=oa&&(x.FontHighlight=oa);var Da=v.s.toString();null!=Da&&(x.ParagraphStyle=Da);var ta=v.t.toString();null!=ta&&(x.TextAlign=ta);var ha=v.u.toString();null!=ha&&(x.TextIndent=
ha);var Ha=v.v.toString();null!=Ha&&(x.MarginLeft=Ha);var bb=v.w.toString();null!=bb&&(x.ParagraphSpaceBefore=bb);var Na=v.x.toString();null!=Na&&(x.ParagraphSpaceAfter=Na);var Ia=v.y.toString();null!=Ia&&(x.LineSpace=Ia);var Qa=v.z.toString();null!=Qa&&(x.CellShadingColor=Qa);break;case 3:B="SemanticEvents";var qa=v.a;null!=qa&&(x.SessionID=qa);var Wa=v.b.toString();null!=Wa&&(x.Text=Wa);var Hb=v.c.toString();null!=Hb&&(x.LineBreak=Hb);var jc=v.d.toString();null!=jc&&(x.Image=jc);var gc=v.e.toString();
null!=gc&&(x.File=gc);var $b=v.f.toString();null!=$b&&(x.FormattingChange=$b);var wb=v.g.toString();null!=wb&&(x.Anchor=wb);var Db=v.h.toString();null!=Db&&(x.Paragraph=Db);var Xb=v.i.toString();null!=Xb&&(x.Math=Xb);var ab=v.j.toString();null!=ab&&(x.List=ab);var Ab=v.k.toString();null!=Ab&&(x.ListItem=Ab);var rc=v.l.toString();null!=rc&&(x.RenderAugmentation=rc);var tb=v.m.toString();null!=tb&&(x.Span=tb);break;case 4:B="SemanticTableEvents";var Za=v.a;null!=Za&&(x.SessionID=Za);var fb=v.b.toString();
null!=fb&&(x.Tables=fb);var ac=v.c.toString();null!=ac&&(x.TableRow=ac);var Dc=v.d.toString();null!=Dc&&(x.TableCell=Dc);var Sc=v.e.toString();null!=Sc&&(x.TablePart=Sc);break;case 5:B="HtmlEvents";var xb=v.a;null!=xb&&(x.OperationId=xb);var Ta=v.b;null!=Ta&&(x.SourceApp=Ta);var ib=v.c;null!=ib&&(x.Browser=ib);var ob=null==v.d?null:v.d.toString();null!=ob&&(x.Text=ob);var fc=null==v.e?null:v.e.toString();null!=fc&&(x.A=fc);var Jb=null==v.f?null:v.f.toString();null!=Jb&&(x.Abbr=Jb);var xc=null==v.g?
null:v.g.toString();null!=xc&&(x.Acronym=xc);var ic=null==v.h?null:v.h.toString();null!=ic&&(x.Address=ic);var nc=null==v.i?null:v.i.toString();null!=nc&&(x.Applet=nc);var Wb=null==v.j?null:v.j.toString();null!=Wb&&(x.Area=Wb);var wc=null==v.k?null:v.k.toString();null!=wc&&(x.B=wc);var nb=null==v.l?null:v.l.toString();null!=nb&&(x.Base=nb);var Rb=null==v.m?null:v.m.toString();null!=Rb&&(x.Basefont=Rb);var mb=null==v.n?null:v.n.toString();null!=mb&&(x.Bdo=mb);var Ub=null==v.o?null:v.o.toString();null!=
Ub&&(x.Big=Ub);var zc=null==v.p?null:v.p.toString();null!=zc&&(x.Blockquote=zc);var Pc=null==v.q?null:v.q.toString();null!=Pc&&(x.Body=Pc);var Mc=null==v.r?null:v.r.toString();null!=Mc&&(x.Br=Mc);var ld=null==v.s?null:v.s.toString();null!=ld&&(x.Button=ld);var vb=null==v.t?null:v.t.toString();null!=vb&&(x.Caption=vb);var cc=null==v.u?null:v.u.toString();null!=cc&&(x.Center=cc);var Hc=null==v.v?null:v.v.toString();null!=Hc&&(x.Cite=Hc);var Pb=null==v.w?null:v.w.toString();null!=Pb&&(x.Code=Pb);var Uc=
null==v.x?null:v.x.toString();null!=Uc&&(x.Col=Uc);var sc=null==v.y?null:v.y.toString();null!=sc&&(x.Colgroup=sc);var lb=null==v.z?null:v.z.toString();null!=lb&&(x.Dd=lb);var Zb=null==v.ba?null:v.ba.toString();null!=Zb&&(x.Del=Zb);var Oc=null==v.bb?null:v.bb.toString();null!=Oc&&(x.Dfn=Oc);var md=null==v.bc?null:v.bc.toString();null!=md&&(x.Dir=md);var Ib=null==v.bd?null:v.bd.toString();null!=Ib&&(x.Div=Ib);var ud=null==v.be?null:v.be.toString();null!=ud&&(x.Dl=ud);var od=null==v.bf?null:v.bf.toString();
null!=od&&(x.Dt=od);var Ud=null==v.bg?null:v.bg.toString();null!=Ud&&(x.Em=Ud);var Ad=null==v.bh?null:v.bh.toString();null!=Ad&&(x.Fieldset=Ad);var be=null==v.bi?null:v.bi.toString();null!=be&&(x.Font=be);var uf=null==v.bj?null:v.bj.toString();null!=uf&&(x.Form=uf);var sd=null==v.bk?null:v.bk.toString();null!=sd&&(x.Frame=sd);var Ze=null==v.bl?null:v.bl.toString();null!=Ze&&(x.Frameset=Ze);var Ke=null==v.bm?null:v.bm.toString();null!=Ke&&(x.H=Ke);var hf=null==v.bn?null:v.bn.toString();null!=hf&&(x.Head=
hf);var Xa=null==v.bo?null:v.bo.toString();null!=Xa&&(x.Hr=Xa);var Bb=null==v.bp?null:v.bp.toString();null!=Bb&&(x.Html=Bb);var mc=null==v.bq?null:v.bq.toString();null!=mc&&(x.I=mc);var Qc=null==v.br?null:v.br.toString();null!=Qc&&(x.Iframe=Qc);var td=null==v.bs?null:v.bs.toString();null!=td&&(x.Img=td);var Md=null==v.bt?null:v.bt.toString();null!=Md&&(x.Input=Md);var Pd=null==v.bu?null:v.bu.toString();null!=Pd&&(x.Ins=Pd);var Be=null==v.bv?null:v.bv.toString();null!=Be&&(x.Isindex=Be);var fe=null==
v.bw?null:v.bw.toString();null!=fe&&(x.Kbd=fe);var Mf=null==v.bx?null:v.bx.toString();null!=Mf&&(x.Label=Mf);var Bd=null==v.by?null:v.by.toString();null!=Bd&&(x.Legend=Bd);var Rc=null==v.bz?null:v.bz.toString();null!=Rc&&(x.Li=Rc);var Gf=null==v.ca?null:v.ca.toString();null!=Gf&&(x.Link=Gf);var Nf=null==v.cb?null:v.cb.toString();null!=Nf&&(x.Map=Nf);var Oa=null==v.cc?null:v.cc.toString();null!=Oa&&(x.Math=Oa);var cb=null==v.cd?null:v.cd.toString();null!=cb&&(x.Menu=cb);var Ic=null==v.ce?null:v.ce.toString();
null!=Ic&&(x.Meta=Ic);var qd=null==v.cf?null:v.cf.toString();null!=qd&&(x.Noframes=qd);var le=null==v.cg?null:v.cg.toString();null!=le&&(x.Noscript=le);var yb=null==v.ch?null:v.ch.toString();null!=yb&&(x.Object=yb);var ef=null==v.ci?null:v.ci.toString();null!=ef&&(x.Ol=ef);var Cb=null==v.cj?null:v.cj.toString();null!=Cb&&(x.Optgroup=Cb);var oc=null==v.ck?null:v.ck.toString();null!=oc&&(x.Option=oc);var vc=null==v.cl?null:v.cl.toString();null!=vc&&(x.P=vc);var nd=null==v.cm?null:v.cm.toString();null!=
nd&&(x.Param=nd);var id=null==v.cn?null:v.cn.toString();null!=id&&(x.Pre=id);var Nd=null==v.co?null:v.co.toString();null!=Nd&&(x.Q=Nd);var Ce=null==v.cp?null:v.cp.toString();null!=Ce&&(x.S=Ce);var af=null==v.cq?null:v.cq.toString();null!=af&&(x.Samp=af);var de=null==v.cr?null:v.cr.toString();null!=de&&(x.Script=de);var $f=null==v.cs?null:v.cs.toString();null!=$f&&(x.Select=$f);var ge=null==v.ct?null:v.ct.toString();null!=ge&&(x.Small=ge);var ze=null==v.cu?null:v.cu.toString();null!=ze&&(x.Span=ze);
var si=null==v.cv?null:v.cv.toString();null!=si&&(x.Strike=si);var sh=null==v.cw?null:v.cw.toString();null!=sh&&(x.Strong=sh);var dd=null==v.cx?null:v.cx.toString();null!=dd&&(x.Style=dd);var Lc=null==v.cy?null:v.cy.toString();null!=Lc&&(x.Sub=Lc);var Zd=null==v.cz?null:v.cz.toString();null!=Zd&&(x.Sup=Zd);var Ne=null==v.da?null:v.da.toString();null!=Ne&&(x.Tables=Ne);var Xc=null==v.db?null:v.db.toString();null!=Xc&&(x.Tbody=Xc);var lf=null==v.dc?null:v.dc.toString();null!=lf&&(x.Td=lf);var Kh=null==
v.dd?null:v.dd.toString();null!=Kh&&(x.Textarea=Kh);var bd=null==v.de?null:v.de.toString();null!=bd&&(x.Tfoot=bd);var fd=null==v.df?null:v.df.toString();null!=fd&&(x.Th=fd);var Ve=null==v.dg?null:v.dg.toString();null!=Ve&&(x.Thead=Ve);var rf=null==v.dh?null:v.dh.toString();null!=rf&&(x.Title=rf);var Ag=null==v.di?null:v.di.toString();null!=Ag&&(x.Tr=Ag);var ne=null==v.dj?null:v.dj.toString();null!=ne&&(x.Tt=ne);var kf=null==v.dk?null:v.dk.toString();null!=kf&&(x.U=kf);var kg=null==v.dl?null:v.dl.toString();
null!=kg&&(x.Ul=kg);var Af=null==v.dm?null:v.dm.toString();null!=Af&&(x.Var=Af);var Wf=null==v.dn?null:v.dn.toString();null!=Wf&&(x.Unknown=Wf);break;case 6:B="List";var vf=v.a;null!=vf&&(x.SessionID=vf);var De=v.b.toString();null!=De&&(x.MaxListLevel=De)}x.Table=B;return Sys.Serialization.JavaScriptSerializer.serialize(x)};d.d(U,"a",function(){return n});class n{static get E9(){null==n.b5a&&(n.b5a=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("UsageEditorLoggingIsDisabled"));return n.b5a}static get Bpg(){null==
n.AHd&&(n.AHd=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("WordUsageEditorLoggingIsEnabled"));return n.AHd}static aR(z){h.ULS.sendTraceTag(5822145,307,50,z)}static O7f(z){const v={};v.a=z;v.b=0;v.c=0;v.d=0;v.e=0;v.f=0;return v}static Cbk(z){n.E9||n.aR(m(0,z))}static oee(z){const v={};v.a=z;v.b=0;v.c=0;return v}static Cdk(z){n.E9||n.aR(m(1,z))}static N7f(z,v){const x={};x.c=r.a[z];x.a=v;return x}static Bbk(z,v){n.Bpg&&z&&(z.b=v,n.aR(m(5,z)))}static Kag(z){const v={};v.a=z;v.b=0;v.c=
0;v.d=0;v.e=0;v.f=0;v.g=0;v.h=0;v.i=0;v.j=0;v.k=0;v.l=0;v.m=0;return v}static Pck(z){n.E9||n.aR(m(3,z))}static Lag(z){const v={};v.a=z;v.b=0;v.c=0;v.d=0;v.e=0;return v}static Qck(z){n.E9||n.aR(m(4,z))}static hae(z,v){const x={};x.b=r.a[z];x.c=v;x.d=0;x.e=0;x.f=0;x.g=0;x.h=0;x.i=0;x.j=0;x.k=0;x.l=0;x.m=0;x.n=0;x.o=0;x.p=0;x.q=0;x.r=0;x.s=0;x.t=0;x.w=0;x.x=0;x.y=0;x.z=0;x.u=0;x.v=0;return x}static qbk(z,v){n.Bpg&&z&&(z.a=v,n.aR(m(2,z)))}static Akj(z){const v={};v.a=z;v.b=-1;return v}static Vbk(z){!n.E9&&
z&&0<=z.b&&n.aR(m(6,z))}}n.b5a=null;n.AHd=null;Object(K.a)(n,"UsageEditor",null,[])},334:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.body=this.contextId=this.revId=this.sourceTimestamp=this.source=this.id=null}}Object(K.a)(h,"Item",null,[])},335:function(K,U,d){d.d(U,"a",function(){return h});class h{constructor(e){h.assign(h,this,e)}static getTypeName(){return"AugLoop_Core_SchemaObject"}static getBaseTypes(){return[]}static getTypeNameFor(e){return e&&e.H_?e.H_.T_:
void 0}static getBaseTypesFor(e){return e&&e.H_&&e.H_.B_?e.H_.B_:[]}static getAllTypesFor(e){const r=h.getTypeNameFor(e);return r?[r,...h.getBaseTypesFor(e)]:[]}static matchesTypesFor(e,r){if(!Array.isArray(r)||0===r.length)return!0;const m=h.getTypeNameFor(e);e=h.getBaseTypesFor(e);for(const n of r)if(n===m||0<=e.indexOf(n))return!0;return!1}static assign(e,r,m){if(m)for(const n of Object.keys(m))r[n]=m[n];r.H_=e.H_;return r}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()}},336:function(K,U,d){d.d(U,
"a",function(){return h});K=d(0);class h{constructor(){this.te=this.eg=this.me=this.Tf=0}c2i(e){return e.te<this.eg&&this.te<e.eg&&e.me<this.Tf&&this.me<e.Tf}Rwb(e){return e.te>=this.te&&e.eg<=this.eg&&e.me>=this.me&&e.Tf<=this.Tf}U1i(e,r){return e>=this.V0f&&e<=this.nre&&r>=this.O0f&&r<=this.fre}eTa(){return 0>=this.fP||0>=this.PR}equals(e){return e.te===this.te&&e.eg===this.eg&&e.me===this.me&&e.Tf===this.Tf}clone(){return Object.assign(new h,{te:this.te,eg:this.eg,me:this.me,Tf:this.Tf})}toString(){return String.format("CellRange, rowFirst:{0}, rowLim:{1}, colFirst:{2}, colLim:{3}",
this.te,this.eg,this.me,this.Tf)}get fP(){return this.eg-this.te}get PR(){return this.Tf-this.me}get nre(){return this.eg-1}get fre(){return this.Tf-1}get V0f(){return this.te}get O0f(){return this.me}}Object(K.a)(h,"CellRange",null,[])},337:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}Object(K.a)(h,"OAuthResult",null,[])},338:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}h.DW="data-copystatus";h.TRa="data-copyfailedreason";h.Jp="data-clipservice-ccpid";h.version=
"data-clipservice-version";h.location="data-clipservice-location";h.QD="data-clipservice-dc";h.type="data-clipservice-type";h.uKe="data-clipservice-param";h.count="data-clipservice-count";h.WFa="data-clipservice-cut";h.UFa="data-clipservice-isEmptyPlaceholder";h.client="data-clipservice-client";h.KBi="data-clipboardasbytes-url";h.uQh="wacserver";h.sessionId="data-SessionId";h.Dlb="data-ShapeIds";h.slideId="data-SlideId";h.timeStamp="data-TimeStamp";h.rLj="data-willexpire";h.Xig="ClipboardAsImage";
h.Ky="data-pkey";Object(K.a)(h,"ClipServiceConstants",null,[])},339:function(K,U,d){d.d(U,"a",function(){return z});K=d(0);var h=d(32),e=d(51),r=d(18),m=d(34),n=d(460);class z{constructor(v,x,B,D){this.Rb=v;this.Rfb=x;this.tIa=B;this.BJ=D;if(!v)throw Error.argumentNull("m_graphIteratorFactory");if(!x)throw Error.argumentNull("m_outlineEditor");if(!B)throw Error.argumentNull("m_outlineElementNavigator");if(!D)throw Error.argumentNull("m_characterPropertiesEditor");}Thj(v,x,B){v=this.Xhj(v,x,B);x=new r.a;
for(const D of v)x.add(e.a.create(D));return x}Xhj(v,x,B){const D=new h.GraphIterator;D.set(x);x=new r.a;this.CVc(v,D,B,!1,x);return x}CVc(v,x,B,D,w){let J=null;if(x&&(J=x.Oi())){do{switch(J.type){case 12:break;case 35:D&&this.CVc(v,x,B,D,w);break;case 14:B&&this.CVc(v,x,B,D,w);break;default:this.CVc(v,x,B,D,w)}if(v===J.type&&12===v){if(null===J)throw Error("Could not cast node of NodeType.Paragraph to ParagraphNode");w.add(J)}}while(J=x.np());x.Cc()}}HYe(v,x,B){for(const D of x){if(12===v&&(D.DB||
D.Pla&&0===D.nz().length)){x=this.Rb.Lc(D);D.deleteParagraph();this.Rfb.nW(x,!0);this.tIa.yi(x);x=x.currentNode;const w=m.ParagraphReader.textLength(x);x=e.a.createTextRange(x,0,w);this.BJ.replaceTextRange(x,"")}B.push(...this.Thj(v,D,14===v).toArray())}}UMb(v,x,B){for(const D of x)this.HYe(v,D.Uj(),B)}}z.k9=(v,x,B=!1)=>{const D=()=>{if(x){var w=B?x.$yb():x;v(w);n.a.instance.Voh(D)}};n.a.instance.pTd(D);return D};Object(K.a)(z,"ODSLGraphHelper",null,[])},340:function(K,U,d){d.d(U,"a",function(){return D});
K=d(0);var h=d(1244),e=d(42),r=d(488),m=d(159),n=d(39),z=d(62),v=d(28),x=d(990),B=d(991);class D{constructor(w){this.KE=w}get node(){return this.KE}get propertySet(){return this.KE}get iy(){if(1074135132===this.KE.Xe)return 0;if(1074135137===this.KE.Xe)return 1;v.a.J(18354962,802,10,"Invalid AppType {0}",r.a[this.KE.Xe]);return-1}get id(){return 0===this.iy?this.propertySet.sa(n.a.b_,null)+this.shapeId.toString()+this.slideId.toString():this.propertySet.sa(n.a.b_,null)}get QUf(){return this.propertySet.sa(e.a.rUd,
null)}get visibility(){return this.propertySet.sa(e.a.X_b,!1)}get width(){return this.propertySet.sa(e.a.eli,320)}get row(){return this.propertySet.sa(e.a.dli,0)}get Nlg(){return this.propertySet.sa(m.a.isForUILessAction,!1)}get xya(){return this.propertySet.sa(e.a.dtb,null)}get version(){return this.propertySet.sa(e.a.$Jc,null)}get store(){return this.propertySet.sa(e.a.ZJc,null)}get storeType(){return this.propertySet.eb(n.a.U_b)}get ownerAddinSolutionId(){return this.propertySet.sa(n.a.udh,null)}get sharedRuntimeId(){return this.propertySet.sa(m.a.sharedRuntimeId,
null)}get settings(){const w={};x.a(this.node,(J,G)=>{B.b(G,w)});return w}get slideId(){return 0===this.iy?z.a.Uy(this.KE.eb(n.a.sid),this.KE.eb(n.a.cid)):null}get shapeId(){const w=Object(h.a)(4,this.KE);return 0===this.iy&&w?w.get_shapeId():0}get ownerAddinStoreType(){return this.propertySet.sa(n.a.ownerAddinStoreType,null)}get Ctb(){return this.propertySet.sa(n.a.Ctb,-1)}get R7a(){return this.propertySet.sa(n.a.R7a,null)}}Object(K.a)(D,"AppReader",null,[485])},341:function(K,U,d){d.d(U,"a",function(){return e});
K=d(0);var h=d(27);class e{constructor(){this.currentDocumentPath=h.AFrameworkApplication.fa.Ha("EditDocInClientUrl")}}Object(K.a)(e,"SmartLookupApplicationInterface",null,[])},342:function(K,U,d){d.d(U,"a",function(){return e});K=d(0);var h=d(1050);class e{constructor(r){this.Wq=new h.a;this.J1g=r}ZI(r){const m=r.id;let n=null;this.Wq.Fb(m)?n=this.Wq.ga(m):(this.J1g&&(n=this.J1g(r,()=>{this.O5k(m)})),n&&this.Wq.$(m,n));return n}dJ(r){r=r.id;return this.Wq.Fb(r)?this.Wq.ga(r):null}O5k(r){this.Wq.remove(r)}}
Object(K.a)(e,"ShapeComponentViewManager",null,[191])},350:function(K,U,d){var h=d(18),e=d(115),r=d(510),m=d(150),n=d(231);K=d(0);var z=d(211),v=d(28);class x{constructor(O,S,T,ca){this.type=O;this.stops=S;this.angle=T;this.ONk=ca}yV(){const O=z.b(this.stops,S=>S.yV()).join(",");if(0===this.type)return String.format("linear-gradient({0}deg, {1})",this.angle,O);if(1===this.type||2===this.type)return String.format("radial-gradient(circle at {0}, {1})",this.ONk.yV(),O);v.a.J(18392962,822,15,String.format("Unexpected gradient type encountered: {0}.",
this.type));return n.Color.auto.yV()}static createLinearGradient(O,S){return new x(0,O,S,null)}static jNi(O,S){return new x(1,O,0,S)}}Object(K.a)(x,"GradientFill",null,[]);class B{constructor(O,S){this.left=O;this.top=S}yV(){return String.format("{0}% {1}%",this.left,this.top)}}Object(K.a)(B,"GradientPathCenter",null,[]);class D{constructor(O,S){this.color=O;this.position=S}yV(){return String.format("{0} {1}%",this.color.yV(),this.position)}}Object(K.a)(D,"GradientStop",null,[]);d.d(U,"a",function(){return w});
d.d(U,"g",function(){return J});d.d(U,"e",function(){return G});d.d(U,"b",function(){return M});d.d(U,"c",function(){return N});d.d(U,"f",function(){return R});d.d(U,"d",function(){return C});const w=O=>{O?(O=e.a(O),O=Object.assign(new r.a,{blipFillField:O.blipFillField||null,gradFillField:O.gradFillField||null,grpFillField:O.grpFillField||null,noFillField:O.noFillField||null,pattFillField:O.pattFillField||null,solidFillField:O.solidFillField||null})):O=null;return O},J=O=>{m.Box4ColorHelper.PSa(O)},
G=O=>{O=e.a(O);return!O||!O.blipFillField&&!O.gradFillField&&!O.grpFillField&&!O.noFillField&&!O.pattFillField&&!O.solidFillField},M=O=>{m.Box4ColorHelper.PSa(O)},N=O=>{M(O);O&&(O.cell3DField=null,O.extLstField=null,O.lnBField=null,O.lnBlToTrField=null,O.lnLField=null,O.lnRField=null,O.lnTField=null,O.lnTlToBrField=null)},R=(O,S)=>{if(!O)return null;var T=O.gsLstField;if(T){var ca=new h.a;for(const L of T)T=m.Box4ColorHelper.YRc(L),m.Box4ColorHelper.Rbb(T)?v.a.J(18397184,822,15,"Encountered invalid gradient stop color."):
ca.add(new D(m.Box4ColorHelper.UH(T,S),L.posField/1E3));S=ca.toArray()}else S=null;if(O.linField)return ca=90,O.linField.angFieldSpecified&&(ca=(O.linField.angField/6E4+90)%360),x.createLinearGradient(S,ca);if(O.pathField)return ca=new B(50,50),O.pathField.fillToRectField&&(ca=new B(O.pathField.fillToRectField.lField/1E3,O.pathField.fillToRectField.tField/1E3)),x.jNi(S,ca);v.a.J(18397154,822,50,"Gradient fill's linField and pathField are both null");return x.createLinearGradient(S,90)},C=O=>e.b(O)},
354:function(K,U,d){K=d(0);var h=d(392),e=d(269),r=d(672),m=d(29),n=d(531);class z{}Object(K.a)(z,"ProofingFeedbackLoopRequestObject",null,[]);var v=d(532),x=d(35),B=d(530);d.d(U,"a",function(){return D});class D extends r.a{constructor(w,J,G,M,N=null){super(J);this.u7=w;this.E0h=G;this.V4h=M;this.yif=!1;this.Oa=N;this.errorType=1===(this.u7.CritiqueActions&1)?0:1}get proofingType(){return n.b(this.u7)}get traceId(){return this.u7.TraceId}get WAf(){return this.u7.AnnotationId}get typeId(){return this.u7.TypeId}get ON(){return this.u7}get suggestions(){const w=
[];if(this.u7.Suggestions)for(const J of this.u7.Suggestions)w.push(J.Text);return w}get metadata(){const w=[];if(this.u7.Metadata&&0<this.u7.Metadata.length)for(const J of this.u7.Metadata)J.Name&&J.Value&&w.push(J);return w}UMa(w,J=0){this.xqf.track(()=>Object.assign(new v.a,{E:2,T:this.proofingType,A:w,I:J,G:this.typeId}));if(this.E0h){var G=e.a.He(this.lcid);let M="";G?M=G.name:h.ULS.sendTraceTag(36316369,375,50,"Lcid results in null CultureInfo: [LCID: {0}]",this.lcid);G=null;h.ULS.sendTraceTag(39416218,
375,50,"Sending proofing context with feedback loop API");G=Object.assign(new z,{AppId:B.a[m.App.mode]+"_online",TraceId:this.traceId,LanguageId:M,CritiqueTypeId:this.typeId,EventId:this.Rtk(w),FlaggedText:this.token,SuggestionText:this.Utj(w),PreContextBegin:this.Gaa,PostContextEnd:this.zKa,OriginalText:this.originalText,Suggestions:this.suggestions,CritiquePriority:this.u7.Priority,Metadata:this.u7.Metadata});14!==G.EventId&&this.V4h.lhl(G)}}Rtk(w){switch(w){case x.a.kla:return 0;case x.a.$ge:return 1;
case x.a.NDa:return 3;case x.a.Pza:return 4;case x.a.Qza:return 5;case x.a.Rza:return 6;case x.a.iwb:return 13;default:return 14}}Utj(w){switch(w){case x.a.Pza:return this.suggestions[0];case x.a.Qza:return this.suggestions[1];case x.a.Rza:return this.suggestions[2];case x.a.BMa:return this.suggestions[3];case x.a.CMa:return this.suggestions[4];default:return""}}get vFa(){return this.yif}set vFa(w){this.yif=w}}Object(K.a)(D,"EditorServiceErrorDetails",r.a,[295,296])},355:function(K,U,d){var h=d(272),
e=d(808),r=d(1274),m=d(47),n=d(209),z=d(27);K=d(0);class v{constructor(){this.g=this.b=0;this.hex=null;this.r=0}}Object(K.a)(v,"RecentColor",null,[]);var x=d(231),B=d(232),D=d(233),w=d(264),J=d(1074),G=d(546),M=d(28);d.d(U,"f",function(){return N});d.d(U,"e",function(){return R});d.d(U,"d",function(){return C});d.d(U,"c",function(){return O});d.d(U,"g",function(){return S});d.d(U,"b",function(){return T});d.d(U,"a",function(){return ca});d.d(U,"h",function(){return L});const N=(Z,fa,aa,ja,I,sa,ka)=>
R(Z,fa,aa,ja,I,sa,ka,!1),R=(Z,fa,aa,ja,I,sa,ka,Ma)=>{fa=Object.assign(new h.a,{Id:fa,ControlsId:aa,Title:ResourceStrings.L_ThemeFontColor,ControlList:[]});ja=Object.assign(new e.a,{Id:ja,ExternalId:I,McuExternalId:String.format("{0}MCU",I),McuLayout:!0,Command:sa,Width:10});if(Z)if(I=[],1===ka||2===ka){Ma=(new J.a).Rcj(Z);({themeColors:Z,uIh:ka}=da(Ma,Z));for(var Ea=0;6>Ea;Ea++)for(var ma=0;ma<Z.length;ma++){sa=I;aa=sa.push;var va=void 0,Ca=void 0;va=Ma;var oa=Z[ma][Ea];Ca=Z[ma][0];var Da=ka[ma],
ta=Ea,ha=ma;oa=m.a.tw(oa.r,2)+m.a.tw(oa.g,2)+m.a.tw(oa.b,2);({ZMc:va,pQb:Ca}=va.X9d(Ca,oa,Da,ta,ha));oa=Object.assign(new r.a,{Color:"#"+va,DisplayColor:"#"+oa,Alt:Ca});aa.call(sa,oa)}}else for(Ma=(new J.a).l5f(Z,Ma),{themeColors:Z,uIh:ka}=da(Ma,Z),Ea=0;6>Ea;Ea++)for(ma=0;ma<Z.length;ma++)sa=I,aa=sa.push,va=Ma,oa=Z[ma][Ea],Ca=Z[ma][0],Da=ka[ma],ta=Ea,ha=ma,oa=m.a.tw(oa.r,2)+m.a.tw(oa.g,2)+m.a.tw(oa.b,2),{ZMc:Ca,pQb:va}=va.X9d(Ca,oa,Da,ta,ha),{Pcl:Ca,Ffl:va,pQb:oa}={Pcl:oa,Ffl:Ca,pQb:va},oa=Object.assign(new r.a,
{Color:va,DisplayColor:"#"+Ca,Alt:oa}),aa.call(sa,oa);else I=null;ja.Colors=I;Array.add(fa.ControlList,ja);return fa},C=(Z,fa,aa,ja,I,sa)=>{Z=Object.assign(new h.a,{Id:Z,ControlsId:fa,Title:ResourceStrings.L_StandardFontColor,ControlList:[]});aa=Object.assign(new e.a,{Id:aa,ExternalId:ja,Command:I,Width:10,Colors:[]});sa?(aa.Colors.push(Object.assign(new r.a,{Color:"0000C0",Alt:m.a.xe(ResourceStrings.L_FontColorDarkRed),DisplayColor:"#C00000"})),aa.Colors.push(Object.assign(new r.a,{Color:"0000FF",
Alt:m.a.xe(ResourceStrings.L_FontColorRed),DisplayColor:"#FF0000"})),aa.Colors.push(Object.assign(new r.a,{Color:"00C0FF",Alt:m.a.xe(ResourceStrings.L_FontColorOrange),DisplayColor:"#FFC000"})),aa.Colors.push(Object.assign(new r.a,{Color:"00FFFF",Alt:m.a.xe(ResourceStrings.L_FontColorYellow),DisplayColor:"#FFFF00"})),aa.Colors.push(Object.assign(new r.a,{Color:"50D092",Alt:m.a.xe(ResourceStrings.L_FontColorLightGreen),DisplayColor:"#92D050"})),aa.Colors.push(Object.assign(new r.a,{Color:"50B000",
Alt:m.a.xe(ResourceStrings.L_FontColorDarkGreen),DisplayColor:"#00B050"})),aa.Colors.push(Object.assign(new r.a,{Color:"F0B000",Alt:m.a.xe(ResourceStrings.L_FontColorLightBlue),DisplayColor:"#00B0F0"})),aa.Colors.push(Object.assign(new r.a,{Color:"C07000",Alt:m.a.xe(ResourceStrings.L_FontColorBlue),DisplayColor:"#0070C0"})),aa.Colors.push(Object.assign(new r.a,{Color:"602000",Alt:m.a.xe(ResourceStrings.L_FontColorDarkBlue),DisplayColor:"#002060"})),aa.Colors.push(Object.assign(new r.a,{Color:"A03070",
Alt:m.a.xe(ResourceStrings.L_FontColorPurple),DisplayColor:"#7030A0"}))):(aa.Colors.push(Object.assign(new r.a,{Color:"#C00000",Alt:m.a.xe(ResourceStrings.L_FontColorDarkRed),DisplayColor:"#C00000"})),aa.Colors.push(Object.assign(new r.a,{Color:"#FF0000",Alt:m.a.xe(ResourceStrings.L_FontColorRed),DisplayColor:"#FF0000"})),aa.Colors.push(Object.assign(new r.a,{Color:"#FFC000",Alt:m.a.xe(ResourceStrings.L_FontColorOrange),DisplayColor:"#FFC000"})),aa.Colors.push(Object.assign(new r.a,{Color:"#FFFF00",
Alt:m.a.xe(ResourceStrings.L_FontColorYellow),DisplayColor:"#FFFF00"})),aa.Colors.push(Object.assign(new r.a,{Color:"#92D050",Alt:m.a.xe(ResourceStrings.L_FontColorLightGreen),DisplayColor:"#92D050"})),aa.Colors.push(Object.assign(new r.a,{Color:"#00B050",Alt:m.a.xe(ResourceStrings.L_FontColorDarkGreen),DisplayColor:"#00B050"})),aa.Colors.push(Object.assign(new r.a,{Color:"#00B0F0",Alt:m.a.xe(ResourceStrings.L_FontColorLightBlue),DisplayColor:"#00B0F0"})),aa.Colors.push(Object.assign(new r.a,{Color:"#0070C0",
Alt:m.a.xe(ResourceStrings.L_FontColorBlue),DisplayColor:"#0070C0"})),aa.Colors.push(Object.assign(new r.a,{Color:"#002060",Alt:m.a.xe(ResourceStrings.L_FontColorDarkBlue),DisplayColor:"#002060"})),aa.Colors.push(Object.assign(new r.a,{Color:"#7030A0",Alt:m.a.xe(ResourceStrings.L_FontColorPurple),DisplayColor:"#7030A0"})));Array.add(Z.ControlList,aa);return Z},O=(Z,fa,aa,ja,I,sa,ka)=>{fa=Object.assign(new h.a,{Id:fa,ControlsId:aa,Title:ResourceStrings.L_RecentColors,ControlList:[]});ja=Object.assign(new e.a,
{Id:ja,ExternalId:I,Command:sa,Width:10,Colors:[]});if(ka)for(ka=0;Z&&ka<Z.length&&Z[ka];ka++)I=Z[ka],ja.Colors.push(Object.assign(new r.a,{Color:I.hex,Alt:m.a.xe(I.hex),DisplayColor:I.hex}));else for(ka=0;Z&&ka<Z.length&&Z[ka];ka++)I=Z[ka],ja.Colors.push(Object.assign(new r.a,{Color:"#"+I.hex,Alt:m.a.xe("#"+I.hex),DisplayColor:"#"+I.hex}));Array.add(fa.ControlList,ja);return fa},S=(Z,fa)=>{if(!fa)return Z;var aa=new v;aa.hex=fa;const ja=[];let I=0;ja[I++]=aa;for(aa=0;Z&&aa<Z.length&&10>aa&&10>I&&
Z[aa];aa++)Z[aa].hex!==fa&&(ja[I++]=Z[aa]);return ja},T=(Z,fa,aa,ja,I,sa,ka,Ma)=>{Z=Object.assign(new h.a,{Id:Z,ControlsId:fa,DisplayMode:"Menu16",ControlList:[]});aa=Object.assign(new n.a,{Command:aa,LabelText:ja,Image16by16:z.AFrameworkApplication.Cm,Image16by16Class:ka,Id:I,ExternalId:sa,KeyTip:Ma});Array.add(Z.ControlList,aa);return Z},ca=(Z,fa,aa,ja,I,sa,ka,Ma)=>{Z=Object.assign(new h.a,{Id:Z,ControlsId:fa,DisplayMode:"Menu16",ControlList:[]});aa=Object.assign(new n.a,{Command:aa,LabelText:ja,
Image16by16:z.AFrameworkApplication.Cm,Image16by16Class:ka,Id:I,ExternalId:sa,KeyTip:Ma});Array.add(Z.ControlList,aa);return Z},L=(Z,fa,aa)=>{for(let va=0;va<Z.MenuSectionList.length;va++){var ja=Z.MenuSectionList[va],I=ja.ControlList;if(I&&0<I.length&&(I=I[0]))if(fa)if(ja.Id===G.a.themeColors&&aa){var sa=D.i(fa.PD)||"";ja=aa;var ka=I.Colors,Ma="#";if(ka&&ka.length)if(m.a.Xa(sa))M.a.J(523531867,820,10,"selectedFontColor should not be empty in FindSelectedThemeColor");else for(var Ea=0;Ea<ka.length;Ea++){var ma=
ka[Ea].Color;if(!m.a.Xa(ma)&&(ma=(ma=B.a.parse(ka[Ea].Color))?ma.bwc():w.SchemeColor.parse(ka[Ea].Color),ja&&ma&&ma.jUe(ja)&&ma.rua&&(ma=D.i(ma.lQ),ma.toLowerCase()===sa.toLowerCase()))){Ma=ka[Ea].Color;break}}ja=Ma;I.SelectedColorId=ja}else{ka=D.i(D.g(fa.PD))||"";ja=I.Colors;sa="#";if(ja&&ja.length)if(m.a.Xa(ka))M.a.J(523531868,820,10,"selectedFontColor should not be empty in FindSelectedStandardColor");else for(Ma=0;Ma<ja.length;Ma++)if(Ea=ja[Ma].DisplayColor,!m.a.Xa(Ea)&&Ea.replace("#","").toLowerCase()===
ka.toLowerCase()){sa=ja[Ma].Color;break}ja=sa;I.SelectedColorId=ja}else I.SelectedColorId="#"}},da=(Z,fa)=>{let aa;aa=Array(10);aa[0]=Z.zL(x.Color.$i(fa.PresetSchemeColorMapping.Background1));aa[1]=Z.zL(x.Color.$i(fa.PresetSchemeColorMapping.Text1));aa[2]=Z.zL(x.Color.$i(fa.PresetSchemeColorMapping.Background2));aa[3]=Z.zL(x.Color.$i(fa.PresetSchemeColorMapping.Text2));aa[4]=Z.zL(x.Color.$i(fa.PresetSchemeColorMapping.Accent1));aa[5]=Z.zL(x.Color.$i(fa.PresetSchemeColorMapping.Accent2));aa[6]=Z.zL(x.Color.$i(fa.PresetSchemeColorMapping.Accent3));
aa[7]=Z.zL(x.Color.$i(fa.PresetSchemeColorMapping.Accent4));aa[8]=Z.zL(x.Color.$i(fa.PresetSchemeColorMapping.Accent5));aa[9]=Z.zL(x.Color.$i(fa.PresetSchemeColorMapping.Accent6));Z=Array(10);Z[0]=ResourceStrings.l_ThemeLabel1;Z[1]=ResourceStrings.l_ThemeLabel2;Z[2]=ResourceStrings.l_ThemeLabel3;Z[3]=ResourceStrings.l_ThemeLabel4;Z[4]=ResourceStrings.l_ThemeLabel5;Z[5]=ResourceStrings.l_ThemeLabel6;Z[6]=ResourceStrings.l_ThemeLabel7;Z[7]=ResourceStrings.l_ThemeLabel8;Z[8]=ResourceStrings.l_ThemeLabel9;
Z[9]=ResourceStrings.l_ThemeLabel10;return{themeColors:aa,uIh:Z}}},382:function(K,U,d){d.d(U,"a",function(){return r});var h=d(47),e=d(27);const r=m=>{if(h.a.Xa(m))return!1;var n=e.AFrameworkApplication.fa.Ha("PPTDisabledChangeGates");return n?(n=n.split(";"))&&0<n.length?0>Array.indexOf(n,m):!0:!1}},383:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}h.yMf="CU";h.lEi="CS";h.iEi="CE";h.Yqe="KP";h.jFl="TI";h.Obk="L";Object(K.a)(h,"CharacterBlockTrackerKeys",null,[])},384:function(K,
U,d){d.d(U,"a",function(){return e});K=d(0);var h=d(36);class e{constructor(r,m){this.Flight=this.BaseDocQuerySignature=null;this.BaseDocQuerySignature=r;this.Flight=m}serialize(){return h.c([this.pl(),this])}}Object(K.a)(e,"ACommonHandlerRequest",null,[])},385:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}h.wha=1E5;Object(K.a)(h,"ViewConstants",null,[])},386:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}h.jwc="ToolbarButton";h.oQb="ToolbarButtonHome";h.insertPicture=
"InsertPicture";h.V2e="SlideNavigationDesignMode";h.xkb="Retrigger";h.refresh="Refresh";h.typing="Typing";h.GSf="DesignElementsDeleted";h.qYd="ChangeSlideSize";h.qtb="ApplyTheme";h.Q2e="SlideChangeLayout";h.$na="NewSlide";h.kYd="ChangeIconInSmartArt";h.Fub="ChangeIcon";h.insertTable="InsertTable";h.gya="PasteTable";h.b_c="InsertChart";h.KUd="ApplyReplaceObject";h.moreIdeas="MoreIdeas";h.newDocument="NewDocument";h.e3d="DesignTab";h.makeItVisual="MakeItVisual";h.lKa="PasteText";h.Y_d="ConvertedToPPT";
h.VTd="AgendaToPPT";Object(K.a)(h,"DesignerTrigger",null,[])},391:function(K,U,d){K=d(0);var h=d(55),e=d(27),r=d(47),m=d(106),n=d(1272),z=d(7),v=d(1244),x;(function(Z){Z[Z.none=0]="none";Z[Z.noSystemClipboardAccess=1]="noSystemClipboardAccess";Z[Z.cutCopyDisallowed=2]="cutCopyDisallowed";Z[Z.pasteDisallowed=3]="pasteDisallowed";Z[Z.invalidPasteContext=4]="invalidPasteContext";Z[Z.invalidCcpOperation=5]="invalidCcpOperation";Z[Z.multiSlideCcpDisallowed=6]="multiSlideCcpDisallowed";Z[Z.pastedHtmlLengthExceeded=
7]="pastedHtmlLengthExceeded";Z[Z.tooManyShapesAfterPaste=8]="tooManyShapesAfterPaste";Z[Z.noShapesPasted=9]="noShapesPasted";Z[Z.invalidImagePasteArgs=10]="invalidImagePasteArgs";Z[Z.invalidClipboardData=11]="invalidClipboardData";Z[Z.invalidCopiedShapes=12]="invalidCopiedShapes";Z[Z.invalidCopiedSlides=13]="invalidCopiedSlides";Z[Z.invalidHtmlContent=14]="invalidHtmlContent";Z[Z.textEditFailed=15]="textEditFailed";Z[Z.clipServiceDataInvalid=16]="clipServiceDataInvalid";Z[Z.crossDCPasteDisallowed=
17]="crossDCPasteDisallowed";Z[Z.imageTooLarge=18]="imageTooLarge";Z[Z.noAvailablePasteHandler=19]="noAvailablePasteHandler";Z[Z.noAvailableCutCopyHandler=20]="noAvailableCutCopyHandler";Z[Z.cutCopyHandlerFailed=21]="cutCopyHandlerFailed";Z[Z.systemClipboardCopyFailed=22]="systemClipboardCopyFailed";Z[Z.copyObjectEmpty=23]="copyObjectEmpty";Z[Z.tableInvalid=24]="tableInvalid";Z[Z.copyObjectHasDeferredContent=25]="copyObjectHasDeferredContent";Z[Z.userOffline=26]="userOffline";Z[Z.picklingPasteFailedDueToMaxSizeLimit=
27]="picklingPasteFailedDueToMaxSizeLimit";Z[Z.picklingInvalidCopyData=28]="picklingInvalidCopyData";Z[Z.systemClipboardAccessFailure=29]="systemClipboardAccessFailure";Z[Z.chunkUploaderFailure=30]="chunkUploaderFailure";Z[Z.pasteCancelledByUser=31]="pasteCancelledByUser";Z[Z.cutCopyIRMRestricted=32]="cutCopyIRMRestricted"})(x||(x={}));Object(K.b)("CcpFailure",x);var B=d(954),D=d(115),w=d(28),J=d(338),G;(function(Z){Z[Z.none=0]="none";Z[Z.text=1]="text";Z[Z.shape=2]="shape";Z[Z.textbox=3]="textbox";
Z[Z.normalShape=4]="normalShape";Z[Z.image=5]="image";Z[Z.table=6]="table";Z[Z.chart=7]="chart";Z[Z.video=8]="video";Z[Z.list=9]="list";Z[Z.ink=10]="ink";Z[Z.addin=11]="addin";Z[Z.smartArt=12]="smartArt";Z[Z.group=13]="group";Z[Z.placeholder=14]="placeholder";Z[Z.line=15]="line";Z[Z.activeX=16]="activeX";Z[Z.oleObject=17]="oleObject";Z[Z.media=18]="media";Z[Z.slide=19]="slide";Z[Z.mixed=20]="mixed"})(G||(G={}));Object(K.b)("ClipboardContentType",G);var M;(function(Z){Z[Z.keyboard=0]="keyboard";Z[Z.menu=
1]="menu";Z[Z.floatie=2]="floatie";Z[Z.ribbon=3]="ribbon"})(M||(M={}));Object(K.b)("ClipboardMethod",M);var N;(function(Z){Z[Z.copy=0]="copy";Z[Z.cut=1]="cut";Z[Z.paste=2]="paste"})(N||(N={}));Object(K.b)("ClipboardOperation",N);var R;(function(Z){Z[Z.other=0]="other";Z[Z.pptOnline=1]="pptOnline";Z[Z.pptOnlineSameSession=2]="pptOnlineSameSession";Z[Z.pptOnlineCrossSession=3]="pptOnlineCrossSession";Z[Z.wordOnline=4]="wordOnline";Z[Z.xlOnline=5]="xlOnline";Z[Z.oneNoteOnline=6]="oneNoteOnline";Z[Z.pptWin32=
7]="pptWin32";Z[Z.wordWin32=8]="wordWin32";Z[Z.xlWin32=9]="xlWin32";Z[Z.oneNoteWin32=10]="oneNoteWin32";Z[Z.googleDocs=11]="googleDocs";Z[Z.pptDesktop=12]="pptDesktop";Z[Z.pptDesktopWithDataUpload=13]="pptDesktopWithDataUpload"})(R||(R={}));Object(K.b)("ClipboardSource",R);class C{constructor(){this.data={};this.OEf=!1;this.imb=null}}Object(K.a)(C,"TelemetryEntry",null,[]);var O=d(1071),S=d(439),T=d(43),ca=d(30),L=d(72);d.d(U,"a",function(){return da});class da{constructor(Z,fa,aa,ja,I,sa,ka,Ma,Ea,
ma,va,Ca){this.Kyg=h.a.iz;this.SXg=this.CFg=this.$6c="";this.FR=Z;this.gR=fa;this.Xv=new L.a;this.iaa=new L.a;ja.MQa(Object(z.a)(this,this.TMe,"onRevisionProcessedOnServer"));I.gja(Object(z.a)(this,this.FHl,"trackSlideCcpRevision"));sa.gja(Object(z.a)(this,this.EHl,"trackShapeCcpRevision"));ka.gja(Object(z.a)(this,this.BHl,"trackParagraphCcpRevision"));Ma.gja(Object(z.a)(this,this.AHl,"trackNotesCcpRevision"));Ea&&Ea.gja(Object(z.a)(this,this.CHl,"trackPresentationCcpRevision"));this.yH=va;this.ia=
ma;this.pxg=aa.Eud;this.Uv=Ca;if(Z=e.AFrameworkApplication.Od)this.CFg=Object(v.a)(String,Z.Host)||"",this.SXg=Object(v.a)(String,Z.Ring)||"",this.$6c=Object(v.a)(String,Z.WACDatacenter)||""}$Bb(Z){return this.Xv.Fb(Z)}hC(Z,fa){r.a.Xa(fa)||(this.$Bb(fa)?da.contentType in this.Xv.ga(fa).data&&!this.MUj(fa,Z)||this.jW(da.contentType,G[Z],fa):w.a.J(50393377,826,15,"attempted to update clipboard telemetry before tracking started "+fa))}Dab(Z,fa){if(!this.Xv.Fb(Z))return null;let aa=null;if(this.Xv.ga(Z)&&
!(fa in this.Xv.ga(Z).data))switch(fa){case da.contentType:aa="none";break;case da.source:aa="other"}return aa?aa:this.Xv.ga(Z).data[fa].toString()}QUc(Z){return this.Dab(Z,da.contentType)}d5f(Z){return this.Dab(Z,da.source)}tcj(Z){return this.Dab(Z,da.operation)}Ybc(Z){return"xlOnline"===this.d5f(Z)&&"chart"===this.QUc(Z)}b3c(Z){return"slide"===this.QUc(Z)&&"paste"===this.tcj(Z)}pMk(Z){const fa=G;for(let ja in fa){var aa=fa[ja];if(ja.toLowerCase()===Z.toLowerCase())return aa}return 0}qMk(Z){const fa=
R;for(let ja in fa){var aa=fa[ja];if(ja.toLowerCase()===Z.toLowerCase())return aa}return 0}MUj(Z,fa){Z=this.pMk(this.Xv.ga(Z).data[da.contentType].toString());return fa>Z}Yw(Z,fa){r.a.Xa(fa)||(this.$Bb(fa)?da.source in this.Xv.ga(fa).data&&!this.J3j(fa,Z)||this.jW(da.source,R[Z],fa):w.a.J(50393379,826,15,"attempted to update clipboard telemetry before tracking started "+fa))}J3j(Z,fa){Z=this.qMk(this.Xv.ga(Z).data[da.source].toString());return fa>Z}ji(Z,fa,aa){r.a.Xa(aa)||this.jW(Z,fa,aa)}uP(Z,fa,
aa){const ja=T.a.Kb&&!r.a.Xa(T.a.Kb.actionName)?T.a.Kb.actionName:aa,I=m.a.create().toString();this.Xv.$(I,Object.assign(new C,{imb:this.FR.Ii("UserAction","ClipboardTelemetry")}));this.jW(da.RIf,I,I);this.jW(da.actionName,ja,I);this.jW("ActualActionName",aa,I);this.jW("CcpOperation",N[Z],I);this.jW("CcpMethod",M[fa],I);this.jW("CcpBrowser",this.Kyg,I);this.jW("CcpHost",this.CFg,I);this.jW("CcpDatacenter",this.$6c,I);this.jW("CcpRing",this.SXg,I);w.a.J(51179864,826,50,"start telemetry tracking. browser: {0}; CcpCorrelation: {1}; method: {2}; operation: {3}; actionName: {4}",
this.Kyg,I,M[fa],N[Z],ja);return I}Mg(Z,fa,aa=0){if(r.a.Xa(fa))w.a.J(51478666,826,15,"attempted to end telemetry tracking for empty correlation");else if(r.a.Xa(fa)||!this.$Bb(fa))w.a.J(51478669,826,15,"attempted to end telemetry tracking for invalid correlation id: {0}",fa);else{var ja=this.Xv.ga(fa);this.jW("CcpTotalMs",ja.imb.dr.toString(),fa);this.jW(da.SIf,Z.toString(),fa);0!==aa&&(this.jW("CcpFailureReason",x[aa],fa),this.Ybc(fa)?16===aa?this.yH.fba(ResourceStrings.l_CopyErrorCalloutTitle,ResourceStrings.l_CopyErrorCalloutMessage,
!1,null,!1,null,0,0,null,null,!0,da.oub,!1,null):(Z=Object.assign(new S.a(!0),{Wb:fa}),this.yH.fba(ResourceStrings.l_CopyPasteErrorCalloutTitle,ResourceStrings.l_CopyPasteErrorCalloutMessage,!0,CommonUIStrings.l_CalloutNotificationPButtonLabel,!0,CommonUIStrings.l_CalloutNotificationSButtonLabel,ca.a.TNf,ca.a.c0d,null,Z,!0,da.oub,!1,null)):25===aa&&(w.a.J(523298057,826,15,"Attempted to paste deferred content/slide on another deck with correlation: {0}",fa),this.yH.fba(ResourceStrings.l_DeferredContentPasteDialogTitle,
ResourceStrings.l_DeferredContentPasteDialogMessage,!1,null,!1,null,0,0,null,null,!1,da.oub,!1,null)));w.a.J(50733397,826,50,D.c(ja.data));this.Ybc(fa)||this.b3c(fa)||this.Xv.remove(fa)}}Rol(Z,fa){r.a.Xa(fa)||(this.Yw(0,fa),this.wyh(Z,fa,0))}wyh(Z,fa,aa){if(Z){if(aa>=O.a.iLc)throw Error.create(String.format("Exceeds the maximum recursions ({0}).",O.a.iLc));if(1===Z.nodeType){for(var ja=Z.firstChild;ja;)this.wyh(ja,fa,aa+1),ja=ja.nextSibling;this.P_e(Z,fa)}}}P_e(Z,fa){const {ClipboardHelper:aa}=d(726);
if(!r.a.Xa(fa))if(!this.$Bb(fa))w.a.J(50393415,826,15,"attempted to update clipboard telemetry before tracking started "+fa);else if(Z)if("head"===Z.tagName.toLowerCase()){var ja=this.gR.sZf(Z);r.a.Xa(ja)||this.yol(ja,fa)}else{ja=0;var I=Z.getAttribute(J.a.sessionId);I?ja=aa.zrg(I.toString())?2:3:Z.getAttribute(B.a.mRf)?ja=5:Z.getAttribute(B.a.nRf)||Z.getAttribute(B.a.rRf)?ja=1:Z.id&&Z.id.startsWith&&Z.id.startsWith(B.a.Vdg)&&(ja=11);if(Z.className&&Z.className.split)for(const sa of Z.className.split(" "))if(sa.startsWith(h.a.K0b)&&
sa.length===h.a.K0b.length+1&&(Z=parseInt(r.a.substring(sa,sa.length-1,sa.length)),isNaN(Z)||this.jW("CcpSourceBrowser",n.a[Z],fa)),0===ja)if(sa.startsWith(B.a.Igh))ja=1;else if(sa.startsWith(B.a.xch))ja=6;else if(sa.startsWith(B.a.PQh))ja=4;else if(sa===B.a.g5g||sa===B.a.h5g)ja=8,this.hC(9,fa);0!==ja&&this.Yw(ja,fa)}}yol(Z,fa){switch(Z){case "PowerPoint.Slide":this.Yw(7,fa);break;case "Word.Document":this.Yw(8,fa);break;case "Excel.Sheet":this.Yw(9,fa);break;case "OneNote.File":this.Yw(10,fa)}}jW(Z,
fa,aa){this.Xv.Fb(aa)&&(this.Xv.ga(aa).data[Z]=fa)}TMe(Z,fa){fa.FD&&!r.a.Xa(fa.FD.Id)&&this.iaa.Fb(fa.FD.Id)&&this.YWf(fa.FD.Id,!fa.FD.Error,fa.FD.Error?fa.FD.Error.Code:0)}FHl(Z,fa){this.nwc(aa=>{let ja=null;if(aa=Object(v.a)(118,aa.node))ja=aa.Wb,aa.Wb=null;return ja},fa)}EHl(Z,fa){this.nwc(aa=>{let ja=null;if(aa=Object(v.a)(4,aa.node))ja=aa.Wb,aa.Wb=null;return ja},fa)}BHl(Z,fa){this.nwc(aa=>{let ja=null;if(aa=Object(v.a)(5,aa.node))ja=aa.Wb,aa.Wb=null;return ja},fa)}AHl(Z,fa){this.nwc(aa=>{let ja=
null;if(aa=Object(v.a)(461,aa.node))ja=aa.Wb,aa.Wb=null;return ja},fa)}CHl(Z,fa){this.nwc(aa=>{let ja=null;if(aa=Object(v.a)(482,aa.node))ja=aa.Wb,aa.Wb=null;return ja},fa)}nwc(Z,fa){fa.revisionId&&fa.node&&(Z=Z(fa),r.a.Xa(Z)||this.TEh(fa.revisionId.toString(),Z))}TEh(Z,fa){r.a.Xa(Z)||r.a.Xa(fa)||this.iaa.$(Z,fa)}YWf(Z,fa,aa){if(!r.a.Xa(Z)&&this.iaa.Fb(Z)){this.pxg&&"pptDesktopWithDataUpload"===this.d5f(this.iaa.ga(Z))&&this.Uv.g5d();var ja={};ja[da.RIf]=this.iaa.ga(Z);ja[da.SIf]=fa;ja[da.MBi]=aa;
this.Ybc(this.iaa.ga(Z))?(ja[da.source]="xlOnline",ja[da.contentType]="chart",0!==aa&&(fa=Object.assign(new S.a(!0),{Wb:this.iaa.ga(Z)}),this.yH.fba(ResourceStrings.l_CopyPasteErrorCalloutTitle,ResourceStrings.l_CopyPasteErrorCalloutMessage,!0,CommonUIStrings.l_CalloutNotificationPButtonLabel,!0,CommonUIStrings.l_CalloutNotificationSButtonLabel,ca.a.TNf,ca.a.c0d,null,fa,!0,da.oub,!1,null))):433===aa?(this.b3c(this.iaa.ga(Z))&&this.ia.processAction(ca.a.NI,2),this.yH.fba(ResourceStrings.l_CopyPasteErrorCalloutTitle,
ResourceStrings.l_CopyPasteLargeDataErrorCalloutMessage,!1,null,!1,null,0,0,null,null,!0,da.oub,!1,null)):434===aa&&(this.b3c(this.iaa.ga(Z))&&(this.pxg?this.ia.processAction(ca.a.T2d,2):this.ia.processAction(ca.a.NI,2)),this.yH.fba(ResourceStrings.l_SomethingWentWrongCalloutTitle,ResourceStrings.errorTitle_PasteSlideFailed,!1,null,!1,null,0,0,null,null,!0,da.oub,!1,null));w.a.J(50733400,826,50,D.c(ja));(this.Ybc(this.iaa.ga(Z))||this.b3c(this.iaa.ga(Z)))&&this.Xv.remove(this.iaa.ga(Z));this.iaa.remove(Z)}}ATj(Z){return!r.a.Xa(Z)&&
this.Xv.Fb(Z)?this.Xv.ga(Z).OEf:!1}dlc(Z){r.a.Xa(Z)||(this.$Bb(Z)?this.Xv.ga(Z).OEf=!0:w.a.J(595206346,826,15,"attempted to update clipboard telemetry before tracking started "+Z))}}da.source="CcpSource";da.contentType="CcpContentType";da.operation="CcpOperation";da.SIf="CcpSuccess";da.actionName="ActionName";da.oub=20;da.RIf="CcpCorrelation";da.GIi="CcpCopyIframeContent";da.SKf="ClipServiceThrottled";da.QIf="data-corr-id";da.Jp="CcpId";da.MBi="ClipServiceFailureReason";Object(K.a)(da,"ClipboardTelemetry",
null,[388])},398:function(K,U,d){K=d(0);var h=d(47),e=d(205),r=d(1252),m=d(1244),n=d(58);class z{constructor(){this.shapeType=this.nIe=this.w3g=this.Y6g=this.X6g=0;this.nr=this.iq=this.pp=this.qj=!1;this.FKc=null}}Object(K.a)(z,"ShapeProperties",null,[]);var v=d(28),x=d(43),B=d(104),D=d(217);d.d(U,"a",function(){return w});class w{constructor(J,G,M,N,R,C,O,S,T){this.qr=J;this.xk=G;this.Ga=O;this.Ldd=C.aul;this.Gok=this.FNi();this.oq=M;this.oM=N;this.We=R.Na;this.LO=C.fva;this.rkk=C.dAa;this.Sb=T}Peh(J,
G,M,N,R,C=null){if(G){var O=this.Ga.W$a(M);O&&(Array.remove(M,O),Array.add(M,this.Ga.Gr(O)));this.dEh(M);var S=M.length;O=Array(S);N=this.y9f(G,N);for(var T=0;T<S;T++){var ca=M[T],L=this.mmj(ca,N);O[T]=Object.assign(new z,{X6g:L.x,Y6g:L.y,w3g:ca.Ix,nIe:ca.jD,shapeType:ca.shapeType,qj:ca.qj,pp:ca.pp||2===ca.mediaType||1===ca.mediaType,iq:ca.vd,nr:ca.nr,FKc:""});O[T].qj&&(L=Object(m.a)(119,ca.qc(this.We)),O[T].FKc=L?L.Hud:"",v.a.J(512500632,826,50,"PendingImage: {0}, State: {1}, HasImageId: {2}",ca.Ufe,
this.oM.eX(ca),0<O[T].FKc.length))}T=G.Db;ca=G.zs();L=[];N=!0;var da=J.jj===G.jj,Z=J.Ln===G.Ln,fa=!1;J!==G&&(da?(fa=J.ibb||G.ibb,Z||(fa=J.abb||G.abb||fa),N=!fa):N=!1,N&&this.LO&&(J.Vp!==G.Vp||J.Vk!==G.Vk)&&(N=!1));for(var aa=0;aa<S;aa++)this.$tl(M[aa])||(L.push(M[aa]),N&&(N=this.Wrl(M[aa],Z)));M=L;v.a.J(512500631,826,50,"{0}",{["LocalRenderEnabled"]:N,["SameSlide"]:J===G,["SameMaster"]:da,["SameLayout"]:Z,["ThemeOverrides"]:fa});S=[];aa=fa=Z=da=L=!1;for(let ja=0;ja<M.length;ja++){const I=O[ja];let sa=
this.xk.OKi(T.cid,T.sid,I.X6g,I.Y6g,I.w3g,1>I.nIe?1:I.nIe,ca+M[ja].get_zIndex(),J.id,M[ja],I.shapeType,I.qj,I.FKc,N);h.a.Xa(C)||(sa.Wb=C);S.push(sa);L=L||I.qj;da=da||I.pp;Z=Z||I.iq;fa=fa||I.nr;aa=aa||this.rkk&&w.H0j(sa)}R=w.arh(L,da,Z,fa,aa,R);if(0<S.length&&(J=N?M:null,this.qr.zT(S,G,R,J),N&&x.a.Kb)){if(J){G="";for(const ja of J)G+=this.Ga.d8b(ja)+",";x.a.Kb.Wa(B.a.zIi,G);x.a.Kb.Wa(B.a.yql,J.length.toString())}x.a.Kb.Oj=!0;x.a.Kb.zOb=!0}}}XPi(J,G,M,N,R,C){var O=this.y9f(J,M);M=[];const S=G.fmc,T=
!!S&&!e.a.Xa(S.Prg);C=this.lmj(C,O);for(O=0;O<G.objectCount;O++){const ca=this.xk.aKi(J.cid,J.sid,C.x,C.y,R);ca.isEditable=T&&S.Prg[O];M.push(ca)}0<M.length&&this.qr.zT(M,J,N)}lmj(J,G){const M=G*w.jT;G*=w.jT;let N=new n.a(M,G);J&&(N=this.Sb.Rka(J.clientWidth,J.clientHeight))&&(N.x+=M,N.y+=G);return N}$tl(J){return J.DB&&this.Ldd||!J.bng}Wrl(J,G){return J.Ufe||this.oM.eX(J)||J.rl&&J.hasText&&!G&&10!==J.Qj&&12!==J.Qj||J.Jq?!1:!0}dEh(J){J.sort((G,M)=>G.get_zIndex()-M.get_zIndex())}u1j(J){return J?this.Gok.contains(J):
!1}y9f(J,G){if(!J)return 0;if(!G)return w.dui;let M,N;return G.$(M=J.Db,(N=G.ga(M))+1),N}mmj(J,G){var M=this.oq.presentation;if(!M)throw Error.argumentNull("Presentation is null");let N=J.Iy,R=J.Jy;J=M.Asj(M.ZC(J.slideId));M=Math.round(w.jT/J)*J;J=r.a.gf(M,0);for(M=r.a.gf(M,1);0<G;)N+=J,R+=M,G--;return new n.a(N,R)}MJl(J){try{if(J&&J.clipboardData){const G=J.clipboardData.types;for(let M=0;M<G.length;M++){const N=J.clipboardData.getData(G[M]);if(this.OTj(N))return N}}}catch(G){}return null}OTj(J){return!!J&&
0<J.length&&this.w5j(J)}w5j(J){J=J.trim().toLowerCase();return J.startsWith("http:")||J.startsWith("https:")}vll(J,G,M){J&&(J.setAttribute(w.EGf,G.toString()),J.setAttribute(w.DGf,M.toString()),J.setAttribute(w.FGf,"true"))}FNi(){const J=new D.a;J.add("param");J.add("map");J.add("area");J.add("script");J.add("noscript");J.add("col");J.add("colgroup");J.add("caption");J.add("head");J.add("title");J.add("link");J.add("meta");J.add("style");J.add("base");J.add("input");J.add("textarea");J.add("select");
J.add("option");J.add("optgroup");J.add("button");J.add("hr");return J}Qij(J){return this.$Kh(J,w.EGf)}Iij(J){return this.$Kh(J,w.DGf)}fYj(J){return J?"true"===J.getAttribute(w.FGf):!1}wJl(J){if(this.fsg(J)){const G=J.indexOf('"')+1,M=J.lastIndexOf('"');if(1<G&&M>G&&(J=J.slice(G,M),J.startsWith(w.mui)))return J}return null}fsg(J){return!!J&&J.length>w.Mui&&J.startsWith(w.nui)}$Kh(J,G){let M=0;this.fYj(J)&&(M=parseFloat(J.getAttribute(G)));return isNaN(M)?0:M}DXd(J){return this.EXd(J).returnValue}EXd(J){let G;
G=2;let M=0,N=0,R=0,C=0,O=0,S=0,T=0,ca=0,L=0,da=0,Z=0,fa=0,aa=0,ja=0,I=0,sa=0,ka=0;for(const Ma of J)Ma.vd?(G=2===G?6:20,M++):Ma.Wf?(G=2===G?12:20,N++):Ma.nr?(G=2===G?7:20,R++):Ma.Of?(G=2===G?13:20,C++):22===Ma.i9b?(G=2===G?10:20,O++):Ma.qj?(G=2===G?5:20,S++):Ma.Hx?(G=2===G?3:20,T++):Ma.F4?(G=2===G?14:20,Ma.DB&&L++,ca++):Ma.rl?(G=2===G?14:20,Ma.DB&&Z++,da++):Ma.rz?(G=2===G?15:20,fa++):Ma.YT?(G=2===G?16:20,aa++):Ma.pp?(G=2===G?18:20,ja++):Ma.Jq?(G=2===G?11:20,I++):Ma.yea?(G=2===G?17:20,sa++):(G=2===
G?4:20,ka++);return{returnValue:String.format("numTotalShapes={0}, numTables={1}, numSmartArt={2}, numCharts={3}, numGroups={4}, numInk={5}, numPictures={6}, numTextbox={7}, numTitlePlaceholder={8}, numEmptyTitlePlaceholder={9}, numNonTitlePlaceholder={10}, numEmptyNonTitlePlaceholder={11}, numLine={12}, numActiveX={13}, numMedia={14}, numAppForOffice={15}, numOleObject={16}, numNormalShape={17}",J.length,M,N,R,C,O,S,T,ca,L,da,Z,fa,aa,ja,I,sa,ka),contentType:G}}static Igl(J){for(const G of J)if(!G.bng||
G.isLocal)return!1;return!0}static H0j(J){return J&&4===J.hL?(!J.fill||!!J.fill.noFillField)&&(!J.lineStyle||!!J.lineStyle.noFillField):!1}static arh(J,G,M,N,R,C){return J||G||M||N||R?C:0}}w.FGf="data-from-ppt-online";w.EGf="data-image-width-mu";w.DGf="data-image-height-mu";w.mui="data:image/";w.nui="<img src=";w.Mui=14;w.dui=1;w.jT=15;Object(K.a)(w,"CopyPasteUtility",null,[370])},442:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}h.open="open";h.refresh="refresh";h.$Xe="saveAs";
h.translate="translate";h.modeSwitch="modeSwitch";h.CMi="createNew";h.convert="convert";Object(K.a)(h,"ReasonList",null,[])},443:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.func=this.outputSchema=this.inputSchema=this.name=null}}Object(K.a)(h,"Lambda",null,[819])},444:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}h.ruc="SlideTextTile";h.B0e="ShapeTextTile";Object(K.a)(h,"AugmentationSchemas",null,[])},445:function(K,U,d){d.d(U,"a",function(){return h});
K=d(0);d(27);class h{static vb(){}static z1(e,r,m,n,z){return 1===m?32:h.HVk(e,z)?32:8}static oH(e,r,m,n,z){return 1===m?32:h.Xyk(e,z)?32:8}static Xyk(e,r){const m=h.oWh[e.toString()];if(void 0===m||null===m)return!1;m(e,r);return!0}static HVk(e,r){const m=h.rWh[e.toString()];if(void 0===m||null===m)return!1;m(e,r);return!0}}h.oWh={};h.rWh={};Object(K.a)(h,"DialogCuiControlActor",null,[])},446:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.description=this.title=
this.nQ=this.u1=null}}Object(K.a)(h,"CpContentDetails",null,[524])},447:function(K,U,d){d.d(U,"a",function(){return e});K=d(0);var h=d(106);class e{constructor(){this.NAf=!1;this.sessionId=this.VKf=null;this.D8a=e.$9i()}static $9i(){return"CID"+h.a.create().toString()}static Elg(r){return r&&r.length?r.startsWith("CID")&&h.a.isValid(r.substring(3,r.length))?!0:!1:!1}}Object(K.a)(e,"InternalClipboardObject",null,[])},448:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.r2a=
this.hea=this.gZ=null;this.m2c=this.COb=!1;this.rOe=0;this.Wb=null;this.Hbc=this.smg=this.Gbc=!1;this.reset()}reset(){this.hea=[];this.gZ=null;this.r2a=[];this.m2c=this.COb=!1;this.rOe=0;this.Wb=null;this.Hbc=this.smg=this.Gbc=!1}}Object(K.a)(h,"HtmlPasteContext",null,[])},449:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);d=d(447);class h extends d.a{constructor(e){super();this.gd=e}get $pg(){return!this.gd||!this.gd.isConnected}get id(){return this.gd.id}get isConnected(){return this.gd.isConnected}}
Object(K.a)(h,"InternalClipboardSlide",d.a,[])},450:function(K,U,d){d.d(U,"a",function(){return e});var h=d(107);const e=(r,m,n)=>{const z=new h.StandardDialog;z.Ad=0;z.sP(r,m,n);return z}},451:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}Object(K.a)(h,"SmartLookupSelection",null,[])},462:function(K,U,d){K=d(0);var h=d(392),e=d(7),r=d(27),m=d(182),n=d(78),z=d(67),v=d(177),x=d(97),B=d(170);d(70);class D{constructor(){this.secondActionButtonProps=this.firstActionButtonProps=this.messageTitle=
this.message=null;this.isMultiline=!1;this.messageBarType=0;this.closeable=!1;this.messageBarIconProps=this.linkProps=this.dismissButtonAriaLabel=this.onDismiss=null}}Object(K.a)(D,"MessageBarProps",null,[]);class w{constructor(S,T){this.onExecute=this.label=this.type=null;this.label=S;this.type="AppButtonProps";this.onExecute=T}}Object(K.a)(w,"AppButtonProps",null,[]);var J=d(141),G=d(801),M=d(139),N=d(214),R=d(106),C=d(37);d.d(U,"a",function(){return O});class O{constructor(S,T,ca){this._message=
this.yC=null;this.EHd=this.Gob=!1;this.rBd=0;this.eia="";this.ES=0;this.rF=this.uS=this.sqa=this.D7=this.o5a=this.uSb=this.tSb=this.sSb=this.rSb=this.BN=this.m7=this.Ira=this.LOa=null;this.yob=this.xob=!1;this.dcf=this.KBd="";this.IBd=!1;this.ecf=this.OBd="";this.MBd=!1;this.NBd=this.JBd=null;this.iWb=!1;this.mmf=this.sqb="";this.n5a=null;this.pVb=this.Zif=!1;this.lDa=this.u3=this.iea=this.PP=this.businessBar=null;this.errorCode=0;this.UAf=this.visible=!1;this.title=S;this.message=T;this.hac=ca;this.id=
0;this.image=1;this.Q1c=!0;this.gEf=5}get htmlElement(){return this.PP}get Q1c(){return this.EHd}set Q1c(S){this.EHd=S}get gEf(){return this.rBd}set gEf(S){this.rBd=S}get title(){return this.yC}set title(S){this.yC!==S&&(this.yC=S,this.Ira&&(this.Ira.innerText=this.yC))}get message(){return this._message}set message(S){this._message!==S&&(this._message=S,this.m7&&(this.m7.innerText=this._message))}get image(){return this.ES}set image(S){this.ES=S;4!==this.ES&&(this.iea="")}get xFa(){return this.eia}set xFa(S){this.eia=
S}get closeable(){return this.Gob}set closeable(S){this.Gob!==S&&(this.Gob=S,this.sqa&&(this.sqa.style.display=this.Gob?"table-cell":"none"))}get uqc(){return r.AFrameworkApplication.fa.ka("ReactBusinessBarIsEnabled")}get DSl(){return r.AFrameworkApplication.fa.ka("Fluent2StyleIsEnabled")}addButton(S,T,ca,L=!1){this.KBd=S;this.JBd=T;this.xob=!0;this.dcf=ca;this.IBd=L}CSd(S,T){this.OBd=S;this.NBd=T;this.yob=!0;this.ecf="";this.MBd=!1}Oxf(S,T){this.sqb=S;this.n5a=T;this.iWb=!0}HNi(){var S=N.a.Y3(r.AFrameworkApplication.fa.Ha("VNextStyleOptOutCookieName"),
!1);S=this.DSl&&!S;this.PP=document.createElement("div");this.htmlElement.className=String.format("{0} {1} {2}",O.ccf,O.s5h,S?O.t$h:"");this.htmlElement.setAttribute("UNSELECTABLE","on");void 0!==this.lDa&&null!==this.lDa&&(this.htmlElement.id=this.lDa);S=()=>{J.UISurfaces.ilj().then(T=>{this.businessBar.kpe||(T.initializeMessageBarInStore(),this.businessBar.kpe=!0);const ca=Object.assign(new D,{message:this._message,messageTitle:this.yC,isMultiline:this.EHd,messageBarType:this.rBd});if(this.Gob){ca.closeable=
!0;var L=this._message+". "+CommonUIStrings.l_DialogClose;this.yC&&(L=this.yC+". "+L);ca.dismissButtonAriaLabel=L;ca.onDismiss=()=>{this.xZd(this)}}4===this.ES&&(ca.messageBarIconProps={["iconName"]:this.iea});this.iWb&&(ca.linkProps={["type"]:"AppLinkProps",["text"]:this.sqb,["handler"]:{["href"]:this.mmf,["target"]:"_blank"}},this.n5a&&(L=Object(e.a)(this,this.TEk,"onMessageBarLinkClicked"),ca.linkProps.handler=L));this.xob&&(ca.firstActionButtonProps=new w(this.KBd,()=>{this.qti(this)}));this.yob&&
(ca.secondActionButtonProps=new w(this.OBd,()=>{this.sti(this)}));T.createNewMessageBarWithCallback?T.createNewMessageBarWithCallback(this.htmlElement,ca,()=>{r.AFrameworkApplication.Aa.yu()}):T.createNewMessageBar(this.htmlElement,ca);return null}).catch(()=>{h.ULS.sendTraceTag(595096981,324,10,"Failed to load React Message Bar API");return null})};m.a.get_instance().isCompleted(7)?S():m.a.get_instance().Mj(7,S);this.hac&&(r.AFrameworkApplication.Aa.Wy.rb(z.a.click,this.htmlElement,Object(e.a)(this,
this.onClick,"onClick")),r.AFrameworkApplication.Aa.zG.aV(z.a.Tl,this.htmlElement,Object(e.a)(this,this.$Ke,"onBodyKeyUp"),this),this.Zif&&!this.pVb&&(r.AFrameworkApplication.Aa.qba.rb(this.htmlElement,Object(e.a)(this,this.onClick,"onClick"),null),this.pVb=!0));return this.htmlElement}createElement(){r.AFrameworkApplication.dM("Microsoft.Office.Web.SessionSettings.IWacWordReactBusinessBarSettings");if(this.uqc)return this.HNi();this.PP=document.createElement("div");this.htmlElement.className=O.ccf;
this.htmlElement.setAttribute("UNSELECTABLE","on");void 0!==this.lDa&&null!==this.lDa&&(this.htmlElement.id=this.lDa);this.LOa=null;if(0!==this.ES){this.LOa=document.createElement("span");this.LOa.className="WACBusinessBarIcon";this.htmlElement.appendChild(this.LOa);var S=null;let T=null;switch(this.ES){case 2:S=O.$Xh;T=CommonUIStrings.l_DialogError;break;case 1:S=O.G$h;T=CommonUIStrings.l_DialogWarning;break;case 3:S=O.i_h;T=CommonUIStrings.l_DialogInfo;break;case 4:S=this.iea,T=this.eia}this.LOa.title=
T;this.LOa.setAttribute(M.a.hf,M.a.eDf);this.LOa.appendChild(n.createClusteredImage(24,24,S,O.ZZh,!0,""))}S=R.a.create().toString();this.BN=document.createElement("div");this.BN.id="BBTitleAndBody"+S;this.BN.className=O.eVh;this.BN.tabIndex=0;this.yC&&(this.Ira=document.createElement("p"),this.Ira.innerText=this.yC,this.Ira.className=O.fVh+" UIFontBold",this.Ira.id="BBTitle"+S,this.Ira.setAttribute("UNSELECTABLE","on"),this.BN.setAttribute(M.a.e_,this.Ira.id),this.BN.appendChild(this.Ira));this.m7=
document.createElement("p");this.m7.className=O.$Uh;this.m7.innerText=this._message;this.m7.id="BBBody"+S;this.m7.setAttribute("UNSELECTABLE","on");this.m7.style.width="100%";this.BN.setAttribute(M.a.Rca,this.m7.id);this.xob&&this.bxf(this.m7,this.dcf);this.yob&&this.bxf(this.m7,this.ecf);this.BN.appendChild(this.m7);S=document.createElement("div");S.setAttribute(M.a.hf,M.a.nVd);S.appendChild(this.BN);this.htmlElement.appendChild(S);this.xob&&(this.sSb=document.createElement("span"),this.rSb=document.createElement("button"),
this.AOf(this.sSb,this.rSb,this.KBd,Object(e.a)(this,this.dGf,"buttonOneClickHandler")));this.yob&&(this.uSb=document.createElement("span"),this.tSb=document.createElement("button"),this.AOf(this.uSb,this.tSb,this.OBd,Object(e.a)(this,this.eGf,"buttonTwoClickHandler")));this.iWb&&(this.o5a=document.createElement("span"),this.o5a.className=O.dVh,this.D7=document.createElement("a"),this.D7.className=G.a.cVh,this.D7.innerText=this.sqb,this.n5a?(this.D7.tabIndex=0,r.AFrameworkApplication.Aa.Wy.aV(z.a.click,
this.D7,Object(e.a)(this,this.Zug,"linkClickHandler"),this),r.AFrameworkApplication.Aa.zG.aV(z.a.Tl,this.D7,Object(e.a)(this,this.l$g,"onLinkKeyUp"),this)):(this.D7.href=this.mmf,this.D7.target="_blank"),this.o5a.appendChild(this.D7),this.htmlElement.appendChild(this.o5a));r.AFrameworkApplication.Aa.Wy.rb(z.a.click,this.htmlElement,Object(e.a)(this,this.onClick,"onClick"));r.AFrameworkApplication.Aa.zG.aV(z.a.Tl,this.BN,Object(e.a)(this,this.$Ke,"onBodyKeyUp"),this);this.Zif&&!this.pVb&&(r.AFrameworkApplication.Aa.qba.rb(this.htmlElement,
Object(e.a)(this,this.onClick,"onClick"),null),this.pVb=!0);this.Gob&&(this.sqa=document.createElement("span"),this.sqa.className=O.IVh,this.uS=document.createElement("a"),this.uS.className=O.JVh,this.uS.tabIndex=0,this.uS.title=CommonUIStrings.l_DialogClose,this.uS.setAttribute(M.a.hf,M.a.Ju),this.rF=n.createClusteredImage(16,16,O.KVh,"",!0,""),this.uS.appendChild(this.rF),this.sqa.style.display="table-cell",this.sqa.appendChild(this.uS),this.htmlElement.appendChild(this.sqa),r.AFrameworkApplication.Aa.Wy.aV(z.a.click,
this.uS,Object(e.a)(this,this.p8g,"onCloseClick"),this),r.AFrameworkApplication.Aa.zG.aV(z.a.Tl,this.uS,Object(e.a)(this,this.q8g,"onCloseKeyUp"),this));return this.htmlElement}Cvl(){this.BN&&this.BN.setAttribute(M.a.HI,M.a.pja)}bxf(S,T){if(T&&""!==T){var ca=document.createElement("span");ca.className=O.v6h;ca.innerText=T;S.appendChild(ca)}}AOf(S,T,ca,L){S.className=O.bVh;T.setAttribute("type","button");T.className=O.aVh;T.innerText=ca;S.appendChild(T);this.htmlElement.appendChild(S);r.AFrameworkApplication.Aa.Wy.aV(z.a.click,
T,L,this)}wrh(){this.uqc||(this.BN.style.whiteSpace="nowrap",this.closeable?this.sqa.style.width="auto":this.iWb?this.o5a.style.width="auto":this.yob?this.uSb.style.width="auto":this.xob?this.sSb.style.width="auto":this.BN.style.width="auto",this.htmlElement.clientWidth>this.businessBar.htmlElement.clientWidth?this.BN.style.whiteSpace="normal":this.closeable?this.sqa.style.width="100%":this.iWb?this.o5a.style.width="100%":this.yob?this.uSb.style.width="100%":this.xob?this.sSb.style.width="100%":this.BN.style.width=
"100%")}r8e(S,T){if(B.a.HIb()){var ca={};ca.WacSessionId=r.AFrameworkApplication.userSessionId;ca.ActionName="BusinessBar"+S;ca.InputMethod=T;h.ULS.sendTraceTag(35489761,207,50,JSON.stringify(ca))}}sX(S,T,ca,L){this.r8e(S,ca);B.a.uWa()&&x.c(T,!0,x.e,L,10)}dGf(S){this.JBd(S.OD);this.sX("ButtonOne",C.a.YFf,"Mouse",2);this.IBd&&(this.sX("Close",C.a.Ytb,"Mouse_ButtonOne",2),this.close(S));return!0}qti(S){this.JBd(S);this.sX("ButtonOne",C.a.YFf,"Mouse",2);this.IBd&&(this.sX("Close",C.a.Ytb,"Mouse_ButtonOne",
2),this.xZd(S))}eGf(S){this.NBd(S.OD);this.sX("ButtonTwo",C.a.ZFf,"Mouse",2);this.MBd&&(this.sX("Close",C.a.Ytb,"Mouse_ButtonTwo",2),this.close(S));return!0}sti(S){this.NBd(S);this.sX("ButtonTwo",C.a.ZFf,"Mouse",2);this.MBd&&(this.sX("Close",C.a.Ytb,"Mouse_ButtonTwo",2),this.xZd(S))}Zug(S){this.n5a(S.OD);this.sX("Link",C.a.bGf,"Mouse",2);return!0}TEk(){this.n5a(null)}l$g(S){return S.mc.keyCode!==v.a.Dp||S.mc.altKey?!1:(this.n5a(S.OD),this.sX("Link",C.a.bGf,"Keyboard",1),!0)}$Ke(S){return S.mc.keyCode===
v.a.Dp&&!S.mc.altKey&&this.hac?(this.hac(S.OD,S),this.sX("Invoke",C.a.aGf,"Keyboard",1),!0):!1}dispose(){this.htmlElement&&(r.AFrameworkApplication.Aa.Wy.Bb(z.a.click,this.htmlElement,Object(e.a)(this,this.onClick,"onClick")),this.pVb&&r.AFrameworkApplication.Aa.qba.Bb(this.htmlElement,Object(e.a)(this,this.onClick,"onClick")));this.uS&&(r.AFrameworkApplication.Aa.Wy.Bb(z.a.click,this.uS,Object(e.a)(this,this.p8g,"onCloseClick")),r.AFrameworkApplication.Aa.zG.Bb(z.a.Tl,this.uS,Object(e.a)(this,this.q8g,
"onCloseKeyUp")));this.rSb&&r.AFrameworkApplication.Aa.Wy.Bb(z.a.click,this.rSb,Object(e.a)(this,this.dGf,"buttonOneClickHandler"));this.tSb&&r.AFrameworkApplication.Aa.Wy.Bb(z.a.click,this.tSb,Object(e.a)(this,this.eGf,"buttonTwoClickHandler"));this.D7&&this.n5a&&(r.AFrameworkApplication.Aa.Wy.Bb(z.a.click,this.D7,Object(e.a)(this,this.Zug,"linkClickHandler")),r.AFrameworkApplication.Aa.zG.Bb(z.a.Tl,this.D7,Object(e.a)(this,this.l$g,"onLinkKeyUp")));this.BN&&r.AFrameworkApplication.Aa.zG.Bb(z.a.Tl,
this.BN,Object(e.a)(this,this.$Ke,"onBodyKeyUp"));this.businessBar=this.uS=this.sqa=this.rF=this.o5a=this.D7=this.uSb=this.tSb=this.sSb=this.rSb=this.BN=this.m7=this.PP=this.Ira=this.LOa=this.eia=null}onClick(S){this.sX("Invoke",C.a.aGf,"Mouse",2);return!!this.hac&&this.hac(this,S)}p8g(S){this.sX("Close",C.a.Ytb,"Mouse",2);this.close(S);return!0}q8g(S){return S.mc.keyCode!==v.a.Dp||S.mc.altKey?!1:(this.sX("Close",C.a.Ytb,"Keyboard",1),this.close(S),!0)}close(S){const T=S.OD;this.businessBar.removeEntry(T);
this.slg(T,S.ng)}slg(S,T){if(S.u3){const ca=r.AFrameworkApplication.Ra;ca.eq=10;ca.XT=T;S.u3(S);ca.eq=0;ca.XT=0}}xZd(S){S&&this.businessBar&&(this.businessBar.removeEntry(S),this.slg(S,0))}}O.ccf="WACBusinessBarEntry";O.fVh="WACBusinessBarTitle";O.$Uh="WACBusinessBarBody";O.eVh="WACBusinessBarTitleBodyHolder";O.bVh="WACBusinessBarButtonHolder";O.aVh="WACBusinessBarButton";O.dVh="WACBusinessBarLinkHolder";O.JVh="WACBusinessBarClose";O.IVh="WACBusinessBarCloseHolder";O.KVh="BusinessBarClose_16x16x32";
O.ZZh="WACBusinessBarImage";O.v6h="WACScreenReaderOnly";O.$Xh="CancelRequest_24x24x32";O.G$h="Risks_24x24x32";O.i_h="Info_24x24x32";O.s5h="ReactBusinessBarEntry";O.t$h="VNextBusinessBarEntry";Object(K.a)(O,"BusinessBarEntry",null,[319,107])},527:function(K,U,d){d.d(U,"a",function(){return m});K=d(0);var h=d(65),e=d(528),r=d(929);class m{m2b(n,z){if(1===n.nodeType&&z){var v=this.RW(z);n=this.w0f(n,v);this.eDi(v,n,z)}}w0f(n,z){const {CombineHelper:v}=d(1193),x=[];let B=null;for(let w=0;w<n.childNodes.length;w++){var D=
n.childNodes[w];3===D.nodeType?(B||(B=new v(n,w,z)),B.mei(w)):(B&&(B.end(x,w-1),B=null),D=this.w0f(D,z),Array.addRange(x,D))}B&&B.end(x,n.childNodes.length-1);return x}eDi(n,z,v){n=n.clone();let x=!1;for(let B=z.length-1;0<=B;B--){const D=z[B].dDi();x=n.merge(D)||x}x&&this.setSelection(n,v)}setSelection(n,z){z=h.a.MEa(z);z.setStart(n.start.element,n.start.offset);z.setEnd(n.end.element,n.end.offset)}RW(n){return(n=h.a.MEa(n))?Object.assign(new r.a,{start:Object.assign(new e.a,{element:n.startContainer,
offset:n.startOffset}),end:Object.assign(new e.a,{element:n.endContainer,offset:n.endOffset})}):new r.a}}m.unused=-1;Object(K.a)(m,"TextNodeCombiner",null,[1424])},528:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.element=null;this.offset=0}clone(){return Object.assign(new h,{element:this.element,offset:this.offset})}merge(e){if(!e.element||this.element===e.element&&this.offset===e.offset)return!1;this.element=e.element;this.offset=e.offset;return!0}}Object(K.a)(h,
"SelectionSide",null,[])},529:function(K,U,d){d.d(U,"a",function(){return e});K=d(0);U=d(324);var h=d(143);class e extends U.a{constructor(){super();this.items=this.parentRevId=this.parentPath=null;this.H_=Object.assign(new h.a,{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_Operation"}static getBaseTypes(){return[]}}Object(K.a)(e,"Operation",U.a,[])},530:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);var h;(function(e){e[e.none=0]="none";e[e.oneNote=1]=
"oneNote";e[e.word=2]="word";e[e.wordViewer=3]="wordViewer";e[e.powerPoint=4]="powerPoint"})(h||(h={}));Object(K.b)("AppMode",h)},531:function(K,U,d){d.d(U,"a",function(){return e});d.d(U,"b",function(){return r});d.d(U,"c",function(){return m});const h=n=>{switch(n){case 1:return 5;case 2:return 4;case 3:return 3;case 5:return 2;case 4:return 1;default:return 0}},e=n=>h(m(n.Priority,n.Tag)),r=n=>m(n.Priority,n.Tag),m=(n,z)=>{switch(n){case 0:return 1;case 1:return 2;case 2:return z&1?5:3;case 3:return 4;
default:return 0}}},532:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.C=this.T=this.E=0;this.F=null;this.I=this.A=0;this.G=null}}Object(K.a)(h,"ProofingTraceMetrics",null,[])},533:function(K,U,d){d.d(U,"a",function(){return r});d.d(U,"b",function(){return m});d.d(U,"c",function(){return n});var h=d(27),e=d(534);const r=()=>{const z=h.AFrameworkApplication.Aa.ob.zk;return(3===z||1===z||2===z||4===z)&&h.AFrameworkApplication.fa.ka("PremiumUpsellIsEnabled")},m=(z,
v,x,B=!1)=>{v=1===v;1===z&&(v=2===h.AFrameworkApplication.Aa.mode);return String.format("PROD_OfficeOnline-{0}_{1}_{2}_{3}",e.a[z],v?"Editor":"Viewer",B?"Dime":"Unknown",x?x:"dimedefault")},n=z=>{switch(z){case 3:return"OfficeOnlineWord";case 1:return"OfficeOnlineExcel";case 2:return"OfficeOnlinePowerPoint";case 4:return"OfficeOnlineOneNote";default:return null}}},534:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);var h;(function(e){e[e.unknown=0]="unknown";e[e.excel=1]="excel";e[e.powerPoint=
2]="powerPoint";e[e.word=3]="word";e[e.oneNote=4]="oneNote";e[e.visio=5]="visio"})(h||(h={}));Object(K.b)("OfficeAppType",h)},535:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}h.MDf="AugEditorServiceTileCheckRequest";h.EVd="AugEditorServiceTileCheckResponse";h.SXi="EditorServiceTileCheckRequest";h.lLf="Proofing.ProofingRequest";h.QMc="Proofing.ProofingResponse";Object(K.a)(h,"ProofingAugmentationSchemaNames",null,[])},536:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.slideId=
null;this.zhh=this.quc=0}}Object(K.a)(h,"SlidePresenceInfo",null,[])},537:function(K,U,d){d.d(U,"a",function(){return m});K=d(0);var h=d(392),e=d(1095),r=d(36);class m{execute(n,z,v=null){h.ULS.sendTraceTag(572846934,380,50,"reqType:{0}",n.pl());const x=new e.a,B=this.N8(n,z,v);B.continueWith(()=>{if(B.Dm)x.AG(B.ej);else if(B.ho)x.f2();else{const D=B.result;if(D&&!D.succeeded&&D.uj&&D.uj.data&&5===B.result.uj.data.status){const w=this.N8(n,z,v);w.continueWith(()=>{w.Dm?x.AG(w.ej):w.ho?x.f2():x.uK(w.result)})}else x.uK(D)}});
return x.task}N8(n,z,v){v=this.mrj(v);return z(v,{"Content-Type":"application/json; charset=utf-8"},n.serialize())}mrj(n){return n?String.format("{0}/{1}",n,"people.ashx"):"people.ashx"}static q9a(n){if(!n)return h.ULS.sendTraceTag(572846935,380,10,"ResponseBodyTask from PeopleHandler is null"),null;try{return r.a(n)}catch(z){h.ULS.sendTraceTag(572846936,380,10,"Could not parse the response. Message: {0}",z.message)}return null}}Object(K.a)(m,"CommonHandlerRequestManager",null,[])},538:function(K,
U,d){d.d(U,"a",function(){return e});K=d(0);var h=d(392);class e{equals(r,m){if(!r||!m)return!r&&!m;if(r.UserId!==m.UserId){if(!e.VUf(r.Provider)||!e.VUf(m.Provider))return!1;const z=r.UserId.startsWith(e.e_b);var n=m.UserId.startsWith(e.e_b);if(z&&n){if(r.Provider!==m.Provider)return h.ULS.sendTraceTag(593368202,327,10,"Provider mismatch when both IDs are in AD format. Providers: {0} , {1}",r.Provider,m.Provider),!1;n=e.pZf(r.UserId);m=e.pZf(m.UserId);return!!n&&n===m}r=r.Email&&""!==r.Email?r.Email:
z?e.a$a(r.UserId):r.UserId;m=m.Email&&""!==m.Email?m.Email:n?e.a$a(m.UserId):m.UserId;return!!r&&r===m}return r.Provider!==m.Provider?!1:r.Provider&&""!==r.Provider||r.UserId&&""!==r.UserId?!0:r.DisplayName===m.DisplayName}UW(){return 0}static VUf(r){return"O365"===r||"AD"===r}static a$a(r){if(!r.startsWith(e.e_b))return null;r=r.substr(e.e_b.length);const m=r.lastIndexOf("::");return-1===m?null:r.substr(0,m)}static pZf(r){if(!r.startsWith(e.e_b))return null;var m=r.lastIndexOf("::");if(-1===m)return null;
m+=2;return m>=r.length?null:r.substr(m)}}e.e_b="S::";Object(K.a)(e,"CommentTaskPersonIdentityComparer",null,[326])},539:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(e){this.MessageId=e;this.SendTime=0;this.CorrelationId="";this.Values={}}}Object(K.a)(h,"CrossDocumentMessage",null,[])},540:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.additionalDataFields=this.otelEvent=null}}Object(K.a)(h,"OtelTelemetryEvent",null,[])},541:function(K,
U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(e){this.type=null;this.type=e}}Object(K.a)(h,"CustomContentProps",null,[])},542:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);d=d(299);class h{}h.CommandValueId="CommandValueId";h.Description="Description";h.Image16by16Class=d.a.Qzb;h.Image30by30Class=d.a.GKj;h.Image32by32Class=d.a.wFa;h.Image48by48Class=d.a.dhe;h.On="On";h.LabelText=d.a.labelText;h.Visible=d.a.visible;h.SourceControlId="SourceControlId";h.DisplayMode="DisplayMode";
h.Alt=d.a.alt;Object(K.a)(h,"ToggleButtonCommandProperties",null,[])},543:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}h.Pu="InputMethod";h.dba="ShouldCanvasTakeFocus";h.Ixd="UILocation";Object(K.a)(h,"ReactRibbonConstants",null,[])},544:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{static get instance(){const {NewCustomEventFactory:e}=d(1155),{IECustomEventFactory:r}=d(1156);h.La||(h.La="function"===typeof window.CustomEvent?new e:new r);return h.La}}h.La=null;
Object(K.a)(h,"CustomEventFactory",null,[])},545:function(K,U,d){d.d(U,"a",function(){return e});d.d(U,"b",function(){return m});var h=d(9);d(1095);const e=z=>r(z),r=z=>new Promise((v,x)=>{z.continueWith(B=>{B.Dm?x(B.ej.message):B.ho?x(h.a.gOc()):v(null)})}),m=z=>n(z),n=z=>new Promise((v,x)=>{z.continueWith(()=>{z.Dm?x(z.ej.message):z.ho?x(h.a.gOc()):v(z.result)})})},546:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}h.themeColors="Theme Colors";Object(K.a)(h,"ReactColorConstants",
null,[])},547:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);var h;(function(e){e[e.other=0]="other";e[e.searchBoxSearch=1]="searchBoxSearch";e[e.searchBoxDictionary=2]="searchBoxDictionary";e[e.searchBoxQuickAnswer=3]="searchBoxQuickAnswer";e[e.smartLookupRibbon=4]="smartLookupRibbon";e[e.smartLookupContextMenu=5]="smartLookupContextMenu";e[e.entity=6]="entity";e[e.dictionary=7]="dictionary";e[e.web=8]="web";e[e.pictures=9]="pictures";e[e.files=10]="files";e[e.bookmarks=11]="bookmarks";e[e.help=
12]="help";e[e.chartRecommendation=13]="chartRecommendation";e[e.linkSkill=14]="linkSkill";e[e.searchBoxFindInDocument=15]="searchBoxFindInDocument";e[e.searchBoxEntity=16]="searchBoxEntity";e[e.searchSkill=17]="searchSkill";e[e.controlF=18]="controlF";e[e.ribbonFindButton=19]="ribbonFindButton";e[e.reuseSlides=20]="reuseSlides";e[e.data=21]="data";e[e.contextMenuDictionary=22]="contextMenuDictionary";e[e.contextMenuSearchSuggestion=23]="contextMenuSearchSuggestion";e[e.contextMenuSynonyms=24]="contextMenuSynonyms";
e[e.contextMenuSearchBoxSearch=25]="contextMenuSearchBoxSearch";e[e.searchBoxSearchZeroTerm=26]="searchBoxSearchZeroTerm";e[e.contextMenuSearchZeroTerm=27]="contextMenuSearchZeroTerm";e[e.note=28]="note";e[e.smartLookupAutoLaunch=29]="smartLookupAutoLaunch";e[e.contextMenuSmartLookupInSubMenu=30]="contextMenuSmartLookupInSubMenu";e[e.dataDisambiguate=31]="dataDisambiguate";e[e.linkFiles=32]="linkFiles";e[e.searchBoxNoteL2=33]="searchBoxNoteL2";e[e.contextMenuLaunchL2Document=34]="contextMenuLaunchL2Document";
e[e.actionAI=35]="actionAI";e[e.pasteAsNewSlide=36]="pasteAsNewSlide";e[e.slidesCompression=37]="slidesCompression";e[e.searchBoxGenerateDeck=38]="searchBoxGenerateDeck";e[e.powerPointCopilot=39]="powerPointCopilot";e[e.tellMeService=40]="tellMeService";e[e.prefetch=99]="prefetch"})(h||(h={}));Object(K.b)("EntryPoint",h)},553:function(K,U,d){d.r(U);K=d(0);var h=d(392),e=d(1265),r=d(686),m;(function(oa){oa[oa.external=0]="external";oa[oa.msa=1]="msa";oa[oa.aad=2]="aad"})(m||(m={}));Object(K.b)("AuthorityType",
m);var n=d(337);class z{constructor(oa){this.J2h=oa}initialize(){return Promise.resolve(0)}K4c(){return Promise.resolve(0)}gI(){h.ULS.sendTraceTag(574239257,3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new n.a,{IsSuccess:!0,Token:this.J2h}))}qxd(){return Promise.resolve(Object.assign(new n.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}tvd(){return!1}B8b(){return"MockAuthTokenStrategy"}}
Object(K.a)(z,"MockAuthTokenStrategy",null,[286]);var v=d(737);class x{static get(oa,Da,ta){if(!ta)return oa;let ha=0;return Promise.race([oa,new Promise(Ha=>{ha=window.setTimeout(()=>{Ha(Da)},ta)})]).then(Ha=>{window.clearTimeout(ha);return Promise.resolve(Ha)}).catch(()=>{window.clearTimeout(ha);return Promise.resolve(Da)})}}Object(K.a)(x,"PromiseWithTimeout",null,[]);var B=d(27),D=d(227);class w{constructor(oa,Da,ta,ha,Ha){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=
null;this.resource=oa;this.scope=Da;this.silentLogin=ta;this.options=ha;this.correlationId=Ha}}Object(K.a)(w,"TokenRequestParameters",null,[307]);var J=d(55),G=d(56);class M{constructor(){this.Ovf=null;let oa=B.AFrameworkApplication.fa.Ha(B.AFrameworkApplication.wK),Da=B.AFrameworkApplication.fa.Ha(B.AFrameworkApplication.PLh);this.Rrb=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",oa&&""!==oa?oa:"Unspecified",Da&&""!==Da?Da:"Unspecified")}initialize(){return new Promise(oa=>
{G.a.instance.Ia("Common.App.WopiIdentity.IWopiIdentity").execute(Da=>{this.Ovf=Da;oa(0)})})}Fc(oa){const Da=["HTTPS:","API:"];let ta=!1;const ha=oa.toLocaleUpperCase();for(const Ha of Da)if(ha.startsWith(Ha)){ta=!0;break}return ta||this.JXj(oa)?oa+"/.default":oa}JXj(oa){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(oa)}K4c(){return Promise.resolve(0)}gI(oa,Da,ta,ha,Ha,bb,Na){if(J.a.xGa){Ha=D.OAuthManagerSettings.aUl;if(!Ha)return Da=Object.assign(new n.a,
{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(Da);if(!Array.contains(Ha,oa))return Da=Object.assign(new n.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+oa}),Promise.resolve(Da)}oa=this.Fc(ta);ta=new w(ta,oa,!ha,null,B.AFrameworkApplication.userSessionId);return this.Ovf.getAccessToken(ta,Da,Na).then(Ia=>Object.assign(new n.a,{IsSuccess:!0,Token:Ia.accessToken}),Ia=>Object.assign(new n.a,{IsSuccess:!1,ErrorCode:Ia}))}qxd(){return Promise.resolve(Object.assign(new n.a,
{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}tvd(){return!1}B8b(){return this.Rrb}}Object(K.a)(M,"ParentFrameTokenStrategy",null,[286]);var N=d(7),R=d(462),C=d(18);class O{constructor(){this.reject=this.resolve=null;this.startTime=0;this.Kih=this.jEf=null}}Object(K.a)(O,"PromiseWrapper",null,[]);class S{constructor(oa=0){this.uN=0;this.rXb=!1;this.Hu=new C.a;this._timeout=oa}enqueue(oa){return new Promise((Da,
ta)=>{this.Hu.add(Object.assign(new O,{Kih:oa,resolve:Da,reject:ta}));this.process()})}process(){if(this.rXb||this.uN===this.Hu.count)return!1;const oa=this.Hu.ga(this.uN++);try{this.rXb=!0,oa.Kih().then(Da=>{this.rXb=!1;this.d_d(oa,Da,null,!0)}).catch(Da=>{this.rXb=!1;this.d_d(oa,null,Da,!1)})}catch(Da){this.rXb=!1,this.d_d(oa,null,Da,!1)}return!0}d_d(oa,Da,ta,ha){if(ha){const Ha=()=>{oa.resolve(Da);this.process()};0<this._timeout?window.setTimeout(()=>{Ha()},this._timeout):Ha()}else{const Ha=()=>
{oa.reject(ta);this.process()};0<this._timeout?window.setTimeout(()=>{Ha()},this._timeout):Ha()}}}Object(K.a)(S,"PromiseQueue",null,[]);class T{constructor(){this.correlationId=this.resolve=null}}Object(K.a)(T,"ResolveWithCorrelation",null,[]);var ca=d(1244),L=d(79),da=d(539),Z=d(127);class fa extends L.a{constructor(oa,Da,ta,ha,Ha,bb){super(!1,!1,!0);this.xef=this.Nha=null;this.yca=oa;this.P4h=ta;this.sF=ha;this.C9h=Ha;this.Y4a=bb;this.gB=document.createElement("iframe");this.gB.id="SharedAuthInteractiveFrame";
this.gB.setAttribute("name","SharedAuthInteractiveFrame");this.gB.setAttribute("title","SharedAuthInteractiveFrame");this.gB.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.gB.style.border="0";this.gB.style.height="48px";this.gB.style.width="190px";$addHandler(this.gB,"error",Object(N.a)(this,this.NHk,"onSharedAuthFrameError"));oa=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.yca,Da,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1",
"&WacUserType=",B.AFrameworkApplication.userType);this.gB.src=oa;this.fXh=new Promise(Na=>{this.xef=Na});this.yef=!1}Nga(){this.Nha={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.P4h,["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:B.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:Object(N.a)(this,this.kLi,"createFrame"),["resolveDialogStyles"]:this.xef}};this.Ad=5;this.pj(CommonUIStrings.l_SignIn,Object(N.a)(this,this.Zql,"sharedAuthConsentDialogHandler"),
this.Nha)}rOh(oa=!1,Da=5){this.Nha&&this.Nha.bodyControls&&(!0!==Object(ca.a)(Object,this.Nha.bodyControls).frameLoaded&&(Object(ca.a)(Object,this.Nha.bodyControls).frameLoaded=!0),oa!==Object(ca.a)(Object,this.Nha.bodyControls).frameLoadSuccess&&(Object(ca.a)(Object,this.Nha.bodyControls).frameLoadSuccess=oa),Da!==this.Nha.dialogButtonsOption&&(this.Nha.dialogButtonsOption=null,this.Ad=Da),this.update(this.Nha))}ixl(oa,Da){const ta=new da.a(Z.a.drl);ta.Values={["signInLabel"]:CommonUIStrings.l_SignIn,
["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:B.AFrameworkApplication.isRtl,["messageCorrelationId"]:oa,["dialogStyles"]:Da};this.sF.Vkb(ta,this.gB.contentWindow,this.yca)}e2f(){this.rOh(!1,6)}get zzh(){return this.gB}get ZTi(){return this.fXh.then(oa=>{this.yef=!0;return oa})}get $Ti(){return this.yef}NHk(){this.e2f()}kLi(){return this.gB}Zql(oa){0===oa&&(this.C9h.reject(Object.assign(new n.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.Y4a(null))}}
Object(K.a)(fa,"SharedAuthConsentDialog",L.a,[308]);var aa=d(677),ja=d(96),I=d(223),sa=d(65),ka=d(106),Ma=d(89);class Ea{constructor(){this.gB=null;this.MBc=0;this.yqb=this.ksb=this.iBd=this.Y4a=this.RZ=this.Juf=null;this.sF=new aa.a(null,null);this.Rrb="SharedAuthTokenStrategy Unloaded";this.yca=D.OAuthManagerSettings.brl;this.Xsf=D.OAuthManagerSettings.$ql;this.Aff=D.OAuthManagerSettings.enableConsoleLogging;this.RXh=B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",
!1);this.R7h=B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",!1);this.k$h=B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedWebWorkerEnabled",!1);this.LPa={};this.t_h=new S(1500)}B8b(){return this.Rrb}initialize(){var {OAuthManager:oa}=d(553);if("loadFrame"in this.LPa)return this.LPa.loadFrame.jEf;if(!this.yca)return ja.Health.instance.recordKpiFailure(oa.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),
h.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);oa=this.cvd("loadFrame");this.MBc=sa.a.vj();var Da=this.yca+this.Xsf+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+B.AFrameworkApplication.userSessionId+"&WacUserType="+B.AFrameworkApplication.userType;this.k$h&&(Da+="&webworker=1");this.gB=document.createElement("iframe");this.UZc(this.gB);this.gB.style.cssText="height:0;width:0;display:none;";this.gB.id=
"SharedAuthFrame";this.gB.setAttribute("name","SharedAuthFrame");this.gB.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.gB.setAttribute("title","SharedAuthFrame");this.gB.src=Da;document.body.appendChild(this.gB);Da=sa.a.vj()-this.MBc;h.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",Da,this.gB.src);return oa}K4c(oa){this.iBd=oa;const Da=new da.a(Z.a.Czh);Da.Values=this.ODf(oa);
oa=this.cvd("initFrame");this.sF.Vkb(Da,this.gB.contentWindow,this.yca);h.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return oa}gI(oa,Da,ta,ha,Ha,bb){const Na=new da.a(Z.a.erl),Ia=this.dag();Na.Values=this.FKh(oa,Da,ta,ha,Ha,bb,Ia);oa=this.cvd(Ia);ha&&B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",!1)?this.t_h.enqueue(()=>new Promise(Qa=>{this.UJl(bb,Na,Qa,Ia)})):(this.sF.Vkb(Na,this.gB.contentWindow,
this.yca),h.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",Da));return oa}UJl(oa,Da,ta,ha){const Ha=this.LPa[ha];Ha&&(this.ksb=Da,this.Y4a=Object.assign(new T,{resolve:ta,correlationId:ha}),this.RZ=new fa(this.yca,this.Xsf,oa,this.sF,Ha,ta),this.RZ.Nga())}dag(){return ka.a.create().toString()}FKh(oa,Da,ta,ha,Ha,bb,Na){const Ia={};Ia.appName=oa;Ia.appId=Da;Ia.target=ta;Ia.withPopup=ha;Ia.claims=Ha;Ia.promptMessage=bb;Ia.messageCorrelationId=
Na;return Ia}UZc(oa){$addHandler(oa,"load",Object(N.a)(this,this.ZDk,"onIFrameLoaded"));$addHandler(oa,"error",Object(N.a)(this,this.dMe,"onIFrameError"));this.sF.qCa(this.yca);this.sF.Iu(Z.a.Fzh);this.sF.dC(Z.a.Fzh,Object(N.a)(this,this.iHk,"onScriptLoaded"));this.sF.Iu(Z.a.Ezh);this.sF.dC(Z.a.Ezh,Object(N.a)(this,this.hHk,"onScriptInitialized"));this.sF.Iu(Z.a.Azh);this.sF.dC(Z.a.Azh,Object(N.a)(this,this.GDk,"onGetTokenResponse"));this.sF.Iu(Z.a.Gzh);this.sF.dC(Z.a.Gzh,Object(N.a)(this,this.NEk,
"onLoginResponse"));this.sF.Iu(Z.a.Dzh);this.sF.dC(Z.a.Dzh,Object(N.a)(this,this.lEk,"onInteractiveFlowReady"));this.sF.Iu(Z.a.Bzh);this.sF.dC(Z.a.Bzh,Object(N.a)(this,this.VDk,"onHideDialog"));this.sF.Iu(Z.a.yzh);this.sF.dC(Z.a.yzh,Object(N.a)(this,this.BBk,"onCloseDialog"))}cvd(oa){const Da=new O;Da.startTime=sa.a.vj();const ta=new Promise((ha,Ha)=>{Da.resolve=ha;Da.reject=Ha});Da.jEf=ta;this.LPa[oa]=Da;return ta}ZDk(){const oa=sa.a.vj()-this.MBc;h.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",
oa)}dMe(oa){const {OAuthManager:Da}=d(553),ta=sa.a.vj()-this.MBc,ha=Object.assign(new Ma.a,{durationMs:ta});ja.Health.instance.recordKpiFailure(Da.kpiName,"SharedAuthWACOAuthAspxFrameError",!1,!0,ha);h.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",ta,this.Aff?JSON.stringify(oa):"")}iHk(oa){const {OAuthManager:Da}=d(553),ta=this.LPa.loadFrame;var ha=sa.a.vj()-ta.startTime,Ha=oa.Values.AuthLibrary.toString();oa=oa.Values.Success.toString();h.ULS.sendTraceTag(573112902,
3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",oa,Ha,ha);Ha&&(this.Rrb="SharedAuthTokenStrategy "+Ha);Ha=Boolean.parse(oa);Ha||(oa=I.a.aA(),void 0!==oa&&null!==oa&&(oa.set("AuthLibrary",this.B8b()),ha=Object.assign(new Ma.a,{durationMs:ha,extendedProperties:oa}),ja.Health.instance.recordKpiFailure(Da.kpiName,"SharedAuthStrategyInitFailed",!1,!0,ha)));ta.resolve(Ha?0:1)}hHk(oa){if(oa.Values.interactive&&this.ksb&&this.ksb.Values.messageCorrelationId){const ta=
this.ksb.Values.messageCorrelationId.toString();if(oa.Values.interactive&&this.RZ){this.RZ.ZTi.then(ha=>{this.sF.Vkb(this.ksb,this.RZ.zzh.contentWindow,this.yca);this.RZ.ixl(ta,ha);this.RZ.rOh(!0);this.ksb=null});return}}oa=this.LPa.initFrame;const Da=sa.a.vj()-oa.startTime;h.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",Da);oa.resolve(0)}GDk(oa){if(oa.Values.messageCorrelationId&&oa.Values.messageCorrelationId.toString()){var Da=oa.Values.messageCorrelationId.toString(),
ta=this.LPa[Da];if(ta){var ha=sa.a.vj()-ta.startTime;h.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",ha);oa.Values.isSuccess&&oa.Values.isSuccess?ta.resolve(oa.Values.response):ta.reject(oa.Values.response);this.jLh(Da)}else h.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else h.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")}lEk(){if(this.RZ.$Ti)this.RZ.e2f();
else if(this.iBd&&this.RZ){const oa=new da.a(Z.a.Czh);oa.Values=this.ODf(this.iBd,!0);this.sF.Vkb(oa,this.RZ.zzh.contentWindow,this.yca)}}VDk(){this.RZ&&this.RZ.vge()}BBk(oa){oa.Values.cancelled&&oa.Values.cancelled&&oa.Values.messageCorrelationId&&this.jLh(oa.Values.messageCorrelationId.toString());this.RZ&&this.RZ.hide()}ODf(oa,Da=!1){const ta={};ta.appIds=this.Aaj();ta.upn=oa.loginHint;ta.authority=oa.authority;ta.authorityType=Object(e.a)(m,oa.authorityType);ta.tenantId=oa.tenantId;ta.correlationId=
B.AFrameworkApplication.userSessionId;ta.enableConsoleLogging=this.Aff;ta.enablePopupFlash=this.RXh;ta.skipUpnCheck=this.R7h;ta.interactive=Da;return ta}Aaj(){const oa=[],Da=D.OAuthManagerSettings.lUd;for(let ha in Da){var ta=Da[ha];Array.contains(oa,ta)||Array.add(oa,ta)}return oa}qxd(oa,Da,ta,ha,Ha,bb){const Na=new da.a(Z.a.crl),Ia=this.dag();Na.Values=this.FKh(oa,Da,ta,ha,Ha,bb,Ia);this.Juf=Na;oa=this.cvd(Ia);h.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",
Da);this.Wul();return oa}tvd(){return!0}Wul(){this.yqb||(this.yqb=new R.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.yqb.id=16,this.yqb.Q1c=!1,this.yqb.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{h.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");this.sF.Vkb(this.Juf,this.gB.contentWindow,this.yca)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),B.AFrameworkApplication.Aa.ob.wIc(this.yqb,
!0)||h.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}NEk(oa){if(oa.Values.messageCorrelationId&&oa.Values.messageCorrelationId.toString()){var Da=this.LPa[oa.Values.messageCorrelationId.toString()];if(Da){var ta=sa.a.vj()-Da.startTime;h.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",ta);oa.Values.isSuccess&&oa.Values.isSuccess?Da.resolve(oa.Values.response):Da.reject(oa.Values.response)}else h.ULS.sendTraceTag(555049440,
3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else h.ULS.sendTraceTag(555049439,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")}jLh(oa){this.Y4a&&this.Y4a.correlationId===oa&&(this.Y4a.resolve(null),this.Y4a=null)}}Object(K.a)(Ea,"SharedAuthTokenStrategy",null,[286]);class ma{constructor(oa){this.LMd=oa;this.Rrb="UnsupportedAuthTokenStrategy Reason="+r.a[this.LMd]}initialize(){return Promise.resolve(0)}K4c(){return Promise.resolve(0)}gI(){return Promise.resolve(Object.assign(new n.a,
{IsSuccess:!1,ErrorCode:r.a[this.LMd],ErrorMessage:"Unable to get a token. Reason: ["+r.a[this.LMd]+"]"}))}qxd(){return Promise.resolve(Object.assign(new n.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}tvd(){return!1}B8b(){return this.Rrb}}Object(K.a)(ma,"UnsupportedAuthTokenStrategy",null,[286]);var va=d(194);d.d(U,"OAuthManager",function(){return Ca});class Ca{constructor(oa=null){this.tZ=
0;this.uZ=null;this.c6a=0;this.okf=!!window.location.search.match(RegExp("wdpa=1","gi"));const Da=sa.a.vj();this.j_h=this.yTi(oa).then(ta=>ta?this.gMj():(h.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.pE(),Math.floor(sa.a.vj()-Da)),ta=I.a.aA(),void 0!==ta&&null!==ta&&(ta.set("AuthLibrary",this.pE()),ta=Object.assign(new Ma.a,{durationMs:Math.floor(sa.a.vj()-Da),extendedProperties:ta}),ja.Health.instance.recordKpiFailure(Ca.kpiName,
"StrategyPickFailed",!1,!0,ta)),Promise.resolve(1))).then(ta=>0!==ta?Promise.resolve(ta):this.v9j())}zTi(){if(this.okf)this.tZ=5,this.uZ=new ma(this.tZ);else{var oa=D.OAuthManagerSettings.vwk;oa&&0<oa.length?(this.tZ=1,this.uZ=new z(oa)):B.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||B.AFrameworkApplication.fa.ka("IsO365CommercialHost")?B.AFrameworkApplication.fa.ka("IsAnonymousUser")?(this.tZ=2,this.uZ=new ma(this.tZ)):(oa=v.a.getAuthContext().loginHint)&&oa.length?D.OAuthManagerSettings.lbb?
(this.tZ=1,this.uZ=new M):(this.tZ=1,this.uZ=new Ea):(this.tZ=3,this.uZ=new ma(this.tZ)):(this.tZ=4,this.uZ=new ma(this.tZ))}}pE(){return this.uZ?this.uZ.B8b()||"Unknown":"None"}yTi(oa=null){h.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const Da=sa.a.vj();return B.AFrameworkApplication.fa.Nhj().then(ta=>{ta?(this.zTi(),oa&&(this.uZ=oa),h.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",
D.OAuthManagerSettings.clientVersion,D.OAuthManagerSettings.appVersion,D.OAuthManagerSettings.iWi,this.pE(),Math.floor(sa.a.vj()-Da))):h.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(sa.a.vj()-Da));return Promise.resolve(ta)},()=>{h.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",
Math.floor(sa.a.vj()-Da));return Promise.resolve(!1)})}gMj(){h.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.pE());const oa=sa.a.vj();return x.get(this.uZ.initialize(),2,D.OAuthManagerSettings.vRe).then(Da=>{if(0===Da)h.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.pE(),Math.floor(sa.a.vj()-oa));else if(1===Da){h.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.pE(),Math.floor(sa.a.vj()-
oa));var ta=I.a.aA();void 0!==ta&&null!==ta&&(ta.set("AuthLibrary",this.pE()),ta=Object.assign(new Ma.a,{durationMs:Math.floor(sa.a.vj()-oa),extendedProperties:ta}),ja.Health.instance.recordKpiFailure(Ca.kpiName,"StrategyInitFailed",!1,!0,ta))}else 2===Da&&(h.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.pE(),Math.floor(sa.a.vj()-oa)),ta=I.a.aA(),void 0!==ta&&null!==ta&&(ta.set("AuthLibrary",this.pE()),ta=Object.assign(new Ma.a,
{durationMs:Math.floor(sa.a.vj()-oa),extendedProperties:ta}),ja.Health.instance.recordKpiFailure(Ca.kpiName,"StrategyInitTimedOut",!1,!0,ta)));return Promise.resolve(Da)},()=>{h.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.pE(),Math.floor(sa.a.vj()-oa));return Promise.resolve(1)})}v9j(){h.ULS.sendTraceTag(562128581,3E3,50,"Loading {0}",this.pE());const oa=sa.a.vj();return x.get(this.uZ.K4c(v.a.getAuthContext()),2,D.OAuthManagerSettings.vRe).then(Da=>
{if(0===Da)h.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.pE(),Math.floor(sa.a.vj()-oa));else if(1===Da){h.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.pE(),Math.floor(sa.a.vj()-oa));var ta=I.a.aA();void 0!==ta&&null!==ta&&(ta.set("AuthLibrary",this.pE()),ta=Object.assign(new Ma.a,{durationMs:Math.floor(sa.a.vj()-oa),extendedProperties:ta}),ja.Health.instance.recordKpiFailure(Ca.kpiName,"StrategyLoadFailed",
!1,!0,ta))}else 2===Da&&(h.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.pE(),Math.floor(sa.a.vj()-oa)),ta=I.a.aA(),void 0!==ta&&null!==ta&&(ta.set("AuthLibrary",this.pE()),ta=Object.assign(new Ma.a,{durationMs:Math.floor(sa.a.vj()-oa),extendedProperties:ta}),ja.Health.instance.recordKpiFailure(Ca.kpiName,"StrategyLoadTimedOut",!1,!0,ta)));return Promise.resolve(Da)},()=>{h.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",
this.pE(),Math.floor(sa.a.vj()-oa));return Promise.resolve(1)})}gI(oa,Da,ta=null){return this.GQb(oa,Da,!1,null,"",ta)}GKh(oa,Da,ta,ha,Ha=null){return this.GQb(oa,Da,!0,ta,ha,Ha)}GQb(oa,Da,ta,ha,Ha,bb,Na=0){Na+=1;h.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",oa,this.Ikb(oa,Da),this.pE(),Na);var Ia=I.a.aA();void 0!==Ia&&null!==Ia&&(Ia.set("AuthLibrary",this.pE()),Ia.set("AppName",oa),Ia.set("Target",this.Ikb(oa,Da)),
ja.Health.instance.recordKpiUsage(Ca.kpiName,0,"WacOAuthFC",Ia));if(!D.OAuthManagerSettings.isEnabled||this.okf){var Qa;return this.nse((Qa=new n.a,Qa.IsSuccess=!1,Qa.Token=null,Qa.ErrorCode="NotEnabled",Qa.ErrorMessage="OAuthManager is disabled.",Qa),oa)}const qa=D.OAuthManagerSettings.lUd[oa];if(void 0===qa||null===qa){h.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",oa);var Wa;return this.nse((Wa=new n.a,
Wa.IsSuccess=!1,Wa.Token=null,Wa.ErrorCode="DisallowedApp",Wa.ErrorMessage="Disallowed appName: "+oa,Wa),oa)}const Hb=sa.a.vj();let jc=Hb;const gc=this;Ia=this.j_h.then(Xb=>{jc=sa.a.vj();return gc.MRj(oa,qa,Da,ta,ha,Ha,bb,Xb)});Qa=ta?0:D.OAuthManagerSettings.vRe;let $b;Wa=($b=new n.a,$b.IsSuccess=!1,$b.Token=null,$b.ErrorCode="authTokenStrategy_timeout",$b.ErrorMessage="Auth Strategy timed out after ["+Qa+"] ms when fetching token",$b);let wb=this,Db=this;return x.get(Ia,Wa,Qa).then(Xb=>Na<=Ca.ivk&&
(Xb.ErrorCode===Ca.NIh||Xb.ErrorCode===Ca.OBl)?(h.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",Na,Math.floor(sa.a.vj()-Hb)),wb.GQb(oa,Da,ta,ha,Ha,bb,Na)):Xb.ErrorCode===Ca.Atg&&!ta&&(h.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",Na,Ca.AWf),Ca.vYi&&wb.uZ.tvd()&&wb.uZ.qxd(oa,qa,Da,ta,ha,Ha).then(ab=>Promise.resolve(wb.$4c(ab,oa,Da,qa,Hb,jc))).catch(()=>{let ab;const Ab=(ab=new n.a,
ab.IsSuccess=!1,ab.Token=null,ab.ErrorCode="authTokenStrategy_failure",ab.ErrorMessage="LoginPopup failed, GetToken could not be called",ab);return Promise.resolve(wb.$4c(Ab,oa,Da,qa,Hb,jc))}),Ca.AWf)?wb.GQb(oa,Da,!0,ha,Ha,bb,Na):Promise.resolve(wb.$4c(Xb,oa,Da,qa,Hb,jc))).catch(()=>{let Xb;const ab=(Xb=new n.a,Xb.IsSuccess=!1,Xb.Token=null,Xb.ErrorCode="authTokenStrategy_failure",Xb.ErrorMessage="Auth Strategy failed with an unknown error",Xb);return Promise.resolve(Db.$4c(ab,oa,Da,qa,Hb,jc))})}MRj(oa,
Da,ta,ha,Ha,bb,Na,Ia){return 1===Ia||2===Ia?this.nse(Object.assign(new n.a,{IsSuccess:!1,Token:null,ErrorCode:1===Ia?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),oa):this.uZ.gI(oa,Da,ta,ha,Ha,bb,Na).then(Qa=>Promise.resolve(this.X5g(Qa,!0,oa))).catch(Qa=>Promise.resolve(this.X5g(Qa,!1,oa)))}$4c(oa,Da,ta,ha,Ha,bb){const Na={},Ia=sa.a.vj()-bb;Na.IsSuccess=oa.IsSuccess;Na.ErrorCode=oa.IsSuccess?"Success":oa.ErrorCode||"";Na.ErrorMessage=oa.IsSuccess?"Success":this.Ikb(Da,
oa.ErrorMessage||"");Na.Target=this.Ikb(Da,ta||"");Na.TimeInMS=Math.floor(Ia);Na.LoadTimeInMS=Math.floor(bb-Ha);Na.AuthLibrary=this.pE();Na.AppName=Da;Na.AuthorityType=Object(e.a)(m,v.a.iUc());Na.UserType=this.wwj(v.a.getAuthContext());Na.IsAuthSupportedInSession=r.a[this.tZ];Na.RequestCount=++this.c6a;Na.AppId=ha;h.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(Na));oa.IsSuccess||(ta=I.a.aA(),void 0!==ta&&null!==ta&&(ta.set("AppName",Da),ta.set("AuthLibrary",this.pE()),ta.set("ErrorCode",oa.ErrorCode),
ta.set("ErrorMessage",this.Ikb(Da,oa.ErrorMessage)),Da=Object.assign(new Ma.a,{durationMs:Ia,extendedProperties:ta}),ja.Health.instance.recordKpiFailure(Ca.kpiName,"TryGetTokenFailure",!1,!0,Da)));return oa}nse(oa,Da){h.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",Da,this.Ikb(Da,oa.ErrorMessage));const ta=I.a.aA();void 0!==ta&&null!==ta&&(ta.set("AppName",Da),ta.set("AuthLibrary",this.pE()),ta.set("ErrorCode",oa.ErrorCode),ta.set("ErrorMessage",
this.Ikb(Da,oa.ErrorMessage)),Da=Object.assign(new Ma.a,{extendedProperties:ta}),ja.Health.instance.recordKpiFailure(Ca.kpiName,"FailureBeforeGetToken",!1,!0,Da));return Promise.resolve(oa)}wog(oa){return oa===va.a.pwd}Ikb(oa,Da){return this.wog(oa)&&Da?"REDACTED":Da}wwj(oa){return B.AFrameworkApplication.fa.ka("IsAnonymousUser")?"anonymous":!oa.loginHint||1>oa.loginHint.length?"empty":-1<oa.loginHint.indexOf("guest#")?"guest":-1<oa.loginHint.indexOf("ext#")?"external":0>oa.upn.indexOf("@")?"no-at":
"supported"}mmg(){return 1===this.tZ}X5g(oa,Da,ta){let ha=null,Ha=null,bb=null,Na=null;oa?oa.ErrorCode||oa.ErrorMessage?(Ha=oa.ErrorCode?oa.ErrorCode:Ca.vYf,bb=oa.ErrorMessage?oa.ErrorMessage:"No message"):oa.Token?Da?ha=oa.Token:(Ha=Ca.a5k,bb="A rejected promise returned a token."):(Ha=Ca.vYf,bb=JSON.stringify(oa)):(Ha=Ca.gyk,bb="No result came from Auth Token Strategy");oa&&oa.Telemetry&&!this.wog(ta)&&(Na=oa.Telemetry,h.ULS.sendTraceTag(579166408,3E3,50,JSON.stringify(Na)));if(Ha===Ca.Gwk||Ha===
Ca.XGl)Ha=Ca.NIh,bb="Auth Library Timed Out";Ha===Ca.qoi&&-1<bb.indexOf(Ca.W$h)&&(Ha=Ca.Atg);if(Ha||bb)ha=null;return Object.assign(new n.a,{IsSuccess:!!ha,Token:ha,ErrorCode:Ha,ErrorMessage:bb,Telemetry:Na})}static get AWf(){return B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}static get vYi(){return B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",!1)}}Ca.XGl="token_renewal_error";
Ca.vYf="Exception";Ca.gyk="NoResult";Ca.a5k="RejectToken";Ca.Gwk="monitor_window_timeout";Ca.NIh="Timeout";Ca.OBl="authTokenStrategy_timeout";Ca.qoi="login_required";Ca.W$h="AADSTS50058";Ca.Atg="Cookies Disabled";Ca.kpiName="OAuthManager";Ca.ivk=2;Object(K.a)(Ca,"OAuthManager",null,[232])},557:function(K,U,d){K=d(0);var h=d(392),e=d(357),r=d(56),m=d(67),n=d(177),z=d(93),v=d(27);d(7);var x=d(36),B=d(50),D=d(100);class w{constructor(){this.gjb=this.m6=null;this.gJh=0}}Object(K.a)(w,"CandidateManager",
null,[]);var J=d(667),G=d(665),M=d(666);class N{constructor(){this.keyCode=0;this.XUl=this.WUl=null}}Object(K.a)(N,"PredictionKeptState",null,[]);class R{constructor(){this.values={}}jjg(Da,ta,ha){Da=this.Gbg(Da);Da[ta]=ta in Da?Da[ta]+ha:ha}add(Da,ta,ha){this.Gbg(Da)[ta]=ha}ga(Da){return this.values[Da]}$(Da,ta){return this.values[Da]=ta}TMf(Da){return Da in this.values?!0:!1}Gbg(Da){let ta;Da in this.values?ta=this.values[Da]:(ta={},this.values[Da]=ta);return ta}}Object(K.a)(R,"PredictionState",
null,[]);class C{constructor(){this.WordPredIsEnabled=!0;this.PredictionSeenCount=0;this.PredictionAccepted=!1}}Object(K.a)(C,"TypeAheadRoamingSettings",null,[]);var O=d(205),S=d(1244),T=d(18),ca=d(933),L=d(668);d(935);var da=d(934);class Z{constructor(Da){this.yyc=null;this.UD=Da;Da=r.a.instance.resolve("Common.IDynamicScriptLoaderProvider").rI;const ta=r.a.instance.resolve("Common.ISharedDependencyLoader");this.initialize(Da,ta)}initialize(Da,ta){const ha=new L.a;return Da?ta?this.yyc?this.yyc:
v.AFrameworkApplication.Aa.ob.Xng?this.yyc=new Promise((Ha,bb)=>{const Na=v.AFrameworkApplication.lj("al",2);ta.BCb(Na).continueWith(Ia=>{Ia.Dm?(this.q$g(),bb(Ia.ej.message)):(this.Ljg(ha),Ha({}))})}):this.yyc=Da.loadScript("al").then(()=>{this.Ljg(ha)}).catch(Ha=>{this.q$g();return Promise.reject(Ha)}):Promise.reject("SharedDependencyLoader is null"):Promise.reject("DynamicScriptLoader is null")}Ljg(Da){Z.pT.tG(()=>{h.ULS.sendTraceTag(595091613,3010,50,"AugLoop TextPrediction Load success");const ta=
augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();let ha=v.AFrameworkApplication.fa.Ha("OfficeApplicationName")||"";ha=ha.replace("Web","");Da.appName=Da.appName||ha;Da.serviceUrl=Da.serviceUrl||v.AFrameworkApplication.fa.Ha("AugLoopCloudALServiceUrl");Da.appVersion=Da.appVersion||v.AFrameworkApplication.fa.Ha("BuildVersion")||"";Da.releaseAudienceGroup=Da.releaseAudienceGroup||(v.AFrameworkApplication.Od?Object(S.a)(String,v.AFrameworkApplication.Od.AudienceGroup)||"":"");Da.sessionId=Da.sessionId||
v.AFrameworkApplication.fa.Ha("SessionId")||"";Da.uiLanguage=Da.uiLanguage||v.AFrameworkApplication.uiCulture;Da.flights=this.Laj();Da.initSession=Da.initSession||!0;ta.initialize(Da);ta.activateAnnotation(Object.assign(new ca.a,{annotationType:da.a.getTypeName(),handler:this.UD}))},"WordPredictionAL:Initialize")}q$g(){h.ULS.sendTraceTag(595091612,3010,50,"AugLoop TextPrediction Load Fail")}Laj(){var Da=v.AFrameworkApplication.fa.Ha("FlightId"),ta=v.AFrameworkApplication.fa.eA("AugLoopFlightKeywordList");
Da=this.e4i(Da,ta);ta="";0<Da.length&&(ta=O.a.join(Da,";"),h.ULS.sendTraceTag.apply(null,[595091610,3010,50,"FlightCount: [{0}], flightIds: [{1}]",Da.length].concat(Da)));return ta}e4i(Da,ta){const ha=new T.a;if(Da&&""!==Da&&ta&&0<ta.length){for(let Ha=0;Ha<ta.length;Ha++)ta[Ha]=ta[Ha].toLowerCase();Da=Da.toLowerCase().split(";");for(const Ha of Da)O.a.any(ta,bb=>-1<Ha.indexOf(bb))&&ha.add(Ha)}return ha.toArray()}static get pT(){return e.a.instance}}Object(K.a)(Z,"WordPredictionAugLoopHandler",null,
[997]);var fa=d(142),aa=d(184),ja=d(112);class I{constructor(Da,ta,ha,Ha){this.Y3b=null;this.x3g=Da;this.vil=ha;this.uxi=Ha;this.fil=ta;this.lPc=Array(Da);this.erh();this.srh()}LLj(Da,ta,ha){Da>this.x3g-1||this.ijg(this.lPc[Da],ta,ha)}wbb(Da,ta){this.ijg(this.Y3b,Da,ta)}aSd(Da,ta){this.Y3b[Da]=ta}flush(){I.pT.tG(()=>{for(let Da=0;Da<this.lPc.length;Da++){const ta=this.G$i(Da);ta&&(ta.dataFields.push(Object.assign(new ja.a,{name:G.a.EP,int64:Da})),fa.a.sendActivityEvent(ta))}this.erh()},"WPT:F")}X6i(){I.pT.tG(()=>
{const Da=this.F$i();Da&&fa.a.sendActivityEvent(Da);this.srh()},"WPT:FSD")}S6i(Da){I.pT.tG(()=>{const ta=this.E$i(Da);ta&&fa.a.sendActivityEvent(ta)},"WPT:FCD")}F$i(){const Da=this.ube(this.vil);for(var ta=0;ta<M.a.DTa.length;ta++)this.bSd(M.a.DTa[ta],this.Y3b,Da.dataFields);for(ta=0;ta<M.a.X6b.length;ta++)this.v_b(M.a.X6b[ta],this.Y3b,Da.dataFields);return Da.dataFields.length?Da:null}G$i(Da){const ta=this.ube(this.fil);for(let ha=0;ha<G.a.DTa.length;ha++)this.bSd(G.a.DTa[ha],this.lPc[Da],ta.dataFields);
return ta.dataFields.length?ta:null}E$i(Da){const ta=this.ube(this.uxi);for(var ha=0;ha<J.a.DTa.length;ha++)this.bSd(J.a.DTa[ha],Da,ta.dataFields);for(ha=0;ha<J.a.X6b.length;ha++)this.v_b(J.a.X6b[ha],Da,ta.dataFields);return ta.dataFields.length?ta:null}ijg(Da,ta,ha){Da[ta]=ta in Da?Da[ta]+ha:ha}ube(Da){const ta=new aa.a;ta.name=Da;ta.dataFields=[];return ta}bSd(Da,ta,ha){Da in ta&&Array.add(ha,Object.assign(new ja.a,{name:Da,int64:ta[Da]}))}v_b(Da,ta,ha){Da in ta&&Array.add(ha,Object.assign(new ja.a,
{name:Da,string:ta[Da]}))}erh(){for(let Da=0;Da<this.x3g;Da++)this.lPc[Da]={}}srh(){this.Y3b={}}static get pT(){return e.a.instance}}Object(K.a)(I,"WordPredictionTelemetryHandler",null,[996]);var sa=d(64),ka=d(34),Ma=d(390),Ea=d(304),ma=d(91);d(238);var va=d(51),Ca=d(35);d(313);d(334);d(1077);d.d(U,"a",function(){return oa});class oa{static get pT(){return e.a.instance}static get jE(){oa.Wyc||(oa.Wyc=new w);return oa.Wyc}static set jE(Da){oa.Wyc=Da}static get w2c(){return oa.Uvf}static set w2c(Da){oa.Uvf=
Da}static get QQh(){oa.pRd||(oa.pRd=oa.xNi());return oa.pRd}static get settings(){oa.lGc||(oa.lGc=Object.assign(new C,{WordPredIsEnabled:!0,PredictionSeenCount:0,PredictionAccepted:!1}));return oa.lGc}static set settings(Da){oa.lGc=Da}static get N_a(){oa.jMd||(oa.jMd=new R);return oa.jMd}static get KEl(){return oa.XRi}static get O6(){oa.rRd||(oa.rRd=new I(oa.KEl,"Office.Word.Online.WordPredictionTelemetryData","Office.Word.Online.WordPredictionTelemetryDataPerSession","Office.Word.Online.WordPredictionTelemetryDataPerCandidate"));
return oa.rRd}static get FQi(){return oa.g7a?oa.g7a.instance?oa.g7a.instance.G3:1:(oa.g7a=r.a.instance.Ia("Common.IZoomManager"),oa.g7a&&oa.g7a.instance?oa.g7a.instance.G3:1)}static get characterPropertiesEditor(){oa.hCd||(oa.hCd=r.a.instance.resolve("Box4.ICharacterPropertiesEditor"));return oa.hCd}static get ymd(){oa.uMd||r.a.instance.Ia("Box4.Proofing.IProofingSentenceSeparator").execute(Da=>{Da&&(oa.uMd=Da)});return oa.uMd}static get YUl(){oa.qRd||(oa.qRd=r.a.instance.resolve("Box4.WordPrediction.IWordPredictionSettingsInfo"));
return oa.qRd}static gfl(){window.setTimeout(()=>{const Da={};Da.WordPredIsEnabled=oa.settings.WordPredIsEnabled;Da.PredictionSeenCount=oa.settings.PredictionSeenCount;Da.PredictionAccepted=oa.settings.PredictionAccepted;oa.YUl.BYl(x.c(Da))},oa.FRf)}static efe(Da,ta){if(!Da||!ta||Da.eventName!==m.a.gRa)return!1;const ha=Da.mc.keyCode;if(oa.xmg(ta)){oa.i3k();ta=ta.node;if((ha===n.a.BP||ha===n.a.$q)&&oa.$Va)return z.a.Kn(Da.mc),oa.jQj(ta),oa.EPl(ha),h.ULS.sendTraceTag(578307398,820,50,"Prediction Text Accepted"),
!0;if(ha===n.a.zK)oa.w2c&&(oa.w2c=!1);else if(ha===n.a.mZ&&oa.$Va)oa.w2c=!0,h.ULS.sendTraceTag(578307397,820,50,"Prediction Text Rejected"),oa.dVa();else if(ha===n.a.Unb&&Da.mc.ctrlKey&&oa.iMd)return h.ULS.sendTraceTag(578307396,820,50,"Prediction Undid"),oa.qrh(),!1}if(ha===n.a.Bnb&&Da.mc.shiftKey||ha===n.a.Dba&&Da.mc.ctrlKey||ha===n.a.kNa&&Da.mc.altKey)return!1;ta=oa.jE.m6;const Ha=ha===n.a.nZ||ha===n.a.f7||ha===n.a.rha||ha===n.a.Eba;if(Ha||Ha&&(Da.mc.ctrlKey||Da.mc.shiftKey)||ha!==n.a.Dba&&Da.mc.ctrlKey||
ha!==n.a.kNa&&Da.mc.altKey||ha===n.a.iI||oa.$Va&&ta&&0<ta.j9.length&&!ta.j9.toLowerCase().startsWith(String.fromCharCode(ha).toLowerCase()))oa.dVa(),oa.jE.m6=null,h.ULS.sendTraceTag(578307395,820,50,"Prediction hidden due to user typing a character that did not match prediction");oa.qrh();return!1}static cFj(){5>oa.settings.PredictionSeenCount&&(oa.settings.PredictionSeenCount+=1)}static dVa(){Ma.a.dVa();oa.$Va=!1}static jQj(Da){oa.pT.tG(()=>{var ta=document.getElementById("inlinePredictedWord");
if(ta){var ha=ta.innerText;if(ha&&0<ha.length&&(Da=Da?Da:oa.jnj())){var Ha=new B.GraphTransaction(7);Ha.ld(Da);var bb=Da.Ta.last,Na=va.a.YRa(Da),Ia=ma.a.Bs(Na);bb.formatting=Ia.fe(bb);oa.characterPropertiesEditor.replaceTextRange(Na,ha,!0,!0,Ca.a.typing);Ha.dispose();ha=D.InteractiveViewManager.instance.Rd;Ha=Da.tg(ha.Na);Ha=Ea.a.$t(Ha,ka.ParagraphReader.textLength(Da));bb=new Sys.UI.Point(Ha.x,Ha.y);bb.y+=Ha.height;ha.Y6(bb,null,null,ha,!1);oa.$Va=!1;ta.innerText="";(ta=document.getElementById("inlinePlaceholderTab"))&&
oa.$fg()&&(ta.className="hidePanel")}}},"WPT:IIG")}static mml(Da){oa.Osf=Da;oa.O6.aSd(M.a.modelId,Da.modelId);oa.O6.aSd(M.a.modelVersion,Da.modelVersion);oa.O6.aSd(M.a.configId,Da.configId)}static zlj(){return oa.Osf}static JUd(Da,ta){const ha=oa.QQh;var Ha=document.getElementById("inlinePredictedWord");Ha&&(Ha.innerText=ta,(ta=document.getElementById("WACViewPanel_EditingElement_WrappingDiv").getElementsByClassName("TextRun"))&&0<ta.length&&(ta=ta[ta.length-1],Ha.style.fontSize=ta.style.fontSize,
Ha.style.fontFamily=ta.style.fontFamily,Ha.style.color=ta.style.color,Ha.style.whiteSpace="pre",Ha=Ha.parentNode,Da="suggestion: "+Da,ta=document.getElementById("inlinePlaceholderTab"),ta.className="hidePanel",ta&&oa.$fg()&&(ta.className="inlinePlaceholderTab",Da+=". Tab to accept"),Ha.parentNode.setAttribute("aria-label",Da)),ha&&(ha.className="textareaCaretTracker"),oa.anl()&&(oa.$Va=!0,h.ULS.sendTraceTag(578307393,820,50,"Ghost Text Visible")))}static xmg(Da){Da||(Da=oa.Bdj());if(Da){const ta=
Da.node;try{return ka.ParagraphReader.textLength(ta)<=Da.Sa}catch(ha){}}return!1}static mak(Da){Da=oa.N_a.ga(Da);Da=Da[M.a.jUd]-Da[M.a.nuc];300<Da?(oa.O6.wbb(M.a.lSf,Da),oa.O6.wbb(M.a.kSf,1)):(oa.O6.wbb(M.a.NDf,Da),oa.O6.wbb(M.a.YAf,1))}static X7d(Da){oa.tog("TextPredictionTelemetryIsEnabled")&&oa.O6.S6i(Da)}static awg(Da,ta){Da=oa.N_a.ga(Da);const ha=Da[M.a.nuc];ta?oa.O6.wbb(M.a.gDh,Da[M.a.ZAf]-ha):oa.O6.wbb(M.a.eDh,Da[M.a.XAf]-ha)}static udc(Da){oa.O6.wbb(Da,1)}static pva(Da,ta,ha){oa.O6.LLj(Da,
ta,ha)}static Mpd(){oa.jE.m6=null;oa.jE.gjb=null}static kSk(){oa.dnb("TextPredictionsSeen","TextPredictionsSeenIsEnabled");oa.cFj();oa.KRj()}static dnb(Da,ta){oa.tog(ta)&&window.setTimeout(()=>{const ha=r.a.instance.Ia("Common.ISystemInitiatedFeedback");ha&&ha.execute(Ha=>{Ha.logActivity(Da,ta)})},oa.FRf)}static tog(Da){return!!v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.ka(Da)}static xNi(){var Da=document.body;const ta=document.createElement("div");if(Da){Da.appendChild(ta);ta.setAttribute("id",
"textareaCaretTracker");ta.className="hidePanel";ta.setAttribute("role","alert");Da=document.createElement("button");const ha=document.createElement("span");Da.setAttribute("disabled",!0);Da.setAttribute("aria-disabled",!0);Da.setAttribute("aria-hidden",!0);ha.setAttribute("aria-disabled",!0);ha.setAttribute("aria-hidden",!0);ha.setAttribute("id","inlinePredictedWord");ha.className="inlinePredictedWord";Da.className="inlinePredictedWordButton";Da.appendChild(ha);ta.appendChild(Da);ta.appendChild(oa.hPi());
(Da=document.getElementById("WACViewPanel"))&&$addHandler(Da,"scroll",oa.ZCj)}return ta}static anl(){const Da=oa.QQh;var ta=document.getElementById("WACViewPanel_EditingElement_WrappingDiv");ta=(ta=ta?ta.getElementsByClassName("EOP")[0]:null)?ta.getBoundingClientRect():null;return Da&&ta?(Da.style.cssText="transform: scale("+oa.FQi+"); transform-origin: 0% 0%",Da.style.top=ta.top+"px",Da.style.left=ta.left+"px",!0):!1}static $fg(){return!oa.settings.PredictionAccepted}static KRj(){5!==oa.settings.PredictionSeenCount||
oa.settings.PredictionAccepted||(oa.dnb("PredictionNotAccepted","PredictionNotAcceptedIsEnabled"),oa.gfl())}static hPi(){const Da=document.createElement("button");Da.setAttribute("aria-hidden",!0);Da.className="hidePanel";Da.id="inlinePlaceholderTab";Da.disabled=!0;Da.innerText="Tab";return Da}static ZCj(){oa.dVa()}static jnj(){const Da=sa.a.instance.Pa.mb;return Da&&Da.jf?Da.jf.node:null}static i3k(){oa.NPd||(oa.NPd=window.setTimeout(oa.nBj,6E4*oa.WRi))}static nBj(){oa.O6.flush();oa.O6.X6i();oa.NPd=
0}static B8f(Da){return Da&&0<Da.length&&(Da=Da.split(" "),0<Da.length)?Da[Da.length-1].length:-1}static EPl(Da){const ta=oa.jE.m6,ha=oa.jE.gjb;ta&&(oa.iMd=Object.assign(new N,{keyCode:Da,WUl:ta,XUl:ha}))}static Bdj(){const Da=sa.a.instance.Pa.mb;return Da&&Da.jf?Da.jf:null}static qrh(){oa.iMd=null}}oa.XRi=30;oa.WRi=5;oa.FRf=5E3;oa.pRd=null;oa.uMd=null;oa.hCd=null;oa.g7a=null;oa.Uvf=!1;oa.NPd=0;oa.rRd=null;oa.jMd=null;oa.iMd=null;oa.qRd=null;oa.lGc=null;oa.Osf=null;oa.Wyc=null;oa.$Va=!1;Object(K.a)(oa,
"WordPredictionHandler",null,[])},664:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}h.byk="NoCharacterPositionOnLine";h.dyk="NoCharacterPositionOnSpan";h.cyk="NoCharacterPositionOnMultilineSpan";h.D4b="DoNothingResult";h.ska="FailedProcessingStep";h.e$a="FailedResult";h.USc="FirstChildNotText";h.M5i="FirstChildNull";h.TQj="InvalidCharacterPositionResult";h.zh="NoExecute";h.$o="NoApply";h.h2="UnexpectedState";Object(K.a)(h,"ActivityEventName",null,[])},665:function(K,U,d){d.d(U,"a",
function(){return h});K=d(0);class h{}h.EP="WordIndex";h.Qph="RenderedCandidateCount";h.Z5g="NotRenderedCandidateCount";h.BIf="CandidateListCount";h.JQf="CumulativeIndexOfSeen";h.pQi="CumulativeIndexOfRejected";h.oQi="CumulativeIndexOfKept";h.IQf="CumulativeIndexOfCorrect";h.nQi="CumulativeIndexOfAcceptedCandidate";h.Huh="SeenCount";h.b5k="RejectedCount";h.Y6j="KeptCount";h.ILh="TypedThroughCount";h.qQi="CumulativeScoreOfKept";h.rQi="CumulativeScoreOfRejected";h.LQf="CumulativeScoreOfTypeThrough";
h.Rph="RenderedCharSum";h.X6j="KeptCharSum";h.W6j="KeptCandidateTokenSum";h.FLl="UndoOfKeptCount";h.ILl="UndoneKeptCharCount";h.JLh="TypedThroughLastMatchingCharCount";h.language="Language";h.DTa=[h.Qph,h.Z5g,h.BIf,h.JQf,h.pQi,h.oQi,h.IQf,h.nQi,h.Huh,h.b5k,h.Y6j,h.ILh,h.qQi,h.rQi,h.LQf,h.Rph,h.X6j,h.W6j,h.FLl,h.ILl,h.JLh,h.language];Object(K.a)(h,"DataFieldsPerSentence",null,[])},666:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}h.modelId="ModelId";h.configId="ConfigId";h.modelVersion=
"ModelVersion";h.iSk="PredictionAcceptedByTab";h.hSk="PredictionAcceptedByRightArrow";h.NDf="AugLoopResponseTime";h.gDh="SignalRenderedTime";h.eDh="SignalNotRenderedTime";h.lSf="DelayedResponseTime";h.Qxl="SignalGeneratedCount";h.YAf="AnnotationReceivedCount";h.jhh="PredictionRenderedCount";h.ihh="PredictionNotRenderedCount";h.V4d="EmptyPredictionResponseCount";h.qDh="SkippedPredictionResponseCount";h.kSf="DelayedResponseCount";h.myk="NonEnglishSkipCount";h.nuc="SignalGenerationTime";h.jUd="AnnotationReceivedTime";
h.ZAf="AnnotationRenderedTime";h.XAf="AnnotationNotRenderedTime";h.DTa=[h.hSk,h.iSk,h.NDf,h.gDh,h.eDh,h.lSf,h.Qxl,h.YAf,h.jhh,h.ihh,h.V4d,h.qDh,h.kSf,h.myk];h.X6b=[h.modelId,h.configId,h.modelVersion];Object(K.a)(h,"DataFieldsPerSession",null,[])},667:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}h.language="Language";h.tYd="CharIndex";h.iMc="CharIndexRendered";h.Ytg="KeptCharCount";h.modelId="ModelId";h.hhh="PredictionLength";h.khh="PredictionTokenCount";h.score="Score";h.status=
"Status";h.n8e="TypedThroughCharCount";h.EP="WordIndex";h.modelVersion="ModelVersion";h.LIh="TimeTakenAugloop";h.xwd="TimeToRender";h.configId="ConfigId";h.DTa=[h.tYd,h.iMc,h.Ytg,h.hhh,h.khh,h.score,h.status,h.n8e,h.EP,h.LIh,h.xwd];h.X6b=[h.language,h.modelId,h.configId,h.modelVersion];Object(K.a)(h,"DataFieldsPerCandidate",null,[])},668:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.syncDeltaTimeout=this.disableSyncDeltaSending=this.isDeltaGeneratorEnabled=this.powerpoint=
this.downloadPolymerBaseUrl=this.inferenceServiceVersion=this.downloadBaseUrl=this.sessionCreationOptions=this.disabledServiceGroups=this.privateMode=this.flights=this.excelServer=this.initSession=this.sessionId=this.releaseFork=this.releaseCustomAudience=this.releaseChannel=this.releaseAudienceGroup=this.uiLanguage=this.appVersion=this.appName=this.serviceUrl=null}}Object(K.a)(h,"InitializeParameters",null,[])},669:function(K,U,d){d.d(U,"a",function(){return e});K=d(0);U=d(324);var h=d(143);class e extends U.a{constructor(){super();
this.timestamp=this.targetObject=null;this.H_=Object.assign(new h.a,{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_Signal"}static getBaseTypes(){return[]}}Object(K.a)(e,"Signal",U.a,[])},670:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(e){this.LHa=!0;this.c6c=this.Xcd=this.Ued=this.pad=null;this.nma=e}copy(){return new h(this.nma.copy())}move(e,r){this.LHa=!0;this.nma.move(e,r)}setOffsets(e){this.LHa=!0;this.nma.setOffsets(e)}Zf(){return this.nma.Zf()}get ic(){this.Xxd();
return this.pad}get kc(){this.Xxd();return this.Ued}get fc(){this.Xxd();return this.Xcd}get Zb(){this.Xxd();return this.c6c}Xxd(){if(this.LHa){var e=this.nma.points;this.pad=this.Xcd=e[0].x;this.Ued=this.c6c=e[0].y;for(const r of e)this.pad=Math.min(this.pad,r.x),this.Ued=Math.min(this.Ued,r.y),this.Xcd=Math.max(this.Xcd,r.x),this.c6c=Math.max(this.c6c,r.y);this.LHa=!1}}}Object(K.a)(h,"Boundary",null,[])},671:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e){super();
this.GD=e}}Object(K.a)(h,"SessionEndedEventArgs",Sys.EventArgs,[])},672:function(K,U,d){d.d(U,"a",function(){return e});K=d(0);var h=d(56);class e{constructor(r){this.Hvg=this.errorType=0;this.originalText=this.token=null;this.zKa=this.Gaa=this.lcid=0;this.zQh=!1;this.xqf=r}Yne(){const r=this.token?this.token:null;return 0!==this.errorType&&e.AKj.contains(r,this.lcid)}static get AKj(){return e.KOa||(e.KOa=h.a.instance.resolve("Box4.Proofing.IIgnoreAllKeywords"))}}e.KOa=null;Object(K.a)(e,"ProofingErrorDetails",
null,[320])},673:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);var h;(function(e){e[e.Load=0]="Load";e[e.Edit=1]="Edit"})(h||(h={}));Object(K.b)("UserAction",h)},674:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);U=d(110);class h extends U.a{constructor(){super();this.Input=null;this.Lcid=0;this.UserActionType=this.PostContextText=this.PreContextText=null;this.ApplicationMode=0}pl(){return 4}static z8i(e,r){const m=new h;h.oPe(m,e,r);m.UserActionType=e.paragraphNode.uVb?"Edit":"Load";
return m}static oPe(e,r,m){e.Lcid=r.range.lcid;e.Input=r.voa.substring(r.range.begin,r.range.end);e.ApplicationMode=m;0<=r.range.Gaa&&(e.PreContextText=r.voa.substring(r.range.Gaa,r.range.begin));0<=r.range.zKa&&(e.PostContextText=r.voa.substring(r.range.end,r.range.zKa))}static jrj(e,r,m,n,z,v,x,B){const {SpellingRequestObjectUpdatedV2:D}=d(1145),{SpellingRequestObjectUpdated:w}=d(1146);return B?D.L8d(r,m):e?w.L8d(r,m,n,z,v,x):h.z8i(r,m)}}Object(K.a)(h,"SpellingRequestObject",U.a,[])},675:function(K,
U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(e,r=null,m=null,n=null,z=!1,v=null){this.DisplayName=this.ClientId=this.Provider=this.UserId=null;this.IsAnonymous=!1;this.Email=null;this.UserId=e;this.Provider=r;this.DisplayName=m;this.Email=n;this.IsAnonymous=z;this.ClientId=v}}Object(K.a)(h,"Person",null,[])},676:function(K,U,d){d.d(U,"a",function(){return e});K=d(0);var h=d(82);class e{static u7a(r,m,n="GenericCommentsTask"){n=new h.a(2,1,0,()=>{m()},92,n);r.Hb(n)}static kt(r){return Error.create("SDXHostAPI Error : "+
r,{["SDXHostAPIErrorCode"]:r})}}Object(K.a)(e,"OfficeSharedCommentsUtils",null,[])},677:function(K,U,d){d.d(U,"a",function(){return m});K=d(0);var h=d(392);U=d(741);var e=d(1065),r=d(939);class m extends U.a{constructor(n,z,v=null){super(n,z,v||e.a.instance,m.DNj)}static DNj(){r.a.sendTraceTag=m.$hl;r.a.debugAssertTag=m.cRi}static $hl(n,z,v,...x){h.ULS.sendTraceTag.apply(null,[n,204,m.WPi(z),v].concat(x))}static cRi(){}static WPi(n){switch(n){case 0:return 200;case 1:return 100;case 2:return 50;case 4:return 15;
case 3:return 10;default:return 100}}}m.zQe="wdPreviousSession";m.VQf="wdUserSession";Object(K.a)(m,"CommonCrossDocumentMessenger",U.a,[])},678:function(K,U,d){d.d(U,"a",function(){return r});K=d(0);var h=d(392),e=d(27);class r{static cee(m,n){let z=null;if(m&&0<m.length&&n&&0<n.length){const v=window[n];v?v&&m in v?z=v[m]:h.ULS.sendTraceTag(38605909,356,10,"Couldnt find survey json for survey "+m+" from dictionary "+n):h.ULS.sendTraceTag(38605910,356,10,"Couldnt find survey dictionary "+n)}return z}static Hne(){const m=
e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateLatestVersionIsEnabled",!1);m?h.ULS.sendTraceTag(50668111,356,50,"Using floodgate latest version "):h.ULS.sendTraceTag(595342404,356,50,"Using floodgate stable version");return m}}Object(K.a)(r,"CommonUtils",null,[])},679:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);d=d(299);class h{}h.LabelText=d.a.labelText;h.LabelTextUserGeneratedPlaceholderReplacements=d.a.q7j;h.Visible=d.a.visible;h.ImageIsVisible=
"ImageIsVisible";h.ImageUsesSpaceWhileInvisible="ImageUsesSpaceWhileInvisible";h.Image16by16Class=d.a.Qzb;h.Image32by32Class=d.a.wFa;h.Image48by48Class=d.a.dhe;h.ImageBackColor="ImageBackColor";h.On="On";h.SourceControlId="SourceControlId";Object(K.a)(h,"FlyoutAnchorCommandProperties",null,[])},680:function(K,U,d){d.d(U,"a",function(){return v});K=d(0);var h=d(265),e=d(27),r=d(368),m=d(226),n=d(99),z=d(65);class v{static X0a(x){let B,D;({dHl:B,eHl:D}=v.y4i());v.lfl(B,D,x)}static y4i(){({V9b:B}=r.a.DQb(!e.AFrameworkApplication.NT));
var x=$get(h.CuiHelper.sIj);if(B)var B=document.getElementById(h.CuiHelper.p6d);else B=x.childNodes[0],x=x.childNodes[1];return{dHl:B,eHl:x}}static lfl(x,B,D){if(x&&B&&0<B.clientHeight){const w=-1!==B.parentNode.parentNode.className.indexOf("cui-ribbon");v.fuh(x,B,D,w)}}static fuh(x,B,D,w){let J=null,G=null,M=null,N=null,R=null,C=null,O=null,S=null,T=null,ca=null,L=null,da=null,Z=null,fa=null,aa=null,ja=null,I=null,sa=null,ka=null,Ma=null;({pWf:J,oWf:G,qWf:M,I9a:N,J9a:R,LSa:C,xT:O,Cv:S,MSa:T,wQ:ca,
NSa:L,rWf:Ma}=v.$_f(x,J,G,M,N,R,C,O,S,T,ca,L,Ma));({g5b:da,eH:Z,nWf:fa,lWf:aa,K9a:ja,wwb:I,xwb:sa,mWf:ka}=v.y0f(B,da,Z,fa,aa,ja,I,sa,ka));x=[J,G,M,N,R,C,O,S,T,ca,L,fa,aa,ja,I,sa,ka,Ma];for(var Ea of x)v.zvl(Ea);Ea=[J,G,M,R,O,S,ca,L,aa,I,sa,ka];for(const ma of Ea)v.N8e(ma);v.prh(G);v.Mwh(Z,0);v.k_i(J,G,M,N,R,C,O,S,T,ca,L,da,Z,fa,aa,ja,I,sa,ka,Ma,w,D);v.nji(C,O)}static ofl(x,B){v.fuh(x,null,B,!1)}static nji(x,B){x&&B&&(x.style.marginTop=(B.offsetHeight-x.offsetHeight)/2+"px")}static $_f(x,B,D,w,J,G,
M,N,R,C,O,S,T){for(let ca=0;x&&ca<x.childNodes.length;ca++){const L=x.childNodes[ca],da=n.a.Hka(L),Z=!!L.id;-1!==da.indexOf("cui-QATRowLeft")?B=L:-1!==da.indexOf("cui-QATRowCenter")?D=L:-1!==da.indexOf("cui-QATRowRight")?w=L:-1!==da.indexOf("OfficeOnlineBrandBreadcrumbSeparator")?J=L:L.id===h.CuiHelper.yWd?G=L:L.id===h.CuiHelper.O1f?M=L:L.id===h.CuiHelper.zWd?N=L:L.id===h.CuiHelper.AWd?R=L:Z&&v.XVj(L)?C=L:-1!==da.indexOf("UsernameNameContainer")?O=L:-1!==da.indexOf("UsernameNameItem")?S=L:-1!==da.indexOf("FreemiumUpsellButton")&&
(T=L);({pWf:B,oWf:D,qWf:w,I9a:J,J9a:G,LSa:M,xT:N,Cv:R,MSa:C,wQ:O,NSa:S,rWf:T}=v.$_f(L,B,D,w,J,G,M,N,R,C,O,S,T))}return{pWf:B,oWf:D,qWf:w,I9a:J,J9a:G,LSa:M,xT:N,Cv:R,MSa:C,wQ:O,NSa:S,rWf:T}}static y0f(x,B,D,w,J,G,M,N,R){for(let C=0;x&&C<x.childNodes.length;C++){const O=x.childNodes[C],S=n.a.Hka(O),T=!!O.id;-1!==S.indexOf("cui-jewel-container")?B=O:-1!==S.indexOf("cui-tts")?D=O:-1!==S.indexOf("cui-TabRowInline")?J=O:-1!==S.indexOf("cui-TabRowRight")?R=O:-1!==S.indexOf("cui-separator")?w=O:T&&O.id.startsWith(h.CuiHelper.Jch)&&
!G?G=O:T&&O.id.startsWith(h.CuiHelper.r_f)?M=O:T&&O.id.startsWith(h.CuiHelper.EOe)&&(N=O);({g5b:B,eH:D,nWf:w,lWf:J,K9a:G,wwb:M,xwb:N,mWf:R}=v.y0f(O,B,D,w,J,G,M,N,R))}return{g5b:B,eH:D,nWf:w,lWf:J,K9a:G,wwb:M,xwb:N,mWf:R}}static kfl(x,B,D,w,J,G,M,N,R){v.XR(x,B,R)&&(v.TYc(B),v.XR(x,B,R)&&v.TYc(B));v.XR(B,w,R)&&(v.LL(D),v.LL(J),v.XR(B,w,R)&&(v.TYc(B),v.XR(B,w,R)&&(v.TYc(B),v.XR(B,w,R)&&v.LL(w))));v.XR(w,N,R)&&(v.LL(D),v.LL(J));x=[G,M,N];v.uhg(w,N,x,R);v.uhg(B,N,x,R)}static uhg(x,B,D,w){let J=0;for(;J<
D.length&&v.XR(x,B,w);)v.LL(D[J]),J++}static wqj(x){if(!x)return 0;if(void 0===x._scaleStep||null===x._scaleStep){let B=0;-1!==x.className.indexOf("cui-tts-scale1")?B=1:-1!==x.className.indexOf("cui-tts-scale2")&&(B=2);x._scaleStep=B}return parseInt(x._scaleStep)}static TYc(x){let B=v.wqj(x);2>B&&v.Mwh(x,++B)}static Mwh(x,B){x&&(x.className=v.Scl[B],x._scaleStep=B)}static XR(x,B,D){return x&&B?z.a.Rug(z.a.ki(x),z.a.ki(B),D):!1}static vJb(x,B,D){let w=0;x&&B&&(w=z.a.Dre(z.a.ki(x),z.a.ki(B),D));return w}static N_d(x){for(let B=
0;x&&B<x.childNodes.length;B++)if(-1!==x.childNodes[B].className.indexOf("cui-cg"))return!0;return!1}static V$d(x){let B=null;for(let D=x.childNodes.length-1;x&&0<=D;D--){const w=x.childNodes[D];if(-1===w.className.indexOf("cui-cg"))break;B=w}return B}static BQb(x,B,D){if(x&&!v.yn(x)){var w=m.a.rt(x);w=n.a.TM(w.paddingLeft)+n.a.TM(w.paddingRight);D=x.offsetWidth-D-w;let J=0;for(;B&&B!==x;)(w=m.a.rt(B))&&(J+=n.a.TM(w.paddingLeft)+n.a.TM(w.paddingRight)),B=B.parentNode;D=Math.max(D,75+J);x.style.width=
D+"px"}}static hal(x,B,D){if(x&&B){let w=0,J=0;({left:w,top:J}=z.a.D6f(B,w,J));v.Nwk(x,D?w-x.offsetWidth:w+B.offsetWidth)}}static k_i(x,B,D,w,J,G,M,N,R,C,O,S,T,ca,L,da,Z,fa,aa,ja,I,sa){I&&v.kfl(S,T,ca,L,da,Z,fa,aa,sa);v.N_d(T)?v.tfl(T,x,B,D,w,J,G,M,N,R,C,O,ja,sa):v.sfl(x,B,D,w,J,G,M,N,R,C,O,ja,sa)}static sfl(x,B,D,w,J,G,M,N,R,C,O,S,T){const ca=!!J,L=!!M,da=!!N;let Z=0;if((L||da)&&0<(Z=v.vJb(x,B,T))){let fa=L;da&&(!L||N.offsetWidth>M.offsetWidth)&&(fa=!1);v.BQb(fa?M:N,fa?M:N,fa?Z:2*Z);L&&da&&0<(Z=
v.vJb(x,B,T))&&v.BQb(fa?M:N,fa?M:N,fa?Z:2*Z)}if(L&&v.XR(M,B,T)||ca&&v.XR(J,B,T))v.LL(w),v.LL(J),v.LL(G),v.LL(M),da&&(v.N8e(B),v.N8e(N));v.lnh(B,D,N,R,C,O,S,T);da&&v.FIf(N,x,D,T)}static tfl(x,B,D,w,J,G,M,N,R,C,O,S,T,ca){const L=!!N,da=!!R,Z=!!C,fa=!!T,aa=v.V$d(x);0<(B=v.vJb(B,aa,ca))&&(L&&v.BQb(N,N,B),!L||v.XR(N,aa,ca))&&(v.LL(J),v.LL(G),v.LL(M),v.LL(N));v.XR(x,D,ca)&&v.hal(D,x,ca);v.lnh(D,w,R,C,O,S,T,ca);0<(B=v.vJb(x,w,ca))&&(v.BQb(O,S,B),fa&&v.XR(x,w,ca)&&v.LL(T),Z&&v.XR(x,w,ca)&&v.LL(C));da&&!v.yn(D)&&
v.FIf(R,x,w,ca)}static lnh(x,B,D,w,J,G,M,N){const R=!!D,C=!!w,O=!!J,S=!!M;let T=0;if((R||O)&&0<(T=v.vJb(x,B,N))){const ca=!!x&&"absolute"!==x.style.position;let L=R;O&&(!R||J.offsetWidth>D.offsetWidth)&&(L=!1);v.BQb(L?D:J,L?D:G,L&&ca?2*T:T);R&&O?(0<(T=v.vJb(x,J,N))&&(L=!L,v.BQb(L?D:J,L?D:G,L&&ca?2*T:T)),v.XR(x,J,N)&&v.LL(x)):R&&v.XR(x,B,N)&&v.LL(x)}S&&v.XR(x,B,N)&&v.LL(M);C&&v.XR(x,B,N)&&v.LL(w)}static yn(x){if(!x)return!0;x=x._isHidden;return!(void 0===x||null===x||"0"===x)}static LL(x){x&&!v.yn(x)&&
(x.style.display="none",x._isHidden="1")}static zvl(x){x&&v.yn(x)&&(x.style.display="",x._isHidden="0")}static N8e(x){x&&(x.style.width="auto",x.style.maxWidth="none")}static Nwk(x,B){x&&(x.style.position="absolute",x.style.left=B+"px")}static prh(x){x&&(x.style.position="static",x.style.left="auto")}static FIf(x,B,D,w){if(x&&x.parentNode&&x.parentNode.parentNode){var J=v.jOk(x);"auto"!==x.parentNode.style.width&&(x.style.width=x.parentNode.offsetWidth-J+"px");var G=w?D:B;B=w?B:D;D=z.a.ki(x.parentNode.parentNode);
G=G?z.a.ki(G):new Sys.UI.Bounds(D.x,0,0,0);B=B?z.a.T$a(B):new Sys.UI.Point(D.x+D.width,0);"absolute"===x.parentNode.style.position?J=B.x-(G.x+G.width)-J-1:(D=z.a.ki(x.nextSibling?x.parentNode:x),D=D.x+D.width/2,J=2*Math.min(D-(G.x+G.width),B.x-D)-J-1);x.style.maxWidth=J+"px"}}static jOk(x){var B=m.a.rt(x);B=B?n.a.TM(B.paddingLeft)+n.a.TM(B.paddingRight):0;var D=m.a.rt(x.parentNode);D=D?n.a.TM(D.paddingLeft)+n.a.TM(D.paddingRight):0;let w=0;for(;x.nextSibling;)x=x.nextSibling,w+=x.offsetWidth;return B+
D+w}static XVj(x){return!!x.id&&(x.id.startsWith(h.CuiHelper.C0e)||x.id.startsWith(h.CuiHelper.zpd))}}v.Scl=["cui-tts","cui-tts-scale-1","cui-tts-scale-2"];Object(K.a)(v,"RibbonTabScalingActor",null,[])},681:function(K,U,d){d.d(U,"a",function(){return x});K=d(0);var h=d(392),e=d(7),r=d(27),m=d(142),n=d(56),z=d(184),v=d(112);class x{constructor(){this.a3=null}zxd(){try{this.a3||(this.a3=n.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager"))}catch(B){h.ULS.sendTraceTag(51689674,1300,10,
"Unable to resolve ISearchOAuthManager: "+B)}}Ude(B,D){return this.a3?this.a3.getToken(B,D):new Promise(w=>{n.a.instance.Ia("Common.App.SearchCommon.ISearchOAuthManager").execute(J=>{J?(this.a3=J,this.a3.getToken(B,D).then(G=>w(G))):w(null)})})}Kkj(){this.zxd();return this.a3?this.a3.getToken("Search",r.AFrameworkApplication.Ose):null}Rbg(){if("Dev Box"===r.AFrameworkApplication.fa.Ha("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(B=>
{window.setTimeout(()=>{B(window.TellMeSubstrateTokenOverride)},750)});this.zxd();return this.a3?this.a3.getToken("Search",r.AFrameworkApplication.q4e):null}Euj(){this.zxd();return this.a3?this.a3.getToken("Search",this.Buj()):null}Buj(){return r.AFrameworkApplication.fa.Ha("TellMeServiceAuthEndpointForSearch")}hsj(){if("Dev Box"===r.AFrameworkApplication.fa.Ha("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(B=>
{window.setTimeout(()=>{B(window.TellMeSubstrateTokenOverride)},750)});this.zxd();return this.a3?this.a3.getToken("SmartLookup",this.gsj()):null}gsj(){return r.AFrameworkApplication.fa.Ha("SmartLookupShredderServiceEndpoint")}Lkj(){return Object(e.a)(this,this.Kkj,"getLokiTokenPromise")}Ltj(){return Object(e.a)(this,this.Rbg,"getSubstrateTokenPromise")}wOb(){return!!r.AFrameworkApplication.Aa&&r.AFrameworkApplication.Aa.ob.wOb}uvj(){const B={};this.wOb()&&(B.Loki=this.Lkj(),B.Substrate=this.Ltj());
return B}Cdc(B){m.a.ALa(Object.assign(new z.a,{name:"Events",dataFields:[Object.assign(new v.a,{name:"Event",string:"StringsLoaded"}),Object.assign(new v.a,{name:"Status",bool:B})],durationMs:Math.round(window.performance.now())}),"TellMeWAC.")}r$j(){return r.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("tellme-strings").catch(()=>{this.Cdc(!1);return!1}).then(()=>{this.Cdc(!0);return!0}):new Promise((B,D)=>{const w=n.a.instance.resolve("Common.IDynamicScriptLoaderProvider").rI;
w?w.loadScript("tellme-strings").then(()=>{this.Cdc(!0);B(!0)}).catch(()=>{this.Cdc(!1);D(!1)}):(this.Cdc(!1),D(!1))})}static B2j(){return!!r.AFrameworkApplication.Aa&&(r.AFrameworkApplication.Aa.ob.xcc||r.AFrameworkApplication.Aa.ob.LBb)}static L2c(){return!!r.AFrameworkApplication.Aa&&r.AFrameworkApplication.Aa.ob.LBb}}Object(K.a)(x,"ReactSharedHeaderSearchUtils",null,[])},682:function(K,U,d){d.d(U,"a",function(){return x});K=d(0);var h=d(392),e=d(47),r=d(953),m=d(29),n=d(44),z=d(75),v=d(34);class x{constructor(B=
2E3){this.jPa=B}iVj(){const B=x.RW();return this.G5j(B)}G5j(B){return 0<this.YWc(B).mentionLength}getSelectedText(){const B=x.RW();return this.YWc(B)}YWc(B){return this.Wqj(B)}Wqj(B){var D=null;B&&B.gda&&n.SelectionEditor.Xg(B.Va)&&n.SelectionEditor.IBb(B.Va)&&(h.ULS.sendTraceTag(17944729,1303,50,"Selection was an insertion point, expanding to word"),D=n.SelectionEditor.ZSa(B.Va,!1));D&&(B=D);if(!B)return Object.assign(new r.a,{neighborhood:"",mentionStart:0,mentionLength:0});const w=new Sys.StringBuilder;
let J=D=0;const G=[],M=B.length;for(let R=0;R<M;R++){const C=B.ga(R);if(!v.ParagraphReader.ae(C.node)||Array.contains(G,C.node.aNa))continue;G.push(C.node.aNa);let O=v.ParagraphReader.text(C.node),S=0;var N=v.ParagraphReader.eua(C.node,!0,!0,!0);let T=v.ParagraphReader.eua(C.node,!1,!0,!0),ca=0;for(;O.length<this.jPa&&(N||T);){if(!(ca%2)&&N){const L=v.ParagraphReader.text(N);O=L+" "+O;S+=L.length+1;N=v.ParagraphReader.eua(N,!0,!0,!0)}1===ca%2&&T&&(O=O+" "+v.ParagraphReader.text(T),T=v.ParagraphReader.eua(T,
!1,!0,!0));ca++}N=R===M-1;R||-1===C.Sa||(D=C.Sa);J+=N&&-1!==C.Mb?C.Mb:O.length;w.append(O);D+=S;J+=S;N||(w.append(" "),J++)}for(B=z.AParagraphNode.Sod(w.toString()," ");D<J&&e.a.uz(B.charCodeAt(D));)D++;for(;J>D&&e.a.uz(B.charCodeAt(J-1));)J--;return this.Lji(B,D,J)}Lji(B,D,w){if(B.length>this.jPa){var J=w-D;if(J>this.jPa)B=B.substr(D,this.jPa),w=this.jPa,D=0;else{J=Math.max(D-Math.floor((this.jPa-J)/2),0);let G;G=Math.min(J+this.jPa,B.length);J=Math.max(G-this.jPa,0);D-=J;w-=J;B=B.substring(J,G)}}return Object.assign(new r.a,
{neighborhood:B,mentionStart:D,mentionLength:w-D})}static RW(){var B=m.App.Lb.Kd.Mn;if(!B)return h.ULS.sendTraceTag(38548897,1303,50,"ContentView is null"),null;B=B.Nb;return B&&B.Pa&&B.Pa.length?B.Pa.mb:(h.ULS.sendTraceTag(38548898,1303,50,"SelectionManager or selectionCollection is null"),null)}}Object(K.a)(x,"Box4InsightsSelection",null,[289,290])},683:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.style=this.formatting=null;this.languageId=0}}Object(K.a)(h,"NewOutlineElementInfo",
null,[])},684:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}h.thd="Listening";h.CIb="Warning";h.d_a="Error";Object(K.a)(h,"VoiceNotificationResourceStrings",null,[])},685:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}h.CoachButton="coachButton";h.MicButton="micButton";h.PrevButton="prevButton";h.NextButton="nextButton";h.GridButton="gridButton";h.InkButton="inkButton";h.SubtitlesButton="subButton";h.LiveButton="liveButton";h.MoreButton="moreButton";h.ExitButton=
"exitButton";h.CameraButton="cameraButton";Object(K.a)(h,"SlideshowToolbarButtonIDs",null,[])},686:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);var h;(function(e){e[e.unknown=0]="unknown";e[e.supported=1]="supported";e[e.userUnsupportedAnonymous=2]="userUnsupportedAnonymous";e[e.userUnsupportedNoLoginHint=3]="userUnsupportedNoLoginHint";e[e.hostUnsupported=4]="hostUnsupported";e[e.perfAutomation=5]="perfAutomation"})(h||(h={}));Object(K.b)("SupportStatus",h)},687:function(K,U,d){d.d(U,"a",
function(){return h});K=d(0);d=d(447);class h extends d.a{constructor(e){super();this.shapeNode=e}get $pg(){return!this.shapeNode||!this.shapeNode.isConnected}get id(){return this.shapeNode.id}get isConnected(){return this.shapeNode.isConnected}}Object(K.a)(h,"InternalClipboardShape",d.a,[])},688:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);d=d(972);class h extends d.a{constructor(e,r,m){super(e,r);this.yDh=m}}Object(K.a)(h,"ClipServiceSlideCopyParams",d.a,[])},689:function(K,U,d){d.d(U,
"a",function(){return e});K=d(0);var h=d(43);class e{constructor(r,m){this.Tgb=!1;this.WDd=this.Ftf=-1;this.px=r;m&&this.start()}start(){this.Tgb=!0;this.WDd=-1;const r=h.a.jZ();r&&(this.Ftf=r)}stop(){this.Tgb=!1;const r=h.a.jZ();r&&0<this.jba&&r>=this.jba&&(this.WDd=r-this.jba)}get operation(){return this.px}get KQc(){return this.WDd}get jba(){return this.Ftf}}Object(K.a)(e,"PPTStopwatch",null,[])},690:function(K,U,d){d.d(U,"a",function(){return e});K=d(0);var h=d(231);class e{}var r=e;e.gth={aliceblue:"#f0f8ff",
antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",
darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",
honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",
limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",
orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",
snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};e.MRa=m=>{m=m.toLowerCase().trim().replace(/\s/g,"");return e.gth[m]?e.gth[m]:""};e.kIf=m=>m?""!==r.MRa(m):!1;e.Pcj=m=>{var n=/^#([0-9a-f])*$/i;if(!m||!m.match(n))throw Error("invalid hex color string provided");n=new h.Color;switch(m.length){case 7:n.a=
1;n.r=parseInt(m.substring(1,3),16);n.g=parseInt(m.substring(3,5),16);n.b=parseInt(m.substring(5,7),16);break;case 9:n.r=parseInt(m.substring(1,3),16);n.g=parseInt(m.substring(3,5),16);n.b=parseInt(m.substring(5,7),16);n.a=parseInt(m.substring(7,9),16);break;default:throw Error("unsupported color string provided");}return n};Object(K.a)(e,"ColorTranslator",null,[])},691:function(K,U,d){d.d(U,"a",function(){return z});K=d(0);var h=d(1252),e=d(41),r=d(39),m=d(62),n=d(43);class z{static LOc(v,x,B,D,
w,J,G,M,N,R,C,O,S,T,ca){J=O.ADa(!1,v.cid,v.sid,0,x.shapeType,J,G,M,N,R+1);J.setValue(r.a.hL,x.Uga);({xzh:D,pzh:T}=w.Sag(D,x,B,ca,S,T));S=S.Md;J.setValue(e.a.Ix,S.gf(ca.YH(D,B),0));J.setValue(e.a.jD,S.gf(ca.YH(T,B),1));J.setValue(r.a.IRb,J.Ix);J.setValue(r.a.Czb,J.jD);J.setValue(r.a.mpd,!0);J.yda=h.a.sKa(D,0);J.xda=h.a.sKa(T,1);J.setValue(r.a.FSa,0);J.setValue(r.a.GSa,0);J.setValue(r.a.WVa,!0);J.setValue(r.a.isResizable,!0);J.setValue(r.a.YL,!0);J.kO=!0;J.QVa=!0;ca=(S=95===x.Uga||97===x.Uga)||Array.contains(z.Hre,
x.Uga);J.YL=!S;J.isResizable=!0;J.setValue(r.a.rz,S);J.setValue(r.a.e0,95===x.Uga);J.yG=m.a.Uy(v.sid,v.cid);J.cmb=J.get_shapeId();J.setValue(r.a.Mua,!0);v=w.yOf(D,T,B);J.ZR=v;(C.ZL(J)||C.Fla(J))&&n.a.Kb&&(n.a.Kb.Oj=!0);ca?w.cxh(J):w.nxh(J);return J}}z.Hre=[88,93,94,89,90,91,92];Object(K.a)(z,"InsertContentShapeNodeFactory",null,[])},692:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(e,r,m,n){this.Uga=e;this.shapeType=r;this.height=m;this.width=n}}Object(K.a)(h,"AutoShapeProps",
null,[])},693:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(){super()}}Object(K.a)(h,"SlidesChangedArgs",Sys.EventArgs,[])},694:function(K,U,d){d.d(U,"a",function(){return e});d.d(U,"b",function(){return r});var h=d(47);const e=m=>{m=btoa(m);m=m.replace(RegExp("\\+","g"),"-");m=m.replace(RegExp("\\/","g"),"_");return m=m.replace(RegExp("\\=+$","g"),"")},r=m=>{if(h.a.Xa(m))return null;const n=RegExp("%([0-9A-F]{2})","g");m=encodeURIComponent(m);let z=
"",v=0,x;for(;x=n.exec(m);){const B=n.lastIndex-3;B>v&&(z+=m.substring(v,B));z+=h.a.fromCharCode(parseInt(String("0x"+x[1])));v=n.lastIndex}v<m.length&&(z+=m.substring(v,m.length));return btoa(z)}},695:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}h.Nwb="extId";h.fvb="ComponentType";h.oT="ComponentId";h.qJj="HostProps";h.zib="OptionalProps";Object(K.a)(h,"ActionPropertyNames",null,[])},696:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);var h;(function(e){e[e.OK=0]="OK";e[e.notReady=
1]="notReady";e[e.storeDisabled=2]="storeDisabled";e[e.invokeFailure=3]="invokeFailure"})(h||(h={}));Object(K.b)("AddinDetailsQueryError",h)},697:function(K,U,d){d.d(U,"a",function(){return v});K=d(0);var h=d(27),e=d(173),r=d(93),m=d(7);U=d(18);var n=d(28),z=d(68);class v{constructor(x,B,D,w,J,G,M,N,R,C,O,S,T,ca){this.P5=this.Wl=this.Px=null;this.THf=!0;this.UXa=x;this.Dsk=B;this.Phk=D;this.Tfc=w;this.v5=G;this.$b=M;this.Ud=N;this.Ve=R;this.rsk=C;this.Cfb=O;this.tlk=S;this.slk=T;this.rlk=ca;this.zJ=
J}openDialog(){this.jLi();h.AFrameworkApplication.Aa.hjb();try{this.Wl.click()}catch(x){const B=String.format("UploadFrame::DoFileOpenDialog failed. Message: {0}. Stack: {1}",x.message,x.stack);n.a.J(509727820,818,10,B);throw x;}}submit(){const x=this.Wl.files[0];this.P5=this.Phk();this.P5.YKe&&this.P5.YKe(this.v5,this.$b,this.Ud,this.Ve);if(this.rsk)this.tRl(x);else{const B=new FormData;for(let w of this.P5.NTd)B.append(w.key,w.value);B.append("fileInputId",x,x.name);const D=new XMLHttpRequest;D.onreadystatechange=
()=>{this.mJb(D)};D.open("POST",this.P5.qgh);D.send(B)}}mJb(x){if(4===x.readyState){const B=x.status;if(!B||B>=e.a.mx&&B<e.a.Roi){if(this.P5.onSuccess)this.P5.onSuccess(x.responseText,this.v5,this.$b,this.Ud,this.Ve,this.Wl)}else this.P5.Kz&&this.P5.Kz(x.responseText,this.v5,this.$b,this.Ud,this.Ve);this.dispose()}}tRl(x){this.Cfb().Y1(this.Tfc,this.zJ,x.size,x,this.P5.NTd.ga("MediaToken"),this.Ve,this.tlk,this.slk,this.rlk,B=>{if(this.P5.onSuccess)this.P5.onSuccess(B.result,this.v5,this.$b,this.Ud,
this.Ve,this.Wl)},B=>{this.P5.Kz&&this.P5.Kz(B.error.Code.toString(),this.v5,this.$b,this.Ud,this.Ve)})}dispose(){this.Px&&(r.a.removeHandler(this.Wl,"change",Object(m.a)(this,this.uSc,"fileInputChange")),document.body.removeChild(this.Px),this.Wl=this.Px=null,v.Q9e.remove(this))}jLi(){this.Px||(this.Px=document.createElement("form"),this.Px.id="uploadFormId",this.Px.style.visibility=z.a.hidden,this.Px.method="post",this.Px.encoding="multipart/form-data",this.Px.action="",this.Wl=document.createElement("input"),
this.Wl.style.visibility=z.a.hidden,this.Wl.type="file",this.Wl.id="uploadFileInputId",this.Wl.name="uploadFileInputId",this.Wl.accept=this.UXa,this.Px.appendChild(this.Wl),document.body.appendChild(this.Px),r.a.addHandler(this.Wl,"change",Object(m.a)(this,this.uSc,"fileInputChange")))}uSc(){this.Wl.value&&this.Wl.value.length?(this.THf=!1,this.Dsk(this.Wl,this.Ud,this.Ve,this.Tfc).then(()=>{this.submit()}).catch(()=>{this.dispose()})):this.dispose()}static B2e(x,B,D,w,J,G,M,N,R,C,O,S,T,ca){for(let L of v.Q9e)L.THf&&
L.dispose();x=new v(x,B,D,w,J,G,M,N,R,C,O,S,T,ca);v.Q9e.add(x);x.openDialog()}}v.Q9e=new U.a;Object(K.a)(v,"UploadFileDialog",null,[])},698:function(K,U,d){d.d(U,"a",function(){return n});K=d(0);var h=d(67),e=d(7),r=d(385),m=d(124);class n{constructor(z,v,x,B,D,w,J,G,M,N,R,C){this.bXd=1;this.c5=v;this.Sk=z;this.rfk=x;this.$e=M;this.Sr=N;this.Rc=R;this.Jgb=G;this.ebd=D;this.fbd=B;this.q5=w;this.$e.addCssClass(this.Sk,"prControl");this.Sk.style.width=this.$e.Pc(v);this.Pv=J.oOi();this.u8c=J.nOi();this.Pv.qRa(z);
this.u8c.qRa(z,v,v);this.Ajc=C;this.aLa()}dispose(){this.t8e();this.clear();this.Pv.dispose();this.u8c.dispose();this.$e.removeCssClass(this.Sk,"prControl")}get F_a(){return m.a.none}clear(){this.ERa();this.TYd();this.$We()}setZIndex(z){this.Sk.style.zIndex=String(z)}uIe(){this.Ajc.va.style.zIndex=String(this.bXd+r.a.wha)}$We(){this.Ajc.va.style.zIndex="0"}Jwh(z,v,x=null){z=this.Jgb.aPf(this.c5,this.c5,this.rfk,z,"",x);this.Pv.LLa(z,v)}n_b(z,v){this.u8c.add(z,v)}TYd(){this.u8c.clear()}ERa(){this.Pv.clear()}onClick(){return!0}aLa(){this.fbd&&
this.Sr.rb(h.a.pointerOver,this.Sk,this.fbd);this.ebd&&this.Sr.rb(h.a.pointerOut,this.Sk,this.ebd);this.q5?this.Rc.rb(h.a.click,this.Sk,this.q5):this.Rc.rb(h.a.click,this.Sk,Object(e.a)(this,this.onClick,"onClick"));this.Rc.rb(h.a.doubleClick,this.Sk,Object(e.a)(this,this.onClick,"onClick"))}t8e(){this.fbd&&this.Sr.Bb(h.a.pointerOver,this.Sk,this.fbd);this.ebd&&this.Sr.Bb(h.a.pointerOut,this.Sk,this.ebd);this.q5?this.Rc.Bb(h.a.click,this.Sk,this.q5):this.Rc.Bb(h.a.click,this.Sk,Object(e.a)(this,this.onClick,
"onClick"));this.Rc.Bb(h.a.doubleClick,this.Sk,Object(e.a)(this,this.onClick,"onClick"))}}Object(K.a)(n,"ShapePawn",null,[192])},716:function(K,U,d){d.r(U);K=d(0);var h=d(392),e=d(197),r=d(947),m=d(1130),n=d(27),z=d(1129),v=d(7),x=d(1243),B=d(1244),D=d(29),w=d(472);class J extends w.a{constructor(Ea,ma,va,Ca,oa,Da){super();this.init(Ea);this.$l("DummyClipboardOperation");this.zFa(n.AFrameworkApplication.Ra,ma,Ca,oa,Da);this.Ot=va;this.gp=8;this.RY()}run(){this.POa=!0;this.elb(this.Ot);this.Eoa();
this.gp=32}}Object(K.a)(J,"DummyClipboardOperation",w.a,[]);var G=d(99),M=d(129),N=d(118),R=d(60);class C{constructor(Ea,ma,va){h.ULS.shipAssertTag(6305502,307,!!Ea);this.properties=Ea;this.qd=ma;this.xra=va}get Xc(){return this.qd}j$f(){return this.properties.sa(R.a.VU,"")}ohh(){return!0}AKh(){let Ea,ma=!1;Ea=null;const va=this.j$f();if(this.xra||""!==va)try{({B9a:Ea,returnValue:ma}=this.W7e(va))}catch(Ca){h.ULS.shipAssertTag(4203138,307,!1),this.Xc.Xb(M.a.ska,{["Reason"]:N.a.$Ef}),G.a.$Ca(Ea)}else h.ULS.sendTraceTag(3994443,
307,50,"PastedHTMLString empty"),this.Xc.Xb(M.a.h2,{["Reason"]:N.a.h6d});return{returnValue:ma,FNc:Ea}}}Object(K.a)(C,"AStringInputImportStrategy",null,[1333]);class O extends C{constructor(Ea,ma,va,Ca,oa){super(Ea,ma,oa);this.lk=va;this.tOd=Ca}W7e(Ea){const {ClipboardActor:ma}=d(716);let va;if(this.xra&&!Ea)return h.ULS.sendTraceTag(541172643,307,10,"No htmlDomContent and htmlClipboardDataContent"),{returnValue:!1,B9a:null};va=null;if(this.xra)return va=this.lk.hKa(Ea),{returnValue:!0,B9a:va};if(this.tOd){const Ca=
this.properties.sa(R.a.wOe,"");Ca&&(va=this.lk.hKa(Ca))}va||(h.ULS.sendTraceTag(520931392,307,15,"HtmlStringImportStrategy:: use of innerHtml because domContainer is null"),va=ma.Neh,va.innerHTML=Ea);return{returnValue:!0,B9a:va}}}Object(K.a)(O,"HtmlStringImportStrategy",C,[]);var S=d(47);class T extends C{constructor(Ea,ma,va){super(Ea,ma,va)}W7e(Ea){let ma;if(this.xra&&!Ea)return h.ULS.sendTraceTag(541172642,307,10,"No htmlDomContent"),{returnValue:!1,B9a:null};ma=document.createElement("div");
Ea=Ea.split(RegExp("\r\n|\r|\n"));for(var va=0;va<Ea.length-1;va++){const Ca=document.createElement("p");Ca.innerText=this.Kre(Ea[va]);ma.appendChild(Ca)}va=document.createElement("span");va.innerText=S.a.c5d(Ea[Ea.length-1]);ma.appendChild(va);return{returnValue:!0,B9a:ma}}Kre(Ea){return S.a.c5d(Ea.length?Ea:" ")}}Object(K.a)(T,"MultiLineTextImportStrategy",C,[]);class ca extends T{constructor(Ea,ma,va){super(Ea,ma,va)}j$f(){return this.properties.sa(R.a.Mib,"")}Kre(Ea){Ea=super.Kre(Ea);return Ea.length&&
" "!==Ea?Ea:"\u00a0"}}Object(K.a)(ca,"MultiLinePlainTextImportStrategy",T,[]);class L extends C{constructor(Ea,ma,va){super(Ea,ma,va)}W7e(Ea){var {ClipboardActor:ma}=d(716);if(this.xra&&!Ea)return h.ULS.sendTraceTag(541172641,307,10,"No htmlDomContent"),{returnValue:!1,B9a:null};ma=ma.Neh;ma.innerText=Ea;return{returnValue:!0,B9a:ma}}}Object(K.a)(L,"PlainTextImportStrategy",C,[]);var da=d(393);class Z{constructor(Ea){this.hg=this.fpe=!1;this.bW=Ea}ohh(){this.fpe||(this.fpe=!0,this.hg=!1,this.bW.prepareForPaste(()=>
{this.hg=!0}));return this.hg}AKh(){let Ea;this.fpe=!1;Ea=this.bW.paste();return Ea?Ea.hasChildNodes()?{returnValue:!0,FNc:Ea}:(h.ULS.sendTraceTag(7891019,307,50,"DOM innerText empty."),Z.Xc.Xb(M.a.h2,{["Reason"]:N.a.h6d}),{returnValue:!1,FNc:Ea}):(h.ULS.sendTraceTag(6305676,307,50,"SystemClipboard didn't paste"),Z.Xc.Xb(M.a.e$a,{["Reason"]:N.a.X4e}),{returnValue:!1,FNc:Ea})}static get Xc(){return da.a.instance}}Object(K.a)(Z,"SystemClipboardImportStrategy",null,[1333]);var fa=d(64),aa=d(38),ja=d(51),
I=d(40),sa=d(35),ka=d(259);d.d(U,"ClipboardActor",function(){return Ma});class Ma{constructor(Ea,ma,va,Ca,oa,Da,ta,ha){this.gcf=null;this.$Vb=0;this.GVh=Ea;this.bW=ma;this.qd=va;this.lk=Ca;this.Uc=oa;this.Ca=Da;this.gt=ta;this.Pkf=!!ha&&ha.ka("SupportImageDragDropExternalIsEnabled");this.FOd=!!ha&&ha.ka("ShowKeepSourceFormattingOnPasteFloatieIsEnabled");this.QK=new ka.a;this.BCc=!!ha&&ha.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled");this.QK.$(sa.a.paste,257);this.QK.$(sa.a.j6,8449);this.QK.$(sa.a.t8,
1);this.QK.$(sa.a.Zkg,513);this.QK.$(sa.a.reformatPastedContent,4097);this.BCc&&this.QK.$(sa.a.JLb,20481);this.QK.$(sa.a.r0a,12289);this.QK.$(sa.a.Ykd,7);this.QK.$(sa.a.Xkd,1);this.QK.$(sa.a.Heh,8193);this.QK.$(sa.a.copy,272);this.QK.$(sa.a.TKc,16);this.QK.$(sa.a.cut,304);this.QK.$(sa.a.L0b,48);this.QK.$(sa.a.Kgd,64);this.QK.$(sa.a.Lgd,64);this.QK.$(sa.a.showPlaceholderGlossary,65536);this.Pkf&&this.QK.$(sa.a.jVf,1)}get UKf(){return this.GVh.value}get YA(){return this.bW}vb(){this.Ca.ra(sa.a.iWk,
I.a.application,Object(v.a)(this,this.Wmd,"queryPasteOptions"),97);this.Ca.ra(sa.a.jWk,I.a.application,Object(v.a)(this,this.Wmd,"queryPasteOptions"),97);this.FOd?this.Ca.ra(sa.a.wjh,I.a.application,Object(v.a)(this,this.qSe,"queryReformatPasteOptions"),97):this.Ca.ra(sa.a.xjh,I.a.application,Object(v.a)(this,this.qSe,"queryReformatPasteOptions"),97);this.Ca.ra(sa.a.yjh,I.a.application,Object(v.a)(this,this.qSe,"queryReformatPasteOptions"),97);this.Ca.YS(sa.a.L0b,I.a.view,Object(v.a)(this,this.lT,
"clipboardAction"),1028);this.Ca.YS(sa.a.cut,I.a.view,Object(v.a)(this,this.lT,"clipboardAction"),1028);this.Ca.rCa(sa.a.TKc,I.a.view,Object(v.a)(this,this.lT,"clipboardAction"));this.Ca.rCa(sa.a.copy,I.a.view,Object(v.a)(this,this.lT,"clipboardAction"));this.Pkf&&this.Ca.YS(sa.a.jVf,I.a.view,Object(v.a)(this,this.YWi,"dropBrowserContent"),1028);this.Ca.YS(sa.a.t8,I.a.view,Object(v.a)(this,this.lT,"clipboardAction"),1028);this.Ca.YS(sa.a.paste,I.a.view,Object(v.a)(this,this.lT,"clipboardAction"),
1028);this.Ca.YS(sa.a.j6,I.a.view,Object(v.a)(this,this.lT,"clipboardAction"),1028);this.Ca.YS(sa.a.Heh,I.a.view,Object(v.a)(this,this.lT,"clipboardAction"),1028);this.Ca.YS(sa.a.Xkd,I.a.view,Object(v.a)(this,this.lT,"clipboardAction"),1028);this.Ca.YS(sa.a.Ykd,I.a.view,Object(v.a)(this,this.lT,"clipboardAction"),1028);this.BCc&&this.Ca.YS(sa.a.JLb,I.a.view,Object(v.a)(this,this.lT,"clipboardAction"),4);this.Ca.YS(sa.a.reformatPastedContent,I.a.view,Object(v.a)(this,this.lT,"clipboardAction"),1028);
this.Ca.YS(sa.a.r0a,I.a.view,Object(v.a)(this,this.lT,"clipboardAction"),1028);this.Ca.ya(sa.a.Gpd,I.a.view,e.ActionManager.Sg);this.Ca.ya(sa.a.NNk,I.a.view,e.ActionManager.Sg);this.Ca.ya(sa.a.Zeh,I.a.view,e.ActionManager.Sg);this.Ca.ya(sa.a.$eh,I.a.view,e.ActionManager.Sg);this.Ca.ya(sa.a.afh,I.a.view,e.ActionManager.Sg);this.Ca.ya(sa.a.Yeh,I.a.view,e.ActionManager.Sg);this.Ca.rCa(sa.a.Kgd,I.a.view,Object(v.a)(this,this.lT,"clipboardAction"));this.Ca.rCa(sa.a.Lgd,I.a.view,Object(v.a)(this,this.Lgd,
"moveSelectedContentWithinCurrentParagraph"));this.Ca.rCa(sa.a.Zkg,I.a.view,Object(v.a)(this,this.lT,"clipboardAction"));this.Ca.rCa(sa.a.showPlaceholderGlossary,I.a.view,Object(v.a)(this,this.lT,"clipboardAction"));this.Ca.ya(sa.a.GQf,I.a.view,e.ActionManager.Sg);this.Ca.ya(sa.a.hRf,I.a.view,e.ActionManager.Sg)}Wmd(Ea,ma,va,Ca,oa){if(1===va)return 32;oa[r.a.On]=!1;return 32}YWi(Ea,ma,va,Ca,oa,Da){h.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");var ta=Da.DataTransfer;Da=ta.getData("text/html");
ta=ta.getData("text/plain");let ha=!1;const Ha=new m.DictionaryPropertySet;0<Da.length?(h.ULS.sendTraceTag(42530336,307,50,"Drag and drop browser content with HTML"),Ha.setValue(R.a.VU,Da),ha=!0):0<ta.length&&(h.ULS.sendTraceTag(42530337,307,50,"Drag and drop browser content with plain text"),Ha.setValue(R.a.Mib,ta),ha=!0);if(ha){const bb=this.QK.ga(ma);return this.UKf.create(Ea,ma,bb,new x.a(()=>this.dTf(bb,Ha)),va,Ca,oa,Ha)}return null}qSe(Ea,ma,va,Ca,oa){if(ma=Object(B.a)(Object,oa))n.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordShowKeepSourceFormattingOnPasteFloatieSettings"),
!this.FOd&&Ea===sa.a.xjh||this.FOd&&Ea===sa.a.wjh?(Ea=this.$Vb!==sa.a.reformatPastedContent&&this.$Vb!==sa.a.r0a,ma[r.a.On]=this.$Vb===sa.a.reformatPastedContent||Ea):Ea===sa.a.yjh&&(ma[r.a.On]=this.$Vb===sa.a.r0a);return 32}lT(Ea,ma,va,Ca,oa,Da){if((n.AFrameworkApplication.fK||n.AFrameworkApplication.cC)&&!n.AFrameworkApplication.QSa||aa.a.instance.ga(83))return new J(Ea,ma,va,Ca,oa,Da);const ta=this.QK.ga(ma);1!==Ca&&ta&1&&(this.$Vb=ma);1!==Ca&&Da&&ta&1&&(this.gcf=Da);1!==Ca&&!Da&&ta&4096&&(Da=
this.gcf);return this.UKf.create(Ea,ma,ta,new x.a(()=>this.dTf(ta,Da)),va,Ca,oa,Da)}Lgd(Ea,ma,va,Ca,oa,Da){Da=ja.a.Lj(fa.a.instance.Pa.mb.Va.node,Da);return this.lT(Ea,ma,va,Ca,oa,Da)}dTf(Ea,ma){return Ea&256?new Z(this.YA):Ea&2?Ea&4096?new O(ma,this.qd,this.lk,D.App.instance.bbc,D.App.instance.tOb):new L(ma,this.qd,D.App.instance.tOb):ma.Ua(R.a.Mib)?new ca(ma,this.qd,D.App.instance.tOb):new O(ma,this.qd,this.lk,D.App.instance.bbc,D.App.instance.tOb)}static get Neh(){return z.a.vab("Box4PasteScratchPad")}}
Object(K.a)(Ma,"ClipboardActor",null,[])},724:function(K,U,d){K=d(0);var h=d(18),e=d(7),r=d(403),m=d(404);class n{constructor(w,J,G,M=0,N=0,R=null,C=null){this.commandId=w;this.controlId=J;this.timeStamp=G;this.commandSurface=r.a[M];this.Pu=m.a[N];this.contentType=R;this.awd=C}}Object(K.a)(n,"CommandActionInfo",null,[]);class z{constructor(){this.wTh=RegExp("(Close|TabSwitch|((Populate|Query|Report|Show|BrowserFocus).+)|(.+(Rendered|Seen|Scroll)))")}W5j(w){return!this.wTh.exec(w)}}Object(K.a)(z,"EventsCacheLoggingUtils",
null,[]);var v=d(27),x=d(1152),B=d(772);d.d(U,"a",function(){return D});class D{constructor(){this.Pmf=null;this.HJd=20;this.VAc=this.Q3a=this.aTb=null}init(){this.Pmf=new z;this.aTb=new h.a;this.Q3a=new h.a;this.VAc=new h.a;this.HJd=v.AFrameworkApplication.fa.wc("MaxCommandClickedEventQueueSize",20);x.a.kgi(Object(e.a)(this,this.hDi,"commandClickEventRaised"));B.a.instance.Yyf(Object(e.a)(this,this.p0k,"recordActionEvent"))}v7e(w){w.count>this.HJd&&w.removeAt(this.HJd)}hDi(w,J){this.aTb.insert(0,
new n(J.commandId,J.controlId,J.time,J.commandSurface,J.Pu,J.contentType));this.v7e(this.aTb)}p0k(w,J){this.Q3a.insert(0,new n(J.actionName,J.controlId,J.timeStamp,J.commandSurface,J.Pu,J.contentType,J.awd));this.v7e(this.Q3a);this.Pmf.W5j(J.actionName)&&(this.VAc.insert(0,new n(J.actionName,J.controlId,J.timeStamp,J.commandSurface,J.Pu,J.contentType,J.awd)),this.v7e(this.VAc))}static get instance(){return D.La||(D.La=new D)}}D.La=null;Object(K.a)(D,"CommandClickEventsCache",null,[])},726:function(K,
U,d){d.r(U);K=d(0);var h=d(732),e=d(27),r=d(47),m=d(55),n=d(106),z=d(1245),v=d(1246),x=d(19),B=d(338);const D=(T,ca)=>{if(T){T=T.trim().toLowerCase();if("true"===T)return!0;if("false"===T)return!1}return ca};var w=d(744),J=d(28),G=d(971),M;(function(T){T[T.none=0]="none";T[T.internal=1]="internal";T[T.clipService=2]="clipService"})(M||(M={}));Object(K.b)("ClipboardIframeContent",M);var N=d(391),R=d(687),C=d(449),O=d(49);d.d(U,"ClipboardHelper",function(){return S});class S{constructor(T,ca,L,da,Z,
fa){this.lfk=[B.a.DW,B.a.Jp,B.a.location,B.a.QD,B.a.type,B.a.uKe,B.a.count,B.a.WFa,B.a.UFa,B.a.Dlb,B.a.slideId,B.a.sessionId,B.a.timeStamp,B.a.Ky];this.GEe=new h.a;this.aEe=new z.a(v.a.Ml());this.Qq=T;this.kAg=ca;this.Ec=fa;if(L&&0<L.length){T=L.split(";");for(const aa of T)T=this.B9f(aa),0<T.length&&this.GEe.add(T)}this.mfk=da;this.HBe=Z;if(this.l2c()){da=e.AFrameworkApplication.fa.Ha("PicklingAPIMaxPackageSizeInMB").split(";");for(const aa of da)da=aa.split(":"),2===da.length&&0<da[0].length&&0<
da[1].length&&this.aEe.add(da[0],parseInt(da[1]))}}Ezd(T,ca,L,da,Z,fa,aa){if(T.contentWindow&&T.contentWindow.document&&T.contentWindow.document.body){O.a.S1b(T);const I=O.a.kda();var ja=document.createTextNode(O.a.TJe);I.appendChild(ja);ja=null;let sa=0;if(!ca)J.a.J(512329178,826,50,"ClipboardHelper::WriteClipboardObjectsToClipboardTarget: internalClipboardObjects is empty for ccpCorrId: {0}",aa),Sys.UI.DomElement.addCssClass(I,O.a.T4d);else if(ca.length&&ca[0]&&ca[0].D8a&&(Sys.UI.DomElement.addCssClass(I,
this.Qq.hr[0].D8a),sa=1,L)){r.a.Xa(L.QD)&&J.a.J(512329177,307,10,"ClipboardHelper::WriteClipboardObjectsToClipboardTarget: DC was empty for the given ccpid: {0}",L.Jp);sa=2;ca=w.a(L.dataType);I.setAttribute(B.a.DW,L.DW);I.setAttribute(B.a.TRa,L.TRa);I.setAttribute(B.a.Jp,L.Jp);I.setAttribute(B.a.version,L.version);I.setAttribute(B.a.location,L.location);I.setAttribute(B.a.QD,L.QD);I.setAttribute(B.a.type,ca);I.setAttribute(B.a.count,L.objectCount.toString());I.setAttribute(B.a.WFa,L.WFa);I.setAttribute(B.a.UFa,
L.UFa);I.setAttribute(B.a.Ky,L.Ky);const ka=(new Date).toUTCString();J.a.J(512329176,307,50,"ClipboardHelper::WriteClipboardObjectsToClipboardTarget: A {0} cut/copy:{1} was performed at UTC Time: {2}",ca,L.WFa,ka);I.setAttribute(B.a.timeStamp,ka);if(1===L.dataType||2===L.dataType)ca=String.format("{0}GetClipboardBytes.ashx",e.AFrameworkApplication.fa.Ha("361"))+"?Id="+r.a.Qe(L.Jp)+"&DC="+r.a.Qe(L.QD)+"&pkey="+r.a.Qe(L.Ky)+"&wdwaccluster="+r.a.Qe(L.QD)+"&DataType="+ca,I.setAttribute(B.a.KBi,ca);L.fmc&&
I.setAttribute(B.a.uKe,this.lil(L.fmc));1===L.dataType&&this.HBe&&(ja=O.a.sB(),ja.id=B.a.Xig,ja.setAttribute(B.a.rLj,"true"),L=String.format("{0}GetClipboardImage.ashx",e.AFrameworkApplication.fa.Ha("361"))+"?Id="+r.a.Qe(L.Jp)+"&DC="+r.a.Qe(L.QD)+"&pkey="+r.a.Qe(L.Ky)+"&wdwaccluster="+r.a.Qe(L.QD),ja.src=L)}I.setAttribute(B.a.sessionId,da);I.setAttribute(B.a.Dlb,Z?Z.join(","):"");fa?I.setAttribute(B.a.slideId,fa.cid.toString()+"+"+fa.sid.toString()):I.setAttribute(B.a.slideId,"");T.contentWindow.document.body.appendChild(I);
ja&&T.contentWindow.document.body.appendChild(ja);this.Ec.ji(N.a.GIi,M[sa],aa)}}w0j(T){var ca="";m.a.ik?ca="Chromium":m.a.gg?ca="Firefox":m.a.bcc&&(ca="Safari");ca=this.aEe.Fb(ca)?this.aEe.ga(ca):0;(ca=Math.ceil(T)<=ca)||J.a.J(512329175,307,15,"Package size exceeds for pickling paste browser:{0}, size:{1}",m.a.iz,T);return ca}eWj(T){return T&&Sys.UI.DomElement.containsCssClass(T,O.a.T4d)?!0:!1}hWj(T){return!!T&&!!T.getAttribute&&D(T.getAttribute(B.a.UFa),!1)}K5j(T){return!!T&&!!T.hn&&!!T.hn.firstChild&&
!!T.hn.firstChild.className&&this.L5j(T.hn.firstChild.className)}L5j(T){return!!T&&T.startsWith("CID")&&n.a.isValid(T.substring(3,T.length))}B5j(T){return!!T&&!!T.Jp&&!!T.QD&&0!==T.dataType&&0<T.objectCount&&!!T.Ky}Usl(T){if(!this.mSj(T))return J.a.J(512329174,307,50,"DC '{0}' is not allowed",T.QD),!1;if(T.rta&&"TimeStamp"in T.rta){var ca=new Date(Date.parse(T.rta.TimeStamp));T=60*this.mfk-5;ca=S.oHf(ca);if(ca>=T)return J.a.J(512329173,307,50,"The data copied expired: expireTime: '{0}', elapsedTime: '{1}'.",
T,ca),!1}return!0}B9f(T){return T?T.trim().toUpperCase():""}mSj(T){return!this.Xme(T)||this.GEe.contains(this.B9f(T.QD))||this.GEe.contains("ALL")}nmg(T){return!!T&&!!T.aX&&!!T.aX.length&&!!T.aX[0]}omg(T){return this.nmg(T)&&Object(x.a)(C.a,T.aX[0])}gTj(T){return this.nmg(T)&&Object(x.a)(R.a,T.aX[0])}wme(T){return!!T&&!!T.Ku&&this.Usl(T.Ku)}fTj(T){return this.wme(T)&&1===T.Ku.dataType}eTj(T){return this.wme(T)&&2===T.Ku.dataType}dTj(T){return this.wme(T)&&3===T.Ku.dataType}hTj(T){return!!T&&!!T.VM}iTj(T){return this.hTj(T)&&
1===T.VM.contentType}l2c(){return!(m.a.Ex||m.a.bcc)&&e.AFrameworkApplication.fa.ka("PicklingAPISlidePasteEnabled")}SBi(T,ca){if(T&&ca&&T.getAttribute)for(const L of this.lfk){const da=T.getAttribute(L);da&&ca.setAttribute(L,da)}}Xme(T){if(T.QD!==this.kAg)return J.a.J(512329172,307,50,String.format("IsCrossDCPaste: It's a cross-dc paste '{0}': from '{1}' to '{2}', {3}.",w.a(T.dataType),T.QD,this.kAg,T.Jp)),!0;J.a.J(512329171,307,50,String.format("IsCrossDCPaste: It's a paste '{0}' in '{1}', {2}.",
w.a(T.dataType),T.QD,T.Jp));return!1}y1i(T,ca){var L=T.getAttribute(B.a.Jp),da=parseInt(T.getAttribute(B.a.version)),Z=T.getAttribute(B.a.Ky),fa=parseInt(T.getAttribute(B.a.DW)),aa=parseInt(T.getAttribute(B.a.TRa)),ja=T.getAttribute(B.a.type);ja=ja?w.b(ja):2;var I=Object,sa=I.assign,ka=new G.a;fa=isNaN(fa)?32:fa;aa=isNaN(aa)?0:aa;da=isNaN(da)?0:da;var Ma=T.getAttribute(B.a.location),Ea=T.getAttribute(B.a.QD),ma=T.getAttribute(B.a.count);ma=parseInt(ma);L=sa.call(I,ka,{DW:fa,TRa:aa,Jp:L,version:da,
location:Ma,QD:Ea,dataType:ja,objectCount:isNaN(ma)?-1:ma,WFa:D(T.getAttribute(B.a.WFa),!1),UFa:D(T.getAttribute(B.a.UFa),!1),Ky:Z});Z=S.F1i(T);ja=S.J1i(T);L.rta={["SessionId"]:Z,["TimeStamp"]:ja?ja.toUTCString():""};ca=S.JWd(L,ja,this.Ec,ca);J.a.J(512329170,307,50,"ExtractClipboardObjectFromClipboard: {0}",ca);if(T=T.getAttribute(B.a.uKe))L.fmc=this.ZSi(T);return L}lil(T){return JSON.stringify(T)}ZSi(T){try{return JSON.parse(T)}catch(ca){return J.a.J(512329169,826,15,"{0} when parse json string: {1}",
ca.toString(),T),null}}static Gmg(T){return T&&T.rta&&"SessionId"in T.rta?S.zrg(T.rta.SessionId.toString()):!1}static zrg(T){return r.a.Xa(T)||r.a.Xa(e.AFrameworkApplication.userSessionId)?!1:e.AFrameworkApplication.userSessionId.toLowerCase()===T.toLowerCase()}static JWd(T,ca,L,da){const Z=w.a(T.dataType);T=String.format("A {0} ClipServiceObject was just created: '{1}'",Z,T);ca&&(ca=S.oHf(ca),T+=String.format(", time elapsed between COPY and PASTE: {0} seconds.",ca),L.ji("CopyPasteElapsedSec",ca.toString(),
da));return T}static F1i(T){T=T.getAttribute(B.a.sessionId);return void 0===T||null===T?"":T}static J1i(T){T=T.getAttribute(B.a.timeStamp);return void 0===T||null===T?null:new Date(Date.parse(T))}static oHf(T){var ca=new Date;if(!T)throw Error.argumentNull("fromTime");if(!ca)throw Error.argumentNull("toTime");return(ca.getTime()-T.getTime())/1E3}}Object(K.a)(S,"ClipboardHelper",null,[372])},737:function(K,U,d){K=d(0);class h{}Object(K.a)(h,"AuthContext",null,[]);var e=d(27),r=d(227);d.d(U,"a",function(){return m});
class m{static getAuthContext(){const n=e.AFrameworkApplication.fa.Ha("UserPrincipalName")||"";let z=n;e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginHintEnabled",!1)&&(z=r.OAuthManagerSettings.Dzk||n);return Object.assign(new h,{upn:n,loginHint:z,authority:r.OAuthManagerSettings.authority,authorityType:m.iUc(),tenantId:e.AFrameworkApplication.fa.Ha("TenantId")||""})}static iUc(){let n=0;const z=m.c4f();"aad"===z.toLowerCase()?n=2:"msa"===z.toLowerCase()&&
(n=1);return n}static c4f(){return e.AFrameworkApplication.fa.Ha("HostAuthType")||""}}Object(K.a)(m,"OAuthIdentity",null,[])},741:function(K,U,d){K=d(0);var h=d(7),e=d(27),r=d(81),m=d(55),n=d(47),z=d(106);class v{constructor(G,M){this.message=G;this.Bj=M}}Object(K.a)(v,"CrossDocumentEventArgs",null,[]);var x=d(539),B=d(178),D=d(580),w=d(939);d.d(U,"a",function(){return J});class J{constructor(G,M,N,R){this._name="";this.ANa={};this.rnf=null;this.MXb=[];this.AUb=[];this.BUb=[];this.ZWb=[];this.iuf=
G;this.huf=M;this.I7={};this.Xba={};this.IWb=N;J._id++;R&&R();this.KG=this.enable()}get DMa(){return this.huf}get CHh(){return this.iuf}enable(){if(!D.a())return w.a.sendTraceTag(5018251,2,"Not supported for current browser."),!1;this.NQj();w.a.sendTraceTag(5018252,2,"Enabled.");return!0}isEnabled(){return this.KG}NQj(){w.a.debugAssertTag(5018253,!!this.IWb,null);this.rnf=Object(h.a)(this,this.$vk,"messageListener");this.IWb.Sni(this.rnf)}disable(){this.KG=!1;this.MXb=[];this.AUb=[];this.BUb=[];this.ZWb=
[];this.iuf=null;this.huf="";this.IWb.vTi();this.I7={};this.Xba={}}dispose(){this.disable()}voe(G){return!!this.MXb&&Array.contains(this.MXb,G)||this.Jpg(G)}Jpg(G){return!!this.AUb&&Array.contains(this.AUb,G)}Iu(G){w.a.debugAssertTag(5018259,!!this.MXb,null);Array.add(this.MXb,G);w.a.sendTraceTag(5018260,2,"Allow receiving : {0}",G)}Lwf(G){w.a.debugAssertTag(5018261,!!this.AUb,null);Array.add(this.AUb,G);w.a.sendTraceTag(5018262,2,"Allow free receiving: {0}",G)}DZj(G){return!!this.BUb&&Array.contains(this.BUb,
G)}Mwf(G){w.a.debugAssertTag(5018263,!!this.BUb,null);Array.add(this.BUb,G);w.a.sendTraceTag(5018264,2,"Allow free sending: {0}",G)}zbc(G){G=r.a.DQ(G);return!!G&&!!this.ZWb&&Array.contains(this.ZWb,G)}qCa(G){w.a.debugAssertTag(5018265,!!this.ZWb,null);if(G===J.S_b)return w.a.debugAssertTag(5018266,!1,null),!1;let M=r.a.DQ(G);if(!M)return w.a.sendTraceTag(5018267,4,"Get origin fail:{0}",G),!1;e.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.NormalizePostMessageOrigin")&&
(M=n.a.rg(M));Array.add(this.ZWb,M);w.a.sendTraceTag(5018268,2,"Add origin:{0}",M);return!0}send(G,M=null){let N=this.DMa;if(M){M=r.a.DQ(M);if(!M)return!1;N=M}return this.Vkb(G,this.CHh,N)}sendMessage(G,M,N=""){N=N&&""!==N?N:z.a.create().toString();return this.send(this.QNe(G,M,N,e.AFrameworkApplication.userSessionId))}postMessage(G){const M=z.a.create().toString();if(!e.AFrameworkApplication.fa.ka("RetryablePostMessagingIsEnabled")||!G.shouldRetry)return this.send(this.QNe(G.messageId,G.values,M,
G.userSessionId));if(!this.I7[G.eIc]){this.Iu(G.eIc);const N=Object(h.a)(this,this.ackMessageHandler,"ackMessageHandler");this.dC(G.eIc,N)}this.ANa[M]="";return this.ugh(G,M,1)}ugh(G,M,N){if(""!==M&&M in this.ANa&&"ACK_RECEIVED"===this.ANa[M])return delete this.ANa[M],!0;if(N>G.wxa)return w.a.sendTraceTag(40716250,4,'No retries remaining. {{"MessageId":{0}, "CorrelationId":{1}}}',G.eIc,M),delete this.ANa[M],!1;w.a.sendTraceTag(40716251,1<N?4:2,'Sending postmessage. Attempts remaining {0}. {{"MessageId":{1}, "CorrelationId":{2}}}',
G.wxa-N,G.messageId,M);N++;window.setTimeout(()=>{this.ugh(G,M,N)},G.gai);G.values[B.a.fai]=!0;return this.send(this.QNe(G.messageId,G.values,M,G.userSessionId))}ackMessageHandler(G){G=G.CorrelationId;""!==G&&G in this.ANa&&(w.a.sendTraceTag(42783044,2,"Received Ack for Message {0} CorrelationId: {1}",this.ANa[G],G),this.ANa[G]="ACK_RECEIVED")}QNe(G,M,N,R){G=new x.a(G);G.CorrelationId=N;M&&(G.Values=M);G.Values.wdUserSession=R;return G}Vkb(G,M,N){w.a.debugAssertTag(5018269,!!G,null);if(!this.KG)return!1;
w.a.debugAssertTag(5018270,!!M,null);w.a.debugAssertTag(5018271,!!N,null);if(!M||!N)return w.a.debugAssertTag(5018272,!1,null),!1;if(N===J.S_b&&!this.DZj(G.MessageId))return w.a.sendTraceTag(5018273,1,"Got unregistered message {0}",{["id"]:G.MessageId}),!1;G.SendTime=(new Date).getTime();let R="";try{R=Sys.Serialization.JavaScriptSerializer.serialize(G)}catch(C){return w.a.sendTraceTag(5018274,4,"JSON Ser failed {0}",{["Exception"]:C.message}),!1}M=J.sendMessage(M,R,N);w.a.sendTraceTag(5018275,2,
"Send {0}. {1}",M?"succeeded":"failed",{["id"]:G.MessageId,["origin"]:N});return M}dC(G,M){w.a.debugAssertTag(5018304,!!M,null);w.a.debugAssertTag(5018305,!!this.I7&&!!this.Xba,null);this.KG&&(this.voe(G)?this.I7[G]!==M&&(w.a.debugAssertTag(5018307,!this.I7[G]&&!this.Xba[G],null),this.I7[G]=M,delete this.Xba[G]):w.a.sendTraceTag(5018306,2,"Not allow receiving {0}",{["id"]:G}))}t0a(G,M){w.a.debugAssertTag(40420062,!!M,null);w.a.debugAssertTag(40420063,!!this.Xba&&!!this.I7,null);this.KG&&(this.voe(G)?
this.Xba[G]!==M&&(w.a.debugAssertTag(40420065,!this.I7[G]&&!this.Xba[G],null),this.Xba[G]=M,delete this.I7[G]):w.a.sendTraceTag(40420064,2,"Not allow receiving {0}",{["id"]:G}))}aMl(G){this.KG&&(this.I7[G]&&delete this.I7[G],this.Xba[G]&&delete this.Xba[G])}$vk(G){const M=this.jlj(G);if(!M)return!1;if(this.I7[M.MessageId])return this.IWb.T_c(this.I7[M.MessageId],M),!0;if(this.Xba[M.MessageId]){let N=this.Xba[M.MessageId];G=new v(M,G);this.IWb.wRj(N,G);return!0}return!1}jlj(G){const M=new Date;this.Bck(G);
if(!G.origin||!G.source||void 0===G.data||null===G.data)return w.a.sendTraceTag(5018308,4,"eventArgs missing required properties."),null;const N=this.M6j(G.data);if(!N)return null;if(!this.zbc(G.origin)){if(!this.Jpg(N.MessageId))return w.a.sendTraceTag(5018309,1,"{0}",{["id"]:N.MessageId}),null;if(!m.a.rcb&&G.source!==this.CHh)return w.a.sendTraceTag(5018310,4,"Received message came from a source other than the parent window."),null}w.a.debugAssertTag(5018311,!!N.Values,null);N.Values.m_Source=G.source;
N.Values.m_Origin=G.origin;N.Values.m_ReceivedTime=M.getTime();return N}M6j(G){if(!G)return null;let M=null;try{M=Sys.Serialization.JavaScriptSerializer.deserialize(G,!0)}catch(C){return 2>J.lef&&(w.a.sendTraceTag(5018312,2,"Deser failed"),J.lef++),null}if(!M)return w.a.debugAssertTag(5018313,!1,null),null;for(G=0;G<J.UOc.length;G++)if(!M[J.UOc[G]])return"MessageId"!==J.UOc[G]&&w.a.sendTraceTag(41502555,2,"Cannot find required message field: {0}",J.UOc[G]),null;if(M.Values)try{M.Values}catch(C){return w.a.sendTraceTag(5018314,
4,"Not a valid dictionary: {0}",C.message),null}else w.a.sendTraceTag(41502556,2,"No values in message");G=M.MessageId;if(!this.voe(G))return w.a.sendTraceTag(5018315,1,"Ignore recvd {0}",{["id"]:G}),null;const N=M.SendTime,R=(new Date).getTime()-N;if(0>N)return w.a.sendTraceTag(520435660,2,"{0}",{["t"]:N,["id"]:G}),null;6E4<R&&w.a.sendTraceTag(520435659,2,"{0}",{["t"]:N,["delta"]:R,["id"]:G});-300>R&&w.a.sendTraceTag(520435658,2,"{0}",{["t"]:N,["delta"]:R,["id"]:G});G=new x.a;G.MessageId=M.MessageId;
G.SendTime=M.SendTime;G.CorrelationId=M.CorrelationId;M.Values&&(G.Values=M.Values);w.a.sendTraceTag(40640779,1,"Received message with MessageId:{0}, SendTime:{1}, CorrelationId:{2}",G.MessageId,G.SendTime,G.CorrelationId);return G}Bck(G){w.a.sendTraceTag(5018318,1,String.format("Received: {0}",{["origin"]:G.origin,["data"]:G.data,["source"]:G.source}))}static sendMessage(G,M,N){if(!D.a())return w.a.debugAssertTag(5018319,!1,null),!1;try{return G.postMessage(M,N),!0}catch(R){w.a.sendTraceTag(5018320,
4,"{0}",{["exception"]:R.message})}return!1}}J.UOc=["MessageId","SendTime"];J.S_b="*";J._id=0;J.lef=0;Object(K.a)(J,"CrossDocumentMessenger",null,[107,332])},742:function(K,U,d){d.r(U);var h=d(152);K=d(0);var e=d(469),r=d(77),m=d(142),n=d(93),z=d(67),v=d(318),x=d(27),B=d(47),D=d(55),w=d(56),J=d(96),G=d(28),M=d(33),N=d(86),R=d(965),C=d(957),O=d(955),S=d(958),T=d(959),ca=d(962),L=d(963),da=d(960),Z=d(956),fa=d(964),aa=d(961);class ja{createAuthProviderAsync(Ma){w.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").Eja();
return new Promise(Ea=>{w.a.instance.Ia("PowerPointWebEditor.IAppForOfficeAuthFactory").execute(ma=>{ma=ma.MJi(Ma);Ea(ma)})})}}Object(K.a)(ja,"SlideShowAppForOfficeAuthFactory",null,[]);var I=d(1034),sa=d(69);d.d(U,"SlideShowCoreFrame",function(){return ka});class ka{constructor(Ma,Ea,ma,va,Ca,oa,Da,ta,ha,Ha,bb,Na,Ia,Qa){this.yk=this.fjc=this.Fbd=null;this.tfa=new e.a;this.xa=new r.a;this.JHe="";this.Gw=null;this.sfd="";this.eGe=this.uGg=this.$jc=this.BO=this.aaa=this.Z$=this.awa=this.K=null;this.bkc=
!0;this.vYa=Date.now();this.tYa=Date.now();this.Aeb=this.e_g=0;this.MEb=!1;this.LCk=()=>{G.a.J(512309270,830,50,"SlideShowCoreFrame::OnEditHappened");this.tYa=Date.now()};this.BEk=()=>{G.a.J(512309269,830,50,"SlideShowCoreFrame::OnLastMergeEditUTCChangedHandler");this.tYa=Date.now()};this.rGk=()=>{G.a.J(512309268,830,50,"SlideShowCoreFrame::OnRealTimeEditHandler");this.tYa=Date.now()};this.k2k=qa=>{Object(h.a)(this,void 0,void 0,function*(){if(this.uyg){var Wa=(new Date).getTime();try{const Hb=yield this.uyg.gI("Hubble",
qa);Hb.IsSuccess?this.yk.setAadToken(Hb.Token):this.yk.setAadToken("");G.a.J(508949124,830,50,`SlideShowCoreFrame::Hubble token requested by: ${"PowerPoint Slideshow"} successful: ${Hb.IsSuccess} time: ${(new Date).getTime()-Wa}`)}catch(Hb){G.a.J(508949123,830,10,`SlideShowCoreFrame::Hubble token requested by: ${"PowerPoint Slideshow"} successful: false time: ${(new Date).getTime()-Wa} error: ${Hb}`),this.yk.setAadToken("")}}else G.a.J(508949125,830,10,"SlideShowCoreFrame::Refresh token requested without IOAuthManager. Setting AAD token as empty for SlideShow."),
this.yk.setAadToken("")})};this.tf=Ma;this.la=Ea;this.Hc=ma;this.HDb=va;this.Xl=Ca;this.Ub=oa;this.xO=ta;this.nu=Da;this.wHe=ha;this.ke=Ha;this.aCg=bb;this.li=Na;this.UO=Ia;this.Su=Qa;this.wrk=m.a.getInstance();this.aCg&&this.aCg.execute(qa=>{qa.bJc(this.LCk)});this.li&&(this.li.Mfi(this.BEk),this.li.Jhi(this.rGk));try{const qa=this.D5=JSON.parse(this.la.Ha("Settings"))||{};qa.slideshowcore||(qa.slideshowcore={});qa.slideshowcore&&qa.slideshowcore.forceSvg&&"true"===qa.slideshowcore.forceSvg.toString().toLowerCase()?
this.wHe=!0:this.wHe&&(qa.slideshowcore.forceSvg="True");qa.slideshowcore.enableCameoInPPTOSlideShow=this.la.kta.toString()}catch(qa){G.a.J(512495906,830,10,"SlideShowCoreFrame::Exception in parsing settings:{0}",qa),this.D5={}}}preloadShaders(){this.n0e();this.gtd();SlideShowCore.SlideShowCore.preloadShaders()}init(Ma,Ea,ma,va){return Object(h.a)(this,void 0,void 0,function*(){this.JHe=ma;this.UO=va;this.sfd=Ea;if(this.Gw)G.a.J(509636752,830,50,"SlideShowCoreFrame::init - initPromise {0}",this.wgc);
else{this.awa=document.getElementById("HiddenFocusTrapAnchor");this.Gw=document.createElement("div");this.Gw.id="SlideShowBackground";this.Gw.className="SlideShowBackground";this.Gw.style.visibility=sa.a.Xs;this.Gw.tabIndex=-1;this.K=document.createElement("div");this.K.id="SlideShowContainer";this.K.className="SlideShowContainer";this.K.tabIndex=-1;this.K.style.width=window.screen.width+"px";this.K.style.height=window.screen.height+"px";n.a.addHandler(this.Gw,z.a.xxa,Da=>{this.hFk(Da)});v.a.instance.rb(this.Gw,
Da=>this.dib(Da));this.Gw.appendChild(this.K);M.a("PresenterCoachTabFix")&&this.awa?this.tf.insertBefore(this.Gw,this.awa):this.tf.appendChild(this.Gw);var Ca=this.la.Ha("pptSlideShowCoreCssUrl"),oa=document.createElement("link");oa.setAttribute("rel","stylesheet");oa.setAttribute("type","text/css");oa.setAttribute("href",Ca);this.K.appendChild(oa);I.a.instance.init(this.la,this.Gw,this.Hc,this,this.Xl,this.Ub,this.xO);this.Z$=document.getElementById("slideshowBeginningFocusTrap");this.aaa=document.getElementById("slideshowEndFocusTrap");
this.Z$||this.aaa||(this.Z$=document.createElement("div"),this.Z$.id="slideshowBeginningFocusTrap",this.Z$.className="FocusTrap",this.Z$.tabIndex=0,n.a.addHandler(this.Z$,z.a.focus,Da=>{this.gnc(Da)}),this.aaa=document.createElement("div"),this.aaa.id="slideshowEndFocusTrap",this.aaa.className="FocusTrap",this.aaa.tabIndex=0,n.a.addHandler(this.aaa,z.a.focus,Da=>{this.gnc(Da)}),M.a("PresenterCoachTabFix")&&this.awa?(this.tf.insertBefore(this.Z$,this.tf.firstChild),this.tf.insertBefore(this.aaa,this.awa.nextSibling)):
(Ca=document.getElementById("slideshow-toolbar"),this.tf.insertBefore(this.Z$,this.Gw),this.tf.insertBefore(this.aaa,Ca)));this.wgc=this.tbg(1)}yield this.wgc})}tbg(Ma){return Object(h.a)(this,void 0,void 0,function*(){const Ea=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.la.podsWebServiceBase,this.UO),ma={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};ma["X-UserSessionId"]=x.AFrameworkApplication.userSessionId;const va=new Date;return new Promise((Ca,
oa)=>{this.Su.zj(Ea,1,"",ma,!1,0,Da=>Object(h.a)(this,void 0,void 0,function*(){yield this.$Le(Da,va);G.a.J(509636751,830,15,"SlideShowCoreFrame - getSnappedUrl GettingSnappedUrlSucceeded");Ca()}),Da=>Object(h.a)(this,void 0,void 0,function*(){yield this.ZLe(Da,Ma);G.a.J(509636750,830,10,"SlideShowCoreFrame - getSnappedUrl GettingSnappedUrlFailed");oa()}),null,null)})})}$Le(Ma,Ea){return Object(h.a)(this,void 0,void 0,function*(){G.a.J(512309283,830,15,"SlideShowCoreFrame - OnGettingSnappedUrlSucceeded. Time-Taken : {0}",
+new Date-+Ea);const ma=JSON.parse(Ma.data.ee);this.BO=ma.downloadUrl;B.a.Xa(this.BO)?G.a.J(512309282,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlSucceeded but downloadUrl is null or empty - {0}",ma):(this.vYa=Date.now(),yield this.aNj())})}R$f(){const Ma={};Ma.settings=this.D5;Ma.retryCount=this.la.wc("GetItemsRetryCount",3);Ma.retryOnCategories=this.la.Ha("GetItemsRetryCategories").split(";");const Ea={};Ea.Slide=ResourceStrings.l_Slide;Ea.AnimNum=ResourceStrings.l_AccSsAnimNum;Ea.SldNameWithTooltip=
ResourceStrings.l_AccSsSldNameWithTooltip;Ea.SldNameWithoutTooltip=ResourceStrings.l_AccSsSldNameWithoutTooltip;Ea.AnimTotalSingular=ResourceStrings.l_AccSsAnimTotalSingular;Ea.AnimTotalPlural=ResourceStrings.l_AccSsAnimTotalPlural;Ma.localizedStrings=Ea;return Ma}aNj(){return Object(h.a)(this,void 0,void 0,function*(){this.n0e();this.gtd();this.Fbd=new PodsProxy.PodsProxy(this.la.hab?this.la.TVc:this.la.podsWebServiceBase,{DownloadUrl:this.BO,DocID:x.AFrameworkApplication.gh,CustomFontCatalogUrl:this.la.Ha("CustomFontCatalogURL")},
this.la.tKa?B.a.AQ(this.la.tKa).toLowerCase():"",this.tfa,this.p$f(),this.q$f());this.fjc=new SlideShowCore.DefaultResourceProviders(this.Fbd,this.tfa,this.R$f());const Ma={};Ma.initTime=ka.T7b();Ma.uiHost="Unified App";Ma.serverUrl=B.a.Qe(this.la.podsWebServiceBase);Ma.userSessionId=this.JHe;Ma.jsScriptsBasePath=this.la.Ha("StaticContentHost")+"pptscripts/ssapp/";Ma.fileHost=this.la.Ha("FileHost");Ma.isRtl=x.AFrameworkApplication.isRtl;Ma.applicationLcid=x.AFrameworkApplication.lcid;Ma.applicationLocaleName=
x.AFrameworkApplication.uiCulture;Ma.areThirdPartyAddInsAllowed=x.AFrameworkApplication.Qca;Ma.theWsaClient=x.AFrameworkApplication.mj;Ma.appForOfficeContextActivationParameters=R.a.Ibg(this.ke);Ma.hubbleVideoEndpoint=this.la.insertOnlineVideoEndpoint;Ma.acceptLanguage=x.AFrameworkApplication.uiCulture;Ma.appForOfficeAuthFactory=new ja;const Ea={};Ea.settings=this.D5;Ea.transitionResourceCDNPath=this.la.fRf;Ea.transitionDisabledList=this.la.WMa;Ea.clickTargetEnabled=!0;Ea.mediaEnabled=!0;Ea.gifEnabled=
!0;Ea.convertGifToVideo=!0;Ea.crossSlideAudioEnabled=!0;Ea.editAudioEnabled=this.la.ka("PPTOAudioPlaybackOptionsEnabled");Ea.flipgridVideoEnabled=this.la.ka("PptModernSlideShowFlipgridVideoEnabled");Ea.useNewYoutubePlayer=!0;Ea.useNewVimeoPlayer=!0;Ea.useOnlineVideoPlayer=!0;Ea.tedVideoEnabled=this.la.ka("PptModernSlideShowTEDVideoEnabled");Ea.isStream2Enabled=this.la.ka("IsStream2VideoEnabled");Ea.endOfShowText=ResourceStrings.l_EndOfSlideShowMessage;Ea.enableSVGAsWebGLTexture=!D.a.gg&&this.la.ka("SlideShowShapeBuilderSVGEnabled");
Ea.maxSvgTextureSize=this.la.wc("ShapeBuilderMaxSvgTextureSize",2048);Ea.enableSlideSizeAdjust=this.la.ka("EnableSlideSizeAdjust");Ea.slideSizeMax={["x"]:this.la.wc("SlideShowMaxWidth",1504),["y"]:this.la.wc("SlideShowMaxHeight",849)};Ea.slideSizeMin={["x"]:this.la.wc("SlideShowMinWidth",348),["y"]:this.la.wc("SlideShowMinHeight",261)};Ea.slideSizeDefault={["x"]:this.la.wc("SlideShowDefaultWidth",1504),["y"]:this.la.wc("SlideShowDefaultHeight",849)};Ea.streamVideoUseThinEmbed=this.la.ka("StreamVideoUseThinEmbed");
Ea.slideMetadataEnabled=this.la.ka("PptModernSlideShowSlideMetadataEnabled");Ea.disabledChangeGates=this.la.Ha("PPTDisabledChangeGates");Ea.combineBootRequest=!0;Ea.localVideoTelemetryEnabled=this.la.ka("IsGFXVideoLocalTelemetryEnabled");Ea.imageSettings={["imageAppendOption"]:"all"};const ma={["slideShowCoreSettings"]:Ea,["appSettings"]:Ma};this.yk=new SlideShowCore.SlideShowCore(this.K,this.fjc,this.tfa,ma);new SlideShowCore.PrefetchAddon(this.yk,this.tfa,{["forwardPrefechCount"]:this.la.wc("PptModernSlideShowForwardPrefetchCount",
10),["backwardPrefechCount"]:this.la.wc("PptModernSlideShowBackwardPrefetchCount",5),["forwardPrerenderCount"]:this.la.wc("PptModernSlideShowForwardPrerenderCount",2),["backwardPrerenderCount"]:this.la.wc("PptModernSlideShowBackwardPrerenderCount",2)});new SlideShowCore.SlideAdvanceAddon(this.yk,this.tfa);this.e_g=Date.now();this.eGe=this.yk.init();this.yk.events.on("slideLocationChanged",()=>{this.Bjd()});this.yk.events.on("animationStateChanged",()=>{this.Bjd()});this.yk.events.on("slideDimensionsChanged",
()=>{this.getCurrentSlideDimensions()});this.yk.events.on("exitFromEndOfShow",()=>{this.NLe(!0)});this.yk.events.on("blankSlideStateChanged",va=>{this.dBk(va)});this.yk.events.on("slideshowError",va=>{this.xid(va)});this.la.ka("IsStream2VideoEnabled")&&(this.uyg=w.a.instance.resolve("Common.App.OAuth.IOAuthManager"),this.yk.events.on("aadTokenRequest",va=>{this.k2k(va)}));return new Promise(va=>Object(h.a)(this,void 0,void 0,function*(){yield this.eGe;this.bkc=!1;this.uGg=new SlideShowCore.InputsAddon(this.yk,
this.K,x.AFrameworkApplication.isRtl);new SlideShowCore.AnimationLoggerAddon(this.yk,ma,this.tfa);new SlideShowCore.TransitionLoggerAddon(this.yk,ma,this.tfa);new SlideShowCore.PerfCheckerAddon(this.yk,ma,this.tfa);this.$jc=new SlideShowCore.SlideShowInkAddon(this.yk,this.tfa,this.K,()=>this.HDb.loadScript("slideshowink"),{["telemetryLogger"]:this.wrk});this.la.kta&&(this.Wdd=new SlideShowCore.CameoWebcamAddon(this.yk));this.uGg.events.on("keydown",Ca=>{this.WJa(Ca)});G.a.J(509636749,830,15,"SlideShowCoreFrame - initSlideShowCore Finshed Initializing");
va()}))})}q$f(){const Ma={};Ma.timeout=this.la.wc("PptModernSlideShowGetItemsTimeoutMs",3E4);Ma.throwHttpErrors=!1;Ma.enableServerSpecificErrorCode=M.a("SSCore.EnableServerSpecificErrorCode");return Ma}gtd(){try{const Ma=this.D5;if(Ma.slideshowcore){const Ea={};Ea.settings=Ma;Ea.logger=this.tfa;Ea.disabledChangeGates=this.la.Ha("PPTDisabledChangeGates");window.SlideShowCore.setupGlobals_SlideShowCore(Ea)}}catch(Ma){G.a.J(509703488,830,10,"SlideShowCoreFrame::Exception in passing settings to slideshowcore:{0}",
Ma)}}n0e(){try{const Ma=this.D5;if(Ma.podsproxy){const Ea={};Ea.settings=Ma;window.PodsProxy.setupGlobals_PodsProxy(Ea)}}catch(Ma){G.a.J(512309267,830,10,"SlideShowCoreFrame::Exception in passing settings to podsproxy:{0}",Ma)}}MOh(Ma,Ea){return Object(h.a)(this,void 0,void 0,function*(){this.n0e();this.gtd();if(this.yk){this.Fbd=new PodsProxy.PodsProxy(this.la.hab?this.la.TVc:this.la.podsWebServiceBase,{DownloadUrl:this.BO,DocID:x.AFrameworkApplication.gh,CustomFontCatalogUrl:this.la.Ha("CustomFontCatalogURL")},
this.la.tKa?B.a.AQ(this.la.tKa).toLowerCase():"",this.tfa,this.p$f(),this.q$f());var ma=this.fjc;this.fjc=new SlideShowCore.DefaultResourceProviders(this.Fbd,this.tfa,this.R$f());yield this.yk.updateResourceProviders(this.fjc,{shouldRerenderSlide:!0});ma&&ma.dispose();G.a.J(593827098,830,15,"SlideShowCoreFrame::Done updating ResourceProvider. StartUrl:{0}, downloadUrl:{1}, updatedResourceProvider:{2}, IsSlideShowVisible:{3}",Ma,Ea,Date.now(),this.jWa())}else G.a.J(508908737,830,10,"SlideShowCoreFrame - updateSlideShowCore: m_slideshowCore is null")})}ZLe(Ma,
Ea){return Object(h.a)(this,void 0,void 0,function*(){const ma=Ma.data?Ma.data.Ke:-1;0<Ea--?(G.a.J(512309281,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlFailed : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",ma),yield this.tbg(Ea)):G.a.J(512309280,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlFailed : HttpStatus: {0}",ma)})}Sud(Ma,Ea,ma,va,Ca,oa,Da,ta,ha){Object(h.a)(this,void 0,void 0,function*(){this.wgc&&(G.a.J(509617947,830,15,"SlideShowCoreFrame::StartFrom - initPromise {0}",
this.wgc),yield this.wgc,this.jWa()||this.show());if(B.a.Xa(this.BO)){if(G.a.J(508924042,830,10,"SlideShowCoreFrame::StartFrom DownloadUrl is null or empty - {0}",this.BO),this.jWa()){var Ha=N.a.Oh(410);x.AFrameworkApplication.Oo(Ha);J.Health.instance.recordQosError(N.a.ida(Ha),["SlideShowACE"],!1,!0,!0,!0,null);this.yk&&this.yk.recordSessionStats({["errorName"]:"ErrorSlideShowGetItemsFailedDownloadFile"});this.exit()}}else if(this.yk){Ha={};this.tYa>this.vYa||this.bkc?(this.D5.slideshowcore.vetoBootDurationMs=
this.la.wc("PptModernSlideShowEditVetoBootDurationMs",8E3),Ha.BootScenario=this.tYa>this.vYa?"AfterEdit":"Init",G.a.J(509703459,830,15,"SlideShowCoreFrame::StartFrom - Setting vetoBootDurationMs to: {0}, LastEditTime: {1}, LastSnapTime: {2}, SlideshowWaitedForInit: {3}",this.la.wc("PptModernSlideShowEditVetoBootDurationMs",8E3),this.tYa,this.vYa,this.bkc)):(this.D5.slideshowcore.vetoBootDurationMs=this.la.wc("PptModernSlideShowCachedVetoBootDurationMs",2E3),Ha.BootScenario="Relaunch",G.a.J(509703458,
830,15,"SlideShowCoreFrame::StartFrom - Setting vetoBootDurationMs to: {0}, LastEditTime: {1}, LastSnapTime: {2}, SlideshowWaitedForInit: {3}",this.la.wc("PptModernSlideShowCachedVetoBootDurationMs",2E3),this.tYa,this.vYa,this.bkc));this.gtd();this.tYa>this.vYa&&(this.yk.showLoadingSpinner(),yield this.NOh(1));Ha.startFromTime=ha-window.performance.timing.navigationStart;Ha.SSCoreFrameStartTime=ka.T7b();I.a.instance.T6k();this.K.style.top="0";this.Z$&&this.aaa&&(this.Z$.tabIndex=0,this.aaa.tabIndex=
0);const bb={["slideId"]:{["sid"]:Ma,["cid"]:0}};bb.slideIndex=Ea-1;this.nu.Vac&&!this.nu.B9?this.Xyi(bb,Ha):this.I0f(bb,Ha)}else G.a.J(512495901,830,10,"SlideShowCoreFrame::SlideshowCore is undefined")})}prev(){return Object(h.a)(this,void 0,void 0,function*(){this.yk&&(yield this.yk.prevStep("0_anim"))})}next(){return Object(h.a)(this,void 0,void 0,function*(){this.yk&&(yield this.yk.nextStep("0_anim",3))})}show(){this.ewc(!0)}jWa(){return this.Gw&&this.Gw.style.visibility===sa.a.Oz?!0:!1}f9(){return"Modern"}ewc(Ma){I.a.instance.setVisibility(Ma&&
this.Hc.Qh);this.Gw&&(Ma?(this.Gw.style.visibility=sa.a.Oz,$addHandler(window,"visibilitychange",Ea=>{this.w_a(Ea)})):(this.Gw.style.visibility=sa.a.Xs,$removeHandler(window,"visibilitychange",Ea=>{this.w_a(Ea)})))}exit(){this.NLe(!1)}OTc(){this.NLe(!1)}transcribe(Ma,Ea,ma,va,Ca,oa,Da){const ta=!!this.Ub&&!!this.Ub.instance&&(this.Ub.instance.gTa||this.Ub.instance.kr);(this.Ub&&this.Ub.instance&&this.Ub.instance.Er&&this.Ub.instance.lEa||ta)&&!this.Ub.instance.Wwb()?G.a.J(512495900,830,10,"SlideShowCoreFrame::Transcribe - LivePresenter prevented transcriber from starting"):
(I.a.instance.transcribe(Ma,Ea,ma,va,Ca,oa,Da),this.Hc.Qh&&this.yk.recordSessionStats({["metadata"]:"subtitles"}),this.c4d())}I0f(Ma,Ea){Object(h.a)(this,void 0,void 0,function*(){this.yk.clearNavigationState();const ma={navigationType:"init"};ma.startFromTime=Ea.startFromTime;Ea.waitedForInit=this.bkc;Ea.startInitTime=this.e_g;Ea.beforeInitPromise=ka.T7b();yield this.eGe;Ea.afterInitPromise=ka.T7b();ma.bootMetrics=Ea;if(0>Ma.slideIndex)yield this.yk.gotoFirstSlide(!0,ma),this.K.style.height="100%",
this.K.style.width="100%",G.a.J(508924041,830,15,"SlideShowCoreFrame::finishStartFrom - Sending slideshowReadyEvent. slideLocation: {1}",JSON.stringify(Ma));else{const va={};va.actionContext=ma;va.fSkipTransition=!0;yield this.yk.gotoSlide(Ma,va);this.K.style.height="100%";this.K.style.width="100%";G.a.J(508924040,830,15,"SlideShowCoreFrame::finishStartFrom - Sending slideshowReadyEvent. slideLocation: {1}",JSON.stringify(Ma))}this.xa.raiseEvent("OnSlideshowReady",new Sys.EventArgs)})}Xyi(Ma,Ea){const ma=
this.la.wc("PptModernSlideShowCheckFullscreenCounter",10);let va=ma;this.Aeb=window.setInterval(()=>{va--;G.a.J(512495899,830,50,"SlideShowCoreFrame::StartFrom - check fullscreen counter: {0}.",va);if(this.nu.B9||0>=va){window.clearInterval(this.Aeb);this.Aeb=0;const Ca=20*(ma-va);Ea.checkFullscreenMs=Ca;G.a.J(512495898,830,50,"SlideShowCoreFrame::StartFrom - check fullscreen duration: {0} ms.",Ca);this.I0f(Ma,Ea)}},20)}c4d(){let Ma=0,Ea=100;this.Hc.Qh&&I.a.instance.isVisible()&&("AboveSlide"===this.Hc.fw?
(Ma=15,Ea=85):"BelowSlide"===this.Hc.fw&&(Ea=85));const ma=document.getElementById("LiveURLBarLayerHost");this.MEb&&ma?(this.K.style.top=String.format("calc({0}% + {1})",Ma.toString(),"26px"),this.K.style.height=String.format("calc({0}% - {1})",Ea.toString(),"26px")):(this.K.style.top=Ma.toString()+"%",this.K.style.height=Ea.toString()+"%")}setMicrophoneState(Ma){I.a.instance.setMicrophoneState(Ma)}yZe(Ma){Ma?this.yAl():this.oFh()}lQb(Ma,Ea=""){this.MEb=Ma;I.a.instance.bJh(Ma,Ea);this.c4d()}toggleTranscriberUIVisibility(Ma){I.a.instance.setVisibility(Ma);
I.a.instance.BJc();this.c4d()}G6e(){this.xa.raiseEvent("OnFullscreenClick",new Sys.EventArgs)}restoreFocus(){this.Gw&&this.Gw.style.visibility!==sa.a.Xs&&!this.kne()&&this.K.focus()}pausePresentation(){}getCurrentPosition(){if(this.yk){const Ma=this.yk.getSlideLocation();Ma?this.xa.raiseEvent("OnGetCurrentPosition",new S.a({["SlideId"]:Ma.slideId.sid,["SlideIndex"]:Ma.slideIndex})):G.a.J(512495897,830,10,"SlideShowCoreFrame::GetCurrentPosition: currentLocation is null")}}getCurrentPositionWithTimeLines(){if(this.yk){const Ma=
this.yk.getSlideLocation();if(Ma){const Ea=this.yk.getAnimationState(!0),ma=Ea.timelineStates,va=[];for(let Ca=0;Ca<ma.length;Ca+=1)va.push({["TimeLineId"]:ma[Ca].timelineId,["Step"]:ma[Ca].step,["LastClickTime"]:ma[Ca].lastClickTime,["StartTimeOffset"]:Ea.startTimeOffset});this.xa.raiseEvent("OnGetCurrentPosition",new S.a({["SlideId"]:Ma.slideId.sid,["SlideIndex"]:Ma.slideIndex,["TimeLineMappings"]:va}))}else G.a.J(512495896,830,10,"SlideShowCoreFrame::GetCurrentPositionWithTimeLines: currentLocation is null")}}getCurrentSlideDimensions(){if(this.yk&&
this.Gw&&this.Gw.style.visibility!==sa.a.Xs){const Ma=document.getElementById(this.wHe?"svg-canvas":"webgl-canvas");Ma&&this.xa.raiseEvent("OnGetCurrentSlideDimensions",new T.a({["SlideHeight"]:Ma.offsetHeight,["SlideWidth"]:Ma.offsetWidth,["SlideLeftBound"]:Ma.offsetLeft,["SlideBottomBound"]:Ma.offsetTop+Ma.offsetHeight}))}}zUa(Ma){Object(h.a)(this,void 0,void 0,function*(){this.yk&&(yield this.yk.gotoSlide({["slideIndex"]:Ma},{actionContext:{navigationType:"goto"},fSkipTransition:!1}))})}Sdg(Ma,
Ea){Object(h.a)(this,void 0,void 0,function*(){if(this.yk){const va={};var ma=[];let Ca=0;for(let oa=0;oa<Ea.length;oa+=1){const Da={};Da.timelineId=Ea[oa].TimeLineId;Da.step=Ea[oa].Step;Da.lastClickTime=Ea[oa].LastClickTime;Ca=Ea[oa].StartTimeOffset;ma.push(Da)}va.timelineStates=ma;va.startTimeOffset=Ca;ma={actionContext:{navigationType:"goto"}};ma.animationState=va;ma.fSkipTransition=!1;yield this.yk.gotoSlide({["slideIndex"]:Ma},ma)}})}NOh(Ma){return Object(h.a)(this,void 0,void 0,function*(){G.a.J(512309260,
830,15,"SlideShowCoreFrame::updateSlideShowCoreAfterEdit: CurrentPodSessionId:{0}",this.UO);const Ea=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.la.podsWebServiceBase,this.UO),ma={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};ma["X-UserSessionId"]=x.AFrameworkApplication.userSessionId;const va=new Date;return new Promise((Ca,oa)=>{this.Su.zj(Ea,1,"",ma,!1,0,Da=>Object(h.a)(this,void 0,void 0,function*(){yield this.PDk(Da,va);G.a.J(509636748,
830,15,"SlideShowCoreFrame - updateSlideShowCoreAfterEdit GettingSnappedUrlSucceededAfterEdit");Ca()}),Da=>Object(h.a)(this,void 0,void 0,function*(){yield this.NDk(Da,Ma);G.a.J(509636747,830,10,"SlideShowCoreFrame - updateSlideShowCoreAfterEdit GettingSnappedUrlFailedAfterEdit");oa()}),null,null)})})}PDk(Ma,Ea){return Object(h.a)(this,void 0,void 0,function*(){const ma=new Date;G.a.J(512309279,830,15,"SlideShowCoreFrame - onGettingSnappedUrlSucceededAfterEdit. Time-Taken : {0}",+ma-+Ea);const va=
JSON.parse(Ma.data.ee);this.BO=va.downloadUrl;B.a.Xa(this.BO)?G.a.J(512309278,830,10,"SlideShowCoreFrame - onGettingSnappedUrlSucceededAfterEdit but downloadUrl is null or empty : {0}",va):(this.vYa=Date.now(),yield this.MOh(Ea,ma))})}NDk(Ma,Ea){return Object(h.a)(this,void 0,void 0,function*(){const ma=Ma.data?Ma.data.Ke:-1;0<Ea--?(G.a.J(512309277,830,15,"SlideShowCoreFrame - onGettingSnappedUrlFailedAfterEdit : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",ma),
yield this.NOh(Ea)):G.a.J(512309276,830,10,"SlideShowCoreFrame - onGettingSnappedUrlFailedAfterEdit : HttpStatus: {0}",ma)})}refreshPodSession(Ma,Ea,ma=1){return Object(h.a)(this,void 0,void 0,function*(){G.a.J(512309259,830,15,"SlideShowCoreFrame::RefreshPodSession: CurrentPodSessionId:{0}, UpdatedPodSessionId:{1}",this.UO,Ma);this.UO=Ma;this.sfd=Ea;const va=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.la.podsWebServiceBase,this.UO),Ca={"Content-Type":"application/json; charset=utf-8",
WaitForSessionTimeoutMs:"0"};Ca["X-UserSessionId"]=x.AFrameworkApplication.userSessionId;const oa=new Date;return new Promise((Da,ta)=>{this.Su.zj(va,1,"",Ca,!1,0,ha=>Object(h.a)(this,void 0,void 0,function*(){yield this.QDk(ha,oa);Da()}),ha=>Object(h.a)(this,void 0,void 0,function*(){yield this.ODk(ha,ma);ta()}),null,null)})})}QDk(Ma,Ea){return Object(h.a)(this,void 0,void 0,function*(){var ma=new Date;G.a.J(512309275,830,15,"SlideShowCoreFrame - onGettingSnappedUrlSucceededOnRefreshPodSession. Time-Taken : {0}",
+ma-+Ea);const va=JSON.parse(Ma.data.ee);this.BO=va.downloadUrl;B.a.Xa(this.BO)?(G.a.J(512309274,830,10,"SlideShowCoreFrame - onGettingSnappedUrlSucceededOnRefreshPodSession but downloadUrl is null or empty : {0}",va),this.jWa()&&(ma=N.a.Oh(413),x.AFrameworkApplication.Oo(ma),J.Health.instance.recordQosError(N.a.ida(ma),["SlideShowACE"],!1,!0,!0,!0,null),this.yk&&this.yk.recordSessionStats({["errorName"]:"ErrorSlideShowRehydrationFailed"}),this.exit())):(this.vYa=Date.now(),yield this.MOh(Ea,ma))})}ODk(Ma,
Ea){return Object(h.a)(this,void 0,void 0,function*(){const ma=Ma.data?Ma.data.Ke:-1;0<Ea--?(G.a.J(512309273,830,15,"SlideShowCoreFrame - onGettingSnappedUrlFailedOnRefreshPodSession : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",ma),yield this.refreshPodSession(this.UO,this.sfd,Ea)):(G.a.J(512309272,830,10,"SlideShowCoreFrame - onGettingSnappedUrlFailedOnRefreshPodSession : HttpStatus: {0}",ma),this.jWa()&&this.exit())})}setVisibility(Ma){this.ewc(Ma)}Pga(Ma){this.Gw&&
(this.Gw.style.cursor=Ma?"default":"none");I.a.instance.Pga(Ma)}setOsfLocalStorage(){}CPe(Ma){if(this.$jc)this.$jc.onInkManagerActivity(Ma)}WJa(Ma){this.dZe(Ma)}dZe(Ma){this.xa.raiseEvent("OnSpecialKey",new Z.a({["Key"]:Ma.keyCode,["ShiftKey"]:Ma.shiftKey}))}vvh(){}gnc(){this.Gw&&this.restoreFocus()}p$f(){const Ma=new Map;Ma.set("X-UserSessionId",this.JHe);Ma.set("X-WacNoAuth","1");Ma.set("X-WacCluster",this.sfd);Ma.set("Client","Unified App");this.la.sjj&&Ma.set("UseDocCache","True");return Ma}yAl(){this.Wdd&&
this.Wdd.startWebcam()}oFh(){this.Wdd&&this.Wdd.stopWebcam()}NLe(Ma=!1){this.Aeb&&(G.a.J(512495890,830,50,"SlideShowCoreFrame::OnExitFromSlideShowHandler m_fullscreenCheckerId is not zero: {0}",this.Aeb),window.clearInterval(this.Aeb),this.Aeb=0);this.$jc&&this.$jc.resetInkCanvas();this.Z$&&this.aaa&&(this.Z$.tabIndex=-1,this.aaa.tabIndex=-1);if(this.yk){const Ea=this.yk.getSlideLocation();this.yk.endSession(ka.T7b());Ea?(this.xa.raiseEvent("OnExit",new O.a({["SlideId"]:Ea.slideId.sid,["IsBeforeReady"]:!1,
["SlideIndex"]:Ea.slideIndex,["IsFromEndOfSlideshow"]:Ma})),this.oFh()):(this.xa.raiseEvent("OnExit",new O.a({["IsFromEndOfSlideshow"]:Ma})),G.a.J(512495889,830,10,"SlideShowCoreFrame::OnExitFromSlideShowHandler: currentLocation is null"))}this.K.style.width=window.screen.width+"px";this.K.style.height=window.screen.height+"px";this.ewc(!1);I.a.instance.R3e()}Bjd(){if(this.yk&&this.Gw&&this.Gw.style.visibility!==sa.a.Xs){const Ma=this.yk.getSlideLocation();if(Ma){const Ea=this.yk.getAnimationState(!0),
ma=Ea.timelineStates,va=[];for(let Ca=0;Ca<ma.length;Ca+=1)va.push({["TimeLineId"]:ma[Ca].timelineId,["Step"]:ma[Ca].step,["LastClickTime"]:ma[Ca].lastClickTime,["StartTimeOffset"]:Ea.startTimeOffset});this.xa.raiseEvent("OnPositionChangeEventId",new L.a({["SlideId"]:Ma.slideId.sid,["SlideIndex"]:Ma.slideIndex,["TimeLineMappings"]:va}))}else G.a.J(512495888,830,10,"SlideShowCoreFrame::OnPositionChangedHandler: currentLocation is null")}}dBk(Ma){if(this.yk&&this.Gw&&this.Gw.style.visibility!==sa.a.Xs)switch(Ma){case "Hidden":this.xa.raiseEvent("OnLeaveEndOfShowEventId",
Sys.EventArgs.Empty);break;case "EndOfShow":this.xa.raiseEvent("OnEnterEndOfShowEventId",Sys.EventArgs.Empty);break;default:G.a.J(512495887,830,15,"SlideshowCoreFrame.OnBlankSlideStateChangedHandler {0}",Ma)}}xid(Ma){if(this.yk){G.a.J(512495886,830,10,"SlideshowCoreFrame.OnErrorHandler {0}",Ma);let Ea;Ma.startsWith("Server")&&(Ma="GetItemsRequestFailed");switch(Ma){case "GetItemsFailedDownloadFile":G.a.J(512495885,830,10,"SlideshowCoreFrame.OnErrorHandler ErrorSlideShowFailedToDownloadFile PodSessionId {0}",
this.UO);this.xa.raiseEvent("OnPodSessionExpired",new ca.a({["Code"]:5341407,["Reason"]:"Failed To Download File",["PodSessionId"]:this.UO}));return;case "LoadFailed":Ea=407;break;case "GetItemsFailedInvalidResponse":Ea=408;break;case "GetItemsRequestFailed":Ea=409;break;case "GetItemsTimeout":Ea=411;break;case "EnsureSlideFailed":Ea=412;break;case "SetupWebGLContextFailed":case "RestoreWebGLContextFailed":Ea=414;break;default:Ea=359}if(0!==Ea)if(this.jWa()){const ma=N.a.Oh(Ea);x.AFrameworkApplication.Oo(ma);
Ma=409===Ea?Ma:N.a.ida(ma);J.Health.instance.recordQosError(Ma,["SlideShowACE"],!1,!0,!0,!0,null);this.yk.recordSessionStats({["errorName"]:Ma})}else G.a.J(512495884,830,15,"SlideshowCoreFrame.OnErrorHandler received error when frame is hidden. ErrorCode:{0}",Ma)}}hkd(Ma){G.a.J(512495883,830,50,"SlideshowCoreFrame.OnTranscriberStartedHandler");this.yk&&this.Gw&&this.Gw.style.visibility!==sa.a.Xs&&this.xa.raiseEvent("OnTranscriberStartedEventId",new fa.a({["TranscriberSessionId"]:Ma}));this.Hc.Ywb=
!0}w_a(){G.a.J(512495882,830,50,"SlideshowCoreFrame.OnVisibilityChangeHandler");window.document.hidden&&this.xa.raiseEvent("OnVisibilityChangeEventId",new aa.a(!1))}kne(){return!!this.Ub&&!!this.Ub.instance&&this.Ub.instance.GZf}hJc(Ma){this.xa.addHandler("OnSlideshowReady",Ma)}dpd(Ma){this.xa.removeHandler("OnSlideshowReady",Ma)}fTd(Ma){this.xa.addHandler("OnBrowserEvent",Ma)}uVe(Ma){this.xa.removeHandler("OnBrowserEvent",Ma)}mzf(Ma){this.xa.addHandler("OnFullscreenClick",Ma)}Joh(Ma){this.xa.removeHandler("OnFullscreenClick",
Ma)}hTd(Ma){this.xa.addHandler("OnSlideshowContextMenu",Ma)}wVe(Ma){this.xa.removeHandler("OnSlideshowContextMenu",Ma)}ija(Ma){this.xa.addHandler("OnExit",Ma)}yga(Ma){this.xa.removeHandler("OnExit",Ma)}jzf(Ma){this.xa.addHandler("OnSlideshowError",Ma)}Goh(Ma){this.xa.removeHandler("OnSlideshowError",Ma)}dJc(Ma){this.xa.addHandler("OnGetCurrentSlideDimensions",Ma)}bpd(Ma){this.xa.removeHandler("OnGetCurrentSlideDimensions",Ma)}C_b(Ma){this.xa.addHandler("OnGetCurrentPosition",Ma)}ckb(Ma){this.xa.removeHandler("OnGetCurrentPosition",
Ma)}iJc(Ma){this.xa.addHandler("OnSpecialKey",Ma)}epd(Ma){this.xa.removeHandler("OnSpecialKey",Ma)}zzf(Ma){this.xa.addHandler("OnVisibilityChangeEventId",Ma)}EVe(Ma){this.xa.removeHandler("OnVisibilityChangeEventId",Ma)}mTd(Ma){this.xa.addHandler("OnPodSessionExpired",Ma)}AVe(Ma){this.xa.removeHandler("OnPodSessionExpired",Ma)}pzf(Ma){this.xa.addHandler("OnLogEndOfTranscriptionSession",Ma)}Loh(Ma){this.xa.removeHandler("OnLogEndOfTranscriptionSession",Ma)}KQa(Ma){this.xa.addHandler("OnPositionChangeEventId",
Ma)}dkb(Ma){this.xa.removeHandler("OnPositionChangeEventId",Ma)}ozf(Ma){this.xa.addHandler("OnLiveSubtitlesDockedViewEventId",Ma)}Koh(Ma){this.xa.removeHandler("OnLiveSubtitlesDockedViewEventId",Ma)}jTd(Ma){this.xa.addHandler("OnEnterEndOfShowEventId",Ma)}xVe(Ma){this.xa.removeHandler("OnEnterEndOfShowEventId",Ma)}lTd(Ma){this.xa.addHandler("OnLeaveEndOfShowEventId",Ma)}zVe(Ma){this.xa.removeHandler("OnLeaveEndOfShowEventId",Ma)}xzf(Ma){this.xa.addHandler("OnSubtitleUpdatedEventId",Ma)}Uoh(Ma){this.xa.removeHandler("OnSubtitleUpdatedEventId",
Ma)}yzf(Ma){this.xa.addHandler("OnTranscriberStartedEventId",Ma)}Woh(Ma){this.xa.removeHandler("OnTranscriberStartedEventId",Ma)}Gzf(Ma){this.xa.addHandler("RecordQosErrorEventId",Ma)}cph(Ma){this.xa.addHandler("RecordQosErrorEventId",Ma)}hFk(Ma){this.xa.raiseEvent("OnBrowserEvent",new C.a({["ClientX"]:Ma.clientX,["ClientY"]:Ma.clientY}))}dib(Ma){this.xa.raiseEvent("OnSlideshowContextMenu",new da.a({["ClientX"]:Ma.clientPoint.x,["ClientY"]:Ma.clientPoint.y}));return!0}static T7b(){return Math.round(window.performance.now())}}
Object(K.a)(ka,"SlideShowCoreFrame",null,[442])},744:function(K,U,d){K=d(0);class h{}h.slideType="slide";h.shapeType="shape";h.Jub="chart";Object(K.a)(h,"ClipserviceDataConstants",null,[]);d.d(U,"b",function(){return e});d.d(U,"a",function(){return r});const e=m=>m===h.slideType?1:m===h.shapeType?2:m===h.Jub?3:0,r=m=>1===m?h.slideType:2===m?h.shapeType:""},745:function(K,U,d){K=d(0);var h=d(18),e=d(47),r=d(861),m=d(231),n=d(232),z=d(233),v=d(501);class x{constructor(D,w){this.Q0a=D;this.description=
w}}Object(K.a)(x,"ColorEntry",null,[]);d.d(U,"a",function(){return B});class B{constructor(D){this.Nue={};this.oGe=null;this.Nm=D}get uAl(){if(!this.oGe){const D=new Sys.StringBuilder;for(let w of this.standardColors)D.append(String.format(B.qXd,this.TIh(w.Q0a),this.v6e(w.Q0a),w.description));this.oGe=D.toString()}return this.oGe}get standardColors(){let D;return D=new h.a,D.add(new x(12582912,ResourceStrings.L_FontColorDarkRed)),D.add(new x(16711680,ResourceStrings.L_FontColorRed)),D.add(new x(16760832,
ResourceStrings.L_FontColorOrange)),D.add(new x(16776960,ResourceStrings.L_FontColorYellow)),D.add(new x(9621584,ResourceStrings.L_FontColorLightGreen)),D.add(new x(45136,ResourceStrings.L_FontColorDarkGreen)),D.add(new x(45296,ResourceStrings.L_FontColorLightBlue)),D.add(new x(28864,ResourceStrings.L_FontColorBlue)),D.add(new x(8288,ResourceStrings.L_FontColorDarkBlue)),D.add(new x(7352480,ResourceStrings.L_FontColorPurple)),D}TIh(D){return String.format("#{0}",z.i(D))}v6e(D){return z.i(D)}bwc(D){return Object.assign(new n.a,
{ThemeColor:D.ThemeColor,ColorLuminance:D.ColorLuminance,FTintColor:D.FTintColor}).toString()}qee(D,w,J){const G=new Sys.StringBuilder;G.append(this.HWd("ThemeColors",ResourceStrings.L_ThemeFontColor,!0,D));this.pei(G);G.append(this.GWd());G.append(this.HWd("StandardColors",ResourceStrings.L_StandardFontColor,!1,D));G.append(this.uAl);G.append(this.GWd());w&&0<w.length&&(G.append(this.HWd("RecentColors",ResourceStrings.L_RecentColors,!1,J)),G.append(this.dpj(w)),G.append(this.GWd()));return G.toString()}dpj(D){const w=
new Sys.StringBuilder;for(let J=0;J<D.length;J++){const G=D[J];w.append(String.format(B.qXd,"#"+G.hex,G.hex,"#"+G.hex))}return w.toString()}HWd(D,w,J,G){return String.format(B.Uti,D,w,"ColorPicker",J?'McuLayout = "true" ':"",G)}GWd(){return B.Tti}pei(D){const w=Array(10);w[0]=this.zL(m.Color.$i(this.Nm.PresetSchemeColorMapping.Background1));w[1]=this.zL(m.Color.$i(this.Nm.PresetSchemeColorMapping.Text1));w[2]=this.zL(m.Color.$i(this.Nm.PresetSchemeColorMapping.Background2));w[3]=this.zL(m.Color.$i(this.Nm.PresetSchemeColorMapping.Text2));
w[4]=this.zL(m.Color.$i(this.Nm.PresetSchemeColorMapping.Accent1));w[5]=this.zL(m.Color.$i(this.Nm.PresetSchemeColorMapping.Accent2));w[6]=this.zL(m.Color.$i(this.Nm.PresetSchemeColorMapping.Accent3));w[7]=this.zL(m.Color.$i(this.Nm.PresetSchemeColorMapping.Accent4));w[8]=this.zL(m.Color.$i(this.Nm.PresetSchemeColorMapping.Accent5));w[9]=this.zL(m.Color.$i(this.Nm.PresetSchemeColorMapping.Accent6));const J=Array(10);J[0]=ResourceStrings.l_ThemeLabel1;J[1]=ResourceStrings.l_ThemeLabel2;J[2]=ResourceStrings.l_ThemeLabel3;
J[3]=ResourceStrings.l_ThemeLabel4;J[4]=ResourceStrings.l_ThemeLabel5;J[5]=ResourceStrings.l_ThemeLabel6;J[6]=ResourceStrings.l_ThemeLabel7;J[7]=ResourceStrings.l_ThemeLabel8;J[8]=ResourceStrings.l_ThemeLabel9;J[9]=ResourceStrings.l_ThemeLabel10;for(let G=0;5>=G;G++)for(let M=0;M<w.length;M++)D.append(this.W9i(w[M][G],w[M][0],J[M],G,M))}zL(D){const w=e.a.tw(D.r,2)+e.a.tw(D.g,2)+e.a.tw(D.b,2);if(this.Nue[w])return this.Nue[w];const J=v.a.wTa(D),G=[];Array.add(G,D);if(D.B6d())for(var M=0;M<r.a.HQh.length;++M)D=
v.a.M6b(J),D.darken(r.a.HQh[M]/100),Array.add(G,D.jua());else if(D.d2i())for(M=0;M<r.a.xEf.length;++M)D=v.a.M6b(J),D.lighten(r.a.xEf[M]/100),Array.add(G,D.jua());else if(J.lum<B.Dti)for(M=0;M<r.a.bxg.length;++M)D=v.a.M6b(J),D.lighten(r.a.bxg[M]/100),Array.add(G,D.jua());else if(J.lum>B.Cti)for(M=0;M<r.a.axg.length;++M)D=v.a.M6b(J),D.darken(r.a.axg[M]/100),Array.add(G,D.jua());else for(M=0;M<r.a.aNc.length+r.a.DLf.length;++M)D=v.a.M6b(J),M<r.a.aNc.length?D.lighten(r.a.aNc[M]/100):D.darken(r.a.DLf[M-
r.a.aNc.length]/100),Array.add(G,D.jua());return this.Nue[w]=G}W9i(D,w,J,G,M){D=this.v6e(D.Q0a);({ZMc:w,pQb:J}=this.X9d(w,D,J,G,M));return String.format(B.qXd,w,D,J)}X9d(D,w,J,G,M){var N;var R=N=null;if(0>G)return{ZMc:N,pQb:R};w=Object.assign(new n.a,{RGBColor:w,ThemeColor:M,ColorLuminance:0,FTintColor:!1});G?(M=v.a.wTa(D),R=G-1,M.lum?1===M.lum?(G=!1,R=[242,217,191,166,127][R]):.8<M.lum?(G=!1,R=[229,191,127,64,25][R]):.2>M.lum?(G=!0,R=[25,64,127,191,229][R]):(M=[51,102,153],N=[191,127],R=(G=R<M.length)?
M[R]:N[R-M.length]):(G=!0,R=[127,166,191,217,242][R]),R=255-R,R=Math.round(100*R/255),w.ColorLuminance=100-R,w.FTintColor=G,R=String.format(G?ResourceStrings.l_ColorPickerTooltipTint:ResourceStrings.l_ColorPickerTooltipShade,D.toString(),J,R)):R=String.format(ResourceStrings.l_ColorPickerTooltipBase,D.toString(),J);N=this.bwc(w);return{ZMc:N,pQb:R}}}B.Uti='<MenuSection Id="{0}" Title="{1}"><Controls Id="Color.Menu.Controls"><ColorPicker Id="{2}" {3}Width="10" Command="{4}"><Colors>';B.Tti="</Colors></ColorPicker></Controls></MenuSection>";
B.qXd='<Color Color="{0}" DisplayColor="#{1}" Alt="{2}" />';B.Dti=.2;B.Cti=.8;Object(K.a)(B,"ColorPickerBuilder",null,[])},746:function(K,U,d){var h=d(106),e=d(55),r=d(81),m=d(27),n=d(36),z=d(87),v=d(29),x=d(234),B=d(329),D=d(28),w=d(993);K=d(0);class J{constructor(){this.Kz=this.onSuccess=this.YKe=this.NTd=this.qgh=null}}Object(K.a)(J,"UploadFileDialogData",null,[]);var G=d(72),M=d(33);K=d(77);d.d(U,"d",function(){return R});d.d(U,"e",function(){return C});d.d(U,"a",function(){return ca});d.d(U,
"c",function(){return L});d.d(U,"b",function(){return da});const N=new K.a,R=(Z,fa,aa,ja,I)=>{const sa=String.format("{0}{1}",aa,h.a.create().toString());return Object.assign(new J,{NTd:T(sa,ja),qgh:S(aa,ja),YKe:(ka,Ma)=>{switch(aa){case "video":Ma.blockContent(I,Z);break;default:Ma.blockContent(ka,"Insert Media")}},onSuccess:(ka,Ma,Ea,ma,va,Ca)=>{fa(Z,sa,Ma,Ea,va,Ca,I)},Kz:(ka,Ma,Ea,ma,va)=>{Ea.hO(Ma)?D.a.J(509727823,822,15,"Media::InsertMediaFailureAfterUpload:Presentation was blocked with loader for {0} milliseconds",
+new Date-+Ma.Mja):Ea.hO(I)&&D.a.J(509666848,822,15,"Media::InsertMediaFailureAfterUpload:Slide was blocked with loader for {0} milliseconds",+new Date-+I.Mja);M.a("FixHideShimmerIssueOnUploadFailure")&&"video".match(aa)?Ea.xK(I):Ea.xK(Ma);Ma=null;try{const Ca=n.a(ka);Ma=Ca?Ca.Error:null}catch(Ca){D.a.J(509727822,818,10,"UploadResponseReceived - Exception when deserializing response. Response: {0}",ka)}if(!Ma){let Ca;M.a("FixHideShimmerIssueOnUploadFailure")&&ka&&!isNaN(parseInt(ka))&&(Ca=Enum.parse(x.a,
x.a[parseInt(ka)],!0));Ma=Object.assign(new B.a,{Code:Ca?Ca:444})}va&&(va.finish(),va=null);D.a.J(509727821,822,10,"Upload media failed");ca(aa)?L(ResourceStrings.l_FileInsertFailedMessageTitle,Ma&&449===Ma.Code?ResourceStrings.l_VideoUploadTimeoutMessage:ResourceStrings.l_FileInsertFailedMessage,null):O(ma,va,Ma.Code,null)}})},C=(Z,fa,aa,ja)=>new Promise((I,sa)=>{const ka=new w.a(ja);D.a.J(509727828,822,50,"Media File details: Number of media files: {0}, media file extension: {1}",Z&&Z.value?Z.files.length:
0,w.a.M$d(Z));aa&&aa.Wa("MediaFileValidationStarts",String.format("Number of media files: {0}, media file extension: {1}",Z&&Z.value?Z.files.length:0,w.a.M$d(Z)));if(Z&&Z.value&&Z.value.length)if(ka.TSl(Z.value)){var Ma=Z.files[0];if(ka.USl(Ma.size))ka.czi(Ma).then(Ea=>{Ea?(aa&&aa.Wa("MediaFileValidationPassedOnUI","true"),I(!0)):(ca(ja)?L(ResourceStrings.l_UnsuportedFileFormatTitle,ResourceStrings.l_UnsuportedFileFormatMessage,[ka.Ona.join(", ")]):O(fa,aa,443,[ka.Ona.join(", ")]),sa(443))},()=>{D.a.J(509727825,
822,10,"Invalid media file, fileType:{0}",ja);ca(ja)?L(ResourceStrings.l_UnsuportedFileFormatTitle,ResourceStrings.l_UnsuportedFileFormatMessage,[ka.Ona.join(", ")]):O(fa,aa,443,[ka.Ona.join(", ")]);sa(443)});else{D.a.J(509727826,822,10,"video"===ja?"Media::Insert:video: max size error":`Media::Insert:Invalid media file size:${Ma.size}`);Ma=M.a("FetchMediaSizeLimitFromValidationHelper")?ka.Thc.toString():"16";const Ea="video"===ja?450:442;ca(ja)?L(ResourceStrings.l_MaxFileSizeValidationErrorTitle,
ResourceStrings.l_MaxVideoSizeValidationErrorMessage,[Ma]):O(fa,aa,Ea,[Ma]);sa(442)}}else D.a.J(509727827,822,10,"{flow:Insert{0}, fileExt:{1}}",null===ja||void 0===ja?void 0:ja.toString(),w.a.M$d(Z)),ca(ja)?L(ResourceStrings.l_UnsuportedFileFormatTitle,ResourceStrings.l_UnsuportedFileFormatMessage,[ka.Ona.join(", ")]):O(fa,aa,441,[ka.Ona.join(", ")]),sa(441);else ca(ja)?L(ResourceStrings.l_FileInsertFailedMessageTitle,ResourceStrings.l_FileInsertFailedMessage,null):O(fa,aa,440,null),sa(440)}),O=
(Z,fa,aa,ja)=>{fa&&(fa.Wa("MediaFileValidationPassedOnUI","false"),aa&&fa.Wa("ErrorCode",aa.toString()),fa.finish());Z.nH(aa,I=>{I.KC=1;I.bTa=ja;return!1})},S=(Z,fa)=>{let aa="MediaUpload.ashx";if(v.App.webServiceBase)aa=v.App.webServiceBase+aa;else if(e.a.gg||e.a.nva)aa=r.a.Lta(aa);let ja="";switch(Z){case "audio":ja="audio";break;case "captions":ja="captions";break;case "video":ja="video";break;default:D.a.J(509727824,822,10,"Media::GetMediaUploadEndpoint: file type not supported")}aa+=String.format("?MediaType={0}&{1}&{2}&{3}",
ja,m.AFrameworkApplication.qUa(),fa.presentationId.string,m.AFrameworkApplication.d7b());fa.podSessionId&&(aa+=String.format("&{0}={1}",z.a.Aaa,fa.podSessionId));fa.Ek&&(aa+=String.format("&waccluster={0}",fa.Ek));return aa},T=(Z,fa)=>{const aa=new G.a;aa.$("PresentationId",fa.presentationId.string);aa.$(z.a.xoa,fa.sessionInfo);aa.$("Canary",m.AFrameworkApplication.canary);aa.$("access_token",m.AFrameworkApplication.accessToken);aa.$("MediaToken",Z);return aa},ca=Z=>M.a("EnableCalloutNotificationsForVideos")&&
"video".match(Z)?!0:!1,L=(Z,fa,aa)=>{let ja=new B.a;ja.Title=Z;ja.Message=fa;ja.ExtraErrorParam=aa;N.raiseEvent("videoCalloutNotificationEvent",ja)},da=Z=>{N.addHandler("videoCalloutNotificationEvent",Z)}},928:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}h.PJe="TraceIdNoBar";h.A4c="TraceIdLeftBar";h.lqd="TraceIdRightBar";h.RKc="TraceIdBothBar";Object(K.a)(h,"ConsistencyCheckTraceIdType",null,[])},929:function(K,U,d){d.d(U,"a",function(){return e});K=d(0);var h=d(528);class e{constructor(){this.start=
new h.a;this.end=new h.a}clone(){return Object.assign(new e,{start:this.start.clone(),end:this.end.clone()})}merge(r){let m=!1;r.start&&(m=this.start.merge(r.start));r.end&&(m=this.end.merge(r.end)||m);return m}}Object(K.a)(e,"TextNodeSelection",null,[])},930:function(K,U,d){d.d(U,"a",function(){return 19})},931:function(K,U,d){d.r(U);d.d(U,"WordPredictionAugLoopResponseManager",function(){return B});K=d(0);U=d(18);var h=d(357),e=d(932),r=d(667),m=d(665),n=d(666),z=d(557),v=d(64),x=d(34);class B{v9b(D){B.pT.tG(()=>
{this.Srl(D)||(this.b7e(D),this.PQl(),this.fmi())},"WPT:PR")}fmi(){const D=z.a.jE.m6,w=z.a.jE.gjb;if(D){var J=v.a.instance.Pa.mb;if(J&&J.jf&&z.a.xmg(J.jf)){J=J.jf.node;var G=x.ParagraphReader.text(J);G=G.substring(D.Hrd,G.length);J=this.lae(J,D,G);"string"===typeof J?J.length?(D.j9=J,D.SOb+=1,z.a.JUd(D.text,J),this.PPl(),D.cOe=G,this.OPl(D)):w&&0===w[r.a.status]?(this.$Nh(),z.a.Mpd()):this.fRl():(this.$Nh(),z.a.Mpd())}}}OPl(D){B.aAd.count>=B.q2h&&B.aAd.removeAt(0);B.aAd.add(this.RBi(D))}RBi(D){return Object.assign(new e.a,
{id:D.id,tza:D.tza,Ux:D.Ux,Hrd:D.Hrd,text:D.text,j9:D.j9,F1b:D.F1b,q8a:D.q8a,score:D.score,M6e:D.M6e,L6e:D.L6e,EP:D.EP,SOb:D.SOb,cOe:D.cOe})}Srl(D){if(D&&D.parentPath&&7===D.parentPath.length){const w=D.parentPath[6];z.a.N_a.add(w,n.a.jUd,(new Date).getTime());z.a.mak(w)}else return z.a.udc(n.a.V4d),!0;return z.a.$Va?(D=this.Pcg(D),D=this.phh(D[0]),D[r.a.status]=5,z.a.X7d(D),z.a.udc(n.a.qDh),!0):!1}b7e(D){(D=this.Pcg(D))&&D.length?(z.a.jE.m6=D[0],z.a.jE.gJh=D.length,z.a.jE.gjb=this.phh(D[0])):(z.a.Mpd(),
z.a.udc(n.a.V4d))}Pcg(D){if(!D||!D.items||!D.parentPath||7!==D.parentPath.length)return null;var w=D.items[0];let J;try{J=w.body}catch(C){return null}w=D.parentPath[2];const G=parseInt(D.parentPath[3]),M=parseInt(D.parentPath[4]),N=D.parentPath[5];D=D.parentPath[6];if(!J.predictions.length)return null;z.a.mml(J.modelInfo);const R=Array(J.predictions.length);for(let C=0;C<J.predictions.length;C++){const O=J.predictions[C];if(O.text){const S=O.characterRange,T=O.tokenRange;R[C]=Object.assign(new e.a,
{id:N,tza:D,Ux:w,Hrd:G,text:O.text,j9:O.text.substr(S.start),F1b:S.start,q8a:S.length,score:O.score,M6e:T.start,L6e:T.length,EP:M,SOb:0})}}return R}phh(D){const w={};w[r.a.language]="en-US";const J=z.a.zlj();w[r.a.modelId]=J.modelId;w[r.a.modelVersion]=J.modelVersion;w[r.a.configId]=J.configId;w[r.a.tYd]=D.q8a;w[r.a.iMc]=D.q8a;w[r.a.Ytg]=D.j9.length;w[r.a.hhh]=D.text.length;w[r.a.khh]=D.text.split(" ").length;w[r.a.score]=D.score;w[r.a.status]=0;w[r.a.n8e]=D.j9.length;w[r.a.EP]=D.EP;D=z.a.N_a.ga(D.tza);
w[r.a.LIh]=D[n.a.jUd]-D[n.a.nuc];w[r.a.xwd]=0;return w}PQl(){const D=z.a.jE.m6;D&&(z.a.pva(D.EP,m.a.BIf,z.a.jE.gJh),z.a.pva(D.EP,m.a.IQf,D.q8a))}PPl(){const D=z.a.jE.m6,w=z.a.jE.gjb;if(D&&1===D.SOb){const J=(new Date).getTime();z.a.N_a.jjg(D.tza,n.a.ZAf,J);z.a.awg(D.tza,!0);z.a.udc(n.a.jhh);const G=z.a.N_a.ga(D.tza)[n.a.nuc];w[r.a.xwd]=J-G;w[r.a.status]=1;w[r.a.iMc]=D.text.length-D.j9.length;z.a.pva(D.EP,m.a.Huh,1);z.a.pva(D.EP,m.a.Qph,1);z.a.pva(D.EP,m.a.Rph,D.j9.length);z.a.pva(D.EP,m.a.JQf,D.text.length-
D.j9.length);z.a.kSk()}}fRl(){const D=z.a.jE.m6,w=z.a.jE.gjb;D&&(w[r.a.status]=3,w[r.a.iMc]=0,w[r.a.n8e]=D.text.length-w[r.a.tYd],z.a.X7d(w),z.a.pva(D.EP,m.a.ILh,1),z.a.pva(D.EP,m.a.LQf,D.score),z.a.pva(D.EP,m.a.JLh,D.text.length-D.q8a),z.a.Mpd())}$Nh(){const D=z.a.jE.m6,w=z.a.jE.gjb;if(D){if(0===w[r.a.status]){const J=(new Date).getTime();z.a.N_a.jjg(D.tza,n.a.XAf,J);z.a.awg(D.tza,!1);z.a.udc(n.a.ihh);const G=z.a.N_a.ga(D.tza)[n.a.nuc];w[r.a.xwd]=J-G;z.a.pva(D.EP,m.a.Z5g,1);w[r.a.status]=6}z.a.X7d(w)}}lae(D,
w,J){let G=null;w.Ux===D.id.toString()&&J&&w.F1b<J.length&&(D=J.substring(0,w.F1b)+w.text,D=D.replace(RegExp("\\u00a0","g")," "),J=J.replace(RegExp("\\u00a0","g")," "),0<D.length&&0<J.length&&(D.indexOf(J)||(G=D.substring(J.length,D.length))));return G}static get pT(){return h.a.instance}}B.q2h=4;B.aAd=new U.a;Object(K.a)(B,"WordPredictionAugLoopResponseManager",null,[])},932:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.Ux=this.tza=this.id=null;this.EP=this.Hrd=
0;this.j9=this.text=null;this.SOb=this.L6e=this.M6e=this.score=this.q8a=this.F1b=0;this.cOe=null}}Object(K.a)(h,"Candidate",null,[])},933:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.stateUpdateHandler=this.handler=this.config=this.annotationType=null}}Object(K.a)(h,"ActivateAnnotationParameters",null,[])},934:function(K,U,d){d.d(U,"a",function(){return e});K=d(0);U=d(616);var h=d(143);class e extends U.a{constructor(){super();this.tokenRange=this.predictions=
this.modelInfo=this.characterRange=null;this.H_=Object.assign(new h.a,{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_TextPredictionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(K.a)(e,"TextPredictionAnnotation",U.a,[])},935:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.operation=null}}Object(K.a)(h,"SubmitOperationParameters",null,[])},936:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e,
r,m){super();this.actionId=e;this.dBb=r;this.revisionId=m}}Object(K.a)(h,"UndoRedoMarkedUndoEventArgs",Sys.EventArgs,[])},937:function(K,U,d){d.d(U,"c",function(){return n});d.d(U,"b",function(){return z});d.d(U,"a",function(){return v});var h=d(18),e=d(392),r=d(27),m=d(36);const n=x=>{if(!x)return null;let B;try{B=m.b(x)}catch(D){B=null,e.ULS.sendTraceTag(578352835,202,15,"MruActor.TryDeserializeMruV2Response: SecureDeserialize Exception: {0}",D)}return B},z=(x,B)=>{let D=[];if(x.breadcrumbs&&0<
x.breadcrumbs.length)D=x.breadcrumbs;else{const w=x.service_info;w&&w.friendly_service_name&&Array.add(D,w.friendly_service_name);x.display_path&&Array.addRange(D,x.display_path)}return D.join(B?" \u00ab ":" \u200f\u00bb ")},v=(x,B=!1)=>{if(!x)return[];if(!x.documents)return e.ULS.sendTraceTag(578352838,202,15,"missing documents object"),[];if(!x.documents.items)return e.ULS.sendTraceTag(578352839,202,15,"missing items object"),[];x=x.documents.items;const D=new h.a;for(let J=0;J<x.length;J++){const G=
x[J];var w=G.web_url;if(!w){e.ULS.sendTraceTag(578320064,202,15,"Empty web_url");if(!G.url){e.ULS.sendTraceTag(578140248,202,15,"Empty url");continue}w=String.format("{0}?web=1",G.url)}const M={};M.DocumentUrl=w;M.MruId=G.mru_id;{w=G;let N=w.title;N?(w.extension&&(N=String.format("{0}.{1}",N,w.extension)),w=N):(e.ULS.sendTraceTag(578352837,202,15,"empty file title"),w="")}M.FileName=w;M.IsPinned=G.is_pinned;M.Path=z(G,r.AFrameworkApplication.isRtl);B&&(M.App=G.app,M.TimeStamp=G.time_stamp);D.add(M)}return D.toArray()}},
938:function(K,U,d){d.d(U,"a",function(){return x});K=d(0);var h=d(392),e=d(1050),r=d(1244),m=d(7),n=d(18),z=d(41),v=d(33);class x{constructor(B,D,w,J,G,M,N,R,C){this.VR=new e.a;this.cT=O=>this.la&&this.la.j3&&O.RL?ResourceStrings.L_AccMessageDecorative:O.get_altTitle();this.lWg=B;this.Sb=D;this.HB=G;this.Ga=w;this.Oc=M;this.Ydc=N;this.jm=J;this.Gh=R;this.la=C;this.OMj()}get Gd(){return this.Oc.instance}get KF(){return this.Ydc.value}OMj(){this.VR.$(0,[ResourceStrings.l_PhTypeCenterTitle,ResourceStrings.l_ClickToAddTitle]);
this.VR.$(1,[ResourceStrings.l_PhTypeBody,ResourceStrings.l_ClickToAddText]);this.VR.$(2,[ResourceStrings.l_PhTypeCenterTitle,ResourceStrings.l_ClickToAddTitle]);this.VR.$(3,[ResourceStrings.l_PhTypeSubTitle,ResourceStrings.l_ClickToAddSubTitle]);this.VR.$(8,[ResourceStrings.l_PhTypeObject,ResourceStrings.l_ClickToAddText]);this.VR.$(9,[ResourceStrings.l_PhTypeGraph,ResourceStrings.l_InsertContent]);this.VR.$(10,[ResourceStrings.l_PhTypeTable,ResourceStrings.l_InsertContent]);this.VR.$(11,[ResourceStrings.l_PhTypeClipArt,
ResourceStrings.l_InsertContent]);this.VR.$(12,[ResourceStrings.l_PhTypeSmartArt,ResourceStrings.l_ClickToAddSmartArt]);this.VR.$(13,[ResourceStrings.l_PhTypeMedia,ResourceStrings.l_InsertContent]);this.VR.$(15,[ResourceStrings.l_PhTypePicture,ResourceStrings.l_ClickToAddPicture]);this.VR.$(6,[ResourceStrings.l_PhTypeFooter,ResourceStrings.l_ClickToAddFooter]);this.VR.$(5,[ResourceStrings.l_PhTypeSlideNumber,ResourceStrings.l_ClickToAddSlideNumber])}Rag(B,D){B&&(this.i9(B,D),B.Pla?D.insert(0,document.createTextNode(ResourceStrings.l_ShapeObject)):
this.ace(B,null,D));return null}Krj(B){if(!this.lWg.instance||!B)return null;B=this.lWg.instance.Wag(B);if(!B||!B.length)return null;const D=B.length;return 1===D?String.format(ResourceStrings.l_ShapePresenceForOneUser,B[0].userName):2===D?String.format(ResourceStrings.l_ShapePresenceForTwoUsers,B[0].userName,B[1].userName):3===D?String.format(ResourceStrings.l_ShapePresenceForThreeUsers,B[0].userName,B[1].userName,B[2].userName):String.format(ResourceStrings.l_ShapePresenceForFourOrMoreUsers,D)}Lde(B){let D=
"";B&&B.UL&&B.image.title&&0<B.image.title.length&&(D=B.image.title);B&&(D=String.format(ResourceStrings.l_ThumbnailInfoNew,B.slideIndex+1,this.Sb.Cj(),D),B=this.mvj(B),0<B.length&&(D+=B));return D}mvj(B){const D=new Sys.StringBuilder;B.isSelected&&D.append(ResourceStrings.L_SlideIsSelected);B.yn&&D.append(ResourceStrings.l_SlideIsHidden);const w=Object(r.a)(118,B.gd);if(w){var J=w.fUa();J&&!this.jm.Eoe(J)&&D.append(ResourceStrings.l_SlideHasNotes);(J=w.qE())&&this.HB.instance&&this.HB.instance.sgg(J)&&
(J=this.HB.instance.GUc(J),D.append(1===J?ResourceStrings.l_SlideHasOneComment:String.format(ResourceStrings.l_SlideHasCommentsWithCount,J)))}B.NQ&&D.append(ResourceStrings.l_SlideHasAnimationOrTransition);if(B.ijb&&(B=B.ijb.e9())&&0<B.length)if(1===B.length)D.append(String.format(ResourceStrings.l_SlideHasPresenceForOneUser,B[0].userName));else{J="";for(const G of B)J+=G.userName+",";D.append(String.format(ResourceStrings.l_SlideHasPresenceForTwoOrMoreUsers,J))}w&&w.isUnread&&D.append(ResourceStrings.l_RevisionTracking_SlideHasUnreadChanges);
return D.toString()}mab(B,D){return String.format(ResourceStrings.l_MultipleSlidesSelected,B,D)}ufj(B,D){return String.format(ResourceStrings.l_DesignerSuggestionSelected,B+1,D)}psj(){return ResourceStrings.l_SlidePanel}Slj(){return ResourceStrings.l_MultipleShapes}R3k(B){B&&(this.la.m8a&&B.q6(Object(m.a)(this,this.Kbj,"getCameoAccMessage")),B.q6(Object(m.a)(this,this.fuj,"getTableAccMessage")),B.q6(Object(m.a)(this,this.Fij,"getImageAccMessage")),B.q6(Object(m.a)(this,this.$kj,"getMediaAccMessage")),
B.q6(Object(m.a)(this,this.$bj,"getChartAccMessage")),this.Dtd?(B.q6(Object(m.a)(this,this.pbg,"getSmartArtAccMessage")),B.q6(Object(m.a)(this,this.ace,"getPlaceHolderAccMessage"))):(B.q6(Object(m.a)(this,this.ace,"getPlaceHolderAccMessage")),B.q6(Object(m.a)(this,this.pbg,"getSmartArtAccMessage"))),B.q6(Object(m.a)(this,this.$uj,"getTextboxAccMessage")),B.q6(Object(m.a)(this,this.zrj,"getShapeGroupAccMessage")),B.q6(Object(m.a)(this,this.vrj,"getShapeAccMessage")),B.q6(Object(m.a)(this,this.N$i,
"getAddinAccMessage")),B.q6(Object(m.a)(this,this.r$i,"get3DAccMessage")))}ace(B,D,w,J=null){if(B&&w&&B.rl&&(this.zXc(B,w),this.VR.Fb(B.Qj))){J&&J(String.format("{0} {1}",this.VR.ga(B.Qj)[0],ResourceStrings.l_Placeholder));if(B.cU||!w.count){w=this.VR.ga(B.Qj)[0];D="";if(!this.Dtd||B.cU)D=this.VR.ga(B.Qj)[1];return String.format(B.get_alt()?ResourceStrings.l_AccMessagePlaceHolderPromptAlt:ResourceStrings.l_AccMessagePlaceHolderPrompt,w,this.cT(B),D,B.get_alt())}B=String.format(B.get_alt()?ResourceStrings.l_AccMessagePlaceHolderTextAlt:
ResourceStrings.l_AccMessagePlaceHolderText,this.VR.ga(B.Qj)[0],this.cT(B),B.get_alt());w.insert(0,document.createTextNode(B))}return null}$uj(B,D,w,J=null){if(B&&w&&B.Hx)if(this.zXc(B,w),J&&J(ResourceStrings.L_TextBox),0<w.count)B=String.format(B.get_alt()?ResourceStrings.l_AccMessageTextboxHasTextAlt:ResourceStrings.l_AccMessageTextboxHasText,this.cT(B),B.get_alt()),w.insert(0,document.createTextNode(B));else return String.format(B.get_alt()?ResourceStrings.l_AccMessageTextboxNoTextAlt:ResourceStrings.l_AccMessageTextboxNoText,
this.cT(B),B.get_alt());return null}pbg(B,D,w,J=null){if(B&&w&&B.Wf)if(this.zXc(B,w),J&&J(ResourceStrings.L_SmartArt),0<w.count)B=String.format(B.get_alt()?ResourceStrings.l_AccMessageSmartArtHasTextAlt:ResourceStrings.l_AccMessageSmartArtHasText,this.rbg(B)||"",this.cT(B),B.get_alt()),w.insert(0,document.createTextNode(B));else return String.format(B.get_alt()?ResourceStrings.l_AccMessageSmartArtNoTextAlt:ResourceStrings.l_AccMessageSmartArtNoText,this.rbg(B)||"",this.cT(B),B.get_alt());return null}i9(B,
D){B&&D&&this.Ga.eK(B,w=>{w.Ua(z.a.tq)&&this.x8f(w,D)})}zXc(B,D){if(B&&D){const w=this.Dtd?new n.a:D;let J=!1;this.Ga.eK(B,G=>{const M=this.Gh.gX(G),N=this.Gh.Hib(G);M&&w.add(document.createTextNode(String.format(ResourceStrings.l_AccMessageTextLevel,N)));J=this.x8f(G,w)||J});this.Dtd&&J&&D.addRange(w);D.count||(B=B.L5e)&&D.add(document.createTextNode(B))}}get Dtd(){return v.a("AriaMessageHelper.FixAccMessageForEmptyList")}x8f(B,D){let w;const J=B.sa(z.a.Hvc,null),G=B.sa(z.a.tq,"");if(G&&D){if(J){let M=
0,N=null,R;for(let C=0;C<J.length+1;C++)R=this.Ga.XVc(B,C),N&&N!==R&&(w=document.createElement("span"),w.setAttribute("lang",N),w.innerText=G.substring(M,J[C-1]),M=J[C-1],D.add(w)),N=R;w=document.createElement("span");N&&w.setAttribute("lang",N);w.innerText=G.substring(M,G.length)}else w=document.createElement("span"),(B=this.Ga.XVc(B,0))&&w.setAttribute("lang",B),w.innerText=G;D.add(w)}return!!G&&0<G.length}fuj(B,D,w,J=null){return B&&B.vd?(J&&J(ResourceStrings.L_Table),String.format(B.get_alt()?
ResourceStrings.l_AccMessageTableAlt:ResourceStrings.l_AccMessageTable,this.cT(B),B.get_alt())):null}Fij(B,D,w,J=null){return B&&B.qj?(J&&J(ResourceStrings.l_Image),String.format(B.get_alt()?ResourceStrings.l_AccMessageImageAlt:ResourceStrings.l_AccMessageImage,this.cT(B),B.get_alt())):null}Kbj(B,D,w,J=null){if(!B||!B.Yua)return null;J&&J(ResourceStrings.l_Cameo);return B.get_alt()?String.format(ResourceStrings.l_AccMessageCameoAlt,this.cT(B),B.get_alt(),ResourceStrings.l_CameoLearnMoreMessage):String.format(ResourceStrings.l_AccMessageCameo,
this.cT(B),ResourceStrings.l_CameoLearnMoreMessage)}$kj(B,D,w,J=null){if(B){if(0===B.mediaType)return null;if(1===B.mediaType)return J&&J(ResourceStrings.l_Audio),this.la.kQ?String.format(ResourceStrings.l_AccMessageCanvasAudio,B.shapeName):String.format(B.get_alt()?ResourceStrings.l_AccMessageAudioAlt:ResourceStrings.l_AccMessageAudio,this.cT(B),B.get_alt());if(2===B.mediaType)return J&&J(ResourceStrings.l_Video),String.format(B.get_alt()?ResourceStrings.l_AccMessageVideoAlt:ResourceStrings.l_AccMessageVideo,
this.cT(B),B.get_alt())}return null}$bj(B,D,w,J=null){return B&&B.nr?(J&&J(ResourceStrings.l_Chart),String.format(B.get_alt()?ResourceStrings.l_AccMessageChartAlt:ResourceStrings.l_AccMessageChart,this.acj(B)||"",this.cT(B),B.get_alt())):null}zrj(B,D,w,J=null){return B&&B.Of?(J&&J(ResourceStrings.L_GroupObjects),v.a("GroupShapeAltTitleFixEnabled")?String.format(B.get_alt()?ResourceStrings.l_AccMessageShapeGroupAlt:ResourceStrings.l_AccMessageShapeGroup,B.yx().length,B.get_alt()):String.format(B.get_alt()?
ResourceStrings.l_AccMessageShapeGroupAlt:ResourceStrings.l_AccMessageShapeGroup,this.cT(B),B.get_alt())):null}vrj(B,D,w,J=null){if(B&&w&&B.Pla&&!B.Hx)if(this.zXc(B,w),D=this.Ga.Yag(B),B.SFa&&(D=ResourceStrings.l_DecorativeLabel),J&&J(D||ResourceStrings.l_TextShape),0<w.count)B=String.format(B.get_alt()?ResourceStrings.l_AccMessageShapeHasTextAlt:ResourceStrings.l_AccMessageShapeHasText,D||ResourceStrings.l_TextShape,this.cT(B),B.get_alt()),w.insert(0,document.createTextNode(B));else return String.format(B.get_alt()?
ResourceStrings.l_AccMessageShapeNoTextAlt:ResourceStrings.l_AccMessageShapeNoText,D||ResourceStrings.l_TextShape,this.cT(B),B.get_alt());return null}N$i(B,D,w,J=null){return B&&B.Jq&&this.Gd&&this.KF?(B=this.KF.z3(B),B=this.Gd.Jxb(B.id),J&&J(B?B.Oca:null),B?B.Oca:null):null}r$i(B,D,w,J=null){return B&&B.r4?(J&&J(ResourceStrings.l_3DModel),String.format(B.get_alt()?ResourceStrings.l_AccMessage3DAlt:ResourceStrings.l_AccMessage3D,this.cT(B),B.get_alt())):null}rbg(B){return B.smartArtInfo?x.Nce(B.smartArtInfo.SmartArtLayout,
1,177,"L_SAType"):(h.ULS.sendTraceTag(509092052,815,10,"SmartArt {0}#{1} has no SmartArtInfo",B.slideId?B.slideId.toString():"",B.get_shapeId()),null)}acj(B){return x.Nce(B.Jub,0,102,"L_ChartType")}Lrj(B,D){return(B=this.Ga.QWc(B))&&D?String.format(ResourceStrings.l_RevisionTracking_ShapeHasUnreadChanges,D,B):null}static Zuj(B){return x.Nce(B,1,177,"L_SAType")}static Nce(B,D,w,J){return B>=D&&B<=w&&(B=ResourceStrings[J+B])?B:null}}Object(K.a)(x,"AriaMessageHelper",null,[862])},939:function(K,U,d){d.d(U,
"a",function(){return h});K=d(0);class h{static ail(){}static dRi(){}}h.sendTraceTag=h.ail;h.debugAssertTag=h.dRi;Object(K.a)(h,"BULS",null,[])},940:function(K,U,d){d.d(U,"a",function(){return n});K=d(0);var h=d(1040),e=d(27),r=d(172),m=d(56);class n{constructor(z,v,x,B,D,w){this.oca=z;this.pca=v;this.kGd=x;this.HP=B;this.iAc=D;this.mob=w}get gCh(){return!this.pca&&!this.kGd}get R6g(){return 2===this.mob?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get hYf(){return CommonUIStrings.l_OICErrorMessageNoOffice}get pig(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get aVa(){return CommonUIStrings.l_OICErrorHelpLink}get lhg(){return"OICFailure"}get icon(){return 3}get nwf(){return 2===
this.mob?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get gka(){return CommonUIStrings.l_DefaultDialogTitle}y_k(z){this.a7g(z)}H8j(z){this.a7g(z)}a7g(z){let v=10;1===z?(m.a.instance.resolve("Common.IOfficeTrialExperience").xre(this.mob),v=3):2===z&&((!this.kGd||this.kGd(this.HP))&&this.pca&&h.a.instance.QMi(this.pca,this.oca,this.HP),v=5);(0===z||1===z)&&this.oca&&this.oca(this.HP);e.AFrameworkApplication.nkb(r.a.Nch,this.iAc,v);this.dispose()}dispose(){this.HP=
this.pca=this.oca=null}}Object(K.a)(n,"AOICErrorDialogWithTrial",null,[107])},941:function(K,U,d){d.d(U,"b",function(){return m});d.d(U,"g",function(){return n});d.d(U,"d",function(){return z});d.d(U,"f",function(){return x});d.d(U,"e",function(){return B});d.d(U,"c",function(){return D});d.d(U,"a",function(){return w});var h=d(27);d(730);var e=d(1149),r=d(533);d(477);const m=()=>h.AFrameworkApplication.isEmbedded,n=()=>{const J=h.AFrameworkApplication.Aa.ob.mO;return!m()&&!h.AFrameworkApplication.hideHeader&&
r.a()&&(J||1===h.AFrameworkApplication.o8i)},z=()=>h.AFrameworkApplication.fa.ka("DiscoverPremiumButtonEnabled"),v=()=>h.AFrameworkApplication.fBh&&!m()&&!h.AFrameworkApplication.hideHeader,x=()=>v()&&"officecomhwa"!==(h.AFrameworkApplication.fa.Ha(h.AFrameworkApplication.wK)||"").toLowerCase()&&!h.AFrameworkApplication.qhg,B=()=>!h.AFrameworkApplication.rge&&v(),D=()=>!m()&&!h.AFrameworkApplication.hideHeader&&h.AFrameworkApplication.fa.ka("BasicChatIsEnabled"),w=()=>{if(h.AFrameworkApplication.Lhg)return null;
var J=!!h.AFrameworkApplication.Aa&&h.AFrameworkApplication.Aa.ob.mO;if((h.AFrameworkApplication.rpe&&h.AFrameworkApplication.C0a||h.AFrameworkApplication.mxc)&&J)return Object.assign(new e.a,{command:"1197060601",label:CommonUIStrings.l_ReplyWithChanges,id:d(265).CuiHelper.zpd});if(h.AFrameworkApplication.workflowEnabled){J="";switch(h.AFrameworkApplication.Ixc){case "Assign":J=CommonUIStrings.l_Assign;break;case "Submit":J=CommonUIStrings.l_Submit}if(""!==J)return Object.assign(new e.a,{command:"2988588587",
label:J,id:"btnWorkflow"})}return null}},942:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}Object(K.a)(h,"RibbonPeripheralSection",null,[])},943:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(e){this.alt=this.ariaLabel=this.src=null;this.src=e}}Object(K.a)(h,"ImageProps",null,[])},944:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.onFullRenderComplete=this.useCoachmark=this.jumpToCalloutTargetButtonEnabled=this.hasDynamicSizing=
this.preventLightDismiss=this.useTeachingStyles=this.hasFocusableControls=this.calloutProps=this.showCloseIcon=this.secondaryButtonProps=this.primaryButtonProps=this.title=this.content=this.target=null}}Object(K.a)(h,"CalloutParameters",null,[])},945:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}Object(K.a)(h,"ICalloutProps",null,[])},946:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}h.IsFreeForm="IsFreeForm";h.Value="Value";h.Key="Key";h.FontStyle="FontStyle";
Object(K.a)(h,"ComboBoxCommandProperties",null,[])},947:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}h.Alt="Alt";h.CommandValueId="CommandValueId";h.InnerHTML="InnerHTML";h.On="On";h.IsRtl="IsRtl";h.GalleryButtonProps="GalleryButtonProps";h.Text="Text";h.HighlightOn="HighlightOn";Object(K.a)(h,"GalleryButtonCommandProperties",null,[])},948:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);d=d(241);class h extends d.a{constructor(){super();this.OnRetryCommandId=this.RetryButtonTitle=
this.AriaDescription=this.IconName=this.Label=null}get ControlType(){return 12}}Object(K.a)(h,"ErrorViewProps",d.a,[])},949:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);d=d(241);class h extends d.a{constructor(){super();this.CommandValueId=this.ActionCommandValueId=this.ActionText=this.ActionId=this.Details=this.Links=this.Description=this.SecondaryLabel=this.Label=this.iconSet=this.ActionCommandId=this.CommandId=null}get ControlType(){return 13}}Object(K.a)(h,"MultiActionButtonProps",d.a,
[])},950:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}Object(K.a)(h,"PersonaInfo",null,[])},951:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}Object(K.a)(h,"PersonaIdentifiers",null,[])},952:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(e){this.Tm=e}c9d(e){const r=[];if(e)for(let z in e){var m=z,n=e[z];const v=this.Tm.H$d(m);if(v)for(let x of v)r.push(appChrome.actions.updateControlHiddenState(x,n));else if(m=this.Tm.dij(m))for(const x of m)if(x.externalUxCommandIds)for(const B of x.externalUxCommandIds)r.push(appChrome.actions.updateControlHiddenState(B,
n));else r.push(appChrome.actions.updateGroupHiddenState(x.externalUxGroupId,n))}return r}D$i(e){const r=[];if(e)for(let m in e){if(!e[m])continue;const n=m;n&&r.push(appChrome.actions.deactivateRibbonTab(n))}return r}}Object(K.a)(h,"ReactRibbonTrimmingHelper",null,[])},953:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(K.a)(h,"InsightsParameters",null,[])},954:function(K,U,d){d.d(U,"a",function(){return h});
K=d(0);class h{}h.mRf="data-ccp-timestamp";h.nRf="data-clipservice-ccpid";h.rRf="data-shapeids";h.Vdg="docs-internal-guid-";h.xch="SCXO";h.Igh="SCXP";h.PQh="SCXW";h.g5g="MsoListParagraphCxSpFirst";h.h5g="MsoListParagraphCxSpLast";Object(K.a)(h,"HtmlContentMetadataConstants",null,[])},955:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e){super();this.slideId=e.SlideId;this.slideIndex=e.SlideIndex;this.mTj=e.IsBeforeReady;this.mXj=e.IsFromEndOfSlideshow;
this.summary=e.Summary}}Object(K.a)(h,"OnExitSlideshowEventArgs",Sys.EventArgs,[])},956:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e){super();this.key=e.Key;this.shiftKey=e.ShiftKey}}Object(K.a)(h,"OnSpecialKeyEventArgs",Sys.EventArgs,[])},957:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e){super();this.clientX=e.ClientX;this.clientY=e.ClientY}}Object(K.a)(h,"OnBrowserEventArgs",Sys.EventArgs,
[])},958:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e){super();this.slideId=e.SlideId;this.slideIndex=e.SlideIndex;this.$vc=e.TimeLineMappings}}Object(K.a)(h,"OnGetCurrentPositionEventArgs",Sys.EventArgs,[])},959:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e){super();this.slideHeight=e.SlideHeight;this.slideWidth=e.SlideWidth;this.wDh=e.SlideLeftBound;this.sDh=e.SlideBottomBound}}Object(K.a)(h,
"OnGetCurrentSlideDimensionsEventArgs",Sys.EventArgs,[])},960:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e){super();this.clientX=e.ClientX;this.clientY=e.ClientY}}Object(K.a)(h,"OnSlideshowContextMenuEventArgs",Sys.EventArgs,[])},961:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e){super();this.isVisible=e.IsVisible}}Object(K.a)(h,"OnVisibilityChangeEventArgs",Sys.EventArgs,[])},962:function(K,
U,d){d.d(U,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e){super();this.code=e.Code;this.reason=e.Reason;this.podSessionId=e.PodSessionId}}Object(K.a)(h,"OnPodSessionExpiredEventArgs",Sys.EventArgs,[])},963:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e){super();this.slideId=e.SlideId;this.slideIndex=e.SlideIndex;this.$vc=e.TimeLineMappings}}Object(K.a)(h,"OnPositionChangedEventArgs",Sys.EventArgs,[])},964:function(K,
U,d){d.d(U,"a",function(){return e});K=d(0);var h=d(1244);class e extends Sys.EventArgs{constructor(r){super();this.uJh=null;this.uJh="string"===typeof r?Object(h.a)(String,r):r.TranscriberSessionId}}Object(K.a)(e,"OnTranscriberStartedEventArgs",Sys.EventArgs,[])},965:function(K,U,d){d.d(U,"a",function(){return x});K=d(0);var h=d(392),e=d(269),r=d(27),m=d(185),n=d(55),z=d(47),v=d(227);class x{static Ibg(B){const D={};D.appSettings=x.FJi();D.singleSignOnSettings=x.ebg();D.appVersion="16";D.appUILocale=
e.a.He(r.AFrameworkApplication.lcid).sxb;D.dataLocale=e.a.He(r.AFrameworkApplication.lcid).sxb;D.osfOmexBaseUrl=r.AFrameworkApplication.fa.Ha("50");D.firstPartyManifestCDNUrl=r.AFrameworkApplication.fa.Ha("565");D.sdxCdnUrl=r.AFrameworkApplication.fa.Ha("649");D.sdxDmsUrl=r.AFrameworkApplication.fa.Ha("650");D.sdxAssetsToPrefetchMapping=r.AFrameworkApplication.fa.Ha("974");D.docUrl=B?B.documentUrl:"";D.pageBaseUrl=m.a.vP;D.lcid=r.AFrameworkApplication.lcid.toString();D.allowExternalMarketplace=r.AFrameworkApplication.fa.ka("51");
D.localizedScriptsUrl=(r.AFrameworkApplication.K$e?r.AFrameworkApplication.fa.Ha("StaticContentHostNonOverriden"):m.a.vP)+r.AFrameworkApplication.fa.Ha("52");B=B?B.Mig:"";D.localizedImagesUrl=m.a.vP+B;D.localizedStylesUrl=m.a.vP+B;D.localizedResourcesUrl=m.a.Z$h(B);D.enableAddinCommands=r.AFrameworkApplication.fa.ka("203");D.enableMyApps=r.AFrameworkApplication.fa.ka("186");r.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:7715436_ppto_enableMyOrg")?D.enableMyOrg=r.AFrameworkApplication.fa.ka("InsertAgaveMyOrgEnabledForHost"):
D.enableMyOrg=r.AFrameworkApplication.fa.ka("187");D.enableUploadFileDevCatalog=r.AFrameworkApplication.fa.ka("203")&&!r.AFrameworkApplication.fa.ka("847");D.enableDevCatalog=r.AFrameworkApplication.fa.ka("221");D.devCatalogUrl=r.AFrameworkApplication.fa.Ha("220");D.enablePrivateCatalog=r.AFrameworkApplication.fa.ka("305");D.showSignOutFromPrivateCatalogMessage=r.AFrameworkApplication.fa.ka("307");D.enableBlackForestRedirect=r.AFrameworkApplication.fa.ka("348");D.enableSingleSignOnForAddin=r.AFrameworkApplication.fa.ka("342")&&
r.AFrameworkApplication.OSj;D.enableTaskpaneUpgradeToAppCommand=r.AFrameworkApplication.fa.ka("381");D.hideAppsExtensionUrl=r.AFrameworkApplication.hideAppsExtensionUrl;D.enableAnonymousUseLegacyCatalogService=r.AFrameworkApplication.fa.ka("549");D.enableInsertDialogAccessibilityFix=r.AFrameworkApplication.fa.ka("584");D.enableFirstPartySDXErrorMessages=r.AFrameworkApplication.fa.ka("677");D.disableAppsForOfficeThirdParty=r.AFrameworkApplication.fa.ka("569");D.wacSessionId=r.AFrameworkApplication.userSessionId;
D.disableLogging=!r.AFrameworkApplication.fa.ka("AriaLoggingIsEnabled");D.loggableUserId=r.AFrameworkApplication.fa.Ha("LoggableUserId");D.sessionStartInfoJson=r.AFrameworkApplication.fa.Ha("SessionStartInfoJson");D.wopiHostOriginFromPostMessage=r.AFrameworkApplication.wopiHostOriginFromPostMessage;D.wopiHostOriginFromWacPropBag=r.AFrameworkApplication.fa.Ha("PostMessageOrigin");D.wacIsEmbedded=r.AFrameworkApplication.fa.ka("IsEmbedded");D.accessibilityAllowFocusAddinTaskpane=r.AFrameworkApplication.fa.ka("1055");
D.disableMicrophonePermission=n.a.oO(1)&&r.AFrameworkApplication.fa.ka("TranscriberSafariEnabled")&&r.AFrameworkApplication.fa.ka("RehearsalSafariEnabled");D.isHostFrameTrustCheckEnabledForAddIns=r.AFrameworkApplication.fa.ka("1100");D.isHostFrameTrusted=r.AFrameworkApplication.isHostFrameTrusted;D.hostAllowedSdxEmbedding=r.AFrameworkApplication.fa.ka("HostAllowedSdxEmbedding");D.hostAllowedOfficeStore=r.AFrameworkApplication.fa.ka("HostAllowedOfficeStore");D.hostInstallAddIns=r.AFrameworkApplication.fa.Ha("HostInstallAddIns");
D.hostInstallAddInsIsEnabled=r.AFrameworkApplication.fa.ka("HostInstallAddInsIsEnabled");D.approvedAddIns=r.AFrameworkApplication.fa.Ha("ApprovedAddIns");D.isUpnCheckEnabled=r.AFrameworkApplication.fa.ka("1132");D.wacUpn=r.AFrameworkApplication.fa.Ha("UserPrincipalName");D.isReactRibbonEnabled=!0;D.enableSetFocusOnTaskpaneOnUserAction=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);D.enableMyOrg&&D.docUrl&&(B=D.docUrl.split("/"),
D.spBaseUrl=2<B.length?B[0]+"//"+B[2]:null,D.spBaseUrl||h.ULS.sendTraceTag(512263002,806,10,String.format("Failed to parse SpBaseUrl from DocUrl: {0}",D.docUrl)));D.userNameHashCode=z.a.iL(r.AFrameworkApplication.userName);D.envCode=r.AFrameworkApplication.fa.wc("312",0).toString();return D}static FJi(){const B={};B.AddinRibbonIdAllowUnknown=r.AFrameworkApplication.fa.ka("AddinRibbonIdAllowUnknown");B.AddinRibbonNativeGroupControlIsEnabled=!0;B.AddinRibbonTabAutoFocusIsEnabled=!0;B.AddinRibbonTabPositionIsEnabled=
!0;B.AgaveAddinUploadEnabled=r.AFrameworkApplication.fa.ka("AgaveAddinUploadEnabled");B.DevConsoleEnabled=r.AFrameworkApplication.fa.ka("AddinDevConsoleLog");B.ManifestParserDevConsoleEnabled=!0;B.flightingTreatmentVariables=r.AFrameworkApplication.fa.$Sc;B.DisabledChangeGates=r.AFrameworkApplication.fa.Ha("DisabledChangeGates");B.DmsSdxListPresentation=r.AFrameworkApplication.GUf;return B}static ebg(){try{const B={};n.a.xGa&&v.OAuthManagerSettings.lbb&&(B.UiHostSupportsAuthTokenAddinList=x.WSc);
B.UiHostSupportsAuthToken=v.OAuthManagerSettings.lbb;return B}catch(B){h.ULS.sendTraceTag(512263001,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",B.message)}return null}}x.WSc="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");Object(K.a)(x,"AppForOfficeHelper",null,[])},966:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e){super();
this.D5g=e}}Object(K.a)(h,"CoauthorStatusChangedEventArgs",Sys.EventArgs,[])},967:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(e,r,m){this.CZa={};this.ybd=e;this.q$c=r;this.Kgc=m}oua(e,r,m){let n=h.RRf;if(this.q$c)if(this.Kgc){const z=e.UserId?e.UserId.toLowerCase():null;r=r?r.toLowerCase():null;n=z&&z in this.CZa?this.CZa[z]:r&&r in this.CZa?this.CZa[r]:this.ybd.oua(e,m);!z||z in this.CZa||(this.CZa[z]=n);!r||r in this.CZa||(this.CZa[r]=n)}else n=this.ybd.oua(e,m);return n}}
h.RRf="#C0C0C0";Object(K.a)(h,"PresenceColorProvider",null,[423])},968:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e){super();this.GD=e}}Object(K.a)(h,"BeforeSessionEndEventArgs",Sys.EventArgs,[])},969:function(K,U,d){d.d(U,"a",function(){return n});K=d(0);var h=d(1191),e=d(27),r=d(36),m=d(81);class n{constructor(){this.BaseDocQuerySignature=null;this.RoamingApp=0}kNb(){return r.c([this.pl(),this])}execute(z,v,x){let B="RoamingAppsHandler.ashx";
h.a.instance.tXe&&0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(B=m.a.Ti(B,"wdEnableRoaming","1"));e.AFrameworkApplication.Me.zj(B,2,this.kNb(),{"Content-Type":"application/json; charset=utf-8"},!1,this.Kyb(),z,v,x,void 0,void 0,void 0,void 0,"6")}}Object(K.a)(n,"ARoamingAppsRequest",null,[])},970:function(K,U,d){d.d(U,"a",function(){return 2});d.d(U,"c",function(){return h});d.d(U,"b",function(){return e});const h=(r,m,n=2)=>{let z;if(0>m||m>r[r.length-1])throw Error.argumentOutOfRange("y");
z=!0;let v=0,x;const B=r.length-1;for(x=0;x<B;x++){const D=v;v=r[x+1];if(m<v){v-m<n&&x<B-1?x++:m-D>=n&&(z=!1);break}}return{returnValue:x<B?x:-1,Joe:z}},e=(r,m,n=2)=>{let z;if(0>m||m>r[r.length-1])throw Error.argumentOutOfRange("x");z=!0;let v=0,x;const B=r.length-1;for(x=0;x<B;x++){const D=v;v=r[x+1];if(m<v){v-m<n&&x<B-1?x++:m-D>=n&&(z=!1);break}}return{returnValue:x<B?x:-1,Joe:z}}},971:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.TRa=this.DW=0;this.skipUndo=
!1;this.Jp=this.selectionSlide=null;this.version=0;this.QD=this.location=null;this.dataType=0;this.fmc=null;this.objectCount=0;this.UFa=this.WFa=!1;this.Ky=this.rta=this.nodes=null}toString(){const e=JSON.stringify(this.rta);return String.format("CcpId:{0}, version:{1}, DC:{2}, DataType:{3}, ObjectCount:{4}, Cut?:{5}, IsEPH?:{6}, ExtraData:[{7}], CopyStatus: {8}.",this.Jp,this.version,this.QD,this.dataType,this.objectCount,this.WFa,this.UFa,e,this.DW)}}Object(K.a)(h,"ClipServiceObject",null,[])},
972:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(e,r){this.Ku=e;this.Wb=r}}Object(K.a)(h,"ClipServiceCopyParams",null,[])},973:function(K,U,d){d.d(U,"a",function(){return n});K=d(0);var h=d(392),e=d(99);U=d(1162);var r=d.n(U),m=d(382);class n{static qsd(z,v,x){if(z&&x&&(e.a.$Ca(z),v&&""!==v))try{m.a("HtmlStringSanitizeByDomPurify")&&(v=r.a.sanitize(v));const B=n.uXh.parseFromString(v,"text/html");if(B&&B.body){const D=B.body.childNodes;for(v=0;v<D.length;v+=1)z.appendChild(D[v].cloneNode(!0))}}catch(B){h.ULS.sendTraceTag(523106530,
324,10,"In class: {0}, unable to parse HTML, {1}",x,B.message)}}}n.uXh=new DOMParser;Object(K.a)(n,"DOMParserHelper",null,[])},974:function(K,U,d){d.d(U,"a",function(){return n});K=d(0);var h=d(7),e=d(78),r=d(67),m=d(139);class n extends Sys.UI.Control{constructor(z,v,x,B){super(document.createElement("div"));this.r7=this.p7=this.rF=this.W3a=this.DS=this.NNa=this.BPa=null;this.MUb=this.BOa=!1;this.content=this.yC=null;this.Hba=0;this.kEf=null;this.h_=0;this.Pjd=null;this.guf=z;this.Oqb=v;this.UP=
x;this.vZd=B;this.oi=v.ownerDocument;this.S9b=this.Ir=this.rVb=!1}get bK(){this.BPa||(this.BPa=this.oi.createElement("div"),this.BPa.id=this.Uh("WACCalloutOuter"),this.BPa.className="WACCalloutOuter",this.BPa.setAttribute(m.a.hf,m.a.qVd),this.BPa.style.width=this.Hba+"px");return this.BPa}get Ftb(){if(!this.NNa){this.NNa=this.oi.createElement("div");this.NNa.id=this.Uh("WACCalloutBeakContainer");this.NNa.className="WACCalloutBeakContainer";var z="CalloutBeakTopFilled_32x16x32";if(5===this.h_||6===
this.h_||4===this.h_)z="CalloutBeakBottomFilled_32x16x32";z=e.createClusteredImage(32,16,z,"WACCalloutBeak",!0,"");this.NNa.appendChild(z)}return this.NNa}set Ftb(z){this.NNa=z}get TL(){return this.rVb}get title(){return this.yC}set title(z){this.yC!==z&&(this.yC=z,this.p7&&(this.p7.innerText=this.yC))}get Ir(){return this.BOa}set Ir(z){this.BOa!==z&&(this.BOa=z,this.DS&&(this.DS.contains(this.rF)&&!this.BOa?this.DS.removeChild(this.rF):!this.DS.contains(this.rF)&&this.BOa&&this.Ywf()))}get S9b(){return this.MUb}set S9b(z){this.MUb!==
z&&(this.MUb=z,this.DS&&(this.DS.contains(this.p7)&&!this.MUb?this.DS.removeChild(this.p7):!this.DS.contains(this.p7)&&this.MUb&&this.yyf()))}show(){this.rVb||(this.MKi(),this.Qni(),this.Oqb.appendChild(this.bK),this.bK.style.display="Block",this.J_e(),this.rVb=!0,this.Pjd&&this.Pjd())}dismiss(){this.rVb&&(this.tTi(),this.Oqb.removeChild(this.bK),this.rVb=!1,this.vZd&&this.vZd())}dispose(){this.dismiss();this.p7=this.rF=this.W3a=this.NNa=this.DS=this.BPa=null;Sys.Component.prototype.dispose.call(this)}Uh(z){return this.get_element().id+
z}MKi(){this.DS=this.oi.createElement("div");this.DS.id=this.Uh("WACCalloutHeader");this.DS.className="WACCalloutHeader";this.Ir&&this.Ywf();this.S9b&&this.yyf();this.W3a=this.oi.createElement("div");this.W3a.id=this.Uh("WACCalloutContent");this.W3a.className="WACCalloutContent";this.W3a.style.width=190<this.Hba?this.Hba-26+"px":"164px";this.W3a.appendChild(this.content);this.bK.appendChild(this.Ftb);this.bK.appendChild(this.DS);this.bK.appendChild(this.W3a)}Ywf(){this.rF=this.oi.createElement("a");
this.rF.className="WACCalloutCloseAnchor";this.rF.id=this.Uh("WACCalloutCloseAnchor");this.rF.href="#";this.DS.appendChild(this.rF);const z=e.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.rF.appendChild(z)}yyf(){this.p7=this.oi.createElement("div");this.p7.className="WACCalloutTitle UIFontBold";this.p7.style.width=190<this.Hba?this.Hba-30+"px":"160px";this.p7.id=this.Uh("WACCalloutTitle");this.p7.innerText=this.title;this.DS.contains(this.rF)?
this.DS.insertBefore(this.p7,this.rF):this.DS.appendChild(this.p7)}J_e(){var z=this.guf;let v;if(1===this.h_){var x=this.kEf.y+16;v=-16}else 2===this.h_||3===this.h_||0===this.h_?(x=z.y+z.height+15,v=-15):(x=z.y-this.bK.clientHeight-15-2,v=this.bK.clientHeight-1);this.bK.style.top=x+"px";this.Ftb.style.top=v+"px";1===this.h_?(z=this.kEf.x-16,this.bK.style.left="50%",this.bK.style.marginLeft=-this.Hba/2+"px",x=Sys.UI.DomElement.getBounds(this.bK),this.Ftb.style.left=z-x.x+"px"):(x=z.x+this.guf.width/
2,2===this.h_||5===this.h_?(z=20,x-=36):0===this.h_||4===this.h_?(z=this.Hba/2-16,x-=this.Hba/2):(z=this.Hba-20-32,x=x-this.Hba+36),this.bK.style.left=x+"px",this.Ftb.style.left=z+"px")}Qni(){this.Ir&&!this.r7&&(this.r7=Object(h.a)(this,this.u3,"closeHandler"),this.UP.rb(r.a.click,this.rF,this.r7,null))}tTi(){this.Ir&&this.r7&&(this.UP.Bb(r.a.click,this.rF,this.r7),this.r7=null)}u3(){this.dismiss();return!0}}Object(K.a)(n,"Callout",Sys.UI.Control,[813])},975:function(K,U,d){d.d(U,"a",function(){return M});
var h=d(152);K=d(0);var e=d(34),r=d(40),m=d(32),n=d(91),z=d(187),v=d(51),x=d(39),B=d(727),D=d(1037),w=d(280),J=d(690),G=d(339);class M{constructor(N,R,C,O,S,T,ca,L){this.kU=N;this.pa=R;this.vi=C;this.xwa=O;this.Ga=S;this.IJ=T;this.BJ=ca;this.rIa=L;this.select=({scope:da,text:Z,index:fa})=>Object(h.a)(this,void 0,void 0,function*(){var aa=[];let ja=[];var I=null!==da&&void 0!==da?da:"Selection";if("Selection"===I){var sa=this.pa.Pa.mb;sa?(sa=sa.toArray().filter(ka=>e.ParagraphReader.ae(ka.node)),0<
sa.length?aa.push(...sa):(sa=this.pa.Xd(),0<sa.length&&this.rIa.HYe(12,sa,aa))):this.rIa.UMb(12,this.pa.Se(),aa);0!==aa.length||da||(I="Presentation")}if(Array.isArray(I)&&0<I.length&&I[0]instanceof w.a)this.rIa.UMb(12,I,aa);else if(Array.isArray(I)&&0<I.length&&I[0]instanceof D.a)this.rIa.HYe(12,I,aa);else if("Presentation"===I&&this.Oc){I=this.Oc.aO.presentation.slides;if(null===I)throw Error("Could not cast from ISlide to ISlide on presentation slides.");this.rIa.UMb(12,I,aa)}if(Z)for(const ka of aa){aa=
e.ParagraphReader.text(ka.node);aa=this.matchAll(aa,Z);for(const Ma of aa)Ma[0]&&void 0!==Ma.index&&(aa=Ma.index,I=Ma.index+Ma[0].length,sa=v.a.Lj(ka.node,aa),this.BJ.r3e(sa),sa=v.a.Lj(ka.node,I+1),this.BJ.r3e(sa),ja.push(v.a.createTextRange(ka.node,aa,I)))}else ja=aa;if("number"===typeof fa){0>fa&&(fa=ja.length+fa);if(0<=fa&&fa<ja.length)return[ja[fa]];throw Error.argumentOutOfRange("index");}return ja});this.wjl=(da,Z)=>{const fa=new m.GraphIterator;fa.set(da);fa.sc(11);fa.Kg(11);da=da.Uf.Gv(fa);
const aa=Z?1:16;Z=Z?1:0;da?da.gza(aa,Z):(Z=z.a.NN(aa,Z),this.IJ.UQa(fa,Z))};this.lll=(da,Z)=>{switch(Z){case "Left":Z=1;break;case "Center":Z=2;break;case "Right":Z=3;break;case "Distributed":Z=7;break;case "Justify":Z=6;break;default:Z=1}this.xwa.nK(da,Z)};this.Epl=(da,Z)=>{if(da=this.Ga.vn(da)){switch(Z){case "Top":Z=0;break;case "Middle":Z=1;break;case "Bottom":Z=2;break;default:Z=0}da.setValue(x.a.xP,Z)}};this.format=({textRanges:da,color:Z,bold:fa,italic:aa,underline:ja,fontName:I,size:sa,bulleted:ka,
horizontalAlignment:Ma,verticalAlignment:Ea})=>Object(h.a)(this,void 0,void 0,function*(){if(!da)throw Error.argumentNull("textRanges");const ma=[];if(da&&0<da.length){for(const Ca of da){var va=[];if(Ca.contextId===r.a.paragraph){const oa=n.a.I3f(Ca.node,!1);for(const Da of oa)va.push(Da.formatting)}else va.push(n.a.Bs(Ca));for(const oa of va)oa&&(Z&&(va=J.a.MRa(Z),Z=""===va?Z:va,this.vi.sr(oa,Z,null)),void 0!==fa&&this.vi.$H(oa,fa),void 0!==aa&&this.vi.setItalic(oa,aa),ja&&this.vi.VY(oa,"None"!==
ja),I&&this.vi.jV(oa,I),void 0!==sa&&this.vi.Xq(oa,2*sa),void 0!==ka&&this.wjl(Ca.node,ka),Ma&&this.lll(Ca.node,Ma),Ea&&this.Epl(Ca.node,Ea));ma.push(new Promise(oa=>G.a.k9(oa,Ca.node).bind(this)))}yield Promise.all(ma)}});this.s$k=(da,Z)=>Object(h.a)(this,void 0,void 0,function*(){const fa=(new DOMParser).parseFromString(Z,"text/html");if(0<fa.body.innerHTML.trim().length)return da.jMb=fa.body.innerHTML.trim(),new Promise(aa=>G.a.k9(aa,da).bind(this))});this.insert=({precededBy:da,text:Z})=>Object(h.a)(this,
void 0,void 0,function*(){if(!da)throw Error.argumentNull("precededBy");const fa=[];for(var aa of da){var ja=aa.node,I=-1===aa.Mb?ja.characterData.length:aa.Mb+1;I=aa.contextId===r.a.Mf?aa:v.a.Lj(ja,I);this.BJ.replaceTextRange(I,Z,!0);ja=v.a.createTextRange(ja,aa.Mb+1,aa.Mb+Z.length);fa.push(ja)}aa=[];for(const sa of fa)aa.push(new Promise(ka=>G.a.k9(ka,sa).bind(this)));return Promise.all(aa)});this.delete=({textRanges:da})=>Object(h.a)(this,void 0,void 0,function*(){if(!da)throw Error.argumentNull("textRanges");
let Z=[];const fa=[];for(let aa of da){aa.node instanceof B.a&&aa.contextId!==r.a.textRange&&(aa=v.a.createTextRange(aa.node,0,aa.node.characterData.length));this.BJ.replaceTextRange(aa,"",!0);const ja=v.a.Lj(aa.node,aa.Sa);Z.push(ja);fa.push(new Promise(I=>G.a.k9(I,aa.node).bind(this)))}yield Promise.all(fa);return 0===Z.length?[]:[Z[0]]});if(!N)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!R)throw Error.argumentNull("m_selectionManager");if(!C)throw Error.argumentNull("m_formattingEditor");
if(!O)throw Error.argumentNull("m_paragraphEditor");if(!S)throw Error.argumentNull("m_shapeReader");if(!T)throw Error.argumentNull("m_listEditor");if(!ca)throw Error.argumentNull("m_characterPropertiesEditor");if(!L)throw Error.argumentNull("m_odslGraphUtils");this.kU&&this.kU.execute(da=>{this.Oc=da})}matchAll(N,R){R=R instanceof RegExp?R:new RegExp(R,"g");const C=[];let O;for(;null!==(O=R.exec(N));)C.push(O);return C}}Object(K.a)(M,"ODSLText",null,[464])},976:function(K,U,d){d.d(U,"a",function(){return S});
var h=d(152);K=d(0);var e=d(589),r=d(1252),m=d(1278),n=d(56),z=d(1244),v=d(280),x=d(62),B=d(58),D=d(398),w=d(691),J=d(43),G=d(104),M=d(1055),N=d(692),R=d(232),C=d(690),O=d(339);class S{constructor(T,ca,L,da,Z,fa,aa,ja,I,sa,ka){this.kU=T;this.pa=ca;this.hj=L;this.bZa=da;this.XXa=Z;this.Ga=fa;this.xk=aa;this.wi=ja;this.Gb=I;this.qr=sa;this.Rq=ka;this.yFb=this.jIa=0;this.PYe=(Ma,Ea)=>{for(let ma of Ma)Ea.push(...ma.Uj())};this.select=({scope:Ma,name:Ea,index:ma=-1})=>Object(h.a)(this,void 0,void 0,function*(){const va=
[],Ca=[];var oa=null!==Ma&&void 0!==Ma?Ma:"Selection";if("Selection"===oa){const Da=this.pa.Xd();0<Da.length?va.push(...Da):this.PYe(this.pa.Se(),va);0!==va.length||Ma||(oa="Presentation")}if("Presentation"===oa&&this.Oc){oa=this.Oc.aO.presentation.slides;if(null===oa)throw Error("Could not cast from ISlide to ISlide on presentation slides.");this.PYe(oa,va)}else Array.isArray(oa)&&0<oa.length&&oa[0]instanceof v.a&&this.PYe(oa,va);if(Ea)for(const Da of va)Da.shapeName===Ea&&Ca.push(Da);else Ca.push(...va);
if("number"===typeof ma){0>ma&&(ma=Ca.length+ma);if(0<=ma&&ma<Ca.length)return[Ca[ma]];throw Error.argumentOutOfRange("index");}return Ca});this.format=({shapes:Ma,left:Ea,top:ma,height:va,width:Ca,lineColor:oa,lineDashStyle:Da,lineWeight:ta,lineTransparency:ha,fillColor:Ha,fillTransparency:bb})=>Object(h.a)(this,void 0,void 0,function*(){if(!Ma)throw Error.argumentNull("shapes");if(Ma&&0<Ma.length){const Ia=[];for(const Qa of Ma){void 0!==Ea&&(Qa.Iy=Ea);void 0!==ma&&(Qa.Jy=ma);void 0!==va&&(Qa.jD=
va);void 0!==Ca&&(Qa.Ix=Ca);if(oa){var Na=C.a.MRa(oa);oa=""===Na?oa:Na;Na=R.a.parse(oa);Qa.ypa=JSON.stringify(Na)}if(Da)switch(Da){case "Dash":Qa.RM=0;break;case "DashDot":Qa.RM=1;break;case "DashDotDot":Qa.RM=2;break;case "LongDash":Qa.RM=3;break;case "LongDashDot":Qa.RM=4;break;case "RoundDot":Qa.RM=5;break;case "Solid":Qa.RM=6;break;case "SquareDot":Qa.RM=7;break;case "LongDashDotDot":Qa.RM=8;break;case "SystemDash":Qa.RM=9;break;case "SystemDot":Qa.RM=10;break;case "SystemDashDot":Qa.RM=11;break;
default:Qa.RM=6}void 0!==ta&&(Qa.outlineWidth=ta);void 0!==ha&&(Na=R.a.parse(Qa.ypa),Na.Alpha=100*ha,Qa.ypa=JSON.stringify(Na));Ha&&(Ha=""===C.a.MRa(Ha)?Ha:C.a.MRa(Ha),Na=R.a.parse(Ha),Qa.Lga=JSON.stringify(Na));void 0!==bb&&(Na=R.a.parse(Qa.Lga),Na.Alpha=100*bb,Qa.Lga=JSON.stringify(Na));Ia.push(new Promise(qa=>O.a.k9(qa,Qa).bind(this)))}yield Promise.all(Ia)}});this.insert=({slides:Ma,shapeType:Ea})=>{if(!Ma)throw Error.argumentNull("slides");if(!this.Oc)throw Error("Cannot insert shapes without appForOfficeManager instance.");
const ma=[];for(const Ha of Ma){Ma=Ha;if(!Ma)throw Error("Cannot find selected slide to insert shape.");const bb=Ma.Db;if(x.a.Cw(bb))throw Error("Cannot insert on fake slide node.");const Na=this.I$a(Ea);if(!Na)throw Error("Could not load props for shapeType.");if(!this.hj.iD(Ma,1))throw this.hj.KD(Ma),Error("Too many shapes on the slide.");const Ia=this.bZa.nJ;var va=Ma.Ed.HasDefaultShape,Ca=Ma.Ed.HasDefaultLine,oa=95===Na.Uga||97===Na.Uga||Array.contains(w.a.Hre,Na.Uga);Ca=Ca&&oa;va=va&&!oa;this.kha(0);
var Da=void 0;let Qa,qa;var ta=this.Oc.aO.presentation.slideWidth,ha=this.Oc.aO.presentation.slideHeight;Da=new B.a((ta-Na.width*e.a.zD)/2,(ha-Na.height*e.a.zD)/2);oa=Da.x+r.a.gf(this.AO*D.a.jT,m.a.horizontal);qa=Da.y+r.a.gf(this.AO*D.a.jT,m.a.vertical);Ia?(Da=Na.width*e.a.zD,Qa=Na.height*e.a.zD):(Da=r.a.gf(S.f1b,m.a.horizontal),Qa=r.a.gf(S.e1b,m.a.vertical),oa=ta/2-r.a.gf(S.f1b/2-this.AO*D.a.jT,m.a.horizontal),qa=ha/2-r.a.gf(S.e1b/2-this.AO*D.a.jT,m.a.vertical));this.AO++;this.AO>this.jIa&&(this.AO=
this.yFb);ta=Ma.zs();ha=Object(z.a)(340,this.Oc.aO.Ba.tg(this.Gb.Na));J.a.Kb&&(Ca||va)&&J.a.Kb.Wa(G.a.N6d,Ca?"HasDefaultLine":"HasDefaultShape");let Wa=null;Wa=!Ia||"TextBox"===Ea||va||Ca?this.xk.ADa(!1,bb.cid,bb.sid,0,Na.shapeType,oa,qa,Da,Qa,ta+1):w.a.LOc(bb,Na,ha.UT,null,new M.a,oa,qa,Da,Qa,ta,this.Ga,this.xk,this.Gb,this.Oc.aO,this.wi);this.qr.zT([Wa],Ma,null);this.Rq.lA=Wa;this.twc();ma.push(Wa)}Ea=[];for(const Ha of ma)Ea.push(new Promise(bb=>O.a.k9(bb,Ha).bind(this)));return Promise.all(Ea)};
this.delete=({shapes:Ma})=>Object(h.a)(this,void 0,void 0,function*(){if(!Ma)throw Error.argumentNull("shapes");for(const Ea of Ma)this.xk.gQc(Ea);return new Promise(Ea=>O.a.k9(Ea,this.Oc.aO.Ba).bind(this))});if(!T)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!ca)throw Error.argumentNull("m_selectionManager");if(!L)throw Error.argumentNull("m_shapeCountValidator");if(!da)throw Error.argumentNull("m_shapeSVGDependencyLoader");this.kU&&this.kU.execute(Ma=>{this.Oc=Ma});this.AO=0}kha(T){this.XXa.H6e(T)}twc(){const T=
n.a.instance.Ia("Common.ISystemInitiatedFeedback");T&&T.execute(ca=>{ca.logActivity("InsertShapeActivity",null)})}I$a(T){switch(T){case "Textbox":return new N.a(34,16,.5,3);case "Ellipse":return new N.a(34,9,1,1);case "Triangle":return new N.a(2,17,1,1.16);case "RightTriangle":return new N.a(3,55,1,1);case "Parallelogram":return new N.a(6,56,1,1.33);case "Trapezoid":return new N.a(7,57,1.33,1);case "Diamond":return new N.a(5,58,1,1);case "SPentagon":return new N.a(9,59,1,1.05);case "Hexagon":return new N.a(10,
60,1,1.16);case "Heptagon":return new N.a(11,61,1,1);case "Octagon":return new N.a(12,62,1,1);case "Decagon":return new N.a(13,63,1,1);case "Dodecagon":return new N.a(14,64,1,1);case "Pie":return new N.a(39,65,1,1);case "Chord":return new N.a(87,66,1,1);case "Teardrop":return new N.a(35,67,1,1);case "Frame":return new N.a(83,68,1,1);case "HalfFrame":return new N.a(84,69,1,1);case "LShape":return new N.a(85,70,1,1);case "DiagonalStripe":return new N.a(86,71,1,1);case "Cross":return new N.a(130,72,
1,1);case "Plaque":return new N.a(33,73,1,1);case "Can":return new N.a(73,7,1.33,1);case "Cube":return new N.a(72,8,1.33,1.33);case "Bevel":return new N.a(82,74,1.14,1.14);case "Donut":return new N.a(41,75,1,1);case "NoSymbol":return new N.a(42,76,1,1);case "BlockArc":return new N.a(40,77,1,1);case "FoldedCorner":return new N.a(81,78,1,1);case "SmileyFace":return new N.a(78,79,1,1);case "Heart":return new N.a(75,18,1,1);case "LightningBolt":return new N.a(74,80,1,1);case "Sun":return new N.a(76,81,
1,1);case "Moon":return new N.a(77,82,1,.5);case "Cloud":return new N.a(120,83,1,1);case "Arc":return new N.a(88,84,1,1);case "DoubleBracket":return new N.a(93,85,1,1);case "DoubleBrace":return new N.a(94,86,1,1.17);case "LeftBracket":return new N.a(89,87,1,.08);case "RightBracket":return new N.a(90,88,1,.08);case "LeftBrace":return new N.a(91,89,1,.17);case "RightBrace":return new N.a(92,90,1,.17);case "MathPlus":return new N.a(175,19,1,1);case "MathMinus":return new N.a(176,20,1,1);case "MathMultiply":return new N.a(177,
21,1,1);case "MathDivide":return new N.a(178,22,1,1);case "MathEqual":return new N.a(179,23,1,1);case "MathNotEqual":return new N.a(180,24,1,1);case "StraightConnector":return new N.a(95,12,1,1);case "StraightConnectorArrow":return new N.a(95,13,1,1);case "StraightConnectorTwoArrow":return new N.a(95,14,1,1);case "ElbowConnector":return new N.a(97,26,1,1);case "ElbowArrowConnector":return new N.a(97,155,1,1);case "ElbowDoubleArrowConnector":return new N.a(97,156,1,1);case "CurvedConnector":return new N.a(101,
25,1,1);case "CurvedArrowConnector":return new N.a(101,153,1,1);case "CurvedDoubleArrowConnector":return new N.a(101,154,1,1);case "DownArrow":return new N.a(46,0,1.07,.53);case "LeftArrow":return new N.a(44,1,.53,1.07);case "LeftRightArrow":return new N.a(50,2,.53,1.33);case "RightArrow":return new N.a(43,3,.53,1.07);case "UpArrow":return new N.a(45,4,1.07,.53);case "UpDownArrow":return new N.a(51,5,1.33,.53);case "LeftRightUpArrow":return new N.a(53,27,.93,1.33);case "BentArrow":return new N.a(62,
28,.95,.89);case "UTurnArrow":return new N.a(63,29,.96,.97);case "LeftUpArrow":return new N.a(52,30,.93,.93);case "BentUpArrow":return new N.a(49,31,.8,.93);case "CurvedRightArrow":return new N.a(67,32,1.33,.8);case "CurvedLeftArrow":return new N.a(68,33,1.33,.8);case "CurvedUpArrow":return new N.a(69,34,.8,1.33);case "CurvedDownArrow":return new N.a(70,46,.8,1.33);case "StripedRightArrow":return new N.a(47,35,.53,1.07);case "NotchedRightArrow":return new N.a(48,36,.53,1.07);case "Pentagon":return new N.a(36,
37,.53,1.07);case "Chevron":return new N.a(37,38,.53,.53);case "RightArrowCallout":return new N.a(56,39,1,1);case "DownArrowCallout":return new N.a(58,40,1,1);case "LeftArrowCallout":return new N.a(55,41,1,1);case "UpArrowCallout":return new N.a(57,42,1,1);case "LeftRightArrowCallout":return new N.a(59,43,.63,1.33);case "QuadArrowCallout":return new N.a(61,44,1.33,1.33);case "CircularArrow":return new N.a(64,45,1.07,1.07);case "QuadArrow":return new N.a(54,47,1.33,1.33);case "Rectangle":return new N.a(4,
10,1,1);case "RoundedRectangle":return new N.a(25,11,1,1);case "RoundDiagonalCornerRectangle":return new N.a(28,48,1,1);case "RoundSameSideCornerRectangle":return new N.a(27,49,1,1);case "RoundSingleCornerRectangle":return new N.a(26,50,1,1);case "SnipRoundSingleCornerRectangle":return new N.a(29,51,1,1);case "SnipDiagonalCornerRectangle":return new N.a(32,52,1,1);case "SnipSameSideCornerRectangle":return new N.a(31,53,1,1);case "SnipSingleCornerRectangle":return new N.a(30,54,1,1);case "RectangularCallout":return new N.a(116,
91,.67,1);case "RoundedRectangleCallout":return new N.a(117,6,.67,1);case "OvalCallout":return new N.a(118,92,.67,1);case "CloudCallout":return new N.a(119,93,.67,1);case "LineCallout1":return new N.a(104,94,.67,1);case "LineCallout2":return new N.a(105,95,.67,1);case "LineCallout3":return new N.a(106,96,.67,1);case "LineCallout1Accent":return new N.a(107,97,.67,1);case "LineCallout2Accent":return new N.a(108,98,.67,1);case "LineCallout3Accent":return new N.a(109,99,.67,1);case "LineCallout1BorderAccent":return new N.a(110,
100,.67,1);case "LineCallout2BorderAccent":return new N.a(111,101,.67,1);case "LineCallout3BorderAccent":return new N.a(112,102,.67,1);case "LineCallout1NoBorder":return new N.a(113,103,.67,1);case "LineCallout2NoBorder":return new N.a(114,104,.67,1);case "LineCallout3NoBorder":return new N.a(115,105,.67,1);case "Explosion1":return new N.a(79,106,1,1);case "Explosion2":return new N.a(80,107,1,1);case "Star4":return new N.a(15,108,1,1);case "Star5":return new N.a(16,15,1,1);case "Star6":return new N.a(17,
109,1,1);case "Star7":return new N.a(18,110,1,1);case "Star8":return new N.a(19,111,1,1);case "Star10":return new N.a(20,112,1,1);case "Star12":return new N.a(21,113,1,1);case "Star16":return new N.a(22,114,1,1);case "Star24":return new N.a(23,115,1,1);case "Star32":return new N.a(24,116,1,1);case "UpRibbon":return new N.a(122,117,.67,1.33);case "DownRibbon":return new N.a(121,118,.67,1.33);case "CurvedUpRibbon":return new N.a(124,119,.83,1.33);case "CurvedDownRibbon":return new N.a(123,120,.83,1.33);
case "VerticalScroll":return new N.a(126,121,1.25,1.13);case "HorizontalScroll":return new N.a(127,122,1.13,1.25);case "Wave":return new N.a(128,123,1,1);case "DoubleWave":return new N.a(129,124,1,1);case "Process":return new N.a(131,125,.67,1);case "AlternateProcess":return new N.a(158,126,.67,1);case "Decision":return new N.a(132,127,.67,1);case "Data":return new N.a(133,128,.67,1);case "PredefinedProcess":return new N.a(134,129,.67,1);case "InternalStorage":return new N.a(135,130,.67,.67);case "Document":return new N.a(136,
131,.67,1);case "Multidocument":return new N.a(137,132,.83,1.16);case "Terminator":return new N.a(138,133,.33,1);case "Preparation":return new N.a(139,134,.67,1.16);case "ManualInput":return new N.a(140,135,.5,1);case "ManualOperation":return new N.a(141,136,.67,1);case "Connector":return new N.a(142,137,.5,.5);case "OffpageConnector":return new N.a(159,138,.67,.67);case "Card":return new N.a(143,139,.88,1);case "PunchedTape":return new N.a(144,140,.88,1);case "SummingJunction":return new N.a(145,
141,.67,.67);case "Or":return new N.a(146,142,.67,.67);case "Collate":return new N.a(147,143,1,.5);case "Sort":return new N.a(148,144,1,.5);case "Extract":return new N.a(149,145,.75,.75);case "Merge":return new N.a(150,146,.75,.75);case "StoredData":return new N.a(152,147,.67,1);case "Delay":return new N.a(157,148,.67,.67);case "SequentialActionStorage":return new N.a(153,149,.67,.67);case "MagneticDisk":return new N.a(154,150,.67,1);case "DirectAccessStorage":return new N.a(155,151,.75,1);case "Display":return new N.a(156,
152,.67,1);default:return null}}}S.f1b=110;S.e1b=75;Object(K.a)(S,"ODSLShape",null,[464])},977:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.algnField=0;this.algnFieldSpecified=!1;this.bevelField=null;this.capField=0;this.capFieldSpecified=!1;this.cmpdField=0;this.cmpdFieldSpecified=!1;this.tailEndField=this.solidFillField=this.roundField=this.prstDashField=this.pattFillField=this.noFillField=this.miterField=this.headEndField=this.gradFillField=this.extLstField=
this.custDashField=null;this.wField=0;this.wFieldSpecified=!1}}Object(K.a)(h,"CT_LineProperties",null,[])},978:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.valField=0;this.valFieldSpecified=!1}}Object(K.a)(h,"CT_PresetLineDashProperties",null,[])},979:function(K,U,d){d.d(U,"a",function(){return z});var h=d(152);K=d(0);var e=d(1244),r=d(280),m=d(693),n=d(339);class z{constructor(v,x,B,D){this.kU=v;this.pa=x;this.qf=B;this.Tu=D;this.select=({scope:w,index:J=-1})=>
Object(h.a)(this,void 0,void 0,function*(){const G=[];var M=null!==w&&void 0!==w?w:"Selection";if("Selection"===M){const N=this.pa.Se();0<N.length&&G.push(...N);0!==G.length||w||(M="Presentation")}if("Presentation"===M&&this.Oc){M=this.Oc.aO.presentation.slides;if(null===M)throw Error("Could not cast from ISlide to ISlide on presentation slides.");G.push(...M)}return-1!==J&&J<G.length?[G[J]]:G});this.format=()=>Object(h.a)(this,void 0,void 0,function*(){throw Error("Method not implemented.");});this.u$d=
w=>w?w.jj:this.Oc.aO.presentation.mY[0].Id;this.ydj=w=>{const J=this.Oc.aO.presentation.mY;for(let G=0;G<J.length;G++)if(w===J[G].Id)return J[G].ContentMasters[0].Id;return 0};this.zdj=(w,J)=>{const G=this.Oc.aO.presentation.mY.find(M=>M.Id===J).ContentMasters.find(M=>M.Name===w);if(!G)throw Error("Could not find content master for layout "+w);return G.Id};this.insert=({slides:w,layout:J})=>Object(h.a)(this,void 0,void 0,function*(){if(!w)throw Error("Could not insert slide due to invalid preceding slides");
if(!this.Oc)throw Error("Cannot insert slides without appForOfficeManager instance.");const G=[];for(var M of w){var N=this.u$d(M);const R=J?this.zdj(J,N):this.ydj(N);N=this.Oc.aO.presentation.q_b(M,null,N,R);G.push(Object(e.a)(r.a,N))}M=[];for(const R of G)M.push(new Promise(C=>n.a.k9(C,R).bind(this)));return Promise.all(M)});this.delete=({slides:w})=>Object(h.a)(this,void 0,void 0,function*(){if(!w)throw Error.argumentNull("slides");if(!this.Oc)throw Error("Cannot delete slides without appForOfficeManager instance.");
for(const J of w){const G=J;G&&!this.qf.$c(G)&&G.isConnected&&(this.pa.nh(),this.Oc.aO.presentation.NI(G),this.Tu.eod(new m.a([G])))}return new Promise(J=>n.a.k9(J,this.Oc.aO.presentation).bind(this))});if(!v)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!x)throw Error.argumentNull("m_selectionManager");if(!B)throw Error.argumentNull("m_actionBlockingManager");if(!D)throw Error.argumentNull("m_graphOperationEventNotifier");this.kU&&this.kU.execute(w=>{this.Oc=w})}}Object(K.a)(z,"ODSLSlide",
null,[464])},980:function(K,U,d){d.d(U,"a",function(){return r});var h=d(152);K=d(0);var e=d(339);class r{constructor(m,n){this.kU=m;this.pa=n;this.select=()=>Object(h.a)(this,void 0,void 0,function*(){throw Error("Method not implemented.");});this.format=()=>Object(h.a)(this,void 0,void 0,function*(){throw Error("Method not implemented.");});this.insert=({slides:z,imageData:v})=>Object(h.a)(this,void 0,void 0,function*(){if(!z)throw Error.argumentNull("slides");if(!v)throw Error("Could not get imageData in Base64.");
if(!this.Oc)throw Error("Cannot insert images without appForOfficeManager instance.");this.V5j(v)&&(v=yield r.Vaj(v));const x=[];for(const B of z)this.pa.rP.apply(this.pa,B),this.Oc.Yt.byh(v,!0,null,null,null,null,0,""),x.push(new Promise(D=>e.a.k9(D,B).bind(this)));yield Promise.all(x)});this.delete=()=>Object(h.a)(this,void 0,void 0,function*(){throw Error("Method not implemented.");});if(!m)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!n)throw Error.argumentNull("m_selectionManager");
this.kU&&this.kU.execute(z=>{this.Oc=z})}static Vaj(m){return Object(h.a)(this,void 0,void 0,function*(){try{m.startsWith("//")&&(m="https:"+m);const n=yield fetch(m);if(n.ok){const z=yield n.arrayBuffer();return btoa((new Uint8Array(z)).reduce((v,x)=>v+String.fromCharCode(x),""))}}catch(n){}return""})}V5j(m){try{return new URL(m),!0}catch(n){return!1}}}Object(K.a)(r,"ODSLImage",null,[464])},981:function(K,U,d){d.d(U,"a",function(){return x});var h=d(152);K=d(0);var e=d(1280),r=d(1281),m=d(40),n=
d(28),z=d(53),v=d(982);d.n(v);class x{constructor(B,D,w,J,G,M,N,R){this.pa=B;this.ta=D;this.Eb=w;this.uwa=J;this.Jfb=G;this.abd=M;this.hNg=N;this.fNg=R;if(!this.pa)throw Error.argumentNull("m_selectionManager");if(!this.ta)throw Error.argumentNull("m_graphTopologyManager");if(!this.Eb)throw Error.argumentNull("m_transactionFactory");if(!this.uwa)throw Error.argumentNull("m_odslText");if(!this.Jfb)throw Error.argumentNull("m_odslShape");if(!this.abd)throw Error.argumentNull("m_odslSlide");if(!this.hNg)throw Error.argumentNull("m_odslTable");
if(!this.fNg)throw Error.argumentNull("m_odslImage");}epj(B){switch(B){case v.ActionRecommendationTrigger.TextSelection:case v.ActionRecommendationTrigger.TextBoxSelection:return this.Xuj();default:throw Error.argumentOutOfRange("trigger");}}imi(B){Object(h.a)(this,void 0,void 0,function*(){const D=JSON.parse(B),w=this.Eb.je(15),J=D.scenario;try{if(!J)throw Error("No scenario provided in modelData");w.hc(this.ta.presentation);switch(J){case "textToTable":const G=Object.assign({},D);this.kIi(G);break;
case "summarizeText":const M=Object.assign({},D);if(!M.summarizeText)throw Error("No summarizeText provided in modelData");this.XUd(J,M.summarizeText);break;case "rewriteText":const N=Object.assign({},D);if(!N.rewriteText)throw Error("No rewriteText provided in modelData");this.XUd(J,N.rewriteText);break;case "continueText":const R=Object.assign({},D);if(!R.continueText)throw Error("No continueText provided in modelData");this.XUd(J,R.newWholeText);break;case "slideGeneration":const C=Object.assign({},
D);this.dmi(C);break;default:throw Error.argumentOutOfRange("scenario");}}catch(G){n.a.J(509085824,e.a.msoulscat_Uci_SmartLookupClient,r.a.warning,`SmartRecommendation: Exception thrown while applying recommendation. ${G}`)}finally{w&&w.dispose()}})}Xuj(){const B=this.pa.Xd().map(J=>J.nz().map(G=>G.characterData).join("\n")).join("\n");let D="";const w=this.pa.Pa.mb;w&&(D=w.toArray().filter(J=>J.contextId===m.a.textRange).map(J=>J.node.characterData.substring(J.wQa,J.vsb)).join("\n"));return JSON.stringify({shapeText:B,
selectedText:D})}kIi(B){Object(h.a)(this,void 0,void 0,function*(){if(!B)throw Error.argumentNull("modelData");if(!B.transformedData)throw Error("No transformedData provided in modelData");if(B.usedData){var D=B.usedData.split("\n");for(var w of D)D=yield this.uwa.select({text:w}),yield this.uwa.delete({textRanges:D})}else w=yield this.Jfb.select({}),yield this.Jfb.delete({shapes:w});w=yield this.abd.select({});yield this.hNg.insert({slides:w,html:B.transformedData})})}XUd(B,D){Object(h.a)(this,void 0,
void 0,function*(){if("summarizeText"===B||"rewriteText"===B)var w=yield this.uwa.select({});else"continueText"===B&&(w=yield this.Jfb.select({}),w=yield this.uwa.select({scope:w}));w=yield this.uwa.delete({textRanges:w});w=yield this.uwa.insert({precededBy:w,text:D});0<w.length&&(w=w[w.length-1],this.pa.setSelection(z.SelectionFactory.Qg(w.node,w.Mb)))})}dmi(B){Object(h.a)(this,void 0,void 0,function*(){if(!B)throw Error.argumentNull("modelData");var D=yield this.abd.select({});D=yield this.abd.insert({slides:D,
layout:"Two Content"});var w=D[0];this.pa.p9a();this.ta.Ba=w;B.title&&(w=yield this.Jfb.select({scope:D,index:0}),w=yield this.uwa.select({scope:w}),yield this.uwa.insert({precededBy:w,text:B.title}));if(B.text){w=yield this.Jfb.select({scope:D,index:1});const J=`<ul>${B.text.map(G=>`<li>${G}</li>`).join("")}</ul>`;yield this.uwa.s$k(w[0],J)}B.image&&(w=(yield this.Jfb.select({scope:D,index:2}))[0],this.pa.setSelection(z.SelectionFactory.nl(w)),yield this.fNg.insert({slides:D,imageData:B.image}))})}}
Object(K.a)(x,"SmartRecommendations",null,[])},982:function(K,U,d){var h=this&&this.nTh||(Object.create?function(r,m,n,z){void 0===z&&(z=n);var v=Object.getOwnPropertyDescriptor(m,n);if(!v||("get"in v?!m.yha:v.writable||v.configurable))v={enumerable:!0,get:function(){return m[n]}};Object.defineProperty(r,z,v)}:function(r,m,n,z){void 0===z&&(z=n);r[z]=m[n]}),e=this&&this.__exportStar||function(r,m){for(var n in r)"default"===n||Object.prototype.hasOwnProperty.call(m,n)||h(m,r,n)};Object.defineProperty(U,
"__esModule",{value:!0});e(d(1163),U);e(d(1164),U);e(d(1165),U);e(d(1166),U)},983:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(e){this.gqk=e}get Qtc(){return this.gqk}}Object(K.a)(h,"ShowHideNotesData",null,[])},984:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);d=d(910);class h extends d.a{constructor(e,r){super(r);this.OMg=e;this.pfb=0}OZf(){const e=(new Date).getTime(),r=e-this.pfb;if(0<this.pfb&&0>=this.OMg-r)return this.pfb=0,this.aYd(),!0;this.pfb=e;this.aYd();
this.setTimeout(this.OMg);return!1}}Object(K.a)(h,"FunctionDelayer",d.a,[])},985:function(K,U,d){d.d(U,"b",function(){return e});d.d(U,"a",function(){return r});d.d(U,"c",function(){return m});var h=d(47);d(406);d(29);d(60);const e=(n,z)=>{const v=[];if(n.length!==z.length)return v;for(let x=0;x<n.length;x++){const B={};B.key=z[x];B.text=n[x];B.type="AppComboBoxItem";v[x]=B}return v},r=(n,z,v,x,B)=>({["unitType"]:n,["unitPlaceholder"]:h.a.ePe(z),["minValue"]:v,["maxValue"]:x,["step"]:B}),m=n=>"1.00"===
n?1:"1.50"===n?1.5:"2.00"===n?2:0},986:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{static add(e,r,m,n,z){h.jyg[h.s3f(e,r,m,n,z)]=!0}static contains(e,r,m,n,z){return h.s3f(e,r,m,n,z)in h.jyg}static s3f(e,r,m,n,z){return String.format("{0}|{1}|{2}|{3}|{4}",e.toLowerCase(),r,m.toLowerCase(),n.toLowerCase(),z.toLowerCase())}}h.jyg={};Object(K.a)(h,"AppsInsertedStorage",null,[])},987:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}h.taskPaneWidth="TaskPaneWidth";h.sourceLocationOverrideResourceId=
"SourceLocationOverrideResourceId";h.ZA="TaskPaneTitle";h.nonPersistedSettings="NonPersistedSettings";h.onTaskPaneClose="OnTaskPaneClose";h.onExtensionLaunchCallback="OnExtensionLaunchCallback";h.c6="OnRenderedCallback";h.TPc="DialogIsModal";h.XPc="DialogShowTitleBar";h.dialogWidth="DialogWidth";h.dialogHeight="DialogHeight";h.dialogLeft="DialogLeft";h.p4b="DialogRight";h.dialogTop="DialogTop";h.n4b="DialogBottom";h.gka="DialogTitle";h.t3d="DialogParentId";Object(K.a)(h,"PropertyNames",null,[])},
988:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}Object(K.a)(h,"AppsForOfficeEntitlementQueryInfo",null,[])},989:function(K,U,d){d.d(U,"a",function(){return D});K=d(0);var h=d(105),e=d(1244),r=d(41),m=d(42),n=d(32),z=d(84),v=d(246),x=d(39),B=d(990);class D{static DJi(w,J,G){w=Object(e.a)(z.a,w.createInstance(1074135137));D.Xxf(w,J,G);return w}static Tai(w,J){n.GraphIterator.pb(w).Hl(J,19)}static Xxf(w,J,G){w.setValue(m.a.VJc,0===J.targetType);w.setValue(m.a.dtb,J.solutionId);w.setValue(m.a.$Jc,
J.version);w.setValue(m.a.V_b,J.storeType);w.setValue(m.a.ZJc,J.storeId);w.setValue(x.a.U_b,G.NNc(J.storeType));J.assetId&&w.setValue(x.a.kUd,J.assetId);w.setValue(x.a.bBf,J.assetStoreId);void 0===J.isAddinCommands?w.setValue(x.a.isAddinCommands,!1):w.setValue(x.a.isAddinCommands,J.isAddinCommands);J.sharedRuntimeId&&-1!==J.backgroundState&&(w.setValue(x.a.Ctb,J.backgroundState),w.setValue(x.a.R7a,J.sharedRuntimeId));0===J.targetType&&(w.setValue(x.a.Jq,!0),G=J.height?J.height:200,w.setValue(r.a.Ix,
J.width?J.width:200),w.setValue(r.a.jD,G))}static NMh(w,J,G){const M=h.a.otc(G);B.b(J,R=>{R=R.eb(m.a.XJc);return!!R&&!(R in M)});B.a(J,(R,C)=>{const O=C.eb(m.a.XJc);O&&O in M&&(D.FMl(C,M[O],R),delete M[O])});const N=n.GraphIterator.pb(J);h.a.forEach(M,(R,C)=>{N.Hl(D.EJi(w,R,C),21)},null)}static EJi(w,J,G){w=Object(e.a)(z.a,w.createInstance(1074135139));w.setValue(m.a.XJc,J);w.setValue(m.a.YJc,G);return w}static FMl(w,J,G){w.setValue(m.a.YJc,J);G.sa(m.a.VJc,!0)?v.d(G,w,D.Ydl):v.d(G,w,D.uel)}}D.Ydl=
[x.a.sid,x.a.cid,x.a.shapeId];D.uel=[m.a.dtb];Object(K.a)(D,"AppEditor",null,[])},990:function(K,U,d){d.d(U,"a",function(){return r});d.d(U,"b",function(){return m});var h=d(32),e=d(991);const r=(n,z)=>{const v=new h.GraphIterator;v.set(n);let x=v.Cb(21);for(;x;)e.a(x)&&z(n,x),x=v.Gf(21)},m=(n,z)=>{const v=new h.GraphIterator;v.set(n);let x=v.Cb(21);for(;x&&x!==n;)x=e.a(x)&&z(x)?v.xSa(21):v.Nj(21)}},991:function(K,U,d){d.d(U,"b",function(){return e});d.d(U,"a",function(){return r});var h=d(42);const e=
(m,n)=>{n[m.eb(h.a.XJc)]=m.eb(h.a.YJc)},r=m=>1074135139===m.Xe},992:function(K,U,d){d.d(U,"a",function(){return v});K=d(0);var h=d(1252),e=d(1278),r=d(90),m=d(32),n=d(34),z=d(232);class v{constructor(x,B,D){this.kU=x;this.pa=B;this.Ga=D;if(!x)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!B)throw Error.argumentNull("m_selectionManager");if(!D)throw Error.argumentNull("m_shapeReader");this.kU&&this.kU.execute(w=>{this.Oc=w})}Juj(x){if(!x.hasText)return null;const B=this.Ga.gae(x).cache;
let D;switch(B.gw){case 0:D="None";break;case 1:D="Single";break;case 2:D="Double";break;case 3:D="Heavy";break;case 4:D="Dotted";break;case 5:D="DottedHeavy";break;case 6:D="Dash";break;case 7:D="DashHeavy";break;case 8:D="DashLong";break;case 9:D="DashLongHeavy";break;case 10:D="DotDash";break;case 11:D="DotDashHeavy";break;case 12:D="DotDotDash";break;case 13:D="DotDotDashHeavy";break;case 14:D="Wavy";break;case 15:D="WavyHeavy";break;case 16:D="WavyDouble";break;default:D="None"}var w=x.nz()[0],
J=new m.GraphIterator;J.set(w);J.sc(11);J.Kg(11);J=(J=w.Uf.Gv(J))?1===J.listType:!1;switch(n.ParagraphReader.CL(w)){case 1:w="Left";break;case 2:w="Center";break;case 3:w="Right";break;case 7:w="Distributed";break;case 6:w="Justify";break;default:w="Left"}return{text:x.i9(),color:r.a.bH(B.fontColor),bold:B.isBold,italic:B.isItalic,underline:D,fontName:B.wL,size:B.fontSize/2,bulleted:J,horizontalAlignment:w}}xrj(x,B){const D=x.get_shapeTypeString(),w=x.shapeName;var J=x.kC;const G=h.a.Ne(J._x,e.a.horizontal);
J=h.a.Ne(J._y,e.a.vertical);var M=x.ZR;const N=M.BottomRight.Y-M.TopLeft.Y;M=M.BottomRight.X-M.TopLeft.X;var R=z.a.parse(x.ypa);const C=R?R.RGBColor:"";R=R?R.Alpha:-1;let O;switch(x.RM){case 0:O="Dash";break;case 1:O="DashDot";break;case 2:O="DashDotDot";break;case 3:O="LongDash";break;case 4:O="LongDashDot";break;case 5:O="RoundDot";break;case 6:O="Solid";break;case 7:O="SquareDot";break;case 8:O="LongDashDotDot";break;case 9:O="SystemDash";break;case 10:O="SystemDot";break;case 11:O="SystemDashDot";
break;default:O="None"}const S=x.outlineWidth;var T=z.a.parse(x.Lga);const ca=T?T.RGBColor:"";T=T?T.Alpha:-1;x=this.Juj(x);return{index:B,textRange:x,type:D,name:w,left:G,top:J,height:N,width:M,lineColor:C,lineDashStyle:O,lineWeight:S,lineTransparency:R,fillColor:ca,fillTransparency:T}}ssj(x){const B={index:0,shapes:[]};x=x.Uj();for(let D=0;D<x.length;D++)B.shapes.push(this.xrj(x[D],D));return B}d$d(){if(!this.Oc)throw Error("Cannot create contextTree without valid AppForOfficeManager instance.");
const x={slides:[],selectionNames:[]};x.slides.push(this.ssj(this.Oc.aO.Ba));const B=this.pa.Xd();for(const D of B)x.selectionNames.push(D.shapeName);return x}}Object(K.a)(v,"ODSLContext",null,[492])},993:function(K,U,d){d.d(U,"a",function(){return n});K=d(0);var h=d(47),e=d(93),r=d(28),m=d(33);class n{constructor(z){this.Ona=null;this.Thc=0;this.Tfc=z;switch(this.Tfc){case "audio":this.Ona=n.Ask;this.Thc=n.Oek;break;case "captions":this.Ona=n.Bsk;this.Thc=n.dfk;break;case "video":this.Ona=n.Csk;
this.Thc=n.Ksk;break;default:r.a.J(509727835,822,10,"Invalid file type")}}static set FSl(z){n.Csk=z}static set ATl(z){n.Ksk=z}czi(z){switch(this.Tfc){case "audio":return n.azi(z);case "captions":return n.bzi(z);case "video":return m.a("DisableVideoAsFileCheck")?new Promise(v=>{v(!0)}):n.dzi(z);default:return r.a.J(509727834,822,10,"Invalid file type"),new Promise(v=>{v(!1)})}}TSl(z){z=h.a.rg(z);for(let v=0;v<this.Ona.length;++v){const x=this.Ona[v];if(x&&0<x.length&&z.endsWith(x))return!0}return!1}USl(z){return z<=
1048576*this.Thc}static azi(z){return new Promise((v,x)=>{if(z&&z.size){var B=document.createElement("video"),D=URL.createObjectURL(z);B.setAttribute("src",D);e.a.addHandler(B,"loadedmetadata",()=>{URL.revokeObjectURL(D);const w=B.videoHeight,J=B.videoWidth;0<B.duration&&!w&&!J?v(!0):(r.a.J(509727832,822,10,"Invalid audio File"),v(!1))});e.a.addHandler(B,"error",()=>{URL.revokeObjectURL(D);r.a.J(509727831,822,10,"Invalid audio File");x(ResourceStrings.L_InvalidAudioFileError)})}else r.a.J(509727833,
822,10,"Empty media File"),v(!1)})}static bzi(z){return new Promise((v,x)=>{if(z&&z.size){var B=URL.createObjectURL(z),D=document.createElement("video"),w=document.createElement("track");D.appendChild(w);e.a.addHandler(w,"load",()=>{URL.revokeObjectURL(B);v(!0)});e.a.addHandler(w,"error",()=>{URL.revokeObjectURL(B);r.a.J(509727829,822,10,"Invalid captions File");x(ResourceStrings.l_InvalidCaptionsFileError)});w.setAttribute("src",B);w.setAttribute("default","true")}else r.a.J(509727830,822,10,"Empty captions File"),
v(!1)})}static dzi(z){return new Promise((v,x)=>{if(z&&z.size){var B=document.createElement("video"),D=URL.createObjectURL(z);B.setAttribute("src",D);e.a.addHandler(B,"loadedmetadata",()=>{URL.revokeObjectURL(D);const w=B.videoHeight,J=B.videoWidth;0<B.duration&&0<w&&0<J?v(!0):(r.a.J(509727837,822,10,"Invalid video File"),v(!1))});e.a.addHandler(B,"error",()=>{URL.revokeObjectURL(D);r.a.J(509727836,822,10,"Invalid video File");x(ResourceStrings.L_InvalidVideoFileError)})}else r.a.J(509727838,822,
10,"Empty media File"),v(!1)})}static M$d(z){if(!z||!z.value)return"Input file name is null";const v=z.value.lastIndexOf(".");return-1===v?"":z.value.substring(v+1,v+5)}}n.Oek=16;n.dfk=16;n.Bsk=[".vtt"];n.Ask=[".mp3",".wav",".m4a",".aac",".oga"];Object(K.a)(n,"MediaValidationHelper",null,[])},994:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e){super();this.zZf=e}}Object(K.a)(h,"CommentContainersChangedEventArgs",Sys.EventArgs,[])},995:function(K,
U,d){d.d(U,"a",function(){return x});K=d(0);var h=d(1244),e=d(7),r=d(97),m=d(37),n=d(28),z=d(698),v=d(124);class x{constructor(B,D,w,J,G,M){this.SLd=this.m7c=null;this.Fy=Object(h.a)(z.a,J.eQf(B,D,w,Object(e.a)(this,this.NM,"onPointerOver"),Object(e.a)(this,this.qG,"onPointerOut"),G));this.tbd=0;this.Mc=M;this.Mc.GC(Object(e.a)(this,this.WE,"onSessionEnd"));this.clear()}dispose(){this.Fy.dispose();this.m7c=null}get F_a(){return this.SLd}setZIndex(B){this.Fy.setZIndex(B)}Adi(B,D,w){this.SLd=B;this.m7c=
D;this.Fy.Jwh("UnreadNotification_16x16x32",this.F_a,w)}clear(){this.Fy.clear();this.SLd=v.a.none}Q1a(){this.fea();this.Fy.n_b(this.F_a,this.W3d);this.Fy.uIe()}fea(){this.Fy.TYd();this.Fy.$We()}WE(){n.a.J(39068559,804,15,"Canvas shape highlights pawn hovered count: {0};",this.tbd);0<this.tbd&&r.c(m.a.KIf)}get W3d(){return this.m7c?this.m7c():""}NM(){this.Q1a();n.a.J(23606147,804,50,"Shape revision tracking pawn hovered");this.tbd+=1;return!0}qG(){this.fea();return!0}}Object(K.a)(x,"ShapeRevisionTrackingPawn",
null,[192])},996:function(K,U,d){d.d(U,"a",function(){return e});K=d(0);var h=d(68);class e{constructor(r){this.eEb=this.fgc=null;this.$e=r}dispose(){this.clear();this.fgc.parentNode.removeChild(this.fgc)}qRa(r){this.fgc=this.COf(r,"prContainerHr");this.eEb=this.COf(this.fgc,"prGlyph")}clear(){this.w0a()}LLa(r,m){r&&(this.w0a(),this.eEb.appendChild(r),this.eEb.style.backgroundColor=m,this.fgc.style.visibility=h.a.visible)}COf(r,m){const n=this.$e.$d();this.$e.addCssClass(n,m);r.appendChild(n);return n}w0a(){this.eEb.firstChild&&
this.eEb.removeChild(this.eEb.firstChild)}}Object(K.a)(e,"ShapePawnGlyph",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19809348/wdjs/ppteditDS.ext.js.map