'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1179:function(K,U,d){d.d(U,"b",function(){return h});d.d(U,"a",function(){return e});const {AugLoopTextEncoder:h,AugLoopTextDecoder:e}=(()=>{if("undefined"===typeof TextEncoder){d(1180);const r={AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder};TextDecoder=TextEncoder=void 0;return r}return{AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder}})()},1180:function(K,U,d){(function(h,e){(function(r){function m(C,
O,S){if(C)throw Error("".concat("Failed to ").concat(O,": the '").concat(S,"' option is unsupported."));}function n(C){return e.from(C)}function z(C,O){var S;return C instanceof e?S=C:S=e.from(C.buffer,C.byteOffset,C.byteLength),S.toString(O)}function v(C){for(var O=0,S=Math.min(65536,C.length+1),T=new Uint16Array(S),ca=[],L=0;;){var da=O<C.length;if(!da||L>=S-1){if(ca.push(String.fromCharCode.apply(null,T.subarray(0,L))),!da)return ca.join("");C=C.subarray(O);L=O=0}da=C[O++];if(0===(da&128))T[L++]=
da;else if(192===(da&224)){var Z=C[O++]&63;T[L++]=(da&31)<<6|Z}else if(224===(da&240)){Z=C[O++]&63;var fa=C[O++]&63;T[L++]=(da&31)<<12|Z<<6|fa}else if(240===(da&248)){Z=C[O++]&63;fa=C[O++]&63;var aa=C[O++]&63;da=(da&7)<<18|Z<<12|fa<<6|aa;65535<da&&(da-=65536,T[L++]=da>>>10&1023|55296,da=56320|da&1023);T[L++]=da}}}function x(C){for(var O=0,S=C.length,T=0,ca=Math.max(32,S+(S>>>1)+7),L=new Uint8Array(ca>>>3<<3);O<S;){var da=C.charCodeAt(O++);if(55296<=da&&56319>=da){if(O<S){var Z=C.charCodeAt(O);56320===
(Z&64512)&&(++O,da=((da&1023)<<10)+(Z&1023)+65536)}if(55296<=da&&56319>=da)continue}T+4>L.length&&(ca+=8,ca*=1+O/C.length*2,ca=ca>>>3<<3,Z=new Uint8Array(ca),Z.set(L),L=Z);if(0===(da&4294967168))L[T++]=da;else{if(0===(da&4294965248))L[T++]=da>>>6&31|192;else if(0===(da&4294901760))L[T++]=da>>>12&15|224,L[T++]=da>>>6&63|128;else if(0===(da&4292870144))L[T++]=da>>>18&7|240,L[T++]=da>>>12&63|128,L[T++]=da>>>6&63|128;else continue;L[T++]=da&63|128}}return L.slice?L.slice(0,T):L.subarray(0,T)}function B(){this.encoding=
"utf-8"}function D(C,O){m(O&&O.fatal,"construct 'TextDecoder'","fatal");C=C||"utf-8";var S;if(w?S=e.qne(C):S=-1!==M.indexOf(C.toLowerCase()),!S)throw new RangeError("".concat(R," encoding label provided ('").concat(C,"') is invalid."));this.encoding=C;this.ignoreBOM=this.fatal=!1}var w="function"==typeof e&&e.from,J=w?n:x;B.prototype.encode=function(C,O){return m(O&&O.stream,"encode","stream"),J(C)};var G=!w&&"function"==typeof Blob&&"function"==typeof URL&&"function"==typeof URL.createObjectURL,
M=["utf-8","utf8","unicode-1-1-utf-8"],N=v;w?N=z:G&&(N=function(C){try{a:{try{var O=URL.createObjectURL(new Blob([C],{type:"text/plain;charset=UTF-8"}));var S=new XMLHttpRequest;var T=(S.open("GET",O,!1),S.send(),S.responseText);break a}finally{O&&URL.revokeObjectURL(O)}T=void 0}return T}catch(ca){return v(C)}});var R="".concat("Failed to "," ").concat("construct 'TextDecoder'",": the ");D.prototype.decode=function(C,O){m(O&&O.stream,"decode","stream");var S;return C instanceof Uint8Array?S=C:C.buffer instanceof
ArrayBuffer?S=new Uint8Array(C.buffer):S=new Uint8Array(C),N(S,this.encoding)};r.TextEncoder=r.TextEncoder||B;r.TextDecoder=r.TextDecoder||D})("undefined"!==typeof window?window:"undefined"!==typeof h?h:this)}).call(this,d(997),d(703).Ozd)},1284:function(K,U,d){(function(h){d.d(U,"a",function(){return r});var e=d(1179);class r{static deserialize(m,n=z=>z){if(m[0]!==r.IDENTIFIERBYTE)throw Error("Invalid Binary: Incorrect Identifier");let z=1;const v=[],x=new DataView(m.buffer,m.byteOffset,m.byteLength);
for(;z<m.byteLength;){if(z+4>m.byteLength)throw Error("Invalid Binary: Error reading fragment length");const B=x.getUint32(z);if(z+B+4>m.byteLength)throw Error("Invalid Binary: Fragment out of range");"undefined"!==typeof h&&h.from?v.push(h.from(m.buffer,m.byteOffset+z+4,B)):v.push(new Uint8Array(m.buffer,m.byteOffset+z+4,B));z+=4+B}if(1>v.length)throw Error("Invalid Binary: No fragments found");m=r.textDecoder.decode(v[0]);return JSON.parse(m,(B,D)=>{if("string"===typeof D){if(D.substring(0,r.BINARYKEYWORD.length)===
r.BINARYKEYWORD){B=parseInt(D.substring(r.BINARYKEYWORD.length),10);if("number"!==typeof B||B>=v.length-1)throw Error("Invalid Binary: Binary index out of range");return n(v[B+1])}if(D.substring(0,r.ESCAPEKEYWORD.length)===r.ESCAPEKEYWORD)return D.substring(r.ESCAPEKEYWORD.length)}return D})}static serialize(m){const n=[void 0];m=JSON.stringify(m,(x,B)=>ArrayBuffer.isView(B)?(n.push(B),`${r.BINARYKEYWORD}${n.length-2}`):B&&"Buffer"===B.type&&Array.isArray(B.data)?(n.push(new Uint8Array(B.data)),`${r.BINARYKEYWORD}${n.length-
2}`):"string"===typeof B&&B.substring(0,r.ESCAPEKEYWORD.length)===r.ESCAPEKEYWORD?r.ESCAPEKEYWORD+B:B);n[0]=r.textEncoder.encode(m);m=n.reduce((x,B)=>x+4+B.byteLength,0);m=new Uint8Array(m+1);m[0]=r.IDENTIFIERBYTE;let z=1;const v=new DataView(m.buffer,m.byteOffset,m.byteLength);for(const x of n)v.setUint32(z,x.byteLength),m.set(x,z+4),z+=4+x.byteLength;return m}}r.IDENTIFIERBYTE=3;r.BINARYKEYWORD=":b";r.ESCAPEKEYWORD=":";r.textDecoder=new e.a;r.textEncoder=new e.b}).call(this,d(703).Ozd)},1289:function(K,
U,d){d.r(U);var h=d(0),e=d(392),r=d(27),m=d(55),n=d(71),z=d(18),v=d(7);class x{constructor(){this.ContextId=this.SessionId=this.AppId=this.Payload=this.Topic=null}}Object(h.a)(x,"AugmentationServiceRequest",null,[]);var B=d(36),D=d(72);class w{constructor(ua,eb,Tb){this.isb=this.Nra=null;this.eUh=Tb;this.Oa=eb;this.hi=ua}initialize(){e.ULS.sendTraceTag(25747911,306,50,"Start initialing augmentation loop ...");const ua=this.Oa.Ha("AugmentationLoopWebServiceBase"),eb=this.Oa.Ha("WebServiceBase");this.Nra=
(void 0===ua?eb:ua)+"proofing.ashx?"+r.AFrameworkApplication.gh+"&apitype=AL";this.isb=new D.a;e.ULS.sendTraceTag(25747912,306,50,"Augmentation Loop initialized")}addEventHandler(ua,eb){if(ua&&""!==ua)if(eb){if(!({value:Tb}=this.isb.wg(ua)).returnValue){var Tb=new z.a;this.isb.add(ua,Tb)}Tb.contains(eb)||Tb.add(eb)}else e.ULS.sendTraceTag(25747914,306,15,"eventHandler is null");else e.ULS.sendTraceTag(25747913,306,15,"topic is empty or null")}removeEventHandler(ua,eb){ua&&""!==ua?eb?this.isb.Fb(ua)?
({value:ua}=this.isb.wg(ua),ua&&ua.contains(eb)&&ua.remove(eb)):e.ULS.sendTraceTag(25747917,306,15,"Topic {0} doesn't exist in handler map.",ua):e.ULS.sendTraceTag(25747916,306,15,"Try to remove null handler"):e.ULS.sendTraceTag(25747915,306,15,"topic is empty or null")}SYe(ua,eb,Tb){this.rrc(ua,eb,Tb,Object(v.a)(this,this.nLa,"requestSucceeded"),Object(v.a)(this,this.lLa,"requestFailed"))}rrc(ua,eb,Tb,uc,yd,oe=null){ua=Object.assign(new x,{Topic:ua,Payload:eb,AppId:this.eUh,SessionId:this.hi.userSessionId,
ContextId:Tb});this.hi.zj(this.Nra,2,B.c(ua),{"Content-Type":"application/json; charset=utf-8"},!1,3,uc,yd,oe?oe:ua,void 0,void 0,void 0,void 0,"18")}nLa(ua){!r.AFrameworkApplication.Yg&&ua&&ua.data&&this.QAk(ua.data.ee)}lLa(ua){!r.AFrameworkApplication.Yg&&ua&&ua.data&&e.ULS.sendTraceTag(25747918,306,15,"{0}",ua.data.ee)}QAk(ua){if(ua){try{var eb=B.a(ua)}catch(Tb){e.ULS.sendTraceTag(36284437,306,10,"Try parse aug response failed:{0}",Tb.message);return}if(({value:ua}=this.isb.wg(eb.Topic)).returnValue)for(let Tb of ua)Tb(eb.ContextId,
eb.Payload);else e.ULS.sendTraceTag(25747919,306,50,"Cannot find handlers for Topic:{0};",eb.Topic)}}}Object(h.a)(w,"AugmentationManager",null,[970]);var J=d(1244);class G{}Object(h.a)(G,"HostMetadata",null,[]);var M=d(706);class N{sendMessage(ua){e.ULS.sendTraceTag(508965922,306,100,"AL send SDX message");M.a.ovh(ua)}registerMessageReceivedCallback(ua){e.ULS.sendTraceTag(508965921,306,50,"AL handle SDX message");M.a.Rmh(ua)}}Object(h.a)(N,"SdxMessageBridge",null,[993]);class R{}Object(h.a)(R,"Lambda",
null,[]);class C extends R{constructor(){super()}}Object(h.a)(C,"WrapperLambda",R,[]);var O=d(469),S=d(142);class T{constructor(){this.handler=this.schemaName=null}}Object(h.a)(T,"AddEventHandlerParameters",null,[]);var ca=d(668);class L{constructor(){this.lambda=this.name=null}}Object(h.a)(L,"RegisterSimpleLocalWorkflowParameters",null,[]);class da{constructor(){this.lambdaAfter=this.lambdaRemote=this.lambdaBefore=this.name=null}}Object(h.a)(da,"RegisterSimpleRemoteWorkflowParameters",null,[]);var Z=
d(999);class fa{constructor(){this.bridge=null}}Object(h.a)(fa,"SetMessageBridgeParameters",null,[]);class aa{constructor(){this.requestAuthTokenCallback=null}}Object(h.a)(aa,"SetRequestAuthTokenCallbackParameters",null,[]);class ja{constructor(){this.sendOTelEvent=null}}Object(h.a)(ja,"SetSendOTelEventCallbackParameters",null,[]);class I{constructor(){this.ulsLogger=null}}Object(h.a)(I,"SetULSLoggerParameters",null,[]);var sa=d(935);class ka{constructor(){this.correlationVector=this.input=this.inputSchema=
null}}Object(h.a)(ka,"SubmitParameters",null,[]);var Ma=d(540);class Ea{constructor(ua,eb=null){this.sZ=null;new D.a;new G;this.Q6h=ua;this.wPa=eb}initialize(ua){this.sZ?e.ULS.sendTraceTag(51185349,306,15,"Initialize called multiple times."):(ua||(ua=new ca.a),this.sZ=new Promise(eb=>{e.ULS.sendTraceTag(51185350,306,50,"Start download and initialize augloop runtime ...");const Tb=r.AFrameworkApplication.lj("al",2);this.Q6h.BCb(Tb).continueWith(()=>{e.ULS.sendTraceTag(51185351,306,50,"augloop: Successfully loaded script");
const uc=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();uc.setRequestAuthTokenCallback(Object.assign(new aa,{requestAuthTokenCallback:Object(v.a)(this,this.kal,"requestAuthToken")}));uc.setULSLogger(Object.assign(new I,{ulsLogger:new O.a}));uc.setSendOTelEventCallback(Object.assign(new ja,{sendOTelEvent:Object(v.a)(this,this.sendOTelEvent,"sendOTelEvent")}));let yd=r.AFrameworkApplication.fa.Ha("OfficeApplicationName")||"";yd=yd.replace("Web","");ua.appName=ua.appName||yd;ua.serviceUrl=ua.serviceUrl||
r.AFrameworkApplication.fa.Ha("AugLoopCloudALServiceUrl");ua.appVersion=ua.appVersion||r.AFrameworkApplication.fa.Ha("BuildVersion")||"";ua.releaseAudienceGroup=ua.releaseAudienceGroup||(r.AFrameworkApplication.Od?Object(J.a)(String,r.AFrameworkApplication.Od.AudienceGroup)||"":"");ua.sessionId=ua.sessionId||r.AFrameworkApplication.fa.Ha("SessionId")||"";ua.uiLanguage=ua.uiLanguage||r.AFrameworkApplication.uiCulture;ua.flights=ua.flights||this.s$i();ua.initSession=ua.initSession||!0;ua.downloadBaseUrl=
ua.downloadBaseUrl||r.AFrameworkApplication.fa.Ha("AugLoopDownloadBaseUrl");uc.initialize(ua);uc.setMessageBridge(Object.assign(new fa,{bridge:new N}));eb({})})}))}registerSchemas(){e.ULS.sendTraceTag(51185352,306,50,"RegisterSchemas is a No-Op");return this.sZ}registerSimpleLocalWorkflow(ua,eb){return this.sZ.then(()=>{e.ULS.sendTraceTag(51185353,306,50,"Registering local workflow: {0} to AugLoop.",ua);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().registerSimpleLocalWorkflow(Object.assign(new L,
{name:ua,lambda:this.Ywd(eb)}))})}registerSimpleRemoteWorkflow(ua,eb,Tb,uc){return this.sZ.then(()=>{e.ULS.sendTraceTag(51185354,306,50,"Registering remote workflow: {0} to AugLoop.",ua);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().registerSimpleRemoteWorkflow(Object.assign(new da,{name:ua,lambdaBefore:this.Ywd(eb),lambdaRemote:this.Ywd(Tb),lambdaAfter:this.Ywd(uc)}))})}registerReduceWorkflow(){e.ULS.sendTraceTag(51185355,306,100,"RegisterReduceWorkflow is NYI");return this.sZ}submit(ua,
eb){this.sZ.then(()=>{e.ULS.sendTraceTag(51185356,306,100,"Submitting event: {0} to AugLoop.",ua);augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submit(Object.assign(new ka,{inputSchema:ua,input:eb}))})}flushTelemetry(){e.ULS.sendTraceTag(51185357,306,100,"FlushTelemetry is NYI")}submitOperation(ua){this.sZ.then(()=>{e.ULS.sendTraceTag(51185358,306,100,"Submitting Operation: {0} to AugLoop.",ua);augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation(Object.assign(new sa.a,{operation:ua}))})}setSessionDataCallback(ua){this.sZ.then(()=>
{e.ULS.sendTraceTag(592318537,306,100,"Setting SessionData Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setSessionDataCallback(ua)})}setInitSessionCallback(ua){this.sZ.then(()=>{e.ULS.sendTraceTag(594384065,306,100,"Setting init session override Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setInitSessionCallback(ua)})}setSessionInitOverrideCallback(ua){this.sZ.then(()=>{e.ULS.sendTraceTag(594384064,306,100,"Setting session init override Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setSessionInitOverrideCallback(ua)})}setAnnotationResultCallback(ua){this.sZ.then(()=>
{e.ULS.sendTraceTag(51185359,306,100,"Setting Result Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setAnnotationResultCallback(Object.assign(new Z.a,{handler:ua}))})}activateAnnotation(ua){return this.sZ.then(()=>{e.ULS.sendTraceTag(51226247,306,100,"Activating Annotation: {0}",ua.annotationType);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().activateAnnotation(ua)})}releaseAnnotation(ua){return this.sZ.then(()=>{e.ULS.sendTraceTag(51226248,306,100,"Releasing Annotation: {0}",
ua.token);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().releaseAnnotation(ua)})}addEventHandler(ua,eb){ua&&""!==ua?eb?this.sZ.then(()=>{e.ULS.sendTraceTag(51185362,306,100,"Setting Result Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().addEventHandler(Object.assign(new T,{schemaName:ua,handler:Tb=>{Tb&&eb(Tb.inputSchema,Tb.input,Tb.outputSchema,Tb.output)}}))}):e.ULS.sendTraceTag(51185361,306,15,"eventHandler is null"):e.ULS.sendTraceTag(51185360,306,15,"schemaName is empty or null")}removeEventHandler(){e.ULS.sendTraceTag(51185363,
306,100,"RemoveEventHandler is NYI.")}kal(){const ua=r.AFrameworkApplication.fa.Ha("AugLoopOAuthResourceUriV2");if(this.wPa)return new Promise(eb=>{this.wPa.execute(Tb=>{Tb.gI("AugLoop",ua).then(uc=>{uc.IsSuccess?eb(uc.Token):(e.ULS.sendTraceTag(51499467,306,15,uc.ErrorMessage),eb(r.AFrameworkApplication.fa.Ha("AugloopACLPUserDataSignature")||""));return{}})})});e.ULS.sendTraceTag(51499468,306,50,"Auth requested without a IOAuthManager");return Promise.resolve("")}sendOTelEvent(ua){S.a.sendOtelEvent(Object.assign(new Ma.a,
{otelEvent:ua}))}Ywd(ua){if(ua){let eb=null;ua.func&&(eb=(Tb,uc,yd,oe)=>{ua.func(Tb,uc,oe)});return Object.assign(new C,{name:ua.name,inputSchema:ua.inputSchema,outputSchema:ua.outputSchema,func:eb})}return null}s$i(){var ua=r.AFrameworkApplication.fa.Ha("FlightId");const eb=r.AFrameworkApplication.fa.eA("AugLoopFlightKeywordList"),Tb=[];if(ua&&""!==ua&&eb&&0<eb.length){ua=ua.split(";");for(let uc=0;uc<ua.length;uc++)for(let yd=0;yd<eb.length;yd++)-1<ua[uc].toLowerCase().indexOf(eb[yd].toLowerCase())&&
Array.add(Tb,ua[uc])}return 0<Tb.length?Tb.join(";"):""}}Object(h.a)(Ea,"NewAugLoopRuntimeManager",null,[969]);var ma=d(152),va=d(56),Ca=d(1276),oa=d(47);class Da{}Object(h.a)(Da,"Lambda",null,[995]);var ta=d(933);class ha{constructor(){this.documentOpenType=this.getItemsEndPoint=this.downloadUrl=null}}Object(h.a)(ha,"PowerPointParameters",null,[]);class Ha{constructor(){this.initSessionCallback=null}}Object(h.a)(Ha,"SetInitSessionCallbackParameters",null,[]);class bb{constructor(){this.sessionDataCallback=
this.handler=null}}Object(h.a)(bb,"SetSessionDataCallbackParameters",null,[]);class Na{constructor(){this.handler=null}}Object(h.a)(Na,"SetSessionInitOverrideCallbackParameters",null,[]);var Ia=d(313),Qa=d(529),qa=d(143);class Wa extends Qa.a{constructor(){super();this.isTriggeredBySyncDelta=null;this.H_=Object.assign(new qa.a,{T_:Wa.getTypeName(),B_:Wa.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(h.a)(Wa,
"DeleteOperation",Qa.a,[]);var Hb=d(705),jc=d(324);class gc extends jc.a{constructor(){super();this.bridgeId=this.cv=this.messageId=null;this.H_=Object.assign(new qa.a,{T_:gc.getTypeName(),B_:gc.getBaseTypes()})}static getTypeName(){return"AugLoop_Session_Protocol_Message"}static getBaseTypes(){return[]}}Object(h.a)(gc,"Message",jc.a,[]);class $b extends gc{constructor(){super();this.protocolVersion=0;this.enableRemoteExecutionNotification=this.enableSessionInspectorLogs=this.returnWorkflowInputTypes=
this.extensionConfigs=this.authToken=this.origin=this.sessionKey=this.serviceUrl=this.clientMetadata=null;this.H_=Object.assign(new qa.a,{T_:$b.getTypeName(),B_:$b.getBaseTypes()})}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}}Object(h.a)($b,"SessionInitMessage",gc,[]);class wb extends $b{constructor(){super();this.documentOpenType=this.getItemsEndPoint=this.downloadUrl=null;this.H_=Object.assign(new qa.a,
{T_:wb.getTypeName(),B_:wb.getBaseTypes()})}static getTypeName(){return"AugLoop_Powerpoint_Session_Protocol_PowerPointSessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SessionInitMessage","AugLoop_Session_Protocol_Message"]}}Object(h.a)(wb,"PowerPointSessionInitMessage",$b,[]);var Db=d(33);class Xb{constructor(){this.authToken=this.origin=this.Nrd=null}}Object(h.a)(Xb,"SessionData",null,[]);var ab=d(545);const Ab=ua=>{if((ua=ua.wc("AugLoopEndpointOverride",0))&&!(1>ua))return{[1]:"https://augloop-test.officeppe.com",
[2]:"https://augloop-int.officeppe.com",[3]:"https://augloop-dogfood.officeppe.com",[4]:"https://augloop.office.com",[5]:"http://localhost:20080"}[ua]};class rc{constructor(){this.ILc=new Map}N3f(ua,eb){const Tb=this.ILc.get(ua);if(Tb){var uc=Tb.get(eb);Tb.delete(eb);0===Tb.size&&this.ILc.delete(ua);return uc}}yjl(ua,eb,Tb){let uc=this.ILc.get(ua);uc||(uc=new Map,this.ILc.set(ua,uc));uc.set(eb,Tb)}}Object(h.a)(rc,"AugLoopSessionCallbackStorage",null,[]);var tb=d(335);class Za{constructor(ua){tb.a.assign(Za,
this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_Message"}static getBaseTypes(){return[]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,[Za.getTypeName()])}}Za.H_={T_:Za.getTypeName(),B_:Za.getBaseTypes()};class fb{constructor(ua){tb.a.assign(fb,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_Response"}static getBaseTypes(){return[]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,[fb.getTypeName()])}}fb.H_={T_:fb.getTypeName(),B_:fb.getBaseTypes()};class ac{constructor(ua){tb.a.assign(ac,
this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_ErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,[ac.getTypeName()])}}ac.H_={T_:ac.getTypeName(),B_:ac.getBaseTypes()};class Dc{constructor(ua){tb.a.assign(Dc,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_TimeoutErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_ErrorResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,
[Dc.getTypeName()])}}Dc.H_={T_:Dc.getTypeName(),B_:Dc.getBaseTypes()};class Sc{constructor(ua){tb.a.assign(Sc,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,[Sc.getTypeName()])}}Sc.H_={T_:Sc.getTypeName(),B_:Sc.getBaseTypes()};class xb{constructor(ua){tb.a.assign(xb,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,
[xb.getTypeName()])}}xb.H_={T_:xb.getTypeName(),B_:xb.getBaseTypes()};class Ta{constructor(ua){tb.a.assign(Ta,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_SessionCloseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,[Ta.getTypeName()])}}Ta.H_={T_:Ta.getTypeName(),B_:Ta.getBaseTypes()};class ib{constructor(ua){tb.a.assign(ib,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,
[ib.getTypeName()])}}ib.H_={T_:ib.getTypeName(),B_:ib.getBaseTypes()};class ob{constructor(ua){tb.a.assign(ob,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,[ob.getTypeName()])}}ob.H_={T_:ob.getTypeName(),B_:ob.getBaseTypes()};class fc{constructor(ua){tb.a.assign(fc,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,
[fc.getTypeName()])}}fc.H_={T_:fc.getTypeName(),B_:fc.getBaseTypes()};class Jb{constructor(ua){tb.a.assign(Jb,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,[Jb.getTypeName()])}}Jb.H_={T_:Jb.getTypeName(),B_:Jb.getBaseTypes()};class xc{constructor(ua){tb.a.assign(xc,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultStateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,
[xc.getTypeName()])}}xc.H_={T_:xc.getTypeName(),B_:xc.getBaseTypes()};class ic{constructor(ua){tb.a.assign(ic,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,[ic.getTypeName()])}}ic.H_={T_:ic.getTypeName(),B_:ic.getBaseTypes()};class nc{constructor(ua){tb.a.assign(nc,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,
[nc.getTypeName()])}}nc.H_={T_:nc.getTypeName(),B_:nc.getBaseTypes()};class Wb{constructor(ua){tb.a.assign(Wb,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,[Wb.getTypeName()])}}Wb.H_={T_:Wb.getTypeName(),B_:Wb.getBaseTypes()};class wc{constructor(ua){tb.a.assign(wc,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,
[wc.getTypeName()])}}wc.H_={T_:wc.getTypeName(),B_:wc.getBaseTypes()};class nb{constructor(ua){tb.a.assign(nb,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_SyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,[nb.getTypeName()])}}nb.H_={T_:nb.getTypeName(),B_:nb.getBaseTypes()};class Rb{constructor(ua){tb.a.assign(Rb,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_MicroSyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,
[Rb.getTypeName()])}}Rb.H_={T_:Rb.getTypeName(),B_:Rb.getBaseTypes()};class mb{constructor(ua){tb.a.assign(mb,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_SyncResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,[mb.getTypeName()])}}mb.H_={T_:mb.getTypeName(),B_:mb.getBaseTypes()};class Ub{constructor(ua){tb.a.assign(Ub,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_SessionDeleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,
[Ub.getTypeName()])}}Ub.H_={T_:Ub.getTypeName(),B_:Ub.getBaseTypes()};class zc{constructor(ua){tb.a.assign(zc,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultsMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,[zc.getTypeName()])}}zc.H_={T_:zc.getTypeName(),B_:zc.getBaseTypes()};class Pc{constructor(ua){tb.a.assign(Pc,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,
[Pc.getTypeName()])}}Pc.H_={T_:Pc.getTypeName(),B_:Pc.getBaseTypes()};class Mc{constructor(ua){tb.a.assign(Mc,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,[Mc.getTypeName()])}}Mc.H_={T_:Mc.getTypeName(),B_:Mc.getBaseTypes()};class ld{constructor(ua){tb.a.assign(ld,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_KeepAlive"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,
[ld.getTypeName()])}}ld.H_={T_:ld.getTypeName(),B_:ld.getBaseTypes()};class vb{constructor(ua){tb.a.assign(vb,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,[vb.getTypeName()])}}vb.H_={T_:vb.getTypeName(),B_:vb.getBaseTypes()};class cc{constructor(ua){tb.a.assign(cc,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,
[cc.getTypeName()])}}cc.H_={T_:cc.getTypeName(),B_:cc.getBaseTypes()};class Hc{constructor(ua){tb.a.assign(Hc,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionCompleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,[Hc.getTypeName()])}}Hc.H_={T_:Hc.getTypeName(),B_:Hc.getBaseTypes()};class Pb{constructor(ua){tb.a.assign(Pb,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,
[Pb.getTypeName()])}}Pb.H_={T_:Pb.getTypeName(),B_:Pb.getBaseTypes()};class Uc{constructor(ua){tb.a.assign(Uc,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,[Uc.getTypeName()])}}Uc.H_={T_:Uc.getTypeName(),B_:Uc.getBaseTypes()};class sc{constructor(ua){tb.a.assign(sc,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2CallbackMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,
[sc.getTypeName()])}}sc.H_={T_:sc.getTypeName(),B_:sc.getBaseTypes()};class lb{constructor(ua){tb.a.assign(lb,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_BridgeMessage"}static getBaseTypes(){return[]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,[lb.getTypeName()])}}lb.H_={T_:lb.getTypeName(),B_:lb.getBaseTypes()};var Zb=d(1284);class Oc{constructor(ua,eb,Tb){var uc;this.Vdc=new Map;this.ydb=new Map;this.Wdc=new Map;this.LCb=new Map;this.RIa=this.Xwa=this.MDb=this.BO=null;
this.iUd=new rc;this.JRd=new Map;this.Nv=ua;this.Ea=eb;this.ai=Tb;const yd=new ca.a;yd.powerpoint=new ha;ua=new ca.a;Db.a("AL.SendNewInitParams")&&(ua.serviceUrl=null!==(uc=Ab(eb))&&void 0!==uc?uc:void 0);if(Db.a("AL.SendSlideTile"))if(Db.a("AL.EnableRehydration"))this.Nv.initialize(ua),this.Nv.setInitSessionCallback(Object.assign(new Ha,{initSessionCallback:Object(v.a)(this,this.sHk,"onSessionInit")})),this.Nv.setSessionInitOverrideCallback(Object.assign(new Na,{handler:Object(v.a)(this,this.tHk,
"onSessionInitOverride")})),this.RIa=this.WZc(),this.Nv.setAnnotationResultCallback(Object(v.a)(this,this.onAnnotationResult,"onAnnotationResult")),this.x0=Promise.resolve(null);else{eb=va.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;uc=va.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;eb=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",uc,eb);uc=va.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").hab?
va.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").TVc:va.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;var oe=String.format("{0}getitems.ashx",uc);uc=new Ca.a(r.AFrameworkApplication.Me);this.x0=ab.b(uc.cZe(eb));this.x0.then($d=>{try{const ve=JSON.parse($d),hc=ve.downloadUrl;oa.a.Xa(hc)?e.ULS.sendTraceTag(509112976,306,15,"PPTAugLoopRuntimeManager: GetSnappedDownloadLink returned a bad response: {0}",ve):(yd.powerpoint.downloadUrl=hc,yd.powerpoint.getItemsEndPoint=
oe,this.Ea.m5b&&(yd.powerpoint.documentOpenType=this.Q9f()))}catch(ve){e.ULS.sendTraceTag(509112975,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",ve)}this.Nv.initialize(yd);this.RIa=this.WZc();this.Nv.setAnnotationResultCallback(Object(v.a)(this,this.onAnnotationResult,"onAnnotationResult"));return null}).catch($d=>{e.ULS.sendTraceTag(509112974,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",$d);this.Nv.initialize(yd);this.RIa=this.WZc();
this.Nv.setAnnotationResultCallback(Object(v.a)(this,this.onAnnotationResult,"onAnnotationResult"))})}else this.x0=new Promise($d=>{this.Nv.initialize(yd);this.RIa=this.WZc();this.Nv.setAnnotationResultCallback(Object(v.a)(this,this.onAnnotationResult,"onAnnotationResult"));$d("")})}VZ(ua){this.x0.then(eb=>{this.Nv.activateAnnotation(Object.assign(new ta.a,{annotationType:ua}));this.JRd.set(ua,eb);return eb})}releaseAnnotation(ua){return Object(ma.a)(this,void 0,void 0,function*(){yield this.x0;const eb=
this.JRd.get(ua);let Tb;void 0!==eb&&(Tb=this.Nv.releaseAnnotation({token:eb}))&&this.JRd.delete(ua);return Tb})}Moa(ua,eb){if(ua)if(eb){if(this.Vdc.has(ua))var Tb=this.Vdc.get(ua);else Tb=new z.a,this.Vdc.set(ua,Tb);Tb&&!Tb.contains(eb)&&Tb.add(eb)}else e.ULS.sendTraceTag(509112972,306,15,"AnnotationHandler is null");else e.ULS.sendTraceTag(509112973,306,15,"Annotation Type is null or empty")}w2k(ua,eb){if(ua)if(eb){if(this.Wdc.has(ua))var Tb=this.Wdc.get(ua);else Tb=new z.a,this.Wdc.set(ua,Tb);
Tb&&!Tb.contains(eb)&&Tb.add(eb)}else e.ULS.sendTraceTag(509116945,306,15,"AnnotationHandler is null");else e.ULS.sendTraceTag(509116947,306,15,"Annotation Type is null or empty")}zmh(ua,eb){if(ua)if(eb){if(this.ydb.has(ua))var Tb=this.ydb.get(ua);else Tb=new z.a,this.ydb.set(ua,Tb);Tb&&!Tb.contains(eb)&&Tb.add(eb)}else e.ULS.sendTraceTag(509112970,306,15,"AnnotationHandler is null");else e.ULS.sendTraceTag(509112971,306,15,"Annotation Type is null or empty")}addEventHandler(ua,eb){this.x0.then(()=>
{this.Nv.addEventHandler(ua,eb);return null})}removeEventHandler(ua,eb){this.x0.then(()=>{this.Nv.removeEventHandler(ua,eb);return null})}registerSimpleLocalWorkflow(ua,eb){return this.x0.then(()=>this.Nv.registerSimpleLocalWorkflow(ua,this.Zwd(eb)))}registerSimpleRemoteWorkflow(ua,eb,Tb,uc){return this.x0.then(()=>this.Nv.registerSimpleRemoteWorkflow(ua,this.Zwd(eb),this.Zwd(Tb),this.Zwd(uc)))}submit(ua,eb){this.Ea.qea||this.x0.then(()=>{this.Nv.submit(ua,eb);return null})}submitOperation(ua){this.x0.then(()=>
{this.Nv.submitOperation(ua);return null})}C3i(ua,eb){return this.RIa.then(()=>Object(ma.a)(this,void 0,void 0,function*(){return yield fetch(this.Xwa.Nrd,{method:"POST",headers:{"Content-Type":"application/jsond","X-Origin":this.Xwa.origin,Authorization:`Bearer ${this.Xwa.authToken}`},body:Zb.a.serialize(ua),signal:eb.signal})}))}kCl(ua,eb=1E4){return Object(ma.a)(this,void 0,void 0,function*(){const Tb=new AbortController,uc=window.setTimeout(()=>{Tb.abort()},eb);try{if(!(yield this.C3i(ua,Tb)).ok)throw Error("Network response was not ok");
}catch(yd){if(yd instanceof DOMException&&"AbortError"===yd.name)throw Error("Request timed out");throw yd;}finally{clearTimeout(uc)}})}submitBinarySignal(ua,eb,Tb,uc,yd=1E4){return Object(ma.a)(this,void 0,void 0,function*(){this.RIa.then(()=>Object(ma.a)(this,void 0,void 0,function*(){this.iUd.yjl(eb,uc,Tb);void 0!==this.poi&&clearInterval(this.poi);try{yield this.kCl(new Rb({parentPath:["session","img"],item:{id:uc,body:ua}}),yd)}catch(oe){throw this.iUd.N3f(eb,uc),oe;}}))})}s3i(ua){return this.RIa.then(()=>
fetch(`${this.Xwa.Nrd}/blob/${ua}`,{headers:{"X-Origin":this.Xwa.origin,Authorization:`Bearer ${this.Xwa.authToken}`}}))}getBlob(ua,eb=1E4){return Object(ma.a)(this,void 0,void 0,function*(){const Tb=new AbortController,uc=window.setTimeout(()=>{Tb.abort()},eb);yield this.x0;try{const yd=yield this.s3i(ua);if(!yd.ok)throw Error("Network response was not ok");return yd.blob()}catch(yd){if(yd instanceof DOMException&&"AbortError"===yd.name)throw Error("Request timed out");throw yd;}finally{clearTimeout(uc)}})}vRl(ua,
eb,Tb,uc,yd){this.RIa&&this.RIa.then(()=>{this.ai.augmentImage(ua,eb,Tb,!0,this.Xwa.Nrd,this.Xwa.origin,this.Xwa.authToken,uc,yd);return null})}tHk(ua){e.ULS.sendTraceTag(509112969,306,50,"PPTAugLoopRuntimeManager: OnSessionInitOverride");const eb=Object.assign(new wb,{protocolVersion:ua.protocolVersion,clientMetadata:ua.clientMetadata,sessionKey:ua.sessionKey,origin:ua.origin,authToken:ua.authToken,messageId:ua.messageId,cv:ua.cv});try{this.Ea.m5b&&(eb.documentOpenType=this.Q9f())}catch(Tb){e.ULS.sendTraceTag(509112968,
306,10,"PPTWebEditorAugLoopRunTimeManager::OnSessionInitOverride exception:{0}",Tb)}this.Okl(ua);if(oa.a.Xa(this.BO)||oa.a.Xa(this.MDb))return e.ULS.sendTraceTag(509112967,306,15,"PPTAugLoopRuntimeManager: Failed to override sessionInitMessage, null or empty downloadUrl obtained"),ua;eb.downloadUrl=this.BO;eb.getItemsEndPoint=this.MDb;this.MDb=this.BO=null;return eb}sHk(){e.ULS.sendTraceTag(509112966,306,50,"PPTAugLoopRuntimeManager: OnSessionInit");var ua=va.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;
const eb=va.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;var Tb=va.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").hab?va.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").TVc:va.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;ua=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",eb,ua);const uc=String.format("{0}getitems.ashx",Tb);Tb=new Ca.a(r.AFrameworkApplication.Me);return ab.b(Tb.cZe(ua)).then(yd=>
{try{const oe=JSON.parse(yd),$d=oe.downloadUrl;oa.a.Xa($d)?e.ULS.sendTraceTag(509112965,306,15,"PPTAugLoopRuntimeManager: GetSnappedDownloadLink returned a bad response: {0}",oe):(this.BO=$d,this.MDb=uc)}catch(oe){e.ULS.sendTraceTag(509112964,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",oe)}return null}).catch(yd=>{e.ULS.sendTraceTag(509112963,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",yd)})}WZc(){return new Promise(ua=>{this.Nv.setSessionDataCallback(Object.assign(new bb,
{sessionDataCallback:(eb,Tb,uc)=>{this.Xwa=Object.assign(new Xb,{Nrd:eb,origin:Tb,authToken:uc});ua(null)}}))})}dzj(ua,eb,Tb){ua=this.iUd.N3f(ua,eb);void 0!==ua&&ua(Tb)}onAnnotationResult(ua){if(ua&&ua.items)if(this.Ea.qea&&this.dhl(ua),jc.a.getTypeNameFor(ua)!==Ia.a.getTypeName()&&jc.a.getTypeNameFor(ua)!==Hb.a.getTypeName())this.Ea.tWf&&jc.a.getTypeNameFor(ua)===Wa.getTypeName()&&this.iCk(ua);else for(const Tb of ua.items){if(!Tb||!Tb.body)continue;const uc=jc.a.getTypeNameFor(Tb.body);if(!uc)continue;
var eb=Tb.body||{};ua.parentPath&&(eb.parentPath=ua.parentPath);let yd;if(this.Vdc.has(uc)){if(yd=this.Vdc.get(uc))for(let oe of yd)oe(eb)}else e.ULS.sendTraceTag(509112962,306,50,"Cannot find handlers for annotation:{0};",uc);uc&&ua.parentPath&&this.dzj(uc,ua.parentPath[2],Tb.body);if(this.Ea.tWf){if(this.ydb.has(uc)&&(eb=this.ydb.get(uc)))for(let oe of eb)oe(Tb,!1);oa.a.Xa(Tb.id)||this.LCb.set(Tb.id,uc)}}}dhl(ua){const eb=new Map,Tb=jc.a.getTypeNameFor(ua)!==Ia.a.getTypeName()&&jc.a.getTypeNameFor(ua)!==
Hb.a.getTypeName();for(var uc of ua.items){ua=Tb&&this.LCb.has(uc.id)?this.LCb.get(uc.id):jc.a.getTypeNameFor(uc.body);let yd;eb.has(ua)?yd=eb.get(ua):(yd=new z.a,eb.set(ua,yd));yd.add(uc)}for(const yd of eb.keys())if(this.Wdc.has(yd)){if(uc=this.Wdc.get(yd))for(let oe of uc)oe(eb.get(yd).toArray(),Tb)}else e.ULS.sendTraceTag(509116952,306,50,"Cannot find handlers for annotation:{0};",yd)}iCk(ua){for(const eb of ua.items)if(eb&&eb.id&&this.LCb.has(eb.id)){ua=this.LCb.get(eb.id);if(this.ydb.has(ua)&&
(ua=this.ydb.get(ua)))for(const Tb of ua)Tb(eb,!0);this.LCb.delete(eb.id)}}Zwd(ua){return ua?Object.assign(new Da,{name:ua.name,inputSchema:ua.inputSchema,outputSchema:ua.outputSchema,func:ua.func}):null}Q9f(){try{return this.Ea.QL?0:this.Ea.xWa?2:1}catch(ua){return e.ULS.sendTraceTag(509112961,306,50,"PPTWebEditorAugLoopRunTimeManager::GetOpenType :{0};",ua),2}}Okl(ua){try{oa.a.Xa(ua.clientMetadata.flights)?ua.clientMetadata.flights=";":ua.clientMetadata.flights+=";",this.Ea.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled",
!1)?ua.clientMetadata.flights+="Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled-Treatment;":ua.clientMetadata.flights+="Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled-Control;"}catch(eb){e.ULS.sendTraceTag(509112960,306,50,"PPTWebEditorAugLoopRunTimeManager::SetFlights :{0};",eb)}}}Object(h.a)(Oc,"PPTAugLoopRuntimeManager",null,[968]);class md{constructor(ua){this.mU=ua;this.mU.initialize()}addEventHandler(ua,eb){this.mU.addEventHandler(ua,eb)}removeEventHandler(ua,
eb){this.mU.removeEventHandler(ua,eb)}SYe(ua,eb,Tb){this.mU.SYe(ua,eb,Tb)}rrc(ua,eb,Tb,uc,yd,oe=null){this.mU.rrc(ua,eb,Tb,uc,yd,oe)}}Object(h.a)(md,"PPTAugmentationManager",null,[967]);var Ib=d(317),ud=d(106);class od{constructor(ua){tb.a.assign(od,this,ua)}static getTypeName(){return"AugLoop_Chat_ChatsHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,[od.getTypeName()])}}od.H_={T_:od.getTypeName(),B_:od.getBaseTypes()};class Ud{constructor(ua){tb.a.assign(Ud,
this,ua)}static getTypeName(){return"AugLoop_Chat_Chat"}static getBaseTypes(){return[]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,[Ud.getTypeName()])}}Ud.H_={T_:Ud.getTypeName(),B_:Ud.getBaseTypes()};class Ad{constructor(ua){tb.a.assign(Ad,this,ua)}static getTypeName(){return"AugLoop_Chat_MessagesHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,[Ad.getTypeName()])}}Ad.H_={T_:Ad.getTypeName(),B_:Ad.getBaseTypes()};class be{constructor(ua){tb.a.assign(be,
this,ua)}static getTypeName(){return"AugLoop_Chat_ChatMessage"}static getBaseTypes(){return[]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,[be.getTypeName()])}}be.H_={T_:be.getTypeName(),B_:be.getBaseTypes()};class uf{constructor(ua){tb.a.assign(uf,this,ua)}static getTypeName(){return"AugLoop_Chat_TextChatMessage"}static getBaseTypes(){return["AugLoop_Chat_ChatMessage"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,[uf.getTypeName()])}}uf.H_={T_:uf.getTypeName(),B_:uf.getBaseTypes()};
var sd=d(28);class Ze{constructor(ua){this.JH=ua;ua.body&&(ua=ua.body,this.ID=ua.id,this.Status=ua.status,this.Text=ua.text,this.Szd=this.frj())}frj(){return this.JH.parentPath&&0<this.JH.parentPath.length?this.JH.parentPath[this.JH.parentPath.length-1]:""}}Object(h.a)(Ze,"ALChatHelperResponse",null,[992]);class Ke{constructor(ua,eb){this.Rlk=0;this.wXg=new Map;this.Nv=eb;const Tb=["session","chats"],uc=(new Ib.a(ud.a.create(),1)).toString(),yd=[...Tb,uc];this.wlk=[...yd,"messages"];this.Nv.execute(oe=>
{oe.submitOperation(Ke.p_d(Tb,uc,ua.chat));oe.submitOperation(Ke.p_d(yd,"messages",new Ad));oe.VZ(ua.responseType);oe.zmh(ua.responseType,this.MQ.bind(this))})}MQ(ua){ua=new Ze(ua);if(ua.Szd){const eb=this.wXg.get(ua.Szd);if(eb){eb(ua);this.wXg.delete(ua.Szd);return}}this.Zfk?this.Zfk(ua):sd.a.J(509366417,822,15,"No handler found")}send(ua){const eb=`${this.Rlk++}`;this.Nv.execute(Tb=>{Tb.submitOperation(Ke.p_d(this.wlk,eb,ua))})}static p_d(ua,eb,Tb){return Object.assign(new Ia.a,{parentPath:ua,items:[{id:eb,
body:Tb}]})}}Object(h.a)(Ke,"ALChatHelper",null,[985]);class hf{constructor(ua){this.T5c=ua}create(ua){return new Ke(ua,this.T5c)}}Object(h.a)(hf,"ALChatHelperFactory",null,[960]);class Xa{constructor(){this.K=null}get name(){return"PowerPointWebEditor.AugmentationLoop"}Yb(ua){this.K=ua;this.K.register(md,"PowerPointWebEditor.AugmentationLoop.PPTAugmentationManager").as("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager").ma().oa(()=>new md(new w(r.AFrameworkApplication.Me,ua.resolve("Common.IAppSettingsManager"),
"PowerPoint_Online")));this.K.register(Oc,"PowerPointWebEditor.AugmentationLoop.PPTAugLoopRuntimeManager").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").ma().oa(()=>{const eb=m.a.i6j();e.ULS.sendTraceTag(509441561,306,50,"IsWebSocketSupported: {0}",eb);r.AFrameworkApplication.fa.appSettings.AugLoopUseWebSocket=eb.toString();return new Oc(new Ea(ua.resolve("Common.ISharedDependencyLoader"),ua.Ia("Common.App.OAuth.IOAuthManager")),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"))});Object(Db.a)("EnableALChatHelper")&&this.K.register(hf,"PowerPointWebEditor.AugmentationLoop.ALChatHelperFactory").as("PowerPointWebEditor.AugmentationLoop.IALChatHelperFactory").ma().oa(()=>new hf(this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")))}init(){this.K.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager");this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptAugLoopRuntimeIntegrationEnabled&&
(this.K.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),Object(Db.a)("EnableALChatHelper")&&this.K.resolve("PowerPointWebEditor.AugmentationLoop.IALChatHelperFactory"))}dispose(){}static main(){n.a.instance.Ac(new Xa)}}Object(h.a)(Xa,"PPTWebEditorAugmentationLoopPackage",null,[2,3]);var Bb=d(1243),mc=d(934),Qc=d(932),td=d(557),Md=d(64),Pd=d(34);class Be{constructor(ua){if(!ua)throw Error.argumentNull("Handler for Text Prediction is Null- unable to retrieve initial text prediction signal state");
this.d1=ua}v9b(ua){this.b7e(ua)}b7e(ua){if(ua){try{const yd=ua.parentPath;if(!yd||4>yd.length){sd.a.J(590181647,820,50,"ParentPath is Null or Empty.");return}const oe=yd[3];var eb=yd[2];if(!oe){sd.a.J(590181645,820,50,"Unable to retreive original paragraph text");return}var Tb=this.d1.ejj(oe);this.d1.g6k(oe);const $d=ua.predictions;if(!$d||!$d.length){sd.a.J(590181643,820,50,"Augloop Annotations Null or Empty.");return}const ve=$d[0];if(!ve)return;var uc=ve.text;if(!uc||!uc.length){sd.a.J(590181641,
820,50,"Text Predictions Null or Empty.");return}}catch(yd){sd.a.J(590710030,820,10,"Unable to parse output because of modified output type from Augloop");return}uc&&Be.kVi(uc,Tb,eb)}else sd.a.J(590181649,820,50,"Annotations returned from service is null.")}static kVi(ua,eb,Tb){ua&&ua.length&&(eb=Be.ioj(ua,eb),-1!==eb&&(eb=ua.substring(eb,ua.length),Tb=Object.assign(new Qc.a,{text:ua,j9:eb,Ux:Tb}),td.a.jE.m6=Tb,td.a.JUd(ua,eb)))}static ioj(ua,eb){var Tb=Md.a.instance.Pa.mb.jf.node;if(!Tb||!eb)return-1;
Tb=Pd.ParagraphReader.text(Tb);if(!Tb)return-1;if(Tb!==eb)if(Tb.length>eb.length&&Tb.substring(0,eb.length)===eb){if(!ua.startsWith(Tb.substring(eb.length,Tb.length-eb.length)))return-1;sd.a.J(590181638,820,50,"Ghost Text matches part of the Prediction Text.")}else return-1;return" "===Tb.substring(Tb.length-1,1)?0:Be.B8f(Tb)}static B8f(ua){return ua?ua.length-1-ua.lastIndexOf(" "):-1}}Object(h.a)(Be,"TextPredictionAugLoopResponseManager",null,[]);var fe=d(334);class Mf extends Qa.a{constructor(){super();
this.H_=Object.assign(new qa.a,{T_:Mf.getTypeName(),B_:Mf.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(h.a)(Mf,"SignalOperation",Qa.a,[]);var Bd=d(1077);class Rc{constructor(){this.hQe=!1}}Object(h.a)(Rc,"PredictionSettings",null,[]);class Gf{constructor(ua,eb){this.ydd=null;this.Mze={};this.Nv=ua;this.Vb=eb;this.Vb.gJc(Object(v.a)(this,this.Jfg,"handleResize"))}ejj(ua){return this.Mze[ua]}Gll(ua,eb){this.Mze[ua]=
eb}g6k(ua){ua&&delete this.Mze[ua]}get settings(){this.ydd||(this.ydd=Object.assign(new Rc,{hQe:!1}));return this.ydd}set settings(ua){this.ydd=ua}IJl(ua){if(this.settings.hQe&&ua){var eb=ua.id.toString(),Tb=td.a.jE.m6,uc=Md.a.instance.Pa.mb;if(uc&&1===uc.length&&uc.jf){uc=uc.jf;var yd=uc.node;if(Pd.ParagraphReader.textLength(yd)===uc.Sa){if(Tb&&yd&&eb===Tb.Ux&&eb===yd.id.toString()&&(uc=this.lae(Tb,yd))){Tb.j9=uc;td.a.JUd(Tb.text,uc);return}td.a.jE.m6=null;Tb=ud.a.create().toString();uc=Pd.ParagraphReader.text(ua);
this.Gll(Tb,uc);ua=["Signal",Bd.a.getTypeName(),eb,Tb];Tb=Gf.bmj(uc);eb=[Object.assign(new fe.a,{id:eb,body:Tb})];var oe=Object.assign(new Mf,{parentPath:ua,items:eb});this.Nv.execute($d=>{$d.submitOperation(oe);sd.a.J(512493778,820,50,"TextPrediction Signal sent to Augloop Service")})}}}}WLb(){td.a.jE.m6=null;td.a.dVa()}kFj(ua){!ua||1<ua.length?this.WLb():1>ua.length||((ua=ua[0])&&ua.context?(ua=ua.context,ua.Sa===ua.Mb&&Pd.ParagraphReader.textLength(ua.node)===ua.Sa||this.WLb()):this.WLb())}lae(ua,
eb){var Tb=null;if(ua&&eb){eb=Pd.ParagraphReader.text(eb);ua=ua.text;if(!eb||!ua)return Tb;eb=eb.replace(RegExp("\\u00a0","g")," ");ua=ua.replace(RegExp("\\u00a0","g")," ");if(eb){if(eb.endsWith(ua))return this.WLb(),Tb;Tb=Gf.bnj(eb,ua);Tb=ua.substring(Tb,ua.length)}}return Tb}Jfg(){td.a.dVa()}dispose(){this.Vb.cpd(Object(v.a)(this,this.Jfg,"handleResize"))}static bmj(ua){return Object.assign(new Bd.a,{languageId:"en-US",startOfSentence:!0,text:ua})}static bnj(ua,eb){for(let Tb=eb.length;0<Tb;Tb--){const uc=
eb.substring(0,Tb);if(ua.endsWith(uc.trimStart()))return uc.length}return 0}}Gf.$Va=!1;Object(h.a)(Gf,"TextPredictionHandler",null,[954]);var Nf=d(52),Oa=d(30);class cb{constructor(ua,eb){this.ia=ua;this.oc=eb}vb(){this.ia.ya(Oa.a.gSk,Nf.a.application,Object(v.a)(this,this.jSk,"predictionHandler"))}jSk(ua,eb,Tb){return r.AFrameworkApplication.fa.ka("PPTOTextPredictionIsEnabled")?1===Tb?this.oc.Cj()?32:2:8:8}}Object(h.a)(cb,"TextPredictorActor",null,[]);class Ic{constructor(){this.SGe=this.K=null}get name(){return"PowerPointWebEditor.TextPrediction"}Yb(ua){this.K=
ua;ua.register(cb,"PowerPointWebEditor.TextPrediction.TextPredictorActor").ma().oa(()=>new cb(ua.resolve("Common.IActionManagerExtended"),ua.resolve("PowerPointWebEditor.IPresentationReader")));ua.register(954,"PowerPointWebEditor.TextPrediction.ITextPredictionHandler").ma().oa(()=>new Gf(ua.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),ua.resolve("PowerPointWebEditor.Core.IPPTAppFrame")))}init(){this.K.resolve("PowerPointWebEditor.TextPrediction.TextPredictorActor").vb();this.SGe=
new Bb.a(()=>new Be(this.K.resolve("PowerPointWebEditor.TextPrediction.ITextPredictionHandler")));this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(ua=>{ua.VZ(mc.a.getTypeName());ua.Moa(mc.a.getTypeName(),Object(v.a)(this.SGe.value,this.SGe.value.v9b,"handleResponse"))})}dispose(){}static main(){n.a.instance.Ac(new Ic)}}Object(h.a)(Ic,"TextPredictionPackage",null,[2,3]);var qd=d(269),le=d(29);class yb{}Object(h.a)(yb,"AugContextId",null,[]);class ef{}Object(h.a)(ef,
"AugParagraph",null,[]);class Cb{}Object(h.a)(Cb,"AugShape",null,[]);class oc{}Object(h.a)(oc,"ShapeTextTile",null,[]);class vc{constructor(ua,eb,Tb,uc){this.Ga=Tb;this.Gh=uc;this.Rb=ua;this.Yl=eb}A3b(ua,eb){return ua&&ua.isConnected&&this.Ga.uGa(ua)?(ua=Object(J.a)(4,ua))?Object.assign(new oc,{Topic:"ShapeText",ContextId:B.c(vc.AGi(ua,eb)),Data:B.c(this.BGi(ua))}):null:null}$2b(ua){return ua&&ua.get_shapeId()&&ua.hasText&&!ua.hq?ua.Rme:!1}BGi(ua){const eb=[];ua=this.Rb.Lc(ua);for(ua=this.Yl.A3(ua,
ua.currentNode);ua.moveNext();){var Tb=ua.currentNode;const uc=Tb;this.Gh.ae(uc)&&(Tb=Object.assign(new ef,{t:this.Gh.text(uc),l:this.Gh.Hib(Tb)}),Array.add(eb,Tb))}return Object.assign(new Cb,{p:eb,c:qd.a.He(r.AFrameworkApplication.lcid).sxb})}static AGi(ua,eb){return Object.assign(new yb,{gid:ua.id,sid:ua.slideSid,cid:ua.slideCid,shapeId:ua.get_shapeId(),rid:(ua.i4c||ua.CGa||le.App.pn).toString(),t:eb,c:(new Date).getTime()})}}Object(h.a)(vc,"ShapeTextTileManager",null,[950,974]);var nd=d(105),
id=d(1265),Nd=d(205),Ce=d(82),af;(function(ua){ua[ua.none=0]="none";ua[ua.onParagraphPropertyChanged=1]="onParagraphPropertyChanged";ua[ua.onSelectionFinished=2]="onSelectionFinished";ua[ua.onActiveSlideDomReady=4]="onActiveSlideDomReady";ua[ua.onShapeChildTopologyChanged=8]="onShapeChildTopologyChanged";ua[ua.onParagraphDisconnect=16]="onParagraphDisconnect";ua[ua.onNumberListPropertyChanged=32]="onNumberListPropertyChanged";ua[ua.onNumberListDisconnect=64]="onNumberListDisconnect";ua[ua.onSlideConnected=
128]="onSlideConnected";ua[ua.onSlideDisconnected=256]="onSlideDisconnected"})(af||(af={}));Object(h.b)("EventNames",af);class de{constructor(){this.E2a=this.graphNode=null;this.AWa=0;this.k6e=null}}Object(h.a)(de,"TileGraphNode",null,[]);class $f{constructor(){this.kuh=this.kYe=this.Gee=this.ceg=0}}Object(h.a)($f,"TileTelemetry",null,[]);var ge;(function(ua){ua[ua.unknown=0]="unknown";ua[ua.activeSlideChanged=1]="activeSlideChanged";ua[ua.shapeSelected=2]="shapeSelected";ua[ua.listLevelChanged=3]=
"listLevelChanged";ua[ua.richEditTextUnicodeChanged=4]="richEditTextUnicodeChanged";ua[ua.shapeChildTopologyChanged=5]="shapeChildTopologyChanged";ua[ua.paragraphDeleted=6]="paragraphDeleted";ua[ua.numberListDeleted=7]="numberListDeleted";ua[ua.numberListPropertyChanged=8]="numberListPropertyChanged";ua[ua.slideAdded=9]="slideAdded";ua[ua.slideDeleted=10]="slideDeleted"})(ge||(ge={}));Object(h.b)("TriggerName",ge);var ze=d(436);class si{constructor(ua,eb,Tb,uc){this.wb=eb;this.ohk=Tb;this.Urk=ua;
this.VGe={};this.ffc={};this.Vb=uc}initialize(){this.Gt()}dispose(){this.Vpa()}onParagraphPropertyChanged(ua,eb){this.Dta(eb,1)}eJb(ua,eb){this.Dta(eb,2)}onActiveSlideDomReady(ua,eb){this.Dta(eb,4)}onShapeChildTopologyChanged(ua,eb){this.Dta(eb,8)}QJa(ua,eb){this.Dta(eb,16)}ich(ua,eb){ua=new ze.a(!1,null,eb.Ba);this.Dta(ua,4)}get Xy(){return this.Urk}get t_(){return this.VGe}get eka(){return this.ffc}Dta(ua,eb){try{if(2===this.Vb.mode&&Object(id.a)(af,eb)in this.VGe){var Tb=Date.now();Object(J.a)(990,
this.VGe[Object(id.a)(af,eb)]).c4(ua,(uc,yd)=>{this.lCk(uc,yd,Tb)})}}catch(uc){sd.a.J(36495880,306,10,"Exception thrown at DetectTiles: "+uc)}}lCk(ua,eb,Tb){if(!Nd.a.Xa(ua))try{for(const uc of ua){if(!nd.a.count(this.ffc)){const $d=new Ce.a(3,1,this.ohk,Object(v.a)(this,this.fireTileEvents,"fireTileEvents"),90,"24");this.wb.Hb($d)}let yd;if(uc.id.toString()in this.ffc)yd=Object(J.a)(de,this.ffc[uc.id.toString()]),yd.AWa=eb;else{const $d=new $f;yd=Object.assign(new de,{graphNode:uc,AWa:eb,E2a:{},k6e:$d});
this.ffc[uc.id.toString()]=yd;this.nAk($d,Tb)}const oe=ge[eb];yd.E2a[oe]=(oe in yd.E2a?yd.E2a[oe]:0)+1}}catch(uc){sd.a.J(36495882,306,10,"Exception thrown at FireTiles: "+uc)}}nAk(ua,eb){ua&&(ua.ceg=eb,ua.Gee=Date.now())}x7g(ua,eb){ua&&(ua.kYe=eb,ua.kuh=Date.now())}k3f(ua){return ua?String.format("GraphDetectDuration: {0}, QueueDuration: {1}, ScanGraphSpaceDuration: {2}",ua.Gee-ua.ceg,ua.kYe-ua.Gee,ua.kuh-ua.kYe):""}}Object(h.a)(si,"TileTriggerControllerBase",null,[991,107]);class sh extends si{constructor(ua,
eb,Tb,uc,yd,oe,$d,ve,hc,Of,Nc,$e,lj){super($d&31,ve,Of,$e);this.AU=ua.yd(12);this.DM=ua.yd(10);this.pa=eb;this.nd=Tb;this.mU=uc;this.R0=yd;this.HU=oe;this.ta=hc;this.NU=Nc;this.usk=lj}Gt(){1===(this.Xy&1)&&(this.AU.fk(Object(v.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.t_[Object(id.a)(af,1)]=this.NU.uOi());2===(this.Xy&2)&&(this.pa.fE(Object(v.a)(this,this.eJb,"onProcessSetSelectionFinished")),this.t_[Object(id.a)(af,2)]=this.NU.vOi());4===(this.Xy&4)&&(this.nd.aT(Object(v.a)(this,
this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.t_[Object(id.a)(af,4)]=this.NU.sOi());8===(this.Xy&8)&&(this.DM.IF(Object(v.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged")),this.t_[Object(id.a)(af,8)]=this.NU.wOi());16===(this.Xy&16)&&(this.AU.ACa(Object(v.a)(this,this.QJa,"onBeforeParagraphDisconnect")),this.t_[Object(id.a)(af,16)]=this.NU.tOi())}Vpa(){this.AU.Om(Object(v.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.pa.Xoa(Object(v.a)(this,
this.eJb,"onProcessSetSelectionFinished"));this.nd.Uoa(Object(v.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.DM.oP(Object(v.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged"));this.AU.gLa(Object(v.a)(this,this.QJa,"onBeforeParagraphDisconnect"))}fireTileEvents(){try{if(this.ta&&this.ta.Ba){var ua=this.ta.Ba.Uj();for(const eb of ua){const Tb=eb.id.toString();Tb in this.eka&&(this.j6b(Object(J.a)(de,this.eka[Tb])),delete this.eka[Tb])}nd.a.forEach(this.eka,
eb=>{delete this.eka[eb]},null)}}catch(eb){sd.a.J(36525510,306,10,"Exception thrown at FireTileEvents: "+eb)}}j6b(ua){if(ua){var eb=Date.now(),Tb=this.HU.A3b(ua.graphNode,ge[ua.AWa]);if(Tb){this.usk?this.R0.execute(yd=>{yd.submit("ShapeTextTile",Tb)}):this.mU.execute(yd=>{yd.SYe(Tb.Topic,Tb.Data,Tb.ContextId)});const uc=ua.k6e;this.x7g(uc,eb);sd.a.J(26007383,306,50,"Fire a tile. LatestTrigger: {0}, TriggerCount: {1}, {2}",ge[ua.AWa],ua.E2a,this.k3f(uc))}}}}Object(h.a)(sh,"ShapeTextTileTriggerController",
si,[]);var dd=d(19),Lc=d(75),Zd=d(41),Ne=d(91),Xc=d(84),lf=d(159),Kh=d(39);class bd{constructor(){this.lcid=this.end=this.start=0;this.noProof=!1}}Object(h.a)(bd,"TextSpan",null,[]);class fd{}Object(h.a)(fd,"AugCharFormat",null,[]);class Ve{}Object(h.a)(Ve,"AugCharFormatRun",null,[]);class rf{}Object(h.a)(rf,"AugDrawingElement",null,[]);class Ag{}Object(h.a)(Ag,"AugDrawingElementMoniker",null,[]);class ne{}Object(h.a)(ne,"AugPara",null,[]);class kf{}Object(h.a)(kf,"AugParaFormat",null,[]);class kg{}
Object(h.a)(kg,"AugParaFormatRun",null,[]);class Af{}Object(h.a)(Af,"AugSlide",null,[]);class Wf{}Object(h.a)(Wf,"AugSlideMoniker",null,[]);class vf{}Object(h.a)(vf,"AugText",null,[]);class De{}Object(h.a)(De,"AugTextTile",null,[]);class Ee{constructor(ua,eb,Tb,uc,yd,oe,$d,ve,hc,Of,Nc,$e){this.Gh=ua;this.jm=eb;this.CEe=Tb;this.Rb=uc;this.gY=yd;this.zc=oe;this.Yl=$d;this.IYa=Nc;this.sad=ve;this.Vic=hc;this.AA=Of;this.Qbd=$e}A3b(ua){if(!ua||!ua.isConnected)return null;var eb=Object(J.a)(118,ua);if(!eb)return null;
let Tb=ua=0;eb=({Ekd:ua,bQc:Tb}=this.OOi(eb)).returnValue;if(!eb)return null;eb=Object.assign(new De,{Id:ud.a.create().toString(),Content:B.c(eb)});sd.a.J(508945997,306,50,"TileId: {0}; ParaCount: {1}; DirtyParaCount: {2};",eb.Id,ua,Tb);return eb}OOi(ua){let eb=0,Tb=0;const uc=[];var yd=ua?ua.Uj():[];for(oe of yd)if(!this.jm.gGa(oe)||this.IYa)if(oe.vd){if(yd=this.zc.ZN(oe))yd=this.Rb.Lc(yd),this.gY.pTc(yd,$d=>{($d=Object(J.a)(130,$d.currentNode))&&!$d.isGhostCell&&({Ekd:eb,bQc:Tb}=this.b3f($d,eb,
Tb,uc));return!0})}else({Ekd:eb,bQc:Tb}=this.b3f(oe,eb,Tb,uc));var oe=eb;yd=Tb;return{returnValue:Object.assign(new Af,{id:ua.id.toString(),mk:Object.assign(new Wf,{sId:ua.sid,cId:ua.cid}),drawingElems:uc,isSlideCritiqueReady:ua.isSlideCritiqueReady,sourceTimestamp:Date.now()}),Ekd:oe,bQc:yd}}b3f(ua,eb,Tb,uc){const yd=[];let oe=0;var $d=this.Rb.Lc(ua);for($d=this.Yl.A3($d,$d.currentNode);$d.moveNext();){var ve=$d.currentNode;ve&&this.Gh.ae(ve)&&ve.Ua(Zd.a.tq)&&(ve=this.o9i(ve))&&(ve.pfRuns&&0<ve.pfRuns.length&&
ve.pfRuns[0].pf.proofingDirty&&oe++,Array.add(yd,ve))}0<yd.length&&(eb+=yd.length,Tb+=oe,ua=Object.assign(new rf,{id:ua.id.toString(),mk:this.m9i(ua),text:Object.assign(new vf,{paragraphs:yd})}),Array.add(uc,ua));return{Ekd:eb,bQc:Tb}}m9i(ua){if(!ua)return null;var eb="";let Tb=0,uc=0;if(Object(dd.a)(130,ua))eb=Object(J.a)(130,ua),uc=3,eb=eb.cellId.toString();else if(Object(dd.a)(4,ua))if(ua=Object(J.a)(4,ua),eb=ua.get_shapeId().toString(),Tb=ua.get_cid(),ua.F4)uc=1;else if(ua.Wf)uc=2;else if(ua.Hx||
ua.rl)uc=4;return Object.assign(new Ag,{id:eb,cId:Tb,type:uc})}o9i(ua){if(!ua)return null;ua=Object(J.a)(Lc.AParagraphNode,ua);if(!ua)return null;var eb=ua.sa(Kh.a.cU,!1);eb=Object.assign(new ne,{id:ua.id.toString(),chars:eb?"":this.Gh.text(ua)});const Tb=this.n9i(ua);Tb&&0<Tb.length&&(eb.pfRuns=Tb);(ua=this.l9i(ua))&&0<ua.length&&(eb.cfRuns=ua);return eb}n9i(ua){const eb=[],Tb=Object(J.a)(Xc.a,this.Vic.cWc(ua));let uc=16,yd="",oe=0,$d=0;if(Tb&&this.Qbd){const ve=this.AA.jab(Tb);if(ve)if(uc=ve.listType,
1===uc)yd=this.sad.yCb(Tb);else if(0===uc){oe=Tb.sa(Kh.a.autonumberBulletType,8);const hc=Object(J.a)(975,this.sad);hc&&($d=hc.jkj(ve,Tb))}}ua=Object.assign(new kg,{pf:Object.assign(new kf,{lvl:this.Gh.Hib(ua),proofingDirty:!ua.sa(lf.a.C4,!1),revisionId:ua.sa(lf.a.o4c,0).toString(),listType:uc,listTag:yd,listNumeration:oe,listElementIndex:$d})});Array.add(eb,ua);return eb}l9i(ua){const eb=[];let Tb=this.Njj(ua);if(0<Tb.count){Tb=this.zqi(this.CEe.bVc(ua),Tb);for(let uc of Tb)ua=uc.end-uc.start,Array.add(eb,
Object.assign(new Ve,{len:ua,cf:Object.assign(new fd,{lang:uc.lcid,noProof:uc.noProof})}))}return eb}Njj(ua){const eb=new z.a,Tb=ua.characterData;let uc=-1,yd=-1,oe=0;for(let $d=0;$d<ua.Ta.length;$d++){const ve=ua.Ta.ga($d).formatting;ve&&(yd=Ne.a.language(ve),-1!==uc&&uc!==yd&&(eb.add(Object.assign(new bd,{start:oe,end:ua.Ta.ga($d).cp,lcid:uc,noProof:!1})),oe=ua.Ta.ga($d).cp),uc=yd)}eb.add(Object.assign(new bd,{start:oe,end:Tb.length,lcid:yd,noProof:!1}));return eb}zqi(ua,eb){if(!ua)return eb;for(const Tb of ua){ua=
!1;for(let uc=0;uc<eb.count;uc++){if(!ua)if(eb.ga(uc).start===Tb.begin)ua=!0,eb.ga(uc).noProof=!0;else if(Tb.begin>eb.ga(uc).start&&Tb.begin<eb.ga(uc).end){eb.insert(uc+1,Object.assign(new bd,{start:Tb.begin,end:eb.ga(uc).end,lcid:eb.ga(uc).lcid,noProof:!0}));ua=!0;eb.ga(uc).end=Tb.begin;continue}if(ua)if(Tb.end>eb.ga(uc).end)eb.ga(uc).noProof=!0;else{if(Tb.end===eb.ga(uc).end){eb.ga(uc).noProof=!0;break}if(Tb.end<eb.ga(uc).end){eb.insert(uc+1,Object.assign(new bd,{start:Tb.end,end:eb.ga(uc).end,
lcid:eb.ga(uc).lcid,noProof:!1}));eb.ga(uc).end=Tb.end;eb.ga(uc).noProof=!0;break}}}}return eb}}Object(h.a)(Ee,"SlideTextTileManager",null,[951,974]);var Jd=d(444);class Og extends si{constructor(ua,eb,Tb,uc,yd,oe,$d,ve,hc,Of,Nc,$e){super(eb&125,Tb,uc,Nc);this.nd=ua;this.NU=yd;this.wqk=oe;this.AU=$d.yd(12);this.DM=$d.yd(10);this.R0=ve;this.ta=hc;this.I0g=Of;this.Xad=$d.yd(22);this.Ea=$e}Gt(){this.Ea.qea||4!==(this.Xy&4)||(this.nd.aT(Object(v.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady")),
this.I0g.Hii(Object(v.a)(this,this.ich,"onTilingModuleLoaded")),this.t_[Object(id.a)(af,4)]=this.NU.IOi());16===(this.Xy&16)&&(this.AU.ACa(Object(v.a)(this,this.QJa,"onBeforeParagraphDisconnect")),this.t_[Object(id.a)(af,16)]=this.NU.LOi());1===(this.Xy&1)&&(this.AU.fk(Object(v.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.t_[Object(id.a)(af,1)]=this.NU.MOi());8===(this.Xy&8)&&(this.DM.IF(Object(v.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged")),
this.t_[Object(id.a)(af,8)]=this.NU.NOi());64===(this.Xy&64)&&(this.Xad.ACa(Object(v.a)(this,this.U7g,"onBeforeNumberListDicsonnect")),this.t_[Object(id.a)(af,64)]=this.NU.JOi());32===(this.Xy&32)&&(this.Xad.fk(Object(v.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged")),this.t_[Object(id.a)(af,32)]=this.NU.KOi())}Vpa(){this.Ea.qea||this.nd.Uoa(Object(v.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.AU.Om(Object(v.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));
this.AU.gLa(Object(v.a)(this,this.QJa,"onBeforeParagraphDisconnect"));this.I0g.n9k(Object(v.a)(this,this.ich,"onTilingModuleLoaded"));this.Xad.gLa(Object(v.a)(this,this.U7g,"onBeforeNumberListDicsonnect"));this.Xad.Om(Object(v.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged"))}U7g(ua,eb){this.Dta(eb,64)}onNumberListPropertyChanged(ua,eb){this.Dta(eb,32)}fireTileEvents(){try{nd.a.forEach(this.eka,ua=>{this.j6b(Object(J.a)(de,this.eka[ua]));delete this.eka[ua]},null)}catch(ua){sd.a.J(508944718,
306,10,"Exception thrown at FireTileEvents: "+ua)}}j6b(ua){if(ua&&this.ta.Ba&&ua.graphNode&&this.ta.Ba.id===ua.graphNode.id){var eb=Date.now(),Tb=this.wqk.A3b(ua.graphNode,ge[ua.AWa]);if(Tb){Object(Db.a)("PPTOAugLoopProofingTelemetry")&&sd.a.J(508944719,375,20,"ALv1: submitting proofing operation");this.R0.execute(yd=>{yd.submit(Jd.a.ruc,Tb)});const uc=ua.k6e;this.x7g(uc,eb);sd.a.J(508944717,306,50,"Fire a tile. LatestTrigger: {0}, TriggerCount: {1}, TileSize: {2}, TileId: {3}, {4}",ge[ua.AWa],ua.E2a,
B.c(Tb).length,Tb.Id,this.k3f(uc))}}}}Object(h.a)(Og,"SlideTextTileTriggerController",si,[]);class Rg{constructor(ua){tb.a.assign(Rg,this,ua)}static getTypeName(){return"AugLoop_Text_TextTile"}static getBaseTypes(){return[]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,[Rg.getTypeName()])}}Rg.H_={T_:Rg.getTypeName(),B_:Rg.getBaseTypes()};class Eg{constructor(ua){tb.a.assign(Eg,this,ua)}static getTypeName(){return"AugLoop_Text_FormattedTextTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,
[Eg.getTypeName()])}}Eg.H_={T_:Eg.getTypeName(),B_:Eg.getBaseTypes()};class xf{constructor(ua){tb.a.assign(xf,this,ua)}static getTypeName(){return"AugLoop_Text_DynamicTextContext"}static getBaseTypes(){return["AugLoop_Core_DynamicContext"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,[xf.getTypeName()])}}xf.H_={T_:xf.getTypeName(),B_:xf.getBaseTypes()};class hd{constructor(ua){tb.a.assign(hd,this,ua)}static getTypeName(){return"AugLoop_Text_TaskTile"}static getBaseTypes(){return["AugLoop_Text_FormattedTextTile",
"AugLoop_Text_TextTile"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,[hd.getTypeName()])}}hd.H_={T_:hd.getTypeName(),B_:hd.getBaseTypes()};class yf{constructor(ua){tb.a.assign(yf,this,ua)}static getTypeName(){return"AugLoop_Text_PersonTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,[yf.getTypeName()])}}yf.H_={T_:yf.getTypeName(),B_:yf.getBaseTypes()};class cd{constructor(ua){tb.a.assign(cd,this,ua)}static getTypeName(){return"AugLoop_Text_DateTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,
[cd.getTypeName()])}}cd.H_={T_:cd.getTypeName(),B_:cd.getBaseTypes()};class cg{constructor(ua){tb.a.assign(cg,this,ua)}static getTypeName(){return"AugLoop_Powerpoint_PowerPointShape"}static getBaseTypes(){return[]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,[cg.getTypeName()])}}cg.H_={T_:cg.getTypeName(),B_:cg.getBaseTypes()};class xh{constructor(ua){tb.a.assign(xh,this,ua)}static getTypeName(){return"AugLoop_Powerpoint_PowerPointSlide"}static getBaseTypes(){return[]}static typeGuard(ua){return tb.a.matchesTypesFor(ua,
[xh.getTypeName()])}}xh.H_={T_:xh.getTypeName(),B_:xh.getBaseTypes()};var Yf;(function(ua){ua[ua.Title=0]="Title";ua[ua.Subtitle=1]="Subtitle";ua[ua.Content=2]="Content";ua[ua.Note=3]="Note";ua[ua.SmartArt=4]="SmartArt";ua[ua.Image=5]="Image";ua[ua.TextBox=6]="TextBox";ua[ua.Table=7]="Table";ua[ua.Chart=8]="Chart";ua[ua.Other=9]="Other"})(Yf||(Yf={}));class Hf{constructor(ua,eb,Tb,uc,yd,oe){this.Rb=ua;this.Yl=eb;this.Gh=uc;this.Ea=Tb;this.Krk=yd;this.oc=oe}A3b(ua){if(!ua||!ua.isConnected)return null;
ua=Object(J.a)(118,ua);if(!ua)return null;var eb=null;const Tb=new z.a;var uc=ua.Uj();for(var yd of uc)(uc=this.l3f(yd,!1))&&Tb.add(uc);(yd=ua.fUa())&&yd.isConnected&&(yd=this.l3f(yd,!0))&&Tb.add(yd);if(0<Tb.count){let oe,$d;if(this.Ea.m5b){eb=ua.yn;yd=this.uUa(ua);try{oe=ua.cid.toString(),$d=ua.sid.toString()}catch(ve){sd.a.J(509203980,822,50,"Exception message: "+ve.message)}eb=new xh({shapes:Tb.toArray(),isSlideHidden:eb,themeId:yd,cid:oe,sid:$d})}}return eb}l3f(ua,eb){if(!ua)return null;var Tb=
this.Rb.Lc(ua),uc=this.Yl.A3(Tb,Tb.currentNode);Tb=null;const yd=new z.a;for(;uc.moveNext();){var oe=uc.currentNode;if(oe&&this.Gh.ae(oe)){oe=Object(J.a)(Lc.AParagraphNode,oe);let ve;ve=this.Ea.qea?this.Izj(oe,this.Gh.text(oe)):this.Gh.text(oe);let hc={};this.Ea.m5b&&(hc=this.Krk.FPk(oe));ve&&(oe=new Eg({content:ve,listType:hc.listType,indentation:hc.indentation,outlineLevel:hc.outlineLevel}),yd.add(oe))}}let $d;this.Ea.m5b&&($d=this.D3i(ua,eb));uc=null;this.Ea.qea&&(uc=eb?"notesNode":ua.get_shapeId().toString());
0<yd.count&&(Tb=new cg({textTiles:yd.toArray(),shapeType:$d,shapeId:uc}));return Tb}Izj(ua,eb){for(let uc=0;uc<ua.Ta.length;uc++){var Tb=ua.Ta.ga(uc);Tb&&Tb.blob&&6==Tb.blob.Bq&&(Tb=Tb.cp,eb=eb.substring(0,Tb)+"\v"+eb.substring(Tb+1,eb.length))}return eb}D3i(ua,eb){if(eb)return Yf.Note;if(!ua)return Yf.Other;switch(ua.Qj){case 0:case 2:return Yf.Title;case 3:return Yf.Subtitle;case 10:return Yf.Table;case 15:return Yf.Image;case 9:case 12:return Yf.Chart;case 8:return this.Trj(ua)}return Yf.Other}Trj(ua){return ua?
0<ua.ede().length?Yf.SmartArt:ua.yea?Yf.Other:ua.Hx?Yf.TextBox:Yf.Content:Yf.Other}uUa(ua){if(!ua)return"";ua=ua.jj;let eb=null;const Tb=this.oc.XI();if(Tb&&0<Tb.length&&ua)for(const uc of Tb)if(uc.Id===ua){eb=uc;break}return eb&&eb.ThemeFamilyId?eb.ThemeFamilyId:""}}Object(h.a)(Hf,"SlideTileManager",null,[974]);class ji extends si{constructor(ua,eb,Tb,uc,yd,oe,$d,ve,hc){super(eb&401,Tb,uc,ve);this.Udd=ua.yd(8);this.AU=ua.yd(12);this.NU=yd;this.xqk=oe;this.R0=$d;this.Ea=hc}Gt(){16===(this.Xy&16)&&
(this.AU.ACa(Object(v.a)(this,this.QJa,"onBeforeParagraphDisconnect")),this.t_[Object(id.a)(af,16)]=this.NU.GOi());1===(this.Xy&1)&&(this.AU.fk(Object(v.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.t_[Object(id.a)(af,1)]=this.NU.HOi());128===(this.Xy&128)&&(this.Udd.hja(Object(v.a)(this,this.onSlideConnected,"onSlideConnected")),this.t_[Object(id.a)(af,128)]=this.NU.EOi());256===(this.Xy&256)&&(this.Udd.h8(Object(v.a)(this,this.onSlideDisconnected,"onSlideDisconnected")),
this.t_[Object(id.a)(af,256)]=this.NU.FOi())}Vpa(){this.AU.Om(Object(v.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.AU.gLa(Object(v.a)(this,this.QJa,"onBeforeParagraphDisconnect"));this.Udd.Woa(Object(v.a)(this,this.onSlideConnected,"onSlideConnected"));this.Udd.hLa(Object(v.a)(this,this.onSlideDisconnected,"onSlideDisconnected"))}onSlideConnected(ua,eb){this.Dta(eb,128)}onSlideDisconnected(ua,eb){this.Dta(eb,256)}fireTileEvents(){try{nd.a.forEach(this.eka,ua=>{this.j6b(Object(J.a)(de,
this.eka[ua]));delete this.eka[ua]},null)}catch(ua){sd.a.J(512496604,306,10,"Exception thrown at FireTileEvents: "+ua)}}j6b(ua){if(ua&&ua.graphNode){var eb=this.xqk.A3b(ua.graphNode,ge[ua.AWa]),Tb=null,uc=Object(J.a)(118,ua.graphNode);if(uc&&!uc.gO&&!uc.PBb){var yd=(this.Ea.qea||this.Ea.QRj)&&Db.a("ALSlideTileIdNewFormat")?uc.sid.toString()+"#"+uc.cid.toString():uc.sid.toString()+uc.cid.toString();uc=["session","doc"];eb=[Object.assign(new fe.a,{id:yd,body:eb,sourceTimestamp:Date.now()})];10===ua.AWa?
"slideAdded"in ua.E2a||(Tb=Object.assign(new Wa,{parentPath:uc,items:eb})):Tb="slideAdded"in ua.E2a?Object.assign(new Ia.a,{parentPath:uc,items:eb}):Object.assign(new Hb.a,{parentPath:uc,items:eb});Tb&&(Db.a("PPTOAugLoopProofingTelemetry")&&sd.a.J(508953108,375,15,"ALv2: submitting operation {0}",Tb.H_.T_),this.R0.execute(oe=>{oe.submitOperation(Tb)}))}}}}Object(h.a)(ji,"SlideTileTriggerController",si,[]);var Qi=d(1252),ah=d(32),Kd;(function(ua){ua[ua.Unspecified=0]="Unspecified";ua[ua.Inline=1]=
"Inline";ua[ua.Floating=2]="Floating"})(Kd||(Kd={}));var Qd;(function(ua){ua[ua.Undefined=0]="Undefined";ua[ua.Bullet=1]="Bullet";ua[ua.Numbered=2]="Numbered";ua[ua.Lim=3]="Lim";ua[ua.Nil=4]="Nil";ua[ua.Any=5]="Any";ua[ua.NoList=6]="NoList";ua[ua.Invalid=7]="Invalid"})(Qd||(Qd={}));var Gg;(function(ua){ua[ua.DontCare=1]="DontCare";ua[ua.Thin=2]="Thin";ua[ua.ExtraLight=3]="ExtraLight";ua[ua.Light=4]="Light";ua[ua.Normal=5]="Normal";ua[ua.Medium=6]="Medium";ua[ua.SemiBold=7]="SemiBold";ua[ua.Bold=8]=
"Bold";ua[ua.ExtraBold=9]="ExtraBold";ua[ua.Heavy=10]="Heavy"})(Gg||(Gg={}));var Sg;(function(ua){ua[ua.NoCaps=0]="NoCaps";ua[ua.SmallCaps=1]="SmallCaps";ua[ua.AllCaps=2]="AllCaps";ua[ua.AllPetiteCaps=3]="AllPetiteCaps";ua[ua.PetiteCaps=4]="PetiteCaps";ua[ua.Unicase=5]="Unicase";ua[ua.Titling=6]="Titling";ua[ua.Other=7]="Other"})(Sg||(Sg={}));var Wh;(function(ua){ua[ua.None=0]="None";ua[ua.Words=1]="Words";ua[ua.SingleLine=2]="SingleLine";ua[ua.DoubleLine=3]="DoubleLine";ua[ua.HeavyLine=4]="HeavyLine";
ua[ua.DottedLine=5]="DottedLine";ua[ua.DottedHeavyLine=6]="DottedHeavyLine";ua[ua.DashLine=7]="DashLine";ua[ua.DashHeavyLine=8]="DashHeavyLine";ua[ua.DashLongLine=9]="DashLongLine";ua[ua.DashLongHeavyLine=10]="DashLongHeavyLine";ua[ua.DotDashLine=11]="DotDashLine";ua[ua.DotDashHeavyLine=12]="DotDashHeavyLine";ua[ua.DotDotDashLine=13]="DotDotDashLine";ua[ua.DotDotDashHeavyLine=14]="DotDotDashHeavyLine";ua[ua.WavyLine=15]="WavyLine";ua[ua.WavyHeavyLine=16]="WavyHeavyLine";ua[ua.WavyDoubleLine=17]="WavyDoubleLine"})(Wh||
(Wh={}));var Bg;(function(ua){ua[ua.Left=0]="Left";ua[ua.Right=1]="Right";ua[ua.Center=2]="Center";ua[ua.Justified=3]="Justified";ua[ua.Other=4]="Other";ua[ua.None=5]="None";ua[ua.JustifyLow=6]="JustifyLow";ua[ua.Distributed=7]="Distributed";ua[ua.ThaiDistributed=8]="ThaiDistributed"})(Bg||(Bg={}));var oh;(function(ua){ua[ua.Image=0]="Image";ua[ua.TextBox=1]="TextBox";ua[ua.Chart=2]="Chart";ua[ua.SmartArt=3]="SmartArt";ua[ua.Drawing=4]="Drawing";ua[ua.EquationObject=5]="EquationObject";ua[ua.Ink=
6]="Ink";ua[ua.InkSpace=7]="InkSpace";ua[ua.InkEndOfLine=8]="InkEndOfLine";ua[ua.LineBreak=9]="LineBreak";ua[ua.PageBreak=10]="PageBreak";ua[ua.PageNumbers=11]="PageNumbers";ua[ua.FootnoteEndnote=12]="FootnoteEndnote";ua[ua.FootnoteEndnoteReferenceMark=13]="FootnoteEndnoteReferenceMark";ua[ua.Tab=14]="Tab";ua[ua.UnsupportedObject=15]="UnsupportedObject";ua[ua.Other=16]="Other"})(oh||(oh={}));var Yj;(function(ua){ua[ua.Initial=0]="Initial";ua[ua.FirstLine=1]="FirstLine";ua[ua.Hanging=2]="Hanging"})(Yj||
(Yj={}));class Gh{constructor(ua,eb){this.AA=ua;this.J$=eb}FPk(ua){const eb={};try{eb.listType=this.vyb(ua),eb.outlineLevel=Pd.ParagraphReader.wWc(ua),eb.indentation=Gh.Yjj(this.J$.c9(ua))}catch(Tb){sd.a.J(509203979,822,50,"Exception message: "+Tb.message)}return eb}vyb(ua){const eb=new ah.GraphIterator;eb.set(ua);eb.sc(11);eb.Kg(11);return(ua=this.AA.Gv(eb))?Gh.lIi(ua.listType):Qd.NoList}static lIi(ua){switch(ua){case 15:return Qd.Any;case 1:return Qd.Bullet;case 42:return Qd.Invalid;case 13:return Qd.Lim;
case 14:return Qd.Nil;case 16:return Qd.NoList;case 0:return Qd.Numbered;default:return Qd.Invalid}}static Yjj(ua){return 2===ua.unit?Math.floor(Qi.a.iJf(ua.value)/20):Math.floor(ua.value/20)}}Object(h.a)(Gh,"TextTileFormatter",null,[952]);var Xh=d(77);class Yg{constructor(){this.l6e="TML";this.xa=new Xh.a}Hii(ua){this.xa.addHandler(this.l6e,ua)}n9k(ua){this.xa.removeHandler(this.l6e,ua)}TZk(ua){this.xa.raiseEvent(this.l6e,ua)}}Object(h.a)(Yg,"TilingEventSource",null,[971,972,973]);class dg{}dg.Iql=
"ShapeTextOnActiveSlideDomReady";dg.Lql="ShapeTextOnSelectionFinished";dg.Kql="ShapeTextOnParagraphPropertyChanged";dg.Mql="ShapeTextOnShapeChildTopologyChanged";dg.Jql="ShapeTextOnParagraphDisconnect";dg.Gyl="SlideTextOnActiveSlideDomReady";dg.Kyl="SlideTextOnParagraphPropertyChanged";dg.Jyl="SlideTextOnParagraphDisconnect";dg.Lyl="SlideTextOnShapeChildTopologyChanged";dg.Iyl="SlideTextOnNumberListPropertyChanged";dg.Hyl="SlideTextOnNumberListDisconnect";dg.Dyl="SlideOnParagraphPropertyChanged";
dg.Cyl="SlideOnParagraphDisconnect";dg.Ayl="SlideOnConnect";dg.Byl="SlideOnDisconnect";Object(h.a)(dg,"DetectStrategyName",null,[]);class Od{constructor(ua){this.HU=ua}get Xy(){return 4}c4(ua,eb){const Tb=[];if((ua=Object(J.a)(ze.a,ua))&&ua.Ba&&(ua=Object(J.a)(118,ua.Ba))){ua=ua.Uj();for(const uc of ua)this.HU.$2b(uc)&&Array.add(Tb,uc);0<Tb.length&&eb(Tb,1)}}}Object(h.a)(Od,"ShapeTextOnActiveSlideDomReadyDetectStrategy",null,[990]);var We=d(254);class Zj{constructor(ua,eb,Tb){this.Ga=ua;this.HU=eb;
this.pa=Tb}get Xy(){return 16}c4(ua,eb){if((ua=Object(J.a)(We.a,ua))&&ua.node&&12===ua.node.type&&(ua=this.Ga.vn(ua.node))&&this.HU.$2b(ua)){var Tb=this.pa.I_();Tb&&Tb.id===ua.id&&(Tb=[],Array.add(Tb,ua),eb(Tb,6))}}}Object(h.a)(Zj,"ShapeTextOnParagraphDisconnectDetectStrategy",null,[990]);var ij=d(42),Wd=d(362);class ki{constructor(ua,eb,Tb){this.Ga=ua;this.HU=eb;this.pa=Tb}get Xy(){return 1}c4(ua,eb){if((ua=Object(J.a)(Wd.a,ua))&&ua.node&&12===ua.node.type){const uc=this.Ga.vn(ua.node);if(uc&&this.HU.$2b(uc)){var Tb=
this.pa.I_();Tb&&Tb.id===uc.id&&(ua.property===ij.a.listLevel?this.$vb(3,uc,eb):ua.property===Zd.a.tq&&this.$vb(4,uc,eb))}}}$vb(ua,eb,Tb){if(eb){var uc=[];Array.add(uc,eb);Tb(uc,ua)}}}Object(h.a)(ki,"ShapeTextOnParagraphPropertyChangedDetectStrategy",null,[990]);var xi=d(860);class Pg{constructor(ua,eb,Tb,uc){this.pa=ua;this.HU=eb;this.d1=Tb;this.qkc=uc}get Xy(){return 2}c4(ua,eb){const Tb=[];if(ua=Object(J.a)(xi.a,ua))if(this.qkc&&this.d1&&this.d1.kFj(ua.vG),!this.pa.s4())this.qkc&&this.d1&&this.d1.WLb();
else if(ua.XE&&ua.XE.length){this.qkc&&this.d1&&this.d1.WLb();ua=this.pa.Xd();for(const uc of ua)this.HU.$2b(uc)&&Array.add(Tb,uc);0<Tb.length&&eb(Tb,2)}}}Object(h.a)(Pg,"ShapeTextOnSelectionFinishedDetectStrategy",null,[990]);var Ej=d(594);class Hh{constructor(ua,eb){this.pa=ua;this.HU=eb}get Xy(){return 8}c4(ua,eb){const Tb=[];if((ua=Object(J.a)(Ej.a,ua))&&ua.node&&10===ua.node.type&&1===ua.yW&&(ua=Object(J.a)(4,ua.node))&&this.HU.$2b(ua)){var uc=this.pa.I_();uc&&uc.get_shapeId()===ua.get_shapeId()&&
(Array.add(Tb,ua),eb(Tb,5))}}}Object(h.a)(Hh,"ShapeTextOnShapeChildTopologyChangedDetectStrategy",null,[990]);class gh{constructor(ua){this.oxg=ua}get Xy(){return 1===this.oxg?128:256}c4(ua,eb){if((ua=Object(J.a)(We.a,ua))&&ua.node&&8===ua.node.type){const Tb=[];Array.add(Tb,ua.node);1===this.oxg?eb(Tb,9):eb(Tb,10)}}}Object(h.a)(gh,"SlideOnConnectOrDisconnectDetectStrategy",null,[990]);class Ie{constructor(ua){this.jc=ua}get Xy(){return 16}c4(ua,eb){if((ua=Object(J.a)(We.a,ua))&&ua.node&&12===ua.node.type){const Tb=
this.jc.mg(ua.node);Tb&&(ua=[],Array.add(ua,Tb),eb(ua,6))}}}Object(h.a)(Ie,"SlideOnParagraphDisconnectDetectStrategy",null,[990]);class eg{constructor(ua){this.jc=ua}get Xy(){return 1}c4(ua,eb){var Tb=Object(J.a)(Wd.a,ua);if(Tb&&Tb.node&&12===Tb.node.type){const uc=this.jc.mg(Tb.node);uc&&Object(J.a)(Lc.AParagraphNode,Tb.node)&&(ua=0,Tb.property===ij.a.listLevel?ua=3:Tb.property===Zd.a.tq&&(ua=4),Tb=[],Array.add(Tb,uc),eb(Tb,ua))}}}Object(h.a)(eg,"SlideOnParagraphPropertyChangedDetectStrategy",null,
[990]);class yi{get Xy(){return 4}c4(ua,eb){if((ua=Object(J.a)(ze.a,ua))&&ua.Ba&&(ua=Object(J.a)(118,ua.Ba))){var Tb=ua.Uj();for(var uc of Tb)if(uc.hasText){uc=[];Array.add(uc,ua);eb(uc,1);break}}}}Object(h.a)(yi,"SlideTextOnActiveSlideDomReadyDetectStrategy",null,[990]);class Fj{constructor(ua,eb){this.jc=ua;this.ta=eb}get Xy(){return 64}c4(ua,eb){if((ua=Object(J.a)(We.a,ua))&&this.ta.Ba&&ua.node&&22===ua.node.type&&(ua=this.jc.mg(ua.node))&&ua.id===this.ta.Ba.id){const Tb=[];Array.add(Tb,ua);eb(Tb,
7)}}}Object(h.a)(Fj,"SlideTextOnNumberListDisconnectDetectStrategy",null,[990]);class Yh{constructor(ua,eb){this.jc=ua;this.ta=eb}get Xy(){return 32}c4(ua,eb){var Tb=Object(J.a)(Wd.a,ua);Tb&&Tb.node&&22===Tb.node.type&&(ua=this.jc.mg(Tb.node))&&this.ta.Ba&&ua.id===this.ta.Ba.id&&Tb.property===Zd.a.Zi&&(Tb=[],Array.add(Tb,ua),eb(Tb,8))}}Object(h.a)(Yh,"SlideTextOnNumberListPropertyChangedDetectStrategy",null,[990]);class ei{constructor(ua,eb,Tb,uc){this.ta=ua;this.jm=eb;this.jc=Tb;this.IYa=uc}get Xy(){return 16}c4(ua,
eb){if((ua=Object(J.a)(We.a,ua))&&ua.node&&this.ta.Ba&&12===ua.node.type){const Tb=this.jc.mg(ua.node);!Tb||Tb.id!==this.ta.Ba.id||this.jm.x9(ua.node)&&!this.IYa||(ua=[],Array.add(ua,this.ta.Ba),eb(ua,6))}}}Object(h.a)(ei,"SlideTextOnParagraphDisconnectDetectStrategy",null,[990]);class Hi{constructor(ua,eb,Tb,uc,yd,oe,$d,ve){this.ta=ua;this.jm=eb;this.jc=Tb;this.Ga=uc;this.IYa=yd;this.d1=$d;this.qkc=ve}get Xy(){return 1}c4(ua,eb){if((ua=Object(J.a)(Wd.a,ua))&&ua.node&&this.ta.Ba&&12===ua.node.type){var Tb=
this.jc.mg(ua.node);if(Tb&&Tb.id===this.ta.Ba.id&&(Tb=Object(J.a)(Lc.AParagraphNode,ua.node))&&(!this.jm.x9(Tb)||this.IYa)){var uc=this.Ga.vn(Tb);uc.Pla||uc.Hx||uc.Wf||uc.vd||!uc.rl||!this.qkc||(this.d1.settings.hQe=!0,this.d1.IJl(Tb));ua.property===ij.a.listLevel?this.$vb(3,this.ta.Ba,eb):ua.property===Zd.a.tq?this.$vb(4,this.ta.Ba,eb):ua.property===lf.a.C4&&(Tb.sa(lf.a.C4,!1)||this.$vb(4,this.ta.Ba,eb))}}}$vb(ua,eb,Tb){if(eb){var uc=[];Array.add(uc,eb);Tb(uc,ua)}}}Object(h.a)(Hi,"SlideTextOnParagraphPropertyChangedDetectStrategy",
null,[990]);class yh{constructor(ua,eb){this.ta=ua;this.jc=eb}get Xy(){return 8}c4(ua,eb){ua=Object(J.a)(Ej.a,ua);this.ta.Ba&&ua&&ua.node&&10===ua.node.type&&1===ua.yW&&(ua=Object(J.a)(4,ua.node))&&(ua=this.jc.mg(ua))&&ua.id===this.ta.Ba.id&&(ua=[],Array.add(ua,this.ta.Ba),eb(ua,5))}}Object(h.a)(yh,"SlideTextOnShapeChildTopologyChangedDetectStrategy",null,[990]);class La{constructor(ua,eb,Tb,uc,yd,oe,$d,ve,hc){this.jc=ua;this.Ga=eb;this.kb=Tb;this.HU=uc;this.ta=yd;this.jm=oe;this.Ea=$d;this.Nv=ve;
this.d1=hc}ygj(ua){if(Nd.a.Xa(ua))return 0;let eb=0;for(const Tb of ua)eb|=this.Obl(Tb);return eb}Agj(ua){if(Nd.a.Xa(ua))return 0;let eb=0;for(const Tb of ua)eb|=this.Qbl(Tb);return eb}zgj(ua){if(Nd.a.Xa(ua))return 0;let eb=0;for(const Tb of ua)eb|=this.Pbl(Tb);return eb}uOi(){return new ki(this.Ga,this.HU,this.kb)}vOi(){return new Pg(this.kb,this.HU,this.d1,this.Ea.Yoc)}sOi(){return new Od(this.HU)}wOi(){return new Hh(this.kb,this.HU)}tOi(){return new Zj(this.Ga,this.HU,this.kb)}IOi(){return new yi}LOi(){return new ei(this.ta,
this.jm,this.jc,this.Ea.pptNotesInSlideTextTileIsEnabled)}MOi(){return new Hi(this.ta,this.jm,this.jc,this.Ga,this.Ea.pptNotesInSlideTextTileIsEnabled,this.Nv,this.d1,this.Ea.Yoc)}NOi(){return new yh(this.ta,this.jc)}KOi(){return new Yh(this.jc,this.ta)}JOi(){return new Fj(this.jc,this.ta)}GOi(){return new Ie(this.jc)}HOi(){return new eg(this.jc)}FOi(){return new gh(2)}EOi(){return new gh(1)}Obl(ua){return ua===dg.Kql?1:ua===dg.Lql?2:ua===dg.Iql?4:ua===dg.Mql?8:ua===dg.Jql?16:0}Qbl(ua){return ua===
dg.Gyl?4:ua===dg.Jyl?16:ua===dg.Kyl?1:ua===dg.Lyl?8:ua===dg.Iyl?32:ua===dg.Hyl?64:0}Pbl(ua){return ua===dg.Cyl?16:ua===dg.Dyl?1:ua===dg.Ayl?128:ua===dg.Byl?256:0}}Object(h.a)(La,"TilingFactory",null,[953]);class sb extends Sys.EventArgs{constructor(ua){super();this.Ba=ua}}Object(h.a)(sb,"TilingModuleLoadEventArgs",Sys.EventArgs,[]);class Ob{constructor(){this.K=null;this.aGe=this.Pte=!1}get name(){return"PowerPointWebEditor.ContentUpdateDetection"}Yb(ua){this.K=ua;ua.register(Yg,"PowerPointWebEditor.ContentUpdateDetection.TilingEventSource").as("PowerPointWebEditor.ContentUpdateDetection.ITilingEventNotifier").as("PowerPointWebEditor.ContentUpdateDetection.ITilingEventHandlers").as("PowerPointWebEditor.ContentUpdateDetection.ITilingEventSource").ma().oa(()=>
new Yg);ua.register(950,"PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager").ma().oa(()=>new vc(ua.resolve("Box4.Graph.IGraphIteratorFactory"),ua.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),ua.resolve("PowerPointWebEditor.IShapeReader"),ua.resolve("Box4.IParagraphReader")));ua.register(951,"PowerPointWebEditor.ContentUpdateDetection.ISlideTextTileManager").ma().oa(()=>new Ee(ua.resolve("Box4.IParagraphReader"),ua.resolve("PowerPointWebEditor.Graph.INotesReader"),ua.resolve("Box4.Proofing.IProofingTextUtility"),
ua.resolve("Box4.Graph.IGraphIteratorFactory"),ua.resolve("Box4.ITableNavigator"),ua.resolve("PowerPointWebEditor.Graph.ITableReader"),ua.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),ua.resolve("Box4.IListMarkerUtility"),ua.resolve("PowerPointWebEditor.IPPTParagraphReader"),ua.resolve("Box4.List.IListReader"),ua.resolve("PowerPointWebEditor.IApplicationSettings").pptNotesInSlideTextTileIsEnabled,ua.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTopologyAndListInfoInSlideTileIsEnabled));
ua.register(952,"PowerPointWebEditor.ContentUpdateDetection.ITextTileFormatter").ma().oa(()=>new Gh(ua.resolve("Box4.List.IListReader"),ua.resolve("Box4.IParagraphIndentationReader")));ua.register(Hf,"PowerPointWebEditor.ContentUpdateDetection.SlideTileManager").ma().oa(()=>new Hf(ua.resolve("Box4.Graph.IGraphIteratorFactory"),ua.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),ua.resolve("PowerPointWebEditor.IApplicationSettings"),ua.resolve("Box4.IParagraphReader"),ua.resolve("PowerPointWebEditor.ContentUpdateDetection.ITextTileFormatter"),
ua.resolve("PowerPointWebEditor.IPresentationReader")));ua.register(953,"PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").ma().oa(()=>new La(ua.resolve("PowerPointWebEditor.ISlideReader"),ua.resolve("PowerPointWebEditor.IShapeReader"),ua.resolve("PowerPointWebEditor.IPptSelectionManager"),ua.resolve("PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager"),ua.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ua.resolve("PowerPointWebEditor.Graph.INotesReader"),ua.resolve("PowerPointWebEditor.IApplicationSettings"),
ua.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),ua.resolve("PowerPointWebEditor.TextPrediction.ITextPredictionHandler")));ua.register(sh,"PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").ma().oa(()=>new sh(ua.resolve("Box4.Graph.IGraphInstance"),ua.resolve("PowerPointWebEditor.IPptSelectionManager"),ua.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),ua.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),ua.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),
ua.resolve("PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager"),ua.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").ygj(ua.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTileDetectStrategyList),ua.resolve("Common.ITaskManager"),ua.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ua.resolve("PowerPointWebEditor.IApplicationSettings").powerPointFireTileEventsIntervalInMilliseconds,ua.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),
ua.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),ua.resolve("PowerPointWebEditor.IApplicationSettings").replaceObjectUseClientAL));ua.register(Og,"PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").ma().oa(()=>new Og(ua.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),ua.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").Agj(ua.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTileDetectStrategyList),ua.resolve("Common.ITaskManager"),
ua.resolve("PowerPointWebEditor.IApplicationSettings").powerPointFireSlideTileEventsIntervalInMilliseconds,ua.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),ua.resolve("PowerPointWebEditor.ContentUpdateDetection.ISlideTextTileManager"),ua.resolve("Box4.Graph.IGraphInstance"),ua.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),ua.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ua.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingEventHandlers"),
ua.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),ua.resolve("PowerPointWebEditor.IApplicationSettings")));ua.register(ji,"PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").ma().oa(()=>new ji(ua.resolve("Box4.Graph.IGraphInstance"),ua.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").zgj(ua.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTileDetectStrategyList),ua.resolve("Common.ITaskManager"),ua.resolve("PowerPointWebEditor.IApplicationSettings").powerPointFireSlideTileEventsIntervalInMilliseconds,
ua.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),ua.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileManager"),ua.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),ua.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),ua.resolve("PowerPointWebEditor.IApplicationSettings")))}MZf(){return Db.a("AL.SendSlideTile")}init(){const ua=this.K.resolve("Common.IAppSettingsManager");ua.ff(()=>{this.Pte=ua.ka("497");this.aGe=ua.ka("810")||ua.ka("809");this.Pte&&
(ua.ka("473")&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").initialize(),(this.aGe||this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointInfraredMakeItVisualEnabled)&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").initialize(),this.MZf()&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").initialize());this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingEventNotifier").TZk(new sb(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba))})}dispose(){this.Pte&&
(this.K.resolve("Common.IAppSettingsManager").ka("473")&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").dispose(),(this.aGe||this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointInfraredMakeItVisualEnabled)&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").dispose(),this.MZf()&&(Db.a("PPTOnline.BugFix-7758356")?this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").dispose():
this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").initialize()))}static main(){n.a.instance.Ac(new Ob)}}Object(h.a)(Ob,"PPTWebEditorContentUpdateDetectionPackage",null,[2,3]);var pc=d(1050),Kc=d(656),Gd=d(141),he=d(154),Ue=d(535),Rf=d(111),sf=d(48);class ag{constructor(ua,eb,Tb,uc,yd,oe,$d,ve){this.type="EditorPaneProps";this.critiqueCountInclusiveness=this.critiqueCountClarity=this.critiqueCountConciseness=this.critiqueCountVocabulary=this.critiqueCountPunctuationConvention=
this.critiqueCountFormality=this.critiqueCountGrammar=this.critiqueCountSpelling=null;this.critiqueCountSpelling=ua;this.critiqueCountGrammar=eb;this.critiqueCountFormality=Tb;this.critiqueCountPunctuationConvention=uc;this.critiqueCountVocabulary=yd;this.critiqueCountConciseness=oe;this.critiqueCountClarity=$d;this.critiqueCountInclusiveness=ve}}Object(h.a)(ag,"EditorPaneProps",null,[]);class xg{constructor(ua,eb,Tb,uc,yd,oe,$d,ve,hc,Of,Nc,$e,lj,th,Ig){this.Ab=!1;this.gXd=320;this.XYa=!1;this.sba=
{};if(!ua)throw Error.argumentNull("pptSelectionManager");if(!eb)throw Error.argumentNull("appFrame");if(!Tb)throw Error.argumentNull("actionManager");if(!uc)throw Error.argumentNull("focusManager");if(!yd)throw Error.argumentNull("editorPane");if(!$d)throw Error.argumentNull("graphOperationEventHandler");if(!ve)throw Error.argumentNull("viewElementEventHandlers");if(!hc)throw Error.argumentNull("viewEventSource");if(!Of)throw Error.argumentNull("pageView");if(!$e)throw Error.argumentNull("workspace");
if(!lj)throw Error.argumentNull("loadScript");if(!Ig)throw Error.argumentNull("graphTopologyManager");lj("powerpoint-editor-intl").then(()=>{this.XYa=!0}).catch(wk=>{sd.a.J(512267606,801,10,"Failed to load powerpoint-editor-intl "+wk.toString())});this.Vb=eb;this.ia=Tb;this.Eue=th;this.Fa=uc;this.Rf=$d;this.nd=ve;this.Ic=hc;this.R0=Nc;this.ta=Ig;this.Rf.FI(this.TJa.bind(this));this.Rf.zCa(this.TJa.bind(this));this.Ic.LQa(this.TJa.bind(this));this.nd.DCa(this.TJa.bind(this));this.Vb.GI(this.zu.bind(this));
this.initialize()}initialize(){this.R0.execute(ua=>{ua.addEventHandler(Ue.a.QMc,this.UAj.bind(this))})}dispose(){this.Rf.s6(this.TJa.bind(this));this.Rf.z0a(this.TJa.bind(this));this.Ic.ekb(this.TJa.bind(this));this.nd.gkb(this.TJa.bind(this));this.Vb.IY(this.TJa.bind(this))}vb(){this.ia.ra(Oa.a.Qlb,Nf.a.application,this.Qlb.bind(this),4);this.ia.ra(Oa.a.Hmd,Nf.a.application,this.Hmd.bind(this),96)}pe(){}TJa(){this.Ab&&this.hl(!0)}zu(ua){1===ua.mode&&this.Ab&&(this.Ab=!1,this.Iq(),this.Fa.tj(sf.a.MW,
this.Ab))}Hmd(ua,eb,Tb,uc,yd){(ua=Object(J.a)(Rf.a,yd))&&ua.Hf(this.Ab);return 32}Qlb(ua,eb,Tb){return this.XYa?1===Tb?32:2===Tb?(this.Ab=!this.Ab,he.b("EditorPaneActor::ShowHideEditorPane PaneOpen: ",this.Ab.toString(),ua,()=>{this.Ab?this.hl():this.Iq();return 32})):8:8}hl(ua=!1){const eb=this.fA(),Tb=Object.assign(new Kc.a,{title:"Editor Pane",hideHeader:!1,width:this.gXd,location:2,contentProps:eb,onOpen:()=>{},onClose:()=>{this.Ab=!1},isModernPane:!0});Gd.UISurfaces.Gq().then(uc=>{ua?uc.updateTaskPane(sf.a.MW,
Tb):uc.showTaskPane(sf.a.MW,Tb);return null}).catch(uc=>{sd.a.J(512267605,822,10,"EditorPaneActor::ShowPane, Failed to show editor pane. Exception: "+uc.toString())})}Iq(){Gd.UISurfaces.Gq().then(ua=>{ua.hideTaskPane(sf.a.MW,2);return null}).catch(ua=>{sd.a.J(512267604,822,10,"EditorPaneActor::HidePane, Failed to hide editor pane. Exception: "+ua.toString())})}fA(){let ua=0,eb=0,Tb=0,uc=0,yd=0,oe=0,$d=0,ve=0;const hc=this.ta.Ba?this.ta.Ba.cid:void 0;hc&&this.sba[hc]&&Object.keys(this.sba[hc]).forEach(Of=>
{this.sba[hc][Of].forEach(Nc=>{switch(Nc.CategoryTitle){case "Spelling":ua+=1;break;case "Grammar":eb+=1;break;case "Conciseness":oe+=1;break;case "Formality":Tb+=1;break;case "PunctuationConventions":uc+=1;break;case "Clarity":$d+=1;break;case "Inclusiveness":ve+=1;break;case "Vocabulary":yd+=1;break;default:sd.a.J(509727769,822,50,"Unknown Critique Type: "+Nc.CategoryTitle)}})});return new ag(ua,eb,Tb,uc,yd,oe,$d,ve)}JNl(ua,eb){const Tb={};Object.keys(ua).forEach(uc=>{this.sba[eb]?(Object.keys(this.sba[eb]).includes(uc),
this.sba[eb][uc]=ua[uc]):(Tb[uc]=ua[uc],this.sba[eb]=Tb)})}UAj(ua,eb,Tb,uc){eb&&uc&&(ua=JSON.parse(eb.Content),uc=this.Eue.KNc(uc.critiques),eb=this.ta.Ba.cid,null!=uc&&0<uc.length?this.JNl(this.Pbj(uc),eb):0==uc.length&&this.sba[eb]&&this.sXi(ua.drawingElems,eb),this.sba[eb]&&this.Q6k(ua.drawingElems,eb),this.hl(!0))}Q6k(ua,eb){const Tb=Object.keys(this.sba[eb]),uc=this.Fvj(ua);Tb.forEach(yd=>{uc.includes(yd)||delete this.sba[eb][yd]})}Fvj(ua){const eb=[];ua.forEach(Tb=>{0<Tb.text.paragraphs.length&&
Tb.text.paragraphs.forEach(uc=>{eb.push(uc.id)})});return eb}sXi(ua,eb){ua.forEach(Tb=>{0<Tb.text.paragraphs.length&&this.yzi(Tb.text.paragraphs,eb)})}yzi(ua,eb){ua.forEach(Tb=>{this.sba[eb][Tb.id]&&(Tb.pfRuns[0].pf.proofingDirty||""==Tb.chars)&&delete this.sba[eb][Tb.id]})}Pbj(ua){const eb={};if(ua)for(const Tb of ua)Tb.TileId in eb?Array.add(eb[Tb.TileId],Tb):eb[Tb.TileId]=[Tb];return eb}}Object(h.a)(xg,"DexLitePaneActor",null,[107,251]);class Tg{constructor(){this.xa=new Xh.a}nTe(ua){this.xa.raiseEvent("OnEditorConsistencyCritiqueOnActiveSlide",
ua)}izf(ua){this.xa.addHandler("OnEditorConsistencyCritiqueOnActiveSlide",ua)}}Object(h.a)(Tg,"EditorRuntimeEventSource",null,[964,965,966]);var li=d(16),Li=d(51),Le=d(702),Ih=d(35);class bj{constructor(ua,eb){this.paragraph=ua;this.critiqueId=eb}}Object(h.a)(bj,"CritiqueToHighlight",null,[]);class zh{constructor(ua,eb,Tb,uc,yd,oe,$d,ve,hc,Of){this.ffa=ua;this.Ofk=eb;this.ta=Tb;this.oD=uc;this.Eb=yd;this.BJ=oe;this.pa=$d;this.dve=ve;this.Fa=hc;this.yhk=Of;this.ffa.yUe(this.Ofk)}gZc(ua){ua.length?
(ua=this.hnj(ua),ua.length&&(ua=Object.assign(new Le.a,{action:0,type:2,gea:ua,mjb:this.ffa.bdb?this.ffa.bdb.gea:null}),this.ffa.esd(ua))):this.dSi()}dSi(){var ua=this.ffa.bdb?this.ffa.bdb.gea:null;ua=Object.assign(new Le.a,{action:1,type:2,gea:ua,mjb:ua});this.ffa.esd(ua)}hnj(ua){const eb=[];if(!this.dve.isEnabled(2))return eb;var Tb=this.ta.Ba;if(Tb&&Tb.isSlideCritiqueReady){var uc=Tb.jMa;if(!uc.count)return this.yse(2),eb;Tb=0;for(let oe of uc)if(uc=Object(J.a)(Lc.AParagraphNode,oe)){var yd=this.Aae(uc);
for(const $d of yd)yd=Object(J.a)(295,$d.Eh),yd.ON&&Array.contains(ua,yd.ON.TraceId)&&(Tb++,yd=new bj(uc,yd.ON.TraceId),Array.add(eb,yd))}Tb!==ua.length&&this.Lse(2,Tb,ua.length)}else this.Hse(2,Tb);return eb}AHh(ua){if(!this.dve.isEnabled(3))return!1;var eb=this.ta.Ba;if(eb&&eb.isSlideCritiqueReady){eb=eb.jMa;if(!eb.count)return this.yse(3),!1;let Tb=0;const uc=this.Eb.xd(15,void 0,()=>{this.ghh()});try{let yd=!1;uc.hc(eb.ga(0));uc.fd=Ih.a.Svd;for(let oe of eb){const $d=Object(J.a)(Lc.AParagraphNode,
oe);if($d){const ve=new z.a,hc=this.Aae($d);for(const Of of hc){const Nc=Object(J.a)(295,Of.Eh);if(Nc.ON&&ua.Fb(Nc.ON.TraceId)){const $e=ua.ga(Nc.ON.TraceId);let lj;try{lj=Nc.ON.Suggestions[$e].Text;const th=new li.a(Of,lj);ve.add(th);yd||(Nc.UMa(this.Qtk($e)),yd=!0);Tb++}catch(th){sd.a.J(38843398,375,10,"Take suggestion: Parse failed with exception: {0}",th)}}}ve.count&&(ve.Sc((Of,Nc)=>Nc.key.begin-Of.key.begin),this.p$k($d,ve))}}Tb!==ua.count&&this.Lse(3,Tb,ua.count)}finally{uc&&uc.dispose()}}else return this.Hse(3,
eb),!1;return!0}Qtk(ua){switch(ua){case 0:return Ih.a.Pza;case 1:return Ih.a.Qza;case 2:return Ih.a.Rza;case 3:return Ih.a.BMa;case 4:return Ih.a.CMa;default:return 0}}p$k(ua,eb){for(let Tb of eb)this.BJ.replaceTextRange(Li.a.createTextRange(ua,0<Tb.key.begin?Tb.key.begin:0,Tb.key.end),Tb.value,!0,!1)}ignoreCritiques(ua,eb){if(!this.dve.isEnabled(eb))return!1;var Tb=this.ta.Ba;if(Tb&&Tb.isSlideCritiqueReady){var uc=Tb.jMa;if(!uc.count)return this.yse(eb),!1;this.ghh();Tb=!1;let yd=0;for(let oe of uc)if(uc=
Object(J.a)(Lc.AParagraphNode,oe)){uc=this.Aae(uc);for(const $d of uc)uc=Object(J.a)(295,$d.Eh),uc.ON&&Array.contains(ua,uc.ON.TraceId)&&(uc.vFa=!0,Tb||(uc.UMa(Ih.a.$ge),Tb=!0),yd++)}yd!==ua.length&&this.Lse(eb,yd,ua.length)}else return this.Hse(eb,Tb),!1;return!0}Aae(ua){return this.oD.TF(ua,eb=>{eb=Object(J.a)(295,eb.Eh);return!!eb&&5===eb.proofingType&&!eb.vFa})}yse(ua){sd.a.J(38843400,375,15,"{0}: No slide critique in active slide. Skipping",ua)}Lse(ua,eb,Tb){sd.a.J(38843402,375,15,"{0}: ErrorRange number mismatch. Actual: {1}, expected: {2}",
ua,eb,Tb)}Hse(ua,eb){sd.a.J(38843404,375,15,"{0}: Active slide is null or slide critiques are not ready. Active slide null: {1}",ua,!!eb)}ghh(){this.pa.au();this.pa.kj();this.yhk&&this.Fa.vf(sf.a.vg,!0)}}Object(h.a)(zh,"ConsistencyCheckActor",null,[932]);var jj=d(316),Sh=d(99),ya=d(928),Ra=d(699),hb=d(50),Eb=d(700),Yb=d(701);class Nb extends Ra.a{constructor(ua,eb){super();this.G7c=[ya.a.PJe,ya.a.A4c,ya.a.lqd,ya.a.RKc];this.ta=ua;this.Ujk=eb;this.Fze=[new Eb.a("InconsistentCritiquesHighlight",null),
new Eb.a("InconsistentCritiquesLeftSidebar",null),new Eb.a("InconsistentCritiquesRightSidebar",null)]}get Hzb(){return this.Ujk}get Ege(){return this.Fze}bac(ua,eb){ua=Object(dd.a)(Array,ua)?Array.isArray(ua)?ua:null:null;if(!ua||0<ua.length&&!Object(J.a)(bj,ua[0]))return eb;const Tb=new hb.GraphTransaction(3);try{Tb.ld(this.ta.presentation);for(const uc of ua)Yb.b(uc.paragraph),eb.add(uc.paragraph)}finally{Tb&&Tb.dispose()}return eb}Rmc(ua,eb){if(this.Hzb&&this.N_&&this.N_.Vja&&this.N_.Vja.gea&&
2===this.N_.Vja.type){var Tb=[],uc=[];this.cgh(this.N_.Vja.gea,Tb,uc);var yd=[];this.cgh(this.N_.Vja.mjb,null,yd);eb=eb.querySelectorAll("*");for(let oe=0;oe<eb.length;oe++){let $d="",ve="";const hc=eb[oe];for(let Of=0;Of<this.G7c.length;Of++)jj.a.ze(hc,this.G7c[Of])&&(ve=this.G7c[Of],$d=jj.a.ze(hc,this.G7c[Of]));$d.length&&2===this.N_.Vja.type&&(0===this.N_.Vja.action?Array.contains(uc,ua)&&Array.contains(Tb,$d)?this.XIj(hc,ve):this.Lod(hc):1===this.N_.Vja.action&&Array.contains(yd,ua)&&this.Lod(hc))}}}XIj(ua,
eb){Sh.a.QI(ua,"InconsistentCritiquesHighlight");switch(eb){case ya.a.A4c:Sh.a.QI(ua,"InconsistentCritiquesLeftSidebar");break;case ya.a.lqd:Sh.a.QI(ua,"InconsistentCritiquesRightSidebar");break;case ya.a.RKc:Sh.a.QI(ua,"InconsistentCritiquesLeftSidebar"),Sh.a.QI(ua,"InconsistentCritiquesRightSidebar")}}cgh(ua,eb,Tb){if(ua)for(const uc of ua)Array.add(Tb,uc.paragraph),eb&&Array.add(eb,uc.critiqueId)}}Object(h.a)(Nb,"CritiquesHighlightActor",Ra.a,[]);class ed{}Object(h.a)(ed,"Critique",null,[]);class zd{}
Object(h.a)(zd,"Suggestion",null,[]);class Hd{wNf(ua,eb){if(!ua)return[];const Tb=Array(ua.length);for(let uc=0;uc<ua.length;uc++)Tb[uc]=eb(ua[uc]);return Tb}SHi(ua){return Object.assign(new ed,{critiqueId:ua.TraceId,typeId:ua.TypeId,tag:ua.Tag,bucketId:ua.BucketId,paragraphId:ua.TileId,start:ua.Start,length:ua.Length,categoryTitle:ua.CategoryTitle,explanationTitle:ua.ExplanationTitle,explanationLabel:ua.ExplanationLabel,explanation:ua.Explanation,suggestions:this.wNf(ua.Suggestions,Object(v.a)(this,
this.THi,"convertBox4Suggestion"))})}THi(ua){return Object.assign(new zd,{text:ua.Text,description:ua.Description,bucketId:ua.BucketId,numberOfInstances:ua.NumberOfInstances})}}Object(h.a)(Hd,"DataContractMapper",null,[935]);class ba extends Sys.EventArgs{constructor(ua){super();this.instanceId=ua}}Object(h.a)(ba,"PaneClosedEventArgs",Sys.EventArgs,[]);var Aa=d(192);class Pa{constructor(ua,eb,Tb,uc,yd,oe,$d,ve){this.ia=ua;this.Oc=eb;this.Ic=Tb;this.hwe=uc;this.QFb=yd;this.nEb=oe;this.Pze=$d;this.xsk=
ve;this.Le=0;this.Oc.execute(hc=>{hc.cJc(Object(v.a)(this,this.ZJa,"onPaneClosed"))})}get state(){return this.Le}ftd(ua){this.Le!==ua&&(this.Le=ua,this.Ic.Py(new Aa.a(1)))}Sch(ua){0===this.state&&(sd.a.J(36966754,375,50,"[EditorPane] Begin opening Editor pane, reason: {0} Time: {1}",ua,(new Date).getTime()),this.ftd(1),ua={},ua.ZA=ResourceStrings.L_EditorPaneTitle,ua.assetId=this.QFb.getAssetId(),ua.c6=Object(v.a)(this,this.mib,"onPaneRendered"),ua.nonPersistedSettings={},ua.nonPersistedSettings.IdeasEnabled=
this.Pze.toString(),ua.c$e=this.xsk,32!==this.ia.Ka(Oa.a.Oga,2,ua)&&(sd.a.J(36966784,375,15,"[EditorPane] Failed to open Editor pane"),this.ftd(0)))}aH(ua){if(2===this.state){var eb=this.QFb.$Ta();eb&&(sd.a.J(36966786,375,50,"[EditorPane] Begin closing Editor pane, reason: {0}",ua),32!==this.ia.Ka(Oa.a.Vub,2,eb)&&sd.a.J(36966788,375,15,"[EditorPane] Failed to close Editor pane"))}}ZJa(ua,eb){2===this.state&&eb&&(ua=eb.instanceId)&&ua.length&&(eb=this.QFb.$Ta(),eb!==ua&&eb||(sd.a.J(37626588,375,50,
"[EditorPane] Pane closed"),this.hwe.HYk(new ba(ua)),this.ftd(0),this.nEb.sessionEnd()))}mib(){const ua=this.QFb.$Ta();1!==this.state?sd.a.J(37626590,375,15,"[EditorPaneActor] Received pane rendered event even though we weren't in opening state. Instance id={0}",ua):(sd.a.J(37626592,375,50,"[EditorPane] Pane rendered. Instance id={0}",ua),this.ftd(2),this.nEb.Fil())}}Object(h.a)(Pa,"EditorPane",null,[937]);class ub{constructor(ua,eb){this.type=0;this.id=null;this.type=ua;this.id=eb}static gnb(ua){return ua.id&&
ua.id.toString().length&&Object(dd.a)(Number,ua.type)?new ub(ua.type,ua.id.toString()):null}}Object(h.a)(ub,"Message",null,[]);var Lb=d(3);class Mb{constructor(ua,eb,Tb,uc,yd,oe,$d,ve,hc,Of,Nc,$e,lj,th,Ig,wk){this.X5d=new pc.a;this.ia=ua;this.y0=eb;this.JDb=Tb;this.cCg=uc;this.z0=yd;this.aOg=oe;this.jM=$d;this.hwe=ve;this.ta=hc;this.mna=Of;this.Sdd=Nc;this.el=$e;this.Cgk=lj;this.Ic=th;this.Ihk=Ig;this.oc=wk;this.LRc=new pc.a(0);this.LRc.add(0,2001);this.LRc.add(1,2002);this.LRc.add(2,2003)}vb(){this.ia.ra(Oa.a.GPe,
Nf.a.application,Object(v.a)(this,this.YVf,"editorPaneButtonClicked"),4);this.ia.ra(Oa.a.mSe,Nf.a.application,Object(v.a)(this,this.jjh,"queryEditorPaneButton"),96);this.ia.ra(Oa.a.DQk,Nf.a.application,Object(v.a)(this,this.YVf,"editorPaneButtonClicked"),4);this.ia.ra(Oa.a.nSe,Nf.a.application,Object(v.a)(this,this.jjh,"queryEditorPaneButton"),96);this.ia.ra(Oa.a.FPe,Nf.a.application,Object(v.a)(this,this.ZVf,"editorPaneExtenal"),4);this.ia.ra(Oa.a.Dgh,Nf.a.application,Object(v.a)(this,this.ZVf,"editorPaneExtenal"),
4);this.cCg.aTd(Object(v.a)(this,this.OCk,"onEditorPaneMessageReceived"));this.mna.x7a(Object(v.a)(this,this.l1,"onSlidePresenceChanged"));this.Sdd.fk(Object(v.a)(this,this.toa,"onSlidePropertyChanged"));this.el.FI(Object(v.a)(this,this.YB,"onActiveSlideChanged"));this.hwe.whi(Object(v.a)(this,this.ZJa,"onPaneClosed"))}pe(){}ZVf(ua,eb,Tb){if(1===Tb)return 32;switch(ua){case Oa.a.FPe:this.y0.Sch(2);break;case Oa.a.Dgh:this.y0.aH(2);break;default:return sd.a.J(38412318,375,10,"[EditorPaneActor] Unsupported actionId: {0}",
ua),16}return 32}YVf(ua,eb,Tb){if(1===Tb)return this.oc.Cj()?32:16;switch(this.y0.state){case 0:return this.y0.Sch(1),32;case 2:return this.y0.aH(1),32;case 1:return sd.a.J(37626594,375,50,"[EditorPaneActor] User double clicked to open pane before it was rendered"),this.Ic.Py(new Aa.a(1)),32;default:return sd.a.J(36966800,375,10,"[EditorPaneActor] Unsupported EditorPaneState"),16}}jjh(ua,eb,Tb,uc,yd){if(!yd||!Object(dd.a)(Rf.a,yd))return 8;yd.Hf(2===this.y0.state||1===this.y0.state);return 32}OCk(ua,
eb){this.PCk(eb)}PCk(ua){const eb=this.z0.YSi(ua.message);if(eb){var Tb;({value:Tb}=this.aOg.wg(eb.type)).returnValue||(Tb=this.aOg.ga(0));var uc=Tb.process(ua,eb);uc.continueWith(()=>{const yd=uc.result,oe=this.z0.KWf(yd);this.sendMessage(ua.instanceId,oe);this.Fbk(ua,eb,yd)})}else sd.a.J(37025985,375,15,"[EditorPaneActor] OnEditorPaneMessageReceived, can't deserialize message."),Lb.Task.qt(!1)}oTe(ua){this.X5d.Fb(ua)||this.X5d.$(ua,this.Ihk.K0d(200,()=>{const eb=this.JDb.Itj(ua);if(eb.length){var Tb=
new ub(this.LRc.ga(ua),Ib.a.create().toString());Tb=this.z0.KWf(Tb);this.yhl(eb,Tb)}this.Cgk.nTe(ua)}));this.X5d.ga(ua).perform()}yhl(ua,eb){for(const Tb of ua)this.sendMessage(Tb,eb)}sendMessage(ua,eb){this.cCg.sendMessage(ua,eb)}Fbk(ua,eb,Tb){const uc=new Date,yd=+uc-+ua.zlh;2E3<=yd&&sd.a.J(39331167,375,1E4<=yd?10:15,"[EditorPaneActor] Host was slow to respond to the message receivedInstanceId={0} receivedIsFromEditorPane={1} receivedTimestamp={2} currentTime={3} passedMilliseconds={4} receivedId={5} receivedType={6} responseId={7} responseType={8}",
ua.instanceId,ua.Mne,ua.zlh.toUTCString(),uc.getTime(),yd.toString(),eb.id,eb.type,Tb.id,Tb.type)}toa(ua,eb){eb.property===lf.a.isSlideCritiqueReady&&this.oTe(1)}YB(){this.oTe(0)}l1(ua,eb){(ua=this.ta.Ba)&&eb.slideId.equals(ua.Db)&&this.oTe(2)}ZJa(ua,eb){this.JDb.AMl(eb.instanceId);this.jM.visualizeCritiques([])}}Object(h.a)(Mb,"EditorPaneActor",null,[]);class kd{constructor(){this.xa=new Xh.a}whi(ua){this.xa.addHandler("PaneClosed",ua)}HYk(ua){this.xa.raiseEvent("PaneClosed",ua)}}Object(h.a)(kd,
"EditorPaneEventSource",null,[938,962,963]);var Id=d(4);class ce{}Object(h.a)(ce,"Paragraph",null,[]);var Xe=d(217);class jd{constructor(ua,eb,Tb,uc,yd,oe,$d,ve,hc){this.ta=ua;this.oD=eb;this.lXa=Tb;this.ia=uc;this.Ga=yd;this.Dok=oe;this.vve=$d;this.Gh=ve;this.Zjk=hc}checkProofingDirty(ua){const eb=ua.includedTags;if(2===ua.critiqueSelection&&1===eb)return ua=(ua=this.ta.Ba)&&ua.isConnected?!ua.isSlideCritiqueReady:!0,this.qva(0,!0),ua;this.Pwg("CheckProofingDirty");return!0}getCritiques(ua){var eb=
ua.includedTags;if(2===ua.critiqueSelection&&1===eb){ua=this.ta.Ba;if(!ua||!ua.isConnected||!ua.isSlideCritiqueReady)return null;eb=ua.jMa;ua=[];for(let Tb of eb)if((eb=Tb)&&eb.isConnected){eb=this.oD.TF(eb,uc=>{uc=Object(J.a)(295,uc.Eh);return!!uc&&5===uc.proofingType&&!uc.vFa});for(const uc of eb)(eb=Object(J.a)(295,uc.Eh))&&ua.push(eb.ON)}this.qva(1,!0);return this.vve.wNf(ua,Object(v.a)(this.vve,this.vve.SHi,"convertBox4Critique"))}this.Pwg("GetCritiques");return null}h$f(ua){var eb=this.ta.Ba;
if(!eb||!eb.isConnected)return null;const Tb=[];ua=jd.Cxk(ua);eb=eb.Yca;for(const uc of ua)(ua=Object(J.a)(Xc.a,eb.ze(Ib.a.Jf(uc))))&&ua.isConnected&&Tb.push(Object.assign(new ce,{paragraphId:uc,text:this.Gh.dWe(ua,"\n")}));return Tb}getSupportedLanguages(ua){return this.Dok.jej(ua.includedTags).CWR(eb=>{const Tb=[];if(eb=Object(J.a)(Id.a,eb)){eb=eb.result;for(let uc of eb)(eb=qd.a.He(uc))&&Array.add(Tb,eb.name)}this.qva(6,!0);return Tb})}getLanguagesOnCurrentSlide(){const ua=[],eb=[],Tb=this.ta.Ba;
let uc=[];Tb&&(uc=Tb.Uj());for(const yd of uc)this.Ga.eK(yd,oe=>{if(oe&&Object(dd.a)(Lc.AParagraphNode,oe)){oe=Object(J.a)(Lc.AParagraphNode,oe);var $d=oe.characterData;if($d&&$d.length){var ve=-1,hc;for($d=0;$d<oe.Ta.length;$d++)if(hc=oe.Ta.ga($d).formatting)hc=Ne.a.language(hc),ve===hc||Array.contains(ua,hc)||(Array.add(ua,hc),(ve=qd.a.He(hc))&&Array.add(eb,ve.name)),ve=hc}}});this.qva(7,!0);return eb}visualizeCritiques(ua){if(!ua)return this.qva(2,!1),1;const eb=Array(ua.length);if(!ua.length)return this.lXa.gZc(eb),
this.qva(2,!0),0;for(let Tb=0;Tb<ua.length;Tb++)eb[Tb]=ua[Tb].critiqueId;this.lXa.gZc(eb);this.qva(2,!0);return 0}resolveCritiques(ua){if(!ua||!ua.length)return 1;const eb=new pc.a(0);for(const Tb of ua)eb.add(Tb.critiqueId,Tb.suggestionIndex);ua=this.lXa.AHh(eb);this.qva(3,ua);return ua?0:1}ignoreCritiques(ua){if(!ua||!ua.length)return 1;const eb=[];for(const Tb of ua)Array.add(eb,Tb.critiqueId);ua=this.lXa.ignoreCritiques(eb,4);this.qva(4,ua);return ua?0:1}openProofingSettingsDialog(){if(this.Zjk){const ua=
this.ia.processAction(Ih.a.qJb,2);this.qva(5,32===ua)}}qva(ua,eb){sd.a.J(37266337,375,50,"{0}: {1}",ua,eb?0:1)}Pwg(ua){sd.a.J(36750081,375,15,"{0}: Unsupported CritiqueFilter",ua)}static Cxk(ua){const eb=new Xe.a;for(var Tb of ua)eb.contains(Tb.paragraphId)||eb.add(Tb.paragraphId);ua=Array(eb.count);Tb=0;for(let uc of eb)ua[Tb++]=uc;return ua}}Object(h.a)(jd,"EditorPaneHost",null,[934]);class rd{}Object(h.a)(rd,"EditorRuntimeNotificationData",null,[]);class Wc extends Sys.EventArgs{constructor(){super();
this.d5b=this.ola=null}}Object(h.a)(Wc,"EditorRuntimeNotificationEventArgs",Sys.EventArgs,[]);class wd{constructor(){this.notificationConfidence=0;this.shouldRaiseNotification=!1;this.confidence=0;this.resultStatus=null}}Object(h.a)(wd,"InfraredResultBase",null,[]);var Fe=d(345),ak=d(536);class tj{constructor(ua,eb){this.includedTags=this.critiqueSelection=0;this.critiqueSelection=ua;this.includedTags=eb}static fI(ua){return Object(dd.a)(Number,ua.critiqueSelection)&&Object(dd.a)(Number,ua.includedTags)?
new tj(ua.critiqueSelection,ua.includedTags):null}}Object(h.a)(tj,"CritiqueFilter",null,[]);class bh{constructor(ua,eb,Tb,uc){this.ia=ua;this.jM=eb;this.ta=Tb;this.eCg=uc}nTe(ua){if(this.eCg){var eb=new tj(2,1),Tb=this.jM.checkProofingDirty(eb),uc=Tb?[]:this.jM.getCritiques(eb),yd=Tb?[]:this.jM.h$f(uc);eb=this.oKe();ua=Object.assign(new rd,{isProofingDirty:Tb,critiques:uc,paragraphs:yd,numberOfCoAuthors:eb,contextChanged:0===ua});yd=(uc=!!uc&&0<uc.length)?1:0;let oe=Fe.a.success;0<eb?oe=Fe.a.GJa:
Tb?oe=Fe.a.pending:uc||(oe=Fe.a.GJa);Tb=Object.assign(new Wc,{ola:Object.assign(new wd,{notificationConfidence:yd,shouldRaiseNotification:!1,confidence:1,resultStatus:oe}),d5b:ua});this.eCg.nTe(Tb)}}oKe(){var ua=this.ta.Ba;if(!ua||!ua.isConnected)return 0;ua=Object.assign(new ak.a,{slideId:ua.Db});this.ia.Ka(Oa.a.i0a,2,ua);return ua.quc}}Object(h.a)(bh,"EditorRuntimeEventRaiser",null,[933]);var ee=d(551),Mi=d(713);class Nl{constructor(ua){this.Nik=ua}Fil(){this.i1a(0,0)}sessionEnd(){this.i1a(1,0)}uCl(){this.i1a(2,
4)}vCl(){this.i1a(2,3)}i1a(ua,eb){this.Nik.execute(Tb=>{const uc=Object.assign(new Mi.a,{cardId:ee.a.WVf,actionType:ua,actionEngagement:eb});Tb.uhd(uc)})}}Object(h.a)(Nl,"InfraredTelemetryLogger",null,[936]);class Cg extends ub{constructor(ua,eb,Tb){super(ua,eb);this.payload=null;this.payload=Tb}}Object(h.a)(Cg,"MessageWithPayload",ub,[]);class zi extends Cg{constructor(ua,eb,Tb){super(ua,eb,Tb)}}Object(h.a)(zi,"CheckProofingDirtyAndGetCritiquesResponse",Cg,[]);class Zh extends Cg{constructor(ua,
eb,Tb){super(ua,eb,Tb)}}Object(h.a)(Zh,"ResponseMessage",Cg,[]);class ch{constructor(ua){this.statusCode=0;this.logErrorMessage=null;this.statusCode=ua;this.logErrorMessage="";0!==ua&&(this.logErrorMessage=ua.toString())}}Object(h.a)(ch,"Response",null,[]);class kk extends ch{constructor(ua,eb,Tb,uc){super(0);this.isProofingDirty=!1;this.languagesOnTheCurrentSlide=this.paragraphs=this.critiques=null;this.isProofingDirty=ua;this.critiques=eb;this.paragraphs=Tb;this.languagesOnTheCurrentSlide=uc}}Object(h.a)(kk,
"ProofingDirtyAndCritiques",ch,[]);class Vi{constructor(ua,eb,Tb){this.ta=ua;this.jM=eb;this.z0=Tb}process(ua,eb){var Tb=this.z0.gRi(ua.message);if(!Tb)return sd.a.J(37025993,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] Can't decode message."),ua=new ch(1),Lb.Task.qt(new Zh(1003,eb.id,ua));ua=this.ta.Ba;if(!ua||!ua.isConnected)return sd.a.J(37025995,375,50,"[CheckProofingDirtyAndGetCritiquesProcessor] Active slide doesn't exist or is not connected"),ua=new kk(!1,[],[],[]),eb=new zi(1003,eb.id,
ua),Lb.Task.qt(eb);Tb=(ua=this.jM.checkProofingDirty(Tb.payload))?[]:this.jM.getCritiques(Tb.payload);if(!Tb)return sd.a.J(38418246,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] No box4 critiques were returned by host"),ua=new ch(2),Lb.Task.qt(new Zh(1003,eb.id,ua));const uc=ua?[]:this.jM.h$f(Tb),yd=ua?[]:this.jM.getLanguagesOnCurrentSlide();if(!yd)return sd.a.J(38418248,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] Failed to query languages on current slide"),ua=new ch(7),Lb.Task.qt(new Zh(1003,
eb.id,ua));ua=new kk(ua,Tb,uc,yd);eb=new zi(1003,eb.id,ua);return Lb.Task.qt(eb)}}Object(h.a)(Vi,"CheckProofingDirtyAndGetCritiquesProcessor",null,[961]);class kj{constructor(ua,eb,Tb){this.jM=ua;this.z0=eb;this.nEb=Tb}process(ua,eb){var Tb=this.z0.iRi(ua.message);if(!Tb)return sd.a.J(37087328,375,15,"[IgnoreProcessor] Can't decode message."),ua=new ch(1),Lb.Task.qt(new Zh(1006,eb.id,ua));Tb=this.jM.ignoreCritiques(Tb.payload);0===Tb&&ua.Mne&&this.nEb.vCl();ua=0===Tb?new ch(0):new ch(6);return Lb.Task.qt(new Zh(1006,
eb.id,ua))}}Object(h.a)(kj,"IgnoreProcessor",null,[961]);class Ni extends Cg{constructor(ua,eb,Tb){super(ua,eb,Tb)}}Object(h.a)(Ni,"NumberOfCoAuthorsResponse",Cg,[]);class ph extends ch{constructor(ua){super(0);this.numberOfCoAuthors=0;this.numberOfCoAuthors=ua}}Object(h.a)(ph,"NumberOfCoAuthorsModel",ch,[]);class Ck{constructor(ua,eb){this.ia=ua;this.ta=eb}process(ua,eb){ua=this.oKe();ua=new ph(ua);return Lb.Task.qt(new Ni(1009,eb.id,ua))}oKe(){var ua=this.ta.Ba;if(!ua||!ua.isConnected)return 0;
ua=Object.assign(new ak.a,{slideId:ua.Db});this.ia.Ka(Oa.a.i0a,2,ua);return ua.quc}}Object(h.a)(Ck,"NumberOfCoAuthorsProcessor",null,[961]);class Rj{constructor(ua,eb,Tb){this.ia=ua;this.y0=eb;this.Pze=Tb}process(ua,eb){if(!this.Pze)return sd.a.J(38412446,375,15,"[OpenIdeasPaneAndCloseEditorPaneProcessor] Ideas disabled, but we were asked to open Ideas pane"),ua=new ch(10),Lb.Task.qt(new Zh(1011,eb.id,ua));this.y0.aH(3);ua=this.ia.processAction(Oa.a.Y1e,2);32!==ua&&sd.a.J(38412448,375,15,"[OpenIdeasPaneAndCloseEditorPaneProcessor] Failed to open Ideas pane");
ua=new ch(32!==ua?9:0);return Lb.Task.qt(new Zh(1011,eb.id,ua))}}Object(h.a)(Rj,"OpenIdeasPaneAndCloseEditorPaneProcessor",null,[961]);class Jk{constructor(ua){this.jM=ua}process(ua,eb){this.jM.openProofingSettingsDialog();ua=new ch(0);return Lb.Task.qt(new Zh(1007,eb.id,ua))}}Object(h.a)(Jk,"OpenProofingSettingsProcessor",null,[961]);class hk{constructor(ua,eb,Tb){this.jM=ua;this.z0=eb;this.nEb=Tb}process(ua,eb){var Tb=this.z0.jRi(ua.message);if(!Tb)return sd.a.J(37087330,375,15,"[ResolveProcessor] Can't decode message."),
ua=new ch(1),Lb.Task.qt(new Zh(1005,eb.id,ua));Tb=this.jM.resolveCritiques(Tb.payload);0===Tb&&ua.Mne&&this.nEb.uCl();ua=0===Tb?new ch(0):new ch(5);return Lb.Task.qt(new Zh(1005,eb.id,ua))}}Object(h.a)(hk,"ResolveProcessor",null,[961]);class Bl extends Cg{constructor(ua,eb,Tb){super(ua,eb,Tb)}}Object(h.a)(Bl,"SubscriptionResponse",Cg,[]);class ie extends ch{constructor(ua){super(0);this.telemetryCorrelationId=null;this.telemetryCorrelationId=ua}}Object(h.a)(ie,"SubscriptionModel",ch,[]);class df{constructor(ua,
eb){this.JDb=ua;this.z0=eb}process(ua,eb){const Tb=this.z0.kRi(ua.message);if(!Tb)return sd.a.J(39331169,375,15,"[SubscribeProcessor] Can't decode message."),ua=new ch(1),Lb.Task.qt(new Zh(1001,eb.id,ua));sd.a.J(39331171,375,50,"Editor pane telemetry correlation id={0}",Tb.payload.telemetryCorrelationId);this.JDb.subscribe(ua.instanceId,0);this.JDb.subscribe(ua.instanceId,1);this.JDb.subscribe(ua.instanceId,2);ua=new ie("not available");return Lb.Task.qt(new Bl(1001,eb.id,ua))}}Object(h.a)(df,"SubscribeProcessor",
null,[961]);class uj extends Cg{constructor(ua,eb,Tb){super(ua,eb,Tb)}}Object(h.a)(uj,"SupportedLanguagesResponse",Cg,[]);class Xl extends ch{constructor(ua){super(0);this.supportedLanguages=null;this.supportedLanguages=ua}}Object(h.a)(Xl,"SupportedLanguagesModel",ch,[]);class Sj{constructor(ua,eb){this.jM=ua;this.z0=eb}process(ua,eb){ua=this.z0.lRi(ua.message);if(!ua)return sd.a.J(38094432,375,15,"[SupportedLanguagesProcessor] Can't decode message."),ua=new ch(1),Lb.Task.qt(new Zh(1010,eb.id,ua));
const Tb=this.jM.getSupportedLanguages(ua.payload);return Tb.CWR(()=>{var uc=Tb.result;if(!uc)return sd.a.J(38094434,375,15,"[SupportedLanguagesProcessor] Failed to query supported languages"),uc=new ch(8),new Zh(1010,eb.id,uc);uc=new Xl(uc);return new uj(1010,eb.id,uc)})}}Object(h.a)(Sj,"SupportedLanguagesProcessor",null,[961]);class bk{process(ua,eb){sd.a.J(37025999,375,15,"[UnsupportedMessageProcessor] Unsupported message type: {0}",eb.type);ua=new ch(3);return Lb.Task.qt(new Zh(eb.type,eb.id,
ua))}}Object(h.a)(bk,"UnsupportedMessageProcessor",null,[961]);class Ii{constructor(ua,eb){this.jM=ua;this.z0=eb}process(ua,eb){ua=this.z0.mRi(ua.message);if(!ua)return sd.a.J(37026001,375,15,"[VisualizeProcessor] Can't decode message."),ua=new ch(1),Lb.Task.qt(new Zh(1004,eb.id,ua));ua=0===this.jM.visualizeCritiques(ua.payload)?new ch(0):new ch(4);return Lb.Task.qt(new Zh(1004,eb.id,ua))}}Object(h.a)(Ii,"VisualizeProcessor",null,[961]);class Kk extends Cg{constructor(ua,eb,Tb){super(ua,eb,Tb)}static fI(ua){const eb=
ub.gnb(ua);return eb&&ua.payload?(ua=tj.fI(ua.payload))?new Kk(eb.type,eb.id,ua):null:null}}Object(h.a)(Kk,"CheckProofingDirtyAndGetCritiquesMessage",Cg,[]);class Ch{constructor(ua){this.dTb=ua}get critiqueId(){return this.dTb}static fI(ua){return ua.critiqueId&&Object(J.a)(String,ua.critiqueId)?new Ch(ua.critiqueId.toString()):null}}Object(h.a)(Ch,"CritiqueIgnore",null,[]);class fi extends Cg{constructor(ua,eb,Tb){super(ua,eb,Tb)}static fI(ua){const eb=ub.gnb(ua);if(!eb||!ua.payload||!Object(dd.a)(Array,
ua.payload))return null;ua=ua.payload;const Tb=Array(ua.length);for(let uc=0;uc<ua.length;uc++){const yd=Ch.fI(ua[uc]);if(!Tb)return null;Tb[uc]=yd}return new fi(eb.type,eb.id,Tb)}}Object(h.a)(fi,"IgnoreCritiquesMessage",Cg,[]);class Lk{constructor(ua,eb){this.dTb=ua;this.o8h=eb}get critiqueId(){return this.dTb}get suggestionIndex(){return this.o8h}static fI(ua){return ua.critiqueId&&Object(J.a)(String,ua.critiqueId)&&Object(dd.a)(Number,ua.suggestionIndex)?new Lk(ua.critiqueId.toString(),ua.suggestionIndex):
null}}Object(h.a)(Lk,"CritiqueResolution",null,[]);class $h extends Cg{constructor(ua,eb,Tb){super(ua,eb,Tb)}static fI(ua){const eb=ub.gnb(ua);if(!eb||!ua.payload||!Object(dd.a)(Array,ua.payload))return null;ua=ua.payload;const Tb=Array(ua.length);for(let uc=0;uc<ua.length;uc++){const yd=Lk.fI(ua[uc]);if(!Tb)return null;Tb[uc]=yd}return new $h(eb.type,eb.id,Tb)}}Object(h.a)($h,"ResolveCritiquesMessage",Cg,[]);class Yl{constructor(ua){this.telemetryCorrelationId=null;this.telemetryCorrelationId=ua}static fI(ua){let eb=
"unavailable";ua.telemetryCorrelationId&&Object(J.a)(String,ua.telemetryCorrelationId)&&ua.telemetryCorrelationId.toString().length&&50>=ua.telemetryCorrelationId.toString().length&&(eb=ua.telemetryCorrelationId.toString());return new Yl(eb)}}Object(h.a)(Yl,"Subscription",null,[]);class Cl extends Cg{constructor(ua,eb,Tb){super(ua,eb,Tb)}static fI(ua){const eb=ub.gnb(ua);if(!eb)return null;ua.payload||(ua.payload={});return(ua=Yl.fI(ua.payload))?new Cl(eb.type,eb.id,ua):null}}Object(h.a)(Cl,"SubscribeMessage",
Cg,[]);class ol extends Cg{constructor(ua,eb,Tb){super(ua,eb,Tb)}static fI(ua){const eb=ub.gnb(ua);return eb&&ua.payload?(ua=tj.fI(ua.payload))?new ol(eb.type,eb.id,ua):null:null}}Object(h.a)(ol,"SupportedLanguagesMessage",Cg,[]);class Zk{constructor(ua){this.dTb=ua}get critiqueId(){return this.dTb}static fI(ua){return ua.critiqueId&&Object(J.a)(String,ua.critiqueId)&&ua.critiqueId.toString().length?new Zk(ua.critiqueId.toString()):null}}Object(h.a)(Zk,"CritiqueToVisualize",null,[]);class lk extends Cg{constructor(ua,
eb,Tb){super(ua,eb,Tb)}static fI(ua){const eb=ub.gnb(ua);if(!eb||!ua.payload||!Object(dd.a)(Array,ua.payload))return null;ua=ua.payload;const Tb=Array(ua.length);for(let uc=0;uc<ua.length;uc++){const yd=Zk.fI(ua[uc]);if(!Tb)return null;Tb[uc]=yd}return new lk(eb.type,eb.id,Tb)}}Object(h.a)(lk,"VisualizeCritiquesMessage",Cg,[]);class $k{YSi(ua){return this.fnb(ua,ub.gnb)}kRi(ua){return this.fnb(ua,Cl.fI)}gRi(ua){return this.fnb(ua,Kk.fI)}mRi(ua){return this.fnb(ua,lk.fI)}jRi(ua){return this.fnb(ua,
$h.fI)}iRi(ua){return this.fnb(ua,fi.fI)}lRi(ua){return this.fnb(ua,ol.fI)}fnb(ua,eb){try{let Tb;return({Nu:Tb}=B.d(ua)).returnValue?eb(Tb):null}catch(Tb){return null}}KWf(ua){return B.c(ua)}}Object(h.a)($k,"MessageEncoder",null,[942]);var cj=d(81);class fg extends Sys.EventArgs{constructor(ua,eb,Tb){super();this.instanceId=ua;this.message=eb;this.Mne=Tb;this.zlh=new Date}}Object(h.a)(fg,"MessageReceivedEventArgs",Sys.EventArgs,[]);class al{constructor(ua,eb,Tb){this.xa=new Xh.a;this.QFb=ua;this.Qxg=
eb;this.zik=new RegExp(Tb,"i")}initialize(){try{if(window.addEventListener)return window.addEventListener("message",Object(v.a)(this,this.vlc,"messageReceivedHandler"),!1),!0;if(-1<window.navigator.userAgent.indexOf("MSIE")&&window.attachEvent)return window.attachEvent("onmessage",Object(v.a)(this,this.vlc,"messageReceivedHandler")),!0;sd.a.J(37026003,375,10,"[EditorPane.Messaging.Messenger] Failed to subscribe to onmessage event of window")}catch(ua){sd.a.J(37026005,375,10,"[EditorPane.Messaging.Messenger] Failed to subscribe to onmessage event of window with exception, message: {0}, stack: {1}",
ua.message,ua.stack)}return!1}aTd(ua){this.xa.addHandler("MessageReceived",ua)}voh(ua){this.xa.removeHandler("MessageReceived",ua)}sendMessage(ua,eb){if(ua&&eb){var Tb={};Tb.message=eb;Tb.editorPaneWildCard=".";this.uhl(ua,Tb)}}uhl(ua,eb){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(ua,"onCustomMessage",eb,Tb=>{Tb&&sd.a.J(37026007,375,15,"Couldn't deliver the message to Editor pane, status: {0}.",Tb)})}vlc(ua){const eb=ua.origin;if(this.zbc(eb)){var Tb;({Nu:Tb}=B.d(ua.data)).returnValue&&
Tb&&"."===Tb.editorPaneWildCard&&Tb.message&&this.xa.raiseEvent("MessageReceived",new fg(this.QFb.$Ta(),Tb.message,eb===this.Qxg))}}zbc(ua){const eb=cj.a.DQ(window.location.href);return!!ua&&0<ua.length&&"null"!==ua&&(ua===this.Qxg||ua===eb||this.zik.test(ua))}}Object(h.a)(al,"Messenger",null,[941]);class gi{constructor(ua,eb){this.Oc=ua;this.assetId=eb.Ogh}$Ta(){if(!this.Oc.instance)return sd.a.J(37025987,375,15,"[EditorPaneManager] App for office manager not present"),null;const ua=this.Oc.instance.zQ(this.assetId);
return ua?ua.instanceId?ua.instanceId:(sd.a.J(37025991,375,15,"[EditorPaneManager] App for office doesn't have instance id"),null):(sd.a.J(37025989,375,200,"[EditorPaneManager] App for office not found"),null)}getAssetId(){return this.assetId}}Object(h.a)(gi,"PaneIdsProvider",null,[939]);class rm{constructor(){this.Qs=new pc.a}subscribe(ua,eb){ua&&(this.Qs.Fb(eb)||this.Qs.add(eb,[]),Array.contains(this.Qs.ga(eb),ua)||this.Qs.ga(eb).push(ua))}unsubscribe(ua,eb){ua&&this.Qs.Fb(eb)&&(ua=Array.indexOf(this.Qs.ga(eb),
ua),-1!==ua&&Array.removeAt(this.Qs.ga(eb),ua))}AMl(ua){ua&&(this.unsubscribe(ua,0),this.unsubscribe(ua,1),this.unsubscribe(ua,2))}Itj(ua){return this.Qs.Fb(ua)?this.Qs.ga(ua):[]}}Object(h.a)(rm,"EditorPaneSubscriptionsManager",null,[940]);var xa=d(193);class Ff{constructor(){this.K=null}get name(){return"PowerPointWebEditor.EditorPane"}Yb(ua){ua&&(this.K=ua,this.K.register(Nb,"PowerPointWebEditor.Proofing.CritiquesHighlightActor").ma().oa(()=>new Nb(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorConsistencyCheckIsEnabled)),this.K.register(932,"PowerPointWebEditor.Proofing.IConsistencyCheckActor").ma().oa(()=>new zh(this.K.resolve("Box4.Highlight.IHighlightManager"),this.K.resolve("PowerPointWebEditor.Proofing.CritiquesHighlightActor"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.ICharacterPropertiesEditor"),
this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFocusDocumentAfterActionOnEditorPaneIsEnabled)),this.K.register(Mb,"PowerPointWebEditor.EditorPane.EditorPaneActor").ma().oa(()=>new Mb(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPane"),this.K.resolve("PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager"),
this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessenger"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),this.yMi(),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneEventSource"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerpointPresence.IPresenceEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").yd(8),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
this.K.resolve("PowerPointWebEditor.EditorPane.IEditorRuntimeEventRaiser"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IFunctionThrottlerFactory"),this.K.resolve("PowerPointWebEditor.IPresentationReader"))),Ff.uVj&&this.K.register(xg,"PowerPointWebEditor.EditorPane.DexLitePaneActor").ma().oa(()=>new xg(this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.View.IDexLitePane"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),
this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),xa.a(this.K),this.K.resolve("PowerPointWebEditor.Proofing.ICloudALResponseTransformer"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"))),this.K.register(933,"PowerPointWebEditor.EditorPane.IEditorRuntimeEventRaiser").ma().oa(()=>new bh(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"))),
this.K.register(Tg,"PowerPointWebEditor.Editor.Common.Model.EditorRuntimeEventSource").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventNotifier").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventHandler").ma().oa(()=>new Tg),this.K.register(934,"PowerPointWebEditor.EditorPane.IEditorPaneHost").ma().oa(()=>new jd(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),
this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckActor"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.Proofing.IProofingLanguageInfoManager"),this.K.resolve("PowerPointWebEditor.EditorPane.IDataContractMapper"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("Common.IAppSettingsManager").ka("299"))),this.K.register(935,"PowerPointWebEditor.EditorPane.IDataContractMapper").ma().oa(()=>new Hd),this.K.register(936,
"PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger").ma().oa(()=>new Nl(this.K.Ia("PowerPointWebEditor.IInfraredTelemetryListener"))),this.K.register(937,"PowerPointWebEditor.EditorPane.IEditorPane").ma().oa(()=>new Pa(this.K.resolve("Common.IActionManagerExtended"),this.K.Ia("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneEventSource"),this.K.resolve("PowerPointWebEditor.EditorPane.IPaneIdsProvider"),
this.K.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointIdeasIsEnabled,!0)),this.K.register(938,"PowerPointWebEditor.EditorPane.IEditorPaneEventSource").ma().oa(()=>new kd),this.K.register(939,"PowerPointWebEditor.EditorPane.IPaneIdsProvider").ma().oa(()=>new gi(this.K.Ia("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"))),this.K.register(940,"PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager").ma().oa(()=>
new rm),this.K.register(941,"PowerPointWebEditor.EditorPane.Messaging.IMessenger").ma().oa(()=>new al(this.K.resolve("PowerPointWebEditor.EditorPane.IPaneIdsProvider"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").jRk,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointIdeasApprovedOriginPattern)),this.K.register(942,"PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder").ma().oa(()=>new $k),this.K.register(bk,"PowerPointWebEditor.EditorPane.MessageProcessing.UnsupportedMessageProcessor").ma().oa(()=>
new bk),this.K.register(df,"PowerPointWebEditor.EditorPane.MessageProcessing.SubscribeProcessor").ma().oa(()=>new df(this.K.resolve("PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(hk,"PowerPointWebEditor.EditorPane.MessageProcessing.ResolveProcessor").ma().oa(()=>new hk(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),
this.K.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"))),this.K.register(kj,"PowerPointWebEditor.EditorPane.MessageProcessing.IgnoreProcessor").ma().oa(()=>new kj(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),this.K.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"))),this.K.register(Jk,"PowerPointWebEditor.EditorPane.MessageProcessing.OpenProofingSettingsProcessor").ma().oa(()=>
new Jk(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"))),this.K.register(Vi,"PowerPointWebEditor.EditorPane.MessageProcessing.CheckProofingDirtyAndGetCritiquesProcessor").ma().oa(()=>new Vi(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(Ii,"PowerPointWebEditor.EditorPane.MessageProcessing.VisualizeProcessor").ma().oa(()=>
new Ii(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(Ck,"PowerPointWebEditor.EditorPane.MessageProcessing.NumberOfCoAuthorsProcessor").ma().oa(()=>new Ck(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"))),this.K.register(Sj,"PowerPointWebEditor.EditorPane.MessageProcessing.SupportedLanguagesProcessor").ma().oa(()=>new Sj(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),
this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(Rj,"PowerPointWebEditor.EditorPane.MessageProcessing.OpenIdeasPaneAndCloseEditorPaneProcessor").ma().oa(()=>new Rj(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPane"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointIdeasIsEnabled)))}init(){this.K&&this.K.resolve("Common.IAppSettingsManager").ff(()=>{var ua=this.K.resolve("PowerPointWebEditor.IApplicationSettings");
Ff.Jsl(ua)&&this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessenger").initialize()&&(ua=this.K.resolve("PowerPointWebEditor.EditorPane.EditorPaneActor"),ua.vb(),ua.pe(),ua=this.K.resolve("PowerPointWebEditor.EditorPane.DexLitePaneActor"),ua.vb(),ua.pe())})}dispose(){}yMi(){const ua=new pc.a;ua.$(0,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.UnsupportedMessageProcessor"));ua.$(1,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.SubscribeProcessor"));
ua.$(3,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.CheckProofingDirtyAndGetCritiquesProcessor"));ua.$(4,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.VisualizeProcessor"));ua.$(5,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.ResolveProcessor"));ua.$(6,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.IgnoreProcessor"));ua.$(7,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.OpenProofingSettingsProcessor"));ua.$(9,
this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.NumberOfCoAuthorsProcessor"));ua.$(10,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.SupportedLanguagesProcessor"));ua.$(11,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.OpenIdeasPaneAndCloseEditorPaneProcessor"));return ua}static main(){n.a.instance.Ac(new Ff)}static Jsl(ua){return ua.pptEditorConsistencyCheckIsEnabled&&Ff.VSj(ua.Ogh)}static uVj(ua){return ua.jTf}static VSj(ua){return!!ua&&0<ua.length}}
Object(h.a)(Ff,"PptWebEditorEditorPanePackage",null,[2,3]);class Ri{constructor(ua){this.Ab=!1;this.gXd=320;this.initialize();this.ia=ua}initialize(){}dispose(){}vb(){this.ia.ra(Oa.a.Qlb,Nf.a.application,this.Qlb,4)}pe(){}Qlb(ua,eb,Tb){return 1===Tb?32:2===Tb?he.b("EditorPaneActor::ShowHideEditorPane PaneOpen: ",this.Ab.toString(),ua,()=>{this.Ab?this.hl():this.Iq();return 32}):8}hl(ua=!1){const eb=this.fA();this.Ab=!0;const Tb=Object.assign(new Kc.a,{title:ResourceStrings.L_DexLitePaneTitle,hideHeader:!1,
width:this.gXd,location:2,contentProps:eb,onOpen:()=>{},onClose:()=>{this.Ab=!1},isModernPane:!0});Gd.UISurfaces.Gq().then(uc=>{ua?uc.updateTaskPane(sf.a.MW,Tb):uc.showTaskPane(sf.a.MW,Tb);return null}).catch(uc=>{sd.a.J(508956943,822,10,"EditorPaneActor::ShowPane, Failed to show editor pane. Exception: "+uc.toString())})}Iq(){this.Ab=!1;Gd.UISurfaces.Gq().then(ua=>{ua.hideTaskPane(sf.a.MW,2);return null}).catch(ua=>{sd.a.J(508956942,822,10,"EditorPaneActor::HidePane, Failed to hide editor pane. Exception: "+
ua.toString())})}fA(){return new ag(0,0,0,0,0,0,0,0)}}Object(h.a)(Ri,"EditorPaneActor",null,[107,251]);class vj{constructor(){this.K=null}get name(){return"PowerPointWebEditor.EditorPaneV2"}Yb(ua){ua?(this.K=ua,this.K.resolve("PowerPointWebEditor.IApplicationSettings").$Vf&&this.K.register(Ri,"PowerPointWebEditor.EditorPaneV2.EditorPaneActor").ma().oa(()=>new Ri(this.K.resolve("Common.IActionManagerExtended")))):sd.a.J(508956893,822,10,"PptWebEditorEditorPaneV2Package::Container object not available")}init(){this.K&&
this.K.resolve("Common.IAppSettingsManager").ff(()=>{if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").$Vf){const ua=this.K.resolve("PowerPointWebEditor.EditorPaneV2.EditorPaneActor");ua.vb();ua.pe()}})}dispose(){}static main(){n.a.instance.Ac(new vj)}}Object(h.a)(vj,"PptWebEditorEditorPaneV2Package",null,[2,3]);var Hg=d(13);Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.AugmentationLoop");Type.registerNamespace("PowerPointWebEditor.ContentUpdateDetection");
Type.registerNamespace("PowerPointWebEditor.EditorPane");Type.registerNamespace("PowerPointWebEditor.EditorPane.MessageProcessing");Type.registerNamespace("PowerPointWebEditor.EditorPane.Messaging");Type.registerNamespace("PowerPointWebEditor.EditorPane.Model");Type.registerNamespace("PowerPointWebEditor.EditorPane.Subscription");Type.registerNamespace("PowerPointWebEditor.Proofing");Type.registerNamespace("PowerPointWebEditor.EditorPaneV2");Type.registerNamespace("PowerPointWebEditor.TextPrediction");
Object(Hg.c)("AugLoop");Xa.main();Ic.main();Ob.main();Ff.main();vj.main();Object(Hg.b)("AugLoop")},699:function(K,U,d){d.d(U,"a",function(){return n});K=d(0);var h=d(18),e=d(99),r=d(29),m=d(50);d(98);class n{constructor(){this.N_=null}get Hzb(){return!1}NJh(z,v){let x=new h.a;const B=new m.GraphTransaction(3);try{B.ld(r.App.Lb.Kd.Mn.Ag),this.Icc(v)&&(x=this.bac(v,x)),v!==z&&this.Icc(z)&&(x=this.bac(z,x))}finally{B&&B.dispose()}return x.toArray()}Icc(z){return!!z}Lod(z){let v=!1;for(const x of this.Ege)v||
!Sys.UI.DomElement.containsCssClass(z,x.className)&&!Sys.UI.DomElement.containsCssClass(z,x.k9b)||(v=!0),e.a.eLa(z,x.className),e.a.eLa(z,x.k9b)}}Object(K.a)(n,"AHighlightActor",null,[989])},700:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(e,r){this.className=e;this.k9b=r}}Object(K.a)(h,"HighlightCssClassPair",null,[])},701:function(K,U,d){d.d(U,"b",function(){return m});d.d(U,"a",function(){return n});var h=d(99);d(29);var e=d(50);d(34);d(94);var r=d(98);const m=z=>
{const v=new e.GraphTransaction(3);try{v.ld(z),z.Kv(32,!0)}finally{v&&v.dispose()}},n=z=>{if(z){z=h.a.Hka(z);if(-1===z.indexOf(r.a.B8)&&-1!==z.indexOf(r.a.FN)&&-1===z.indexOf(r.a.J3b))return 2;if(-1===z.indexOf(r.a.B8)&&(-1!==z.indexOf(r.a.I3b)||-1!==z.indexOf(r.a.VN)||-1!==z.indexOf(r.a.J3b)||-1!==z.indexOf(r.a.jNc)||-1!==z.indexOf(r.a.ZOc)||-1!==z.indexOf(r.a.XOc)||-1!==z.indexOf(r.a.WOc)||-1!==z.indexOf(r.a.T1d)||-1!==z.indexOf(r.a.O1d)||-1!==z.indexOf(r.a.Q1d)||-1!==z.indexOf(r.a.YOc)||-1!==z.indexOf(r.a.N1d)))return 1;
if(-1!==z.indexOf("WACImageContainer"))return 3}return 0}},702:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.type=this.action=0;this.mjb=this.gea=null}}Object(K.a)(h,"HighlightOperation",null,[])},706:function(K,U,d){d.d(U,"a",function(){return e});K=d(0);var h=d(18);class e{static Imh(r){e.f$b.add(r)}static ovh(r){for(let m of e.f$b)m(r)}static Rmh(r){e.Nkb.add(r);if(0<e.TKa.count){for(let m of e.TKa)r(m);e.TKa=new h.a}}static wvh(r){if(0<e.Nkb.count)for(let m of e.Nkb)m(r);
else e.TKa.add(r)}}e.TKa=new h.a;e.Nkb=new h.a;e.f$b=new h.a;Object(K.a)(e,"AugLoopEventUtils",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19809348/wdjs/ppteditDS.augloop.js.map