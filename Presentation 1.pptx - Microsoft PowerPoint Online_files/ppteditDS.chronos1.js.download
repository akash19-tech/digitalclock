'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[2],{1002:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e){super();this.Bya=e}}Object(K.a)(h,"SessionRehydratedEventArgs",Sys.EventArgs,[])},1003:function(K,U,d){d.r(U);d.d(U,"InsightsMenuItemFactory",function(){return m});K=d(0);var h=d(108),e=d(131),r=d(47);class m{constructor(n=null){this.o_h=n||CommonUIStrings.l_InsightsButtonText}get ukb(){return 10}oL(n){var z=
n.dK;n=h.a.J9()?h.a.zDa(z,1):h.a.q1d(z);z=String.format(this.o_h,z);return this.O9i(n,z)}O9i(n,z){return e.a(m.Kkg,h.a.J9()?"1914896509":"3317204163",r.a.xe(z),h.a.CQj,null,r.a.xe(n),r.a.xe(z),null,null)}}m.Kkg="bInsights";Object(K.a)(m,"InsightsMenuItemFactory",null,[794])},1004:function(K,U,d){d.d(U,"a",function(){return r});K=d(0);var h=d(131),e=d(47);class r{constructor(m,n,z,v,x){this.UNd=m;this.TNd=n;this.a9h=z;this.BZh=v;this.xif=x}get ukb(){return 4}oL(m,n=null){n=n.sessionId+"|"+n.r9+"|"+
m.dK;if(this.xif||this.BZh){let z=this.xif||e.a.nC(CommonUIStrings.l_HelpTooltip)===e.a.nC(m.dK.trim());if(this.a9h&&2<m.dK.length){const v=m.dK;";"===v.charAt(0)&&";"===v.charAt(v.length-1)&&v.substring(1,v.length-1)===r.lge&&(z=!0)}m=z?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,m.dK);return this.n3f(n,e.a.xe(m),z)}return this.n3f(n,e.a.xe(String.format(CommonUIStrings.l_TextWithQuotation,m.dK)),!1)}n3f(m,n,z){return h.a(r.lge,z?this.TNd:this.UNd,
n,"OfficeAssistant_16x16x32","A0",e.a.xe(m),n,null,null)}}r.lge="bSearchHelp";Object(K.a)(r,"AssistanceMenuItemFactory",null,[794])},1005:function(K,U,d){d.d(U,"a",function(){return n});K=d(0);var h=d(27),e=d(131),r=d(78),m=d(47);class n{get ukb(){return 13}oL(){return n.Kri()}static Kri(){return e.b(n.W0f,"798637440",m.a.xe(CommonUIStrings.l_LookupFirstRunExperienceTitle),h.AFrameworkApplication.Cm,r.getImageClass("Info_32x32x32"),null,null,m.a.xe(CommonUIStrings.l_LookupFirstRunExperienceTitle),
"Menu32",null,null,m.a.xe(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}n.W0f="bTellMeFirstRun";Object(K.a)(n,"FirstRunMenuItemFactory",null,[794])},1006:function(K,U,d){d.d(U,"a",function(){return m});K=d(0);var h=d(27),e=d(131),r=d(47);class m{constructor(n=null,z=null){this.eof=n;this.c3h=z||CommonUIStrings.l_LookupNoResultsDescription}get ukb(){return 14}oL(n){n=String.format(this.c3h,n.dK);return this.tsi(n)}tsi(n){return e.b(m.S5g,"798637440",r.a.xe(CommonUIStrings.l_LookupNoResultsTitle),
this.eof?h.AFrameworkApplication.Cm:null,this.eof,null,null,r.a.xe(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,r.a.xe(n),null,null)}}m.S5g="lookupNoResults";Object(K.a)(m,"NoCommandsFoundMenuItemFactory",null,[794])},1007:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(e,r){this.FontWeight=0;this.Text=null;this.FontWeight=e;this.Text=r}}Object(K.a)(h,"LabelFormatted",null,[])},1008:function(K,U,d){d.d(U,"a",function(){return z});K=d(0);d(144);var h=d(160),
e=d(176),r=d(175),m=d(108),n=d(47);class z{constructor(v){this.ub=v}sE(){return"Assistance"}GL(){return 0===this.ub.Fq?0:1===this.ub.Fq?1:this.ub.snc?3:2}FB(v,x,B=!1,D,w=null){D=new r.a(v);if((!w||Array.contains(w,8))&&!m.a.$F(v)){w=new e.a(8);if(B){B=n.a.nC(CommonUIStrings.l_HelpTooltip)===n.a.nC(v.Cf.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,v.Cf);const J=[];this.ub.pWa&&(this.ub.B1e||J.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",
{"default":"search_20"})),B=this.A9f(v.Cf));const G="||"+v.Cf;J.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",B));J.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",G));appChrome.api.dispatch(J);v=new h.a("GetHelpFromTellMe",4,v.Cf,null,1)}else v=new h.a("bSearchHelp",4,v.Cf,null,1);w.us(v);w.displayName=CommonUIStrings.l_HelpButtonTitle;D.Aq(w)}x.resultsUpdated(D)}FUa(v,x=null){const B=new e.a(8),D=n.a.nC(CommonUIStrings.l_HelpTooltip)===n.a.nC(v.Cf.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:
String.format(CommonUIStrings.l_TextWithQuotation,v.Cf);for(let J=0;J<x.length&&2>J;J++){var w=void 0;w=[];let G="GetHelpWithDescriptionFromTellMe"+(J+1).toString(),M=4;if(this.ub.Gtc)w.push(appChrome.actions.setControlLabel(G,D)),w.push(appChrome.actions.setCompoundButtonCommandValueId(G,v.Cf)),w.push(appChrome.actions.updateCompoundButtonDescription(G,this.Evj(x.length)));else if(this.ub.Htc){let N=this.Lcg(x[J]);G="GetHelpFromTellMe"+(J+1).toString();this.ub.pWa&&(N=this.A9f(N));M=9;w.push(appChrome.actions.setControlLabel(G,
N));w.push(appChrome.actions.setButtonCommandValueId(G,this.Cvj(x[J])))}appChrome.api.dispatch(w);w=new h.a(G,M,null,null,0);w.label=this.Lcg(x[J]);w.description=this.Bvj(x[J]);B.us(w);if(this.ub.Htc)break}B.displayName=CommonUIStrings.l_HelpButtonTitle;return B}Evj(v){return 1===v?String.format(CommonUIStrings.l_SearchResultText,v):String.format(CommonUIStrings.l_SearchResultsText,v)}A9f(v){return this.ub.cqe?m.a.fae(v,CommonUIStrings.l_HelpScopedButtonText):v+CommonUIStrings.l_HelpScopedButtonText}Lcg(v){return v.name?
v.name:""}Bvj(v){return v.description?v.description:""}Cvj(v){return v.id?"AssetID="+v.id:""}}Object(K.a)(z,"AssistanceResultsProvider",null,[750])},1009:function(K,U,d){d.d(U,"a",function(){return v});K=d(0);d(144);var h=d(160),e=d(176),r=d(175),m=d(117),n=d(108),z=d(300);class v{constructor(x){this.ub=x}sE(){return"Image"}GL(){return 0===this.ub.Fq?0:1===this.ub.Fq?1:3===this.ub.Fq?3:2}FB(x,B,D,w,J=null){D=new r.a(x);(!J||Array.contains(J,19))&&n.a.$F(x)&&this.ub.cI&&this.FUa(x,D,1);B.resultsUpdated(D)}FUa(x,
B,D,w=null){var J=[];let G;m.TellMeActor.instance.hH()&&m.TellMeActor.instance.hH().pWa?(G=this.ub.cqe?n.a.fae(x.Cf,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):x.Cf+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.ub.B1e||J.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):G=this.ub.cI?n.a.$F(x)?this.ub.ZQa?n.a.GTa(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:
this.ub.ZQa?n.a.GTa(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,x.Cf)):String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,x.Cf):this.ub.yOb?CommonUIStrings.l_TellMeImageSuggestionButtonText:x.Cf+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.ub.Yda?(m.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",G)),J=n.a.zDa(x.Cf,9,Object.assign(new z.a,{landingTab:"Image"})),m.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",
J))):(J.push(appChrome.actions.setControlLabel("ImageForSearch",G)),x=n.a.zDa(x.Cf,9,Object.assign(new z.a,{landingTab:"Image"})),J.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",x)),appChrome.api.dispatch(J));D=new h.a("ImageForSearch",12,null,null,D);w&&(D.score=w.ConfidenceScore);w=new e.a(19,this.ub.yOb?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);w.us(D);B.Aq(w)}}Object(K.a)(v,"ImageResultsProvider",null,[750])},1010:function(K,U,d){d.d(U,"a",function(){return z});
K=d(0);d(144);var h=d(160),e=d(176),r=d(175),m=d(108),n=d(27);class z{constructor(v){this.ub=v}sE(){return"Template"}GL(){return 0===this.ub.Fq?0:1===this.ub.Fq?1:3}FB(v,x){v=new r.a(v);x.resultsUpdated(v)}FUa(v,x,B){var D=[];let w;w=this.ub.cI?this.ub.ZQa?m.a.GTa(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,v.Cf)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,v.Cf):String.format(CommonUIStrings.l_TellMeTemplateButtonText,v.Cf);D.push(appChrome.actions.setControlLabel("TemplateForSearch",
w));D.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",String.format(n.AFrameworkApplication.fa.Ha("TellMeTemplateProviderURL"),n.AFrameworkApplication.uiCulture,v.Cf)));appChrome.api.dispatch(D);v=new e.a(23);v.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;D=new h.a("TemplateForSearch",24,null,null,0);D.label=B[0].Title?B[0].Title:"";D.description=B[0].Description?B[0].Description:"";v.us(D);x.Aq(v)}}Object(K.a)(z,"TemplateResultsProvider",null,[750])},1011:function(K,
U,d){d.d(U,"a",function(){return B});K=d(0);d(144);var h=d(343),e=d(160),r=d(176),m=d(175),n=d(707),z=d(117),v=d(108),x=d(47);class B{constructor(D,w,J,G){this.GS=D;this.nQa=w;this.Kuf=G;this.DYh=J;this.ub=z.TellMeActor.instance.hH()}sE(){return"EmptyQuery"}GL(){return 1===this.ub.Fq?1:0}FB(D,w,J=!1,G,M=null){G=new m.a(D);if((!M||Array.contains(M,5)||Array.contains(M,6)||Array.contains(M,4))&&v.a.$F(D)){this.GS.r7b().length||!this.DYh||this.Kuf||(D=new r.a(6),M=new e.a(null,13,void 0,void 0,1),D.us(M),
G.Aq(D));D=new r.a(4);if(0<this.GS.r7b().length){D.displayName=CommonUIStrings.l_TellMeRecentlyUsedTitle;M=this.GS.r7b();var N=[];for(var R of M)N.push(R.Id);h.CommandResultsUtility.TQb(N,this.ub);for(var C of M)h.CommandResultsUtility.Cac(C.Id)&&D.us(new e.a(C.Id,5,null,null,2));G.Aq(D)}if(this.Kuf&&0<this.nQa.length&&this.GS.r7b().length<B.o3g){R=new r.a(5);R.displayName=CommonUIStrings.l_TellMeTryQueryTitle;C=B.o3g-D.results.length;D=[];for(M=0;M<this.nQa.length&&M<C;++M){if(J){N=v.a.Y7e+(M+1);
const O=this.nQa[M].key,S=x.a.replaceAll(O,'"',"");D.push(appChrome.actions.setControlLabel(N,O));D.push(appChrome.actions.setButtonCommandValueId(N,S));N=new n.a(O,7,0,S,N)}else N=new n.a(this.nQa[M].key,7,0,this.nQa[M].value);R.us(N)}0<D.length&&appChrome.api.dispatch(D);G.Aq(R)}}w.resultsUpdated(G)}}B.o3g=5;Object(K.a)(B,"EmptyQueryResultsProvider",null,[750])},1012:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.Rvd=this.zua=this.gVa=this.ut=this.hLc=this.Qz=
this.Gnb=0}}Object(K.a)(h,"TRIESCAN",null,[])},1013:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);var h;(function(e){e[e.Service=0]="Service";e[e.Local=1]="Local";e[e.MRU=2]="MRU";e[e.TestResult=3]="TestResult";e[e.Unknown=4]="Unknown"})(h||(h={}));Object(K.b)("SubResultType",h)},1030:function(K,U,d){d.r(U);var h=d(0),e=d(144),r=d(388),m=d(263),n=d(160),z=d(176),v=d(175),x=d(117),B=d(108),D=d(300);class w{constructor(ya){this.ub=ya}sE(){return"ActionAI"}GL(){return 0===this.ub.Fq?0:1===this.ub.Fq?
1:2}FB(ya,Ra,hb=!1,Eb,Yb=null){Eb=new v.a(ya);if(!Yb||Array.contains(Yb,24))if(this.Ctl()||!B.a.$F(ya)){Yb=new z.a(24);var Nb=B.a.$F(ya);hb&&(hb=null,B.a.J9()&&(hb=B.a.zDa(Nb?"":ya.Cf,1,Object.assign(new D.a,{landingTab:"ActionAI"}))),this.ub.Yda?hb&&x.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",hb)):(ya=[],hb&&ya.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",hb)),appChrome.api.dispatch(ya)));Yb.us(new n.a("ActionAIFromTellMe",
25,null,null,1));Eb.Aq(Yb)}Ra.resultsUpdated(Eb)}Ctl(){return B.a.J9()&&this.ub.fme}}Object(h.a)(w,"ActionAIResultsProvider",null,[750]);var J=d(721);class G{constructor(ya,Ra){this.NAd=ya;this.Yh=Ra}resultsUpdated(ya){this.NAd.znl(this.Yh,ya)}}Object(h.a)(G,"AggregatorResultsProviderCallback",null,[925]);class M{constructor(ya){this.Lba=null;this.ub=ya;this.ub.J7a&&(this.Lba=null)}sE(){return"AppsForOffice"}GL(){return 0===this.ub.Fq?0:1===this.ub.Fq?1:2}FB(ya,Ra,hb,Eb,Yb=null){hb=new v.a(ya);if(!Yb||
Array.contains(Yb,1))Yb=new z.a(1),this.Lba.IWl(Yb,ya.Cf),hb.Aq(Yb);Ra.resultsUpdated(hb)}}Object(h.a)(M,"AppsForOfficeRecommendationResultsProvider",null,[750]);var N=d(1008),R=d(80),C=d(225),O=d(19);class S{constructor(ya,Ra){this.Ja=ya;this.Qgk=Ra}isMatch(ya,Ra){if(!Object(O.a)(1055,ya))throw Error.argument("objToTest","Expected feature bundle");let hb;return({value:hb}=ya.jn(this.Ja.Sca)).returnValue?this.Ja.s$e.isMatch(hb,Ra):this.Qgk}}Object(h.a)(S,"AnnotatedWithAndValueMatchesAnnotationFilter",
null,[1081]);class T{constructor(ya,Ra){this.Ja=ya;this.Exe=Ra}isMatch(ya){if(!Object(O.a)(1055,ya))throw Error.argument("objToTest","Expected feature bundle");return!!(this.Exe^ya.jn(this.Ja.Sca).returnValue)}}Object(h.a)(T,"AnnotatedWithAnnotationFilter",null,[1081]);class ca{constructor(ya){this.Ja=ya}isMatch(ya,Ra){if(!Object(O.a)(1058,ya))throw Error.argument("objToTest","Expected struct value");return this.Ja.s$e.isMatch(ya.VTa(this.Ja.yta),Ra)}}Object(h.a)(ca,"FieldValueMatchesStructFilter",
null,[1081]);class L{constructor(ya,Ra){ya&&(this.yta=ya.ga(0),this.s$e=Ra.b9(ya.ga(1)))}}Object(h.a)(L,"FieldValueMatchesStructFilterInit",null,[]);class da{constructor(ya){this.Exe=ya}isMatch(ya){if(!Object(O.a)(1055,ya))throw Error.argument("objToTest","Expected feature bundle");return!!(this.Exe^ya.Efe)}}Object(h.a)(da,"HasAnnotationsAnnotationFilter",null,[1081]);class Z{constructor(ya,Ra){this.Ja=ya;this.Tq=Ra}isMatch(ya,Ra){if(!Object(O.a)(1057,ya))throw Error.argument("objToTest","Expected list value");
switch(this.Tq){case 0:for(const hb of ya.items)if(this.Ja.filter.isMatch(hb,Ra))return!0;return!1;case 1:for(const hb of ya.items)if(!this.Ja.filter.isMatch(hb,Ra))return!1;return!0;default:throw Error.notImplemented();}}}Object(h.a)(Z,"ItemTestListFilter",null,[1081]);class fa{constructor(ya){this.Ja=ya}isMatch(ya,Ra){if(!Object(O.a)(1057,ya))throw Error.argument("objToTest","Expected list value");return this.Ja.filter.isMatch(ya.items.length,Ra)}}Object(h.a)(fa,"LengthMatchesListFilter",null,[1081]);
class aa{constructor(ya,Ra){this.Ja=ya;this.Tq=Ra}isMatch(ya,Ra,hb=null){let Eb=0===this.Tq;for(const Yb of this.Ja.MJf)if((Eb=Yb.isMatch(ya,Ra,hb))?1===this.Tq:0===this.Tq)return Eb;2===this.Tq&&(Eb=!Eb);return Eb}}Object(h.a)(aa,"NonterminalFilter",null,[1081]);class ja{constructor(ya,Ra){if(ya){var hb=ya.ga(0);this.MJf=Array(hb);for(let Eb=0;Eb<hb;++Eb)this.MJf[Eb]=Ra.b9(ya.ga(1+Eb))}}}Object(h.a)(ja,"NonterminalFilterInit",null,[]);class I{constructor(ya,Ra){this.Ja=ya;this.Tq=Ra}isMatch(ya,Ra){if("number"!==
typeof ya)throw Error.argument("objToTest","Expected number value");let hb=this.Ja.number;if(this.Ja.query){Ra=this.Ja.query.rp(null,Ra);if("number"!==typeof Ra)throw Error.invalidOperation("Query did not return number");hb+=Ra}switch(this.Tq){case 0:return ya===hb;case 1:return ya<hb;case 2:return ya<=hb;case 3:return ya>hb;case 4:return ya>=hb;default:throw Error.notImplemented();}}}Object(h.a)(I,"NumberFilter",null,[1081]);class sa{constructor(ya,Ra){ya&&(this.number=ya.ga(0),this.query=ya.ga(1)?
Ra.oE(ya.ga(1)):null)}}Object(h.a)(sa,"NumberFilterInit",null,[]);class ka{constructor(ya,Ra,hb){this.oVc=this.Ygj;this.oIa=ya;this.IDg=Ra;this.GDg=hb}iYd(ya){this.IDg=ya}Ygj(ya){if(!ya)throw Error.argument("name","Invalid named feature bundle reference");const Ra=ya.substr(1);return 1===ya.charCodeAt(0)&&Ra===this.oIa?this.IDg:this.GDg?this.GDg.oVc(ya):null}}Object(h.a)(ka,"SimpleNamedFeatureBundleResolver",null,[1097]);class Ma{constructor(ya){this.Ja=ya}isMatch(ya,Ra){if(!Object(O.a)(1055,ya))throw Error.argument("objToTest",
"Expected feature bundle");ya=this.Ja.query.rp(null,new ka(this.Ja.gzd,ya,Ra));if("boolean"!==typeof ya)throw Error.invalidOperation("Query did not return bool");return ya}}Object(h.a)(Ma,"PredicateAnnotationFilter",null,[1081]);class Ea{constructor(ya,Ra){ya&&(this.gzd=Ra.$C(ya.ga(0)),this.query=Ra.oE(ya.ga(1)))}}Object(h.a)(Ea,"PredicateAnnotationFilterInit",null,[]);class ma{constructor(ya){this.Ja=ya}isMatch(ya,Ra){if("boolean"!==typeof ya)throw Error.argument("objToTest","Expected bool value");
Ra=this.Ja.query.rp(null,Ra);if("boolean"!==typeof Ra)throw Error.invalidOperation("Query did not return bool");return ya===Ra}}Object(h.a)(ma,"QueryBooleanFilter",null,[1081]);class va{constructor(ya,Ra){this.Ja=ya;this.Tq=Ra}isMatch(ya,Ra){if("number"!==typeof ya)throw Error.argument("objToTest","Expected integer");Ra=this.Ja.query.rp(null,Ra);if("number"!==typeof Ra)throw Error.invalidOperation("Query did not return an enum value");switch(this.Tq){case 0:return ya===Ra;case 1:return 0!==(ya&Ra);
case 2:return ya===(ya&Ra);case 3:return Ra===(ya&Ra);default:throw Error.notImplemented();}}}Object(h.a)(va,"QueryEnumFilter",null,[1081]);class Ca{constructor(ya,Ra){ya&&(this.R1c=1===ya.ga(0),this.query=Ra.oE(ya.ga(1)))}}Object(h.a)(Ca,"QueryEnumFilterInit",null,[]);class oa{constructor(ya,Ra){this.Ja=ya;this.Tq=Ra}isMatch(ya,Ra){if(!Object(O.a)(1057,ya))throw Error.argument("objToTest","Expected list value");Ra=this.Ja.query.rp(null,Ra);if(!Object(O.a)(1057,Ra))throw Error.invalidOperation("Query did not return list value");
if(ya.QU!==Ra.QU)return!1;switch(this.Tq){case 0:return R.Annotations.j3a(R.Annotations.zkj(ya.QU),ya,Ra);case 1:for(const hb of ya.items)for(const Eb of Ra.items)if(R.Annotations.j3a(ya.QU,hb,Eb))return!0;return!1;case 2:for(const hb of ya.items)for(const Eb of Ra.items)if(!R.Annotations.j3a(ya.QU,hb,Eb))return!1;return!0;case 3:for(const hb of Ra.items)for(const Eb of ya.items)if(!R.Annotations.j3a(ya.QU,hb,Eb))return!1;return!0;default:throw Error.notImplemented();}}}Object(h.a)(oa,"QueryListFilter",
null,[1081]);class Da{constructor(ya,Ra){this.Ja=ya;this.Tq=Ra}isMatch(ya,Ra){if("string"!==typeof ya)throw Error.argument("objToTest","Expected string");Ra=this.Ja.query.rp(null,Ra);if("string"!==typeof Ra)throw Error.invalidOperation("Query did not return string");this.Ja.Dme&&(ya=ya.toUpperCase(),Ra=Ra.toUpperCase());switch(this.Tq){case 0:return ya===Ra;case 1:return 0<=ya.indexOf(Ra);case 2:return ya.startsWith(Ra);case 3:return ya.endsWith(Ra);case 4:return 0<=Ra.indexOf(ya);case 5:return Ra.startsWith(ya);
case 6:return Ra.endsWith(ya);default:throw Error.notImplemented();}}}Object(h.a)(Da,"QueryStringFilter",null,[1081]);class ta{constructor(ya,Ra){ya&&(this.query=Ra.oE(ya.ga(0)),this.Dme=1===ya.ga(1))}}Object(h.a)(ta,"QueryStringFilterInit",null,[]);class ha{constructor(ya){this.Ja=ya}isMatch(ya,Ra){if(!Object(O.a)(1058,ya))throw Error.argument("objToTest","Expected struct value");Ra=this.Ja.query.rp(null,Ra);if(!Object(O.a)(1058,Ra))throw Error.invalidOperation("Query did not return struct value");
return ya.isEqual(ya)}}Object(h.a)(ha,"QueryStructFilter",null,[1081]);class Ha{constructor(ya){this.Ja=ya}isMatch(ya,Ra){ya=this.Ja.query.rp(null,Ra);if("boolean"!==typeof ya)throw Error.invalidOperation("Query did not return bool");return ya}}Object(h.a)(Ha,"QueryWhereConstraintFilter",null,[1081]);class bb{constructor(ya){this.Ja=ya}isMatch(ya){if("string"!==typeof ya)throw Error.argument("objToTest","Expected string");return this.Ja.regex.test(ya)}}Object(h.a)(bb,"RegexStringFilter",null,[1081]);
class Na{constructor(ya,Ra){ya&&(this.regex=Ra.V$f(ya.ga(0)))}}Object(h.a)(Na,"RegexStringFilterInit",null,[]);class Ia{constructor(ya,Ra){ya&&(this.filter=Ra.b9(ya.ga(0)))}}Object(h.a)(Ia,"SingleFilterFilterInit",null,[]);class Qa{constructor(ya,Ra){ya&&(this.query=Ra.oE(ya.ga(0)))}}Object(h.a)(Qa,"SingleQueryFilterInit",null,[]);class qa{constructor(ya){this.Ja=ya}isMatch(ya){if("boolean"!==typeof ya)throw Error.argument("objToTest","Expected bool value");return ya===this.Ja.value}}Object(h.a)(qa,
"StoredValueBooleanFilter",null,[1081]);class Wa{constructor(ya){ya&&(this.value=1===ya.ga(0))}}Object(h.a)(Wa,"StoredValueBooleanFilterInit",null,[]);class Hb{constructor(ya,Ra){this.Ja=ya;this.Tq=Ra}isMatch(ya){if("number"!==typeof ya)throw Error.argument("objToTest","Expected integer");switch(this.Tq){case 0:return this.Ja.R1c?this.Ja.value?!!(ya&this.Ja.value):!ya:ya===this.Ja.value;case 1:return this.Ja.R1c?(ya&this.Ja.value)===this.Ja.value:32>ya&&(1<<ya&this.Ja.value)===this.Ja.value;case 2:return this.Ja.R1c?
!!(ya&this.Ja.value):32>ya&&!!(1<<ya&this.Ja.value);default:throw Error.notImplemented();}}}Object(h.a)(Hb,"StoredValueEnumFilter",null,[1081]);class jc{constructor(ya){ya&&(this.R1c=1===ya.ga(0),this.value=ya.ga(1))}}Object(h.a)(jc,"StoredValueEnumFilterInit",null,[]);class gc{constructor(){this.dMk=null;this.$Wd=this.obb=0}}Object(h.a)(gc,"WHEREConstraintData",null,[]);class $b{constructor(ya){this.Ja=ya}isMatch(ya,Ra){if(!Object(O.a)(gc,ya))throw Error.argument("objToTest","Expected WHERE constraint data");
let hb=-1,Eb=-1;const Yb=ya.dMk;switch(this.Ja.cYd){case 4:hb=Yb.p6b;Eb=Yb.l3e;break;case 5:hb=ya.obb;Eb=Yb.p6b-ya.obb;break;case 6:hb=Yb.p6b+Yb.l3e;Eb=ya.obb+ya.$Wd-hb;break;case 1:case 2:case 3:let Nb=!1;for(let ed=Yb.VWl;ed;ed=ed.next)if(this.Ja.YRl===ed.name){Nb=!0;1===this.Ja.cYd?(hb=ed.p6b,Eb=ed.l3e):2===this.Ja.cYd?(hb=ya.obb,Eb=ed.p6b-ya.obb):(hb=ed.p6b+ed.l3e,Eb=ya.obb+ya.$Wd-hb);break}if(!Nb)return!1;break;case 7:hb=ya.obb;Eb=ya.$Wd;break;default:throw Error.notImplemented();}return null!==
this.Ja.iAl.uXl(Yb.VYl,hb,Eb,hb,!0,2,Ra)}}Object(h.a)($b,"SubSreWhereConstraintFilter",null,[1081]);class wb{constructor(ya,Ra){if(ya){var hb=Ra.$C(ya.ga(0));this.cYd=hb.charCodeAt(0);this.YRl=hb.substr(1);this.iAl=Ra.mqj(ya.ga(1))}}}Object(h.a)(wb,"SubSreWhereConstraintFilterInit",null,[]);class Db{constructor(ya){this.Ja=ya}isMatch(ya,Ra,hb=null){if(!Object(O.a)(1055,ya))throw Error.argument("objToTest","Expected feature bundle");if(null==hb)throw Error.argumentNull("parentTextForSpan");if(this.Ja.aBf&&
!this.Ja.aBf.isMatch(ya,Ra))return!1;if(this.Ja.O5e){let Eb;if(({value:Eb}=ya.jn(this.Ja.Dzl)).returnValue){if(!this.Ja.O5e.isMatch(Eb,Ra))return!1}else{let Yb,Nb;if(!({value:Yb}=ya.jn(this.Ja.mEh)).returnValue||!({value:Nb}=ya.jn(this.Ja.lEh)).returnValue||0>Yb||0>Nb||Yb+Nb>hb.length||!this.Ja.O5e.isMatch(hb.substr(Yb,Nb),Ra))return!1}}if(this.Ja.OEh){let Eb;if(!({value:Eb}=ya.jn(this.Ja.mEh)).returnValue||!this.Ja.OEh.isMatch(Eb,Ra))return!1}if(this.Ja.Tug){let Eb;if(!({value:Eb}=ya.jn(this.Ja.lEh)).returnValue||
!this.Ja.Tug.isMatch(Eb,Ra))return!1}return!0}}Object(h.a)(Db,"TextSpanFilter",null,[1081]);class Xb{constructor(ya,Ra){ya&&(this.annotations=Ra.annotations,this.mEh=ya.ga(0),this.lEh=ya.ga(1),this.Dzl=ya.ga(2),this.O5e=ya.ga(3)?Ra.b9(ya.ga(3)):null,this.aBf=ya.ga(4)?Ra.b9(ya.ga(4)):null,this.OEh=ya.ga(5)?Ra.b9(ya.ga(5)):null,this.Tug=ya.ga(6)?Ra.b9(ya.ga(6)):null)}}Object(h.a)(Xb,"TextSpanFilterInit",null,[]);class ab{constructor(ya,Ra){ya&&(this.annotations=Ra.annotations,this.Sca=ya.ga(0),this.s$e=
ya.ga(1)?Ra.b9(ya.ga(1)):null)}}Object(h.a)(ab,"ValueFilterAnnotationFilterInit",null,[]);var Ab=d(278);class rc{b9(ya,Ra){const hb=ya.ga(0),Eb=new Ab.a;Eb.xTa(ya,1,ya.count-1);switch(hb){case 1:return new aa(new ja(Eb,Ra),0);case 2:return new aa(new ja(Eb,Ra),1);case 3:return new aa(new ja(Eb,Ra),2);case 101:return new bb(new Na(Eb,Ra));case 103:return new Da(new ta(Eb,Ra),0);case 104:return new Da(new ta(Eb,Ra),1);case 105:return new Da(new ta(Eb,Ra),2);case 106:return new Da(new ta(Eb,Ra),3);case 107:return new Da(new ta(Eb,
Ra),4);case 108:return new Da(new ta(Eb,Ra),5);case 109:return new Da(new ta(Eb,Ra),6);case 201:return new qa(new Wa(Eb));case 202:return new ma(new Qa(Eb,Ra));case 301:return new I(new sa(Eb,Ra),0);case 302:return new I(new sa(Eb,Ra),1);case 303:return new I(new sa(Eb,Ra),2);case 304:return new I(new sa(Eb,Ra),3);case 305:return new I(new sa(Eb,Ra),4);case 401:return new Hb(new jc(Eb),0);case 402:return new Hb(new jc(Eb),1);case 403:return new Hb(new jc(Eb),2);case 404:return new va(new Ca(Eb,Ra),
0);case 405:return new va(new Ca(Eb,Ra),1);case 406:return new va(new Ca(Eb,Ra),2);case 407:return new va(new Ca(Eb,Ra),3);case 501:return new ca(new L(Eb,Ra));case 502:return new ha(new Qa(Eb,Ra));case 601:return new Z(new Ia(Eb,Ra),0);case 602:return new Z(new Ia(Eb,Ra),1);case 603:return new fa(new Ia(Eb,Ra));case 604:return new oa(new Qa(Eb,Ra),0);case 605:return new oa(new Qa(Eb,Ra),1);case 606:return new oa(new Qa(Eb,Ra),2);case 607:return new oa(new Qa(Eb,Ra),3);case 701:return new da(!1);
case 702:return new da(!0);case 703:return new T(new ab(Eb,Ra),!1);case 704:return new T(new ab(Eb,Ra),!0);case 705:return new S(new ab(Eb,Ra),!1);case 706:return new S(new ab(Eb,Ra),!0);case 707:return new Ma(new Ea(Eb,Ra));case 901:return new Db(new Xb(Eb,Ra));case 1002:return new Ha(new Qa(Eb,Ra));case 1001:return new $b(new wb(Eb,Ra));default:throw Error.argument("initData");}}}Object(h.a)(rc,"FilterFactory",null,[1054]);var tb=d(138);class Za{constructor(ya){this.Ja=ya}get qy(){return this.Ja.qy}get cV(){return this.Ja.cV}get svd(){return this.Ja.svd}get C0c(){return this.Ja.C0c}load(ya,
Ra){return this.rp(ya,ya?new ka("root",ya,Ra):Ra)}store(ya,Ra,hb){this.hPb(ya,Ra,ya?new ka("root",ya,hb):hb,null)}rp(ya,Ra){if(!this.C0c&&!this.Ja.annotations.$Ab(this.qy,ya))throw Error.argument("input","Input value not of expected type");let hb=this.Ja.$0f;for(;hb;)ya=hb.load(ya,Ra),hb=hb.next;return ya}hPb(ya,Ra,hb,Eb){if(!this.svd)throw Error.invalidOperation("Attempt to store into query that supports only loading");if(!this.C0c&&!this.Ja.annotations.$Ab(this.qy,ya))throw Error.argument("lvalue",
"Lvalue not of expected type");if(!this.Ja.annotations.$Ab(this.cV,Ra))throw Error.argument("rvalue","Rvalue not of expected type");return this.Ja.$0f.store(ya,Ra,hb,Eb)}static wLf(ya,Ra,hb,Eb){if(hb===Eb)return Ra;if(R.Annotations.pC(hb)&&R.Annotations.pC(Eb)){hb=R.Annotations.SEa(hb);Eb=R.Annotations.SEa(Eb);const Yb=new tb.a(ya,Eb);for(const Nb of Ra.items)Array.add(Yb.items,Za.wLf(ya,Nb,hb,Eb));return Yb}if(hb===R.Annotations.Tpa){if(Eb===R.Annotations.wba)return Ra;if(Eb===R.Annotations.kZ)return Ra.toString()}else if(hb===
R.Annotations.wba){if(Eb===R.Annotations.Tpa)return Math.floor(Ra);if(Eb===R.Annotations.kZ)return Ra.toString()}else if(hb===R.Annotations.kZ){if(Eb===R.Annotations.Tpa)return parseInt(Ra);if(Eb===R.Annotations.wba)return parseFloat(Ra)}throw Error.invalidOperation("Type conversion failure in query step");}}Object(h.a)(Za,"AnnotationQuery",null,[1113]);class fb{constructor(){this.cV=this.qy=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}WEa(ya){if(this.next)return{returnValue:this.next,
Ipa:ya};if(ya){const Ra=ya.pNf;ya=ya.Jhh;return{returnValue:Ra,Ipa:ya}}return{returnValue:null,Ipa:ya}}}Object(h.a)(fb,"AnnotationQueryStep",null,[1138]);class ac extends fb{constructor(ya){super();this.Ja=ya}load(ya,Ra){Ra=this.Ja.query.rp(ya,Ra);if(R.Annotations.pC(this.qy)){var hb=R.Annotations.SEa(this.qy);let Yb=new tb.a(this.Ja.annotations,hb);if(R.Annotations.pC(this.Ja.query.cV)){if(ya.items.length!==Ra.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");
for(let Nb=0,ed=ya.items.length;Nb<ed;++Nb)Array.add(Yb.items,this.FLc(ya.items[Nb],Ra.items[Nb],hb===R.Annotations.wba))}else for(var Eb of ya.items)Array.add(Yb.items,this.FLc(Eb,Ra,hb===R.Annotations.wba));return Yb}if(R.Annotations.pC(this.Ja.query.cV)){Eb=new tb.a(this.Ja.annotations,this.qy);for(hb of Ra.items)Array.add(Eb.items,this.FLc(ya,hb,this.qy===R.Annotations.wba));return Eb}return this.FLc(ya,Ra,this.qy===R.Annotations.wba)}FLc(ya,Ra,hb){ya=this.iub(ya,Ra);return hb?ya:Math.floor(ya)}}
Object(h.a)(ac,"NumericAnnotationQueryStep",fb,[]);class Dc extends ac{constructor(ya){super(ya)}iub(ya,Ra){return ya+Ra}}Object(h.a)(Dc,"AddAnnotationQueryStep",ac,[]);class Sc extends fb{constructor(ya){super();this.Ja=ya}load(ya,Ra){if(this.qy===R.Annotations.mha&&this.Ja.query.cV===R.Annotations.mha){let Yb;if(({result:Yb}=this.hIf(ya)).returnValue)return Yb}if(R.Annotations.pC(this.qy)){var hb=new tb.a(this.Ja.annotations,R.Annotations.mha);Ra=this.Ja.query.rp(ya,Ra);if(R.Annotations.pC(this.Ja.query.cV)){if(ya.items.length!==
Ra.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let Yb=0,Nb=ya.items.length;Yb<Nb;++Yb)Array.add(hb.items,this.B2b(Ra.items[Yb],ya.items[Yb]))}else for(var Eb of ya.items)Array.add(hb.items,this.B2b(Ra,Eb));return hb}Eb=this.Ja.query.rp(ya,Ra);if(R.Annotations.pC(this.Ja.query.cV)){Ra=new tb.a(this.Ja.annotations,R.Annotations.mha);for(hb of Eb.items)Array.add(Ra.items,this.B2b(hb,ya));return Ra}return this.B2b(Eb,ya)}}Object(h.a)(Sc,"BinaryBooleanAnnotationQueryStep",
fb,[]);class xb extends Sc{constructor(ya){super(ya)}hIf(ya){return{returnValue:!ya,result:!1}}B2b(ya,Ra){return ya&&Ra}}Object(h.a)(xb,"AndAnnotationQueryStep",Sc,[]);class Ta{constructor(ya){ya&&(this.annotations=ya)}}Object(h.a)(Ta,"AnnotationsOnlyQueryStepInit",null,[]);class ib extends fb{constructor(ya){super();this.Ja=ya}load(ya,Ra){Ra=this.Ja.query.rp(ya,Ra);ya=ya.clone();R.Annotations.pC(this.Ja.query.cV)?Array.addRange(ya.items,Ra.items):Array.add(ya.items,Ra);return ya}}Object(h.a)(ib,
"AppendAnnotationQueryStep",fb,[]);class ob extends fb{constructor(ya){super();this.Ja=ya}load(ya,Ra){if(this.qy===R.Annotations.kN)return this.I5b(ya,Ra);const hb=new tb.a(this.Ja.annotations,R.Annotations.kN);for(const Eb of ya.items)Array.add(hb.items,this.I5b(Eb,Ra));return hb}I5b(ya,Ra){const hb=new C.a(this.Ja.annotations);hb.oDa(ya);ya=new C.a(this.Ja.annotations);this.Ja.script.N8(null,new ka("Input",hb,new ka("Output",ya,Ra)));return ya}}Object(h.a)(ob,"ApplyAnnotationQueryStep",fb,[]);class fc extends fb{constructor(ya){super();
this.Ja=ya}load(ya,Ra){if(this.qy===R.Annotations.kN)return Ra=this.I5b(ya,Ra),Ra.jn(this.Ja.$Af).returnValue||new tb.a(this.Ja.annotations,R.Annotations.kN),Ra;const hb=new tb.a(this.Ja.annotations,R.Annotations.kN);for(const Eb of ya.items)if(ya=this.I5b(Eb,Ra),({value:ya}=ya.jn(this.Ja.$Af)).returnValue)for(const Yb of ya.items)Array.add(hb.items,Yb);return hb}I5b(ya,Ra){const hb=new C.a(this.Ja.annotations);hb.oDa(ya);ya=new C.a(this.Ja.annotations);this.Ja.script.N8(null,new ka("Input",hb,new ka("Output",
ya,Ra)));return ya}}Object(h.a)(fc,"ApplyExpandAnnotationQueryStep",fb,[]);class Jb{constructor(ya,Ra){ya&&(this.annotations=Ra.annotations,this.script=Ra.F$a(ya.ga(0)),this.$Af=ya.ga(1))}}Object(h.a)(Jb,"ApplyExpandQueryStepInit",null,[]);class xc{constructor(ya,Ra){ya&&(this.annotations=Ra.annotations,this.script=Ra.F$a(ya.ga(0)))}}Object(h.a)(xc,"ApplyQueryStepInit",null,[]);class ic extends fb{constructor(ya){super();this.Ja=ya}load(ya){if(this.qy===R.Annotations.kN)return this.N4c(ya);const Ra=
new tb.a(this.Ja.annotations,this.Ja.annotations.getAttributeType(this.Ja.Sca));for(const hb of ya.items)Array.add(Ra.items,this.N4c(hb));return Ra}store(ya,Ra,hb,Eb){if(this.qy===R.Annotations.kN){var Yb=Ra,Nb=({Ipa:Eb}=this.WEa(Eb)).returnValue;Nb&&(Yb=Nb.store(R.Annotations.mL(this.N4c(ya)),Ra,hb,Eb));ya.Du(this.Ja.Sca,Yb)}else{var ed=Ra;if(Yb=({Ipa:Eb}=this.WEa(Eb)).returnValue){ed=new tb.a(this.Ja.annotations,this.Ja.annotations.getAttributeType(this.Ja.Sca));for(Nb of ya.items)Array.add(ed.items,
this.N4c(Nb));ed=Yb.store(ed,Ra,hb,Eb)}Ra=ed;if(Ra.items.length!==ya.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let zd=0,Hd=ya.items.length;zd<Hd;++zd)hb=ya.items[zd],hb.isReadOnly&&(hb=hb.clone(),ya.items[zd]=hb),hb.Du(this.Ja.Sca,Ra.items[zd])}return ya}N4c(ya){({value:ya}=ya.jn(this.Ja.Sca)).returnValue||(ya=this.Ja.annotations.Kaj(this.Ja.Sca));return ya}}Object(h.a)(ic,"AttrAnnotationQueryStep",fb,[]);class nc{constructor(ya,Ra){ya&&
(this.annotations=Ra,this.Sca=ya.ga(0))}}Object(h.a)(nc,"AttrQueryStepInit",null,[]);class Wb extends fb{constructor(ya){super();this.Ja=ya}load(ya){const Ra=new C.a(this.Ja.annotations);Ra.oDa(ya);return this.Ja.module.execute(Ra)}}Object(h.a)(Wb,"CallModuleAnnotationQueryStep",fb,[]);class wc{constructor(ya,Ra){ya&&(this.annotations=Ra.annotations,this.module=Ra.rbe(ya.ga(0)))}}Object(h.a)(wc,"CallModuleQueryStepInit",null,[]);class nb extends fb{constructor(ya){super();this.Ja=ya}load(ya,Ra){if(R.Annotations.pC(this.qy)){var hb=
this.Ja.query.rp(ya,Ra);Ra=new tb.a(this.Ja.annotations,R.Annotations.kZ);let Nb="string"===typeof hb;for(var Eb of ya.items)if(Nb)Array.add(Ra.items,Eb+hb);else for(var Yb of hb.items)Array.add(Ra.items,Eb+Yb);return Ra}Eb=this.Ja.query.rp(ya,Ra);if("string"===typeof Eb)return ya+Eb;Yb=new tb.a(this.Ja.annotations,R.Annotations.kZ);for(hb of Eb.items)Array.add(Yb.items,ya+hb);return Yb}}Object(h.a)(nb,"ConcatAnnotationQueryStep",fb,[]);class Rb extends fb{constructor(ya){super();this.Ja=ya}load(ya){return Za.wLf(this.Ja.annotations,
ya,this.qy,this.cV)}}Object(h.a)(Rb,"ConvertAnnotationQueryStep",fb,[]);class mb extends fb{constructor(){super()}load(ya){return ya.items.length}}Object(h.a)(mb,"CountAnnotationQueryStep",fb,[]);class Ub extends ac{constructor(ya){super(ya)}iub(ya,Ra){return ya/Ra}}Object(h.a)(Ub,"DivideAnnotationQueryStep",ac,[]);class zc extends fb{constructor(ya){super();this.Ja=ya}load(ya,Ra){Ra=new ka(this.Ja.gzd,null,Ra);for(const hb of ya.items)if(Ra.iYd(hb),this.Ja.query.rp(hb,Ra))return!0;return!1}}Object(h.a)(zc,
"ExistsAnnotationQueryStep",fb,[]);class Pc extends ac{constructor(ya){super(ya)}iub(ya,Ra){return Math.pow(ya,Ra)}}Object(h.a)(Pc,"ExpAnnotationQueryStep",ac,[]);class Mc{constructor(ya,Ra){ya&&(this.xta=Ra.$C(ya.ga(0)))}}Object(h.a)(Mc,"FeatureBundleNameQueryStepInit",null,[]);class ld extends fb{constructor(ya){super();this.Ja=ya}load(ya){if(R.Annotations.pC(this.qy)){const Ra=new tb.a(this.Ja.annotations,this.Ja.annotations.zab(R.Annotations.SEa(this.qy),this.Ja.yta));for(const hb of ya.items)Array.add(Ra.items,
hb.VTa(this.Ja.yta));return Ra}return ya.VTa(this.Ja.yta)}store(ya,Ra,hb,Eb){if(R.Annotations.pC(this.qy)){var Yb=Ra,Nb=({Ipa:Eb}=this.WEa(Eb)).returnValue;if(Nb){Yb=new tb.a(this.Ja.annotations,this.Ja.annotations.zab(R.Annotations.SEa(this.qy),this.Ja.yta));for(var ed of ya.items)Array.add(Yb.items,ed.VTa(this.Ja.yta));Yb=Nb.store(Yb,Ra,hb,Eb)}Ra=Yb;if(Ra.items.length!==ya.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");for(let zd=0,Hd=ya.items.length;zd<
Hd;++zd)hb=ya.items[zd],hb.isReadOnly&&(hb=hb.clone(),ya.items[zd]=hb),hb.NZe(this.Ja.yta,Ra.items[zd])}else Nb=Ra,(ed=({Ipa:Eb}=this.WEa(Eb)).returnValue)&&(Nb=ed.store(R.Annotations.mL(ya.VTa(this.Ja.yta)),Ra,hb,Eb)),ya.NZe(this.Ja.yta,Nb);return ya}}Object(h.a)(ld,"FieldAnnotationQueryStep",fb,[]);class vb{constructor(ya,Ra){ya&&(this.annotations=Ra,this.yta=ya.ga(0))}}Object(h.a)(vb,"FieldQueryStepInit",null,[]);class cc extends fb{constructor(ya){super();this.Ja=ya}load(ya,Ra){for(const hb of ya.items)if(this.Ja.filter.isMatch(hb,
Ra))return hb;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(ya,Ra,hb,Eb){let Yb=Ra,Nb=-1;for(let zd=0,Hd=ya.items.length;zd<Hd;zd++)if(this.Ja.filter.isMatch(ya.items[zd],hb)){Nb=zd;break}if(0>Nb)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const ed=({Ipa:Eb}=this.WEa(Eb)).returnValue;ed&&(Yb=ed.store(R.Annotations.mL(ya.items[Nb]),Ra,hb,Eb));ya.items[Nb]=Yb;return ya}}Object(h.a)(cc,"FirstItemMatchingAnnotationQueryStep",
fb,[]);class Hc extends fb{constructor(ya){super();this.Ja=ya}load(ya,Ra){Ra=new ka(this.Ja.gzd,null,Ra);for(const hb of ya.items)if(Ra.iYd(hb),!this.Ja.query.rp(hb,Ra))return!1;return!0}}Object(h.a)(Hc,"ForAllAnnotationQueryStep",fb,[]);class Pb extends fb{constructor(ya){super();this.Ja=ya}load(ya,Ra){ya=Ra?Ra.oVc(this.Ja.xta):null;if(!ya)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ja.xta+'"');return ya}store(ya,Ra,hb,Eb){ya=hb?hb.oVc(this.Ja.xta):null;if(!ya)throw Error.invalidOperation('Feature bundle resolution failure: "'+
this.Ja.xta+'"');let Yb=Ra;const Nb=({Ipa:Eb}=this.WEa(Eb)).returnValue;Nb&&(Yb=Nb.store(ya,Ra,hb,Eb));ya!==Yb&&ya.oDa(Yb);return ya}}Object(h.a)(Pb,"GetAnnotationQueryStep",fb,[]);class Uc{constructor(ya,Ra){this.nWh=ya;this.L4h=Ra}get pNf(){return this.nWh}get Jhh(){return this.L4h}}Object(h.a)(Uc,"AnnotationQueryStoreContinuation",null,[1140]);class sc extends fb{constructor(ya){super();this.Ja=ya}load(ya,Ra){return this.Ja.bwd.rp(ya,Ra)?this.Ja.fKh.rp(ya,Ra):this.Ja.oSc?this.Ja.oSc.rp(ya,Ra):
ya}store(ya,Ra,hb,Eb){var Yb=this.Ja.bwd.rp(ya,hb);this.next&&(Eb=new Uc(this.next,Eb));if(Yb)return this.Ja.fKh.hPb(ya,Ra,hb,Eb);if(this.Ja.oSc)return this.Ja.oSc.hPb(ya,Ra,hb,Eb);Yb=Ra;let Nb=null;Eb&&(Nb=Eb.pNf,Eb=Eb.Jhh);Nb&&(Yb=Nb.store(R.Annotations.mL(ya),Ra,hb,Eb));return Yb}}Object(h.a)(sc,"IfAnnotationQueryStep",fb,[]);class lb{constructor(ya,Ra){ya&&(this.bwd=Ra.oE(ya.ga(0)),this.fKh=Ra.oE(ya.ga(1)),this.oSc=ya.ga(2)?Ra.oE(ya.ga(2)):null)}}Object(h.a)(lb,"IfQueryStepInit",null,[]);class Zb{constructor(ya,
Ra){ya&&(this.TLj=Ra.oE(ya.ga(0)),this.ytg=Ra.oE(ya.ga(1)))}}Object(h.a)(Zb,"IndexAndItemQueryStepInit",null,[]);class Oc extends fb{constructor(ya){super();this.Ja=ya}load(ya,Ra){const hb=this.Ja.TLj.rp(ya,Ra);Ra=this.Ja.ytg.rp(ya,Ra);ya=ya.clone();if(0>hb||hb>ya.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(R.Annotations.pC(this.Ja.ytg.cV))for(let Eb=0;Eb<Ra.items.length;++Eb)Array.insert(ya.items,hb+Eb,Ra.items[Eb]);else Array.insert(ya.items,hb,Ra);
return ya}}Object(h.a)(Oc,"InsertAtAnnotationQueryStep",fb,[]);class md extends fb{constructor(ya){super();this.Ja=ya}load(ya,Ra){return!(!Ra||!Ra.oVc(this.Ja.xta))}}Object(h.a)(md,"IsDefinedAnnotationQueryStep",fb,[]);class Ib extends fb{constructor(ya){super();this.Ja=ya}load(ya,Ra){Ra=this.qyb(ya,Ra);return ya.items[Ra]}store(ya,Ra,hb,Eb){const Yb=this.qyb(ya,hb);let Nb=Ra;const ed=({Ipa:Eb}=this.WEa(Eb)).returnValue;ed&&(Nb=ed.store(R.Annotations.mL(ya.items[Yb]),Ra,hb,Eb));ya.items[Yb]=Nb;return ya}qyb(ya,
Ra){Ra=this.Ja.query.rp(ya,Ra);if(0>Ra||Ra>=ya.items.length)throw Error.invalidOperation("Index out of range in Item store step");return Ra}}Object(h.a)(Ib,"ItemAnnotationQueryStep",fb,[]);class ud extends fb{constructor(ya){super();this.Ja=ya}load(ya,Ra){const hb=new tb.a(this.Ja.annotations,R.Annotations.SEa(this.qy));for(const Eb of ya.items)this.Ja.filter.isMatch(Eb,Ra)&&Array.add(hb.items,Eb);return hb}}Object(h.a)(ud,"ItemsMatchingAnnotationQueryStep",fb,[]);class od extends fb{constructor(ya){super();
this.Ja=ya}load(ya,Ra){Ra=this.qyb(ya,Ra);return ya.items[ya.items.length-Ra-1]}store(ya,Ra,hb,Eb){const Yb=this.qyb(ya,hb);let Nb=Ra;const ed=({Ipa:Eb}=this.WEa(Eb)).returnValue;ed&&(Nb=ed.store(R.Annotations.mL(ya.items[ya.items.length-Yb-1]),Ra,hb,Eb));ya.items[ya.items.length-Yb-1]=Nb;return ya}qyb(ya,Ra){Ra=this.Ja.query?this.Ja.query.rp(ya,Ra):0;if(0>Ra||Ra>=ya.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");return Ra}}Object(h.a)(od,"LastItemAnnotationQueryStep",
fb,[]);class Ud extends fb{constructor(ya){super();this.Ja=ya}load(ya){if(R.Annotations.pC(this.qy)){const Ra=new tb.a(this.Ja.annotations,R.Annotations.Tpa);for(const hb of ya.items)Array.add(Ra.items,hb.length);return Ra}return ya.length}}Object(h.a)(Ud,"LengthAnnotationQueryStep",fb,[]);class Ad extends fb{constructor(ya){super();this.Ja=ya}load(ya,Ra){if(R.Annotations.pC(this.qy)){const hb=new tb.a(this.Ja.annotations,R.Annotations.mha);for(const Eb of ya.items)Array.add(hb.items,this.Ja.filter.isMatch(Eb,
Ra));return hb}return this.Ja.filter.isMatch(ya,Ra)}}Object(h.a)(Ad,"MatchesAnnotationQueryStep",fb,[]);class be extends fb{constructor(ya){super();this.Ja=ya}load(ya,Ra){return this.Ja.filter.isMatch(ya,Ra)}}Object(h.a)(be,"MatchesAsListAnnotationQueryStep",fb,[]);class uf extends ac{constructor(ya){super(ya)}iub(ya,Ra){return ya%Ra}}Object(h.a)(uf,"ModuloAnnotationQueryStep",ac,[]);class sd extends ac{constructor(ya){super(ya)}iub(ya,Ra){return ya*Ra}}Object(h.a)(sd,"MultiplyAnnotationQueryStep",
ac,[]);class Ze extends fb{constructor(ya){super();this.Ja=ya}load(ya){if(R.Annotations.pC(this.qy)){const Ra=new tb.a(this.Ja.annotations,R.Annotations.mha);for(const hb of ya.items)Array.add(Ra.items,!hb);return Ra}return!ya}}Object(h.a)(Ze,"NotAnnotationQueryStep",fb,[]);class Ke extends Sc{constructor(ya){super(ya)}hIf(ya){return{returnValue:ya,result:!0}}B2b(ya,Ra){return ya||Ra}}Object(h.a)(Ke,"OrAnnotationQueryStep",Sc,[]);class hf extends fb{constructor(ya){super();this.Ja=ya}load(ya,Ra){const hb=
this.Ja.F3e.rp(ya,Ra);ya=this.Ja.b3b.rp(ya,Ra);Ra=new tb.a(this.Ja.annotations,R.Annotations.Tpa);for(let Eb=0;Eb<ya;++Eb)Array.add(Ra.items,hb+Eb);return Ra}}Object(h.a)(hf,"RangeAnnotationQueryStep",fb,[]);class Xa{constructor(ya,Ra){ya&&(this.annotations=Ra.annotations,this.filter=Ra.b9(ya.ga(0)))}}Object(h.a)(Xa,"SingleFilterQueryStepInit",null,[]);class Bb{constructor(ya,Ra){ya&&(this.annotations=Ra.annotations,this.query=ya.ga(0)?Ra.oE(ya.ga(0)):null)}}Object(h.a)(Bb,"SingleOptionalQueryQueryStepInit",
null,[]);class mc{constructor(ya,Ra){ya&&(this.annotations=Ra.annotations,this.query=Ra.oE(ya.ga(0)))}}Object(h.a)(mc,"SingleQueryQueryStepInit",null,[]);class Qc{constructor(ya,Ra){ya&&(this.annotations=Ra.annotations,this.F3e=Ra.oE(ya.ga(0)),this.b3b=ya.ga(1)?Ra.oE(ya.ga(1)):null)}}Object(h.a)(Qc,"StartAndCountOrLengthQueryStepInit",null,[]);class td extends fb{constructor(ya){super();this.Ja=ya}load(ya,Ra){let hb;({rMa:Ra,length:hb}=this.oXc(ya,Ra));const Eb=new tb.a(this.Ja.annotations,ya.QU);
for(let Yb=0;Yb<hb;++Yb)Array.add(Eb.items,ya.items[Ra+Yb]);return Eb}store(ya,Ra,hb,Eb){let Yb,Nb;({rMa:Yb,length:Nb}=this.oXc(ya,hb));var ed=Ra;const zd=({Ipa:Eb}=this.WEa(Eb)).returnValue;if(zd){ed=new tb.a(this.Ja.annotations,ya.QU);for(let Hd=0;Hd<Nb;++Hd)Array.add(ed.items,ya.items[Yb+Hd]);ed=zd.store(ed,Ra,hb,Eb)}Ra=ed;for(hb=0;hb<Nb;++hb)Array.removeAt(ya.items,Yb);for(let Hd=0,ba=Ra.items.length;Hd<ba;++Hd)Array.insert(ya.items,Yb+Hd,Ra.items[Hd]);return ya}oXc(ya,Ra){let hb;hb=this.Ja.F3e.rp(ya,
Ra);if(0>hb)throw Error.invalidOperation("Invalid start index in Sublist() query step");Ra=this.Ja.b3b?this.Ja.b3b.rp(ya,Ra):ya.items.length-hb;if(0>Ra||hb+Ra>ya.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{rMa:hb,length:Ra}}}Object(h.a)(td,"SublistAnnotationQueryStep",fb,[]);class Md extends fb{constructor(ya){super();this.Ja=ya}load(ya,Ra){if(R.Annotations.pC(this.qy)){const hb=new tb.a(this.Ja.annotations,R.Annotations.kZ);for(let Eb=
0,Yb=ya.items.length;Eb<Yb;++Eb)Array.add(hb.items,this.getSubstring(ya.items[Eb],Ra));return hb}return this.getSubstring(ya,Ra)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}getSubstring(ya,Ra){let hb;({rMa:Ra,length:hb}=this.oXc(ya,Ra));return ya.substr(Ra,hb)}oXc(ya,Ra){let hb;hb=this.Ja.F3e.rp(ya,Ra);if(0>hb)throw Error.invalidOperation("Invalid start index in Substring() query step");Ra=this.Ja.b3b?this.Ja.b3b.rp(ya,Ra):ya.length-hb;if(0>Ra||hb+Ra>
ya.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{rMa:hb,length:Ra}}}Object(h.a)(Md,"SubstringAnnotationQueryStep",fb,[]);class Pd extends ac{constructor(ya){super(ya)}iub(ya,Ra){return ya-Ra}}Object(h.a)(Pd,"SubtractAnnotationQueryStep",ac,[]);class Be extends fb{constructor(ya){super();this.Ja=ya}load(ya){const Ra=new tb.a(this.Ja.annotations,R.Annotations.kZ);for(let hb=0;hb<ya.length;++hb)Array.add(Ra.items,ya.charAt(hb).toString());
return Ra}}Object(h.a)(Be,"ToCharListAnnotationQueryStep",fb,[]);class fe extends fb{constructor(ya){super();this.Ja=ya}load(ya){const Ra=new tb.a(this.Ja.annotations,this.qy);Array.add(Ra.items,ya);return Ra}}Object(h.a)(fe,"ToListAnnotationQueryStep",fb,[]);class Mf extends fb{constructor(ya){super();this.Ja=ya}load(){return this.Ja.value}}Object(h.a)(Mf,"ValueAnnotationQueryStep",fb,[]);class Bd{constructor(ya,Ra){if(ya){var hb=ya.ga(0),Eb=1;this.value=({l4:Eb}=Ra.Vsa(hb,ya,Eb,null,null,null)).returnValue;
R.Annotations.ldb(this.value)}}}Object(h.a)(Bd,"ValueQueryStepInit",null,[]);class Rc{constructor(ya,Ra){ya&&(this.gzd=Ra.$C(ya.ga(0)),this.query=Ra.oE(ya.ga(1)))}}Object(h.a)(Rc,"VarNameAndQueryQueryStepInit",null,[]);class Gf{constructor(ya,Ra){this.Bgf=null;if(ya){this.annotations=Ra.annotations;var hb=0;this.qy=ya.ga(hb);++hb;this.cV=ya.ga(hb);++hb;this.svd=1===ya.ga(hb);++hb;this.C0c=1===ya.ga(hb);++hb;var Eb=ya.ga(hb);++hb;if(Eb){var Yb=hb,Nb=hb+Eb,ed=hb+2*Eb;hb+=3*Eb;var zd=ya.count-hb,Hd=
null;for(let Aa=0;Aa<Eb;++Aa){var ba=hb+ya.ga(ed+Aa);const Pa=(Aa===Eb-1?zd:ya.ga(ed+Aa+1))-ya.ga(ed+Aa),ub=new Ab.a;ub.xTa(ya,ba,Pa);ba=Gf.cmj(ya.ga(Nb+Aa),ub,Ra);ba.qy=ya.ga(Yb+Aa);ba.cV=Aa===Eb-1?this.cV:ya.ga(Yb+Aa+1);Hd?Hd.next=ba:this.Bgf=ba;Hd=ba}}}}get $0f(){return this.Bgf}static cmj(ya,Ra,hb){switch(ya){case 1:return new Pb(new Mc(Ra,hb));case 2:return new md(new Mc(Ra,hb));case 3:return new ic(new nc(Ra,hb.annotations));case 4:return new ld(new vb(Ra,hb.annotations));case 5:return new sc(new lb(Ra,
hb));case 6:return new Ad(new Xa(Ra,hb));case 43:return new be(new Xa(Ra,hb));case 45:return new ob(new xc(Ra,hb));case 49:return new fc(new Jb(Ra,hb));case 46:return new Mf(new Bd(Ra,hb.annotations));case 51:return new Wb(new wc(Ra,hb));case 52:return new hf(new Qc(Ra,hb));case 53:return new Rb(new Ta(hb.annotations));case 13:return new Ib(new mc(Ra,hb));case 14:return new od(new Bb(Ra,hb));case 15:return new mb;case 18:return new cc(new Xa(Ra,hb));case 16:return new Hc(new Rc(Ra,hb));case 17:return new zc(new Rc(Ra,
hb));case 22:return new Oc(new Zb(Ra,hb));case 24:return new ib(new mc(Ra,hb));case 26:return new td(new Qc(Ra,hb));case 27:return new ud(new Xa(Ra,hb));case 30:return new fe(new Ta(hb.annotations));case 31:return new Md(new Qc(Ra,hb));case 32:return new nb(new mc(Ra,hb));case 47:return new Ud(new Ta(hb.annotations));case 48:return new Be(new Ta(hb.annotations));case 34:return new Dc(new mc(Ra,hb));case 35:return new Pd(new mc(Ra,hb));case 36:return new sd(new mc(Ra,hb));case 37:return new Ub(new mc(Ra,
hb));case 38:return new uf(new mc(Ra,hb));case 39:return new Pc(new mc(Ra,hb));case 40:return new xb(new mc(Ra,hb));case 41:return new Ke(new mc(Ra,hb));case 42:return new Ze(new Ta(hb.annotations));default:throw Error.argument("currStepInitData");}}}Object(h.a)(Gf,"AnnotationQueryInit",null,[]);class Nf{constructor(ya){this.Ja=ya}execute(ya,Ra){this.N8(ya,ya?new ka("root",ya,Ra):Ra)}N8(ya,Ra){for(const hb of this.Ja.commands)Ra=hb.execute(ya,Ra)}}Object(h.a)(Nf,"AnnotationScript",null,[1112]);class Oa{constructor(ya){this.Ja=
ya}execute(ya,Ra){const hb=this.Ja.DPj.rp(ya,Ra),Eb=this.Ja.LKk.rp(ya,Ra);this.Ja.script.N8(ya,new ka("Input",hb,new ka("Output",Eb,Ra)));return Ra}}Object(h.a)(Oa,"ApplyAnnotationScriptCommand",null,[1131]);class cb{constructor(ya,Ra){ya&&(this.DPj=Ra.oE(ya.ga(0)),this.LKk=Ra.oE(ya.ga(1)),this.script=Ra.F$a(ya.ga(2)))}}Object(h.a)(cb,"ApplyScriptCommandInit",null,[]);class Ic{constructor(ya){this.Ja=ya}execute(ya,Ra){const hb=this.Ja.NXe.rp(ya,Ra);this.Ja.i5c.hPb(ya,hb,Ra,null);return Ra}}Object(h.a)(Ic,
"AssignAnnotationScriptCommand",null,[1131]);class qd{constructor(ya){this.Ja=ya}execute(ya,Ra){const hb=this.Ja.i5c.rp(ya,Ra);ya=this.Ja.NXe.rp(ya,Ra);hb!==ya&&hb.oDa(ya);return Ra}}Object(h.a)(qd,"CopyAnnotationScriptCommand",null,[1131]);class le{constructor(ya){this.Ja=ya}execute(ya,Ra){let hb=this.Ja.Sre.rp(ya,Ra);if(this.Ja.Sre.svd){hb=R.Annotations.mL(hb);var Eb=new ka(this.Ja.xta,null,Ra);for(let Nb=0,ed=hb.items.length;Nb<ed;++Nb){var Yb=this.BYf(ya,hb.items[Nb],Eb);if(0>this.Ja.Upd)hb.items[Nb]=
Yb;else if(({value:Yb}=Yb.jn(this.Ja.Upd)).returnValue)hb.items[Nb]=Yb;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}this.Ja.Sre.hPb(ya,hb,Ra,null)}else{Eb=new ka(this.Ja.xta,null,Ra);for(let Nb=0,ed=hb.items.length;Nb<ed;++Nb)this.BYf(ya,hb.items[Nb],Eb)}return Ra}BYf(ya,Ra,hb){let Eb;0>this.Ja.Upd?Eb=R.Annotations.mL(Ra):(Eb=new C.a(this.Ja.annotations),Eb.Du(this.Ja.Upd,Ra));hb.iYd(Eb);this.Ja.aqi.N8(ya,hb);return Eb}}Object(h.a)(le,"EnumerateAnnotationScriptCommand",
null,[1131]);class yb{constructor(ya,Ra){ya&&(this.annotations=Ra.annotations,this.xta=Ra.$C(ya.ga(0)),this.Sre=Ra.oE(ya.ga(1)),this.aqi=Ra.F$a(ya.ga(2)),this.Upd=ya.ga(3))}}Object(h.a)(yb,"EnumerateScriptCommandInit",null,[]);class ef{constructor(ya){this.Ja=ya}execute(ya,Ra){this.Ja.bwd.rp(ya,Ra)?this.Ja.aJl.N8(ya,Ra):this.Ja.l_f&&this.Ja.l_f.N8(ya,Ra);return Ra}}Object(h.a)(ef,"IfAnnotationScriptCommand",null,[1131]);class Cb{constructor(ya,Ra){ya&&(this.bwd=Ra.oE(ya.ga(0)),this.aJl=Ra.F$a(ya.ga(1)),
this.l_f=ya.ga(2)?Ra.F$a(ya.ga(2)):null)}}Object(h.a)(Cb,"IfScriptCommandInit",null,[]);class oc{constructor(ya,Ra){ya&&(this.annotations=Ra.annotations,this.i5c=Ra.oE(ya.ga(0)),this.NXe=Ra.oE(ya.ga(1)))}}Object(h.a)(oc,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class vc{constructor(ya){this.Ja=ya}execute(ya,Ra){const hb=this.Ja.NXe.rp(this.Ja.i5c.rp(ya,Ra),Ra);this.Ja.i5c.hPb(ya,hb,Ra,null);return Ra}}Object(h.a)(vc,"ModifyAnnotationScriptCommand",null,[1131]);class nd{constructor(ya){this.Ja=
ya}execute(ya,Ra){const hb=new C.a(this.Ja.annotations);this.Ja.query&&hb.oDa(this.Ja.query.rp(ya,Ra));return Ra=new ka(this.Ja.xta,hb,Ra)}}Object(h.a)(nd,"NewAnnotationScriptCommand",null,[1131]);class id{constructor(ya,Ra){ya&&(this.annotations=Ra.annotations,this.xta=Ra.$C(ya.ga(0)),this.query=ya.ga(1)?Ra.oE(ya.ga(1)):null)}}Object(h.a)(id,"NewScriptCommandInit",null,[]);class Nd{constructor(ya){this.Ja=ya}execute(ya,Ra){ya=this.Ja.query.rp(ya,Ra);if(this.Ja.query.cV===R.Annotations.kN)ya.Mod(this.Ja.Sca);
else for(const hb of ya.items)hb.Mod(this.Ja.Sca);return Ra}}Object(h.a)(Nd,"RemoveAnnotationScriptCommand",null,[1131]);class Ce{constructor(ya,Ra){ya&&(this.annotations=Ra.annotations,this.query=Ra.oE(ya.ga(0)),this.Sca=ya.ga(1))}}Object(h.a)(Ce,"RemoveScriptCommandInit",null,[]);class af{constructor(ya,Ra){if(ya){var hb=0,Eb=ya.ga(hb);++hb;if(Eb){var Yb=hb,Nb=hb+Eb;hb+=2*Eb;var ed=ya.count-hb;this.commands=Array(Eb);for(let zd=0;zd<Eb;++zd){const Hd=hb+ya.ga(Nb+zd),ba=(zd===Eb-1?ed:ya.ga(Nb+zd+
1))-ya.ga(Nb+zd),Aa=new Ab.a;Aa.xTa(ya,Hd,ba);this.commands[zd]=af.Zlj(ya.ga(Yb+zd),Aa,Ra)}}}}static Zlj(ya,Ra,hb){switch(ya){case 1:return new Ic(new oc(Ra,hb));case 2:return new vc(new oc(Ra,hb));case 3:return new Nd(new Ce(Ra,hb));case 6:return new nd(new id(Ra,hb));case 7:return new le(new yb(Ra,hb));case 8:return new ef(new Cb(Ra,hb));case 9:return new qd(new oc(Ra,hb));case 10:return new Oa(new cb(Ra,hb));default:throw Error.argument("initData");}}}Object(h.a)(af,"AnnotationScriptInit",null,
[]);var de=d(719);class $f{constructor(ya){this.lI=ya;this.uN=0}HY(){const ya=this.lI.Cu(this.uN,4);this.uN+=4;return ya}get p0b(){return this.lI}get offset(){return this.uN}set offset(ya){this.uN=ya}}Object(h.a)($f,"ByteArrayReader",null,[]);class ge{constructor(){this.kD=null;this.KFg=this.Az=0}ga(ya){if(0>ya||ya>=this.Az)throw Error.argumentOutOfRange("index");return this.kD.Cu(this.KFg+4*ya,4)}get count(){return this.Az}static lLi(ya,Ra,hb){const Eb=new ge;Eb.kD=ya;Eb.KFg=Ra;Eb.Az=hb;return Eb}}
Object(h.a)(ge,"ReadOnlyListOverByteArray",null,[1078]);class ze{constructor(ya,Ra){this.yDg=this.gDg=!1;this.Mr=this.qxa=this.ste=this.JDg=null;try{this.Mr=Ra.annotations;const hb=Ra.ITa(ya.ga(0)),Eb=new $f(hb);if(-914743053!==Eb.HY())throw Error.argument("Input does not represent a flat lexicon");this.gDg=1===Eb.HY();this.yDg=1===Eb.HY();const Yb=Eb.HY();Eb.offset+=Yb;const Nb=Eb.HY();this.ste=ze.iMk(Eb,Nb,this.Mr);const ed=Eb.HY();this.JDg=ze.vMk(Eb,ed);const zd=Eb.HY();this.qxa=new de.a(Eb.p0b,
Eb.offset);Eb.offset+=zd}catch(hb){throw Error.argument("initData");}}get trie(){return this.qxa}Obj(ya){return"i"===ya&&this.yDg?"\u0130":ya.toUpperCase()}Dme(){return this.gDg}oaj(ya){let Ra;Ra=new tb.a(this.Mr,R.Annotations.kN);if(1!==ya)if(0===ya)ya=new C.a(this.Mr),Array.add(Ra.items,ya);else if(ya&1073741824){ya=this.JDg[ya&-1073741825];for(let Eb=0;Eb<ya.length;++Eb){var hb=ya[Eb];hb=0===hb?new C.a(this.Mr):this.ste[hb-2];Array.add(Ra.items,hb)}}else Array.add(Ra.items,this.ste[ya-2]);return{returnValue:!0,
M8j:Ra}}static iMk(ya,Ra,hb){if(Ra%4)throw Error.argument("reader");const Eb=ge.lLi(ya.p0b,ya.offset,Ra/4);ya.offset+=Ra;ya=[];for(Ra=0;Ra<Eb.count;){const Yb=({l4:Ra}=hb.Vsa(R.Annotations.kN,Eb,Ra,null,null,null)).returnValue;Array.add(ya,Yb)}return ya}static vMk(ya,Ra){Ra=ya.offset+Ra;const hb=[];for(;ya.offset<Ra;){const Eb=ya.HY(),Yb=Array(Eb);for(let Nb=0;Nb<Eb;++Nb){const ed=ya.HY();Yb[Nb]=ed}Array.add(hb,Yb)}return hb}}Object(h.a)(ze,"RawFlatLexicon",null,[1111]);var si=d(708),sh=d(709);class dd{constructor(ya){if(null==
ya)throw Error.argumentNull("base64String");const Ra=ya.length;if(Ra%4)throw Error.argument("base64String's length must be a multiple of 4");this.Az=.75*Ra;this.Qva=Array(Math.ceil(this.Az/4));ya.endsWith("==")?this.Az-=2:ya.endsWith("=")&&--this.Az;let hb=0;for(let Eb=0;Eb<Ra;Eb+=4){const Yb=dd.Fqd[ya.charCodeAt(Eb)-43]<<18|dd.Fqd[ya.charCodeAt(Eb+1)-43]<<12|dd.Fqd[ya.charCodeAt(Eb+2)-43]<<6|dd.Fqd[ya.charCodeAt(Eb+3)-43];let Nb=Yb>>16&255;this.Qva[Math.floor(hb/4)]|=Nb<<hb%4*8;++hb;Nb=Yb>>8&255;
this.Qva[Math.floor(hb/4)]|=Nb<<hb%4*8;++hb;Nb=Yb&255;this.Qva[Math.floor(hb/4)]|=Nb<<hb%4*8;++hb}}get length(){return this.Az}ga(ya){if(0>ya||ya>=this.Az)throw Error.argumentOutOfRange("i");return this.v4f(ya)}Cu(ya,Ra){if(0>ya||0>Ra||ya+Ra>this.Az)throw Error.argument("Bad range");let hb=0;for(let Eb=0;Eb<Ra;++Eb)hb|=this.v4f(ya+Eb)<<8*Eb;return hb}Z_k(ya,Ra){let hb=0,Eb=0,Yb=Math.floor(ya/8);for(ya%=8;Eb<Ra;){const Nb=8-ya>Ra-Eb?Ra-Eb:8-ya,ed=this.ga(Yb);hb|=(ed>>ya&~(255<<Nb))<<Eb;Eb+=Nb;++Yb;
ya=0}return hb}v4f(ya){return this.Qva[Math.floor(ya/4)]>>ya%4*8&255}}dd.Fqd=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(h.a)(dd,"ByteArray",null,[]);class Lc{constructor(ya,Ra,hb){this.Cy=ya;this.nhk=Ra;this.Ilk=hb;this.sGg=Array(ya.b?ya.b.length:0);this.wGe=new si.a(new sh.a(this.ITa(this.Cy.s)));this.LX=Array(ya.t.length);
this.$Th=new R.Annotations(this.FTa(0),this)}get annotations(){return this.$Th}get zWi(){return this.Cy.d}Elj(){if(!(""in this.Cy.m))throw Error.argument("name","Unrecognized module");return this.rbe(this.Cy.m[""])}ITa(ya){if(0>ya||!this.Cy.b||ya>=this.Cy.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.sGg[ya]||(this.sGg[ya]=new dd(this.Cy.b[ya]))}$C(ya){if(1>ya||ya>=this.Cy.t.length)throw Error.argumentOutOfRange("blobID");if(1!==this.Cy.t[ya])throw Error.argument("blobID","Requested blob is not a string");
if(null==this.LX[ya]){const Ra=this.FTa(ya).ga(0);this.LX[ya]=this.wGe.$C(Ra)}return this.LX[ya]}V$f(ya){if(1>ya||ya>=this.Cy.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.Cy.t[ya])throw Error.argument("blobID","Requested blob is not a Regex");if(!this.LX[ya]){var Ra=this.FTa(ya);const hb=this.$C(Ra.ga(0));Ra=1===Ra.ga(1);this.LX[ya]=new RegExp(hb,Ra?"i":"")}return this.LX[ya]}mqj(ya){if(1>ya||ya>=this.Cy.t.length)throw Error.argumentOutOfRange("blobID");if(3!==this.Cy.t[ya])throw Error.argument("blobID",
"Requested blob is not an SRE");throw Error.notImplemented();}rbe(ya){if(1>ya||ya>=this.Cy.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.Cy.t[ya])throw Error.argument("blobID","Requested blob is not an NL module");return this.LX[ya]||(this.LX[ya]=this.Ilk.Ulj(this.FTa(ya),this))}oE(ya){if(1>ya||ya>=this.Cy.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.Cy.t[ya])throw Error.argument("blobID","Requested blob is not an annotation query");return this.LX[ya]||(this.LX[ya]=
new Za(new Gf(this.FTa(ya),this)))}F$a(ya){if(1>ya||ya>=this.Cy.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.Cy.t[ya])throw Error.argument("blobID","Requested blob is not an annotation script");return this.LX[ya]||(this.LX[ya]=new Nf(new af(this.FTa(ya),this)))}b9(ya){if(1>ya||ya>=this.Cy.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.Cy.t[ya])throw Error.argument("blobID","Requested blob is not a filter");return this.LX[ya]||(this.LX[ya]=this.nhk.b9(this.FTa(ya),this))}Woj(ya){if(1>
ya||ya>=this.Cy.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.Cy.t[ya])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.LX[ya]||(this.LX[ya]=new ze(this.FTa(ya),this))}FTa(ya){const Ra=this.Cy.n[ya];ya=(ya<this.Cy.t.length-1?this.Cy.n[ya+1]:this.Cy.n.length)-Ra;if(0>Ra||0>ya||Ra+ya>this.Cy.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+Ra+","+ya+")");const hb=new Ab.a;hb.HTc(this.Cy.n,Ra,ya);return hb}}Object(h.a)(Lc,
"ObjectFetcher",null,[1053]);class Zd{constructor(ya,Ra,hb){if(!ya)throw Error.argumentNull("prediction");if(!Ra)throw Error.argumentNull("fieldNames");if(!hb)throw Error.argumentNull("values");if(Ra.length!==hb.length)throw Error.argument("values","fieldNames and values do not have same length");this.A4h=ya;this.ueb=Ra;this.mhb=hb}get prediction(){return this.A4h}get y_f(){return this.ueb.length}L$d(ya){return 0<=ya&&ya<this.ueb.length?this.ueb[ya]:null}eb(ya){return 0<=ya&&ya<this.mhb.length?this.mhb[ya]:
null}}Object(h.a)(Zd,"PredictionData",null,[]);class Ne{constructor(ya,Ra){if(!ya)throw Error.argumentNull("predictions");if(!Ra)throw Error.argumentNull("tokenAttributes");this.kok=ya;this.Zrk=Ra}dce(){return this.kok}J3f(){return this.Zrk}}Object(h.a)(Ne,"PredictionDataWithTokenAttributes",null,[]);class Xc{constructor(ya,Ra){this.prediction=null;this.score=0;this.prediction=ya;this.score=Ra}}Object(h.a)(Xc,"PredictionWithScore",null,[]);class lf{constructor(ya,Ra){if(!ya)throw Error.argumentNull("predictions");
if(!Ra)throw Error.argumentNull("attributes");this.B4h=ya;this.xUh=Ra}dce(){return this.B4h}J3f(){return this.xUh}}Object(h.a)(lf,"PredictionsWithTokenAttributes",null,[]);class Kh{constructor(ya,Ra,hb){if(!ya)throw Error.argumentNull("attributeName");if(!Ra)throw Error.argumentNull("fieldNames");if(!hb)throw Error.argumentNull("values");if(Ra.length!==hb.length)throw Error.argument("values","fieldNames and values do not have same length");this.wUh=ya;this.ueb=Ra;this.mhb=hb}get attributeName(){return this.wUh}get y_f(){return this.ueb.length}L$d(ya){return 0<=
ya&&ya<this.ueb.length?this.ueb[ya]:null}eb(ya){return 0<=ya&&ya<this.mhb.length?this.mhb[ya]:null}}Object(h.a)(Kh,"TokenAttributes",null,[]);var bd=d(7),fd=d(1);class Ve{constructor(ya,Ra,hb,Eb,Yb){this.Qxc=0;this.daf=null;this.Rxc=this.LRb=0;this.Nzd=this.Knb=this.Jba=this.MRb=null;this.eaf=0;this.C5a=this.$y=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.AK=ya;this.qRh=this.vRh=Ra;this.pRh=this.sRh=hb;this.Mxc=this.rRh=
Eb;this.Nxc=this.tRh=Yb}Kzd(){this.Rxc=0;return this.KRb}KRb(){if(!(this.Rxc<this.Mxc))return this.Pxc;this.MRb=this.qRh.items[this.Rxc+this.pRh];this.Jba=new C.a(this.AK.Ja.annotations);1!==this.Mxc&&this.AK.Ja.zac||this.Jba.oDa(this.MRb);if(0<=this.AK.Ja.Tgd){({value:this.Knb}=this.Jba.jn(this.AK.Ja.Tgd)).returnValue?this.Knb=this.Knb.mL():this.Knb=new tb.a(this.AK.Ja.annotations,R.Annotations.kN);this.Nzd=this.Nxc.items;this.eaf=this.Nzd.length;for(this.Qxc=0;this.Qxc<this.eaf;++this.Qxc)this.daf=
this.Nzd[this.Qxc],Array.add(this.Knb.items,this.daf);this.Jba.Du(this.AK.Ja.Tgd,this.Knb)}else 0<=this.AK.Ja.M2e?this.Jba.Du(this.AK.Ja.M2e,this.Nxc.items[0]):0<=this.AK.Ja.rWd?this.Jba.Du(this.AK.Ja.rWd,!0):this.AK.Ja.lqg?this.Nxc.items[0].oTc((ya,Ra)=>this.Jba.Du(ya,Ra)):(this.Jba.oDa(this.Nxc.items[0]),1!==this.Mxc&&this.AK.Ja.zac||(({value:this.LRb}=this.MRb.jn(this.AK.Ja.fT)).returnValue&&this.Jba.Du(this.AK.Ja.fT,this.LRb),({value:this.LRb}=this.MRb.jn(this.AK.Ja.qW)).returnValue&&this.Jba.Du(this.AK.Ja.qW,
this.LRb),this.MRb.jn(this.AK.Ja.bRa).returnValue&&this.Jba.Du(this.AK.Ja.bRa,this.LRb)));this.$y=this.Jba;this._state=2;return this.Mzd}Pxc(){this._state=3}Lzd(){this.Rxc++;return this.KRb}Mzd(){return 1<this.Mxc&&this.AK.Ja.zac?this.Pxc:this.Lzd}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new Ve(this.AK,this.vRh,this.sRh,this.rRh,this.tRh)).getEnumerator()}[Symbol.iterator](){return Object(fd.a)(this.getEnumerator())}moveNext(){if(3===this._state)return!1;this._state?
this._state=1:(this._state=1,this.C5a=this.Kzd());for(;1===this._state;)this.C5a=this.C5a();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.$y}}Object(h.a)(Ve,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",null,[107,140,142]);class rf{constructor(ya,Ra,hb){this.ogc=this.LFg=0;this.tDb=null;this.HGe=this.jue=this.gDb=this.O6c=this.kve=0;this.R7c=!1;this.cDe=ya;
this.$Ge=Ra;this.Dmk=hb}v9f(){null===this.tDb&&({oIh:this.tDb,rig:this.kve,length:this.O6c,$1i:ya}=this.cDe.Jcg(this.$Ge.items[this.ogc],this.Dmk),this.R7c=ya||this.R7c);if(this.gDb<this.O6c){var ya=this.tDb.charAt(this.kve+this.gDb);++this.gDb;return{returnValue:!0,ch:ya}}if(this.ogc===this.$Ge.items.length-1)return{returnValue:!1,ch:"\x00"};++this.ogc;this.gDb=0;this.tDb=null;return{returnValue:!0,ch:" "}}JUe(ya,Ra){this.gDb===this.O6c&&this.tDb&&(this.HGe=Ra,this.jue=this.ogc-this.LFg+1)}kbl(ya){if(0>
ya||ya>=this.$Ge.items.length)throw Error.argumentOutOfRange("iToken");this.ogc=this.LFg=ya;this.tDb=null;this.jue=this.gDb=this.O6c=this.kve=0;this.HGe=-1;this.R7c=!1}Pkj(){return{vti:this.jue,d7j:this.HGe,M1i:this.R7c}}}Object(h.a)(rf,"TriePrefixVisitor",null,[1093]);class Ag{constructor(ya){this.Ja=ya}execute(ya){if(!({value:hb}=ya.jn(this.Ja.psa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Ra;({value:Ra}=ya.jn(this.Ja.JCa)).returnValue||(Ra=null);var hb=
this.W$i(hb,Ra);ya=R.Annotations.mL(ya);ya.Du(this.Ja.psa,hb);return ya}W$i(ya,Ra){let hb=null;const Eb=this.Ja.flatLexicon.trie,Yb=new rf(this,ya,Ra);let Nb=null;this.Ja.flatLexicon.Dme()&&(Nb=Object(bd.a)(this.Ja.flatLexicon,this.Ja.flatLexicon.Obj,"getCaseInsensitiveForm"));let ed=0,zd;var Hd;let ba;for(;ed<ya.items.length;){const Aa=ya.items[ed];Yb.kbl(ed);Eb.sQh(Yb,Nb);({vti:zd,d7j:Hd,M1i:ba}=Yb.Pkj());if(0<zd){({M8j:Hd}=this.Ja.flatLexicon.oaj(Hd));for(let Pa of this.HMi(ya,ed,zd,Hd)){1<zd&&
this.Ja.zac&&this.oNi(ya,Ra,ed,Aa,zd,ba,Pa);if(!hb)for(hb=new tb.a(this.Ja.annotations,R.Annotations.kN),Hd=0;Hd<ed;++Hd)Array.add(hb.items,ya.items[Hd]);Array.add(hb.items,Pa)}ed+=zd}else hb&&Array.add(hb.items,Aa),++ed}return hb||ya}oNi(ya,Ra,hb,Eb,Yb,Nb,ed){if(Nb)Nb=!0;else if(this.Ja.Vpg){Nb=!1;var zd=-1;for(var Hd=0;Hd<Yb;Hd++){var ba=ya.items[hb+Hd];let Lb;var Aa=void 0;if(!({value:Lb}=ba.jn(this.Ja.fT)).returnValue||!({value:Aa}=ba.jn(this.Ja.qW)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");
if(0<Hd){if(Lb>zd+1){Nb=!0;break}if(0>zd||null===Ra||zd>=Ra.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");if(" "!==Ra.charAt(zd)){Nb=!0;break}}zd=Lb+Aa}}else Nb=!1;if(Nb){Aa=new Sys.StringBuilder;for(Nb=0;Nb<Yb;++Nb)({oIh:zd,rig:Hd,length:ba}=this.Jcg(ya.items[hb+Nb],Ra)),0<Nb&&Aa.append(" "),Aa.append(zd.substr(Hd,ba));ed.Du(this.Ja.bRa,Aa.toString())}ya=ya.items[hb+Yb-1];let Pa,ub;({value:Eb}=Eb.jn(this.Ja.fT)).returnValue&&
({value:Pa}=ya.jn(this.Ja.fT)).returnValue&&({value:ub}=ya.jn(this.Ja.qW)).returnValue?(ed.Du(this.Ja.fT,Eb),ed.Du(this.Ja.qW,Pa+ub-Eb)):(ed.Mod(this.Ja.fT),ed.Mod(this.Ja.qW))}HMi(ya,Ra,hb,Eb){return new Ve(this,ya,Ra,hb,Eb)}Jcg(ya,Ra){let hb,Eb;if(({value:hb}=ya.jn(this.Ja.bRa)).returnValue)Eb=!0,Ra=0,ya=hb.length;else{Eb=!1;if(null===Ra)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");hb=Ra;if(!({value:Ra}=ya.jn(this.Ja.fT)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation",
"token");if(!({value:ya}=ya.jn(this.Ja.qW)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");if(0>Ra||0>ya||Ra+ya>hb.length)throw Error.argument("Token start/length values out of range","token");}return{oIh:hb,rig:Ra,length:ya,$1i:Eb}}}Object(h.a)(Ag,"FlatLexiconNLModule",null,[1079]);class ne{constructor(ya,Ra){this.rWd=this.Tgd=this.M2e=this.bRa=this.qW=this.fT=this.JCa=this.psa=0;this.lqg=this.Vpg=this.zac=!1;this.flatLexicon=null;this.annotations=Ra.annotations;
let hb=0;try{this.psa=ya.ga(hb),++hb,this.JCa=ya.ga(hb),++hb,this.fT=ya.ga(hb),++hb,this.qW=ya.ga(hb),++hb,this.bRa=ya.ga(hb),++hb,this.M2e=ya.ga(hb),++hb,this.Tgd=ya.ga(hb),++hb,this.rWd=ya.ga(hb),++hb,this.zac=1===ya.ga(hb),++hb,this.Vpg=1===ya.ga(hb),++hb,this.lqg=1===ya.ga(hb),++hb,this.flatLexicon=Ra.Woj(ya.ga(hb))}catch(Eb){throw Error.argument("initData");}}}Object(h.a)(ne,"FlatLexiconNLModuleInit",null,[]);class kf{constructor(){this.p$b=0;this.m7d=null;this.jsc=0}}Object(h.a)(kf,"FeatureGenStackRec",
null,[]);class kg{constructor(ya){this.K6e=Array(ya);this.nQb=Array(ya);this.V3e=[];this.zFh=[]}}Object(h.a)(kg,"TokenStringLattice",null,[]);const Af=(ya,Ra,hb)=>{for(let Eb=0;Eb<ya.length;Eb++)hb=Ra(hb,ya[Eb]);return hb},Wf=(ya,Ra)=>{const hb=Array(ya.length);for(let Eb=0;Eb<ya.length;Eb++)hb[Eb]=Ra(ya[Eb]);return hb},vf=(ya,Ra)=>{Ra=Array(Math.min(Ra,ya.length));for(let hb=0;hb<Ra.length;hb++)Ra[hb]=ya[hb];return Ra},De=(ya,Ra)=>{const hb=[];for(const Eb of ya)Ra(Eb)&&Array.add(hb,Eb);return hb};
class Ee{constructor(ya,Ra){this.key=ya;this.value=Ra}}Object(h.a)(Ee,"KeyValuePair",null,[]);const Jd=(ya,Ra)=>({returnValue:Ra in ya,value:ya[Ra]}),Og=ya=>{const Ra=[];for(let hb in ya){const Eb=new Ee(hb,ya[hb]);Array.add(Ra,Eb)}return Ra};class Rg{constructor(ya){this.Icg=this.vvj;this.Ja=ya;this.Cad=this.SCe=this.TCe=0;for(const Ra of this.Ja.rSc)this.TCe=Math.max(this.TCe,Ra.fQe),this.SCe=Math.max(this.SCe,Ra.APe),this.Cad=Math.max(this.Cad,Ra.WOb.length)}get p4i(){return this.Ja.Nwd.trie}execute(ya){if(!ya)throw Error.argumentNull("input");
let Ra,hb;({tokens:Ra,G7j:hb}=this.wvj(ya));let Eb=null,Yb=null,Nb={};if(this.Ja.Uac){Ra=R.Annotations.mL(Ra);for(var ed=0;ed<Ra.items.length;++ed)Ra.items[ed]=R.Annotations.mL(Ra.items[ed])}else({q_f:Yb,returnValue:Eb}=this.V9f(ya,Nb));ed=Array(this.Cad);const zd=Array(this.Cad);for(var Hd=0;Hd<zd.length;++Hd)zd[Hd]=new kf;for(Hd=-this.TCe;Hd<Ra.items.length+this.SCe;++Hd){let ba=null;this.Ja.Uac&&(ba=Ra.items[Hd],Nb={},{q_f:Yb,returnValue:Eb}=this.V9f(ba,Nb));for(const Aa of this.Ja.rSc){if(0>Hd&&
-Hd>Aa.fQe||Hd>=Ra.items.length&&Hd-Ra.items.length+1>Aa.APe)continue;let Pa=!0;for(let ub=0;ub<Aa.WOb.length;++ub){const Lb=Hd+Aa.WOb[ub];ed[ub]=Lb;if(0>Lb?0>this.Ja.gQe:Lb>=Ra.items.length?0>this.Ja.BPe:!hb.nQb[Lb]){Pa=!1;break}}Pa&&({sQi:Eb,tQi:Yb}=this.IQj(Aa,hb,Eb,Yb,Nb,zd,ed))}this.Ja.Uac&&(ba.Du(this.Ja.XFa?this.Ja.ztb:this.Ja.xtb,Eb),this.Ja.XFa&&ba.Du(this.Ja.ytb,Yb))}ya=R.Annotations.mL(ya);this.Ja.Uac?ya.Du(this.Ja.psa,Ra):(ya.Du(this.Ja.XFa?this.Ja.ztb:this.Ja.xtb,Eb),this.Ja.XFa&&ya.Du(this.Ja.ytb,
Yb));return ya}wvj(ya){let Ra,hb;if(!ya||!({value:Ra}=ya.jn(this.Ja.psa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Eb;({value:Eb}=ya.jn(this.Ja.JCa)).returnValue||(Eb="");hb=new kg(Ra.items.length);const Yb=De(this.Ja.O6e,Nb=>!Nb.J$b||Nb.J$b.isMatch(ya,null));for(let Nb=0;Nb<Ra.items.length;++Nb){const ed=Ra.items[Nb];let zd=null;hb.K6e[Nb]=hb.V3e.length;let Hd=hb.nQb[Nb]=0;for(const ba of Yb)0<ba.hlc&&hb.nQb[Nb]+Hd>=ba.hlc||ba.hwc&&!ba.hwc.isMatch(ed,
null)||({iwc:zd,$0b:Hd}=ba.apply(this,ed,Nb,hb,Eb,zd,Hd))}return{tokens:Ra,G7j:hb}}IQj(ya,Ra,hb,Eb,Yb,Nb,ed){let zd=0;Nb[0].p$b=-1;for(Nb[0].m7d=ya.tsh;;){var Hd=ed[zd],ba=0>Hd||Hd>=Ra.nQb.length?1:Ra.nQb[Hd];let ub=!1;for(;Nb[zd].p$b<ba-1;){++Nb[zd].p$b;var Aa=void 0,Pa=void 0;0>Hd?(Aa=this.Ja.gQe,Pa=1):Hd>=Ra.K6e.length?(Aa=this.Ja.BPe,Pa=1):(Pa=Ra.K6e[Hd]+Nb[zd].p$b,Aa=Ra.V3e[Pa],Pa=Ra.zFh[Pa]);Nb[zd].jsc=Pa*(zd?Nb[zd-1].jsc:ya.score);if(({value:Aa}=Jd(Nb[zd].m7d,Aa.toString())).returnValue){zd===
ya.WOb.length-1?(Hd=Aa,Nb[zd].jsc&&(({value:ba}=Jd(Yb,Hd.toString())).returnValue||(ba=-1),0>ba&&(hb=R.Annotations.mL(hb),Array.add(hb.items,Hd)),this.Ja.XFa&&(Eb=R.Annotations.mL(Eb),0>ba?Array.add(Eb.items,Nb[zd].jsc):Eb.items[ba]+=Nb[zd].jsc),0>ba&&(this.Ja.btg||this.Ja.XFa)&&(Yb[Hd.toString()]=hb.items.length-1))):(++zd,Nb[zd].p$b=-1,Nb[zd].m7d=Aa);ub=!0;break}}if(!ub&&(--zd,0>zd))break}return{sQi:hb,tQi:Eb}}V9f(ya,Ra){let hb;if(({value:hb}=ya.jn(this.Ja.XFa?this.Ja.ztb:this.Ja.xtb)).returnValue)for(let Eb=
0;Eb<hb.items.length;++Eb)Ra[hb.items[Eb].toString()]=Eb;else hb=new tb.a(this.Ja.annotations,R.Annotations.Tpa);if(this.Ja.XFa){if(({value:Ra}=ya.jn(this.Ja.ytb)).returnValue||(Ra=new tb.a(this.Ja.annotations,R.Annotations.wba)),Ra.items.length!==hb.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Ja.annotations.o2(R.Annotations.kN,ya));}else Ra=null;return{returnValue:hb,q_f:Ra}}get $Gl(){return this.Ja.Nwd}vvj(ya,
Ra){var hb;if(({value:hb}=Ra.jn(this.Ja.bRa)).returnValue)ya=hb;else{if(!({value:hb}=Ra.jn(this.Ja.fT)).returnValue)throw Error.argument("Token is missing Span.StartIndex");if(!({value:Ra}=Ra.jn(this.Ja.qW)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>hb||0>Ra||hb+Ra>ya.length)throw Error.argument("Token indices are out of range");ya=ya.substr(hb,Ra)}return ya}}Object(h.a)(Rg,"NGramNLModule",null,[1079,1080]);class Eg{constructor(ya){this.WOb=null;this.score=this.APe=this.fQe=
0;this.tsh=null;if(ya){var Ra=0;try{if(ya.ga(Ra)!==Eg.d8a)throw Error.argument("initData","Input does not represent a feature template");++Ra;const hb=ya.ga(Ra);++Ra;this.WOb=Array(hb);for(let Eb=0;Eb<hb;++Eb)this.WOb[Eb]=ya.ga(Ra),++Ra;this.fQe=ya.ga(Ra);++Ra;this.APe=ya.ga(Ra);++Ra;this.score=ya.ga(Ra);++Ra;this.tsh=({oig:Ra}=Eg.olh(ya,Ra)).returnValue}catch(hb){throw Error.argument("initData");}}}static olh(ya,Ra){const hb=ya.ga(Ra);++Ra;const Eb={};for(let Yb=0;Yb<hb;++Yb){const Nb=ya.ga(Ra);
++Ra;ya.ga(Ra)?Eb[Nb.toString()]=({oig:Ra}=Eg.olh(ya,Ra)).returnValue:(++Ra,Eb[Nb.toString()]=ya.ga(Ra),++Ra)}return{returnValue:Eb,oig:Ra}}}Eg.d8a=240803228;Object(h.a)(Eg,"FeatureTemplate",null,[1094]);var xf=d(554);class hd{constructor(ya,Ra){this.XFa=this.btg=this.Uac=!1;this.bRa=this.qW=this.fT=this.psa=this.JCa=this.ytb=this.ztb=this.xtb=0;this.Nwd=null;this.BPe=this.gQe=0;this.rSc=this.O6e=null;if(ya){this.annotations=Ra.annotations;var hb=0;try{this.Uac=1===ya.ga(hb);++hb;this.btg=1===ya.ga(hb);
++hb;this.XFa=1===ya.ga(hb);++hb;this.xtb=ya.ga(hb);++hb;this.ztb=ya.ga(hb);++hb;this.ytb=ya.ga(hb);++hb;this.JCa=ya.ga(hb);++hb;this.psa=ya.ga(hb);++hb;this.fT=ya.ga(hb);++hb;this.qW=ya.ga(hb);++hb;this.bRa=ya.ga(hb);++hb;this.Nwd=this.SMk(Ra.ITa(ya.ga(hb)));++hb;this.gQe=ya.ga(hb);++hb;this.BPe=ya.ga(hb);++hb;const Eb=ya.ga(hb);++hb;this.O6e=Array(Eb);for(let Nb=0;Nb<Eb;++Nb){const ed=ya.ga(hb);++hb;const zd=this.Nwd.trie,Hd=new Ab.a;Hd.xTa(ya,hb,ed);this.O6e[Nb]=this.XMk(Hd,Ra,zd);hb+=ed}const Yb=
ya.ga(hb);++hb;this.rSc=Array(Yb);for(Ra=0;Ra<Yb;++Ra){const Nb=ya.ga(hb);++hb;const ed=new Ab.a;ed.xTa(ya,hb,Nb);this.rSc[Ra]=this.wMk(ed);hb+=Nb}}catch(Eb){throw Error.argument("initData");}}}SMk(ya){return new si.a(new sh.a(ya))}XMk(ya,Ra,hb){return xf.a.create(ya,Ra,hb)}wMk(ya){return new Eg(ya)}}Object(h.a)(hd,"NGramNLModuleInit",null,[]);class yf{constructor(ya){this.Ja=ya}execute(ya){if(!ya)throw Error.argumentNull("input");ya=ya.clone();this.Ja.script.execute(ya,null);return ya}}Object(h.a)(yf,
"ScriptNLModule",null,[1079]);class cd{constructor(ya,Ra){ya&&(this.script=Ra.F$a(ya.ga(0)))}}Object(h.a)(cd,"ScriptNLModuleInit",null,[]);const cg=ya=>{ya=Wf(ya,Ra=>Ra*Ra);return Math.sqrt(Af(ya,(Ra,hb)=>Ra+hb,0))},xh=ya=>Af(ya,(Ra,hb)=>Ra>hb?Ra:hb,ya[0]);class Yf{constructor(ya){this.Ja=ya}execute(ya){if(!ya)throw Error.argumentNull("input");var Ra=[],hb=[];this.VCi(ya,Ra,hb);this.iji(Ra,hb);const Eb={};for(let Nb=0;Nb<Ra.length;++Nb){var Yb=Ra[Nb];const ed=this.Ja.Wkg.ga(Yb);Yb=this.Ja.Xkg.ga(Yb);
for(let zd=0;zd<Yb;++zd){const Hd=this.Ja.jAi.ga(this.Ja.VJf.ga(ed+zd)),ba=this.Ja.WJf.ga(ed+zd);let Aa;({value:Aa}=Jd(Eb,Hd)).returnValue||(Aa=0);Eb[Hd]=Aa+hb[Nb]*ba}}hb=Og(Eb);hb.sort((Nb,ed)=>{var zd=Nb.value,Hd=ed.value;(zd=-(zd>Hd?1:zd<Hd?-1:0))||(zd=Nb.key.localeCompare(ed.key));return zd});Ra=new tb.a(this.Ja.annotations,R.Annotations.kN);for(const Nb of vf(hb,this.Ja.Nuk))hb=new C.a(this.Ja.annotations),hb.Du(this.Ja.aoi,Nb.key),hb.Du(this.Ja.coi,Nb.value),Array.add(Ra.items,hb);ya.Du(this.Ja.boi,
Ra);return ya}VCi(ya,Ra,hb){if(({value:ya}=ya.jn(this.Ja.$ni)).returnValue){let Eb;if(({value:Eb}=ya.jn(this.Ja.ztb)).returnValue){let Yb;if(!({value:Yb}=ya.jn(this.Ja.ytb)).returnValue||Eb.items.length!==Yb.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.YMc(Eb,Yb,Ra,hb)}if(({value:Eb}=ya.jn(this.Ja.eoi)).returnValue){let Yb;if(!({value:Yb}=ya.jn(this.Ja.foi)).returnValue||Eb.items.length!==Yb.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");
this.YMc(Eb,Yb,Ra,hb)}({value:Eb}=ya.jn(this.Ja.xtb)).returnValue&&this.YMc(Eb,null,Ra,hb);({value:Eb}=ya.jn(this.Ja.doi)).returnValue&&this.YMc(Eb,null,Ra,hb)}}YMc(ya,Ra,hb,Eb){for(let Nb=0;Nb<ya.items.length;++Nb){var Yb=void 0;ya.QU===R.Annotations.kZ?({value:Yb}=Jd(this.Ja.AVf,ya.items[Nb])).returnValue||(Yb=-1):(Yb=ya.items[Nb],Yb=Yb>=this.Ja.JIe&&Yb<=this.Ja.fvk?this.Ja.UJe?this.Ja.UJe.ga(Yb-this.Ja.JIe)-1:Yb-this.Ja.JIe:-1);if(0<=Yb){let ed;ed=Ra?Ra.items[Nb]:1;0<ed&&(Array.add(hb,Yb),Array.add(Eb,
ed))}}}iji(ya,Ra){if(ya.length){switch(this.Ja.SVk){case 0:break;case 1:for(var hb=0;hb<Ra.length;++hb)Ra[hb]=1+Math.log(Ra[hb]);break;case 2:hb=xh(Ra);for(let Eb=0;Eb<Ra.length;++Eb)Ra[Eb]=.5+Ra[Eb]/hb*.5;break;case 3:for(hb=0;hb<Ra.length;++hb)Ra[hb]=1;break;default:throw Error.notImplemented();}if(this.Ja.M_c)for(hb=0;hb<Ra.length;++hb)Ra[hb]*=this.Ja.M_c.ga(ya[hb]);ya=cg(Ra);for(hb=0;hb<Ra.length;++hb)Ra[hb]/=ya}}}Object(h.a)(Yf,"TfIdfRankerNLModule",null,[1079]);class Hf{constructor(ya,Ra=0){if(!ya)throw Error.argumentNull("byteArray");
this.LJ=Ra;if(604662927!==ya.Cu(this.LJ+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.il=ya.Cu(this.LJ+4,4);this.Fyg=ya.Cu(this.LJ+8,4);this.bfk=ya}ga(ya){if(0>ya||ya>=this.count)throw Error.argumentOutOfRange("index");return this.bfk.Z_k(8*this.LJ+96+ya*this.Fyg,this.Fyg)}get count(){return this.il}}Object(h.a)(Hf,"CompactIntArray",null,[1078]);const ji=(ya,Ra)=>{Ra=Array(Ra);for(let Nb=0;Nb<Ra.length;Nb++){var hb=Nb,Eb=ya.HY(),Yb=1===(Eb>>31&1)?-1:1;
const ed=Eb&8388607;Eb=Eb>>23&255;256===Eb+1?Yb=ed?Number.NaN:1===Yb?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:Eb?(Eb-=127,Yb=Yb*Qi(ed,1)*Math.pow(2,Eb)):Yb=Yb*Qi(ed,0)*Math.pow(2,-126);Ra[hb]=Yb}return Ra},Qi=(ya,Ra)=>{let hb=0;for(let Eb=0;23>Eb;Eb++)hb+=(ya>>22-Eb&1)/Math.pow(2,Eb+1);return Ra+hb};class ah{constructor(ya,Ra){this.UJe=null;this.B6g=0;this.Xkg=this.Wkg=this.M_c=null;this.A6g=0;this.WJf=this.VJf=null;this.annotations=Ra.annotations;let hb=0;this.doi=ya.ga(hb);++hb;this.xtb=
ya.ga(hb);++hb;this.eoi=ya.ga(hb);++hb;this.foi=ya.ga(hb);++hb;this.ztb=ya.ga(hb);++hb;this.ytb=ya.ga(hb);++hb;this.$ni=ya.ga(hb);++hb;this.boi=ya.ga(hb);++hb;this.aoi=ya.ga(hb);++hb;this.coi=ya.ga(hb);++hb;var Eb=ya.ga(hb);++hb;var Yb=Array(Eb);for(var Nb=0;Nb<Eb;++Nb)Yb[Nb]=Ra.$C(ya.ga(hb)),++hb;this.jAi=Ab.a.k1d(Yb);this.Nuk=ya.ga(hb);++hb;this.SVk=ya.ga(hb);++hb;Eb=ya.ga(hb);++hb;this.AVf={};for(Yb=0;Yb<Eb;++Yb){Nb=Ra.$C(ya.ga(hb));++hb;const ed=ya.ga(hb);++hb;this.AVf[Nb]=ed}this.JIe=ya.ga(hb);
++hb;this.fvk=ya.ga(hb);++hb;Eb=ya.ga(hb);++hb;0<Eb&&(Eb=Ra.ITa(ya.ga(hb)),++hb,this.UJe=this.Pkd(new $f(Eb)));++hb;ya=Ra.ITa(ya.ga(hb));this.HMk(ya)}Pkd(ya){return new Hf(ya.p0b,ya.offset)}HMk(ya){try{const Ra=new $f(ya);this.B6g=Ra.HY();1===Ra.HY()?this.M_c=Ab.a.k1d(ji(Ra,this.B6g)):this.M_c=null;const hb=Ra.HY();this.Wkg=this.Pkd(Ra);Ra.offset+=hb;const Eb=Ra.HY();this.Xkg=this.Pkd(Ra);Ra.offset+=Eb;this.A6g=Ra.HY();const Yb=Ra.HY();this.VJf=this.Pkd(Ra);Ra.offset+=Yb;this.WJf=Ab.a.k1d(ji(Ra,this.A6g))}catch(Ra){throw Error.argument("byteReader");
}}}Object(h.a)(ah,"TfIdfRankerNLModuleInit",null,[]);class Kd{constructor(ya,Ra,hb,Eb){this.iOe=ya;this.M0f=hb;this.tokens=Eb;this.E8=Ra;this.jNb=-1;this.Grd=0}}Object(h.a)(Kd,"TokenizerData",null,[]);class Qd{constructor(ya){this.Ja=ya}execute(ya){if(!ya)throw Error.argumentNull("input");if(!({value:Eb}=ya.jn(this.Ja.JCa)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Ra;({value:Ra}=ya.jn(this.Ja.fT)).returnValue||(Ra=0);let hb;({value:hb}=
ya.jn(this.Ja.qW)).returnValue||(hb=Eb.length-Ra);if(0>Ra||Ra>Eb.length)throw Error.argument("input","Start index out of range");if(0>hb||hb>Eb.length)throw Error.argument("input","Length out of range");if(Ra+hb>Eb.length)throw Error.argument("input","Bad start-length range");var Eb=new Kd(Eb,Ra,Ra+hb,new tb.a(this.Ja.annotations,R.Annotations.kN));this.aHl(Eb);ya=ya.isReadOnly?ya.clone():ya;ya.Du(this.Ja.psa,Eb.tokens);return ya}aHl(ya){for(;ya.E8<ya.M0f;){if(this.Ja.Lee){var Ra=this.Ja.Lee.Xwg(ya.iOe,
ya.E8,ya.M0f-ya.E8,null);!Ra.succeeded&&Ra.J5g&&(Ra=Ra.J5g);if(Ra.succeeded){this.F$g(ya,Ra.length,this.Ja.meg);ya.E8+=Ra.length;continue}}Ra=ya.iOe.substr(ya.E8);let hb=-1,Eb=-1,Yb=-1;for(let Nb=0;Nb<this.Ja.xqd.length;++Nb){const ed=this.Ja.xqd[Nb].exec(Ra);ed&&0<ed[1].length&&(0>hb||ed[0].length>Eb)&&(hb=Nb,Eb=ed[0].length,Yb=ed[1].length)}0<=hb?(this.F$g(ya,Yb,this.Ja.EXe[hb]),ya.E8+=Yb):ya.E8+=1}}F$g(ya,Ra,hb){if(this.Ja.Krg)hb!==Qd.lvi&&(0>ya.jNb&&(ya.jNb=ya.E8),ya.Grd=ya.E8+Ra-ya.jNb,hb===
Qd.kvi&&(0<=ya.jNb&&0<ya.Grd&&(Ra=new C.a(this.Ja.annotations),Ra.Du(this.Ja.fT,ya.jNb),Ra.Du(this.Ja.qW,ya.Grd),Ra.Du(this.Ja.DVd,Qd.mvi),Ra.Du(this.Ja.JCa,ya.iOe),Array.add(ya.tokens.items,Ra)),ya.jNb=-1,ya.Grd=0));else{let Eb=new C.a(this.Ja.annotations);Eb.Du(this.Ja.fT,ya.E8);Eb.Du(this.Ja.qW,Ra);Eb.Du(this.Ja.DVd,hb);Array.add(ya.tokens.items,Eb)}}}Qd.lvi="GAP";Qd.kvi="EOS_CHUNK";Qd.mvi="SENTENCE";Object(h.a)(Qd,"TokenizerNLModule",null,[1079]);class Gg{constructor(ya,Ra){this.qW=this.fT=this.DVd=
this.psa=this.JCa=0;this.Krg=!1;this.EXe=this.xqd=this.meg=this.Lee=null;if(ya){this.annotations=Ra.annotations;var hb=0;try{this.JCa=ya.ga(hb);++hb;this.psa=ya.ga(hb);++hb;this.DVd=ya.ga(hb);++hb;this.fT=ya.ga(hb);++hb;this.qW=ya.ga(hb);++hb;this.Krg=1===ya.ga(hb);++hb;var Eb=ya.ga(hb);++hb;0<Eb&&(this.Lee=Ra.rbe(Eb).p4i);this.meg=ya.ga(hb)?Ra.$C(ya.ga(hb)):"";++hb;const Yb=ya.ga(hb);++hb;this.xqd=Array(Yb);this.EXe=Array(Yb);for(Eb=0;Eb<Yb;++Eb)this.xqd[Eb]=new RegExp(Ra.$C(ya.ga(hb))),++hb,this.EXe[Eb]=
Ra.$C(ya.ga(hb)),++hb}catch(Yb){throw Error.argument("initData");}}}}Object(h.a)(Gg,"TokenizerNLModuleInit",null,[]);class Sg{constructor(ya){this.Ja=ya}execute(ya){if(!ya)throw Error.argumentNull("input");let Ra;if(!({value:Ra}=ya.jn(this.Ja.GDf)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const hb of this.Ja.w3e)Ra=hb.apply(Ra);ya=R.Annotations.mL(ya);ya.Du(this.Ja.HDf,Ra);return ya}static aVd(ya,Ra){const hb=new Sys.StringBuilder;for(let Eb=
0;Eb<ya.length;++Eb)hb.append(Ra(ya.substr(Eb,1)));return hb.toString()}}Object(h.a)(Sg,"TransliteratorNLModule",null,[1079]);class Wh{constructor(ya){ya&&(this.style=ya.ga(0))}apply(ya){return Sg.aVd(ya,Ra=>Wh.cyi(Ra,this.style))}static cyi(ya,Ra){switch(Ra){case 0:return ya.toLowerCase();case 1:return"I"===ya?"\u0131":ya.toLowerCase();case 2:return ya.toUpperCase();case 3:return"i"===ya?"\u0130":ya.toUpperCase();default:throw Error.invalidOperation();}}}Wh.f8a=0;Object(h.a)(Wh,"ChangeCaseTransliterationStage",
null,[1092]);class Bg{apply(ya){return Sg.aVd(ya,Bg.QHl)}static QHl(ya){const Ra=ya.charCodeAt(0);return 65281<=Ra&&65374>=Ra?String.fromCharCode(Ra-65248):ya}}Bg.f8a=4;Object(h.a)(Bg,"LatinFullWidthToHalfWidthTransliterationStage",null,[1092]);class oh{constructor(ya,Ra){ya&&(this.regex=Ra.V$f(ya.ga(0)),this.v$k=Ra.$C(ya.ga(1)))}apply(ya){return ya.replace(this.regex,this.v$k)}}oh.f8a=1;Object(h.a)(oh,"RegexReplaceTransliterationStage",null,[1092]);class Yj{constructor(ya,Ra){if(ya){var hb=ya.ga(0),
Eb=Ra.$C(ya.ga(1)),Yb=new Hf(Ra.ITa(ya.ga(2)));ya=0>ya.ga(3)?null:new Hf(Ra.ITa(ya.ga(3)));this.p4e={};for(Ra=0;Ra<hb;++Ra)this.p4e[Eb.charAt(Ra).toString()]=Eb.substr(Yb.ga(Ra),ya?ya.ga(Ra):1)}}apply(ya){return Sg.aVd(ya,Ra=>Ra in this.p4e?this.p4e[Ra]:Ra)}}Yj.f8a=2;Object(h.a)(Yj,"SingleCharSubstitutionsTransliterationStage",null,[1092]);class Gh{constructor(ya,Ra){this.HDf=this.GDf=0;this.w3e=null;if(ya){this.annotations=Ra.annotations;var hb=0;try{this.GDf=ya.ga(hb);++hb;this.HDf=ya.ga(hb);++hb;
const Eb=ya.ga(hb);++hb;this.w3e=Array(Eb);for(let Yb=0;Yb<Eb;++Yb){const Nb=ya.ga(hb);++hb;const ed=ya.ga(hb);++hb;const zd=new Ab.a;zd.xTa(ya,hb,ed);hb+=ed;this.w3e[Yb]=this.RMk(Nb,zd,Ra)}}catch(Eb){throw Error.argument("initData");}}}RMk(ya,Ra,hb){switch(ya){case Wh.f8a:return new Wh(Ra);case oh.f8a:return new oh(Ra,hb);case Yj.f8a:return new Yj(Ra,hb);case Bg.f8a:return new Bg;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(h.a)(Gh,"TransliteratorNLModuleInit",
null,[]);class Xh{Ulj(ya,Ra){const hb=ya.ga(0),Eb=new Ab.a;Eb.xTa(ya,1,ya.count-1);switch(hb){case 0:return new yf(new cd(Eb,Ra));case 2:return new Qd(new Gg(Eb,Ra));case 3:return new Rg(new hd(Eb,Ra));case 5:return new Ag(new ne(Eb,Ra));case 9:return new Sg(new Gh(Eb,Ra));case 10:return new Yf(new ah(Eb,Ra));default:throw Error.notImplemented();}}}Object(h.a)(Xh,"NLModuleFactory",null,[1060]);class Yg{constructor(ya){this.fvi=";";if(!ya)throw Error.argumentNull("resource");this.p5=new Lc(ya,new rc,
new Xh);this.cDe=this.p5.Elj();this.qyg=this.p5.annotations.Z6b("Text.Text");this.oyg=this.p5.annotations.Z6b("Classification.Predictions");this.Mte=this.p5.annotations.Z6b("Classification.PredictionString");this.pyg=this.p5.annotations.Z6b("Classification.Probability");this.Lek=this.p5.annotations.Z6b("NLMod.Tokens");if(0>this.qyg||0>this.oyg||0>this.Mte||0>this.pyg)throw Error.argument("resourceObj","Resource does not represent a ranker");}cbj(){const ya=[];this.$5d(void 0,this.m4f(ya),null);return ya}ebj(ya,
Ra){const hb=[],Eb=[];this.$5d(ya,this.m4f(hb),(Yb,Nb)=>{const ed=this.p5.annotations.Z3f(Yb),zd=[],Hd=[];Ra&&Ra.length&&-1===Array.indexOf(Ra,ed)||(Yb=this.p5.annotations.getAttributeType(Yb),this.lgh(Yb,Nb,zd,Hd),Nb=new Kh(ed,zd,Hd),Array.add(Eb,Nb))});return new lf(hb,Eb)}dbj(ya){const Ra=[];this.$5d(ya,hb=>{let Eb;if(({value:Eb}=hb.jn(this.Mte)).returnValue){let Yb;({value:Yb}=hb.jn(this.pyg)).returnValue&&Array.add(Ra,new Xc(Eb,Yb))}},null);return Ra}$5d(ya,Ra,hb){var Eb=new C.a(this.p5.annotations);
Eb.Du(this.qyg,ya);ya=this.cDe.execute(Eb);if(({value:Eb}=ya.jn(this.oyg)).returnValue)for(const Yb of Eb.items)Ra(Yb);if(hb&&({value:Ra}=ya.jn(this.Lek)).returnValue)for(const Yb of Ra.items)Yb.oTc(hb)}lgh(ya,Ra,hb,Eb){if(R.Annotations.pC(ya))for(var Yb of Ra.items)this.lgh(Ra.QU,Yb,hb,Eb);else if(R.Annotations.HLh(ya)){Yb=this.p5.annotations.G9f(ya);for(let Nb=0;Nb<Yb;Nb++)Array.add(hb,this.p5.annotations.Mbg(ya,Nb)),Array.add(Eb,this.p5.annotations.o2(this.p5.annotations.zab(ya,Nb),Ra.VTa(Nb)))}else Array.add(hb,
"VALUE"),Array.add(Eb,this.p5.annotations.o2(ya,Ra))}m4f(ya){return Ra=>{let hb;({value:hb}=Ra.jn(this.Mte)).returnValue&&Array.add(ya,this.joj(hb))}}joj(ya){const Ra=ya.indexOf(this.fvi);return 0>Ra?ya:ya.substring(0,Ra)}}Object(h.a)(Yg,"Ranker",null,[]);var dg=d(343),Od=d(389),We=d(27);class Zj{constructor(ya,Ra){this.Qlf="";this.CMd=null;this.DMd=!1;this.Lba=null;this.zUh=["TellMe.TellMeParamCollection"];this.ub=ya;this.vBa=Ra;this.ub.J7a&&(this.Lba=null)}get bnd(){if(!this.CMd&&!this.DMd){let ya=
null;try{ya=window.TellMeModel}catch(Ra){if(x.TellMeActor.instance.Jd)x.TellMeActor.instance.Jd.onError("QueryRanker","TellMeModel not found. Exception: "+Ra)}if(ya){try{this.CMd=new Yg(ya)}catch(Ra){if(x.TellMeActor.instance.Jd)x.TellMeActor.instance.Jd.onError("QueryRanker","Exception thrown while loading classifier. Exception: "+Ra)}this.DMd=!0}else if(x.TellMeActor.instance.Jd)x.TellMeActor.instance.Jd.onError("QueryRanker","Classifier model not found")}return this.CMd}sE(){return"Command"}GL(){return 0===
this.ub.Fq?0:1===this.ub.Fq?1:2}FB(ya,Ra,hb=!1,Eb=e.a.tellMe,Yb=null){const Nb=new v.a(ya);if((!Yb||Array.contains(Yb,0))&&!B.a.$F(ya)){if(!this.bnd&&this.DMd){if(x.TellMeActor.instance.Jd)x.TellMeActor.instance.Jd.onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.ub.J7a&&this.Lba&&this.Lba.initialize();if(dg.CommandResultsUtility.Kme(ya.Cf)&&(Yb=dg.CommandResultsUtility.p5f(ya.Cf),0<Yb.results.length)){Yb.displayName=
"Classifier Debug";Nb.Aq(Yb);Ra.resultsUpdated(Nb);return}Yb=ya?this.Qlf=ya.Cf:this.Qlf;if(We.AFrameworkApplication.fa.ka("TellMeParameterizedQueriesEnabled")){Yb=this.loj(Yb);var ed=this.CUc(Yb.dce());Yb=Yb.J3f()}else Yb=this.koj(Yb),ed=this.adj(Yb),Yb=[];dg.CommandResultsUtility.V4c(ed,!1,"Classifier","TFIDF");ed=dg.CommandResultsUtility.f8b(ya,ed,this.ub,this.Lba,this.vBa,Yb,0,1);0<ed.results.length&&Eb!==e.a.contextMenu&&(ed.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);hb||ed.results.length||
this.ub.LFa||this.ub.yza||(ya=new n.a("lookupNoResults",14,ya.Cf,null,1),ed.us(ya));0<ed.results.length&&Nb.Aq(ed);Nb.attributes=Yb}Ra.resultsUpdated(Nb)}dce(){let ya=[];try{ya=this.bnd.cbj()}catch(Ra){if(x.TellMeActor.instance.Jd)x.TellMeActor.instance.Jd.onError("GetPredictions","Exception: "+Ra)}return ya}koj(ya){let Ra=[];try{Ra=this.bnd.dbj(ya)}catch(hb){if(x.TellMeActor.instance.Jd)x.TellMeActor.instance.Jd.onError("GetPredictionsWithScore","Exception: "+hb)}return Ra}loj(ya){try{return this.bnd.ebj(ya,
this.zUh)}catch(Ra){if(x.TellMeActor.instance.Jd)x.TellMeActor.instance.Jd.onError("GetPredictionsWithTokenAttributes","Exception: "+Ra)}return new lf([],[])}CUc(ya){const Ra=[];if(ya)for(const hb of ya)Ra.push(new Od.a(hb,-99999));return Ra}adj(ya){const Ra=[];if(ya)for(const hb of ya)Ra.push(new Od.a(hb.prediction,hb.score));return Ra}}Object(h.a)(Zj,"CommandResultsProvider",null,[750]);var ij=d(1011);class Wd{constructor(ya){this.ub=ya}sE(){return"Feedback"}GL(){return 0===this.ub.Fq?0:1===this.ub.Fq?
1:2}FB(ya,Ra,hb,Eb,Yb=null){ya=new v.a(ya);if(!Yb||Array.contains(Yb,21))Yb=[],Yb.push(appChrome.actions.setControlLabel("TellMeFeedback",CommonUIStrings.l_TellMeFeedbackText)),appChrome.api.dispatch(Yb),Yb=new z.a(22),Yb.displayName="",Yb.us(new n.a("TellMeFeedback",23,null,null,1)),ya.Aq(Yb);Ra.resultsUpdated(ya)}}Object(h.a)(Wd,"FeedbackResultsProvider",null,[750]);class ki{constructor(ya,Ra,hb,Eb){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=ya;this.CommandId=Ra;
this.CommandValueId=hb;this.InputText=Eb}}Object(h.a)(ki,"FindInDocumentProp",null,[]);var xi=d(47);class Pg{constructor(ya){this.KJd=2;this.z5a=[];this.pPa=[];this.ub=ya;Pg.vka=ya.a0f;Pg.f0f="FindInDocumentSuggestion";Pg.vfh="FindInDocumentSuggestion3";this.t1h=Object.assign(new D.a,{landingTab:"Indoc",data:null});this.W6h=this.ub.xOb||!!We.AFrameworkApplication.Aa&&We.AFrameworkApplication.Aa.ob.xOb}sE(){return"FindInDocument"}GL(){return 0===this.ub.Fq?0:1===this.ub.Fq?1:3===this.ub.Fq?this.ub.nDh?
2:3:2}FB(ya,Ra,hb=!1,Eb,Yb=null){const Nb=new v.a(ya);if(Yb&&!Array.contains(Yb,2))Ra.resultsUpdated(Nb);else if(Array.clear(this.z5a),B.a.$F(ya)){if(hb&&this.eBh()){hb=new z.a(2);hb.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Yb=1;Eb="";if(0<this.pPa.length&&!this.ub.yOb)for(var ed of this.pPa)if(""!==ed.Label.toLowerCase()){if(Yb>=this.KJd)break;this.tOh(hb,ed.Label,ed.CommandValueId,Pg.f0f+Yb,ed.InputText);Yb++}ed="";this.ub.cI?(Nb.Aq(hb),hb=new z.a(3),ed=this.ub.ZQa?B.a.GTa(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):
CommonUIStrings.l_TellMeOpenFindPaneTextV2):ed=CommonUIStrings.l_TellMeOpenFindPaneText;Eb=this.o5f("");this.tOh(hb,ed,Eb,Pg.vfh,"");Nb.Aq(hb)}Ra.resultsUpdated(Nb)}else ed="",hb&&(hb=this.o5f(ya.Cf),Eb=[],this.ub.pWa?(this.ub.B1e&&Eb.push(appChrome.actions.setControlIconSet(Pg.vka,{"default":"FindInDocument_20"})),ed=this.ub.cqe?B.a.fae(ya.Cf,CommonUIStrings.l_FindInDocumentScopedButtonText):ya.Cf+CommonUIStrings.l_FindInDocumentScopedButtonText):this.ub.cI?(ed=this.ub.ZQa?B.a.GTa(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,
ya.Cf)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,ya.Cf),Eb.push(appChrome.actions.setControlIconSet(Pg.vka,{"default":"FindInDocument_20"}))):ed=this.ub.yOb?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,ya.Cf),this.ub.Yda?(x.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Pg.vka,ed)),x.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Pg.vka,hb))):(Eb.push(appChrome.actions.setControlLabel(Pg.vka,
ed)),Eb.push(appChrome.actions.setButtonCommandValueId(Pg.vka,hb)),appChrome.api.dispatch(Eb)),this.jxh(ed,Pg.vka,hb,ya.Cf)),this.ub.nDh?(ed=new n.a(Pg.vka,8,ya.Cf),hb=new z.a(2),hb.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,hb.us(ed),Nb.Aq(hb),Ra.resultsUpdated(Nb)):this.ub.hhj().then(zd=>{const Hd=new n.a(Pg.vka,8,ya.Cf,null,1);Hd.count=zd;zd=new z.a(2);zd.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;zd.us(Hd);Nb.Aq(zd);Ra.resultsUpdated(Nb)},zd=>{x.TellMeActor.instance.Jd.onError("FindInDocumentResultsProvider:issueQuery",
"Find manager promise rejected: "+zd);zd=new n.a(Pg.vka,8,ya.Cf,null,1);const Hd=new z.a(2);Hd.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Hd.us(zd);Nb.Aq(Hd);Ra.resultsUpdated(Nb)})}eBh(){return!!this.ub&&this.ub.Ktd}tOh(ya,Ra,hb,Eb,Yb=null){const Nb=[];Ra&&Nb.push(appChrome.actions.setControlLabel(Eb,Ra));this.ub.cI&&Nb.push(appChrome.actions.setControlIconSet(Eb,{"default":"FindInDocument_20"}));Nb.push(appChrome.actions.setButtonCommandValueId(Eb,hb));appChrome.api.dispatch(Nb);
this.jxh(Ra,Eb,hb,"");ya.us(new n.a(Eb,8,Yb,null,1,-99999))}o5f(ya){return this.W6h?B.a.zDa(ya,15,this.t1h):xi.a.xe(ya)}jxh(ya,Ra,hb,Eb){this.eBh()&&this.z5a.length<this.KJd&&(ya=new ki(ya,Ra,hb,Eb),Array.add(this.z5a,ya))}eml(ya){for(let Ra=0;Ra<this.z5a.length;Ra++)if(this.z5a[Ra].CommandId===ya){const hb=this.z5a[Ra].Label;let Eb=!1;if(0<this.pPa.length){let Yb=0;for(const Nb of this.pPa){if(Nb.Label===hb){Array.removeAt(this.pPa,Yb);Eb=!0;break}Yb++}}!Eb&&this.pPa.length>=this.KJd-1&&Array.removeAt(this.pPa,
1);Array.insert(this.pPa,0,this.z5a[Ra])}}}Pg.vka=null;Pg.f0f=null;Pg.vfh=null;Object(h.a)(Pg,"FindInDocumentResultsProvider",null,[750]);var Ej=d(1009);class Hh{constructor(ya){this.ub=ya}sE(){return"Insights"}GL(){return 0===this.ub.Fq?0:1===this.ub.Fq?1:2}FB(ya,Ra,hb=!1,Eb,Yb=null){Eb=new v.a(ya);if(!Yb||Array.contains(Yb,13))if(this.Mtl()||!B.a.$F(ya)){Yb=new z.a(13);var Nb=""===ya.Cf.trim(),ed=Nb?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",zd=new n.a(ed,10,ya.Cf,null,1);hb&&(hb=null,
B.a.J9()?Nb?Nb=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:(Nb=this.ub.yOb?CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,ya.Cf),hb=B.a.zDa(ya.Cf,1)):(Nb=String.format(CommonUIStrings.l_InsightsButtonText,ya.Cf),hb=B.a.q1d(ya.Cf)),this.ub.Yda?(x.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ed,Nb)),hb&&x.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",hb))):
(ya=[],ya.push(appChrome.actions.setControlLabel(ed,Nb)),hb&&ya.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",hb)),appChrome.api.dispatch(ya)),zd.label=Nb);Yb.us(zd);Eb.Aq(Yb)}Ra.resultsUpdated(Eb)}Mtl(){return B.a.J9()&&this.ub.MEl&&!this.ub.M3}}Object(h.a)(Hh,"InsightsResultsProvider",null,[750]);var gh=d(1007);class Ie{constructor(ya){this.ub=ya}sE(){return"Learning"}GL(){return 0===this.ub.Fq?0:1===this.ub.Fq?1:2}FB(ya,Ra,hb,Eb,Yb=null){hb=new v.a(ya);Yb&&!Array.contains(Yb,
21)||!B.a.$F(ya)||(Yb=[],Eb=this.ub.A8j,Yb.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",Eb)),Eb=Ie.Ghj(Eb),Yb.push(appChrome.actions.setControlLabel("LearningForSearch",Eb)),appChrome.api.dispatch(Yb),ya=new n.a("LearningForSearch",22,ya.Cf,null,1),Yb=new z.a(21),Yb.us(ya),hb.Aq(Yb));Ra.resultsUpdated(hb)}static Ghj(ya){const Ra=[];Array.add(Ra,new gh.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(Ra,new gh.a(400,CommonUIStrings.l_TellMeLearningButtonText));
Array.add(Ra,new gh.a(600,ya));Array.add(Ra,new gh.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));ya={};ya.parts=Ra;return JSON.stringify(ya)}}Object(h.a)(Ie,"LearningProvider",null,[750]);var eg=d(1096);class yi{constructor(ya,Ra){this.kqb=this.nsb=this.KPa=this.MDc=null;this.kw=!1;this.Bqb=ya;this.LWh=Ra;ya&&this.tZf(ya)}pxd(){this.Bqb.pxd()&&this.tZf(this.Bqb)}Wtj(ya){let Ra=[];var hb=[];ya=yi.tyk(ya);var Eb="";Array.clear(hb);for(let Yb=0;Yb<ya.length;Yb++){const Nb=ya.charAt(Yb);-1!==
" ".indexOf(Nb)?(Eb.length&&Array.add(hb,Eb),Eb=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(Nb)?(Eb.length&&Array.add(hb,Eb),Eb=Nb,Array.add(hb,Eb),Eb=""):Eb+=Nb}Eb.length&&Array.add(hb,Eb);for(ya=0;ya<hb.length;ya++)Eb=this.$cj(hb[ya]),Eb=this.hIi(Eb),Ra=yi.Cvk(Ra,Eb);return Ra=this.pdi(Ra)}xoe(){this.kw||this.pxd();return this.kw}oPc(ya){return this.MDc[ya.toString()]}pdi(ya){for(let Ra=0;Ra<ya.length;Ra++){const hb=this.KPa[Ra];if(ya[Ra].commandId!==this.oPc(hb[0]))throw Error.create("Incorrect Tcid orders with Priors data");
let Eb;(Eb=ya[Ra]).score=Eb.score+hb[1]}return ya}hIi(ya){const Ra=[];for(var hb=0;hb<this.KPa.length;hb++)Ra.push(new Od.a(this.oPc(this.KPa[hb][0]),-5));hb=new eg.a;for(var Eb=0;Eb<ya.length;Eb++)hb.add(this.oPc(ya[Eb][0]));for(Eb=0;Eb<Ra.length;Eb++){const Nb=Ra[Eb];for(let ed=0;ed<ya.length;ed++){var Yb=ya[ed];const zd=this.oPc(Yb[0]);Yb=Yb[1];if(zd===Nb.commandId){Nb.score=Yb;hb.remove(zd);break}}if(!hb.count)break}return Ra}$cj(ya){const Ra=1>ya.length;for(let ed=0;2>=ed;ed++){const zd=this.kqb;
for(let Hd in zd){var hb=zd[Hd],Eb=ya,Yb=Hd;const ba=Yb.length+1,Aa=Array((Eb.length+1)*ba);for(var Nb=0;Nb<=Eb.length;Nb++)Aa[Nb*ba]=Nb;for(Nb=0;Nb<=Yb.length;Nb++)Aa[Nb]=Nb;for(Nb=0;Nb<Yb.length;Nb++)for(let Pa=0;Pa<Eb.length;Pa++)Aa[(Pa+1)*ba+(Nb+1)]=Eb.charAt(Pa)===Yb.charAt(Nb)?Aa[Pa*ba+Nb]:Math.min(Math.min(Aa[Pa*ba+(Nb+1)]+1,Aa[(Pa+1)*ba+Nb]+1),Aa[Pa*ba+Nb]+1);Eb=Aa[Eb.length*ba+Yb.length];if((!Eb||!Ra)&&Eb<=ed)return hb}}return this.nsb}tZf(ya){this.MDc=ya.qbe();this.KPa=ya.xoj();this.nsb=
ya.Yvj();this.kqb=ya.Ejj();if(this.kw=!!this.MDc&&!!this.KPa&&!!this.kqb&&!!this.nsb)this.kw=0<this.KPa.length&&yi.qme(this.KPa);this.kw&&(this.kw=0<this.nsb.length&&yi.qme(this.nsb));this.kw&&(this.kqb=yi.Awj(this.kqb));this.kw||(this.kqb=this.nsb=this.KPa=this.MDc=null)}Dvj(ya){ya=this.Wtj(ya);return this.b4i(ya,this.LWh)}b4i(ya,Ra){let hb=[];for(let Eb=0;Eb<ya.length;Eb++)ya[Eb].score>=Ra&&hb.push(ya[Eb]);hb.sort((Eb,Yb)=>Eb.score<Yb.score?1:Eb.score>Yb.score?-1:0);0<hb.length-10&&(hb=hb.slice(0,
10));return hb}static Cvk(ya,Ra){if(!ya.length)return Ra;if(ya.length!==Ra.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");for(let hb=0;hb<ya.length;hb++){if(ya[hb].commandId!==Ra[hb].commandId)throw Error.create("Incorrect CommandId");let Eb;(Eb=ya[hb]).score=Eb.score+Ra[hb].score}return ya}static tyk(ya){return xi.a.rg(ya)}static qme(ya){for(let Ra=0;Ra<ya.length;Ra++)if(2!==ya[Ra].length)return!1;return!0}static Awj(ya){const Ra={};for(let Yb in ya){var hb=
Yb,Eb=ya[Yb];const Nb=Eb;Nb.length&&yi.qme(Nb)&&(Ra[hb]=Eb)}return Ra}}Object(h.a)(yi,"NaiveBayesClassifierModel",null,[]);class Fj{constructor(ya,Ra){this.Lba=null;this.ub=ya;this.JWb=new yi(Ra,ya.r9f);this.ub.J7a&&(this.Lba=null)}sE(){return"NBCommand"}GL(){return 0===this.ub.Fq?0:1===this.ub.Fq?1:2}FB(ya,Ra,hb=!1,Eb=e.a.tellMe,Yb=null){const Nb=new v.a(ya);if((!Yb||Array.contains(Yb,0))&&!B.a.$F(ya)){if(dg.CommandResultsUtility.Kme(ya.Cf)&&(Yb=dg.CommandResultsUtility.p5f(ya.Cf),0<Yb.results.length)){Yb.displayName=
"Classifier Debug";Nb.Aq(Yb);Ra.resultsUpdated(Nb);return}if(!this.JWb.xoe()){if(x.TellMeActor.instance.Jd)x.TellMeActor.instance.Jd.onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.ub.J7a&&this.Lba&&this.Lba.initialize();Yb=this.JWb.Dvj(ya.Cf);dg.CommandResultsUtility.V4c(Yb,!1,"Classifier","NaiveBayesian");Yb=dg.CommandResultsUtility.f8b(ya,Yb,this.ub,this.Lba,null,null,0,1);0<Yb.results.length&&
Eb!==e.a.contextMenu&&(Yb.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);hb||Yb.results.length||this.ub.LFa||this.ub.yza||(ya=new n.a("lookupNoResults",14,ya.Cf,null,1),Yb.us(ya));0<Yb.results.length&&Nb.Aq(Yb)}Ra.resultsUpdated(Nb)}}Object(h.a)(Fj,"NaiveBayesCommandProvider",null,[750]);class Yh{constructor(){this.x5a=null;this.kw=!1;this.pxd()}pxd(){this.kw||(this.x5a=window.NBCRM)&&4===this.x5a.length&&(this.kw=!0);return this.kw}xoj(){return this.kw?this.x5a[1]:null}Yvj(){return this.kw?
this.x5a[2]:null}Ejj(){return this.kw?this.x5a[3][0]:null}qbe(){return this.kw?this.x5a[0][0]:null}}Object(h.a)(Yh,"NaiveBayesModelAdapter",null,[984]);var ei=d(156);class Hi{constructor(ya){this.ub=ya}sE(){return"OfficeScript"}GL(){return 0===this.ub.Fq?0:1===this.ub.Fq?1:2}FB(ya,Ra){const hb=new v.a(ya);if(!B.a.$F(ya)){ya=ei.d(ya.Cf);var Eb=new z.a(28);Eb.displayName=CommonUIStrings.l_TellMeOfficeScriptsTitle;Eb=this.hyf(ya,Hi.OLl,"OfficeScriptsUnhideAllRowsCols","samples-11",CommonUIStrings.l_TellMeUnhideAllRowsColsTitle,
Eb);Eb=this.hyf(ya,Hi.p8i,"OfficeScriptsFreezeSelection","samples-12",CommonUIStrings.l_TellMeFreezeSelectionTitle,Eb);hb.Aq(Eb)}Ra.resultsUpdated(hb)}hyf(ya,Ra,hb,Eb,Yb,Nb){const ed=[];for(const zd of Ra)if(ei.a(ya,zd)){this.ub.Yda?(x.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(hb,Yb)),x.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(hb,Eb))):(ed.push(appChrome.actions.setControlLabel(hb,Yb)),ed.push(appChrome.actions.setButtonCommandValueId(hb,
Eb)),appChrome.api.dispatch(ed));Nb.us(new n.a(hb,28,null,null,1));break}return Nb}}Hi.OLl="unhide row rows col cols column columns".split(" ");Hi.p8i=["freeze","selection","pane","panes"];Object(h.a)(Hi,"OfficeScriptsSamplesProvider",null,[750]);var yh=d(18),La=d(16),sb=d(455),Ob=d(303),pc=d(454),Kc=d(36),Gd=d(106),he=d(126);class Ue{constructor(ya){this.wI=null;this.yS=-1;this.sIe=14;this.tIe=12;this.attributes=this.LQd=this.query=null;this.tBb=!1;this.lrb=[];this.hi=We.AFrameworkApplication.Me;
We.AFrameworkApplication.fa&&(this.sIe=We.AFrameworkApplication.fa.wc("TellMeMaxTermedResults",this.sIe),this.tIe=We.AFrameworkApplication.fa.wc("TellMeMaxZeroTermResults",this.tIe));this.GJ=ya}get Wk(){return this.lrb}get Rxd(){return this.LQd}Aq(ya){let Ra=!1;for(let hb=0;hb<this.Wk.length;hb++)if(30!==this.Wk[hb].groupType&&this.Wk[hb].groupType===ya.groupType){this.ySd(this.Wk[hb],ya);Ra=!0;break}Ra||this.Wk.push(ya)}ySd(ya,Ra){for(let hb=0;hb<Ra.results.length;hb++)ya.us(Ra.results[hb])}$nh(ya){const Ra=
[];for(const hb of this.Wk)hb.groupType!==ya&&Ra.push(hb);this.Wk.length!==Ra.length&&(this.lrb=Ra)}u6k(ya){let Ra=null,hb=null,Eb=null;for(let Yb=0;Yb<ya.length;Yb++){const Nb=ya[Yb];if(Nb&&Nb.Wk&&Nb.Wk.length)for(const ed of Nb.Wk)if(17===ed.groupType||18===ed.groupType)Ra=ed;else if(0===ed.groupType||16===ed.groupType)hb=ed,Eb=Nb}Ra&&hb&&0<hb.results.length&&(17===Ra.groupType&&({kSd:hb,KSd:Ra}=dg.CommandResultsUtility.nci(hb,Ra,this.GJ.hH()?this.GJ.hH().mcj:-.6)),Eb.$nh(hb.groupType))}pzl(){this.GJ&&
(new yh.a,this.wuc(this.GJ.AXg))}qcc(ya,Ra){return this.query.Cf.length>this.GJ.hH().Qoj&&this.g1j(ya,Ra)||this.query.Cf.length>this.GJ.hH().Roj&&this.R3j(ya,Ra)?!0:!1}R3j(ya,Ra){return ya&&ya.length&&Ra&&Ra.length?-1===Ra.toLowerCase().indexOf(ya.toLowerCase())?!1:!0:!1}g1j(ya,Ra){return ya&&ya.length&&Ra&&Ra.length?Ra.toLowerCase().startsWith(ya.toLowerCase()):!1}n4i(ya){const Ra=[];for(const hb of this.GJ.hH().cI?this.Rxd:this.Wk)ya.contains(hb.groupType)||Ra.push(hb);this.GJ.hH().cI?this.LQd=
Ra:this.lrb=Ra}SPl(ya,Ra){const hb=[];for(const Eb of this.Wk){const Yb=Eb;if(13!==Yb.groupType||24!==Yb.groupType){const Nb=ya[Ob.a[Yb.groupType].toLowerCase()];let ed="False";Nb<Ra&&(ed="True");Yb.displayName=Yb.displayName+" ("+ed+": "+Nb+")"}hb.push(Yb)}this.lrb=hb}wuc(ya,Ra=!1,hb=null){if(this.GJ.hH().cI){if(!Ra)for(this.LQd=Array(this.Wk.length),Ra=0;Ra<this.Wk.length;Ra++)this.Rxd[Ra]=this.Wk[Ra];this.GJ.sZg.wuc(this.Wk,this.Rxd,this.query,ya,hb)}else{for(hb=new yh.a;this.Wk.length;){Ra=this.Wk.pop();
const Eb=Ob.a[Ra.groupType].toLowerCase(),Yb=ya[Eb];if(he.b(Yb))throw Error.create("GroupId "+Eb+" missed from group SortingOrder");hb.add(new La.a(Yb,Ra))}hb.Sc((Eb,Yb)=>Eb.key<Yb.key?-1:1);for(ya=0;ya<hb.count;ya++)Ra=hb.ga(ya).value,this.Wk.push(Ra)}}qzl(){var ya=!1;let Ra=!1,hb=!1;for(let Yb=0;Yb<this.Wk.length;Yb++){var Eb=this.Wk[Yb];const Nb=Eb.groupType;if(8===Nb||15===Nb||14===Nb){Eb=Eb.results;for(let ed=0;ed<Eb.length;ed++){if(8===Nb&&this.qcc(this.query.Cf,Eb[ed].label)){ya=!0;break}if(15===
Nb&&this.qcc(this.query.Cf,Eb[ed].label)){Ra=!0;break}if(14===Nb){if(this.qcc(this.query.Cf,Eb[ed].label)||this.qcc(this.query.Cf,Eb[ed].description)){hb=!0;break}const zd=Eb[ed].label.split(" ");for(const Hd of zd)if(this.qcc(this.query.Cf,Hd)){hb=!0;break}}}}}ya=this.GJ.kqj(ya,Ra,hb);this.wuc(ya)}vib(ya,Ra,hb,Eb,Yb,Nb){if(Yb===this.wI){var ed=ya.data.ee;Yb=null;try{Yb=Kc.b(ed)}catch(kd){x.TellMeActor.instance.Jd.onError("OnSuccessCallBack","Exception occured while deserializing ranker inference response:"+
kd);return}if("RankerResults"in Yb&&Yb.RankerResults){this.Hja();var zd=Yb.RankerResults,Hd=new yh.a,ba=new yh.a;ed=0;for(var Aa of zd){zd=Aa.ProviderId;var Pa=Aa.Score;ed+=Pa;Hd.add(new La.a(zd,Pa))}Hd.Sc((Id,ce)=>Id.value>ce.value?-1:1);Pa=Nb?Nb.orj:1E-6;Aa={};zd={};let kd=0;for(var ub=0;ub<Hd.count;ub++){let Id=parseInt(Hd.ga(ub).key),ce=Hd.ga(ub).value/ed;1===Id&&(zd.answer=kd++,zd.entity=kd++,zd.definition=kd++,zd.wolframanswer=kd++,ce<Pa&&(ba.add(9),ba.add(11),ba.add(10),ba.add(12)),Aa.answer=
ce,Aa.entity=ce,Aa.definition=ce,Aa.wolframanswer=ce);2===Id&&(zd.assistance=kd++,ce<Pa&&ba.add(8),Aa.assistance=ce);3===Id&&(zd.classifier=kd++,zd.serviceclassifier=kd++,ce<Pa&&(ba.add(0),ba.add(17)),Aa.classifier=ce,Aa.serviceclassifier=ce);4===Id&&(zd.people=kd++,ce<Pa&&ba.add(14),Aa.people=ce);5===Id&&(zd.document=kd++,ce<Pa&&ba.add(15),Aa.document=ce);6===Id&&(zd.findindocument=kd++,ce<Pa&&ba.add(2),Aa.findindocument=ce);7===Id&&(zd.notes=kd++,ce<Pa&&ba.add(20),Aa.notes=ce);8===Id&&(zd.image=
kd++,ce<Pa&&ba.add(19),Aa.image=ce)}Hd=new yh.a;Hd.add("classifier");Hd.add("serviceclassifier");Hd.add("appsforoffice");Hd.add("addin");Hd.add("findindocument");Hd.add("assistance");Hd.add("document");Hd.add("people");Hd.add("answer");Hd.add("wolframanswer");Hd.add("definition");Hd.add("entity");Hd.add("image");Hd.add("template");Hd.add("officescript");for(ub=0;ub<Hd.count;ub++)Hd.ga(ub)in zd||(zd[Hd.ga(ub)]=kd++);zd.learning=kd++;zd.insights=kd++;zd.actionai=kd++;zd.actionaicommand=kd++;zd.feedback=
kd++;Nb&&Nb.HZj&&this.SPl(Aa,Pa);Nb&&Nb.IZj&&this.n4i(ba);ba={};for(var Lb in Aa)ba[Lb]=Aa[Lb]*ed;this.wuc(zd,!0,ba)}if(Nb.T2c&&"Intents"in Yb&&Yb.Intents){Lb=Yb.Intents;for(var Mb of Lb)if(this.Aqe(Mb)&&"Serplet"===Mb.GroupType&&Mb.ConfidenceScore>Mb.ConfidenceThreshold){Lb=!1;Yb=0;if(Nb.Ipe){ed=new n.a("",32);for(ba=0;ba<this.Wk.length;ba++)if((Hd=this.Wk[ba].results)&&0<Hd.length){Yb=ba;ed=Hd[0];break}2===ed.groupType&&(Lb=!0)}ed=new z.a(13);Lb&&Nb.Ipe&&(ed=new z.a(13,CommonUIStrings.l_TellMeWebTitle));
ba=new n.a("SmartLookupFromTellMeQueryTermAtTop",10,this.query.Cf,null,0);Hd=[];Aa=null;Aa=B.a.J9()?B.a.zDa(this.query.Cf,1):B.a.q1d(this.query.Cf);Hd.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",Aa));Aa=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,this.query.Cf);Hd.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",Aa));appChrome.api.dispatch(Hd);ed.us(ba);ba=[];if(Lb&&Nb.Ipe)for(ba.push(this.Wk[Yb]),ba.push(ed),Lb=
Yb+1;Lb<this.Wk.length;Lb++)(Yb=this.Wk[Lb].results)&&0<Yb.length&&ba.push(this.Wk[Lb]);else for(ba.push(ed),Lb=0;Lb<this.Wk.length;Lb++)(Yb=this.Wk[Lb].results)&&0<Yb.length&&ba.push(this.Wk[Lb]);this.lrb=ba}}if(Nb.ycc&&!Nb.cI){Mb=Lb=-1;for(Yb=0;Yb<this.Wk.length;Yb++)switch(this.Wk[Yb].groupType){case 23:Lb=Yb;break;case 0:case 17:case 2:-1===Mb&&(Mb=Yb)}if(-1!==Lb){Mb=-1===Mb?0:Lb>Mb?Mb+1:Mb;Lb=this.Wk[Lb];Yb=Array(this.Wk.length);ed=0;for(ba=0;ba<Yb.length;ba++)ba===Mb?Yb[ba]=Lb:(23===this.Wk[ed].groupType&&
ed++,Yb[ba]=this.Wk[ed],ed++);this.lrb=Yb}}Eb.resultsUpdated(this);Eb=x.TellMeActor.instance.Jd;Eb.d6(Ra.length,"RankerInference",ya.data.Ke.toString(),Math.round(window.performance.now()-hb),pc.a.WHh,!0,sb.a.xua);this.tBb&&Eb&&(ya=this.query.b0a,Ra=Eb.Szc,Nb.j3c&&ya>Ra&&!Nb.cI&&(Eb.Cse(this.query.Cf),Eb.GZe(ya)))}}Aqe(ya){if("GroupType"in ya&&ya.GroupType&&"ConfidenceScore"in ya&&"ConfidenceThreshold"in ya)return!0;x.TellMeActor.instance.Jd.onError("IsValidIntentGroup","Invalid intents found");return!1}hib(ya,
Ra,hb,Eb,Yb){Eb===this.wI&&(this.Hja(),x.TellMeActor.instance.Jd.d6(Ra.length,"RankerInference",ya.data.Ke.toString(),Math.round(window.performance.now()-hb),pc.a.WHh,!1,sb.a.xua));Yb.resultsUpdated(this)}Hja(){-1!==this.yS&&(window.clearTimeout(this.yS),this.yS=-1)}rzl(ya){let Ra;Ra=this.GJ.hH().cI?x.TellMeActor.instance.Jd.pde(this.Rxd,this.query.Cf):x.TellMeActor.instance.Jd.pde(this.Wk,this.query.Cf);var hb=this.GJ.hH().nrj;""!==hb&&(hb="_"+hb);let Eb="";this.GJ.hH().woe&&(Eb="RankerInference"+
hb+",");this.GJ.hH().T2c&&(Eb+="SerpletClassifier");","===Eb.charAt(Eb.length-1)&&(Eb=Eb.substring(0,Eb.length-1));hb=x.TellMeActor.instance.Jd.mcg(Eb);const Yb=this.wI=Gd.a.create().toString();hb["Client-Request-Id"]=Yb;const Nb=window.performance.now(),ed=this.GJ.hH()?this.GJ.hH().prj:600;this.Hja();this.yS=window.setTimeout(()=>{if(Yb===this.wI){this.wI="";this.yS=-1;ya.resultsUpdated(this);const zd={};zd[r.a.provider]="Ranker";zd[r.a.tjb]=this.query.b0a;x.TellMeActor.instance.Jd.OH(m.a.timedOut,
ed,zd)}},ed);this.hi.zj(x.TellMeActor.instance.Jd.ncg(),2,Ra,hb,!1,0,zd=>{this.vib(zd,this.query.Cf,Nb,ya,Yb,this.GJ.hH())},zd=>{this.hib(zd,this.query.Cf,Nb,Yb,ya)},null,null,!1,4E3,6E3)}RIl(){var ya=0,Ra=new yh.a,hb=this.GJ.yXg,Eb=this.GJ.zXg;for(var Yb=0;Yb<this.Wk.length;Yb++){var Nb=this.Wk[Yb],ed=Ob.a[Nb.groupType].toLowerCase(),zd=hb[ed];ya+=Nb.results.length;Nb.results.length>zd&&(ed=Eb[ed],he.b(ed)||Ra.add(new La.a(ed,Nb)))}Eb=!this.query||""===this.query.Cf.trim();Yb=ya-(Eb?this.tIe:this.sIe);
if(!(0>=Yb)){Eb=window.performance.now();ya=ya.toString()+" total,"+Yb.toString()+" to remove.";if(0<Ra.count)for(Ra.Sc((Hd,ba)=>Hd.key>ba.key?-1:1),Nb=0;Nb<Ra.count&&0<Yb;Nb++){ed=Ra.ga(Nb).value;zd=Ob.a[ed.groupType].toLowerCase();let Hd=ed.results.length-hb[zd];Hd>Yb&&(Hd=Yb);0<Hd&&(ed.fVe(Hd),ya+=zd+": "+Hd.toString()+" results removed.",Yb-=Hd)}if(0<Yb){ya+=Yb.toString()+" results left after trimming.";Ra=new yh.a;hb=this.GJ.DXg;for(Nb=0;Nb<this.Wk.length;Nb++)ed=this.Wk[Nb],zd=hb[Ob.a[ed.groupType].toLowerCase()],
he.b(zd)||Ra.add(new La.a(zd,ed));Ra.Sc((Hd,ba)=>Hd.key<ba.key?-1:1);for(hb=0;0<Yb;)Nb=Ra.ga(hb++).value,Yb>=Nb.results.length?(Array.remove(this.Wk,Nb),ya+=Ob.a[Nb.groupType]+": "+Nb.results.length.toString()+" results force removed.",Yb-=Nb.results.length):(Nb.fVe(Yb),ya+=Ob.a[Nb.groupType]+": "+Yb.toString()+" results force removed.",Yb=0)}x.TellMeActor.instance.Jd&&(Ra={},Ra[r.a.message]=ya,x.TellMeActor.instance.Jd.OH("ShowOptimal",window.performance.now()-Eb,Ra))}}}Object(h.a)(Ue,"CombineResultsUpdatedEventArgs",
null,[766]);class Rf{constructor(ya,Ra,hb,Eb=!1,Yb=""){this.RLd=this.gNd=!1;this.UD=ya;this.e6a=[];this.Aqf=Ra.length;this.ub=x.TellMeActor.instance.hH();this.OCc=Eb;this.oQa=Yb;this.Vrb={};for(ya=0;ya<Ra.length;++ya)this.Vrb[ya.toString()]=hb?0:Ra[ya].GL()}znl(ya,Ra){Ra&&Ra.query&&Ra.query.b0a<x.TellMeActor.instance.vca||(this.e6a[ya]=Ra,this.RLd?this.gNd=!0:(!this.ub||3!==this.ub.Fq||3!==this.Vrb[ya.toString()]||this.GTf())&&this.T_c())}QNk(){this.RLd=!0}XLl(){this.RLd=!1;this.gNd&&(this.gNd=!1,
this.T_c())}GTf(){if(this.e6a.length<this.Aqf)return!1;for(let ya=0;ya<this.Aqf;++ya)if(!this.e6a[ya])return!1;return!0}T_c(){var ya=this.GTf();const Ra=window.performance.now(),hb=new Ue(x.TellMeActor.instance.rhf);hb.u6k(this.e6a);for(var Eb=0;Eb<this.e6a.length;++Eb){var Yb=this.e6a[Eb];if(Yb&&Yb.Wk&&Yb.Wk.length&&(hb.query=Yb.query,Yb.attributes&&0<Yb.attributes.length&&(hb.attributes=Yb.attributes),Yb&&Yb.Wk&&(ya||this.Jzi(Eb,this.e6a))))for(const Nb of Yb.Wk)hb.Aq(Nb)}hb.Wk&&hb.Wk.length&&(hb.tBb=
ya,this.ub&&this.ub.u7e&&hb.RIl(),this.ub&&this.ub.j2j&&hb.query.Cf&&0<hb.query.Cf.length?hb.qzl():hb.pzl(),this.ub&&(this.ub.woe||this.ub.T2c)&&this.OCc&&hb.query.Cf&&0<hb.query.Cf.length&&hb.tBb&&this.oQa!==e.a.contextMenu?(3===this.ub.Fq&&ya||this.UD.resultsUpdated(hb),hb.rzl(this.UD)):this.UD.resultsUpdated(hb),ya=x.TellMeActor.instance.Jd,hb.tBb&&ya&&(Eb=hb.query.b0a,Yb=ya.Szc,hb.query.Cf&&0<hb.query.Cf.length&&this.OCc&&this.ub.j3c&&this.oQa!==e.a.contextMenu&&Eb>Yb&&!this.ub.woe&&!this.ub.cI&&
(ya.Cse(hb.query.Cf),ya.GZe(Eb)),ya.OH(m.a.wcl,window.performance.now()-Ra)))}Jzi(ya,Ra){if(!(this.Vrb&&ya.toString()in this.Vrb)||Ra.length<=ya||!Ra[ya])return!1;if(!Ra[ya].Wk.length)return!0;const hb=this.Vrb[ya.toString()];if(0===hb)return!0;const Eb=this.Vrb;for(let Nb in Eb){var Yb=Eb[Nb];const ed=Number.parseInvariant(Nb);if(ed!==ya&&Yb===hb&&!(Ra.length>ed&&Ra[ed]))return!1}return!0}}Object(h.a)(Rf,"ResultsAggregator",null,[]);var sf=d(1041);class ag{constructor(){this.YPb=this.ZPb=this.XPb=
this.logCount=this.logRank=this.invertedRank=0}Sbi(ya,Ra){switch(ya){case 1:this.invertedRank=Ra;break;case 3:this.logRank=Ra;break;case 2:this.logCount=Ra;break;case 5:this.XPb=Ra;break;case 4:this.ZPb=Ra;break;case 6:this.YPb=Ra}}}Object(h.a)(ag,"CommandFeatures",null,[]);class xg{constructor(ya){this.ggf=0;this.pia=ya;this.NVh={}}get modelId(){return this.pia}get featureIntercept(){return this.ggf}get i2b(){return this.NVh}Yai(ya,Ra,hb){0===Ra?this.ggf=hb:(this.i2b[ya]||(this.i2b[ya]=new ag),this.i2b[ya].Sbi(Ra,
hb))}}Object(h.a)(xg,"CoefficientsModel",null,[]);const Tg=(ya,Ra)=>Math.pow(10,-Ra/(60*Math.LN10/Math.LN2*ya));class li{constructor(ya,Ra){this.il=1;this.QAc=new ag;this.features.logCount=1+Math.log(this.count)/Math.LN2;this.features.invertedRank=ya?1/ya:0;this.features.logRank=2/Math.pow(2,ya);this.features.XPb=Tg(10,Ra);this.features.ZPb=Tg(2,Ra);this.features.YPb=Tg(1,Ra)}get count(){return this.il}get features(){return this.QAc}KLj(){this.il=this.count+1;this.features.logCount=1+Math.log(this.count)/
Math.LN2}LPl(ya){const Ra=2/Math.pow(2,ya);this.features.invertedRank=Math.max(this.features.invertedRank,ya?1/ya:0);this.features.logRank=Math.max(this.features.logRank,Ra)}YQl(ya){const Ra=Tg(10,ya),hb=Tg(2,ya);ya=Tg(1,ya);this.features.XPb=Math.max(this.features.XPb,Ra);this.features.ZPb=Math.max(this.features.ZPb,hb);this.features.YPb=Math.max(this.features.YPb,ya)}}Object(h.a)(li,"CommandModel",null,[]);class Li{constructor(ya){this.NSb=null;if(!ya&&x.TellMeActor.instance.Jd)x.TellMeActor.instance.Jd.onError("PredictionEngine",
"IModelAdapter can't be null");this.Bqb=ya;this.LDc=this.Xre()}Xre(){const ya=this.Bqb.ylj(),Ra=this.Bqb.qbe();if(void 0===ya||null===ya||void 0===Ra||null===Ra)return!1;try{window.performance.now();this.NSb={};for(let hb=0;hb<ya.length;hb++){const Eb=ya[hb],Yb=Ra[Eb[0].toString()].trim(),Nb=Eb[1],ed=0!==Nb?Ra[Eb[2].toString()].trim():"",zd=Eb[3];Yb in this.NSb||(this.NSb[Yb]=new xg(Yb));this.NSb[Yb].Yai(ed,Nb,zd)}}catch(hb){if(x.TellMeActor.instance.Jd)x.TellMeActor.instance.Jd.onError("LoadModelData",
"Error Loading Suggestions Model: "+hb);return!1}return!0}N9i(){const ya=this.Bqb.cjj(),Ra={};if(!ya)return Ra;let hb=1;for(let Eb=0;Eb<ya.length;Eb++){const Yb=ya[Eb];Yb.Id in Ra?(Ra[Yb.Id].KLj(),Ra[Yb.Id].LPl(hb),Ra[Yb.Id].YQl(Yb.TimeElapsedSinceClick)):Ra[Yb.Id]=new li(hb,Yb.TimeElapsedSinceClick);hb++}return Ra}xoe(){this.LDc||(this.LDc=this.Xre());return this.LDc}hoj(){let ya=[];if(!this.LDc){if(x.TellMeActor.instance.Jd)x.TellMeActor.instance.Jd.onError("GetPredictedCommands","IModelAdapter returned no data");
return ya}const Ra=this.N9i(),hb=this.NSb;for(let Yb in hb){const Nb=hb[Yb],ed=Nb.modelId;let zd=0;for(let Hd in Ra){var Eb=Hd;const ba=Ra[Hd].features;(Eb=Eb in Nb.i2b?Nb.i2b[Eb]:null)&&(zd+=ba.invertedRank*Eb.invertedRank+ba.logRank*Eb.logRank+ba.logCount*Eb.logCount+ba.XPb*Eb.XPb+ba.ZPb*Eb.ZPb+ba.YPb*Eb.YPb)}zd+=Nb.featureIntercept;ya.push(new Od.a(ed,zd))}ya.sort((Yb,Nb)=>Yb.score<Nb.score?1:Yb.score>Nb.score?-1:0);0<ya.length-10&&(ya=ya.slice(0,10));return ya}}Object(h.a)(Li,"PredictionEngine",
null,[]);class Le{constructor(){this.Dsf={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),
"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),
"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}CUc(ya,
Ra){return Ra&&"word"===Ra.application.toLowerCase()&&ya in this.Dsf?this.Dsf[ya]:[]}}Object(h.a)(Le,"SuggestionResultsUtility",null,[]);class Ih{constructor(ya,Ra,hb){this.ub=Ra;this.JWb=new Li(ya);this.GS=hb;this.Utf=new Le}sE(){return"Suggestion"}GL(){return 0===this.ub.Fq?0:1===this.ub.Fq?1:2}FB(ya,Ra,hb,Eb=e.a.tellMe,Yb=null){hb=new v.a(ya);x.TellMeActor.instance.nxc=!1;if((!Yb||Array.contains(Yb,16))&&B.a.$F(ya)){if(!this.JWb.xoe()){if(x.TellMeActor.instance.Jd)x.TellMeActor.instance.Jd.onError("CRASH",
"SuggestionResultsProvider: Found invalid Model data");throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}Date.now();if(this.Dpe()&&0<this.Utf.CUc(x.TellMeActor.instance.dPc,this.ub).length){const ed=this.Utf.CUc(x.TellMeActor.instance.dPc,this.ub);Yb=[];for(var Nb of ed)this.ub.Ktd&&"Find"===Nb||Yb.push(new Od.a(Nb,0));x.TellMeActor.instance.nxc=!0}else Yb=this.JWb.hoj();dg.CommandResultsUtility.V4c(Yb,!0,"Recommended","LRE");Nb=[];for(const ed of Yb)this.GS&&this.GS.u_d(ed.commandId)||
Nb.push(ed);ya=dg.CommandResultsUtility.f8b(ya,Nb,this.ub,null,null,null,16,1);0<ya.results.length&&Eb!==e.a.contextMenu&&(ya.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<ya.results.length&&hb.Aq(ya)}Ra.resultsUpdated(hb)}Dpe(){return!!this.ub&&(this.ub.Dpe||this.ub.A6j)}}Object(h.a)(Ih,"SuggestionResultsProvider",null,[750]);class bj{cjj(){return x.TellMeActor.instance.CCd}ylj(){return window.TellMeSuggestionModel}qbe(){return window.CoefficientModelIdMap}}Object(h.a)(bj,"SuggestionsModelAdapter",
null,[956]);var zh=d(1076),jj=d(1010);d.d(U,"AggregatorResultsProvider",function(){return Sh});class Sh{constructor(ya=!1){this.Yqb={};this.Yqb[e.a.tellMe]=[];this.Yqb[e.a.contextMenu]=[];this.OCc=ya}xtg(ya,Ra,hb,Eb,Yb=null){let Nb;var ed=!1;switch(Eb){case e.a.contextMenu:Nb=this.Yqb[e.a.contextMenu];ed=!0;break;default:Nb=this.Yqb[e.a.tellMe]}Ra=new Rf(Ra,Nb,ed,this.OCc,Eb);Ra.QNk();for(let zd=0;zd<Nb.length;++zd){const Hd=window.performance.now(),ba=new G(Ra,zd);(ed=x.TellMeActor.instance.hH())&&
ed.Aqi?window.setTimeout(()=>{Nb[zd].FB(ya,ba,hb,Eb,Yb);if(x.TellMeActor.instance.Jd){const Aa={};Aa[r.a.provider]=Nb[zd].sE();Aa[r.a.tjb]=ya.b0a;x.TellMeActor.instance.Jd.OH(m.a.FB,window.performance.now()-Hd,Aa)}},0):(Nb[zd].FB(ya,ba,hb,Eb,Yb),x.TellMeActor.instance.Jd&&(ed={},ed[r.a.provider]=Nb[zd].sE(),ed[r.a.tjb]=ya.b0a,x.TellMeActor.instance.Jd.OH(m.a.FB,window.performance.now()-Hd,ed)))}Ra.XLl()}sE(){return"Aggregator"}GL(){return 0}FB(ya,Ra,hb=!1,Eb=e.a.tellMe,Yb=null){if(x.TellMeActor.instance.zwk)this.xtg(ya,
Ra,hb,Eb,Yb);else{const Nb=window.performance.now();x.TellMeActor.instance.kUl.then(()=>{x.TellMeActor.instance.Jd&&x.TellMeActor.instance.Jd.OH(m.a.Awk,window.performance.now()-Nb);this.xtg(ya,Ra,hb,Eb,Yb);return!0})}}gz(ya,Ra){this.Yqb[Ra].push(ya)}Ici(ya){switch(ya){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Ra=this.Yqb[e.a.tellMe];for(const hb of Ra)if("FindInDocument"===hb.sE()){hb.eml(ya);break}}}static createInstance(ya,Ra,hb,Eb){const Yb=
Ra.M3;var Nb=Eb&&B.a.b1e(Ra),ed=Nb&&Ra.wNe&&!Yb;const zd=Ra.pqe&&!B.a.RBb()&&!Yb,Hd=Ra.Goe&&!Yb,ba=new Sh(Nb);if(Ra.Ntl&&!Yb){var Aa=new Ie(Ra);ba.gz(Aa,e.a.tellMe)}Aa=Ra.Pp?We.AFrameworkApplication.fa.ka("TellMeIsSuggestionsForSimplifiedUxEnabled"):We.AFrameworkApplication.fa.ka("TellMeSuggestionsIsEnabled");const Pa=!Aa&&We.AFrameworkApplication.fa.ka("TellMeFirstRunExperienceIsEnabled");ba.gz(new ij.a(ya,Ra.zKl,Pa,!1),e.a.tellMe);Aa&&!Yb&&ba.gz(new Ih(new bj,Ra,ya),e.a.tellMe);ya=We.AFrameworkApplication.Aa.ob.Dsg?
new Fj(Ra,new Yh):new Zj(Ra,hb);ba.gz(ya,e.a.contextMenu);(Nb&&Ra.xNe||ed)&&ba.gz(zh.a.rQf(Ra,!0),e.a.tellMe);ba.gz(ya,e.a.tellMe);!Ra.N4i||Yb||"Word"===Ra.application&&Ra.b0f||ba.gz(new Pg(Ra),e.a.tellMe);Ra.J7a&&!Yb&&(ed=new M(Ra),ba.gz(ed,e.a.tellMe),ba.gz(ed,e.a.contextMenu));!Ra.wtb||Ra.Htc||Ra.Gtc||Yb||ba.gz(new N.a(Ra),e.a.tellMe);Eb&&(Ra.LFa||B.a.J9())&&(ed=new Hh(Ra),ba.gz(ed,e.a.tellMe),ba.gz(ed,e.a.contextMenu));Nb&&ba.gz(zh.a.rQf(Ra,!1),e.a.tellMe);Eb&&!Ra.r4e&&B.a.a1e(Ra)&&!Yb&&(ba.gz(new sf.a(Ra),
e.a.tellMe),Ra.nCl&&ba.gz(new sf.a(Ra),e.a.contextMenu));zd&&ba.gz(new Wd(Ra),e.a.tellMe);!Ra.EOb&&!Ra.cI||Yb||ba.gz(new Ej.a(Ra),e.a.tellMe);Ra.ycc&&!Yb&&ba.gz(new jj.a(Ra),e.a.tellMe);Ra.fme&&(Nb=new w(Ra),ba.gz(Nb,e.a.tellMe),ba.gz(Nb,e.a.contextMenu));Eb&&Ra.f0c&&!Yb&&ba.gz(new J.AddinResultsProvider(Ra),e.a.tellMe);Hd&&"Excel"===Ra.application&&!Yb&&ba.gz(new Hi(Ra),e.a.tellMe);return ba}}Object(h.a)(Sh,"AggregatorResultsProvider",null,[750])},1041:function(K,U,d){K=d(0);var h=d(144),e=d(681),
r=d(388),m=d(263);class n{constructor(aa,ja,I,sa,ka,Ma){this.lastModified=this.size=this.uniqueId=this.spWebUrl=this.url=this.fileType=null;this.fileType=aa;this.url=ja;this.spWebUrl=I;this.uniqueId=sa;this.size=ka;this.lastModified=Ma}}Object(K.a)(n,"FileInfo",null,[]);var z=d(455);class v{constructor(aa,ja){this.DimensionValue=this.DimensionName=null;this.DimensionName=aa;this.DimensionValue=ja}}Object(K.a)(v,"Dimension",null,[]);class x{constructor(aa,ja,I,sa,ka){this.Query=this.EntityType=null;
this.Size=this.From=0;this.Filter=null;this.EntityType=aa;this.Query=ja;this.From=I;this.Size=sa;ka&&(this.Filter=ka)}}Object(K.a)(x,"EntityRequest",null,[]);class B{constructor(aa){this.QueryString=null;this.QueryString=aa}}Object(K.a)(B,"Query",null,[]);var D=d(160);class w{constructor(aa,ja){this.Dimensions=this.Name=null;this.Name=aa;this.Dimensions=ja}}Object(K.a)(w,"Scenario",null,[]);var J=d(176),G=d(175);class M{constructor(aa,ja,I,sa){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=
null;this.EntityRequests=aa;this.TimeZone=ja;this.Cvid=I;this.Scenario=sa}}Object(K.a)(M,"SubstrateBody",null,[]);var N=d(454),R=d(117),C=d(108),O=d(27),S=d(951),T=d(950),ca=d(300),L=d(36),da=d(47),Z=d(106);d.d(U,"a",function(){return fa});class fa{constructor(aa){this.XWb=this.VPa=this.XDc=this.kUb=this.vXb=0;this.gof=this.Ppf=this.wI=null;this.aJd=0;this.yS=-1;this.$Yb="";this.iFd=!1;this.hi=O.AFrameworkApplication.Me;this.ub=aa;this.LGc=this.qde();this.k6a=new e.a;this.fnf=this.ub.u7e?3:2;this.QPd=
this.ub.u7e&&this.ub.DCh?5:3;this.yRd=this.ub.Ktd?2:3;this.$vf=1;this.zDc=this.ub.I9f;this.wtf=this.ub.I3j;this.ZXb=aa.obg;O.AFrameworkApplication.fa&&(this.Ppf=O.AFrameworkApplication.fa.Ha("AppCatalogUrl")+O.AFrameworkApplication.fa.Ha("SearchPersonaPhotoBaseUrl"),this.iFd=this.ub.M3||this.ub.gRc);this.ub.M3&&(this.yRd=this.QPd=5)}sE(){return"Substrate"}GL(){return 0===this.ub.Fq?0:1===this.ub.Fq?1:3}FB(aa,ja,I,sa=h.a.tellMe,ka=null){const Ma=new G.a(aa);if(!ka||Array.contains(ka,14)||Array.contains(ka,
15)||Array.contains(ka,20))if(!this.aJd||window.performance.now()-this.aJd>=C.a.Mwd)if(I=this.k6a.Rbg())this.aJd=window.performance.now(),I.then(Ea=>{Ea&&""!==Ea?(this.$Yb=Ea,""!==this.wI&&this.Qbg(aa,sa,this.$Yb,ja,ka)):(R.TellMeActor.instance.Jd.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),ja.resultsUpdated(Ma))},Ea=>{R.TellMeActor.instance.Jd.onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+Ea);ja.resultsUpdated(Ma)});else{if(R.TellMeActor.instance.Jd)R.TellMeActor.instance.Jd.onError("SubstrateResultsProvider:IssueQuery",
"undefined token promise");ja.resultsUpdated(Ma)}else this.$Yb&&""!==this.$Yb?this.Qbg(aa,sa,this.$Yb,ja,ka):(ja.resultsUpdated(Ma),R.TellMeActor.instance.Jd.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else ja.resultsUpdated(Ma)}F1(){this.VPa=this.XWb=this.XDc=this.kUb=this.vXb=0}Qbg(aa,ja,I,sa,ka){this.F1();const Ma=new G.a(aa),Ea=this.wI=Z.a.create().toString();this.Hja();this.yS=window.setTimeout(()=>{if(Ea===this.wI){this.wI="";this.yS=-1;sa.resultsUpdated(Ma);
const Ca={};Ca[r.a.provider]=this.sE();Ca[r.a.tjb]=aa.b0a;R.TellMeActor.instance.Jd.OH(m.a.timedOut,this.ZXb,Ca)}},this.ZXb);const ma={"Content-Type":"application/json",Accept:"application/json"};ma.Authorization="Bearer "+I;ma["X-Office-Version"]=O.AFrameworkApplication.buildVersion;ma["X-Office-Application"]=O.AFrameworkApplication.fa.Ha("Application");ma["X-Office-Platform"]="WAC";ma["X-TellMe-SessionId"]=R.TellMeActor.instance.wXc();ma["X-TellMe-Culture"]=O.AFrameworkApplication.uiCulture;ma["X-TellMe-ProcessSessionId"]=
O.AFrameworkApplication.userSessionId;ma["Client-Request-Id"]=Ea;const va=window.performance.now();this.hi.zj(this.Jtj(),2,this.Ktj(aa.Cf,this.ub.application,R.TellMeActor.instance.wXc(),C.a.$F(aa)),ma,!1,0,Ca=>{this.vib(Ca,aa,sa,Ea,va,ja,ka)},Ca=>{this.hib(Ca,aa,sa,Ea,va)},null,null,!1,4E3,6E3)}Hja(){-1!==this.yS&&(window.clearTimeout(this.yS),this.yS=-1)}vib(aa,ja,I,sa,ka,Ma,Ea){R.TellMeActor.instance.Jd.d6(ja.Cf.length,this.LGc.join(","),aa.data.Ke.toString(),Math.round(window.performance.now()-
ka),N.a.substrate,!0,z.a.xua);const ma=C.a.$F(ja),va=new G.a(ja);if(sa===this.wI){this.Hja();aa=L.b(aa.data.ee);if(aa.Groups){aa=aa.Groups;for(const Ca of aa)"People"===Ca.Type&&this.ub.xvc&&(Ea?Array.contains(Ea,14):1)?(aa=this.k$f(Ca.Suggestions,ma,Ma),0<aa.results.length&&va.Aq(aa)):"File"===Ca.Type&&this.ub.vvc&&(Ea?Array.contains(Ea,15):1)?(aa=this.Q$d(Ca.Suggestions,ma,Ma),0<aa.results.length&&(this.q1c()&&(sa=new D.a("GenerateSlidesFromTellMe",30,"",null,1),aa.us(sa)),va.Aq(aa))):"Notes"===
Ca.Type&&this.ub.qWa&&Ma!==h.a.contextMenu&&(Ea?Array.contains(Ea,20):1)&&(aa=this.F9f(Ca.Suggestions,ma,ja),0<aa.results.length&&va.Aq(aa))}I.resultsUpdated(va);R.TellMeActor.instance.Jd.d6(ja.Cf.length,this.LGc.join(","),"",Math.round(window.performance.now()-ka),"",!0,z.a.provider)}else I.resultsUpdated(va)}F9f(aa,ja,I){const sa=new J.a(20);sa.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;for(const ka of aa)this.O5j(ka)&&(aa=ka.NotesType,aa=da.a.rg(aa),aa=this.zmj(aa,ka.LastModifiedTime,
ka.BodyPreview,ka.Subject,ja,I,ka))&&(aa.groupType=20,sa.us(aa));return sa}k$f(aa,ja,I){const sa=new J.a(14);sa.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const Ma of aa)if(this.P5j(Ma)){var ka=Ma.Id.split("@")[0];aa=Ma.EmailAddresses[0];let Ea=Ma.Type;if(void 0===Ea||null===Ea)Ea="User";if(ka=this.Lnj(Ea,Ma.DisplayName,Ma.JobTitle,aa,ka,I,ja))ka.description=aa,aa=Ma.JobTitle,"Department"in Ma&&"CompanyName"in Ma&&(aa+="@"+Ma.Department+"@"+Ma.CompanyName),ka.MTd=aa,sa.us(ka)}return sa}Q$d(aa,
ja,I){const sa=new J.a(15);sa.displayName=CommonUIStrings.l_TellMeFileProviderTitle;for(const Ca of aa)if(this.F5j(Ca)){var ka=Ca.FileName;aa=Ca.FileExtension;var Ma=ka;ka.length>aa.length&&Ma.endsWith(aa)&&(Ma=ka.substr(0,ka.length-aa.length-1));var Ea=void 0,ma=0;"DateCreated"in Ca&&Ca.DateCreated?(ma=C.a.Rde(Ca.DateCreated),Ea=C.a.Ccg(Ca.DateCreated),Ea=String.format(CommonUIStrings.l_CreatedTimeFormatString,Ca.Author,Ea)):Ea=Ca.Author;var va=Ca.AccessUrl+"?web=1";const oa=da.a.i$b(va);ka=String.format('<a href="{0}">{1}</a>',
oa,da.a.eVa(ka));if(I!==h.a.contextMenu||da.a.C9(va))if(Ma=this.bhj(Ma,I===h.a.contextMenu?ka:va,Ea,Ca.FileExtension,Ca.Text,ja))Ma.description=Ca.Author,Ma.HJc=ma,sa.us(Ma),this.iFd&&(ma=Ca.AccessUrl,ka=C.a.qVc(aa),Ea=Ca.DateModified?Ca.DateModified:Ca.DateCreated,va=Ca.Size?Ca.Size:Ca.FileSize,this.Vsl()&&(ma=ma.replace(RegExp("%20","g")," "),ka=C.a.Osj(aa)),aa=new n(ka,ma,Ca.SPWebUrl,Ca.Id,va,Ea),R.TellMeActor.instance.g9e(!1,Ma.value,aa))}return sa}hib(aa,ja,I,sa,ka){sa===this.wI&&(this.Hja(),
R.TellMeActor.instance.Jd.d6(ja.Cf.length,this.LGc.join(","),aa.data.Ke.toString(),Math.round(window.performance.now()-ka),N.a.substrate,!1,z.a.xua));aa=new G.a(ja);I.resultsUpdated(aa)}Lnj(aa,ja,I,sa,ka,Ma,Ea){Ea=Ea?this.$vf:this.fnf;if(!window.LPC&&!C.a.cne()||this.vXb===Ea)return null;this.vXb+=1;Ea="PeopleSuggestion"+this.vXb.toString();var ma=this.Ppf+"?size=1&accountName="+sa;aa=Object.assign(new S.a,{PersonaType:aa,Smtp:sa,ProfilePictureUrl:ma,AadObjectId:ka});const va=Object.assign(new T.a,
{identifiers:aa,displayName:ja});aa=Ma===h.a.contextMenu;this.ub.Yda?(R.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(Ea,va,ja,I)),Ma===h.a.contextMenu&&(I=C.a.bQf(ja,sa,ka),R.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Ea,I))),R.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Ea,aa))):(ma=[],ma.push(appChrome.actions.setPersonaButtonCoauthor(Ea,va,ja,I)),Ma===h.a.contextMenu&&(I=C.a.bQf(ja,
sa,ka),ma.push(appChrome.actions.setButtonCommandValueId(Ea,I))),ma.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Ea,aa)),appChrome.api.dispatch(ma));return new D.a(Ea,11,ja,sa,0)}zmj(aa,ja,I,sa,ka,Ma,Ea){if(ka&&!this.ub.Hsg||this.XDc===this.zDc||this.XWb===this.zDc||this.VPa===this.zDc)return null;var ma=null;this.XDc+=1;ka="";const va=[],Ca={};Ea.type="Notes";this.gof=Object.assign(new ca.a,{landingTab:"Notes",data:Ea});Ma=C.a.zDa(Ma.Cf,33,this.gof);if("onenotepagepreviews"===
aa){if(!("ClickthroughUrl"in Ea&&Ea.ClickthroughUrl)||""===Ea.ClickthroughUrl)return null;this.XWb+=1;ka="OnenoteNotesSuggestion"+this.XWb.toString();Ca["default"]="SaveAsonetoc2_20";ma=Ea.ClickthroughUrl;va.push(appChrome.actions.setControlIconSet(ka,Ca));va.push(appChrome.actions.setCompoundButtonCommandValueId(ka,ma));ma=new D.a(ka,19,null,null,0)}else if("stickynote"===aa){if(!this.wtf)return null;this.VPa+=1;ka="NotesSuggestion"+this.VPa.toString();Ca["default"]="ShowAllNotes_20";va.push(appChrome.actions.setControlIconSet(ka,
Ca));va.push(appChrome.actions.setCompoundButtonCommandValueId(ka,Ma));ma=new D.a(ka,21,null,null,0)}else if("samsung"===aa){if(!this.wtf)return null;this.VPa+=1;ka="NotesSuggestion"+this.VPa.toString();Ca["default"]="CategoryCollapsed_20";va.push(appChrome.actions.setControlIconSet(ka,Ca));va.push(appChrome.actions.setCompoundButtonCommandValueId(ka,Ma));ma=new D.a(ka,20,null,null,0)}""!==ka&&(aa=C.a.Ccg(ja),aa=String.format(CommonUIStrings.l_LastModifiedString,aa),ma.label=sa,ma.HJc=C.a.Rde(ja),
va.push(appChrome.actions.setControlLabel(ka,sa)),va.push(appChrome.actions.updateCompoundButtonDescription(ka,aa)),va.push(appChrome.actions.setControlCustomTooltip(ka,I)),appChrome.api.dispatch(va));return ma}bhj(aa,ja,I,sa,ka,Ma){if(this.kUb===(Ma?this.yRd:this.QPd)||this.iFd&&"Word"!==C.a.qVc(sa))return null;this.kUb+=1;Ma="FileSuggestion"+this.kUb.toString();const Ea=[],ma={};ma["default"]=C.a.Bij(sa);this.ub.Yda?(R.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Ma,aa)),
R.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(Ma,ma)),R.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(Ma,I)),R.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(Ma,ja)),R.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(Ma,ka))):(Ea.push(appChrome.actions.setControlLabel(Ma,aa)),Ea.push(appChrome.actions.setControlIconSet(Ma,ma)),Ea.push(appChrome.actions.updateCompoundButtonDescription(Ma,
I)),Ea.push(appChrome.actions.setCompoundButtonCommandValueId(Ma,ja)),Ea.push(appChrome.actions.setControlCustomTooltip(Ma,ka)),appChrome.api.dispatch(Ea));return new D.a(Ma,6,aa,I,0)}qde(){const aa=[];this.ub.xvc&&Array.add(aa,"People");this.ub.vvc&&Array.add(aa,"File");this.ub.qWa&&Array.add(aa,"Notes");return aa}Ktj(aa,ja,I,sa){var ka=new B(aa);aa=new x("File",ka,0,sa?this.yRd:this.QPd,null);sa=new x("People",ka,0,sa?this.$vf:this.fnf,C.a.$Nk);ka=new x("Notes",ka,0,this.zDc,null);this.ub.gRc&&
"powerpoint"===ja.toLowerCase()&&(ja="word");ja=new v("app",ja.toLowerCase());var Ma=[];Array.add(Ma,ja);ja=new w("tellmesearch",Ma);Ma=[];this.ub.vvc&&Array.add(Ma,aa);this.ub.xvc&&Array.add(Ma,sa);this.ub.qWa&&Array.add(Ma,ka);I=new M(Ma,"UTC",I,ja);return L.c(I)}Jtj(){let aa=this.ub.oCl;this.ub.qWa&&(aa+="?&setflight=NotesFrom3S");""!==this.ub.Sbg&&(aa=aa+"&"+this.ub.Sbg);return aa}P5j(aa){return"DisplayName"in aa&&"Id"in aa&&"EmailAddresses"in aa&&!!aa.Id&&!!aa.EmailAddresses}F5j(aa){return"FileExtension"in
aa&&!!aa.FileExtension&&"FileName"in aa&&!!aa.FileName&&""!==aa.FileName&&"AccessUrl"in aa&&!!aa.AccessUrl&&""!==aa.AccessUrl}O5j(aa){return"Id"in aa&&!!aa.Id&&"NotesType"in aa&&!!aa.NotesType&&"Subject"in aa&&!!aa.Subject&&""!==aa.Subject}q1c(){return!!O.AFrameworkApplication.fa&&O.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}Vsl(){return!!O.AFrameworkApplication.fa&&O.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldPerformFileInfoFixes",
!0)}}Object(K.a)(fa,"SubstrateResultsProvider",null,[750])},1076:function(K,U,d){K=d(0);var h=d(18),e=d(144),r=d(681),m=d(388),n=d(263),z=d(455),v=d(160),x=d(176),B=d(175),D=d(117),w=d(108);class J{constructor(Z){this.ub=Z;this.LGc=this.qde()}sE(){return"Add-ins"}GL(){return 0===this.ub.Fq?0:1===this.ub.Fq?1:3}FB(Z,fa){Z=new B.a(Z);fa.resultsUpdated(Z)}FUa(Z,fa,aa){let ja;ja=this.ub.cI?new x.a(29):new x.a(27);ja.displayName=CommonUIStrings.l_TellMeAddinProviderTitle;aa&&this.qxl(Z.Cf,fa,ja)}qxl(Z,
fa,aa){const ja=[];let I;I=this.ub.fSj?this.ub.cI&&this.ub.ZQa?w.a.GTa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1_Bolded,Z)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1,Z):this.ub.gSj?this.ub.cI&&this.ub.ZQa?w.a.GTa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2_Bolded,Z)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2,Z):this.ub.cI&&this.ub.ZQa?w.a.GTa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0_Bolded,
Z)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,Z);this.ub.Yda?(D.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",I)),D.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",Z))):(ja.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",I)),ja.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",Z)),appChrome.api.dispatch(ja));aa.us(new v.a("LaunchAddinDialogFromTellMe",
29));fa.Aq(aa)}qde(){const Z=[];this.ub.f0c&&Array.add(Z,"Addin");return Z}}Object(K.a)(J,"AddinStoreResultsProvider",null,[750]);var G=d(1008),M=d(343),N=d(389),R=d(1009),C=d(1041),O=d(1010),S=d(454),T=d(27),ca=d(36),L=d(106);d.d(U,"a",function(){return da});class da{constructor(Z,fa,aa){this.cQa=this.HYb=this.IYb=this.rGc=!1;this.wI=null;this.yS=-1;this.TBa=this.hZb=this.oQa=this.E6a=null;this.Vlf=this.Xlf=0;this.ub=Z;const ja=w.a.J9();this.nOa=fa||[];this.hi=T.AFrameworkApplication.Me;this.ftf=
Z.xNe;this.JYb=Z.wNe;this.pGc=ja&&this.Klb();this.qGc=ja&&this.Llb();this.htf=ja&&this.Mlb();this.tGc=this.FOb();this.BOd=this.EOb();if((fa=Z.r4e&&w.a.a1e(Z))||Z.M3)this.E6a=new C.a(Z),this.rGc=Z.vvc;fa&&(this.IYb=Z.xvc,this.HYb=Z.qWa,this.cQa=this.rGc&&this.Hs("File")||this.IYb&&this.Hs("People")||this.HYb&&this.Hs("Notes"));this.oGc=this.Ftl();this.KYb=Z.snc;this.sGc=this.Utl();this.AOd=this.Etl();this.Brb=this.Jtd();this.CAa=this.Duj();this.Cbf=new G.a(Z);this.$Zh=new R.a(Z);this.Z8h=new O.a(Z);
this.NTh=new J(Z);this.ZXb=aa;this.k6a=new r.a;this.KYb&&(this.Cbf=new G.a(Z));Z.M3&&(this.AOd=this.sGc=this.KYb=this.cQa=this.HYb=this.IYb=this.BOd=this.tGc=this.htf=this.qGc=this.pGc=this.JYb=!1,T.AFrameworkApplication.fa&&this.Hs("File")&&this.vBh()||this.Brb)&&(Z=this.k6a.Ude("Search",T.AFrameworkApplication.fa.Ha("TellMeServiceAuthEndpointForSearch")),this.U5b(Z,"TellMeService",!0),Z=this.k6a.Ude("SmartLookup",T.AFrameworkApplication.fa.Ha("SmartLookupShredderServiceEndpoint")),this.U5b(Z,"Shredder",
!1));T.AFrameworkApplication.fa&&this.cQa&&this.Hs("File")&&this.vBh()&&(Z=this.k6a.Ude("Search",T.AFrameworkApplication.fa.Ha("TellMeServiceAuthEndpointForSearch")),this.U5b(Z,"TellMeService",!0))}Hs(Z){return Array.contains(this.nOa,Z)?!0:!1}sE(){return"TellMeService"}GL(){return 0===this.ub.Fq?0:1===this.ub.Fq?1:this.Hs("Command")||this.Hs("Recommended")?2:3}Auj(Z){let fa="";if(!Z&&this.Hs("Command")&&this.ub.Aoe){fa+="CommandSearch_DLIS,";var aa=this.ub.$Hh;0<aa.length&&(fa+=aa+",")}Z&&this.Hs("Recommended")&&
this.JYb&&(aa=this.mxj(),0<aa.length&&(fa+=aa+","));!Z&&this.Hs("Help")&&(Z=this.ub.ZHh,0<Z.length&&(fa+=Z+","));this.ub.M3&&this.TBa&&0<this.TBa.length&&(fa+="IsRecallEnabled_true,");(this.ub.gRc||this.ub.M3)&&this.cQa&&(fa+="IsGenerateSlidesEnabled_true,");0<fa.length&&(fa=fa.substr(0,fa.length-1));return fa}U5b(Z,fa,aa){const ja=aa?this.Xlf:this.Vlf;if(!ja||window.performance.now()-ja>=w.a.Mwd)if(Z)aa?this.Xlf=window.performance.now():this.Vlf=window.performance.now(),Z.then(I=>{aa?this.hZb=I:
(this.TBa=I,D.TellMeActor.instance.F2e=I)},I=>{D.TellMeActor.instance.Jd.onError("TellMeServiceProvider:FetchTokenForService_"+fa,"tellMeServiceToken promise rejected: "+I)});else if(D.TellMeActor.instance.Jd)D.TellMeActor.instance.Jd.onError("TellMeServiceProvider:FetchTokenForService_"+fa,"undefined token promise")}FB(Z,fa,aa,ja=e.a.tellMe,I=null){const sa=new B.a(Z);aa=w.a.$F(Z);this.Hs("File")&&(this.cQa||this.ub.M3)&&this.U5b(this.k6a.Euj(),"TellMeService",!0);(this.Hs("File")&&this.ub.M3||this.Hs("ActionAI")&&
this.Brb)&&this.U5b(this.k6a.hsj(),"Shredder",!1);var ka=this.cQa&&!!this.hZb;const Ma=this.ub.M3&&!!this.TBa;var Ea=ka||Ma||aa&&this.Hs("Recommended")&&this.JYb;ka=ka||Ma||!aa&&(this.ftf&&this.Hs("Command")||this.pGc&&this.Hs("Answer")||this.qGc&&this.Hs("Definition")||this.BOd&&this.Hs("Image")||this.KYb&&this.Hs("Help")||this.tGc&&this.Hs("WolframAnswer")||this.sGc&&this.Hs("Template")||this.AOd&&this.Hs("Addin"));if(Ea||ka)if(this.oQa=ja,ja={"Content-Type":"application/json",Accept:"application/json"},
ja["X-Office-Version"]=T.AFrameworkApplication.buildVersion,ja["X-Office-Application"]=T.AFrameworkApplication.fa.Ha("Application"),ja["X-Office-Platform"]="WAC",ja["X-TellMe-SqmUserId"]=T.AFrameworkApplication.fa.Ha("LoggableUserId")||"",ja["X-TellMe-SessionId"]=D.TellMeActor.instance.wXc(),this.hZb&&(ja.Authorization="Bearer "+this.hZb),this.TBa&&0<this.TBa.length&&(ja["X-TellMe-ShredderToken"]="Bearer "+this.TBa),Ea=this.Auj(aa),0<Ea.length&&(ja["X-TellMe-Flights"]=Ea),Ea=[],!aa&&this.Hs("Answer")&&
this.pGc&&(I?Array.contains(I,9):1)&&Array.add(Ea,"Answer"),!aa&&this.Hs("Command")&&this.ftf&&!M.CommandResultsUtility.Kme(Z.Cf)&&(I?Array.contains(I,17):1)&&Array.add(Ea,"Command"),!aa&&this.Hs("Definition")&&this.qGc&&(I?Array.contains(I,10):1)&&Array.add(Ea,"Definition"),!aa&&this.Hs("Help")&&this.KYb&&(I?Array.contains(I,8):1)&&Array.add(Ea,"Help"),!aa&&this.Hs("WolframAnswer")&&this.tGc&&(I?Array.contains(I,12):1)&&Array.add(Ea,"WolframAnswer"),aa&&this.Hs("Recommended")&&this.JYb&&!D.TellMeActor.instance.nxc&&
(I?Array.contains(I,18):1)&&Array.add(Ea,"Recommended"),!aa&&this.Hs("Image")&&this.BOd&&(I?Array.contains(I,19):1)&&Array.add(Ea,"Image"),this.hZb&&this.cQa&&(I?Array.contains(I,14)||Array.contains(I,15)||Array.contains(I,20):1)&&(this.E6a.F1(),this.rGc&&this.Hs("File")&&Array.add(Ea,"File"),this.IYb&&this.Hs("People")&&Array.add(Ea,"People"),this.HYb&&this.Hs("Notes")&&Array.add(Ea,"Notes")),this.TBa&&0<this.TBa.length&&this.ub.M3&&(I?Array.contains(I,15):1)&&(this.E6a.F1(),this.Hs("File")&&Array.add(Ea,
"File")),!aa&&this.Hs("Template")&&this.sGc&&(I?Array.contains(I,23):1)&&Array.add(Ea,"Template"),!aa&&this.Hs("Addin")&&this.AOd&&(I?Array.contains(I,27):1)&&Array.add(Ea,"Addin"),!aa&&this.Hs("ActionAI")&&this.Brb&&(I?Array.contains(I,25):1)&&Array.add(Ea,"ActionAI"),Ea.length){ja["X-TellMe-SuggestionTypes"]=Ea.join(",");ja["X-TellMe-Culture"]=T.AFrameworkApplication.uiCulture;ja["X-TellMe-ProcessSessionId"]=T.AFrameworkApplication.userSessionId;var ma=this.wI=L.a.create().toString();ja["Client-Request-Id"]=
ma;var va=window.performance.now();this.Hja();this.yS=window.setTimeout(()=>{if(ma===this.wI){this.wI="";this.yS=-1;fa.resultsUpdated(sa);const Ca={};Ca[m.a.provider]=this.sE();Ca[m.a.tjb]=Z.b0a;D.TellMeActor.instance.Jd.OH(n.a.timedOut,this.ZXb,Ca)}},this.ZXb);this.hi.zj(this.CAa,2,this.Cuj(Z.Cf),ja,!1,0,Ca=>{this.vib(Ca,Z,fa,ma,va,I)},Ca=>{this.hib(Ca,Z,fa,ma,va)},null,null,!1,4E3,this.Brb?3E4:6E3)}else D.TellMeActor.instance.Jd.onError("IssueQuery","Empty Online Provider List: No online calls by provider"),
fa.resultsUpdated(sa);else fa.resultsUpdated(sa)}Hja(){-1!==this.yS&&(window.clearTimeout(this.yS),this.yS=-1)}vib(Z,fa,aa,ja,I,sa){const ka=new B.a(fa);if(ja===this.wI){this.Hja();D.TellMeActor.instance.Jd.d6(fa.Cf.length,this.nOa.join(","),Z.data.Ke.toString(),Math.round(window.performance.now()-I),S.a.tellMe,!0,z.a.xua);ja=Z.data.ee;Z=null;try{Z=ca.b(ja)}catch(oa){D.TellMeActor.instance.Jd.onError("OnSuccessCallBack","Exception occured while deserializing response:"+oa);return}ja=w.a.$F(fa);if("Groups"in
Z&&Z.Groups){var Ma=Z.Groups;for(var Ea of Ma)if("GroupType"in Ea&&"Suggestions"in Ea&&Ea.Suggestions)if("Commands"===Ea.GroupType&&(sa?Array.contains(sa,17):1)||"Recommended"===Ea.GroupType&&(sa?Array.contains(sa,18):1)){var ma=(Ma="Recommended"===Ea.GroupType)?"DLIS":"NaiveBayes";"Source"in Ea&&Ea.Source&&(ma=Ea.Source);var va=Ea.Suggestions;new h.a;var Ca=[];for(const oa of va)this.C5j(oa)&&(va=oa.Type,("Command"===va||Ma&&"Recommended"===va)&&Ca.push(new N.a(oa.CommandId,oa.Score)));M.CommandResultsUtility.V4c(Ca,
!fa.Cf.trim().length,Ea.GroupType,ma);ma=D.TellMeActor.instance.GS;va=[];for(const oa of Ca)Ma&&ma&&ma.u_d(oa.commandId)||va.push(oa);Ca=M.CommandResultsUtility.f8b(fa,va,this.ub,null,null,null,Ma?18:17,0);0<Ca.results.length&&(this.oQa!==e.a.contextMenu&&(Ca.displayName=Ma?CommonUIStrings.l_TellMeTryCommandTitle:CommonUIStrings.l_TellMeCommandProviderTitle),ka.Aq(Ca))}else if("Answer"===Ea.GroupType){va=Ea.Suggestions;Ma=null;Ca=2147483647;ma="";for(const oa of va)if(this.z5j(oa))if(ma=oa.Type,va=
this.Kyb(ma),"Answer"===ma&&this.pGc){Ma=this.WPf(ma,oa,fa.Cf);break}else va&&va<Ca&&(Ca=va,Ma=this.WPf(ma,oa,fa.Cf));Ca=w.a.vcl(fa.Cf,ma);Ma&&(sa?Array.contains(sa,Ma.type):1)&&(ma=[],this.oGc?this.ub.Yda?(D.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Ma.value,Ma.dK)),D.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(Ma.value,Ma.description)),D.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(Ma.value,
Ca))):(ma.push(appChrome.actions.setControlLabel(Ma.value,Ma.dK)),ma.push(appChrome.actions.updateCompoundButtonDescription(Ma.value,Ma.description)),ma.push(appChrome.actions.setCompoundButtonCommandValueId(Ma.value,Ca)),appChrome.api.dispatch(ma)):this.ub.Yda?(D.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Ma.value,Ma.dK+" - "+Ma.description)),D.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Ma.value,Ca))):(ma.push(appChrome.actions.setControlLabel(Ma.value,
Ma.dK+" - "+Ma.description)),ma.push(appChrome.actions.setButtonCommandValueId(Ma.value,Ca)),appChrome.api.dispatch(ma)),Ca=this.AOi(Ma.type),Ca.us(Ma),ka.Aq(Ca))}else"Help"===Ea.GroupType&&Ea.Suggestions.length&&(sa?Array.contains(sa,8):1)?this.KYb&&(Ma=this.Cbf.FUa(fa,Ea.Suggestions))&&0<Ma.results.length&&ka.Aq(Ma):"Template"===Ea.GroupType&&(sa?Array.contains(sa,23):1)?(Ma=Ea.Suggestions)&&0<Ma.length&&this.Z8h.FUa(fa,ka,Ma):"Addin"===Ea.GroupType&&(sa?Array.contains(sa,27):1)?(Ma=Ea.Suggestions)&&
0<Ma.length&&this.NTh.FUa(fa,ka,Ma):"ActionAI"===Ea.GroupType&&(sa?Array.contains(sa,25):1)?(Ca=Ea.Suggestions,Ma=[],new x.a(25),Ca&&1===Ca.length&&(ma=Ca[0])&&ma.CommandId&&(Ca=ma.CommandId,Ma.push(new N.a(Ca,"Score"in ma?ma.Score:0)),Ma=M.CommandResultsUtility.f8b(fa,Ma,this.ub,null,null,null,25,0),Ma.displayName=CommonUIStrings.l_TellMeActionAIProviderTitle,ka.Aq(Ma))):"Substrate"===Ea.GroupType&&this.cQa&&"Type"in Ea?"File"===Ea.Type&&this.rGc&&(sa?Array.contains(sa,15):1)?(Ma=this.E6a.Q$d(Ea.Suggestions,
ja,this.oQa))&&0<Ma.results.length&&(this.q1c()&&(Ca=new v.a("GenerateSlidesFromTellMe",30,"",null,1),Ma.us(Ca)),ka.Aq(Ma)):"People"===Ea.Type&&this.IYb&&(sa?Array.contains(sa,14):1)?(Ma=this.E6a.k$f(Ea.Suggestions,ja,this.oQa))&&0<Ma.results.length&&ka.Aq(Ma):"Notes"===Ea.Type&&this.HYb&&(sa?Array.contains(sa,14):1)&&(Ma=this.E6a.F9f(Ea.Suggestions,ja,fa))&&0<Ma.results.length&&ka.Aq(Ma):"Recall"===Ea.GroupType&&this.ub.M3&&"Type"in Ea&&"IntentService"===Ea.Type&&(sa?Array.contains(sa,15):1)&&(Ma=
this.E6a.Q$d(Ea.Suggestions,ja,this.oQa))&&0<Ma.results.length&&(this.q1c()&&(Ca=new v.a("GenerateSlidesFromTellMe",30,"",null,1),Ma.us(Ca)),ka.Aq(Ma));else D.TellMeActor.instance.Jd.onError("OnSuccessCallBack","GroupType"in Ea?"Invalid group suggestions found for "+Ea.GroupType:"Invalid group found")}if(Z.Intents){Ea=Z.Intents;for(const oa of Ea)this.Aqe(oa)&&("Image"===oa.GroupType&&oa.ConfidenceScore>oa.ConfidenceThreshold&&(sa?Array.contains(sa,19):1)?this.$Zh.FUa(fa,ka,0,oa):"Commands"===oa.GroupType&&
oa.ConfidenceScore<oa.ConfidenceThreshold&&(sa?Array.contains(sa,17):1)&&(Ea=new x.a(17),ka.Aq(Ea)))}aa.resultsUpdated(ka);D.TellMeActor.instance.Jd.d6(fa.Cf.length,this.nOa.join(","),"",Math.round(window.performance.now()-I),"",!0,z.a.provider)}}hib(Z,fa,aa,ja,I){const sa=new B.a(fa);ja===this.wI&&(this.Hja(),D.TellMeActor.instance.Jd.d6(fa.Cf.length,this.nOa.join(","),Z.data.Ke.toString(),Math.round(window.performance.now()-I),S.a.tellMe,!1,z.a.xua));aa.resultsUpdated(sa)}Kyb(Z){switch(Z){case "Entity":return this.htf?
3:0;case "Definition":return this.qGc?5:0;case "WolframAnswer":return this.tGc?2:0;default:return 0}}WPf(Z,fa,aa){switch(Z){case "Answer":return new v.a(this.oGc?"AnswerForSearch":"AnswerForSearchSingleLine",0,""===fa.Title?aa:fa.Title,fa.Description,0);case "Entity":return new v.a(this.oGc?"AnswerForSearch":"AnswerForSearchSingleLine",2,""===fa.Title?aa:fa.Title,fa.Description,0);case "Definition":return new v.a(this.oGc?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===fa.Title?aa:fa.Title,fa.Description,
0);case "WolframAnswer":return new v.a("WolframForSearch",3,""===fa.Title?aa:fa.Title,fa.Description,0);default:return null}}AOi(Z){switch(Z){case 0:return new x.a(9,CommonUIStrings.l_TellMeAnswersTitle);case 2:return new x.a(11,CommonUIStrings.l_TellMeEntityTitle);case 1:return new x.a(10,CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new x.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new x.a(19,this.ub.yOb?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);
default:return null}}z5j(Z){return"Type"in Z&&!!Z.Type&&""!==Z.Type&&"Description"in Z&&!!Z.Description&&""!==Z.Description}C5j(Z){return"Type"in Z&&!!Z.Type&&""!==Z.Type&&"CommandId"in Z&&!!Z.CommandId&&""!==Z.CommandId&&"Score"in Z&&!!Z.Score}Aqe(Z){if("GroupType"in Z&&Z.GroupType&&"ConfidenceScore"in Z&&"ConfidenceThreshold"in Z)return!0;D.TellMeActor.instance.Jd.onError("IsValidIntentGroup","Invalid intents found");return!1}Cuj(Z){const fa=w.a.dsg(Z),aa={};aa.Query=Z;fa&&this.JYb&&(this.ZZj()?
aa.UserActionEvents=D.TellMeActor.instance.kvf:(aa.CommandClickedEvents=D.TellMeActor.instance.CCd,aa.CommandActionEvents=D.TellMeActor.instance.idf),aa.TellMeCommandClickMruEvents=D.TellMeActor.instance.Hnf,aa.ContentType=D.TellMeActor.instance.dPc);this.sGc&&(Z={},Z.Application=this.ub.application,aa.TemplateInfo=Z);return ca.c(aa)}Klb(){return!!this.ub&&this.ub.Klb||!!T.AFrameworkApplication.Aa&&T.AFrameworkApplication.Aa.ob.Klb}Llb(){return!!this.ub&&this.ub.Llb||!!T.AFrameworkApplication.Aa&&
T.AFrameworkApplication.Aa.ob.Llb}Mlb(){return!!this.ub&&this.ub.Mlb||!!T.AFrameworkApplication.Aa&&T.AFrameworkApplication.Aa.ob.Mlb}FOb(){return!!this.ub&&this.ub.FOb||!!T.AFrameworkApplication.Aa&&T.AFrameworkApplication.Aa.ob.FOb}EOb(){return!!this.ub&&(this.ub.EOb||this.ub.cI)}Ftl(){return!!this.ub&&!this.ub.pWa}Utl(){return!!this.ub&&this.ub.ycc}Etl(){return!!this.ub&&this.ub.hSj&&this.ub.eSj}Jtd(){return!!this.ub&&this.ub.Jtd}Fsg(){return!!T.AFrameworkApplication.fa&&T.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",
!1)}Gsg(){return!!T.AFrameworkApplication.fa&&T.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}ZZj(){return!!T.AFrameworkApplication.fa&&T.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewZeroSearchTermModel",!1)}q1c(){return!!T.AFrameworkApplication.fa&&T.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}vBh(){return!!T.AFrameworkApplication.fa&&
T.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FetchTellMeTokensAtBoot",!1)}mxj(){return T.AFrameworkApplication.fa?T.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.TellMeZeroTermModelName",""):""}Duj(){if(!T.AFrameworkApplication.fa)return"";if(this.Gsg())return T.AFrameworkApplication.fa.Ha("TellMeServiceProdEndpointForSearch");if(this.Fsg())return T.AFrameworkApplication.fa.Ha("TellMeServiceEdogEndpointForSearch");if(w.a.cne())return T.AFrameworkApplication.fa.Ha("TellMeServiceIntEndpointForSearch");
let Z=T.AFrameworkApplication.fa.Ha("TellMeServiceSearchEndpoint");Z&&""!==Z||(Z=T.AFrameworkApplication.YHh);return Z}static rQf(Z,fa){if(fa)return new da(Z,["Command","Recommended"],Z.Xgj);fa=w.a.J9()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin ActionAI".split(" "):"Help WolframAnswer File People Notes Template Addin ActionAI".split(" ");return new da(Z,fa,Z.obg)}}Object(K.a)(da,"TellMeServiceProvider",null,[750])},108:function(K,U,d){K=d(0);var h=d(16);class e{constructor(){this.userId=
this.email=this.displayName=null}}Object(K.a)(e,"InsertMentionParameters",null,[]);class r{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(K.a)(r,"InsightsParameters",null,[]);var m=d(1004),n=d(1005),z=d(1006),v=d(1007),x=d(27),B=d(341),D=d(451),w=d(36),J=d(55),G=d(47),M=d(126);d.d(U,"a",function(){return N});class N{static get CQj(){return"Insights_16x16x32"}static get M4i(){return"Find_16x16x32"}static get neh(){return"-Parameterized"}static get L2e(){return"Parameterized"}static get vxd(){return"bTryQuery"}static get Y7e(){return"TellMeSuggestion_"}static get cLh(){return"bTryQueryAlternate"}static get z5e(){return"MenuTellMe"}static get $Nk(){const R=
{},C=[];Array.add(C,{Term:{PeopleType:"Person"}});R.And=C;return R}static TPi(R){return R+N.neh}static getParameter(R){let C="",O="";if(R)for(let S=0;S<R.y_f;++S)"Type"===R.L$d(S)?C=R.eb(S):"Value"===R.L$d(S)&&(O=R.eb(S));return new h.a(C,O)}static q1d(R){R=Object.assign(new r,{neighborhood:R,mentionStart:0,mentionLength:R.length});return w.c(R)}static bQf(R,C,O){R=Object.assign(new e,{displayName:R,email:C,userId:O});return w.c(R)}static zDa(R,C,O=null){return w.c(N.sbg(R,C,O,null))}static sbg(R,
C,O=null,S=null){R=Object.assign(new D.a,{neighborhood:R,mentionStart:0,mentionLength:R?R.length:0});return Object.assign(new B.a,{selection:R,userIntent:S,entryPoint:C,launchData:O})}static vcl(R,C){return N.zDa(R,N.Qrh(C))}static Qrh(R){switch(R){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;case "GenerateDeckFromFile":return 38;default:return 0}}static yXj(){return!!x.AFrameworkApplication.fa&&x.AFrameworkApplication.fa.ka("IsGoLocalEnvironment")}static RBb(){const R=
x.AFrameworkApplication.fa?x.AFrameworkApplication.fa.Ha("SovereignEnvironmentName"):null;return!!R&&0<R.length}static isEnterpriseUser(){const R=x.AFrameworkApplication.fa?x.AFrameworkApplication.fa.Ha("HostAuthType"):null;return!!R&&"aad"===R.toLowerCase()||"external"===R&&N.cne()}static b1e(R){return R.OEl&&!N.RBb()}static C2j(){const R=x.AFrameworkApplication.fa?x.AFrameworkApplication.fa.Ha("UiHostIntegrationType"):"";return!!x.AFrameworkApplication.fa&&"UnifiedUiHostTeams"===R&&x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",
!1)}static a1e(R){return R.Uza&&R.G3i&&(R.xvc||R.vvc||R.qWa)&&!N.C2j()&&N.isEnterpriseUser()&&!N.RBb()}static J9(){return x.AFrameworkApplication.fa?x.AFrameworkApplication.yza||x.AFrameworkApplication.fa.ka("SmartLookupEnableNativePane"):x.AFrameworkApplication.yza}static $F(R){return!R||N.dsg(R.Cf)}static dsg(R){return!R||!R.trim().length}static dxd(R){if(!R)return 0;const C=Math.pow(10,5);return Math.round(R*C)/C}static AGl(){var R=new Date;return R?new Date(R.getUTCFullYear(),R.getUTCMonth(),
R.getUTCDate(),R.getUTCHours(),R.getUTCMinutes(),R.getUTCSeconds(),R.getUTCMilliseconds()):null}static Rde(R){return(N.AGl().getTime()-(new Date(R)).getTime())/1E3}static Csg(R){const {InsightsMenuItemFactory:C}=d(1003);switch(R){case m.a.lge:case n.a.W0f:case C.Kkg:case z.a.S5g:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "ActionAIFromTellMe":case "LaunchAddinDialogFromTellMe":case "GenerateSlidesFromTellMe":case "QuickActionOnFile":case "SummarizeDeckFromTellMe":case "SummarizeSlidesFromTellMe":return!0}return R.startsWith(N.vxd)||
R.startsWith(N.Y7e)||R.startsWith(N.cLh)||R.startsWith("PeopleSuggestion")||R.startsWith("FileSuggestion")||R.startsWith("FindInDocumentSuggestion")||R.startsWith("NotesSuggestion")||R.startsWith("OnenoteNotesSuggestion")||R.startsWith("SmartLookupFromTellMe")||R.startsWith("GetHelpFromTellMe")||R.startsWith("GetHelpWithDescriptionFromTellMe")||R.startsWith("AddinSuggestion")||R.startsWith("OfficeScripts")?!0:!1}static fae(R,C){const O=[];Array.add(O,new v.a(400,R));Array.add(O,new v.a(200,C));R=
{};R.parts=O;return JSON.stringify(R)}static GTa(R){const C=R.indexOf("<b0>"),O=R.lastIndexOf("</b0>"),S=[];Array.add(S,new v.a(400,R.substring(0,C)));Array.add(S,new v.a(600,R.substring(C+4,O)));Array.add(S,new v.a(400,R.substring(O+5,R.length)));R={};R.parts=S;return JSON.stringify(R)}static Ccg(R){const C=N.Rde(R);return 60>C?CommonUIStrings.l_TimeSince_SecsAgo:3600>C?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(C/60).toString()):86400>C?String.format(CommonUIStrings.l_TimeSince_HoursAgo,
Math.floor(C/3600).toString()):172800>C?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(R)).localeFormat("MMMM dd, yyyy"))}static Ycj(R){const C=Array(R.length);for(let O=0;O<R.length;O++)C[O]=R[O].commandId;return C}static cne(){if("Dev Box"===x.AFrameworkApplication.fa.Ha("StatusBarEnvironmentNameToUse"))return!0;let R=x.AFrameworkApplication.fa.Ha("UserPrincipalName");R=M.b(R)?"":G.a.rg(R);const C=x.AFrameworkApplication.fa.Lu("TellMeIntEnabledForFeatureCrew")?
x.AFrameworkApplication.fa.eA("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(C,R)&&"inner"===x.AFrameworkApplication.fa.Ha("Microsoft365Ring")}static Bij(R){switch(N.qVc(R)){case "PowerPoint":return"SaveAsPowerPointPptx_20";case "Word":return"SaveAsWordDocx_20";case "Excel":return"SaveAsExcelXlsx_20";case "Pdf":return"PdfFile_20";case "OneNote":return"OneNote_20";case "Visio":return"visio_20"}return""}static Osj(R){R=N.qVc(R);switch(R){case "PowerPoint":return"pptx";case "Word":return"docx";
case "Excel":return"xlsx";default:return R}}static qVc(R){switch(R.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"PowerPoint";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"Word";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"Excel";case "pdf":return"Pdf";case "one":case "onepkg":return"OneNote";
case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio"}return"Unknown"}static Ex(){return J.a.bU&&!J.a.ik}}N.Mwd=9E5;Object(K.a)(N,"TellMeUtils",null,[])},117:function(K,U,d){d.r(U);K=d(0);var h=d(1245),e=d(1246),r=d(7),m=d(19),n=d(1244),z=d(724),v=d(265);class x{constructor(mb,Ub,zc,Pc,Mc,ld){this.groupType=mb;this.resultType=Ub;this.o4e=zc;this.Sab=Pc;this.S3d=Mc;this.resultIndex=
ld}}Object(K.a)(x,"ClickLoggingInfo",null,[]);const B=mb=>{const Ub=[];for(;mb;)Array.add(Ub,"{ContextId:"+mb.contextId+", IsGraphNodeContext:"+mb.Pk+"}"),mb=mb.UE;Ub.reverse();return"{"+Ub.join(", ")+"}"};class D{constructor(){this.r9=this.sessionId=null}}Object(K.a)(D,"CorrelationRecord",null,[928]);var w=d(263);class J{constructor(mb,Ub){this.provider=mb;this.Ixd=Ub}}Object(K.a)(J,"ExternalResultProvider",null,[]);class G{constructor(mb,Ub){this.Id=null;this.TimeStamp=0;this.Id=mb;this.TimeStamp=
Ub}}Object(K.a)(G,"MRUControl",null,[]);var M=d(710),N=d(108),R=d(27),C=d(377);class O{constructor(mb,Ub){this.s2h=10;this.UV=[];this.ria=[];this.Yjf=this.Xjf=!1;this.LWb=this.KWb="";this.BDc=Ub;this.ub=mb}r7b(){!this.Xjf&&this.ub&&(this.KWb="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.ub.application,this.UV=this.A4f(),this.Xjf=!0);return this.UV}Moj(){!this.Yjf&&this.ub&&(this.LWb="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.ub.application,this.ria=this.A4f(!0),this.Yjf=!0);return this.ria}E4j(mb){return mb.startsWith("TellMeUpsell")||
"OpenInClientUpsell"===mb||"TryOfficeUpsell"===mb}Tme(mb){return this.ISj(mb)||this.E4j(mb)||N.a.Csg(mb)?!1:!0}ybi(mb){mb=mb.ControlId;this.Tme(mb)&&(mb=this.oVe(mb),this.y6k(mb),this.Etk(),Array.insert(this.UV,0,new G(mb,Date.now())),this.KWb.length&&(mb=JSON.stringify(this.UV),C.a.instance.setItem(this.KWb,mb)))}gz(mb){this.Dtk();Array.insert(this.ria,0,new G(M.a[mb],Date.now()));this.LWb.length&&(mb=JSON.stringify(this.ria),C.a.instance.setItem(this.LWb,mb))}A4f(mb=!1){if(!this.UV.length){var Ub=
mb?C.a.instance.getItem(this.LWb):C.a.instance.getItem(this.KWb);if(!Ub||""===Ub)return mb?this.ria:this.UV;let zc=null;try{zc=JSON.parse(Ub)}catch(Pc){this.LAi(mb),zc=null}if(!zc||!zc.length||10<zc.length)return mb?this.ria:this.UV;Ub=0;for(const Pc of zc)if(mb||this.ub.y3c(Pc.Id)&&this.Tme(Pc.Id))if(mb?Array.insert(this.ria,Ub++,Pc):Array.insert(this.UV,Ub++,Pc),Ub===this.BDc)break}return mb?this.ria:this.UV}u_d(mb){mb=this.oVe(mb);for(const Ub of this.UV)if(Ub.Id===mb)return!0;return!1}LAi(mb=
!1){C.a.instance.setItem(mb?this.LWb:this.KWb,"")}XUj(mb){mb=this.oVe(mb.ControlId);return this.Tme(mb)?this.u_d(mb):!1}y6k(mb){if(0<this.UV.length){let Ub=0;for(const zc of this.UV){if(zc.Id===mb){Array.removeAt(this.UV,Ub);break}Ub++}}}oVe(mb){return"Excel"===this.ub.application&&mb.startsWith("m_excelWebRenderer_ewaCtl_")?mb.substr(26,mb.length):mb}Etk(){this.UV.length===this.BDc&&Array.removeAt(this.UV,this.UV.length-1)}Dtk(){this.ria.length===this.s2h&&Array.removeAt(this.ria,this.ria.length-
1)}ISj(mb){mb=mb.split("|");let Ub="";if(6<=mb.length)Ub=mb[0];else if(3<=mb.length){if("3"===mb[0])return!0;Ub=mb[1]}return Ub.startsWith("WA")}static createInstance(mb){let Ub=3;R.AFrameworkApplication.fa&&(Ub=R.AFrameworkApplication.fa.wc("TellMeMaxRecommendedResultsToReturn",3));return new O(mb,Ub)}}Object(K.a)(O,"MruControlsManager",null,[927]);class S{constructor(mb){this.P5a=mb}oL(mb,Ub){let zc;return mb.dK&&(zc=this.P5a[mb.value])?zc.oL(mb,Ub):(zc=this.n5f(mb.value))?zc.oL(zc.Hwk,Ub):null}tnj(mb,
Ub){if(mb=this.P5a[mb])for(const zc of Ub)if(Ub=N.a.getParameter(zc),Ub.key===mb.cMk)return Ub.value;return null}Wyk(mb){(mb=this.n5f(mb))&&mb.Uyk()}n5f(mb){const Ub=mb.indexOf(N.a.neh);return 0<Ub?this.P5a[mb.substring(0,Ub)]:null}}Object(K.a)(S,"ParameterizedCommandManager",null,[926]);var T=d(303);class ca{constructor(mb,Ub){this.Cf=mb;this.b0a=Ub}}Object(K.a)(ca,"TellMeQuery",null,[]);var L=d(707);class da{constructor(mb,Ub){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=mb;this.TimeElapsedSinceClick=
Ub}}Object(K.a)(da,"CommandClickedEvent",null,[]);var Z=d(126);class fa{constructor(mb,Ub){this.z3h=mb;this.vca=Ub}resultsUpdated(mb){this.z3h(Z.b(mb.query)?"":mb.query.Cf,mb.Wk,mb.attributes,this.vca,mb.tBb)}}Object(K.a)(fa,"ResultsUpdatedCallback",null,[925]);class aa{constructor(mb,Ub,zc,Pc,Mc){this.CommandId=this.ControlId=null;this.TimeElapsedSinceClick=0;this.TerminalParentControlId=this.CommandSurface=null;this.ControlId=mb;this.TimeElapsedSinceClick=zc;this.CommandSurface=Pc;this.CommandId=
Ub;this.TerminalParentControlId=Mc}}Object(K.a)(aa,"UserActionEvent",null,[]);var ja=d(18);class I{constructor(mb,Ub){this.menuModel=mb;this.Prh=Ub}}Object(K.a)(I,"GeneratedMenuModel",null,[]);class sa{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=null}}Object(K.a)(sa,"MenuModel",null,[]);class ka{constructor(mb,Ub,zc){this.ub=mb;this.P5a=Ub;this.fCa=zc}g$i(mb,Ub,zc){const {TellMeActor:Pc}=d(117);let Mc=0;const ld=new sa,vb=[];let cc="";
ld.sections=[];let Hc=new ja.a;const Pb=!!this.ub&&this.ub.pWa;var Uc=!!this.ub&&this.ub.xOb||R.AFrameworkApplication.Aa.ob.xOb;for(const lb of mb){mb=0;Pb||(Hc=new ja.a);const Zb=new ja.a;let Oc=lb.displayName;for(const md of lb.results){if(0<=md.value.indexOf(N.a.L2e)){if(md.dK){var sc=this.P5a[md.value];if(sc&&md.value.endsWith(N.a.L2e)){if("FindParameterized"!==md.value&&!Uc){const Ib=[];Ib.push(appChrome.actions.setControlLabel(md.value,sc.Hjj(md)));Ib.push(appChrome.actions.setButtonCommandValueId(md.value,
sc.bdj(md)));appChrome.api.dispatch(Ib)}sc=md.value.replace(N.a.L2e,"");Hc.remove(sc)?mb--:Zb.add(sc);Hc.add(md.value);mb++}}}else switch(md.type){case 5:Zb.contains(md.value)||(Hc.add(md.value),mb++);break;case 7:Hc.add(md.dK);mb++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 25:case 26:case 6:case 19:case 20:case 21:case 27:case 29:case 28:case 30:case 31:Hc.add(md.value),mb++}13===lb.groupType&&(Oc=N.a.J9()?0<Ub.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,
Ub):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,Ub));21===lb.groupType&&(Oc=CommonUIStrings.l_LearningUILiveText)}Mc+=mb;""!==Oc&&0<mb&&(cc+=" , "+mb.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+Oc+" , ");0<Hc.count&&!Pb&&(mb=appChrome.api.menuSection(Hc.toArray(),lb.displayName,null,T.a[lb.groupType]),vb.push(mb))}Uc=null;0<Mc&&(Uc=0<Ub.length?1!==Mc?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,
Mc,Ub):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,Ub):1!==Mc?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,Mc):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,Pb?(Ub=appChrome.api.menuSection(Hc.toArray(),"",null,null),vb.push(Ub)):Uc+=cc);zc&&(this.ub.Yda?Pc.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(Uc)):appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(Uc)));ld.sections=
vb;return new I(ld,Mc,[])}static get U4d(){return ka.yff||(ka.yff=new I(Object.assign(new sa,{sections:[]}),0,[]))}}ka.yff=null;Object(K.a)(ka,"TellMeMenuDefintionGenerator",null,[]);var Ma;(function(mb){mb[mb.TellMeControlActivated=0]="TellMeControlActivated";mb[mb.TellMeQueryExecuted=1]="TellMeQueryExecuted";mb[mb.TellMeResultsRendered=2]="TellMeResultsRendered";mb[mb.TellMeControlDeactivated=3]="TellMeControlDeactivated"})(Ma||(Ma={}));Object(K.b)("PerformanceMarker",Ma);var Ea;(function(mb){mb[mb.TellMeTimeToRender=
0]="TellMeTimeToRender";mb[mb.TellMeSessionLength=1]="TellMeSessionLength";mb[mb.TellMeResultTriageTime=2]="TellMeResultTriageTime"})(Ea||(Ea={}));Object(K.b)("PerformanceMeasure",Ea);class ma{mark(mb){window.performance.mark(Ma[mb])}measure(mb,Ub,zc){const {TellMeActor:Pc}=d(117);try{window.performance.measure(Ea[mb],Ma[Ub],Ma[zc])}catch(Mc){Pc.instance.Jd.onError("TellMePerformance:Measure","error measuring "+Ea[mb])}}rse(mb,Ub,zc){const {TellMeActor:Pc}=d(117);Pc.instance.Jd.zse(Ub,zc,mb,this.Zkj(mb))}FRa(mb){for(const Ub of mb)window.performance.clearMarks(Ma[Ub])}clearMeasures(mb){for(const Ub of mb)window.performance.clearMeasures(Ea[Ub])}Zkj(mb){let Ub=
0;(mb=this.aaj(mb))&&0<mb.length&&(Ub=mb[mb.length-1].duration);return Ub}aaj(mb){return window.performance.getEntriesByName(Ea[mb],"measure")}}Object(K.a)(ma,"TellMePerformance",null,[]);var va=d(455),Ca=d(454),oa=d(36);class Da{constructor(mb){this.X8h=mb}eNe(mb,Ub,zc){const {TellMeActor:Pc}=d(117);Pc.instance.Jd.d6(Ub,Ca.a.SKb,mb.data.Ke.toString(),Math.round(window.performance.now()-zc),Ca.a.SKb,!0,va.a.xua);mb=oa.b(mb.data.ee);Ub=-1;mb.Index&&(Ub=mb.Index);Pc.instance.Jd.yck(Ub,this.X8h)}zmc(mb,
Ub,zc){const {TellMeActor:Pc}=d(117);Pc.instance.Jd.d6(Ub,Ca.a.SKb,mb.data.Ke.toString(),Math.round(window.performance.now()-zc),Ca.a.SKb,!1,va.a.xua)}Poj(mb){if(mb&&""!==mb.trim()){const zc=window.performance.now(),Pc=R.AFrameworkApplication.VHh;var Ub={};Ub.Text=mb;Ub.IsFileHash="false";Ub=oa.c(Ub);R.AFrameworkApplication.Me.zj(Pc,2,Ub,{"Content-Type":"application/json",Accept:"application/json"},!1,0,Mc=>{this.eNe(Mc,mb.length,zc)},Mc=>{this.zmc(Mc,mb.length,zc)},null,null,!1,4E3,6E3)}}}Object(K.a)(Da,
"TellMeQueryIndexCallback",null,[]);var ta=d(144);class ha{constructor(mb,Ub,zc){this.xml=mb;this.Prh=Ub;this.oVi=zc}}Object(K.a)(ha,"GeneratedMenuXml",null,[]);var Ha=d(1004),bb=d(47);class Na{constructor(mb,Ub){this.Bzc=mb||{};this.vBa=Ub}get ukb(){return 5}oL(mb,Ub=null){return this.vBa.oL(mb,Ub)||this.qri(mb.value)}qri(mb){return Na.pri(mb,this.Bzc[mb]||null)}static pri(mb,Ub=null){mb=String.format('<ClonedControl Id="{0}" ',mb);for(let Mc in Ub){var zc=Mc,Pc=Ub[Mc];Pc=Pc?bb.a.xe(Pc.toString()):
"";mb+=String.format('{0}="{1}" ',zc,Pc)}return mb+"/>"}}Object(K.a)(Na,"CommandMenuItemFactory",null,[794]);var Ia=d(131);class Qa{constructor(){this.yYh=CommonUIStrings.l_FindInDocumentText}get ukb(){return 8}oL(mb){var Ub=mb.dK;mb=bb.a.xe(mb.value);const zc=bb.a.xe(Ub);Ub=bb.a.xe(String.format(this.yYh,Ub));return this.y9i(mb,zc,Ub)}y9i(mb,Ub,zc){return Ia.a(mb,"1540292897",zc,N.a.M4i,null,Ub,zc,null,null)}}Object(K.a)(Qa,"FindInDocumentMenuItemFactory",null,[794]);var qa=d(1005),Wa=d(1003),Hb=
d(1006);class jc{get ukb(){return 7}oL(mb){const Ub=Object(n.a)(L.a,mb);return this.m$i(bb.a.xe(mb.value),Ub.id)}m$i(mb,Ub){return Ia.a(Ub,"1404166600",mb,null,null,mb,mb,null,null)}}Object(K.a)(jc,"TryQueryMenuItemFactory",null,[794]);class gc{constructor(mb){this.Fqa=[];this.ub=mb}Vgj(mb){for(const Ub of this.Fqa)if(Ub.ukb===mb)return Ub;return null}u0a(mb){this.Fqa.push(mb)}R2k(mb){this.u0a(new Na(this.ub.MHi,mb));this.u0a(new Hb.a(this.ub.hyk));this.u0a(new Ha.a(this.ub.Zfl,this.ub.Yfl,this.ub.ZEl,
this.ub.vIj,this.ub.zsl));this.u0a(new Wa.InsightsMenuItemFactory);this.u0a(new Qa);this.u0a(new qa.a);this.u0a(new jc)}}Object(K.a)(gc,"MenuItemFactoryRegistry",null,[]);var $b=d(160);class wb{constructor(mb,Ub){this.ub=mb;this.mnf=new gc(this.ub);this.mnf.R2k(Ub)}h$i(mb,Ub){let zc=0;const Pc=[],Mc=[];for(const vb of mb){mb=N.a.z5e;var ld=[];for(const cc of vb.results){const Hc=this.mnf.Vgj(cc.type).oL(cc,Ub);mb=N.a.z5e;ld.push(Hc);if(13===cc.type||14===cc.type)mb="Menu32";17===cc.type&&(mb="MenuTellMeExtended");
cc.groupType=vb.groupType;Mc.push(Object(n.a)($b.a,cc))}zc=zc?zc:ld.length;ld=Ia.c("TellMeDropdownControls",ld);mb=Ia.e("TellMeDropdownMenuSection",ld,mb,vb.displayName);Pc.push(mb)}Ub=Ia.f(Pc,"LookupDropdownMenu");return new ha(Ub,zc,Mc)}static get aRc(){return wb.zff||(wb.zff=new ha(Ia.f([],"LookupDropdownMenu"),0,[]))}}wb.zff=null;Object(K.a)(wb,"TellMeXmlGenerator",null,[]);class Db{}Db.dxk="MRU";Db.test="Test";Object(K.a)(Db,"ActionType",null,[]);var Xb=d(388),ab=d(1013),Ab=d(105);class rc{constructor(mb,
Ub,zc,Pc,Mc=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=this.SubResultType=this.ResultType=null;this.CommandId=mb;this.IsEnabled=Ub;this.ResultType=M.a[zc];this.SubResultType=ab.a[Pc];this.OptionalData=Mc?Ab.a.toJSON(Mc):null}}Object(K.a)(rc,"ResultInfo",null,[]);var tb=d(170),Za=d(142),fb=d(184);class ac{constructor(mb,Ub=null){this.Tif="TellMeWAC.";this.d4h=mb;this.A9h=Ub}mpa(mb,Ub,zc){Ub=tb.a.kz(Ub);mb=tb.a.E1d(mb,this.d4h,this.A9h,zc,Ub);Za.a.mpa(mb,this.Tif)}ALa(mb,Ub,zc=0){Ub=
tb.a.kz(Ub);Za.a.ALa(Object.assign(new fb.a,{name:mb,dataFields:Ub,durationMs:zc}),this.Tif)}}Object(K.a)(ac,"TellMeOtelLogger",null,[955]);var Dc=d(106);class Sc{constructor(mb,Ub,zc,Pc,Mc,ld,vb){this.VV=this.QZ=this.mdf=null;this.k7=mb;this.fTb=Ub;this.kra=zc;this.ROa=Pc;this.iBa=Mc;this.U0h=ld;this.VV=vb?vb:new ac(this.ROa?v.CuiHelper.K2e:v.CuiHelper.I5e)}get Pp(){return this.ROa}get Joa(){return this.kra}Fsd(mb){this.mdf=mb;switch(mb){case ta.a.contextMenu:this.QZ=ta.a.contextMenu;break;default:this.QZ=
ta.a.tellMe}}hpi(mb,Ub){this.kra.r9||(this.kra.r9=Dc.a.create().toString(),this.Uvg(mb,!0,Ub))}UWf(mb,Ub=!0){this.kra.r9&&this.Vak(mb,Ub);this.ROa&&appChrome.api.updateTellMeCorrelationId("");this.kra.r9=null}Uvg(mb,Ub,zc){const {TellMeActor:Pc}=d(117),Mc=this.EW(w.a.pAb);Mc[Xb.a.culture]=this.fTb;Mc[Xb.a.appName]=this.k7;Mc[Xb.a.context]=mb;Mc[Xb.a.L2c]=this.iBa;Mc[Xb.a.B4j]=this.U0h;Mc[Xb.a.g3j]=zc;Mc[Xb.a.wYj]=Ub;Mc[Xb.a.contentType]=Pc.instance.dPc;this.VV.mpa(w.a.pAb,Mc,this.mdf);this.ROa&&appChrome.api.updateTellMeCorrelationId(this.kra.r9)}Vak(mb,
Ub){const zc=this.EW(w.a.Rkg);zc[Xb.a.iXi]=mb;zc[Xb.a.vYj]=Ub;this.VV.ALa(w.a.Rkg,zc)}xck(mb,Ub,zc){let Pc=0;!zc&&0<mb.length&&(Pc=mb.trim().split(" ").length);const Mc=this.EW(w.a.query);Mc[Xb.a.query]="!";Mc[Xb.a.tjb]=Ub;Mc[Xb.a.ojh]=mb.length;Mc[Xb.a.wtg]=zc;Mc[Xb.a.tVl]=Pc;this.VV.mpa(w.a.query,Mc,this.QZ)}Sbk(mb,Ub,zc,Pc,Mc,ld,vb,cc=null){const Hc=this.EW(w.a.latency);Hc[Xb.a.culture]=this.fTb;Hc[Xb.a.ojh]=mb;Hc[Xb.a.LLh]=Ub;Hc[Xb.a.statusCode]=zc;Hc[Xb.a.sil]=Mc;Hc[Xb.a.isSuccess]=ld;Hc[Xb.a.F7j]=
vb;cc&&(Hc[Xb.a.TGl]=cc);this.VV.ALa(w.a.latency,Hc,Pc)}zse(mb,Ub,zc,Pc){const Mc=this.EW(w.a.performance);Mc[Xb.a.culture]=this.fTb;Mc[Xb.a.kpi]=Ma[mb];Mc[Xb.a.UYi]=Ma[Ub];Mc[Xb.a.iOk]=Ea[zc];this.VV.ALa(w.a.performance,Mc,Pc)}Hck(mb,Ub){var {TellMeActor:zc}=d(117);const {CommandResultsUtility:Pc}=d(343);if(mb.results.length){var Mc=this.EW(w.a.Sph);Mc[Xb.a.Sab]=Ub.toString();Mc[Xb.a.groupType]=T.a[mb.groupType];16===mb.groupType&&(Mc[Xb.a.K2j]=zc.instance.nxc);Ub=[];zc=[];var ld=[];for(const vb of mb.results)Mc[Xb.a.resultType]||
(Mc[Xb.a.resultType]=M.a[vb.type]),mb={},27===vb.type&&(mb.AssetId=vb.MTd),zc.push(Pc.Cac(vb.value)),Ub.push(vb.value),ld.push(new rc(vb.value,Pc.Cac(vb.value),vb.type,vb.subType,mb));0<Ub.length&&(Mc[Xb.a.xcl]="{"+Ub.join(", ")+"}",Mc[Xb.a.tYi]="{"+zc.join(", ")+"}",Mc[Xb.a.tcl]=oa.c(ld));this.VV.mpa(w.a.Sph,Mc,this.QZ)}}C$i(mb,Ub){if(4===mb)return Db.dxk;switch(Ub){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return M.a[Ub]}zak(mb,
Ub,zc,Pc,Mc){const ld=this.EW(w.a.click);ld[Xb.a.LLh]=mb;ld[Xb.a.eMk]=Ub;ld[Xb.a.commandId]=zc;ld[Xb.a.dDa]=Pc;ld[Xb.a.actionType]=this.C$i(Mc.groupType,Mc.resultType);ld[Xb.a.resultType]=M.a[Mc.resultType];ld[Xb.a.o4e]=ab.a[Mc.o4e];ld[Xb.a.groupType]=T.a[Mc.groupType];ld[Xb.a.Sab]=Mc.Sab.toString();ld[Xb.a.S3d]=Mc.S3d.toString();ld[Xb.a.resultIndex]=Mc.resultIndex.toString();this.VV.mpa(w.a.click,ld,this.QZ)}Dak(mb,Ub){this.kra.r9||(this.kra.r9=Dc.a.create().toString(),this.Uvg("",!1,Ub));Ub=this.EW(w.a.rNf);
Ub[Xb.a.tjb]=mb;this.VV.ALa(w.a.rNf,Ub)}cwg(mb,Ub,zc){if(mb){if(zc)for(let Pc in zc)mb[Pc]=zc[Pc];this.VV.ALa(w.a.events,mb,Ub)}}MGa(mb,Ub,zc=null){const Pc=this.EW(w.a.events);Pc[Xb.a.event]=mb;this.cwg(Pc,Math.round(Ub),zc)}ydc(mb,Ub,zc=null){const Pc=this.EW(w.a.events);Pc[Xb.a.event]=w.a.error;Pc[Xb.a.module]=mb;Pc[Xb.a.errorMessage]=Ub;Pc[Xb.a.message]=Ub;this.cwg(Pc,Math.round(window.performance.now()),zc)}xak(mb){const Ub=this.EW(w.a.ILf);Ub[Xb.a.value]=mb;Ub[Xb.a.jod]=this.ROa;this.VV.mpa(w.a.ILf,
Ub,this.QZ)}W$j(mb){const Ub=this.EW(w.a.owf);Ub[Xb.a.value]=mb;Ub[Xb.a.jod]=this.ROa;this.VV.mpa(w.a.owf,Ub,this.QZ)}ibk(mb){const Ub=this.EW(w.a.N_f);Ub[Xb.a.value]=mb;Ub[Xb.a.jod]=this.ROa;this.VV.mpa(w.a.N_f,Ub,this.QZ)}wck(mb){const Ub=this.EW(w.a.Wih);Ub[Xb.a.value]=mb;Ub[Xb.a.jod]=this.ROa;this.VV.mpa(w.a.Wih,Ub,this.QZ)}kak(mb){const Ub=this.EW(w.a.Jvh);Ub[Xb.a.value]=mb;this.VV.mpa(w.a.Jvh,Ub,this.QZ)}zck(mb,Ub){const zc=this.EW(w.a.mjh);zc[Xb.a.SKb]=mb;Ub&&(zc[Xb.a.r9]=Ub);this.VV.ALa(w.a.mjh,
zc)}EW(mb){return{["SessionID"]:this.kra.sessionId,["CorrelationID"]:this.kra.r9,["Time"]:(new Date).getTime(),["Event"]:mb,["Scenario"]:this.QZ}}}Object(K.a)(Sc,"UsageLogger",null,[924]);var xb=d(95);class Ta{}Ta.Callback="action";Object(K.a)(Ta,"MenuLauncherAsyncTriggerCommandProperties",null,[]);var ib=d(543),ob=d(300),fc=d(82),Jb=d(139),xc=d(495),ic=d(249),nc=d(55),Wb=d(269),wc=d(73),nb=d(37);d.d(U,"TellMeActor",function(){return Rb});class Rb{constructor(){this.vBa=this.GS=this.Pd=this.Oa=this.h7=
this.FG=this.Zd=this.Ca=this.Jd=this.aE=this.RJd=this.Zvf=this.U7=this.ub=null;this.jqb=!1;this.CCd=[];this.idf=[];this.kvf=[];this.Hnf=[];this.Inf=[];this.Dkf=!1;this.Iob=this.fCa=null;this.zVb=this.iBa=!1;this.NDc=!0;this.bQ=this.NBc=this.rhf=this.bKd=this.Bnf=null;this.s2=[];this.dOa=this.$ob=this.Pha=this.jFc=this.ltf=null;this.Qpb=!1;this.WJd=0;this.Aob=null;this.vca=-1;this.nnf=0;this.IVb=!1;this.nOa=null;this.hvf=!1;this.Bob=this.QS=null}get dPc(){return this.h7?this.h7.contentType:Rb.unknown}get actions(){return this.s2}set actions(mb){this.s2=
mb}wXc(){return this.Jd?this.Jd.Joa.r9:null}hH(){return this.ub}get zwk(){return this.NDc}get kUl(){return this.Bnf}performance(){return this.aE}get F2e(){return this.ltf}set F2e(mb){this.ltf=mb}get nxc(){return this.hvf}set nxc(mb){this.hvf=mb}BG(mb){const Ub=window.performance.now();this.fCa&&!Z.b(mb)&&(this.fCa(mb),this.Jd.OH(w.a.BG,window.performance.now()-Ub))}initialize(mb,Ub=null,zc=null,Pc=null,Mc=null,ld=null,vb=null,cc=null,Hc=null,Pb=null,Uc=null){const {InteractionLogger:sc}=d(1187),{GroupsPlacementInfo:lb}=
d(1184),{AggregatorResultsProvider:Zb}=d(1030);this.ub=mb;this.iBa=!!R.AFrameworkApplication.Aa&&R.AFrameworkApplication.Aa.ob.LBb;this.Jd=Pc;if(!Pc){Pc=new D;Pc.sessionId=R.AFrameworkApplication.userSessionId;const Oc=Wb.a.He(R.AFrameworkApplication.lcid)||Wb.a.gac;this.Jd=new sc(new Sc(this.ub.application,Oc.name,Pc,this.ub.Pp,this.iBa,mb.Uza,null),this.ub.NHi,this.ub)}this.vBa=new S(this.ub.parameterData);this.Zvf=zc||new wb(this.ub,this.vBa);this.fCa=vb;this.RJd=this.RJd||new ka(this.ub,this.ub.parameterData,
vb);this.Pd=xb.FocusManager.instance();this.GS=O.createInstance(this.ub);this.rhf=new lb(mb);this.Ca=Mc||R.AFrameworkApplication.Ra;this.Zd=ld||R.AFrameworkApplication.Ae;this.FG=Hc;this.U7=Ub;this.QS=Uc;this.aE=new ma;this.Bob=new h.a(e.a.Ml());this.jFc=[];Hc?Hc.execute(Oc=>{Oc.isFeatureEnabled(Rb.NEl,!0).then(md=>{const {AggregatorResultsProvider:Ib}=d(1030);this.IVb=md;this.U7=this.U7||Ib.createInstance(this.GS,this.ub,this.vBa,this.IVb);for(const ud of this.jFc)this.U7.gz(ud.provider,ud.Ixd);
this.jFc=[];return null})}):(this.IVb=!0,this.U7=this.U7||Zb.createInstance(this.GS,this.ub,this.vBa,this.IVb));this.Oa=cc;this.Pha=wb.aRc;this.Bnf=new Promise(Oc=>{this.bKd=Oc});Pb&&Pb.execute(Oc=>{this.h7=Oc})}vb(){this.kei()}kei(){this.Ca.ra(nb.a.tellMe,wc.a.frame,Object(r.a)(this,this.tellMe,"tellMe"),96);this.Ca.ra(nb.a.y5e,wc.a.frame,Object(r.a)(this,this.cHf,"cacheAsyncMenuRefreshFunction"),96);this.Ca.ra(nb.a.C5e,wc.a.frame,Object(r.a)(this,this.owg,"logItemExecuted"),96);this.Ca.ra(nb.a.F5e,
wc.a.frame,Object(r.a)(this,this.Zvg,"logControlDeactivation"),96);this.Ca.ra(nb.a.E5e,wc.a.frame,Object(r.a)(this,this.kwg,"logInputFocus"),96);this.Ca.ra(nb.a.B5e,wc.a.frame,Object(r.a)(this,this.pAb,"interactionBegin"),96);this.Ca.ra(nb.a.H5e,wc.a.frame,Object(r.a)(this,this.pAb,"interactionBegin"),96);this.Ca.ra(nb.a.D5e,wc.a.frame,Object(r.a)(this,this.jwg,"logInputBlur"),96);this.Ca.ra(nb.a.G5e,wc.a.frame,Object(r.a)(this,this.Yvg,"logControlActivated"),96);this.Ca.ra(nb.a.wvc,wc.a.frame,Object(r.a)(this,
this.K1f,"focusSearchBox"),96);this.Ca.ra(nb.a.x5e,wc.a.frame,Object(r.a)(this,this.LMf,"constructLiveNotificationForMenu"),96);this.Ca.ra(nb.a.J5e,wc.a.frame,Object(r.a)(this,this.Cle,"insertTryQuery"),96);this.Ca.ra(nb.a.Cre,wc.a.frame,Object(r.a)(this,this.Cle,"insertTryQuery"),96);this.Ca.ra(nb.a.d7d,wc.a.frame,Object(r.a)(this,this.Wxa,"openOrInsertUrl"),96);this.Ca.ra(nb.a.e7d,wc.a.frame,Object(r.a)(this,this.Wxa,"openOrInsertUrl"),96);this.Ca.ra(nb.a.f7d,wc.a.frame,Object(r.a)(this,this.Wxa,
"openOrInsertUrl"),96);this.Ca.ra(nb.a.g7d,wc.a.frame,Object(r.a)(this,this.Wxa,"openOrInsertUrl"),96);this.Ca.ra(nb.a.h7d,wc.a.frame,Object(r.a)(this,this.Wxa,"openOrInsertUrl"),96);this.Ca.ra(nb.a.tNe,wc.a.frame,Object(r.a)(this,this.Wxa,"openOrInsertUrl"),96);this.Ca.ra(nb.a.uNe,wc.a.frame,Object(r.a)(this,this.Wxa,"openOrInsertUrl"),96);this.Ca.ra(nb.a.vNe,wc.a.frame,Object(r.a)(this,this.Wxa,"openOrInsertUrl"),96);this.Ca.ra(nb.a.BOe,wc.a.frame,Object(r.a)(this,this.Q$b,"insertMention"),96);
this.Ca.ra(nb.a.COe,wc.a.frame,Object(r.a)(this,this.Q$b,"insertMention"),96);this.Ca.ra(nb.a.DOe,wc.a.frame,Object(r.a)(this,this.Q$b,"insertMention"),96);this.Ca.ra(nb.a.A5e,wc.a.frame,Object(r.a)(this,this.Hch,"openFeedback"),96);this.Ca.ra(nb.a.K5e,wc.a.frame,Object(r.a)(this,this.Wxa,"openOrInsertUrl"),96);this.Ca.ra(nb.a.ITd,wc.a.frame,Object(r.a)(this,this.qCb,"launchAddin"),96);this.Ca.ra(nb.a.JTd,wc.a.frame,Object(r.a)(this,this.qCb,"launchAddin"),96);this.Ca.ra(nb.a.KTd,wc.a.frame,Object(r.a)(this,
this.qCb,"launchAddin"),96);this.Ca.ra(nb.a.Tlb,wc.a.frame,Object(r.a)(this,this.Tlb,"showTellMeCoachmark"),96);this.Ca.ra(nb.a.ure,wc.a.frame,Object(r.a)(this,this.zug,"launchAddinStore"),96);this.Ca.ra(nb.a.hTe,wc.a.frame,Object(r.a)(this,this.Ojh,"quickActionOnFileHandler"),96);this.Ca.ra(nb.a.W8d,wc.a.frame,Object(r.a)(this,this.q3f,"generateSlidesFromFiles"),96)}q2k(mb){this.NDc=!1;const Ub=window.performance.now();mb.IGa.isCompleted?(this.NDc=!0,this.bKd(!0)):mb.kW(()=>{this.NDc=!0;this.bKd(!0);
this.Jd.OH(w.a.KSi,window.performance.now()-Ub)});this.W2k(mb)}W2k(mb){ic.a.zod(Object(r.a)(this,this.bVi,"dispatcher"));ic.a.s5b([new xc.a(nb.a.tellMe,wc.a.frame,96),new xc.a(nb.a.y5e,wc.a.frame,96),new xc.a(nb.a.C5e,wc.a.frame,96),new xc.a(nb.a.F5e,wc.a.frame,96),new xc.a(nb.a.E5e,wc.a.frame,96),new xc.a(nb.a.B5e,wc.a.frame,96),new xc.a(nb.a.H5e,wc.a.frame,96),new xc.a(nb.a.D5e,wc.a.frame,96),new xc.a(nb.a.G5e,wc.a.frame,96),new xc.a(nb.a.wvc,wc.a.frame,96),new xc.a(nb.a.x5e,wc.a.frame,96),new xc.a(nb.a.J5e,
wc.a.frame,96),new xc.a(nb.a.Cre,wc.a.frame,96),new xc.a(nb.a.d7d,wc.a.frame,96),new xc.a(nb.a.e7d,wc.a.frame,96),new xc.a(nb.a.f7d,wc.a.frame,96),new xc.a(nb.a.g7d,wc.a.frame,96),new xc.a(nb.a.h7d,wc.a.frame,96),new xc.a(nb.a.tNe,wc.a.frame,96),new xc.a(nb.a.uNe,wc.a.frame,96),new xc.a(nb.a.vNe,wc.a.frame,96),new xc.a(nb.a.BOe,wc.a.frame,96),new xc.a(nb.a.COe,wc.a.frame,96),new xc.a(nb.a.DOe,wc.a.frame,96),new xc.a(nb.a.A5e,wc.a.frame,96),new xc.a(nb.a.K5e,wc.a.frame,96),new xc.a(nb.a.ITd,wc.a.frame,
96),new xc.a(nb.a.JTd,wc.a.frame,96),new xc.a(nb.a.KTd,wc.a.frame,96),new xc.a(nb.a.Tlb,wc.a.frame,96),new xc.a(nb.a.ure,wc.a.frame,96),new xc.a(nb.a.hTe,wc.a.frame,96),new xc.a(nb.a.W8d,wc.a.frame,96)],mb)}bVi(mb,Ub,zc,Pc,Mc){if(Ub.contextId===wc.a.frame)switch(mb){case nb.a.tellMe:return this.tellMe(mb,Ub,zc,Pc,Mc);case nb.a.y5e:return this.cHf(mb,Ub,zc,Pc,Mc);case nb.a.C5e:return this.owg(mb,Ub,zc,Pc,Mc);case nb.a.F5e:return this.Zvg(mb,Ub,zc,Pc,Mc);case nb.a.E5e:return this.kwg(mb,Ub,zc,Pc,Mc);
case nb.a.B5e:return this.pAb(mb,Ub,zc,Pc,Mc);case nb.a.H5e:return this.restoreFocus(mb,Ub,zc,Pc,Mc);case nb.a.D5e:return this.jwg(mb,Ub,zc,Pc,Mc);case nb.a.G5e:return this.Yvg(mb,Ub,zc,Pc,Mc);case nb.a.wvc:return this.K1f(mb,Ub,zc,Pc,Mc);case nb.a.x5e:return this.LMf(mb,Ub,zc,Pc,Mc);case nb.a.J5e:case nb.a.Cre:return this.Cle(mb,Ub,zc,Pc,Mc);case nb.a.d7d:case nb.a.e7d:case nb.a.f7d:case nb.a.g7d:case nb.a.h7d:case nb.a.tNe:case nb.a.uNe:case nb.a.vNe:case nb.a.K5e:return this.Wxa(mb,Ub,zc,Pc,Mc);
case nb.a.BOe:case nb.a.COe:case nb.a.DOe:return this.Q$b(mb,Ub,zc,Pc,Mc);case nb.a.A5e:return this.Hch(mb,Ub,zc,Pc,Mc);case nb.a.ITd:case nb.a.JTd:case nb.a.KTd:return this.qCb(mb,Ub,zc,Pc,Mc);case nb.a.Tlb:return this.Tlb(mb,Ub,zc,Pc,Mc);case nb.a.ure:return this.zug(mb,Ub,zc,Pc,Mc);case nb.a.hTe:return this.Ojh(mb,Ub,zc,Pc,Mc);case nb.a.W8d:return this.q3f(mb,Ub,zc,Pc,Mc)}return 2}K1f(mb,Ub,zc){if(1===zc)return 32;this.ryh();mb=!1;(this.ub.Uza||this.iBa)&&(Ub=document.getElementById("SearchButton"))&&
Ub.click();if(!this.ub.Uza&&this.iBa)for(Ub=document.getElementsByClassName("ms-suiteux-search-box"),zc=0;zc<Ub.length;zc++){const Pc=Ub[zc].querySelector("input[type=search]");Pc&&(mb=xb.FocusManager.Zq(Pc))}else mb=xb.FocusManager.Zq($get(this.ub.Pp?v.CuiHelper.K2e:v.CuiHelper.I5e));this.zVb=!0;return mb?32:8}Cle(mb,Ub,zc,Pc,Mc){if(1===zc)return 32;if(Z.b(Mc))return this.Jd.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.ryh();mb=Mc.CommandValueId;Ub=this.ub.Pp?v.CuiHelper.K2e:
v.CuiHelper.I5e;this.ub.Pp&&!Z.b(Mc[ib.a.dba])&&(Mc[ib.a.dba]=!1);if(mb){if(this.ub.Pp)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(mb)),this.nOa=[19],32;if(Mc=$get(Ub))Mc.value=mb}return xb.FocusManager.Zq($get(Ub))?32:8}ryh(){this.Pd.XU(this.ub.Uza||this.iBa?this.ub.SYc:this.ub.uLa,!1)}x$i(mb,Ub){switch(mb){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,Ub);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,
Ub);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,Ub);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,Ub)}return Ub}LMf(mb,Ub,zc,Pc,Mc){if(1===zc)return 32;if(Z.b(Mc))return this.Jd.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;mb=this.Pha?this.Pha.Prh:0;Mc.Value=1!==mb?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,mb):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;
if(this.Pha)for(const ld of this.Pha.oVi)Mc=Object(m.a)(L.a,ld)?ld.id:bb.a.replaceAll(ld.value,'"',""),(Mc=$get(Mc+"-"+N.a.z5e))&&Jb.a.bS(Mc,Jb.a.er,bb.a.xe(this.x$i(ld.groupType,Mc.innerText)));return 32}cHf(mb,Ub,zc,Pc,Mc){if(1===zc)return 32;if(Z.b(Mc))return this.Jd.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.Aob=new fc.a(2,1,0,()=>{Mc[Ta.Callback]()},97);this.Pha&&this.Zd.Hb(this.Aob);return 32}owg(mb,Ub,zc,Pc,Mc){if(1===zc)return 32;if(Z.b(Mc))return this.Jd.onError("TellMeActor:LogItemExecuted",
"actiondata comes null"),16;Mc.CloseAllMenus&&(mb=void 0===Mc.ParentControlId||null===Mc.ParentControlId?"<NA>":Mc.ParentControlId,Ub=this.Iob?this.Iob[Mc.ControlId]:null,!Ub&&this.Iob&&"<NA>"!==mb&&(Ub=this.Iob[mb]),Ub||(Ub=this.jqb&&this.GS.XUj(Mc),Ub=this.FTi(Ub,Mc.ControlId),Ub=new x(Ub,32,4,-1,-1,-1),this.Jd.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+Mc.ControlId+" determined group:"+T.a[Ub.groupType])),this.Jd.MBk(Mc.ControlId,mb,Mc.CommandId,Mc.CloseAllMenus,Ub),this.vBa.Wyk(Mc.ControlId),
Mc.Location!==ta.a.contextMenu&&(this.GS.ybi(Mc),this.GS.gz(Ub.resultType),this.ub.Ktd&&this.U7.Ici(Mc.CommandId)));return 32}Zvg(mb,Ub,zc,Pc,Mc){if(1===zc)return 32;(new Da(this.wXc())).Poj(this.$ob);mb=this.$ob;Ub=this.vca;zc=this.Jd.Szc;if(Z.b(Mc))return this.Jd.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;Mc=Mc.UILocation;mb&&0<mb.length&&this.IVb&&N.a.b1e(this.ub)&&this.ub.j3c&&19!==Mc&&Ub>zc&&!this.ub.cI&&(this.Jd.Cse(mb),this.Jd.GZe(Ub));this.Jd.Yal();this.ub.Tyd&&
19!==Mc&&(this.aE.mark(3),this.aE.measure(1,0,3),this.aE.measure(2,2,3),this.aE.rse(0,1,2),this.aE.rse(2,2,3),this.aE.rse(1,0,3),this.aE.FRa([0,1,2,3]),this.aE.clearMeasures([0,2,1]));this.Jd.YBk(window.performance.now()-this.WJd);this.ub.Pp&&(this.dOa=null,this.Jd.Z9g());this.zVb=this.Qpb=!1;this.$ob="";return 32}kwg(mb,Ub,zc){if(1===zc)return 32;this.Jd.$9g(B(Ub),this.zVb);return 32}jwg(mb,Ub,zc){if(1===zc)return 32;this.Jd.Z9g();this.Qpb=!1;return 32}Yvg(mb,Ub,zc,Pc,Mc){if(1===zc)return 32;this.bQ=
null;Mc&&(this.bQ=Mc);this.ub.Tyd&&(Z.b(this.bQ)||this.bQ.Location!==ta.a.contextMenu)&&this.aE.mark(0);this.Jd.Fsd(Z.b(this.bQ)||Z.b(this.bQ.Location)?ta.a.unknown:this.bQ.Location);this.Jd.XBk(this.nnf,this.zVb);this.Qpb||this.Fmc();return 32}VOf(mb,Ub){const zc=[],Pc=Date.now();for(let Mc of mb)mb=(Pc-Mc.timeStamp)/1E3,mb=N.a.dxd(mb),Array.add(zc,new da(Ub?Mc.commandId:Mc.controlId,mb));return zc}SPi(mb){const Ub=[],zc=Date.now();for(let Pc of mb)if(Pc.controlId||"keyboardShortcut"===Pc.commandSurface)mb=
(zc-Pc.timeStamp)/1E3,mb=N.a.dxd(mb),Array.add(Ub,new aa(Pc.controlId,Pc.commandId,mb,Pc.commandSurface,Pc.awd));return Ub}tPf(mb=!1){var Ub=mb?this.GS.Moj():this.GS.r7b();mb=[];const zc=Date.now();for(const Pc of Ub)Ub=(zc-Pc.TimeStamp)/1E3,Ub=N.a.dxd(Ub),Array.add(mb,new da(Pc.Id,Ub));return mb}Fmc(){if(!this.Qpb){this.jqb=this.Qpb=!0;""!==this.ub.Auh&&R.AFrameworkApplication.uk(this.ub.Auh);if(!this.Dkf){this.Dkf=!0;const mb={};mb.IsMLREnabled=this.ub.NZj;mb.IsReactRibbonEnabled=this.ub.Pp;mb.IsSharedHeaderEnabled=
!!R.AFrameworkApplication.Aa&&R.AFrameworkApplication.Aa.ob.mO;mb.IsSearchUxEnabled=this.iBa;mb.IsTellMeInHeaderEnabled=this.ub.Uza;mb.IsGoLocalEnv=N.a.yXj();mb.IsSovereignEnvironment=N.a.RBb();mb.IsTellMeServiceResultsEnabled=N.a.b1e(this.ub);mb.IsSubstrateProviderEnabled=N.a.a1e(this.ub);mb.ShouldFetchTokens=!!R.AFrameworkApplication.Aa&&R.AFrameworkApplication.Aa.ob.wOb;mb.IsSerpletEnabled=N.a.J9();mb.FirstOnClickTimeInMS=Math.round(window.performance.now());mb.IsHeaderHidden=R.AFrameworkApplication.hideHeader||
R.AFrameworkApplication.NT;mb.IsSearchInHeaderHidden=R.AFrameworkApplication.bZc;void 0!==window.performance.timing&&null!==window.performance.timing&&(mb.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));mb.IsFindWithMatchesEnabled=this.ub.b0f;mb.HelpShowsTopSearchResult=this.ub.Htc;mb.HelpShowsNumberOfMatches=this.ub.Gtc;R.AFrameworkApplication.fa&&(mb.UiHost=R.AFrameworkApplication.fa.Ha("UiHostIntegrationType"));this.Jd.Sck(JSON.stringify(mb))}this.CCd=this.VOf(z.a.instance.aTb,
!1);this.idf=this.VOf(z.a.instance.Q3a,!0);this.kvf=this.SPi(z.a.instance.Q3a);this.Hnf=this.tPf();this.Inf=this.tPf(!0);this.Jd.Fmc()}}pAb(mb,Ub,zc,Pc,Mc){if(1===zc)return 32;if(Z.b(Mc))return this.Jd.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(nc.a.iX)return 32;this.WJd=window.performance.now();this.Fmc();mb=new fa(Object(r.a)(this,this.hga,"onRequestCompleted"),0);this.vca++;this.Jd.beginQuery("",this.vca,this.jqb);this.g9e(!0,null);this.Pha=wb.aRc;this.dOa=ka.U4d;if(this.U7)Rb.instance.actions=
[],this.U7.FB(new ca("",this.vca),mb,this.ub.Pp);else this.Jd.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.Aob&&this.Zd.Hb(this.Aob);return 32}restoreFocus(mb,Ub,zc){if(1===zc)return 32;this.Pd.q1(this.ub.Uza||this.iBa?this.ub.SYc:this.ub.uLa,!1);return 32}tellMe(mb,Ub,zc,Pc,Mc){if(1===zc)return 32;if(Z.b(Mc))return this.Jd.onError("TellMeActor:TellMe","actiondata comes null"),16;this.bQ=Mc;this.Jd.Fsd(Z.b(this.bQ.Location)?ta.a.unknown:this.bQ.Location);mb=
this.bQ.Value;this.ub.Pp||mb&&""!==mb.trim()?(!this.dOa&&this.ub.Pp&&(this.Jd.$9g(B(Ub),this.zVb),this.Fmc()),this.Q0i(mb,this.bQ.Location),this.bQ.PopulationXML=this.Pha.xml):this.jqb?this.bQ.PopulationXML=this.Pha.xml:(this.bQ.PopulationXML=wb.aRc.xml,this.dOa=ka.U4d,this.$ob="");return 32}Q0i(mb,Ub){this.WJd=window.performance.now();this.ub.Tyd&&Ub!==ta.a.contextMenu&&this.aE.mark(1);this.ub.Pp&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(mb));mb&&0<mb.trim().length&&(this.jqb=
!1);this.ub.F_i();Ub=Z.b(Ub)?ta.a.tellMe:Ub;if(mb!==this.$ob||this.ub.Pp){this.vca++;this.Jd.beginQuery(mb,this.vca,this.jqb);this.g9e(!0,null);const zc=new ca(mb,this.vca),Pc=new fa(Object(r.a)(this,this.hga,"onRequestCompleted"),this.vca);this.Pha=wb.aRc;this.dOa=ka.U4d;if(this.U7)Rb.instance.actions=[],this.U7.FB(zc,Pc,this.ub.Pp,Ub,this.nOa),this.nOa=null;else this.Jd.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.nnf=this.vca;this.$ob=mb}}NOl(mb){if(this.ub.Pp){var Ub=
appChrome.selectors.getActiveControlStates();if(Ub=Object(n.a)(Object,Ub[mb.value])){mb.label=Ub.label;let zc=null;"description"in Ub&&(zc=Ub.description);zc&&Object.getType(zc)===String?mb.description=zc:"secondaryText"in Ub?mb.description=Ub.secondaryText:"fullDescriptionLabel"in Ub&&(mb.description=Ub.fullDescriptionLabel)}}}tPk(mb){this.Iob={};let Ub=0,zc=0;for(const Pc of mb){mb=0;for(const Mc of Pc.results)this.Iob[Mc.value]=new x(Mc.groupType,Mc.type,Mc.subType,Ub,mb,zc),mb++,zc++,Mc.label||
5!==Mc.type||this.NOl(Mc);0<mb&&Ub++}}sJb(mb,Ub,zc,Pc,Mc){if(1===zc)return 32;if(Z.b(Mc))return this.Jd.onError("TellMeActor:OpenUrlInNewTab","actiondata comes null"),16;(mb=Mc.CommandValueId)&&window.open(mb,"_blank");return 32}Lug(mb){const Ub={};Ub.token=this.F2e;Ub.files=oa.c(mb);Ub.type="MultiFilesDeckGeneration";if(R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFastCards",!1))return this.Ca.Ka(nb.a.Dug,2,Ub),!0;mb=N.a.sbg("",N.a.Qrh("GenerateDeckFromFile"),
Object.assign(new ob.a,{landingTab:"All",data:Ub}));mb=this.Ca.Ka(nb.a.Y_c,2,mb);return 32!==mb?(this.Jd.onError("LaunchSmartLookupWithFilesData","CommonCommands.InvokeSerplet failed. Response: "+mb+"."),!1):!0}Ojh(mb,Ub,zc,Pc,Mc){if(1===zc)return 32;if(Z.b(Mc))return this.Jd.onError("TellMeActor:QuickActionOnFileHandler","actiondata comes null"),16;this.Pd.F1f();if(mb=Mc.TerminalParentControlId){mb=this.Bob.ga(mb);if(!mb)return 16;Ub=[];Array.add(Ub,mb);if(!this.Lug(Ub))return 8}return 32}q3f(){if(!this.Bob.count)return 16;
const mb=[];for(let Ub of this.Bob.values)Array.add(mb,Ub);return this.Lug(mb)?32:8}Q$b(mb,Ub,zc,Pc,Mc){if(1===zc)return 32;if(Z.b(Mc))return this.Jd.onError("TellMeActor:InsertMention","actiondata comes null"),16;mb=Mc.UILocation;let ld;Mc=Mc.CommandValueId;try{ld=oa.a(Mc)}catch(vb){return this.Jd.onError("TellMeActor:InsertMention","commandValueId is not in proper format"),16}return Z.b(ld)?(this.Jd.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):Z.b(this.NBc)?(this.Jd.onError("TellMeActor:InsertMention",
"_iInsertContentHandler comes null"),16):19!==mb?(this.Jd.onError("TellMeActor:InsertMention","location "+mb+" is unexpected"),16):this.NBc.Q$b(ld.displayName,ld.email,ld.userId)?32:(this.Jd.onError("TellMeActor:InsertMention","mention is not inserted"),16)}Wxa(mb,Ub,zc,Pc,Mc){return 1===zc?32:Z.b(Mc)?(this.Jd.onError("TellMeActor:OpenOrInsertUrl","actiondata comes null"),16):19===Mc.UILocation?this.wQj(zc,Mc):this.sJb(mb,Ub,zc,Pc,Mc)}Hch(mb,Ub,zc,Pc,Mc){if(1===zc)return 32;if(Z.b(Mc))return this.Jd.onError("TellMeActor:OpenFeedback",
"actiondata comes null"),16;this.QS&&window.setTimeout(()=>{this.QS.execute(ld=>{ld.Ulb("TellMeSurvey",null)})},Rb.f3i);return 32}wQj(mb,Ub){if(1===mb)return 32;if(Z.b(Ub))return this.Jd.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(Z.b(this.NBc))return this.Jd.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),16;mb=Ub.CommandValueId;return Z.b(mb)?(this.Jd.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.NBc.insertHtmlText(mb)?32:(this.Jd.onError("TellMeActor:InsertUrl",
"url is not inserted"),16)}hga(mb,Ub,zc,Pc,Mc){zc=window.performance.now();this.tPk(Ub);this.Jd.Rll(Ub);this.ub.Pp?(this.dOa=this.RJd.g$i(Ub,mb,Mc),this.ub.Yda?(this.s2.push(appChrome.actions.updateTellMeSearchResults(this.dOa.menuModel,mb,Mc)),appChrome.api.dispatch(this.s2)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.dOa.menuModel,mb,Mc)),this.ub.Tyd&&this.Qpb&&(Z.b(this.bQ)||this.bQ.Location!==ta.a.contextMenu)&&(this.aE.mark(2),this.aE.measure(0,1,2))):this.Pha=this.Zvf.h$i(Ub,
this.Jd.Joa);this.Aob&&this.Zd.Hb(this.Aob);Mc={};Mc.GroupsCount=Ub.length;Mc.QueryID=Pc;Mc.QueryLength=mb.length;this.Jd.OH(w.a.SNi,window.performance.now()-zc,Mc)}FTi(mb,Ub){return Ub.startsWith(this.ub.Pp?N.a.Y7e:N.a.vxd)?5:mb?4:"bSearchHelp"===Ub||Ub.startsWith("GetHelpFromTellMe")?8:"bInsights"===Ub||Ub.startsWith("SmartLookupFromTellMe")?13:"ActionAIFromTellMe"===Ub?24:Ub===this.ub.a0f?2:0}gz(mb,Ub){this.U7?this.U7.gz(mb,Ub):Array.add(this.jFc,new J(mb,Ub))}zug(mb,Ub,zc,Pc,Mc){if(1===zc)return 32;
if(Z.b(Mc))return this.Jd.onError("TellMeActor:LaunchAddinStore","actiondata comes null"),16;if(this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",!1)){mb={};mb.SourceControlId=Mc.SourceControlId;mb.Query=Mc.CommandValueId;Mc=this.Ca.Ka(nb.a.vre,2,mb);if(32!==Mc)this.Jd.onError("TellMeActor:LaunchAddinStore","CommonCommands.LaunchAppforOfficeDialog failed. Response: "+Mc+".");return Mc}return this.Ca.Ka(nb.a.vre,2,Mc)}qCb(mb,Ub,zc,Pc,Mc){({AddinResultsProvider:mb}=
d(721));if(1===zc)return 32;if(Z.b(Mc))return this.Jd.onError("TellMeActor:LaunchAddin","actiondata comes null"),16;zc=Mc.CommandValueId;if(Z.a(zc))return this.Jd.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),16;if(!mb.C7a[zc])return this.Jd.onError("TellMeActor:LaunchAddin","Add-in with assetId "+zc+" doesn't not exist in entitlements"),16;Mc=d(721).AddinResultsProvider.C7a[zc];mb={};mb.solutionId=Mc.id;mb.version=Mc.appVersion;mb.storeType=Mc.storeType;mb.storeId=Mc.storeId;mb.assetId=
Mc.assetId;mb.assetStoreId=Mc.assetStoreId;mb.displayName=Mc.displayName;mb.targetType=Mc.targetType;mb.height=Mc.height;mb.width=Mc.width;Mc=this.Ca.Ka(nb.a.zkg,2,mb);if(32!==Mc)this.Jd.onError("TellMeActor:LaunchAddin","CommonCommands.InsertOfficeAddin failed. Response: "+Mc+". AssetId: "+zc);return Mc}Tlb(){if(!Z.b(this.QS))for(let mb of z.a.instance.Q3a){if("ShowContextMenuWithFloatie"===mb.commandId)return this.QS.execute(Ub=>{Ub.logActivity("TellMe1TabSwitchCoachMarkActivity",null)}),32;if(mb.commandId&&
-1===mb.commandId.indexOf("Tab"))break}return 8}g9e(mb,Ub="",zc=null){mb?this.Bob=new h.a(e.a.Ml()):Ub&&zc&&this.Bob.add(Ub,zc)}static get instance(){return Rb.La||(Rb.La=new Rb)}}Rb.La=null;Rb.NEl="mso_tellMeService";Rb.unknown="Unknown";Rb.f3i=500;Object(K.a)(Rb,"TellMeActor",null,[])},1173:function(K,U,d){d.r(U);d.d(U,"SurfaceStringTokenStringGenerator",function(){return e});K=d(0);var h=d(554);class e extends h.a{constructor(r){super(r);this.Ja=r}apply(r,m,n,z,v,x,B){null==x&&(x=r.Icg(v,m));B=
h.a.Fyf(r,x,this.Ja.score,n,z,B);return{iwc:x,$0b:B}}}e.a1b=0;Object(K.a)(e,"SurfaceStringTokenStringGenerator",h.a,[])},1174:function(K,U,d){d.r(U);d.d(U,"QueryTokenStringGenerator",function(){return r});K=d(0);var h=d(554),e=d(80);class r extends h.a{constructor(m){super(m);this.Ja=m}apply(m,n,z,v,x,B,D){n=this.Ja.query.load(n,null);x=0;let w=null;this.Ja.query.cV===e.Annotations.mha?n&&(w=this.Ja.name):((w=this.Ja.name)&&(w+="_"),w+=this.Ja.annotations.o2(this.Ja.query.cV,n));null!=w&&(x=h.a.Fyf(m,
w,this.Ja.score,z,v,x));return{iwc:B,$0b:D+x}}}r.a1b=1;Object(K.a)(r,"QueryTokenStringGenerator",h.a,[])},1175:function(K,U,d){d.r(U);d.d(U,"FuzzyMatchTokenStringGenerator",function(){return e});K=d(0);var h=d(554);class e extends h.a{constructor(r){super(r);this.Ja=r}apply(r,m,n,z,v,x,B){null==x&&(x=r.Icg(v,m));r=this.Ja.kYf.Ldk(x);if(this.Ja.Bch)for(var D of r)if(!D.dH&&D.YSc)return{iwc:x,$0b:B};D=0;for(const w of r)if(w.dH&&!({YWd:D}=this.LCf(w,!0,n,z,D)).returnValue)return{iwc:x,$0b:B};if(this.Ja.gjg)for(const w of r)if(!({YWd:D}=
this.LCf(w,!1,n,z,D)).returnValue)break;return{iwc:x,$0b:B}}LCf(r,m,n,z,v){let x;m?(m=0,x=r.YSc?1:0):(m=r.YSc?1:0,x=r.count-m);for(let B=0;B<x;++B)if(h.a.Gyf(r.oTa+m+B,this.Ja.score,n,z),++v,0<this.Ja.rIe&&v>=this.Ja.rIe)return{returnValue:!1,YWd:v};return{returnValue:!0,YWd:v}}}e.a1b=2;Object(K.a)(e,"FuzzyMatchTokenStringGenerator",h.a,[])},1184:function(K,U,d){d.r(U);K=d(0);var h=d(303),e=d(18),r=d(16),m=d(1244),n=d(176);class z{constructor(N,R,C,O=0){this.oeg=N;this.groupType=R;this.Mee=O;this.Frc=
C}}Object(K.a)(z,"SortingGroup",null,[]);class v{constructor(N,R,C,O){this.order=N;this.Sab=R;this.Iyj=C;this.groupType=O}}Object(K.a)(v,"SortingProp",null,[]);var x=d(117),B=d(144),D=d(108),w=d(126);class J{constructor(N,R){this.CXg={};this.BXg={};this.CWg=this.n2g=1;this.LFf(N,R)}szl(N,R,C){var O=D.a.$F(C)?this.CXg:this.BXg;C=new e.a;for(var S of R)R=Object(m.a)(v,O[h.a[S.groupType].toLowerCase()]),w.b(R)||C.add(new r.a(R,S));C.Sc((ca,L)=>ca.key.order<L.key.order?-1:1);Array.clear(N);S=x.TellMeActor.instance.bQ;
for(R=0;R<C.count;){O=C.ga(R).key.Sab;var T=C.ga(R).value;const ca=new n.a(C.ga(R).key.groupType);w.b(S)||S.Location===B.a.contextMenu||(ca.displayName=C.ga(R).key.Iyj);for(const L of T.results)ca.us(L);for(T=++R;T<C.count&&C.ga(T).key.Sab===O;)this.ySd(ca,C.ga(T).value),T=++R;N.push(ca)}}wQl(N,R){this.CWg=this.n2g=1;this.LFf(N,R)}LFf(N,R){this.eEh(N);for(var C=0;C<N.length;C++){let O=N[C];for(const S of O.Frc)this.kci(S,C,O.oeg,O.groupType)}this.eEh(R);for(N=0;N<R.length;N++){C=R[N];for(const O of C.Frc)this.jci(O,
N,C.oeg,C.groupType)}}eEh(N){N.sort((R,C)=>Object(m.a)(z,R).Mee>Object(m.a)(z,C).Mee?-1:1)}kci(N,R,C,O){this.CXg[h.a[N].toLowerCase()]=new v(this.n2g++,R,C,O)}jci(N,R,C,O){this.BXg[h.a[N].toLowerCase()]=new v(this.CWg++,R,C,O)}ySd(N,R){for(let C=0;C<R.results.length;C++)N.us(R.results[C])}}Object(K.a)(J,"BaseGroupingSorter",null,[]);class G{constructor(){this.Afd=[new z("",26,[26]),new z("",24,[24]),new z(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,4,[4,2]),new z(CommonUIStrings.l_TellMeCommandProviderTitle,
7,[18,16,7]),new z(CommonUIStrings.l_TellMeSuggestionsProviderTitle,33,[15,14,19,3]),new z("",13,[13]),new z("",22,[22])];this.mcd=[new z("",25,[25]),new z(CommonUIStrings.l_TellMeCommandProviderTitle,31,[17,0,1,8,28]),new z(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,32,[2,19,23,29]),new z(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,33,[15,14,20,9,12,10,11,27]),new z("",13,[13]),new z("",22,[22])];this.fFg=new J(this.Afd,this.mcd)}wuc(N,R,C,O=null,S=null){let T=!1;if(O){for(const ca of D.a.$F(C)?
this.Afd:this.mcd)this.i_k(ca,O);T=!0}if(S){for(const ca of D.a.$F(C)?this.Afd:this.mcd)this.xQl(R,ca,S);T=!0}T&&this.fFg.wQl(this.Afd,this.mcd);this.fFg.szl(N,R,C)}i_k(N,R){const C=new e.a;for(var O of N.Frc){const S=R[h.a[O].toLowerCase()];C.add(new r.a(w.b(S)?Number.MAX_VALUE:S,O))}if(C.count){C.Sc((S,T)=>S.key<T.key?-1:1);R=Array(C.count);for(O=0;O<C.count;O++)R[O]=C.ga(O).value;N.Frc=R}}xQl(N,R,C){let O=0;for(const S of R.Frc)if(h.a[S].toLowerCase()in C&&C[h.a[S].toLowerCase()])for(const T of N)if(T.groupType===
S){O+=C[h.a[S].toLowerCase()];break}R.Mee=O}}Object(K.a)(G,"SimplifiedGroupingSorter",null,[]);d.d(U,"GroupsPlacementInfo",function(){return M});class M{constructor(N){this.AXg={};this.yXg={};this.zXg={};this.DXg={};this.pFe={};this.aYg=this.gsk=this.iqk=this.Gqk=1;this.sZg=null;this.Lq=N;this.Usi();this.UPk();this.Qsi();this.Tri();N.cI&&(this.sZg=new G)}fz(N){this.AXg[h.a[N].toLowerCase()]=this.Gqk++}iB(N,R){this.yXg[h.a[N].toLowerCase()]=R}Vra(N){this.zXg[h.a[N].toLowerCase()]=this.iqk++}ZS(N){this.DXg[h.a[N].toLowerCase()]=
this.gsk++}gy(N){this.pFe[h.a[N].toLowerCase()]=this.aYg++}Usi(){const N=!!this.Lq&&this.Lq.pWa,R=!!this.Lq&&this.Lq.snc,C=!!this.Lq&&this.Lq.qWa,O=!!this.Lq&&this.Lq.pqe&&!D.a.RBb(),S=!!this.Lq&&this.Lq.ycc,T=!!this.Lq&&this.Lq.f0c,ca=!!this.Lq&&this.Lq.Goe,L=!!this.Lq&&this.Lq.fme;this.Lq&&(this.Lq.M3||this.Lq.gRc)&&this.fz(26);L&&this.fz(24);this.fz(4);this.fz(18);this.fz(16);this.fz(7);this.fz(17);this.fz(0);this.fz(1);ca&&this.fz(28);S&&this.fz(23);N||this.fz(2);N&&!R||this.fz(8);this.fz(15);
C&&this.fz(20);this.fz(14);this.fz(9);this.fz(12);this.fz(10);this.fz(11);N&&this.fz(2);N&&!R&&this.fz(8);this.fz(19);T&&this.fz(27);this.fz(21);this.fz(13);O&&this.fz(22);this.fz(30)}UPk(){this.iB(21,1);this.iB(4,3);this.iB(18,3);this.iB(16,3);this.iB(7,3);this.iB(17,5);this.iB(0,5);this.iB(1,1);this.iB(28,2);this.iB(2,1);this.iB(8,2);this.iB(15,3);this.iB(14,2);this.iB(27,3);this.iB(9,1);this.iB(12,1);this.iB(10,1);this.iB(11,1);this.iB(19,1);this.iB(23,1);this.iB(13,1);this.iB(24,1);this.iB(25,
1);this.iB(20,2);this.iB(22,1);this.iB(26,1)}Qsi(){this.Vra(4);this.Vra(0);this.Vra(17);this.Vra(7);this.Vra(16);this.Vra(18);this.Vra(15);this.Vra(20);this.Vra(8);this.Vra(14)}Tri(){this.ZS(14);this.ZS(10);this.ZS(12);this.ZS(9);this.ZS(11);this.ZS(20);this.ZS(15);this.ZS(8);this.ZS(2);this.ZS(1);this.ZS(27);this.ZS(7);this.ZS(18);this.ZS(16);this.ZS(17);this.ZS(0);this.ZS(4)}gbl(){this.pFe={};this.aYg=1}kqj(N,R,C){this.gbl();const O=!!this.Lq&&this.Lq.pWa,S=!!this.Lq&&this.Lq.snc,T=!!this.Lq&&this.Lq.qWa,
ca=!!this.Lq&&this.Lq.pqe&&!D.a.RBb(),L=!!this.Lq&&this.Lq.ycc,da=!!this.Lq&&this.Lq.f0c,Z=!!this.Lq&&this.Lq.Goe,fa=!!this.Lq&&this.Lq.Jtd;N=N&&S;fa&&this.gy(25);this.gy(4);this.gy(18);this.gy(16);this.gy(7);this.gy(17);this.gy(0);this.gy(1);Z&&this.gy(28);L&&this.gy(23);O&&!S||!N||this.gy(8);R&&this.gy(15);O||this.gy(2);da&&this.gy(27);C&&this.gy(14);O&&!S||N||this.gy(8);R||this.gy(15);T&&this.gy(20);C||this.gy(14);this.gy(9);this.gy(12);this.gy(10);this.gy(11);O&&this.gy(2);O&&!S&&this.gy(8);this.gy(19);
this.gy(21);this.gy(13);ca&&this.gy(22);return this.pFe}hH(){return this.Lq}}Object(K.a)(M,"GroupsPlacementInfo",null,[])},1187:function(K,U,d){d.r(U);K=d(0);var h=d(724),e=d(455),r=d(303),m=d(1076),n=d(454);class z{constructor(M="",N="",R="",C=-99999,O=-1,S=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=M?M:"";this.Description=N?N:"";this.Type=R?R:"";this.Score=C;this.Age=O;this.Count=S}}Object(K.a)(z,"Suggestion",null,[]);class v{constructor(M,N){this.GroupType=
this.Suggestions=null;this.Suggestions=M;this.GroupType=N}}Object(K.a)(v,"SuggestionGroup",null,[]);class x{}x.help="help";x.answer="answer";x.commands="commands";x.til="servicecommands";x.aIh="template";Object(K.a)(x,"SuggestionGroupType",null,[]);var B=d(117),D=d(108),w=d(27),J=d(36);d.d(U,"InteractionLogger",function(){return G});class G{constructor(M,N,R){this.XDd=0;this.OPd=this.fWb=null;this.Jj=M;this.MOd=this.QCd=this.xGd=!1;this.tWh=N;this.hi=w.AFrameworkApplication.Me;this.ub=R;this.Szc=
this.GLd=0}get Joa(){return this.Jj.Joa}Fsd(M){this.Jj.Fsd(M)}ywg(){if(this.fWb){var M=0;for(const N of this.fWb)this.Jj.Hck(N,M++);this.fWb=null}}beginQuery(M,N,R){this.Jj.xck(M,N,R)}$9g(M,N){this.Jj.hpi(M,N);this.xGd=!0;this.MOd=!1}Z9g(){this.xGd=!1;this.QCd||(this.ywg(),this.Jj.UWf(this.XDd))}yck(M,N){this.Jj.zck(M,N)}MBk(M,N,R,C,O){for(const S of this.tWh)if(M.startsWith(S)){this.MOd=!0;break}this.Jj.zak(M,N,R,C,O)}YBk(M){this.QCd=!1;this.XDd=M;this.xGd||this.MOd||(this.ywg(),this.Jj.UWf(this.XDd,
!1))}XBk(M,N){this.Jj.Dak(M,N);this.QCd=!0}R8d(M,N){if(!M.count)return"";let R="";const C=Date.now();for(let O of M)M=(C-O.timeStamp)/1E3,M=D.a.dxd(M),0<R.length&&(R+=";"),R+=N?O.commandId:O.controlId,R+=":",R+=M.toString();return R}Fmc(){var M=this.R8d(h.a.instance.aTb,!1);0<M.length&&this.Jj.xak(M);M=this.R8d(h.a.instance.Q3a,!0);0<M.length&&this.Jj.W$j(M);M=this.R8d(h.a.instance.VAc,!0);0<M.length&&this.Jj.ibk(M);M=B.TellMeActor.instance.Inf;0<M.length&&this.Jj.wck(J.c(M))}Sck(M){this.Jj.kak(M)}d6(M,
N,R,C,O,S,T,ca=null){this.Jj.Sbk(M,N,R,C,O,S,T,ca)}zse(M,N,R,C){this.Jj.zse(M,N,R,C)}OH(M,N,R=null){this.Jj.MGa(M,N,R)}onError(M,N,R=null){this.Jj.ydc(M,N,R)}Rll(M){this.fWb=M}Rtj(M){const N=[];if(!M)return N;for(let R=0;R<M.length;R++){const C=r.a[M[R].groupType].toLowerCase(),O=[],S=M[R].results;if(S){for(let T=0;T<S.length;T++)"findindocument"===C?Array.add(O,new z("","",C,S[T].score,S[T].HJc,S[T].count)):Array.add(O,new z(S[T].label,S[T].description,C,S[T].score,S[T].HJc,S[T].count));"answer"===
C||"definition"===C||"wolframanswer"===C||"entity"===C?Array.add(N,new v(O,x.answer)):"classifier"===C||"appsforoffice"===C?Array.add(N,new v(O,x.commands)):"serviceclassifier"===C?Array.add(N,new v(O,x.til)):"assistance"===C?Array.add(N,new v(O,x.help)):("document"===C||"people"===C||"findindocument"===C||"notes"===C||"image"===C||"template"===C)&&Array.add(N,new v(O,C))}}return N}pde(M,N){const R={};R.Query=N;R.SuggestionGroups=J.c(this.Rtj(M));return J.c(R)}mcg(M){const N={"Content-Type":"application/json",
Accept:"application/json"};N["X-Office-Version"]=w.AFrameworkApplication.buildVersion;N["X-Office-Application"]=w.AFrameworkApplication.fa.Ha("Application");N["X-Office-Platform"]="WAC";N["X-TellMe-SqmUserId"]=w.AFrameworkApplication.fa.Ha("LoggableUserId")||"";N["X-TellMe-SessionId"]=this.Jj.Joa.r9;N["X-TellMe-SuggestionTypes"]="Ranker";N["X-TellMe-Culture"]=w.AFrameworkApplication.uiCulture;N["X-TellMe-ProcessSessionId"]=w.AFrameworkApplication.userSessionId;N["X-TellMe-Flights"]=M;N["X-TellMe-PartialQueryIndex"]=
this.GLd;return N}vib(M,N,R){this.d6(N.length,"RankerLogging",M.data.Ke.toString(),Math.round(window.performance.now()-R),n.a.XHh,!0,e.a.xua)}hib(M,N,R){this.d6(N.length,"RankerLogging",M.data.Ke.toString(),Math.round(window.performance.now()-R),n.a.XHh,!1,e.a.xua)}ncg(){this.OPd||(this.OPd=new m.a(this.ub,null,6E3));return this.OPd.CAa}Cse(M){const N=this.pde(this.fWb,M),R=this.mcg("RankerLogging"),C=window.performance.now();this.hi.zj(this.ncg(),2,N,R,!1,0,O=>{this.vib(O,M,C)},O=>{this.hib(O,M,
C)},null,null,!1,4E3,6E3);this.GLd++}Yal(){this.GLd=0}GZe(M){this.Szc=M}}Object(K.a)(G,"InteractionLogger",null,[])},1291:function(K,U,d){d.r(U);var h=d(0),e=d(27),r=d(71),m=d(392),n=d(947),z=d(95),v=d(56),x=d(1243),B=d(7),D=d(1282),w=d(93),J=d(67),G=d(177),M=d(973),N=d(79);class R{static get sg(){return N.a.VC(R.Fo,Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}R.Fo="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";
Object(h.a)(R,"InsertSymbolsDialogHtml",null,[]);var C=d(35),O=d(219);class S extends D.a{constructor(La,sb,Ob){super();this.Clf=this.Ara=this.hQa=null;this.FGd=0;this.Ca=La;this.Pd=sb;this.YBa=Ob;this.Oe(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Oe(0,CommonUIStrings.l_DialogClose);this.RV=!1;this.sg=R.sg;this.kg="InsertSymbolsDialog"}dispose(){0<S.uQd&&m.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",this.FGd,S.uQd);S.qef++;
m.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",S.qef);this.Ca=this.YBa=null;super.dispose()}Nga(){this.pj(Box4Intl.Box4Strings.L_SymbolSingle,Object(B.a)(this,this.rQj,"insertSymbolsDialogHandler"),null);this.FGd=0;S.vef++;m.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",S.vef);const La=this.tde("symbol_d_"+S.cWb);La&&La.focus()}hide(){var La=document.getElementById("symbolsContainer");if(La&&(La=La.getElementsByTagName("a")))for(let sb=0;sb<
La.length;sb++)w.a.removeHandler(La[sb],J.a.focus,Object(B.a)(this,this.CGh,"symbolFocusHandler"));super.hide()}rQj(La){1===La?(this.kMe("symbol_d_"+S.cWb),this.Pd.XU(this.xL,!0),this.Pd.Ll().Dj.mF(this.SD),this.SD.focus()):this.hide()}get oCb(){return S.Ylf}set oCb(La){S.Ylf=La}get kCb(){return S.Klf}set kCb(La){S.Klf=La}Jxa(){super.Jxa();var La=document.getElementById("symbolsContainer");if(La&&(M.a.qsd(La,this.YBa.Rri(),"InsertSymbolsDialog"),La=La.getElementsByTagName("a")))for(let sb=0;sb<La.length;sb++)w.a.addHandler(La[sb],
J.a.focus,Object(B.a)(this,this.CGh,"symbolFocusHandler"))}r8(){const La=document.getElementById("symbolsContainer");La&&(this.hQa||(this.hQa=Object(B.a)(this,this.bDl,"symbolClickHandler"),this.Hn.rb(J.a.click,La,this.hQa),this.Hn.rb(J.a.doubleClick,La,this.hQa)),this.Ara||(this.Ara=Object(B.a)(this,this.dDl,"symbolKeyHandler"),this.Wg.rb(J.a.Bf,La,this.Ara),this.Wg.rb(J.a.uy,La,this.Ara),this.Wg.rb(J.a.Tl,La,this.Ara)));super.r8()}Ysa(){const La=document.getElementById("symbolsContainer");La&&(this.hQa&&
(this.Hn.Bb(J.a.click,La,this.hQa),this.Hn.Bb(J.a.doubleClick,La,this.hQa),this.hQa=null),this.Ara&&(this.Wg.Bb(J.a.Bf,La,this.Ara),this.Wg.Bb(J.a.uy,La,this.Ara),this.Wg.Bb(J.a.Tl,La,this.Ara),this.Ara=null));super.Ysa()}kHk(La){this.syh("symbol_d_"+S.cWb,!1);S.cWb=parseInt(La.substr(La.lastIndexOf("_")+1));this.syh(La,!0);if(La=document.getElementById("SymbolNameValueLabel")){const sb=this.rXc(S.cWb);La.innerText=sb.altText}}rXc(La){const sb=this.YBa.Zuc.Avd.value,Ob=O.a(sb);return sb[Ob[La]]}CGh(La){if(La.target!==
this.Clf){const sb=this.Pd.Ll();sb&&sb.Dj&&(sb.Dj.mF(La.target),this.Clf=La.target)}this.kHk(La.target.id)}bDl(La){const sb=La.Bc;if("a"!==sb.tagName.toLowerCase())return!1;La.eventName===J.a.doubleClick&&this.kMe(sb.id);this.Pd.XU(this.xL,!0);this.Pd.Ll().Dj.mF(sb);sb.focus();return!0}dDl(La){var sb=La.Bc;if("a"!==sb.tagName.toLowerCase())return!1;const Ob=parseInt(sb.id.substr(sb.id.lastIndexOf("_")+1));if(La.mc.ctrlKey||La.mc.altKey||La.mc.keyCode>=G.a.Rnb&&La.mc.keyCode<=G.a.uAa)return!1;if(La.eventName===
J.a.Bf){La=La.mc.keyCode;let pc=-1;La===Sys.UI.Key.enter?(this.kMe(sb.id),this.Pd.XU(this.xL,!0),this.Pd.Ll().Dj.mF(sb),sb.focus()):La===Sys.UI.Key.up?pc=Ob-15:La===Sys.UI.Key.down?pc=Ob+15:La===Sys.UI.Key.left?pc=e.AFrameworkApplication.isRtl?Ob+1:Ob-1:La===Sys.UI.Key.right&&(pc=e.AFrameworkApplication.isRtl?Ob-1:Ob+1);0<=pc&&(sb=this.tde("symbol_d_"+pc))&&sb.focus()}return!0}kMe(La){this.FGd++;S.uQd++;La=parseInt(La.substr(La.lastIndexOf("_")+1));const sb=this.rXc(La),Ob={};Ob.SourceControlId="symbol_"+
La+"_"+sb.zvd;this.Ca.Ka(C.a.sVa,2,Ob);m.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",La)}tde(La){const sb=document.getElementById("symbolsContainer");return sb?sb.querySelector("#"+La):null}syh(La,sb){(La=this.tde(La))&&(sb?La.setAttribute("selected","true"):La.removeAttribute("selected"))}}S.cWb=0;S.Ylf=null;S.Klf=null;S.vef=0;S.qef=0;S.uQd=0;Object(h.a)(S,"InsertSymbolsDialog",D.a,[]);var T=d(44),ca=d(53),L=d(40),da=d(186),Z=d(109);class fa{constructor(La,sb,
Ob,pc,Kc,Gd,he,Ue){this.Ca=La;this.SK=sb;this.r8h=new x.a(Object(B.a)(this,this.buj,"getSymbolsDropDownMenuProps"));this.s8h=new x.a(Object(B.a)(this,this.ude,"getSymbolsDropDownXml"));this.zPd=pc.Zuc.Avd;this.Lk=Ob;this.YBa=pc;this.ZD=Kc;this.GP=Gd;this.Uc=he;this.Sm=Ue}buj(){return this.YBa.Fsi()}ude(){return this.YBa.build()}vb(){this.Ca.ra(C.a.Nmd,L.a.application,Object(B.a)(this,this.Nmd,"queryInsertSymbols"),96);this.Ca.ya(C.a.Vib,L.a.view,Object(B.a)(this,this.Vib,"populateSymbolsDropDown"));
this.Ca.ya(C.a.Bvd,L.a.view,Object(B.a)(this,this.DGh,"symbolsDropDownOpenHandler"));this.Ca.ya(C.a.DSe,L.a.view,Object(B.a)(this,this.Kjh,"querySymbolPositionHandler"));this.Ca.ya(C.a.sVa,L.a.view,Object(B.a)(this,this.KFa,"insertSymbolViewHandler"));this.Ca.ya(C.a.Vib,L.a.Mf,Object(B.a)(this,this.Vib,"populateSymbolsDropDown"));this.Ca.ya(C.a.Bvd,L.a.Mf,Object(B.a)(this,this.DGh,"symbolsDropDownOpenHandler"));this.Ca.ya(C.a.DSe,L.a.Mf,Object(B.a)(this,this.Kjh,"querySymbolPositionHandler"));this.Ca.ya(C.a.sVa,
L.a.Mf,Object(B.a)(this,this.qQj,"insertSymbolHandler"));this.Ca.he(C.a.Vib,1124);this.Ca.he(C.a.Bvd,1036);this.Ca.he(C.a.DSe,1124);this.Ca.he(C.a.sVa,1036);e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("InsertMoreSymbolsIsEnabled")&&(this.Ca.ya(C.a.i_c,L.a.view,Object(B.a)(this,this.yCh,"showInsertMoreSymbolsDialogHandler")),this.Ca.ya(C.a.i_c,L.a.Mf,Object(B.a)(this,this.yCh,"showInsertMoreSymbolsDialogHandler")),this.Ca.he(C.a.i_c,1124))}Kjh(La,sb,Ob,pc,Kc){if(1===Ob)return 32;La=this.YBa.xeh(Kc);
La=String.format(this.YBa.cDl,La.character);Kc[n.a.InnerHTML]=La;Kc[n.a.On]=!1;return 32}KFa(La,sb,Ob,pc,Kc){if(({Nf:La,selected:Ob,KFa:Ue}=this.zRf(sb,Ob)).returnValue)return Ue;var Gd=T.SelectionEditor.Xg(Ob);let he=!0;Ob=8;var Ue=this.Lk.je(15);Ue.ld(La.Ag);Gd||(Ob=this.Ca.ei(sb,C.a.LDa,2,!0,pc,null),sb=32===Ob,m.ULS.shipAssertTag(6407387,348,sb,"DeleteForReplace did not succeed. Response is {0}",Ob),he=sb);he&&(sb=La.Nb.Yj,Gd=T.SelectionEditor.Xg(sb),m.ULS.shipAssertTag(6407388,348,Gd,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",
sb.contextId),Ob=8,Gd&&(Ob=this.Ca.ei(sb,C.a.sVa,2,!1,pc,Kc),m.ULS.shipAssertTag(6407389,348,32===Ob,"Insertion at IP context did not succeed. Response is {0}",Ob),32===Ob&&z.FocusManager.instance().vf(La.VI)));Ue.dispose();return Ob}zRf(La,sb){let Ob,pc;Ob=null;La.view.Sh&&(Ob=La.view);pc=null;return Ob&&Ob.Nb?(pc=Ob.Nb.Yj)?this.GP.ga(14)&&this.ZD.R8a(pc)?{returnValue:!0,Nf:Ob,selected:pc,KFa:8}:Ob.Nb.Pa.uH||this.Sm&&this.Sm.instance&&this.Sm.instance.fX(pc)||T.SelectionEditor.p0c(La.UE)?{returnValue:!0,
Nf:Ob,selected:pc,KFa:2}:1===sb?{returnValue:!0,Nf:Ob,selected:pc,KFa:32}:{returnValue:!1,Nf:Ob,selected:pc,KFa:32}:{returnValue:!0,Nf:Ob,selected:pc,KFa:2}:(Z.c(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",La.toString()),{returnValue:!0,Nf:Ob,selected:pc,KFa:8})}qQj(La,sb,Ob,pc,Kc){if(1===Ob)return 32;if(T.SelectionEditor.p0c(sb))return 2;La=this.YBa.xeh(Kc);pc.QC=La.index;pc=this.SK.Lc(sb.node);Ob=pc.sc(11);m.ULS.shipAssertTag(6379466,
324,Ob,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",da.a[sb.node.type]);Ob=this.Lk.je(15);Ob.Sy(pc);fa.characterPropertiesEditor.replaceTextRange(sb,La.character,!0,!1);sb=ca.SelectionFactory.Qg(pc.currentNode,sb.Sa+1);this.Uc.setSelection(sb);Ob.dispose();return 32}Vib(La,sb,Ob,pc,Kc){if(1===Ob)return 32;e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.ob.Qp?Kc.MenuItems=this.r8h.value:Kc.PopulationXML=this.s8h.value;return 32}DGh(La,sb,Ob){({KFa:La}=this.zRf(sb,
Ob));return La}yCh(La,sb,Ob){2===Ob&&(new S(this.Ca,z.FocusManager.instance(),v.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"))).Nga();return 32}Nmd(){return 32}static get characterPropertiesEditor(){return fa.mh||(fa.mh=v.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(La){fa.mh=La}}fa.mh=null;Object(h.a)(fa,"SymbolsActor",null,[719]);class aa{constructor(La,sb){this.zvd=La;this.altText=sb}}Object(h.a)(aa,"Symbol",null,[]);class ja{constructor(){this.yPd=
null;this.zPd=new x.a(ja.w1d)}get Avd(){return this.zPd}zjj(La){this.yPd||(this.yPd=O.a(this.zPd.value));return Array.indexOf(this.yPd,La)}static w1d(){const La={};La["\u2022"]=new aa("\u2022",Box4Intl.Box4Strings.L_Bullet);La["\u20ac"]=new aa("\u20ac",Box4Intl.Box4Strings.L_EuroSign);La["\u00a3"]=new aa("\u00a3",Box4Intl.Box4Strings.L_PoundSign);La["\u00a5"]=new aa("\u00a5",Box4Intl.Box4Strings.L_YenSign);La["\u00a9"]=new aa("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);La["\u00ae"]=new aa("\u00ae",
Box4Intl.Box4Strings.L_RegisteredSign);La["\u2122"]=new aa("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);La["\u00b1"]=new aa("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);La["\u2260"]=new aa("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);La["\u2264"]=new aa("\u2264",Box4Intl.Box4Strings.L_LessThanOrEqualTo);La["\u2265"]=new aa("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);La["\u00f7"]=new aa("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);La["\u00d7"]=new aa("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);
La["\u221e"]=new aa("\u221e",Box4Intl.Box4Strings.L_Infinity);La["\u00b5"]=new aa("\u00b5",Box4Intl.Box4Strings.L_MicroSign);La["\u03b1"]=new aa("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);La["\u03b2"]=new aa("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);La["\u03c0"]=new aa("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);La["\u03a9"]=new aa("\u03a9",Box4Intl.Box4Strings.L_OhmSign);La["\u03a3"]=new aa("\u03a3",Box4Intl.Box4Strings.L_NArySummation);La["\u00b0"]=new aa("\u00b0",
Box4Intl.Box4Strings.L_DegreeSign);La["\u0394"]=new aa("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);La["\u263a"]=new aa("\u263a",Box4Intl.Box4Strings.L_WhiteSmilingFace);La["\u2665"]=new aa("\u2665",Box4Intl.Box4Strings.L_BlackHeartSuit);La["\u20b9"]=new aa("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);La["\u00bf"]=new aa("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);La["\u00a1"]=new aa("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);La["\u2014"]=new aa("\u2014",Box4Intl.Box4Strings.L_EmDash);
La["\u2026"]=new aa("\u2026",Box4Intl.Box4Strings.L_HorizontalEllipsis);La["\u00c0"]=new aa("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);La["\u00c1"]=new aa("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);La["\u00c2"]=new aa("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);La["\u00c3"]=new aa("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);La["\u00c4"]=new aa("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);La["\u00c5"]=
new aa("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);La["\u00c6"]=new aa("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);La["\u00c7"]=new aa("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);La["\u00c8"]=new aa("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);La["\u00c9"]=new aa("\u00c9",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);La["\u00ca"]=new aa("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);La["\u00cb"]=new aa("\u00cb",
Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);La["\u00cc"]=new aa("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);La["\u00cd"]=new aa("\u00cd",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);La["\u00ce"]=new aa("\u00ce",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);La["\u00cf"]=new aa("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);La["\u00d1"]=new aa("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);La["\u00d2"]=new aa("\u00d2",
Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);La["\u00d3"]=new aa("\u00d3",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);La["\u00d4"]=new aa("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);La["\u00d5"]=new aa("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);La["\u00d6"]=new aa("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);La["\u00d9"]=new aa("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);La["\u00da"]=new aa("\u00da",
Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);La["\u00db"]=new aa("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);La["\u00dc"]=new aa("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);La["\u00df"]=new aa("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);La["\u00e0"]=new aa("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);La["\u00e1"]=new aa("\u00e1",Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);La["\u00e2"]=new aa("\u00e2",Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);
La["\u00e3"]=new aa("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);La["\u00e4"]=new aa("\u00e4",Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);La["\u00e5"]=new aa("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);La["\u00e6"]=new aa("\u00e6",Box4Intl.Box4Strings.L_LatinSmallLetterAe);La["\u00e7"]=new aa("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);La["\u00e8"]=new aa("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);La["\u00e9"]=new aa("\u00e9",
Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);La["\u00ea"]=new aa("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);La["\u00eb"]=new aa("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);La["\u00ec"]=new aa("\u00ec",Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);La["\u00ed"]=new aa("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);La["\u00ee"]=new aa("\u00ee",Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);La["\u00ef"]=new aa("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);
La["\u00f1"]=new aa("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);La["\u00f2"]=new aa("\u00f2",Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);La["\u00f3"]=new aa("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);La["\u00f4"]=new aa("\u00f4",Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);La["\u00f5"]=new aa("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);La["\u00f6"]=new aa("\u00f6",Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);La["\u00f9"]=
new aa("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);La["\u00fa"]=new aa("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);La["\u00fb"]=new aa("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);La["\u00fc"]=new aa("\u00fc",Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);La["\u00ff"]=new aa("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);La["\u011e"]=new aa("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);La["\u011f"]=new aa("\u011f",
Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);La["\u0130"]=new aa("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);La["\u0131"]=new aa("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);La["\u0152"]=new aa("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);La["\u0153"]=new aa("\u0153",Box4Intl.Box4Strings.L_LatinSmallLigatureOe);La["\u015e"]=new aa("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);La["\u015f"]=new aa("\u015f",Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);
La["\u0178"]=new aa("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return La}}Object(h.a)(ja,"SymbolsLoader",null,[718]);var I=d(47),sa=d(319),ka=d(272),Ma=d(209),Ea=d(591),ma=d(1275),va=d(131),Ca=d(78);class oa{constructor(La){this.t8h=La}get Zuc(){return this.t8h}get cDl(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}xeh(La){La=La.SourceControlId.split("_");const sb={};2===La.length?(sb.character=La[1],sb.index=this.Zuc.zjj(sb.character)):
(sb.character=La[2],sb.index=parseInt(La[1]));return sb}Fsi(){return this.Xbg()}build(){return this.ude()}Rri(){const La=new Sys.StringBuilder;La.append('<table class="moreSymbolsTable">');const sb=this.Zuc.Avd.value,Ob=O.a(sb);let pc=0;for(;pc<Ob.length;){pc%15||La.append('<tr role="presentation">');const Kc=sb[Ob[pc]];La.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabindex="0" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',
"symbol_d_"+pc,I.a.eVa(Kc.zvd),I.a.eVa(Kc.altText)));pc++;pc%15&&pc!==Ob.length||La.append("</tr>")}La.append("</table>");return La.toString()}ude(){const La=this.Xbg();return va.l(La)}Xbg(){const La=Object.assign(new sa.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});Array.add(La.MenuSectionList,this.dei());e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("InsertMoreSymbolsIsEnabled")&&Array.add(La.MenuSectionList,this.Nci());return La}Nci(){const La=Object.assign(new ka.a,{Id:"msMoreSymbols",
Title:"",DisplayMode:"Menu16",ControlsId:"ctrlMoreSymbols",ControlList:[]}),sb=Object.assign(new Ma.a,{Id:"btnMoreSymbols",Command:"3574218963",LabelText:I.a.xe(Box4Intl.Box4Strings.L_InsertMoreSymbols),Alt:I.a.xe(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:e.AFrameworkApplication.Cm,Image16by16Class:Ca.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});Array.add(La.ControlList,sb);return La}dei(){const La=Object.assign(new ka.a,{Id:"msSymbolsPosition",ShowMenuSectionSeparator:!1,
ControlList:[]}),sb=Object.assign(new Ea.a,{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),Ob=this.Zuc.Avd.value,pc=O.a(Ob),Kc=Math.min(25,pc.length);for(let he=0;he<Kc;he++){var Gd=Ob[pc[he]];Gd=Object.assign(new ma.a,{Id:String.format("{0}{1}_{2}","symbol_",he,Gd.zvd),Character:Gd.zvd,Command:"3966968829",QueryCommand:"816646517",Alt:I.a.xe(Gd.altText)});sb.GalleryItems.push(Gd)}Array.add(La.ControlList,
sb);return La}}Object(h.a)(oa,"SymbolsUiBuilder",null,[705]);var Da=d(64),ta=d(122),ha=d(38),Ha=d(520),bb=d(290);class Na{constructor(){this.Da=null}get name(){return"Box4.Symbols"}init(){e.AFrameworkApplication.fa.ka("InsertSymbolIsEnabled")&&this.Da.resolve("Box4.Symbols.ISymbolsActor").vb()}dispose(){}Yb(La){this.Da=La;this.Da.register(ja,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").ma();this.Da.register(oa,"Box4.Symbols.SymbolsUiBuilder").as("Box4.Symbols.ISymbolsUIBuilder").ma().oa(()=>
new oa(this.Da.resolve("Box4.Symbols.ISymbolsLoader")));this.Da.register(fa,"Box4.Symbols.SymbolsActor").as("Box4.Symbols.ISymbolsActor").ma().oa(()=>new fa(e.AFrameworkApplication.Ra,new Ha.a,new bb.a,this.Da.resolve("Box4.Symbols.ISymbolsUIBuilder"),ta.a.instance,ha.a.instance,Da.a.instance,this.Da.Ia("Box4.IExternalSelectionManager")))}static main(){r.a.instance.Ac(new Na)}}Object(h.a)(Na,"Box4SymbolsPackage",null,[2,3]);var Ia=d(1095),Qa=d(36),qa=d(81),Wa=d(453);class Hb{constructor(La,sb){this.rOd=
this.qOd=null;this.zrb=new Ia.a;this.hi=La;this.lCa=sb.appSettings[Hb.tUl]||""}get jrl(){return this.zrb.task}get ada(){return this.hi.value}tal(){const La={};La[Hb.KGj]=e.AFrameworkApplication.gh;La["Content-Type"]="application/json; charset=utf-8";m.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const sb=qa.a.Ti(this.lCa+Hb.krl,Hb.Lzk,e.AFrameworkApplication.Aa.ob.zk.toString());this.ada.zj(sb,1,"",La,!0,2,Object(B.a)(this,this.eNe,"onSuccessCallback"),
Object(B.a)(this,this.zmc,"onFailureCallback"),null,void 0,void 0,void 0,void 0,"20")}fck(La){try{const sb={};sb.FlightName=La.FlightName;sb.SessionID=La.SessionID;m.ULS.sendTraceTag(594883776,215,50,Qa.c(sb))}catch(sb){m.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}eNe(La){if((La=La.data.ee)&&La.length)try{const sb=Qa.a(La);this.qOd=sb.NavBarDataJson;m.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");this.qOd?({Nu:this.rOd}=Qa.d(sb.NavBarDataJson)).returnValue?
(this.fck(this.rOd),this.zrb.Og(this.rOd)):(m.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:Wa.a.xwc(this.qOd)}),this.zrb.M1()):(m.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.zrb.M1())}catch(sb){m.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.zrb.M1()}else m.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")}zmc(){this.zrb.M1();m.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}static get instance(){return Hb.La||
(Hb.La=Hb.E$a())}static E$a(){return new Hb(new x.a(()=>e.AFrameworkApplication.Me),e.AFrameworkApplication.fa,e.AFrameworkApplication.Aa.ob.zk)}}Hb.KGj="X-qs";Hb.Lzk="at";Hb.krl="O365ShellServiceProxy.ashx";Hb.La=null;Hb.tUl="ShellWebServiceBase";Object(h.a)(Hb,"O365ShellActor",null,[751]);class jc{constructor(){this.Da=null}get name(){return"Common.App.O365Shell"}Yb(La){this.Da=La;this.Da.register(Hb,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").ma().oa(()=>new Hb(new x.a(()=>
e.AFrameworkApplication.Me),e.AFrameworkApplication.fa,e.AFrameworkApplication.Aa.ob.zk))}init(){e.AFrameworkApplication.fa.ff(Object(B.a)(this,this.en,"onFullAppSettingsReady"))}en(){e.AFrameworkApplication.Syd&&e.AFrameworkApplication.Aa.ob.mO&&this.Da.resolve("Common.App.O365Shell.O365ShellActor").tal()}dispose(){}static main(){r.a.instance.Ac(new jc)}}Object(h.a)(jc,"PackageManager",null,[2,3]);var gc=d(77),$b=d(282);class wb{constructor(La){this.Ma=new gc.a;this.kI=La}jJc(La){this.Ma.addHandler(wb.Yza,
La)}DVe(La){this.Ma.removeHandler(wb.Yza,La)}L1e(){this.Ma.raiseEvent(wb.nNb)}K1e(){this.Ma.raiseEvent(wb.oNb)}}wb.nNb="SE";wb.oNb="SEP";wb.Yza="SER";wb.N6e="TRP";Object(h.a)(wb,"NullSessionExpirationManager",null,[715,716]);var Db=d(172);class Xb{constructor(){this.AYb=this.$Pa=!1;const La=e.AFrameworkApplication.um;0>=La||(this.um=La,m.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.um,["NowGetTime"]:(new Date).getTime(),["BootTime"]:e.AFrameworkApplication.Vca}),
$b.a.instance.xTd(Object(B.a)(this,this.hJb,"onSessionExpiredDetected")),$b.a.instance.vTd(Object(B.a)(this,this.Ymc,"onSessionExpiringDetected")))}hJb(){$b.a.instance.iph(Object(B.a)(this,this.hJb,"onSessionExpiredDetected"));m.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.tfe()}Ymc(){$b.a.instance.P8k(Object(B.a)(this,this.Ymc,"onSessionExpiringDetected"));this.AYb||this.$Pa||(m.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.AYb=!0,
this.p2e())}tfe(){this.$Pa||(e.AFrameworkApplication.Oo(Db.a.sessionAccessTokenExpired),this.$Pa=!0,this.tud())}}Object(h.a)(Xb,"ASessionExpirationManager",null,[]);var ab=d(286),Ab=d(37);class rc{constructor(La,sb,Ob,pc){this.c6e="";this.eyc=La;this.Psf=Ob;this.Msf=pc;this.Cjf=sb;La=(new Date(this.eyc)).format(e.AFrameworkApplication.$zh);this.c6e=this.Cjf?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,La)}lNb(La){1===La?this.Psf&&this.Psf(this.Cjf):
0===La&&e.AFrameworkApplication.Ra.Ka(Ab.a.close,2,ab.g)}dispose(){this.Msf&&this.Msf()}}rc.id="SessionExpirationDialog";Object(h.a)(rc,"SessionExpirationDialogSharedProperties",null,[]);class tb{}tb.sg="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>";Object(h.a)(tb,"SessionExpirationDialogHtml",null,[]);class Za extends N.a{constructor(La,sb,Ob,pc){super(sb);const Kc={};this.RBa=new rc(La,sb,Ob,
pc);this.kg=rc.id;e.AFrameworkApplication.VHf?(this.Ad=1,this.Oe(0,CommonUIStrings.l_DialogClose)):(this.Ad=0,this.Ir=!1);sb||1===e.AFrameworkApplication.Aa.mode?this.Oe(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Oe(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.sg=tb.sg;Kc.WACSessionExpirationText=this.RBa.c6e;this.pj(CommonUIStrings.l_DefaultDialogTitle,Object(B.a)(this,this.lNb,"sessionExpirationDialogHandler"),Kc);this.y6(this.Uh("WACSessionExpirationText"))}lNb(La){this.RBa.lNb(La)}N0c(){return this.WQ}Z9b(){this.hide()}dispose(){super.dispose();
this.RBa&&this.RBa.dispose()}}Object(h.a)(Za,"LegacySessionExpirationDialog",N.a,[842]);var fb=d(107);class ac extends fb.StandardDialog{constructor(La,sb,Ob,pc){super(sb);this.RBa=new rc(La,sb,Ob,pc);this.kg=rc.id;e.AFrameworkApplication.VHf?(this.Ad=1,this.Oe(0,CommonUIStrings.l_DialogClose)):(this.Ad=0,this.Ir=!1);sb||1===e.AFrameworkApplication.Aa.mode?this.Oe(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Oe(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Tx(CommonUIStrings.l_DefaultDialogTitle,
this.RBa.c6e,0,Object(B.a)(this,this.lNb,"sessionExpirationDialogHandler"))}lNb(La){this.RBa.lNb(La)}N0c(){return this.WQ}Z9b(){this.hide()}dispose(){super.dispose();this.RBa&&this.RBa.dispose()}}Object(h.a)(ac,"SessionExpirationDialog",fb.StandardDialog,[842]);const Dc=(La,sb,Ob,pc)=>e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.ob.hD&&e.AFrameworkApplication.fa.ka("ReactStandardSessionExpirationDialogIsEnabled")?new ac(La,sb,Ob,pc):new Za(La,sb,Ob,pc);var Sc=d(222);class xb extends Xb{constructor(La){super();
this.Crb=this.Drb=!0;this.$P=null;this.Ma=new gc.a;this.kI=La}jJc(La){this.Ma.addHandler(xb.Yza,La)}DVe(La){this.Ma.removeHandler(xb.Yza,La)}L1e(La){this.Drb=La}K1e(La){this.Crb=La}p2e(){if(!this.$P&&!Sc.a.wx){if(this.Crb){const La=Object(B.a)(this,this.gwb,"disposeCallback");this.$P=Dc(this.um,!1,Object(B.a)(this,this.mNb,"sessionExpirationHandler"),La)}this.Ma.raiseEvent(xb.oNb)}}tud(){this.$P&&(this.$P.N0c()&&this.$P.Z9b(),this.$P=null);if(this.Drb){const La=Object(B.a)(this,this.gwb,"disposeCallback");
this.$P=Dc(this.um,!0,Object(B.a)(this,this.mNb,"sessionExpirationHandler"),La)}this.Ma.raiseEvent(xb.nNb)}gwb(){this.$P=null}mNb(){this.kI.refreshDocument(null)}}xb.nNb="SE";xb.oNb="SEP";xb.Yza="SER";xb.N6e="TRP";Object(h.a)(xb,"SessionExpirationManager",Xb,[715,716]);var Ta=d(18);class ib{}ib.Y$h="Aborting";ib.sIc="ActivityDuration";ib.error="Error";ib.Q5d="Errors";ib.failed="Failed";ib.TSc="FirstActivity";ib.initialized="Initialized";ib.l7j="KickedOut";ib.t7j="LastActivity";ib.Xrh="RetryOverride";
ib.Fpd="RequestGroups";ib.I0a="Requests";ib.Rpd="Responses";ib.Krd="SessionDuration";ib.status="Status";ib.success="Success";ib.qCl="Successful";ib.tokens="Tokens";ib.kPe="PollingDuration";Object(h.a)(ib,"SessionExpirationStrings",null,[]);var ob=d(82);class fc{constructor(La){this.$y={};this.i7={};this.JPa={};this.mwg=15;this.Lkf=!1;this.N6h=new Date;this.WCc=new Date;this.Zd=La;this.Z7=new ob.a(2,2,6E4*this.mwg,Object(B.a)(this,this.aRh,"writeMeasures"),135,"SL",!1);this.Zd.Hb(this.Z7);this.pOj()}aRh(){m.ULS.sendTraceTag(41964821,
217,50,m.ULS.Tqe({["Aggregate"]:this.i7,["Current"]:this.$y}))}pOj(){this.i7[ib.Fpd]=0;this.i7[ib.I0a]=0;this.i7[ib.Rpd]=0;this.i7[ib.status]=ib.initialized;this.i7[ib.TSc]=new Date;this.i7[ib.Krd]=0;this.i7[ib.sIc]=0;this.i7[ib.Krd]=0;this.$y[ib.Krd]=0;this.i7[ib.sIc]=0;this.$y[ib.sIc]=0}get hPk(){this.JPa[ib.kPe]=+new Date-+this.JPa[ib.TSc];return this.JPa}yhe(La,sb){var Ob=La[sb];Ob=Ob?Ob:0;Ob++;La[sb]=Ob;this.c_e(La)}c_e(La){const sb=new Date;La[ib.sIc]=+sb-+this.WCc;this.WCc=sb;La[ib.Krd]=+this.WCc-
+this.N6h;La[ib.t7j]=this.WCc}SY(La,sb){this.$y[La]=sb;this.c_e(this.$y)}FZe(La,sb){this.$y[La]=sb;this.c_e(this.$y)}Zzb(La){this.yhe(this.$y,La);this.yhe(this.i7,La);this.yhe(this.JPa,La)}flush(){this.Lkf||(this.i7[ib.status]=this.$y[ib.status],this.aRh(this.Z7),this.Zd.E1(this.Z7,6E4*this.mwg))}Tal(){const La=this.$y[ib.status];La&&(this.i7[ib.status]=La);this.$y={}}$al(){this.JPa={};this.JPa[ib.kPe]=0;this.JPa[ib.TSc]=new Date}stop(){m.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");
this.flush();this.Lkf=!0;this.Zd.Lg(this.Z7)}}Object(h.a)(fc,"SessionLogger",null,[711]);class Jb{constructor(La,sb){this.sHc=La;this.Wha=sb}get tokens(){return this.sHc}get errors(){return this.Wha}}Object(h.a)(Jb,"TokenRefreshArgs",null,[749]);var xc=d(96),ic=d(203),nc=d(134);class Wb extends Sys.EventArgs{constructor(La,sb,Ob,pc,Kc,Gd,he){super();this.JPa=La;this.Fpd=pc;this.failed=Kc;this.I0a=Gd;this.Rpd=he}}Object(h.a)(Wb,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);var wc=d(89);class nb{constructor(La,
sb=null,Ob=null){this.AYb=this.$Pa=!1;this.Crb=this.Drb=!0;this.Ma=new gc.a;this.CYb=this.UVb=this.vFc=!1;this.fMd=null;this.Xpf=10;this.CCc=!1;this.oQd=La;this.oId=e.AFrameworkApplication.o6j;this.Zd=nc.a.instance;m.ULS.sendTraceTag(39408093,217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:e.AFrameworkApplication.um,["NowGetTime"]:(new Date).getTime(),["BootTime"]:e.AFrameworkApplication.Vca});this.Jj=sb||new fc(nc.a.instance);this.Oia=Ob;$b.a.instance.xTd(Object(B.a)(this,
this.T$h,"aSessionExpirationManagerWithRefresh_OnSessionExpired"));$b.a.instance.vTd(Object(B.a)(this,this.zRd,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));ic.SessionStatusManager.instance.nTd(Object(B.a)(this,this.zRd,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));ic.SessionStatusManager.instance.Ehi(Object(B.a)(this,this.lSk,"preemptiveTokenRefresh"));this.Jlf=new Date;e.AFrameworkApplication.n6j&&($b.a.instance.$Xd=Object(B.a)(this,this.Q1k,"refreshAccessTokenWhenSessionExpired"));
La=!1;e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollingIsEnabled",!1),this.Xpf=e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",10),e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1),La=e.AFrameworkApplication.fa.ka("WopiTokenRefreshWhenNetworkResumed"));La?ic.SessionStatusManager.instance.nTd(Object(B.a)(this,
this.U$h,"aSessionExpirationManagerWithRefresh_OnSessionExpiringNetworkResumed")):ic.SessionStatusManager.instance.nTd(Object(B.a)(this,this.zRd,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"))}jJc(La){this.Ma.addHandler(nb.Yza,La)}DVe(La){this.Ma.removeHandler(nb.Yza,La)}Q1k(){this.A9b(!1);return!$b.a.instance.tGa(e.AFrameworkApplication.um)}T$h(La,sb){$b.a.instance.X2c?this.hJb(La,sb):this.oId?(this.UVb=!1,this.A9b(!1)):(this.$Pa||m.ULS.sendTraceTag(520954892,217,15,"Detected session expiry before token refresh got blocked"),
this.hJb(La,sb))}U$h(La,sb){$b.a.instance.V2c?this.Ymc(La,sb):(Z.c(512247769,306,50,"Refreshing tokens since the user has network and session is expiring."),this.UVb=!1,this.A9b(!0))}zRd(La,sb){$b.a.instance.V2c?this.Ymc(La,sb):this.A9b(!0)}A9b(La){if(!this.vFc&&!this.UVb)if(this.Oia&&this.Oia.ucb)this.CYb=!0,this.Jj.SY(ib.status,ib.l7j),this.Jj.flush(),this.Jj.stop();else if(m.ULS.sendTraceTag(40420955,217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",La,this.CYb),this.CYb)this.tud();
else{this.Jj.flush();this.Jj.Tal();this.Jj.Zzb(ib.Fpd);this.vFc=!0;this.CCc||(this.Jj.$al(),this.CCc=!0,this.sJi());const sb=this.oQd.l2k(La);sb.continueWith(()=>{if(this.oQd.RUk(sb))this.Jj.Zzb(ib.qCl),this.Jj.SY(ib.status,ib.success),this.Crb=!1,this.oId&&(this.Drb=!1),this.UVb=!1,this.Jlf=new Date,this.zBl(),this.Ma.raiseEvent(nb.Yza,new Jb(sb.result.tokens,null));else{const Ob=sb.result.errors;this.Jj.Zzb(ib.failed);this.Jj.SY(ib.status,ib.failed);La||(this.CYb=this.oQd.Jbc(Ob));this.CYb&&(this.Jj.SY(ib.Y$h,
JSON.stringify(Ob)),m.ULS.sendTraceTag(520954891,217,15,"Aborting token refresh"));this.UVb=!0;this.Ma.raiseEvent(nb.Yza,new Jb(null,Ob))}this.Jj.flush();this.vFc=!1})}}hJb(){this.oId||$b.a.instance.iph(Object(B.a)(this,this.hJb,"onSessionExpiredDetected"));m.ULS.sendTraceTag(39408094,217,50,"SessionExpiredDetected");this.tfe($b.a.instance.X2c)}Ymc(){this.AYb||this.$Pa||(m.ULS.sendTraceTag(39408095,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.AYb=!0,this.p2e($b.a.instance.V2c))}tfe(La){if(!this.$Pa){var sb=
La?Db.a.xil:Db.a.sessionAccessTokenExpired;const Ob=Object.assign(new wc.a,{extendedProperties:new Map});Ob.extendedProperties.set("ErrorCode",String.format("{0}",sb));e.AFrameworkApplication.Oo(sb,void 0,["SessionExpired"],Ob);La||(La=new Date,sb=new Date(e.AFrameworkApplication.Vca),m.ULS.sendTraceTag(51642974,217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",sb,La,+La-+sb),864E5>+La-+sb&&xc.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",["SessionExpired"],
!0,!0,!1,!0,Ob),2592E5>+La-+sb&&xc.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,Ob));this.$Pa=!0;this.tud()}}zBl(){this.CCc&&(this.Zd.Lg(this.fMd),this.CCc=!1)}sJi(){this.fMd=new ob.a(2,2,1E3*this.Xpf,Object(B.a)(this,this.VGl,"tokenRefreshPolling"),135);this.Zd.Hb(this.fMd)}VGl(){const La=this.Jj.hPk;m.ULS.sendTraceTag(555255521,217,50,"{0}",Qa.c(La));this.Ma.raiseEvent(nb.N6e,new Wb(La,La[ib.kPe],La[ib.TSc],La[ib.Fpd],La[ib.failed],
La[ib.I0a],La[ib.Rpd]))}lSk(){3E5<+new Date-+this.Jlf?(m.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),this.A9b(!1)):m.ULS.sendTraceTag(528867868,217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")}}nb.nNb="SE";nb.oNb="SEP";nb.Yza="SER";nb.N6e="TRP";Object(h.a)(nb,"ASessionExpirationManagerWithRefresh",null,[]);class Rb extends nb{constructor(La,sb,Ob=null,pc=null){super(sb,Ob,pc);this.$P=null;this.kI=La}L1e(La){this.Drb=La}K1e(La){this.Crb=
La}p2e(La){if(!this.$P&&!Sc.a.wx){if(La){var sb=Object(B.a)(this,this.gwb,"disposeCallback");this.$P=Dc(e.AFrameworkApplication.OMb,!1,Object(B.a)(this,this.mNb,"sessionExpirationHandler"),sb)}else if(this.Crb){if(this.vFc)return;sb=Object(B.a)(this,this.gwb,"disposeCallback");this.$P=Dc(e.AFrameworkApplication.um,!1,Object(B.a)(this,this.mNb,"sessionExpirationHandler"),sb)}m.ULS.sendTraceTag(39408096,217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",nb.oNb,La);this.Ma.raiseEvent(nb.oNb)}}tud(){this.$P&&
(this.$P.N0c()&&this.$P.Z9b(),this.$P=null);if(this.Drb){this.Jj.stop();if(this.Oia&&this.Oia.ucb)return;const La=Object(B.a)(this,this.gwb,"disposeCallback");this.$P=Dc(e.AFrameworkApplication.um,!0,Object(B.a)(this,this.mNb,"sessionExpirationHandler"),La)}m.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",nb.nNb);this.Ma.raiseEvent(nb.nNb)}gwb(){this.$P=null}mNb(){this.kI.refreshDocument(null)}}Object(h.a)(Rb,"SessionExpirationManagerWithRefresh",nb,[715,716]);class mb{constructor(La,sb,Ob=
null,pc=null){this.dvf=!1;this.La=null;this.xOa=La;this.iPa=sb;this.Jj=Ob||new fc(nc.a.instance);this.Oia=pc}create(){this.dvf=e.AFrameworkApplication.jA;if(!this.dvf)return new xb(this.xOa);e.AFrameworkApplication.uk("WOPITokenRefreshIsEnabled");m.ULS.sendTraceTag(39408088,217,50,"App has requested custom Session Expiration Manager");if(!this.La)switch(e.AFrameworkApplication.GUl){case 1:m.ULS.sendTraceTag(39408090,217,50,"Creating new NullSessionExpirationManager");this.La=new wb(this.xOa);break;
case 2:m.ULS.sendTraceTag(39408091,217,50,"Creating new SessionExpirationManagerWithRefresh");this.La=new Rb(this.xOa,this.iPa,this.Jj,this.Oia);break;default:m.ULS.sendTraceTag(39408092,217,50,"Creating new legacy SessionExpirationManager"),this.La=new xb(this.xOa)}m.ULS.sendTraceTag(39408089,217,50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this.La).getName());return this.La}}Object(h.a)(mb,"SessionExpirationManagerFactory",null,[714]);var Ub=d(1244),zc=d(19);class Pc{}
Object(h.a)(Pc,"Error",null,[]);class Mc{}Object(h.a)(Mc,"NamedResult",null,[]);class ld extends Mc{}Object(h.a)(ld,"ErrorInfo",Mc,[]);var vb=d(478),cc=d(106),Hc=d(178),Pb=d(127),Uc=d(723);class sc{constructor(La,sb,Ob,pc=null,Kc=!1,Gd=null,he=!1,Ue=!1){this.JBa=0;this.Dra=this.nn=null;this.sHc=new Ta.a;this.Wha=new Ta.a;this.lw=null;this.KVb=!1;this.rZb=this.sZb=null;this.Zd=La;this.bqf=sb;this.bqf.execute(Rf=>{Rf.dC(Pb.a.Oge,Object(B.a)(this,this.XDk,"onHostResponseReceived"))});this.KS=Ob;this.Auf=
new Uc.a("WebServiceCall","TokenRefresh");this.Jj=pc||new fc(La);this.H6h=Kc;this.wra=Gd?Gd:ic.SessionStatusManager.instance;this.Bff=he;this.DAc=Ue}XDk(La){if(La.MessageId!==Pb.a.Oge)Z.c(39408099,306,15,"Unexpected message.");else{var sb=new Ta.a,Ob=new Ta.a;this.Jj.Zzb(ib.Rpd);var pc=La.Values[Hc.a.Mvh];if(!pc||0>=pc.length)Z.c(40122317,306,15,"Found no tokens in the dictionary"),pc=La.Values;Z.c(40122318,306,100,"The Tokens array contains {0} tokens",pc.length);this.Jj.SY("Correlation",La.CorrelationId);
var Kc="";for(let Ue=0;Ue<pc.length;Ue++){this.Jj.FZe(ib.tokens,pc.length);var Gd=pc[Ue],he=Gd;if(!he||!he.Name)continue;this.Jj.Zzb(he.Name);const Rf=Gd;if(Rf&&Rf.Value)Z.c(39408128,306,100,"Received token with name: {0}",Rf.Name),sb.add(Rf),this.sHc.add(Rf),this.DAc||this.Jj.SY(ib.status,ib.success),this.Bff&&this.wra&&this.wra.obl();else if(Gd=this.Bqj(Gd),Z.c(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",he.Name,JSON.stringify(Gd),this.Dra),Ob.add(Gd),
this.DAc||(this.Wha.add(Gd),Kc=JSON.stringify(Gd),this.Jj.SY(ib.error,JSON.stringify(Gd)),this.Jj.SY(ib.status,ib.failed)),this.Bff)for(const sf of Gd.Errors)he=this.Jgj(sf),this.wra&&this.wra.yei(he)}this.DAc?(0<Ob.count?this.rZb?this.rZb(new Jb(sb,Ob)):Z.c(512267295,306,15,"Received errors but the promise has completed"):this.sZb?this.sZb(new Jb(sb,Ob)):Z.c(512267294,306,15,"Received valid tokens but the promise has completed"),Z.c(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",
sb.count,Ob.count,La.CorrelationId,this.Dra)):(0<Ob.count&&""!==Kc?(pc=Object.assign(new wc.a,{extendedProperties:new Map}),pc.extendedProperties.set("Errors",Kc),pc.extendedProperties.set("RetryCount",this.JBa.toString()),pc.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),pc.extendedProperties.set("IsTokenExpiring",this.KVb.toString()),xc.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,pc)):xc.Health.instance.recordKpiSuccess("WACTokenRefresh",
null),Z.c(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",sb.count,Ob.count,La.CorrelationId,this.Dra),0<Ob.count&&!this.Jbc(Ob)?(La=this.KS.jag(Ob),La!==this.KS.AMb&&(this.Jj.FZe(ib.Xrh,La),this.Zd.E1(this.nn,La))):(this.Jj.flush(),this.nn&&(Z.c(39408131,306,100,"Deleting task {0} from task manager",this.nn.name),this.Zd.Lg(this.nn)),this.lw&&!this.lw.task.isCompleted?this.lw.Og(new Jb(sb,Ob)):Z.c(512267293,306,15,"Received results but the task has completed")))}}Bqj(La){if(!La)return null;
const sb=Object.assign(new ld,{Name:La.Name,Errors:[]});for(const Ob of La.Errors)La=new Pc,La.Id=Ob.Id,La.Details=vb.a.Oyb(Ob.Details,500),sb.Errors.push(La);return sb}requestTokensOnce(){this.Tqh()}Tqh(){e.AFrameworkApplication.dma("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.JBa>=this.KS.p3g?(Z.c(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.Dra),this.RKi(this.lw)):(xc.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),
this.hvh())}hvh(){const La={};La[Hc.a.Mvh]=this.KS.tokens;const sb=cc.a.create().toString();Z.c(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.KS.tokens),this.JBa+1,sb,this.Dra);this.bqf.execute(Ob=>{Ob.sendMessage(Pb.a.pUd,La,sb)});this.JBa++;this.Jj.Zzb(ib.I0a)}RKi(La){const sb=new Ta.a;for(let Ob=0;Ob<this.KS.tokens.length;Ob++){const pc=Object.assign(new ld,{Name:this.KS.tokens[Ob],Errors:[Object.assign(new Pc,{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});
sb.add(pc);this.Wha.add(pc)}this.Zd.Lg(this.nn);this.Jj.SY(ib.Q5d,JSON.stringify(this.Wha));this.Jj.SY(ib.status,ib.failed);La&&!La.task.isCompleted&&La.Og(new Jb(new Ta.a,this.Wha))}l2k(La){this.Auf.start();this.KVb=La;this.Dra=cc.a.create().toString();Z.c(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.Dra,this.KVb);this.JBa=0;this.Wha.clear();this.sHc.clear();this.lw=new Ia.a;this.DAc?this.Uqh(this.KS.p3g).then(sb=>{this.lw&&!this.lw.task.isCompleted&&this.lw.Og(sb);
this.rZb=this.sZb=null;this.Jj.SY(ib.Q5d,JSON.stringify(this.Wha));this.Jj.SY(ib.status,ib.success);this.Jj.flush()}).catch(sb=>{this.lw&&!this.lw.task.isCompleted&&this.lw.Og(Object(Ub.a)(749,sb));this.rZb=this.sZb=null;this.Jj.SY(ib.Q5d,JSON.stringify(this.Wha));this.Jj.SY(ib.status,ib.failed);this.Jj.flush()}):(this.nn=new ob.a(this.KS.priority,2,this.KS.AMb,Object(B.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,Pb.a.pUd,!0),this.H6h&&this.Tqh(),this.Zd.Hb(this.nn));return this.lw.task}Uqh(La){const sb=
this,Ob=new Promise((Ue,Rf)=>{sb.sZb=Ue;sb.rZb=Rf;xc.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);sb.hvh()}),pc=this,Kc=new Promise((Ue,Rf)=>{window.setTimeout(()=>{Rf(pc.YOf("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},pc.KS.AMb)});let Gd=La;const he=this;return new Promise((Ue,Rf)=>{Gd--;Promise.race([Ob,Kc]).then(sf=>{xc.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Ue(sf)}).catch(sf=>{var ag=he.KS.AMb;if(Object(zc.a)(749,
sf)&&(sf=Object(Ub.a)(749,sf),0<sf.errors.count)){he.Yak(sf.errors);he.lxf(sf.errors);if(he.Jbc(sf.errors)){Rf(sf);return}const xg=he.KS.jag(sf.errors);xg!==he.KS.AMb?(he.Jj.FZe(ib.Xrh,xg),ag=xg):he.N4j(sf.errors)&&(ag=0)}Gd?window.setTimeout(()=>{he.Uqh(Gd).then(Ue).catch(Rf)},ag):(ag=he.YOf("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),he.lxf(ag.errors),Rf(ag),Z.c(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",
he.Dra))})})}lxf(La){for(let sb of La)this.Wha.add(sb)}N4j(La){if(!La.count)return!1;La=La.ga(La.count-1);return La.Errors.length?"TIMEOUT"==La.Errors[0].Id:!1}YOf(La,sb){const Ob=new Ta.a;for(let pc=0;pc<this.KS.tokens.length;pc++){const Kc=this.SKi(this.KS.tokens[pc],La,sb);Ob.add(Kc)}return new Jb(new Ta.a,Ob)}SKi(La,sb,Ob){return Object.assign(new ld,{Name:La,Errors:[Object.assign(new Pc,{Id:sb,Details:Ob})]})}Yak(La){if(La.count){La=La.ga(La.count-1);La=JSON.stringify(La);var sb=Object.assign(new wc.a,
{extendedProperties:new Map});sb.extendedProperties.set("Errors",La);sb.extendedProperties.set("RetryCount",this.JBa.toString());sb.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());sb.extendedProperties.set("IsTokenExpiring",this.KVb.toString());xc.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,sb);this.Jj.SY(ib.error,La);this.Jj.SY(ib.status,ib.failed)}}RUk(La){this.Auf.stop();const sb=this.eHj(La.result.errors);m.ULS.sendTraceTag(41755339,
217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!sb,this.Dra,this.KVb,this.JBa,this.Wha.count,0<La.result.errors.count?La.result.errors.ga(0).Name:"",0<La.result.errors.count&&0<La.result.errors.ga(0).Errors.length?La.result.errors.ga(0).Errors[0].Id:"",0<La.result.errors.count&&0<La.result.errors.ga(0).Errors.length?La.result.errors.ga(0).Errors[0].Details:"");return sb?
!1:this.QUk(La.result.tokens)}Jbc(La){return this.KS.Jbc(La)}QUk(La){for(let sb=0;sb<La.count;sb++){const Ob=La.ga(sb);if(Ob.Name===Hc.a.accessToken){const pc=(new Date).getTime();Ob.Expiry>e.AFrameworkApplication.um?(m.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:Ob.Expiry,["NowGetTime"]:pc,["BootTime"]:e.AFrameworkApplication.Vca},"PreviousAccessTokenTtl",e.AFrameworkApplication.um),e.AFrameworkApplication.accessToken=Ob.Value,e.AFrameworkApplication.um=Math.floor(Ob.Expiry),
e.AFrameworkApplication.P$e=pc,e.AFrameworkApplication.b8=Math.floor(Ob.Expiry)):m.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:Ob.Expiry,["NowGetTime"]:pc,["BootTime"]:e.AFrameworkApplication.Vca},"PreviousAccessTokenTtl",e.AFrameworkApplication.um)}}return!0}eHj(La){let sb=!1;for(let Ob=0;Ob<La.count;Ob++){sb=!0;const pc=La.ga(Ob);m.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",
pc.Name,JSON.stringify(pc.Errors),this.Dra)}return sb}Jgj(La){let sb=Db.a.sessionAccessTokenExpired;La=parseInt(La.Id);if(isNaN(La))sb=Db.a.KUl;else{switch(La){case 401:sb=Db.a.NUl;break;case 403:sb=Db.a.IUl;break;case 500:sb=Db.a.JUl;break;case 503:sb=Db.a.MUl}sb===Db.a.sessionAccessTokenExpired&&(sb=500<La?Db.a.LUl:Db.a.HUl)}return sb}}Object(h.a)(sc,"TokenRefreshManager",null,[713]);class lb{constructor(){this.AMb=e.AFrameworkApplication.QUl;this.p3g=e.AFrameworkApplication.OUl;this.tokens=e.AFrameworkApplication.Qxj();
this.priority=e.AFrameworkApplication.RUl;this.xrf=this.Bnl();this.nRd=e.AFrameworkApplication.Pxj()}Jbc(La){La=JSON.stringify(La);if(this.nRd&&0<this.nRd.length)for(const sb of this.nRd)if(0<sb.length&&0<=La.indexOf(sb))return!0;return!1}jag(La){try{if(La)for(let sb of La)if(sb.Errors)for(const Ob of sb.Errors)if(Ob.Id in this.xrf)return Number.parseInvariant(this.xrf[Ob.Id].toString())}catch(sb){m.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",sb.toString())}return this.AMb}Bnl(){const La=
{};try{if(!e.AFrameworkApplication.UXc()||0>=e.AFrameworkApplication.UXc().length||""===e.AFrameworkApplication.UXc()[0])return La;for(const sb of e.AFrameworkApplication.UXc())0<sb.length&&(La[sb]=e.AFrameworkApplication.PUl)}catch(sb){m.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",sb.toString())}return La}}Object(h.a)(lb,"TokenRefreshPolicy",null,[712]);class Zb{constructor(){this.Da=null}get name(){return"Common.App.SessionExpiration"}init(){e.AFrameworkApplication.fa.ff(()=>
{this.AFa()})}AFa(){this.Da.resolve("Common.ISessionExpirationManagerFactory");this.Da.resolve("Common.ISessionExpirationManager");this.Da.resolve("Common.ISessionExpirationManagerWithDialog")}dispose(){}Yb(La){this.Da=La;La.register(711,"Common.App.SessionExpiration.ISessionLogger").ma().oa(()=>new fc(nc.a.instance));La.register(712,"Common.App.SessionExpiration.ITokenRefreshPolicy").ma().oa(()=>new lb);La.register(713,"Common.App.SessionExpiration.ITokenRefreshManager").ma().oa(()=>new sc(nc.a.instance,
e.AFrameworkApplication.KT(),La.resolve("Common.App.SessionExpiration.ITokenRefreshPolicy"),La.resolve("Common.App.SessionExpiration.ISessionLogger"),e.AFrameworkApplication.fa.ka("WopiTokenRefreshSendTokenRequestWithoutTasks"),La.qb("Common.ISessionStatus"),e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1),e.AFrameworkApplication.fa.ka("WopiTokenRefreshSyncMessageWithTimeout")));La.register(714,"Common.ISessionExpirationManagerFactory").ma().oa(()=>
new mb(e.AFrameworkApplication.Aa,La.resolve("Common.App.SessionExpiration.ITokenRefreshManager"),La.resolve("Common.App.SessionExpiration.ISessionLogger"),La.qb("Common.ISessionStatus")));La.register(715,"Common.ISessionExpirationManagerWithDialog").ma().oa(()=>La.resolve("Common.ISessionExpirationManagerFactory").create());La.register(716,"Common.ISessionExpirationManager").ma().oa(()=>La.resolve("Common.ISessionExpirationManagerWithDialog"))}static main(){r.a.instance.Ac(new Zb)}}Object(h.a)(Zb,
"SessionExpirationPackage",null,[2,3]);var Oc=d(55),md=d(445),Ib=d(39),ud=d(154),od=d(120),Ud=d(139),Ad=d(63),be=d(28),uf=d(33),sd=d(30);class Ze extends Sc.a{constructor(La,sb){super();this.Nfa=null;this.Pek=!1;this.Qfk="";this.tNg=this.uNg=this.Myg=this.Nyg=null;this.Ad=3;this.Oe(1,ResourceStrings.L_SetSlideOrientationMaximize);this.Oe(2,ResourceStrings.L_SetSlideOrientationEnsure);this.ia=La;this.lOg=sb.qk(Ad.a.YNk)}dispose(){this.Nfa=null;super.dispose()}showDialog(La){this.pj(La);this.Nyg=document.getElementById("btnMaximize");
this.uNg=Object(B.a)(this,this.gHk,"onScaleUpButton");w.a.addHandler(this.Nyg,"click",this.uNg);this.Myg=document.getElementById("btnEnsure");this.tNg=Object(B.a)(this,this.fHk,"onScaleDownButton");w.a.addHandler(this.Myg,"click",this.tNg)}pj(La){this.Vqa=Object(B.a)(this,this.mol,"setSlideOrientationRatio");this.eza(La);this.rm.style.width="420px";this.show()}hide(){this.Ib&&(e.AFrameworkApplication.Aa.gx.Eo(od.AFrame.U5),super.hide())}gHk(La){this.ia.processAction(sd.a.atc,2);La.preventDefault();
this.RV&&this.hide()}fHk(La){this.ia.processAction(sd.a.$sc,2);La.preventDefault();this.RV&&this.hide()}mol(La){1===La?this.ia.processAction(sd.a.atc,2):2===La?this.ia.processAction(sd.a.$sc,2):be.a.J(25277209,822,50,"Cancle the slide orientation change.");this.RV&&this.hide()}eza(){this.Bu();this.VA()}Bu(){super.Bu();Sys.UI.DomElement.addCssClass(this.Ib,this.Qfk);var La=$get("WACDialogTitleText");La.innerText=ResourceStrings.l_SetSlideScaleTitle;La.setAttribute("title",ResourceStrings.l_SetSlideScaleTitle);
La=document.createElement("div");La.id=this.Uh("WACDialogHtmlPanel");La.className="WACDialogHtmlPanel";this.rm.appendChild(La);this.Nfa=document.createElement("div");this.Nfa.id=this.Uh("WACDialogText");La.appendChild(this.Nfa);La=document.createElement("div");La.id=this.Uh("Scalediv");La.className="WACDialogRow";this.Nfa.appendChild(La);var sb=document.createElement("label");sb.id=this.Uh("Scalelabel");sb.innerText=ResourceStrings.L_SetSlideOrientationInformation;La.appendChild(sb);La=document.createElement("div");
La.id=this.Uh("ScaleMode");La.setAttribute("style","margin-left: 20px;");La.className="WACDialogRow";this.Nfa.appendChild(La);sb=Ze.dPf(Ad.a.gfh+"_MaximizeFit_170x130x32",this.lOg,ResourceStrings.L_SetSlideOrientationMaximize);sb.id=this.Uh("btnMaximize");var Ob=document.createElement("td");Ob.className=String.format("clip{0}x{1}","170","130");Ob.setAttribute("style","border: #ccc 1px solid");Ob.appendChild(sb);sb=Ze.dPf(Ad.a.gfh+"_Ensurefit_170x130x32",this.lOg,ResourceStrings.L_SetSlideOrientationEnsure);
sb.id=this.Uh("btnEnsure");var pc=document.createElement("td");pc.className=String.format("clip{0}x{1}","170","130");pc.setAttribute("style","border: #ccc 1px solid");pc.appendChild(sb);var Kc=document.createElement("td");Kc.setAttribute("style","width: 30px;");sb=document.createElement("tr");sb.appendChild(Ob);sb.appendChild(Kc);sb.appendChild(pc);Ob=document.createElement("td");Ob.setAttribute("align","center");pc=document.createElement("label");pc.id=this.Uh("Maxlabel");pc.className="UIFontBold";
pc.innerText=ResourceStrings.L_SetSlideOrientationMaximize;Ob.appendChild(pc);pc=document.createElement("td");pc.setAttribute("align","center");Kc=document.createElement("label");Kc.id=this.Uh("Ensurelabel");Kc.className="UIFontBold";Kc.innerText=ResourceStrings.L_SetSlideOrientationEnsure;pc.appendChild(Kc);const Gd=document.createElement("td");Gd.setAttribute("style","width: 30px;");Kc=document.createElement("tr");Kc.appendChild(Ob);Kc.appendChild(Gd);Kc.appendChild(pc);Ob=document.createElement("table");
Ob.appendChild(sb);Ob.appendChild(Kc);La.appendChild(Ob)}VA(){this.Bud(Sc.a.Coc+(Sc.a.hP-Ze.Vti)/2-12,Sc.a.Boc+(Sc.a.TR-Ze.$ti)/2-12)}Bud(La,sb){this.Ib.style.top=(0>La?0:La)+"px";uf.a("DeprecateIE.SetSlideOrientation")?this.Ib.style.left=(0>sb?0:sb)+"px":Oc.a.rcb&&e.AFrameworkApplication.isRtl?this.Ib.style.right=(0>sb?0:sb)+"px":this.Ib.style.left=(0>sb?0:sb)+"px";this.Pek||(this.Ib.style.width=String.format("{0}em",this.width));this.Ib.style.display="Block"}static dPf(La,sb,Ob){const pc=document.createElement("img");
pc.className=La;pc.setAttribute("Unselectable","on");pc.setAttribute(Ud.a.hf,Ud.a.iQ);pc.src=sb;Ob&&(pc.alt=Ob,pc.title=Ob);return pc}}Ze.$ti=350;Ze.Vti=200;Object(h.a)(Ze,"SetSlideOrientationDialog",Sc.a,[]);var Ke=d(52),hf=d(111),Xa=d(237),Bb=d(70);class mc extends N.a{constructor(La,sb){super(!1,!1,!0);this.uNf=this.I3=null;if(!La)throw Error.argumentNull("actionManager");if(!sb)throw Error.argumentNull("presentationReader");this.ia=La;this.oc=sb}BFa(){this.I3=Object(B.a)(this,this.nol,"setSlideSizeAndLayoutDialogResultHandler");
this.uNf=this.s9i(this.getCurrentSlideDimensions());this.pj(ResourceStrings.L_SetSlideSize,this.I3,this.uNf)}nol(La,sb){1===La&&this.ia.Ka(sd.a.kyh,2,sb);this.dispose()}getCurrentSlideDimensions(){const La=this.oc.Ou(),sb={};sb.height=La.height;sb.width=La.width;sb.slideType=this.oc.Hsj();return sb}s9i(La){return{["id"]:"SlideSizeAndLayoutDialog",["bodyControls"]:La,["numberFormatInfo"]:Bb.e().numberFormatInfo}}}Object(h.a)(mc,"SlideSizeAndLayoutDialog",N.a,[]);class Qc{constructor(La,sb,Ob,pc,Kc,
Gd,he,Ue,Rf){this.YIa=this.Cna=this.IU=0;this.slideSizeType="O_screen4x3 O_letterPaper O_A4paper O_35mm O_overhead O_banner O_custom O_ledgerPaper O_A3Paper O_B4ISOPaper O_B5ISOPaper O_B4JISPaper O_B5JISPaper O_HagakiCard O_screen16x9 O_screen16x10 O_Widescreen".split(" ");this.vDh=[4320,4320,4320,4320,4320,576,4896,5754,6048,5115,3387,5184,3456,1872,3240,3600,4320];this.JDh=[5760,5760,6240,6480,5760,4608,6336,7672,8064,6820,4516,6912,4608,2880,5760,5760,7680];this.ia=La;this.Fa=sb;this.qf=Ob;this.Eb=
pc;this.Tb=Kc;this.ta=Gd;this.pa=Ue;this.oc=he;this.ke=Rf}vb(){this.ia.ra(sd.a.Bnd,Ke.a.application,Object(B.a)(this,this.xSe,"querySlideSize"),96);this.ia.ra(sd.a.znd,Ke.a.application,Object(B.a)(this,this.xSe,"querySlideSize"),96);this.ia.ra(sd.a.ySe,Ke.a.application,Object(B.a)(this,this.xSe,"querySlideSize"),96);this.ia.ya(sd.a.pol,Ke.a.application,md.a.oH);this.ia.ra(sd.a.vWk,Ke.a.application,md.a.z1,96);this.ia.ra(sd.a.ctc,Ke.a.application,Object(B.a)(this,this.qFj,"handleSetSlideSize"),4);
this.ia.ra(sd.a.Psd,Ke.a.application,Object(B.a)(this,this.sFj,"handleSetSlideSize4x3"),4);this.ia.ra(sd.a.Osd,Ke.a.application,Object(B.a)(this,this.rFj,"handleSetSlideSize16x9"),4);this.ia.ra(sd.a.CNe,Ke.a.application,Object(B.a)(this,this.c8j,"launchSlideSizeAndLayoutDialogHandler"),4);this.ia.ra(sd.a.VJk,Ke.a.application,Object(B.a)(this,this.Kug,"launchSetSlideOrientationScaleTypeDialogHandler"),4);this.ia.ra(sd.a.WJk,Ke.a.application,Object(B.a)(this,this.Kug,"launchSetSlideOrientationScaleTypeDialogHandler"),
4);this.ia.ra(sd.a.atc,Ke.a.application,Object(B.a)(this,this.jyh,"setSlideOrientationHandler"),4);this.ia.ra(sd.a.$sc,Ke.a.application,Object(B.a)(this,this.jyh,"setSlideOrientationHandler"),4);this.ia.ra(sd.a.kyh,Ke.a.application,Object(B.a)(this,this.ool,"setSlideSizeAndLayoutHandler"),4);this.ia.ya(sd.a.qol,Ke.a.application,md.a.oH);this.ia.ya(sd.a.setSlideHeight,Ke.a.application,md.a.oH);this.ia.ra(sd.a.xWk,Ke.a.application,md.a.z1,96);this.ia.ra(sd.a.wWk,Ke.a.application,md.a.z1,96);this.ia.ya(sd.a.Szl,
Ke.a.application,md.a.oH);this.ia.ya(sd.a.Rzl,Ke.a.application,md.a.oH)}pe(){}xSe(La,sb,Ob,pc,Kc){be.a.J(34936782,822,50,"Click slide size drop down.");if(sb.contextId!==Ke.a.application)return 2;if(sb=Object(Ub.a)(hf.a,Kc))La=Qc.jVj(this.oc.Ou(),La),sb.Hf(La);return 32}c8j(La,sb,Ob){sb=this.ta.Ba;return!sb||this.qf.$c(sb)||!uf.a("DeprecateIE.CustomizeSlideSizeActor")&&Oc.a.Ex?8:1===Ob?32:ud.a("CustomizeSlideSizeActor::LaunchSetSlideSizeAndLayoutDialogHandler ",La,()=>{(new mc(this.ia,this.oc)).BFa();
be.a.J(557158615,822,50,"Open set slide size and layout dialog.");return 32})}Kug(La,sb,Ob,pc,Kc){La=this.ta.Ba;if(!La||this.qf.$c(La))return 16;if(1===Ob)return 32;if("slideType"in Kc&&"slideWidth"in Kc&&"slideHeight"in Kc)if(this.YIa=6,"o_custom"===Kc.slideType.toString().toLowerCase())this.IU=6*Math.round(Kc.slideWidth),this.Cna=6*Math.round(Kc.slideHeight);else{Ob=0;for(const Gd of this.slideSizeType){if(Kc.slideType.toString().toLowerCase()===Gd.toLowerCase()){this.YIa=Ob;break}Ob++}"landscape"===
Kc.orientation.toString()?(this.Cna=this.vDh[Ob],this.IU=this.JDh[Ob]):(this.IU=this.vDh[Ob],this.Cna=this.JDh[Ob])}(new Ze(this.ia,this.ke)).showDialog(ResourceStrings.l_SetSlideScaleTitle);be.a.J(34936786,822,50,"Open set slide scale type dialog.");return 32}qFj(La,sb,Ob){La=this.ta.Ba;return!La||this.qf.$c(La)?8:this.ia.processAction(sd.a.y9a,Ob)}sFj(La,sb,Ob){be.a.J(34936788,822,50,"click set slide size 4:3.");sb=this.ta.Ba;if(!sb||this.qf.$c(sb))return 16;if(1===Ob||960===this.oc.Ou().width)return 32;
this.IU=5760;this.Cna=4320;this.YIa=0;return this.VNb(this.IU,this.Cna,La,this.YIa,"EnsureFit")}rFj(La,sb,Ob){be.a.J(34936792,822,50,"click set slide size 16:9.");sb=this.ta.Ba;if(!sb||this.qf.$c(sb))return 16;if(1===Ob)return 32;Ob=this.oc.Ou();if(1280===Ob.width)return 32;this.IU=7680;this.Cna=4320;this.YIa=16;return 960===Ob.width&&720===Ob.height?this.VNb(this.IU,this.Cna,La,this.YIa,""):this.VNb(this.IU,this.Cna,La,this.YIa,"EnsureFit")}ool(La,sb,Ob,pc,Kc){sb=this.ta.Ba;return!sb||this.qf.$c(sb)?
8:1===Ob?32:this.VNb(Kc.width,Kc.height,La,Kc.slideType,Kc.slideScaleType)}jyh(La,sb,Ob){sb=this.ta.Ba;return!sb||this.qf.$c(sb)?16:1===Ob?32:this.Cna&&this.IU?La===sd.a.atc?this.VNb(this.IU,this.Cna,La,this.YIa,"Maximize"):La===sd.a.$sc?this.VNb(this.IU,this.Cna,La,this.YIa,"EnsureFit"):32:(be.a.J(34936796,822,10,"CustomizeSlideSizeActor::SetSlideOrientationHandler fail to get slide width/height."),8)}VNb(La,sb,Ob,pc,Kc){const Gd=this.ta.Ba;let he=!1;if(Gd){var Ue=Gd.Uj();if(Ue&&0<Ue.length)for(const Rf of Ue)if(Rf.SFa){he=
!0;break}}Ue=this.Eb.xd(15,void 0,()=>{this.Fa.Bd();this.pa.nh()});try{Ue.ld(Gd),Ue.fd=Ob,Ue.py[Xa.a.tzb]=he,Gd.setValue(Ib.a.slideWidth,La),Gd.setValue(Ib.a.slideHeight,sb),Gd.setValue(Ib.a.slideScaleType,Kc),Gd.setValue(Ib.a.slideSizeType,pc)}finally{Ue&&Ue.dispose()}be.a.J(34936798,822,50,"Set slide width: {0}, height: {1}, scale type: {2}.",La,sb,Kc);this.qf.H0b(this.Tb.Ef,Gd,Ob);return 32}static jVj(La,sb){La=La.width/La.height;switch(sb){case sd.a.Bnd:return.01>Math.abs(La-1.33);case sd.a.znd:return.01>
Math.abs(La-1.77);default:return!1}}}Object(h.a)(Qc,"CustomizeSlideSizeActor",null,[251]);class td{}td.orh=0;td.Zal=22711;Object(h.a)(td,"ImageConstants",null,[]);var Md=d(234),Pd=d(329),Be=d(450),fe=d(43),Mf=d(104),Bd=d(245),Rc=d(110);class Gf extends Rc.a{constructor(){super();this.ImageToken=null;this.ErrorCode=0}pl(){return 78}}Object(h.a)(Gf,"NotifyImageUploadFailureRequest",Rc.a,[]);class Nf{constructor(La,sb,Ob,pc,Kc,Gd,he,Ue,Rf,sf,ag,xg,Tg,li,Li,Le,Ih,bj,zh,jj,Sh,ya,Ra){this.G5=this.gXa=this.Mw=
null;this.DHb=!1;this.VFk=(hb,Eb)=>{(hb=v.a.instance.Ia("Common.ISystemInitiatedFeedback"))&&Eb&&Eb.z0j&&hb.execute(Yb=>{Yb.logActivity("InsertPicture",null)})};this.ia=La;this.kb=Ob;this.$b=sb;this.ta=Kc;this.Eb=Gd;this.Fa=pc;this.NB=he;this.vR=Ue;this.xk=Rf;this.tCe=sf;this.Rq=ag;this.Ud=xg;this.Gb=Tg;this.Tic=li;this.$gc=Li;this.VXa=Le;this.ai=Ih;this.hj=bj;this.Ea=zh;this.ul=jj;this.Ic=Sh;this.vU=zh.sKb;this.Ga=ya;this.Fjk=null===Ra||void 0===Ra?void 0:Ra.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.Pictures.InsertPictureFloodgateSurveyEnabled",
!1);this.Gt()}Gt(){this.Fjk&&this.Ic.Rgi(this.VFk)}vb(){this.ia.ra(sd.a.insertPicture,L.a.application,Object(B.a)(this,this.dfg,"handleInsertPicture"),4);this.ia.ra(sd.a.HSc,L.a.view,Object(B.a)(this,this.tGj,"handleUploadPictureAll"),4);this.ia.ra(sd.a.dMc,L.a.application,Object(B.a)(this,this.Vzj,"handleChangePicture"),4);this.ia.ra(sd.a.Lpd,L.a.application,Object(B.a)(this,this.OEj,"handleResetPicture"),4);this.ia.ra(sd.a.mrh,L.a.application,Object(B.a)(this,this.PEj,"handleResetPictureAndSize"),
4);this.ia.ra(sd.a.nrh,L.a.application,Object(B.a)(this,this.QEj,"handleResetPictureSplitButton"),4);this.ia.ra(sd.a.wsa,L.a.application,Object(B.a)(this,this.Wzj,"handleChangePictureStyle"),4);this.ia.ra(sd.a.r4d,L.a.application,Object(B.a)(this,this.dfg,"handleInsertPicture"),4);this.ia.ra(sd.a.iVf,L.a.application,Object(B.a)(this,this.KAj,"handleDragAndInsertImage"),4)}pe(){}dfg(La,sb,Ob){this.Ea.Eng&&!uf.a("DummyChangeGateForTest")&&be.a.J(512500500,830,100,"HandleInsertPicture::DummyChangeGateForTest is disabled");
sb=this.ta.Ba;sb=this.Ea.q2c&&!!sb&&!this.$b.$c(sb);sb=(this.$gc=this.Tic.HTj()&&this.$gc)?sb&&!!this.NB&&this.NB.Myd:this.vR.hog&&sb;if(!sb)return 16;if(1===Ob)return 32;this.DHb=!0;this.G5=this.ta.Ba;this.wud(La!==sd.a.r4d,!0);return 32}tGj(La,sb,Ob,pc,Kc){var Gd=this.ta?this.ta.Ba:null;if(!Gd||!Gd.isConnected)return 16;if(!this.hj.iD(Gd,1))return this.hj.KD(Gd),16;be.a.J(512500497,822,50,"Start picture upload");sb=Nf.g4j(Kc);(pc=fe.a.Kb)&&pc.Wa(Mf.a.zQj,sb?"1":"0");this.Ic.b_k();let he=!1;if(this.DHb&&
this.$gc&&!this.NB.Hlb&&this.pZj(sb)){if(Gd=Gd.C_(this.kb.Xd())){if(15!==Gd.Qj){const Ue=Gd.ZR;Ue.BottomLeft.X!==Ue.TopLeft.X&&(he=!0)}pc&&pc.Wa(Mf.a.gdl,he?"1":"0")}Gd&&(15===Gd.Qj||he)?(pc&&pc.Wa(Mf.a.N6d,he?"PlaceHolder Rotated":"Picture Type PlaceHolder"),La=this.fgg(La,Ob,Kc)):La=this.vGj(La,Ob,Kc)}else this.NB.Hlb=!1,La=this.fgg(La,Ob,Kc);sb&&32===La&&be.a.J(512500496,822,50,"Upload a svg file successfully.");return La}pZj(La){return La?this.Ea.powerPointInsertSVGFileLocalRenderingEnabled:!0}KAj(La,
sb,Ob,pc,Kc){if(!this.NB.DOk)return be.a.J(512500495,822,15,"PictureActor::HandleDragAndInsertImage - PictureUploadLargeImageEnabled is false"),16;if(!Kc)return 16;La=[];sb=0;Ob=!1;for(const Gd of Kc)if(sb++,"string"===typeof Gd.type)if(Kc=I.a.rg(Gd.type),be.a.J(512500494,822,50,"PictureActor::HandleDragAndInsertImage - No.{0} file  Size In Bytes:{1}; Tpye:{2} ",sb,Gd.size,Kc),0<=Kc.indexOf("image")&&0===this.NB.dzd(Gd.name))if(La.length<this.Ea.powerPointDragInsertMultipleImageQuantityLimit)Array.add(La,
Gd);else{this.ul.rL(19);break}else Ob||(this.ul.rL(18),Ob=!0);if(1>La.length)return be.a.J(512500493,822,15,"PictureActor::HandleDragAndInsertImage - unlegal image format"),16;this.NB.QWi(La);return 32}fgg(La,sb,Ob){if(!(this.ta&&this.ta.Ba&&this.NB))return 16;if(1===sb)return 32;this.vR.Rib=new Date;this.DHb&&this.kb.kj();this.Fa.Bd();this.$b.blockContent(this.ta.presentation,La);const pc=fe.a.Kb;this.NB.I3e(Ob,Kc=>{fe.a.SI(pc,()=>{be.a.J(512500492,822,50,"Picture upload successful");this.uDj(Ob,
Kc,La);this.f2f()})},Kc=>{be.a.J(512500491,822,10,"Upload picture failed");this.D9b(Kc.error);this.f2f()});return 32}vGj(La,sb,Ob){if(!(this.ta&&this.ta.Ba&&this.NB))return 16;if(1===sb)return 32;const pc=String.format("{0}{1}","client",cc.a.create().toString());be.a.J(512500490,822,50,"Client generated imageToken:{0}, imageSize:{1}",pc,Ob.NL);this.vR.spi(pc);const Kc=fe.a.Kb;Kc&&(sb="InsertPicture",this.DHb||(sb="ChangePicture"),Kc.actionName=sb,Kc.Oj=!0);const Gd=new Date;fe.a.Ak("PictureUploadStart",
fe.a.uf(Gd));fe.a.Ak("ImageSize",Ob.NL.toString());fe.a.Ak("ImageToken",pc);const he=this.ta.Ba.sid;this.ia.Ka(sd.a.Iie,2,he);this.NB.I3e(Ob,Ue=>{fe.a.SI(Kc,()=>{be.a.J(512500489,822,50,"Upload picture completed");fe.a.Ak("PictureUploadDurationMS",(+new Date-+Gd).toString());this.COk(pc,Ue);this.ia.Ka(sd.a.o_c,2,he)})},Ue=>{this.vR.dXf(pc);var Rf=Object.assign(new Gf,{ImageToken:pc,ErrorCode:Ue.error.Code});Kc&&Kc.Wa("UploadPictureErrorCode",Md.a[Rf.ErrorCode]);Rf=new Bd.a(Rf,null,()=>Nf.rFk());this.ai.Hb(Rf);
be.a.J(512500488,822,10,"Upload picture failed, ImageToken:{0}, ErrorCode:{1}, Error Message:{2}",pc,Md.a[Ue.error.Code],Ue.error.Message);this.ia.Ka(sd.a.o_c,2,he)},pc);this.insertPicture(pc,La,Ob);return 32}Vzj(La,sb,Ob){La=this.vU?this.V$a():this.jyb();if(!(this.vU?this.Kbc(La):this.r2c(La)&&this.Ea.q2c&&this.vR.hog&&!this.$b.$c(La)))return 16;if(1===Ob)return 32;this.DHb=!1;this.wud(!0,!1);return 32}OEj(La,sb,Ob){return this.wsa(sb,Ob,td.orh,La)}PEj(La,sb,Ob){return this.wsa(sb,Ob,td.Zal,La)}QEj(La,
sb,Ob,pc,Kc){return this.wsa(sb,1,Kc,La)}Wzj(La,sb,Ob,pc,Kc){return this.wsa(sb,Ob,Kc,La)}wsa(La,sb,Ob,pc){const Kc=this.kb.Xd();if(!(Kc&&0<Kc.length))return 8;La=[];if(uf.a("FixForPictureAndGraphicsStyleForGrpShapes"))this.Lqj(Kc,La);else for(const he of Kc){if(this.Tpg(he)||this.$b.$c(he))return 8;(this.vU?this.Kbc(he):this.r2c(he))&&La.push(he)}if(0>=La.length)return 8;if(1===sb)return 32;be.a.J(512500487,822,15,"PictureStyle change started. PictureStyleId: '{0}'",Ob);sb=fe.a.Kb?fe.a.Kb.actionName:
null;for(var Gd of La)this.VSa(Gd);Gd=this.Eb.xd(15,void 0,()=>{this.kb.kj();this.Fa.Bd()});try{Gd.hc(La[0]);Gd.fd=pc;for(const he of La)he.Qib=Ob}finally{Gd&&Gd.dispose()}if(pc=fe.a.Kb)sb&&(pc.actionName=sb),pc.Wa("PictureStyleId",Ob.toString()),fe.a.Jaa(pc);return 32}Lqj(La,sb){let Ob=!1;for(const pc of La){if(!pc||this.Tpg(pc)||this.$b.$c(pc))return;pc.Ug&&(Ob=!0)}if(Ob)for(const pc of La)pc.Ug&&this.Kbc(pc)&&sb.push(pc);else for(const pc of La)if(this.Kbc(pc))sb.push(pc);else if(pc.Of){La=this.Ga.yx(pc);
for(const Kc of La)this.Kbc(Kc)&&sb.push(Kc)}}uDj(La,sb,Ob){this.vR.G_a=new Date;const pc=sb.result;if(La){if(this.DHb?(sb="InsertPicture",this.eQj(pc,La,Ob)):(sb="ChangePicture",uf.a("ChangePictureOnMultiSelectFixEnabled")?this.jyi(pc,La,Ob):this.kyi(pc,La,Ob)),La=fe.a.Kb)La.actionName=sb,La.Wa("PictureUploadStart",fe.a.uf(this.vR.Rib)),La.Wa("PictureUploadDurationMS",(+this.vR.G_a-+this.vR.Rib).toString())}else La=Object.assign(new Pd.a,{Code:94}),this.D9b(La)}COk(La,sb){this.vR.dXf(La);sb.result||
be.a.J(512500486,822,50,"Upload picture completed with null response")}eQj(La,sb,Ob){const pc=this.ta.Ba;if(pc&&pc.isConnected){this.gXa=pc.C_(this.kb.Xd());var Kc=this.Eb.xd(15,void 0,void 0,()=>{this.kb.selectShape(this.Mw,!0);this.Fa.Bd()});try{Kc.hc(pc),Kc.fd=Ob,Kc.py[Xa.a.mka]=Xa.a.A2f,this.Mw=this.xk.QKi(pc.Db),this.gXa&&(this.Mw.v8=this.gXa.id),this.Mw.JNb(La.ItemId,this.Ea.Wua?null:sb.fileName,sb.fileName),pc.jB(this.Mw)}finally{Kc&&Kc.dispose()}this.$b.tsa(this.ta.Ba,this.Mw,this.Gb.Na,"InsertPictureAfterUpload");
this.Rq.lA=this.Mw}}jyi(La,sb,Ob){var pc=this.kb.Xd();if(pc){var Kc=[];for(const Gd of pc)Gd.Of||Kc.push(Gd);for(const Gd of Kc)this.VSa(Gd);pc=this.Eb.xd(15);try{pc.fd=Ob;pc.hc(Kc[0]);for(const Gd of Kc)Gd.v8=Gd.id,this.Ea.Wua?(Gd.JNb(La.ItemId,null,sb.fileName),Gd.set_alt("")):Gd.JNb(La.ItemId,sb.fileName,sb.fileName)}finally{pc&&pc.dispose()}for(const Gd of Kc)this.$b.tsa(this.ta.Ba,Gd,this.Gb.Na,"ChangePictureAfterUpload")}}kyi(La,sb,Ob){const pc=this.vU?this.V$a():this.jyb();if(pc){this.VSa(pc);
var Kc=this.Eb.xd(15);try{Kc.fd=Ob,Kc.hc(pc),pc.v8=pc.id,this.Ea.Wua?(pc.JNb(La.ItemId,null,sb.fileName),pc.set_alt("")):pc.JNb(La.ItemId,sb.fileName,sb.fileName)}finally{Kc&&Kc.dispose()}this.$b.tsa(this.ta.Ba,pc,this.Gb.Na,"changePictureAfterUploadSingleImage")}}D9b(La){this.vR.G_a=new Date;be.a.J(512500484,822,50,"Upload picture failed");this.Ud.nH(La.Code,sb=>{sb.KC=1;sb.bTa=La.ExtraErrorParam;return!1})}f2f(){this.$b.xK(this.ta.presentation)}wud(La,sb){this.tCe?Be.a(ResourceStrings.l_GenericDialogTitle,
CommonUIStrings.l_NeedToSignIn,null):this.NB&&(this.NB.P4c=this.$gc,this.NB.kRb=0,La&&this.NB.Mih(sb))}jyb(){const La=this.kb.Xd();for(const sb of La)if(sb&&sb.qj)return sb;return null}V$a(){const La=this.kb.Xd();return La&&La.length?this.fVd(La)?La[0]:this.jyb():null}fVd(La){if(!La||!La.length)return!1;let sb=La[0].qj,Ob=1===La[0].mediaType;for(const pc of La)sb=sb&&pc.qj,Ob=Ob&&1===pc.mediaType;return sb||Ob}rk(La){return La?Object(Ub.a)(119,La.qc(this.Gb.Na)):null}VSa(La){La&&La.Lv&&(La=this.rk(La))&&
La.PY(!1)}r2c(La){return this.ta&&this.ta.Ba&&La&&La.qj?!0:!1}Kbc(La){return this.ta&&this.ta.Ba&&La&&(La.qj||1===La.mediaType)?!0:!1}Tpg(La){return this.ta&&this.ta.Ba&&La&&La.pp?!0:!1}insertPicture(La,sb,Ob){var pc=this.ta.Ba;const Kc=Object(Ub.a)(340,pc.qc(this.Gb.Na)),Gd=this.G5.Db;if(pc&&pc.isConnected&&Kc&&this.G5&&this.G5.isConnected){pc=this.G5.zs();this.gXa=this.G5.C_(this.kb.Xd());var he,Ue;({V6d:Ue,kC:he}=this.VXa.k_d(this.gXa,Ob.imageWidth,Ob.imageHeight));var Rf=this.Eb.xd(15,void 0,
()=>{this.kb.au();this.kb.nh();this.Fa.Bd()},()=>{this.Rq.lA=this.Mw;this.kb.selectShape(this.Mw,!0)});try{Rf.hc(this.G5);Rf.fd=sb;this.Mw=this.xk.Uja(!0,Gd.cid,Gd.sid,0,he.x,he.y,Ue.width,Ue.height,pc+1,!1);const sf=this.VXa.tWd(this.Gb.Md,Ue,he,Kc.UT);this.Mw.ZR=sf;this.gXa&&(this.Mw.v8=this.gXa.id,this.G5.YR([this.gXa]));this.Mw.JNb(La,this.Ea.Wua?null:Ob.fileName,Ob.fileName);this.Mw.isResizable=!0;this.Mw.rbc=!0;this.Mw.YL=!0;this.Mw.FJa=!0;this.Mw.qj=!0;this.Mw.Uwb=!!Ob.GIb;this.Mw.Lea=Ob.GIb||
Ob.yZc;this.G5.jB(this.Mw)}finally{Rf&&Rf.dispose()}fe.a.f8e()}}static g4j(La){return!!La&&!!La.fileName&&La.fileName.toLowerCase().indexOf(".svg")===La.fileName.length-4}static rFk(){be.a.J(512500483,822,50,"NotifyImageUploadFailureRequest failed");return!0}}Object(h.a)(Nf,"PictureActor",null,[251]);var Oa=d(115),cb=d(201),Ic=d(734),qd=d(925),le=d(86);class yb extends Sys.EventArgs{constructor(La,sb){super();this.J0j=La;this.p3c=sb}}Object(h.a)(yb,"TokenRefreshEventArgs",Sys.EventArgs,[]);class ef{constructor(La,
sb,Ob,pc,Kc,Gd,he){this.xHb=0;this.Mc=La;this.xFe=sb;this.su=Ob;this.ia=pc;this.Xo=Kc;this.wb=Gd;this.Ea=he;this.xFe&&this.xFe.jJc(Object(B.a)(this,this.jch,"onTokenRefreshed"))}vYd(La){!this.Ea.podTokenRefreshImprovementEnabled&&this.wb.tua&&this.wb.rLa();const sb=$b.a.instance.tGa(e.AFrameworkApplication.um),Ob=$b.a.instance.U2c(e.AFrameworkApplication.um,e.AFrameworkApplication.Xia);be.a.J(41562886,801,sb||Ob?15:50,"SessionRehydrationController::CheckAccessTokenExpiry - IsExpired:{0}, IsExpiring:{1}, Trigger:{2}, Improvement:{3}, RetryCount:{4}",
sb,Ob,La,this.Ea.podTokenRefreshImprovementEnabled,this.xHb);$b.a.instance.s8a();this.Ea.podTokenRefreshImprovementEnabled&&this.wb.tua&&this.wb.rLa()}jch(La,sb){be.a.J(41562888,809,50,"PPTTokenRefreshManager::OnTokenRefreshed");try{const Ob=Object(Ub.a)(Jb,sb)||new Jb(null,null),pc=Ob.tokens,Kc=Ob.errors;La="";if(void 0===Kc||null===Kc||0>=Kc.count)for(sb=0;sb<pc.count;sb++)if(pc.ga(sb).Name===Hc.a.Bil){const he=pc.ga(sb)?pc.ga(sb):null;La=he&&he.Value&&0<he.Value.length?he.Value:"";break}const Gd=
$b.a.instance.tGa(e.AFrameworkApplication.um);be.a.J(540366599,809,50,"PPTTokenRefreshManager::OnTokenRefreshed fTokenExpired:{0} m_applicationSettings.PPTOTokenRefreshRetryEnabled:{1} m_tokenRefreshRetryCount:{2} m_applicationSettings.PPTOTokenRefreshRetryLimit:{3}",Gd,this.Ea.cQe,this.xHb,this.Ea.fhh);if(0<La.length&&Gd&&this.Ea.cQe&&this.xHb<this.Ea.fhh)be.a.J(51205124,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token refreshed successfully but is expired. NowTicket:{0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime:{3}, RetryEnabled:{4}, CurrentRetryCount:{5}",
(new Date).getTime(),new Date,e.AFrameworkApplication.um,new Date(e.AFrameworkApplication.um),this.Ea.cQe,this.xHb),this.xHb++,this.vYd(2);else if(0<La.length&&!Gd){be.a.J(41562890,809,Gd?15:50,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed successfully, NowTicket:{0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime:{3}",(new Date).getTime(),new Date,e.AFrameworkApplication.um,new Date(e.AFrameworkApplication.um));cb.App.R$d=e.AFrameworkApplication.cwb=I.a.Qe(La);const he=this.su.epc.presentationId.W3e+
"&access_token="+encodeURIComponent(e.AFrameworkApplication.accessToken)+"&access_token_ttl="+encodeURIComponent(e.AFrameworkApplication.um.toString());this.su.epc=new qd.a(new Ic.a(he));this.Mc.dlh(new yb(this.Xo?this.Xo.z_:!1,!0))}else{if(uf.a("CleanPIIFromC49mm")&&Kc)for(let he of Kc)if(he.Errors)for(const Ue of he.Errors)"403"===Ue.Id&&Ue.Details&&Ue.Details.startsWith("<")&&(Ue.Details=null);be.a.J(41562892,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed failed, errors: {0}, RetryCount:{1}",
Kc?Oa.c(Kc):"There is no error in Refreshed Token, but GetFileUrl is empty",this.xHb);Kc&&0<=Oa.c(Kc).indexOf("The caller is not authenticated")?(e.AFrameworkApplication.Oo(le.a.Oh(383)),xc.Health.instance.recordQosError("WopiTokenRefreshFailedOnHostUnauth",["SessionExpired"],!1,!0,!1,!0,null)):(e.AFrameworkApplication.Oo(le.a.Oh(380)),xc.Health.instance.recordQosError("WopiTokenRefreshFailed",["SessionExpired"],!1,!0,!0,!0,null));e.AFrameworkApplication.fv&&e.AFrameworkApplication.fv.P8();this.Mc.dlh(new yb(this.Xo?
this.Xo.z_:!1,!1));this.ia.Ka(sd.a.refresh,2,{refreshtrigger:"PPTTokenRefreshManager::OnTokenRefreshed"})}}catch(Ob){be.a.J(41562894,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed failed and throw exception, exception: {0}",Oa.c(Ob))}}dispose(){this.xFe.DVe(Object(B.a)(this,this.jch,"onTokenRefreshed"))}}Object(h.a)(ef,"PPTTokenRefreshManager",null,[680]);var Cb=d(87),oc=d(659);class vc{constructor(La,sb,Ob,pc,Kc,Gd){this.qY=this.nUl=this.kWe=null;this.R5b=this.i7d=!1;this.Red=
0;this.Ynb=fe.a.kk("SeamlessFailover");1!==sb&&2!==sb||fe.a.zGa();this.Kj=new Date;fe.a.pCb=this.startTime;this.M3h=Ob;this.aSa=0;this.E5h=sb;this.lYh=pc;this.w4h=Kc;this.rIl=Gd;this.G2i=!1;this.resultCode=0;this.Zff=!0;if(La=e.AFrameworkApplication.Od)this.Vc.Wa("Host",Object(Ub.a)(String,La.Host)),this.Vc.Wa("Ring",Object(Ub.a)(String,La.Ring))}Cyh(La,sb){this.Red=window.setTimeout(La,sb)}BBl(){this.Zff=!1}dispose(){fe.a.$cc=new Date;0<=this.Red&&(window.clearTimeout(this.Red),this.Red=-1)}get D2i(){return this.Zff}get Vc(){return this.Ynb}get startTime(){return this.Kj}get iKk(){return this.M3h}get Bya(){return this.E5h}get S1i(){return this.lYh}get podsCleaningRequestPattern(){return this.w4h}}
Object(h.a)(vc,"SeamlessFailoverState",null,[107]);const nd=La=>{La=String.format("{0}/PodHandler.ashx?action=TriggerFontsInstallation&PodsID={1}",e.AFrameworkApplication.fa.Ha("361"),La);e.AFrameworkApplication.Me.iW(La,1,null,null,null,0,()=>{be.a.J(512263E3,801,50,"CustomFontHelper::TriggerFontsInstallation - Succeeded")},()=>{be.a.J(512262999,801,15,"CustomFontHelper::TriggerFontsInstallation - Failed to set document settings")},null)};var id;(function(La){La[La.unknown=0]="unknown";La[La.mouse=
1]="mouse";La[La.keyboard=2]="keyboard";La[La.podsPopsUnavailable=4]="podsPopsUnavailable"})(id||(id={}));Object(h.b)("RehydrationTrigger",id);var Nd=d(671),Ce=d(1002);class af{constructor(La,sb,Ob,pc,Kc,Gd,he,Ue,Rf,sf,ag,xg,Tg,li,Li,Le,Ih,bj,zh,jj,Sh,ya,Ra){this.Le=this.Uue=null;this.PHe=this.xfd=-1;this.sYg=0;this.hgb=La;this.la=sb;this.Tb=Ob;this.ia=pc;this.wb=Kc;this.GE=Gd;this.Ie=he;this.Ig=Rf;this.Bz=sf;this.Ud=ag;this.Ym=xg;this.li=Tg;this.pc=li;this.wR=Li;this.Su=bj;this.yFe=new Date;this.Rv=
Le;this.KB=Ih;this.ta=zh;this.Jb=jj;this.iic=Sh;Ra.execute(hb=>{this.Uue=hb});this.l8c=[];this.Ipk=this.Jb.wc("SeamlessFailoverMaxRetryAttempts",0);this.Hpk=this.Jb.ka("SeamlessFailoverIncludePopsInfoInFinalLog");this.Jpk=this.Jb.ka("SeamlessRehydrationAbortOnAbortedOnExitAppQosEnabled");be.a.J(512497885,809,50,"PodSeamlessFailoverManager::PodSeamlessFailoverManager()")}get z_(){return!!this.Le&&this.Le.D2i}get h_f(){return this.sYg}ARd(La){if(this.z_){e.AFrameworkApplication.jA&&(this.li.erc(Object(B.a)(this,
this.kga,"onWopiTokenRefreshed")),this.O1b());var sb=0;if(this.la.YAb)this.Le.Vc.oC("Result","abortedOnIrmProtectedFile"),sb=365;else if(this.Le.Vc.oC("Result",La),"abortedOnExitApp"!==La||this.Jpk)sb=4===this.Le.Bya?356:357;this.Okb(!1,sb,!this.Le.R5b&&"abortedOnRefreshDoc"!==La)}}l7e(La,sb,Ob){if(this.z_)be.a.J(512497884,801,15,"PodSeamlessFailoverManager::TriggerFailover skipped");else{e.AFrameworkApplication.fv||(e.AFrameworkApplication.fv=be.a.l3b());this.Ud.disabled=!1;this.Ud.jla=!1;this.Le=
new vc(La,sb,this.Ie.podSessionId,this.la.podsCleanPendingTasksAndRequestsWhenFailover,this.la.podsCleaningRequestPattern,Ob);this.la.wopiTokenRefreshLongerTimeoutIsEnable||this.Le.Cyh(Object(B.a)(this,this.k9g,"onFailoverTimeout"),this.la.podsSeamlessFailoverTimeoutDurationInMs);this.Le.Vc.Wa("PopsAvailable",this.Ig.rG.toString());this.Le.Vc.Wa("OrderlyShutdown",La.toString());this.Le.Vc.Wa("Trigger",id[sb]);this.Le.Vc.Wa("TriggerErrorCode",Md.a[Ob]);this.Le.Vc.Wa("OldPodsId",this.Le.iKk);this.Le.Vc.Wa("OldPopsId",
this.Ie.Uk);be.a.J(512497883,809,50,"PodSeamlessFailoverManager::TriggerFailover:ActionID:{0}; ActionDetails:{1}",this.Le.Vc.actionId,this.Le.Vc.bQb());if(1===sb||2===sb)e.AFrameworkApplication.Yg=!1,this.ta.presentation&&this.ta.presentation.QWe();this.li.sJc(Object(B.a)(this,this.kga,"onWopiTokenRefreshed"));e.AFrameworkApplication.jA&&$b.a.instance.s8a()?(be.a.J(512497882,809,15,"FileUrlExpired on TriggerFailover, NowTicket: {0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime: {3}",(new Date).getTime(),
new Date,e.AFrameworkApplication.um,new Date(e.AFrameworkApplication.um)),this.O1b(),this.xfd=window.setTimeout(Object(B.a)(this,this.iJk,"onWopiTokenRefreshTimeout"),this.la.wopiTokenRefreshTimeoutDuringRehydrationInMs),this.la.Ofh&&this.iic.d2f(!1)):(this.li.erc(Object(B.a)(this,this.kga,"onWopiTokenRefreshed")),this.LJh(sb))}}J2i(La){if(Array.contains(this.la.podTriggerFailoverOnServerErrorsCandidates,le.a.Oh(La).toString())){if(!this.l8c.length)return!0;const sb=new Date;let Ob=0;for(let pc=this.l8c.length-
1;0<=pc;pc--){const Kc=this.l8c[pc];if(+sb-+Kc.startTime>this.la.podTriggerFailoverOnServerErrorsLookbackWindowInMs)break;Kc.rIl===La&&Ob++}if(Ob<this.la.podTriggerFailoverOnServerErrorsMaxTry)return!0;be.a.J(512497881,809,10,"PodSeamlessFailoverManager::FTriggerFailoverForServerError - Failover for Error[{0}] has been triggered for {1} times within {2}ms. Skip.",La,Ob,this.la.podTriggerFailoverOnServerErrorsLookbackWindowInMs)}return!1}LJh(La){e.AFrameworkApplication.jA&&(this.li.erc(Object(B.a)(this,
this.kga,"onWopiTokenRefreshed")),this.O1b());if(++this.sYg>this.Ipk)this.Vee("SeamlessFailoverMaxRetryCountReached",392);else if(this.la.wopiTokenRefreshLongerTimeoutIsEnable&&this.Le.Cyh(Object(B.a)(this,this.k9g,"onFailoverTimeout"),this.la.podsSeamlessFailoverTimeoutDurationInMs),+new Date-+this.yFe>=36E5*this.la.powerPointPodRecoveryStorageAgeThreshold)this.Vee("RecoveryStreamExpired",358);else{if(this.Le.i7d&&(this.Le.Vc.oC("Trigger",id[La]+"_GetFileUrlExpired"),this.kTj())){this.Vee("GetFileUrlExpired_NoAzureBackup",
364);return}this.Le.S1i&&this.oAi();this.li.cod(new Nd.a(4===La?5:2));this.li.iZk();this.la.podsClosePopSessionBeforeSeamlessFailoverEnabled&&4===La&&(be.a.J(512497880,801,15,"PodSeamlessFailoverManager::TriggerFailover - Close PopSesion: {0}",this.Ie.Uk),this.wR.lub(()=>{},()=>{}));this.Ym.isPaused||this.Ym.pause();this.Le.Vc.vm("CreatePodsWithRetryST",new Date);this.Le.Vc.vm("SessionStartTime",this.yFe);this.bnh()}}Vee(La,sb){this.wb.tua&&this.wb.rLa();this.Le.Vc.oC("Result",La);this.Okb(!1,sb)}iJk(){this.li.erc(Object(B.a)(this,
this.kga,"onWopiTokenRefreshed"));this.O1b();be.a.J(512497879,809,50,"WopiTokenRefreshed timeout during TriggerFailover");this.Le.Vc.Wa("WopiTokenRefreshed","TO");e.AFrameworkApplication.Oo(le.a.Oh(382));xc.Health.instance.recordQosError("WopiTokenRefreshTimeoutOnRehydration",["SessionExpired"],!1,!0,!0,!0,null);e.AFrameworkApplication.fv&&e.AFrameworkApplication.fv.P8();this.Le.R5b=!0;this.ia.Ka(sd.a.refresh,2,{refreshtrigger:"PodSeamlessFailoverManager::OnWopiTokenRefreshTimeout"})}kga(La,sb){La=
sb.p3c;this.li.erc(Object(B.a)(this,this.kga,"onWopiTokenRefreshed"));this.O1b();this.la.Ofh&&this.iic.d2f(!0);sb=0<e.AFrameworkApplication.um&&(new Date).getTime()>=e.AFrameworkApplication.um-this.la.wopiTokenRefreshFileUrlExpiredBufferTimeInMs;be.a.J(512497878,809,50,"WopiTokenRefreshed during TriggerFailover, IsTokenRefreshedSuccessfully: {0}, NowTicket: {1}, NowDateTime:{2}, AccessTtl:{3}, AccessTtlDateTime: {4}",La,(new Date).getTime(),new Date,e.AFrameworkApplication.um,new Date(e.AFrameworkApplication.um));
this.Le.Vc.Wa("WopiTokenRefreshed","True");this.Le.Vc.Wa("WopiTokenRefreshedSuccessfully",La.toString());this.Le.i7d=sb;La?this.LJh(this.Le.Bya):this.Le.R5b=!0}O1b(){-1!==this.PHe&&(window.clearTimeout(this.PHe),this.PHe=-1);-1!==this.xfd&&(window.clearTimeout(this.xfd),this.xfd=-1)}kTj(){const La=I.a.rg(this.Jb.Ha("152")||""),sb=!e.AFrameworkApplication.Rg.IsRealEdit&&1!==this.Le.Bya&&2!==this.Le.Bya;return".pptx"!==La&&".ppsx"!==La||sb}oAi(){try{let La=0,sb=0;const Ob={},pc={};this.Su.X$h(Kc=>{if(-1<
Kc.request.get_url().search(new RegExp(this.Le.podsCleaningRequestPattern,"i")))return this.qJh(Ob,this.eag(Kc.request.get_url())),La++,!0;this.qJh(pc,this.eag(Kc.request.get_url()));sb++;return!1});be.a.J(512497877,801,15,"PodSeamlessFailoverManager::CleanPendingTasksAndRequests - abort {0} requests: {1}, remain {2} request: {3}",La,Ob,sb,pc)}catch(La){be.a.J(512497876,801,10,"PodSeamlessFailoverManager::CleanPendingTasksAndRequests failed. {0}",La)}}eag(La){let sb=La;const Ob=La.indexOf("?");0<
Ob&&(sb=La.substr(0,Ob));La=sb.lastIndexOf("/");0<La&&(sb=sb.substr(La+1));return sb}qJh(La,sb){La[sb]=sb in La?La[sb]+1:1}k9g(){this.z_&&(this.Le.Vc.oC("Result","Timeout"),this.Le.Vc.Wa("TimeoutDuration",(+new Date-+this.Le.startTime).toString()),this.Okb(!1,4===this.Le.Bya?354:355))}Okb(La,sb=0,Ob=!0){if(this.z_){this.Bz.fkb(Object(B.a)(this,this.fga,"onPodSessionRefreshed"));this.Tb.Di.contentReplicator.$qc(Object(B.a)(this,this.v7g,"onAfterReplication"));var pc=+new Date-+this.yFe>=6E4*this.la.pptEditorFileGetUrlExpireTimeInMinutes;
e.AFrameworkApplication.jA&&(pc=0<e.AFrameworkApplication.um&&(new Date).getTime()>=e.AFrameworkApplication.um-this.la.wopiTokenRefreshFileUrlExpiredBufferTimeInMs)&&be.a.J(512497875,809,15,"FileUrlExpired on SeamlessFailoverEnd, NowTicket: {0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime: {3}",(new Date).getTime(),new Date,e.AFrameworkApplication.um,new Date(e.AFrameworkApplication.um));La&&pc&&this.Le.Vc.Wa("SkipPopsReason","FileUrlExpired");this.pc.Hwg();var Kc=this.Le.Bya;this.Le.Vc.Wa("IsInEditingMode",
this.pc.Pn.toString());this.Le.Vc.Wa("IsPreviousModeEditing",this.pc.Pbc.toString());this.Le.Vc.Wa("IsLastKnownModeEditing",this.pc.loe.toString());this.Le.Vc.Wa("PopSessionEverInitialized",this.Ig.toc.toString());this.Le.Vc.Wa("ResultErrorCode",Md.a[sb]);this.Le.Vc.Wa("RefreshPage",Ob.toString());this.Le.Vc.Wa("FRehydrationInitiatedPageRefresh",this.Le.R5b.toString());this.Le.G2i=La;this.Le.resultCode=sb;this.Le.BBl();this.l8c.push(this.Le);this.Hpk||this.eTc();La?(this.li.Ekh(new Ce.a(Kc)),this.WJh(pc,
Kc)):(this.eTc(),0!==sb&&(La=le.a.Oh(sb),e.AFrameworkApplication.Oo(La),xc.Health.instance.recordQosError(le.a.ida(La),["UnexpectedAppRefresh"],399===sb,!1,!0,Ob,null)),Ob?(e.AFrameworkApplication.fv&&e.AFrameworkApplication.fv.P8(),this.ia.Ka(sd.a.refresh,2,{refreshtrigger:"PodSeamlessFailoverManager::SeamlessFailoverEnd"})):(this.li.Ekh(new Ce.a(Kc)),this.WJh(pc,Kc)))}}S5b(){return this.Le&&this.Le.Vc?!0:!1}eTc(){this.S5b()&&(be.a.J(512497874,801,15,"Action Telemetry: {0}",this.Le.Vc.bQb()),this.Le.Vc.finish(!0),
this.Le.dispose(),this.Le=null)}WJh(La,sb){!this.pc.VL||La||2!==sb&&1!==sb&&4!==sb?(this.S5b()&&this.Le.Vc.Wa("PopsRehydrationAttempted","false"),be.a.J(512497873,809,15,"TriggerRehydrateHostSession is skipped isFileUrlExpired:{0}, rehydrationTriger:{1}",La,sb),this.OPf(null)):(this.S5b()&&this.Le.Vc.Wa("PopsRehydrationAttempted","true"),this.wR.xga(4===sb?6:7,Object(B.a)(this,this.uNi,"createPopSessionSucceededCallback"),Object(B.a)(this,this.OPf,"createPopSessionFailedCallback")))}uNi(){this.S5b()&&
(this.c1f(),this.Le.Vc.Wa("POPSessionCreated","true"),this.eTc())}OPf(){if(!this.S5b())return!1;this.c1f();this.Le.Vc.Wa("POPSessionCreated","false");this.eTc();return!1}c1f(){this.Le.Vc.oC("IsInEditingMode",this.pc.Pn.toString());this.Le.Vc.oC("IsPreviousModeEditing",this.pc.Pbc.toString());this.Le.Vc.oC("PopSessionEverInitialized",this.Ig.toc.toString())}tIl(La){be.a.J(512497872,801,50,"PodSeamlessfailoverManager TriggerFontsInstallationCallback started with UserHasValidLicenseForEnterpriseFonts:{0}, PPTOEnterpriseFontsEnabled:{1}",
this.Jb.ka("UserHasValidLicenseForEnterpriseFonts"),this.Jb.ka("PPTOEnterpriseFontsEnabled"));this.Jb.ka("UserHasValidLicenseForEnterpriseFonts")&&this.Jb.ka("PPTOEnterpriseFontsEnabled")&&nd(La)}bnh(){this.Le.qY=oc.a();this.wb.tua||this.wb.stop();let La=this.la.restoreRCInCreatePodSessionRequest&&this.ta.pk?this.ta.pk.toString():"";La=I.a.replaceAll(La,"#","%23");this.hgb.createPodSession(this.Le.qY,"SeamlessFailover_"+this.Le.Bya,this.Le.aSa,+new Date-+this.Le.startTime,Object(B.a)(this,this.tNi,
"createPodSessionSucceededCallback"),Object(B.a)(this,this.sNi,"createPodSessionFailedCallback"),this.GE,this.Ie.podSessionId,La);this.hgb.APl(this.Le.qY,Object(B.a)(this,this.tIl,"triggerFontsInstallationCallback"));this.wb.rLa()}tNi(La){if(this.z_){fe.a.twd=[];this.Le.Vc.Wa("NewPodsId",this.Le.qY);this.Ie.podSessionId=this.Le.qY;this.Le.Vc.Wa("CreatePodsWithRetryResult","true");this.Le.Vc.Wa("CreatePodsRetryCount",this.Le.aSa.toString());this.Le.Vc.Wa("CreatePodsDuration",(+new Date-+this.Le.startTime).toString());
this.Ym.isPaused&&this.Ym.onb();try{this.Ym.oIf()}catch(sb){be.a.J(512497871,801,15,"PodSeamlessfailoverManager CancelBlockedOperation failed. {0}",sb)}if(this.la.restoreRCInCreatePodSessionRequest&&La&&Cb.a.Unc in La&&!I.a.Xa(La[Cb.a.Unc])){const sb=Boolean.parse(La[Cb.a.Unc]);this.Le.Vc.Wa("RCRestoredWhenCreatePodSession",La[Cb.a.Unc]);sb?(this.Le.Vc.oC("Result","Success"),this.Okb(!0)):(this.Uue&&this.Uue.EAi(),this.Le.Vc.Wa("DocRefreshTriggered","true"),La={failedMachineId:null,isPlanedShutdown:!1,
fromSeamlessFailoverManager:!0},La.podSessionId=this.Ie.podSessionId,this.Le.R5b=!0,this.ia.Ka(sd.a.LLb,2,La))}else this.OJh()}}OJh(){this.Tb.Di.contentReplicator.aJc(Object(B.a)(this,this.v7g,"onAfterReplication"));this.xIl()}xIl(){const La=()=>{this.Le.kWe=new Date;this.Le.Vc.vm("InboundStartTime",this.Le.kWe);this.Tb.Di.contentReplicator.QF(null,null,null)};be.a.J(512497870,801,50,"PodSeamlessFailoverManager::TriggerInbound - ForceInboundSlide:{0}; ActiveSlide.Sid:{1}; PodSessionID:{2};",!0,this.ta.Ba?
this.ta.Ba.sid:0,this.Le.qY);4===this.Le.Bya&&this.la.podsSeamlessFailoverForceInboundSlideEnabled&&this.ta.Ba?(this.KB.w$b&&this.KB.w$b.plg(this.ta.Ba.Db),this.Le.Vc.vm("ForceInboundSlideStartTime",new Date),this.Rv.t8d(this.ta.Ba,(sb,Ob)=>{be.a.J(512497869,801,50,"PodSeamlessFailoverManager::TriggerInbound after ForceInboundSlide - SlideId:{0}; SlideStale:{1};",sb,Ob);this.z_&&(this.Le.Vc.vm("ForceInboundSlideEndTime",new Date),La())},!0,!1)):La()}sNi(La){if(!this.z_)return!0;const sb=+new Date-
+this.Le.startTime;if(399===La)return be.a.J(512497868,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, unsupported client - PodSessionID:{0}; Time:{1};",this.Ie.podSessionId,sb),this.Ud.nH(La,null),this.Okb(!1,La,!1),!0;if(this.Le.i7d&&230===La)return be.a.J(512497867,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, file url expired - PodSessionID:{0}; Time:{1};",this.Ie.podSessionId,sb),this.bXf("CreatePodSessionFailed_GetFileUrlFailed",
La),!0;if(this.Le.aSa<this.la.podsFailoverRehydrationCreatePodSessionMaxRetryCount&&sb<this.la.podsFailoverRehydrationCreatePodSessionMaxRetryDurationInMs){let Ob;(Ob=this.Le).aSa=Ob.aSa+1;be.a.J(512497866,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, continue retrying - PodSessionID:{0}; Attempts:{1}; Time:{2}; ErrorCode:{3};",this.Ie.podSessionId,this.Le.aSa,sb,La);this.bnh();return!0}be.a.J(512497865,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, stopped retrying - PodSessionID:{0}; Attempts:{1}; Time:{2}; ErrorCode:{3};",
this.Ie.podSessionId,this.Le.aSa,sb,La);this.bXf("CreatePodSessionFailed",La);return!0}bXf(La,sb){this.Le.Vc.Wa("CreatePodsWithRetryResult","false");this.Le.Vc.Wa("CreatePodsRetryCount",this.Le.aSa.toString());this.Le.Vc.vm("CreatePodsWithRetryET",new Date);this.Le.Vc.oC("Result",La);this.Le.Vc.Wa("CreatePodsDuration",(+new Date-+this.Le.startTime).toString());this.Okb(!1,sb)}v7g(La,sb){this.z_&&(sb.fqg?be.a.J(512497864,801,50,"PodSeamlessFailoverManager::OnAfterReplication() - Current replication is outbound, replication result: {0}",
sb.qkd):(this.Le.Vc.oC("InboundDuration",(+new Date-+this.Le.kWe).toString()),this.Le.Vc.oC("Result","Success"),this.Okb(!0)))}fga(La,sb){this.z_&&(this.Le.Vc.Wa("WaitPodsRefreshedDuration",(+new Date-+this.Le.nUl).toString()),this.Le.Vc.Wa("NewPodsId",sb.qY),this.Bz.fkb(Object(B.a)(this,this.fga,"onPodSessionRefreshed")),this.Ym.isPaused&&this.Ym.onb(),this.OJh())}}Object(h.a)(af,"PodSeamlessFailoverManager",null,[679]);class de{constructor(La,sb,Ob){this.Hva=La;this.Ya=Ob}ZZ(){}m_b(){}l7a(La){La&&
(Array.add(La,Cb.a.hOe),Array.add(La,Cb.a.Aaa),Array.add(La,Cb.a.JJb),Array.add(La,Cb.a.QLk),Array.add(La,Cb.a.Unc))}$da(La,sb){sb?((sb=La[Cb.a.JJb])&&sb.toLowerCase()!==(this.Ya.Baa?this.Ya.Baa.toLowerCase():"")&&(be.a.J(512497857,821,15,"HandleResponseHeaders: PodInstance was updated. Id:{0};",sb),this.Ya.Baa=sb),this.Hva?(La=La[Cb.a.hOe])?(this.Hva.ccpInfo=La,be.a.J(512497827,826,50,"HandleResponseHeaders: CCPInfo was updated, length: {0}",La.length)):be.a.J(512497826,826,15,"HandleResponseHeaders: CCPInfo couldn't be found in response headers."):
be.a.J(512497856,826,15,"HandleResponseHeaders: ccpInfoOwner is null so skip the response headers.")):be.a.J(512497858,826,15,"HandleResponseHeaders: abort since argument 'responseHeaders' is null.")}}Object(h.a)(de,"RehydrationHeaderHandler",null,[721]);class $f{constructor(La,sb,Ob,pc,Kc,Gd,he,Ue,Rf,sf){this.QO=null;this.h8c=!1;this.bfg=ag=>{if(ag.keyCode===G.a.Xyd||ag.keyCode===G.a.kNa||ag.keyCode===G.a.Bnb||ag.keyCode>=G.a.Rnb&&ag.keyCode<=G.a.uAa)return!1;this.LUe(2);return!0};this.tf=La;this.Mc=
sb;this.sR=Ob;this.Qr=pc;this.Rc=Kc;this.$e=Gd;this.MYg=Rf;this.Ea=he;this.Xo=Ue;this.Ted=sf}init(){this.Mc&&(this.Mc.wTd(Object(B.a)(this,this.sessionExpired,"sessionExpired")),this.Mc.OQa(Object(B.a)(this,this.AGk,"onRehydrateSession")))}sessionExpired(){this.rCh(!0);m.ULS.sendTraceTag(594616334,821,50,"Pausing health heartbeat");xc.Health.instance.stopAllHealthTimers()}LUe(La){this.rCh(!1);const sb=e.AFrameworkApplication.jA||!uf.a("Rehyrdation.StopRefreshIfWopiRefreshDisable");m.ULS.sendTraceTag(544789148,
821,100,"Should refresh token: {0}",sb);sb&&this.Ted&&this.Ted.vYd(0);this.Ea.podsSeamlessFailoverEnabled&&this.Xo.l7e(!1,La,223)}AGk(){m.ULS.sendTraceTag(594616333,821,50,"Resuming health heartbeat");xc.Health.instance.resumeAllHealthTimers()}rCh(La){this.h8c!==La&&this.tf&&(La?(this.QO||(this.QO=this.$e.$d(),this.QO.id="sessiontimeoutoverlay",this.QO.className="SessionTimeoutOverlay",this.QO.tabIndex=-1,this.Wni(this.QO),this.tf.appendChild(this.QO)),this.h8c=!0,this.MYg(this.QO)):(this.YSf(this.QO),
this.QO&&this.QO.parentNode&&this.QO.parentNode.removeChild(this.QO),this.QO=null,this.h8c=!1))}Wni(La){La&&(this.Rc.rb(J.a.click,La,Object(B.a)(this,this.Uab,"handleClickEvent")),this.Rc.rb(J.a.doubleClick,La,Object(B.a)(this,this.Uab,"handleClickEvent")),uf.a("FixRehydrationOnKeyPress")?this.Qr.addHandler(La,J.a.Bf,this.bfg):this.sR.rb(J.a.Bf,La,Object(B.a)(this,this.ffg,"handleKeyEvent")),$addHandler(window,"visibilitychange",Object(B.a)(this,this.onVisibilityChange,"onVisibilityChange")))}YSf(La){La&&
(this.Rc.Bb(J.a.click,La,Object(B.a)(this,this.Uab,"handleClickEvent")),this.Rc.Bb(J.a.doubleClick,La,Object(B.a)(this,this.Uab,"handleClickEvent")),uf.a("FixRehydrationOnKeyPress")?this.Qr.removeHandler(La,J.a.Bf,this.bfg):this.sR.Bb(J.a.Bf,La,Object(B.a)(this,this.ffg,"handleKeyEvent")),$removeHandler(window,"visibilitychange",Object(B.a)(this,this.onVisibilityChange,"onVisibilityChange")))}Uab(){this.LUe(1);return!0}ffg(La){if(La.mc.ctrlKey||La.mc.altKey||La.mc.shiftKey||La.mc.keyCode>=G.a.Rnb&&
La.mc.keyCode<=G.a.uAa)return!1;this.LUe(2);return!0}onVisibilityChange(){e.AFrameworkApplication.jA&&!window.document.hidden&&this.Ted&&this.Ted.vYd(1)}dispose(){this.Mc.hph(Object(B.a)(this,this.sessionExpired,"sessionExpired"));this.QO&&(this.YSf(this.QO),this.QO.parentNode&&this.QO.parentNode.removeChild(this.QO));this.Qr=this.sR=this.Rc=null;this.h8c=!1;this.MYg=null}}Object(h.a)($f,"SessionRehydrationController",null,[]);class ge{constructor(){this.Da=null}Yb(La){this.Da=La||v.a.instance}dispose(){}}
Object(h.a)(ge,"TellMePackage",null,[2,3]);var ze=d(117),si=d(144),sh=d(29),dd=d(16),Lc=d(108),Zd=d(952);class Ne{constructor(La=null,sb=null,Ob=null,pc,Kc=null){this.HAd=null;this.bbf=!1;this.rgf=this.mob=null;this.C7h=this.atf=this.hUh=this.sgf=!1;this.Bzc=null;this.sUh=null==sb?e.AFrameworkApplication.wtb:sb;this.p_h=null==Ob?e.AFrameworkApplication.LFa:Ob;this.X7h=null==Kc?e.AFrameworkApplication.yza:Kc;this.CZh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeHelpOnHelpIsEnabled");
this.b9h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeCommandHookIsEnabled");this.eql(!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeIgnoreQueryForHelp"));this.T8h=!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.ob.xcc;this.U8h=!Lc.a.Ex()&&!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMePeopleSuggestionIsEnabled");this.S8h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeFileSuggestionIsEnabled");this.qYh=!!e.AFrameworkApplication.Aa&&
e.AFrameworkApplication.Aa.ob.wOb;this.V8h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.o7h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("HelpShowsTopSearchResult");this.F3h=this.Htc||this.Gtc;this.D3h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("OnlineCommandSuggestionsIsEnabled");this.E3h=this.Aoe;this.O0h=!!e.AFrameworkApplication.fa&&this.Uza&&e.AFrameworkApplication.fa.ka("StyledHeaderInLabelIsEnabled");
this.ZYh=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.gZh=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.WYh=e.AFrameworkApplication.fa?parseFloat(e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold","-0.6")):-.6;this.L0h=
!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.ka("SmartLookupNoteSearchIsEnabled")||e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.v0h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTOChatPPTCopilot",!1);this.c1h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotPaneEnabled",!1);
this.y_h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenCopilotFromTellMe",!1)&&(this.s6j||this.O_j);this.Brb=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceActionAIEnabled",!1);this.n8h=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):
"https://substrate.office.com/search/api/v1/suggestions";this.jZh=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.p7h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",!1);this.L7h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",
!1);this.y7h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("ShowFindInDocumentInZeroTermSearchBox")||this.cI;this.W0h=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.ka("TellMeTemplateProviderIsEnabled")||e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.s0h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",
!1);this.J0h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeIsRuleBasedSortingEnabled")&&"en-US"===e.AFrameworkApplication.uiCulture;this.T0h=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.ka("TellMeFeedbackProviderIsEnabled")||e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",!1));this.i1h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeZeroTermContextualCommandSuggestionsEnabled");this.jUh=
this.Uza&&!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",!1);this.xZh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.Q7h=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",!1)||"Word"!==e.AFrameworkApplication.fa.Ha("Application"));
this.SUh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",!1);this.h$h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMePerformanceMarkerEnabled");this.A_h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",!1);this.E_h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",
!1);this.fZh=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",0):0;this.V0h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeNotesSuggestionIsEnabled")||this.Esg;this.C_h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",!1);this.D_h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",
!1);this.B_h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",!1);this.OXh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMe",!1);this.PXh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMeMVP",!1);this.W8h=this.C4j&&
(this.wNe||this.xNe||this.snc||this.Uza&&Lc.a.J9()&&!!e.AFrameworkApplication.fa&&(this.EOb||this.Klb||this.Llb||this.Mlb||this.FOb||e.AFrameworkApplication.fa.ka("ShowAnswerSearchResults")||e.AFrameworkApplication.fa.ka("ShowDefinitionSearchResults")||e.AFrameworkApplication.fa.ka("ShowEntitySearchResults")||e.AFrameworkApplication.fa.ka("ShowWolframSearchResults")));this.LTh=!!e.AFrameworkApplication.fa&&!e.AFrameworkApplication.fa.ka("AppsForOfficeThirdPartyIsDisabled")&&e.AFrameworkApplication.fa.ka("AppsForOfficeAllowExternalMarketplace")&&
e.AFrameworkApplication.Qca;this.MTh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("AppsForOfficePrivateCatalogIsEnabled");this.HNj(La||{});this.UNd="2918242107";this.TNd="1454393937";this.P5a={};this.nQa=[];this.NHi=[Lc.a.vxd]}get application(){return this.mob}get wtb(){return this.sUh}get Zfl(){return this.UNd}get Yfl(){return this.TNd}get a0f(){return this.rgf}get N4i(){return this.sgf}get LFa(){return this.p_h}get yza(){return this.X7h}get J7a(){return this.hUh}get vIj(){return this.CZh}get ZEl(){return this.b9h}get C4j(){return!0}get OEl(){return this.W8h}get zsl(){return this.atf}eql(La){this.atf=
La}get Uza(){return this.T8h}get xvc(){return this.U8h}get vvc(){return this.S8h}get G3i(){return this.qYh}get MEl(){return this.V8h}get u7e(){return!1}get snc(){return this.F3h}get wNe(){return this.D3h}get xNe(){return this.E3h}get pWa(){return!1}get j3c(){return!1}get cqe(){return this.O0h}get B1e(){return this.C7h}get EOb(){return!1}get Ntl(){return!1}get A8j(){return""}get nbe(){return 2}get Qoj(){return 4}get Roj(){return 5}get nrj(){return""}get Xgj(){return this.ZYh}get obg(){return this.gZh}get prj(){return 1E3}get orj(){return 1E-6}get oCl(){return this.n8h}get r4e(){return!1}get nCl(){return!1}get j2j(){return this.J0h}get T2c(){return!1}get Ipe(){return!1}get IZj(){return!1}get HZj(){return!1}get Esg(){return!1}get Hsg(){return!1}get b0f(){return!1}get xOb(){return!1}get Klb(){return!1}get Llb(){return!1}get Mlb(){return!1}get FOb(){return!1}get Htc(){return this.o7h}get yOb(){return this.p7h}get Gtc(){return!1}get e$d(){return null}get Dpe(){return!1}get Ktd(){return this.y7h}get I9f(){return 0}get mcj(){return this.WYh}get Sbg(){return this.jZh}get I3j(){return this.L0h}get fme(){return this.y_h}get Jtd(){return this.Brb}get r9f(){return-3.9}get cI(){return this.L7h}get ycc(){return this.W0h}get Goe(){return this.s0h}get pqe(){return this.T0h}get ZQa(){return this.jUh}get A6j(){return this.i1h}get Yda(){return this.xZh}get nDh(){return this.Q7h}get Aqi(){return this.SUh}get Tyd(){return this.h$h}get f0c(){return this.A_h}get hSj(){return this.E_h}get Fq(){return this.fZh}get qWa(){return this.V0h}get fSj(){return this.C_h}get gSj(){return this.D_h}get eSj(){return this.B_h}get Zzf(){return this.LTh}get $zf(){return this.MTh}get M3(){return this.OXh}get gRc(){return this.PXh}get s6j(){return this.c1h}get O_j(){return this.v0h}get Qp(){return!!e.AFrameworkApplication.Aa&&
e.AFrameworkApplication.Aa.ob.Pp}get Pp(){return!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.ob.Pp}get NZj(){return!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.ob.nza}get hyk(){return Ca.getImageClass("OfficeAssistant_32x32x32")}hhj(){return Promise.reject("GetFindMatchCount method is not overridden")}y3c(La){return Array.contains(appChrome.selectors.getVisibleControlIds(),La)}Sme(){return!1}get woe(){return!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeModelRankerEnabled")}get ZHh(){return e.AFrameworkApplication.fa?
e.AFrameworkApplication.fa.Ha("TellMeServiceHelpClassifierModelName"):""}get Aoe(){return!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeMultiLingualCommandModelEnabled")}get SYc(){return"NoOpHeaderUi"}get MHi(){return this.Bzc}get parameterData(){return this.P5a}get zKl(){return this.nQa}F_i(){if(this.HAd&&!this.bbf&&(this.bbf=!0,this.Zsd(this.HAd),this.Pp)){var La=v.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");La=(new Zd.a(La)).c9d(this.HAd.uba);appChrome.api.dispatch(La)}}get Auh(){return""}Zsd(){}KTi(La){const sb=
[];for(let Ob=0;Ob<La.length;++Ob)La[Ob].yul?sb.push(new dd.a(La[Ob].alternate,Lc.a.cLh+Ob.toString())):sb.push(new dd.a(La[Ob].standard,Lc.a.vxd+Ob.toString()));return sb}HNj(La){const sb={};for(let Ob in La){const pc=Ob,Kc=La[Ob];for(let Gd in Kc){const he=Gd,Ue=Kc[Gd];(sb[he]||(sb[he]={}))[pc]=Ue}}this.Bzc=sb}get $Hh(){return""}get DCh(){return!1}}Object(h.a)(Ne,"TellMeApplicationData",null,[760]);class Xc{constructor(La,sb=null,Ob=!1){this.standard=La;this.alternate=sb;this.yul=Ob}}Object(h.a)(Xc,
"TryQuerySet",null,[]);class lf{constructor(){this.Enf=this.Fnf=null}get Hwk(){return this.Enf}oL(La){this.Fnf=La;return this.rMi(La)}Uyk(){this.Enf=this.Fnf}Hjj(La){return 8===La.type?String.format(CommonUIStrings.l_FindInDocumentText,La.dK):La.dK}bdj(La){return La.dK}}Object(h.a)(lf,"ParameterizedCommand",null,[]);class Kh extends lf{constructor(La){super();this.n3j=La}get commandId(){return this.n3j?"FindParameterized":"EditingFind"}get cMk(){return"Find"}rMi(La){if(!La)return null;const sb=I.a.xe(String.format(ResourceStrings.l_ParamFindInDocTitle,
La.dK));return va.a(Lc.a.TPi(La.value),"1540292897",sb,"Find_16x16x32",null,I.a.xe(La.dK),sb,null,null)}}Object(h.a)(Kh,"FindParameterizedCommand",lf,[]);var bd=d(125);class fd extends Ne{constructor(){super(window.TellMeControlMetadataOverrides);this.mob="PowerPoint";if(e.AFrameworkApplication.fa.ka("TellMeTryQueriesIsEnabled")){var La=[new Xc(ResourceStrings.l_TellMeTryQuery01,"",!1),new Xc(ResourceStrings.l_TellMeTryQuery02,"",!1),new Xc(ResourceStrings.l_TellMeTryQuery03,"",!1),new Xc(ResourceStrings.l_TellMeTryQuery04,
"",!1),new Xc(ResourceStrings.l_TellMeTryQuery05,"",!1)];this.nQa=this.KTi(La)}e.AFrameworkApplication.fa.ka("TellMeFindInDocumentIsEnabled")&&(La=new Kh(fd.m3j()),this.parameterData[La.commandId]=La,this.sgf=!0,this.rgf=La.commandId)}get uLa(){return bd.a.nGf}Zsd(La){if(La){La=La.uba;var sb=e.AFrameworkApplication.fa;La["PptTellMe.Animation"]=!sb.ka("TellMeAnimationsTransitionsIsEnabled")||sb.ka("241");La["PptTellMe.Transition"]=!sb.ka("TellMeAnimationsTransitionsIsEnabled");La["PptTellMe.SelectAll"]=
!sb.ka("TellMeSelectAllResultIsEnabled");La["PptTellMe.AnimationNew"]=!sb.ka("241")||!sb.ka("TellMeAnimationsTransitionsIsEnabled");La["PptTellMe.Designer"]=!sb.ka("248");sb=sb.ka("TellMeDesktopUpSellIsEnabled");var Ob=e.AFrameworkApplication.D4j;La["PptTellMe.WordArtUpSellButton"]=!sb||Ob;La["PptTellMe.SpellCheckDictUpSellButton"]=!sb||Ob;La["PptTellMe.InsertAudioUpSellButton"]=!sb||Ob;La["PptTellMe.InsertChartUpSellButton"]=!sb||Ob;La["PptTellMe.WordArtUpSellButtonEnterprise"]=!sb||!Ob;La["PptTellMe.SpellCheckDictUpSellButtonEnterprise"]=
!sb||!Ob;La["PptTellMe.InsertAudioUpSellButtonEnterprise"]=!sb||!Ob;La["PptTellMe.InsertChartUpSellButtonEnterprise"]=!sb||!Ob}}get Esg(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeNotesSuggestionIsEnabled",!1)}get Hsg(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeZeroTermNotesSuggestionIsEnabled",!1)}get I9f(){return e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.PowerPointOnline.NumberOfNotesSuggestionsToShow",
2)}get $Hh(){return e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMeMultiLanguageModelName","")}get r4e(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeServiceAADAuthIsEnabled",!1)}get ZHh(){return e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMeHelpClassifierModelName","")}get EOb(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeShowImageSearchResults",
!1)}get Aoe(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeMLCModelIsEnabled",!1)}get nbe(){return e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.PowerPointOnline.TellMeMenuUpdatePolicy",0)}get DCh(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeShowMoreFileResults",!1)}get j3c(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeEnableRankerLogging",
!1)}get U3j(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMe",!1)||e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMeMVP",!1)}get e$d(){const La={};e.AFrameworkApplication.fa.ka("PPTOModernFontPickerIsEnabled")?La.FontName="FontPicker":La.FontPicker="FontName";e.AFrameworkApplication.fa.ka("ReactNewSlideLayoutEnabled")?(La.NewSlide="NewSlideSplit",La.ChangeLayout="ChangeLayoutFlyout"):
(La.NewSlideSplit="NewSlide",La.ChangeLayoutFlyout="ChangeLayout");return La}get r9f(){var La=e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMe.NBClassifierScoreThreshold","-3.9");La=parseFloat(La);return isNaN(La)?-3.9:La}get T2c(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMe.IsSerpletClassifierEnabled",!1)}get Zzf(){return e.AFrameworkApplication.fa.ka("51")}get $zf(){return e.AFrameworkApplication.fa.ka("305")}static m3j(){return!!e.AFrameworkApplication.Aa&&
e.AFrameworkApplication.Aa.ob.Qp}}Object(h.a)(fd,"PowerPointTellMeApplicationData",Ne,[]);var Ve;(function(La){La[La.none=0]="none";La[La.waitAll=1]="waitAll";La[La.synchronizeFast=2]="synchronizeFast";La[La.synchronizeSlow=3]="synchronizeSlow"})(Ve||(Ve={}));Object(h.b)("ProviderSynchronizationType",Ve);var rf;(function(La){La[La.immediate=0]="immediate";La[La.waitAll=1]="waitAll";La[La.synchronizeAndWaitAll=2]="synchronizeAndWaitAll";La[La.synchronizeAndWaitForRanker=3]="synchronizeAndWaitForRanker"})(rf||
(rf={}));Object(h.b)("MenuUpdatePolicy",rf);var Ag=d(175),ne=d(303),kf=d(160),kg=d(710),Af=d(176),Wf=d(1013);class vf{constructor(La,sb,Ob){this.Lq=La;this.kb=sb;this.ta=Ob}sE(){return"SummarizeSlidesProvider"}GL(){return this.Lq.nbe?this.Lq.nbe===rf.waitAll?Ve.waitAll:Ve.synchronizeSlow:Ve.none}FB(La,sb,Ob,pc,Kc=null){var Gd,he,Ue,Rf;const sf=new Ag.a(La);if(this.$F(La))if(null!=Kc&&0>Kc.indexOf(ne.a.ActionAI))sb.resultsUpdated(sf);else{this.BGe="SummarizeDeckFromTellMe";if(1<(null===(he=null===
(Gd=this.kb)||void 0===Gd?void 0:Gd.Se())||void 0===he?void 0:he.length))this.BGe="SummarizeSlidesFromTellMe";else if(null===(Rf=null===(Ue=this.ta)||void 0===Ue?void 0:Ue.presentation)||void 0===Rf||!Rf.slides||2>this.ta.presentation.vza){sb.resultsUpdated(sf);return}appChrome&&appChrome.selectors.isControlDisabled(this.BGe)?sb.resultsUpdated(sf):(La=new kf.a(this.BGe,kg.a.SummarizeDeck,"","",Wf.a.Local),Ob=new Af.a(ne.a.SummarizeDeck),Ob.us(La),sf.Aq(Ob),window.requestAnimationFrame(()=>{sb.resultsUpdated(sf)}))}else sb.resultsUpdated(sf)}$F(La){return!La||
!La.Cf||!La.Cf.trim().length}}Object(h.a)(vf,"SummarizeSlidesProvider",null,[750]);class De extends ge{constructor(){super()}get name(){return"PowerPointEditor.TellMe"}load(){this.init()}init(){if(e.AFrameworkApplication.UHh){var La=sh.App.Lb.ob.Xce(Ab.a.tellMe);La.S0c?De.Zfh():La.kW(Object(B.a)(this,this.Kfl,"scriptResource_LoadFinished"));var sb=new fd;ze.TellMeActor.instance.initialize(sb,null,null,null,null,null,Object(B.a)(sh.App.Lb,sh.App.Lb.g2f,"forceUpdateRibbonControls"),e.AFrameworkApplication.fa,
this.Da.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.Da.Ia("Common.IActionContextProvider"),this.Da.Ia("Common.ISystemInitiatedFeedback"));ze.TellMeActor.instance.q2k(La);La=e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("822");sb.U3j&&La&&ze.TellMeActor.instance.gz(new vf(sb,this.Da.resolve("PowerPointWebEditor.IPptSelectionManager"),this.Da.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")),si.a.tellMe)}}Kfl(){De.Zfh()}static Zfh(){sh.App.Lb.updateCommandUI()}}
Object(h.a)(De,"PowerPointTellMePackage",ge,[]);var Ee=d(215),Jd=d(193);class Og{constructor(){this.jh=this.w5=this.K=null}get name(){return"PowerPointWebEditor.Chronos1"}Yb(La){this.K=La;this.w5=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.jh=this.w5.XEa(4,this.name);this.K.register(de,"PowerPointWebEditor.RehydrationHeaderHandler").ma().oa(()=>new de(this.K.resolve("PowerPointWebEditor.ICCPInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner")));
this.K.register($f,"PowerPointWebEditor.SessionRehydrationController").ma().oa(()=>new $f(this.K.resolve("Box4.IAppFrame").SF(),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("Common.IKeyInputManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPoint.IBrowserHelperManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),
sb=>{z.FocusManager.Zq(sb)},e.AFrameworkApplication.jA?this.K.resolve("PowerPointWebEditor.IPPTTokenRefreshManager"):null));this.K.register(679,"PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager").ma().oa(()=>new af(this.K.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionCoreManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Common.IActionManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.RehydrationHeaderHandler"),
this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IPopWebService"),this.K.resolve("PowerPointWebEditor.IPopSessionState"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("Box4.IReplicationScheduler"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager"),
this.K.resolve("PowerPointWebEditor.IInboundHelper"),this.K.resolve("PowerPointWebEditor.Image.IImageManager"),e.AFrameworkApplication.Me,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IPPTOfflineManager"),this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),this.K.Ia("PowerPointWebEditor.ICommentSessionManager")));e.AFrameworkApplication.jA&&this.K.register(680,"PowerPointWebEditor.IPPTTokenRefreshManager").ma().oa(()=>
new ef(this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.resolve("Common.ISessionExpirationManagerWithDialog"),this.K.resolve("PowerPointWebEditor.PresentationContext"),this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")))}init(){let La=this.jh.Zt("resolvechronos1");const sb=this.K.resolve("Common.AFrameworkApplication"),Ob=
this.K.resolve("PowerPointWebEditor.IApplicationContext").rd;var pc=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");const Kc=this.K.resolve("Common.IActionManagerExtended"),Gd=this.K.resolve("PowerPointWebEditor.IFocusManager"),he=this.K.resolve("Common.Transaction.ITransactionFactory"),Ue=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),Rf=this.K.resolve("PowerPointWebEditor.IShapeEditor"),sf=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),
ag=this.K.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),xg=this.K.resolve("PowerPointWebEditor.PictureContext"),Tg=this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),li=this.K.resolve("PowerPointWebEditor.IRibbonChangeManager"),Li=this.K.resolve("PowerPointWebEditor.IPictureUploader");this.jh.fu(La);La=this.jh.Zt("regactorschronos1");pc=[new Nf(Kc,sf,Ue,Gd,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),he,Li,xg,Rf,e.AFrameworkApplication.ZQ,li,this.K.resolve("PowerPointWebEditor.IErrorHandler"),
pc,this.K.resolve("PowerPointWebEditor.IPPTFileReaderHelper"),Ob.QXj,this.K.resolve("PowerPointWebEditor.IInsertImageHelper"),Tg,ag,Ob,this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Common.IAppSettingsManager"))];for(var Le of pc)Le.vb(),Le.pe();this.tNj();this.jh.fu(La);La=this.jh.Zt("tellme");Le=new De;Le.Yb(this.K);Le.load(sb);this.jh.fu(La);Ob.pptEditorTimeoutDialogRemovalIsEnabled&&
Ob.yg&&(La=this.jh.Zt("initrehydrationcontroller"),this.K.resolve("PowerPointWebEditor.SessionRehydrationController").init(),this.jh.fu(La));Ob.podsSeamlessFailoverEnabled&&this.K.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager");e.AFrameworkApplication.jA&&(La=this.jh.Zt("posttokenrefresh"),this.K.resolve("PowerPointWebEditor.IPPTTokenRefreshManager"),this.jh.fu(La));this.A9j()}tNj(){const La=this.K.resolve("Common.IActionManagerExtended"),sb=this.K.resolve("PowerPointWebEditor.IFocusManager"),
Ob=this.K.resolve("Common.AFrameworkApplication").aq.Kd,pc=this.K.resolve("Common.Transaction.ITransactionFactory"),Kc=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),Gd=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),he=this.K.resolve("PowerPoint.IPathManager"),Ue=this.K.resolve("PowerPointWebEditor.IPresentationReader"),Rf=Jd.a(this.K);Rf("powerpoint-editor-intl").then(()=>{be.a.J(512497373,801,50,"Editor script is loaded successfully");Rf("powerpoint-ribbon-intl").then(()=>
{be.a.J(512497372,801,50,"Ribbon script is loaded successfully");const sf=[];sf.push(new Qc(La,sb,Gd,pc,Ob,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ue,Kc,he));for(const ag of sf)ag.vb(),ag.pe()}).catch(()=>{be.a.J(512497371,801,10,"Failed to load Ribbon script")})}).catch(()=>{be.a.J(512497370,801,10,"Failed to load Editor script")})}A9j(){be.a.J(512497369,809,50,"Start to download chronos2 js file");this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Dda("pptedit.chronos2",
()=>{const La=this.K.resolve("PowerPointWebEditor.ISessionState");La&&La.p6("Chronos2DownloadFinished")},()=>d.e(6).then(d.bind(null,1286)))}dispose(){const La=this.K.resolve("PowerPointWebEditor.IApplicationSettings");La.pptEditorTimeoutDialogRemovalIsEnabled&&La.yg&&this.K.resolve("PowerPointWebEditor.SessionRehydrationController").dispose();e.AFrameworkApplication.jA&&La.yg&&this.K.resolve("PowerPointWebEditor.IPPTTokenRefreshManager").dispose()}static main(){e.AFrameworkApplication.Yg&&Oc.a.gg?
be.a.J(512497368,809,15,"Firefox attempts to load chronos1 package when App is disposing"):r.a.instance.Ac(Ee.a(new Og,4))}}Object(h.a)(Og,"Chronos1Package",null,[2,3]);var Rg=d(656),Eg=d(141),xf=d(589),hd=d(58),yf=d(48);class cd{constructor(La,sb,Ob,pc,Kc,Gd,he,Ue,Rf,sf,ag){this.type="FormatPictureTaskPaneProps";this.saturation=this.contrast=this.brightness=this.top=this.left=this.height=this.width=this.numberFormatInfo=null;this.isPicturePropertiesInactive=this.isCropInactive=!1;this.onChange=null;
this.emptyValueFields=0;this.onSectionToggle=this.formatPictureSections=null;const xg=Object(Ub.a)(Object,Bb.e().numberFormatInfo);if(!xg)throw Error.argumentNull("numberFormatInfo");this.numberFormatInfo=xg;this.width=La;this.height=sb;this.top=pc;this.left=Ob;this.brightness=Kc;this.contrast=Gd;this.saturation=he;this.isCropInactive=Ue;this.isPicturePropertiesInactive=Rf;this.emptyValueFields=sf;this.formatPictureSections=ag}}Object(h.a)(cd,"FormatPictureTaskPaneProps",null,[]);const cg=ResourceStrings.L_PictureProperties,
xh=ResourceStrings.L_CropPicture;class Yf{constructor(La,sb,Ob,pc,Kc,Gd,he,Ue,Rf,sf,ag,xg,Tg){this.lBe=this.xAe=!0;this.cAg=this.Jyg=this.L0g=this.ZLg=this.G0=this.e1=0;this.iYg=100;this.XYa=this.Ab=this.LCg=!1;this.Xva=new Map([[cg,!1],[xh,!1]]);this.onSectionToggle=(li,Li)=>{this.Xva.forEach((Le,Ih)=>this.Xva.set(Ih,Ih===li?Li:!1));this.gNh();this.hl(!0)};Tg("powerpoint-editor-intl").then(()=>{this.XYa=!0}).catch(li=>{be.a.J(512350083,801,10,"Failed to load powerpoint-editor-intl "+li.toString())});
this.kb=La;this.Vb=sb;this.ia=Ob;this.Fa=pc;this.Rf=Kc;this.ta=Gd;this.Gb=he;this.wi=Ue;this.c$=Rf;this.$b=sf;this.Ic=ag;if(!xg)throw Error.argumentNull("appSettings");this.la=xg;this.Rf.zCa(Object(B.a)(this,this.Vhd,"onChangeRenderFormatPicturePane"));this.Vb.GI(Object(B.a)(this,this.zu,"onAppFrameModeSwitched"));this.Ic.LQa(Object(B.a)(this,this.Vhd,"onChangeRenderFormatPicturePane"))}dispose(){this.Rf.z0a(Object(B.a)(this,this.Vhd,"onChangeRenderFormatPicturePane"));this.Vb.IY(Object(B.a)(this,
this.zu,"onAppFrameModeSwitched"));this.Ic.ekb(Object(B.a)(this,this.Vhd,"onChangeRenderFormatPicturePane"))}pe(){}vb(){this.ia.ra(sd.a.pLb,Ke.a.application,Object(B.a)(this,this.pLb,"queryShowHideReactPictureCropPane"),96);this.ia.ra(sd.a.duc,Ke.a.application,Object(B.a)(this,this.duc,"showHideReactPictureCropPane"),4);this.ia.ra(sd.a.V2a,Ke.a.application,Object(B.a)(this,this.V2a,"updatePictureCropPane"),4)}pLb(La,sb,Ob,pc,Kc){(La=Object(Ub.a)(hf.a,Kc))&&La.Hf(this.Ab);return 32}duc(La,sb,Ob,pc,
Kc){if(!this.XYa)return 8;if(1===Ob)return 32;sb=this.ta.presentation;if(!this.ta.Ba||!sb||this.$b.$c(sb))return 16;this.Aml(Kc);return ud.b("ShowHideReactPictureCropPane:",this.Ab.toString(),La,()=>{if(this.Ab=!this.Ab){if(this.hl(),!this.la.qxb&&uf.a("CropControlEnableOnDisplayingFormatPicturePane")){const Gd=this.kb.fo();(null===Gd||void 0===Gd?0:Gd.Lv)||this.ia.processAction(sd.a.TOc,2)}}else this.Iq();return 32})}Aml(La){null!=La&&"FormatPicture"===La.SourceControlId?(this.Xva.set(cg,!0),this.Xva.set(xh,
!1)):(this.Xva.set(xh,!0),this.Xva.set(cg,!1))}V2a(La,sb,Ob,pc,Kc){if(!this.Ab)return 8;if(2===Ob)if(this.la.qxb)this.onSectionToggle(Kc.SMb,Kc.DYl);else this.hl(!0);return 32}hl(La=!1){var sb=this.WWc();sb=this.fA(sb);const Ob=Object.assign(new Rg.a,{title:ResourceStrings.L_FormatPicture,hideHeader:!1,width:320,location:2,contentProps:sb,onOpen:()=>{},onClose:()=>{this.Ab=!1},isModernPane:!0});Eg.UISurfaces.Gq().then(pc=>{La?pc.updateTaskPane(yf.a.rKa,Ob):pc.showTaskPane(yf.a.rKa,Ob);return null}).catch(pc=>
{be.a.J(512350082,822,10,"Failed to show picture crop pane. Exception: "+pc.toString())})}Iq(){Eg.UISurfaces.Gq().then(La=>{La.hideTaskPane(yf.a.rKa,2);return null}).catch(La=>{be.a.J(512350081,822,10,"Failed to hide picture crop pane. Exception: "+La.toString())})}fA(La){var sb=null;if(La){sb=La.h$d();const Ob=this.Gb.Md;this.G0=xf.a.Zv(Ob.gf(this.wi.YH(hd.a.Ql(sb.ga(0),sb.ga(3)),La.zoom),1));this.e1=xf.a.Zv(Ob.gf(this.wi.YH(hd.a.Ql(sb.ga(0),sb.ga(1)),La.zoom),0));this.ZLg=xf.a.Zv(Ob.gf(this.wi.YH(sb.ga(0).x,
La.zoom),0));this.L0g=xf.a.Zv(Ob.gf(this.wi.YH(sb.ga(0).y,La.zoom),1));this.xAe=!1;this.LCg=!0}else this.xAe=!0;La=this.LCg?0:15;this.la.qxb&&(this.lBe=!1,this.r2c()||(this.Xva.forEach((Ob,pc)=>this.Xva.set(pc,!1)),La=15,this.lBe=!0));sb=new cd(this.e1,this.G0,this.ZLg,this.L0g,this.Jyg,this.cAg,this.iYg,this.xAe,this.lBe,La,this.Xva);sb.onChange=Object(B.a)(this,this.Nxa,"onPropertyChange");sb.onSectionToggle=this.onSectionToggle;return sb}WWc(){const La=this.kb.fo();return La&&La.Lv&&La.isConnected?
this.c$.dJ(La):null}r2c(){const La=this.kb.Xd(),sb=this.kb.xVc(La);return 1==La.length&&(null===sb||void 0===sb?void 0:sb.qj)}Nxa(La,sb){const Ob={};Ob.Number=La;switch(sb){case 0:this.ia.Ka(sd.a.xyd,2,Ob);break;case 1:this.ia.Ka(sd.a.uyd,2,Ob);break;case 2:this.ia.Ka(sd.a.vyd,2,Ob);break;case 3:this.ia.Ka(sd.a.wyd,2,Ob);break;case 4:this.ia.Ka(sd.a.UMh,2,Ob);this.Jyg=La;break;case 5:this.ia.Ka(sd.a.fNh,2,Ob);this.cAg=La;break;case 6:this.ia.Ka(sd.a.BOh,2,Ob),this.iYg=La}this.hl(!0)}rk(La){return La?
La.qc(this.Gb.Na):null}gNh(){var La=this.kb.fo();this.Xva.get(xh)?uf.a("CropControlEnableOnDisplayingFormatPicturePane")&&La&&((null===La||void 0===La?0:La.Lv)||this.ia.processAction(sd.a.TOc,2)):(La=this.rk(La))&&La.PY(!1)}Vhd(){this.Ab&&(this.la.qxb&&this.gNh(),this.hl(!0))}zu(La){1===La.mode&&this.Ab&&(this.Ab=!1,this.Iq(),this.Fa.tj(yf.a.rKa,this.Ab))}}Object(h.a)(Yf,"FormatPicturePaneActor",null,[]);var Hf=d(872);class ji{constructor(La,sb,Ob,pc,Kc,Gd,he,Ue,Rf,sf,ag,xg,Tg,li,Li,Le,Ih,bj){this.xEb=
!1;if(!Li)throw Error.argumentNull("shapeReader");if(Le&&!Ih)throw Error.argumentNull("shapeSVGDependencyLoader");if(!bj)throw Error.argumentNull("businessBarController");this.ia=La;this.pa=sb;this.Eb=Ob;this.ai=pc;this.$b=Kc;this.kBe=Gd;this.jHg=he;this.Wo=Ue;this.Gb=Rf;this.ta=sf;this.wi=ag;this.c$=xg;this.oM=Tg;this.I0=li;this.Ga=Li;this.jna=Le;this.bZa=Ih;this.ul=bj}vb(){this.ia.ra(sd.a.TOc,L.a.application,Object(B.a)(this,this.u9b,"handlePictureCropEvent"),4);this.jHg?(this.ia.ra(sd.a.K1d,L.a.application,
Object(B.a)(this,this.Eeg,"handleCropSplitButton"),4),this.ia.ra(sd.a.L1d,L.a.application,Object(B.a)(this,this.Eeg,"handleCropSplitButton"),4)):(this.ia.ra(sd.a.K1d,L.a.application,Object(B.a)(this,this.u9b,"handlePictureCropEvent"),4),this.ia.ra(sd.a.L1d,L.a.application,Object(B.a)(this,this.u9b,"handlePictureCropEvent"),4));this.ia.ra(sd.a.lSe,L.a.application,Object(B.a)(this,this.$Vk,"queryIsActive"),101);this.ia.ra(sd.a.ysc,L.a.application,Object(B.a)(this,this.mFj,"handleSendCropInfo"),4);this.ia.ra(sd.a.Gfh,
L.a.application,Object(B.a)(this,this.mfe,"handlePictureCropToShapeEvent"),4);this.ia.ra(sd.a.Ffh,L.a.application,Object(B.a)(this,this.mfe,"handlePictureCropToShapeEvent"),4);this.ia.ra(sd.a.VKb,L.a.application,Object(B.a)(this,this.Xmd,"queryPictureCropBounding"),100);this.ia.ra(sd.a.XKb,L.a.application,Object(B.a)(this,this.Xmd,"queryPictureCropBounding"),100);this.ia.ra(sd.a.WKb,L.a.application,Object(B.a)(this,this.Xmd,"queryPictureCropBounding"),100);this.ia.ra(sd.a.Kpc,L.a.application,Object(B.a)(this,
this.Xmd,"queryPictureCropBounding"),100);this.ia.ra(sd.a.uyd,L.a.application,Object(B.a)(this,this.tyd,"updatePictureCropBounding"),4);this.ia.ra(sd.a.xyd,L.a.application,Object(B.a)(this,this.tyd,"updatePictureCropBounding"),4);this.ia.ra(sd.a.vyd,L.a.application,Object(B.a)(this,this.tyd,"updatePictureCropBounding"),4);this.ia.ra(sd.a.wyd,L.a.application,Object(B.a)(this,this.tyd,"updatePictureCropBounding"),4)}Eeg(La,sb,Ob,pc,Kc){return 1===Ob?32===this.mfe(La,sb,Ob,pc,Kc)||32===this.u9b(La,sb,
Ob,pc,Kc)?32:8:this.u9b(La,sb,Ob,pc,Kc)}mFj(La,sb,Ob,pc,Kc){if(!Kc)return be.a.J(512500482,824,50,"Send Crop Info called with no cropping info"),8;sb=Kc.pictCropperInfo;Kc=Kc.shapeNode;if(!Kc||!Kc.pictureCropInfo)return be.a.J(512500481,824,10,"Send Crop Info called with invalid ShapeMoniker"),8;if(1===Ob)return 32;if(Ob=fe.a.Kb)Ob.actionName="EndCropPicture",Ob.Oj=!1,Ob.vr=!0;Ob=this.Eb.xd(15);try{Ob.hc(Kc),Ob.fd=La,Kc.ioc=sb}finally{Ob&&Ob.dispose()}return 32}mfe(La,sb,Ob,pc,Kc){if(!this.jHg||this.$b.$c(this.pa.hk()))return 8;
sb=this.pa.Qf();if(!sb||!sb.length)return 8;const Gd=[];for(var he of sb)he&&Gd.push(he);if(!Gd.length)return 8;for(const sf of Gd)if(sf.isLocal||this.oM.eX(sf)||!this.x0j(sf))return 8;if(1===Ob)return 32;be.a.J(512500480,824,15,"HandlePictureCropToShapeEvent:: Crop to Shape operation started");const Ue=Kc?Kc.SourceControlId:"";he=0;Ob=Ue.split("_");if(3===Ob.length)he=Number.parseInvariant(Ob[2]);else return be.a.J(512500451,824,10,"HandlePictureCropToShapeEvent:: Crop to Shape operation called with unknown shapeName: '{0}'",
Ue),16;Ob=window.performance.now();Kc=new Hf.a;Kc.TargetShapeTypeAsInt=he;he=this.Eb.xd(15,void 0,()=>{for(const sf of Gd)if(sf.Lv){const ag=this.rk(sf);ag&&ag.PY(!1)}be.a.J(512500450,824,50,"HandlePictureCropToShapeEvent:: Crop to Shape operation called with shapeName: '{0}'",Ue)});try{he.hc(Gd[0]);he.fd=La;for(var Rf of Gd)Rf.joc=Kc}finally{he&&he.dispose()}La=window.performance.now();if(Rf=fe.a.Kb)Rf.actionName="PictureCropToShape",Rf.Wa("PictureCropShapeType",Kc.TargetShapeTypeAsInt.toString()),
Rf.Wa("PictureCropToShapeDuration",(La-Ob).toString()),fe.a.Jaa(Rf);be.a.J(512500449,824,50,"HandlePictureCropToShapeEvent:: Crop to Shape operation completed for shapeType : '{0}'",Kc.TargetShapeTypeAsInt);return 32}u9b(La,sb,Ob){if(!this.kBe||this.$b.$c(this.pa.hk()))return 16;if(this.jna&&!this.bZa.lpg)return be.a.J(512500448,824,10,"HandlePictureCropEvent:: Crop operation failed m_shapeSVGDependencyLoader is not loaded"),8;sb=this.pa.Xd();const pc=this.pa.xVc(sb);if(1!==sb.length)return uf.a("CropCannotBePerformedOnCurrentSelection")&&
1!==Ob&&this.oUf(),8;if(!pc)return 8;if(this.Ga.yx(pc).length)return uf.a("CropCannotBePerformedOnCurrentSelection")&&1!==Ob&&this.oUf(),8;if(!this.Zoe(pc))return 8;if(1===Ob)return 32;if(pc.isLocal||this.oM.eX(pc))return 16;if(pc.Lv){La=this.rk(pc);if(!La)return 8;La.PY(!1);pc.pictureCropInfo=null;sh.App.Lb.updateCommandUI();this.V2a(null===pc||void 0===pc?void 0:pc.Lv);return 32}this.pa.kj();const Kc=this.ta.Ba;this.$b.blockContent(Kc,La);const Gd=fe.a.Kb;Gd&&(Gd.actionName="BeginCropPicture",Gd.Oj=
!1,Gd.vr=!0);this.ai.n$f(pc.get_sid(),pc.get_cid(),pc.get_shapeId(),he=>{fe.a.NF(Gd,()=>{this.BDk(pc,Kc,he)})},()=>this.ADk(pc,Kc),!0);return 32}$Vk(La,sb,Ob,pc,Kc){if(!Object(zc.a)(hf.a,Kc))return 8;La=this.pa.fo();Kc.Hf(La?La.Lv:!1);return 32}WWc(){const La=this.pa.fo();return La&&La.Lv&&La.isConnected?this.c$.dJ(La):null}rk(La){return La?Object(Ub.a)(119,La.qc(this.Gb.Na)):null}oUf(){this.ul.rL(26)}Xmd(La,sb,Ob,pc,Kc){if(!this.kBe||!Kc)return 16;sb=this.WWc();if(!sb)return 16;Ob=sb.h$d();pc=this.Gb.Md;
La=La===sd.a.VKb?pc.gf(this.wi.YH(hd.a.Ql(Ob.ga(0),Ob.ga(3)),sb.zoom),1):La===sd.a.XKb?pc.gf(this.wi.YH(hd.a.Ql(Ob.ga(0),Ob.ga(1)),sb.zoom),0):La===sd.a.WKb?pc.gf(this.wi.YH(Ob.ga(0).x,sb.zoom),0):pc.gf(this.wi.YH(Ob.ga(0).y,sb.zoom),1);Kc=Kc.queryResult;null!==Kc&&(Kc.iba=parseFloat(xf.a.Zv(La).toFixed(2)).toString());return 32}tyd(La,sb,Ob,pc,Kc){if(!this.kBe||this.jna&&!this.bZa.lpg)return 16;sb=this.WWc();if(1===Ob)return sb?32:16;if(!sb||!Kc)return 16;if(2===Ob){Ob=!1;pc=sb.h$d().copy();Kc=xf.a.ZW(Kc.Number);
const Gd=hd.a.Ql(pc.ga(0),pc.ga(1)),he=hd.a.Ql(pc.ga(0),pc.ga(3)),Ue=this.Gb.Md;La===sd.a.uyd?(Kc=this.wi.cN(Ue.Ne(Kc,1),sb.zoom),La=Kc-he,pc.ga(2).IM(0,La),pc.ga(3).IM(0,La)):La===sd.a.xyd?(Kc=this.wi.cN(Ue.Ne(Kc,0),sb.zoom),La=Kc-Gd,pc.ga(1).IM(La,0),pc.ga(2).IM(La,0)):La===sd.a.vyd?(Ob=!0,Kc=this.wi.cN(Ue.Ne(Kc,0),sb.zoom),La=Kc-pc.ga(0).x,pc.move(La,0)):La===sd.a.wyd&&(Ob=!0,Kc=this.wi.cN(Ue.Ne(Kc,1),sb.zoom),La=Kc-pc.ga(0).y,pc.move(0,La));sb.KNl(pc,Ob)}return 32}x0j(La){let sb=[];La.Of?sb=this.Ga.yx(La):
La.Ug&&(sb=this.Ga.yx(La.Cs()));if(sb.length){for(const Ob of sb)if(!this.Zoe(Ob))return!1;return!0}return this.Zoe(La)}Zoe(La){const sb=this.Wo.B4e&&!La.isGif&&(La.qj||1===La.mediaType)&&!La.get_isSVGBlipFilled();return this.I0?sb&&!La.wIb:sb}ADk(La,sb){this.$b.xK(sb);if(!this.isActive||!La.isConnected)return!0;this.isActive=!1;La.pictureCropInfo=null;be.a.J(512500446,824,10,"Error: Failed to perform command of Get picture crop info.");return!1}BDk(La,sb,Ob){this.$b.xK(sb);if(La.isConnected)if(sb=
fe.a.Kb,fe.a.NF(sb,()=>{this.ia.processAction(sd.a.K8a,2)}),this.oM.eX(La))be.a.J(512500445,822,50,"Crop is cancelled due to shape manipulation");else{var pc=La.tg(this.Gb.Na);if(pc){var Kc=new Date;La.pictureCropInfo=JSON.parse(Ob.PictureCropInfoStr);this.c$.ZI(La).DAl();Ob=new Date;sb&&(sb.vm("ParseCropInfoStart",Kc),sb.vm("ParseCropInfoEnd",Ob),fe.a.Jaa(sb));pc.$A();this.V2a(null===La||void 0===La?void 0:La.Lv)}}}V2a(La){this.ia.Ka(sd.a.V2a,2,{["sectionName"]:"Crop",["sectionNewState"]:La})}get isActive(){return this.xEb}set isActive(La){this.xEb=
La}}Object(h.a)(ji,"PictureCropActor",null,[]);var Qi=d(1252),ah=d(200),Kd=d(181),Qd=d(220),Gg=d(133),Sg=d(165),Wh=d(385),Bg=d(871),oh=d(633),Yj=d(49),Gh=d(68),Xh=d(738),Yg=d(124),dg=d(213),Od=d(167),We=d(905),Zj=d(333),ij=d(212),Wd=d(191),ki=d(192),xi=d(283);class Pg{constructor(La,sb,Ob,pc,Kc,Gd,he,Ue,Rf,sf,ag,xg,Tg,li){this.Ab=!0;this.Rk=!1;this.Qn=[];this.b5=this.JB=this.AX=this.MH=this.KJ=this.yb=null;this.tD=Array(8);this.bwa=this.km=this.Tv=null;this.JU=this.od=1;this.XFe=new hd.a(0,0);this.Tn=
new ah.a;this.BR=new Kd.a;this.gkc=new hd.a(0,0);this.Ugb=0;this.Vr=new Kd.a;this.qwa=new hd.a(0,0);this.cna=new hd.a(0,0);this.Bkc=this.IHa=!1;this.xhc=new hd.a(0,0);this.faa=this.G$=null;this.YBg=new gc.a;this.wu=null;if(!pc)throw Error.argumentNull("clickInputManager");if(!La)throw Error.argumentNull("shapeNode");if(ag&&!xg)throw Error.argumentNull("transformFactory");if(ag&&!Tg)throw Error.argumentNull("presReader");this.ua=La;this.Ga=sb;this.jc=Ob;this.Rc=pc;this.ia=Kc;this.wD=Gd;this.le=he;
this.i$=Ue;this.Npk=Rf;this.Dwa=sf;this.jna=ag;this.Kk=xg;this.shk=li}xm(La){this.yb=new Wd.a;this.yb.Zj(1);this.yb.Sd(!1);this.yb.npa(Gh.a.ZBl);La.appendChild(this.yb.viewport);this.KJ=new Xh.a(!1,this.jna);this.yb.appendChild(this.KJ);this.MH=new Xh.a(!1,this.jna);this.yb.appendChild(this.MH);this.MH.Zj(1);this.AX=new Od.a;this.AX.dv(Ad.a.T1);this.AX.ur(Ad.a.hF);this.AX.eF(Yg.a.none);this.AX.Zj(1);this.yb.appendChild(this.AX);this.b5=new Od.a;this.b5.Zj(1);this.b5.Al(Gh.a.Eza);this.b5.npa("ShapeMoveHandle");
this.b5.eF(Yg.a.none);this.yb.appendChild(this.b5);this.JB=new dg.a;this.v3b(this.JB);this.yb.appendChild(this.JB);this.yb.viewport.va.setAttribute("class",Gh.a.noc);this.yb.Sd(!1);this.Rc.rb(J.a.click,this.b5.va,Object(B.a)(this,this.khd,"noOpHandler"));this.Rc.rb(J.a.click,this.AX.va,Object(B.a)(this,this.khd,"noOpHandler"))}v3b(La){for(let pc=0;8>pc;++pc){var sb="cropHandle"+pc;const Kc=new dg.a;Kc.va.id=sb;if(Oc.a.uMa){var Ob=new Zj.a;Ob.va.id=sb;Ob.setVisibility(!1);Ob.setPosition(-10,-10);Ob.ah(20,
20);Kc.appendChild(Ob)}Ob=new Sg.a(pc);sb=Ob.Eac()?this.qKi(Ob,sb):this.xOi(Ob,sb);Kc.appendChild(sb);Kc.Zj(1);this.tD[pc]=Kc;La.appendChild(Kc)}}Zge(La){for(let sb=0;8>sb;++sb)if(this.tD[sb].va.id===La.id)return new Sg.a(sb);return null}V1j(La){return La.id.startsWith("cropHandle")}dispose(){this.i$();this.Rk=!0;this.Ab=!1;this.yb&&this.yb.Dq();this.yb=null;this.b5&&this.Rc.Bb(J.a.click,this.b5.va,Object(B.a)(this,this.khd,"noOpHandler"));this.b5=null;this.AX&&this.Rc.Bb(J.a.click,this.AX.va,Object(B.a)(this,
this.khd,"noOpHandler"));this.JB=this.AX=null;this.tD&&Array.clear(this.tD);this.G$=this.faa=this.tD=null;this.xhc=new hd.a(0,0)}ytd(La,sb,Ob,pc){const Kc=this.Uce(),Gd=La-Kc.x+this.cna.x+Ob,he=sb-Kc.y+this.cna.y+pc;return isNaN(Gd)||isNaN(he)?(be.a.J(512497029,822,15,"PictureCropShapeView::ShiftPositionRelativeToShape - x:{0}, nodeTopLeft.X:{1}, m_maskViewPositionDiff.X:{2}, distX:{3}, y:{4}, nodeTopLeft.Y:{5}, m_maskViewPositionDiff.Y:{6}, distY:{7}, m_zoom:{8}",La,Kc.x,this.cna.x,Ob,sb,Kc.y,this.cna.y,
pc,this.od),new hd.a(0,0)):new hd.a(Gd,he)}setPosition(La,sb){this.IHa&&this.ua.pictureCropInfo&&(this.qwa=La=new hd.a(La/this.od,sb/this.od),this.Dwa?(this.G$&&this.KJ&&(sb=this.ytd(this.G$.Position.X,this.G$.Position.Y,La.x,La.y),this.KJ.setPosition(sb.x,sb.y)),this.faa&&this.MH&&this.MH.image&&(La=this.ytd(this.faa.Position.X,this.faa.Position.Y,La.x,La.y),this.MH.image.setPosition(La.x,La.y))):((sb=this.ua.pictureCropInfo.MaskViewElem)&&this.KJ&&(sb=this.ytd(sb.Position.X,sb.Position.Y,La.x,La.y),
this.KJ.setPosition(sb.x,sb.y)),(sb=this.ua.pictureCropInfo.TextureViewElem)&&this.MH&&this.MH.image&&(La=this.ytd(sb.Position.X,sb.Position.Y,La.x,La.y),this.MH.image.setPosition(La.x,La.y))),this.yb.em())}nzl(La,sb){const Ob=new hd.a(this.Ga.yB(this.ua,this.wD).x/this.od,this.Ga.yB(this.ua,this.wD).y/this.od),pc=new hd.a(this.cna.x+this.qwa.x,this.cna.y+this.qwa.y);if(this.Dwa)this.G$&&this.KJ&&this.KJ.setPosition(this.G$.Position.X-Ob.x+pc.x+La/this.od,this.G$.Position.Y-Ob.y+pc.y+sb/this.od),
this.faa&&this.MH&&this.MH.image.setPosition(this.faa.Position.X-Ob.x+pc.x+La/this.od,this.faa.Position.Y-Ob.y+pc.y+sb/this.od);else{var Kc=this.ua.pictureCropInfo.MaskViewElem;Kc&&this.KJ.setPosition(Kc.Position.X-Ob.x+pc.x+La/this.od,Kc.Position.Y-Ob.y+pc.y+sb/this.od);(Kc=this.ua.pictureCropInfo.TextureViewElem)&&this.MH.image.setPosition(Kc.Position.X-Ob.x+pc.x+La/this.od,Kc.Position.Y-Ob.y+pc.y+sb/this.od)}this.yb.em()}ozl(La,sb){sb.Ij(1/this.JU);this.Ryh(La,ah.a.add(this.e_a,sb))}resize(La,
sb){sb.Ij(1/this.JU);this.Ryh(La,sb)}Ryh(La,sb){La=this.PWd(La,sb);this.vq(La);this.setOffsets(sb)}Uce(){const La=this.Ga.yB(this.ua,this.wD);return new hd.a(La.x/this.od,La.y/this.od)}OOh(){this.ua.Lv&&(this.JU=this.jc.mg(this.ua).Vp/this.XFe.x)}DAl(){const La=this.jc.mg(this.ua);this.XFe.update(La.Vp,La.Vk)}Ij(La){this.od=La;this.yb.Ij(this.od);La=new Kd.a;La.Mca(1/this.od,1/this.od);this.JB.fF(La,ij.a.Wca);this.shk?this.EY(!1):this.EY(!0)}get zoom(){return this.od/this.JU}h$d(){this.OOh();this.Tv||
(this.Tv=this.ua.Jn);var La=hd.a.Ql(this.Tv.ga(0),this.Tv.ga(1));const sb=hd.a.Ql(this.Tv.ga(0),this.Tv.ga(3)),Ob=this.Tv.Zf(),pc=new Gg.a(new hd.a(0,0),new hd.a(La,0),new hd.a(La,sb),new hd.a(0,sb));pc.move(Ob.x-La/2,Ob.y-sb/2);La=this.Uce();pc.move(La.x,La.y);pc.scale(this.JU,this.JU);return pc}KNl(La,sb){La=La.copy();La.scale(1/this.JU,1/this.JU);var Ob=this.Uce();La.move(-1*Ob.x,-1*Ob.y);Ob=La.Zf();const pc=new Kd.a;sb?pc.e8(this.ua.get_shapeRotation(),Ob):pc.e8(this.ua.get_shapeRotation(),this.Tv.ga(0));
pc.ll(La);sb||La.move(this.Tv.ga(0).x-La.ga(0).x,this.Tv.ga(0).y-La.ga(0).y);this.Tv=La;this.AX.Jt(this.Tv.points);sb=this.MH.clipPath;uf.a("SVGCreationOnChangesFromFormatPane")&&this.jna&&sb?(sb.b2b=this.IOc(La),this.WIc(La.ga(0))):sb&&sb.B8a&&sb.B8a.z9e(this.Tv.points);this.Bkc=!0;this.EY(!0);this.yb.em()}setZIndex(La){this.yb.jC(La+2*Wh.a.wha)}setOffsets(La){this.Tv||(this.Tv=this.ua.Jn);this.Fji(La);this.Tn=La;var sb=this.JB.kDb;La=new hd.a(sb[0].x/this.od,sb[0].y/this.od);var Ob=new hd.a(sb[2].x/
this.od,sb[2].y/this.od);const pc=new hd.a(sb[4].x/this.od,sb[4].y/this.od);sb=new hd.a(sb[6].x/this.od,sb[6].y/this.od);La=new Gg.a(La,Ob,pc,sb);this.AX.Jt(this.Tv.points);Ob=this.MH.clipPath;this.jna&&Ob?(this.WIc(hd.a.rV(La.points[this.Ugb],this.gkc)),Ob.b2b=this.IOc(La)):Ob&&Ob.B8a&&Ob.B8a.z9e(La.points);this.yb.em()}Fji(La){var sb=this.Tv,Ob=hd.a.Ql(sb.ga(0),sb.ga(1));sb=hd.a.Ql(sb.ga(0),sb.ga(3));La.bottom-La.top<-1*sb&&(sb+=La.bottom-La.top,La.top+=sb,La.bottom-=sb);La.right-La.left<-1*Ob&&
(Ob+=La.right-La.left,La.left+=Ob,La.right-=Ob)}vq(La){this.BR=La;this.AX.fF(La,ij.a.Wca);this.EY(!0)}Eu(La){this.Vr=La;this.yb.fF(La,ij.a.eub);this.yb.em()}my(){Array.clear(this.Qn)}aD(La){return this.V1j(La)?this.Zge(La):null}QA(La){const sb=[];var Ob=this.ua.pictureCropInfo;if(this.ua.Lv){const pc=this.jc.mg(this.ua);if(Ob.MaskViewElem){let Kc=xi.a.GOc(6,pc.Vp,pc.Vk);Array.add(sb,Kc)}Ob.TextureViewElem&&(Ob=xi.a.GOc(7,pc.Vp,pc.Vk),Array.add(sb,Ob));Array.add(this.Qn,La)}else this.Ab=!1,this.yb.Sd(!1);
return sb}iC(){}hRl(){this.xhc.x!==this.KJ.x&&this.xhc.y!==this.KJ.y&&(be.a.J(512497026,822,50,"PictureCropShapeView::UpdateViewElementPositionForRedraw - Updating maskViewElements and PictureViewElements "),this.G$.Position.X=this.KJ.x+this.Ga.yB(this.ua,this.wD).x/this.od,this.G$.Position.Y=this.KJ.y+this.Ga.yB(this.ua,this.wD).y/this.od,this.faa.Position.X=this.MH.image.x+this.Ga.yB(this.ua,this.wD).x/this.od,this.faa.Position.Y=this.MH.image.y+this.Ga.yB(this.ua,this.wD).y/this.od,this.cna.update(0,
0))}T0b(La,sb){const Ob=this.Kk.POc();this.ua.get_isVerticallyFlipped()&&(Ob.Mca(1,-1),Ob.FC(0,2*sb._y));this.ua.get_isHorizontallyFlipped()&&(Ob.Mca(-1,1),Ob.FC(2*sb._x,0));Ob.e8(La,sb);return Ob}Fbg(){return this.ua.get_isVerticallyFlipped()&&this.ua.get_isHorizontallyFlipped()?2:this.ua.get_isVerticallyFlipped()?3:this.ua.get_isHorizontallyFlipped()?1:0}WIc(La){const sb=new Kd.a;sb.FC(La._x,La._y);this.MH.clipPath.fF(sb,ij.a.Wca)}IOc(La){be.a.J(512497025,809,15,"PictureCropShapeView:: createSVG operation started");
var sb=this.ua.get_shapeRotation();this.Kk.oda(-sb,La.Zf()).ll(La);this.wu||(this.wu=svgShape.FactoryGlobal.createShape());this.wu.setSVGRoot(this.yb.va,!1);this.ua.hL?this.wu.setShapeType(this.ua.hL):(this.wu.setShapeType(4),be.a.J(539760099,809,50,"ShapeNode ArtShapeType is null"));this.wu.setOffsets(this.ua.get_xPersisted()+Qi.a.DY(La.ga(0).x/this.JU,0),this.ua.get_yPersisted()+Qi.a.DY(La.ga(0).y/this.JU,1));this.wu.setExtents(Qi.a.DY(La.ga(1).x-La.ga(0).x,0),Qi.a.DY(La.ga(2).y-La.ga(1).y,1));
var Ob=svgShape.FactoryGlobal.getConvertor().getPath(this.wu,!1,this.JU,this.JU);if(!Ob||!Ob.length)throw be.a.J(512497024,822,15,"PictureCropShapeView::CreateSVG -No response received from getPath"),Error.invalidOperation(" Invalid response for svgpath element");La=Array(Ob.length);sb=0;for(const pc of Ob)Ob=new Od.a,Ob.QY(pc),Ob.va.setAttribute(Yg.a.tQb,this.Vr.Tmb()),La[sb++]=Ob;be.a.J(512496995,809,15,"PictureCropShapeView:: createSVG operation ended");return La}draw(La,sb){if(Array.contains(this.Qn,
La)){Array.remove(this.Qn,La);if(this.ua.pictureCropInfo&&!this.IHa){if(this.ua.pictureCropInfo.MaskViewElem){La=this.ua.pictureCropInfo.MaskViewElem;var Ob=La.Clip,pc=this.jc.mg(this.ua);pc=xi.a.GOc(6,pc.Vp,pc.Vk);if(pc=sb[pc.toString()])this.KJ.sll(pc.Base64Data,La.Id.toString(),Ob.Bounds.Left,Ob.Bounds.Top,Ob.TotalWidth,Ob.TotalHeight,Ob.Bounds.Right-Ob.Bounds.Left,Ob.Bounds.Bottom-Ob.Bounds.Top),this.KJ.Sd(!0),this.KJ.setPosition(La.Position.X-this.Ga.yB(this.ua,this.wD).x/this.od,La.Position.Y-
this.Ga.yB(this.ua,this.wD).y/this.od);this.G$=La;this.xhc=new hd.a(this.KJ.x,this.KJ.y)}this.ua.pictureCropInfo.TextureViewElem?(La=this.jc.mg(this.ua),pc=xi.a.GOc(7,La.Vp,La.Vk),La=this.ua.pictureCropInfo.TextureViewElem,Ob=La.Clip,(sb=sb[pc.toString()])?this.jna?(this.Ugb=this.Fbg(),this.gkc=this.km.points[this.Ugb].copy(),this.WIc(hd.a.rV(this.ua.Jn.points[this.Ugb],this.gkc)),this.Vr=this.T0b(this.ua.get_shapeRotation(),this.ua.Jn.Zf()),this.MH.tll(sb.Base64Data,La.Id.toString(),La.Position.X-
this.Ga.yB(this.ua,this.wD).x/this.od,La.Position.Y-this.Ga.yB(this.ua,this.wD).y/this.od,Ob.TotalWidth,Ob.TotalHeight,this.km.copy().points,this.IOc(this.km.copy()))):this.MH.rll(sb.Base64Data,La.Id.toString(),La.Position.X-this.Ga.yB(this.ua,this.wD).x/this.od,La.Position.Y-this.Ga.yB(this.ua,this.wD).y/this.od,Ob.TotalWidth,Ob.TotalHeight,this.ua.Jn.points):be.a.J(512496993,822,50,"PictureCropShapeView::Draw - No Crop Texture Image Downloaded"),this.faa=La):be.a.J(512496992,822,50,"PictureCropShapeView::Draw - Unable to set image and bounds to polygon as TextureViewElem is null");
this.Tv&&hd.a.Ql(this.Tv.ga(0),this.Tv.ga(2))||(this.Tv=this.ua.Jn);this.bwa=this.ua.y_a;this.b5.Jt(this.bwa.points);this.AX.Jt(this.Tv.points);this.IHa=!0;this.EY(!0);this.visible=this.Ab}else this.Dwa&&this.G$&&this.faa&&(this.hRl(),this.KJ.setPosition(this.G$.Position.X-this.Ga.yB(this.ua,this.wD).x/this.od,this.G$.Position.Y-this.Ga.yB(this.ua,this.wD).y/this.od),this.MH.image.setPosition(this.faa.Position.X-this.Ga.yB(this.ua,this.wD).x/this.od,this.faa.Position.Y-this.Ga.yB(this.ua,this.wD).y/
this.od),this.jna?(this.Ugb=this.Fbg(),this.gkc=this.km.points[this.Ugb].copy(),this.WIc(hd.a.rV(this.ua.Jn.points[this.Ugb],this.gkc)),this.Vr=this.T0b(this.ua.get_shapeRotation(),this.ua.Jn.Zf()),this.MH.clipPath.b2b=this.IOc(this.ua.Jn)):this.MH.clipPath.B8a=new We.a(this.ua.Jn.points,0),this.xhc=new hd.a(this.KJ.x,this.KJ.y),this.Tv=this.ua.Jn,this.bwa=this.ua.y_a,this.b5.Jt(this.bwa.points),this.AX.Jt(this.Tv.points),this.EY(!0),be.a.J(512496991,822,50,"PictureCropShapeView::Draw - Redrawed crop views "));
this.yb.em();this.yb.Sd(this.Ab)}}qNl(){if(this.Tv){var La=this.JB.kDb;const sb=new hd.a(La[0].x/this.od,La[0].y/this.od),Ob=new hd.a(La[2].x/this.od,La[2].y/this.od),pc=new hd.a(La[4].x/this.od,La[4].y/this.od);La=new hd.a(La[6].x/this.od,La[6].y/this.od);this.Tv=new Gg.a(sb,Ob,pc,La)}else this.Tv=this.ua.Jn;this.km=this.Tv.copy();this.bwa||(this.bwa=this.ua.y_a);this.bwa.move(this.qwa.x,this.qwa.y);this.b5.Jt(this.bwa.points);this.cna.IM(this.qwa.x,this.qwa.y);this.qwa.update(0,0);this.le.Py(new ki.a(1))}wcj(){var La=
this.JB.kDb;const sb=new hd.a(La[0].x,La[0].y),Ob=new hd.a(La[2].x,La[2].y),pc=new hd.a(La[4].x,La[4].y);La=new hd.a(La[6].x,La[6].y);return new Gg.a(sb,Ob,pc,La)}yej(){var La=this.ua.y_a.copy().points,sb=new hd.a(La[0].x*this.od,La[0].y*this.od);const Ob=new hd.a(La[1].x*this.od,La[1].y*this.od),pc=new hd.a(La[2].x*this.od,La[2].y*this.od);La=new hd.a(La[3].x*this.od,La[3].y*this.od);sb=new Gg.a(sb,Ob,pc,La);sb.scale(1/this.JU,1/this.JU);sb.move((this.cna.x+this.qwa.x)*this.od,(this.cna.y+this.qwa.y)*
this.od);return sb}JD(La){this.IHa&&(this.JB.Sd(!La),La?(this.OOh(),this.Bkc=!0):(this.qNl(),this.ia.Ka(sd.a.V2a,2,{["sectionName"]:"Crop",["sectionNewState"]:this.IHa}),this.Dwa&&(La={["pictCropperInfo"]:this.mFf(),["shapeNode"]:this.ua},this.ia.Ka(sd.a.ysc,2,La))))}Mp(){return this.yb.Mp()}EY(La){if(this.IHa){var sb=this.Tv.copy();La&&this.BR.ll(sb);La=new Kd.a;La.Fsb(this.ua.get_shapeRotation());var Ob=2*Math.ceil((this.ua.get_shapeRotation()-45)/90)%8;for(let pc=0;8>pc;++pc){const Kc=this.tD[pc];
Kc.Al(Yj.a.QN(Qd.a.box4Image(Pg.asc[Ob]),Gh.a.XA));this.KLa(Kc,sb.Tj(new Sg.a(pc)));Kc.fF(La,ij.a.eub);Ob=(Ob+1)%8}}}KLa(La,sb){La.x===sb.x*this.od&&La.y===sb.y*this.od||La.setPosition(sb.x*this.od,sb.y*this.od)}get visible(){return this.Ab}set visible(La){this.Ab=La;!La&&this.IHa&&(this.T0i(),this.IHa=!1);this.yb.Sd(this.Ab)}T0i(){if(this.IHa){if(this.Bkc){const La={["pictCropperInfo"]:this.mFf(),["shapeNode"]:this.ua};this.ia.Ka(sd.a.ysc,2,La)}this.r3()}}mFf(){let La,sb,Ob,pc;const Kc=this.Ivi();
({left:La,top:sb,right:Ob,bottom:pc}=this.sEi());return Object.assign(new Bg.a,{Left:La,Top:sb,Right:Ob,Bottom:pc,X:Kc.x,Y:Kc.y})}sEi(){let La,sb,Ob,pc;({left:La,top:sb,right:Ob,bottom:pc}=this.BTi());({left:La,top:sb,right:Ob,bottom:pc}=this.aIi(La,sb,Ob,pc));({left:La,top:sb,right:Ob,bottom:pc}=Pg.PSl(La,sb,Ob,pc));return{left:La,top:sb,right:Ob,bottom:pc}}BTi(){let La,sb,Ob;var pc=this.bwa.points;const Kc=this.Tv.points;La=oh.a(pc[3],pc[0],Kc[3],Kc[0]);sb=oh.a(pc[0],pc[1],Kc[0],Kc[1]);Ob=oh.a(pc[1],
pc[2],Kc[1],Kc[2]);pc=oh.a(pc[2],pc[3],Kc[2],Kc[3]);return{left:La,top:sb,right:Ob,bottom:pc}}aIi(La,sb,Ob,pc){var Kc=this.bwa.points;const Gd=hd.a.Ql(Kc[0],Kc[1]);Kc=hd.a.Ql(Kc[1],Kc[2]);La=Math.floor(La/Gd*1E6)/1E6;sb=Math.floor(sb/Kc*1E6)/1E6;Ob=Math.floor(Ob/Gd*1E6)/1E6;pc=Math.floor(pc/Kc*1E6)/1E6;return{left:La,top:sb,right:Ob,bottom:pc}}Ivi(){var La=this.Tv.copy(),sb=new Kd.a,Ob=La.Zf();sb.e8(-1*this.ua.get_shapeRotation(),Ob);sb.ll(La);Ob=this.Ga.yB(this.ua,this.wD);this.Npk?(sb=this.wD.gf(La.ic*
this.od+Ob.x,0),La=this.wD.gf(La.kc*this.od+Ob.y,1),La=new hd.a(sb,La)):La=new hd.a(La.ic+Ob.x/this.od,La.kc+Ob.y/this.od);return hd.a.scale(La,this.JU,this.JU)}khd(){return!0}r3(){this.AX.fF(new Kd.a,ij.a.Wca);this.b5.setPosition(0,0);this.Tn=new ah.a;this.km=this.Tv=this.BR=this.ua.pictureCropInfo=null;this.cna.update(0,0);this.Bkc=!1;this.XFe.update(0,0);this.JU=1}PWd(La,sb){const Ob=new Kd.a;this.km||(this.km=La);La=this.km.Zf();const pc=hd.a.Ql(this.km.ga(0),this.km.ga(1)),Kc=hd.a.Ql(this.km.ga(0),
this.km.ga(3)),Gd=pc?1+(sb.right-sb.left)/pc:1,he=Kc?1+(sb.bottom-sb.top)/Kc:1,Ue=La.copy();Ue.IM(-1*pc/2,-1*Kc/2);Ob.e8(-1*this.ua.get_shapeRotation(),La);Ob.FC(-1*Ue.x,-1*Ue.y);Ob.Mca(Gd,he);Ob.FC(sb.left+Ue.x,sb.top+Ue.y);Ob.e8(this.ua.get_shapeRotation(),La);return Ob}qKi(La,sb){var Ob=[new hd.a(0,0),new hd.a(20,0),new hd.a(20,5),new hd.a(5,5),new hd.a(5,20),new hd.a(0,20)];Ob=new We.a(Ob,0);Ob.va.id=sb;Ob.eF("black");Ob.dv("white");Ob.ur(1);La.equals(Sg.a.VE)?Ob.RLa(90):La.equals(Sg.a.Wu)?Ob.RLa(0):
La.equals(Sg.a.jF)?Ob.RLa(180):La.equals(Sg.a.dI)&&Ob.RLa(-90);return Ob}xOi(La,sb){const Ob=new Zj.a;Ob.va.id=sb;Ob.eF("black");Ob.dv("white");Ob.ur(1);Ob.ah(20,5);La.equals(Sg.a.north)?Ob.setPosition(-10,0):La.equals(Sg.a.south)?Ob.setPosition(-10,-5):La.equals(Sg.a.east)?(Ob.setPosition(-5,-10),Ob.ah(5,20)):La.equals(Sg.a.west)&&(Ob.setPosition(0,-10),Ob.ah(5,20));return Ob}get e_a(){return this.Tn}get we(){return this.yb.viewport}qce(La){return!this.ua.Lv&&8>La.index?this.tD[La.index].va:null}KL(){return!1}Xw(La){La&&
(this.Bkc=!1)}setSelection(){}static PSl(La,sb,Ob,pc){.999999<La+Ob&&(be.a.J(512496987,822,15,"Invalid crop region inset values: left({0}), right({1})",La,Ob),Ob=(999999-1E6*La)/1E6);.999999<sb+pc&&(be.a.J(512496986,822,15,"Invalid crop region inset values: top({0}), bottom({1})",sb,pc),pc=(999999-1E6*sb)/1E6);return{left:La,top:sb,right:Ob,bottom:pc}}}Pg.asc=[Gh.a.KFh,Gh.a.IFh,Gh.a.JFh,Gh.a.HFh,Gh.a.MFh,Gh.a.LFh,Gh.a.NFh,Gh.a.OFh];Object(h.a)(Pg,"PictureCropShapeView",null,[717,239,240,107]);var Ej=
d(670);class Hh{constructor(La,sb,Ob){this.Ga=La;this.wD=sb;this.c$=Ob}setPosition(La,sb,Ob){this.c$.dJ(La.shapeNode).nzl(sb,Ob)}setOffsets(La,sb){this.c$.dJ(La.shapeNode).ozl(La.L8e.copy(),sb)}YI(La,sb){const Ob=new Kd.a,pc=this.c$.dJ(La.shapeNode);sb=sb?pc.wcj().copy():pc.yej().copy();La=this.Ga.yB(La.shapeNode,this.wD);Ob.FC(La.x,La.y);Ob.ll(sb);return new Ej.a(sb)}wG(La){return La.shapeNode.Lv}}Object(h.a)(Hh,"ShapeCropMoveResizeHandler",null,[709]);class gh{constructor(La,sb,Ob){this.c$=La;this.Dwa=
sb;this.Cbd=Ob}PY(La,sb,Ob){if((La=this.c$.dJ(La))&&La.visible!==Ob){for(const pc of sb)this.Cbd&&(sb=Object(Ub.a)(706,pc))&&sb.setSelected(!Ob),pc!==La&&(pc.visible=!Ob);La.visible=Ob}}Rtd(){return!1}Zxd(La,sb,Ob){this.c$.dJ(La).resize(Ob,sb)}Std(){return!1}$xd(La,sb,Ob,pc){pc&&this.c$.dJ(La).setPosition(sb,Ob)}E3c(){return!this.Dwa}N$a(La,sb){return this.Dwa?sb:[this.c$.dJ(La)]}wG(La){return La.Lv}}Object(h.a)(gh,"ShapeViewCropUpdateStrategyHandler",null,[707,708]);var Ie=d(342);class eg{constructor(){this.K=
null}get name(){return"PowerPointWebEditor.PictureCrop"}Yb(La){this.K=La;this.K.register(191,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>").ma().oa(()=>new Ie.a((sb,Ob)=>{let pc=null;const Kc=Object(Ub.a)(119,sb.qc(this.K.resolve("Box4.IPageView").Na));Kc&&!Kc.Nl&&(pc=new Pg(sb,this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("Box4.IPageView").Md,this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),Ob,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditingSetPictureCropInfoCommandUsingMU,this.K.resolve("PowerPointWebEditor.IApplicationSettings").ZOe,this.K.resolve("PowerPointWebEditor.IApplicationSettings").tld,this.K.resolve("PowerPointWebEditor.ITransformFactory"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").T7d),
pc.xm(Kc.va),pc.setZIndex(3),pc.visible=!1,Kc.sK(pc.we.va,!0),Kc.Yra(pc,3));return pc}));this.K.register(ji,"PowerPointWebEditor.PictureCropActor").ma().oa(()=>new ji(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").y0j,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").YOe,this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),this.K.resolve("PowerPointWebEditor.IGraphHotColdManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").ela,
this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").tld,this.K.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),this.K.resolve("PowerPointWebEditor.IBusinessBarController")));this.K.register(Yf,"PowerPointWebEditor.FormatPicturePaneActor").ma().oa(()=>new Yf(this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IFocusManager"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings"),Jd.a(this.K)))}init(){this.K.resolve("PowerPointWebEditor.ViewElements.ICompositeShapeViewUpdateStrategy").addHandler(new gh(this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").ZOe,this.K.resolve("PowerPointWebEditor.IApplicationSettings").uld));this.K.resolve("PowerPointWebEditor.ISmartGuideUtility").addHandler(new Hh(this.K.resolve("PowerPointWebEditor.IShapeReader"),
this.K.resolve("Box4.IPageView").Md,this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>")));this.K.resolve("PowerPointWebEditor.PictureCropActor").vb();this.K.resolve("PowerPointWebEditor.FormatPicturePaneActor").vb();this.K.resolve("PowerPointWebEditor.FormatPicturePaneActor").pe()}dispose(){}static main(){r.a.instance.Ac(Ee.a(new eg,0))}}Object(h.a)(eg,"PPTWebEditorPictureCropPackage",null,[2,3]);var yi=d(41),Fj=d(246);class Yh{constructor(La,
sb,Ob,pc,Kc){this.mA=[yi.a.Zi,yi.a.font,Ib.a.autonumberBulletType];this.Rb=La;this.Yl=sb;this.Gh=Ob;this.Vic=pc;this.IJ=Kc}format(La){if(La&&La.YBb){La=this.Rb.Lc(La);for(var sb=this.Yl.A3(La,La.currentNode);sb.moveNext();){var Ob=sb.currentNode;if(Ob&&this.Gh.ae(Ob)){const pc=this.IJ.BQ(La,this.Gh.Hib(Ob));(Ob=this.Vic.cWc(Ob))&&Fj.d(pc,Ob,this.mA)}}}}}Object(h.a)(Yh,"BeautifyListFormatter",null,[681]);class ei{constructor(La,sb,Ob,pc,Kc){this.ia=La;this.ta=Ob;this.Eb=sb;this.Ga=pc;this.Vek=Kc}initialize(){this.vb()}vb(){this.ia.ra(sd.a.YUd,
L.a.application,Object(B.a)(this,this.YUd,"applyTextFormatterSuggestion"),4)}YUd(La,sb,Ob){if(1===Ob)return 32;La=this.ta.Ba;if(!La)return 16;sb=La.Uj();if(!sb||!sb.length)return 16;sb=this.Ga.K_(sb);if(!sb.length)return 16;Ob=this.Eb.xd(15);Ob.hc(La);for(const pc of sb)this.Vek.format(pc);Ob.dispose();return 32}}Object(h.a)(ei,"TextFormatterActor",null,[]);class Hi{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TextFormatter"}Yb(La){this.K=La;La.register(681,"PowerPointWebEditor.IBeautifyListFormatter").ma().oa(()=>
new Yh(this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),this.K.resolve("PowerPointWebEditor.IPptListEditor")));La.register(ei,"PowerPointWebEditor.TextFormatter.TextFormatterActor").ma().oa(()=>new ei(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.IBeautifyListFormatter")))}init(){const La=this.K.resolve("Common.IAppSettingsManager");La.ff(()=>{La.ka("818")&&this.K.resolve("PowerPointWebEditor.TextFormatter.TextFormatterActor").initialize()})}dispose(){}static main(){r.a.instance.Ac(Ee.a(new Hi,0))}}Object(h.a)(Hi,"PPTWebEditorTextFormatterPackage",null,[2,3]);var yh=d(13);Type.registerNamespace("Box4.Symbols");Type.registerNamespace("PowerPointWebEditor");
Type.registerNamespace("PowerPointWebEditor.PictureCrop");Type.registerNamespace("PowerPointWebEditor.TellMe");Type.registerNamespace("PowerPointWebEditor.TextFormatter");Object(yh.c)("Chronos1");Na.main();Type.registerNamespace("Common.App.O365Shell");jc.main();Type.registerNamespace("Common.App.SessionExpiration");Type.registerNamespace("Common.App.SessionExpiration");Zb.main();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");
Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");Og.main();window.TellMeAdditionalControls={name:"CommandUI",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.Animation",Command:"0x9F8ACB60",LabelText:"STR@L_AnimationTab"},children:[{name:"Menu",attrs:{Id:"PptTellMe.Animation.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptTellMe.Animation.MenuSection",DisplayMode:"Thin"},children:[{name:"Gallery",attrs:{Id:"PptTellMe.Animation.Gallery",ElementDimensions:"Size64by48",
Width:"3"},children:[{name:"GalleryButton",attrs:{Id:"Existing",Command:"0x11CFD1C3",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingButtonDescription"}},{name:"GalleryButton",attrs:{Id:"None",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationNone",Alt:"STR@L_AnimationNone"}},{name:"GalleryButton",attrs:{Id:"Appear",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",
LabelText:"STR@L_AnimationAppear",Alt:"STR@L_AnimationAppear"}},{name:"GalleryButton",attrs:{Id:"FadeIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFadeIn",Alt:"STR@L_AnimationFadeIn"}},{name:"GalleryButton",attrs:{Id:"FlyIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyIn",Alt:"STR@L_AnimationFlyIn"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.AnimationNew",
Command:"0x9F8ACB60",LabelText:"STR@L_AnimationTab"},children:[{name:"Menu",attrs:{Id:"AnimationGallery"},children:[{name:"MenuSection",attrs:{Id:"AnimationGalleryNone"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery1",ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"ExistingInMenu",Command:"0x4B65244F",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingButtonDescription"}},{name:"GalleryButton",attrs:{Id:"None",Command:"0x9F8ACB60",
QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationNone",Alt:"STR@L_AnimationNone"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationEntrance",Id:"AnimationGalleryEntrance"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery2",ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Appear",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationAppear",Alt:"STR@L_AnimationAppear"}},
{name:"GalleryButton",attrs:{Id:"FadeIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFade",Alt:"STR@L_AnimationFade"}},{name:"GalleryButton",attrs:{Id:"FlyIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyIn",Alt:"STR@L_AnimationFlyIn"}},{name:"GalleryButton",attrs:{Id:"Split",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",
LabelText:"STR@L_AnimationSplit",Alt:"STR@L_AnimationSplit"}},{name:"GalleryButton",attrs:{Id:"Wipe",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationWipe",Alt:"STR@L_AnimationWipe"}},{name:"GalleryButton",attrs:{Id:"RandomBars",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRandomBars",Alt:"STR@L_AnimationRandomBars"}},{name:"GalleryButton",attrs:{Id:"GrowAndTurn",
Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationGrowAndTurn",Alt:"STR@L_AnimationGrowAndTurn"}},{name:"GalleryButton",attrs:{Id:"Zoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationZoom",Alt:"STR@L_AnimationZoom"}},{name:"GalleryButton",attrs:{Id:"BasicZoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBasicZoom",
Alt:"STR@L_AnimationBasicZoom"}},{name:"GalleryButton",attrs:{Id:"Blinds",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBlinds",Alt:"STR@L_AnimationBlinds"}},{name:"GalleryButton",attrs:{Id:"Box",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBox",Alt:"STR@L_AnimationBox"}},{name:"GalleryButton",attrs:{Id:"Checkerboard",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",
InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationCheckerboard",Alt:"STR@L_AnimationCheckerboard"}},{name:"GalleryButton",attrs:{Id:"Expand",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationExpand",Alt:"STR@L_AnimationExpand"}},{name:"GalleryButton",attrs:{Id:"PeekIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationPeekIn",Alt:"STR@L_AnimationPeekIn"}},
{name:"GalleryButton",attrs:{Id:"RiseUp",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRiseUp",Alt:"STR@L_AnimationRiseUp"}},{name:"GalleryButton",attrs:{Id:"Stretch",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStretch",Alt:"STR@L_AnimationStretch"}},{name:"GalleryButton",attrs:{Id:"Strips",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",
LabelText:"STR@L_AnimationStrips",Alt:"STR@L_AnimationStrips"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationEmphasis",Id:"AnimationGalleryEmphasis"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery3",ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Emphasis_Spin",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSpin",Alt:"STR@L_AnimationSpin"}},{name:"GalleryButton",attrs:{Id:"Emphasis_GrowShrink",
Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationGrowShrink",Alt:"STR@L_AnimationGrowShrink"}},{name:"GalleryButton",attrs:{Id:"Emphasis_Transparency",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationTransparency",Alt:"STR@L_AnimationTransparency"}},{name:"GalleryButton",attrs:{Id:"Emphasis_LineColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",
LabelText:"STR@L_AnimationLineColor",Alt:"STR@L_AnimationLineColor"}},{name:"GalleryButton",attrs:{Id:"Emphasis_FillColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFillColor",Alt:"STR@L_AnimationFillColor"}},{name:"GalleryButton",attrs:{Id:"Emphasis_FontColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFontColor",Alt:"STR@L_AnimationFontColor"}}]}]},
{name:"MenuSection",attrs:{Title:"STR@L_AnimationExit",Id:"AnimationGalleryExit"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery4",ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Exit_Disappear",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationDisappear",Alt:"STR@L_AnimationDisappear"}},{name:"GalleryButton",attrs:{Id:"Exit_Fade",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",
ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFade",Alt:"STR@L_AnimationFade"}},{name:"GalleryButton",attrs:{Id:"Exit_FlyOut",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyOut",Alt:"STR@L_AnimationFlyOut"}},{name:"GalleryButton",attrs:{Id:"Exit_Split",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSplit",Alt:"STR@L_AnimationSplit"}},{name:"GalleryButton",
attrs:{Id:"Exit_Wipe",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationWipe",Alt:"STR@L_AnimationWipe"}},{name:"GalleryButton",attrs:{Id:"Exit_RandomBars",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRandomBars",Alt:"STR@L_AnimationRandomBars"}},{name:"GalleryButton",attrs:{Id:"Exit_Zoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",
LabelText:"STR@L_AnimationZoom",Alt:"STR@L_AnimationZoom"}},{name:"GalleryButton",attrs:{Id:"Exit_BasicZoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBasicZoom",Alt:"STR@L_AnimationBasicZoom"}},{name:"GalleryButton",attrs:{Id:"Exit_Blinds",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBlinds",Alt:"STR@L_AnimationBlinds"}},{name:"GalleryButton",attrs:{Id:"Exit_Box",
Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBox",Alt:"STR@L_AnimationBox"}},{name:"GalleryButton",attrs:{Id:"Exit_Checkerboard",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationCheckerboard",Alt:"STR@L_AnimationCheckerboard"}},{name:"GalleryButton",attrs:{Id:"Exit_PeekOut",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",
LabelText:"STR@L_AnimationPeekOut",Alt:"STR@L_AnimationPeekOut"}},{name:"GalleryButton",attrs:{Id:"Exit_Stretchy",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStretchy",Alt:"STR@L_AnimationStretchy"}},{name:"GalleryButton",attrs:{Id:"Exit_Strips",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStrips",Alt:"STR@L_AnimationStrips"}}]}]}]}]},{name:"FlyoutAnchor",
attrs:{Id:"PptTellMe.Transition",Command:"0x78ACF6A1",LabelText:"STR@L_TransitionTab"},children:[{name:"Menu",attrs:{Id:"PptTellMe.Transition.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptTellMe.Transition.MenuSection",DisplayMode:"Thin"},children:[{name:"Gallery",attrs:{Id:"PptTellMe.Transition.Gallery",ElementDimensions:"Size64by48",Width:"2"},children:[{name:"GalleryButton",attrs:{Id:"TransitionExisting",Command:"0xDFACB0EC",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",
Alt:"STR@L_ExistingTransitionButtonDescription"}},{name:"GalleryButton",attrs:{Id:"TransitionNone",Command:"0x78ACF6A1",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionNone",Alt:"STR@L_TransitionNone"}},{name:"GalleryButton",attrs:{Id:"TransitionFade",Command:"0x78ACF6A1",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionFade",Alt:"STR@L_TransitionFade"}},{name:"GalleryButton",attrs:{Id:"TransitionPush",
Command:"0x78ACF6A1",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionPush",Alt:"STR@L_TransitionPush"}}]}]}]}]},{name:"Button",attrs:{Id:"PptTellMe.Designer",Command:"0x9531543E",LabelText:"STR@L_ShowHideDesignerPane"}},{name:"Button",attrs:{Id:"PptTellMe.Ideas",Command:"0x76FF601A",Image16by16:"IMGMAP@per@LightningIdeasHandraiseState_16x16x32",LabelText:"STR@L_IdeasButtonHomeRibbon"}},{name:"Button",attrs:{Id:"PptTellMe.SelectAll",Command:"0x148D0534",
Image16by16:"IMGMAP@per@SelectAll_16x16x32",LabelText:"STR@L_SelectAllButton"}},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.GroupShapesUpSellButton",LabelText:"STR@L_GroupShapesUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",
Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTGroupShapes",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.WordArtUpSellButton",
LabelText:"STR@L_WordArtUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",
ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTWordArt",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.SpellCheckDictUpSellButton",LabelText:"STR@L_SpellCheckDictUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},
children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",
attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTSpellCheckDict",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertAudioUpSellButton",LabelText:"STR@L_InsertAudioUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",
Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTInsertAudio",
LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertChartUpSellButton",LabelText:"STR@L_InsertChartUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",
attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTInsertChart",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",
Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.WordArtUpSellButtonEnterprise",LabelText:"STR@L_WordArtUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",
Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.SpellCheckDictUpSellButtonEnterprise",LabelText:"STR@L_SpellCheckDictUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",
Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertAudioUpSellButtonEnterprise",LabelText:"STR@L_InsertAudioUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",
Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertChartUpSellButtonEnterprise",LabelText:"STR@L_InsertChartUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",
LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]}]};eg.main();Hi.main();Type.registerNamespace("NLRT");Object(yh.b)("Chronos1")},138:function(K,U,d){d.d(U,"a",function(){return e});K=d(0);var h=d(225);class e{constructor(r,m){this.SOa=!1;const {Annotations:n}=d(80);if(!r)throw Error.argumentNull("annotations");if(!r.Eqe(m))throw Error.argument("memberTypeID","Invalid type ID");if(n.pC(m))throw Error.argument("memberTypeID",
"Lists of lists are not permitted");this.Mr=r;this.A2h=m;this.xC=[]}get btb(){return this.Mr}get isReadOnly(){return this.SOa}get QU(){return this.A2h}get items(){return this.xC}o2(){const {Annotations:r}=d(80);let m="[";for(let n=0,z=this.items.length;n<z;++n){0<n&&(m+=", ");const v=this.Mr.o2(this.QU,this.items[n]);this.QU===r.kZ?(m+='"',m+=h.a.S5d(v),m+='"'):m+=v}return m+"]"}isEqual(r){const {Annotations:m}=d(80);if(this===r)return!0;if(!r||r.btb!==this.Mr||r.QU!==this.QU||r.items.length!==this.items.length)return!1;
for(let n=0;n<this.items.length;++n)if(!m.j3a(this.QU,this.items[n],r.items[n]))return!1;return!0}clone(){const r=new e(this.Mr,this.QU);Array.addRange(r.items,this.items);return r}mL(){return this.isReadOnly?this.clone():this}ese(){const {Annotations:r}=d(80);if(!this.isReadOnly){this.SOa=!0;for(const m of this.items)r.ldb(m)}}toString(){return this.o2()}}Object(K.a)(e,"ListValue",null,[1057,1056])},144:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}h.tellMe="TellMe";h.contextMenu=
"ContextMenu";h.unknown="Unknown";Object(K.a)(h,"TellMeScenario",null,[])},160:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(e,r,m=null,n=null,z=4,v=-99999,x=0){this.MTd="";this.HJc=-1;this.value=e;this.type=r;this.subType=z;this.label=this.dK=m;this.groupType=30;this.description=n;this.score=v;this.count=x}}Object(K.a)(h,"ResultBinding",null,[])},175:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(e){this.attributes=null;this.query=e;this.Wk=
[]}Aq(e){this.Wk.push(e)}$nh(e){const r=[];for(const m of this.Wk)m.groupType!==e&&r.push(m);this.Wk.length!==r.length&&(this.Wk=r)}get tBb(){return!1}}Object(K.a)(h,"SimpleResultsUpdatedEventArgs",null,[766])},176:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(e=30,r=""){this.c6h=[];this.groupType=e;this.displayName=r}get results(){return this.c6h}us(e){e.groupType=this.groupType;Array.add(this.results,e)}fVe(e=1){if(this.results.length>=e)for(let r=0;r<e;r++)Array.removeAt(this.results,
this.results.length-1)}}Object(K.a)(h,"SimpleResultGroup",null,[767])},225:function(K,U,d){K=d(0);class h{constructor(r,m){this.aRa=r;this.value=m}}Object(K.a)(h,"AttrValuePair",null,[]);d.d(U,"a",function(){return e});class e{constructor(r){this.SOa=!1;if(!r)throw Error.argumentNull("annotations");this.Mr=r;this.wO=[]}get btb(){return this.Mr}get isReadOnly(){return this.SOa}get Efe(){return 0<this.wO.length}jn(r){if(!this.Mr.bCb(r))throw Error.argument("attributeID","Invalid attribute ID");for(const m of this.wO)if(r===
m.aRa)return r=m.value,{returnValue:!0,value:r};return{returnValue:!1,value:null}}Du(r,m){var {Annotations:n}=d(80);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.Mr.bCb(r))throw Error.argument("attributeID","Invalid attribute ID");if(!this.Mr.$Ab(this.Mr.getAttributeType(r),m))throw Error.argument("value","Value is not of the correct type for the specified attribute");n.ldb(m);for(n=0;n<this.wO.length;++n){const z=this.wO[n];if(r===
z.aRa){z.value=m;return}}Array.add(this.wO,new h(r,m))}Mod(r){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.Mr.bCb(r))throw Error.argument("attributeID","Invalid attribute ID");for(let m=0;m<this.wO.length;++m)if(r===this.wO[m].aRa){Array.removeAt(this.wO,m);break}}oTc(r){if(!r)throw Error.argumentNull("action");for(const m of this.wO)r(m.aRa,m.value)}clone(){const r=new e(this.Mr);r.oDa(this);return r}oDa(r){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");
if(!r)throw Error.argumentNull("other");if(r.btb!==this.Mr)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.wO);r.oTc((m,n)=>{this.Du(m,n)})}o2(){const {Annotations:r}=d(80);let m="[",n=!0;for(const z of this.wO){n?n=!1:m+=", ";m+=this.Mr.Z3f(z.aRa);m+="=";const v=this.Mr.getAttributeType(z.aRa),x=this.Mr.o2(v,z.value);v===r.kZ?(m+='"',m+=e.S5d(x),m+='"'):m+=x}return m+"]"}isEqual(r){const {Annotations:m}=d(80);if(!r)throw Error.argumentNull("other");if(this===r)return!0;
if(!r||this.Mr!==r.btb||this.Efe!==r.Efe)return!1;let n=0,z=null,v=!1;r.oTc((x,B)=>{++n;if(!v){var D=-1;for(let w=0,J=this.wO.length;w<J;++w)if(this.wO[w].aRa===x){D=w;break}0>D?v=!0:(z||(z=Array(this.wO.length)),z[D]=B)}});if(this.wO.length!==n||v)return!1;for(let x=0,B=this.wO.length;x<B;++x)if(!m.j3a(this.Mr.getAttributeType(this.wO[x].aRa),this.wO[x].value,z[x]))return!1;return!0}mL(){return this.isReadOnly?this.clone():this}ese(){const {Annotations:r}=d(80);if(!this.isReadOnly){this.SOa=!0;for(const m of this.wO)r.ldb(m.value)}}toString(){return this.o2()}static S5d(r){return r.replace("\\",
"\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(K.a)(e,"FeatureBundle",null,[1055,1056])},263:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}h.click="Click";h.pAb="InteractionBegin";h.Rkg="InteractionEnd";h.rNf="ControlActivated";h.query="Query";h.mjh="QueryIndexRecorded";h.ILf="Clicks";h.owf="ActionEvents";h.N_f="FilteredActionEvents";h.Jvh="SessionContext";h.latency="Latency";h.performance="Performance";h.Sph="RenderedResults";h.events="Events";h.SNi="CreateResultsMenu";
h.BG="UpdateRibbonControls";h.wcl="ResultsAggregation";h.FB="IssueQuery";h.nDi="CommandSuggestions";h.error="Error";h.Xre="LoadModelData";h.KSi="DepsResolveTime";h.Awk="ModelDataWaitTime";h.timedOut="TimedOut";h.cji="AddinQueryCommandReady";h.Q$i="GetAddinEntitlements";h.Wih="ProviderMRUEvents";h.kYi="EnableAddinSearchCommands";Object(K.a)(h,"EventNames",null,[])},278:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.HEe=null;this.Az=this.pGe=0}HTc(e,r,m){if(!e)throw Error.argumentNull("referenceList");
if(0>r||r>e.length)throw Error.argumentOutOfRange("startIndex");if(0>m||m>e.length)throw Error.argumentOutOfRange("length");if(r+m>e.length)throw Error.argument("Invalid start-length range");this.HEe=e;this.pGe=r;this.Az=m}xTa(e,r,m){this.HTc(e.HEe,e.pGe+r,m)}ga(e){if(0>e||e>=this.Az)throw Error.argumentOutOfRange("index");return this.HEe[this.pGe+e]}get count(){return this.Az}static k1d(e){const r=new h;r.HTc(e,0,e.length);return r}}Object(K.a)(h,"ReadOnlyList",null,[1078])},303:function(K,U,d){d.d(U,
"a",function(){return h});K=d(0);var h;(function(e){e[e.Classifier=0]="Classifier";e[e.AppsForOffice=1]="AppsForOffice";e[e.FindInDocument=2]="FindInDocument";e[e.FindInDocumentScopedSearch=3]="FindInDocumentScopedSearch";e[e.RecentlyUsed=4]="RecentlyUsed";e[e.TryQuery=5]="TryQuery";e[e.Empty=6]="Empty";e[e.TryCommand=7]="TryCommand";e[e.Assistance=8]="Assistance";e[e.Answer=9]="Answer";e[e.Definition=10]="Definition";e[e.Entity=11]="Entity";e[e.WolframAnswer=12]="WolframAnswer";e[e.Insights=13]=
"Insights";e[e.People=14]="People";e[e.Document=15]="Document";e[e.Recommended=16]="Recommended";e[e.ServiceClassifier=17]="ServiceClassifier";e[e.ServiceRecommended=18]="ServiceRecommended";e[e.Image=19]="Image";e[e.Notes=20]="Notes";e[e.Learning=21]="Learning";e[e.Feedback=22]="Feedback";e[e.Template=23]="Template";e[e.ActionAI=24]="ActionAI";e[e.ActionAICommand=25]="ActionAICommand";e[e.SummarizeDeck=26]="SummarizeDeck";e[e.Addin=27]="Addin";e[e.OfficeScript=28]="OfficeScript";e[e.AddinStoreEntry=
29]="AddinStoreEntry";e[e.None=30]="None";e[e.MergedActions=31]="MergedActions";e[e.MergedScopedSearches=32]="MergedScopedSearches";e[e.MergedSuggestedSearches=33]="MergedSuggestedSearches"})(h||(h={}));Object(K.b)("ResultGroupType",h)},343:function(K,U,d){d.r(U);d.d(U,"CommandResultsUtility",function(){return B});K=d(0);var h=d(388),e=d(263),r=d(389),m=d(160),n=d(176),z=d(117),v=d(108),x=d(27);class B{static TQb(D,w){if(w&&w.Pp){const J={};for(const G of D)w.y3c(G)&&(J[G]=appChrome.selectors.getModelType(G));
z.TellMeActor.instance.BG(J)}}static aFl(D){return D.startsWith("btnTellMeOfficeAddIn")}static Cac(D){const w=z.TellMeActor.instance.hH();return!!w&&w.Pp&&!appChrome.selectors.isControlDisabled(D)}static V4c(D,w,J,G){if(z.TellMeActor.instance.Jd&&D){const M=[];for(const N of D)M.push(String.format('{{"Id":"{0}","Score":{1}}}',N.commandId,N.score));D={};D[h.a.suggestions]="[{"+M.join(",")+"}]";D[h.a.wtg]=w;D[h.a.groupType]=J;D[h.a.provider]=G;z.TellMeActor.instance.Jd.OH(e.a.nDi,window.performance.now(),
D)}}static Wdj(D,w){const J=[],G=[];for(const M of w){w=M.commandId;let N=M;M.commandId in D&&(w=D[M.commandId],N=new r.a(w,M.score));Array.contains(G,w)||(J.push(N),G.push(w))}return J}static f8b(D,w,J,G,M,N,R,C){J.e$d&&(w=B.Wdj(J.e$d,w));var O=v.a.Ycj(w);B.TQb(O,J);var S=[],T=[];O=[];const ca=new n.a(R);R=16===R||18===R||7===R||4===R?x.AFrameworkApplication.fa?x.AFrameworkApplication.fa.wc("TellMeMaxRecommendedResultsToReturn",3):3:0===R||17===R||25===R?5:0;for(const L of w)if(!B.VUj(L.commandId)){w=
B.aFl(L.commandId);if(J.y3c(L.commandId)&&!w){if(v.a.Csg(L.commandId))continue;w=null;M&&N&&(w=M.tnj(L.commandId,N));B.Cac(L.commandId)?Array.add(S,new m.a(L.commandId,5,w,null,C,L.score)):Array.add(T,new m.a(L.commandId,5,w,null,C,L.score))}else J.J7a&&w&&G&&Array.add(O,L.commandId.substr(21));if(S.length+O.length>=R)break}J=0;for(M=0;M<S.length&&J<R;M++,J++)ca.us(S[M]);for(S=0;S<T.length&&J<R;S++,J++)ca.us(T[S]);for(T=0;T<O.length&&J<R;T++,J++)G.fZl(D,O[T],ca);return ca}static VUj(D){B.DEf||(x.AFrameworkApplication.fa&&
x.AFrameworkApplication.fa.Lu("TellMeControlPredictionBlockList")&&x.AFrameworkApplication.fa.eA("TellMeControlPredictionBlockList").forEach(w=>{Array.add(B.CEf,w.toLowerCase())}),B.DEf=!0);return Array.contains(B.CEf,D.toLowerCase())}static Kme(D){return 2<D.length&&";"===D.charAt(0)&&";"===D.charAt(D.length-1)&&!!x.AFrameworkApplication.fa&&(x.AFrameworkApplication.fa.ka("TellMeCommandHookIsEnabled")||x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",
!1))}static p5f(D){const w=new n.a(0);var J=D.split(";");D=z.TellMeActor.instance.hH();for(const G of J)if(0<G.length){J=G.split(":");const M=2===J.length?J[0]:G;if(!D.y3c(M))break;if(1===J.length)J=new m.a(M,5,null,null,1),w.us(J);else if(2===J.length)J=new m.a(M,5,J[1],null,1),w.us(J);else break}return w}static nci(D,w,J){if(!(w&&w.results&&D&&D.results&&D.results.length))return{returnValue:!1,kSd:D,KSd:w};const G=[];for(var M of w.results)Array.add(G,M.value);M=0;const N=0<w.results.length?w.results[0].score:
0;for(const R of D.results)if(R.score>J&&!Array.contains(G,R.value)&&B.Cac(R.value)&&(0<N&&(R.score=N),Array.insert(w.results,M,R),M++),2===M)break;return 0<M?(J=w.results.length-5,0<J&&w.fVe(J),{returnValue:!0,kSd:D,KSd:w}):{returnValue:!1,kSd:D,KSd:w}}}B.DEf=!1;B.CEf=[];Object(K.a)(B,"CommandResultsUtility",null,[])},388:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}h.appName="AppName";h.dDa="CloseAllMenus";h.commandId="CommandId";h.context="Context";h.culture="Culture";h.message=
"Message";h.errorMessage="ErrorMessage";h.event="Event";h.r9="CorrelationID";h.eMk="ParentUiElement";h.query="Input";h.tjb="QueryID";h.ojh="QueryLength";h.SKb="QueryIndex";h.xcl="ResultsList";h.suggestions="Suggestions";h.scenario="Scenario";h.sessionId="SessionID";h.source="Source";h.timeStamp="Time";h.LLh="UiElement";h.jod="ReactUx";h.value="Val";h.statusCode="StatusCode";h.sil="Service";h.isSuccess="IsSuccess";h.TGl="TokenAcquired";h.F7j="LatencyType";h.groupName="GroupName";h.Sab="GroupIndex";
h.groupType="GroupType";h.tcl="ResultInfoList";h.resultType="ResultType";h.o4e="SubResultType";h.vYj="IsInputBlur";h.wYj="IsInputFocus";h.g3j="IsShortCutUsed";h.actionType="ActionType";h.count="Count";h.iXi="DwellTime";h.wtg="IsZeroTerm";h.tVl="WordsCount";h.L2c="IsSearchUxEnabled";h.B4j="IsTellMeInHeaderEnabled";h.module="Module";h.resultIndex="ResultIndex";h.S3d="DisplayIndex";h.tYi="EnableList";h.provider="Provider";h.contentType="ContentType";h.K2j="IsSelectionBased";h.kpi="BeginPerformanceMarker";
h.UYi="EndPerformanceMarker";h.iOk="PerformanceMeasure";Object(K.a)(h,"Columns",null,[])},389:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(e,r){this.commandId=e;this.score=r}}Object(K.a)(h,"CommandSuggestion",null,[])},453:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{static xwc(e){if(!e)return"{NULL}";const r=e.length;return 600>=r?e:e.substring(0,400)+"[...]"+e.substring(r-195,r)}}Object(K.a)(h,"LogUtils",null,[])},454:function(K,U,d){d.d(U,"a",function(){return h});
K=d(0);class h{}h.tellMe="TellMe";h.loki="Loki";h.substrate="Substrate";h.SKb="QueryIndex";h.WHh="TellMeRanker";h.XHh="TellMeRankerLogging";Object(K.a)(h,"Services",null,[])},455:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}h.xua="HttpRequest";h.provider="Provider";Object(K.a)(h,"LatencyTypes",null,[])},554:function(K,U,d){K=d(0);class h{constructor(){this.hwc=this.J$b=null;this.rIe=this.score=this.hlc=0}jOe(J,G,M){this.score=J.ga(G);++G;this.J$b=J.ga(G)?M.b9(J.ga(G)):null;++G;
this.hwc=J.ga(G)?M.b9(J.ga(G)):null;++G;this.hlc=J.ga(G);++G;this.rIe=J.ga(G);++G;return G}}Object(K.a)(h,"TokenStringGeneratorInit",null,[]);class e{constructor(J,G,M,N,R){this.oTa=J;this.count=G;this.YSc=M;this.dH=N;this.depth=R}}Object(K.a)(e,"ErrorTolerantTrieMatch",null,[]);var r=d(719),m=d(1012);class n{constructor(J=null,G=0,M=0,N=0){this.y9h=J||new m.a;this.Ida=G;this.dH=M;this.depth=N}get AV(){return this.y9h}getKey(){return this.AV.ut.toString()+":"+this.Ida.toString()}}Object(K.a)(n,"TrieBookmark",
null,[]);class z{constructor(J,G){this.qxa=J;this.QCe=G}Ldk(J){if(null==J)throw Error.argumentNull("prefix");let G={};var M=G[""]=new n;this.sZc(M,G);for(M=0;M<J.length;++M){const N=J.charCodeAt(M),R={};for(let C in G)this.Wji(N,G[C],R);G=R}return this.$Hl(G)}sZc(J,G){if(!(J.dH>=this.QCe)&&(J=new n(r.a.qZd(J.AV),J.Ida,J.dH+1,J.depth),J.AV.Qz&r.a.vNa&&(J.Ida+=1),this.qxa.bnb(J.AV))){J.depth+=1;let M=!0;for(;M;)z.syd(J,G),this.sZc(J,G),J.Ida+=this.qxa.Yxb(J.AV,!0)+(J.AV.Qz&r.a.vNa?1:0),M=this.qxa.qwc(J.AV)}}Wji(J,
G,M){G.dH+1<=this.QCe&&(G.dH+=1,z.syd(G,M),--G.dH);G.AV.Qz&r.a.vNa&&(G.Ida+=1);if(this.qxa.bnb(G.AV)){G.depth+=1;let N=!0;for(;N;)G.AV.Gnb===J?(z.syd(G,M),this.sZc(G,M)):G.dH+1<=this.QCe&&(G.dH+=1,z.syd(G,M),this.sZc(G,M),--G.dH),G.Ida+=this.qxa.Yxb(G.AV,!0)+(G.AV.Qz&r.a.vNa?1:0),N=this.qxa.qwc(G.AV)}}$Hl(J){const G=[];for(var M in J){const N=J[M];if(!N.AV.ut)continue;const R=!!(N.AV.Qz&r.a.vNa),C=this.qxa.Yxb(N.AV,!1)+(R?1:0);Array.add(G,new e(N.Ida,C,R,N.dH,N.depth))}G.sort((N,R)=>{let C=N.oTa-
R.oTa;return C||(C=-(N.count-R.count))?C:C=N.depth-R.depth});if(2>G.length)return G;J=[];for(M=0;M<G.length;)M+=z.BJh(M,G,J);return J}static syd(J,G){const M=J.getKey();M in G?(G=G[M],G.dH=Math.min(G.dH,J.dH)):G[M]=new n(r.a.qZd(J.AV),J.Ida,J.dH,J.depth)}static BJh(J,G,M){const N=G[J];let R=N.oTa;const C=R+N.count;let O=1,S=N.YSc;for(;J+O<G.length&&G[J+O].oTa<C;){const T=G[J+O];T.oTa>R&&(Array.add(M,new e(R,T.oTa-R,S,N.dH,N.depth)),S=!1);O+=z.BJh(J+O,G,M);R=T.oTa+T.count}R<C&&Array.add(M,new e(R,
C-R,S,N.dH,N.depth));return O}}Object(K.a)(z,"ErrorTolerantTrieLookupEngine",null,[1132]);class v extends h{constructor(J,G,M){super();this.gjg=this.Bch=!1;this.kYf=null;if(J){var N=0;try{N=this.jOe(J,N,G);this.Bch=1===J.ga(N);++N;this.gjg=1===J.ga(N);++N;const R=J.ga(N);this.kYf=this.uMk(M,R)}catch(R){throw Error.argument("initData");}}}uMk(J,G){return new z(J,G)}}Object(K.a)(v,"FuzzyMatchTokenStringGeneratorInit",h,[]);class x extends h{constructor(J,G){super();this.query=this.name=null;if(J){this.annotations=
G.annotations;var M=0;try{M=this.jOe(J,M,G),this.name=G.$C(J.ga(M)),++M,this.query=G.oE(J.ga(M))}catch(N){throw Error.argument("initData");}}}}Object(K.a)(x,"QueryTokenStringGeneratorInit",h,[]);class B extends h{constructor(J,G){super();if(J)try{this.jOe(J,0,G)}catch(M){throw Error.argument("initData");}}}Object(K.a)(B,"SurfaceStringTokenStringGeneratorInit",h,[]);var D=d(278);d.d(U,"a",function(){return w});class w{constructor(J){this.Ute=J}get J$b(){return this.Ute.J$b}get hwc(){return this.Ute.hwc}get hlc(){return this.Ute.hlc}static create(J,
G,M){const {SurfaceStringTokenStringGenerator:N}=d(1173),{QueryTokenStringGenerator:R}=d(1174),{FuzzyMatchTokenStringGenerator:C}=d(1175);let O=0;try{if(J.ga(O)!==w.d8a)throw Error.argument("initData","Input does not represent a token string generator");++O;const S=J.ga(O);++O;const T=new D.a;T.xTa(J,O,J.count-O);switch(S){case N.a1b:return new N(new B(T,G));case R.a1b:return new R(new x(T,G));case C.a1b:return new C(new v(T,G,M));default:throw Error.argument("initData");}}catch(S){throw Error.argument("initData");
}}static Fyf(J,G,M,N,R,C){J=J.$Gl.getId(G,null);if(0>J)return++C,C;w.Gyf(J,M,N,R);return C}static Gyf(J,G,M,N){Array.add(N.V3e,J);Array.add(N.zFh,G);++N.nQb[M]}}w.d8a=1099767983;Object(K.a)(w,"TokenStringGenerator",null,[1095])},707:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);d=d(160);class h extends d.a{constructor(e,r,m,n,z=null){super(e,r,z,null,m);this.id=n}}Object(K.a)(h,"TryQueryResultBinding",d.a,[])},708:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(e){this.Ja=
e}get IJa(){return this.Ja.IJa}get FCl(){return 4!==this.Ja.style}get ICl(){return!0}get trie(){return this.Ja.trie}getId(e,r){if(!this.FCl)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Ja.style){case 0:return this.Cij(e,r);default:throw Error.notImplemented();}}$C(e){if(!this.ICl)throw Error.invalidOperation("String lookup not supported on this string table");if(0>e||e>=this.IJa)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Ja.style){case 0:return this.qtj(e);
case 4:return this.ptj(e);default:throw Error.notImplemented();}}Cij(e,r){e=this.Ja.trie.Xwg(e,0,e.length,r);if(!e.succeeded)return-1;if(0>e.wQb||e.wQb>=this.Ja.IJa)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Ja.rwc?this.Ja.tqc.Cu(this.Ja.rwc+4*e.wQb,4):e.wQb}qtj(e){if(this.Ja.rwc){let r=0;for(;r<this.Ja.IJa&&this.Ja.tqc.Cu(this.Ja.rwc+4*r,4)!==e;++r);if(r>=this.Ja.IJa)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Ja.trie.Kbg(r)}return this.Ja.trie.Kbg(e)}ptj(e){const r=
this.Ja.tqc.Cu(this.Ja.xFh+4*e,4);e=this.Ja.tqc.Cu(this.Ja.yFh+4*e,4);if(0>e||0>r)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const m=Array(r);for(let n=0;n<r;++n)m[n]=({PJj:e}=this.U_k(e)).returnValue;return String.fromCharCode.apply(null,m)}U_k(e){let r=0;for(let m=0;3>m;++m){const n=this.Ja.tqc.ga(this.Ja.hJf+e)^182;++e;r|=(n&127)<<7*m;if(!(n&128))break}return{returnValue:r,PJj:e}}}Object(K.a)(h,"StringTable",null,[1077])},709:function(K,U,d){d.d(U,"a",function(){return e});
K=d(0);var h=d(719);class e{constructor(r){this.trie=null;this.hJf=this.xFh=this.yFh=this.rwc=0;if(r){this.tqc=r;var m=0;if(r.Cu(m,4)!==e.d8a)throw Error.argument("bytes","Input does not represent a string table");m+=4;this.IJa=r.Cu(m,4);m+=4;this.style=r.Cu(m,4);m+=4;switch(this.style){case 0:const n=1===r.Cu(m,4);m+=4;n||(this.rwc=m,m+=4*this.IJa);r.Cu(m,4);this.trie=this.YMk(r,m+4);break;case 4:this.yFh=m;this.xFh=m+=4*this.IJa;m+=4*this.IJa;r.Cu(m,4);this.hJf=m+4;break;default:throw Error.argument("bytes");
}}}YMk(r,m){return new h.a(r,m)}}e.d8a=1025118440;Object(K.a)(e,"StringTableInit",null,[])},710:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);var h;(function(e){e[e.Answer=0]="Answer";e[e.Definition=1]="Definition";e[e.Entity=2]="Entity";e[e.WolframAnswer=3]="WolframAnswer";e[e.Assistance=4]="Assistance";e[e.Command=5]="Command";e[e.Document=6]="Document";e[e.TryQuery=7]="TryQuery";e[e.FindInDocument=8]="FindInDocument";e[e.HelpAction=9]="HelpAction";e[e.Insights=10]="Insights";e[e.People=
11]="People";e[e.Image=12]="Image";e[e.FirstRunResult=13]="FirstRunResult";e[e.NoCommandsFoundResult=14]="NoCommandsFoundResult";e[e.TestResult=15]="TestResult";e[e.AppsForOffice_Installed=16]="AppsForOffice_Installed";e[e.AppsForOffice_Recommandation=17]="AppsForOffice_Recommandation";e[e.AppsForOffice_Query=18]="AppsForOffice_Query";e[e.Notes_Onenote=19]="Notes_Onenote";e[e.Notes_Samsung=20]="Notes_Samsung";e[e.Notes_Sticky=21]="Notes_Sticky";e[e.Learning=22]="Learning";e[e.Feedback=23]="Feedback";
e[e.Template=24]="Template";e[e.ActionAI=25]="ActionAI";e[e.ActionAICommand=26]="ActionAICommand";e[e.Addin=27]="Addin";e[e.OfficeScript=28]="OfficeScript";e[e.AddinStoreEntry=29]="AddinStoreEntry";e[e.GenerateSlides=30]="GenerateSlides";e[e.SummarizeDeck=31]="SummarizeDeck";e[e.Unknown=32]="Unknown"})(h||(h={}));Object(K.b)("ResultType",h)},719:function(K,U,d){K=d(0);class h{constructor(v){this.J5g=v;this.succeeded=!1;this.wQb=v?v.wQb:0;this.y4j=!1;this.length=this.pEl=0}}Object(K.a)(h,"TrieResult",
null,[]);class e{constructor(v,x,B){this.Ko=new h(null);this.flk=v;this.ngc=x;this.wCg=x+B-1}get result(){return this.Ko}v9f(){let v;return this.ngc<=this.wCg?(v=this.flk.charAt(this.ngc),++this.ngc,{returnValue:!0,ch:v}):{returnValue:!1,ch:"\x00"}}JUe(v,x,B){v&&(this.Ko.y4j=!0,this.Ko.pEl=x);this.Ko.length=this.ngc;this.Ko.succeeded=!0;this.Ko.wQb=B;this.ngc!==this.wCg+1&&(this.Ko=new h(this.Ko))}}Object(K.a)(e,"LookUpStringVisitor",null,[1093]);var r=d(1012);class m{constructor(){this.PIf=this.hGf=
this.jGf=this.gGf=this.iGf=this.XWd=this.WWd=this.ZWd=this.VWd=0}}Object(K.a)(m,"TRIESTATS",null,[]);class n{constructor(){this.symbol=this.cmc=0}}Object(K.a)(n,"TrieSymbol",null,[]);d.d(U,"a",function(){return z});class z{constructor(v,x){this.KU=null;this.c9c=this.OFg=this.MFg=this.QFg=this.IFg=this.PFg=this.NFg=this.RFg=this.JFg=0;this.kD=v;if(v.Cu(x,4)!==z.d8a)throw Error.argument("Input does not represent a trie");x+=4;this.aDg=1===v.Cu(x,4);x+=4;this.Ugk=1===v.Cu(x,4);x+=4;this.Fgk=v.Cu(x,4);
x+=4;if(v.Cu(x,4)){v=x+4;this.KU=this.W_k(v);this.JFg=x=v+z.Rti;this.RFg=x+=z.kLc*(this.KU.VWd+(this.KU.VWd%2?1:0));this.NFg=x+=z.kLc*(this.KU.ZWd+(this.KU.ZWd%2?1:0));this.PFg=x+=z.kLc*(this.KU.WWd+(this.KU.WWd%2?1:0));this.IFg=x+=z.kLc*(this.KU.XWd+(this.KU.XWd%2?1:0));this.QFg=x+=z.dXd*this.KU.gGf;this.MFg=x+=z.eXd*this.KU.jGf;this.OFg=x+=z.eXd*this.KU.hGf;x+=z.eXd*this.KU.iGf;if(x!==v+this.KU.PIf)throw Error.argument("Corrupted trie binary");this.c9c=x}else this.KU=null}Xwg(v,x,B,D){v=new e(v,
x,B);this.sQh(v,D);return v.result}Kbg(v){if(this.aDg)if(v)--v;else return"";if(!this.KU)throw Error.argument("Invalid trieID");const x=new r.a;x.Qz=0;this.bnb(x);const B=[];for(;;){if(x.Qz&z.vNa)if(v)--v;else return Array.add(B,x.Gnb),String.fromCharCode.apply(null,B);const D=!!(x.Qz&z.Uzd),w=this.Yxb(x,!0);if(D||v<w){if(Array.add(B,x.Gnb),!this.bnb(x))throw Error.argument("Invalid trieID");}else if(v-=w,!this.qwc(x))throw Error.argument("Invalid trieID");}}sQh(v,x){let B=0;this.aDg&&(v.JUe(this.Ugk,
this.Fgk,0),++B);if(this.KU){var D=new r.a;D.Qz=0;if(this.bnb(D))for(;;){var w=void 0;if(!({ch:w}=v.v9f()).returnValue)break;x&&(w=x(w));w=w.toString().charCodeAt(0);let J=!1;for(;!J;){const G=!!(D.Qz&z.vNa);if(D.Gnb===w){if(J=!0,G&&v.JUe(!!(D.Qz&z.uaf),D.Rvd,B),!this.bnb(D))return}else if(B+=this.Yxb(D,!0),!this.qwc(D))return;G&&++B}}}}bnb(v){if(!v.Qz)return this.e7e(v),!0;if(!(v.Qz&z.Tzd))return!1;v.zua=0;v.ut=v.gVa;this.e7e(v);return!0}qwc(v){if(v.Qz&z.Uzd)return!1;this.e7e(v);return!0}Yxb(v,x){return v.Qz&
z.taf?v.hLc:v.Qz&z.Tzd?!x&&v.Qz&z.Uzd?this.bej(v):1:0}bej(v){v=z.qZd(v);if(!this.bnb(v))return 0;let x=0;do v.Qz&z.vNa&&++x,x+=this.Yxb(v,!1);while(this.qwc(v));return x}e7e(v){v.Qz||(v.zua=0,v.ut=this.c9c);var x=this.pPc(this.JFg,v.ut),B=x.symbol;v.ut+=x.cmc;x=this.kD.Cu(this.IFg+z.dXd*B,z.dXd);v.Gnb=x&65535;v.Qz=x>>16;v.Qz&z.taf&&(v.hLc=this.hRi(v));v.Qz&z.uaf&&(x=this.pPc(this.RFg,v.ut),B=x.symbol,v.ut+=x.cmc,v.Rvd=this.kD.Cu(this.QFg+4*B,4));v.Qz&z.JSh?(v.gVa=this.c9c+((this.kD.ga(v.ut)<<8|this.kD.ga(v.ut+
1))<<8|this.kD.ga(v.ut+2)),v.ut+=3):v.Qz&z.KSh?(v.gVa=v.ut,v.zua=v.gVa):v.Qz&z.LSh?(x=this.pPc(this.NFg,v.ut),B=x.symbol,v.ut+=x.cmc,v.gVa=this.c9c+this.kD.Cu(this.MFg+4*B,4)):v.Qz&z.Tzd&&(x=this.pPc(this.PFg,v.ut),B=x.symbol,v.ut+=x.cmc,v.zua||(v.zua=v.ut),v.zua+=this.kD.Cu(this.OFg+4*B,4),v.gVa=v.zua)}pPc(v,x){const B=new n;let D=0;for(;;){D+=this.kD.ga(x);++x;++B.cmc;const w=this.kD.Cu(v,2);if(D<w)break;B.symbol+=w;D-=w;v+=2;D<<=8}B.symbol+=D;return B}hRi(v){let x=this.kD.ga(v.ut);192<=x?(x=(x&
63)<<15|(this.kD.ga(v.ut+1)&127)<<8,x|=this.kD.ga(v.ut+2),v.ut+=3):128<=x?(x=(x&127)<<8|this.kD.ga(v.ut+1),v.ut+=2):v.ut+=1;return x}W_k(v){const x=new m;x.VWd=this.kD.Cu(v+12,2);x.ZWd=this.kD.Cu(v+14,2);x.WWd=this.kD.Cu(v+16,2);x.XWd=this.kD.Cu(v+18,2);x.iGf=this.kD.Cu(v+24,4);x.gGf=this.kD.Cu(v+28,4);x.jGf=this.kD.Cu(v+32,4);x.hGf=this.kD.Cu(v+36,4);x.PIf=this.kD.Cu(v+40,4);return x}static qZd(v){const x=new r.a;x.Gnb=v.Gnb;x.Qz=v.Qz;x.hLc=v.hLc;x.ut=v.ut;x.gVa=v.gVa;x.zua=v.zua;x.Rvd=v.Rvd;return x}}
z.d8a=1654263084;z.Rti=48;z.kLc=2;z.eXd=4;z.dXd=4;z.vNa=1;z.Uzd=2;z.taf=4;z.uaf=8;z.Tzd=16;z.KSh=64;z.LSh=128;z.JSh=256;Object(K.a)(z,"Trie",null,[1091])},721:function(K,U,d){d.r(U);K=d(0);d(144);var h=d(263);class e{}e.marketPlace=0;e.catalog=1;e.privateCatalog=10;Object(K.a)(e,"AppsForOfficeStoreType",null,[]);var r=d(117),m=d(27),n=d(82),z=d(37);class v{constructor(){this.cPd=0}LRe(N,R){this.cPd=window.performance.now();this.k3a(()=>{const C=window.performance.now(),O={},S=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinUseLocalStoreTypeClass",
!0);R.Zzf&&(O.callback=T=>{N(T,e.marketPlace,C)},S&&(O.storeType=e.marketPlace),m.AFrameworkApplication.Ra.Ka(z.a.a0a,2,O));R.$zf&&(O.callback=T=>{N(T,e.privateCatalog,C)},S?O.storeType=e.privateCatalog:m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",!0)?O.storeType=10:O.storeType=e.privateCatalog,m.AFrameworkApplication.Ra.Ka(z.a.a0a,2,O))},0,()=>{if(r.TellMeActor.instance.Jd)r.TellMeActor.instance.Jd.onError("AddinEntitlementsQuery:QueryEntitlementAsync",
"Query entitlements timeout after "+(window.performance.now()-this.cPd)+" ms")})}k3a(N,R=0,C=null){2!==m.AFrameworkApplication.Ra.processAction(z.a.a0a,1)?(r.TellMeActor.instance.Jd&&r.TellMeActor.instance.Jd.OH(h.a.cji,window.performance.now()-this.cPd),N()):R<v.jvk?m.AFrameworkApplication.Ae.Hb(new n.a(2,1,v.mUl,()=>{this.k3a(N,R+1,C)})):C&&C()}static get instance(){v.La||(v.La=new v);return v.La}}v.La=null;v.jvk=20;v.mUl=500;Object(K.a)(v,"AddinEntitlementsQuery",null,[]);class x{constructor(){this.description=
this.id=this.displayName=null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.$qe=this.storeType=this.storeId=this.uVk=this.iconUrl=null}}Object(K.a)(x,"AddinInfo",null,[]);var B=d(160),D=d(176),w=d(175),J=d(108),G=d(70);d.d(U,"AddinResultsProvider",function(){return M});class M{constructor(N){this.TMd=[];this.ub=N;this.xDk=(R,C,O)=>{if(R){const S=R.errorCode;if(r.TellMeActor.instance.Jd){const T={};T.StoreType=C;T.ErrorCode=S;T.AddinCount=R.value?
R.value.length:0;r.TellMeActor.instance.Jd.OH(h.a.Q$i,window.performance.now()-O,T)}if(0===S&&R.value){M.C7a=M.C7a||{};R=R.value;for(const T of R)R=new x,R.displayName=T[0],R.id=T[1],R.description=T[2],R.targetType=T[3],R.appVersion=4<T.length?T[4]:"",R.assetId=5<T.length?T[5]:"",R.assetStoreId=6<T.length?T[6]:"",R.width=7<T.length?T[7]:0,R.height=8<T.length?T[8]:0,R.iconUrl=9<T.length?T[9]:"",R.uVk=10<T.length?T[10]:"",R.storeId=11<T.length?T[11]:"",R.storeType=12<T.length?T[12]:"",R.$qe=this.Bjj(R),
M.C7a[R.id]=R,0<R.iconUrl.length&&(C="AddinIcon_"+R.id,m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)?this.Jmh(C,R.iconUrl):appChrome.addInApi.registerAddinIcon(C,R.iconUrl))}}};v.instance.LRe(this.xDk,this.ub)}sE(){return"Add-ins"}GL(){return 0===this.ub.Fq?0:1===this.ub.Fq?1:2}FB(N,R,C,O,S=null){C=new w.a(N);S&&!Array.contains(S,27)||J.a.$F(N)||(S=new D.a(27),S.displayName=CommonUIStrings.l_TellMeAddinProviderTitle,this.jjj(N.Cf,
S),C.Aq(S));R.resultsUpdated(C)}jjj(N,R){if((N=this.Wfl(N))&&0<N.length){let C=0;N.forEach(O=>{if(!(3<++C)){var S="AddinSuggestion"+C,T={};if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)){var ca="AddinIcon_"+O.id;0>Array.indexOf(this.TMd,ca)&&0<O.iconUrl.length&&this.Jmh(ca,O.iconUrl);T["default"]=0<=Array.indexOf(this.TMd,ca)?ca:"AppForOfficeLogo_20"}else T["default"]=0<O.iconUrl.length?"AddinIcon_"+O.id:"AppForOfficeLogo_20";
ca=[];ca.push(appChrome.actions.setControlLabel(S,O.displayName));ca.push(appChrome.actions.setControlIconSet(S,T));ca.push(appChrome.actions.setCompoundButtonCommandValueId(S,O.id));ca.push(appChrome.actions.updateCompoundButtonDescription(S,O.description));m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchEnableCommands",!0)&&(T=window.performance.now(),ca.push(appChrome.actions.updateControlEnabledDisabledState(S,!1)),r.TellMeActor.instance.Jd&&r.TellMeActor.instance.Jd.OH(h.a.kYi,
window.performance.now()-T));appChrome.api.dispatch(ca);S=new B.a(S,27,void 0,void 0,1);S.MTd=Telemetry.PrivacyRules.GetPrivacyCompliantId(O.id,O.storeType,O.assetId,null,null,O.storeId);R.us(S)}})}}Jmh(N,R){G.c()&&appChrome.addInApi.registerAddinIcon&&(appChrome.addInApi.registerAddinIcon(N,R),Array.add(this.TMd,N))}Wfl(N){if(!M.C7a)return null;const R=[],C=M.C7a;for(let S in C){var O=C[S];O&&M.Duk(N,O)&&Array.add(R,O)}return R}Bjj(N){return M.gAl(N.displayName)}static Duk(N,R){if(!R.$qe)return!1;
for(const C of N.split(" ")){N=!1;for(const O of R.$qe)if(O.toLowerCase().startsWith(C.toLowerCase())){N=!0;break}if(!N)return!1}return!0}static gAl(N){const R=[];for(const C of N.split(" ")){N=0;for(let O=0;O<C.length;O++){const S=C.charAt(O);S.toString().toUpperCase()===S.toString()&&O>N&&(Array.add(R,C.substring(N,O)),N=O)}Array.add(R,C.substring(N,C.length));N&&Array.add(R,C.substring(0,C.length))}return R}}M.C7a=null;Object(K.a)(M,"AddinResultsProvider",null,[750])},80:function(K,U,d){d.r(U);
K=d(0);var h=d(19),e=d(225),r=d(138),m=d(708),n=d(709);class z{constructor(x,B){this.SOa=!1;this.U4=null;if(!x)throw Error.argumentNull("annotations");if(!x.cCb(B))throw Error.argument("structTypeID","Invalid struct type ID");this.Mr=x;this.hDb=this.Mr.G9f(B);this.l8h=B}get btb(){return this.Mr}get isReadOnly(){return this.SOa}get Dza(){return this.l8h}VTa(x){if(0>x||x>=this.hDb)throw Error.argument("iField","Invalid field index");return this.U4&&null!=this.U4[x]?this.U4[x]:this.Mr.Lbg(this.Dza,x)}NZe(x,
B){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>x||x>=this.hDb)throw Error.argument("iField","Invalid field index");if(!this.Mr.$Ab(this.Mr.zab(this.Dza,x),B))throw Error.argument("value","Value is not of the correct type for the specified field");(this.U4||(this.U4=Array(this.hDb)))[x]=B}o2(){const {Annotations:x}=d(80);let B="[";if(this.U4){let D=!0;for(let w=0;w<this.hDb;++w){if(null==this.U4[w])continue;const J=this.Mr.zab(this.Dza,
w);if(x.j3a(J,this.U4[w],this.Mr.Lbg(this.Dza,w)))continue;D?D=!1:B+=", ";B+=this.Mr.Mbg(this.Dza,w);B+="=";const G=this.Mr.o2(J,this.U4[w]);J===x.kZ?(B+='"',B+=e.a.S5d(G),B+='"'):B+=G}}return B+"]"}isEqual(x){const {Annotations:B}=d(80);if(this===x)return!0;if(!x||this.Mr!==x.btb||this.Dza!==x.Dza)return!1;for(let D=0;D<this.hDb;++D)if(!B.j3a(this.Mr.zab(this.Dza,D),this.VTa(D),x.VTa(D)))return!1;return!0}clone(){const x=new z(this.Mr,this.Dza);this.U4&&(x.U4=Array.clone(this.U4));return x}mL(){return this.isReadOnly?
this.clone():this}ese(){const {Annotations:x}=d(80);if(!this.isReadOnly&&(this.SOa=!0,this.U4))for(let B=0;B<this.hDb;++B){const D=this.U4[B];null!=D&&x.ldb(D)}}toString(){return this.o2()}}Object(K.a)(z,"StructValue",null,[1058,1056]);d.d(U,"Annotations",function(){return v});class v{constructor(x,B){if(!x)throw Error.argumentNull("initData");if(!B)throw Error.argumentNull("objectFetcher");this.sgk=B.zWi;let D=0;var w=B.ITa(x.ga(D));++D;this.wGe=new m.a(new n.a(w));this.XXh=x.ga(D);++D;this.CCg=
Array(this.ERc);this.xfc=Array(this.ERc);this.zXa=Array(this.ERc);for(w=0;w<this.ERc;++w){this.CCg[w]=B.$C(x.ga(D));++D;this.xfc[w]=x.ga(D);++D;var J=x.ga(D);++D;this.zXa[w]=Array(J);for(var G=0;G<J;++G)this.zXa[w][G]=B.$C(x.ga(D)),++D}this.k8h=x.ga(D);++D;this.p_g=Array(this.Juc);this.ked=Array(this.Juc);this.led=Array(this.Juc);this.jed=Array(this.Juc);for(w=0;w<this.Juc;++w)for(this.p_g[w]=B.$C(x.ga(D)),++D,J=x.ga(D),++D,this.ked[w]=Array(J),this.led[w]=Array(J),this.jed[w]=Array(J),G=0;G<J;++G)this.ked[w][G]=
B.$C(x.ga(D)),++D,this.led[w][G]=x.ga(D),++D,this.jed[w][G]=({l4:D}=this.Vsa(this.led[w][G],x,D,null,null,null)).returnValue,v.ldb(this.jed[w][G]);this.vUh=x.ga(D);++D;this.Kte=Array(this.Atb);this.Lte=Array(this.Atb);this.Jte=Array(this.Atb);for(w=0;w<this.Atb;++w)this.Kte[w]=B.$C(x.ga(D)),++D,this.Lte[w]=x.ga(D),++D,this.Jte[w]=({l4:D}=this.Vsa(this.Lte[w],x,D,null,null,null)).returnValue,v.ldb(this.Jte[w])}Z6b(x){for(let B=0;B<this.Atb;++B)if(this.Kte[B]===x)return B;return-1}Z3f(x){if(!this.bCb(x))throw Error.argument("attrID",
"Invalid attribute ID");return this.Kte[x]}getAttributeType(x){if(!this.bCb(x))throw Error.argument("attrID","Invalid attribute ID");return this.Lte[x]}zab(x,B){if(!this.cCb(x))throw Error.argument("structTypeID","Invalid struct type ID");x=this.led[v.Kuc(x)];if(0>B||B>=x.length)throw Error.argument("iField","Invalid field index");return x[B]}o2(x,B){if(!this.Eqe(x))throw Error.argument("typeID","Invalid type ID");if(!this.$Ab(x,B))throw Error.argument("value","Value is not of the correct type");
switch(x){case v.kZ:return B;case v.mha:return B?"True":"False";case v.Tpa:case v.wba:return B.toString();case v.kN:return B.o2();default:if(!v.pC(x)&&v.Iwc(x)){x=v.M5d(x);const J=this.zXa[x].length;switch(this.xfc[x]){case 0:return this.zXa[x][B];case 1:if(B){var D="";for(var w=1;w<J;++w)B&1<<w-1&&(0<D.length&&(D+=" & "),D+=this.zXa[x][w]);return D}return this.zXa[x][0];case 2:D="";for(w=0;w<J;++w)B&1<<w&&(0<D.length&&(D+=" & "),D+=this.zXa[x][w]);return D;default:throw Error.invalidOperation("Unrecognized enum type flavor "+
this.xfc[x]);}}else return B.o2()}}Eqe(x){switch(x){case v.kZ:case v.mha:case v.Tpa:case v.wba:case v.kN:return!0;default:return v.pC(x)?this.Eqe(v.SEa(x)):v.Iwc(x)?this.E5j(x):this.cCb(x)}}E5j(x){x=v.M5d(x);return 0<=x&&x<this.CCg.length}cCb(x){x=v.Kuc(x);return 0<=x&&x<this.p_g.length}bCb(x){return 0<=x&&x<this.Atb}$Ab(x,B){if(null==B)return!1;switch(x){case v.kZ:return"string"===typeof B;case v.mha:return"boolean"===typeof B;case v.Tpa:return"number"===typeof B;case v.wba:return"number"===typeof B;
case v.kN:return Object(h.a)(1055,B);default:if(v.pC(x))return Object(h.a)(1057,B)&&B.QU===v.SEa(x);if(v.Iwc(x)){if("number"!==typeof B)return!1;x=v.M5d(x);const D=this.zXa[x].length;switch(this.xfc[x]){case 0:return 0<=B&&B<D;case 1:return!(B&-1<<D-1);case 2:return!!B&&!(B&-1<<D);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.xfc[x]);}}else return Object(h.a)(1058,B)&&B.Dza===x}}get Atb(){return this.vUh}get ERc(){return this.XXh}get Juc(){return this.k8h}Kaj(x){if(!this.bCb(x))throw Error.argument("attrID",
"Invalid attribute ID");return this.Jte[x]}G9f(x){if(!this.cCb(x))throw Error.argument("structTypeID","Invalid struct type ID");return this.ked[v.Kuc(x)].length}Mbg(x,B){if(!this.cCb(x))throw Error.argument("structTypeID","Invalid struct type ID");return this.ked[v.Kuc(x)][B]}Lbg(x,B){if(!this.cCb(x))throw Error.argument("structTypeID","Invalid struct type ID");x=this.jed[v.Kuc(x)];if(0>B||B>=x.length)throw Error.argument("iField","Invalid field index");return x[B]}Vsa(x,B,D,w,J,G){if(!B)throw Error.argumentNull("initData");
if(v.pC(x)){var M=B.ga(D);++D;x=v.SEa(x);var N=new r.a(this,x);for(var R=0;R<M;++R)Array.add(N.items,({l4:D}=this.Vsa(x,B,D,w,J,G)).returnValue);return{returnValue:N,l4:D}}switch(x){case v.kZ:return{returnValue:(w||this.wGe).$C(B.ga(D++)),l4:D};case v.mha:return{returnValue:1===B.ga(D++),l4:D};case v.Tpa:return{returnValue:B.ga(D++),l4:D};case v.wba:return{returnValue:(J||this.sgk)[B.ga(D++)],l4:D};case v.kN:x=B.ga(D++);M=new e.a(this);for(N=0;N<x;++N)R=B.ga(D),++D,G&&(R=G[R]),M.Du(R,({l4:D}=this.Vsa(this.getAttributeType(R),
B,D,w,J,G)).returnValue);return{returnValue:M,l4:D};default:if(v.Iwc(x))return{returnValue:B.ga(D++),l4:D};if(v.HLh(x)){M=B.ga(D++);N=new z(this,x);for(R=0;R<M;++R){const C=B.ga(D);++D;N.NZe(C,({l4:D}=this.Vsa(this.zab(x,C),B,D,w,J,G)).returnValue)}return{returnValue:N,l4:D}}throw Error.argument("typeID","Invalid type ID");}}static Iwc(x){return 16<=(x&16383)&&16384!==(x&16384)&&32768!==(x&32768)}static HLh(x){return 16<=(x&16383)&&16384===(x&16384)&&32768!==(x&32768)}static pC(x){return 32768===
(x&32768)}static zkj(x){if(v.pC(x))throw Error.argument("nonListTypeID","Non-list type ID required");return x|32768}static SEa(x){if(!v.pC(x))throw Error.argument("listTypeID","List type ID required");return x&-32769}static j3a(x,B,D){switch(x){case v.kZ:case v.mha:case v.Tpa:case v.wba:return B===D;case v.kN:return B.isEqual(D);default:return v.pC(x)?B.isEqual(D):v.Iwc(x)?B===D:B.isEqual(D)}}static ldb(x){Object(h.a)(1056,x)&&x.ese()}static mL(x){return Object(h.a)(1056,x)?x.mL():x}static M5d(x){return x-
16}static Kuc(x){return(x&-16385)-16}}v.kZ=1;v.mha=2;v.Tpa=3;v.wba=5;v.kN=9;Object(K.a)(v,"Annotations",null,[1059])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19809348/wdjs/ppteditDS.chronos1.js.map