/*
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource>  The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
*/
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[5],{1078:function(K,U,d){K=d(0);class h{constructor(r,m,n){this.pSc=r;this.lMh=m;this.t$e=n}}Object(K.a)(h,"ThemeData",null,[]);d.d(U,"a",function(){return e});class e{}e.Gza=[new h("2e142a2c-cd16-42d6-873a-c26d2a0506fa","OfficeTheme2023",4),new h("62f939b6-93af-4db8-9c6b-d6c7dfdc589f","OfficeTheme",4),new h("b8441adb-2e43-4af7-b97a-bd870242c6a8","Ion",4),new h("28cdc826-8792-45c0-861b-85eb3adeda33","Organic",4),
new h("f226e7a2-7162-461c-9490-d27d9dc04e43","Frame",4),new h("fc33163d-4339-46b1-8eed-24c834239d99","IonBoardroom",4),new h("789ec3fe-34fd-429c-9918-760025e6c145","Mesh",4),new h("5f128b03-dcca-4eeb-ab3b-cf2899314a46","Retrospect",8),new h("0507925b-6ac9-4358-8e18-c330545d08f8","Slice",4),new h("1306e473-ed32-493b-a2d0-240a757edd34","Savon",4),new h("98dff888-2449-4d28-977c-6306c017633e","Banded",4),new h("39ec5628-30ed-4578-acd8-9820edb8e15a","Quotable",4),new h("7acabc62-bf99-48cf-a9dc-4db89c7b13dc",
"WoodType",4),new h("5665723a-49ba-4b57-8411-a56f8f207965","Basis",4),new h("3577f8c9-a904-41d8-97d2-fd898f53f20e","Integral",8),new h("7cb32d59-10c0-40dd-b7bd-2e94284a981c","Wisp",4),new h("9697a71b-4ab7-4a1a-bd5b-bb2d22835b57","Dividend",4),new h("c4bb2a3d-0e93-4c5f-b0d2-9d3fce089cc5","Celestial",4),new h("3388167b-a2eb-4685-9635-1831d9aef8c4","Parallax",4),new h("4c5440d6-04d2-4954-96cf-f251137069b2","Metropolitan",8),new h("c0c680cd-088a-49fc-a102-d699147f32b2","Facet",4),new h("ba0eb5a6-f2d4-4f82-977b-64adee4a2a69",
"View",4),new h("5156b0e4-0eb1-49fe-a26b-15f6f698aec6","Atlas",4),new h("025cb5fb-2dd3-45ee-b6f0-cc461540eb19","Madison",4)];Object(K.a)(e,"DesignManager_data",null,[])},1169:function(K,U,d){(function(h){d.d(U,"a",function(){return D});var e=d(152),r=d(0),m=d(30),n=d(40),z=d(28),v=d(1280),x=d(1281),B=d(70);class D{constructor(w,J,G,M,N,R,C,O,S,T,ca){this.G5=this.Mw=null;this.Tod=(L,da,Z,fa,aa)=>{this.actionId=L;this.Mw=this.pa.fo();return this.eAh(!0)?1===Z?32:aa?2===Z&&(this.cec.Zkb(!0,!1),L={},
z.a.J(508908313,v.a.msoulscat_Wac_PptView,x.a.info,"PictureBackgroundActor::removePictureBackground triggered."),this.jZi(L),this.sBj(this.Mw,L))?32:16:16:8};this.Tpd=(L,da,Z,fa,aa)=>{let ja=this.pa.fo();if(!this.eAh(!1))return 8;if(1===Z)return 32;if(!aa)return 16;this.cec.Zkb(!0,!1);this.G5=this.ta.Ba;da=this.Eb.xd(15,void 0,()=>{this.pa.au();this.pa.nh();this.Fa.Bd()},()=>{this.Rq.lA=ja;this.pa.selectShape(ja,!0)});try{this.Mw=ja,da.hc(this.G5),da.fd=L,this.Mw.Ecb=!1}finally{da&&da.dispose(),this.cec.Zkb(!1,
!1)}return 32};if(!w)throw Error.argumentNull("actionManager");if(!J)throw Error.argumentNull("appOfflineSetter");if(!G)throw Error.argumentNull("selectionManager");if(!M)throw Error.argumentNull("imageManager");this.ia=w;this.cec=J;this.pa=G;this.KB=M;this.Gb=N;this.ta=R;this.Eb=O;this.Fa=C;this.Rq=S;this.UKj=T;this.yH=ca}vb(){this.ia.ra(m.a.Tod,n.a.application,this.Tod,4);this.ia.ra(m.a.Tpd,n.a.application,this.Tpd,4)}pe(){}sBj(w,J){return(w=this.rk(w))&&w.Fk&&(w=w.Fk)?w.goc("RemoveBackgroundAction",
J):!1}rk(w){return w?w.qc(this.Gb.Na):null}jZi(w){w.type="RemoveBackgroundPayload";w.useMask=!0;w.downsample=!0;var J=this.x3i(this.ta.Ba,this.Mw),G=500;let M=500;J&&J.Base64Data&&(G=new URL(J.Base64Data),w.originalUrl=G,G=J.Height,M=J.Width);J={};G=new URL(`data:image/svg+xml;base64, ${h.from(this.Rnj(G,M)).toString("base64")}`,window.location.origin);J.url=G;J.renderAsSvg=!0;J.overlay=!0;J.cropToGeometry=!0;w.placeholder=J;w.resultHandler=this.NTk.bind(this);w.updatePicture=!1}Rnj(w,J){w=this.PMk(`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
    preserveAspectRatio="xMidYMid meet" style="width:100%;" viewBox="0 0 ${J} ${w}">
    <defs>
      <animateTransform repeatCount="indefinite" dur="1.3666667s" begin="0s" xlink:href="#_R_G_L_0_G_L_1_G_N_2_T_0"
      fill="freeze" attributeName="transform" from="54" to="414" type="rotate" additive="sum" keyTimes="0;0.9756098;1"
       values="54;414;414" keySplines="0.33 0 0.1 1;0 0 0 0" calcMode="spline" />
      <animateTransform repeatCount="indefinite" dur="1.3666667s" begin="0s" xlink:href="#_R_G_L_0_G_L_0_G_N_2_T_0"
      fill="freeze" attributeName="transform" from="54" to="414" type="rotate" additive="sum" keyTimes="0;0.9756098;1"
      values="54;414;414" keySplines="0.33 0 0.1 1;0 0 0 0" calcMode="spline" />
      <animate attributeType="XML" attributeName="opacity" dur="1s" from="0" to="1" xlink:href="#time_group" />
    </defs>
    <g id="_R_G">
      <rect width="100%" height="100%" fill="rgba(179,179,179,0.5)" filter='blur(12px)' />
      <g id="_R_G_L_1_G" transform=" translate(${J/2}, ${w/2})
     translate(0, 0)" />
      <g id="_R_G_L_0_G" transform=" translate(${J/2}, ${w/2})
     translate(-14, -14)">
        <g id="_R_G_L_0_G_L_1_G_N_2_T_0" transform=" translate(14, 14) scale(2, 2)">
          <g id="_R_G_L_0_G_L_1_G">
            <path id="_R_G_L_0_G_L_1_G_D_0_P_0" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round"
             fill="none" stroke-width="3" stroke-opacity="1"
             d=" M0 -12 C6.62,-12 12,-6.62 12,0 C12,6.62 6.62,12 0,12 C-6.62,
             12 -12,6.62 -12,0 C-12,-6.62 -6.62,-12 0,-12z " />
          </g>
        </g>
        <g id="_R_G_L_0_G_L_0_G_N_2_T_0" transform=" translate(14, 14)">
          <g id="_R_G_L_0_G_L_0_G" transform=" rotate(3.724)
      scale(0.2, 0.2)">
            <path id="_R_G_L_0_G_L_0_G_D_0_P_0" fill="#C43E1C" fill-opacity="1" fill-rule="nonzero"
            d=" M-40.12 -128.87 C-40.12,-128.87 -47.25,-127.25 -55.5,-123 C-63.75,-118.75 -71.87,
            -114.75 -79.75,-108.62 C-87.62,-102.5 -92.37,-100.25 -99,-92.5 C-105.62,-84.75 -110.5,
            -79 -114.87,-71.75 C-119.25,-64.5 -124.75,-53.62 -127.12,-46.75 C-129.5,-39.87 -133.14,
            -27.1 -133.87,-20.37 C-134.87,-11.25 -135,-5.37 -135,1.5 C-135,8.38 -134.87,12 -134.5,
            16.5 C-134.12,21 -132.75,24.88 -132.75,24.88 C-132.75,24.88 -103.5,17.63 -103.5,
            17.63 C-103.5,17.63 -104.87,6 -104.87,-0.37 C-104.87,-6.75 -104.12,-14.37 -103.12,
            -20.37 C-102.12,-26.37 -100.37,-31.12 -98,-37.12 C-95.62,-43.12 -93.12,-49.37 -89.62,
            -55 C-86.12,-60.62 -83.12,-64.62 -78.5,-69.37 C-73.87,-74.12 -67.75,-80.12 -63.5,
            -83.37 C-59.25,-86.62 -51.25,-91.87 -46,-94.25 C-40.75,-96.62 -33.62,-99.12 -33.62,
            -99.12 C-33.62,-99.12 -40.12,-128.87 -40.12,-128.87z " />
            <path id="_R_G_L_0_G_L_0_G_D_1_P_0" stroke="#C43E1C" stroke-linecap="round" stroke-linejoin="round"
             fill="none" stroke-width="1" stroke-opacity="1" d=" M-40.12 -128.87 C-40.12,-128.87 -47.25,
             -127.25 -55.5,-123 C-63.75,-118.75 -71.87,-114.75 -79.75,-108.62 C-87.62,-102.5 -92.37,
             -100.25 -99,-92.5 C-105.62,-84.75 -110.5,-79 -114.87,-71.75 C-119.25,-64.5 -124.75,-53.62 -127.12,
             -46.75 C-129.5,-39.87 -133.14,-27.1 -133.87,-20.37 C-134.87,-11.25 -135,-5.37 -135,1.5 C-135,
             8.38 -134.87,12 -134.5,16.5 C-134.12,21 -132.75,24.88 -132.75,24.88 C-132.75,24.88 -103.5,17.63 -103.5,
             17.63 C-103.5,17.63 -104.87,6 -104.87,-0.37 C-104.87,-6.75 -104.12,-14.37 -103.12,-20.37 C-102.12,
             -26.37 -100.37,-31.12 -98,-37.12 C-95.62,-43.12 -93.12,-49.37 -89.62,-55 C-86.12,-60.62 -83.12,
             -64.62 -78.5,-69.37 C-73.87,-74.12 -67.75,-80.12 -63.5,-83.37 C-59.25,-86.62 -51.25,-91.87 -46,
             -94.25 C-40.75,-96.62 -33.62,-99.12 -33.62,-99.12 C-33.62,-99.12 -40.12,-128.87 -40.12,-128.87z " />
          </g>
        </g>
      </g>
    </g>
    <g id="time_group" />
  </svg>`);return this.mil(w)}PMk(w){w=(new DOMParser).parseFromString(w,"image/svg+xml");if(0!==w.querySelectorAll("parsererror").length)throw Error("The XML could not be read");return w.firstElementChild}mil(w){return(new XMLSerializer).serializeToString(w)}NTk(w){return Object(e.a)(this,void 0,void 0,function*(){w.succeeded?(z.a.J(508921416,v.a.msoulscat_Wac_PptView,x.a.info,"PictureBackgroundActor::processBackgroundRemovalResults Success. Status: '{0}'",w.succeeded),this.Joi=w.result.picture.url,
yield this.uGj(this.actionId,this.Joi)):(this.cec.Zkb(!1,!1),this.Dvl(),z.a.J(508921415,v.a.msoulscat_Wac_PptView,x.a.error,"PictureBackgroundActor::processBackgroundRemovalResults Failed. Status: '{0}'",w?w.message:"unknown"))})}uGj(w,J){return Object(e.a)(this,void 0,void 0,function*(){this.G5=this.ta.Ba;const G=this.Eb.xd(15,void 0,()=>{this.pa.au();this.pa.nh();this.Fa.Bd()},()=>{this.Rq.lA=this.Mw;this.pa.selectShape(this.Mw,!0)});try{G.hc(this.G5),G.fd=w,this.Mw.jea=J.href,this.Mw.Ecb=!0}finally{G&&
G.dispose(),this.cec.Zkb(!1,!1)}})}eAh(w){var J,G,M,N;const R=this.pa.Xd();if(!R)return!1;D.mnl(1<R.length,!(null===(J=R[0])||void 0===J?0:J.s2c));return 1==R.length&&(null===(G=R[0])||void 0===G?void 0:G.qj)&&(null===(M=R[0])||void 0===M?void 0:M.s2c)&&(null===(N=R[0])||void 0===N?void 0:N.Ecb)!==w}static mnl(w,J){B.c()?appChrome.api.dispatch(appChrome.actions.setControlCustomTooltip("RemovePictureBackground",w?ResourceStrings.l_RemovePictureBackgroundMultipleShapesSelectTooltip:J?ResourceStrings.l_RemovePictureBackgroundInvalidImageTooltip:
ResourceStrings.l_RemovePictureBackgroundTooltip)):z.a.J(508923987,v.a.msoulscat_Wac_PptView,x.a.error,"PictureBackgroundActor::setRemoveBackgroundButtonToolTip appChromeAlreadyLoaded failed")}x3i(w,J){let G=w?w.Db:null;J=J.get_shapeId();w=this.UKj.cXc(G,J,13,w.Vp,w.Vk,-1);z.a.J(508908312,v.a.msoulscat_Wac_PptView,x.a.info,"PictureBackgroundActor::fetchOriginalImageData fetching original image data.");({data:w}=this.KB.w$b.Hrc(w));if(w)return w;z.a.J(508923986,v.a.msoulscat_Wac_PptView,x.a.error,
"PictureBackgroundActor::fetchOriginalImageData image data cannot be fetched for image id")}Dvl(){this.yH.fba(ResourceStrings.l_UnexpectedBEHTitle,ResourceStrings.l_GenericErrorMessage,!1,null,!1,null,0,0,null,null,!0,D.lLc,!1,null)}}D.lLc=20;Object(r.a)(D,"PictureBackgroundActor",null,[251])}).call(this,d(703).Ozd)},1170:function(K,U){function d(m){var n=m.length;if(0<n%4)throw Error("Invalid string. Length must be a multiple of 4");m=m.indexOf("=");-1===m&&(m=n);return[m,m===n?0:4-m%4]}U.byteLength=
function(m){m=d(m);var n=m[1];return 3*(m[0]+n)/4-n};U.pGl=function(m){var n=d(m);var z=n[0];n=n[1];var v=new r(3*(z+n)/4-n),x=0,B=0<n?z-4:z,D;for(D=0;D<B;D+=4)z=e[m.charCodeAt(D)]<<18|e[m.charCodeAt(D+1)]<<12|e[m.charCodeAt(D+2)]<<6|e[m.charCodeAt(D+3)],v[x++]=z>>16&255,v[x++]=z>>8&255,v[x++]=z&255;2===n&&(z=e[m.charCodeAt(D)]<<2|e[m.charCodeAt(D+1)]>>4,v[x++]=z&255);1===n&&(z=e[m.charCodeAt(D)]<<10|e[m.charCodeAt(D+1)]<<4|e[m.charCodeAt(D+2)]>>2,v[x++]=z>>8&255,v[x++]=z&255);return v};U.y2f=function(m){for(var n=
m.length,z=n%3,v=[],x=0,B=n-z;x<B;x+=16383){for(var D=v,w=D.push,J,G=m,M=x+16383>B?B:x+16383,N=[],R=x;R<M;R+=3)J=(G[R]<<16&16711680)+(G[R+1]<<8&65280)+(G[R+2]&255),N.push(h[J>>18&63]+h[J>>12&63]+h[J>>6&63]+h[J&63]);J=N.join("");w.call(D,J)}1===z?(m=m[n-1],v.push(h[m>>2]+h[m<<4&63]+"==")):2===z&&(m=(m[n-2]<<8)+m[n-1],v.push(h[m>>10]+h[m>>4&63]+h[m<<2&63]+"="));return v.join("")};var h=[],e=[],r="undefined"!==typeof Uint8Array?Uint8Array:Array;for(K=0;64>K;++K)h[K]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[K],
e["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(K)]=K;e[45]=62;e[95]=63},1171:function(K,U){U.read=function(d,h,e,r,m){var n=8*m-r-1;var z=(1<<n)-1,v=z>>1,x=-7;m=e?m-1:0;var B=e?-1:1,D=d[h+m];m+=B;e=D&(1<<-x)-1;D>>=-x;for(x+=n;0<x;e=256*e+d[h+m],m+=B,x-=8);n=e&(1<<-x)-1;e>>=-x;for(x+=r;0<x;n=256*n+d[h+m],m+=B,x-=8);if(0===e)e=1-v;else{if(e===z)return n?NaN:Infinity*(D?-1:1);n+=Math.pow(2,r);e-=v}return(D?-1:1)*n*Math.pow(2,e-r)};U.write=function(d,h,e,r,m,n){var z,
v=8*n-m-1,x=(1<<v)-1,B=x>>1,D=23===m?Math.pow(2,-24)-Math.pow(2,-77):0;n=r?0:n-1;var w=r?1:-1,J=0>h||0===h&&0>1/h?1:0;h=Math.abs(h);isNaN(h)||Infinity===h?(h=isNaN(h)?1:0,r=x):(r=Math.floor(Math.log(h)/Math.LN2),1>h*(z=Math.pow(2,-r))&&(r--,z*=2),h=1<=r+B?h+D/z:h+D*Math.pow(2,1-B),2<=h*z&&(r++,z/=2),r+B>=x?(h=0,r=x):1<=r+B?(h=(h*z-1)*Math.pow(2,m),r+=B):(h=h*Math.pow(2,B-1)*Math.pow(2,m),r=0));for(;8<=m;d[e+n]=h&255,n+=w,h/=256,m-=8);r=r<<m|h;for(v+=m;0<v;d[e+n]=r&255,n+=w,r/=256,v-=8);d[e+n-w]|=
128*J}},1172:function(K){var U={}.toString;K.exports=Array.isArray||function(d){return"[object Array]"==U.call(d)}},1186:function(K,U,d){K=d(0);var h=d(7),e=d(1244),r=d(301),m=d(302),n=d(67),z=d(99);class v extends r.a{constructor(C,O){super(C);this.Ch=null;this.wca=O.get(8,!1);this.Rha=O.get(6,0);this.element=C;this.element.className=v.B6b;this.W6a=this.createElement("ul");this.element.appendChild(this.W6a);this.xq=O.get(10);this.xq.rb(n.a.click,this.element,Object(h.a)(this,this.onClick,"onClick"));
this.Xz=O.get(9);this.Xz.rb(n.a.pointerOut,this.element,Object(h.a)(this,this.qG,"onPointerOut"));this.Xz.rb(n.a.pointerDown,this.element,Object(h.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior"));this.CZ=O.get(13);this.CZ.rb(this.element,Object(h.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior"))}g8(C){this.addHandler(m.a.zw,C)}Voa(C){this.removeHandler(m.a.zw,C)}get Cba(){return this.Ch}dispose(){this.element&&(this.xq.Bb(n.a.click,this.element,Object(h.a)(this,this.onClick,
"onClick")),this.Xz.Bb(n.a.pointerDown,this.element,Object(h.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior")),this.Xz.Bb(n.a.pointerOut,this.element,Object(h.a)(this,this.qG,"onPointerOut")),this.CZ.Bb(this.element,Object(h.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}hide(){this.visible=!1}show(C,O,S){this.hide();!C||0>=C.length||(this.wca?this.element.style.right=O+"px":this.element.style.left=O+"px",this.element.style.top=S+"px",this.RSd(C),this.visible=
!0)}RSd(C){this.Ch=C;z.a.vv(this.W6a);for(let O=C.length-1;0<=O;O--)this.kB(C[O])}kB(C){const O=document.createElement("li");O.style.backgroundColor=C.color;O.style.height=this.Rha+"px";O.id="fly_"+C.clientId;O.style.lineHeight=this.Rha+"px";z.a.Mz(O,C.userName);O.setAttribute("dir","auto");this.W6a.appendChild(O)}onClick(){this.hide();return!1}qG(C){this.raiseEvent(m.a.zw,new m.a(3,C));return!1}}v.B6b="prFlyout UIFont";Object(K.a)(v,"PresenceTooltipFlyoutControl",r.a,[]);var x=d(78);class B extends r.a{constructor(C,
O,S){super(C);this.LZ=null;this.Ch=[];this.element.className="prGlyph";this.Yc=O;this.R7=this.Yc.get(9);this.Hn=this.Yc.get(10);this.CZ=this.Yc.get(13);this.Gge();this.kB(S);this.Z4a=!1}get eP(){return this.Ch.length}get Cba(){return this.Ch}g8(C){this.addHandler(m.a.zw,C)}Voa(C){this.removeHandler(m.a.zw,C)}dispose(){this.A8e();super.dispose()}kB(C){Array.add(this.Ch,C);2===this.eP?this.zba(!0):1===this.eP?this.zba(!1):this.zba(this.Z4a)}nP(C){this.r7d(C)&&(1<this.eP&&this.zba(!0),1===this.eP?this.zba(!1):
1>this.eP&&this.hide())}show(){this.zba(2<=this.eP);this.visible=!0}hide(){this.visible=!1}zae(C){return C?this.k7b(0,5):this.k7b(1,4)}r7d(C){for(let O=0;O<this.eP;O++)if(this.Ch[O].clientId===C)return C=this.Ch[O],Array.removeAt(this.Ch,O),C;return null}zba(C){this.Z4a!==C&&(this.LZ&&this.element.removeChild(this.LZ),this.LZ=this.zae(C),this.element.appendChild(this.LZ),this.Z4a=C);this.LZ.childNodes[0].style.backgroundColor=this.Ch[this.Ch.length-1].color}k7b(C,O){const S=this.Yc.get(6,0),T=this.Yc.get(14);
return x.createClusteredImageFromClusterWithImageClass(S,S,this.Yc.get(C),this.Yc.get(O),"cui-img-cont-float cui-img-16by16","",!1,"",this.element.ownerDocument,T?T.cloneNode(!0):null)}NM(C){3!==C.ng&&this.raiseEvent(m.a.zw,new m.a(2,C));return!1}onClick(C){this.raiseEvent(m.a.zw,new m.a(1,C));return!0}qG(C){3!==C.ng&&this.raiseEvent(m.a.zw,new m.a(3,C));return!1}A8e(){this.element&&(this.R7.Bb(n.a.pointerDown,this.element,Object(h.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior")),this.R7.Bb(n.a.pointerOver,
this.element,Object(h.a)(this,this.NM,"onPointerOver")),this.R7.Bb(n.a.pointerOut,this.element,Object(h.a)(this,this.qG,"onPointerOut")),this.Hn.Bb(n.a.doubleClick,this.element,Object(h.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior")),this.Hn.Bb(n.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.CZ.Bb(this.element,Object(h.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior")))}Gge(){this.element&&(this.R7.rb(n.a.pointerDown,this.element,Object(h.a)(this,this.kF,
"stopPropagationAndPreventDefaultBehavior")),this.R7.rb(n.a.pointerOver,this.element,Object(h.a)(this,this.NM,"onPointerOver")),this.R7.rb(n.a.pointerOut,this.element,Object(h.a)(this,this.qG,"onPointerOut")),this.Hn.rb(n.a.doubleClick,this.element,Object(h.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior")),this.Hn.rb(n.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.CZ.rb(this.element,Object(h.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior")))}}Object(K.a)(B,
"PresenceTooltipGlyph",r.a,[]);var D=d(121);d(65);var w=d(205);class J extends r.a{constructor(C,O,S){super(C);this.Ch=[];this.tm=[];this.xI=0;this.Mia=this.y7=!1;this.YRb=null;this.dia={};this.Yc=S;this.kl=S.get(8,!1);this.MG=S.get(11,!1);C=S.get(12,0);this.imageDimension=S.get(6,0);this.Hrb=O;this.element.id=J.R6b();this.element.className=r.a.p1d(this.kl);C&&(this.zIndex=C);this.rtl=this.kl;this.Esc(O);this.Sz=this.createElement("div");this.Sz.className=this.MG?"prContainerV":"prContainerHr";this.element.appendChild(this.Sz);
this.pUb=Array(this.xI);for(O=0;O<this.xI;O++)this.uw[O]=new v(this.createElement("div"),this.Yc),this.uw[O].g8(Object(h.a)(this,this.sY,"onInteractivityChanged")),this.element.appendChild(this.uw[O].element)}get xKb(){return w.a.clone(this.Ch)}getGlyph(C){return this.dia[C]}get uw(){return this.pUb}get d_b(){return this.YRb}get nMa(){return this.imageDimension+2}get width(){return this.MG?this.nMa:this.Hrb}get height(){return this.MG?this.Hrb:this.nMa}g8(C){this.addHandler(m.a.zw,C)}Voa(C){this.removeHandler(m.a.zw,
C)}dispose(){if(this.uw)for(const C of this.uw)C.Voa(Object(h.a)(this,this.sY,"onInteractivityChanged")),D.a.Ry(C);D.a.Jqd(this.tm);this.tm=this.pUb=null;super.dispose()}eMa(){this.YW();this.Plb();this.visible=!0;this.y7=!1}hud(){!this.tm||1>this.tm.length||(this.YW(),this.visible=!0,this.Plb(),this.xKa(this.tm[this.tm.length-1]),this.y7=!0)}aMa(){if(this.tm&&!(1>this.tm.length)){this.visible=!0;this.Plb();var C=0;for(const O of this.tm)this.xKa(O,C++);this.y7=!1;this.Mia=!0}}hide(){this.visible=
!1;this.YW();for(let C=0;C<this.tm.length;C++)this.tm[C].hide();this.y7=!1}L1b(){if(!this.Mia)return!1;let C=0;for(const O of this.uw)O.visible&&C++;return this.Mia=0<C&&(this.Ch.length<=this.xI?C===this.Ch.length:C===this.xI)}kB(C){if(!(0>=this.xI)){C.clientId||(C.clientId=(J.OOa++).toString());if(C.clientId in this.dia){var O=this.wka(C.clientId);if(0<=O){O=this.Ch[O];if(O.color===C.color&&O.userName===C.userName)return;this.nP(C.clientId)}}O=this.L1b();var S=0;if(this.Ch.length<this.xI){var T=
new B(this.createElement("div"),this.Yc,C);T.g8(Object(h.a)(this,this.sY,"onInteractivityChanged"));this.kl&&!this.MG&&0<this.Ch.length?this.Sz.insertBefore(T.element,this.Sz.firstChild):(this.Sz.appendChild(T.element),S=this.tm.length);Array.add(this.tm,T)}else this.kl&&!this.MG?T=this.tm[0]:(S=this.tm.length-1,T=this.tm[S]),T.kB(C);T.show();this.dia[C.clientId]=T;Array.add(this.Ch,C);this.Wwc(T,S);O&&this.aMa()}}nP(C){const O=this.L1b();O&&this.YW();this.y0a(C);this.Ch.length>=this.xI&&this.tm.length<
this.xI&&this.PTe();0>=this.Ch.length?this.hide():O&&this.aMa()}Rgd(){}y0a(C){var O=this.wka(C);0>O||(C=this.Ch[O],Array.removeAt(this.Ch,O),O=this.dia[C.clientId],delete this.dia[C.clientId],O.nP(C.clientId),this.Wwc(O),0>=O.eP&&(this.Sz.removeChild(O.element),Array.remove(this.tm,O),O.dispose()))}gOb(){}PTe(){var C=this.Hbe();!C||1>=C.Cba.length||(C=Array.clone(this.Ch),C.forEach(O=>{this.y0a(O.clientId)}),C.forEach(O=>{this.kB(O)}))}wka(C){for(let O=0;O<this.Ch.length;O++)if(this.Ch[O].clientId===
C)return O;return-1}Hbe(){return this.kl&&!this.MG?this.tm[0]:this.tm[this.tm.length-1]}position(C,O){this.element.style.top=O+"px";this.element.style.left=C+"px"}Plb(){for(let C=0;C<this.tm.length;C++)this.tm[C].show()}YW(){for(let C=0;C<this.xI;C++)this.uw[C].hide();this.Mia=!1}xKa(C,O=0){if(C)if(this.YRb=C,this.MG){const S=this.imageDimension;if(1<C.Cba.length)this.uw[O].show(C.Cba,S,this.height-this.imageDimension);else{const T=this.Sz.children.length;for(let ca=0;ca<this.Sz.children.length;ca++)C.element===
this.Sz.children[ca]&&this.uw[O].show(C.Cba,S,this.height-(T-ca)*this.nMa+2)}}else this.uw[O].show(C.Cba,this.width,0)}sY(C,O){var S=Object(e.a)(B,C);S=S?this.a6b(S):-1;if(2===O.type||1===O.type&&-1!==S&&!this.uw[S].visible)this.xKa(C);else if(1===O.type)this.YW(),this.y7=!1;else if(3===O.type){if(this.JRc(O.Bj))return;this.y7||this.YW()}this.raiseEvent(m.a.zw,O)}JRc(C){C=J.c8b(C);let O=!1;for(const S of this.uw)if(z.a.GVa(S.element,C)){O=!0;break}return this.Sz!==C&&z.a.GVa(this.Sz,C)||O}Wwc(C,O=
0){const S=this.hme(C);S&&0>=C.eP?this.uw[O].hide():S?this.xKa(C):this.uw[O].hide()}a6b(C){let O=0;for(const S of this.tm){if(C===S)return O;O++}return-1}hme(C){const O=this.a6b(C);return!!this.d_b&&C===this.d_b&&-1!==O&&this.uw[O].visible}Esc(C){this.xI=C===this.imageDimension?1:Math.floor(C/this.nMa);this.MG?(this.element.style.height=C+"px",this.element.style.width=this.imageDimension+"px"):(this.element.style.width=C+"px",this.element.style.height=this.imageDimension+"px")}static R6b(){return String.format("{0}-{1}",
"presencetooltip",J.OOa++)}static c8b(C){C=C.mc.rawEvent;return C.relatedTarget||C.toElement}}J.OOa=0;Object(K.a)(J,"PresenceTooltipControl",r.a,[325,107]);var G=d(239),M=d(318),N=d(281);d.d(U,"a",function(){return R});class R{constructor(C){this.Yc=C;this.Yc.$Z(10,G.a.instance);this.Yc.$Z(9,N.a.instance);this.Yc.$Z(6,16);this.Yc.$Z(13,M.a.instance)}G0d(C,O){return new J(C,O,this.Yc)}h3b(C){return new J(C,16,this.Yc)}}Object(K.a)(R,"PresenceTooltipFactory",null,[324])},1200:function(K,U,d){K=d(0);
class h{}h.taskPaneWidth=330;Object(K.a)(h,"AppsForOfficeConstants",null,[]);d.d(U,"a",function(){return e});class e{constructor(){this.oT=null;this.resizeMaxWidth=this.resizeMinWidth=0;this.dialogWidth=this.dialogHeight=this.n4b=this.dialogTop=this.p4b=this.dialogLeft=null;this.taskPaneWidth=h.taskPaneWidth;this.ZA=this.sourceLocationOverrideResourceId=null;this.nonPersistedSettings={};this.onExtensionLaunchCallback=this.onTaskPaneClose=null;this.isResizable=this.isModernPane=!1;this.sharedRuntimeId=
null;this.isPaneAutoOpened=this.isPreload=!1;this.XPc=this.TPc=!0}}Object(K.a)(e,"FirstPartyAddInOptionalParameters",null,[])},1282:function(K,U,d){d.d(U,"a",function(){return z});K=d(0);var h=d(79),e=d(120),r=d(27),m=d(95),n=d(222);class z extends h.a{constructor(v,x=!1){super(v,!1,x)}get fBb(){return!1}get xL(){return n.a.o4b+"/modeless"}get oCb(){return null}set oCb(v){}get kCb(){return null}set kCb(v){}pj(v,x=null,B=null){this.dL&&(B.isModal=!1);super.pj(v,x,B)}hide(){if(r.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.HideReactModelessDialogEnabled")||
this.Ib)this.ONh(),r.AFrameworkApplication.Aa.gx.Eo(e.AFrame.U5),super.hide()}Qbi(){const v=r.AFrameworkApplication.Aa.gx,x=r.AFrameworkApplication.Aa.$r;v.e3(this.xL);v.bja(this.xL);x.Fc(this.xL).parent=e.AFrame.Xi}Ura(){m.FocusManager.mN()&&(super.Ura(),this.Qbi(),r.AFrameworkApplication.Aa.gx.DI(e.AFrame.U5))}bkb(){if(m.FocusManager.mN()&&!r.AFrameworkApplication.Yg){const v=m.FocusManager.instance();v.q1(this.xL);const x=v.EQ(this.xL);x&&x.Dj.mF(null);v.YLb(this.xL)}}Iaa(){"DL"===this.Ora||"DP"===
this.Ora?super.Iaa():r.AFrameworkApplication.fa&&r.AFrameworkApplication.fa.ka("WacAutoFitNonModalDialogIsEnabled")?(this.ONh(),this.VDf()&&this.kDh(this.Ib.clientHeight,this.Ib.clientWidth)):this.VA()}VA(){this.kDh(h.a.$df,h.a.cef)}kDh(v,x){if(this.kCb&&this.oCb){let B,D;B=n.a.Coc+this.oCb;D=n.a.Boc+this.kCb;B+v>this.Qka()&&(B=this.Qka()-v);D+x>this.fua()&&(D=this.fua()-x);this.Bud(B,D)}else super.VA()}Abe(v){if(!v)return null;v.endsWith("px")&&(v=v.substring(0,v.length-2));return n.a.mBb(v)?((v=
parseInt(v))||(v=1),v):null}ONh(){if(this.Ib&&this.Ib.style){var v=this.Abe(this.Ib.style.top);v&&(this.oCb=v-n.a.Coc);if(v=r.AFrameworkApplication.isRtl?this.Abe(this.Ib.style.right):this.Abe(this.Ib.style.left))this.kCb=v-n.a.Boc}}}Object(K.a)(z,"ModelessCustomDialog",h.a,[])},1287:function(K,U,d){d.r(U);var h=d(0),e=d(392),r=d(1245),m=d(1246),n=d(7),z=d(1244),v;(function(A){A[A.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";A[A.cloudPolicySettings=1]="cloudPolicySettings";
A[A.alternateAuthToken=2]="alternateAuthToken"})(v||(v={}));Object(h.b)("ApplicationFeatureHelperRequestType",v);class x{constructor(){this.message=null;this.Iv=0}}Object(h.a)(x,"HttpRequstToPromiseRejectData",null,[]);var B=d(96),D=d(81),w=d(173),J=d(478);class G{constructor(A,W){this.Oa=A;this.hi=W}m3b(A,W,na,Ga=null,Ka=null,qb=null,Qb=null,t=null){const Y=v[na],pa=Y+"RequestFailure";B.Health.instance.recordKpiUsage(pa,0,"jpittsdirects",null);return new Promise((Ja,Ya)=>{e.ULS.sendTraceTag(50622688,
3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",Y);const jb=null!=Qb?Qb:this.Oa.wc("ApplicationFeatureHelperRequestQueueTimeout",15E3),Sb=null!=t?t:this.Oa.wc("ApplicationFeatureHelperRequestSentTimeout",3E4);this.hi.iW(A,1,null,this.pae(na,Ga),qb,1,kc=>{e.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",Y);try{if(void 0===kc||null===kc||void 0===kc.data||null===kc.data||void 0===kc.data.ee||
null===kc.data.ee){B.Health.instance.recordKpiFailure(pa,"Invalid RequestSucceededEventArgs",!1,!0,null);let Kb=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",Y);Ya(this.Tka(Kb,kc))}else if(kc.data.Ke!==w.a.mx){B.Health.instance.recordKpiFailure(pa,"HttpStatusCode_"+kc.data.Ke.toString(),!1,!0,null);let Kb=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",
kc.data.Ke,Y);Ya(this.Tka(Kb,kc))}else{void 0!==Ka&&null!==Ka&&void 0!==kc.data.yj&&null!==kc.data.yj&&Ka(kc.data.yj);var db=W(kc.data.ee);if(db)e.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",Y),Ja(db);else{B.Health.instance.recordKpiFailure(pa,"Parse Failure",!1,!0,null);let Kb=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",Y);Ya(this.Tka(Kb,
kc))}}}catch(Kb){B.Health.instance.recordKpiFailure(pa,"Unexpected Failure",!1,!0,null),db=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",Kb,Y),Ya(this.Tka(db,kc))}},kc=>{if(kc.data){B.Health.instance.recordKpiFailure(pa,"HttpStatusCode_"+kc.data.Ke.toString(),!1,!0,null);var db=J.a.Oyb(kc.data.ee||"No Data");db=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",
kc.data.Ke,db,Y)}else B.Health.instance.recordKpiFailure(pa,"Invalid RequestFailedEventArgs",!1,!0,null),db=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",Y);Ya(this.Tka(db,kc))},null,void 0,void 0,jb,Sb)})}Tka(A,W){const na=new x;na.message=A;na.Iv=W&&W.data?W.data.Ke:-1;return na}pae(A,W){const na={};na["x-UserDataSignature"]=this.Oa.Ha("UserDataSignature");na["x-LicensingIsEnabled"]=this.Oa.ka("LicensingIsEnabled").toString();
na["x-CacheIsEnabled"]=this.Oa.ka("LicensingRedisIsEnabled").toString();na["x-OcpsIsEnabled"]=this.Oa.ka("OcpsIsEnabled").toString();na["x-LicensingAADIdIsEnabled"]=this.Oa.ka("LicensingAadIdIsEnabled").toString();0===A&&(na["x-LicenseCheckOnTenantEnabled"]="true",na["x-SupportUserConsentDependentFeatures"]="true",na["x-AFHUserConsentGroupValue"]="0",na["x-UseShellServiceForUserConsentGroup"]="true",na["x-SMBUserLicensingEnabled"]="true",na["x-AFHPIPLComplianceEnabled"]=D.a.JT(window.location.href,
"wd_afhpipl")||"false");if(W)for(let Ga of W.keys)na[Ga]=W.ga(Ga);return na}}Object(h.a)(G,"HttpRequestToPromiseUtility",null,[]);var M=d(27),N;(function(A){A[A.loki=0]="loki";A[A.augloopACLP=1]="augloopACLP"})(N||(N={}));Object(h.b)("AlternateAuthSupportApp",N);var R=d(227),C=d(36);class O{constructor(){this.Token=null;this.ExpirationTime=0}}Object(h.a)(O,"WacAlternateAuthToken",null,[]);class S{constructor(A,W){this.WGl=3E5;if(void 0===A||null===A||void 0===W||null===W)throw Error.argumentNull("appSettingsManager/clientRequestManager");
this.Oa=A;this.ryc=new r.a(m.a.Ml());this.UUb=new G(A,W);void 0!==R.OAuthManagerSettings.Nse&&null!==R.OAuthManagerSettings.Nse&&void 0!==R.OAuthManagerSettings.g5c&&null!==R.OAuthManagerSettings.g5c&&0<R.OAuthManagerSettings.g5c&&(A=new O,A.Token=R.OAuthManagerSettings.Nse,A.ExpirationTime=R.OAuthManagerSettings.g5c,this.ryc.$("loki",A))}naj(){let A=null;this.ryc.Fb(N[0])&&(A=this.ryc.ga(N[0]));return void 0===A||null===A||this.T4j(A)?this.w3i():Promise.resolve(A.Token)}T4j(A){return A.ExpirationTime-
Date.now()<this.WGl}w3i(){const A=new r.a(m.a.Ml());A.$("X-AlternateAuthApp",N[0]);return this.UUb.m3b(this.TTa("/afhs/AlternateAuthHelperHandler.ashx"),Object(n.a)(this,this.hMk,"parseAlternateAuthTokenResponse"),2,A).then(W=>{e.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",N[0]);this.ryc.$(N[0],W);return W.Token},W=>{W=Object(z.a)(x,W);e.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",
W.message,W.Iv);return null})}hMk(A){let W=null;({Nu:W}=C.d(A));e.ULS.sendTraceTag(545821457,3004,W?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",A);return W}TTa(A){return String.format("{0}{1}?{2}",this.Oa.Ha("WebServiceBase"),A,M.AFrameworkApplication.gh)}}Object(h.a)(S,"AlternateAuthHelper",null,[537]);var T=d(1096);class ca{constructor(A,W,na){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=A;this.isEnabled=W;this.tierName=na}}Object(h.a)(ca,
"FeatureStateChangeArgs",null,[]);var L=d(223),da=d(216),Z=d(55),fa=d(105),aa=d(106),ja;(function(A){A[A.Enabled=0]="Enabled";A[A.Disabled=1]="Disabled"})(ja||(ja={}));Object(h.b)("FeatureState",ja);var I=d(56),sa=d(37),ka=d(89);class Ma{constructor(A,W,na=null,Ga=null,Ka=null){this.kTa=this.YV=this.lrf=this.aPa=this.IGc=null;this.UUb=new G(A,W);this.Oa=A;this.L1h=A.wc("LicensingMaxRetryAttempts",0);this.ACc=A.ka("IsO365ConsumerHost");this.GHd=A.ka("IsO365CommercialHost");this.nHd=A.ka("PremiumUpsellIsEnabled");
this.Zpb=!1;this.dJd=0;this.adf=na;this.svf=Ga;this.Ca=Ka;this.$Oa=A.ka("LicensingIsEnabled");this.I5a=A.ka("OcpsIsEnabled")&&this.GHd;this.ZQd=A.ka("ShowPrivacyDialog")&&!!Ga;this.MGd=A.ka("IsAnonymousUser");this.nSc=new Promise(qb=>{qb(!1)});this.G2a=new Promise(qb=>{qb(!0)});this.jTa=new r.a(m.a.Ml());this.RHc=!0;this.hmf=this.dkj();this.Foe()&&!this.MGd?(void 0!==M.AFrameworkApplication.Aa&&null!==M.AFrameworkApplication.Aa&&(this.IGc=M.AFrameworkApplication.Aa.vV,void 0!==this.IGc&&null!==this.IGc&&
(this.aPa=this.IGc.RHb("WebServiceCall","ApplicationFeatureHelperService"))),this.kTa=this.Q7e()):this.kTa=new Promise(qb=>{qb({})});this.kTa.catch(qb=>{qb=Object(z.a)(x,qb);e.ULS.sendTraceTag(42513088,3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",qb?qb.Iv.toString():"Unknown")});this.RHc&&this.isFeatureEnabled("FreemiumUpsell",!0).then(qb=>{this.Zpb=qb;return null})}dkj(){const A=this.Oa.Lu("AllLicensedFeatures")?this.Oa.eA("AllLicensedFeatures"):[],W=new T.a;for(let na=
0;na<A.length;na++)W.add(A[na]);return W}Foe(){return this.GHd||this.ACc}Q7e(A=0,W=!1){e.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",W);const na=L.a.aA();na&&(na.set("retryAttempt",A.toString()),na.set("forceRefresh",W.toString()),na.set("isO365ConsumerHost",this.ACc.toString()),na.set("isO365CommercialHost",this.GHd.toString()),na.set("isFreemiumUpsellSettingEnabled",this.nHd.toString()));B.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest",
"waclicensing",na);B.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",na);void 0!==this.aPa&&null!==this.aPa&&this.aPa.start();let Ga=null;W&&(Ga=new r.a(m.a.Ml()),Ga.$("x-LicensingForceRefresh","true"));this.lrf=new Date;return(this.$Oa?this.UUb.m3b(this.TTa("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(n.a)(this,this.kMk,"parseApplicationFeatureHelperResponse"),0,Ga,Object(n.a)(this,this.MTk,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(Ka=>
{const qb=Object.assign(new ka.a,{durationMs:this.nFh()});qb.extendedProperties=na;qb.extendedProperties&&Ka&&(qb.extendedProperties.set("featureCount",fa.a.count(Ka).toString()),qb.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in Ka).toString()),qb.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in Ka).toString()),"FreemiumUpsell"in Ka&&qb.extendedProperties.set("isFreemiumUpsellEnabled",Ka.FreemiumUpsell.toString()),this.YV&&qb.extendedProperties.set("fromCache",
(this.YV<this.lrf).toString()));B.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",qb);return Ka},Ka=>{const qb=Object.assign(new ka.a,{durationMs:this.nFh()}),Qb=Object(z.a)(x,Ka);if(!Qb)return e.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),B.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,qb),new Promise((t,Y)=>{Y(Ka)});qb.extendedProperties=
na;qb.extendedProperties&&qb.extendedProperties.set("status",Qb.Iv.toString());B.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,qb);return 408===Qb.Iv&&++A<=this.L1h?this.Q7e(A):new Promise((t,Y)=>{Y(Qb)})})}kMk(A){(A=C.b(A))?(e.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),e.ULS.sendTraceTag(50938594,3004,50,"{0}",A)):e.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");
return A.Features}TTa(A){var W=String.format("{0}{1}",this.Oa.Ha("WebServiceBase"),A);this.Oa.Lu("ApplicationFeatureHelperHttpCachingEnabled")&&this.Oa.ka("ApplicationFeatureHelperHttpCachingEnabled")&&(A=Ma.dWc(this.Oa))&&0<A.length&&(this.RHc&&(A+="ucbf"),W=new da.QueryStringBuilder(W),W.jg("afhskey",A),W=W.toString());return W}isFeatureEnabled(A,W){if(!this.I5a&&!this.ZQd&&!this.$Oa)return this.G2a;e.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",
A);if("ConnectedServices"===A){var na=this.I5a?this.adf.Z3("ControllerConnectedServicesEnabled"):this.G2a;const qb=this.ZQd?this.svf.getSettings().then(Qb=>2!==Qb.NC,()=>W):this.G2a;return na.then(Qb=>Qb?qb:this.nSc)}if("FreemiumUpsell"===A&&(!this.nHd||!this.ACc||this.MGd))return this.nSc;na=null;na=this.I5a?this.adf.isFeatureEnabled(A):this.G2a;let Ga=null;Ga=this.$Oa?this.xWj(A,W):this.G2a;let Ka=null;Ka=this.ZQd?this.svf.isFeatureEnabled(A):this.G2a;return na.then(qb=>qb?Ka.then(Qb=>Qb?Ga:this.nSc):
this.nSc).then(qb=>{this.dwg(A,qb,!0);return qb},()=>{this.dwg(A,W,!1);return W})}dwg(A,W,na){e.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",A,W,na)}getFeatureTier(A,W){if(!this.$Oa)return new Promise(na=>{na(2)});e.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",A);return this.kTa.then(na=>this.BXc(A,na,W),()=>W)}isFreemiumUpsellEnabled(){if(this.nHd&&this.ACc&&!this.MGd){if(this.Zpb&&2!==this.dJd||
!this.Zpb&&1!==this.dJd)e.ULS.sendTraceTag(509728161,3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isFreemiumUpsellFeatureEnabled={0}",this.Zpb.toString()),this.dJd=this.Zpb?2:1;return this.Zpb}return!1}launchUpsellExperience(A,W=null){e.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",A));var na=L.a.aA();na&&(na.set("experienceId",A),W&&na.set("campaignId",W));B.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",
1,"waclicensing",na);if(na=I.a.instance.qb("Common.IInProductMessagingUIManager")){const Ga=Object(n.a)(this,this.HAj,"handleDimeTaskComplete");na.Bug(A,Ga,W)}else e.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),B.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.Ca.Ka(sa.a.GTc,2,{["experience"]:A})}v0a(A,W){if(!this.$Oa)return null;if(!A||!W)return e.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),
null;const na=aa.a.create().toString();this.jTa.Fb(A)||this.jTa.$(A,new r.a(m.a.Ml()));this.jTa.ga(A).add(na,W);e.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",na,A));return na}akb(A,W){this.$Oa&&(A&&this.jTa.Fb(A)?W&&aa.a.isValid(W)?this.jTa.ga(A).Fb(W)?(e.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",
W,A)),this.jTa.ga(A).remove(W)):e.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",W,A)):e.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",W,A)):e.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",
A)))}BXc(A,W,na){return this.RHc?A in W?W[A].LicenseTier:na:A in W?this.VMk(W[A],na):na}VMk(A,W){switch(A.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return W}}HAj(){e.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.kTa.then(A=>{this.mmh(A)}).catch(()=>{this.mmh({})})}mmh(A){e.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const W=this.Q7e(0,!0);W.then(na=>
{this.kTa=W;fa.a.count(na)>fa.a.count(A)?B.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):B.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(let Ga of this.jTa.keys)if(Ga in na){const Ka=this.BXc(Ga,na,0);Ga in A?this.BXc(Ga,A,0)!==Ka&&this.fKe(Ga,!0,Ka):this.fKe(Ga,!0,Ka)}else Ga in A&&this.fKe(Ga,!1,this.BXc(Ga,A,0))}).catch(na=>{B.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);
e.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(na))})}fKe(A,W,na){e.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",A,W,na);W=new ca(A,W,na);na=this.jTa.ga(A);for(let Ga of na)try{Ga.value(W)}catch(Ka){e.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",
A,Ga.key,Ka.message))}}wWj(A,W){if(this.$Oa){const na=this.hmf.contains(A);let Ga=!0,Ka="",qb=!1;return this.kTa.then(Qb=>{A in Qb?(Qb=Qb[A],Ka=ja[Qb.FeatureState],Ga=1!==Qb.FeatureState):Ga=!na;this.nwg(A,na,Ka,qb,W,Ga);return Ga},()=>{qb=!0;na&&(Ga=W);this.nwg(A,na,Ka,qb,W,Ga);return Ga})}return this.G2a}nwg(A,W,na,Ga,Ka,qb){e.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",A,W,Ga,na,
Ka,qb)}xWj(A,W){if(this.RHc)return this.wWj(A,W);if(this.$Oa){if(this.hmf.contains(A))return this.kTa.then(na=>A in na,()=>W);e.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",A)}return this.G2a}MTk(A){try{A&&"Date"in A&&(this.YV=new Date(A.Date),e.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.YV.toString()))}catch(W){e.ULS.sendTraceTag(578863818,
3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",W)}}nFh(){if(void 0!==this.aPa&&null!==this.aPa){const A=this.aPa.dr;this.aPa.stop();return A}return null}static dWc(A){try{if(Z.a.D4e){const W=A.Ha("UserDataSignature").split(".");if(1<W.length){const na=window.self.atob(W[1]),Ga=JSON.parse(na).LocalStorageKey;if(void 0!==Ga&&null!==Ga&&0<Ga.length)return Ga}}}catch(W){e.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",W.toString())}return null}}Object(h.a)(Ma,
"ApplicationFeatureHelper",null,[538]);var Ea=d(18);class ma{constructor(A,W){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=A.PolicySettings;A=new Date;A.setMinutes(A.getMinutes()+W);this.ExpirationTime=A.getTime()}}Object(h.a)(ma,"CloudPolicySettingsCacheData",null,[]);var va=d(377),Ca=d(249),oa=d(310);class Da{static dDh(){return M.AFrameworkApplication.fa.ka("SideCarIsEnabled")?Da.Qqd&&Da.S0c?new Promise(A=>{A(!0)}):new Promise((A,W)=>{Da.Qqd=oa.a.create(M.AFrameworkApplication.fa.Ha("SideCarUrl"));
Ca.a.oy(Da.Qqd);Da.Qqd.kW((na,Ga)=>{(Da.S0c=Ga.succeeded)?A(Ga.succeeded):W(Ga.succeeded)})}):new Promise(A=>{A(!1)})}}Da.S0c=!1;Da.Qqd=null;Object(h.a)(Da,"SideCarLoader",null,[]);class ta{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(h.a)(ta,"CloudPolicySettingsData",null,[]);class ha{constructor(A,W){this.kCd=0;this.RMc=null;this.UUb=new G(A,W);this.Oa=A;W=A.Ha("HostAuthType");this.I5a=A.ka("OcpsIsEnabled")&&A.ka("IsO365CommercialHost")&&!(void 0===
W||null===W)&&"aad"===W.toLowerCase();this.zof=C.b(A.Ha("OcpsDefaultSettings")||"{}");this.pWb=this.dWc();W=this.Oa.Lu("ServicesControlsMicrosoftControllerServicesList")?this.Oa.eA("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.Ezc=new T.a;for(let na=0;na<W.length;na++)this.Ezc.add(W[na]);this.I5a&&!A.ka("IsAnonymousUser")&&A.ka("SideCarIsEnabled")?this.RMc=this.cKl():this.RMc=this.P7e(this.I5a,this.TTa("/afhs/CloudPolicySettings.ashx"),Object(n.a)(this,this.rMk,"parseCloudPolicySettingsResponse"));
this.RMc.then(()=>null).catch(na=>{na=Object(z.a)(x,na);e.ULS.sendTraceTag(50622685,3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",na?na.Iv.toString():"Unknown")})}Z3(A,W=!0){if(!this.I5a){const qb=this;return new Promise(Qb=>{Qb(qb.P7b(A))})}let na=this,Ga=this;const Ka=this.RMc.then(qb=>{try{let Qb=null;qb.PolicySettings&&"unknown"in qb.PolicySettings&&(Qb=qb.PolicySettings.unknown);if(Qb){if(A in Qb&&void 0!==Qb[A]&&null!==Qb[A])return new Promise(Y=>{Y("0"!==Qb[A])});
const t=A.toLowerCase();if(t in Qb&&void 0!==Qb[t]&&null!==Qb[t])return new Promise(Y=>{Y("0"!==Qb[t])});e.ULS.sendTraceTag(51512667,3004,50,"Policy"+A+" not found, using default");return new Promise(Y=>{Y(na.P7b(A))})}return new Promise(t=>{t(na.P7b(A))})}catch(Qb){return e.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+A+" policy value. Error Message: {0}",Qb.message),na.handleError(Qb.toString(),W,na.P7b(A))}},qb=>Ga.handleError(qb,W,Ga.P7b(A)));Ka.then(qb=>{e.ULS.sendTraceTag(50651667,3004,
50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",A,qb);return null});return Ka}isFeatureEnabled(A,W=!0){if(this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.zWj(A,W);let na=new Promise(Ka=>{Ka(!0)}),Ga="";this.Ezc.contains(A)&&(Ga="ControllerConnectedServicesEnabled",na=this.Z3(Ga,W));na.then(Ka=>{e.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",
A,Ka,Ga);return null});return na}zWj(A,W=!0){let na=new Promise(Ka=>{Ka(!0)}),Ga="";"mso_sendASmile"===A?Ga="Enabled":"Survey"===A||"FloodgateSurvey"===A?Ga="SurveyEnabled":this.Ezc.contains(A)&&(Ga="ControllerConnectedServicesEnabled");""!==Ga&&(na=this.Z3(Ga,W));na.then(Ka=>{e.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",A,Ka,Ga);return null});return na}handleError(A,W,na){return W?new Promise(Ga=>{Ga(na)}):
new Promise((Ga,Ka)=>{Ka(A)})}P7e(A,W,na){if(!A)return Promise.resolve(new ta);let Ga=!1,Ka=null;B.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let qb=this.r0d("GetCloudPolicySettings");return(new Promise((Qb,t)=>{if(void 0!==this.pWb&&null!==this.pWb&&0<this.pWb.length){const Y=this.KJl();if(void 0!==Y&&null!==Y){Ga=!0;Qb(Y);return}}this.UUb.m3b(W,na,1,null,Object(n.a)(this,this.UTk,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],this.Oa.wc("CloudPolicySettingsRequestQueueTimeout",
15E3),this.Oa.wc("CloudPolicySettingsRequestSentTimeout",3E4)).then(Y=>{e.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.PKl(Y);Qb(Y);return Y},Y=>{t(Y);return null})})).then(Qb=>{({Vy:qb,returnValue:Ka}=this.$ud(qb));var t=L.a.aA();t&&t.set("FromCache",Ga.toString());t=Object.assign(new ka.a,{durationMs:Ka,extendedProperties:t});B.Health.instance.recordKpiSuccess("GetCloudPolicySettings",t);return Qb})}cKl(){return Da.dDh().then(()=>{e.ULS.sendTraceTag(593282845,
3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}TTa(A){return String.format("{0}{1}",this.Oa.Ha("WebServiceBase"),A)}rMk(A){let W=null;({Nu:W}=C.d(A));A=!!W;e.ULS.sendTraceTag(50622687,3004,A?50:10,"ParseCloudPolicySettingsResponse: Success={0}",A);return W}UTk(A){try{if(void 0!==A&&null!==A&&"CheckIn-Interval"in A){const W=parseInt(A["CheckIn-Interval"]);void 0!==W&&null!==W&&0<W&&(this.kCd=W)}}catch(W){e.ULS.sendTraceTag(51662934,
3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",W)}}P7b(A){return A in this.zof?"0"!==this.zof[A]:!0}KJl(){try{const A=va.a.instance.getItem(this.pWb);if(void 0===A||null===A)return e.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;e.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",A);const W=JSON.parse(A);if(void 0===W||null===W)return e.ULS.sendTraceTag(51662938,
3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===W.ExpirationTime||null===W.ExpirationTime)return e.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(W.ExpirationTime)).getTime()<Date.now())return e.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;const na=new ta;na.PolicySettings=W.PolicySettings;
na.ControllerConnectedServicesFeatureNames=new Ea.a;this.Oa.Lu("ServicesControlsMicrosoftControllerServicesList")&&this.Oa.eA("ServicesControlsMicrosoftControllerServicesList");for(let Ga of this.Ezc)na.ControllerConnectedServicesFeatureNames.add(Ga);e.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return na}catch(A){return e.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",A.toString()),null}}PKl(A){try{if(void 0===
A||null===A||void 0===A.PolicySettings||null===A.PolicySettings)e.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.kCd)e.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{const W=new ma(A,this.kCd),na=JSON.stringify(W);e.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",na);va.a.instance.setItem(this.pWb,na);e.ULS.sendTraceTag(51662947,
3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(W){e.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",W.toString())}}dWc(){const A=Ma.dWc(this.Oa);return A&&0<A.length?"OCPS"+A:null}r0d(A){const W=I.a.instance.qb("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==W&&null!==W?W.Ii("WebServiceCall",A):null}$ud(A){if(void 0!==A&&null!==A){const W=A.dr;A.stop();return{returnValue:W,Vy:null}}return{returnValue:null,Vy:A}}}
Object(h.a)(ha,"CloudPolicySettingsHelper",null,[535]);class Ha{constructor(){this.bVf=this.yPh=this.NC=0;this.cVf=this.zPh=this.T8a="";this.XOd=this.oAa=2}clone(){const A=new Ha;A.NC=this.NC;A.yPh=this.yPh;A.bVf=this.bVf;A.T8a=this.T8a;A.zPh=this.zPh;A.cVf=this.cVf;A.oAa=this.oAa;A.XOd=this.src;return A}get src(){return this.XOd}serialize(A=null){const W={};if(!A||A.contains(Ha.Zhb))W[Ha.Zhb]=this.NC;if(!A||A.contains(Ha.imc))W[Ha.imc]=this.T8a;if(!A||A.contains(Ha.jmc))W[Ha.jmc]=this.oAa;return JSON.stringify(W)}static create(A,
W=null){const na=new Ha;na.XOd=A;void 0!==W&&null!==W&&(Ha.Zhb in W&&(na.NC=W[Ha.Zhb]),Ha.imc in W&&(na.T8a=W[Ha.imc]),Ha.jmc in W&&(na.oAa=W[Ha.jmc]));return na}static deserialize(A,W){try{const na=JSON.parse(A);if(void 0!==na&&null!==na)return Ha.create(W,na);e.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",A);throw Error.argument("settingsData");}catch(na){throw e.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",
na.toString()),na;}}}Ha.Zhb="CCS";Ha.imc="CCSTime";Ha.jmc="OfficePrivacyRoamedNoticeShown";Object(h.a)(Ha,"UserPrivacySettings",null,[]);var bb=d(214);class Na{constructor(A,W){if(void 0===A||null===A||void 0===W||null===W)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Oa=A;this.hi=W;this.nOd=this.Yc=null}TTa(A){var W=String.format("{0}RoamingServiceHandler.ashx?action=",this.Oa.appSettings.RoamingServiceHandlerWebServiceBase||"");W=new Sys.StringBuilder(W);W.append(A);W.append("&");
W.append(M.AFrameworkApplication.gh);return W.toString()}executeRequest(A,W,na,Ga=null){return this.hi.Csb(A,W,Ga,null,2,na,"33",!1,null,6E4)}saveSettings(A){return new Promise((W,na)=>{try{if(void 0===this.Yc||null===this.Yc||void 0===A||null===A)e.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),na("Can't determine setting changes to save");else{var Ga=this.Yc.NC!==A.NC;if(2===this.Yc.src&&Ga)this.bfl(A),W(!0);else{var Ka=this.oil(A);if(void 0===
Ka||null===Ka||!Ka.length)e.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),na("No changes to save");else if(1===this.Yc.src)W(this.mLh(Ka));else if(0===this.Yc.src){e.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",Ka);const qb=this.executeRequest(this.TTa("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",Ka);qb.continueWith(()=>{if(qb.ho||qb.Dm)e.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),
W(!1);else{var Qb=qb.result;void 0!==Qb.uj&&null!==Qb.uj&&void 0!==Qb.uj.data&&null!==Qb.uj.data&&Qb.uj.data.Ke===w.a.mx?(e.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),W(!0)):(e.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),W(!1))}})}}}}catch(qb){e.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",qb.toString()),W(!1)}})}oil(A){if(void 0===this.Yc||null===this.Yc||void 0===A||null===A)throw Error.invalidOperation("User Privacy settings have not been initialized");
const W=new Ea.a;0===A.src?(this.Yc.NC!==A.NC&&(W.add(Ha.Zhb),W.add(Ha.imc)),this.Yc.oAa!==A.oAa&&W.add(Ha.jmc)):1===A.src&&this.Yc.NC!==A.NC&&W.add(Ha.Zhb);return W.count?A.serialize(W):(e.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)}getSettings(){if(!this.nOd){const A=this;this.nOd=new Promise(W=>{try{A.Yc?W(A.Yc.clone()):A.TJl().then(na=>{A.Yc=na;W(A.Yc.clone());return null},()=>{A.RJl().then(na=>{A.Yc=na;W(A.Yc.clone());return null},()=>{A.SJl().then(na=>
{A.Yc=na;W(A.Yc.clone());return null},()=>{e.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");A.Yc=new Ha;W(A.Yc.clone());return null});return null});return null})}catch(na){e.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",na.toString()),A.Yc=new Ha,W(A.Yc.clone())}})}return this.nOd}TJl(){return new Promise((A,W)=>{try{const Ga=-1!==window.location.href.indexOf("&wd_pn=2");if(this.Oa.ka("PrivacyDialogShouldCheckRoaming")||
Ga){var na=this.executeRequest(this.TTa("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");na.continueWith(()=>{try{if(na.ho||na.Dm)e.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const Ka=na.result;if(Ka&&Ka.uj&&Ka.uj.data)if(Ka.uj.data.Ke!==w.a.mx)e.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",Ka.uj.data.Ke);else{if(Ka.uj.data.ee){A(Na.parse(Ka.uj.data.ee,0));e.ULS.sendTraceTag(51258447,
3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",Ka.uj.data.ee);return}e.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else e.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");W("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(Ka){e.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",
Ka.toString()),W("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else e.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),W("Roaming should not be used")}catch(Ga){e.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",Ga.toString()),W("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}RJl(){return new Promise((A,W)=>{try{const na=bb.a.get("WacUPToggleState");let Ga=null;void 0!==
na&&null!==na&&0<na.length&&(Ga=decodeURIComponent(na));if(void 0!==Ga&&null!==Ga&&0<Ga.length){const Ka=Na.parse(Ga,1);e.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",Ka.toString());A(Ka)}else{const Ka=Ha.create(1),qb=new Ea.a;qb.add(Ha.Zhb);const Qb=Ka.serialize(qb);this.mLh(Qb)?(e.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",Qb),A(Ka)):(e.ULS.sendTraceTag(51258450,
3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",Qb),W("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(na){e.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",na.toString()),W("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}SJl(){return new Promise(A=>{try{var W=-1!==window.location.href.indexOf("&wdccsoff=1");let na=Ha.create(2);W?(na.NC=2,M.AFrameworkApplication.LTf(),e.ULS.sendTraceTag(51258451,
3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",na.toString())):(na.NC=1,e.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",na.toString()));A(na)}catch(na){e.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",na.toString()),W=Ha.create(2),W.NC=1,A(W)}})}bfl(A){e.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===A.NC?M.AFrameworkApplication.LTf():
M.AFrameworkApplication.mYi();e.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",A)}mLh(A){try{e.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",A);const W=this.Oa.Ha("PrivacyCookieDomain")||"";if(!W||!W.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");e.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",A);return bb.a.Oyh("WacUPToggleState",A,bb.a.XJ,W)}catch(W){return e.ULS.sendTraceTag(50860942,
3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",W.toString()),!1}}isFeatureEnabled(A){return this.getSettings().then(W=>{const na=this.Oa.Lu("ServicesControlsMicrosoftControllerServicesList")?this.Oa.eA("ServicesControlsMicrosoftControllerServicesList"):[],Ga=new T.a;for(let Ka=0;Ka<na.length;Ka++)Ga.add(na[Ka]);return Ga.contains(A)?2!==W.NC:!0},()=>{e.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",A);return!0})}static parse(A,W){try{return e.ULS.sendTraceTag(50860943,
3004,50,"Parsing user privacy settings {0} from {1}",A,W),Ha.deserialize(A,W)}catch(na){throw e.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",na.toString()),na;}}}Object(h.a)(Na,"UserPrivacySettingsHelper",null,[536]);var Ia=d(71);class Qa{constructor(){this.Da=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}Yb(A){this.Da=A;this.Da.register(535,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").ma().oa(()=>new ha(M.AFrameworkApplication.fa,
M.AFrameworkApplication.Me));this.Da.register(536,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").ma().oa(()=>new Na(M.AFrameworkApplication.fa,M.AFrameworkApplication.Me));this.Da.register(537,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").ma().oa(()=>new S(M.AFrameworkApplication.fa,M.AFrameworkApplication.Me));this.Da.register(538,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").ma().oa(()=>new Ma(M.AFrameworkApplication.fa,M.AFrameworkApplication.Me,
this.Da.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.Da.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),M.AFrameworkApplication.Ra))}init(){M.AFrameworkApplication.fa.ff(()=>{const A=this.Da.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");M.AFrameworkApplication.fa.ka("LicensingIsEnabled")&&(A.isFeatureEnabled("LicensingTestFeature",!1).then(W=>{e.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",
W,M.AFrameworkApplication.fa.Ha("IsAnonymousUser"));return null}),A.getFeatureTier("LicensingTestFeature",0).then(W=>{e.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",W,M.AFrameworkApplication.fa.Ha("IsAnonymousUser"));return null}));this.Da.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.VEl()})}dispose(){}VEl(){try{M.AFrameworkApplication.fa.ka("SideCarIsEnabled")&&Da.dDh().then(A=>
{e.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",A);return A})}catch(A){}}static main(){Ia.a.instance.Ac(new Qa)}}Object(h.a)(Qa,"ApplicationFeatureHelperPackage",null,[2,3]);var qa=d(521),Wa=d(6);class Hb{constructor(A,W){this.hi=A;this.aE=W}Wx(A,W,na,Ga=null){return this.YVi(A,Ga,Ka=>this.hi.Csb(Ka,2,na,W,2,void 0,void 0,void 0,void 0,void 0,"2"))}YVi(A,W,na){const Ga=!!W&&""!==W;let Ka=A;Ga&&(Ka=D.a.q7a(A,"perfTag",W));const qb=new Date;
return qa.a.then(na(Ka),Qb=>{const t=+new Date-+qb;if(!Qb||!Qb.uj||!Qb.uj.data)return Qb;Ga&&Qb.uj.data.request&&this.Ehl(Qb.uj.data.request.getResolvedUrl(),W,t);return Qb})}Ehl(A,W,na){A=this.aE.Dpj(A);if(A.count&&(A=Wa.last(A))){const Ga={Message:"Request durations for activities calls."};Ga.PerfTag=W;Ga.CustomDuration=na;Ga.PerformanceDuration=A.duration;e.ULS.sendTraceTag(592189641,3012,50,JSON.stringify(Ga))}}}Object(h.a)(Hb,"CatchUpNetworkingWrapper",null,[620]);var jc=d(384);class gc extends jc.a{constructor(A,
W){super(A,W)}pl(){return 6}}Object(h.a)(gc,"GetActivityFeedRequest",jc.a,[]);class $b extends jc.a{constructor(A,W,na,Ga,Ka,qb){super(A,W);this.ItemIds=null;this.ActivityStatesToReset=this.ActivityStatesToSet=0;this.ResetUnseenCount=!1;this.ItemIds=na;this.ActivityStatesToSet=Ga;this.ActivityStatesToReset=Ka;this.ResetUnseenCount=qb}pl(){return 7}}Object(h.a)($b,"UpdateActivityFeedStateRequest",jc.a,[]);var wb=d(537);class Db{constructor(A,W,na){this.Vnf=A;this.H3a=W;this.R3a=na}getActivityFeed(A){return qa.a.then(this.R3a.execute(new gc(this.H3a(),
null),(W,na,Ga)=>this.Vnf.Wx(W,na,Ga,"ActivityFeed"),A),W=>{if(!W)return e.ULS.sendTraceTag(572846937,3012,10,"GetActivityFeed: Response is null"),null;if(!W.uj)return e.ULS.sendTraceTag(572846938,3012,10,"GetActivityFeed: Response.Args is null"),null;W=W.uj.data;if(!W)return e.ULS.sendTraceTag(572846939,3012,10,"GetActivityFeed: Response.Args.Data is null"),null;if(W.Ke!==w.a.mx)return e.ULS.sendTraceTag(508929507,3012,10,"GetActivityFeed: Response status code {0}",W.Ke),null;if(!W.ee)return e.ULS.sendTraceTag(572846940,
3012,10,"GetActivityFeed: Response.Args.Data.ResponseData is null"),null;W=wb.a.q9a(W.ee);return W?W:(e.ULS.sendTraceTag(572846941,3012,10,"GetActivityFeed: Deserialized response is null"),null)})}KMl(A,W,na,Ga,Ka){return qa.a.then(this.R3a.execute(new $b(this.H3a(),null,W,na,Ga,Ka),(qb,Qb,t)=>this.Vnf.Wx(qb,Qb,t,"UpdateActivityFeedState"),A),qb=>{try{return qb.succeeded}catch(Qb){return e.ULS.sendTraceTag(523121054,3012,10,"UpdateActivityFeed: Exception {0}",Qb.message),!1}})}}Object(h.a)(Db,"CatchUpRequestHandler",
null,[621]);var Xb=d(217);class ab{constructor(A){this.Grb=A;this.Gmf=new Xb.a}tak(){this.nbk()}nbk(){if(this.Grb){var A=W=>{this.Gmf.contains("CatchUpChangesFeedback")||(this.Gmf.add("CatchUpChangesFeedback"),W.logActivity("CatchUpChangesFeedback",null))};this.Grb.execute(W=>{window.setTimeout(()=>{A(W)},2E4)})}else e.ULS.sendTraceTag(571586199,383,15,"FloodgateEventLogger: IFuture<ISystemInitiatedFeedback> was null")}}Object(h.a)(ab,"FloodgateEventLogger",null,[]);class Ab{constructor(A){this.o4h=
A}get duration(){return this.o4h.duration}}Object(h.a)(Ab,"PerformanceResourceTimingWrapper",null,[]);class rc{constructor(A){this.aE=A}Dpj(A){const W=new Ea.a;if(!this.aE)return W;A=this.aE.getEntriesByName(A,"resource");if(!A)return W;for(const na of A)W.add(new Ab(na));return W}}Object(h.a)(rc,"PerformanceWrapper",null,[]);class tb{constructor(){this.Da=null}get name(){return"Common.App.CatchUpActivity"}Yb(A){this.Da=A;this.Da.register(Hb,"Common.App.CatchUpActivity.CatchUpNetworkingWrapper").as("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper").ma().oa(()=>
new Hb(M.AFrameworkApplication.Me,new rc(window.performance)));this.Da.register(Db,"Common.App.CatchUpActivity.CatchUpRequestHandler").as("Common.App.CatchUpActivity.ICatchUpRequestHandler").ma().oa(()=>new Db(this.Da.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper"),()=>M.AFrameworkApplication.gh,new wb.a));this.Da.register(ab,"Common.App.CatchUpActivity.FloodgateEventLogger").ma().oa(()=>new ab(this.Da.Ia("Common.ISystemInitiatedFeedback")))}init(){this.Da.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper");
this.Da.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler")}dispose(){}static main(){Ia.a.instance.Ac(new tb)}}Object(h.a)(tb,"CatchUpActivityPackage",null,[2,3]);var Za=d(1243),fb=d(107);class ac{constructor(A,W,na){this.e2e=this.f2e=this.g2e=!1;this.s2e=!A&&!W;this.t2e=!A&&!na;this.s2e||this.t2e||(this.g2e=!A,this.f2e=!W,this.e2e=!na)}}Object(h.a)(ac,"RenameDisabledDialogInfo",null,[]);class Dc extends fb.StandardDialog{constructor(A,W,na,Ga,Ka){super();this.M5e=[];this.N2=new ac(A,W,na);
this.rQa=Ga;this.TOa=Ka;this.kg="RenameDisabledDialog";this.Ad=0;this.Oe(1,CommonUIStrings.l_DialogClose);this.Uol();this.Q9k()}Uol(){this.N2.s2e?this.guc(this.rQa?this.TOa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.N2.t2e?this.guc(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.Eci();this.tIc(this.M5e)}guc(A){Array.add(this.M5e,A)}Eci(){const A=[];this.N2.g2e||
Array.add(A,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.N2.f2e||Array.add(A,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.N2.e2e||Array.add(A,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<A.length&&Array.add(this.M5e,A)}}Object(h.a)(Dc,"ReactRenameDisabledDialogBase",fb.StandardDialog,[]);class Sc extends Dc{constructor(A,W,na,Ga,Ka){super(A,W,na,Ga,Ka)}Q9k(){this.THb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(h.a)(Sc,"ReactRenameDisabledDialog",
Dc,[]);var xb=d(79);class Ta{static get sg(){return xb.a.VC(Ta.Fo,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}Ta.Fo="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(h.a)(Ta,"RenameDisabledDialogHtml",null,[]);class ib extends xb.a{constructor(A,W,na,Ga,Ka){super();this.N2=new ac(A,W,na);this.rQa=Ga;this.TOa=Ka;this.kg="RenameDisabledDialog";this.Ad=0;this.Oe(1,CommonUIStrings.l_DialogClose);this.sg=Ta.sg;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.y6("RenameRow")}Jxa(){if(this.N2.s2e){let A;A=this.rQa?this.TOa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;ib.guc(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),A)}else this.N2.t2e?ib.guc(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.SIj()}SIj(){this.N2.g2e&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.N2.f2e&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.N2.e2e&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static guc(A,W,na){A.style.display="none";W.innerText=na}}Object(h.a)(ib,"RenameDisabledDialog",xb.a,[]);var ob=d(47),fc=d(73);class Jb{constructor(A,W){this.v5a=0;this.Ca=A;this.Bqa=W}initialize(A){if(!this.Ca||!this.Bqa)return!1;this.v5a=A;this.vb();return!0}vb(){this.Ca.ya(sa.a.nNc,fc.a.frame,Object(n.a)(this,this.nNc,"commitNewDocumentTitle"))}nNc(A,W,na,Ga,Ka){if(1===na)return this.Ca.processAction(sa.a.renameFile,
1);A=ob.a.iH(this.Bqa.rx);Ka=(0,Ka.getNewDocumentTitle)();Ka.length>this.v5a&&(Ka=Ka.substr(0,this.v5a));if(32!==this.Ca.Ka(sa.a.renameFile,2,Ka))return this.gRb(A),8;this.gRb(Ka);return 32}gRb(A){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(A))}static XC(){return new Jb(M.AFrameworkApplication.Ra,M.AFrameworkApplication.du)}}Object(h.a)(Jb,"ReactRenameUIHandler",null,[654]);var xc=d(265),ic=d(680),nc=d(582),Wb=d(67),wc=d(183),nb=d(281),Rb=d(139),mb=d(65);class Ub{constructor(A,W,
na,Ga,Ka,qb,Qb,t,Y,pa,Ja,Ya){this._initialized=!1;this._element=null;this.v5a=0;this.ZNd=this.oGd=!1;this.Ca=A;this.uBd=W;this.Wg=na;this.Xz=Ga;this.Bqa=Ka;this.ksf=qb;this.bGc=Qb;this.rCd=t;this.Mqa=Y;this.jkf=pa;this.nj=Ja;this.iHd=Ya}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(A,W,na){if(!(this.Ca&&this.Bqa&&this.ksf&&this.bGc&&this.rCd&&W)||0>=A)return!1;this._element=W;this._element.title=na;this._element.setAttribute(Rb.a.hf,Rb.a.Ju);this._element.setAttribute("Unselectable",
"on");this.v5a=A;this.kP();return this._initialized=!0}kP(){this.uBd&&(this.uBd.rb(Wb.a.blur,this._element,Object(n.a)(this,this.onBlur,"onBlur")),this.uBd.rb(Wb.a.paste,this._element,Object(n.a)(this,this.QFk,"onPaste")));this.Wg.rb(Wb.a.Bf,this._element,Object(n.a)(this,this.onKeyDown,"onKeyDown"));this.Xz.rb(Wb.a.pointerDown,this._element,Object(n.a)(this,this.nib,"onPointerDown"));this.Xz.rb(Wb.a.WR,this._element,Object(n.a)(this,this.IMe,"onPointerUp"))}onBlur(){this.isActive&&!this.oGd&&(this.jkf||
this.rCd(this._element),this.kMf(),this.r2d(!1));return this.oGd=!1}QFk(){e.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(A){return this.isActive?this.wEk(A):this.xEk(A)}wEk(A){let W=!1;switch(A.mc.keyCode){case Sys.UI.Key.enter:this.kMf();this.r2d(this.nj||this.iHd);W=!0;break;case Sys.UI.Key.tab:this.jkf&&this.rCd(this._element);break;case Sys.UI.Key.esc:this.YWe(),this.r2d(this.nj||this.iHd),W=!0}return W}xEk(A){let W=!1;switch(A.mc.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.gKh(this.iHd),
this.isActive&&this.bGc(this._element),W=!0}return W}nib(){this.isActive||(this.gKh(!1),this.isActive&&(this._element.focus(),this.bGc(this._element),this.ZNd=!0));return!1}IMe(){return this.ZNd?(this.bGc(this._element),this.ZNd=!1,!0):!1}zBb(){return 32===this.Ca.processAction(sa.a.renameFile,1)}kMf(){const A=ob.a.iH(this.Bqa.rx);let W=this._element.innerText.trim();W.length>this.v5a&&(W=W.substr(0,this.v5a));W!==A&&""!==W?32!==this.Ca.Ka(sa.a.renameFile,2,W)?this.YWe():this.gRb(W):this.YWe()}YWe(){this.gRb(ob.a.iH(this.Bqa.rx))}gRb(A){this._initialized&&
(this._element.innerText=A,this.ksf())}gKh(A){this.zBb()?this.isActive||(A&&(this.oGd=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(Rb.a.hf,Rb.a.jDf),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,xc.CuiHelper.OVf),this.Mqa&&this.Mqa.execute(W=>{W.wkh(!0)}),A&&this._element.focus(),e.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.Ca.processAction(sa.a.OOb,
2)}r2d(A){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(Rb.a.hf,Rb.a.Ju);Sys.UI.DomElement.removeCssClass(this._element,xc.CuiHelper.OVf);this.Mqa&&this.Mqa.execute(W=>{W.wkh(!1)});A&&(this._element.blur(),this._element.focus())}static X0a(){ic.a.X0a(M.AFrameworkApplication.isRtl)}static XC(){return new Ub(M.AFrameworkApplication.Ra,nc.a.instance,wc.KeyInputManager.instance,nb.a.instance,M.AFrameworkApplication.du,Ub.X0a,
mb.a.pgl,mb.a.GKf,I.a.instance.Ia("Common.App.Header.HeaderEventSource"),Z.a.aG,Z.a.Vi,Z.a.gg)}}Object(h.a)(Ub,"RenameUIHandler",null,[654]);class zc{static get instance(){return M.AFrameworkApplication.Aa.ob.mO?zc.La||(zc.La=Jb.XC()):zc.La||(zc.La=Ub.XC())}}zc.La=null;Object(h.a)(zc,"RenameUIHandlerFactory",null,[]);class Pc{constructor(){this.JJe=this.Ixk=this.vQi=null}}Object(h.a)(Pc,"RenameMruEntryProperties",null,[]);var Mc=d(178),ld=d(127),vb=d(442),cc;(function(A){A[A.unknown=-1]="unknown";
A[A.success=0]="success";A[A.renameInvalidFileName=1]="renameInvalidFileName";A[A.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";A[A.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";A[A.permissionDenied=4]="permissionDenied";A[A.serverCommunicationFailure=5]="serverCommunicationFailure";A[A.fileNameTooLong=6]="fileNameTooLong"})(cc||(cc={}));Object(h.b)("CommonOperationResult",cc);class Hc{constructor(A,W,na,Ga,Ka,qb,Qb,t,Y,pa,Ja,Ya){this.vkf=A;this.Ca=W;this.Jha=na;this.uF=
Ga;this.l5a=Ka;this.l$h=qb;this.rQa=Qb;this.$uf=t;this.I5h=Y;this.TOa=pa;this.Oa=Ja;this.H5h=Ya}vb(){M.AFrameworkApplication.Aa&&M.AFrameworkApplication.Aa.ob.mO||this.qn.ya(sa.a.G$b,fc.a.frame,Object(n.a)(this,this.G$b,"initializeRenameUIHandler"));this.qn.ya(sa.a.OOb,fc.a.frame,Object(n.a)(this,this.OOb,"showRenameDisabledDialog"));this.qn.ya(sa.a.renameFile,fc.a.frame,Object(n.a)(this,this.renameFile,"renameFile"));this.qn.ra(sa.a.fileNameUpdate,fc.a.frame,Object(n.a)(this,this.a2k,"refreshFilename"),
64);this.qn.ra(sa.a.Ngd,fc.a.frame,Object(n.a)(this,this.Ngd,"moveToFolderCompleteByHost"),64);this.qn.ya(sa.a.Nhb,fc.a.frame,Object(n.a)(this,this.Nhb,"moveToFolder"));(M.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||M.AFrameworkApplication.Aa&&(M.AFrameworkApplication.fa.ka("PostMessageEmbedded")||M.AFrameworkApplication.fa.ka("IsJsApi"))&&M.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",
!0))&&M.AFrameworkApplication.KT().execute(A=>{A.Iu(ld.a.N4g);A.dC(ld.a.N4g,Hc.h0k);A.Iu(ld.a.c7d);A.dC(ld.a.c7d,Hc.f0k)})}zBb(){return 0===this.H5h.$$f()?32:8}VRl(){return this.qB?this.rQa?this.qB.g4d:this.qB.EEa:!0}G$b(){return zc.instance.initialize(M.AFrameworkApplication.wSc,M.AFrameworkApplication.FQc,M.AFrameworkApplication.tph||CommonUIStrings.l_RenameFileTooltip)?32:8}OOb(){const A=this.VRl(),W=this.l$h();e.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.l5a,W,A,this.rQa);M.AFrameworkApplication.Aa&&M.AFrameworkApplication.Aa.ob.hD&&M.AFrameworkApplication.fa.ka("ReactRenameDisabledDialogIsEnabled")?new Sc(this.l5a,!W,!A,this.rQa,this.TOa()):new ib(this.l5a,!W,!A,this.rQa,this.TOa());return 32}renameFile(A,W,na,Ga,Ka){if(1===na)return this.zBb();if(!M.AFrameworkApplication.T9a)return 8;if(8===this.zBb())return this.qn.processAction(sa.a.OOb,2),8;e.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");M.AFrameworkApplication.T9a(Ka,Object(n.a)(this,
this.Vmc,"onRenameFileSuccess"),Object(n.a)(this,this.FGk,"onRenameFileFailure"));M.AFrameworkApplication.s9k=!0;return 32}Vmc(A,W){A?0!==A.OperationResult?this.Peg(A.OperationResult):(this.xhl(W,A.NewName),this.XMl(A,Object(n.a)(M.AFrameworkApplication.Aa.ob,M.AFrameworkApplication.Aa.ob.fOh,"updateOpenInClientDocumentUrl")),M.AFrameworkApplication.fa.ka("DocumentNameInJewelInfoMenuIsEnabled")&&M.AFrameworkApplication.Aa.updateCommandUI(),this.I5h.JMh()):this.Peg(5)}xhl(A,W){const na={};na[Mc.a.S3i]=
W;A.sendMessage(ld.a.c7d,na)}XMl(A,W){this.hNl(A);M.AFrameworkApplication.$Pc=A.DirectInvokeDavUrl;W=W(A.EditDocInClientUrl);const na=new Pc;na.JJe=this.uF.rx;na.vQi=W;na.Ixk=A.EditDocInClientUrl;this.qn.Ka(sa.a.uph,2,na)}Peg(A){switch(A){case 1:A=new fb.StandardDialog,A.Ad=0,A.sP(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.Jrh()}}hNl(A){this.uF.rx=Hc.jli(this.uF.rx,A.NewName);A.BreadcrumbFolderName&&(this.uF.breadcrumbFolderName=A.BreadcrumbFolderName);
A.BreadcrumbFolderUrl&&(this.uF.breadcrumbFolderUrl=A.BreadcrumbFolderUrl);this.$uf(A.NewName)}FGk(A){const W=new fb.StandardDialog;W.Ad=0;switch(A){case 1:e.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");W.Rlb(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:e.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");W.Rlb(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,
null);break;default:e.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:A}),W.Rlb(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}M.AFrameworkApplication.KT().execute(na=>{na.sendMessage(ld.a.R3i,{["FailureMessage"]:cc[A]})});this.Jrh()}a2k(A,W,na){if(1===na)return this.zBb();if(!M.AFrameworkApplication.nta)return 8;M.AFrameworkApplication.nta(Object(n.a)(this,this.fJb,"onRefreshFilenameSuccess"),Object(n.a)(this,this.Gjd,"onRefreshFilenameFailure"),
!1);return 32}Nhb(A,W,na,Ga,Ka){if(1===na)return M.AFrameworkApplication.fa.ka("UiHostSupportsMoveToFolder")?32:8;if(2===na){const qb={};A=M.AFrameworkApplication.Scb;W=M.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures");A=(!A||A&&W)&&M.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);qb[Mc.a.yCl]=A;Ka&&Ka.MoveButtonClickedTime&&(qb[Mc.a.Kwk]=Ka.MoveButtonClickedTime.getTime());M.AFrameworkApplication.KT().execute(Qb=>{Qb.sendMessage(ld.a.Nhb,
qb)});Ka&&Ka.MoveButtonClickedTime&&((A=L.a.aA())&&A.set("MovePostDuration",((new Date).getTime()-Ka.MoveButtonClickedTime.getTime()).toString()),B.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",A));return 32}return 8}Ngd(A,W,na,Ga,Ka){if(1===na)return M.AFrameworkApplication.fa.ka("UiHostSupportsMoveToFolder")?this.zBb():8;if(2===na){if(!M.AFrameworkApplication.usc)return B.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;
if(!Ka)return B.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(Ka[Mc.a.gVj])if(Ka[Mc.a.cPh])if(A=Ka[Mc.a.cPh].toLowerCase(),W=M.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"),na=M.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),W&&M.AFrameworkApplication.Scb&&na){const qb={};qb[Mc.a.FLb]="1";qb[Mc.a.documentUrl]=A;qb[Mc.a.reason]=vb.a.$Xe;B.Health.instance.recordKpiSuccess("MoveToFolder",null);M.AFrameworkApplication.KT().execute(Qb=>
{Qb.sendMessage(ld.a.XDa,qb)})}else if(!M.AFrameworkApplication.Scb&&na)B.Health.instance.recordKpiSuccess("MoveToFolder",null),mb.a.En(A,mb.a.Iba(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return B.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else B.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else M.AFrameworkApplication.nta(Object(n.a)(this,this.fJb,"onRefreshFilenameSuccess"),Object(n.a)(this,this.Gjd,"onRefreshFilenameFailure"),
!1),M.AFrameworkApplication.usc(),B.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}vul(A,W){return A&&W?A!==this.uF.breadcrumbFolderName||W!==this.uF.breadcrumbFolderUrl:!1}fJb(A,W){A&&(A.NewName!==ob.a.iH(this.uF.rx)||this.vul(A.BreadcrumbFolderName,A.BreadcrumbFolderUrl))&&this.Vmc(A,W)}Gjd(){}Jrh(){this.$uf(ob.a.iH(this.uF.rx))}get qn(){return this.Ca.value}get qB(){return this.Jha.value}static get instance(){return Hc.La||(Hc.La=Hc.E$a())}static E$a(){return new Hc(M.AFrameworkApplication.Tbc,
new Za.a(()=>M.AFrameworkApplication.Ra),new Za.a(()=>M.AFrameworkApplication.qB),M.AFrameworkApplication.du,M.AFrameworkApplication.ZQ,()=>M.AFrameworkApplication.qxc,M.AFrameworkApplication.frc,Object(n.a)(zc.instance,zc.instance.gRb,"updateTitle"),I.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>M.AFrameworkApplication.dU,M.AFrameworkApplication.fa,I.a.instance.resolve("Common.IRenameProps"))}static jli(A,W){A=ob.a.AQ(A);return W+A}static h0k(A){const W=A.Values[Mc.a.MZj];e.ULS.sendTraceTag(560820289,
204,50,"Host_MoveToFolder Received IsSuccessful: {0}",W);W?M.AFrameworkApplication.Ra.Ka(sa.a.Ngd,2,A.Values):B.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static f0k(A){M.AFrameworkApplication.Ra.Ka(sa.a.renameFile,2,A.Values.NewName)}}Hc.La=null;Object(h.a)(Hc,"RenameActor",null,[]);var Pb=d(393),Uc=d(664),sc=d(602),lb=d(203);class Zb{constructor(A,W){this.Ca=A;this.wDd=W}vb(){this.Ca.ya(sa.a.n2e,fc.a.frame,Object(n.a)(this,this.$wl,"showRenameDialogAction"))}$wl(A,
W,na){A=32;if(1===na)return lb.SessionStatusManager.instance.gla||M.AFrameworkApplication.VQ?8:32;2===na&&(32!==this.Ca.processAction(sa.a.renameFile,1)?(this.Ca.processAction(sa.a.OOb,2),Pb.a.instance.Xb(Uc.a.ska,{["Reason"]:sc.a.r9k}),A=8):32===this.Ca.processAction(sa.a.fuc,1)?this.Ca.processAction(sa.a.fuc,2):this.wDd.value.create().Nga());return A}}Object(h.a)(Zb,"RenameDialogActor",null,[636]);class Oc{constructor(A,W,na){this.dialog=null;this.Ca=A;this.uF=W;this.tOa=na}xpj(){const A={};A.nameInputProps=
{["type"]:"AppInputProps",["id"]:Oc.kwb,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:ob.a.iH(this.uF.rx),["maxLength"]:this.tOa};return A}Nga(){const A={["id"]:"RenameDialog",["bodyControls"]:this.xpj()};this.dialog=new xb.a(!1,!1,!0);this.dialog.Ad=1;this.dialog.kg="RenameDialog";this.dialog.pj(CommonUIStrings.l_RenameDialogTitle,Object(n.a)(this,this.NVe,"renameDialogHandler"),A)}NVe(A,W){if(W&&1===A){if(W[Oc.kwb]&&(A=ob.a.iH(this.uF.rx),W=(W[Oc.kwb]||"").trim(),W!==A&&""!==W)){this.Ca.Ka(sa.a.renameFile,
2,W);return}Pb.a.instance.Xb(Uc.a.D4b,{["Reason"]:sc.a.E_f})}}}Oc.kwb="txtDocumentName";Object(h.a)(Oc,"ReactRenameDialog",null,[656]);class md{static get sg(){return xb.a.VC(md.Fo,CommonUIStrings.l_RenameDialogLabel)}}md.Fo="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(h.a)(md,"RenameDialogHtml",null,[]);class Ib extends xb.a{constructor(A,
W,na){super();this.Ca=A;this.uF=W;this.tOa=na;this.kg="RenameDialog";this.sg=md.sg}Nga(){var A={["txtDocumentName"]:ob.a.iH(this.uF.rx)};this.pj(CommonUIStrings.l_RenameDialogTitle,Object(n.a)(this,this.NVe,"renameDialogHandler"),A);A=document.getElementById(Ib.kwb);0<this.tOa&&(A.maxLength=this.tOa);A.focus()}NVe(A,W){if(1===A&&(A=ob.a.iH(this.uF.rx),W=(W[Ib.kwb]||"").trim(),W!==A&&""!==W)){this.Ca.Ka(sa.a.renameFile,2,W);return}Pb.a.instance.Xb(Uc.a.D4b,{["Reason"]:sc.a.E_f})}}Ib.kwb="txtDocumentName";
Object(h.a)(Ib,"RenameDialog",xb.a,[656]);class ud{constructor(A){this.Bqa=null;this.tOa=0;this.Ca=A;this._initialized=!1}initialize(A,W){this.Bqa=A;this.tOa=W;this._initialized=!0}create(){return this._initialized?M.AFrameworkApplication.Aa&&M.AFrameworkApplication.Aa.ob.hD&&M.AFrameworkApplication.fa.ka("ReactRenameDialogIsEnabled")?new Oc(this.Ca,this.Bqa,this.tOa):new Ib(this.Ca,this.Bqa,this.tOa):null}}Object(h.a)(ud,"RenameDialogFactory",null,[635]);var od=d(120),Ud=d(97),Ad=d(70),be=d(82),
uf=d(134);class sd{constructor(A,W){this.Ca=A;this.Pd=W}vb(){this.Ca.ya(sa.a.fuc,fc.a.frame,Object(n.a)(this,this.axl,"showRenameFlyoutAction"))}axi(){return Ad.d("setDocumentTitleFlyoutOpened")&&M.AFrameworkApplication.Aa.ob.mO}axl(A,W,na){if(1===na)return this.axi()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}Ldi(){sd.j3j&&M.AFrameworkApplication.Zua&&uf.a.instance.Hb(new be.a(5,1,5E3,()=>{32===this.Ca.processAction(sa.a.fuc,1)&&this.Pd&&this.Pd.Ee.name===
od.AFrame.JW&&(Ud.a("RenameFloatieShownOnNewDocumentLoad",!0),this.Ca.processAction(sa.a.fuc,2))}))}static get j3j(){sd.JCc&&null!=sd.JCc||(M.AFrameworkApplication.dma("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),sd.JCc=M.AFrameworkApplication.fa?M.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return sd.JCc}}sd.JCc=null;Object(h.a)(sd,"RenameFlyoutActor",null,[634]);class Ze{constructor(A,
W,na,Ga,Ka){this.BZd=null;this.Jha=Ka;this.wkf=na;this.vkf=Ga;this.n$h=A;this.TOa=W}get qB(){return this.Jha.value}$$f(){if(!this.vkf())return 5;if(this.TOa())return 1;if(this.qB){if(this.wkf&&!this.qB.g4d)return 3;if(!this.wkf&&!this.qB.EEa)return 4}return this.n$h()?0:2}}Object(h.a)(Ze,"RenameProps",null,[633]);var Ke=d(72);class hf{constructor(A,W,na,Ga,Ka,qb){this.wC=!1;this.WId=new Ke.a;this.hpb=W;this.Wzc=na;this.jzc=Ga;this.Oa=Ka;this.Oia=qb}enable(){this.wC||(this.JMh(),this.G3e(),this.wC=
!0)}generateKey(A,W,na){return String.format("{0}/{1}/{2}",na,A,W)}xjj(){const A=ob.a.iH(this.hpb().rx);return this.generateKey(this.hpb().breadcrumbFolderName,this.hpb().breadcrumbFolderUrl,A)}yjj(A,W,na){return A&&W?this.generateKey(A,W,na):na}qUi(A,W,na){return A&&A!==this.hpb().breadcrumbFolderName||W&&W!==this.hpb().breadcrumbFolderUrl?!0:na!==ob.a.iH(this.hpb().rx)}JMh(){const A=this.xjj();this.WId.$(A,new Date)}KOe(A){this.Xsl(A)&&this.mwf(A)}Xsl(A){const W=this.jzc();return W?this.Oia&&this.Oia.ucb||
!W.yne||!M.AFrameworkApplication.nta?(this.sFh(A),this.wC=!1):!0:!1}Cbh(A,W,na,Ga){const Ka=this.qUi(A,W,na);A=this.yjj(A,W,na);W=this.WId.wg(A).returnValue;Ka&&!W&&(this.Seg(Ga),e.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.rva));Ka||this.WId.$(A,this.Wzc())}}Object(h.a)(hf,"ARenamedFileChecker",null,[615]);class Xa extends hf{constructor(A,W,na,Ga,Ka,qb,Qb,t){super(A,W,na,Ga,Ka,qb);this.Tqf=Ka;this.G5h=Qb;this.dGd=t}get rva(){return"RenamedFileCheckerUsingSettingsRefresh"}G3e(){this.Tqf.oTd(Object(n.a)(this,
this.Tfg,"handleSettingsRefresh"))}Tfg(A,W){W&&W.Wlc&&W.Uzk&&(W.KBb("BreadcrumbDocName")||W.KBb("BreadcrumbFolderName")||W.KBb("BreadcrumbFolderUrl")||W.KBb("DirectInvokeDAVUrl")||W.KBb("EditDocInClientUrl"))&&(e.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.rva),this.KOe(W))}sFh(){this.Tqf.Soh(Object(n.a)(this,this.Tfg,"handleSettingsRefresh"))}mwf(A){if(A&&A.Wlc){const W=A.Wlc;this.Cbh(W.Ha("BreadcrumbFolderName"),W.Ha("BreadcrumbFolderUrl"),W.Ha("BreadcrumbDocName"),A)}}Seg(A){const W=
{OperationResult:0,classId:1};A=A.Wlc;W.BreadcrumbFolderName=A.Ha("BreadcrumbFolderName");W.BreadcrumbFolderUrl=A.Ha("BreadcrumbFolderUrl");W.DirectInvokeDavUrl=A.Ha("DirectInvokeDAVUrl");W.EditDocInClientUrl=A.Ha("EditDocInClientUrl");A=A.Ha("BreadcrumbDocName");W.NewName=M.AFrameworkApplication.AQc?A:ob.a.iH(A);this.dGd.execute(na=>{this.IRj(W,na)})}IRj(A,W){this.G5h().Vmc(A,W)}}Object(h.a)(Xa,"RenamedFileCheckerUsingSettingsRefresh",hf,[]);class Bb extends hf{constructor(A,W,na,Ga,Ka,qb,Qb,t,Y,
pa){super(A,na,Ga,Ka,qb,Y);this.TXb=this.ZHc=null;this.t4h=W;this.Ca=Qb;this.Zd=t;pa&&pa.execute(Ja=>{this.R4k(Ja)})}get rva(){return"RenamedFileCheckerUsingTask"}R4k(A){this.ZHc=A;this.ZHc.lJc(Object(n.a)(this,this.E9b,"handleVisibilityChange"))}E9b(A,W){!this.wC||0!==W.newState&&1!==W.newState||this.TXb||(this.G3e(),this.KOe(this.TXb))}G3e(){this.TXb=new be.a(3,2,this.t4h(),Object(n.a)(this,this.KOe,"performRenameFileCheckTick"),89);this.Zd.Hb(this.TXb)}sFh(A){this.Zd.Lg(A)}mwf(A){this.ZHc&&2===
this.ZHc.E7a?this.Y5k(A):M.AFrameworkApplication.nta(Object(n.a)(this,this.fJb,"onRefreshFilenameSuccess"),Object(n.a)(this,this.Gjd,"onRefreshFilenameFailure"),!0)}Y5k(A){this.Zd.Lg(A);this.TXb=null}fJb(A){A&&this.Cbh(A.BreadcrumbFolderName,A.BreadcrumbFolderUrl,A.NewName,null)}Seg(){this.Ca.processAction(sa.a.fileNameUpdate,2)}Gjd(){}}Object(h.a)(Bb,"RenamedFileCheckerUsingTask",hf,[]);var mc=d(95);class Qc{constructor(){this.Oa=this.Da=null}get name(){return"Common.App.RenameFile"}Yb(A){this.Da=
A;this.Oa=M.AFrameworkApplication.fa;this.Da.register(Zb,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").oa(()=>new Zb(M.AFrameworkApplication.Ra,this.Da.oe("Common.App.Rename.IRenameDialogFactory"))).ma();this.Da.register(ud,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").oa(()=>new ud(M.AFrameworkApplication.Ra)).ma();this.Da.register(615,"Common.App.Rename.IRenamedFileChecker").oa(()=>this.LNi()).ma();this.Da.register(sd,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").oa(()=>
new sd(M.AFrameworkApplication.Ra,mc.FocusManager.instance())).ma()}LNi(){if(this.Oa.ka("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const A=this.Da.qb("Common.IRefreshableAppSettings");if(A&&A.K1j)return new Xa(()=>A.wc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>M.AFrameworkApplication.du,()=>new Date,()=>M.AFrameworkApplication.qB,A,this.Da.qb("Common.ISessionStatus"),()=>Hc.instance,this.Da.Ia("Postmessage.IHostPostmessenger"))}return new Bb(()=>this.Oa.wc("RenamedFileCheckerMaxCachedAgeInMs",
48E4),()=>this.Oa.wc("RenamedFileCheckerPingIntervalInMs",12E4),()=>M.AFrameworkApplication.du,()=>new Date,()=>M.AFrameworkApplication.qB,M.AFrameworkApplication.fa,M.AFrameworkApplication.Ra,M.AFrameworkApplication.Ae,this.Da.qb("Common.ISessionStatus"),this.Da.Ia("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.Oa.ff(Object(n.a)(this,this.en,"onFullAppSettingsReady"))}en(){const A=M.AFrameworkApplication.Aa.ob.mO;M.AFrameworkApplication.Tbc()&&zc.instance.initialize(M.AFrameworkApplication.wSc,
A?null:M.AFrameworkApplication.FQc,A?null:M.AFrameworkApplication.tph||CommonUIStrings.l_RenameFileTooltip)&&(this.Da.register(Ze,"Common.App.Rename.RenameProps").as("Common.IRenameProps").oa(()=>new Ze(()=>M.AFrameworkApplication.qxc,()=>M.AFrameworkApplication.dU,M.AFrameworkApplication.frc,M.AFrameworkApplication.Tbc,new Za.a(()=>M.AFrameworkApplication.qB))).ma(),Hc.instance.vb(),this.Oa.ka("RenameDialogIsEnabled")&&(this.Da.resolve("Common.App.Rename.RenameDialogFactory").initialize(M.AFrameworkApplication.du,
M.AFrameworkApplication.wSc),this.Da.resolve("Common.App.Rename.IRenameDialogActor").vb()),this.Da.resolve("Common.App.Rename.IRenameFlyoutActor").vb(),M.AFrameworkApplication.frc&&this.Da.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.Da.resolve("Common.App.Rename.IRenameFlyoutActor").Ldi())}dispose(){}}Object(h.a)(Qc,"PackageManager",null,[2,3]);const td=A=>{try{return C.a(A)}catch(W){}return null};class Md{constructor(A,W,na,Ga,Ka,qb){this.K2=!1;this.LS=null;this.YLd=!1;this.Ca=
A;this.hi=W;this.Jha=na;this.emf=Ga;this.Oa=Ka;this.E1h=qb}init(A,W){W&&A.Ia("Common.Interface.IRtcBasicProvider").execute(Object(n.a)(this,this.WVd,"awaitRtc"))}WVd(A){const W=A.GM.task;W.continueWith(()=>{this.LS=W.result;this.YLd&&(this.LS.Xaa(2,null,!0),this.YLd=!1);this.LS.ECa((na,Ga)=>{2===Ga.type&&this.qn.processAction(sa.a.fileNameUpdate,2)});this.LS.v7a((na,Ga)=>{2===Ga.newState&&this.qn.processAction(sa.a.fileNameUpdate,2)});2===this.LS.connectionState&&this.qn.processAction(sa.a.fileNameUpdate,
2)})}nta(A){this.OYf(A,!0)}OYf(A,W){const na=this.Hsi(A.mDh),Ga={};Ga[Md.hNf]=Md.iNf;this.Mqh.zj(na,2,"",Ga,!1,2,Object(n.a)(this,this.fJb,"onRefreshFilenameSuccess"),W?Object(n.a)(this,this.yGk,"onRefreshFilenameFailureRetry"):Object(n.a)(this,this.tah,"onRefreshFilenameFailureNoRetry"),A)}fJb(A){this.K2=!1;const W=td(A.data.ee);A.data.state.onSuccess(W,this.emf.value)}yGk(A){5!==A.data.status||this.K2?this.tah(A):(this.K2=!0,this.OYf(A.data.state,!1))}tah(A){A.data.state.Kz(-1)}T9a(A){this.PYf(A,
!0)}PYf(A,W){const na=this.Isi(),Ga={};Ga[Md.hNf]=Md.iNf;Ga[Md.IGj]=ob.a.Qe(A.Wqh);Ga[Md.GGj]=this.E1h.value.BZd;this.Mqh.zj(na,2,"",Ga,!1,2,Object(n.a)(this,this.Vmc,"onRenameFileSuccess"),W?Object(n.a)(this,this.GGk,"onRenameFileFailureRetry"):Object(n.a)(this,this.zah,"onRenameFileFailureNoRetry"),A)}Isi(){return this.JFf()}Hsi(A){let W=this.JFf();return W=D.a.Ti(W,Md.MGj,A?"2":"1")}JFf(){let A=(this.Oa.value.appSettings.RenameWebServiceBase||"")+Md.HGj;A=D.a.Ti(A,Md.JGj,ob.a.Qe(M.AFrameworkApplication.gh));
this.qB&&this.qB.yne&&(A=D.a.Ti(A,Md.LGj,"1"));return A}Vmc(A){this.K2=!1;const W=td(A.data.ee);A.data.state.onSuccess(W,this.emf.value);this.o6g()}o6g(){this.LS?this.LS.Xaa(2,null,!0):this.YLd=!0}GGk(A){5!==A.data.status||this.K2?this.zah(A):(this.K2=!0,this.PYf(A.data.state,!1))}zah(A){A.data.state.Kz(-1)}get qn(){return this.Ca.value}get Mqh(){return this.hi.value}get qB(){return this.Jha.value}static get instance(){return Md.La||(Md.La=Md.E$a())}static E$a(){return new Md(new Za.a(()=>M.AFrameworkApplication.Ra),
new Za.a(()=>M.AFrameworkApplication.Me),new Za.a(()=>M.AFrameworkApplication.qB),new Za.a(()=>I.a.instance.resolve("Postmessage.IHostPostmessenger")),new Za.a(()=>M.AFrameworkApplication.fa),new Za.a(()=>I.a.instance.resolve("Common.IRenameProps")))}}Md.hNf="Content-Type";Md.iNf="application/json; charset=utf-8";Md.HGj="renamehandler.ashx";Md.JGj="qs";Md.IGj="n";Md.LGj="sl";Md.GGj="X-CoauthLockId";Md.MGj="u";Md.La=null;Object(h.a)(Md,"ExecuteRenameFileHandler",null,[]);class Pd{constructor(){this.Kz=
this.onSuccess=null;this.mDh=!1}}Object(h.a)(Pd,"ExecuteRefreshFilenameData",null,[]);class Be{constructor(){this.Kz=this.onSuccess=this.Wqh=null}}Object(h.a)(Be,"ExecuteRenameFileData",null,[]);class fe{constructor(){this.Da=null;this.xEd=Md.instance}get name(){return"Common.App.RenameFile.RenameExecutor"}Yb(A){this.Da=A}init(){M.AFrameworkApplication.fa.ff(Object(n.a)(this,this.en,"onFullAppSettingsReady"))}en(){M.AFrameworkApplication.Tbc()&&(Md.instance.init(this.Da,M.AFrameworkApplication.frc),
M.AFrameworkApplication.T9a=Object(n.a)(this,this.T9a,"executeRenameFile"),M.AFrameworkApplication.nta=Object(n.a)(this,this.nta,"executeRefreshFilename"),M.AFrameworkApplication.usc=Object(n.a)(this,this.usc,"sendFileNameAndLocationUpdateNotification"))}T9a(A,W,na){const Ga=new Be;Ga.Wqh=A;Ga.onSuccess=W;Ga.Kz=na;this.xEd.T9a(Ga)}nta(A,W,na){const Ga=new Pd;Ga.onSuccess=A;Ga.Kz=W;Ga.mDh=na;this.xEd.nta(Ga)}usc(){this.xEd.o6g()}dispose(){}}Object(h.a)(fe,"PackageManager",null,[2,3]);class Mf{constructor(A,
W,na,Ga,Ka,qb){this.PolicyCookie=this.WebAffinitizedUrl=this.IsSafeLinksEnabled=null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=A;this.WebAffinitizedUrl=W;this.PolicyCookie=na;this.PolicyCookieTTL=Ga;this.WasServiceDown=Ka;this.AffinitizedUrl=qb}}Object(h.a)(Mf,"SafeLinksData",null,[]);class Bd{constructor(A,W){this.Tvd=A;this.Vy=W}}Object(h.a)(Bd,"SafeLinksGetUrlReputationRequestData",null,[]);class Rc{constructor(A,W,na,Ga){this.Oa=A;this.hi=W;
this.lZh=na;Rc.ii=Ga}sxd(A,W,na){try{var Ga=null;Rc.ii&&(Ga=Rc.ii.Ii("WebServiceCall","SafeLinksGetUrlReputation"));const Ka=new Bd(W,Ga);Ga={};Ga.AffinitizedUrl=A;Ga.TargetUrl=W;Ga.PolicyCookie=na;const qb=C.c(Ga);this.hi.zj(this.lZh,2,qb,null,!1,2,Object(n.a)(this,this.IDk,"onGetUrlReputationSuccessCallback"),Object(n.a)(this,this.HDk,"onGetUrlReputationFailureCallback"),Ka,void 0,void 0,3E3,3E3,"36");return!0}catch(Ka){e.ULS.sendTraceTag(588788033,378,10,Ka.message)}return!1}IDk(A){let W="OnGetUrlReputationSuccessCallback: ",
na=10;const Ga=A.data.state;try{const Ka=C.b(A.data.ee).reputationResults[0],qb=Ka.navigateUrl.length,Qb=Ga.Tvd.length,t=Ka.navigateUrl===Ga.Tvd;Ka.navigateUrl&&0<Ka.navigateUrl.length&&(Ga.Tvd=Ka.navigateUrl);W+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",A.data.Ke,Ka.verdict,Qb.toString(),qb.toString(),t.toString());na=50}catch(Ka){W+=String.format("Exception {0}",Ka.message)}this.Xeg(Ga,W,na)}HDk(A){let W="OnGetUrlReputationFailureCallback: ";
const na=A.data.state;try{W+=String.format("HttpStatus {0}",A.data.Ke)}catch(Ga){W+=String.format("Exception {0}",Ga.message)}this.Xeg(na,W,10)}Xeg(A,W,na){A.Vy&&(A.Vy.stop(),A.Vy=null);e.ULS.sendTraceTag(588788034,378,na,W);mb.a.En(A.Tvd,void 0,"noopener,noreferrer","SafeLinksNav")}}Rc.ii=null;Object(h.a)(Rc,"SafeLinksNavigationHelper",null,[]);var Gf;(function(A){A[A.enabledByPolicy=0]="enabledByPolicy";A[A.disabledByPolicy=1]="disabledByPolicy";A[A.disabled_GetPolicyFailure=2]="disabled_GetPolicyFailure";
A[A.disabled_PendingGetPolicyRequest=3]="disabled_PendingGetPolicyRequest"})(Gf||(Gf={}));Object(h.b)("SafeLinksNavigationState",Gf);var Nf=d(505);class Oa{constructor(A,W,na,Ga=!1,Ka=null,qb=null){this.D4a=this.C4a=0;this.Xac=this.rBc=!1;this.GPa=null;this.gqb=!0;this.jGc=null;e.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");this.Oa=A;this.hi=W;this.k7=na;Oa.ii=qb;this.H$h=Ga?this.Oa.Ha("SafeLinksHandlerWebServiceBase"):this.Oa.Ha("WebServiceBase");this.o$h=this.Oa.Ha("SafeLinksHashedUserId");
this.yVl=this.Oa.Ha("SafeLinksWorkloadIdHeaderValue");this.xDc=this.Oa.wc("SafeLinksMaxGetPolicyBootRetries",2);this.yDc=this.Oa.wc("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.mCc=this.n2j();this.lCc=this.m2j();Oa.rvf=this.Oa.Ha("UserPrincipalName")||"";Oa.nuf=this.Oa.Ha("TenantId")||"";e.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this.mCc,this.lCc);if(this.mCc&&this.lCc){W=(A=this.JTa())?A.IsSafeLinksEnabled.toLowerCase():"";na=this.ape();
e.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",W,na);var Qb=!A||"unknown"===W||A.WasServiceDown||na,t=L.a.aA();t&&(t.set("shouldGetSafeLinksDataFromServer",Qb.toString()),t.set("isSafeLinksEnabledCacheValue",W.toString()));Ka?(this.gqb=!1,Ka.execute(Y=>{Y.isFeatureEnabled("MsoUrlreputation",!0).then(pa=>{this.gqb=pa;t.set("isUserLicensedForSafeLinks",this.gqb.toString());B.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",
t);this.gqb&&Qb&&this.TWc(!0);return null})})):(B.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",t),Qb&&this.TWc(!0))}}get appName(){return this.k7}get szd(){return this.H$h}get userId(){return this.o$h}get Zcg(){try{if(""===Oa.uFd){const A={};A["X-AppName"]=this.appName;A["X-AppVersion"]=M.AFrameworkApplication.buildVersion;A.OS=this.Oa.Ha("PlatformNameAndVersion")||"";const W=JSON.stringify(A);Oa.uFd=window.self.btoa(W)}}catch(A){e.ULS.sendTraceTag(508909765,378,10,"GetUrlReputationAdditionalProperties Error: {0}",
A.message)}return Oa.uFd}get $nj(){const A=this.szd?this.szd+"/":"",W=new da.QueryStringBuilder("SafeLinksHandler.ashx");W.jg("app",this.appName);this.Oa.ka("SafeLinksUseDebugHeader")&&W.jg("action","debug");this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&W.jg("s2satpop","1");this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&W.jg("s2se03","1");return String.format("{0}{1}&{2}",A,W.toString(),M.AFrameworkApplication.gh)}get gwj(){const A=
this.szd?this.szd+"/":"",W=new da.QueryStringBuilder("SafeLinksHandler.ashx");W.jg("app",this.appName);this.Oa.ka("SafeLinksUseDebugHeader")&&W.jg("action","debug");this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&W.jg("s2satpop","1");this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&W.jg("s2saat","1");this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&W.jg("s2se03","1");this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",
!1)&&W.jg("sladpar",this.Zcg);W.jg("slrt","GetUrlReputation");return String.format("{0}{1}&{2}",A,W.toString(),M.AFrameworkApplication.gh)}get wxk(){Oa.JNd||(Oa.JNd=new Rc(this.Oa,this.hi,this.gwj,Oa.ii));return Oa.JNd}sxd(A){if(!A)return e.ULS.sendTraceTag(593367827,378,10,"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),!1;var W=this.$Xj(A);e.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",
W,this.mCc,this.lCc,this.gqb);if(!(W&&this.mCc&&this.lCc&&this.gqb))return!1;W=0;const na=({state:W}=this.tul()).returnValue;e.ULS.sendTraceTag(595079385,378,50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",Gf[W]);const Ga=L.a.aA();Ga&&Ga.set("SafeLinksNavigationState",Gf[W]);B.Health.instance.recordKpiUsage("SafeLinksNavigations",0,"jpittsdirects",Ga);if(!na)return 2!==W&&3!==W||B.Health.instance.recordKpiFailure("SafeLinksNavigations",Gf[W],!1,!0,null),!1;e.ULS.sendTraceTag(26019601,
378,50,"Using safelinks to navigate hyperlink");if(this.Gul())return this.ape()?!1:this.wxk.sxd(this.X$i(),A,this.t$f());if(!this.ape())return this.WKh(A),!0;this.GPa=A;e.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");this.Xac=!1;this.TWc();return!0}$Xj(A){A=A.toLowerCase();const W=this.Oa.eA("SafeLinksUnsupportedProtocols");if(W)for(let na=0;na<W.length;na++)if(A.startsWith(W[na]))return!1;return!0}TWc(A=!1){var W=L.a.aA();W&&W.set("isOnBootRequest",A.toString());
B.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",1,"jpittsdirects",W);B.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",0,"jpittsdirects",W);W=this.r0d("SafeLinksGetPolicy");this.hi.zj(this.$nj,1,null,null,!0,2,Object(n.a)(this,this.sqj,"getSafeLinksDataFromServer_OnSuccessCallback"),Object(n.a)(this,this.rqj,"getSafeLinksDataFromServer_OnFailureCallback"),W,void 0,void 0,void 0,void 0,"23");this.Xac=A;this.rBc=!0;A?this.C4a++:this.D4a++}sqj(A){let W=w.a.xyk,
na="";try{this.rBc=this.Xac=!1;var Ga=A.data.state;const Ya=({Vy:Ga}=this.$ud(Ga)).returnValue,jb=Object.assign(new ka.a,{durationMs:Ya});B.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",jb);e.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",A.data.Ke,A.data.ee.length,Ya);if(A.data.Ke!==w.a.mx)na="Unexpected httpStatus: "+A.data.Ke.toString();else{Ga=null;try{Ga=C.b(A.data.ee)}catch(Sb){na="Exception:"+
Sb.toString()+" deserializing response";return}if(Ga){var Ka=Ga.IsSafeLinksEnabled;if(void 0===Ka||null===Ka||0>=Ka.length)na="Invalid isSafeLinksEnabledString";else{e.ULS.sendTraceTag(594830613,378,50,"Retrieved isSafeLinksEnabledString {0}",Ka);var qb=Oa.mOe(Ka);if(void 0===Ga.WebAffinitizedUrl||null===Ga.WebAffinitizedUrl||0>=Ga.WebAffinitizedUrl.length)na="Invalid WebAffinitizedUrl";else if(void 0===Ga.PolicyCookie||null===Ga.PolicyCookie||0>=Ga.PolicyCookie.length)na="Invalid PolicyCookie";else if(void 0===
Ga.PolicyCookieTTL||null===Ga.PolicyCookieTTL)na="Invalid PolicyCookieTTL";else{var Qb=Ga.WebAffinitizedUrl,t=Ga.PolicyCookie,Y=Ga.AffinitizedUrl,pa=new Date;pa.setMinutes(pa.getMinutes()+(5<Ga.PolicyCookieTTL?Ga.PolicyCookieTTL-5:0));var Ja=new Mf(Ka,Qb,t,pa.getTime(),!1,Y);this.cwh(Ja);W=A.data.Ke;this.GPa&&(qb?(this.WKh(this.GPa),this.D4a=this.C4a=0):(e.ULS.sendTraceTag(26019602,378,50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),B.Health.instance.recordKpiFailure("SafeLinksNavigations",
"disabledByPolicy",!0,!0,null),mb.a.jTc(this.GPa)),this.GPa=null)}}}else na="Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch(Ya){na="GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+Ya.toString()}finally{W!==w.a.mx&&this.Weg(W,na)}}rqj(A){this.rBc=!1;let W=500,na="";try{let Ga=A.data.state;const Ka=({Vy:Ga}=this.$ud(Ga)).returnValue,qb=Object.assign(new ka.a,{durationMs:Ka});W=A.data.Ke;B.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest",
"HttpStatusCode_"+W.toString(),!1,!0,qb);na="Request Failed, Status="+Nf.a[A.data.status]+" Duration: "+Ka}catch(Ga){na="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+Ga.toString()}finally{this.Weg(W,na)}}Weg(A,W=""){try{if(e.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",A,W),this.C4a<this.xDc&&this.D4a<this.yDc)this.TWc(this.Xac);else{this.Xac=!1;e.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",
this.C4a,this.D4a,A,W);W=null;const na=L.a.aA();na&&(na.set("HttpStatus",A.toString()),W=Object.assign(new ka.a,{extendedProperties:na}));B.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,W);const Ga=new Mf("false","","",0,!0,"");this.cwh(Ga);this.GPa&&(e.ULS.sendTraceTag(26019603,378,50,"Error occurred during at-click GetPolicy call, NavigationState = {0}","disabled_GetPolicyFailure"),B.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",
!1,!0,null),mb.a.jTc(this.GPa),this.GPa=null)}}catch(na){e.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",na.toString())}}WKh(A){const W=this.t$f(),na=this.$wj(),Ga={};Ga.Url=A;Ga.SafeLinksCookie=W;Ga.CorrelationId=aa.a.create().toString();Ga.WorkloadId=this.yVl;Ga.UserAgentInfo=Z.a.iz+"|"+this.appName;this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",!1)&&(Ga.User=Oa.rvf,Ga.TenantId=Oa.nuf,Ga.AdditionalProperties=this.Zcg);e.ULS.sendTraceTag(23900187,
378,50,"Validating hyperlink with request correlation: {0}",Ga.CorrelationId);mb.a.Rld(mb.a.Iba(4),na,Ga)}n2j(){const A=this.Oa.Ha("IsSafeLinksEnabledForUser");return A?Oa.mOe(A):!1}m2j(){const A=this.Oa.eA("SafeLinksDisabledBrowsers");if(Z.a.$T){if(this.Oa.Lu("SafeLinksForTeamsIsEnabled")&&this.Oa.ka("SafeLinksForTeamsIsEnabled"))return!0;if(Array.contains(A,"Electron"))return!1}else if(Array.contains(A,Z.a.iz))return!1;return"officecomhwa"===(this.Oa.Ha(M.AFrameworkApplication.wK)||"").toLowerCase()?
!1:!0}Gul(){return-1!==window.location.href.indexOf("&wd_slnh=1")||this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksUseNavigationHelperForMobile",!1)&&Z.a.pbc?!0:Z.a.$T}tul(){let A;A=0;const W=this.JTa(),na=W?W.IsSafeLinksEnabled:"";if(""!==na)return W.WasServiceDown?(e.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),{returnValue:!1,state:2}):"false"===na.toLowerCase()?(e.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),{returnValue:!1,state:1}):
{returnValue:Oa.mOe(na),state:A};if(this.rBc)return A=3,e.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:A};if(this.C4a>=this.xDc||this.D4a>=this.yDc)return A=2,e.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",this.C4a,this.xDc,this.D4a,this.yDc),{returnValue:!1,state:A};e.ULS.sendTraceTag(23900182,378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",
this.xDc+this.yDc-(this.C4a+this.D4a));return{returnValue:!0,state:A}}t$f(){const A=this.JTa();return A?A.PolicyCookie:""}$wj(){const A=this.JTa();return A?A.WebAffinitizedUrl:""}X$i(){const A=this.JTa();return A?A.AffinitizedUrl:""}Rgj(){const A=new Date;try{const W=this.JTa();A.setTime(W?W.PolicyCookieTTL:0)}catch(W){e.ULS.sendTraceTag(24462658,378,10,"Exception occured while fetching expiration time from cache: {0}",W)}return A}ape(){const A=this.Rgj();return!!A&&A.getTime()<Date.now()}JTa(){if(!this.jGc){const A=
va.a.instance.getItem(this.userId);if(!A||""===A)return null;this.jGc=JSON.parse(A)}return this.jGc}cwh(A){if(void 0===A||null===A)throw Error.argumentNull("safeLinksData");if(void 0===A.IsSafeLinksEnabled||null===A.IsSafeLinksEnabled||0>=A.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");this.jGc=A;A.WasServiceDown||this.FVl(A)}FVl(A){A=JSON.stringify(A);va.a.instance.setItem(this.userId,A)}r0d(A){return void 0!==Oa.ii&&null!==Oa.ii?Oa.ii.Ii("WebServiceCall",
A):null}$ud(A){if(void 0!==A&&null!==A){const W=A.dr;A.stop();return{returnValue:W,Vy:null}}return{returnValue:null,Vy:A}}static mOe(A){return"false"!==A.toLowerCase()?!0:!1}}Oa.ii=null;Oa.JNd=null;Oa.nuf="";Oa.rvf="";Oa.uFd="";Object(h.a)(Oa,"SafeLinksManager",null,[595]);const cb=A=>{switch(A){case 3:return"Word";case 2:return"PowerPoint";case 1:return"Excel";default:return"Unknown"}},Ic=A=>{switch(A){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";default:return"Unknown"}};var qd=
d(215);class le{constructor(){this.K=null}get name(){return"PowerPointSafeLinks"}Yb(A){this.K=A}init(){M.AFrameworkApplication.fa.ff(Object(n.a)(this,this.en,"onFullAppSettingsReady"))}en(){const A=this.K.resolve("PowerPointWebEditor.IApplicationSettings"),W=A?A.yg:!1;A.pptSafeLinksIsEnabled&&(this.K.register(Oa,"Common.App.SafeLinks.SafeLinksManager").as("Common.App.SafeLinks.ISafeLinksManager").ma().oa(()=>new Oa(M.AFrameworkApplication.fa,M.AFrameworkApplication.Me,String.format("{0}-{1}",cb(M.AFrameworkApplication.Aa.ob.zk),
Ic(M.AFrameworkApplication.Aa.ob.LJa)),W)).ma(),this.K.qb("Common.App.SafeLinks.ISafeLinksManager"))}dispose(){}static main(){Ia.a.instance.Ac(qd.a(new le,0))}}Object(h.a)(le,"SafeLinksPackage",null,[2,3]);var yb=d(353),ef=d(285),Cb=d(1249),oc=d(87),vc=d(29),nd=d(177),id=d(93),Nd=d(1068);class Ce{constructor(A,W,na,Ga,Ka,qb){this.NG=A;this._id=W;this.LDd=Ga;this.sXh=Ka;this.tXh=qb;this.fAc=this.Nvb;void 0!==na&&null!==na&&(this.Nvb=na)}get defaultValue(){return this.fAc}get lcid(){return this.NG}get id(){return this._id}get Nvb(){return(this.sXh||
Ce.hff)(this.LDd)}set Nvb(A){(this.tXh||Ce.iff)(this.LDd,A)}get Yf(){return this.LDd}static zr(){Ce.hff=()=>null;Ce.iff=()=>{}}}Ce.hff=null;Ce.iff=null;Object(h.a)(Ce,"GrammarSettingOption",null,[742]);Ce.zr();class af{constructor(A,W,na){this.M7d=A;this.vYe=W;this.Oxk=na}}Object(h.a)(af,"TwoLevelCacheKey",null,[]);var de=d(35),$f=d(219),ge=d(3);class ze extends xb.a{constructor(A,W,na,Ga){super();this.dNd=this.c8=this.Ugf=this.jTb=null;this.Uo=Ga;this.UCd=A;this.kg=ze.id;this.x3h=()=>{this.jTb=na?
fa.a.otc(na):{};this.Ugf=na?fa.a.otc(na):{};const Ka=this.eri(),qb=ze.vKi(Ka,ze.Ird(Object(n.a)(this,this.uKi,"createCritiqueTypeSettingsTracker"))(ze.ZDi(t=>this.jTb=t)));qb(na||{});var Qb=ze.Ird(ze.zPi())(t=>t.cloneNode(!0));ze.wKi(Ka,ze.UJi(ze.PNi(W),ze.tKi(Qb))(na))(A.toString());this.dNd=this.Ksi();Qb=t=>{if("click"===t.type||t.keyCode===nd.a.Dp||t.keyCode===nd.a.sRb)this.jTb[A.toString()]={},Ka.reset(),ze.Dal(qb)};id.a.addHandler(this.J0a,Wb.a.click,Qb);id.a.addHandler(this.J0a,Wb.a.Bf,Qb)};
this.sg=""}get J0a(){return this.dNd}u5j(){var A=ze.VUe(this.jTb),W=ze.VUe(this.Ugf);if(!A&&!W)return!1;let na;try{na=A?Object(z.a)(Object,A[this.UCd.toString()]):{};var Ga=W?Object(z.a)(Object,W[this.UCd.toString()]):{}}catch(Qb){return e.ULS.sendTraceTag(36489288,375,15,"Parse to dictionary failed"),!1}if(!na&&!Ga)return!1;na=na?na:{};Ga=Ga?Ga:{};A=String.format("language: {0}",this.UCd.toString());W=!1;for(let Qb in na){var Ka=Qb,qb=na[Qb];Ka in Ga&&Ga[Ka]===qb||(W=!0,A=String.format("{0}, [{1}, {2}]",
A,Ka,qb))}for(let Qb in Ga)Ga=Qb,Ga in na||(W=!0,A=String.format("{0}, [{1}, default]",A,Ga));W&&e.ULS.sendTraceTag(37319685,375,50,"User changed settings: {0}",A);return W}pj(A,W,na){super.pj(A,W,na);this.d0k()}SN(A){return A.Bc.id===ze.drh?!1:super.SN(A)}xgl(){this.Uo.Ll().Egd();this.c8=this.Uo.Ll().Dj.q_}d0k(){this.Uo.Ll().scope.Bp(mc.FocusManager.instance().Bra);this.Uo.Ll().scope.Bp(mc.FocusManager.instance().Cra);this.Uo.Ll().scope.bindAction(mc.FocusManager.instance().Bra,de.a.h9b);this.Uo.Ll().scope.bindAction(mc.FocusManager.instance().Cra,
de.a.g9b);this.Uo.Ll().scope.bindAction(wc.KeyInputManager.Qa(nd.a.Eba,0),de.a.aYc);this.Uo.Ll().scope.bindAction(wc.KeyInputManager.Qa(nd.a.rha,0),de.a.$Xc);this.Uo.Ll().scope.bindAction(wc.KeyInputManager.Qa(nd.a.nZ,0),de.a.aYc);this.Uo.Ll().scope.bindAction(wc.KeyInputManager.Qa(nd.a.f7,0),de.a.$Xc)}get settings(){return ze.VUe(this.jTb)}Jxa(){super.Jxa();this.x3h()}eri(){const A=ze.Cri(),W=ze.N0b("WACDialogRow",A);this.cQ.insertBefore(W,this.cQ.firstChild);return A}uKi(A){const W=Nd.a.merge(null,
A);return na=>{na.Nvb===(A&&A[na.lcid]?A[na.lcid][na.id]:null)||na.Nvb!==na.defaultValue?ze.U9f(W,na.lcid)[na.id]=na.Nvb:delete ze.U9f(W,na.lcid)[na.id];this.c8=this.Ahj(na.Yf);return W}}Ahj(A){return A?(A=A.getElementsByTagName(Sys.UI.DomElement.containsCssClass(A,ze.r7j)?"select":"input"))?A[0]:null:null}dispose(){this.J0a&&(id.a.pnh(this.J0a),this.dNd=null);super.dispose()}Ksi(){const A=document.createElement("input");A.id=ze.drh;A.type="reset";A.setAttribute("form",ze.i2f);A.className="WACButton WACDialogButtonNormal GrammarSettingsDialogResetButton";
A.value=CommonUIStrings.l_ResetAll;const W=ze.N0b("GrammarSettingsDialogResetButtonContainer",A),na=document.getElementById("WACDialogButtonPanel");na.parentNode.insertBefore(W,na);return A}static get F3b(){return"CritiqueType"}static ZDi(A){return W=>na=>A(W(na))}static Ird(A){return W=>na=>W(A(na))}static VUe(A){const W={};fa.a.forEach(A,(na,Ga)=>{0<$f.a(Ga).length&&(W[na]=Ga)},null);return W}static Cri(){const A=document.createElement("form");A.id=ze.i2f;Sys.UI.DomElement.addCssClass(A,"WACDialogList");
Sys.UI.DomElement.addCssClass(A,ze.VPi);return A}static vKi(A,W){const na=ze.k_k(A,Wb.a.change);return Ga=>{const Ka=W(Ga);na(qb=>{qb=qb.target.parentNode;Sys.UI.DomElement.containsCssClass(qb,ze.F3b)&&Ka(qb[ze.ADf])})}}static k_k(A,W){let na=null;return Ga=>{na&&id.a.removeHandler(A,W,na);id.a.addHandler(A,W,Ga);na=Ga}}static U9f(A,W){return A[W]=A[W]||{}}static Dal(A){e.ULS.sendTraceTag(36489289,375,50,"User click reset all button");A(null)}static PNi(A){let W=null;return na=>{W=na;return A.request(Number.parseInvariant(na)).CWRCo(Ga=>
W===na?Ga.result:null,ze.v2d)}}static wKi(A,W){const na=ze.Paj(Ga=>ze.sGl(Ga.children));return Ga=>{const Ka=na(Ga,A);A.innerHTML="";(Ka?ge.Task.qt(Ka):W(Ga)).continueWith(qb=>{qb=qb.result;for(let Qb=0;Qb<qb.length;Qb++)A.appendChild(qb[Qb])},ze.v2d)}}static UJi(A,W){return na=>Ga=>A(Ga).CWRCo(Ka=>Wa.toArray(Wa.select(Wa.asEnumerable(Ka.result),qb=>W(na,qb,Ga))),ze.v2d)}static sGl(A){const W=[];for(let na=0;na<A.length;na++)W.push(A[na]);return W}static Paj(A){const W={};let na=null;return(Ga,Ka)=>
{na&&!W[na]&&(Ka=A(Ka))&&(W[na]=Ka);na=Ga;return W[Ga]}}static zPi(){const A={};return W=>{A[W.M7d]=A[W.M7d]||{};const na=A[W.M7d];na[W.vYe]=na[W.vYe]||W.Oxk();return na[W.vYe]}}static tKi(A){return(W,na,Ga)=>{const Ka=A(new af(Ga,na.Id,()=>ze.mri(na)));Ka.setAttribute("role","group");const qb=ze.OIf+na.Name;Ka.setAttribute("aria-labelledby",qb);for(const Qb of na.CritiqueTypeInfoList){const t=ze.t9i(Ga,Qb,W,A);Ka.appendChild(t);t.setAttribute("aria-labelledby",qb)}return Ka}}static t9i(A,W,na,Ga){Ga=
Ga(new af(A,W.Id,()=>W.IsBinaryCritiqueType?ze.kri(W):ze.usi(W)));A=new Ce(A,W.Id,na&&na[A]?na[A][W.Id]:null,Ga,W.IsBinaryCritiqueType?Ka=>Ka.children[0].checked:Ka=>Ka.children[1].selectedIndex,W.IsBinaryCritiqueType?(Ka,qb)=>{Ka.children[0].checked=qb}:(Ka,qb)=>{Ka.children[1].selectedIndex=qb});Ga[ze.ADf]=A;return Ga}static mri(A){A=ze.nri(A.Name);A.className="WACWritingStylesDialogCategoryTitle";return ze.N0b("CritiqueCategory",A)}static kri(A){const W=ze.ori();W.id=A.Id;0<A.DefaultCritiqueValue&&
W.setAttribute("checked","checked");A=ze.wFf(A.Name,A.Id);A.className="WACDialogLabel";const na=ze.N0b(ze.F3b,W,A);na.appendChild(W);na.appendChild(A);return na}static usi(A){A=ze.esi(A.Id,A.Name,ze.zsi(A.CritiqueTypeValues,A.DefaultCritiqueValue),A.DefaultCritiqueValue);Sys.UI.DomElement.addCssClass(A,ze.F3b);return A}static zsi(A,W){return Wa.toArray(Wa.Si(Wa.asEnumerable(A||[]),(na,Ga)=>{na=ze.ysi(na,Ga.toString());Ga===W&&na.setAttribute("selected","selected");return na}))}static esi(A,W,na,Ga){W=
ze.wFf(W,A);const Ka=document.createElement("select");Ka.id=A;Ka.className="WACDialogList";na=na||[];for(A=0;A<na.length;A++)Ka.appendChild(na[A]),Ga===A&&(na[A].selected=!0);return ze.N0b("GrammarSettingsDialogLabeledInlineList",W,Ka)}static ysi(A,W){const na=document.createElement("option");na.text=A;na.value=W;return na}static ori(){const A=document.createElement("input");A.type="checkbox";A.className="WACDialogCheckBox";return A}static wFf(A,W){const na=document.createElement("label");na.innerText=
A;na.setAttribute("for",W);return na}static nri(A){const W=document.createElement("div");W.innerText=A;W.id=ze.OIf+A;return W}static N0b(A=null,...W){const na=document.createElement("div");na.className=A;for(const Ga of W)na.appendChild(Ga);return na}}ze.id="GrammarSettingsDialog";ze.i2f="CritiqueTypeSettings";ze.VPi="CritiquesList";ze.r7j="GrammarSettingsDialogLabeledInlineList";ze.drh="ResetButton";ze.OIf="WritingStylesCategory_";ze.v2d=11;ze.ADf="CritiqueType";Object(h.a)(ze,"GrammarSettingsDialog",
xb.a,[]);var si=d(141),sh=d(319),dd=d(1159),Lc=d(40),Zd=d(355),Ne=d(63),Xc=d(154),lf=d(48),Kh=d(908),bd=d(28),fd=d(30);class Ve{constructor(){this.Color=null;this.Transparency=this.Scale=this.EffectDataPropType=this.Degree=0}}Object(h.a)(Ve,"EffectDataInfo",null,[]);var rf=d(870);class Ag{constructor(){this.EffectType=this.EffectId=0;this.FRemoveExisting=!1;this.ShapeIds=null}}Object(h.a)(Ag,"AddAnimationInfo",null,[]);class ne{constructor(){this.TargetEffects=null}}Object(h.a)(ne,"DeleteAnimationInfo",
null,[]);class kf{constructor(){this.EffectNodeId=0;this.ShapeId=null}}Object(h.a)(kf,"TargetEffect",null,[]);class kg{constructor(){this.EffectType=this.EffectId=0;this.IsReplaceShapeAnimations=!1;this.TargetEffects=null}}Object(h.a)(kg,"ReplaceAnimationInfo",null,[]);class Af{constructor(){this.Duration=this.Direction=this.Delay=0;this.EffectData=null;this.ModifyAnimPropType=0;this.TargetEffects=null}}Object(h.a)(Af,"ModifyAnimationInfo",null,[]);class Wf{constructor(){this.StartType=0;this.TargetEffects=
null}}Object(h.a)(Wf,"ChangeAnimationRelationshipInfo",null,[]);var vf=d(317),De=d(150),Ee=d(90);class Jd{constructor(){this.BuildType=0;this.TargetEffects=null}}Object(h.a)(Jd,"ChangeAnimationBuildTypeInfo",null,[]);class Og{constructor(){this.IsLater=!1;this.TargetEffects=this.RefEffect=null}}Object(h.a)(Og,"ReorderAnimationEffectsInfo",null,[]);var Rg=d(33),Eg=d(39),xf=d(43),hd=d(112);const yf=(fd.a.Ww&65535^fd.a.Ww>>>16)<<16;class cd{constructor(A,W,na,Ga,Ka,qb,Qb,t,Y,pa,Ja,Ya,jb,Sb,kc){this.G6=
"Existing";this.lMa="ExistingInMenu";this.j3e="AnimationExisting";this.k3e="AnimationExistingInMenu";this.nfa=!1;this.H_a=(db,Kb,lc,Jc,Vc)=>{db=this.wk.Dy;Kb=this.pa.hk();if(!Kb||!db||!db.length)return 8;if(1===lc)return 32;lc=this.Vka(db,Kb);Vc.MenuItems=this.gri(db,Kb,lc);return 32};this.Goa=(db,Kb,lc,Jc,Vc)=>{db=Vc.queryResult;Vc=Vc.SourceControlId;Jc=Kb=-1;Vc!==this.G6&&({effectType:Jc,effectId:Kb}=this.vk.eVc(Vc));var vd=this.wk.Dy;if(!this.pa.hk())return 8;if(1!==lc)return 32;lc=this.vk.fVc(Vc);
var me=lc.label;if(Vc===this.G6||Vc===this.lMa)me=ResourceStrings.L_ExistingButtonDescription;this.z$a(Vc,lc.image,lc.label,db,me);let mf=me=!1;const cf=0==vd.length?0:vd[0].EffectId,Bh=0==vd.length?0:vd[0].EffectType,Fh=!this.vk.OAb(vd);vd=this.vk.Mac(vd);Fh||vd||(me=Kb===cf&&Jc===Bh,mf=this.vk.V0c(Bh,cf));Vc===this.G6?(mf=this.QVk(this.G6,db,vd,mf,Fh,lc.image,Bh,cf),db.kV(Fh||vd||mf)):Vc===this.lMa?(mf=cd.OVk(db,vd,Fh,mf),db.kV(Fh||vd||mf)):db.kV(me);return 32};this.Ww=(db,Kb,lc,Jc,Vc)=>{Kb=this.wk.Dy;
var vd=this.pa.hk();let me=!0;var mf=this.getSelectedShapes();if(!mf||!mf.length)if(me=!1,mf=this.Vka(Kb,vd),!mf||!mf.length)return bd.a.J(509677843,800,10,"AnimationActor::setAnimation: selected shapes info is null"),8;if(!cd.Hrg(vd,mf)||this.eva(mf))return 8;if(1===lc)return Jc=0<Kb.length&&!this.vk.OAb(Kb),vd=cd.G2j(mf),Jc&&vd?8:db===fd.a.tNb||db===fd.a.n1a?(mf=0<Kb.length&&this.vk.Mac(Kb),vd=!1,Jc||mf||(vd=this.vk.V0c(0<Kb.length?Kb[0].EffectType:-1,0<Kb.length?Kb[0].EffectId:-1)),db===fd.a.n1a&&
(vd=Jc?!0:!1),Jc||mf||vd?32:16):db===fd.a.sNb?cd.H2j(mf)?32:16:32;db=Vc.SourceControlId;if(!db)return 8;if(db===this.G6||db===this.lMa||db===this.j3e||db===this.k3e)return 32;db=this.vk.eVc(db);(Kb=cd.uaj(mf,db.effectId,db.effectType,me,Kb))&&this.x_(vd,Kb,!0);Jc&&(Jc.QC=db.effectId,Jc.RN=db.effectType+100);return 32};this.A4g=(db,Kb,lc)=>{const Jc=this.wk.Dy;Kb=this.pa.hk();if(!Kb||!Jc||!Jc.length)return 8;var Vc=this.Vka(Jc,Kb);if(!Vc||!Vc.length)return bd.a.J(509670021,800,10,"AnimationActor::moveAnimationHandler: selected shapes info is null"),
8;if(this.eva(Vc))return 8;switch(db){case fd.a.Cgd:db=!1;break;case fd.a.Dgd:db=!0;break;default:return 8}Vc=this.vk.Jlj(Kb,Jc,db);if(1===lc)return Vc.isEnabled?32:8;if(!Vc.sod)return bd.a.J(509670020,800,10,"AnimationActor::moveAnimationHandler: move animation info ref target is null"),8;lc=cd.h9(Jc);lc=cd.TPf(lc,Vc.sod,db);this.x_(Kb,lc,!0);return 32};this.bza=(db,Kb,lc,Jc,Vc)=>{Kb=this.wk.Dy;db=this.pa.hk();if(!db||!Kb||!Kb.length)return 8;var vd=this.Vka(Kb,db);if(!vd||!vd.length)return bd.a.J(509677842,
800,10,"AnimationActor::setAnimationColor: selected shapes info is null"),8;if(this.eva(vd))return 8;if(1===lc)return 32;lc=De.Box4ColorHelper.pS(Vc);if(!lc)return bd.a.J(509677841,800,10,"AnimationActor::setAnimationColor:  solid is null"),8;lc=De.Box4ColorHelper.rkb(lc,db.Ed);if(!lc)return bd.a.J(509677840,800,10,"AnimationActor::setAnimationColor:  color is null"),8;Vc=new rf.a;Vc.AnimationAction=1;vd=new Af;vd.TargetEffects=cd.h9(Kb);vd.ModifyAnimPropType=3;Kb=new Ve;Kb.Color=[lc.r,lc.g,lc.b];
Kb.EffectDataPropType=1;vd.EffectData=Kb;Vc.ModifyAnimationInfo=vd;this.x_(db,Vc,!0);Jc&&(Jc.RN=1);return 32};this.JRe=()=>{const db=this.wk.Dy;var Kb=this.pa.hk();if(!Kb||!db||!db.length)return 8;Kb=this.Vka(db,Kb);return Kb&&Kb.length?this.vk.Fwi(Kb,this.Ga,db)?32:16:(bd.a.J(509677839,800,10,"AnimationActor::queryEffectOptions: selected shapes info is null"),8)};this.l1a=(db,Kb,lc,Jc,Vc)=>{db=this.wk.Dy;Kb=this.pa.hk();if(!Kb||!db||!db.length)return 8;var vd=this.Vka(db,Kb);if(!vd||!vd.length)return bd.a.J(509677838,
800,10,"AnimationActor::setAnimationDirection: selected shapes info is null"),8;if(this.eva(vd))return 8;if(1===lc)return 32;lc=this.vk.s7b(Vc.MenuItemId);Vc=new rf.a;Vc.AnimationAction=1;vd=new Af;vd.TargetEffects=cd.h9(db);vd.ModifyAnimPropType=2;vd.Direction=lc;Vc.ModifyAnimationInfo=vd;this.x_(Kb,Vc,!0);Jc&&(Jc.RN=1);return 32};this.Z_a=(db,Kb,lc,Jc,Vc)=>{db=this.wk.Dy;if(!this.pa.hk()||!db||!db.length)return 8;Kb=Vc.queryResult;Vc=this.vk.s7b(Vc.MenuItemId);cd.xSj(db)&&Kb.Hf(db[0].Direction===
Vc);return 32};this.DLa=(db,Kb,lc,Jc,Vc)=>{db=this.wk.Dy;Kb=this.pa.hk();if(!Kb||!db||!db.length)return 8;var vd=this.Vka(db,Kb);if(!vd||!vd.length)return bd.a.J(509677652,800,10,"AnimationActor::setAnimationSequence: selected shapes info is null"),8;if(this.eva(vd))return 8;if(1===lc)return 32;lc=Vc.MenuItemId;Vc=new rf.a;Vc.AnimationAction=5;vd=new Jd;vd.TargetEffects=cd.h9(db);vd.BuildType=cd.ybj(lc);Vc.ChangeAnimationBuildTypeInfo=vd;this.x_(Kb,Vc,!0);Jc&&(Jc.RN=1);return 32};this.Hoa=(db,Kb,
lc,Jc,Vc)=>{db=this.wk.Dy;if(!this.pa.hk()||!db||!db.length)return 8;Kb=Vc.queryResult;Vc=this.vk.Gce(Vc.MenuItemId);cd.vSj(db)&&Kb.Hf(db[0].BuildType===Vc);return 32};this.m1a=(db,Kb,lc,Jc,Vc)=>{Kb=this.wk.Dy;db=this.pa.hk();if(!db||!Kb||!Kb.length)return 8;var vd=this.Vka(Kb,db);if(!vd||!vd.length)return bd.a.J(509677837,800,10,"AnimationActor::setAnimationEffectData: selected shapes info is null"),8;if(this.eva(vd))return 8;if(1===lc)return 32;vd=Vc.MenuItemId;lc=new rf.a;lc.AnimationAction=1;
Vc=new Af;Vc.TargetEffects=cd.h9(Kb);Vc.ModifyAnimPropType=3;Kb=this.jgj(vd);if(!Kb)return bd.a.J(509703439,800,15,"AnimationActor::setAnimationEffectData:  effect data info is null"),16;Vc.EffectData=Kb;lc.ModifyAnimationInfo=Vc;this.x_(db,lc,!0);Jc&&(Jc.RN=1);return 32};this.$_a=(db,Kb,lc,Jc,Vc)=>{db=this.wk.Dy;if(!this.pa.hk()||!db||!db.length)return 8;Vc.queryResult.Hf(this.vk.oMf(cd.kgj(db[0].EffectData),Vc.MenuItemId));return 32};this.ajl=(db,Kb,lc,Jc,Vc)=>{Kb=this.wk.Dy;db=this.pa.hk();if(!db||
!Kb||!Kb.length)return 8;Jc=this.Vka(Kb,db);if(!Jc||!Jc.length)return bd.a.J(509677836,800,10,"AnimationActor::setAnimationStartHandler: selected shape info is null"),8;if(this.eva(Jc))return 8;if(1===lc)return 32;lc=Vc.CommandValueId;if(!lc||!lc.trim().length)return bd.a.J(509703438,800,10,"AnimationActor::setAnimationStartHandler:  startoption value is null or empty"),16;lc=cd.gtj(lc);if(3==lc)return bd.a.J(509703437,800,15,"AnimationActor::setAnimationStartHandler:  startoption value is invalid"),
16;for(var vd of Kb)vd.StartType=lc;vd=cd.h9(Kb);vd=cd.BOf(vd,lc);this.x_(db,vd,!1);return 32};this.OKb=(db,Kb,lc,Jc,Vc)=>{db=this.wk.Dy;if(!this.pa.hk()||!db||!db.length)return cd.tZe(Vc,3),32;Kb=db[0].StartType;lc=!0;for(const vd of db)if(Kb!=vd.StartType){lc=!1;break}lc?cd.tZe(Vc,Kb):cd.tZe(Vc,3);return 32};this.$il=(db,Kb,lc,Jc,Vc)=>{db=this.pa.hk();Kb=this.wk.Dy;if(!db||!Kb||!Kb.length)return 8;Jc=this.Vka(Kb,db);if(!Jc||!Jc.length)return bd.a.J(509677835,800,10,"AnimationActor::setAnimationDurationHandler: selected shape info is null"),
8;if(this.eva(Jc))return 8;const vd=!this.vk.OAb(Kb);if(cd.Grg(Jc)&&vd)return 8;if(1===lc)return 32;(lc=Math.floor(1E3*Vc.Number))||(lc=10);for(var me of Kb)me.Duration=lc;me=cd.h9(Kb);me=cd.oOc(me,1,lc);this.x_(db,me,!1);return 32};this.KKa=(db,Kb,lc,Jc,Vc)=>{db=this.wk.Dy;if(!this.pa.hk()||!db||!db.length)return this.uNb(Vc,"0.00"),32;Kb=db[0].Duration;lc=!0;for(const vd of db)if(Kb!=vd.Duration){lc=!1;break}lc?this.uNb(Vc,Number(Kb/1E3).toFixed(2)):this.uNb(Vc,"0.01");return 32};this.vFj=(db,Kb,
lc)=>1==lc?32:Xc.b("AnimationPaneActor::ShowHideAnimationPane PaneOpen:",this.nfa.toString(),db,()=>{(this.nfa=!this.nfa)?this.Wtc(!1):this.phg();return 32});this.rpc=(db,Kb,lc,Jc,Vc)=>{Vc&&Vc.Hf(this.nfa);return 32};this.Wtc=db=>{const Kb=this.fA();var lc=Object(n.a)(this,this.azj,"applyAnimationAction");Kb.onAnimationAction=lc;lc=Object(n.a)(this,this.czj,"handleAnimationSelectionChangeFromPane");Kb.onSelectionChange=lc;lc=this.getSelectedShapes();Kb.isAddAnimationButtonDisabled=!lc||!lc.length;
if(lc=this.pa.hk()){Kb.isZeroStateAnimationPane=!lc.qFa;var Jc=lc.Uj();Jc=lc.cUc(Jc).sort((vd,me)=>vd.EffectNodeId-me.EffectNodeId);Kb.animations=this.vk.Sgj(Jc);Kb.selectedAnimationNodeIds=this.wk.Dy.map(vd=>vd.EffectNodeId);Kb.sequencesInfo=this.vk.grj(lc);var Vc={title:ResourceStrings.L_AnimationGalleryGroup,hideHeader:!1,width:Kb.paneWidth,location:2,contentProps:Kb,onOpen:()=>{},onClose:()=>{this.nfa=!1},isModernPane:!0};si.UISurfaces.Gq().then(vd=>{db?this.nfa&&vd.updateTaskPane(lf.a.TQa,Vc):
vd.showTaskPane(lf.a.TQa,Vc);return null}).catch(vd=>{bd.a.J(512500804,800,10,"AnimationActor::showAnimationPane exception: {0}",vd.toString())})}else bd.a.J(509642376,800,10,"AnimationActor::showAnimationPane: selected slide is null")};this.onSelectionChange=()=>{if(this.wk&&this.wk.sO){var db=this.wk.Iw;db?(db=db.Uj())&&db.length&&(this.wk.GOh(),this.nfa&&this.wk.qhc&&this.Wtc(!0)):bd.a.J(509145116,800,10,"AnimationActor::onSelectionChange: current active slide is null")}};this.onActiveSlideDomReady=
(db,Kb)=>{Kb&&this.wk&&((db=this.wk.Iw)?(Kb=Object(z.a)(118,Kb.Ba))&&db.Db!==Kb.Db&&(this.wk.eQl(Kb),this.nfa&&this.Wtc(!0)):bd.a.J(509145115,800,10,"AnimationActor::onActiveSlideDomReady: current active slide is null"))};this.Rxa=(db,Kb)=>{const lc=this.ta.Ba;lc&&lc.nO&&(db=this.wk.Iw)&&lc===db&&(Kb=Kb.$w)&&Kb.shapeNode&&this.vGa(db.Db,Kb.shapeNode)&&this.wk.ZKa(this.wk.sO)};this.iga=(db,Kb)=>{Kb&&this.wk&&(this.wk.dQl(Kb.Xfa),this.nfa&&(this.wk.sO||this.phg()))};this.$g=(db,Kb)=>{Kb&&Kb.property===
Eg.a.hUd&&this.wk&&this.wk.sO&&((db=this.wk.Iw,db)?this.jc.mg(Kb.node)===db&&(this.wk.fOb(!1),this.wk.cQl(),this.wk.fOb(!0),this.nfa&&this.Wtc(!0)):bd.a.J(509145114,800,10,"AnimationActor::onPropertyChanged: current active slide is null"))};this.azj=db=>{switch(db.actionType){case 0:this.Myj();break;case 2:this.LEj(db);break;case 1:this.uAj(db);break;case 3:this.vCj(db);break;case 4:this.Rzj(db);break;case 5:break;case 6:this.KEj(db);break;default:bd.a.J(509642375,800,10,"AnimationActor::applyAnimationActionFromPane: invalid animation action type")}};
this.czj=db=>{const Kb=this.pa.hk();Kb&&db?(this.wk.fOb(!1),this.wk.bka(),this.wk.DSd(db,Kb),this.wk.fOb(!0)):bd.a.J(509620888,800,10,"AnimationActor::handleAnimationSelectionChangeFromPane: slide or animation ids info is null")};this.Gse=(db,Kb,lc)=>{db=[Object.assign(new hd.a,{name:"CustomData1",int64:yf+db}),Object.assign(new hd.a,{name:"CustomData2",int64:yf+Kb+100})];Ud.d(fd.a.Ww,!0,void 0,0,30,lc,db)};this.Myj=()=>{var db=Date.now(),Kb=this.getSelectedShapes();const lc=this.pa.hk();if(lc&&Kb&&
Kb.length){if(Kb=cd.E3f(Kb,10,0,!1))this.x_(lc,Kb,!0),this.yEb&&(db=Date.now()-db,this.Gse(10,0,db))}else bd.a.J(509642374,800,10,"AnimationActor::applyAddAnimationFromPane: slide or shapes info is null")};this.LEj=db=>{var Kb=Date.now();if(db&&db.replaceAnimationInfo){var lc=db.replaceAnimationInfo.effectId;db=db.replaceAnimationInfo.effectType;var Jc=this.wk.Dy,Vc=this.pa.hk();if(Vc&&Jc&&Jc.length){if(Jc=cd.aag(Jc,lc,db))this.x_(Vc,Jc,!0),this.yEb&&(Kb=Date.now()-Kb,this.Gse(lc,db,Kb))}else bd.a.J(509642372,
800,10,"AnimationActor::applyReplaceAnimation: slide or animation info is null")}else bd.a.J(509642373,800,10,"AnimationActor::applyReplaceAnimation: replace animation info is null")};this.uAj=db=>{var Kb=Date.now();if(db&&db.deleteAnimationInfo){var lc=this.pa.hk();db=db.deleteAnimationInfo.animationIds;lc&&db&&db.length?(db=cd.yuj(db),db=cd.NOf(db),this.x_(lc,db,!0),this.yEb&&(Kb=Date.now()-Kb,this.Gse(0,0,Kb))):bd.a.J(509616839,800,10,"AnimationActor::handleDeleteAnimation: slide or deleteAnimationIds is null/empty")}else bd.a.J(509616840,
800,10,"AnimationActor::handleDeleteAnimation: delete animation info is null")};this.fA=()=>({type:"AnimationPaneProps",paneWidth:Kh.a,isPreviewAnimationButtonDisabled:!0});this.WMl=()=>{if(this.nfa)return this.Wtc(!0),32};this.phg=()=>{si.UISurfaces.Gq().then(db=>{db.hideTaskPane(lf.a.TQa,2);return null}).catch(db=>{bd.a.J(512500803,833,10,"AnimationActor::hideAnimationPane exception: {0}",db.toString())})};this.Zil=(db,Kb,lc,Jc,Vc)=>{Kb=this.wk.Dy;db=this.pa.hk();if(!db||!Kb||!Kb.length)return 8;
Jc=this.Vka(Kb,db);if(!Jc||!Jc.length)return bd.a.J(509677834,800,10,"AnimationActor::setAnimationDelayHandler: selected shapes info is null"),8;if(this.eva(Jc))return 8;const vd=!this.vk.OAb(Kb);if(cd.Grg(Jc)&&vd)return 8;if(1===lc)return 32;lc=Math.floor(1E3*Vc.Number);for(var me of Kb)me.Delay=lc;me=cd.h9(Kb);me=cd.oOc(me,0,lc);this.x_(db,me,!1);return 32};this.JKa=(db,Kb,lc,Jc,Vc)=>{db=this.wk.Dy;if(!this.pa.hk()||!db||!db.length)return this.uNb(Vc,"0.00"),32;Kb=db[0].Delay;lc=!0;for(const vd of db)if(Kb!=
vd.Delay){lc=!1;break}lc?this.uNb(Vc,Number(Kb/1E3).toFixed(2)):this.uNb(Vc,"0.00");return 32};this.gri=(db,Kb,lc)=>{var Jc;const Vc=new sh.a;Vc.Id="AnimationMenuEffectOptions";Vc.UpdateDynamically=!0;Vc.Title=ResourceStrings.L_EffectOptions;Vc.MenuSectionList=[];if(!this.vk.Mac(db)){const vd=db[0];Vc.MenuSectionList.push(this.vk.NWc(vd.EffectId,vd.EffectType,"Direction","2289594085","3782857737"));if(this.vk.zqe(vd))if(Vc.MenuSectionList.push(Zd.f(Kb.Ed,"Theme Colors","Color.Menu.Controls","themeColor",
"AnimationEffectOptionsThemeColorPicker","679168237",2)),Vc.MenuSectionList.push(Zd.d("Standard Colors","Color.Menu.Controls","standardColor","AnimationEffectOptionsStandardColorPicker","679168237",!1)),this.wSj(db)){const me=null===(Jc=vd.EffectData)||void 0===Jc?void 0:Jc.Color;Jc=new Ee.a(Ee.a.esh(me));Zd.h(Vc,Jc,Kb.Ed)}else Zd.h(Vc,null,Kb.Ed);Vc.MenuSectionList.push(this.vk.NWc(vd.EffectId,vd.EffectType,"EffectData","2949363495","4132852551"))}Vc.MenuSectionList.push(this.vk.apj(lc,this.Ga,db));
return Vc};this.jgj=db=>{let Kb=new Ve;const lc=this.vk.z$d(db);return db.toLowerCase().startsWith("spin")?(Kb.Degree=parseFloat(lc),Kb.EffectDataPropType=0,Kb):db.toLowerCase().startsWith("transparency")?(Kb.Transparency=parseFloat(lc),Kb.EffectDataPropType=2,Kb):db.toLowerCase().startsWith("growshrink")?(Kb.Scale=parseFloat(lc),Kb.EffectDataPropType=3,Kb):null};this.QVk=(db,Kb,lc,Jc,Vc,vd,me,mf)=>{if(Vc)return!1;if(lc)return this.z$a(db,vd,ResourceStrings.L_AnimationMultiple,Kb,ResourceStrings.L_AnimationMultiple),
Jc;Jc&&(vd=this.vk.lXc(me,mf),{image:vd,label:lc}=this.vk.fVc(vd),this.z$a(db,vd,lc,Kb,lc));return Jc};this.z$a=(db,Kb,lc,Jc,Vc)=>{let vd;vd=db===this.G6?"298832323":db===this.lMa?"1264919631":"2676673376";Kb=Kb.substring((Ne.a.eoc+"_").length,Kb.length-6);const me=new dd.a;me.Id=db;me.ExternalId="Animation"+db;me.Icon=Kb;me.Command=vd;me.QueryCommand="1852964326";me.LabelText=lc;me.FullIconStyle={root:{width:"32px",height:"32px"}};me.PreviewIconStyle={root:{width:"24px",height:"24px"}};me.Alt=Vc;
Jc.W3=me};this.getSelectedShapes=()=>{let db=[];const Kb=this.pa.Xd();if(!Kb)return db;for(const lc of Kb)lc.get_smartArtModelId()?db.push(this.Ga.Gr(lc)):lc.Ug?db.push(this.Ga.Cs(lc)):db.push(lc);return db};this.Vka=(db,Kb)=>{const lc=[];if(!db||!db.length||!Kb)return lc;const Jc=Kb.Uj();if(!Jc||!Jc.length)return lc;Kb=new Map;for(const Vc of Jc)Kb.set(Vc.id.toString(),Vc);for(const Vc of db){db=vf.a.Jf(Vc.ShapeId);db=Kb.get(db.toString());if(!db)return[];lc.push(db)}return lc};this.x_=(db,Kb,lc)=>
{xf.a.Ak("AnimationCommandType",String(Kb.AnimationAction));const Jc=this.Eb.xd(15,void 0,()=>{this.pa.kj();lc&&this.Fa.Bd()});try{Jc.hc(db),db.gsa=Kb}finally{Jc&&Jc.dispose()}};this.eva=db=>{if(!db||0==db.length)return!1;for(const Kb of db)if(this.$b.$c(Kb))return!0;return!1};this.uNb=(db,Kb)=>{db.queryResult.iba=Kb};if(!A)throw Error.argumentNull("actionManager");if(!W)throw Error.argumentNull("selectionManager");if(!na)throw Error.argumentNull("focusManager");if(!Ga)throw Error.argumentNull("transactionFactory");
if(!Ka)throw Error.argumentNull("animationHelper");if(!qb)throw Error.argumentNull("graphActionBlockingManager");if(!Qb)throw Error.argumentNull("shapeReader");if(!t)throw Error.argumentNull("pathManager");if(!Y)throw Error.argumentNull("effectSelectionManager");if(!Ja)throw Error.argumentNull("viewElementEventHandler");if(!Ya)throw Error.argumentNull("graphNodeEventHandlers");if(!jb)throw Error.argumentNull("viewEventNotifier");if(!Sb)throw Error.argumentNull("slideReader");if(!kc)throw Error.argumentNull("graphTopologyManager");
this.ia=A;this.pa=W;this.Fa=na;this.Eb=Ga;this.Gic=t.qk(Ne.a.nld);this.vk=Ka;this.$b=qb;this.Ga=Qb;this.wk=Y;this.la=pa;this.Us=Ja;this.Pr=Ya;this.le=jb;this.jc=Sb;this.ta=kc;this.yEb=Rg.a("AnimationPaneTelemetryEnabled")}vb(){this.ia.ra(fd.a.R_b,Lc.a.application,this.ajl,4);this.ia.ra(fd.a.OKb,Lc.a.application,this.OKb,97);this.ia.ra(fd.a.Csc,Lc.a.application,this.$il,4);this.ia.ra(fd.a.KKa,Lc.a.application,this.KKa,97);this.ia.ra(fd.a.kCh,Lc.a.application,this.vFj,4);this.ia.ra(fd.a.rpc,Lc.a.application,
this.rpc,96);this.ia.ra(fd.a.Bsc,Lc.a.application,this.Zil,4);this.ia.ra(fd.a.JKa,Lc.a.application,this.JKa,97);this.ia.ra(fd.a.Goa,Lc.a.application,this.Goa,97);this.ia.ra(fd.a.Ww,Lc.a.application,this.Ww,13);this.ia.ra(fd.a.sNb,Lc.a.application,this.Ww,13);this.ia.ra(fd.a.tNb,Lc.a.application,this.Ww,5);this.ia.ra(fd.a.n1a,Lc.a.application,this.Ww,5);this.ia.ra(fd.a.Imd,Lc.a.application,this.JRe,100);this.ia.ra(fd.a.l1a,Lc.a.application,this.l1a,13);this.ia.ra(fd.a.Z_a,Lc.a.application,this.Z_a,
97);this.ia.ra(fd.a.m1a,Lc.a.application,this.m1a,12);this.ia.ra(fd.a.$_a,Lc.a.application,this.$_a,96);this.ia.ra(fd.a.Trd,Lc.a.application,this.DLa,13);this.ia.ra(fd.a.Urd,Lc.a.application,this.DLa,13);this.ia.ra(fd.a.Vrd,Lc.a.application,this.DLa,13);this.ia.ra(fd.a.Wrd,Lc.a.application,this.DLa,13);this.ia.ra(fd.a.Hoa,Lc.a.application,this.Hoa,97);this.ia.ra(fd.a.H_a,Lc.a.application,this.H_a,96);this.ia.ra(fd.a.bza,Lc.a.application,this.bza,12);this.ia.ra(fd.a.Cgd,Lc.a.application,this.A4g,4);
this.ia.ra(fd.a.Dgd,Lc.a.application,this.A4g,4);this.ia.ra(fd.a.Vxd,Lc.a.application,this.WMl,4);this.la.iA&&Rg.a("AnimationGalleryActionAIEnabled")&&this.ia.ra(fd.a.gUd,Lc.a.application,Object(n.a)(this,this.Pee,"handleAnimationGalleryActionAI"),4);this.pa.fE(this.onSelectionChange);this.Us.zTd(this.onSelectionChange);this.Us.aT(this.onActiveSlideDomReady);this.Pr.fk(this.$g);this.le.w7a(this.iga);Rg.a("FixMarkersForShapeDeleteAndUndo")&&this.Us.Msb(this.Rxa)}pe(){}Pee(A,W){if(W.contextId!==Lc.a.application)return 2;
A=this.getSelectedShapes();return!cd.Hrg(this.pa.hk(),A)||this.eva(A)?8:32}vGa(A,W){return A&&W?A.equals(W.slideId):!1}Rzj(A){var W=Date.now();if(A&&A.changeAnimationRelationshipInfo){var na=this.wk.Dy,Ga=this.pa.hk();Ga&&na&&na.length?(A=A.changeAnimationRelationshipInfo,na=cd.h9(na),na=cd.BOf(na,A.startType),this.x_(Ga,na,!1),this.yEb&&(W=Date.now()-W,Ud.c(fd.a.R_b,!0,void 0,0,30,W))):bd.a.J(509444173,800,10,"AnimationActor::handleChangeAnimationRelationshipInfo: slide or selected animation info is null")}else bd.a.J(509444174,
800,10,"AnimationActor::handleChangeAnimationRelationshipInfo: change relationship info is null")}vCj(A){const W=Date.now();if(A&&A.modifyAnimationInfo){var na=this.wk.Dy,Ga=this.pa.hk();if(Ga&&na&&na.length)if(na=cd.h9(na),na=cd.Zcj(A.modifyAnimationInfo,na)){if(this.x_(Ga,na,!1),this.yEb){Ga=null;switch(A.modifyAnimationInfo.modifyAnimationType){case 0:Ga=fd.a.Bsc;break;case 1:Ga=fd.a.Csc}Ga&&(A=Date.now()-W,Ud.c(Ga,!0,void 0,0,30,A))}}else bd.a.J(509444170,800,10,"AnimationActor::handleModifyAnimation: command info is null, invalid modify prop type might be passed");
else bd.a.J(509444171,800,10,"AnimationActor::handleModifyAnimation: slide or selected animation info is null")}else bd.a.J(509444172,800,10,"AnimationActor::handleModifyAnimation: modify info is null")}KEj(A){var W=Date.now(),na=A.reorderAnimationInfo;if(A&&na){var Ga=this.wk.Dy;A=A.reorderAnimationInfo.refAnimationId;var Ka=this.pa.hk();if(Ka&&Ga&&Ga.length&&A){var qb=new kf;qb.EffectNodeId=A.effectNodeId;qb.ShapeId=A.shapeId;var Qb=cd.h9(Ga);na=cd.TPf(Qb,qb,na.isLater);this.x_(Ka,na,!0);this.yEb&&
(W=Date.now()-W,Ud.c(A.effectNodeId<Ga[0].EffectNodeId?fd.a.Cgd:fd.a.Dgd,!0,void 0,0,30,W))}else bd.a.J(509444168,800,10,"AnimationActor::handleReorderAnimation: slide, selected or ref animation info is null")}else bd.a.J(509444169,800,10,"AnimationActor::handleReorderAnimation: reorder animation info is null")}static Zcj(A,W){switch(A.modifyAnimationType){case 0:return cd.oOc(W,0,A.delay);case 1:return cd.oOc(W,1,A.duration);default:return null}}wSj(A){var W;if(!(A&&A.length&&!this.vk.Mac(A)&&this.vk.zqe(A[0])&&
A[0].EffectData&&A[0].EffectData.Color))return!1;const na=null===(W=A[0].EffectData)||void 0===W?void 0:W.Color;for(const Ga of A){if(!Ga.EffectData||!Ga.EffectData.Color)return!1;A=Ga.EffectData.Color;if(A[0]!=na[0]||A[1]!=na[1]||A[2]!=na[2])return!1}return!0}static BOf(A,W){const na=new rf.a;na.AnimationAction=4;const Ga=new Wf;Ga.TargetEffects=A;Ga.StartType=W;na.ChangeAnimationRelationshipInfo=Ga;return na}static oOc(A,W,na){const Ga=new rf.a;Ga.AnimationAction=1;const Ka=new Af;Ka.TargetEffects=
A;Ka.ModifyAnimPropType=W;1===W?Ka.Duration=na:Ka.Delay=na;Ga.ModifyAnimationInfo=Ka;return Ga}static TPf(A,W,na){const Ga=new rf.a;Ga.AnimationAction=6;const Ka=new Og;Ka.TargetEffects=A;Ka.IsLater=na;Ka.RefEffect=W;Ga.ReorderAnimationEffectsInfo=Ka;return Ga}static tZe(A,W){let na="";switch(W){case 0:na=ResourceStrings.l_AnimationStartOptionOnClick;break;case 1:na=ResourceStrings.l_AnimationStartOptionWithPrevious;break;case 2:na=ResourceStrings.l_AnimationStartOptionAfterPrevious}A.m_=na;A.Dsc()}}
cd.yuj=A=>{const W=[];if(!A||!A.length)return W;for(const na of A)A=new kf,A.EffectNodeId=na.effectNodeId,A.ShapeId=na.shapeId,W.push(A);return W};cd.ybj=A=>{switch(A){case "AsOneObject":return 1;case "AllAtOnce":return 2;case "ByParagraph":return 3;case "OneByOne":return 4;default:return 0}};cd.uaj=(A,W,na,Ga,Ka)=>0==W&&0==na?cd.pfj(Ka):Ga?cd.E3f(A,W,na,!0):cd.aag(Ka,W,na);cd.aag=(A,W,na)=>{let Ga=new rf.a;Ga.AnimationAction=2;let Ka=new kg;if(!A||!A.length)return bd.a.J(509703434,800,15,"AnimationActor::getReplaceAnimationCommandInfo:  animation info is null or empty"),
null;Ka.TargetEffects=cd.h9(A);Ka.EffectId=W;Ka.EffectType=na;Ga.ReplaceAnimationInfo=Ka;return Ga};cd.pfj=A=>A&&A.length?cd.NOf(cd.h9(A)):(bd.a.J(509703433,800,15,"AnimationActor::getDeleteAnimationCommandInfo:  animation info is null or empty"),null);cd.E3f=(A,W,na,Ga)=>{let Ka=new rf.a;Ka.AnimationAction=0;let qb=new Ag;qb.EffectId=W;qb.EffectType=na;qb.ShapeIds=[];qb.FRemoveExisting=Ga;for(const Qb of A)qb.ShapeIds.push(Qb.id.toString());Ka.AddAnimationInfo=qb;return Ka};cd.NOf=A=>{const W=new rf.a;
W.AnimationAction=3;const na=new ne;na.TargetEffects=A;W.DeleteAnimationInfo=na;return W};cd.gtj=A=>{switch(A.toLocaleLowerCase()){case "on click":return 0;case "with previous":return 1;case "after previous":return 2}return 3};cd.h9=A=>{if(!A||!A.length)return null;const W=[];for(const na of A)A=new kf,A.EffectNodeId=na.EffectNodeId,A.ShapeId=na.ShapeId,W.push(A);return W};cd.G2j=A=>{if(!A||0==A.length)return!1;for(const W of A)if(W.r4)return!0;return!1};cd.Grg=A=>{if(!A||0==A.length)return!1;for(const W of A)if(1===
W.mediaType||2===W.mediaType)return!0;return!1};cd.Hrg=(A,W)=>{if(!A||!W||!W.length)return!1;for(const na of W)if(na.YT||na.Jq||na.pp)return!1;return!0};cd.H2j=A=>{if(!A||!A.length)return!1;for(const W of A)if(W.vd||W.nr||W.pp)return!1;return!0};cd.xSj=A=>{if(!A||!A.length)return!1;const W=A[0].Direction;for(let na=1;na<A.length;na++)if(A[na].Direction!=W)return!1;return!0};cd.vSj=A=>{if(!A||!A.length)return!1;const W=A[0].BuildType;for(let na=1;na<A.length;na++)if(A[na].BuildType!=W)return!1;return!0};
cd.kgj=A=>{if(!A)return"";switch(A.EffectDataPropType){case 0:return A.Degree.toString();case 3:return A.Scale.toString();case 2:return A.Transparency.toString()}return""};cd.OVk=(A,W,na,Ga)=>{na?(A.x$a=ResourceStrings.L_AnimationExisting,Ga&&(Ga=!1)):W&&(A.x$a=ResourceStrings.L_AnimationMultiple);return Ga};Object(h.a)(cd,"AnimationActor",null,[251]);class cg{constructor(){this.BuildId=0;this.BuildIds=null;this.Duration=this.Direction=this.Delay=0;this.EffectData=null;this.EffectType=this.EffectId=
0;this.HasTrigger=this.HasMultiple=this.HasExisting=!1;this.Id=null;this.IsTrigger=this.IsTextRangeType=!1;this.ParaRangeStart=this.ParaRangeEnd=0;this.RenderAnimationImage=!1;this.StartType=this.SequenceIndex=this.SequenceId=0}}Object(h.a)(cg,"EditAnimationInfo",null,[]);var xh;(function(A){A[A.invalid=0]="invalid";A[A.basicBlockList=1]="basicBlockList";A[A.alternatingHexagons=2]="alternatingHexagons";A[A.pictureCaptionList=3]="pictureCaptionList";A[A.linedList=4]="linedList";A[A.verticalBulletList=
5]="verticalBulletList";A[A.verticalBoxList=6]="verticalBoxList";A[A.verticalBracketList=7]="verticalBracketList";A[A.varyingWidthList=8]="varyingWidthList";A[A.tabList=9]="tabList";A[A.horizontalBulletList=10]="horizontalBulletList";A[A.squareAccentList=11]="squareAccentList";A[A.pictureAccentList=12]="pictureAccentList";A[A.bendingPictureAccentList=13]="bendingPictureAccentList";A[A.stackedList=14]="stackedList";A[A.increasingCircleProcess=15]="increasingCircleProcess";A[A.pieProcess=16]="pieProcess";
A[A.detailedProcess=17]="detailedProcess";A[A.groupedList=18]="groupedList";A[A.horizontalPictureList=19]="horizontalPictureList";A[A.continuousPictureList=20]="continuousPictureList";A[A.pictureStrips=21]="pictureStrips";A[A.verticalPictureList=22]="verticalPictureList";A[A.alternatingPictureBlocks=23]="alternatingPictureBlocks";A[A.verticalPictureAccentList=24]="verticalPictureAccentList";A[A.titledPictureAccentList=25]="titledPictureAccentList";A[A.verticalBlockList=26]="verticalBlockList";A[A.verticalChevronList=
27]="verticalChevronList";A[A.verticalAccentList=28]="verticalAccentList";A[A.verticalArrowList=29]="verticalArrowList";A[A.trapezoidList=30]="trapezoidList";A[A.descendingBlockList=31]="descendingBlockList";A[A.tableList=32]="tableList";A[A.segmentedProcess=33]="segmentedProcess";A[A.verticalCurvedList=34]="verticalCurvedList";A[A.pyramidList=35]="pyramidList";A[A.targetList=36]="targetList";A[A.hierarchyList=37]="hierarchyList";A[A.verticalCircleList=38]="verticalCircleList";A[A.tableHierarchy=
39]="tableHierarchy";A[A.architectureLayout=40]="architectureLayout";A[A.basicProcess=41]="basicProcess";A[A.stepUpProcess=42]="stepUpProcess";A[A.stepDownProcess=43]="stepDownProcess";A[A.accentProcess=44]="accentProcess";A[A.pictureAccentProcess=45]="pictureAccentProcess";A[A.alternatingFlow=46]="alternatingFlow";A[A.continuousBlockProcess=47]="continuousBlockProcess";A[A.increasingArrowsProcess=48]="increasingArrowsProcess";A[A.interconnectedBlockProcess=49]="interconnectedBlockProcess";A[A.continuousArrowProcess=
50]="continuousArrowProcess";A[A.convergingText=51]="convergingText";A[A.processArrows=52]="processArrows";A[A.circleAccentTimeline=53]="circleAccentTimeline";A[A.basicTimeline=54]="basicTimeline";A[A.circleProcess=55]="circleProcess";A[A.basicChevronProcess=56]="basicChevronProcess";A[A.chevronAccentProcess=57]="chevronAccentProcess";A[A.closedChevronProcess=58]="closedChevronProcess";A[A.chevronList=59]="chevronList";A[A.subStepProcess=60]="subStepProcess";A[A.phasedProcess=61]="phasedProcess";
A[A.randomtoResultProcess=62]="randomtoResultProcess";A[A.verticalProcess=63]="verticalProcess";A[A.staggeredProcess=64]="staggeredProcess";A[A.processList=65]="processList";A[A.circleArrowProcess=66]="circleArrowProcess";A[A.basicBendingProcess=67]="basicBendingProcess";A[A.repeatingBendingProcess=68]="repeatingBendingProcess";A[A.verticalBendingProcess=69]="verticalBendingProcess";A[A.ascendingPictureAccentProcess=70]="ascendingPictureAccentProcess";A[A.upwardArrow=71]="upwardArrow";A[A.descendingProcess=
72]="descendingProcess";A[A.circularBendingProcess=73]="circularBendingProcess";A[A.equation=74]="equation";A[A.verticalEquation=75]="verticalEquation";A[A.funnel=76]="funnel";A[A.gear=77]="gear";A[A.arrowRibbon=78]="arrowRibbon";A[A.opposingArrows=79]="opposingArrows";A[A.convergingArrows=80]="convergingArrows";A[A.divergingArrows=81]="divergingArrows";A[A.basicCycle=82]="basicCycle";A[A.textCycle=83]="textCycle";A[A.blockCycle=84]="blockCycle";A[A.nondirectionalCycle=85]="nondirectionalCycle";A[A.continuousCycle=
86]="continuousCycle";A[A.multidirectionalCycle=87]="multidirectionalCycle";A[A.segmentedCycle=88]="segmentedCycle";A[A.basicPie=89]="basicPie";A[A.hexagonRadial=90]="hexagonRadial";A[A.radialCycle=91]="radialCycle";A[A.basicRadial=92]="basicRadial";A[A.divergingRadial=93]="divergingRadial";A[A.radialVenn=94]="radialVenn";A[A.cycleMatrix=95]="cycleMatrix";A[A.radialCluster=96]="radialCluster";A[A.organizationChart=97]="organizationChart";A[A.pictureOrganizationChart=98]="pictureOrganizationChart";
A[A.nameandTitleOrganizationChart=99]="nameandTitleOrganizationChart";A[A.halfCircleOrganizationChart=100]="halfCircleOrganizationChart";A[A.circlePictureHierarchy=101]="circlePictureHierarchy";A[A.hierarchy=102]="hierarchy";A[A.labeledHierarchy=103]="labeledHierarchy";A[A.horizontalOrganizationChart=104]="horizontalOrganizationChart";A[A.horizontalMultiLevelHierarchy=105]="horizontalMultiLevelHierarchy";A[A.horizontalHierarchy=106]="horizontalHierarchy";A[A.horizontalLabeledHierarchy=107]="horizontalLabeledHierarchy";
A[A.balance=108]="balance";A[A.circleRelationship=109]="circleRelationship";A[A.hexagonCluster=110]="hexagonCluster";A[A.opposingIdeas=111]="opposingIdeas";A[A.plusandMinus=112]="plusandMinus";A[A.reverseList=113]="reverseList";A[A.counterbalanceArrows=114]="counterbalanceArrows";A[A.segmentedPyramid=115]="segmentedPyramid";A[A.nestedTarget=116]="nestedTarget";A[A.convergingRadial=117]="convergingRadial";A[A.radialList=118]="radialList";A[A.tabbedArc=119]="tabbedArc";A[A.basicTarget=120]="basicTarget";
A[A.basicVenn=121]="basicVenn";A[A.linearVenn=122]="linearVenn";A[A.stackedVenn=123]="stackedVenn";A[A.interconnectedRings=124]="interconnectedRings";A[A.basicMatrix=125]="basicMatrix";A[A.titledMatrix=126]="titledMatrix";A[A.gridMatrix=127]="gridMatrix";A[A.basicPyramid=128]="basicPyramid";A[A.invertedPyramid=129]="invertedPyramid";A[A.accentedPicture=130]="accentedPicture";A[A.circularPictureCallout=131]="circularPictureCallout";A[A.radialPictureList=132]="radialPictureList";A[A.snapshotPictureList=
133]="snapshotPictureList";A[A.spiralPicture=134]="spiralPicture";A[A.captionedPictures=135]="captionedPictures";A[A.bendingPictureCaption=136]="bendingPictureCaption";A[A.pictureFrame=137]="pictureFrame";A[A.bendingPictureSemiTransparentText=138]="bendingPictureSemiTransparentText";A[A.bendingPictureBlocks=139]="bendingPictureBlocks";A[A.bendingPictureCaptionList=140]="bendingPictureCaptionList";A[A.titledPictureBlocks=141]="titledPictureBlocks";A[A.pictureGrid=142]="pictureGrid";A[A.pictureAccentBlocks=
143]="pictureAccentBlocks";A[A.themePictureAccent=144]="themePictureAccent";A[A.themePictureGrid=145]="themePictureGrid";A[A.themePictureAlternatingAccent=146]="themePictureAlternatingAccent";A[A.alternatingPictureCircles=147]="alternatingPictureCircles";A[A.titlePictureLineup=148]="titlePictureLineup";A[A.pictureLineup=149]="pictureLineup";A[A.framedTextPicture=150]="framedTextPicture";A[A.bubblePictureList=151]="bubblePictureList";A[A.linearArrowProcessNumbered=152]="linearArrowProcessNumbered";
A[A.linearBlockProcessNumbered=153]="linearBlockProcessNumbered";A[A.basicLinearProcessNumbered=154]="basicLinearProcessNumbered";A[A.accentHomeChevronProcess=155]="accentHomeChevronProcess";A[A.basicProcessNew=156]="basicProcessNew";A[A.basicTimelineNew=157]="basicTimelineNew";A[A.chevronBlockProcess=158]="chevronBlockProcess";A[A.hexagonTimeline=159]="hexagonTimeline";A[A.horizontalActionList=160]="horizontalActionList";A[A.repeatingBendingProcessNew=161]="repeatingBendingProcessNew";A[A.roundedRectangleTimeline=
162]="roundedRectangleTimeline";A[A.verticalDownArrowProcess=163]="verticalDownArrowProcess";A[A.verticalHollowActionList=164]="verticalHollowActionList";A[A.verticalSolidActionList=165]="verticalSolidActionList";A[A.dropPinTimeline=166]="dropPinTimeline";A[A.horizontalLabelsTimeline=167]="horizontalLabelsTimeline";A[A.horizontalPathTimeline=168]="horizontalPathTimeline";A[A.iconLabelList=169]="iconLabelList";A[A.iconCircleList=170]="iconCircleList";A[A.iconLabelDescriptionList=171]="iconLabelDescriptionList";
A[A.iconVerticalSolidList=172]="iconVerticalSolidList";A[A.iconCircleLabelList=173]="iconCircleLabelList";A[A.iconCircleOutlineLabelList=174]="iconCircleOutlineLabelList";A[A.iconLeafLabelList=175]="iconLeafLabelList";A[A.iconLeafOutlineLabelList=176]="iconLeafOutlineLabelList";A[A.centeredIconLabelDescriptionList=177]="centeredIconLabelDescriptionList"})(xh||(xh={}));Object(h.b)("SmartArtLayout",xh);var Yf;(function(A){A[A.title=0]="title";A[A.body=1]="body";A[A.centerTitle=2]="centerTitle";A[A.subTitle=
3]="subTitle";A[A.slideNum=5]="slideNum";A[A.footer=6]="footer";A[A.object=8]="object";A[A.graph=9]="graph";A[A.table=10]="table";A[A.clipArt=11]="clipArt";A[A.orgChart=12]="orgChart";A[A.media=13]="media";A[A.picture=15]="picture"})(Yf||(Yf={}));Object(h.b)("PlaceholderType",Yf);class Hf{constructor(A,W,na,Ga,Ka,qb,Qb,t,Y,pa){this.G6="Existing";this.lMa="ExistingInMenu";this.j3e="AnimationExisting";this.k3e="AnimationExistingInMenu";this.ia=A;this.oq=W;this.pa=na;this.Gic=pa.qk(Ne.a.nld);this.Eb=
Ka;this.Fa=Ga;this.vk=qb;this.$b=Qb;this.kjk=t.pptAnimationMarkersEnabled;this.Ga=Y;this.la=t;this.BBe=Rg.a("SetAnimationTelemetryCustomDataEnabled")}vb(){this.ia.ra(fd.a.Goa,Lc.a.application,Object(n.a)(this,this.Goa,"queryAnimationGallery"),97);this.ia.ra(fd.a.hSe,Lc.a.application,Object(n.a)(this,this.hSe,"queryMoreAnimationGallery"),96);this.ia.ra(fd.a.Ww,Lc.a.application,Object(n.a)(this,this.Ww,"setAnimation"),5|(this.BBe?8:0));this.ia.ra(fd.a.sNb,Lc.a.application,Object(n.a)(this,this.Ww,"setAnimation"),
5|(this.BBe?8:0));this.ia.ra(fd.a.tNb,Lc.a.application,Object(n.a)(this,this.Ww,"setAnimation"),5);this.ia.ra(fd.a.n1a,Lc.a.application,Object(n.a)(this,this.Ww,"setAnimation"),5);this.ia.ra(fd.a.Imd,Lc.a.application,Object(n.a)(this,this.JRe,"queryEffectOptions"),100);this.ia.ra(fd.a.l1a,Lc.a.application,Object(n.a)(this,this.l1a,"setAnimationDirection"),5);this.ia.ra(fd.a.Z_a,Lc.a.application,Object(n.a)(this,this.Z_a,"queryAnimationDirection"),97);this.ia.ra(fd.a.m1a,Lc.a.application,Object(n.a)(this,
this.m1a,"setAnimationEffectData"),4);this.ia.ra(fd.a.$_a,Lc.a.application,Object(n.a)(this,this.$_a,"queryAnimationEffectData"),96);this.ia.ra(fd.a.Trd,Lc.a.application,Object(n.a)(this,this.DLa,"setAnimationSequence"),5);this.ia.ra(fd.a.Urd,Lc.a.application,Object(n.a)(this,this.DLa,"setAnimationSequence"),5);this.ia.ra(fd.a.Vrd,Lc.a.application,Object(n.a)(this,this.DLa,"setAnimationSequence"),5);this.ia.ra(fd.a.Wrd,Lc.a.application,Object(n.a)(this,this.DLa,"setAnimationSequence"),5);this.ia.ra(fd.a.Hoa,
Lc.a.application,Object(n.a)(this,this.Hoa,"queryAnimationSequence"),97);this.ia.ra(fd.a.aWe,Lc.a.application,Object(n.a)(this,this.Naa,"reorderAnimation"),4);this.ia.ra(fd.a.bWe,Lc.a.application,Object(n.a)(this,this.Naa,"reorderAnimation"),4);this.ia.ra(fd.a.H_a,Lc.a.application,Object(n.a)(this,this.H_a,"populateAnimationEffectOptions"),96);this.ia.ra(fd.a.bza,Lc.a.application,Object(n.a)(this,this.bza,"setAnimationColor"),4);this.la.iA&&Rg.a("AnimationGalleryActionAIEnabled")&&this.ia.ra(fd.a.gUd,
Lc.a.application,Object(n.a)(this,this.Pee,"handleAnimationGalleryActionAI"),4)}pe(){}H_a(A,W,na,Ga,Ka){A=this.FQ();W=this.pa.hk();if(!W||!A)return 8;if(1===na)return 32;na=Hf.g4(W,A);if(!na||0===na.EffectId)return 16;Ka.MenuItems=this.fri(na,W,A);return 32}Goa(A,W,na,Ga,Ka){A=Ka.queryResult;Ka=Ka.SourceControlId;var qb=Ga=-1;Ka!==this.G6&&({effectType:qb,effectId:Ga}=this.vk.eVc(Ka));W=this.FQ();var Qb=this.pa.hk();if(!Qb||!W)return 8;if(1!==na)return 32;({image:na,label:pa}=this.vk.fVc(Ka));var t=
pa;if(Ka===this.G6||Ka===this.lMa)t=ResourceStrings.L_ExistingButtonDescription;this.z$a(Ka,na,pa,A,t);var Y=Hf.g4(Qb,W);var pa=Y?Y.EffectId:0;t=Y?Y.EffectType:0;const Ja=!this.vk.acb(Y,W);Y=this.vk.Coe(Y,W);this.kjk&&(Qb=Qb?Qb.rUa(W):null,Y=Y&&!this.vk.q2j(Qb));Ga=!Ja&&!Y&&Ga===pa&&qb===t;qb=Ja?!1:this.vk.V0c(t,pa);Ka===this.G6||Ka===this.lMa?(qb=Ka===this.G6?this.RVk(this.G6,A,Y,qb,na,t,pa):Hf.PVk(A,Y,qb),A.kV(Ja||Y||qb)):W&&A.kV(Ga);return 32}Pee(A,W){if(W.contextId!==Lc.a.application)return 2;
A=this.FQ();return!this.pa.hk()||!A||A.YT||A.Jq||A.pp?8:this.$b.$c(A)?16:32}RVk(A,W,na,Ga,Ka,qb,Qb){na?this.z$a(A,Ka,ResourceStrings.L_AnimationMultiple,W,ResourceStrings.L_AnimationMultiple):Ga&&(Ka=this.vk.lXc(qb,Qb),{image:Ka,label:na}=this.vk.fVc(Ka),this.z$a(A,Ka,na,W,na));return Ga}z$a(A,W,na,Ga,Ka){let qb;qb=A===this.G6?"298832323":A===this.lMa?"1264919631":"2676673376";W=W.substring((Ne.a.eoc+"_").length,W.length-6);A=Object.assign(new dd.a,{Id:A,ExternalId:"Animation"+A,Icon:W,Command:qb,
QueryCommand:"1852964326",LabelText:na,FullIconStyle:{root:{width:"32px",height:"32px"}},PreviewIconStyle:{root:{width:"24px",height:"24px"}},Alt:Ka});Ga.W3=A}hSe(A,W){if(W.contextId!==Lc.a.application)return 2;A=this.FQ();return!this.pa.hk()||!A||A.YT||A.Jq||A.pp?8:this.$b.$c(A)?16:32}Ww(A,W,na,Ga,Ka){W=this.FQ();var qb=this.pa.hk();if(!qb||!W||W.YT||W.Jq||W.pp)return 8;if(this.$b.$c(W))return 16;var Qb=Hf.g4(qb,W),t=Qb?Qb.EffectId:-1,Y=Qb?Qb.EffectType:-1;if(1===na)return A===fd.a.tNb||A===fd.a.n1a?
(Ga=this.vk.V0c(Y,t),qb=!!Qb&&!this.vk.acb(Qb,W),A===fd.a.n1a&&(Ga=qb?!0:!1),W=!!Qb&&this.vk.Coe(Qb,W),W=qb||W,Ga||W?32:16):A===fd.a.sNb?W.vd||W.nr||W.pp?16:32:32;A=Ka.SourceControlId;if(!A)return 8;if(A===this.G6||A===this.lMa||A===this.j3e||A===this.k3e)return 32;({effectType:Ka,effectId:na}=this.vk.eVc(A));t=this.vk.$ej(A);Y=this.vk.Xej(A);Ga&&this.BBe&&(Ga.QC=na,Ga.RN=Ka);Qb=W.Pbb()?Hf.n8b(qb,W):Qb;Qb||(Qb=new cg,Qb.Id=W.id.toString(),Qb.BuildIds=[qb.U4b+1],Qb.HasTrigger=!1,Qb.BuildId=qb.U4b+
1,Qb.SequenceIndex=0,Qb.IsTextRangeType=!1);Qb.HasExisting=!1;Qb.HasMultiple=!1;Qb.EffectType=Ka;Qb.SequenceId=1;Qb.EffectId=na;Qb.Direction=t;Qb.EffectData=Y;Qb.IsTrigger=!1;this.J5b(qb,W,Qb);e.ULS.sendTraceTag(512500802,800,50,"AnimationActorLegacy.SetAnimation: Effect={0}, SlideId.Sid={1}, ShapeId={2}",A,qb.Db.sid,W.id);this.Wck(qb);return 32}bza(A,W,na,Ga,Ka){W=this.oq.presentation;if(!W)throw Error.argumentNull("Presentation is null");A=this.FQ();if(!A)return 8;W=Object(z.a)(118,W.ZC(A.slideId));
if(!W)return 8;Ga=Hf.g4(W,A);if(!(Ga&&Ka&&W&&A))return 8;if(this.$b.$c(A))return 16;if(1===na)return 32;na=De.Box4ColorHelper.pS(Ka);na=De.Box4ColorHelper.rkb(na,W.Ed);if(!na)return 8;Ga.EffectData=String.format("{0},{1},{2}",na.r.toString(16),na.g.toString(16),na.b.toString(16));this.J5b(W,A,Ga);return 32}JRe(){const A=this.FQ();var W=this.pa.hk();return W&&A?this.$b.$c(A)?16:(W=Hf.g4(W,A))&&this.vk.Ewi(A,this.Ga,W)?32:16:8}Naa(A,W,na){W=this.FQ();const Ga=this.pa.hk();if(!Ga||!W)return 8;if(this.$b.$c(W))return 16;
const Ka=Hf.n8b(Ga,W);let qb;switch(A){case fd.a.aWe:qb=!1;break;case fd.a.bWe:qb=!0;break;default:return 8}let Qb=!1;if(W&&(Qb=!!Ka&&!Ka.HasTrigger&&1===Ka.BuildIds.length)){let t=!1,Y=!1;({m1b:t,o1b:Y}=Hf.Jwi(Ga,Ka));Qb=qb?Y&&Qb:t&&Qb}if(1===na)return Qb?32:8;if(Qb){na=this.Eb.xd(15,void 0,()=>{this.pa.kj();this.Fa.Bd()});try{na.hc(Ga),na.fd=A,Ga.Naa(W,qb)}finally{na&&na.dispose()}}return 32}l1a(A,W,na,Ga,Ka){A=this.FQ();W=this.pa.hk();if(!W||!A)return 8;if(1===na)return 32;if(this.$b.$c(A))return 16;
na=Hf.n8b(W,A);if(!na)return 8;Ka=Ka.MenuItemId;na.Direction=this.vk.s7b(Ka);this.J5b(W,A,na);e.ULS.sendTraceTag(512500801,800,50,"AnimationActorLegacy.SetAnimationDirection: Effect={0}, EffectDirection={1}, SlideId.Sid={2}, ShapeId={3}",this.vk.lXc(na.EffectType,na.EffectId),Ka,W.sid,A.id);return 32}Z_a(A,W,na,Ga,Ka){W=this.FQ();Ga=this.pa.hk();if(!Ga||!W)return 8;A=Ka.queryResult;Ka=this.vk.s7b(Ka.MenuItemId);W=Hf.g4(Ga,W);1===na&&W&&A.Hf(W.Direction===Ka);return 32}DLa(A,W,na,Ga,Ka){A=Ka.MenuItemId;
W=this.FQ();Ga=this.pa.hk();if(!Ga||!W)return 8;if(1===na)return 32;if(this.$b.$c(W))return 16;na=Hf.n8b(Ga,W);if(!na)return 8;na.SequenceId=this.vk.Gce(A);this.J5b(Ga,W,na);return 32}Hoa(A,W,na,Ga,Ka){A=this.FQ();W=this.pa.hk();if(!W||!A)return 8;A=Hf.g4(W,A);W=Ka.queryResult;Ka=this.vk.Gce(Ka.MenuItemId);1===na&&A&&W.Hf(A.SequenceId===Ka);return 32}m1a(A,W,na,Ga,Ka){A=this.FQ();W=this.pa.hk();if(!W||!A)return 8;if(1===na)return 32;if(this.$b.$c(A))return 16;na=Hf.n8b(W,A);if(!na)return 8;if(!Ka)return 2;
na.EffectData=this.vk.z$d(Ka.MenuItemId);this.J5b(W,A,na);return 32}$_a(A,W,na,Ga,Ka){A=this.FQ();W=this.pa.hk();if(!W||!A)return 8;A=Hf.g4(W,A);1===na&&A&&Ka.queryResult.Hf(this.vk.oMf(A.EffectData,Ka.MenuItemId));return 32}J5b(A,W,na){const Ga=this.Eb.xd(15,void 0,()=>{this.pa.kj();this.Fa.Bd()});try{Ga.hc(A),A.Zsc(W,na)}finally{Ga&&Ga.dispose()}}fri(A,W,na){const Ga=Object.assign(new sh.a,{Id:"AnimationMenuEffectOptions",UpdateDynamically:!0,Title:ResourceStrings.L_EffectOptions,MenuSectionList:[]});
Array.add(Ga.MenuSectionList,this.vk.NWc(A.EffectId,A.EffectType,"Direction","2289594085","3782857737"));this.vk.Lmg(A)&&(Array.add(Ga.MenuSectionList,Zd.f(W.Ed,"Theme Colors","Color.Menu.Controls","themeColor","AnimationEffectOptionsThemeColorPicker","679168237",2)),Array.add(Ga.MenuSectionList,Zd.d("Standard Colors","Color.Menu.Controls","standardColor","AnimationEffectOptionsStandardColorPicker","679168237",!1)));Array.add(Ga.MenuSectionList,this.vk.NWc(A.EffectId,A.EffectType,"EffectData","2949363495",
"4132852551"));Array.add(Ga.MenuSectionList,this.vk.$oj(na,this.Ga,A));return Ga}Wck(A){if(A){var W=A.Uj(),na=String.format("{0}#{1}",A.sid,A.cid);if(W&&0<W.length)for(const Ga of W)if(W=A.cFa(Ga)){const Ka=W.EffectId,qb=W.EffectType,Qb=W.Direction,t=this.vk.lXc(qb,Ka),Y=this.Ga.D7f(Ga),pa=Hf.Mrj(Ga,Y);e.ULS.sendTraceTag(512500800,800,50,"Slide animation info: Effect={0}, EffectID={1}, EffectType={2}, Direction={3}, Len={4}, ShapeType={5}, ShapeSubType={6}, SeqID={7}, SlideID={8}, ShapeID={9}",t,
Ka,qb,Qb,Ga.nz().length,Y,pa,W.SequenceId,na,Ga.id)}}}FQ(){const A=this.pa.fo();return A?A.get_smartArtModelId()?this.Ga.Gr(A):A.Ug?this.Ga.Cs(A):A:null}static PVk(A,W,na){W?A.x$a=ResourceStrings.L_AnimationMultiple:(A.x$a=ResourceStrings.L_AnimationExisting,na&&(na=!1));return na}static Jwi(A,W){let na,Ga;if(!W)return{m1b:!1,o1b:!1};const Ka=A.I4d,qb=A.U4b,Qb=W.BuildIds[0];Ga=na=!0;0===W.StartType?na=Qb>Ka?!0:!1:Ga=Qb<qb?!0:!1;if(Qb===Ka||Qb===qb){if(!Qb)return{m1b:!1,o1b:Ga};for(const t of A.uQ)if(t.Id!==
W.Id)for(const Y of t.BuildIds)if(0===W.StartType){if(Y>=Qb)return Ga=!0,{m1b:na,o1b:Ga}}else if(Y===Qb)return na=!0,{m1b:na,o1b:Ga};0===W.StartType?Ga=!1:na=!1}return{m1b:na,o1b:Ga}}static g4(A,W){return A&&W?A.g4(W):null}static n8b(A,W){return A&&W?A.cFa(W):null}static Mrj(A,W){return 24===W?xh[A.smartArtInfo.SmartArtLayout]:1===W?A.shapeType.toString():14===W?Yf[A.Qj]:"Unknown"}}Object(h.a)(Hf,"AnimationActorLegacy",null,[251]);class ji{constructor(A,W,na,Ga){this.Df=null;this.Ca=A;this.Pob=W;
this.sZh=na;this.sMd=Ga;this.sMd.init();this.Pob.init()}vb(){this.Ca.ra(de.a.qJb,Lc.a.application,Object(n.a)(this,this.qJb,"openGrammarSettings"),1028);this.Ca.ya(de.a.h9b,fc.a.frame,Object(n.a)(this,this.aeg,"grammarDialogTabFocusHandler"));this.Ca.ya(de.a.g9b,fc.a.frame,Object(n.a)(this,this.aeg,"grammarDialogTabFocusHandler"));this.Ca.ya(de.a.aYc,fc.a.frame,Object(n.a)(this,this.$dg,"grammarDialogOptionFocusHandler"));this.Ca.ya(de.a.$Xc,fc.a.frame,Object(n.a)(this,this.$dg,"grammarDialogOptionFocusHandler"))}qJb(A,
W,na,Ga,Ka){A=this.P5f();if(1===na)return this.sMd.request(A).result&&this.sMd.request(A).result.length?6===this.Pob.r5a.status?32:8:8;this.Df=this.sZh(A,this.Pob.r5a.result);this.Df.showDialog(CommonUIStrings.l_GrammarSettingsDialogTitle,qb=>{e.ULS.sendTraceTag(36489285,375,50,"User click button of {0}",1===qb?"OK":0===qb?"Cancel":"");1===qb&&(this.Df.u5j()?(e.ULS.sendTraceTag(36489286,375,50,"User update proofing options"),this.Pob.saveSettings(this.Df.settings)):e.ULS.sendTraceTag(36508631,375,
50,"User click OK with but not update setting"))});A=na="";Ka&&(na+=Ka.SourceControlId,A+=Ka.Alt);e.ULS.sendTraceTag(36489287,375,50,"Open grammar setting dialog, SourceControlId: "+na+", Alt: "+A);return 32}P5f(){return M.AFrameworkApplication.lcid}aeg(A){if(!this.Df)return 2;var W=this.Df.Uo.Ll().Dj.q_;if(W===this.Df.jw&&A===de.a.h9b||W===this.Df.J0a&&A===de.a.g9b)this.Df.c8?this.Df.Uo.Ll().Dj.mF(this.Df.c8):this.Df.xgl();else if(Sys.UI.DomElement.containsCssClass(W,ze.F3b)||W.parentNode&&Sys.UI.DomElement.containsCssClass(W.parentNode,
ze.F3b))W=null,A===de.a.h9b?W=this.Df.J0a:A===de.a.g9b&&(W=this.Df.jw),this.Df.Uo.Ll().Dj.mF(W);else if(A===de.a.h9b)this.Df.Uo.Ll().dIb();else if(A===de.a.g9b)this.Df.Uo.Ll().bIb();else return 2;return 32}$dg(A){if(!this.Df)return 2;let W=this.Df.Uo.Ll().Dj.q_;if(W===this.Df.jw||W===this.Df.J0a||W===this.Df.SD)return 2;A===de.a.$Xc&&this.Df.Uo.Ll().dIb();A===de.a.aYc&&this.Df.Uo.Ll().bIb();W=this.Df.Uo.Ll().Dj.q_;W===this.Df.J0a?this.Df.Uo.Ll().bIb():W===this.Df.jw?this.Df.Uo.Ll().dIb():this.Df.c8=
W;return 32}}Object(h.a)(ji,"GrammarSettingsActor",null,[]);class Qi extends ji{constructor(A,W,na,Ga,Ka,qb,Qb){super(A,W,na,Ga);this.kb=Ka;this.WBe=qb;this.Ga=Qb}P5f(){let A=M.AFrameworkApplication.lcid;if(this.kb.d0(this.kb.Pa)){var W=this.kb.Xd();W&&1===W.length&&(W=this.Ga.aUa(W[0]),0<W&&(A=W))}else this.kb.Pa.mb&&(W=this.WBe.YVc(this.kb.Yj),0<W&&(A=W));return A}}Object(h.a)(Qi,"EditorSettingsActor",ji,[]);var ah=d(62),Kd=d(329),Qd=d(232),Gg=d(450);class Sg{constructor(A,W,na,Ga,Ka,qb,Qb,t,Y,
pa,Ja,Ya){this.sYd=null;this.zFj=(jb,Sb,kc)=>{var db;Sb=this.pa.Se();if(!Sb||!Sb.length)return bd.a.J(509362200,822,10,"FormatBackgroundActor::handleSlidesBackgroundReset: selected slides are empty"),8;for(const Kb of Sb)if(!Kb||this.$b.$c(Kb))return bd.a.J(509362199,822,10,"FormatBackgroundActor::handleSlidesBackgroundReset: selected slides is blocked"),8;if(!this.Zrl(Sb))return bd.a.J(509362198,822,50,"FormatBackgroundActor::handleSlidesBackgroundReset: The selected slide follow master background"),
8;if(1===kc)return 32;null===(db=xf.a.Kb)||void 0===db?void 0:db.Wa("SlideCount",Sb.length.toString());kc=this.Eb.xd(15,void 0,()=>{this.Fa.Bd();this.pa.nh()});try{kc.hc(this.ta.Ba);kc.fd=jb;for(const Kb of Sb)Kb.vrc=!0}finally{kc&&kc.dispose()}return 32};this.ia=A;this.Fa=W;this.$b=na;this.pa=Ga;this.Eb=Ka;this.u5=qb;this.ta=Qb;this.NB=t;this.vR=Y;this.tCe=pa;this.Ud=Ja;this.Ea=Ya}vb(){this.ia.ra(fd.a.Hta,Lc.a.application,Object(n.a)(this,this.EFj,"handleSlidesSolidFill"),4);this.ia.ra(fd.a.A8d,
Lc.a.application,Object(n.a)(this,this.CFj,"handleSlidesPicture"),4);this.ia.ra(fd.a.z8d,Lc.a.application,Object(n.a)(this,this.AFj,"handleSlidesFinalizePicture"),4);this.ia.ra(fd.a.wTc,Lc.a.application,Object(n.a)(this,this.gzj,"handleApplyAll"),4);this.ia.ra(fd.a.qPe,Lc.a.application,Object(n.a)(this,this.yDj,"handlePopulateFillMenu"),96);this.ia.ra(fd.a.w4g,Lc.a.application,Object(n.a)(this,this.BCj,"handleMoreFormatBackgroundColors"),96);this.ia.ra(fd.a.LPe,Lc.a.application,Object(n.a)(this,this.CCj,
"handleMoreFormatBackgroundColorsResponse"),4);this.ia.ra(fd.a.xTc,Lc.a.application,this.zFj,4)}pe(){}yDj(A,W,na,Ga,Ka){A=this.ta.Ba;if(!A||this.$b.$c(A))return 16;if(1===na)return 32;if(!Ka)return bd.a.J(512500616,822,10,"HandlePopulateFillMenu requires actionData"),8;na=A.Ed;if(!na)return bd.a.J(512500615,822,10,"HandlePopulateFillMenu failed to get theme information from slide"),8;A=this.u5.Ef.dda;W=Object.assign(new sh.a,{Id:"PptRibbon.Drawing.ShapeFill",MenuSectionList:[]});Array.add(W.MenuSectionList,
Zd.f(na,"Theme Colors","Color.Menu.Controls","themeColor","FormatBackgroundThemeColors","3049223287",1));Array.add(W.MenuSectionList,Zd.d("Standard Colors","Color.Menu.Controls","standardColor","FormatBackgroundStandardColors","3049223287",!1));A&&0<A.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!1)),Array.add(W.MenuSectionList,Zd.c(A,"Recent Colors","Color.Menu.Controls","recentColor","FormatBackgroundRecentColors","1912773268",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",
!0));Array.add(W.MenuSectionList,Zd.a("More Format Background Color","Color.Menu.Controls","3938657252",ResourceStrings.l_MoreFormatBackgroundColors,"Color.Menu.MoreFormatBackgroundColors","MoreFormatBackgroundColors","per_AppointmentColor0_16x16x32",ResourceStrings.l_MoreFormatBackgroundColorsKeytip));Ka.MenuItems=W;return 32}EFj(A,W,na,Ga,Ka){W=this.pa.Se();if(!W||!W.length)return 16;for(const qb of W)if(!qb||this.$b.$c(qb))return 16;if(1===na)return 32;na=Sg.Okd(Ka);if(!na)return 8;xf.a.Kb&&xf.a.Kb.Wa("SlideCount",
W.length.toString());Ka=this.Eb.xd(15,void 0,()=>{this.Fa.Bd();this.pa.nh()});try{Ka.hc(this.ta.Ba);Ka.fd=A;for(const qb of W)qb.Etb=na}finally{Ka&&Ka.dispose()}return 32}CFj(A,W,na){this.sYd=this.ta.Ba;A=this.pa.Se();if(!A||!A.length)return 16;for(const Ga of A)if(!Ga||this.$b.$c(Ga)||ah.a.Cw(Ga.Db))return 16;if(1===na)return 32;this.wud(!1);return 32}gzj(A,W,na){W=this.ta.Ba;if(!W||this.$b.$c(W))return 16;if(1===na)return 32;na=W.Db;W=this.u5.Ef;if(!W)return 8;const Ga=this.Eb.xd(15,void 0,()=>
{this.Fa.Bd();this.pa.nh()});try{Ga.hc(W),Ga.fd=A,W.gtb=na}finally{Ga&&Ga.dispose()}return 32}Zrl(A){const W=this.u5.Ef;if(!W)return bd.a.J(509362197,822,10,"FormatBackgroundActor::shouldEnableResetBackground: Current presentation is null"),!1;for(const Ga of A)if((A=Ga.gT)&&-1==A.indexOf("/BgSource/ContentMaster")&&-1==A.indexOf("/BgSource/MainMaster")){var na=W.o5i(Ga.jj,Ga.Ln);if(!na)return bd.a.J(509362196,822,50,"FormatBackgroundActor::shouldEnableResetBackground: Slide master for current slide is null"),
!0;na=na.gT;if(!na||!A.match(na))return!0}return!1}AFj(A,W,na,Ga,Ka){W=this.pa.Se();if(!W||!W.length)return 16;for(const Qb of W)if(!Qb||!Qb.isConnected)return 16;if(1===na)return 32;this.vR.Rib=new Date;const qb=xf.a.Kb;this.NB.I3e(Ka,Qb=>{xf.a.SI(qb,()=>{this.DFj(Qb,A)})},Qb=>{this.D9b(Qb.error)});this.ta.Ba===this.sYd&&(this.Fa.Bd(),this.pa.nh());return 32}BCj(A,W,na,Ga,Ka){A=this.ta.Ba;if(!A||this.$b.$c(A))return bd.a.J(512500611,822,10,"HandleMoreFormatBackgroundColors: currentSlide is null"),
16;if(this.Ea.gD&&Rg.a("MoreColorBackgroundForMultipleSlidesEnabled")?1>this.pa.Se().length:1!==this.pa.Se().length)return 16;if(1===na)return this.ia.Ka(fd.a.renderColorPicker,1,Ka);na=Qd.a.parse(A.gT);if(!na)return 8;Ka=na.RMa();na=null;Ka&&(na=De.Box4ColorHelper.Jta(Ka));Ka={};Ka.currentColor=na;Ka.handleCommand=fd.a.LPe;return this.ia.Ka(fd.a.renderColorPicker,2,Ka)}CCj(A,W,na,Ga,Ka){if(1===na)return this.ia.Ka(fd.a.Hta,na,Ka);if(!Ka)return bd.a.J(512500609,822,10,"HandleMoreFormatBackgroundColorsResponse: actionData is null"),
16;A=this.ia.Ka(fd.a.Hta,na,Ka);32===A&&this.ia.Ka(fd.a.xCa,na,Ka);return A}wud(A){this.tCe?Gg.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):this.NB&&(this.NB.kRb=1,this.NB.Mih(A))}DFj(A,W){this.vR.G_a=new Date;(A=A.result)?this.oyi(A,W):(W=Object.assign(new Kd.a,{Code:94}),this.D9b(W))}oyi(A,W){const na=this.pa.Se(),Ga=this.Eb.xd(15);try{Ga.hc(this.sYd);Ga.fd=W;for(const Ka of na)Ka.bD=A.ItemId}finally{Ga&&Ga.dispose()}if(A=xf.a.Kb)A.actionName="FormatBackgroundPicture",
A.Wa("PictureUploadStart",xf.a.uf(this.vR.Rib)),A.Wa("PictureUploadDurationMS",(+this.vR.G_a-+this.vR.Rib).toString())}D9b(A){this.vR.G_a=new Date;this.Ud.nH(A.Code,W=>{W.KC=1;W.bTa=A.ExtraErrorParam;return!1})}static Okd(A){return Qd.a.parse(A.Color)}}Object(h.a)(Sg,"FormatBackgroundActor",null,[251]);var Wh=d(75),Bg=d(34),oh=d(423),Yj=d(32),Gh=d(158);const Xh=A=>{let W=A.isBold?"b:1;":"";W+=A.isItalic?"i:1;":"";W+=A.xE?"u:1;":"";W+=A.bG?"s:1;":"";W+=A.isSuperscript?"sup:1;":"";return W+=A.cG?"sub:1;":
""},Yg=(A,W,na)=>{let Ga=null;for(var Ka,qb=Bg.ParagraphReader.text(A),Qb=0;A.Ta&&Qb<A.Ta.length;){var t=A.Ta.ga(Qb),Y=t.cp;Ka=Qb<A.Ta.length-1?A.Ta.ga(Qb+1).cp:Bg.ParagraphReader.textLength(A);if(-1!==W&&Ka<=W)Qb++;else{if(-1!==na&&Y>na)break;var pa="";t.formatting?pa=Xh(t.formatting.cache):(t=oh.c(A.Ta,t.cp).j4c)&&(pa=Xh(t.cache));t=Y;-1!==W&&(t=Math.max(W,Y));Y=Ka;-1!==na&&(Y=Math.min(na,Ka));Y=ob.a.substring(qb,t,Y);0<Y.length&&(Ka=document.createElement("span"),Ka.setAttribute("style",pa),Ka.innerText=
Y,Ga||(Ga=document.createElement("p")),Ga.appendChild(Ka));Qb++}}if(Ga&&Bg.ParagraphReader.gX(A)){W=Ga;na=W.setAttribute;Qb=new Yj.GraphIterator;Qb.set(A);Qb.sc(11);Qb.Kg(11);qb="";if(A.Uf.Gv(Qb))switch(Qb=A.Uf.Gv(Qb),A=Bg.ParagraphReader.Hib(A),pa=Qb.oX,Qb.listType){case 0:switch(Qb.listStyle){case 1:qb="decimal";break;case 2:qb="loweralpha";break;case 3:qb="lowerroman";break;case 4:qb="upperalpha";break;case 5:qb="upperroman";break;default:qb="decimal"}qb=String.format("lt:{0};in:{1};li:{2}",qb,
A,pa);break;case 1:switch(Qb.listStyle){case 1:qb="disc";break;case 2:qb="circle";break;case 3:qb="square";break;default:qb="disc"}qb=String.format("lt:{0};in:{1}",qb,A)}na.call(W,"style",qb)}return Ga},dg=A=>{if(A){var W;(W=I.a.instance.resolve("PowerPointWebEditor.Graph.ITableReader"))?W=W.ZN(A):(bd.a.J(512500561,822,10,"ImmersiveReader: TableReader is null."),W=null);if(W){A=null;W=W.Bab();for(let na=0;na<W.length;na++){const Ga=Od(Object(z.a)(Wh.AParagraphNode,W[na].m6b));A=We(Ga,A)}return A}A=
Array.isArray(A.nz())?A.nz():null;return Od(A&&0<A.length?A[0]:null)}return null},Od=A=>{let W=null;for(;A;){const na=Yg(A,-1,-1);W=We(na,W);A=Bg.ParagraphReader.eua(A,!1,!0,!1)}return W},We=(A,W)=>{A&&(W||(W=document.createElement("div")),W.appendChild(A));return W},Zj=A=>{const W=Object.assign(new Gh.a,{Source:6});I.a.instance.resolve("PowerPointWebEditor.IErrorHandler").Ds(W,A,na=>{na.KC=1;na.bDa=0;na.title=ResourceStrings.L_ImmersiveReaderErrorDialogTitle;na.message=ResourceStrings.L_ImmersiveReaderErrorDialogMessage;
return!1})};class ij{constructor(A,W,na,Ga){this.dGg=!1;this.ndd="";this.ia=A;this.Fa=W;this.kb=na;const Ka=new Date;Ga("immersiveReader").then(()=>{this.dGg=!0;bd.a.J(512500569,822,50,"ImmersiveReader: Loaded SDK successfully. Duration (ms): {0}",+new Date-+Ka)}).catch(qb=>{const Qb=+new Date-+Ka;bd.a.J(512500568,822,10,"ImmersiveReader: Failed to load SDK. Duration (ms): {0}, Exception: {1} ",Qb,qb.toString());const t=new Map;t.set("JSLoadDurationInMs",Qb.toString());t.set("Exception",qb.toString());
B.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","JSLoadFailed",!1,!0,Object.assign(new ka.a,{extendedProperties:t}))})}vb(){this.ia.ya(fd.a.immersiveReader,Lc.a.view,Object(n.a)(this,this.$ig,"immersiveReaderHandler"));this.ia.ya(fd.a.nhe,Lc.a.view,Object(n.a)(this,this.$ig,"immersiveReaderHandler"))}pe(){this.Fa.Fc(lf.a.vQ).bindAction(wc.KeyInputManager.Qa(nd.a.Wxc,wc.KeyInputManager.Re|4),fd.a.immersiveReader)}faj(A){let W="";for(A=Object(z.a)(Wh.AParagraphNode,A.node);A;){const na=
Bg.ParagraphReader.eua(A,!0,!0,!1);if(na)A=na;else break}for(;A;)W+="\n"+Bg.ParagraphReader.text(A),A=Bg.ParagraphReader.eua(A,!1,!0,!1);return W}Wri(){var A=this.kb.Se();let W=null;if(!A)return null;for(const na of A)if(A=na.sUa())for(const Ga of A)A=dg(Ga),W=We(A,W);return W}Vri(){let A=null;var W=this.kb.Pa;if(!W)return null;for(let Ka of W)if(Ka)for(W=0;W<Ka.length;W++){var na=Ka.ga(W),Ga=null;if(na.contextId===Lc.a.outline||na.contextId===Lc.a.Mf)if(Bg.ParagraphReader.ae(na.node)){for(na=Object(z.a)(Wh.AParagraphNode,
na.node);na;)if(Ga=Bg.ParagraphReader.eua(na,!0,!0,!1))na=Ga;else break;Ga=Od(na)}else Ga=dg(Object(z.a)(4,na.node));else na.contextId!==Lc.a.endOfParagraph&&Bg.ParagraphReader.ae(na.node)&&(Ga=Yg(Object(z.a)(Wh.AParagraphNode,na.node),na.Sa,na.Mb));A=We(Ga,A)}return A}$ri(){let A;return(A=this.kb.Fs()?this.Wri():this.Vri())?A.innerHTML:""}Nuj(){let A="";const W=this.kb.Pa.mb;if(W)for(let na=0;na<W.length;na++){const Ga=W.ga(na),Ka=Ga.Sa,qb=Ga.Mb-Ka;let Qb;if(Bg.ParagraphReader.ae(Ga.node))switch(Qb=
Ga.node.characterData,Ga.contextId){case Lc.a.paragraph:A+=Qb+"\r";break;case Lc.a.textRange:0<qb&&(A+=Qb.substr(Ka,qb));break;case Lc.a.endOfParagraph:A+="\r";break;case Lc.a.Mf:A+=this.faj(Ga)}}return A}Fug(){const A=new XMLHttpRequest,W=I.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;var na=I.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;na=String.format("{0}PodHandler.ashx?action=ImmersiveReaderAuthToken&PodSID={1}",na,W);A.open("GET",
na,!0);const Ga=aa.a.create().toString();A.setRequestHeader("X-UserSessionId",M.AFrameworkApplication.userSessionId);A.setRequestHeader("X-CorrelationID",Ga);A.setRequestHeader("X-WacCluster",I.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").Ek);let Ka=null;const qb=new Map;A.onreadystatechange=()=>{if(4===A.readyState)if(200===A.status){var Qb=+new Date-+Ka;bd.a.J(512500567,822,50,"ImmersiveReader: auth token received. Duration (ms): {0}",Qb);qb.set("AuthTokenDurationInMs",Qb.toString());
Qb=A.responseText.replace('"',"");const t=new Date,Y=Rg.a("EnableSendingHTMLToIR")?[{["content"]:this.ndd,["mimeType"]:"text/html"}]:[{["content"]:this.ndd}];immersiveReader.launchAsync(Qb,null,{["title"]:ResourceStrings.L_ImmersiveReaderDialogTitle,["chunks"]:Y},null).then(pa=>{pa=(pa=Object(z.a)(Object,pa))?pa.sessionId:"";const Ja=+new Date-+t,Ya=+new Date-+Ka;bd.a.J(512500566,822,50,"ImmersiveReader: IR Pane launched successfully. Duration (ms) of LaunchAsync(): {0}, IR response sessionId: {1}",
Ja,pa);qb.set("LaunchAsyncDurationInMs",Ja.toString());qb.set("IRResponseSessionId",pa);qb.set("UserPerceivedDurationInMs",Ya.toString());B.Health.instance.recordKpiSuccess("ImmersiveReaderTriggered",Object.assign(new ka.a,{extendedProperties:qb}))}).catch(pa=>{Zj(W);const Ja=+new Date-+t,Ya=+new Date-+Ka;bd.a.J(512500565,822,10,"ImmersiveReader: LaunchAsync failed. Duration (ms): {0}, ErrorJson: {1}",Ja,pa);qb.set("LaunchAsyncDurationInMs",Ja.toString());qb.set("ErrorJson",pa.toString());qb.set("UserPerceivedDurationInMs",
Ya.toString());B.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","LaunchAsyncFailed",!1,!0,Object.assign(new ka.a,{extendedProperties:qb}))})}else Zj(W),Qb=+new Date-+Ka,bd.a.J(512500564,822,10,"ImmersiveReader: Request for auth token failed. Duration (ms): {0}, statusCode:{1}, CorrelationId: {2}",Qb,A.status,Ga),qb.set("CorrelationId",Ga),qb.set("StatusCode",A.status.toString()),qb.set("UserPerceivedDurationInMs",Qb.toString()),B.Health.instance.recordKpiFailure("ImmersiveReaderTriggered",
"RequestForAuthTokenFailed",!1,!0,Object.assign(new ka.a,{extendedProperties:qb}));else bd.a.J(512500563,822,15,"Immersive Reader auth token request in progress. CorrelationId: {0}, Request Status: {1}",Ga,A.status)};Ka=new Date;bd.a.J(512500562,822,50,"Begin request for ImmersiveReader auth token. StartTime: {0}, CorrelationId: {1}",Ka.getTime(),Ga);na=new Map;na.set("CorrelationId",Ga);na.set("Info","RequestingAuthToken");B.Health.instance.recordKpiUsage("ImmersiveReaderTriggered",1,null,na);A.send(null)}$ig(A,
W,na){if(1===na||6===this.ia.eq){if(!this.dGg)return 8;this.ndd=Rg.a("EnableSendingHTMLToIR")?this.$ri():this.Nuj();if(""===this.ndd)return 8}2===na&&this.Fug();return 32}}Object(h.a)(ij,"ImmersiveReaderActor",null,[251]);var Wd=d(590),ki=d(804);class xi{constructor(A){this.customData=null;this.yQ=A}}Object(h.a)(xi,"PropertySetChangedState",null,[]);class Pg{static RTk(A,W,na){if(A&&W){var Ga=new xi(W),Ka=(qb,Qb,t)=>{na.QTk(qb,Qb,t,Ga)};A=new ki.a(W,A);A.tJc=Ka;A.hMc=Ka;A.kpd=Ka;A.tga()}}}Object(h.a)(Pg,
"PropertySetChangedManager",null,[]);class Ej{constructor(A){this.c5h=A}QTk(A,W,na,Ga){const Ka=this.c5h[A.id.toString()];Ka&&Ka(A,W,na,Ga)}}Object(h.a)(Ej,"PropertyChangedProcessor",null,[]);var Hh=d(1130),gh=d(445),Ie=d(60),eg=d(589),yi=d(406),Fj=d(985);class Yh{constructor(){this.zRe=this.J4c=this.QZc=null}}Object(h.a)(Yh,"ParagraphDialogResults",null,[]);class ei extends xb.a{constructor(A,W,na){super(void 0,void 0,!0);this.Sva=null;if(null===A)throw Error.argumentNull("properties");this.ifa=
A.clone();this.E$=A.clone();this.LB=na;this.ia=W;this.Eok=new Za.a(Object(n.a)(this,this.ENi,"createPropertyChangedHandlers"))}Ztd(){this.kg="ParagraphDialog";const A={};A.bodyControls=this.B9d();this.pj(ResourceStrings.L_ParagraphDialogTitle,Object(n.a)(this,this.u3d,"dialogResultHandler"),A)}u3d(A,W){1===A&&(this.IPl(W),A=Object.assign(new Yh,{QZc:this.ifa,J4c:this.E$,zRe:this.Eok}),this.ia.Ka(fd.a.lMf,2,A));this.dispose()}B9d(){this.Sva=ei.t$d();const A={};this.yFi(A);this.MEi(A);var W=Fj.a("Inch",
3,0,56,.1);const na=Fj.a("Character",2,0,56,.1);W=[W,na];this.aGi(A,W);this.REi(A,W);W=[Fj.a("Point",5,0,1584,1)];this.SEi(A,W);this.LEi(A,W);this.zFi(A);return A}IPl(A){this.QMl(A);this.AQl(A);this.eNl(A);this.fNl(A);this.OMl(A);this.VOl(A)}ENi(){const A={};A[Ie.a.yE.id.toString()]=Object(n.a)(this.LB,this.LB.Q6j,"justificationChangedHandler");A[Ie.a.yJb.id.toString()]=Object(n.a)(this.LB,this.LB.Pdh,"paraIndentLeftChangedHandler");A[Ie.a.zJb.id.toString()]=Object(n.a)(this.LB,this.LB.Pdh,"paraIndentLeftChangedHandler");
A[Ie.a.Sga.id.toString()]=Object(n.a)(this.LB,this.LB.m3e,"specialIndentChangedHandler");A[Ie.a.$Ob.id.toString()]=Object(n.a)(this.LB,this.LB.m3e,"specialIndentChangedHandler");A[Ie.a.aPb.id.toString()]=Object(n.a)(this.LB,this.LB.m3e,"specialIndentChangedHandler");A[Ie.a.Jx.id.toString()]=Object(n.a)(this.LB,this.LB.S8j,"lineSpacingChangedHandler");A[Ie.a.CJb.id.toString()]=Object(n.a)(this.LB,this.LB.Sdh,"paraSpacingAfterChangedHandler");A[Ie.a.BJb.id.toString()]=Object(n.a)(this.LB,this.LB.Sdh,
"paraSpacingAfterChangedHandler");A[Ie.a.FJb.id.toString()]=Object(n.a)(this.LB,this.LB.Udh,"paraSpacingBeforeChangedHandler");A[Ie.a.EJb.id.toString()]=Object(n.a)(this.LB,this.LB.Udh,"paraSpacingBeforeChangedHandler");return A}zFi(A){var W=ei.hkj(this.ifa),na="multiple"===W;A.lineSpacingComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,["showLabel"]:!0,
["options"]:Fj.b([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],["1.00","1.50","2.00","multiple"]),["selectedKey"]:W,["allowFreeForm"]:!1};W=0;let Ga=!1;this.ifa.Ua(Ie.a.Jx)&&na&&(W=this.ifa.eb(Ie.a.Jx),0<=W&&(Ga=!0));na=[Fj.a("none",0,0,9.99,.5)];na={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,["unitType"]:"none",["validUnits"]:na,["numberFormatInfo"]:this.Sva,["validReservedValues"]:[""]};na.value=Ga?W:"";A.atSpinButtonProps=na}LEi(A,W){A.afterSpacingSpinButtonProps=ei.atd(ei.j4f(this.ifa,Ie.a.CJb,Ie.a.BJb),{["type"]:"AppSpinButtonProps",["id"]:"AfterSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,["unitType"]:eg.a.S2b(5),
["validUnits"]:W,["numberFormatInfo"]:this.Sva,["validReservedValues"]:[""]})}SEi(A,W){A.beforeSpacingSpinButtonProps=ei.atd(ei.j4f(this.ifa,Ie.a.FJb,Ie.a.EJb),{["type"]:"AppSpinButtonProps",["id"]:"BeforeSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,["unitType"]:eg.a.S2b(5),["validUnits"]:W,["numberFormatInfo"]:this.Sva,["validReservedValues"]:[""]})}REi(A,W){let na,Ga;({fdh:Ga,gdh:na}=ei.Y7f(this.ifa,
Ie.a.zJb,Ie.a.yJb,!1));W={["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,["unitType"]:eg.a.S2b(na),["validUnits"]:W,["numberFormatInfo"]:this.Sva,["validReservedValues"]:[""]};W=ei.atd(Ga,W);A.beforeTextSpinButtonProps=W}aGi(A,W){var na={["type"]:"AppComboBoxProps",["id"]:"SpecialComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,
["showLabel"]:!0,["options"]:Fj.b([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],["0","1","2"]),["allowFreeForm"]:!1},Ga=this.ifa.Ua(Ie.a.Sga)?this.ifa.eb(Ie.a.Sga):-1;ei.asg(Ga)?na.selectedKey=Ga.toString():na.defaultSelectedKey="";A.specialIndentationComboBoxProps=na;({fdh:na,gdh:Ga}=ei.Y7f(this.ifa,Ie.a.aPb,Ie.a.$Ob,1!==Ga&&2!==Ga));W={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,["unitType"]:eg.a.S2b(Ga),["validUnits"]:W,["numberFormatInfo"]:this.Sva};W=ei.atd(na,W);A.bySpinButtonProps=W}MEi(A){const W={["type"]:"AppComboBoxProps",["id"]:"AlignmentComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,["showLabel"]:!0,["options"]:Fj.b([Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,
Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified],["1","2","3","6"]),["allowFreeForm"]:!1},na=this.ifa.Ua(Ie.a.yE)?this.ifa.eb(Ie.a.yE):0;ei.TYj(na)?W.selectedKey=na.toString():W.defaultSelectedKey="";A.alignmentComboBoxProps=W}yFi(A){A.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,["forId"]:"GeneralGroup"};A.indentationLabelProps=
{["type"]:"AppLabelProps",["id"]:"IndentationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};A.spacingLabelProps={["type"]:"AppLabelProps",["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,["forId"]:"SpacingGroup"}}VOl(A){if(A.lineSpacingComboBoxProps){var W=A.lineSpacingComboBoxProps;const na=W.selectedKey?W.selectedKey.toString():"";W=Fj.c(na);"multiple"===na&&(A=A.atSpinButtonProps)&&(W=parseFloat(A.value.toString()));
this.E$.setValue(Ie.a.Jx,W);this.E$.setValue(Ie.a.qX,2)}}OMl(A){if(A.afterSpacingSpinButtonProps){A=A.afterSpacingSpinButtonProps;var W=eg.a.R2b(A.unitType.toString().toLowerCase());""!==A.value.toString()&&(W=4===W?2:4,this.E$.setValue(Ie.a.CJb,parseInt(A.value.toString())),this.E$.setValue(Ie.a.BJb,W))}}fNl(A){if(A.beforeSpacingSpinButtonProps){A=A.beforeSpacingSpinButtonProps;var W=eg.a.R2b(A.unitType.toString().toLowerCase());""!==A.value.toString()&&(W=4===W?2:4,this.E$.setValue(Ie.a.FJb,parseInt(A.value.toString())),
this.E$.setValue(Ie.a.EJb,W))}}eNl(A){if(A.beforeTextSpinButtonProps){var W=A.beforeTextSpinButtonProps;A=eg.a.R2b(W.unitType.toString().toLowerCase());if(""!==W.value.toString()){W=parseFloat(W.value.toString());let na;2===A?na=2:(na=1,W=eg.a.ELh(W,A));this.E$.setValue(Ie.a.zJb,W);this.E$.setValue(Ie.a.yJb,na)}}}AQl(A){var W=A.bySpinButtonProps,na=A.didChangeSpecialIndentationComboBoxValue;if(W&&""!==W.value.toString()||na)if(A.specialIndentationComboBoxProps&&(A=A.specialIndentationComboBoxProps,
na=-1,A.selectedKey&&(A=A.selectedKey.toString(),na=parseInt(A)),ei.asg(na)&&this.E$.setValue(Ie.a.Sga,na)),W){A=parseFloat(W.value.toString());W=eg.a.R2b(W.unitType.toString().toLowerCase());if(0>A||isNaN(A))A=0;2===W?na=2:(na=1,A=eg.a.ELh(A,W));this.E$.setValue(Ie.a.aPb,A);this.E$.setValue(Ie.a.$Ob,na)}}QMl(A){A.alignmentComboBoxProps&&(A=A.alignmentComboBoxProps,A.selectedKey&&(A=parseInt(A.selectedKey.toString()),0<=A&&this.E$.setValue(Ie.a.yE,A)))}static j4f(A,W,na){if(A.Ua(W)&&A.Ua(na)){na=
A.eb(na);if(2!==na&&4!==na)return Number.NaN;A=A.eb(W);2===na&&(A*=ei.ZOk);return A}return Number.NaN}static atd(A,W){W.value=isNaN(A)?"":A;return W}static t$d(){return{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}}static Y7f(A,W,na,Ga){let Ka=3;Rg.a("BySpinButtonDefaultvalueFix")&&Ga?W=0:A.Ua(W)&&A.Ua(na)&&!Ga?(W=A.eb(W),2===A.eb(na)?Ka=2:W=eg.a.eTl(W,Ka)):W=Number.NaN;return{fdh:W,
gdh:Ka}}static TYj(A){return 1===A||2===A||3===A||6===A}static asg(A){return 1===A||2===A||0===A}static hkj(A){if(ei.qHj(A)){A=A.eb(Ie.a.Jx);var W="multiple";yi.a.qz(A,1)?W="1.00":yi.a.qz(A,1.5)?W="1.50":yi.a.qz(A,2)&&(W="2.00");return W}}static qHj(A){return A.Ua(Ie.a.Jx)&&A.Ua(Ie.a.qX)&&2===A.eb(Ie.a.qX)?!0:!1}}ei.ZOk=72;Object(h.a)(ei,"ReactParagraphDialog",xb.a,[]);class Hi{constructor(A,W,na,Ga,Ka,qb,Qb,t,Y,pa,Ja){this.Pve=[];this.ia=A;this.pa=W;this.Afa=na;this.J$=Ga;this.Eb=Ka;this.Gh=qb;this.vIa=
Qb;this.Ga=t;this.LB=Y;this.xfa=pa;this.Z_g=Ja}vb(){this.ia.ra(fd.a.sCb,Lc.a.application,Object(n.a)(this,this.uLk,"paragraphDialogHandler"),4);this.ia.ra(fd.a.lMf,Lc.a.application,Object(n.a)(this,this.MDi,"commitParagraphDialogHandler"),4);this.ia.ra(fd.a.vjh,Lc.a.view,gh.a.z1,96);this.ia.ra(fd.a.ljh,Lc.a.view,gh.a.z1,96);this.ia.ra(fd.a.Ijh,Lc.a.view,gh.a.z1,96);this.ia.ra(fd.a.Jjh,Lc.a.view,gh.a.z1,96);this.ia.ra(fd.a.Hjh,Lc.a.view,gh.a.z1,96);this.ia.ra(fd.a.Gjh,Lc.a.view,gh.a.z1,96);this.ia.ra(fd.a.pjh,
Lc.a.view,gh.a.z1,96);this.ia.ra(fd.a.qjh,Lc.a.view,gh.a.z1,96);this.ia.ya(fd.a.Tch,Lc.a.view,gh.a.oH);this.ia.ya(fd.a.rEh,Lc.a.view,gh.a.oH);this.ia.ya(fd.a.ljg,Lc.a.view,gh.a.oH);this.ia.ya(fd.a.uEh,Lc.a.view,gh.a.oH);this.ia.ya(fd.a.tEh,Lc.a.view,gh.a.oH);this.ia.ya(fd.a.Uch,Lc.a.view,gh.a.oH);this.ia.ya(fd.a.Vch,Lc.a.view,gh.a.oH);this.ia.ya(fd.a.Pch,Lc.a.view,gh.a.oH);this.ia.ya(fd.a.sEh,Lc.a.view,gh.a.oH);this.ia.ya(fd.a.Och,Lc.a.view,gh.a.oH);this.ia.ya(fd.a.Xch,Lc.a.view,gh.a.oH);this.ia.ya(fd.a.Wch,
Lc.a.view,gh.a.oH);this.ia.ya(fd.a.vEh,Lc.a.view,gh.a.oH);this.ia.ya(fd.a.Vmd,Lc.a.paragraph,Object(n.a)(this,this.Eoj,"getPropertiesForParagraphDialog"));this.ia.ya(fd.a.Vmd,Lc.a.view,this.xfa);this.ia.he(fd.a.Vmd,96)}pe(){}uLk(A,W,na){if(this.pa.Fs()||this.pa.D9())return 16;A=this.pa.Xd();if(!this.Ga.K_(A,!0).length&&!this.pa.Jla())return 16;if(1===na)return 32;this.Z_g&&bd.a.J(25040911,820,50,"Setting Paragraph properties from: {0}, IsDialogLancherButton: {1}",this.ia.eq,"PptRibbon.Home"===this.ia.Dsa);
Array.clear(this.Pve);this.ia.processAction(fd.a.Vmd,2);return(na=Wd.APropertySet.njj(this.Pve))?((new ei(na,this.ia,this.LB)).Ztd(),32):16}MDi(A,W,na,Ga,Ka){if(1===na)return 32;if(!(Ka&&Ka.QZc&&Ka.J4c&&Ka.zRe))return 16;W=this.pa.hk();this.LB.vMj();na=this.Eb.je(15);try{na.hc(W),na.fd=A,Ka.QZc.equals(Ka.J4c)||this.nCi(),Pg.RTk(Ka.QZc,Ka.J4c,new Ej(Ka.zRe.value))}finally{na&&na.dispose()}if(this.Z_g){let qb;({rSh:A,sSh:Ka,uSh:W,tSh:na,qSh:Ga,vSh:qb}=this.LB.IEl());bd.a.J(25040909,820,50,"IsJustificationChanged: {0}, IsLnSpacChanged: {1}, IsSpaceBeforeChanged: {2}, IsSpaceAfterChanged: {3}, IsIndentLeftChanged: {4}, IsSpecialIndentChanged: {5}",
A,Ka,W,na,Ga,qb)}xf.a.AP(!0,!0);return 32}Eoj(A,W,na){if(1===na)return 32;W=W.node;A=new Hh.DictionaryPropertySet;A.setValue(Ie.a.yE,this.Gh.CL(W));na=this.Afa.iUa(W);A.setValue(Ie.a.qX,na.unit);A.setValue(Ie.a.Jx,na.value);na=this.Afa.VW(W);A.setValue(Ie.a.EJb,na.beforeSpacing.unit);A.setValue(Ie.a.FJb,na.beforeSpacing.value);A.setValue(Ie.a.BJb,na.afterSpacing.unit);A.setValue(Ie.a.CJb,na.afterSpacing.value);na=this.J$.c9(W);A.setValue(Ie.a.yJb,1);A.setValue(Ie.a.zJb,na.oN);W=this.vIa.tUa(W);A.setValue(Ie.a.Sga,
W.specialIndentType);A.setValue(Ie.a.$Ob,W.unit);A.setValue(Ie.a.aPb,W.value);this.Pve.push(A);return 32}nCi(){if(this.pa.rH()){var A=this.pa.Xd();A=this.Ga.K_(A);for(const W of A)W.Gta()}}}Object(h.a)(Hi,"ParagraphDialogActor",null,[251]);var yh;(function(A){A[A.unspecified=-1]="unspecified";A[A.none=0]="none";A[A.left=1]="left";A[A.center=2]="center";A[A.right=3]="right";A[A.inner=4]="inner";A[A.outer=5]="outer";A[A.both=6]="both";A[A.distribute=7]="distribute";A[A.margin=8]="margin";A[A.highKashida=
9]="highKashida";A[A.lowKashida=10]="lowKashida";A[A.mediumKashida=11]="mediumKashida";A[A.numTab=12]="numTab";A[A.thaiDistribute=13]="thaiDistribute";A[A.start=14]="start";A[A.end=15]="end"})(yh||(yh={}));Object(h.b)("Justification",yh);var La=d(586);class sb{constructor(){this.value=this.unit=0}}Object(h.a)(sb,"ParagraphSpacingCommandData",null,[]);class Ob{constructor(){this.nEh=this.Qdh=this.Tdh=this.Vdh=!1}}Object(h.a)(Ob,"PptPropertySetChangedState",null,[]);class pc{constructor(A){this.Ype=
this.coe=this.Wpe=this.Xpe=this.roe=this.joe=!1;this.shc={};this.ia=A;this.AMj()}Q6j(A,W,na){na&&(A=this.shc[yh[na]],void 0!==A&&null!==A&&(this.ia.processAction(A,2),this.joe=!0))}S8j(A,W,na){void 0!==na&&null!==na&&(this.ia.Ka(fd.a.woa,2,na),this.roe=!0)}Udh(A,W,na,Ga){void 0!==na&&null!==na&&(A=pc.kUc(Ga),!A.Vdh&&null!==Ga&&Ga.yQ.Ua(Ie.a.EJb)&&Ga.yQ.Ua(Ie.a.FJb)&&(W=Ga.yQ.eb(Ie.a.FJb),Ga=Ga.yQ.eb(Ie.a.EJb),A.Vdh=!0,this.ia.Ka(fd.a.ulb,2,Object.assign(new sb,{value:W,unit:Ga})),this.Xpe=!0))}Sdh(A,
W,na,Ga){void 0!==na&&null!==na&&(A=pc.kUc(Ga),!A.Tdh&&null!==Ga&&Ga.yQ.Ua(Ie.a.BJb)&&Ga.yQ.Ua(Ie.a.CJb)&&(W=Ga.yQ.eb(Ie.a.CJb),Ga=Ga.yQ.eb(Ie.a.BJb),A.Tdh=!0,this.ia.Ka(fd.a.tlb,2,Object.assign(new sb,{value:W,unit:Ga})),this.Wpe=!0))}Pdh(A,W,na,Ga){void 0!==na&&null!==na&&(W=pc.kUc(Ga),!W.Qdh&&null!==Ga&&Ga.yQ.Ua(Ie.a.yJb)&&Ga.yQ.Ua(Ie.a.zJb)&&(A=Ga.yQ.eb(Ie.a.zJb),Ga=Ga.yQ.eb(Ie.a.yJb),W.Qdh=!0,W=new La.a,W.unit=Ga,W.value=A,this.ia.Ka(fd.a.nla,2,W),this.coe=!0))}m3e(A,W,na,Ga){void 0!==na&&null!==
na&&(na=pc.kUc(Ga),!na.nEh&&null!==Ga&&Ga.yQ.Ua(Ie.a.$Ob)&&Ga.yQ.Ua(Ie.a.aPb)&&(W=0,Ga.yQ.Ua(Ie.a.Sga)&&(W=Ga.yQ.eb(Ie.a.Sga)),A=Ga.yQ.eb(Ie.a.aPb),Ga=Ga.yQ.eb(Ie.a.$Ob),na.nEh=!0,na=0,1===W?na=fd.a.WNb:2===W?na=fd.a.YNb:0===W&&(na=fd.a.$Nb),W=new La.a,W.unit=Ga,W.value=A,this.ia.Ka(na,2,W),this.Ype=!0))}IEl(){return{rSh:this.joe,sSh:this.roe,uSh:this.Xpe,tSh:this.Wpe,qSh:this.coe,vSh:this.Ype}}vMj(){this.Ype=this.coe=this.Wpe=this.Xpe=this.roe=this.joe=!1}AMj(){this.shc.left=de.a.leftJustify;this.shc.center=
de.a.centerJustify;this.shc.right=de.a.rightJustify;this.shc.both=de.a.fullJustify}static kUc(A){A.customData||(A.customData=new Ob);return A.customData}}Object(h.a)(pc,"ParagraphLevelPropertyChangedHandlers",null,[658]);var Kc=d(542),Gd=d(205),he=d(269),Ue=d(354),Rf=d(41),sf=d(51),ag=d(84),xg=d(159);class Tg{constructor(A,W){this.Iwb=A;this.Eh=W}}Object(h.a)(Tg,"DoNotCheckCritiqueTypeActionData",null,[]);var li=d(19);class Li{t8a(A){return(A=Object(z.a)(Tg,A))?Object(li.a)(Ue.a,A.Eh):!1}gNe(A,W){if(W=
Object(z.a)(Tg,W)){const na=W.Eh;na&&(na.UMa(A,W.Iwb),e.ULS.sendTraceTag(37855319,375,50,"Don't check this critique for whole doc finished, removed errors count: {0}",W.Iwb))}}}Object(h.a)(Li,"DoNotCheckCritiqueTypeCallback",null,[739]);var Le=d(472),Ih=d(50);class bj extends Le.a{constructor(A,W,na,Ga,Ka,qb,Qb){super();this.iHe=null;this.init(A);this.$l("WholePresentationOperation");this.zFa(M.AFrameworkApplication.Ra,W,na,Ga,Ka);this.Ofb=0;this.b2g=Qb;this.XEg=qb;this.PGa=Ka;this.Ldc=W;this.t8a()?
1===this.behavior&&(this.gp=32,this.RY()):(this.gp=8,this.RY())}run(){0===this.Ofb&&this.r0e();1===this.Ofb&&this.iRe();2===this.Ofb&&this.r5e();3===this.Ofb&&this.J7d()}t8a(){return this.b2g.t8a(this.PGa)}gNe(){this.b2g.gNe(this.Ldc,this.PGa)}r0e(){this.iHe=new Ih.GraphTransaction(3);this.iHe.hc(this.XEg.node);this.Ofb=1}iRe(){this.ux||this.elb(this.XEg.UE);1!==this.Eoa()&&(this.Ofb=2)}r5e(){this.gNe();this.iHe.dispose();this.Ofb=3}J7d(){this.RY()}}Object(h.a)(bj,"WholePresentationOperation",Le.a,
[]);var zh=d(52);class jj{constructor(A,W,na,Ga,Ka,qb,Qb,t,Y,pa,Ja,Ya){this.uFa=!1;this.ia=A;this.lxg=W;this.nG=na;this.Eb=Ga;this.N6c=Ka;this.ta=qb;this.Ga=Qb;this.Q$=Ja;this.WBe=t;this.oD=Y;this.kb=Ya;this.Ddd=pa.tzh;this.ekk=pa.pptProofingRemoveWholeDocTargetCritiquesEnabled;this.Djk=pa.pptHideProofingErrorIsEnabled;this.fOj()}get G3b(){return this.nG.aWa?this.N6c.instance:null}vb(){this.ia.ra(fd.a.TKb,zh.a.application,Object(n.a)(this,this.TKb,"queryLanguage"),96);this.ia.ra(fd.a.pkd,zh.a.application,
Object(n.a)(this,this.UJk,"openPPTLanguageDialogView"),4);this.nG.Nog&&this.ia.ra(de.a.xZc,Lc.a.Mf,Object(n.a)(this,this.xZc,"ignoreProofingError"),4);this.nG.fne&&(this.ekk?(this.ia.ya(de.a.iwb,Lc.a.paragraph,Object(n.a)(this,this.KUf,"doNotCheckThisCritiqueTypeForNode")),this.ia.ya(de.a.iwb,Lc.a.section,Object(n.a)(this,this.KUf,"doNotCheckThisCritiqueTypeForNode")),this.ia.YS(de.a.iwb,Lc.a.Mf,Object(n.a)(this,this.RVi,"doNotCheckThisCritiqueTypeForWholeDoc"),4),this.ia.ra(fd.a.B4b,Lc.a.Mf,Object(n.a)(this,
this.B4b,"doNotCheckThisCritiqueTypeForCurrentSlide"),4)):this.ia.ra(de.a.iwb,Lc.a.Mf,Object(n.a)(this,this.B4b,"doNotCheckThisCritiqueTypeForCurrentSlide"),4));this.Djk&&(this.ia.ra(fd.a.Mmd,zh.a.application,Object(n.a)(this,this.Mmd,"queryHideProofingErrors"),100),this.ia.ra(fd.a.Ghg,zh.a.application,Object(n.a)(this,this.HGl,"toggleHideProofingErrors"),4))}pe(){}fOj(){this.uFa=jj.wge;e.ULS.sendTraceTag(37237070,375,50,"Initialized with hide proofing errors: {0}",this.uFa);this.uFa&&this.Dhg(this.uFa)}Mmd(A,
W,na,Ga,Ka){if(1===na)return 32;if(!Ka)return 8;Ka[Kc.a.On]=this.uFa;return 32}HGl(A,W,na,Ga,Ka){if(1===na)return 32;if(!(Ka&&Kc.a.On in Ka))return 8;this.uFa=Ka[Kc.a.On];jj.wge=this.uFa;this.Dhg(this.uFa);e.ULS.sendTraceTag(37237071,375,50,"User hide proofing errors: {0}",this.uFa);return 32}KUf(A,W,na,Ga,Ka){if(!W)return 8;A=W.node;if(!A)return 8;if(W.contextId===Lc.a.section&&!A.sa(xg.a.tne,!1))return 32;if(W.contextId===Lc.a.paragraph&&A.sa(xg.a.C4,!1)){W=Object(z.a)(Tg,Ka);if(!W)return 8;Ka=
W.Eh;if(!Ka)return 8;W.Iwb+=this.Vnh(A,Ka.typeId,Ka.lcid)}return 2}RVi(A,W,na,Ga,Ka){var qb=this.Bej();qb=new Tg(0,qb);this.ia.ei(na,fd.a.B4b,Ga,!1,Ka,qb);na=sf.a.create(Object(z.a)(ag.a,this.ta.presentation));e.ULS.sendTraceTag(37012126,375,50,"User click do not check this critique for whole doc with behavior: {0}",Ga);return new bj(A,W,Ga,Ka,qb,na,new Li)}B4b(A,W,na,Ga,Ka){A=Object(z.a)(Tg,Ka);if(!A)return 8;Ga=A.Eh;if(!Ga)return 8;if(1===na)return 32;if(!W.node)return 8;e.ULS.sendTraceTag(36790874,
375,50,"Don't check this critique triggerred, language id: {0}, critique type id: {1}",Ga.lcid,Ga.typeId);A.Iwb+=this.G6k(Ga.typeId,Ga.lcid);this.G3b&&this.G3b.BUi(Ga.lcid.toString(),Ga.typeId);return 32}xZc(A,W,na){if(1===na)return 32;e.ULS.sendTraceTag(36790875,375,50,"Ignore proofing error triggerred");na=this.oD.UTa(W);if(!na||!na.Eh)return 8;W=W.node;var Ga=this.ta.Ba;if(!W||!Ga)return 8;Ga=this.Eb.je(jj.Kvj(na));try{Ga.hc(W),this.oD.fLa(W,[na],!0),W.setValue(Rf.a.UMf,!0)}finally{Ga&&Ga.dispose()}na.Eh.UMa(A,
1);this.kb.kWa()||xf.a.AP(!0,!1);e.ULS.sendTraceTag(36790876,375,50,"Ignore proofing error action succeeded");return 32}Dhg(A){this.Q$.f1e=A}Bej(){var A=this.kb.Pa.mb;if(!A)return null;A=this.oD.UTa(A.Va);if(!A||!A.Eh)return null;A=Object(z.a)(Ue.a,A.Eh);return!A||0>=A.lcid?null:A}G6k(A,W){const na=new Date;if(!this.ta.Ba)return 0;const Ga=this.ta.Ba.Uj();if(!Ga)return 0;let Ka=0,qb=0;const Qb=this.Eb.je(3);try{Qb.hc(this.ta.Ba);for(const t of Ga)this.Ga.eK(t,Y=>{++qb;Y.Ua(Rf.a.tq)&&Y.sa(xg.a.C4,
!1)&&(Ka+=this.Vnh(Y,A,W))})}finally{Qb&&Qb.dispose()}e.ULS.sendTraceTag(36825112,375,50,"Remove proofing error take time(ms): {0}, scanned paragraph count: {1}, scanned shape count: {2}, removed errors count: {3}",+new Date-+na,qb,Ga.length,Ka);return Ka}Vnh(A,W,na){const Ga=this.oD.TF(A,Ka=>{Ka=Object(z.a)(Ue.a,Ka.Eh);return!!Ka&&Ka.typeId===W&&Ka.lcid===na});if(Gd.a.Xa(Ga))return 0;this.oD.fLa(A,Ga);return Ga.length}TKb(A,W,na,Ga,Ka){Ka.fLc=this.Kjj();return 32}Kjj(){let A=M.AFrameworkApplication.lcid;
if(this.kb.d0(this.kb.Pa)){var W=this.kb.Xd();if(1<W.length||1!==W.length)return"";W=this.Ga.aUa(W[0]);0<W&&(A=W)}else this.kb.Pa.mb&&(W=this.WBe.YVc(this.kb.Yj),0<W&&(A=W));return he.a.He(A)?he.a.He(A).displayName:he.a.He(M.AFrameworkApplication.lcid).displayName}Y2j(){const A=this.kb.Xd();return 1===A.length&&A[0].z2c}UJk(A,W,na){if(2!==na)return 32;this.Ddd&&this.kb.d0(this.kb.Pa)&&this.Y2j()?(e.ULS.sendTraceTag(8955537,806,50,"Set proofing language on shape level."),this.lxg.value.getInstance(!0).euc()):
this.kb.Pa.mb&&(e.ULS.sendTraceTag(8955536,806,50,"Set proofing language in text edit view."),this.lxg.value.getInstance(!1).euc());return 32}static get wge(){const A=bb.a.get("PowerPointHideProofingErrors");return A?"true"===A.toLowerCase():!1}static set wge(A){bb.a.oK("PowerPointHideProofingErrors",A.toString(),30)||e.ULS.sendTraceTag(37237069,375,10,"Failed to set cookie for hide proofing errors to {0}",A.toString())}static Kvj(A){return 1===A.Eh.proofingType?15:3}}Object(h.a)(jj,"ProofingActor",
null,[251]);var Sh=d(272),ya=d(591);class Ra{constructor(A,W){this.Ed=A.toLowerCase();this.variant=W}}Object(h.a)(Ra,"ThemeVariant",null,[]);var hb=d(1078);class Eb{constructor(A,W,na,Ga,Ka,qb,Qb,t,Y,pa,Ja,Ya,jb){this.y7c=null;this.z7c=0;this.hDg=this.x7c=!1;this.QLg=null;this.aub=new Ra("",0);this.UGe={["ThemesOfficeTheme"]:"62f939b6-93af-4db8-9c6b-d6c7dfdc589f",["ThemesIon"]:"b8441adb-2e43-4af7-b97a-bd870242c6a8",["ThemesAtlas"]:"5156b0e4-0eb1-49fe-a26b-15f6f698aec6",["ThemesMadison"]:"025cb5fb-2dd3-45ee-b6f0-cc461540eb19",
["ThemesOrganic"]:"28cdc826-8792-45c0-861b-85eb3adeda33",["ThemesFrame"]:"f226e7a2-7162-461c-9490-d27d9dc04e43",["ThemesIonBoardroom"]:"fc33163d-4339-46b1-8eed-24c834239d99",["ThemesMesh"]:"789ec3fe-34fd-429c-9918-760025e6c145",["ThemesRetrospect"]:"5f128b03-dcca-4eeb-ab3b-cf2899314a46",["ThemesSlice"]:"0507925b-6ac9-4358-8e18-c330545d08f8",["ThemesSavon"]:"1306e473-ed32-493b-a2d0-240a757edd34",["ThemesBanded"]:"98dff888-2449-4d28-977c-6306c017633e",["ThemesQuotable"]:"39ec5628-30ed-4578-acd8-9820edb8e15a",
["ThemesWoodType"]:"7acabc62-bf99-48cf-a9dc-4db89c7b13dc",["ThemesBasis"]:"5665723a-49ba-4b57-8411-a56f8f207965",["ThemesIntegral"]:"3577f8c9-a904-41d8-97d2-fd898f53f20e",["ThemesWisp"]:"7cb32d59-10c0-40dd-b7bd-2e94284a981c",["ThemesDividend"]:"9697a71b-4ab7-4a1a-bd5b-bb2d22835b57",["ThemesCelestial"]:"c4bb2a3d-0e93-4c5f-b0d2-9d3fce089cc5",["ThemesParallax"]:"3388167b-a2eb-4685-9635-1831d9aef8c4",["ThemesMetropolitan"]:"4c5440d6-04d2-4954-96cf-f251137069b2",["ThemesFacet"]:"c0c680cd-088a-49fc-a102-d699147f32b2",
["ThemesViewTheme"]:"ba0eb5a6-f2d4-4f82-977b-64adee4a2a69"};this.ia=A;this.Fa=W;this.$b=na;this.pa=Ka;this.Eb=Ga;this.Tb=Qb;this.ta=t;this.oc=Y;this.Nrk=pa;this.h$c=Ja;this.SGg=Ya;jb&&(this.UGe.ThemesOfficeTheme2023="2e142a2c-cd16-42d6-873a-c26d2a0506fa")}vb(){this.ia.ra(fd.a.uv,zh.a.application,Object(n.a)(this,this.cgg,"handleThemeChange"),4);this.ia.ra(fd.a.WCa,zh.a.application,Object(n.a)(this,this.cgg,"handleThemeChange"),4);this.ia.ra(fd.a.Qmd,zh.a.application,Object(n.a)(this,this.Qmd,"queryMoreThemeGallery"),
96);this.ia.ra(fd.a.iSe,zh.a.application,Object(n.a)(this,this.iSe,"queryMoreVariantGallery"),96);this.ia.ra(fd.a.Oy,zh.a.application,Object(n.a)(this,this.Oy,"queryThemes"),97);this.ia.ra(fd.a.nqc,zh.a.application,Object(n.a)(this,this.nqc,"queryThemeVariants"),97);this.ia.ra(fd.a.Qld,zh.a.application,Object(n.a)(this,this.Qld,"populateVariantGallery"),96)}pe(){}Oy(A,W,na,Ga,Ka){Ka&&Ka.mV&&(A=this.UGe[Ka.mV]===this.NEa().Ed,Ka.h0a.Hf(A));return 32}nqc(A,W,na,Ga,Ka){if(Ka&&Ka.mV){A=this.NEa();W=A.Ed;
na=Ka.mV;try{var qb=Number.parseInvariant(na.substring(na.length-1,na.length))}catch(Qb){qb=0}Ka=Ka.h0a;Ka.Hf(A.variant===qb);qb=Eb.w3f(na,qb,W);Ka.W3=qb}return 32}Qmd(A,W,na){if(W.contextId!==Lc.a.application)return 2;A=this.pa.hk();var Ga=this.NEa();W=Eb.bzb(Ga.Ed);Ga=Ga.variant-1;return this.$b.$c(A)?16:1!==na||(e.ULS.sendTraceTag(512499972,801,50,"ThemeActor.QueryMoreThemeGallery: Dropdown menu opened. CurrentTheme={0} CurrentVariant={1}",W,Ga),this.oc.Cj())?32:8}iSe(A,W,na){if(W.contextId!==
Lc.a.application)return 2;var Ga=this.pa.hk();W=this.NEa();A=Eb.bzb(W.Ed);W=W.variant-1;if(this.$b.$c(Ga))return 16;if(1===na)if(na=Eb.U8b(this.NEa().Ed),Ga=this.Nrk.Y5j(na),na&&Ga)e.ULS.sendTraceTag(512499971,801,50,"ThemeActor.QueryMoreVariantGallery: Dropdown menu opened. CurrentTheme={0} CurrentVariant={1}",A,W);else return 16;return 32}cgg(A,W,na,Ga,Ka){W=this.pa.Se();Ga=this.ta.Ba;if(!Ga||A===fd.a.WCa&&this.NEa()===this.aub||this.$b.$c(Ga))return 16;if(1===na)return 32;na=Object(z.a)(String,
Ka);if(null===na)return 8;Ka=this.UGe[na];return A===fd.a.uv?this.dOk(Ga,Ka,W):A===fd.a.WCa?this.eOk(Ga,na):8}dOk(A,W,na){if(!A)return 16;1>=this.eOf()||this.SGg&&na&&1<na.length?(this.ZUd(A,W,0,!1,na),e.ULS.sendTraceTag(512499968,801,50,"ThemeActor.PerformChangeTheme: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",Eb.bzb(W),0,A.Db.sid)):(this.y7c=W,this.z7c=0,this.x7c=!1,A=new fb.StandardDialog,A.Ad=1,A.sP(ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_MultipleMainMastersMessage,Object(n.a)(this,
this.eJf,"changeThemeHandler")));return 32}eOk(A,W){if(!A)return 16;const na=this.NEa();let Ga;try{if(Ga=Number.parseInvariant(W.substring(7,W.length))-1,0>Ga||Ga>Eb.U8b(na.Ed))Ga=-1}catch(Ka){Ga=-1}1>=this.eOf()?(this.ZUd(A,na.Ed,Ga,!0,null),e.ULS.sendTraceTag(512499939,801,50,"ThemeActor.PerformChangeVariant: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",Eb.bzb(na.Ed),Ga,A.Db.sid)):(this.y7c=na.Ed,this.z7c=Ga,this.x7c=!0,A=new fb.StandardDialog,A.Ad=1,A.sP(ResourceStrings.l_GenericDialogTitle,
ResourceStrings.l_MultipleMainMastersMessage,Object(n.a)(this,this.eJf,"changeThemeHandler")));return 32}NEa(){let A=null;var W=this.ta.Ba;if(W){W=W.jj;const Ga=this.oc.XI();if(Ga&&W)for(var na of Ga)if(na.Id===W){A=na;break}}if(!A)return this.hDg?this.QLg:this.aub;if(Object(Rg.a)("EnableNonEmptyGuidFixForThemeActor")){if(!A.ThemeFamilyId||Eb.bzb(A.ThemeFamilyId)===Eb.bHf)return this.aub}else if(!A.ThemeFamilyId||A.ThemeFamilyId===Eb.Lui)return this.aub;na="5156b0e4-0eb1-49fe-a26b-15f6f698aec6"===
A.ThemeFamilyId||"025cb5fb-2dd3-45ee-b6f0-cc461540eb19"===A.ThemeFamilyId;return!this.h$c&&na?this.aub:new Ra(A.ThemeFamilyId,A.VariantIndex+1)}eOf(){const A=this.oc.XI();let W=0;if(A)for(const na of A)na.InContent&&(W+=1);return W}eJf(A){const W=this.ta.Ba;if(W){var na=this.y7c,Ga=this.z7c,Ka=this.x7c;this.y7c=null;this.z7c=-1;this.x7c=!1;1===A&&(this.ZUd(W,na,Ga,Ka,null),e.ULS.sendTraceTag(512499936,801,50,"ThemeActor.ChangeThemeHandler: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",Eb.bzb(na),
Ga,W.Db.sid))}}ZUd(A,W,na,Ga,Ka){this.QLg=(this.hDg=Ga)?new Ra(W,0):this.aub;const qb=this.Eb.xd(15,void 0,()=>{this.Fa.Bd();this.pa.nh()},void 0,!0);try{if(qb.hc(A),qb.fd=Ga?fd.a.WCa:fd.a.uv,this.SGg&&Ka)for(const Qb of Ka)Qb.setValue(Eg.a.h6e,W),Qb.setValue(Eg.a.Fba,na),Qb.setValue(Eg.a.Ami,1<Ka.length);else A.setValue(Eg.a.h6e,W),A.setValue(Eg.a.Fba,na)}finally{qb&&qb.dispose()}this.$b.H0b(this.Tb.Ef,A,"ChangeTheme")}Qld(A,W,na,Ga,Ka){if(1===na)return 32;A=Math.max(Eb.U8b(this.NEa().Ed),4);W=this.NEa().Ed;
Ka.MenuItems=Eb.cpj(A,W);return 32}static U8b(A){for(let W=0;W<hb.a.Gza.length;++W)if(hb.a.Gza[W].pSc===A)return hb.a.Gza[W].t$e;return 0}static bzb(A){for(let W=0;W<hb.a.Gza.length;++W)if(hb.a.Gza[W].pSc===A)return hb.a.Gza[W].lMh;return Eb.bHf}static X2i(A){let W="";for(let na=0;na<hb.a.Gza.length;++na)hb.a.Gza[na].pSc===A&&(W=hb.a.Gza[na].lMh.replace(" ",""));return W}static cpj(A,W){const na=Object.assign(new sh.a,{Id:"PptRibbon.Design.ThemeVariants.Anchor.Menu",MenuSectionList:[]});var Ga=Object.assign(new Sh.a,
{Id:"PptRibbon.Design.ThemeVariants.MenuSection",DisplayMode:"Size85by48",ControlList:[]});Array.add(na.MenuSectionList,Ga);const Ka=Object.assign(new ya.a,{Id:"PptRibbon.Design.ThemeVariants.Gallery",ExternalId:"MoreVariantsSection",ExternalGalleryId:"MoreVariantsGallery",Type:4,Width:4,ElementDimensions:"Size85by48",GalleryItems:[]});Array.add(Ga.ControlList,Ka);for(Ga=1;Ga<=A;++Ga)Array.add(Ka.GalleryItems,Eb.w3f("Variant"+Ga,Ga,W));return na}static w3f(A,W,na){na=!Eb.U8b(na)||W>Eb.U8b(na)?"EmptyVariantsGallery_85x48x8":
String.format("ThemeVariantGallery{0}{1}_85x48x24",Eb.X2i(na),W);return Object.assign(new dd.a,{Id:A,ExternalId:A,Icon:na,Alt:String.format(ResourceStrings.L_ThemeVariantAlt,W),PreviewIconStyle:{root:{width:"49px",height:"28px",margin:"-2px"}},FullIconStyle:{root:{width:"85px",height:"48px"}},Command:"2759977169",QueryCommand:"1425701611"})}}Eb.Lui="00000000-0000-0000-0000-000000000000";Eb.bHf="Unsupported Theme";Object(h.a)(Eb,"ThemeActor",null,[251]);var Yb=d(482);class Nb{}Nb.none=0;Nb.cut=0;Nb.random=
1;Nb.blinds=2;Nb.JYd=3;Nb.qDa=4;Nb.dissolve=5;Nb.fade=6;Nb.$Ma=7;Nb.FTe=8;Nb.uzd=9;Nb.wipe=10;Nb.qzh=11;Nb.split=13;Nb.zql=17;Nb.Eql=18;Nb.wedge=19;Nb.push=20;Nb.HZd=21;Nb.LAf=23;Nb.wheel=26;Nb.nzh=27;Nb.Cxc=28;Nb.FMb=29;Nb.nFa=30;Nb.Krc=39;Nb.N4e=42;Nb.flip=43;Nb.WM=44;Nb.CUl=47;Nb.M6d=48;Nb.u4d=49;Nb.IQi=50;Nb.N$e=51;Nb.cTk=52;Nb.b8i=53;Nb.YPi=54;Nb.zOe=55;Nb.zdh=56;Nb.UNe=57;Nb.XTd=58;Nb.INe=59;Nb.morph=60;Nb.pan=36;Nb.O8d=38;Nb.Z_d=37;Nb.m4d=33;Nb.window=34;Nb.z6b=32;Nb.zoom=31;Nb.SVl=22;Object(h.a)(Nb,
"TransitionTypes",null,[]);class ed{constructor(A,W,na,Ga,Ka,qb,Qb,t,Y,pa,Ja){this.ia=A;this.Tb=W;this.ta=na;this.pa=Ka;this.Fa=qb;this.Eb=Ga;this.Dn=Qb;this.$b=t;this.PJg=Y.X_j;this.Bn=Y.gD;this.p$c=Y.a1j;this.Gic=pa.qk(Ne.a.nld);this.GHa=Y.iA;this.Gb=Ja}vb(){this.p$c?(this.PJg?(this.ia.ra(fd.a.$j,Lc.a.application,Object(n.a)(this,this.tol,"setSlidesTransitionGalleryExceptExisting"),5),this.ia.ra(fd.a.Hj,Lc.a.application,Object(n.a)(this,this.BWk,"querySlidesTransitionGalleryExceptExisting"),97),
this.ia.ra(fd.a.upa,Lc.a.application,Object(n.a)(this,this.uol,"setSlidesTransitionGalleryExisting"),5),this.ia.ra(fd.a.jza,Lc.a.application,Object(n.a)(this,this.vol,"setSlidesTransitionGalleryExistingInMenu"),5),this.ia.ra(fd.a.Ioa,Lc.a.application,Object(n.a)(this,this.CWk,"querySlidesTransitionGalleryExisting"),97),this.ia.ra(fd.a.wya,Lc.a.application,Object(n.a)(this,this.DWk,"querySlidesTransitionGalleryExistingInMenu"),97)):(this.ia.ra(fd.a.$j,Lc.a.application,Object(n.a)(this,this.K_e,"setSlidesTransitionGallery"),
5),this.ia.ra(fd.a.Hj,Lc.a.application,Object(n.a)(this,this.zSe,"querySlidesTransitionGallery"),97),this.ia.ra(fd.a.upa,Lc.a.application,Object(n.a)(this,this.K_e,"setSlidesTransitionGallery"),5),this.ia.ra(fd.a.jza,Lc.a.application,Object(n.a)(this,this.K_e,"setSlidesTransitionGallery"),5),this.ia.ra(fd.a.Ioa,Lc.a.application,Object(n.a)(this,this.zSe,"querySlidesTransitionGallery"),97),this.ia.ra(fd.a.wya,Lc.a.application,Object(n.a)(this,this.zSe,"querySlidesTransitionGallery"),97)),this.ia.ra(fd.a.itc,
Lc.a.application,Object(n.a)(this,this.sol,"setSlidesTransitionEffectOption"),5),this.ia.ra(fd.a.Knd,Lc.a.application,Object(n.a)(this,this.zWk,"querySlidesTransitionEffectOption"),97),this.ia.ra(fd.a.Ijb,Lc.a.application,Object(n.a)(this,this.AWk,"querySlidesTransitionEffectOptionsAnchor"),100),this.ia.ra(fd.a.YJb,Lc.a.application,Object(n.a)(this,this.aQk,"populateSlidesTransitionEffectOptions"),96),this.ia.ra(fd.a.vya,Lc.a.application,Object(n.a)(this,this.yWk,"querySlidesTransitionDuration"),
97),this.ia.ra(fd.a.xlb,Lc.a.application,Object(n.a)(this,this.rol,"setSlidesTransitionDuration"),5)):(this.PJg?(this.ia.ra(fd.a.$j,Lc.a.application,Object(n.a)(this,this.npl,"setTransitionGalleryExceptExisting"),5),this.ia.ra(fd.a.Hj,Lc.a.application,Object(n.a)(this,this.TWk,"queryTransitionGalleryExceptExisting"),97),this.ia.ra(fd.a.upa,Lc.a.application,Object(n.a)(this,this.opl,"setTransitionGalleryExisting"),5),this.ia.ra(fd.a.jza,Lc.a.application,Object(n.a)(this,this.ppl,"setTransitionGalleryExistingInMenu"),
5),this.ia.ra(fd.a.Ioa,Lc.a.application,Object(n.a)(this,this.Ioa,"queryTransitionGalleryExisting"),97),this.ia.ra(fd.a.wya,Lc.a.application,Object(n.a)(this,this.wya,"queryTransitionGalleryExistingInMenu"),97)):(this.ia.ra(fd.a.$j,Lc.a.application,Object(n.a)(this,this.Y_e,"setTransitionGallery"),5),this.ia.ra(fd.a.Hj,Lc.a.application,Object(n.a)(this,this.Hj,"queryTransitionGallery"),97),this.ia.ra(fd.a.upa,Lc.a.application,Object(n.a)(this,this.Y_e,"setTransitionGallery"),5),this.ia.ra(fd.a.jza,
Lc.a.application,Object(n.a)(this,this.Y_e,"setTransitionGallery"),5),this.ia.ra(fd.a.Ioa,Lc.a.application,Object(n.a)(this,this.Hj,"queryTransitionGallery"),97),this.ia.ra(fd.a.wya,Lc.a.application,Object(n.a)(this,this.Hj,"queryTransitionGallery"),97)),this.ia.ra(fd.a.itc,Lc.a.application,Object(n.a)(this,this.lpl,"setTransitionEffectOption"),5),this.ia.ra(fd.a.Knd,Lc.a.application,Object(n.a)(this,this.SWk,"queryTransitionEffectOption"),97),this.ia.ra(fd.a.Ijb,Lc.a.application,Object(n.a)(this,
this.Ijb,"queryTransitionEffectOptionsAnchor"),100),this.ia.ra(fd.a.YJb,Lc.a.application,Object(n.a)(this,this.YJb,"populateTransitionEffectOptions"),96),this.ia.ra(fd.a.vya,Lc.a.application,Object(n.a)(this,this.vya,"queryTransitionDuration"),97),this.ia.ra(fd.a.xlb,Lc.a.application,Object(n.a)(this,this.xlb,"setTransitionDuration"),5));this.ia.ra(fd.a.wlb,Lc.a.application,Object(n.a)(this,this.wlb,"setTransitionApplyAll"),4);this.ia.ra(fd.a.zLb,Lc.a.application,Object(n.a)(this,this.zLb,"queryTransitionApplyAll"),
96)}pe(){}YJb(A,W,na,Ga,Ka){if(this.Bn&&1!==this.pa.Se().length)return 16;if(1===na)return 32;A=(A=this.ta.Ba)?A.xo:null;if(!A)return 16;if(!Ka)return 8;A=this.Dn.dzb(A);A.next&&(Ka.MenuItems=this.OFf(A));return 32}Hj(A,W,na,Ga,Ka){if(!Ka)return 8;A=Ka.queryResult;Ka=Ka.SourceControlId;W=this.Dn.JQ(Ka);if(!W)return 8;A.CEa=ed.S8d(W.uc,W.rc,this.Gic);W=this.ta.Ba;if(!W)return 16;1===na&&((na=W.xo)?(na=this.Dn.xUa(na),A.kV(!na&&"TransitionExisting"===Ka||na===Ka)):A.kV("TransitionNone"===Ka));return 32}TWk(A,
W,na,Ga,Ka){if(!Ka||A!==fd.a.Hj)return 8;A=Ka.queryResult;Ka=Ka.SourceControlId;W=this.Dn.JQ(Ka);if(!W)return 8;Ga=W.uc.split("_")[1]+"_24";W=ed.BTa(Ka,Ka,Ga,"2024601249","149145197",W.rc,W.rc);A.W3=W;W=this.ta.Ba;if(!W)return 16;1===na&&((na=W.xo)?(na=this.Dn.xUa(na),A.kV(na===Ka)):A.kV("TransitionNone"===Ka));return 32}Ioa(A,W,na,Ga,Ka){if(!Ka||A!==fd.a.Ioa)return 8;A=Ka.queryResult;Ka=Ka.SourceControlId;if(!Ka||"TransitionExisting"!==Ka)return 16;W=this.Dn.JQ(Ka);if(!W)return 8;Ga=W.uc.split("_")[1]+
"_24";W=ed.BTa(Ka,Ka,Ga,"3752636652","3476251476",W.rc,W.rc);A.W3=W;W=this.ta.Ba;if(!W)return 16;if(1===na&&(na=W.xo)){na=this.Dn.xUa(na);W=this.Dn.s3c(na,this.Dn.nyb());if(na&&!W){Ga=this.Dn.JQ(na);if(!Ga)return 8;const qb=Ga.uc.split("_")[1]+"_24";Ka=ed.BTa(Ka,Ka,qb,"3752636652","3476251476",Ga.rc,Ga.rc);A.W3=Ka}A.kV(!na||!!na&&!W)}return 32}wya(A,W,na,Ga,Ka){if(!Ka||A!==fd.a.wya)return 8;A=Ka.queryResult;Ka=Ka.SourceControlId;if(!Ka||"TransitionExistingInMenu"!==Ka)return 16;W=this.Dn.JQ(Ka);if(!W)return 8;
Ga=W.uc.split("_")[1]+"_24";Ka=ed.BTa(Ka,Ka,Ga,"4036532528","2831233208",W.rc,W.rc);A.W3=Ka;Ka=this.ta.Ba;if(!Ka)return 16;1===na&&(na=Ka.xo)&&(na=this.Dn.xUa(na),A.kV(!na));return 32}Ijb(A,W,na){A=this.ta.Ba;if(!A)return 16;A=this.Dn.dzb(A.xo);return!A||!A.next||this.Bn&&1!==this.pa.Se().length?16:1===na?32:8}Y_e(A,W,na,Ga,Ka){if(!Ka)return 8;W=Ka.SourceControlId;Ka=A===fd.a.upa||A===fd.a.jza;Ga=this.ta.Ba;if(!Ga||this.$b.$c(Ga)||this.Bn&&1!==this.pa.Se().length)return 16;var qb=Ga.xo;const Qb=!!this.Dn.wUa(qb);
if(Ka&&(!qb||Qb))return 16;if(1===na)return 32;qb=this.Dn.JQ(W);if(!qb)return 8;if(!Ka&&2===na&&W){xf.a.Ak("SlideCount","1");na=this.Eb.xd(15,void 0,()=>{this.pa.kj();this.Fa.Bd()});try{na.hc(Ga),na.fd=A,Ga.xo=qb.tc}finally{na&&na.dispose()}e.ULS.sendTraceTag(512499935,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",W,qb.next||"null",Ga.Db.sid)}return 32}npl(A,W,na,Ga,Ka){if(!Ka)return 8;W=Ka.SourceControlId;Ga=this.ta.Ba;if(!Ga)return 16;
if(A!==fd.a.$j)return 8;if(this.$b.$c(Ga)||this.Bn&&1!==this.pa.Se().length)return 16;if(1===na)return 32;Ka=this.Dn.JQ(W);if(!Ka)return 8;if(2===na&&W){xf.a.Ak("SlideCount","1");na=this.Eb.xd(15,void 0,()=>{this.pa.kj();this.Fa.Bd()});try{na.hc(Ga),na.fd=A,Ga.xo=Ka.tc}finally{na&&na.dispose()}e.ULS.sendTraceTag(512499934,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",W,Ka.next||"null",Ga.Db.sid)}return 32}opl(A,W,na,Ga,Ka){if(!Ka)return 8;
W=this.ta.Ba;if(!W)return 16;if(A!==fd.a.upa)return 8;if(this.Bn&&1!==this.pa.Se().length)return 16;if(1!==na)return 8;A=W.xo;na=!!this.Dn.wUa(A);W=this.Dn.dzb(A);W=this.Dn.s3c(W?W.parent:null,this.Dn.nyb());return A&&!na||!W?32:16}ppl(A,W,na,Ga,Ka){if(!Ka)return 8;W=this.ta.Ba;if(!W)return 16;if(A!==fd.a.jza)return 8;if(this.Bn&&1!==this.pa.Se().length)return 16;if(1!==na)return 8;A=W.xo;na=!!this.Dn.wUa(A);return!A||na?16:32}wlb(A,W,na){W=this.ta.Ba;if(!W||this.$b.$c(W)||this.Bn&&1!==this.pa.Se().length)return 16;
if(1===na)return 32;xf.a.Ak("SlideCount","1");na=this.Tb.Ef;const Ga=this.Eb.xd(15,void 0,()=>{this.pa.kj();this.Fa.Bd()});try{Ga.hc(na),Ga.fd=A,na.htb=W.Db}finally{Ga&&Ga.dispose()}e.ULS.sendTraceTag(512499933,801,50,"TransitionActor: Command=SetTransitionApplyAll");return 32}zLb(A,W,na,Ga,Ka){A=this.ta.Ba?!0:!1;if(!Ka)return 8;Ka=Ka.queryResult;Ka.CEa=ed.S8d("pegal_TransitionNewsFlash_32x32x32",ResourceStrings.L_TransitionApplyAll,this.Gic);Ka.kV(A);return A?32:16}lpl(A,W,na,Ga,Ka){if(!Ka)return 8;
W=Ka.MenuItemId;if(this.Bn&&1!==this.pa.Se().length)return 16;if(1===na)return 32;na=this.ta.Ba;if(!na||this.$b.$c(na))return 16;Ga=na?na.xo:null;Ka=this.Dn.JQ(W);if(!Ga||!Ka||!Ka.tc)return 16;Ga.TransitionType=Ka.tc.TransitionType;Ga.Direction=Ka.tc.Direction;Ga.Duration=Ka.tc.Duration;xf.a.Ak("SlideCount","1");const qb=this.Eb.xd(15,void 0,()=>{this.pa.kj();this.Fa.Bd()});try{qb.hc(na),qb.fd=A,na.xo=Ga}finally{qb&&qb.dispose()}e.ULS.sendTraceTag(512499932,801,50,"TransitionActor: Command=SetTransitionEffectOption, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",
Ka.parent,W,na.Db.sid);return 32}SWk(A,W,na,Ga,Ka){if(!Ka)return 8;A=Ka.queryResult;Ka=Ka.MenuItemId;W=this.ta.Ba;if(!W)return 16;1===na&&A.Hf(this.Dn.wUa(W.xo)===Ka);return 32}vya(A,W,na,Ga,Ka){A=this.ta.Ba;if(!A)return 16;if(!Ka)return 8;A=A.xo;if(Ka=Ka.queryResult)Ka.iba=A?(A.Duration/1E3).toString():"0";return 32}xlb(A,W,na,Ga,Ka){W=this.ta.Ba;if(!W||this.$b.$c(W))return 16;if(!Ka)return 8;if(this.Bn&&1!==this.pa.Se().length)return 16;Ga=Math.floor(1E3*Ka.Number);Ka=W.xo;if(!Ka)return 16;xf.a.Kb&&
(xf.a.Kb.actionName="SetTransitionDuration");if(1===na)return"TransitionNone"===this.Dn.xUa(Ka)?16:32;if(2===na){Ka.Duration=Ga;const qb=this.Fa.Ee;xf.a.Ak("SlideCount","1");na=this.Eb.xd(15,void 0,()=>{this.pa.kj();!qb||qb.name!==lf.a.vg&&qb.name!==lf.a.Lz||this.Fa.Bd()});try{na.hc(W),na.fd=A,W.xo=Ka}finally{na&&na.dispose()}}return 32}aQk(A,W,na,Ga,Ka){if(1===na)return 32;if(!Ka)return 8;W=this.pa.Se();if(!W||!W.length)return 16;A=W[0].xo;if(!A)return 16;A=this.Dn.dzb(A);if(1<W.length)for(const qb of W){W=
qb.xo;if(!W)return 16;W=this.Dn.dzb(W);if(A.parent!==W.parent)return 16}A.next&&(Ka.MenuItems=this.OFf(A));return 32}zSe(A,W,na,Ga,Ka){if(!Ka)return 8;A=Ka.queryResult;Ka=Ka.SourceControlId;W=this.Dn.JQ(Ka);if(!W)return 8;A.CEa=ed.S8d(W.uc,W.rc,this.Gic);W=this.pa.Se();if(!W||!W.length)return 16;1===na&&(na="",({Rpa:na}=this.zSa(W)).returnValue&&A.kV(!na&&"TransitionExisting"===Ka||na===Ka));return 32}BWk(A,W,na,Ga,Ka){if(!Ka||A!==fd.a.Hj)return 8;A=Ka.queryResult;Ka=Ka.SourceControlId;W=this.Dn.JQ(Ka);
if(!W)return 8;Ga=W.uc.split("_")[1]+"_24";W=ed.BTa(Ka,Ka,Ga,"2024601249","149145197",W.rc,W.rc);A.W3=W;W=this.pa.Se();if(!W||!W.length)return 16;1===na&&(na="",({Rpa:na}=this.zSa(W)).returnValue&&A.kV(na===Ka));return 32}CWk(A,W,na,Ga,Ka){if(!Ka||A!==fd.a.Ioa)return 8;A=Ka.queryResult;Ka=Ka.SourceControlId;if(!Ka||"TransitionExisting"!==Ka)return 16;W=this.Dn.JQ(Ka);if(!W)return 8;Ga=W.uc.split("_")[1]+"_24";W=ed.BTa(Ka,Ka,Ga,"3752636652","3476251476",W.rc,W.rc);A.W3=W;W=this.pa.Se();if(!W||!W.length)return 16;
if(1===na&&(na="",({Rpa:na}=this.zSa(W)).returnValue)){W=this.Dn.s3c(na,this.Dn.nyb());if(na&&!W){Ga=this.Dn.JQ(na);if(!Ga)return 8;const qb=Ga.uc.split("_")[1]+"_24";Ka=ed.BTa(Ka,Ka,qb,"3752636652","3476251476",Ga.rc,Ga.rc);A.W3=Ka}A.kV(!na||!!na&&!W)}return 32}DWk(A,W,na,Ga,Ka){if(!Ka||A!==fd.a.wya)return 8;A=Ka.queryResult;Ka=Ka.SourceControlId;if(!Ka||"TransitionExistingInMenu"!==Ka)return 16;W=this.Dn.JQ(Ka);if(!W)return 8;Ga=W.uc.split("_")[1]+"_24";Ka=ed.BTa(Ka,Ka,Ga,"4036532528","2831233208",
W.rc,W.rc);A.W3=Ka;Ka=this.pa.Se();if(!Ka||!Ka.length)return 16;1===na&&(na="",({Rpa:na}=this.zSa(Ka)).returnValue&&A.kV(!na));return 32}AWk(A,W,na){A=this.pa.Se();if(!A||!A.length)return 16;W=this.Dn.dzb(A[0].xo);return!W||!W.next||1<A.length&&!this.zSa(A).returnValue?16:1===na?32:8}K_e(A,W,na,Ga,Ka){if(!Ka)return 8;W=Ka.SourceControlId;Ka=A===fd.a.upa||A===fd.a.jza;Ga=this.pa.Se();if(!Ga||!Ga.length)return 16;for(var qb of Ga)if(this.$b.$c(qb))return 16;qb="";const Qb=({Rpa:qb}=this.zSa(Ga)).returnValue;
if(Ka&&(!Qb||qb))return 16;if(1===na)return 32;qb=this.Dn.JQ(W);if(!qb)return 8;if(!Ka&&2===na&&W){xf.a.Ak("SlideCount",Ga.length.toString());na=this.Eb.xd(15,void 0,()=>{this.pa.kj();this.Fa.Bd()});try{na.hc(this.Tb.Ef);na.fd=A;for(const t of Ga)t.xo=qb.tc}finally{na&&na.dispose()}e.ULS.sendTraceTag(512499931,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}",W,qb.next||"null")}return 32}Btl(){if(!Object(Rg.a)("ToggleMorphTransitionToNoneForActionAi")||
!this.GHa)return!1;const A=this.pa.Se();let W=!0;for(const na of A)if(!na.xo||na.W2e!==Nb.morph){W=!1;break}return W}tol(A,W,na,Ga,Ka){if(!Ka)return 8;W=Ka.SourceControlId;this.Btl()&&(W="TransitionNone");if(A!==fd.a.$j)return 8;Ga=this.pa.Se();if(!Ga||!Ga.length)return 16;for(var qb of Ga)if(this.$b.$c(qb))return 16;if(1===na)return 32;qb=this.Dn.JQ(W);if(!qb)return 8;if(2===na&&W){xf.a.Ak("SlideCount",Ga.length.toString());na=this.Eb.xd(15,void 0,()=>{this.pa.kj();this.Fa.Bd()},()=>{1===this.Gb.ol&&
this.Fa.tj(lf.a.lC,!0)});try{na.hc(this.Tb.Ef);na.fd=A;for(const Qb of Ga)Qb.xo=qb.tc}finally{na&&na.dispose()}e.ULS.sendTraceTag(512499930,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}",W,qb.next||"null")}return 32}uol(A,W,na,Ga,Ka){if(!Ka)return 8;W=this.pa.Se();if(!W||!W.length)return 16;if(A!==fd.a.upa||1!==na)return 8;Ga="";A=({Rpa:Ga}=this.zSa(W)).returnValue;na=!!Ga;W=Ga&&0<Ga.length?this.Dn.JQ(Ga):null;W=this.Dn.s3c(W?W.parent:null,this.Dn.nyb());
return!A||na&&W?16:32}vol(A,W,na,Ga,Ka){if(!Ka)return 8;W=this.pa.Se();if(!W||!W.length)return 16;if(A!==fd.a.jza||1!==na)return 8;A="";return!({Rpa:A}=this.zSa(W)).returnValue||A?16:32}sol(A,W,na,Ga,Ka){if(!Ka)return 8;W=Ka.MenuItemId;if(1===na)return 32;na=this.pa.Se();if(!na||!na.length)return 16;for(var qb of na)if(this.$b.$c(qb)||!qb.xo)return 16;qb=this.Dn.JQ(W);if(!qb||!qb.tc)return 16;xf.a.Ak("SlideCount",na.length.toString());Ga=this.Eb.xd(15,void 0,()=>{this.pa.kj();this.Fa.Bd()});try{Ga.hc(this.Tb.Ef);
Ga.fd=A;for(const Qb of na){let t=Qb.xo;t.TransitionType=qb.tc.TransitionType;t.Direction=qb.tc.Direction;t.Duration=qb.tc.Duration;Qb.xo=t}}finally{Ga&&Ga.dispose()}e.ULS.sendTraceTag(512499929,801,50,"TransitionActor: Command=SetTransitionEffectOption, TransitionType={0}, TransitionEffectOption={1}",qb.parent,W);return 32}zWk(A,W,na,Ga,Ka){if(!Ka)return 8;A=Ka.queryResult;Ka=Ka.MenuItemId;W=this.pa.Se();if(!W||!W.length)return 16;1===na&&(na="",({Rpa:na}=this.ZVi(W)).returnValue&&A.Hf(na===Ka));
return 32}yWk(A,W,na,Ga,Ka){if(!Ka)return 8;A=this.pa.Se();if(!A||!A.length)return 16;if(Ka=Ka.queryResult)A=ed.Jsj(A),Ka.iba=A;return 32}rol(A,W,na,Ga,Ka){if(!Ka)return 8;W=this.pa.Se();if(!W||!W.length)return 16;for(const qb of W)if(this.$b.$c(qb))return 16;Ka=Math.floor(1E3*Ka.Number);for(const qb of W)if(!qb.xo)return 16;xf.a.Kb&&(xf.a.Kb.actionName="SetTransitionDuration");if(1===na){for(const qb of W)if("TransitionNone"===this.Dn.xUa(qb.xo))return 16;return 32}if(2===na){const qb=this.Fa.Ee;
xf.a.Ak("SlideCount",W.length.toString());na=this.Eb.xd(15,void 0,()=>{this.pa.kj();!qb||qb.name!==lf.a.vg&&qb.name!==lf.a.Lz||this.Fa.Bd()});try{na.hc(this.Tb.Ef);na.fd=A;for(const Qb of W){const t=Qb.xo;t.Duration=Ka;Qb.xo=t}}finally{na&&na.dispose()}}return 32}zSa(A){let W;W="";if(!A||!A.length)return{returnValue:!1,Rpa:W};W=this.Dn.xUa(A[0].xo);let na=!0;if(1<A.length)for(const Ga of A)if(A=this.Dn.xUa(Ga?Ga.xo:null),W!==A){na=!1;break}na||(W="");return{returnValue:na,Rpa:W}}ZVi(A){let W;W="";
if(!A||!A.length)return{returnValue:!1,Rpa:W};W=this.Dn.wUa(A[0].xo);let na=!0;if(1<A.length)for(const Ga of A)if(A=this.Dn.wUa(Ga?Ga.xo:null),W!==A){na=!1;break}na||(W="");return{returnValue:na,Rpa:W}}OFf(A){const W=Object.assign(new sh.a,{Id:"TransitionMenuEffectOptions",UpdateDynamically:!0,Title:ResourceStrings.L_TransitionEffectOptions,MenuSectionList:[]}),na=Object.assign(new Sh.a,{Id:"MenuSectionEffectOptions",ControlsId:"MenuSectionEffectOptions.Controls",DisplayMode:"Menu32",ControlList:[]});
Array.add(W.MenuSectionList,na);let Ga=null;for(A=({key:Ga}=this.Dn.z9f(A)).returnValue;A;)Array.add(na.ControlList,Object.assign(new Yb.a,{Command:"961566706",Id:Ga,ExternalId:"TransitionEffectOptions"+Ga,QueryCommand:"3535869262"})),{key:Ga,returnValue:A}=this.Dn.z9f(A);return W}static Jsj(A){let W;if(!A||!A.length)return"0";const na=A[0].xo;W=na?(na.Duration/1E3).toString():"0";let Ga=!0;if(1<A.length)for(const Ka of A)if((A=Ka?Ka.xo:null)||na){if(!A&&na||A&&!na){Ga=!1;break}if(W!==(A.Duration/
1E3).toString()){Ga=!1;break}}Ga||(W="0");return W}static S8d(A,W,na){A=String.format('<SPAN class="cui-img-32by32 cui-img-cont-float" unselectable="on"><IMG class="{0}" src="{1}" unselectable="on"></SPAN>',A,na);W=String.format('<P class="cui-ctl-mediumlabel GalleryButtonLabel" unselectable="on">{0}</P>',W);return String.format('<DIV class="GalleryButtonWithLabel">{0}{1}</DIV>',A,W)}static BTa(A,W,na,Ga,Ka,qb,Qb){return Object.assign(new dd.a,{Id:A,ExternalId:W,Icon:na,Command:Ga,QueryCommand:Ka,
LabelText:qb,FullIconStyle:{root:{width:"32px",height:"32px"}},PreviewIconStyle:{root:{width:"24px",height:"24px"}},Alt:Qb})}}Object(h.a)(ed,"TransitionActor",null,[251]);var zd=d(1050);class Hd{constructor(){this.effectId=this.effectType=0;this.labelText=this.Ue=this.effectData=this.eo=null}}Object(h.a)(Hd,"AnimInfo",null,[]);class ba{constructor(){this.Pj=this.labelText=this.Ue=this.id=null}}Object(h.a)(ba,"EffectOption",null,[]);class Aa extends ba{constructor(){super();this.value=null}}Object(h.a)(Aa,
"EffectData",ba,[]);class Pa{constructor(A){this.$Wa=A;Pa.Rl||(Pa.Rl=new zd.a,Pa.Rl.add("FromBottom",Object.assign(new ba,{id:"FromBottom",Ue:Pa.nf("AnimEffectPropFromBottom"),labelText:ResourceStrings.L_EffectOptionsDirectionFromBottom,Pj:CommonUIStrings.l_AnimationFromBottomKeytip})),Pa.Rl.add("FromBottomLeft",Object.assign(new ba,{id:"FromBottomLeft",Ue:Pa.nf("AnimEffectPropFromBottomLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionFromBottomLeft,Pj:CommonUIStrings.l_AnimationFromBottomLeftKeytip})),
Pa.Rl.add("FromLeft",Object.assign(new ba,{id:"FromLeft",Ue:Pa.nf("AnimEffectPropFromLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionFromLeft,Pj:CommonUIStrings.l_AnimationFromLeftKeytip})),Pa.Rl.add("FromTopLeft",Object.assign(new ba,{id:"FromTopLeft",Ue:Pa.nf("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionFromTopLeft,Pj:CommonUIStrings.l_AnimationFromTopLeftKeytip})),Pa.Rl.add("FromTop",Object.assign(new ba,{id:"FromTop",Ue:Pa.nf("AnimEffectPropFromTop"),
labelText:ResourceStrings.L_EffectOptionsDirectionFromTop,Pj:CommonUIStrings.l_AnimationFromTopKeytip})),Pa.Rl.add("FromTopRight",Object.assign(new ba,{id:"FromTopRight",Ue:Pa.nf("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionFromTopRight,Pj:CommonUIStrings.l_AnimationFromTopRightKeytip})),Pa.Rl.add("FromRight",Object.assign(new ba,{id:"FromRight",Ue:Pa.nf("AnimEffectPropFromRight"),labelText:ResourceStrings.L_EffectOptionsDirectionFromRight,Pj:CommonUIStrings.l_AnimationFromRightKeytip})),
Pa.Rl.add("FromBottomRight",Object.assign(new ba,{id:"FromBottomRight",Ue:Pa.nf("AnimEffectPropFromBottomRight"),labelText:ResourceStrings.L_EffectOptionsDirectionFromBottomRight,Pj:CommonUIStrings.l_AnimationFromBottomRightKeytip})),Pa.Rl.add("ToBottom",Object.assign(new ba,{id:"ToBottom",Ue:Pa.nf("AnimEffectPropFromTop"),labelText:ResourceStrings.L_EffectOptionsDirectionToBottom,Pj:CommonUIStrings.l_AnimationFromBottomKeytip})),Pa.Rl.add("ToBottomLeft",Object.assign(new ba,{id:"ToBottomLeft",Ue:Pa.nf("AnimEffectPropFromTopRight"),
labelText:ResourceStrings.L_EffectOptionsDirectionToBottomLeft,Pj:CommonUIStrings.l_AnimationFromBottomLeftKeytip})),Pa.Rl.add("ToLeft",Object.assign(new ba,{id:"ToLeft",Ue:Pa.nf("AnimEffectPropFromRight"),labelText:ResourceStrings.L_EffectOptionsDirectionToLeft,Pj:CommonUIStrings.l_AnimationFromLeftKeytip})),Pa.Rl.add("ToTopLeft",Object.assign(new ba,{id:"ToTopLeft",Ue:Pa.nf("AnimEffectPropFromBottomRight"),labelText:ResourceStrings.L_EffectOptionsDirectionToTopLeft,Pj:CommonUIStrings.l_AnimationFromTopLeftKeytip})),
Pa.Rl.add("ToTop",Object.assign(new ba,{id:"ToTop",Ue:Pa.nf("AnimEffectPropFromBottom"),labelText:ResourceStrings.L_EffectOptionsDirectionToTop,Pj:CommonUIStrings.l_AnimationFromTopKeytip})),Pa.Rl.add("ToTopRight",Object.assign(new ba,{id:"ToTopRight",Ue:Pa.nf("AnimEffectPropFromBottomLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToTopRight,Pj:CommonUIStrings.l_AnimationFromTopRightKeytip})),Pa.Rl.add("ToRight",Object.assign(new ba,{id:"ToRight",Ue:Pa.nf("AnimEffectPropFromLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToRight,
Pj:CommonUIStrings.l_AnimationFromRightKeytip})),Pa.Rl.add("ToBottomRight",Object.assign(new ba,{id:"ToBottomRight",Ue:Pa.nf("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToBottomRight,Pj:CommonUIStrings.l_AnimationFromBottomRightKeytip})),Pa.Rl.add("Horizontal",Object.assign(new ba,{id:"Horizontal",Ue:Pa.nf("AnimEffectPropHorizontal"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontal,Pj:CommonUIStrings.l_AnimationHorizontalKeytip})),Pa.Rl.add("HorizontalIn",
Object.assign(new ba,{id:"HorizontalIn",Ue:Pa.nf("AnimEffectPropHorizontalIn"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontalIn,Pj:CommonUIStrings.l_AnimationHorizontalInKeytip})),Pa.Rl.add("HorizontalOut",Object.assign(new ba,{id:"HorizontalOut",Ue:Pa.nf("AnimEffectPropHorizontalOut"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontalOut,Pj:CommonUIStrings.l_AnimationHorizontalOutKeytip})),Pa.Rl.add("Vertical",Object.assign(new ba,{id:"Vertical",Ue:Pa.nf("AnimEffectPropVertical"),
labelText:ResourceStrings.L_EffectOptionsDirectionVertical,Pj:CommonUIStrings.l_AnimationVerticalKeytip})),Pa.Rl.add("VerticalIn",Object.assign(new ba,{id:"VerticalIn",Ue:Pa.nf("AnimEffectPropVerticalIn"),labelText:ResourceStrings.L_EffectOptionsDirectionVerticalIn,Pj:CommonUIStrings.l_AnimationVerticalInKeytip})),Pa.Rl.add("VerticalOut",Object.assign(new ba,{id:"VerticalOut",Ue:Pa.nf("AnimEffectPropVerticalOut"),labelText:ResourceStrings.L_EffectOptionsDirectionVerticalOut,Pj:CommonUIStrings.l_AnimationVerticalOutKeytip})),
Pa.Rl.add("LeftDown",Object.assign(new ba,{id:"LeftDown",Ue:Pa.nf("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionLeftDown,Pj:CommonUIStrings.l_AnimationLeftDownKeytip})),Pa.Rl.add("LeftUp",Object.assign(new ba,{id:"LeftUp",Ue:Pa.nf("AnimEffectPropFromBottomRight"),labelText:ResourceStrings.L_EffectOptionsDirectionLeftUp,Pj:CommonUIStrings.l_AnimationLeftUpKeytip})),Pa.Rl.add("RightDown",Object.assign(new ba,{id:"RightDown",Ue:Pa.nf("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionRightDown,
Pj:CommonUIStrings.l_AnimationRightDownKeytip})),Pa.Rl.add("RightUp",Object.assign(new ba,{id:"RightUp",Ue:Pa.nf("AnimEffectPropFromBottomLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionRightUp,Pj:CommonUIStrings.l_AnimationRightUpKeytip})),Pa.Rl.add("In",Object.assign(new ba,{id:"In",Ue:Pa.nf("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionIn,Pj:CommonUIStrings.l_AnimationInKeytip})),Pa.Rl.add("InBottom",Object.assign(new ba,{id:"InBottom",Ue:Pa.nf("AnimEffectPropIn"),
labelText:ResourceStrings.L_EffectOptionsDirectionInToScreenBottom,Pj:CommonUIStrings.l_AnimationInToScreenBottomKeytip})),Pa.Rl.add("InCenter",Object.assign(new ba,{id:"InCenter",Ue:Pa.nf("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionInCenter,Pj:CommonUIStrings.l_AnimationOutToScreenCenterKeytip})),Pa.Rl.add("InSlightly",Object.assign(new ba,{id:"InSlightly",Ue:Pa.nf("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionInSlightly,Pj:CommonUIStrings.l_AnimationInSlightlyKeytip})),
Pa.Rl.add("Out",Object.assign(new ba,{id:"Out",Ue:Pa.nf("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOut,Pj:CommonUIStrings.l_AnimationOutKeytip})),Pa.Rl.add("OutBottom",Object.assign(new ba,{id:"OutBottom",Ue:Pa.nf("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutBottom,Pj:CommonUIStrings.l_AnimationOutFromScreenBottomKeytip})),Pa.Rl.add("OutCenter",Object.assign(new ba,{id:"OutCenter",Ue:Pa.nf("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutToScreenCenter,
Pj:CommonUIStrings.l_AnimationOutToScreenCenterKeytip})),Pa.Rl.add("OutSlightly",Object.assign(new ba,{id:"OutSlightly",Ue:Pa.nf("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutSlightly,Pj:CommonUIStrings.l_AnimationOutSlightlyKeytip})),Pa.Rl.add("FloatUp",Object.assign(new ba,{id:"FloatUp",Ue:Pa.nf("AnimEffectPropFloatUp"),labelText:ResourceStrings.L_EffectOptionsDirectionFloatUp,Pj:CommonUIStrings.l_AnimationOutKeytip})),Pa.Rl.add("FloatDown",Object.assign(new ba,{id:"FloatDown",
Ue:Pa.nf("AnimEffectPropFloatDown"),labelText:ResourceStrings.L_EffectOptionsDirectionFloatDown,Pj:CommonUIStrings.l_AnimationDownKeytip})),Pa.Rl.add("ObjectCenter",Object.assign(new ba,{id:"ObjectCenter",Ue:Pa.nf("AnimEffectPropFadedZoomIn"),labelText:ResourceStrings.L_EffectOptionsDirectionObjectCenter,Pj:CommonUIStrings.l_AnimationObjectCenterKeytip})),Pa.Rl.add("SlideCenter",Object.assign(new ba,{id:"SlideCenter",Ue:Pa.nf("AnimEffectPropFadedZoomInFromCenter"),labelText:ResourceStrings.L_EffectOptionsDirectionSlideCenter,
Pj:CommonUIStrings.l_AnimationSlideCenterKeytip})),Pa.Rl.add("ObjectCenterOut",Object.assign(new ba,{id:"ObjectCenterOut",Ue:Pa.nf("AnimEffectPropFadedZoomIn"),labelText:ResourceStrings.L_EffectOptionsDirectionObjectCenter,Pj:CommonUIStrings.l_AnimationObjectCenterKeytip})),Pa.Rl.add("SlideCenterOut",Object.assign(new ba,{id:"SlideCenterOut",Ue:Pa.nf("AnimEffectPropFadedZoomInFromCenter"),labelText:ResourceStrings.L_EffectOptionsDirectionSlideCenter,Pj:CommonUIStrings.l_AnimationSlideCenterKeytip})),
Pa.Rl.add("Clockwise",Object.assign(new ba,{id:"Clockwise",Ue:Pa.nf("AnimEffectPropClockwise"),labelText:ResourceStrings.L_EffectOptionsDirectionClockwise,Pj:CommonUIStrings.l_AnimationClockWiseKeytip})),Pa.Rl.add("CounterClockwise",Object.assign(new ba,{id:"CounterClockwise",Ue:Pa.nf("AnimEffectPropCounterclockwise"),labelText:ResourceStrings.L_EffectOptionsDirectionCounterClockwise,Pj:CommonUIStrings.l_AnimationCounterClockWiseKeytip})),Pa.Rl.add("Across",Object.assign(new ba,{id:"Across",Ue:Pa.nf("AnimEffectPropHorizontal"),
labelText:ResourceStrings.L_EffectOptionsDirectionAcross,Pj:CommonUIStrings.l_AnimationAcrossKeytip})),Pa.Rl.add("Up",Object.assign(new ba,{id:"Up",Ue:Pa.nf("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionUp,Pj:CommonUIStrings.l_AnimationUpKeytip})),Pa.Rl.add("Down",Object.assign(new ba,{id:"Down",Ue:Pa.nf("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionDown,Pj:CommonUIStrings.l_AnimationDownKeytip})),Pa.Rl.add("GrowShrinkHorizontal",Object.assign(new ba,
{id:"GrowShrinkHorizontal",Ue:Pa.nf("AnimEffectPropGrowShrinkHorizontal"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontal,Pj:CommonUIStrings.l_AnimationHorizontalKeytip})),Pa.Rl.add("GrowShrinkVertical",Object.assign(new ba,{id:"GrowShrinkVertical",Ue:Pa.nf("AnimEffectPropGrowShrinkVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionVertical,Pj:CommonUIStrings.l_AnimationVerticalKeytip})),Pa.Rl.add("GrowShrinkBoth",Object.assign(new ba,{id:"GrowShrinkBoth",Ue:Pa.nf("AnimEffectPropBoth"),
labelText:ResourceStrings.L_EffectOptionsDirectionBoth,Pj:CommonUIStrings.l_AnimationBothKeytip})));Pa.vT||(Pa.vT=new zd.a,Pa.vT.add("Spin_Quarter",Object.assign(new Aa,{id:"Spin_Quarter",Ue:Pa.nf("AnimEffectPropQuarterSpin"),labelText:ResourceStrings.L_EffectOptionsSpinQuarter,value:"90",Pj:CommonUIStrings.l_AnimationQuarterSpinKeytip})),Pa.vT.add("Spin_Half",Object.assign(new Aa,{id:"Spin_Half",Ue:Pa.nf("AnimEffectPropHalfSpin"),labelText:ResourceStrings.L_EffectOptionsSpinHalf,value:"180",Pj:CommonUIStrings.l_AnimationHalfSpinKeytip})),
Pa.vT.add("Spin_Full",Object.assign(new Aa,{id:"Spin_Full",Ue:Pa.nf("AnimEffectPropFullSpin"),labelText:ResourceStrings.L_EffectOptionsSpinFull,value:"360",Pj:CommonUIStrings.l_AnimationFullSpinKeytip})),Pa.vT.add("Spin_Two",Object.assign(new Aa,{id:"Spin_Two",Ue:Pa.nf("AnimEffectPropTwoSpins"),labelText:ResourceStrings.L_EffectOptionsSpinTwo,value:"720",Pj:CommonUIStrings.l_AnimationTwoSpinKeytip})),Pa.vT.add("Transparency_25",Object.assign(new Aa,{id:"Transparency_25",Ue:Pa.nf("AnimEffectPropTransparent25"),
labelText:ResourceStrings.L_EffectOptionsTransparency25Percent,value:"0.75",Pj:CommonUIStrings.l_Animation25PerKeytip})),Pa.vT.add("Transparency_50",Object.assign(new Aa,{id:"Transparency_50",Ue:Pa.nf("AnimEffectPropTransparent50"),labelText:ResourceStrings.L_EffectOptionsTransparency50Percent,value:"0.5",Pj:CommonUIStrings.l_Animation50PerKeytip})),Pa.vT.add("Transparency_75",Object.assign(new Aa,{id:"Transparency_75",Ue:Pa.nf("AnimEffectPropTransparent75"),labelText:ResourceStrings.L_EffectOptionsTransparency75Percent,
value:"0.25",Pj:CommonUIStrings.l_Animation75PerKeytip})),Pa.vT.add("Transparency_100",Object.assign(new Aa,{id:"Transparency_100",Ue:Pa.nf("AnimEffectPropTransparent100"),labelText:ResourceStrings.L_EffectOptionsTransparency100Percent,value:"0.0",Pj:CommonUIStrings.l_Animation100PerKeytip})),Pa.vT.add("GrowShrink_Tiny",Object.assign(new Aa,{id:"GrowShrink_Tiny",Ue:Pa.nf("AnimEffectPropTiny"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkTiny,value:"25",Pj:CommonUIStrings.l_AnimationTinyKeytip})),
Pa.vT.add("GrowShrink_Smaller",Object.assign(new Aa,{id:"GrowShrink_Smaller",Ue:Pa.nf("AnimEffectPropSmaller"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkSmaller,value:"50",Pj:CommonUIStrings.l_AnimationSmallerKeytip})),Pa.vT.add("GrowShrink_Larger",Object.assign(new Aa,{id:"GrowShrink_Larger",Ue:Pa.nf("AnimEffectPropLarger"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkLarger,value:"150",Pj:CommonUIStrings.l_AnimationLargerKeytip})),Pa.vT.add("GrowShrink_Huge",Object.assign(new Aa,
{id:"GrowShrink_Huge",Ue:Pa.nf("AnimEffectPropHuge"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkHuge,value:"400",Pj:CommonUIStrings.l_AnimationHugeKeytip})));if(!Pa.wm)if(Pa.wm=new zd.a,Pa.wm.add("Existing",Object.assign(new Hd,{effectType:-1,effectId:-1,Ue:Pa.nf("AnimFxMultiple"),labelText:ResourceStrings.L_AnimationExisting,eo:[],effectData:[]})),Pa.wm.add("None",Object.assign(new Hd,{effectType:0,effectId:0,Ue:Pa.nf("AnimFxNone"),labelText:ResourceStrings.L_AnimationNone,eo:[],effectData:[]})),
Pa.wm.add("Appear",Object.assign(new Hd,{effectType:0,effectId:1,Ue:Pa.nf("AnimFxEntranceAppear"),labelText:ResourceStrings.L_AnimationAppear,eo:[],effectData:[]})),Pa.wm.add("FadeIn",Object.assign(new Hd,{effectType:0,effectId:10,Ue:Pa.nf("AnimFxEntranceFadeIn"),labelText:ResourceStrings.L_AnimationFade,eo:[],effectData:[]})),this.$Wa){Pa.wm.add("FlyIn",Object.assign(new Hd,{effectType:0,effectId:2,Ue:Pa.nf("AnimFxEntranceFlyIn"),labelText:ResourceStrings.L_AnimationFlyIn,eo:"FromBottom FromBottomLeft FromLeft FromTopLeft FromTop FromTopRight FromRight FromBottomRight".split(" "),
effectData:[]}));Pa.wm.add("Wipe",Object.assign(new Hd,{effectType:0,effectId:22,Ue:Pa.nf("AnimFxEntranceWipeIn"),labelText:ResourceStrings.L_AnimationWipe,eo:["FromBottom","FromLeft","FromRight","FromTop"],effectData:[]}));Pa.wm.add("Zoom",Object.assign(new Hd,{effectType:0,effectId:53,Ue:Pa.nf("AnimFxEntranceFadedZoom"),labelText:ResourceStrings.L_AnimationZoom,eo:["ObjectCenter","SlideCenter"],effectData:[]}));Pa.wm.add("Checkerboard",Object.assign(new Hd,{effectType:0,effectId:5,Ue:Pa.nf("AnimFxEntranceGeneric"),
labelText:ResourceStrings.L_AnimationCheckerboard,eo:["Across","Down"],effectData:[]}));Pa.wm.add("BasicZoom",Object.assign(new Hd,{effectType:0,effectId:23,Ue:Pa.nf("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationBasicZoom,eo:"In InCenter InSlightly Out OutBottom OutSlightly".split(" "),effectData:[]}));Pa.wm.add("Blinds",Object.assign(new Hd,{effectType:0,effectId:3,Ue:Pa.nf("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationBlinds,eo:["Horizontal","Vertical"],effectData:[]}));
let W;Pa.wm.add("Box",(W=new Hd,W.effectType=0,W.effectId=4,W.Ue=Pa.nf("AnimFxEntranceShape"),W.labelText=ResourceStrings.L_AnimationBox,W.eo=["In","Out"],W.effectData=[],W));let na;Pa.wm.add("PeekIn",(na=new Hd,na.effectType=0,na.effectId=12,na.Ue=Pa.nf("AnimFxEntranceGeneric"),na.labelText=ResourceStrings.L_AnimationPeekIn,na.eo=["FromBottom","FromLeft","FromRight","FromTop"],na.effectData=[],na));let Ga;Pa.wm.add("Expand",(Ga=new Hd,Ga.effectType=0,Ga.effectId=55,Ga.Ue=Pa.nf("AnimFxEntranceGeneric"),
Ga.labelText=ResourceStrings.L_AnimationExpand,Ga.eo=[],Ga.effectData=[],Ga));let Ka;Pa.wm.add("GrowAndTurn",(Ka=new Hd,Ka.effectType=0,Ka.effectId=31,Ka.Ue=Pa.nf("AnimFxEntranceGrowAndTurn"),Ka.labelText=ResourceStrings.L_AnimationGrowAndTurn,Ka.eo=[],Ka.effectData=[],Ka));let qb;Pa.wm.add("RandomBars",(qb=new Hd,qb.effectType=0,qb.effectId=14,qb.Ue=Pa.nf("AnimFxEntranceRandomBars"),qb.labelText=ResourceStrings.L_AnimationRandomBars,qb.eo=["Horizontal","Vertical"],qb.effectData=[],qb));let Qb;Pa.wm.add("RiseUp",
(Qb=new Hd,Qb.effectType=0,Qb.effectId=37,Qb.Ue=Pa.nf("AnimFxEntranceGeneric"),Qb.labelText=ResourceStrings.L_AnimationRiseUp,Qb.eo=[],Qb.effectData=[],Qb));let t;Pa.wm.add("Split",(t=new Hd,t.effectType=0,t.effectId=16,t.Ue=Pa.nf("AnimFxEntranceSplit"),t.labelText=ResourceStrings.L_AnimationSplit,t.eo=["HorizontalIn","HorizontalOut","VerticalIn","VerticalOut"],t.effectData=[],t));let Y;Pa.wm.add("Strips",(Y=new Hd,Y.effectType=0,Y.effectId=18,Y.Ue=Pa.nf("AnimFxEntranceGeneric"),Y.labelText=ResourceStrings.L_AnimationStrips,
Y.eo=["LeftDown","LeftUp","RightDown","RightUp"],Y.effectData=[],Y));let pa;Pa.wm.add("Stretch",(pa=new Hd,pa.effectType=0,pa.effectId=17,pa.Ue=Pa.nf("AnimFxEntranceGeneric"),pa.labelText=ResourceStrings.L_AnimationStretch,pa.eo=["Across","FromBottom","FromLeft","FromRight","FromTop"],pa.effectData=[],pa));let Ja;Pa.wm.add("Exit_Disappear",(Ja=new Hd,Ja.effectType=1,Ja.effectId=1,Ja.Ue=Pa.nf("AnimFxExitDisappear"),Ja.labelText=ResourceStrings.L_AnimationDisappear,Ja.eo=[],Ja.effectData=[],Ja));let Ya;
Pa.wm.add("Exit_Fade",(Ya=new Hd,Ya.effectType=1,Ya.effectId=10,Ya.Ue=Pa.nf("AnimFxExitFadeOut"),Ya.labelText=ResourceStrings.L_AnimationFade,Ya.eo=[],Ya.effectData=[],Ya));let jb;Pa.wm.add("Exit_FlyOut",(jb=new Hd,jb.effectType=1,jb.effectId=2,jb.Ue=Pa.nf("AnimFxExitFlyOut"),jb.labelText=ResourceStrings.L_AnimationFlyOut,jb.eo="ToBottom ToBottomLeft ToLeft ToTopLeft ToTop ToTopRight ToRight ToBottomRight".split(" "),jb.effectData=[],jb));let Sb;Pa.wm.add("Exit_Wipe",(Sb=new Hd,Sb.effectType=1,Sb.effectId=
22,Sb.Ue=Pa.nf("AnimFxExitWipe"),Sb.labelText=ResourceStrings.L_AnimationWipe,Sb.eo=["FromBottom","FromLeft","FromRight","FromTop"],Sb.effectData=[],Sb));let kc;Pa.wm.add("Exit_Zoom",(kc=new Hd,kc.effectType=1,kc.effectId=53,kc.Ue=Pa.nf("AnimFxExitFadedZoom"),kc.labelText=ResourceStrings.L_AnimationZoom,kc.eo=["ObjectCenterOut","SlideCenterOut"],kc.effectData=[],kc));let db;Pa.wm.add("Exit_Checkerboard",(db=new Hd,db.effectType=1,db.effectId=5,db.Ue=Pa.nf("AnimFxExitGeneric"),db.labelText=ResourceStrings.L_AnimationCheckerboard,
db.eo=["Across","Up"],db.effectData=[],db));let Kb;Pa.wm.add("Exit_BasicZoom",(Kb=new Hd,Kb.effectType=1,Kb.effectId=23,Kb.Ue=Pa.nf("AnimFxExitGeneric"),Kb.labelText=ResourceStrings.L_AnimationBasicZoom,Kb.eo="Out OutCenter OutSlightly In InBottom InSlightly".split(" "),Kb.effectData=[],Kb));let lc;Pa.wm.add("Exit_Blinds",(lc=new Hd,lc.effectType=1,lc.effectId=3,lc.Ue=Pa.nf("AnimFxExitGeneric"),lc.labelText=ResourceStrings.L_AnimationBlinds,lc.eo=["Horizontal","Vertical"],lc.effectData=[],lc));let Jc;
Pa.wm.add("Exit_Box",(Jc=new Hd,Jc.effectType=1,Jc.effectId=4,Jc.Ue=Pa.nf("AnimFxExitShape"),Jc.labelText=ResourceStrings.L_AnimationBox,Jc.eo=["In","Out"],Jc.effectData=[],Jc));let Vc;Pa.wm.add("Exit_PeekOut",(Vc=new Hd,Vc.effectType=1,Vc.effectId=12,Vc.Ue=Pa.nf("AnimFxExitGeneric"),Vc.labelText=ResourceStrings.L_AnimationPeekOut,Vc.eo=["ToBottom","ToLeft","ToRight","ToTop"],Vc.effectData=[],Vc));let vd;Pa.wm.add("Exit_RandomBars",(vd=new Hd,vd.effectType=1,vd.effectId=14,vd.Ue=Pa.nf("AnimFxExitRandomBars"),
vd.labelText=ResourceStrings.L_AnimationRandomBars,vd.eo=["Horizontal","Vertical"],vd.effectData=[],vd));let me;Pa.wm.add("Exit_Split",(me=new Hd,me.effectType=1,me.effectId=16,me.Ue=Pa.nf("AnimFxExitSplit"),me.labelText=ResourceStrings.L_AnimationSplit,me.eo=["HorizontalIn","HorizontalOut","VerticalIn","VerticalOut"],me.effectData=[],me));let mf;Pa.wm.add("Exit_Strips",(mf=new Hd,mf.effectType=1,mf.effectId=18,mf.Ue=Pa.nf("AnimFxExitGeneric"),mf.labelText=ResourceStrings.L_AnimationStrips,mf.eo=
["LeftDown","LeftUp","RightDown","RightUp"],mf.effectData=[],mf));let cf;Pa.wm.add("Exit_Stretchy",(cf=new Hd,cf.effectType=1,cf.effectId=17,cf.Ue=Pa.nf("AnimFxExitGeneric"),cf.labelText=ResourceStrings.L_AnimationStretchy,cf.eo=[],cf.effectData=[],cf));let Bh;Pa.wm.add("Exit_Zoom",(Bh=new Hd,Bh.effectType=1,Bh.effectId=53,Bh.Ue=Pa.nf("AnimFxExitFadedZoom"),Bh.labelText=ResourceStrings.L_AnimationZoom,Bh.eo=["ObjectCenterOut","SlideCenterOut"],Bh.effectData=[],Bh));let Fh;Pa.wm.add("Emphasis_Spin",
(Fh=new Hd,Fh.effectType=2,Fh.effectId=8,Fh.Ue=Pa.nf("AnimFxEmphasisSpin"),Fh.labelText=ResourceStrings.L_AnimationSpin,Fh.eo=["Clockwise","CounterClockwise"],Fh.effectData=["Spin_Quarter","Spin_Half","Spin_Full","Spin_Two"],Fh));let of;Pa.wm.add("Emphasis_Transparency",(of=new Hd,of.effectType=2,of.effectId=9,of.Ue=Pa.nf("AnimFxEmphasisTransparency"),of.labelText=ResourceStrings.L_AnimationTransparency,of.eo=[],of.effectData=["Transparency_25","Transparency_50","Transparency_75","Transparency_100"],
of));let aj;Pa.wm.add("Emphasis_GrowShrink",(aj=new Hd,aj.effectType=2,aj.effectId=6,aj.Ue=Pa.nf("AnimFxEmphasisGrowShrink"),aj.labelText=ResourceStrings.L_AnimationGrowShrink,aj.eo=["GrowShrinkHorizontal","GrowShrinkVertical","GrowShrinkBoth"],aj.effectData=["GrowShrink_Tiny","GrowShrink_Smaller","GrowShrink_Larger","GrowShrink_Huge"],aj));let di;Pa.wm.add("Emphasis_FillColor",(di=new Hd,di.effectType=2,di.effectId=1,di.Ue=Pa.nf("AnimFxEmphasisChangeFillColor"),di.labelText=ResourceStrings.L_AnimationFillColor,
di.eo=[],di.effectData=[],di));let Gi;Pa.wm.add("Emphasis_FontColor",(Gi=new Hd,Gi.effectType=2,Gi.effectId=3,Gi.Ue=Pa.nf("AnimFxEmphasisChangeFontColor"),Gi.labelText=ResourceStrings.L_AnimationFontColor,Gi.eo=[],Gi.effectData=[],Gi));let Xj;Pa.wm.add("Emphasis_LineColor",(Xj=new Hd,Xj.effectType=2,Xj.effectId=7,Xj.Ue=Pa.nf("AnimFxEmphasisChangeLineColor"),Xj.labelText=ResourceStrings.L_AnimationLineColor,Xj.eo=[],Xj.effectData=[],Xj))}else Pa.wm.add("FlyIn",Object.assign(new Hd,{effectType:0,effectId:2,
Ue:Pa.nf("AnimFxEntranceFlyIn"),labelText:ResourceStrings.L_AnimationFlyIn,eo:["FromBottom","FromLeft","FromTop","FromRight"],effectData:[]}))}Y6b(A,W){let na=null;Pa.wm.forEach((Ga,Ka)=>{Ka.effectType===A&&Ka.effectId===W&&(na=Ka);return!0});return na}lXc(A,W){let na=null;Pa.wm.forEach((Ga,Ka)=>{Ka.effectType===A&&Ka.effectId===W&&(na=Ga);return!0});return na}NWc(A,W,na,Ga,Ka){const qb=Object.assign(new Sh.a,{Id:"MenuSectionEffectOptions"+na,ControlsId:"MenuSectionEffectOptionsDirection.Controls",
DisplayMode:"Menu32",ControlList:[]});A=this.Y6b(W,A);if(!A)return qb;if((A=Pa.lgj(A,na))&&A.length)for(W=0;W<A.length;W++){const Qb=Pa.mgj(A[W],na),t="AnimationEffectOptions"+("Direction"===na?"Direction":"Data")+Qb.id;Array.add(qb.ControlList,Object.assign(new Yb.a,{Command:Ga,Id:Qb.id,ExternalId:t,QueryCommand:Ka}))}return qb}eVc(A){var W;return(W=Pa.wm.ga(A))?(A=W.effectType,W=W.effectId,{returnValue:!0,effectType:A,effectId:W}):{returnValue:!1,effectType:-1,effectId:-1}}fVc(A){let W,na;W=Pa.nf("AnimFxMultiple");
na=ResourceStrings.L_AnimationExisting;if(A=Pa.wm.ga(A))W=A.Ue,na=A.labelText;return{image:W,label:na}}V0c(A,W){if(0===A){if(0!==W&&1!==W&&2!==W&&10!==W)return!0}else if(0<A)return!0;return!1}acb(A,W){return A&&W?this.$Wa?(W=W.Pbb()?A.IsTrigger:A.HasTrigger,!!this.Y6b(A.EffectType,A.EffectId)&&!W):!A.HasExisting:!0}P2c(A){return A?this.OAb(Array(A)):!0}OAb(A){if(!A||!A.length)return!0;for(const W of A)if(null==this.Y6b(W.EffectType,W.EffectId))return!1;return!0}Coe(A,W){return W&&A&&this.$Wa?W.Pbb()?
!1:A.HasMultiple:!1}Mac(A){if(!A||!A.length)return!1;const W=A[0].EffectId,na=A[0].EffectType;for(let Ga=1;Ga<A.length;Ga++){const Ka=A[Ga];if(Ka.EffectId!=W||Ka.EffectType!=na)return!0}return!1}Lmg(A){if(A&&this.$Wa&&2===A.EffectType)switch(A.EffectId){case 1:case 3:case 7:return!0}return!1}zqe(A){if(!A)return!1;if(2===A.EffectType)switch(A.EffectId){case 1:case 3:case 7:return!0}return!1}$ej(A){A=Pa.wm.ga(A);return this.s7b(A.eo[0])}Xej(A){return(A=Pa.wm.ga(A))&&A.effectData.length?this.z$d(A.effectData[0]):
""}s7b(A){switch(A){case "FromBottom":case "ToBottom":return 3;case "FromBottomLeft":case "ToBottomLeft":case "LeftDown":return 8;case "FromLeft":case "ToLeft":return 4;case "FromTopLeft":case "ToTopLeft":case "LeftUp":return 5;case "FromTop":case "ToTop":return 1;case "FromTopRight":case "ToTopRight":case "RightUp":return 6;case "FromRight":case "ToRight":return 2;case "FromBottomRight":case "ToBottomRight":case "RightDown":return 7;case "Horizontal":case "Across":return 9;case "HorizontalIn":return 15;
case "HorizontalOut":return 16;case "Vertical":case "Down":case "Up":return 10;case "VerticalIn":return 17;case "VerticalOut":return 18;case "In":case "ObjectCenter":return 11;case "InCenter":case "SlideCenter":return 22;case "InBottom":return 23;case "InSlightly":return 21;case "Out":case "ObjectCenterOut":return 12;case "OutBottom":return 26;case "OutSlightly":return 24;case "OutCenter":case "SlideCenterOut":return 25;case "FloatUp":return 1;case "FloatDown":return 3;case "Clockwise":return 13;
case "CounterClockwise":return 14;case "GrowShrinkHorizontal":return 27;case "GrowShrinkVertical":return 28;case "GrowShrinkBoth":return 29;default:return 0}}z$d(A){return(A=Pa.vT.ga(A))?A.value:""}oMf(A,W){return(W=Pa.vT.ga(W))&&parseFloat(A)===parseFloat(W.value)?!0:!1}Gce(A){switch(A){case "AsOneObject":return 1;case "AllAtOnce":return 2;case "ByParagraph":return 3;case "OneByOne":return 4;default:return 0}}Cwi(A){if(null===A)throw Error.argumentNull("animation");const W=this.Y6b(A.EffectType,
A.EffectId);return!!W&&(0<W.eo.length||0<W.effectData.length||this.Lmg(A))}Dwi(A){if(!A)return!1;const W=this.Y6b(A.EffectType,A.EffectId);return!!W&&(0<W.eo.length||0<W.effectData.length||this.zqe(A))}Ewi(A,W,na){return this.acb(na,A)&&!this.Coe(na,A)&&(this.Cwi(na)||this.KHf(A,W,na)||this.LXd(A,W,na)||this.IHf(A,W,na)||this.MXd(A,na))}Fwi(A,W,na){if(!(A&&W&&na&&na.length&&this.OAb(na)))return!1;A=Pa.sOf(A,na);W=this.LHf(W,A)||this.NHf(W,A)||this.JHf(W,A)||this.PHf(A);let Ga;this.Mac(na)||(Ga=this.Dwi(na[0]));
return Ga||W}$oj(A,W,na){const Ga=Object.assign(new Sh.a,{Id:"MenuSectionEffectOptionsSequence",ControlsId:"MenuSectionEffectOptionsSequence.Controls",DisplayMode:"Menu32",ControlList:[]});this.KHf(A,W,na)&&Array.add(Ga.ControlList,Object.assign(new Yb.a,{Command:"1850236812",Id:"AsOneObject",ExternalId:"AnimationEffectOptionsSequenceAsOneObject",QueryCommand:"1125291975"}));this.IHf(A,W,na)&&this.$Wa&&Array.add(Ga.ControlList,Object.assign(new Yb.a,{Command:"2048458448",Id:"AllAtOnce",ExternalId:"AnimationEffectOptionsSequenceAllAtOnce",
QueryCommand:"1125291975"}));this.LXd(A,W,na)&&Array.add(Ga.ControlList,Object.assign(new Yb.a,{Command:"3467781846",Id:"ByParagraph",ExternalId:"AnimationEffectOptionsSequenceByParagraph",QueryCommand:"1125291975"}));this.MXd(A,na)&&Array.add(Ga.ControlList,Object.assign(new Yb.a,{Command:"1486892994",Id:"OneByOne",ExternalId:"AnimationEffectOptionsSequenceOneByOne",QueryCommand:"1125291975"}));return Ga}apj(A,W,na){const Ga=new Sh.a;Ga.Id="MenuSectionEffectOptionsSequence";Ga.ControlsId="MenuSectionEffectOptionsSequence.Controls";
Ga.DisplayMode="Menu32";Ga.ControlList=[];if(!(A&&A.length&&W&&na&&na.length))return Ga;A=Pa.sOf(A,na);this.LHf(W,A)&&(na=new Yb.a,na.Command="1850236812",na.Id="AsOneObject",na.ExternalId="AnimationEffectOptionsSequenceAsOneObject",na.QueryCommand="1125291975",Ga.ControlList.push(na));this.JHf(W,A)&&(na=new Yb.a,na.Command="2048458448",na.Id="AllAtOnce",na.ExternalId="AnimationEffectOptionsSequenceAllAtOnce",na.QueryCommand="1125291975",Ga.ControlList.push(na));this.NHf(W,A)&&(W=new Yb.a,W.Command=
"3467781846",W.Id="ByParagraph",W.ExternalId="AnimationEffectOptionsSequenceByParagraph",W.QueryCommand="1125291975",Ga.ControlList.push(W));this.PHf(A)&&(W=new Yb.a,W.Command="1486892994",W.Id="OneByOne",W.ExternalId="AnimationEffectOptionsSequenceOneByOne",W.QueryCommand="1125291975",Ga.ControlList.push(W));return Ga}q2j(A){let W=!0,na=0;if(!A)return!1;for(const Ga of A)if(W)na=Ga.EffectId,W=!1;else if(Ga.EffectId!==na)return!1;return!0}Jlj(A,W,na){const Ga={isEnabled:!1,sod:null};if(!A||!W||!W.length)return Ga;
for(var Ka of W)if(Ka.IsTrigger)return Ga;A=Pa.Tkj(A);if(!A.length||Pa.ySj(A,W))return Ga;Ka=A.map(qb=>qb.EffectNodeId);W=W.map(qb=>qb.EffectNodeId).sort((qb,Qb)=>qb-Qb);if(!Pa.E2j(W,Ka))return Ga;if(na){na=Ka.indexOf(W[W.length-1]);if(-1==na||na==Ka.length-1)return Ga;Ga.isEnabled=!0;Ga.sod=Pa.jcg(A[na+1])}else{na=Ka.indexOf(W[0]);if(-1==na||0==na)return Ga;Ga.isEnabled=!0;Ga.sod=Pa.jcg(A[na-1])}return Ga}grj(A){const W=[];if(!A||!A.animations||!A.animations.Sequences)return W;let na=0;for(const Ga of A.animations.Sequences)Ga.Effects&&
(W.push({isTriggerSequence:Ga.IsTriggerSeq,sequenceIndex:Ga.SequenceIndex,description:Ga.Description,animationCount:Ga.Effects.length,sequenceStartIndex:na}),na+=Ga.Effects.length);return W}Sgj(A){const W=[];if(!A||!A.length)return W;const na=new Map;for(var Ga of A.filter(Qb=>!Qb.IsTrigger&&-1!==Qb.GroupId)){var Ka=`${Ga.ShapeId}${","}${Ga.GroupId}`;if(na.has(Ka)){var qb=na.get(Ka);na.set(Ka,qb+1)}else na.set(Ka,1)}Ga=new Set;for(const Qb of A)A=Pa.UKi(Qb),Qb.IsTrigger||(-1===Qb.GroupId?A.IsGroupAnimation=
0<Ga.size:(A.IsGroupAnimation=!0,Ka=`${Qb.ShapeId}${","}${Qb.GroupId}`,0===Ga.size&&(A.IsFirstGroupAnimation=!0),Ga.has(Ka)||Ga.add(Ka),qb=na.get(Ka),qb--,na.set(Ka,qb),0===qb&&Ga.delete(Ka),0===Ga.size&&(A.IsLastGroupAnimation=!0)),A.IsDraggable=!A.IsGroupAnimation||A.IsFirstGroupAnimation&&A.IsLastGroupAnimation),W.push(A);return W}static UKi(A){return Object.assign(Object.assign({},A),{IsDraggable:!1,IsFirstGroupAnimation:!1,IsGroupAnimation:!1,IsLastGroupAnimation:!1})}static sOf(A,W){const na=
new Map;for(const Ga of A)na.set(Ga.id.toString(),Ga);A=new Map;for(const Ga of W)W=vf.a.Jf(Ga.ShapeId),W=na.get(W.toString()),A.set(Ga,W);return A}static jcg(A){const W=new kf;W.EffectNodeId=A.EffectNodeId;W.ShapeId=A.ShapeId;return W}static E2j(A,W){if(!(A&&A.length&&W&&W.length)||A.length>W.length)return!1;const na=A[A.length-1],Ga=W.indexOf(A[0]);return W.indexOf(na)-Ga+1==A.length}static Tkj(A){const W=[];if(!A)return W;A=A.animations;if(!A||!A.Sequences)return W;for(const na of A.Sequences[0].Effects)W.push(na);
return W.sort((na,Ga)=>na.EffectNodeId-Ga.EffectNodeId)}static ySj(A,W){if(!A||!W)return!1;const na=new Map;for(const Ga of A.filter(Ka=>-1!==Ka.GroupId))if(A=`${Ga.ShapeId}${","}${Ga.GroupId}`,na.has(A)){const Ka=na.get(A);na.set(A,Ka+1)}else na.set(A,1);for(const Ga of W.filter(Ka=>-1!==Ka.GroupId))if(W=`${Ga.ShapeId}${","}${Ga.GroupId}`,na.has(W)&&1<na.get(W))return!0;return!1}KHf(A,W,na){return 0!==na.SequenceId&&0!==na.EffectId&&this.acb(na,A)&&(A.Wf||2!==na.EffectType||1!==na.EffectId&&7!==
na.EffectId)&&(A.F4||this.MXd(A,na)||this.LXd(A,W,na))}Hwi(A,W,na){return A&&0!==na.BuildType&&0!==na.EffectId&&this.P2c(na)&&(A.Wf||2!==na.EffectType||1!==na.EffectId&&7!==na.EffectId)&&(A.F4||this.OHf(A,na)||this.MHf(A,W,na))}LHf(A,W){for(let [na,Ga]of W)if(!this.Hwi(Ga,A,na))return!1;return!0}IHf(A,W,na){return 0!==na.SequenceId&&!A.F4&&!A.vd&&0!==na.EffectId&&this.acb(na,A)&&(A.Wf||2!==na.EffectType||1!==na.EffectId&&7!==na.EffectId)&&(A.rl||A.Wf||A.isEditable&&0<W.i9(A).length)}Gwi(A,W,na){return A&&
0!==na.BuildType&&!A.F4&&!A.vd&&0!==na.EffectId&&this.P2c(na)&&(A.Wf||2!==na.EffectType||1!==na.EffectId&&7!==na.EffectId)&&(A.rl||A.Wf||A.isEditable&&0<W.i9(A).length)}JHf(A,W){for(let [na,Ga]of W)if(!this.Gwi(Ga,A,na))return!1;return!0}LXd(A,W,na){return 0!==na.SequenceId&&!A.Wf&&!A.F4&&!A.vd&&0!==na.EffectId&&this.acb(na,A)&&(2!==na.EffectType||1!==na.EffectId&&7!==na.EffectId)&&(A.rl||A.isEditable&&0<W.i9(A).length)}MHf(A,W,na){return A&&0!==na.BuildType&&!A.Wf&&!A.F4&&!A.vd&&0!==na.EffectId&&
this.P2c(na)&&(2!==na.EffectType||1!==na.EffectId&&7!==na.EffectId)&&(A.rl||A.isEditable&&0<W.i9(A).length)}NHf(A,W){for(let [na,Ga]of W)if(!this.MHf(Ga,A,na))return!1;return!0}MXd(A,W){return 0!==W.SequenceId&&A.Wf&&0!==W.EffectId&&this.acb(W,A)}OHf(A,W){return A&&0!==W.BuildType&&A.Wf&&0!==W.EffectId&&this.P2c(W)}PHf(A){for(let [W,na]of A)if(!this.OHf(na,W))return!1;return!0}static nf(A){return Ne.a.eoc+"_"+A+"_32x32x32"}static lgj(A,W){switch(W){case "Direction":return A.eo;case "EffectData":return A.effectData;
default:return null}}static mgj(A,W){switch(W){case "Direction":return Pa.Rl.ga(A);case "EffectData":return Pa.vT.ga(A);default:return null}}}Pa.Rl=null;Pa.vT=null;Pa.wm=null;Object(h.a)(Pa,"AnimationHelper",null,[692]);class ub{constructor(A,W,na,Ga,Ka,qb,Qb){this.BE=null;this.Y4e=!1;this.lIa=na;this.pa=A;(this.ewa=Ga)&&Ka.execute(t=>{this.BE=t});this.ua=Qb;this.ia=W;this.Qma=qb}selectShape(){this.pa&&!this.pa.mX(this.ua)&&this.pa.selectShape(this.ua,!0)}onVolumeChanged(A){const W={ActionFromPlayer:!0};
.2>=A?(W.SourceControlId="SetVolumeLow",this.ia.Ka(fd.a.ctd,2,W)):.2<A&&.8>A?(W.SourceControlId="SetVolumeMedium",this.ia.Ka(fd.a.dtd,2,W)):.8<=A&&(W.SourceControlId="SetVolumeHigh",this.ia.Ka(fd.a.btd,2,W));this.selectShape()}onPlayToggled(A){const W={ActionFromPlayer:!0};A?this.ia.Ka(fd.a.yKc,2,W):this.ia.Ka(fd.a.t0b,2,W);this.selectShape()}onMuteToggled(A){if(A)this.ia.Ka(fd.a.etd,2,{ActionFromPlayer:!0,SourceControlId:"SetVolumeMute"});else this.onVolumeChanged(this.ua.media.vlmField);this.selectShape()}onPlayerReadyStateChanged(A){A&&
appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("AudioPlay",!1))}onMouseHoverStateChanged(A){A||this.pa.Ope(this.ua)||(A=this.yL())&&A.showHidePlayer(!1)}onPlayerClicked(){this.ewa&&this.ia.processAction(fd.a.MQb,2)}onPlayerError(A){bd.a.J(512497820,822,10,"AudioLibraryCallback::OnPlayerError Error Message: {0}",A);A&&-1<A.indexOf("PIPELINE_ERROR_READ")&&this.lIa.kbe(this.Qma.podSessionId,this.ua).then(W=>{const na=this.yL();na&&na.setAudioSrc(W)})}onKeyDown(A){A===nd.a.mNa?
(A=this.yL())&&A.removeFocusFromPlayer():A===nd.a.$q&&(this.Y4e=!0)}onBlur(){const A=this.yL();A&&(this.Y4e?A.setFocusOnPlayer():A.removeFocusFromPlayer());this.Y4e=!1}yL(){return this.ewa&&this.BE?this.BE.yL(this.ua):null}}Object(h.a)(ub,"AudioLibraryCallback",null,[734]);class Lb{constructor(A,W,na,Ga,Ka,qb){this.lIa=A;this.pa=W;this.ia=na;this.ewa=Ga;this.Edb=qb;this.Qma=Ka}JJi(A){return new ub(this.pa,this.ia,this.lIa,this.ewa,this.Edb,this.Qma,A)}}Object(h.a)(Lb,"AudioLibraryCallbackFactory",
null,[660]);class Mb{constructor(A,W,na,Ga){this.volume=A;this.mute=W;this.repeat=na;this.rewind=Ga}}Object(h.a)(Mb,"MediaProperties",null,[]);class kd{constructor(A,W,na,Ga){this.Mek=A;this.zCe=W;this.lIa=na;this.Qma=Ga}createAudioManager(A,W,na){return new Promise((Ga,Ka)=>{this.zCe("audioPlayback").then(()=>{window.self.audioPlayback?(bd.a.J(512497818,801,50,"audio script is loaded successfully"),Ga(this.KJi(A,W,na))):(bd.a.J(512497819,801,10,"Audio script is loaded successfully but AudioPlayback namespace cannot be found"),
Ka("Audio script is loaded successfully but AudioPlayback namespace cannot be found"))}).catch(qb=>{bd.a.J(512497817,801,10,"Failed to load audio script "+qb.toString());Ka("Failed to load audio script ")})})}KJi(A,W,na){const Ga=W.media;let Ka=null;Ga&&(Ka=new Mb(Ga.vlmField,Ga.mteField,Ga.repeatField,Ga.rewindField));const qb=audioPlayback.pptAudioFactoryGlobal.createAudioManager(A,na,this.Mek.JJi(W),Ka);this.lIa.kbe(this.Qma.podSessionId,W).then(Qb=>{qb&&qb.setAudioSrc(Qb)});return qb}}Object(h.a)(kd,
"AudioManagerFactory",null,[661]);var Id=d(1303);class ce{constructor(){this.$Cb=new Id.a}B2k(A,W){W&&this.$Cb.$(W.id,A)}rMh(A){A&&this.$Cb.Fb(A.id)&&(this.$Cb.ga(A.id).dispose(),this.$Cb.remove(A.id))}yL(A){return A&&this.$Cb.Fb(A.id)?this.$Cb.ga(A.id):null}}Object(h.a)(ce,"AudioManagerStore",null,[659]);class Xe{Y5j(A){return!Xe.nyb(Xe.fTl)||A>Xe.t$e?!0:!1}static nyb(A){return(A=document.getElementById(A))?A:null}}Xe.fTl="PptRibbon.Design.ThemeVariants-MaxSize";Xe.t$e=4;Object(h.a)(Xe,"ThemeHelper",
null,[691]);class jd{constructor(){this.Duration=this.Direction=0;this.IsManualAdvance=!1;this.TransitionType=0}}Object(h.a)(jd,"EditTransitionInfo",null,[]);class rd{constructor(){this.next=this.parent=this.tc=this.Vx=this.uc=this.rc=null}}Object(h.a)(rd,"Transition",null,[]);class Wc{}Wc.none=0;Wc.Y6i=5;Wc.Z6i=4;Wc.MFl=1;Wc.nyj=1;Wc.upi=2;Wc.S8=0;Wc.vTa=1;Wc.zEa=2;Wc.xxb=3;Wc.JTc=4;Wc.ITc=5;Wc.MTc=6;Wc.LTc=7;Wc.XXc=2;Wc.uVa=1;Wc.cyj=1;Wc.UWd=0;Wc.uti=1;Wc.tti=2;Wc.eyj=0;Wc.dyj=1;Wc.Udg=2;Wc.oyj=
3;Wc.Aee=0;Wc.$8b=1;Wc.WXc=0;Wc.Mab=1;Wc.Ppi=1;Wc.zEf=0;Wc.ZDh=2;Wc.jzl=0;Wc.OFl=3;Wc.NFl=1;Wc.wheel=1;Wc.psh=29;Wc.H2f=0;Wc.t8i=1;Wc.C8i=2;Wc.M8i=3;Wc.G2f=8;Wc.s8i=9;Wc.B8i=10;Wc.L8i=11;Wc.I2f=12;Wc.w8i=13;Wc.E8i=14;Wc.P8i=15;Wc.J2f=4;Wc.x8i=5;Wc.F8i=6;Wc.Q8i=7;Wc.D8i=0;Wc.N8i=1;Wc.H8i=2;Wc.u8i=3;Wc.C2f=4;Wc.O8i=5;Wc.I8i=6;Wc.v8i=7;Object(h.a)(Wc,"TransitionEffectOptions",null,[]);class wd{constructor(A,W){let na=0;this.Dc=new zd.a;this.GHa=W;this.Dc.$("TransitionExisting",Object.assign(new rd,{rc:ResourceStrings.L_TransitionExisting,
uc:wd.Gc("TransitionFlash"),parent:"TransitionExisting"}));this.Dc.$("TransitionExistingInMenu",Object.assign(new rd,{rc:ResourceStrings.L_TransitionExisting,uc:wd.Gc("TransitionFlash"),parent:"TransitionExisting"}));this.Dc.$("TransitionNone",Object.assign(new rd,{rc:ResourceStrings.L_TransitionNone,uc:wd.Gc("TransitionNone"),tc:Object.assign(new jd,{TransitionType:Nb.none,Direction:Wc.upi,Duration:0,IsManualAdvance:!0}),parent:"TransitionNone"}));this.Dc.$("TransitionFade",Object.assign(new rd,
{rc:ResourceStrings.L_TransitionFade,uc:wd.Gc("TransitionFadeSmoothly"),tc:Object.assign(new jd,{TransitionType:Nb.LAf,Direction:Wc.none,Duration:700,IsManualAdvance:!0}),parent:"TransitionFade",next:"TransitionFadeSmoothly"}));this.Dc.$("TransitionFadeSmoothly",Object.assign(new rd,{rc:ResourceStrings.L_TransitionSmoothly,Vx:CommonUIStrings.l_TransitionFadeSmoothlyKeytip,uc:wd.Gc("TransitionFadeSmoothly"),tc:Object.assign(new jd,{TransitionType:Nb.LAf,Direction:Wc.none,Duration:700,IsManualAdvance:!0}),
parent:"TransitionFade",next:"TransitionFadeThroughBlack"}));this.Dc.$("TransitionFadeThroughBlack",Object.assign(new rd,{rc:ResourceStrings.L_TransitionThroughBlack,Vx:CommonUIStrings.l_TransitionFadeThroughBlackKeytip,uc:wd.Gc("TransitionFadeThroughBlack"),tc:Object.assign(new jd,{TransitionType:Nb.fade,Direction:Wc.none,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionFade"}));let Ga=[];if(A){Ga=A.toLowerCase().split(",");for(let Ka=0;Ka<Ga.length;Ka++)Ga[Ka]=Ga[Ka].trim()}Array.contains(Ga,
"push")||(this.Dc.$("TransitionPush",Object.assign(new rd,{rc:ResourceStrings.L_TransitionPush,uc:wd.Gc("TransitionPushUp"),tc:Object.assign(new jd,{TransitionType:Nb.push,Direction:Wc.vTa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromBottom"})),this.Dc.$("TransitionPushFromBottom",Object.assign(new rd,{rc:ResourceStrings.L_TransitionFromBottom,Vx:CommonUIStrings.l_TransitionPushFromBottomKeytip,uc:wd.Gc("TransitionPushUp"),tc:Object.assign(new jd,{TransitionType:Nb.push,
Direction:Wc.vTa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromLeft"})),this.Dc.$("TransitionPushFromLeft",Object.assign(new rd,{rc:ResourceStrings.L_TransitionFromLeft,Vx:CommonUIStrings.l_TransitionPushFromLeftKeytip,uc:wd.Gc("TransitionPushRight"),tc:Object.assign(new jd,{TransitionType:Nb.push,Direction:Wc.zEa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromRight"})),this.Dc.$("TransitionPushFromRight",Object.assign(new rd,
{rc:ResourceStrings.L_TransitionFromRight,Vx:CommonUIStrings.l_TransitionPushFromRightKeytip,uc:wd.Gc("TransitionPushLeft"),tc:Object.assign(new jd,{TransitionType:Nb.push,Direction:Wc.S8,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromTop"})),this.Dc.$("TransitionPushFromTop",Object.assign(new rd,{rc:ResourceStrings.L_TransitionFromTop,Vx:CommonUIStrings.l_TransitionPushFromTopKeytip,uc:wd.Gc("TransitionPushDown"),tc:Object.assign(new jd,{TransitionType:Nb.push,
Direction:Wc.xxb,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush"})));Array.contains(Ga,"cut")||(this.Dc.$("TransitionCut",Object.assign(new rd,{rc:ResourceStrings.L_TransitionCut,uc:wd.Gc("TransitionCut"),tc:Object.assign(new jd,{TransitionType:Nb.cut,Direction:Wc.none,Duration:100,IsManualAdvance:!0}),parent:"TransitionCut",next:"TransitionCutNone"})),this.Dc.$("TransitionCutNone",Object.assign(new rd,{rc:ResourceStrings.L_TransitionNone,Vx:CommonUIStrings.l_TransitionCutNoneKeytip,uc:wd.Gc("TransitionCut"),
tc:Object.assign(new jd,{TransitionType:Nb.cut,Direction:Wc.none,Duration:100,IsManualAdvance:!0}),parent:"TransitionCut",next:"TransitionCutThroughBlack"})),this.Dc.$("TransitionCutThroughBlack",Object.assign(new rd,{rc:ResourceStrings.L_TransitionThroughBlack,Vx:CommonUIStrings.l_TransitionCutThroughBlackKeytip,uc:wd.Gc("TransitionCutThroughBlack"),tc:Object.assign(new jd,{TransitionType:Nb.cut,Direction:Wc.MFl,Duration:500,IsManualAdvance:!0}),parent:"TransitionCut"})));Array.contains(Ga,"wipe")||
(this.Dc.$("TransitionWipe",Object.assign(new rd,{rc:ResourceStrings.L_TransitionWipe,uc:wd.Gc("TransitionWipeLeft"),tc:Object.assign(new jd,{TransitionType:Nb.wipe,Direction:Wc.S8,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromRight"})),this.Dc.$("TransitionWipeFromRight",Object.assign(new rd,{rc:ResourceStrings.L_TransitionFromRight,Vx:CommonUIStrings.l_TransitionWipeFromRightKeytip,uc:wd.Gc("TransitionWipeLeft"),tc:Object.assign(new jd,{TransitionType:Nb.wipe,
Direction:Wc.S8,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTop"})),this.Dc.$("TransitionWipeFromTop",Object.assign(new rd,{rc:ResourceStrings.L_TransitionFromTop,Vx:CommonUIStrings.l_TransitionWipeFromTopKeytip,uc:wd.Gc("TransitionWipeDown"),tc:Object.assign(new jd,{TransitionType:Nb.wipe,Direction:Wc.xxb,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromLeft"})),this.Dc.$("TransitionWipeFromLeft",Object.assign(new rd,{rc:ResourceStrings.L_TransitionFromLeft,
Vx:CommonUIStrings.l_TransitionWipeFromLeftKeytip,uc:wd.Gc("TransitionWipeRight"),tc:Object.assign(new jd,{TransitionType:Nb.wipe,Direction:Wc.zEa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottom"})),this.Dc.$("TransitionWipeFromBottom",Object.assign(new rd,{rc:ResourceStrings.L_TransitionFromBottom,Vx:CommonUIStrings.l_TransitionWipeFromBottomKeytip,uc:wd.Gc("TransitionWipeUp"),tc:Object.assign(new jd,{TransitionType:Nb.wipe,Direction:Wc.vTa,Duration:1E3,IsManualAdvance:!0}),
parent:"TransitionWipe",next:"TransitionWipeFromTopRight"})),this.Dc.$("TransitionWipeFromTopRight",Object.assign(new rd,{rc:ResourceStrings.L_TransitionFromTopRight,Vx:CommonUIStrings.l_TransitionWipeFromTopRightKeytip,uc:wd.Gc("TransitionStripsLeftDown"),tc:Object.assign(new jd,{TransitionType:Nb.uzd,Direction:Wc.MTc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottomRight"})),this.Dc.$("TransitionWipeFromBottomRight",Object.assign(new rd,{rc:ResourceStrings.L_TransitionFromBottomRight,
Vx:CommonUIStrings.l_TransitionWipeFromBottomRightKeytip,uc:wd.Gc("TransitionStripsLeftUp"),tc:Object.assign(new jd,{TransitionType:Nb.uzd,Direction:Wc.JTc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTopLeft"})),this.Dc.$("TransitionWipeFromTopLeft",Object.assign(new rd,{rc:ResourceStrings.L_TransitionFromTopLeft,Vx:CommonUIStrings.l_TransitionWipeFromTopLeftKeytip,uc:wd.Gc("TransitionStripsRightDown"),tc:Object.assign(new jd,{TransitionType:Nb.uzd,Direction:Wc.LTc,
Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottomLeft"})),this.Dc.$("TransitionWipeFromBottomLeft",Object.assign(new rd,{rc:ResourceStrings.L_TransitionFromBottomLeft,Vx:CommonUIStrings.l_TransitionWipeFromBottomLeftKeytip,uc:wd.Gc("TransitionStripsRightUp"),tc:Object.assign(new jd,{TransitionType:Nb.uzd,Direction:Wc.ITc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe"})));this.GHa&&Rg.a("MorphTransitionActionAIEnabled")&&this.Dc.$("TransitionMorphActionAI",
Object.assign(new rd,{rc:ResourceStrings.L_TransitionMorph,uc:wd.Gc("TransitionByObject"),tc:Object.assign(new jd,{TransitionType:Nb.morph,Direction:Wc.UWd,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByObject"}));Array.contains(Ga,"morph")||(this.Dc.$("TransitionMorph",Object.assign(new rd,{rc:ResourceStrings.L_TransitionMorph,uc:wd.Gc("TransitionByObject"),tc:Object.assign(new jd,{TransitionType:Nb.morph,Direction:Wc.UWd,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",
next:"TransitionMorphByObject"})),this.Dc.$("TransitionMorphByObject",Object.assign(new rd,{rc:ResourceStrings.L_TransitionByObject,Vx:CommonUIStrings.l_TransitionMorphObjectsKeytip,uc:wd.Gc("TransitionByObject"),tc:Object.assign(new jd,{TransitionType:Nb.morph,Direction:Wc.UWd,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByWord"})),this.Dc.$("TransitionMorphByWord",Object.assign(new rd,{rc:ResourceStrings.L_TransitionByWord,Vx:CommonUIStrings.l_TransitionMorphWordsKeytip,
uc:wd.Gc("TransitionByWord"),tc:Object.assign(new jd,{TransitionType:Nb.morph,Direction:Wc.uti,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByChar"})),this.Dc.$("TransitionMorphByChar",Object.assign(new rd,{rc:ResourceStrings.L_TransitionByChar,Vx:CommonUIStrings.l_TransitionMorphCharactersKeytip,uc:wd.Gc("TransitionByChar"),tc:Object.assign(new jd,{TransitionType:Nb.morph,Direction:Wc.tti,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph"})));Array.contains(Ga,
"split")||(this.Dc.$("TransitionSplit",Object.assign(new rd,{rc:ResourceStrings.L_TransitionSplit,uc:wd.Gc("TransitionSplitOutVertical"),tc:Object.assign(new jd,{TransitionType:Nb.split,Direction:Wc.Udg,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitVerticalOut"})),this.Dc.$("TransitionSplitVerticalOut",Object.assign(new rd,{rc:ResourceStrings.L_TransitionVerticalOut,Vx:CommonUIStrings.l_TransitionSplitVerticalOutKeytip,uc:wd.Gc("TransitionSplitOutVertical"),tc:Object.assign(new jd,
{TransitionType:Nb.split,Direction:Wc.Udg,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitHorizontalIn"})),this.Dc.$("TransitionSplitHorizontalIn",Object.assign(new rd,{rc:ResourceStrings.L_TransitionHorizontalIn,Vx:CommonUIStrings.l_TransitionSplitHorizontalInKeytip,uc:wd.Gc("TransitionSplitInHorizontal"),tc:Object.assign(new jd,{TransitionType:Nb.split,Direction:Wc.dyj,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitHorizontalOut"})),
this.Dc.$("TransitionSplitHorizontalOut",Object.assign(new rd,{rc:ResourceStrings.L_TransitionHorizontalOut,Vx:CommonUIStrings.l_TransitionSplitHorizontalOutKeytip,uc:wd.Gc("TransitionSplitOutHorizontal"),tc:Object.assign(new jd,{TransitionType:Nb.split,Direction:Wc.eyj,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitVerticalIn"})),this.Dc.$("TransitionSplitVerticalIn",Object.assign(new rd,{rc:ResourceStrings.L_TransitionVerticalIn,Vx:CommonUIStrings.l_TransitionSplitVerticalInKeytip,
uc:wd.Gc("TransitionSplitInVertical"),tc:Object.assign(new jd,{TransitionType:Nb.split,Direction:Wc.oyj,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit"})));if(!Array.contains(Ga,"randombars")){this.Dc.$("TransitionRandomBars",Object.assign(new rd,{rc:ResourceStrings.L_TransitionRandomBars,uc:wd.Gc("TransitionRandomBarsVertical"),tc:Object.assign(new jd,{TransitionType:Nb.FTe,Direction:Wc.Mab,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionRandomBars",next:"TransitionRandomBarsVertical"}));
this.Dc.$("TransitionRandomBarsVertical",Object.assign(new rd,{rc:ResourceStrings.L_TransitionVertical,Vx:CommonUIStrings.l_TransitionRandomBarsVerticalKeytip,uc:wd.Gc("TransitionRandomBarsVertical"),tc:Object.assign(new jd,{TransitionType:Nb.FTe,Direction:Wc.Mab,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionRandomBars",next:"TransitionRandomBarsHorizontal"}));let Ka,qb;this.Dc.$("TransitionRandomBarsHorizontal",(qb=new rd,qb.rc=ResourceStrings.L_TransitionHorizontal,qb.Vx=CommonUIStrings.l_TransitionRandomBarsHorizontalKeytip,
qb.uc=wd.Gc("TransitionRandomBarsHorizontal"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.FTe,Ka.Direction=Wc.WXc,Ka.Duration=1E3,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionRandomBars",qb))}if(!Array.contains(Ga,"shape")){let Ka,qb;this.Dc.$("TransitionShape",(qb=new rd,qb.rc=ResourceStrings.L_TransitionShape,qb.uc=wd.Gc("TransitionShapeCircle"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.nzh,Ka.Direction=Wc.none,Ka.Duration=800,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionShape",qb.next="TransitionShapeCircle",
qb));let Qb,t;this.Dc.$("TransitionShapeCircle",(t=new rd,t.rc=ResourceStrings.L_TransitionCircle,t.Vx=CommonUIStrings.l_TransitionShapeCircleKeytip,t.uc=wd.Gc("TransitionShapeCircle"),t.tc=(Qb=new jd,Qb.TransitionType=Nb.nzh,Qb.Direction=Wc.none,Qb.Duration=800,Qb.IsManualAdvance=!0,Qb),t.parent="TransitionShape",t.next="TransitionShapeDiamond",t));let Y,pa;this.Dc.$("TransitionShapeDiamond",(pa=new rd,pa.rc=ResourceStrings.L_TransitionDiamond,pa.Vx=CommonUIStrings.l_TransitionShapeDiamondKeytip,
pa.uc=wd.Gc("TransitionShapeDiamond"),pa.tc=(Y=new jd,Y.TransitionType=Nb.zql,Y.Direction=Wc.none,Y.Duration=800,Y.IsManualAdvance=!0,Y),pa.parent="TransitionShape",pa.next="TransitionShapePlus",pa));let Ja,Ya;this.Dc.$("TransitionShapePlus",(Ya=new rd,Ya.rc=ResourceStrings.L_TransitionPlus,Ya.Vx=CommonUIStrings.l_TransitionShapePlusKeytip,Ya.uc=wd.Gc("TransitionShapePlus"),Ya.tc=(Ja=new jd,Ja.TransitionType=Nb.Eql,Ja.Direction=Wc.none,Ja.Duration=1E3,Ja.IsManualAdvance=!0,Ja),Ya.parent="TransitionShape",
Ya.next="TransitionShapeIn",Ya));let jb,Sb;this.Dc.$("TransitionShapeIn",(Sb=new rd,Sb.rc=ResourceStrings.L_TransitionIn,Sb.Vx=CommonUIStrings.l_TransitionShapeInKeytip,Sb.uc=wd.Gc("TransitionBoxIn"),Sb.tc=(jb=new jd,jb.TransitionType=Nb.qzh,jb.Direction=Wc.$8b,jb.Duration=1200,jb.IsManualAdvance=!0,jb),Sb.parent="TransitionShape",Sb.next="TransitionShapeOut",Sb));let kc,db;this.Dc.$("TransitionShapeOut",(db=new rd,db.rc=ResourceStrings.L_TransitionOut,db.Vx=CommonUIStrings.l_TransitionShapeOutKeytip,
db.uc=wd.Gc("TransitionBoxOut"),db.tc=(kc=new jd,kc.TransitionType=Nb.qzh,kc.Direction=Wc.Aee,kc.Duration=1200,kc.IsManualAdvance=!0,kc),db.parent="TransitionShape",db))}if(!Array.contains(Ga,"reveal")){let Ka,qb;this.Dc.$("TransitionReveal",(qb=new rd,qb.rc=ResourceStrings.L_TransitionReveal,qb.uc=wd.Gc("TransitionRevealSmoothlyFromRight"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.Krc,Ka.Direction=Wc.ZDh,Ka.Duration=3400,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionReveal",qb.next="TransitionRevealSmoothlyFromRight",
qb));let Qb,t;this.Dc.$("TransitionRevealSmoothlyFromRight",(t=new rd,t.rc=ResourceStrings.L_TransitionSmoothlyFromRight,t.uc=wd.Gc("TransitionRevealSmoothlyFromRight"),t.tc=(Qb=new jd,Qb.TransitionType=Nb.Krc,Qb.Direction=Wc.ZDh,Qb.Duration=3400,Qb.IsManualAdvance=!0,Qb),t.parent="TransitionReveal",t.next="TransitionRevealSmoothlyFromLeft",t));let Y,pa;this.Dc.$("TransitionRevealSmoothlyFromLeft",(pa=new rd,pa.rc=ResourceStrings.L_TransitionSmoothlyFromLeft,pa.uc=wd.Gc("TransitionRevealSmoothlyFromLeft"),
pa.tc=(Y=new jd,Y.TransitionType=Nb.Krc,Y.Direction=Wc.jzl,Y.Duration=3400,Y.IsManualAdvance=!0,Y),pa.parent="TransitionReveal",pa.next="TransitionRevealFromRight",pa));let Ja,Ya;this.Dc.$("TransitionRevealFromRight",(Ya=new rd,Ya.rc=ResourceStrings.L_TransitionThroughBlackFromRight,Ya.uc=wd.Gc("TransitionRevealFromRight"),Ya.tc=(Ja=new jd,Ja.TransitionType=Nb.Krc,Ja.Direction=Wc.OFl,Ja.Duration=3400,Ja.IsManualAdvance=!0,Ja),Ya.parent="TransitionReveal",Ya.next="TransitionRevealFromLeft",Ya));let jb,
Sb;this.Dc.$("TransitionRevealFromLeft",(Sb=new rd,Sb.rc=ResourceStrings.L_TransitionThroughBlackFromLeft,Sb.uc=wd.Gc("TransitionRevealFromLeft"),Sb.tc=(jb=new jd,jb.TransitionType=Nb.Krc,jb.Direction=Wc.NFl,jb.Duration=3400,jb.IsManualAdvance=!0,jb),Sb.parent="TransitionReveal",Sb))}if(!Array.contains(Ga,"cover")){let Ka,qb;this.Dc.$("TransitionCover",(qb=new rd,qb.rc=ResourceStrings.L_TransitionCover,qb.uc=wd.Gc("TransitionCoverLeft"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.qDa,Ka.Direction=Wc.S8,
Ka.Duration=1E3,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionCover",qb.next="TransitionCoverFromRight",qb));let Qb,t;this.Dc.$("TransitionCoverFromRight",(t=new rd,t.rc=ResourceStrings.L_TransitionFromRight,t.uc=wd.Gc("TransitionCoverLeft"),t.tc=(Qb=new jd,Qb.TransitionType=Nb.qDa,Qb.Direction=Wc.S8,Qb.Duration=1E3,Qb.IsManualAdvance=!0,Qb),t.parent="TransitionCover",t.next="TransitionCoverFromTop",t));let Y,pa;this.Dc.$("TransitionCoverFromTop",(pa=new rd,pa.rc=ResourceStrings.L_TransitionFromTop,
pa.uc=wd.Gc("TransitionCoverDown"),pa.tc=(Y=new jd,Y.TransitionType=Nb.qDa,Y.Direction=Wc.xxb,Y.Duration=1E3,Y.IsManualAdvance=!0,Y),pa.parent="TransitionCover",pa.next="TransitionCoverFromLeft",pa));let Ja,Ya;this.Dc.$("TransitionCoverFromLeft",(Ya=new rd,Ya.rc=ResourceStrings.L_TransitionFromLeft,Ya.uc=wd.Gc("TransitionCoverRight"),Ya.tc=(Ja=new jd,Ja.TransitionType=Nb.qDa,Ja.Direction=Wc.zEa,Ja.Duration=1E3,Ja.IsManualAdvance=!0,Ja),Ya.parent="TransitionCover",Ya.next="TransitionCoverFromBottom",
Ya));let jb,Sb;this.Dc.$("TransitionCoverFromBottom",(Sb=new rd,Sb.rc=ResourceStrings.L_TransitionFromBottom,Sb.uc=wd.Gc("TransitionCoverUp"),Sb.tc=(jb=new jd,jb.TransitionType=Nb.qDa,jb.Direction=Wc.vTa,jb.Duration=1E3,jb.IsManualAdvance=!0,jb),Sb.parent="TransitionCover",Sb.next="TransitionCoverFromTopRight",Sb));let kc,db;this.Dc.$("TransitionCoverFromTopRight",(db=new rd,db.rc=ResourceStrings.L_TransitionFromTopRight,db.uc=wd.Gc("TransitionCoverLeftDown"),db.tc=(kc=new jd,kc.TransitionType=Nb.qDa,
kc.Direction=Wc.MTc,kc.Duration=1E3,kc.IsManualAdvance=!0,kc),db.parent="TransitionCover",db.next="TransitionCoverFromBottomRight",db));let Kb,lc;this.Dc.$("TransitionCoverFromBottomRight",(lc=new rd,lc.rc=ResourceStrings.L_TransitionFromBottomRight,lc.uc=wd.Gc("TransitionCoverLeftUp"),lc.tc=(Kb=new jd,Kb.TransitionType=Nb.qDa,Kb.Direction=Wc.JTc,Kb.Duration=1E3,Kb.IsManualAdvance=!0,Kb),lc.parent="TransitionCover",lc.next="TransitionCoverFromTopLeft",lc));let Jc,Vc;this.Dc.$("TransitionCoverFromTopLeft",
(Vc=new rd,Vc.rc=ResourceStrings.L_TransitionFromTopLeft,Vc.uc=wd.Gc("TransitionCoverRightDown"),Vc.tc=(Jc=new jd,Jc.TransitionType=Nb.qDa,Jc.Direction=Wc.LTc,Jc.Duration=1E3,Jc.IsManualAdvance=!0,Jc),Vc.parent="TransitionCover",Vc.next="TransitionCoverFromBottomLeft",Vc));let vd,me;this.Dc.$("TransitionCoverFromBottomLeft",(me=new rd,me.rc=ResourceStrings.L_TransitionFromBottomLeft,me.uc=wd.Gc("TransitionCoverRightUp"),me.tc=(vd=new jd,vd.TransitionType=Nb.qDa,vd.Direction=Wc.ITc,vd.Duration=1E3,
vd.IsManualAdvance=!0,vd),me.parent="TransitionCover",me))}if(!Array.contains(Ga,"uncover")){let Ka,qb;this.Dc.$("TransitionUncover",(qb=new rd,qb.rc=ResourceStrings.L_TransitionUncover,qb.uc=wd.Gc("TransitionUncoverLeft"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.$Ma,Ka.Direction=Wc.S8,Ka.Duration=750,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionUncover",qb.next="TransitionUncoverFromRight",qb));let Qb,t;this.Dc.$("TransitionUncoverFromRight",(t=new rd,t.rc=ResourceStrings.L_TransitionFromRight,t.uc=
wd.Gc("TransitionUncoverLeft"),t.tc=(Qb=new jd,Qb.TransitionType=Nb.$Ma,Qb.Direction=Wc.S8,Qb.Duration=750,Qb.IsManualAdvance=!0,Qb),t.parent="TransitionUncover",t.next="TransitionUncoverFromTop",t));let Y,pa;this.Dc.$("TransitionUncoverFromTop",(pa=new rd,pa.rc=ResourceStrings.L_TransitionFromTop,pa.uc=wd.Gc("TransitionUncoverDown"),pa.tc=(Y=new jd,Y.TransitionType=Nb.$Ma,Y.Direction=Wc.xxb,Y.Duration=750,Y.IsManualAdvance=!0,Y),pa.parent="TransitionUncover",pa.next="TransitionUncoverFromLeft",pa));
let Ja,Ya;this.Dc.$("TransitionUncoverFromLeft",(Ya=new rd,Ya.rc=ResourceStrings.L_TransitionFromLeft,Ya.uc=wd.Gc("TransitionUncoverRight"),Ya.tc=(Ja=new jd,Ja.TransitionType=Nb.$Ma,Ja.Direction=Wc.zEa,Ja.Duration=750,Ja.IsManualAdvance=!0,Ja),Ya.parent="TransitionUncover",Ya.next="TransitionUncoverFromBottom",Ya));let jb,Sb;this.Dc.$("TransitionUncoverFromBottom",(Sb=new rd,Sb.rc=ResourceStrings.L_TransitionFromBottom,Sb.uc=wd.Gc("TransitionUncoverUp"),Sb.tc=(jb=new jd,jb.TransitionType=Nb.$Ma,jb.Direction=
Wc.vTa,jb.Duration=750,jb.IsManualAdvance=!0,jb),Sb.parent="TransitionUncover",Sb.next="TransitionUncoverFromTopRight",Sb));this.Dc.$("TransitionUncoverFromTopRight",Object.assign(new rd,{rc:ResourceStrings.L_TransitionFromTopRight,uc:wd.Gc("TransitionUncoverLeftDown"),tc:Object.assign(new jd,{TransitionType:Nb.$Ma,Direction:Wc.MTc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",next:"TransitionUncoverFromBottomRight"}));this.Dc.$("TransitionUncoverFromBottomRight",Object.assign(new rd,
{rc:ResourceStrings.L_TransitionFromBottomRight,uc:wd.Gc("TransitionUncoverLeftUp"),tc:Object.assign(new jd,{TransitionType:Nb.$Ma,Direction:Wc.JTc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",next:"TransitionUncoverFromTopLeft"}));this.Dc.$("TransitionUncoverFromTopLeft",Object.assign(new rd,{rc:ResourceStrings.L_TransitionFromTopLeft,uc:wd.Gc("TransitionUncoverRightDown"),tc:Object.assign(new jd,{TransitionType:Nb.$Ma,Direction:Wc.LTc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",
next:"TransitionUncoverFromBottomLeft"}));this.Dc.$("TransitionUncoverFromBottomLeft",Object.assign(new rd,{rc:ResourceStrings.L_TransitionFromBottomLeft,uc:wd.Gc("TransitionUncoverRightUp"),tc:Object.assign(new jd,{TransitionType:Nb.$Ma,Direction:Wc.ITc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover"}))}if(!Array.contains(Ga,"menusectionexciting")){if(!Array.contains(Ga,"fallover")){this.Dc.$("TransitionFallOver",Object.assign(new rd,{rc:ResourceStrings.L_TransitionFallOver,uc:wd.Gc("TransitionFallOverLeft"),
tc:Object.assign(new jd,{TransitionType:Nb.M6d,Direction:Wc.none,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionFallOver",next:"TransitionFallOverLeft"}));let Ka,qb;this.Dc.$("TransitionFallOverLeft",(qb=new rd,qb.rc=ResourceStrings.L_TransitionGoLeft,qb.uc=wd.Gc("TransitionFallOverLeft"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.M6d,Ka.Direction=Wc.none,Ka.Duration=2E3,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionFallOver",qb.next="TransitionFallOverRight",qb));let Qb,t;this.Dc.$("TransitionFallOverRight",
(t=new rd,t.rc=ResourceStrings.L_TransitionGoRight,t.uc=wd.Gc("TransitionFallOverRight"),t.tc=(Qb=new jd,Qb.TransitionType=Nb.M6d,Qb.Direction=Wc.uVa,Qb.Duration=2E3,Qb.IsManualAdvance=!0,Qb),t.parent="TransitionFallOver",t))}if(!Array.contains(Ga,"drape")){let Ka,qb;this.Dc.$("TransitionDrape",(qb=new rd,qb.rc=ResourceStrings.L_TransitionDrape,qb.uc=wd.Gc("TransitionDrapeLeft"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.u4d,Ka.Direction=Wc.none,Ka.Duration=2E3,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionDrape",
qb.next="TransitionDrapeLeft",qb));let Qb,t;this.Dc.$("TransitionDrapeLeft",(t=new rd,t.rc=ResourceStrings.L_TransitionGoLeft,t.uc=wd.Gc("TransitionDrapeLeft"),t.tc=(Qb=new jd,Qb.TransitionType=Nb.u4d,Qb.Direction=Wc.none,Qb.Duration=2E3,Qb.IsManualAdvance=!0,Qb),t.parent="TransitionDrape",t.next="TransitionDrapeRight",t));let Y,pa;this.Dc.$("TransitionDrapeRight",(pa=new rd,pa.rc=ResourceStrings.L_TransitionGoRight,pa.uc=wd.Gc("TransitionDrapeRight"),pa.tc=(Y=new jd,Y.TransitionType=Nb.u4d,Y.Direction=
Wc.uVa,Y.Duration=2E3,Y.IsManualAdvance=!0,Y),pa.parent="TransitionDrape",pa))}if(!Array.contains(Ga,"curtains")){let Ka,qb;this.Dc.$("TransitionCurtains",(qb=new rd,qb.rc=ResourceStrings.L_TransitionCurtains,qb.uc=wd.Gc("TransitionCurtains"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.IQi,Ka.Direction=Wc.none,Ka.Duration=6E3,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionCurtains",qb))}if(!Array.contains(Ga,"wind")){let Ka,qb;this.Dc.$("TransitionWind",(qb=new rd,qb.rc=ResourceStrings.L_TransitionWind,
qb.uc=wd.Gc("TransitionWindRight"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.N$e,Ka.Direction=Wc.none,Ka.Duration=2E3,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionWind",qb.next="TransitionWindRight",qb));let Qb,t;this.Dc.$("TransitionWindRight",(t=new rd,t.rc=ResourceStrings.L_TransitionGoRight,t.uc=wd.Gc("TransitionWindRight"),t.tc=(Qb=new jd,Qb.TransitionType=Nb.N$e,Qb.Direction=Wc.none,Qb.Duration=2E3,Qb.IsManualAdvance=!0,Qb),t.parent="TransitionWind",t.next="TransitionWindLeft",t));let Y,pa;this.Dc.$("TransitionWindLeft",
(pa=new rd,pa.rc=ResourceStrings.L_TransitionGoLeft,pa.uc=wd.Gc("TransitionWindLeft"),pa.tc=(Y=new jd,Y.TransitionType=Nb.N$e,Y.Direction=Wc.uVa,Y.Duration=2E3,Y.IsManualAdvance=!0,Y),pa.parent="TransitionWind",pa))}if(!Array.contains(Ga,"prestige")){let Ka,qb;this.Dc.$("TransitionPrestige",(qb=new rd,qb.rc=ResourceStrings.L_TransitionPrestige,qb.uc=wd.Gc("TransitionPrestige"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.cTk,Ka.Direction=Wc.none,Ka.Duration=2E3,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionPrestige",
qb))}if(!Array.contains(Ga,"fracture")){let Ka,qb;this.Dc.$("TransitionFracture",(qb=new rd,qb.rc=ResourceStrings.L_TransitionFracture,qb.uc=wd.Gc("TransitionFracture"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.b8i,Ka.Direction=Wc.none,Ka.Duration=2E3,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionFracture",qb))}if(!Array.contains(Ga,"crush")){let Ka,qb;this.Dc.$("TransitionCrush",(qb=new rd,qb.rc=ResourceStrings.L_TransitionCrush,qb.uc=wd.Gc("TransitionCrush"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.YPi,
Ka.Direction=Wc.none,Ka.Duration=2E3,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionCrush",qb))}if(!Array.contains(Ga,"peeloff")){let Ka,qb;this.Dc.$("TransitionPeelOff",(qb=new rd,qb.rc=ResourceStrings.L_TransitionPeelOff,qb.uc=wd.Gc("TransitionPeelOffLeft"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.zOe,Ka.Direction=Wc.none,Ka.Duration=1250,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionPeelOff",qb.next="TransitionPeelOffLeft",qb));let Qb,t;this.Dc.$("TransitionPeelOffLeft",(t=new rd,t.rc=ResourceStrings.L_TransitionGoLeft,
t.uc=wd.Gc("TransitionPeelOffLeft"),t.tc=(Qb=new jd,Qb.TransitionType=Nb.zOe,Qb.Direction=Wc.none,Qb.Duration=1250,Qb.IsManualAdvance=!0,Qb),t.parent="TransitionPeelOff",t.next="TransitionPeelOffRight",t));let Y,pa;this.Dc.$("TransitionPeelOffRight",(pa=new rd,pa.rc=ResourceStrings.L_TransitionGoRight,pa.uc=wd.Gc("TransitionPeelOffRight"),pa.tc=(Y=new jd,Y.TransitionType=Nb.zOe,Y.Direction=Wc.uVa,Y.Duration=1250,Y.IsManualAdvance=!0,Y),pa.parent="TransitionPeelOff",pa))}if(!Array.contains(Ga,"pagecurl")){let Ka,
qb;this.Dc.$("TransitionPageCurl",(qb=new rd,qb.rc=ResourceStrings.L_TransitionPageCurl,qb.uc=wd.Gc("TransitionTwoPageCurlFromRight"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.UNe,Ka.Direction=Wc.none,Ka.Duration=1250,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionPageCurl",qb.next="TransitionPageCurlDoubleLeft",qb));let Qb,t;this.Dc.$("TransitionPageCurlDoubleLeft",(t=new rd,t.rc=ResourceStrings.L_TransitionEffectOptionDoubleLeft,t.uc=wd.Gc("TransitionTwoPageCurlFromRight"),t.tc=(Qb=new jd,Qb.TransitionType=
Nb.UNe,Qb.Direction=Wc.none,Qb.Duration=1250,Qb.IsManualAdvance=!0,Qb),t.parent="TransitionPageCurl",t.next="TransitionPageCurlDoubleRight",t));let Y,pa;this.Dc.$("TransitionPageCurlDoubleRight",(pa=new rd,pa.rc=ResourceStrings.L_TransitionEffectOptionDoubleRight,pa.uc=wd.Gc("TransitionTwoPageCurlFromLeft"),pa.tc=(Y=new jd,Y.TransitionType=Nb.UNe,Y.Direction=Wc.uVa,Y.Duration=1250,Y.IsManualAdvance=!0,Y),pa.parent="TransitionPageCurl",pa.next="TransitionPageCurlSingleLeft",pa));let Ja,Ya;this.Dc.$("TransitionPageCurlSingleLeft",
(Ya=new rd,Ya.rc=ResourceStrings.L_TransitionEffectOptionSingleLeft,Ya.uc=wd.Gc("TransitionPageCurlFromRight"),Ya.tc=(Ja=new jd,Ja.TransitionType=Nb.zdh,Ja.Direction=Wc.none,Ja.Duration=1250,Ja.IsManualAdvance=!0,Ja),Ya.parent="TransitionPageCurl",Ya.next="TransitionPageCurlSingleRight",Ya));let jb,Sb;this.Dc.$("TransitionPageCurlSingleRight",(Sb=new rd,Sb.rc=ResourceStrings.L_TransitionEffectOptionSingleRight,Sb.uc=wd.Gc("TransitionPageCurlFromLeft"),Sb.tc=(jb=new jd,jb.TransitionType=Nb.zdh,jb.Direction=
Wc.uVa,jb.Duration=1250,jb.IsManualAdvance=!0,jb),Sb.parent="TransitionPageCurl",Sb))}if(!Array.contains(Ga,"airplane")){let Ka,qb;this.Dc.$("TransitionAirplane",(qb=new rd,qb.rc=ResourceStrings.L_TransitionAirplane,qb.uc=wd.Gc("TransitionAirplaneRight"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.XTd,Ka.Direction=Wc.none,Ka.Duration=1250,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionAirplane",qb.next="TransitionAirplaneRight",qb));let Qb,t;this.Dc.$("TransitionAirplaneRight",(t=new rd,t.rc=ResourceStrings.L_TransitionGoRight,
t.uc=wd.Gc("TransitionAirplaneRight"),t.tc=(Qb=new jd,Qb.TransitionType=Nb.XTd,Qb.Direction=Wc.none,Qb.Duration=1250,Qb.IsManualAdvance=!0,Qb),t.parent="TransitionAirplane",t.next="TransitionAirplaneLeft",t));let Y,pa;this.Dc.$("TransitionAirplaneLeft",(pa=new rd,pa.rc=ResourceStrings.L_TransitionGoLeft,pa.uc=wd.Gc("TransitionAirplaneLeft"),pa.tc=(Y=new jd,Y.TransitionType=Nb.XTd,Y.Direction=Wc.uVa,Y.Duration=1250,Y.IsManualAdvance=!0,Y),pa.parent="TransitionAirplane",pa))}if(!Array.contains(Ga,"origami")){let Ka,
qb;this.Dc.$("TransitionOrigami",(qb=new rd,qb.rc=ResourceStrings.L_TransitionOrigami,qb.uc=wd.Gc("TransitionOrigamiRight"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.INe,Ka.Direction=Wc.none,Ka.Duration=3250,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionOrigami",qb.next="TransitionOrigamiRight",qb));let Qb,t;this.Dc.$("TransitionOrigamiRight",(t=new rd,t.rc=ResourceStrings.L_TransitionGoRight,t.uc=wd.Gc("TransitionOrigamiRight"),t.tc=(Qb=new jd,Qb.TransitionType=Nb.INe,Qb.Direction=Wc.none,Qb.Duration=
3250,Qb.IsManualAdvance=!0,Qb),t.parent="TransitionOrigami",t.next="TransitionOrigamiLeft",t));let Y,pa;this.Dc.$("TransitionOrigamiLeft",(pa=new rd,pa.rc=ResourceStrings.L_TransitionGoLeft,pa.uc=wd.Gc("TransitionOrigamiLeft"),pa.tc=(Y=new jd,Y.TransitionType=Nb.INe,Y.Direction=Wc.uVa,Y.Duration=3250,Y.IsManualAdvance=!0,Y),pa.parent="TransitionOrigami",pa))}Array.contains(Ga,"dissolve")||this.Dc.$("TransitionDissolve",Object.assign(new rd,{rc:ResourceStrings.L_TransitionDissolve,uc:wd.Gc("TransitionDissolve"),
tc:Object.assign(new jd,{TransitionType:Nb.dissolve,Direction:Wc.none,Duration:1200,IsManualAdvance:!0}),parent:"TransitionDissolve"}));Array.contains(Ga,"checker")||(this.Dc.$("TransitionChecker",Object.assign(new rd,{rc:ResourceStrings.L_TransitionChecker,uc:wd.Gc("TransitionCheckerboardAcross"),tc:Object.assign(new jd,{TransitionType:Nb.JYd,Direction:Wc.none,Duration:2500,IsManualAdvance:!0}),parent:"TransitionChecker",next:"TransitionCheckerFromLeft"})),this.Dc.$("TransitionCheckerFromLeft",Object.assign(new rd,
{rc:ResourceStrings.L_TransitionFromLeft,uc:wd.Gc("TransitionCheckerboardAcross"),tc:Object.assign(new jd,{TransitionType:Nb.JYd,Direction:Wc.none,Duration:2500,IsManualAdvance:!0}),parent:"TransitionChecker",next:"TransitionCheckerFromTop"})),this.Dc.$("TransitionCheckerFromTop",Object.assign(new rd,{rc:ResourceStrings.L_TransitionFromTop,uc:wd.Gc("TransitionCheckerboardDown"),tc:Object.assign(new jd,{TransitionType:Nb.JYd,Direction:Wc.cyj,Duration:2500,IsManualAdvance:!0}),parent:"TransitionChecker"})));
if(!Array.contains(Ga,"blinds")){this.Dc.$("TransitionBlinds",Object.assign(new rd,{rc:ResourceStrings.L_TransitionBlinds,uc:wd.Gc("TransitionBlindsVertical"),tc:Object.assign(new jd,{TransitionType:Nb.blinds,Direction:Wc.zEf,Duration:1600,IsManualAdvance:!0}),parent:"TransitionBlinds",next:"TransitionBlindsVertical"}));let Ka,qb;this.Dc.$("TransitionBlindsVertical",(qb=new rd,qb.rc=ResourceStrings.L_TransitionVertical,qb.uc=wd.Gc("TransitionBlindsVertical"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.blinds,
Ka.Direction=Wc.zEf,Ka.Duration=1600,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionBlinds",qb.next="TransitionBlindsHorizontal",qb));let Qb,t;this.Dc.$("TransitionBlindsHorizontal",(t=new rd,t.rc=ResourceStrings.L_TransitionHorizontal,t.uc=wd.Gc("TransitionBlindsHorizontal"),t.tc=(Qb=new jd,Qb.TransitionType=Nb.blinds,Qb.Direction=Wc.Ppi,Qb.Duration=1600,Qb.IsManualAdvance=!0,Qb),t.parent="TransitionBlinds",t))}if(!Array.contains(Ga,"wheel")){let Ka,qb;this.Dc.$("TransitionWheel",(qb=new rd,qb.rc=
ResourceStrings.L_TransitionWheel,qb.uc=wd.Gc("TransitionWheelClockwise1"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.wheel,Ka.Direction=Wc.wheel,Ka.Duration=1E3,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionWheel",qb.next="TransitionWheelClockwise",qb));let Qb,t;this.Dc.$("TransitionWheelClockwise",(t=new rd,t.rc=ResourceStrings.l_TransitionWheelClockWise,t.uc=wd.Gc("TransitionWheelClockwise1"),t.tc=(Qb=new jd,Qb.TransitionType=Nb.wheel,Qb.Direction=Wc.wheel,Qb.Duration=1E3,Qb.IsManualAdvance=!0,Qb),
t.parent="TransitionWheel",t.next="TransitionWheelCounterclockwise",t));let Y,pa;this.Dc.$("TransitionWheelCounterclockwise",(pa=new rd,pa.rc=ResourceStrings.l_TransitionWheelCounterClockWise,pa.uc=wd.Gc("TransitionWheelCounterclockwise1"),pa.tc=(Y=new jd,Y.TransitionType=Nb.CUl,Y.Direction=Wc.wheel,Y.Duration=1E3,Y.IsManualAdvance=!0,Y),pa.parent="TransitionWheel",pa.next="TransitionWheelWedge",pa));let Ja,Ya;this.Dc.$("TransitionWheelWedge",(Ya=new rd,Ya.rc=ResourceStrings.l_TransitionWheelWedge,
Ya.uc=wd.Gc("TransitionWedge"),Ya.tc=(Ja=new jd,Ja.TransitionType=Nb.wedge,Ja.Direction=Wc.none,Ja.Duration=1E3,Ja.IsManualAdvance=!0,Ja),Ya.parent="TransitionWheel",Ya))}if(!Array.contains(Ga,"ripple")){let Ka,qb;this.Dc.$("TransitionRipple",(qb=new rd,qb.rc=ResourceStrings.L_TransitionRipple,qb.uc=wd.Gc("TransitionRipple"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.FMb,Ka.Direction=Wc.psh,Ka.Duration=1400,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionRipple",qb.next="TransitionRippleCenter",qb));let Qb,
t;this.Dc.$("TransitionRippleCenter",(t=new rd,t.rc=ResourceStrings.L_EffectOptionsDirectionCenter,t.uc=wd.Gc("TransitionRipple"),t.tc=(Qb=new jd,Qb.TransitionType=Nb.FMb,Qb.Direction=Wc.psh,Qb.Duration=1400,Qb.IsManualAdvance=!0,Qb),t.parent="TransitionRipple",t.next="TransitionRippleBottomLeft",t));let Y,pa;this.Dc.$("TransitionRippleBottomLeft",(pa=new rd,pa.rc=ResourceStrings.L_TransitionFromBottomLeft,pa.uc=wd.Gc("TransitionRippleBottomLeft"),pa.tc=(Y=new jd,Y.TransitionType=Nb.FMb,Y.Direction=
Wc.ITc,Y.Duration=1500,Y.IsManualAdvance=!0,Y),pa.parent="TransitionRipple",pa.next="TransitionRippleBottomRight",pa));let Ja,Ya;this.Dc.$("TransitionRippleBottomRight",(Ya=new rd,Ya.rc=ResourceStrings.L_TransitionFromBottomRight,Ya.uc=wd.Gc("TransitionRippleBottomRight"),Ya.tc=(Ja=new jd,Ja.TransitionType=Nb.FMb,Ja.Direction=Wc.JTc,Ja.Duration=1500,Ja.IsManualAdvance=!0,Ja),Ya.parent="TransitionRipple",Ya.next="TransitionRippleTopRight",Ya));let jb,Sb;this.Dc.$("TransitionRippleTopRight",(Sb=new rd,
Sb.rc=ResourceStrings.L_TransitionFromTopRight,Sb.uc=wd.Gc("TransitionRippleTopRight"),Sb.tc=(jb=new jd,jb.TransitionType=Nb.FMb,jb.Direction=Wc.MTc,jb.Duration=1500,jb.IsManualAdvance=!0,jb),Sb.parent="TransitionRipple",Sb.next="TransitionRippleTopLeft",Sb));let kc,db;this.Dc.$("TransitionRippleTopLeft",(db=new rd,db.rc=ResourceStrings.L_TransitionFromTopLeft,db.uc=wd.Gc("TransitionRippleTopLeft"),db.tc=(kc=new jd,kc.TransitionType=Nb.FMb,kc.Direction=Wc.LTc,kc.Duration=1500,kc.IsManualAdvance=!0,
kc),db.parent="TransitionRipple",db))}if(!Array.contains(Ga,"glitter")){let Ka,qb;this.Dc.$("TransitionGlitter",(qb=new rd,qb.rc=ResourceStrings.L_TransitionGlitter,qb.uc=wd.Gc("TransitionGlitterHexagonLeft"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.nFa,Ka.Direction=Wc.C2f,Ka.Duration=3900,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionGlitter",qb.next="TransitionGlitterHexagonLeft",qb));let Qb,t;this.Dc.$("TransitionGlitterHexagonLeft",(t=new rd,t.rc=ResourceStrings.L_TransitionHexagonsFromLeft,t.uc=
wd.Gc("TransitionGlitterHexagonLeft"),t.tc=(Qb=new jd,Qb.TransitionType=Nb.nFa,Qb.Direction=Wc.C2f,Qb.Duration=3900,Qb.IsManualAdvance=!0,Qb),t.parent="TransitionGlitter",t.next="TransitionGlitterHexagonTop",t));let Y,pa;this.Dc.$("TransitionGlitterHexagonTop",(pa=new rd,pa.rc=ResourceStrings.L_TransitionHexagonsFromTop,pa.uc=wd.Gc("TransitionGlitterHexagonTop"),pa.tc=(Y=new jd,Y.TransitionType=Nb.nFa,Y.Direction=Wc.O8i,Y.Duration=3900,Y.IsManualAdvance=!0,Y),pa.parent="TransitionGlitter",pa.next=
"TransitionGlitterHexagonRight",pa));let Ja,Ya;this.Dc.$("TransitionGlitterHexagonRight",(Ya=new rd,Ya.rc=ResourceStrings.L_TransitionHexagonsFromRight,Ya.uc=wd.Gc("TransitionGlitterHexagonRight"),Ya.tc=(Ja=new jd,Ja.TransitionType=Nb.nFa,Ja.Direction=Wc.I8i,Ja.Duration=3900,Ja.IsManualAdvance=!0,Ja),Ya.parent="TransitionGlitter",Ya.next="TransitionGlitterHexagonBottom",Ya));let jb,Sb;this.Dc.$("TransitionGlitterHexagonBottom",(Sb=new rd,Sb.rc=ResourceStrings.L_TransitionHexagonsFromBottom,Sb.uc=
wd.Gc("TransitionGlitterHexagonBottom"),Sb.tc=(jb=new jd,jb.TransitionType=Nb.nFa,jb.Direction=Wc.v8i,jb.Duration=3900,jb.IsManualAdvance=!0,jb),Sb.parent="TransitionGlitter",Sb.next="TransitionGlitterDiamondLeft",Sb));let kc,db;this.Dc.$("TransitionGlitterDiamondLeft",(db=new rd,db.rc=ResourceStrings.L_TransitionDiamondsFromLeft,db.uc=wd.Gc("TransitionGlitterDiamondLeft"),db.tc=(kc=new jd,kc.TransitionType=Nb.nFa,kc.Direction=Wc.D8i,kc.Duration=3900,kc.IsManualAdvance=!0,kc),db.parent="TransitionGlitter",
db.next="TransitionGlitterDiamondTop",db));let Kb,lc;this.Dc.$("TransitionGlitterDiamondTop",(lc=new rd,lc.rc=ResourceStrings.L_TransitionDiamondsFromTop,lc.uc=wd.Gc("TransitionGlitterDiamondTop"),lc.tc=(Kb=new jd,Kb.TransitionType=Nb.nFa,Kb.Direction=Wc.N8i,Kb.Duration=3900,Kb.IsManualAdvance=!0,Kb),lc.parent="TransitionGlitter",lc.next="TransitionGlitterDiamondRight",lc));let Jc,Vc;this.Dc.$("TransitionGlitterDiamondRight",(Vc=new rd,Vc.rc=ResourceStrings.L_TransitionDiamondsFromRight,Vc.uc=wd.Gc("TransitionGlitterDiamondRight"),
Vc.tc=(Jc=new jd,Jc.TransitionType=Nb.nFa,Jc.Direction=Wc.H8i,Jc.Duration=3900,Jc.IsManualAdvance=!0,Jc),Vc.parent="TransitionGlitter",Vc.next="TransitionGlitterDiamondBottom",Vc));let vd,me;this.Dc.$("TransitionGlitterDiamondBottom",(me=new rd,me.rc=ResourceStrings.L_TransitionDiamondsFromBottom,me.uc=wd.Gc("TransitionGlitterDiamondBottom"),me.tc=(vd=new jd,vd.TransitionType=Nb.nFa,vd.Direction=Wc.u8i,vd.Duration=3900,vd.IsManualAdvance=!0,vd),me.parent="TransitionGlitter",me))}if(!Array.contains(Ga,
"vortex")){let Ka,qb;this.Dc.$("TransitionVortex",(qb=new rd,qb.rc=ResourceStrings.L_TransitionVortex,qb.uc=wd.Gc("TransitionVortexFromLeft"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.Cxc,Ka.Direction=Wc.zEa,Ka.Duration=4E3,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionVortex",qb.next="TransitionVortexFromLeft",qb));let Qb,t;this.Dc.$("TransitionVortexFromLeft",(t=new rd,t.rc=ResourceStrings.L_TransitionFromLeft,t.uc=wd.Gc("TransitionVortexFromLeft"),t.tc=(Qb=new jd,Qb.TransitionType=Nb.Cxc,Qb.Direction=
Wc.zEa,Qb.Duration=4E3,Qb.IsManualAdvance=!0,Qb),t.parent="TransitionVortex",t.next="TransitionVortexFromTop",t));let Y,pa;this.Dc.$("TransitionVortexFromTop",(pa=new rd,pa.rc=ResourceStrings.L_TransitionFromTop,pa.uc=wd.Gc("TransitionVortexFromTop"),pa.tc=(Y=new jd,Y.TransitionType=Nb.Cxc,Y.Direction=Wc.xxb,Y.Duration=4E3,Y.IsManualAdvance=!0,Y),pa.parent="TransitionVortex",pa.next="TransitionVortexFromRight",pa));let Ja,Ya;this.Dc.$("TransitionVortexFromRight",(Ya=new rd,Ya.rc=ResourceStrings.L_TransitionFromRight,
Ya.uc=wd.Gc("TransitionVortexFromRight"),Ya.tc=(Ja=new jd,Ja.TransitionType=Nb.Cxc,Ja.Direction=Wc.S8,Ja.Duration=4E3,Ja.IsManualAdvance=!0,Ja),Ya.parent="TransitionVortex",Ya.next="TransitionVortexFromBottom",Ya));let jb,Sb;this.Dc.$("TransitionVortexFromBottom",(Sb=new rd,Sb.rc=ResourceStrings.L_TransitionFromBottom,Sb.uc=wd.Gc("TransitionVortexFromBottom"),Sb.tc=(jb=new jd,jb.TransitionType=Nb.Cxc,jb.Direction=Wc.vTa,jb.Duration=4E3,jb.IsManualAdvance=!0,jb),Sb.parent="TransitionVortex",Sb))}Array.contains(Ga,
"switch")||(this.Dc.$("TransitionSwitch",Object.assign(new rd,{rc:ResourceStrings.L_TransitionSwitch,uc:wd.Gc("TransitionSwitchRight"),tc:Object.assign(new jd,{TransitionType:Nb.N4e,Direction:Wc.XXc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch",next:"TransitionSwitchRight"})),this.Dc.$("TransitionSwitchRight",Object.assign(new rd,{rc:ResourceStrings.L_TransitionGoRight,uc:wd.Gc("TransitionSwitchRight"),tc:Object.assign(new jd,{TransitionType:Nb.N4e,Direction:Wc.XXc,Duration:1250,IsManualAdvance:!0}),
parent:"TransitionSwitch",next:"TransitionSwitchLeft"})),this.Dc.$("TransitionSwitchLeft",Object.assign(new rd,{rc:ResourceStrings.L_TransitionGoLeft,uc:wd.Gc("TransitionSwitchLeft"),tc:Object.assign(new jd,{TransitionType:Nb.N4e,Direction:Wc.none,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch"})));if(!Array.contains(Ga,"flip")){this.Dc.$("TransitionFlip",Object.assign(new rd,{rc:ResourceStrings.L_TransitionFlip,uc:wd.Gc("TransitionFlipRight"),tc:Object.assign(new jd,{TransitionType:Nb.flip,
Direction:Wc.XXc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionFlip",next:"TransitionFlipRight"}));this.Dc.$("TransitionFlipRight",Object.assign(new rd,{rc:ResourceStrings.L_TransitionGoRight,uc:wd.Gc("TransitionFlipRight"),tc:Object.assign(new jd,{TransitionType:Nb.flip,Direction:Wc.XXc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionFlip",next:"TransitionFlipLeft"}));let Ka,qb;this.Dc.$("TransitionFlipLeft",(qb=new rd,qb.rc=ResourceStrings.L_TransitionGoLeft,qb.uc=wd.Gc("TransitionFlipLeft"),
qb.tc=(Ka=new jd,Ka.TransitionType=Nb.flip,Ka.Direction=Wc.none,Ka.Duration=1250,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionFlip",qb))}if(!Array.contains(Ga,"galleryicon")){let Ka,qb;this.Dc.$("TransitionGalleryIcon",(qb=new rd,qb.rc=ResourceStrings.L_TransitionGallery,qb.uc=wd.Gc("TransitionGalleryRight"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.O8d,Ka.Direction=Wc.S8,Ka.Duration=1600,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionGalleryIcon",qb.next="TransitionGalleryIconFromRight",qb));let Qb,
t;this.Dc.$("TransitionGalleryIconFromRight",(t=new rd,t.rc=ResourceStrings.L_TransitionFromRight,t.uc=wd.Gc("TransitionGalleryRight"),t.tc=(Qb=new jd,Qb.TransitionType=Nb.O8d,Qb.Direction=Wc.S8,Qb.Duration=1600,Qb.IsManualAdvance=!0,Qb),t.parent="TransitionGalleryIcon",t.next="TransitionGalleryIconFromLeft",t));let Y,pa;this.Dc.$("TransitionGalleryIconFromLeft",(pa=new rd,pa.rc=ResourceStrings.L_TransitionFromLeft,pa.uc=wd.Gc("TransitionGalleryLeft"),pa.tc=(Y=new jd,Y.TransitionType=Nb.O8d,Y.Direction=
Wc.zEa,Y.Duration=1600,Y.IsManualAdvance=!0,Y),pa.parent="TransitionGalleryIcon",pa))}if(!Array.contains(Ga,"cube")){let Ka,qb;this.Dc.$("TransitionCube",(qb=new rd,qb.rc=ResourceStrings.L_TransitionCube,qb.uc=wd.Gc("TransitionCubeFromRight"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.WM,Ka.Direction=Wc.H2f,Ka.Duration=1200,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionCube",qb.next="TransitionCubeFromRight",qb));let Qb,t;this.Dc.$("TransitionCubeFromRight",(t=new rd,t.rc=ResourceStrings.L_TransitionFromRight,
t.uc=wd.Gc("TransitionCubeFromRight"),t.tc=(Qb=new jd,Qb.TransitionType=Nb.WM,Qb.Direction=Wc.H2f,Qb.Duration=1200,Qb.IsManualAdvance=!0,Qb),t.parent="TransitionCube",t.next="TransitionCubeFromBottom",t));let Y,pa;this.Dc.$("TransitionCubeFromBottom",(pa=new rd,pa.rc=ResourceStrings.L_TransitionFromBottom,pa.uc=wd.Gc("TransitionCubeFromBottom"),pa.tc=(Y=new jd,Y.TransitionType=Nb.WM,Y.Direction=Wc.t8i,Y.Duration=1200,Y.IsManualAdvance=!0,Y),pa.parent="TransitionCube",pa.next="TransitionCubeFromLeft",
pa));let Ja,Ya;this.Dc.$("TransitionCubeFromLeft",(Ya=new rd,Ya.rc=ResourceStrings.L_TransitionFromLeft,Ya.uc=wd.Gc("TransitionCubeFromLeft"),Ya.tc=(Ja=new jd,Ja.TransitionType=Nb.WM,Ja.Direction=Wc.C8i,Ja.Duration=1200,Ja.IsManualAdvance=!0,Ja),Ya.parent="TransitionCube",Ya.next="TransitionCubeFromTop",Ya));let jb,Sb;this.Dc.$("TransitionCubeFromTop",(Sb=new rd,Sb.rc=ResourceStrings.L_TransitionFromTop,Sb.uc=wd.Gc("TransitionCubeFromTop"),Sb.tc=(jb=new jd,jb.TransitionType=Nb.WM,jb.Direction=Wc.M8i,
jb.Duration=1200,jb.IsManualAdvance=!0,jb),Sb.parent="TransitionCube",Sb))}if(!Array.contains(Ga,"doors")){let Ka,qb;this.Dc.$("TransitionDoors",(qb=new rd,qb.rc=ResourceStrings.L_TransitionDoors,qb.uc=wd.Gc("TransitionDoorsVertical"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.m4d,Ka.Direction=Wc.Mab,Ka.Duration=1400,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionDoors",qb.next="TransitionDoorsVertical",qb));let Qb,t;this.Dc.$("TransitionDoorsVertical",(t=new rd,t.rc=ResourceStrings.L_TransitionVertical,
t.uc=wd.Gc("TransitionDoorsVertical"),t.tc=(Qb=new jd,Qb.TransitionType=Nb.m4d,Qb.Direction=Wc.Mab,Qb.Duration=1400,Qb.IsManualAdvance=!0,Qb),t.parent="TransitionDoors",t.next="TransitionDoorsHorizontal",t));let Y,pa;this.Dc.$("TransitionDoorsHorizontal",(pa=new rd,pa.rc=ResourceStrings.L_TransitionHorizontal,pa.uc=wd.Gc("TransitionDoorsHorizontal"),pa.tc=(Y=new jd,Y.TransitionType=Nb.m4d,Y.Direction=Wc.WXc,Y.Duration=1400,Y.IsManualAdvance=!0,Y),pa.parent="TransitionDoors",pa))}if(!Array.contains(Ga,
"box")){let Ka,qb;this.Dc.$("TransitionBox",(qb=new rd,qb.rc=ResourceStrings.L_TransitionBox,qb.uc=wd.Gc("TransitionBoxFromRight"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.WM,Ka.Direction=Wc.G2f,Ka.Duration=1600,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionBox",qb.next="TransitionBoxFromRight",qb));let Qb,t;this.Dc.$("TransitionBoxFromRight",(t=new rd,t.rc=ResourceStrings.L_TransitionFromRight,t.uc=wd.Gc("TransitionBoxFromRight"),t.tc=(Qb=new jd,Qb.TransitionType=Nb.WM,Qb.Direction=Wc.G2f,Qb.Duration=
1600,Qb.IsManualAdvance=!0,Qb),t.parent="TransitionBox",t.next="TransitionBoxFromBottom",t));let Y,pa;this.Dc.$("TransitionBoxFromBottom",(pa=new rd,pa.rc=ResourceStrings.L_TransitionFromBottom,pa.uc=wd.Gc("TransitionBoxFromBottom"),pa.tc=(Y=new jd,Y.TransitionType=Nb.WM,Y.Direction=Wc.s8i,Y.Duration=1600,Y.IsManualAdvance=!0,Y),pa.parent="TransitionBox",pa.next="TransitionBoxFromLeft",pa));let Ja,Ya;this.Dc.$("TransitionBoxFromLeft",(Ya=new rd,Ya.rc=ResourceStrings.L_TransitionFromLeft,Ya.uc=wd.Gc("TransitionBoxFromLeft"),
Ya.tc=(Ja=new jd,Ja.TransitionType=Nb.WM,Ja.Direction=Wc.B8i,Ja.Duration=1600,Ja.IsManualAdvance=!0,Ja),Ya.parent="TransitionBox",Ya.next="TransitionBoxFromTop",Ya));let jb,Sb;this.Dc.$("TransitionBoxFromTop",(Sb=new rd,Sb.rc=ResourceStrings.L_TransitionFromTop,Sb.uc=wd.Gc("TransitionBoxFromTop"),Sb.tc=(jb=new jd,jb.TransitionType=Nb.WM,jb.Direction=Wc.L8i,jb.Duration=1600,jb.IsManualAdvance=!0,jb),Sb.parent="TransitionBox",Sb))}if(!Array.contains(Ga,"comb")){let Ka,qb;this.Dc.$("TransitionComb",
(qb=new rd,qb.rc=ResourceStrings.L_TransitionComb,qb.uc=wd.Gc("TransitionCombHorizontal"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.HZd,Ka.Direction=Wc.none,Ka.Duration=1E3,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionComb",qb.next="TransitionCombHorizontal",qb));let Qb,t;this.Dc.$("TransitionCombHorizontal",(t=new rd,t.rc=ResourceStrings.L_TransitionHorizontal,t.uc=wd.Gc("TransitionCombHorizontal"),t.tc=(Qb=new jd,Qb.TransitionType=Nb.HZd,Qb.Direction=Wc.WXc,Qb.Duration=1E3,Qb.IsManualAdvance=!0,Qb),
t.parent="TransitionComb",t.next="TransitionCombVertical",t));let Y,pa;this.Dc.$("TransitionCombVertical",(pa=new rd,pa.rc=ResourceStrings.L_TransitionVertical,pa.uc=wd.Gc("TransitionCombVertical"),pa.tc=(Y=new jd,Y.TransitionType=Nb.HZd,Y.Direction=Wc.Mab,Y.Duration=1E3,Y.IsManualAdvance=!0,Y),pa.parent="TransitionComb",pa))}if(!Array.contains(Ga,"zoom")){let Ka,qb;this.Dc.$("TransitionZoom",(qb=new rd,qb.rc=ResourceStrings.L_TransitionZoom,qb.uc=wd.Gc("TransitionZoomIn"),qb.tc=(Ka=new jd,Ka.TransitionType=
Nb.zoom,Ka.Direction=Wc.$8b,Ka.Duration=900,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionZoom",qb.next="TransitionZoomIn",qb));let Qb,t;this.Dc.$("TransitionZoomIn",(t=new rd,t.rc=ResourceStrings.L_TransitionIn,t.uc=wd.Gc("TransitionZoomIn"),t.tc=(Qb=new jd,Qb.TransitionType=Nb.zoom,Qb.Direction=Wc.$8b,Qb.Duration=900,Qb.IsManualAdvance=!0,Qb),t.parent="TransitionZoom",t.next="TransitionZoomOut",t));let Y,pa;this.Dc.$("TransitionZoomOut",(pa=new rd,pa.rc=ResourceStrings.L_TransitionOut,pa.uc=wd.Gc("TransitionZoomOut"),
pa.tc=(Y=new jd,Y.TransitionType=Nb.zoom,Y.Direction=Wc.Aee,Y.Duration=900,Y.IsManualAdvance=!0,Y),pa.parent="TransitionZoom",pa.next="TransitionZoomAndRotate",pa));let Ja,Ya;this.Dc.$("TransitionZoomAndRotate",(Ya=new rd,Ya.rc=ResourceStrings.L_TransitionZoomAndRotate,Ya.uc=wd.Gc("TransitionNewsFlash"),Ya.tc=(Ja=new jd,Ja.TransitionType=Nb.SVl,Ja.Direction=Wc.none,Ja.Duration=1500,Ja.IsManualAdvance=!0,Ja),Ya.parent="TransitionZoom",Ya))}if(!Array.contains(Ga,"random")){let Ka,qb;this.Dc.$("TransitionRandom",
(qb=new rd,qb.rc=ResourceStrings.L_TransitionRandom,qb.uc=wd.Gc("TransitionRandom"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.random,Ka.Direction=Wc.nyj,Ka.Duration=1500,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionRandom",qb))}}if(!Array.contains(Ga,"menusectiondynamiccontent")){if(!Array.contains(Ga,"pan")){let Ka,qb;this.Dc.$("TransitionPan",(qb=new rd,qb.rc=ResourceStrings.L_TransitionPan,qb.uc=wd.Gc("TransitionPanFromBottom"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.pan,Ka.Direction=Wc.vTa,Ka.Duration=
1300,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionPan",qb.next="TransitionPanFromBottom",qb));this.Dc.$("TransitionPanFromBottom",Object.assign(new rd,{rc:ResourceStrings.L_TransitionFromBottom,uc:wd.Gc("TransitionPanFromBottom"),tc:Object.assign(new jd,{TransitionType:Nb.pan,Direction:Wc.vTa,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromLeft"}));this.Dc.$("TransitionPanFromLeft",Object.assign(new rd,{rc:ResourceStrings.L_TransitionFromLeft,uc:wd.Gc("TransitionPanFromLeft"),
tc:Object.assign(new jd,{TransitionType:Nb.pan,Direction:Wc.zEa,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromRight"}));this.Dc.$("TransitionPanFromRight",Object.assign(new rd,{rc:ResourceStrings.L_TransitionFromRight,uc:wd.Gc("TransitionPanFromRight"),tc:Object.assign(new jd,{TransitionType:Nb.pan,Direction:Wc.S8,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromTop"}));this.Dc.$("TransitionPanFromTop",Object.assign(new rd,{rc:ResourceStrings.L_TransitionFromTop,
uc:wd.Gc("TransitionPanFromTop"),tc:Object.assign(new jd,{TransitionType:Nb.pan,Direction:Wc.xxb,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan"}))}if(!Array.contains(Ga,"conveyor")){this.Dc.$("TransitionConveyor",Object.assign(new rd,{rc:ResourceStrings.L_TransitionConveyor,uc:wd.Gc("TransitionConveyorRight"),tc:Object.assign(new jd,{TransitionType:Nb.Z_d,Direction:Wc.S8,Duration:1600,IsManualAdvance:!0}),parent:"TransitionConveyor",next:"TransitionConveyorFromRight"}));let Ka,qb;this.Dc.$("TransitionConveyorFromRight",
(qb=new rd,qb.rc=ResourceStrings.L_TransitionFromRight,qb.uc=wd.Gc("TransitionConveyorRight"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.Z_d,Ka.Direction=Wc.S8,Ka.Duration=1600,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionConveyor",qb.next="TransitionConveyorFromLeft",qb));let Qb,t;this.Dc.$("TransitionConveyorFromLeft",(t=new rd,t.rc=ResourceStrings.L_TransitionFromLeft,t.uc=wd.Gc("TransitionConveyorLeft"),t.tc=(Qb=new jd,Qb.TransitionType=Nb.Z_d,Qb.Direction=Wc.zEa,Qb.Duration=1600,Qb.IsManualAdvance=
!0,Qb),t.parent="TransitionConveyor",t))}if(!Array.contains(Ga,"rotate")){let Ka,qb;this.Dc.$("TransitionRotate",(qb=new rd,qb.rc=ResourceStrings.L_TransitionRotate,qb.uc=wd.Gc("TransitionRotateLeft"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.WM,Ka.Direction=Wc.J2f,Ka.Duration=2E3,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionRotate",qb.next="TransitionRotateFromRight",qb));let Qb,t;this.Dc.$("TransitionRotateFromRight",(t=new rd,t.rc=ResourceStrings.L_TransitionFromRight,t.uc=wd.Gc("TransitionRotateLeft"),
t.tc=(Qb=new jd,Qb.TransitionType=Nb.WM,Qb.Direction=Wc.J2f,Qb.Duration=2E3,Qb.IsManualAdvance=!0,Qb),t.parent="TransitionRotate",t.next="TransitionRotateFromBottom",t));let Y,pa;this.Dc.$("TransitionRotateFromBottom",(pa=new rd,pa.rc=ResourceStrings.L_TransitionFromBottom,pa.uc=wd.Gc("TransitionRotateTop"),pa.tc=(Y=new jd,Y.TransitionType=Nb.WM,Y.Direction=Wc.x8i,Y.Duration=2E3,Y.IsManualAdvance=!0,Y),pa.parent="TransitionRotate",pa.next="TransitionRotateFromLeft",pa));let Ja,Ya;this.Dc.$("TransitionRotateFromLeft",
(Ya=new rd,Ya.rc=ResourceStrings.L_TransitionFromLeft,Ya.uc=wd.Gc("TransitionRotateRight"),Ya.tc=(Ja=new jd,Ja.TransitionType=Nb.WM,Ja.Direction=Wc.F8i,Ja.Duration=2E3,Ja.IsManualAdvance=!0,Ja),Ya.parent="TransitionRotate",Ya.next="TransitionRotateFromTop",Ya));let jb,Sb;this.Dc.$("TransitionRotateFromTop",(Sb=new rd,Sb.rc=ResourceStrings.L_TransitionFromTop,Sb.uc=wd.Gc("TransitionRotateBottom"),Sb.tc=(jb=new jd,jb.TransitionType=Nb.WM,jb.Direction=Wc.Q8i,jb.Duration=2E3,jb.IsManualAdvance=!0,jb),
Sb.parent="TransitionRotate",Sb))}if(!Array.contains(Ga,"window")){let Ka,qb;this.Dc.$("TransitionWindow",(qb=new rd,qb.rc=ResourceStrings.L_TransitionWindow,qb.uc=wd.Gc("TransitionWindowVertical"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.window,Ka.Direction=Wc.Mab,Ka.Duration=1500,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionWindow",qb.next="TransitionWindowVertical",qb));let Qb,t;this.Dc.$("TransitionWindowVertical",(t=new rd,t.rc=ResourceStrings.L_TransitionVertical,t.uc=wd.Gc("TransitionWindowVertical"),
t.tc=(Qb=new jd,Qb.TransitionType=Nb.window,Qb.Direction=Wc.Mab,Qb.Duration=1500,Qb.IsManualAdvance=!0,Qb),t.parent="TransitionWindow",t.next="TransitionWindowHorizontal",t));let Y,pa;this.Dc.$("TransitionWindowHorizontal",(pa=new rd,pa.rc=ResourceStrings.L_TransitionHorizontal,pa.uc=wd.Gc("TransitionWindowHorizontal"),pa.tc=(Y=new jd,Y.TransitionType=Nb.window,Y.Direction=Wc.WXc,Y.Duration=1500,Y.IsManualAdvance=!0,Y),pa.parent="TransitionWindow",pa))}if(!Array.contains(Ga,"orbit")){let Ka,qb;this.Dc.$("TransitionOrbit",
(qb=new rd,qb.rc=ResourceStrings.L_TransitionOrbit,qb.uc=wd.Gc("TransitionOrbitFromRight"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.WM,Ka.Direction=Wc.I2f,Ka.Duration=1600,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionOrbit",qb.next="TransitionOrbitFromRight",qb));let Qb,t;this.Dc.$("TransitionOrbitFromRight",(t=new rd,t.rc=ResourceStrings.L_TransitionFromRight,t.uc=wd.Gc("TransitionOrbitFromRight"),t.tc=(Qb=new jd,Qb.TransitionType=Nb.WM,Qb.Direction=Wc.I2f,Qb.Duration=1600,Qb.IsManualAdvance=!0,Qb),
t.parent="TransitionOrbit",t.next="TransitionOrbitFromBottom",t));let Y,pa;this.Dc.$("TransitionOrbitFromBottom",(pa=new rd,pa.rc=ResourceStrings.L_TransitionFromBottom,pa.uc=wd.Gc("TransitionOrbitFromBottom"),pa.tc=(Y=new jd,Y.TransitionType=Nb.WM,Y.Direction=Wc.w8i,Y.Duration=1600,Y.IsManualAdvance=!0,Y),pa.parent="TransitionOrbit",pa.next="TransitionOrbitFromLeft",pa));let Ja,Ya;this.Dc.$("TransitionOrbitFromLeft",(Ya=new rd,Ya.rc=ResourceStrings.L_TransitionFromLeft,Ya.uc=wd.Gc("TransitionOrbitFromLeft"),
Ya.tc=(Ja=new jd,Ja.TransitionType=Nb.WM,Ja.Direction=Wc.E8i,Ja.Duration=1600,Ja.IsManualAdvance=!0,Ja),Ya.parent="TransitionOrbit",Ya.next="TransitionOrbitFromTop",Ya));let jb,Sb;this.Dc.$("TransitionOrbitFromTop",(Sb=new rd,Sb.rc=ResourceStrings.L_TransitionFromTop,Sb.uc=wd.Gc("TransitionOrbitFromTop"),Sb.tc=(jb=new jd,jb.TransitionType=Nb.WM,jb.Direction=Wc.P8i,jb.Duration=1600,jb.IsManualAdvance=!0,jb),Sb.parent="TransitionOrbit",Sb))}if(!Array.contains(Ga,"flythrough")){let Ka,qb;this.Dc.$("TransitionFlyThrough",
(qb=new rd,qb.rc=ResourceStrings.L_TransitionFlyThrough,qb.uc=wd.Gc("TransitionFlyThroughIn"),qb.tc=(Ka=new jd,Ka.TransitionType=Nb.z6b,Ka.Direction=Wc.$8b,Ka.Duration=800,Ka.IsManualAdvance=!0,Ka),qb.parent="TransitionFlyThrough",qb.next="TransitionFlyThroughIn",qb));let Qb,t;this.Dc.$("TransitionFlyThroughIn",(t=new rd,t.rc=ResourceStrings.L_TransitionIn,t.uc=wd.Gc("TransitionFlyThroughIn"),t.tc=(Qb=new jd,Qb.TransitionType=Nb.z6b,Qb.Direction=Wc.$8b,Qb.Duration=800,Qb.IsManualAdvance=!0,Qb),t.parent=
"TransitionFlyThrough",t.next="TransitionFlyThroughOut",t));let Y,pa;this.Dc.$("TransitionFlyThroughOut",(pa=new rd,pa.rc=ResourceStrings.L_TransitionOut,pa.uc=wd.Gc("TransitionFlyThroughOut"),pa.tc=(Y=new jd,Y.TransitionType=Nb.z6b,Y.Direction=Wc.Aee,Y.Duration=800,Y.IsManualAdvance=!0,Y),pa.parent="TransitionFlyThrough",pa.next="TransitionFlyThroughInWithBounce",pa));let Ja,Ya;this.Dc.$("TransitionFlyThroughInWithBounce",(Ya=new rd,Ya.rc=ResourceStrings.L_TransitionInWithBounce,Ya.uc=wd.Gc("TransitionFlyThroughIn"),
Ya.tc=(Ja=new jd,Ja.TransitionType=Nb.z6b,Ja.Direction=Wc.Y6i,Ja.Duration=900,Ja.IsManualAdvance=!0,Ja),Ya.parent="TransitionFlyThrough",Ya.next="TransitionFlyThroughOutWithBounce",Ya));let jb,Sb;this.Dc.$("TransitionFlyThroughOutWithBounce",(Sb=new rd,Sb.rc=ResourceStrings.L_TransitionOutWithBounce,Sb.uc=wd.Gc("TransitionFlyThroughOut"),Sb.tc=(jb=new jd,jb.TransitionType=Nb.z6b,jb.Direction=Wc.Z6i,jb.Duration=900,jb.IsManualAdvance=!0,jb),Sb.parent="TransitionFlyThrough",Sb))}}this.Dc.forEach((Ka,
qb)=>{Ka===qb.parent&&++na;return!0})}wUa(A){let W=null;A?this.Dc.forEach((na,Ga)=>{Ga.tc&&Ga.tc.TransitionType===A.TransitionType&&Ga.tc.Direction===A.Direction&&(W=na);return!0}):W="TransitionNone";return W}JQ(A){return this.Dc.ga(A)}dzb(A){return(A=this.wUa(A))?this.Dc.ga(this.Dc.ga(A).parent):null}xUa(A){return(A=this.wUa(A))?this.Dc.ga(A).parent:null}z9f(A){let W,na=null;W=null;A&&A.next&&(W=A.next,na=this.JQ(W));return{returnValue:na,key:W}}nyb(){var A=[wd.a9i,wd.s_k,wd.t_k];for(const W of A)if(A=
document.getElementById(W))return A;return null}s3c(A,W){return A&&W&&W.childNodes?A.startsWith(wd.b9i)?W.contains(document.getElementById(A)):!1:!W&&A?"TransitionExisting"===A||"TransitionNone"===A||"TransitionMorph"===A||"TransitionCut"===A||"TransitionFade"===A||"TransitionPush"===A||"TransitionWipe"===A:!1}static Gc(A){return Ne.a.eoc+"_"+A+"_32x32x32"}}wd.a9i="PptRibbon.Transition.Gallery-MaxSize-1-0";wd.s_k="Transitions";wd.t_k="Transitions-previewWrapper";wd.b9i="Transition";Object(h.a)(wd,
"TransitionHelper",null,[690]);var Fe=d(193);class ak{constructor(A){this.y9e=(W,na,Ga,Ka,qb)=>1===Ga?32:qb?32:16;this.ia=A}vb(){this.ia.ra(fd.a.UMh,Lc.a.application,this.y9e,4);this.ia.ra(fd.a.fNh,Lc.a.application,this.y9e,4);this.ia.ra(fd.a.BOh,Lc.a.application,this.y9e,4)}pe(){}}Object(h.a)(ak,"PictureEnhancementActor",null,[251]);var tj=d(1169);class bh{constructor(){this.jh=this.K=null}get name(){return"PowerPointWebEditor.Advanced"}Yb(A){this.K=A;this.jh=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder").XEa(0,
this.name);this.K.register(658,"PowerPointWebEditor.IParagraphLevelPropertyChangedHandlers").ma().oa(()=>new pc(this.K.resolve("Common.IActionManagerExtended")));if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").kQ){const W=Fe.a(this.K);this.K.register(659,"PowerPointWebEditor.IAudioManagerStore").ma().oa(()=>new ce);this.K.register(660,"PowerPointWebEditor.IAudioLibraryCallbackFactory").ma().oa(()=>new Lb(this.K.resolve("PowerPointWebEditor.IMediaLocalRequestHelper"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").kQ,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.Ia("PowerPointWebEditor.IAudioManagerStore")));this.K.register(661,"PowerPointWebEditor.IAudioManagerFactory").ma().oa(()=>new kd(this.K.resolve("PowerPointWebEditor.IAudioLibraryCallbackFactory"),W,this.K.resolve("PowerPointWebEditor.IMediaLocalRequestHelper"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner")));this.K.resolve("PowerPointWebEditor.IAudioManagerFactory");
this.K.resolve("PowerPointWebEditor.IAudioManagerStore")}}init(){let A=this.jh.Zt("resolve");var W=this.K.resolve("Common.AFrameworkApplication");const na=this.K.resolve("PowerPointWebEditor.IApplicationContext"),Ga=na.rd;W=W.aq;const Ka=this.K.resolve("Common.IActionManagerExtended"),qb=this.K.resolve("PowerPointWebEditor.IFocusManager");W=W.Kd;const Qb=this.K.resolve("Common.Transaction.ITransactionFactory"),t=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),Y=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),
pa=this.K.resolve("PowerPointWebEditor.PictureContext"),Ja=this.K.resolve("PowerPoint.IPathManager");var Ya=this.K.resolve("PowerPointWebEditor.IPresentationReader");const jb=this.K.resolve("PowerPointWebEditor.IShapeReader"),Sb=this.K.resolve("PowerPointWebEditor.IPictureUploader"),kc=this.K.oe("PowerPointWebEditor.IPPTLanguageDialogFactory"),db=this.K.resolve("Box4.IParagraphReader");this.jh.fu(A);A=this.jh.Zt("regactors");Ya=[new Hi(Ka,t,this.K.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"),
this.K.resolve("Box4.IParagraphIndentationReader"),this.K.resolve("Common.Transaction.ITransactionFactory"),db,this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),jb,this.K.resolve("PowerPointWebEditor.IParagraphLevelPropertyChangedHandlers"),vc.App.KMa.lOc(12),Ga.telemetryForPptParagraphSettingEnabled),new Eb(Ka,qb,Y,Qb,t,Ja,W,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ya,new Xe,Ga.Ppg,this.K.resolve("Common.IAppSettingsManager").ka("ChangingThemeSelectedSlidesEnabled"),
this.K.resolve("Common.IAppSettingsManager").ka("EnableDefaultThemeRefresh")),new ed(Ka,W,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Qb,t,qb,new wd(Ga.WMa,this.K.resolve("PowerPointWebEditor.IApplicationSettings").iA),Y,Ga,Ja,this.K.resolve("PowerPointWebEditor.View.IPPTPageView"))];Ga.atb?Ya.push(new cd(Ka,t,qb,Qb,new Pa(Ga.dVd),Y,jb,Ja,this.K.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("Box4.Graph.IGraphInstance").yd(8),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"))):Ya.push(new Hf(Ka,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),t,qb,Qb,new Pa(Ga.dVd),Y,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),jb,Ja));Ga.powerPointFormatBackgroundEnabled&&Ya.push(new Sg(Ka,qb,Y,t,Qb,W,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
Sb,pa,M.AFrameworkApplication.ZQ,this.K.resolve("PowerPointWebEditor.IErrorHandler"),Ga));Ga.qxb&&Ya.push(new ak(Ka));Ga.zxb&&M.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.Pictures.PictureBGREnabled",!1)&&Ya.push(new tj.a(Ka,this.K.resolve("PowerPointWebEditor.Core.IAppOfflineSetter"),t,this.K.resolve("PowerPointWebEditor.Image.IImageManager"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IRibbonChangeManager"),this.K.resolve("PowerPointWebEditor.IImageIdHelper"),this.K.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")));for(const Kb of Ya)Kb.vb(),Kb.pe();this.jh.fu(A);M.AFrameworkApplication.fa.ff(()=>{A=this.jh.Zt("regfullactors");const Kb=[],lc=this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration");lc.aWa=this.K.resolve("Common.IAppSettingsManager").ka("299");
na.rd.JKb&&Kb.push(new jj(Ka,kc,lc,this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.Ia("Box4.Proofing.ICritiqueTypeSettings"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.ILanguageReader"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Box4.IProofingManager"),t));this.K.resolve("PowerPointWebEditor.IApplicationSettings").A$b&&
Kb.push(new ij(Ka,qb,t,Fe.a(this.K)));for(const Jc of Kb)Jc.vb(),Jc.pe();lc.aWa&&(new Qi(Ka,this.K.resolve("Box4.Proofing.ICritiqueTypeSettings"),(Jc,Vc)=>new ze(Jc,this.K.resolve("Box4.Proofing.IProofingConfigV2Manager"),Vc,this.K.resolve("Common.IFocusManager")),this.K.resolve("Box4.Proofing.IProofingConfigV2Manager"),t,this.K.resolve("Box4.ILanguageReader"),jb)).vb();this.jh.fu(A)})}dispose(){}}Object(h.a)(bh,"AdvancedPackage",null,[2,3]);class ee{get container(){return I.a.instance.resolve("PowerPointWebEditor.IRibbonPane").va}}
Object(h.a)(ee,"PPTFloatPaneContainer",null,[562]);class Mi{constructor(A,W,na=null){this.jhb=new zd.a(0);this.G_a=null;this.Rib=this.G_a=vc.App.pn;this.bye=A;this.t1g=1E3*W;this.PEg=na||(()=>(new Date).getTime())}spi(A){this.bye&&this.jhb.add(A,(new Date).getTime())}dXf(A){this.bye&&(this.jhb.remove(A),this.iHl(this.PEg()-this.t1g))}iHl(A){if(this.jhb.count){var W=[];this.jhb.forEach((na,Ga)=>{Ga<A&&W.push(na);return!0});for(const na of W)this.jhb.remove(na)}}get hog(){return this.Rib<=this.G_a}NGj(){if(!this.bye||
!this.jhb.count)return!1;let A=!1;const W=this.PEg();this.jhb.forEach((na,Ga)=>W-Ga<this.t1g?(A=!0,!1):!0);return A}}Object(h.a)(Mi,"PictureContext",null,[655]);var Nl=d(921),Cg=d(525);class zi{constructor(){this.nfb=this.HCe=this.lMg=this.mMg=!1;this.jh=this.w5=this.XFb=this.HMg=this.K=null;this.afc=[new bh];this.YX=[]}get name(){return"PowerPointWebEditor.Chronos"}Yb(A){this.K=A;this.w5=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.jh=this.w5.XEa(0,this.name);for(let W=0;W<
this.afc.length;++W)Array.add(this.YX,qd.a(this.afc[W],0));for(const W of this.YX)W.Yb(A);zi.hFi(A);this.K.register(Mi,"PowerPointWebEditor.PictureContext").as("PowerPointWebEditor.IPictureContext").ma().oa(()=>new Mi(this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditingPromptUnsavedDialogForUploadingImageEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditingUploadLargeImageTimeoutInSeconds))}Wmc(A,W){A=yb.a.instance;for(let Ga=0;Ga<W.entries.length;Ga++){var na=
W.entries[Ga];na.url=D.a.removeParameter(na.url,M.AFrameworkApplication.gW);const Ka=D.a.Poa(na.url);let qb=!1;if("about:blank"===na.url||Ka.endsWith("RemoteUls.ashx")||"renamehandler.ashx"===Ka&&"2"===D.a.JT(na.url,"u")||this.nfb&&(qb=Ka.endsWith("PowerPoint.ashx"))&&na.url.endsWith("ib=1"))na.behavior=1;else{if(qb||Ka.endsWith("PowerPoint.ashx")||Ka.endsWith("GetUpdates")||Ka.endsWith("images.ashx")||Ka.endsWith("GetThumb"))na.behavior=2;if(!this.mMg&&Ka.endsWith("PowerPoint.ashx")&&"true"===D.a.JT(na.url,
oc.a.RLk))na=na.mC,A.lc(ef.a.C_d,parseInt(String(na.fetchStart))),A.lc(ef.a.wHi,parseInt(String(na.responseStart))),A.lc(ef.a.oHi,parseInt(String(na.responseEnd-na.responseStart))),this.mMg=!0;else if(!this.lMg&&Ka.endsWith("PowerPoint.ashx")&&"true"===D.a.JT(na.url,"dSlide")){this.lMg=!0;na=na.mC;A.lc("SlideImageFetchStart",parseInt(String(na.fetchStart)));A.lc("SlideImageResponseStart",parseInt(String(na.responseStart)));A.lc("SlideImageDownloadDuration",parseInt(String(na.responseEnd-na.responseStart)));
let Qb;({transferSize:Qb}=zi.vLh(na)).returnValue&&A.lc("SlideImageSize",Qb)}else if(!this.HCe&&Ka.endsWith("images.ashx")&&"true"===D.a.JT(na.url,"minimalboot")&&D.a.JT(na.url,"index")===this.HMg){this.HCe=!0;na=na.mC;A.lc("MBootFetchStart",parseInt(String(na.fetchStart)));A.lc("MBootResponseStart",parseInt(String(na.responseStart)));A.lc("MBootDownload",parseInt(String(na.responseEnd-na.responseStart)));let Qb;({transferSize:Qb}=zi.vLh(na)).returnValue&&A.lc("MBootSize",Qb)}}}}iml(){const A=window.self.FirstSlideRequestIndex;
void 0===A||null===A?this.HCe=!0:this.HMg=A.toString()}init(){bd.a.J(512497358,809,50,"ChronosPackage::Init");const A=this.K.resolve("PowerPointWebEditor.IApplicationSettings"),W=this.K.resolve("Common.ITaskManager");for(var na of this.YX)this.jh.Zt(na.name),na.init(),this.jh.fu(na.name);this.K.resolve("Common.IAppSettingsManager").ff(()=>{if(A.podsAnimationSuggestionEnabled){const Ga=this.jh.Zt("animationpreview");this.xNj();this.jh.fu(Ga)}});this.K.resolve("Common.IActionManagerExtended").Kaa(this.K.resolve("PowerPointWebEditor.IPasteFloatieHelper"));
na=I.a.instance.resolve("Box4.IProofingManager");if(null!==na){let Ga=this.jh.Zt("proofingresume");na.resume();this.jh.fu(Ga)}if(A.$ua||!A.iWa)na=this.jh.Zt("loaddelayedres"),this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager").PEh(),this.jh.fu(na);this.iml();this.nfb=A.podsUseRealtimeCoauthReplicationTimerForInbound;na=this.K.resolve("Common.NetworkTiming.IResourceTimingLogger");na.Yb(30,0);na.Syf(Object(n.a)(this,this.Wmc,"onResourceTimingEntriesAvailable"));na.activate();A.UVa&&
(this.XFb=window.self.PerfMeterData,void 0!==this.XFb&&null!==this.XFb&&(W.Hb(new be.a(3,2,6E4,Object(n.a)(this,this.collectPerfMeterData,"collectPerfMeterData"),90,"67")),bd.a.J(512497357,809,50,"CollectPerfMeterData task started"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler").GC(()=>{this.collectPerfMeterData(null)})));A.ka("IsPasteTextFloatieEnabled")&&this.K.resolve("Common.IActionManagerExtended").Kaa(this.K.resolve("Box4.ITextPasteFloatieManager"));this.z9j(A)}z9j(A){bd.a.J(512497356,
809,50,"Start to download chronos1 js file");if(A.Nwc)this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Dda("pptedit.chronos1",null,()=>d.e(2).then(d.bind(null,1291)));else{A=Cb.a.create("pptedit.chronos1",null,()=>d.e(2).then(d.bind(null,1291)));const W=this.K.resolve("PowerPointWebEditor.ISessionState");A.kW(()=>{W&&W.p6("Chronos1DownloadFinished")});Ca.a.oy(A)}}collectPerfMeterData(){if(0<this.XFb.length){const A=[];for(const W of this.XFb)A.push({["Id"]:W.Id,["Value"]:W.Value.toFixed(2),
["Start"]:W.Start.toFixed(2),["Duration"]:W.Duration.toFixed(2)});bd.a.J(512497355,813,50,JSON.stringify(A));this.XFb.length=0}}dispose(){for(var A of this.YX)A.dispose();A=this.K.resolve("Common.NetworkTiming.IResourceTimingLogger");A.deactivate(!0);A.soh(Object(n.a)(this,this.Wmc,"onResourceTimingEntriesAvailable"))}xNj(){const A=Cb.a.create("pptedit.animationpreview",null,()=>d.e(19).then(d.bind(null,1307)));try{Ca.a.oy(A)}catch(W){bd.a.J(512497354,809,10,"ChronosPackage::InitializeAnimationPreview - Failed to download animationpreview script, Exception: {0}",
W.toString())}}static hFi(A){A.register(562,"Common.IFloatPaneContainer").ma().oa(()=>new ee)}static vLh(A){A=parseInt(String(Nl.a(A,"transferSize")));return{returnValue:!A.toString().startsWith("NaN"),transferSize:A}}static main(){M.AFrameworkApplication.Yg&&Z.a.gg?bd.a.J(512497353,809,15,"Firefox attempts to load chronos package when App is disposing"):(yb.a.instance.lc(Cg.a.LYd,(new Date).getTime()),Ia.a.instance.Ac(qd.a(new zi,0)))}}Object(h.a)(zi,"ChronosPackage",null,[2,3]);class Zh{constructor(A,
W,na,Ga,Ka,qb,Qb){this.VGb=this.sO=!1;this.ta=A;this.jc=W;this.Pr=na;this.Us=Ga;this.xdb=qb;this.le=Ka;this.Iw=this.ta.Ba;this.Kc=Qb}initialize(){this.Pr.fk(Object(n.a)(this,this.$g,"onPropertyChanged"));this.le.w7a(Object(n.a)(this,this.iga,"onRibbonTabSwitched"));this.Us.aT(Object(n.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.Us.Msb(Object(n.a)(this,this.Rxa,"onShapeViewElementAdded"));this.Us.hii(Object(n.a)(this,this.ibh,"onShapesAllSelected"))}dispose(){this.Pr.Om(Object(n.a)(this,
this.$g,"onPropertyChanged"));this.le.brc(Object(n.a)(this,this.iga,"onRibbonTabSwitched"));this.Us.Uoa(Object(n.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.Us.ipd(Object(n.a)(this,this.Rxa,"onShapeViewElementAdded"));this.Us.X8k(Object(n.a)(this,this.ibh,"onShapesAllSelected"))}$g(A,W){W.property===Eg.a.NTc&&this.sO&&this.jc.mg(W.node)===this.Iw&&this.ZKa(this.sO)}iga(A,W){if(this.sO=!!W.Xfa&&0<=W.Xfa.indexOf("Animation"))this.VGb=!0;this.ZKa(this.sO)}Rxa(A,W){(A=this.ta.Ba)&&
A.nO&&A===this.Iw&&(W=W.$w)&&W.shapeNode&&this.Iw&&this.vGa(this.Iw.Db,W.shapeNode)&&this.ZKa(this.sO)}vGa(A,W){return A&&W?A.equals(W.slideId):!1}onActiveSlideDomReady(A,W){(A=Object(z.a)(118,W.Ba))&&this.Iw&&this.Iw.Db!==A.Db&&(this.Iw=A,this.ZKa(this.sO))}ibh(){this.Waa()}Waa(){if(this.sO&&this.Iw&&this.Iw.qFa&&this.VGb){var A=this.Iw.Uj();if(A&&0<A.length)for(const W of A)W&&W.Pbb()&&(A=this.xdb.ZI(W))&&(A.Q1b(),A.Waa(!0))}}ZKa(A){if(this.VGb&&this.Iw&&this.Iw.nO&&this.Kc.Jc&&this.Kc.Jc.PJc){var W=
this.Iw.Uj();if(W&&0<W.length)for(const na of W)na&&(W=this.xdb.ZI(na))&&(W.visible=A,W.Rjb())}}}Object(h.a)(Zh,"AnimationMarkerManagerLegacy",null,[107]);var ch=d(77),kk=d(58);class Vi{constructor(A,W){this.height=A;this.top=W}}Object(h.a)(Vi,"ParagraphProperties",null,[]);var kj=d(49),Ni=d(68),ph=d(137),Ck=d(167),Rj=d(190),Jk=d(191);class hk{constructor(A,W,na,Ga,Ka,qb,Qb,t,Y,pa,Ja,Ya,jb,Sb,kc){this.$hc=this.xA=this.PGb=this.Rk=this.Ab=!1;this.xa=new ch.a;this.ric=this.od=1;this.an=this.$m=this.kh=
this.yb=this.nb=null;this.xm=db=>{db&&this.OO?(this.nb=new ph.a,this.nb.Dr("AnimationMarkerView"),this.OO.appendChild(this.nb.va),this.yb=new Jk.a,this.yb.Zj(0),this.nb.appendChild(this.yb.viewport),this.kh=new Ck.a,this.kh.Zj(1),this.kh.setVisibility(!1),this.yb.appendChild(this.kh),this.$m=new ph.a,this.$m.Dr("ShapeAnimationMarkerContainer"),this.$m.va.id=this.ua.id.toString(),this.$m.ah(20,this.nb.va.clientHeight),this.$m.Zj(1),this.nb.appendChild(this.$m),this.an=new ph.a,this.an.Dr("TextAnimationMarkerContainer"),
this.an.va.id=this.ua.id.toString(),this.an.ah(20,this.nb.va.clientHeight),this.an.Zj(1),this.nb.appendChild(this.an),this.$f.rb(Wb.a.qq,this.$m.va,this.BD),this.$f.rb(Wb.a.Vs,this.$m.va,this.BD),this.$f.rb(Wb.a.qq,this.an.va,this.BD),this.$f.rb(Wb.a.Vs,this.an.va,this.BD),this.$f.rb(Wb.a.YJ,this.$m.va,this.BUa),this.$f.rb(Wb.a.YJ,this.an.va,this.BUa),this.$f.rb(Wb.a.mouseDown,this.$m.va,this.BUa),this.$f.rb(Wb.a.mouseDown,this.an.va,this.BUa),this.Rc.rb(Wb.a.click,this.an.va,this.jYc),this.Rc.rb(Wb.a.click,
this.$m.va,this.jYc),this.setVisibility()):bd.a.J(509682581,800,10,"AnimationMarkerView: {0} is null",db?"m_markerViewParentElement":"parent")};this.KL=()=>!0;this.BUa=db=>{if(!db&&!db.Bc.id.startsWith(Ne.a.D7a)&&!db.Bc.id.startsWith("overlappedMarker"))return bd.a.J(509682580,800,50,"AnimationMarkerView:handleAnimationMarkerClick source element is not marker"),!1;db.eventName==Wb.a.YJ&&this.uMe(db);db=db.mc;db.preventDefault();db.stopPropagation();return!0};this.jYc=db=>{db=db.mc;db.preventDefault();
db.stopPropagation();return!0};this.setSelection=()=>{};this.setVisibility=()=>{let db=this.Ab&&!this.xA;this.ua&&this.ua.isHiddenShape&&(db=!1);this.nb&&this.nb.Sd(db);this.$m&&this.$m.Sd(db);this.an&&this.an.Sd(db)};this.Waa=db=>{if(this.F9()){this.PGb=db;db=[this.$m.va.childNodes,this.an.va.childNodes];for(const Kb of db)for(db=0;Kb&&db<Kb.length;db++)this.nsc(Kb[db],this.PGb)}};this.Agl=db=>{if(this.F9()){var Kb=[this.$m.va.childNodes,this.an.va.childNodes];for(const lc of Kb)for(Kb=0;lc&&Kb<
lc.length;Kb++){const Jc=this.Ixb(lc[Kb]);if(!Rg.a("FixAnimationMarkerAttributeNullCrash")||Jc)for(const Vc of db)Jc.includes(Vc)&&this.nsc(lc[Kb],!0)}}};this.Ixb=db=>{if(!db||!this.ua)return null;db=db.getAttribute("AnimProps");if(!db||!db.toString()||!db.toString().trim().length)return null;db=db.toString().split(" ");if(!db||!db.length)return null;const Kb=[];for(const lc of db){if(!lc||!lc.trim().length)return null;Kb.push(Number.parseInvariant(lc.trim()))}return Kb};this.F9=()=>{const db=!!this.ua&&
!!this.OO&&!!this.$m&&!!this.an;db||bd.a.J(509682579,800,10,"AnimationMarkerView: the containers are not exist.");return db};this.FRa=()=>{this.Fja(!0);this.Fja(!1)};this.Fja=db=>{if(this.$f&&this.Rc&&this.F9()&&(db=db?this.an.va:this.$m.va)&&db.childNodes&&0<db.childNodes.length){const Kb=db.childNodes;for(const lc=0;lc<Kb.length;)db.removeChild(Kb[lc])}};this.RRd=()=>{if(this.F9()){var db=this.jc.mg(this.ua);if(db){var Kb=db.myb(this.ua);if(Kb&&Kb.length){var lc=!1;db=!1;var Jc=[];for(var Vc of Kb)Vc.IsTextRangeType?
db=!0:(lc=!0,Jc.push(Vc));this.$hc=lc&&db;this.cNa(!0);this.cNa(!1);this.Fja(!1);0<Jc.length&&(Vc=0,Jc.sort((vd,me)=>vd.EffectNodeId-me.EffectNodeId),(Vc=Rg.a("FixOverlappedAnimationMarkers")?this.R4b(Jc,this.wi.YH(this.ua.Jn.kc,this.od),this.wi.YH(this.ua.Jn.Zb-this.ua.Jn.kc,this.od),!1,-1):this.rVf(Jc,this.wi.YH(this.ua.Jn.kc,this.od),this.wi.YH(this.ua.Jn.Zb-this.ua.Jn.kc,this.od),!1))||bd.a.J(509682577,800,10,"AnimationMarkerView: no shape marker is rendered"));db?this.I5d():this.Fja(!0)}else this.FRa()}else bd.a.J(509682578,
800,10,"AnimationMarkerView::addAnimationMarkers: slideNode is null")}};this.I5d=()=>{const db=new be.a(2,1,0,this.ensureTextIsRenderedAndDrawMarkers,90,"26");this.wb.Hb(db)};this.ensureTextIsRenderedAndDrawMarkers=()=>{this.Rk||(this.lwe(),this.S4b())};this.S4b=()=>{this.Fja(!0);if(this.dge()){var db=this.Sce();if(db&&db.length){var Kb;if(({top:Kb}=this.$ce()).returnValue){var lc=0;for(let Vc=0;Vc<db.length;Vc++){var Jc=this.jc.mg(this.ua);if(!Jc){bd.a.J(509682574,800,10,"AnimationMarkerView:drawTextAnimationMarkers slide node is null.");
return}(Jc=Jc.Jbe(this.ua,Vc))&&0<Jc.length&&db[Vc]&&(Jc.sort((vd,me)=>vd.EffectNodeId-me.EffectNodeId),lc=Rg.a("FixOverlappedAnimationMarkers")?lc+this.R4b(Jc,db[Vc].top-Kb,db[Vc].height,!0,Vc):lc+this.rVf(Jc,db[Vc].top-Kb,db[Vc].height,!0))}lc||bd.a.J(509682573,800,10,"AnimationMarkerView: no paragraph marker is rendered.")}else bd.a.J(509682575,800,50,"AnimationMarkerView: GetSlideContentClientRects failed.")}else bd.a.J(509682576,800,50,"AnimationMarkerView: the paragrph view is not rendered")}};
this.Sce=()=>{const db=[];var Kb=Yj.GraphIterator.pb(this.ua);Kb=this.Yl.A3(Kb,Kb.currentNode);for(var lc;Kb.moveNext();)(lc=Kb.currentNode)&&this.Gh.ae(lc)&&lc&&(lc=lc.qc(this.Iz))&&lc.htmlElement&&(lc=this.gua(lc.htmlElement))&&lc.height&&db.push(lc);return db};this.gua=db=>{if(!db)return bd.a.J(509682570,800,10,"AnimationMarkerView:getParagraphProperties paragraph is null"),null;db=db.querySelectorAll(".TextRun");if(!db||!db.length)return null;let Kb=0,lc=0;let Jc,Vc=!1;for(let me=0;me<db.length&&
db[me];me++){var vd=db[me].getClientRects();({top:vd,bottom:Jc}=this.s7d(vd)).returnValue&&(me?(Kb=Kb>vd?vd:Kb,lc=lc<Jc?Jc:lc):(Kb=vd,lc=Jc),Vc=!0)}if(Vc)return new Vi(lc-Kb,Kb);bd.a.J(509682569,800,50,"AnimationMarkerView: search failed in GetParagraphProperties.");return null};this.sK=()=>{this.IGe(this.nb.va,!0)};this.dge=()=>{var db=this.jc.mg(this.ua);if(!db)return bd.a.J(509682567,800,10,"AnimationMarkerView::hasTextAnimations: slideNode is null"),!1;db=db.myb(this.ua);if(!db||!db.length)return!1;
for(const Kb of db)if(Kb.IsTextRangeType)return!0;return!1};this.cNa=db=>{if(this.F9()){var Kb=db?this.$m.va:this.an.va,lc,Jc;Kb&&({x:lc,y:Jc}=this.hbe(db)).returnValue&&(Kb.style.position=Ni.a.absolute,Kb.style.left=kj.a.Pc(lc),Kb.style.zIndex="20000",db?Kb.style.top=kj.a.Pc(Jc):this.S4b())}};this.uMe=db=>{if(this.xa&&db&&this.Fa&&db.Bc){var Kb=Rg.a("FixOverlappedAnimationMarkers")?db.Bc.id.startsWith("overlappedMarker")&&db.Bc.parentElement?db.Bc.parentElement:db.Bc:db.Bc.id.startsWith("overlappedMarker")&&
db.Bc.offsetParent?db.Bc.offsetParent:db.Bc;(Kb=this.Ixb(Kb))?(db.ctrlKey?this.wk.bzj(Kb,this.jc.mg(this.ua)):(this.wk.fOb(!1),this.wk.bka(),this.wk.fOb(!0),this.wk.DSd(Kb,this.jc.mg(this.ua))),this.xa.raiseEvent("OnMarkerClick",db),this.Fa.Bd()):bd.a.J(509682566,800,10,"AnimationMarkerView: failed to parse the animation properties.")}};this.em=()=>{this.yb&&(this.dRb(),this.yb.em())};this.dRb=()=>{if(this.ua&&this.kh){var db=this.ua.Jn.points;db=hk.bsa(db,this.Tyb());this.kh.Jt(db)}};this.Tyb=()=>
{let db=Ne.a.dNb;this.ua.Wf||!this.ua.hva&&!this.ua.rl||(db+=6);return db};this.Mp=()=>{this.yb&&this.ric!==this.od&&this.Rjb();return null};this.vq=()=>{};this.Eu=()=>{};this.Ij=db=>{this.ric=this.od;this.od=db};this.setZIndex=db=>{this.yb&&this.yb.jC(db)};this.draw=()=>{this.Rjb()};this.Rjb=()=>{this.nb&&this.OO&&this.Ab&&!this.xA&&(this.FRa(),this.RRd());this.setVisibility()};this.BD=db=>{if(!this.xa||!db)return!1;this.xa.raiseEvent("OnSelectionAreaHover",db);db.eventName===Wb.a.qq?this.P1(db.Bc,
"animMarkerHovered",1):db.eventName===Wb.a.Vs&&this.P1(db.Bc,"animMarkerHovered",2);return!0};this.nsc=(db,Kb)=>{db?Kb?(this.P1(db,"animMarkerUnselected",2),this.P1(db,"animMarkerSelected",1)):(this.P1(db,"animMarkerSelected",2),this.P1(db,"animMarkerUnselected",1)):bd.a.J(509682565,800,10,"AnimationMarkerView:selectMarker domElement is null")};this.P1=(db,Kb,lc)=>{const Jc=this.EYc(db);switch(lc){case 0:db.setAttribute(Ni.a.x8,Kb);Jc&&db.lastChild.setAttribute(Ni.a.x8,Kb);break;case 1:Sys.UI.DomElement.addCssClass(db,
Kb);Jc&&Sys.UI.DomElement.addCssClass(db.lastChild,Kb);break;case 2:Sys.UI.DomElement.removeCssClass(db,Kb),Jc&&Sys.UI.DomElement.removeCssClass(db.lastChild,Kb)}};this.EYc=db=>!!db&&!!db.lastChild&&!!db.lastChild.id&&"overlappedMarker"===db.lastChild.id;this.setPosition=()=>{};this.JD=db=>{this.xA=db;this.xA||(this.ds(),this.Waa(!0));this.setVisibility()};this.aD=()=>null;this.Xw=()=>{};this.QA=()=>[];this.my=()=>{};this.iC=()=>{};this.ds=()=>{!this.Rk&&this.OO&&(this.cNa(!0),this.cNa(!1))};this.QOc=
()=>{const db=new Rj.a;db.ah(10,10);db.va.setAttribute(Ni.a.x8,"pointer-events-none");db.xpa("0 0 2048 2048");const Kb=new Ck.a;Kb.QY("M 421 1984 l 422 -896 h -478 l 569 -1024 h 599 l -499 640 h 621 l -1077 1280 M 1165 640 h 627 l -1184 1408 h -288 l 422 -896 h -486 l 640 -1152 h 768 m -1116 1920 l 969 -1152 h -614 l 499 -640 h -431 l -498 896 h 471 l -422 896");Kb.eF("#E67E22");Kb.dv("#FFFF00");Kb.ur(5);db.appendChild(Kb);return db.va};if(!A)throw Error.argumentNull("shapeNode");if(!W)throw Error.argumentNull("slideReader");
if(!na)throw Error.argumentNull("traverserFactory");if(!Ga)throw Error.argumentNull("paragraphReader");if(!Qb)throw Error.argumentNull("activeSlideViewManager");if(!t)throw Error.argumentNull("mouseInputManager");if(!Y)throw Error.argumentNull("clickInputManager");if(!pa)throw Error.argumentNull("focusManagers");if(!kc)throw Error.argumentNull("effectSelectionManager");if(!Ya)throw Error.argumentNull("pptUnitConversion");this.ua=A;this.jc=W;this.Yl=na;this.Gh=Ga;this.Iz=qb;this.IGe=Ka;this.OO=Qb.Jc?
Qb.Jc.PJc:null;this.QFe=Qb.Jc?Qb.Jc.puc:null;this.$f=t;this.Rc=Y;this.Fa=pa;this.wb=Ja;this.i$=jb;this.lwe=Sb;this.wi=Ya;this.wk=kc}dispose(){this.Rk||(this.i$(),this.Rk=!0,this.Ab=!1,this.FRa(),this.Rc&&this.$m&&this.Rc.Bb(Wb.a.click,this.$m.va,this.jYc),this.$f&&this.$m&&(this.$f.Bb(Wb.a.qq,this.$m.va,this.BD),this.$f.Bb(Wb.a.Vs,this.$m.va,this.BD),this.$f.Bb(Wb.a.YJ,this.$m.va,this.BUa),this.$f.Bb(Wb.a.mouseDown,this.$m.va,this.BUa)),this.$m=null,this.Rc&&this.an&&this.Rc.Bb(Wb.a.click,this.an.va,
this.jYc),this.$f&&this.an&&(this.$f.Bb(Wb.a.qq,this.an.va,this.BD),this.$f.Bb(Wb.a.Vs,this.an.va,this.BD),this.$f.Bb(Wb.a.YJ,this.an.va,this.BUa),this.$f.Bb(Wb.a.mouseDown,this.an.va,this.BUa)),this.Fa=this.Gh=this.ua=this.Yl=this.jc=this.wi=this.wk=this.yb=this.kh=this.OO=this.nb=this.an=null)}get visible(){return this.Ab}set visible(A){this.Ab=A}get gC(){return this.yb}get uq(){return this.kh}get we(){return this.nb}$ce(){return this.getClientRects(this.QFe)}getClientRects(A){let W,na;W=na=0;if(!A)return bd.a.J(509682572,
800,10,"AnimationMarkerView: element is null for GetClientRects."),{returnValue:!1,left:W,top:na};A=A.getClientRects();if(!A||!A.length||!A[0])return bd.a.J(509682571,800,10,"AnimationMarkerView: cannot get boundingRects."),{returnValue:!1,left:W,top:na};na=Math.round(A[0].top);W=Math.round(A[0].left);return{returnValue:!0,left:W,top:na}}s7d(A){let W,na;W=na=0;if(!A||!A.length||!A[0])return bd.a.J(509682568,800,50,"AnimationMarkerView: boundingRects is nulll or empty."),{returnValue:!1,top:W,bottom:na};
W=A[0].top;na=A[0].bottom;for(let Ga=1;Ga<A.length&&A[Ga];Ga++)W=A[Ga].top>W?W:A[Ga].top,na=A[Ga].bottom<na?na:A[Ga].bottom;return{returnValue:!0,top:W,bottom:na}}rVf(A,W,na,Ga){if(!this.F9()||!A||!A.length)return 0;const Ka=Ga?this.an.va:this.$m.va;na=(na=Math.floor(this.wi.om(na)/21))?na:1;let qb=0,Qb=null,t=null,Y=!0,pa=!1;for(let jb=0;jb<A.length;jb++){const Sb=A[jb];var Ja=new ph.a;Ja.va.id=Ne.a.D7a+Sb.ClickOrder;Ja.ah(20,16);Ja.Zj(1);if(Sb.IsTrigger){var Ya=this.QOc();Ja.va.appendChild(Ya)}else Ja.va.innerText=
Sb.ClickOrder.toString();let kc=Ya=!1;jb<na?(Ga&&(Ja.va.style.position=Ni.a.absolute,Ja.va.style.top=kj.a.Pc(this.wi.om(W)+21*qb)),pa=this.wk.J2b(Sb.EffectNodeId),Ja.va.setAttribute(Ni.a.x8,pa?"animMarkerSelected":"animMarkerUnselected"),Ka.appendChild(Ja.va),qb++):jb===na?(Y=Y&&Sb.EffectId===Qb.EffectId,Ya=!0,kc=Qb.IsTrigger):Y=Y&&Sb.EffectId===Qb.EffectId;Ya&&t.va.appendChild(this.aLc(kc,Y,pa));Qb=Sb;t||(t=Ja);Ga?(Ja=[],(Ya=this.Ixb(t.va))&&Ja.push(...Ya),Ja.push(Sb.EffectNodeId),t.va.setAttribute("AnimProps",
Ja.join(" "))):Ja.va.setAttribute("AnimProps",Sb.EffectNodeId)}this.sK();return qb}R4b(A,W,na,Ga){var Ka;if(!this.F9()||!A||!A.length)return 0;const qb=Ga?this.an.va:this.$m.va;na=(na=Math.floor(this.wi.om(na)/21))?na:1;let Qb=0,t=null,Y=new ph.a,pa=!0;var Ja=!1;let Ya=!1;for(let db=0;db<A.length;db++){var jb=A[db],Sb=new ph.a;Sb.va.id=Ne.a.D7a+jb.ClickOrder;Sb.ah(20,16);Sb.Zj(1);if(jb.IsTrigger){var kc=this.QOc();Sb.va.appendChild(kc)}else Sb.va.innerText=jb.ClickOrder.toString();db<na?(Ga&&(Sb.va.style.position=
Ni.a.absolute,Sb.va.style.top=kj.a.Pc(this.wi.om(W)+21*Qb)),Sb.va.setAttribute("AnimProps",jb.EffectNodeId),Ja=this.wk.J2b(jb.EffectNodeId),Sb.va.setAttribute(Ni.a.x8,Ja?"animMarkerSelected":"animMarkerUnselected"),qb.appendChild(Sb.va),Qb++):db===na&&Y.va?(pa=pa&&jb.EffectId===t.EffectId,Ya=!0,kc=t.IsTrigger,Ya&&Y.va.appendChild(this.aLc(kc,pa,Ja))):pa=pa&&jb.EffectId===t.EffectId;Ya?(Ja=[],(Sb=this.Ixb(Y.va))&&Ja.push(...Sb),Ja.push(jb.EffectNodeId),Y.va.setAttribute("AnimProps",Ja.join(" ")),Ja=
this.wk.J2b(jb.EffectNodeId),Y.va.setAttribute(Ni.a.x8,Ja?"animMarkerSelected":"animMarkerUnselected"),(jb=Y.va.lastElementChild)&&(null===(Ka=null===jb||void 0===jb?void 0:jb.id)||void 0===Ka?0:Ka.startsWith("overlappedMarker"))&&jb.setAttribute(Ni.a.x8,"overlappedMarker "+(Ja?"animMarkerSelected":"animMarkerUnselected"))):(Y=Sb,t=jb)}this.sK();return Qb}aLc(A,W,na){const Ga=new ph.a;Ga.va.id="overlappedMarker";Rg.a("FixOverlappedAnimationMarkers")?Ga.va.style.marginTop="-13px":Ga.va.style.marginTop=
A?"3px":"-13px";Ga.va.setAttribute(Ni.a.x8,"overlappedMarker "+(na?"animMarkerSelected":"animMarkerUnselected"));W&&this.P1(Ga.va,"SameEffectOverlapped",1);return Ga.va}hbe(A){let W,na;W=na=0;if(!this.ua)return{returnValue:!1,x:W,y:na};var Ga=Object(z.a)(119,this.ua.qc(this.Iz));if(!Ga)return{returnValue:!1,x:W,y:na};Ga=Ga.ys();if(!Ga)return{returnValue:!1,x:W,y:na};W=A?Ga.ic-(this.$hc?61:35):Ga.ic-20-15;na=Ga.kc;return{returnValue:!0,x:W,y:na}}}hk.bsa=(A,W)=>[new kk.a(A[0]._x-W,A[0]._y-W),new kk.a(A[1]._x+
W,A[1]._y-W),new kk.a(A[2]._x+W,A[2]._y+W),new kk.a(A[3]._x-W,A[3]._y+W)];Object(h.a)(hk,"AnimationMarkerView",null,[597,239,240,107]);class Bl{constructor(A,W,na,Ga,Ka,qb,Qb,t,Y,pa,Ja,Ya,jb,Sb){this.f$c=this.PGb=this.Rk=this.Ab=!1;this.hXa=this.Bec=-1;this.$hc=this.xA=!1;this.xa=new ch.a;this.ric=this.od=1;this.an=this.$m=this.kh=this.yb=this.nb=null;this.ua=A;this.jc=W;this.Yl=na;this.Gh=Ga;this.Iz=qb;this.IGe=Ka;this.OO=Qb.Jc?Qb.Jc.PJc:null;this.QFe=Qb.Jc?Qb.Jc.puc:null;this.$f=t;this.Rc=Y;this.Fa=
pa;this.wb=Ja;this.i$=jb;this.lwe=Sb;this.wi=Ya}dispose(){this.Rk||(this.i$(),this.Rk=!0,this.Ab=!1,this.Q1b(),this.FRa(),this.$f&&this.$m&&(this.$f.Bb(Wb.a.qq,this.$m.va,Object(n.a)(this,this.BD,"onSelectionAreaHover")),this.$f.Bb(Wb.a.Vs,this.$m.va,Object(n.a)(this,this.BD,"onSelectionAreaHover"))),this.$m=null,this.$f&&this.an&&(this.$f.Bb(Wb.a.qq,this.an.va,Object(n.a)(this,this.BD,"onSelectionAreaHover")),this.$f.Bb(Wb.a.Vs,this.an.va,Object(n.a)(this,this.BD,"onSelectionAreaHover"))),this.yb=
this.kh=this.OO=this.nb=this.an=null)}get visible(){return this.Ab}set visible(A){this.Ab=A}get gC(){return this.yb}get uq(){return this.kh}get we(){return this.nb}xm(A){A&&this.OO?(this.nb=new ph.a,this.nb.Dr("AnimationMarkerView"),this.OO.appendChild(this.nb.va),this.yb=new Jk.a,this.yb.Zj(0),this.nb.appendChild(this.yb.viewport),this.kh=new Ck.a,this.kh.Zj(1),this.kh.setVisibility(!1),this.yb.appendChild(this.kh),this.$m=new ph.a,this.$m.Dr("ShapeAnimationMarkerContainer"),this.$m.va.id=this.ua.id.toString(),
this.$m.ah(20,this.nb.va.clientHeight),this.$m.Zj(1),this.nb.appendChild(this.$m),this.an=new ph.a,this.an.Dr("TextAnimationMarkerContainer"),this.an.va.id=this.ua.id.toString(),this.an.ah(20,this.nb.va.clientHeight),this.an.Zj(1),this.nb.appendChild(this.an),this.$f.rb(Wb.a.qq,this.$m.va,Object(n.a)(this,this.BD,"onSelectionAreaHover")),this.$f.rb(Wb.a.Vs,this.$m.va,Object(n.a)(this,this.BD,"onSelectionAreaHover")),this.$f.rb(Wb.a.qq,this.an.va,Object(n.a)(this,this.BD,"onSelectionAreaHover")),this.$f.rb(Wb.a.Vs,
this.an.va,Object(n.a)(this,this.BD,"onSelectionAreaHover")),this.setVisibility()):bd.a.J(509682564,800,10,"AnimationMarkerView: {0} is null",A?"m_markerViewParentElement":"parent")}KL(A){let W=!1;A&&A.Bc.id.startsWith(Ne.a.D7a)||A.Bc.id.startsWith("overlappedMarker")?(this.uMe(A),W=!0):(this.Q1b(),this.Waa(!0));return W}setSelection(A){if(A&&!this.f$c||!A)this.Waa(A),this.Q1b()}setVisibility(){let A=this.Ab&&!this.xA;this.ua&&this.ua.isHiddenShape&&(A=!1);this.nb&&this.nb.Sd(A);this.$m&&this.$m.Sd(A);
this.an&&this.an.Sd(A)}Waa(A){if(this.F9()){this.PGb=A;A=[this.$m.va.childNodes,this.an.va.childNodes];for(const W of A)for(A=0;W&&A<W.length;A++)this.nsc(W[A],this.PGb)}}Ixb(A){if(!A||!this.ua)return null;A=A.getAttribute("AnimProps");if(!A||!A.toString()||!A.toString().trim().length)return null;A=A.toString().split(" ");if(!A||4!==A.length)return null;const W=[];for(const na of A){if(!na||!na.trim().length)return null;W.push(Number.parseInvariant(na.trim()))}return W}F9(){const A=!!this.ua&&!!this.OO&&
!!this.$m&&!!this.an;A||bd.a.J(509682563,800,10,"AnimationMarkerView: the containers are not exist.");return A}FRa(){this.Fja(!0);this.Fja(!1)}Fja(A){if(this.$f&&this.Rc&&this.F9()&&(A=A?this.an.va:this.$m.va)&&A.childNodes&&0<A.childNodes.length){const W=A.childNodes;for(const na=0;na<W.length;)A.removeChild(W[na])}}RRd(){if(this.F9()){var A=this.O3f(this.ua);if(A&&A.length){var W=!1,na=!1,Ga=[];for(const Ka of A)Ka.IsTextRangeType?na=!0:(W=!0,Ga.push(Ka));this.$hc=W&&na;this.cNa(!0);this.cNa(!1);
this.Fja(!1);0<Ga.length&&(bd.a.J(509682562,800,50,"AnimationMarkerView: draw shape animation markers."),this.R4b(Ga,this.wi.YH(this.ua.Jn.kc,this.od),this.wi.YH(this.ua.Jn.Zb-this.ua.Jn.kc,this.od),!1,-1)||bd.a.J(509682561,800,10,"AnimationMarkerView: no shape marker is rendered"));na?this.I5d():this.Fja(!0);if(!na&&-1!==this.hXa||-1!==this.hXa&&-1===this.hXa&&!W)this.bZd(),this.Waa(!0)}else this.FRa()}}I5d(){const A=new be.a(2,1,0,Object(n.a)(this,this.ensureTextIsRenderedAndDrawMarkers,"ensureTextIsRenderedAndDrawMarkers"),
90,"26");this.wb.Hb(A)}ensureTextIsRenderedAndDrawMarkers(){this.Rk||(this.lwe(),this.S4b())}S4b(){this.Fja(!0);if(this.dge(this.ua)){var A=this.Sce();if(A&&A.length){var W;if(({top:W}=this.$ce()).returnValue){var na=0;bd.a.J(509682530,800,50,"AnimationMarkerView: draw paragraph animation markers.");for(let Ka=0;Ka<A.length;Ka++){var Ga=this.jc.mg(this.ua);if(!Ga)return;(Ga=Ga.zWc(this.ua,Ka))&&0<Ga.length&&A[Ka]&&(na+=this.R4b(Ga,A[Ka].top-W,A[Ka].height,!0,Ka))}na||bd.a.J(509682529,800,10,"AnimationMarkerView: no paragraph marker is rendered.")}else bd.a.J(509682531,
800,50,"AnimationMarkerView: GetSlideContentClientRects failed.")}else bd.a.J(509682560,800,50,"AnimationMarkerView: the paragrph view is not rendered")}}Sce(){const A=[];var W=Yj.GraphIterator.pb(this.ua);W=this.Yl.A3(W,W.currentNode);for(var na;W.moveNext();)(na=W.currentNode)&&this.Gh.ae(na)&&na&&(na=na.qc(this.Iz))&&na.htmlElement&&(na=this.gua(na.htmlElement))&&na.height&&A.push(na);return A}$ce(){return this.getClientRects(this.QFe)}getClientRects(A){let W,na;W=na=0;if(!A)return bd.a.J(509682528,
800,10,"AnimationMarkerView: element is null for GetClientRects."),{returnValue:!1,left:W,top:na};A=A.getClientRects();if(!A||!A.length||!A[0])return bd.a.J(509682527,800,50,"AnimationMarkerView: cannot get boundingRects."),{returnValue:!1,left:W,top:na};na=Math.round(A[0].top);W=Math.round(A[0].left);return{returnValue:!0,left:W,top:na}}gua(A){if(!A)return bd.a.J(509682526,800,10,"AnimationMarkerView: paragraph is null"),null;A=A.querySelectorAll(".TextRun");if(!A||!A.length)return null;let W=0,
na=0;let Ga,Ka=!1;for(let Qb=0;Qb<A.length&&A[Qb];Qb++){var qb=A[Qb].getClientRects();({top:qb,bottom:Ga}=this.s7d(qb)).returnValue&&(Qb?(W=W>qb?qb:W,na=na<Ga?Ga:na):(W=qb,na=Ga),Ka=!0)}if(Ka)return new Vi(na-W,W);bd.a.J(509682525,800,50,"AnimationMarkerView: search failed in GetParagraphProperties.");return null}s7d(A){let W,na;W=na=0;if(!A||!A.length||!A[0])return bd.a.J(509682524,800,50,"AnimationMarkerView: boundingRects is nulll or empty."),{returnValue:!1,top:W,bottom:na};W=A[0].top;na=A[0].bottom;
for(let Ga=1;Ga<A.length&&A[Ga];Ga++)W=A[Ga].top>W?W:A[Ga].top,na=A[Ga].bottom<na?na:A[Ga].bottom;return{returnValue:!0,top:W,bottom:na}}R4b(A,W,na,Ga,Ka){if(!this.F9()||!A||!A.length)return 0;const qb=Ga?this.an.va:this.$m.va;na=(na=Math.floor(this.wi.om(na)/21))?na:1;let Qb=0,t=null,Y=new ph.a,pa=!1,Ja=!1;const Ya=Ka===this.hXa&&A.length<this.Bec+1;for(let Sb=0;Sb<A.length;Sb++){const kc=A[Sb],db=new ph.a;db.va.id=Ne.a.D7a+kc.BuildId;db.ah(20,16);db.Zj(1);if(kc.IsTrigger){var jb=this.QOc();db.va.appendChild(jb)}else db.va.innerText=
kc.BuildId.toString();let Kb=jb=!1;Sb<na?(Ga&&(db.va.style.position=Ni.a.absolute,db.va.style.top=kj.a.Pc(this.wi.om(W)+21*Qb)),db.va.setAttribute("AnimProps",String.format("{0} {1} {2} {3}",Sb,Ka,kc.BuildId,kc.EffectId)),Ja=this.PGb||Ya&&A.length-1===Sb||this.f$c&&this.Bec===Sb&&this.hXa===Ka,db.va.setAttribute(Ni.a.x8,Ja?"animMarkerSelected":"animMarkerUnselected"),qb.appendChild(db.va),Qb++):Sb===na&&Y.va?(pa=pa&&kc.EffectId===t.EffectId,jb=!0,Kb=t.IsTrigger):pa=pa&&kc.EffectId===t.EffectId;jb&&
Y.va.appendChild(this.aLc(Kb,pa,Ja));Y=db;t=kc}this.sK();return Qb}aLc(A,W,na){const Ga=new ph.a;Ga.va.id="overlappedMarker";Ga.va.style.marginTop=A?"3px":"-13px";Ga.va.setAttribute(Ni.a.x8,"overlappedMarker "+(na?"animMarkerSelected":"animMarkerUnselected"));W&&this.P1(Ga.va,"SameEffectOverlapped",1);return Ga.va}sK(){this.IGe(this.nb.va,!0)}O3f(A){if(!A)return null;const W=this.jc.mg(A);return W?W.rUa(A):null}dge(A){A=this.O3f(A);if(!A||!A.length)return!1;for(const W of A)if(W.IsTextRangeType)return!0;
return!1}cNa(A){if(this.F9()){var W=A?this.$m.va:this.an.va,na,Ga;W&&({x:na,y:Ga}=this.hbe(A)).returnValue&&(W.style.position=Ni.a.absolute,W.style.left=kj.a.Pc(na),W.style.zIndex="20000",A?W.style.top=kj.a.Pc(Ga):this.S4b())}}hbe(A){let W,na;W=na=0;if(!this.ua)return{returnValue:!1,x:W,y:na};var Ga=Object(z.a)(119,this.ua.qc(this.Iz));if(!Ga)return{returnValue:!1,x:W,y:na};Ga=Ga.ys();if(!Ga)return{returnValue:!1,x:W,y:na};W=A?Ga.ic-(this.$hc?61:35):Ga.ic-20-15;na=Ga.kc;return{returnValue:!0,x:W,
y:na}}uMe(A){if(this.xa&&A&&this.Fa&&A.Bc){var W=A.Bc.id.startsWith("overlappedMarker")&&A.Bc.offsetParent?A.Bc.offsetParent:A.Bc;this.Ljl(W);this.EYc(W)&&!this.r2j(W)&&this.bZd();this.Waa(!1);this.nsc(W,!0);this.xa.raiseEvent("OnMarkerClick",A);this.Fa.Bd()}}Q1b(){this.f$c=!1;this.hXa=this.Bec=-1;this.bZd()}Ljl(A){(A=this.Ixb(A))?(this.f$c=!0,this.Bec=A[0],this.hXa=A[1],this.ua.Wya=this.Bec,this.ua.zLa=this.hXa):bd.a.J(509682523,800,10,"AnimationMarkerView: failed to parse the animation properties.")}bZd(){this.ua&&
(this.ua.Wya=-1,this.ua.zLa=-1)}em(){this.yb&&(this.dRb(),this.yb.em())}dRb(){if(this.ua&&this.kh){var A=this.ua.Jn.points;A=Bl.bsa(A,this.Tyb());this.kh.Jt(A)}}Tyb(){let A=Ne.a.dNb;this.ua.Wf||!this.ua.hva&&!this.ua.rl||(A+=6);return A}Mp(){this.yb&&this.ric!==this.od&&this.Rjb();return null}vq(){}Eu(){}Ij(A){this.ric=this.od;this.od=A}setZIndex(A){this.yb&&this.yb.jC(A)}draw(){this.Rjb()}Rjb(){this.nb&&this.OO&&this.Ab&&!this.xA&&this.RRd();this.setVisibility()}BD(A){if(!this.xa||!A)return!1;this.xa.raiseEvent("OnSelectionAreaHover",
A);A.eventName===Wb.a.qq?this.P1(A.Bc,"animMarkerHovered",1):A.eventName===Wb.a.Vs&&this.P1(A.Bc,"animMarkerHovered",2);return!0}nsc(A,W){A&&(W?(this.P1(A,"animMarkerUnselected",2),this.P1(A,"animMarkerSelected",1)):(this.P1(A,"animMarkerSelected",2),this.P1(A,"animMarkerUnselected",1)))}P1(A,W,na){const Ga=this.EYc(A);switch(na){case 0:A.setAttribute(Ni.a.x8,W);Ga&&A.lastChild.setAttribute(Ni.a.x8,W);break;case 1:Sys.UI.DomElement.addCssClass(A,W);Ga&&Sys.UI.DomElement.addCssClass(A.lastChild,W);
break;case 2:Sys.UI.DomElement.removeCssClass(A,W),Ga&&Sys.UI.DomElement.removeCssClass(A.lastChild,W)}}EYc(A){return!!A&&!!A.lastChild&&!!A.lastChild.id&&"overlappedMarker"===A.lastChild.id}r2j(A){return!!A&&!!A.lastChild&&!!A.lastChild.id&&0<=A.lastChild.className.indexOf("SameEffectOverlapped")}setPosition(){}JD(A){(this.xA=A)?this.Q1b():(this.ds(),this.Waa(!0));this.setVisibility()}aD(){return null}Xw(){}QA(){return[]}my(){}iC(){}ds(){!this.Rk&&this.OO&&(this.cNa(!0),this.cNa(!1))}QOc(){const A=
new Rj.a;A.ah(10,10);A.va.setAttribute(Ni.a.x8,"pointer-events-none");A.xpa("0 0 2048 2048");const W=new Ck.a;W.QY("M 421 1984 l 422 -896 h -478 l 569 -1024 h 599 l -499 640 h 621 l -1077 1280 M 1165 640 h 627 l -1184 1408 h -288 l 422 -896 h -486 l 640 -1152 h 768 m -1116 1920 l 969 -1152 h -614 l 499 -640 h -431 l -498 896 h 471 l -422 896");W.eF("#E67E22");W.dv("#FFFF00");W.ur(5);A.appendChild(W);return A.va}static bsa(A,W){return[new kk.a(A[0]._x-W,A[0]._y-W),new kk.a(A[1]._x+W,A[1]._y-W),new kk.a(A[2]._x+
W,A[2]._y+W),new kk.a(A[3]._x-W,A[3]._y+W)]}}Object(h.a)(Bl,"AnimationMarkerViewLegacy",null,[596,239,240,107]);var ie=d(342),df=d(1279),uj=d(192);class Xl{constructor(A,W,na,Ga,Ka,qb,Qb){this.VGb=this.sO=!1;this.Dy=[];this.mdd=new Set;this.qhc=!0;if(!A)throw Error.argumentNull("actionManager");if(!W)throw Error.argumentNull("graphTopologyManager");if(!na)throw Error.argumentNull("slideReader");if(!Ga)throw Error.argumentNull("viewEventNotifier");if(!Ka)throw Error.argumentNull("animationMarkerViewManager");
if(!qb)throw Error.argumentNull("activeSlideViewManager");if(!Qb)throw Error.argumentNull("selectionManager");this.ia=A;this.ta=W;this.jc=na;this.xdb=Ka;this.le=Ga;this.Iw=this.ta.Ba;this.Kc=qb;this.pa=Qb;this.O9c=Rg.a("FixAnimationRibbonCrashIssue")}initialize(){}dispose(){this.ia=this.mdd=this.Dy=this.Iw=this.jc=this.pa=this.le=null}fOb(A){this.qhc=A}GOh(){if(!this.O9c||this.Iw){var A=this.pa.Xd();this.x8a();var W=this.Iw.Uj(),na=new Set;if(this.O9c){if(!W)return;if(A)for(const Ga of A)na.add(Ga.id)}else for(const Ga of A)na.add(Ga.id);
for(const Ga of W)na.has(Ga.id)?this.qyf(Ga):this.goh(Ga)}}cQl(){this.ZKa(this.sO);this.hQl();this.le.Py(new uj.a(7))}bzj(A,W){if(W&&A&&A.length){var na=this.J2b(A[0]);this.qhc=!1;na?(W=this.Dy.filter(Ga=>!A.includes(Ga.EffectNodeId)),this.x8a(),this.bka(),this.ESd(W)):(W=this.jc.P3f(A,W),this.eSd(W),W=Object.assign([],this.Dy),this.x8a(),this.bka(),this.ESd(W));this.qhc=!0;this.ia.Ka(fd.a.Vxd,df.a.execute,null)}}bka(){const A=this.pa.Xd();this.pa.bka(A)}DSd(A,W){W&&A&&(this.x8a(),A=this.jc.P3f(A,
W),this.ESd(A),Rg.a("FixRedundantSelectionChange")?this.qhc&&this.ia.Ka(fd.a.Vxd,df.a.execute,null):this.ia.Ka(fd.a.Vxd,df.a.execute,null))}J2b(A){return this.mdd.has(A)}dQl(A){if(this.sO=!!A&&0<=A.indexOf("Animation"))this.VGb=!0;this.ZKa(this.sO);this.sO?(this.GOh(),this.le.Py(new uj.a(7))):this.x8a()}eQl(A){this.Iw=A;this.x8a();this.ZKa(this.sO)}hQl(){if(!this.O9c||this.Iw){var A=this.pa.Xd();this.x8a();var W=this.Iw.Uj();if(W&&W.length)if(A&&A.length){var na=new Set;for(const Ga of A)na.add(Ga.id);
for(const Ga of W)na.has(Ga.id)?this.qyf(Ga):this.goh(Ga)}else A=this.Iw.cUc(W),A.length&&(A=A.filter(Ga=>Ga.IsModifiedPreviously).map(Ga=>Ga.EffectNodeId),this.DSd(A,this.Iw))}}ESd(A){if(A&&this.Iw){this.eSd(A);var W=this.Iw.Uj();if(W&&W.length){A=new Map;for(var na of this.Dy){var Ga=vf.a.Jf(na.ShapeId);if(!Ga){bd.a.J(509620887,800,10,"EffectSelectionManager::addSelectedEffectHelper:  shape guid is null");return}Ga=Ga.toString();A.has(Ga)||A.set(Ga,new Set);Ga=A.get(Ga);null===Ga||void 0===Ga?void 0:
Ga.add(na.EffectNodeId)}for(const Ka of W)if(na=this.xdb.ZI(Ka))na.Waa(!1),W=Ka.id.toString(),(W=A.has(W)?A.get(W):null)&&W.size&&na.Agl(Array.from(W));this.le.Py(new uj.a(7))}}}qyf(A){if(A){var W=this.jc.mg(A);W&&(W=W.myb(A),this.eSd(W),A=this.xdb.ZI(A),this.O9c&&!A||A.Waa(!0))}}goh(A){A&&(A=this.xdb.ZI(A))&&A.Waa(!1)}eSd(A){if(A&&A.length)for(const W of A)this.J2b(W.EffectNodeId)||(this.Dy.push(W),this.mdd.add(W.EffectNodeId))}ZKa(A){if(this.VGb&&this.Iw&&this.Iw.nO&&this.Kc.Jc&&this.Kc.Jc.PJc){var W=
this.Iw.Uj();if(W&&W.length)for(const na of W)if(W=this.xdb.ZI(na))W.visible=A,W.Rjb()}}x8a(){this.mdd.clear();this.Dy.length=0}}Object(h.a)(Xl,"EffectSelectionManager",null,[594,107]);class Sj{constructor(){this.K=null;this.zEb=!1}get name(){return"PowerPointWebEditor.Animations"}Yb(A){this.K=A;(this.zEb=this.K.resolve("PowerPointWebEditor.IApplicationContext").rd.atb)?(this.K.register(191,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerView>").ma().oa(()=>
new ie.a((W,na)=>{let Ga=null;const Ka=Object(z.a)(119,W.qc(this.K.resolve("Box4.IPageView").Na));Ka&&!Ka.Nl&&Ka.va&&(Ga=new hk(W,this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.IParagraphReader"),Object(n.a)(Ka,Ka.sK,"takeOwnershipOfSubtree"),this.K.resolve("Box4.IPageView").Na,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("Common.MouseInputManager"),this.K.resolve("Common.IClickInputManager"),
this.K.resolve("PowerPointWebEditor.IFocusManager"),M.AFrameworkApplication.Ae,this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),na,()=>{Ka.hEa()},this.K.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager")),Ga.xm(Ka.va),Ga.setZIndex(4),Ga.visible=!1,Ka.sK(Ga.we.va,!0),Ka.Yra(Ga,4));return Ga})),this.K.register(Xl,"PowerPointWebEditor.Animations.IEffectSelectionManager").ma().oa(()=>new Xl(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerView>"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager")))):(this.K.register(191,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerViewLegacy>").ma().oa(()=>
new ie.a((W,na)=>{let Ga=null;const Ka=Object(z.a)(119,W.qc(this.K.resolve("Box4.IPageView").Na));Ka&&!Ka.Nl&&Ka.va&&(Ga=new Bl(W,this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.IParagraphReader"),Object(n.a)(Ka,Ka.sK,"takeOwnershipOfSubtree"),this.K.resolve("Box4.IPageView").Na,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("Common.MouseInputManager"),this.K.resolve("Common.IClickInputManager"),
this.K.resolve("PowerPointWebEditor.IFocusManager"),M.AFrameworkApplication.Ae,this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),na,()=>{Ka.hEa()}),Ga.xm(Ka.va),Ga.setZIndex(4),Ga.visible=!1,Ka.sK(Ga.we.va,!0),Ka.Yra(Ga,4));return Ga})),this.K.register(Zh,"PowerPointWebEditor.Animations.AnimationMarkerManagerLegacy").ma().oa(()=>new Zh(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("Box4.Graph.IGraphInstance").yd(8),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerViewLegacy>"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"))))}init(){this.zEb?this.K.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager").initialize():this.K.resolve("PowerPointWebEditor.Animations.AnimationMarkerManagerLegacy").initialize()}dispose(){this.zEb?
this.K.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager").dispose():this.K.resolve("PowerPointWebEditor.Animations.AnimationMarkerManagerLegacy").dispose()}static main(){Ia.a.instance.Ac(qd.a(new Sj,0))}}Object(h.a)(Sj,"PPTWebEditorAnimationsPackage",null,[2,3]);var bk=d(1073),Ii=d(125);class Kk{constructor(A,W,na,Ga){this.ia=A;this.Fa=W;this.$ye=na;this.oc=Ga}vb(){this.ia.ya(fd.a.find,Lc.a.view,Object(n.a)(this,this.findText,"findText"));this.ia.ya(fd.a.find,Lc.a.notes,Object(n.a)(this,
this.findText,"findText"));this.ia.ya(fd.a.find,Lc.a.Mf,Object(n.a)(this,this.findText,"findText"));this.ia.ya(sa.a.findInDocument,Lc.a.view,Object(n.a)(this,this.findInDocument,"findInDocument"));this.ia.he(fd.a.find,0);this.ia.ya(fd.a.C1,Lc.a.view,Object(n.a)(this,this.C1,"replaceText"));this.ia.ya(fd.a.C1,Lc.a.notes,Object(n.a)(this,this.C1,"replaceText"));this.ia.ya(fd.a.C1,Lc.a.Mf,Object(n.a)(this,this.C1,"replaceText"));this.ia.he(fd.a.C1,4)}pe(){const A=[this.Fa.Fc(Ii.a.iE),this.Fa.Fc(Ii.a.o3),
this.Fa.Fc(lf.a.vg),this.Fa.Fc(lf.a.vQ)];for(const W of A)W.bindAction(wc.KeyInputManager.Qa(nd.a.fqa,wc.KeyInputManager.Re),fd.a.find),W.bindAction(wc.KeyInputManager.Qa(nd.a.Snb,wc.KeyInputManager.Re),fd.a.C1)}findText(A,W,na){return W.contextId!==Lc.a.view&&W.contextId!==Lc.a.notes&&W.contextId!==Lc.a.Mf?2:1===na?this.oc.Cj()?32:8:2===na?(this.$ye.MEh(W),bd.a.J(539773087,820,50,"FindTextDialog is initialized."),32):8}C1(A,W,na){return W.contextId!==Lc.a.view&&W.contextId!==Lc.a.notes&&W.contextId!==
Lc.a.Mf?2:1===na?this.oc.Cj()?32:8:2===na?(this.$ye.ZAl(W),bd.a.J(539773088,820,50,"ReplaceTextDialog is initialized."),32):8}findInDocument(A,W,na,Ga,Ka){if(W.contextId!==Lc.a.view&&W.contextId!==Lc.a.notes&&W.contextId!==Lc.a.Mf)return 2;if(1===na)return 32;if(2===na){if(!Ka)return 8;A=Ka.CommandValueId||"";bd.a.J(539773089,820,50,"Find. ActionData QueryLength: {0}",A.length);this.$ye.HAl(W,A);bd.a.J(539773090,820,50,"FindTextDialog is initialized from Search Box.");return 32}return 8}}Object(h.a)(Kk,
"FindReplaceTextActor",null,[251]);var Ch=d(1282);class fi extends Ch.a{constructor(A,W,na){super(!1,!0);this.Dwe=!1;this.idd=null;this.vFb=!1;this.ECg=this.PDg=null;this.Zye=!0;this.jze=this.kze=this.ize=!1;this.tna=null;this.Bcd=!1;this.REe=!0;this.rZg=this.qBe=!1;this.WWg=this.YWg=null;this.DMg=0;this.Fa=A;this.g$=W;this.Crk="FindReplaceTextDialog";this.kR=ResourceStrings.l_FindTextTitle;na&&(this.kR=ResourceStrings.l_ReplaceTextTitle);this.uBe=na;this.RV=!1}Nga(){this.pj(this.kR,this.g$,this.Y8());
this.Dwe=!1}dispose(){super.dispose();this.Dwe=!0}DUi(){this.ize=this.Zye=!1;this.b7(this.kR,this.g$,this.Y8())}yWf(A){A&&(this.Fa.vf(od.AFrame.U5),this.ize=!0);this.Zye=!0;this.b7(this.kR,this.g$,this.Y8())}Z9b(){this.hide()}Xjl(A){this.idd=A.searchString;this.vFb=A.matchCase;this.tna=A.replaceString}Nl(){return this.Dwe}x1a(A,W){this.ECg=A;this.DMg=W;this.rZg=0===W;this.b7(this.kR,this.g$,this.Y8())}jsd(A){this.PDg=A;this.b7(this.kR,this.g$,this.Y8())}Dsd(A){this.YWg=A;this.b7(this.kR,this.g$,this.Y8())}y_e(A){this.WWg=
A;this.b7(this.kR,this.g$,this.Y8())}get a1a(){return this.idd}set a1a(A){this.idd=A}get matchCase(){return this.vFb}set matchCase(A){this.vFb=A}get gWe(){return this.tna}set gWe(A){this.tna=A}CYi(A){A&&(this.Fa.vf(od.AFrame.U5),this.kze=!0);this.Bcd=!0;this.b7(this.kR,this.g$,this.Y8())}D3d(){this.kze=this.Bcd=!1;this.b7(this.kR,this.g$,this.Y8())}BYi(A){A&&(this.Fa.vf(od.AFrame.U5),this.jze=!0);this.REe=!0;this.b7(this.kR,this.g$,this.Y8())}FUi(){this.jze=this.REe=!1;this.b7(this.kR,this.g$,this.Y8())}$Cl(){this.kR=
ResourceStrings.l_ReplaceTextTitle;this.uBe=!0;this.Bcd=!1;this.b7(this.kR,this.g$,this.Y8());this.Fa.vf(od.AFrame.U5)}AYi(){this.qBe=!0;this.b7(this.kR,this.g$,this.Y8())}ibj(){return{["searchString"]:this.idd,["findNextButtonAriaLabel"]:this.PDg,["errorMessage"]:this.ECg,["findNextButtonIsEnabled"]:this.Zye,["focusFindNextButton"]:this.ize,["focusDialog"]:Object(n.a)(this,this.f7i,"focusDialog"),["isReplaceActive"]:this.uBe,["replaceButtonIsEnabled"]:this.Bcd,["replaceAllButtonIsEnabled"]:this.REe,
["showMessageAsError"]:this.rZg,["messageStatus"]:this.DMg,["focusReplaceButton"]:this.kze,["focusReplaceAllButton"]:this.jze,["replaceButtonAriaLabel"]:this.YWg,["replaceAllButtonAriaLabel"]:this.WWg,["readOnlyModeEnabled"]:this.qBe}}Y8(){return{["id"]:this.Crk,["bodyControls"]:this.ibj(),["isModal"]:!1}}f7i(){this.Fa.vf(od.AFrame.U5)}}Object(h.a)(fi,"ReactFindReplaceTextDialog",Ch.a,[616]);class Lk{constructor(A){this.Fa=A}getInstance(A,W){return new fi(this.Fa.value,A,W)}}Object(h.a)(Lk,"FindReplaceTextDialogFactory",
null,[569]);class $h{constructor(){this.Q6=this.eha=this.paragraphIndex=this.hS=this.slideIndex=0}reset(){this.slideIndex=this.hS=this.paragraphIndex=0;this.eha=this.Q6=-1}clone(){const A=new $h;A.slideIndex=this.slideIndex;A.hS=this.hS;A.paragraphIndex=this.paragraphIndex;A.eha=this.eha;A.Q6=this.Q6;return A}}Object(h.a)($h,"TextPosition",null,[]);class Yl{constructor(){this.aCe=this.T6c=null;this.tP=new $h;this.zm=new $h;this.state=this.vza=0;this.nub=this.Y5d=!1;this.pattern=this.O3b=this.Q3b=
null;this.matchCase=!1;this.reset()}reset(){this.vza=0;this.tP.reset();this.zm.reset();this.state=0;this.nub=this.Y5d=!1;this.aCe=this.iSa=this.O3b=this.Q3b=null}get iSa(){return this.T6c}set iSa(A){if(this.T6c=A)this.aCe=this.T6c}get y7j(){return this.aCe}}Object(h.a)(Yl,"FindContext",null,[]);var Cl=d(53),ol=d(94);class Zk{constructor(){this.ShouldMatchCase=!1}}Object(h.a)(Zk,"MatchTextInfo",null,[]);class lk{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.OldStr=this.NewStr=this.MatchTxtInfo=
null}}Object(h.a)(lk,"ReplaceAllTextInfo",null,[]);var $k=d(983),cj=d(166),fg=d(998),al=d(331);class gi{constructor(A,W,na,Ga,Ka,qb,Qb,t,Y,pa,Ja,Ya,jb,Sb,kc,db,Kb,lc,Jc,Vc,vd,me,mf){this.BIa=this.Im=this.DE=null;this.Cd=new Yl;this.tna=this.lG="";this.Qhc=!1;this.zGb=this.Pfb=0;this.yGb=Date.now();this.Acd=-1;this.Yye=0;this.dcd=-1;this.ia=A;this.Ufc=W;this.Fa=na;this.Vq=Ga;this.oc=Ka;this.Ga=qb;this.jm=Qb;this.twa=t;this.Gb=Y;this.wb=pa;this.Tb=Ja;this.ta=Ya;this.Rb=jb;this.Eb=db;this.le=Sb;this.Pq=
kc;this.BJ=Kb;this.ZIa=lc;this.YLg=Jc;this.ogb=Vc;this.eok=vd;this.yH=mf;this.XWg=me}MEh(A){this.DE=A;this.Im=this.YLg.value.getInstance(Object(n.a)(this,this.q0f,"findReplaceTextDialogResultHandler"),!1);this.lG&&(this.Im.a1a=this.lG,this.dcd=-1);this.Im.Nga();3!=this.ia.mode&&this.Im.AYi();this.cWa()&&this.A3d()}HAl(A,W){this.cWa()||(this.lG=W);this.MEh(A);this.cWa()||(this.Im.a1a=this.lG,this.Im.Nga(),this.m7e(W,!1))}ZAl(A){this.DE=A;this.Im=this.YLg.value.getInstance(Object(n.a)(this,this.q0f,
"findReplaceTextDialogResultHandler"),!0);this.lG&&(this.Im.a1a=this.lG);this.Im.Nga();this.cWa()&&this.A3d()}q0f(A,W){if(W)switch(this.Im.Xjl(W),A){case 1:this.xBk();break;case 2:this.yBk();break;case 3:this.zBk(this.Im.gWe);break;default:this.$ul(),this.clearSelection(),this.Cd.reset(),this.Im.Z9b()}else bd.a.J(512496416,820,10,"Got null control value for findreplace dialog")}jgg(){return this.Cd.Q3b&&this.NRd!==this.Cd.Q3b.ue}m7e(A,W){this.NTf();if(0===this.Cd.state||3===this.Cd.state||A!==this.lG||
W!==this.Qhc||this.jgg())this.wMj(A,W),this.dcd=-1;this.Cd.nub=!1;this.Aid()}get NRd(){return this.ta.Ba?this.ta.Ba.ue:0}wMj(A,W){const na=A===this.lG&&3===this.Cd.state&&!this.jgg(),Ga=this.Cd.tP.clone();this.Cd.reset();this.lG=A;this.Qhc=W;na?this.Cd.tP=Ga.clone():(this.Cd.tP.slideIndex=this.NRd,this.uhj());this.Cd.zm=this.Cd.tP.clone()}Aid(){this.v5i(this.lG,this.Qhc)?4!==this.Cd.state&&this.setSelection():(e.ULS.sendTraceTag(539829126,820,50,"Text not found"),this.o5b())}v5i(A,W){var na=this.ta.presentation;
if(!na)throw Error.argumentNull("Presentation is null");if(na=na.slides||[],na.length){this.Cd.vza=na.length;const Ga=na.length+this.Cd.tP.slideIndex;for(;this.Cd.zm.slideIndex<=Ga;){const Ka=this.Cd.zm.slideIndex%na.length,qb=this.x5i(na[Ka],A,W,this.Cd.zm.slideIndex===Ga?this.Cd.tP.hS:gi.oIe);if(qb&&(this.Cd.Q3b=this.oc.Zk(qb.Db)))return!0;if(7===this.Cd.state)return this.Cd.nub&&(bd.a.J(512496414,820,50,"call into PerformBackendFind recursively."),this.Cd.state=0),this.cOk(na[Ka]?na[Ka].Db:null,
A,W);if(3===this.Cd.state)break;let Qb;(Qb=this.Cd.zm).slideIndex=Qb.slideIndex+1;this.Cd.zm.hS=0}}else this.Cd.state=1;return!1}x5i(A,W,na,Ga){if(!A)return null;var Ka=this.oc.Zk(A.Db),qb=this.Rb.Lc(Ka);Ka=Ka.sUa()||[];(qb=qb.Cb(27))&&Ka.push(qb);if(!Ka.length)return this.Cd.state=7,null;for(;this.Cd.zm.hS<=Math.min(Ka.length-1,Ga);){if(this.Cd.O3b=this.w5i(Ka[this.Cd.zm.hS],W,na,this.Cd.zm.hS===Ga?this.Cd.tP.paragraphIndex:gi.oIe))return A;let Qb;(Qb=this.Cd.zm).hS=Qb.hS+1;this.Cd.zm.paragraphIndex=
0}return null}w5i(A,W,na,Ga){if(!this.jm.gGa(A)&&A.DB)return null;const Ka=ol.a.createInstance(A);let qb=0;for(;Ka.moveNext()&&this.Cd.zm.paragraphIndex<=Ga;){const Qb=Ka.currentNode;if(Bg.ParagraphReader.ae(Qb)&&qb++===this.Cd.zm.paragraphIndex){if(this.Cd.iSa=this.t5i(Qb,W,na,this.Cd.zm.paragraphIndex===Ga?this.Cd.tP.eha:gi.oIe))return A;let t;(t=this.Cd.zm).paragraphIndex=t.paragraphIndex+1;this.Cd.zm.eha=this.Cd.zm.Q6=-1}}return null}t5i(A,W,na,Ga){if(!Bg.ParagraphReader.ae(A))return null;let Ka=
A.gyb();if(!Ka.length)return null;Ka=Ka.substring(0,Math.min(Ka.length,Ga));return this.y5i(Ka,Math.max(0,this.Cd.zm.Q6),W,na)?A:null}y5i(A,W,na,Ga){let Ka=A,qb=na;Ga||(Ka=A.toLowerCase(),qb=na.toLowerCase());A=Ka.indexOf(qb,-1===W?0:W);if(-1!==A)return this.Cd.zm.eha=A,this.Cd.zm.Q6=A+qb.length,this.Cd.state=2,this.Cd.Y5d=!0;this.Cd.state=1;return!1}uhj(){var A=cj.b(this.DE);A=A?A.Nb:null;if(!A||!A.Pa)e.ULS.sendTraceTag(512496411,820,50,"There could be no slide at all");else if(A.Pa.mb){var W=A.Pa.mb.Va;
if(Bg.ParagraphReader.ae(W.node)){A=Object(z.a)(5,W.node);this.Cd.tP.eha=W.Sa;this.Cd.tP.Q6=W.Sa;const na=this.Ga.Tda(W.node);na?(this.Cd.tP.hS=na.get_zIndex()-1,this.Cd.tP.paragraphIndex=this.e$f(A)):this.jm.Gyb(W.node)&&(W=this.ta.Ba?this.ta.Ba.sUa():null,this.Cd.tP.hS=W?W.length:0,this.Cd.tP.paragraphIndex=this.e$f(A))}else this.Ga.uGa(W.node)&&(this.Cd.tP.hS=W.node.get_zIndex()-1)}}e$f(A){A=this.Rb.Lc(A);if(!A.X6(na=>10===na.type||60===na.type||16===na.type))return 0;A.Cc();const W=A.Cq;A.Cc();
return Math.max(0,A.LTa(W))}r5g(){const A=this.ta.presentation;if(!A)throw Error.argumentNull("Presentation is null");return this.Cd.tP.slideIndex||this.Cd.tP.hS?this.Cd.zm.slideIndex<(A.slides||[]).length:!1}Wdg(){const A=this.ta.presentation;if(!A)throw Error.argumentNull("Presentation is null");this.Cd.zm.slideIndex=A.slides?A.slides.length:0;this.Cd.nub=!1;this.Aid()}M0c(){return this.Im.Nl()}UAk(A){if(!this.M0c()){bd.a.J(512496409,820,50,"OnBackendFindSucceeded");var W=ah.a.empty;({slideId:W}=
ah.a.EKh(A));(A=this.oc.Wka(W))?(W=A.slideIndex,W>this.Cd.tP.slideIndex&&W<this.Cd.zm.slideIndex?this.o5b():this.Tb.Ba!==A?(this.Vq.aT(Object(n.a)(this,this.LIb,"onActiveSlideDomChanged")),this.Tb.Ba=A):(this.Cd.state=5,this.Cd.nub=!0,this.Cd.zm.slideIndex=this.Cd.zm.slideIndex>W?W+this.Cd.vza:W,this.Cd.zm.hS=0,this.Cd.zm.paragraphIndex=0,this.Cd.zm.eha=-1,this.Cd.zm.Q6=-1,this.Aid())):this.r5g()?this.Wdg():this.o5b()}}LIb(){bd.a.J(512496408,820,50,"OnActiveSlideDomChanged");this.Vq.Uoa(Object(n.a)(this,
this.LIb,"onActiveSlideDomChanged"));this.M0c()||this.BIa||(this.BIa=new be.a(3,1,0,Object(n.a)(this,this.KMe,"onPostActiveSlideDomChangedTask"),90,"30"),this.wb.Hb(this.BIa))}KMe(){bd.a.J(512496407,820,50,"OnPostActiveSlideDomChangedTask");this.BIa=null;if(!this.M0c())if(4===this.Cd.state){const A=this.NRd;this.Cd.zm.slideIndex=this.Cd.zm.slideIndex>A?A+this.Cd.vza:A;this.Cd.state=5;this.Cd.nub=!0;this.Aid()}else 2===this.Cd.state?this.setSelection():this.o5b()}TAk(){this.M0c()||(bd.a.J(512496406,
820,50,"OnBackendFindFailed"),this.r5g()?this.Wdg():this.o5b())}cOk(A,W,na){bd.a.J(512496405,820,50,"PerformBackendFind");this.Ufc.findText(W,na,A.toString(),Object(n.a)(this,this.UAk,"onBackendFindSucceeded"),Object(n.a)(this,this.TAk,"onBackendFindFailed"));this.Cd.state=4;return!0}o5b(){this.Cd.state=this.Cd.Y5d?3:1;bd.a.J(512496404,820,50,"End of Find: {0}",this.Cd.state);this.clearSelection();this.x1a(0,"")}getShapeType(A){return A.Hx?ResourceStrings.L_TextBox:A.nr?ResourceStrings.l_Chart:A.vd?
ResourceStrings.L_Table:A.Wf?ResourceStrings.L_SmartArt:A.pp?ResourceStrings.L_Media:A.qj?ResourceStrings.l_Picture:A.rl?ResourceStrings.l_Placeholder:ResourceStrings.l_ShapeObject}setSelection(){var A=this.Cd.iSa,W=this.Cd.Q3b;if(this.Tb.Ba!==W)this.Vq.aT(Object(n.a)(this,this.LIb,"onActiveSlideDomChanged")),this.Tb.Ba=W;else{A=Cl.SelectionFactory.D3(A,this.Cd.zm.eha,this.Cd.zm.Q6);if(this.jm.gGa(this.Cd.O3b))this.ia.Ka(fd.a.dMa,2,new $k.a(!0)),this.Fa.vf(Ii.a.o3),this.twa.setSelection(A),this.x1a(this.Cd.zm.slideIndex%
this.oc.Cj()+1,ResourceStrings.l_NotesPaneType);else{W=this.Cd.O3b;const na=this.Cd.O3b.tg(this.Gb.Na);if(na)if(na.hq){let Ga;(Ga=this.Cd.zm).hS=Ga.hS+1;this.Cd.zm.paragraphIndex=0;this.Cd.zm.eha=0;this.Cd.zm.Q6=0;na.nud()}else this.eok&&W.Wf?(this.le.Lkh(new al.a(W)),this.ZIa.setSelection(A)):(this.Fa.vf(lf.a.vg),this.Gb.setSelection(A));this.x1a(this.Cd.zm.slideIndex%this.oc.Cj()+1,this.getShapeType(W))}bd.a.J(512496402,820,50,"Find Text: {0}/{1}/{2}/({3},{4} )",this.Cd.zm.slideIndex,this.Cd.zm.hS,
this.Cd.zm.paragraphIndex,this.Cd.zm.eha,this.Cd.zm.Q6);this.Y4d()}}clearSelection(){var A=cj.b(this.DE);if(A=A?A.Nb:null){var W=this.Cd.y7j;W&&(W=Cl.SelectionFactory.Qg(W,0),A.setSelection(W))}else bd.a.J(512496401,820,10,"Find Replace Text: Selection manager received as null when clearing selection")}x1a(A,W){const na=new Sys.StringBuilder,Ga=new Sys.StringBuilder;let Ka=!1;A!=this.dcd?(this.dcd=A,this.Yye=1):this.Yye++;switch(this.Cd.state){case 1:Ka=!0;na.append(ResourceStrings.l_FindTextNotFound);
break;case 3:na.append(ResourceStrings.l_FindTextFindOver);break;case 6:Ka=!0;na.append(ResourceStrings.l_FindTextFindAgain);break;case 2:Ga.append(String.format(ResourceStrings.l_FindTextMessageWithCount,this.Yye,A,W));break;default:bd.a.J(512496400,820,50,"Find Text: {0}",this.Cd.state)}this.hml(na.toString(),Ka,Ga.toString());this.Y4d()}FIl(A){A=this.n$k(A);32===A&&this.m7e(this.lG,this.Qhc);16===A&&(this.Im.x1a(ResourceStrings.l_ReplaceTextErrorMessage,0),this.Im.D3d(),this.Im.yWf(!0))}n$k(A){return xf.a.c6d("SingleReplaceAction",
fd.a.C1,()=>{A||(A="",bd.a.J(512496399,820,50,"Replacing with empty string"));var W=this.Cd.iSa;if(!W)return bd.a.J(512496398,820,10,"ParagraphNode not set in findContext"),16;var na=this.Cd.zm.eha;const Ga=this.Cd.zm.Q6;if(-1===na||-1===Ga)return bd.a.J(512496397,820,10,"Invalid start or end position of current text selection."),16;const Ka=this.Pq.je(15);Ka.ld(W);this.BJ.replaceTextRange(sf.a.createTextRange(W,na,Ga),A,!0,!1,fd.a.C1);W=na+A.length;na=W!==this.Cd.zm.Q6;this.Cd.zm.Q6=W;Ka.dispose();
na&&this.setSelection();return 32})}Y4d(){this.Im.yWf(1===this.Pfb);this.DWf();this.Im.BYi(3===this.Pfb)}DWf(){this.Cd.iSa?this.Im.CYi(2===this.Pfb):this.Im.D3d()}NTf(){this.Im.DUi();this.Im.D3d();this.Im.FUi()}hml(A,W,na){2===this.Pfb?(this.Im.Dsd(ResourceStrings.l_ReplaceTextReplaced+". "+na),this.Im.jsd("")):(this.Im.jsd(na),this.Im.Dsd(""));this.Im.y_e("");this.Im.x1a(A,W?0:1)}A0i(A,W){const na=xf.a.kk("FindNext");na.Wa("CommandId",A.toString());na.Wa("IsReadOnlyModeEnabled",this.Im.qBe.toString());
try{W()}finally{na.finish(!0)}}xBk(){ob.a.Xa(this.Im.a1a)||this.A0i(fd.a.find,()=>{bd.a.J(512496396,820,50,"Find Text Started");this.Pfb=1;this.m7e(this.Im.a1a,this.Im.matchCase);return 32})}yBk(){this.Im.uBe?(bd.a.J(512496394,820,50,"Replace Text Started"),this.Pfb=2,this.FIl(this.Im.gWe)):(this.Im.$Cl(),bd.a.J(512496395,820,50,"Find dialog switched to replace dialog"),this.DWf())}zBk(A){this.cWa()?bd.a.J(512496393,820,10,"ReplaceAll Already in progress. ReplaceAllStartTime:{0}, Time diff:{1}",this.zGb,
Date.now()-this.zGb):ob.a.Xa(this.Im.a1a)||(Rg.a("FixReplaceAllTimeOutError")&&(this.ta.presentation.Aga=-16),this.lG=this.Im.a1a,this.tna=A?A:"",this.zGb=Date.now(),this.Pfb=3,this.A3d(),this.t4i(this.ta.Ba,this.lG,this.tna,this.Qhc),0<this.XWg&&(this.Acd=window.setTimeout(()=>{this.Aah()},this.XWg)),16===this.replaceAll()&&(this.yGb=Date.now(),this.DKf(),this.Aah()))}replaceAll(){return xf.a.c6d("ReplaceAllAction",fd.a.C1,()=>{bd.a.J(512496392,820,50,"ReplaceAll Text Started");const A=this.ta.presentation;
if(A){const W=this.Eb.xd(15);try{W.hc(A),this.ogb.fk(Object(n.a)(this,this.pib,"onPresentationPropertyChange")),A.gMb=Object.assign(new lk,{NewStr:this.tna,OldStr:this.lG,ActiveSlideCid:this.ta.Ba.cid,ActiveSlideSid:this.ta.Ba.sid,MatchTxtInfo:Object.assign(new Zk,{ShouldMatchCase:this.Im.matchCase})})}finally{W&&W.dispose()}return 32}return 16})}t4i(A,W,na,Ga){if(A){A=this.oc.Zk(A.Db);var Ka=this.Rb.Lc(A);A=A.sUa()||[];(Ka=Ka.Cb(27))&&A.push(Ka);if(A.length)for(Ka=0;Ka<=A.length-1;)this.C5i(A[Ka],
W,na,Ga),Ka++}else bd.a.J(512496391,820,50,"slide must not be null.")}C5i(A,W,na,Ga){if(this.jm.gGa(A)||!A.DB)for(A=ol.a.createInstance(A);A.moveNext();){const Ka=A.currentNode;if(!Bg.ParagraphReader.ae(Ka))continue;let qb=null;(qb=this.u5i(Ka,W,Ga))&&qb.characterData.replace(W,na)}}u5i(A,W,na){if(!Bg.ParagraphReader.ae(A))return bd.a.J(512496390,820,50,"node must be ParagraphNode"),null;const Ga=A.gyb();return Ga.length?this.z5i(Ga,W,na)?A:null:null}z5i(A,W,na){let Ga=A,Ka=W;na||(Ga=A.toLowerCase(),
Ka=W.toLowerCase());return-1!==Ga.indexOf(Ka,0)?!0:!1}pib(A,W){if(!this.cWa())bd.a.J(512496389,820,50,"ReplaceAll Not Iniitated");else if(W.property===Eg.a.cWe){this.DKf();A=Object(z.a)(482,W.node);if(-1!==A.Aga){var na=2;if(0===A.Aga){W=ResourceStrings.l_FindTextNotFound;var Ga=ResourceStrings.l_ReplaceAllCalloutNotificationNoMatchMessage;na=0;var Ka=ResourceStrings.l_ReplaceAllCalloutNotificationNoMatchTitle}else 1===A.Aga?(W=String.format(ResourceStrings.l_ReplaceAllSuccessSingular,A.Aga,this.lG,
this.tna),Ga=String.format(ResourceStrings.l_ReplaceAllCalloutNotificationMessageSingular,A.Aga,this.lG,this.tna)):(W=String.format(ResourceStrings.l_ReplaceAllSuccessPlural,A.Aga,this.lG,this.tna),Ga=String.format(ResourceStrings.l_ReplaceAllCalloutNotificationMessagePlural,A.Aga,this.lG,this.tna)),Ka=ResourceStrings.l_ReplaceAllCalloutNotificationSuccessTitle}else Ka=ResourceStrings.l_ReplaceAllCalloutNotificationErrorTitle,W=Ga=ResourceStrings.l_ReplaceAllErrorMessage,na=0,bd.a.J(512496388,820,
10,"Invalid ReplaceAllTextCount");this.yGb=Date.now();bd.a.J(512496387,820,50,"Time taken for Replace All operation in ms: {0}",this.yGb-this.zGb);this.xWf(W,na);this.ogb.Om(Object(n.a)(this,this.pib,"onPresentationPropertyChange"));this.Im.Nl()&&this.I1e(Ka,Ga,10);A.Aga=-16}}cWa(){return this.zGb>this.yGb}A3d(){var A=String.format(ResourceStrings.l_ReplaceAllInProgress,this.lG);this.Im.x1a(A,3);A=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_ReplaceAllTextReplaceAll,
this.lG);this.Im.y_e(A);A=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_ReplaceTextReplace,this.lG);this.Im.Dsd(A);A=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_FindTextFindNext,this.lG);this.Im.jsd(A);this.NTf()}xWf(A,W){this.Im.x1a(A,W);this.Im.y_e(A);this.Im.Dsd("");this.Im.jsd("");this.Y4d()}$ul(){if(this.cWa()){var A=String.format(ResourceStrings.l_ReplaceAllInProgress,this.lG);this.I1e(ResourceStrings.l_ReplaceAllCalloutNotificationProgressTitle,
A,1024)}}I1e(A,W,na){this.yH?(this.yH.H3d(),bd.a.J(512496385,820,50,"Callout notification called for Replace All operation"),A=Object.assign(new fg.a,{title:A,message:W,timeoutInSeconds:na}),A=this.yH.MBh(A),A.JVa&&bd.a.J(512496384,820,10,"Error in callout notification: Error:{0}",A.message)):bd.a.J(512496386,820,10,"Find Replace Text: m_calloutNotification adapter is null.")}Aah(){let A=!1;this.cWa()&&(A=!0,this.yGb=Date.now());bd.a.J(512496355,820,10,"Error returned in replace all operation. ReplaceAll Timeout: {0}, Time taken in ms: {1}",
A,this.yGb-this.zGb);this.xWf(ResourceStrings.l_ReplaceAllErrorMessage,0);this.ogb.Om(Object(n.a)(this,this.pib,"onPresentationPropertyChange"));this.Im.Nl()&&this.I1e(ResourceStrings.l_ReplaceAllCalloutNotificationErrorTitle,ResourceStrings.l_ReplaceAllErrorMessage,10);this.ta.presentation.Aga=-16}DKf(){-1!==this.Acd&&(window.clearTimeout(this.Acd),this.Acd=-1)}}gi.oIe=1024;Object(h.a)(gi,"FindReplaceTextHandler",null,[570]);class rm{constructor(A){this.sMg=this.f_g=null;this.vFb=!1;this.x5=A}findText(A,
W,na,Ga,Ka){this.sMg=A;this.vFb=W;this.f_g=na;this.x5.QF(Ga,Ka,null)}get bBl(){return this.f_g}get matchCase(){return this.vFb}get Tfd(){return this.sMg}}Object(h.a)(rm,"FindTextManager",null,[568]);var xa=d(394),Ff=d(110);class Ri extends Ff.a{constructor(){super();this.MatchText=null;this.MatchCase=!1;this.SlideID=null}pl(){return 54}static q_d(A,W,na){const Ga=new Ri;Ga.SlideID=na;Ga.MatchText=A;Ga.MatchCase=W;return Ga}}Object(h.a)(Ri,"FindTextRequest",Ff.a,[]);class vj extends xa.a{constructor(A,
W,na,Ga){super();this.vHa=this.fJa=null;this.IO=this.S4=!1;this.Vec=null;this.Ud=na;this.B5c=!1;this.Ufc=W;this.Ya=Ga;this.Ym=A;this.enabled=2;this.Ym.register(this)}QF(A,W){this.B5c=!0;this.fJa=A;this.vHa=W;this.Ym.Uaa()}forceOutbound(){}fla(){return this.B5c&&!this.S4}bO(){return!1}RUa(){return this.Wd&&2===this.Wd.status?!0:this.fla()}kMb(){if(1===this._state)this.Vec=this.Ya.podSessionId,this.Wd.TH=Ri.q_d(this.Ufc.value.Tfd,this.Ufc.value.matchCase,this.Ufc.value.bBl),this.Wd.status=1,this._state=
3;else if(3===this._state&&this.Wd&&2===this.Wd.status){if(2!==this.Wd.statusCode)this.PH();else{if(!this.Wd.Yr||1!==this.Wd.Yr.length){this.PH();return}const A=this.Wd.Yr[0];0===A.StatusCode?(this.j1(),this.fJa&&this.fJa(A.SlideID)):(this.PH(A),124===A.StatusCode&&this.Ud.Ds(A.ServerError,this.Vec))}this.Vec=null}}PH(A=null){this.B5c=!1;this._state=1;bd.a.J(21849603,824,15,"FindTextRequest failed. OperationResult:{0}, RequestStatus:{1}, HttpStatusCode:{2}, IsLastReplicationFailed:{3}, PodSessionId:{4}",
A?A.StatusCode:-1,this.Wd?Nf.a[this.Wd.statusCode]:"NULL",this.Wd?this.Wd.Iv:-1,this.IO,this.Vec||"NULL");this.IO=!0;this.vHa&&this.vHa(-1,-1)}j1(){this.B5c=!1;this._state=1;bd.a.J(25012056,818,this.IO?15:50,"FindTextRequest succeeded. IsLastReplicationFailed:{0}, PodSessionId:{1}",this.IO,this.Vec||"NULL");this.IO=!1}dispose(){this.S4||(1===this._state&&this.Ym.unregister(this),this.S4=!0)}}Object(h.a)(vj,"FindTextReplicator",xa.a,[107]);class Hg{constructor(){this.K=null}get name(){return"PowerPointWebEditor.FindText"}Yb(A){this.K=
A;this.K.register(568,"PowerPointWebEditor.IFindTextManager").ma().oa(()=>new rm(new vj(this.K.resolve("PowerPointWebEditor.IPPTReplicationScheduler"),this.K.oe("PowerPointWebEditor.IFindTextManager"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"))));this.K.register(569,"PowerPointWebEditor.IFindReplaceTextDialogFactory").ma().oa(()=>new Lk(this.K.oe("PowerPointWebEditor.IFocusManager")));const W=new bk.a(this.K.resolve("Common.App.CalloutNotification.ICalloutNotification"),
this.K.resolve("PowerPointWebEditor.IRibbonPane").va);this.K.register(570,"PowerPointWebEditor.IFindReplaceTextHandler").ma().oa(()=>new gi(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IFindTextManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),
this.K.resolve("PowerPointWebEditor.INotesView"),this.K.resolve("Box4.IPageView"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),this.K.resolve("Box4.Graph.IGraphTransactionFactory"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.ICharacterPropertiesEditor"),
this.K.resolve("PowerPointWebEditor.ISmartArtTextView"),this.K.oe("PowerPointWebEditor.IFindReplaceTextDialogFactory"),this.K.resolve("Box4.Graph.IGraphInstance").yd(7),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("Common.IAppSettingsManager").wc("ReplaceAllClientTimeoutMS",0),W))}init(){let A=new Kk(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IFindReplaceTextHandler"),
this.K.resolve("PowerPointWebEditor.IPresentationReader"));A.vb();A.pe()}dispose(){}static main(){Ia.a.instance.Ac(qd.a(new Hg,0))}}Object(h.a)(Hg,"PPTWebEditorFindTextPackage",null,[2,3]);class ua{constructor(A){this.Ea=A}get nUd(){return"PowerPoint"}get HHf(){return"c551d75c-10b1-4de2-83cc-cce22d7c06bd"}get version(){return 1}get currentVersion(){return 0}get qVj(){return this.Ea.powerPointEditorFirstRunExperienceDataStoreIsEnabled}get aCb(){return this.Ea.powerPointEditorFirstRunExperienceUIIsEnabled}get Isg(){return this.Ea.powerPointEditorFirstRunExperienceTestIsEnabled}get E6i(){return"Microsoft.Office.Server.Powerpoint.Web.IWacPptEditorFirstRunExperienceUISettings"}get V3g(){return 24}get qsh(){return 4E3}get Orc(){return this.Ea.roamingServiceHandlerWebServiceBase||
""}}Object(h.a)(ua,"FirstRunExperienceLauncherSettings",null,[598]);class eb{constructor(A){this.TDg=A}Ovl(A){this.TDg&&this.TDg.O1e(A)}}Object(h.a)(eb,"FirstRunExperienceManager",null,[567]);class Tb{constructor(){this.K=null}get name(){return"PowerPointWebEditor.FirstRunExperience"}Yb(A){if(!A)throw Error.argumentNull("container");this.K=A;this.K.register(567,"PowerPointWebEditor.FirstRunExperience.IFirstRunExperienceManager").ma().oa(()=>new eb(this.K.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher")))}init(){this.K.resolve("Common.IAppSettingsManager").ff(()=>
{this.O1e()})}dispose(){}O1e(){var A=this.K.resolve("PowerPointWebEditor.IApplicationSettings");if(!A)throw Error.argumentNull("appSettings");const W=this.K.resolve("PowerPointWebEditor.FirstRunExperience.IFirstRunExperienceManager");W&&(A=new ua(A),W.Ovl(A))}static main(){Ia.a.instance.Ac(new Tb)}}Object(h.a)(Tb,"PPTWebEditorFirstRunExperiencePackage",null,[2,3]);var uc=d(182),yd=d(469);class oe{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=
this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(h.a)(oe,"CatchUpConfiguration",null,[]);class $d{constructor(){this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=
null}}Object(h.a)($d,"SharedControllerFactoryParameters",null,[]);const ve=(A,W)=>{if(!A)throw Error.create(String.format("Argument {0} is null.",W));},hc=A=>{if(!A.navigationId)return bd.a.J(524895832,3012,10,"CreateNavigationData: navigation id is missing."),null;try{const W=window.atob(A.navigationId);return W&&""!==W?{["NavigationId"]:W}:null}catch(W){return bd.a.J(524145986,3012,10,"CreateNavigationData: decoding navigation id failed.",W),null}};class Of{constructor(A){ve(A,"ActivityContentManager.IActionManagerExtended");
this.ia=A}doesContentExist(A){if(!A)return bd.a.J(524895831,3012,10,"DoesContentExist: activity is null."),!1;switch(A.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:return(A=hc(A))?32===this.ia.Ka(sa.a.mwb,2,A):!1;default:return!1}}}Object(h.a)(Of,"ActivityContentManager",null,[563]);class Nc{constructor(A){this.qn=A}shouldShowEmptyExperienceButton(){return M.AFrameworkApplication.D3c()}getExplanationText(){return""}getCommandName(){return ResourceStrings.L_FileHistory}onButtonClick(){this.qn.Ka(sa.a.juc,
2,null)}onInviteOthersButtonClick(){this.qn.Ka(sa.a.zta,2,null)}}Object(h.a)(Nc,"EmptyCatchUpBehaviorManager",null,[566]);class $e{constructor(){this.color=this.imageUrl=this.email=this.givenName=this.displayName=this.provider=this.id=null}}Object(h.a)($e,"Person",null,[]);var lj=d(658),th=d(234),Ig=d(174);class wk extends Ff.a{constructor(A){super();this.StartTime=null;this.StartTime=A}pl(){return 93}}Object(h.a)(wk,"GetFileRevisionHistoryRequest",Ff.a,[]);class bl{constructor(A,W,na){this.ProviderId=
this.UserId=this.UserName=null;this.UserName=A;this.UserId=W;this.ProviderId=na}}Object(h.a)(bl,"Author",null,[]);const ea=(A,W)=>A&&W?A.providerIdField===W.ProviderId?A.userIdField===W.UserId:A.userNameField===W.UserName:!1;var Gj=d(245);class Hj{constructor(A,W,na){this.H8c=this.Fdb=null;this.ai=A;this.Tdb=na;this.Tdb.zgi(Object(n.a)(this,this.v9g,"onFileRevisionHistoryReady"));W.ff(()=>{this.Fdb=new bl(W.Ha("UserName"),W.Ha("387"),W.Ha("388"))})}dispose(){this.Tdb.Y7k(Object(n.a)(this,this.v9g,
"onFileRevisionHistoryReady"));this.Fdb=null}chj(A,W,na){A&&na&&(this.H8c=na,A=new Gj.a(new wk(A),Ga=>{this.Awg(Ga,W);this.Hjd(Ga)},Ga=>{this.Awg(Ga,W);return this.rib(Ga)}),this.ai.Hb(A))}v9g(A,W){A=null;const na=[];ob.a.Xa(W.ySc)||(({ySc:W}=this.pKl(W.ySc)).returnValue?Ig.b(W.fileRevisionEntriesField,Ga=>this.I_j(Ga.changesDataField),Ga=>{na.push(Ga.changesDataField)}):A="ErrorGetFileRevisionHistoryParseJsonException");this.QLe(na,A)}Hjd(A){let W=null;A.ServerError&&0!==A.ServerError.Code?W=th.a[A.ServerError.Code]:
0!==A.StatusCode&&(W=lj.a[A.StatusCode]);W&&this.QLe(null,W)}rib(A){bd.a.J(512262998,811,15,"OnGetFileRevisionAuthorNamesFailed() - "+A.toString());this.QLe(null,"ErrorGetFileRevisionHistoryFailed");return!0}QLe(A,W){this.H8c&&(A=this.J$i(A),this.H8c(A,W),this.H8c=null)}pKl(A){let W;W=null;try{W=Sys.Serialization.JavaScriptSerializer.deserialize(A)}catch(na){bd.a.J(512262997,811,10,"TryParseFileRevisionList() - Exception: "+na)}return{returnValue:!!W,ySc:W}}I_j(A){return!ea(A,this.Fdb)}Awg(A,W){A.Hya&&
W.vm("GetAuthorNamesRequestInvokedTime",A.Hya);W.Wa("GetAuthorNamesRequestCorrelationId",A.Ph)}J$i(A){if(!A)return[];const W=Array(A.length);for(let Ga=0;Ga<A.length;Ga++){var na=A[Ga];na=Object.assign(new $e,{displayName:na.userNameField,id:na.userIdField,provider:na.providerIdField});W[Ga]=na}return W}}Object(h.a)(Hj,"FileRevisionHistoryService",null,[625,107]);class mj{constructor(A,W){ve(A,"FlyoutFocus.IF6Manager");ve(W,"FlyoutFocus.IFocusManagerHelper");this.Dg=A;this.IB=W}initialize(){this.IB.q4(lf.a.n8a,
lf.a.Xi,null,Object(n.a)(this,this.g7i,"focusOnFirstFlyoutItem"),()=>{},!0)}enableF6Focus(){this.Dg.DI(lf.a.n8a)}disableF6Focus(){this.Dg.Eo(lf.a.n8a)}g7i(){const A=document.getElementById("flyoutItem0");A&&(bd.a.J(570730465,3012,50,"Focused on the catch-up flyout via ctrl+F6"),A.focus())}}Object(h.a)(mj,"FlyoutFocus",null,[624]);class Dl{constructor(A,W,na,Ga){this.h6c=null;this.Ryg=this.iFg=this.IEb=this.R9c=!1;ve(W,"FlyoutRibbonButton.IActionManagerExtended");ve(na,"FlyoutRibbonButton.IFocusManager");
ve(Ga,"FlyoutRibbonButton.FloodgateEventLogger");this.Vb=A;this.ia=W;this.Fa=na;this.thk=Ga;this.xhk=new Date}initialize(){M.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Rg.a("DelayRegisterCatchUpActions")||this.vb()}registerButtonClickedEvent(A){this.h6c&&bd.a.J(571532947,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.h6c=A.buttonClickedCallback}onFlyoutInitialized(){this.R9c&&bd.a.J(571532948,
3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");const A=(new Date).getTime()-this.xhk.getTime();bd.a.J(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",A);this.R9c=!0;Ud.c(sa.a.Hxi,!0,Ud.e,0,0,A);M.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Rg.a("DelayRegisterCatchUpActions")&&this.vb();this.Vb&&this.Vb.updateCommandUI()}logFlightTriggers(){}onFlyoutVisibilityChanged(A){this.IEb!==A.flyoutIsVisible&&
(this.IEb=A.flyoutIsVisible,this.Vb&&this.Vb.updateCommandUI(!0),this.IEb&&this.Ryg?this.Fa.vf(lf.a.n8a):this.IEb||this.Fa.vf(lf.a.Xi),this.IEb||this.thk.tak())}vb(){this.ia.ya(sa.a.F6e,fc.a.frame,Object(n.a)(this,this.BIk,"onToggleCatchUpFlyout"));this.ia.ra(sa.a.Njh,fc.a.frame,Object(n.a)(this,this.lGk,"onQueryToggleCatchUpFlyout"),96)}BIk(A,W,na){if(1===na)return this.R9c?(this.iFg||(this.iFg=!0,bd.a.J(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(!this.h6c)return 8;this.Ryg=!0;this.h6c();
return 32}lGk(A,W,na,Ga,Ka){Ka[Kc.a.Visible]=!0;Ka[Kc.a.On]=this.IEb&&this.R9c;return 32}}Object(h.a)(Dl,"FlyoutRibbonButton",null,[623]);const Ai=A=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+A)};class nj{constructor(A,W,na,Ga,Ka,qb){ve(A,"PowerPointActivityNavigationManager.IActionManagerExtended");ve(W,"PowerPointActivityNavigationManager.IPresentationReader");ve(na,"PowerPointActivityNavigationManager.IThumbnailNavigationPaneView");
ve(Ga,"PowerPointActivityNavigationManager.IRibbonUser");ve(qb,"PowerPointActivityNavigationManager.IActivityContentManager");this.ia=A;this.oc=W;this.De=na;this.uu=Ga;this.ppk=Ka;this.nek=qb}navigateToActivity(A){if(A.fromSummaryString)return this.gll(),this.myj(),this.jyj(),this.dvl(),Promise.resolve(1);A=A.activity;if(!A)return bd.a.J(524145984,3012,10,"NavigateToActivity: activity is null."),Promise.resolve(8);if(!A.navigationId)return bd.a.J(524145985,3012,10,"NavigateToActivity: navigation id is null."),
Promise.resolve(4);if(!this.nek.doesContentExist(A))return Promise.resolve(2);switch(A.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:A=hc(A);if(!A)return Promise.resolve(5);A=this.ia.Ka(sa.a.o2b,2,A);return Promise.resolve(32===A?1:6);default:return Promise.resolve(7)}}gll(){const A=this.oc.tn;A?A.nEa=!0:bd.a.J(570831450,3012,10,"PowerPointActivityNavigationManager: IPageManifestNode is null.")}myj(){this.uu.selectRibbonTabById(this.ppk)}jyj(){var A=this.oc.tn;if(A&&A.slides){var W=
null;for(const na of A.slides)if(na&&(A=this.oc.Zk(na.Db))&&A.isUnread){W=A;break}W?(this.De.ksd(),this.De.$J(W.ue)):bd.a.J(570831452,3012,15,"PowerPointActivityNavigationManager: Could not find any unread slides.")}else bd.a.J(570831451,3012,10,"PowerPointActivityNavigationManager: IPageManifestNode is null.")}dvl(){this.ia.Ka(fd.a.R1a,2,{InvokeSource:1,ShowRevisionTrackingStatus:3})}}Object(h.a)(nj,"PowerPointActivityNavigationManager",null,[564]);var Bi=d(675);class El{constructor(){this.collectionId=
this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}Object(h.a)(El,"ActivityFeedEntry",null,[]);const te=(A,W)=>W.x3c?Wa.toArray(Wa.select(Wa.asEnumerable(A),na=>{if(!na||!na.activityFeedItemPayload)return na;const Ga=JSON.parse(na.activityFeedItemPayload);var Ka=Ga.actor;if(!Ka||Ka.pictureUrl)return na;const qb=Ka.userPrincipalName||Ka.email;if(!qb)return na;Ka=W.Fvb(qb,Ka.provider,M.AFrameworkApplication.gh,0);if(!Ka)return na;Ga.actor.pictureUrl=Ka;return Object.assign(new El,
{id:na.id,type:na.type,collectionId:na.collectionId,activityState:na.activityState,activityFeedItemPayload:JSON.stringify(Ga),timestamp:na.timestamp})})):A,sm=(A,W)=>{const na=new Map,Ga=new Map;for(const Ka of A){if(!Ka||!Ka.activityFeedItemPayload)continue;A=JSON.parse(Ka.activityFeedItemPayload).actor;if(!A)continue;const qb=A.email||A.userPrincipalName;qb&&!Ga.has(qb)&&Ga.set(qb,new Bi.a(qb,null,A.name))}Ga.forEach(Ka=>{const qb=W.oua(Ka,6);na.set(Ka.UserId,qb)});return na};class Zl{constructor(){this.collectionId=
this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}Object(h.a)(Zl,"ActivityFeedItem",null,[]);class Ji{constructor(){this.personaColorMap=this.activityFeedItems=null}}Object(h.a)(Ji,"ActivityFeedPayload",null,[]);class Qe{constructor(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(h.a)(Qe,"ActivityRequestPayload",null,[]);var $l=d(545);class mk{constructor(){this.activityFeedItemId=
this.activityId=null;this.type=0;this.collectionId=this.state=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(h.a)(mk,"Activity",null,[]);class zf{constructor(A,W,na,Ga,Ka,qb,Qb,t,Y,pa){this.Ve=this.mCe=null;ve(A,"PowerPointActivityRequestManager.IJsonpHelperManager");ve(W,"PowerPointActivityRequestManager.PowerPointWaterlineUpdater");ve(na,"PowerPointActivityRequestManager.IFileRevisionHistoryService");ve(Ga,"PowerPointActivityRequestManager.IAppSettingsManager");
ve(Ka,"PowerPointActivityRequestManager.IApplicationSettings");ve(qb,"PowerPointActivityRequestManager.IActionManagerExtended");ve(Qb,"PowerPointActivityRequestManager.ICatchUpRequestHandler");ve(t,"PowerPointActivityRequestManager.IUserProfilePictureUtilsV2");ve(Y,"PowerPointActivityRequestManager.IPeopleColorUtils");this.XHa=A;this.$sk=W;this.lhk=na;this.Jb=Ga;this.ia=qb;this.p6c=Qb;this.vok=t;this.ybd=Y;this.IYg=pa}requestWYWAActivities(){return new Promise((A,W)=>{this.Ve=xf.a.kk("ShowWYWACallout",
2);this.$sk.Dcl(na=>{na=this.DUk(na);zf.isExpectedError(na)?A(zf.tPc):na?(bd.a.J(509223009,3012,10,"OnReadRoamingSucceeded() - Error: {0}",na),W(na)):this.lhk.chj(this.mCe,this.Ve,(Ga,Ka)=>{Ka&&(bd.a.J(509223008,3012,10,"GetFileRevisionAuthorNamesAsync() - Error: {0}",Ka),W(Ka));A(zf.PHi(Ga))})},na=>{const Ga=!!na.data&&zf.tWj(na.data.Ke);na=this.XHa.Nka(na);bd.a.J(509223007,3012,Ga?50:10,"OnReadRoamingFailed() - Error: {0}",na);Ga?A(zf.tPc):W(na)})})}requestActivities(){return Promise.resolve(zf.tPc)}requestRelevantActivities(){return Promise.resolve(zf.tPc)}requestActivityFeed(){return this.p6c?
$l.b(this.p6c.getActivityFeed(this.IYg)).then(A=>{A=zf.WHl(A);return{activityFeedItems:te(A,this.vok),personaColorMap:sm(A,this.ybd)}}):Promise.resolve(Object.assign(new Ji,{activityFeedItems:[]}))}updateActivityState(A){return this.p6c?$l.b(this.p6c.KMl(this.IYg,A.itemIds,A.activityStatesToSet||0,A.activityStatesToReset||0,A.resetUnseenCount)):Promise.resolve(!1)}DUk(A){A=A.data.ee;if(!A)return"ErrorReadRoamingEmptyResponseBody";let W;try{W=JSON.parse(A)}catch(na){return na.toString()}A=null;if(!W.Error){if(!W.Timestamp)throw Error.create("response.Error and response.Timestamp are empty");
A=W.Timestamp}this.mCe=this.ZQl(A);bd.a.J(509223006,3012,100,"Timestamp for retrieving activities: "+this.mCe);return W.Error}ZQl(A){const W={};var na=this.Jb.wc("AppWaterlineOverrideTimestampValue",0);return na?(A=new Date(1E3*na),W.timestamp=A,this.ia.Ka(fd.a.sud,2,W),A.format("yyyy-MM-ddTHH:mm:ssZ")):A?(na=this.Jb.wc("AppWaterlineOverrideDaysValue",0))?(A=new Date(+new Date(A)-+new Date(864E5*na)),W.timestamp=A,this.ia.Ka(fd.a.sud,2,W),A.format("yyyy-MM-ddTHH:mm:ssZ")):A:null}static PHi(A){return A?
Object.assign(new Qe,{actors:A}):null}static WHl(A){const W=[];if(!A)return W;for(const na of A)W.push(Object.assign(new Zl,{id:na.id,type:na.type,collectionId:na.collectionId,activityState:na.activityState,activityFeedItemPayload:na.activityFeedItemPayload,timestamp:na.timestamp}));return W}static isExpectedError(A){return"ErrorDocNotInRoamingList"===A||"ErrorLastViewedDocListIsEmpty"===A}static tWj(A){return 403===A}}zf.tPc=Object.assign(new Qe,{activities:[],actors:[],hasMore:!1,highWaterline:"",
lowWaterline:"",wywaWaterline:""});Object.assign(new Qe,{activities:[Object.assign(new mk,{activityId:"activityId1",type:3,actors:[Object.assign(new $e,{id:"personId1",provider:"provider",displayName:"Kat Larsson",email:"klarsson@contoso.net"})],displayTimestamp:new Date,relevancy:2,navigationId:"navigationId1"}),Object.assign(new mk,{activityId:"activityId2",type:4,actors:[Object.assign(new $e,{id:"personId2",provider:"provider",displayName:"Frankie Smith",email:"fsmith@contoso.net"})],displayTimestamp:new Date,
relevancy:2,navigationId:"navigationId2"})]});Object.assign(new Ji,{activityFeedItems:[Object.assign(new Zl,{id:"FeedItemId1",type:"UserAtMentioned",collectionId:"CollectionId1",activityState:0,activityFeedItemPayload:'{"isReply":false,"id":"1","timestamp":"2021-10-05T14:15:25.1663372Z","data":{"activityId":"a1","navigationId":"n1","commentThreadId":"1","commentThreadIsTask":false},"fileDetails":{"documentUrl":"url","linkUrl":"url","siteUrl":"url","listItemUniqueId":"u1","sourceRelativeUrl":"url","sourceFileName":"file.pptx","sourceFileExtension":"pptx","hostItemId":"SPO_ID"},"actor":{"id":null,"provider":null,"email":"kat.larsson@microsoft.com","userPrincipalName":"klarsson@microsoft.com","name":"Kat Larsson","roles":"Creator","pictureUrl":null},"userRoles":"Mentioned"}',
timestamp:(new Date).toISOString()}),Object.assign(new Zl,{id:"FeedItemId2",type:"UserAtMentioned",collectionId:"CollectionId1",activityState:0,activityFeedItemPayload:'{"isReply":false,"id":"2","timestamp":"2021-10-05T14:15:25.1663372Z","data":{"activityId":"a2","navigationId":"n2","commentThreadId":"2","commentThreadIsTask":false},"fileDetails":{"documentUrl":"url","linkUrl":"url","siteUrl":"url","listItemUniqueId":"u1","sourceRelativeUrl":"url","sourceFileName":"file.pptx","sourceFileExtension":"pptx","hostItemId":"SPO_ID"},"actor":{"id":null,"provider":null,"email":"frankie.smith@microsoft.com","userPrincipalName":"fsmith@microsoft.com","name":"Frankie Smith","roles":"Creator","pictureUrl":null},"userRoles":"Mentioned"}',
timestamp:(new Date).toISOString()})]});Object(h.a)(zf,"PowerPointActivityRequestManager",null,[565]);var Jf=d(260);class Fl{constructor(A,W,na,Ga,Ka,qb){this.ifb=!1;this.TLg=null;this.Mc=A;this.Su=W;this.ypk=na;this.XHa=Ga;this.wb=Ka;this.TGb=qb}initialize(){this.Mc&&(this.Mc.CCa(Object(n.a)(this,this.RJa,"onBeforeSessionEnd")),this.Mc.GC(Object(n.a)(this,this.OM,"onSessionClosed")));this.Dfl()}Dcl(A,W){const na=this.kag("getPPTDocLastViewedTimestamp");this.Wx(na,1,A,W)}RJa(){this.$Qh()}OM(){this.ifb=
!0}Dfl(){if(this.wb){var A=new be.a(3,2,3E4,Object(n.a)(this,this.yal,"requestWriteWaterline"),90,"29");this.wb.Hb(A)}}yal(){!this.ifb&&3E4<+xf.a.Ycc-+this.TLg&&(this.$Qh(),this.TLg=xf.a.Ycc)}$Qh(){const A=this.kag("savePPTDocLastViewedTimestamp");this.TGb.ka("SendBeaconOnRoamingRequestsIsEnabled")?this.Su.Yya(A,""):this.Wx(A,2,Object(n.a)(this,this.kJk,"onWriteWaterlineSucceeded"),Object(n.a)(this,this.jJk,"onWriteWaterlineFailed"))}kJk(A){let W=null;try{const na=A.data.ee;W=na?JSON.parse(na).Error:
"ErrorWriteRoamingEmptyResponseBody"}catch(na){W="ErrorWriteRoamingParseJsonResponseException",bd.a.J(572555921,3012,10,"OnWriteRoamingSucceeded() - Exception: "+na)}finally{W&&this.Qwg(W)}bd.a.J(572555922,3012,50,"OnWriteRoamingSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+A.data.wv-+A.data.OI,+A.data.iu-+A.data.OI)}jJk(A){this.Qwg("ErrorReadRoamingFailed");bd.a.J(572555923,3012,10,"OnWriteRoamingFailed() - Failure message: {0}",this.XHa.Nka(A))}kag(A){return this.ypk+String.format("RoamingServiceHandler.ashx?action={0}&{1}",
A,M.AFrameworkApplication.gh)}Wx(A,W,na,Ga){const Ka={};Ka["X-StatelessPopsAffinityRoutingEnabled"]=this.TGb.ka("PPTStatelessPOPSRequestAffinityEnabled").toString();this.Su.zj(A,W,null,Ka,!1,1,na,Ga,null,void 0,void 0,void 0,void 0,Jf.a("5"))}Qwg(A){bd.a.J(572555924,811,50,A)}}Object(h.a)(Fl,"PowerPointWaterlineUpdater",null,[]);class Cc{get name(){return"PowerPointWebEditor.Activity"}get jme(){return M.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",
!1)}init(){this.K.resolve("Common.IAppSettingsManager").ff(Object(n.a)(this,this.nSi,"delayedInit"))}Yb(A){this.K=A}dispose(){this.K=this.o6c=null}Trl(A){return!A||A.ka("IsAnonymousUser")?!1:A.ka("PPTCatchUpFlyoutIsEnabled")}nSi(){const A=this.K.resolve("Common.IAppSettingsManager");this.Trl(A)&&(Ai("Begin"),this.DWi(),this.cbk())}DWi(){uc.a.get_instance().Mj(7,()=>{Ai("ScriptDownload");Fe.a(this.K)("catchUpActivity").catch(()=>{bd.a.J(512262995,3012,10,"Failed to download catch-up script")}).then(()=>
this.kMj()).catch(()=>{bd.a.J(512262994,3012,10,"Failed to initialize shared catch-up code")})})}cbk(){bd.a.J(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");this.jme&&bd.a.J(526718752,3012,50,"ActivityFeedData is enabled")}kMj(){const A=new Hj(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventHandler")),W=this.K.resolve("Common.AFrameworkApplication");this.K.register(Fl,
"PowerPointWebEditor.Activity.PowerPointWaterlineUpdater").ma().oa(()=>new Fl(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),M.AFrameworkApplication.Me,this.K.resolve("PowerPointWebEditor.IApplicationSettings").roamingServiceHandlerWebServiceBase,this.K.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Common.IAppSettingsManager")));this.K.register(563,"Common.App.CatchUpActivity.IActivityContentManager").ma().oa(()=>new Of(this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(564,"Common.App.CatchUpActivity.IActivityNavigationManager").ma().oa(()=>new nj(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.IRibbonUser"),Ne.a.H_k,this.K.resolve("Common.App.CatchUpActivity.IActivityContentManager")));let na=null;this.K.resolve("PowerPointWebEditor.IApplicationSettings").yg&&
(na=this.K.resolve("Common.IAppSettingsManager").Ha("368")+"p");this.K.register(565,"Common.App.CatchUpActivity.IActivityRequestManager").ma().oa(()=>new zf(this.K.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.K.resolve("PowerPointWebEditor.Activity.PowerPointWaterlineUpdater"),A,this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler"),
this.K.resolve("Common.App.People.IUserProfilePictureUtilsV2"),this.K.resolve("Common.App.People.IPeopleColorUtils"),na));this.K.register(Dl,"PowerPointWebEditor.Activity.FlyoutRibbonButton").as("Common.App.CatchUpActivity.IFlyoutRibbonButton").ma().oa(()=>new Dl(W.aq,M.AFrameworkApplication.Ra,this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.App.CatchUpActivity.FloodgateEventLogger")));this.K.register(mj,"PowerPointWebEditor.Activity.FlyoutFocus").as("Common.App.CatchUpActivity.IFlyoutFocus").ma().oa(()=>
new mj(this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper")));this.K.register(566,"Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager").ma().oa(()=>new Nc(this.K.resolve("Common.IActionManagerExtended")));this.o6c=catchUpActivity.FactoryGlobal.getPowerPointCatchUpAppInstance(Object.assign(new $d,{activityContentManager:this.K.resolve("Common.App.CatchUpActivity.IActivityContentManager"),activityNavigationManager:this.K.resolve("Common.App.CatchUpActivity.IActivityNavigationManager"),
activityRequestManager:this.K.resolve("Common.App.CatchUpActivity.IActivityRequestManager"),dataCulture:M.AFrameworkApplication.dataCulture,emptyCatchUpBehaviorManager:this.jme?this.K.resolve("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager"):null,flyoutFocus:this.K.resolve("Common.App.CatchUpActivity.IFlyoutFocus"),flyoutRibbonButton:this.K.resolve("Common.App.CatchUpActivity.IFlyoutRibbonButton"),uiCulture:M.AFrameworkApplication.uiCulture,ulsLogger:new yd.a}));if(!this.o6c)return Promise.reject("Failure to create CatchUpApp");
this.K.resolve("PowerPointWebEditor.Activity.FlyoutRibbonButton").initialize();this.K.resolve("PowerPointWebEditor.Activity.FlyoutFocus").initialize();this.o6c.setWebpackPublicPath(M.AFrameworkApplication.Hpa);Ai("InitializeCatchUpApp");return this.o6c.initialize(Object.assign(new oe,{activityFeedDataEnabled:this.jme,featuredActivityGroupsEnabled:!1,summaryStringEnabled:!0})).then(()=>{this.K.resolve("PowerPointWebEditor.Activity.PowerPointWaterlineUpdater").initialize()})}static main(){Ia.a.instance.Ac(qd.a(new Cc,
0))}}Object(h.a)(Cc,"PPTWebEditorActivityPackage",null,[2,3]);var uo=d(747);class gn extends Sys.EventArgs{constructor(A,W){super();this.shape=A;this.nEa=W}}Object(h.a)(gn,"ShowHideStateChangedEventArgs",Sys.EventArgs,[]);class Lh{constructor(A,W,na,Ga,Ka,qb,Qb){this.Ve=null;this.ia=A;this.ta=W;this.AR=na;this.Tcd=Ga;this.Sb=Ka;this.Ic=qb;this.Agb=Qb}dispose(){this.Ve&&(this.Ve=null)}pe(){}vb(){this.ia.ya(fd.a.cIe,zh.a.application,Object(n.a)(this,this.rCj,"handleMarkAsRead"));this.ia.ya(fd.a.R1a,
zh.a.application,Object(n.a)(this,this.wFj,"handleShowHideChanges"));this.ia.ra(fd.a.vSe,Lc.a.application,Object(n.a)(this,this.ZDj,"handleQueryShowHideChanges"),96);this.ia.ra(fd.a.sud,zh.a.application,Object(n.a)(this,this.xFj,"handleShowRevisionTrackingWithUrlOverrides"),96)}rCj(A,W,na,Ga,Ka){if(1===na)return this.Sb.Cj()?32:8;A=new Date;if(!Ka)throw Error.argumentNull("actionData is null");if(Ka.SlideNode){if(Ka=Object(z.a)(118,Ka.SlideNode))bd.a.J(509654912,804,50,String.format("HandleMarkAsRead: Mark slide {0} as read",
Ka.slideIndex+1)),this.AR.Ncc?this.AR.Ofd(Ka,!0):(Ka.pX=A,this.AR.oUe(Ka))}else this.dIe(A);return 32}dIe(A){const W=this.ta.presentation;if(!W)throw Error.argumentNull("Presentation is null");this.Ve=xf.a.kk("MarkActivitiesAsRead",1);bd.a.J(509654883,804,50,"MarkAllSlidesAsRead: User marks slides as read via Ribbon button");this.AR.Ncc?this.AR.dIe():(Ig.b(W.slides||[],null,na=>{if(na=Object(z.a)(118,na))na.pX=A}),this.AR.jmh())}wFj(A,W,na,Ga,Ka){if(1===na)return this.Sb.Cj()?32:8;const qb=this.Sb.tn;
A=this.ta.Ba;if(!(qb&&A&&A.isConnected&&Ka))return 16;na=W=!1;switch(Ka.ShowRevisionTrackingStatus){case 0:na=W=!1;break;case 2:W=!0;na=!1;break;case 3:na=W=!0;break;case 1:W=qb.nEa&&!this.AR.iZd?!0:!qb.nEa;na=!0;break;default:return 8}if(this.AR.iZd&&!na)return 32;Ka=Ka.InvokeSource;qb.nEa=W;this.AR.iZd=W&&na;na&&this.Agb.Ick(Ka,W);Ka=A.Uj();Ig.b(Ka,null,Qb=>{this.Tcd.GZk(new gn(Qb,qb.nEa))});this.Ic.Py(new uj.a(1));return 32}ZDj(A,W,na,Ga,Ka){A=this.Sb.tn;if(!A)return 16;Ka.Hf(A.nEa);return 32}xFj(A,
W,na,Ga,Ka){A=this.ta.presentation;if(!Ka||!A||!A.slides)return 8;Ka=Ka.timestamp;if(!Ka)return 8;for(const qb of A.slides)Object(z.a)(118,qb).pX=Ka;this.AR.pUe(A.slides);return 32}}Object(h.a)(Lh,"RevisionTrackingActor",null,[251,107]);class uh{constructor(A){this.backgroundColor=this.foregroundColor=null;A&&A.isInHighContrastMode&&A.highContrastColors?(this.foregroundColor=A.highContrastColors.foregroundTextColor||"#006BFF",this.backgroundColor=A.highContrastColors.backgroundColor||"#006BFF"):this.backgroundColor=
this.foregroundColor="#006BFF"}}Object(h.a)(uh,"RevisionTrackingColorProvider",null,[]);class Wi{constructor(){this.xa=new ch.a}KZk(A){this.xa.raiseEvent("SlideUSC",A)}pJc(A){this.xa.addHandler("SlideUSC",A)}JVe(A){this.xa.removeHandler("SlideUSC",A)}nZk(A){this.xa.raiseEvent("ShapeUSC",A)}$hi(A){this.xa.addHandler("ShapeUSC",A)}R8k(A){this.xa.removeHandler("ShapeUSC",A)}GZk(A){this.xa.raiseEvent("ShowHideSC",A)}kii(A){this.xa.addHandler("ShowHideSC",A)}Y8k(A){this.xa.removeHandler("ShowHideSC",A)}}
Object(h.a)(Wi,"RevisionTrackingEventSource",null,[663,664,665]);class tm extends Sys.EventArgs{constructor(A,W){super();this.shape=A;this.slide=W}}Object(h.a)(tm,"ShapeUnreadStateChangedEventArgs",Sys.EventArgs,[]);class Dk{constructor(){this.cid=this.sid=0}}Object(h.a)(Dk,"Slide",null,[]);class Va{constructor(A,W){this.dt=this.mk=null;this.mk=Object.assign(new Dk,{sid:A.sid,cid:A.cid});this.dt=W}}Object(h.a)(Va,"SlideLastViewedVersion",null,[]);class vh{constructor(){this.v=0;this.lv=this.defLv=
null;this.v=1}}Object(h.a)(vh,"SlideLastViewedVersions",null,[]);class Ol extends Sys.EventArgs{constructor(A){super();this.slide=A}}Object(h.a)(Ol,"SlideUnreadStateChangedEventArgs",Sys.EventArgs,[]);class hn{constructor(A,W,na,Ga,Ka,qb,Qb,t,Y,pa,Ja,Ya,jb,Sb,kc,db){this.$db=this.Fdb=null;this.SDg=!1;this.Yze=null;this.X$c=0;this.nFb=this.yhc=null;this.YDe=[];this.gcd=null;this.sdd=!1;this.pya=null;this.zfe=this.yfe=this.iZd=!1;bd.a.J(512262749,804,50,"Start RevisionTrackingManager::RevisionTrackingManager()");
this.hFe=A;this.ta=W;this.wb=na;this.jc=Ga;this.Sb=Ka;this.nd=qb;this.Hkc=Qb;this.Mc=t;this.el=Y;this.Tcd=Ja;this.QYg=pa;this.Jb=jb;this.ftk=Ya.pptEditingRevisionTrackingWriteRoamingCacheIntervalMs;this.$Jg=Ya.a2j;this.hZg=!0;this.KH=!1;this.KIa=new zd.a;this.Mc.nJc(Object(n.a)(this,this.soa,"onSessionAccessTokenExpired"));M.AFrameworkApplication.jA&&this.Mc.sJc(Object(n.a)(this,this.kga,"onWopiTokenRefreshed"));this.Jb.ff(()=>{this.yfe=!0;this.initialize();this.jmh();this.yfe=!1});this.Agb=Sb;this.Gb=
kc;this.tqk=db}get Ncc(){return Rg.a("WriteSlideLastViewedVersionsOnRead")}dispose(){this.Fdb&&(this.nd.Uoa(Object(n.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.nd.ipd(Object(n.a)(this,this.Rxa,"onShapeViewElementAdded")),this.Hkc.sVe(Object(n.a)(this,this.kib,"onMarkedUndo")),this.Mc.gpd(Object(n.a)(this,this.RJa,"onBeforeSessionEnd")),this.Mc.Laa(Object(n.a)(this,this.OM,"onSessionClosed")),this.Mc.zga(Object(n.a)(this,this.Mo,"onSessionRehydrated")),this.el.b9k(Object(n.a)(this,
this.obh,"onSlideChangesDataChanged")),this.el.I8k(Object(n.a)(this,this.nah,"onPresentationLastModifiedTimeReceived")),this.$Jg&&this.QYg.Om(Object(n.a)(this,this.bbh,"onShapePropertyChanged")),this.Mc.gph(Object(n.a)(this,this.soa,"onSessionAccessTokenExpired")))}initialize(){bd.a.J(512262748,804,50,"Start RevisionTrackingManager::Initialize()");this.Yze=new Date;this.X$c=this.Yze.getTime();this.jjl();this.nd.aT(Object(n.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.nd.Msb(Object(n.a)(this,
this.Rxa,"onShapeViewElementAdded"));this.Hkc.A_b(Object(n.a)(this,this.kib,"onMarkedUndo"));this.Mc.CCa(Object(n.a)(this,this.RJa,"onBeforeSessionEnd"));this.Mc.GC(Object(n.a)(this,this.OM,"onSessionClosed"));this.Mc.HC(Object(n.a)(this,this.Mo,"onSessionRehydrated"));this.el.qii(Object(n.a)(this,this.obh,"onSlideChangesDataChanged"));this.el.Ghi(Object(n.a)(this,this.nah,"onPresentationLastModifiedTimeReceived"));this.$Jg&&this.QYg.fk(Object(n.a)(this,this.bbh,"onShapePropertyChanged"));this.pya=
this.ta.Ba;this.$db=this.dfj();this.getSlideLastViewedVersions();const A=new be.a(3,2,this.ftk,()=>{this.getSlideLastViewedVersions()},90,"12");this.wb.Hb(A)}onActiveSlideDomReady(A,W){A=Object(z.a)(118,W.Ba);this.pya&&A!==this.pya&&this.Y0e()&&(this.pya.isConnected&&(this.pya.isUnread&&this.Ofd(this.pya,!0),!this.Ncc&&this.pya.changesData&&(this.pya.pX=this.pya.changesData.dtField)),A&&A.isUnread&&this.tmh(A));this.pya=A;this.X$c=Date.now()}kib(A,W){W.actionId!==de.a.lVa&&W.dBb&&(A=this.ta.Ba)&&
A.isConnected&&A.isUnread&&this.Y0e()&&this.Ofd(A,!0)}RJa(){this.Y0e()&&this.JMl();this.Hzd()}OM(){this.Agb.log();this.KH=!0}Mo(){this.KH=!1;this.yhc&&this.MMh(this.yhc)}MMh(A){var W=this.ta.presentation;if(!W)throw Error.argumentNull("Presentation is null");W=W.slides||[];0<W.length&&(this.tQl(W,A),this.pUe(W))}sGk(A){this.zfe=!0;bd.a.J(512262747,804,50,"OnReceiveLastViewedVersionInfo()");A&&(this.KIa=new zd.a,this.forEach(A.lv,Ga=>{const Ka=Ga.mk.sid;(!this.KIa.Fb(Ka)||this.KIa.ga(Ka).dt<Ga.dt)&&
this.KIa.$(Ka,Ga)}));const W=xf.a.Ycc;let na=!1;this.nFb&&this.hFe.w6j&&W!==this.nFb&&(this.yhc&&C.c(this.p3f())===C.c(this.yhc)||(na=!0));A&&A.defLv&&(this.$db=A.defLv,this.hZg=!1,A.lv&&0<A.lv.length&&this.MMh(A));na&&this.Hzd();this.nFb=xf.a.Ycc;this.zfe=!1}obh(A,W){this.forEach(W.slides,na=>{this.Fme(na.changesData)||(this.ta.Ba&&na.Db!==this.ta.Ba.Db||this.$Hj(Object(z.a)(118,na)))&&this.oUe(Object(z.a)(118,na))})}nah(A,W){this.hZg&&(this.$db=W.ZSk)}bbh(A,W){A=W.property;W=Object(z.a)(4,W.node);
A===Eg.a.DMb&&(A=this.jc.mg(W),A===this.ta.Ba&&A.isUnread&&W.changesData.dtField<=A.changesData.dtField&&(bd.a.J(512262746,804,50,"Trying to highlight a shape in active slide, time elapsed after last slide navigation: {0}ms",Date.now()-this.X$c),this.nUe(this.ta.Ba,W)))}Rxa(A,W){A=W.$w.shapeNode;this.ta.Ba.isUnread&&this.vGa(this.ta.Ba.Db,A)&&!this.Fme(A.changesData)&&(this.YDe.push(A),this.gcd||(this.gcd=new be.a(2,1,0,Object(n.a)(this,this.tryHighlightInsertedShapes,"tryHighlightInsertedShapes"),
90,"13"),this.wb.Hb(this.gcd)))}getSlideLastViewedVersions(){this.KH||this.sdd||this.hFe.getSlideLastViewedVersionInfo(Object(n.a)(this,this.sGk,"onReceiveLastViewedVersionInfo"))}Hzd(){if(!this.KH&&!this.sdd){var A=this.p3f();this.hFe.putSlideLastViewedVersionInfo(A);this.yhc=A}}p3f(){const A=this.ta.presentation;if(!A)throw Error.argumentNull("Presentation is null");const W=Object.assign(new vh,{defLv:this.$db}),na=[];this.forEach(A.slides||[],Ga=>{Ga=Ga.Db;const Ka=this.Sb.Zk(Ga);Ka&&Ka.pX&&(!Ga.cid&&
this.KIa.Fb(Ga.sid)?Ga=ah.a.Uy(Ga.sid,this.KIa.ga(Ga.sid).mk.cid):Ga.cid&&this.KIa.Fb(Ga.sid)&&Ga.cid!==this.KIa.ga(Ga.sid).mk.cid&&bd.a.J(512262745,804,50,"The same sid {0} has different cid. Roaming cid:{1}, Slide node cid:{2}",Ga.sid,this.KIa.ga(Ga.sid),Ga.cid),na.push(new Va(Ga,Ka.pX)))});W.lv=na;return W}tQl(A,W){const na=W.lv;this.forEach(A,Ga=>{const Ka=Object(z.a)(118,Ga);this.forEach(na,qb=>{Ka&&this.dni(Ka,qb.mk)&&(!Ka.pX||Ka.pX<qb.dt)&&(Ka.pX=qb.dt)})})}dni(A,W){return A.cid&&W.cid?A.sid===
W.sid&&A.cid===W.cid:A.sid===W.sid}pUe(A){this.forEach(A,W=>{this.oUe(Object(z.a)(118,W))})}jmh(){var A=this.ta.presentation;if(!A)throw Error.argumentNull("Presentation is null");A=A.slides||[];0<A.length&&this.pUe(A)}tmh(A){this.tQh(A,W=>{this.nUe(A,W)})}oUe(A){if(A&&A.isConnected&&A.changesData){const W=this.r0c(A.changesData,this.$Vc(A));W!==A.isUnread&&(this.T2g(A,W),this.BKl(),A===this.ta.Ba&&this.tmh(A))}}nUe(A,W){if(W&&W.isConnected&&W.Ua(Eg.a.DMb)){const na=this.r0c(W.changesData,this.$Vc(A));
this.R2g(A,W,na)}}R2g(A,W,na){na!==W.isUnread&&(bd.a.J(512262744,804,50,"Shape unread state changed: {0} -> {1}",W.isUnread,na),W.isUnread=na,this.Tcd.nZk(new tm(W,A)))}T2g(A,W){W!==A.isUnread&&(bd.a.J(512262743,804,50,"Slide unread state changed: {0} -> {1}, SlideId={2}",A.isUnread,W,A.Db.toString()),A.isUnread=W,this.Tcd.KZk(new Ol(A)))}Ofd(A,W){if(this.Ncc){if(!A)throw Error.argumentNull("ISlideNode is null");this.sQl(A);bd.a.J(509654915,804,50,"MarkSlideAsRead - SlideId={0}, isUnread={1}, writeToRoaming={2}",
A.Db.toString(),A.isUnread,W);if(!A.isUnread)return!1}this.tQh(A,na=>{this.R2g(A,na,!1)});this.T2g(A,!1);this.Ncc&&W&&this.Hzd();return!0}dIe(){const A=this.ta.presentation;if(!A)throw Error.argumentNull("Presentation is null");let W=!1;this.forEach(A.slides,na=>{na=this.Ofd(Object(z.a)(118,na),!1);W||(W=na)});bd.a.J(509654914,804,50,"MarkAllSlidesAsRead - requiresWriteToRoaming={0}",W);W&&this.Hzd()}tQh(A,W){A&&(A=A.Uj(),this.forEach(A,na=>{W(na)}))}forEach(A,W){Ig.b(A,null,W)}Fme(A){return ea(A,
this.Fdb)}r0c(A,W){return!!A&&!!A.dtField&&!this.Fme(A)&&A.dtField>W}dfj(){const A=this.Sb.tn;if(A&&A.nQe)return A.nQe;bd.a.J(512262742,808,50,"GetDefaultLastViewedTime - No PresLastModifiedTime");return new Date}Mmg(A){const W=Object(z.a)(118,this.tqk.gbg(A));return W&&W.isUnread&&A&&this.r0c(A.changesData,this.$Vc(W))}jjl(){this.Fdb=new bl(this.Jb.Ha("UserName"),this.Jb.Ha("387"),this.Jb.Ha("388"))}sQl(A){A.pX=A&&A.changesData?A.changesData.dtField:this.$db}JMl(){const A=this.ta.Ba;A&&(A.pX=A.changesData?
A.changesData.dtField:this.$db)}$Vc(A){return A.pX||this.$db}BKl(){this.SDg||(this.SDg=!0,bd.a.J(512262741,804,50,"First revision tracking view render completed!"))}$Hj(A){return A.isConnected&&A.changesData&&A.changesData.dtField?A.changesData.dtField<=this.Yze&&this.r0c(A.changesData,this.$Vc(A)):!1}vGa(A,W){return A.equals(W.slideId)}tryHighlightInsertedShapes(){bd.a.J(512262740,804,50,"Trying to highlight inserted shapes on active slide, time elapsed after last slide navigation: {0}ms",Date.now()-
this.X$c);this.gcd=null;const A=this.ta.Ba;if(A&&A.isUnread){const W=A.Db;for(const na of this.YDe)this.vGa(W,na)&&this.nUe(A,na)}Array.clear(this.YDe)}soa(){this.sdd=!0}kga(A,W){try{W.p3c?(bd.a.J(512262739,804,50,"RevisionTrackingManager::OnWopiTokenRefreshed Token refresh succeeded."),this.sdd=!1):bd.a.J(512262738,804,15,"RevisionTrackingManager::OnWopiTokenRefreshed Token refresh failed.")}catch(na){bd.a.J(512262737,804,10,"RevisionTrackingManager::OnWopiTokenRefreshed Exception: {0}",na)}}Y0e(){return 1!==
this.Gb.ol}}Object(h.a)(hn,"RevisionTrackingManager",null,[]);class Ij{constructor(A,W,na,Ga,Ka,qb,Qb,t,Y,pa,Ja){this.ta=A;this.Sb=W;this.eFe=na;this.nd=Ga;this.V0=Ka;this.Ga=qb;this.y6c=Qb;this.dhb=t;this.We=Y;this.RHa=pa;this.Ijk=Ja;this.dOg=!1;this.nd.Nsb(Object(n.a)(this,this.uch,"onVisibleThumbnailRangeChanged"));this.nd.qJc(Object(n.a)(this,this.Txa,"onThumbnailRefresh"));this.nd.dii(Object(n.a)(this,this.abh,"onShapePresenceStateChanged"));this.nd.Dii(Object(n.a)(this,this.ech,"onThumbnailPresenceStateChanged"));
this.nd.jhi(Object(n.a)(this,this.LHk,"onShapeViewElementShowRevisionTrackingHint"));this.nd.ghi(Object(n.a)(this,this.EHk,"onShapeViewElementHideRevisionTrackingHint"));this.V0.pJc(Object(n.a)(this,this.$Ja,"onSlideUnreadStateChanged"));this.V0.$hi(Object(n.a)(this,this.gbh,"onShapeUnreadStateChanged"));this.V0.kii(Object(n.a)(this,this.jbh,"onShowHideStateChanged"))}dispose(){this.nd.qph(Object(n.a)(this,this.uch,"onVisibleThumbnailRangeChanged"));this.nd.LVe(Object(n.a)(this,this.Txa,"onThumbnailRefresh"));
this.nd.U8k(Object(n.a)(this,this.abh,"onShapePresenceStateChanged"));this.nd.j9k(Object(n.a)(this,this.ech,"onThumbnailPresenceStateChanged"));this.V0.JVe(Object(n.a)(this,this.$Ja,"onSlideUnreadStateChanged"));this.V0.R8k(Object(n.a)(this,this.gbh,"onShapeUnreadStateChanged"));this.V0.Y8k(Object(n.a)(this,this.jbh,"onShowHideStateChanged"))}uch(){const A=this.ta.presentation;if(!A)throw Error.argumentNull("Presentation is null");Ig.b(A.slides||[],null,W=>{(W=this.Sb.Zk(W.Db))&&W.isUnread&&this.u2e(W)})}Txa(A,
W){A=this.Sb.Zk(W.IIh);A.isUnread&&this.u2e(A)}$Ja(A,W){A=W.slide;A.isUnread?this.u2e(A):this.O6k(A)}gbh(A,W){A=W.shape;W=W.slide;A&&(A.isUnread?W===this.ta.Ba&&this.q2e(A):this.jVe(A))}abh(A,W){A=W.shape;A.Es?this.jVe(A):A.isUnread&&this.q2e(A,!0)}ech(A,W){A=W.slide;A.Es&&!this.t1e?this.V6k(A):A.isUnread&&this.yxl(A)}jbh(A,W){A=W.shape;W.nEa&&A.isUnread?this.q2e(A):this.jVe(A)}get t1e(){return this.Ijk}u2e(A){A&&A.isConnected&&this.Hyd(A,W=>{W.NCh();A.Es&&!this.t1e||this.kyf(W)})}O6k(A){A&&A.isConnected&&
this.Hyd(A,W=>{W.boh();W.gVe()})}yxl(A){A.Es&&!this.t1e||this.Hyd(A,Object(n.a)(this,this.kyf,"addRevisionTrackingPawnForThumbnail"))}V6k(A){this.Hyd(A,W=>{W.gVe()})}bBh(){const A=this.Sb.tn;return!this.RHa||this.RHa&&A.nEa}q2e(A,W=!1){this.bBh()&&!A.Es&&A.Ua(Eg.a.DMb)&&(Object(z.a)(119,A.qc(this.We))?(this.eFe.ZI(A).display(()=>this.Ga.QWc(A)),this.fKl(),bd.a.J(23606109,804,50,"ShowShapeRevisionTrackingView(), IsTriggeredByPresenceUpdate={0}",W)):bd.a.J(23606111,804,50,"ShowShapeRevisionTrackingView() failed, no shape view element created"))}jVe(A){const W=
this.eFe.dJ(A);W?W.dismiss():this.bBh()&&A.isUnread&&bd.a.J(23606113,804,50,"RemoveShapeRevisionTrackingView() failed, a revision tracking view is expected but not found")}Hyd(A,W){A&&((A=Object(z.a)(662,A.tg(this.dhb)))?W(A):bd.a.J(23606115,804,50,"UpdateThumbnailRevisionTrackingView() failed, no thumbnail view element found"))}kyf(A){A.ASd(this.y6c.backgroundColor,ResourceStrings.l_RevisionTracking_Slide_Has_Unread_Changes)}LHk(A,W){this.KOh(W.$w.shapeNode,!0)}EHk(A,W){this.KOh(W.$w.shapeNode,!1)}KOh(A,
W){(A=this.eFe.dJ(A))&&(W?A.Q1a():A.fea())}fKl(){this.dOg||(this.dOg=!0,Ud.c(sa.a.Ixi))}}Object(h.a)(Ij,"RevisionTrackingPresenter",null,[]);class Mk{APf(){const A=new Rj.a;A.ah(10,10);A.xpa("0 0 10 10");A.va.setAttribute("class","ModernRevisionTrackingIconSVG");const W=new Ck.a;W.QY("M1,5 a4,4 0 1,0 8,0 a4,4 0 1,0 -8,0");W.va.setAttribute("class","ModernRevisionTrackingIconPath");A.appendChild(W);return A.va}}Object(h.a)(Mk,"RevisionTrackingSVGProvider",null,[561]);class ig{constructor(){this.Ucd=
this.Oed=this.Ned=this.lDe=0}kdk(){this.Oed+=1}Ick(A,W){switch(A){case 2:W&&(this.Ned+=1);break;case 0:W?(this.Ucd+=1,bd.a.J(39068549,804,50,"HandleShowHideChanges: User enables detailed highlight via Ribbon button")):bd.a.J(39068551,804,50,"HandleShowHideChanges: User disables detailed highlight via Ribbon button");break;case 1:W&&(this.lDe+=1)}}log(){bd.a.J(39068553,804,15,"WYWA Notification Clicks:{0}; Thumbnail Revision Tracking Pawn Clicks: {1}; Thumbnail Revision Tracking Pawn Hovers: {2}; Show Hide Changes Ribbon Clicks:{3};",
this.lDe,this.Ned,this.Oed,this.Ucd);0<this.Ned+this.Oed+this.Ucd&&Ud.c(sa.a.KIf)}}Object(h.a)(ig,"RevisionTrackingTelemetry",null,[]);var Dh=d(1306),zb=d(1186),dj=d(78),am=d(584);class um{constructor(A,W,na,Ga,Ka){this.Cdb=null;this.JIa=A;this.Agb=W;this.nc=Ka;this.Tb=na;this.pa=Ga;this.JIa.g8(Object(n.a)(this,this.sY,"onInteractivityChanged"))}dispose(){this.JIa&&this.JIa.dispose();this.Cdb=this.JIa=null}display(A,W){this.Cdb||(this.Cdb=new am.a);this.Cdb.color=A;this.Cdb.userName=W;this.JIa.kB(this.Cdb)}dismiss(){this.JIa.nP(this.Cdb.clientId)}Q1a(){this.JIa.aMa()}fea(){this.JIa.eMa()}get zVd(){const A=
this.JIa.xKb;return 0<A.length?A[0]:null}sY(A,W){A={InvokeSource:2,ShowRevisionTrackingStatus:null};1===W.type?(this.Tb.Ba!==this.nc?(this.nc&&(this.Tb.Ba=this.nc,this.pa.au()),A.ShowRevisionTrackingStatus=3):A.ShowRevisionTrackingStatus=1,M.AFrameworkApplication.Ra.Ka(fd.a.R1a,2,A)):2===W.type?this.nc&&this.Tb.Ba===this.nc&&(A.ShowRevisionTrackingStatus=2,M.AFrameworkApplication.Ra.Ka(fd.a.R1a,2,A),this.Agb.kdk()):3===W.type&&this.nc&&this.Tb.Ba===this.nc&&(A.ShowRevisionTrackingStatus=0,M.AFrameworkApplication.Ra.Ka(fd.a.R1a,
2,A))}}Object(h.a)(um,"ThumbnailRevisionTrackingPawn",null,[689,107]);d(296);class pl{constructor(A,W,na,Ga,Ka,qb){this.$e=A;A=dj.getImageClassWithCluster("pegal","UnreadNotification_16x16x32");W=W.qk("pegal.png");na=na.APf();this.qok=this.wPi(M.AFrameworkApplication.isRtl,A,W,na);this.Agb=Ga;this.Tb=Ka;this.pa=qb}kNi(A,W){return new um(this.qok.h3b(A),this.Agb,this.Tb,this.pa,W)}Pc(A){return this.$e.Pc(A)}wPi(A,W,na,Ga){const Ka=new Dh.a;Ka.add(1,W);Ka.add(4,na);Ka.add(6,16);Ka.add(8,A);Ka.add(12,
2);Ka.add(11,!1);Ka.add(14,Ga);return new zb.a(Ka)}}Object(h.a)(pl,"RevisionTrackingThumbnailGadgetsFactory",null,[560]);class vm{constructor(A,W,na){this.T9c=this.rhc=!0;this.Su=A;this.XHa=W;this.la=na}get w6j(){return this.rhc}getSlideLastViewedVersionInfo(A){if(this.T9c){bd.a.J(25203102,824,50,"GetSlideLastViewedVersionInfo(), Start sending read request to FE at [{0}]",JSON.stringify(new Date));var W=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}",
"getPPTSlideLastViewedMetadata",M.AFrameworkApplication.gh),na={};na["X-StatelessPopsAffinityRoutingEnabled"]=this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.Su.zj(W,1,null,na,!1,2,Object(n.a)(this,this.MDk,"onGetVersionInfoSucceeded"),Object(n.a)(this,this.LDk,"onGetVersionInfoFailed"),A,void 0,void 0,void 0,void 0,Jf.a("12"));this.T9c=!1}else bd.a.J(25203100,824,50,"Response of previous get roaming request is not back yet.")}putSlideLastViewedVersionInfo(A){if(this.rhc){bd.a.J(25203106,
824,50,"PutSlideLastViewedVersionInfo(), Start sending write request to FE");var W=C.c(A),na=this.la.pptRevisionTrackingMaxRoamingDataSizeInBytes;if(W.length>na)bd.a.J(25203136,824,50,"Roaming data size is bigger than the limitation, won't write to roaming service, slideNum={0}, dataSize={1}, sizeLimitation={2}",A.lv.length,W.length,na);else{na=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","savePPTSlideLastViewedMetadata",M.AFrameworkApplication.gh);
if(M.AFrameworkApplication.fa.ka("SendBeaconOnRoamingRequestsIsEnabled"))this.Su.Yya(na,W);else{const Ga={};Ga["X-StatelessPopsAffinityRoutingEnabled"]=this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.Su.zj(na,2,W,Ga,!1,2,Object(n.a)(this,this.kGk,"onPutVersionInfoSucceeded"),Object(n.a)(this,this.jGk,"onPutVersionInfoFailed"),A.lv.length,void 0,void 0,void 0,void 0,Jf.a("13"))}this.rhc=!1}}else bd.a.J(25203104,824,50,"Response of previous write roaming request is not back yet.")}dispose(){}MDk(A){this.T9c=
!0;let W=0;try{let na=null;A.data.ee&&0<A.data.ee.trim().length&&(W=A.data.ee.length,na=JSON.parse(A.data.ee,Object(n.a)(this,this.L6j,"jsonDateReviver")));const Ga=A.data.state;Ga(na)}catch(na){bd.a.J(23132289,824,10,"OnGetVersionInfoSucceeded catched exception: {0}",na.toString())}A=String.format("OnGetVersionInfoSucceeded, responseSize={0}, EnqueueTime={1}, InvokedTime={2}, CompletedTime={3}",W,JSON.stringify(A.data.OI),JSON.stringify(A.data.iu),JSON.stringify(A.data.wv));bd.a.J(25203139,824,50,
A)}LDk(A){this.T9c=!0;A=this.XHa.Nka(A);bd.a.J(23132291,824,50,"OnGetVersionInfoFailed: Web service failed with {0}",A)}kGk(A){this.rhc=!0;bd.a.J(25203142,824,50,"OnPutVersionInfoSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+A.data.wv-+A.data.OI,+A.data.iu-+A.data.OI)}jGk(A){this.rhc=!0;const W=this.XHa.Nka(A);bd.a.J(23132293,824,50,"OnPutVersionInfoFailed: Web service failed with {0}, NumSlides={1}",W,A.data.state)}L6j(A,W){return"dt"===A||"defLv"===A?new Date(W):W}}Object(h.a)(vm,"RoamingCacheProxy",
null,[559,107]);var Sf=d(995),bm=d(124);class Vn{constructor(A,W,na){this.Eg=A;this.QJ=Object(z.a)(Sf.a,this.Eg.szh);this.y6c=W;this.Xqk=na;this.Eg.Kpg=!0}display(A){let W;W=this.Xqk.APf();this.QJ.Adi(this.y6c.backgroundColor,A,W);this.Eg.QQb(this.y6c.foregroundColor);this.Eg.setVisibility()}dismiss(){this.QJ.clear();this.Eg.QQb(bm.a.none);this.Eg.setVisibility()}xm(A){this.Eg.xm(A)}iC(A){this.Eg.iC(A)}Mp(){return this.Eg.Mp()}KL(A){return this.Eg.EAb(A)}Xw(A){this.Eg.Xw(A)}dispose(){this.Eg.dispose()}my(){this.Eg.my()}aD(A){return this.Eg.aD(A)}QA(A){return this.Eg.QA(A)}draw(A,
W){this.Eg.draw(A,W)}get visible(){return this.Eg.visible}set visible(A){this.Eg.visible=A}setPosition(A,W){this.Eg.setPosition(A,W)}Ij(A){this.Eg.Ij(A)}vq(A){this.Eg.vq(A)}Eu(A){this.Eg.Eu(A)}setZIndex(A){this.Eg.setZIndex(A)}JD(A,W){this.Eg.JD(A,W)}Q1a(){this.QJ.Q1a()}fea(){this.QJ.fea()}setSelection(){}}Object(h.a)(Vn,"ShapeRevisionTrackingView",null,[592,239,240,107]);class sg{constructor(){this.K=null;this.RHa=this.PEb=this.KO=this.h5=!1}get name(){return"PowerPointWebEditor.RevisionTracking"}init(){}Yb(A){this.K=
A;A.resolve("Common.IAppSettingsManager").ff(()=>{this.KO=A.resolve("PowerPointWebEditor.IApplicationContext").rd.yg;this.PEb=A.resolve("PowerPointWebEditor.IApplicationContext").rd.L0j;this.h5=A.resolve("PowerPointWebEditor.IApplicationContext").rd.Lpe;this.RHa=A.resolve("PowerPointWebEditor.IApplicationContext").rd.Koe;this.register();this.resolve()})}dispose(){this.h5&&(this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager").dispose(),this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter").dispose(),
this.K.resolve("PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy").dispose())}register(){const A=this.K;this.KO&&this.PEb&&A.register(uo.a,"PowerPointWebEditor.PodsInfoSender").ma().oa(()=>new uo.a(M.AFrameworkApplication.Me,A.resolve("PowerPointWebEditor.ISessionInfoOwner"),A.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),A.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),A.resolve("PowerPointWebEditor.IErrorHandler"),A.resolve("Common.ITaskManager"),A.resolve("Common.IAppSettingsManager")));
this.h5&&(A.register(ig,"RevisionTrackingTelemetry").ma().oa(()=>new ig),A.register(hn,"PowerPointWebEditor.RevisionTracking.RevisionTrackingManager").ma().oa(()=>new hn(A.resolve("PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy"),A.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),A.resolve("Common.ITaskManager"),A.resolve("PowerPointWebEditor.ISlideReader"),A.resolve("PowerPointWebEditor.IPresentationReader"),A.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
A.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),A.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),A.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),A.resolve("Box4.Graph.IGraphInstance").yd(10),A.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventSource"),A.resolve("PowerPointWebEditor.IApplicationSettings"),A.resolve("Common.IAppSettingsManager"),A.resolve("RevisionTrackingTelemetry"),A.resolve("PowerPointWebEditor.View.IPPTPageView"),A.resolve("PowerPointWebEditor.Graph.SlideNodeHelper"))),
A.register(Ij,"PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter").ma().oa(()=>new Ij(A.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),A.resolve("PowerPointWebEditor.IPresentationReader"),A.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeRevisionTrackingView>"),A.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),A.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers"),A.resolve("PowerPointWebEditor.IShapeReader"),
A.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider"),A.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Na,A.resolve("Box4.IPageView").Na,A.resolve("PowerPointWebEditor.IApplicationSettings").Koe,A.resolve("Common.IAppSettingsManager").ka("PPTCanvasPresenceBubbleUXEnabled"))),A.register(559,"PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy").ma().oa(()=>new vm(M.AFrameworkApplication.Me,A.resolve("PowerPointWebEditor.IJsonpHelperManager"),A.resolve("PowerPointWebEditor.IApplicationSettings"))),
A.register(560,"PowerPointWebEditor.RevisionTracking.IRevisionTrackingThumbnailGadgetsFactory").ma().oa(()=>new pl(A.resolve("PowerPoint.IBrowserHelperManager"),A.resolve("PowerPoint.IPathManager"),A.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider"),A.resolve("RevisionTrackingTelemetry"),A.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),A.resolve("PowerPointWebEditor.IPptSelectionManager"))),A.register(Wi,"PowerPointWebEditor.RevisionTracking.RevisionTrackingEventSource").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventSource").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventNotifier").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers").ma().oa(()=>
new Wi),A.register(191,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeRevisionTrackingView>").ma().oa(()=>new ie.a((W,na)=>{let Ga=null;const Ka=Object(z.a)(119,W.qc(A.resolve("Box4.IPageView").Na));Ka&&!Ka.Nl&&(W=A.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").s1d(A.resolve("PowerPointWebEditor.IPptSelectionManager"),(qb,Qb,t)=>A.resolve("PowerPointWebEditor.ShapePresence.IShapePawnFactory").rOi(qb,Qb,t,A.resolve("PowerPointWebEditor.Core.ICoreEventHandler")),
W,na,Ka.hV),Ga=new Vn(W,A.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider"),A.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider")),Ga.xm(Ka.hV),Ka.Yra(Ga,1),Ga.visible=Ka.OQ||Ka.io);return Ga})),A.register(uh,"PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider").ma().oa(()=>new uh(A.resolve("Common.Utils.IHighContrastDetector"))),A.register(561,"PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider").ma().oa(()=>new Mk),
this.KO&&this.RHa&&A.register(Lh,"PowerPointWebEditor.RevisionTracking.RevisionTrackingActor").ma().oa(()=>new Lh(A.resolve("Common.IActionManagerExtended"),A.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),A.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),A.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventNotifier"),A.resolve("PowerPointWebEditor.IPresentationReader"),A.resolve("PowerPointWebEditor.View.IViewEventSource"),A.resolve("RevisionTrackingTelemetry"))))}resolve(){this.KO&&
this.PEb&&this.K.resolve("PowerPointWebEditor.PodsInfoSender");if(this.h5&&(this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter"),this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),this.K.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingThumbnailGadgetsFactory"),this.RHa)){const A=this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingActor");A.vb();A.pe()}}static main(){Ia.a.instance.Ac(qd.a(new sg,0))}}Object(h.a)(sg,
"PPTWebEditorRevisionTrackingPackage",null,[2,3]);var nf=d(412),Jj=d(209),If=d(131);class Je{constructor(A){this.gQa=[de.a.lvc,de.a.mvc,de.a.nvc,de.a.ovc,de.a.pvc];this.Aef=A}p6f(A){return this.Aef?this.Aef.$Uc(A.Va):null}create(A){return A?(A=this.s3b(A))?If.m(A):"":""}HKi(A){A=A.suggestions;if(!A||!A.count)return null;A=({ySf:W}=this.fPi(A)).returnValue;var W=Je.KLi(W);const na=Object.assign(new nf.a,{ExternalId:"DictationCorrectionMenu",Command:"798637440",LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsFlyoutTitle,
Image16by16Class:dj.getImageClassWithCluster(M.AFrameworkApplication.cO,Je.mUi),Image16by16:M.AFrameworkApplication.Cm,Menu:Object.assign(new sh.a,{ExternalId:"DictationCorrectionSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,MenuSectionList:[]})});A&&Array.add(na.Menu.MenuSectionList,A);Array.add(na.Menu.MenuSectionList,W);return na}fPi(A){let W;const na=Object.assign(new Sh.a,{Id:"DictationCorrectionSuggestions",ControlList:[],ControlsId:"DictationCorrectionSuggestionsControls",Title:Box4Intl.Box4Strings.L_DictationCorrectionsGroupTitle});
W=null;for(let Ga=0,Ka=Math.min(this.gQa.length,A.count);Ga<Ka;++Ga){if(!W&&""===A.ga(Ga).suggestion){W=this.gQa[Ga].toString();continue}const qb=Object.assign(new Jj.a,{ExternalId:"btnDictationCorrectionSuggestion"+Ga,Command:this.gQa[Ga].toString(),LabelText:A.ga(Ga).suggestion});Array.add(na.ControlList,qb)}return na.ControlList.length?{returnValue:na,ySf:W}:{returnValue:null,ySf:W}}s3b(A){if(A=this.HKi(A)){const W=Object.assign(new Sh.a,{Id:"DictationCorrectionSection",ControlList:[],ControlsId:"DictationCorrectionSection"});
Array.add(W.ControlList,A);return W}return null}static KLi(A){const W=Object.assign(new Sh.a,{Id:"DictationCorrectionIgnoreSuggestionSection",ControlList:[],ControlsId:"DictationCorrectionIgnoreSuggestionSectionControls"}),na=Object.assign(new Jj.a,{ExternalId:"btnIgnoreDictationCorrectionSuggestion",Command:"421768503",LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsIgnoreSuggetion});Array.add(W.ControlList,na);A&&(A=Object.assign(new Jj.a,{ExternalId:"btnDeleteDictationCorrectionSuggestion",
Command:A,LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsDeleteSuggetion}),Array.add(W.ControlList,A));return W}}Je.mUi="Insertaudio_16x16x32";Object(h.a)(Je,"DictationCorrectionContextMenuManager",null,[591]);var F=d(446);class V{constructor(A,W){this.Pzc=null;this.Cr=A;this.HZ=W}get key(){return"DICTATIONCORRECTION"}get y8(){return Box4Intl.Box4Strings.l_DictationCorrectionContentTitle}reset(A){this.Cr.ae(A.node)?this.Pzc=A.node:this.Pzc=null}zwc(A){let W;W=null;if(!this.Pzc)return{returnValue:!1,
pCa:W};A=this.HZ.Cfj(this.Pzc,A);if(!A)return{returnValue:!1,pCa:W};W=Object.assign(new F.a,{u1:this.key,nQ:A,description:this.c$d()});return{returnValue:!0,pCa:W}}c$d(){return M.AFrameworkApplication.fa&&M.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}}Object(h.a)(V,"DictationCorrectionDetailsProvider",null,[612,477]);var za=d(621),gb=d(142);class Fb{constructor(A,W,na=-1){this.TriggerType="click";this.TreatedInUX=
"true";this.PhraseId=A.rOk;this.CorrectionId=A.id;switch(W){case 0:this.EditType="alternate";this.AlternateId=na;break;case 1:this.EditType="ignore";break;case 2:this.EditType="dismissed";break;default:e.ULS.sendTraceTag(51246608,394,10,"Invalid CorrectionEditType value")}}}Object(h.a)(Fb,"CorrectionEvent",null,[]);class Ec{constructor(){this.Id="Corrections";this.Name="Telemetry";this.ClientSessionId="";this.CorrectionEvents=null}}Object(h.a)(Ec,"CorrectionTelemetry",null,[]);class $c{constructor(){this.Id=
"Corrections";this.Name="Session";this.ClientSessionId="";this.SessionInfo=null}}Object(h.a)($c,"CorrectionsSessionTelemetry",null,[]);class Ed{constructor(){this.FS=!1;this.jAd=this.ZId=0}start(){this.FS||(this.FS=!0,this.ZId=this.getTime())}stop(){this.FS&&(this.jAd+=this.getTime()-this.ZId,this.FS=!1)}get dr(){return this.jAd+(this.FS?this.getTime()-this.ZId:0)}getTime(){return(new Date).getTime()}}Object(h.a)(Ed,"DictationCorrectionsSessionTimer",null,[]);class pe{constructor(){this.StartTime=
"";this.AlternateEditCount=this.ManualEditCount=this.Duration=0;this.TextInfo=null}}Object(h.a)(pe,"SessionInfo",null,[]);class Se{constructor(){this.FinalText="";this.PhraseIds=null}}Object(h.a)(Se,"TextInfo",null,[]);var Ye=d(184);class ae{constructor(A){this.lof=this.IKd=this.JKd=0;this.iTh="Office.Voice.Online.DictationCorrectionsSession";this.q6a=null;this.wrb=Object.assign(new pe,{TextInfo:[new Se]});this.fhf=A}startSession(){this.q6a||(this.wrb.StartTime=(new Date).toISOString(),this.q6a=new Ed);
this.q6a.start()}pauseSession(){this.q6a.stop()}endSession(){this.q6a.stop();var A=new Ye.a;A.name=this.iTh;A.samplingPolicy=2;A.durationMs=this.q6a.dr;A.dataFields=[];Array.add(A.dataFields,Object.assign(new hd.a,{name:"CorrectionSessionId",string:this.$ya}));Array.add(A.dataFields,Object.assign(new hd.a,{name:"StartTime",string:this.wrb.StartTime}));Array.add(A.dataFields,Object.assign(new hd.a,{name:"NumberOfCorrectionsMarked",int64:this.JKd}));Array.add(A.dataFields,Object.assign(new hd.a,{name:"NumberOfCorrectionsMade",
int64:this.IKd}));Array.add(A.dataFields,Object.assign(new hd.a,{name:"NumberOfCorrectionsDismissed",int64:this.lof}));gb.a.sendActivityEvent(A);if(vc.App.u_&&0<vc.App.u_.yfh.length){this.wrb.AlternateEditCount=this.IKd;this.wrb.Duration=Math.floor(this.q6a.dr/1E3);this.wrb.TextInfo[0].PhraseIds=vc.App.u_.yfh;var W=new $c;W.ClientSessionId=this.$ya;W.SessionInfo=this.wrb;if(A=this.fhf())W=C.c(W),A.$vg(W)}}sCk(A){this.JKd+=A}N8g(A,W,na=-1){0===W?this.IKd++:1===W&&this.lof++;var Ga=new Ec;Ga.ClientSessionId=
this.$ya;Ga.CorrectionEvents=[new Fb(A,W,na)];if(A=this.fhf())Ga=C.c(Ga),A.$vg(Ga)}get $ya(){return vc.App.u_?vc.App.u_.$ya:""}}Object(h.a)(ae,"DictationCorrectionsTelemetry",null,[]);var lg=d(44),og=d(42);class se{constructor(A,W,na){this.LN=A;this.Mb=W;this.cH=na}}Object(h.a)(se,"DictationCorrectionRange",null,[]);var Df=d(366);class Ci{constructor(A,W,na){this.US=this.ar=null;this.Mob=A;this.LAa=W;this.HEc=new Df.a(new za.a);this.Hzc=na;this.aLa()}Lle(A){this.LAa.QDa&&Bg.ParagraphReader.ae(A)&&
this.HEc.contains(A.id)&&this.Mob.Lle(A)}EAl(){this.LAa.QDa=!0;this.ar=new ae(()=>this.US);this.ar.startSession()}uBl(){this.LAa.QDa=!1;var A=vc.App.Lb.Kd.Mn.Ag;if(A){A=A.Lh;for(let W of this.HEc){const na=A.ze(W);na&&Bg.ParagraphReader.ae(na)&&this.Mob.RAi(na)}}this.Hzc.clear();this.HEc.clear();this.ar.endSession()}hcl(A){if(this.LAa.QDa){var W=A.sa(og.a.v3d,null);if(!Gd.a.Xa(W)){var na=new Ea.a,Ga=Math.min(W.length,A.Ta.length);for(let Ka=0;Ka<Ga;Ka++){const qb=this.Hzc.Xdj(W[Ka]);if(qb){const Qb=
A.Ta.ga(Ka).cp;na.add(new se(Qb,Qb+qb.source.length,qb))}}this.Mob.Vtk(A,na)}}}V8e(A,W){if(!W)return!1;if(!this.LAa.QDa||!A)return W.add(null),!1;W.add(A.zv?A.zv.cH.key:null);return!!A.zv}Rel(A,W){this.LAa.QDa&&W&&Wa.AT(W,na=>!!na)?A.ye(og.a.v3d,W.toArray()):A.removeProperty(og.a.v3d)}Mmh(A){this.US=A}aLa(){this.Mob.mfi(Object(n.a)(this,this.pCk,"onDictationCorrectionMarkerAdded"));id.a.addHandler(window.self,Wb.a.blur,()=>{this.ar&&this.LAa.QDa&&this.ar.pauseSession()});id.a.addHandler(window.self,
Wb.a.focus,()=>{this.ar&&this.LAa.QDa&&this.ar.startSession()});this.Mob.nfi(Object(n.a)(this,this.qCk,"onDictationCorrectionMarkerRemoved"))}qCk(A,W){this.Hzc.L5k(W.cOf)}pCk(A,W){this.HEc.add(W.yLk);this.ar&&this.ar.sCk(W.zuk);this.Hzc.Fbi(W.cOf)}oCk(A,W){this.ar&&this.ar.N8g(A,0,W)}rCk(A){this.ar&&this.ar.N8g(A,1)}Cfj(A,W){if(!this.LAa.QDa)return null;A=sf.a.Lj(A,W);return this.Mob.$Uc(A)}}Object(h.a)(Ci,"DictationCorrectionManager",null,[590]);class oj extends Sys.EventArgs{constructor(A,W){super();
this.yLk=A;this.zuk=W?W.count:0;this.cOf=W}}Object(h.a)(oj,"DictationCorrectionMarkerEventArgs",Sys.EventArgs,[]);class Pl{constructor(A,W,na,Ga,Ka){this.q4h=A;this._id=W;this.YVh=Ga;this.aZb=Ka;this.Wt=na;this.QVb=String.format("{0}_{1}",A,W)}get rOk(){return this.q4h}get id(){return this._id}get source(){return this.Wt}get confidence(){return this.YVh}get suggestions(){return this.aZb}get key(){return this.QVb}Gvk(A){this.suggestions.addRange(A.suggestions)}}Object(h.a)(Pl,"DictationCorrectionDetails",
null,[]);class Pf{constructor(A,W,na){this.Wn=A;this.wWh=W;this.w3h=na}get cH(){return this.wWh}get N9g(){return this.w3h}get Je(){return this.Wn}fe(A){return new Pf(A||this.Je,this.cH,this.N9g)}}Object(h.a)(Pf,"DictationCorrectionObject",null,[146]);class Rm{constructor(A,W){this.source=A;this.suggestion=W}}Object(h.a)(Rm,"DictationCorrectionSuggestion",null,[]);class Zf{constructor(A){this.mh=A;this.Ma=new ch.a}mfi(A){this.Ma.addHandler("ADCM",A)}nfi(A){this.Ma.addHandler("RDCM",A)}Vtk(A,W){this.euk(A,
W)}euk(A,W){if(A&&W&&W.count&&(W=Zf.RSl(A,W))&&W.count){this.cBi(A,W);var na=new Ea.a;for(var Ga of W)na.add(Ga.LN),na.add(Ga.Mb);A.s5d(na);for(let Ka of W)Ga=A.Ta.HT(Ka.LN),Ga.zv=new Pf(Ga,Ka.cH,Object(n.a)(this,this.$Cj,"handleParagraphSplit")),Ga.isFromErrorRangeSplit=!0,Ga=A.Ta.HT(Ka.Mb),Ga.isDictationCorrectionEnd=!0,Ga.isFromErrorRangeSplit=!0;0<W.count&&this.Ma.raiseEvent("ADCM",new oj(A.id,W))}}o6f(A){const W=new Ea.a;if(A){let na=null,Ga=-1;for(let Ka=0;Ka<A.Ta.length;Ka++){const qb=A.Ta.ga(Ka);
qb.zv?(Ga=qb.cp,na=qb.zv.cH):qb.isDictationCorrectionEnd&&(na?W.add(new se(Ga,qb.cp,na)):e.ULS.sendTraceTag(593285261,394,10,"Correction range end with no start."),na=null)}}return W}Vqc(A,W){if(A&&W&&W.count){for(let na of W){let Ga=A.Ta.HT(na.LN);Ga&&(Ga.zv=null);if(Ga=A.Ta.HT(na.Mb))Ga.isDictationCorrectionEnd=!1}this.Ma.raiseEvent("RDCM",new oj(A.id,W))}}RAi(A){if(A)for(let W=0;W<A.Ta.length;W++){const na=A.Ta.ga(W);na.zv&&(na.zv=null);na.isDictationCorrectionEnd&&(na.isDictationCorrectionEnd=
!1)}}$Uc(A){if(!A||!lg.SelectionEditor.tk(A)&&!lg.SelectionEditor.Xg(A))return null;const W=A.node;let na=A.Sa;A=A.Mb;let Ga=0,Ka=null;for(let qb=0;qb<W.Ta.length;qb++){const Qb=W.Ta.ga(qb);if(Qb.zv&&na>=Qb.cp)Ka=Qb.zv,Ga=Qb.cp;else if(Ka&&Qb.isDictationCorrectionEnd){if(A<=Qb.cp)return new se(Ga,Qb.cp,Ka.cH);Ka=null}}return null}SSl(A,W,na){if(!A)return!1;A=Bg.ParagraphReader.text(A);return Zf.TPh(A,W.source,na)}Lle(A){if(A){var W=this.o6f(A);if(W&&0<W.count){const na=new Ea.a,Ga=Bg.ParagraphReader.text(A);
for(let Ka of W)Zf.SPh(Ga,Ka)||na.add(Ka);this.Vqc(A,na)}}}cBi(A,W){W.ga(0);W.ga(W.count-1);const na=this.o6f(A);let Ga=0,Ka=0;const qb=new Ea.a;for(;Ka<W.count&&Ga<na.count;){const Qb=W.ga(Ka),t=na.ga(Ga);Qb.Mb<t.LN?Ka++:(t.Mb>Qb.LN&&qb.add(t),Ga++)}this.Vqc(A,qb)}$Cj(A,W){const na=W.Je;for(var Ga=A.Ta.ryb(na.cp)+1;Ga<A.Ta.length;Ga++){const Ka=A.Ta.ga(Ga);if(Ka.isDictationCorrectionEnd){let qb;this.Vqc(A,(qb=new Ea.a,qb.add(new se(na.cp,Ka.cp,W.cH)),qb));break}}}iIk(A,W){(A=vc.App.Lb.Kd.Mn.Ag)&&
(W=A.Lh.ze(vf.a.Jf(W.nodeId)))&&Bg.ParagraphReader.ae(W)&&this.M5k(W)}M5k(A){if(A){var W=0,na=!1,Ga=!1,Ka=new Ea.a;for(let qb=0;qb<A.Ta.length;qb++){const Qb=A.Ta.ga(qb);Qb.zv&&(W=qb,na=!0);na&&(Qb.Yp||Qb.aM)&&(Ga=!0);Qb.isDictationCorrectionEnd&&na&&(na=!1,Ga&&(Ga=A.Ta.ga(W),Ga.zv&&Ga.zv.cH&&Ka.add(new se(Ga.cp,Qb.cp,Ga.zv.cH)),Ga.zv=null,Ga=Qb.isDictationCorrectionEnd=!1))}this.Ma.raiseEvent("RDCM",new oj(A.id,Ka))}}static RSl(A,W){if(!W.count)return W;W.Sc((Ga,Ka)=>Ga.LN!==Ka.LN?Ga.LN-Ka.LN:Ga.Mb-
Ka.Mb);A=Bg.ParagraphReader.text(A);const na=new Ea.a;for(let Ga=0;Ga<W.count;Ga++){const Ka=W.ga(Ga);if(Ka.LN>A.length||Ka.Mb>A.length)break;if(!Zf.SPh(A,Ka))continue;if(!na.count){na.add(Ka);continue}const qb=na.ga(na.count-1);Ka.LN>qb.Mb?na.add(Ka):qb.LN===Ka.LN&&qb.Mb===Ka.Mb&&qb.cH.Gvk(Ka.cH)}return na}static TPh(A,W,na){if(na+W.length<=A.length){for(let Ga=0;Ga<W.length;Ga++)if(W.charAt(Ga)!==A.charAt(Ga+na))return!1;return!0}return!1}static SPh(A,W){return!A||W.LN>A.length||W.Mb>A.length||
!W.cH||!W.cH.source?!1:Zf.TPh(A,W.cH.source,W.LN)}}Object(h.a)(Zf,"DictationCorrectionRangeEditor",null,[589]);class Ge{constructor(){this.QDa=!1}}Object(h.a)(Ge,"DictationCorrectionSettings",null,[]);var Si=d(15);class Fn{constructor(){this.YYb=new Si.ScriptSharpLegacyMap}Fbi(A){if(A&&A.count)for(let W of A)W.cH?(A=W.cH.key,this.YYb.Fb(A)||this.YYb.add(A,W.cH)):e.ULS.sendTraceTag(593285260,394,10,"Correction details is null.")}L5k(A){if(A&&A.count)for(let W of A)W.cH?this.YYb.remove(W.cH.key):e.ULS.sendTraceTag(593285259,
394,10,"Correction details is null.")}Xdj(A){if(!A)return null;let W;return({value:W}=this.YYb.wg(A)).returnValue?W:null}clear(){this.YYb=new Si.ScriptSharpLegacyMap}}Object(h.a)(Fn,"DictationCorrectionStorage",null,[610]);class ck{constructor(A,W,na,Ga,Ka,qb,Qb){this.mh=A;this.xTb=W;this.HZ=na;this.Ca=Ga;this.Uc=Ka;this.rf=qb;this.Lk=Qb}vb(){this.Ca.ya(de.a.lvc,Lc.a.Mf,Object(n.a)(this,this.qvc,"takeSuggestedDictationCorrectionAction"));this.Ca.ya(de.a.mvc,Lc.a.Mf,Object(n.a)(this,this.qvc,"takeSuggestedDictationCorrectionAction"));
this.Ca.ya(de.a.nvc,Lc.a.Mf,Object(n.a)(this,this.qvc,"takeSuggestedDictationCorrectionAction"));this.Ca.ya(de.a.ovc,Lc.a.Mf,Object(n.a)(this,this.qvc,"takeSuggestedDictationCorrectionAction"));this.Ca.ya(de.a.pvc,Lc.a.Mf,Object(n.a)(this,this.qvc,"takeSuggestedDictationCorrectionAction"));this.Ca.ya(de.a.kvc,Lc.a.Mf,Object(n.a)(this,this.kvc,"takeIgnoreSuggestedDictationCorrection"));this.Ca.ya(de.a.lvc,Lc.a.view,Object(n.a)(this,this.Yub,"collapseIpThenExecuteAction"));this.Ca.ya(de.a.mvc,Lc.a.view,
Object(n.a)(this,this.Yub,"collapseIpThenExecuteAction"));this.Ca.ya(de.a.nvc,Lc.a.view,Object(n.a)(this,this.Yub,"collapseIpThenExecuteAction"));this.Ca.ya(de.a.ovc,Lc.a.view,Object(n.a)(this,this.Yub,"collapseIpThenExecuteAction"));this.Ca.ya(de.a.pvc,Lc.a.view,Object(n.a)(this,this.Yub,"collapseIpThenExecuteAction"));this.Ca.ya(de.a.kvc,Lc.a.view,Object(n.a)(this,this.Yub,"collapseIpThenExecuteAction"));this.Ca.he(de.a.lvc,96);this.Ca.he(de.a.mvc,96);this.Ca.he(de.a.nvc,96);this.Ca.he(de.a.ovc,
96);this.Ca.he(de.a.pvc,96);this.Ca.he(de.a.kvc,96)}Ili(A,W,na){const Ga=this.Lk.je(15);try{Ga.ld(A);let Ka;this.xTb.Vqc(A,(Ka=new Ea.a,Ka.add(W),Ka));const qb=W.cH.suggestions.ga(na);if(this.xTb.SSl(A,qb,W.LN)){const Qb=sf.a.createTextRange(A,W.LN,W.LN+qb.source.length);this.mh.replaceTextRange(Qb,qb.suggestion);this.HZ.oCk(W.cH,na)}else e.ULS.sendTraceTag(50946527,394,100,"Failed to apply Suggestion")}finally{Ga&&Ga.dispose()}}qvc(A,W,na){2===na&&W.Pk&&(na=this.xTb.$Uc(W))&&this.Ili(W.node,na,this.Zdj(A));
return 32}Yub(A,W,na,Ga,Ka){if(2===na){W=this.Uc.Pa.mb;if(!W)return 2;W=this.rf.fm(W,!0,!1);return this.Ca.ei(W.Va,A,na,!1,Ga,Ka)}return 32}kvc(A,W,na){if(2===na&&W.Pk&&(A=this.xTb.$Uc(W))){let Ga;this.xTb.Vqc(W.node,(Ga=new Ea.a,Ga.add(A),Ga));this.HZ.rCk(A.cH)}return 32}Zdj(A){switch(A){case de.a.lvc:return 0;case de.a.mvc:return 1;case de.a.nvc:return 2;case de.a.ovc:return 3;case de.a.pvc:return 4;default:return-1}}}Object(h.a)(ck,"DictationCorrectionsActor",null,[609]);var Mo=d(325),Gm=d(64);
class Nk{constructor(){this.Bef=this.Da=null}get name(){return"Box4.DictationCorrections"}Yb(A){this.Da=A;this.Da.register(589,"Box4.DictationCorrections.IDictationCorrectionRangeEditor").ma().oa(()=>new Zf(this.Da.resolve("Box4.ICharacterPropertiesEditor")));this.Da.register(590,"Box4.DictationCorrections.IDictationCorrectionManager").ma().oa(()=>new Ci(this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),new Ge,new Fn));this.Da.register(591,"Box4.DictationCorrections.IDictationCorrectionContextMenuManager").ma().oa(()=>
new Je(this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor")))}init(){this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionManager");this.Bef=new ck(this.Da.resolve("Box4.ICharacterPropertiesEditor"),this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionManager"),M.AFrameworkApplication.Ra,Gm.a.instance,Mo.a.instance,this.Da.resolve("Box4.Graph.IGraphTransactionFactory"));this.Bef.vb();
this.V2k(this.Da.Ia("Box4.Accessibility.IAccessibilityContextManager"),this.Da.resolve("Box4.IParagraphReader"),this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionManager"));const A=this.Da.qb("Box4.Proofing.IErrorRangeEditor"),W=this.Da.qb("Box4.DictationCorrections.IDictationCorrectionRangeEditor");M.AFrameworkApplication.fa.ka("WacBox4DictationFloatieIsEnabled")&&A&&W&&A.vgi(Object(n.a)(W,W.iIk,"onSpellingErrorRangesChangedEventHandler"));vc.App.Lb.updateCommandUI()}dispose(){}V2k(A,
W,na){A&&A.execute(Ga=>{Ga.s0a(new V(W,na))})}}Object(h.a)(Nk,"DictationCorrectionsPackageManager",null,[2,3]);d(1257);d(732);var cl=d(492);class wf{constructor(A,W,na,Ga=null,Ka=null){this.Wn=A;this.VG=W;this.M0h=na;this._id=Ga;this.HGd=Ka}get Je(){return this.Wn}get type(){return this.VG}get Jk(){return this.M0h}get id(){return this._id}get Qkg(){return this.HGd}fe(A){return new wf(A,this.type,this.Jk,this.id,this.Qkg)}toString(){return String.format("Type = {0}, IsStart = {1}, Id = {2}",this.type,
this.Jk,this.id?this.id.toString():"<null>")}}Object(h.a)(wf,"IntentObject",null,[146]);d(609);class Ug{constructor(A,W,na,Ga=null,Ka=null){cl.a(A);this.VG=A;this.wBd=W;this.fEd=na;this._id=Ga;this.HGd=Ka}get type(){return this.VG}get begin(){return this.wBd}get end(){return this.fEd}get id(){return this._id}get Qkg(){return this.HGd}toString(){return String.format("Type = {0}, Begin = {1}, End = {2}, Id = {3}",this.type,this.begin,this.end,this.id?this.id.toString():"<null>")}}Object(h.a)(Ug,"IntentRange",
null,[244]);d(365);d(151);d(199);class ej{constructor(A){this.mh=A}}Object(h.a)(ej,"IntentRangeEditor",null,[588]);class Wn{constructor(){this.Da=null}get name(){return"Box4.Intent"}Yb(A){this.Da=A;this.Da.register(ej,"Box4.Intent.IntentRangeEditor").as("Box4.Intent.IIntentRangeEditor").ma().oa(()=>new ej(this.Da.resolve("Box4.ICharacterPropertiesEditor")))}init(){this.Da.resolve("Box4.IProofingManager")}dispose(){}static main(){Ia.a.instance.Ac(new Wn)}}Object(h.a)(Wn,"PackageManager",null,[2,3]);
var Pp=d(1200),jn=d(1153),nk=d(299),ql=d(1154),Mh=d(946),Gl=d(810);class mg{}mg.productionLanguages="en-US es-ES zh-CN en-CA es-MX en-GB fr-FR de-DE it-IT hi-IN pt-BR fr-CA ja-JP en-IN en-AU".split(" ");mg.previewLanguages="nb-NO da-DK sv-SE fi-FI nl-NL ko-KR pl-PL pt-PT ru-RU th-TH zh-TW ar-SA he-IL tr-TR ar-BH cs-CZ hu-HU el-GR sk-SK vi-VN sl-SI hr-HR ro-RO lt-LT bg-BG lv-LV et-EE ar-EG zh-HK en-NZ ga-IE mt-MT gu-IN mr-IN ta-IN te-IN".split(" ");mg.XTl="en-US en-CA en-GB en-AU en-IN en-NZ".split(" ");
mg.zoi=["en-US","en-CA","en-GB","en-AU","en-IN"];mg.Aoi="en-US es-ES zh-CN en-CA es-MX en-GB fr-FR de-DE it-IT en-AU en-IN fr-CA pt-BR ja-JP ko-KR hi-IN pl-PL pt-PT ru-RU zh-TW ar-SA he-IL tr-TR ar-BH cs-CZ hu-HU el-GR sk-SK vi-VN sl-SI hr-HR ro-RO lt-LT bg-BG lv-LV et-EE ar-EG zh-HK en-NZ ga-IE mt-MT gu-IN mr-IN ta-IN te-IN".split(" ");mg.BRi="en-US";mg.cUi="btnStartDictation";mg.nUi="btnDictationFloatieToggle";mg.hUi="Dictation";mg.oUi="DictationFloatieToggle";mg.xTf="Insertaudio_32x32x32";mg.wTf=
"Insertaudio_16x16x32";mg.gUi="JotInsertAudioRecordingShort_32x32x32";mg.fUi="JotInsertAudioRecordingShort_16x16x32";mg.Izl="speechOn.wav";mg.Hzl="speechOff.wav";Object(h.a)(mg,"DictationConstants",null,[]);class wm{constructor(A){this.plf=A;this.jOa=(A=he.a.He(A))?A.displayName:this.plf;this.NG=A?A.LCID:wm.w8j}get c4c(){return this.plf}get displayName(){return this.jOa}get LCID(){return this.NG}}wm.w8j=1033;Object(h.a)(wm,"DictationLanguage",null,[]);class dk{constructor(A,W,na,Ga,Ka,qb,Qb,t,Y){this.cDc=
null;this.whf=!1;this.Uba=null;this.gsb=!1;this.Fmd=(pa,Ja,Ya,jb,Sb)=>{if(1===Ya)return 32;Sb&&(pa=!!M.AFrameworkApplication.Aa&&M.AFrameworkApplication.Aa.ob.Qp,this.Uba?Sb[pa?Kc.a.On:jn.a.On]=this.Uba.isVisible():(Ya=this.G2.WI(),Ya=(Ja=2===Ya)||1===Ya,pa?(Sb[Kc.a.On]=Ya,Sb[nk.a.IconSet]=Ja?(new ql.a("JotInsertAudioRecordingShort_20")).iconSet:M.AFrameworkApplication.Aa.ob.nza?(new ql.a("InsertAudio_32")).iconSet:(new ql.a("InsertAudio_20",null,null,"InsertAudio_32")).iconSet):(Sb[jn.a.On]=Ya,Ja?
(Sb[jn.a.Image32by32Class]=dj.getImageClass(mg.gUi),Sb[jn.a.Image16by16Class]=dj.getImageClass(mg.fUi)):(Sb[jn.a.Image32by32Class]=dj.getImageClass(mg.xTf),Sb[jn.a.Image16by16Class]=dj.getImageClass(mg.wTf)))));return 32};this.Umb=(pa,Ja,Ya,jb,Sb)=>{if(2===Ya){if(!this.Uba||(null===Sb||void 0===Sb?0:Sb.vTf))return this.b6d(Sb);this.$Ih()}return 32};this.Iwd=(pa,Ja,Ya)=>2!==Ya?32:this.b6d(void 0);this.voc=(pa,Ja,Ya,jb,Sb)=>{if(1===Ya)return 32;this.xPk(Sb,pa===de.a.egh);return 32};this.rSe=(pa,Ja,
Ya,jb,Sb)=>{if(1===Ya)return 32;Sb&&((pa=Sb.MenuItemId)&&pa===this.xg.rT?(Sb[Kc.a.On]=!0,this.cDc=Sb.SourceControlId):Sb[Kc.a.On]=!1);return 32};this.HRe=(pa,Ja,Ya,jb,Sb)=>{if(1===Ya)return 32;Sb&&(Sb[Mh.a.Value]=(new wm(this.xg.rT)).displayName);return 32};this.IZe=(pa,Ja,Ya,jb,Sb)=>{if(1===Ya)return 32;Sb&&(pa=Sb.SourceControlId,this.cDc!==pa&&(this.xg.rT=Sb.MenuItemId,this.MNh(this.cDc),this.MNh(pa),this.cDc=pa,2===this.G2.WI()&&this.pV()));return 32};this.JZe=(pa,Ja,Ya,jb,Sb)=>{if(1===Ya)return 32;
if(Sb){pa=Sb.MenuItemId;if(this.xg.rT!==pa){this.xg.rT=pa;if(this.Uba)this.Uba.onDictationLanguageChanged(pa);2===this.G2.WI()&&this.pV()}this.Y8e()}return 32};this.showHelpPane=(pa,Ja,Ya,jb,Sb)=>{if(1===Ya)return 32;pa=this.iUh.value;if(!pa)return 0;Sb&&(Sb={},Sb.query="AssetID="+(this.xg.ARl?dk.AZh:dk.TFd),Sb=Object.assign(new Pp.a,{nonPersistedSettings:Sb}),pa.Oga(dk.SFd,Sb));return 32};this.FGl=(pa,Ja,Ya,jb,Sb)=>{if(1===Ya)return this.xg.ume?32:8;Sb&&this.xg&&(this.xg.useAutoPunctuation=Sb[Kc.a.On]);
2===this.G2.WI()&&this.pV();this.Y8e();return 32};this.SGl=(pa,Ja,Ya,jb,Sb)=>{if(1===Ya)return this.xg.Iqe?32:8;Sb&&this.xg&&(this.xg.qRb=Sb[Kc.a.On]);2===this.G2.WI()&&(this.G2.pV(),this.WQb());this.lNh();return 32};this.QWk=(pa,Ja,Ya,jb,Sb)=>{if(1===Ya)return 32;Sb&&this.xg&&(Sb[Kc.a.On]=this.xg.useAutoPunctuation);return 32};this.RWk=(pa,Ja,Ya,jb,Sb)=>{if(1===Ya)return 32;Sb&&this.xg&&(Sb[Kc.a.On]=this.xg.qRb);return 32};this.tCk=(pa,Ja,Ya)=>{2===Ya&&this.jRc();return 32};this.RFk=(pa,Ja,Ya)=>
{2===Ya&&this.xg.SL&&2===this.G2.WI()&&this.pV();return 32};this.UCk=(pa,Ja,Ya)=>{2===Ya&&this.xg.SL&&this.jRc();return 32};this.QIb=(pa,Ja,Ya)=>{2===Ya&&(this.xg.SL?this.jRc():this.pV());return 32};this.WCk=(pa,Ja,Ya)=>{2===Ya&&this.pV();return 32};this.wCk=(pa,Ja,Ya)=>{2===Ya&&this.WQb();return 32};this.xCk=(pa,Ja,Ya)=>{2===Ya&&(this.G2.pV(),this.WQb());return 32};this.vCk=(pa,Ja,Ya,jb,Sb)=>{2===Ya&&Sb&&(pa=he.a.He(this.xg.rT),this.If.Nsc(this.OP.Bs(Sb),pa.LCID,Sb.Mb));return 32};this.uCk=(pa,Ja,
Ya)=>{2===Ya&&this.pV();return 32};this.zCk=(pa,Ja,Ya)=>{2===Ya&&this.pV();return 32};this.yCk=(pa,Ja,Ya)=>2===Ya&&this.xg&&this.xg.zVj?this.xg.SL&&this.Uba&&!this.Uba.isVisible()?(this.$Ih(),32):this.b6d(void 0):32;this.Ca=A;this.HZ=vc.App.x2a;this.kAc=vc.App.u_;this.G2=na;this.NFc=W;this.If=Ga;this.OP=Ka;this.xg=Qb;this.Pd=Y;this.xg.SL&&(this.Uba=qb);this.iUh=t}vb(){this.Ca.ra(de.a.voc,Lc.a.view,this.voc,96);this.Ca.ra(de.a.IZe,Lc.a.view,this.IZe,1028);this.Ca.ra(de.a.rSe,Lc.a.view,this.rSe,96);
this.Ca.ra(de.a.Umb,Lc.a.view,this.Umb,1028);this.Ca.ra(de.a.Fmd,Lc.a.view,this.Fmd,96);this.Ca.ra(de.a.sTf,Lc.a.view,this.QIb,64);this.Ca.ra(de.a.yTf,Lc.a.view,this.QIb,64);this.Ca.ra(de.a.BTf,Lc.a.view,this.wCk,64);this.Ca.ra(de.a.CTf,Lc.a.view,this.xCk,64);this.Ca.ra(de.a.zTf,Lc.a.view,this.vCk,64);this.Ca.ra(de.a.uTf,Lc.a.view,this.uCk,64);this.Ca.ra(de.a.ETf,Lc.a.view,this.WCk,64);this.Ca.ra(de.a.ATf,Lc.a.view,this.zCk,64);this.Ca.ra(de.a.egh,Lc.a.view,this.voc,96);this.Ca.ra(de.a.JZe,Lc.a.view,
this.JZe,1028);this.Ca.ra(de.a.HRe,Lc.a.view,this.HRe,96);this.Ca.ra(de.a.jUi,Lc.a.view,this.showHelpPane,96);this.Ca.ra(de.a.kUi,Lc.a.view,this.showHelpPane,96);this.Ca.ra(de.a.iUi,Lc.a.view,this.FGl,96);this.Ca.ra(de.a.JVk,Lc.a.view,this.QWk,96);this.Ca.ra(de.a.lUi,Lc.a.view,this.SGl,96);this.Ca.ra(de.a.KVk,Lc.a.view,this.RWk,96);this.Ca.ra(de.a.Iwd,Lc.a.view,this.Iwd,1028);this.Ca.ra(de.a.tTf,Lc.a.view,this.tCk,1028);this.Ca.ra(de.a.eUi,Lc.a.view,this.RFk,96);this.Ca.ra(de.a.dUi,Lc.a.view,this.UCk,
96);const A=wc.KeyInputManager.Qa(nd.a.FPh,1);this.Pd.Fc(od.AFrame.Xi).bindAction(A,de.a.DTf);this.Ca.ra(de.a.DTf,Lc.a.view,this.yCk,1028)}ZUc(){return M.AFrameworkApplication.Aa&&M.AFrameworkApplication.Aa.ob.Qp?this.xg.SL?mg.oUi:mg.hUi:this.xg.SL?mg.nUi:mg.cUi}Ebi(){const A=Object.assign(new Sh.a,{Title:"",ShowMenuSectionSeparator:!0,DisplayMode:"Menu",Id:"dictationButton",ControlsId:"ctrDictationButton",ControlList:[]}),W=Object.assign(new Yb.a,{Id:"DictationLanguageList_"+this.ZUc(),ExternalId:"DictationLanguageList_"+
this.ZUc(),LabelText:Box4Intl.Box4Strings.L_DictationRibbonLabel,Command:"1394650145",MenuItemId:this.ZUc(),QueryCommand:"2417470717",Image16by16Class:dj.getImageClass(mg.wTf),Image32by32Class:dj.getImageClass(mg.xTf),Visible:!0,AriaLabel:Rb.a.tni});Array.add(A.ControlList,W);return A}xPk(A,W){A.MenuItems=Object.assign(new sh.a,{Id:W?"DictationSettingsLanguageList":"DictationLanguageList",MenuSectionList:[],UpdateDynamically:!0});if(!W){var na=this.Ebi();Array.add(A.MenuItems.MenuSectionList,na)}na=
this.xg.Iih;0<na.length&&(na=dk.COc(na,"dictationProdcutionLanguages","",W),Array.add(A.MenuItems.MenuSectionList,na));na=this.xg.Hhh;0<na.length&&(W=dk.COc(na,"dictationPreviewLanguages",Box4Intl.Box4Strings.L_DictationPreviewLanguages,W),Array.add(A.MenuItems.MenuSectionList,W));A.PopulationXML=If.l(A.MenuItems);this.whf=!0}WQb(){const A=this.NFc.value;if(A){const W=this.ZUc();if(M.AFrameworkApplication.Aa&&M.AFrameworkApplication.Aa.ob.Qp){const na={};na[W]=this.xg.SL?"ToggleButtonModel":"SplitButtonModel";
this.whf&&!this.xg.SL&&(na["DictationLanguageList_"+W]="ToggleButtonModel");A.UQb(na)}this.Y8e();this.lNh()}}Y8e(){if(this.xg.SL){const A=this.NFc.value;M.AFrameworkApplication.Aa&&M.AFrameworkApplication.Aa.ob.Qp&&A.UQb({DictationSettingsAutoPunctuation:"CheckboxModel"})}}lNh(){if(this.xg.SL){const A=this.NFc.value;M.AFrameworkApplication.Aa&&M.AFrameworkApplication.Aa.ob.Qp&&A.UQb({DictationSettingsVoiceCommands:"CheckboxModel"})}}MNh(A){const W=this.NFc.value;if(W&&M.AFrameworkApplication.Aa&&
M.AFrameworkApplication.Aa.ob.Qp){const na={};na[A]="ToggleButtonModel";W.UQb(na)}}$Ih(){this.gsb||(this.gsb=!0,this.Uba.isVisible()?(this.jRc(),this.gsb=!1):this.showFloatie(),this.WQb())}showFloatie(){this.Uba.showFloatie((new wm(this.xg.rT)).displayName).then(()=>{0===this.G2.WI()&&this.G2.dmb(void 0).then(()=>{this.gsb=!1}).catch(A=>{this.gsb=!1;e.ULS.sendTraceTag(577901849,394,10,"Failed to start dictation {0}",A)});this.xg.Iac&&this.HZ&&this.HZ.EAl();this.kAc&&this.kAc.startSession()}).catch(()=>
{this.gsb=!1})}b6d(A){const W=this.G2.WI();if(1===W||3===W)return 1;0===W?this.dmb(null===A||void 0===A?void 0:A.vTf):this.pV();return 32}jRc(){const A=this.G2.WI();1!==A&&(this.Uba&&this.Uba.hideFloatie(),this.HZ&&this.HZ.uBl(),0!==A&&this.pV(),this.kAc&&this.kAc.endSession(),this.WQb())}pV(){this.G2.pV();this.WQb()}dmb(A){this.G2.dmb(A).then(()=>{}).catch(W=>{e.ULS.sendTraceTag(577901848,394,10,"Failed to start dictation {0}",W)})}static createInstance(A,W,na,Ga,Ka,qb,Qb,t){return dk.La||(dk.La=
new dk(M.AFrameworkApplication.Ra,A,W,na,Ga,Ka,qb,Qb,t))}static COc(A,W,na,Ga){na=Object.assign(new Sh.a,{DisplayMode:"Menu",Title:na,Id:W,ControlsId:"ctr"+W,ControlList:[]});for(const Ka of A){A=W+"_"+Ka.c4c;const qb=Ka.displayName,Qb=Ka.c4c;Ga?(A=Object.assign(new Gl.a,{Id:A,ExternalId:A,LabelText:qb,Command:"3662249320",MenuItemId:Qb,Visible:!0}),Array.add(na.ControlList,A)):(A=Object.assign(new Yb.a,{Id:A,ExternalId:A,LabelText:qb,Command:"2863762275",MenuItemId:Qb,QueryCommand:"2739750502",Visible:!0,
AriaLabel:Rb.a.stb}),Array.add(na.ControlList,A))}return na}}dk.La=null;dk.SFd="FA000000012";dk.TFd="3876e05f-3fcc-418f-b8ab-db7ce0d11d3c";dk.AZh="78766431-0933-4603-abf5-5bcc1dee9dda";Object(h.a)(dk,"DictationActor",null,[581]);var Xn=d(270),Gn=d(1151),kn=d(161);class Yn{constructor(A,W){this.IZ=null;this.dca=!1;this.cOa=null;this.hXh=A;this.xg=W}isVisible(){return this.dca}e0c(){return this.dca&&!!this.IZ}EZi(){if(this.IZ)return!0;this.IZ=this.hXh.value;if(!this.IZ)return!1;this.IZ.NYl(de.a.Iwd);
this.IZ.HYl(de.a.tTf);id.a.addHandler(window.self,Wb.a.resize,()=>{this.BGj()});const A=mc.FocusManager.instance().Fc(kn.AppFrame.t9a);A.f8(W=>{this.K6i(W)});A.vCa((W,na)=>{this.J6i(na)});A.uJ=!0;A.XWe=!0;Xn.a.instance.e3(kn.AppFrame.t9a,!0);Xn.a.instance.Eo(kn.AppFrame.t9a);return!0}K6i(A){this.e0c()&&A.name!==od.AFrame.jP&&this.IZ.focus()}J6i(A){this.e0c()&&A.name!==od.AFrame.jP&&this.IZ.blur()}showFloatie(A){return this.dca?Promise.resolve(null):this.EZi()?new Promise((W,na)=>{this.IZ.EXl().then(()=>
{this.IZ.showDictationFloatie(this.kyb(),!1,A,this.xg.useAutoPunctuation);this.cOa=A;this.dca=!0;Xn.a.instance.DI(kn.AppFrame.t9a);W(null)}).catch(()=>{na("failed to intialize the floatie")})}):Promise.reject("Unable to find the dictation floatie controller")}hideFloatie(){this.e0c()&&(this.IZ.dismissDictationFloatie(),Xn.a.instance.Eo(kn.AppFrame.t9a),this.dca=!1)}showDictationWarning(A){this.e0c()&&this.IZ.showDictationWarning(A)}onDictationLanguageChanged(A){this.cOa=A}kyb(){var A=vc.App.Lb.A9a.getBoundingClientRect();
const W=A.left+A.width/2-44;A=A.top+A.height-70;return Object.assign(new Gn.a,{x:W,y:A})}BGj(){this.dca&&this.IZ&&(this.IZ.dismissDictationFloatie(),this.IZ.showDictationFloatie(this.kyb(),!1,this.cOa,this.xg.useAutoPunctuation))}}Object(h.a)(Yn,"DictationFloatieManager",null,[]);class Hm{constructor(){this.via=this.rBa=0;this.KAc=null;this.gca=!0;this.byc="";this.xg=this.Kh=null;this.sBa=this.mca=this.wOa=this.Pt=this.Kj=0;this.iEd=this.AZ="";this.PXb=this.WSb=0;this.EEd=this.WEd=this.VEd=!1;this.UOd=
"";this.xXb=this.yUb=this.ii=this.F2=null;this.TCd=this.DDc=this.CDc=this.wQd=this.Euf=this.O6a=this.M6a=0}set vGi(A){this.AZ=A}get $ya(){return vc.App.u_?vc.App.u_.$ya:""}get L2a(){return vc.App.u_?vc.App.u_.L2a:""}set L2a(A){vc.App.u_&&(vc.App.u_.L2a=A)}onFragment(A){this.wOa||(this.wOa=(new Date).getTime());this.yUb&&(this.yUb.stop(),this.M6a+=this.yUb.dr,this.yUb.start());this.rBa++;this.sBa+=A.split(" ").length}onFinalPhrase(A){this.wOa||(this.wOa=(new Date).getTime());this.xXb&&(this.xXb.stop(),
this.O6a+=this.xXb.dr,this.xXb.start());this.sBa=0;this.via++;this.mca+=A.split(" ").length}onConnectionStarted(A){this.WSb=(new Date).getTime();this.vGi=A;this.ii&&(this.yUb=this.ii.Ii("WebServiceCall","FragmentResponse"),this.xXb=this.ii.Ii("WebServiceCall","PhraseResponse"))}onRecordingStarted(){this.PXb=(new Date).getTime()}onMicrophoneError(A){this.onCustomError("MicrophoneError",A)}onCustomError(A,W=null){this.gca=!1;this.KAc=A;this.setEndReason(W||A)}setEndReason(A){this.iEd=A}onTextInsertionError(){this.onCustomError("FailedToInsertText")}onTextInserted(A,
W){this.TCd=W;A?(this.wQd+=W,W>this.DDc&&(this.DDc=W)):(this.Euf=W,W>this.CDc&&(this.CDc=W))}onFocusLost(){this.VEd=!0}onFocusLostWhileStarting(){this.WEd=!0}onFailedToStartTurn(){this.EEd=!0}onSpeechSessionStarted(A){this.UOd=A}setDictationLatency(A){this.F2=A}endActivity(){}onCommandCalled(){}onAugloopError(){}onFinalResultAnnotationResponse(){}onPartialResultAnnotationResponse(){}setRecordingStartTime(){}onCommandError(){}setCurFinalResultAnnotationResponseTime(){}calculateMaxAndMinFinalResultUserPerceivedLatency(){}setCurPartialResultAnnotationResponseTime(){}calculateMaxAndMinPartialResultUserPerceivedLatency(){}setFirstAudioChunkStartTime(){}setMicrophoneWarmUpLatency(){}getDictationStartTime(){}}
Object(h.a)(Hm,"AbstractDictationSessionTelemetry",null,[627]);class Cd{}Cd.seen="Seen";Cd.tried="Tried";Cd.kept="Kept";Object(h.a)(Cd,"FunnelStatus",null,[]);class Jh{constructor(){this.dataFields=this.name=null}}Object(h.a)(Jh,"Contract",null,[]);class Me extends Hm{constructor(A,W){super();this.kdf=this.jdf=this.Fbf=!1;this.OJd=this.JJd=this.OMd=0;this.YJd=this.XJd=2147483647;this.vQd=this.tQd=0;this.xg=A;this.Kj=(new Date).getTime();this.ii=W;this.L2a=aa.a.create().toString();this.Kh=new Ye.a;
this.Kh.dataFields=[];this.byc="Office.Voice.Online.ALDictationSession"}onFinalResultAnnotationResponse(A,W,na){A=A+this.TCd-(this.OMd+(W+na)/1E4);this.tQd+=A;this.JJd<A&&(this.JJd=A);this.XJd>A&&(this.XJd=A)}onPartialResultAnnotationResponse(A,W,na){A=A+this.TCd-(this.OMd+(W+na)/1E4);this.vQd+=A;this.OJd<A&&(this.OJd=A);this.YJd>A&&(this.YJd=A)}setRecordingStartTime(A){this.OMd=A}onCommandCalled(){this.jdf=!0}onAugloopError(A){this.gca=!1;this.Fbf=!0;this.KAc=A}onCommandError(){this.kdf=!0}endActivity(){this.mca+=
this.sBa;this.Pt=(new Date).getTime();this.Kh.succeeded=this.gca;this.Kh.durationMs=this.Pt-this.Kj;Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"Success",bool:this.gca}));this.gca||Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"error",string:this.KAc}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"SessionID",string:this.$ya}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"SpeechSessionID",string:this.UOd}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,
{name:"TurnID",string:this.L2a}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"NumberOfWords",int64:0<this.sBa?this.sBa+this.mca:this.mca}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"NumberOfFragments",int64:this.rBa}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"NumberOfFinalPhrases",int64:this.via}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"Language",string:this.xg.rT}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"connectionID",
string:this.AZ}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"IsFrontdoor",bool:!0}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"IsUsingFloatie",bool:this.xg.SL}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"UseAutoPunctuation",bool:this.xg.useAutoPunctuation}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"EndReason",string:this.iEd}));this.wOa&&Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"TimeToGetFirstResult",int64:this.wOa-
this.WSb}));this.gca&&(Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"TimeToStartRecording",int64:this.PXb-this.Kj})),Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"TimeToOpenConnection",int64:this.WSb-this.PXb})));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"FocusLost",bool:this.VEd}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"FocusLostWhileStarting",bool:this.WEd}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"FailedToStartTurn",
bool:this.EEd}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"MaxTimeToInsertFragment",int64:this.CDc}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"MaxTimeToInsertPhrase",int64:this.DDc}));var A=Cd.seen;this.gca&&0<this.mca&&(A=0<this.via?Cd.kept:Cd.tried);Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"DictationFunnel",contract:Object.assign(new Jh,{name:"Office.System.Funnel",dataFields:[Object.assign(new hd.a,{name:"Name",string:"Dictation"}),Object.assign(new hd.a,
{name:"State",string:A})]})}));this.Kh.name=this.byc;this.Kh.samplingPolicy=2;Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"AugloopFailed",bool:this.Fbf}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"CommandsUsed",bool:this.jdf}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"CommandsFailed",bool:this.kdf}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"MaxFinalResultUserPerceivedLatency",int64:this.JJd}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,
{name:"MinFinalResultUserPerceivedLatency",int64:this.XJd}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"MaxPartialResultUserPerceivedLatency",int64:this.OJd}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"MinPartialResultUserPerceivedLatency",int64:this.YJd}));A=0<this.via?this.tQd/this.via:0;const W=0<this.rBa?this.vQd/this.rBa:0;Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"AverageFinalResultUserPerceivedLatency",double:A}));Array.add(this.Kh.dataFields,
Object.assign(new hd.a,{name:"AveragePartialResultUserPerceivedLatency",double:W}));gb.a.sendActivityEvent(this.Kh)}}Object(h.a)(Me,"AugloopDictationTelemetry",Hm,[]);var ue=d(220);class Sm{constructor(A){this.l7=A}play(){this.l7.play()}pause(){this.l7.pause()}get paused(){return this.l7.paused}get currentTime(){return this.l7.currentTime}set currentTime(A){this.l7.currentTime=A}get duration(){return this.l7.duration}get error(){const A=this.l7.error;return A?A.code:0}get readyState(){return this.l7.readyState}get src(){return this.l7.getAttribute("src")}set src(A){this.l7.setAttribute("src",
A)}get preload(){return this.l7.getAttribute("preload")}set preload(A){this.l7.setAttribute("preload",A)}get Yf(){return this.l7}}Object(h.a)(Sm,"AudioElement",null,[]);class Hl{constructor(){this.PKd=this.OKd=this.O6a=this.M6a=this.GDd=0}onAudioData(){this.GDd||(this.GDd=(new Date).getTime())}onFragment(A){this.M6a+=this.Dcg(A);this.OKd++}TFk(A){this.O6a+=this.Dcg(A);this.PKd++}f4f(){return this.PKd?this.O6a/this.PKd:0}Raj(){return this.OKd?this.M6a/this.OKd:this.f4f()}Dcg(A){if(!A)return 0;const W=
(new Date).getTime();let na=null;return({Nu:na}=C.d(A)).returnValue?W-this.GDd-(na.Offset+na.Duration)/1E4:0}}Object(h.a)(Hl,"DictationLatency",null,[]);class dh{constructor(A,W){this.w7=0;this.SOd=this.TOd=null;this.MVb=!1;this.JDc=null;this.pCc=!1;this.F2=this.ar=null;this.JG=W;this.Zba=A}onFinalText(A,W){if(2===this.w7){var na=A.size;if(1!==na&&(e.ULS.sendTraceTag(51442337,394,10,"Final text mapping has invalid size of {0}",na),!na))return;W=W.get("JsonResult");this.F2&&this.F2.TFk(W);this.JG.onFinalPhrase(A.values().next().value,
W)}}onFragmentText(A,W){if(2===this.w7){var na=A.size;if(1!==na&&(e.ULS.sendTraceTag(51442338,394,10,"Fragment text mapping has invalid size of {0}",na),!na))return;W=W.get("JsonResult");if(this.F2)this.F2.onFragment(W);this.JG.onFragment(A.values().next().value)}}onError(A){if(0!==this.w7&&3!==this.w7&&"ErrorNone"!==A){this.w7=3;switch(A){case "ErrorInvalidSubscriptionFromConfig":case "ErrorInvalidRegionFromConfig":case "ErrorAddSessionFailure":case "ErrorCreateSpeechSessionBadRequest":this.JG.Zzk(A);
break;case "ErrorSpeechHandlerWebSocketFailure":case "ErrorProtobufDeserializationFailure":case "ErrorConnectionRetryFailure":this.JG.TBk(A);break;case "ErrorWaitAudioTimeout":case "ErrorInitialBabbleTimeout":case "ErrorCustomEndpointTimeout":this.JG.PM(A);break;case "ErrorInitialSilenceTimeout":this.JG.eEk(A);break;case "ErrorInvalidMessage":case "ErrorAudioAbortError":case "ErrorAudioOverconstrainedError":case "ErrorAudioTypeError":case "ErrorAudioCaptureAsync":this.JG.onMicrophoneError(A);break;
case "ErrorAudioSecurityError":case "ErrorAudioNotAllowedError":case "ErrorAudioPermissionDeniedError":this.JG.YLe("NotAllowedError");break;case "ErrorAudioNotFoundError":case "ErrorAudioDevicesNotFoundError":this.JG.YLe("NotFoundError");break;case "ErrorAudioNotReadableError":this.JG.YLe("NotReadableError");break;default:this.JG.OIk(A)}this.w7=0}}onSpeechRecognitionStarted(A){window.self.document.hasFocus()?(this.w7=2,this.MVb=!1,this.JG.onRecordingStarted(),this.JG.onConnectionStarted(A),this.TOd||
(this.TOd=Object.assign(new Sm(document.createElement("audio")),{src:ue.a.box4Image(mg.Izl)})),this.TOd.play()):(this.E8e(),this.JG.onFocusLost())}onSpeechEnd(){this.E8e();0!==this.WI()&&(this.w7=3,this.JG.wGk(),this.w7=0,this.SOd||(this.SOd=Object.assign(new Sm(document.createElement("audio")),{src:ue.a.box4Image(mg.Hzl)})),this.SOd.play())}onAudioData(A){if(this.F2)this.F2.onAudioData();if(this.Zba){var W=0;for(const na of A)W+=Math.pow(na,2);A=Math.sqrt(W/A.length)>dh.vzl;!this.MVb&&A?(this.MVb=
!0,this.JDc=null):this.MVb&&!A&&(this.JDc?(new Date).getTime()>=this.JDc+dh.ewk&&(this.MVb=!1):this.JDc=(new Date).getTime())}}onSpeechSessionStarted(A){this.JG.onSpeechSessionStarted(A)}onEventUpdate(A){if(this.Zba&&"QualityStatusUpdate"===A.eventName)switch(A.shortCode){case 13:case 2:this.Zba.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningLowSoundLevel);break;case 3:case 4:this.Zba.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningTooMuchNoise);break;case 8:case 6:case 7:this.Zba.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningCheckNetworkConnection)}}d2a(A,
W){this.JG.fEa(!1);this.JG.Xx=A;this.JG.$lg=W;this.j3k();this.ar=A;this.w7=1;this.F2=new Hl;this.ar&&this.ar.setDictationLatency(this.F2)}WI(){return this.w7}j3k(){this.pCc||(id.a.addHandler(window.self,Wb.a.blur,Object(n.a)(this,this.E9g,"onFocusLostEventHandler")),this.pCc=!0)}E8e(){this.pCc&&(id.a.removeHandler(window.self,Wb.a.blur,Object(n.a)(this,this.E9g,"onFocusLostEventHandler")),this.pCc=!1)}E9g(){if(1===this.w7){if(this.ar)this.ar.onFocusLostWhileStarting()}else 2===this.w7&&(this.E8e(),
this.JG.onFocusLost())}}dh.vzl=350;dh.ewk=350;Object(h.a)(dh,"FrontdoorSpeechClientObserver",null,[653]);class No extends dh{constructor(A,W){super(A,W);this.yOa=new dh(A,W)}onFinalText(A,W){this.yOa.onFinalText(A,W)}onFragmentText(A,W){this.yOa.onFragmentText(A,W)}onError(A){this.yOa.onError(A)}onSpeechRecognitionStarted(A){this.yOa.onSpeechRecognitionStarted(A)}onSpeechEnd(){this.yOa.onSpeechEnd()}onAudioData(A){this.yOa.onAudioData(A)}d2a(A,W){this.yOa.d2a(A,W)}WI(){return this.yOa.WI()}}Object(h.a)(No,
"AugloopFrontdoorSpeechObserverAbstractDecorator",dh,[]);class Zn extends No{constructor(A,W,na){super(A,W);this.Uc=na}onFinalText(A,W){super.onFinalText(A,W)}onFragmentText(A,W){if(this.Fpe())super.onFragmentText(A,W)}onError(A){super.onError(A)}onSpeechRecognitionStarted(A=null){const W=aa.a.create().toString();super.onSpeechRecognitionStarted(A?A:W)}onSpeechEnd(){super.onSpeechEnd()}onAudioData(A){super.onAudioData(A)}d2a(A,W){super.d2a(A,W)}WI(){return super.WI()}Fpe(){const A=this.Uc.Pa.mb.Va;
return A.Mb!==A.Sa?!1:!0}}Object(h.a)(Zn,"AugloopFrontdoorSpeechObserverDecorator",No,[]);class vo{constructor(A){this.Evf=A}onVoiceCommand(A){this.Evf.onVoiceCommand(A)}setDictationSessionTelemetry(A){this.Evf.setDictationSessionTelemetry(A)}}Object(h.a)(vo,"AugloopVoiceCommandObserverAbstractDecorator",null,[628]);class np extends vo{constructor(A,W,na){super(A);this.B2=W;this.Uc=na}onVoiceCommand(A){this.Fpe()&&this.B2.aZl();super.onVoiceCommand(A)}setDictationSessionTelemetry(A){super.setDictationSessionTelemetry(A)}Fpe(){const A=
this.Uc.Pa.mb.Va;return A.Mb!==A.Sa?!1:!0}}Object(h.a)(np,"AugloopVoiceCommandObserverDecorator",vo,[]);class fj{constructor(A){this.xg=A}$vg(A){const W=M.AFrameworkApplication.Me;if(W){var na=this.xg.M2f;na&&""!==na&&W.zj(String.format("https://{0}/SpeechHandler.ashx?action=SendCorrectionTelemetry",na),2,A,{["Content-Type"]:"application/json; charset=utf-8"},!1,3,()=>{},()=>{},null)}}}Object(h.a)(fj,"FrontdoorCorrectionsTelemetryLogger",null,[629]);class qe{constructor(){this.properties=this.useCorrections=
this.useAutoPunctuation=this.dictationLanguage=null}}Object(h.a)(qe,"SpeechDictationSettings",null,[]);class Xi{constructor(A,W,na,Ga){this.FDd=this.Zy=null;this.B2=A;this.Zba=W;this.JG=na;this.Job=Ga;this.initializeCommandsDictionary()}onVoiceCommand(A){if(this.FDd)this.FDd.onCommandCalled();var W=4;if(({value:W}=this.Zy.wg(A.commandId,0)).returnValue&&4!==W){let na=null;A.commandValue&&(na=new r.a(m.a.Ml()),na.add("commandValue",A.commandValue));this.JG.fEa(!1);W=this.B2.executeCommand(W,na);if(A.offset&&
A.duration)this.Job.onCommandFinished(A.commandId,W,A.offset,A.duration)}}setDictationSessionTelemetry(A){this.FDd=A}initializeCommandsDictionary(){this.Zy=new r.a(m.a.Ml());this.Zy.add("Word.Editing.Undo",2);this.Zy.add("Word.Editing.Bold",5);this.Zy.add("Word.Editing.Italics",6);this.Zy.add("Word.Editing.Underline",10);this.Zy.add("Word.Editing.StrikeThrough",20);this.Zy.add("Word.Editing.Subscript",19);this.Zy.add("Word.Editing.Superscript",18);this.Zy.add("Word.Editing.RemoveBold",11);this.Zy.add("Word.Editing.RemoveUnderline",
13);this.Zy.add("Word.Editing.RemoveItalics",12);this.Zy.add("Word.Editing.RemoveStrikeThrough",21);this.Zy.add("Word.Editing.RemoveSubscript",22);this.Zy.add("Word.Editing.RemoveSuperscript",24);this.Zy.add("Word.Editing.Paste",7);this.Zy.add("Word.Editing.InsertTable",8);this.Zy.add("Word.Editing.InsertComment",9);this.Zy.add("Word.Editing.InsertBullet",23);this.Zy.add("Word.Editing.FullJustify",14);this.Zy.add("Word.Editing.CenterJustify",15);this.Zy.add("Word.Editing.LeftJustify",16);this.Zy.add("Word.Editing.RightJustify",
17);this.Zy.add("Command.Exit",1);this.Zy.add("Command.Pause",0);this.Zy.add("Command.ShowHelp",26);this.Zy.add("Command.ShowCommand",27);this.Zy.add("Word.Editing.RemoveFormatting",28)}}Object(h.a)(Xi,"VoiceCommandObserver",null,[628]);var Zc=d(999);class Kj{constructor(A,W,na,Ga,Ka,qb,Qb){this.ar=this.LZb=null;this.wKj=0;this.Job=Ka;this.xg=Qb;Ka=new qe;Ka.dictationLanguage=Qb.rT;Ka.useAutoPunctuation=Qb.useAutoPunctuation?"Intelligent":"Explicit";Ka.useCorrections=Qb.Iac.toString();alVoiceClient.DictationSettingsManager.dictationSettings=
Ka;this.X7=new Zn(A,qb,Ga);this.Fvf=new np(new Xi(W,A,qb,this.Job),W,Ga);this.xyc=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();this.mbf=Array(na);this.xyc.setAnnotationResultCallback(Object.assign(new Zc.a,{handler:t=>{for(const Y of this.mbf)Y.onAnnotationResult(t)}}));this.SYb=new alVoiceClient.SpeechToTextClient(this.xyc,this.X7,Qb.ynb||Qb.Oyd,!1);this.Nwf(this.SYb.getAnnotationObserver());this.KZb=new alVoiceClient.VoiceCommandingClient(this.xyc,this.Fvf,this.X7);this.Nwf(this.KZb.getAnnotationObserver());
Qb.Iac&&(A=new fj(Qb),(W=vc.App.x2a)&&W.Mmh(A))}Ojg(A,W){return new Promise(na=>{const Ga=new qe;Ga.dictationLanguage=A;Ga.useAutoPunctuation=this.xg.useAutoPunctuation?"Intelligent":"Explicit";alVoiceClient.DictationSettingsManager.dictationSettings=Ga;this.ar=W;na(this.INj())})}dmb(A){if(!this.SYb)return 3;this.LZb.startVoiceSessionFromMicrophoneInput();this.X7.d2a(this.ar,A);A=this.xg.qRb;this.SYb.initializeAsync(A?[1]:[1,0],this.ar);A&&this.iBl();return 0}pV(A){if(A&&this.X7)this.X7.onSpeechEnd();
this.SYb&&this.SYb.uninitializeAsync();this.LZb&&(this.LZb.stopVoiceSession(),this.LZb=null);this.ar=null;this.xg.qRb&&this.HBl()}WI(){return this.X7.WI()}INj(){this.xg.qRb&&this.Fvf.setDictationSessionTelemetry(this.ar);this.LZb=new alVoiceClient.VoiceSession(this.xyc,this.X7,this.xg.ynb,this.Job,this.ar);return 0}iBl(){this.KZb&&this.KZb.initializeAsync(this.ar)}HBl(){this.KZb&&this.KZb.uninitializeAsync()}Nwf(A){this.mbf[this.wKj++]=A}}Object(h.a)(Kj,"AugloopSpeechClientProxy",null,[607]);class gg extends Hm{constructor(A,
W){super();this.xg=A;this.Kj=(new Date).getTime();this.ii=W;this.L2a=aa.a.create().toString();this.Kh=new Ye.a;this.Kh.dataFields=[];this.byc="Office.Voice.Online.DictationSession"}endActivity(){this.mca+=this.sBa;this.Pt=(new Date).getTime();this.Kh.succeeded=this.gca;this.Kh.durationMs=this.Pt-this.Kj;Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"Success",bool:this.gca}));this.gca||Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"error",string:this.KAc}));Array.add(this.Kh.dataFields,
Object.assign(new hd.a,{name:"SessionID",string:this.$ya}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"SpeechSessionID",string:this.UOd}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"TurnID",string:this.L2a}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"NumberOfWords",int64:0<this.sBa?this.sBa+this.mca:this.mca}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"NumberOfFragments",int64:this.rBa}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,
{name:"NumberOfFinalPhrases",int64:this.via}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"Language",string:this.xg.rT}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"connectionID",string:this.AZ}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"IsFrontdoor",bool:!0}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"IsUsingFloatie",bool:this.xg.SL}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"UseAutoPunctuation",bool:this.xg.useAutoPunctuation}));
Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"EndReason",string:this.iEd}));this.wOa&&Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"TimeToGetFirstResult",int64:this.wOa-this.WSb}));this.gca&&(Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"TimeToStartRecording",int64:this.PXb-this.Kj})),Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"TimeToOpenConnection",int64:this.WSb-this.PXb})));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"FocusLost",
bool:this.VEd}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"FocusLostWhileStarting",bool:this.WEd}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"FailedToStartTurn",bool:this.EEd}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"AverageFragmentLatency",double:this.F2?this.F2.Raj():0<this.rBa?this.M6a/this.rBa:0}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"AveragePhraseLatency",double:this.F2?this.F2.f4f():0<this.via?this.O6a/this.via:0}));
Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"AveragePhraseInsertionLatency",double:0<this.via?this.wQd/this.via:0}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"AverageFragmentInsertionLatency",double:0<this.rBa?this.Euf/this.rBa:0}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"MaxTimeToInsertFragment",int64:this.CDc}));Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"MaxTimeToInsertPhrase",int64:this.DDc}));let A=Cd.seen;this.gca&&0<this.mca&&
(A=0<this.via?Cd.kept:Cd.tried);Array.add(this.Kh.dataFields,Object.assign(new hd.a,{name:"DictationFunnel",contract:Object.assign(new Jh,{name:"Office.System.Funnel",dataFields:[Object.assign(new hd.a,{name:"Name",string:"Dictation"}),Object.assign(new hd.a,{name:"State",string:A})]})}));this.Kh.name=this.byc;this.Kh.samplingPolicy=2;gb.a.sendActivityEvent(this.Kh)}}Object(h.a)(gg,"DictationSessionTelemetry",Hm,[]);var Rq=d(1195);class ln{constructor(A,W){this.vPa=A;this.I_h=W}getAccessToken(A){this.I_h&&
this.vPa?this.vPa.gI("OfficeDictation",M.AFrameworkApplication.fa.Ha("DictationResourceID")).then(W=>{W.IsSuccess?A(W.Token):A(ln.w4d)}).catch(()=>{A(ln.w4d)}):A(ln.w4d)}}ln.w4d="dictation access token";Object(h.a)(ln,"AuthenticationProvider",null,[]);class rl{constructor(A){this.Q_h=A;this.AHc=new yd.a}debugAssertTag(A,W,na,Ga){this.Gzd(Ga);this.AHc.debugAssertTag(A,W,na,Ga)}debugTraceTag(A,W,na,Ga){this.Gzd(Ga);this.AHc.debugTraceTag(A,W,na,Ga)}sendTraceTag(A,W,na,Ga){this.Gzd(Ga);this.AHc.sendTraceTag(A,
W,na,Ga)}shipAssertTag(A,W,na,Ga){this.Gzd(Ga);this.AHc.shipAssertTag(A,W,na,Ga)}Gzd(A){if(this.Q_h){const W=window.console;W&&W.log(String.format("FDSpeechService: {0}",A))}}}Object(h.a)(rl,"FrontdoorExternalLogger",null,[318]);class mn{constructor(){this.accessToken=null}}Object(h.a)(mn,"IAuthenticationProvider",null,[]);class Di{constructor(){this.customEndpointConfig=this.userSessionId=this.speechFDBase=this.properties=this.targetLanguages=this.sourceLanguage=this.speechMode=null;this.clientApp=
0;this.clientMetaData=null;this.captureAudioPauseResumeRecordingState=this.requestServiceCustomEndpoint=!1;this.speechProcessorScript=null}}Object(h.a)(Di,"ISpeechConfig",null,[]);class xk{constructor(A,W,na,Ga,Ka){this.ar=this.Mrb=null;this.jPd=!1;this.X7=new dh(na,Ga);this.KV=A;this.xg=W;this.CUh=new ln(Ka,W.yVj);this.xg.Iac&&(A=new fj(W),(W=vc.App.x2a)&&W.Mmh(A))}Ojg(A,W){return new Promise(na=>{this.CUh.getAccessToken(Ga=>{na(this.lNj(A,W,Ga))})})}lNj(A,W,na){this.ar=W;A=this.B0d(A);na=Object.assign(new mn,
{accessToken:na});W=new rl(this.xg.O0c);this.Mrb=(new PPTSpeechClient.SpeechClientFactory).createSpeechClient(A,this.X7,na,null,W);return this.Mrb?0:(e.ULS.shipAssertTag(42796123,394,!1,"Speech client was not successfully created"),3)}dmb(A){if(!this.Mrb)return 3;this.X7.d2a(this.ar,A);this.Mrb.startSpeechRecognition();return 0}pV(A){if(!this.jPd){this.jPd=!0;if(this.Mrb)try{this.Mrb.stopSpeechRecognition()}catch(W){e.ULS.shipAssertTag(593277727,394,!1,W.message)}if(A&&this.X7)this.X7.onSpeechEnd();
this.ar=null;this.jPd=!1}}WI(){return this.X7.WI()}B0d(A){const W=new Di;W.speechMode="Dictation";W.sourceLanguage=A;(A=this.xg.M2f)&&""!==A&&(W.speechFDBase=String.format("wss://{0}/",A));W.properties=new Map;this.KV&&(W.properties.set("DictationInsertionPointLeft",this.KV.Hde()),W.properties.set("DictationInsertionPointRight",this.KV.ocg()));W.properties.set("Corrections","true");W.properties.set("punctuation",this.xg&&this.xg.useAutoPunctuation?"Intelligent":"Explicit");this.xg.O0c&&W.properties.set("EnableAudioLogging",
this.xg.O0c.toString());switch(Rq.a.yUd){case "Word":W.clientApp=1;break;case "PowerPoint":W.clientApp=0;break;case "OneNote":W.clientApp=2}return W}}Object(h.a)(xk,"FrontdoorSpeechClientProxy",null,[607]);class hi{static Jul(){hi.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationAccessDeniedErrorMessage)}static hvl(){hi.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationFailedToConnectErrorMessage)}static ywl(A){hi.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,
A)}static Hxl(){hi.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationUnknownErrorMessage)}static showDialog(A,W){hi.Df||(hi.Df=new fb.StandardDialog,hi.Df.Ir=M.AFrameworkApplication.rea,hi.Df.Ad=0,hi.Df.Oe(1,CommonUIStrings.l_DialogClose),hi.Df.sP(A,W,()=>{hi.Df=null}))}}hi.Df=null;Object(h.a)(hi,"Dialogs",null,[]);class Im{constructor(A,W,na,Ga,Ka,qb,Qb,t){this.Cqb=this.lsb=!1;this.Xx=null;this.KV=A;this.$lg=W;this.Ca=na;this.RNa=Ga;this.xg=Ka;this.B2=qb;
this.TSb=Qb;this.Zba=t;this.Dqf=new T.a;for(A=0;A<Im.Cqf.length;A++)this.Dqf.add(Im.Cqf.charAt(A).toString())}onFinalPhrase(A,W=null){let na=!0;if(this.Xx)this.Xx.onFinalPhrase(A);if(this.TSb&&this.B2){var Ga=this.TSb.bYl(A);if(Ga){this.fEa(!1);this.B2.executeCommand(Ga.commandId,null);return}}Ga=(new Date).getTime();if(1===A.length&&"\n"===A)this.Xee("",null),this.IYf();else{let Ka=A.indexOf("\n");for(0<Ka&&Ka!==A.length-1&&(na=!1);0<=Ka;)this.Xee(A.substr(0,Ka),na?W:null),this.IYf(),A=A.substr(Ka+
1),Ka=A.indexOf("\n"),na=!1;this.Xee(A,na?W:null)}A=(new Date).getTime();if(this.Xx)this.Xx.onTextInserted(!0,A-Ga)}onFragment(A){if(this.lsb)var W=this.yXc(A);else{if(!this.Iuc())return;W=this.Cqb?this.yXc(A):A}if(this.Xx)this.Xx.onFragment(A);A=!0;const na=(new Date).getTime();this.KV&&!this.KV.BBf(W)&&(this.Qeg(),A=!1);W=(new Date).getTime();if(this.Xx)this.Xx.onTextInserted(!1,W-na);A&&this.B2&&this.B2.VXl()}onRecordingStarted(){this.Ca.processAction(de.a.BTf,2);if(this.Xx)this.Xx.onRecordingStarted()}onMicrophoneError(A=
""){this.kfg(Box4Intl.Box4Strings.L_DictationMicrophoneErrorMessage,A)}QIb(A){if(this.Xx)this.Xx.onCustomError(A);this.Ca.Ka(de.a.sTf,2,A)}Zzk(A){this.QIb(A);hi.Jul()}TBk(A){this.QIb(A);hi.hvl()}OIk(A){this.QIb(A);hi.Hxl()}PM(A){this.Xx&&this.Xx.setEndReason(A);this.Ca.Ka(de.a.ATf,2,A)}eEk(A){this.PM(A);this.kxl()}wGk(){this.fEa(!1);this.Ca.processAction(de.a.CTf,2)}onConnectionStarted(A){if(this.Xx)this.Xx.onConnectionStarted(A)}YLe(A){this.kfg(this.mlj(A),A)}onFocusLost(){if(this.Xx)this.Xx.onFocusLost();
this.Ca.processAction(de.a.uTf,2)}K3j(A){return this.$lg&&!ob.a.Kqe(A)&&!this.Dqf.contains(A.toString())}yXc(A){return 0<A.length&&this.K3j(A.charAt(0))?" "+A:A}Iuc(){if(this.lsb)return!0;if(this.KV){const A=this.KV.Hde();this.Cqb=!1;A&&0<A.length&&(this.Cqb=!ob.a.Kqe(A.charAt(A.length-1))&&!A.endsWith("\u201c"));return this.lsb=this.KV.Iuc()}if(this.Xx)this.Xx.onFailedToStartTurn();this.B2&&this.B2.XXl();return!1}fEa(A){this.Cqb=this.lsb=!1;this.KV&&(A&&this.KV.r4g(),this.KV.fEa())}onSpeechSessionStarted(A){if(this.Xx)this.Xx.onSpeechSessionStarted(A);
this.xg.O0c&&this.M1e(A)}kfg(A,W=""){if(this.Xx)this.Xx.onMicrophoneError(W);this.Ca.processAction(de.a.yTf,2);hi.ywl(A)}mlj(A){A=A.trimStart();return A.startsWith("NotAllowedError")||A.startsWith("PermissionDeniedError")?Box4Intl.Box4Strings.L_DictationMicrophoneAccessDeniedMessage:A.startsWith("NotFoundError")||A.startsWith("DevicesNotFoundError")?Box4Intl.Box4Strings.L_DictationMicrophoneNotFoundMessage:A.startsWith("NotReadableError")||A.startsWith("TrackStartError")?Box4Intl.Box4Strings.L_DictationMicrophoneInUseMessage:
Box4Intl.Box4Strings.L_DictationMicrophoneErrorMessage}kxl(){this.RNa&&this.RNa.execute(A=>{A.yvl()})}M1e(A){this.RNa&&this.RNa.execute(W=>{W.M1e(String.format("ServiceSessionID:{0} ClientSessionId: {1}",A,this.JBi))})}Xee(A,W){if(this.lsb||this.Iuc()){if(this.KV){const na=this.Cqb?this.yXc(A):A;(this.xg.Iac&&Object(li.a)(608,this.KV)?this.KV.GXl(na,W,0<A.length&&A.charAt(0)!==na.charAt(0)):this.KV.skg(this.Cqb?this.yXc(A):A))||this.Qeg()}this.fEa(!0)}}Qeg(){if(this.Xx)this.Xx.onTextInsertionError();
this.Ca.processAction(de.a.ETf,2)}IYf(){this.Ca.processAction(de.a.XB,2)}get JBi(){return vc.App.u_?vc.App.u_.$ya:""}}Im.Cqf='-\u2013.,:;/?!"\u3002\uff0c\uff1a\uff1b\u3001\uff1f\uff01\u201d';Object(h.a)(Im,"SpeechClientObserverController",null,[]);class Hn{constructor(A,W,na,Ga,Ka,qb,Qb,t,Y,pa,Ja,Ya){this.UBa=null;this.ROd=new Map;this.TSb=this.B2=this.Zba=this.ar=null;this.rI=A;this.iXh=W;this.Uc=na;this.RNa=Ga;this.ii=Ka;this.xg=qb;this.vPa=Ja;this.Wsf=Ya;this.xg.SL&&(this.Zba=Qb);if(this.xg.zng||
this.xg.ynb)this.B2=t;this.xg.zng&&(this.TSb=Y);this.Job=pa}dmb(A){this.RNa&&this.RNa.execute(Ga=>{Ga.DIj()});const W=this.iXh.value,na=null!==A&&void 0!==A?A:"Box4.Dictation.IDictationHost";return new Promise((Ga,Ka)=>{this.ROd.has(na)?(this.UBa=this.ROd.get(na),this.TYf(Ga,Ka)):this.n$j().then(()=>{if(W){const qb=W.GKi(na);this.UBa=this.UOi(qb);this.ROd.set(na,this.UBa);this.TYf(Ga,Ka)}else Ka(4)}).catch(()=>{Ka(2)})})}TYf(A,W){this.d2a().then(na=>{0===na?A(0):W(na)}).catch(na=>{W(na)})}d2a(){return new Promise((A,
W)=>{this.ar=new gg(this.xg,this.ii);if(this.xg.Oyd||this.xg.ynb)this.ar=new Me(this.xg,this.ii);this.UBa.Ojg(this.xg.rT,this.ar).then(na=>{0!==na?A(na):A(this.UBa.dmb(this.stg()))}).catch(na=>{W(na)})})}n$j(){return this.xg.Oyd||this.xg.ynb?this.zvg("alVoiceClient",!0):this.zvg("PPTSpeechClient")}zvg(A,W=!1){return!W&&this.Wsf&&M.AFrameworkApplication.Aa.ob.Xng?(W=M.AFrameworkApplication.lj(A,2),$l.a(this.Wsf.BCb(W))):this.rI?this.rI.loadScript(A):new Promise((na,Ga)=>{Ga("Unable to load speech client "+
A)})}pV(A=!0){0!==this.WI()&&(this.UBa&&this.UBa.pV(A),this.ar&&(this.ar.endActivity(),this.ar=null))}WI(){return this.UBa?this.UBa.WI():0}stg(){return"zh-CN"!==this.xg.rT&&"ja-JP"!==this.xg.rT}UOi(A){const W=new Im(A,this.stg(),M.AFrameworkApplication.Ra,this.RNa,this.xg,this.B2,this.TSb,this.Zba);return this.xg.Oyd||this.xg.ynb?new Kj(this.Zba,this.B2,2,this.Uc,this.Job,W,this.xg):new xk(A,this.xg,this.Zba,W,this.vPa)}}Object(h.a)(Hn,"DictationManager",null,[]);class cm{constructor(){this.Spf=[];
this.L2a=this.iOd=""}startSession(){this.iOd=aa.a.create().toString();this.Spf=[]}endSession(){this.iOd=""}get $ya(){return this.iOd}get yfh(){return this.Spf}}Object(h.a)(cm,"DictationSessionInfo",null,[547]);class nn{constructor(A,W,na){this.WQd=this.IZb=this.UQd=this.HZb=!1;this.cOa="";this.Oa=A?A:M.AFrameworkApplication.fa;this.g5a=W;this.Uc=na}get useAutoPunctuation(){if(!this.SL||!this.ume)return!1;if(this.UQd)return this.HZb;const A=va.a.instance.getItem("WACDictationFUseAutoPunctuation");
this.HZb=void 0===A||null===A?this.Oa.ka("DictationAutoPunctuationEnglishDefaultOnIsEnabled")?Array.contains(mg.zoi,this.rT):!1:Boolean.parse(A);this.UQd=!0;return this.HZb}set useAutoPunctuation(A){this.SL&&this.ume&&(this.HZb=A,this.UQd=!0,va.a.instance.setItem("WACDictationFUseAutoPunctuation",this.HZb.toString()))}get qRb(){if(!this.SL||!this.Iqe)return!1;if(this.WQd)return this.IZb;const A=va.a.instance.getItem("WACDictationFloatieUseVoiceCommands");this.IZb=void 0===A||null===A?!0:Boolean.parse(A);
this.WQd=!0;return this.IZb}set qRb(A){this.SL&&this.Iqe&&(this.IZb=A,this.WQd=!0,va.a.instance.setItem("WACDictationFloatieUseVoiceCommands",this.IZb.toString()))}get ume(){return Array.contains(mg.Aoi,this.rT)}get Iqe(){return this.ynb&&Array.contains(mg.XTl,this.rT)}get rT(){""===this.cOa&&(this.cOa=this.Zej());return this.cOa}set rT(A){A&&(this.cOa=A)}get Iac(){return this.SL}get SL(){return this.Oa.ka("WacBox4DictationFloatieIsEnabled")}get ARl(){return this.Oa.ka("WacBox4DictationInternalArticle")}get M2f(){return this.Oa.Ha("DictationFrontdoorDomain")}get Oyd(){return this.Oa.ka("WacBox4DictationUseAugloopService")}get zng(){return this.Oa.ka("WacBox4DictationCommandsIsEnabled")&&
this.SL}get ynb(){return this.Oa.ka("WacBox4DictationUseAugloopServiceWithFrontdoor")}get yVj(){return this.Oa.ka("WacDictationAuthenticationEnabled")}get O0c(){return this.Oa.ka("DictationDebugModeEnabled")}get Iih(){return this.getSupportedLanguages(0)}get Hhh(){return this.getSupportedLanguages(1)}get zVj(){return Z.a.iGh&&this.Oa.ka("UserCanUseDictation")}getSupportedLanguages(A){const W=[];A=0===A?mg.productionLanguages:mg.previewLanguages;for(const na of A)Array.add(W,new wm(na));W.sort((na,
Ga)=>na.displayName.localeCompare(Ga.displayName));return W}Zej(){if(this.g5a&&this.Uc){const A=this.g5a.YVc(this.Uc.Yj);for(const W of this.Iih)if(W.LCID===A)return W.c4c;for(const W of this.Hhh)if(W.LCID===A)return W.c4c}return mg.BRi}}Object(h.a)(nn,"DictationSettings",null,[]);class on{constructor(){this.zef=this.Da=null}get name(){return"Box4.Dictation"}Yb(A){this.Da=A;const W=I.a.instance.qb("Common.IDynamicScriptLoaderProvider");let na=null;W&&(na=W.rI);const Ga=I.a.instance.oe("Box4.Dictation.IDictationHostFactory");
this.Da.register(nn,"Box4.Dictation.DictationSettings").ma().oa(()=>new nn(this.Da.resolve("Common.IAppSettingsManager"),this.Da.resolve("Box4.ILanguageReader"),this.Da.resolve("Box4.ISelectionManager")));const Ka=I.a.instance.oe("Common.IDictationFloatieController");this.Da.register(Yn,"Box4.Dictation.DictationFloatieManager").ma().oa(()=>new Yn(Ka,this.Da.resolve("Box4.Dictation.DictationSettings")));this.Da.register(Hn,"Box4.Dictation.DictationManager").ma().oa(()=>new Hn(na,Ga,this.Da.resolve("Box4.ISelectionManager"),
A.Ia("Box4.IBusinessBarController"),A.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.Da.resolve("Box4.Dictation.DictationSettings"),this.Da.resolve("Box4.Dictation.DictationFloatieManager"),this.Da.qb("Box4.DictationCommands.IDictationCommandManager"),this.Da.qb("Box4.DictationCommands.IDictationCommandParser"),this.Da.qb("Box4.DictationCommands.IDictationCommandsTelemetry"),this.Da.resolve("Common.App.OAuth.IOAuthManager"),this.Da.resolve("Common.ISharedDependencyLoader")));this.Da.register(547,
"Box4.Dictation.IDictationSessionInfo").ma().oa(()=>new cm)}init(){this.Da.resolve("Box4.Dictation.IDictationSessionInfo");this.zef=dk.createInstance(this.Da.oe("Common.IRibbonButtonUpdater"),this.Da.resolve("Box4.Dictation.DictationManager"),this.Da.resolve("Box4.IFormattingEditor"),this.Da.resolve("Box4.IFormattingReader"),this.Da.resolve("Box4.Dictation.DictationFloatieManager"),this.Da.resolve("Box4.Dictation.DictationSettings"),this.Da.oe("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),
mc.FocusManager.instance());this.zef.vb();vc.App.Lb.updateCommandUI()}dispose(){}}Object(h.a)(on,"DictationPackageManager",null,[2,3]);class $n{constructor(A){this.K=A}GKi(A){return this.K.resolve(A)}}Object(h.a)($n,"DictationHostFactory",null,[545]);class xm{constructor(A,W,na){this.ZX=null;this.fG=this.DX=-1;this.$Db=!1;this.BJ=A;this.pa=W;this.ia=na}Hde(){return this.rcg(!1)}ocg(){return this.rcg(!0)}Iuc(){this.ZX&&this.fEa();const A=this.pa.Pa.mb;if(A){const W=A.Va;if(W&&Bg.ParagraphReader.ae(W.node))return this.ZX=
W.node,this.fG=A.Va.wQa,this.DX=A.Va.vsb,this.$Db=!0}return!1}fEa(){this.ZX=null;this.$Db=!1;this.DX=this.fG=-1}BBf(A){if(this.ZX){const W=new Ih.GraphTransaction(15);try{W.ld(this.ZX);const na=this.$Db&&this.fG!==this.DX?sf.a.createTextRange(this.ZX,this.fG,this.DX):sf.a.Lj(this.ZX,this.DX);this.BJ.replaceTextRange(na,A);this.DX=this.$Db?this.fG+A.length:this.DX+A.length;const Ga=Cl.SelectionFactory.Qg(this.ZX,this.DX);this.pa.setSelection(Ga);this.$Db=!1;return!0}finally{W&&W.dispose()}}return!1}skg(A){if(this.ZX){const W=
new Ih.GraphTransaction(15);try{W.ld(this.ZX);const na=this.fG!==this.DX?sf.a.createTextRange(this.ZX,this.fG,this.DX):sf.a.Lj(this.ZX,this.DX);this.BJ.replaceTextRange(na,A);this.DX=this.fG+A.length;const Ga=Cl.SelectionFactory.Qg(this.ZX,this.DX);this.pa.setSelection(Ga);this.$Db=!1;return!0}finally{W&&W.dispose()}}return!1}r4g(){var A=this.Dfj();this.ia&&A&&A.wQa!==A.vsb&&0<=A.wQa&&(A=sf.a.createTextRange(A.node,A.wQa,A.vsb),this.ia.Ka(de.a.zTf,2,A))}Dfj(){return this.ZX?this.fG!==this.DX?sf.a.createTextRange(this.ZX,
this.fG,this.DX):sf.a.Lj(this.ZX,this.DX):null}rcg(A){var W=this.pa.Pa.mb;if(W){var na=W.Va;if(na&&(W=na.node,Bg.ParagraphReader.ae(W)&&(na=A?na.vsb:na.wQa,W=Bg.ParagraphReader.text(W),na<=W.length)))return A?W.substring(na,W.length):W.substring(0,na)}return""}}Object(h.a)(xm,"DictationHost",null,[546]);class dl{get name(){return"PowerPointWebEditor.Dictation"}Yb(A){A.register($n,"PowerPointWebEditor.Dictation.DictationHostFactory").as("Box4.Dictation.IDictationHostFactory").ma().oa(()=>new $n(A));
A.register(xm,"PowerPointWebEditor.Dictation.DictationHost").as("Box4.Dictation.IDictationHost").ma().oa(()=>new xm(A.resolve("Box4.ICharacterPropertiesEditor"),A.resolve("Box4.ISelectionManager"),M.AFrameworkApplication.Ra))}init(){}dispose(){}static main(){Ia.a.instance.Ac(new dl)}}Object(h.a)(dl,"PPTWebEditorDictationPackage",null,[2,3]);var ok=d(462);class Ok{constructor(A,W,na=null){this.id=A.Id;na||(na="");this.l0k=na;this.sensitivityLabel=A}}Object(h.a)(Ok,"AutoPolicyLabelData",null,[]);class Jm{constructor(A,
W){this.p8=A;this.displayName=W}}Object(h.a)(Jm,"PolicyLabelRequestState",null,[]);class Zg{constructor(){this.AYe=this.RJe=""}}Object(h.a)(Zg,"PolicyStrings",null,[]);class Tm{static get Uqe(){return Tm.S6j}}Tm.S6j="<div class='WACDialogRow' id='JustificationMessageBlock'> <div class='WACDialogIcon' id='JustificationIconArea'> <div class='clip32x32' id='JustificationIconClip' unselectable='on' style='z-index: 0; display: inline-block;'> <img id='iconJustification' class='{1}' role='presentation' src={0} /> </div> </div> <div class='WACDialogTextPanel WACJustificationDialogMessage' id='JustificationMessageArea'> <label id='messageJustification' class='WACDialogLabel' >{2}</label> </div> </div> <br/> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock0'> <input type='radio' id='radiobox0' name='ListRadioBox' class='WACDialogRadio' alt='{3}' title='{3}'></input> <label id='JustificationDlgList0' class='WACDialogLabel' for='radiobox0' >{3}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock1'> <input type='radio' id='radiobox1' name='ListRadioBox' class='WACDialogRadio' alt='{4}' title='{4}'></input> <label id='JustificationDlgList1' class='WACDialogLabel' for='radiobox1' >{4}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock2'> <input type='radio' id='radiobox2' name='ListRadioBox' class='WACDialogRadio' alt='{5}' title='{5}'></input> <label id='JustificationDlgList2' class='WACDialogLabel' for='radiobox2' >{5}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow WACJustificationDialogTextAreaRow' id='JustificationTextAreaBlock'> <textarea id='txtJustification' class='JustificationTextArea' placeholder='{6}' style='border:solid 1px grey;resize:none;' autocomplete=\"off\"></textarea> </div>";
Object(h.a)(Tm,"JustificationDialogHtml",null,[]);class Nh extends xb.a{constructor(A,W){super(!1,!1,Nh.k2);this.WOa=[CommonUIStrings.l_SensitivityJustificationNoLongerApplies,CommonUIStrings.l_SensitivityJustificationIncorrect,CommonUIStrings.l_SensitivityJustificationOther];this.pFc=null;this.oFc=!1;this.cGc=A;this.UD=W;this.sg=this.Fri();this.Ad=1;this.kg=Nh.id;this.Oe(1,CommonUIStrings.l_DialogChange);this.dF(1,!1);this.dza(0)}c2e(){if(Nh.k2)this.pj(CommonUIStrings.l_SensitivityJustificationTitle,
Object(n.a)(this,this.ilh,"reactJustificationDialogHandler"),this.T$f(this.oFc));else{const A={};for(let W=0;W<this.WOa.length;W++)A[Nh.iTe+W]=!1;A[Nh.Evc]="";this.pj(CommonUIStrings.l_SensitivityJustificationTitle,Object(n.a)(this,this.R6j,"justificationDialogHandler"),A);this.xUe();id.a.addHandler($get(Nh.Evc),Wb.a.input,Object(n.a)(this,this.bFl,"textAreaHandler"))}}validate(){if(Nh.k2)return this.VPh(this.pFc);const A=$get(Nh.Evc);return A.disabled?!0:this.VPh(A.value)}VPh(A){const W=2>A.length,
na=500<A.length,Ga=RegExp("[{|}|;|\\\\]").test(A);A=""===ob.a.TUe(A);return!W&&!na&&!Ga&&!A}R6j(A,W){let na="";if(1===A)for(let Ga=0;Ga<this.WOa.length;Ga++)if(W[Nh.iTe+Ga]){na=Ga===this.WOa.length-1?W[Nh.Evc]:this.WOa[Ga];break}this.UD(A,this.cGc,na)}ilh(A){let W="";1===A&&this.pFc&&(W=this.pFc);this.UD(A,this.cGc,W)}uEk(A){this.pFc=A;A=this.validate();this.oFc!==A&&(this.oFc=A,this.b7(CommonUIStrings.l_SensitivityJustificationTitle,Object(n.a)(this,this.ilh,"reactJustificationDialogHandler"),this.T$f(this.oFc)))}T$f(A){return{["id"]:this.kg,
["bodyControls"]:{["choiceGroupProps"]:{},["textAreaProps"]:{["placeholder"]:CommonUIStrings.l_SensitivityJustificationPlaceholder}},["actionButtonProps"]:{["label"]:CommonUIStrings.l_DialogChange,["disabled"]:!A},["infoMessage"]:CommonUIStrings.l_SensitivityJustificationMessage,["justificationIrrelevantLabel"]:CommonUIStrings.l_SensitivityJustificationNoLongerApplies,["justificationIncorrectLabel"]:CommonUIStrings.l_SensitivityJustificationIncorrect,["justificationOtherLabel"]:CommonUIStrings.l_SensitivityJustificationOther,
["onJustificationUpdated"]:Object(n.a)(this,this.uEk,"onJustificationUpdated")}}bFl(A){A.target&&this.dF(1,this.validate())}Fri(){return xb.a.VC(Nh.Uqe,M.AFrameworkApplication.Cm,dj.getImageClass(Nh.iconName),CommonUIStrings.l_SensitivityJustificationMessage,this.WOa[0],this.WOa[1],this.WOa[2],CommonUIStrings.l_SensitivityJustificationPlaceholder)}xUe(){const A=document.getElementsByName(Nh.m9j);for(let W=0;W<A.length;W++)id.a.addHandler(A[W],Wb.a.focus,Object(n.a)(this,this.Lnd,"radioButtonFocusHandler")),
id.a.addHandler(A[W],Wb.a.click,Object(n.a)(this,this.Lnd,"radioButtonFocusHandler"))}Lnd(A){if(A=A.target){A.checked=!0;var W=$get(Nh.Evc);A.id===Nh.iTe+(this.WOa.length-1)?(W.disabled=!1,Sys.UI.DomElement.setVisible(W,!0),W.focus()):(W.disabled=!0,A.focus());this.dF(1,this.validate())}}static get k2(){return M.AFrameworkApplication.Aa.ob.hD&&M.AFrameworkApplication.Aa.ob.lpe}}Nh.Uqe=Tm.Uqe;Nh.m9j="ListRadioBox";Nh.iTe="radiobox";Nh.Evc="txtJustification";Nh.iconName="Info_32x32x32";Nh.id="JustificationDialog";
Object(h.a)(Nh,"JustificationDialog",xb.a,[]);class ym extends xb.a{constructor(A,W,na){super(!1,!1,!0);if(A&&na){var Ga={["id"]:"MandatoryLabellingDialog"};this.eXh=na;this.hJd=W;if(!M.AFrameworkApplication.fa.ka("MandatoryLabelingDialogLearnMoreSwitchIsEnabled")||this.hJd&&""!==this.hJd)Ga.learnMoreLink={["type"]:"AppLinkProps",["id"]:"mandatoryLabellingLearnMoreLink",["text"]:CommonUIStrings.l_LearnMore,["handler"]:{["href"]:this.hJd,["target"]:"_blank"},["customTooltip"]:CommonUIStrings.L_LearnMoreTooltip};
W={["sections"]:[],["shouldAutoOpen"]:!1};Array.add(W.sections,{["id"]:"mandatoryLabellingFlyoutMenuSection",["controls"]:A});Ga.labelFlyout={["type"]:"AppFlyoutAnchorProps",["id"]:"mandatoryLabellingFyout",["label"]:"Pick a label",["hideLabel"]:!1,["hideChevron"]:!1,["hideIcon"]:!0,["menuDefinition"]:W};A={["id"]:"MandatoryLabellingDialog",["bodyControls"]:Ga};Ga.initialLabelText=CommonUIStrings.l_MandatoryLabellingDialogInitialLabelText;Ga.descriptionText=CommonUIStrings.l_MandatoryLabellingDialogDescriptionText;
this.pj(CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,Object(n.a)(this,this.Mtk,"mandatoryLabellingDialogHandler"),A)}else e.ULS.sendTraceTag(560547850,306,10,"MandatoryLabelingDialog was triggered with invalid inputs")}Mtk(A,W){1===A&&W.selectedLabel&&(A=W.selectedLabel,""!==A&&this.eXh(A))}}Object(h.a)(ym,"MandatoryLabellingDialog",xb.a,[]);class sl{constructor(){this.Qqa=!!M.AFrameworkApplication.Aa&&M.AFrameworkApplication.Aa.ob.hD}pMi(A,W,na){this.Qqa&&new ym(A,W,na)}static get instance(){return sl.La||
(sl.La=new sl)}}sl.La=null;Object(h.a)(sl,"MandatoryLabellingDialogFactory",null,[603]);class jf{}jf.nBl="sbProtectForm14";jf.pBl="SBStatusBarMarkAsReadOnly14";jf.y8j="Info_16x16x32";jf.xJf="QuickSearchCompletedToday_16x16x32";jf.GTe="CommonControlCheckboxCheck_16";jf.XIh="On";jf.visible="Visible";jf.$6i="ImageIsVisible";jf.mV="SourceControlId";jf.menuItemId="MenuItemId";jf.menu="Menu";jf.hBf="AppLockId";jf.value="Value";jf.labelText="LabelText";jf.alt="Alt";jf.Jig="Image16by16";jf.Qzb="Image16by16Class";
jf.mBl="SBProtectForm_16";jf.oBl="SBStatusBarMarkAsReadOnly_16";jf.icon="Icon";jf.iconColor="IconColor";jf.customTooltip="CustomTooltip";jf.M_k="MipTagDynamicFillWithOutline_20";jf.N_k="MipTagLockDynamicFillWithOutline_20";jf.L_k="MipTagErrorOutline_20";jf.O_k="MipTagQuestionOutline_20";jf.c7e="transparent";jf.qLl="UILocation";Object(h.a)(jf,"PolicyConstants",null,[]);class pk extends xb.a{constructor(A,W,na){super(!1,!1,pk.k2);this.cGc=A;this.S2=W;this.UD=na;this.Ad=1;this.kg=pk.id;this.dza(1);this.dza(0)}D2e(){const A=
{["id"]:"UserDefinedPermissionsDialog"};pk.k2&&this.pj("Defined Permissions",Object(n.a)(this,this.ZRl,"userDefinedPermissionsDialogHandler"),A)}ZRl(A){1!==A&&this.UD(A,this.cGc,"",this.S2)}static get k2(){return M.AFrameworkApplication.Aa.ob.hD&&M.AFrameworkApplication.Aa.ob.lpe}}pk.id="UserDefinedPermissionsDialog";Object(h.a)(pk,"UserDefinedPermissionsDialog",xb.a,[]);var qk=d(592),yk=d(156),rk=d(477);class zk{constructor(A,W,na,Ga){this.CId=this.TVb=null;this.Sjf=this.PHd=this.qId=this.CVb=this.klf=
this.Vmf=this.jDd=!1;this.Qob=this.QAa=this.FBa=this.LNa=this.S2=this.ov=this.Dia=this.Nh=null;this.pWh=this.mBd=0;this.IEd=this.Skf=this.Ubf=this.dMd=null;this.Ca=A;this.Xh=W;this.Oa=na;this.ak=Ga;this.DWb={};this.Wpf={};this.Xmf={};this.l0c=na.ka("WacApplyManualPolicyLabelIsEnabled");this.ak.value.yTd(Object(n.a)(this,this.MQe,"processAutoSensitivityLabel"));this.ak.value.Ozf(Object(n.a)(this,this.MQe,"processAutoSensitivityLabel"));this.ak.value.$Sd(Object(n.a)(this,this.QIk,"onUpdateLabelInfo"));
M.AFrameworkApplication.Aa&&M.AFrameworkApplication.Aa.GI(Object(n.a)(this,this.Z1k,"refreshDocumentPolicyLabelsOnModeChange"));na.ka("SupportsPolicies")&&na.Ha("AppliedPolicyId")&&(this.TVb=na.Ha("IrmPolicyTitle"),this.CId=na.Ha("IrmPolicyDescription"));this.FUh=this.Oa.wc("SetPolicyLabelAwaitFileExistsOnHostMaxRetries",6);this.GUh=this.Oa.wc("SetPolicyLabelAwaitFileExistsOnHostRetryDelayMs",5E3)}get Zua(){return M.AFrameworkApplication.Zua||!!this.Skf&&this.Skf()}vb(){this.Ca.ya(sa.a.yNe,fc.a.frame,
Object(n.a)(this,this.BQc,"documentLabelPaneHandler"));this.Ca.ra(sa.a.YKb,fc.a.frame,Object(n.a)(this,this.YKb,"queryPolicyLabel"),96);this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpQueryShortLabelEnabled",!1)&&(this.Ca.ya(sa.a.Fch,fc.a.frame,Object(n.a)(this,this.BQc,"documentLabelPaneHandler")),this.Ca.ra(sa.a.Npc,fc.a.frame,Object(n.a)(this,this.Npc,"queryPolicyShortLabel"),96));this.Ca.ya(sa.a.Vmb,fc.a.frame,Object(n.a)(this,this.Vmb,"toggleSensitivity"));this.Ca.ya(sa.a.Uib,
fc.a.frame,Object(n.a)(this,this.Uib,"populateSensitivityFlyout"));this.Ca.ya(sa.a.plb,fc.a.frame,Object(n.a)(this,this.plb,"setSensitivity"));this.Ca.ra(sa.a.Spc,fc.a.frame,Object(n.a)(this,this.Spc,"querySensitivity"),96);this.Ca.ya(sa.a.Bjb,fc.a.frame,Object(n.a)(this,this.Bjb,"querySensitivityToggleButton"));this.Ca.ya(sa.a.Ajb,fc.a.frame,Object(n.a)(this,this.Ajb,"querySensitivitySubFlyout"));this.a_b(sa.a.Vmb)||this.Ca.he(sa.a.Vmb,4);this.a_b(sa.a.Uib)||this.Ca.he(sa.a.Uib,4);this.a_b(sa.a.plb)||
this.Ca.he(sa.a.plb,4);this.a_b(sa.a.Bjb)||this.Ca.he(sa.a.Bjb,4);this.a_b(sa.a.Ajb)||this.Ca.he(sa.a.Ajb,4);this.Xh.updateCommandUI();M.AFrameworkApplication.fa&&Ad.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")&&this.ak.value.z7k(Object(n.a)(this,this.ymh,"registerActionsHandler"))}ymh(){this.vb()}qMh(){this.Ca.iK(sa.a.yNe,fc.a.frame,Object(n.a)(this,this.BQc,"documentLabelPaneHandler"));this.Ca.iK(sa.a.YKb,fc.a.frame,Object(n.a)(this,
this.YKb,"queryPolicyLabel"));this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpQueryShortLabelEnabled",!1)&&(this.Ca.iK(sa.a.Fch,fc.a.frame,Object(n.a)(this,this.BQc,"documentLabelPaneHandler")),this.Ca.iK(sa.a.Npc,fc.a.frame,Object(n.a)(this,this.Npc,"queryPolicyShortLabel")));this.Ca.iK(sa.a.Vmb,fc.a.frame,Object(n.a)(this,this.Vmb,"toggleSensitivity"));this.Ca.iK(sa.a.Uib,fc.a.frame,Object(n.a)(this,this.Uib,"populateSensitivityFlyout"));this.Ca.iK(sa.a.plb,fc.a.frame,Object(n.a)(this,
this.plb,"setSensitivity"));this.Ca.iK(sa.a.Spc,fc.a.frame,Object(n.a)(this,this.Spc,"querySensitivity"));this.Ca.iK(sa.a.Bjb,fc.a.frame,Object(n.a)(this,this.Bjb,"querySensitivityToggleButton"));this.Ca.iK(sa.a.Ajb,fc.a.frame,Object(n.a)(this,this.Ajb,"querySensitivitySubFlyout"))}Vmb(){return 32}W3f(A){const W="mandatoryLabelling_"+A.Id;this.Xmf[W]=A.Id;return{["type"]:"AppToggleButtonProps",["id"]:W,["label"]:A.DisplayName,["hideLabel"]:!1,["customTooltip"]:A.Tooltip}}Rcb(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UDPEnabled",
!1)}Vkj(){const A=[],W=this.Dia;for(let Ga in W){var na=W[Ga];const Ka=this.ov[Ga];if(Ka&&Ka.Enabled&&!Ka.HasUserDefinedPermissions)if(na.count){const qb={["sections"]:[],["shouldAutoOpen"]:!1},Qb={["id"]:"mandatoryLabelling_flyoutMenuSection_"+Ka.Id,["controls"]:[]};for(let t of na)(na=this.ov[t])&&na.Enabled&&!na.HasUserDefinedPermissions&&Array.add(Qb.controls,this.W3f(na));Array.add(qb.sections,Qb);Array.add(A,{["type"]:"AppFlyoutAnchorProps",["id"]:"mandatoryLabelling_"+Ka.Id,["label"]:Ka.DisplayName,
["hideLabel"]:!1,["hideChevron"]:!1,["hideIcon"]:!1,["menuDefinition"]:qb})}else Array.add(A,this.W3f(Ka))}return A}Uib(A,W,na,Ga,Ka){if(1===na||!this.ak.value.i0b(!0))return 32;Ka.MenuItems=Object.assign(new sh.a,{Id:"SensitivityList",MenuSectionList:[],UpdateDynamically:!0});Array.add(Ka.MenuItems.MenuSectionList,this.COc(!this.isReactRibbonEnabled()));this.Nh.CustomUrl&&Array.add(Ka.MenuItems.MenuSectionList,this.WLi(this.isReactRibbonEnabled()?this.Nh.CustomUrl:ob.a.xe(this.Nh.CustomUrl)));this.isReactRibbonEnabled()||
(Ka.PopulationXML=If.l(Ka.MenuItems));return 32}Spc(A,W,na,Ga,Ka){if(1===na||!Ka||!this.l0c)return 32;this.Nh=this.ak.value.qv;if(this.ak.value.i0b(!0)&&(Ka[jf.visible]=!0,this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LabelsAvailableActivityControlEnabled",!1)?this.klf||(Ud.a("MipLabelsAvailable"),this.klf=!0):Ud.a("MipLabelsAvailable"),this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelTUIEnabled",!1)&&this.Nh&&this.Nh.AreLabelsAvailable&&(A=I.a.instance.Ia("Common.ISystemInitiatedFeedback")))){const qb=
zk.Xa(this.Nh.AppliedPolicyId)?"LouderLabel_NoLabelAppliedOnLoadActivity":"LouderLabel_LabelExistsOnLoadActivity";A.execute(Qb=>{Qb.logActivity(qb,null)})}return 32}Bjb(A,W,na,Ga,Ka){if(1===na||!Ka)return 32;let qb,Qb;Ka[jf.XIh]=!!(qb=Ka[jf.menuItemId])&&!!(Qb=this.DWb[qb])&&Qb===this.Nh.AppliedPolicyId;return 32}Ajb(A,W,na,Ga,Ka){if(1===na||!Ka)return 32;let qb,Qb,t;A=!!(qb=Ka[jf.mV])&&!!(Qb=this.DWb[qb])&&!!(t=this.Dia[Qb])&&t.contains(this.Nh.AppliedPolicyId);Ka[jf.$6i]=A;Ka[jf.XIh]=A;return 32}plb(A,
W,na,Ga,Ka){if(1===na||!Ka)return 32;A=this.DWb[Ka[jf.mV]];W=this.rLl(Ka[jf.qLl]);na=new hd.a;na.name="SensitivityPickerLocation";na.int64=W;Ud.a("SensitivityPickerUsage",void 0,void 0,[na]);return this.TLa(A,Ka,2)}R0c(){return!!M.AFrameworkApplication.Aa&&1===M.AFrameworkApplication.Aa.mode}Z1k(){this.PHd&&!this.R0c()&&(this.PHd=!1,this.ak.value.Y1k())}jIl(){this.Nh.DefaultLabelId&&this.Nh.MandatoryLabelingEnforced?this.jDd||this.R0c()?this.Nh.AppliedPolicyId?this.R5d(""):(this.ak.value.X1j(this.ak.value.adc)||
this.R0c())&&this.eXf():this.qwh():this.Nh.DefaultLabelId?this.qwh():this.Nh.MandatoryLabelingEnforced&&(this.Nh.AppliedPolicyId?this.R5d(""):this.eXf())}Epg(){return this.Nh.MandatoryLabelingEnforced?this.Nh&&this.Nh.AreLabelsAvailable?this.Oa.ka("TestOverrideIsReactDialogEnabled")||this.Xh&&this.Xh.ob&&this.Xh.ob.hD?!0:(e.ULS.sendTraceTag(539109065,306,50,"Mandatory labelling not invoked b/c react dialogs disabled!"),!1):(e.ULS.sendTraceTag(539109064,306,50,"Mandatory labelling not invoked b/c there are no sensitivity labels!"),
!1):(e.ULS.sendTraceTag(539109063,306,50,"Mandatory labelling not invoked b/c user did not have policy!"),!1)}eXf(){!this.Epg()||M.AFrameworkApplication.VQ||this.Vmf||(this.Vmf=M.AFrameworkApplication.VQ=!0,e.ULS.sendTraceTag(562837517,306,50,"Mandatory labelling is invoked successfully."),this.ak.value.hkh("",1),this.ak.value.tSd(37,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,CommonUIStrings.l_MandatoryLabellingDialogDescriptionText,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarButton,
()=>{this.Ktk()}))}R5d(A){this.Epg()&&M.AFrameworkApplication.VQ&&(M.AFrameworkApplication.VQ=!1,e.ULS.sendTraceTag(562837518,306,50,"Mandatory labelling is escaped successfully."),this.ak.value.bVe(),this.ak.value.hkh(A,2))}Ktk(){sl.instance.pMi(this.Vkj(),this.Nh.CustomUrl,Object(n.a)(this,this.Ltk,"mandatoryLabellingDialogCallback"))}Ltk(A){this.R5d(this.Xmf[A])}dEf(){return this.Oa.ka("CoAuthForProtectedFilesEnabled")&&this.Oa.ka("SupportsOfficeClientCoauthoring")&&this.Oa.ka("SetPolicyLabelAwaitFileExistsOnHostIsEnabled")&&
!!this.IEd&&this.Zua}TLa(A,W,na,Ga=null){this.ak.value.lZk(na);let Ka=32,qb=!1,Qb=!0;const t=2===na||8===na||16===na,Y=A===this.Nh.AppliedPolicyId;if(this.Ubf&&this.Ubf(A,t))e.ULS.sendTraceTag(42860829,306,15,"SetSensitivity : As app doesn't support changing the label, skipping SetSensitivity call. ApplyLabelFlag : {0}",na),this.Xh.updateCommandUI();else if(W&&jf.hBf in W&&this.ak.value.i_e(W[jf.hBf]),A)if(this.ak.value.Org()||this.dEf()&&this.qId)e.ULS.sendTraceTag(42796168,306,50,"Policy label cannot be set because a set policy label request is already in progress. ApplyLabelFlag: {0}",
na),this.Xh.updateCommandUI(),t&&this.IJc(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityQuickApplicationErrorMessage);else if(this.Oa.ka("HasDocumentEditRights"))if(this.ak.value.dxi(A))if(!this.Rcb()&&this.ov[A]&&this.ov[A].HasUserDefinedPermissions&&!Y)e.ULS.sendTraceTag(540608323,306,50,"UDP label cannot be applied during UDP in WAC Phase 1. ApplyLabelFlag: {0}",na),1!==na&&4!==na&&this.ski();else if(t&&this.Nh.MandatoryLabelingEnforced&&Y)e.ULS.sendTraceTag(570972054,
306,50,"Policy label cannot be removed due to mandatory labeling. ApplyLabelFlag: {0}",na),this.IJc(CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogTitle,CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogDescriptionText);else{if(t&&this.Oa.ka("WacLabelingJustificationDialogIsEnabled")&&this.Nh.RequiredDowngradeJustification&&(Y||this.ov[A].RequiredDowngradeJustification)&&(this.Rcb()?!this.Sjf&&!Ga:!this.S2))return e.ULS.sendTraceTag(570972055,306,50,"Downgrade justification is required. ApplyLabelFlag: {0}",
na),this.c2e(A),Ka;if(this.Rcb()&&this.ov[A].HasUserDefinedPermissions&&!Y)return e.ULS.sendTraceTag(523019968,306,50,"UDP Label is selected. ApplyLabelFlag: {0}",na),this.D2e(A,Ga),Ka;if(this.dEf()&&!this.IEd())this.mBd<this.FUh?(e.ULS.sendTraceTag(577356770,306,50,"File does not exist on host, retrying after delay. RetryCount: {0} ApplyLabelFlag: {1}",this.mBd,na),this.qId=!0,this.mBd++,ge.Task.delay(this.GUh).continueWith(()=>{this.qId=!1;this.TLa(A,W,na)})):(e.ULS.sendTraceTag(577356771,306,15,
"Policy label cannot be set because maximum retries were reached checking for file existence. ApplyLabelFlag: {0}",na),qb=1!==na,Qb=!1,Ka=8);else{if(this.j0j(A)&&(e.ULS.sendTraceTag(553911752,306,15,"Policy label cannot be set because the selected label is a parent label. ApplyLabelFlag: {0}",na),1===na||8===na||4===na))return Ka;e.ULS.sendTraceTag(570972056,306,50,"SetSensitivityByPolicyId is succeeded. ApplyLabelFlag: {0}",na);this.setPolicyLabel(Y?"":A,this.Rcb()?Ga:this.S2,"",na);return Ka}}else e.ULS.sendTraceTag(42796169,
306,50,"Policy label cannot be set because the user is in a coauth session. ApplyLabelFlag: {0}",na),this.Xh.updateCommandUI(),t&&this.IJc(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityCoauthApplicationErrorMessage);else e.ULS.sendTraceTag(558892739,306,50,"Policy label cannot be set because the user doesn't have edit rights. ApplyLabelFlag: {0}",na),this.Xh.updateCommandUI(),t&&this.IJc(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityNoEditRightsErrorMessage);
else e.ULS.sendTraceTag(42796167,306,15,"Policy label cannot be set because the selected policy ID is null. ApplyLabelFlag: {0}",na),this.Xh.updateCommandUI(),qb=t,Qb=!1,Ka=8;this.ak.value.Fkh(0,na,qb,Qb);return Ka}iCf(A,W,na=null,Ga=!1){B.Health.instance.recordKpiUsage("MipAutoClassificationSetLabel",0,"wordclpfc",null);this.Oa.ka("SupportsOfficeClientCoauthoring")&&this.Oa.ka("CoAuthForProtectedFilesIsEnabled")?(this.CVb=!1,(this.Nh=this.ak.value.qv)&&!this.Nh.AppliedPolicyId?this.CVb=!0:this.Nh&&
this.Nh.PolicyLabelAssignmentMethod&&(this.CVb=yk.e(this.Nh.PolicyLabelAssignmentMethod)===yk.e("standard"))):this.CVb=Ga;A=zk.Xa(A)?null:this.ov[A];(W=zk.Xa(W)?null:this.ov[W])?this.FBa=new Ok(W,!0,na):(this.ak.value.Dya(29),this.QAa=null);A?this.LNa=new Ok(A,!1):this.Qob=null;this.MQe(null,null)}bmi(A){this.TLa(A,null,16)}pll(){this.ov={};if(this.Nh=this.ak.value.qv)for(const A of this.Nh.SensitivityLabels)this.ov[A.Id]=A}j0j(A){if(this.Dia&&A in this.Dia){A=this.Dia[A];for(let W of A)if((A=this.ov[W])&&
A.Enabled)return!0}return!1}Pml(){this.Dia={};if(this.Nh=this.ak.value.qv){for(const A of this.Nh.SensitivityLabels)A.ParentId||(this.Dia[A.Id]=new Ea.a);for(const A of this.Nh.SensitivityLabels){if(this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RemoveDisabledLabelsFromChildLabel",!1)){if(!(A.ParentId&&A.ParentId in this.Dia&&A.Enabled))continue}else if(!(A.ParentId&&A.ParentId in this.Dia))continue;this.Dia[A.ParentId].add(A.Id)}}}sWk(){this.Nh=this.ak.value.qv;const A=this.l0c&&this.isReactRibbonEnabled()&&
this.ak.value.i0b();zk.Apd(A)}f3k(A){this.IEd=A}qwh(){if(this.Oa.ka("WacApplyDefaultPolicyLabelIsEnabled"))if(this.R0c())this.PHd=!0;else if(!this.jDd)if(this.jDd=!0,this.Nh=this.ak.value.qv,this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultLabelForSPODocLibEnabled",!1)){if(this.Nh&&this.Nh.DefaultLabelId)if(!this.Nh.AppliedPolicyId)e.ULS.sendTraceTag(509732190,306,50,"Default labeling triggered. DefaultLabelType: {0}",this.Nh.DefaultLabelType),this.TLa(this.Nh.DefaultLabelId,null,
1);else if(m.a.Ml().equals(this.Nh.DefaultLabelType,"documentLibraryDefault")){const A=this.ov[this.Nh.AppliedPolicyId],W=this.ov[this.Nh.DefaultLabelId];this.Nh.AppliedPolicyId!==this.Nh.DefaultLabelId&&m.a.Ml().equals(this.Nh.PolicyLabelAssignmentMethod,"standard")&&A.Order<W.Order&&(e.ULS.sendTraceTag(509732189,306,50,"Default labeling triggered. DefaultLabelType: {0}",this.Nh.DefaultLabelType),this.TLa(this.Nh.DefaultLabelId,null,1))}}else this.Nh&&this.Nh.DefaultLabelId&&!this.Nh.AppliedPolicyId&&
(e.ULS.sendTraceTag(593774210,306,50,"Default labeling triggered. DefaultLabel: {0}",this.Nh.DefaultLabelId),this.TLa(this.Nh.DefaultLabelId,null,1))}MQe(){if(!this.ak.value.Org()){var A=this.ov[this.Nh.AppliedPolicyId];this.CVb&&this.LNa&&this.Qob!==this.LNa.id&&(!A||A.Order<this.LNa.sensitivityLabel.Order)&&(A=this.TLa(this.LNa.id,{},4),32!==A?e.ULS.sendTraceTag(50868813,306,10,"ProcessAutoSensitivityLabel: SetSensitivityByPolicyId failed with response: "+A):(this.Qob=this.LNa.id,this.QAa&&(A=this.ov[this.QAa])&&
A.Order<=this.LNa.sensitivityLabel.Order&&(this.ak.value.Dya(29),this.QAa=null)));A=this.ov[this.ak.value.qv.AppliedPolicyId];if(this.FBa&&this.QAa!==this.FBa.id&&(!A||A.Order<this.FBa.sensitivityLabel.Order)){const W=this.FBa.id;this.ak.value.Dya(29);this.ak.value.vIc(29,CommonUIStrings.l_PolicyBusinessBarTitle,String.format(CommonUIStrings.l_PolicyLabelRecommendationMessage,this.Tbe(this.FBa.sensitivityLabel))+" "+this.FBa.l0k,CommonUIStrings.l_PolicyLabelRecommendationButton,()=>{this.TLa(W,{},
8)});this.QAa=this.FBa.id}this.FBa=this.LNa=null}}setPolicyLabel(A,W,na,Ga=2){this.Rcb()?W&&(this.Sjf=!0):this.S2=W;this.ak.value.setPolicyLabel(A);this.Xh.updateCommandUI();na=new Jm(Ga,this.Tbe(this.ov[A]));this.ak.value.u_e(A,this.Rcb()?W:this.S2,na)}KHi(A,W,na,Ga){1===A&&this.setPolicyLabel(W,Ga,na)}JHi(A,W,na){1===A?this.Rcb()?this.TLa(W,null,2,na):this.setPolicyLabel(W===this.Nh.AppliedPolicyId?"":W,na,""):this.Xh.updateCommandUI()}c2e(A){(new Nh(A,Object(n.a)(this,this.JHi,"continueToSetPolicyLabelFromJustificationDialog"))).c2e()}D2e(A,
W){(new pk(A,W,Object(n.a)(this,this.KHi,"continueToSetPolicyLabelFromUDPDialog"))).D2e()}IJc(A="",W=""){const na=new fb.StandardDialog;na.Ir=M.AFrameworkApplication.rea;na.Ad=0;na.Oe(1,CommonUIStrings.l_DialogClose);na.sP(A,W,null)}Ypi(A){1===A&&this.ak.value.UZk()}ski(){const A=new fb.StandardDialog;A.Ir=M.AFrameworkApplication.rea;A.Ad=1;A.Oe(1,CommonUIStrings.l_OICDownLoadACopyDialogOpenButton);A.Oe(0,CommonUIStrings.l_DialogClose);A.sP(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,
CommonUIStrings.l_SensitivityBlockUDPSetLabelMessage,Object(n.a)(this,this.Ypi,"blockUDPSetLabelHandler"))}isReactRibbonEnabled(){return!!this.Xh&&!!this.Xh.ob&&this.Xh.ob.Pp}uBb(){return this.Xh&&this.Xh.ob?this.Xh.ob.uBb:!1}BQc(){return 32}YKb(A,W,na,Ga,Ka){if(1===na)return 32;this.Nh=this.ak.value.qv;if(!this.Nh||!Ka)return 32;Ka[jf.value]="";Ka[jf.labelText]="";Ka[jf.alt]=null;Ka[jf.Jig]=null;Ka[jf.Qzb]=null;Ka[jf.customTooltip]="";Ka[jf.visible]=!1;Ka[jf.iconColor]="";na=W=A=Ka[jf.icon]="";if(!this.Nh.AreLabelsAvailable){if(!this.TVb)return 32;
A=this.TVb;na=jf.c7e;this.CId&&(W=this.CId)}else if(this.Nh.AppliedPolicyId){Ga=null;if(this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpQueryShortLabelEnabled",!1))this.ov&&(Ga=this.ov[this.Nh.AppliedPolicyId]);else for(const qb of this.Nh.SensitivityLabels)if(qb.Id.toLowerCase()===this.Nh.AppliedPolicyId.toLowerCase()){Ga=qb;break}Ga&&(A=this.Tbe(Ga),W=Ga.Tooltip,M.AFrameworkApplication.cC=this.ak.value.Qbc(Ga),na=this.k5f(Ga))}this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",
!1)?(A?(Ka[jf.value]=Ka[jf.labelText]=A,Ka[jf.customTooltip]=W,this.Xwh(na,M.AFrameworkApplication.cC,Ka)):(Ka[jf.iconColor]=jf.c7e,this.Nh.MandatoryLabelingEnforced?(Ka[jf.value]=Ka[jf.labelText]=this.GWc().AYe,Ka[jf.icon]=jf.L_k):(Ka[jf.value]=Ka[jf.labelText]=this.GWc().RJe,Ka[jf.icon]=jf.O_k)),Ka[jf.visible]=!0):A&&(Ka[jf.value]=A,Ka[jf.labelText]=A,this.uBb()?Ka[jf.customTooltip]=W:Ka[jf.alt]=W,this.Xwh(na,M.AFrameworkApplication.cC,Ka),Ka[jf.visible]=!0);return 32}Npc(A,W,na,Ga,Ka){if(1===na)return 32;
this.Nh=this.ak.value.qv;if(!this.Nh||!Ka)return 32;Ka[jf.labelText]="";if(this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpUseHideBarByDefaultSetting",!1)&&this.Nh.HideBarByDefault)return 32;A="";if(this.Nh.AreLabelsAvailable)if(this.Nh.AppliedPolicyId){if(!this.ov)return 32;(W=this.ov[this.ak.value.qv.AppliedPolicyId])&&(A=W.ParentId&&this.ov[W.ParentId]?this.ov[W.ParentId].DisplayName:W.DisplayName)}else A=this.Nh.MandatoryLabelingEnforced?this.GWc().AYe:this.GWc().RJe;else{if(!this.TVb)return 32;
A=this.TVb}Ka[jf.labelText]=A;return 32}Tbe(A){return A?this.ov?A.ParentId&&this.ov[A.ParentId]?this.ov[A.ParentId].DisplayName+"\\"+A.DisplayName:A.DisplayName:(e.ULS.sendTraceTag(4282E4,306,15,"Policy ID to Sensitivity label dictionary has not been initialized."),A.DisplayName):""}Xwh(A,W,na){this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)?(na[jf.icon]=this.hcg(W),na[jf.iconColor]=this.icg(A)):this.uBb()?na[jf.icon]=W?jf.mBl:jf.oBl:(na[jf.Jig]=M.AFrameworkApplication.Cm,
na[jf.Qzb]=W?dj.getImageClass(jf.nBl):dj.getImageClass(jf.pBl))}WLi(A){const W=this.ht("LearnMoreSection",!0);A=Object.assign(new Jj.a,{Id:"SensitivityLearnMore",ExternalId:"SensitivityLearnMore",MenuItemId:A,LabelText:CommonUIStrings.l_LearnMore,Command:"1959943459",Image16by16:M.AFrameworkApplication.Cm,Image16by16Class:dj.getImageClass(jf.y8j),Visible:!0,Alt:CommonUIStrings.L_LearnMoreTooltip,KeyTip:"L"});Array.add(W.ControlList,A);return W}xQf(A,W,na=!1){let Ga;Ga="Toggle_"+A.Id;Ga="Sensitivity_"+
Ga;const Ka=A.DisplayName,qb=A.Tooltip;var Qb=A.Id===this.Nh.AppliedPolicyId,t=na?ob.a.xe(Ga):Ga;this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)?(Qb=this.k5f(A),W=Object.assign(new Yb.a,{Id:t,ExternalId:t,LabelText:na?ob.a.xe(Ka):Ka,Command:"2935633379",MenuItemId:t,QueryCommand:"991261903",Visible:!0,Alt:na?ob.a.xe(qb):qb,AriaLabel:Rb.a.stb,IconColor:this.icg(Qb),KeyTip:W}),W.ExternalImageId=this.hcg(this.ak.value.Qbc(A))):(t=Object.assign(new qk.a,{Id:t,ExternalId:t,
LabelText:na?ob.a.xe(Ka):Ka,Command:"2935633379",MenuItemId:t,QueryCommand:"991261903",CheckedImage:M.AFrameworkApplication.Cm,Visible:!0,Alt:na?ob.a.xe(qb):qb,IsChecked:Qb,AriaLabel:Rb.a.stb,KeyTip:W}),this.isReactRibbonEnabled()?(t.CheckedImageClass=dj.getImageClass(jf.GTe),t.ExternalImageId=jf.GTe):t.CheckedImageClass=dj.getImageClass(jf.xJf),W=t);t=Ga;this.DWb[t]=A.Id;this.Wpf[A.Id]=t;return W}ht(A,W=!1){return Object.assign(new Sh.a,{Title:"",Id:A,DisplayMode:jf.menu,ShowMenuSectionSeparator:W,
ControlsId:"Ctrl_"+A,ControlList:[]})}aPi(A,W,na,Ga){A=zk.sph()?this.ht(A+"Sub"):this.ht(W+"Sub");W=1;for(let Ka of na)(na=this.ov[Ka])&&na.Enabled&&(Array.add(A.ControlList,this.xQf(na,W.toString(),Ga)),W++);return A}COc(A=!1){const W=this.ht("SensitivitySection");let na=1;const Ga=this.Dia;for(let qb in Ga){const Qb=Ga[qb],t=this.ov[qb];if(t&&t.Enabled){if(Qb.count){const Y="Sensitivity_"+t.Name;var Ka=A?ob.a.xe(Y):Y;Ka=zk.sph()?"Label"+this.pWh++:Ka;const pa=Object.assign(new nf.a,{Id:Ka,ExternalId:Ka,
LabelText:A?ob.a.xe(t.DisplayName):t.DisplayName,Command:"798637440",QueryCommand:"2875864574",Menu:Object.assign(new sh.a,{Title:"",MenuSectionList:[],UpdateDynamically:!0}),ImageIsVisible:!1,Toggled:!1,ImageUsesSpaceWhileInvisible:!0,AriaLabel:Rb.a.stb,KeyTip:na.toString(),Alt:A?ob.a.xe(t.Tooltip):t.Tooltip});this.isReactRibbonEnabled()?pa.ExternalImageId=jf.GTe:(pa.Image16by16=M.AFrameworkApplication.Cm,pa.Image16by16Class=dj.getImageClass(jf.xJf));Array.add(pa.Menu.MenuSectionList,this.aPi(Ka,
Y,Qb,A));Array.add(W.ControlList,pa);this.DWb[pa.Id]=t.Id;this.Wpf[t.Id]=pa.Id}else Array.add(W.ControlList,this.xQf(t,na.toString(),A));na++}}return W}a_b(A){return!!this.Ca.GT(A)&&!!this.Ca.GT(A).flags&&!!this.Ca.GT(A).flags.length}QIk(A,W){W.onSuccess&&this.ov&&(A=this.ov[this.ak.value.qv.AppliedPolicyId])&&(this.QAa&&(W=this.ov[this.QAa])&&W.Order<=A.Order&&(this.ak.value.Dya(29),this.QAa=null),this.Qob&&this.Qob!==A.Id&&(this.ak.value.Dya(28),this.Qob=null))}hcg(A){return A?jf.N_k:jf.M_k}icg(A){return A?
A:jf.c7e}k5f(A){if(A.Color||!A.ParentId)return A.Color;const W=this.ov[A.ParentId];return W?W.Color:A.Color}rLl(A){switch(A){case 2:case 14:case 15:return 1;case 21:return 2;default:return 0}}GWc(){this.dMd||(this.dMd=Object.assign(new Zg,{RJe:HeaderStrings.NoSensitivityLabel,AYe:HeaderStrings.SelectASensitivityLabel}));return this.dMd}static sph(){if(null!=zk.BFc)return zk.BFc;M.AFrameworkApplication.dma("ce2ai523-t;6f627846-c");zk.BFc=M.AFrameworkApplication.fa?M.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.RenameCLPControlIds",
!1):!1;return zk.BFc}static Apd(A){M.AFrameworkApplication.fa&&M.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)||(A?(rk.a.dP("ribbon","sensitivity"),rk.a.vaa("ribbon","sensitivity")):rk.a.waa("ribbon","sensitivity"));Ad.c()&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",!A))}static Xa(A){return A&&A.length?!1:!0}}zk.BFc=null;Object(h.a)(zk,"PolicyActor",null,[573]);var hq=d(1247),ti;(function(A){A[A.unknown=
0]="unknown";A[A.boot=1]="boot";A[A.refresh=2]="refresh";A[A.selfSetPolicyLabel=3]="selfSetPolicyLabel"})(ti||(ti={}));Object(h.b)("GetPolicyLabelsReason",ti);class pn extends Sys.EventArgs{constructor(A,W,na,Ga,Ka,qb){super();this.Ztb=A;this.title=W;this.message=na;this.buttonText=Ga;this.W0b=Ka;this.D2c=qb}}Object(h.a)(pn,"AddAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,[]);class wo extends Sys.EventArgs{constructor(A,W,na,Ga,Ka){super();this.Ztb=A;this.title=W;this.message=na;this.buttonText=
Ga;this.W0b=Ka}}Object(h.a)(wo,"AddMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);var tl;(function(A){A[A.none=0]="none";A[A.reasonDefaultLabel=1]="reasonDefaultLabel";A[A.reasonManual=2]="reasonManual";A[A.reasonAutomatic=4]="reasonAutomatic";A[A.reasonRecommended=8]="reasonRecommended";A[A.reasonMandatory=16]="reasonMandatory"})(tl||(tl={}));Object(h.b)("ApplyLabelFlags",tl);class ul extends Sys.EventArgs{constructor(A,W,na){super();this.oLf=A;this.nLf=W;this.existingLabelPriority=
na}}Object(h.a)(ul,"AutoCLPSecurityNodesEventArgs",Sys.EventArgs,[]);class Ak extends Sys.EventArgs{constructor(){super()}}Object(h.a)(Ak,"GetPolicyLabelEventArgs",Sys.EventArgs,[]);class Ek extends Sys.EventArgs{constructor(){super()}}Object(h.a)(Ek,"GetPolicyLabelFailureEventArgs",Sys.EventArgs,[]);class In{constructor(){this.AreLabelsAvailable=!1;this.AppliedPolicyId=null;this.MandatoryLabelingEnforced=this.RequiredDowngradeJustification=!1;this.SensitivityLabels=this.PolicyLabelVersionToken=this.PolicyLabelAssignmentMethod=
this.CustomUrl=this.DefaultLabelType=this.DefaultLabelId=null;this.AreLabelsAvailable=this.HideBarByDefault=!1;this.AppliedPolicyId="";this.RequiredDowngradeJustification=!1;this.PolicyLabelVersionToken=this.PolicyLabelAssignmentMethod=this.DefaultLabelType=this.DefaultLabelId="";this.SensitivityLabels=[];this.MandatoryLabelingEnforced=!1;this.CustomUrl="";this.HideBarByDefault=!1}}Object(h.a)(In,"GetPolicyLabelsData",null,[]);class Il extends Sys.EventArgs{constructor(A=!1){super();this.onSuccess=
A}}Object(h.a)(Il,"LabelInfoUpdateEventArgs",Sys.EventArgs,[]);class Tj extends Sys.EventArgs{constructor(A,W){super();this.A2g=A;this.mUd=W}}Object(h.a)(Tj,"MandatoryLabellingAppHandlerEventArgs",Sys.EventArgs,[]);class ao extends Sys.EventArgs{constructor(A,W,na,Ga){super();this.title=A;this.ePk=W;this.buttonText=na;this.jBk=Ga}}Object(h.a)(ao,"PolicyTipEventArgs",Sys.EventArgs,[]);class Jn extends Sys.EventArgs{constructor(A,W){super();this.Ztb=A;this.D2c=W}}Object(h.a)(Jn,"RemoveAutoPolicyBusinessBarEntryEventArgs",
Sys.EventArgs,[]);class zm extends Sys.EventArgs{constructor(){super()}}Object(h.a)(zm,"RemoveMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);class xo extends Sys.EventArgs{constructor(A,W){super();this.Yfh=A;this.p8=W}}Object(h.a)(xo,"SetPolicyLabelEventArgs",Sys.EventArgs,[]);class yo extends Sys.EventArgs{constructor(A,W,na,Ga=null,Ka=null,qb=null,Qb=null){super();this.errorType=A;this.wwl=na;this.title=Ga;this.message=Ka;this.buttonText=qb;this.W0b=Qb}}Object(h.a)(yo,"SetPolicyLabelFailureEventArgs",
Sys.EventArgs,[]);class Am extends Sys.EventArgs{constructor(){super()}}Object(h.a)(Am,"SetPolicyLabelTriggeredEventArgs",Sys.EventArgs,[]);class zo extends Sys.EventArgs{constructor(A){super();this.Ssl=A}}Object(h.a)(zo,"UDPLabelingAppHandlerEventArgs",Sys.EventArgs,[]);var Ae=d(704),hh=d(456);class dm{static Fkl(A,W){if(!A||!W||A.count!==W.count)return!1;for(let na of A)if(!W.contains(na))return!1;return!0}static toArray(A){if(!A)return null;const W=Array(A.count);let na=0;for(let Ga of A)W[na]=
Ga,na++;return W}}Object(h.a)(dm,"HashSetUtils",null,[]);var pj=d(794);class qc{constructor(A,W,na,Ga=0,Ka=null){this.fDd=this.sff=null;this.aQa=this.GUb=this.HUb=0;this.Cha="";this.p6a=this.jlf=this.cBd=this.SGd=this.AAa=this.vJd=null;this.Ujf=!1;this.D3a=null;this.$Fd=0;this.VEc=this.s6a=this.A4a=this.UEc=null;this.Ma=new ch.a;this.Ssc=this.U7b=this.LS=null;this.NGd=!1;this.adc=null;this.Oa=A;this.hi=W;this.ii=na;this.ADc=Ga;this.qv=new In;this.Vpf=this.Oa.Ha("PolicyHandlerEndpointName")||"PolicyHandler.ashx";
this.FG=Ka;this.l0c=A.ka("WacApplyManualPolicyLabelIsEnabled");this.Aac=A.ka("CoAuthForProtectedFilesIsEnabled");this.qmb=A.ka("SupportsOfficeClientCoauthoring");this.X2j=!1;this.Xml=3E4;this.Zd=uf.a.instance;A.ka("SupportsPolicies")&&Ud.a("MipSupportsPolicies");this.Aac&&this.qmb&&Ud.a("MipSupportsOfficeClientCoauthoring")}get tme(){return this.NGd}Ahi(A){this.Ma.addHandler("PolicyTipEvent",A)}$Sd(A){this.Ma.addHandler("LabelInfoUpdateEvent",A)}z7k(A){this.Ma.removeHandler("LabelInfoUpdateEvent",
A)}yTd(A){this.Ma.addHandler("SetPolicyLabelEventKey",A)}jph(A){this.Ma.removeHandler("SetPolicyLabelEventKey",A)}Ozf(A){this.Ma.addHandler("SetPolicyLabelFailureEventKey",A)}zfi(A){this.Ma.addHandler("GetAutoPolicyLabelEventKey",A);this.tme&&(e.ULS.sendTraceTag(51668058,306,15,"GetAutoPolicyLabelHandler was registered after the AutoPolicyLabelHandlerEvent was raised"),this.qTe(new Ak(0)))}jfi(A){this.Ma.addHandler("CreateAutoCLPSecurityNodesEventKey",A)}Mii(A){this.Ma.addHandler("UpdateAutoCLPLabelPriorityNodeEventKey",
A)}Nii(A){this.Ma.addHandler("UpdateAutoCLPSITNodesEventKey",A)}Oei(A){this.Ma.addHandler("AddAutoPolicyBusinessBarEntryEventKey",A)}Nhi(A){this.Ma.addHandler("RemoveAutoPolicyBusinessBarEntryEventKey",A)}Pei(A){this.Ma.addHandler("AddMandatoryLabellingBusinessBarEntryEventKey",A)}Ohi(A){this.Ma.addHandler("RemoveMandatoryLabellingBusinessBarEntryEventKey",A)}Tfi(A){this.Ma.addHandler("MandatoryLabellingAppHandlerEventKey",A)}Kii(A){this.Ma.addHandler("UDPLabelingAppHandlerEventKey",A)}get rWj(){if(!this.sff)return!1;
for(const A of this.sff.i9d())if(!A.Capabilities||!A.Capabilities.SupportsClientIsMipTrusted)return!1;return!0}get trg(){return!!this.LS}PMj(A){A&&this.Aac&&this.qmb&&A.execute(Object(n.a)(this,this.WVd,"awaitRtc"))}L3k(A){this.SGd=A}nzi(){return this.SGd?this.SGd():!1}A2k(A){this.cBd=A}RF(){return(new Date).getTime()}WVd(A){if(!this.trg){var W=A.GM.task;W.continueWith(()=>{this.LS=W.result;this.LS.ECa(Object(n.a)(this,this.AEk,"onLabelChangeUpdateOverRtc"))})}}AEk(A,W){12===W.type&&(this.jlf?this.jlf():
this.PTa(this.Cha,2,this.AAa,!0))}w$d(){this.ii&&(this.UEc=this.ii.Ii("WebServiceCall","Call Get Policy Endpoint On Server"));var A=pj.a.wDa(1,1);this.Oa.ka("SendHostAttributionInfoForPolicyLabelEnabled")?(A=new Ae.a(this.Iyb("datalosspolicy"),1,null,null,!0,2,null,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,A),this.hi.send(A).Sjb(Object(n.a)(this,this.E8g,"onDataLossPolicySuccessCallback"),Object(n.a)(this,this.D8g,"onDataLossPolicyFailureCallback"))):this.hi.zj(this.Iyb("datalosspolicy"),
1,null,null,!0,2,Object(n.a)(this,this.E8g,"onDataLossPolicySuccessCallback"),Object(n.a)(this,this.D8g,"onDataLossPolicyFailureCallback"),null);this.HUb++;e.ULS.sendTraceTag(25565151,306,50,"Policy request is sent to server. The endpoint used is {0}. Policy call times: {1}.",this.Vpf,this.HUb)}Y1k(){this.PTa(this.Cha,2,this.AAa)}PTa(A,W=0,na=null,Ga=!1){B.Health.instance.recordKpiUsage("MipGetPolicyLabel",0,"officewebclp",this.G$d(void 0,W));this.U7b=this.RF();const Ka=this.N0d(W);this.cVc(A,Ka,
na,Ga,W);this.oWe(!0)}E8g(A){this.Xfh();let W="";({data:W}=this.L7e(A)).returnValue&&(e.ULS.sendTraceTag(25565153,306,50,"Request to get DataLossPrevention policy succeeded."),this.HUb=0,this.ii&&(this.VEc=this.ii.Ii("Task","Parse and Handle Get Policy Response")),this.jMk(W),this.VEc&&(this.VEc.stop(),this.VEc=null))}D8g(A){this.Xfh();this.HUb<=this.ADc?this.w$d():(e.ULS.sendTraceTag(25565154,306,15,"Request to get DataLossPrevention policy failed with error response: {0}.",A?A.data?A.data.uMb:null:
null),this.HUb=0)}Org(){return 0<this.aQa}setPolicyLabel(A){this.qv.AppliedPolicyId=A}u_e(A,W,na=null){const Ga=this.DLi(na);this.Wml(A,W,Ga,na)}Rah(A){this.s6a&&(this.s6a.stop(),this.s6a=null);let W,na;({Uuh:W,Axh:na}=this.Oag(A));const Ga=A.data.state,Ka=Ga?Ga.p8:2;let qb="";({data:qb}=this.L7e(A)).returnValue?(e.ULS.sendTraceTag(41799707,306,50,"Request to set label policy data succeeded. ApplyLabelFlag: {0}",Ka),this.aQa=0,this.QMk(qb,W,na,Ga)):this.nXe(Ka)}lZk(A){B.Health.instance.recordKpiUsage("MipSetPolicyLabel",
0,"officewebclp",this.G$d(A));this.Ssc=this.RF();e.ULS.sendTraceTag(575947405,306,50,"Raising set policy label triggered event.");this.Ma.raiseEvent("SetPolicyLabelTriggeredEventKey",new Am(A))}Vyk(){this.Aac&&this.qmb&&this.trg&&this.LS.Xaa(12,null,!0)}Qah(A){this.s6a&&(this.s6a.stop(),this.s6a=null);let W;({Uuh:na,Axh:W}=this.Oag(A));if(this.aQa<=this.ADc)this.u_e(na,W);else{var na=(na=A.data.state)?na.p8:2;e.ULS.sendTraceTag(41799708,306,15,"Request to set label policy failed with error response: {0}. ApplyLabelFlag: {1}",
A?A.data?A.data.uMb:null:null,na);this.adc="WACServerConnectionFailed";this.aQa=0;this.nXe(na)}}X1j(A){if(A&&("LabelNotSupported"===A||"LabelErrorRetryLater"===A||"CoherencyFailure"===A||"LabelIdNotFound"===A||"LabelDisabled"===A))return e.ULS.sendTraceTag(539103556,306,50,"LabelError is retriable: {0}",A),!0;e.ULS.sendTraceTag(539103557,306,50,"LabelError is not retriable: {0}",A);return!1}Qbc(A){return this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UDPAsProtectedLabelEnabled",!1)?
A.IsEndpointProtectionEnabled||A.HasUserDefinedPermissions:A.IsEndpointProtectionEnabled}dxi(A){if(!A)return!1;let W=null,na=null;for(const Ga of this.qv.SensitivityLabels)Ga.Id===A&&(W=Ga),Ga.Id===this.Cha&&(na=Ga);if(!W)return!1;if(this.Aac&&this.qmb){if(this.cBd&&this.cBd()||this.rWj)return!0}else if(M.AFrameworkApplication.qB&&M.AFrameworkApplication.qB.EEa||this.AAa&&this.AAa())return!0;return this.Qbc(W)===(!!na&&this.Qbc(na))}vIc(A,W,na,Ga,Ka){28===A?this.Tjh(new pn(A,W,na,Ga,Ka,!1)):this.Tjh(new pn(A,
W,na,Ga,Ka,!0))}Dya(A){28===A?this.vkh(new Jn(A,!1)):this.vkh(new Jn(A,!0))}GXk(A,W,na){e.ULS.sendTraceTag(545280777,306,50,"Raising a CreateAutoCLPSecurityNodes event.");this.Ma.raiseEvent("CreateAutoCLPSecurityNodesEventKey",new ul(A,W,na))}XZk(A){e.ULS.sendTraceTag(545280778,306,50,"Raising a UpdateAutoCLPLabelPriorityNode event.");this.Ma.raiseEvent("UpdateAutoCLPLabelPriorityNodeEventKey",new ul(null,null,A))}YZk(A,W){e.ULS.sendTraceTag(545280779,306,50,"Raising a UpdateAutoCLPSITNodes event.");
this.Ma.raiseEvent("UpdateAutoCLPSITNodesEventKey",new ul(A,W,null))}hkh(A,W){e.ULS.sendTraceTag(572650527,306,50,"Raising a mandatory labelling"+(1===W?"Reading":"Edit")+" switch event.");this.Ma.raiseEvent("MandatoryLabellingAppHandlerEventKey",new Tj(A,W))}tSd(A,W,na,Ga,Ka){37===A&&this.jXk(new wo(37,W,na,Ga,Ka))}bVe(){this.WYk(new zm)}UZk(){e.ULS.sendTraceTag(540608322,306,50,"Raising a UDP labeling event.");this.Ma.raiseEvent("UDPLabelingAppHandlerEventKey",new zo(!0))}i0b(A=!1){const W=!!this.qv&&
this.qv.AreLabelsAvailable&&!!this.qv.SensitivityLabels&&0<this.qv.SensitivityLabels.length&&Gd.a.any(this.qv.SensitivityLabels,na=>!!na&&na.Enabled);W||A||zk.Apd(!1);return W}J9g(A){this.A4a&&(this.A4a.stop(),this.A4a=null);var W="";this.oWe(!1);({data:W}=this.L7e(A)).returnValue?(e.ULS.sendTraceTag(34996493,306,50,"Request to get label policy data succeeded."),this.GUb=0,W=this.AMk(W),A=this.u$f(A.data),B.Health.instance.recordKpiSuccess("MipGetPolicyLabel",this.XTc(void 0,A,this.U7b)),this.U7b=
null,A=new Ak(A),this.ZXk(A),this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)?W&&this.srl()?this.tme?this.bNl():(this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSecurityNodesAfterLicenseCheck",!1)||this.cOc(),this.qTe(A),this.NGd=!0):W||this.Znd():!this.tme&&W&&this.Oa.ka("WacApplyManualPolicyLabelIsEnabled")&&this.SCf()?(this.qTe(A),this.NGd=!0):W||this.Znd()):this.Znd()}srl(){if(!this.Oa.ka("WacApplyManualPolicyLabelIsEnabled"))return e.ULS.sendTraceTag(539877667,
306,50,"ShouldAutoClassificationRun returned false - Manual Labeling is not enabled"),!1;if(!this.SCf())return!1;if(""===this.Cha)return e.ULS.sendTraceTag(539877696,306,50,"ShouldAutoClassificationRun returned true - document is not labeled"),!0;if(this.D3a===this.$Fd)return e.ULS.sendTraceTag(539877697,306,50,"ShouldAutoClassificationRun returned false - Applied label already has the highest priority"),!1;e.ULS.sendTraceTag(539877698,306,50,"ShouldAutoClassificationRun returned true - document is labeled but not with the highest priority label");
return!0}cOc(){this.QMh();e.ULS.sendTraceTag(545104324,306,50,"Creating AutoCLP Security nodes. HasSITs: {0}, LabelPriority: {1}",0<this.p6a.count,this.D3a);const A=dm.toArray(this.p6a);this.GXk(A,A,this.D3a)}bNl(){var A=this.p6a;this.QMh();dm.Fkl(A,this.p6a)||(e.ULS.sendTraceTag(545104325,306,50,"Updating AutoCLP SIT nodes. HasSITs: {0}",0<this.p6a.count),A=dm.toArray(this.p6a),this.YZk(A,A));this.Ujf&&(e.ULS.sendTraceTag(545104326,306,50,"Updating AutoCLP Label Priority node. LabelPriority: {0}",
this.D3a),this.XZk(this.D3a))}QMh(){const A=new hq.a(m.a.Ml());for(const W of this.qv.SensitivityLabels)if(W&&W.AutoLabelingSensitiveTypeIds&&0<W.AutoLabelingSensitiveTypeIds.length)for(const na of W.AutoLabelingSensitiveTypeIds)na&&A.add(na);this.p6a=A}I9g(A){const W=this.u$f(A.data);B.Health.instance.recordKpiFailure("MipGetPolicyLabel","GetPolicyLabelsFailure",!1,!1,this.XTc(void 0,W,this.U7b));this.U7b=null;this.A4a&&(this.A4a.stop(),this.A4a=null);if(this.GUb<=this.ADc){if(this.Oa.ka("SendHostAttributionInfoForPolicyLabelEnabled")){const na=
A.data.request.get_headers();if("HostAttributionInfo.ScenarioParamName"in na&&na[pj.a.mYe]&&"HostAttributionInfo.ScenarioTypeParamName"in na&&na[pj.a.nYe]){A.data.request.get_headers();A.data.request.get_headers();A=this.N0d(W);this.cVc(this.Cha,A,this.AAa,void 0,W);return}}this.PTa(this.Cha,W,this.AAa)}else e.ULS.sendTraceTag(34996494,306,15,"Request to get label policy failed with error response: {0}.",A?A.data?A.data.uMb:null:null),this.Znd(),this.GUb=0,this.oWe(!1)}u$f(A){return A.state?A.state:
0}Iyb(A,W=!1){let na=String.format("{0}{1}?action={2}&{3}",this.Oa.Ha("PolicyHandlerWebServiceBase")||M.AFrameworkApplication.Aa.ob.Zna,this.Vpf,A,M.AFrameworkApplication.gh);"setpolicylabel"===A&&M.AFrameworkApplication.qB&&M.AFrameworkApplication.qB.yne&&(na=D.a.Ti(na,"sl","1"));W&&(na=D.a.Ti(na,"cbd","1"));return na}Oag(A){let W,na;W=na=null;A&&A.data&&A.data.request&&A.data.request.get_headers()&&(W=A.data.request.get_headers()[hh.a.Vuh],na=A.data.request.get_headers()[hh.a.Bxh]);return{Uuh:W,
Axh:na}}L7e(A){A=A?A.data?A.data.ee:null:null;return A&&A.length&&!this.T2j(A)?{returnValue:!0,data:A}:(e.ULS.sendTraceTag(25565152,306,10,"No response data from policy endpoint."),{returnValue:!1,data:A})}jMk(A){let W;try{W=C.b(A)}catch(na){e.ULS.sendTraceTag(37880331,306,10,"Error when deserializing DataLossPrevention response.");return}if(W)if(W.IsPolicyTipAvailable)switch(W.IsPolicyTipAvailable.toLowerCase()){case "false":e.ULS.sendTraceTag(26007261,306,50,"policyData.IsPolicyTipAvailable is false so DLP policy tip is not present.");
break;case "true":e.ULS.sendTraceTag(25565186,306,50,"DLP Policy is enabled on this document.");this.fDd=W.NavigateUrl;this.Owl(W.GeneralText,Object(n.a)(this,this.fCk,"onDataLossPolicyOverrideButtonClick"));break;default:e.ULS.sendTraceTag(26007262,306,10,"policyData.IsPolicyTipAvailable is expected to be 'true' or 'false' but it is {0}",W.IsPolicyTipAvailable)}else e.ULS.sendTraceTag(26007260,306,10,"policyData.IsPolicyTipAvailable is null or empty whereas it should be 'true' or 'false'.");else e.ULS.sendTraceTag(25565185,
306,10,"policyData is null after deserializing DataLossPrevention response.")}uIi(A){switch(A){case "CoherencyFailure":return 1;case "DisabledByPolicy":return 2;case "FileCheckedOut":return 3;case "FileEncrypted":return 4;case "FileLocked":return 5;case "FileNotSupported":return 6;case "FileTooLarge":return 7;case "InvalidOperationOnZeroByteFile":return 8;case "LabelDisabled":return 9;case "LabelErrorRetryLater":return 10;case "LabelIdNotFound":return 11;case "LabelIrmDisabledByTenant":return 12;
case "LabelNotSupported":return 13;case "MinorVersionLimitExceeded":return 15;default:return 0}}QMk(A,W,na,Ga){var Ka=Ga?Ga.p8:2;let qb=0,Qb="",t;if(({Nu:t}=C.d(A)).returnValue)if(t){Qb="Success";A=this.N0d(3);if(t.IsSuccessful){B.Health.instance.recordKpiSuccess("MipSetPolicyLabel",this.XTc(Ka,void 0,this.Ssc));this.adc=this.Ssc=null;e.ULS.sendTraceTag(51233632,306,50,"setPolicyLabel was successful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}",Ka);2===Ka&&this.Dya(29);
this.Rnl(W,Ka);this.Vyk();this.Dya(28);Ga&&4===Ka&&this.vIc(28,CommonUIStrings.l_PolicyBusinessBarTitle,String.format(CommonUIStrings.l_PolicyLabelAutomaticallyAppliedMessage,Ga.displayName),CommonUIStrings.l_DialogOk,()=>{});Ud.a("MipAppliedLabels",void 0,void 0,[Object.assign(new hd.a,{name:"SetPolicyLabelApplyFlag",string:tl[Ka]})]);this.cVc(W,A,this.AAa,void 0,3);return}e.ULS.sendTraceTag(51233631,306,10,"setPolicyLabel was unsuccessful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}, FailureReason: {1}",
Ka,t.FailureReason);this.adc=t.FailureReason;this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ImproveSetLabelFailureErrMsg",!1)?qb=this.uIi(t.FailureReason):"FileTooLarge"===t.FailureReason?qb=7:"LabelNotSupported"===t.FailureReason?qb=13:"LabelDisabled"===t.FailureReason?qb=9:"MinorVersionLimitExceeded"===t.FailureReason&&(qb=15);this.X2j&&0<=t.FailureReason.indexOf("InvalidOperationOnZeroByteFile")&&(Ga=new be.a(2,1,this.Xml,()=>{e.ULS.sendTraceTag(575428443,306,15,"Retring SetPolicyLabelRequestAsync as previous called failed due to zero byte. Attempt number : {0}",
this.aQa);this.aQa<=this.ADc&&this.u_e(W,na)}),this.Zd.Hb(Ga));this.Aac&&this.qmb&&this.cVc(this.qv.AppliedPolicyId,A,this.AAa,!0,3)}else Qb="setPolicyLabelData null.",e.ULS.sendTraceTag(42467541,306,10,"setPolicyLabelData is null after deserializing set policy label data response. ApplyLabelFlag: {0}",Ka);else Qb="TryDeserialize failed.",e.ULS.sendTraceTag(41799709,306,10,"Error when deserializing set policy label data response. ApplyLabelFlag: {0}",Ka);this.nXe(Ka,qb);Ka=this.XTc(Ka,void 0,this.Ssc);
this.Ssc=null;Ka.extendedProperties.set("SetPolicyLabelDataFailureReason",this.adc);Ka.extendedProperties.set("SetPolicyLabelDataParseStatus",Qb.toString());B.Health.instance.recordKpiFailure("MipSetPolicyLabel","SetPolicyLabelFailure",!1,!1,Ka)}nXe(A,W=0){const na=2===A||8===A||16===A;this.setPolicyLabel(this.Cha);this.fkh(new Il);this.Fkh(W,A,na,!1)}Rnl(A,W){this.setPolicyLabel(this.Cha=A);if(""===A)M.AFrameworkApplication.cC=!1,M.AFrameworkApplication.l5b=!1;else for(const na of this.qv.SensitivityLabels)if(na.Id===
A){M.AFrameworkApplication.cC=this.Qbc(na);break}this.kZk(new xo(A,W))}POl(){for(const A of this.qv.SensitivityLabels)A&&A.Enabled&&(A.Id===this.Cha&&(this.Ujf=this.D3a!==A.Order,this.D3a=A.Order),A.Order>this.$Fd&&(this.$Fd=A.Order))}AMk(A){if(!({Nu:A}=C.d(A)).returnValue)return e.ULS.sendTraceTag(34996495,306,10,"Error when deserializing label policy data response."),!1;if(!A)return e.ULS.sendTraceTag(42467542,306,10,"policyData is null after deserializing label policy data response."),!1;if(!A.AreLabelsAvailable)return!1;
this.qv=A;this.Cha=A.AppliedPolicyId;this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)&&this.POl();this.i0b()&&e.ULS.sendTraceTag(51197846,306,50,"Labels are available for display after GetPolicyLabels call.");this.fkh(new Il(!0));return!0}SCf(){if(!this.i0b())return e.ULS.sendTraceTag(539877699,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels to display"),!1;for(const A of this.qv.SensitivityLabels)if(A&&A.AutoLabelingSensitiveTypeIds&&
0<A.AutoLabelingSensitiveTypeIds.length)return!0;e.ULS.sendTraceTag(539877700,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels with AutoClp SIT");return!1}fkh(A){e.ULS.sendTraceTag(35393610,306,50,"Raising label info update event.");this.Ma.raiseEvent("LabelInfoUpdateEvent",A)}ZXk(A){e.ULS.sendTraceTag(50676305,306,50,"Raising get policy label event.");this.Ma.raiseEvent("GetPolicyLabelEventKey",A)}Znd(){zk.Apd(!1);this.Ma.raiseEvent("GetPolicyLabelFailureEventKey",new Ek)}qTe(A){this.FG&&
this.FG.execute(W=>{W=[W.isFeatureEnabled("MsoClpSpTwo",!0),W.isFeatureEnabled("MsoDrmPremiumSpTwo",!0)];Promise.all(W).then(na=>{Gd.a.any(na,Ga=>Ga)&&(e.ULS.sendTraceTag(50944077,306,50,"Raising get auto policy label event."),this.Ma.raiseEvent("GetAutoPolicyLabelEventKey",A),this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSecurityNodesAfterLicenseCheck",!1)&&this.cOc(),Ud.a("MipAutoClassificationEnabled"));return null})})}G$d(A=null,W=null){const na=new Map;na.set("ClpCoauth",
this.qmb.toString());null!=A&&na.set("ApplyLabelFlags",tl[A]);null!=W&&na.set("GetPolicyLabelsReason",ti[W]);return na}XTc(A=null,W=null,na=null){const Ga=new ka.a;Ga.extendedProperties=this.G$d(A,W);null!=na&&(Ga.durationMs=this.RF()-na);return Ga}kZk(A){e.ULS.sendTraceTag(41799710,306,50,"Raising set policy label event.");this.Ma.raiseEvent("SetPolicyLabelEventKey",A)}Tjh(A){e.ULS.sendTraceTag(51128227,306,50,"Raising an add auto policy business bar entry event.");A&&A.D2c&&Ud.a("MipRecommendations");
this.Ma.raiseEvent("AddAutoPolicyBusinessBarEntryEventKey",A)}vkh(A){e.ULS.sendTraceTag(51128256,306,50,"Raising an remove auto policy business bar entry event.");this.Ma.raiseEvent("RemoveAutoPolicyBusinessBarEntryEventKey",A)}jXk(A){e.ULS.sendTraceTag(573842331,306,50,"Raising an add mandatory labelling business bar entry event.");this.Ma.raiseEvent("AddMandatoryLabellingBusinessBarEntryEventKey",A)}WYk(A){e.ULS.sendTraceTag(573842332,306,50,"Raising a remove mandatory labelling business bar entry event.");
this.Ma.raiseEvent("RemoveMandatoryLabellingBusinessBarEntryEventKey",A)}Owl(A,W=null){e.ULS.sendTraceTag(34996496,306,50,"Showing policy tip to user.");this.Ma.raiseEvent("PolicyTipEvent",new ao(CommonUIStrings.l_PolicyBusinessBarTitle,A,CommonUIStrings.l_PolicyOverrideButton,W))}Fkh(A,W,na,Ga=!0){e.ULS.sendTraceTag(42074656,306,Ga?50:15,"Raising set policy label failure event. ApplyLabelFlags: {0}",W);Ga=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarTitle;let Ka=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarMessage,
qb=null,Qb=null;switch(A){case 2:Ga=CommonUIStrings.l_SensitivityApplicationErrorDisabledByPolicyBusinessBarTitle;Ka=CommonUIStrings.l_SensitivityApplicationErrorDisabledByPolicyBusinessBarMessage;break;case 5:Ka=CommonUIStrings.l_SensitivityApplicationErrorFileLockedBusinessBarMessage;break;case 7:Ga=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarTitle;Ka=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarMessage;break;case 13:Ga=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarTitle;
Ka=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarMessage;break;case 9:Ga=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarTitle;Ka=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarMessage;break;case 10:Ka=CommonUIStrings.l_SensitivityApplicationErrorLabelErrorRetryLaterBusinessBarMessage;break;case 14:Ga=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorTitle;Ka=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorMessage;
break;case 15:Ga=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarTitle,Ka=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarMessage,qb=CommonUIStrings.l_LearnMore,Qb=()=>{this.Yml()}}A=new yo(A,W,na,Ga,Ka,qb,Qb);this.Ma.raiseEvent("SetPolicyLabelFailureEventKey",A)}i_e(A){this.vJd=A}fCk(){this.fDd?(e.ULS.sendTraceTag(25565187,306,50,"DLP override button was clicked."),mb.a.jTc(this.fDd)):e.ULS.sendTraceTag(25565188,306,10,"Null NavigateUrl got in policy response. Could not navigate to SPO.")}T2j(A){if(!A.startsWith("<")||
-1===A.indexOf("Error")&&-1===A.indexOf("Unavailable"))return!1;e.ULS.sendTraceTag(25565189,306,10,"The response from server is not a valid JSON response and it matches the error page keyword. This might be the error response from a non-existing endpoint.");return!0}Xfh(){this.UEc&&(this.UEc.stop(),this.UEc=null)}B$i(A){if(!A)return"manual";switch(A.p8){case 0:return"manual";case 4:return"auto";case 1:return"default";case 16:return"mandatory";case 2:return"manual";case 8:return"recommended";default:return"manual"}}Jaj(A){if(!A)return"privileged";
A=A.p8;let W="privileged";if(4===A||1===A)W="standard";return W}cVc(A,W,na=null,Ga=!1,Ka=0){this.Oa.ka("WacLabelingGetPolicyLabelsIsEnabled")&&(this.Cha=A,this.AAa=na,this.ii&&(this.A4a=this.ii.Ii("WebServiceCall","Call Get Policy Endpoint On Server")),na={},na[hh.a.zli]=A,this.Oa.ka("SendHostAttributionInfoForPolicyLabelEnabled")?(A=new Ae.a(this.Iyb("getpolicylabels",Ga),1,null,na,!0,2,Ka,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,W),this.hi.send(A).Sjb(Object(n.a)(this,
this.J9g,"onGetPolicyLabelsSuccessCallback"),Object(n.a)(this,this.I9g,"onGetPolicyLabelsFailureCallback"))):this.hi.zj(this.Iyb("getpolicylabels",Ga),1,null,na,!0,2,Object(n.a)(this,this.J9g,"onGetPolicyLabelsSuccessCallback"),Object(n.a)(this,this.I9g,"onGetPolicyLabelsFailureCallback"),Ka,void 0,void 0,void 0,void 0,"22"),this.GUb++,e.ULS.sendTraceTag(34996492,306,50,"Policy label request sent to server. Policy call times: {0}",this.GUb))}Wml(A,W,na,Ga=null){if(this.l0c){this.ii&&(this.s6a=this.ii.Ii("WebServiceCall",
"Call Set Policy Endpoint On Server"));var Ka={};Ka[hh.a.Vuh]=A;W&&(Ka[hh.a.Bxh]=encodeURIComponent(W));this.vJd&&(Ka[hh.a.Zki]=this.vJd);Ga?(Ka[hh.a.yxh]=this.B$i(Ga),Ka[hh.a.zxh]=this.Jaj(Ga),this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultLabelForSPODocLibEnabled",!1)&&1===Ga.p8&&this.qv.DefaultLabelType&&(Ka[hh.a.Vml]=this.qv.DefaultLabelType)):(Ka[hh.a.yxh]="manual",Ka[hh.a.zxh]="privileged");this.qmb&&this.qv&&(Ka[hh.a.dPk]=this.qv.PolicyLabelVersionToken);this.Oa.ka("SendHostAttributionInfoForPolicyLabelEnabled")?
(A=new Ae.a(this.Iyb("setpolicylabel",!0),1,null,Ka,!0,2,Ga,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,na),this.hi.send(A).Sjb(Object(n.a)(this,this.Rah,"onSetPolicyLabelSuccessCallback"),Object(n.a)(this,this.Qah,"onSetPolicyLabelFailureCallback"))):this.hi.zj(this.Iyb("setpolicylabel",!0),1,null,Ka,!0,2,Object(n.a)(this,this.Rah,"onSetPolicyLabelSuccessCallback"),Object(n.a)(this,this.Qah,"onSetPolicyLabelFailureCallback"),Ga,void 0,void 0,void 0,void 0,
"32");this.aQa++;e.ULS.sendTraceTag(41799706,306,50,"Set policy label request sent to server. Policy call times: {0}",this.aQa)}else e.ULS.sendTraceTag(570972052,306,50,"SetPolicyLabelRequestInternalAsync was exited - ApplyManualPolicyLabel was not enabled.")}Yml(){const A=new fb.StandardDialog,W=this.Oa.Ha("BreadcrumbFolderUrl");W?(A.Ad=11,A.Oe(1,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoAction),A.Oe(2,CommonUIStrings.l_DialogOk)):(A.Ad=0,A.Oe(1,CommonUIStrings.l_DialogOk));
A.nSd(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoHelpText,"0f6cd105-974f-44a4-aadb-43ac5bdfd247");A.S5k();A.sP(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoTitle,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoMessage,na=>{1===na&&W&&mb.a.En(W,"_blank",void 0,"SetPolicyLabelFailureBusinessBarActionCallback.BreadcrumbFolderUrl")})}N0d(A){switch(A){case 1:return pj.a.wDa(1,1);case 2:return pj.a.wDa(7,1);case 3:return pj.a.wDa(8,
1);default:return pj.a.wDa(7,0)}}DLi(A=null){if(!A)return pj.a.wDa(8,0);switch(A.p8){case 1:case 16:return pj.a.wDa(1,1);case 4:case 2:case 8:return pj.a.wDa(8,1);default:return pj.a.wDa(8,0)}}oWe(A){this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&appChrome.api.setAsyncRequestStatus("sensitivity",A)}}Object(h.a)(qc,"PolicyManager",null,[539]);class Lj{constructor(){this.lOd=this.eMd=this.Wmf=this.Rqf=this.Kbf=this.Gn=this.IPa=this.Da=this.ak=null}get name(){return"Common.App.Policy"}init(){M.AFrameworkApplication.fa.ka("ShouldInitCommonPolicyPackage")&&
(M.AFrameworkApplication.fa.ka("IsDataLossPreventionEnabledForUser")&&M.AFrameworkApplication.Aa&&(this.ak=this.Da.resolve("Common.App.Policy.Contracts.IPolicyManager"),this.ak.Ahi(Object(n.a)(this,this.Nwl,"showPolicyBusinessBar")),e.ULS.sendTraceTag(36537375,306,50,"PolicyManager is created successfully."),M.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InitPolicyManagerEarlierEnabled",!1)?uc.a.get_instance().Mj(5,()=>{this.ak.w$d()}):uc.a.get_instance().Mj(6,()=>
{this.ak.w$d()})),M.AFrameworkApplication.fa.ka("WacLabelingPoliciesIsEnabled")&&M.AFrameworkApplication.fa.ka("SupportsPolicies")?M.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InitPolicyManagerEarlierEnabled",!1)?uc.a.get_instance().Mj(5,Object(n.a)(this,this.w7g,"onAfterRibbonBehaviorAttached")):uc.a.get_instance().Mj(6,Object(n.a)(this,this.w7g,"onAfterRibbonBehaviorAttached")):zk.Apd(!1))}dispose(){}Yb(A){A.register(539,"Common.App.Policy.Contracts.IPolicyManager").ma().oa(()=>
new qc(M.AFrameworkApplication.fa,M.AFrameworkApplication.Me,M.AFrameworkApplication.Aa.vV,M.AFrameworkApplication.fa.wc("MaxGetPolicyRetries",1),A.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),M.AFrameworkApplication.Aa.ob.zk));A.register(zk,"Common.App.Policy.PolicyActor").as("Common.App.Policy.Contracts.IPolicyActor").ma().oa(()=>new zk(M.AFrameworkApplication.Ra,M.AFrameworkApplication.Aa,M.AFrameworkApplication.fa,A.oe("Common.App.Policy.Contracts.IPolicyManager")));this.Da=
A}w7g(){this.Gn=this.Da.qb("CommonUI.BusinessBar");this.ak||(this.ak=this.Da.resolve("Common.App.Policy.Contracts.IPolicyManager"));this.IPa=this.Da.resolve("Common.App.Policy.PolicyActor");Ad.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")?this.ak.$Sd(Object(n.a)(this.IPa,this.IPa.ymh,"registerActionsHandler")):this.IPa.vb();this.ak.$Sd(Object(n.a)(this,this.OOl,"updateLabelInfo"));M.AFrameworkApplication.fa.ka("WacApplyManualPolicyLabelIsEnabled")&&
(this.ak.Ozf(Object(n.a)(this,this.pFj,"handleSetPolicyLabelFailure")),this.ak.Oei(Object(n.a)(this,this.vIc,"addAutoPolicyBusinessBarEntry")),this.ak.Nhi(Object(n.a)(this,this.Dya,"removeAutoPolicyBusinessBarEntry")),this.ak.Pei(Object(n.a)(this,this.tSd,"addMandatoryLabellingBusinessBarEntry")),this.ak.Ohi(Object(n.a)(this,this.bVe,"removeMandatoryLabellingBusinessBarEntry")))}OOl(){this.IPa.Pml();this.IPa.pll();this.IPa.sWk();const A=this.ak.nzi();M.AFrameworkApplication.fa.ka("HasDocumentEditRights")&&
!A?this.IPa.jIl():e.ULS.sendTraceTag(558682911,306,50,"Default/Mandatory Labeling has been skipped because HasDocumentEditRights: {0}, IsClpBlockedByAppSpecificScenario: {1}",M.AFrameworkApplication.fa.ka("HasDocumentEditRights"),A);M.AFrameworkApplication.Aa.updateCommandUI()}Nwl(A,W){this.eMd&&this.Gn.tea(38)&&this.Gn.removeEntry(this.eMd);A=this.s$f(W.title,W.ePk,38,W.jBk,W.buttonText);M.AFrameworkApplication.Aa.ob.wIc(A,!0)?(this.eMd=A,e.ULS.sendTraceTag(34174785,306,50,"Add entry to BusinessBar succeeded. Policy message is shown to user.")):
e.ULS.sendTraceTag(34174784,306,10,"Failed to add entry to business bar. Policy message could not be shown to user.")}pFj(A,W){W.wwl&&(this.lOd&&this.Gn.tea(21)&&this.Gn.removeEntry(this.lOd),A=this.s$f(W.title,W.message,21,null,null,W.W0b,W.buttonText),M.AFrameworkApplication.Aa.ob.wIc(A,!0)?(this.lOd=A,e.ULS.sendTraceTag(42074655,306,50,"Add entry to BusinessBar succeeded. CLP policy message is shown to user.")):e.ULS.sendTraceTag(42074654,306,10,"Failed to add entry to business bar. CLP policy message could not be shown to user."))}Dya(A,
W){(A=W.D2c?this.Rqf:this.Kbf)&&this.Gn&&this.Gn.tea(W.Ztb)&&this.Gn.removeEntry(A)}vIc(A,W){this.Gn&&(this.ak.Dya(W.Ztb),A=new ok.a(W.title,W.message,null),A.id=W.Ztb,A.closeable=!0,A.image=3,A.addButton(W.buttonText,W.W0b,W.buttonText,!0),this.Gn.ji(A,!1),W.D2c?this.Rqf=A:this.Kbf=A)}tSd(A,W){this.Gn&&(A=new ok.a(W.title,W.message,null),A.id=W.Ztb,A.closeable=!1,A.image=3,A.addButton(W.buttonText,W.W0b,W.buttonText,!1),this.Gn.ji(A,!1),this.Wmf=A)}bVe(){const A=this.Wmf;A&&this.Gn&&this.Gn.tea(A.id)&&
this.Gn.removeEntry(A)}s$f(A,W,na,Ga=null,Ka=null,qb=null,Qb=null){A=new ok.a(A,W,null);A.id=na;A.closeable=!0;Ga&&A.Oxf(Ka,Ga);qb&&A.addButton(Qb,qb,Qb);return A}static main(){Ia.a.instance.Ac(new Lj)}}Object(h.a)(Lj,"PackageManager",null,[2,3]);var qn=d(252),Fk=d(324),Um=d(143);class ff extends Fk.a{constructor(){super();this.fullDocSITs=this.partialDocSITs=null;this.H_=Object.assign(new Um.a,{T_:ff.getTypeName(),B_:ff.getBaseTypes()})}static getTypeName(){return"AugLoop_SecurityShared_SecurityShared"}static getBaseTypes(){return[]}}
Object(h.a)(ff,"SecurityShared",Fk.a,[]);class Km extends ff{constructor(){super();this.existingLabelPriority=null;this.H_=Object.assign(new Um.a,{T_:Km.getTypeName(),B_:Km.getBaseTypes()})}static getTypeName(){return"AugLoop_SecurityShared_CLP"}static getBaseTypes(){return["AugLoop_SecurityShared_SecurityShared"]}}Object(h.a)(Km,"CLP",ff,[]);var em=d(313),bo=d(334),co=d(705);class Oo extends Ff.a{constructor(A){super();this.TenantId=null;this.TenantId=A}pl(){return 103}}Object(h.a)(Oo,"GetAppliedPolicyIdRequest",
Ff.a,[]);class rn extends Sys.EventArgs{constructor(A){super();this.lja=A}}Object(h.a)(rn,"OnAppliedPolicyReceivedEventArgs",Sys.EventArgs,[]);class qj{constructor(A,W,na){this.c1=this.rze=this.G8c=null;this.xa=new ch.a;this.nbc=!1;this.ai=A;this.Tdb=W;this.Jb=na;this.Tdb.Zfi(Object(n.a)(this,this.H7g,"onAppliedPolicyIdReady"));this.Tdb.Jgi(Object(n.a)(this,this.d$g,"onIsManuallyAppliedReady"))}$fi(A){this.xa.addHandler("AppliedPolicyEventReceivedKey",A)}dispose(){this.Tdb.I7k(Object(n.a)(this,this.H7g,
"onAppliedPolicyIdReady"));this.Tdb.e8k(Object(n.a)(this,this.d$g,"onIsManuallyAppliedReady"))}X3f(A,W){A?(this.c1=A,this.G8c=W,A=new Gj.a(new Oo(A),na=>{this.Hjd(na)},na=>this.rib(na)),this.ai.Hb(A)):bd.a.J(41735234,822,15,"GetAppliedPolicyIdAsync: tenantId is null or empty")}qjj(A,W){!W||ob.a.Xa(A)?bd.a.J(51446608,822,15,"GetIsManuallyAppliedAsync: tenantId or callback is null or empty"):(this.c1=A,this.rze=W,A=new Gj.a(new Oo(A),na=>{this.Hjd(na)},na=>this.rib(na)),this.ai.Hb(A))}H7g(A,W){A="";
ob.a.Xa(W.lja)||(A=W.lja);"00000000-0000-0000-0000-000000000000"===A?(W=ob.a.Xa(this.c1)?this.Jb.Ha("TenantId"):this.c1,this.X3f(W,this.G8c)):this.KKe(A,null)}d$g(A,W){this.rEk(W.nbc)}Hjd(A){let W=null;A.ServerError&&0!==A.ServerError.Code?W=th.a[A.ServerError.Code]:0!==A.StatusCode&&(W=lj.a[A.StatusCode]);W&&this.KKe("",W)}rib(){bd.a.J(41735236,822,15,"OnGetAppliedPolicyIdFailed()");this.KKe("","ErrorGetAppliedPolicyIdFailed");return!0}KKe(A,W){W&&bd.a.J(41735238,822,15,"OnAppliedPolicyIdReceived: error: "+
W);this.G8c?this.G8c(A,W):bd.a.J(50628552,822,15,"m_getAppliedPolicyIdCallback is null");bd.a.J(587239824,822,50,"OnAppliedPolicyIdReceived: Triggering OnAppliedPolicyReceivedEvent");A=new rn(A);this.xa.raiseEvent("AppliedPolicyEventReceivedKey",A)}rEk(A){this.rze?this.rze(A,null):bd.a.J(51446615,822,15,"m_getIsManuallyAppliedCallback is null")}}Object(h.a)(qj,"AppliedPolicyIdService",null,[516,107]);class op{constructor(A,W,na,Ga){this.bGb=A;this.SGa=W;this.CU=na;this.la=Ga}MQ(A){var W=A.automatic||
{},na=W.sensitivityLabel||{};W=this.sme()?W.id:na.id;na=A.recommended||{};const Ga=na.sensitivityLabel||{};A=this.sme()?na.id:Ga.id;na=this.sme()?na.policyTip:Ga.policyTip;this.la.pptIsManuallyAppliedForAclpIsEnabled?this.bGb.iCf(W,A,na,!this.CU.qv.AppliedPolicyId||!this.SGa.nbc):this.bGb.iCf(W,A,na,!this.CU.qv.AppliedPolicyId)}sme(){return this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)}}Object(h.a)(op,"AutoClpAnnotationEventHandler",null,[]);class sn{constructor(){this.ApplyLabelType=
0;this.LabelJson=this.LabelId=this.DocLocation=null;this.SkipContentMarking=!1;this.UserPrincipalName=this.UserName=this.TenantId=null}}Object(h.a)(sn,"PolicyInfo",null,[]);var tn=d(1035);class Gk{constructor(){this.RJb=this.startTime=null}}Object(h.a)(Gk,"PollingData",null,[]);class un{constructor(A,W,na,Ga,Ka,qb,Qb,t,Y,pa,Ja,Ya){this.bZg=this.LEb=!1;this.q7c=null;this.xIg=!1;this.ia=A;this.bGb=W;this.CU=na;this.c1=Ga;this.lAg=new Ea.a;this.Khk=Ka;this.SGa=qb;this.wb=Qb;this.ZYg=t;this.Mq=Y;this.CJ=
pa;this.Vv=Ja;this.pc=Ya;this.mQg=M.AFrameworkApplication.fa.wc("ClpLabelPollingIntervalMs",3E4);this.jEe=M.AFrameworkApplication.fa.wc("ClpLabelPollingTimeoutMs",3E5);this.Nna=M.AFrameworkApplication.fa.Ha("UserName");this.zsk=M.AFrameworkApplication.fa.Ha("UserPrincipalName");this.pgk=this.Pfj()}Pfj(){let A;if(M.AFrameworkApplication.fa.ka("DynamicVariableCLPFixEnabled")){if(A=M.AFrameworkApplication.fa.Ha("EditDocInClientUrl"))return bd.a.J(512263634,822,50,"PptPolicyManager::GetDocLocation EditDocInClientUrl is not null"),
A;bd.a.J(512263633,822,10,"PptPolicyManager::GetDocLocation EditDocInClientUrl is null")}(A=M.AFrameworkApplication.fa.Ha("WOPISrc"))||bd.a.J(512263632,822,10,"PptPolicyManager::GetDocLocation WOPISrc is null");bd.a.J(512263631,822,50,"PptPolicyManager::GetDocLocation WOPISrc is not null");return A}dispose(){this.bGb=null;if(this.LEb){this.CU.jph(Object(n.a)(this,this.Pah,"onSetLabelSucceeded"));for(let A of this.lAg)this.CU.jph(A)}}init(){this.bGb.vb();this.bGb.pe();if(M.AFrameworkApplication.fa.ka("PPTClpSwitchEnabled")&&
M.AFrameworkApplication.fa.ka("SupportsOfficeClientCoauthoring")){const A=Object(z.a)(tn.a,vc.App.Mh);A&&this.CU.A2k(Object(n.a)(A,A.Jmi,"areAllCoauthorsInSessionClientMipTrusted"));this.CU.PMj(this.Khk);0<this.mQg&&0<this.jEe&&this.SGa.$fi(Object(n.a)(this,this.FCk,"onDocumentContentPolicyChanged"));M.AFrameworkApplication.Zua&&this.ZYg.f3k(()=>this.Mq.lRh);this.Mq.G4&&(bd.a.J(512263630,822,50,"PPTPolicyManager::Init - Setting LockId to {0}",this.Mq.G4),this.CU.i_e(this.Mq.G4));this.CJ.Ofi(()=>{bd.a.J(512263629,
822,50,"PPTPolicyManager::LockIdChanged - Setting LockId to {0}",this.Mq.G4);this.CU.i_e(this.Mq.G4)})}this.CU.Kii(Object(n.a)(this,this.Gmi,"applyUdpLabeling"));this.CU.L3k(Object(n.a)(this,this.sUj,"isClpBlockedByAppSpecificScenario"));this.CU.Tfi(Object(n.a)(this,this.ami,"applyMandatoryLabeling"));this.CU.yTd(Object(n.a)(this,this.Pah,"onSetLabelSucceeded"));this.LEb=!0}Gmi(A,W){W.Ssl&&M.AFrameworkApplication.Ra.processAction(fd.a.openInClient,2)}sUj(){const A=!this.pc.getState(2)&&!this.pc.Wpg;
this.bZg!==A&&(this.pc.Hwg(),bd.a.J(512263628,822,50,"PPTPolicyManager::IsClpBlockedByAppSpecificScenario - {0}",A),this.bZg=A);return A}get lja(){return this.CU.qv.AppliedPolicyId}Y3k(A){this.CU.yTd(A);this.lAg.add(A)}nOk(A,W,na){const Ga=new sn;Ga.TenantId=this.c1;Ga.LabelId=A;Ga.ApplyLabelType=W;Ga.LabelJson=un.d6i(C.c(na));Ga.SkipContentMarking=!1;Ga.UserName=this.Nna;Ga.UserPrincipalName=this.zsk;Ga.DocLocation=this.pgk;bd.a.J(512263627,822,50,"PersistLabelToWorker: Updating worker with received policy");
this.ia.Ka(fd.a.ygh,2,Ga)}ami(A,W){if(W&&0!==W.mUd){(A=1===W.mUd)?this.Vv.yGh():(this.Vv.vGh(),""!==W.A2g&&this.ZYg.bmi(W.A2g));W=A?1:3;var na=M.AFrameworkApplication.Ra.mode;W!==na?bd.a.J(512263625,822,10,"ApplyMandatoryLabeling ModeSwitch Failed. Expected: {0}, Current: {1}",W,na):this.xIg=A}else bd.a.J(512263626,822,50,"ApplyMandatoryLabelling is called with invalid inputs.")}Pah(A,W){this.nOk(W.Yfh,W.p8,this.CU.qv);bd.a.J(512263624,822,50,"OnSetLabelSucceeded: Set policy label to ppt file after set label succeeded on host.")}C6d(A){A&&
this.lja?A=this.lja.toLowerCase()===A.toLowerCase():(bd.a.J(512263623,822,50,"FLabelIdMatchesPolicyManager: null labelId or null AppliedPolicyId, can't compare case insensitively. fNullLabelId:{0} fNullAppliedPolicyId:{1}",!A,!this.lja),A=A===this.lja);bd.a.J(512263622,822,50,"FLabelIdMatchesPolicyManager: fLabelIdMatchesPolicyManager:{0}",A);return A}iPk(A){const W=Object(z.a)(Gk,A.customData);if(W){var na=+new Date-+W.startTime;bd.a.J(512263620,822,50,"PollingTaskCallback: Callback received, durationMs:{0}",
na);this.C6d(W.RJb)||na>this.jEe||W.RJb!==this.q7c?(bd.a.J(512263619,822,50,"PollingTaskCallback: Stopping loop due to FAreInSync:{0} fDidTimeout:{1} fStaleLabelId:{2}",this.C6d(W.RJb),na>this.jEe,W.RJb!==this.q7c),this.wb.Lg(A)):(bd.a.J(512263618,822,50,"PollingTaskCallback: Triggering GetPolicy call"),this.CU.PTa(W.RJb,void 0,un.RQa,!0))}else bd.a.J(512263621,822,15,"PollingTaskCallback: Failed to get pollingData from taskItem, removing task"),this.wb.Lg(A)}jCl(A){bd.a.J(512263617,822,50,"SubmitPollingTask: Submitting new polling task");
const W=new be.a(2,2,this.mQg,Object(n.a)(this,this.iPk,"pollingTaskCallback"),90,"113");W.customData=Object.assign(new Gk,{startTime:new Date,RJb:A});this.wb.Hb(W)}FCk(A,W){bd.a.J(512263616,822,50,"OnDocumentContentPolicyChanged: Notification received");W.lja||bd.a.J(512263587,822,50,"OnDocumentContentPolicyChanged: Empty labelId - could indicate bug or all labels removed");this.q7c=W.lja;this.C6d(this.q7c)?bd.a.J(512263586,822,50,"OnDocumentContentPolicyChanged: PODS is in agreement with SPO, no need to poll"):
this.jCl(W.lja)}static RQa(){const A=vc.App.Mh.amIAlone,W=vc.App.Mh.RQa;let na=!1;const Ga=Object(z.a)(tn.a,vc.App.Mh);Ga&&(na=Ga.Kmi());bd.a.J(512263585,822,50,"AmITheOnlyCoauthor: Used block self coauth flow, fAmIAlone:{0} fAmITheOnlyCoauthor:{1} fAreAllCoauthorsWebClients:{2}",A,W,na);return A||W&&na}static d6i(A){A=A.replace(RegExp(":null","gi"),':""');return A=A.replace(RegExp('"LabelActions":',"gi"),'"Actions":')}}Object(h.a)(un,"PptPolicyManager",null,[107]);class pp{constructor(A,W,na,Ga){this.lek=
A;this.oc=W;this.Eb=na;this.la=Ga}vb(){this.lek.ra(fd.a.ygh,zh.a.application,Object(n.a)(this,this.qzj,"handleApplySensitivity"),4)}pe(){}qzj(A,W,na,Ga,Ka){if(!(M.AFrameworkApplication.fa.ka("WacLabelingPoliciesIsEnabled")&&M.AFrameworkApplication.fa.ka("WacApplyManualPolicyLabelIsEnabled")&&this.la.pptLabelingGetPolicyLabelsIsEnabled&&this.la.pptApplyManualPolicyLabelIsEnabled&&M.AFrameworkApplication.fa.ka("SupportsPolicies")))return 16;if(W.contextId!==zh.a.application)return 2;if(!Ka||!Object(li.a)(sn,
Ka))return 8;A=Object(z.a)(sn,Ka);if(ob.a.Xa(A.TenantId))return bd.a.J(41793040,808,10,"The tenant id of policy info is empty or null"),8;if(ob.a.Xa(A.LabelJson))return bd.a.J(41793042,808,10,"The label json of policy info is empty or null"),8;if(1===na)return 32;na=this.oc.tn;W=this.Eb.xd(7);try{W.hc(na),na.SJb=A}finally{W&&W.dispose()}return 32}}Object(h.a)(pp,"SetPolicyActor",null,[251]);class eo{constructor(){this.hec=this.Sbd=this.Jb=this.SGa=this.K=null;this.LWg=!0}get name(){return"PowerPointWebEditor.Policy"}Yb(A){this.K=
A;this.K.register(516,"PowerPointWebEditor.Policy.IAppliedPolicyIdService").ma().oa(()=>new qj(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventHandler"),this.K.resolve("Common.IAppSettingsManager")))}init(){this.Jb=this.K.resolve("Common.IAppSettingsManager");this.Jb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SensitivityTTVRImprovementEnabled",!1)?this.Jb.Nbb(Object(n.a)(this,this.en,"onFullAppSettingsReady")):this.K.resolve("Common.IAppSettingsManager").ff(Object(n.a)(this,
this.en,"onFullAppSettingsReady"))}dispose(){}en(){if(this.Jb.ka("WacLabelingPoliciesIsEnabled")&&this.Jb.ka("SupportsPolicies")&&this.Jb.ka("890"))this.SGa=this.K.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),uc.a.get_instance().Mj(10,Object(n.a)(this,this.qAk,"onAfterRibbonDisplayed")),qn.a.Lt(this.K.Ia("Common.App.Policy.Contracts.IPolicyManager")).continueWith(A=>{const W=new pp(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"));A=A.result;this.Sbd=new un(this.K.resolve("Common.IActionManagerExtended"),W,A,this.Jb.Ha("TenantId"),this.K.Ia("Common.Interface.IRtcBasicProvider"),this.K.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Common.App.Policy.Contracts.IPolicyActor"),this.K.resolve("PowerPointWebEditor.ICoauthStateSetter"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),
this.K.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"));this.Sbd.init()});else if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").Fkb){const A=this.K.resolve("PowerPointWebEditor.IPPTRumTracker");A.waa(A.v6,A.Cvh)}}qAk(){qn.a.Lt(this.K.Ia("Common.App.Policy.Contracts.IPolicyManager")).continueWith(A=>{const W=A.result;M.AFrameworkApplication.fa.ka("AutoClpIsEnabled")&&(bd.a.J(512274584,822,50,"OnAfterRibbonDisplayed: Registering with GetAutoPolicyLabelHandler API"),
this.hec=new Za.a(()=>new op(this.K.resolve("Common.App.Policy.Contracts.IPolicyActor"),this.K.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),W,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.Jb.Ha("TenantId"))),W.zfi(Object(n.a)(this,this.C2k,"registerAutoClpAnnotationEventHandler")),M.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)&&(W.jfi(Object(n.a)(this,this.cOc,"createAutoCLPSecurityNodes")),W.Mii(Object(n.a)(this,
this.$Ml,"updateAutoCLPLabelPriorityNode")),W.Nii(Object(n.a)(this,this.aNl,"updateAutoCLPSITNodes"))));(A=this.Jb.Ha("AppliedPolicyId"))||M.AFrameworkApplication.fa.ka("PPTClpSwitchEnabled")&&M.AFrameworkApplication.fa.ka("SupportsOfficeClientCoauthoring")?M.AFrameworkApplication.fa.ka("PPTOCoauthorPopUpFixManualCLPEnabled")?W.PTa(A,void 0,un.RQa):W.PTa(A):(A=this.Jb.Ha("TenantId"),ob.a.Xa(A)?bd.a.J(512274583,822,15,"OnAfterRibbonDisplayed: tenantId is null or empty"):(bd.a.J(512274582,822,50,"OnAfterRibbonDisplayed: Call AppliedPolicyIdService.GetAppliedPolicyIdAsync"),
this.SGa.X3f(A,(na,Ga)=>{Ga&&bd.a.J(512274581,822,15,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetAppliedPolicyIdAsync failed: "+Ga);ob.a.Xa(na)&&(na="",bd.a.J(512274580,822,50,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetAppliedPolicyIdAsync: appliedPolicyIdInFile is empty"));M.AFrameworkApplication.fa.ka("PPTOCoauthorPopUpFixManualCLPEnabled")?W.PTa(na,void 0,un.RQa):W.PTa(na)}),this.SGa.qjj(A,(na,Ga)=>{Ga?bd.a.J(512274579,822,15,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetIsManuallyAppliedAsync failed: "+
Ga):this.SGa.nbc=na}),this.Sbd.Y3k(Object(n.a)(this,this.MOl,"updateIsManuallyApplied"))))})}C2k(){const A=this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState");this.LWg&&(A.Pn||this.Sbd.xIg&&A.Pbc)&&(this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(W=>{bd.a.J(512274578,822,50,"RegisterAutoClpAnnotationEventHandler: Registering with AugLoopRuntimeManager");M.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",
!1)?(W.VZ("AugLoop_SecurityClp_LabellingAnnotation"),W.Moa("AugLoop_SecurityClp_LabellingAnnotation",Object(n.a)(this.hec.value,this.hec.value.MQ,"handleAnnotationEvent"))):(W.VZ("AugLoop_Automatic_Clp_LabellingAnnotation"),W.Moa("AugLoop_Automatic_Clp_LabellingAnnotation",Object(n.a)(this.hec.value,this.hec.value.MQ,"handleAnnotationEvent")))}),this.LWg=!1)}cOc(A,W){A=[Object.assign(new bo.a,{id:"clp",body:Object.assign(new Km,{existingLabelPriority:W.existingLabelPriority,partialDocSITs:W.oLf,fullDocSITs:W.nLf})})];
const na=Object.assign(new em.a,{parentPath:["session","doc","security"],items:A});this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(Ga=>{bd.a.J(512274577,822,50,"CreateAutoCLPSecurityNodes: Submit AddOperations to AugLoopRuntimeManager");Ga.submitOperation(na)})}$Ml(A,W){A=[Object.assign(new bo.a,{id:"clp",body:Object.assign(new Km,{existingLabelPriority:W.existingLabelPriority})})];const na=Object.assign(new co.a,{parentPath:["session","doc","security"],items:A});
this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(Ga=>{bd.a.J(512274576,822,50,"UpdateAutoCLPLabelPriorityNode: Submit UpdateOperation to AugLoopRuntimeManager");Ga.submitOperation(na)})}aNl(A,W){A=[Object.assign(new bo.a,{id:"clp",body:Object.assign(new Km,{partialDocSITs:W.oLf,fullDocSITs:W.nLf})})];const na=Object.assign(new co.a,{parentPath:["session","doc","security"],items:A});this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(Ga=>
{bd.a.J(512274575,822,50,"updateAutoCLPSITNodes: Submit UpdateOperation to AugLoopRuntimeManager");Ga.submitOperation(na)})}MOl(A,W){W&&(this.SGa.nbc=W.Yfh&&0!==W.p8?2===W.p8||8===W.p8||16===W.p8?!0:!1:!1)}static main(){Ia.a.instance.Ac(new eo)}}Object(h.a)(eo,"PPTWebEditorPolicyPackage",null,[2,3]);var qp=d(13);Type.registerNamespace("B4Intent");Type.registerNamespace("Box4.Dictation");Type.registerNamespace("Box4.Dictation.Authentication");Type.registerNamespace("Box4.DictationCorrections");Type.registerNamespace("Common.App.CatchUpActivity");
Type.registerNamespace("OfficeVoice.FrontdoorSpeechClient");Type.registerNamespace("PPTe");Type.registerNamespace("PowerPoint");Type.registerNamespace("PowerPointSafeLinks");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.Activity");Type.registerNamespace("PowerPointWebEditor.Animations");Type.registerNamespace("PowerPointWebEditor.Dictation");Type.registerNamespace("PowerPointWebEditor.FirstRunExperience");Type.registerNamespace("PowerPointWebEditor.Policy");
Type.registerNamespace("PowerPointWebEditor.RevisionTracking");Object(qp.c)("Chronosslim");Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");Qa.main();Type.registerNamespace("Common.App.CatchUpActivity");tb.main();Type.registerNamespace("Common.App.Rename");Ia.a.instance.Ac(new Qc,7);Type.registerNamespace("Common.App.Rename.RenameExecutor");Ia.a.instance.Ac(new fe);Type.registerNamespace("Common.App.SafeLinks");le.main();zi.main();Sj.main();Hg.main();
Tb.main();Cc.main();sg.main();Ia.a.instance.Ac(new Nk);Wn.main();Ia.a.instance.Ac(new on);dl.main();Type.registerNamespace("Common.App.AugmentationLoop");Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.Policy");Lj.main();eo.main();Object(qp.b)("Chronosslim")},215:function(K,U,d){K=d(0);var h=d(56);class e{constructor(n,z,v,x,B){this.OHa=!1;this.qEb=n;this.vDb=z;this.pec=v;this.yjk=B;this.OFb=x.XEa(v,z.name)}get XFf(){return this.pec}Yb(n){this.OFb.oEf();this.vDb.Yb(n);
this.OFb.TWf()}init(){this.OFb.Zt(this.vDb.name+"_d");this.yjk?this.qEb.NMj(this,this.pec):this.qEb.MMj(this,this.pec)}LMj(){this.OFb.fu(this.vDb.name+"_d");this.OFb.qEf();this.vDb.init();this.OHa=!0;this.OFb.WWf()}dispose(){this.OHa&&this.vDb.dispose()}get name(){return this.vDb.name}}Object(K.a)(e,"DelayLoadedPackage",null,[630,2,3]);class r{constructor(n,z){this.qEb=null;n.execute(v=>{this.qEb=v});this.afk=z}create(n,z,v){return this.qEb?new e(this.qEb,n,z,this.afk.value,v):n}static get instance(){return r.La||
(r.La=new r(h.a.instance.Ia("PowerPointWebEditor.DelayLoadedPackageInitializer"),h.a.instance.oe("PowerPointWebEditor.Core.IBundleMetricRecorder")))}}r.La=null;Object(K.a)(r,"DelayLoadedPackageFactory",null,[]);d.d(U,"a",function(){return m});const m=(n,z)=>r.instance.create(n,z,!1)},703:function(K,U,d){(function(h){function e(){try{var Z=new Uint8Array(1);Z.__proto__={__proto__:Uint8Array.prototype,mXl:function(){return 42}};return"function"===typeof Z.subarray&&0===Z.subarray(1,1).byteLength}catch(fa){return!1}}
function r(Z,fa){if((m.r2?2147483647:1073741823)<fa)throw new RangeError("Invalid typed array length");m.r2?(Z=new Uint8Array(fa),Z.__proto__=m.prototype):(null===Z&&(Z=new m(fa)),Z.length=fa);return Z}function m(Z,fa,aa){if(!(m.r2||this instanceof m))return new m(Z,fa,aa);if("number"===typeof Z){if("string"===typeof fa)throw Error("If encoding is specified then the first argument must be a string");return v(this,Z)}return n(this,Z,fa,aa)}function n(Z,fa,aa,ja){if("number"===typeof fa)throw new TypeError('"value" argument must not be a number');
if("undefined"!==typeof ArrayBuffer&&fa instanceof ArrayBuffer){fa.byteLength;if(0>aa||fa.byteLength<aa)throw new RangeError("'offset' is out of bounds");if(fa.byteLength<aa+(ja||0))throw new RangeError("'length' is out of bounds");fa=void 0===aa&&void 0===ja?new Uint8Array(fa):void 0===ja?new Uint8Array(fa,aa):new Uint8Array(fa,aa,ja);m.r2?(Z=fa,Z.__proto__=m.prototype):Z=x(Z,fa);fa=Z}else if("string"===typeof fa){ja=Z;Z=aa;if("string"!==typeof Z||""===Z)Z="utf8";if(!m.qne(Z))throw new TypeError('"encoding" must be a valid string encoding');
aa=w(fa,Z)|0;ja=r(ja,aa);fa=ja.write(fa,Z);fa!==aa&&(ja=ja.slice(0,fa));fa=ja}else fa=B(Z,fa);return fa}function z(Z){if("number"!==typeof Z)throw new TypeError('"size" argument must be a number');if(0>Z)throw new RangeError('"size" argument must not be negative');}function v(Z,fa){z(fa);Z=r(Z,0>fa?0:D(fa)|0);if(!m.r2)for(var aa=0;aa<fa;++aa)Z[aa]=0;return Z}function x(Z,fa){var aa=0>fa.length?0:D(fa.length)|0;Z=r(Z,aa);for(var ja=0;ja<aa;ja+=1)Z[ja]=fa[ja]&255;return Z}function B(Z,fa){if(m.isBuffer(fa)){var aa=
D(fa.length)|0;Z=r(Z,aa);if(0===Z.length)return Z;fa.copy(Z,0,0,aa);return Z}if(fa){if("undefined"!==typeof ArrayBuffer&&fa.buffer instanceof ArrayBuffer||"length"in fa)return(aa="number"!==typeof fa.length)||(aa=fa.length,aa=aa!==aa),aa?r(Z,0):x(Z,fa);if("Buffer"===fa.type&&ca(fa.data))return x(Z,fa.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function D(Z){if(Z>=(m.r2?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+
(m.r2?2147483647:1073741823).toString(16)+" bytes");return Z|0}function w(Z,fa){if(m.isBuffer(Z))return Z.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(Z)||Z instanceof ArrayBuffer))return Z.byteLength;"string"!==typeof Z&&(Z=""+Z);var aa=Z.length;if(0===aa)return 0;for(var ja=!1;;)switch(fa){case "ascii":case "latin1":case "binary":return aa;case "utf8":case "utf-8":case void 0:return R(Z).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*
aa;case "hex":return aa>>>1;case "base64":return O(Z).length;default:if(ja)return R(Z).length;fa=(""+fa).toLowerCase();ja=!0}}function J(Z,fa,aa){var ja=!1;if(void 0===fa||0>fa)fa=0;if(fa>this.length)return"";if(void 0===aa||aa>this.length)aa=this.length;if(0>=aa)return"";aa>>>=0;fa>>>=0;if(aa<=fa)return"";for(Z||(Z="utf8");;)switch(Z){case "hex":Z=fa;fa=aa;aa=this.length;if(!Z||0>Z)Z=0;if(!fa||0>fa||fa>aa)fa=aa;ja="";for(aa=Z;aa<fa;++aa)Z=ja,ja=this[aa],ja=16>ja?"0"+ja.toString(16):ja.toString(16),
ja=Z+ja;return ja;case "utf8":case "utf-8":return N(this,fa,aa);case "ascii":Z="";for(aa=Math.min(this.length,aa);fa<aa;++fa)Z+=String.fromCharCode(this[fa]&127);return Z;case "latin1":case "binary":Z="";for(aa=Math.min(this.length,aa);fa<aa;++fa)Z+=String.fromCharCode(this[fa]);return Z;case "base64":return 0===fa&&aa===this.length?T.y2f(this):T.y2f(this.slice(fa,aa));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":fa=this.slice(fa,aa);aa="";for(Z=0;Z<fa.length;Z+=2)aa+=String.fromCharCode(fa[Z]+
256*fa[Z+1]);return aa;default:if(ja)throw new TypeError("Unknown encoding: "+Z);Z=(Z+"").toLowerCase();ja=!0}}function G(Z,fa,aa,ja,I){if(0===Z.length)return-1;"string"===typeof aa?(ja=aa,aa=0):2147483647<aa?aa=2147483647:-2147483648>aa&&(aa=-2147483648);aa=+aa;isNaN(aa)&&(aa=I?0:Z.length-1);0>aa&&(aa=Z.length+aa);if(aa>=Z.length){if(I)return-1;aa=Z.length-1}else if(0>aa)if(I)aa=0;else return-1;"string"===typeof fa&&(fa=m.from(fa,ja));if(m.isBuffer(fa))return 0===fa.length?-1:M(Z,fa,aa,ja,I);if("number"===
typeof fa)return fa&=255,m.r2&&"function"===typeof Uint8Array.prototype.indexOf?I?Uint8Array.prototype.indexOf.call(Z,fa,aa):Uint8Array.prototype.lastIndexOf.call(Z,fa,aa):M(Z,[fa],aa,ja,I);throw new TypeError("val must be string, number or Buffer");}function M(Z,fa,aa,ja,I){function sa(ma,va){return 1===ka?ma[va]:ma.Y_k(va*ka)}var ka=1,Ma=Z.length,Ea=fa.length;if(void 0!==ja&&(ja=String(ja).toLowerCase(),"ucs2"===ja||"ucs-2"===ja||"utf16le"===ja||"utf-16le"===ja)){if(2>Z.length||2>fa.length)return-1;
ka=2;Ma/=2;Ea/=2;aa/=2}if(I)for(ja=-1;aa<Ma;aa++)if(sa(Z,aa)===sa(fa,-1===ja?0:aa-ja)){if(-1===ja&&(ja=aa),aa-ja+1===Ea)return ja*ka}else-1!==ja&&(aa-=aa-ja),ja=-1;else for(aa+Ea>Ma&&(aa=Ma-Ea);0<=aa;aa--){Ma=!0;for(ja=0;ja<Ea;ja++)if(sa(Z,aa+ja)!==sa(fa,ja)){Ma=!1;break}if(Ma)return aa}return-1}function N(Z,fa,aa){aa=Math.min(Z.length,aa);for(var ja=[];fa<aa;){var I=Z[fa],sa=null,ka=239<I?4:223<I?3:191<I?2:1;if(fa+ka<=aa)switch(ka){case 1:128>I&&(sa=I);break;case 2:var Ma=Z[fa+1];128===(Ma&192)&&
(I=(I&31)<<6|Ma&63,127<I&&(sa=I));break;case 3:Ma=Z[fa+1];var Ea=Z[fa+2];128===(Ma&192)&&128===(Ea&192)&&(I=(I&15)<<12|(Ma&63)<<6|Ea&63,2047<I&&(55296>I||57343<I)&&(sa=I));break;case 4:Ma=Z[fa+1];Ea=Z[fa+2];var ma=Z[fa+3];128===(Ma&192)&&128===(Ea&192)&&128===(ma&192)&&(I=(I&15)<<18|(Ma&63)<<12|(Ea&63)<<6|ma&63,65535<I&&1114112>I&&(sa=I))}null===sa?(sa=65533,ka=1):65535<sa&&(sa-=65536,ja.push(sa>>>10&1023|55296),sa=56320|sa&1023);ja.push(sa);fa+=ka}Z=ja.length;if(Z<=L)ja=String.fromCharCode.apply(String,
ja);else{aa="";for(fa=0;fa<Z;)aa+=String.fromCharCode.apply(String,ja.slice(fa,fa+=L));ja=aa}return ja}function R(Z,fa){fa=fa||Infinity;for(var aa,ja=Z.length,I=null,sa=[],ka=0;ka<ja;++ka){aa=Z.charCodeAt(ka);if(55295<aa&&57344>aa){if(!I){if(56319<aa){-1<(fa-=3)&&sa.push(239,191,189);continue}else if(ka+1===ja){-1<(fa-=3)&&sa.push(239,191,189);continue}I=aa;continue}if(56320>aa){-1<(fa-=3)&&sa.push(239,191,189);I=aa;continue}aa=(I-55296<<10|aa-56320)+65536}else I&&-1<(fa-=3)&&sa.push(239,191,189);
I=null;if(128>aa){if(0>--fa)break;sa.push(aa)}else if(2048>aa){if(0>(fa-=2))break;sa.push(aa>>6|192,aa&63|128)}else if(65536>aa){if(0>(fa-=3))break;sa.push(aa>>12|224,aa>>6&63|128,aa&63|128)}else if(1114112>aa){if(0>(fa-=4))break;sa.push(aa>>18|240,aa>>12&63|128,aa>>6&63|128,aa&63|128)}else throw Error("Invalid code point");}return sa}function C(Z){for(var fa=[],aa=0;aa<Z.length;++aa)fa.push(Z.charCodeAt(aa)&255);return fa}function O(Z){var fa=T,aa=fa.pGl;Z=(Z.trim?Z.trim():Z.replace(/^\s+|\s+$/g,
"")).replace(da,"");if(2>Z.length)Z="";else for(;0!==Z.length%4;)Z+="=";return aa.call(fa,Z)}function S(Z,fa,aa,ja){for(var I=0;I<ja&&!(I+aa>=fa.length||I>=Z.length);++I)fa[I+aa]=Z[I];return I}var T=d(1170);d(1171);var ca=d(1172);U.Ozd=m;U.BWl=function(Z){+Z!=Z&&(Z=0);return m.IAf(+Z)};U.nWl=50;m.r2=void 0!==h.r2?h.r2:e();U.JXl=m.r2?2147483647:1073741823;m.from=function(Z,fa,aa){return n(null,Z,fa,aa)};m.r2&&(m.prototype.__proto__=Uint8Array.prototype,m.__proto__=Uint8Array,"undefined"!==typeof Symbol&&
Symbol.species&&m[Symbol.species]===m&&Object.defineProperty(m,Symbol.species,{value:null,configurable:!0}));m.IAf=function(Z){z(Z);return r(null,Z)};m.vki=function(Z){return v(null,Z)};m.isBuffer=function(Z){return!(null==Z||!Z.M_h)};m.compare=function(Z,fa){if(!m.isBuffer(Z)||!m.isBuffer(fa))throw new TypeError("Arguments must be Buffers");if(Z===fa)return 0;for(var aa=Z.length,ja=fa.length,I=0,sa=Math.min(aa,ja);I<sa;++I)if(Z[I]!==fa[I]){aa=Z[I];ja=fa[I];break}return aa<ja?-1:ja<aa?1:0};m.qne=
function(Z){switch(String(Z).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};m.concat=function(Z,fa){if(!ca(Z))throw new TypeError('"list" argument must be an Array of Buffers');if(0===Z.length)return m.IAf(0);var aa;if(void 0===fa)for(aa=fa=0;aa<Z.length;++aa)fa+=Z[aa].length;fa=m.vki(fa);var ja=0;for(aa=0;aa<Z.length;++aa){var I=Z[aa];if(!m.isBuffer(I))throw new TypeError('"list" argument must be an Array of Buffers');
I.copy(fa,ja);ja+=I.length}return fa};m.byteLength=w;m.prototype.M_h=!0;m.prototype.toString=function(){var Z=this.length|0;return 0===Z?"":0===arguments.length?N(this,0,Z):J.apply(this,arguments)};m.prototype.equals=function(Z){if(!m.isBuffer(Z))throw new TypeError("Argument must be a Buffer");return this===Z?!0:0===m.compare(this,Z)};m.prototype.compare=function(Z,fa,aa,ja,I){if(!m.isBuffer(Z))throw new TypeError("Argument must be a Buffer");void 0===fa&&(fa=0);void 0===aa&&(aa=Z?Z.length:0);void 0===
ja&&(ja=0);void 0===I&&(I=this.length);if(0>fa||aa>Z.length||0>ja||I>this.length)throw new RangeError("out of range index");if(ja>=I&&fa>=aa)return 0;if(ja>=I)return-1;if(fa>=aa)return 1;fa>>>=0;aa>>>=0;ja>>>=0;I>>>=0;if(this===Z)return 0;var sa=I-ja,ka=aa-fa,Ma=Math.min(sa,ka);ja=this.slice(ja,I);Z=Z.slice(fa,aa);for(fa=0;fa<Ma;++fa)if(ja[fa]!==Z[fa]){sa=ja[fa];ka=Z[fa];break}return sa<ka?-1:ka<sa?1:0};m.prototype.includes=function(Z,fa,aa){return-1!==this.indexOf(Z,fa,aa)};m.prototype.indexOf=function(Z,
fa,aa){return G(this,Z,fa,aa,!0)};m.prototype.lastIndexOf=function(Z,fa,aa){return G(this,Z,fa,aa,!1)};m.prototype.write=function(Z,fa,aa,ja){if(void 0===fa)ja="utf8",aa=this.length,fa=0;else if(void 0===aa&&"string"===typeof fa)ja=fa,aa=this.length,fa=0;else if(isFinite(fa))fa|=0,isFinite(aa)?(aa|=0,void 0===ja&&(ja="utf8")):(ja=aa,aa=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var I=this.length-fa;if(void 0===aa||aa>I)aa=I;if(0<Z.length&&(0>
aa||0>fa)||fa>this.length)throw new RangeError("Attempt to write outside buffer bounds");ja||(ja="utf8");for(I=!1;;)switch(ja){case "hex":fa=Number(fa)||0;ja=this.length-fa;aa?(aa=Number(aa),aa>ja&&(aa=ja)):aa=ja;ja=Z.length;if(0!==ja%2)throw new TypeError("Invalid hex string");aa>ja/2&&(aa=ja/2);for(ja=0;ja<aa;++ja){I=parseInt(Z.substr(2*ja,2),16);if(isNaN(I))break;this[fa+ja]=I}return ja;case "utf8":case "utf-8":return S(R(Z,this.length-fa),this,fa,aa);case "ascii":return S(C(Z),this,fa,aa);case "latin1":case "binary":return S(C(Z),
this,fa,aa);case "base64":return S(O(Z),this,fa,aa);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":ja=Z;I=this.length-fa;for(var sa=[],ka=0;ka<ja.length&&!(0>(I-=2));++ka){var Ma=ja.charCodeAt(ka);Z=Ma>>8;Ma%=256;sa.push(Ma);sa.push(Z)}return S(sa,this,fa,aa);default:if(I)throw new TypeError("Unknown encoding: "+ja);ja=(""+ja).toLowerCase();I=!0}};m.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.GWl||this,0)}};var L=4096;m.prototype.slice=function(Z,
fa){var aa=this.length;Z=~~Z;fa=void 0===fa?aa:~~fa;0>Z?(Z+=aa,0>Z&&(Z=0)):Z>aa&&(Z=aa);0>fa?(fa+=aa,0>fa&&(fa=0)):fa>aa&&(fa=aa);fa<Z&&(fa=Z);if(m.r2)fa=this.subarray(Z,fa),fa.__proto__=m.prototype;else{aa=fa-Z;fa=new m(aa,void 0);for(var ja=0;ja<aa;++ja)fa[ja]=this[ja+Z]}return fa};m.prototype.Y_k=function(Z){if(0!==Z%1||0>Z)throw new RangeError("offset is not uint");if(Z+2>this.length)throw new RangeError("Trying to access beyond buffer length");return this[Z]<<8|this[Z+1]};m.prototype.copy=function(Z,
fa,aa,ja){aa||(aa=0);ja||0===ja||(ja=this.length);fa>=Z.length&&(fa=Z.length);fa||(fa=0);0<ja&&ja<aa&&(ja=aa);if(ja===aa||0===Z.length||0===this.length)return 0;if(0>fa)throw new RangeError("targetStart out of bounds");if(0>aa||aa>=this.length)throw new RangeError("sourceStart out of bounds");if(0>ja)throw new RangeError("sourceEnd out of bounds");ja>this.length&&(ja=this.length);Z.length-fa<ja-aa&&(ja=Z.length-fa+aa);var I=ja-aa;if(this===Z&&aa<fa&&fa<ja)for(ja=I-1;0<=ja;--ja)Z[ja+fa]=this[ja+aa];
else if(1E3>I||!m.r2)for(ja=0;ja<I;++ja)Z[ja+fa]=this[ja+aa];else Uint8Array.prototype.set.call(Z,this.subarray(aa,aa+I),fa);return I};m.prototype.fill=function(Z,fa,aa,ja){if("string"===typeof Z){"string"===typeof fa?(ja=fa,fa=0,aa=this.length):"string"===typeof aa&&(ja=aa,aa=this.length);if(1===Z.length){var I=Z.charCodeAt(0);256>I&&(Z=I)}if(void 0!==ja&&"string"!==typeof ja)throw new TypeError("encoding must be a string");if("string"===typeof ja&&!m.qne(ja))throw new TypeError("Unknown encoding: "+
ja);}else"number"===typeof Z&&(Z&=255);if(0>fa||this.length<fa||this.length<aa)throw new RangeError("Out of range index");if(aa<=fa)return this;fa>>>=0;aa=void 0===aa?this.length:aa>>>0;Z||(Z=0);if("number"===typeof Z)for(ja=fa;ja<aa;++ja)this[ja]=Z;else for(Z=m.isBuffer(Z)?Z:R((new m(Z,ja)).toString()),I=Z.length,ja=0;ja<aa-fa;++ja)this[ja+fa]=Z[ja%I];return this};var da=/[^+\/0-9A-Za-z-_]/g}).call(this,d(997))},704:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(e,r,m,
n,z,v,x,B=null,D=null,w=!1,J=null,G=null,M=null,N=null,R=!1,C=null,O=null,S=null,T=null,ca=null,L=null){this.url=e;this.hTl=r;this.body=m;this.headers=n;this.s1e=z;this.priority=v;this.state=x;this.BQh=B;this.trc=D;this.Wi=w;this.cXk=J;this.eil=G;this.name=M;this.Eib=N;this.x8d=R;this.ykd=C;this.py=O;this.uAb=S;this.tMb=T;this.dJj=ca;this.responseType=L}}Object(K.a)(h,"ClientRequest",null,[])},705:function(K,U,d){d.d(U,"a",function(){return e});K=d(0);U=d(529);var h=d(143);class e extends U.a{constructor(){super();
this.isTriggeredBySyncDelta=null;this.H_=Object.assign(new h.a,{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_UpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(K.a)(e,"UpdateOperation",U.a,[])},747:function(K,U,d){K=d(0);var h=d(27),e=d(106),r=d(82),m=d(7),n=d(36),z=d(87),v=d(28),x=d(260);class B{constructor(){this.TenantId=this.LoggableUserId=this.FileSource=this.ProviderId=this.UserId=this.UserName=null;this.EnableMacrosForProtectedFile=
this.BrowserCacheAllowed=!1;this.ComplianceDomainPrefix=this.ServerDocId=null;this.IsCLPCoauthoringEnabled=this.IsO365CommercialHost=this.IsO365ConsumerHost=!1}}Object(K.a)(B,"PodsInfo",null,[]);d.d(U,"a",function(){return D});class D{constructor(w,J,G,M,N,R,C){v.a.J(512262873,804,50,"Start PodsInfoSender::PodsInfoSender()");this.Jb=C;this.Su=w;this.Ya=J;this.Mc=G;this.Bz=M;this.Ud=N;this.wb=R;this.LEb=!1;this.SYa=0;this.Jb.ff(Object(m.a)(this,this.initialize,"initialize"))}initialize(){v.a.J(512262872,
804,50,"Start PodsInfoSender::Initialize()");this.sendInfoToPods(null);this.Mc.HC(Object(m.a)(this,this.Mo,"onSessionRehydrated"));this.Bz.Lsb(Object(m.a)(this,this.fga,"onPodSessionRefreshed"));this.LEb=!0}dispose(){this.LEb&&(this.Mc.zga(Object(m.a)(this,this.Mo,"onSessionRehydrated")),this.Bz.fkb(Object(m.a)(this,this.fga,"onPodSessionRefreshed")),this.LEb=!1)}sendInfoToPods(){var w=this.Jb.Ha("361"),J=this.Ya.podSessionId;const G=this.Ya.Ek,M=h.AFrameworkApplication.userSessionId,N=e.a.create().toString();
v.a.J(512262871,804,50,"PodsInfoSender.SendInfoToPods: Send user info to Pods, correlation={0}",N);w=String.format("{0}PodHandler.ashx?action=SendUserInfo&PodSID={1}",w,J);J={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};J["X-UserSessionId"]=M;J["X-CorrelationID"]=N;J["X-WacCluster"]=G;try{const R=Object.assign(new B,{UserName:this.Jb.Ha(z.a.ZLk),UserId:this.Jb.Ha("387"),ProviderId:this.Jb.Ha("388"),FileSource:this.Jb.Ha("FileSource"),LoggableUserId:this.Jb.Ha("LoggableUserId"),
TenantId:this.Jb.Ha("TenantId"),BrowserCacheAllowed:this.Jb.ka("535")&&this.Jb.ka("431"),EnableMacrosForProtectedFile:h.AFrameworkApplication.l5b,ServerDocId:this.Jb.Ha("ServerDocId"),ComplianceDomainPrefix:h.AFrameworkApplication.fa.Ha("ComplianceDomainPrefix"),IsO365CommercialHost:this.Jb.ka("IsO365CommercialHost"),IsO365ConsumerHost:this.Jb.ka("IsO365ConsumerHost"),IsCLPCoauthoringEnabled:this.Jb.ka("PPTClpSwitchEnabled")&&this.Jb.ka("SupportsOfficeClientCoauthoring")}),C=n.c(R);this.Su.zj(w,2,
C,J,!1,1,Object(m.a)(this,this.pHk,"onSendUserInfoSucceeded"),Object(m.a)(this,this.oHk,"onSendUserInfoFailed"),null,void 0,void 0,void 0,void 0,x.a("6"))}catch(R){v.a.J(512262870,804,15,"PodsInfoSender.SendInfoToPods: error serializing user info {0}",R)}}pHk(){v.a.J(512262869,804,50,"PodsInfoSender.OnSendUserInfoSucceeded");this.SYa=0}oHk(){v.a.J(512262868,804,50,"PodsInfoSender.OnSendUserInfoFailed");3>this.SYa?this.Hcl():this.Zxj()}Hcl(){this.SYa++;v.a.J(512262867,804,50,"PodsInfoSender.RetryRequestOnFailure: Request failed - retrying (failures count: {0})",
this.SYa);const w=new r.a(1,1,5E3,Object(m.a)(this,this.sendInfoToPods,"sendInfoToPods"),90,"22");this.wb.Hb(w)}Zxj(){v.a.J(512262866,804,15,"PodsInfoSender.GiveUp: Request failed - giving up (failures count: {0})",this.SYa);this.Ud.nH(307,null);this.SYa=0}Mo(){this.SYa=0;v.a.J(512262865,804,50,"PodsInfoSender.OnSessionRehydrated");this.sendInfoToPods(null)}fga(){this.SYa=0;v.a.J(512262864,804,50,"PodsInfoSender.OnPodSessionRefreshed");this.sendInfoToPods(null)}}Object(K.a)(D,"PodsInfoSender",null,
[])},997:function(K){var U=function(){return this}();try{U=U||(new Function("return this"))()}catch(d){"object"===typeof window&&(U=window)}K.exports=U},998:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.message=this.title=null;this.Sgg=!1;this.CKb=null;this.Xgg=!1;this.Tqd=null;this.bgl=this.uTk=0;this.cgl=this.vTk=null;this.timeoutInSeconds=0;this.jHj=!1;this.RJj=null}}Object(K.a)(h,"CalloutNotificationMessageAttributes",null,[])},999:function(K,U,d){d.d(U,"a",
function(){return h});K=d(0);class h{constructor(){this.handler=null}}Object(K.a)(h,"SetAnnotationResultCallbackParameters",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19809348/wdjs/ppteditDS.chronosslim.js.map