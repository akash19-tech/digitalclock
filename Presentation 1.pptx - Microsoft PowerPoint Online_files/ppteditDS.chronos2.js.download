'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1001:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static b4f(e){switch(e){case 0:return"external";case 2:return"aad";case 1:return"msa";
default:return"external"}}}Object(K.a)(h,"WopiAuthContext",null,[869])},1022:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e,r,m=null){super();this.shapeId=e;this.Sig=r;this.bZ=m}}Object(K.a)(h,"ReplaceObjectSuggestionPointerOverEventArgs",Sys.EventArgs,[])},1023:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e,r=null){super();this.shapeId=e;this.bZ=r}}Object(K.a)(h,"ReplaceObjectSuggestionPointerOutEventArgs",
Sys.EventArgs,[])},1024:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.gKc=null}}Object(K.a)(h,"IdeasSmartArtSuggestionWrapper",null,[])},1286:function(K,U,d){function h(u){for(const P of[ResourceStrings.L_ImageDescriptionWithVeryHighConfidence,ResourceStrings.L_ImageDescriptionWithHighConfidence,ResourceStrings.L_ImageDescriptionWithMediumConfidence,ResourceStrings.L_ImageDescriptionWithLowConfidence,ResourceStrings.L_ImageDescriptionWithVeryLowConfidence])if(u.endsWith(P))return[!0,
u.length-P.length];return[!1,-1]}function e(u,P,la){const Ba=new ld.a;Ba.va.setAttributeNS(null,Ha.a.HI,Ha.a.lB);Ba.ah(P,la);Ba.xpa("0,0,2048,2048");P=new Pb.a;P.QY(u);Ba.appendChild(P);return Ba}d.r(U);var r=d(0),m=d(71),n=d(392),z=d(7),v=d(27),x=d(203),B=d(142),D;(function(u){u[u.error=0]="error";u[u.warning=1]="warning";u[u.tip=2]="tip";u[u.intelligentService=3]="intelligentService"})(D||(D={}));Object(r.b)("AccessibilityRuleCategory",D);var w=d(56),J=d(73),G=d(37),M=d(112),N=d(171),R=d(109);class C{constructor(u,
P,la=null){this.hAd=null;this.Rjf=this.njf=!1;this.oCa=u;this.fyc=P;this.Ca=la;this.qn.ya(G.a.ZBi,J.a.frame,Object(z.a)(this,this.aH,"closePane"))}get qn(){return this.Ca||(this.Ca=v.AFrameworkApplication.Ra)}set qn(u){this.Ca=u}uZi(){this.njf||(this.oCa.initialize(this),this.fyc.initialize(this),this.njf=!0)}iLe(){R.c(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});this.fyc.xdl()}hl(u,P,la){if(1===la)return x.SessionStatusManager.instance.gla?8:32;this.oCa.isVisible||this.uZi();this.Kwl();return 32}aH(u,
P,la){1!==la&&this.oCa.Iq();return 32}RMe(){this.oCa.oCh(!0)}V3d(u){if(u){if(u.AccessibilityRules&&Object.keys(u.AccessibilityRules).length){const la=u.AccessibilityRules;for(let Ba in la){var P=Ba;const Sa=la[Ba].RuleId+"";P!==Sa&&R.c(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",P,Sa)}this.hAd=la}else!this.hAd&&u.Results&&0<u.Results.length?(R.c(18993251,200,15,"No accessibility rule definitions available"),u.IsSuccess=!1):u.AccessibilityRules=this.hAd;
u.IsSuccess||R.c(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.k6k(u);this.Mck(u);this.oCa.V3d(u)}}k6k(u){const P=u.AccessibilityRules;if(u=u.Results)for(let la=u.length-1;0<=la;la--){const Ba=u[la];let Sa="";const pb=Ba.RuleId;Ba.ContentName||(Sa+="Result does not have content name. ");pb in P||(Sa+=String.format("No accessibility check rule exists for ID {0}.",pb));0<Sa.length&&(R.c(36214999,200,15,"Omitting invalid accessibility check result: "+Sa),Array.removeAt(u,la))}}zqj(){return v.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk("accessibility-checker-pane-strings"):w.a.instance.resolve("Common.IDynamicScriptLoaderProvider").rI.loadScript("accessibility-checker-pane-strings")}Kwl(){this.Rjf?this.oCa.hl():this.zqj().then(()=>{this.Rjf=!0;this.oCa.hl()}).catch(u=>n.ULS.sendTraceTag(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",u))}Mck(u){var P={};const la={};var Ba=u.Results,Sa=[];Array.add(Sa,Object.assign(new M.a,{name:"FinalViolationCount",int64:0}));
Array.add(Sa,Object.assign(new M.a,{name:"FinalErrorCount",string:"0"}));Array.add(Sa,Object.assign(new M.a,{name:"FinalWarningCount",string:"0"}));Array.add(Sa,Object.assign(new M.a,{name:"FinalTipCount",string:"0"}));Array.add(Sa,Object.assign(new M.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(Ba){for(const Bc of Ba)if(u.AccessibilityRules){var pb=u.AccessibilityRules[Bc.RuleId];if(pb){if(P[D[pb.Category]]){let Yc=P[D[pb.Category]];P[D[pb.Category]]=++Yc}else P[D[pb.Category]]=1;la[Bc.RuleId]?
(pb=la[Bc.RuleId],la[Bc.RuleId]=++pb):la[Bc.RuleId]=1}}Sa[0].int64=Ba.length;for(var Vb in P)switch(u=P[Vb],Ba=Vb,Ba="Final"+Ba.charAt(0).toUpperCase()+Ba.substring(1,Ba.length)+"Count",Ba){case "FinalErrorCount":Sa[1].string=u.toString();break;case "FinalWarningCount":Sa[2].string=u.toString();break;case "FinalTipCount":Sa[3].string=u.toString();break;case "FinalIntelligentServiceCount":Sa[4].string=u.toString()}}B.a.sendTelemetryEvent(Object.assign(new N.a,{name:String.format("{0}.{1}","Office.UX.AccChecker",
"AccCheckerViolationInformation"),dataFields:Sa}));for(let Bc in la)P=Bc,Sa=la[Bc],Vb=[],Array.add(Vb,Object.assign(new M.a,{name:"RuleID",string:P})),Array.add(Vb,Object.assign(new M.a,{name:"FinalViolationCount",string:Sa.toString()})),B.a.sendTelemetryEvent(Object.assign(new N.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:Vb}))}dispose(){this.oCa&&this.oCa.dispose();this.fyc&&this.fyc.dispose()}}Object(r.a)(C,"AAccessibilityCheckManager",
null,[181,107]);var O=d(82),S=d(1244),T=d(62),ca=d(292),L=d(28);class da extends C{constructor(u,P,la,Ba,Sa,pb,Vb,Bc,Yc){super(u,P);this.rgb=this.BIa=null;this.Fa=la;this.wb=Ba;this.Vq=Sa;this.u5=pb;this.ta=Vb;this.pa=Bc;this.Sb=Yc;this.RFe=!1}Qkl(u){if(!u)return L.a.J(19227927,334,15,"Cannot navigate since violation data is null"),!1;if(u.sldIdField){var P=new T.a(Object.assign(new ca.a,{Sid:u.sldIdField.sidField,Cid:u.sldIdField.cidField}));P=this.Sb.Wka(P);if(!P)return!1;let la=null;if(u.spIdFieldSpecified&&
(la=P.YC(u.spIdField),!la&&this.RFe))return!1;this.Cgl(P,la)}else L.a.J(19227929,334,15,"There is no slide id info in violation data");return!0}iLe(){this.RFe=!1;super.iLe()}RMe(){this.RFe=!0;super.RMe()}Cgl(u,P){if(u){const la=this.ta.Ba!==u?!0:!1;P&&(this.rgb=P,la?this.Vq.aT(Object(z.a)(this,this.LIb,"onActiveSlideDomChanged")):this.Ruh());la&&(this.u5.Ba=u);this.pa.au();this.Fa.Bd()}}LIb(){this.Vq.Uoa(Object(z.a)(this,this.LIb,"onActiveSlideDomChanged"));this.BIa||(this.BIa=new O.a(2,1,0,Object(z.a)(this,
this.KMe,"onPostActiveSlideDomChangedTask"),90,"20"),this.wb.Hb(this.BIa))}KMe(){this.BIa=null;this.Ruh()}Bd(){this.u5.fL.qp||this.Fa.Bd()}Ruh(){if(this.rgb){const u=Object(S.a)(119,this.rgb.tg(this.u5.fL.Na));u?u.Nl?L.a.J(19227931,334,50,"Shape view element of node {0} has been disposed",this.rgb.id):u.hq?u.nud():this.pa.selectShape(this.rgb,!0):L.a.J(19227933,334,50,"Try select node {0} but cannot find its shape view element",this.rgb.id);this.Bd();this.rgb=null}}}Object(r.a)(da,"PptAccCheckManager",
C,[]);class Z{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=!1;this.Results=null}static deserialize(u){u=Sys.Serialization.JavaScriptSerializer.deserialize(u);const P=u.AccessibilityRules,la={};if(P)for(let Ba=0;Ba<P.length;++Ba){const Sa=P[Ba];la[Sa.Key]=Sa.Value}u.AccessibilityRules=la;return u}}Object(r.a)(Z,"AccessibilityCheckResultCollection",null,[]);class fa{}Object(r.a)(fa,"AccessibilityCheckResult",null,[]);class aa{}Object(r.a)(aa,"AccessibilityCheckRule",
null,[]);class ja{constructor(u){this.zNa=null;this.ehf=u}get fileId(){return this.ehf?this.ehf():null}initialize(u){this.zNa=u}k8g(u){this.zNa.V3d(u)}}Object(r.a)(ja,"AAccessibilityCheckService",null,[816,107]);var I=d(18),sa=d(110);class ka extends sa.a{constructor(){super()}pl(){return 56}}Object(r.a)(ka,"AccCheckRequest",sa.a,[]);var Ma=d(245);class Ea extends ja{constructor(u,P){super(null);this.ai=u;this.LYa=P}xdl(){const u=new Ma.a(new ka,Object(z.a)(this,this.Xzk,"onAccCheckSucceed"),Object(z.a)(this,
this.Wzk,"onAccCheckFailed"));this.ai.Hb(u)}dispose(){}get SRj(){return 0<this.LYa.XZb.length}Xzk(u){if(u&&u.ACResult&&(u=this.bri(u.ACResult))){this.k8g(u);L.a.J(19227935,334,50,"Acc-check succeeded");return}this.B2g("Succeeded but response is invalid")}Wzk(u){this.B2g(u.toString());return!0}B2g(u){L.a.J(19227937,334,50,String.format("Acc-check failed: {0}",u));u=new Z;u.IsSuccess=!1;this.k8g(u)}bri(u){if(u){var P=null;try{P=JSON.parse(u)}catch(la){return L.a.J(19227939,334,10,"Cannot parse acc-check result json: {0}",
la.toString()),null}if(P){u=new Z;u.IsSuccess=!0;u.IsPartialResult=P.isPartialResultField;u.AccessibilityRules={};if(P.violatedRulesField){const la=new I.a;for(const Ba of P.violatedRulesField)if(P=this.dri(Ba)){u.AccessibilityRules[P.RuleId]=P;for(const Sa of Ba.violationsField){const pb=new fa;pb.RuleId=P.RuleId;pb.ContentName=Sa.labelField;pb.ContentId=Sa;la.add(pb)}}u.Results=la.toArray()}return u}}return null}dri(u){if(!u)return null;if(u.ruleIdField>=this.LYa.XZb.length)return L.a.J(19227971,
334,10,"Rule id {0} is bigger than total rule info list count {1}",u.ruleIdField,this.LYa.XZb.length),null;const P=new aa;P.RuleId=u.ruleIdField.toString();P.RuleName=this.LYa.XZb[u.ruleIdField].ruleTextField;switch(this.LYa.XZb[u.ruleIdField].ruleTypeField){case 0:P.Category=0;break;case 1:P.Category=1;break;case 2:P.Category=2;break;case 3:P.Category=3}return P}}Object(r.a)(Ea,"PptAccCheckService",ja,[815,816,107]);class ma{get sHi(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get tHi(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get uHi(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get rKk(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get Dkd(){return CommonUIStrings.l_AccCheckerPaneTitle}get cNk(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}
Object(r.a)(ma,"AccessibilityCheckStringsProvider",null,[1393]);class va{constructor(){this.Osh=this.contentId=null}}Object(r.a)(va,"ResultIds",null,[]);var Ca=d(67),oa=d(177);class Da{constructor(u,P){this._element=null;this.xq=P;this.Wg=u}get element(){this._element||(this._element=this.E0d(),this.Gt());return this._element}ylb(u){this._element=u}dispose(){this.element&&(this.Vpa(),this.ylb(null))}Gt(){this.xq&&this.Wg?(this.xq.rb(Ca.a.click,this.element,Object(z.a)(this,this.onClick,"onClick")),
this.Wg.rb(Ca.a.Bf,this.element,Object(z.a)(this,this.g$g,"onKeyPress"))):n.ULS.shipAssertTag(19789026,334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}Vpa(){this.xq&&this.Wg&&(this.xq.Bb(Ca.a.click,this.element,Object(z.a)(this,this.onClick,"onClick")),this.Wg.Bb(Ca.a.Bf,this.element,Object(z.a)(this,this.g$g,"onKeyPress")))}onClick(){this.c$g();return!0}g$g(u){return this.VYj(u.mc.keyCode)?(this.c$g(),!0):!1}VYj(u){return u===
oa.a.sRb||u===oa.a.Dp}}Object(r.a)(Da,"AInteractivePaneElement",null,[1412,107]);const ta=(u,P,la)=>{u=document.createElement(u);P&&(u.id=P);la&&(u.className=la);u.setAttribute("Unselectable","on");return u};var ha=d(78),Ha=d(139),bb=d(99);class Na extends Da{constructor(u,P,la){super(u,P);this.v3h=la}hide(){this.element.removeAttribute(Ha.a.hf);Ha.a.bS(this.element,Ha.a.HI,Ha.a.lB);this.element.style.display="none"}show(){Ha.a.bS(this.element,Ha.a.HI,Ha.a.pja);Ha.a.bS(this.element,Ha.a.hf,Ha.a.nVd);
this.element.style.display="block"}E0d(){const u=ta("div",this.i6g,"AccCheckerNotification");Ha.a.bS(u,Ha.a.oVd,Ha.a.lB);Ha.a.bS(u,Ha.a.e_,this.aKe);u.tabIndex=0;const P=ta("span",this.h6g,"AccCheckerNotificationIcon");var la=ha.createClusteredImage(16,16,"Info_16x16x32","",!0,"");P.appendChild(la);la=ta("span",this.aKe,"AccCheckerNotificationText");bb.a.Mz(la,this.j6g);u.appendChild(P);u.appendChild(la);return u}c$g(){this.v3h()}}Object(r.a)(Na,"APopupNotification",Da,[1462,1412,107]);class Ia extends Na{constructor(u,
P,la,Ba){super(u,P,la);this.Aca=Ba}get i6g(){return"AccCheckerOutOfSyncNotificationId"}get h6g(){return"AccCheckerOutOfSyncNotificationIconId"}get aKe(){return"AccCheckerOutOfSyncNotificationTextId"}get j6g(){return this.Aca.rKk}}Object(r.a)(Ia,"OutOfSyncNotification",Na,[]);class Qa extends Na{constructor(u,P,la,Ba){super(u,P,la);this.Aca=Ba}get i6g(){return"AccCheckerPartialResultNotificationId"}get h6g(){return"AccCheckerPartialResultNotificationIconId"}get aKe(){return"AccCheckerPartialResultNotificationTextId"}get j6g(){return this.Aca.cNk}}
Object(r.a)(Qa,"PartialResultNotification",Na,[]);var qa=d(120),Wa=d(107);class Hb{constructor(u,P,la,Ba=null,Sa=null,pb=null,Vb=null){this.urf=this.W7=this.Wg=this.zNa=null;this.Xcb=Ba;this.xq=u;this.Pd=P;this.NK=la;this.Aca=Vb||new ma;this.sLd=Sa||new Ia(this.Xcb,this.xq,Object(z.a)(this,this.vUi,"dimissOutOfSyncNotification"),this.Aca);this.ILd=pb||new Qa(this.Xcb,this.xq,Object(z.a)(this,this.wUi,"dimissPartialResultNotification"),this.Aca)}show(){}hide(){}get Xcb(){return this.Wg||(this.Wg=v.AFrameworkApplication.Aa.zG)}set Xcb(u){this.Wg=
u}IOf(){}Iq(){}dispose(){}qMh(){}fsd(){}ARj(u){var P=this.urf[u];u=P.contentId;if((P=P.Osh+"")&&P.length){const la=[];Array.add(la,Object.assign(new M.a,{name:"RuleID",string:P}));B.a.sendTelemetryEvent(Object.assign(new N.a,{name:String.format("{0}.{1}",Hb.w5e,"ViolationSelected"),dataFields:la}))}this.uxk(u)}uxk(u){u&&this.zNa.Qkl(u)||(this.Pd.XU(qa.AFrame.fW,!1),this.mvl())}vUi(){this.oCh(!1);this.fsd()}wUi(){this.qCh(!1);this.fsd()}mvl(){const u=Object.assign(new Wa.StandardDialog(!0),{Ir:v.AFrameworkApplication.rea,
Ad:1,T1a:!1});u.dza(1);u.Oe(1,this.Aca.sHi);u.Oe(0,CommonUIStrings.l_DialogCancel);u.sP(this.Aca.uHi,this.Aca.tHi,P=>{1===P&&this.Zle()})}Lsi(u){let P=null;if(u.Results&&0<u.Results.length){P={};let la=0;for(const Ba of u.Results)Ba.ResultId=Hb.aai+ ++la,u=new va,u.contentId=Ba.ContentId,u.Osh=Ba.RuleId,P[Ba.ResultId]=u}return P}Uck(){B.a.addNamespaceMapping(Hb.w5e,Hb.LEl);B.a.sendTelemetryEvent(Object.assign(new N.a,{name:String.format("{0}.{1}",Hb.w5e,"ShowTaskpane")}))}}Hb.aai="AccCheckResult";
Hb.w5e="Office.UX.AccChecker";Hb.LEl="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";Object(r.a)(Hb,"BaseAccessibilityCheckPane",null,[789,107]);class jc{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(r.a)(jc,"AccCheckerTaskPaneProps",null,[]);
var gc=d(1200),$b=d(279);class wb{constructor(){this.Uyc=new I.a}$Ka(u){this.Uyc.add(u)}jnl(u){for(let P of this.Uyc)P(u)}}Object(r.a)(wb,"ReactTaskPaneManager",null,[1414]);var Db=d(656),Xb=d(141);class ab extends Hb{constructor(u,P,la,Ba,Sa=null,pb=null,Vb,Bc=null,Yc=null){super(P,la,Ba,pb,void 0,void 0,Bc);this.Paf=null;this.Iqf=this.HLd=this.yEc=this.XFc=this.JFc=!1;this.RQd=null;this.LPd=!!v.AFrameworkApplication.Aa&&!!v.AFrameworkApplication.Aa.ob&&v.AFrameworkApplication.Aa.ob.oqe;this.nUb=
this.hqa=null;this.NUb=0;this.CBc=null;this.bBd=Sa;Yc&&(this.hqa=Yc.nai,this.nUb=Yc.R5i,this.NUb=Yc.wIj);this.ira=new wb}get isVisible(){return this.Iqf}jOb(u){this.Iqf=u}V3d(u){u&&(this.Paf=u,u.IsSuccess&&(this.urf=this.Lsi(u),u.IsPartialResult&&this.qCh(!0)),this.JFc=!0,this.XFc=!1,this.Ywc())}oCh(u){this.isVisible&&u!==this.yEc&&(this.yEc=u,this.Ywc())}qCh(u){this.HLd=u;this.Ywc()}hl(){this.XFc||Xb.UISurfaces.Gq().then(u=>{$b.a.instance.f3(ab.s3a+":PaneOpen:Start");u.showTaskPane(ab.s3a,this.pda());
this.Zle();return null});this.isVisible?Xb.UISurfaces.Gq().then(u=>{u.setSelectedTaskPane(ab.s3a);return null}):this.Uck()}Ywc(){Xb.UISurfaces.Gq().then(u=>{u.updateTaskPane(ab.s3a,this.pda());return null})}pda(){var u=new jc;this.ira.jnl(u);u=Object.assign(new Db.a,{title:this.Aca.Dkd,hideHeader:!1,width:320,location:2,contentProps:u,onOpen:()=>{this.Tkl();this.jOb(!0);v.AFrameworkApplication.Aa.updateCommandUI()},onClose:()=>{this.lsd();this.jOb(!1);this.XFc=this.JFc=!1;this.Ywc();v.AFrameworkApplication.Aa.updateCommandUI()},
isModernPane:!0});this.LPd&&(u.enableResize=!0,u.minResizeWidth=268,u.maxResizeWidth=920);return u}initialize(u){const P=this.Pd.Fc(ab.s3a);P.parent=qa.AFrame.Xi;P.uJ=!0;this.zNa=u;this.Cai()}dispose(){this.qMh();this.sLd&&(this.sLd.dispose(),this.sLd=null);this.ILd&&(this.ILd.dispose(),this.ILd=null);super.dispose()}Cai(){this.ira.$Ka(this.onRecheckExecute());this.ira.$Ka(this.w$i());this.ira.$Ka(this.Ipj());this.ira.$Ka(this.onInvokeNavigateExecute());this.ira.$Ka(this.mij());this.ira.$Ka(this.anj());
this.ira.$Ka(this.Dnj());this.ira.$Ka(this.updateLastScanTime());this.ira.$Ka(this.showHelpPane())}onRecheckExecute(){return u=>{u.onRecheckExecute=()=>{this.Zle()}}}w$i(){return u=>{u.accessibilityCheckResultCollection=this.Paf}}Ipj(){return u=>{u.resultsReady=this.JFc}}onInvokeNavigateExecute(){return u=>{u.onInvokeNavigateExecute=P=>{this.ARj(P)}}}mij(){return u=>{u.helpLink=this.s1i}}anj(){return u=>{u.outOfSync=this.yEc}}Dnj(){return u=>{u.partialResult=this.HLd}}updateLastScanTime(){return u=>
{u.updateLastScanTime=P=>{this.RQd=P}}}showHelpPane(){return u=>{u.showHelpPane=()=>{v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WordHelpPaneFix")?v.AFrameworkApplication.ata||this.RCf()?this.CBc?this.CBc():this.hqa.value&&this.nUb&&this.NUb&&this.hqa.value.Ka(this.NUb,2,this.nUb):this.YCh():this.RCf()?this.CBc?this.CBc():this.hqa.value&&this.nUb&&this.NUb&&this.hqa.value.Ka(this.NUb,2,this.nUb):this.YCh()}}}RCf(){return!this.bBd||
!this.bBd.value}YCh(){const u=this.bBd.value;if(u){var P={};P.query=ab.m5h+ab.TFd;P=Object.assign(new gc.a,{nonPersistedSettings:P});u.Oga(ab.SFd,P)}}Zle(){this.HLd=this.yEc=this.JFc=!1;this.RQd&&this.RQd();this.Ywc();this.XFc=!0;this.zNa.iLe()}Tkl(){this.Pd.vf(ab.s3a)}lsd(){this.nqe()&&this.Pd.vf(this.Pd.G8)}nqe(){return!!this.Pd.Ee&&this.Pd.Ee.name===ab.s3a}}ab.s3a="AccessibilityCheckerPane";ab.TFd="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";ab.SFd="FA000000012";ab.m5h="AssetID=";Object(r.a)(ab,"ReactAccessibilityCheckPane",
Hb,[]);class Ab{constructor(u,P,la){this.nai=u;this.R5i=P;this.wIj=la}}Object(r.a)(Ab,"HelpPaneProperties",null,[]);var rc=d(97),tb=d(30);class Za extends ab{constructor(u,P,la,Ba,Sa,pb,Vb,Bc){super(null,P,la,Ba,void 0,null,void 0,void 0,new Ab(Vb,Za.X$d(),tb.a.Oga));this.Sic=u;this.eek=Sa;this.vD=pb;this.Hhc=Vb;this.uu=Bc}get isVisible(){return!!this.Sic&&this.Sic.isVisible}jOb(u){this.Sic&&(this.Sic.isVisible=u)}get s1i(){return this.eek}hl(){this.jOb(!0);this.vD.qK(this.Sic,!0,ResourceStrings.l_AccessibilityCheckerTaskPaneToolTip,
qa.AFrame.fW);super.hl();if(this.Hhc){var u=this.Hhc.value;if(u){u.processAction(tb.a.dIc,1);u=!1;try{this.uu.selectRibbonTabById("AccessibleAuthoring"),u=!0}catch(P){L.a.J(544736533,822,10,"PptReactAccCheckControl: can't select ribbon tab AccessibleAuthoring: {0}",P.toString())}rc.a("AccessibleAuthoringTab",u)}else L.a.J(544286875,822,10,"PptReactAccCheckControl: can't get IActionManagerExtended to show AccessibleAuthoring Ribbon Tab")}else L.a.J(544265629,822,10,"PptReactAccCheckControl: can't get Lazy<IActionManagerExtended> to show AccessibleAuthoring Ribbon Tab")}Hid(){}onBeforeLoadContent(){}onAfterLoadContent(){this.zNa&&
this.zNa.RMe()}onAfterFirstSaveContent(){}static X$d(){const u={};u.ZA=ResourceStrings.L_Help;u.assetId="FA000000012";u.nonPersistedSettings={query:"AssetID=a16f6de0-2f39-4a2b-8bd8-5ad801426c7f"};return u}}Object(r.a)(Za,"PptReactAccCheckControl",ab,[814]);class fb{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Accessibility"}Yb(u){this.K=u;this.K.register(Ea,"PowerPointWebEditor.Accessibility.PptAccCheckService").as("PowerPointWebEditor.Accessibility.IPptAccCheckService").as("Common.App.AccessibilityChecker.IAccessibilityCheckService").ma().oa(()=>
new Ea(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager")));this.K.register(789,"Common.App.AccessibilityChecker.IAccessibilityCheckPane").ma().oa(()=>new Za(this.K.resolve("PowerPointWebEditor.View.IAccCheckPane"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("Common.IFocusManager"),this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointAccCheckHelpUrl,this.K.resolve("PowerPointWebEditor.ITaskPaneManager"),
this.K.oe("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IRibbonUser")));this.K.register(181,"Common.App.AccessibilityChecker.IAccessibilityCheckManager").ma().oa(()=>new da(this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader")))}init(){}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEnableAccCheck&&(this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService").dispose(),this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane").dispose(),
this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager").dispose())}static main(){m.a.instance.Ac(new fb)}}Object(r.a)(fb,"PptAccessibilityPackage",null,[2,3]);var ac=d(182),Dc=d(1249),Sc=d(249),xb=d(183),Ta=d(542),ib=d(52),ob=d(125);class fc{constructor(u,P,la,Ba,Sa,pb,Vb,Bc,Yc){this.ia=u;this.la=P;this.fek=la;this.gek=Ba;this.sdb=Sa;this.uu=Vb;this.LYa=pb;this.Fa=Bc;this.oc=Yc;this.LYa.Vfi(Object(z.a)(this,this.hmh,"refreshAccCheckButtonStatus"))}vb(){this.la.powerPointEnableAccCheck&&
(this.ia.ra(tb.a.DPe,ib.a.application,Object(z.a)(this,this.wyi,"checkAccessibility"),4),this.ia.ra(tb.a.kWk,ib.a.application,Object(z.a)(this,this.GVk,"queryCheckAccessibility"),97))}pe(){this.la.powerPointEnableAccCheck&&this.Fa.Fc(ob.a.mGf).bindAction(xb.KeyInputManager.Qa(oa.a.Vxc,xb.KeyInputManager.Re|1),tb.a.DPe)}wyi(u,P,la,Ba,Sa){return 1===la?this.oc.Cj()?this.gek.SRj?32:8:8:this.fek.hl(u,P,la,Ba,Sa)}GVk(u,P,la,Ba,Sa){Sa[Ta.a.On]=this.sdb.isVisible;return 32}dispose(){this.LYa.E7k(Object(z.a)(this,
this.hmh,"refreshAccCheckButtonStatus"))}hmh(){this.uu.PA()}}Object(r.a)(fc,"AccCheckActor",null,[251,107]);class Jb{constructor(){this.Jdc=this.K=null}get name(){return"PowerPointWebEditor.LazyActors"}Yb(u){this.K=u}init(){this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").tAb(()=>{this.aAb()})}aAb(){const u=this.K.resolve("Common.AFrameworkApplication").dT.rd,P=this.K.resolve("Common.IActionManagerExtended");u.powerPointEnableAccCheck&&(this.Jdc=new fc(P,u,this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager"),
this.K.resolve("PowerPointWebEditor.Accessibility.IPptAccCheckService"),this.K.resolve("PowerPointWebEditor.View.IAccCheckPane"),this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager"),this.K.resolve("PowerPointWebEditor.IRibbonUser"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader")),this.Jdc.vb(),this.Jdc.pe());u.Wre&&ac.a.get_instance().Mj(7,Object(z.a)(this,this.Wre,"loadInternalSlice"))}Wre(){const u=Dc.a.create("pptedit.internal",
null,()=>d.e(18).then(d.bind(null,1301)));Sc.a.oy(u)}dispose(){this.Jdc&&this.Jdc.dispose()}static main(){m.a.instance.Ac(new Jb)}}Object(r.a)(Jb,"PptLazyActorsPackage",null,[2,3]);var xc=d(215),ic=d(589),nc=d(1252),Wb=d(181),wc=d(165),nb=d(58),Rb=d(49),mb=d(68),Ub=d(137),zc=d(636);class Pc extends zc.a{constructor(){super();this.qe=this.createElement(mb.a.b6e)}Vol(u){this.va.textContent=u}appendChild(u){if(!u.va||!this.va)throw Error.argumentNull();this.va.appendChild(u.va)}}Object(r.a)(Pc,"HTMLText",
zc.a,[]);var Mc=d(333),ld=d(190);class vb{constructor(u,P,la,Ba,Sa,pb,Vb,Bc){this.od=1;this.mFe=null;this.BR=new Wb.a;this.Vr=new Wb.a;this.km=null;this.Sn=!1;this.Dma=null;this.qgc="";this.hM=this.IA=!1;this.W$=this.uXa=this.Cma=this.nHa=this.zDb=this.Yea=null;this.oWa=!1;this.ua=u;this.wb=P;this.ke=la;this.la=Ba;this.ia=Sa;this.Rc=pb;this.kb=Vb;this.wD=Bc}wCh(u){this.Yea&&this.W$&&(this.IA=!0,this.W$.appendChild(this.Yea.va),this.kb.fE(Object(z.a)(this,this.onSelectionChange,"onSelectionChange")),
this.Dma=new O.a(3,1,this.la.jud,Object(z.a)(this,this.dismissImageDescriptionBarTask,"dismissImageDescriptionBarTask"),90,"19"),this.Xwc(u))}HNh(u){this.ua===u&&this.IA&&this.Xwc(this.ua.get_alt())}xm(u){this.W$=u.va;this.C0d()}iC(u){if(this.IA&&!this.Sn)switch(u){case 1:u=this.ke.qk("formatpainterobject.cur");this.nHa.Al(Rb.a.QN(u,mb.a.nmb));break;case 0:this.nHa.Al(mb.a.nmb)}}Mp(){return null}KL(){return!1}Xw(u){this.Sn=u}dispose(){this.hka();this.Yea&&(this.uXa=this.Cma=this.zDb=this.nHa=this.Yea=
null)}my(){}aD(){return null}QA(){return[]}draw(){this.IA&&this.snb(!0)}get visible(){return this.hM}set visible(u){this.IA&&(this.hM!==u&&(this.hM=u,this.Yea.setVisibility(this.hM)),this.hM||this.hka())}setPosition(){}Ij(u){this.od=u;this.IA&&(this.yKa(),this.INh())}vq(u){this.BR=u;this.IA&&this.yKa()}Eu(u){this.Vr=u;this.IA&&this.yKa()}setZIndex(u){this.IA&&this.Yea.jC(u)}JD(u,P){this.IA&&(this.snb(!u&&P||!P),u||this.wb.E1(this.Dma,this.la.jud))}setSelection(){}C0d(){this.Yea=new Ub.a;this.nHa=
new Mc.a;this.nHa.npa("ImageDescriptionBarBackground");this.Rc.rb(Ca.a.click,this.nHa.va,Object(z.a)(this,this.gMe,"onImageDescriptonBarClickHandler"));this.zDb=new ld.a;this.zDb.appendChild(this.nHa);this.Cma=new Pc;this.Cma.Dr("ImageDescriptionBarText");this.INh();this.uXa=new Ub.a;this.uXa.Dr("ImageDescriptionBarTextWrappingDiv");this.uXa.appendChild(this.Cma);this.Yea.appendChild(this.zDb);this.Yea.appendChild(this.uXa)}Xwc(u){const P=u.indexOf("\n");this.qgc=-1===P?u:u.substring(0,P);this.Cma.Vol(ResourceStrings.L_ShapeAltText+
": "+this.qgc);this.snb(!0)}snb(u){this.km=this.ua.Jn;this.hM=u;this.yKa();this.Yea.setVisibility(this.hM);this.oWa||(this.oWa=!0,this.wb.Hb(this.Dma))}INh(){this.Cma.va.style.fontSize=this.wD.Pja(29)}gMe(){this.ia.processAction(tb.a.fsa,2);return!0}onSelectionChange(){this.hka()}dismissImageDescriptionBarTask(){this.hka()}hka(){this.IA&&(this.hM=this.IA=!1,this.kb.Xoa(Object(z.a)(this,this.onSelectionChange,"onSelectionChange")),this.oWa&&(this.wb.Lg(this.Dma),this.oWa=!1),this.W$&&this.W$.contains(this.Yea.va)&&
this.W$.removeChild(this.Yea.va))}yKa(){if(this.IA&&this.km){var u=this.km.copy();this.BR.ll(u);this.Vr.ll(u);this.mFe=ic.a.XM(nb.a.JF(u.ga(0),u.ga(1)));var P=u.Tj(new wc.a(6)),la=u.Tj(new wc.a(4));u=u.Tj(new wc.a(2));u=nb.a.Ql(la,u)*this.od;la=nb.a.Ql(P,la)*this.od;if(60>la||80>u)this.hM=!1;else{u=this.W$.children[0].style;this.zDb.setPosition(this.HQb(u.left),this.HQb(u.top));this.zDb.ah(this.HQb(u.width),this.HQb(u.height));var Ba=this.wD.Ne(nc.a.gf(40,1),1);this.uXa.setPosition(P.x*this.od,P.y*
this.od-Ba);this.uXa.ah(la,Ba);this.uXa.va.style.transform=this.qSa(this.mFe);this.Cma.ah(la-9,Ba-6);var Sa=new Wb.a;Sa.e8(this.mFe,new nb.a(0,Ba));Sa.FC(P.x*this.od-this.HQb(u.left),P.y*this.od-this.HQb(u.top)-Ba);this.nHa.fF(Sa,1);this.nHa.ah(la,Ba)}}}HQb(u){u=parseFloat(u);return isNaN(u)?0:u}qSa(u){return"rotate("+u.toString()+"deg)"}}Object(r.a)(vb,"ImageDescriptionBarView",null,[817,239,240,107]);var cc=d(251),Hc=d(69),Pb=d(167);class Uc{constructor(u,P,la,Ba,Sa,pb,Vb){this.od=1;this.BR=new Wb.a;
this.Vr=new Wb.a;this.Sn=!1;this.qgc="";this.YAe=this.ZAe=this.i5=this.hM=this.IA=!1;this.mOf=()=>{this.i5||this.ZAe||(this.Dma||(this.Dma=new O.a(3,1,this.la.jud,this.dismissImageDescriptionBarTask,90,"19")),this.i5=!0,this.wb.Hb(this.Dma))};this.oSf=()=>{this.i5&&(this.i5=!1,this.wb.Lg(this.Dma),this.Dma=void 0)};this.fFk=()=>{this.ZAe=!0;this.oSf();return!0};this.gFk=()=>{this.ZAe=!1;this.mOf();return!0};this.gMe=Bc=>this.X8g(Bc);this.OAk=()=>{this.ia.processAction(tb.a.oKc,2);this.hka();return!0};
this.X8g=()=>{this.ia.processAction(tb.a.NQc,2);this.hka();return!0};this.onSelectionChange=()=>{this.hka()};this.dismissImageDescriptionBarTask=()=>{this.hka()};if(!u)throw Error.argumentNull("shapeNode");if(!P)throw Error.argumentNull("taskManager");if(!Ba)throw Error.argumentNull("appSettings");if(!pb)throw Error.argumentNull("clickInputManager");if(!Vb)throw Error.argumentNull("pptSelectionManager");this.ua=u;this.wb=P;this.ke=la;this.la=Ba;this.ia=Sa;this.Rc=pb;this.kb=Vb}C0d(){this.rA=Rb.a.$d();
this.rA.className="ImageDescriptionBarNew";this.Rc.rb(Ca.a.click,this.rA,this.gMe);cc.a.instance.rb(Ca.a.Sfa,this.rA,this.fFk);cc.a.instance.rb(Ca.a.Tfa,this.rA,this.gFk);this.Cma=Rb.a.Il();this.aeb=document.createElement(Rb.a.gLc);this.aeb.className="ImageDescriptionBarNewButton";this.aeb.appendChild(e("M 768 1660 l -666 -666 l 73 -72 l 593 593 l 1105 -1105 l 73 72 z",20,20).va);var u=Rb.a.Il();u.innerText=ResourceStrings.L_ImageDescriptionBarApprove;this.aeb.appendChild(u);this.Rc.rb(Ca.a.click,
this.aeb,this.OAk);this.bfc=document.createElement(Rb.a.gLc);this.bfc.className="ImageDescriptionBarNewButton";this.bfc.appendChild(e("M 1879 169 q 39 39 59 88 q 20 50 20 102 q 0 51 -20 100 q -20 50 -59 89 l -1221 1215 l -556 183 l 195 -574 l 1203 -1203 q 38 -38 86 -57 q 48 -19 99 -19 h 4 q 53 0 103 19 q 49 19 87 57 m -1440 1206 q 85 26 147 87 q 61 62 87 147 l 995 -995 l -234 -234 m -1194 1428 l 345 -127 q -6 -43 -24 -80 q -19 -37 -48 -66 q -29 -29 -66 -48 q -37 -18 -80 -24 m 1440 -987 q 24 -24 37 -55 q 12 -30 12 -62 q 0 -33 -13 -63 q -13 -30 -35 -53 q -23 -22 -53 -36 q -31 -13 -66 -13 q -32 0 -63 12 q -31 12 -54 35 l -66 66 l 235 235 z",
20,20).va);u=Rb.a.Il();u.innerText=ResourceStrings.L_ImageDescriptionBarEdit;this.bfc.appendChild(u);this.Rc.rb(Ca.a.click,this.aeb,this.X8g);this.rA.appendChild(this.Cma);this.rA.appendChild(this.aeb);this.rA.appendChild(this.bfc)}Xwc(u){const P=u.indexOf("\n");this.qgc=-1===P?u:u.substring(0,P);this.Cma.innerText=ResourceStrings.L_ImageDescriptionBarFormatString.replace("{0}",this.qgc);this.snb(!0)}snb(u){this.km=this.ua.Jn;this.hM=u;this.yKa();this.rA.style.display=this.hM?Hc.a.nba:Hc.a.Pe;this.mOf()}hka(){if(this.IA){this.hM=
this.IA=!1;this.kb.Xoa(this.onSelectionChange);this.oSf();this.W$&&this.W$.contains(this.rA)&&this.W$.removeChild(this.rA);const u=Date.now()-this.Lqk,P=new M.a;P.name="IsMisaligned";P.int64=this.YAe?1:0;rc.a("AltTextBar",!0,u,[P])}}yKa(){if(this.IA&&this.km){var u=this.km.copy();this.BR.ll(u);this.Vr.ll(u);var P=ic.a.XM(nb.a.JF(u.ga(0),u.ga(1))),la=u.Tj(new wc.a(6)),Ba=u.Tj(new wc.a(4));u=u.Tj(new wc.a(2));u=nb.a.Ql(Ba,u)*this.od;la=nb.a.Ql(la,Ba)*this.od;this.rA.style.position=Hc.a.oba;if(45<=P&&
135>P||225<=P&&315>P){if(150>u||70>la){this.hM=!1;return}this.rA.style.marginLeft=(.5*(la-u)).toString()+"px";this.rA.style.marginTop=(.5*(la+u)-this.rA.offsetHeight).toString()+"px";this.rA.style.width=u.toString()+"px"}else{if(150>la||70>u){this.hM=!1;return}this.rA.style.marginLeft="0";this.rA.style.marginTop=(u-this.rA.offsetHeight).toString()+"px";this.rA.style.width=la.toString()+"px"}this.YAe=0!=P%90}}wCh(u){this.Lqk=Date.now();this.rA&&this.W$&&(this.IA=!0,this.YAe=!1,this.W$.appendChild(this.rA),
this.kb.fE(this.onSelectionChange),this.Xwc(u))}HNh(u){this.ua===u&&this.IA&&this.Xwc(this.ua.OAf)}get visible(){return this.hM}set visible(u){this.IA&&(this.hM!==u&&(this.hM=u,this.rA.style.display=this.hM?Hc.a.nba:Hc.a.Pe),this.hM||this.hka())}xm(u){this.W$=u.va;this.C0d()}setPosition(){}Ij(u){this.od=u;this.IA&&this.yKa()}vq(u){this.BR=u;this.IA&&this.yKa()}Eu(u){this.Vr=u;this.IA&&this.yKa()}setZIndex(u){this.IA&&(this.rA.style.zIndex=u.toString())}iC(u){if(this.IA&&!this.Sn)switch(u){case 1:this.ke&&
(u=this.ke.qk("formatpainterobject.cur"),this.rA.style.cursor=Rb.a.QN(u,mb.a.nmb));break;case 0:this.rA.style.cursor=mb.a.nmb}}aD(){return null}my(){}JD(u,P){this.IA&&(this.snb(!u&&P||!P),!u&&this.Dma&&this.wb.E1(this.Dma,this.la.jud))}Mp(){return null}KL(){return!1}Xw(u){this.Sn=u}setSelection(){}QA(){return[]}draw(){this.IA&&this.snb(!0)}dispose(){this.hka();this.rA&&(this.bfc=this.aeb=this.Cma=this.rA=void 0)}}Object(r.a)(Uc,"ImageDescriptionBarViewNew",null,[817,239,240,107]);var sc=d(1050),lb=
d(47),Zb=d(39);class Oc{constructor(u,P,la,Ba){this.shapeNode=u;this.mSc=P;this.u0j=la;this.imageDescription=Ba}}Object(r.a)(Oc,"ImageDescriptionCache",null,[]);var md=d(221);class Ib{constructor(u,P,la,Ba,Sa,pb,Vb,Bc,Yc,gd,Td,Re){this.p$=new sc.a;this.pSj=Uf=>{[Uf]=h(Uf);return Uf};this.Gb=u;this.ai=P;this.Vq=Vb;this.Lva=la;this.kb=Ba;this.D0=pb;this.AHa=Sa;this.Pr=Bc;this.Eb=Yc;this.$b=gd;this.e9c=Td;this.ima=Re}initialize(){this.Pr.fk(Object(z.a)(this,this.$g,"onPropertyChanged"));this.Vq.vzf(Object(z.a)(this,
this.jJb,"onShapeImageFirstDraw"));this.Vq.Lgi(Object(z.a)(this,this.u$g,"onLocalImageViewDismissed"));this.Lva.Ggi(Object(z.a)(this,this.T9g,"onImageDescriptionReady"))}dispose(){this.Pr.Om(Object(z.a)(this,this.$g,"onPropertyChanged"));this.Vq.CVe(Object(z.a)(this,this.jJb,"onShapeImageFirstDraw"));this.Vq.g8k(Object(z.a)(this,this.u$g,"onLocalImageViewDismissed"));this.Lva.c8k(Object(z.a)(this,this.T9g,"onImageDescriptionReady"))}$g(u,P){if((u=P.node)&&u.qj)if(P=P.property,P===Zb.a.alt){P=Object(S.a)(119,
u.qc(this.Gb.Na));const la=u.get_alt();if(!this.ima||la&&this.pSj(la))P&&P.OQ&&u.get_alt()&&this.e9c.ZI(u).HNh(u),this.AHa.LMh(u),u.get_alt()&&this.iud(u,u.get_alt())}else P===Zb.a.bD?u.bD&&(P=Object(S.a)(119,u.qc(this.Gb.Na)))&&P.OQ&&(this.e9c.ZI(u).visible=!1):P===Zb.a.Vf&&u.Vf!==md.a.TT?(P=Object(S.a)(119,u.qc(this.Gb.Na)))&&P.OQ&&!u.Lea&&this.p$.ga(u.id)&&this.p$.ga(u.id).mSc&&(this.ATa(u,P),this.p$.remove(u.id)):this.ima&&P===Zb.a.RL&&(this.e9c.ZI(u).visible=!1)}T9g(u,P){if(u=P.eYc){var la=P.confidence,
Ba=P.imageDescription,Sa=P.vXj;P=P.mSc;var pb=this.D0.Vda(u),Vb=pb?Object(S.a)(119,pb.qc(this.Gb.Na)):null;P?Vb&&Vb.OQ&&!pb.isLocal&&!pb.bD?this.ATa(pb,Vb):this.p$.add(u,new Oc(pb,!0,!0,Ba)):!Ba||!Sa&&60>la?L.a.J(509092041,815,15,"isGenerateSuggestion: {0}, confidence: {1}",Sa,la):(Ba=this.eEi(la,Ba),Sa?this.sZe(pb,Ba,!1):(L.a.J(509092040,815,50,"Image description ready for show and save"),Vb&&Vb.OQ?(L.a.J(509092039,815,50,"Show image description immediately, GraphNodeId: {0}, TimeMs: {1}",u.toString(),
(new Date).getTime()),this.iud(pb,Ba),pb.isLocal?this.p$.add(u,new Oc(pb,!1,!1,Ba)):(L.a.J(509092038,815,50,"Save image description immediately"),this.sZe(pb,Ba,!0))):this.p$.add(u,new Oc(pb,!1,!0,Ba))))}else L.a.J(509092042,815,15,"Graph node id is null")}jJb(u,P){u=P.eYc;L.a.J(509092037,815,50,"OnShapeImageFirstDraw, GraphNodeId: {0}, TimeMs: {1}",u?u.toString():"",(new Date).getTime());this.p$.Fb(u)?this.pih(u):(u=this.D0.Vda(u))&&u.get_alt()&&this.iud(u,u.get_alt())}eEi(u,P){P+=String.fromCharCode(10,
10);return P=80<=u?P+ResourceStrings.L_ImageDescriptionWithVeryHighConfidence:60<=u?P+ResourceStrings.L_ImageDescriptionWithHighConfidence:40<=u?P+ResourceStrings.L_ImageDescriptionWithMediumConfidence:20<=u?P+ResourceStrings.L_ImageDescriptionWithLowConfidence:P+ResourceStrings.L_ImageDescriptionWithVeryLowConfidence}u$g(u,P){(u=P.wzl)&&this.p$.Fb(u.id)&&this.pih(u.id)}pih(u){const P=this.p$.ga(u).shapeNode;if(P){var la=this.p$.ga(u).mSc,Ba=this.p$.ga(u).u0j,Sa=this.p$.ga(u).imageDescription;la?
(la=Object(S.a)(119,P.qc(this.Gb.Na)))&&this.ATa(P,la):(Ba&&this.iud(P,Sa),P.isLocal?L.a.J(509092035,815,15,"Try to save alt text for local picture"):this.sZe(P,Sa,!0));this.p$.remove(u)}else L.a.J(509092036,815,15,"ProcessImageDescriptionInCache, shape node has been changed")}ATa(u,P){this.ai.generateImageDescription(u.id,P.Hud,u.get_isSVGBlipFilled(),!1)}sZe(u,P,la){const Ba=Date.now();if(!la||!u.get_alt()){var Sa=this.Eb.je(la?7:15);Sa.hc(u);u.uza=la;u.set_alt(lb.a.eVa(P));Sa.dispose();la&&this.ai.forceOutbound();
u=Date.now()-Ba;rc.a("UpdateAltText",!0,u)}}iud(u,P){if(u.qj){this.$b.$c(u)&&L.a.J(509092033,815,50,"Graph node or parents blocked");var la=this.kb.Xd();la&&this.kb.mX(u)?(L.a.J(509092003,815,50,"ImageDescriptionManager::ShowImageDescriptionBar, GraphNodeId: {0}, TimeMs: {1}",u.id.toString(),(new Date).getTime()),this.e9c.ZI(u).wCh(P)):L.a.J(509092032,815,50,"Is selected shapes empty: {0}",!la)}else L.a.J(509092034,815,50,"ShapeNode.IsPicture: {0}",u.qj)}}Object(r.a)(Ib,"ImageDescriptionManager",
null,[107]);var ud=d(95),od=d(306),Ud=d(33),Ad=d(48);class be{constructor(u,P,la,Ba,Sa,pb,Vb,Bc,Yc,gd,Td,Re){this.ua=null;this.pU=0;this.s$c=!0;this.Peb=new sc.a(0);this.S1e=()=>{L.a.J(509092045,815,10,"ImageDescriptionPane.showHideAltTextPane not implemented")};this.MCf=()=>{L.a.J(509092044,815,10,"ImageDescriptionPane.approveAltTextPane not implemented")};this.H4d=()=>{L.a.J(509092043,815,10,"ImageDescriptionPane.editAltTextPane not implemented")};this.Dg=u;this.Vb=P;this.ke=la;this.Fa=gd;this.ai=
Ba;this.Rc=Sa;this.kb=pb;this.IB=Vb;this.qR=Bc;this.Eb=Yc;this.Lva=Td;this.vD=Re;this.nb=document.createElement("div");this.nb.className="ImageDescriptionPane";this.nb.id="ImageDescriptionPane";this.nb.style.position=Hc.a.oba;this.nb.setAttribute(Ha.a.hf,Ha.a.lsa);this.nb.setAttribute(Ha.a.e_,"ImageDescriptionPaneLabel");this.Rc.rb(Ca.a.click,this.nb,Object(z.a)(this,this.rsh,"rootElementClickHandler"));this.qR.addHandler(this.nb,Ca.a.Bf,Object(z.a)(this,this.Eua,"inputKeyPressHandler"));this.Ab=
!1;this.FH=Rb.a.$d();this.FH.className="ImageDescriptionPaneLayoutRoot";this.al=this.uDa("per","ClosePaneGlyph_16x16x32");Sys.UI.DomElement.addCssClass(this.al,"ImageDescriptionPaneCloseButton");this.al.setAttribute(Ha.a.hf,Ha.a.Ju);this.FH.appendChild(this.al);this.Rc.rb(Ca.a.click,this.al,Object(z.a)(this,this.eDa,"closeButtonClickHandler"));this.qR.addHandler(this.al,Ca.a.focus,Object(z.a)(this,this.RIb,"onElementFocused"));this.Oma=Rb.a.$d();this.Oma.id="ImageDescriptionPaneLabel";this.Oma.className=
"PaneLabel";this.Oma.innerText=ResourceStrings.L_ShapeAltText;this.FH.appendChild(this.Oma);this.CHa=Rb.a.$d();this.CHa.innerText=ResourceStrings.l_ImageDescriptionPaneLabel;this.CHa.className="ImageDescriptionLabel";this.FH.appendChild(this.CHa);this.BHa=Rb.a.$d();this.BHa.innerText=ResourceStrings.L_ImageDescriptionPaneHint;this.BHa.className="ImageDescriptionHint";this.FH.appendChild(this.BHa);this.Meb=Rb.a.$d();this.Hm=document.createElement("textarea");this.Hm.className="AltTextTextArea";this.Hm.setAttribute(Ha.a.er,
ResourceStrings.L_ShapeAltText);this.Hm.tabIndex=0;this.Meb.appendChild(this.Hm);this.FH.appendChild(this.Meb);this.Rc.rb(Ca.a.click,this.Hm,Object(z.a)(this,this.PAf,"altTextboxClickHandler"));this.qR.addHandler(this.Hm,Ca.a.Bf,Object(z.a)(this,this.RAf,"altTextboxTypingHandler"));this.qR.addHandler(this.Hm,Ca.a.focus,Object(z.a)(this,this.RIb,"onElementFocused"));u=Rb.a.Il();u.className="GenerateDescriptionButtonText";u.innerText=ResourceStrings.L_ImageDescriptionPaneButtonTooltip;u.setAttribute("Unselectable",
"on");this.Kw=Rb.a.kda();this.Kw.className="ImageDescriptionPaneButton cui-ctl";this.Kw.setAttribute(Ha.a.hf,Ha.a.Ju);this.Kw.tabIndex=0;this.Kw.appendChild(u);this.FH.appendChild(this.Kw);this.Rc.rb(Ca.a.click,this.Kw,Object(z.a)(this,this.P6b,"generateDescriptionClickHandler"));this.qR.addHandler(this.Kw,Ca.a.focus,Object(z.a)(this,this.RIb,"onElementFocused"));this.IB.q4(Ad.a.QQ,Ad.a.Xi,this.nb,()=>{this.RU(!0)},()=>{this.RU(!1)},!0);this.IB.q4(Ad.a.bUd,Ad.a.Xi,this.Hm,()=>{this.D9g(!0)},()=>{this.D9g(!1)},
!0);this.Lva.wzf(Object(z.a)(this,this.enc,"onShowHideAltTextPane"))}Xhe(){this.xyi()&&(this.Hm.disabled=!1,this.Hm.value=this.ua.get_alt(),this.nb.appendChild(this.FH),this.Kw.style.display=this.ua.isLocal?Hc.a.Pe:Hc.a.Rj,this.Ab=!0,this.nb.style.display=Hc.a.Rj,this.wsb(this.nb),this.vD.qK(this,this.Ab,ResourceStrings.L_ShapeAltText,Ad.a.QQ),this.kb.fE(Object(z.a)(this,this.onSelectionChange,"onSelectionChange")),L.a.J(512233536,815,50,"ImageDescriptionPane::InitializeAndShow"))}dispose(){this.tMc();
this.Lva.Toh(Object(z.a)(this,this.enc,"onShowHideAltTextPane"));this.Rc.Bb(Ca.a.click,this.nb,Object(z.a)(this,this.rsh,"rootElementClickHandler"));this.qR.removeHandler(this.nb,Ca.a.Bf,Object(z.a)(this,this.Eua,"inputKeyPressHandler"));this.Rc.Bb(Ca.a.click,this.al,Object(z.a)(this,this.eDa,"closeButtonClickHandler"));this.qR.removeHandler(this.al,Ca.a.focus,Object(z.a)(this,this.RIb,"onElementFocused"));this.Rc.Bb(Ca.a.click,this.Hm,Object(z.a)(this,this.PAf,"altTextboxClickHandler"));this.qR.removeHandler(this.Hm,
Ca.a.Bf,Object(z.a)(this,this.RAf,"altTextboxTypingHandler"));this.qR.removeHandler(this.Hm,Ca.a.focus,Object(z.a)(this,this.RIb,"onElementFocused"));this.Rc.Bb(Ca.a.click,this.Kw,Object(z.a)(this,this.P6b,"generateDescriptionClickHandler"));this.qR.removeHandler(this.Kw,Ca.a.focus,Object(z.a)(this,this.RIb,"onElementFocused"));this.Kw=this.Hm=this.Meb=this.BHa=this.CHa=this.Oma=null;L.a.J(512233507,815,50,"ImageDescriptionPane::Dispose")}LMh(u){this.ua&&u===this.ua&&this.Ab&&(this.Peb.Fb(u.id.toString())&&
this.ua.Vf!==this.Peb.ga(u.id.toString())&&L.a.J(512233506,815,50,"ImageDescriptionPane::UpdateAltTextbox - Image version have been changed after generate description"),2!==this.pU&&(this.Hm.value=this.ua.get_alt()))}layout(u,P){const la=P?u.MD(this.width):u.ND(this.width);this.Ab&&(P?(Sys.UI.DomElement.addCssClass(this.nb,"ImageDescriptionPaneRTL"),la.MD(1)):(Sys.UI.DomElement.addCssClass(this.nb,"ImageDescriptionPaneLTR"),la.ND(1)));Rb.a.O1(this.nb,la);return u}get isVisible(){return this.Ab}get va(){return this.nb}get order(){return 10}RU(u){this.Ab&&
(u?0===this.pU&&this.hxd():this.pU=0)}D9g(u){this.Ab&&(u||this.MLa(),this.Vb.updateCommandUI())}RAf(u){u.keyCode===oa.a.pZ&&u.ctrlKey?this.ILa():(2!==this.pU&&this.zwh(),this.pU=2)}Eua(u){this.Ab&&(u.keyCode===oa.a.Dp||u.keyCode===oa.a.zK?1===this.pU?this.aH():3===this.pU?this.ATa():2===this.pU&&(this.Kw.style.display=Hc.a.Rj):2===this.pU&&(this.Kw.style.display=Hc.a.Rj))}hxd(){ud.FocusManager.Zq(this.al)?(this.ILa(),this.pU=1):L.a.J(512233505,815,50,"Fail to set focus on close button")}ILa(){this.Fa.fC(Ad.a.QQ)}zwh(){this.Fa.fC(Ad.a.bUd)}xyi(){const u=
this.kb.Xd();if(!u||1<u.length||!u[0].qj)return L.a.J(512233504,815,50,"ImageDescriptionPane::CheckAndCacheShapeNode - shape node is null: {0}",!u),!1;this.ua=u[0];return!0}eDa(){this.aH();return!0}aH(){this.Ab&&(this.tMc(),this.Fa.tj(Ad.a.QQ,!1),L.a.J(512233503,815,50,"ImageDescriptionPane::CloseButtonClickHandler - Image Description pane close button clicked."))}rsh(){this.Ab&&(this.ILa(),this.pU=0);return!0}PAf(){this.zwh();this.pU=2;return!0}P6b(){this.ILa();this.ATa();return!0}ATa(){this.pU=
3;this.Kw.style.display=Hc.a.Pe;this.hxd();const u=this.ua?Object(S.a)(119,this.ua.qc(0)):null;u?(this.Peb.add(this.ua.id.toString(),this.ua.Vf),this.ai.generateImageDescription(this.ua.id,u.Hud,this.ua.get_isSVGBlipFilled(),!0)):L.a.J(512233502,815,15,"ImageDescriptionPane::GenerateDescriptionClickHandler - Is shape node null {0}",!this.ua)}enc(){this.Ab?this.tMc():(this.Xhe(),this.pU=0);this.Fa.tj(Ad.a.QQ,this.Ab);L.a.J(512233501,815,50,"ImageDescrptionPane::ShowOrHidePane {0}",!this.Ab)}UMl(u){u=
u.Xd();this.s$c&&this.MLa();1===u.length&&u[0].qj?(this.ua=u[0],this.s$c=!0,this.Hm.value=this.ua.get_alt(),this.Hm.disabled=!1,this.Kw.style.display=this.ua.isLocal?Hc.a.Pe:Hc.a.Rj):(this.Kw.style.display=Hc.a.Pe,this.Hm.disabled=!0,this.Hm.value=null,this.s$c=!1)}onSelectionChange(u){Ud.a("ChangePictureAltTextFixEnabled")?this.UMl(u):this.tMc();this.Dg.Eo(Ad.a.QQ)}RIb(u){this.Ab&&(u.target===this.al?this.pU=1:u.target===this.Hm?this.pU=2:u.target===this.Kw&&(this.pU=3))}tMc(){this.Ab&&(this.kb.Xoa(Object(z.a)(this,
this.onSelectionChange,"onSelectionChange")),this.s$c&&this.MLa(),this.Ab=!1,this.nb.removeChild(this.FH),this.nb.style.display=Hc.a.Pe,this.wsb(this.nb),this.vD.qK(this,this.Ab,ResourceStrings.L_ShapeAltText,Ad.a.QQ),L.a.J(512233500,815,50,"ImageDescriptionPane::CleanUpAndHide"))}wsb(u){v.AFrameworkApplication.isRtl?Sys.UI.DomElement.addCssClass(u,"ImageDescriptionPaneRTL"):Sys.UI.DomElement.addCssClass(u,"ImageDescriptionPaneLTR")}MLa(){const u=this.Hm.value;if(!(Ud.a("ChangePictureAltTextFixEnabled")&&
null===u||u===this.ua.get_alt())){var P=this.Eb.je(15);P.hc(this.ua);this.ua.uza=!1;this.ua.set_alt(u);P.dispose()}}uDa(u,P){return this.tDa(u,"cui-img-16by16","cui-ctl-iconContainer",P,CommonUIStrings.l_DialogClose,null)}tDa(u,P,la,Ba,Sa,pb){const Vb=Rb.a.sB();Vb.alt=Sa;Vb.className=ha.getImageClassWithCluster(u,Ba);Vb.src=this.ke.qk(u+".png");Vb.setAttribute("Unselectable","on");u=Rb.a.Il();u.className=P+" cui-img-cont-float";u.appendChild(Vb);P=Rb.a.Il();P.className=la;P.setAttribute("Unselectable",
"on");P.appendChild(u);la=Rb.a.kda();la.className="ImageDescriptionPaneNoBorderButton cui-ctl";la.title=Sa;la.setAttribute(Ha.a.hf,Ha.a.Ju);la.tabIndex=0;la.appendChild(P);pb&&(Sa=Rb.a.Il(),Sa.className="cui-ctl-mediumlabel",Sa.setAttribute("Unselectable","on"),Sa.innerText=pb,la.appendChild(Sa));return la}get width(){return this.Ab?264+od.a.Vya:0}}Object(r.a)(be,"ImageDescriptionPane",null,[788,587,107]);class uf{constructor(u,P,la,Ba,Sa,pb,Vb,Bc,Yc,gd,Td,Re,Uf,Ef,Oh,ek){this.Peb=new sc.a(0);this.$g=
(je,Qf)=>{je=Qf.node;this.Hz&&this.Hz.includes(je)&&[Zb.a.alt,Zb.a.esa,Zb.a.RL].includes(Qf.property)&&this.RZc()};this.maj=()=>{if(!this.Hz||0===this.Hz.length)return"";let je="",Qf=!0;for(let Jg of this.Hz){let Ei=Jg.OAf;if(!Qf&&Ei!==je)return"";je=Ei;Qf=!1}return je};this.Sej=()=>{if(!this.Hz||0===this.Hz.length)return[!1,!1];let je=!0,Qf=!0;for(let Jg of this.Hz)Jg.RL?Qf=!1:je=!1;return[je,!(je||Qf)]};this.RZc=()=>{if(this.Hz&&0!==this.Hz.length){this.mGg=this.n0.checked;[this.RXa,this.VX.indeterminate]=
this.Sej();this.VX.checked=this.RXa;this.VX.disabled=!1;this.Bfb.style.display=Hc.a.Rj;this.Wze=this.maj();this.Hm.value=this.RXa?ResourceStrings.L_ImageDescriptionPaneAltTextBoxDecorative:this.Wze;this.Hm.disabled=this.RXa;this.GBe=this.q3j();var je=!1;if(this.GBe){let Qf;[je,Qf]=h(this.Hm.value);je=je&&0<Qf}this.zva.style.display=je||this.n0.checked?Hc.a.Rj:Hc.a.Pe;this.Kw.style.display=!this.GBe||je||this.n0.checked?Hc.a.Pe:Hc.a.Rj;this.Kw.disabled=this.RXa;this.Yva.style.display=Hc.a.Pe}else this.Hm.value=
"",this.Hm.disabled=!0,this.Kw.style.display=Hc.a.Pe,this.Yva.style.display=Hc.a.Pe,""!==this.Kma.innerText&&(this.Kma.innerText=""),this.zMc(),this.zva.style.display=Hc.a.Pe,this.Bfb.style.display=Hc.a.Pe};this.q3j=()=>this.Hz?1===this.Hz.length&&this.Hz[0].qj&&!this.Hz[0].get_isSVGBlipFilled():!1;this.O9e=()=>{this.wsb(this.nb);this.vD&&this.vD.qK(this,this.Ab,ResourceStrings.L_ShapeAltTextNew,Ad.a.QQ)};this.fZd=()=>{0!==this.$ed&&(window.clearTimeout(this.$ed),this.$ed=0)};this.zMc=()=>{0!==this.F8c&&
(window.clearTimeout(this.F8c),this.F8c=0)};this.QAf=()=>{var je=Date.now();const Qf=this.zva.style.display===Hc.a.Rj;Qf&&(this.n0.checked=!1,this.zva.style.display=Hc.a.Pe,this.Kw.style.display=Hc.a.Rj,this.Yva.style.display=Hc.a.Pe,""!==this.Kma.innerText&&(this.Kma.innerText=""),this.zMc(),this.rnh());this.fZd();this.$ed=window.setTimeout(()=>{this.MLa()},500);if(!this.sFg){je=Date.now()-je;const Jg=new M.a;Jg.name="ApproveImplicitly";Jg.int64=Qf?1:0;rc.d(tb.a.fLl,!0,"AltTextPane",1,12,je,[Jg]);
this.sFg=!0}};this.hxd=()=>{this.ILa();ud.FocusManager.Zq(this.al)||L.a.J(509092104,815,50,"Fail to set focus on close button")};this.xwh=()=>{this.ILa();window.setTimeout(()=>{if(ud.FocusManager.Zq(this.Hm))return this.Hm.selectionStart=0,this.Hm.selectionEnd=0,!0;L.a.J(509092103,815,50,"Fail to set focus on alt text box");return!1},0)};this.ILa=()=>{this.Fa&&this.Fa.fC(Ad.a.QQ)};this.eDa=()=>{this.aH();return!0};this.rnh=()=>{const [je,Qf]=h(this.Hm.value);if(je){const Jg=this.Hm.selectionStart,
Ei=this.Hm.selectionEnd;this.Hm.value=this.Hm.value.substring(0,Qf).trimEnd();this.Hm.setSelectionRange(Jg,Ei)}};this.bVd=(je,Qf)=>{var Jg=Date.now();const Ei=!this.mGg;(this.n0.checked=Ei)?(this.j6c=this.Hm.value,this.rnh()):this.Hm.value=this.j6c;this.MLa();Qf&&(Qf=Date.now()-Jg,Jg=new M.a,Jg.name="CustomData1",Jg.int64=Ei?1:0,rc.d(tb.a.oKc,!0,"AltTextPane",je,12,Qf,[Jg]))};this.NCf=je=>{je.mc.preventDefault();je.mc.stopPropagation();this.bVd(2,!0);window.setTimeout(()=>{this.n0.checked=this.mGg},
0);return!0};this.OCf=je=>je.mc.keyCode===oa.a.Dp||je.mc.keyCode===oa.a.zK?(je.mc.preventDefault(),je.mc.stopPropagation(),this.bVd(1,!0),!0):!1;this.G2g=je=>{var Qf=Date.now();const Jg=!this.RXa;this.VX.indeterminate=!1;this.VX.checked=Jg;this.Kw.disabled=Jg;this.zva.style.display=Hc.a.Pe;(this.Hm.disabled=Jg)?(this.j6c=this.Hm.value,this.Hm.value=ResourceStrings.L_ImageDescriptionPaneAltTextBoxDecorative):this.Hm.value=this.j6c;this.MLa();Qf=Date.now()-Qf;const Ei=new M.a;Ei.name="CustomData1";
Ei.int64=Jg?1:0;rc.d(tb.a.gIe,!0,"AltTextPane",je,12,Qf,[Ei])};this.E2g=je=>{console.log("[markAsDecorativeClickHandler]",this.VX.checked);je.mc.preventDefault();je.mc.stopPropagation();this.G2g(2);window.setTimeout(()=>{this.VX.checked=this.RXa},0);return!0};this.F2g=je=>{console.log("[markAsDecorativeKeyDownHandler]",this.VX.checked);return je.mc.keyCode===oa.a.Dp||je.mc.keyCode===oa.a.zK?(je.mc.preventDefault(),je.mc.stopPropagation(),this.G2g(1),!0):!1};this.aH=()=>{if(this.Ab){var je=Date.now();
this.MYd();L.a.J(509092102,815,50,"ImageDescriptionPaneNew.closePane - Image Description pane close button clicked.");je=Date.now()-je;const Qf=new M.a;Qf.name="CustomData1";Qf.int64=0;rc.d(tb.a.fsa,!0,"AltTextPane",0,12,je,[Qf])}};this.P6b=()=>{this.ATa();return!0};this.ATa=()=>{var je=Date.now();const Qf=this.Hz[0]?this.Hz[0].qc(0):void 0;this.ai&&Qf?(this.Kw.style.display=Hc.a.Pe,this.Yva.style.display=Hc.a.nba,this.Kma.innerText=ResourceStrings.L_ImageDescriptionPaneInProgress,this.zMc(),this.F8c=
window.setTimeout(()=>{this.Yva.style.display=Hc.a.Pe;""!==this.Kma.innerText&&(this.Kma.innerText="");rc.a("GeneratingAltTextMessageTimeout")},15E3),this.hxd(),this.Peb.add(this.Hz[0].id.toString(),this.Hz[0].Vf),this.ai.generateImageDescription(this.Hz[0].id,Qf.Hud,this.Hz[0].get_isSVGBlipFilled(),!0),je=Date.now()-je,rc.d(tb.a.i9i,!0,"AltTextPane",0,12,je)):L.a.J(509092101,815,15,"ImageDescriptionPaneNew.generateDescriptionForMe - Is shape node null or undefined {0}",!this.Hz[0])};this.enc=()=>
{this.S1e()};this.TMl=je=>{je=je.Qf();this.j6c="";this.MLa();this.Hz=je;this.sFg=this.n0.checked=!1;this.RZc()};this.onSelectionChange=je=>{this.TMl(je);this.Dg&&this.Dg.Eo(Ad.a.QQ)};this.wsb=je=>{v.AFrameworkApplication.isRtl?Sys.UI.DomElement.addCssClass(je,"ImageDescriptionPaneRTL"):Sys.UI.DomElement.addCssClass(je,"ImageDescriptionPaneLTR")};this.MLa=()=>{this.fZd();if(this.Hz&&0!==this.Hz.length){var je=this.VX.checked,Qf=je?"":this.Hm.value;if(Qf!==this.Wze||je!==this.RXa){var Jg=this.Eb.je(15);
if(Jg){Jg.hc(this.kb.hk());if(je)for(let Ei of this.Hz)Ei.uza=!1,Ei.RL=!0;else for(let Ei of this.Hz)Ei.uza=!1,Ei.set_alt(Qf),Ei.set_altTitle("");Jg.dispose()}this.RXa=je;this.Wze=Qf;this.uu&&this.uu.PA()}}};this.ssh=je=>je.mc.keyCode===oa.a.mZ||je.mc.keyCode===oa.a.mNa?(je.mc.preventDefault(),je.mc.stopPropagation(),this.Fa.Bd(),!0):!1;this.T1e=je=>{const Qf=this.Ab;je?Qf?(this.O9e(),this.xwh()):this.Xhe():Qf&&this.MYd();je!==Qf&&(this.uu&&this.uu.PA(),this.N4&&this.N4.PA());L.a.J(509092099,815,
50,"ImageDescrptionPaneNew.showHideAltTextPaneInternal {0} to {1}",Qf,je)};this.Xhe=()=>{this.Fa&&this.Fa.tj(Ad.a.QQ,!0);this.Hz=this.kb.Qf();this.RZc();this.Ab=!0;this.nb.appendChild(this.FH);this.nb.style.display=Hc.a.Rj;this.O9e();this.kb.fE(this.onSelectionChange);L.a.J(509092098,815,50,"ImageDescriptionPaneNew.initializeAndShowAltTextPane");if(this.Hhc){try{var je=this.Hhc.value}catch(Qf){L.a.J(509092096,822,10,"ImageDescriptionPaneNew: can't get IActionManagerExtended to show AccessibleAuthoring Ribbon Tab: {0}",
Qf.toString());return}if(je){je.processAction(tb.a.dIc,1);je=!1;try{this.uu.selectRibbonTabById("AccessibleAuthoring"),je=!0}catch(Qf){L.a.J(509092066,822,10,"ImageDescriptionPaneNew: can't select ribbon tab AccessibleAuthoring: {0}",Qf.toString())}rc.a("AccessibleAuthoringTab",je);this.xwh()}else L.a.J(509092067,822,10,"ImageDescriptionPaneNew: can't get IActionManagerExtended to show AccessibleAuthoring Ribbon Tab")}else L.a.J(509092097,822,10,"ImageDescriptionPaneNew: can't get Lazy<IActionManagerExtended> to show AccessibleAuthoring Ribbon Tab")};
this.MYd=()=>{this.Ab&&(this.Fa&&this.Fa.tj(Ad.a.QQ,!1),this.kb.Xoa(this.onSelectionChange),this.MLa(),this.Ab=!1,this.nb.removeChild(this.FH),this.nb.style.display=Hc.a.Pe,this.O9e(),L.a.J(509092100,815,50,"ImageDescriptionPaneNew.cleanUpAndHideAltTextPane"))};this.dispose=()=>{this.MYd();this.sR&&this.sR.Bb(Ca.a.Bf,this.nb,this.ssh);this.Rc.Bb(Ca.a.click,this.al,this.eDa);this.qR.removeHandler(this.Hm,Ca.a.input,this.QAf);this.Rc.Bb(Ca.a.click,this.Kw,this.P6b);this.Rc.Bb(Ca.a.click,this.ZWa,this.NCf);
this.sR&&this.sR.Bb(Ca.a.Bf,this.n0,this.OCf);this.Rc.Bb(Ca.a.click,this.AYa,this.E2g);this.sR&&this.sR.Bb(Ca.a.Bf,this.VX,this.F2g);this.Lva.Toh(this.enc);this.Pr&&this.Pr.Om(this.$g);this.Phc=this.LCe=this.VX=this.AYa=this.Bfb=this.eec=this.Dte=this.n0=this.ZWa=this.zva=this.Yva=this.Kma=this.Kw=this.Hm=this.Meb=this.BHa=this.CHa=this.al=this.Oma=this.rgc=this.FH=this.nb=void 0;this.fZd();this.zMc();L.a.J(509092065,815,50,"ImageDescriptionPaneNew.dispose")};this.layout=(je,Qf)=>{const Jg=Qf?je.MD(this.width):
je.ND(this.width);this.Ab&&(Qf?(Sys.UI.DomElement.addCssClass(this.nb,"ImageDescriptionPaneRTL"),Jg.MD(1)):(Sys.UI.DomElement.addCssClass(this.nb,"ImageDescriptionPaneLTR"),Jg.ND(1)));Rb.a.O1(this.nb,Jg);return je};this.LMh=je=>{this.GBe&&je===this.Hz[0]&&this.Ab&&(this.Peb.Fb(je.id.toString())&&this.Hz[0].Vf!==this.Peb.ga(je.id.toString())&&L.a.J(509092064,815,50,"ImageDescriptionPaneNew.updateAltTextbox - Image version have been changed after generate description"),this.RZc())};this.S1e=()=>{this.T1e(!this.Ab)};
this.MCf=()=>{this.T1e(!0);this.n0.checked||this.bVd(0,!1)};this.H4d=()=>{this.T1e(!0)};if(!Ba)throw Error.argumentNull("clickInputManager");if(!pb)throw Error.argumentNull("selectionManager");if(!Vb)throw Error.argumentNull("focusManagerHelper");if(!Bc)throw Error.argumentNull("inputHandlerManager");if(!Yc)throw Error.argumentNull("transactionFactory");if(!Td)throw Error.argumentNull("coreExtEventSource");this.Dg=u;this.Fa=gd;this.ai=la;this.Rc=Ba;this.sR=Sa;this.kb=pb;this.IB=Vb;this.qR=Bc;this.Eb=
Yc;this.Lva=Td;this.vD=Re;this.Hhc=Uf;this.uu=Ef;this.N4=Oh;this.Pr=ek;this.Ab=!1;this.nb=Rb.a.$d();this.nb.className="ImageDescriptionPaneNew";this.nb.id="ImageDescriptionPaneNew";this.nb.style.position=Hc.a.oba;this.nb.setAttribute(Ha.a.hf,Ha.a.lsa);this.nb.setAttribute(Ha.a.e_,"ImageDescriptionPaneLabel");this.sR&&this.sR.rb(Ca.a.Bf,this.nb,this.ssh);this.FH=Rb.a.$d();this.FH.className="ImageDescriptionPaneLayoutRootNew";this.rgc=Rb.a.$d();this.rgc.className="ImageDescriptionPaneHeader";this.FH.appendChild(this.rgc);
this.Oma=Rb.a.$d();this.Oma.id="ImageDescriptionPaneLabel";this.Oma.className="ImageDescriptionPaneTitle";this.Oma.innerText=ResourceStrings.L_ShapeAltTextNew;this.rgc.appendChild(this.Oma);this.al=document.createElement(Rb.a.gLc);this.al.type="button";this.al.setAttribute(Ha.a.er,CommonUIStrings.l_DialogClose);this.al.appendChild(e("M 1581 557 l -466 467 l 466 467 l -90 90 l -467 -466 l -467 466 l -90 -90 l 466 -467 l -466 -467 l 90 -90 l 467 466 l 467 -466 z",20,20).va);this.al.className="ImageDescriptionPaneCloseButtonNew";
this.rgc.appendChild(this.al);this.Rc.rb(Ca.a.click,this.al,this.eDa);this.CHa=Rb.a.$d();this.CHa.innerText=ResourceStrings.L_ImageDescriptionPaneLabelRefresh;this.CHa.className="ImageDescriptionLabelNew";this.FH.appendChild(this.CHa);this.BHa=Rb.a.$d();this.BHa.innerText=ResourceStrings.L_ImageDescriptionPaneHint;this.BHa.className="ImageDescriptionHintNew";this.FH.appendChild(this.BHa);this.Meb=Rb.a.$d();this.Hm=document.createElement(Rb.a.dFl);this.Hm.className="AltTextTextAreaNew";this.Hm.setAttribute(Ha.a.er,
ResourceStrings.L_ShapeAltTextNew);this.Meb.appendChild(this.Hm);this.FH.appendChild(this.Meb);this.qR.addHandler(this.Hm,Ca.a.input,this.QAf);u=Rb.a.Il();u.className="GenerateDescriptionButtonText";u.innerText=ResourceStrings.L_ImageDescriptionPaneButtonTooltipNew;this.Kw=document.createElement(Rb.a.gLc);this.Kw.type="button";this.Kw.className="ImageDescriptionPaneGenerateButtonNew";this.Kw.appendChild(u);this.FH.appendChild(this.Kw);this.Rc.rb(Ca.a.click,this.Kw,this.P6b);u=e("M1039.84,0.126321c261.41,4.108,517.2,108.271,709.24,300.861c292.63,293.471,379.52,734.393,220.11,1116.953c-154.43,370.6,-510.5,615.63,-909.38,629.51l-34.61,0.55l-16.1,-0.67c-72.623,-7.38,-129.295,-68.71,-129.295,-143.29c0,-74.57,56.672,-135.9,129.295,-143.28l12.8,-0.64c0,-0.07,0,-0.13,0,-0.19c297.81,0.84,566.77,-177.91,681.33,-452.82c114.55,-274.92,52.11,-591.774,-158.18,-802.668c-210.29,-210.893,-526.96,-274.235,-802.182,-160.458c-275.227,113.778,-454.739,382.239,-454.739,680.066l-288.129,0c0,-414.442,249.801,-788.021,632.795,-946.349c131.654,-54.426,270.122,-79.727,407.045,-77.575z",
16,16).va;this.Kma=Rb.a.Il();this.Kma.setAttribute(Ha.a.hf,Ha.a.hDf);this.Kma.setAttribute(Ha.a.sKc,Ha.a.sVd);this.Yva=Rb.a.$d();this.Yva.className="ImageDescriptionPaneGeneratingMessage";this.Yva.appendChild(u);this.Yva.appendChild(this.Kma);this.FH.appendChild(this.Yva);this.zva=Rb.a.$d();this.zva.className="ImageDescriptionCheckboxContainer";this.ZWa=document.createElement(Rb.a.bug);this.ZWa.setAttribute("for","ImageDescriptionCheckboxApprove");this.ZWa.innerText=ResourceStrings.L_ApproveAltText;
this.zva.appendChild(this.ZWa);this.n0=Rb.a.wOc();this.n0.setAttribute("type","checkbox");this.n0.setAttribute(Ha.a.Rca,"ImageDescriptionTipApprove");this.n0.id="ImageDescriptionCheckboxApprove";this.ZWa.appendChild(this.n0);this.Dte=Rb.a.Il();this.Dte.className="checkmark";this.ZWa.appendChild(this.Dte);this.eec=Rb.a.$d();this.eec.className="ImageDescriptionInlineTip";this.eec.innerText=ResourceStrings.L_ApproveAltTextTip;this.eec.id="ImageDescriptionTipApprove";this.zva.appendChild(this.eec);this.FH.appendChild(this.zva);
this.Rc.rb(Ca.a.click,this.ZWa,this.NCf);this.sR&&this.sR.rb(Ca.a.Bf,this.n0,this.OCf);this.Bfb=Rb.a.$d();this.Bfb.className="ImageDescriptionCheckboxContainer";this.AYa=document.createElement(Rb.a.bug);this.AYa.setAttribute("for","ImageDescriptionCheckboxDecorative");this.AYa.innerText=ResourceStrings.L_MarkAsDecorative;this.Bfb.appendChild(this.AYa);this.VX=Rb.a.wOc();this.VX.setAttribute("type","checkbox");this.VX.setAttribute(Ha.a.Rca,"ImageDescriptionTipDecorative");this.VX.id="ImageDescriptionCheckboxDecorative";
this.AYa.appendChild(this.VX);this.LCe=Rb.a.Il();this.LCe.className="checkmark";this.AYa.appendChild(this.LCe);this.Phc=Rb.a.$d();this.Phc.className="ImageDescriptionInlineTip";this.Phc.innerText=ResourceStrings.L_MarkAsDecorativeTip;this.Phc.id="ImageDescriptionTipDecorative";this.Bfb.appendChild(this.Phc);this.FH.appendChild(this.Bfb);this.Rc.rb(Ca.a.click,this.AYa,this.E2g);this.sR&&this.sR.rb(Ca.a.Bf,this.VX,this.F2g);this.IB.q4(Ad.a.QQ,Ad.a.Xi,this.nb,()=>{},()=>{},!0);this.Lva.wzf(this.enc);
this.Pr&&this.Pr.fk(this.$g);this.F8c=this.$ed=0}get width(){return this.Ab?264+od.a.Vya:0}get va(){return this.nb}get order(){return 10}get isVisible(){return this.Ab}}Object(r.a)(uf,"ImageDescriptionPaneNew",null,[788,587,107]);var sd=d(342);class Ze{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ImageDescription"}Yb(u){this.K=u;this.K.register(191,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IImageDescriptionBarView>").ma().oa(()=>new sd.a(P=>
{let la=null;const Ba=Object(S.a)(119,P.qc(u.resolve("Box4.IPageView").Na));Ba&&!Ba.Nl&&(la=this.K.resolve("PowerPointWebEditor.IApplicationSettings").j3?new Uc(P,this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager")):new vb(P,this.K.resolve("Common.ITaskManager"),
this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IPageView").Md),la.xm(Ba.hV),Ba.Yra(la,4));return la}));this.K.register(788,"PowerPointWebEditor.IImageDescriptionPane").ma().oa(()=>this.K.resolve("PowerPointWebEditor.IApplicationSettings").j3?new uf(this.K.resolve("Common.IF6Manager"),
this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("Common.IKeyInputManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventSource"),
this.K.resolve("PowerPointWebEditor.ITaskPaneManager"),this.K.oe("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IRibbonUser"),this.K.resolve("PowerPointWebEditor.IContextMenuUser"),this.K.resolve("Box4.Graph.IGraphInstance").yd(10)):new be(this.K.resolve("Common.IF6Manager"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventSource"),this.K.resolve("PowerPointWebEditor.ITaskPaneManager")));this.K.register(Ib,"PowerPointWebEditor.ImageDescriptionManager").ma().oa(()=>new Ib(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventSource"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IImageDescriptionPane"),this.K.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").yd(10),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),
this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IImageDescriptionBarView>"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").j3))}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").Wua&&this.K.resolve("PowerPointWebEditor.ImageDescriptionManager").initialize()}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").Wua&&this.K.resolve("PowerPointWebEditor.ImageDescriptionManager").dispose()}static main(){m.a.instance.Ac(xc.a(new Ze,
0))}}Object(r.a)(Ze,"PPTWebEditorImageDescriptionPackage",null,[2,3]);var Ke=d(79);class hf extends Ke.a{constructor(u){super(!1,!1,!0);this.Vnb=u}start(){var u={["tooltipPersistenceEnabled"]:this.Vnb.Sge};v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",!1)&&(u.textSelectionChangeEnabled=this.Vnb.Z5e);u={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:u};this.pj("",Object(z.a)(this,this.scl,"resultHandler"),u)}scl(u,P){1===u&&(this.Vnb.Sge=
P.tooltipPersistenceEnabled,v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",!1)&&(this.Vnb.Z5e=P.textSelectionChangeEnabled))}}Object(r.a)(hf,"AccessibilitySettingsDialog",Ke.a,[]);class Xa{constructor(u,P){this.Ca=u;this.Vnb=P}vb(){this.Ca.ya(G.a.Kul,J.a.frame,Object(z.a)(this,this.Lul,"showAccessibilitySettingsDialogHandler"))}Lul(){(new hf(this.Vnb)).start();return 32}}Object(r.a)(Xa,"AccessibilitySettingsDialogActor",null,[858]);var Bb=
d(1095);const mc=u=>{const P=new Bb.a;v.AFrameworkApplication.Me.zj(Qc(u),1,null,null,!0,2,la=>{200===la.data.Ke?P.Og("true"===la.data.ee.toLowerCase()):P.Og(!1)},()=>{P.Og(!1)},null,void 0,void 0,void 0,void 0,"7");return P.task},Qc=u=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",v.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",u,v.AFrameworkApplication.gh);var td=d(70);class Md{constructor(){this.ZPd=this.Ipb=null}get Sge(){return!!this.Ipb}set Sge(u){u!==
this.Ipb&&(this.Ipb=u,td.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(u),this.rrg()&&v.AFrameworkApplication.Me.zj(Qc("saveHoverableRibbonTooltipIsEnabled"),2,u.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}get Z5e(){return!!this.ZPd}set Z5e(u){u!==this.ZPd&&(this.ZPd=u)}T9j(){const u=new Bb.a;if(this.Ipb)u.Og(this.Ipb);else if(this.rrg()){const P=mc("getHoverableRibbonTooltipIsEnabled");P.continueWith(()=>{this.Ipb=P.result;
td.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(P.result);u.Og(P.result)},8)}else u.Og(!1)}rrg(){const u=v.AFrameworkApplication.fa.ka("IsRoamingServiceEnabled"),P=v.AFrameworkApplication.fa.ka("IsAnonymousUser");return u&&!P}}Object(r.a)(Md,"AccessibilitySettingsInfo",null,[831]);class Pd{constructor(){this.Da=null}get name(){return"Common.App.AccessibilitySettings"}Yb(u){this.Da=u;this.Da.register(Md,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").oa(()=>
new Md).ma();this.Da.register(Xa,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").oa(()=>new Xa(v.AFrameworkApplication.Ra,this.Da.qb("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).ma()}init(){const u=this.Da.qb("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),P=this.Da.qb("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");u&&P?(P.vb(),u.T9j()):R.c(539637639,
200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){m.a.instance.Ac(new Pd)}}Object(r.a)(Pd,"AccessibilitySettingsPackage",null,[2,3]);var Be=d(93),fe=d(222),Mf=d(1161),Bd=d(81),Rc=d(723);class Gf extends Wa.StandardDialog{constructor(u,P,la,Ba=null){super();this.V2=this.ps=this.sOa=null;this.ow=[];this.KEc=P;this.UP=u;this.DZh=la;this.hGc=Ba;this.Qrb=new Rc.a("LoadResource","LoadPrintablePdf")}ika(){this.Ad=
5;this.width=40;const u=document.createElement("span");u.id=this.Uh("DirectPrintHeaderContent");const P=document.createElement("span");P.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(P,"DirectPrintHeader");this.V2=document.createElement("iframe");this.V2.name="pdfObjectFrame";this.V2.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.V2.onload=Object(z.a)(this,this.xTk,"printablePdfLoaded");if(this.hGc&&0<this.hGc.count){var la=Bd.a.Sbe(this.KEc,this.hGc);const Ba=
Bd.a.dVe(this.KEc,this.hGc);this.ps=document.createElement("form");this.ps.id="printPreviewPostForm";this.ps.method="POST";this.ps.target=this.V2.name;this.ps.action=Ba;for(let Sa of la)la=document.createElement("input"),la.type="hidden",la.name=Sa.key,la.value=Sa.value,this.ps.appendChild(la)}else this.V2.setAttribute("src",this.KEc);Sys.UI.DomElement.addCssClass(this.V2,fe.a.yof);this.DZh?(Sys.UI.DomElement.addCssClass(this.V2,"DirectPrintPdfObjectHidden"),P.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,
Ha.a.bS(this.V2,Ha.a.HI,Ha.a.lB)):(Sys.UI.DomElement.addCssClass(this.V2,"DirectPrintPdfObject"),this.ow.push(this.V2));u.appendChild(P);u.appendChild(document.createElement("br"));u.appendChild(this.V2);this.ps&&u.appendChild(this.ps);u.appendChild(document.createElement("br"));u.appendChild(this.CGi(this.ps?"#":this.KEc));this.Qrb.start();this.THb(CommonUIStrings.l_AppTitle,null,null,null,null,u);this.y6(this.Uh("DirectPrintHeaderContent"));this.ps&&this.ps.submit();this.eLi();n.ULS.sendTraceTag(4771852,
328,50,"Direct Print Dialog launched.")}CGi(u){const P=document.createElement("span");var la=document.createElement("span");la.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;P.appendChild(la);v.AFrameworkApplication.fa&&(2===v.AFrameworkApplication.Aa.ob.zk&&v.AFrameworkApplication.fa.ka("PPTDisableDirectPrintDialogDownloadPDFLink")||1===v.AFrameworkApplication.Aa.ob.zk&&v.AFrameworkApplication.fa.ka("XLODisableDirectPrintDialogOpenPDFLink"))?(u=document.createElement("span"),2===
v.AFrameworkApplication.Aa.ob.zk?u.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===v.AFrameworkApplication.Aa.ob.zk&&(u.innerText=CommonUIStrings.l_InternalError_Directive,n.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.sOa=u,P.appendChild(document.createElement("br")),P.appendChild(u)):(la=document.createElement("a"),la.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,la.href=u,la.target="_blank",la.id="PrintPDFLink",la.className=
"AllowBrowserClick",this.sOa=la,P.appendChild(document.createElement("br")),P.appendChild(la),this.ps&&Be.a.addHandler(la,"click",Object(z.a)(this,this.dNe,"onSubmit")),this.UP.rb(Ca.a.click,this.sOa,Object(z.a)(this,this.fVf,"downloadPDFLinkClicked"),null));this.ow.push(this.sOa);return P}dNe(u){this.ps&&(this.ps.target="_blank",this.ps.submit());u.preventDefault()}eLi(){if(0<this.ow.length){const u=new Mf.a(this.ow),P=ud.FocusManager.instance().Ll();P&&(this.sOa.focus(),P.Dj=u,P.uX=!0)}}fVf(){n.ULS.sendTraceTag(4585050,
328,50,"Download PDF from Direct Print dialog clicked.");return!1}ndb(){n.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}xTk(){n.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.Qrb&&this.Qrb.stop()}dispose(){this.sOa&&(this.UP.Bb(Ca.a.click,this.sOa,Object(z.a)(this,this.fVf,"downloadPDFLinkClicked")),this.sOa=null);bb.a.lP(this.V2);this.V2=null;super.dispose()}}Object(r.a)(Gf,"DirectPrintDialog",Wa.StandardDialog,[900]);class Nf{constructor(u){this.UP=
u}Hfj(u,P){return new Gf(this.UP,u,P,null)}}Object(r.a)(Nf,"DirectPrintDialogFactory",null,[867]);var Oa=d(1243),cb=d(65);class Ic{constructor(u,P){this._url=u;this.G3h=P}JUf(){this.G3h?cb.a.downloadFile(this._url):cb.a.En(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(r.a)(Ic,"OpenUrlInTabDialogDownloadBehavior",null,[929,107]);var qd=d(55);class le extends Wa.StandardDialog{constructor(u,P=!0,la=!1,Ba=null,Sa=null,pb=!1){super();this.zpb=this.ypb=this.ps=
this.hca=null;var Vb=this.t6e?this.t6e:CommonUIStrings.l_DefaultDialogTitle;le.Ezb=pb;this.SDd=Ba||new Ic(u,!0);const Bc=[],Yc=[];le.k2&&(this.zJc&&this.zJc.forEach(Re=>{Array.add(Bc,Re)}),this.cAf&&this.cAf.forEach(Re=>{Array.add(Yc,Re)}));P?la?this.$mg?(this.Ad=12,this.Oe(1,this.buttonText),this.Oe(2,CommonUIStrings.l_DownloadACopyDialog_CopyALinkButton),this.Oe(3,CommonUIStrings.l_DialogClose)):this.ZVj?(this.Ad=12,this.Oe(1,this.buttonText),this.Oe(2,CommonUIStrings.l_DownloadACopyDialog_EmailALinkButton),
this.Oe(3,CommonUIStrings.l_DialogClose)):(this.Ad=4,this.Oe(1,this.buttonText),this.Oe(2,CommonUIStrings.l_DialogClose)):(this.Ad=6,this.Oe(0,CommonUIStrings.l_DialogClose)):this.Ad=5;pb=document.createElement("span");this.H3b&&(pb.className=this.H3b);Ba=document.createElement("a");Ba.innerText=this.vCb;Ba.href=u;Ba.target="_blank";Ba.id=this.gdc;Ba.className=qa.AFrame.JAf;var gd=!qd.a.$T&&!!Sa&&0<Sa.count;if(gd){const Re=Bd.a.Sbe(u,Sa);Sa=Bd.a.dVe(u,Sa);Ba.href="#";Ba.target="_self";this.ps=document.createElement("form");
this.ps.id="printPreviewPostForm1";this.ps.method="post";this.ps.target="_blank";this.ps.action=Sa;for(var Td of Re)Sa=document.createElement("input"),Sa.type="hidden",Sa.name=Td.key,Sa.value=Td.value,this.ps.appendChild(Sa)}else this.ps=null;this.ps||le.Ezb?le.Ezb||Array.add(Yc,{["type"]:"AppLinkProps",["id"]:this.gdc,["text"]:this.vCb,["onExecute"]:()=>{this.hlh()}}):Array.add(Yc,{["type"]:"AppLinkProps",["id"]:this.gdc,["text"]:this.vCb,["handler"]:{["href"]:gd?"#":u,["target"]:gd?"_self":"_blank"}});
this.Tna&&Array.add(Bc,this.Tna);la?(u=document.createElement("span"),u.innerText=this.Tna.replace("{0}",""),pb.appendChild(u)):this.S3g?(u=document.createElement("span"),u.id=this.Uh("message"),Td=document.createElement("span"),Sa=document.createElement("span"),gd=this.Tna.split("{0}"),Td.innerText=gd[0],Sa.innerText=gd[1],u.appendChild(Td),u.appendChild(Ba),u.appendChild(Sa),pb.appendChild(u)):(u=document.createElement("span"),u.innerText=this.Tna,pb.appendChild(u),pb.appendChild(document.createElement("br")),
pb.appendChild(document.createElement("br")),pb.appendChild(Ba),le.Ezb||Array.add(Bc,"{0}"));this.ps&&pb.appendChild(this.ps);le.k2&&(this.BWa&&(this.ddc?this.oxf(this.BWa,this.ddc):(Array.add(Bc,"{0}"),Array.add(Yc,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.BWa,["onExecute"]:()=>{this.y4c()}}))),this.tIc(Bc,Yc));this.THb(Vb,null,this.Wge,null,Object(z.a)(this,this.I3,"dialogHandler"),le.k2?null:pb);this.y6(this.Uh("message"));!le.k2&&this.ddc&&this.BWa&&(Vb=document.createElement("div"),
Vb.className="WACDialogLearnMoreLinkContainer",this.hca=document.createElement("a"),this.hca.innerText=this.BWa,this.hca.href=this.ddc,this.hca.target="_blank",this.hca.id=this.Uh("LearnMoreLinkId"),this.hca.className=qa.AFrame.JAf,Vb.appendChild(this.hca),P?this.Ib.insertBefore(Vb,this.Ib.lastChild):this.Ib.appendChild(Vb),this.y6(String.format("{0} {1}",this.Uh("message"),this.Uh("LearnMoreLinkId"))));this.FTb=Ba;la?this.eS(this.SD):this.eS(this.FTb);this.vdc();v.AFrameworkApplication.Aa.nS.rb(Ca.a.click,
this.FTb,Object(z.a)(this,this.eVf,"downloadLinkClicked"),null);this.hca&&v.AFrameworkApplication.Aa.nS.rb(Ca.a.click,this.hca,Object(z.a)(this,this.y4c,"learnMoreLinkClicked"),null);this.Nef=!1}get Wge(){return null}get t6e(){return null}get Tna(){return null}get ddc(){return null}get BWa(){return null}get S3g(){return!1}get buttonText(){return CommonUIStrings.l_Open}get H3b(){return null}get zJc(){return null}get cAf(){return null}get $mg(){return!1}get ZVj(){return!1}RNf(){}r8(){this.ps&&(this.ypb||
(this.ypb=Object(z.a)(this,this.aAk,"onActionButtonClicked"),this.Hn.rb(Ca.a.click,this.SD,this.ypb)),this.zpb||(this.zpb=Object(z.a)(this,this.bAk,"onActionButtonKeyUp"),this.Wg.rb(Ca.a.Tl,this.SD,this.zpb)));super.r8()}aAk(u){this.CYf(u);return!0}bAk(u){return this.V3c(u,Object(z.a)(this,this.CYf,"executeDismissActionButtonFromArgs"))}CYf(u){this.ps&&this.ps.submit();this.Q9a(u.Bc)}ndb(){}eVf(){this.xdc();this.ps?this.ps.submit():this.SDd.JUf();return!0}y4c(){return!1}dispose(){this.SDd.dispose();
this.FTb&&(v.AFrameworkApplication.Aa.nS.Bb(Ca.a.click,this.FTb,Object(z.a)(this,this.eVf,"downloadLinkClicked")),this.FTb=null);this.hca&&(v.AFrameworkApplication.Aa.nS.Bb(Ca.a.click,this.hca,Object(z.a)(this,this.y4c,"learnMoreLinkClicked")),this.hca=null);this.Hn&&this.ypb&&(this.Hn.Bb(Ca.a.click,this.SD,this.ypb),this.ypb=null);this.Wg&&this.zpb&&(this.Wg.Bb(Ca.a.Tl,this.SD,this.zpb),this.zpb=null);super.dispose()}hlh(){this.ps&&(document.body.appendChild(this.ps),this.ps.submit(),document.body.removeChild(this.ps))}I3(u){1===
u?(this.ndb(),this.ps?le.k2&&this.hlh():this.SDd.JUf()):2===u&&this.$mg&&this.RNf();this.dispose()}static get k2(){return v.AFrameworkApplication.Aa.ob.hD&&v.AFrameworkApplication.Aa.ob.brg}static get Ezb(){return le.Thf}static set Ezb(u){le.Thf=u}}le.Thf=!1;Object(r.a)(le,"ADialogWithLinkToResource",Wa.StandardDialog,[]);class yb extends le{constructor(u,P,la=null,Ba=!0,Sa=!1){super(u,!0,!(yb.f3a&&Ba),new Ic(u,P),la,Sa);yb.f3a=yb.f3a&&Ba;if(yb.f3a){P=document.createElement("iframe");Ba=null;Sa=this.XTi;
P.name="pdfObjectFrame";P.id="pdfObjectIFrame";if(la&&0<la.count){const pb=Bd.a.Sbe(u,la);u=Bd.a.dVe(u,la);Ba=document.createElement("form");Ba.id="printPreviewPostForm";Ba.method="POST";Ba.target=P.name;Ba.action=u;for(let Vb of pb)u=document.createElement("input"),u.type="hidden",u.name=Vb.key,u.value=Vb.value,Ba.appendChild(u)}else P.src=u;Sa.appendChild(P);Ba&&(Sa.appendChild(Ba),Ba.submit());Sys.UI.DomElement.addCssClass(P,"DirectPrintPdfObjectHidden");Ha.a.bS(P,Ha.a.HI,Ha.a.lB)}}get Wge(){return"Print_32x32x32"}get t6e(){return yb.f3a?
CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get Tna(){return yb.f3a?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get zJc(){const u=[];Array.add(u,CommonUIStrings.l_PrintDialogCanCloseDocument);if(le.Ezb){let P=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==v.AFrameworkApplication.Aa.ob.dRf&&(P=v.AFrameworkApplication.Aa.ob.dRf);Array.add(u,P)}return yb.f3a?u:null}get vCb(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get gdc(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get H3b(){return v.AFrameworkApplication.Zsa?
"UIFontDialogTextLarge":null}vdc(){n.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}xdc(){v.AFrameworkApplication.mj.xbb(9540,1);n.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}ndb(){n.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get f3a(){return!!v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.ob.hD&&v.AFrameworkApplication.fa.ka("DirectPrintDialogAsStandardDialogIsEnabled")&&!(qd.a.$T||qd.a.Wj||qd.a.gg||qd.a.bcc)&&!v.AFrameworkApplication.Dcc&&
v.AFrameworkApplication.fa.ka("ShouldHostDefaultToNativeBrowserPrintExperience")}static set f3a(u){}}Object(r.a)(yb,"PrintDialogWithLinkToPdf",le,[]);class ef{constructor(u){this.isEnabled=Boolean.parse(u.DirectPrintIsEnabled||"false");this.m1j=Boolean.parse(u.DirectPrintProbeIsEnabled||"false");this.HYj=Boolean.parse(u.DirectPrintEnabledForInternetExplorer||"false");this.pmb=(u.DirectPrintSupportedMimeTypes||"").split(ef.y3d);this.l2a=(u.DirectPrintSupportedPlugins||"").split(ef.y3d);this.tLj=(u.DirectPrintImmersivePreviewPlugins||
"").split(ef.y3d);this.Jng=Boolean.parse(u.DirectPrintEnabledForEdge||"false");this.gUj=Boolean.parse(u.ChromePrintLayoutFixIsEnabled||"false");this.cAi=parseInt(u.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.IIe=14;this.U3g=14394;if(u=u.DirectPrintMinimalSupportedEdgeVersion){const P=u.split(".");2===P.length?(this.IIe=parseInt(P[0]),this.U3g=parseInt(P[1])):n.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",u)}else n.ULS.sendTraceTag(20734113,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}ef.y3d=",";Object(r.a)(ef,"DirectPrintBrsSettings",null,[]);class Cb{constructor(u,P){this.v4e=u;this.l2a=P}}Object(r.a)(Cb,"DirectPrintProbeResults",null,[]);var oc=d(205),vc=d(105);class nd{constructor(u,P,la,Ba,Sa,pb,Vb,Bc,Yc,gd){this.PHc=null;this.kXh=u;this.NWb=P;this.rKd=la;this.V_h=Ba;this.P0h=Sa;this.BXb=new Oa.a(Object(z.a)(this,this.zoj,"getProbeResults"));this.wDd=pb;this.fmf=Yc;this.hPd=Vb;this.Q0h=
Bc;this.e1h=gd}get qL(){return this.kXh}start(){}KTk(){this.qL.m1j&&this.vck()}JWk(){const u=Array(this.qL.pmb.length);if(void 0!==this.NWb&&null!==this.NWb)for(let P=0;P<this.qL.pmb.length;P++)u[P]=this.qL.pmb[P]in this.NWb&&this.V_h(this.NWb[this.qL.pmb[P]]);return u}KWk(){const u=Array(this.qL.l2a.length),P=!(void 0===this.rKd||null===this.rKd);for(let la=0;la<this.qL.l2a.length;la++){const Ba=this.qL.l2a[la];u[la]=P&&Ba in this.rKd?!0:this.P0h(Ba)}return u}Ztj(){const u=this.JWk(),P=Array(u.length);
for(let la=0;la<u.length;la++)P[la]=u[la]?this.C1i(this.NWb[this.qL.pmb[la]]):null;return P}C1i(u){if(void 0===u||null===u)return null;u=u.enabledPlugin;return void 0===u||null===u?null:u.name}vck(){n.ULS.sendTraceTag(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.BXb.value.v4e,this.BXb.value.l2a)}zoj(){var u=this.Ztj();const P=this.KWk(),la={},Ba={};for(let Sa=0;Sa<this.qL.pmb.length;Sa++)la[this.qL.pmb[Sa]]=u[Sa];for(u=0;u<this.qL.l2a.length;u++)Ba[this.qL.l2a[u]]=P[u];return new Cb(la,Ba)}Bul(){return this.e1h||
!this.qL.isEnabled||v.AFrameworkApplication.Dcc?!1:this.BCl()}DBh(){if(null!=this.PHc)return this.PHc;const u=nd.Hng(this.qL);return this.PHc=this.qL.Jng&&u||this.dUj()}dUj(){return qd.a.ik&&this.qL.gUj&&qd.a.rMc>=this.qL.cAi?!0:!1}BCl(){if(!this.Q0h(this.qL))return!1;var u=vc.a.hee(this.BXb.value.v4e);for(const P of u)if(void 0!==P&&null!==P)return!0;u=vc.a.hee(this.BXb.value.l2a);for(const P of u)if(P)return!0;return!1}kHj(){const u=vc.a.hee(this.BXb.value.v4e);for(const P of u)if(oc.a.contains(this.qL.tLj,
P))return!0;return!1}ICh(u){v.AFrameworkApplication.Aa&&v.AFrameworkApplication.fa.ka("DirectPrintDialogAsStandardDialogIsEnabled")?this.fmf(u,null):this.Bul()?this.eVi(u,this.kHj()&&!0):this.fmf(u,null)}eVi(u,P){const la=this.hPd.Ii("UserAction","OpenDirectPrintDialog");this.wDd.Hfj(u,P).ika();la.stop()}static W3j(u){try{return new ActiveXObject(u),!0}catch(P){n.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",u)}return!1}static lWj(u){return void 0===u||null===
u?!1:!(void 0===u.enabledPlugin||null===u.enabledPlugin)}static create(u){const P=new ef(v.AFrameworkApplication.fa.appSettings);let la=null;try{la=window.navigator.mimeTypes}catch(gd){n.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let Ba=null;try{Ba=window.navigator.plugins}catch(gd){n.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const Sa=nd.lWj,pb=nd.W3j;u=u.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const Vb=v.AFrameworkApplication.Aa.vV,
Bc=nd.X3j,Yc=!!v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.ob.hD&&!v.AFrameworkApplication.fa.ka("PrintDialogFallbackLinkEnabled");return new nd(P,la,Ba,Sa,pb,u,Vb,Bc,(gd,Td)=>new yb(gd,!1,Td,!0,Yc),v.AFrameworkApplication.isEmbedded)}static X3j(u){return qd.a.ik||qd.a.Wj&&u.HYj||u.Jng&&nd.Hng(u)?!0:!1}static Hng(u){var P=qd.a.ESa;if(P){var la=P.split(".");if(2===la.length)return P=parseInt(la[0]),la=parseInt(la[1]),P>u.IIe||P===u.IIe&&la>=u.U3g}return!1}}Object(r.a)(nd,"DirectPrintManager",
null,[830]);class id{constructor(){this.Def=this.Da=null}get name(){return"Common.App.DirectPrint"}Yb(u){this.Da=u;u.register(Nf,"Common.App.DirectPrint.DirectPrintDialogFactory").ma().oa(()=>new Nf(v.AFrameworkApplication.Aa.nS));u.register(830,"Common.App.DirectPrint.IDirectPrintManager").ma().oa(()=>nd.create(this.Da))}init(){this.Def=this.Da.resolve("Common.App.DirectPrint.IDirectPrintManager");this.Def.start()}dispose(){}}Object(r.a)(id,"PackageManager",null,[2,3]);var Nd=d(1168),Ce=d(299);class af{constructor(u,
P){this.XTb=null;this.Ca=u;this.Oa=P}vb(){(this.XTb=this.Oa.Ha("StatusBarEnvironmentNameToUse"))&&""!==this.XTb&&this.Ca.ra(G.a.MRe,J.a.frame,Object(z.a)(this,this.hOl,"updateEnvironmentName"),96)}hOl(u,P,la,Ba,Sa){if(1===la)return 32;Sa[Nd.a.Value]=this.XTb;Sa[Ce.a.labelText]=this.XTb;Sa[Nd.a.Visible]=!0;return 32}}Object(r.a)(af,"DisplayEnvironmentName",null,[]);class de{constructor(){this.Da=null}get name(){return"Common.App.DisplayEnvironmentName"}Yb(u){this.Da=u;this.Da.register(af,"Common.App.DisplayEnvironmentName.DisplayEnvironmentName").ma().oa(()=>
new af(v.AFrameworkApplication.Ra,v.AFrameworkApplication.fa))}init(){this.Da.resolve("Common.App.DisplayEnvironmentName.DisplayEnvironmentName").vb()}dispose(){}static main(){m.a.instance.Ac(new de)}}Object(r.a)(de,"DisplayEnvironmentNamePackage",null,[2,3]);var $f=d(185),ge=d(559);class ze extends ge.a{constructor(u){super(u)}get a3b(){return!1}createElement(){const u=document.createElement("link");u.setAttribute("rel","stylesheet");u.setAttribute("type","text/css");u.setAttribute("href",this.$u);
return u}tOc(){return null}Sqc(){this.element.setAttribute("href","");this.element.setAttribute("href",this.aN.$u)}}Object(r.a)(ze,"CssResource",ge.a,[]);var si=d(310),sh=d(3);class dd{constructor(){this.WEc=this.$Ac=null}Q9j(){this.$Ac||(n.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),this.$Ac=sh.Task.WAA(dd.Z9j(),dd.F9j()),this.$Ac.continueWith(u=>{n.ULS.sendTraceTag(21030599,324,10,"{0}",lb.a.E$d(u.ej))},5));return this.$Ac}R9j(){if(!this.WEc)try{n.ULS.sendTraceTag(39978390,
324,50,"InProductMessagingFreemiumDependenciesLoad usage"),this.WEc=sh.Task.WAA(dd.m5d(si.a.create(v.AFrameworkApplication.fa.Ha("DimeUrl"),null,null))),this.WEc.continueWith(u=>{n.ULS.sendTraceTag(39978391,324,10,"{0}",lb.a.E$d(u.ej))},5)}catch(u){n.ULS.sendTraceTag(594874951,324,10,"{0}",lb.a.E$d(u))}return this.WEc}static Z9j(){var u=dd.IXc("inproductmessaging.js");u=si.a.create(u,null,null);return dd.m5d(u)}static F9j(){var u=dd.IXc("inproductmessaging.css");u=new ze(u);return dd.m5d(u)}static IXc(u){return $f.a.dvb(String.format("ipm/{0}",
u))}static m5d(u){Sc.a.oy(u);return u.IGa}}Object(r.a)(dd,"DependencyDownloader",null,[870]);class Lc{}Lc.OKk="inProductMessagingOverlayDiv";Lc.MOk="PlayButtonImage";Lc.w$k="ReplayButtonImage";Object(r.a)(Lc,"Constants",null,[]);class Zd{constructor(){this.jtf=this.Cnf=this.Lbf=!0;this.x$k=this.NOk=null;this.nxk=!1;this.locale=null;this.QLh={}}get autoPlay(){return this.Lbf}set autoPlay(u){this.Lbf=u}get p4g(){return this.Cnf}set p4g(u){this.Cnf=u}get zCh(){return this.jtf}set zCh(u){(this.jtf=u)&&
this.Uml()}Uml(){this.Hyf(Lc.MOk,this.NOk);this.Hyf(Lc.w$k,this.x$k)}Hyf(u,P){P&&(this.QLh[u]=P)}}Object(r.a)(Zd,"FirstRunExperienceUISettings",null,[863]);class Ne{constructor(){this.completed=this.k5k=!1}}Object(r.a)(Ne,"FirstRunExperienceViewData",null,[860]);var Xc=d(197);class lf{constructor(u,P,la){this.Ca=u;this.Xh=P;this.WBc=la}vb(){this.Ca.ra(G.a.V5i,J.a.frame,Object(z.a)(this,this.U5i,"firstRunExperienceHandler"),64);this.Ca.ya(G.a.Y0f,J.a.frame,Object(z.a)(this,this.ALj,"inProductMessagingTabHandler"));
this.Ca.ya(G.a.X0f,J.a.frame,Object(z.a)(this,this.zLj,"inProductMessagingShiftTabHandler"));this.Ca.ya(G.a.tUi,J.a.frame,Object(z.a)(this,this.uUi,"dimeLaunchHandler"));this.Ca.ya(G.a.dqh,J.a.frame,Xc.ActionManager.Sg);this.Ca.ya(G.a.Q$k,J.a.frame,Xc.ActionManager.Sg);this.Ca.ya(G.a.R$k,J.a.frame,Xc.ActionManager.Sg);this.Xh&&this.Xh.updateCommandUI()}U5i(u,P,la,Ba,Sa){2===la&&this.WBc.V7j(Sa);return 32}uUi(u,P,la,Ba,Sa){2===la&&this.WBc.U7j(Sa);return 32}ALj(u,P,la){return 2===la?this.WBc.fJe():
32}zLj(u,P,la){return 2===la?this.WBc.YIe():32}}Object(r.a)(lf,"InProductMessagingActor",null,[]);class Kh{constructor(){this.cnh=this.t6=this.EHh=this.v4c=this.instance=null}}Object(r.a)(Kh,"DimeExperienceUISettings",null,[]);var bd=d(533);class fd{constructor(u,P,la,Ba,Sa){this.FTc=!1;this.q4b=null;this.Ca=u;this.V6a=P;this.FFc=la;this.Bha=Ba;this.Aha=Sa}cOj(u){td.b("getHeaderApi")?u.isFeatureEnabled("MsoPremiumBadge",!0).then(P=>{const la=u.isFreemiumUpsellEnabled();la&&(appChrome.getHeaderApi().then(Ba=>
{Ba.updatePremiumStatus(P,la);return null}),u.v0a("MsoPremiumBadge",Ba=>{appChrome.getHeaderApi().then(Sa=>{Sa.updatePremiumStatus(Ba.isEnabled,la);return null})}));return null}):n.ULS.sendTraceTag(593859840,324,10,"getHeaderApi not available")}V7j(u){this.FFc.Q9j().continueWith(()=>{this.V6a.Fxl(u)})}U7j(u){let P="gopremium",la=null,Ba=()=>{};u?(u.experience&&""!==Object(S.a)(String,u.experience)&&(P=Object(S.a)(String,u.experience)),u.onTaskComplete&&(Ba=u.onTaskComplete),u.campaignId&&""!==Object(S.a)(String,
u.campaignId)&&(la=Object(S.a)(String,u.campaignId))):n.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");this.Bug(P,Ba,la)}Bug(u,P,la=null){if(this.FTc&&this.q4b){const Ba={};Ba.experience=u||"gopremium";Ba.campaignId=la||bd.b(this.Bha,this.Aha,Object(S.a)(String,Ba.experience),!0);this.Ca.processAction(G.a.dqh,2);n.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+Ba.experience);try{const Sa=Object.assign(new Kh,{instance:this.q4b,v4c:Ba,EHh:P||
(()=>{}),t6:pb=>{n.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+pb.status)},cnh:()=>{n.ULS.sendTraceTag(51675406,324,10,"Dime launch error");this.FTc=!1;this.q4b=null}});this.V6a.Xvl(Sa)}catch(Sa){n.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+Sa.message),this.FTc=!1,this.q4b=null,this.Ca.Ka(G.a.GTc,2,{["experience"]:Ba.experience})}}else n.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),this.Ca.Ka(G.a.GTc,2,{["experience"]:u})}S9j(){this.FFc.R9j().continueWith(()=>
{try{var u=lb.a.rg(v.AFrameworkApplication.uiCulture);const Ba=bd.c(this.Bha);if(Ba){var P={};P.partnerId=Ba;P.language=u;P.sessionId=v.AFrameworkApplication.userSessionId;P.authHint=v.AFrameworkApplication.fa.Ha("UserPrincipalName");var la=v.AFrameworkApplication.fa.Ha("Puid")||"";""!==la&&(u={},u.puid=la,P.userInfo=u);this.q4b=new Dime(P);this.FTc=!0;n.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else n.ULS.sendTraceTag(51675409,324,15,"App not supported")}catch(Ba){n.ULS.sendTraceTag(51675410,
324,10,"FreemiumUpsellDialogDependencies failed: "+Ba.message)}},3)}fJe(){return this.V6a.fJe()}YIe(){return this.V6a.YIe()}}Object(r.a)(fd,"InProductMessagingUIManager",null,[859]);class Ve{constructor(){this.Guf=0;this.rqb=Array(5);this.rqb[0]=10;this.rqb[1]=15;this.rqb[2]=50;this.rqb[3]=100;this.rqb[4]=200}Init(u){this.Guf=u}SendTrace(u,P){n.ULS.sendTraceTag(34182235,this.Guf,this.rqb[u],"{0}",P)}}Object(r.a)(Ve,"DefaultNetworkingManager",null,[868]);var rf=d(204);class Ag{constructor(u){this.Pd=
u}Fxl(u){u&&(InProductMessaging.Networking.NetworkingMgr=new Ve,InProductMessaging.Networking.NetworkingMgr.Init(387),InProductMessaging.Init(u.zCh,u.p4g,u.autoPlay,u.nxk,u.locale,Object(z.a)(this,this.DCk,"onDismissFirstRunExperience"),u.QLh),this.z6(Lc.OKk,!0))}Xvl(u){if(u&&u.instance&&u.v4c){let P=document.getElementById("wacDimeContainer");P||(P=document.createElement("div"),P.id="wacDimeContainer",document.body.appendChild(P));v.AFrameworkApplication.fa.ka("DimeFocusManagerIsEnabled")&&this.z6("wacDimeContainer",
!1);u.v4c.parentElementId="wacDimeContainer";u.instance.launch(u.v4c,u.EHh).then(la=>{this.Qoa();document.body.removeChild(P);u.t6(la)}).catch(la=>{this.Qoa();document.body.removeChild(P);u.cnh(la)})}else throw Error.argument("DimeExperienceUISettings");}z6(u,P){if(this.Pd&&u&&(u=document.getElementById(u),this.TNj(u),u=this.Pd.EQ("InProductMessagingFocusId"))){const la=this.Pd.Ee;la&&"InProductMessagingFocusId"===la.name||this.Pd.XU("InProductMessagingFocusId",!1);P&&this.NTe(u.scope)}}TNj(u){var P=
this.Pd.Fc("InProductMessagingFocusId");P.parent=qa.AFrame.gE;const la=new rf.DOMFocusListing(()=>u);la.Wjb=!1;la.Ro(3);la.Ro(2);la.Ro(4);P=this.Pd.zja(()=>u,P,la);P.Xjb();P.uX=!0;P.QRa=!0}NTe(u){u.Bp(ud.FocusManager.instance().Bra);u.Bp(ud.FocusManager.instance().Cra);u.bindAction(ud.FocusManager.instance().Bra,G.a.Y0f);u.bindAction(ud.FocusManager.instance().Cra,G.a.X0f)}Qoa(){this.Pd&&(this.Pd.q1("InProductMessagingFocusId"),this.Pd.YLb("InProductMessagingFocusId"))}DCk(u,P){this.Qoa();u=Object.assign(new Ne,
{completed:u,k5k:P});v.AFrameworkApplication.Ra.Ka(G.a.T5i,2,u)}fJe(){const u=document.activeElement,P=this.Pd.Ll();return u&&P&&P.Dj&&u===P.Dj.jCb?(P.Dj.mF(u),P.dIb()?32:8):4}YIe(){const u=document.activeElement,P=this.Pd.Ll();return u&&P&&P.Dj&&u===P.Dj.xka?(P.Dj.mF(u),P.bIb()?32:8):4}}Object(r.a)(Ag,"InProductMessagingUIWrapper",null,[829]);class ne{constructor(){this.Da=null}get name(){return"Common.App.InProductMessaging"}Yb(u){u.register(dd,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").ma().oa(()=>
new dd);u.register(Ag,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").ma().oa(()=>new Ag(ud.FocusManager.instance()));u.register(fd,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").ma().oa(()=>new fd(v.AFrameworkApplication.Ra,u.resolve("Common.IInProductMessagingUIWrapper"),u.resolve("Common.App.InProductMessaging.IDependencyDownloader"),v.AFrameworkApplication.Aa.ob.zk,v.AFrameworkApplication.Aa.ob.LJa));
u.register(lf,"Common.App.InProductMessaging.InProductMessagingActor").ma().oa(()=>new lf(v.AFrameworkApplication.Ra,v.AFrameworkApplication.Aa,u.resolve("Common.IInProductMessagingUIManager")));u.register(Zd,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").ma().oa(()=>new Zd);u.register(Ne,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").ma().oa(()=>new Ne);this.Da=u}init(){this.Da.resolve("Common.App.InProductMessaging.InProductMessagingActor").vb();
v.AFrameworkApplication.fa.ff(()=>{v.AFrameworkApplication.Aa.ob.mO&&ac.a.get_instance().Mj(15,()=>{this.Da.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(u=>{this.Da.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").cOj(u)})});v.AFrameworkApplication.fa.ka("FreemiumUpsellShowDialogIsEnabled")&&bd.a()&&!qd.a.Ex&&1!==v.AFrameworkApplication.Aa.ob.zk&&this.Da.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(u=>{u.isFeatureEnabled("MsoPremiumBadge",
!0).then(P=>{!P&&u.isFreemiumUpsellEnabled()&&this.Da.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").S9j();return null})})})}dispose(){}static main(){m.a.instance.Ac(new ne)}}Object(r.a)(ne,"InProductMessagingPackage",null,[2,3]);var kf=d(397),kg=d(571);class Af{static KYi(u){return Af.PFf("New",u)}static LYi(u){return Af.PFf("Open",u)}static xFf(u,P){return Af.$7a("LoadingMenuSection",Af.L$j,u,Af.Q0b("lblLoading",P))}static R0b(u,P,la=null,Ba=null){return Af.$7a("MessageMenuSection",
Af.V4g,P,Af.Q0b("lblMessage",u,la,Ba))}static rsi(u){return Af.xFf(u,CommonUIStrings.l_VoicedLoadingText)}static ssi(u,P){return Af.R0b(CommonUIStrings.l_NewCreationLocationMessage,u.labelText,P.UR,P.sMa)}static qsi(u,P){return Af.R0b(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,P.sMa,"\n\n"),u.labelText)}static zFf(u){return Af.R0b(CommonUIStrings.l_NewGenericErrorMessage,u.labelText)}static osi(u,P,la){return Af.$7a("menuNewBlank",Af.kIj,la?u.labelText:null,Af.M0b(u.hhg,u.ihg,u.jhg,
null,u.wFa,u.u$b,P,"blank"))}static $si(){return Af.Q0b("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static MFf(){return Af.Q0b("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static ati(u,P){return Af.$7a("menuNewTemplates",u,null,P)}static msi(u,P){return Af.$7a("menuNewMoreTemplates",Af.Y1f,null,Af.M0b("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,u,P))}static lri(u,P,la){let Ba="";la&&P&&(Ba=Af.$7a("BrowseMoreMenuSection",
Af.Y1f,null,Af.M0b("btnBrowseMore",P,P,null,null,null,u||"1959943459",la)));return Ba}static Q0b(u,P,la=null,Ba=null){let Sa=Ba;P&&0<P.length&&(Sa=Af.y5g.pKa(P).trimEnd(),Sa=0<=Sa.indexOf("{0}")?String.format(Sa,Ba):String.format("{0} {1}",Sa,Ba));la=la&&Ba?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',lb.a.xe(la),lb.a.xe(Ba),lb.a.xe(Sa)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',
lb.a.xe(u||""),Af.y5g.pKa(lb.a.xe(P||"")),la)}static M0b(u,P,la,Ba,Sa,pb,Vb,Bc){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',lb.a.xe(u||""),lb.a.xe(P||""),lb.a.xe(la||""),Ba||"32by32",lb.a.xe(Sa||""),lb.a.xe(pb||""),Vb,lb.a.xe(Bc||""))}static PFf(u,P){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',
u,P)}static $7a(u,P,la,Ba){la=la?String.format('Title="{0}"',lb.a.xe(la)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',lb.a.xe(u||""),lb.a.xe(P||""),la,Ba)}}Af.V4g="MenuMru";Af.L$j="MenuLoading";Af.kIj="MenuHeader";Af.Y1f="MenuFooter";Af.y5g=kg.a.vx("\n","&#10;");Object(r.a)(Af,"NewAndOpenXmlUtilities",
null,[]);var Wf=d(96);class vf{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(r.a)(vf,"HostInformation",null,[]);var De=d(134),Ee=d(178),Jd=d(127),Og=d(442),Rg=d(534);class Eg{constructor(u,P,la,Ba,Sa,pb){this.eHc=this.zo=this.Oyc=null;this.vGc=this.GOd=!1;this.onf=0;this.uOd=this.OHd=!1;this.sia=u;this.jUb=P;this.aia=new Oa.a(()=>new kf.a(la.value,Object(z.a)(this,this.VEa,"getMoreInfoEventReceived")));this.K2h=Ba;this.qPa=Sa;this.z7h=pb;this.FYb=this.Ntd;2===
this.MR.Wfa&&(this.uOd=!0);v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&this.E3i()}get k3(){switch(this.MR.Wfa){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}E3i(){De.a.instance.Hb(new O.a(5,1,0,()=>{this.getTemplateListJson()}))}vb(){const u=this.MR.qIb;u.ya(G.a.newDocument,J.a.frame,Object(z.a)(this,this.newDocument,"newDocument"));u.ya(G.a.Aoc,
J.a.frame,Object(z.a)(this,this.Aoc,"populateNewMenu"))}newDocument(u,P,la,Ba,Sa){if(1===la)return 32;if(2===la&&Sa){if(v.AFrameworkApplication.fa.ka("BackstagePremiumTemplateExperienceEnabled")&&Sa.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),v.AFrameworkApplication.Ra.processAction(G.a.vSk,2);if(Sa.MenuItemId&&Sa.SourceControlId)return"NewDocumentHome"===Sa.SourceControlId&&rc.a("NewDocumentFromHomeTab"),this.$8a(Sa.MenuItemId,Sa.SourceControlId)}return 8}$8a(u,
P){var la=this.$gd.a1d;if(null===la)return 8;var Ba=v.AFrameworkApplication.fa.ka("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(v.AFrameworkApplication.Scb&&Ba){n.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const Sa={};Sa[Ee.a.aIh]=u;Sa[Ee.a.k3]=this.k3;Sa[Ee.a.lcid]=v.AFrameworkApplication.lcid.toString();Sa[Ee.a.reason]=Og.a.CMi;Sa[Ee.a.uiCulture]=v.AFrameworkApplication.uiCulture;Sa[Ee.a.dataCulture]=v.AFrameworkApplication.dataCulture;
v.AFrameworkApplication.KT().execute(pb=>{pb.sendMessage(Jd.a.$8a,Sa)})}else Ba=(new Date).getTime(),P=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",la,lb.a.Qe(this.Axa),lb.a.Qe(u),lb.a.Qe(this.k3),lb.a.Qe(v.AFrameworkApplication.lcid.toString()),lb.a.Qe(Ba.toString()),lb.a.Qe(P),lb.a.Qe(v.AFrameworkApplication.canary),v.AFrameworkApplication.gh),(la=v.AFrameworkApplication.fa.Ha("ScenarioId"))&&""!==la&&(P+="&wdscenarioid="+
lb.a.Qe(la)),P+="&"+v.AFrameworkApplication.qUa(),v.AFrameworkApplication.RVa&&(P+="&"+v.AFrameworkApplication.eWc()),(la=this.zo?this.zo.UR:null)?P+="&DestinationUrl="+lb.a.Qe(la):n.ULS.sendTraceTag(508928088,202,10,"CreateNewDocument: getMorInfoResult is null or PersonalFileStorageUrl is empty"),cb.a.En(P,"_blank",void 0,"CreateNewDocument");2!==this.MR.Wfa&&3!==this.MR.Wfa||n.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:Rg.a[this.MR.Wfa],["Template"]:u});
v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.Excel.ChangeGate.ConsumerTemplateTelemetry")&&1===this.MR.Wfa&&("blank"===u?rc.b("ConsumerTemplateNewBlank"):(u=[Object.assign(new M.a,{name:"TemplateId",string:u})],rc.b("ConsumerTemplateNew",null,0,!0,0,u)));return 32}ldk(u){let P=Number.MAX_VALUE,la=Number.MIN_VALUE;const Ba=window.performance;if(Ba&&"undefined"!==typeof Ba.getEntriesByName){for(let pb=0;pb<u.length;pb++){var Sa=Ba.getEntriesByName(u[pb]);
Sa&&0<Sa.length&&(Sa=Sa[0],P=Math.min(parseInt(String(Sa.fetchStart)),P),la=Math.max(parseInt(String(Sa.responseEnd)),la))}la>P&&n.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:la-P,["MinFetchStart"]:P,["MaxResponseEnd"]:la})}}Aoc(u,P,la,Ba,Sa){if(1===la)return this.uOd&&(v.AFrameworkApplication.dM("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.uOd=!1),32;2!==la||this.OHd||(this.onf=(new Date).getTime(),n.ULS.sendTraceTag(5849602,
202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.Ntd,["CachedNewMenuXmlExists"]:!!this.Oyc,["ShouldCallGetMoreInfo"]:this.MR.tMa}));v.AFrameworkApplication.dma("AdditionalDocumentTemplates-tf;AdditionalDocumentTemplates-cf");v.AFrameworkApplication.dma("WordConsumerTemplates-tf;WordConsumerTemplates-cf");return this.TPk(Sa)}TPk(u){u&&(this.Oyc?u.PopulationXML=this.Oyc:(this.MR.tMa&&!this.zo&&this.Qxk.Uda("Opened New menu",!0),u.PopulationXML=this.p$i(this.getTemplateListJson())));
return 32}grg(){return!this.MR.tMa||!!this.zo&&3===this.zo.state&&!!this.zo.sMa&&!!this.zo.UR}F1j(){return v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.ob.oGa?!0:this.grg()}getTemplateListJson(){if(!this.Ntd||!this.F1j())return null;if(this.FYb&&!this.vGc){var u="9";v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&(u="21");const P=v.AFrameworkApplication.fa.appSettings;"NumberOfTemplatesInBackstage"in
P&&(u=P.NumberOfTemplatesInBackstage);let la=this.k3;"TemplateCollectionId"in P&&(la=P.TemplateCollectionId);v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordConsumerTemplates",!1)&&(la="WordConsumerWAC",u="23");u=String.format(this.MR.Zna+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",lb.a.Qe(v.AFrameworkApplication.lcid.toString()),lb.a.Qe(la),u);Boolean.parse(P.AppendOriginQueryParam||"false")&&(u+="&org=backstage");Boolean.parse(P.BackstagePremiumTemplateExperienceEnabled||
"false")&&"TemplateTier"in P&&(u+="&templateTier="+P.TemplateTier);u+="&"+v.AFrameworkApplication.qUa();v.AFrameworkApplication.RVa&&(u+="&"+v.AFrameworkApplication.eWc());this.MR.Vlc.zj(u,1,null,null,!1,2,Ba=>{this.MR.odb("CreateNewActor.GetTemplateListJson",Ba.data);this.REl(Ba.data.ee)},Ba=>{this.MR.odb("CreateNewActor.GetTemplateListJson",Ba.data);this.QEl()},null,void 0,void 0,void 0,void 0,"5");this.FYb=!1}return this.eHc}REl(u){v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",
!1)?this.eHc=this.m4i(u):this.eHc=u;this.FYb=!1;this.Gqc();if(v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.ob.oGa&&td.c()){u=v.AFrameworkApplication.fa.ka("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const P=v.AFrameworkApplication.Scb;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.eHc,!0,u&&P))}}QEl(){this.vGc=this.FYb=!0;this.Gqc();v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.ob.oGa&&td.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",
!1,!1));Wf.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}m4i(u){u=JSON.parse(u);const P=new I.a;P.add("TM00002102");P.add("TM00002101");P.add("TM16392939");const la=oc.a.dqa(u,Ba=>P.contains(Ba.AssetId));u=u.slice(0,9);u.splice.apply(u,[2,0].concat(la));return JSON.stringify(u)}pvj(u){var P=0;for(var la=0;la<u.length;la++)if("ST"===u[la].ImageType){P=la;break}const Ba=u.length?u[P]:null;u=Ba?Ba.Url||"":"";var Sa;let pb=la=P=!1;if(Ba&&(Sa=
Ba.AspectRatio))Sa=parseFloat(Sa),1>Sa?P=!0:1.5<Sa?la=!0:1===Sa&&(pb=!0);else switch(n.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:u}),this.MR.Wfa){case 3:P=!0;break;case 2:la=!0;break;case 5:pb=!0}return{returnValue:u,NL:P?"95by123":la?"123by69":pb?"100by100":"123by95"}}p$i(u){const P=({ztd:u}=this.psi(u,this.$gd,this.$gd.Y0b||"1056925771")).returnValue;u&&(this.Oyc=P,n.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:(new Date).getTime()-
this.onf}));return P}VEa(u,P){n.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.zo||3!==u.state?2===u.state&&(n.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.GOd=!0,this.Gqc()):(this.zo=u,P||this.Gqc(),v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.ob.oGa&&td.c()&&td.d("setFileMenuHostInformation")&&(u=Object.assign(new vf,{hostUrl:this.zo.UR,hostName:this.zo.sMa,folderUrl:v.AFrameworkApplication.breadcrumbFolderUrl,folderName:v.AFrameworkApplication.breadcrumbFolderName}),
n.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(u))))}psi(u,P,la){let Ba;Ba=!1;const Sa=this.grg();let pb="";this.MR.tMa&&(this.GOd?(pb=Af.zFf(P),this.GOd=!1,n.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.zo?Sa?pb=Af.ssi(P,this.zo):this.zo.JQj?(Ba=!0,this.FYb=!1,pb=Af.qsi(P,this.zo),n.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):
(Ba=!0,pb=Af.zFf(P),n.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.zo.UR,["StorageServiceDisplayNameIsSet"]:!!this.zo.sMa})):(pb=Af.rsi(P.labelText),n.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));Sa&&(pb+=Af.osi(P,la,!pb)+({ztd:Ba}=this.Zsi(u,la)).returnValue);return{returnValue:Af.KYi(pb),ztd:Ba}}Zsi(u,P){let la;la=!1;if(!this.Ntd)return la=!0,n.ULS.sendTraceTag(5849609,
202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",ztd:la};let Ba="",Sa="",pb="MenuTemplate";if(this.vGc)Ba=Af.MFf(),this.vGc=!1,n.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(u){try{const Vb=Sys.Serialization.JavaScriptSerializer.deserialize(u,!0);Ba=this.Ysi(Vb,P);n.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");v.AFrameworkApplication.A5g&&"OneDrive"===this.Axa&&(Sa=Af.msi(this.Rxk,v.AFrameworkApplication.A5g))}catch(Vb){n.ULS.sendTraceTag(5849613,
202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:u}),Ba=Af.MFf()}la=!0}else pb="MenuLoading",Ba=Af.$si(),n.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:Af.ati(pb,Ba)+Sa,ztd:la}}Ysi(u,P){let la="";const Ba=[];for(let pb=0;pb<u.length;pb++){var Sa=u[pb];let Vb="";if(Sa){const Bc=Sa.Title,Yc=Sa.AssetId;Sa=Sa.Thumbnails;Yc&&Bc&&Sa&&({NL:Sa,returnValue:Vb}=this.pvj(Sa),la+=Af.M0b("jbtnNewTemplate"+pb,Bc,null,Sa,
null,Vb,P,Yc))}Ba[pb]=Vb}u=new O.a(4,1,5E3,()=>{this.ldk(Ba)},106);this.MR.Ygd.Hb(u);return la}Gqc(){this.OHd=!0;this.MR.v5g.j2(this.$gd.A6b);this.OHd=!1}get MR(){return this.sia.value}get $gd(){return this.jUb.value}get Qxk(){return this.aia.value}get Rxk(){return this.K2h.value}get Axa(){return this.qPa.value}get Ntd(){return this.z7h.value}}Object(r.a)(Eg,"CreateNewActor",null,[]);class xf{constructor(){this._initialized=!1;this.mPd={}}$C(u){this.SXf();return this.get(u)}contains(u){this.SXf();
return u.toString()in this.mPd}SXf(){this._initialized||(this.Zdi(),this._initialized=!0)}Gsb(u,P){this.mPd[u.toString()]=P}get(u){return this.mPd[u.toString()]}}Object(r.a)(xf,"AIntlHelper",null,[]);class hd extends xf{constructor(){super()}Zdi(){this.Gsb(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.Gsb(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.Gsb(2,CommonUIStrings.l_Open);this.Gsb(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.Gsb(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.Gsb(5,
CommonUIStrings.l_VoicedLoadingText)}static get instance(){return hd.La||(hd.La=new hd)}static RJk(u){return hd.instance.$C(u)}}hd.La=null;Object(r.a)(hd,"MruActorIntlHelper",xf,[]);var yf;(function(u){u[u.success=0]="success";u[u.failure=1]="failure";u[u.spinner=2]="spinner";u[u.none=3]="none"})(yf||(yf={}));Object(r.b)("DisplayState",yf);var cd=d(36);class cg{constructor(u,P,la,Ba,Sa,pb,Vb,Bc){this.RBd=null;this.fRd=!0;this.Nyc="";this.r9h=0;this.qqb=null;this.MId=3;this.Oa=Bc;this.sia=u;this.Aca=
P;this.tYh=la;this.UUh=Ba;this.TUh=Sa;this.aia=new Oa.a(()=>new kf.a(pb.value,null));this.cZh=new Oa.a(()=>new kf.a(Vb.value,Object(z.a)(this,this.fxk,"mruEventResultReceived")));this.Oa.ka("WacInTabOpenMRUIsEnabledForUiHost");this.Oa.ka("UiHostSupportsDocRebootFeatures")}fxk(u,P){this.qqb=u;P||this.nmh()}p4k(){this.gP.qIb.ra(G.a.Old,J.a.frame,Object(z.a)(this,this.Old,"populateMruMenu"),96)}Old(u,P,la,Ba,Sa){return 1!==la&&Sa?this.RPk(Sa):32}RPk(u){this.oZi();this.nZi();u.PopulationXML=Af.LYi(this.Nyc+
this.RBd);return 32}oZi(){var u=3;let P=!1;if(this.Nyc&&this.r9h===this.qqb.mGl)n.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),u=this.MId;else{n.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var la=this.gP.RF();this.qqb=this.exk.Uda("File Open opened",!0);this.Nyc&&2!==this.MId&&3!==this.qqb.state?P=!0:(u=this.hrj(this.qqb),v.AFrameworkApplication.Aa&&
v.AFrameworkApplication.Aa.ob.oGa&&td.c()&&u&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(u,!0)),this.Nyc=({Hxk:u}=this.q$i(this.qqb)).returnValue);la=this.gP.RF()-la;n.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:la})}2!==u&&(la={["DisplayState"]:yf[u]},1!==u&&(la.IsStale=P),n.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",la));this.MId=u}hrj(u){let P;try{P=cd.c(u.uJe)}catch(la){P=null,
n.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",la)}return P}nZi(){this.fRd?(n.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.RBd=({oUl:this.fRd}=this.ttk()).returnValue):n.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");n.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.fRd,["NotDisplayingLink"]:!this.RBd})}q$i(u){let P;
1===u.state||0===u.state?(n.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),u=2,P=Af.xFf(this.iFa(2),this.iFa(5))):3===u.state&&u.uJe?(P=this.nsi(u.uJe),u=0):(n.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),P=Af.R0b(this.iFa(1),this.iFa(2)),u=1);return{returnValue:P,Hxk:u}}nsi(u){let P;const la=this.olc.Y0b||"2155708348";if(u.length){P=Af.Q0b("lblRecentDocuments",this.iFa(3));let Ba=0;for(let Sa=0;Sa<u.length;Sa++){const pb=
u[Sa];"FileName"in pb&&"DocumentUrl"in pb&&"Path"in pb&&(P+=Af.M0b("MruButton"+Sa,pb.FileName.toString(),pb.Path.toString(),null,this.olc.wFa,this.olc.u$b,la,pb.DocumentUrl.toString()),pb.IsPinned&&Ba++)}P=Af.$7a("RecentDocumentsMenuSection",Af.V4g,this.iFa(2),P);n.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:u.length,["NumPinnedDocuments"]:Ba})}else P=Af.R0b(this.iFa(0),this.iFa(2)),n.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",
{["Display"]:"Empty MRU"});return P}ttk(){let u;u=!0;let P=this.Dqi;var la=this.Cqi;if(P&&la||!this.gP.tMa)u=!1;else{const Ba=this.iWc.Uda("File Open",!1);3===Ba.state&&(P=Ba.UR,la=Ba.sMa,u=!1)}la=la?String.format(this.iFa(4),la):null;return{returnValue:Af.lri(this.olc.Y0b,la,P),oUl:u}}nmh(){this.gP.v5g.j2(this.olc.A6b)}get gP(){return this.sia.value}get iFa(){return this.Aca.value}get olc(){return this.tYh.value}get Dqi(){return this.UUh.value}get Cqi(){return this.TUh.value}get iWc(){return this.aia.value}get exk(){return this.cZh.value}}
Object(r.a)(cg,"MruRenderer",null,[]);var xh=d(173),Yf=d(453);class Hf{constructor(u,P,la,Ba,Sa,pb,Vb){this.zo=null;this.nsf=!1;this.vOa=this.mcf=0;this.V2h=u;this.Dqb=P;this.TDc=la;this.jUb=Ba;this.qPa=Sa;this.sia=pb;this.aia=new Oa.a(()=>new kf.a(Vb.value,Object(z.a)(this,this.VEa,"getMoreInfoEventReceived")))}$8a(){!this.zo&&this.IJe.tMa?this.iWc.Uda("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}VEa(u){if(!this.zo&&3===u.state)this.zo=u;else if(2===u.state){this.nsf?n.ULS.sendTraceTag(24904471,
202,10,"After second try GetMoreResult still fail."):(this.iWc.Uda("NewDocumentFromStream",!0),this.nsf=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.mcf=(new Date).getTime();var u=this.M3i.a1d;if(null===u)this.Dqb(null);else{var P=this.TDc.menuItemId,la=this.TDc.mV,Ba=this.TDc.PBl,Sa=this.TDc.T3i;this.vOa="streamBase64"===Ba?Sa.length/1024:0;n.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.k3,this.vOa);var pb=(new Date).getTime();u=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",
u,lb.a.Qe(this.Axa),lb.a.Qe(P),lb.a.Qe(this.k3),lb.a.Qe(v.AFrameworkApplication.lcid.toString()),lb.a.Qe(pb.toString()),lb.a.Qe(la),lb.a.Qe(v.AFrameworkApplication.canary),v.AFrameworkApplication.gh,lb.a.Qe(Ba));u+="&"+v.AFrameworkApplication.qUa();v.AFrameworkApplication.RVa&&(u+="&"+v.AFrameworkApplication.eWc());(P=this.zo?this.zo.UR:null)&&(u+="&DestinationUrl="+lb.a.Qe(P));this.IJe.Vlc.zj(u,2,Sa,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(z.a)(this,this.Kxk,"newDocumentFromStreamSuccessHandler"),
Object(z.a)(this,this.Jxk,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}Kxk(u){if(u&&u.data&&u.data.ee){var P;({Nu:P}=cd.d(u.data.ee)).returnValue?(u=P,u.StatusCode!==xh.a.mx&&u.StatusCode!==xh.a.D3b?(n.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.k3,this.vOa,u.StatusCode),this.Dqb(null)):u.NewDocumentUrl&&""!==u.NewDocumentUrl?(n.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",
this.k3,this.vOa,(new Date).getTime()-this.mcf),this.V2h(u.NewDocumentUrl)):(n.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.k3,this.vOa),this.Dqb(null))):(n.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.k3,this.vOa,{["ResponseData"]:Yf.a.xwc(u.data.ee)}),this.Dqb(null))}else n.ULS.sendTraceTag(24904473,202,10,
"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.k3,this.vOa),this.Dqb(null)}Jxk(u){u&&u.data&&n.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.k3,this.vOa,u.data.status);this.Dqb(null)}get k3(){switch(this.IJe.Wfa){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get M3i(){return this.jUb.value}get Axa(){return this.qPa.value}get IJe(){return this.sia.value}get iWc(){return this.aia.value}}
Object(r.a)(Hf,"NewDocumentFromStreamOperation",null,[]);class ji{constructor(u,P,la,Ba){this.jUb=u;this.qPa=P;this.sia=la;this.bZh=Ba}create(u,P,la){return new Hf(u,P,la,this.jUb,this.qPa,this.sia,this.bZh)}}Object(r.a)(ji,"NewDocumentFromStreamOperationFactory",null,[861]);var Qi=d(252);class ah{get name(){return"Common.App.NewAndOpen.UX"}Yb(u){u.register(ji,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").ma().oa(()=>
new ji(new Oa.a(()=>v.AFrameworkApplication.Aa.ob.N$d()),new Oa.a(()=>v.AFrameworkApplication.Axa),new Oa.a(()=>u.qb("Common.INewAndOpenCommonHelpers")),new Oa.a(()=>u.qb("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){v.AFrameworkApplication.fa.ff(()=>{this.AFa()})}AFa(){const u=Qi.a.Lt(w.a.instance.Ia("Common.INewAndOpenCommonHelpers")),P=Qi.a.Lt(w.a.instance.Ia("Common.IEventEmitter<Common.IGetMoreInfoResult>"));v.AFrameworkApplication.Axa&&sh.Task.WAA.call(null,u,P).continueWith(()=>
{const la=new Eg(new Oa.a(()=>u.result),new Oa.a(()=>v.AFrameworkApplication.Aa.ob.N$d()),new Oa.a(()=>P.result),new Oa.a(()=>v.AFrameworkApplication.Aa.ob.O$d().Y0b||"1959943459"),new Oa.a(()=>v.AFrameworkApplication.Axa),new Oa.a(()=>v.AFrameworkApplication.XZj));la.vb();la.Gqc()});if(v.AFrameworkApplication.JTe){const la=Qi.a.Lt(w.a.instance.Ia("Common.IEventEmitter<Common.IMruResult>"));sh.Task.WAA.call(null,u,P,la).continueWith(()=>{const Ba=new cg(new Oa.a(()=>u.result),new Oa.a(()=>hd.RJk),
new Oa.a(()=>v.AFrameworkApplication.Aa.ob.O$d()),new Oa.a(()=>v.AFrameworkApplication.QJk),new Oa.a(()=>v.AFrameworkApplication.PJk),new Oa.a(()=>P.result),new Oa.a(()=>la.result),v.AFrameworkApplication.fa);Ba.p4k();Ba.nmh()})}}dispose(){}}Object(r.a)(ah,"UXPackageManager",null,[2,3,107]);class Kd extends Wa.StandardDialog{constructor(){super();this.Ad=0;this.Oe(1,CommonUIStrings.l_DialogClose)}Av(u){this.Ty(u,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}UDa(u){this.Ty(u,
CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(r.a)(Kd,"ErrorDialog",Wa.StandardDialog,[873]);class Qd{R3f(){n.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const u=new Bb.a;u.Og("api.onedrive.com");return u.task}}Object(r.a)(Qd,"OneDriveConsumerEndpointHelper",null,[812]);var Gg=d(172);class Sg{constructor(u,P,la,Ba){this.K5a=this.loa=null;this.mOd=this.oOd=!1;this.Jqb=null;this.Oa=u;this.job=P;this.l5a=la;this.eB=Ba}get eBf(){return this.job}get fa(){return this.Oa}Ayb(){this.Jqb||
(this.Jqb=this.oJb?si.a.create(this.oJb,null,null,null,!1):null);return this.Jqb}setup(u){this.K5a=u;this.oOd||this.mOd?this.oOd&&this.K5a&&this.K5a(!0):(u=this.Ayb())?(this.mOd=!0,u.IGa.continueWith(P=>{this.tFk(P)}),Sc.a.oy(u)):(n.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.K5a(!1))}pMe(u){n.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",u.ej?u.ej.toString():"No error detail.")}tFk(u){this.mOd=!1;
if(u.Dm)this.pMe(u),this.K5a(!1);else try{this.oOd=!0,n.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.Yhe(),n.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.K5a(!0)}catch(P){n.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",P.toString()),this.K5a(!1)}}Fuc(u){this.loa=u;this.l5a?n.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(n.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),
this.setup(Object(z.a)(this,this.HKe,"onApiReady")))}HKe(u){u?this.w4c():this.Kt()}Kt(){this.eB().Av(Gg.a.oJk)}onSuccess(u){n.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.loa&&this.loa(!0,u)}dispose(){this.Jqb&&this.Jqb.dispose()}}Object(r.a)(Sg,"AOneDriveFilePickerApiManager",null,[901,107]);class Wh extends Sg{constructor(u,P,la,Ba,Sa,pb){super(P,la,Ba,pb);this.Bl=null;this.zca=u;this.E7h=Sa}get oJb(){return this.fa.Ha("OneDriveApiUrl")}start(u,P){this.Bl=
u;this.Fuc(P)}Yhe(){WL.init(1===this.eBf||2===this.eBf?{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}Fuc(u){this.loa=u;!this.l5a&&this.zca.rme?(n.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(z.a)(this,this.HKe,"onApiReady"))):(n.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.E7h())}w4c(){try{n.ULS.sendTraceTag(17909027,
352,50,"Launching file dialogue"),WL.fileDialog(this.Bl).then(Object(z.a)(this,this.onSuccess,"onSuccess"),Object(z.a)(this,this.Kz,"onFailure"))}catch(u){n.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",u,u.stack),this.Kt()}}Kz(u){if(u&&u.error){if("user_canceled"===u.error.code){n.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}n.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",u.error.code,u.error.message)}else n.ULS.sendTraceTag(17909060,
352,50,"File Dialog returned with no response");this.loa&&this.loa(!1,u);this.Kt()}}Object(r.a)(Wh,"OneDriveFilePickerApiManagerV5",Sg,[]);class Bg extends Sg{constructor(u,P,la,Ba,Sa){super(u,P,la,Ba);this.FBc=this.Rof=null;this.TXh=Sa;this.options={};this.options.clientId=this.fa.Ha("OneDriveApiV7ClientId");this.options.cancel=Object(z.a)(this,this.Kwd,"toggleHostDivVisibility")}get oJb(){return this.fa.Ha("OneDriveApiV72Url")}start(u,P){this.FBc=P;const la=this.TXh.R3f();la.continueWith(()=>{n.ULS.sendTraceTag(24134241,
352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.Rof=la.result;this.Fuc((Ba,Sa)=>{this.Kwd();u(Ba,Sa)})},3);la.continueWith(()=>{n.ULS.sendTraceTag(24134242,352,15,la.ej.message);this.Kwd()},5)}Yhe(){this.options.success=u=>{const P={};P.data=u;this.onSuccess(P)};this.options.error=u=>{const P={};P.error=u;this.Kz(P)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.Rof;this.options.advanced.iframeParentDiv=this.FBc}w4c(){try{n.ULS.sendTraceTag(22090007,
352,50,"Launching OneDrive file picker dialog"),this.Kwd(),OneDrive.open(this.options)}catch(u){n.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",u.message),this.Kt()}}Kz(u){this.loa&&this.loa(!1,u);this.Kt()}Kwd(){this.FBc.style.visibility="hidden"===this.FBc.style.visibility?"":"hidden"}}Object(r.a)(Bg,"OneDriveFilePickerApiManagerV7",Sg,[]);class oh extends Sg{constructor(u,P,la,Ba){super(u,P,la,Ba);this.fUh=u;this.options={};this.options.advanced={};this.options.action=
"query";this.options.clientId=this.fa.Ha("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get oJb(){return this.fa.Ha("OneDriveApiV72Url")}start(u,P,la,Ba){this.options.advanced.iframeParentDiv=la;this.options.advanced.endpointHint=Ba;this.options.cancel=P;this.fUh.ka("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent=
{});this.Fuc(u)}Fuc(u){this.loa=u;this.l5a?n.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(n.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(z.a)(this,this.HKe,"onApiReady")))}Yhe(){this.options.success=u=>{const P={};P.data=u;this.onSuccess(P)};this.options.error=u=>{const P={};P.error=u;this.Kz(P)}}w4c(){try{n.ULS.sendTraceTag(23881879,216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(u){n.ULS.sendTraceTag(23881880,
216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",u.message,u.stack),this.Kt()}}pMe(u){n.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",u.ej?u.ej.toString():"No error detail.");Sc.a.K6k(this.oJb);this.Jqb=null}Kt(){this.eB().UDa(Gg.a.Jel)}Kz(u){this.loa&&this.loa(!1,u)}}Object(r.a)(oh,"OneDriveFilePickerApiManagerV72",Sg,[]);class Yj{constructor(u){this.olsSessionId=this.value=this.key=null;this.olsSessionId=u}}Object(r.a)(Yj,"IExtraData",null,
[]);class Gh extends oh{constructor(u,P,la,Ba){super(u,P,la,Ba);this.options.advanced.filter=u.Ha("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=v.AFrameworkApplication.qBf;u.ka("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=u.Ha("OneDriveApiV72CommandMode")||"none");u.ka("OneDriveApiV72QosExtraDataEnabled")&&(this.options.qosExtradata=new Yj(v.AFrameworkApplication.userSessionId))}get oJb(){return this.fa.Ha("OneDriveApiV72Url")}w4c(){try{n.ULS.sendTraceTag(26071182,
352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",v.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(u){n.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",u.message,u.stack),this.Kt()}}}Object(r.a)(Gh,"OneDriveFilePickerApiOpenManagerV72",
oh,[]);class Xh{constructor(u){this.lw=null;this.hi=u;this.jNd=3}R3f(){this.lw=new Bb.a;n.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.YYe();return this.lw.task}YYe(u=null){const P=String.format("GetMoreInfoHandler.ashx?{0}",v.AFrameworkApplication.c9a);this.hi.iW(P,1,null,u,["PersonalFileStorageUrl","X-NewKey"],2,Object(z.a)(this,this.Ilj,"getMoreInfoSucceeded"),Object(z.a)(this,this.Glj,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,
"21")}Glj(u){if(u.data.Ke===xh.a.$oc&&"X-NewKey"in u.data.yj){n.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const P={};P["X-Key"]=u.data.yj["X-NewKey"];this.YYe(P)}else 0<this.jNd?(n.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.jNd),this.jNd--,this.YYe()):(n.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),
this.lw.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}Ilj(u){"PersonalFileStorageUrl"in u.data.yj&&""!==u.data.yj.PersonalFileStorageUrl?(n.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.lw.Og(u.data.yj.PersonalFileStorageUrl)):(n.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.lw.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}
Object(r.a)(Xh,"OneDriveForBusinessEndpointHelper",null,[812]);var Yg=d(359);class dg{constructor(){this.Da=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}Yb(u){this.Da=u;this.Da.register(Wh,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").ma().oa(()=>new Wh(Yg.a.instance,v.AFrameworkApplication.fa,v.AFrameworkApplication.WSa,v.AFrameworkApplication.ZQ,v.AFrameworkApplication.MCh,()=>
new Kd));v.AFrameworkApplication.OBb?this.Da.register(812,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ma().oa(()=>new Qd):this.Da.register(812,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ma().oa(()=>new Xh(v.AFrameworkApplication.Me));this.Da.register(Bg,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").ma().oa(()=>new Bg(v.AFrameworkApplication.fa,v.AFrameworkApplication.WSa,v.AFrameworkApplication.ZQ,()=>new Kd,this.Da.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));
this.Da.register(oh,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").ma().oa(()=>new oh(v.AFrameworkApplication.fa,v.AFrameworkApplication.WSa,v.AFrameworkApplication.ZQ,()=>new Kd));this.Da.register(Gh,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").ma().oa(()=>new Gh(v.AFrameworkApplication.fa,v.AFrameworkApplication.WSa,v.AFrameworkApplication.ZQ,()=>new Kd))}static main(){m.a.instance.Ac(new dg)}}Object(r.a)(dg,"PackageManager",null,[2,3]);var Od=d(170),
We=d(184);class Zj{constructor(u){this.Hdb=this.hEe=this.igb=this.T$c=0;this.JCe=this.mOg=null;u?(this.wb=u,this.Z3b=Date.now,this.lNi(),this.d4k()):n.ULS.sendTraceTag(520955213,209,10,"Can not initialize PenMinutesManager because TaskManager is null")}Sml(){this.mOg="Office.PowerPoint.Online.Data.Activity.PenInputMinutes"}d4k(){window.document.body.addEventListener("pointerenter",Object(z.a)(this,this.WFk,"onPointerEnter"));window.document.body.addEventListener("pointerleave",Object(z.a)(this,this.XFk,
"onPointerLeave"));w.a.instance.Ia("Common.App.VisibilityManagement.IVisibilityManager").execute(u=>{u.lJc(Object(z.a)(this,this.E9b,"handleVisibilityChange"))})}WFk(u){"pen"!==u.pointerType||this.igb||(this.igb=Math.floor(this.Z3b()/1E3),this.igb<=this.T$c&&(this.igb=this.T$c),this.hEe=0)}XFk(){this.zfg()}zfg(){const u=Math.ceil(this.Z3b()/1E3);this.igb&&u>this.T$c&&(this.hEe=u,this.Hdb+=this.hEe-this.igb);this.T$c=u;this.igb=0}E9b(u,P){0!==P.newState&&this.zfg()}lNi(){this.JCe=new O.a(4,2,6E4,Object(z.a)(this,
this.rck,"logPenUsage"));this.wb.Hb(this.JCe)}rck(){0<this.Hdb&&this.tvh(this.Hdb);this.Hdb=0}tvh(u){const P=new We.a;P.name=this.mOg;const la=[];(u=Od.a.E_("PenInputSec",u.toString(),3))&&Array.add(la,u);P.dataFields=la;B.a.sendActivityEvent(P)}dispose(){0<this.Hdb&&this.tvh(this.Hdb);this.wb.Lg(this.JCe)}}Object(r.a)(Zj,"PenMinutesManager",null,[811]);class ij{constructor(){this.TLd=this.Da=null}get name(){return"Common.App.PenMinutesManager"}Yb(u){this.Da=u;const P=v.AFrameworkApplication.Ae;this.Da.register(811,
"Common.App.PenMinutesManager.IPenMinutesManager").ma().oa(()=>new Zj(P))}init(){this.TLd=this.Da.resolve("Common.App.PenMinutesManager.IPenMinutesManager")}dispose(){this.TLd&&this.TLd.dispose()}static main(){m.a.instance.Ac(new ij)}}Object(r.a)(ij,"PenMinutesManagerPackage",null,[2,3]);class Wd extends Wa.StandardDialog{constructor(u,P){super();this.Lqb=!1;this.PK=null;this.Ca=u;this.cUb=P;this.T1a=!1}Av(u,P,la){this.PK=P;this.Lqb=la;n.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",
u,la);u=this.zYd(u);0===u?(this.Ad=6,this.Oe(0,CommonUIStrings.l_DialogClose)):(this.Ad=0,this.Oe(1,CommonUIStrings.l_DialogClose));0===u&&n.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.Ty(Gg.a.Iel,this.Bfj(u),this.Afj(u,P),Object(z.a)(this,this.jXe,"retryDialogHandler"),!0)}jXe(u){1===u?(n.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.PK?this.Ca.Ka(G.a.KMb,2,[this.PK,this.Lqb]):this.Ca.processAction(G.a.KMb,2)):n.ULS.sendTraceTag(8194011,
216,50,"User cancel the error dialog.")}zYd(u){return 0>u||6<u?(n.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",u),0):u}Afj(u,P){u=this.zYd(u);return this.cUb?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,P),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][u]:[CommonUIStrings.l_FailToSaveFile,
CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,P),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][u]}Bfj(u){u=this.zYd(u);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][u]}}
Object(r.a)(Wd,"ErrorRetryDialog",Wa.StandardDialog,[905]);class ki{constructor(u,P){this.Oa=u;this.Ca=P;this.cUb=this.Oa.ka("SaveToHostWithExtraCharsInFileName")}create(){return new Wd(this.Ca,this.cUb)}}Object(r.a)(ki,"ErrorRetryDialogFactory",null,[879]);class xi extends Ke.a{constructor(u,P,la,Ba,Sa,pb,Vb=null){super();this.LV=null;this.Ca=P;this.Nba=Ba;this.hCa=pb;this.Oa=u;this.eB=Sa;this.Xh=la;this.cUb=this.Oa.ka("SaveToHostWithExtraCharsInFileName");this.Bl=Vb;this.Oe(1,CommonUIStrings.l_SaveButtonLabel)}get Aa(){return this.Xh}RTf(u,
P){this.dF(1,!!u&&u!==P);this.LV=document.getElementById(xi.D_f);Be.a.addHandler(this.LV,"change",Object(z.a)(this,this.zid,"onFileNameChange"));Be.a.addHandler(this.LV,"input",Object(z.a)(this,this.zid,"onFileNameChange"));this.LV.focus()}C_f(u){return this.cUb?(new RegExp("["+this.mYf('\\/:*?"<>|')+"]")).test(u):(new RegExp("["+this.mYf('\\/:*?"<>|#{}%~&')+"]")).test(u)}mYf(u){return u.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}Wee(){const u=lb.a.iH(v.AFrameworkApplication.du.rx);this.dF(1,
!!this.LV&&""!==this.LV.value&&this.LV.value!==u)}zid(){this.LV&&window.setTimeout(()=>{this.Wee()},0)}vSc(u,P){if(1!==u)n.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{u=P[xi.D_f];P=xi.sdh in P?P[xi.sdh]:!1;n.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",lb.a.bmh(u),P);const la=lb.a.AQ(v.AFrameworkApplication.fileName);(u=u?u.trim():null)&&""!==u&&""!==la||1===this.Aa.state?
this.C_f(u)?this.eB.create().Av(1,u,P):this.hCa.Y1(u+la,P,this.Bl):this.eB.create().Av(2,u,P)}}dispose(){this.LV&&(Be.a.removeHandler(this.LV,"change",Object(z.a)(this,this.zid,"onFileNameChange")),Be.a.removeHandler(this.LV,"input",Object(z.a)(this,this.zid,"onFileNameChange")),this.LV=null);super.dispose()}}xi.D_f="txtFileName";xi.sdh="chkOverwrite";Object(r.a)(xi,"FileNameDialogBase",Ke.a,[]);class Pg{static get sg(){return Ke.a.VC(Pg.Fo,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}
Pg.Fo="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(r.a)(Pg,"FileNameDialogHtml",null,[]);class Ej extends xi{constructor(u,P,la,Ba,Sa,pb){super(u,P,la,Ba,Sa,pb);this.sg=Pg.sg;this.kg="FileNameDialog-SaveAsToHost"}ika(u,P){const la=lb.a.iH(v.AFrameworkApplication.du.rx);P={["txtFileName"]:u||la,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:P};this.pj(CommonUIStrings.L_SaveAs,Object(z.a)(this,this.vSc,"fileNameDialogHandler"),P);this.RTf(u,la)}}Object(r.a)(Ej,"FileNameDialog",xi,[904]);class Hh{constructor(u,P,la,Ba,Sa,
pb){this.Ca=P;this.Oa=u;this.Nba=Ba;this.hCa=pb;this.eB=Sa;this.Xh=la}create(){return new Ej(this.Oa,this.Ca,this.Xh,this.Nba,this.eB,this.hCa)}}Object(r.a)(Hh,"FileNameDialogFactory",null,[878]);class gh{constructor(u,P,la){this.hCa=la;this.JEd=P;this.Oa=u}vb(){2===v.AFrameworkApplication.Aa.ob.zk?v.AFrameworkApplication.Ra.ra(G.a.KMb,J.a.frame,Object(z.a)(this,this.Kth,"saveAsToHostActionDispatcher"),4):v.AFrameworkApplication.Ra.ya(G.a.KMb,J.a.frame,Object(z.a)(this,this.Kth,"saveAsToHostActionDispatcher"))}Kth(u,
P,la,Ba,Sa){return P.contextId!==J.a.frame||u!==G.a.KMb?2:this.Oa.ka("SaveAsToHostBrsIsEnabled")?1===la?x.SessionStatusManager.instance.gla||v.AFrameworkApplication.VQ?8:32:2===la?(n.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),u=this.JEd.create(),Sa&&Object.getType(Sa)===Array&&2===Sa.length?u.ika(Sa[0],!!Sa[1]):u.ika(null,!1),32):8:8}}Object(r.a)(gh,"SaveAsToHostActor",null,[]);class Ie{constructor(u,P,la,Ba,Sa,pb,Vb,Bc){this.Yn=null;this.Lqb=this.K2=
!1;this.gCa=this.Bl=this.PK=null;this.Oa=P;this.lCa=this.Oa.appSettings.SaveAsToHostWebServiceBase;this.gjf=Ba;this.fra=Sa;this.hi=la;this.eB=pb;this.ii=Bc;this.Xh=Vb;this.Ca=u;this.cBa=P.Ha("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}kuc(){1!==this.Xh.state&&(this.Yn=this.fra(),this.Yn.message=CommonUIStrings.l_CommentProgressTooltip,this.Yn.Ad=5,this.Yn.Ir=!1,this.Yn.Dpa(CommonUIStrings.l_DefaultDialogTitle,null,null))}$Y(u=0){1!==this.Xh.state&&this.eB.create().Av(u,lb.a.iH(this.PK),
this.Lqb)}Qjb(){const u=this.Oa.appSettings.BreadcrumbFolderUrl;n.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");cb.a.En(u,cb.a.Iba(3),void 0,"UploadToHostManager.RedirectToFolder")}Pjb(u){let P=!1,la=!1;this.Oa&&(P=this.Oa.ka("SaveACopyIsEnabledForUiHost"),la=this.Oa.ka("UiHostSupportsDocRebootFeatures"));n.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",u,P,la);if(P&&la){n.ULS.sendTraceTag(51245197,
216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Ba={};Ba[Ee.a.FLb]="1";Ba[Ee.a.documentUrl]=u;Ba[Ee.a.reason]=Og.a.$Xe;v.AFrameworkApplication.KT().execute(Sa=>{Sa.sendMessage(Jd.a.XDa,Ba)})}else P&&!la&&v.AFrameworkApplication.G9?cb.a.En(u,cb.a.Iba(4),void 0,"UploadToHostManager.RedirectToEditUrl"):cb.a.En(u,cb.a.Iba(3),void 0,"UploadToHostManager.RedirectToEditUrl")}Y1(u,P,la=null){n.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.gjf&&
!this.gjf()&&this.hi&&(this.ii&&(this.gCa=this.ii.Ii("DialogShown","SaveAsToHostUploadTime")),this.kuc(),this.Lqb=P,this.PK=u,(this.Bl=la)&&"true"===this.Bl.SkipSaveToHost?this.MRc():this.P3())}P3(){32!==this.Ca.processAction(G.a.W0a,1)?(n.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.MRc()):this.Ca.Ka(G.a.W0a,2,[()=>{n.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.MRc()},(u,P)=>{n.ULS.sendTraceTag(18989380,
219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.$Y(P)}])}XIk(u){this.v9a();this.K2=!1;if(u&&u.data&&u.data.ee)if(({Nu:P}=cd.d(u.data.ee)).returnValue)if(u=P,u.StatusCode!==xh.a.mx&&u.StatusCode!==xh.a.D3b){n.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var P={};P.FailureReason=u.StatusCode.toString();P.ExtraInfo=u.ExtraInfo;this.Gya(P);this.$Y(parseInt(u.ExtraInfo))}else{n.ULS.sendTraceTag(8194050,216,50,
"UploadToHost execute success.");this.sWe();try{u.NewDocumentUrl&&""!==u.NewDocumentUrl?this.Pjb(u.NewDocumentUrl):this.Qjb()}catch(la){n.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",la.toString())}this.foc()}else n.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Yf.a.xwc(u.data.ee)}),this.Gya({["FailureReason"]:"Failed to deserialize response"}),this.$Y();else n.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.Gya({["FailureReason"]:"null response"}),this.$Y()}WIk(u){5!==u.data.status&&12!==u.data.status||this.K2?(n.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:u.data.status,["HttpStatus"]:u.data.Ke}),this.Gya({["FailureReason"]:u.data.Ke.toString()}),this.v9a(),this.$Y(),this.foc()):(n.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.K2=!0,this.Bl&&"true"===this.Bl.SkipSaveToHost?this.MRc():this.P3())}v9a(){this.Yn&&
(this.Yn.close(),this.Yn=null)}foc(){this.gCa&&(this.gCa.stop(),this.gCa=null)}sWe(){this.Bl&&"VersionHistory"===this.Bl.SaveEntryPoint&&this.Ca.processAction(G.a.Dpd,2)}Gya(u){this.Bl&&"VersionHistory"===this.Bl.SaveEntryPoint&&this.Ca.Ka(G.a.tWe,2,u)}MRc(){let u=this.lCa+this.cBa;u=Bd.a.Ti(u,"qs",lb.a.Qe(v.AFrameworkApplication.gh));u=Bd.a.Ti(u,"n",lb.a.Qe((new Date).getTime().toString()));u=Bd.a.Ti(u,"ov",lb.a.Qe(this.Lqb.toString()));u=Bd.a.Ti(u,"fn",lb.a.Qe(this.PK));this.Bl&&this.Bl.FileDownloadUrl&&
(u=Bd.a.Ti(u,"furl",lb.a.Qe(this.Bl.FileDownloadUrl)));this.hi.zj(u,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(z.a)(this,this.XIk,"onUploadFinished"),Object(z.a)(this,this.WIk,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(r.a)(Ie,"UploadToHostManager",null,[874]);var eg=d(562);class yi{constructor(){this.Da=null}get name(){return"Common.App.SaveAsToHost"}init(){v.AFrameworkApplication.fa.ff(Object(z.a)(this,this.en,"onFullAppSettingsReady"))}en(){v.AFrameworkApplication.fa.ka("SaveAsToHostBrsIsEnabled")&&
this.Da.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").vb()}Yb(u){this.Da=u;this.Da.register(ki,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").oa(()=>new ki(v.AFrameworkApplication.fa,v.AFrameworkApplication.Ra)).ma();this.Da.register(Ie,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").oa(()=>new Ie(v.AFrameworkApplication.Ra,v.AFrameworkApplication.fa,v.AFrameworkApplication.Me,()=>v.AFrameworkApplication.Yg,
()=>(new eg.a).create(),u.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),v.AFrameworkApplication.Aa,v.AFrameworkApplication.Aa.vV)).ma();this.Da.register(Hh,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").oa(()=>new Hh(v.AFrameworkApplication.fa,v.AFrameworkApplication.Ra,v.AFrameworkApplication.Aa,v.AFrameworkApplication.Aa.ob,u.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),u.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ma();
this.Da.register(gh,"Common.App.SaveAsToHost.SaveAsToHostActor").oa(()=>new gh(v.AFrameworkApplication.fa,u.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),u.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ma()}dispose(){}static main(){m.a.instance.Ac(new yi)}}Object(r.a)(yi,"SaveAsToHostPackage",null,[2,3]);class Fj extends Wa.StandardDialog{constructor(){super();this.Ad=0;this.Oe(1,CommonUIStrings.l_DialogClose)}Av(u,P){this.pUf(u,P,Gg.a.Kel)}pUf(u,P,la){n.ULS.sendTraceTag(25180161,
216,10,"Show upload error dialog with error code {0}.",la);this.Ty(la,u,P,null)}UDa(u,P){n.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.Ty(Gg.a.Mel,u,P,null,!0)}}Object(r.a)(Fj,"ErrorDialog",Wa.StandardDialog,[886]);class Yh{static get sg(){return Ke.a.VC(Yh.Fo,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}Yh.Fo="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(r.a)(Yh,"FileNameDialogHtml",null,[]);class ei extends xi{constructor(u,P,la,Ba,Sa,pb,Vb,Bc){super(u,P,la,Ba,Sa,pb,Bc);this.HOa=this.NNd=this.AI=null;this.rti=CommonUIStrings.l_SaveToAnotherFolder;this.sg=Yh.sg;this.kg="FileNameDialog-SaveToSharePoint";this.mYb=Vb;this.I3h=Bc}ika(u){const P=lb.a.iH(v.AFrameworkApplication.du.rx),la=v.AFrameworkApplication.breadcrumbFolderName,Ba=v.AFrameworkApplication.breadcrumbBrandName,Sa={["txtFileName"]:u||P};let pb=CommonUIStrings.L_SaveAs;2===v.AFrameworkApplication.Aa.ob.zk&&
(pb=CommonUIStrings.L_SaveACopy);this.pj(pb,Object(z.a)(this,this.vSc,"fileNameDialogHandler"),Sa);this.RTf(u,P);this.q3d.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");v.AFrameworkApplication.fa.ka("HideSaveToAnotherFolderButtonforUIHost")||(this.AI=document.getElementById("anotherFolder"),u=document.getElementById("folderLocation"),this.NNd=Ha.a.tBf(u,this.AI,"anotherFolderDescribedBy",""),this.AI.className="WACButton WACDialogButtonNormal",
u=!1,la&&la.length?(this.Twf(this.AI,this.NNd,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Ba,la)),u=this.Qai(Ba,la)):this.Twf(this.AI,this.NNd,CommonUIStrings.l_CurrentOnlineFolder),this.pci(this.AI),this.Sai(this.AI),u?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.AI,"SaveToAnotherLocationTwo"),n.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.AI,"SaveToAnotherLocationOne"),
Be.a.addHandler(this.AI,Ca.a.click,Object(z.a)(this,this.VMe,"onSaveToAnotherLocationClick")),Be.a.addHandler(this.AI,Ca.a.Bf,Object(z.a)(this,this.Kah,"onSaveToAnotherLocationKeyDown")))}Qai(u,P){let la;la=!1;const Ba=document.getElementById("currentLocation");Ba.innerText="";const Sa=this.s9f(Ba,u),pb=this.s9f(Ba,P);let Vb=255,Bc=255;255<Sa+pb&&(Vb=Math.max(238,408-Sa),Bc=Math.max(170,408-pb),la=!0);this.Odi(Ba,u,Bc,P,Vb);return la}s9f(u,P){const la=document.createElement("div");la.innerText=P;
la.style.visibility="hidden";u.appendChild(la);P=la.clientWidth;u.removeChild(la);return P}Odi(u,P,la,Ba,Sa){P&&(this.Swf(u,P,la),this.Edi(u));Ba&&this.Swf(u,Ba,Sa)}Swf(u,P,la){const Ba=document.createElement("div");Ba.innerText=P;Ba.title=P;Ba.className="SaveToAnotherFolderBreadcrumb";Ba.style.maxWidth=la.toString()+"px";u.appendChild(Ba)}Edi(u){const P=document.createElement("span");P.id="FolderSeparator";const la=document.createElementNS("http://www.w3.org/2000/svg","svg");la.setAttribute("class",
"SeparatorCaret");const Ba=document.createElementNS("http://www.w3.org/2000/svg","polygon");Ba.setAttribute("points","1 4 1 11 5 7.5");la.appendChild(Ba);P.appendChild(la);u.appendChild(P)}Twf(u,P,la){la=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,la);P&&(P.innerText=la);u.tabIndex=0;u.setAttribute(Ha.a.hf,Ha.a.Ju)}Sai(u){const P=document.createElement("span");P.id="anotherFolderText";P.innerText=this.rti;P.className="AnotherFolderTextSpan";u.appendChild(P)}pci(u){const P=
document.createElement("span");P.className="cui-img-cont-float cui-img-16by16 ";this.HOa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.HOa.setAttribute("class","FolderIconSVG");const la=document.createElementNS("http://www.w3.org/2000/svg","path");la.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.HOa.appendChild(la);P.appendChild(this.HOa);u.appendChild(P)}Kah(u){!u||u.keyCode!==
oa.a.Dp&&u.keyCode!==oa.a.sRb||this.VMe(u)}VMe(){if(this.LV){const u=lb.a.AQ(v.AFrameworkApplication.fileName);let P=this.LV.value;this.hide();P&&""!==P&&""!==u||1===this.Aa.state?(""!==u&&(P+=u),this.C_f(P)?this.eB.create().Av(1,P,!1):this.mYb.start(P,this.I3h)):this.eB.create().Av(2,P,!1)}}nyi(u){this.AI&&this.HOa&&(u?(this.AI.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.AI,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.HOa,"DisabledFolderIconSVG")):(this.AI.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.AI,
"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.HOa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.AI,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.HOa,"DisabledFolderIconSVG"))))}Wee(){super.Wee();this.nyi(!!this.LV&&""!==this.LV.value)}dispose(){this.AI&&(Be.a.removeHandler(this.AI,Ca.a.click,Object(z.a)(this,this.VMe,"onSaveToAnotherLocationClick")),Be.a.removeHandler(this.AI,Ca.a.Bf,Object(z.a)(this,this.Kah,"onSaveToAnotherLocationKeyDown")),this.AI=
null);super.dispose()}}Object(r.a)(ei,"FileNameDialog",xi,[907]);var Hi=d(1245),yh=d(1246),La=d(937),sb=d(223);class Ob{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(r.a)(Ob,"SaveAsDialogInput",null,[]);class pc{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(r.a)(pc,"SaveLocation",null,[]);var Kc=d(89);class Gd{constructor(u,P,la,Ba,Sa,pb,Vb,Bc,Yc){this.fJd=null;this.PK="";this.mYb=u;this.eB=
P;this.Bl=Yc;this.hCa=la;this.Xh=Sa;this.uF=Ba;this.Z6a=Vb;this.yrb=Bc;pb&&(this.fJd=new Oa.a(()=>new kf.a(pb.value,null)))}Aej(){const u=new Hi.a(yh.a.Ml());u.$("type","currentHost");return Object.assign(new pc,{folderName:this.uF.breadcrumbFolderName,friendlyPath:this.uF.breadcrumbBrandName,properties:u})}f3j(u){return!!u&&"ClassicMru"===u.type&&!!u.service_info&&!!u.service_info.service_id&&-1!==u.service_info.service_id.indexOf("SHAREPOINT")}csj(){if(!this.fJd||!this.Z6a)return null;var u=this.fJd.value.Uda("SaveAsToSharePointDialog",
!1);if(!u||3!==u.state||!u.W4g)return null;u=u.W4g;const P=new I.a;let la=0,Ba=0;for(var Sa=0;Sa<u.length;Sa++){var pb=u[Sa];if(!this.f3j(pb))continue;la++;if(!pb.sharepoint_info)continue;const Vb=pb.url,Bc=pb.sharepoint_info.site_url,Yc=pb.title;pb=La.b(pb,v.AFrameworkApplication.isRtl);if(!(Vb&&Bc&&Yc&&pb))continue;Ba++;const gd=new Hi.a(yh.a.Ml());gd.$("type","SharePoint");gd.$("siteUrl",Bc);gd.$("folderUrl",Vb);Ba++;P.add(Object.assign(new pc,{folderName:Yc,friendlyPath:pb,properties:gd}))}Sa=
new Map;Sa.set("NumPlaces",u.length.toString());Sa.set("NumSharepointPlaces",la.toString());Sa.set("placesWithMetadata",Ba.toString());Wf.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",Sa);0<la&&(Ba?.5>1*Ba/la&&Wf.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):Wf.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return P}zfj(){const u=new I.a;u.add(this.Aej());const P=
this.csj();P&&u.addRange(P);return Object.assign(new Ob,{enableMoreLocations:!v.AFrameworkApplication.fa.ka("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.PK,extension:lb.a.AQ(this.uF.rx),saveLocations:u.toArray(),scenario:"SaveToSharePoint"})}XUc(){const u=Object(z.a)(this,this.zfj,"getDialogInput"),P={};P.inputPropsCallback=u;return P}ika(u){this.PK=u;this.PK||(this.PK=String.format(CommonUIStrings.l_SaveACopy_Filename,lb.a.iH(this.uF.rx)));u={["id"]:"SaveAsDialog",["bodyControls"]:this.XUc()};
let P=CommonUIStrings.L_SaveAs;2===this.Xh.ob.zk&&(P=CommonUIStrings.L_SaveACopy);const la=new Ke.a(!1,!1,!0);la.Ad=1;la.kg="SaveAsDialog";la.Oe(1,CommonUIStrings.l_SaveButtonLabel);la.pj(P,Object(z.a)(this,this.Gel,"saveAsDialogHandler"),u)}zwl(u,P){u&&""!==u&&""!==P||1===this.Xh.state?this.e3j()?this.j$j(u,P):(""!==P&&(u+=P),this.mYb.start(u,this.Bl)):(n.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.eB.create().Av(2,u,!1))}j$j(u,P){Wf.Health.instance.recordKpiUsage("SaveACopySFP",
0,"smartfio",null);const la=this.yrb.J0d(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2);this.yrb.pVc(la).then(Ba=>{if(Ba&&0<Ba.length){const Sa=Ba[0][Ee.a.tOk];Ba=Ba[0][Ee.a.XOe];if(""!==Sa&&""!==Ba)this.Z6a.Y1(Ba,u+P,Sa,this.Bl),Wf.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.eB.create().Av(0,u,!1);const pb=sb.a.aA();pb&&(pb.set("SiteUrlAvailable",""===Sa?"false":"true"),pb.set("FolderUrlAvailable",""===Ba?"false":
"true"));Wf.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new Kc.a,{extendedProperties:pb}))}}else this.eB.create().Av(0,u,!1),Wf.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(Ba=>{"Canceled"===Ba?((Ba=sb.a.aA())&&Ba.set("IsCanceled","true"),Wf.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new Kc.a,{extendedProperties:Ba}))):Wf.Health.instance.recordKpiFailure("SaveACopySFP",
Ba,!1,!1,null)})}e3j(){return this.yrb?this.yrb.Kpe():(n.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}Gel(u,P){if(P&&1===u){u=P.fileName;var la=lb.a.AQ(this.uF.rx);P.moreLocationsSelected&&this.zwl(u,la);if(P.locationCallback){var Ba=P.locationCallback();Ba?Ba.properties&&"currentHost"===Ba.properties.ga("type")?this.hCa.Y1(u+la,!1,this.Bl):Ba.properties&&"SharePoint"===Ba.properties.ga("type")?(P=Ba.properties.ga("siteUrl"),Ba=Ba.properties.ga("folderUrl"),this.Z6a.Y1(Ba,
u+la,P,this.Bl)):n.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):n.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else n.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(r.a)(Gd,"ReactSaveAsDialog",null,[907]);class he{constructor(u,P,la,Ba,Sa,pb,Vb,Bc=null,Yc=null,gd=null){this.Ca=P;this.Oa=u;this.Nba=Ba;this.hCa=pb;this.eB=Sa;this.Xh=la;this.isf=Vb;this.B1h=Bc;this.Z6a=Yc;this.yrb=gd}create(u){return this.Xh&&this.Xh.ob.hD?new Gd(this.isf,
this.eB,this.hCa,v.AFrameworkApplication.du,this.Xh,this.B1h,this.Z6a,this.yrb,u):new ei(this.Oa,this.Ca,this.Xh,this.Nba,this.eB,this.hCa,this.isf,u)}}Object(r.a)(he,"FileNameDialogFactory",null,[885]);class Ue{constructor(u,P,la,Ba){this.zo=this.wia=null;this.u4a=u;this.Xh=la;this.r4h=Ba;this.aia=new Oa.a(()=>new kf.a(P.value,Object(z.a)(this,this.VEa,"getMoreInfoEventReceived")))}get pJb(){this.wia||(this.aia.value.Uda("Save As",!0),this.zo&&this.zo.UR&&this.zo.UR.length&&(this.wia=this.Ebe(this.zo.UR)));
return this.wia}start(u){if(!this.pJb)if(v.AFrameworkApplication.breadcrumbFolderUrl&&v.AFrameworkApplication.breadcrumbFolderUrl.length)this.wia=v.AFrameworkApplication.breadcrumbFolderUrl;else return n.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.zo),!1;const P=this.r4h();P.j2e();const la=P.Xbe();if(!la)return n.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),
!1;this.u4a.start((Ba,Sa)=>{P.hide();u(Ba,Sa)},()=>{this.gLe(P)},la,this.wia);return!0}gLe(u){u.hide();n.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}Ebe(u){u=u.toLowerCase();u.endsWith("/")||(u+="/");const P=u.indexOf("/documents/");return-1!==P?u.substring(0,P+1)+"_layouts/15/onedrive.aspx":""}VEa(u){this.zo||3!==u.state||(this.zo=u)}}Object(r.a)(Ue,"OneDriveFilePickerHelper",null,[884]);class Rf extends Ke.a{constructor(){super()}j2e(){this.Yzc="FilePickerDialog";
this.sg="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.kg="PickerDialog-MsoSp";this.showDialog("",null)}Xbe(){return document.getElementById("FilePickerDiv")}VA(){}Iaa(){}}Object(r.a)(Rf,"PickerDialog",Ke.a,[883]);var sf=d(495);class ag{constructor(u,P,la,Ba,Sa,pb,Vb){this.Oa=u;this.JEd=la;this.Ca=P;this.mYb=Ba;this.u4a=Sa;this.hLd=pb;this.lVh=Vb}vb(){const u=this.u4a.Ayb();u?qd.a.Ex||this.Oa.ka("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.Ca.ra(G.a.Jkb,J.a.frame,Object(z.a)(this,
this.duh,"saveToSharePointActionDispatcher"),64):(u.IGa.continueWith(P=>{P.Dm&&this.u4a.pMe(P)}),this.GLc()):n.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}GLc(){Sc.a.zod(Object(z.a)(this,this.duh,"saveToSharePointActionDispatcher"));Sc.a.s5b([new sf.a(G.a.Jkb,J.a.frame,0)],this.u4a.Ayb())}get aCb(){return this.Oa.ka("SaveToAnotherFolderBrsIsEnabled")}get mIf(){return this.Oa.ka("UserCanWriteRelative")}duh(u,P,la,Ba,Sa){return P.contextId!==J.a.frame||
u!==G.a.Jkb?2:this.aCb&&(this.hLd.pJb||this.mIf)?1===la?x.SessionStatusManager.instance.gla||v.AFrameworkApplication.VQ?8:this.lVh()?32:8:2===la?(n.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(Sa&&Sa.SaveEntryPoint&&"VersionHistory"===Sa.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.mIf?(n.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.JEd.create(Sa).ika(null)):(n.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),
this.mYb.start(null,Sa)),32):8:8}}Object(r.a)(ag,"SaveToSharePointActor",null,[]);class xg{constructor(u,P,la,Ba){this.Bl=this.Wnf=null;this.Z6a=u;this.eB=P;this.hLd=la;this.Xh=Ba}start(u,P){n.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.Wnf=u;this.Bl=P;this.hLd.start((la,Ba)=>{this.processResponse(la,Ba)})||this.k2e()}processResponse(u,P){if(u)this.onSuccess(P);else this.Kz(P)}k2e(){1!==this.Xh.state&&this.eB().UDa(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}onSuccess(u){n.ULS.sendTraceTag(23881886,
216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(u&&u.data&&u.data.value&&u.data.value.length&&u.data.value[0].sharePoint){const P=u.data.value[0].sharePoint.url;u=u.data.value[0].sharePoint.listUrl;let la=null;if(P&&(la=u?this.msj(u):this.lsj(P))){this.Z6a.Y1(P,this.Wnf,la,this.Bl);return}n.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!P,!la)}n.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");
this.k2e()}lsj(u){u.endsWith("/")||(u+="/");let P=0;for(let la=0;la<u.length;la++)if("/"===u.charAt(la)&&5===++P)return u.substr(0,la);return null}msj(u){u.endsWith("/")&&(u=u.substring(0,u.length-1));const P=u.lastIndexOf("/");return-1!==P?u.substring(0,P):null}Kz(u){n.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");u&&u.error?n.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",u.error.errorCode,u.error.message):n.ULS.sendTraceTag(23881890,
216,10,"File Dialog returned empty error.");this.k2e()}}Object(r.a)(xg,"SaveToSharePointManager",null,[882]);class Tg{constructor(u,P,la,Ba,Sa,pb,Vb,Bc){this.lCa=u;this.PK=P;this.upb=Ba;this.xMd=pb;this.Iqa=la;this.P7h=Sa;this.cBa=Vb;this.Bl=Bc}execute(u,P){if(!v.AFrameworkApplication.Yg&&v.AFrameworkApplication.Me){var la=this.lCa+this.cBa;la=Bd.a.Ti(la,"fu",lb.a.Qe(this.Iqa));la=Bd.a.Ti(la,"su",lb.a.Qe(this.P7h));la=Bd.a.Ti(la,"fn",lb.a.Qe(this.PK));la=Bd.a.Ti(la,"n",lb.a.Qe((new Date).getTime().toString()));
this.Bl&&this.Bl.FileDownloadUrl&&(la=Bd.a.Ti(la,"furl",lb.a.Qe(this.Bl.FileDownloadUrl)));la=la+"&"+this.xMd;this.upb&&this.upb.length?la=Bd.a.Ti(la,"fnn",lb.a.Qe(this.upb)):n.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");n.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");v.AFrameworkApplication.Me.zj(la,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,u,P,null,void 0,void 0,void 0,void 0,"9")}}}Object(r.a)(Tg,"SharePointSaveAsCaller",
null,[906]);class li{constructor(u){this.Nra=u.appSettings.SaveAsToHostWebServiceBase;this.PK=u.appSettings.FileName;this.cBa=u.Ha("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(u,P,la,Ba){return new Tg(this.Nra,this.PK,u,P,la,v.AFrameworkApplication.gh,this.cBa,Ba)}}Object(r.a)(li,"SharePointUploadCallerFactory",null,[881]);var Li=d(505);class Le{constructor(u,P,la,Ba,Sa){this.Yn=this.BSb=null;this.SAd=!1;this.KNd=this.Iqa=null;this.TQd=P;this.fra=la;this.eB=Ba;this.Xh=Sa;this.Ca=
u}Y1(u,P,la,Ba){this.SAd=!1;n.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.kuc();this.Iqa=u;Ba&&Ba.SaveEntryPoint&&(this.KNd=Ba.SaveEntryPoint);this.BSb=this.TQd.create(u,P,la,Ba);Ba&&"true"===Ba.SkipSaveToHost?this.P3():this.M7i()}M7i(){const u=()=>{n.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.P3()};32!==this.Ca.Ka(G.a.W0a,2,[()=>{n.ULS.sendTraceTag(23881922,
216,50,"Call the force save file change successfully.");this.P3()},u])&&u()}P3(){n.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.BSb.execute(Object(z.a)(this,this.cHk,"onSaveToSharePointUploadFinished"),Object(z.a)(this,this.bHk,"onSaveToSharePointUploadFailed"))}cHk(u){if(u&&u.data&&u.data.ee){var P;if(({Nu:P}=cd.d(u.data.ee)).returnValue)if(P.StatusCode!==xh.a.mx&&P.StatusCode!==xh.a.D3b)n.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",
u.data.status,P.StatusCode),P.StatusCode!==xh.a.Iqh&&this.OUf(u.data.status)||(this.Gya(P.StatusCode.toString()),this.Fvl(P.StatusCode));else{n.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.sWe();try{P.NewDocumentUrl?this.Pjb(P.NewDocumentUrl):this.Qjb()}catch(la){n.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",la.toString())}}else n.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Yf.a.xwc(u.data.ee)}),
this.sQc()||(this.Gya("Failed to deserialize response"),this.iuc())}else n.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.sQc()||(this.Gya("Unknown"),this.iuc())}bHk(u){u&&u.data?this.OUf(u.data.status)||(n.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.Gya(Li.a[u.data.status]),this.iuc()):(n.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.sQc()||(this.Gya("Unknown"),this.iuc()))}sQc(){if(!this.SAd)return n.ULS.sendTraceTag(23881930,
216,10,"Upload fail. Retrying."),this.SAd=!0,this.P3(),!0;n.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}OUf(u){n.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",u);return this.sQc()}Qjb(){n.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");cb.a.En(this.Iqa,cb.a.Iba(3),void 0,"UploadToSharePointManager.RedirectToFolder")}Pjb(u){let P=!1,la=!1;v.AFrameworkApplication.fa&&(P=v.AFrameworkApplication.fa.ka("SaveACopyIsEnabledForUiHost"),
la=v.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"));n.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",u,P);if(P&&la){n.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Ba={};Ba[Ee.a.FLb]="1";Ba[Ee.a.documentUrl]=u;Ba[Ee.a.reason]=Og.a.$Xe;v.AFrameworkApplication.KT().execute(Sa=>{Sa.sendMessage(Jd.a.XDa,Ba)})}else cb.a.En(u,cb.a.Iba(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}kuc(){this.Xh&&
1===this.Xh.state||(this.Yn=this.fra(),this.Yn.message=CommonUIStrings.l_CommentProgressTooltip,this.Yn.Ad=5,this.Yn.Ir=!1,this.Yn.Dpa(CommonUIStrings.l_DefaultDialogTitle,null,null))}v9a(){this.Yn&&(this.Yn.close(),this.Yn=null)}iuc(){this.Kt(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)}Dwl(){this.Kt(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}Nvl(){const u=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);
this.Kt(CommonUIStrings.l_SaveAsFileTooLargeTitle,u,Gg.a.Hel)}Kt(u,P,la=Gg.a.Lel){n.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",u,P);this.v9a();1!==this.Xh.state&&this.eB().pUf(u,P,la)}Fvl(u){n.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",u);switch(u){case xh.a.XLh:this.Dwl();break;case xh.a.Iqh:this.Nvl();break;default:this.iuc()}}sWe(){"VersionHistory"===this.KNd&&this.Ca.processAction(G.a.Dpd,2)}Gya(u){"VersionHistory"===this.KNd&&this.Ca.Ka(G.a.tWe,
2,{["FailureReason"]:u})}}Object(r.a)(Le,"UploadToSharePointManager",null,[880]);class Ih{constructor(){this.bQa=this.kKd=this.eKd=this.Da=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}Yb(u){this.Da=u;this.eKd=Qi.a.Lt(u.Ia("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.kKd=Qi.a.Lt(u.Ia("Common.IEventEmitter<Common.IMruResult>"));this.bQa=Qi.a.Lt(u.Ia("Common.App.SharedFilePicker.ISharedFilePicker"));sh.Task.WAA.call(null,this.eKd,this.kKd,this.bQa).continueWith(()=>
{this.t2k()})}t2k(){this.Da.register(li,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").oa(()=>new li(v.AFrameworkApplication.fa)).ma();this.Da.register(Le,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").oa(()=>new Le(v.AFrameworkApplication.Ra,this.Da.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new eg.a).create(),()=>new Fj,
v.AFrameworkApplication.Aa)).ma();this.Da.register(xg,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").oa(()=>new xg(this.Da.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new Fj,this.Da.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),v.AFrameworkApplication.Aa)).ma();this.Da.register(Ue,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").oa(()=>
new Ue(this.Da.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new Oa.a(()=>this.eKd.result),v.AFrameworkApplication.Aa,()=>new Rf)).ma();this.Da.register(he,"Common.App.SaveToSharePoint.FileNameDialogFactory").oa(()=>new he(v.AFrameworkApplication.fa,v.AFrameworkApplication.Ra,v.AFrameworkApplication.Aa,v.AFrameworkApplication.Aa.ob,this.Da.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.Da.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.Da.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),
new Oa.a(()=>this.kKd.result),this.Da.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.bQa?this.bQa.result:null)).ma();this.Da.register(ag,"Common.App.SaveToSharePoint.SaveToSharePointActor").oa(()=>new ag(v.AFrameworkApplication.fa,v.AFrameworkApplication.Ra,this.Da.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),this.Da.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.Da.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),
this.Da.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>v.AFrameworkApplication.Aa.RLc)).ma();v.AFrameworkApplication.fa.ka("SaveToAnotherFolderBrsIsEnabled")&&this.Da.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").vb()}static main(){m.a.instance.Ac(new Ih)}}Object(r.a)(Ih,"PackageManager",null,[2,3]);class bj extends Wa.StandardDialog{constructor(){super();this.Ad=0;this.Oe(1,CommonUIStrings.l_DialogClose)}Av(u){this.Ty(u,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
null)}}Object(r.a)(bj,"ErrorDialog",Wa.StandardDialog,[895]);class zh{}zh.default=0;Object(r.a)(zh,"SaveToCloudErrorCodes",null,[]);class jj{constructor(u,P,la,Ba,Sa,pb){this.Bl=null;this.H7h=u;this.zca=P;this.GZb=la;this.Oa=Ba;this.job=Sa;this.eB=pb}start(u){this.Bl=u;if("SharePointOnlineConsumer"===this.Oa.Ha("FileSource")){const P=w.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(P){P.start(null,u);return}}this.zca.rme?(n.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),
this.rwi()):(n.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.jxl())}jxl(){this.H7h.create().ika()}Kt(){this.eB().Av(zh.default)}rwi(){try{n.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let u={["client_id"]:this.Oa.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.job||2===this.job)u={["client_id"]:this.Oa.appSettings.UploadToSkyDriveClientId};WL.init(u);n.ULS.sendTraceTag(6590562,216,v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.ob&&
1===v.AFrameworkApplication.Aa.ob.zk?15:50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(z.a)(this,this.onSuccess,"onSuccess"),Object(z.a)(this,this.Kz,"onFailure"))}catch(u){n.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",u,u.stack),this.Kt()}}onSuccess(u){n.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");u&&u.data&&u.data.folders&&
this.GZb.Y1(u.data.folders[0].id,u.data.folders[0].urls.viewInBrowser,null,this.Bl)}Kz(u){if(u&&u.error){if("user_canceled"===u.error.code){n.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}n.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",u.error.code,u.error.message)}else n.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.Kt()}}Object(r.a)(jj,"SaveToCloudManager",null,[893]);class Sh{constructor(u,
P,la,Ba){this.IFc=null;this.t6h=u;this.Oa=la;this.Sof=P;this.tmf=new Bb.a;this.ii=Ba}aCb(){return this.Oa.ka("SaveToCloudStorageUIIsEnabled")}A3f(){return G.a.iYe}GLc(){Sc.a.zod(Object(z.a)(this,this.auh,"saveToCloudActionDispatcher"));Sc.a.s5b([new sf.a(G.a.iYe,J.a.frame,0)],this.Sof.Ayb())}vb(){const u=this.Sof.Ayb();u?(u.kW(()=>{this.tmf.Og(!0)}),this.GLc()):n.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}Mlh(){n.ULS.sendTraceTag(6590597,
216,50,"User clicked on SaveToOneDrive button")}auh(u,P,la,Ba,Sa){return P.contextId!==J.a.frame||u!==this.A3f()?2:this.aCb()?1===la?x.SessionStatusManager.instance.gla||v.AFrameworkApplication.VQ?8:32:2===la?(this.Mlh(),Sa&&Sa.FileDownloadUrl&&n.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.ii&&(this.IFc=this.ii.Ii("DialogShown","SaveToOneDriveReponseTime")),this.tmf.task.continueWith(()=>{this.IFc&&(this.IFc.stop(),this.IFc=null);this.t6h.start(Sa)}),
32):8:8}}Object(r.a)(Sh,"SaveToCloudStorageActor",null,[890]);var ya=d(216);class Ra extends Wa.StandardDialog{constructor(u,P,la){super();this.Ca=u;this.zca=P;this.Nba=la;this.RV=!1;this.Ad=1;this.dza(1);this.Oe(1,CommonUIStrings.l_SignIn);this.Oe(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}ika(){this.zca.Oyf(Object(z.a)(this,this.kbh,"onSignIn"));this.Tx(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(z.a)(this,this.BPj,"inputHandler"))}BPj(u){0===
u?(n.ULS.sendTraceTag(6590598,216,v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.ob&&1===v.AFrameworkApplication.Aa.ob.zk?15:50,"User dismissed SignIn Dialog."),this.hide()):this.rld()}Byi(){let u="2";if(this.Nba)switch(this.Nba.zk){case 3:u="0";break;case 2:u="3";break;case 1:u="1"}return u}hide(){this.zca.g7k(Object(z.a)(this,this.kbh,"onSignIn"));super.hide()}rld(){var u=v.AFrameworkApplication.fa.ka("SignInAspxInWebAppsPortalIsEnabled")?"/start/signin.aspx":"Signin.aspx";u=new ya.QueryStringBuilder(u);
u.jg("prompt","1");u.jg("cbcxt",this.Byi());v.AFrameworkApplication.AQa(u);cb.a.En(u.toString(),"LoginWindow",void 0,"SignInDialog")}kbh(){this.WQ&&this.hide();n.ULS.sendTraceTag(7143885,216,v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.ob&&1===v.AFrameworkApplication.Aa.ob.zk?15:50,"User signed in successfully. Calling Savetocloudstorage action handler");this.Ca.processAction(G.a.iYe,2)}}Object(r.a)(Ra,"SignInDialog",Wa.StandardDialog,[909]);class hb{constructor(u,P,la){this.Ca=u;this.zca=
P;this.Nba=la}create(){return new Ra(this.Ca,this.zca,this.Nba)}}Object(r.a)(hb,"SignInDialogFactory",null,[888]);class Eb{constructor(u,P,la,Ba,Sa,pb,Vb){this.lCa=u;this.PK=P;this.upb=la;this.dBc=Ba;this.xMd=Sa;this.cBa=pb;this.Bl=Vb}execute(u,P){if(!v.AFrameworkApplication.Yg&&v.AFrameworkApplication.Me){var la=this.lCa+this.cBa;la=Bd.a.Ti(la,"fo",lb.a.Qe(this.dBc));la=Bd.a.Ti(la,"fn",lb.a.Qe(this.PK));la=Bd.a.Ti(la,"qs",lb.a.Qe(this.xMd));la=Bd.a.Ti(la,"n",lb.a.Qe((new Date).getTime().toString()));
this.Bl&&this.Bl.FileDownloadUrl&&(la=Bd.a.Ti(la,"furl",lb.a.Qe(this.Bl.FileDownloadUrl)));this.upb&&(la=Bd.a.Ti(la,"fnn",lb.a.Qe(this.upb)));v.AFrameworkApplication.Me.zj(la,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,u,P,null)}}}Object(r.a)(Eb,"SkyDriveUploadCaller",null,[908]);class Yb{constructor(u){this.Oa=u;this.Nra=u.appSettings.SkyDriveUploadWebServiceBase;this.PK=u.appSettings.FileName;this.cBa=u.Ha("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(u,P,la){return new Eb(this.Nra,
this.PK,P,u,v.AFrameworkApplication.gh,this.cBa,la)}}Object(r.a)(Yb,"SkydriveUploadCallerFactory",null,[889]);class Nb{constructor(u,P,la,Ba,Sa){this.Iqa=this.Yn=this.BSb=null;this.K2=!1;this.Bl=this.gCa=null;this.TQd=u;this.fra=P;this.eB=la;this.Xh=Ba;this.ii=Sa}kuc(){this.Xh&&1===this.Xh.state||(this.Yn=this.fra(),this.Yn.message=CommonUIStrings.l_CommentProgressTooltip,this.Yn.Ad=5,this.Yn.Ir=!1,this.Yn.Dpa(CommonUIStrings.l_DefaultDialogTitle,null,null))}v9a(){this.Yn&&(this.Yn.close(),this.Yn=
null)}$Y(){1!==v.AFrameworkApplication.Aa.state&&this.eB().Av(zh.default)}Qjb(){n.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");cb.a.En(this.Iqa,cb.a.Iba(3),void 0,"UploadToCloudManager.RedirectToFolder")}Pjb(u){let P=!1,la=!1;v.AFrameworkApplication.fa&&(P=v.AFrameworkApplication.fa.ka("SaveACopyIsEnabledForUiHost"),la=v.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"));n.ULS.sendTraceTag(6654163,216,v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.ob&&1===
v.AFrameworkApplication.Aa.ob.zk?15:50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",u,P);if(P&&la){n.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Ba={};Ba[Ee.a.FLb]="1";Ba[Ee.a.documentUrl]=u;v.AFrameworkApplication.KT().execute(Sa=>{Sa.sendMessage(Jd.a.XDa,Ba)})}else cb.a.En(u,cb.a.Iba(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}Y1(u,P,la=null,Ba=null){n.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");
this.ii&&(this.gCa=this.ii.Ii("DialogShown","SaveToOneDriveUploadTime"));this.kuc();this.Iqa=P;this.BSb=this.TQd.create(u,la,Ba);this.Bl=Ba;this.P3()}P3(){n.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.BSb.execute(Object(z.a)(this,this.aHk,"onSaveToCloudUploadFinished"),Object(z.a)(this,this.$Gk,"onSaveToCloudUploadFailed"))}aHk(u){this.v9a();this.K2=!1;if(u&&u.data&&u.data.ee){var P;if(({Nu:P}=cd.d(u.data.ee)).returnValue)if(u=P,u.StatusCode!==xh.a.mx&&u.StatusCode!==xh.a.D3b)n.ULS.sendTraceTag(6590602,
216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.$Y();else{n.ULS.sendTraceTag(6590603,216,v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.ob&&1===v.AFrameworkApplication.Aa.ob.zk?15:50,"UploadToCloudManager upload success.");try{u.NewDocumentUrl&&""!==u.NewDocumentUrl?this.Pjb(u.NewDocumentUrl):this.Qjb()}catch(la){n.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",la.toString())}this.foc()}else n.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",
{["ResponseData"]:Yf.a.xwc(u.data.ee)}),this.$Y()}else n.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.$Y()}$Gk(u){5!==u.data.status&&12!==u.data.status||this.K2?(n.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",u.data.status),this.v9a(),this.$Y(),this.foc()):(n.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.K2=!0,this.P3())}foc(){this.gCa&&(this.gCa.stop(),this.gCa=null)}}Object(r.a)(Nb,
"UploadToCloudManager",null,[887]);class ed{constructor(){this.Da=null}get name(){return"Common.App.SaveToCloudStorage"}init(){v.AFrameworkApplication.fa.ka("SaveToCloudStorageUIIsEnabled")&&this.Da.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").vb()}dispose(){}Yb(u){this.Da=u;this.Da.register(hb,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").oa(()=>new hb(v.AFrameworkApplication.Ra,Yg.a.instance,v.AFrameworkApplication.Aa.ob)).ma();
this.Da.register(Yb,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").oa(()=>new Yb(v.AFrameworkApplication.fa)).ma();this.Da.register(Sh,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").oa(()=>new Sh(u.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),u.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),v.AFrameworkApplication.fa,v.AFrameworkApplication.Aa.vV)).ma();this.Da.register(Nb,
"Common.App.SaveToCloudStorage.UploadToCloudManager").oa(()=>new Nb(u.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new eg.a).create(),()=>new bj,v.AFrameworkApplication.Aa,v.AFrameworkApplication.Aa.vV)).ma();this.Da.register(jj,"Common.App.SaveToCloudStorage.SaveToCloudManager").oa(()=>new jj(u.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Yg.a.instance,u.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),v.AFrameworkApplication.fa,v.AFrameworkApplication.WSa,
()=>new bj)).ma()}static main(){m.a.instance.Ac(new ed)}}Object(r.a)(ed,"PackageManager",null,[2,3]);class zd{static get sg(){return Ke.a.VC(zd.Fo,CommonUIStrings.l_SaveACopyFileName)}}zd.Fo="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(r.a)(zd,"FileNameDialogHtml",null,[]);class Hd extends Ke.a{constructor(u,P,la,Ba){super();this.dBc=this.Iqa=null;this.Ca=u;this.Nba=P;this.GZb=la;this.Oe(1,CommonUIStrings.l_SaveButtonLabel);this.sg=zd.sg;this.kg="FileNameDialog-SaveACopy";this.Bl=Ba}ika(u,P,la){this.dBc=u;this.Iqa=la;u={["txtFileName"]:lb.a.iH(v.AFrameworkApplication.du.rx),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,P)};this.pj(CommonUIStrings.l_SaveToOneDrive,Object(z.a)(this,this.vSc,"fileNameDialogHandler"),
u);n.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}vSc(u,P){1!==u?n.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(u=P.txtFileName.trim(),n.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),P=lb.a.AQ(v.AFrameworkApplication.fileName),u&&""!==u&&""!==P&&(u+=P),this.GZb.Y1(this.dBc,this.Iqa,u,this.Bl))}}Object(r.a)(Hd,"FileNameDialog",Ke.a,
[923]);class ba{constructor(u,P,la){this.Ca=u;this.Nba=P;this.GZb=la}create(u){return new Hd(this.Ca,this.Nba,this.GZb,u)}}Object(r.a)(ba,"FileNameDialogFactory",null,[899]);class Aa extends Wa.StandardDialog{constructor(u){super();this.Ad=1;this.Oe(1,CommonUIStrings.l_RetryButtonLabel);this.Oe(0,CommonUIStrings.l_DialogClose);this.Ca=u}Av(u){n.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",u);this.Ty(u,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(z.a)(this,
this.jXe,"retryDialogHandler"))}jXe(u){1===u?(n.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.Ca.processAction(G.a.fsc,2)):n.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(r.a)(Aa,"RetryDialog",Wa.StandardDialog,[895]);class Pa extends Sh{constructor(u,P,la,Ba){super(u,P,la,Ba);this.B3h=P}aCb(){return this.Oa.ka("SaveACopyBrsIsEnabled")}A3f(){return G.a.fsc}GLc(){Sc.a.zod(Object(z.a)(this,this.auh,"saveToCloudActionDispatcher"));Sc.a.s5b([new sf.a(G.a.fsc,
J.a.frame,0)],this.B3h.Ayb())}Mlh(){v.AFrameworkApplication.dma("CreateCopy_cf;CreateCopy_tf");n.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(r.a)(Pa,"SaveACopyActor",Sh,[]);class ub extends jj{constructor(u,P,la,Ba,Sa,pb,Vb){super(P,la,Ba,Sa,pb,Vb);this.sYh=u}onSuccess(u){u&&u.data&&u.data.folders?(n.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.sYh.create(this.Bl).ika(u.data.folders[0].id,u.data.folders[0].name,
u.data.folders[0].urls.viewInBrowser)):(n.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.Kt())}Kz(u){u&&u.error&&"user_canceled"===u.error.code&&n.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.Kz(u)}Kt(){n.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.Kt()}}Object(r.a)(ub,"SaveACopyManager",jj,[]);class Lb extends Nb{constructor(u,P,la,Ba,Sa,pb){super(P,la,Ba,Sa,pb);this.Ca=u}Ape(){return!!this.Bl&&
!!this.Bl.SaveEntryPoint&&"VersionHistory"===this.Bl.SaveEntryPoint.toString()}$Y(){n.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.Ape()&&this.Ca.Ka(G.a.tWe,2,{["FailureReason"]:"Unknown"});super.$Y()}Qjb(){n.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.Ape()&&this.Ca.processAction(G.a.Dpd,2);super.Qjb()}Pjb(u){n.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",u);this.Ape()&&this.Ca.processAction(G.a.Dpd,
2);super.Pjb(u)}P3(){this.Bl&&"true"===this.Bl.SkipSaveToHost?super.P3():32!==this.Ca.processAction(G.a.W0a,1)?(n.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.P3()):this.Ca.Ka(G.a.W0a,2,[()=>{n.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");Nb.prototype.P3.call(this)},()=>{n.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.$Y()}])}}
Object(r.a)(Lb,"SaveACopyUploadToCloudManager",Nb,[]);class Mb{constructor(){this.Da=null}get name(){return"Common.App.SaveACopy"}init(){v.AFrameworkApplication.fa.ff(Object(z.a)(this,this.en,"onFullAppSettingsReady"))}en(){v.AFrameworkApplication.fa.ka("SaveACopyBrsIsEnabled")&&this.Da.resolve("Common.App.SaveACopy.SaveACopyActor").vb()}dispose(){}Yb(u){this.Da=u;this.Da.register(Lb,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").oa(()=>new Lb(v.AFrameworkApplication.Ra,u.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),
()=>(new eg.a).create(),()=>new Aa(v.AFrameworkApplication.Ra),v.AFrameworkApplication.Aa,v.AFrameworkApplication.Aa.vV)).ma();this.Da.register(ba,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").oa(()=>new ba(v.AFrameworkApplication.Ra,v.AFrameworkApplication.Aa.ob,u.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).ma();this.Da.register(Pa,"Common.App.SaveACopy.SaveACopyActor").oa(()=>new Pa(u.resolve("Common.App.SaveACopy.SaveACopyManager"),
u.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),v.AFrameworkApplication.fa,v.AFrameworkApplication.Aa.vV)).ma();this.Da.register(ub,"Common.App.SaveACopy.SaveACopyManager").oa(()=>new ub(u.resolve("Common.App.SaveACopy.FileNameDialogFactory"),u.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Yg.a.instance,u.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),v.AFrameworkApplication.fa,v.AFrameworkApplication.WSa,()=>new Aa(v.AFrameworkApplication.Ra))).ma()}static main(){m.a.instance.Ac(new Mb)}}
Object(r.a)(Mb,"PackageManager",null,[2,3]);var kd=d(377);class Id{constructor(u){this.vLg=null;n.ULS.sendTraceTag(527574681,306,50,"PhoneLinkManager - Initialize");this.Lic=v.AFrameworkApplication.fa.Ha("PhoneLinkServiceEndpoint");(this.xM=u)||n.ULS.sendTraceTag(527574720,306,10,"PhoneLinkManager - OAuthManager is null");this.Lic&&this.Lic.length||n.ULS.sendTraceTag(527574721,306,10,"PhoneLinkManager - Missing service endpoint")}z3i(u){u&&(this.Lic="https://dcg-df.microsoft.com/",n.ULS.sendTraceTag(526697302,
306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));this.y3i()}y3i(){n.ULS.sendTraceTag(527214155,306,50,"PhoneLinkManager::FetchPhoneLinkData...");if(864E5>=+new Date-+this.vLg)n.ULS.sendTraceTag(527574722,306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");else{this.vLg=new Date;var u=new Date;this.xM.gI("BayBridge",this.Lic).then(P=>{const la=+new Date-+u;P.IsSuccess?(n.ULS.sendTraceTag(527574723,306,50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",
la),this.q3i(P.Token,this.xaj())):n.ULS.sendTraceTag(527574724,306,15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",la,P.ErrorCode,P.ErrorMessage)}).catch(P=>{n.ULS.sendTraceTag(527574725,306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",P,+new Date-+u)})}}q3i(u,P){const la={};la.Authorization="Bearer "+u;la["Authorization-Type"]="AAD";la.Accept="application/json";la["DCG-SessionId"]=
v.AFrameworkApplication.userSessionId;v.AFrameworkApplication.Me.zj(P,1,null,la,!1,2,Object(z.a)(this,this.ltj,"getStatusSucceeded"),Object(z.a)(this,this.jtj,"getStatusFailed"),null,void 0,void 0,void 0,void 0,"39");rc.a("FetchAccountLinkedStatus")}Fbj(){const u=kd.a.instance.getItem("AccountLinkedStatusCache");return u&&u.length?"true"===u.toLowerCase()?!0:!1:!1}xaj(){return this.Lic+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0"}jtj(){n.ULS.sendTraceTag(527214156,306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")}ltj(u){n.ULS.sendTraceTag(527214157,
352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");u=cd.a(u.data.ee).state+"";kd.a.instance.setItem("AccountLinkedStatusCache",u)}}Object(r.a)(Id,"PhoneLinkManager",null,[810]);class ce{constructor(){this.Da=null}get name(){return"Common.App.PhoneLink"}Yb(u){this.Da=u;this.Da.register(810,"Common.App.PhoneLink.IPhoneLinkManager").ma().oa(()=>new Id(this.Da.resolve("Common.App.OAuth.IOAuthManager")))}init(){v.AFrameworkApplication.fa.ff(()=>{this.AFa()})}AFa(){this.Da.resolve("Common.App.PhoneLink.IPhoneLinkManager")}dispose(){}static main(){m.a.instance.Ac(new ce)}}
Object(r.a)(ce,"PhoneLinkPackage",null,[2,3]);var Xe;(function(u){u[u.myFiles=0]="myFiles";u[u.recent=1]="recent";u[u.currentFolder=2]="currentFolder";u[u.yourPhone=3]="yourPhone"})(Xe||(Xe={}));Object(r.b)("SharedFilePickerLandingLocation",Xe);class jd{constructor(u){this.mbb=this.IKb=null;this._initialized=!1;this.Nge=u}A5d(u){this._initialized||(u.Iu(Jd.a.ylh),u.dC(Jd.a.ylh,Object(z.a)(this,this.vGk,"onReceivedPickerResponse")),this._initialized=!0)}pVc(u){return this.mbb=new Promise((P,la)=>{const Ba=
{};Ba[Ee.a.sOk]=u;this.IKb=(Sa,pb)=>{""===pb?(n.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),P(Sa)):("Canceled"===pb?n.ULS.sendTraceTag(572548164,306,50,pb):n.ULS.sendTraceTag(556901065,306,10,pb),la(pb))};this.Nge.execute(Sa=>{this.A5d(Sa);Sa.sendMessage(Jd.a.XJk,Ba)})})}vGk(u){this.IKb(u.Values[Ee.a.Hgl],void 0===u.Values[Ee.a.QOe]||null===u.Values[Ee.a.QOe]?"":u.Values[Ee.a.QOe])}Kpe(){return v.AFrameworkApplication.fa.ka("UiHostCommonFilePicker")}J0d(u,P,la,Ba,Sa,pb,
Vb,Bc,Yc=null){const gd={};gd[Ee.a.rgl]=u;gd[Ee.a.titleText]=P;gd[Ee.a.yki]=la;gd[Ee.a.zki]=Ba;gd[Ee.a.Aki]=Sa;gd[Ee.a.cVi]=!0;gd[Ee.a.U3i]=pb;gd[Ee.a.vOk]=Vb;gd[Ee.a.uOk]=Xe[Bc];td.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(gd[Ee.a.wOk]="Dark");Yc&&(null!=Yc.$sb&&(gd[Ee.a.$sb]=Yc.$sb),null!=Yc.Xzb&&(gd[Ee.a.Xzb]=Yc.Xzb));return gd}}Object(r.a)(jd,"SharedFilePickerManager",null,[828]);class rd{constructor(){this.Da=null}get name(){return"Common.App.SharedFilePicker"}Yb(u){this.Da=
u;u.register(jd,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").ma().oa(()=>new jd(u.Ia("Postmessage.IHostPostmessenger")))}init(){v.AFrameworkApplication.fa.ff(()=>{this.AFa()})}AFa(){this.Da.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){m.a.instance.Ac(new rd)}}Object(r.a)(rd,"SharedFilePickerPackage",null,[2,3]);class Wc{constructor(u,P=3E4){this.UGl=9E5;this.YGl=1E4;this.azg=this.IFb=null;this.lue=0;
this.Z3b=Date.now;this.tvj=u;this.Mwd=P;this.bUc()}Gcg(u=!0){const P=this.Z3b();if(P<this.lue+this.UGl)return P>this.lue+this.YGl&&this.bUc(),this.azg;u&&this.bUc();return null}getToken(u=!0){return(u=this.Gcg(u))?Promise.resolve(u):this.bUc()}bUc(){return this.IFb=this.IFb||new Promise(u=>{this.tvj().then(P=>{this.IFb=null;""!==P&&P&&(this.azg=P,this.lue=this.Z3b(),u(P));u(null)}).catch(()=>{this.IFb=null;u(null)});window.setTimeout(()=>{this.IFb=null;u(null)},this.Mwd)})}}Object(r.a)(Wc,"OAuthCacheManager",
null,[]);class wd{constructor(){this.xM=null;this.Hff={};this.mQb=new Hi.a(yh.a.Ml())}getToken(u,P){if(this.mQb.Fb(P))return this.mQb.ga(P).getToken();const la=new Wc(()=>this.Hcg(u,P));this.mQb.$(P,la);return la.getToken()}svj(u,P){if(this.mQb.Fb(P))return this.mQb.ga(P).Gcg();const la=new Wc(()=>this.Hcg(u,P));this.mQb.$(P,la);return null}Hcg(u,P){if(!this.xM)try{this.xM=w.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(la){n.ULS.sendTraceTag(51689675,1300,10,"Unable to resolve IOAuthManager: "+
la)}return this.xM?new Promise(la=>{const Ba=Date.now();this.xM.gI(u,P).then(Sa=>{const pb=Sa.Token;!Sa.IsSuccess||this.S4j(pb)?(this.hNb("GetTokenInternalImplicitJS",!1,Date.now()-Ba,u,Sa.ErrorCode,Sa.ErrorMessage,P),la(null)):(this.hNb("GetTokenInternalImplicitJS",!0,Date.now()-Ba,u,Sa.ErrorCode,Sa.ErrorMessage,P),la(pb))}).catch(Sa=>{Sa=Sa?cd.c(Sa):"";this.hNb("GetTokenInternalImplicitJS",!1,Date.now()-Ba,u,"Caught Exception",Sa,P);la(null)})}):new Promise(la=>{this.hNb("GetTokenInternalImplicitJS",
!1,0,u,"Null OAuthManager","OAuthManager not set");la(null)})}hNb(u,P,la,Ba,Sa="",pb="",Vb=""){var Bc="Search"===Ba;const Yc=[];u=Od.a.E_(Bc?"Event":"EventName",u,2);Ba=Od.a.E_("AppName",Ba,2);Array.add(Yc,u);Array.add(Yc,Ba);Bc&&(Ba=Od.a.E_("LatencyType","FetchToken",2),Array.add(Yc,Ba));Sa&&""!==Sa&&(Sa=Od.a.E_("ErrorCode",Sa,2),Array.add(Yc,Sa));pb&&""!==pb&&(pb=Od.a.E_("ErrorMessage",pb,2),Array.add(Yc,pb));Vb&&""!==Vb&&(pb=!(Vb in this.Hff),this.Hff[Vb]=pb,pb=Od.a.E_("WarmUpCall",pb.toString(),
1),Array.add(Yc,pb),Vb=Od.a.E_("Service",this.aXc(Vb),2),Array.add(Yc,Vb));Bc=Bc?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";P=Object.assign(new We.a,{name:Bc,samplingPolicy:2,dataFields:Yc,succeeded:P,durationMs:la});B.a.sendActivityEvent(P)}aXc(u){return u===v.AFrameworkApplication.Ose?"Loki":u===v.AFrameworkApplication.q4e?"Substrate":v.AFrameworkApplication.fa&&u===v.AFrameworkApplication.fa.Ha("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}S4j(u){return!u||
!u.length}}Object(r.a)(wd,"SearchOAuthManager",null,[809]);class Fe{constructor(){this.Da=null}get name(){return"Common.App.SearchOAuthManager"}Yb(u){this.Da=u;this.Da.register(809,"Common.App.SearchCommon.ISearchOAuthManager").ma().oa(()=>new wd)}init(){}dispose(){}static main(){m.a.instance.Ac(new Fe)}}Object(r.a)(Fe,"SearchOAuthPackage",null,[2,3]);var ak;(function(u){u[u.generalException=0]="generalException";u[u.invalidArgument=1]="invalidArgument";u[u.notAllowed=2]="notAllowed";u[u.apiNotAvailable=
3]="apiNotAvailable";u[u.unresolvedPendingRequest=4]="unresolvedPendingRequest";u[u.timeout=5]="timeout";u[u.adalTimeout=6]="adalTimeout";u[u.userNotSignedIn=7]="userNotSignedIn";u[u.userAborted=8]="userAborted";u[u.silentSignInFailed=9]="silentSignInFailed";u[u.invalidResourceUrl=10]="invalidResourceUrl";u[u.invalidGrant=11]="invalidGrant";u[u.connectionLost=12]="connectionLost";u[u.clientError=13]="clientError";u[u.serverError=14]="serverError"})(ak||(ak={}));Object(r.b)("ErrorCodes",ak);class tj{}
Object(r.a)(tj,"HostApplicationType",null,[]);class bh{constructor(u,P){this.requestCallback=this.requestParameters=null;this.requestParameters=u;this.requestCallback=P}}Object(r.a)(bh,"OutstandingRequest",null,[]);class ee{}ee.lyk="AADSTS50058";ee.invalidResourceUrl="AADSTS50001";ee.fyk="AADSTS65001";ee.yyk="AADSTS70011";ee.userAborted="13002";ee.mQk="Popup Window is null";ee.lQk="Popup Window closed";ee.adalTimeout="Token renewal operation failed due to timeout";ee.ZGl="tokenRevoked";Object(r.a)(ee,
"WopiHostErrorType",null,[]);var Mi=d(227),Nl=d(317),Cg=d(1001);class zi{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(r.a)(zi,"WopiIdentityInfo",null,[866]);class Zh{constructor(u,P,la){this.expiration=this.authority=this.accessToken=null;this.accessToken=u;this.authority=P;this.expiration=la}}Object(r.a)(Zh,"WopiIdentityToken",null,[864]);class ch{constructor(u){this._initialized=!1;this.uJb={};this.bvd={};this.kba=v.AFrameworkApplication.Aa.vV;
this.Nge=u}A5d(u){this._initialized||(u.Iu(Jd.a.mgh),u.dC(Jd.a.mgh,Object(z.a)(this,this.tGk,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(u,P,la=null){this.xdk(u,P);return new Promise((Ba,Sa)=>{if(this.lme(P))if(P in this.uJb)Sa("unresolvedPendingRequest");else{var pb=window.setTimeout(()=>{n.ULS.sendTraceTag(37856032,344,10,cd.c({["error"]:"Request timeout.",["callerId"]:P}));Sa("timeout")},12E4);this.b9d(u,P,la,(Vb,Bc)=>{window.clearTimeout(pb);Vb?Ba(Vb):(n.ULS.sendTraceTag(37856033,
369,15,cd.c({["error"]:ak[Bc]})),Sa(Bc))})}else n.ULS.sendTraceTag(37856034,344,10,cd.c({["error"]:"Caller is not allowed."})),Sa("notAllowed")})}getPrimaryIdentityInfo(u){return new Promise((P,la)=>{this.lme(u)?this.voj((Ba,Sa)=>{Ba?P(Ba):(n.ULS.sendTraceTag(37856064,369,10,cd.c({["error"]:Sa.toString()})),la(Sa))}):(n.ULS.sendTraceTag(37856065,344,10,cd.c({["error"]:"Caller is not allowed."})),la("notAllowed"))})}getAuthContext(u){return new Promise((P,la)=>{const Ba=this.getAuthContextSync(u);
Ba?P(Ba):la("notAllowed")})}getAuthContextSync(u){if(this.lme(u)){const P=new Cg.a;P.upn=v.AFrameworkApplication.fa.Ha("UserPrincipalName");P.userId=v.AFrameworkApplication.fa.Ha("LoggableUserId");P.authority=v.AFrameworkApplication.fa.Ha("HostAuthAuthority");P.tenantId=v.AFrameworkApplication.fa.Ha("TenantId");P.isAnonymous=v.AFrameworkApplication.fa.ka("IsAnonymousUser");P.supportsAuthToken=this.uJj(u);u=v.AFrameworkApplication.fa.Ha("HostAuthType");P.authorityType="aad"===u.toLowerCase()?2:"msa"===
u.toLowerCase()?1:0;return P}n.ULS.sendTraceTag(40751647,344,10,cd.c({["error"]:"Caller is not allowed."}));return null}uJj(u){const P=Mi.OAuthManagerSettings.lbb;return qd.a.xGa?P&&Mi.OAuthManagerSettings.OHh?Array.contains(Mi.OAuthManagerSettings.OHh,u.toLowerCase()):!1:P}b9d(u,P,la,Ba){var Sa=[];Array.add(Sa,Object.assign(new M.a,{name:"CallerId",string:P}));Array.add(Sa,Object.assign(new M.a,{name:Ee.a.t3e,string:u.correlationId}));B.a.sendTelemetryEvent(Object.assign(new N.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",
dataFields:Sa}));Sa=Nl.a.create().toString();const pb="getAccessToken_"+Sa,Vb=this.kba.Ii("ComponentAttach",pb);this.bvd[pb]=Vb;const Bc={};Bc[Ee.a.u3e]=Sa;Bc[Ee.a.pAl]=u.resource;Bc[Ee.a.qAl]=u.scope;Bc[Ee.a.BEh]=v.AFrameworkApplication.fa.Ha("HostAuthType");Bc[Ee.a.tAl]=v.AFrameworkApplication.fa.Ha("UserPrincipalName");Bc[Ee.a.rAl]=u.silentLogin;Bc[Ee.a.mAl]=u.options;Bc[Ee.a.t3e]=u.correlationId;Bc[Ee.a.nAl]=P;la&&(Bc[Ee.a.addinName]=la.AddinName,Bc[Ee.a.lAl]=la.AddinTrustId);this.Nge.execute(Yc=>
{this.A5d(Yc);Yc.sendMessage(Jd.a.getAuthToken,Bc)});this.uJb[Sa]=new bh(u,Ba)}voj(u){const P=v.AFrameworkApplication.fa.Ha("UserName"),la=v.AFrameworkApplication.fa.Ha("UserPrincipalName"),Ba=v.AFrameworkApplication.fa.Ha("LoggableUserIdSpace"),Sa=new zi;Sa.email=la;Sa.displayName=P;switch(Ba){case "OrgIdPuid":Sa.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":Sa.authority="MicrosoftAccount";break;default:Sa.authority=Ba}u(Sa,null)}tGk(u){let P=null;try{let Ba=u.Values[Ee.a.u3e];
const Sa=u.Values[Ee.a.kAl],pb=u.Values[Ee.a.BEh],Vb=u.Values[Ee.a.sAl];let Bc=null,Yc=null;const gd=this.uJb[Ba];if("undefined"!==typeof gd&&gd){var la=[];Array.add(la,Object.assign(new M.a,{name:Ee.a.t3e,string:gd.requestParameters.correlationId}));B.a.sendTelemetryEvent(Object.assign(new N.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:la}));P=gd.requestCallback;delete this.uJb[Ba];"undefined"!==typeof Sa&&Sa&&Sa.length?Yc=new Zh(Sa,pb,Vb):Bc=ak[this.Ttk(u)];
la="getAccessToken_"+Ba;la in this.bvd&&(this.bvd[la].stop(),delete this.bvd[la]);P(Yc,Bc)}else n.ULS.sendTraceTag(37856066,344,10,cd.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:Ba}))}catch(Ba){u=u.Values[Ee.a.u3e],u in this.uJb&&delete this.uJb[u],this.U4c(),n.ULS.sendTraceTag(37856067,344,10,cd.c({["error"]:Ba.message,["stack"]:Ba.stack})),P&&P(null,"generalException")}}lme(u){var P=v.AFrameworkApplication.Oxj();u=u.toLowerCase();for(const la of P)if(u===la.toLowerCase())return!0;
P=Mi.OAuthManagerSettings.lUd;for(let la in P)if(u===P[la].toLowerCase())return!0;return!1}Ttk(u){u=u.Values[Ee.a.oAl];this.U4c();n.ULS.sendTraceTag(39068821,344,15,cd.c({["error"]:u}));return u?-1<u.indexOf(ee.lyk)?9:-1<u.indexOf(ee.mQk)||-1<u.indexOf(ee.lQk)?12:-1<u.indexOf(ee.invalidResourceUrl)?10:-1<u.indexOf(ee.userAborted)?8:-1<u.indexOf(ee.yyk)||-1<u.indexOf(ee.fyk)||u===ee.ZGl?11:-1<u.indexOf(ee.adalTimeout)?6:0:13}xdk(u,P){u=this.P1k(u.resource);n.ULS.sendTraceTag(39921882,344,50,cd.c({["callerId"]:P,
["resource"]:u}))}U4c(){n.ULS.sendTraceTag(39068822,344,50,cd.c({["userAgent"]:window.navigator.userAgent}))}P1k(u){return(u?u:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(r.a)(ch,"WopiIdentityManager",null,[826]);class kk{constructor(){this.Da=null}get name(){return"Common.App.WopiIdentity"}Yb(u){this.Da=u;u.register(ch,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").ma().oa(()=>new ch(u.Ia("Postmessage.IHostPostmessenger")))}init(){v.AFrameworkApplication.fa&&
v.AFrameworkApplication.fa.ff(Object(z.a)(this,this.en,"onFullAppSettingsReady"))}en(){try{this.Da.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(u){n.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+u)}}dispose(){}static main(){m.a.instance.Ac(new kk)}}Object(r.a)(kk,"WopiIdentityPackage",null,[2,3]);var Vi=d(677);class kj extends Vi.a{constructor(u,P){super(u,Bd.a.DQ(P))}Aya(u,P){this.isEnabled()&&this.qCa(this.DMa)&&(this.Iu(u),this.dC(u,P))}}
Object(r.a)(kj,"InsertMediaCrossDocumentMessenger",Vi.a,[896,332,107]);class Ni{getInstance(u,P){return new kj(u,P)}}Object(r.a)(Ni,"InsertMediaCrossDocumentMessengerFactory",null,[850]);class ph{constructor(u,P,la){this.correlationId=null;this.qaa=0;this.insertPictureTelemetryEndpoint=null;this.UPc=0;this.JZh=u;this.DZb=[];this.HZh=P;this.Wtf=la.split(";")}Slb(u,P){Array.clear(this.DZb);u=this.JZh.value;u.aMl(P.Jzb);u.qCa(this.HZh);u.Iu(P.Jzb);u.dC(P.Jzb,la=>{this.iMe(la,P)});n.ULS.sendTraceTag(17838540,
352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");u.sendMessage(P.BQf,{["FileExtensionFilterList"]:this.Wtf})}Cei(u){Array.contains(this.DZb,u)||Array.add(this.DZb,u)}iMe(u,P){n.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");u=P.seh(u);const la=[];for(let Ba=0;Ba<u.length;Ba++){const Sa=u[Ba];P.f1c(Sa,this.Wtf)?Array.add(la,Sa):this.Cei(P.hag(Sa))}la&&la.length?P.Fua(la):n.ULS.sendTraceTag(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");
0<this.DZb.length&&(P=this.DZb.join(", "),n.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",P),this.Ixl(P))}Ixl(u){const P=new Wa.StandardDialog;P.Ad=0;P.sP(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,u),null)}dispose(){}}Object(r.a)(ph,"InsertMediaFromHostManager",null,[922,107]);class Ck{constructor(u){this.n_h=u}getInstance(){return this.n_h}}Object(r.a)(Ck,"InsertMediaFromHostManagerFactory",
null,[920,921]);class Rj{constructor(){this.fUb=document.createElement("iframe");this.fUb.src="about:blank";this.fUb.style.visibility="hidden";this.fUb.style.position="absolute";this.fUb.style.zIndex="-100"}get h$a(){return this.fUb}}Object(r.a)(Rj,"InsertMediaFromHostOneDriveHostFrame",null,[919]);class Jk extends Vi.a{constructor(u,P){super(u,"*"===P?P:Bd.a.DQ(P));this.Mwf(Jd.a.insertImage);this.Mwf(Jd.a.Bie)}reportDocumentLoadedTime(){}}Object(r.a)(Jk,"InsertMediaFromOneDriveCrossDocumentMessenger",
Vi.a,[918,332,107]);var hk=d(269),Bl=d(549);class ie{WJc(u){switch(u){case 1:u=8;break;case 4:u=3;break;case 2:u=0;break;default:u=0}return u}asi(u,P){return String.format(P,this.WJc(u))}vFf(u,P,la,Ba,Sa,pb,Vb){u=this.WJc(u);const Bc=hk.a.He(v.AFrameworkApplication.lcid).name,Yc=v.AFrameworkApplication.buildVersion;v.AFrameworkApplication.dma("ShIns226;ShIns226cf");return String.format(P,v.AFrameworkApplication.lcid,Bc,Yc,Sa,u,pb,la,Ba,Vb)}dsi(u,P){u=this.WJc(u);const la=v.AFrameworkApplication.buildVersion,
Ba=0<la.indexOf(".")?la.substring(0,la.indexOf(".")):"16";return String.format(P,v.AFrameworkApplication.lcid,v.AFrameworkApplication.lcid,v.AFrameworkApplication.lcid,u,Ba,la,"Video",0,0)}csi(u,P,la,Ba,Sa,pb,Vb,Bc){u=String.format(P,v.AFrameworkApplication.lcid,v.AFrameworkApplication.uiCulture,v.AFrameworkApplication.buildVersion,la,this.WJc(u),Ba);Sa&&(u+="&flipgrid=1");pb&&(Sa=new ya.QueryStringBuilder(u),Sa.jg("stream2","1"),Vb&&Sa.jg("enablegetcustomheader","1"),u=Sa.toString());"defaultModal"!=
Bc&&(Vb=new ya.QueryStringBuilder(u),Vb.jg("modalvariation",Bc),u=Vb.toString());return u}ueh(u){if(!u||!u.Values)return null;u=u.Values;if(!u)return null;let P="";"sourceProvider"in u&&(P=u.sourceProvider||"");return Object.assign(new Bl.a,{Action:u.action||"",Caption:u.caption||"",ContentType:u.contentType||"",Type:u.extension||"",PageUrl:u.pageUrl||"",OriginalUrl:u.sourceUrl||"",ContentProvider:P,ThumbnailUrl:u.thumbnailUrl||"",LicenseUrl:u.licenseUrl||"",LicenseDisplayName:u.licenseDisplayName||
"",Height:u.height||0,Width:u.width||0,SvgContent:u.svgContent||"",Description:u.description||"",ProviderName:u.providerName||"",StartInsertTime:u.startInsertTime||0})}KMk(u){const P=[];if(!u||!u.Values||!u.Values.Items)return P;u=u.Values.Items;for(let Ba=0;Ba<u.length;Ba++){var la=u[Ba];la&&(la=Object.assign(new Bl.a,{Type:la.Extension||"",OriginalUrl:la.SourceUrl||"",Caption:la.caption,Description:la.description||"",Height:la.Height||0,Width:la.Width||0}),Array.add(P,la))}return P}f1c(u,P){if(!u)return!1;
for(let la=0;la<P.length;la++)if(0<=u.toLowerCase().indexOf(P[la]))return!0;return!1}HSk(u){let P="";if(u)for(let la=0;la<u.length;la++){const Ba=u[la];Ba&&(P+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',Ba.OriginalUrl,Ba.Width,Ba.Height))}return P}Pwj(u){return(u=ie.Kdl.exec(u))&&2<u.length?u[2].trim():""}}ie.Kdl=RegExp("<iframe\\s(.*\\s)*src=[\\\"|'](.*?)[\\\"|'].*/(iframe)?>","im");Object(r.a)(ie,"InsertMediaHelper",null,[846]);var df=d(35);class uj{constructor(u){this.hVb=df.a.insertHyperlink;
this.Ca=u}get zx(){return this.hVb}set zx(u){this.hVb=u}Fua(u){try{n.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",u.length);for(let P=0;P<u.length;P++)this.Ca.Ka(this.zx,2,u[P]);n.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",u.length)}catch(P){n.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",P.toString())}}}Object(r.a)(uj,"InsertOneDriveFileHandler",
null,[892]);class Xl extends uj{constructor(u){super(u)}get BQf(){return Jd.a.Bie}get Jzb(){return Jd.a.PPj}seh(u){return u&&u.Values&&"Items"in u.Values?u.Values.Items:null}hag(){R.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");return""}f1c(){return!0}wih(u,P,la){u=la(u);u.length&&(la={},la.Items=u,P.sendMessage(this.Jzb,la))}teh(u){const P=[];for(let la=0;la<u.data.value.length;la++){const Ba=u.data.value[la];if(Ba){const Sa=
{};Sa.DisplayText=Ba.name;Sa.Url=Ba.urls.download;Sa.sourceUrl=Ba.urls.download;Sa.caption=Ba.name;Array.add(P,Sa)}}return P}}Object(r.a)(Xl,"InsertOneDriveFileHelper",uj,[891,892]);class Sj extends Ke.a{constructor(){super()}j2e(){this.Yzc="FilePickerDialog";this.sg="<div class='FilePickerDiv' id='OpenFilePickerDiv'></div>";this.kg="PickerDialog-Livebooks";this.showDialog("",null)}Xbe(){return document.getElementById("OpenFilePickerDiv")}VA(){}Iaa(){}}Object(r.a)(Sj,"PickerDialog",Ke.a,[949]);class bk{constructor(u,
P,la){this.zo=this.wia=null;this.u4a=u;this.z4h=la;this.aia=new Oa.a(()=>new kf.a(P.value,Object(z.a)(this,this.VEa,"getMoreInfoEventReceived")))}get pJb(){this.wia||(this.aia.value.Uda("InsertFromOneDrive",!0),this.zo&&this.zo.UR&&this.zo.UR.length&&(this.wia=this.Ebe(this.zo.UR)));return this.wia}Ebe(u){u=u.toLowerCase();u.endsWith("/")||(u+="/");const P=u.indexOf("/documents/");return-1!==P?u.substring(0,P+1)+"_layouts/15/onedrive.aspx":""}VEa(u){this.zo||3!==u.state||(this.zo=u)}start(u){if(!this.pJb)if(v.AFrameworkApplication.breadcrumbFolderUrl&&
v.AFrameworkApplication.breadcrumbFolderUrl.length)this.wia=v.AFrameworkApplication.breadcrumbFolderUrl;else{n.ULS.sendTraceTag(26071185,352,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.zo);return}const P=new Sj;P.j2e();const la=P.Xbe();la?this.u4a.start((Ba,Sa)=>{P.hide();this.processResponse(Ba,Sa,u)},()=>{this.gLe(P)},la,this.wia):n.ULS.sendTraceTag(26071186,352,10,"Picker container is null, will not show picker.")}gLe(u){u.hide();
n.ULS.sendTraceTag(26071187,352,50,"User cancelled to insert picture from onedrive.")}processResponse(u,P,la){n.ULS.sendTraceTag(26071188,352,50,"OneDriveFilePickerHelperV7::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",u);u&&P&&P.data&&P.data.value&&0<P.data.value.length?(u=this.z4h.getInstance(window.frames[0].parent,window.document.URL),la.wih(P,u,Object(z.a)(la,la.teh,"parseOneDriveV7Response"))):n.ULS.sendTraceTag(24134243,352,50,"Response from the OneDriveFilePicker was empty. No media to insert")}}
Object(r.a)(bk,"OneDriveFilePickerHelperV7",null,[915,916]);class Ii{constructor(u,P,la,Ba){this.ia=P;this.la=u;this.g5=this.la.Iua;this.eM=la;this.Dxg=Ba}get eQ(){return this.Dxg?this.Dxg.instance:null}vb(){this.ia.ra(G.a.s4c,ib.a.application,Object(z.a)(this,this.cAa,"triggerCommandforAddinCommands"),4);this.ia.ra(G.a.p7a,ib.a.application,Object(z.a)(this,this.cAa,"triggerCommandforAddinCommands"),4);this.ia.ra(G.a.iUe,ib.a.application,Object(z.a)(this,this.cAa,"triggerCommandforAddinCommands"),
4);this.ia.ra(G.a.NKb,ib.a.application,Object(z.a)(this,this.NKb,"queryAddInCommandsLoadStatus"),96);this.ia.ya(G.a.G1e,ib.a.application,Object(z.a)(this,this.cAa,"triggerCommandforAddinCommands"));this.ia.ra(G.a.YU,ib.a.application,Object(z.a)(this,this.cAa,"triggerCommandforAddinCommands"),64);this.ia.ra(G.a.xMb,ib.a.application,Object(z.a)(this,this.cAa,"triggerCommandforAddinCommands"),64);this.ia.ya(G.a.huc,ib.a.application,Object(z.a)(this,this.cAa,"triggerCommandforAddinCommands"));this.ia.ra(G.a.c$b,
ib.a.application,Object(z.a)(this,this.cAa,"triggerCommandforAddinCommands"),64);this.ia.ya(G.a.GOb,ib.a.application,Object(z.a)(this,this.cAa,"triggerCommandforAddinCommands"));this.ia.ya(G.a.H5b,ib.a.application,Object(z.a)(this,this.cAa,"triggerCommandforAddinCommands"))}pe(){}cAa(u,P,la,Ba,Sa){if(!this.g5)return 16;if(1===la)return P=u===G.a.p7a&&(!this.eQ||!this.eQ.Qyj(Sa)),u=u===G.a.p7a&&!!this.eQ&&this.eQ.Lrl(Sa),P||u?8:32;if(this.eQ)switch(u){case G.a.s4c:this.eQ.t4c(Sa);break;case G.a.p7a:this.eQ.n9b(Sa);
break;case G.a.NKb:this.eQ.cjh(Sa);break;case G.a.G1e:this.eQ.Pul();break;case G.a.YU:this.eQ.CVk(Sa);break;case G.a.xMb:this.eQ.xMb(Sa);break;case G.a.iUe:this.eQ.R1k();break;case G.a.huc:this.eQ.huc(Sa);break;case G.a.c$b:this.eQ.c$b(Sa);break;case G.a.GOb:this.eQ.GOb(Sa);break;case G.a.H5b:this.eQ.H5b(Sa)}else this.eM.Eja(),this.eM.zQa(u,Sa);return 32}NKb(u,P,la,Ba,Sa){if(!this.g5)return 16;this.eQ&&this.eQ.cjh(Sa);return 32}}Object(r.a)(Ii,"AddinCommandsActor",null,[251]);var Kk=d(1032),Ch=d(214),
fi=d(87),Lk=d(174),$h=d(43),Yl=d(1054),Cl=d(275);class ol{constructor(u,P,la,Ba,Sa,pb,Vb,Bc,Yc,gd,Td,Re,Uf,Ef,Oh,ek,je,Qf,Jg,Ei,wj,Ti,pf,tk,Qk,Bk){this.mfc=null;this.gyg=!1;this.NXa=null;this.rDg=Ud.a("PartialDoc.SkipCutCopyCallout");if(!Bk)throw Error.argumentNull("calloutNotificationAdapter");this.ia=u;this.qf=P;this.Fa=la;this.pa=Ba;this.lq=Sa;this.ME=pb;this.kYg=Vb;this.qik=Bc;this.uok=Yc;this.K6c=gd;this.Vb=Td;this.a9c=Qf.Whg;this.Vu=Re;this.oc=Ei;this.Vdk=Qf.powerPointEditorDownloadACopyUiIsEnabled;
this.dnk=Uf;this.s7c=Ef;this.Ya=je;this.WYa=!Qf.yg;this.BWg=wj;this.cZg=pf;this.ZKg=tk;this.Jw=Qk;this.CBg=!Qf.printingEnabled||Jg.ka("DisablePrint");this.DBg=Oh;this.ul=ek;this.ugk=Jg.Ha("DownloadPdfFromPodsUrl");this.m_printUrl=Jg.Ha("PrintPdfFromPodsUrl");this.tgk=Jg.Ha("DownloadOdpFromPodsUrl");this.VBg=Jg.Ha("DownloadImagesFromPodsUrl");this.Vok=Jg.ka("UseToastForDeferredBlobsEnabled");this.Ypk=Qf.pptAppendFileNameToQueryUrlForDocumentOperationsActor;u=(v.AFrameworkApplication.fileName||"").toLowerCase();
Qf.yg&&Qf.EVj?(this.gyg=!0,this.mfc=Jg.Ha("DownloadACopyPodsUrl")):!Qf.yg&&Qf.O1j&&(u.endsWith(".pptx")||u.endsWith(".ppsx"))?this.mfc=this.vtk():this.mfc=v.AFrameworkApplication.BSa;this.Hze=Ti;this.Mjk=Qf.Z1c;this.lxa=w.a.instance.Ia("Common.ISystemInitiatedFeedback");this.pjk=Jg.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1);this.yH=Bk}vb(){const u=!!this.DBg&&!this.BWg();L.a.J(512500629,801,50,"Limited printing access: {0}, Message shown: {1}",this.CBg,
u);this.CBg?u&&this.ul.iwl(this.DBg):(this.ia.ya(tb.a.print,ib.a.application,Object(z.a)(this,this.MDj,"handlePrint")),this.ia.ya(tb.a.downloadACopy,ib.a.application,Object(z.a)(this,this.downloadACopy,"downloadACopy")),this.ia.ya(tb.a.L4b,ib.a.application,Object(z.a)(this,this.L4b,"downloadACopyAsPdf")),this.ia.ya(tb.a.K4b,ib.a.application,Object(z.a)(this,this.K4b,"downloadACopyAsOdp")),this.ia.ya(tb.a.M4b,ib.a.application,Object(z.a)(this,this.M4b,"downloadAsImages")),this.ia.ya(tb.a.hYe,ib.a.application,
Object(z.a)(this,this.hYe,"saveSlidesAsImages")),this.ia.ya(tb.a.Ooc,ib.a.application,Object(z.a)(this,this.$Rk,"pptoSaveACopy")),this.ia.ya(tb.a.OPe,ib.a.application,Object(z.a)(this,this.aSk,"pptoSaveAsToHost")),this.ia.ya(tb.a.PPe,ib.a.application,Object(z.a)(this,this.bSk,"pptoSaveToSharePoint")),this.ia.ya(tb.a.CQe,ib.a.application,Object(z.a)(this,this.ODj,"handlePrintNotes")),this.ia.ya(tb.a.AQe,ib.a.application,Object(z.a)(this,this.NDj,"handlePrintHandouts")));this.ia.ya(G.a.W0a,ib.a.application,
Object(z.a)(this,this.W0a,"saveFileChange"));this.kYg&&this.ia.ra(tb.a.fnd,ib.a.application,Object(z.a)(this,this.fnd,"querySaveStatus"),96);this.Hze.execute(Object(z.a)(this,this.Dmc,"onHostPostmessengerCreated"))}pe(){const u=this.Fa.Fc(ob.a.xti);u.bindAction(xb.KeyInputManager.Qa(oa.a.Tnb,xb.KeyInputManager.Re),tb.a.print);u.bindAction(xb.KeyInputManager.Qa(oa.a.xNa,xb.KeyInputManager.Re),G.a.ve);u.bindAction(xb.KeyInputManager.Qa(oa.a.$zd,xb.KeyInputManager.Re),G.a.ve);u.bindAction(xb.KeyInputManager.Qa(oa.a.pZ,
xb.KeyInputManager.Re),G.a.ve);u.bindAction(xb.KeyInputManager.Qa(oa.a.pZ,xb.KeyInputManager.Re|4),G.a.ve)}aSk(u,P,la){return this.aYe(la,G.a.KMb,"SaveAsToHost")}$Rk(u,P,la){return this.aYe(la,G.a.fsc,"SaveACopy")}bSk(u,P,la){return this.aYe(la,G.a.Jkb,"SaveToSharePoint")}aYe(u,P,la){if(1===u)return v.AFrameworkApplication.cC||v.AFrameworkApplication.VQ?8:this.ia.processAction(P,1);if(this.Jw.hasDeferredContent()&&(L.a.J(512500628,843,15,"{0} is triggered while document has deferred content",la),
!this.Vok))return this.Jw.J1e(la,null,null),8;this.ysb(la);return this.Ya.vea?(L.a.J(512500627,801,50,"DocumentOperationsActor:SaveAsImpl - Inline Repair Case , ActionId: {0}",P),this.ia.Ka(tb.a.MMb,2,P)):this.ia.processAction(P,2)}downloadACopy(u,P,la,Ba,Sa){if(this.qf.$c(this.lq))return 16;if(1===la)return!this.oc.Cj()||v.AFrameworkApplication.VQ?8:ol.FZf()?32:this.Nub();if(this.Jw.hasDeferredContent())return L.a.J(512500626,843,15,"DownloadACopy is triggered while document has deferred content"),
this.rDg&&this.yH.H3d(),this.Jw.J1e("DownloadACopy",new Yl.a,()=>{this.k7e(Sa)}),this.Jw.Xra("DownloadACopyRequestedTime",$h.a.uf(new Date)),8;this.pa.nh();this.Fa.Bd();L.a.J(512500625,801,50,"PPT save and download a copy");this.Ya.vea?this.k7e(Sa):(this.Vu.show(!0,u),this.ME.U3(!1,this.WYa,()=>{this.k7e(Sa)},Object(z.a)(this,this.Qya,"saveFailureCallback")));this.ysb("DownloadACopy");return 32}k7e(u){this.Vu.hide();let P;P=ol.FZf()?v.AFrameworkApplication.BSa:this.gyg?this.ftb(this.mfc):this.mfc;
u&&u.FileDownloadUrl&&(P=u.FileDownloadUrl.toString());this.Pak();this.ZKg&&!this.ZKg()&&this.cZg&&this.cZg("3555692408")?this.NXa.sendMessage(Jd.a.download,{}):this.Vdk?(this.dnk.Pwl(P),this.Jw.Xra("DownloadModalTime",$h.a.uf(new Date))):this.Vb.KM(!0,P,!0)}Pak(){this.pjk&&this.lxa&&this.lxa.execute(u=>{u.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled")})}fnd(u,P,la,Ba,Sa){u="";this.kYg&&(u=this.qik.eX(this.lq)?String.format(ResourceStrings.L_SavingStatus):
this.a9c?String.format(CommonUIStrings.l_SavedToStatus,this.a9c):String.format(ResourceStrings.L_SavedStatus));Sa[Nd.a.Value]=u;return 32}MDj(u,P,la){return this.BQe(la,0,u)}ODj(u,P,la){return this.BQe(la,8,u)}NDj(u,P,la){return this.BQe(la,4,u)}BQe(u,P,la){if(this.qf.$c(this.lq))return 16;if(1===u)return!this.oc.Cj()||v.AFrameworkApplication.VQ?8:this.Nub();if(this.BWg())return L.a.J(512500624,328,50,"Printing not allowed for IRM protected documents"),16;L.a.J(512500623,328,50,"PPT Editor print. PublishOption: {0}",
P);this.pa.nh();this.Fa.Bd();this.Ya.vea?this.Oth(P):(this.Vu.show(!0,la),this.ME.U3(!1,this.WYa,()=>{this.Oth(P)},Object(z.a)(this,this.Qya,"saveFailureCallback")));this.ysb("Print-"+la);return 32}Oth(u){this.Vu.hide();this.uok.print(this.Ya.presentationId.string,this.ftb(this.m_printUrl),u)}L4b(u,P,la){if(this.qf.$c(this.lq))return 16;if(1===la)return!this.oc.Cj()||v.AFrameworkApplication.VQ?8:this.Nub();this.s7c.hVf=new Date;this.pa.nh();this.Fa.Bd();this.Ya.vea?this.Lth():(this.Vu.show(!0,u),
this.ME.U3(!1,this.WYa,()=>{this.Lth()},Object(z.a)(this,this.Qya,"saveFailureCallback")));this.ysb("DownloadACopyAsPDF");return 32}Lth(){this.Vu.hide();this.s7c.Tth=new Date;this.K6c.convert(this.Ya.presentationId.string,1,this.ftb(this.ugk))}M4b(u,P,la){if(this.qf.$c(this.lq))return 16;if(1===la)return!this.oc.Cj()||v.AFrameworkApplication.VQ?8:this.Nub();this.pa.nh();this.Fa.Bd();this.Ya.vea?this.Mth():(this.Vu.show(!0,u),this.ME.U3(!1,this.WYa,()=>{this.Mth()},Object(z.a)(this,this.Qya,"saveFailureCallback")));
this.ysb("DownloadAsImages");return 32}hYe(u,P,la){if(this.qf.$c(this.lq))return 16;if(1===la)return!this.oc.Cj()||v.AFrameworkApplication.VQ?8:this.Nub();this.pa.nh();this.Fa.Bd();this.Ya.vea?this.gVf():(this.Vu.show(!0,u),this.ME.U3(!1,this.WYa,()=>{this.gVf()},Object(z.a)(this,this.Qya,"saveFailureCallback")));this.ysb("SaveSlidesAsImages");return 32}Mth(){this.Vu.hide();this.K6c.convert(this.Ya.presentationId.string,2,this.ftb(this.VBg))}gVf(){this.Vu.hide();var u=this.ftb(this.VBg),P=this.pa.Se();
0<P.length&&(P=Lk.c(P,la=>la.sid.toString()).join(","),u=new ya.QueryStringBuilder(u),u.jg(fi.a.uyl,P),this.K6c.convert(this.Ya.presentationId.string,2,u.toString()))}K4b(u,P,la){if(this.qf.$c(this.lq))return 16;if(1===la)return!this.oc.Cj()||v.AFrameworkApplication.VQ?8:this.Nub();if(this.Jw.hasDeferredContent())return this.rDg&&this.yH.H3d(),L.a.J(512500622,843,15,"DownloadACopyAsOdp is triggered while document has deferred content"),this.Jw.J1e("DownloadACopyAsOdp",new Yl.a,()=>{this.bYe()}),8;
this.pa.nh();this.Fa.Bd();this.Ya.vea?this.bYe():(this.Vu.show(!0,u),this.ME.U3(!1,this.WYa,()=>{this.bYe()},Object(z.a)(this,this.Qya,"saveFailureCallback")));return 32}Qya(){this.Vu.hide();return!1}bYe(){this.Vu.hide();this.K6c.convert(this.Ya.presentationId.string,0,this.ftb(this.tgk))}W0a(u,P,la,Ba,Sa){if(this.qf.$c(this.lq))return 16;if(1===la)return 32;this.pa.nh();this.Fa.Bd();this.ME.U3(!1,!0,pb=>{if(Sa&&1<=Sa.length)Sa[0](pb)},pb=>Sa&&2<=Sa.length?(Sa[1](pb,pb.ServerError.Code),!0):!1);return 32}vtk(){const u=
new ya.QueryStringBuilder(Bd.a.Lta("DownloadACopyHandler.ashx"));u.jg(fi.a.Kkd,this.Ya.presentationId.string);u.jg(fi.a.xoa,this.Ya.sessionInfo);u.jg("fn",v.AFrameworkApplication.fileName);v.AFrameworkApplication.AQa(u);return u.toString()}ftb(u){if(u){const P=new ya.QueryStringBuilder(u);this.Ya&&this.Ya.podSessionId&&0>u.indexOf(this.Ya.podSessionId)&&(P.zIc(fi.a.Aaa+"="+this.Ya.podSessionId),L.a.J(512500620,801,50,"Append PodSessionId in url: {0}",this.Ya.podSessionId));this.Ypk&&v.AFrameworkApplication.du.rx&&
0<v.AFrameworkApplication.du.rx.length&&(P.jg(fi.a.feh,v.AFrameworkApplication.du.rx),L.a.J(512500619,801,50,"Appended FileName in url"));this.Mjk&&(P.jg(fi.a.NLk,"true"),L.a.J(512500618,801,50,"Appended IsPasswordProtectedFile param"));v.AFrameworkApplication.AQa(P);return P.toString()}return null}ysb(u){const P=Ch.a.Y3(Cl.a.M_a,!0);L.a.J(509448414,801,15,"DocOperation={0};SimplifiedRibbonON={1}",u,P)}Dmc(u){this.NXa=u}Nub(){return v.AFrameworkApplication.cC?8:32}static FZf(){const u=v.AFrameworkApplication.cC,
P=!lb.a.Xa(v.AFrameworkApplication.BSa),la=v.AFrameworkApplication.fa.ka("SupportsOfficeClientCoauthoring"),Ba=v.AFrameworkApplication.fa.ka("PPTClpSwitchEnabled");L.a.J(512500617,801,50,"FIsClpProtectedFileAndDownloadEnabled - fProtected:{0} fHasDownload:{1} fClpTenantSwitchEnabled:{2} fClpPPTSwitchEnabled:{3}",u,P,la,Ba);return u&&P&&la&&Ba}}Object(r.a)(ol,"DocumentOperationsActor",null,[251]);class Zk{}Zk.sg="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";
Object(r.a)(Zk,"EmbedDialogHtml",null,[]);class lk{constructor(u,P,la,Ba){this.HNe=u;this.m4=P;this.bdh=la;this.value=Ba}}Object(r.a)(lk,"OptionInfo",null,[]);class $k{constructor(u,P,la){this.wYe=u;this.Szb=P;this.m4=la}}Object(r.a)($k,"SectionInfo",null,[]);var cj=d(318);class fg extends Ke.a{constructor(u,P=!1){super(!1,!1,P);this.wff=476;this.zAc=288;this.gXh=798;this.K4h=476;this.I4h=288;this.Lkd={};this.b1a=[];this.LP=this.BBa=this.mLd=this.lAc=this.uEc=this.Rqb=null;this.QTb=v.AFrameworkApplication.Kzb;
this.XEc=u;this.kLd=Object(z.a)(this,this.bKk,"optionClickHandler");this.lLd=Object(z.a)(this,this.cKk,"optionKeyHandler");this.eBd=Object(z.a)(this,this.wni,"arrowClickHandler");this.nob=Object(z.a)(this,this.xni,"arrowKeyHandler");this.fHc=Object(z.a)(this,this.cFl,"textAreaOnFocusHandler");this.F0h=P;this.sg=Zk.sg;this.Ad=0;this.kg="EmbedDialog"}get Gpb(){return this.zAc}set Gpb(u){this.zAc=u}LCh(u){const P={["id"]:this.kg,["bodyControls"]:{},["embedPreviewSectionTitle"]:CommonUIStrings.l_Preview,
["embedCodeSectionTitle"]:CommonUIStrings.l_EmbedCode,["dimensionsSectionTitle"]:CommonUIStrings.l_Dimensions,["interactionSectionTitle"]:CommonUIStrings.l_Interaction,["initialPreviewUrl"]:Bd.a.Ti(this.XEc,"wdPreview","1"),["initialEmbedUrl"]:this.QTb,["getEmbedCode"]:fg.G6f,["codeCopiedText"]:CommonUIStrings.l_EmbedCodeCopied};for(const la of Object.keys(u))P[la]=u[la];this.Ad=1;this.Oe(1,CommonUIStrings.l_CopyAction);this.Oe(0,CommonUIStrings.l_Close);this.pj(CommonUIStrings.l_Embed,null,P)}Olb(){if(this.F0h)this.LCh({});
else{this.showDialog(CommonUIStrings.l_Embed,null);this.Rqb=document.getElementById("embedpreviewpane");this.uEc=document.getElementById("embedoptionpane");this.Rqb.style.width=String.format("{0}px",this.K4h);this.BBa=document.createElement("iframe");this.BBa.className=fg.H4h;this.BBa.frameBorder="0";this.BBa.style.height=String.format("{0}px",this.I4h);this.BBa.tabIndex=-1;this.Rqb.appendChild(this.JOc(CommonUIStrings.l_Preview,this.BBa,fg.iqf,fg.J4h,fg.iqf,!0));this.LP=document.createElement("textarea");
this.LP.className=fg.MXh;Sys.UI.DomElement.addCssClass(this.LP,cj.a.GCa);this.LP.id=fg.NXh;qd.a.Vi||(this.LP.readOnly=!0);this.LP.rows=4;this.LP.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName;this.LP.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;this.LP.setAttribute(Ha.a.e_,String.format("{0} {1}",fg.vff,fg.uff));this.Rqb.appendChild(this.JOc(CommonUIStrings.l_EmbedCode,this.LP,fg.vff));Be.a.addHandler(this.LP,"focus",this.fHc);var u=document.createElement("span");u.className=fg.LYh;
u.innerText=CommonUIStrings.l_CopyText;u.id=fg.uff;this.Rqb.appendChild(u);this.lAc=document.createElement("div");this.lAc.className=fg.jXh;this.uEc.appendChild(this.JOc(CommonUIStrings.l_Dimensions,this.lAc));this.mLd=document.createElement("div");this.uEc.appendChild(this.cKi(fg.J3h,this.mLd));this.Ad=0;this.Oe(1,CommonUIStrings.l_Close);this.rNh();this.pOh();qd.a.Vi||this.LP.focus()}}dispose(){if(this.Lkd){var u=this.Lkd;for(let P in u){const la=u[P];this.Hn.Bb(Ca.a.click,la.HNe,this.kLd);this.Wg.Bb(Ca.a.Bf,
la.HNe,this.lLd);this.Wg.Bb(Ca.a.Tl,la.HNe,this.lLd)}this.lLd=this.kLd=this.Lkd=null}if(this.b1a){for(u=0;u<this.b1a.length;++u)this.Hn.Bb(Ca.a.click,this.b1a[u].Szb,this.eBd),this.Wg.Bb(Ca.a.Bf,this.b1a[u].Szb,this.nob),this.Wg.Bb(Ca.a.uy,this.b1a[u].Szb,this.nob),this.Wg.Bb(Ca.a.Tl,this.b1a[u].Szb,this.nob);this.Wg=this.eBd=this.b1a=null}this.fHc&&this.LP&&(Be.a.removeHandler(this.LP,"focus",this.fHc),this.fHc=null);this.LP=this.BBa=this.mLd=this.lAc=this.uEc=this.Rqb=null;super.dispose()}Iaa(){super.Iaa();
this.Ib.style.width=String.format("{0}px",this.gXh);this.VCa()}sNh(u,P){const la=Bd.a.Ti(this.QTb,u,P);return this.QTb!==la?(this.QTb=la,this.XEc=Bd.a.Ti(this.XEc,u,P),!0):!1}rNh(){this.LP&&(this.LP.innerText=fg.G6f(this.QTb,this.wff,this.zAc))}pOh(){this.BBa&&this.BBa.contentWindow.location.replace(Bd.a.Ti(this.XEc,"wdPreview","1"))}eOl(u,P){this.sNh(u,P)&&(this.rNh(),this.pOh())}JOc(u,P,la=null,Ba=null,Sa=null,pb=!1){const Vb=document.createElement("div");Vb.className=fg.z6h;Ba&&(Vb.id=Ba);Sa&&
Vb.setAttribute(Ha.a.e_,Sa);pb&&(Vb.tabIndex=0);Ba=document.createElement("span");Ba.className=fg.A6h;Ba.innerText=u;la&&(Ba.id=la);Vb.appendChild(Ba);Vb.appendChild(P);return Vb}cKi(u,P){const la=this.JOc(CommonUIStrings.l_Interaction,P),Ba=this.oi.createElement("div");Ba.className=fg.mUh;Ba.id=fg.oUh+u;Ba.setAttribute(Ha.a.hf,Ha.a.Ju);Ba.tabIndex=0;la.insertBefore(Ba,P);u=ha.createClusteredImage(16,16,fg.nUh,fg.pUh,!0,"");Ba.appendChild(u);u=u.childNodes[0];u.className=ha.getImageClass(fg.Xef);
u.title=CommonUIStrings.l_Expand;Ba.title=CommonUIStrings.l_Expand;P.style.visibility="hidden";P=new $k(P,Ba,u);Array.add(this.b1a,P);this.Hn.aV(Ca.a.click,Ba,this.eBd,P);this.Wg.aV(Ca.a.Bf,Ba,this.nob,P);this.Wg.aV(Ca.a.uy,Ba,this.nob,P);this.Wg.aV(Ca.a.Tl,Ba,this.nob,P);return la}wni(u){this.XIf(u);return!0}xni(u){return this.V3c(u,Object(z.a)(this,this.XIf,"changeArrowState"))}XIf(u){u=u.OD;"visible"===u.wYe.style.visibility?(u.wYe.style.visibility="hidden",u.m4.className=ha.getImageClass(fg.Xef),
u.m4.title=CommonUIStrings.l_Expand,u.Szb.title=CommonUIStrings.l_Expand):(u.wYe.style.visibility="visible",u.m4.className=ha.getImageClass(fg.Z9h),u.m4.title=CommonUIStrings.l_Collapse,u.Szb.title=CommonUIStrings.l_Collapse)}bKk(u){this.adh(u);return!0}cKk(u){return this.V3c(u,Object(z.a)(this,this.adh,"optionHandler"))}adh(u){const P=this.Lkd[u.OD.toString()];P.value?(P.value=0,P.m4.className=ha.getImageClass(fg.L9h),P.bdh.setAttribute(Ha.a.cDf,Ha.a.pja)):(P.value=1,P.m4.className=ha.getImageClass(fg.uVh),
P.bdh.setAttribute(Ha.a.cDf,Ha.a.lB));this.eOl(u.OD.toString(),P.value.toString())}cFl(){this.LP.select()}static G6f(u,P,la){if(!fg.xKd){const Ba=String.format('<a target="_blank" href="{0}">{1}</a>',lb.a.i$b("https://office.com"),CommonUIStrings.l_Office),Sa=String.format('<a target="_blank" href="{0}">{1}</a>',lb.a.i$b("https://office.com/webapps"),CommonUIStrings.l_WebAppName);fg.xKd=String.format(CommonUIStrings.l_NoFrames,Ba,Sa)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',
lb.a.i$b(u),P,la,fg.xKd)}}fg.xKd=null;fg.uVh="CheckboxChecked_16x16x32";fg.L9h="CheckboxUnchecked_16x16x32";fg.Z9h="OutlookSearchChevronUp_16x16x32";fg.Xef="OutlookSearchChevronDown_16x16x32";fg.nUh="UpArrowServer";fg.z6h="EmbedSectionHeader";fg.A6h="EmbedSectionName UIFontBold";fg.LYh="EmbedCodeFooter";fg.H4h="EmbedPreviewFrame";fg.MXh="EmbedCodeTextArea";fg.jXh="EmbedDimensionSection";fg.pUh="EmbedArrowIcon";fg.mUh="WACGlyph EmbedArrowHolder";fg.NXh="EmbedCode";fg.vff="EmbedCodeHeader";fg.iqf="Preview";
fg.J4h="PreviewHeader";fg.J3h="Options";fg.oUh="Arrow";fg.uff="EmbedCodeFooter";Object(r.a)(fg,"EmbedDialog",Ke.a,[]);class al extends fg{constructor(u,P){super(u,!0);P&&P&&!isNaN(P)||L.a.J(539762772,820,10,"Invalid aspectRatio in ReactEmbedDialog");this.sNh(fi.a.ELk,P.toString())}Olb(){const u=[];u.push({["id"]:"wdEaaCheck",["checkboxInitialValue"]:!1,["checkboxLabel"]:ResourceStrings.l_AutoAdvanceLabel,["urlTransformFunctionOnChange"]:al.S_k});this.LCh({["dimensionsOptions"]:{["isMultipleChoice"]:!1,
["defaultWidth"]:this.wff,["defaultHeight"]:this.zAc,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:ResourceStrings.l_EmbedSlideWidth,["heightLabel"]:ResourceStrings.l_EmbedSlideHeight},["interactionOptions"]:u})}static S_k(u,P,la){return"wdEaaCheck"===P?Bd.a.Ti(u,P,la?"1":"0"):u}}Object(r.a)(al,"ReactEmbedDialog",fg,[]);class gi{constructor(u,P,la,Ba,Sa){this.TGa=null;this.cxe=!1;this.NXa=null;this.Vb=u;this.oze=P;this.vfc=la;this.Hze=Ba;this.Ya=Sa}Olb(u,P,la){(u=(u=v.AFrameworkApplication.fK)||
this.Ya.vea)||this.cxe||(u=!this.hKh());return 1===la?u?2:32:this.Bvl()}Bvl(){if(!this.cxe)return 8;if(v.AFrameworkApplication.Kzb&&this.vfc)this.YBh();else{const u=v.AFrameworkApplication.W9e?this.NXa.sendMessage(Jd.a.K3i,null)?32:8:2;return 32!==u?this.Vb.KM(!0,v.AFrameworkApplication.$6d):u}return 32}Avl(u){u.Values.HostEmbeddedViewUrl&&(this.vfc=v.AFrameworkApplication.Kzb=u.Values.HostEmbeddedViewUrl.toString(),this.YBh())}hKh(){return!1}Lbi(u,P){this.TGa=P;this.cxe=!!this.Vb&&!!this.oze&&!(void 0===
this.vfc||null===this.vfc)&&!!u&&!!P}YBh(){(new al(this.vfc,this.TGa)).Olb()}}Object(r.a)(gi,"EmbedManager",null,[]);class rm{constructor(u,P,la){this.TGa=null;this.Chk={};for(P=0;P<u.length;P++)this.Chk[u[P].Format.toString()]=P;this.TGa=la&&!isNaN(la)&&isFinite(la)?la:0}}Object(r.a)(rm,"FormatPicker",null,[]);class xa extends gi{constructor(u,P,la,Ba,Sa,pb,Vb,Bc){super(u,P,la,pb,Vb,Bc);this.ia=Ba;this.Sb=Sa}vb(){this.ia.ya(tb.a.Olb,ib.a.application,Object(z.a)(this,this.Olb,"showEmbedDialog"));
this.Hze.execute(Object(z.a)(this,this.Dmc,"onHostPostmessengerCreated"))}pe(){}hKh(){var u=this.Sb.Ou();if(!this.oze||!u.height)return!1;u=u.width/u.height;const P=new rm(this.oze,!1,u);this.Lbi(P,u);return!0}Dmc(u){this.NXa=u;v.AFrameworkApplication.isEmbedded||v.AFrameworkApplication.Kzb||!this.NXa||(this.NXa.Iu(Jd.a.UHf),this.NXa.dC(Jd.a.UHf,Object(z.a)(this,this.Avl,"showEmbedDialogPostMessage")))}}Object(r.a)(xa,"EmbedActor",gi,[251]);var Ff=d(40),Ri=d(746),vj=d(697);class Hg{constructor(u,
P,la,Ba,Sa,pb,Vb,Bc,Yc,gd,Td,Re){this.ia=u;this.Ufb=P?P.va:null;this.ta=la;this.$b=Ba;this.kb=Sa;this.Rq=pb;this.Eb=Vb;this.xk=Bc;this.Ud=Yc;this.aDb=null;this.Fa=gd;this.lq=la.presentation;this.Ie=Td;this.Ve=null;this.Cfb=Re}vb(){this.ia.ra(tb.a.xCh,Ff.a.application,Object(z.a)(this,this.sGj,"handleUploadAudioDialog"),4)}pe(){}sGj(u,P,la){const Ba=this.ta.Ba;if(!Ba||this.$b.$c(Ba))return 16;if(1===la)return 32;if(this.Ufb){this.Ve=$h.a.kk("Audio::Insert");try{return vj.a.B2e("audio/*",Ri.e,()=>Ri.d(u,
Object(z.a)(this,this.HPj,"insertAudioSuccessAfterUploadUsingMediaUpload"),"audio",this.Ie,Ba),"audio",Ba,this.ta.presentation,this.$b,this.Ud,this.Ve,!1,this.Cfb,50,10,3),this.Ve&&this.Ve.Wa("AudioDialogInitialized","true"),32}catch(Sa){L.a.J(509724633,818,10,"Error while rendering new audio selection dialog.")}}else return L.a.J(512500560,822,15,"Insert Audio initialization failed."),8;this.showErrorMessage(446,null);return 8}showErrorMessage(u,P){this.Ve&&(this.Ve.finish(),this.Ve=null);this.Ud.nH(u,
la=>{la.KC=1;la.bTa=P;return!1})}HPj(u,P,la,Ba,Sa,pb,Vb){Ba.hO(la)&&L.a.J(512500553,822,15,"Audio::InsertAudioSuccessAfterUploadUsingMediaUpload:Presentation was blocked with loader for {0} milliseconds",+new Date-+la.Mja);Ba.xK(la);Sa&&Sa.Wa("AudioUploadToRC","true");Object(Ud.a)("FixForInsertMediaSlideNavigationIssue")||(Vb=this.ta.Ba);la=Vb.zs();var Bc=this.lq.slideWidth,Yc=this.lq.slideHeight;Ba=nc.a.gf(32,0);const gd=nc.a.gf(32,1);Bc=Bc/2-nc.a.gf(16,0);Yc=Yc/2-nc.a.gf(16,1);if(Vb&&Vb.isConnected){var Td=
this.Eb.xd(15,void 0,void 0,()=>{this.Rq.lA=this.aDb;this.kb.selectShape(this.aDb,!0);this.Fa.Bd()});try{Td.hc(Vb);Td.fd=u;Sa&&Sa.Wa("CreatingAudioShape","true");this.aDb=this.xk.ADa(!1,Vb.Db.cid,Vb.Db.sid,0,10,Bc,Yc,Ba,gd,la+1);const Re=pb.files[0].name;this.aDb.u0b=P;this.aDb.s0b=Re;Vb.jB(this.aDb)}finally{Td&&Td.dispose()}Sa&&(Sa.Wa("AudioShapeSuccessfullyCreated","true"),Sa.finish(),Sa=null)}}}Object(r.a)(Hg,"InsertAudioActor",null,[251]);var ua=d(106);class eb{constructor(){this.Xzb=this.$sb=
null}}Object(r.a)(eb,"CreatePickerCustomizationDictionaryOptions",null,[1581]);var Tb=d(162),uc=d(29);class yd{}yd.sg="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(r.a)(yd,"InsertMediaDialogHtml",null,[]);class oe{}oe.sg="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";
Object(r.a)(oe,"InsertMediaM365DialogHtml",null,[]);var $d=d(398);class ve{static get sg(){return Ke.a.VC(ve.Fo,ResourceStrings.l_InsertOnlineVideoDescription,ResourceStrings.l_InsertOnlineVideoPrivacy,ResourceStrings.L_LearnMore,"http://go.microsoft.com/fwlink/?linkid=2010177")}}ve.Fo="<div class='VideoUrl' id='videourl'> <label id='labelVideoUrl' class='WACDialogLabel' for='url' >{0}</label> </div> <div class='VideoUrl' id='videourl'> <input type='text' id='url' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='VideoOutput' id='videooutput'> <label id='privacyandtos' class='WACDialogLabel' >{1}</label> </div> <div class='LearnMore' id='learnmore'> <a id='learnmore' class='LearnMore' href={3} target='newtab' >{2}</a> </div> <div class='VideoOutput' id='videooutput'> <label id='labelmessage' class='WACDialogLabel' >message</label> </div>";
Object(r.a)(ve,"InsertOnlineVideoDialogHtml",null,[]);class hc extends Ke.a{constructor(u){super();this.dF(1,!0);this.Oe(1,ResourceStrings.L_Insert);this.sg=ve.sg;this.u$=u;this.RV=!1}Nga(){this.width=50;this.pj(ResourceStrings.L_OnlineVideo,Object(z.a)(this,this.$Pj,"insertOnlineVideoDialogHandler"),{["url"]:""});document.getElementById("labelmessage").innerText="";document.getElementById("labelmessage").setAttribute(Ha.a.sKc,Ha.a.mni);const u=document.getElementById("url");this.dF(1,!!u&&0<u.value.length);
Be.a.addHandler(u,Ca.a.input,Object(z.a)(this,this.tjd,"onPatternChanged"));Be.a.addHandler(u,Ca.a.change,Object(z.a)(this,this.tjd,"onPatternChanged"));this.eS(u)}hide(){const u=document.getElementById("url");u&&(Be.a.removeHandler(u,Ca.a.input,Object(z.a)(this,this.tjd,"onPatternChanged")),Be.a.removeHandler(u,Ca.a.change,Object(z.a)(this,this.tjd,"onPatternChanged")));super.hide()}$Pj(u,P){if(1===u){if(P){var la=$h.a.kk("InsertOnlineVideo",1);la.vr=!0;u=P.url.trim();(u=this.u$.K1i(u))?this.u$.ptg(u)&&
this.u$.$5j(u)?(L.a.J(512500548,352,50,"[Insert Online Video] Creating Hubble request for {0}",this.u$.y6f(u)),this.u$.requestVideoData(u,Ba=>{$h.a.NF(la,()=>{this.cZ(Ba)})},Object(z.a)(this,this.O2i,"failCallback"))):(L.a.J(512500547,352,10,"[Insert Online Video] Dialog url doesn't match, given url: "+this.u$.y6f(u)),this.fail(null,ResourceStrings.l_InsertOnlineVideoUnsupportedProvider)):(L.a.J(512500549,352,10,"[Insert Online Video] Dialog url is null!"),this.fail(null,ResourceStrings.l_InsertOnlineVideoIframeError))}}else this.hide()}cZ(u){this.hide();
this.u$.Jkg(u)}O2i(u){this.fail(u,ResourceStrings.l_CannotInsertOnlineVideo)}fail(u,P){if(document.getElementById("labelmessage")){var la=+new Date-+this.u$.startTime;document.getElementById("labelVideoUrl").removeAttribute("for");document.getElementById("labelmessage").innerText=P;document.getElementById("labelmessage").setAttribute("for","url");document.getElementById("url").focus();u&&L.a.J(512500545,352,10,"InsertOnlineVideoDialog:Fail {0}",JSON.stringify({["TimeMs"]:la,["ResponseCode"]:u.data.Ke}))}else L.a.J(512500546,
352,15,"[Insert Online Video] Request failed after the dialog dissapeared!")}tjd(){$h.a.zGa();const u=document.getElementById("url");this.dF(1,!!u&&0<u.value.length)}}Object(r.a)(hc,"InsertOnlineVideoDialog",Ke.a,[946]);var Of=d(63),Nc=d(1130),$e=d(60);class lj{constructor(u,P,la){this.hVb=df.a.t8;this.GG=null;this.Ca=u;this.EGd=P;this.aCa=la}get qn(){return this.Ca}get q8(){return this.GG||(this.GG=w.a.instance.resolve("Common.Utils.IAriaNotifier"))}get zx(){return this.hVb}set zx(u){this.hVb=u}Fua(u){try{n.ULS.sendTraceTag(21612195,
352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",u.length);const P=this.EGd.HSk(u);let la=2;if(P&&0<P.length){const Ba=new Nc.DictionaryPropertySet;Ba.setValue($e.a.VU,P);Ba.setValue($e.a.y1c,!0);if(this.aCa){const Sa=this.aCa.E3e();Sa.cKc("insertOnlineImage");Ba.setValue($e.a.HRa,Sa)}v.AFrameworkApplication.fa.ka("OneNoteExplicitlyNarrateOnInsertingFilesAndImages")&&this.q8.sendNotification(Box4Intl.Box4Strings.l_ImageUploading,!0);la=this.Ca.Ka(this.zx,2,Ba)}n.ULS.sendTraceTag(21612224,
352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",u.length,32===la,""===P)}catch(P){n.ULS.sendTraceTag(21612225,352,10,"InsertImageFromHostHelper::InsertMediaCallback : Exception = [{0}].",P.toString())}}}Object(r.a)(lj,"InsertOnlineImageHandler",null,[892]);class th extends lj{constructor(u,P,la=null){super(u,P,la)}get BQf(){return Jd.a.insertImage}get Jzb(){return Jd.a.UPj}seh(u){return this.EGd.KMk(u)}hag(u){return u.Type}f1c(u,
P){return this.EGd.f1c(u.Type,P)}teh(u){const P=[];if(u&&u.data&&u.data.value&&0<u.data.value.length)for(let Ba=0;Ba<u.data.value.length;Ba++)if(u.data.value[Ba]&&u.data.value[Ba].urls&&u.data.value[Ba].urls.download){var la=u.data.value[Ba];la=Object.assign(new Bl.a,{OriginalUrl:la.urls.download,Type:la.extension||"",Caption:la.name,ContentType:"",Height:la.driveItem||la.driveItem.image?la.driveItem.image.height:0,Width:la.driveItem||la.driveItem.image?la.driveItem.image.width:0});Array.add(P,la)}P.length||
n.ULS.sendTraceTag(26071184,352,10,"InsertOnlineImageHelper::ParseOneDriveV7Response failed since no valid url was found");return P}wih(u,P,la){la=la(u);if(la.length){u=[];for(let Ba=0;Ba<la.length;Ba++){const Sa=la[Ba],pb={};pb.Extension=Sa.Type;pb.SourceUrl=Sa.OriginalUrl;pb.SourceUrl=Sa.OriginalUrl;pb.Width=Sa.Width;pb.Height=Sa.Height;Array.add(u,pb)}la={};la.Items=u;P.sendMessage(this.Jzb,la)}}}Object(r.a)(th,"InsertOnlineImageHelperBox4",lj,[891,892]);class Ig extends th{constructor(u,P,la){super(u,
P);this.vHe=la.insertOnlineVideoUrlPatterns;this.zx=tb.a.Fie}Fua(u){if(u&&0<u.length){var P=Bd.a.wB(u[0].OriginalUrl);P=this.gqe(P)?P:"unsupported";L.a.J(512517837,352,50,"InsertMediaCallback: Insert online video called for {0}",P);this.qn.Ka(this.zx,2,u[0])}}gqe(u){if(!u)return!1;u=u.trim();for(const P of this.vHe)if((new RegExp(P)).test(u))return!0;return!1}}Object(r.a)(Ig,"InsertOnlineVideoHelper",th,[]);class wk{static get sg(){return Ke.a.VC(wk.Fo,ResourceStrings.l_InsertSocialMediaDialogMsg)}}
wk.Fo="<div class='WACDialogRow' id='block1'> <div class='WACDialogGroupBox' id='SocialmediaLabelDiv' style=\"width:300px;word-wrap: break-word;\"> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> </div>";Object(r.a)(wk,"InsertSocailMediaDialogHtml",null,[]);var bl=d(86),ea=d(237);class Gj extends Sys.EventArgs{constructor(u,P,la,Ba){super();this.slideId=u;this.bZ=la;this.shapeId=P;this.iconName=Ba}}Object(r.a)(Gj,"IconChangedEventArgs",Sys.EventArgs,[]);var Hj=d(502);class mj{constructor(u,
P,la,Ba,Sa,pb,Vb,Bc,Yc,gd,Td,Re,Uf,Ef,Oh,ek,je,Qf,Jg,Ei,wj,Ti,pf,tk,Qk,Bk,Fi,Uj,jm){this.WHa=this.d1c=!1;this.$Gb=this.bna=null;this.rza=(vl,Th,Up)=>{if(!this.eba(this.ta.Ba,vl,this.la.Gbb))return 8;if(1===Up)return 32;let ai,Rl;this.Jb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertCreateWithAI",!1)?Rl="dallecore":this.Jb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertDalle",!1)&&(Rl="dalle");switch(vl){case tb.a.S$b:case tb.a.l_c:Th=new ya.QueryStringBuilder(this.la.Eie);
Th.jg("entryPoint",tb.a.Hv(vl));Rl&&Th.jg(Rl,"1");ai=1;this.kfa.zx=tb.a.T$b;break;case tb.a.wie:case tb.a.xie:Th=new ya.QueryStringBuilder(this.la.Eie);Th.hy("initpivot","dalle");Th.jg("entryPoint",tb.a.Hv(vl));Rl&&Th.jg(Rl,"1");ai=1;this.kfa.zx=tb.a.T$b;break;case tb.a.f_c:Th=new ya.QueryStringBuilder(this.la.k_c);ai=1;this.kfa.zx=tb.a.j_c;break;case tb.a.p8a:Ud.a("ChangePictureFromIconsFixEnabled")?(Th=new ya.QueryStringBuilder(this.la.k_c),this.pma.zx=tb.a.w1b):(Th=new ya.QueryStringBuilder(this.la.iyi),
this.pma.zx=tb.a.cMc);ai=0;break;case tb.a.Gub:Th=new ya.QueryStringBuilder(this.la.$If);Th.jg("entryPoint",tb.a.Hv(vl));Rl&&Th.jg(Rl,"1");ai=0;this.pma.zx=tb.a.w1b;break;case tb.a.eMc:Th=new ya.QueryStringBuilder(this.la.$If);Th.hy("initpivot","dalle");Th.jg("entryPoint",tb.a.Hv(vl));Rl&&Th.jg(Rl,"1");ai=0;this.pma.zx=tb.a.w1b;break;default:return L.a.J(512517955,352,10,"InsertMediaActor::ShowInsertMediaDialogFromM365 : unrecognized actionId",vl.toString()),16}this.Jb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.EnableGettyApiExperiment",
!1)&&(Th.jg("gae","1"),v.AFrameworkApplication.ECb("0fecb342;2aaje503"));this.Jb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.EnableGettyIngestionExperiment",!1)&&(Th.jg("gie","1"),Th.jg("semsearch","1"),v.AFrameworkApplication.ECb("421a8839;gjbhf574"));this.la.Kbb&&Th.jg("sv","1");const qq=Th.toString();if(!qq||!qq.length)return 16;L.a.J(512517954,352,50,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Show dialog.");try{const Vp=ua.a.create(),wn=lb.a.iL(this.la.pptEditingUserId).toString();
this.Rea.execute(Uo=>{var rq=this.la.Akg&&Uo.isFreemiumUpsellEnabled();rq=this.WHa?1:rq?0:-1;var il=this.Jb.ka("InsertOnlineM365ExperimentEnabled")?1:0;il=this.rM.vFf(uc.App.mode,qq,rq,ai,Vp.toString(),wn,il);Uo=this.uEb.getInstance(il,this.tEb,this.rM,Uo,oe.sg);Uo.correlationId=Vp;Uo.qaa=2;Uo.UPc=rq;Uo.Slb(CommonUIStrings.L_PictureInsertTitle,vl===tb.a.p8a||vl===tb.a.Gub?this.pma:this.kfa,void 0);L.a.J(512517953,352,50,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Show dialog success.")});return 32}catch(Vp){return L.a.J(512517952,
352,10,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Exception = [{0}]",Vp.toString()),mj.Kt(bl.a.S6b,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),8}};this.la=u;this.ia=P;this.$b=la;this.pa=Ba;this.Fa=Sa;this.ta=pb;this.Eb=Vb;this.uEb=Bc;this.Tik=Yc;this.tEb=gd;this.rM=Td;this.Rea=Re;this.kfa=Uf;this.pma=Ef;this.Sb=Oh;this.xk=ek;this.Ga=je;this.Gb=Qf;this.Rq=Jg;this.hj=Ei;this.Mfb=wj;this.VXa=Qk;this.VBe=Bk;this.Ic=Fi;this.vU=u.sKb;this.Jb=jm;this.Mfb&&(this.Mfb.h$a.removeAttribute("style"),
this.Mfb.h$a.style.display="none");this.yDe=Ti;this.Uik=pf;this.u$=tk;this.K4=Uj;this.Rea.execute(vl=>{vl.isFeatureEnabled("MsoPremiumStockImages",!1).catch(Th=>L.a.J(593627152,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",Th)).then(Th=>{this.WHa=Th;this.WHa||(this.bna=vl.v0a("MsoPremiumStockImages",()=>{this.WHa=!0;L.a.J(512517962,352,50,"InsertMediaActor::Constructor - Thanks for purchasing!")}));return null})})}vb(){this.xci();this.ia.ra(tb.a.j_c,
Ff.a.application,Object(z.a)(this,this.uRl,"uploadIcon"),4);Ud.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.ra(tb.a.cMc,Ff.a.application,Object(z.a)(this,this.qyi,"changeToIcon"),4):this.ia.ra(tb.a.cMc,Ff.a.application,Object(z.a)(this,this.ryi,"changeToIcon"),4);this.ia.ra(tb.a.Hbb,Ff.a.application,Object(z.a)(this,this.Lyd,"uploadOnlinePicture"),4);Ud.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.ra(tb.a.A1b,Ff.a.application,Object(z.a)(this,this.fMc,"changeToOnlinePicture"),4):this.ia.ra(tb.a.A1b,
Ff.a.application,Object(z.a)(this,this.gMc,"changeToOnlinePicture"),4);this.ia.ra(tb.a.T$b,Ff.a.application,Object(z.a)(this,this.Lyd,"uploadOnlinePicture"),4);Ud.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.ra(tb.a.w1b,Ff.a.application,Object(z.a)(this,this.fMc,"changeToOnlinePicture"),4):this.ia.ra(tb.a.w1b,Ff.a.application,Object(z.a)(this,this.gMc,"changeToOnlinePicture"),4);this.ia.ra(tb.a.m_c,Ff.a.application,Object(z.a)(this,this.Lyd,"uploadOnlinePicture"),4);Ud.a("ChangePictureOnMultiSelectFixEnabled")?
this.ia.ra(tb.a.x1b,Ff.a.application,Object(z.a)(this,this.fMc,"changeToOnlinePicture"),4):this.ia.ra(tb.a.x1b,Ff.a.application,Object(z.a)(this,this.gMc,"changeToOnlinePicture"),4);this.wci();this.ia.ra(tb.a.ykg,Ff.a.application,Object(z.a)(this,this.Lyd,"uploadOnlinePicture"),4);Ud.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.ra(tb.a.nYd,Ff.a.application,Object(z.a)(this,this.fMc,"changeToOnlinePicture"),4):this.ia.ra(tb.a.nYd,Ff.a.application,Object(z.a)(this,this.gMc,"changeToOnlinePicture"),
4);this.yci();this.ia.ra(tb.a.Fie,Ff.a.application,Object(z.a)(this,this.xRl,"uploadOnlineVideo"),4);this.ia.ra(tb.a.Die,Ff.a.application,Object(z.a)(this,this.wRl,"uploadOnlineHubbleVideo"),4);this.ia.ra(tb.a.Bpc,ib.a.application,Object(z.a)(this,this.gOl,"updateEntryPoints"),96)}xci(){this.ia.ra(tb.a.f_c,Ff.a.application,Object(z.a)(this,this.rza,"showInsertMediaDialogFromM365"),4);this.ia.ra(tb.a.p8a,Ff.a.application,Object(z.a)(this,this.rza,"showInsertMediaDialogFromM365"),4);this.ia.ra(tb.a.insertOnlinePicture,
Ff.a.application,Object(z.a)(this,this.$1e,"showInsertPictureDialog"),4);this.ia.ra(tb.a.y1b,Ff.a.application,Object(z.a)(this,this.$1e,"showInsertPictureDialog"),4);Ud.a("InsertSocialMediaVideoIcon")&&this.ia.ra(tb.a.Gkg,Ff.a.application,Object(z.a)(this,this.nwl,"showInsertSocialMediaDialog"),4);Ud.a("InsertDalleIcon")&&(this.ia.ra(tb.a.wie,Ff.a.application,Object(z.a)(this,this.rza,"showInsertMediaDialogFromM365"),4),this.ia.ra(tb.a.xie,Ff.a.application,Object(z.a)(this,this.rza,"showInsertMediaDialogFromM365"),
4));this.ia.ra(tb.a.S$b,Ff.a.application,Object(z.a)(this,this.rza,"showInsertMediaDialogFromM365"),4);this.ia.ra(tb.a.Gub,Ff.a.application,Object(z.a)(this,this.rza,"showInsertMediaDialogFromM365"),4);Ud.a("ChangePictureCreateWithAI")&&this.ia.ra(tb.a.eMc,Ff.a.application,this.rza,4);this.ia.ra(tb.a.l_c,Ff.a.application,Object(z.a)(this,this.rza,"showInsertMediaDialogFromM365"),4);this.ia.ra(tb.a.iAb,Ff.a.application,Object(z.a)(this,this.a2e,"showInsertPictureFromHostDialog"),4);this.ia.ra(tb.a.z1b,
Ff.a.application,Object(z.a)(this,this.a2e,"showInsertPictureFromHostDialog"),4);this.la.ocpsIsEnabled&&(this.ia.Yjb("ppt_insertOnlinePictures",tb.a.insertOnlinePicture,Ff.a.application,Object(z.a)(this,this.$1e,"showInsertPictureDialog"),u=>{uc.App.Lb.X2a(u,Object(z.a)(this.K4,this.K4.IEa,"getCommandById"))}),this.ia.Yjb("ppt_insertOnlinePictures",tb.a.S$b,Ff.a.application,Object(z.a)(this,this.rza,"showInsertMediaDialogFromM365"),u=>{uc.App.Lb.X2a(u,Object(z.a)(this.K4,this.K4.IEa,"getCommandById"))}),
this.ia.Yjb("ppt_insertOnlinePictures",tb.a.l_c,Ff.a.application,Object(z.a)(this,this.rza,"showInsertMediaDialogFromM365"),u=>{uc.App.Lb.X2a(u,Object(z.a)(this.K4,this.K4.IEa,"getCommandById"))}),this.ia.Yjb("ppt_insertOnlinePictures",tb.a.iAb,Ff.a.application,Object(z.a)(this,this.a2e,"showInsertPictureFromHostDialog"),u=>{uc.App.Lb.X2a(u,Object(z.a)(this.K4,this.K4.IEa,"getCommandById"))}))}wci(){this.la.q_c&&this.Jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertMediaSharedFilePickerEnabled",
!1)&&(this.ia.ra(tb.a.p_c,Ff.a.application,Object(z.a)(this,this.lud,"showInsertPictureFromMobileDeviceDialog"),4),this.ia.ra(tb.a.B1b,Ff.a.application,Object(z.a)(this,this.lud,"showInsertPictureFromMobileDeviceDialog"),4),this.la.ocpsIsEnabled&&(this.ia.Yjb("mso_insertMobileDevicePictures",tb.a.p_c,Ff.a.application,Object(z.a)(this,this.lud,"showInsertPictureFromMobileDeviceDialog"),u=>{uc.App.Lb.X2a(u,Object(z.a)(this.K4,this.K4.IEa,"getCommandById"))}),this.ia.Yjb("mso_insertMobileDevicePictures",
tb.a.B1b,Ff.a.application,Object(z.a)(this,this.lud,"showInsertPictureFromMobileDeviceDialog"),u=>{uc.App.Lb.X2a(u,Object(z.a)(this.K4,this.K4.IEa,"getCommandById"))})))}yci(){this.ia.ra(tb.a.Gua,Ff.a.application,Object(z.a)(this,this.LOb,"showInsertVideoDialog"),4);this.la.ocpsIsEnabled&&this.ia.Yjb("ppt_insertOnlineVideos",tb.a.Gua,Ff.a.application,Object(z.a)(this,this.LOb,"showInsertVideoDialog"),u=>{uc.App.Lb.X2a(u,Object(z.a)(this.K4,this.K4.IEa,"getCommandById"))})}JSk(){v.AFrameworkApplication.ibc()&&
v.AFrameworkApplication.BBh()&&(v.AFrameworkApplication.Aa.get_element().appendChild(this.Mfb.h$a),Be.a.addHandler(this.Mfb.h$a.contentWindow,"message",Object(z.a)(this,this.GCh,"showOneDriveFilePickerDialog")),this.d1c=!0)}GCh(u){if(u.rawEvent&&(u=u.rawEvent.data))try{L.a.J(512517961,352,50,"User select images.");const P=Sys.Serialization.JavaScriptSerializer.deserialize(u,!0),la=P.MessageId?P.MessageId.toString():null;P&&la&&(la===Jd.a.insertImage||la===Jd.a.Bie)&&this.yDe.start(la===Jd.a.insertImage?
this.kfa:this.Uik)}catch(P){L.a.J(512517960,352,10,"malformatted postmessage here.")}}pe(){}gOl(){return 32}$1e(u,P,la){if(!this.eba(this.ta.Ba,u,this.la.pptInsertOnlinePictureEnabled))return 8;if(1===la)return 32;L.a.J(512517959,352,50,"InsertMediaActor::ShowInsertPictureDialog : Show dialog.");try{const Ba=ua.a.create(),Sa=lb.a.iL(this.la.pptEditingUserId).toString(),pb=u===tb.a.insertOnlinePicture&&this.la.oRk?1:0;let Vb=String.format(this.la.insertPictureServiceEndpoint,v.AFrameworkApplication.lcid,
hk.a.He(v.AFrameworkApplication.lcid).name,v.AFrameworkApplication.buildVersion,Ba.toString(),3,Sa,pb);0<this.la.insertPictureServiceEndpoint.search(RegExp("insertmedia.bing.office.net","gi"))&&(Vb=this.rM.asi(uc.App.mode,this.la.pptInsertOnlineContentImagesEnabled?this.la.insertOnlineContentImagesEndpoint:this.la.insertPictureServiceEndpoint));this.Rea.execute(Bc=>{Bc=this.uEb.getInstance(Vb,this.tEb,this.rM,Bc,yd.sg);Bc.insertPictureTelemetryEndpoint=this.la.insertPictureTelemetryEndpoint;Bc.correlationId=
Ba;Bc.qaa=1;switch(u){case tb.a.y1b:this.pma.zx=tb.a.A1b;break;default:this.kfa.zx=tb.a.Hbb}Bc.Slb(CommonUIStrings.L_PictureInsertTitle,u===tb.a.insertOnlinePicture?this.kfa:this.pma,void 0);L.a.J(512517958,352,50,"InsertMediaActor::ShowInsertPictureDialog : Show dialog success.")});return 32}catch(Ba){return L.a.J(512517957,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",Ba.toString()),mj.Kt(bl.a.S6b,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),
8}}nwl(u,P,la){if(1===la)return 32;u=new Ke.a(void 0,void 0,!1);u.Ad=5;u.sg=wk.sg;u.pj(ResourceStrings.l_InsertSocialMediaDialogTitle,null,{["id"]:"SocialMediaExperimentDialog"});L.a.J(512517956,352,15,"InsertMediaActor::ShowInsertSocialMediaDialog : Show dialog.");return 32}a2e(u,P,la){if(!this.eba(this.ta.Ba,u,v.AFrameworkApplication.ibc()&&(mj.Cgg?!!this.yDe.pJb&&9<this.yDe.pJb.length:!0)))return 8;if(1===la)return 32;L.a.J(512517923,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : Show dialog.");
try{P=!0;let Ba=0;if(this.Jb.ka("InsertMediaSharedFilePickerEnabled")){const pb=w.a.instance.resolve("Common.App.SharedFilePicker.ISharedFilePicker");if(pb.Kpe()){P=!1;const Vb=this.la.Dkg;la=!1;this.la.q_c&&(la=this.y$i());const Bc=Object.assign(new eb,{$sb:la,Xzb:!0}),Yc=pb.J0d(CommonUIStrings.l_ImageUploadButtonText,CommonUIStrings.l_ImageUploadingTitle,!0,!1,!0,Vb,"InsertPicture",0,Bc);pb.pVc(Yc).then(gd=>{if(gd&&0<gd.length){const Td=[];for(let Re=0;Re<gd.length;Re++){const Uf=gd[Re][Ee.a.XOe],
Ef={};Ef.Extension=gd[Re][Ee.a.Dfh];Ef.OriginalUrl=Ee.a.SOe in gd[Re]?gd[Re][Ee.a.SOe]:Uf;Ef.Type=Ee.a.TOe in gd[Re]?gd[Re][Ee.a.TOe]:"";Ef.Caption=Ee.a.WOe in gd[Re]?gd[Re][Ee.a.WOe]:"";Ef.Description=Ee.a.ROe in gd[Re]?gd[Re][Ee.a.ROe]:"";Ef.Width=Ee.a.VOe in gd[Re]?gd[Re][Ee.a.VOe]:0;Ef.Height=Ee.a.UOe in gd[Re]?gd[Re][Ee.a.UOe]:0;Array.add(Td,Ef)}this.fjj(u).Fua(Td);L.a.J(512517922,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : SharedFilePicker Show dialog success.")}Ba=32}).catch(gd=>
{L.a.J(512517921,352,10,"InsertMediaActor::ShowInsertPictureFromHostDialog : Exception = [{0}]",gd.toString());mj.Kt(bl.a.S6b,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture);Ba=8})}}if(!P)return Ba;mj.Cgg=!0;this.d1c||this.JSk();const Sa=this.Tik.getInstance();Sa.qaa=4;switch(u){case tb.a.z1b:this.pma.zx=tb.a.x1b;break;default:this.kfa.zx=tb.a.m_c}Sa.Slb(CommonUIStrings.L_PictureInsertTitle,u===tb.a.iAb?this.kfa:this.pma,void 0);L.a.J(512517920,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : Show dialog success.");
return 32}catch(Ba){return L.a.J(512517919,352,10,"InsertMediaActor::ShowInsertPictureFromHostDialog : Exception = [{0}]",Ba.toString()),mj.Kt(bl.a.S6b,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),8}}fjj(u){if(!Ud.a("ChangePictureFromOneDriveFixEnabled"))return this.kfa;const P=(u=u===tb.a.iAb)?this.kfa:this.pma;P.zx=u?tb.a.m_c:tb.a.x1b;return P}y$i(){return w.a.instance.resolve("Common.App.PhoneLink.IPhoneLinkManager").Fbj()}lud(u,P,la){if(!this.eba(this.ta.Ba,
u,this.la.q_c&&this.Jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertMediaSharedFilePickerEnabled",!1)))return 8;if(1===la)return 32;w.a.instance.resolve("Common.App.PhoneLink.IPhoneLinkManager").z3i(this.Jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",!1));try{let Ba=0;const Sa=w.a.instance.resolve("Common.App.SharedFilePicker.ISharedFilePicker");if(Sa.Kpe()){const pb=u===tb.a.p_c,Vb=this.la.Dkg,Bc=Object.assign(new eb,{$sb:!0,Xzb:!0}),
Yc=Sa.J0d(CommonUIStrings.l_ImageUploadButtonText,CommonUIStrings.l_ImageUploadingTitle,!0,!1,pb,Vb,"InsertPictureFromMobile",3,Bc);Sa.pVc(Yc).then(gd=>{if(gd&&0<gd.length){const Td=[];let Re=!1;const Uf=this.Jb.Ha("PhoneLinkServiceEndpoint");for(let Ef=0;Ef<gd.length;Ef++){const Oh=gd[Ef][Ee.a.XOe],ek=gd[Ef],je={};je.Extension=gd[Ef][Ee.a.Dfh];je.OriginalUrl=this.DLb(ek,Ee.a.SOe,Oh);je.Type=this.DLb(ek,Ee.a.TOe,"");je.Caption=this.DLb(ek,Ee.a.WOe,"");je.Description=this.DLb(ek,Ee.a.ROe,"");je.Width=
this.DLb(ek,Ee.a.VOe,0);je.Height=this.DLb(ek,Ee.a.UOe,0);Array.add(Td,je);Re||(Re=-1!==je.OriginalUrl.indexOf(Uf))}gd=pb?this.kfa:this.pma;gd.zx=Re?pb?tb.a.ykg:tb.a.nYd:pb?tb.a.m_c:tb.a.x1b;gd.Fua(Td);L.a.J(512517918,352,50,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : SharedFilePicker Show dialog success.")}Ba=32}).catch(gd=>{L.a.J(512517917,352,10,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : Exception = [{0}]",gd.toString());Ba=8})}return Ba}catch(Ba){return L.a.J(512517916,
352,10,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : Exception = [{0}]",Ba.toString()),8}}DLb(u,P,la){return P in u?u[P]:la}Lyd(u,P,la,Ba,Sa){P=this.ta.Ba;if(!P)return L.a.J(512517915,352,50,"Active Slide is null"),8;if(!this.eba(P,u,this.la.pptInsertOnlinePictureEnabled))return 8;if(1===la)return 32;if(!this.hj.iD(P,1))return this.hj.KD(P),16;try{const pb=P.C_(this.pa.Xd());if(pb&&this.$b.$c(pb))return 16;const Vb=this.xab(P,pb);let Bc=null;const Yc=this.Eb.xd(15,void 0,()=>{this.pa.au();
this.pa.nh();this.Fa.Bd()},()=>{this.pa.selectShape(Vb,!0);Bc&&this.pa.selectShape(Bc,!1)});try{Yc.hc(P);Yc.fd=tb.a.insertOnlinePicture;Yc.py[ea.a.mka]=ea.a.online;la=null;u={["actionId"]:u};if(this.la.pptInsertOnlinePictureAttributionIsEnabled)if(Sa.LicenseUrl&&Sa.LicenseDisplayName){const gd=mj.kQe(Sa);la=Tb.c(gd);if(this.la.pptImageAttributionSelectionImprove){const Td=P.Db;Bc=this.xk.Uja(!0,Td.cid,Td.sid,0,0,0,Of.a.LR,Of.a.nY,P.zs()+1,!1)}}else u["result.LicenseDisplayName"]=Sa.LicenseDisplayName,
u["result.LicenseUrl"]=lb.a.iL(Sa.LicenseUrl);else u.IsEnabled=this.la.pptInsertOnlinePictureAttributionIsEnabled;L.a.J(512517914,352,50,"InsertMediaActor::UploadOnlinePicture: {0}.",u);Vb.NNb(Sa.OriginalUrl,Sa.LicenseUrl?null:Sa.Caption,la,Sa.PageUrl);pb&&P.YR([pb]);P.jB(Vb);Bc&&(P.jB(Bc),Vb.P7a=Bc.id,Bc.qbb=!0)}finally{Yc&&Yc.dispose()}this.Rq.lA=Vb;return 32}catch(pb){return L.a.J(512517913,352,10,"InsertMediaActor::UploadOnlinePicture : Exception = [{0}].",pb.toString()),8}}gMc(u,P,la,Ba,Sa){P=
this.ta.Ba;if(!P)return L.a.J(512517912,352,50,"Active Slide is null"),8;if(!this.eba(P,u,this.la.DKa))return 8;if(1===la)return 32;L.a.J(512517910,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Start changing.");if(!Sa)return 16;try{const pb=this.V$a()||this.wVc();if(!pb||this.$b.$c(pb))return 16;let Vb=null;const Bc=this.Eb.xd(15,void 0,void 0,()=>{this.pa.selectShape(pb,!0);Vb&&this.pa.selectShape(Vb,!1);L.a.J(512517908,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Finish changing.")});
try{Bc.hc(P);Bc.fd=tb.a.A1b;Bc.py[ea.a.mka]=ea.a.online;u=null;if(this.la.pptInsertOnlinePictureAttributionIsEnabled&&Sa.LicenseUrl&&Sa.LicenseDisplayName){const Yc=mj.kQe(Sa);u=Tb.c(Yc);if(this.la.pptImageAttributionSelectionImprove){const gd=P.Db;Vb=this.xk.Uja(!0,gd.cid,gd.sid,0,0,0,Of.a.LR,Of.a.nY,P.zs()+1,!1);L.a.J(512517907,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Adding license info to attributionShapeNode.")}}pb.NNb(Sa.OriginalUrl,Sa.LicenseUrl?null:Sa.Caption,u,Sa.PageUrl);
pb.set_isSVGBlipFilled(!1);Vb&&(P.jB(Vb),pb.P7a=Vb.id,Vb.qbb=!0)}finally{Bc&&Bc.dispose()}this.Rq.lA=pb;return 32}catch(pb){return L.a.J(512517905,352,10,"InsertMediaActor::changeToOnlinePictureSingleImage : Exception = [{0}].",pb.toString()),8}}fMc(u,P,la,Ba,Sa){P=this.ta.Ba;if(!P)return L.a.J(512517911,352,50,"Active Slide is null"),8;if(!this.eba(P,u,this.la.DKa))return 8;if(1===la)return 32;L.a.J(512517909,352,50,"InsertMediaActor::ChangeToOnlinePicture : Start changing.");if(!Sa)return 16;try{var pb=
this.pa.Xd();u=[];for(var Vb of pb)Vb.Of||u.push(Vb);for(const Yc of u)if(!Yc||this.$b.$c(Yc))return 16;pb=null;const Bc=this.Eb.xd(15,void 0,void 0);try{Bc.hc(P);Bc.fd=tb.a.A1b;Bc.py[ea.a.mka]=ea.a.online;Vb=null;if(this.la.pptInsertOnlinePictureAttributionIsEnabled&&Sa.LicenseUrl&&Sa.LicenseDisplayName){const gd=mj.kQe(Sa);Vb=Tb.c(gd);if(this.la.pptImageAttributionSelectionImprove){const Td=P.Db;pb=this.xk.Uja(!0,Td.cid,Td.sid,0,0,0,Of.a.LR,Of.a.nY,P.zs()+1,!1);L.a.J(512517906,352,50,"InsertMediaActor::ChangeToOnlinePicture : Adding license info to attributionShapeNode.")}}const Yc=
Sa.LicenseUrl?null:Sa.Caption;for(const gd of u)gd.NNb(Sa.OriginalUrl,Yc,Vb,Sa.PageUrl),gd.set_isSVGBlipFilled(!1),pb&&(P.jB(pb),gd.P7a=pb.id,pb.qbb=!0)}finally{Bc&&Bc.dispose()}this.Rq.lA=u[0];return 32}catch(Bc){return L.a.J(512517904,352,10,"InsertMediaActor::ChangeToOnlinePicture : Exception = [{0}].",Bc.toString()),8}}uRl(u,P,la,Ba,Sa){P=this.ta.Ba;if(!P)return L.a.J(512517903,352,50,"Active Slide is null"),8;if(!this.eba(P,u,this.la.Gbb))return 8;if(1===la)return 32;L.a.J(512517902,352,50,"InsertMediaActor::UploadIcon : Start inserting.");
if(!Sa||!Sa.length)return 16;if(!this.hj.iD(P,Sa.length))return this.hj.KD(P),16;try{let pb=null;la=null;if(!({KOk:la,AOk:pb}=this.Qnj(Sa,P)).returnValue)return 16;const Vb=this.Eb.xd(15,void 0,()=>{this.pa.au();this.pa.nh();this.Fa.Bd()},()=>{this.pa.d1a(pb,!0)});try{for(Vb.hc(P),Vb.fd=u,Vb.py[ea.a.mka]=ea.a.icon,la&&P.YR(la),u=0;u<pb.length;u++)P.jB(pb[u])}finally{Vb&&Vb.dispose()}this.Rq.lA=pb[pb.length-1];return 32}catch(pb){return L.a.J(512517901,352,10,"InsertMediaActor::UploadIcon : icon count = [{0}], Exception = [{1}].",
Sa.length,pb.toString()),8}}Qnj(u,P){let la,Ba;la=Array(u.length);Ba=Array(u.length);var Sa=P.w9d(this.pa.Xd());if(Sa&&0<Sa.length){var pb=0;for(const Vb of Sa)if(Vb&&!this.$b.$c(Vb)&&pb<u.length&&(la[pb]=Vb,pb++,pb===u.length))break}Sa=!0;for(pb=0;pb<la.length;pb++)this.la.svgIconLocalEditingIsEnabled&&u[pb].SvgContent&&0<u[pb].SvgContent.length&&(!la[pb]||la[pb]&&15!==la[pb].Qj)?Ba[pb]=this.Onj(P,la[pb],u[pb],pb):(Ba[pb]=this.dXc(P,la[pb],u[pb],!0,pb),Sa=!1),Sa&&$h.a.AP(!0,!0),Ba[pb].NNb(u[pb].OriginalUrl,
u[pb].Caption,null,null);return{returnValue:!0,KOk:la,AOk:Ba}}Onj(u,P,la,Ba){if(!u)return null;var Sa=u.Db,pb=u.zs();let Vb;const Bc=Object(S.a)(340,u.qc(this.Gb.Na));({V6d:Vb,kC:u}=this.VXa.k_d(P,la.Width,la.Height));Ba=P?0:Ba*$d.a.jT;Sa=this.xk.Uja(!0,Sa.cid,Sa.sid,0,u.x+Ba,u.y+Ba,Vb.width,Vb.height,pb+1,!1);pb=this.VXa.tWd(this.Gb.Md,Vb,u,Bc.UT);Sa.ZR=pb;Sa.isResizable=!0;Sa.rbc=!0;Sa.YL=!0;Sa.FJa=!0;Sa.set_isSVGBlipFilled(!0);la=this.VBe.yel(la.SvgContent);Sa.Lea=la?String.format("data:image/svg+xml;charset=utf8,{0}",
encodeURIComponent(la)):"";P&&(Sa.v8=P.id);return Sa}qyi(u,P,la,Ba,Sa){P=this.ta.Ba;if(!P)return L.a.J(512517900,352,50,"Active Slide is null"),8;if(!this.eba(P,u,this.la.pptSmartArtSubNodeIconChangeEnabled))return 8;if(1===la)return 32;L.a.J(512517898,352,50,"InsertMediaActor::ChangeToIcon : Start changing.");if(!Sa||!Sa.length)return 16;try{const pb=this.pa.Xd(),Vb=[];for(const gd of pb)gd.Of||Vb.push(gd);const Bc=Sa[0].Caption;for(const gd of Vb){if(!Vb||this.$b.$c(gd))return 16;const Td=this.Ga.Gr(gd);
Bc&&Td&&this.Ic.ckh(new Gj(P.Db,gd.get_shapeId(),gd.get_smartArtModelId(),Bc))}const Yc=this.Eb.xd(15,void 0,void 0,()=>{for(const gd of Vb){const Td=this.Ga.Gr(gd);Td&&(this.Ic.Nnd(),this.pa.selectShape(Td,!0),this.Ic.Mnd())}L.a.J(512517896,352,50,"InsertMediaActor::ChangeToIcon : Finish changing.")});try{Yc.hc(Vb[0]);Yc.fd=u;Yc.py[ea.a.mka]=ea.a.icon;for(const gd of Vb)gd.set_isSVGBlipFilled(!0),gd.NNb(Sa[0].OriginalUrl,Bc,null,null)}finally{Yc&&Yc.dispose()}for(const gd of Vb)this.$b.tsa(P,gd,
this.Gb.Na,u);return 32}catch(pb){return L.a.J(512517894,352,10,"InsertMediaActor::ChangeToIcon : icon count = [{0}], Exception = [{1}].",Sa.length,pb.toString()),8}}ryi(u,P,la,Ba,Sa){P=this.ta.Ba;if(!P)return L.a.J(512517899,352,50,"Active Slide is null"),8;if(!this.eba(P,u,this.la.pptSmartArtSubNodeIconChangeEnabled))return 8;if(1===la)return 32;L.a.J(512517897,352,50,"InsertMediaActor::changeToIconSingleIcon : Start changing.");if(!Sa||!Sa.length)return 16;try{const pb=this.wVc()||this.V$a();if(!pb||
this.$b.$c(pb))return 16;const Vb=Sa[0].Caption,Bc=this.Ga.Gr(pb);Vb&&Bc&&this.Ic.ckh(new Gj(P.Db,pb.get_shapeId(),pb.get_smartArtModelId(),Vb));const Yc=this.Eb.xd(15,void 0,void 0,()=>{Bc&&(this.Ic.Nnd(),this.pa.selectShape(Bc,!0),this.Ic.Mnd());L.a.J(512517895,352,50,"InsertMediaActor::changeToIconSingleIcon : Finish changing.")});try{Yc.hc(pb),Yc.fd=u,Yc.py[ea.a.mka]=ea.a.icon,pb.set_isSVGBlipFilled(!0),pb.NNb(Sa[0].OriginalUrl,Vb,null,null)}finally{Yc&&Yc.dispose()}(la=Bc||pb)&&this.$b.tsa(P,
la,this.Gb.Na,u);return 32}catch(pb){return L.a.J(512517893,352,10,"InsertMediaActor::changeToIconSingleIcon : icon count = [{0}], Exception = [{1}].",Sa.length,pb.toString()),8}}wVc(){let u=null;const P=this.pa.Xd();for(const la of P)if(la&&la.get_isSVGBlipFilled())if(u)break;else u=la;return u}V$a(){if(this.vU){const u=this.pa.Xd();return u&&u.length?this.fVd(u)?u[0]:this.jyb():null}return this.jyb()}fVd(u){if(!u||!u.length)return!1;let P=u[0].qj,la=1===u[0].mediaType;for(const Ba of u)P=P&&Ba.qj,
la=la&&1===Ba.mediaType;return P||la}jyb(){const u=this.pa.Xd();for(const P of u)if(P&&P.qj)return P;return null}Kwg(u,P){const la=this.Jb.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoModal","defaultModal");"defaultModal"!==la&&L.a.J(u,352,15,`${P}::Modal:${la}`)}LOb(u,P,la){if(!this.eba(this.ta.Ba,u,this.la.pptInsertOnlineVideoEnabled))return 8;if(1===la)return 32;this.$Gb=$h.a.kk("ShowInsertVideoDialog",1);const Ba=this.Jb.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoModal",
"defaultModal");try{if(this.la.insertVideoOnlineFromHubbleEnabled){L.a.J(512517890,352,50,"InsertMediaActor::ShowInsertVideoDialog : Insert online video using Hubble");const pb=ua.a.create(),Vb=lb.a.iL(this.la.pptEditingUserId).toString();let Bc;const Yc=this.la.ka("GetCustomHeaderEnabled");Yc&&(Bc=w.a.instance.resolve("Common.App.OAuth.IOAuthManager"));this.Rea.execute(gd=>{gd=this.uEb.getInstance(this.rM.csi(uc.App.mode,this.la.xQj,pb.toString(),Vb,this.la.ecb,this.la.TBb,Yc,Ba),this.tEb,this.rM,
gd,oe.sg);gd.correlationId=pb;gd.qaa=5;const Td=new Ig(this.ia,this.rM,this.la);Td.zx=tb.a.Die;gd.Slb(CommonUIStrings.L_VideoInsertTitle,Td,Bc)})}else this.la.insertVideoOnlineFromUrlEnabled?(L.a.J(512517889,352,50,"[Insert Online Video] Insert online video from URL, creating dialog"),(new hc(this.u$)).Nga()):(L.a.J(512517888,352,50,"InsertMediaActor::ShowInsertVideoDialog : Insert online video"),this.Rea.execute(pb=>{this.uEb.getInstance(this.rM.dsi(uc.App.mode,this.la.insertVideoServiceEndpoint),
this.tEb,this.rM,pb,yd.sg).Slb(CommonUIStrings.L_VideoInsertTitle,new Ig(this.ia,this.rM,this.la),void 0)}));this.Kwg(512557208,"ShowInsertOnlineVideoDialog");null!=this.$Gb&&Object(Hj.a)(this.$Gb.actionName,(new Date).getTime()-this.$Gb.dE.getTime(),"InsertOnlineVideoDialog",this.$Gb.actionId,this.$Gb.Oj);const Sa=this.Jb.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoToolTipMessage","InsertOnlineVideo");Ud.a("LogInsertOnlineVideoCustomToolTip")&&"InsertOnlineVideo"!==Sa&&
L.a.J(512517859,352,15,"InsertOnlineVideo::ToolTipMessage : "+Sa);if("Microsoft.Office.PowerPointOnline.InsertSocialMediaVideo"in this.Jb.$Sc){const pb=this.Jb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertSocialMediaVideo",!1)?"Visible":"NotVisible";L.a.J(512517858,352,15,"InsertOnlineVideo::SocialMediaIconIs"+pb)}L.a.J(512517857,352,50,"InsertMediaActor::ShowInsertVideoDialog : Show dialog success.");return 32}catch(Sa){return L.a.J(512517856,352,10,"InsertMediaActor::ShowInsertVideoDialog : Exception = [{0}]",
Sa.toString()),mj.Kt(bl.a.S6b,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlineVideo),8}}xRl(u,P,la,Ba,Sa){P=this.ta.Ba;if(!P)return L.a.J(512517853,352,50,"Active Slide is null"),8;if(!this.eba(P,u,this.la.pptInsertOnlineVideoEnabled))return 8;if(1===la)return 32;if(!this.hj.iD(P,1))return this.hj.KD(P),16;try{const pb=P.C_(this.pa.Xd());if(pb&&this.$b.$c(pb))return 16;const Vb=this.xab(P,pb),Bc=this.rM.Pwj(Sa.OriginalUrl);Vb.p_e(Bc,Sa.ThumbnailUrl,Sa.Caption,Sa.Description,
0<Sa.Width?Sa.Width:0,0<Sa.Height?Sa.Height:0);const Yc=this.Eb.xd(15,void 0,()=>{this.pa.au();this.pa.nh();this.Fa.Bd()},()=>{this.pa.selectShape(Vb,!0)});try{Yc.hc(P),Yc.fd=u,pb&&P.YR([pb]),P.jB(Vb)}finally{Yc&&Yc.dispose()}L.a.J(512517852,352,50,"InsertMediaActor::UploadOnlineVideo : Inserting online video is done.");this.Rq.lA=Vb;return 32}catch(pb){return L.a.J(512517851,352,10,"InsertMediaActor::UploadOnlineVideo : Exception = [{0}].",pb.toString()),8}}wRl(u,P,la,Ba,Sa){P=this.ta.Ba;if(!P)return L.a.J(512517850,
352,50,"Active Slide is null"),8;if(!this.eba(P,u,this.la.insertVideoOnlineFromHubbleEnabled))return 8;if(1===la)return 32;L.a.J(512517849,352,50,"InsertMediaActor::UploadOnlineHubbleVideo : Start inserting.");if(!this.hj.iD(P,1))return this.hj.KD(P),16;try{const pb=P.C_(this.pa.Xd());if(pb&&this.$b.$c(pb))return 16;const Vb=this.xab(P,pb),Bc=0<Sa.Width?Sa.Width:0,Yc=0<Sa.Height?Sa.Height:0;let gd=Sa.PageUrl;this.la.TBb&&"odspbusiness"===Sa.ProviderName.toLocaleLowerCase()&&(gd=Sa.OriginalUrl);Vb.p_e(gd,
Sa.ThumbnailUrl,Sa.Caption,Sa.Description,Bc,Yc);const Td=this.Eb.xd(15,void 0,()=>{this.pa.au();this.pa.nh();this.Fa.Bd()},()=>{this.pa.selectShape(Vb,!0)});try{Td.hc(P),Td.fd=u,pb&&P.YR([pb]),P.jB(Vb)}finally{Td&&Td.dispose()}this.Kwg(512557200,"InsertOnlineHubbleVideo");L.a.J(512517848,352,50,"InsertMediaActor::UploadOnlineVideo : Inserting online video is done in {0} ms.",Date.now()-Sa.StartInsertTime);this.Rq.lA=Vb;return 32}catch(pb){return L.a.J(512517847,352,10,"InsertMediaActor::UploadOnlineHubbleVideo : Exception = [{0}].",
pb.toString()),8}}eba(u,P,la){u=!!u&&la&&!this.$b.$c(u);switch(P){case tb.a.p8a:return u&&(!!this.V$a()||!!this.wVc());case tb.a.y1b:case tb.a.z1b:case tb.a.B1b:case tb.a.Gub:return u&&this.Czi();default:return u}}Czi(){const u=this.V$a()||this.wVc();return u?this.Ga.Gr(u)?!1:!0:!1}xab(u,P){return this.dXc(u,P,null,!1,0)}dXc(u,P,la,Ba,Sa){if(!u)return null;var pb=u.Db;u=u.zs();let Vb;Ba?{width:la,height:Vb}=mj.auj(P,la):(la=Of.a.LR,Vb=Of.a.nY);let Bc;Bc=P?P.zyb(la,Vb):this.Sb.Rka(la,Vb);Sa=P?0:Sa*
$d.a.jT;pb=this.xk.Uja(!0,pb.cid,pb.sid,0,Bc.x+Sa,Bc.y+Sa,la,Vb,u+1,!0);pb.set_isSVGBlipFilled(Ba);P&&(pb.v8=P.id);return pb}dispose(){this.Rea.instance&&this.bna&&this.Rea.instance.akb("MsoPremiumStockImages",this.bna);this.d1c&&this.Mfb.h$a.contentWindow&&(Be.a.removeHandler(this.Mfb.h$a.contentWindow,"message",Object(z.a)(this,this.GCh,"showOneDriveFilePickerDialog")),this.d1c=!1)}static Nsi(){const u=CommonUIStrings.l_AttributionText.split(/[{}]+/);return Lk.e(u,P=>!!P)}static Zri(u,P){const la=
document.createElement("body");var Ba="";let Sa="",pb=CommonUIStrings.L_CCYYSA;void 0!==P&&null!==P&&(void 0!==P.PageUrl&&null!==P.PageUrl&&(Ba=P.PageUrl),void 0!==P.LicenseDisplayName&&null!==P.LicenseDisplayName&&0<P.LicenseDisplayName.length&&(pb=P.LicenseDisplayName),void 0!==P.LicenseUrl&&null!==P.LicenseUrl&&(Sa=P.LicenseUrl));for(const Vb of u){switch(Vb){case "L_ThePhoto":u=mj.tFf(CommonUIStrings.l_ThePhoto,Ba);break;case "L_CCYYSA":u=mj.tFf(pb,Sa);break;case "L_PhotoAuthor":u=mj.NFf(CommonUIStrings.l_PhotoAuthor);
break;default:u=mj.NFf(Vb)}u&&la.appendChild(u)}Ba=document.createElement("html");Ba.appendChild(la);return Ba}static NFf(u){const P=document.createElement("span");P.innerText=u;return P}static tFf(u,P){const la=document.createElement("A");la.setAttribute("href",P);la.setAttribute("target","_blank");la.setAttribute("rel","noreferrer");P=document.createElement("span");P.innerText=u;la.appendChild(P);return la}static kQe(u){const P=mj.Nsi();return mj.Zri(P,u)}static Kt(){}static auj(u,P){let la;u&&
15===u.Qj?(la=nc.a.Ne(u.M$e,0,!1),u=nc.a.Ne(u.kge,0,!1)):P&&0<P.Width&&0<P.Height?(la=P.Width,u=P.Height):(la=nc.a.Ne(2,0,!1),u=nc.a.Ne(2,0,!1));return{width:la,height:u}}}mj.Cgg=!1;Object(r.a)(mj,"InsertMediaActor",null,[251]);var Dl=d(548);class Ai{}Ai.dGl=864E5;Ai.Xii=3;Ai.Vzk=144E5;Object(r.a)(Ai,"AddinConstantsNum",null,[]);var nj=d(194),Bi=d(387),El=d(452);class te{constructor(u,P,la,Ba=null){this.fa=Ba?Ba:v.AFrameworkApplication.fa;this.AGd=2;this.bAb=u;this.m$h=P;this.ex=la}get kVa(){return this.AGd}get WRl(){return this.m$h}eXe(u){if(this.fa.ka("AgaveSupportsLiveIdSpoofing"))this.bAb(u,
this.kVa,{["ak0"]:(new Date).getTime()});else if(El.a.YAh(u)){var P=String.format(v.AFrameworkApplication.Aa.ob.Zna+"AddinServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}","laststoreupdate",v.AFrameworkApplication.Aa.ob.zk,this.WRl,v.AFrameworkApplication.gh);const la=v.AFrameworkApplication.Me;let Ba=null;this.ex&&(Ba=this.ex.Ii("ComponentAttach",Bi.a[u]+Dl.a[this.kVa]));la.zj(P,1,null,null,!0,4,Sa=>{this.dJk(u,Sa.data.ee);Ba&&Ba.stop()},Sa=>{n.ULS.sendTraceTag(17438153,220,50,"GetLastUpdate request failed with {0}.",
Sa.data.Ke);Ba&&Ba.stop()},null)}else El.a.Dfe(u)?(P=El.a.e9d(u),this.bAb(u,this.kVa,{["ak0"]:P})):this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.bAb(u,this.kVa,null)}dJk(u,P){if(P&&""!==P&&(P=Sys.Net.XMLDOM(P))){El.a.lnb(nj.a.GTd,((new Date).getTime()+Ai.Vzk).toString(),u);let la=P.getElementsByTagName("update");la&&la.length||(la=P.getElementsByTagName("o:update"));la&&0<la.length&&(P=Date.parse(la[0].firstChild.nodeValue),(El.a.e9d(u)<
P||El.a.Dfe(u))&&this.bAb(u,this.kVa,{["ak0"]:P}))}}}Object(r.a)(te,"AddinCommandsAnonymousAPIInitializer",null,[994]);class sm{constructor(u,P,la){this.AGd=la;this.bAb=u;this.ii=P}get kVa(){return this.AGd}eXe(u){let P=null;this.ii&&(P=this.ii.Ii("ComponentAttach",Bi.a[u]+Dl.a[this.kVa]));(null==this.o1e(u)?0:this.o1e(u))&&this.bAb(u,this.kVa,{["ak0"]:(new Date).getTime()-Ai.Xii*Ai.dGl});P&&P.stop()}}Object(r.a)(sm,"AddinCommandsInitializerBase",null,[994]);class Zl extends sm{constructor(u,P){super(u,
P,5)}o1e(){return!0}}Object(r.a)(Zl,"AddinCommandsInitializer",sm,[]);class Ji extends sm{constructor(u,P){super(u,P,1)}o1e(u){try{const P=nj.a.f7f()+u;return Boolean.parse(this.Ebj(P)||"false")}catch(P){n.ULS.sendTraceTag(17306844,220,50,"LocalStorage is not allowed, {0}.",P.toString())}return null}Ebj(u){const P=localStorage;return void 0!==P&&null!==P?P.getItem(u):null}}Object(r.a)(Ji,"AddinCommandsLocalCacheInitializer",sm,[]);class Qe{constructor(u,P=null){this.ex=u;this.fa=P?P:v.AFrameworkApplication.fa}get appUILocale(){return hk.a.He(v.AFrameworkApplication.lcid).name}wNj(){if(this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",
!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinHomeTabEntranceEnabled",!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableTUIForBEPHomeTab",!1)){var u={};u[nj.a.lXi]="TeachingCallout";this.NQe(G.a.LIl,u)}const P=this.u9d();if(P)if(this.fa.ka("OcpsIsEnabled"))w.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(la=>
{la.isFeatureEnabled("ConnectedServices",!0).then(Ba=>{for(let Sa of P){if(!Ba&&0===Sa.key)continue;const pb=this.i3f(Sa.value);pb&&pb.eXe(Sa.key)}return null})});else for(let la of P)(u=this.i3f(la.value))&&u.eXe(la.key)}fXe(u,P,la){la&&la[nj.a.B7a]?(la[nj.a.k8]=u,la[nj.a.j8]=P,this.NQe(G.a.xMb,la),El.a.lnb(nj.a.B7a,la[nj.a.B7a].toString(),u)):this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&0===u&&(la={},la[nj.a.k8]=u,la[nj.a.j8]=P,this.NQe(G.a.YU,
la))}i3f(u){let P=null;switch(u){case 1:P=new Ji(Object(z.a)(this,this.fXe,"retrieveAddinFlagCompleted"),this.ex);break;case 2:P=new te(Object(z.a)(this,this.fXe,"retrieveAddinFlagCompleted"),this.appUILocale,this.ex,this.fa);break;case 5:P=new Zl(Object(z.a)(this,this.fXe,"retrieveAddinFlagCompleted"),this.ex)}return P}}Object(r.a)(Qe,"AddinCommandsInitializerHost",null,[]);var $l=d(1160),mk=d(151);class zf extends Qe{constructor(u,P){super(u.Jbg());this.lo=u;this.Jb=P;$l.a.d$b=$l.a.Mgh}bKl(){this.wNj()}u9d(){const u=
new mk.a;this.Jb.ka("51")&&(u.$(0,2),u.$(16,5));this.Jb.ka("187")&&u.$(1,1);this.lo.rd.Iua&&u.$(8,1);this.Jb.ka("305")&&u.$(10,5);return u}NQe(u,P){this.lo.gH().Ka(u,2,P)}}Object(r.a)(zf,"AddinCommandsInitService",Qe,[943]);class Jf{constructor(){this.K=null}get name(){return"PowerPointWebEditor.AddinCommands"}Yb(u){this.K=u;w.a.instance.register(zf,"PowerPointWebEditor.AddinCommandsInitService").as("PowerPointWebEditor.IAddinCommandsInitService").oa(()=>new zf(this.K.resolve("PowerPointWebEditor.IApplicationContext"),
this.K.resolve("Common.IAppSettingsManager"))).ma()}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").Klg&&this.K.resolve("Common.IAppSettingsManager").ff(()=>{w.a.instance.resolve("PowerPointWebEditor.IAddinCommandsInitService").bKl()})}dispose(){}}Object(r.a)(Jf,"AddInCommandsInitPackage",null,[2,3]);class Fl extends yb{constructor(u,P=null){super(u,!0,P,!1)}get Wge(){return null}get Tna(){return v.AFrameworkApplication.Zsa?CommonUIStrings.l_DownLoadACopyDialogMessage:CommonUIStrings.l_PrintDialogDocumentIsPrinting}get vCb(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion}get buttonText(){return CommonUIStrings.l_Download}get zJc(){return null}}
Object(r.a)(Fl,"DownloadAsPdfDialog",yb,[]);class Cc extends Fl{constructor(u){super(u)}get Tna(){return v.AFrameworkApplication.Zsa?CommonUIStrings.l_DownLoadACopyDialogMessage:ResourceStrings.l_DownloadAsPdfDialogPdfReady}vdc(){L.a.J(25544926,801,50,"Images download dialog displayed")}xdc(){L.a.J(25544928,801,50,"Images download dialog link clicked")}ndb(){L.a.J(25544930,801,50,"Images download dialog button clicked")}}Object(r.a)(Cc,"DownloadACopyAsImagesDialog",Fl,[]);var uo=d(202);class gn extends le{constructor(u){super(u,
void 0,v.AFrameworkApplication.Zsa)}get Tna(){return ResourceStrings.l_DownloadAsOdpDialogOdpReady}get vCb(){return ResourceStrings.l_DownloadAsOdpDialogLinkSuggestion}get gdc(){return"DownloadOdpLink"}get buttonText(){return ResourceStrings.L_Download}get H3b(){return v.AFrameworkApplication.Zsa?"UIFontDialogTextLarge":null}vdc(){L.a.J(8958087,801,50,"ODP download dialog displayed")}xdc(){L.a.J(8958089,801,50,"ODP download dialog link clicked")}ndb(){L.a.J(19505496,801,50,"ODP download dialog button clicked")}y4c(){uo.Redirect.showHelp("PPTODF");
return!0}get ddc(){return v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.ka("EnableReactDialogs")&&Ud.a("ReactDialogsODPDialogFix")?null:"#"}get BWa(){return ResourceStrings.l_DownloadAsOdpDialogLearnMoreLinkText}get S3g(){return!v.AFrameworkApplication.Zsa}}Object(r.a)(gn,"DownloadACopyAsOdpDialog",le,[]);class Lh extends Fl{constructor(u){super(u)}get Tna(){return v.AFrameworkApplication.Zsa?CommonUIStrings.l_DownLoadACopyDialogMessage:ResourceStrings.l_DownloadAsPdfDialogPdfReady}vdc(){L.a.J(21050910,
801,50,"PDF download dialog displayed")}xdc(){L.a.J(21050912,801,50,"PDF download dialog link clicked")}ndb(){L.a.J(21050914,801,50,"PDF download dialog button clicked")}}Object(r.a)(Lh,"DownloadACopyAsPdfDialog",Fl,[]);var uh=d(1197),Wi=d(395);class tm extends Wi.a{constructor(u,P,la){super();this.aY=null;this.W6c=0;this.Ud=this.qNg=null;this.yok=u;this.Lgk=P;this.Rdk=la;this.n_a=Object(z.a)(this,this.d6,"onRequestComplete");this.onError=Object(z.a)(this,this.JGk,"onRequestError")}get jnc(){return this.qNg}set jnc(u){this.qNg=
u}get ot(){return this.Ud}set ot(u){this.Ud=u}start(){this.NOb()}NOb(){1!==v.AFrameworkApplication.Aa.state&&(this.aY=new uh.a,this.aY.Ir=!1,this.aY.Ad=5,this.aY.message=this.yok,this.aY.Dpa(ResourceStrings.l_GenericDialogTitle,null,null),this.W6c=0)}OT(){this.aY&&(this.aY.close(),this.aY=null)}d6(u){this.OT();u.hTa?this.jnc(u):this.$Y()}JGk(u){u.T1i&&this.W6c<tm.iel?(this.W6c+=1,u.start()):this.$Y()}$Y(){this.OT();if(1!==v.AFrameworkApplication.Aa.state){const u=new Wa.StandardDialog;u.Ad=0;u.Ty(this.Rdk,
ResourceStrings.l_GenericDialogTitle,this.Lgk,this.ot)}}}tm.iel=3;Object(r.a)(tm,"UIBlockingTask",Wi.a,[]);var Dk=d(262);class Va extends tm{constructor(u){super(ResourceStrings.l_ConvertingToOdpProgressString,ResourceStrings.l_ConvertingToOdpErrorString,bl.a.Hzk);this.OB=u}start(){super.start();Dk.a.rIi(this.OB,Object(z.a)(this,this.cea,"handleWebserviceResponse"),Object(z.a)(this,this.aea,"handleWebserviceError"))}}Object(r.a)(Va,"ConvertToOdpTask",tm,[]);class vh extends tm{constructor(u){super(ResourceStrings.L_PrintingProgressString,
ResourceStrings.l_ConvertingToPdfErrorString,bl.a.WNk);this.OB=u}start(){super.start();Dk.a.tIi(this.OB,Object(z.a)(this,this.cea,"handleWebserviceResponse"),Object(z.a)(this,this.aea,"handleWebserviceError"))}}Object(r.a)(vh,"ConvertToPdfTask",tm,[]);class Ol{constructor(u,P,la){this.s7c=u;this.Fe=P;this.ywe=la}get owb(){return this.s7c.value}convert(u,P,la){let Ba=null;0===P?this.ywe?new gn(la):(Ba=new Va(u),Ba.jnc=Object(z.a)(this,this.$Bk,"onConvertOdpRequestSucceeded"),Ba.start()):1===P?this.Fe.rd.Gog&&
this.ywe?new Lh(la):$h.a.SI($h.a.Kb,()=>{Ba=new vh(u);Ba.jnc=Object(z.a)(this,this.aCk,"onConvertPdfRequestSucceeded");Ba.start()}):2===P?this.Fe.rd.Sqg&&this.ywe&&new Cc(la):Error.invalidOperation(String.format("Convert task type '{0}' is not supported",P))}$Bk(u){u=u.result;1!==v.AFrameworkApplication.Aa.state&&(u=Bd.a.Lta(u.PrintUrl),new gn(u))}aCk(u){u=u.result;1!==v.AFrameworkApplication.Aa.state&&(u=Bd.a.Lta(u.PrintUrl),this.owb.yNf=new Date,new Lh(u),this.owb.mTf=new Date,L.a.J(21050908,801,
50,"DownloadACopyAsPdf-StartTime: {0}, DownloadACopyAsPdf-SaveEnd: {1}, DownloadACopyAsPdf-ConvertEnd: {2}, DownloadACopyAsPdf-DialogShowEnd: {3}.",this.owb.hVf.toString(),this.owb.Tth.toString(),this.owb.yNf.toString(),this.owb.mTf.toString()))}}Object(r.a)(Ol,"Converter",null,[944]);class hn{constructor(){this.hVf=this.Tth=this.yNf=this.mTf=uc.App.pn}}Object(r.a)(hn,"DownloadACopyAsPdfContext",null,[]);class Ij extends tm{constructor(u,P){super(ResourceStrings.L_PrintingProgressString,ResourceStrings.L_PrintingErrorString,
bl.a.yTk);this.OB=u;this.wsk=P}start(){super.start();Dk.a.print(this.OB,this.wsk,Object(z.a)(this,this.cea,"handleWebserviceResponse"),Object(z.a)(this,this.aea,"handleWebserviceError"))}}Object(r.a)(Ij,"PrintTask",tm,[]);class Mk{constructor(u,P,la){if(!u)throw Error.argumentNull("directPrintManager");this.hfc=u;this.Fe=P;this.ahk=la}hGk(u){this.hfc.KTk();u=u.result;1!==v.AFrameworkApplication.Aa.state&&(u=Bd.a.Lta(u.PrintUrl),this.hfc.ICh(u))}print(u,P,la){this.Fe.rd.Gog&&this.ahk?(u=new ya.QueryStringBuilder(P),
u.jg(fi.a.YLk,this.hfc.DBh().toString()),u.jg(fi.a.TLk,la.toString()),this.hfc.ICh(u.toString())):(la=new Ij(u,this.hfc.DBh()),la.jnc=Object(z.a)(this,this.hGk,"onPrintRequestSucceeded"),la.start())}}Object(r.a)(Mk,"Printer",null,[945]);class ig{get name(){return"PowerPointWebEditor.PrintPackage"}Yb(){w.a.instance.register(Mk,"PowerPointWebEditor.Printer").as("PowerPointWeb.IPrinter").ma().oa(()=>new Mk(w.a.instance.qb("Common.App.DirectPrint.IDirectPrintManager"),w.a.instance.qb("PowerPointWebEditor.IApplicationContext"),
w.a.instance.qb("PowerPointWebEditor.IApplicationSettings").yg));w.a.instance.register(Ol,"PowerPointWeb.Converter").as("PowerPointWeb.IConverter").ma().oa(()=>new Ol(w.a.instance.oe("PowerPointWebEditor.DownloadACopyAsPdfContext"),w.a.instance.qb("PowerPointWebEditor.IApplicationContext"),w.a.instance.qb("PowerPointWebEditor.IApplicationSettings").yg));w.a.instance.register(hn,"PowerPointWebEditor.DownloadACopyAsPdfContext").ma().oa(()=>new hn)}init(){}dispose(){}}Object(r.a)(ig,"PrintPackage",null,
[2,3]);var Dh=d(1072);class zb extends th{constructor(u,P,la){super(u,P);this.la=la;this.zx=tb.a.Fub}Fua(u){if(u&&u.length){var P=tb.a.Hv(this.zx),la=this.VTj(u[0]);try{L.a.J(512517845,352,50,"ChangeOnlineImageHelper: InsertMediaCallback() - Change online images, from command: {0} to command: {1}.",P,la?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload");if(32!==(la?this.qn.Ka(tb.a.cMc,2,u):this.qn.Ka(this.zx,2,u[0])))throw Error.invalidOperation(String.format("Failed to change online images, command: {0}.",
la?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload"));L.a.J(512517844,352,50,"ChangeOnlineImageHelper: InsertMediaCallback() - Change online images successfully, from command: {0} to command: {1}.",P,la?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload")}catch(Ba){L.a.J(512517843,352,10,"ChangeOnlineImageHelper: InsertMediaCallback() - {0}: Exception = [{1}].",P,Ba.toString())}}}VTj(u){(u=!!u&&!!u.OriginalUrl&&0<u.OriginalUrl.length&&this.la.pptSmartArtSubNodeIconChangeEnabled&&!!this.la.powerPointInsertContentSvgPath&&
0<this.la.powerPointInsertContentSvgPath.length&&0<=u.OriginalUrl.toLowerCase().indexOf(this.la.powerPointInsertContentSvgPath.toLowerCase())&&u.OriginalUrl.toLowerCase().indexOf(".svg")===u.OriginalUrl.length-4)||L.a.J(512517842,352,50,"isChangeSvg = false");return u}}Object(r.a)(zb,"ChangeOnlineImageHelper",th,[]);class dj extends th{constructor(u,P,la){super(u,P);this.la=la;this.zx=tb.a.Hbb}Fua(u){var P;if(u&&u.length){var la=tb.a.Hv(this.zx),Ba=new Map;Ba.set("InsertMediaCommand",la);Wf.Health.instance.recordKpiUsageForAlertableKpi("InsertOnlineImage",
null,Ba);try{const pb=[],Vb=[],Bc=[];for(let gd=0;gd<u.length;gd++){const Td=u[gd];this.bpg(Td)?Array.add(pb,Td):this.la.Kbb&&this.a6j(Td)?Array.add(Bc,Td):Array.add(Vb,Td)}L.a.J(512517841,352,50,"InsertMediaCallback:  Insert {0} pictures {1} svg images, command: {2}.",Vb.length,pb.length,la);let Yc=this.zx;Yc===tb.a.j_c?Yc=tb.a.T$b:this.la.Kbb&&Yc===tb.a.Jbb&&(Yc=tb.a.T$b);for(u=0;u<Vb.length;u++){var Sa=this.qn.Ka(Yc,2,Vb[u]);if(32!==Sa)throw Error.invalidOperation(String.format("Failed to upload picture {0} with command {1}.",
Vb.toString(),la));}if(this.la.Kbb&&0<Bc.length){this.Ve||(this.Qvh($h.a.kk("StockVideos::Insert")),null===(P=this.Ve)||void 0===P?void 0:P.Wa("StockVideoInitiatedByRibbon","false"));this.Ve&&this.Ve.Wa("totalVideosSelected",Bc.length.toString());const gd=performance.now();for(P=0;P<Bc.length;P++)if(Sa=this.qn.Ka(tb.a.Jbb,2,Bc[P]),32!==Sa)throw this.OWf("videosInsertedBeforeFailure",P,gd),Error.invalidOperation(String.format("Failed to upload video {0} with command {1}.",Bc.toString(),la));this.OWf("videosInsertedSuccess",
Bc.length,gd)}if(this.bpg(pb[0])&&(Sa=this.qn.Ka(tb.a.j_c,2,pb),32!==Sa))throw Error.invalidOperation(String.format("Failed to insert M365 svg images {0}",pb.toString()));L.a.J(512517840,352,50,"InsertMediaCallback: Insert {0} pictures {1} svg images {2} videos success, command: {3}.",Vb.length,pb.length,Bc.length,la)}catch(pb){L.a.J(512517839,352,10,"InsertMediaActor::{0}: Exception = [{1}].",this.zx.toString(),pb.toString()),Ba.set("Exception",pb.toString()),Wf.Health.instance.recordKpiFailure("InsertOnlineImage",
"InsertMediaException",!1,!0,Object.assign(new Kc.a,{extendedProperties:Ba}))}}}Qvh(u){this.Ve=u}OWf(u,P,la){if(this.Ve){const Ba=performance.now();this.Ve.Wa("VideosInsertionTimeInMilliseconds",(Ba-la).toString());this.Ve.Wa(u,P.toString());this.Ve.finish();this.Ve=null}}bpg(u){(u=!!u&&!!u.OriginalUrl&&0<u.OriginalUrl.length&&this.la.Gbb&&!!this.la.powerPointInsertContentSvgPath&&0<this.la.powerPointInsertContentSvgPath.length&&0<=u.OriginalUrl.toLowerCase().indexOf(this.la.powerPointInsertContentSvgPath.toLowerCase())&&
u.OriginalUrl.toLowerCase().indexOf(".svg")===u.OriginalUrl.length-4)||L.a.J(512517838,352,50,"isInsertSvg = false");return u}a6j(u){return!!u&&!!u.OriginalUrl&&0<u.OriginalUrl.length&&u.OriginalUrl.toLowerCase().indexOf(".mp4")===u.OriginalUrl.length-4}}Object(r.a)(dj,"InsertOnlineImageHelper",th,[]);var am=d(732);class um{constructor(u,P){this.Zeb=!1;this.tfb=new Date(0);this.sfb=new Date(0);this.qFe=u;this.wb=P}peg(){this.Zeb=!0}wLa(){this.Zeb?L.a.J(593884831,813,100,"PrefetchScheduler::ScheduleJob: A scan has been requested but we have been paused or halted."):
this.tfb>this.sfb?L.a.J(593884829,813,100,"PrefetchScheduler::ScheduleJob: A scan has been requested but we are already waiting for a different scan. Last scan schedule at "+this.tfb+". Last scan at "+this.sfb+"."):(this.tfb=new Date,this.wb.Hb(new O.a(3,1,0,Object(z.a)(this,this.IXe,"runJob"),90,"112")))}IXe(){this.sfb=new Date;this.Zeb?L.a.J(593884827,813,100,"PrefetchScheduler::RunJob: We were halted while waiting to be scheduled, so we won't do our work."):this.qFe()&&this.wLa()}}Object(r.a)(um,
"PrefetchScheduler",null,[]);class pl{constructor(u,P,la){this.l6c=null;this.nEg=P;this.Byg=la;this.TCb=u}Mil(u){this.TCb!==u&&(this.TCb=u,this.l6c=null)}Csj(){this.l6c||(this.l6c=this.cwi());return this.l6c}cwi(){const u=[];Array.add(u,this.TCb);for(let P=1;P<=this.nEg||P<=this.Byg;P++)P<=this.nEg&&Array.add(u,this.TCb+P),P<=this.Byg&&0<=this.TCb-P&&Array.add(u,this.TCb-P);return u}}Object(r.a)(pl,"SlideWindow",null,[]);class vm{constructor(u,P,la,Ba,Sa,pb,Vb,Bc){this.Tgb=!1;this.jc=Sa;this.oq=Ba;
this.ixa=Bc;this.VCb=new am.a;this.GA=new um(Object(z.a)(this,this.c8e,"tryScan"),pb);this.c2g=new pl(Ba&&Ba.Ba?Ba.Ba.slideIndex:0,Vb?Vb.RBl:10,Vb?Vb.QBl:5);this.o0e(u,P,la)}start(){this.Tgb?L.a.J(593884825,813,100,"StreamVideoPrefetchOrchestrator::Start: Trying to start StreamVideoPrefetchOrchestrator twice."):(L.a.J(593773075,813,100,"StreamVideoPrefetchOrchestrator Starting."),this.Tgb=!0,this.GA.wLa())}o0e(u,P,la){u&&u.FI(Object(z.a)(this,this.nid,"onEditSlideChanged"));P&&P.jja(Object(z.a)(this,
this.rjd,"onPageContentLoaded"));la&&la.KQa(Object(z.a)(this,this.bIk,"onSlideshowSlideChanged"))}rjd(u,P){this.Tgb&&(u=Object(S.a)(118,P.node))&&u.uE&&(this.VCb.remove(u.Db),this.GA.wLa())}nid(u,P){P&&P.Yna&&this.YB(P.Yna.slideIndex)}bIk(u,P){P&&this.YB(P.slideIndex)}YB(u){this.c2g.Mil(u);this.Tgb&&this.GA.wLa()}c8e(){const u=this.dde();0<u.length&&this.lYe(u[0]);return 1<u.length}dde(){const u=[];var P=this.oq.presentation;if(!P)throw Error.argumentNull("Presentation is null");P=P.slides||[];for(const la of this.c2g.Csj()){const Ba=
P[la];this.otl(Ba)&&Array.add(u,Ba)}return u}otl(u){return!!u&&u.uE&&!u.gO&&!this.VCb.contains(u.Db)}lYe(u){this.VCb.add(u.Db);u=this.otj(u);0<u.length&&(L.a.J(593773072,813,100,"StreamVideoPrefetchOrchestrator::ScanSlide: Found {0} videos.",u.length),this.ixa?this.ixa.eSk(u):L.a.J(593773070,813,10,"StreamVideoPrefetchOrchestrator::ScanSlide: Found videos to prefetch, but StreamPreFetchService is null."))}otj(u){if(!this.jc)return L.a.J(593884821,813,10,"StreamVideoPrefetchOrchestrator::GetStreamVideosToLoadForSlide: SlideReader is null, so we cannot scan slides for Stream videos."),
this.GA.peg(),[];const P=[];if(!u)return P;u=Object(S.a)(118,u);if(!u)return P;for(const la of u.Uj())(u=la.sha)&&this.ixa&&this.ixa.Mcb(u)&&Array.add(P,u);return P}static d1j(u){return!!u&&u.csg&&!qd.a.Vi&&!qd.a.ZFa&&!qd.a.kJ&&!qd.a.Mqe}}Object(r.a)(vm,"StreamVideoPrefetchOrchestrator",null,[]);class Sf{static addAppPLTEventToLog(u){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(u)}catch(P){}}static setIsPageLoadForFirstTime(u){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(u)}catch(P){}}}
Object(r.a)(Sf,"VersionHistoryLogConnector",null,[]);class bm{constructor(u,P,la,Ba){this.kY=null;this.brh=this.ResetAppVersionController;this.Pw=u;this.Hi=P;this.Ea=la;this.oc=Ba;this.vZa={}}OnVersionHistorySelected(u,P){try{L.a.J(39105290,822,50,"PPTVersionHistorySelectionHandler:OnVersionHistorySelected");const la=document.getElementById("VersionHistoryViewerSpinner");la&&(la.style.display="none");if(this.kY)this.kY.onVersionSelected(u,P,this.vZa)}catch(la){L.a.J(39146258,822,50,"PPTVersionHistorySelectionHandler: OnVersionHistorySelected failed due to exception. {0}",
la)}}ResetAppVersionController(u){try{if(this.kY)Sf.setIsPageLoadForFirstTime(!1),this.kY.switchParentViewContainer(u);else{Sf.setIsPageLoadForFirstTime(!0);const P=new PowerPointVersionHistory.AppBootSettings;P.RenderServiceBase="";P.IsRtl=!1;const la=new PowerPointVersionHistory.AppCallbackBag;la.animationDecoratorCallback=Object(z.a)(this.Pw,this.Pw.s0d,"createAnimationOrTransitionStar");la.notesIconDecoratorCallback=Object(z.a)(this,this.CreateNotesIcon,"CreateNotesIcon");P.IsHighContrast=!1;
this.Hi&&(P.IsHighContrast=this.Hi.isInHighContrastMode);P.IsHighContrast&&(P.ClientColorSettings=this.Hi.highContrastColors.foregroundTextColor+"_"+this.Hi.highContrastColors.backgroundColor+"_"+this.Hi.highContrastColors.linkColor);if(this.oc){const Ba=this.oc.oUa();P.DefaultSlideWidth=Ba.width;P.DefaultSlideHeight=Ba.height}P.UserSessionId=v.AFrameworkApplication.userSessionId;P.VersionViewerCssUrl=this.Ea.versionHistoryViewerCssUrl;P.ProgressImageResourceUrl=$f.a.JN(Of.a.Foa);this.kY=new PowerPointVersionHistory.AppVersionController(P,
u,la)}}catch(P){L.a.J(39146260,822,50,"PPTVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",P)}}CreateNotesIcon(){return ha.createClusteredImage(14,14,"ToolbarNotesActiveDark_14x14x32",null,!0,"Notes")}}Object(r.a)(bm,"PPTVersionHistorySelectionHandler",null,[903]);class Vn extends le{constructor(u){super(u,void 0,v.AFrameworkApplication.Zsa)}get Tna(){return CommonUIStrings.l_DownLoadACopyDialogMessage}get vCb(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get gdc(){return"PowerPointDownloadCopyLink"}get buttonText(){return CommonUIStrings.l_Download}get H3b(){return v.AFrameworkApplication.Zsa?
"UIFontDialogTextLarge":null}vdc(){L.a.J(19743688,801,50,"Download a copy dialog displayed")}xdc(){L.a.J(19743690,801,50,"Download a copy dialog clicked")}ndb(){L.a.J(19743692,801,50,"Download a copy dialog button clicked")}}Object(r.a)(Vn,"PowerPointDownloadACopyDialog",le,[]);class sg{Pwl(u){new Vn(u)}}Object(r.a)(sg,"PowerPointDownloadACopyDialogFactory",null,[770]);var nf=d(152),Jj;(function(u){u[u.OK=0]="OK";u[u.cancel=1]="cancel";u[u.error=2]="error";u[u.open=3]="open"})(Jj||(Jj={}));Object(r.b)("HubbleAction",
Jj);var If=d(540);const Je={"https://hubblecontent.osi.office-int.net":"https://osiziwuspersimmon002.blob.core.windows.net","https://hubblecontent.osi.officeppe.net":"https://osizewuspersimmon001.blob.core.windows.net","https://hubblecontent.df.osi.office.net":"https://osizpscuspersimmon000.blob.core.windows.net","https://hubblecontent.msit.osi.office.net":"https://cdn.hubblecontent.msit.osi.office.net","https://hubblecontent.osi.office.net":"https://cdn.hubblecontent.osi.office.net"};class F extends Ke.a{constructor(u,
P,la,Ba,Sa){super();this.Nw=null;this.$7c=!1;this.pgc=this.bna=this.NX=null;this.lXd="KeepFocusDiv";this.mXd="KeepFocusStartDiv";this.correlationId=null;this.qaa=0;this.insertPictureTelemetryEndpoint=null;this.UPc=0;if(!u)throw Error.argumentNull("insertMediaSeviceEndpoint","insertMediaSeviceEndpoint cannot be null.");this.wGg=u;this.kR="";this.rM=la;this.H4=Ba;this.YYa=[];this.bnk=P;this.sg=Sa||yd.sg;this.kg="InsertMediaDialog";this.Ffe=!1;this.Ad=5}Slb(u,P,la){this.kR=u;la&&this.refreshToken(la);
this.$7c=!1;this.showDialog(this.kR,null);this.NX=this.YUc(this.Uh("insertmediaframe"));if(!this.NX)throw this.Q9a(this.YKc),Error.invalidOperation("Couldn't get InsertMediaIframe.");(u=document.getElementById(this.Uh("WACDialogPanel")))&&u.setAttribute(Ha.a.hf,Ha.a.qVd);u=document.createElement("div");u.setAttribute("Id",this.mXd);u.setAttribute("tabindex","0");u.setAttribute("position","absolute");u.setAttribute("width","-1000px");u.setAttribute("top","-1000px");this.NX.parentNode.insertBefore(u,
this.NX.parentNode.firstChild);u=document.createElement("div");u.setAttribute("Id",this.lXd);u.setAttribute("tabindex","0");this.NX.parentNode.appendChild(u);u.setAttribute("position","absolute");u.setAttribute("width","-1000px");u.setAttribute("top","10000px");$addHandler(this.q3d,"keydown",Object(z.a)(this,this.kA,"keyDownHandler"));this.NX.setAttribute("src",this.wGg);this.NX.setAttribute("width","100%");this.NX.setAttribute("height","100%");this.NX.setAttribute("frameborder","0");v.AFrameworkApplication.fa.ka("ShowInsertMediaIframeWhenIframeIsReady")&&
(qd.a.gg||qd.a.bcc)?(this.NX.style.visibility="hidden",this.pgc=Object(z.a)(this,this.hEk,"onInsertMediaIframeLoaded"),Be.a.addHandler(this.NX,"load",this.pgc)):this.NX.style.visibility="visible";this.YUc(this.Uh("WACDialogTitleText")).style.display="none";if(2===this.qaa||5===this.qaa)this.YUc(this.Uh("WACDialogTitlePanel")).style.display="none",this.YUc(this.Uh("WACDialogBodyPanel")).style.padding="0";ud.FocusManager.instance().Ll().scope.uJ=!0;u=this.wGg;if(v.AFrameworkApplication.fa.ka("GetCustomHeaderEnabled")){la=
new URL(u);const Ba=Je[la.protocol+"//"+la.host];Ba?u=Ba:n.ULS.sendTraceTag(508937633,352,10,`Target URL: ${la.host} not found`)}this.Nw=this.bnk.getInstance(this.NX.contentWindow,u);this.Nw.qCa("https://osiziwuspersimmon002.blob.core.windows.net");this.Nw.qCa("https://osizewuspersimmon001.blob.core.windows.net");this.Nw.qCa("https://osizpscuspersimmon000.blob.core.windows.net");this.Nw.qCa("https://cdn.hubblecontent.msit.osi.office.net");this.Nw.qCa("https://cdn.hubblecontent.osi.office.net");this.Nw.Aya(Jd.a.Ixf,
Ba=>{this.eAk(Ba,Object(z.a)(P,P.Fua,"insertMediaCallback"))});this.Nw.Aya(Jd.a.insert,Ba=>{this.iMe(Ba,Object(z.a)(P,P.Fua,"insertMediaCallback"))});this.Nw.Aya(Jd.a.Zci,Ba=>{this.xFk(Ba)});this.Nw.Aya(Jd.a.Gej,Object(z.a)(this,this.sDk,"onGetCustomHeaders"));this.Nw.Aya(Jd.a.qrj,Object(z.a)(this,this.DDk,"onGetSessionId"));this.Nw.Aya(Jd.a.Dbj,Object(z.a)(this,this.pDk,"onGetCID"));this.Nw.Aya(Jd.a.lxi,Object(z.a)(this,this.mBk,"onCancelDialog"));2===this.qaa&&0===this.UPc&&(this.Nw.Aya(Jd.a.Z7j,
Object(z.a)(this,this.EEk,"onLaunchM365Upsell")),this.bna=this.H4.v0a("MsoPremiumStockImages",Ba=>{n.ULS.sendTraceTag(512497694,352,50,"OnCompleteM365Upsell: Thanks for purchasing!");this.Nw.sendMessage(Jd.a.sRl,{["LicenseTier"]:Ba.toString()})}));this.Asc(3)}refreshToken(u){return Object(nf.a)(this,void 0,void 0,function*(){this.Pl=(new Date).getTime();try{const P=yield u.gI("Hubble","84a0e9dd-6e58-4aad-82af-ebe485acd09d/.default");P.IsSuccess&&(this.ZGe=P.Token);n.ULS.sendTraceTag(509096264,352,
50,`Hubble token requested by: ${"PowerPointInsertMediaDialog"} successful: ${!!this.ZGe} time: ${(new Date).getTime()-this.Pl}`)}catch(P){n.ULS.sendTraceTag(509096262,352,10,`Hubble token requested by: ${"showInsertMediaDialog"} successful: false time: ${(new Date).getTime()-this.Pl} error: ${P}`)}})}hEk(){this.NX&&(this.NX.style.visibility="visible",window.setTimeout(()=>{if(this.oi){const u=this.oi.getElementById("insertmediaframe");u&&u.focus()}},0))}kA(u){u.keyCode===Sys.UI.Key.tab&&(u.target.id!==
this.lXd||u.shiftKey?u.target.id===this.mXd&&u.shiftKey&&(u.preventDefault(),this.oi.getElementById(this.lXd).focus()):(u.preventDefault(),this.oi.getElementById(this.mXd).focus()))}dispose(){this.H4&&this.bna&&this.H4.akb("MsoPremiumStockImages",this.bna);this.Nw&&(this.Nw.dispose(),this.Nw=null);this.pgc&&(Be.a.removeHandler(this.NX,"load",this.pgc),this.pgc=null);super.dispose()}eAk(u,P){n.ULS.sendTraceTag(7135752,352,100,"OnAddItem : Got message.");if(u=this.rM.ueh(u))50<this.YYa.length?n.ULS.sendTraceTag(7135753,
352,15,"OnAddItem : Only allow 50 items to be added."):(Array.add(this.YYa,u),this.$7c&&(P(this.YYa),this.$7c=!1))}mBk(){n.ULS.sendTraceTag(17662422,352,100,"OnCancelDialog : Got message.");this.Q9a(this.YKc);this.Asc(1)}Asc(u){if(2===this.qaa||5===this.qaa){const Ba=v.AFrameworkApplication.fa.Ha("InsertMediaDialogAriaTenantNameSpace");if(Ba&&""!==Ba){var P=[],la="InsertUnknownContent";2===this.qaa?(Array.add(P,Object.assign(new M.a,{name:"DialogMode",string:"M365Content"})),Array.add(P,Object.assign(new M.a,
{name:"Provider",string:"M365Content"})),la="InsertM365Content"):5===this.qaa&&(Array.add(P,Object.assign(new M.a,{name:"DialogMode",string:"HubbleVideo"})),Array.add(P,Object.assign(new M.a,{name:"Provider",string:"HubbleVideo"})),la="InsertHubbleVideo");Array.add(P,Object.assign(new M.a,{name:"InsertedFiles",int64:this.YYa.length}));Array.add(P,Object.assign(new M.a,{name:"DialogResult",string:Jj[u]}));Array.add(P,Object.assign(new M.a,{name:"CorrelationId",string:this.correlationId.toString()}));
B.a.sendTelemetryEvent(Object.assign(new N.a,{name:String.format("{0}.{1}",Ba,la),dataFields:P}))}}}YUc(u){const P=document.getElementById(u);if(!P)throw Error.invalidOperation(String.format("Couldn't get {0}.",u));return P}iMe(u,P){n.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");this.Q9a(this.YKc);P?this.YYa&&0<this.YYa.length?(P(this.YYa),this.Asc(0)):(n.ULS.sendTraceTag(23078422,352,15,"Empty search result."),this.$7c=!0,P(this.YYa),this.Asc(2)):this.Asc(2)}sDk(){this.Nw&&(n.ULS.sendTraceTag(509096025,
352,50,`onGetCustomHeaders : Token available: ${!!this.ZGe} time: ${(new Date).getTime()-this.Pl}`),this.Nw.sendMessage(Jd.a.dkl,{["CustomHeaders"]:this.ZGe||""}))}DDk(){this.Nw&&(n.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),this.Nw.sendMessage(Jd.a.$nl,{["SessionId"]:v.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))}pDk(){this.Nw&&(n.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),this.Nw.sendMessage(Jd.a.xjl,{["CID"]:""}))}xFk(u){u&&
u.Values&&(u=u.Values,delete u.m_Origin,delete u.m_Source,delete u.m_ReceivedTime,n.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+u.eventName||!1),B.a.sendOtelEvent(Object.assign(new If.a,{otelEvent:u})))}EEk(){this.H4&&(n.ULS.sendTraceTag(512497693,352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),this.H4.launchUpsellExperience("stockimages"))}}Object(r.a)(F,"InsertMediaDialog",Ke.a,[922,107]);class V{getInstance(u,P,la,Ba,Sa){return new F(u,P,la,Ba,Sa)}}Object(r.a)(V,
"PptInsertMediaDialogFactory",null,[902]);var za=d(114);class gb{constructor(u){this.zeb=u;this.o0e(this.zeb.el,this.zeb.UNg)}o0e(u,P){u&&u.FI(Object(z.a)(this,this.nid,"onEditSlideChanged"));P&&P.jja(Object(z.a)(this,this.rjd,"onPageContentLoaded"))}s6k(u,P){u&&u.s6(Object(z.a)(this,this.nid,"onEditSlideChanged"));P&&P.A0a(Object(z.a)(this,this.rjd,"onPageContentLoaded"))}rjd(u,P){(u=Object(S.a)(118,P.node))&&u.uE&&(this.zeb.VCb.remove(u.Db),this.zeb.GA.wLa())}nid(u,P){P&&P.Yna&&(this.zeb.sXa=P.Yna,
this.zeb.GA.wLa(),this.zeb.gte=new Date)}}Object(r.a)(gb,"SlideEventListener",null,[]);class Fb{constructor(u,P,la){this.U_g="";this.Zeb=!1;this.tfb=new Date(0);this.sfb=new Date(0);this.qFe=u;this.wb=P;la&&(this.U_g=la)}peg(){this.Zeb=!0}wLa(){this.Zeb?L.a.J(591003664,813,100,"BackgroundJobScheduler::ScheduleJob: A scan has been requested but we have been paused or halted."):this.tfb>this.sfb?L.a.J(591003662,813,100,"BackgroundJobScheduler::ScheduleJob: A scan has been requested but we are already waiting for a different scan. Last scan schedule at "+
this.tfb+". Last scan at "+this.sfb+"."):(this.tfb=new Date,this.wb.Hb(new O.a(3,1,0,Object(z.a)(this,this.IXe,"runJob"),90,this.U_g)))}IXe(){this.sfb=new Date;this.Zeb?L.a.J(591003660,813,100,"BackgroundJobScheduler::RunJob: We were halted while waiting to be scheduled, so we won't do our work."):this.qFe()&&this.wLa()}}Object(r.a)(Fb,"BackgroundJobScheduler",null,[]);class Ec{constructor(u,P,la,Ba,Sa,pb,Vb,Bc,Yc,gd,Td){this.Tdd=null;this.gte=new Date;this.sXa=null;this.RDg={};this.B0g={};this.l1g=
{};this.UCg={};if(!la)throw Error.argumentNull("graphTopologyManager");if(!Ba)throw Error.argumentNull("fontUtilsManager");this.oq=la;this.xz=Ba;this.el=u;this.UNg=P;this.WGb=Bc;this.dZa=Yc;this.XGb=gd;this.Jdd=Td;this.VCb=new am.a;this.GA=new Fb(Object(z.a)(this,this.c8e,"tryScan"),Sa,"");0<pb&&window.setInterval(Object(z.a)(this,this.qwg,"logMissingFonts"),pb);this.elk=Vb;u=la.Ba?la.Ba.slideIndex:0;if(P=this.oq.presentation)P=P.slides||[],u<P.length&&(this.sXa=P[u],this.gte=new Date)}dispose(){this.stop();
this.qwg()}start(){this.stop();this.Tdd=new gb(this);this.GA.wLa()}stop(){this.Tdd&&this.Tdd.s6k(this.el,this.UNg);this.Tdd=null}dde(){const u=[];this.sXa&&u.push(this.sXa);return u}c8e(){const u=this.dde();0<u.length&&(this.lYe(u[0]),this.VCb.add(u[0].Db));return 1<u.length}mse(u,P,la,Ba){const Sa=[];for(const pb of Object.keys(u))u[pb]||this.UCg[pb]||(Sa.push(pb),this.UCg[pb]=!0);u=Sa.length;0<u&&(L.a.J(la,820,15,"{0}",u),P&&L.a.J(Ba,820,15,"{0}",Sa.join(",")))}lYe(u){const P=u.sUa();if(P&&(this.WGb||
this.XGb||this.dZa||Ud.a("ShouldLogMissingThirdPartyFontCount"))){var la={},Ba={},Sa={};u.U0f.split(",").forEach(gd=>{gd&&(gd=this.xz.pG(gd),la[gd]=!1)});u.BIh.split(",").forEach(gd=>{gd&&(gd=this.xz.pG(gd),Ba[gd]=!1)});u.jMh.split(",").forEach(gd=>{gd&&(gd=this.xz.pG(gd),Sa[gd]=!1)});u=[];var pb=[],Vb=[];for(let gd=0;gd<P.length;gd++){var Bc=P[gd];Bc=Array.isArray(Bc.nz())?Bc.nz():null;for(const Td of Bc)for(Bc=0;Td.Ta&&Bc<Td.Ta.length;){var Yc=Td.Ta.ga(Bc);Yc=Yc.formatting?this.xz.pG(za.Font.PEa(Yc.formatting.cache.wL.trim().toLowerCase())):
"";lb.a.Xa(Yc)||(Yc in la&&!la[Yc]?(u.push(Yc),la[Yc]=!0):Yc in Ba&&!Ba[Yc]?(pb.push(Yc),Ba[Yc]=!0):Yc in la||Yc in Ba||Sa[Yc]||(Vb.push(Yc),Sa[Yc]=!0));Bc++}}this.WGb&&(Ec.gie(this.RDg,u,this.xz),this.mse(la,!0,555886295,555886296));if(this.dZa||Ud.a("ShouldLogMissingThirdPartyFontCount"))Ec.gie(this.B0g,pb,this.xz),this.mse(Ba,this.dZa||this.Jdd,555886297,555886298);this.XGb&&(Ec.gie(this.l1g,Vb,this.xz),this.mse(Sa,this.Jdd,555886299,555886300))}}qwg(){+new Date-+this.gte<this.elk||(this.WGb&&
Ec.xse(this.RDg,this.xz,591003669,!0,"MissingFirstPartyFonts"),(this.dZa||Ud.a("ShouldLogMissingThirdPartyFontCount"))&&Ec.xse(this.B0g,this.xz,591003667,this.dZa||this.Jdd,"MissingThirdPartyFonts"),this.XGb&&Ec.xse(this.l1g,this.xz,587337796,this.Jdd,"MissingNonLoggableFonts"))}static gie(u,P,la){P.forEach(Ba=>{Ud.a("ShouldNormalizeFontNamesBeforeLogging")&&(Ba=la.pG(Ba));if(void 0===u[Ba]||null===u[Ba])u[Ba]=!1})}static tlj(u,P){if(!u)throw Error.argumentNull("fonts");const la=[];for(const Ba of Object.keys(u))u[Ba]||
(P.A9(Ba)||P.A9('"'+Ba+'"')||la.push(Ba),u[Ba]=!0);return la}static xse(u,P,la,Ba,Sa){P=Ec.tlj(u,P);u=P.length;0<u&&(P=P.join(","),Ba&&587337796===la?L.a.J(la,820,15,"{0}",P):L.a.J(la,820,15,"{0}",Ba?P:u.toString()),la=new Map,Ba&&la.set("Fonts",P),la.set("FontsCount",u.toString()),Wf.Health.instance.recordQosError(Sa,["MissingFont"],!1,!1,!0,!1,Object.assign(new Kc.a,{extendedProperties:la})))}}Object(r.a)(Ec,"FontLogger",null,[107]);var $c=d(993),Ed=d(998),pe=d(201);class Se{constructor(u,P,la,
Ba,Sa,pb,Vb,Bc,Yc,gd,Td,Re,Uf,Ef,Oh,ek,je,Qf,Jg,Ei){this.WHa=!1;this.bna=null;this.pxl=(wj,Ti,pf)=>{var tk;Ti=this.ta.Ba;if(!Ti||this.$b.$c(Ti))return 16;if(1===pf)return 32;L.a.J(508941190,846,50,"InsertVideoActor::InsertStockVideos Initiated");this.Ve=$h.a.kk("StockVideos::Insert");pf=new ya.QueryStringBuilder(this.Ea.Eie);pf.hy("initpivot","stockvideos");pf.jg("entryPoint",tb.a.Hv(wj));pf.jg("sv","1");const Qk=new dj(this.ia,this.rM,this.Ea);Qk.zx=tb.a.Jbb;null===(tk=this.Ve)||void 0===tk?void 0:
tk.Wa("StockVideoInitiatedByRibbon","true");Qk.Qvh(this.Ve);const Bk=pf.toString();if(!Bk||!Bk.length)return 16;try{const Fi=ua.a.create(),Uj=lb.a.iL(this.Ea.pptEditingUserId).toString();this.Rea.execute(jm=>{var vl=this.Ea.Akg&&jm.isFreemiumUpsellEnabled();vl=this.WHa?1:vl?0:-1;var Th=this.Ea.ka("InsertOnlineM365ExperimentEnabled")?1:0;Th=this.rM.vFf(pe.App.mode,Bk,vl,1,Fi.toString(),Uj,Th);jm=this.uEb.getInstance(Th,this.tEb,this.rM,jm,oe.sg);jm.correlationId=Fi;jm.qaa=2;jm.UPc=vl;jm.Slb(CommonUIStrings.L_VideoInsertTitle,
Qk,void 0);this.Ve&&this.Ve.Wa("StockVideoDialogInitialized","true");L.a.J(509100040,846,50,"InsertVideoActor::showStockVideosDialog : Show dialog success.")});return 32}catch(Fi){L.a.J(509100039,846,10,"InsertVideoActor::showStockVideosDialog : Exception = [{0}]",Fi.toString())}return 8};this.nQj=(wj,Ti,pf,tk,Qk)=>{wj=this.ta.Ba;if(!wj||this.$b.$c(wj))return 16;if(1===pf)return 32;if(!this.hj.iD(wj,1))return this.hj.KD(wj),16;if(!Qk||!Qk.OriginalUrl)return 16;try{const Bk=wj.C_(this.kb.Xd());if(Bk&&
this.$b.$c(Bk))return 16;const Fi=this.dXc(wj,Bk),Uj=this.Eb.xd(15,void 0,()=>{this.kb.au();this.kb.nh();this.Fa.Bd()},()=>{this.kb.selectShape(Fi,!0)});try{Uj.hc(wj);Uj.fd=tb.a.Jbb;Uj.py[ea.a.mka]=ea.a.online;L.a.J(509100038,846,50,"InsertVideoActor::UploadStockVideo");Fi.setValue(Zb.a.esa,Qk.LicenseUrl?null:Qk.Caption);Fi.xRb=Qk.Caption;Fi.setValue(Zb.a.mediaType,2);Fi.setValue(Zb.a.pp,!0);Fi.setValue(Zb.a.fMa,!0);Fi.setValue(Zb.a.sha,Qk.OriginalUrl);Fi.setValue(Zb.a.rO,!0);const jm=String.format("{0}{1}",
"video",ua.a.create().toString());Fi.yRb=jm;Bk&&wj.YR([Bk]);wj.jB(Fi)}finally{Uj&&Uj.dispose()}this.Rq.lA=Fi;return 32}catch(Bk){return L.a.J(509100037,846,10,"InsertVideoActor:: Error while creating video shape node : Exception = [{0}].",Bk.toString()),8}};this.fba=(wj,Ti)=>{var pf;this.Ve&&(this.Ve.Wa("MediaFileValidationPassedOnUI","false"),this.Ve.Wa("ErrorMessage",null===(pf=Ti.Message)||void 0===pf?void 0:pf.toString()),this.Ve.finish(),this.Ve=null);wj=Ti.ExtraErrorParam?String.format(Ti.Message,
Ti.ExtraErrorParam):Ti.Message;Ti=Object.assign(new Ed.a,{title:Ti.Title,message:wj,timeoutInSeconds:120});this.yH.MBh(Ti)};if(!u)throw Error.argumentNull("applicationSettings");if(!P)throw Error.argumentNull("actionManager");if(!la)throw Error.argumentNull("graphTopologyManager");if(!Ba)throw Error.argumentNull("graphActionBlockingManager");if(!Sa)throw Error.argumentNull("pptSelectionManager");if(!pb)throw Error.argumentNull("ribbonChangeManager");if(!Vb)throw Error.argumentNull("transactionFactory");
if(!Bc)throw Error.argumentNull("shapeEditor");if(!Yc)throw Error.argumentNull("errorHandler");if(!gd)throw Error.argumentNull("focusManager");if(!Td)throw Error.argumentNull("sessionInfo");if(!Re)throw Error.argumentNull("mediaUploaderFactory");if(!Uf)throw Error.argumentNull("calloutNotificationAdapter");if(null===u||void 0===u?0:u.Kbb){if(!Ef)throw Error.argumentNull("appFeatureHelper");if(!Oh)throw Error.argumentNull("insertMediaHelper");if(!je)throw Error.argumentNull("insertMediaCrossDocumentMessengerFactory");
if(!ek)throw Error.argumentNull("insertMediaDialogFactory");if(!Qf)throw Error.argumentNull("shapeCountValidator");if(!Jg)throw Error.argumentNull("pageView");if(!Ei)throw Error.argumentNull("presReader");}this.Ea=u;this.ia=P;this.ta=la;this.$b=Ba;this.kb=Sa;this.Rq=pb;this.Eb=Vb;this.xk=Bc;this.Ud=Yc;this.Fa=gd;this.lq=la.presentation;this.Ie=Td;this.Cfb=Re;this.yH=Uf;this.Rea=Ef;this.rM=Oh;this.tEb=je;this.uEb=ek;this.hj=Qf;this.Gb=Jg;this.Sb=Ei;$c.a.FSl=this.Ea.dQh;$c.a.ATl=this.Ea.CTl;(null===
u||void 0===u?0:u.Kbb)&&this.uzi()}vb(){this.ia.ra(tb.a.LOb,Ff.a.application,this.wGj.bind(this),4);this.ia.ra(tb.a.Hkg,Ff.a.application,this.pxl,4);this.ia.ra(tb.a.Jbb,Ff.a.application,this.nQj,4);Ud.a("EnableCalloutNotificationsForVideos")&&Ri.b(this.fba)}pe(){}wGj(u,P,la){const Ba=this.ta.Ba;if(!Ba||this.$b.$c(Ba))return 16;if(1===la)return 32;this.Ve=$h.a.kk("Video::Insert");try{return L.a.J(509650205,846,50,"InsertLocalVideo: flow initiated"),vj.a.B2e(this.Ea.dQh.toString(),Ri.e,()=>Ri.d(u,this.yQj.bind(this),
"video",this.Ie,Ba),"video",Ba,this.ta.presentation,this.$b,this.Ud,this.Ve,!0,this.Cfb,this.Ea.zxc,this.Ea.yxc,this.Ea.xxc),this.Ve&&this.Ve.Wa("VideoDialogInitialized","true"),32}catch(Sa){L.a.J(509724677,818,10,"Exception {0} while rendering file selection dialog.",Sa)}Ri.a("video")?Ri.c(ResourceStrings.l_FileInsertFailedMessageTitle,ResourceStrings.l_FileInsertFailedMessage,null):this.showErrorMessage(446,null);return 8}dispose(){this.Rea.instance&&this.bna&&this.Rea.instance.akb("MsoPremiumStockImages",
this.bna)}showErrorMessage(u,P){this.Ve&&(this.Ve.finish(),this.Ve=null);this.Ud.nH(u,la=>{la.KC=1;la.bTa=P;return!1})}yQj(u,P,la,Ba,Sa,pb,Vb){Ba.hO(la)&&L.a.J(509724676,822,15,"Video::insertVideoSuccessAfterUpload:Presentation was blocked with loader for {0} milliseconds",+new Date-+la.Mja);Ba.xK(Vb);la=Vb.zs();var Bc=this.lq.slideHeight;Ba=this.lq.slideWidth/2-nc.a.gf(Of.a.LR/2,0);Bc=Bc/2-nc.a.gf(Of.a.LR/2,1);if(Vb&&Vb.isConnected){var Yc=this.Eb.xd(15,void 0,void 0,()=>{this.Rq.lA=this.HHb;this.kb.selectShape(this.HHb,
!0);this.Fa.Bd()});try{Yc.hc(Vb);Yc.fd=u;Sa&&Sa.Wa("CreatingVideoShape","true");this.HHb=this.xk.ADa(!1,Vb.Db.cid,Vb.Db.sid,0,10,Ba,Bc,Of.a.LR,Of.a.nY,la+1);const gd=pb.files[0].name;this.HHb.yRb=P;this.HHb.xRb=gd;Ud.a("SetMediaTypeAsVideoForEmbeddedVideo")&&this.HHb.setValue(Zb.a.mediaType,2);Vb.jB(this.HHb)}finally{Yc&&Yc.dispose()}Sa&&(Sa.Wa("VideoShapeSuccessfullyCreated","true"),Sa.finish(),Sa=null)}}uzi(){this.Rea.execute(u=>{u.isFeatureEnabled("MsoPremiumStockImages",!1).catch(P=>L.a.J(509100036,
846,10,"InsertVideoActor::Constructor - Failed to load the premium state from application feature helper: {0}",P)).then(P=>{this.WHa=P;this.WHa||(this.bna=u.v0a("MsoPremiumStockImages",()=>{this.WHa=!0;L.a.J(509100035,846,50,"InsertVideoActor:: setting isUserLicensed=1")}));return null})})}dXc(u,P){if(!u)return null;var la=u.Db;u=u.zs();const Ba=this.Sb.Rka(Of.a.LR,Of.a.nY);la=this.xk.Uja(!0,la.cid,la.sid,0,Ba.x,Ba.y,Of.a.LR,Of.a.nY,u+1,!0);P&&(la.v8=P.id);return la}}Object(r.a)(Se,"InsertVideoActor",
null,[251]);class Ye{constructor(u,P,la,Ba,Sa,pb,Vb,Bc){if(!u)throw Error.argumentNull("transactionHelper");if(!P)throw Error.argumentNull("actionManager");if(!Ba)throw Error.argumentNull("graphTopologyManager");if(!Ba.presentation)throw Error.argumentNull("graphTopologyManager.presentation");if(!la)throw Error.argumentNull("graphActionBlockingManager");if(!Sa)throw Error.argumentNull("ribbonChangeManager");if(!pb)throw Error.argumentNull("shapeEditor");if(!Vb)throw Error.argumentNull("shapeCountValidator");
if(!Bc)throw Error.argumentNull("appSettingsManager");this.qr=u;this.ia=P;this.ta=Ba;this.$b=la;this.Rq=Sa;this.lq=Ba.presentation;this.xk=pb;this.hj=Vb;this.Jb=Bc}vb(){this.Jb.ka("EnableCameoInEditor")&&this.ia.ra(tb.a.xkg,Ff.a.application,this.QBj.bind(this),4)}pe(){}QBj(u,P,la){P=this.ta.Ba;if(!P)return 16;if(T.a.Cw(P.Db))return 8;if(this.$b.$c(P))return 16;if(1===la)return 32;if(!this.hj.iD(P,1))return this.hj.KD(P),16;var Ba=Math.min(Math.min(this.lq.IDh,this.lq.uDh),100);la=P.zs();var Sa=this.lq.slideWidth,
pb=this.lq.slideHeight;const Vb=nc.a.gf(Ba,0);Ba=nc.a.gf(Ba,1);Sa=Sa/2-nc.a.gf(50,0);pb=pb/2-nc.a.gf(50,1);la=this.xk.ADa(!1,P.Db.cid,P.Db.sid,0,10,Sa,pb,Vb,Ba,la+1);la.Yua=!0;this.qr.zT([la],P,u);this.Rq.lA=la;return 32}}Object(r.a)(Ye,"InsertCameoActor",null,[251]);class ae{constructor(){this.U$=this.jh=this.w5=this.K=null;this.dNg=[];this.afc=[new ig];this.YX=[]}get name(){return"PowerPointWebEditor.Chronos2"}zla(u){return u.resolve("PowerPointWebEditor.IApplicationSettings").iA||u.resolve("PowerPointWebEditor.IApplicationSettings").ZF}Yb(u){this.K=
u;this.w5=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.jh=this.w5.XEa(5,this.name);this.U$=this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory");for(let Sa=0;Sa<this.afc.length;++Sa)Array.add(this.YX,xc.a(this.afc[Sa],5));for(const Sa of this.YX)Sa.Yb(u);const P=this.K.resolve("PowerPointWebEditor.IApplicationContext"),la=v.AFrameworkApplication.fa.ka("InsertOnlinePictureFromHostEmulatedOneDriveHostEnabled"),Ba=Qi.a.Lt(this.K.Ia("Common.IEventEmitter<Common.IGetMoreInfoResult>"));
this.zla(this.K)&&Object(Ud.a)("EnhancementOfSDXPaneBootTime")||this.K.register(Dh.a,"PowerPointWebEditor.AppForOfficeManagerFactory").as("PowerPointWebEditor.IAppForOfficeManagerFactory").oa(()=>new Dh.a(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTApp"),this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory"),this.zla(this.K))).ma();this.K.register(bm,
"PowerPointWebEditor.PPTVersionHistorySelectionHandler").as("Common.IVersionHistorySelectionHandler").ma().oa(()=>new bm(this.K.resolve("PowerPointWebEditor.IThumbnailViewHelper"),this.K.resolve("Common.Utils.IHighContrastDetector"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPresentationReader")));this.K.register(bk,"Box4.Media.OneDriveFilePickerHelperV7").as("Box4.Media.IImageFilePickerHelper").ma().oa(()=>new bk(u.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72"),
new Oa.a(()=>Ba.result),u.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory")));this.K.register(Xl,"Box4.Media.InsertOneDriveFileHelper").ma().oa(()=>new Xl(v.AFrameworkApplication.Ra));this.K.register(ie,"Box4.Media.InsertMediaHelper").as("Box4.Media.IInsertMediaHelper").ma().oa(()=>new ie);this.K.register(dj,"PowerPointWebEditor.InsertOnlineImageHelper").ma().oa(()=>new dj(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));
this.K.register(zb,"PowerPointWebEditor.ChangeOnlineImageHelper").ma().oa(()=>new zb(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(Ck,"Box4.Media.InsertMediaFromHostManagerFactory").as("Box4.Media.IInsertMediaFromHostManagerFactory").ma().oa(()=>new Ck(new ph(new Oa.a(()=>{if(v.AFrameworkApplication.BBh()){var Sa=this.K.resolve("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").h$a;
Sa=new Jk(Sa.contentWindow,"*")}else Sa=P.rij();return Sa}),la?Bd.a.DQ(window.document.URL):Bd.a.DQ(v.AFrameworkApplication.Boa),v.AFrameworkApplication.fa.appSettings.ImageFetcherSupportedExtensions)));this.K.register(Ni,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as("Box4.Media.IInsertMediaCrossDocumentMessengerFactory").ma();this.K.register(Rj,"Box4.Media.InsertMediaFromHostOneDriveHostFrame").as("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").ma().oa(()=>new Rj);this.K.register(V,
"PowerPointWebEditor.PptInsertMediaDialogFactory").as("PowerPointWebEditor.IPptInsertMediaDialogFactory").ma();this.K.register(770,"PowerPointWebEditor.IPowerPointDownloadACopyDialogFactory").ma().oa(()=>new sg);this.K.register(vm,"PowerPointWebEditor.StreamVideoPrefetchOrchestrator").ma().oa(()=>new vm(this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").yd(8),this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Video.IStreamPreFetchService")))}init(){let u=this.jh.Zt("resolvechronos2");const P=this.K.resolve("Common.AFrameworkApplication"),la=this.K.resolve("PowerPointWebEditor.IApplicationContext"),Ba=la.rd,Sa=P.aq,pb=this.K.resolve("PowerPointWebEditor.IPowerPointDownloadACopyDialogFactory"),Vb=this.K.resolve("Common.IActionManagerExtended"),
Bc=this.K.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory");var Yc=this.K.resolve("PowerPointWebEditor.IGraphTransactionHelper");const gd=this.K.resolve("PowerPointWebEditor.IFocusManager"),Td=Sa.Kd,Re=this.K.resolve("Common.Transaction.ITransactionFactory"),Uf=this.K.resolve("PowerPointWebEditor.IShapeEditor"),Ef=this.K.oe("PowerPointWebEditor.IClassFactory"),Oh=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),ek=this.K.resolve("Box4.Graph.IGraphIteratorFactory"),je=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),
Qf=this.K.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),Jg=this.K.resolve("PowerPointWebEditor.IPresentationReader"),Ei=Sa.Nib,wj=this.K.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),Ti=this.K.resolve("PowerPointWebEditor.IGraphHotColdManager"),pf=this.K.resolve("PowerPointWebEditor.ISaveBlockingUI"),tk=this.K.resolve("PowerPointWebEditor.IRibbonChangeManager"),Qk=this.K.resolve("PowerPointWebEditor.IShapeReader"),Bk=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");
this.jh.fu(u);u=this.jh.Zt("regactorschronos2");Yc=[...(this.zla(this.K)&&Object(Ud.a)("EnhancementOfSDXPaneBootTime")?[]:[new Kk.a(Ba,this.K.resolve("Common.IAppSettingsManager"),Yc,Vb,Td,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Re,Ef,Bc,this.K.Ia("PowerPointWebEditor.IAppForOfficeManager"),ek,je,Qf)]),new Ii(Ba,Vb,Bc,this.K.Ia("PowerPointWebEditor.IAddinCommandsManager")),new mj(Ba,Vb,je,Oh,gd,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Re,this.K.resolve("PowerPointWebEditor.IPptInsertMediaDialogFactory"),
this.K.resolve("Box4.Media.IInsertMediaFromHostManagerFactory"),this.K.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.K.resolve("PowerPointWebEditor.InsertOnlineImageHelper"),this.K.resolve("PowerPointWebEditor.ChangeOnlineImageHelper"),Jg,Uf,Qk,Bk,tk,Qf,this.K.resolve("Box4.Media.InsertMediaFromHostOneDriveHostFrame"),this.K.resolve("Box4.Media.IImageFilePickerHelper"),
this.K.resolve("Box4.Media.InsertOneDriveFileHelper"),this.K.resolve("PowerPointWebEditor.IInsertOnlineVideoDialogHelper"),this.K.resolve("PowerPointWebEditor.IInsertImageHelper"),this.K.resolve("PowerPointWebEditor.IJSanityHelper"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("Common.IExternalUICommandDefinitionMapping"),this.K.resolve("Common.IAppSettingsManager")),new Hg(Vb,this.K.resolve("PowerPointWebEditor.ISlidePane"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
je,Oh,tk,this.K.resolve("Common.Transaction.ITransactionFactory"),Uf,this.K.resolve("PowerPointWebEditor.IErrorHandler"),gd,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>this.K.resolve("PowerPointWebEditor.IMediaUploader")),new Ye(Yc,Vb,je,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),tk,Uf,Qf,this.K.resolve("Common.IAppSettingsManager")),new Se(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),Vb,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
je,Oh,tk,this.K.resolve("Common.Transaction.ITransactionFactory"),Uf,this.K.resolve("PowerPointWebEditor.IErrorHandler"),gd,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>this.K.resolve("PowerPointWebEditor.IMediaUploader"),this.K.resolve("PowerPointWebEditor.ICalloutNotificationAdapter"),this.K.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.resolve("PowerPointWebEditor.IPptInsertMediaDialogFactory"),this.K.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),
this.K.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IPresentationReader"))];for(const Fi of Yc)Fi.vb(),Fi.pe();Bc.Jwf=!0;this.jh.fu(u);v.AFrameworkApplication.fa.ff(()=>{u=this.jh.Zt("regfullactorschronos2");const Fi=[new ol(Vb,je,gd,Oh,this.K.resolve("PowerPointWebEditor.IPPTWorkspace").Ef,wj,la.lUa().v2j,Ti,this.K.resolve("PowerPointWeb.IPrinter"),this.K.resolve("PowerPointWeb.IConverter"),
this.K.resolve("Box4.IAppFrame"),pf,pb,this.K.resolve("PowerPointWebEditor.DownloadACopyAsPdfContext"),P.irmPolicyDescription,this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),()=>v.AFrameworkApplication.fK,la.sae(),Uj=>v.AFrameworkApplication.Aa.ob.U0e(Uj),()=>v.AFrameworkApplication.Dcc,
this.K.resolve("PowerPointWebEditor.IDeferredContentManager"),this.K.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")),new xa(Sa,Ba.P7i,Ei.embedPreviewUrl,Vb,Jg,la.sae(),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"))];for(const Uj of Fi)Uj.vb(),Uj.pe();this.jh.fu(u)});L.a.J(512360593,809,50,"Chronos2Package::Init");for(const Fi of this.YX)this.jh.Zt(Fi.name),Fi.init(),this.jh.fu(Fi.name);u=this.jh.Zt("al");this.CNj();this.jh.fu(u);
v.AFrameworkApplication.fa.ff(()=>{if(Ba.powerPointIdeasIsEnabled){u=this.jh.Zt("idea");var Fi=this.iOj();this.hOj(Fi);this.jh.fu(u)}Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFastCards",!1)&&(u=this.jh.Zt("fastcards"),this.PNj(),this.jh.fu(u));Ba.powerPointSmartLookupIsEnabled&&(u=this.jh.Zt("smartLookup"),this.XOj(),this.jh.fu(u));v.AFrameworkApplication.D3c()&&(u=this.jh.Zt("versionhistory"),this.mPj(),this.jh.fu(u));vm.d1j(Ba)&&ac.a.get_instance().Mj(7,()=>{this.K.resolve("PowerPointWebEditor.StreamVideoPrefetchOrchestrator").start()});
const Uj=this.K.resolve("PowerPointWebEditor.IApplicationSettings");if(Uj&&(Uj.DAh||Uj.CAh||Uj.EAh)){const jm=!lb.a.Xa(v.AFrameworkApplication.fa.Ha("TenantId"))&&Array.contains(Uj.WEl,v.AFrameworkApplication.fa.Ha("TenantId"));this.K.register(Ec,"PowerPointWebEditor.Text.FontLogger").ma().oa(()=>new Ec(this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").yd(8),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IFontUtilsManager"),
this.K.resolve("Common.ITaskManager"),Uj.pwk,Uj.owk,Uj.DAh,Uj.CAh&&v.AFrameworkApplication.fa.ka("IsO365ConsumerHost"),Uj.EAh,Uj.uYi&&jm));Fi=this.K.resolve("PowerPointWebEditor.Text.FontLogger");this.dNg.push(Fi);Fi.start()}});v.AFrameworkApplication.ata||(u=this.jh.Zt("appforoffice"),this.zNj(),this.jh.fu(u));Ba.EDh&&this.K.resolve("PowerPointWebEditor.ISorterViewActorMain").Zre()}dispose(){for(const u of this.YX)u.dispose();for(const u of this.dNg)try{u&&u.dispose()}catch(P){L.a.J(512360592,306,
10,"Exception disposing a disposable. {0} {1}",P.message,P.stack)}}CNj(){L.a.J(512360591,809,50,"Start to download augloop.hermes.js file and its dependency files");try{const u=Dc.a.create("pptedit.augloop",null,()=>d.e(8).then(d.bind(null,1289)));if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptAugLoopRuntimeIntegrationEnabled){const P=this.K.resolve("Common.ISharedDependencyLoader"),la=v.AFrameworkApplication.lj("augloop-runtime-shim-ie",2);P.BCb(la).continueWith(()=>{Sc.a.oy(u)})}else Sc.a.oy(u)}catch(u){L.a.J(512360590,
306,10,"Failure downloading the augloop js with its depdencies: Message: {0}, Callstack: {1}",u.message,u.stack)}}iOj(){L.a.J(512360588,809,50,"Start to download infrared.hermes.js file");var u=[this.U$.Bvb(v.AFrameworkApplication.lj("ir-plugin-ski.min.js",5))];u=Dc.a.create("pptedit.infrared",u,()=>d.e(14).then(d.bind(null,1295)));Sc.a.oy(u);return u}hOj(u){L.a.J(512360587,809,50,"Start to download ideas.hermes.js file");u=this.U$.m1d(v.AFrameworkApplication.lj("microsoft.ideas.runtime.js",5),[u],
!1);u=Dc.a.create("pptedit.ideas",[u],()=>d.e(15).then(d.bind(null,1296)));Sc.a.oy(u)}PNj(){L.a.J(508958302,809,50,"Start to download fastcards.hermes.js file");const u=Dc.a.create("pptedit.fastcards",null,()=>d.e(11).then(d.bind(null,1298)));Sc.a.oy(u)}XOj(){L.a.J(512360586,809,50,"Start to download smartlookup.hermes.js file");const u=Dc.a.create("pptedit.smartlookup",null,()=>d.e(13).then(d.bind(null,1292)));Sc.a.oy(u)}mPj(){var u=v.AFrameworkApplication.lj("pptVersionHistory.js",5);u=this.U$.Bvb(u);
try{Sc.a.oy(u)}catch(P){L.a.J(512360585,809,10,"ChronosPackage::InitializeVersionHistory - Failed to download VersionHistory script, Exception: {0}",P.toString())}}zNj(){const u=this.K.resolve("PowerPointWebEditor.IApplicationSettings");w.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").Cfe()?ae.Mhe():u.yg?v.AFrameworkApplication.fa.ff(ae.ujg):ac.a.get_instance().Mj(8,()=>{ae.ujg()})}static main(){v.AFrameworkApplication.Yg&&qd.a.gg?L.a.J(512360584,809,15,"Firefox attempts to load chronos2 package when App is disposing"):
m.a.instance.Ac(xc.a(new ae,5))}static Mhe(){w.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").Eja();m.a.instance.Ac(new Jf)}static ujg(){let u=!1;try{window.self.requestIdleCallback(ae.Mhe)}catch(P){u=!0}u&&window.setTimeout(ae.Mhe,0)}}Object(r.a)(ae,"Chronos2Package",null,[2,3]);var lg=d(193),og;(function(u){u[u.unsupported=0]="unsupported";u[u.designer=1]="designer";u[u.blank=2]="blank"})(og||(og={}));Object(r.b)("AgendaSlideThemeType",og);var se=d(115);class Df{constructor(){this.AgendaSlideSid=
this.AgendaSlideCid=0;this.CorrelationId=null}}Object(r.a)(Df,"AgendaApplyInfo",null,[]);class Ci{constructor(){this.DeckSuggestionId=this.CorrelationId=this.AgendaSessionId=null;this.FIsBlankOption=!1}}Object(r.a)(Ci,"AgendaThemeApplyInfo",null,[]);class oj{constructor(u,P){this.A6d=!1;this.uQe=[];this.vRf=u;this.e2i=P}}Object(r.a)(oj,"DeckOptionInformation",null,[]);class Pl{constructor(){this.b1g=this.c1g=0;this.tAg=[]}get cxd(){return this.c1g}set cxd(u){this.c1g=u}get bxd(){return this.b1g}set bxd(u){this.b1g=
u}get k9a(){return this.tAg}set k9a(u){this.tAg=u}dgh(u,P,la){const Ba=new I.a;if(u)for(let Sa=0;Sa<la-1&&Sa<u.length;Sa++)Ba.add(new oj(u[Sa],!1));lb.a.Xa(P)||Ba.add(new oj(P,!0));this.k9a=Ba.toArray()}}Object(r.a)(Pl,"AgendaDeckSessionInformation",null,[]);class Pf{constructor(){this.Qdc=this.Rdc=this.Lxg=0;this.sFe=this.L5c=this.sDe=this.lbd=null}Wil(u){u&&(this.Lxg=u.body.slideIndex)}Gml(u){u.body&&u.body.outlineRequestContent&&(this.lbd=JSON.stringify(u.body.outlineRequestContent))}Sil(u){u.body&&
(this.Qdc=u.body.slideCId)}Vil(u){u.body&&(this.Rdc=u.body.slideSId)}Til(u){this.L5c=u.id}jSj(u){return u===this.L5c?(this.L5c=this.lbd=null,!0):!1}y5j(){return!lb.a.Xa(this.lbd)&&!lb.a.Xa(this.L5c)}uml(u){u.body&&u.body.outlineRequestContent&&u.body.outlineRequestContent.Slides&&(this.sDe=u.body.outlineRequestContent.Slides.length)}Uil(u){this.sFe=u.body.score}}Object(r.a)(Pf,"AgendaDetection",null,[]);var Rm=d(1078);class Zf{constructor(u,P,la,Ba,Sa,pb,Vb,Bc,Yc,gd,Td,Re){this.wva=this.GB=null;this.R5c=
0;this.l0=null;this.QGb="";this.Y7c=!1;this.hma=0;this.U9=new I.a;this.PGg=!1;this.ai=u;this.Sb=P;this.ta=la;this.$b=Ba;this.Ea=Sa;this.Pq=pb;this.De=Bc;this.kb=Yc;this.Fw=gd;this.ogb=Td;this.Jb=Re;this.Fw.HCk(this.Ea)}DJh(){this.Byh();this.tJi();this.Vwb()?(this.l0=new Pl,this.l0.cxd=this.BL(),this.hIl()):1!==this.hma||this.Ea.eRc?2===this.hma&&this.Ea.dRc&&(this.l0=new Pl,this.l0.cxd=this.BL(),this.QIl()):this.PIl()}tJi(){this.wva=ua.a.create().toString();this.Fw.L$k(this.wva);this.Fw.fAk()}g7e(u,
P){if(this.GB){if(!this.GB.Rdc||!this.GB.Qdc){var la=this.Sb.gA(this.GB.Lxg);this.GB.Rdc=la.Db.sid;this.GB.Qdc=la.Db.cid}la=this.Sb.gA(0);this.ai.generateAgendaSuggestion(la.Db.cid,la.Db.sid,this.wva,this.GB.lbd,this.F9i(),u,P)}else P(null)}PIl(){this.g7e(Object(z.a)(this,this.zFk,"onPODSTriggerAgendaConversionSuccessV1"),Object(z.a)(this,this.P$g,"onPODSTriggerAgendaConversionFailureV1"));this.$b.blockContent(this.ta.presentation,"ApplyAgenda",!0)}QIl(){for(let u of this.U9)u&&u.mIl();this.g7e(Object(z.a)(this,
this.AFk,"onPODSTriggerAgendaConversionSuccessV2"),Object(z.a)(this,this.yFk,"onPODSTriggerAgendaConversionFailureV2"))}hIl(){this.g7e(Object(z.a)(this,this.BFk,"onPODSTriggerAgendaConversionSuccessV3"),Object(z.a)(this,this.Q$g,"onPODSTriggerAgendaConversionFailureV3"));this.$b.blockContent(this.ta.presentation,"ApplyAgenda",!0)}pib(u,P){if(P.property===Zb.a.I_a&&this.R5c){u=Object(S.a)(482,P.node);if(u.I_a===Zf.ARh)for(let la of this.U9)la&&la.CAk();else if(u.I_a===Zf.BRh){for(let la of this.U9)la&&
la.D7g();this.Y7c=!0}this.ogb.Om(Object(z.a)(this,this.pib,"onPresentationPropertyChange"));this.R5c=0}}F9i(){const u={};this.Ea.dRc&&2===this.hma&&(u.shouldGenerateThemes="true",u.themeCount="3");this.Vwb()&&(u.shouldNotConvertToGVMLBytes="true",u.shouldInsertBlankSlides="true");return se.c(u)}v9i(u){const P={};P.SlideCount=this.Cj().toString();P.isBlankThemeRequest=(this.l0.k9a[u].e2i&&!this.Vwb()).toString();P.isRequestForDeckDesignerForNonBlankSlides=this.Vwb();return se.c(P)}Vwb(){return this.Ea.eRc&&
(1===this.hma||0===this.hma)}gIl(){this.kb.nh();const u=this.ta.presentation;if(u){const P=this.Pq.je(15);try{P.hc(u),P.fd=tb.a.c0b,u.Wsb=Object.assign(new Df,{CorrelationId:this.wva,AgendaSlideSid:this.GB.Rdc,AgendaSlideCid:this.GB.Qdc})}finally{P&&P.dispose()}this.$b.rw(u,tb.a.c0b);this.$b.xK(u)}else this.Hhd()}EJh(u){this.kb.nh();this.Fw.zmi(this.q$d(u));const P=this.ta.presentation;if(P){const la=this.Pq.je(15);try{la.hc(P),la.fd=tb.a.c0b,P.I_a=Zf.zRh,this.R5c=this.BL(),this.ogb.fk(Object(z.a)(this,
this.pib,"onPresentationPropertyChange")),P.Xsb=Object.assign(new Ci,{DeckSuggestionId:this.q$d(u),AgendaSessionId:this.wva,CorrelationId:ua.a.create().toString()})}finally{la&&la.dispose()}this.$b.rw(P,tb.a.c0b);this.$b.xK(P)}else this.Hhd()}Hhd(){for(let u of this.U9)u&&u.BAk();this.$b.xK(this.ta.presentation)}zFk(){this.gIl();this.Y7c=!0;for(let u of this.U9)u&&u.D7g()}AFk(u){this.l0.bxd=this.BL();const P=this.b7f(),la=new I.a;if(u.Images)for(const Ba of u.Images)la.add("data:image/jpg;base64, "+
Ba);la.add(P);lb.a.Xa(u.BlankSuggestionId)&&(u.BlankSuggestionId=ua.a.create().toString());this.l0.dgh(u.DeckSuggestionId,u.BlankSuggestionId,Zf.laf);for(let Ba of this.U9)Ba&&Ba.EAk(la.toArray());this.j7e(0)}BFk(){this.l0.bxd=this.BL();this.l0.dgh(null,ua.a.create().toString(),Zf.laf);this.j7e(0)}j7e(u){this.Vwb()?this.JJh(u,Object(z.a)(this,this.DFk,"onPODSTriggerAgendaDeckSuggestionSuccessForNonBlankTheme"),Object(z.a)(this,this.Q$g,"onPODSTriggerAgendaConversionFailureV3")):this.JJh(u,Object(z.a)(this,
this.CFk,"onPODSTriggerAgendaDeckSuggestionSuccess"),Object(z.a)(this,this.R$g,"onPODSTriggerAgendaDeckSuggestionFailure"))}JJh(u,P,la){if(this.l0.bxd<this.l0.cxd)this.DJh();else if(this.Fw.GIk(u),this.QGb=this.q$d(u),this.F2i(this.l0.k9a[u])){var Ba=ua.a.create().toString();this.ai.generateAgendaDeckSuggestion(this.GB.Qdc,this.GB.Rdc,Ba,this.wva,this.QGb,this.v9i(u),P,la);L.a.J(512496859,813,50,"AgendaConverterManager::TriggerDifferentThemeWorkflow - CorrelationID: {0}, RequestDeckSuggestionId: {1}",
Ba,this.QGb)}else this.l6g(this.l0.k9a[u].uQe,this.QGb),this.Fw.z7g(u,!0)}CFk(u){if(u.Images&&u.Images.length){var P=new I.a;for(var la of u.Images)P.add("data:image/jpg;base64, "+la);this.l6g(P.toArray(),u.DeckSuggestionId);if(la=({themeIndex:u}=this.$5f(u.DeckSuggestionId)).returnValue)la.uQe=P.toArray(),la.A6d=!0;this.Fw.z7g(u,!1)}else this.R$g(u)}DFk(u){u.Images&&u.Images.length?this.EJh(0):this.Hhd()}l6g(u,P){for(let la of this.U9)la&&P===this.QGb&&la.xAk(u)}R$g(u){try{let P;const la=({themeIndex:P}=
this.$5f(u.DeckSuggestionId)).returnValue;la&&(la.A6d=!1,la.uQe=[]);this.Fw.wAk(P);if(this.QGb!==u.DeckSuggestionId)return!0}catch(P){L.a.J(512496858,813,10,"Exception in OnPODSTriggerAgendaDeckSuggestionFailure: "+P.message)}for(let P of this.U9)P&&P.C7g();return!0}P$g(){this.Hhd();return!0}Q$g(u){return this.P$g(u)}yFk(){const u=this.b7f(),P=new I.a;P.add(u);for(let la of this.U9)la&&(la.DAk(P.toArray()),la.C7g());return!0}b7f(){const u=this.Sb.gA(0);return this.De.VF(u.Db).image.src}MQ(u,P){try{this.GB||
(this.GB=new Pf);let la=!1;P?this.GB.jSj(u.id)&&(this.Vwh(!1,this.hma),la=!0):(this.GB.Wil(u),this.GB.Gml(u),this.GB.Sil(u),this.GB.Vil(u),this.GB.Til(u),this.GB.Uil(u),this.Byh(),this.GB.y5j()&&(this.Vwh(!0,this.hma),this.GB.uml(u)));if(!(0>=this.U9.count))for(let Ba of this.U9)try{Ba&&(la?window.setTimeout(()=>{Ba.k6g()},100):Ba.k6g())}catch(Sa){L.a.J(512496857,813,10,"Exception message: "+Sa.message)}}catch(la){L.a.J(512496856,813,10,"Exception message: "+la.message)}}v2k(u){u&&this.U9.add(u)}ZLl(u){this.U9.remove(u)}Vwh(u,
P){this.PGg=this.Ea.eRc?u:u&&0!==P}q8f(){return this.PGg&&!this.Y7c}oNe(u){this.Y7c=!u}Cj(){return this.ta.presentation.vza+this.GB.sDe}Byh(){this.hma=this.dvj();this.Fw.W$k(og[this.hma]);this.F$k()}F$k(){this.Vwb()?this.Fw.nWe("V3"):1!==this.hma||this.Ea.eRc?2===this.hma&&this.Ea.dRc&&this.Fw.nWe("V2"):this.Fw.nWe("V1")}dvj(){try{const u=this.Sb.XI();if(u&&0<u.length)for(const P of u)if(P){const la=P.ThemeFamilyId;if(this.Ea.dRc&&la.toLowerCase()===Zf.LRh.toLowerCase())return 2;if(0<=Array.indexOf(this.Ea.hki,
la)||Object(Ud.a)("EnableNonEmptyThemeIdFixForAgendaToPPT")&&!this.Jb.ka("DisableAgendaToPPTForUnsupportedTheme")&&void 0===Rm.a.Gza.find(Ba=>Ba.pSc===la))return 1}return 0}catch(u){return L.a.J(512496855,813,10,"AgendaConverterManager::IsThemeSupportedForAgendaV1: Exception message: "+u.message),0}}q$d(u){return this.l0.k9a[u].vRf}$5f(u){let P;P=0;for(const la of this.l0.k9a){if(la.vRf===u)return{returnValue:la,themeIndex:P};P++}L.a.J(512496854,813,10,"AgendaConverterManager::GetDeckOptionInfoWithDeckSuggestionID: cannot find DeckOptionInfo with deckSuggestionId "+
u);return{returnValue:null,themeIndex:P}}F2i(u){return u?!u.A6d:(L.a.J(512496853,813,10,"AgendaConverterManager::FShouldQueryFreshPreview: DeckOptionInfo is null "),!1)}dispose(){this.ogb.Om(Object(z.a)(this,this.pib,"onPresentationPropertyChange"));this.R5c=0}BL(){return(new Date).getTime()}}Zf.laf=4;Zf.LRh="62F939B6-93AF-4DB8-9C6B-D6C7DFDC589F";Zf.BRh=1;Zf.ARh=2;Zf.zRh=0;Object(r.a)(Zf,"AgendaConverterManager",null,[107]);class Ge{constructor(u,P,la){this.Fw=u;this.Ic=P;this.uO=la;this.Gt()}Gt(){this.Ic.kJc(Object(z.a)(this,
this.uoa,"onUndoRedo"))}dispose(){this.Ic.fpd(Object(z.a)(this,this.uoa,"onUndoRedo"))}C9b(u,P){u===tb.a.c0b&&(this.Fw.oNe(P),this.uO.oNe(P))}uoa(u,P){this.C9b(P.y8e,P.Tcb)}}Object(r.a)(Ge,"AgendaConverterUndoRedoController",null,[785]);var Si=d(77);class Fn{constructor(){this.isEntryState=!1;this.pptAppFrameDomElement=null;this.maxTryAgainCount=0}}Object(r.a)(Fn,"IAgendaSettings",null,[]);class ck{constructor(u,P,la,Ba,Sa){this.BGf="HighConfidenceAgendaDetected";this.vz=null;this.xa=new Si.a;this.K5c=
null;this.Zed=0;this.la=la;this.Ur=P;this.Fa=Sa;this.vz||(P=new Fn,P.isEntryState=!0,P.pptAppFrameDomElement=this.Ur.SF(),P.maxTryAgainCount=this.la.DAf,this.vz=agendaConverter.AgendaConverterFactory.CREATE_AGENDA_CONVERTER_ACTOR(P));this.mCl();this.uO=u;this.la&&this.la.cRc&&this.uO.v2k(this);this.Fw=Ba;this.vdb=!1}k6g(){this.uO&&(this.uO.q8f()?(this.Fw.E$k(this.uO.GB.sFe),this.KBh(this.K5c),1===this.uO.GB.sFe&&this.xa.raiseEvent(this.BGf,null)):this.nge())}mIl(){this.vz&&(this.Fw.yAk(),this.vz.showAgendaToPptDialog(this.uO.Cj()),
this.Fa.SZc(Ad.a.CAf,Ad.a.Xi,document.getElementById("AgendaToPptDialogHostElement")),this.Fa.tj(Ad.a.CAf,!0),this.vdb=!0)}D7g(){this.nge();this.Fw.AAk();window.setTimeout(()=>{this.uIl()},8E3)}EAk(u){this.UCh(u);this.Fw.A7g(!0)}DAk(u){this.UCh(u);this.Fw.A7g(!1)}xAk(u){this.Rwl(u)}BAk(){this.Zed>=this.la.DAf?this.vz.showAgendaToPptDismissCard():(this.Zed+=1,this.vz.showAgendaToPptFailureCard());this.Fw.x$g()}C7g(){this.vz&&this.vdb&&this.vz.showSlidePreviewError()}CAk(){this.vz.showMergeSlidesError();
this.Fw.x$g()}KBh(u){this.la.cRc&&(this.qZe(u),this.vz&&this.K5c&&this.uO&&this.uO.q8f()&&(this.vz.showAgendaCard(this.K5c,this.uO.GB.sDe),this.Fw.vAk()))}nge(){L.a.J(538469316,829,100,"AgendaConverterView::HideAgendaEntryCard");this.vz&&!this.vdb&&(this.vz.hideAgendaCard(),this.qZe(null))}UCh(u){this.vz&&this.vdb&&this.vz.populateThemesInAgendaDialog(u)}Rwl(u){this.vz&&this.vdb&&this.vz.populatePreviewSlidesInAgendaDialog(u)}qZe(u){this.K5c=u}uIl(){if(this.la.yQk)try{const u=w.a.instance.Ia("Common.ISystemInitiatedFeedback");
u&&(L.a.J(562422277,813,50,"AgendaConverterView::TriggerFpsForAgendaToPpt Floodgate survey for agenda to presentation triggered"),u.execute(P=>{P.logActivity("AgendaToPresentationActivity","PowerPointAgendaToPptSurveyEnabled")}))}catch(u){L.a.J(562422278,813,10,"Exception thrown while triggering floodgate survey. Exception: {0}",u)}}mCl(){this.vz.on(ck.CRh,()=>{this.cki()});this.vz.on(ck.FRh,()=>{this.fki()});this.vz.on(ck.DRh,()=>{this.dki()});this.vz.on(ck.ERh,()=>{this.eki()});this.vz.on(ck.JRh,
u=>{this.bki(u)});this.vz.on(ck.GRh,u=>{this.BAf(u,!1)});this.vz.on(ck.HRh,()=>{this.gki()});this.vz.on(ck.IRh,u=>{this.BAf(u,!0)})}cki(){this.UEh()}fki(){this.Fw.IIk();this.UEh()}dki(){this.AAf();this.Fw.h8g()}eki(){this.AAf();this.Fw.CCk()}AAf(){this.cleanup();this.uO.ZLl(this)}UEh(){this.uO.DJh()}bki(u){this.uO.j7e(u)}BAf(u,P){this.Fw.zAk(u,P);this.vdb=!1;this.vz.hideAgendaToPptDialog();this.uO.EJh(u)}gki(){this.vdb=!1;this.vz.hideAgendaToPptDialog();this.Fw.h8g()}cleanup(){this.qZe(null);this.Zed=
0;this.vz.cleanup()}Dgi(u){this.xa.addHandler(this.BGf,u)}}ck.CRh="AgendaCardAddSlides";ck.FRh="AgendaCardTryAgain";ck.DRh="AgendaCardCancel";ck.ERh="AgendaCardDismiss";ck.JRh="AgendaToPptDialogThemeSuggestionSelected";ck.GRh="AgendaToPptDialogApply";ck.HRh="AgendaToPptDialogCancel";ck.IRh="AgendaToPptDialogMergeTryAgain";Object(r.a)(ck,"AgendaConverterView",null,[786,808]);var Mo=d(689);class Gm{constructor(){this.Kic={}}Tud(u){this.Kic[u]=new Mo.a(u,!0)}fPb(u){if(u in this.Kic){var P=this.Kic[u];
P.stop();P=P.KQc;delete this.Kic[u];return P}return-1}FNe(u){return u in this.Kic}}Object(r.a)(Gm,"AgendaPerfLogger",null,[]);class Nk{constructor(){this.t1c=this.Olg=this.Qlg=this.Plg=!1}Ock(){this.t1c&&!this.Plg&&(this.Plg=!0,rc.b(Nk.Mti))}pdk(){this.t1c&&!this.Qlg&&(this.Qlg=!0,rc.b(Nk.Nti))}Nbk(){this.t1c&&!this.Olg&&(this.Olg=!0,rc.b(Nk.Lti))}static Nak(u){u&&u.QL&&rc.b(Nk.Kti)}}Nk.Mti="WAC_Exp_AgendaToPPTHighConfidenceSeen";Nk.Nti="WAC_Exp_AgendaToPPTHighConfidenceTried";Nk.Lti="WAC_Exp_AgendaToPPTHighConfidenceKept";
Nk.Kti="WAC_Exp_AgendaToPPTIsCreateNew";Object(r.a)(Nk,"ExperimentationMetrics",null,[]);class cl{constructor(){this.Vve=this.ove=this.qte=this.wva=null;this.mxe=!1;this.OCg=this.Kxg=this.X_g=this.Ea=null;this.MGe="";this.pxe=!1;this.pte=""}reset(){this.X_g={};this.Kxg=new Gm;this.OCg=new Nk;this.MGe="";this.pxe=!1;this.pte="";this.Vve=this.ove=this.qte=this.wva=null;this.mxe=!1}get telemetryData(){return this.X_g}get XRc(){return this.OCg}get l8(){return this.Kxg}get rd(){return this.Ea}set rd(u){this.Ea=
u}get Zvd(){return this.MGe}set Zvd(u){this.MGe=u}get fTa(){return this.pxe}set fTa(u){this.pxe=u}get fQ(){return this.pte}set fQ(u){this.pte=u}get mW(){return this.wva}set mW(u){this.wva=u}get XG(){return this.qte}set XG(u){this.qte=u}get qT(){return this.ove}set qT(u){this.ove=u}get documentOpenType(){return this.Vve}set documentOpenType(u){this.Vve=u}get kac(){return this.mxe}set kac(u){this.mxe=u}}Object(r.a)(cl,"AgendaMetricsState",null,[]);var wf=d(785);class Ug{constructor(u,P){if(!u)throw Error.argumentNull("AgendaThemetype is null");
if(!P)throw Error.argumentNull("AgendaToPptFlowVersion is null");this.Rva=new wf.a;this.Rva.cja(Object.assign(new M.a,{name:"AgendaThemeType",string:u}));this.Rva.cja(Object.assign(new M.a,{name:"AgendaFlowVersion",string:P}))}x6(u){lb.a.Xa(u)||this.Rva.cja(Object.assign(new M.a,{name:"AgendaSessionId",string:u}));return this}Srd(u){this.Rva.cja(Object.assign(new M.a,{name:"AgendaThemeIndexSelected",int64:u}));return this}Ykb(u){lb.a.Xa(u)||this.Rva.cja(Object.assign(new M.a,{name:"AgendaCardState",
string:u}));return this}CLa(u){lb.a.Xa(u)||this.Rva.cja(Object.assign(new M.a,{name:"AgendaDialogState",string:u}));return this}o1a(u){lb.a.Xa(u)||this.Rva.cja(Object.assign(new M.a,{name:"AgendaButtonClickedType",string:u}));return this}Hsd(u){lb.a.Xa(u)||this.Rva.cja(Object.assign(new M.a,{name:"AgendaSeenTriedKept",string:u}));return this}N1(u){lb.a.Xa(u)||this.Rva.cja(Object.assign(new M.a,{name:"DocumentOpenType",string:u}));return this}build(){return this.Rva.dataFields}}Object(r.a)(Ug,"AgendaToPptActivityDataPointBuilder",
null,[]);class ej{constructor(){this.Wc=null;this.pZa=new Mo.a("AgendaToPpt",!1);this.p0e()}p0e(){this.Wc=new cl;this.Wc.reset();this.Wc.telemetryData.Flights="";v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled",!1)&&(this.Wc.telemetryData.Flights+="AugloopAgendaTASClassifierModelIsEnabled;");this.Wc.telemetryData.InitialUserThemeType=this.Wc.fQ}HCk(u){u&&(this.Wc.rd=u,this.Wc.documentOpenType=ej.Tfj(u),Nk.Nak(this.Wc.rd),
this.Wc.telemetryData.IsDocumentOpenTypeCreateNew=this.Wc.rd.QL.toString())}B7g(u,P){if(this.Wc.l8.FNe("AgendaToPptDialogThemeApply")&&"V2"===this.Wc.XG){var la=this.Wc.l8.fPb("AgendaToPptDialogThemeApply");this.Wc.telemetryData.TotalTimeTakenToMerge=la.toString();rc.a(ej.wW,u,la,P)}else this.Wc.l8.FNe("OnAddSlidesClicked")?(la=this.Wc.l8.fPb("OnAddSlidesClicked"),this.Wc.telemetryData.TotalTimeTakenToMerge=la.toString(),rc.a(ej.wW,u,la,P)):this.Wc.l8.FNe("OnTryAgainClicked")&&(la=this.Wc.l8.fPb("OnTryAgainClicked"),
this.Wc.telemetryData.TotalTimeTakenToMerge=la.toString(),rc.a(ej.wW,u,la,P));this.Wc.kac=!1}vAk(){this.Wc.kac=!1;if(!("Seen"in this.Wc.telemetryData)){this.nN("OnAgendaCardShown");this.pZa.start();this.Wc.telemetryData.Seen="true";L.a.J(576746627,813,50,"AgendaCard shown");const u=(new Ug(this.Wc.fQ,this.Wc.XG)).Ykb("AgendaCardShown").Hsd("Seen").N1(this.Wc.documentOpenType).build();rc.a(ej.wW,!0,0,u);this.Wc.XRc.Ock()}}fAk(){this.Wc.kac?this.rdk():this.aak()}aak(){this.nN("OnAddSlidesClicked");
this.pZa.stop();this.Wc.telemetryData.Tried="true";this.Wc.l8.Tud("OnAddSlidesClicked");L.a.J(576746628,813,50,"AgendaCard tried in MS:{0}",this.pZa.KQc);const u=(new Ug(this.Wc.fQ,this.Wc.XG)).x6(this.Wc.mW).Ykb("AgendaCardShown").o1a("AddSlides").Hsd("Tried").N1(this.Wc.documentOpenType).build();rc.a(ej.wW,!0,this.pZa.KQc,u);this.Wc.XRc.pdk()}AAk(){this.nN("OnAgendaToPPTApply");this.Wc.fTa=!0;this.Wc.telemetryData.Kept="true";this.Wc.telemetryData.Event="AgendaCompleted";const u=(new Ug(this.Wc.fQ,
this.Wc.XG)).x6(this.Wc.mW).Ykb("AgendaCompleted").N1(this.Wc.documentOpenType).build();this.B7g(!0,u);L.a.J(572842050,813,50,"AgendaToPPT Completed successfully")}IIk(){this.Wc.kac=!0;this.nN("OnTryAgainClicked");this.Wc.telemetryData.Tried="true";this.Wc.telemetryData.Event="AgendaTryAgain";this.Wc.l8.Tud("OnTryAgainClicked");L.a.J(556561858,813,50,"AgendaCard retry attempt")}rdk(){const u=(new Ug(this.Wc.fQ,this.Wc.XG)).x6(this.Wc.mW).Ykb("AgendaMergeError").o1a("TryAgain").Hsd("Tried").N1(this.Wc.documentOpenType).build();
rc.a(ej.wW,!0,0,u)}yAk(){this.nN("OnAgendaDialogShown");this.Wc.qT="Loading";L.a.J(556602440,813,50,"AgendaDialog shown");const u=(new Ug(this.Wc.fQ,this.Wc.XG)).x6(this.Wc.mW).CLa(this.Wc.qT).N1(this.Wc.documentOpenType).build();rc.a(ej.wW,!0,0,u)}A7g(u){this.nN("OnAgendaThemePaneLoadedSuccess");this.Wc.qT=u?"ThemeSuggestions":"ThemeSuggestionsFailure";u=this.Wc.l8.fPb("OnAddSlidesClicked");this.Wc.telemetryData.ThemePaneLoadingTime=u.toString();const P=(new Ug(this.Wc.fQ,this.Wc.XG)).x6(this.Wc.mW).CLa(this.Wc.qT).N1(this.Wc.documentOpenType).build();
rc.a(ej.wW,!0,u,P)}zmi(u){this.nN("ThemeDeckSuggestionId");this.Wc.telemetryData.SelectedDeckSuggestionId=u}GIk(u){"V2"===this.Wc.XG&&(this.nN("OnTriggerDifferentThemeWorkflow"),this.Wc.qT="ThemeSuggestions",this.Wc.l8.Tud("TriggerDeckLevelDesigner_"+u),u=(new Ug(this.Wc.fQ,this.Wc.XG)).x6(this.Wc.mW).CLa(this.Wc.qT).Srd(u).o1a("ThemeSelected").N1(this.Wc.documentOpenType).build(),rc.a(ej.wW,!0,0,u))}z7g(u,P){this.nN("OnAgendaDeckPreviewLoaded");this.Wc.qT=P?"AgendaDeckPreviewLoadedFromCache":"AgendaDeckPreviewLoaded";
P=this.Wc.l8.fPb("TriggerDeckLevelDesigner_"+u);this.Wc.telemetryData["DeckPreviewLoadTime_"+u]=P.toString();u=(new Ug(this.Wc.fQ,this.Wc.XG)).x6(this.Wc.mW).CLa(this.Wc.qT).Srd(u).N1(this.Wc.documentOpenType).build();rc.a(ej.wW,!0,P,u)}wAk(u){const P=this.Wc.l8.fPb("TriggerDeckLevelDesigner_"+u);this.nN("OnAgendaDeckPreviewError");this.Wc.qT="AgendaDeckPreviewError";let la="";"DeckPreviewFailure"in this.Wc.telemetryData&&(la=this.Wc.telemetryData.DeckPreviewFailure.toString());this.Wc.telemetryData.DeckPreviewFailure=
la+u.toString()+";";u=(new Ug(this.Wc.fQ,this.Wc.XG)).x6(this.Wc.mW).CLa(this.Wc.qT).Srd(u).N1(this.Wc.documentOpenType).build();rc.a(ej.wW,!1,P,u)}zAk(u,P){this.nN("OnAgendaDialogThemeApply");this.Wc.qT=P?"AgendaDeckMergeError":this.Wc.qT;this.Wc.l8.Tud("AgendaToPptDialogThemeApply");u=(new Ug(this.Wc.fQ,this.Wc.XG)).x6(this.Wc.mW).Srd(u).CLa(this.Wc.qT).o1a(P?"TryAgain":"Apply").N1(this.Wc.documentOpenType).build();rc.a(ej.wW,!0,0,u)}h8g(){this.nN("OnCancelClicked");this.Wc.fTa=!0;this.Wc.telemetryData.Kept=
"false";this.Wc.telemetryData.Event="AgendaCancelled";L.a.J(572842051,813,50,"AgendaToPPT clicked Cancel button");const u=(new Ug(this.Wc.fQ,this.Wc.XG)).x6(this.Wc.mW).o1a("Cancel").N1(this.Wc.documentOpenType);"V2"===this.Wc.XG?u.CLa(this.Wc.qT):u.Ykb("AgendaMergeError");rc.a(ej.wW,!0,0,u.build())}CCk(){this.nN("OnDismissClicked");this.Wc.fTa=!0;this.Wc.telemetryData.Kept="false";this.Wc.telemetryData.Event="AgendaDismissed";L.a.J(556607430,813,50,"AgendaToPPT clicked Dismiss button");const u=(new Ug(this.Wc.fQ,
this.Wc.XG)).x6(this.Wc.mW).o1a("Dismiss").N1(this.Wc.documentOpenType);"V2"===this.Wc.XG?u.CLa(this.Wc.qT):u.Ykb("AgendaMergeError");rc.a(ej.wW,!0,0,u.build())}x$g(){this.nN("OnMergingErrorInAgenda");this.Wc.fTa=!0;this.Wc.telemetryData.Kept="false";this.Wc.telemetryData.Event="AgendaError";const u=(new Ug(this.Wc.fQ,this.Wc.XG)).x6(this.Wc.mW).N1(this.Wc.documentOpenType);"V2"===this.Wc.XG?(this.Wc.qT="AgendaMergeError",u.CLa("AgendaMergeError")):u.Ykb("AgendaMergeError");this.B7g(!1,u.build())}oNe(u){let P=
!1;this.nN("OnUndoRedoClicked");let la=(new Ug(this.Wc.fQ,this.Wc.XG)).x6(this.Wc.mW).N1(this.Wc.documentOpenType);if("Kept"in this.Wc.telemetryData){this.Wc.telemetryData.Kept=(!u).toString();const Ba=u?"UndoClicked":"RedoClicked";this.Wc.telemetryData.Event=Ba;la=la.o1a(Ba)}else P=!0,la.o1a("UndoRedoPostAgendaKept");rc.a(ej.wW,!0,0,la.build());L.a.J(576746629,813,50,"AgendaToPPT did UndoRedo: {0} and IsError:{1}",(!u).toString(),P.toString())}L$k(u){this.nN("ReportCorrelationID");this.Wc.telemetryData.CorrelationId=
u;this.Wc.mW=u}W$k(u){this.nN("ReportInitialUserThemeType");this.Wc.telemetryData.InitialUserThemeType=u;this.Wc.fQ=u}nWe(u){this.nN("ReportAgendaToPptFlowVersion");this.Wc.telemetryData.AgendaToPptFlowVersion=u;this.Wc.XG=u}E$k(u){this.nN("ReportAgendaScore");this.Wc.telemetryData.AgendaScore=u.toString();1===u&&this.U$k()}U$k(){this.nN("ReportHighConfidenceAgendaDetected");this.Wc.telemetryData.HighConfidenceAgendaDetected="true";this.Wc.XRc.t1c=!0}dispose(){L.a.J(576746630,813,50,"AgendaToPPTMetrics: {0}",
se.c(this.Wc.telemetryData))}cal(){if(!this.Wc.telemetryData||!vc.a.count(this.Wc.telemetryData))return"";const u=se.c(this.Wc.telemetryData);if(this.Wc.Zvd===u)return"";this.Wc.Zvd=u;if("Kept"in this.Wc.telemetryData){const P=(new Ug(this.Wc.fQ,this.Wc.XG)).x6(this.Wc.mW).Hsd("Kept").N1(this.Wc.documentOpenType).build(),la=Boolean.parse(this.Wc.telemetryData.Kept.toString());rc.a(ej.wW,la,0,P);la&&this.Wc.XRc.Nbk()}this.Wc.fTa&&(this.p0e(),this.Wc.fTa=!1);L.a.J(572663111,813,50,"AgendaToPPTMetrics: {0}; isFinalTelemetryData: {1}",
this.Wc.Zvd,this.Wc.fTa.toString());return u}nN(u){this.Wc.telemetryData||(L.a.J(574665996,813,15,"AgendaMetrics::ValidateTelemetryData null  for method :{0}",u),this.p0e())}static Tfj(u){return u.QL?"NewDocument":u.xWa?"ViewOnlyDocument":"EditDocument"}}ej.wW="AgendaToPptEvents";Object(r.a)(ej,"AgendaMetrics",null,[784]);class Wn{constructor(){this.Ea=this.K=null;this.KWg=!0;this.Jxg="AugLoop_AgendaDetection_AgendaDetectionAnnotation";this.uO=null}get name(){return"PowerPointWebEditor.AgendaConverter"}Yb(u){this.K=
u;this.K.register(784,"PowerPointWebEditor.IAgendaMetrics").ma().oa(()=>new ej);this.K.register(Zf,"PowerPointWebEditor.AgendaConverter.AgendaConverterManager").ma().oa(()=>new Zf(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("Box4.Graph.IGraphInstance").yd(7),this.K.resolve("Common.IAppSettingsManager")));this.K.register(785,"PowerPointWebEditor.IAgendaConverterUndoRedoController").ma().oa(()=>new Ge(this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),
this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager")));this.K.resolve("PowerPointWebEditor.IAgendaConverterUndoRedoController");const P=lg.a(this.K);Ud.a("AgendaToPPT.DisableLocalizedStrings")?P("agendaConverter").then(()=>{this.K.register(786,"PowerPointWebEditor.AgendaConverter.IAgendaConverterView").ma().oa(()=>new ck(this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("PowerPointWebEditor.IFocusManager")));this.K.resolve("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")}).catch(()=>{}):P("powerpoint-agenda-to-ppt-strings").then(()=>{P("agendaConverter").then(()=>{this.K.register(786,"PowerPointWebEditor.AgendaConverter.IAgendaConverterView").ma().oa(()=>new ck(this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager"),
this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("PowerPointWebEditor.IFocusManager")));this.K.resolve("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")}).catch(()=>{})}).catch(()=>{})}init(){this.K.resolve("Common.IAppSettingsManager").ff(Object(z.a)(this,this.u2k,"registerAgendaDetectionEventHandler"))}dispose(){}u2k(){this.Ea=this.K.resolve("PowerPointWebEditor.IApplicationSettings");
this.uO=this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager");const u=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.Ea.lYi&&this.KWg&&2===u.mode&&(this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(P=>{P.VZ(this.Jxg);P.zmh(this.Jxg,Object(z.a)(this.uO,this.uO.MQ,"handleAnnotationEvent"))}),this.KWg=!1)}static main(){m.a.instance.Ac(new Wn)}}Object(r.a)(Wn,"AgendaConverterPackage",null,[2,3]);var Pp=d(694);class jn{constructor(u,
P,la,Ba,Sa,pb,Vb,Bc,Yc,gd,Td){this.Ldc=0;this.ia=u;this.Vb=P;this.la=la;this.Fa=Ba;this.ke=Sa;this.pa=pb;this.Ym=Vb;this.ME=Bc;this.Vu=Yc;this.lo=gd;this.mxa=Td}vb(){this.Dai();this.la.WSk&&this.KZf()&&this.mxa.continueWith(()=>{this.mxa.result.logActivity("HasPresentInTeamsSeen","PresentToTeamsTeachingUIEnabled")})}Dai(){this.ia.ra(tb.a.kjb,ib.a.application,Object(z.a)(this,this.kjb,"presentToTeams"),4);this.ia.ra(tb.a.sQe,ib.a.application,Object(z.a)(this,this.kjb,"presentToTeams"),4);this.ia.ra(tb.a.rQe,
ib.a.application,Object(z.a)(this,this.kjb,"presentToTeams"),4)}Nth(){this.Vu.hide();this.I7d()}I7d(){let u;$h.a.gxd();u=this.YJk();this.showDialog();return u}YJk(){this.lo.Nbc=!0;const u=ua.a.create().toString(),P=this.ke.documentUrl;try{const Ba={};Ba.pptSharingUrl=Pp.b(P);const Sa=encodeURIComponent(cd.c(Ba));let pb=String.format("msteams:/l/present?ver={0}&deeplinkId={1}&pptContext={2}","1",u,Sa);if(!lb.a.Xa(null)){const Vb=Bd.a.wB(null);pb=pb+"&fqdn="+Vb;const Bc=encodeURIComponent(cd.c({joinUrl:null}));
pb=pb+"&meetingContext="+Bc}var la=pb;n.ULS.sendTraceTag(556541766,838,50,"actionId: {0}, deepLinkId: {1}",this.Ldc,u);window.open(la,"_top")}catch(Ba){return n.ULS.sendTraceTag(523084876,838,15,"PresentToTeamsActor: failed with error: {0}",Ba),!1}return!0}showDialog(){const u=new Wa.StandardDialog;u.Ad=4;u.Oe(1,ResourceStrings.l_PresentToTeamsResumeInPowerPoint);u.Oe(2,ResourceStrings.l_PresentToTeamsTryAgainInTeams);u.Tx(ResourceStrings.l_PresentingFileInTeamsTitle,ResourceStrings.l_PresentingFileInTeamsMessage,
0,Object(z.a)(this,this.npc,"protocolLaunchingDialogResultHandler"))}npc(u){1===u||0===u?(n.ULS.sendTraceTag(523084877,838,50,"PresentToTeamsActor - restarting PPT session"),this.N0a()):2===u&&(n.ULS.sendTraceTag(523084878,838,50,"PresentToTeamsActor - retry present to teams"),this.ia.processAction(tb.a.rQe,2))}N0a(){this.ia.Ka(tb.a.refresh,2,{refreshtrigger:"PresentToTeamsActor::RestartApplication"})}KZf(){return!!this.ke.documentUrl}kjb(u,P,la){if(!this.KZf())return n.ULS.sendTraceTag(523084879,
838,10,"PresentToTeamsActor: Document not supported"),8;if(1===la)return 32;this.Ldc=u;if(this.Ym.isPaused)return this.Fa.Bd(),this.I7d()?32:8;this.pa.nh();this.Fa.Bd();if(u===tb.a.rQe||1===this.Vb.mode)return this.I7d()?32:8;this.ME.U3(!0,!0,()=>{this.Nth()},()=>{n.ULS.sendTraceTag(523084880,838,15,"PresentToTeamsActor: ForceSave failed");this.Nth();return!0});this.Vu.show(!1,this.Ldc);return 32}b6(){}a6(){}}Object(r.a)(jn,"PresentToTeamsActor",null,[143]);class nk{constructor(){this.K=null}get name(){return"PowerPointWebEditor.PresentToTeams"}Yb(u){this.K=
u}init(){v.AFrameworkApplication.fa.ff(()=>{(new jn(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IReplicationScheduler"),this.K.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),this.K.resolve("PowerPointWebEditor.ISaveBlockingUI"),
this.K.resolve("PowerPointWebEditor.IApplicationContext"),Qi.a.Lt(w.a.instance.Ia("Common.ISystemInitiatedFeedback")))).vb()})}dispose(){}static main(){m.a.instance.Ac(new nk)}}Object(r.a)(nk,"PPTWebEditorPresentToTeamsPackage",null,[2,3]);var ql=d(747),Mh=d(19);class Gl{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.CorrelationId=null;this.SuggestionSid=this.SuggestionCid=0}}Object(r.a)(Gl,"DesignerSuggestionApplyInfo",null,[]);var mg=d(345),wm=d(536),dk=d(111);class Xn{constructor(){this.gKc=
null}}Object(r.a)(Xn,"IdeasSlideSuggestionWrapper",null,[]);var Gn=d(104);class kn{constructor(){this.trigger=null;this.cid=this.sid=0;this.ML=null;this.timestamp=new Date;this.correlationId=ua.a.create().toString()}}Object(r.a)(kn,"DesignerRequestData",null,[]);var Yn=d(226);class Hm{}Object(r.a)(Hm,"SlideSuggestionData",null,[]);class Cd{}Cd.twk="mivTitle";Cd.swk="mivSubtitle";Cd.tgd="mivContainer";Cd.rwk="mivButtonsContainer";Cd.i4g="mivButton";Cd.qwk="mivButtonImage";Cd.VHb="mivOverlayContainer";
Cd.LIe="mivIcon";Cd.WHb="mivTerm";Cd.k4g="mivFrame";Cd.uwk="mivView";Cd.l4g="mivIdx";Cd.NIe="mivKeepFocusStart";Cd.MIe="mivKeepFocusEnd";Cd.bWf="Editor";Cd.P4d="EditorContainer";Cd.XXi="EditorTitle";Cd.TXi="EditorSubtitleContainer";Cd.dWf="EditorSubtitle";Cd.HXi="EditorBucketContainer";Cd.H9a="EditorPrev";Cd.c5b="EditorPrevDisabled";Cd.vwb="EditorPrevEnabled";Cd.O4d="EditorBucketCurrent";Cd.IXi="EditorBucketTotalCount";Cd.SVf="EditorBucketTotal";Cd.twb="EditorNext";Cd.uwb="EditorNextEnabled";Cd.b5b=
"EditorNextDisabled";Cd.KXi="EditorDescription";Cd.NXi="EditorIgnoreContainer";Cd.a5b="EditorIgnore";Cd.RXi="EditorSeeMoreContainer";Cd.e5b="EditorSeeMoreLabel";Cd.TVf="EditorCardContent";Cd.gWf="EditorSuggestionsContainer";Cd.KSa="EditorSuggestionContainer";Cd.TQc="EditorSuggestionArrow";Cd.UXi="EditorSuggestionCheck";Cd.fWf="EditorSuggestionText";Cd.eWf="EditorSuggestionInstances";Cd.OXi="EditorNoMoreContainer";Cd.VXi="EditorSvgCheck";Cd.YXi="EditorWhiteCheck";Cd.MXi="EditorGreenFill";Cd.LXi="EditorGreenBorder";
Cd.PXi="EditorNoMoreLabel";Object(r.a)(Cd,"IdeasCss",null,[]);class Jh{}Jh.s$b="IdeasPane";Jh.JSa="editorSuggestionIdx";Jh.aH="ClosePane";Jh.iKj="IdeasPaneOpen";Jh.jlc=6;Jh.Ruk=3;Jh.HRf="Architecture Backgrounds Cities Nature People Technology".split(" ");Object(r.a)(Jh,"IdeasPaneConstants",null,[]);var Me=d(386);class ue{constructor(u,P,la,Ba,Sa,pb,Vb){this.vgc=null;this.ta=u;this.oc=P;this.la=la;this.Pb=Ba;this.Lcd=(u=this.la.useWideSuggestionThumbs)?"DesignerSuggestionResultWide":"DesignerSuggestionResult";
this.Mcd=u?"DesignerSuggestionResultSelectedWide":"DesignerSuggestionResultSelected";this.wb=Sa;this.ke=pb;this.UCb=Vb}TMk(u){const P=[];try{if(!u||!u.SlideSuggestions)return L.a.J(510248778,829,50,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - no slide suggestions to parse"),P;for(let la=0;la<u.SlideSuggestions.length;la++){if(!u.SlideSuggestions[la])continue;const Ba=u.SlideSuggestions[la].Base64Img;let Sa=null;try{Sa=Object.assign(new Hm,{suggestionIndex:u.SlideSuggestions[la].Index.toString(),
suggestionCid:u.SlideSuggestions[la].SlideId.Cid.toString(),suggestionSid:u.SlideSuggestions[la].SlideId.Sid.toString(),imageData:Ba.startsWith("data:image")?Ba:"data:image/png;base64,"+Ba,label:String.format(ResourceStrings.l_DesignerSuggestionItem,la+1)})}catch(pb){L.a.J(510248777,829,15,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - error happened on getting slide suggestions by SlideId"),Sa=null}Sa||(Sa=Object.assign(new Hm,{suggestionIndex:u.SlideSuggestions[la].Index.toString(),suggestionSid:u.SlideSuggestions[la].SlideSid.toString(),
imageData:Ba.startsWith("data:image")?Ba:"data:image/png;base64,"+Ba,label:String.format(ResourceStrings.l_DesignerSuggestionItem,la+1)}));Array.add(P,Sa)}}catch(la){L.a.J(510248776,829,10,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - error happened on getting slide suggestions. {0}",la)}return P}vfj(u,P,la){if(!u)throw Error.argumentNull("suggestionsContainer");return u.querySelector("#"+P+" ."+ue.RCa+'[correlationId="'+la+'"]')}$de(){return this.la.pTi?this.la.oTi:this.la.nTi}GZc(u){if(!this.la.designerIncrementalRenderEnabled)return!1;
let P=!0;switch(u){case Me.a.moreIdeas:P=!1;break;case Me.a.newDocument:P=!1}return P}VVe(u){L.a.J(510248775,829,50,"DesignerViewHelper:RenderSuggestions. CorrelationId:{0}, FirstRender:{1}",this.Pb.correlationId,u.n$a);if(u.Zvb&&u.WRc&&u.Xga){var P=this.dme(),la=u.Xga.parentNode.parentNode.id;if(u.C2e&&this.la.wSa&&u.n$a)switch(u.Zvb.DocumentUpsellStatus){case 0:this.Ydi(u.Xga);break;case 1:this.tci(u.Xga);break;case 2:this.cci(u.Xga)}u.n$a&&this.la.cRc&&this.wph(u.Xga);var Ba;if(Ba=u.n$a?this.EKi(u.WRc,
u.Ph,u.Xga,P,u.Ryd):this.vfj(u.Xga,la,u.Ph))try{const pb=this.Pb.xRa,Vb=!oc.a.Xa(pb)&&la===Jh.s$b,Bc=this.Xsi(u.Zvb,Vb,pb);if(u.n$a){this.Pb.o6e=new Date;u.Ryd&&this.KAl(u.a1i);for(var Sa=0;Sa<Ba.childNodes.length;Sa++){let Yc=Ba.childNodes[Sa];u.Ryd&&this.Ptl(Bc,Sa)?ue.lwl(P,Sa,Yc):this.RVe(Vb?pb[Sa].Type:0,u.Xga,Yc,la,u.WRc,Bc[Sa.toString()],Sa,u.C2e,u.Zvb.DocumentUpsellStatus)}this.la.dka&&u.Zvb.HasPaginationInfo&&this.ECh(u.Xga,u.Ph)}else if(u.Ryd){L.a.J(510248774,829,50,"DesignerViewHelper:RenderSuggestions. CorrelationId:{0}, Incremental Render. suggestionDataDict Count:{1}",
this.Pb.correlationId,vc.a.count(Bc));for(Sa of Object.keys(Bc)){const Yc=parseInt(Sa);let gd=u.Xga.querySelector("#"+la+" ["+ue.SCa+'="'+Yc+'"]');Bc[Sa]&&gd&&Sys.UI.DomElement.containsCssClass(gd.firstChild,"IncSuggestionPlaceholder")&&this.RVe(Vb?pb[Yc].Type:0,u.Xga,gd,la,u.WRc,Bc[Sa],Yc,u.C2e,u.Zvb.DocumentUpsellStatus)}}}catch(pb){L.a.J(510248773,829,10,"DesignerViewHelper:RenderSuggestions - exception. CorrelationId:{0}, Error:{1}",this.Pb.correlationId,pb)}}}N9k(u,P,la,Ba){try{if(!(u&&u.SlideSuggestions&&
u.SlideSuggestions.length&&P))return!1;this.$Yc(P);const Sa=P.querySelector("."+ue.RCa);if(!Sa)return!1;const pb=Sa.childNodes.length,Vb=Sa.childNodes.length+u.SlideSuggestions.length,Bc=this.dme(),Yc=P.parentNode.parentNode.id;for(let gd=0;gd<u.SlideSuggestions.length;++gd){const Td=this.OOf(pb+gd,Vb,Bc);this.RVe(0,P,Td,Yc,Vb,u.SlideSuggestions[gd],pb+gd,Ba,u.DocumentUpsellStatus);Sa.appendChild(Td)}u.HasPaginationInfo&&this.ECh(P,la);return!0}catch(Sa){return L.a.J(510248772,829,10,"DesignerViewHelper:RenderMoreIdeas - Exceptionstion {0}",
Sa),!1}}Xsi(u,P,la){const Ba={};if(P)for(const Sa of la)switch(Sa.Type){case 0:P=Sa;la=null;for(const pb of u.SlideSuggestions)if(pb.Index===P.IndexInDesigner){la=pb;break}Ba[Sa.Index.toString()]=la;break;default:Ba[Sa.Index.toString()]=Sa}else for(const Sa of u.SlideSuggestions)Ba[Sa.Index.toString()]=Sa;return Ba}Ptl(u,P){P=P.toString();return!(P in u)||!u[P]}Ydi(u){const P=Rb.a.$d();P.className="DesignerFreeTrialCardContainer";const la=Rb.a.$d();la.className="DesignerFreeTrialCardTitle";la.innerText=
ResourceStrings.l_DesignerUpsellStartFreeTrialTitle;const Ba=Rb.a.$d();Ba.className="DesignerFreeTrialCardContent";Ba.innerText=String.format(ResourceStrings.l_DesignerUpsellStartFreeTrialContent,this.$de());const Sa=Rb.a.$d();Sa.className="DesignerStartFreeTrialButtonsContainer";const pb=Rb.a.$d();pb.className=ue.cub;pb.innerText=ResourceStrings.l_DesignerUpsellStartFreeTrialButtonText;pb.tabIndex=0;pb.setAttribute(Ha.a.er,pb.innerText);pb.setAttribute(Ha.a.hf,Ha.a.Ju);const Vb=Rb.a.$d();Vb.className=
ue.nLc;const Bc=document.createElement("i");Bc.className=ue.tLc;Bc.style.lineHeight="20px";Bc.setAttribute("Unselectable","on");const Yc=Rb.a.$d();Yc.className="DesignerStartTrialGoPremiumButtonText";Yc.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;Yc.setAttribute("Unselectable","on");Vb.setAttribute(Ha.a.er,Yc.innerText);Vb.setAttribute(Ha.a.hf,Ha.a.Ju);Vb.tabIndex=0;Vb.appendChild(Bc);Vb.appendChild(Yc);Sa.appendChild(pb);Sa.appendChild(Vb);P.appendChild(la);P.appendChild(Ba);P.appendChild(Sa);
P.setAttribute(Ha.a.er,String.format("{0}. {1}",la.innerText,Ba.innerText));P.setAttribute(Ha.a.hf,Ha.a.lsa);u.appendChild(P)}ePf(){const u=Rb.a.$d();u.className="DesignerInFreeTrialView";const P=document.createElement("i");P.className=v.AFrameworkApplication.isRtl?"ms-Icon ms-Icon--Diamond DesignerInFreeTrialViewIconRTL":"ms-Icon ms-Icon--Diamond DesignerInFreeTrialViewIcon";const la=Rb.a.$d();la.className=ue.d1b;la.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;la.tabIndex=0;const Ba=Rb.a.$d();
Ba.className=v.AFrameworkApplication.isRtl?"DesignerInFreeTrialViewTextRTL":"DesignerInFreeTrialViewText";Ba.innerText=ResourceStrings.l_DesignerUpsellInFreeTrialText;la.setAttribute(Ha.a.hf,Ha.a.rVd);la.setAttribute(Ha.a.K7a,Ha.a.pja);la.setAttribute(Ha.a.er,la.innerText);u.appendChild(P);u.appendChild(la);u.appendChild(Ba);u.setAttribute(Ha.a.er,la.innerText+" "+Ba.innerText);u.setAttribute(Ha.a.hf,Ha.a.lsa);return u}VHl(){const u=document.getElementsByClassName("DesignerFreeTrialCardContainer");
if(u)for(let P=0;P<u.length;P++){const la=u[P];if(la.parentNode){const Ba=this.ePf();la.parentNode.replaceChild(Ba,la)}}this.CMh()}tci(u){const P=this.ePf();u.appendChild(P)}cci(u){const P=Rb.a.$d();P.className="DesignerFreeTrialCardContainer";const la=Rb.a.$d();la.className="DesignerFreeTrialCardTitle";la.innerText=ResourceStrings.l_DesignerUpsellFreeTrialExhaustedTitle;const Ba=Rb.a.$d();Ba.className="DesignerFreeTrialCardContent";Ba.innerText=ResourceStrings.l_DesignerUpsellFreeTrialExhaustedContent;
const Sa=Rb.a.$d();Sa.className=ue.c1b;const pb=document.createElement("i");pb.className=ue.tLc;pb.style.lineHeight="20px";const Vb=Rb.a.$d();Vb.className="DesignerTrialExhaustedGoPremiumButtonText";Vb.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;Sa.setAttribute(Ha.a.er,Vb.innerText);Sa.setAttribute(Ha.a.hf,Ha.a.Ju);Sa.tabIndex=0;Sa.appendChild(pb);Sa.appendChild(Vb);P.appendChild(la);P.appendChild(Ba);P.appendChild(Sa);P.setAttribute(Ha.a.er,String.format("{0}. {1}",la.innerText,Ba.innerText));
P.setAttribute(Ha.a.hf,Ha.a.lsa);u.appendChild(P)}ECh(u,P){const la=Rb.a.$d();la.className=ue.pXd;la.setAttribute(ue.bub,P);la.tabIndex=0;P=new ld.a;P.ah(16,16);P.xpa("0,0,2048,2048");const Ba=new Pb.a;Ba.QY("M 1536 138 q 115 66 209 160 q 94 93 162 207 q 67 114 104 246 q 37 131 37 273 q 0 141 -36 272 q -37 131 -104 245 q -67 113 -160 207 q -94 93 -207 160 q -114 67 -245 104 q -131 36 -272 36 q -141 0 -272 -36 q -131 -37 -244 -104 q -114 -67 -207 -160 q -94 -94 -161 -207 q -67 -114 -103 -245 q -37 -131 -37 -272 q 0 -145 39 -278 q 38 -134 108 -249 q 69 -116 167 -210 q 97 -94 216 -159 h -530 v -128 h 768 v 768 h -128 v -553 q -113 54 -207 137 q -95 83 -162 188 q -68 104 -105 227 q -38 123 -38 257 q 0 124 32 238 q 32 114 91 214 q 58 99 140 181 q 82 82 182 141 q 99 58 214 90 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -90 q 99 -59 181 -141 q 82 -82 141 -181 q 58 -100 90 -214 q 32 -115 32 -238 q 0 -114 -27 -220 q -28 -106 -78 -200 q -50 -94 -121 -173 q -71 -80 -158 -141 z");
P.appendChild(Ba);P=P.va;P.setAttribute("class","DesignerMoreIdeasButtonIcon");la.appendChild(P);P=Rb.a.$d();P.className="DesignerMoreIdeasButtonLabel";P.innerText=ResourceStrings.l_DesignerSeeMoreIdeas;la.appendChild(P);la.setAttribute(Ha.a.er,P.innerText);la.setAttribute(Ha.a.hf,Ha.a.Ju);u.appendChild(la)}vwl(u){if(u){var P=Rb.a.sB();P.className="DesignerMoreIdeasLoading";P.src=$f.a.JN(Of.a.Foa);u.appendChild(P)}}$Yc(u){if(u){var P=u.querySelector("."+ue.pXd);P&&u.removeChild(P);(P=u.querySelector(".DesignerMoreIdeasLoading"))&&
u.removeChild(P)}}EKi(u,P,la,Ba,Sa){const pb=Rb.a.$d();pb.className=ue.RCa;pb.setAttribute(ue.bub,P);pb.setAttribute(Ha.a.er,ResourceStrings.l_DesignerSuggestions);pb.setAttribute(Ha.a.hf,Ha.a.o0b);Sa&&(this.Pb.q1b=this.Nbj());for(P=0;P<u;++P)pb.appendChild(this.OOf(P,u,Ba));la.appendChild(pb);return pb}OOf(u,P,la){const Ba=Rb.a.$d();Ba.className=la?this.Lcd+"4x3":this.Lcd;Ba.setAttribute(ue.SCa,u);Ba.tabIndex=0;Ba.setAttribute(Ha.a.er,String.format(ResourceStrings.l_DesignerSuggestionItem,u+1));
Ba.setAttribute(Ha.a.hf,Ha.a.$Qa);Ba.setAttribute(Ha.a.tVd,u+1);Ba.setAttribute(Ha.a.uVd,P);return Ba}RVe(u,P,la,Ba,Sa,pb,Vb,Bc,Yc){let gd=null;this.la.designerIncrementalRenderEnabled&&(P&&(gd=P.querySelector("#"+Ba+' [IncSuggestionPlaceholder="'+Vb+'"]')),gd&&Sys.UI.DomElement.addCssClass(gd,"ShimmerPaused"),this.Ibk(Vb,Sa));P=!1;switch(u){case 0:this.Fol(la,pb,Vb);P=(u=Bc&&this.la.wSa)&&1!==Yc;Sa=Ba=Yc=!1;if(pb&&pb.Categories)for(const Td of pb.Categories)2===Td?Yc=Bc&&!u:1===Td?Ba=!0:3===Td?Sa=
!0:4===Td&&this.Jhe(la,"commoncontrolsmartalignandspace.svg",ResourceStrings.l_DesignerFixItSuggestionItem,Vb);(Yc||P)&&this.xpl(la);Ba?this.Jhe(la,"commoncontrolvideocamerawithwhiteborder_24.svg",ResourceStrings.l_DesignerLoopingVideoSuggestionItem,Vb):Sa&&(this.Jhe(la,"commoncontrolanimationsuggestioniconnoborder.svg",ResourceStrings.l_DesignerAnimationSuggestionItem,Vb),la.setAttribute(ue.fXd,ue.fXd),la.setAttribute("title",ResourceStrings.l_DesignerAnimationSuggestionTooltip));this.la.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.Designer.EnableDesignDescriptions",
!1)&&this.Dbi(la,pb);break;case 1:this.L9k(la,pb);break;case 2:this.C9k(la);break;case 3:case 4:this.Y9k(la,pb)}gd&&gd.parentNode.removeChild(gd);pb=Rb.a.$d();pb.className=ue.yLc;P&&(pb.style.visibility=mb.a.visible,la.removeAttribute("tabindex"),la.setAttribute(Ha.a.HI,Ha.a.lB));la.appendChild(pb)}L9k(u,P){if(P){u.className=Cd.tgd;u.setAttribute(Ha.a.er,ResourceStrings.L_MakeItVisualCardTitle);var la=Rb.a.Il();la.className=Cd.twk;la.innerText=ResourceStrings.L_MakeItVisualCardTitle;var Ba=Rb.a.Il();
Ba.className=Cd.swk;Ba.innerText=ResourceStrings.L_MakeItVisualCardSubtitle;var Sa=Rb.a.$d();Sa.className=Cd.rwk;Sa.setAttribute(Ha.a.hf,Ha.a.o0b);var pb=0,Vb=new am.a,Bc=Math.min(Jh.jlc,P.SearchTerms.length);for(let Yc=0;Yc<Bc;Yc++)pb=this.uPf(P.SearchTerms[Yc].Term,Sa,Vb,Yc,pb);for(P=Bc;P<Jh.jlc;P++)for(const Yc of Jh.HRf)if(!Vb.contains(Yc)){pb=this.uPf(Yc,Sa,Vb,P,pb);break}u.appendChild(la);u.appendChild(Ba);u.appendChild(Sa);this.Pb.Lfd=!0}}uPf(u,P,la,Ba,Sa){const pb=Rb.a.$d();pb.className=Cd.i4g;
pb.setAttribute(Ha.a.hf,Ha.a.$Qa);const Vb=Cd.WHb+"."+Ba,Bc=Rb.a.sB();Bc.className=Cd.qwk;Bc.src=({Ozb:Sa}=this.Ukj(u,la,Sa)).returnValue;Bc.setAttribute(Ha.a.e_,Vb);la=Rb.a.$d();la.className=Cd.VHb;la.tabIndex=0;la.setAttribute(Cd.l4g,Ba);la.setAttribute(Ha.a.hf,Ha.a.Ju);Ba=document.createElement("i");Ba.className=Cd.LIe;Ba.innerText="\ue721";Ba.setAttribute(Ha.a.hf,Ha.a.iQ);const Yc=Rb.a.Il();Yc.className=Cd.WHb;Yc.innerText=u;Yc.id=Vb;pb.appendChild(Bc);pb.appendChild(la);la.appendChild(Ba);la.appendChild(Yc);
P.appendChild(pb);return Sa}Ukj(u,P,la){for(const Ba of Jh.HRf)if(Ba.toLowerCase()===u.toLowerCase())return P.add(Ba),{returnValue:this.ke.qk(u+".png"),Ozb:la};return{returnValue:this.ke.qk("stock"+la++ +".png"),Ozb:la}}Eol(u,P){if(u){var la=document.createElement("video");la.className="SuggestedVideoBackgroundContainer";la.setAttribute("Src",P);la.setAttributeNode(document.createAttribute("muted"));Yn.a.J1j()||(la.setAttributeNode(document.createAttribute("autoplay")),la.setAttributeNode(document.createAttribute("loop")),
la.addEventListener("canplay",()=>{la.muted="true";la.play()}));u.appendChild(la)}}Jhe(u,P,la,Ba){if(u){var Sa=Rb.a.sB();Sa.src=this.ke.qk(P);Sa.className="SuggestedMediaIcon";P=Rb.a.Il();P.className="SuggestedMediaContainer";P.appendChild(Sa);u.setAttribute(Ha.a.er,String.format(la,Ba+1));P.setAttribute("aria-hidden",Ha.a.lB);P.setAttribute("Unselectable","on");u.appendChild(P)}}Dbi(u,P){u&&P&&P.DesignDescription&&0!=P.DesignDescription.length&&u.setAttribute(Ha.a.er,P.DesignDescription)}xpl(u){if(u)if(this.la.wSa)Sys.UI.DomElement.addCssClass(u,
mb.a.noc);else{u.setAttribute(ue.qLc,ue.qLc);var P=u.getAttribute(Ha.a.er);P&&u.setAttribute(Ha.a.er,String.format("{0}. {1}",P.toString(),ResourceStrings.l_DesignerPremiumSuggestionItem));Ha.a.bS(u,Ha.a.K7a,Ha.a.pja);P=Rb.a.$d();P.className=ue.wLc;var la=document.createElement("i");la.className=ue.tLc;P.appendChild(la);u.appendChild(P)}}CMh(){const u=document.getElementsByClassName(ue.g1b);if(u)for(let P=0;P<u.length;P++){Sys.UI.DomElement.removeCssClass(u[P].parentNode,mb.a.noc);u[P].parentNode.tabIndex=
0;u[P].parentNode.removeAttribute(Ha.a.HI);const la=bb.a.Nda(u[P].parentNode,ue.yLc);!la||la.getAttribute(ue.uXd)&&la.getAttribute(ue.uXd).toString()===ue.QGf||(la.style.visibility=mb.a.hidden)}}zMl(){if(this.la.wSa){var u=document.getElementsByClassName("DesignerFreeTrialCardContainer");if(u)for(var P=0;P<u.length;P++)u[P].parentNode.removeChild(u[P]);if(u=document.getElementsByClassName("DesignerInFreeTrialView"))for(P=0;P<u.length;P++)u[P].parentNode.removeChild(u[P]);this.CMh()}else if(u=document.getElementsByClassName(ue.wLc))for(P=
0;P<u.length;P++){u[P].style.display="none";const Ba=u[P].parentNode;Ba.removeAttribute(ue.qLc);Ba.removeAttribute(Ha.a.K7a);var la=Ba.getAttribute(Ha.a.er);la&&(la=la.toString(),la=la.replace(ResourceStrings.l_DesignerPremiumSuggestionItem,""),Ba.setAttribute(Ha.a.er,la))}}Fol(u,P,la){if(u&&P)try{let Ba=!1;try{u.setAttribute(ue.h8a,P.SlideId.Sid),u.setAttribute(ue.xLc,P.SlideId.Cid),Ba=!0}catch(pb){L.a.J(510248771,829,15,"DesignerViewHelper:SetSuggestionImgSrc - failed to access suggestionItem.SlideId"),
Ba=!1}Ba||u.setAttribute(ue.h8a,P.SlideSid);const Sa=Rb.a.sB();Sa.className=ue.g1b;Sa.src=P.Base64Img;this.Pb.Xsa.contains(P.Index)||this.Pb.Xsa.add(P.Index);this.la.MPc&&!lb.a.Xa(P.DesignerMediaURL)&&P.Categories&&oc.a.contains(P.Categories,1)&&this.Eol(u,P.DesignerMediaURL);u.appendChild(Sa);L.a.J(510248770,829,50,"DesignerViewHelper:SetSuggestionImgSrc - img at index {0} rendered. CorrelationId: {1}",la,this.Pb.correlationId)}catch(Ba){u.parentNode.removeChild(u),L.a.J(510248769,829,10,"DesignerViewHelper:SetSuggestionImgSrc - img at index {0} failed to render in browser. CorrelationId: {1}, Error: {2}",
la,this.Pb.correlationId,Ba)}}C9k(u){if(oc.a.Xa(this.Pb.LW)||!this.Pb.yGi())u.style.display=mb.a.none;else{u.className=Cd.P4d;var P=Rb.a.Il();P.className=Cd.XXi;P.innerText=ResourceStrings.L_ConsistencyCardTitle;var la=Rb.a.$d();la.className=Cd.TXi;var Ba=Rb.a.Il();Ba.className=Ba.id=Cd.dWf;Ba.innerText=Ba.title=this.Pb.LW[0].critiques[0].explanationLabel;var Sa=Rb.a.$d();Sa.className=Cd.HXi;var pb=Rb.a.Il();pb.innerText="<";pb.tabIndex=0;Sys.UI.DomElement.addCssClass(pb,Cd.H9a);Sys.UI.DomElement.addCssClass(pb,
Cd.c5b);pb.id=Cd.H9a;var Vb=Rb.a.Il();Vb.innerText="1";Vb.id=Cd.O4d;this.Pb.PN=0;var Bc=Rb.a.Il();Bc.innerText="/";var Yc=Rb.a.Il();Yc.className=Cd.IXi;Yc.id=Cd.SVf;Yc.innerText=this.Pb.LW.length.toString();var gd=Rb.a.Il();gd.innerText=">";gd.tabIndex=0;gd.className=gd.id=Cd.twb;0<this.Pb.LW.length-1?Sys.UI.DomElement.addCssClass(gd,Cd.uwb):Sys.UI.DomElement.addCssClass(gd,Cd.b5b);Sa.appendChild(pb);Sa.appendChild(Vb);Sa.appendChild(Bc);Sa.appendChild(Yc);Sa.appendChild(gd);la.appendChild(Ba);la.appendChild(Sa);
Ba=Rb.a.Il();Ba.className=Cd.KXi;Ba.innerText=ResourceStrings.L_ConsistencyCardDescription;Sa=ue.ROf();this.Gfg(Sa,0);pb=Rb.a.$d();pb.className=Cd.NXi;Vb=Rb.a.$d();Vb.className=Cd.a5b;Vb.innerText=ResourceStrings.L_ConsistencyCardIgnore;Vb.title=ResourceStrings.L_ConsistencyCardIgnoreTitle;Vb.tabIndex=0;pb.appendChild(Vb);Vb=Rb.a.$d();Vb.className=Cd.RXi;Bc=Rb.a.Il();Bc.className=Cd.e5b;Bc.innerText=ResourceStrings.L_ConsistencyCardSeeMore;Bc.tabIndex=0;Vb.appendChild(Bc);Bc=Rb.a.$d();Bc.id=Cd.TVf;
Bc.appendChild(la);Bc.appendChild(Ba);Bc.appendChild(Sa);Bc.appendChild(pb);u.appendChild(P);u.appendChild(Bc);u.appendChild(Vb);this.Pb.SQc=!0}}Y9k(u,P){if(P){u.className=ue.aHf;u.setAttribute(Ha.a.er,P.TitleText);u.setAttribute(ue.SCa,P.Index);var la=this.tCl(P.ExecutionActionName);if(la){var Ba=Rb.a.sB();Ba.src=this.ke.qk("pegal.png");Ba.className=la;var Sa=Rb.a.Il();Sa.className="cui-img-container cui-img-24by24";Sa.appendChild(Ba);u.appendChild(Sa)}Ba=Rb.a.Il();Ba.className="DesignerSuggestedActionTitle";
Ba.innerText=P.TitleText;Sa=Rb.a.Il();Sa.className="DesignerSuggestedActionSubtitle";Sa.innerText=P.DescriptionText;P=Rb.a.$d();P.className=la?"DesignerSuggestedActionDescriptionWithIcon":"DesignerSuggestedActionDescription";P.appendChild(Ba);P.appendChild(Sa);u.appendChild(P)}}wph(u){try{if(this.UCb&&this.UCb.instance){const P=Rb.a.$d();P.id="AgendaCardContainer";P.className="AgendaCardContainer";u.appendChild(P);this.UCb.instance.KBh(P)}}catch(P){L.a.J(510248768,829,10,"DesignerViewHelper:RenderAgendaCard failed with Exception. CorrelationId:{0}, Exception:{1}",
this.Pb.correlationId,P)}}sAi(){try{this.UCb&&this.UCb.instance&&this.UCb.instance.nge()}catch(u){L.a.J(510248729,829,10,"DesignerViewHelper:CleanUpAgendaCard failed with Exception. CorrelationId:{0}, Exception:{1}",this.Pb.correlationId,u)}}tCl(u){switch(u){case "PowerPointConvertImageToTable":return"pegal_ImageToTable_24x24x32";default:return null}}Gfg(u,P){P=this.Pb.LW[P].critiques[0].suggestions;const la=Math.min(Jh.Ruk,P.length);for(let Ba=0;Ba<la;Ba++)this.JEj(u,P[Ba].description,P[Ba].numberOfInstances,
Ba)}JEj(u,P,la,Ba){const Sa=Rb.a.$d();Sa.className=Cd.KSa;Sa.tabIndex=0;Sa.setAttribute(Jh.JSa,Ba);const pb=Rb.a.Il();pb.className=Cd.TQc;pb.innerText="\u2192";pb.setAttribute(Jh.JSa,Ba);const Vb=Rb.a.Il();Vb.className=Cd.fWf;Vb.innerText=P;Vb.setAttribute(Jh.JSa,Ba);P=Rb.a.Il();P.className=Cd.eWf;P.innerText=String.format("[{0}]",la);P.setAttribute(Jh.JSa,Ba);Sa.appendChild(pb);Sa.appendChild(Vb);Sa.appendChild(P);u.appendChild(Sa)}KAl(u){this.avd();this.vgc=new O.a(2,1,this.la.designerIncrementalRenderTimeoutInMs,
()=>{this.Hbk(u)},void 0,"IncrementalRenderTimeoutTask");this.wb.Hb(this.vgc)}avd(){this.vgc&&(this.wb.Lg(this.vgc),this.vgc=null)}Hbk(u){this.avd();for(let P=0;P<u;P++)this.Pb.Xsa.contains(P)||this.Pb.FZc.add(P)}Ibk(u,P){if(!this.Pb.wRa.contains(u)&&(this.Pb.wRa.add(u),u=this.Pb.wRa.count,u===P&&(this.Pb.J_b=new Date,this.avd()),!this.Pb.CRb&&u>=this.Pb.q1b)){for(P=0;P<this.Pb.q1b;P++)if(!this.Pb.wRa.contains(P))return;this.Pb.CRb=new Date}}Nbj(){const u=document.getElementById("WACDocumentPanel");
if(u){const P=this.la.useWideSuggestionThumbs,la=this.dme();return Math.floor((u.offsetHeight-87)/(P||la?135:101))}return 1}dme(){const u=this.Ou();return.01>=Math.abs(u.width/u.height-1.33)}aKf(u,P){this.M9e(this.Kxb(u,P),P,!1)}Wvh(u,P){this.M9e(u,P,!0)}CLl(u){if(u&&(u=u.querySelector(".DesignerSuggestionResultSelected, .DesignerSuggestionResultSelected4x3, .DesignerSuggestionResultSelectedWide, .DesignerSuggestionResultSelectedWide4x3"))){var P=-1!==u.className.indexOf("4x3");this.M9e(u,P,!1)}}M9e(u,
P,la){u&&(la?(u.className=P?this.Mcd+"4x3":this.Mcd,Ha.a.bS(u,Ha.a.L7a,Ha.a.lB)):(u.className=P?this.Lcd+"4x3":this.Lcd,Ha.a.bS(u,Ha.a.L7a,Ha.a.pja)))}Ou(){return this.oc.Ou()}Kxb(u,P){return u.querySelector("."+(P?this.Mcd+"4x3":this.Mcd))}get Ba(){return Object(S.a)(118,this.ta.Ba)}vuh(u,P){if(u){if(u=u.querySelector("["+ue.SCa+'="'+P+'"]'))P=cb.a.ki(u),u.contains(cb.a.QTa(new Sys.UI.Point(P.x,P.y)))&&u.contains(cb.a.QTa(new Sys.UI.Point(P.x+P.width-1,P.y)))?u.contains(cb.a.QTa(new Sys.UI.Point(P.x,
P.y+P.height-1)))&&u.contains(cb.a.QTa(new Sys.UI.Point(P.x+P.width-1,P.y+P.height-1)))||u.scrollIntoView(!1):u.scrollIntoView(!Ud.a("Designer.ScrollIntoViewFix"))}else L.a.J(510248728,829,15,"Designer view has been removed from DesignerViewContainer")}static c3d(u){let P=null;try{P=cd.a(u)}catch(la){L.a.J(510248727,829,10,"DesignerViewHelper:TransformSuggestionDataFormat - parsing suggestionResults failed")}return P}static mMk(u){const P=u.CardData;let la=null;try{if(la=cd.a(P),!u.SlideSuggestions&&
la)for(la=Lk.e(la,Ba=>0!==Ba.Type),u=0;u<la.length;u++)la[u].Index=u}catch(Ba){L.a.J(510248726,829,10,"parsing cards failed with exception: {0}",Ba)}return la}static lwl(u,P,la){la.style.backgroundColor="white";const Ba=Rb.a.$d();Ba.className=u?"IncSuggestionPlaceholder placeholder_237x178":"IncSuggestionPlaceholder placeholder_237x137";Ba.setAttribute("IncSuggestionPlaceholder",P);(qd.a.ik||qd.a.gg)&&Sys.UI.DomElement.addCssClass(Ba,"Shimmer");la.appendChild(Ba)}static ROf(){const u=Rb.a.$d();u.className=
u.id=Cd.gWf;return u}}ue.RCa="DesignerSuggestionList";ue.bub="correlationId";ue.SCa="suggestionIndex";ue.h8a="slideId";ue.xLc="slideCid";ue.qLc="isShownAsPremiumContent";ue.fXd="containsAnimation";ue.QGf="Refreshing";ue.uXd="SourceTrigger";ue.g1b="SuggestionImg";ue.tLc="ms-Icon ms-Icon--Diamond";ue.wLc="ShadowedTriangleContainer";ue.yLc="DesignerSuggestionListDisabled";ue.pXd="DesignerMoreIdeasButton";ue.aHf="DesignerSuggestedActionResult";ue.d1b="DesignerInFreeTrialViewGoPremiumText";ue.c1b="DesignerFreeTrialCardGoPremiumButton";
ue.cub="DesignerStartFreeTrialButton";ue.nLc="DesignerStartFreeTrialGoPremiumButton";Object(r.a)(ue,"DesignerViewHelper",null,[773]);class Sm{constructor(){this.cid=this.sid=0;this.iZc=this.ML=this.trigger=null}}Object(r.a)(Sm,"PendingRequest",null,[]);class Hl{constructor(){this.XEe=!1;this.kFb=null}get nrg(){return this.XEe}get sug(){return this.kFb}static get inProgress(){const u=new Hl;u.XEe=!0;u.kFb=new Date;return u}static get ready(){const u=new Hl;u.XEe=!1;u.kFb=null;return u}}Object(r.a)(Hl,
"RequestState",null,[]);var dh=d(344),No=d(441);class Zn{constructor(u,P,la,Ba,Sa,pb,Vb,Bc,Yc,gd,Td,Re,Uf,Ef,Oh,ek,je,Qf,Jg,Ei,wj,Ti,pf,tk,Qk,Bk,Fi,Uj,jm,vl){this.AM=null;this.tJa=this.pEg=0;this.bLg=!1;this.PWa=this.Dve=this.tXa=null;this.GAg=!1;this.nLg=0;this.VCj=(Th,Up,ai)=>{if(1===ai)return 32;try{this.vp&&this.vp.No&&this.vp.No.isVisible?Xb.UISurfaces.Gq().then(Rl=>{Rl.setSelectedTaskPane(Ad.a.s_);return null}).catch(Rl=>{L.a.J(509354911,811,10,"DesignerPane::SelectPane exception: {0}",Rl.toString())}):
this.ia.processAction(tb.a.cxb,2)}catch(Rl){return L.a.J(509354910,811,10,"DesignerPane::OpenOrSelectPane exception: {0}",Rl.toString()),8}return 32};this.Rn=Vb;this.vp=Bc;this.xp=Yc;this.zy=gd;this.Pb=Td;this.ia=u;this.gR=P;this.kb=Sa;this.Fa=pb;this.ta=Re;this.Rf=Uf;this.Ic=Ef;this.la=ek;this.$b=la;this.Eb=Ba;this.ai=je;this.mna=Qf;this.una=Hl.ready;this.n$=Jg;this.Gb=Ei;this.Mc=wj;this.wb=Ti;this.yHb=pf;this.tfc=Bk;this.oc=Fi;this.xM=Uj;this.Fw=jm;this.Ixg=vl;this.oEg=Object(z.a)(this,this.kBj,
"handleFirstRunExperienceEvent");Qk&&Qk.isFeatureEnabled("PowerPointEnterpriseDesigner",!1).then(Th=>{this.bLg=Th;return null});this.ia.Kaa(this)}vb(){this.la.L0c&&(this.ia.ra(tb.a.mCh,ib.a.application,Object(z.a)(this,this.lCh,"showHideIdeas"),4),this.ia.ra(tb.a.V1e,ib.a.application,Object(z.a)(this,this.lCh,"showHideIdeas"),4),Ud.a("Designer.QueryNewPane")&&this.ia.ra(tb.a.bqc,ib.a.application,Object(z.a)(this,this.tWk,"queryShowHideDesignerPane"),96),(this.la.iA||this.la.ZF)&&this.ia.ra(tb.a.Rch,
ib.a.application,this.VCj,4),this.ia.ra(tb.a.cxb,ib.a.application,Object(z.a)(this,this.U1e,"showHideDesigner"),4),this.ia.ra(tb.a.n8,ib.a.application,Object(z.a)(this,this.n8,"applyDesignerSuggestion"),4),this.ia.ra(tb.a.jtb,ib.a.application,Object(z.a)(this,this.n8,"applyDesignerSuggestion"),4),this.ia.ya(tb.a.b_a,ib.a.application,Object(z.a)(this,this.$Za,"navigateDesignerSuggestion")),this.ia.ya(tb.a.lIb,ib.a.application,Object(z.a)(this,this.$Za,"navigateDesignerSuggestion")),this.ia.ya(tb.a.mIb,
ib.a.application,Object(z.a)(this,this.$Za,"navigateDesignerSuggestion")),this.ia.ya(tb.a.a_a,ib.a.application,Object(z.a)(this,this.$Za,"navigateDesignerSuggestion")),this.ia.ya(tb.a.iIb,ib.a.application,Object(z.a)(this,this.$Za,"navigateDesignerSuggestion")),this.ia.ya(tb.a.jIb,ib.a.application,Object(z.a)(this,this.$Za,"navigateDesignerSuggestion")),this.ia.ya(tb.a.kIb,ib.a.application,Object(z.a)(this,this.$Za,"navigateDesignerSuggestion")),this.ia.ya(tb.a.Qhb,ib.a.application,Object(z.a)(this,
this.$Za,"navigateDesignerSuggestion")),this.ia.ra(tb.a.$oa,ib.a.application,Object(z.a)(this,this.$oa,"reportSuggestionSessionInfo"),64),this.ia.ya(tb.a.SSf,ib.a.application,Object(z.a)(this,this.zIl,"triggerOnUndoRedo")),this.ia.ya(tb.a.Iie,ib.a.application,Object(z.a)(this,this.$eg,"handleImageUploadForDesigner")),this.ia.ya(tb.a.o_c,ib.a.application,Object(z.a)(this,this.$eg,"handleImageUploadForDesigner")),this.mna.x7a(Object(z.a)(this,this.l1,"onSlidePresenceChanged")),this.Rf.FI(Object(z.a)(this,
this.kTi,"designerTargetSlideChangedHandler")),this.la.designerIncrementalRenderEnabled&&this.Ic.Zgi(Object(z.a)(this,this.HGk,"onRenderSuggestions")),this.la.dka&&this.Ic.lfi(Object(z.a)(this,this.dFk,"onMoreIdesClicked")),this.la.KSf&&this.Ic.w7a(Object(z.a)(this,this.iga,"onRibbonTabSwitched")),this.la.gD&&this.Rf.y7a(Object(z.a)(this,this.iTi,"designerSlidesSelectionChangedHandler")),this.la.designerSendAppliedSuggestionHistoryEnabled&&this.n$.B_b(Object(z.a)(this,this.cga,"onBlockingStateChanged")),
this.Rf.Tyf(Object(z.a)(this,this.Eid,"onForceOutboundGraphTransactionDisposed")),this.yHb.A_b(Object(z.a)(this,this.kib,"onMarkedUndo")),this.la.i3d&&this.Mc.CCa(Object(z.a)(this,this.tib,"onSessionEnding")),this.Mc.HC(Object(z.a)(this,this.Mo,"onSessionRehydrated")),this.tfc&&this.tfc.execute(u=>{u.izf(Object(z.a)(this,this.KLe,"onEditorCritiques"))}),this.Ixg&&this.Ixg.execute(u=>{u.Dgi(Object(z.a)(this,this.WDk,"onHighConfidenceAgendaDetected"))}),this.la.cTi?(this.pEg=window.setTimeout(Object(z.a)(this,
this.l8e,"tryTriggerNewDocDesignerRequest"),this.la.bTi),window.addEventListener("FREDecisionEvent",this.oEg,!0)):this.l8e(),!lb.a.Xa(this.la.MPe)&&this.lTi(this.la.MPe)&&(this.mAj(),this.vIl(this.la.MPe)))}kBj(u){window.removeEventListener("FREDecisionEvent",this.oEg,!0);window.clearTimeout(this.pEg);(u=u.detail)&&u.show&&u.show||this.l8e()}pe(){const u=this.Fa.Fc(Ad.a.s_);u.bindAction(xb.KeyInputManager.Qa(oa.a.n2,0),tb.a.b_a);u.bindAction(xb.KeyInputManager.Qa(oa.a.rC,0),tb.a.b_a);u.bindAction(xb.KeyInputManager.Qa(oa.a.pF,
0),tb.a.lIb);u.bindAction(xb.KeyInputManager.Qa(oa.a.$q,4),tb.a.mIb);u.bindAction(xb.KeyInputManager.Qa(oa.a.m2,0),tb.a.a_a);u.bindAction(xb.KeyInputManager.Qa(oa.a.qC,0),tb.a.a_a);u.bindAction(xb.KeyInputManager.Qa(oa.a.jx,0),tb.a.iIb);u.bindAction(xb.KeyInputManager.Qa(oa.a.$q,0),tb.a.jIb);u.bindAction(xb.KeyInputManager.Qa(oa.a.qS,0),tb.a.kIb);u.bindAction(xb.KeyInputManager.Qa(oa.a.BP,0),tb.a.Qhb)}U1e(u,P,la,Ba,Sa){return this.qK(this.vp,Ad.a.s_,la,u,Sa)}lCh(u,P,la,Ba,Sa){return Sa||!this.Rn.isVisible?
this.qK(this.vp,Ad.a.pbb,la,u,Sa):0}qK(u,P,la,Ba,Sa){var pb=this.ta.presentation;pb=!!this.ta.Ba&&!!pb&&!this.$b.$c(pb);if(this.la.gD){const Vb=this.kb.Se();pb=!!Vb&&1===Vb.length&&pb}if(!pb)return 16;if(!this.zy.isEnabled())return 8;if(1===la)return 32;Sa||this.Fa.tj(P,u.No.isVisible);Ba===tb.a.cxb?this.Pb.correlationId&&!this.Pb.UBb(this.Pb.correlationId)||this.Zda(Me.a.oQb):u.No.isVisible?u.No.Xp(!1,dh.a.sPb):(this.Zda(Ba===tb.a.V1e?Me.a.oQb:Me.a.jwc),u.No.Xp(!0,dh.a.none));return 32}tWk(u,P,la,
Ba,Sa){if(!Object(Mh.a)(dk.a,Sa)||!this.vp||!this.vp.No)return 8;Sa.Hf(this.vp.No.isVisible);return 32}n8(u,P,la,Ba,Sa){P=this.ta.presentation;if(!this.ta.Ba||!P||this.$b.$c(P))return 16;Ba=null;let pb=!0;Object(Mh.a)(Gl,Sa)?Ba=Sa:Object(Mh.a)(Xn,Sa)&&(Ba=Sa.gKc,pb=!1);if(!this.zy.isEnabled()||!Ba)return 8;if(this.zy.mLk())return L.a.J(512496589,829,50,"DesignerActor::ApplyDesignerSuggestion - skipped when client refresh. CorrelationId: {0}, ActionId: {1}",Ba.CorrelationId,u),8;if(1===la)return 32;
if(!this.kb.Fs()){if(1===this.kb.Xd().length&&this.kb.Xd()[0].Lv)return this.kb.nh(),L.a.J(512496588,829,15,"DesignerActor::ApplyDesignerSuggestion - skipped when there are picture in crop mode. CorrelationId: {0}, ActionId: {1}",Ba.CorrelationId,u),8;this.kb.nh()}if(!this.la.dka&&this.Pb.c_.sid===Ba.SuggestionSid)return L.a.J(512496587,829,50,"DesignerActor::ApplyDesignerSuggestion - suggestion already applied, skipping. CorrelationId: {0}, SuggestionSid: {1}",Ba.CorrelationId,Ba.SuggestionSid),
2;la=this.Eb.je(15);try{this.la.designerSendAppliedSuggestionHistoryEnabled&&(this.Pb.XQa=new Date),la.hc(P),la.fd=u,P.PDa=Ba,this.Pb.c_=T.a.Uy(Ba.SuggestionSid,Ba.SuggestionCid),this.Pb.eU=!0,L.a.J(512496586,829,50,"DesignerActor::ApplyDesignerSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",Ba.CorrelationId,u,Ba.SuggestionSid)}finally{la&&la.dispose()}this.la.designerBlockApplyUntilDraw?this.$b.tsa(P,this.ta.Ba,this.Gb.Na,u):this.$b.rw(P,u);this.Rn.isVisible&&this.Fa.vf(Ad.a.pbb);
pb&&this.Pb.hIe();return 32}$Za(u,P,la){P=this.ta.presentation;if(!this.ta.Ba||!P||this.$b.$c(P))return 16;if(!this.zy.isEnabled())return 8;if(1===la)return 32;this.zy.OFj(u);return 32}$oa(u,P,la,Ba,Sa){if(this.zy.vp.No.isVisible)return 0;this.Wkb(Sa.e2c,Sa.abl);return 32}Wkb(u,P,la){const Ba=this.Pb.correlationId;if(lb.a.Xa(Ba))L.a.J(512496585,829,50,"DesignerActor::SendTraceRequest - skipped for empty correlation. ResetReason:{0}",P);else if(this.Pb.UBb(Ba))L.a.J(512496584,829,50,"DesignerActor::SendTraceRequest - skipped for closed correlation. CorrelationId:{0}, ResetReason:{1}",
Ba,P);else{var Sa={};Sa.CachedTrigger=this.Pb.xXd;Sa.SuggestionSlideId=this.Pb.c_.sid.toString();Sa.SuggestionSlideCreationId=this.Pb.c_.cid.toString();Sa.AppliedSuggestion=this.Pb.eU;Sa.DisplaySuggestionsTimeoutInMs=this.la.h3d;Sa.SuggestionsTimeout=this.Pb.mWa;Sa.ClientAbort=this.Pb.HAb||this.zy.jLk();Sa.DesignerPaneClosed=u;Sa.ResetReason=P;Sa.HoverPreviewDesignerTriggered=this.Pb.Mog;Sa.DesignerFixPaneOpenHint=this.la.MSf;Sa.DesignerSendTraceRequestOnSessionEnded=this.la.i3d;Sa.UseWin32DesignerIconEnabled=
this.la.k3d;Sa.IsSimplifiedRibbon=this.fcc();Ud.a("DesignerLogRetriggerReason")&&la&&(Sa.RetriggerReason=la);this.la.KSf&&(Sa.DesignerDesignTabTriggerEnabled=!0);this.vp.tta()&&(this.la.wSa?(Sa[ea.a.iPh]=this.xp.$de(),Sa[ea.a.jPh]=!0,this.Pb.J3e&&(Sa.StartUpsellFreeTrial=!0)):Sa[ea.a.eNf]=!0);u=!!P&&0<=P.indexOf(Me.a.moreIdeas);this.la.dka&&(Sa.TermCorrelationId=Zn.Gde(),u||(Sa.TermAction=this.Fuj()));la=cd.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());var pb={};pb.ClientOS=
la.Os;pb.Browser=la.Browser||"";pb.BrowserVersion=la.BrowserVersion||"";pb.BrowserMajorVersion=la.BrowserMajorVersion||"";pb.BrowserMinorVersion=la.BrowserMinorVersion||"";this.Pb.Suc&&this.Pb.Yga&&this.Pb.Yga>this.Pb.Suc&&(pb.SuggestionsE2ETimeMs=+this.Pb.Yga-+this.Pb.Suc);this.la.designerIncrementalRenderEnabled&&(this.xp.avd(),this.O3e(),Sa[ea.a.kjg]=!0,pb.VisibleSuggestionsCount=this.Pb.q1b,0<this.Pb.FZc.count&&(pb.IncrementalRenderTimeoutIndexes=this.Pb.FZc.toArray().join(",")),0<this.Pb.Rfa.count&&
(pb.MissingDesignerCardIndexes=this.Pb.Rfa.toArray().join(",")),0<this.Pb.wRa.count&&(pb.CardIndexes=this.Pb.wRa.toArray().join(",")),0<this.Pb.Xsa.count&&(pb.DesignerCardIndexes=this.Pb.Xsa.toArray().join(",")),this.Pb.qQ&&(this.Pb.xlc&&this.Pb.xlc>this.Pb.qQ&&(pb.MissingDesignerCardsReceivedTime=+this.Pb.xlc-+this.Pb.qQ),this.Pb.J_b&&this.Pb.J_b>this.Pb.qQ&&(pb.AllIncRenderReceivedTime=+this.Pb.J_b-+this.Pb.qQ),this.Pb.CRb&&this.Pb.CRb>this.Pb.qQ&&(pb.VisibleIncRenderReceivedTime=+this.Pb.CRb-+this.Pb.qQ)));
this.sci(pb);try{if(this.Fw.instance){const Vb=this.Fw.instance.cal();lb.a.Xa(Vb)||(Sa.AgendaMetrics=Vb)}}catch(Vb){L.a.J(512496583,813,10,"exception while populating AgendaMetrics",Vb)}Sa.BrowserData=pb;this.Pb.qQ&&this.Pb.Yga&&this.Pb.Yga>this.Pb.qQ&&(Sa.TimeToDisplaySuggestionsInMs=+this.Pb.Yga-+this.Pb.qQ);this.Pb.o6e&&this.Pb.Yvc&&(Sa.TimeSuggestionsRendered=this.Pb.o6e.toUTCString());this.Pb.Yvc&&(Sa.TimeDesignerPaneClosed=this.Pb.Yvc.toUTCString());this.Pb.h0b&&0<this.Pb.h0b.count&&(Sa.AppliedSuggestionHis=
this.Pb.h0b.toArray().join(" "));this.ai.$oa(Ba,se.c(Sa),P===dh.a.Lrd);this.COl(Ba,P);this.Pb.exf(Ba,this.la.dka&&u);L.a.J(512496582,829,50,"DesignerActor::ReportSuggestionSessionInfo - Send session info and add correlationId to closed list. resetReason: {0}; CorrelationId:{1}",P,Ba)}}fcc(){return v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.ob.Qp?!0:!1}sci(u){u.IdeasMivShown=this.Pb.Lfd;u.IdeasMivDrillIn=this.Pb.YHe;u.IdeasEditorShown=this.Pb.SQc;u.IdeasEditorKept=this.Pb.RQc;u.IdeasEditorDrillIn=
this.Pb.UVf;u.AnyCardShown=this.Pb.SQc||this.Pb.Lfd||0<this.Pb.wRa.count;u.AnyCardKept=this.Pb.RQc||this.Pb.eU}COl(u,P){this.zy.HJa(u,P===dh.a.sPb||P===dh.a.qvd||P===dh.a.noSuggestion||P===dh.a.XTf?mg.a.GJa:mg.a.pending)}HGk(u,P){P.YFh.addRange(this.Pb.Xsa);this.mJf(P.YFh,P.bZf,P.slideId,P.trigger,P.correlationId);P.n$a&&(this.PWa||this.Pb.Rfa.count||this.AAl(P.trigger,P.bZf))}dFk(u,P){this.Zda(Me.a.moreIdeas,null,P.h4c)}iga(u,P){!P.Xfa||"PptRibbon.Design"!==P.Xfa&&"Design"!==P.Xfa||2!==P.Pu&&3!==
P.Pu&&4!==P.Pu||this.zy.vp.No.isVisible||32!==this.ia.processAction(tb.a.dud,1)||this.Zda(Me.a.e3d)}AAl(u,P){this.O3e();const la=this.ta.Ba.Db,Ba=this.Pb.correlationId;this.PWa=new O.a(2,1,this.la.retryMissingDesignerCardsCountdownInMs,()=>{this.Pb.UBb(Ba)||this.mJf(this.Pb.Xsa,P,la,u,Ba,P)},void 0,"CheckAndFetchMissingDesignerCardsTask");this.wb.Hb(this.PWa)}mJf(u,P,la,Ba,Sa,pb=-1){if(this.Pb.Xsa.count===P)this.O3e();else if(u&&u.count&&!(0<this.Pb.Rfa.count)){if(-1===pb)for(let Vb of u)Vb>pb&&(pb=
Vb);this.Wyi(u,P,pb)&&this.yJl(la,Ba,Sa)}}Wyi(u,P,la){for(let Ba=0;Ba<P&&(u.contains(Ba)||this.Pb.Rfa.contains(Ba)||this.Pb.Rfa.add(Ba),Ba!==la||this.Pb.Rfa.count);Ba++);return 0<this.Pb.Rfa.count}yJl(u,P,la){const Ba={};Ba.MissingDesignerCardIndexes=this.Pb.Rfa.toArray().join(",");this.PWa=new O.a(0,1,0,()=>{this.ai.Eka(u.cid,u.sid,la,Zn.Gde(),P,null,se.c(Ba),()=>{L.a.J(512496581,829,50,"DesignerActor::TryFetchMissingDesignerCardsAsync - request successfully sent for fetch missing Designer indexes {0} for correlationId: {1}",
Ba.MissingDesignerCardIndexes,la)},Sa=>{L.a.J(512496580,829,15,"DesignerViewHelper:FetchMissingDesignerCardsAsync - request failed for fetch missing Designer indexes {0} with response: {1}. returning true to prevent ACE",Ba.MissingDesignerCardIndexes,Sa.HttpStatusCode);return!0})},void 0,"FetchMissingDesignerCardsTask");this.wb.Hb(this.PWa)}O3e(){this.PWa&&(this.wb.Lg(this.PWa),this.PWa=null)}l1(u,P){(u=this.ta.Ba)&&P.slideId.equals(u.Db)&&(this.zy.Gud(P.HDh,P.Ahh),this.zy.vp.No.isVisible&&!this.zy.isEnabled()&&
(L.a.J(512496579,829,50,"DesignerActor::OnSlidePresenceChanged - More than two users in same slide and close opened designer pane. In the slide user count:{0}, presentation user count:{1}, CorrelationId:{2}",P.HDh,P.Ahh,this.Pb.correlationId),this.Rn.Xp(!1,dh.a.tCi)),this.Rn.isVisible&&(this.zy.isEnabled()||this.zy.HJa(this.Pb.correlationId,mg.a.GJa)))}kTi(u,P){P.Yna?(u=Object.assign(new wm.a,{slideId:P.Yna.Db}),this.ia.Ka(tb.a.i0a,2,u),this.zy.Gud(u.quc,u.zhh),this.Rn.isVisible&&(L.a.J(512496577,
829,50,"DesignerActor::DesignerTargetSlideChangedHandler - Slide changed when Designer pane is opened. CorrelationId:{0}",this.Pb.correlationId),this.zy.isEnabled()&&!P.Yna.gO?this.Zda(Me.a.V2e):P.Yna.gO&&this.la.designerNewSlideEnabled||(this.Rn.Xp(!1,dh.a.slideNavigation),this.zy.HJa(this.Pb.correlationId,mg.a.GJa)))):L.a.J(512496578,829,50,"DesignerActor::DesignerTargetSlideChangedHandler - active slide was null. CorrelationId:{0}",this.Pb.correlationId)}z9b(u){this.la.designerRequestThrottlingEnabled&&
(this.una=Hl.ready,this.AM&&(this.Rn.isVisible?(L.a.J(512496576,829,50,"DesignerActor::OnTaskComplete - sending pending request for triger {0}, sid: {1}",this.AM.trigger,this.AM.sid),u()):this.AM=null))}wib(u,P){this.z9b(P);L.a.J(512496547,829,15,"DesignerActor::OnTaskFailure - request failed with response: {0}. returning true to prevent ACE",u.HttpStatusCode);return!0}iTi(){if(this.zy.vp.No.isVisible){const u=this.kb.Se();u&&1<u.length&&(L.a.J(512496546,829,50,"DesignerActor::DesignerSlidesSelectionChangedHandler - More than one slides are selected, close the opened designer pane."),
this.Rn.isVisible&&this.Rn.Xp(!1,dh.a.ixk))}}cga(u,P){u=this.Pb.XQa;const la=this.la.designerBlockApplyUntilDraw?"UnblockContentWhenDraw":"SessionRehydrated";u&&Object(S.a)(String,P.actionName)===la&&(this.Pb.h0b.add(String.format("{0}:{1}:{2}",this.Pb.c_,+u-+this.Pb.Yga,+new Date-+u)),this.Pb.XQa=null)}tib(u,P){this.zy.vp.No.isVisible&&(L.a.J(512496545,829,50,"DesignerActor::OnSessionEnding. Correlation={0}, Reason={1}",this.Pb.correlationId,No.a[P.GD]),1!==P.GD&&3!==P.GD||this.Wkb(!0,dh.a.Lrd))}Mo(){L.a.J(512496544,
829,50,"DesignerActor::OnSessionRehydrated");const u={};u[ea.a.kSc]=!0;this.Zda(Me.a.refresh,u)}Eid(u,P){P&&this.Tee(P.actionId,P.transaction.py)}kib(u,P){if(P.dBb&&this.zy.Ysg(P.actionId)){u={};if(P.revisionId){const la=$h.a.kua(Gn.a.LY,$h.a.sab(P.revisionId.toString()).toString());la&&1===la.length&&(u[ea.a.dE]=la[0].dE)}this.Tee(P.actionId,u)}}$eg(u,P,la,Ba,Sa){switch(u){case tb.a.Iie:return this.Pb.ruk(Sa),32;case tb.a.o_c:return this.Pb.P6k(Sa),32;default:return 2}}Otk(u,P,la){if(u!==Me.a.insertPicture&&
u!==Me.a.gya&&u!==Me.a.b_c)return null;const Ba=la?la[ea.a.L9b]:!1,Sa=la?la[ea.a.KYc]:!1,pb=la?la[ea.a.M9b]:!1,Vb=la?la[ea.a.JYc]:!1;let Bc=null;switch(P){case tb.a.eya:case tb.a.Zkd:Bc=Ba?ea.a.GNk:Sa?ea.a.FNk:pb?ea.a.HNk:Vb?ea.a.ENk:null;break;case tb.a.ald:Bc=Ba?ea.a.KNk:Sa?ea.a.JNk:pb?ea.a.LNk:Vb?ea.a.INk:null;break;case tb.a.BIc:Bc=ea.a.copilot;break;case tb.a.HSc:Bc=ea.a.A2f;break;case tb.a.insertOnlinePicture:case tb.a.Gua:case tb.a.Jbb:Bc=ea.a.online;break;case tb.a.ukg:Bc=ea.a.icon}Bc||L.a.J(512496543,
829,50,"DesignerActor::MapActionIdToElementSource - Unexpected NULL ElementSource. Trigger: {0}, ActionId: {1}, CorrelationId: {2}",u,P,this.Pb.correlationId);delete la[ea.a.L9b];delete la[ea.a.KYc];delete la[ea.a.M9b];delete la[ea.a.JYc];return Bc}Ptk(u,P){switch(u){case tb.a.HSc:case tb.a.insertOnlinePicture:case tb.a.Gua:case tb.a.Znc:case tb.a.ukg:case tb.a.BIc:case tb.a.Jbb:return Me.a.insertPicture;case tb.a.ald:case tb.a.eya:case tb.a.Zkd:case tb.a.Tld:return P&&P[ea.a.L9b]||P&&P[ea.a.KYc]&&
this.la.lIl?Me.a.insertPicture:P&&P[ea.a.M9b]?Me.a.gya:P&&P[ea.a.JYc]&&this.la.IJh?Me.a.b_c:this.la.dAa?Me.a.lKa:"";case tb.a.uv:case tb.a.WCa:case tb.a.qtb:return Me.a.qtb;case tb.a.Dja:return Me.a.Q2e;case tb.a.$sc:case tb.a.atc:case tb.a.Osd:case tb.a.Psd:case tb.a.ctc:return P&&ea.a.tzb in P&&P[ea.a.tzb]?Me.a.qYd:Me.a.refresh;case tb.a.AKf:case tb.a.z8a:return P&&ea.a.tzb in P&&P[ea.a.tzb]?Me.a.GSf:Me.a.refresh;case tb.a.BJa:case tb.a.qkb:case tb.a.ysc:case df.a.lVa:case tb.a.bringForward:case tb.a.bringToFront:case tb.a.sendToBack:case tb.a.sendBackward:return Me.a.xkb;
case df.a.GVd:case df.a.JVd:case df.a.y0b:case df.a.IVd:case df.a.KVd:case df.a.LVd:case df.a.cRa:case df.a.MVd:case df.a.NVd:case df.a.OVd:case df.a.PVd:case df.a.RVd:case df.a.TVd:case df.a.backspace:case df.a.NCa:case df.a.pL:case df.a.tSa:case df.a.enter:case df.a.XB:case df.a.typing:return Me.a.typing;case tb.a.gya:return Me.a.gya;case tb.a.Wld:return this.la.ka("DesignerUseRefreshTriggerForInsertTable")?Me.a.refresh:Me.a.insertTable;case tb.a.X5:case tb.a.bhd:case tb.a.sIb:case tb.a.tQ:return Me.a.$na;
case tb.a.VQa:return Me.a.KUd;case tb.a.dJf:return Me.a.kYd;case tb.a.Fub:return Me.a.Fub;default:return Me.a.refresh}}zIl(){const u={};u[ea.a.undoRedo]=!0;this.Zda(Me.a.refresh,u);return 32}Tee(u,P){if(!this.VRj(u)){var la=pb=>{const Vb={};Vb[ea.a.timestamp]=pb.timestamp;Vb[ea.a.correlationId]=pb.correlationId;Vb[ea.a.trigger]=pb.trigger;Vb[ea.a.sid]=pb.sid;Vb[ea.a.cid]=pb.cid;Vb[ea.a.ML]=pb.ML;pb=this.Eb.xd(4);try{pb.hc(this.ta.presentation),pb.fd=tb.a.NSf,this.ta.presentation.Yvb=se.c(Vb)}finally{pb&&
pb.dispose()}},Ba=this.Ptk(u,P),Sa=this.Otk(Ba,u,P);P||(P={});Ud.a("DesignerLogRetriggerReason")&&Ba===Me.a.refresh&&(P[ea.a.gXe]=u);if(this.Z0c(Ba)||this.Rn.isVisible)lb.a.Xa(Sa)||(P[ea.a.mka]=Sa),this.zy.Ysg(u)&&this.Rn.isVisible?this.O2d(Ba,this.la.designerTypeRefreshThrottleTimeoutMs,P,la):Ba===Me.a.refresh&&this.Rn.isVisible&&Ud.a("DesignerDelayRefreshTrigger")?this.O2d(Ba,this.la.hTi,P,la):u===tb.a.BIc?(u=this.la.wc("ChatPPTDesignerTriggerDelayMs",100),this.nLg=Date.now(),this.O2d(Ba,u,P,la)):
this.QRc(la,Ba,P)}}O2d(u,P,la,Ba){if(this.tXa){if(this.Dve===Me.a.insertPicture&&u===Me.a.refresh){this.wb.Lg(this.tXa);this.wb.Hb(this.tXa);return}this.OYd()}this.Rn.isVisible&&(this.zy.HJa(this.Pb.correlationId,mg.a.pending),this.xsd(u));const Sa=this.ta.Ba;if(Sa){var pb=Sa.sid,Vb=Sa.cid;this.Dve=u;this.tXa=new O.a(2,1,P,()=>{this.OYd();this.Rn.isVisible&&L.a.J(512496542,829,50,"Potential candidate for {0} request for designer pane",u);this.bul(u,pb,Vb)||this.QRc(Ba,u,la)},void 0,"DesignerDelayTriggerTask");
this.wb.Hb(this.tXa)}}OYd(){this.tXa&&(this.wb.Lg(this.tXa),this.Dve=this.tXa=null)}Zda(u,P=null,la=null){P||(P={});this.QRc(Ba=>{if(this.la.designerRequestThrottlingEnabled){if(this.una.nrg&&+new Date-+this.una.sug<this.la.designerRequestThrottleIntervalMs){this.AM=new Sm;this.AM.sid=Ba.sid;this.AM.cid=Ba.cid;this.AM.trigger=Ba.trigger;this.AM.iZc=Ba.ML;L.a.J(512496541,829,50,"prior request in progress, marking current request as next pending. next trigger: {0}; next sid: {1}",u,Ba.sid);return}this.una=
Hl.inProgress;this.AM=null}const Sa=()=>{this.Zda(this.AM.trigger,this.AM.iZc,la)};this.ai.Eka(Ba.cid,Ba.sid,Ba.correlationId,Zn.Gde(),Ba.trigger,la,se.c(Ba.ML),pb=>{pb&&pb.Status===ea.a.Vqh?this.$pd(()=>{this.Zda(Ba.trigger,Ba.ML,la)}):this.tJa=0;this.tJa||this.z9b(Sa)},pb=>this.wib(pb,Sa))},u,P)}$pd(u){this.tJa<this.la.designerMaxRetryOnWait?this.wb.Hb(new O.a(2,1,1E3,()=>{L.a.J(512496540,829,50,"retry request due to waiting on pending edits. prior correlation: {0}",this.Pb.correlationId);this.una=
Hl.ready;this.tJa++;u()},void 0,"RetryRequestOnWait")):L.a.J(512496539,829,50,"retries for request awaiting prior edits exceeded. skipping request. correlation: {0}",this.Pb.correlationId)}oij(u,P=null){P=P||{};this.la.NPc&&u===Me.a.newDocument&&(P[ea.a.pYi]="true");this.la.jTi&&(P[ea.a.zCl]=this.bLg);this.vp.tta()&&(this.la.wSa?(P[ea.a.iPh]=this.xp.$de(),P[ea.a.jPh]=!0):P[ea.a.eNf]=!0);this.xp.GZc(u)&&(P[ea.a.kjg]=!0);this.zy.tUj()&&(P[ea.a.AZd]=this.zy.AZd());P.NewPaneEnabled=!0;var la=!oc.a.Xa(this.Pb.LW);
(P.RequestForEditorCardsForNewIdeasPane=la)&&(P.NumEditorCritiques=this.gJi());la={};la.SupportsImageToTableSuggestedAction=32===this.ia.processAction(tb.a.EPe,1);P.PPTOEnabledSuggestedActions=se.c(la);this.la.dAa&&u===Me.a.lKa&&(P[ea.a.Lib]=this.la.Lib,P[ea.a.uOe]=this.la.uOe,P[ea.a.tOe]=this.la.tOe);return P}gJi(){let u=0;for(const P of this.Pb.LW)for(const la of P.critiques)u+=la.suggestions.length;return u}VRj(u){if(void 0===u||null===u)return!0;switch(u){case tb.a.n8:case tb.a.jtb:case tb.a.a_a:case tb.a.iIb:case tb.a.jIb:case tb.a.b_a:case tb.a.lIb:case tb.a.mIb:case tb.a.kIb:case tb.a.Qhb:case tb.a.NSf:return!0;
case tb.a.NRc:return this.la.ka("ChatPPTImgShowDesigner")&&Ud.a("DesignerIgnore")&&Date.now()<this.nLg+this.la.wc("ChatPPTImgIgnoreRefreshMs",2E4);case tb.a.BJa:case tb.a.qkb:case tb.a.ysc:case df.a.lVa:case tb.a.bringForward:case tb.a.bringToFront:case tb.a.sendToBack:case tb.a.sendBackward:return!this.Pb.eU;default:return!1}}QNi(u,P=null){const la=this.ta.Ba;return la?Object.assign(new kn,{trigger:u,sid:la.sid,cid:la.cid,ML:this.oij(u,P)}):null}S1j(u){return this.T1j(u)}T1j(u){if(!u||!u.sid||!this.Z0c(u.trigger)&&
!this.Rn.isVisible)return!1;switch(u.trigger){case Me.a.$na:case Me.a.jwc:case Me.a.oQb:case Me.a.insertPicture:case Me.a.qtb:case Me.a.e3d:case Me.a.Y_d:case Me.a.gya:case Me.a.V2e:case Me.a.Q2e:case Me.a.insertTable:return!0;case Me.a.b_c:return this.la.IJh;case Me.a.typing:return this.la.RSf&&this.Rn.isVisible;case Me.a.xkb:return this.la.designerRetriggerEnabled&&this.Pb.eU;case Me.a.qYd:case Me.a.GSf:return this.la.designerDesignElementsRemovedEnabled;case Me.a.lKa:return this.la.dAa;case Me.a.KUd:case Me.a.kYd:case Me.a.Fub:return this.la.triggerDesignerAfterApplyReplaceObject;
case Me.a.refresh:return this.L1j(u.ML);case Me.a.moreIdeas:return this.la.dka;case Me.a.newDocument:return this.la.NPc&&this.la.QL&&!(Ud.a("DesignerInvokeFix")&&this.la.ZF);case Me.a.VTd:return this.la.i7e;default:return L.a.J(512496538,829,15,"invalid trigger: {0}",u.trigger),!1}}L1j(u){return ea.a.kSc in u&&u[ea.a.kSc]||ea.a.undoRedo in u&&u[ea.a.undoRedo]||this.la.fTi&&this.zy.vp.No.isVisible?!0:!1}Z0c(u){switch(u){case Me.a.jwc:case Me.a.oQb:case Me.a.insertPicture:case Me.a.b_c:case Me.a.Q2e:case Me.a.qYd:case Me.a.qtb:case Me.a.gya:case Me.a.newDocument:case Me.a.KUd:case Me.a.e3d:case Me.a.Y_d:return!0;
case Me.a.VTd:return this.la.i7e;case Me.a.lKa:return this.la.dAa;default:return!1}}URj(u){if(!(this.la.designerSendActionDuration&&ea.a.dE in u.ML&&u.ML[ea.a.dE]))return!1;switch(u.trigger){case Me.a.jwc:case Me.a.oQb:case Me.a.V2e:case Me.a.newDocument:return!1;case Me.a.refresh:return!(ea.a.kSc in u.ML)||!(ea.a.undoRedo in u.ML);default:return!0}}xsd(u){const P=u===Me.a.typing||u===Me.a.refresh?4:u===Me.a.moreIdeas?7:1;(this.zy.vp.No.isVisible||this.Z0c(u))&&this.vp.H1a(P)}a6d(u,P,la){var Ba,Sa;
this.OYd();const pb=this.QNi(P,la);if(this.S1j(pb))if(this.Pb.E3j(this.ta.Ba.sid))this.xsd(pb.trigger),this.$pd(()=>{this.QRc(u,P,la)});else{var Vb=null!==(Sa=null===(Ba=pb.ML)||void 0===Ba?void 0:Ba.xWl)&&void 0!==Sa?Sa:null;L.a.J(512496537,829,50,"trigger: {0}; sid: {1}; correlationId: {2} ReTriggerReason: {3}",pb.trigger,pb.sid,pb.correlationId,Vb);this.Pb.correlationId&&!this.Pb.UBb(this.Pb.correlationId)&&(Ud.a("DesignerLogRetriggerReason")?this.Wkb(this.zy.vp.No.isVisible,pb.trigger,Vb):this.Wkb(this.zy.vp.No.isVisible,
pb.trigger));this.Pb.Suc=new Date;this.Pb.correlationId=pb.correlationId;this.Pb.xXd=pb.trigger;this.Pb.qQ=this.URj(pb)?pb.ML[ea.a.dE]:new Date;pb.ML[ea.a.mka]===ea.a.copilot&&(this.Pb.wac=!0);u(pb);this.xsd(pb.trigger);this.zy.HJa(pb.correlationId,mg.a.pending)}else L.a.J(512496536,829,50,"Designer call not currently allowed for trigger {0}",P),this.Rn.Xp(!1,dh.a.XTf)}QRc(u,P,la){if(this.la.designerAuthEnabled&&this.xM){this.xsd(P);var Ba=new Date;this.xM.gI(this.la.pptDesignerImplicitAuthAppName,
this.la.designerResourceUri).then(Sa=>{const pb=+new Date-+Ba;Sa.IsSuccess?(la[ea.a.r3i]=pb,la[ea.a.uil]=Sa.Token):(la[ea.a.t_f]=pb,L.a.J(512496535,829,15,"DesignerActor::ExecuteDesignerRequestProcessingWithAuth Failed to get AAD token with error: "+Sa.ErrorCode+": "+Sa.ErrorMessage));this.a6d(u,P,la)}).catch(Sa=>{L.a.J(512496534,829,10,"DesignerActor::ExecuteDesignerRequestProcessingWithAuth - Token retrival failed:{0}",Sa);la[ea.a.t_f]=+new Date-+Ba;this.a6d(u,P,la)})}else this.a6d(u,P,la)}l8e(){if(this.la.NPc&&
this.la.QL)if(Ud.a("DesignerInvokeFix")&&this.la.ZF)L.a.J(509162323,829,50,"No Triggering NewDocument designer request in Copilot.");else if(this.oc){var u=this.ta.presentation;if(!u)throw Error.argumentNull("Presentation is null");var P=this.oc.XI();if(!P||0>=P.length)L.a.J(512496531,829,15,"Triggering NewDocument designer request failed, Presentation.MainMasters is invalid");else{var la="62f939b6-93af-4db8-9c6b-d6c7dfdc589f"===P[0].ThemeFamilyId.toLowerCase();la&&1!==P.length?L.a.J(512496530,829,
15,"Triggering NewDocument designer request failed, Presentation.MainMasters Length is invalid"):this.la.h7e||la?!u.slides||0>=u.slides.length?L.a.J(512496528,829,15,"Triggering NewDocument designer request failed, Presentation.slideNodes invalid"):la&&1!==u.slides.length?L.a.J(512496527,829,15,"Triggering NewDocument designer request failed, Presentation.slideNodes Length for blank theme invalid"):(u=null,this.la.Vhl&&this.la.u2a&&0<this.la.u2a.length&&(u={},u.TemplateId=this.la.u2a),L.a.J(512496526,
829,50,"Triggering NewDocument designer request"),this.Zda(Me.a.newDocument,u)):L.a.J(512496529,829,50,"Not Triggering NewDocument designer request, themeFamilyId is invalid")}}else L.a.J(512496532,829,15,"Triggering NewDocument designer request failed, PresentationReader invalid");else L.a.J(512496533,829,50,"Not Triggering NewDocument designer request, DesignerNewDocTriggerEnabled:{0}, IsCreateNew:{1}",this.la.NPc,this.la.QL)}KLe(u,P){this.Pb.cOl(P.d5b)}bul(u,P,la){const Ba=this.ta.Ba;if(!Ba)return!0;
const Sa=Ba.cid;return Ba.sid!=P||Sa!=la||!this.Rn.isVisible&&!this.Z0c(u)}Fuj(){const u=document.querySelector("."+ue.RCa);return u&&(this.xp.Kxb(u,!1)||this.xp.Kxb(u,!0))?"Kept":"NotKept"}k8f(u){const P=new I.a;if(u&&u.children)for(let la=0;la<u.children.length;la++){const Ba=u.children[la].innerText;Ba&&0<Ba.length&&P.add(u.children[la].innerText)}return P.toArray()}Jnj(u){if(!u)return null;var P=u.sa($e.a.Mib,null);if(P)return P.replace("\r","\n").replace("\n\n","\n").split("\n");if(P=u.sa($e.a.VU,
null))if(P=this.gR.hKa(P))return this.k8f(P);if(P=u.sa($e.a.wOe,null))if(u=this.gR.hKa(P))return this.k8f(u);return null}b6(){}a6(u){if(this.la.dAa&&u.actionId===tb.a.Tld&&32===u.response){var P=this.kb.Xd();if(P&&1===P.length&&P[0].id&&(P=this.Jnj(Object(S.a)(10,u.zd)))&&!(0>=P.length)){var la={};la[ea.a.MNk]=P;this.Tee(u.actionId,la)}}}lTi(u){switch(u){case ea.a.WQh:return this.la.nYi;default:return!1}}mAj(){this.Rn.Xp(!0,dh.a.none);this.Zda(Me.a.Y_d);this.vp.H1a(3)}vIl(u){switch(u){case ea.a.WQh:this.wIl()}}wIl(){if(this.la.CQk)try{const u=
w.a.instance.Ia("Common.ISystemInitiatedFeedback");u&&(L.a.J(512496525,829,50,"Floodgate survey for word to presentation triggered"),u.execute(P=>{P.logActivity("ConvertWordToPresentationActivity","PowerPointDesignerWordToPptSurveyEnabled")}))}catch(u){L.a.J(512496524,829,10,"Exception thrown while triggering floodgate survey. Exception: {0}",u)}}WDk(){this.la.i7e&&(this.Rn.isVisible||this.GAg||(this.Rn.Xp(!0,dh.a.none),this.Zda(Me.a.VTd),this.vp.H1a(3),L.a.J(512496523,829,50,"Auto opening designer pane for high confidence agenda")),
this.GAg=!0)}static Gde(){const u=document.querySelector("."+ue.RCa);return u&&u.getAttribute(ue.bub)?u.getAttribute(ue.bub).toString():null}}Object(r.a)(Zn,"DesignerActor",null,[143]);var vo=d(551),np=d(713);class fj{constructor(u){this.bucketId=u;this.critiques=[]}}Object(r.a)(fj,"BucketedEditorData",null,[]);class qe{constructor(u){this.xXd=this.correlationId=this.lXa=this.Oyg=null;this.HAb=this.mWa=this.eU=!1;this.Yvc=this.o6e=null;this.Mog=!1;this.xRa=this.suggestions=this.CRb=this.J_b=this.qQ=
this.XQa=this.xlc=this.Yga=this.Suc=null;this.PN=0;this.wac=this.J3e=this.YHe=this.Lfd=this.UVf=this.RQc=this.SQc=!1;this.Due=[];this.dGe=[];this.efc=u;this.c_=T.a.empty;this.h0b=new I.a;this.wRa=new I.a;this.Xsa=new I.a;this.FZc=new I.a;this.Rfa=new I.a;this.q1b=1}huk(){this.i1a(0,0)}guk(){this.i1a(1,0)}hIe(){this.i1a(2,4)}i1a(u,P){this.efc&&this.efc.execute(la=>{const Ba=Object.assign(new np.a,{cardId:vo.a.FDh,actionType:u,actionEngagement:P});la.uhd(Ba)})}exf(u,P){this.UBb(u)||(Array.add(this.Due,
u),L.a.J(509112540,829,50,"DesignerContext::AddCurrentSuggestionToClosedList - CorrelationId:{0}, ClosedSuggestionListLength:{1}",u,this.Due.length));this.NWe(!P)}UBb(u){return Array.contains(this.Due,u)}ruk(u){Array.add(this.dGe,u)}P6k(u){Array.remove(this.dGe,u)}E3j(u){return Array.contains(this.dGe,u)}get n_d(){return this.lXa}yGi(){if(this.lXa)return!0;try{const u=w.a.instance.qb("PowerPointWebEditor.Proofing.IConsistencyCheckActor");if(u)return this.lXa=u,!0}catch(u){L.a.J(509112539,829,15,"error resolving consistencyCheckActor. ex: {0}",
u)}return!1}cOl(u){if(u){var P=[],la=new sc.a;for(const Ba of u.critiques){u=Ba.bucketId;let Sa=la.ga(u);Sa||(Sa=new fj(u),la.$(u,Sa),P.push(Sa));Sa.critiques.push(Ba)}this.Oyg=P}}get LW(){return this.Oyg}NWe(u){this.correlationId="";this.c_=T.a.empty;this.xXd="";this.HAb=this.mWa=this.eU=!1;this.Yvc=null;this.Mog=!1;this.XQa=this.xlc=this.Yga=this.Suc=null;this.h0b.clear();this.CRb=this.J_b=this.qQ=null;this.q1b=1;this.wRa.clear();this.Xsa.clear();this.FZc.clear();this.Rfa.clear();this.PN=0;this.wac=
this.J3e=this.SQc=this.RQc=this.Lfd=this.YHe=!1;u&&(this.suggestions=this.xRa=null)}}Object(r.a)(qe,"DesignerContext",null,[776]);class Xi{constructor(){this.CardData=null;this.DocumentUpsellStatus=0;this.HasPaginationInfo=!1;this.SlideSuggestions=null}}Object(r.a)(Xi,"DesignerSuggestions",null,[]);var Zc;(function(u){u[u.init=0]="init";u[u.loading=1]="loading";u[u.noSuggestion=2]="noSuggestion";u[u.showSuggestion=3]="showSuggestion";u[u.refreshing=4]="refreshing";u[u.sameSlideCoauthNoSuggestion=
5]="sameSlideCoauthNoSuggestion";u[u.makeItVisualDrillIn=6]="makeItVisualDrillIn";u[u.loadingMoreIdeas=7]="loadingMoreIdeas";u[u.moreIdeas=8]="moreIdeas";u[u.noSuggestionRibbon=9]="noSuggestionRibbon"})(Zc||(Zc={}));Object(r.b)("DesignerViewState",Zc);class Kj{constructor(){this.suggestions=[]}}Object(r.a)(Kj,"SlideSuggestionNotificationData",null,[]);var gg=d(258),Rq=d(396);class ln{constructor(u,P,la){this.Ypb=this.wC=!1;u&&(this.H4=u,this.H4.isFeatureEnabled("PowerPointDesigner",!1).then(Ba=>{(this.wC=
Ba)?L.a.J(591942685,829,50,"DesignerStateManager:: Designer is enabled"):(this.Ypb=this.H4.isFreemiumUpsellEnabled(),this.isFreemiumUpsellEnabled?la?L.a.J(591942691,829,50,"DesignerStateManager:: Usage based Upsell experience is enabled for deisgner"):L.a.J(591942689,829,50,"DesignerStateManager:: Content based Upsell experience is enabled for deisgner"):L.a.J(591942687,829,50,"DesignerStateManager:: Upsell experience is disbaled"));return null}),this.Sok=this.H4.v0a("PowerPointDesigner",Object(z.a)(this,
this.$wb,"featureStateChangeCallback")),this.lmk=P)}tta(){return!this.isEnabled&&this.isFreemiumUpsellEnabled}dispose(){this.H4&&(this.H4.akb("PowerPointDesigner",this.Sok),this.H4=null)}get isEnabled(){return this.wC}get isFreemiumUpsellEnabled(){return this.Ypb}launchUpsellExperience(u){this.H4&&this.H4.launchUpsellExperience(u)}$wb(u){u&&"PowerPointDesigner"===u.featureName&&(!this.isEnabled&&u.isEnabled&&this.lmk(),this.wC=u.isEnabled)}}Object(r.a)(ln,"DesignerStateManager",null,[]);class rl{constructor(u,
P,la){this.Uqk=u;this.SB=P;this.qqk=la}toString(){return"SuggestionIndex:"+this.Uqk+" SlideId:"+this.SB+" CreationId:"+this.qqk}}Object(r.a)(rl,"LoggableSourceContext",null,[]);var mn=d(1192),Di=d(974),xk=d(550);class hi{constructor(u,P,la,Ba,Sa,pb,Vb,Bc,Yc,gd,Td,Re,Uf,Ef){this.Egc=!1;this.DHe=0;this.al=this.ADb=null;this.xa=new Si.a;this.Vb=u;this.ke=P;this.Rc=la;this.Qr=Ba;this.ia=Sa;this.Pb=pb;this.IB=Vb;this.Mc=Bc;this.Bz=Yc;this.pc=gd;this.Fa=Td;this.la=Re;this.Rv=Uf;this.jG=Jh.s$b;this.xmk=
ResourceStrings.L_Designer;this.vD=Ef;this.nb=document.createElement("div");this.nb.className=Of.a.dTi;this.nb.id=Jh.s$b;this.nb.style.position=Hc.a.oba;this.nb.setAttribute(Ha.a.hf,Ha.a.lsa);this.nb.setAttribute(Ha.a.e_,Of.a.g3d);this.Ab=!1;this.vXa=Rb.a.$d();this.vXa.className="DesignerPaneLayoutRoot";this.nb.appendChild(this.vXa);u=v.AFrameworkApplication.fa.Ha("PPTFabricIconDiamondCssUrl");P=document.createElement("link");P.setAttribute("rel","stylesheet");P.setAttribute("type","text/css");P.setAttribute("href",
u);this.nb.appendChild(P);this.Vb.JQa(Object(z.a)(this,this.tY,"onSetOffline"))}dispose(){this.r3();this.nb.removeChild(this.vXa);this.Vb.dMb(Object(z.a)(this,this.tY,"onSetOffline"));L.a.J(509089863,829,50,"DesignerPane::Dispose")}initialize(){this.al=hi.uDa(this.ke);Sys.UI.DomElement.addCssClass(this.al,"DesignerPaneCloseButton");this.al.setAttribute(Ha.a.hf,Ha.a.Ju);this.vXa.appendChild(this.al);this.Rc.rb(Ca.a.click,this.al,Object(z.a)(this,this.hDa,"closePaneButtonClickHandler"));this.Qr.addHandler(this.al,
Ca.a.Bf,Object(z.a)(this,this.Eua,"inputKeyPressHandler"));this.ADb=Rb.a.$d();this.ADb.id=Of.a.g3d;this.ADb.className=Of.a.g3d;this.ADb.innerText=this.xmk;this.vXa.appendChild(this.ADb);this.IB.q4(this.j7f(),Ad.a.Xi,this.nb,u=>{u===this.Fa.Fc(Ad.a.hN)&&this.al?this.TA(!0):this.RU(!0)},()=>{this.RU(!1)});this.Mc.i8(Object(z.a)(this,this.Sw,"onUnifiedAppStateChanged"));this.Mc.HC(Object(z.a)(this,this.yaa,"onPodSessionRehydrated"));this.Bz.Lsb(Object(z.a)(this,this.yaa,"onPodSessionRehydrated"));L.a.J(509089862,
829,50,"DesignerPane::Initialize")}j7f(){return Ad.a.s_}r3(){this.Rc&&0<this.vXa.childNodes.length&&(this.Rc.Bb(Ca.a.click,this.al,Object(z.a)(this,this.hDa,"closePaneButtonClickHandler")),this.Qr.removeHandler(this.al,Ca.a.Bf,Object(z.a)(this,this.Eua,"inputKeyPressHandler")),this.vXa.removeChild(this.ADb),this.vXa.removeChild(this.al));this.Mc.hkb(Object(z.a)(this,this.Sw,"onUnifiedAppStateChanged"));this.Mc.zga(Object(z.a)(this,this.yaa,"onPodSessionRehydrated"));this.Bz.fkb(Object(z.a)(this,this.yaa,
"onPodSessionRehydrated"));this.Fa.Ee&&this.Fa.Ee.name===Ad.a.s_&&this.Fa.tj(Ad.a.s_,!1)}Sw(u,P){P.$bb&&!this.pc.Pn&&this.isVisible&&(L.a.J(509089861,829,50,"DesignerPane::OnUnifiedAppStateChanged - Switching to read-only mode and Designer pane is opened. CorrelationId:{0}",this.Pb.correlationId),this.Xp(!1,dh.a.sPb))}tY(u){u&&this.isVisible&&this.Xp(!1,dh.a.sPb)}yaa(){L.a.J(509089860,801,50,"Designer Pane is closed because session is rehydrated.");this.Xp(!1,dh.a.Eil)}layout(u,P){const la=P?u.MD(this.width):
u.ND(this.width);this.isVisible&&(P?(Sys.UI.DomElement.addCssClass(this.nb,Of.a.QSf),la.MD(Of.a.f3d)):(Sys.UI.DomElement.addCssClass(this.nb,Of.a.PSf),la.ND(Of.a.f3d)));Rb.a.O1(this.nb,la);return u}Xp(u,P){if(this.Ab!==u){this.Ab=u;var la=this.la.MSf||this.id!==Jh.s$b?ea.a.lLk:Jh.iKj;u?(P={},P[la]=!0,this.Rv.Cvd(se.c(P)),this.initialize(),this.nb.style.display=Hc.a.nba,this.Pb.huk(),L.a.J(509089859,829,50,"DesignerPane::SetIsVisible - Set to visible")):(u={},u[la]=!1,this.Rv.Cvd(se.c(u)),this.r3(),
this.nb.style.display=Hc.a.Pe,this.Zxl(P)||(this.Pb.Yvc=new Date,1===this.DHe&&(this.Pb.HAb=!0),this.ia.Ka(tb.a.$oa,2,new xk.a(!0,P))),this.Pb.guk(),L.a.J(509089858,829,50,"DesignerPane::SetIsVisible - Set to not visible"));this.wsb(this.nb);la=ResourceStrings.L_Designer;this.vD.qK(this,this.Ab,this.id===Jh.s$b?la:ResourceStrings.L_ShowHideDesignerPane,this.j7f());this.Ab&&this.Pb.wac&&Ud.a("DesignerFocusChatPPT")&&this.ia.processAction(tb.a.XCa,2,null)}}wsb(u){v.AFrameworkApplication.isRtl?Sys.UI.DomElement.addCssClass(u,
Of.a.QSf):Sys.UI.DomElement.addCssClass(u,Of.a.PSf)}Zxl(u){return u===dh.a.fLf||this.isVisible&&u===dh.a.sPb}RU(u){u?this.xa.raiseEvent("OnDesignerPaneFocusOn"):this.xa.raiseEvent("OnDesignerPaneFocusBlur")}kzf(u){this.xa.addHandler("OnDesignerPaneFocusOn",u)}Hoh(u){this.xa.removeHandler("OnDesignerPaneFocusOn",u)}lzf(u){this.xa.addHandler("OnDesignerPaneFocusBlur",u)}Ioh(u){this.xa.removeHandler("OnDesignerPaneFocusBlur",u)}Eua(u){!this.isVisible||u.keyCode!==oa.a.Dp&&u.keyCode!==oa.a.zK||this.Xp(!1,
dh.a.typing)}hDa(){this.isVisible&&(L.a.J(509089857,829,50,"DesignerPane::ClosePaneButtonClickHandler - Designer pane close button clicked. CorrelationId:{0}",this.Pb.correlationId),this.Xp(!1,dh.a.sPb));return!0}TA(u){(this.Egc=u)&&this.al.focus()}get Gba(){return this.DHe}set Gba(u){this.DHe=u}llb(u){this.setFocus("#"+this.id+" ."+Cd.i4g+":nth-child("+u+") > ."+Cd.VHb)}tkl(){this.setFocus("#"+Cd.H9a)}skl(){this.setFocus("#"+Cd.twb)}gsd(u){this.setFocus("."+Cd.KSa+"["+Jh.JSa+'="'+u+'"')}qkl(){this.setFocus("."+
Cd.a5b)}rkl(){this.setFocus("."+Cd.e5b)}setFocus(u){(u=document.querySelector(u))&&ud.FocusManager.Zq(u)}get isVisible(){return this.Ab}get CVa(){return this.Egc}get va(){return this.nb}get order(){return 7}get id(){return this.jG}get width(){let u=0;this.isVisible&&(u=Of.a.eTi,u+=Of.a.f3d+od.a.Vya);return u}static uDa(u){return hi.tDa(u,"per","cui-img-16by16","cui-ctl-iconContainer","ClosePaneGlyph_16x16x32",CommonUIStrings.l_DialogClose,null)}static tDa(u,P,la,Ba,Sa,pb,Vb){const Bc=Rb.a.sB();Bc.alt=
pb;Bc.className=ha.getImageClassWithCluster(P,Sa);Bc.src=u.qk(P+".png");Bc.setAttribute("Unselectable","on");u=Rb.a.Il();u.className=la+" cui-img-cont-float";u.appendChild(Bc);la=Rb.a.Il();la.className=Ba;la.setAttribute("Unselectable","on");la.appendChild(u);Ba=Rb.a.kda();Ba.className="cui-ctl DesignerPaneButton";Ba.title=pb;Ba.setAttribute(Ha.a.hf,Ha.a.Ju);Ba.tabIndex=0;Ba.appendChild(la);Vb&&(pb=Rb.a.Il(),pb.className="cui-ctl-mediumlabel",pb.setAttribute("Unselectable","on"),pb.innerText=Vb,Ba.appendChild(pb));
return Ba}}Object(r.a)(hi,"DesignerPane",null,[772,587,107]);class Im{constructor(u,P,la,Ba,Sa,pb){this.Sed=this.wec=this.EFb=this.Io=null;this.AAe=this.Yac=!1;this.mGe=null;this.la=P;this.ia=u;this.mmk=pb;this.Rc=Ba;this.Qr=Sa;this.FCg=xb.KeyInputManager.Qa(oa.a.mNa,0);this.ia.ya(tb.a.hPh,J.a.frame,Object(z.a)(this,this.cCi,"closeCallout"));this.nU=Rb.a.$d();this.nU.className="GoPremiumCalloutContainer";this.Ndb=hi.uDa(la);Sys.UI.DomElement.addCssClass(this.Ndb,"GoPremiumCalloutClose");this.Ndb.setAttribute(Ha.a.hf,
Ha.a.Ju);this.nU.appendChild(this.Ndb);u=document.createElement("i");u.className=ue.tLc;u.setAttribute(Ha.a.hf,Ha.a.iQ);u.setAttribute("Unselectable","on");u.setAttribute(Ha.a.HI,Ha.a.lB);this.nU.appendChild(u);this.pxa=Rb.a.$d();this.pxa.className="GoPremiumTitle";this.nU.appendChild(this.pxa);this.oU=Rb.a.$d();this.oU.className="GoPremiumSubtitle";this.nU.appendChild(this.oU);this.Lma=Rb.a.$d();this.Lma.className="GoPremiumButton";u=Rb.a.Il();u.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;
u.setAttribute("Unselectable","on");u.setAttribute(Ha.a.HI,Ha.a.lB);this.Lma.appendChild(u);this.Lma.tabIndex=0;this.Lma.setAttribute(Ha.a.er,u.innerText);this.Lma.setAttribute(Ha.a.hf,Ha.a.Ju);this.nU.appendChild(this.Lma);this.Gt()}show(u,P,la,Ba,Sa,pb){this.TL&&this.dismiss();this.EFb=Ba;this.wec=P;this.Sed=Sa;this.mGe=pb;this.EFb&&Sys.UI.DomElement.addCssClass(this.EFb,this.Sed);la?(this.pxa.innerText=ResourceStrings.l_DesignerInFreeTrialCalloutTitle,this.oU.innerText=ResourceStrings.l_DesignerInFreeTrialCalloutContent):
(this.pxa.innerText=ResourceStrings.l_DesignerUpsellCalloutTitle,this.oU.innerText=ResourceStrings.l_DesignerUpsellCalloutContent);P.setAttribute(Ha.a.K7a,Ha.a.lB);this.la.CWf?this.Io=new Di.a(u,document.body,v.AFrameworkApplication.Aa.nS,null):(this.Io=mn.a.Y0d(u,document.body,document.body,2,Object(z.a)(this,this.dismiss,"dismiss")),this.Io.p6e=120);this.Io.Hba=310;this.nU.setAttribute(Ha.a.er,String.format("{0}. {1}",this.pxa.innerText,this.oU.innerText));this.nU.setAttribute(Ha.a.hf,Ha.a.lsa);
this.Qr&&this.Qr.addHandler(this.nU,Ca.a.Bf,Object(z.a)(this,this.Eua,"inputKeyPressHandler"));this.Io.content=this.nU;this.Ura();P=new Sys.UI.Bounds(0,0,bb.a.OXc(),bb.a.NXc());this.Io.h_=this.K9d(P,u,240,la);this.Io.Ir=!1;this.Io.Pjd=()=>{this.nU.parentNode&&Sys.UI.DomElement.addCssClass(this.nU.parentNode,"GoPremiumCalloutContentContainer");this.Io.bK&&(Sys.UI.DomElement.addCssClass(this.Io.bK,"GoPremiumCalloutOuter"),this.Io.bK.removeAttribute(Ha.a.hf),this.la.CWf||(this.Io.bK.style.zIndex=String(v.AFrameworkApplication.Aa.usb)));
this.Io.J_e();this.eS(this.Lma);this.Yac=!0};this.Io.show()}Ura(){if(ud.FocusManager.mN()){var u=ud.FocusManager.instance(),P=u.Fc("callout/modal");P.parent=Ad.a.Xi;u.jSd("callout/modal",Ad.a.Xi,this.nU);u.XU("callout/modal",!1);P.bindAction(this.FCg,tb.a.hPh);P=new rf.DOMFocusListing(()=>this.nU);P.Wjb=!0;P.Ro(2);u=u.zja(()=>this.nU,u.Fc("callout/modal"),P);u.Xjb();u.uX=!0;u.QRa=!0}}bkb(){if(ud.FocusManager.mN()&&!v.AFrameworkApplication.Yg){const P=ud.FocusManager.instance();var u=P.Fc("callout/modal");
u&&u.Bp(this.FCg);P.q1("callout/modal");(u=P.EQ("callout/modal"))&&u.Dj.mF(null);P.YLb("callout/modal")}}eS(u){ud.FocusManager.mN()?ud.FocusManager.instance().EQ("callout/modal").Dj.t$a(u):u.focus()}get TL(){return!!this.Io&&this.Io.TL}SFj(){this.TL&&(this.Yac?this.Ndb.focus():this.Lma.focus(),this.Yac=!this.Yac)}hUf(){this.dismiss();return!0}cCi(){this.dismiss();return 32}dismiss(){if(!this.AAe){this.AAe=!0;try{this.bkb(),this.wec&&(this.wec.setAttribute(Ha.a.K7a,Ha.a.pja),ud.FocusManager.Zq(this.wec),
this.wec=null),this.EFb&&(Sys.UI.DomElement.removeCssClass(this.EFb,this.Sed),this.EFb=null),this.mGe=this.Sed=null,this.Yac=!1,this.Io&&(this.Io.dismiss(),this.Io.dispose(),this.Io=null),this.Qr&&this.Qr.removeHandler(this.nU,Ca.a.Bf,Object(z.a)(this,this.Eua,"inputKeyPressHandler"))}finally{this.AAe=!1}}}dispose(){this.dismiss();this.Vpa();this.nU=this.Ndb=this.Lma=null}Eua(u){if(u.keyCode===oa.a.Dp||u.keyCode===oa.a.zK){u.preventDefault();u=document.activeElement;try{u?u.click():L.a.J(590967751,
829,15,"PremiumContentCallout::InputKeyPressHandler active element is null.")}catch(P){L.a.J(590967749,829,15,"PremiumContentCallout::InputKeyPressHandler Exception: {0}",P)}}}L9g(){this.mmk(this.mGe);return!0}Gt(){this.Rc?(this.Rc.rb(Ca.a.click,this.Ndb,Object(z.a)(this,this.hUf,"dismissAndReturn")),this.Rc.rb(Ca.a.click,this.Lma,Object(z.a)(this,this.L9g,"onGoPremiumClicked"))):L.a.J(594031904,829,50,"PremiumContentCallout::RegisterEvents ClickInputManager or KeyInputManager is null. Couldn't register events on the goPremiumButton")}Vpa(){this.Rc&&
(this.Rc.Bb(Ca.a.click,this.Ndb,Object(z.a)(this,this.hUf,"dismissAndReturn")),this.Rc.Bb(Ca.a.click,this.Lma,Object(z.a)(this,this.L9g,"onGoPremiumClicked")))}K9d(u,P,la,Ba){if(Ba)return 0;Ba=6;P.y-u.y<la&&(Ba=3);return Ba}}Object(r.a)(Im,"PremiumContentCallout",null,[]);class Hn{constructor(u,P,la,Ba,Sa,pb,Vb,Bc){this.Zvb=u;this.a1i=P;this.WRc=la;this.Ph=Ba;this.Xga=Sa;this.n$a=pb;this.C2e=Vb;this.Ryd=Bc}}Object(r.a)(Hn,"RenderSuggestionsArgs",null,[843]);class cm extends Sys.EventArgs{constructor(u){super();
this.card=u}}Object(r.a)(cm,"ClickSuggestedActionEventArgs",Sys.EventArgs,[]);class nn extends Sys.EventArgs{constructor(u){super();this.h4c=u}}Object(r.a)(nn,"DesignerClickMoreIdesEventArgs",Sys.EventArgs,[]);class on extends Sys.EventArgs{constructor(u,P){super();this.Lgl=u;this.wCl=P}}Object(r.a)(on,"DesignerClickSuggestionEventArgs",Sys.EventArgs,[]);class $n extends gg.a{constructor(u,P,la,Ba,Sa,pb,Vb,Bc,Yc,gd,Td,Re,Uf,Ef){super(new Rq.a,u,pb);this.beb=this.ceb=this.iM=this.w0=this.dfc=this.FX=
null;this.OEg=this.TEg=0;this.Rma=!1;this.f0g=this.hIa=this.Nw=null;this.Rn=la;this.xp=Ba;this.Pb=Sa;this.Fa=Vb;this.Rc=Bc;this.ke=P;this.Sr=Yc;this.Qr=gd;this.ia=Td;this.le=Re;this.la=Uf;this.xPh=this.la.useWideSuggestionThumbs;this.xR=new Oa.a(()=>new Im(this.ia,this.la,P,Bc,gd,Object(z.a)(this,this.Hdg,"goPremiumExperience")));this.kBg=new ln(Ef,Object(z.a)(this,this.$zk,"onAccountUpgrade"),Uf.wSa);this.rM=new ie;this.Wik=Object.assign(new dj(Td,this.rM,this.la),{zx:tb.a.Hbb})}dispose(){this.Rma&&
this.bKf();this.Nw&&(this.Nw.dispose(),this.Nw=null);this.xR.kbb&&this.xR.value.dispose();super.dispose();L.a.J(512496477,829,50,"DesignerView::Dispose")}H$b(){this.FX=Rb.a.$d();this.FX.className="DesignerViewContainer";this.container.appendChild(this.FX);this.Rma=!0;L.a.J(512496476,829,50,"DesignerView::InitializeView")}bKf(){this.la.cRc&&this.xp.sAi();if(this.FX.children&&0<this.FX.children.length)for(const u=0;u<this.FX.children.length;)this.FX.removeChild(this.FX.children[u]);this.Rn.Gba=0;this.Rn.Hoh(Object(z.a)(this,
this.onFocus,"onFocus"));this.Rn.Ioh(Object(z.a)(this,this.C9g,"onFocusBlur"));this.xR.kbb&&this.xR.value.dismiss();L.a.J(512496475,829,50,"DesignerView::CleanUpView")}H1a(u){L.a.J(512496474,829,50,"DesignerView.SetViewState. CorrelationId:{0}, ViewState:{1}",this.Pb.correlationId,Zc[u]);this.HN();4!==u&&7!==u&&8!==u&&(this.bKf(),this.FX.id=this.Pb.correlationId);this.Rn.Gba=u;switch(this.Rn.Gba){case 1:this.BMj();this.dpl();break;case 7:this.cpl();break;case 2:this.IMj();break;case 9:this.HMj();
break;case 5:this.TMj();break;case 3:this.ZMj();break;case 6:this.CMj();break;case 4:if(u=document.querySelectorAll(".DesignerSuggestionListDisabled"))for(let P=0;P<u.length;P++)u[P].style.visibility=mb.a.visible,u[P].setAttribute(ue.uXd,ue.QGf)}this.Rn.kzf(Object(z.a)(this,this.onFocus,"onFocus"));this.Rn.lzf(Object(z.a)(this,this.C9g,"onFocusBlur"))}tta(){return this.la.TSf&&this.kBg.tta()}Hdg(u){this.la.TSf&&(L.a.J(512496473,829,50,"DesignerView::GoPremiumExperience SourceContext:{0}",u?u.toString():
""),this.xR.kbb&&this.xR.value.dismiss(),this.kBg.launchUpsellExperience(this.la.wSa?"designertrial":"designer"))}startFreeTrial(){this.xR.kbb&&this.xR.value.dismiss();this.xp.VHl();this.Pb.J3e=!0;this.Zw(0,!0);L.a.J(512496472,829,50,"DesignerView::StartFreeTrial Free Trial started")}$zk(){L.a.J(512496471,829,50,"DesignerView::OnAccountUpgrade Account has been upgraded");this.xR.kbb&&this.xR.value.dismiss();this.xp.zMl()}BMj(){this.dfc=Rb.a.$d();this.dfc.className="DesignerLoadingView";const u=Rb.a.sB();
u.className=v.AFrameworkApplication.isRtl?"DesignerLoadingViewSpinnerRTL":"DesignerLoadingViewSpinner";u.src=$f.a.JN(Of.a.Foa);const P=Rb.a.$d();P.className=v.AFrameworkApplication.isRtl?"DesignerLoadingViewTextRTL":"DesignerLoadingViewText";P.innerText=ResourceStrings.L_DesignerLoading;this.dfc.appendChild(u);L.a.J(512496470,829,50,"DesignerView::spinner shows up");this.dfc.appendChild(P);this.FX.appendChild(this.dfc);L.a.J(512496469,829,50,"DesignerView::InitLoadingState")}JMj(){const u=Rb.a.$d();
u.className="DesignerNoSuggestionNewButton";u.tabIndex=0;u.innerText=ResourceStrings.L_DesignerLearnMoreShort;u.setAttribute("Unselectable","on");u.setAttribute(Ha.a.er,u.innerText);u.setAttribute(Ha.a.hf,Ha.a.Ju);u.setAttribute("href",Of.a.OSf);this.Rc.rb(Ca.a.click,u,Object(z.a)(this,this.PKf,"clickSuggestionLinkHandler"));this.w0.appendChild(u)}GMj(){const u=Rb.a.kda();u.className="DesignerNoSuggestionView-Link";u.setAttribute("href",Of.a.OSf);u.setAttribute("target","_blank");u.innerText=ResourceStrings.L_DesignerLearnMore;
u.tabIndex=0;u.setAttribute(Ha.a.hf,Ha.a.rVd);this.w0.appendChild(u);this.Rc.rb(Ca.a.click,u,Object(z.a)(this,this.PKf,"clickSuggestionLinkHandler"))}IMj(){this.Rn.isVisible&&(this.Ohe(!1),this.ceb.innerText=ResourceStrings.L_DesignerNoSuggestionHeader,this.beb.innerText=ResourceStrings.L_DesignerNoSuggestionContent,L.a.J(512496468,829,50,"DesignerView::InitNoSuggestionState"))}HMj(){this.Rn.isVisible&&(this.Ohe(!0),this.ceb.innerText=ResourceStrings.L_DesignerNoIdeasHeader,this.beb.innerText=ResourceStrings.L_DesignerNoIdeas,
L.a.J(512496467,829,50,"DesignerView::InitNoSuggestionState"))}TMj(){this.Rn.isVisible&&(this.Ohe(!1),this.ceb.innerText=ResourceStrings.L_DesignerCoauthorHeader,this.beb.innerText=ResourceStrings.L_DesignerCoauthorContent,L.a.J(512496466,829,50,"DesignerView::InitSameSlideCoauthNoSuggestionState"))}Ohe(u){this.w0=Rb.a.$d();this.w0.className=v.AFrameworkApplication.isRtl?"DesignerNoSuggestionViewRTL":"DesignerNoSuggestionView";this.ceb=Rb.a.$d();this.beb=Rb.a.$d();this.xp.wph(this.FX);if(u){this.ceb.className=
"DesignerNoSuggestionNew-Header";this.beb.className="DesignerNoSuggestionNew-Content";const P=Rb.a.sB();P.src=this.ke.qk("DesignerNoIdeas.svg");P.className="DesignerNoIdeasIllustration";this.w0.appendChild(P)}else this.ceb.className="DesignerNoSuggestionView-Header",this.beb.className="DesignerNoSuggestionView-Content";this.w0.appendChild(this.ceb);this.w0.appendChild(this.beb);u?this.JMj():this.GMj();this.FX.appendChild(this.w0);this.Qr.addHandler(this.w0,Ca.a.Bf,Object(z.a)(this,this.Eua,"inputKeyPressHandler"))}ZMj(){this.Rn.isVisible||
this.Rn.Xp(!0,dh.a.none);this.iM=Rb.a.$d();const u=this.xPh?"DesignerShowSuggestionViewWide":"DesignerShowSuggestionView",P=this.xPh?"DesignerShowSuggestionViewRTLWide":"DesignerShowSuggestionView";this.iM.className=v.AFrameworkApplication.isRtl?P:u;this.FX.appendChild(this.iM);this.la.RSf||(this.Fa.tj(Ad.a.s_,!0),this.Fa.Bd());this.Rc.rb(Ca.a.click,this.iM,Object(z.a)(this,this.EBi,"clickSuggestionHandler"));this.Qr.addHandler(this.iM,Ca.a.Bf,Object(z.a)(this,this.ZZc,"inputKeyApplyHandler"));this.Sr.rb(Ca.a.pointerOver,
this.iM,Object(z.a)(this,this.NM,"onPointerOver"));this.Sr.rb(Ca.a.pointerOut,this.iM,Object(z.a)(this,this.qG,"onPointerOut"));L.a.J(512496465,829,50,"DesignerView::InitShowSuggestionState")}Tqj(){return this.E8b(this.iM.querySelector("#"+this.No.id+" .DesignerSuggestionResultSelected"))}sij(){return this.E8b(this.iM.querySelector("#"+this.No.id+" ["+ue.h8a+"]:hover"))}E8b(u){let P;return({suggestionIndex:P}=this.Tbg(u)).returnValue?parseInt(P):-1}Tbg(u){let P,la,Ba;Ba=la=P="";if(u){const Sa=u.getAttribute(ue.SCa),
pb=u.getAttribute(ue.h8a);if(!Sa||!pb)return L.a.J(512496464,829,10,"DesignerView::GetSuggestionIndexAndSlideId - Failed to parse suggestion index and slideId, CorrelationId: {0}",this.Pb.correlationId),{returnValue:!1,suggestionIndex:P,slideId:la,T2e:Ba};P=Sa.toString();la=pb.toString();(u=u.getAttribute(ue.xLc))?Ba=u.toString():L.a.J(512496463,829,15,"DesignerView::GetSuggestionIndexAndSlideId - Failed to parse suggestion slide creationId, CorrelationId: {0}",this.Pb.correlationId);return{returnValue:!0,
suggestionIndex:P,slideId:la,T2e:Ba}}return{returnValue:!1,suggestionIndex:P,slideId:la,T2e:Ba}}F8b(){return this.iM.querySelectorAll("#"+this.No.id+" ["+ue.SCa+"]").length}PKf(u){return this.Rn.isVisible&&u&&u.IC?this.Tdg(u.IC.className):!1}Wda(){const u=this.la.useWideSuggestionThumbs?"DesignerShowSuggestionViewWide":"DesignerShowSuggestionView",P=this.la.useWideSuggestionThumbs?"DesignerShowSuggestionViewRTLWide":"DesignerShowSuggestionView";return this.container.querySelector("."+(v.AFrameworkApplication.isRtl?
P:u))}DBi(u){u=u.getAttribute(ue.SCa).toString();u=this.Pb.xRa[parseInt(u)];if(!u||3!==u.Type&&4!==u.Type)return!1;this.le.wXk(new cm(u));return!0}ISc(u,P){for(;u&&u.className!==P;)u=u.parentNode;return u}EBi(u){if(!this.Rn.isVisible||u.LA!==Sys.UI.MouseButton.leftButton||!this.xp.Ba||!u.Bc)return!1;var P=u.Bc;try{if(P.className){if(P.className===Cd.VHb||P.className===Cd.WHb||P.className===Cd.LIe||P.className===Cd.tgd)return this.CBi(P);if(P.className.startsWith(Cd.bWf))return this.BBi(P)}else L.a.J(512496462,
829,15,"DesignerView::ClickSuggestionHandler ClassName is null")}catch(Td){return L.a.J(512496461,829,15,"DesignerView::ClickSuggestionHandler unexpected exception: {1}",P.className,Td.message),!1}if(u=this.ISc(P,ue.aHf))return this.DBi(u);if(this.tta()){if(P.className===ue.cub)return this.startFreeTrial(),!0;if(P.className===ue.d1b)return u=cb.a.ki(P),this.xR.value.show(u,P,!0,P,"DesignerInFreeTrialViewGoPremiumTextSelected",null),!0;(u=this.ISc(P,ue.c1b))||(u=this.ISc(P,ue.nLc));if(u)return this.Hdg(null),
!0}if(this.la.dka&&(u=this.ISc(P,ue.pXd))){this.xp.$Yc(this.Wda());if(!u.getAttribute(ue.bub))return!1;this.xp.vwl(this.Wda());u=new nn(u.getAttribute(ue.bub).toString());this.le.IXk(u);return!0}if(Sys.UI.DomElement.containsCssClass(P,"ms-Icon--Diamond")){if(P=P.parentNode,!P)return!1}else if(!(Sys.UI.DomElement.containsCssClass(P,ue.wLc)||Sys.UI.DomElement.containsCssClass(P,ue.g1b)||Sys.UI.DomElement.containsCssClass(P,ue.yLc)||(P=P.firstChild,P)))return!1;u=P.parentNode;var la=document.querySelector("#"+
this.No.id+" ."+ue.RCa);if(!({suggestionIndex:Bc,slideId:Yc,T2e:gd}=this.Tbg(u)).returnValue)return!1;var Ba=parseInt(Bc),Sa=parseInt(Yc);const pb=parseInt(gd)||0;let Vb=this.Pb.c_.sid===Sa;this.la.dka&&(Vb=this.xp.Kxb(la,!1)===u||this.xp.Kxb(la,!0)===u);if(Vb)return L.a.J(512496460,829,50,"DesignerView::ClickSuggestionHandler clicked the applied suggestion"),this.le.Yjh(new on(Ba,this.F8b())),!1;if(u&&u.getAttribute(ue.qLc)){P=null;la=u.childNodes;for(Ba=0;Ba<la.length;Ba++)if(Sa=la[Ba],Sys.UI.DomElement.containsCssClass(Sa,
ue.wLc)){P=Sa;break}la=new rl(Bc,Yc,gd);P=cb.a.ki(P||u);this.xR.value.show(P,u,!1,null,null,la);return!1}if(Sys.UI.DomElement.containsCssClass(P,ue.yLc))return!1;var Bc=this.tqj(P,Sa,pb);var Yc=Object.assign(new Gl,{SuggestionCid:pb,SuggestionSid:Sa,CorrelationId:la.getAttribute("correlationId").toString(),ActiveSlideCid:this.xp.Ba.cid,ActiveSlideSid:this.xp.Ba.sid});var gd=P;gd=.01>=Math.abs(gd.width/gd.height-1.33);this.xp.Kxb(la,gd)?(this.xp.aKf(la,gd),Bc&&Bc.parentNode&&Bc.parentNode.parentNode&&
this.xp.aKf(Bc.parentNode.parentNode,gd),this.ia.Ka(tb.a.jtb,2,Yc),L.a.J(512496459,829,50,"DesignerView::ClickSuggestionHandler Trigger ApplyDesignerSuggestionMultiple")):(this.ia.Ka(tb.a.n8,2,Yc),L.a.J(512496458,829,50,"DesignerView::ClickSuggestionHandler Trigger ApplyDesignerSuggestion"));this.la.aTi&&u&&u.getAttribute(ue.fXd)&&w.a.instance.Ia("Common.ISystemInitiatedFeedback").execute(Td=>{try{Td.logActivity("DesignerAnimationSuggestion",null)}catch(Re){L.a.J(512496457,829,10,"Designer Animation Suggestion teaching UI failed with exception: {0}",
Re)}});this.xp.Wvh(P.parentNode,gd);Bc&&this.xp.Wvh(Bc.parentNode,gd);this.xp.vuh(this.FX,Ba);this.le.Yjh(new on(Ba,this.F8b()));return!0}tqj(u,P,la){var Ba="["+ue.h8a+'="'+P+'"] > .'+ue.g1b;la&&(Ba=String.format('[{0}="{1}"][{2}="{3}"] > .{4}',ue.h8a,P,ue.xLc,la,ue.g1b));P=document.querySelectorAll(Ba);if(!P)return null;for(la=0;la<P.length;la++)if(Ba=P[la],Ba!==u)return Ba;return null}Eua(u){this.Rn.isVisible&&(u.keyCode!==oa.a.Dp&&u.keyCode!==oa.a.zK||this.Tdg(u.target.className))}ZZc(u){!this.Rn.isVisible||
u.keyCode!==oa.a.Dp&&u.keyCode!==oa.a.zK||(u.preventDefault(),(u=document.activeElement)&&u.click())}Zw(u,P){if(!(0>u)){var la=this.iM.querySelector("["+ue.SCa+'="'+u+'"]');la?P&&(ud.FocusManager.Zq(la),this.xp.vuh(this.FX,u)):L.a.J(512496456,829,15,"DesignerView::SetSuggestionItemFocus, suggestionItem {0} is null",u)}}Xcg(){return this.tta()?this.iM.querySelector("."+ue.d1b)?2:this.iM.querySelector("."+ue.cub)?1:this.iM.querySelector("."+ue.c1b)?3:0:0}bsg(){return!!this.iM.querySelector("."+ue.cub+
":focus")}dtc(u){const P=this.iM.querySelector("."+ue.cub);P?u?ud.FocusManager.Zq(P):P.blur():L.a.J(512496455,829,15,"DesignerView::SetStartFreeTrialFocus, StartFreeTrial Button is not present")}agg(){this.etg()&&this.xR.value.SFj()}etg(){return this.xR.kbb&&this.xR.value.TL}s5j(u){return u?!!u&&(u.className===ue.cub||u.className===ue.nLc||u.className===ue.d1b||u.className===ue.c1b):!1}qpa(u,P){let la=null;1===P?la=this.iM.querySelector("."+ue.nLc):2===P?la=this.iM.querySelector("."+ue.d1b):3===P&&
(la=this.iM.querySelector("."+ue.c1b));la?u?ud.FocusManager.Zq(la):la.blur():L.a.J(512496454,829,15,"DesignerView::SetGoPremiumFocus, Go Premium Button is not present for {0} for upsell View State",P)}Gol(u,P){(P=9===P?this.w0.querySelector(".DesignerNoSuggestionNewButton"):this.w0.querySelector(".DesignerNoSuggestionView-Link"))?u?P.focus():P.blur():L.a.J(512496453,829,15,"DesignerView::SetSuggestionLinkFocus, Can't find linkelement")}T3j(u){return!(9===u?!this.w0.querySelector(".DesignerNoSuggestionNewButton:focus"):
!this.w0.querySelector(".DesignerNoSuggestionView-Link:focus"))}Tdg(u){try{const P=this.w0.querySelector("."+u);if(!P)return!1;const la=P.getAttribute("href").toString();if(!la)return!1;cb.a.openWindow(4,la);return!0}catch(P){return L.a.J(512496452,829,10,"DesignerView:GoToSuggestionLink exception: {0}",P),!1}}C9g(){this.Rn.isVisible&&this.xR.kbb&&this.xR.value.TL&&this.xR.value.dismiss()}onFocus(){if(this.Rn.isVisible)if(2===this.Rn.Gba)ud.FocusManager.Zq(this.w0.lastChild);else if(3===this.Rn.Gba){var u=
this.Xcg();if(1===u)this.dtc(!0);else if(3===u)this.qpa(!0,u);else{u=this.Tqj();var P=this.sij();-1===u?this.Zw(-1===P?0:P,!0):this.Zw(u,!0)}}}NM(u){return this.Rn.isVisible&&u.Bc?this.aWf(u.clientPoint):!1}Kli(u){var P;if(u){var la=u.getAttribute(ue.h8a);if((P=u.getAttribute(ue.xLc))&&la)P=P.toString(),la=la.toString();else{L.a.J(509371461,829,10,"DesignerView::applyFirstDesignerSuggestion - Failed to parse suggestion slide creation id and slideId, CorrelationId: {0}",this.Pb.correlationId);return}}L.a.J(508941526,
829,50,"DesignerView::applyFirstDesignerSuggestion - CorrelationId: {0}",this.Pb.correlationId);u=parseInt(la);P=parseInt(P)||0;P=Object.assign(new Gl,{SuggestionCid:P,SuggestionSid:u,CorrelationId:this.Pb.correlationId,ActiveSlideCid:this.xp.Ba.cid,ActiveSlideSid:this.xp.Ba.sid});this.ia.Ka(tb.a.n8,2,P)}n8(u,P){L.a.J(509089807,829,50,"DesignerView::applyDesignerSuggestion - auto apply designer, CorrelationId: {0}",this.Pb.correlationId);u=Object.assign(new Gl,{SuggestionCid:P,SuggestionSid:u,CorrelationId:this.Pb.correlationId,
ActiveSlideCid:this.xp.Ba.cid,ActiveSlideSid:this.xp.Ba.sid});this.ia.Ka(tb.a.n8,2,u)}qG(u){return this.Rn.isVisible&&u.Bc?this.aWf(u.clientPoint):!1}uBj(u){this.HN();this.H1a(2);L.a.J(512496451,829,50,"DesignerView::HandleGetSuggestionsTimeout, CorrelationId: {0}",u);this.Rn.isVisible&&(this.Pb.mWa=!0,this.ia.Ka(tb.a.$oa,2,new xk.a(!1,dh.a.qvd)))}dpl(){const u=this.Pb.correlationId;this.TEg=window.setTimeout(()=>{this.uBj(u)},this.la.h3d)}tBj(u){this.HN();this.xp.$Yc(this.Wda());L.a.J(512496450,
829,15,"DesignerView::HandleGetMoreIdeasTimeout, CorrelationId: {0}",u)}cpl(){const u=this.Pb.correlationId;this.OEg=window.setTimeout(()=>{this.tBj(u)},this.la.h3d)}HN(){window.clearTimeout(this.TEg);window.clearTimeout(this.OEg)}get No(){return this.Rn}CMj(){this.iM.style.display=mb.a.none;this.Pb.YHe=!0;this.hIa=Rb.a.$d();this.hIa.className=Cd.uwk;const u=this.mPf(Cd.NIe),P=document.createElement("iframe");P.className=P.id=Cd.k4g;const la=this.mPf(Cd.MIe);this.hIa.appendChild(u);this.hIa.appendChild(P);
this.hIa.appendChild(la);this.FX.appendChild(this.hIa);const Ba=this.Fa.Fc(Ad.a.tZc);Ba.parent=qa.AFrame.gE;this.Rc.yIc(Ad.a.tZc,P);Ba.f8(()=>{P.focus();const Sa=Object.assign(new rf.DOMFocusListing(()=>this.hIa),{Wjb:!0});Sa.Ro(3);Sa.Ro(2);Sa.Ro(4);Sa.Ro(1);Sa.Ro(6);Sa.Ro(5);ud.FocusManager.instance().OWd(this.hIa,Ba,Sa);const pb=ud.FocusManager.instance().EQ(Ad.a.tZc);pb.Xjb();pb.uX=!0;pb.QRa=!0;Ba.Bp(ud.FocusManager.instance().Bra);Ba.Bp(ud.FocusManager.instance().Cra);Sa.mF(P)});this.Fa.vf(Ad.a.tZc);
this.Qr.addHandler(this.hIa,Ca.a.Bf,Object(z.a)(this,this.kA,"keyDownHandler"))}mPf(u){const P=document.createElement("div");P.setAttribute("Id",u);P.setAttribute("tabindex",0);P.setAttribute("position","absolute");P.setAttribute("width","-1000px");P.setAttribute("top","-1000px");return P}kA(u){u.keyCode===Sys.UI.Key.tab&&(u.target.id!==Cd.MIe||u.shiftKey?u.target.id===Cd.NIe&&u.shiftKey&&this.kxh(u,Cd.MIe):this.kxh(u,Cd.NIe))}kxh(u,P){u.preventDefault();u.stopPropagation();(u=document.getElementById(P))&&
u.focus()}CBi(u){switch(u.className){case Cd.tgd:return this.No.llb(1),!0;case Cd.VHb:u=u.querySelector("."+Cd.WHb).innerText;break;case Cd.WHb:u=u.innerText;break;case Cd.LIe:u=u.parentNode.querySelector("."+Cd.WHb).innerText;break;default:return!1}return this.M9k(u)}M9k(u){this.la.dka&&(this.f0g=this.Wda().querySelector("."+ue.RCa).getAttribute("correlationId").toString());this.H1a(6);var P=lb.a.iL(this.la.pptEditingUserId).toString();P=String.format(this.la.insertPictureServiceEndpoint,v.AFrameworkApplication.lcid,
hk.a.He(v.AFrameworkApplication.lcid).name,v.AFrameworkApplication.buildVersion,ua.a.create().toString(),3,P,0);P=P.replace(RegExp("&amp;","g"),"&").replace(RegExp("&p=3"),"&p=6")+"&q="+u;u=document.getElementById(Cd.k4g);u.setAttribute("src",P);u.style.visibility=mb.a.visible;this.Nw=(new Ni).getInstance(u.contentWindow,P);this.Nw.Aya(Jd.a.Ixf,la=>{if(la=this.rM.ueh(la)){const Ba=[];Array.add(Ba,la);this.ia.processAction(tb.a.buc,2);this.No.Xp(!1,dh.a.fLf);this.Wik.Fua(Ba)}});this.Nw.Aya(Jh.aH,()=>
{this.H1a(3);const la=new Hn(this.Pb.suggestions,this.Pb.suggestions?this.Pb.suggestions.SlideSuggestions.length:0,this.Pb.xRa.length,this.la.dka?this.f0g:this.Pb.correlationId,this.Wda(),!0,this.tta(),this.xp.GZc(Me.a.makeItVisual));this.xp.VVe(la)});return!0}BBi(u){return Sys.UI.DomElement.containsCssClass(u,Cd.vwb)||Sys.UI.DomElement.containsCssClass(u,Cd.uwb)?this.VAj(u):Sys.UI.DomElement.containsCssClass(u,Cd.KSa)||Sys.UI.DomElement.containsCssClass(u,Cd.TQc)||Sys.UI.DomElement.containsCssClass(u,
Cd.fWf)||Sys.UI.DomElement.containsCssClass(u,Cd.eWf)?this.WAj(u):Sys.UI.DomElement.containsCssClass(u,Cd.a5b)?this.EBj():Sys.UI.DomElement.containsCssClass(u,Cd.e5b)?this.TCj():!1}TCj(){this.ia.processAction(tb.a.FPe,2);this.No.Xp(!1,dh.a.yJk);return this.Pb.UVf=!0}aWf(u){const P=this.Pb.n_d;if(!P||oc.a.Xa(this.Pb.LW))return!1;u=cb.a.QTa(u);this.TVj(u)?P.gZc(this.O5f()):P.gZc([]);return!0}TVj(u){for(;u&&u.className!==Cd.P4d;)u=u.parentNode;return!!u&&u.className===Cd.P4d}EBj(){const u=this.Pb.n_d;
if(!u)return!1;u.ignoreCritiques(this.O5f(),4);this.Pb.LW.splice(this.Pb.PN,1);if(this.Pb.PN===this.Pb.LW.length){let P;(P=this.Pb).PN=P.PN-1}this.$1k();return!0}O5f(){const u=[];for(const P of this.Pb.LW[this.Pb.PN].critiques)u.push(P.critiqueId);return u}VAj(u){if(Sys.UI.DomElement.containsCssClass(u,Cd.vwb)){let P;(P=this.Pb).PN=P.PN-1;this.Pb.PN||(Sys.UI.DomElement.removeCssClass(u,Cd.vwb),Sys.UI.DomElement.addCssClass(u,Cd.c5b));u=document.getElementById(Cd.twb);Sys.UI.DomElement.removeCssClass(u,
Cd.b5b);Sys.UI.DomElement.addCssClass(u,Cd.uwb)}else{let P;(P=this.Pb).PN=P.PN+1;this.Pb.PN===this.Pb.LW.length-1&&(Sys.UI.DomElement.removeCssClass(u,Cd.uwb),Sys.UI.DomElement.addCssClass(u,Cd.b5b));u=document.getElementById(Cd.H9a);Sys.UI.DomElement.removeCssClass(u,Cd.c5b);Sys.UI.DomElement.addCssClass(u,Cd.vwb)}document.getElementById(Cd.O4d).innerText=(this.Pb.PN+1).toString();this.oNh(this.Pb.PN);return!0}oNh(u){var P=this.Pb.LW[u].critiques[0].explanationLabel;document.getElementById(Cd.dWf).innerText=
P;P=document.getElementById(Cd.gWf);const la=ue.ROf();P.parentNode.replaceChild(la,P);this.xp.Gfg(la,u)}WAj(u){const P=this.Pb.n_d;if(oc.a.Xa(this.Pb.LW)||!P)return!1;u=u.getAttribute(Jh.JSa);var la=document.querySelector("."+Cd.TQc+"["+Jh.JSa+'="'+u+'"]');la&&(la.innerText="\u2713",Sys.UI.DomElement.removeCssClass(la,Cd.TQc),Sys.UI.DomElement.addCssClass(la,Cd.UXi));la=new sc.a(0);for(const Ba of this.Pb.LW[this.Pb.PN].critiques)la.add(Ba.critiqueId,u);P.AHh(la);return this.Pb.RQc=!0}$1k(){var u=
document.getElementById(Cd.SVf);let P=parseInt(u.innerText);P--;if(0>=P)this.Cwl(document.getElementById(Cd.TVf));else{u.innerText=P.toString();this.oNh(this.Pb.PN);u=this.Pb.PN===this.Pb.LW.length-1;const la=document.getElementById(Cd.twb);1<P&&!u?(Sys.UI.DomElement.addCssClass(la,Cd.uwb),Sys.UI.DomElement.removeCssClass(la,Cd.b5b)):(Sys.UI.DomElement.addCssClass(la,Cd.b5b),Sys.UI.DomElement.removeCssClass(la,Cd.uwb));u&&(document.getElementById(Cd.O4d).innerText=P.toString());u=document.getElementById(Cd.H9a);
1<P&&this.Pb.PN?(Sys.UI.DomElement.addCssClass(u,Cd.vwb),Sys.UI.DomElement.removeCssClass(u,Cd.c5b)):(Sys.UI.DomElement.addCssClass(u,Cd.c5b),Sys.UI.DomElement.removeCssClass(u,Cd.vwb))}}Cwl(u){const P=Rb.a.$d();P.className=Cd.OXi;const la=new ld.a;la.ah(40,40);la.xpa("0,0,2048,2048");la.Dr(Cd.VXi);var Ba=new Pb.a;Ba.QY("M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 187 q 60 102 93 220 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 221 q -60 102 -144 186 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -186 q -60 -103 -93 -221 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -220 q 60 -103 144 -187 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1792 q 120 0 232 -31 q 111 -31 208 -87 q 96 -57 176 -136 q 79 -80 136 -176 q 56 -97 87 -208 q 31 -112 31 -232 q 0 -120 -31 -231 q -31 -112 -87 -208 q -57 -97 -136 -176 q -80 -80 -176 -136 q -97 -57 -208 -88 q -112 -31 -232 -31 q -120 0 -231 31 q -112 31 -208 88 q -97 56 -176 136 q -80 79 -136 176 q -57 96 -88 208 q -31 111 -31 231 q 0 120 31 232 q 31 111 88 208 q 56 96 136 176 q 79 79 176 136 q 96 56 208 87 q 111 31 231 31 m -599 -783 l 72 -72 l 348 348 l 706 -706 l 72 72 l -778 779 z");
const Sa=new Pb.a;Sa.QY("M 1894 1024 q 0 120 -31 232 q -31 111 -87 208 q -57 96 -136 176 q -80 79 -176 136 q -97 56 -208 87 q -112 31 -232 31 q -120 0 -231 -31 q -112 -31 -208 -87 q -97 -57 -176 -136 q -80 -80 -136 -176 q -57 -97 -88 -208 q -31 -112 -31 -232 q 0 -120 31 -231 q 31 -112 88 -208 q 56 -97 136 -176 q 79 -80 176 -136 q 96 -57 208 -88 q 111 -31 231 -31 q 120 0 232 31 q 111 31 208 88 q 96 56 176 136 q 79 79 136 176 q 56 96 87 208 q 31 111 31 231 z");Sa.va.setAttribute("class",Cd.YXi);const pb=
new Pb.a;pb.QY("M 1024 128 q 124 0 239 32 q 114 32 214 91 q 99 58 181 140 q 81 81 140 181 q 58 99 90 214 q 32 114 32 238 q 0 124 -32 239 q -32 114 -90 214 q -59 99 -140 181 q -82 81 -181 140 q -100 58 -214 90 q -115 32 -239 32 q -124 0 -238 -32 q -115 -32 -214 -90 q -100 -59 -181 -140 q -82 -82 -140 -181 q -59 -100 -91 -214 q -32 -115 -32 -239 q 0 -124 32 -238 q 32 -115 91 -214 q 58 -100 140 -181 q 81 -82 181 -140 q 99 -59 214 -91 q 114 -32 238 -32 m 599 625 l -72 -72 l -706 706 l -348 -348 l -72 72 l 420 421 z");
pb.va.setAttribute("class",Cd.MXi);const Vb=new Pb.a;Vb.QY("M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 187 q 60 102 93 220 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 221 q -60 102 -144 186 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -186 q -60 -103 -93 -221 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -220 q 60 -103 144 -187 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1792 q 120 0 232 -31 q 111 -31 208 -87 q 96 -57 176 -136 q 79 -80 136 -176 q 56 -97 87 -208 q 31 -112 31 -232 q 0 -120 -31 -231 q -31 -112 -87 -208 q -57 -97 -136 -176 q -80 -80 -176 -136 q -97 -57 -208 -88 q -112 -31 -232 -31 q -120 0 -231 31 q -112 31 -208 88 q -97 56 -176 136 q -80 79 -136 176 q -57 96 -88 208 q -31 111 -31 231 q 0 120 31 232 q 31 111 88 208 q 56 96 136 176 q 79 79 176 136 q 96 56 208 87 q 111 31 231 31 m 672 -1141 l -851 851 l -493 -493 l 145 -144 l 348 347 l 706 -706 m -706 924 l 778 -779 l -72 -72 l -706 706 l -348 -348 l -72 72 z");
Vb.va.setAttribute("class",Cd.LXi);la.appendChild(Ba);la.appendChild(Sa);la.appendChild(pb);la.appendChild(Vb);Ba=Rb.a.Il();Ba.innerText=ResourceStrings.l_ConsistencyCardNoMore;Ba.className=Cd.PXi;P.appendChild(la.va);P.appendChild(Ba);u.parentNode.replaceChild(P,u)}}$n.JXi=[Cd.H9a,Cd.twb,Cd.KSa,Cd.a5b,Cd.e5b];Object(r.a)($n,"DesignerView",gg.a,[771,518,166,107]);var xm=d(192);class dl extends Sys.EventArgs{constructor(u,P){super();this.slideId=u.slideId;this.YFh=u.Quc;this.bZf=u.tba;this.n$a=P;this.trigger=
u.trigger;this.correlationId=u.correlationId}}Object(r.a)(dl,"RenderSuggestionsEventArgs",Sys.EventArgs,[]);class ok{constructor(u,P,la,Ba,Sa,pb,Vb,Bc,Yc,gd,Td,Re,Uf,Ef){this.ZFg=new am.a;this.vp=u;this.xp=P;this.Pb=la;this.la=Ba;this.ia=Sa;this.ta=pb;this.Eb=Vb;this.Ic=Bc;this.Gb=Yc;this.Fa=gd;this.wb=Td;this.Dec=this.Kue=0;this.QXa=Re;this.Kek=Uf;this.mxa=Ef;this.Gt()}Gt(){this.Ic.pgi(Object(z.a)(this,this.Qbh,"onSuggestionsUpdated"));this.Ic.ogi(Object(z.a)(this,this.t8g,"onCoauthModifiedSameSlide"));
this.Kek.execute(u=>{u.Kdi(Object(z.a)(this,this.OHk,"onShowMoreSuggestions"),()=>{this.ANb(this.vp,3)})});this.la.designerIncrementalRenderEnabled&&this.Ic.rhi(Object(z.a)(this,this.rch,"onUserBeginUploadPicture"));this.Ic.kJc(Object(z.a)(this,this.uoa,"onUndoRedo"))}dispose(){this.Ic.T7k(Object(z.a)(this,this.Qbh,"onSuggestionsUpdated"));this.Ic.S7k(Object(z.a)(this,this.t8g,"onCoauthModifiedSameSlide"));this.la.designerIncrementalRenderEnabled&&this.Ic.z8k(Object(z.a)(this,this.rch,"onUserBeginUploadPicture"));
this.Ic.fpd(Object(z.a)(this,this.uoa,"onUndoRedo"))}Mhl(u){this.ia.Ka(tb.a.$oa,2,new xk.a(!1,u))}ANb(u,P){u?u.H1a(P):L.a.J(512496522,829,50,"SetDesignerViewState - null view. CorrelationId:{0}, ViewState:{1}",this.Pb.correlationId,P)}OFj(u){const P=this.MTi(u);if(P){var la=P.No;L.a.J(512496521,829,50,"DesignerManager::HandleSuggestionItemNavigation - ActionId: {0} in ViewState: {1}",u,Zc[la.Gba]);switch(la.Gba){case 3:this.sxk(u,P);break;case 2:case 9:this.rxk(u,P,la.Gba)}}}MTi(u){switch(u){case tb.a.a_a:case tb.a.iIb:case tb.a.jIb:case tb.a.b_a:case tb.a.lIb:case tb.a.mIb:case tb.a.kIb:case tb.a.Qhb:u=
this.vp;break;default:return null}return u}sxk(u,P){if(P&&P.No){var la=document.activeElement;if(la){var Ba=la.getAttribute(ue.SCa),Sa=P.s5j(la),pb=Sys.UI.DomElement.containsCssClass(la,"DesignerPaneCloseButton")||Sys.UI.DomElement.containsCssClass(la,"IdeasText"),Vb=this.j4g(la)||this.VVf(la),Bc=P.etg();if(Ba||pb||Vb||Sa||Bc)if(Ba=Ba?parseInt(Ba.toString()):-1,Sa=P.F8b()-1,!(1>Sa))switch(pb=P.No,Vb=P.Xcg(),u){case tb.a.a_a:if(Bc||1===Vb||3===Vb)break;pb.TA(!1);Ba<Sa&&(P.Zw(Ba,!1),P.Zw(Ba+1,!0));
break;case tb.a.iIb:if(Bc||1===Vb||3===Vb)break;pb.TA(!1);Ba!==Sa&&(P.Zw(Ba,!1),P.Zw(Sa,!0));break;case tb.a.jIb:if(Bc){P.agg();break}this.LCj(P,Ba,Sa,Vb);break;case tb.a.b_a:if(Bc||1===Vb||3===Vb)break;pb.TA(!1);0<Ba&&(P.Zw(Ba,!1),P.Zw(Ba-1,!0));break;case tb.a.lIb:if(Bc||1===Vb||3===Vb)break;pb.TA(!1);Ba&&(P.Zw(Ba,!1),P.Zw(0,!0));break;case tb.a.mIb:if(Bc){P.agg();break}this.MCj(P,Ba,Sa,Vb);break;case tb.a.kIb:case tb.a.Qhb:Bc||1===Vb||3===Vb||(u=u===tb.a.Qhb,P=P.No,this.j4g(la)?this.OCj(u,P):this.VVf(la)&&
this.NCj(u,P))}}}}LCj(u,P,la,Ba){const Sa=u.No;if(-1===P){switch(Ba){case 1:Sa.CVa?(Sa.TA(!1),u.dtc(!0)):u.bsg()?(u.dtc(!1),u.qpa(!0,Ba)):(u.qpa(!1,Ba),Sa.TA(!0));return;case 2:Sa.CVa?(Sa.TA(!1),u.Zw(0,!0)):(u.qpa(!1,Ba),Sa.TA(!0));return;case 3:P=Sa.CVa;Sa.TA(!P);u.qpa(P,Ba);return}Sa.TA(!1);u.Zw(0,!0)}else P===la?(u.Zw(P,!1),2===Ba?u.qpa(!0,Ba):Sa.TA(!0)):(u.Zw(P,!1),u.Zw(P+1,!0))}MCj(u,P,la,Ba){const Sa=u.No;if(0<P)u.Zw(P,!1),u.Zw(P-1,!0);else if(-1===P){switch(Ba){case 1:Sa.CVa?(Sa.TA(!1),u.qpa(!0,
Ba)):u.bsg()?(u.dtc(!1),Sa.TA(!0)):(u.qpa(!1,Ba),u.dtc(!0));return;case 2:Sa.CVa?(Sa.TA(!1),u.qpa(!0,Ba)):(u.qpa(!1,Ba),u.Zw(la,!0));return;case 3:P=Sa.CVa;Sa.TA(!P);u.qpa(P,Ba);return}Sa.CVa&&(Sa.TA(!1),u.Zw(la,!0))}else u.Zw(0,!1),Sa.TA(!0)}rxk(u,P,la){if(P){var Ba=P.No;if(u===tb.a.jIb||u===tb.a.mIb||u===tb.a.b_a||u===tb.a.a_a)u=P.T3j(la),Ba.TA(u),P.Gol(!u,la)}}j4g(u){return Sys.UI.DomElement.containsCssClass(u,Cd.tgd)||Sys.UI.DomElement.containsCssClass(u,Cd.VHb)}VVf(u){return u.className.startsWith(Cd.bWf)}OCj(u,
P){var la=document.activeElement;la&&(Sys.UI.DomElement.containsCssClass(la,Cd.VHb)?(la=parseInt(la.getAttribute(Cd.l4g).toString())+1,u?la!==Jh.jlc?P.llb(la+1):P.llb(1):1!==la?P.llb(la-1):P.llb(Jh.jlc)):u?P.llb(1):P.llb(Jh.jlc))}NCj(u,P){var la=document.activeElement;if(la){for(var Ba=$n.JXi,Sa=0;!Sys.UI.DomElement.containsCssClass(la,Ba[Sa]);)if(Sa++,Sa===Ba.length){Sa=-1;break}var pb=document.querySelectorAll("."+Cd.KSa).length;Ba[Sa]!==Cd.KSa?u?Sa!==Ba.length-1&&-1!==Sa?Ba[Sa+1]!==Cd.KSa?this.mzb(Ba[Sa+
1],P):P.gsd(0):this.mzb(Ba[0],P):Sa&&-1!==Sa?Ba[Sa-1]!==Cd.KSa?this.mzb(Ba[Sa-1],P):P.gsd(pb-1):this.mzb(Ba[Ba.length-1],P):(la=parseInt(la.getAttribute(Jh.JSa).toString()),u?la!==pb-1?P.gsd(la+1):this.mzb(Ba[Sa+1],P):la?P.gsd(la-1):this.mzb(Ba[Sa-1],P))}}mzb(u,P){switch(u){case Cd.H9a:P.tkl();break;case Cd.twb:P.skl();break;case Cd.a5b:P.qkl();break;case Cd.e5b:P.rkl()}}C9b(u,P){if(this.la.L0c&&this.vp.No.isVisible){if(P&&(u===tb.a.n8||u===tb.a.jtb)){this.Pb.c_=T.a.empty;P=this.ta.presentation;const la=
this.Eb.xd(7,void 0,void 0,void 0,!0);try{la.hc(P),this.la.mTi&&(la.fd=u),P.removeProperty(Zb.a.PDa)}finally{la&&la.dispose()}}this.xp.CLl(this.vp.Wda());this.la.gTi&&u!==tb.a.n8&&u!==tb.a.jtb&&this.ia.processAction(tb.a.SSf,2)}}uoa(u,P){this.C9b(P.y8e,P.Tcb)}rUj(u){return this.Pb.UBb(u)}Ysg(u){switch(u){case df.a.GVd:case df.a.JVd:case df.a.y0b:case df.a.IVd:case df.a.KVd:case df.a.LVd:case df.a.cRa:case df.a.MVd:case df.a.NVd:case df.a.OVd:case df.a.PVd:case df.a.RVd:case df.a.TVd:case df.a.backspace:case df.a.NCa:case df.a.pL:case df.a.tSa:case df.a.enter:case df.a.XB:case df.a.typing:return!0;
default:return!1}}isEnabled(){return this.la.L0c}tUj(){return 0<this.Dec}AZd(){return this.Dec}t8g(u,P){u=P.slideId;L.a.J(512496520,829,50,"DesignerManager::OnCoauthModifiedSameSlide - Others is editing in slide sid: {0}",u.sid);if((P=this.ta.Ba)&&P.Db.equals(u)){P="unopened";this.vp.No.isVisible&&(this.vp.No.isVisible&&this.ANb(this.vp,5),P="set to SameSlideCoauthNoSuggestion UI");let la="unopened";this.vp.No.isVisible&&(this.HJa(this.Pb.correlationId,mg.a.GJa),la="closed");"unopened"===P&&"unopened"===
la||L.a.J(512496519,829,50,"DesignerManager::OnCoauthModifiedSameSlide - Designer pane state: {0}. Designer card in Ideas pane state: {1}. Slide sid:{2}, cid:{3}, CorrelationId:{4}, CoauthCountInPresentation:{5} and CoauthCountInSlide:{6}.",P,la,u.sid,u.cid,this.Pb.correlationId,this.Kue,this.Dec)}}Qbh(u,P){L.a.J(512496518,829,50,"DesignerManager::OnSuggestionsUpdated - IsDesignerEnabled:{0}, CoauthCountInPresentation:{1}, CoauthCountInSlide:{2}, correlationId:{3}; trigger: {4}",this.la.L0c,this.Kue,
this.Dec,P.correlationId,P.trigger);if(this.isEnabled()){if(u=this.ta.Ba)if(P.slideId.equals(u.Db))if(this.rUj(P.correlationId))L.a.J(512496515,829,50,"DesignerManager::OnSuggestionsUpdated - CorrelationId is in closed suggestion list. CorrelationId:{0}",P.correlationId);else if(this.eSl(P.correlationId))L.a.J(512496514,829,50,"DesignerManager::OnSuggestionsUpdated - User began to upload picture during incremental rendering, so ignore further suggestions for this CorrelationId. CorrelationId:{0}",
P.correlationId);else{this.Pb.correlationId!==P.correlationId&&(this.Pb.exf(P.correlationId,this.la.dka&&P.trigger===Me.a.moreIdeas),L.a.J(512496513,829,50,"DesignerManager::OnSuggestionsUpdated - ignore result from different correlation. expected correlation: {0}; received correlation: {1}",this.Pb.correlationId,P.correlationId));if(this.Pb.correlationId===P.correlationId&&this.vp.No.isVisible&&3===this.vp.No.Gba)if(this.la.designerIncrementalRenderEnabled&&oc.a.any(P.Quc.toArray(),la=>0<=this.Pb.Rfa.indexOf(la)))this.Pb.xlc=
new Date,L.a.J(512496512,829,50,"DesignerManager::OnSuggestionsUpdated - Notification for missing Designer cards successfully received. CorrelationId: {0}, Received indexes: {1}, Missing indexes {2}",P.correlationId,P.Quc.toString(),this.Pb.Rfa.toString());else if(u=P.rMa,!this.la.designerIncrementalRenderEnabled||this.Pb.Xsa.contains(u)){L.a.J(512496483,829,50,"DesignerManager::OnSuggestionsUpdated - Duplicated Designer card notification. CorrelationId: {0}, StartIdx: {1}",P.correlationId,u.toString());
return}u=ue.c3d(P.WDa);this.Qel(u,P);this.QFj(P);this.PFj(this.vp,P,u,P.tba,oc.a.Xa(this.Pb.xRa)?P.tba:this.Pb.xRa.length)}else L.a.J(512496516,829,50,"DesignerManager::OnSuggestionsUpdated - current slide node is different to suggestion slide node. CorrelationId:{0}",P.correlationId)}else L.a.J(512496517,829,50,"DesignerManager::OnSuggestionsUpdated - Designer is not enabled. CorrelationId:{0}",P.correlationId)}Qel(u,P){if(u&&P.trigger!==Me.a.moreIdeas){this.Pb.suggestions||(this.Pb.suggestions=
Object.assign(new Xi,{CardData:u.CardData,SlideSuggestions:Array(P.zhe?P.tba:P.j2a)}));if(!oc.a.Xa(u.SlideSuggestions))for(const la of u.SlideSuggestions)this.Pb.suggestions.SlideSuggestions[la.Index]=la;this.Pb.xRa||(this.Pb.xRa=ue.mMk(u))}}PFj(u,P,la,Ba,Sa){L.a.J(512496482,829,50,"DesignerView.SetViewState. CorrelationId:{0}, Trigger:{1}, TotalSuggestions:{2}, DesignerCardCount:{3}",P.correlationId,P.trigger,P.tba,Ba);if(P.trigger===Me.a.moreIdeas){this.Pb.Yga||(this.Pb.Yga=new Date);var pb=u.F8b();
this.xp.N9k(la,u.Wda(),P.correlationId,u.tta())||(this.xp.$Yc(u.Wda()),pb=u.F8b()-1);u.Zw(pb,!0);this.ANb(u,8)}else if(!Ba)!this.la.designerNewNoIdeasUxEnabled||P.trigger!==Me.a.jwc&&P.trigger!==Me.a.oQb?this.ANb(u,2):this.ANb(u,9),this.vp.No.isVisible?this.HJa(this.Pb.correlationId,mg.a.GJa):this.Mhl(dh.a.noSuggestion);else if(this.Itl(P.trigger,u.No)){var Vb=!0;if(this.la.designerIncrementalRenderEnabled){Vb=null;var Bc=u.Wda();Bc&&(Vb=Bc.querySelector("#"+u.No.id+" ."+ue.RCa+'[correlationId="'+
P.correlationId+'"]'));Vb=!Vb;L.a.J(512496481,829,50,"HandleSuggestionUpdate CorrelationId:{0}, Trigger:{1}, FirstRender:{2}",P.correlationId,P.trigger,Vb);Bc=new dl(P,Vb);this.Ic.XYk(Bc)}if(Vb){this.ANb(u,3);this.Pb.Yga||(this.Pb.Yga=new Date);try{this.la.iRk&&this.mxa.execute(Yc=>{Yc.logActivity("HasSeenDesigner","PPTDesignerFloodgateSurveyEnabled")})}catch(Yc){L.a.J(512496480,829,10,"DesignerManager::HandleSuggestionUpdate: Exception thrown when trying to trigger floodgate survey. Exception: {0}",
Yc)}}Ba=new Hn(la,Ba,Sa,P.correlationId,u.Wda(),Vb,u.tta(),this.xp.GZc(P.trigger));this.xp.VVe(Ba);this.Pb.wac&&this.la.ka("ChatPPTHideImg")&&this.nbl();(this.la.iA||this.la.ZF)&&this.Pb.wac&&this.la.ka("ChatPPTImgAutoApplyDesigner")&&"InsertPicture"===P.trigger&&(Ud.a("DesignerChatPPTApplyOnFirstRender")?Vb&&0<(null===(pb=null===la||void 0===la?void 0:la.SlideSuggestions)||void 0===pb?void 0:pb.length)?u.n8(la.SlideSuggestions[0].SlideId.Sid,la.SlideSuggestions[0].SlideId.Cid):L.a.J(509089808,829,
Vb?10:50,"DesignerManager::HandleSuggestionUpdate: not able to get suggestion to apply"):(P=u.Wda().querySelector("."+ue.RCa),null!=P&&u.Kli(P.childNodes[0])))}}nbl(){const u=this.ta.Ba;if(u){var P=u.F_(la=>0!==la.PPb);P&&P.length&&(P.forEach(la=>{la.PPb=0}),P=new O.a(2,1,this.la.wc("ChatPPTUnhideUpdateMs",2E3),()=>{u.t9(this.Gb.Na,252,!0)},void 0,"ResetTempHiddenShapeTask"),this.wb.Hb(P))}}QFj(u){u.zhe?(oc.a.Xa(this.Pb.suggestions.SlideSuggestions)||this.Pb.suggestions.SlideSuggestions.length===
u.tba)&&this.HJa(u.correlationId,mg.a.success,this.Pb.suggestions,u.trigger):this.HJa(u.correlationId,mg.a.success,this.Pb.suggestions,u.trigger)}Itl(u,P){return P.isVisible||u!==Me.a.$na&&u!==Me.a.kYd&&u!==Me.a.Fub}Gud(u,P){this.Dec=u;this.Kue=P;this.Ic.Py(new xm.a(1))}rch(){this.vp.No.isVisible&&3===this.vp.No.Gba&&(this.ZFg.add(this.Pb.correlationId),this.vp.H1a(1))}eSl(u){return this.ZFg.contains(u)}HJa(u,P,la=null,Ba=""){L.a.J(512496479,829,50,"DesignerManager:NotifySuggestionsReadyForIdeas - CorrelationId:{0}, Status:{1}, Trigger:{2}",
u,P,Ba);this.QXa.execute(Sa=>{const pb=this.pIi(u,la);lb.a.Xa(Ba)||(pb.trigger=Ba);Sa.notifySlideSuggestion(P,pb)})}pIi(u,P){const la=new Kj;la.correlationId=u;if(!P)return L.a.J(512496478,829,50,"DesignerManager:ParseSlideSuggestionNotificationData - no suggestions to parse. CorrelationId:{0}",u),la;la.suggestions=this.xp.TMk(P);return la}OHk(u){u=new Hn(this.Pb.suggestions,u.suggestions.length,u.suggestions.length,u.correlationId,this.vp.Wda(),!0,this.vp.tta(),this.xp.GZc(u.trigger));this.xp.VVe(u);
this.Fa.tj(Ad.a.s_,!0)}mLk(){return 4===this.vp.No.Gba}jLk(){return 1===this.vp.No.Gba}}Object(r.a)(ok,"DesignerManager",null,[774,107]);class Ok{constructor(u,P){this.qgb=this.Jo=null;this.zqk=P;this.$e=u;this.Ar=!1}get Fh(){return this.Ar}setup(){this.Fh||(this.qgb=Rb.a.$d(),this.qgb.setAttribute("Unselectable","on"),this.qgb.style.position=mb.a.absolute,this.$e.addCssClass(this.qgb,"designerPreviewImageContainer"),this.Jo=new Ub.a,this.Ar=!0)}dispose(){this.Fh&&(this.dismiss(),this.Jo&&this.Jo.va.parentNode&&
(this.Jo.Dq(),this.$e.removeCssClass(this.Jo.va,"designerPreviewImageContainer")))}dismiss(){this.Fh?(this.w0a(),this.Jo.setVisibility(!1)):L.a.J(38099035,829,15,"DesignerPreviewImageView::Dismiss - called before setup")}LLa(u){if(this.Fh){this.qgb&&(this.qgb.appendChild(this.Jo.va),this.$e.addCssClass(this.Jo.va,"designerPreviewImageContainer"),this.Jo.setVisibility(!1));var P=this.zqk.Jc;if(u=this.Tja(u))this.w0a(),P.puc.appendChild(this.qgb),this.Jo.va.appendChild(u),this.Jo.setVisibility(!0);
this.Jo.ah(P.gC.clientWidth,P.gC.clientHeight)}else L.a.J(38099037,829,15,"DesignerPreviewImageView::SetImage - called before setup")}Tja(u){if(!lb.a.Xa(u)){const P=Rb.a.sB();P.setAttribute("Unselectable","on");P.src=u;P.style.height="100%";P.style.width="100%";return P}return null}w0a(){this.Jo.va.firstChild&&this.Jo.va.removeChild(this.Jo.va.firstChild)}}Object(r.a)(Ok,"DesignerPreviewImageView",null,[775]);var Jm=d(166);class Zg{constructor(u,P,la,Ba,Sa,pb,Vb,Bc,Yc,gd,Td,Re){this.AM=null;this.tJa=
0;this.ia=u;this.Eb=P;this.kb=la;this.ta=Ba;this.Gb=Sa;this.la=pb;this.ai=Vb;this.wj=Bc;this.$b=Yc;this.n$=gd;this.wb=Td;this.Ud=Re;this.una=Hl.ready}vb(){this.ia.ra(tb.a.fixIt,ib.a.application,Object(z.a)(this,this.lBj,"handleFixIt"),4);this.ia.ra(tb.a.ORe,ib.a.application,Object(z.a)(this,this.UDj,"handleQueryFixIt"),96);this.ia.ra(tb.a.ktb,ib.a.application,Object(z.a)(this,this.ktb,"applyFixItSuggestion"),4);this.ia.ra(tb.a.D0a,ib.a.application,Object(z.a)(this,this.D0a,"reportFixItSessionInfo"),
64);this.n$.B_b(Object(z.a)(this,this.cga,"onBlockingStateChanged"))}dispose(){this.n$.apd(Object(z.a)(this,this.cga,"onBlockingStateChanged"))}lBj(u,P,la){P=this.kb.Xd();if(2>P.length)return 8;if(1===la)return 32;la=this.ta.presentation;this.la.designerBlockApplyUntilDraw?this.$b.tsa(la,this.ta.Ba,this.Gb.Na,u):this.$b.rw(la,u);this.wj.B0c=!0;const Ba=[];P.forEach(Sa=>{Array.add(Ba,Sa.get_shapeId())});u={};u.SelectedShapeIds=Ba.join(",");this.wj.Dlb=Ba;this.Yee(u);this.wj.Qmb=window.setTimeout(()=>
{this.mBj(this.wj.correlationId)},this.la.e1f);return 32}mBj(u){this.wj.mWa=!0;L.a.J(573961115,829,15,"FixItActor::HandleFixItTimeout, CorrelationId: {0}",u);this.ia.Ka(tb.a.D0a,2,dh.a.qvd);this.Ud.cta(bl.a.Oh(170),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItTryAgain)}Yee(u=null,P=null){this.B0i(la=>{if(this.la.designerRequestThrottlingEnabled){if(this.una.nrg&&+new Date-+this.una.sug<this.la.designerRequestThrottleIntervalMs){this.AM=new Sm;this.AM.sid=
la.sid;this.AM.cid=la.cid;this.AM.iZc=la.ML;return}this.una=Hl.inProgress;this.AM=null}const Ba=()=>{this.Yee(this.AM.iZc,P)};this.ai.Eka(la.cid,la.sid,la.correlationId,null,ea.a.fixIt,P,se.c(la.ML),Sa=>{Sa&&Sa.Status===ea.a.Vqh?this.$pd(()=>{this.Yee(la.ML,P)}):this.tJa=0;this.tJa||this.z9b(Ba)},Sa=>this.wib(Sa,Ba))},u)}$pd(u){this.tJa<this.la.designerMaxRetryOnWait?this.wb.Hb(new O.a(2,1,1E3,()=>{L.a.J(578937822,829,50,"retry request due to waiting on pending edits. prior correlation: {0}",this.wj.correlationId);
this.una=Hl.ready;this.tJa++;u()},void 0,"RetryRequestOnWait")):L.a.J(578937820,829,50,"retries for request awaiting prior edits exceeded. skipping request. correlation: {0}",this.wj.correlationId)}ktb(u,P,la,Ba,Sa){P=this.ta.presentation;if(!this.ta.Ba||!P)return 16;Ba=null;Object(Mh.a)(Gl,Sa)&&(Ba=Sa);if(!Ba)return 8;if(1===la)return 32;la=this.Eb.je(15);try{this.la.designerSendAppliedSuggestionHistoryEnabled&&(this.wj.XQa=new Date),la.hc(P),la.fd=u,P.PDa=Ba,this.wj.c_=T.a.Uy(Ba.SuggestionSid,Ba.SuggestionCid),
this.wj.eU=!0,L.a.J(578937818,829,50,"FixItActor::ApplyFixitSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",Ba.CorrelationId,u,Ba.SuggestionSid)}finally{la&&la.dispose()}return 32}B0i(u,P=null){const la=this.ta.Ba;la&&la.sid&&(P=Object.assign(new kn,{sid:la.sid,cid:la.cid,ML:P||{}}),L.a.J(578937816,829,50,"FixIt; sid: {0}; correlationId: {1}",P.sid,P.correlationId),this.wj.correlationId&&this.Wkb(dh.a.xkb),this.wj.i2a=new Date,this.wj.correlationId=P.correlationId,this.wj.qQ=new Date,
u(P))}z9b(u){this.la.designerRequestThrottlingEnabled&&(this.una=Hl.ready,this.AM&&u())}wib(u,P){this.z9b(P);L.a.J(578937814,829,15,"FixItActor::OnTaskFailure - request failed with response: {0}. returning true to prevent ACE",u.HttpStatusCode);return!0}UDj(u,P,la,Ba,Sa){this.iIl();if(!Object(Mh.a)(dk.a,Sa))return 8;if(1<this.kb.srd()){let pb;(pb=this.wj).$tb=pb.$tb+1;return 32}return 8}D0a(u,P,la,Ba,Sa){if(Sa===dh.a.noSuggestion||Sa===dh.a.qvd)this.la.designerBlockApplyUntilDraw?this.$b.Mwc(Jm.e(this.ta.Ba,
this.Gb.Na)):this.$b.xK(this.ta.presentation);this.Wkb(Sa);return 32}cga(u,P){if(this.wj.B0c){u=this.$b.$c(this.ta.presentation);const la=this.la.designerBlockApplyUntilDraw?"UnblockContentWhenDraw":"SessionRehydrated";u||Object(S.a)(String,P.actionName)!==la||(window.clearTimeout(this.wj.Qmb),this.wj.mWa||(this.wj.h2a=new Date),this.wj.XQa=null,this.wj.B0c=!1)}}Wkb(u){const P=this.wj.correlationId;if(lb.a.Xa(P))L.a.J(578937812,829,50,"FixItActor::SendTraceRequest - skipped for empty correlation. ResetReason:{0}",
u);else{var la={};this.wj.c_&&(la.SuggestionSlideId=this.wj.c_.sid.toString(),la.SuggestionSlideCreationId=this.wj.c_.cid.toString());la.AppliedSuggestion=this.wj.eU;la.DisplaySuggestionsTimeoutInMs=this.la.e1f;la.SuggestionsTimeout=this.wj.mWa;la.ClientAbort=this.wj.HAb;la.ResetReason=u;la.DesignerSendTraceRequestOnSessionEnded=this.la.i3d;var Ba=cd.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),Sa={};Sa.ClientOS=Ba.Os;Sa.Browser=Ba.Browser||"";Sa.BrowserVersion=Ba.BrowserVersion||
"";Sa.BrowserMajorVersion=Ba.BrowserMajorVersion||"";Sa.BrowserMinorVersion=Ba.BrowserMinorVersion||"";this.wj.i2a&&this.wj.tPb&&this.wj.tPb>this.wj.i2a&&(Sa.SuggestionsE2ETimeMs=+this.wj.tPb-+this.wj.i2a);this.wj.i2a&&this.wj.h2a&&this.wj.h2a>this.wj.i2a&&(Sa.SuggestionAppliedE2ETimeMs=+this.wj.h2a-+this.wj.i2a);la.BrowserData=Sa;this.wj.qQ&&this.wj.h2a&&this.wj.h2a>this.wj.qQ&&(la.TimeToDisplaySuggestionsInMs=+this.wj.h2a-+this.wj.qQ);this.wj.n6e&&(la.TimeSuggestionsRendered=this.wj.n6e.toUTCString());
this.ai.$oa(P,se.c(la),u===dh.a.Lrd);this.wj.NWe();L.a.J(578937810,829,50,"FixItActor::SendTraceRequest - Send session info and add correlationId to closed list. resetReason: {0}; CorrelationId:{1}",u,P)}}iIl(){try{const u=w.a.instance.Ia("Common.ISystemInitiatedFeedback");u&&u.execute(P=>{P.logActivity("AutoFixInViewportActivity",null)})}catch(u){L.a.J(573649484,829,10,"Exception thrown while triggering AutoFixInViewportActivity. Exception: {0}",u)}}b6(){}a6(){}}Object(r.a)(Zg,"FixItActor",null,
[143]);class Tm{constructor(){this.$tb=0;this.correlationId=this.Dlb=null;this.Qmb=0;this.HAb=this.B0c=this.eU=this.mWa=!1;this.suggestion=this.qQ=this.h2a=this.XQa=this.tPb=this.i2a=this.n6e=null;this.c_=T.a.empty}NWe(){this.$tb=0;this.correlationId=this.Dlb=null;this.c_=T.a.empty;this.Qmb=0;this.HAb=this.B0c=this.eU=this.mWa=!1;this.qQ=this.h2a=this.XQa=this.tPb=this.i2a=this.n6e=null}}Object(r.a)(Tm,"FixItContext",null,[779]);var Nh=d(968),ym=d(1002),sl=d(868),jf=d(936);class pk{constructor(u,
P,la,Ba,Sa,pb,Vb,Bc,Yc,gd){this.ia=u;this.ta=P;this.Eb=la;this.Ic=Ba;this.wj=Sa;this.Rf=pb;this.yHb=Vb;this.yJ=Bc;this.Mc=Yc;this.Ud=gd;this.Gt()}Gt(){this.yHb.A_b(Object(z.a)(this,this.OH,"onEvent"));this.Rf.FI(Object(z.a)(this,this.OH,"onEvent"));this.Mc.CCa(Object(z.a)(this,this.OH,"onEvent"));this.Mc.HC(Object(z.a)(this,this.OH,"onEvent"));this.Ic.Bgi(Object(z.a)(this,this.Pbh,"onSuggestionReceived"));this.Ic.kJc(Object(z.a)(this,this.uoa,"onUndoRedo"))}dispose(){this.Ic.$7k(Object(z.a)(this,
this.Pbh,"onSuggestionReceived"));this.Ic.fpd(Object(z.a)(this,this.uoa,"onUndoRedo"))}Pbh(u,P){if(u=this.ta.Ba)if(P.slideId.equals(u.Db))if(this.wj.correlationId!==P.correlationId)L.a.J(578937806,829,50,"FixItManager::OnSuggestionReceived - ignore result from different correlation. expected correlation: {0}; received correlation: {1}",this.wj.correlationId,P.correlationId);else if(u=pk.c3d(P.WDa),u.SlideSuggestion)this.wj.tPb||(this.wj.tPb=new Date),P=Object.assign(new Gl,{SuggestionCid:u.SlideSuggestion.SlideId.Cid,
SuggestionSid:u.SlideSuggestion.SlideId.Sid,CorrelationId:P.correlationId,ActiveSlideCid:Object(S.a)(118,this.ta.Ba).cid,ActiveSlideSid:Object(S.a)(118,this.ta.Ba).sid}),this.ia.Ka(tb.a.ktb,2,P);else switch(this.ia.Ka(tb.a.D0a,2,dh.a.noSuggestion),u.ResponseDescription){case "Invalid request":this.Ud.cta(bl.a.Oh(122),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItInvalidRequest);break;case "No suggestion":this.Ud.cta(bl.a.Oh(132),0,ResourceStrings.errorTitle_PowerpointEditingStandard,
ResourceStrings.errorMessage_FixItNoSuggestion);break;default:this.Ud.cta(bl.a.Oh(134),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItTryAgain)}else L.a.J(578937808,829,50,"FixItManager::OnSuggestionReceived - current slide node is different to suggestion slide node. CorrelationId:{0}",P.correlationId)}LQ(u){this.wj.correlationId&&u!==tb.a.ktb&&this.ia.Ka(tb.a.D0a,2,dh.a.GRb+this.yJ.t6(u))}C9b(u,P,la){if(this.wj.correlationId&&la&&P===tb.a.ktb){this.wj.c_=
T.a.empty;la=this.ta.presentation;const Ba=this.Eb.xd(7,void 0,void 0,void 0,!0);try{Ba.hc(la),Ba.fd=P,la.removeProperty(Zb.a.PDa)}finally{Ba&&Ba.dispose()}this.ia.Ka(tb.a.D0a,2,dh.a.GRb+this.yJ.t6(u))}}uoa(u,P){this.C9b(P.actionId,P.y8e,P.Tcb)}OH(u,P){u=!1;let la="";if(Object(Mh.a)(Nh.a,P)){L.a.J(578937802,829,50,"FixItManager::OnSessionEnding. Correlation={0}, Reason={1}",this.wj.correlationId,No.a[Object(S.a)(Nh.a,P).GD]);if(1===Object(S.a)(Nh.a,P).GD||3===Object(S.a)(Nh.a,P).GD)u=!0;la=dh.a.Lrd}else Object(Mh.a)(ym.a,
P)?(L.a.J(578937800,829,50,"FixItManager::OnSessionRehydrated"),u=!0,la=dh.a.Y4k):Object(Mh.a)(sl.a,P)?(u=!0,la=dh.a.slideNavigation):Object(Mh.a)(jf.a,P)&&Object(S.a)(jf.a,P).dBb&&this.LQ(Object(S.a)(jf.a,P).actionId);u&&this.wj.correlationId&&this.ia.Ka(tb.a.D0a,2,la);this.Nck()}Nck(){0<this.wj.$tb&&(L.a.J(574166159,829,50,"FixItActor::HandleQueryFixIt - FixIt button is enabled: {0}",this.wj.$tb),this.wj.$tb=0)}static c3d(u){let P=null;try{P=cd.a(u)}catch(la){L.a.J(578937804,829,10,"FixItManager::DeserializeSuggestionResponse - parsing suggestionResults failed")}return P}}
Object(r.a)(pk,"FixItManager",null,[778,107]);var qk=d(1057),yk=d(16),rk;(function(u){u[u.seen=0]="seen";u[u.keep=1]="keep";u[u.drillIn=2]="drillIn"})(rk||(rk={}));Object(r.b)("IdeasCardAction",rk);var zk;(function(u){u[u.designer=0]="designer";u[u.makeItVisual=1]="makeItVisual";u[u.editor=2]="editor";u[u.UNKNOWN=3]="UNKNOWN"})(zk||(zk={}));Object(r.b)("IdeasCardType",zk);class hq{constructor(u,P){this.Fva=null;this.zic=!1;this.ia=u;this.la=P;this.ia.ya(tb.a.ideasPaneOpened,ib.a.application,Object(z.a)(this,
this.DBj,"handleIdeasPaneOpen"));this.ia.ya(tb.a.Yge,ib.a.application,Object(z.a)(this,this.CBj,"handleIdeasPaneClose"));this.ia.ya(tb.a.tig,ib.a.application,Object(z.a)(this,this.Yeg,"handleIdeasKeep"));this.ia.ya(tb.a.uig,ib.a.application,Object(z.a)(this,this.bfe,"handleIdeasSee"));this.ia.ya(tb.a.zig,ib.a.application,Object(z.a)(this,this.bfe,"handleIdeasSee"));this.ia.ya(tb.a.Aig,ib.a.application,Object(z.a)(this,this.afe,"handleIdeasDrillIn"));this.ia.ya(tb.a.xig,ib.a.application,Object(z.a)(this,
this.Yeg,"handleIdeasKeep"));this.ia.ya(tb.a.yig,ib.a.application,Object(z.a)(this,this.bfe,"handleIdeasSee"));this.ia.ya(tb.a.vig,ib.a.application,Object(z.a)(this,this.afe,"handleIdeasDrillIn"));this.ia.ya(tb.a.wig,ib.a.application,Object(z.a)(this,this.afe,"handleIdeasDrillIn"))}DBj(){if(!this.la.pptIdeasContextEnabled)return 2;this.zic=!0;this.PUj()||this.QAl(ua.a.create());return 32}CBj(){if(!this.la.pptIdeasContextEnabled)return 2;this.zic=!1;return 32}Yeg(u){if(!this.la.pptIdeasContextEnabled)return 2;
this.zHl(this.p3d(u));return 32}bfe(u){if(!this.la.pptIdeasContextEnabled)return 2;this.Qwd(this.p3d(u));return 32}afe(u){if(!this.la.pptIdeasContextEnabled)return 2;this.xHl(this.p3d(u));return 32}p3d(u){switch(u){case tb.a.tig:case tb.a.uig:case tb.a.vig:u=0;break;case tb.a.zig:case tb.a.Aig:u=1;break;case tb.a.xig:case tb.a.yig:case tb.a.wig:u=2;break;default:u=3}return u}QAl(){this.la.pptIdeasContextEnabled&&(this.Fva=new qk.a)}Qwd(u){this.la.pptIdeasContextEnabled&&this.zic&&3!==u&&this.Fva&&
!this.Fva.any(P=>P.key===u)&&this.Fva.add(new yk.a(u,0))}zHl(u){this.zic&&3!==u&&this.Fva&&this.Fva.add(new yk.a(u,1))}xHl(u){this.zic&&3!==u&&this.Fva&&this.Fva.add(new yk.a(u,2))}PUj(){return!!this.Fva&&0<this.Fva.length}}Object(r.a)(hq,"IdeasContext",null,[777]);class ti{constructor(){this.Jy=this.Iy=null;this.jD=this.Ix=0}}Object(r.a)(ti,"ImageLocationInfo",null,[]);var pn=d(443);class wo{}Object(r.a)(wo,"ImageToTableRequest",null,[]);class tl{}tl.Vig="ImageToTableTile";tl.Tig="ImageToTable.Request";
tl.Uig="ImageToTable.Response";Object(r.a)(tl,"ImateToTableAugmentationSchemaNames",null,[]);class ul{constructor(){this.T0=this.o0=null}get CG(){return"ImageToTableALWorkflow"}get proto(){return""}get Gtb(){this.o0||(this.o0=Object.assign(new pn.a,{name:"LambdaBefore_ImageToTableAL",inputSchema:tl.Vig,outputSchema:tl.Tig,func:Object(z.a)(this,this.$cb,"lambdaBeforeFunc")}));return this.o0}get Vsb(){return null}get SLb(){this.T0||(this.T0=Object.assign(new pn.a,{name:"LambdaRemote_ImageToTableAL",
inputSchema:tl.Tig,outputSchema:tl.Uig,func:null}));return this.T0}$cb(u,P,la){u=Object.assign(new wo,{image:u.image});la(u)}}Object(r.a)(ul,"ImageToTableALWorkflow",null,[798]);class Ak{constructor(){this.html=this.processId=this.errorDescription=null;this.errorCode=this.shapeId=this.slideId=0}}Object(r.a)(Ak,"ImageToTableALv2ResponseWrapper",null,[]);class Ek{constructor(){this.sessionId=null;this.shapeId=this.slideSid=0;this.image=this.qdc=null}}Object(r.a)(Ek,"ImageToTableTile",null,[]);class In{constructor(u,
P,la,Ba,Sa,pb,Vb,Bc,Yc,gd,Td){this.ia=u;this.kb=P;this.$b=la;this.el=Ba;this.tA=Sa;this.Sb=Vb;this.xk=Bc;this.Ote=Yc;this.Pma=gd;this.la=Td}initialize(){this.ia.ya(tb.a.EPe,ib.a.application,Object(z.a)(this,this.Deg,"handleConvertImageToTable"));this.ia.ya(tb.a.NPe,ib.a.application,Object(z.a)(this,this.Hfg,"handleReplaceImageWithHtmlTable"));this.el.FI(Object(z.a)(this,this.YB,"onActiveSlideChanged"));this.Ote.execute(u=>{const P=new ul;u.registerSimpleRemoteWorkflow(P.CG,P.Gtb,P.SLb,P.Vsb);u.addEventHandler(tl.Uig,
Object(z.a)(this,this.GBj,"handleImageToTableALResults"));u.VZ("AugLoop_ImageToTable_DetectedHtmlTableAnnotation");u.Moa("AugLoop_ImageToTable_DetectedHtmlTableAnnotation",Object(z.a)(this,this.MQ,"handleAnnotationEvent"))})}dispose(){this.ia.iK(tb.a.EPe,ib.a.application,Object(z.a)(this,this.Deg,"handleConvertImageToTable"));this.ia.iK(tb.a.NPe,ib.a.application,Object(z.a)(this,this.Hfg,"handleReplaceImageWithHtmlTable"));this.el.s6(Object(z.a)(this,this.YB,"onActiveSlideChanged"))}YB(){this.Pma.close()}Deg(u,
P,la){if(!this.la.pptSuggestedActionImageToTableEnabled)return 16;if(1===la)return 32;u=this.kb.Xd();if(1!==u.length)return 8;const Ba=this.Pma.AJk();if(!Ba)return L.a.J(512496449,829,15,"[ImageToTableActor::HandleConvertImageToTable] Failed to open the taskpane"),8;const Sa=u[0];this.la.dhh&&(this.Pma.$jl(Ba,Sa.slideSid,Sa.get_shapeId(),In.X0d(Sa)),this.Pma.A8g(Ba));this.Ote.execute(pb=>{pb.vRl(Sa.slideCid,Sa.slideSid,Sa.get_shapeId(),Vb=>{this.Zeg(Ba,Sa,Vb)},()=>{this.Zeg(Ba,Sa,null);return!0})});
return 32}MQ(u){if(u&&"errorDescription"in u&&"parentPath"in u&&"errorCode"in u){var P=new Ak,la=u.errorDescription.split(";");P.errorDescription=la[0].split(":")[1];P.processId=la[1].split(":")[1];P.errorCode=u.errorCode;L.a.J(512496448,829,50,"ImageToTable AL Results received. ProcessId: {0}, ErrorCode: {1}, ErrorDescription: {2}",P.processId,P.errorCode,P.errorDescription);la=u.parentPath[1].split("|");P.slideId=Number.parseInvariant(la[0]);P.shapeId=Number.parseInvariant(la[2]);P.html=u.html;
this.Pma.Yjl(P);this.Pma.z8g()}}Zeg(u,P,la){if(la&&la.ImgData)if(this.la.dhh)this.Pma.Zjl(u,la.ImgData),this.Pma.z8g();else{const Ba=In.X0d(P),Sa=Object.assign(new Ek,{sessionId:u,slideSid:P.slideSid,shapeId:P.get_shapeId(),qdc:Ba,image:la.ImgData});this.Ote.execute(pb=>{pb.submit(tl.Vig,Sa)});this.Pma.A8g(u)}else this.Pma.bEk(u)}GBj(u,P,la,Ba){L.a.J(512496419,829,50,"ImageToTable AL Results received. ProcessId: {0}, ErrorCode: {1}, ErrorDescription: {2}",Ba.processId,Ba.errorCode,Ba.errorDescription);
this.Pma.ZBk(P,Ba)}Hfg(u,P,la,Ba,Sa){u=this.Sb.eFa(Sa.slideSid);if(!u)return 8;la=(P=u.GQ(Sa.shapeId))?In.X0d(P):Sa.qdc;if(!la)return 8;L.a.J(512496418,829,50,"Replacing image with html table. Shape id: {0}",P.get_shapeId());Sa=this.xk.f1d(!1,u.cid,u.sid,!1,la.Iy,la.Jy,la.Ix,la.jD,u.zs()+1,Sa.oHh,"");this.tA.zT([Sa],u,0,null,P);this.$b.rw(u,"ImageToTable");return 32}static X0d(u){return Object.assign(new ti,{Iy:u.Iy,Jy:u.Jy,Ix:u.Ix,jD:u.jD})}}Object(r.a)(In,"ImageToTableActor",null,[]);class Il{constructor(u){this.shapeId=
this.slideId=0;this.ihe=null;this.W$e=0;this.gge=!1;this.vnc=null;this.e2c=!1;this.BZc=this.mhe=this.n7g=this.Qch=null;this.sessionId=u}}Object(r.a)(Il,"ImageToTableConversionContext",null,[]);class Tj{constructor(){this.shapeId=this.slideSid=0;this.oHh=this.qdc=null}}Object(r.a)(Tj,"ReplaceImageWithHtmlTableData",null,[]);class ao{constructor(u,P,la,Ba){this.ia=u;this.Oc=P;this.Ea=la;this.$Ce=Ba;this.q$=null}initialize(){this.Oc.execute(u=>{u.cJc(Object(z.a)(this,this.A9g,"onFirstPartyAddInHidden"))});
this.$Ce.aTd(Object(z.a)(this,this.ifg,"handleMessage"))}dispose(){this.Oc.execute(u=>{u.Z7k(Object(z.a)(this,this.A9g,"onFirstPartyAddInHidden"))});this.$Ce.voh(Object(z.a)(this,this.ifg,"handleMessage"))}AJk(){this.close();const u=new Il(ua.a.create().toString());u.Qch=new Promise(la=>{u.n7g=()=>{la(u.sessionId)}});const P={};P.ZA=ResourceStrings.L_DataFromPicturePaneTitle;P.assetId="FA000000050";P.c6=()=>{this.mib(u)};P.nonPersistedSettings={["SessionID"]:u.sessionId};P.sourceLocationOverrideResourceId=
this.Ea.pptImageToTableSourceLocationId;return 32===this.ia.Ka(tb.a.Oga,2,P)?(this.q$=u,this.q$.sessionId):this.q$=null}close(){this.wZd(this.q$)}mib(u){L.a.J(509208392,375,50,"[ImageToTablePane] Taskpane rendered. SessionId = {0}",u.sessionId);const P=this.Oc.instance.zQ("FA000000050");if(P&&P.settings&&"SessionID"in P.settings){var la;({Nu:la}=cd.d(P.settings.SessionID)).returnValue&&(u.sessionId===la?(u.vnc=P.instanceId,L.a.J(509208391,375,50,"[ImageToTablePane] Taskpane rendered. InstanceId = {0}",
P.instanceId)):L.a.J(509208390,375,50,"[ImageToTablePane] Failed to find the taskpane"))}}wZd(u){u&&u.vnc&&(u.e2c=!0,this.ia.Ka(tb.a.Vub,2,u.vnc))}$jl(u,P,la,Ba){if(u=this.Xxb(u))u.slideId=P,u.shapeId=la,u.ihe=Ba}Yjl(u){const P=this.q$;P&&P.slideId===u.slideId&&P.shapeId===u.shapeId&&(this.q$.BZc=u)}Zjl(u,P){if(u=this.Xxb(u))u.mhe=P}A8g(u){const P=this.Xxb(u);P&&(P.W$e=window.setTimeout(()=>{this.lAj(P)},this.Ea.pptImageToTableALWorkflowTimeoutMs))}ZBk(u,P){if(u&&P){var la=this.Xxb(u.sessionId);if(la&&
!la.gge)if(la.slideId=u.slideSid,la.shapeId=u.shapeId,la.ihe=u.qdc,window.clearTimeout(la.W$e),0===P.errorCode){const Ba={};Ba.tableHtml=P.html;Ba.imageData=u.image;this.sendMessage(la.sessionId,Ba)}else this.Ard(u.sessionId,"Failed to convert image to table")}}z8g(){const u=this.q$;if(u&&!u.gge&&u.BZc&&u.mhe)if(window.clearTimeout(u.W$e),0===u.BZc.errorCode){const P={};P.tableHtml=u.BZc.html;P.imageData=u.mhe;this.sendMessage(u.sessionId,P)}else this.Ard(u.sessionId,"Failed to convert image to table")}bEk(u){this.Ard(u,
"Failed to render the image shape")}lAj(u){u.gge=!0;this.Ard(u.sessionId,"Failed to convert image to table using AL")}ifg(u,P){P=P.message;(u=this.Xxb(P.session_id))&&!u.e2c&&("ACK"===P.cmd_type?(L.a.J(509208389,375,50,"[ImageToTablePane::MessageReceivedHandler] ACK message received.",P.cmd_type),u.n7g()):"cancel"===P.cmd_type?(L.a.J(509208388,375,50,"[ImageToTablePane::MessageReceivedHandler] Cancel message received.",P.cmd_type),this.wZd(u)):"insert_html"===P.cmd_type?(L.a.J(509208387,375,50,"[ImageToTablePane::MessageReceivedHandler] Insert message received.",
P.cmd_type),P=Object.assign(new Tj,{slideSid:u.slideId,shapeId:u.shapeId,qdc:u.ihe,oHh:P.parameters}),this.wZd(u),this.ia.Ka(tb.a.NPe,2,P)):L.a.J(509208386,375,15,"[ImageToTablePane::MessageReceivedHandler] Unknown message received. Message type: {0}",P.cmd_type))}Ard(u,P){this.sendMessage(u,{["errorMessage"]:P})}sendMessage(u,P){const la=this.Xxb(u);la&&la.sessionId===u&&la.Qch.then(()=>{this.$Ce.sendMessage(la.vnc,P)})}Xxb(u){return u&&this.q$&&this.q$.sessionId===u?this.q$:null}A9g(u,P){P&&this.q$&&
P.instanceId===this.q$.vnc&&(this.q$=null)}}Object(r.a)(ao,"ImageToTablePane",null,[781]);class Jn extends Sys.EventArgs{constructor(u){super();this.message=u}}Object(r.a)(Jn,"ImageToTablePaneMessageReceivedArgs",Sys.EventArgs,[]);class zm{constructor(u){this.xa=new Si.a;this.Ea=u}aTd(u){this.xa.addHandler("ImageToDocPaneMessageReceived",u)}voh(u){this.xa.removeHandler("ImageToDocPaneMessageReceived",u)}initialize(){try{window.addEventListener?window.addEventListener("message",Object(z.a)(this,this.vlc,
"messageReceivedHandler"),!1):-1<window.navigator.userAgent.indexOf("MSIE")&&window.attachEvent?window.attachEvent("onmessage",Object(z.a)(this,this.vlc,"messageReceivedHandler")):L.a.J(593867334,375,10,"[ImageToTablePane::Initialize] Failed to subscribe to onmessage event of window")}catch(u){L.a.J(593867332,375,10,"[ImageToTablePane::Initialize] Failed to subscribe to onmessage event of window with exception, message: {0}, stack: {1}",u.message,u.stack)}}sendMessage(u,P){const la={["imageToTablePaneWildcard"]:"."};
for(const Ba of Object.keys(P))la[Ba]=P[Ba];OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(u,"onCustomMessage",la,Ba=>{Ba&&L.a.J(593867330,375,15,"Couldn't deliver the message to ImageToDoc pane, status: {0}.",Ba)})}vlc(u){if(u&&this.zbc(u.origin)){var P;({Nu:P}=cd.d(u.data)).returnValue&&P&&(u=Object(S.a)(Object,P),"."===u.imageToTablePaneWildcard&&this.xa.raiseEvent("ImageToDocPaneMessageReceived",new Jn(u)))}}zbc(u){return u&&u.length&&"null"!==u?u===this.Ea.pptImageToTableAllowedOrigin:
!1}}Object(r.a)(zm,"ImageToTablePaneMessenger",null,[780]);var xo=d(1125);class yo{constructor(){this.Scenario=0;this.ShapeIds=null;this.SlideSid=this.SlideCid=0}}Object(r.a)(yo,"ImageTransformInfo",null,[]);class Am{constructor(u,P,la,Ba){this.ia=u;this.kb=P;this.ta=la;this.Ic=Ba}initialize(){this.Ic.gfi(Object(z.a)(this,this.Obh,"onSuggestedActionClick"))}dispose(){this.Ic.h7k(Object(z.a)(this,this.Obh,"onSuggestedActionClick"))}Obh(u,P){if((u=P.card)&&this.ta.Ba){var la=this.ta.Ba.Uj(),Ba=[];P=
[];for(var Sa of la)for(const pb of u.Selects)if(pb.Id===Sa.get_shapeId()){Array.add(Ba,Sa);Array.add(P,Sa.get_shapeId());break}this.kb.au();this.kb.nh();this.kb.d1a(Ba,!0);if(4===u.Type){if(Sa=this.ta.presentation)Sa.Tzb=Object.assign(new yo,{Scenario:u.Scenario,SlideSid:this.ta.Ba.sid,SlideCid:this.ta.Ba.cid,ShapeIds:P})}else this.ia.processAction(xo.a.DLc(u.ExecutionActionName),2)}}}Object(r.a)(Am,"SuggestedActionsHandler",null,[]);class zo{constructor(){this.K=null;this.KO=!1}get name(){return"PowerPointWebEditor.Designer"}Yb(u){this.K=
u;this.K.register(771,"PowerPointWebEditor.IDesignerView").ma().oa(()=>new $n(this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IDesignerPane"),this.K.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("Box4.IViewManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("Common.IPointerInputManager"),
this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")));this.K.register(772,"PowerPointWebEditor.IDesignerPane").ma().oa(()=>new hi(this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("Common.IClickInputManager"),
this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.IInboundHelper"),this.K.resolve("PowerPointWebEditor.ITaskPaneManager")));this.K.register(773,"PowerPointWebEditor.IDesignerViewHelper").ma().oa(()=>new ue(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPoint.IPathManager"),
this.K.Ia("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")));this.K.register(774,"PowerPointWebEditor.IDesignerManager").ma().oa(()=>new ok(this.K.resolve("PowerPointWebEditor.IDesignerView"),this.K.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.Transaction.ITransactionFactory"),
this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.ITaskManager"),this.K.Ia("PowerPointWebEditor.IDesignerServiceProvider"),this.K.Ia("PowerPointWebEditor.IApplyDesignerSuggestions"),this.K.Ia("Common.ISystemInitiatedFeedback")));this.K.register(775,"PowerPointWebEditor.Designer.IDesignerPreviewImageView").ma().oa(()=>new Ok(this.K.resolve("PowerPoint.IBrowserHelperManager"),
this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager")));this.K.register(776,"PowerPointWebEditor.IDesignerContext").ma().oa(()=>new qe(this.K.Ia("PowerPointWebEditor.IDesignerServiceProvider")));this.K.register(777,"PowerPointWebEditor.Infrared.IIdeasContext").ma().oa(()=>new hq(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(778,"PowerPointWebEditor.IFixItManager").ma().oa(()=>new pk(this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IFixItContext"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),this.K.resolve("PowerPointWebEditor.IActionNameResolver"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler")));
this.K.register(779,"PowerPointWebEditor.IFixItContext").ma().oa(()=>new Tm);(this.KO=this.K.resolve("PowerPointWebEditor.IApplicationContext").rd.yg)&&this.K.register(ql.a,"PowerPointWebEditor.PodsInfoSender").ma().oa(()=>new ql.a(v.AFrameworkApplication.Me,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("Common.ITaskManager"),
this.K.resolve("Common.IAppSettingsManager")));this.K.register(In,"PowerPointWebEditor.Designer.ImageToTableActor").ma().oa(()=>new In(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.IGraphTransactionHelper"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IShapeEditor"),this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePane"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(780,"PowerPointWebEditor.Designer.IImageToTablePaneMessenger").ma().oa(()=>new zm(this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(781,"PowerPointWebEditor.Designer.IImageToTablePane").ma().oa(()=>
new ao(this.K.resolve("Common.IActionManagerExtended"),this.K.Ia("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePaneMessenger")));this.K.register(Am,"PowerPointWebEditor.Designer.SuggestedActionsHandler").ma().oa(()=>new Am(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.View.IViewEventSource")))}init(){const u=this.K.resolve("Common.IAppSettingsManager");u.ff(()=>{if(u.ka("248")){this.KO&&this.K.resolve("PowerPointWebEditor.PodsInfoSender");var P=this.K.resolve("PowerPointWebEditor.IDesignerView");const la=w.a.instance.resolve("PowerPointWebEditor.IDesignerPane").va;P.OCa(la);P.H$b();P=null;if(u.ka("1034")&&(P=this.K.resolve("Common.App.OAuth.IOAuthManager"))){const Ba=new Date;P.gI(u.Ha("1043"),u.Ha("1035")).then(Sa=>{const pb=
+new Date-+Ba;Sa.IsSuccess?L.a.J(512262863,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Latency: "+pb):(L.a.J(512262862,829,15,"PPTWebEditorDesignerPackage::Init Failed to get AAD token with error: "+Sa.ErrorCode+": "+Sa.ErrorMessage),L.a.J(512262861,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Failed Latency: "+pb))}).catch(Sa=>{L.a.J(512262860,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Failed Latency: "+(+new Date-+Ba));L.a.J(512262859,
829,15,"PPTWebEditorDesignerPackage::Init - Token retrival failed:{0}",Sa)})}P=new Zn(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IClipboardDataHelper"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IDesignerPane"),this.K.resolve("PowerPointWebEditor.IDesignerView"),
this.K.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.K.resolve("PowerPointWebEditor.IDesignerManager"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
this.K.resolve("PowerpointPresence.IPresenceEventHandlers"),this.K.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),this.K.resolve("PowerPointWebEditor.Infrared.IIdeasContext"),this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.K.Ia("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"),
this.K.resolve("PowerPointWebEditor.IPresentationReader"),P,this.K.Ia("PowerPointWebEditor.IAgendaMetrics"),this.K.Ia("PowerPointWebEditor.AgendaConverter.IAgendaConverterView"));P.vb();P.pe();(new Zg(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.IFixItContext"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IErrorHandler"))).vb();this.K.resolve("PowerPointWebEditor.IApplicationSettings").designerHoverPreviewEnabled&&this.K.resolve("PowerPointWebEditor.Designer.IDesignerPreviewImageView").setup();
this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePaneMessenger").initialize();this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePane").initialize();this.K.resolve("PowerPointWebEditor.Designer.ImageToTableActor").initialize();this.K.resolve("PowerPointWebEditor.Designer.SuggestedActionsHandler").initialize();this.K.resolve("PowerPointWebEditor.IFixItManager")}else L.a.J(512262858,829,50,"Designer setting is disabled")})}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").designerHoverPreviewEnabled&&
this.K.resolve("PowerPointWebEditor.Designer.IDesignerPreviewImageView").dispose();this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePane").dispose();this.K.resolve("PowerPointWebEditor.Designer.ImageToTableActor").dispose();this.K.resolve("PowerPointWebEditor.Designer.SuggestedActionsHandler").dispose();this.K.resolve("PowerPointWebEditor.IFixItManager").dispose()}static main(){m.a.instance.Ac(xc.a(new zo,0))}}Object(r.a)(zo,"PPTWebEditorDesignerPackage",null,[2,3]);class Ae{constructor(){this.K=
null}get name(){return"PowerPointWebEditor.PenMinutes"}Yb(u){this.K=u}init(){const u=this.K.qb("Common.App.PenMinutesManager.IPenMinutesManager");u&&u.Sml()}dispose(){}static main(){m.a.instance.Ac(new Ae)}}Object(r.a)(Ae,"PPTWebEditorPenMinutesPackage",null,[2,3]);var hh=d(938);class dm{}Object(r.a)(dm,"TextToSmartArtSuggestionData",null,[]);class pj{constructor(){this.suggestions=[]}}Object(r.a)(pj,"TextToSmartArtSuggestionNotificationData",null,[]);class qc{}qc.w0e="ShapePresence";qc.slideNavigation=
"SlideNavigation";qc.GRb="WebActionId:";qc.gV="SelectionChanged";qc.ytc="ShapePositionChanged";qc.xkb="Retrigger";qc.SJe="NoSuggestions";qc.Pdk="LowSuggestions";qc.ahd="NewSession";qc.Fyl="SlideShowStarted";qc.serverError="ServerError";qc.RKf="ClientSuggestionTimeOut";Object(r.a)(qc,"ReplaceObjectResetReason",null,[]);class Lj{constructor(u,P,la,Ba,Sa,pb,Vb,Bc,Yc,gd,Td,Re,Uf,Ef,Oh,ek,je,Qf,Jg){this.nYa=this.Sze=this.Feb=!1;this.pa=u;this.Fa=P;this.ta=la;this.$b=Ba;this.n$=Sa;this.Rf=pb;this.ia=Vb;
this.Dz=Bc;this.FIa=Yc;this.Ez=gd;this.yHb=Re;this.mna=Uf;this.Dcd=Ef;this.Ic=Oh;this.yJ=ek;this.wb=je;this.Vb=Qf;this.tu=Td;this.QXa=Jg;this.Ar=!1}get Fh(){return this.Ar}setup(){this.Fh||(this.Gt(),this.Sze=2===this.Vb.mode,this.Ar=!0)}Gt(){this.pa.fE(Object(z.a)(this,this.QH,"onSelectionChanged"));this.yHb.A_b(Object(z.a)(this,this.iIe,"markedUndo"));this.Rf.FI(Object(z.a)(this,this.YB,"onActiveSlideChanged"));this.mna.x7a(Object(z.a)(this,this.l1,"onSlidePresenceChanged"));this.Ic.$gi(Object(z.a)(this,
this.PMe,"onReplaceObjectResponse"));this.FIa.ahi(Object(z.a)(this,this.QMe,"onReplaceObjectViewDragEnd"));this.n$.B_b(Object(z.a)(this,this.LKe,"onApplyReplaceObjectBlockingStateChanged"));this.Rf.gTd(Object(z.a)(this,this.Vwc,"updateEditState"));this.Vb.GI(Object(z.a)(this,this.zu,"onAppFrameModeSwitched"));this.Ic.bzf(Object(z.a)(this,this.L7g,"onApplyReplaceObjectSuggestionBeforeSelectionRemoval"));this.Ic.azf(Object(z.a)(this,this.K7g,"onApplyReplaceObjectSuggestionAfterSelectionRemoval"));this.Ic.kJc(Object(z.a)(this,
this.uoa,"onUndoRedo"))}dispose(){this.Fh&&(this.pa.Xoa(Object(z.a)(this,this.QH,"onSelectionChanged")),this.yHb.sVe(Object(z.a)(this,this.iIe,"markedUndo")),this.Rf.s6(Object(z.a)(this,this.YB,"onActiveSlideChanged")),this.mna.IVe(Object(z.a)(this,this.l1,"onSlidePresenceChanged")),this.Ic.p8k(Object(z.a)(this,this.PMe,"onReplaceObjectResponse")),this.FIa.q8k(Object(z.a)(this,this.QMe,"onReplaceObjectViewDragEnd")),this.n$.apd(Object(z.a)(this,this.LKe,"onApplyReplaceObjectBlockingStateChanged")),
this.Vb.IY(Object(z.a)(this,this.zu,"onAppFrameModeSwitched")),this.Rf.vVe(Object(z.a)(this,this.Vwc,"updateEditState")),this.Ic.yoh(Object(z.a)(this,this.L7g,"onApplyReplaceObjectSuggestionBeforeSelectionRemoval")),this.Ic.xoh(Object(z.a)(this,this.K7g,"onApplyReplaceObjectSuggestionAfterSelectionRemoval")),this.Ic.fpd(Object(z.a)(this,this.uoa,"onUndoRedo")),this.Ar=!1)}N1a(u){return this.lne()?this.Dcd.wxc(u):!1}selectShape(u){u&&this.pa.selectShape(u,!1)}x1c(u){switch(u){case tb.a.VQa:case tb.a.lJe:case tb.a.Flc:case tb.a.Glc:case tb.a.Hlc:case tb.a.Ilc:case tb.a.BJa:return!0;
default:return!1}}lne(){return this.Feb&&this.Sze}weh(u,P){const la=[];if(lb.a.Xa(u))return la;u=u.split(";");if(u.length<P)return L.a.J(37065230,829,10,"BaseReplaceObjectManager::ParseSuggestions - suggestionCount:{0}, resultLength:{1}",P,u.length),la;for(let Ba=0;Ba<P;++Ba){const Sa=u[Ba].split(":");if(3!==Sa.length)throw P=String.format("Invalid format of suggestion item. Index: {0}, SuggestionItem: {1}",Ba,u[Ba]),L.a.J(37065232,829,50,"BaseReplaceObjectManager::ParseSuggestions - {0}",P),Error.create(P);
const pb=hh.a.Zuj(Number.parseInvariant(Sa[1]));Array.add(la,Object.assign(new dm,{index:Sa[0],labelText:lb.a.Xa(pb)?ResourceStrings.L_SmartArt:pb,imageData:this.MVc(Sa[2])}))}return la}L7g(){this.nYa=!0}K7g(){this.nYa=!1}uoa(u,P){this.LQ(P.actionId)}MVc(u){return lb.a.Xa(u)?null:"data:image/png;base64,"+u}zu(u){L.a.J(36544854,829,50,"BaseReplaceObjectManager::OnAppFrameModeSwitched, frame mode switched to :{0}",u.mode);this.Sze=2===u.mode}Vwc(){this.Feb||L.a.J(36544856,829,50,"BaseReplaceObjectManager::UpdateEditState, updating edit state");
this.Feb=!0}DIb(u,P,la,Ba){this.QXa.execute(Sa=>{const pb=Object.assign(new pj,{correlationId:u,shapeId:P,suggestions:la});Sa.notifyTextToSmartArtSuggestion(Ba,pb)})}Ifg(u,P,la){if(P.wE)if(P.N9&&0!==u.jLa)L.a.J(38115480,829,10,"HandleReplaceObjectResponse - first reponse should have notification type : Normal. NotificationType: {0}",u.jLa);else{if(0===u.jLa){if(0>=u.Dea){L.a.J(38115482,829,50,"HandleReplaceObjectResponse - Reponse failed. CorrelationId {0}",u.correlationId);this.closeSession(P,qc.SJe);
return}if(u.Dea<la.replaceObjectMinRequiredSuggestions){L.a.J(38115484,829,50,"HandleReplaceObjectResponse - not enough suggestions returned. CorrelationId {0}",u.correlationId);this.closeSession(P,qc.Pdk);return}P.N9=!1;P.suggestions=this.weh(u.WDa,u.Dea);P.sV=u.Dea;L.a.J(38115486,829,50,"HandleReplaceObjectResponse - suggestions returned: {0}. CorrelationId {1}",P.sV,u.correlationId)}else if(1===u.jLa){if(lb.a.Xa(u.WDa)){L.a.J(38115488,829,10,"HandleReplaceObjectResponse - empty suggestions. CorrelationId {0}",
u.correlationId);return}P.suggestions=this.weh(u.WDa,u.Dea);P.$Pb=new Date;la.powerPointIdeasIsEnabled&&this.DIb(u.correlationId,P.shapeId,P.suggestions,mg.a.success)}else 2===u.jLa&&(P.Jqe=!1,P.shapeId=u.shapeId,this.DIb(P.correlationId,u.shapeId,P.suggestions,mg.a.success));la=P.shape;P.slide&&P.slide.isConnected&&la&&la.isConnected&&this.tu.vGa(la)&&this.lne()&&(1===u.jLa?this.Ez.vmh(P.correlationId):this.Ez.uud(la))}else L.a.J(38115478,829,15,"HandleReplaceObjectResponse - No session active. Reponse CorrelationId: {0}",
u.correlationId)}}Object(r.a)(Lj,"BaseReplaceObjectManager",null,[765,797]);class qn{}qn.none="";qn.ytc="ShapePositionChanged";Object(r.a)(qn,"ReplaceObjectRetriggerReason",null,[]);class Fk{}Fk.selectShape="SelectShape";Fk.xkb="Retrigger";Fk.noi="AugLoopRetrigger";Fk.moi="AugLoopDefault";Object(r.a)(Fk,"ReplaceObjectTrigger",null,[]);var Um=d(518);class ff extends Lj{constructor(u,P,la,Ba,Sa,pb,Vb,Bc,Yc,gd,Td,Re,Uf,Ef,Oh,ek,je,Qf,Jg,Ei,wj,Ti,pf){super(Bc,la,Ba,Sa,pb,Vb,Yc,gd,Td,Re,Uf,Oh,ek,je,Qf,
Ei,wj,Ti,pf);this.mU=u;this.T5c=P;this.dpk=Ef;this.la=Jg;this.dXg=this.la.replaceObjectGrayFloatieInTyping}Gt(){this.la.replaceObjectUseClientAL?this.T5c.execute(u=>{u.addEventHandler("ShapeTextConvertable",Object(z.a)(this,this.Cih,"processShapeTextConvertibleClientAL"))}):this.mU.execute(u=>{u.addEventHandler("ShapeTextConvertable",Object(z.a)(this,this.hRe,"processShapeTextConvertible"))});this.Ic.sii(Object(z.a)(this,this.Tjd,"onSlideShowStarted"));super.Gt()}dispose(){this.Fh&&(this.la.replaceObjectUseClientAL?
this.T5c.execute(u=>{u.removeEventHandler("ShapeTextConvertable",Object(z.a)(this,this.Cih,"processShapeTextConvertibleClientAL"))}):this.mU.execute(u=>{u.removeEventHandler("ShapeTextConvertable",Object(z.a)(this,this.hRe,"processShapeTextConvertible"))}),this.Ic.d9k(Object(z.a)(this,this.Tjd,"onSlideShowStarted")));super.dispose()}hRe(u,P){if(u&&P){try{var la=cd.a(u);var Ba=cd.a(P)}catch(pb){L.a.J(26080646,829,10,"AugmentationLoopReplaceObjectManager::OnSmartArtConvertable - Try parse aug response failed");
return}if(la&&!isNaN(la.sid)&&!isNaN(la.cid)&&!isNaN(la.shapeId)&&this.ta.Ba&&(u=new Date(la.c),L.a.J(34181982,829,50,"ALEvent received: Slide:{0}|{1}, Shape:{2}, TriggerName:{3}, ElapsedTimeInMs:{4}",la.sid,la.cid,la.shapeId,la.t,la.c?(new Date).getTime()-la.c:-1),(P=this.ta.Ba.GQ(la.shapeId))&&(oc.a.contains(this.Fag(),P.get_shapeId())||"activeSlideChanged"===la.t)))if(Ba&&!Ba.isTextConvertible)this.Ez.Toa(P,!0);else{var Sa=this.Dz.e8b(P.get_shapeId());if(Sa&&Sa.Fda&&(Sa=new Um.a(P,Sa.hha),this.ia.Ka(tb.a.vjb,
2,Sa),!Sa.Pua))return;this.N1a(P)&&this.Eka(this.ta.Ba,P,Ba&&Ba.smartArtInfo?Ba.smartArtInfo.length:0,la.t||Fk.moi,qn.none,u)}}}Cih(u,P,la,Ba){P&&Ba&&Ba.ContextId&&Ba.Payload&&this.hRe(Ba.ContextId,Ba.Payload)}Tjd(){this.sZd(qc.Fyl)}QH(u,P){if(!this.Fh)L.a.J(26042393,829,50,"AugmentationLoopReplaceObjectManager::OnSelectionChanged - called before setup");else if(!this.nYa&&(P.XE.length||!this.Fa.Ee||this.Fa.Ee.name!==Ad.a.vg)){u=this.Fag();for(let la of this.Dz)la.wE&&!Array.contains(u,la.shapeId)&&
this.closeSession(la,qc.gV);this.dXg&&!Array.contains(u,this.Ez.jzb)&&this.Ez.Z5k()}}QMe(u,P){this.Fh?(u=this.Dz.e8b(P.shape.get_shapeId()))&&u.wE&&(P=u.shape,this.closeSession(u,qc.ytc),this.N1a(P)&&this.Eka(this.ta.Ba,P,0,Fk.noi,qn.ytc)):L.a.J(26042395,829,50,"AugmentationLoopReplaceObjectManager::OnReplaceObjectViewDragEnd - called before setup")}iIe(u,P){P.dBb&&this.LQ(P.actionId)}YB(){this.sZd(qc.slideNavigation)}l1(u,P){if(P.u9&&P.shapes)for(const la of P.shapes)(u=this.Dz.e8b(la))&&u.wE&&this.closeSession(u,
qc.w0e)}PMe(u,P){(u=this.Dz.qab(P.correlationId))?this.Ifg(P,u,this.la):L.a.J(26042397,829,50,"AugmentationLoopReplaceObjectManager::OnReplaceObjectResponse, No session active. Reponse CorrelationId: {0}",P.correlationId)}LKe(){if(this.Fh)for(let u of this.Dz)u.Tbb&&0===u.Z1&&!this.$b.$c(this.ta.presentation)&&(u.Tbb=!1,this.Ez.Toa(u.shape,!0))}N1a(u){const P=this.Dz.Ewf;return 1<=P?(L.a.J(34223842,829,50,"AugmentationLoopReplaceObjectManager::ShouldGenerateSuggestion, too many floaties[{0}] showing on the slide.",
P),!1):super.N1a(u)}Eka(u,P,la,Ba,Sa,pb=null){try{let Vb=this.Dz.e8b(P.get_shapeId());Vb&&this.closeSession(Vb,qc.ahd);Vb=this.Dz.EOc(u,P.get_shapeId(),Ba,Sa,this.la);Vb.Wvc=pb;Vb.Fda="richEditTextUnicodeChanged"===Ba;this.Ez.Twc(Vb.correlationId);const Bc=this.dpk.mvh(Vb);L.a.J(34144971,829,50,"AugmentationLoopReplaceObjectManager::GenerateSuggestion - CorrelationId:{0}, SlideId:{1}|{2}, ShapeId:{3}, state:{4}",Vb.correlationId,Vb.slide.sid,Vb.slide.cid,Vb.shapeId,Bc);L.a.J(34097054,829,50,"AugmentationLoopReplaceObjectManager::GenerateSuggestion, text can convert to SmartArt, correlation id: {0}, returned suggestion count: {1}, should take suggestion count: {2}, trigger reason: {3}",
Vb.correlationId,la,Math.min(la,this.la.replaceObjectSuggestionMaxCount),Ba);la&&this.la.replaceObjectShowFloatieOnShapeTextConvertibleResponse&&(la=Math.min(la,this.la.replaceObjectSuggestionMaxCount),Vb.suggestions=this.P9i(la),Vb.sV=la,Vb.N9=!1,this.Ez.uud(P));0===Bc&&this.la.powerPointIdeasIsEnabled&&this.DIb(Vb.correlationId,Vb.shapeId,[],mg.a.pending)}catch(Vb){L.a.J(34152522,829,10,"GenerateSuggestion failed!! {0} ",Vb.message)}}P9i(u){const P=Array(u);for(let la=0;la<u;la++)Array.add(P,Object.assign(new dm,
{index:la.toString(),labelText:ResourceStrings.l_Loading,imageData:null}));return P}LQ(u){this.Fh?this.x1c(u)||this.sZd(qc.GRb+this.yJ.t6(u)):L.a.J(26042447,829,15,"AugmentationLoopReplaceObjectManager::HandleAction - called before setup")}vsl(u){if(!this.dXg)return!1;const P=this.pa.Xd();return u.Fda&&Array.contains(P,u.shape)}closeSession(u,P){0===u.Z1&&(P===qc.SJe?this.Ez.Toa(u.shape,!0):u.Fda&&this.Ez.Toa(u.shape,!0,P!==qc.ahd,this.vsl(u)),this.Dz.Q_c(u,P),this.la.powerPointIdeasIsEnabled&&this.DIb(u.correlationId,
u.shapeId,u.suggestions,mg.a.GJa))}sZd(u){for(let P of this.Dz)this.closeSession(P,u)}Fag(){const u=this.pa.Xd(),P=[];u&&u.forEach(la=>{Array.add(P,la.get_shapeId())});return P}}Object(r.a)(ff,"AugmentationLoopReplaceObjectManager",Lj,[]);class Km{constructor(u,P){this.disabled=!1;this.wLg=uc.App.pn;this.la=u;this.wb=P}twh(u){this.disabled=!0;this.wLg=new Date;const P=new O.a(2,1,this.la.replaceObjectGrayFloatieTimeoutInMilliSeconds,()=>{this.disabled&&+new Date-+this.wLg>=this.la.replaceObjectGrayFloatieTimeoutInMilliSeconds&&
u()});this.wb.Hb(P)}kll(u){const P=new O.a(2,1,550,()=>{u()});this.wb.Hb(P)}static CRl(u,P){return 7<=u&&8>=u&&1!==P}}Object(r.a)(Km,"FlyoutAnchorTimer",null,[]);var em=d(373);class bo{constructor(u,P,la,Ba,Sa,pb,Vb,Bc,Yc,gd,Td,Re,Uf,Ef,Oh){this.Ms=null;this.nYa=!1;this.Ic=P;this.pa=u;this.Dz=la;this.ta=Ba;this.Ga=Sa;this.la=pb;this.Ez=Vb;this.ai=Bc;this.tu=Yc;this.mna=gd;this.n$=Td;this.IXa=Re;this.Hkc=Uf;this.yJ=Ef;this.pc=Oh}Gt(){this.Ic.Fgi(Object(z.a)(this,this.R9g,"onIconSuggestionNotification"));
this.pa.fE(Object(z.a)(this,this.QH,"onSelectionChanged"));this.Ic.bzf(Object(z.a)(this,this.J7g,"onApplyIconChunkingSuggestionBeforeSelectionRemoval"));this.Ic.azf(Object(z.a)(this,this.I7g,"onApplyIconChunkingSuggestionAfterSelectionRemoval"));this.Ic.Egi(Object(z.a)(this,this.Q9g,"onIconChanged"));this.mna.x7a(Object(z.a)(this,this.l1,"onSlidePresenceChanged"));this.n$.B_b(Object(z.a)(this,this.cga,"onBlockingStateChanged"));this.Hkc.A_b(Object(z.a)(this,this.kib,"onMarkedUndo"))}u8e(){this.Ic.b8k(Object(z.a)(this,
this.R9g,"onIconSuggestionNotification"));this.pa.Xoa(Object(z.a)(this,this.QH,"onSelectionChanged"));this.Ic.yoh(Object(z.a)(this,this.J7g,"onApplyIconChunkingSuggestionBeforeSelectionRemoval"));this.Ic.xoh(Object(z.a)(this,this.I7g,"onApplyIconChunkingSuggestionAfterSelectionRemoval"));this.Ic.a8k(Object(z.a)(this,this.Q9g,"onIconChanged"));this.mna.IVe(Object(z.a)(this,this.l1,"onSlidePresenceChanged"));this.n$.apd(Object(z.a)(this,this.cga,"onBlockingStateChanged"));this.Hkc.sVe(Object(z.a)(this,
this.kib,"onMarkedUndo"))}dispose(){this.u8e()}setup(){this.Gt()}J7g(){this.nYa=!0}I7g(){this.nYa=!1}Q9g(u,P){P&&this.Ms&&this.Ms.ksc&&this.Ms.slide.sid===P.slideId.sid&&this.Ms.slide.cid===P.slideId.cid&&this.Ms.shapeId===P.shapeId&&this.Ms.F6===P.bZ&&(this.Ms.yYe=P.iconName)}l1(u,P){if(P.u9&&P.shapes&&this.Ms)for(const la of P.shapes)this.Ms.shapeId===la&&this.AW(qc.w0e)}kib(u,P){P.dBb&&!this.x1c(P.actionId)&&this.AW(qc.GRb+this.yJ.t6(P.actionId))}x1c(u){switch(u){case tb.a.VQa:case tb.a.lJe:case tb.a.Flc:case tb.a.Glc:case tb.a.Hlc:case tb.a.Ilc:case tb.a.BJa:return!0;
default:return!1}}cga(){if(this.Ms){const u=this.Ms.shape,P=this.Ga.Gr(u);u&&P&&!this.IXa.$c(P)&&(this.Ms.Tbb=!1,this.Ez.Toa(u,!0),this.Ms.Uvc=new Date,this.Ms.AW(qc.gV))}}QH(){if(!this.nYa){var u=this.Ga.W$a(this.pa.Xd());if(u){if(this.Ms&&this.Ms.wE){if(em.a.xtc(u.WY,this.Ms.WY))return;this.AW(qc.gV)}this.N1a(u)&&this.Eka(this.ta.Ba,u,Fk.selectShape)}else this.Ms&&this.Ms.wE&&this.AW(qc.gV)}}Eka(u,P,la){this.Ms=this.Dz.$Ra(u,P.get_shapeId(),la,"",this.la,P.get_smartArtModelId());this.Ms.N9=!0;this.Ez.Twc(this.Ms.correlationId);
L.a.J(38279303,829,50,"ReplaceIconManager::GenerateSuggestion - CorrelationId:{0}, SlideId:{1}|{2}, ShapeId:{3}, SmartArtSubNodeId:{4}",this.Ms.correlationId,this.Ms.slide.sid,this.Ms.slide.cid,this.Ms.shapeId,this.Ms.F6);const Ba=P.get_smartArtModelId()?this.Ga.Gr(P):P;Ba?this.ai.M9i(u.cid,u.sid,Ba.get_shapeId(),this.tu.fXc(Ba),this.tu.eXc(Ba),P.get_smartArtModelId(),this.Ms.correlationId,la,Object(z.a)(this,this.$Dk,"onIconSuggestionResponseSuccess"),Object(z.a)(this,this.wib,"onTaskFailure")):
L.a.J(38279305,829,15,"Parent ShapeNode of a {0} is null",P.get_smartArtModelId()?"SmartArtSubShape":"NormalShape")}$Dk(u){if(u&&u.SuggestionResult){var P=u.CorrelationId,la=this.Dz.qab(P);if(la)if(la.wE){P=null;try{P=Sys.Serialization.JavaScriptSerializer.deserialize(u.SuggestionResult)}catch(Ba){L.a.J(38625546,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - Deserialize exception: {0}",Ba)}if(P){la.suggestions=this.FMk(P);la.$Pb=new Date;if(la.N9){if(this.Fmg(la)){L.a.J(39184097,829,
15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - client suggestion timeout in {0}, expected in {1}",la.a2b,this.la.pptIconChunkingSuggestionTimeoutMs);this.AW(qc.RKf);return}L.a.J(38279317,829,50,"ReplaceIconManager::OnReplaceObjectResponse, response arrives before notification");la.sV=la.suggestions?la.suggestions.length:0;la.N9=!1;this.Ez.uud(la.shape)}this.Ez.vmh(la.correlationId)}else this.AW(qc.serverError),L.a.J(38279311,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - suggestion result is null")}else L.a.J(38279315,
829,50,"ReplaceIconManager::OnIconSuggestionResponseSuccess, sessio is not active . Selection might change to new shape, Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.Ms?this.Ms.correlationId:"",P);else L.a.J(38279313,829,50,"ReplaceIconManager::OnIconSuggestionResponseSuccess, No session existing. Selection might change to new shape. Reponse CorrelationId: {0}",P)}else this.AW(qc.serverError),L.a.J(38279309,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - response object or reponse suggestionresult is null")}wib(u){this.AW(qc.serverError);
L.a.J(38279319,829,15,"ReplaceIconManager::OnTaskFailure - request failed with response {0}. returning true to avoid ACE",u.HttpStatusCode);return!0}N1a(u){return this.pc.Pn?u.get_smartArtModelId()&&u.get_isSVGBlipFilled()?(u=this.Ga.Gr(u),!!u&&!u.Es):!1:!1}AW(u){this.Ms&&(this.Ez.Toa(this.Ms.shape,!0),this.Dz.Q_c(this.Ms,u),this.Ms=null)}MVc(u){return lb.a.Xa(u)?null:u.startsWith("<svg")?"data:image/svg+xml;charset=utf8,"+encodeURIComponent(u):"data:image/png;base64,"+u}FMk(u){const P=[];if(!u||
!u.length)return P;for(let la=0;la<u.length;++la){const Ba=Object.assign(new dm,{index:u[la].Index.toString(),labelText:u[la].Label,imageData:this.MVc(u[la].Render),renderData:this.MVc(u[la].Replace)});Array.add(P,Ba)}return P}JLi(u,P){const la=[];if(lb.a.Xa(u)||!P)return la;for(var Ba=0;Ba<P;++Ba){var Sa=Object.assign(new dm,{index:Ba.toString(),labelText:"",imageData:null,renderData:null});Array.add(la,Sa)}u=u.split(";");if(u.length-1!==P)return L.a.J(38618200,829,15,"ReplaceIconManager::CreateIconSuggestionsFromNotification, the suggestion counts parsing from suggestion string do not match, expected:{0}, actural:{1} ",
la.length,P),la;for(Ba=0;Ba<P;++Ba)Sa=u[Ba].indexOf(":"),0>Sa?L.a.J(38279321,829,15,"ReplaceIconManager::CreateIconSuggestionsFromNotification, Suggestion string does not contain :"):la[Ba].labelText=u[Ba].substr(Sa+1);return la}EMk(u){let P,la,Ba,Sa;P="";Ba=la=0;Sa=null;if(lb.a.Xa(u))return L.a.J(38279323,829,50,"ReplaceIconManager::ParseIconSuugestionNotification - docValue is null or empty"),{returnValue:!1,correlationId:P,Dea:la,bKe:Ba,suggestions:Sa};const pb=u.split("|");if(4!==pb.length)return L.a.J(38279325,
829,50,"ReplaceIconManager::ParseIconSuugestionNotification - docValue length is not equals to 4, actural:"+u.length),{returnValue:!1,correlationId:P,Dea:la,bKe:Ba,suggestions:Sa};P=pb[0];la=parseInt(pb[1]);Ba=Number.parseInvariant(pb[2]);Sa=this.JLi(pb[3],la);return{returnValue:!0,correlationId:P,Dea:la,bKe:Ba,suggestions:Sa}}R9g(u,P){let la,Ba;if(({correlationId:u,Dea:P,bKe:la,suggestions:Ba}=this.EMk(P.WDa)).returnValue){var Sa=this.Dz.qab(u);if(Sa)if(Sa.wE&&Sa.N9){var pb=Sa.shape;0===la&&(0>=
P?(L.a.J(38279361,829,50,"ReplaceIconManager::OnReplaceObjectResponse, Reponse failed. CorrelationId {0}",u),this.AW(qc.SJe)):this.Fmg(Sa)?(L.a.J(39184137,829,15,"ReplaceIconManager::OnIconSuggestionNotification - client suggestion timeout in {0}, expected in {1}",Sa.a2b,this.la.pptIconChunkingSuggestionTimeoutMs),this.AW(qc.RKf)):(Sa.N9=!1,Sa.sV=P,Sa.suggestions=Ba,L.a.J(38279363,829,50,"ReplaceIconManager::OnReplaceObjectResponse, get response from GetReplaceObject request, correlation id: {0}, suggestion count: {1}",
Sa.correlationId,Sa.sV),this.Ez.uud(pb)))}else L.a.J(38279331,829,50,"ReplaceIconManager::OnIconSuggestionNotification: Skip notification since: IsSessionActive {2}, IsWaitingForResponse {3}. Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.Ms?this.Ms.correlationId:"",u,Sa.wE,Sa.N9);else L.a.J(38279329,829,50,"ReplaceIconManager::OnIconSuggestionNotification, No session existing. Selection might change to new shape. Reponse CorrelationId: {0}",u)}else L.a.J(38279327,829,50,"ReplaceIconManager::OnIconSuggestionResponse, IconSuggestionnotification parse failed")}Fmg(u){const P=
new Date,la=u.hha,Ba=this.la.pptIconChunkingSuggestionTimeoutMs;return P&&la&&0<Ba&&+P-+la>Ba?(u.a2b=+P-+la,!0):!1}}Object(r.a)(bo,"ReplaceIconManager",null,[]);var co=d(714),Oo=d(1024);class rn extends Sys.EventArgs{constructor(u){super();this.WY=u}}Object(r.a)(rn,"OnBeforeReplaceObjectSuggestionApplyEventArgs",Sys.EventArgs,[]);class qj{constructor(){this.shape=null;this.action=0}}Object(r.a)(qj,"ShowHideReplaceObjectGalleryData",null,[]);class op{constructor(u,P,la,Ba,Sa,pb,Vb,Bc,Yc,gd,Td,Re,Uf){this.Ar=
this.Feb=!1;this.ia=P;this.Fa=la;this.ta=Sa;this.Rf=Ba;this.$b=pb;this.GIa=Vb;this.Ez=Td;this.Gb=Re;this.Ga=Uf;this.pa=u;this.Ic=Bc;this.Dz=Yc;this.Eb=gd}get Fh(){return this.Ar}setup(){this.Fh||(this.Gt(),this.vb(),this.pe(),this.Ar=!0)}dispose(){this.Fh&&(this.u8e(),this.Ar=!1)}Gt(){this.Rf.gTd(Object(z.a)(this,this.Vwc,"updateEditState"))}u8e(){this.Rf.vVe(Object(z.a)(this,this.Vwc,"updateEditState"))}vb(){this.ia.ra(tb.a.VQa,ib.a.application,Object(z.a)(this,this.VQa,"applyReplaceObjectSuggestion"),
4);this.ia.ra(tb.a.S1a,ib.a.application,Object(z.a)(this,this.S1a,"showHideReplaceObjectSuggestionsGallery"),4);this.ia.ra(tb.a.JOb,ib.a.application,Object(z.a)(this,this.S1a,"showHideReplaceObjectSuggestionsGallery"),4);this.ia.ra(tb.a.Rlc,ib.a.application,Object(z.a)(this,this.m5g,"navigateReplaceObjectSuggestion"),4);this.ia.ra(tb.a.Qlc,ib.a.application,Object(z.a)(this,this.m5g,"navigateReplaceObjectSuggestion"),4)}pe(){const u=this.Fa.Fc(Ad.a.vQ),P=this.Fa.Fc(Ad.a.vg),la=this.Fa.Fc(Ad.a.jkb);
u.bindAction(xb.KeyInputManager.Qa(oa.a.Dp,2),tb.a.JOb);P.bindAction(xb.KeyInputManager.Qa(oa.a.Dp,2),tb.a.JOb);la.bindAction(xb.KeyInputManager.Qa(oa.a.Dp,2),tb.a.JOb);la.bindAction(xb.KeyInputManager.Qa(oa.a.mZ,0),tb.a.JOb);la.bindAction(xb.KeyInputManager.Qa(oa.a.Eba,0),tb.a.Rlc);la.bindAction(xb.KeyInputManager.Qa(oa.a.rha,0),tb.a.Qlc)}Vwc(){this.Feb||L.a.J(38279365,829,50,"ReplaceObjectActor::UpdateEditState, updating edit state");this.Feb=!0}VQa(u,P,la,Ba,Sa){if(!this.Fh)return L.a.J(33698392,
829,15,"ReplaceObjectActor::ApplyReplaceObjectSuggestion - called before setup"),16;P=this.ta.presentation;if(!this.ta.Ba||!P||this.$b.$c(P))return 16;if(1===la)return 32;la=!0;Ba=null;Object(Mh.a)(co.a,Sa)?Ba=Sa:Object(Mh.a)(Oo.a,Sa)&&(Ba=Sa.gKc,la=!1);Sa=new em.a(T.a.Uy(Ba.ActiveSlideSid,Ba.ActiveSlideCid),Ba.ShapeId,Ba.SmartArtSubNodeId);const pb=new rn(Sa);this.GIa.vYk(pb);const Vb=this.Dz.rab(Sa);if(Vb&&Vb.shapeId===Ba.ShapeId){let Bc=null;1===Vb.Z1&&(Bc=this.Ga.Gr(Vb.shape));Sa=this.Eb.xd(15,
void 0,()=>{1===Vb.Z1||this.pa.Fs()||(this.Ic.Nnd(),this.pa.nh(),this.Ic.Mnd())},()=>{Bc&&(this.Ic.Nnd(),this.pa.selectShape(Bc,!0),this.Ic.Mnd())});try{Sa.hc(P),Sa.fd=Ba.SmartArtSubNodeId?tb.a.dJf:u,P.iMb=Ba,Vb.dKc=Ba.SuggestionSid,Vb.zUd=Ba.Label,Vb.eU=!0,Vb.Vvc=new Date,L.a.J(33698394,829,50,"ReplaceObjectActor::ApplyReplaceObjectSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",Ba.CorrelationId,u,Ba.SuggestionSid)}finally{Sa&&Sa.dispose()}Vb.Jqe=!0;Vb.Tbb=!0;la&&Vb.hIe();0===
Vb.Z1?this.$b.rw(P,u):Bc?this.$b.tsa(P,Bc,this.Gb.Na,u):L.a.J(38854750,808,15,"Invalid smartArtShape")}else L.a.J(33863682,808,15,"Couldn't find active replaceObjectContext");return 32}S1a(u,P,la,Ba,Sa){if(!this.Fh)return L.a.J(33698398,829,15,"ReplaceObjectActor::ShowHideReplaceObjectSuggestionsGallery - called before setup"),16;P=this.ta.presentation;if(!this.ta.Ba||!P||this.$b.$c(P))return 16;if(1===la)return 32;la=null;P=0;if(u===tb.a.S1a){u=Object(S.a)(qj,Sa);if(!u)return 16;la=u.shape;P=u.action}else if(u===
tb.a.JOb){u=this.pa.Xd();if(1!==u.length)return 32;la=u[0]}if(!la)return L.a.J(33698400,829,10,"ReplaceObjectActor::ShowHideReplaceObjectSuggestionsGallery, null shape."),16;u=this.Dz.rab(la.WY);if(!u||!this.Feb&&u&&0===u.Z1)return 2;if(u&&u.wE&&u.shapeId===la.get_shapeId())switch(this.pa.kj(),this.Fa.Bd(),P){case 0:this.Ez.MGl(u.correlationId);break;case 1:this.Ez.TB.isVisible||this.Ez.z2e(u.correlationId);break;case 2:this.Ez.Bge(la)}return 32}m5g(u,P,la){if(!this.Fh)return L.a.J(33698396,829,15,
"ReplaceObjectActor::NavigateReplaceObjectSuggestion - called before setup"),16;P=this.ta.presentation;return this.ta.Ba&&P&&!this.$b.$c(P)?1===la?32:this.Ez.TB.isVisible?u===tb.a.Rlc?(this.Ez.Rlc(),32):u===tb.a.Qlc?(this.Ez.Qlc(),32):16:16:16}}Object(r.a)(op,"ReplaceObjectActor",null,[]);class sn{constructor(u,P){this.R0=u;this.U5c=P}initialize(){this.R0.execute(u=>{u.registerSimpleRemoteWorkflow(this.U5c.CG,this.U5c.Gtb,this.U5c.SLb,this.U5c.Vsb)})}}Object(r.a)(sn,"ReplaceObjectAugLoopRuntimeManager",
null,[]);var tn=d(1129),Gk;(function(u){u[u.textToSmartArt=0]="textToSmartArt";u[u.iconChunking=1]="iconChunking"})(Gk||(Gk={}));Object(r.b)("ReplaceObjectType",Gk);class un{constructor(u,P){this.t6a=this.MS=this.la=null;this.shapeId=0;this.F6=null;this.Z1=0;this.Fda=!1;this.dKc=0;this.zUd=null;this.Qne=this.Fne=this.Tbb=this.eU=!1;this.Uvc=this.Vvc=this.m6e=this.$Pb=this.Zvc=this.OMa=this.Wvc=this.hha=null;this.ixb=this.Ruc=0;this.kNd=this.U6a=this.wqa=null;this.N9=!1;this.suggestions=null;this.a2b=
this.sV=0;this.Jqe=!1;this.Kkb=null;this.ksc=!1;this.yYe=null;this.aId=!1;this.mGb=[];this.ai=u;this.efc=P;this.reset()}$Ra(u,P,la,Ba,Sa,pb){this.wE&&this.AW(qc.ahd);if(!u)throw Error.argumentNull("slide");const Vb=u.Uyb(new em.a(u?u.Db:null,P,pb));if(!Vb)throw Error.invalidOperation(String.format("slide doesn't have shape corresponds to shapeId: {0}",P));this.MS=u;this.t6a=Vb;this.shapeId=P;this.F6=pb;this.wqa=ua.a.create().toString();this.aId=!0;this.U6a=la;this.kNd=Ba;this.la=Sa;this.hha=new Date;
this.Z1=this.Vtj();return this.correlationId}EOc(u,P,la,Ba,Sa){return this.$Ra(u,P,la,Ba,Sa,null)}Vtj(){const u=this.shape;return this.la.iconChunkingEnabled&&u&&this.F6&&u.get_isSVGBlipFilled()?1:0}AW(u){if(this.wE&&!this.l1j(this.correlationId)){const P={};P.SuggestionCount=this.sV;P.ClientSuggestionTimeoutInMs=this.a2b;P.IsApplied=this.eU;P.AppliedSuggestionId=this.eU?this.dKc.toString():"";P.AppliedSuggestionLabel=this.eU?this.zUd:"";P.IsFloatieShown=this.Fne;P.IsGalleryShown=this.Qne;P.Trigger=
this.trigger;P.RetriggerReason=this.gXe;P.ResetReason=u;P.IconId=this.la.replaceObjectIconType;P.SlideCID=this.slide.cid;P.SlideSID=this.slide.sid;P.ShapeID=this.shapeId;P.AnimId=this.la.replaceObjectAnimId;P.AnimEnabled=this.la.hMb;P.GalleryHoverEnabled=this.la.replaceObjectGalleryHoverEnabled;P.ReplaceSuggestionType=Gk[this.Z1];P.SeeMoreButtonClicked=this.ksc;P.SeeMoreIconName=this.ksc?this.yYe:"";this.hha&&(P.SessionLiveTimeInMs=+new Date-+this.hha);this.F6&&(P.SmartArtSubNodeId=this.F6);this.OMa&&
this.$Pb&&this.$Pb>this.OMa&&(P.SuggestionsReadyInMs=+this.$Pb-+this.OMa);0<this.Ruc&&(P.SuggestionsDisplayedForMs=this.Ruc);0<this.ixb&&(P.FloatieDisplayedForMs=this.ixb);this.OMa&&this.hha&&this.OMa>this.hha&&(P.FloatieReadyInMs=+this.OMa-+this.hha);this.hha&&this.Wvc&&this.hha>this.Wvc&&(P.TriggeredByAugLoopInMs=+this.hha-+this.Wvc);this.Vvc&&this.Uvc&&this.Uvc>this.Vvc&&(P.SuggestionAppliedInMs=+this.Uvc-+this.Vvc);if(0<this.suggestions.length){u=[];for(let la=0;la<this.suggestions.length;la++)Array.add(u,
this.suggestions[la].labelText);P.SuggestionLabels=se.c(u)}1!==this.Z1||lb.a.Xa(this.Kkb)||(u=tn.a.vab(this.Kkb))&&u.hasChildNodes()&&(tn.a.r5b(),tn.a.e5k(this.Kkb));this.ai.aal(this.correlationId,se.c(P),void 0,Object(z.a)(this,this.zmc,"onFailureCallback"));this.cuk(this.correlationId)}this.reset()}reset(){this.aId=!1;this.MS=null;this.Jqe=this.Qne=this.Fne=this.Tbb=this.eU=this.Fda=!1;this.kNd=this.U6a=this.wqa="";this.suggestions=[];this.dKc=0;this.zUd="";this.N9=!1;this.a2b=this.sV=0;this.Uvc=
this.Vvc=this.m6e=this.$Pb=this.Zvc=this.OMa=this.Wvc=this.hha=null;this.Z1=this.ixb=this.Ruc=0;this.Kkb="";this.t6a=null;this.ksc=!1;this.yYe=""}l1j(u){return this.mGb?Array.contains(this.mGb,u):!1}cuk(u){this.mGb&&!Array.contains(this.mGb,u)&&(Array.add(this.mGb,u),L.a.J(512496034,829,50,"ReplaceObjectContext::MarkCorrelationAsHandled - CorrelationId: {0}; handled correlations count: {1}",u,this.mGb.length))}zmc(u){L.a.J(512496033,829,15,"ReplaceObjectContext::OnFailureCallback - request failed with: {0}. returning true to prevent ACE.",
u.HttpStatusCode);return!0}hIe(){this.M2g(2,4)}iuk(){this.M2g(3,3)}M2g(u,P){this.efc&&this.efc.execute(la=>{const Ba=Object.assign(new np.a,{cardId:vo.a.PDh,actionType:u,actionEngagement:P});la.uhd(Ba)})}get slide(){return this.MS}get shape(){return this.t6a}get correlationId(){return this.wqa}get trigger(){return this.U6a}get gXe(){return this.kNd}get wE(){return this.aId}get appSettings(){return this.la}get WY(){return new em.a(this.slide?this.slide.Db:null,this.shapeId,this.F6)}}Object(r.a)(un,
"ReplaceObjectContext",null,[805]);class pp{constructor(){this.xa=new Si.a}vYk(u){this.xa.raiseEvent("ReplaceObjectBSA",u)}fgi(u){this.xa.addHandler("ReplaceObjectBSA",u)}M7k(u){this.xa.removeHandler("ReplaceObjectBSA",u)}ykh(u){this.xa.raiseEvent("ReplaceObjectSPOver",u)}Qhi(u){this.xa.addHandler("ReplaceObjectSPOver",u)}L8k(u){this.xa.removeHandler("ReplaceObjectSPOver",u)}xkh(u){this.xa.raiseEvent("ReplaceObjectSPOut",u)}Phi(u){this.xa.addHandler("ReplaceObjectSPOut",u)}K8k(u){this.xa.removeHandler("ReplaceObjectSPOut",
u)}zYk(u){this.xa.raiseEvent("ReplaceObjectViewDE",u)}ahi(u){this.xa.addHandler("ReplaceObjectViewDE",u)}q8k(u){this.xa.removeHandler("ReplaceObjectViewDE",u)}}Object(r.a)(pp,"ReplaceObjectEventSource",null,[802,803,804]);class eo extends Lj{constructor(u,P,la,Ba,Sa,pb,Vb,Bc,Yc,gd,Td,Re,Uf,Ef,Oh,ek,je,Qf,Jg,Ei,wj){super(pb,u,P,la,Ba,Sa,Vb,Bc,Yc,gd,Td,Uf,Ef,Oh,ek,Qf,Jg,Ei,wj);this.xi=Bc.a7f();this.ai=Re;this.la=je}QH(u,P){if(!this.Fh)L.a.J(25306451,829,15,"ReplaceObjectManager::OnSelectionChanged - called before setup");
else if(!this.nYa&&P.XE.length)if(u=this.pa.Xd(),1!==u.length)this.xi.wE&&this.closeSession(this.xi,qc.gV);else{u=u[0];if(this.xi.wE){if(this.xi.shapeId===u.get_shapeId())return;this.closeSession(this.xi,qc.gV)}this.N1a(u)&&this.Eka(this.ta.Ba,u,Fk.selectShape,"")}}QMe(u,P){this.Fh?this.xi.wE&&this.xi.shape===P.shape&&(u=this.xi.shape,this.closeSession(this.xi,qc.ytc),this.N1a(u)&&this.Eka(this.ta.Ba,u,Fk.xkb,qn.ytc)):L.a.J(25306453,829,15,"ReplaceObjectManager::OnReplaceObjectViewDragEnd - called before setup")}iIe(u,
P){P.dBb&&this.LQ(P.actionId)}YB(){this.xi.wE&&this.closeSession(this.xi,qc.slideNavigation)}l1(u,P){this.xi.wE&&P.u9&&P.shapes&&Array.contains(P.shapes,this.xi.shapeId)&&this.closeSession(this.xi,qc.w0e)}PMe(u,P){P.correlationId!==this.xi.correlationId?L.a.J(25236289,829,15,"ReplaceObjectManager::OnReplaceObjectResponse, Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.xi.correlationId,P.correlationId):this.Ifg(P,this.xi,this.la)}LKe(){this.Fh&&this.xi.Tbb&&0===this.xi.Z1&&!this.$b.$c(this.ta.presentation)&&
(this.xi.Tbb=!1,this.Ez.Toa(this.xi.shape,!0))}Eka(u,P,la,Ba=""){try{const Sa=this.xi.EOc(u,P.get_shapeId(),la,Ba,this.la);this.xi.N9=!0;this.Ez.Twc(this.xi.correlationId);this.ai.m3f(u.cid,u.sid,P.get_shapeId(),Sa,la,this.tu.fXc(P),this.tu.eXc(P),void 0,Object(z.a)(this,this.wib,"onTaskFailure"));this.la.powerPointIdeasIsEnabled&&this.DIb(Sa,this.xi.shapeId,this.xi.suggestions,mg.a.pending)}catch(Sa){L.a.J(34152532,829,15,"GenerateSuggestion failed!! {0} ",Sa.message)}}wib(u){L.a.J(36966422,829,
15,"ReplaceObjectManager::OnTaskFailure - request failed with response {0}. returning true to avoid ACE",u.HttpStatusCode);return!0}LQ(u){this.Fh?this.xi.wE&&!this.x1c(u)&&this.closeSession(this.xi,qc.GRb+this.yJ.t6(u)):L.a.J(25306497,829,15,"ReplaceObjectManager::HandleAction - called before setup")}closeSession(u,P){u.Fda&&this.Ez.Toa(u.shape,!0);u.AW(P);this.la.powerPointIdeasIsEnabled&&this.DIb(u.correlationId,u.shapeId,u.suggestions,mg.a.GJa)}}Object(r.a)(eo,"ReplaceObjectManager",Lj,[]);var qp=
d(1);class A{constructor(u){this.HO=-1;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.Gte=Array.clone(u)}get_current(){if(-1===this.HO||this.HO>=this.Gte.length)throw Error.invalidOperation();return this.Gte[this.HO]}moveNext(){this.HO++;return this.HO<this.Gte.length}reset(){this.HO=-1}}Object(r.a)(A,"ArrayEnumerator",null,[142]);class W{constructor(u){this.EIa=[];this.$$ge=this.getEnumerator;this.apk=u}getEnumerator(){return new A(this.EIa)}[Symbol.iterator](){return Object(qp.a)(this.getEnumerator())}Q_c(u,
P){u&&(u.AW(P),Array.remove(this.EIa,u))}qab(u){for(const P of this.EIa)if(P.correlationId===u)return P;return null}rab(u){for(const P of this.EIa)if(em.a.xtc(u,P.WY))return P;return null}bag(u,P){for(const la of this.EIa)if(la.shapeId===u&&(!P&&!la.F6||P&&P===la.F6))return la;return null}e8b(u){return this.bag(u,null)}a7f(){return 0<this.EIa.length?this.EIa[0]:null}$Ra(u,P,la,Ba,Sa,pb){let Vb=this.rab(new em.a(u.Db,P,pb));Vb&&this.Q_c(Vb,qc.ahd);Vb=this.apk(u,P,la,Ba,Sa,pb);Array.add(this.EIa,Vb);
return Vb}EOc(u,P,la,Ba,Sa){return this.$Ra(u,P,la,Ba,Sa,null)}get Ewf(){let u=0;this.EIa.forEach(P=>{P.wE&&u++});return u}}Object(r.a)(W,"ReplaceObjectMultipleContextManager",null,[764,140]);class na{constructor(u,P,la,Ba,Sa,pb,Vb,Bc,Yc,gd){this.ta=u;this.lXg=P;this.epk=la;this.tu=pb;this.FIa=Sa;this.Dz=Ba;this.TB=Vb;this.Fa=Bc;this.We=Yc;this.Ga=gd;this.Ar=!1;this.uBc=-1}get Fh(){return this.Ar}get jzb(){return this.uBc}setup(){this.Fh||(this.FIa.fgi(Object(z.a)(this,this.X7g,"onBeforeReplaceObjectSuggestionApply")),
this.FIa.Qhi(Object(z.a)(this,this.Cah,"onReplaceObjectSuggestionPointerOver")),this.FIa.Phi(Object(z.a)(this,this.Bah,"onReplaceObjectSuggestionPointerOut")),this.Ar=!0)}dispose(){this.Fh&&(this.FIa.M7k(Object(z.a)(this,this.X7g,"onBeforeReplaceObjectSuggestionApply")),this.FIa.L8k(Object(z.a)(this,this.Cah,"onReplaceObjectSuggestionPointerOver")),this.FIa.K8k(Object(z.a)(this,this.Bah,"onReplaceObjectSuggestionPointerOut")),this.Ar=!1)}X7g(u,P){if(!this.ta.Ba)throw Error.argumentNull("ActiveSlide is null");
(u=this.ta.Ba.Uyb(P.WY))&&this.Toa(u,!1)}Cah(u,P){this.ta.Ba&&(u=new em.a(this.ta.Ba.Db,P.shapeId,P.bZ),(u=this.ta.Ba.Uyb(u))&&this.y2e(u,P.Sig))}Bah(u,P){this.ta.Ba&&(u=new em.a(this.ta.Ba.Db,P.shapeId,P.bZ),(u=this.ta.Ba.Uyb(u))&&this.b$b(u))}y2e(u,P){let la=u;u.get_smartArtModelId()&&(la=this.Ga.Gr(u));if(u=this.Ubg(la))this.sCh(la,!1),u.y2e(P)}b$b(u){let P=u;u.get_smartArtModelId()&&(P=this.Ga.Gr(u));if(u=this.Ubg(P))this.sCh(P,!0),u.b$b()}Ubg(u){return u&&!u.get_smartArtModelId()&&Object(S.a)(119,
u.qc(this.We))?this.epk.ZI(u):null}r_i(u){return u&&Object(S.a)(119,u.qc(this.We))?this.lXg.ZI(u):null}oce(u){return u&&Object(S.a)(119,u.qc(this.We))?this.lXg.dJ(u):null}uud(u){if(!this.Fh)L.a.J(25306499,829,15,"ReplaceObjectPresenter::ShowShapeReplaceObjectView - called before setup");else if(u){var P=this.r_i(u);if(P){const la=this.Dz.rab(u.WY);!la||la.Fda&&this.jzb!==la.shapeId||(la.Fda?this.jzb===la.shapeId&&(P.fRc(),this.uBc=-1):(this.Toa(u,!0,!(this.TB.B0a&&this.TB.isVisible&&em.a.xtc(u.WY,
this.TB.B0a.WY))),P.display()),la.Fda=!0)}}}Z5k(){if(-1!==this.jzb&&this.ta.Ba){var u=this.ta.Ba.GQ(this.jzb);u&&this.Toa(u,!0)}}Toa(u,P,la=!0,Ba=!1){this.Fh?u&&(P&&this.b$b(u),la&&this.Bge(u),P=this.oce(u))&&(Ba?(P.dQc(),this.uBc=u.get_shapeId()):(this.jzb===u.get_shapeId()&&(this.uBc=-1),P.visible&&P.dismiss(),(Ba=this.Dz.rab(u.WY))&&u.get_shapeId()===Ba.shapeId&&(Ba.Fda=!1))):L.a.J(25306501,829,15,"ReplaceObjectPresenter::RemoveShapeReplaceObjectView - called before setup")}Twc(u){this.TB.Twc(u)}MGl(u){if(this.Fh)if(this.TB.isVisible){const P=
this.Dz.qab(u);P&&P.wE&&P.correlationId===u&&this.b$b(P.shape);this.Bge(P.shape)}else this.z2e(u);else L.a.J(25306503,829,15,"ReplaceObjectPresenter::ToggleSuggestionsGalleryView - called before setup")}Bge(u){this.TB.isVisible&&this.TB.B0a&&em.a.xtc(this.TB.B0a.WY,u.WY)&&(this.TB.dismiss(),(u=this.oce(this.TB.B0a.shape))&&u.root&&(u.root.style.zIndex="0"),this.Fa.tj(Ad.a.jkb,!1))}z2e(u){const P=this.Dz.qab(u);if(P&&P.correlationId===u&&P.wE){var la=this.oce(P.shape);if(la){var Ba=la.root;Ba?this.TB.isVisible&&
this.TB.B0a&&!em.a.xtc(this.TB.B0a.WY,P.WY)||(Ba=this.tu.getBounds(Ba),this.TB.show(u,Ba.x,Ba.y),la.root.style.zIndex=String(v.AFrameworkApplication.Aa.usb),this.Fa.tj(Ad.a.jkb,!0),P.Qne=!0):L.a.J(25306508,829,10,"ReplaceObjectPresenter::ShowSuggestionsGallery - rootElem is null")}else L.a.J(25306506,829,10,"ReplaceObjectPresenter::ShowSuggestionsGallery - replaceObjectView is null")}}vmh(u){this.Fh?this.TB.isVisible&&this.z2e(u):L.a.J(25306510,829,15,"ReplaceObjectPresenter::RefreshSuggestionsGallery - called before setup")}Rlc(){if(this.Fh){var u=
this.TB.aae();u&&(-1===u?this.TB.Zw(0,!0):(this.TB.Zw(u,!1),this.TB.Zw(u-1,!0)))}else L.a.J(25306512,829,15,"ReplaceObjectPresenter::NavigateReplaceObjectSuggestionPrev - called before setup")}Qlc(){if(this.Fh){var u=this.TB.aae();u+1!==this.TB.Qtj()&&(-1===u?this.TB.Zw(0,!0):(this.TB.Zw(u,!1),this.TB.Zw(u+1,!0)))}else L.a.J(25306514,829,15,"ReplaceObjectPresenter::NavigateReplaceObjectSuggestionNext - called before setup")}sCh(u,P){u&&(u=Object(S.a)(119,u.qc(this.We)))&&((u=u.va)?u.Sd(P):L.a.J(25306516,
829,10,"ReplaceObjectPresenter::ShowHideShape,shapeViewDiv is null"))}}Object(r.a)(na,"ReplaceObjectPresenter",null,[797]);class Ga{constructor(){this.shapeId=this.slideCid=this.slideSid=0;this.OJb=null;this.AOe=0}}Object(r.a)(Ga,"TaskItem",null,[]);class Ka{constructor(u,P,la){this.Egb=[];this.ai=u;this.tu=P;this.dzg=la}h5i(u,P,la){for(let Ba=0;Ba<this.Egb.length;Ba++)if(this.Egb[Ba].slideSid===u&&this.Egb[Ba].slideCid===P&&this.Egb[Ba].shapeId===la)return this.Egb[Ba];return null}mvh(u){var P=this.h5i(u.slide.sid,
u.slide.cid,u.shapeId);if(P)return P.OJb=u,P.AOe++,1;const la=Object.assign(new Ga,{slideSid:u.slide.sid,slideCid:u.slide.cid,shapeId:u.shapeId,AOe:0,OJb:null});Array.add(this.Egb,la);u.N9=!0;P=u.correlationId;const Ba=u.slide,Sa=u.shape;this.ai.m3f(Ba.cid,Ba.sid,Sa.get_shapeId(),P,u.trigger,this.dzg?this.tu.fXc(Sa):this.tu.q8b(Sa),this.dzg?this.tu.eXc(Sa):this.tu.p8b(Sa),()=>{this.Zbh(la)},pb=>{this.Zbh(la);L.a.J(36966425,829,15,"SendGenerateReplaceObjectRequest - request failed with response {0}. returning true to avoid ACE.",
pb.HttpStatusCode);return!0});return 0}Zbh(u){Array.remove(this.Egb,u);u.OJb&&u.OJb.wE&&(L.a.J(34144975,829,50,"ReplaceObjectRequestManager - Send pending request: {0}; {1} were in queue and skipped",u.OJb.correlationId,u.AOe-1),this.mvh(u.OJb))}}Object(r.a)(Ka,"ReplaceObjectRequestManager",null,[763]);class qb{constructor(u){this.GAe=!0;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.Sp=u}get_current(){return this.Sp}moveNext(){return this.GAe?(this.GAe=!1,!0):!1}reset(){this.GAe=
!0}}Object(r.a)(qb,"SingleEnumerator",null,[142]);class Qb{constructor(u){this.$$ge=this.getEnumerator;this.xi=u}getEnumerator(){return new qb(this.xi)}[Symbol.iterator](){return Object(qp.a)(this.getEnumerator())}Q_c(u,P){u&&u===this.xi&&u.AW(P)}qab(){return this.xi}rab(){return this.xi}e8b(){return this.xi}bag(){return this.xi}a7f(){return this.xi}$Ra(u,P,la,Ba,Sa,pb){this.xi.$Ra(u,P,la,Ba,Sa,pb);return this.xi}EOc(u,P,la,Ba,Sa){return this.$Ra(u,P,la,Ba,Sa,null)}get Ewf(){return this.xi.wE?1:0}}
Object(r.a)(Qb,"ReplaceObjectSingleContextManager",null,[764,140]);var t=d(133);class Y{constructor(u,P,la,Ba,Sa){this.Cfa=null;this.YGb=this.Uve=!1;this.ona=null;this.visible=!1;this.wu=u;this.lU=P;this.i$=la;this.tu=Sa;this.pjc=Ba;this.Ar=!1}get Fh(){return this.Ar}setup(){this.Fh||(this.ona=new Ub.a,this.Cfa=this.pjc.NNi(this.ona.va),this.lU&&!this.lU.Nl&&this.lU.hV&&(this.lU.hV.appendChild(this.ona),this.Sd(!1),this.YGb=!0,this.lU.Yra(this,3),this.visible=this.lU.OQ||this.lU.io),this.Ar=!0)}xm(){L.a.J(25306526,
829,15,"ReplaceObjectSuggestionPreviewView::BuildDomElements - shouldn't be called")}iC(){}Mp(){if(!this.Fh)return L.a.J(36827549,829,15,"ReplaceObjectSuggestionPreviewView::GetVisibleBoundingRegion - called before setup"),null;if(!this.Uve||!this.Cfa.Fh||!this.Cfa.$N)return null;const u=Rb.a.Nn(this.Cfa.$N.va.style.left),P=Rb.a.Nn(this.Cfa.$N.va.style.top),la=Rb.a.Nn(this.Cfa.$N.va.style.width),Ba=Rb.a.Nn(this.Cfa.$N.va.style.height);return new t.a(new nb.a(u,P),new nb.a(u+la,P),new nb.a(u+la,P+
Ba),new nb.a(u,P+Ba))}KL(){return!1}Xw(){}my(){}setPosition(){}Ij(){this.YGb=!0;this.ds()}vq(){this.YGb=!0;this.ds()}Eu(){this.YGb=!0;this.ds()}setZIndex(u){this.ona&&this.ona.jC(u)}JD(){}aD(){return null}QA(){return[]}draw(){}dispose(){this.i$();this.Fh&&(this.Cfa.dispose(),this.ona.va.parentNode&&this.ona.Dq(),this.ona=null,this.Ar=!1)}y2e(u){this.Fh?(this.Msc(u),this.ds()):L.a.J(25306562,829,15,"ReplaceObjectSuggestionPreviewView::ShowSuggestionPreview - called before setup")}b$b(){this.Fh?this.ERa():
L.a.J(25306564,829,15,"ReplaceObjectSuggestionPreviewView::HideSuggestionPreview - called before setup")}Msc(u){this.Fh?(this.Cfa.LLa(u),this.Sd(!0)):L.a.J(25306566,829,15,"ReplaceObjectSuggestionPreviewView::SetGlyph - called before setup")}ERa(){this.Fh?(this.Cfa.dismiss(),this.Sd(!1)):L.a.J(25306568,829,15,"ReplaceObjectSuggestionPreviewView::ClearGlyph - called before setup")}setSelection(){}ds(){if(this.Uve&&this.YGb){var u=this.tu.q8b(this.wu),P=this.tu.p8b(this.wu);this.ah(u,P);this.ona&&(u=
this.tu.Tpj(this.wu),Yn.a.setRotation(this.ona.va,u));this.YGb=!1}}Sd(u){this.Uve=u;this.ona.Sd(u)}ah(u,P){this.Cfa&&this.Cfa.ah(u,P)}}Object(r.a)(Y,"ReplaceObjectSuggestionPreviewView",null,[799,800,239,240,107,797]);var pa=d(281),Ja=d(239),Ya=d(1023),jb=d(1022);class Sb extends Sys.EventArgs{constructor(u){super();this.shape=u}}Object(r.a)(Sb,"ReplaceObjectViewDragEndEventArgs",Sys.EventArgs,[]);class kc{constructor(u,P,la,Ba,Sa,pb,Vb,Bc,Yc,gd,Td){this.pZg=!1;this.R$=this.FXa=null;this.ia=Sa;this.$e=
pb;this.nd=Vb;this.Dz=Bc;this.GIa=Yc;this.pjc=Ba;this.i$=la;this.wu=u;this.lU=P;this.xA=!1;this.la=gd;this.SEe=Td;this.Ar=this.visible=!1}get Fh(){return this.Ar}Zxb(){return this.Dz.rab(this.wu.WY)}setup(){if(!this.Fh){var u=this.Zxb();u=u?u.Z1:0;this.pZg=1===u;this.R$=new Ub.a;this.FXa=this.pjc.cLi(this.R$,kc.pLc,Object(z.a)(this,this.gDk,"onFlyoutAnchorClick"),Object(z.a)(this,this.hDk,"onFlyoutAnchorHover"),u);this.lU&&!this.lU.Nl&&this.lU.hV&&(this.xm(this.lU.hV),this.lU.Yra(this,3));this.Ar=
!0}}fRc(){this.Fh?this.FXa&&this.FXa.fRc():L.a.J(512496032,829,15,"ShapeReplaceObjectView::EnableFloatie - called before setup")}dQc(){this.Fh?this.FXa&&this.FXa.dQc():L.a.J(512496031,829,15,"ShapeReplaceObjectView::DisableFloatie - called before setup")}display(){if(!this.Fh)L.a.J(512496030,829,15,"ShapeReplaceObjectView::Display - called before setup");else if(!this.visible){this.ds();this.FXa.show();this.visible=!0;this.hRb();var u=this.Zxb();if(u){u.Fne=!0;const P=new Date;u.OMa||(u.OMa=P);u.Zvc=
P;L.a.J(512496029,829,50,"ShapeReplaceObjectView::Display - trigger: {0}, correlationId: {1}",u.trigger,u.correlationId)}}}get root(){return this.Fh?this.R$.va:(L.a.J(512496027,829,15,"ShapeReplaceObjectView::Root - called before setup"),null)}dismiss(){if(this.Fh){this.FXa.dismiss();this.visible=!1;var u=this.Zxb();u&&(u.Fda=!1,u.Zvc&&(u.ixb+=+new Date-+u.Zvc,L.a.J(512496025,829,50,"ShapeReplaceObjectView::Dismiss - FloatieDisplayedForMs: {0}; TimeFloatieRenderedLast: {1}; trigger: {2}; correlation: {3}",
u.ixb,u.Zvc,u.trigger,u.correlationId)))}else L.a.J(512496026,829,15,"ShapeReplaceObjectView::Dismiss - called before setup")}xm(){this.visible=!1;this.$e.addCssClass(this.R$.va,"replaceObjectBody");document.body.appendChild(this.R$.va);this.nd.E_b(Object(z.a)(this,this.onResize,"onResize"));this.ds()}iC(){}Mp(){return null}KL(){return!1}Xw(){}my(){}setPosition(){}Ij(){}vq(){}Eu(){}setZIndex(){}JD(u){if(this.Fh){if(u)this.visible=!1,this.hRb();else if(this.xA){const P=new Sb(this.wu);this.GIa.zYk(P)}this.xA=
u}else L.a.J(512496024,829,15,"ShapeReplaceObjectView::SetDrag - called before setup")}aD(){return null}QA(){return[]}draw(){this.Fh?this.ds():L.a.J(512496023,829,15,"ShapeReplaceObjectView::Draw - called before setup")}setSelection(){}dispose(){this.i$();this.Fh&&(this.nd.pph(Object(z.a)(this,this.onResize,"onResize")),this.R$&&(this.R$.va.parentNode&&this.R$.Dq(),this.$e.removeCssClass(this.R$.va,"replaceObjectBody")),this.dismiss(),this.FXa.dispose(),this.R$=null,this.Ar=!1)}hRb(){this.R$.va.style.visibility=
this.visible?mb.a.visible:mb.a.hidden;const u=this.Zxb();u&&(u.Fda=this.visible)}ds(){let u=null;var P=this.lU.hV;P&&(u=this.$e.ki(P.va));u?(P=u.x-(kc.pLc+10),this.pZg&&this.lU&&this.lU.Nd&&(P=this.lU.Nd.Md.Ne(this.wu.Ix,0),P=u.x+P+10),Yn.a.Wsc(this.R$.va,1),this.R$.setPosition(1*P,u.y),this.YMl(1*P,u.y)):L.a.J(512496022,829,15,"ShapeReplaceObjectView::UpdateView - elementBound is null")}YMl(u,P){if(this.SEe.isVisible){var la=this.Zxb(),Ba=this.SEe.B0a;Ba&&la&&Ba.correlationId===la.correlationId&&
this.SEe.updatePosition(u,P)}}gDk(u){if(u.LA!==Sys.UI.MouseButton.leftButton)return!1;this.ia.Ka(tb.a.S1a,2,Object.assign(new qj,{shape:this.wu,action:0}));return!0}hDk(){if(!this.la.replaceObjectGalleryHoverEnabled)return!1;const u=this.Zxb();if(u&&1===u.Z1)return!1;this.ia.Ka(tb.a.S1a,2,Object.assign(new qj,{shape:this.wu,action:1}));return!0}onResize(u,P){this.visible&&(u=null,P&&P.xG&&(u=P.xG.gd),u&&u.Db.equals(this.wu.slideId)&&this.ds())}}kc.pLc=32;Object(r.a)(kc,"ShapeReplaceObjectView",null,
[795,796,239,240,107,797]);var db=d(655),Kb=d(72);class lc{constructor(u,P,la,Ba,Sa,pb,Vb,Bc,Yc,gd,Td,Re){this.MYa=this.hfa=this.PYa=this.L5=this.Lo=null;this.oed=0;this.lze=-1;this.zq=this.xi=null;this.$e=u;this.Rc=la;this.Sr=P;this.ta=Ba;this.ia=Sa;this.IB=Yc;this.GIa=pb;this.Dz=Vb;this.qR=Bc;this.Fa=gd;this.la=Td;this.Zpk=!Re.ik;this.Ar=this.hqb=!1}get Fh(){return this.Ar}get isVisible(){return this.hqb}get B0a(){return this.xi}setup(){this.Fh||(this.Lo=Rb.a.$d(),this.Lo.setAttribute("Unselectable",
"on"),this.Lo.style.position=mb.a.absolute,this.$e.addCssClass(this.Lo,"replaceObjectContainer"),this.RWe(null),document.body.appendChild(this.Lo),this.aLa(),this.IB.q4(Ad.a.jkb,Ad.a.Xi,this.Lo,()=>{},()=>{},!0),this.Ar=!0)}dispose(){this.Fh&&(this.dismiss(),this.t8e(),this.Lo&&this.Lo.parentNode&&this.Lo.parentNode.removeChild(this.Lo),this.Ar=!1)}dismiss(){this.Fh?(v.AFrameworkApplication.Aa.TSa(!0),this.setVisibility(!1),this.XHb.style.display=mb.a.none,this.XHb.style.zIndex="-1",this.MYa=this.hfa=
null,this.RWe(null)):L.a.J(25306570,829,15,"ReplaceObjectSuggestionsGalleryView::Dismiss - called before setup")}show(u,P,la){if(!this.Fh)L.a.J(25306572,829,15,"ReplaceObjectSuggestionsGalleryView::Show - called before setup");else if(!lb.a.Xa(u)){var Ba=this.Dz.qab(u);Ba&&Ba.correlationId===u&&Ba.wE&&!Ba.N9&&(this.xi=Ba,this.dQk(u,this.xi.suggestions),this.oed=this.xi.sV,this.jrh(),v.AFrameworkApplication.Aa.iRa(!0),this.XHb.style.zIndex=String(v.AFrameworkApplication.Aa.Sra),this.Lo.style.zIndex=
String(v.AFrameworkApplication.Aa.usb),this.XHb.style.visibility=mb.a.hidden,this.XHb.style.display=mb.a.block,this.XHb.style.visibility=mb.a.visible,this.Ela()?this.$e.addCssClass(this.Lo,"replaceIconObjectContainer"):this.$e.removeCssClass(this.Lo,"replaceIconObjectContainer"),this.updatePosition(P,la),this.setVisibility(!0))}}updatePosition(u,P){let la,Ba;this.setPosition(0,0);if(this.Ela()){la=u+kc.pLc+7;Ba=P;const Sa=db.a(0,0);la+this.Lo.offsetWidth>Sa.width&&(la=u+kc.pLc-this.Lo.offsetWidth,
Ba=P-7-this.Lo.offsetHeight)}else la=u,Ba=P-7-this.Lo.offsetHeight;this.setPosition(la,Ba)}Qtj(){return this.Fh?this.oed:(L.a.J(25306574,829,15,"ReplaceObjectSuggestionsGalleryView::GetSuggestionCount - called before setup"),0)}aae(){return this.Fh?this.isVisible?this.Lo?this.Lo.querySelector(".replaceObjectSuggestionsList")?this.lze:(L.a.J(25306580,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex, suggestion list is null"),-1):(L.a.J(25306578,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex, m_suggestionsContainer is null"),
-1):-1:(L.a.J(25306576,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex - called before setup"),0)}Zw(u,P){if(!this.Fh)L.a.J(25306582,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus - called before setup");else if(!(0>u)&&this.isVisible)if(this.Lo)if(u>=this.oed)L.a.J(25306586,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, invalid suggestionIndex. SuggestionCount:{0}, SuggestionIndex:{1}",this.oed,u);else{var la=this.Lo.querySelector(".replaceObjectSuggestionsList");
la?(la=la.children)?(la=la[u])?P?(this.lze=u,ud.FocusManager.Zq(la)&&this.HCh(la.firstChild)):(this.jrh(),ud.FocusManager.iJl(la)&&this.Fhg(la.firstChild)):L.a.J(25306592,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestionItem is null"):L.a.J(25306590,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestionItems is null"):L.a.J(25306588,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestion list is null")}else L.a.J(25306584,
829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, m_suggestionsContainer is null")}Twc(u){this.PYa&&(this.PYa.className="ReplaceObjectCorrelation "+u)}dQk(u,P){this.RWe(u);if(u=this.ePi(u,P))P=this.dPi(),this.Lo.appendChild(P),this.Lo.appendChild(u),this.Ela()&&(u=this.cPi(),this.Lo.appendChild(u))}RWe(u){this.Lo&&(this.L5&&(this.Rc.Bb(Ca.a.click,this.L5,Object(z.a)(this,this.k$g,"onLinkClick")),this.L5=null),this.$e.vv(this.Lo),this.PYa=Rb.a.$d(),this.PYa.setAttribute("Unselectable",
"on"),this.PYa.className=lb.a.Xa(u)?"ReplaceObjectCorrelation":"ReplaceObjectCorrelation "+u,this.PYa.style.position=mb.a.absolute,this.PYa.style.display=mb.a.none,this.Lo.appendChild(this.PYa),this.Lo.style.zIndex="-1")}dPi(){const u=Rb.a.Il();u.setAttribute("Unselectable","on");this.Ela()?(u.innerText=ResourceStrings.l_ReplaceIconSuggestionGalleryTitle,this.$e.addCssClass(u,"replaceIconObjectContainerTitle")):(u.innerText=ResourceStrings.l_ReplaceObjectSuggestionGalleryTitle1,this.$e.removeCssClass(u,
"replaceIconObjectContainerTitle"));this.$e.addCssClass(u,"UIFont replaceObjectContainerTitle");return u}ePi(u,P){if(lb.a.Xa(u))return L.a.J(25012107,829,10,"ReplaceObjectSuggestionsGalleryView::CreateSuggestionList - Empty correlationId"),null;if(!P||!P.length)return L.a.J(25012109,829,10,"ReplaceObjectSuggestionsGalleryView::CreateSuggestionList - Requires atleast one suggestion to display."),null;const la=Rb.a.B3b();la.id=u;la.setAttribute("Unselectable","on");la.setAttribute(Ha.a.hf,Ha.a.rni);
this.$e.addCssClass(la,"replaceObjectSuggestionsList");this.hfa||(this.hfa=new Kb.a);this.MYa||(this.MYa=new Kb.a);for(var Ba of P)lb.a.Xa(Ba.imageData)||this.hfa.$(Ba.index,Ba.imageData),this.Ela()&&!lb.a.Xa(Ba.renderData)&&this.MYa.$(Ba.index,Ba.renderData),u=this.Hri(Ba.index,Ba.labelText),la.appendChild(u);if(this.Zpk&&0<this.MYa.count&&this.Ela()&&(lb.a.Xa(this.xi.Kkb)&&(this.xi.Kkb=Nl.a.create().toString()),(Ba=tn.a.vab(this.xi.Kkb))&&!Ba.hasChildNodes())){Ba.style.position=mb.a.absolute;Ba.style.left=
"0px";Ba.style.top="0px";for(let Sa of this.MYa.values)u=Rb.a.sB(),u.src=Sa,u.style.display=mb.a.block,u.style.position=mb.a.absolute,Ba.appendChild(u);tn.a.C0b()}return la}cPi(){this.L5=Rb.a.Il();this.L5.setAttribute("Unselectable","on");this.L5.setAttribute("tabindex","-1");this.L5.setAttribute(Ha.a.hf,Ha.a.rVd);this.$e.addCssClass(this.L5,"UIFont replaceObjectContainerLink");this.Ela()&&this.la.pptSmartArtSubNodeIconChangeEnabled&&this.la.Gbb&&(this.L5.innerText=ResourceStrings.l_ReplaceIconSuggestionGalleryLink,
this.Rc.rb(Ca.a.click,this.L5,Object(z.a)(this,this.k$g,"onLinkClick")));const u=Rb.a.$d();u.appendChild(this.L5);return u}aLa(){this.Lo&&(this.Rc.rb(Ca.a.click,this.Lo,Object(z.a)(this,this.onClick,"onClick")),this.qR.addHandler(this.Lo,Ca.a.Bf,Object(z.a)(this,this.ZZc,"inputKeyApplyHandler")),this.Sr.rb(Ca.a.pointerOver,this.Lo,Object(z.a)(this,this.NM,"onPointerOver")),this.Sr.rb(Ca.a.pointerOut,this.Lo,Object(z.a)(this,this.qG,"onPointerOut")))}t8e(){this.Lo&&(this.Rc.Bb(Ca.a.click,this.Lo,Object(z.a)(this,
this.onClick,"onClick")),this.qR.removeHandler(this.Lo,Ca.a.Bf,Object(z.a)(this,this.ZZc,"inputKeyApplyHandler")),this.Sr.Bb(Ca.a.pointerOver,this.Lo,Object(z.a)(this,this.NM,"onPointerOver")),this.Sr.Bb(Ca.a.pointerOut,this.Lo,Object(z.a)(this,this.qG,"onPointerOut")))}NM(u){u=this.ode(u.Bc);this.HCh(u);return!0}qG(u){u=this.ode(u.Bc);this.Fhg(u);return!0}ZZc(u){if(this.isVisible&&!u.ctrlKey&&!u.altKey&&(!u.shiftKey||u.keyCode===oa.a.$q&&this.Ela()))if(u.keyCode===oa.a.Dp||u.keyCode===oa.a.zK)u.preventDefault(),
(u=this.Lo.querySelector(":focus"))&&u.firstChild.click();else if(u.keyCode===oa.a.$q&&this.Ela()){const P=this.Lo.querySelector(":focus");P&&this.L5&&(P===this.L5?(u.preventDefault(),u.stopPropagation(),this.Zw(0,!0)):P.parentNode&&P.parentNode.className&&0<=P.parentNode.className.indexOf("replaceObjectSuggestionsList")&&(u.preventDefault(),u.stopPropagation(),this.Zw(this.aae(),!1),ud.FocusManager.Zq(this.L5)))}}onClick(u){if(u.LA!==Sys.UI.MouseButton.leftButton)return!1;var P=this.ode(u.Bc);if(!this.fqe(P)||
!this.S3j(P))return!0;u=this.$dj(P);const la=this.E8b(P);P=this.Ttj(P);lb.a.Xa(u)||lb.a.Xa(la)||(u=Object.assign(new co.a,{SuggestionSid:parseInt(la),ShapeId:this.xi.shapeId,CorrelationId:u,ActiveSlideCid:this.ta.Ba.cid,ActiveSlideSid:this.ta.Ba.sid,Label:P,SmartArtSubNodeId:this.xi.F6?this.xi.F6:null,ReplaceObjectType:this.xi.Z1}),this.ia.Ka(tb.a.VQa,2,u));return!0}k$g(){this.xi&&(this.xi.ksc=!0);this.Uee();this.ia.processAction(tb.a.p8a,2);return!0}HCh(u){u&&this.fqe(u)&&(u=this.E8b(u),lb.a.Xa(u)||
(u=this.Ela()?this.MYa.Fb(u)?this.MYa.ga(u):"":this.hfa.Fb(u)?this.hfa.ga(u):"",lb.a.Xa(u)||(u=new jb.a(this.xi.shapeId,u,this.xi.F6),this.GIa.ykh(u))))}Fhg(u){u&&this.fqe(u)&&(u=new Ya.a(this.xi.shapeId,this.xi.F6),this.GIa.xkh(u))}ode(u){if(!u)throw Error.argumentNull("sourceElement");return"a"===u.nodeName.toLowerCase()?u:u.parentNode}$dj(u){return u?u.parentNode.parentNode.id:null}E8b(u){if(!u)return null;u=u.id.split("_");return 2!==u.length?null:u[1]}Ttj(u){return u?u.title:null}fqe(u){return!!u&&
!lb.a.Xa(u.className)&&-1!==u.className.indexOf("ObjectSuggestionContainer")}S3j(u){return!!u&&!lb.a.Xa(u.className)&&-1===u.className.indexOf("ReplaceObjectSuggestionLoading")}Hri(u,P){const la=this.hfa.Fb(u);var Ba=la?this.hfa.ga(u):$f.a.JN(Of.a.Foa);la||L.a.J(38340484,829,15,"ReplaceObjectSuggestionsGalleryView::spinner shows up");const Sa=Rb.a.sB();Sa.setAttribute("Unselectable","on");Sa.src=Ba;Sa.title=P;Sa.setAttribute(Ha.a.hf,Ha.a.iQ);this.$e.addCssClass(Sa,"replaceObjectSuggestionThumbnail");
Ba=Rb.a.kda();Ba.id="ROS_"+u;Ba.setAttribute("Unselectable","on");Ba.title=P;Ba.setAttribute(Ha.a.hf,"none");let pb=this.Ela()?"replaceIconObjectSuggestionContainer":"replaceObjectSuggestionContainer";this.xi.eU&&this.xi.dKc.toString()===u&&(pb+="Selected");this.$e.addCssClass(Ba,pb);la||this.$e.addCssClass(Ba,"ReplaceObjectSuggestionLoading");Ba.appendChild(Sa);u=this.$e.nPf();u.setAttribute("Unselectable","on");u.setAttribute("tabindex","-1");u.setAttribute(Ha.a.hf,Ha.a.iQ);u.setAttribute(Ha.a.er,
P);u.appendChild(Ba);return u}setPosition(u,P){this.Fh?(0>u&&(u=0),0>P&&(P=0),this.Lo.style.left=this.$e.Pc(u),this.Lo.style.top=this.$e.Pc(P)):L.a.J(25306626,829,15,"ReplaceObjectSuggestionsGalleryView::SetPosition - called before setup")}setVisibility(u){if(this.Lo){if(this.xi)if(u)this.xi.m6e=new Date,this.xi.iuk();else{let P;(P=this.xi).Ruc=P.Ruc+(+new Date-+this.xi.m6e)}this.Lo.style.visibility=u?mb.a.visible:mb.a.hidden;this.hqb=u;this.Fa.tj(Ad.a.jkb,u)}}jrh(){this.lze=-1}Ela(){return!!this.xi&&
1===this.xi.Z1}get XHb(){this.zq&&"undefined"!==typeof this.zq||(this.zq=this.$e.$d(),this.zq.setAttribute("id","ModalDiv"),this.$e.addCssClass(this.zq,"cui-modalDiv"),this.zq.setAttribute("Unselectable","on"),document.body.appendChild(this.zq),pa.a.instance.rb(Ca.a.pointerDown,this.zq,Object(z.a)(this,this.fjd,"onModalPointerDown")),pa.a.instance.rb(Ca.a.WR,this.zq,Object(z.a)(this,this.gjd,"onModalPointerUp")),pa.a.instance.rb(Ca.a.ooc,this.zq,Object(z.a)(this,this.bFk,"onModalPointerMove")),pa.a.instance.rb(Ca.a.pointerOut,
this.zq,Object(z.a)(this,this.cFk,"onModalPointerOut")),Ja.a.instance.rb(Ca.a.click,this.zq,Object(z.a)(this,this.aFk,"onModalClick")),cc.a.instance.rb(Ca.a.aIb,this.zq,Object(z.a)(this,this.xMe,"onModalMouseWheel")));return this.zq}fjd(){return!0}gjd(){return this.Uee()}bFk(){return!0}cFk(){return!0}aFk(){return this.Uee()}xMe(){return!0}Uee(){if(!this.xi||!this.xi.slide)return!0;const u=this.xi.shape;if(!u)return!0;this.ia.Ka(tb.a.S1a,2,Object.assign(new qj,{action:2,shape:u}));return!0}}Object(r.a)(lc,
"ReplaceObjectSuggestionsGalleryView",null,[761,797]);class Jc{constructor(u,P,la,Ba){this.fpk=u;this.tu=P;this.ta=la;this.la=Ba}saj(u){if(!this.ta.Ba)return!1;u=this.ta.Ba.GQ(u);return this.wxc(u)}wxc(u){return!(u&&u.get_shapeId()&&u.hasText&&this.tu.vGa(u))||u.get_shapeRotation()||u.Es||u.F4||u.Hx||!this.fpk.validate(u)?!1:!0}U5j(u){return!Array.contains(this.la.replaceObjectDisabledTriggers,u)}}Object(r.a)(Jc,"ReplaceObjectValidationHelper",null,[]);class Vc{constructor(u,P,la,Ba,Sa,pb,Vb,Bc,Yc){this.Pv=
this.B0=null;this.Ar=!1;this.yfa=u;this.Rc=P;this.Sr=la;this.q5=Ba;this.wfa=Sa;this.ke=Vb;this.la=pb;this.wdb=Yc}get Fh(){return this.Ar}dQc(){this.la.hMb?this.Pv.setAttribute("Src",this.ke.qk("BLUEBOLT_Deactivated.gif")):this.Pv.style.opacity=".3";this.wdb.twh(Object(z.a)(this,this.dismiss,"dismiss"))}fRc(){this.la.hMb?this.Pv.setAttribute("Src",this.ke.qk("BLUEBOLT_Reactivated.gif")):this.Pv.style.opacity="initial";this.wdb.disabled=!1}show(){this.la.hMb?this.Pv.setAttribute("Src",this.ke.qk("BLUEBOLT_Entrance.gif")):
this.Pv.setAttribute("Src",this.ke.qk("LightningIdeasOOUI_blue_32x.png"))}dismiss(){this.la.hMb?(this.Pv.setAttribute("Src",this.ke.qk("BLUEBOLT_Exit.gif")),this.wdb.kll(()=>{this.yfa.va.style.visibility=mb.a.hidden})):(this.Pv.setAttribute("Src",""),this.yfa.va.style.visibility=mb.a.hidden)}setup(){this.Fh||(this.yfa?(this.B0=new Ub.a,this.B0.va.style.visibility=mb.a.inherit,this.B0.va.style.position=mb.a.absolute,this.Pv=Rb.a.sB(),this.Pv.setAttribute("Unselectable","on"),this.Pv.setAttribute(Ha.a.hf,
Ha.a.iQ),this.Pv.className="gifFloatie",this.B0.va.appendChild(this.Pv),this.yfa.appendChild(this.B0),this.aLa()):L.a.J(38072903,829,15,"parentElement is null"),this.Ar=!0)}P9g(u){let P;switch(this.la.replaceObjectIconType){case 7:P="BLUEBOLT_Hover_on.gif";break;case 8:P="BLUEBOLT_HoverWhite_On.gif";break;default:P="BLUEBOLT_Hover_on.gif"}this.Pv.setAttribute("Src",this.ke.qk(P));return this.wfa(u)}onBlur(){let u;switch(this.la.replaceObjectIconType){case 7:u="BLUEBOLT_Hover_off.gif";break;case 8:u=
"BLUEBOLT_HoverWhite_Off.gif";break;default:u="BLUEBOLT_Hover_off.gif"}this.Pv.setAttribute("Src",this.ke.qk(u));return!0}aLa(){this.q5&&this.Rc.rb(Ca.a.click,this.Pv,this.q5);this.wfa&&(this.Sr.rb(Ca.a.pointerOver,this.Pv,Object(z.a)(this,this.P9g,"onHover")),this.Sr.rb(Ca.a.pointerOut,this.Pv,Object(z.a)(this,this.onBlur,"onBlur")))}D8e(){this.q5&&this.Rc.Bb(Ca.a.click,this.Pv,this.q5);this.wfa&&(this.Sr.Bb(Ca.a.pointerOver,this.Pv,Object(z.a)(this,this.P9g,"onHover")),this.Sr.Bb(Ca.a.pointerOut,
this.Pv,Object(z.a)(this,this.onBlur,"onBlur")))}dispose(){this.dismiss();this.D8e();this.Ar=!1}}Object(r.a)(Vc,"GifFlyoutAnchor",null,[820,797]);class vd{constructor(u,P,la,Ba,Sa,pb,Vb,Bc,Yc,gd,Td,Re,Uf,Ef){this.Pv=this.Ov=null;this.yfa=u;this.c5=P;this.Aik=la;this.Fik=Ba;this.UFg=Re.replaceObjectIconType;this.Vxg=Re.replaceObjectAnimId;this.Wxg=Re.hMb;this.Jgb=pb;this.pjc=Sa;this.Rc=Vb;this.Sr=Bc;this.q5=Yc;this.wfa=gd;this.$e=Td;this.Vqk=Uf;this.wdb=Ef;this.Ar=!1}get W3d(){return 1===this.Vqk?
ResourceStrings.l_ReplaceIconSuggestionFloatieTooltip:this.wdb.disabled?ResourceStrings.l_ReplaceObjectGrayFloatieTooltip:ResourceStrings.l_ReplaceObjectFloatieTooltip}get Fh(){return this.Ar}setup(){this.Fh||(this.Ov=new Ub.a,this.Pv=this.pjc.MNi(),this.Ov.va.style.visibility=mb.a.inherit,this.qRa(),this.Ar=!0)}dQc(){this.wdb.twh(Object(z.a)(this,this.dismiss,"dismiss"));this.ERa();this.Msc();this.Ov.WGi()||this.Ov.Dr("replaceObjectGrayedFlyoutAnchor")}show(){this.Fh?this.Msc(this.Wxg):L.a.J(38072907,
829,15,"ReplaceObjectFlyoutAnchor::Show - called before setup")}fRc(){this.wdb.disabled=!1;this.ERa();this.Msc();this.Ov.Zjb("replaceObjectGrayedFlyoutAnchor")}Msc(u=!1){this.Fh?this.Pv.LLa(this.Rhj(u),""):L.a.J(25306443,829,15,"ReplaceObjectFlyoutAnchor::SetGlyph - called before setup")}Rhj(u){const P=this.Jgb.aPf(this.c5,this.c5,this.Aik,this.Fik,this.W3d,null);this.$e.addCssClass(this.Ov.va,"replaceObjectFlyoutAnchorBase");this.$e.addCssClass(this.Ov.va,"replaceObjectFlyoutAnchor"+this.UFg);u&&
(this.$e.addCssClass(this.Ov.va,"replaceObjectFlyoutAnchorAnimBase"),this.$e.addCssClass(this.Ov.va,"replaceObjectFlyoutAnchorAnim"+this.Vxg));return P}ERa(){this.Fh?(this.Pv.clear(),this.$e.removeCssClass(this.Ov.va,"replaceObjectFlyoutAnchorBase"),this.$e.removeCssClass(this.Ov.va,"replaceObjectFlyoutAnchor"+this.UFg),this.Wxg&&(this.$e.removeCssClass(this.Ov.va,"replaceObjectFlyoutAnchorAnimBase"),this.$e.removeCssClass(this.Ov.va,"replaceObjectFlyoutAnchorAnim"+this.Vxg))):L.a.J(25306445,829,
15,"ReplaceObjectFlyoutAnchor::ClearGlyph - called before setup")}dispose(){this.Fh&&(this.D8e(),this.Ov&&this.Ov.va.parentNode&&this.Ov.Dq(),this.dismiss(),this.Pv.dispose(),this.Ov=null,this.Ar=!1)}dismiss(){this.Fh?(this.ERa(),this.yfa.va.style.visibility=mb.a.hidden):L.a.J(25306447,829,15,"ReplaceObjectFlyoutAnchor::Dismiss - called before setup")}qRa(){this.yfa?(this.Ov.va.style.width=this.$e.Pc(this.c5),this.Ov.va.style.height=this.$e.Pc(this.c5),this.Ov.va.setAttribute(Ha.a.hf,Ha.a.Ju),this.yfa.appendChild(this.Ov),
this.Pv.qRa(this.Ov.va),this.aLa()):L.a.J(25306449,829,15,"ReplaceObjectFlyoutAnchor::BuildDom - parentElement is null")}gib(){return!0}aLa(){this.q5&&this.Rc.rb(Ca.a.click,this.Ov.va,this.q5);this.Rc.rb(Ca.a.doubleClick,this.Ov.va,Object(z.a)(this,this.gib,"onDoubleClick"));this.wfa&&(this.Sr.rb(Ca.a.pointerOver,this.Ov.va,this.wfa),this.Sr.rb(Ca.a.pointerOver,this.Ov.va.firstChild,this.wfa),this.Sr.rb(Ca.a.pointerOver,this.Ov.va.firstChild.firstChild,this.wfa))}D8e(){this.q5&&this.Rc.Bb(Ca.a.click,
this.Ov.va,this.q5);this.Rc.Bb(Ca.a.doubleClick,this.Ov.va,Object(z.a)(this,this.gib,"onDoubleClick"));this.wfa&&(this.Sr.Bb(Ca.a.pointerOver,this.Ov.va,this.wfa),this.Sr.Bb(Ca.a.pointerOver,this.Ov.va.firstChild,this.wfa),this.Sr.Bb(Ca.a.pointerOver,this.Ov.va.firstChild.firstChild,this.wfa))}}Object(r.a)(vd,"ReplaceObjectFlyoutAnchor",null,[820,797]);class me{constructor(u,P){this.Sz=null;this.Sk=u;this.$e=P;this.Ar=!1}get Fh(){return this.Ar}get $N(){return this.Sz}setup(){this.Fh||(this.Sz=new Ub.a,
this.qRa(),this.Ar=!0)}qRa(){this.Sk?(this.Sk.appendChild(this.$N.va),this.$e.addCssClass(this.$N.va,"replaceObjectPreviewContainer"),this.$N.setVisibility(!1)):L.a.J(25306518,829,15,"ReplaceObjectPreviewImageView::BuildDom - parentElement is null")}LLa(u){if(this.Fh){if(u=this.Tja(u))this.w0a(),this.$N.va.appendChild(u),this.$N.setVisibility(!0)}else L.a.J(25306520,829,15,"ReplaceObjectPreviewImageView::SetImage - called before setup")}ah(u,P){this.Fh?this.$N.ah(u,P):L.a.J(25306522,829,15,"ReplaceObjectPreviewImageView::SetSize - called before setup")}dispose(){this.Fh&&
(this.dismiss(),this.$N&&this.$N.va.parentNode&&(this.$N.Dq(),this.$e.removeCssClass(this.$N.va,"replaceObjectPreviewContainer")),this.Sz=null)}dismiss(){this.Fh?(this.w0a(),this.$N.setVisibility(!1)):L.a.J(25306524,829,15,"ReplaceObjectPreviewImageView::Dismiss - called before setup")}Tja(u){if(!lb.a.Xa(u)){const P=Rb.a.sB();P.setAttribute("Unselectable","on");P.src=u;P.style.height="100%";P.style.width="100%";return P}return null}w0a(){this.$N.va.firstChild&&this.$N.va.removeChild(this.$N.va.firstChild)}}
Object(r.a)(me,"ReplaceObjectPreviewImageView",null,[797]);var mf=d(996);class cf{constructor(u,P,la,Ba,Sa,pb,Vb){this.Rc=u;this.Sr=P;this.$e=la;this.Jgb=Ba;this.la=Sa;this.ke=pb;this.bEg=Vb}cLi(u,P,la,Ba,Sa){u=Km.CRl(this.la.replaceObjectIconType,Sa)?new Vc(u,this.Rc,this.Sr,la,Ba,this.la,this.ke,this.$e,this.bEg):new vd(u,P,"per","PowerPointDesigner_32x32x32",this,this.Jgb,this.Rc,this.Sr,la,Ba,this.$e,this.la,Sa,this.bEg);u.setup();return u}NNi(u){u=new me(u,this.$e);u.setup();return u}MNi(){return new mf.a(this.$e)}}
Object(r.a)(cf,"ReplaceObjectViewFactory",null,[]);class Bh{constructor(u,P,la){this.$e=u;this.ta=la;this.OZg=P}fXc(u){if(!u)throw Error.argumentNull("shape");var P=u.ZR;u=this.qvb(P.TopLeft);P=this.qvb(P.TopRight);return nb.a.Ql(u,P)}eXc(u){if(!u)throw Error.argumentNull("shape");var P=u.ZR;u=this.qvb(P.TopRight);P=this.qvb(P.BottomRight);return nb.a.Ql(u,P)}q8b(u){return this.fXc(u)*this.pdg()}p8b(u){return this.eXc(u)*this.pdg()}Tpj(u){if(!u)throw Error.argumentNull("shape");var P=u.ZR;u=this.qvb(P.TopLeft);
P=this.qvb(P.TopRight);return ic.a.XM(nb.a.JF(u,P))}C3f(){return this.getBounds(this.OZg.Jc.gC)}getBounds(u){return this.$e.ki(u)}pdg(){const u=this.OZg.Jc;return u?u.UT:1}qvb(u){return new nb.a(u.X,u.Y)}vGa(u){return u?!!this.ta.Ba&&this.ta.Ba.Db.equals(u.slideId):!1}}Object(r.a)(Bh,"ReplaceObjectViewHelper",null,[]);var Fh=d(444);class of{constructor(u,P,la){this.T0=this.o0=null;this.mU=u;this.cpk=P;this.Dcd=la}get CG(){return"ReplaceObjectWacALWorkflow"}get proto(){return'syntax="proto3";message ShapeTextConvertable { string Topic = 1; string Payload = 2; string AppId = 3; string SessionId = 4; string ContextId = 5; };'}get Gtb(){this.o0||
(this.o0=Object.assign(new pn.a,{name:"LambdaBefore_ReplaceObjectWacAL",inputSchema:Fh.a.B0e,outputSchema:Fh.a.B0e,func:Object(z.a)(this,this.$cb,"lambdaBeforeFunc")}));return this.o0}get Vsb(){return null}get SLb(){this.T0||(this.T0=Object.assign(new pn.a,{name:"LambdaRemote_ReplaceObjectWacAL",inputSchema:Fh.a.B0e,outputSchema:"ShapeTextConvertable",func:Object(z.a)(this,this.cre,"lambdaRemoteFunc")}));return this.T0}$cb(u,P,la){if(u&&this.cpk.lne())if(u){try{var Ba=cd.a(u.ContextId)}catch(Sa){L.a.J(37041409,
375,10,"{0}:LambdaBeforeDone - Try parse tile contextId failed",this.CG);la(null);return}this.Dcd.U5j(Ba.t)?this.Dcd.saj(Ba.shapeId)?la(u):(L.a.J(37041411,375,50,"{0}:LambdaBeforeDone - shape invalid",this.CG),la(null)):(L.a.J(38115527,375,50,"{0}:LambdaBeforeDone - trigger invalid",this.CG),la(null))}else la(null),L.a.J(37041379,375,50,"{0}:LambdaBeforeDone -  ShapeTextTile null",this.CG);else L.a.J(37041377,375,50,"{0}:LambdaBeforeDone -  input null or ineligible",this.CG),la(null)}cre(u,P,la){u?
u?this.mU.execute(Ba=>{Ba.rrc(u.Topic,u.Data,u.ContextId,Sa=>{this.nLa(Sa)},Sa=>{this.lLa(Sa)},la)}):la(null):la(null)}nLa(u){if(!v.AFrameworkApplication.Yg&&u&&u.data){var P=u.data.state;if(P){try{var la=cd.a(u.data.ee)}catch(Ba){P(null);L.a.J(36804442,375,10,"Try parse aug response failed:{0}",Ba.message);return}P(la)}}}lLa(u){!v.AFrameworkApplication.Yg&&u&&u.data&&(u=u.data.state)&&u(null)}}Object(r.a)(of,"ReplaceObjectWacALWorkflow",null,[798]);var aj=d(261);class di{constructor(){this.OJe=null}wxc(u){return this.validate(u)?
this.OJe?this.OJe.wxc(u):!0:!1}rml(u){this.OJe=u}}Object(r.a)(di,"ReplaceObjectWall",null,[]);class Gi extends di{constructor(){super();this.tu=null}Qag(u){const P=this.tu.q8b(u);u=this.tu.p8b(u);var la=P*u;const Ba=this.tu.C3f().width,Sa=this.tu.C3f().height;la=la/(Ba*Sa)*100;L.a.J(37041415,829,50,"ReplaceObjectValidationHelper::GetShapeAreaRatio - shapeWidth: {0}; shapeHeight{1}; slideWidth:{2}; slideHeight{3}; ratio: {4}",P,u,Ba,Sa,la);return la}}Object(r.a)(Gi,"AreaRatioWall",di,[]);class Xj extends Gi{constructor(u,
P){super();this.nlk=u;this.tu=P}validate(u){return this.Qag(u)<=this.nlk}}Object(r.a)(Xj,"MaxAreaRatio",Gi,[]);class Qm extends di{constructor(u,P){super();this.klk=u;this.tu=P}validate(u){return this.tu.p8b(u)<=this.klk}}Object(r.a)(Qm,"MaxShapeHeight",di,[]);class to extends di{constructor(u,P){super();this.plk=u;this.tu=P}validate(u){return this.tu.q8b(u)<=this.plk}}Object(r.a)(to,"MaxShapeWidth",di,[]);class Io extends Gi{constructor(u,P){super();this.Clk=u;this.tu=P}validate(u){return this.Qag(u)>=
this.Clk}}Object(r.a)(Io,"MinAreaRatio",Gi,[]);var Jo=d(41);class Wl extends di{constructor(u,P){super();this.Blk=u;this.Ga=P}validate(u){return this.gnj(u,this.Ga)>=this.Blk}gnj(u,P){if(!u)return 0;let la=0;P.eK(u,Ba=>{Ba.Ua(Jo.a.tq)&&(Ba=Ba.eb(Jo.a.tq))&&0<Ba.length&&la++});return la}}Object(r.a)(Wl,"MinParagraphCount",di,[]);class Ko extends di{constructor(u,P){super();this.zlk=u;this.tu=P}validate(u){return this.tu.p8b(u)>=this.zlk}}Object(r.a)(Ko,"MinShapeHeight",di,[]);class Np extends di{constructor(u,
P){super();this.Flk=u;this.tu=P}validate(u){return this.tu.q8b(u)>=this.Flk}}Object(r.a)(Np,"MinShapeWidth",di,[]);class Lo{constructor(u,P,la){this.Qfa=null;this.la=u;this.Ga=P;this.IHb=la;this.init(this.la.replaceObjectClientWalls)}validate(u){return this.Qfa?this.Qfa.wxc(u):!0}init(u){u=this.OPi(u);this.fti(u)}OPi(u){const P={};if(lb.a.Xa(u))return P;u=u.split(";");for(const la of u)lb.a.Xa(la)||(u=la.split(":"),2===u.length?P[u[0]]=u[1]:L.a.J(25192154,829,10,"ReplaceObjectClientWalls::Parse - wall: {0}",
la));return P}fti(u){const P=[];"MinParagraphCount"in u&&Array.add(P,new Wl(aj.d(u,"MinParagraphCount",0),this.Ga));"MinShapeHeight"in u&&Array.add(P,new Ko(aj.b(u,"MinShapeHeight",0),this.IHb));"MaxShapeHeight"in u&&Array.add(P,new Qm(aj.b(u,"MaxShapeHeight",Number.MAX_VALUE),this.IHb));"MinShapeWidth"in u&&Array.add(P,new Np(aj.b(u,"MinShapeWidth",0),this.IHb));"MaxShapeWidth"in u&&Array.add(P,new to(aj.b(u,"MaxShapeWidth",Number.MAX_VALUE),this.IHb));"MinShapeAreaRatio"in u&&Array.add(P,new Io(aj.b(u,
"MinShapeAreaRatio",0),this.IHb));"MaxShapeAreaRatio"in u&&Array.add(P,new Xj(aj.b(u,"MaxShapeAreaRatio",Number.MAX_VALUE),this.IHb));for(u=0;u<P.length-1;u++)P[u].rml(P[u+1]);0<P.length&&(this.Qfa=P[0])}}Object(r.a)(Lo,"ReplaceObjectWalls",null,[762]);class jp{constructor(){this.K=null;this.KO=this.PAe=this.vBe=!1}get name(){return"PowerPointWebEditor.ReplaceObject"}Yb(u){this.K=u;(this.KO=this.K.resolve("PowerPointWebEditor.IApplicationContext").rd.yg)&&this.K.register(ql.a,"PowerPointWebEditor.PodsInfoSender").ma().oa(()=>
new ql.a(v.AFrameworkApplication.Me,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Common.IAppSettingsManager")));u.register(pp,"PowerPointWebEditor.ReplaceObject.ReplaceObjectEventSource").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventSource").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers").ma().oa(()=>
new pp);u.register(Bh,"PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper").ma().oa(()=>new Bh(u.resolve("PowerPoint.IBrowserHelperManager"),u.resolve("PowerPointWebEditor.IActiveSlideViewManager"),u.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));u.register(761,"PowerPointWebEditor.IReplaceObjectGalleryView").ma().oa(()=>new lc(u.resolve("PowerPoint.IBrowserHelperManager"),u.resolve("Common.IPointerInputManager"),u.resolve("Common.IClickInputManager"),u.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
u.resolve("Common.IActionManagerExtended"),u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),u.resolve("PowerPointWebEditor.IInputHandlerManager"),u.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),u.resolve("PowerPointWebEditor.IFocusManager"),u.resolve("PowerPointWebEditor.IApplicationSettings"),u.resolve("Common.IBrowserUtils")));u.register(762,"PowerPointWebEditor.ReplaceObject.IReplaceObjectWalls").ma().oa(()=>
new Lo(u.resolve("PowerPointWebEditor.IApplicationSettings"),u.resolve("PowerPointWebEditor.IShapeReader"),u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper")));u.register(Jc,"PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper").ma().oa(()=>new Jc(u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectWalls"),u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),u.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),u.resolve("PowerPointWebEditor.IApplicationSettings")));
u.register(763,"PowerPointWebEditor.ReplaceObject.IReplaceObjectRequestManager").ma().oa(()=>new Ka(u.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),u.resolve("PowerPointWebEditor.IApplicationSettings").keepCalculateZoomInNativeConsistentWithClientFixIsEnabled));u.register(764,"PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager").ma().oa(()=>u.resolve("Common.IAppSettingsManager").ka("473")?new W((P,la,Ba,Sa,
pb,Vb)=>{const Bc=new un(u.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),u.Ia("PowerPointWebEditor.IDesignerServiceProvider"));Bc.$Ra(P,la,Ba,Sa,pb,Vb);return Bc}):new Qb(new un(u.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),u.Ia("PowerPointWebEditor.IDesignerServiceProvider"))));u.register(765,"PowerPointWebEditor.IReplaceObjectManager").ma().oa(()=>u.resolve("Common.IAppSettingsManager").ka("473")?new ff(u.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),u.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),
u.resolve("PowerPointWebEditor.IFocusManager"),u.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),u.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),u.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),u.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),u.resolve("PowerPointWebEditor.IPptSelectionManager"),u.resolve("Common.IActionManagerExtended"),u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),
u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectRequestManager"),u.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),u.resolve("PowerpointPresence.IPresenceEventHandlers"),u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper"),u.resolve("PowerPointWebEditor.View.IViewEventSource"),u.resolve("PowerPointWebEditor.IApplicationSettings"),
u.resolve("PowerPointWebEditor.IActionNameResolver"),u.resolve("Common.ITaskManager"),u.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),u.Ia("PowerPointWebEditor.IDesignerServiceProvider")):new eo(u.resolve("PowerPointWebEditor.IFocusManager"),u.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),u.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),u.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),u.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
u.resolve("PowerPointWebEditor.IPptSelectionManager"),u.resolve("Common.IActionManagerExtended"),u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),u.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),u.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),
u.resolve("PowerpointPresence.IPresenceEventHandlers"),u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper"),u.resolve("PowerPointWebEditor.View.IViewEventSource"),u.resolve("PowerPointWebEditor.IApplicationSettings"),u.resolve("PowerPointWebEditor.IActionNameResolver"),u.resolve("Common.ITaskManager"),u.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),u.Ia("PowerPointWebEditor.IDesignerServiceProvider")));u.register(na,"PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").ma().oa(()=>
new na(u.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),u.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectView>"),u.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectSuggestionPreviewView>"),u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),
u.resolve("PowerPointWebEditor.IReplaceObjectGalleryView"),u.resolve("PowerPointWebEditor.IFocusManager"),u.resolve("Box4.IPageView").Na,u.resolve("PowerPointWebEditor.IShapeReader")));u.register(Km,"PowerPointWebEditor.ReplaceObject.FlyoutAnchorTimer").ma().oa(()=>new Km(u.resolve("PowerPointWebEditor.IApplicationSettings"),u.resolve("Common.ITaskManager")));u.register(cf,"PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory").ma().oa(()=>new cf(u.resolve("Common.IClickInputManager"),u.resolve("Common.IPointerInputManager"),
u.resolve("PowerPoint.IBrowserHelperManager"),u.resolve("PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory"),u.resolve("PowerPointWebEditor.IApplicationSettings"),u.resolve("PowerPoint.IPathManager"),u.resolve("PowerPointWebEditor.ReplaceObject.FlyoutAnchorTimer")));u.register(191,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectView>").ma().oa(()=>new sd.a((P,la)=>{let Ba=null;const Sa=Object(S.a)(119,P.qc(u.resolve("Box4.IPageView").Na));
Sa&&!Sa.Nl&&Sa.hV&&(Ba=new kc(P,Sa,la,u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory"),u.resolve("Common.IActionManagerExtended"),u.resolve("PowerPoint.IBrowserHelperManager"),u.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),u.resolve("PowerPointWebEditor.IApplicationSettings"),u.resolve("PowerPointWebEditor.IReplaceObjectGalleryView")),
Ba.setup());return Ba}));u.register(191,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectSuggestionPreviewView>").ma().oa(()=>new sd.a((P,la)=>{let Ba=null;const Sa=Object(S.a)(119,P.qc(u.resolve("Box4.IPageView").Na));Sa&&!Sa.Nl&&Sa.hV&&(Ba=new Y(P,Sa,la,u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory"),u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper")),Ba.setup());return Ba}));u.register(of,"PowerPointWebEditor.ReplaceObject.ReplaceObjectWacALWorkflow").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow").ma().oa(()=>
new of(this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),this.K.resolve("PowerPointWebEditor.IReplaceObjectManager"),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper")));u.register(sn,"PowerPointWebEditor.ReplaceObject.ReplaceObjectAugLoopRuntimeManager").ma().oa(()=>new sn(this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow")));u.register(op,"PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").ma().oa(()=>
new op(u.resolve("PowerPointWebEditor.IPptSelectionManager"),u.resolve("Common.IActionManagerExtended"),u.resolve("PowerPointWebEditor.IFocusManager"),u.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),u.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),u.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),u.resolve("PowerPointWebEditor.View.IViewEventSource"),u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),
u.resolve("Common.Transaction.ITransactionFactory"),u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),u.resolve("PowerPointWebEditor.View.IPPTPageView"),u.resolve("PowerPointWebEditor.IShapeReader")));u.register(bo,"PowerPointWebEditor.ReplaceObject.ReplaceIconManager").ma().oa(()=>new bo(u.resolve("PowerPointWebEditor.IPptSelectionManager"),u.resolve("PowerPointWebEditor.View.IViewEventSource"),u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),u.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
u.resolve("PowerPointWebEditor.IShapeReader"),u.resolve("PowerPointWebEditor.IApplicationSettings"),u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),u.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),u.resolve("PowerpointPresence.IPresenceEventHandlers"),u.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),u.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingStatusChecker"),
u.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),u.resolve("PowerPointWebEditor.IActionNameResolver"),u.resolve("PowerPointWebEditor.Core.IUnifiedAppState")))}init(){this.KO&&this.K.resolve("PowerPointWebEditor.PodsInfoSender");const u=this.K.resolve("Common.IAppSettingsManager");u.ff(()=>{const P=new Date;u.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TestEcsFeatureIsEnabled",!1)?L.a.J(512262752,324,50,"PPTO TestEcsFeature Client Flight Enabled."):L.a.J(512262751,324,50,"PPTO TestEcsFeature Client Flight Disabled.");
if(this.vBe=u.ka("463"))u.ka("499")&&this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectAugLoopRuntimeManager").initialize(),this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").setup(),this.K.resolve("PowerPointWebEditor.IReplaceObjectManager").setup();if(this.PAe=u.ka("676"))this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").setup(),
this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceIconManager").setup();L.a.J(512262750,829,50,"ReplaceObject::Callback duration:{0}",+new Date-+P)})}dispose(){this.vBe&&(this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").dispose(),this.K.resolve("PowerPointWebEditor.IReplaceObjectManager").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").dispose(),
this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").dispose());this.PAe&&(this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceIconManager").dispose())}static main(){m.a.instance.Ac(xc.a(new jp,0))}}Object(r.a)(jp,"PPTWebEditorReplaceObjectPackage",
null,[2,3]);var Qq=d(270),kp=d(469),lp=d(1109);class Op{constructor(){this.appName=0;this.wdEnableDownloadTokens=!1;this.retryCount=0;this.wdEnableIterator=this.wdEnableRestore=this.wdEnableSaveACopy=!1;this.uiLocale=this.wacCluster=this.userSessionId=null;this.disableSaveACopy=this.wdEnableShowVersionChanges=this.wdEnableHiddenButtonsUntilVersionLoadComplete=this.viewerRootPositionRelative=this.useXhr=this.isRtl=!1;this.disabledChangeGates=null;this.wdEnableDeleteVersions=this.wdEnableSaveACopyOverFlowMenu=
!1;this.wdExperimentWithIteratorLocation=this.wdEnableAppColorUpdate=null}}Object(r.a)(Op,"AppSettings",null,[]);class mp{constructor(){this.perfTelemetryInfos=this.appSettings=this.docId=this.latestStreamServiceBase=this.serviceBase=this.ulsLogger=null}}Object(r.a)(mp,"ControllerFactoryParameters",null,[]);var En=d(744),ri=d(338);class Zi{}Zi.none="None";Zi.vhFailedToLoadVersionList="VHFailedToLoadVersionList";Zi.vhFailedToGetDownloadToken="VHFailedToGetDownloadToken";Zi.vhFailedToParseVersionList=
"VHFailedToParseVersionList";Zi.vhFetchFailed="VHFetchFailed";Zi.vhVersioningNotEnabled="VHVersioningNotEnabled";Zi.vhFileNotFound="VHFileNotFound";Zi.vhVersionTooOld="VHVersionTooOld";Zi.wTl="VHFailedToRenderThumbnails";Zi.vTl="VHFailedToRenderSlide";Zi.uTl="VHFailedToRenderNotes";Zi.sTl="VHFailedToRenderDiff";Zi.xTl="VHFailedToShowAnimaitonIcon";Zi.yTl="VHFailedToShowHiddenEffect";Zi.tTl="VHFailedToRenderInitPresInfo";Object(r.a)(Zi,"ErrorName",null,[]);class Ln{constructor(){this.UIa=new sc.a;
this.UIa.add(0,Zi.none);this.UIa.add(100,Zi.vhFailedToLoadVersionList);this.UIa.add(101,Zi.vhFailedToGetDownloadToken);this.UIa.add(102,Zi.vhFailedToParseVersionList);this.UIa.add(103,Zi.vhFetchFailed);this.UIa.add(104,Zi.vhVersioningNotEnabled);this.UIa.add(105,Zi.vhFileNotFound);this.UIa.add(106,Zi.vhVersionTooOld);this.rJa=new sc.a;this.rJa.add(0,Zi.none);this.rJa.add(100,Zi.wTl);this.rJa.add(101,Zi.vTl);this.rJa.add(102,Zi.uTl);this.rJa.add(103,Zi.sTl);this.rJa.add(104,Zi.xTl);this.rJa.add(105,
Zi.yTl);this.rJa.add(106,Zi.tTl)}get frl(){return this.UIa}get MTl(){return this.rJa}static fbg(){Ln.YXe||(Ln.YXe=new Ln);return Ln.YXe}}Ln.rGf="ErrorCode";Ln.YXe=null;Object(r.a)(Ln,"VersionHistoryTelmetryHelper",null,[]);var us=d(312);class qh{constructor(u,P,la,Ba,Sa,pb,Vb,Bc,Yc,gd,Td,Re,Uf,Ef,Oh,ek,je){this.Okc=this.LE=this.tEg=this.Bbd=this.cDb=this.R4=this.oHe=this.kY=this.BH=null;this.Pva=-1;this.IDb=null;if(!je)throw Error.argumentNull("clientRequestManager");this.ia=u;this.Pw=P;this.Hi=la;
this.Ea=Ba;this.oc=Sa;this.vZa={};this.Fa=pb;this.Dg=Vb;this.SGb={};this.pc=Yc;this.kfd={};this.Onk=Bc;this.zfa=gd;this.Ya=Td;this.mve=[];Re&&(this.tEg=Re,this.tEg.execute(Qf=>{this.LE=Qf}));this.yO=Uf;this.Zg=Ef;this.gue=Oh;this.mHb=ek;this.Su=je}vb(){this.ia.ya(G.a.juc,J.a.frame,Object(z.a)(this,this.Jxl,"showVersionHistoryDialogAction"));this.Ea.pptEnablePreviousVersionsOptionForOneDriveConsumer||this.ia.ya(tb.a.Lgh,J.a.frame,Object(z.a)(this,this.$Pe,"pptoShowFileVersion"));this.ia.ya(tb.a.aQh,
J.a.frame,Object(z.a)(this,this.xGj,"handleVersionHistoryCopySlides"))}Jxl(u,P,la){if(1===la)return u=!1,this.Ya.vea&&(u=!0),u?2:32;2===la&&(v.AFrameworkApplication.dM("Microsoft.Office.Server.Powerpoint.Web.IDocsPptPPTVersionHistorySaveACopyOverFlowMenuSettings"),v.AFrameworkApplication.dM("Microsoft.Office.Server.Powerpoint.Web.IDocsPptVersionHistoryDeleteVersions"),this.Okc=ua.a.create().toString(),n.ULS.sendTraceTag(512508634,822,50,"Execute ShowVersionHistoryDialogAction. VersionHistoryLaunchSessionId: {0}",
this.Okc),rc.c(tb.a.Zch,!0),this.vZa.VersionHistoryLaunchSessionId=this.Okc,this.SGb.VersionHistoryLaunchSessionId=this.Okc,this.vZa.ShowVersionHistoryDialog=(new Date).getTime().toString(),this.Bbd=[],this.BH||(u=new us.a(this.Ea.Caa),this.BH=versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Object.assign(new mp,{ulsLogger:new kp.a,serviceBase:this.Ea.getSetting("VersionHistoryWebServiceBase"),latestStreamServiceBase:this.Ea.ka("PPTVHPodsBootEnabled")?this.Ea.getSetting("PODSLatestServiceBase")+
"&PodSID="+this.Ea.getSetting("PodSID"):"",docId:v.AFrameworkApplication.gh,appSettings:Object.assign(new Op,{appName:100,wdEnableDownloadTokens:!0,retryCount:this.Ea.getSetting("PodVHRetryCount"),wdEnableSaveACopy:this.pc.Pn,wdEnableRestore:this.pc.Pn,userSessionId:v.AFrameworkApplication.userSessionId,wacCluster:this.Ea.Ha("WacCluster"),uiLocale:this.Ea.uKa?this.Ea.uKa:"en-us",isRtl:v.AFrameworkApplication.isRtl,disabledChangeGates:this.Ea.Ha("VHSDisabledChangeGates"),wdEnableSaveACopyOverFlowMenu:this.Ea.ka("PPTVersionHistorySaveACopyOverFlowMenuIsEnabled"),
wdEnableDeleteVersions:this.Ea.ka("PPTVersionHistoryDeleteVersionsIsEnabled"),hZl:u.W1i||this.Ea.ka("DisableVHSPOFileCache")}),perfTelemetryInfos:this.Bbd}))),this.BH&&this.BH.setDisableSaveACopy(v.AFrameworkApplication.cC),this.Kxl());return 32}$Pe(u,P,la){return 1===la&&this.Ya.vea?2:this.ia.processAction(G.a.Ztc,la)}xGj(u,P,la){if(1===la)return this.WAh()?2:32;this.kY.onCopySlides();return 32}Kxl(){var u;if(!document.getElementById("VersionHistoryOverlay")){this.v3k();this.r3k();this.s3k();this.m3k();
this.k3k();this.q3k();this.p3k();this.n3k();const P=document.createElement("div");P.id="VersionHistoryOverlay";P.style.width="100%";P.style.zIndex="998";P.style.display="block";P.style.position="absolute";P.style.top="0px";if(this.Ea.ka("RegionComposerIsEnabled")){const la=(null===(u=document.getElementById("HeaderRegion"))||void 0===u?void 0:u.offsetHeight)||0;P.style.top=la+"px";P.style.bottom="0px";P.style.height=`calc(100vh - ${la}px)`}else P.style.height="calc(100% + "+qa.AFrame.Yud+"px)";document.getElementById("WACInnerFrame").appendChild(P);
this.oHe=this.BH.createVersionHistoryDialog(P);this.Alb()}document.getElementById("VersionHistoryOverlay").style.display="block";this.BH.getTipVersion&&this.Ea.ka("PPTVHPodsBootEnabled")&&this.BH.getTipVersion();this.BH.getVersions("");this.yai()}yai(){try{this.IDb=this.Onk.uej();for(let u=0;u<this.IDb.length;u++)this.Dg.Eo(this.IDb[u]);this.Dg.DI(Ad.a.vRb)}catch(u){n.ULS.sendTraceTag(512508633,822,10,"VersionHistoryPaneActor: exception in ActivateVersionHistoryFocus: {0}.",u)}}aRi(){try{if(this.IDb)for(let u=
0;u<this.IDb.length;u++)this.Dg.DI(this.IDb[u]);else n.ULS.sendTraceTag(512508632,822,10,"VersionHistoryPaneActor: editorActiveF6Focuses is null.");this.Dg.Eo(Ad.a.vRb)}catch(u){n.ULS.sendTraceTag(512508631,822,10,"VersionHistoryPaneActor: exception in DeactivateVersionHistoryFocus: {0}.",u)}}v3k(){this.BH.getFullAppErrorEvent().addListener(u=>{try{const P=Ln.fbg().frl.ga(u);this.SGb[Ln.rGf]=P;n.ULS.sendTraceTag(512508630,822,50,"FullApp Error Event: {0}, VersionHistoryLaunchSessionId: {1}",P,this.Okc)}catch(P){n.ULS.sendTraceTag(512508629,
822,10,"Exception in FullAppErrorEvent call back: {0}.",P)}})}r3k(){this.BH.getVersionsReadyEvent().addListener(u=>{this.brh(u.containerDiv);this.Iei(u.versions);this.Fa.XU("VersionHistoryOverlay",!0);try{this.R4&&this.R4.DownloadUrl.length&&this.kY&&(this.bRh(),this.Fjg(),this.kY.onVersionSelected(this.R4,this.cDb,this.vZa),this.zKf())}catch(P){n.ULS.sendTraceTag(512508628,822,10,"VersionHistoryPaneActor: Exception in VersionReadyEvent callback: {0}",P)}})}Iei(u){const P=this.kY.getAppDataStore();
for(const la of u)P.AddVersionInfoToStore(la)}s3k(){this.BH.getVersionSelectedEvent().addListener(u=>{this.R4=u.currentVersion;this.cDb=u.baseVersion;if(this.kY&&this.R4.DownloadUrl.length)try{this.bRh(),this.Fjg(),this.kY.onVersionSelected(u.currentVersion,u.baseVersion,this.vZa),this.O4k(),this.zKf()}catch(P){n.ULS.sendTraceTag(512508627,822,10,"VersionHistoryPaneActor: Exception in VersionSelectedEvent callback: {0}",P)}})}O4k(){const u=this.V8b(2);u&&(Be.a.addHandler(u,Ca.a.Bf,Object(z.a)(this,
this.kA,"keyDownHandler")),cj.a.instance.rb(u,Object(z.a)(this,this.MC,"contextMenuHandler")))}tMl(){const u=this.V8b(2);u&&(Be.a.removeHandler(u,Ca.a.Bf,Object(z.a)(this,this.kA,"keyDownHandler")),cj.a.instance.Bb(u,Object(z.a)(this,this.MC,"contextMenuHandler")))}kA(u){try{if(u.shiftKey&&u.keyCode===oa.a.gqa||u.keyCode===oa.a.lNa){const P=lp.a.create(Ca.a.contextMenu,u,1);this.MC(P)}}catch(P){n.ULS.sendTraceTag(512508626,822,10,"VersionHistoryPaneActor:  Exception in KeyDownHandler: {0}",P)}}MC(u){if(1===
u.ng){const P=this.V8b(2);P&&(u.clientPoint.x=cb.a.E9d(P)+Of.a.Jsa,u.clientPoint.y=cb.a.G9d(P)+Of.a.Jsa)}return 32===this.ia.Ka(tb.a.oNf,2,u)}m3k(){this.BH.getDownloadTokenReadyEvent().addListener(u=>{try{if(n.ULS.sendTraceTag(512508625,822,50,"VersionHistoryPaneActor - GetDownloadTokenReadyEvent called."),this.cDb)if(u&&u.updatedVersions&&2<=u.updatedVersions.length){let P=null,la=null;const Ba=qh.g8b(this.R4),Sa=qh.g8b(this.cDb);for(const pb of u.updatedVersions){const Vb=qh.g8b(pb);if(Ba===Vb){if(this.Ea.ka("DisableVHSPOFileCache")){const Bc=
this.Ea.popsServiceBase+"VersionHistoryDownloadLink.ashx?",Yc=v.AFrameworkApplication.gh;if(Yc){const gd=new ya.QueryStringBuilder(Bc+Yc);gd.jg(fi.a.XLk,pb.downloadUrl);gd.jg(fi.a.VLk,Vb);pb.downloadUrl=gd.toString();n.ULS.sendTraceTag(508940565,822,50,"VersionHistoryPaneActor - registerForDownloadTokenReadyEvent - Generated download URL")}else n.ULS.sendTraceTag(508936896,822,15,"VersionHistoryPaneActor - registerForDownloadTokenReadyEvent - QuerySignature not found")}P=pb}else Sa===Vb&&(la=pb);
if(P&&la)break}P&&la?(this.R4=P,this.cDb=la,this.kY.diff(this.R4,this.cDb)):n.ULS.sendTraceTag(512508623,822,50,"VersionHistoryPaneActor - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: {0}, RevisionID[N-1]: {1}.",Ba,Sa)}else n.ULS.sendTraceTag(512508622,822,50,"VersionHistoryPaneActor - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");else n.ULS.sendTraceTag(512508624,822,50,"VersionHistoryPaneActor - m_baseVersion is null in GetDownloadTokenReadyEvent callback.")}catch(P){n.ULS.sendTraceTag(512508621,
822,10,"VersionHistoryPaneActor: Exception in GetDownloadTokenReadyEvent callback: {0}",P)}})}q3k(){this.BH.getSaveACopySelectedEvent().addListener(u=>{n.ULS.sendTraceTag(512508620,822,10,"VersionHistoryPaneActor:  RegisterForSaveACopySelectedEvent: {0}",u);this.Ea.ka("PowerPointVersionHistoryFloodGateIsEnabled")&&qh.qzk();let P=v.AFrameworkApplication.OBb;this.Ea.ka("VHSaveACopyForOdcOnSpoEnabled")&&(P=32===this.ia.processAction(tb.a.Ooc,1));u=P?this.ia.Ka(tb.a.Ooc,2,{["FileDownloadUrl"]:u}):this.ia.Ka(G.a.Jkb,
2,{["FileDownloadUrl"]:u});32!==u?(rc.c(tb.a.hZd,!1),n.ULS.sendTraceTag(512508619,832,10,"Failed to launch Save a Copy dialog. ActionResponse: {0}",u)):rc.c(tb.a.hZd,!0)})}XJh(u,P){try{(new Promise((la,Ba)=>{this.BH.setRestoreInProgress();this.zfa.NMc(this.Ya.Uk,this.Ya.podSessionId,this.Ya.presentationId.string,this.Ea.getSetting("361"),this.Ya.Baa,!1,!0,()=>{la(!0)},Sa=>{Ba("ClosePopWacSessionSync:: "+Sa.error.message)})})).then(()=>{(new Promise((la,Ba)=>{this.zfa.Spd(this.Ya.presentationId.string,
u,()=>{la(!0)},Sa=>{Ba("RestoreFileVersion:: "+Sa.error.message)})})).then(()=>{const la=Date.now()-P;n.ULS.sendTraceTag(512508618,832,50,"VersionHistoryPaneActor: successfully restored version, refreshing now. Time: {0}",la);this.SGb.RestoreSucceededTime=la;this.ia.Ka(tb.a.refresh,2,{["IsSourceVH"]:!0});rc.c(tb.a.Z1b,!0)}).catch(la=>{const Ba=Date.now()-P;this.BH.setRestoreFailedAtServer(()=>{this.ia.Ka(tb.a.refresh,2,{["IsSourceVH"]:!0})});n.ULS.sendTraceTag(512508617,832,10,"VersionHistoryPaneActor: Failed to restore version: {0}, Time: {1}",
la,Ba);this.SGb.RestoreFailedTime=Ba;rc.c(tb.a.Z1b,!1)})})}catch(la){n.ULS.sendTraceTag(512508616,832,10,"VersionHistoryPaneActor: Sending restore failed with message: {0}",la.message),rc.c(tb.a.Z1b,!1)}}p3k(){this.BH.getRestoreVersionSelectedEvent().addListener(u=>{n.ULS.sendTraceTag(512508615,832,50,"VersionHistoryPaneActor:  RegisterForRestoreVersionSelectedEvent: {0}",u);const P=Date.now();this.LE?(this.mve=this.LE.W6b(),0<this.mve.length?(n.ULS.sendTraceTag(512508614,832,15,"VersionHistoryPaneActor: restore failed because of {0} coauthors",
this.mve.length),rc.c(tb.a.Z1b,!1),this.BH.setCoauthRestoreError(),this.Ea.ka("PPTVersionHistoryRestoreSurveyEnabled")&&qh.f8j()):this.XJh(u,P)):(n.ULS.sendTraceTag(512508613,832,10,"VersionHistoryPaneActor: presence manager is null"),this.XJh(u,P))})}n3k(){this.BH.getDownloadVersionSelectedEvent().addListener(u=>{n.ULS.sendTraceTag(512508612,832,50,"VersionHistoryPaneActor: RegisterForDownloadVersionSelectedEvent called");u=new ya.QueryStringBuilder(u);u.jg(fi.a.feh,v.AFrameworkApplication.fileName);
u=this.ia.Ka(G.a.downloadACopy,2,{["FileDownloadUrl"]:u.toString()});32!==u?(rc.c(tb.a.gZd,!1),n.ULS.sendTraceTag(512508611,832,10,"Download version failed with result: {0}",u)):rc.c(tb.a.gZd,!0)})}bRh(){for(const u of this.Bbd){const P=u.TelemetryEventKey?u.TelemetryEventKey:u.telemetryEventKey?u.telemetryEventKey:"",la=u.TelemetryEventData?u.TelemetryEventData:u.telemetryEventData?u.telemetryEventData:"";lb.a.Xa(P)||lb.a.Xa(la)||(this.vZa[P]=la)}}zKf(){this.Bbd=[];this.vZa={}}k3k(){this.BH.getCloseSelectedEvent().addListener(()=>
{this.Ea.ka("PowerPointVersionHistoryFloodGateIsEnabled")&&qh.e8j();this.jLf()})}jLf(){this.aRi();this.Fa.q1("VersionHistoryOverlay");document.getElementById("VersionHistoryOverlay").style.display="none";this.Ea.eEf&&(this.R4=null);n.ULS.sendTraceTag(512508610,822,50,cd.c(this.SGb))}brh(u){try{if(this.kY)Sf.setIsPageLoadForFirstTime(!1),this.kY.switchParentViewContainer(u);else{Sf.setIsPageLoadForFirstTime(!0);const P=new PowerPointVersionHistory.AppBootSettings;P.RenderServiceBase="";P.IsRtl=v.AFrameworkApplication.isRtl;
const la=new PowerPointVersionHistory.AppCallbackBag;la.animationDecoratorCallback=Object(z.a)(this.Pw,this.Pw.s0d,"createAnimationOrTransitionStar");la.notesIconDecoratorCallback=Object(z.a)(this,this.KMi,"createNotesIcon");la.addToF6LoopCallback=Object(z.a)(this,this.qei,"addToF6Loop");la.copySlideCallback=Object(z.a)(this,this.copySlideCallback,"copySlideCallback");la.reportViewerErrorCallback=Ba=>{this.SGb[Ln.rGf]=Ln.fbg().MTl.ga(Ba);106!==Ba&&103!==Ba||this.BH.setViewerError(!0);n.ULS.sendTraceTag(512508609,
822,50,"Versions viewer error: {0}",Ba);0!==Ba&&(v.AFrameworkApplication.Oo(bl.a.Oh(406)),Wf.Health.instance.recordQosError("VersionHistoryFailed",["VersionHistoryACE"],!1,!1,!0,!1,null));return!0};P.IsHighContrast=!1;this.Hi&&(P.IsHighContrast=this.Hi.isInHighContrastMode);P.IsHighContrast&&(P.ClientColorSettings=this.Hi.highContrastColors.foregroundTextColor+"_"+this.Hi.highContrastColors.backgroundColor+"_"+this.Hi.highContrastColors.linkColor);if(this.oc){const Ba=this.oc.oUa();P.DefaultSlideWidth=
Ba.width;P.DefaultSlideHeight=Ba.height}P.UserSessionId=v.AFrameworkApplication.userSessionId;P.VersionViewerCssUrl=this.Ea.versionHistoryViewerCssUrl;P.ProgressImageResourceUrl=$f.a.JN(Of.a.Foa);P.ThumbnailShareOptimizationEnabled=this.Ea.pptvhThumbnailShareOptimizationEnabled;P.SlidePrefetchSettings=Object.assign(new PowerPointVersionHistory.SlidePrefetchSettings,{SlidePrefetchEnabled:this.Ea.ka("PPTVHSlidePrefetchEnabled"),SlidePrefetchAhead:this.Ea.getSetting("PPTVHSlidePrefetchAhead"),SlidePrefetchBehind:this.Ea.getSetting("PPTVHSlidePrefetchBehind"),
SlidePrefetchChunkSize:this.Ea.getSetting("PPTVHSlidePrefetchChunkSize"),SlidePrefetchDelay:this.Ea.getSetting("PPTVHSlidePrefetchDelay")});P.FileExtension=void 0!==this.Ea.tKa&&null!==this.Ea.tKa?lb.a.AQ(this.Ea.tKa).toLowerCase():"";P.SlideInformationLabel=ResourceStrings.l_SlideMenuButtonLabel;P.NotesButtonLabel=ResourceStrings.L_Notes;P.SynchronizerTimeout=this.Ea.getSetting("PptVersionHistorySynchronizerTimeout");P.IsRtl=v.AFrameworkApplication.isRtl;P.IsCopySlidesEnabled=!0;P.SlidePaneLabel=
ResourceStrings.L_SlidePaneLabelVH;P.ThumbnailPaneLabel=ResourceStrings.L_ThumbnailPaneLabelVH;P.NotesPaneLabel=ResourceStrings.L_NotesPaneLabelVH;P.StatusBarLabel=ResourceStrings.L_StatusBarLabelVH;P.Lcid=v.AFrameworkApplication.lcid;P.EnableOverflowXOnSlideAndNotePane=this.Ea.ka("PodVHEnableOverflowXOnSlideAndNotePane");P.ThumbnailInfoLabel=ResourceStrings.L_ThumbnailInfoLabelVH;P.IsModernCatchUpUxEnable=!0;P.IsRevisionTrackingFlyoutEnabled=Ud.a("EnableRevisionTrackingFlyoutForVH");P.RevisionTrackingFlyoutContent=
ResourceStrings.l_SlideIsChanged;this.kY=new PowerPointVersionHistory.AppVersionController(P,u,la)}}catch(P){this.BH.setViewerError(!0),n.ULS.sendTraceTag(512508608,822,50,"PPTVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",P)}}KMi(){return ha.createClusteredImage(14,14,"ToolbarNotesActiveDark_14x14x32",null,!0,ResourceStrings.L_Notes)}Alb(){const u=this.Fa.Fc("VersionHistoryOverlay");u.parent=qa.AFrame.Xi;u.uJ=!0;u.XWe=!0;u.Lca(P=>{P&&"dialog/modal"===P.name?
this.BH.setSaveACopyCanceled():P&&P.name===qa.AFrame.jP||(this.Pva=-1,this.TKh(!0))});this.Dg.e3("VersionHistoryOverlay");this.Dg.Qsc(Ad.a.vRb,P=>{this.TKh(P)});this.Dg.MNb(Ad.a.vRb,()=>{2===this.Pva&&Sys.UI.DomElement.addCssClass(this.V8b(2),"PPTVHViewerElementSelected");3===this.Pva&&Sys.UI.DomElement.addCssClass(this.V8b(3),"PPTVHViewerElementSelected")})}TKh(u){try{const P=this.MXc();(this.Pva=this.fmj(u))?1===this.Pva?this.oHe.then(la=>{la.enterHeaderFocusTrapZone();return null}):P&&ud.FocusManager.Zq(document.getElementById(P[this.Pva])):
this.oHe.then(la=>{la.enterFocusTrapZone();return null})}catch(P){n.ULS.sendTraceTag(512508579,822,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",P)}}fmj(u){const P=this.MXc();let la=this.Pva;do if(u?P&&(la=(la+1)%P.length):P&&(la=0<la?la-1:P.length-1),!la||1===la||P&&"none"!==document.getElementById(P[la]).style.display)return la;while(la!==this.Pva);return 0}Fjg(){const u=qh.g8b(this.R4);this.kfd[u]||(this.kfd[u]=["VersionListPane","vhHeader"],this.Pva=-1)}MXc(){if(!this.R4)return this.Ea.eEf?
["VersionListPane","vhHeader"]:null;const u=qh.g8b(this.R4);return this.kfd[u]?this.kfd[u]:null}V8b(u){const P=this.MXc();return P&&P.length>u?document.getElementById(P[u]):null}qei(u){try{const P=this.MXc();P&&P.push(u)}catch(P){n.ULS.sendTraceTag(512508578,822,10,"VersionHistoryPaneActor: exception in AddToF6Loop: {0}.",P)}return!0}copySlideCallback(u){if(this.WAh())return!1;const P=ua.a.create().toString();n.ULS.sendTraceTag(512508577,832,50,"Execute CopySlideCallback - correlationid : {0}",P);
const la=this.yO.hOc(1,u.SlideIds.length),Ba={};Ba.WacSessionId=v.AFrameworkApplication.userSessionId;Ba.CallerCorrelationId=P;var Sa={};Sa.Source=u.Source;Sa.SlideIds=u.SlideIds;Sa.CcpId=la.Jp;Sa.PackageAccessKey=la.Ky;u=JSON.stringify(Sa);Sa=String.format("{0}{1}",this.Ea.podsWebServiceBase,"vhcopyslide.ashx");const pb=Date.now();try{if(this.Su.zj(Sa,2,u,Ba,!1,0,Vb=>{qh.rTl(Vb,pb,P)},Vb=>{qh.qTl(Vb,pb,P)},null,null),this.Zg.contentWindow&&this.Zg.contentWindow.document&&this.Zg.contentWindow.document.body){Rb.a.S1b(this.Zg);
const Vb=Rb.a.kda();Vb.innerText=Rb.a.T5g;Vb.setAttribute(ri.a.Jp,la.Jp);Vb.setAttribute(ri.a.QD,la.QD);Vb.setAttribute(ri.a.count,la.objectCount.toString());const Bc=En.a(la.dataType);Vb.setAttribute(ri.a.type,Bc);Vb.setAttribute(ri.a.location,la.location);Vb.setAttribute(ri.a.Ky,la.Ky);this.Zg.contentWindow.document.body.appendChild(Vb);this.gue.c1a(this.Zg);this.mHb.copy(this.Zg)}else n.ULS.sendTraceTag(512508576,832,10,"VersionHistoryPaneActor cannot set minimal HTML metadata to system clipboard ")}catch(Vb){n.ULS.sendTraceTag(512508575,
832,10,"VersionHistoryPaneActor exception in CopySlideCallback: {0}",Vb)}return!0}WAh(){return(v.AFrameworkApplication.fK||v.AFrameworkApplication.cC)&&!v.AFrameworkApplication.QSa}dispose(){document.getElementById("VersionHistoryOverlay")&&"none"!==document.getElementById("VersionHistoryOverlay").style.display&&this.jLf();this.tMl()}static g8b(u){return u.RevisionID?u.RevisionID:u.revisionID?u.revisionID:""}static rTl(u,P,la){const Ba=Date.now();try{JSON.parse(u.data.ee).IsCopied?n.ULS.sendTraceTag(512508574,
832,50,"VhCopySlide operation succeeded : Duration : {0}, correlationId : {1}",Ba-P,la):n.ULS.sendTraceTag(512508573,832,10,"VhCopySlide operation failed : Duration : {0}, correlationId : {1}",Ba-P,la)}catch(Sa){n.ULS.sendTraceTag(512508572,832,10,"VersionHistoryPaneActor exception in VHCopySlideRequestSucceeded: {0}, correlationId : {1} ",Sa,la)}}static qTl(u,P,la){const Ba=Date.now();n.ULS.sendTraceTag(512508571,832,10,"VhCopySlide operation failed : Duration : {0}, HttpStatusCode : {1}, correlationId : {2}",
Ba-P,u.data?u.data.Ke:-1,la)}static e8j(){const u=w.a.instance.qb("Common.ISystemInitiatedFeedback");u?(u.logActivity("VersionHistoryExited",null),u.logActivity("VersionHistoryCheckExited",null)):n.ULS.sendTraceTag(512508570,822,50,"ISystemInitiatedFeedback was null")}static qzk(){const u=w.a.instance.qb("Common.ISystemInitiatedFeedback");u?u.logActivity("VersionHistoryExited",null):n.ULS.sendTraceTag(512508569,822,10,"ISystemInitiatedFeedback was null")}static f8j(){const u=w.a.instance.qb("Common.ISystemInitiatedFeedback");
u?u.logActivity("VersionHistoryRestoreCoauthFailed",null):n.ULS.sendTraceTag(512508568,822,10,"LaunchVHRestoreFailedDuringCoauthFloodgateSurvey::ISystemInitiatedFeedback was null")}}Object(r.a)(qh,"VersionHistoryPaneActor",null,[818,107]);class Cr{constructor(){this.DEc=this.Da=null}get name(){return"PowerPointWebEditor.VersionHistory"}Yb(u){this.Da=u}init(){v.AFrameworkApplication.fa.ff(Object(z.a)(this,this.en,"onFullAppSettingsReady"))}en(){v.AFrameworkApplication.D3c()?this.Da.resolve("PowerPointWebEditor.IApplicationSettings").Z1c?
n.ULS.sendTraceTag(42755924,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the file is open password protected"):(n.ULS.sendTraceTag(39711108,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Initializing the React VersionHistory package"),ac.a.get_instance().Mj(7,()=>{lg.a(this.Da)("versionHistory").catch(u=>n.ULS.sendTraceTag(39711109,811,10,"Failed to load the resources for the versionHistory feature: {0}",u)).then(()=>this.aJk()).catch(u=>
n.ULS.sendTraceTag(39711110,811,10,"Failed to initialize the versionHistory feature: {0}",u))})):n.ULS.sendTraceTag(39711106,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the feature is disabled")}aJk(){this.g3b();return null}g3b(){this.Da.register(qh,"PowerPointWebEditor.VersionHistory.VersionHistoryPaneActor").oa(()=>new qh(v.AFrameworkApplication.Ra,this.Da.resolve("PowerPointWebEditor.IThumbnailViewHelper"),this.Da.resolve("Common.Utils.IHighContrastDetector"),
this.Da.resolve("PowerPointWebEditor.IApplicationSettings"),this.Da.resolve("PowerPointWebEditor.IPresentationReader"),ud.FocusManager.instance(),Qq.a.instance,this.Da.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.Da.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.Da.resolve("PowerPointWebEditor.IPopWebService"),this.Da.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.Da.Ia("PowerpointPresence.IPresenceManager"),this.Da.resolve("PowerPointWebEditor.IClipServiceManager"),this.Da.resolve("PowerPointWebEditor.IDesignModeManager").cDa,
this.Da.resolve("PowerPoint.IBrowserHelperManager"),this.Da.resolve("PowerPointWebEditor.ISystemClipboard"),v.AFrameworkApplication.Me)).ma();this.DEc=this.Da.resolve("PowerPointWebEditor.VersionHistory.VersionHistoryPaneActor");this.DEc.vb()}dispose(){this.DEc&&this.DEc.dispose()}}Object(r.a)(Cr,"PPTWebEditorVersionHistoryPackageManager",null,[2,3]);var sp=d(462),Ro=d(742),tp;(function(u){u[u.anyone=0]="anyone";u[u.organization=1]="organization"})(tp||(tp={}));Object(r.b)("AccessControlEnum",tp);
var kq=d(337);class Sq{constructor(){this.token=this.timeStamp=null}}Object(r.a)(Sq,"CachedAccessToken",null,[]);class fm{constructor(u){this.kue={};this.Ogk=u}yvi(u,P){if(!lb.a.Xa(u)&&!lb.a.Xa(P)){const la=new Sq;la.token=P;la.timeStamp=new Date;this.kue[u]=la}}B4f(u){return u in this.kue&&(u=Object(S.a)(Sq,this.kue[u]),+new Date-+u.timeStamp<6E4*this.Ogk)?u.token:null}}Object(r.a)(fm,"AccessTokenCache",null,[]);class lq{constructor(){this.reject=this.resolve=this.frame=this.rga=this.j$e=this.resource=
this.appId=this.authority=this.id=null;this.Qmb=0;this.vWe=null;this.soc=0;this.aLh=!1}}Object(r.a)(lq,"DirectAuthRequest",null,[]);class Tq{constructor(u){this.Iic={};this.la=u;this.wHb=new fm(this.la.JQk);window.addEventListener("message",Object(z.a)(this,this.lal,"requestCompletionMessageHandler"),!1)}H7f(u){const P={},la=RegExp("[#?&]+([^=&]+)=([^&]*)","gi");let Ba;for(;Ba=la.exec(u);)P[Object(S.a)(String,Ba[1])]=Object(S.a)(String,Ba[2]);return P}lal(u){if("data"in u){var P;({Nu:P}=cd.d(u.data)).returnValue&&
P&&"DirectAuthRequestID"in P&&this.kzb(P)}}kzb(u){try{const Ba=u.DirectAuthRequestID;if(Ba in this.Iic){var P=null,la=Object(S.a)(lq,this.Iic[Ba]);if(la&&la.id===Ba){L.a.J(594405506,833,50,"DirectAuth: Request completed with request ID: {0}, IsTimedOut: {1}, IsFromPolling: {2}",Ba,"Timeouted"in u,"FromPolling"in u);window.clearTimeout(la.Qmb);delete this.Iic[Ba];window.clearTimeout(la.soc);const Sa=new kq.a;Sa.IsSuccess=!1;Sa.ErrorCode="";Sa.ErrorMessage="";Sa.Token="";"Timeouted"in u?(L.a.J(592238722,
833,10,"DirectAuth: Request timed out with host: "+window.location.host),Sa.ErrorCode="Timeout",Sa.ErrorMessage="No response received in time for the authentcation request",la.resolve(Sa)):"PopupWindowClosed"in u&&la.rga?(Sa.ErrorCode="User_aborted",Sa.ErrorMessage="User aborted log in by closing the popup window",la.resolve(Sa)):(la.frame?P=this.H7f(la.frame.contentWindow.location.hash):la.rga&&!la.rga.closed&&(P=this.H7f(la.rga.location.hash)),"access_token"in P?(Sa.IsSuccess=!0,Sa.Token=Object(S.a)(String,
P.access_token),this.wHb&&this.wHb.yvi(la.vWe,Sa.Token),la.resolve(Sa)):(Sa.ErrorCode="error"in P?Object(S.a)(String,P.error):"unknown",0<=Array.indexOf(this.la.LQk,Sa.ErrorCode)&&la.aLh&&la.frame&&!la.rga?this.jQk(la.authority,la.appId,la.resource,la.j$e,this.la.MQk).then(pb=>{la.resolve(pb)}).catch(pb=>{la.reject(pb)}):(Sa.ErrorMessage="error_description"in P?Object(S.a)(String,P.error_description):"unknown",la.resolve(Sa))));la.frame?document.body.removeChild(la.frame):la.rga&&!la.rga.closed&&
la.rga.close()}else L.a.J(594068425,833,10,"DirectAuth: Failed to find the request entry for ID: {0}",Ba)}else L.a.J(594405508,833,50,"DirectAuth: Request response doesn't have request ID! Details: "+JSON.stringify(u))}catch(Ba){L.a.J(594375829,833,10,"DirectAuth: Excpetion thrown when handling completion response: "+Ba.message)}}MMf(){const u=window.location.protocol,P=window.location.host;var la="/p/";L.a.J(594113502,833,50,"DirectAuth: ConstructReplyUrl: Protocol: {0}, Host: {1}, IsReplyUrlRegistered: {2}",
u,P,"ffc-powerpoint.officeapps.live.com"===P||"ppc-powerpoint.officeapps.live.com"===P);if(void 0===la||null===la){la=window.location.pathname;const Ba=la.lastIndexOf("/");la=0<=Ba?la.substring(0,Ba+1):""}return u+"//"+P+la+"WacDirectAuth.html"}JJl(u,P,la,Ba,Sa,pb=!1){return this.Txl(u,P,la,Ba,Sa,pb)}jQk(u,P,la,Ba,Sa){if(lb.a.Xa(u))throw Error.argumentNull("authority");if(lb.a.Xa(P))throw Error.argumentNull("appId");if(lb.a.Xa(la))throw Error.argumentNull("resource");if(lb.a.Xa(Ba))throw Error.argumentNull("userUPN");
const pb=!lb.a.Xa(Ba)&&Ba.indexOf("@")<Ba.indexOf("."),Vb=this.MMf(),Bc=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&redirect_uri={3}",u,P,encodeURIComponent(la),encodeURIComponent(Vb));if(this.wHb){const Td=this.wHb.B4f(Bc);if(!lb.a.Xa(Td))return L.a.J(593782154,833,50,"DirectAuth: Found valid cached token and use it!"),new Promise(Re=>{const Uf=new kq.a;Uf.IsSuccess=!0;Uf.ErrorCode="";Uf.ErrorMessage="";Uf.Token=
Td;Re(Uf)})}const Yc=ua.a.create().toString(),gd=String.format("{0}&state={1}",Bc,Yc);return new Promise((Td,Re)=>{const Uf=new lq;Uf.authority=u;Uf.appId=P;Uf.resource=la;Uf.j$e=Ba;Uf.resolve=Td;Uf.reject=Re;Uf.id=Yc;Uf.vWe=Bc;Uf.rga=window.open("",Yc,"width=400, height=600");Uf.rga?(this.Iic[Yc]=Uf,Uf.rga.location.replace(gd),L.a.J(593782152,833,50,"DirectAuth: New popup request created with ID of: {0}, IsUserUPNAlias: {1}",Yc,pb),this.IEh(Uf,1E3*Sa).then(()=>{const Ef={};Ef.DirectAuthRequestID=
Yc;Ef.FromPolling=!0;this.kzb(Ef)}).catch(Ef=>{"WindowClosed"===Object(S.a)(String,Ef)&&(Ef={},Ef.DirectAuthRequestID=Yc,Ef.PopupWindowClosed=!0,L.a.J(593782150,833,10,"DirectAuth: Popup window closed for request with ID of: "+Yc),this.kzb(Ef))}),Uf.Qmb=window.setTimeout(()=>{const Ef={};Ef.DirectAuthRequestID=Yc;Ef.Timeouted=!0;L.a.J(593782148,833,10,"DirectAuth: Popup request timedout with ID of: "+Yc);this.kzb(Ef)},1E3*Sa)):(L.a.J(593364752,833,50,"DirectAuth: Popup window was blocked and cannot continue request of {0}",
Yc),Re=new kq.a,Re.IsSuccess=!1,Re.ErrorCode="fail_to_open_popup",Re.ErrorMessage="Failed to create popup window!",Re.Token="",Td(Re))})}Txl(u,P,la,Ba,Sa,pb){if(lb.a.Xa(u))throw Error.argumentNull("authority");if(lb.a.Xa(P))throw Error.argumentNull("appId");if(lb.a.Xa(la))throw Error.argumentNull("resource");if(lb.a.Xa(Ba))throw Error.argumentNull("userUPN");const Vb=!lb.a.Xa(Ba)&&Ba.indexOf("@")<Ba.indexOf(".");var Bc=this.MMf();const Yc=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&redirect_uri={3}&prompt=none",
u,P,encodeURIComponent(la),encodeURIComponent(Bc));if(this.wHb){const Re=this.wHb.B4f(Yc);if(!lb.a.Xa(Re))return L.a.J(594134859,833,50,"DirectAuth: Found valid cached token and use it!"),new Promise(Uf=>{const Ef=new kq.a;Ef.IsSuccess=!0;Ef.ErrorCode="";Ef.ErrorMessage="";Ef.Token=Re;Uf(Ef)})}const gd=ua.a.create().toString();Bc=Vb?String.format("{0}&login_hint={1}&state={2}",Yc,encodeURIComponent(Ba),gd):String.format("{0}&state={1}",Yc,gd);const Td=document.createElement("iframe");Td.style.display=
"none";Td.src=Bc;return new Promise((Re,Uf)=>{const Ef=new lq;Ef.authority=u;Ef.appId=P;Ef.resource=la;Ef.j$e=Ba;Ef.frame=Td;Ef.resolve=Re;Ef.reject=Uf;Ef.id=gd;Ef.vWe=Yc;Ef.aLh=pb;document.body.appendChild(Td);L.a.J(594405504,833,50,"DirectAuth: New silent request created with ID of: {0}, IsUserUPNAlias: {1}",gd,Vb);this.IEh(Ef,1E3*Sa).then(()=>{const Oh={};Oh.DirectAuthRequestID=gd;Oh.FromPolling=!0;this.kzb(Oh)});Ef.Qmb=window.setTimeout(()=>{const Oh={};Oh.DirectAuthRequestID=gd;Oh.Timeouted=
!0;L.a.J(594405464,833,10,"DirectAuth: Silent request timedout with ID of: "+gd);this.kzb(Oh)},1E3*Sa);this.Iic[gd]=Ef})}IEh(u,P){return new Promise((la,Ba)=>{const Sa=P/50;let pb=0;u.soc=window.setInterval(()=>{try{pb++>Sa&&(window.clearInterval(u.soc),L.a.J(594068418,833,15,"DirectAuth: WindowHashPoller: Exceeded {0} ms timeout after {1} polls",P,Sa),Ba(""));const Vb=u.frame?u.frame.contentWindow:u.rga;if(!Vb||Vb.closed)window.clearInterval(u.soc),L.a.J(594068416,833,15,"DirectAuth: WindowHashPoller: Window or Frame is closed before completion"),
Ba("WindowClosed");let Bc=null,Yc=null;try{Bc=Vb.location.href,Yc=Vb.location.hash}catch(gd){}Bc&&"about:blank"!==Bc?lb.a.Xa(Yc)||(window.clearInterval(u.soc),la(Yc)):L.a.J(594068386,833,50,"DirectAuth: WindowHashPoller: Don't process blank pages or cross domain: {0}","about:blank"===Bc)}catch(Vb){L.a.J(594068384,833,15,"DirectAuth: WindowHashPoller: threw exception {0}",Vb.message)}},50)})}}Object(r.a)(Tq,"DirectAuthHelper",null,[]);class Rp{constructor(){this.welcomeScreenErrorImageUrl=this.welcomeScreenBackgroundImageUrl=
this.hostElement=null;this.urlBarHeightInPercentage=this.baseZIndex=0;this.reactionsBarLayerHostId=this.dialogLayerHostId=this.urlBarLayerHostId=this.calloutContainerId=this.welcomeScreenLayerHostId=null;this.isPowerpointLiveReactionEnabled=this.showTryAgainButton=!1;this.resourceCDNPath=this.onboardingScreenHostId=null;this.enableNewLiveWelcomeScreen=this.enablePrefetchLiveResource=!1;this.podsUrl=this.userSessionId=null}}Object(r.a)(Rp,"ILiveActorSettings",null,[]);class fo{constructor(){this.react=
null;this.reactionCount=0;this.reactionImagePath=null;this.numberOfAnimationFrames=0}}Object(r.a)(fo,"ILiveReaction",null,[]);class Dr{constructor(){this.isPaused=this.isPrivate=!1;this.participantsCount=0;this.sessionURLPromise=null;this.sessionCurrentState=0}}Object(r.a)(Dr,"ILiveSessionState",null,[]);class yg{constructor(){this.sessionQRCode=this.participantUrl=null}}Object(r.a)(yg,"ILiveSessionURL",null,[]);class Er{constructor(){this.lQg=this.kQg=null}}Object(r.a)(Er,"PollObjectInfo",null,[]);
var Mj;(function(u){u[u.none=0]="none";u[u.singleLineRibbon=1]="singleLineRibbon";u[u.multipleLineRibbon=2]="multipleLineRibbon";u[u.slideShowToolbar=3]="slideShowToolbar";u[u.slideShowKeyboardShortcut=4]="slideShowKeyboardShortcut";u[u.welcomeScreenTryAgain=5]="welcomeScreenTryAgain"})(Mj||(Mj={}));Object(r.b)("LiveEntryPoint",Mj);var Uq;(function(u){u[u.none=0]="none";u[u.callout=1]="callout";u[u.businessBar=2]="businessBar";u[u.pausedSessionTimeout=3]="pausedSessionTimeout";u[u.slideshowContextMenu=
4]="slideshowContextMenu";u[u.accessControlChange=5]="accessControlChange";u[u.welcomeScreenTryAgain=6]="welcomeScreenTryAgain"})(Uq||(Uq={}));Object(r.b)("LiveExitPoint",Uq);var Jl=d(684);class vs{constructor(u,P,la,Ba,Sa,pb,Vb,Bc,Yc,gd,Td,Re,Uf,Ef){this.xa=new Si.a;this.uHa=this.WDb=this.a8c=this.oye=this.nDg=!1;this.Nfc=this.aye=this.d8c=!0;this.djc=this.fHb=!1;this.Tp=this.xj=this.Pea=this.mo=null;this.VWa=0;this.qFb=-1;this.xGb=30;this.Lhc=-1;this.Hd=this.rna=this.q0=null;this.KYg=this.a2g=this.wdd=
this.tdd=0;this.fec=this.tva=this.QWa=null;this.kCe=this.Xdb=0;this.$lb=null;this.OGe=new Set;this.NGe=new Map;this.V$c=null;this.dic=1;this.Khc=this.n7c=this.UO=this.Pna=this.zHe=this.Rve=null;this.ke=Ba;this.la=u;this.wDg=!1;this.jb=la;this.oc=pb;this.oq=Vb;this.Mc=Bc;this.Bz=Yc;this.Ya=gd;this.Hc=Td;this.Xl=Re;this.FYa=Uf;this.Fa=Ef;if(this.Ur=P)this.Pea=P.SF();this.xM=Sa;this.VWa=this.LZf?1:0;this.la.powerPointLiveBroadcastEnabled&&(this.Rve=new Tq(this.la));this.Mc.HC(Object(z.a)(this,this.yaa,
"onPodSessionRehydrated"));this.Bz.rTd(Object(z.a)(this,this.cJb,"onPodSessionUnavailable"));this.dTa()&&this.Xl.execute(Oh=>{Oh.show(ResourceStrings.L_LivePresentations_Disconnected,Jl.a.CIb);Oh.hide()});L.a.J(512496260,833,50,"LivePresenter: Host auth type is: "+this.la.hostAuthType)}get Er(){return this.la.powerPointLiveBroadcastEnabled&&this.d8c}get b$a(){return this.oye}set b$a(u){(this.oye=u)&&this.xa.raiseEvent("OnLiveResourcesLoaded",Sys.EventArgs.Empty)}get kr(){return!!this.Tp}get Gda(){return this.wDg}set Gda(u){this.wDg=
u}get lEa(){return this.nDg}set lEa(u){this.nDg=u}get gTa(){return!!this.Tp&&this.Tp.isPaused}get f2i(){return this.a8c}get mEa(){return this.Nfc}set mEa(u){this.Nfc=u}get Q1i(){return this.b$a&&this.Er&&!!this.mo}get accessControl(){return this.VWa}set accessControl(u){this.VWa=u}get LZf(){return"true"===this.S$f("wdDisablePrivateSession")?!1:"aad"===this.la.hostAuthType}get GZf(){return this.Er&&this.kr&&this.xj?this.xj.isWelcomeScreenVisible():!1}Wwb(){return this.la.isMicButtonInSlideShowToolbarEnabled&&
this.la.emd&&this.Hc.L5b?this.Hc.Ywb?this.djc=!0:this.Hc.XZf||this.djc:!0}Tjd(u,P,la,Ba,Sa,pb,Vb,Bc,Yc){if(this.Er){this.jb.jTd(Object(z.a)(this,this.sbh,"onSlideShowEnterEndOfShow"));this.jb.lTd(Object(z.a)(this,this.tbh,"onSlideShowLeaveEndOfShow"));this.jb.dJc(Object(z.a)(this,this.Ixa,"onGetCurrentSlideDimensionsHandler"));this.WDb=!1;this.uHa=!0;try{this.la.Xld&&this.i$i();const gd=this.Xae(Sa,Ba);if(this.mo)(this.lEa||this.gTa)&&this.mo.FetchDocumentDownloadURL(gd);else{L.a.J(512496259,833,
50,"Creating Broadcast monitor ...");const Td=new PowerPointLive.PPTBroadcastMonitorSettings;Td.isBlueChicken=this.la.isBlueChicken;Td.fileDownloadUrl=gd;Td.rendezvousSvcBaseUri=this.la.podLiveBroadcastRendezvousServiceBaseUri;Td.broadcastSubtitlesFromSpeechFrontDoor=!0;Td.pragueInitTimeoutInMS=this.la.OQk;Td.preferredSubtitleLanguage=this.Hc.LXc();Td.useStateService=this.la.XQk;Td.numMaxAttempts=this.la.RQk;Td.delayInSecsToCloseBroadcasterOnPause=this.la.IQk;Td.batchedRequestsEnabled=this.la.FQk;
Td.sharedSessionSettings={};Td.websocketAliveTimeAfterLoseFocusInMs=this.la.YQk;Td.pingTimeoutInMs=this.la.PQk;Td.pongTimeoutInMs=this.la.QQk;Td.enableTransientSessionHandling=this.la.sRk;Td.maxStateServiceRoundtripRaw=v.AFrameworkApplication.fa.wc("PPTLiveMaxStateServiceRoundtripRaw",300);Td.sharedSessionSettings.MaxStateServiceRoundtripRaw=Td.maxStateServiceRoundtripRaw;Td.documentSnapshotRequestUrlGenerator=this.la.pRk?()=>this.Xae(this.Ya.podSessionId,this.Ya.Ek):null;this.la.Ggh&&(Td.sharedSessionSettings.IsAutomation=
!0);this.mo=new PowerPointLive.PPTBroadcastMonitor(Td);this.mo.RegisterParticipantsCountChangeEventListener(Re=>{this.Hd.telemetryData.maxParticipantCount=Math.max(this.Hd.telemetryData.maxParticipantCount,Re);this.xj&&this.xj.setParticipantCount(Re);this.xa.raiseEvent("ParticipantsCountChanged",Sys.EventArgs.Empty)});this.mo.RegisterNewReactionEventListener(Object(z.a)(this,this.Sxk,"newReactionHandler"));this.mo.RegisterConnectionStateEventListener(Object(z.a)(this,this.xGi,"connectionStateHandler"))}this.mo.SetCurrentPosition(u,
P-1,null);this.Xdb=u;this.lEa&&!this.Tp&&Yc?(this.Duc(v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.ob.Qp?1:2,Vb,la,Sa,Bc),this.UCi(u),this.tva=new Set):this.q0&&this.Fzb();this.tva&&this.tva.add(u)}catch(gd){L.a.J(512496258,833,10,"LivePresenter: Exception at creating Broadcast monitor: {0}",gd.toString())}}}IIl(){window.setTimeout(()=>{const u=this.Xdb===this.kCe;this.Er&&this.kr&&u&&this.Tp&&!this.Tp.isPaused&&(L.a.J(512496257,833,50,"LivePresenter::TriggerSurveyOnLastSlide Triggering live survey on last slide"),
this.Bxd(0),this.yQb(0))},6E4*this.la.TQk)}VHk(){this.Er&&(this.jb.xVe(Object(z.a)(this,this.sbh,"onSlideShowEnterEndOfShow")),this.jb.zVe(Object(z.a)(this,this.tbh,"onSlideShowLeaveEndOfShow")),this.jb.bpd(Object(z.a)(this,this.Ixa,"onGetCurrentSlideDimensionsHandler")),this.uHa=this.WDb=!1,this.kr&&this.xj&&(this.xj.hideAll(),this.Jpe()||(this.RNk(),this.twl()),this.dTa()&&this.Xl.instance.hide()))}MAl(u,P,la,Ba,Sa,pb){try{const Vb=new PowerPointLive.RendezvousSessionConfig;Vb.userSessionId=u;Vb.webServiceBase=
P;Vb.podSessionId=la;Vb.docId=Ba;Vb.sessionId=Sa;Vb.accessControl=1===this.VWa?"organization":"anyone";Vb.authTokenFunc=pb;Vb.locale=v.AFrameworkApplication.uiCulture;Vb.presentationName=lb.a.iH(v.AFrameworkApplication.fileName);Vb.slideHeight=this.oc.Ou().height;Vb.slideWidth=this.oc.Ou().width;Vb.correlationId=this.Hd.telemetryData.correlationId;Vb.showQRCodeAfterFetchingDocDownloadUrl=this.la.zRk;Vb.presenterTenantId=!this.la.isBlueChicken&&this.la.Sgh?v.AFrameworkApplication.fa.Ha("TenantId"):
null;Vb.fileSource=v.AFrameworkApplication.fa.Ha("FileHost");this.la.VQk||(Vb.fileName=v.AFrameworkApplication.fileName,Vb.bootstrapperUrl=this.la.pptEditorSlideShowWrsEndpoint);const Bc=this.mo.StartLiveBroadcasting(Vb,this.Hd,!this.la.WPe);this.oOj();if(Bc){this.Tp=new Dr;this.Tp.isPrivate=1===this.VWa;this.Tp.isPaused=!1;this.Tp.participantsCount=0;this.Tp.sessionCurrentState=0;const Yc=Bc.then(gd=>{const Td=new yg;Td.participantUrl=gd.sessionInfo.shortParticipantUrl;Td.sessionQRCode=gd.sessionInfo.sessionQRCode;
this.Tp.sessionCurrentState=1;return Td});this.Tp.sessionURLPromise=Yc;this.la.fmd?this.Khc.then(()=>{this.xj.actOnSessionRequested(this.Tp)}):this.xj.actOnSessionRequested(this.Tp);this.jb.hJc(Object(z.a)(this,this.ubh,"onSlideShowReady"));this.jb.yzf(Object(z.a)(this,this.onTranscriberStarted,"onTranscriberStarted"));this.jb.mTd(Object(z.a)(this,this.onPodSessionExpired,"onPodSessionExpired"));Bc.then(gd=>{this.Hd.telemetryData.pragueDocId=gd.sessionInfo.pragueDocId;this.Hd.telemetryData.sessionCreationWebServiceCallTimeInMS=
this.BL()-this.wdd;this.Hd.telemetryData.startAttemptCount=gd.numAttempt;L.a.J(512496256,833,50,"SessionId: {0}, Message: StartLiveBroadcasting succeeded!, TimeElapsed: {1}",this.Hd.telemetryData.sessionId,this.Hd.telemetryData.sessionCreationWebServiceCallTimeInMS.toString());this.la.WPe?(this.Ksc(),this.mo.InitializeStateService().then(()=>{this.gzh(gd);this.k0("StartLiveBroadcasting")}).catch(Td=>{this.Hd.telemetryData.sessionEndedBeforePragueInitialized||this.Hd.telemetryData.sessionId!==Sa||
(L.a.J(512496227,833,10,"SessionId: {0}, Message: failed to connect state service due to error!, Details: {1}",this.Hd.telemetryData.sessionId,Td?Td.toString():""),this.Hd.telemetryData.SetErrorCode(2,Td?Td.toString():""),this.k0("StartLiveBroadcasting"),this.vud())})):this.gzh(gd);this.la.rRk&&$addHandler(window,"visibilitychange",Object(z.a)(this,this.JFk,"onPageVisibilityChangedHandler"));this.k0("StartLiveBroadcasting")}).catch(gd=>{L.a.J(512496226,833,10,"SessionId: {0}, Message: StartLiveBroadcasting failed due to error!, Details: {1}",
this.Hd.telemetryData.sessionId,gd.toString());this.Hd.telemetryData.SetErrorCode(4,gd.toString());this.k0("StartLiveBroadcasting");this.vud()})}else this.vud(),this.Hd.telemetryData.SetErrorCode(4,"Failed to create Promise object!"),L.a.J(512496225,833,10,"StartLiveBroadcasting failed to create Promise object!")}catch(Vb){this.vud(),this.Hd.telemetryData.SetErrorCode(4,Vb.toString()),L.a.J(512496224,833,10,"SessionId: {0}, Message: Exception when staring a new Live session, Details: {1}",this.Hd.telemetryData.sessionId,
Vb.toString())}finally{this.k0("StartLiveBroadcasting")}}gzh(u){const P=this.Hc.ycj(this.Hc.Fpa);P?this.mo.SetDefaultSubtitlesLanguage(P):L.a.J(512496223,833,10,"SessionId: {0}, Message: Failed to set default subtitle language.",this.Hd.telemetryData.sessionId);this.jb.lQb(!0,this.mo.GetPragueSessionInfoJSONString());this.jb.KQa(Object(z.a)(this,this.hnc,"onSlideShowPositionChanged"));this.jb.xzf(Object(z.a)(this,this.onSubtitleUpdated,"onSubtitleUpdated"));this.la.WPe&&!this.xj.isWelcomeScreenVisible()||
this.Ksc();this.xa.raiseEvent("OnLiveSessionStarted",u.sessionInfo);this.Wwb()||!this.Hc.L5b||this.Hc.XZf||this.djc||!this.dTa()||(this.fHb=!0,this.Xl.instance.show(ResourceStrings.l_LivePresentation_UnsupportedSpeechToast.replace("{0}",hk.a.He(v.AFrameworkApplication.uiCulture).displayName),Jl.a.CIb));this.fec=this.mo.CreateSurvey(u.authToken,null,null,null);this.fec.then(la=>{if(la){const Ba={};Ba.surveyeeName=v.AFrameworkApplication.userName;Ba.surveyId=la.surveyId;Ba.surveyResponseUrl=la.surveyResponseUrl;
this.mo.SetAudienceFeedbackInfo(JSON.stringify(Ba))}});this.la.Xld&&(this.NGe.clear(),this.OGe.forEach(la=>{try{const Ba=la.kQg;this.mo.CreateSurvey(u.authToken,null,Ba,la.lQg).then(Sa=>{Sa?this.NGe.set(Ba,Sa.surveyId):L.a.J(512496222,833,10,"SessionId: {0}, Message: Duplicated poll info is not valid!",this.Hd.telemetryData.sessionId)}).catch(Sa=>{L.a.J(512496221,833,10,"SessionId: {0}, Message: Failed to duplicate poll as DuplicateSurvey request failed due to error!, Details: {1}",this.Hd.telemetryData.sessionId,
Sa.toString());this.Hd.telemetryData.SetErrorCode(13,u.toString())})}catch(Ba){L.a.J(512496220,833,10,"SessionId: {0}, Message: Exception when duplicating, Details: {1}",this.Hd.telemetryData.sessionId,Ba.toString())}}));this.FYa.init()?this.FYa.bTd(Object(z.a)(this,this.Nmc,"onNetworkConnectivityChanged")):L.a.J(512496219,833,10,"SessionId: {0}, Message: NetworkConnectivityProvider init failed.",this.Hd.telemetryData.sessionId)}S$f(u){u=new RegExp(String.format("[\\?&]{0}=([^&#]*)",u));return(u=
window.location.search.match(u))&&2===u.length?u[1]:""}Duc(u,P,la,Ba,Sa){this.zHe=P;this.Pna=la;this.UO=Ba;this.n7c=Sa;this.wdd=this.BL();this.tdd=this.BL();var pb=this.S$f("wdSetLiveSessionId");pb="rdvSession_"+(pb.length?pb:ua.a.create().toString());this.Hd=new PowerPointLive.LiveSessionTelemetry;this.Hd.telemetryData.sessionId=pb;this.Hd.telemetryData.sessionStartUtc=(new Date).format("yyyy-MM-ddTHH:mm:ss.fffffff");this.Hd.telemetryData.accessControl=tp[this.VWa];this.Hd.telemetryData.sessionEntryPoint=
Mj[u];this.Hd.telemetryData.isSubtitleStartedByLive=this.Gda;this.Hd.telemetryData.isAutomation=this.la.Ggh;this.Hd.telemetryData.correlationId=ua.a.create().toString();this.k0("StartLiveBroadcasting");try{this.Er&&this.mo&&this.w5b()&&!this.Tp?(this.a$j(),this.jb.C_b(Object(z.a)(this,this.H9g,"onGetCurrentSlideShowPosition")),this.jb.getCurrentPosition(),this.y6d()&&this.xj&&this.Khc&&this.Khc.then(()=>{this.xj.showOnboardingScreen();this.J$e=!0}),this.MAl(P,la,Ba,Sa,pb,()=>this.$6b("StartLiveBroadcasting",
this.Hd.telemetryData.sessionId))):(this.Hd.telemetryData.SetErrorCode(4,"Live actor or broadcast monitor is null while trying to start live session!"),L.a.J(512496218,833,10,"StartLiveBroadcasting: Live actor or broadcast monitor is null while trying to start live session!")),this.Hd.telemetryData.isMordernSlideShow=!!this.jb&&this.jb instanceof Ro.SlideShowCoreFrame}catch(Vb){this.Hd.telemetryData.SetErrorCode(4,Vb.toString()),L.a.J(512496217,833,10,"SessionId: {0}, Message: Exception when starting Live session, Details: {1}",
this.Hd.telemetryData.sessionId,Vb.toString())}finally{this.k0("StartLiveBroadcasting")}}RNk(){if(this.Er&&this.kr&&this.mo&&this.w5b()&&!this.Tp.isPaused){this.Bxd(2);this.yQb(2);try{this.Hd.telemetryData.sessionPauseCount+=1,this.Hd.telemetryData.sessionActiveDurationInMS+=this.BL()-this.tdd,L.a.J(512496216,833,50,"SessionId: {0}, Message: Pause live broadcasting ...",this.Hd.telemetryData.sessionId),this.xj.actOnSessionPaused(),this.Tp.isPaused=!0,this.KYg=this.BL(),this.mo.PauseLiveBroadcasting(()=>
this.$6b("PauseLiveBroadcasting",this.Hd.telemetryData.sessionId)),this.xa.raiseEvent("OnLiveSessionPaused",Sys.EventArgs.Empty),this.TAl(),this.jb.lQb(!1)}catch(u){this.Hd.telemetryData.SetErrorCode(5,u.toString()),L.a.J(512496215,833,10,"SessionId: {0}, Message: Exception when pausing Live session, Details: {1}",this.Hd.telemetryData.sessionId,u.toString())}finally{this.k0("PauseLiveBroadcasting")}}}Rrh(){if(this.Er&&this.kr&&this.mo&&this.w5b()&&this.Tp.isPaused)try{this.tdd=this.BL(),this.Hd.telemetryData.sessionResumeCount+=
1,L.a.J(512496214,833,50,"SessionId: {0}, Message: Resume live broadcasting ...",this.Hd.telemetryData.sessionId),this.rrh(),this.xj.actOnSessionResumed(),this.mo.ResumeLiveBroadcasting(()=>this.$6b("ResumeLiveBroadcasting",this.Hd.telemetryData.sessionId)),this.Tp.isPaused=!1,this.xa.raiseEvent("OnLiveSessionResumed",Sys.EventArgs.Empty),this.P3e(),this.jb.lQb(!0,this.mo.GetPragueSessionInfoJSONString())}catch(u){this.Hd.telemetryData.SetErrorCode(6,u.toString()),L.a.J(512496213,833,10,"SessionId: {0}, Message: Exception when resuming Live session, Details: {1}",
this.Hd.telemetryData.sessionId,u.toString())}finally{this.k0("ResumeLiveBroadcasting")}}p5b(u){if(this.Er&&this.kr&&this.mo&&this.w5b()){this.yQb(3);try{this.qIl(u,()=>{this.Hd.telemetryData.sessionExitPoint=Uq[u];this.Tp.isPaused||(this.Hd.telemetryData.sessionActiveDurationInMS+=this.BL()-this.tdd);this.q0&&this.Fzb();this.P3e();this.dTa()&&this.Xl.instance.hide();L.a.J(512496212,833,50,"SessionId: {0}, Message: End live broadcasting ...",this.Hd.telemetryData.sessionId);this.xj.actOnSessionEnded();
this.jb.dpd(Object(z.a)(this,this.ubh,"onSlideShowReady"));this.jb.dkb(Object(z.a)(this,this.hnc,"onSlideShowPositionChanged"));this.jb.Uoh(Object(z.a)(this,this.onSubtitleUpdated,"onSubtitleUpdated"));this.jb.Woh(Object(z.a)(this,this.onTranscriberStarted,"onTranscriberStarted"));this.FYa.woh(Object(z.a)(this,this.Nmc,"onNetworkConnectivityChanged"));this.jb.AVe(Object(z.a)(this,this.onPodSessionExpired,"onPodSessionExpired"));this.uHa&&this.jb.lQb(!1);this.fec=this.Tp=null;this.xa.raiseEvent("OnLiveSessionEnded",
Sys.EventArgs.Empty);this.la.emd&&this.Hc.L5b&&(this.djc=this.fHb=!1);if(3!==u){const P=this.mo.EndLiveBroadcasting(()=>this.$6b("EndLiveBroadcasting",this.Hd.telemetryData.sessionId));P?P.then(()=>{this.k0("EndLiveBroadcasting");L.a.J(512496211,833,50,"SessionId: {0}, Message: EndLiveBroadcasting web service call succeeded!",this.Hd.telemetryData.sessionId)}).catch(la=>{this.Hd.telemetryData.SetErrorCode(7,la.toString());this.k0("EndLiveBroadcasting");L.a.J(512496210,833,10,"SessionId: {0}, Message: EndLiveBroadcasting web service call failed due to error!, Details: {1}",
this.Hd.telemetryData.sessionId,la.toString())}):(this.Hd.telemetryData.SetErrorCode(7,"EndLiveBroadcasting failed to created Promise object!"),L.a.J(512496209,833,10,"SessionId: {0}, Message: EndLiveBroadcasting failed to created Promise object!"))}else this.mo.CleanUpBroadcastBeforeEnd(),L.a.J(512496208,833,50,"SessionId: {0}, Message: Skipping EndLiveBroadcasting web service call");this.k0("EndLiveBroadcasting")})}catch(P){this.Hd.telemetryData.SetErrorCode(7),L.a.J(512496207,833,10,"SessionId: {0}, Message: Exception when ending live session!, Details: {1}",
this.Hd.telemetryData.sessionId,P.toString())}finally{3!==u&&this.dnb(),this.k0("EndLiveBroadcasting")}}}gxh(){this.Er&&this.mo&&this.mo.SetPresenterState("muted")}hxh(){this.Er&&this.mo&&this.mo.SetPresenterState("unmuted")}showCallout(u){this.Er&&this.xj&&(this.a8c=!0,this.xj.showCallout(u))}showWelcomeScreen(){this.Er&&this.xj&&(this.xj.showWelcomeScreen(),this.h_e())}showEndSessionDialog(u,P){this.Er&&this.kr&&this.xj&&this.xj.showEndSessionDialogWithCallbacks(u,P)}vud(){this.xj.isWelcomeScreenVisible()||
this.Tp.isPaused||this.showWelcomeScreen();this.Tp=null;this.xj.onSessionRequestError()}w5b(){if(this.Er&&!this.xj&&this.Pea){const u=new Rp;u.hostElement=this.Pea;u.baseZIndex=50005;u.welcomeScreenBackgroundImageUrl=this.ke.qk("LiveWelcomeScreenBackground.png");u.welcomeScreenErrorImageUrl=this.ke.qk("LiveWelcomeScreenError.png");u.welcomeScreenLayerHostId="LiveWelcomeScreenLayerHost";u.calloutContainerId="LiveCalloutContainer";u.urlBarLayerHostId="LiveURLBarLayerHost";u.dialogLayerHostId="LiveDialogLayerHost";
u.reactionsBarLayerHostId="LiveReactionBarLayerHost";u.showTryAgainButton=!0;u.isPowerpointLiveReactionEnabled=!Ud.a("PPTLive.ReactionToggleInLiveCallout");u.onboardingScreenHostId="LiveOnboardingScreenLayerHost";u.resourceCDNPath=this.la.djb;u.enablePrefetchLiveResource=this.la.fmd;u.enableNewLiveWelcomeScreen=this.la.fmd;u.userSessionId=this.zHe;u.podsUrl=this.Pna;this.xj=liveActor.LiveActorFactory.CREATE_LIVE_ACTOR(u);this.xj.on("OnWelcomeScreenOpenedAction",()=>{this.GLa("LiveWelcomeScreenLayerHost");
this.h_e();this.a2g=Date.now();this.Hd.telemetryData.welcomeShownCount+=1});this.xj.on("OnWelcomeScreenClosedAction",()=>{this.WDb&&this.xj.hideURLBar();this.uKf();this.jb.restoreFocus();this.Hd.telemetryData.welcomeScreenDurations.push(Date.now()-this.a2g);this.Hd.telemetryData.welcomeScreenFirstTimeDuration=this.Hd.telemetryData.welcomeScreenDurations[0];this.k0("OnWelcomeScreenClosedAction");this.mo.SetWelcomeScreenState(!1);this.la.Xld&&this.RJh();this.fHb&&this.dTa()&&window.setTimeout(()=>{this.Xl.instance.hide();
this.fHb=!1},5E3)});this.xj.on("ResumeSessionAction",()=>{this.Rrh();this.WDb||this.xj.showURLBar()});this.xj.on("EndSessionAction",()=>{this.p5b(this.uHa?1:2);this.jb.restoreFocus()});this.xj.on("OnCalloutOpenedAction",()=>{this.a8c=!0;this.xa.raiseEvent("OnCalloutOpened",Sys.EventArgs.Empty);this.Hd.telemetryData.calloutShownCount+=1});this.xj.on("OnCalloutClosedAction",()=>{this.a8c=!1;this.xa.raiseEvent("OnCalloutDismissed",Sys.EventArgs.Empty);this.jb.restoreFocus()});this.xj.on("OnEndSessionDialogOpenedAction",
()=>{this.Rkl()});this.xj.on("OnEndSessionDialogClosedAction",()=>{this.icl()});this.xj.on("OnCalloutMenuDefinitionChangedAction",()=>{this.xa.raiseEvent("CalloutMenuDefinitionChanged",Sys.EventArgs.Empty)});this.xj.on("OnTryAgainAction",()=>{L.a.J(512496206,833,15,"SessionId: {0}, Message: OnTryAgainAction called.",this.Hd.telemetryData.sessionId);this.Duc(5,this.zHe,this.Pna,this.UO,this.n7c)});this.xj.on("PresenterDisabledReactions",()=>{this.aye=!1});this.xj.on("PresenterEnabledReactions",()=>
{this.aye=!0});this.xj.on("OnOnboardingScreenOpenedAction",()=>{this.GLa("LiveOnboardingScreenLayerHost");this.h_e()});this.xj.on("OnOnboardingScreenClosedAction",()=>{this.Ksc()})}return!!this.xj}Ksc(){this.xj&&(this.y6d()&&this.xj.isOnboardingScreenVisible()?this.GLa("LiveOnboardingScreenLayerHost"):this.xj.isWelcomeScreenVisible()?this.GLa("LiveWelcomeScreenLayerHost"):(-1!==this.Lhc&&this.uKf(),this.jb.restoreFocus()))}XWj(){const u=document.getElementById("LiveWelcomeScreenLayerHost"),P=document.getElementById("LiveOnboardingScreenLayerHost");
let la=!1;u&&(la=u.contains(document.activeElement));return document.activeElement===P||document.activeElement===u||la}h_e(){this.xj&&-1===this.Lhc&&(this.Lhc=window.setInterval(()=>{this.XWj()||this.Ksc()},500))}uKf(){window.clearInterval(this.Lhc);this.Lhc=-1}GLa(u){this.Pea&&this.xj&&window.setTimeout(()=>{ud.FocusManager.Zq(this.Pea.ownerDocument.getElementById(u))},50)}Rkl(){this.uHa?this.GLa("LiveDialogLayerHost"):(this.Fa.SZc(Ad.a.VPe,Ad.a.Xi,document.getElementById("LiveDialogLayerHost")),
this.Fa.tj(Ad.a.VPe,!0))}icl(){this.uHa?this.jb.restoreFocus():this.Fa.tj(Ad.a.VPe,!1)}jfg(){this.la.emd&&this.Hc.L5b&&(this.dTa()&&this.fHb&&(this.Xl.instance.hide(),this.fHb=!1),this.djc=!0)}a$j(){try{this.Khc||!this.y6d()&&!this.la.fmd||(this.Khc=lg.a(w.a.instance)("liveActorLazy"))}catch(u){L.a.J(512496205,833,10,"SessionId: {0}, Message: Exception when loading the liveActorLazy, Details: {1}",this.Hd.telemetryData.sessionId,u.toString())}}ubh(){this.Er&&this.mo&&(this.gTa?(window.setTimeout(()=>
{this.xa.raiseEvent("OnRelaunchPausedSession",Sys.EventArgs.Empty)},500),this.Rrh()):this.Tp&&this.xj&&this.xj.isWelcomeScreenVisible()&&this.Ksc())}hnc(u,P){this.Er&&this.mo&&(this.mo.SetCurrentPosition(P.slideId,P.slideIndex,P.$vc),this.Xdb!==P.slideId&&this.rrh(),this.Xdb=P.slideId,this.tva&&(this.QWa&&10>this.dic&&10*this.tva.size>=this.dic*this.QWa.size&&(this.yQb(4),this.dic+=1),this.tva.add(P.slideId)),this.la.Xld&&this.RJh(),u=!!this.QWa&&this.QWa.size>=this.la.SQk,this.Xdb===this.kCe&&u&&
this.IIl())}sbh(){this.WDb=!0;this.Er&&this.kr&&this.xj&&(this.xj.hideURLBar(),this.Bxd(1),this.yQb(1))}tbh(){this.WDb=!1;this.Er&&this.kr&&this.xj&&this.xj.showURLBar()}onSubtitleUpdated(u,P){this.Er&&this.kr&&this.mo&&(P.isFinal?this.mo.UpdateFinalSubtitles(P.vJh):this.mo.UpdatePartialSubtitles(P.vJh))}onTranscriberStarted(u,P){this.Hd.telemetryData.transcriberSessionIds+=P.uJh+",";this.Er&&this.kr&&this.jb.lQb(!0,this.mo.GetPragueSessionInfoJSONString())}TAl(){L.a.J(512496204,833,50,"SessionId: {0}, StartPausedSessionAutoExpireTimer.",
this.Hd.telemetryData.sessionId);-1!==this.qFb&&window.clearInterval(this.qFb);this.xGb=30;this.qFb=window.setInterval(Object(z.a)(this,this.VNk,"pausedSessionAutoExpireTimerCallBack"),6E4)}P3e(){-1!==this.qFb&&(L.a.J(512496203,833,50,"SessionId: {0}, StopPausedSessionAutoExpireTimer.",this.Hd.telemetryData.sessionId),window.clearInterval(this.qFb),this.qFb=-1)}VNk(){--this.xGb;0>=this.xGb?(L.a.J(512496202,833,50,"SessionId: {0}, Ending long paused session.",this.Hd.telemetryData.sessionId),this.Fzb(),
this.p5b(3)):this.q0&&(this.q0.message=String.format(ResourceStrings.l_LiveBusinessBarMessage_PausedSession,this.xGb.toString()))}twl(){if(!this.q0&&this.Ur&&!v.AFrameworkApplication.Yg&&0!==this.Tp.sessionCurrentState){var u=String.format(ResourceStrings.l_LiveBusinessBarMessage_PausedSession,this.xGb.toString());u=new sp.a(ResourceStrings.l_LiveBusinessBarTitle_PausedSession,u,null);u.closeable=!0;u.u3=Object(z.a)(this,this.gBk,"onBusinessBarClosed");u.image=3;u.addButton(ResourceStrings.l_LiveBusinessBarButton_ResumeSession,
Object(z.a)(this,this.iBk,"onBusinessBarResumeSessionButtonClicked"),"");u.CSd(ResourceStrings.l_LiveBusinessBarButton_EndSession,Object(z.a)(this,this.hBk,"onBusinessBarEndSessionButtonClicked"));this.Ur.businessBar.ji(u,!1);this.Ur.yu();this.q0=u}}Jpe(){var u=6E4*this.la.wRk;u=0<u?this.BL()-this.wdd>=u:!1;L.a.J(512496201,833,50,"LivePresenter::IsSessionStale {0}",u);return u}Fzb(){try{this.Ur&&this.q0?(this.P3e(),this.Ur.businessBar.removeEntry(this.q0),this.Ur.yu(),L.a.J(512496200,833,50,"LivePresenter::HideLiveSessionBusinessBar WasSuccessful: {0}",
!this.q0.businessBar),this.q0=null):L.a.J(512496199,833,15,"LivePresenter::HideLiveSessionBusinessBar failed: conditions: {0}, {1}",!!this.Ur,!!this.q0)}catch(u){L.a.J(512496198,833,15,"LivePresenter::HideLiveSessionBusinessBar threw an exception of {0}",u.toString())}}gBk(u){u===this.q0&&(this.q0=null)}iBk(u){u===this.q0&&this.xj&&(this.Fzb(),this.Jpe()||v.AFrameworkApplication.Ra.processAction(tb.a.Aza,2))}hBk(u){u===this.q0&&this.xj&&(this.Jpe()?this.Fzb():this.xj.showEndSessionDialog())}JFk(){const u=
this.BL(),P=window.document.hidden;L.a.J(512496197,833,50,"LivePresenter::OnPageVisibilityChangedHandler page {0} at {1}",P?"hidden":"visible",u);P||this.gTa&&18E5<=u-this.KYg&&this.Fzb()}r9d(u,P,la){return!this.la.powerPointLiveBroadcastEnabled||0===this.VWa&&this.la.isBlueChicken?new Promise(Ba=>{Ba(null)}):!la&&!this.xM||la&&!this.Rve?(L.a.J(512496196,833,10,"LivePresenter::GetToken - action: {0}, session id: {1}, isDirectAuth: {2}, Auth manager or helper is null",u,P,la),new Promise((Ba,Sa)=>
{Sa("AuthHelperNotSet")})):new Promise((Ba,Sa)=>{let pb=this.la.hostAuthType,Vb="";if("aad"===pb||this.la.isBlueChicken)Vb=this.la.pptLiveResourceUri;else if("msa"===pb)Vb=this.la.vRk;else{L.a.J(512496195,833,10,"LivePresenter::GetToken - action: {0}, session id: {1}, hostAuthType is not aad or msa",u,P);Sa("HostAuthTypeInvalid");return}const Bc="true"===v.AFrameworkApplication.fa.Ha("IsAnonymousUser").toLowerCase();let Yc=v.AFrameworkApplication.fa.Ha(v.AFrameworkApplication.wK);lb.a.Xa(Yc)&&(Yc=
"Unset");const gd=new Date;let Td=null;Td=la?this.Rve.JJl(this.la.HQk,this.la.GQk,Vb,v.AFrameworkApplication.fa.Ha("UserPrincipalName"),this.la.UQk,this.la.KQk&&"StartLiveBroadcasting"===u&&!this.la.Sgh):this.xM.gI(this.la.pptLiveImplicitAuthAppName,Vb);Td.then(Re=>{this.ewg(P,u,pb,la,Bc,Yc,Re.IsSuccess,+new Date-+gd,Re.ErrorCode,Re.ErrorMessage);Re.IsSuccess?Ba(Re.Token):Sa(Re.ErrorCode)}).catch(Re=>{this.ewg(P,u,pb,la,Bc,Yc,!1,+new Date-+gd,"exception",Re.toString());Sa("exception")})})}$6b(u,P){if(!this.la.powerPointLiveBroadcastEnabled||
0===this.VWa&&this.la.isBlueChicken)return new Promise(Ba=>{Ba(null)});if("msa"===this.la.hostAuthType)return this.r9d(u,P,!1);const la=this;return new Promise((Ba,Sa)=>{la.r9d(u,P,!0).then(pb=>{Ba(pb)}).catch(()=>{la.r9d(u,P,!1).then(pb=>{L.a.J(512496194,833,50,"LivePresenter::GetToken - WebAuth retry succeeded.");Ba(pb)}).catch(pb=>{Sa(pb)})})})}BL(){return(new Date).getTime()}ewg(u,P,la,Ba,Sa,pb,Vb,Bc,Yc,gd){const Td={};Td.SessionId=u;Td.Action=P;Td.HostAuthType=la;Td.UseDirectAuth=Ba;Td.IsAnonymousUser=
Sa;Td.UiHost=pb;Td.IsSuccess=Vb;Td.Latency=Bc;Td.ErrorCode=Yc;Td.ErrorMessage=gd;L.a.J(51197915,833,50,JSON.stringify(Td))}k0(u){this.Hd.telemetryData.action=u;this.Hd.telemetryData.sessionDurationInMS=this.BL()-this.wdd;this.Hd.telemetryData.hostAuthType=this.la.hostAuthType;this.Hd.SetStateServiceMetrics();this.Hd.telemetryData.errorCode.length&&(!this.Hd.telemetryData.errorMessage.length||0>Array.indexOf(this.la.NQk,this.Hd.telemetryData.errorMessage))&&(this.Hd.telemetryData.hasUnexpectedError=
!0);u=this.la.podLiveBroadcastRendezvousServiceBaseUri.toLowerCase();-1!==u.indexOf("pptservicescast.officeapps.live.com")?this.Hd.telemetryData.rendezvousServiceEnvironment="prod":-1!==u.indexOf("pptservicescast.edog.officeapps.live.com")?this.Hd.telemetryData.rendezvousServiceEnvironment="edog":-1!==u.indexOf("pptservicescast.officeapps.live-int.com")?this.Hd.telemetryData.rendezvousServiceEnvironment="int":this.Hd.telemetryData.rendezvousServiceEnvironment="dev";L.a.J(50706442,833,this.Hd.telemetryData.hasUnexpectedError?
15:50,JSON.stringify(this.Hd.telemetryData))}UCi(u){if(this.oc)try{var P=this.oq.presentation;if(!P)throw Error.argumentNull("Presentation is null");const la=P.slides||[];this.kCe=la[la.length-1].sid;let Ba=P=!1;this.QWa=new Set;for(const Sa of la)P||Sa.sid!==u||(P=!0,Ba=Sa.yn),!P||Sa.yn&&!Ba||this.QWa.add(Sa.sid),Ba&&!Sa.yn&&(Ba=!1)}catch(la){this.Hd.telemetryData.SetErrorCode(16,la.toString()),L.a.J(512496193,833,10,"SessionId: {0}, Message: Exception when collecting slide show info for triggering audience feedback!, Details: {1}",
this.Hd.telemetryData.sessionId,la.toString())}}Bxd(u){return new Promise(P=>{if(this.Er&&this.mo&&this.Tp&&this.fec)try{this.fec.then(la=>{let Ba=!1;switch(u){case 2:if(!this.tva||!this.QWa||10*this.tva.size<8*this.QWa.size){P(!0);return}break;case 3:Ba=!0}const Sa={triggeredSurveyType:"Survey.AudienceFeedback"};Sa.isMandatory=Ba;Sa.triggerEventId=ua.a.create().toString();Sa.surveyeeName=v.AFrameworkApplication.userName;la?(Sa.surveyId=la.surveyId,Sa.surveyResponseUrl=la.surveyResponseUrl):L.a.J(512496192,
833,10,"SessionId: {0}, Message: Audience feedback survey info is not valid!",this.Hd.telemetryData.sessionId);this.mo.TriggerSurvey(JSON.stringify(Sa));L.a.J(512496163,833,50,"SessionId: {0}, Message: Triggering audience feedback!, Details: {1}",this.Hd.telemetryData.sessionId,u);P(!0)}).catch(la=>{L.a.J(512496162,833,10,"SessionId: {0}, Message: Failed to trigger audience feedback as CreateSurvey request failed due to error!, Details: {1}",this.Hd.telemetryData.sessionId,la.toString());this.Hd.telemetryData.SetErrorCode(13,
la.toString());P(!1)})}catch(la){this.Hd.telemetryData.SetErrorCode(17,la.toString()),L.a.J(512496161,833,10,"SessionId: {0}, Message: Exception when collecting show info for triggering audience feedback!, Details: {1}",this.Hd.telemetryData.sessionId,la.toString()),P(!1)}else P(!0)})}H9g(u,P){this.jb&&this.mo&&P&&(this.jb.ckb(Object(z.a)(this,this.H9g,"onGetCurrentSlideShowPosition")),this.mo.SetCurrentPosition(P.slideId,P.slideIndex,P.$vc))}Ixa(u,P){this.xj&&this.xj.actOnCurrentSlideDimensionChange(P.slideHeight,
P.sDh,P.slideWidth,P.wDh)}getCalloutMenuDefinition(){return this.w5b()?this.xj.getCalloutMenuDefinition():null}oOj(){const u=String.format("{0}{1}",this.la.djb,"reactions/heart/default/240_anim_f/heart.png"),P=String.format("{0}{1}",this.la.djb,"reactions/yes/default/240_anim_f/yes.png"),la=String.format("{0}{1}",this.la.djb,"reactions/clap/default/240_anim_f/clap.png"),Ba=String.format("{0}{1}",this.la.djb,"reactions/laugh/default/240_anim_f/laugh.png"),Sa=String.format("{0}{1}",this.la.djb,"reactions/surprised/default/240_anim_f/surprised.png"),
pb=String.format("{0}{1}",this.la.djb,"reactions/wonder/default/240_anim_f/wonder.png");this.rna=[Object.assign(new fo,{react:"yes",reactionCount:0,reactionImagePath:P,numberOfAnimationFrames:40}),Object.assign(new fo,{react:"heart",reactionCount:0,reactionImagePath:u,numberOfAnimationFrames:16}),Object.assign(new fo,{react:"clap",reactionCount:0,reactionImagePath:la,numberOfAnimationFrames:40}),Object.assign(new fo,{react:"laugh",reactionCount:0,reactionImagePath:Ba,numberOfAnimationFrames:77}),
Object.assign(new fo,{react:"surprised",reactionCount:0,reactionImagePath:Sa,numberOfAnimationFrames:68}),Object.assign(new fo,{react:"wonder",reactionCount:0,reactionImagePath:pb,numberOfAnimationFrames:70})];this.$lb=new Map;this.dic=1;this.V$c=null}rrh(){if(this.rna){for(const u of this.rna)u.reactionCount=0;this.xj&&this.xj.resetReactions()}}Sxk(u){if(this.$lb){var P=this.$lb.has(u.slideId)?this.$lb.get(u.slideId)+1:1;this.$lb.set(u.slideId,P)}if(this.rna&&!this.gTa&&this.aye){for(const la of this.rna)if(la.react===
u.react){la.reactionCount+=1;break}if(this.xj){u=Array(this.rna.length);for(P=0;P<this.rna.length;P++)u[P]=Object.assign(new fo,{react:this.rna[P].react,reactionCount:this.rna[P].reactionCount,reactionImagePath:this.rna[P].reactionImagePath,numberOfAnimationFrames:this.rna[P].numberOfAnimationFrames});this.xj.setReactions(u)}}}yQb(u){return new Promise(P=>{if(this.Er&&this.mo&&this.Tp)try{if(1>this.$lb.size)L.a.J(512496160,833,50,"SessionId: {0}, Message: No reactions, skip save thumbnails request, Reason: {1}",
this.Hd.telemetryData.sessionId,u),P(!0);else if(2===u&&(!this.tva||1>this.tva.size))L.a.J(512496159,833,50,"SessionId: {0}, Message: No slide presented, skip save thumbnails request, Reason: {1}",this.Hd.telemetryData.sessionId,u),P(!0);else{var la=null,Ba=0;this.$lb.forEach((pb,Vb)=>{pb>Ba&&(la=Vb.toString(),Ba=pb)});if(this.V$c&&la===this.V$c)L.a.J(512496158,833,50,"SessionId: {0}, Message: Already trigger for slideId, skip save thumbnails request, Reason: {1}",this.Hd.telemetryData.sessionId,
u),P(!0);else{var Sa=this.mo.TriggerSaveThumbnails(()=>this.$6b("SaveThumbnails",this.Hd.telemetryData.sessionId),la);Sa?Sa.then(()=>{this.V$c=la;L.a.J(512496156,833,50,"SessionId: {0}, Message: Triggering save thumbnails call succeeded, Reason: {1}",this.Hd.telemetryData.sessionId,u);P(!0)}).catch(pb=>{L.a.J(512496155,833,10,"SessionId: {0}, Message: Triggering save thumbnais call failed due to error!, Details: {1}, Reason: {2}",this.Hd.telemetryData.sessionId,pb.toString(),u);P(!1)}):(this.Hd.telemetryData.SetErrorCode(15,
"Triggering save thumbnails failed to created Promise object!"),L.a.J(512496157,833,10,"SessionId: {0}, Message: Triggering save thumbnails failed to created Promise object!"),P(!1))}}}catch(pb){this.Hd.telemetryData.SetErrorCode(15,pb.toString()),L.a.J(512496154,833,10,"SessionId: {0}, Message: Exception when triggering save thumbnails, Details: {1}",this.Hd.telemetryData.sessionId,pb.toString()),P(!1)}else P(!0)})}dTa(){return this.la.pptEditorVoiceUXEnabled&&this.Xl&&this.Xl.instance?!0:!1}xGi(u){if(this.dTa())switch(u){case 0:this.uHa&&
this.Xl.instance.show(ResourceStrings.L_LivePresentations_Disconnected,Jl.a.d_a);this.Hd.telemetryData.SetErrorCode(3);this.k0("DisconnectdToPrague");break;case 1:this.Xl.instance.hide();break;case 2:this.uHa&&this.Xl.instance.show(ResourceStrings.L_LivePresentations_Connecting,Jl.a.CIb);break;default:L.a.J(512496152,833,10,"SessionId: {0}, Message: Unhandled connection state value.",this.Hd.telemetryData.sessionId)}else L.a.J(512496153,833,10,"SessionId: {0}, Message: Cannot show notification for service connectivity.",
this.Hd.telemetryData.sessionId)}Nmc(u,P){this.dTa()?P.isConnected?this.Xl.instance.hide():this.uHa&&this.Xl.instance.show(ResourceStrings.L_LivePresentations_InternetDisconnected,Jl.a.CIb):L.a.J(512496151,833,10,"SessionId: {0}, Message: Cannot show notification for network connectivity.",this.Hd.telemetryData.sessionId)}Xae(u,P){u=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}&waccluster={2}",this.la.podsWebServiceBase,u,P);this.la.WQk&&(u+="&shareable=true");return u}qIl(u,
P){try{const la=new I.a;if(1===u||2===u||4===u)la.add(this.Bxd(3)),la.add(this.yQb(3));la.count?Promise.all(la.toArray()).then(()=>P()).catch(()=>P()):P()}catch(la){L.a.J(512496150,833,10,"failed to create end session task promises, error : {0}",la),P()}}get J$e(){const u=Ch.a.get("PPTLivePresentationOnboarded");return u?"true"===u.toLowerCase():!1}set J$e(u){Ch.a.oK("PPTLivePresentationOnboarded",u.toString(),Ch.a.XJ)||L.a.J(512496149,833,10,"Failed to set cookie for PPTLivePresentationOnboarded to {0}",
u.toString())}y6d(){return this.la.xRk&&!this.J$e}yaa(){try{if(L.a.J(512496148,833,15,"Pods session rehydrated!"),this.d8c=!0,this.Er&&this.kr&&this.mo){L.a.J(512496147,833,15,"SessionId: {0}, Message:OnPodSessionRehydrated: Updating file download Url for DC: {1}",this.Hd.telemetryData.sessionId,this.Ya.Ek);const u=this.Xae(this.Ya.podSessionId,this.Ya.Ek);this.mo.OnPodSessionUpdated(u)}}catch(u){L.a.J(512496146,833,10,"LivePresenter: Exception at OnPodSessionRehydrated: {0}",u.toString())}}cJb(){this.d8c=
!1}onPodSessionExpired(){this.d8c=!1}dnb(){if(this.la.yRk)try{const u=w.a.instance.Ia("Common.ISystemInitiatedFeedback");u&&(L.a.J(512496145,833,50,"LivePresenter: Floodgate survey triggered for PPTLive"),u.execute(P=>{P.logActivity("PPTWebLivePresentationsActivity","PPTLivePresentationsFloodgateSurveyEnabled")}))}catch(u){L.a.J(512496144,833,10,"LivePresenter: Exception thrown when trying to trigger floodgate survey. Exception: {0}",u)}}v$f(u){const P=document.createElement("a");P.setAttribute("href",
u);return(u=P.search.match(RegExp("[\\?&]Id=([^&#]*)")))&&2===u.length?u[1]:""}i$i(){var u=this.oc.wbg();let P=1;this.OGe.clear();for(const la of u){u=la.Uj();for(const Ba of u)if(!lb.a.Xa(Ba.Yhb)){u=this.v$f(Ba.Yhb);const Sa=new Er;Sa.kQg=u;Sa.lQg=P.toString();this.OGe.add(Sa);P+=1}}}RJh(){var u=this.oc.eFa(this.Xdb).Uj();for(const P of u)lb.a.Xa(P.Yhb)||(u=this.v$f(P.Yhb),u=this.NGe.get(u),lb.a.Xa(u)||this.mo.SetCurrentPollInfoState(u,this.Xdb))}bhi(u){this.xa.addHandler("OnLiveResourcesLoaded",
u)}r8k(u){this.xa.removeHandler("OnLiveResourcesLoaded",u)}uzf(u){this.xa.addHandler("OnLiveSessionStarted",u)}Roh(u){this.xa.removeHandler("OnLiveSessionStarted",u)}szf(u){this.xa.addHandler("OnLiveSessionEnded",u)}Qoh(u){this.xa.removeHandler("OnLiveSessionEnded",u)}hgi(u){this.xa.addHandler("OnCalloutDismissed",u)}N7k(u){this.xa.removeHandler("OnCalloutDismissed",u)}qzf(u){this.xa.addHandler("OnRelaunchPausedSession",u)}Ooh(u){this.xa.removeHandler("OnRelaunchPausedSession",u)}igi(u){this.xa.addHandler("CalloutMenuDefinitionChanged",
u)}O7k(u){this.xa.removeHandler("CalloutMenuDefinitionChanged",u)}}Object(r.a)(vs,"LivePresenter",null,[748]);class mq{constructor(){this.K=null;this.TNg=0}get name(){return"PowerPointWebEditor.Live"}Yb(u){this.K=u;const P=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.K.register(748,"PowerPointLive.ILivePresenter").ma().oa(()=>new vs(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),P,this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPoint.IPathManager"),
this.K.resolve("Common.App.OAuth.IOAuthManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.ISubtitleContext"),w.a.instance.Ia("PowerPointWebEditor.ISlideShowVoiceNotification"),this.K.resolve("PowerPointWebEditor.Core.INetworkConnectivityProvider"),
this.K.resolve("PowerPointWebEditor.IFocusManager")))}b$j(){try{this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointLiveBroadcastEnabled?(this.TNg=Date.now(),L.a.J(509441559,833,50,"PPTWebEditorLivePackage: Loading the Live Presenter scripts"),ac.a.get_instance().Mj(7,()=>{const u=this.K.resolve("Common.IDynamicScriptLoaderProvider").rI,P=lg.a(this.K),la=new I.a;la.add(u.loadScript("PPTLiveBroadcast"));la.add(u.loadScript("BroadcastMonitor"));la.add(P("liveActor"));v.AFrameworkApplication.Aa.ob.Qp||
la.add(P("uiFabricLazy"));Promise.all(la.toArray()).then(()=>this.HEk()).catch(Ba=>L.a.J(42869341,833,10,"Failed to load scripts for the Live Presenter feature: {0}",Ba))})):L.a.J(509441560,833,50,"PPTWebEditorLivePackage: Not loading the Live Presenter scripts because the feature is not enabled")}catch(u){L.a.J(509441558,833,10,"PPTWebEditorLivePackage: exception in OnFullAppSettingsReady: {0}",u)}}en(){try{if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointLiveBroadcastEnabled){if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").qRk){const u=
lb.a.AQ((v.AFrameworkApplication.fileName||"").toLowerCase());if(".ppt"===u||".pps"===u){L.a.J(509441556,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for binary file format by checking file extension.");return}".pptx"!==u&&L.a.J(509441555,833,15,"PPTWebEditorLivePackage: Allowing file extension: "+u)}this.K.resolve("PowerPointWebEditor.IApplicationSettings").tRk&&this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(4)?L.a.J(509441554,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for binary file format."):
this.K.resolve("PowerPointWebEditor.IApplicationSettings").uRk&&(this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(32)||this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(32768))?L.a.J(509441553,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for protected file."):this.K.resolve("PowerPointWebEditor.IApplicationSettings").Rgh&&"msa"===this.K.resolve("PowerPointWebEditor.IApplicationSettings").hostAuthType?L.a.J(509441552,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for MSA users."):
this.K.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(u=>{u.isFeatureEnabled("PowerPointLivePresentations",!1).then(P=>{P?this.b$j():(L.a.J(509441551,822,50,"User doesn't have license for Live broadcast feature. Skipping loading Live package!"),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLive",!0)))})})}else L.a.J(509441557,833,50,"PPTWebEditorLivePackage: Live broadcast feature is not enabled.")}catch(u){L.a.J(509441550,833,10,"OnFullAppSettingsReady: exception in OnFullAppSettingsReady: {0}",
u)}}HEk(){L.a.J(509441549,833,50,"PPTWebEditorLivePackage: Loading time: {0}ms",Date.now()-this.TNg);this.K.resolve("PowerPointLive.ILivePresenter").b$a=!0;this.K.resolve("PowerPointWebEditor.IApplicationSettings").Rgh||"msa"!==this.K.resolve("PowerPointWebEditor.IApplicationSettings").hostAuthType||appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLiveSetAccessControlOrganization",!0));return null}init(){v.AFrameworkApplication.fa.ff(Object(z.a)(this,this.en,"onFullAppSettingsReady"))}dispose(){}static main(){m.a.instance.Ac(new mq)}}
Object(r.a)(mq,"PPTWebEditorLivePackage",null,[2,3]);var Vq=d(737);class Ao{}Object(r.a)(Ao,"LokiTokenResult",null,[]);class el{constructor(u){this.dEc=u}Jkj(){const u=this.Ikj();return u?el.Foe?new Promise((P,la)=>{this.dEc.continueWith(()=>{this.dEc.ho||this.dEc.Dm?la(Error.create("Error downloading auth library")):this.dEc.result.gI("Loki",u).then(Ba=>{Ba=v.AFrameworkApplication.fa.ka("ForceLokiFallbackToACLPTokenIsEnabled")?this.Mkj():Ba.IsSuccess&&Ba.Token?Object.assign(new Ao,{isSuccess:!0,
token:Ba.Token,errorMessage:null}):Object.assign(new Ao,{isSuccess:!1,token:null,errorMessage:JSON.stringify(Ba)});P(Ba);return Ba})})}):Promise.resolve(Object.assign(new Ao,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new Ao,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",Vq.a.c4f())}))}Mkj(){const u=v.AFrameworkApplication.fa.Ha("LokiUserDataSignature")||
"";return Object.assign(new Ao,{isSuccess:!0,token:u,errorMessage:null})}Ikj(){let u=null;const P=Vq.a.iUc();2===P?u=v.AFrameworkApplication.fa.Ha("LokiAADAppId"):1===P&&(u=v.AFrameworkApplication.fa.Ha("LokiMSAAppId"));return u}static get Foe(){return v.AFrameworkApplication.fa.ka("IsO365CommercialHost")||v.AFrameworkApplication.fa.ka("IsO365ConsumerHost")}}Object(r.a)(el,"LokiTokenManager",null,[792]);class Fr{get name(){return"Common.App.LivePersonaUtils"}init(){w.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}Yb(u){u.register(el,
"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").ma().oa(()=>new el(Qi.a.Lt(u.Ia("Common.App.OAuth.IOAuthManager"))))}static main(){m.a.instance.Ac(new Fr)}}Object(r.a)(Fr,"LivePersonaUtilsPackage",null,[2,3]);var Gr=d(260);class Wq{constructor(){this.displayName=this.critique=null;this.optOut=!1;this.category=null}}Object(r.a)(Wq,"RehearsalCritique",null,[]);class bf{static qNj(){bf.GY[2]=ResourceStrings.L_SubtitleDetection_AudioQualityIssue;bf.GY[3]=ResourceStrings.L_SubtitleDetection_HighBackgroundNoise;
bf.GY[4]=ResourceStrings.L_SubtitleDetection_SpeakingTooLoud;bf.GY[5]=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet;bf.bTf=ResourceStrings.L_SubtitleDetection_MicReady;bf.cTf=ResourceStrings.L_SubtitleDetection_SoundReminder;bf.fYf=ResourceStrings.L_SubtitleDetection_NoMicrophone;bf.lYf=ResourceStrings.l_NoCamera;bf.x3f=ResourceStrings.L_SpeechGenericRetryErrorMessage}}bf.KGf=20;bf.Vmh=50002;bf.GY=Array(bf.KGf);bf.bTf=null;bf.cTf=null;bf.fYf=null;bf.lYf=null;bf.x3f=null;bf.l7d="fillerWords";
bf.kKk="originality";bf.uVl="wordsPerMinute";bf.dil="sensitivePhrases";bf.bJi="correctedSensitivePhrases";bf.oQk="positivity";bf.Fee="grammar";bf.QIe="monotone";bf.xRe="pronunciation";bf.M1d="crutchWords";bf.rQh="visionFace";bf.UTl="visionGaze";bf.TTl="visionGazeGood";bf.WTl="visionOcclusion";bf.VTl="visionOcclusionGood";bf.QTl="visionDistanceGood";bf.RTl="visionDistanceTooClose";bf.STl="visionDistanceTooFar";bf.Ebg="GetStartedButton";bf.r9j="ListeningButtonPlayPauseButton";bf.s9j="ListeningElement";
bf.SGi="ContainerElement";bf.UNk="PausedElement";bf.Syk="NotificationButtonElement";bf.BUl="WelcomeCheckboxElement";bf.Xmh="RehearsalFeedbackSettingPane";bf.TPe="PPTCoachRehearsalFREShown";Object(r.a)(bf,"RehearsalResourceString",null,[]);const Mn=(u,P)=>lb.a.Xa(P)?(n.ULS.sendTraceTag(587872E3,822,10,"RehearsalUtils:IsCritiqueEnabled Invalid critique name"),!1):u?P.toLowerCase()in u:!0,Hr=(u,P)=>{let la=null;try{if(!u||lb.a.Xa(P))return n.ULS.sendTraceTag(587871971,822,10,"RehearsalUtils:getSupportedCritiquesForLanguage SourceLanguage from session information or appsettings is null or empty"),
null;const Sa=lb.a.Xa(u.God)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(u.God,!0);la={};for(let pb in Sa){u=pb;var Ba=Sa[pb];if(Ba){const Vb=vc.a.P0b(Ba.split(","));Vb&&P.toLowerCase()in Vb&&(la[u.toLowerCase()]=!0)}}}catch(Sa){L.a.J(590136391,817,10,"RehearsalUtils:getSupportedCritiquesForLanguage Exception while building supported critique map from BRS: {0}",Sa.toString()),la=null}return la},Xq=(u,P)=>{if(lb.a.Xa(P)||lb.a.Xa(u.Qfh))return null;try{var la=Sys.Serialization.JavaScriptSerializer.deserialize(u.Qfh,
!0);if(lb.a.Xa(P)){n.ULS.sendTraceTag(587871968,822,50,"RehearsalUtils:GetLanguageCodeFromLocale locale is null or empty.");var Ba=null}else Ba=P.split("-")[0].toLowerCase();return la[Ba]}catch(Sa){return L.a.J(587872025,817,10,"RehearsalUtils:getPacingGaugeRangeLocale Exception while parsing BRS PodRehearsalLocaleBasedPacingGaugeRange: {0}",Sa.toString()),null}},Ir=u=>{if(u&&3<u.length){let P="";"ws"===u.substring(0,2)?P="http"+u.substring(2,u.length):"wss"===u.substring(0,3)&&(P="https"+u.substring(3,
u.length));return P}return u},nq=u=>{if(lb.a.Xa(u))return n.ULS.sendTraceTag(559548251,822,10,"GetMappedSourceLanguage: SourceLanguage from session information is not valid, defaulting to english. SourceLanguage: {0}",u),"en-US";switch(u.toLowerCase()){case "en-au":case "en-ca":case "en-gb":case "en-in":case "en-us":return"en-US";default:return u}};class fl{constructor(){this.userCritiques=null}}Object(r.a)(fl,"RehearseRoamingSettings",null,[]);class vn{constructor(){this.critiquesDisabledByDefault=
this.critiquesDisabled=null}}Object(r.a)(vn,"UserCritiqueSettings",null,[]);class gm{constructor(u,P,la,Ba){this.xa=new Si.a;this.MJ=this.Pec=this.EU=null;this.kM=!1;this.nzg=null;this.Nwa=this.Owa=0;this.Su=u;this.la=P;this.XHa=la;this.ia=Ba}sPj(){try{this.X$f(()=>{this.xa.raiseEvent("OnRehearsalOptOutSettingsRequestFinished",new Sys.EventArgs)})}catch(u){L.a.J(557602759,822,10,"InitiateRehearsalOptOutSettingsRequest catched exception: {0}",u.toString())}}E2c(){return 2===this.Owa&&2===this.Nwa}k8e(){try{0!==
this.Owa&&3!==this.Owa||this.X$f(Object(z.a)(this,this.uTe,"raiseRehearsalGetCritiquesEvent")),0!==this.Nwa&&3!==this.Nwa||this.wgj()}catch(u){L.a.J(559548259,822,10,"TryToInitiateCritiquesFetchingRequest catched exception: {0}",u.toString())}}kej(){if(!this.Pec)return L.a.J(559548288,822,10,"GetCritiquesListForSettingsPane empty critique list"),null;try{if(this.MJ)for(let u of this.Pec)this.MJ.contains(u.critique.toLowerCase())?u.optOut=!0:u.optOut=!1}catch(u){L.a.J(557602760,822,10,"GetCritiquesListForSettingsPane catched exception: {0}",
u.toString())}return this.Pec.toArray()}oPl(u,P){this.gOh(u,P);"vision"===u.toLowerCase()&&(this.kM=!P,u={},u.triggerPoint=bf.Xmh,this.ia.Ka(tb.a.fQb,2,u))}R9f(u=!1){let P="";if(this.MJ&&0<this.MJ.count)if(Ud.a("RehearsalFilterOptOutCritiqueEnabled")&&u){a:{var la=this.la;u=this.la.yya;var Ba=null;try{if(!la||lb.a.Xa(u)){n.ULS.sendTraceTag(554837597,822,10,"RehearsalUtils:getCritiquesStatusForLanguage SourceLanguage from session information or appsettings is null or empty");var Sa=null;break a}var pb=
lb.a.Xa(la.God)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(la.God,!0);Ba={};for(let Bc in pb){Sa=Bc;var Vb=pb[Bc];if(Vb){const Yc=vc.a.P0b(Vb.split(","));Ba[Sa.toLowerCase()]=Yc&&u.toLowerCase()in Yc?!0:!1}}}catch(Bc){L.a.J(554837598,817,10,"RehearsalUtils:getCritiquesStatusForLanguage Exception while building supported critique map from BRS: {0}",Bc.toString()),Ba=null}Sa=Ba}if(Vb=Sa)for(let Bc of this.MJ)if(pb="vision"===Bc?bf.rQh.toLowerCase():Bc.toLowerCase(),pb in Vb?Vb[pb]:1)P=lb.a.Xa(P)?
Bc.toLowerCase():P+","+Bc.toLowerCase()}else for(Ba of this.MJ)P=lb.a.Xa(P)?Ba.toLowerCase():P+","+Ba.toLowerCase();return P}Lqd(){if(2!==this.Owa)L.a.J(557602761,822,50,"SaveRehearseUserCritiques(), skipping save operation as Get request call is not succeeded");else if(this.w2j()){L.a.J(559548291,822,50,"SaveRehearseUserCritiques(), Start sending write request to FE");var u=new fl;u.userCritiques=Object.assign(new vn,{critiquesDisabled:this.R9f(),critiquesDisabledByDefault:this.EU.userCritiques.critiquesDisabledByDefault});
var P=cd.c(u),la=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","savePowerPointRehearseUserCritiques",v.AFrameworkApplication.gh),Ba={};Ba["X-StatelessPopsAffinityRoutingEnabled"]=this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.Su.zj(la,2,P,Ba,!1,2,Sa=>{this.eHk(Sa,u)},Object(z.a)(this,this.dHk,"onSaveUserCritiquesFailed"),null,void 0,void 0,void 0,void 0,Gr.a("17"))}else L.a.J(559548290,822,50,"SaveRehearseUserCritiques(), skipping save operation")}get K6d(){return this.kM}set K6d(u){this.kM=
u;this.gOh("vision",!this.kM);this.E2c()&&this.xa.raiseEvent("OnRehearsalSettingsUpdatedExternally",Sys.EventArgs.Empty)}Vgi(u){this.xa.addHandler("OnRehearsalOptOutSettingsRequestFinished",u)}m8k(u){this.xa.removeHandler("OnRehearsalOptOutSettingsRequestFinished",u)}Ugi(u){this.xa.addHandler("OnRehearsalGetCritiquesSucceeded",u)}l8k(u){this.xa.removeHandler("OnRehearsalGetCritiquesSucceeded",u)}Tgi(u){this.xa.addHandler("OnRehearsalGetCritiquesFailed",u)}k8k(u){this.xa.removeHandler("OnRehearsalGetCritiquesFailed",
u)}Wgi(u){this.xa.addHandler("OnRehearsalSettingsUpdatedExternally",u)}n8k(u){this.xa.removeHandler("OnRehearsalSettingsUpdatedExternally",u)}gOh(u,P){this.MJ&&(u=u.toLowerCase(),P&&!this.MJ.contains(u)?this.MJ.add(u):!P&&this.MJ.contains(u)&&this.MJ.remove(u),Ud.a("RehearsalRoamingSettingAutoSaveEnabled")&&this.Lqd())}w2j(){let u=!1;try{var P=lb.a.Xa(this.EU.userCritiques.critiquesDisabled);if(!this.MJ||!this.MJ.count&&P)return!1;if(P&&0<this.MJ.count||!P&&!this.MJ.count)return!0;const la=new Set(this.EU.userCritiques.critiquesDisabled.split(","));
if(this.MJ.count!==la.size)return!0;for(P=0;P<this.MJ.count;P++)if(!la.has(this.MJ.ga(P).toLowerCase())){u=!0;break}}catch(la){L.a.J(557602762,822,10,"IsSaveRehearsalSettingsRequired catched exception: {0}",la.toString())}return u}eHk(u,P){this.EU=P;L.a.J(559548292,822,50,"OnSaveUserCritiquesSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+u.data.wv-+u.data.OI,+u.data.iu-+u.data.OI)}dHk(u){const P=this.XHa.Nka(u);L.a.J(559548293,822,50,"OnSaveUserCritiquesFailed: Web service failed with {0}, NumSlides={1}",
P,u.data.state)}X$f(u){const P=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","getPowerPointRehearseUserCritiques",v.AFrameworkApplication.gh),la={};la["X-StatelessPopsAffinityRoutingEnabled"]=this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.Su.zj(P,1,null,la,!1,2,Ba=>{this.KDk(Ba,u)},Ba=>{this.JDk(Ba,u)},null,void 0,void 0,void 0,void 0,Gr.a("16"));this.Owa=1}KDk(u,P){let la=0;try{u.data.ee&&0<u.data.ee.trim().length&&(la=u.data.ee.length,
this.EU=JSON.parse(u.data.ee));this.EU&&this.EU.userCritiques||(this.EU=new fl,this.EU.userCritiques=new vn);lb.a.Xa(this.EU.userCritiques.critiquesDisabledByDefault)&&(this.EU.userCritiques.critiquesDisabledByDefault="vision",lb.a.Xa(this.EU.userCritiques.critiquesDisabled)?this.EU.userCritiques.critiquesDisabled="vision":this.EU.userCritiques.critiquesDisabled+=",vision");this.MJ=new I.a;if(!lb.a.Xa(this.EU.userCritiques.critiquesDisabled)){const Ba=this.EU.userCritiques.critiquesDisabled.split(",");
for(const Sa of Ba)this.MJ.add(Sa.toLowerCase())}this.kM=!this.MJ.contains("vision");this.Owa=2}catch(Ba){this.Owa=3,L.a.J(559548294,822,10,"OnGetUserCritiquesSucceeded catched exception: {0}",Ba.toString())}P&&P();u=String.format("OnGetUserCritiquesSucceeded, responseSize={0}, EnqueueTime={1}, InvokedTime={2}, CompletedTime={3}",la,JSON.stringify(u.data.OI),JSON.stringify(u.data.iu),JSON.stringify(u.data.wv));L.a.J(559548295,822,50,u)}JDk(u,P){this.Owa=3;P&&P();u=this.XHa.Nka(u);L.a.J(559548296,
822,50,"OnGetUserCritiquesFailed: Web service failed with {0}",u)}wgj(){try{const P=this.d3i();if(lb.a.Xa(P))L.a.J(559548297,822,10,"GetEnabledCritiquesForClientAndLocale failed to generate FD url for GetCritiques request");else{var u=new XMLHttpRequest;u.open("GET",P,!0);u.onreadystatechange=()=>{if(4===u.readyState){if(200===u.status){L.a.J(559548298,822,50,"GetEnabledCritiquesForClientAndLocale: GetCritiques call successfuly completed");const la=cd.b(u.responseText);if(la){this.Pec=new I.a;for(const Ba of la.critiquesData)this.Pec.add(Object.assign(new Wq,
{category:Ba.category,displayName:Ba.displayName,optOut:!1,critique:Ba.critique.toLowerCase()}));this.nzg=la.categoriesData;this.Nwa=2}else this.Nwa=3}else this.Nwa=3;this.uTe()}};u.send("");this.Nwa=1}}catch(P){this.Nwa=3,this.uTe(),L.a.J(559548299,822,10,"GetEnabledCritiquesForClientAndLocale catched exception: {0}",P.toString())}}d3i(){const u=cd.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()).Ring||"Unknown",P=this.la.pptEditorSpeechHandlerBaseUri.replace("wss","https");
return P&&P.length?String.format("{0}GetCritiqueListHandler.ashx?action=GetCritiqueList&client=web&audiencegroup={1}&locale={2}",P,u,nq(this.la.yya)):null}uTe(){0!==this.Owa&&1!==this.Owa&&0!==this.Nwa&&1!==this.Nwa&&(this.E2c()?this.xa.raiseEvent("OnRehearsalGetCritiquesSucceeded",new Sys.EventArgs):this.xa.raiseEvent("OnRehearsalGetCritiquesFailed",new Sys.EventArgs))}}Object(r.a)(gm,"RehearsalFeedbackSettings",null,[745]);class Jr{constructor(){this.type="RehearsalCritiqueWithGroupProps";this.retryToFetchCritiqueSettings=
this.locale=this.updateCritiqueState=this.categoriesData=this.groupItems=null;this.isExternalUpdated=this.showErrorMessage=this.showLoadingMessage=!1}}Object(r.a)(Jr,"RehearsalCritiqueWithGroupProps",null,[]);class So{constructor(u,P,la,Ba,Sa){this.PHa=this.Ab=!1;u("powerpoint-presenter-coach-strings").then(()=>{this.PHa=!0;L.a.J(509138183,822,50,"powerpoint-presenter-coach-strings loaded successfully")}).catch(pb=>{L.a.J(509138182,822,10,"Failed to load powerpoint-presenter-coach-strings "+pb.toString())});
this.ia=P;this.la=Sa;this.IB=la;this.By=Ba;this.ia.Kaa(this)}vb(){this.ia.ya(tb.a.rud,ib.a.application,Object(z.a)(this,this.rud,"showRehearsalFeedbackSettingsPane"));this.ia.ya(tb.a.fud,ib.a.application,Object(z.a)(this,this.fud,"showHideRehearsalFeedbackSettingsPane"));this.ia.ra(tb.a.xnd,ib.a.application,Object(z.a)(this,this.xnd,"queryShowHideRehearsalFeedbackSettingsPane"),96)}pe(){}b6(){}a6(){}rud(u,P,la){if(P.contextId!==ib.a.application||!this.PHa)return 2;if(1===la)return 32;this.Ab?Xb.UISurfaces.Gq().then(Ba=>
{Ba.setSelectedTaskPane(Ad.a.Ujb);this.TA(!0);return null}).catch(Ba=>{L.a.J(509138180,822,10,"RehearsalFeedbackSettingsPane::ShowRehearsalFeedbackSettingsPane exception: {0}",Ba.toString())}):(this.Ab=!0,this.Qmh(),(u=!this.By.E2c())&&this.By.k8e(),u=this.fA(u,!1),this.Ytc(u),L.a.J(509138181,822,50,"RehearsalFeedbackSettingsPaneActor::ShowRehearsalFeedbackSettingsPane"));return 32}fud(u,P,la){if(P.contextId!==ib.a.application||!this.PHa)return 2;if(1===la)return 32;(this.Ab=!this.Ab)?(this.Qmh(),
(u=!this.By.E2c())&&this.By.k8e(),u=this.fA(u,!1),this.Ytc(u),L.a.J(509138179,822,50,"RehearsalFeedbackSettingsPaneActor::ShowHideRehearsalFeedbackSettingsPane show")):(this.jCi(),L.a.J(509138178,822,50,"RehearsalFeedbackSettingsPaneActor::ShowHideRehearsalFeedbackSettingsPane close"));return 32}xnd(u,P,la,Ba,Sa){if(!Object(Mh.a)(dk.a,Sa))return 8;Sa.Hf(this.Ab);return 32}Ytc(u,P=!1){const la=Object.assign(new Db.a,{title:ResourceStrings.L_RehearseFeedbackSettings,hideHeader:!1,width:320,location:2,
contentProps:u,onOpen:()=>{},onClose:()=>{this.Ab=!1;this.LSi();this.By.Lqd()},onHide:()=>{this.By.Lqd()},isModernPane:!0});u=document.getElementById("RehearsalFeedbackSettingsPaneFocus-panel");this.IB.q4(Ad.a.Ujb,Ad.a.Xi,u,()=>{this.TA(!0)},()=>{this.TA(!1)});Xb.UISurfaces.Gq().then(Ba=>{P?this.Ab&&Ba.updateTaskPane(Ad.a.Ujb,la):Ba.showTaskPane(Ad.a.Ujb,la);return null}).catch(Ba=>{L.a.J(509138177,822,10,"RehearsalFeedbackSettingsPaneActor::ShowFeedbackSettingPane exception: {0}",Ba.toString())})}jCi(){Xb.UISurfaces.Gq().then(u=>
{u.hideTaskPane(Ad.a.Ujb,2);return null}).catch(u=>{L.a.J(509138176,822,10,"RehearsalFeedbackSettingsPaneActor::CloseFeedbackSettingPane exception: {0}",u.toString())})}fA(u,P){return Object.assign(new Jr,{groupItems:u||P?null:this.By.kej(),categoriesData:this.By.nzg,locale:this.la.yya,updateCritiqueState:(la,Ba)=>{this.By.oPl(la,Ba)},retryToFetchCritiqueSettings:()=>{this.By.k8e()},showLoadingMessage:u,showErrorMessage:P})}TA(u){const P=document.getElementById("TaskPaneCloseBtnRehearsalFeedbackSettingsPaneFocus");
u&&P&&P.focus()}Qmh(){this.By.Ugi(Object(z.a)(this,this.vah,"onRehearsalGetCritiquesSucceeded"));this.By.Tgi(Object(z.a)(this,this.uah,"onRehearsalGetCritiquesFailed"));this.By.Wgi(Object(z.a)(this,this.xah,"onRehearsalSettingsUpdatedExternally"))}LSi(){this.By.l8k(Object(z.a)(this,this.vah,"onRehearsalGetCritiquesSucceeded"));this.By.k8k(Object(z.a)(this,this.uah,"onRehearsalGetCritiquesFailed"));this.By.n8k(Object(z.a)(this,this.xah,"onRehearsalSettingsUpdatedExternally"))}vah(){const u=this.fA(!1,
!1);this.Ytc(u,!0)}uah(){const u=this.fA(!1,!0);this.Ytc(u,!0)}xah(){const u=this.fA(!1,!1);u.isExternalUpdated=!0;this.Ytc(u,!0)}}Object(r.a)(So,"RehearsalFeedbackSettingsPane",null,[143]);var Sp;(function(u){u[u.none=0]="none";u[u.ribbon=1]="ribbon";u[u.slideShowToolbar=2]="slideShowToolbar";u[u.summaryPage=3]="summaryPage";u[u.ribbonTopBar=4]="ribbonTopBar";u[u.deepLink=5]="deepLink"})(Sp||(Sp={}));Object(r.b)("RehearsalEntryPoint",Sp);class gl{constructor(){this.imagesBaseFilePath=this.slideState=
this.rootContainer=null;this.zIndex=0;this.fUseCountdownWelcomeScreen=this.fShowRealtimeFeedbackEnabledCheckbox=this.fEnableVision=!1;this.speechFDBase=null;this.fUseNewRealtimeCheckbox=this.fUseNewRealtimePanel=this.fDontShowTooltips=!1}}Object(r.a)(gl,"ICoachActorConfig",null,[]);class Kr{constructor(){this.rootContainer=this.imagesBaseFilePath=null;this.zIndex=0}}Object(r.a)(Kr,"ICoachFREActorConfig",null,[]);class oq{constructor(){this.customSettings=this.requestedRehearsalOptOutFeatures=this.requestedCoachFeatures=
this.documentDownloadConfig=this.userSessionId=this.disabledCoachRealtimeFeatures=this.logger=null;this.fEnableVision=!1;this.supportedRehearsalTemplates=this.sourceLanguage=this.entryPoint=this.wacDatacenter=this.wacHost=this.locale=this.buildVersion=this.audienceGroup=this.audienceChannel=this.identityProvider=this.tenantId=this.userId=this.speechFDBase=this.webcamConfig=null;this.fEnableServiceSideAggregationForCoach=!1;this.httpTimeoutForCoachSummaryData=0;this.enableTimeStampedCritiqueTelemetry=
this.fSendClientMetaDataOnSessionStart=!1;this.audioInputDeviceCount=0}}Object(r.a)(oq,"ICoachSessionConfig",null,[]);class To{constructor(){this.docId=this.podsSessionId=this.webServiceBase=this.userDataCenterClusterId=null}}Object(r.a)(To,"IDocumentDownloadConfig",null,[]);class Lr{constructor(){this.totalSlideCount=this.currentSlideIndex=0}}Object(r.a)(Lr,"ISlideState",null,[]);class up{constructor(){this.workingCanvas=this.videoView=null;this.requestedVideoHeight=this.requestedVideoWidth=this.webcamFrameWidth=
this.numFramesPerSecond=0}}Object(r.a)(up,"IWebcamConfig",null,[]);var vp=d(685);class sk{constructor(u,P,la,Ba,Sa,pb,Vb,Bc,Yc,gd,Td,Re,Uf,Ef){this.CXa=!1;this.Hw=this.Jue=this.BX=this.Pea=null;this.njc=0;this.qWg=-1;this.zkc=0;this.yfd=this.nfd=null;this.dye=this.Uxe=!1;this.JEe=this.sna=0;this.kM=!1;this.xa=new Si.a;this.qZa=null;this.zDg=this.BHe=this.Nte=!1;this.LEe=null;this.gec=this.Jzg=0;this.lZg=this.VCg=!1;this.bDg=v.AFrameworkApplication.fa.ka("FirstRehearsalExperienceEnabled");this.ygk=
la;P&&(this.Pea=P.SF());this.jb=Ba;this.ia=u;this.oc=Sa;this.ta=pb;this.Ya=Vb;this.la=Bc;this.Xl=Yc;this.dfa=gd;this.mjc=Td;this.By=Re;this.xO=Uf;this.uu=Ef;this.Q5b()&&this.By.Vgi(Object(z.a)(this,this.wah,"onRehearsalOptOutSettingsRequestFinished"))}vb(){this.ia.ya(tb.a.Guc,ib.a.application,Object(z.a)(this,this.Guc,"startRehearsalManager"));this.ia.ya(tb.a.fQb,ib.a.application,Object(z.a)(this,this.fQb,"toggleRehearsalVisionEnabled"));this.ia.ya(tb.a.Nqc,ib.a.application,Object(z.a)(this,this.Nqc,
"rehearsePresentationDropDown"));this.ia.ra(tb.a.jLb,ib.a.application,Object(z.a)(this,this.jLb,"queryRehearsalVisionEnabled"),96)}jLb(u,P,la,Ba,Sa){if(!Sa||!Object(Mh.a)(dk.a,Sa))return L.a.J(512496082,822,10,"RehearsalManager::QueryRehearsalVisionEnabled requires actionData"),8;Sa.Hf(this.kM);return 32}Nqc(u,P,la){switch(la){case 1:if(this.CXa&&this.yqe())return this.ia.processAction(tb.a.wga,1);break;default:L.a.J(512496081,822,10,"RehearsePresentationDropDown: Unimplemented action behavior")}return 8}fQb(u,
P,la,Ba,Sa){switch(la){case 2:return this.kM=!this.kM,v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.ob.Qp&&uc.App.Lb.BG({ToggleRehearsalVisionEnabled:"CheckboxModel"}),this.Q5b()&&Sa&&Sa.triggerPoint!==bf.Xmh&&(this.By.K6d=this.kM),32;case 1:if(this.CXa&&this.yqe())return 32;break;default:L.a.J(512496080,822,10,"ToggleVisionEnabled: Unimplemented action behavior")}return 8}Guc(u,P,la,Ba,Sa){switch(la){case 2:return this.XAl(Sa),32;case 1:if(this.CXa&&this.yqe())return 32;break;default:L.a.J(512496079,
822,10,"StartRehearsalManager: Unimplemented action behavior")}return 8}odc(){try{this.Jzg=Date.now();const u=this.ygk.rI;u.loadScript("powerpoint-presenter-coach-strings").then(()=>{const P=new I.a;P.add(u.loadScript("CoachActorPackage"));P.add(u.loadScript("CoachPackage"));Promise.all(P.toArray()).then(()=>{this.FBk();return null}).catch(la=>{L.a.J(512496078,801,10,"Failed to load scripts for the Presenter Coach feature: {0}",la);return null})})}catch(u){L.a.J(512496077,822,10,"RehearsalManager: Exception in LoadResources : {0}.",
u)}}jgi(u){this.xa.addHandler("OnCoachResourcesLoaded",u)}P7k(u){this.xa.removeHandler("OnCoachResourcesLoaded",u)}FBk(){const u=v.AFrameworkApplication.fa.Ha("CoachPackageCssUrl"),P=document.createElement("link");P.setAttribute("rel","stylesheet");P.setAttribute("type","text/css");P.setAttribute("href",u);$addHandler(P,"load",()=>{this.CXa=!0;Ud.a("PollToRefreshCoachEntryPointOnRibbon")&&this.uu&&this.uu.PA();this.xa.raiseEvent("OnCoachResourcesLoaded",new Sys.EventArgs);L.a.J(512496076,822,50,"RehearsalManager: Coach package loading time: {0}ms",
Date.now()-this.Jzg)});document.body.appendChild(P)}B4k(){this.jb.hJc(Object(z.a)(this,this.Abh,"onSlideshowReady"));this.jb.KQa(Object(z.a)(this,this.hnc,"onSlideShowPositionChanged"));this.jb.ija(Object(z.a)(this,this.jga,"onSlideshowExitHandler"));this.jb.iJc(Object(z.a)(this,this.Sxa,"onSpecialKeyHandler"))}MSi(){this.jb.dpd(Object(z.a)(this,this.Abh,"onSlideshowReady"));this.jb.dkb(Object(z.a)(this,this.hnc,"onSlideShowPositionChanged"));this.jb.yga(Object(z.a)(this,this.jga,"onSlideshowExitHandler"));
this.jb.epd(Object(z.a)(this,this.Sxa,"onSpecialKeyHandler"))}Sxa(u,P){P.key===oa.a.PRb&&this.RZe()}RZe(){if(0===this.sna){var u=this.Hw.getCoachElement(bf.Ebg);u&&this.GLa(u)}else 2===this.sna?(u=this.Hw.getCoachElement(bf.UNk))&&this.GLa(u):1===this.sna&&(u=this.Hw.getCoachElement(bf.s9j))&&this.GLa(u)}GLa(u){this.Pea&&this.Hw&&window.setTimeout(()=>{ud.FocusManager.Zq(u)},50)}kA(u){try{const Sa=this.Hw.getCoachElement(bf.Ebg),pb=this.Hw.getCoachElement(bf.r9j),Vb=this.Hw.getCoachElement(bf.BUl),
Bc=this.Hw.getCoachElement(bf.Syk);if(u.keyCode===oa.a.$q){if(!Ud.a("PresenterCoachTabFix")){var P=!Vb&&!!Sa&&u.target===Sa||!!Vb&&u.target===Vb,la=!!Sa&&!!pb&&pb.contains(u.target),Ba=!!Bc&&u.target===Bc;(P||la||Ba)&&this.jb.restoreFocus()}}else u.keyCode===oa.a.qS||u.keyCode===oa.a.n2?(this.jb.prev(),this.RZe()):u.keyCode===oa.a.BP||u.keyCode===oa.a.m2?(this.jb.next(),this.RZe()):u.keyCode===oa.a.Dp||u.keyCode===oa.a.sRb||u.shiftKey||this.jb.restoreFocus()}catch(Sa){L.a.J(512496075,822,10,"RehearsalManager: Exception in KeyDownHandler : {0}.",
Sa)}}M3k(){const u=this.Hw.getCoachElement(bf.SGi);if(Ud.a("PresenterCoachTabFix")){var P=document.getElementById("HiddenFocusTrapAnchor");this.Pea.insertBefore(u,P)}else P=document.getElementById("slideshowEndFocusTrap"),this.Pea.insertBefore(u,P);u&&Be.a.addHandler(u,Ca.a.Bf,Object(z.a)(this,this.kA,"keyDownHandler"))}XAl(u){if(!this.ta.Ba)throw Error.argumentNull("ActiveSlide is null");bf.qNj();this.B4k();this.Q5b()&&(this.By.Lqd(),this.By.m8k(Object(z.a)(this,this.wah,"onRehearsalOptOutSettingsRequestFinished")));
const P=new Lr;this.qZa=Hr(this.la,this.la.yya);this.kM&&!this.la.pptRehearsalVisionEnabled&&L.a.J(512496074,822,10,"RehearsalManager::startRehearsalSession: vision enabled but BRS is disabled.");this.kM=this.kM&&this.la.pptRehearsalVisionEnabled;var la=new kp.a,Ba=Object(S.a)(117,this.oc.eFa(this.ta.Ba.Db.sid));P.currentSlideIndex=Ba?Ba.ue:0;P.totalSlideCount=this.oc.Cj();Ba=this.Ccj(P);this.Hw=(new CoachActorPackage.CoachActorFactory).createCoachActorManager(Ba,la);this.kM&&(this.nfd=this.Hw.getRehearsalVideoElement(),
this.yfd=this.Hw.getRehearsalVideoCanvas());this.JEe=u;u=this.T9d(P,this.nfd,this.yfd);this.BX=(new CoachPackage.CoachSessionFactory).createCoachManager(u);u=this.Dcj();this.Jue=(new CoachActorPackage.CoachFREActorFactory).createCoachFREActorManager(u,la);Ud.a("PPTORehearsalLogAudioInputDeviceCountTelemetry")&&this.xO.enumerateDevices(Object(z.a)(this,this.ymc,"onEnumerateDevicesSuccess"),Object(z.a)(this,this.m_a,"onDevicesFailure"),Object(z.a)(this,this.v_a,"onUnsupported"));this.E2k();this.F2k();
this.njc=0;this.dye=!1;this.M3k();2===this.JEe&&(la=localStorage.getItem(bf.TPe),this.bDg&&!la?this.LEh():this.y3e())}y3e(){this.sna=0;this.dfa.execute(u=>{u.dF(vp.a.SubtitlesButton,!1);u.dF(vp.a.LiveButton,!1);u.dF(vp.a.CoachButton,!1);u.dF(vp.a.MicButton,!1)});this.BX.startSession(!0)}LEh(){this.Jue.showCoachFREUI(u=>{localStorage.setItem(bf.TPe,"true");this.lZg=u;this.y3e()})}ymc(u){this.gec=0;if(u.length)for(var P of u)"audioinput"===P.kind&&(this.gec+=1);else this.gec=0;this.VCg=!0;u=new Lr;
P=Object(S.a)(117,this.oc.eFa(this.ta.Ba.Db.sid));u.currentSlideIndex=P?P.ue:0;u.totalSlideCount=this.oc.Cj();u=this.T9d(u,this.nfd,this.yfd);this.BX.updateSessionConfiguration(u)}m_a(u){L.a.J(512496073,822,50,"RehearsalManager::OnDevicesFailure unable to get devices. Error: {0}",u.toString())}v_a(){L.a.J(512496072,822,10,"RehearsalManager::OnDevicesUnsupported mediaDevices API not available for browser: {0}",qd.a.iz)}Abh(){const u=localStorage.getItem(bf.TPe);this.bDg&&!u?this.LEh():this.y3e()}hnc(u,
P){u=new Lr;u.currentSlideIndex=P.slideIndex;u.totalSlideCount=this.oc.Cj();P=this.T9d(u,this.nfd,this.yfd);this.BX.updateSessionConfiguration(P);this.Hw.updateCoachSlideComponent(u)}getTraceRequestMetadata(u,P){const la={};if(u)for(let Ba in u)la[Ba]=u[Ba];if(P)for(let Ba in P)la[Ba]=P[Ba];u=cd.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());la.AudienceGroup=u.Ring||"Unknown";la.BuildVersion=v.AFrameworkApplication.buildVersion||"Unknown";la.ClientType="web";la.IdentityProvider=
this.la.hostAuthType||v.AFrameworkApplication.fa.Ha("HostAuthType")||"Unknown";la.Locale=this.la.uKa||"Unknown";la.SpeechMode="rehearsal";la.TenantId=v.AFrameworkApplication.fa.Ha("TenantId");la.UserId=this.getUserId();la.WacDatacenter=u.WACDatacenter||"Unknown";la.WacHost=u.Host||"Unknown";la.SourceLanguage=this.la.pLf||nq(this.la.yya);return la}getUserId(){let u=v.AFrameworkApplication.fa.Ha("PptEditingUserId");lb.a.Xa(u)&&(u=v.AFrameworkApplication.fa.Ha("LoggableUserId"),n.ULS.sendTraceTag(512496071,
822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",lb.a.Xa(u)));return u}Ahl(){if(this.la.ROk){var u=this.BX.getTraceRequestMetadata(),P=this.Hw.getTraceRequestMetadata(),la=this.la.pptEditorSpeechHandlerBaseUri.replace("wss","https");if(la&&la.length){var Ba=String.format("{0}SpeechHandler.ashx?action=SendTraceRequest",la);la=new XMLHttpRequest;la.open("POST",Ba,!0);Ba=ua.a.create().toString();la.setRequestHeader("X-Correlation",Ba);try{n.ULS.sendTraceTag(512496069,
822,50,"SendPPTCastTraceRequest: Sending request with CorrelationId:{0}",Ba);const Sa=this.getTraceRequestMetadata(u,P);la.send(cd.c(Sa))}catch(Sa){n.ULS.sendTraceTag(512496068,822,10,"SendPPTCastTraceRequest failed. CorrelationId:{0}",Ba)}}else n.ULS.sendTraceTag(512496070,822,10,"SendPPTCastTraceRequest failed: unable to retrieve basePPTCastUrl.")}}jga(){this.MSi();this.sna=3;this.BX.stopSession();this.Jue.hideCoachFREAndWelcomeUI();this.Hw.hideCoachUI();this.BHe=this.Nte=!1;try{this.BX.getSessionSummary(u=>
{u.timeSpentInSeconds=this.njc;this.ia.processAction(tb.a.iRc,2);this.ia.processAction(tb.a.hRc,2);window.clearInterval(this.qWg);this.dye&&this.mjc.instance.hMa(u,this.kM,this.qZa,this.LEe,()=>{this.Ahl()})})}catch(u){n.ULS.sendTraceTag(512496067,822,10,"OnSlideshowExitHandler - getSessionSummary failed. Exception:{0}",u)}}Cpj(){let u=",visionFace";this.la.HRk&&(u+=","+bf.UTl+","+bf.TTl);this.la.IRk&&(u+=","+bf.WTl+","+bf.VTl);this.la.GRk&&(u+=","+bf.QTl+","+bf.RTl+","+bf.STl);return bf.uVl+(Mn(this.qZa,
bf.l7d)?","+bf.l7d:"")+","+bf.dil+","+bf.bJi+","+bf.kKk+","+bf.oQk+(this.la.UPe&&Mn(this.qZa,bf.Fee)?","+bf.Fee:"")+(this.la.gPe&&Mn(this.qZa,bf.QIe)?","+bf.QIe:"")+(this.la.pptRehearsalVisionEnabled&&Mn(this.qZa,bf.rQh)?u:"")+(this.la.pptRehearsalPronunciationEnabled&&Mn(this.qZa,bf.xRe)?","+bf.xRe:"")+(this.la.pptRehearsalCrutchWordsEnabled&&Mn(this.qZa,bf.M1d)?","+bf.M1d:"")}T9d(u,P,la){const Ba=new oq;Ba.disabledCoachRealtimeFeatures="";Ba.userSessionId=v.AFrameworkApplication.userSessionId;var Sa=
new To;Sa.docId=v.AFrameworkApplication.gh;Sa.podsSessionId=this.Ya.podSessionId;Sa.userDataCenterClusterId=this.Ya.Ek;Sa.webServiceBase=this.la.podsWebServiceBase;Ba.documentDownloadConfig=Sa;Sa=new kp.a;Ba.logger=Sa;Sa={};Sa.currentSlideIndex=u.currentSlideIndex.toString();Ba.customSettings=Sa;Ba.fEnableServiceSideAggregationForCoach=this.la.hmd;Ba.httpTimeoutForCoachSummaryData=this.la.TRk;Ba.fSendClientMetaDataOnSessionStart=this.la.DYi;Ba.speechFDBase=this.la.pptEditorSpeechHandlerBaseUri;Ba.requestedCoachFeatures=
this.Cpj();this.Q5b()&&(this.LEe=this.By.R9f(!0),Ba.requestedRehearsalOptOutFeatures=this.LEe);Ud.a("RehearsalTimeStampedCritiqueTelemetryEnabled")&&(Ba.enableTimeStampedCritiqueTelemetry=!0);Ba.entryPoint=Sp[this.JEe];Ba.fEnableVision=this.kM;Ba.fEnableVision&&P&&la&&(Ba.webcamConfig=Object.assign(new up,{videoView:P,workingCanvas:la,numFramesPerSecond:this.la.pptRehearsalVisionFramesPerSecond,webcamFrameWidth:this.la.KRk}));Ba.supportedRehearsalTemplates=this.Hw.getSupportedRehearsalTemplates();
Ud.a("PPTORehearsalLogAudioInputDeviceCountTelemetry")&&this.VCg&&(Ba.audioInputDeviceCount=this.gec);u=cd.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());Ba.userId=this.getUserId();Ba.tenantId=v.AFrameworkApplication.fa.Ha("TenantId");Ba.identityProvider=this.la.hostAuthType||v.AFrameworkApplication.fa.Ha("HostAuthType")||"Unknown";Ba.audienceChannel="";Ba.audienceGroup=u.Ring||"Unknown";Ba.buildVersion=v.AFrameworkApplication.buildVersion||"Unknown";Ba.locale=this.la.uKa||
"Unknown";Ba.wacHost=u.Host||"Unknown";Ba.wacDatacenter=u.WACDatacenter||"Unknown";Ba.sourceLanguage=this.la.pLf||nq(this.la.yya);L.a.J(512496066,822,50,"getCoachSessionConfig: Language values are PodsUICulture: {0}, RegionalSettingsUserLanguage: {1}.",this.la.uKa,this.la.yya);return Ba}Dcj(){const u=new Kr;u.rootContainer=this.Pea;u.zIndex=bf.Vmh;u.imagesBaseFilePath=v.AFrameworkApplication.fa.Ha("CoachImagesBaseFilePath");return u}Ccj(u){const P=new gl;P.rootContainer=this.Pea;P.slideState=u;P.imagesBaseFilePath=
v.AFrameworkApplication.fa.Ha("CoachImagesBaseFilePath");P.zIndex=bf.Vmh;P.fEnableVision=this.kM;P.fShowRealtimeFeedbackEnabledCheckbox=this.la.QOk;P.fUseNewRealtimePanel=this.la.Fod;P.fUseCountdownWelcomeScreen=v.AFrameworkApplication.fa.ka("PptCoachEnableCountdownWelcomeUI");P.speechFDBase=Ir(this.la.pptEditorSpeechHandlerBaseUri);P.fDontShowTooltips=qd.a.gg;P.fUseNewRealtimeCheckbox=Ud.a("UseNewRealtimeCheckbox");return P}FPl(){2!==this.sna&&(this.njc+=1,this.Hw&&this.Hw.updateTimer(this.njc))}E2k(){this.Hw.on("CoachSessionStarted",
()=>{this.sna=1;this.qWg=window.setInterval(Object(z.a)(this,this.FPl,"updatePresentationTimer"),1E3);this.BX.enableVoiceStreaming();this.nxl();this.dye=!0});this.Hw.on("CoachSessionPaused",()=>{this.sna=2;this.BX.pauseSession();this.rka()&&this.Xl.instance.hide()});this.Hw.on("CoachSessionResumed",()=>{this.sna=1;this.BX.resumeSession()})}F2k(){this.BX.on("SpeechRecognitionStarted",()=>{this.Uxe&&this.rka()&&(this.Xl.instance.hide(),this.Uxe=!1)});this.BX.on("PPTCoachRealtimeNotification",u=>{this.fAj(u)});
this.BX.on("QualityStatusChanged",u=>{this.QDj(u)});this.BX.on("MediaStatusChanged",u=>{this.sCj(u)});this.BX.on("Error",u=>{this.handleError(u)});this.BX.on("ConnectionRetry",()=>{this.rBj()})}rBj(){this.Uxe=!0;this.rka()&&this.Xl.instance.show(bf.x3f,Jl.a.d_a)}fAj(u){this.Hw.updateCoachRealtimeNotification(u)}handleError(u){u=Object(S.a)(String,u);this.sna=4;u?u.startsWith("ErrorAudio")?(this.Hw&&this.Hw.showCoachDisabledUI(0),this.rka()&&this.Xl.instance.show(bf.fYf,Jl.a.d_a)):u.startsWith("ErrorVideo")?
(this.Hw&&this.Hw.showCoachDisabledUI(1),this.rka()&&this.Xl.instance.show(bf.lYf,Jl.a.d_a)):L.a.J(512496064,822,10,"RehearsalManager::handleError unhandled errorInfo"):L.a.J(512496065,822,10,"RehearsalManager::handleError errorInfo null")}FEh(){this.Hw&&(this.kM&&this.Hw.enableCoachVideoUI(),this.Hw.showCoachRealtimeUI(this.lZg));this.rka()&&this.Xl.instance.show(bf.bTf,Jl.a.thd)}sCj(u){"AudioDeviceConnected"===u.mediaStatus?(this.Nte=!0,this.kM&&!this.BHe||this.FEh()):"VideoSetupCompleted"===u.mediaStatus&&
(this.BHe=!0,this.Nte&&(this.Hw&&this.Hw.enableCoachVideoUI(),this.FEh()))}QDj(u){if(this.la.pptEditorVoiceUXEnabled){var P=u.severity,la=u.shortCode;if(0<la&&la<bf.KGf&&bf.GY[la])switch(P){case 0:this.rka()&&this.Xl.instance.hide();break;case 1:(u=0<la?bf.GY[la]:u.shortString)&&this.rka()&&this.Xl.instance.show(u,Jl.a.CIb);break;case 2:(u=0<la?bf.GY[la]:u.shortString)&&this.rka()&&this.Xl.instance.show(u,Jl.a.d_a)}else L.a.J(512496035,822,10,"onQualityStatusChanged: Invalid short code")}}rka(){return this.la.pptEditorVoiceUXEnabled&&
this.Xl&&this.Xl.instance&&2!==this.sna?!0:!1}nxl(){this.rka()&&(this.Xl.instance.show(bf.cTf,Jl.a.thd),this.zkc=window.setTimeout(Object(z.a)(this,this.zge,"hideSoundReminderNotification"),3E3))}zge(){this.rka()&&(window.clearTimeout(this.zkc),this.Xl.instance.hide())}Q5b(){return this.la.tKb&&!!this.By}yqe(){return this.Q5b()?this.zDg:!0}wah(){this.zDg=!0;this.kM=this.By.K6d;Ud.a("PollToRefreshCoachEntryPointOnRibbon")&&this.uu&&this.uu.PA()}}Object(r.a)(sk,"RehearsalManager",null,[746]);class wp{constructor(u,
P,la){this.so=u;this.ia=P;this.la=la}hMa(u,P,la,Ba,Sa){try{const Bc=document.createElement("div");Bc.id="SummaryPageOverlay";Bc.style.width="100%";Bc.style.height="100%";Bc.style.zIndex="999";Bc.style.display="flex";Bc.style.flexDirection="column";Bc.style.justifyContent="center";Bc.style.position="absolute";var pb=document.getElementById("SummaryPageOverlay");pb&&document.body.removeChild(pb);document.body.insertBefore(Bc,document.body.firstChild);const Yc=Bc.parentNode;Be.a.addHandler(Yc,Ca.a.Bf,
Object(z.a)(this,this.Y$g,"onParentNodeKeyDownHandler"));var Vb=u.thumbIndices;if(Vb){pb={};let Uf=0;const Ef=this.Gsj(Vb);for(let Oh=0;Oh<Vb.length;Oh++)pb[Vb[Oh].toString()]=Ef[Oh],Ef[Oh]||Uf++;L.a.J(42320001,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: number of slide thumbs requested = {0}, number of slides not found in cache = {1}",Vb.length,Uf);u.slideImageSrcs=pb}else u.slideImageSrcs={},L.a.J(594068941,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: no slide thumbs object from Rehearsal");
const gd=v.AFrameworkApplication.iF;gd||L.a.J(557424734,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Feedback card is dsiabled");la||(la=Hr(this.la,this.la.yya));Vb={};const Td=cd.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()).WACSessionID;Vb.fFeedbackCardEnabled=this.la.SOk&&gd;Vb.fShowFeedbackButton=gd;Vb.fMonotoneEnabled=this.la.gPe&&Mn(la,bf.QIe);Vb.fGrammarEnabled=this.la.UPe&&Mn(la,bf.Fee);Vb.fFillersCardEnabled=Mn(la,bf.l7d);Vb.locale=this.la.yya;Vb.fPronunciationCardEnabled=
this.la.pptRehearsalPronunciationEnabled&&Mn(la,bf.xRe);Vb.fCrutchWordCardEnabled=this.la.pptRehearsalCrutchWordsEnabled&&Mn(la,bf.M1d);Vb.fVisionEnabled=P&&this.la.JRk&&this.la.pptRehearsalVisionEnabled;const Re=Xq(this.la,this.la.yya);lb.a.Xa(Re)||(Vb.fPacingGaugeRange=Re);lb.a.Xa(Td)||(Vb.clientSessionId=Td);this.la.tKb&&(Vb.rehearsalOptOutFeatures=Ba);(new rehearsalSummaryPage.RehearsalSummaryPageController(Bc,u,()=>{L.a.J(51144073,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Try Again button clicked.");
Sa&&Sa();this.ia&&(Bc.parentNode.removeChild(Bc),this.ia.Ka(tb.a.wga,2,{entryPoint:3}))},()=>{Sa&&Sa();Be.a.removeHandler(Yc,Ca.a.Bf,Object(z.a)(this,this.Y$g,"onParentNodeKeyDownHandler"))},this.la.podsWebServiceBase,decodeURIComponent(this.la.zld),()=>{this.Mvl()},Vb,Ir(this.la.pptEditorSpeechHandlerBaseUri),"Web",()=>{this.fvl()})).renderSummaryPage()}catch(Bc){L.a.J(51144075,817,10,"RehearsalSummaryPageHelper::ShowRehearsalSummary Exception while generating summary page: {0}",Bc.toString())}}Y$g(u){"MainApp"===
u.target.id&&(u.preventDefault(),u.stopPropagation())}fvl(){L.a.J(556012420,817,50,"RehearsalSummaryPageHelper::ShowCoachSettingsTaskPane: Rehearsal opt out card clicked.");this.ia&&this.la.tKb&&this.ia.Ka(tb.a.rud,2,null)}Mvl(){L.a.J(51144077,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Feedback button clicked.");this.ia&&(this.la.$Qk?this.ia.Ka(tb.a.$mh,2,null):this.ia.Ka(G.a.giveFeedback,2,!1))}Gsj(u){const P=Array(u.length);if(!this.so)return P;const la=this.so.IL(),Ba=this.so.vUa();
for(let Sa=0;Sa<u.length;Sa++){const pb=Ba[la[u[Sa]].sid.toString()];pb&&pb.thumbnailImage.length&&(P[Sa]=pb.thumbnailImage)}return P}}Object(r.a)(wp,"RehearsalSummaryPageHelper",null,[]);class Yq{constructor(u,P,la,Ba,Sa){this.CXa=!1;this.xa=new Si.a;this.ia=u;this.Y8c=new wp(P,this.ia,Ba);this.zCe=la;this.Ndd=Sa}vb(){this.ia.ya(tb.a.hMa,ib.a.application,Object(z.a)(this,this.rxl,"showSummaryPage"));this.ia.ya(tb.a.$mh,ib.a.application,Object(z.a)(this,this.Uvl,"showFloodgateSurvey"))}hMa(u,P,la,
Ba,Sa){this.Y8c.hMa(u,P,la,Ba,Sa)}rxl(u,P,la,Ba,Sa){switch(la){case 2:return this.Y8c.hMa(Sa,!1,null,null,null),32;case 1:if(this.CXa)return 32;break;default:L.a.J(509117593,822,10,"ShowSummaryPage: Unimplemented action behavior")}return 8}Uvl(u,P,la){switch(la){case 2:return this.Ndd.execute(Ba=>{Ba.Ulb("PPTRehearsePresentationSurvey","PowerPointRehearsePresentationSurveyEnabled")}),32;case 1:if(this.CXa)return 32;break;default:L.a.J(509117592,822,10,"ShowFloodgateSurvey: Unimplemented action behavior")}return 8}odc(){const u=
Date.now();this.zCe("rehearsalSummaryPage").then(()=>{const P=v.AFrameworkApplication.fa.Ha("RehearsalSummaryPageCssUrl"),la=document.createElement("link");la.setAttribute("rel","stylesheet");la.setAttribute("type","text/css");la.setAttribute("href",P);$addHandler(la,"load",()=>{this.CXa=!0;this.xa.raiseEvent("OnRehearsalSummaryResourcesLoaded",new Sys.EventArgs);L.a.J(509117591,817,50,"RehearsalSummaryPage: Loading time: {0}ms",Date.now()-u)});document.body.appendChild(la);return null})}Xgi(u){this.xa.addHandler("OnRehearsalSummaryResourcesLoaded",
u)}o8k(u){this.xa.removeHandler("OnRehearsalSummaryResourcesLoaded",u)}}Object(r.a)(Yq,"RehearsalSummaryPageActor",null,[744]);class pq{constructor(u,P,la,Ba,Sa){this.irg=this.Jmg=!1;this.ia=u;this.Ea=P;this.KEe=la;this.mjc=Ba;this.mxa=Sa;this.KEe.execute(pb=>{pb.jgi(Object(z.a)(this,this.s8g,"onCoachResourcesLoaded"))});this.mjc.execute(pb=>{pb.Xgi(Object(z.a)(this,this.yah,"onRehearsalSummaryResourcesLoaded"))})}dispose(){this.KEe.instance&&this.KEe.instance.P7k(Object(z.a)(this,this.s8g,"onCoachResourcesLoaded"));
this.mjc.instance&&this.mjc.instance.o8k(Object(z.a)(this,this.yah,"onRehearsalSummaryResourcesLoaded"))}s8g(){this.Jmg=!0;this.VJh()}yah(){this.irg=!0;this.VJh()}VJh(){this.Jmg&&this.irg&&ac.a.get_instance().Mj(10,null).continueWith(()=>{if(this.Ea.nBh&&this.Ea.FRk){const u=document.getElementById("rehearsal-loading-dialog-modal");u?(u.style.display="none",L.a.J(560468302,822,50,"Rehearsal Trigger: Hide rehearsal loading dialog")):L.a.J(560468303,822,10,"Rehearsal Trigger: Rehearsal deep link session triggered with no loading dialog element")}if(32===
this.ia.processAction(tb.a.wga,1))if(this.Ea.nBh)this.ia.Ka(tb.a.wga,2,{entryPoint:5});else if(!this.Ea.QL&&this.Ea.Wgh&&this.Ea.gRk)try{this.mxa.continueWith(()=>{this.mxa.result.logActivity("HasCoachInPresentDropDownSeen","PPTCoachInPresentDropDownTeachingUIEnabled")}),L.a.J(590120386,822,50,"Rehearsal Trigger: Teaching UI triggered for Coach in Present Drop Down")}catch(u){L.a.J(590120384,822,10,"Rehearsal Trigger: Exception thrown when trying to trigger teaching UI. Exception: {0}",u)}})}}Object(r.a)(pq,
"RehearsalTrigger",null,[747]);class xp{constructor(){this.K=this.By=null}get name(){return"PowerPointWebEditor.Rehearsal"}TFi(){this.K.register(744,"PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").ma().oa(()=>new Yq(v.AFrameworkApplication.Ra,this.K.resolve("PowerPointWebEditor.IThumbnailDataStoreManager"),lg.a(this.K),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.Ia("Common.ISystemInitiatedFeedback")));this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").vb()}Yb(u){this.K=
u;this.K.Ia("PowerPointWebEditor.IThumbnailDataStoreManager").execute(()=>{this.TFi()});if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorRehearsalSpeechClientEnabled){this.K.register(745,"PowerPointWebEditor.Rehearsal.IRehearsalFeedbackSettings").ma().oa(()=>new gm(v.AFrameworkApplication.Me,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.K.resolve("Common.IActionManagerExtended")));this.By=this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalFeedbackSettings");
const P=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.K.register(746,"PowerPointWebEditor.Rehearsal.IRehearsalManager").ma().oa(()=>new sk(v.AFrameworkApplication.Ra,P,this.K.resolve("Common.IDynamicScriptLoaderProvider"),this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
w.a.instance.Ia("PowerPointWebEditor.ISlideShowVoiceNotification"),w.a.instance.Ia("PowerPointWebEditor.ISlideshowToolbar"),w.a.instance.Ia("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor"),this.By,this.K.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),this.K.resolve("PowerPointWebEditor.IRibbonUser")));this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalManager").vb();this.K.register(747,"PowerPointWebEditor.Rehearsal.IRehearsalTrigger").ma().oa(()=>new pq(v.AFrameworkApplication.Ra,
this.K.resolve("PowerPointWebEditor.IApplicationSettings"),w.a.instance.Ia("PowerPointWebEditor.Rehearsal.IRehearsalManager"),w.a.instance.Ia("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor"),Qi.a.Lt(w.a.instance.Ia("Common.ISystemInitiatedFeedback"))));this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalTrigger")}}init(){v.AFrameworkApplication.fa.ff(Object(z.a)(this,this.en,"onFullAppSettingsReady"))}en(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").Bcc&&ac.a.get_instance().Mj(7,
()=>{this.K.Ia("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").execute(()=>{this.initialize()})})}initialize(){this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").odc();this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorRehearsalSpeechClientEnabled&&this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalManager").odc();if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").tKb){const u=new So(lg.a(this.K),this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.By,this.K.resolve("PowerPointWebEditor.IApplicationSettings"));u.vb();u.pe();this.By.sPj()}}dispose(){}static main(){m.a.instance.Ac(new xp)}}Object(r.a)(xp,"PPTWebEditorRehearsalPackage",null,[2,3]);class Ql{static K$a(u){try{return caches.open(Ql.fcf).then(P=>P.match(u))}catch(P){return Promise.reject(null)}}static JTa(u,P){try{return Ql.K$a(u).then(la=>la&&Number.parseInvariant(la.headers.get("cachedTime"))>Date.now()-P?Promise.resolve(la.text().toLocaleString()):
Promise.reject("Not found")).catch(()=>Promise.reject("Cache returned undefined"))}catch(la){return Promise.reject(null)}}static store(u,P){try{return caches.open(Ql.fcf).then(la=>{la.put(u,P).then(()=>!0);return!1}).catch(()=>Promise.resolve(!1))}catch(la){return Promise.resolve(!0)}}static JBl(u,P){const la={};la.body=P;const Ba={};Ba.cachedTime=Date.now().toString();la.headers=Ba;P=new Response(P,la);Ql.store(u,P).then(()=>!0)}}Ql.fcf="ConsentState";Object(r.a)(Ql,"CacheManager",null,[]);class Mr{constructor(){this.message=
null;this.Iv=0}}Object(r.a)(Mr,"HttpRequstToPromiseRejectData",null,[]);class hl{constructor(u){this.uca=u}T9(u,P,la,Ba,Sa,pb){B.a.sendTelemetryEvent(Object.assign(new N.a,{name:"Office.Online."+u,dataFields:[Object.assign(new M.a,{name:"EventMessage",string:P}),Object.assign(new M.a,{name:"FormFactor",string:this.uca.formFactor}),Object.assign(new M.a,{name:"CorrelationId",string:this.uca.correlationId}),Object.assign(new M.a,{name:"AccountType",string:this.uca.accountType}),Object.assign(new M.a,
{name:"OSVersion",string:this.uca.osVersion}),Object.assign(new M.a,{name:"AppId",string:this.uca.appId}),Object.assign(new M.a,{name:"ConsentSurface",string:"AppStart"}),Object.assign(new M.a,{name:"ConsentLanguage",string:this.uca.consentLanguage}),Object.assign(new M.a,{name:"EventCode",string:la}),Object.assign(new M.a,{name:"Region",string:this.uca.region}),Object.assign(new M.a,{name:"ModelType",string:Ba}),Object.assign(new M.a,{name:"ModelId",string:Sa}),Object.assign(new M.a,{name:"Platform",
string:this.uca.os}),Object.assign(new M.a,{name:"ReConsentReason",string:""}),Object.assign(new M.a,{name:"ConsentType",string:pb})]}))}}Object(r.a)(hl,"TelemetryLogger",null,[]);class zt{constructor(u,P,la){this.aWh="https://consent.config.office.com/consentcheckin/v1.0/consents";this.Oa=u;this.hi=P;this.tQa=la;this.US=new hl(la)}m3b(u,P){return new Promise((la,Ba)=>{const Sa=this.Oa.wc("UCNoticeCheckinCallTimeoutMs",5E3);let pb=this.Oa.Ha("UCNoticeCheckinStateUrl");pb&&pb.length||(pb=this.aWh);
this.hi.iW(pb,1,null,this.pae(u),null,0,Vb=>{try{if(void 0===Vb||null===Vb||void 0===Vb.data||null===Vb.data||void 0===Vb.data.ee||null===Vb.data.ee){this.US.T9("UnifiedConsent.ConsentGetFailed","CheckInApi : Invalid response","711",null,null,null);let Yc=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}","UnifiedConsent.ConsentGetFailed");Ba(this.Tka(Yc,Vb))}else if(Vb.data.Ke!==xh.a.mx){this.US.T9("UnifiedConsent.ConsentGetFailed",
"CheckInApi : HTTP failure",Vb.data.Ke.toString(),null,null,null);let Yc=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",Vb.data.Ke,"UnifiedConsent.ConsentGetFailed");Ba(this.Tka(Yc,Vb))}else{var Bc=P(Vb.data.ee);if(Bc)la(Bc);else{this.US.T9("UnifiedConsent.ConsentGetFailed","CheckInApi : Consent values are empty","712",null,null,null);let Yc=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",
"UnifiedConsent.ConsentGetFailed");Ba(this.Tka(Yc,Vb))}}}catch(Yc){this.US.T9("UnifiedConsent.ConsentGetFailed","CheckInApi : Unexpected failure","713",null,null,null),Bc=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",Yc,"UnifiedConsent.ConsentGetFailed"),Ba(this.Tka(Bc,Vb))}},Vb=>{this.US.T9("UnifiedConsent.ConsentGetFailed","CheckInApi : Error in service call ",Vb.data.Ke.toString(),null,null,null);const Bc=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, request - {1}",
Vb.data.Ke,"UnifiedConsent.ConsentGetFailed");Ba(this.Tka(Bc,Vb))},null,void 0,void 0,2500,Sa)})}Tka(u,P){const la=new Mr;la.message=u;la.Iv=P&&P.data?P.data.Ke:-1;return la}pae(u){const P={};P["Accept-Language"]=this.tQa.consentLanguage;P.consentsurface="AppStart";P.platform="Web";P.formfactor=qd.a.pbc?"Mobile":"Desktop";P["x-Cid"]=this.tQa.correlationId;P.Authorization="Bearer "+u;return P}}Object(r.a)(zt,"HttpRequestToPromiseUtility",null,[]);class hm{constructor(){this.accountType="MSA";this.modelType=
null;this.appEnv=0;this.emailId=this.deviceId=this.consentLanguage=this.appVersion=this.appId=this.appName=null;this.formFactor="Unknown";this.token=this.region=this.osVersion=this.os=null;this.useCache=!1;this.correlationId=this.userId=null;this.isDarkMode=!1}}Object(r.a)(hm,"WebSdkAdapterProps",null,[]);class im{constructor(u,P,la,Ba){this.kif=this.KAa=this.pia=this.kca=null;this.job=Ba;this.Oa=u;this.BUh=la;this.hi=P;this.tQa=this.aVc();this.US=new hl(this.tQa)}ivl(){"MSA"===(this.Oa.Ha("HostAuthType")||
"").toUpperCase()&&Ql.JTa(this.tQa.userId,this.Oa.wc("UCNoticeCheckinCacheTimeMs",862E5)).then(()=>{this.US.T9(im.f5a,"CacheFound","701",this.kca,this.pia,this.KAa);return{}}).catch(()=>{this.BUh.execute(u=>{u.gI("Consent",im.I8h).then(P=>{P.IsSuccess?(this.US.T9(im.f5a,"CheckInTokenSuccess","702",this.kca,this.pia,this.KAa),this.odj(P.Token).then(la=>{this.Alj(la);this.kca&&""!==this.kca&&u.gI("Consent",im.K8h).then(Ba=>{Ba.IsSuccess?(this.US.T9(im.f5a,"WebTokenSuccess","703",this.kca,this.pia,this.KAa),
this.Ewl(Ba,this.kca)):this.US.T9(im.f5a,"WebTokenFailed : "+Ba.ErrorMessage,Ba.ErrorCode,this.kca,this.pia,this.KAa);return{}});return{}})):this.US.T9(im.f5a,"CheckInTokenFailed : "+P.ErrorMessage,P.ErrorCode,this.kca,this.pia,this.KAa);return{}})})})}odj(u){this.kif=new zt(this.Oa,this.hi,this.tQa);return this.kif.m3b(u,Object(z.a)(this,this.tMk,"parseConsentCheckinState")).then(P=>Promise.resolve(P),P=>Promise.reject("Error while getting result"+P))}tMk(u){if(void 0===u||null===u)return this.US.T9(im.f5a,
"Checkin response undefined or null","705",this.kca,this.pia,this.KAa),null;try{let P;({Nu:P}=cd.d(u));return P}catch(P){this.US.T9(im.f5a,"Checkin response parse error : "+P.message,"706",this.kca,this.pia,this.KAa)}return null}Alj(u){for(const P of u.consentValues)if(P.needConsent&&!P.maxPromptsReached){this.pia=P.id;this.KAa=P.consentType;this.kca=P.modelType;return}Ql.JBl(this.tQa.userId,cd.c(u))}Ewl(u,P){if(td.a("showConsentNotice")){const la=document.createElement("div");document.body.appendChild(la);
appChrome.api.showConsentNotice(this.Gfj(u.Token,P),la)}else this.US.T9(im.p1h,"1JS : ShowConsentNotice API not found","704",this.kca,this.pia,this.KAa)}Gfj(u,P){const la=this.tQa;la.token=u;la.modelType=P;return la}aVc(){const u=this.Uhe(this.Oa.Ha("SessionStartInfoJson"));return Object.assign(new hm,{emailId:this.Oa.Ha("UserPrincipalName"),userId:this.Oa.Ha("LoggableUserId"),accountType:"AAD"===(this.Oa.Ha("HostAuthType")||"").toUpperCase()?"AAD":"MSA",appId:this.Oa.Ha("OfficeApplicationId"),appVersion:this.Oa.Ha("appVersion"),
appName:"Application"in u?u.Application:"",appEnv:this.job,consentLanguage:this.Oa.Ha("UICulture")||"en-US",formFactor:qd.a.pbc?"Mobile":"Desktop",os:"Os"in u?u.Os:"",osVersion:"OsVersion"in u?u.OsVersion:"",region:this.Oa.Ha("region"),correlationId:ua.a.create().toString(),isDarkMode:this.Oa.ka("DarkModeIsOn"),useCache:!0})}Uhe(u){let P={};try{P=cd.b(u)}catch(la){}return P}}im.K8h="https://consentservice.microsoft.com/web";im.I8h="https://consentservice.microsoft.com/checkin";im.p1h="UnifiedConsent.ConsentGetFailed";
im.f5a="UnifiedConsent.AuthTokenStatus";Object(r.a)(im,"ConsentNoticeManager",null,[791]);class Tp{constructor(){this.Da=null}get name(){return"Common.App.ConsentNoticeDialog"}Yb(u){this.Da=u;u.register(im,"Common.App.ConsentNoticeDialog.ConsentNoticeManager").as("Common.App.ConsentNoticeDialog.IConsentNoticeManager").ma().oa(()=>new im(v.AFrameworkApplication.fa,v.AFrameworkApplication.Me,u.Ia("Common.App.OAuth.IOAuthManager"),v.AFrameworkApplication.WSa))}init(){this.Da.resolve("Common.App.ConsentNoticeDialog.IConsentNoticeManager")}dispose(){}static main(){m.a.instance.Ac(new Tp)}}
Object(r.a)(Tp,"ConsentNoticeDialogPackage",null,[2,3]);var At=d(13);Type.registerNamespace("Box4.Media");Type.registerNamespace("Common.App.VersionHistory");Type.registerNamespace("PPTe");Type.registerNamespace("PowerPointLive");Type.registerNamespace("PowerPointVersionHistory");Type.registerNamespace("PowerPointWeb");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.Accessibility");Type.registerNamespace("PowerPointWebEditor.AgendaConverter");Type.registerNamespace("PowerPointWebEditor.Designer");
Type.registerNamespace("PowerPointWebEditor.ImageDescription");Type.registerNamespace("PowerPointWebEditor.Infrared");Type.registerNamespace("PowerPointWebEditor.Live");Type.registerNamespace("PowerPointWebEditor.PenMinutes");Type.registerNamespace("PowerPointWebEditor.PresentToTeams");Type.registerNamespace("PowerPointWebEditor.Rehearsal");Type.registerNamespace("PowerPointWebEditor.ReplaceObject");Type.registerNamespace("PowerPointWebEditor.StreamVideoPrefetchOrchestratorUtility");Type.registerNamespace("PowerPointWebEditor.Text");
Type.registerNamespace("PowerPointWebEditor.VersionHistory");Object(At.c)("Chronos2");Type.registerNamespace("Common.App.AccessibilityChecker");fb.main();Jb.main();Ze.main();Type.registerNamespace("Common.App.AddinCommands");Type.registerNamespace("Common.App.AccessibilitySettings");Pd.main();Type.registerNamespace("Common.App.DirectPrint");m.a.instance.Ac(new id);Type.registerNamespace("Common.App.DisplayEnvironmentName");de.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.InProductMessaging");
ne.main();Type.registerNamespace("Common.App.NewAndOpen.UX");m.a.instance.Ac(new ah);Type.registerNamespace("Common.App.OneDriveFilePickerApi");dg.main();Type.registerNamespace("Common.App.PenMinutesManager");ij.main();Type.registerNamespace("Common.App.SaveAsToHost");yi.main();Type.registerNamespace("Common.App.SaveToSharePoint");Ih.main();Type.registerNamespace("Common.App.SaveToCloudStorage");ed.main();Type.registerNamespace("Common.App.SaveACopy");Mb.main();Type.registerNamespace("Common.App.PhoneLink");
ce.main();Type.registerNamespace("Common.App.SharedFilePicker");rd.main();Type.registerNamespace("Common.Search");Type.registerNamespace("Common.App.SearchOAuthManager");Fe.main();Type.registerNamespace("Common.App.WopiIdentity");kk.main();Type.registerNamespace("Common.App.AppsForOfficeOauth");Type.registerNamespace("Common.App.SmartLookup");Type.registerNamespace("Common.App.ConsentNoticeDialog");Tp.main();ae.main();Wn.main();nk.main();zo.main();Ae.main();jp.main();m.a.instance.Ac(xc.a(new Cr,0));
mq.main();Type.registerNamespace("Common.App.LivePersonaUtils");Fr.main();xp.main();Object(At.b)("Chronos2")},344:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}h.none=null;h.tCi="CoAuth";h.Yge="IdeasPaneClosed";h.ixk="MultiSlidesSelected";h.xkb="Retrigger";h.Lrd="SessionEnded";h.Eil="SessionRehydrated";h.slideNavigation="SlideNavigation";h.sPb="SuggestionPaneClosed";h.qvd="SuggestionsLoadingTimeout";h.noSuggestion="NoSuggestion";h.typing="Typing";h.GRb="WebActionId:";h.Y4k="Rehydrated";
h.XTf="DisallowedRequest";h.fLf="CloseSecondPane";h.yJk="OpenEditorPane";Object(K.a)(h,"DesignerResetReason",null,[])},345:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}h.invalid="Invalid";h.success="Success";h.error="Error";h.pending="Pending";h.GJa="NoResult";Object(K.a)(h,"ProviderResultStatus",null,[])},387:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);var h;(function(e){e[e.notSupported=-1]="notSupported";e[e.OMEX=0]="OMEX";e[e.spCatalog=1]="spCatalog";e[e.spApp=2]=
"spApp";e[e.fileSystem=3]="fileSystem";e[e.exchange=4]="exchange";e[e.oneDrive=5]="oneDrive";e[e.registry=6]="registry";e[e.inMemory=7]="inMemory";e[e.uploadFileDevCatalog=8]="uploadFileDevCatalog";e[e.hardCodedPreinstall=9]="hardCodedPreinstall";e[e.privateCatalog=10]="privateCatalog";e[e.wopiCatalog=16]="wopiCatalog"})(h||(h={}));Object(K.b)("AddinProviderType",h)},397:function(K,U,d){K=d(0);class h{static emj(){return h._nextEventReceiverId++}}h._nextEventReceiverId=0;Object(K.a)(h,"EventReceiverIdCounter",
null,[]);d.d(U,"a",function(){return e});class e{constructor(r,m){this.aYh=r;this._id=h.emj();this.Z5h=m}get id(){return this._id}notify(r,m){this.Z5h(r,m)}Uda(r,m){return this.aYh.UVk(r,m?this:null)}}Object(K.a)(e,"EventReceiver",null,[782])},452:function(K,U,d){d.d(U,"a",function(){return r});K=d(0);var h=d(392),e=d(194);class r{static YAh(m){return parseInt(r.hnb(e.a.GTd,m)||"-1")<=(new Date).getTime()}static e9d(m){return parseInt(r.hnb(e.a.B7a,m)||"-1")}static Dfe(m){return Boolean.parse(r.hnb(e.a.Rsb,
m)||"false")}static hnb(m,n){let z=null;try{const v=r.kab();if(void 0!==v&&v){const x=e.a.WTc(m)+n;z=v.getItem(x)}else h.ULS.sendTraceTag(42074645,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(v){h.ULS.sendTraceTag(42074646,220,10,"Failed to get AddinCommands Cache {0} for ProviderType {1}.",m,n)}return z}static lnb(m,n,z){try{const v=r.kab();if(void 0!==v&&v){const x=e.a.WTc(m)+z;v.setItem(x,n)}else h.ULS.sendTraceTag(42074647,220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(v){h.ULS.sendTraceTag(42074648,
220,10,"Failed to set AddinCommands Cache {0} for ProviderType {1}.",m,z)}}static kab(){if(!r.$Ua)return null;let m=null;try{m=localStorage}catch(n){r.$Ua=!1,m=null}return m}}r.$Ua=!0;Object(K.a)(r,"AddinUtil",null,[])},548:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);var h;(function(e){e[e.notSupported=0]="notSupported";e[e.launchByLocalCacheInitializer=1]="launchByLocalCacheInitializer";e[e.launchByAnonymousApiInitializer=2]="launchByAnonymousApiInitializer";e[e.launchByInsertion=3]="launchByInsertion";
e[e.launchByRefresh=4]="launchByRefresh";e[e.launchByLastUpdateInitializer=5]="launchByLastUpdateInitializer";e[e.launchByDynamicCall=6]="launchByDynamicCall"})(h||(h={}));Object(K.b)("AddinCommandsLaunchOperationType",h)},549:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}Object(K.a)(h,"OnlineMediaSearchResult",null,[])},550:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(e,r){this.wmk=e;this.lpk=r}get e2c(){return this.wmk}get abl(){return this.lpk}}Object(K.a)(h,
"ReportSuggestionSessionActionData",null,[])},551:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}h.cWf="Provider.UCI.Editor";h.WVf="EntityGroup.UCI.Editor";h.GDh="Provider.Designer.Slide";h.FDh="EntityGroup.Designer.Slide.Suggestion";h.QDh="Provider.Designer.TextToSmartArt";h.PDh="EntityGroup.Designer.TextToSmartArt.Suggestion";Object(K.a)(h,"InfraredConstant",null,[])},713:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{}Object(K.a)(h,"ProviderActionInfo",null,[])},
714:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.Label=this.CorrelationId=null;this.ShapeId=this.ReplaceObjectType=0;this.SmartArtSubNodeId=null;this.SuggestionSid=0}}Object(K.a)(h,"ReplaceObjectSuggestionApplyInfo",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19809348/wdjs/ppteditDS.chronos2.js.map