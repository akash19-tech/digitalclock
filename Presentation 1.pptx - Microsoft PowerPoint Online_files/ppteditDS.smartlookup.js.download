'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[13],{1292:function(K,U,d){d.r(U);var h=d(0),e=d(1243),r=d(1305),m=d(27),n=d(270),z=d(95),v=d(71),x=d(18);class B{constructor(Cb){Cb.Ia("Common.App.SearchCommon.SearchHostRuntime").execute(()=>{})}}Object(h.a)(B,"DocumentContentExtractionManager",null,[847]);var D=d(392),w=d(7),J=d(1095);class G{}G.izl="mso_smartLookup";G.channelId="SmartLookup";G.hzl="https://uciserviceintcdnwus.blob.core.windows.net/mirrored/smartlookup/";
G.XDh="https://uci.edog.cdn.office.net/mirrored/smartlookup/";G.YDh="https://uci.cdn.office.net/mirrored/smartlookup/";G.gzl="https://hedwigtestserver.blob.core.windows.net/builds/";G.fzl="http://localhost:8080/";G.uuc="current";G.WDh="next";G.kLk=2;G.Dkd=CommonUIStrings.L_SmartLookupPaneTitle;G.fZ="InsightsTaskPane";G.width=400;G.SHh="appCorrelationId";G.THh="message";Object(h.a)(G,"InsightsConstants",null,[]);var M=d(953),N=d(170);class R{}Object(h.a)(R,"ActivityContractInfo",null,[]);class C{}
Object(h.a)(C,"BrowserPaneDataField",null,[]);class O{}Object(h.a)(O,"BrowserPaneTelemetryEvent",null,[]);var S=d(142),T=d(56),ca=d(184),L=d(171);class da{static It(Cb,oc){const vc=new O;vc.eventName="Diagnostics";vc.isActivity=!1;vc.activityContract=Object.assign(new R,{success:!0});const nd=[],id=new C;id.name="Message";id.dataType=0;id.value=Cb;Cb=new C;Cb.name="Level";Cb.dataType=0;Cb.value=da.akj(oc);Array.add(nd,id);Array.add(nd,Cb);vc.dataFields=nd;da.sendTelemetryEvent(vc)}static Brd(Cb,oc){const vc=
new O;vc.eventName=Cb;vc.isActivity=!1;vc.activityContract=Object.assign(new R,{success:!0});Cb=[];const nd=new C;nd.name="AppCorrelationId";nd.dataType=0;nd.value=oc;Array.add(Cb,nd);vc.dataFields=Cb;da.sendTelemetryEvent(vc)}static thl(Cb,oc,vc,nd,id,Nd){const Ce=new O;Ce.eventName="LaunchPaneWithError";Ce.isActivity=!1;Ce.activityContract=Object.assign(new R,{success:!0});const af=[],de=new C;de.name="IsNetworkConnected";de.dataType=0;de.value=Cb?"true":"false";Cb=new C;Cb.name="IsHostruntimeAvailable";
Cb.dataType=0;Cb.value=oc?"true":"false";oc=new C;oc.name="EntryPoint";oc.dataType=0;oc.value=vc;vc=new C;vc.name="RuntimeVersion";vc.dataType=0;vc.value=nd;nd=new C;nd.name="IsFirstRelease";nd.dataType=1;nd.value=id?"true":"false";id=new C;id.name="IsZeroTerm";id.dataType=1;id.value=Nd?"true":"false";Nd=new C;Nd.name="IsClientSideRendering";Nd.dataType=1;Nd.value="false";Array.add(af,de);Array.add(af,oc);Array.add(af,Cb);Array.add(af,vc);Array.add(af,nd);Array.add(af,id);Array.add(af,Nd);Ce.dataFields=
af;da.sendTelemetryEvent(Ce)}static UYe(Cb,oc,vc){const nd=new O;nd.eventName="CDNDownloadLatency";nd.isActivity=!0;nd.activityContract=Object.assign(new R,{duration:vc,success:!0});vc=[];const id=new C;id.name="CDNHostname";id.dataType=0;id.value=Cb;Cb=new C;Cb.name="Filename";Cb.dataType=0;Cb.value=oc;Array.add(vc,id);Array.add(vc,Cb);nd.dataFields=vc;da.sendTelemetryEvent(nd,1)}static wsc(Cb,oc,vc,nd,id,Nd,Ce,af){const de=new O;de.eventName="LaunchPane";de.isActivity=!0;de.activityContract=Object.assign(new R,
{duration:oc,success:!0});oc=[];const $f=new C;$f.name="AppCorrelationId";$f.dataType=0;$f.value=Cb;Cb=new C;Cb.name="EntryPoint";Cb.dataType=0;Cb.value=vc;vc=new C;vc.name="IsServerSideRendering";vc.dataType=1;vc.value="true";const ge=new C;ge.name="UxVersion";ge.dataType=0;ge.value=nd;nd=new C;nd.name="FeatureGates";nd.dataType=0;nd.value=id;id=new C;id.name="IsFirstRelease";id.dataType=1;id.value=Nd?"true":"false";Nd=new C;Nd.name="IsZeroTerm";Nd.dataType=1;Nd.value=Ce?"true":"false";Ce=new C;
Ce.name="IsClientSideRendering";Ce.dataType=1;Ce.value=af?"true":"false";Array.add(oc,$f);Array.add(oc,Cb);Array.add(oc,vc);Array.add(oc,ge);Array.add(oc,nd);Array.add(oc,id);Array.add(oc,Nd);Array.add(oc,Ce);de.dataFields=oc;da.sendTelemetryEvent(de)}static sendTelemetryEvent(Cb,oc=2){if(Cb.isFeedbackActivity)da.dbk(Cb.eventName);else{var vc=-1<Cb.eventName.indexOf(da.RHh)?Cb.eventName:da.RHh+Cb.eventName,nd=da.Oej(Cb.dataFields);Cb.isActivity?(Cb=Object.assign(new ca.a,{name:vc,samplingPolicy:oc,
dataFields:nd,succeeded:Cb.activityContract.success,durationMs:Cb.activityContract.duration}),S.a.sendActivityEvent(Cb)):(Cb=Object.assign(new L.a,{name:vc,samplingPolicy:oc,dataFields:nd}),S.a.sendTelemetryEvent(Cb))}}static akj(Cb){switch(Cb){case 10:return"Error";case 15:return"Warning";default:return"Info"}}static Oej(Cb){const oc=[];if(Cb&&0<Cb.length)for(const vc of Cb)(Cb=N.a.E_(vc.name,vc.value,da.wIi(vc.dataType)))&&Array.add(oc,Cb);return oc}static wIi(Cb){switch(Cb){case 0:return 2;case 1:return 1;
case 2:return 3;case 3:return 4;default:return 0}}static dbk(Cb){const oc=T.a.instance.qb("Common.ISystemInitiatedFeedback");oc?oc.logActivity(Cb,null):D.ULS.sendTraceTag(540624772,1303,15,"Failed to resolve ISystemInitiatedFeedback.")}}da.RHh="Office.Insights.SmartLookup.";Object(h.a)(da,"TelemetryUtils",null,[]);var Z=d(547),fa=d(341),aa=d(451),ja=d(203),I=d(36),sa=d(106);class ka{static RQ(Cb,oc,vc,nd,id,Nd){if(1===vc)return ja.SessionStatusManager.instance.Z_?32:8;if(id.value.mul())return da.It("Skipping Serplet launch",
10),32;oc=Nd;if(!oc)return 8;Cb=ka.G$a();if(vc=oc.CommandValueId)try{oc=I.a(vc)}catch(Ce){return D.ULS.sendTraceTag(594044173,1313,15,"SmartLookup application interface [{0}] is not in proper format",vc),8}vc=oc;oc.selection||(oc.neighborhood?vc=Object.assign(new fa.a,{selection:oc}):(oc=id.value.bab(),vc.selection=Object.assign(new aa.a,{neighborhood:oc.neighborhood,mentionStart:oc.mentionStart,mentionLength:oc.mentionLength})));vc.selection.clientDetectedLanguage=null;return ka.Mwb(Nd,null,vc,Cb,
0,id)}static Mwb(Cb,oc,vc,nd,id,Nd){const Ce={};Ce.controlId=Cb?Cb.SourceControlId:"shortcut";vc&&(Ce.entryPoint=Z.a[vc.entryPoint]);D.ULS.sendTraceTag(594044172,1303,50,ka.Cka("Show insights",nd,Ce));oc?Nd.value.qwl(oc,nd,id):vc&&(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCopilotAddin",!1)?Nd.value.Oul(vc,nd):Nd.value.rwl(vc,nd,id));return 32}static Cka(Cb,oc,vc=null){Cb={["appCorrelationId"]:oc,["message"]:Cb};if(vc)for(let nd in vc)Cb[nd]=vc[nd];return I.c(Cb)}static G$a(){return sa.a.create().toString()}}
Object(h.a)(ka,"InvokingPaneUtils",null,[]);class Ma{}Object(h.a)(Ma,"LaunchDataInDoc",null,[]);class Ea{}Object(h.a)(Ea,"LaunchDataPasteAsSlide",null,[]);class ma{}Object(h.a)(ma,"LaunchDataSlidesCompression",null,[]);var va=d(397),Ca=d(120),oa=d(70),Da=d(300),ta=d(82),ha=d(65),Ha=d(73),bb=d(542),Na=d(37);class Ia{constructor(Cb,oc,vc,nd,id,Nd,Ce,af,de){this.CTb=this.HBc=this.zo=null;this.az=Cb;this.Ca=oc||m.AFrameworkApplication.Ra;this.NK=vc;this.Pd=nd;this.Ckf=af;this.wPa=id;this.Oa=Nd;this.Zd=
Ce;this.VNj();this.aia=new e.a(()=>new va.a(de.value,Object(w.a)(this,this.VEa,"getMoreInfoEventReceived")))}vb(){this.Ca.ya(Na.a.AQj,Ha.a.frame,Object(w.a)(this,this.owl,"showInsights"));this.Ca.ya(Na.a.BQj,Ha.a.frame,Object(w.a)(this,this.pwl,"showInsightsForTellMe"));this.Ca.ya(Na.a.definitions,Ha.a.frame,Object(w.a)(this,this.vvl,"showDefinitions"));this.Ca.ya(Na.a.cSi,Ha.a.frame,Object(w.a)(this,this.wvl,"showDefinitionsForTellMe"));this.Ca.ya(Na.a.b2e,Ha.a.frame,Object(w.a)(this,this.b2e,"showInsightsForSuggestion"));
this.Ckf&&(this.Ca.ya(Na.a.Y_c,Ha.a.frame,Object(w.a)(this,this.RQ,"invokeSmartLookupPane")),this.Ca.ya(Na.a.Wle,Ha.a.frame,Object(w.a)(this,this.Wle,"invokeInDocSerplet")),this.Ca.ya(Na.a.a0c,Ha.a.frame,Object(w.a)(this,this.a0c,"invokeSerpletRibbon")),this.Ca.ya(Na.a.$_c,Ha.a.frame,Object(w.a)(this,this.$_c,"invokeSerpletContextMenu")),this.Ca.ya(Na.a.bme,Ha.a.frame,Object(w.a)(this,this.bme,"invokeSerpletTellMeZeroTerm")),this.Ca.ya(Na.a.ame,Ha.a.frame,Object(w.a)(this,this.ame,"invokeSerpletTellMeNotes")),
this.Ca.ya(Na.a.Vle,Ha.a.frame,Object(w.a)(this,this.Vle,"invokeImageSerpletContextMenu")),this.Ca.ya(Na.a.c0c,Ha.a.frame,Object(w.a)(this,this.c0c,"invokeSynonymsSerpletContextMenu")),this.Ca.ya(Na.a.Tle,Ha.a.frame,Object(w.a)(this,this.Tle,"invokeDictionarySerpletContextMenu")),this.Ca.ya(Na.a.cme,Ha.a.frame,Object(w.a)(this,this.cme,"invokeZeroTermSerpletContextMenu")),this.Ca.ya(Na.a.Sle,Ha.a.frame,Object(w.a)(this,this.Sle,"invokeDefinitionSearchFromFloatie")),this.Ca.ya(Na.a.Z_c,Ha.a.frame,
Object(w.a)(this,this.Z_c,"invokeSerpletBrowseFiles")),this.Ca.ya(Na.a.Xle,Ha.a.frame,Object(w.a)(this,this.Xle,"invokeInDocSerpletWithLaunchData")),this.Ca.ya(Na.a.bTe,Ha.a.frame,Object(w.a)(this,this.bTe,"queryToggleSerplet")),this.Ca.ya(Na.a.$Ze,Ha.a.frame,Object(w.a)(this,this.$Ze,"setInDocSearchParameter")),this.Ca.ya(Na.a.b0c,Ha.a.frame,Object(w.a)(this,this.b0c,"invokeSerpletSlidesCompression")),this.Ca.ya(Na.a.$le,Ha.a.frame,Object(w.a)(this,this.$le,"invokeSerpletPasteAsNewSlide")),m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletAutolaunch",
!1)&&(this.Ca.ya(Na.a.JRj,Ha.a.frame,Object(w.a)(this,this.LRj,"invokeSmartLookupPaneConversations")),this.Ca.ya(Na.a.Rle,Ha.a.frame,Object(w.a)(this,this.Rle,"invokeAutoLaunchSearchRequest"))),this.g3k().continueWith(()=>{m.AFrameworkApplication.Aa&&m.AFrameworkApplication.Aa.updateCommandUI(!0)}))}qxf(){this.Ca.ra(Na.a.rAb,Ha.a.frame,Object(w.a)(this,this.rAb,"invokeFilesSerplet"),4);this.Ca.ra(Na.a.ulg,Ha.a.frame,Object(w.a)(this,this.rAb,"invokeFilesSerplet"),4);this.Ca.ra(Na.a.wlg,Ha.a.frame,
Object(w.a)(this,this.zRj,"invokeLinkFilesSerplet"),4);if(this.Oa.ka("IsTellMeUpSellEnterpriseEnabled")&&this.Oa.ka("SmartLookupTokenPrefetchIsEnabled")){const Cb=ta.a.FOc(0,Object(w.a)(this,this.mhh,"prefetchToken"),0,177);this.Zd.Hb(Cb)}}MSd(){oa.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.AddEmptyFilesActionWhenUnavailable")&&(this.Ca.ya(Na.a.rAb,Ha.a.frame,Object(w.a)(this,this.Ule,"invokeFilesSerpletUnavailable")),this.Ca.ya(Na.a.ulg,Ha.a.frame,Object(w.a)(this,
this.Ule,"invokeFilesSerpletUnavailable")),this.Ca.ya(Na.a.wlg,Ha.a.frame,Object(w.a)(this,this.Ule,"invokeFilesSerpletUnavailable")))}mhh(Cb){D.ULS.sendTraceTag(579352786,1303,50,"SmartLookupFiles: Token prefetch initiated, interval={0}, IsRetry={1}",Cb.interval,!!Cb.data);this.GQb().then(oc=>{let vc=1;if(oc)D.ULS.sendTraceTag(579352787,1303,50,"SmartLookupFiles: Token prefetch succeeded"),this.eZe("SmartLookupFiles: Token prefetch succeeded",!0),oc=6E4*this.Oa.wc("SmartLookupTokenRenewalWaitDurationInMinutes",
30);else{D.ULS.sendTraceTag(579352788,1303,50,"SmartLookupFiles: Token prefetch failed");this.eZe("SmartLookupFiles: Token prefetch failed",!1);vc=parseInt(Cb.data||"1");if(vc>this.Oa.wc("SmartLookupTokenRenewalRetryThreshold",5)){D.ULS.sendTraceTag(577345097,1303,10,"SmartLookupFiles: Token prefetch max retry count reached");this.eZe("SmartLookupFiles: Token prefetch max retry count reached",!1);return}oc=6E4*this.Oa.wc("SmartLookupTokenRetryWaitDurationInMinutes",10);vc++}oc=new ta.a(3,1,oc,Object(w.a)(this,
this.mhh,"prefetchToken"),177);oc.data=vc.toString();this.Zd.Hb(oc)})}eZe(Cb="",oc=!1){this.wPa.execute(vc=>{vc&&vc.hNb("PrefetchToken",oc,0,"SmartLookup",Cb)})}GQb(){return this.wPa?new Promise(Cb=>{this.wPa.execute(oc=>{if(oc){var vc=Date.now();oc.getToken("SmartLookup",this.Oa.Ha("SmartLookupShredderServiceEndpoint")).then(nd=>{Cb(!!nd&&0<nd.length);oc.hNb("TryGetTokenInternal",!!nd&&0<nd.length,Date.now()-vc,"SmartLookup")})}else Cb(!1)})}):Promise.resolve(!1)}g3k(){const Cb=new J.a;if(this.Oa.ka("BrowserSupportsInsightsPaneSSO"))this.qxf(),
Cb.Og(!0);else{if(!this.wPa)return D.ULS.sendTraceTag(587534883,1303,10,"_oAuthManagerFuture not initialized"),Cb.Og(!1),this.MSd(),Cb.task;this.wPa.execute(oc=>{oc?oc.getToken("SmartLookup",this.Oa.Ha("SmartLookupShredderServiceEndpoint")).then(vc=>{D.ULS.sendTraceTag(587534913,1303,15,"Token:{0}",!!vc&&0<vc.length);vc&&0<vc.length?(this.qxf(),Cb.Og(!0)):this.MSd()}):(D.ULS.sendTraceTag(587534912,1303,10,"Unable to resolve oAuthManager"),Cb.Og(!1),this.MSd())})}return Cb.task}owl(Cb,oc,vc,nd,id){if(1===
vc)return m.AFrameworkApplication.Aa&&m.AFrameworkApplication.fa.ka("OneNoteDelayLoadContextActivationManager")&&!m.AFrameworkApplication.N2b?8:this.az.value.dpg()?32:8;Cb=ka.G$a();oc=this.az.value.bab();return this.Ckf?(oc=Object.assign(new aa.a,{neighborhood:oc.neighborhood,mentionStart:oc.mentionStart,mentionLength:oc.mentionLength}),oc=Object.assign(new fa.a,{selection:oc,userIntent:null,entryPoint:0,launchData:Object.assign(new Da.a,{landingTab:"All"})}),ka.Mwb(id,null,oc,Cb,0,this.az)):ka.Mwb(id,
oc,null,Cb,0,this.az)}vvl(Cb,oc,vc,nd,id){if(1===vc)return this.az.value.dpg()?32:8;Cb=ka.G$a();oc=this.az.value.bab();return ka.Mwb(id,oc,null,Cb,1,this.az)}pwl(Cb,oc,vc,nd,id){return 1===vc?32:this.SYf(id,0)}wvl(Cb,oc,vc,nd,id){return 1===vc?32:this.SYf(id,1)}SYf(Cb,oc){const vc=ka.G$a(),nd=Cb.CommandValueId;let id;try{id=I.a(nd)}catch(Nd){return D.ULS.sendTraceTag(6295941,1303,15,ka.Cka(String.format("Insights parameters [{0}] is not in proper format.",nd),vc)),8}return ka.Mwb(Cb,id,null,vc,oc,
this.az)}b2e(Cb,oc,vc,nd,id){if(1===vc)return 32;if(!id)return 8;Cb=id.query?id.query:"";oc=ka.G$a();vc=new M.a;vc.neighborhood=Cb;vc.mentionStart=0;vc.mentionLength=Cb.length;return ka.Mwb(id,vc,null,oc,0,this.az)}zRj(Cb,oc,vc,nd){if(1===vc)return ja.SessionStatusManager.instance.Z_?32:8;const id=m.AFrameworkApplication.fa.ka("InsertFileLinkSerpletIsEnabled"),Nd=this.az.value.ZTa();return this.RQ(Cb,oc,vc,nd,Object.assign(new fa.a,{selection:Object.assign(new aa.a,{neighborhood:Nd.neighborhood,mentionStart:0,
mentionLength:0}),launchData:Object.assign(new Da.a,{landingTab:"File"}),entryPoint:id?32:10}))}rAb(Cb,oc,vc,nd){if(1===vc)return ja.SessionStatusManager.instance.Z_?32:8;const id=m.AFrameworkApplication.fa.ka("InvokeReuseSlidesSerpletIsEnabled"),Nd=this.az.value.ZTa();return this.RQ(Cb,oc,vc,nd,Object.assign(new fa.a,{selection:Object.assign(new aa.a,{neighborhood:Nd.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new Da.a,{landingTab:id?"Slide":"File"}),entryPoint:id?20:10}))}Ule(){return 2}Wle(Cb,
oc,vc,nd,id){if(1===vc)return ja.SessionStatusManager.instance.gla?8:32;const Nd=this.az.value.ZTa();id=void 0===id||null===id?18:19;return this.RQ(Cb,oc,vc,nd,Object.assign(new fa.a,{selection:Object.assign(new aa.a,{neighborhood:Nd.neighborhood,mentionStart:Nd.mentionStart,mentionLength:Nd.mentionLength}),launchData:Object.assign(new Da.a,{landingTab:"Indoc"}),entryPoint:id}))}Xle(Cb,oc,vc,nd,id){id=id.CommandValueId;if(!id||id&&this.CTb&&id.query===this.CTb.query&&id.matchCase===this.CTb.matchCase&&
id.matchWholeWordOnly===this.CTb.matchWholeWordOnly)return 32;const Nd=this.az.value.ZTa();return this.RQ(Cb,oc,vc,nd,Object.assign(new fa.a,{selection:Object.assign(new aa.a,{neighborhood:Nd.neighborhood,mentionStart:Nd.mentionStart,mentionLength:Nd.mentionLength}),launchData:Object.assign(new Da.a,{landingTab:"Indoc",data:Object.assign(new Ma,{type:4,query:id.query,matchCase:id.matchCase,matchWholeWord:id.matchWholeWordOnly})}),entryPoint:18}))}bTe(Cb,oc,vc,nd,id){id&&(id[bb.a.On]=this.az.value.Dbc);
return 32}$Ze(Cb,oc,vc,nd,id){if(Cb=id.CommandValueId)this.CTb=Cb;return 32}LRj(Cb,oc,vc){if(1===vc)return ja.SessionStatusManager.instance.Z_?32:8;Cb=this.az.value.ZTa();Cb=Object.assign(new fa.a,{selection:Object.assign(new aa.a,{neighborhood:Cb.neighborhood,mentionStart:Cb.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new Da.a,{landingTab:"All"})});this.az.value.yre(Cb);return 32}Rle(Cb,oc,vc){if(1===vc)return ja.SessionStatusManager.instance.Z_?32:8;Cb=this.az.value.ZTa();
Cb=Object.assign(new fa.a,{selection:Object.assign(new aa.a,{neighborhood:Cb.neighborhood,mentionStart:Cb.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new Da.a,{landingTab:"All",data:m.AFrameworkApplication.BSa})});oc=ka.G$a();this.az.value.Drd(Cb,oc);return 32}a0c(Cb,oc,vc,nd){if(1===vc)return ja.SessionStatusManager.instance.Z_?32:8;const id=this.az.value.ijj();return this.RQ(Cb,oc,vc,nd,Object.assign(new fa.a,{selection:Object.assign(new aa.a,{neighborhood:id.neighborhood,
mentionStart:id.mentionStart,mentionLength:id.mentionLength}),entryPoint:4,launchData:Object.assign(new Da.a,{landingTab:"All"})}))}$_c(Cb,oc,vc,nd){return this.RQ(Cb,oc,vc,nd,Object.assign(new fa.a,{entryPoint:5,launchData:Object.assign(new Da.a,{landingTab:"All"})}))}bme(Cb,oc,vc,nd){if(1===vc)return ja.SessionStatusManager.instance.Z_?32:8;const id=this.az.value.ZTa();return this.RQ(Cb,oc,vc,nd,Object.assign(new fa.a,{selection:Object.assign(new aa.a,{neighborhood:id.neighborhood,mentionStart:id.mentionStart,
mentionLength:0}),launchData:Object.assign(new Da.a,{landingTab:"All"}),entryPoint:26}))}Tle(Cb,oc,vc,nd){return 1===vc?(Cb=this.az.value.bab())&&0<Cb.mentionLength?32:8:this.RQ(Cb,oc,vc,nd,Object.assign(new fa.a,{entryPoint:22,launchData:Object.assign(new Da.a,{landingTab:"All"})}))}Sle(Cb,oc,vc,nd){return 1===vc?(Cb=this.az.value.bab())&&0<Cb.mentionLength?32:8:this.RQ(Cb,oc,vc,nd,Object.assign(new fa.a,{entryPoint:7,launchData:Object.assign(new Da.a,{landingTab:"All"})}))}Vle(Cb,oc,vc,nd){return this.RQ(Cb,
oc,vc,nd,Object.assign(new fa.a,{launchData:Object.assign(new Da.a,{landingTab:"Image"}),entryPoint:9}))}c0c(Cb,oc,vc,nd){return this.RQ(Cb,oc,vc,nd,Object.assign(new fa.a,{launchData:Object.assign(new Da.a,{landingTab:"All"}),entryPoint:24}))}ame(Cb,oc,vc,nd){return this.RQ(Cb,oc,vc,nd,Object.assign(new fa.a,{launchData:Object.assign(new Da.a,{landingTab:"Notes"}),entryPoint:33}))}cme(Cb,oc,vc,nd){if(1===vc)return ja.SessionStatusManager.instance.Z_?32:8;const id=this.az.value.ZTa();return this.RQ(Cb,
oc,vc,nd,Object.assign(new fa.a,{selection:Object.assign(new aa.a,{neighborhood:id.neighborhood,mentionStart:id.mentionStart,mentionLength:0}),launchData:Object.assign(new Da.a,{landingTab:"All"}),entryPoint:27}))}b0c(Cb,oc,vc,nd,id){if(!id)return 8;const Nd=id.url;id=id.selectedSlideIDs;return this.RQ(Cb,oc,vc,nd,Object.assign(new fa.a,{launchData:Object.assign(new Da.a,{landingTab:"All",data:Object.assign(new ma,{type:6,url:Nd,selectedSlideIDs:id})}),entryPoint:37}))}$le(Cb,oc,vc,nd,id){if(!id)return 8;
const Nd=id.Selection;id=id.CurrentDocTitle;return this.RQ(Cb,oc,vc,nd,Object.assign(new fa.a,{launchData:Object.assign(new Da.a,{landingTab:"All",data:Object.assign(new Ea,{type:5,selection:Nd,currentDocTitle:id})}),entryPoint:36}))}RQ(Cb,oc,vc,nd,id){return ka.RQ(Cb,oc,vc,nd,this.az,id)}Z_c(Cb,oc,vc){if(1===vc)return 32;this.zo||this.aia.value.Uda("Browse File from Search pane",!0);if(!this.HBc||""===this.HBc)return D.ULS.sendTraceTag(558409934,1303,10,"InsightsActor: Failed to get host url to browse files."),
8;ha.a.En(this.HBc,"_blank",void 0,"BrowseFilesFromSearchPane");return 32}VEa(Cb){this.zo||3!==Cb.state||(this.zo=Cb,this.HBc=this.zo.UR)}VNj(){const Cb=this.Pd.Fc(G.fZ);Cb.parent=Ca.AFrame.Xi;Cb.f8(Object(w.a)(this,this.ZYe,"sendIFrameTakeFocusMessage"));this.NK.bja(G.fZ)}ZYe(){document.activeElement.blur();m.AFrameworkApplication.Aa&&m.AFrameworkApplication.Aa.ob.drg||(this.az.value.QZe(),this.az.value.qhl())}dispose(){this.az.value&&this.az.value.dispose()}}Object(h.a)(Ia,"InsightsActor",null,
[107]);var Qa=d(1244),qa=d(704),Wa=d(55),Hb=d(269),jc=d(47);const gc=Cb=>{Cb=Cb.split("-");return Cb[Cb.length-1]},$b=Cb=>18===Cb||19===Cb||15===Cb,wb=()=>{var Cb=Ab();if(Cb)return Promise.resolve(Cb);Cb=Za().replace("SearchWeb","searchweb");Cb=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?Cb+G.WDh+"/":Cb+G.uuc+"/";Cb+="version.json";if(Wa.a.Ex)return Db(Cb);try{const oc=new Sys.Net.WebRequest;oc.set_httpVerb("GET");oc.set_url(Cb);
Cb={};Cb.method=oc.get_httpVerb();return"function"!==typeof window.fetch?(da.It("InsightsUtils - Failed to download version.json because fetch API is unavailable.",10),Promise.resolve("")):window.fetch(oc.getResolvedUrl(),Cb).then(vc=>vc.json()).catch(()=>{da.It("InsightsUtils - Failed to prefetch version.json of HttpException.",10);return""}).then(vc=>{vc=I.b(JSON.stringify(vc));return vc.version?vc.version:""},vc=>{da.It("InsightsUtils - Failed to deserialize version: "+vc.toString(),10);D.ULS.sendTraceTag(591971029,
1303,15,"Insights: Failed to deserialize version: "+vc.toString());return""}).then(vc=>vc)}catch(oc){return da.It("InsightsUtils - Failed to download version.json: "+oc.toString(),10),D.ULS.sendTraceTag(591984149,1303,50,"Insights: Call to Version JSON failed + "+oc.toString()),Promise.resolve("")}},Db=Cb=>{const oc=m.AFrameworkApplication.Me;return new Promise(vc=>{const nd=new qa.a(Cb,1,null,null,!0,2,null);oc.send(nd).Sjb(id=>{id&&id.data?id.data.ee||(da.It("InsightsUtils - Request for version.json with ClientRequestManager returned empty ResponseData. StatusCode: "+
id.data.Ke,10),vc("")):(da.It("InsightsUtils - Request for version.json with ClientRequestManager returned no Data.",10),vc(""));try{const Nd=I.b(id.data.ee);Nd.version&&vc(Nd.version)}catch(Nd){da.It("InsightsUtils - Failed to deserialize version: "+Nd.toString(),10),vc("")}},id=>{id&&id.data?da.It("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. StatusCode: "+id.data.Ke,10):da.It("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. Unknown HTTP Failure.",
10);vc("")})})},Xb=()=>m.AFrameworkApplication.fa.ka("SmartLookupEnableLocalOverride")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableLocalOverride",!1),ab=()=>{const Cb=Za();return Xb()||m.AFrameworkApplication.fa.Ha("SmartLookupPRClientVersion")?Cb+Ab()+"/":m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?Cb+G.WDh:Cb+G.uuc},Ab=()=>Xb()?"dev":m.AFrameworkApplication.fa.Ha("SmartLookupPRClientVersion")?
m.AFrameworkApplication.fa.Ha("SmartLookupPRClientVersion").split("/")[1]:m.AFrameworkApplication.fa.Ha("SmartLookupClientVersion"),rc=Cb=>{var oc=3===m.AFrameworkApplication.Aa.ob.zk?"wordwac":2===m.AFrameworkApplication.Aa.ob.zk?"pptwac":"excelwac";var vc=Hb.a.He(m.AFrameworkApplication.lcid);const nd=vc?vc.name:"en-us";vc=Za();const id=ac();oc="main_ssr_wac.html?appName="+oc+"&culture="+nd;return"LOCAL"===id?vc+oc:vc+((""!==Cb?Cb:G.uuc)+"/")+oc},tb=Cb=>Za()+(""!==Cb?Cb:G.uuc)+"/scripts/microsoft.office.smartlookup.host.runtime.js",
Za=()=>{switch(ac()){case "LOCAL":return G.fzl;case "PR":const Cb=m.AFrameworkApplication.fa.Ha("SmartLookupPRClientVersion").split("/");return G.gzl+Cb[0]+"/";case "INT":return G.hzl;case "EDOG":return G.XDh;default:return G.YDh}},fb=()=>{if(!m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletCDNLatencyActivityEnabled",!1))return"";switch(ac()){case "EDOG":return G.XDh;case "PROD":return G.YDh;default:return""}},ac=()=>{if(m.AFrameworkApplication.fa.ka("SmartLookupEnableEdogSourceLocationOverride")||
m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableEdogSourceLocationOverride",!1))return"EDOG";if(m.AFrameworkApplication.fa.ka("SmartLookupEnableProdSourceLocationOverride")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableProdSourceLocationOverride",!1))return"PROD";if(m.AFrameworkApplication.fa.ka("SmartLookupEnableIntSourceLocationOverride")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableIntSourceLocationOverride",
!1))return"INT";if(m.AFrameworkApplication.fa.Ha("SmartLookupPRClientVersion")&&m.AFrameworkApplication.fa.Ha("SmartLookupPRIntentSvc"))return"PR";if(Xb())return"LOCAL";switch(Object(Qa.a)(String,m.AFrameworkApplication.Od.AudienceGroup)||""){case "Dogfood":if(m.AFrameworkApplication.fa&&m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupSKITeamDogfood",!1)){let Cb=m.AFrameworkApplication.fa.Ha("UserPrincipalName");Cb=jc.a.rg(Cb);const oc=m.AFrameworkApplication.fa.Lu("SmartLookupINTEnabledForSKITeam")?
m.AFrameworkApplication.fa.eA("SmartLookupINTEnabledForSKITeam"):[];if(0<=Array.indexOf(oc,Cb))return"INT"}return"EDOG";case "Microsoft":return"EDOG";default:return"PROD"}},Dc=()=>{let Cb;Cb=m.AFrameworkApplication.fa.ka("IntentSvcEnableEdogSourceLocationOverride")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableEdogSourceLocationOverride",!1)?"EDOG":m.AFrameworkApplication.fa.ka("IntentSvcEnableProdSourceLocationOverride")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableProdSourceLocationOverride",
!1)?"PROD":m.AFrameworkApplication.fa.ka("IntentSvcEnableIntSourceLocationOverride")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableIntSourceLocationOverride",!1)?"INT":ac();const oc=m.AFrameworkApplication.fa.Ha("IntentServiceEndpoint"),vc=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcNewEndpointEnabled",!1);if("PROD"===Cb&&""!==oc)return oc+"searchendpointv2/";switch(Cb){case "LOCAL":return"wss://127.0.0.1:9000/officeaugmentation/searchendpointv2/";
case "PR":return m.AFrameworkApplication.fa.Ha("SmartLookupPRIntentSvc")+"searchendpointv2/";case "INT":return(vc?"wss://entity.osi.office-int.net/officeaugmentation/":"wss://augmentation.osi.office-int.net/officeaugmentation/")+"searchendpointv2/";case "EDOG":return(vc?"wss://entity.osi.officeppe.net/officeaugmentation/":"wss://augmentation.osi.officeppe.net/officeaugmentation/")+"searchendpointv2/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpointv2/"}},Sc=()=>{const Cb=
ac(),oc=m.AFrameworkApplication.fa.Ha("IntentServiceEndpoint");switch(Cb){case "LOCAL":case "INT":case "EDOG":return"https://shredder-test.osi.office.net/shredderservice/api/refreshmemory";default:return"PROD"===Cb&&""!==oc?"https://shredder-eu.osi.office.net/shredderservice/api/refreshmemory":"https://shredder.osi.office.net/shredderservice/api/refreshmemory"}};class xb{sendTelemetryEvent(Cb){da.sendTelemetryEvent(Cb)}}Object(h.a)(xb,"OtelTelemetrySink",null,[897]);class Ta{}Object(h.a)(Ta,"ApplicationProperties",
null,[]);class ib{constructor(){this.createdDate=this.author=this.filePath=this.docName=null}}Object(h.a)(ib,"CurrentDocumentProperties",null,[]);class ob{}Object(h.a)(ob,"EnterpriseUserInfo",null,[]);class fc{}Object(h.a)(fc,"FeatureGates",null,[]);var Jb=d(81);class xc{constructor(Cb,oc){this.Oq=this.ph=null;this.k7="Search";this.BHg=!0;this.c7a=oc;this.FG=Cb;this.FG.execute(vc=>{vc.isFeatureEnabled("mso_sendASmile",!0).then(nd=>{this.BHg=nd}).catch(nd=>{da.It("SearchHelper - Failed to check if Feedback feature is enabled: "+
nd.toString(),15)})});Cb=Dc();oc=m.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentSearch")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1);if(m.AFrameworkApplication.fa.ka("SmartLookupFeatureGateV2")){this.Oq={};const vc=this.irj();if(vc&&0<vc.length)for(let nd=0;nd<vc.length;nd++){const id=vc[nd],Nd=this.bsj(id);switch(Nd.toLowerCase()){case "true":this.Oq[id]=!0;break;case "false":this.Oq[id]=!1;break;default:this.Oq[id]=
Nd}}this.Oq.EnableInDocumentSearch=oc;this.Oq.EnableInDocumentSearchReplace=!0;this.Oq.EnableInDocumentParamLocalSearch=!0;this.Oq.EnableInDocumentQuerySuggest=oc&&m.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentQuerySuggest")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1);this.Oq.EnableInDocumentQuestionGeneration=oc&&m.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentQuestionGeneration")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",
!1);this.Oq.EnableInDocumentExperiment1=oc&&m.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment1")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1);this.Oq.EnableInDocumentExperiment2=oc&&m.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment2")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1);this.Oq.EnableInDocumentExperiment3=
oc&&m.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment3")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1);this.Oq.EnableZeroTermAutoRefresh=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1);this.Oq.EnableTap3SZeroTerm=m.AFrameworkApplication.fa.ka("SmartLookupEnableTap3SZeroTerm")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1);this.Oq.EnableLocalSearch=!0;this.Oq.EnableInDocumentStickyFilters=!0;this.Oq.IntentServiceEndpoint=Cb;this.Oq.EnablePDFShredding=m.AFrameworkApplication.fa.ka("SmartLookupEnableSharepointPDFIsEnabled")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1);this.Oq.FilterNonPPTFilesForReuseSlides=m.AFrameworkApplication.fa.ka("SmartLookupFilterNonPPTFilesForReuseSlides");this.Oq.UXBundleVersion=Ab();this.Oq.SmartLookupServicePath=
ab();this.Oq.EnableAcronymSearch=!0;this.Oq.UseAltAnswerEndpoint1=m.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint1")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1);this.Oq.UseAltAnswerEndpoint2=m.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint2")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1);this.Oq.UseAltAnswerEndpoint3=m.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint3")||
m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1);this.Oq.UseNextUXVersion=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1);this.Oq.IgnoreNeighborhoodContext=m.AFrameworkApplication.fa.ka("SmartLookupIgnoreNeighborhoodContextIsEnabled");this.Oq.ShowDebugInfo="INT"===ac();this.Oq.DebugCommands=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
"");this.Oq.ChangeGates=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames","");this.Oq.QnaInMixSection=!0;this.Oq.EnableNoteSearch=m.AFrameworkApplication.fa.ka("SmartLookupNoteSearchIsEnabled")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1);this.Oq.EnableWikiL2=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1);
this.Oq.EnableFilteringOutRedundantKPE=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1);this.Oq.EnableZeroTermEntitySuggestion=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1);this.Oq.RankingModels=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels","");this.Oq.EnableClientSideRendering=!0}else this.ph=new fc,this.ph.EnableInDocumentSearch=
oc,this.ph.EnableInDocumentSearchReplace=!0,this.ph.EnableInDocumentParamLocalSearch=!0,this.ph.EnableInDocumentQuerySuggest=oc&&m.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentQuerySuggest")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1),this.ph.EnableInDocumentQuestionGeneration=oc&&m.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentQuestionGeneration")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",
!1),this.ph.EnableInDocumentExperiment1=oc&&m.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment1")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1),this.ph.EnableInDocumentExperiment2=oc&&m.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment2")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1),this.ph.EnableInDocumentExperiment3=
oc&&m.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment3")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1),this.ph.EnableZeroTermAutoRefresh=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1),this.ph.EnableTap3SZeroTerm=m.AFrameworkApplication.fa.ka("SmartLookupEnableTap3SZeroTerm")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1),this.ph.EnableLocalSearch=!0,this.ph.EnableInDocumentStickyFilters=!0,this.ph.IntentServiceEndpoint=Cb,this.ph.EnablePDFShredding=m.AFrameworkApplication.fa.ka("SmartLookupEnableSharepointPDFIsEnabled")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1),this.ph.FilterNonPPTFilesForReuseSlides=m.AFrameworkApplication.fa.ka("SmartLookupFilterNonPPTFilesForReuseSlides"),this.ph.UXBundleVersion=Ab(),this.ph.SmartLookupServicePath=
ab(),this.ph.EnableAcronymSearch=!0,this.ph.UseAltAnswerEndpoint1=m.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint1")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1),this.ph.UseAltAnswerEndpoint2=m.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint2")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1),this.ph.UseAltAnswerEndpoint3=m.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint3")||
m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1),this.ph.UseNextUXVersion=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1),this.ph.IgnoreNeighborhoodContext=m.AFrameworkApplication.fa.ka("SmartLookupIgnoreNeighborhoodContextIsEnabled"),this.ph.ShowDebugInfo="INT"===ac(),this.ph.DebugCommands=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
""),this.ph.ChangeGates=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",""),this.ph.QnaInMixSection=!0,this.ph.EnableNoteSearch=m.AFrameworkApplication.fa.ka("SmartLookupNoteSearchIsEnabled")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1),this.ph.EnableWikiL2=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1),
this.ph.EnableFilteringOutRedundantKPE=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1),this.ph.EnableZeroTermEntitySuggestion=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1),this.ph.RankingModels=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",""),this.ph.EnableClientSideRendering=!0,this.ph.SharedSerpletFeatureGate1=
m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate1",!1),this.ph.SharedSerpletFeatureGate2=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate2",!1),this.ph.SharedSerpletFeatureGate3=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate3",!1),this.ph.SharedSerpletFeatureGate4=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate4",
!1),this.ph.SharedSerpletFeatureGate5=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate5",!1),this.ph.SharedSerpletFeatureGate6=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate6",!1),this.ph.SharedSerpletFeatureGate7=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate7",!1),this.ph.SharedSerpletFeatureGate8=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate8",
!1),this.ph.SharedSerpletFeatureGate9=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate9",!1),this.ph.SharedSerpletFeatureGate10=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1),this.ph.SharedSerpletFeatureGate11=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate11",!1),this.ph.SharedSerpletFeatureGate12=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate12",
!1),this.ph.SharedSerpletFeatureGate13=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate13",!1),this.ph.SharedSerpletFeatureGate14=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate14",!1),this.ph.SharedSerpletFeatureGate15=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate15",!1),this.ph.SharedSerpletFeatureGate16=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate16",
!1),this.ph.SharedSerpletFeatureGate17=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate17",!1),this.ph.SharedSerpletFeatureGate18=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate18",!1),this.ph.SharedSerpletFeatureGate19=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate19",!1),this.ph.SharedSerpletFeatureGate20=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate20",
!1),this.ph.SharedSerpletFeatureGate21=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate21",!1),this.ph.SharedSerpletFeatureGate22=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate22",!1),this.ph.SharedSerpletFeatureGate23=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate23",!1),this.ph.SharedSerpletFeatureGate24=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate24",
!1),this.ph.SharedSerpletFeatureGate25=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate25",!1),this.ph.SharedSerpletFeatureGate26=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate26",!1),this.ph.SharedSerpletFeatureGate27=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate27",!1),this.ph.SharedSerpletFeatureGate28=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate28",
!1),this.ph.SharedSerpletFeatureGate29=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate29",!1),this.ph.SharedSerpletFeatureGate30=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate30",!1),this.ph.SharedSerpletFeatureGate31=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate31",!1),this.ph.SharedSerpletFeatureGate32=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",
!1),this.ph.SharedSerpletFeatureGate33=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate33",!1),this.ph.SharedSerpletFeatureGate34=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate34",!1),this.ph.SharedSerpletFeatureGate35=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate35",!1),this.ph.SharedSerpletFeatureGate36=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate36",
!1),this.ph.SharedSerpletFeatureGate37=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate37",!1),this.ph.SharedSerpletFeatureGate38=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate38",!1),this.ph.SharedSerpletFeatureGate39=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate39",!1),this.ph.SharedSerpletFeatureGate40=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate40",
!1);this.xWb=T.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager");this.Ogc=xc.isEnterpriseUser();this.Ujc=m.AFrameworkApplication.fa.Ha("SmartLookupShredderServiceEndpoint");this.Ark=Jb.a.wB(m.AFrameworkApplication.fa.Ha("AppCatalogUrl")||"");this.tsk=m.AFrameworkApplication.fa.Ha("UserPrincipalName");this.Ogc&&this.abg()}bsj(Cb){return m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline."+Cb,"")}irj(){const Cb=m.AFrameworkApplication.fa.$Sc,oc=m.AFrameworkApplication.fa.eA("SmartLookupFlightKeywordList"),
vc=[];if(Cb&&oc&&0<oc.length)for(let id in Cb){var nd={key:id,value:Cb[id]};nd=nd&&nd.key?nd.key:"";for(let Nd=0;Nd<oc.length;Nd++)if(-1<nd.toLowerCase().indexOf(oc[Nd].toLowerCase())){const Ce=nd.split(".");Ce&&4===Ce.length&&Array.add(vc,Ce[Ce.length-1])}}return vc}z8b(Cb,oc,vc,nd){return new Promise(id=>{this.H3j().then(Nd=>{const Ce=new Ta;Ce.anid="";Ce.applicationName=3===m.AFrameworkApplication.Aa.ob.zk?"WORD":"POWERPNT";Ce.applicationVersion=m.AFrameworkApplication.buildVersion;Ce.appCorrelationId=
Cb?Cb:ka.G$a();Ce.themePlatform="web";Ce.lcid=m.AFrameworkApplication.lcid;Ce.launchUtcTime=(new Date).toUTCString();m.AFrameworkApplication.fa.ka("SmartLookupFeatureGateV2")?Ce.featureGates=I.c(this.Oq):Ce.featureGates=I.c(this.ph);var af=Hb.a.He(m.AFrameworkApplication.lcid);af=af?af.name:null;Ce.market=gc(af);Ce.uiLanguage=af;Ce.sessionId=m.AFrameworkApplication.userSessionId;Ce.themeId=vc;Ce.parentalControl="yes";Ce.processorOnlyMode=Nd;Ce.isEditingAllowed=oc.isEditingAllowed();Ce.isFeedbackEnabled=
this.BHg;Ce.isClientSideRendering=$b(nd);Ce.disableClipboard=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletRestrictCopyWithIRMEnabled",!1)&&m.AFrameworkApplication.cC&&!m.AFrameworkApplication.QSa;Ce.accessToken=this.Ogc?this.abg():"";Nd=new ob;Nd.CountryCode=gc(af);Nd.ServiceEndpoint=this.Ujc;Nd.IsGoLocal=m.AFrameworkApplication.fa.ka("IsGoLocalEnvironment");Nd.IsEnabled=this.Ogc;Nd.IsEnterpriseEnabled=this.Ogc;Nd.TenantRoot=this.Ark;Nd.Upn=this.tsk;af=ac();
Nd.IsEUDB="PROD"===af&&""!==m.AFrameworkApplication.fa.Ha("IntentServiceEndpoint");Ce.enterpriseUserInfo=Nd;Nd=new ib;Nd.filePath=m.AFrameworkApplication.fa.Ha("EditDocInClientUrl");Nd.docName=m.AFrameworkApplication.fa.Ha("FileName");Nd.author=99!==nd?oc.author():null;Nd.createdDate=99!==nd?oc.createdDate():null;Ce.currentDocument=Nd;id(Ce)})})}H3j(){return new Promise(Cb=>{this.FG?this.FG.execute(oc=>{oc.isFeatureEnabled(G.izl,!0).then(vc=>{Cb(!vc)}).catch(vc=>{da.It("SearchHelper - Failed to load the SmartLookup state from application feature helper: "+
vc.toString(),10);Cb(!0)})}):Cb(!0)})}pfh(Cb){this.xWb&&this.Ogc&&this.CXc(this.Ujc).then(oc=>{Cb(oc)})}abg(){return"Dev Box"===m.AFrameworkApplication.fa.Ha("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?window.SearchPaneShredderTokenOverride:this.xWb?this.xWb.svj(this.k7,this.Ujc):""}CXc(Cb){return"Dev Box"===m.AFrameworkApplication.fa.Ha("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&
null!==window.SearchPaneShredderTokenOverride?new Promise(oc=>{oc(window.SearchPaneShredderTokenOverride)}):this.xWb?this.xWb.getToken(this.k7,Cb):Promise.resolve("")}yab(){return this.c7a?this.c7a.getVersion():""}R6f(){return m.AFrameworkApplication.fa.ka("SmartLookupFeatureGateV2")?I.c(this.Oq):I.c(this.ph)}static isEnterpriseUser(){const Cb=m.AFrameworkApplication.fa.Ha("SovereignEnvironmentName"),oc=m.AFrameworkApplication.fa.ka("IsTellMeUpSellEnterpriseEnabled");return(!Cb||!Cb.length)&&oc}}
Object(h.a)(xc,"SearchHelper",null,[848]);class ic{constructor(){ic.La=""}getVersion(){return ic.La}Cpl(Cb){ic.La=Cb}}ic.La=null;Object(h.a)(ic,"SmartLookupVersion",null,[]);class nc{}Object(h.a)(nc,"ConfigurationProvider",null,[]);class Wb{constructor(Cb){Wb.La=Cb}tae(){return Wb.La}}Wb.La=null;Object(h.a)(Wb,"SearchHostRuntime",null,[]);var wc=d(134),nb=d(249),Rb=d(310),mb=d(252);class Ub{constructor(){this.TK=this.cob=this.Da=null}get name(){return"Common.App.Insights"}Yb(Cb){this.Da=Cb;const oc=
mb.a.Lt(T.a.instance.Ia("Common.IEventEmitter<Common.IGetMoreInfoResult>")),vc=m.AFrameworkApplication.fa.ka("SmartLookupEnableNativePane")||m.AFrameworkApplication.fa.ka("SmartLookupIsEnabled");Cb.register(Ia,"Common.App.Insights.InsightsActor").ma().oa(()=>new Ia(Cb.oe("Common.App.Insights.IInsightsManager"),m.AFrameworkApplication.Ra,n.a.instance,z.FocusManager.instance(),Cb.Ia("Common.App.SearchCommon.ISearchOAuthManager"),m.AFrameworkApplication.fa,wc.a.instance,vc,new e.a(()=>oc.result)));Cb.register(847,
"Common.App.Insights.IDocumentContentExtractionManager").ma().oa(()=>new B(Cb));vc&&(Cb.register(ic,"Common.App.Insights.SmartLookupVersion").ma().oa(()=>new ic),Cb.register(848,"Common.App.SearchCommon.ISearchHelper").ma().oa(()=>new xc(T.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Cb.qb("Common.App.Insights.SmartLookupVersion"))))}init(){m.AFrameworkApplication.LFa&&(this.cob=this.Da.qb("Common.App.Insights.InsightsActor"),this.cob.vb())}d2k(){if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RecallRefreshMemory",
!1)){var Cb=m.AFrameworkApplication.fa.Ha("SmartLookupShredderServiceEndpoint");this.Da.resolve("Common.App.SearchCommon.ISearchHelper").CXc(Cb).then(oc=>{var vc={};vc.Authorization="Bearer "+oc;oc=Sc();const nd=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RefreshMemoryTelemetry",!0);vc=new qa.a(oc+("?isTelemetryOnly="+nd),1,null,vc,!0,2,null);m.AFrameworkApplication.Me.send(vc).Sjb(()=>{da.It("InsightsPackage - Refresh Memory API request sent and was successful. isTelemetryOnly="+
nd,50)},id=>{da.It("InsightsPackage - Failed to send refreshmemory API request. Error: "+id.toString(),10)})})}}KWi(){this.MQj();this.d2k()}MQj(){wb().then(Cb=>{if(""!==Cb){const oc=this.Da.qb("Common.App.Insights.SmartLookupVersion");oc&&oc.Cpl(Cb)}this.HQc();this.cob=this.Da.resolve("Common.App.Insights.InsightsActor");Cb=tb(Cb);Cb=Rb.a.create(Cb);Cb.kW((oc,vc)=>{vc.succeeded?this.pql()&&this.prefetchZeroTerm():da.It("InsightsPackage - Failed to load SmartLookupHostRuntime script. ResourceURL: "+
vc.$u,10);this.cob.vb()});nb.a.oy(Cb)})}pql(){const Cb=Object.assign(new nc,{channelId:G.channelId,approvedOriginPattern:Xb()?"^(http)?://(localhost:8080)$":m.AFrameworkApplication.fa.Ha("SmartLookupApprovedOriginPattern")});var oc=this.Da.resolve("Common.App.SearchCommon.IDocumentContentExecutor");const vc=this.Da.resolve("Common.App.SearchCommon.ISerpletExecutor"),nd=this.Da.resolve("Common.App.SearchCommon.IInsertContentExecutor"),id=new x.a;oc&&id.add(oc);vc&&id.add(vc);nd&&id.add(nd);oc=Dc();
try{const Nd=new xb,Ce=SmartLookupHostRuntime.setup(Cb,id.toArray(),!0,oc,Nd);this.Da.register(Wb,"Common.App.SearchCommon.SearchHostRuntime").ma().oa(()=>new Wb(Ce));return!0}catch(Nd){return da.It("InsightsPackage - Failed to setup SmartLookupHostRuntime during package initialization. Error: "+Nd,10),!1}}prefetchZeroTerm(){if(m.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentSearch")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",
!1)){var Cb=T.a.instance.qb("Common.App.SearchCommon.SearchHostRuntime");if(Cb){const oc=this.Da.resolve("Common.App.SearchCommon.ISearchHelper"),vc=this.Da.resolve("Common.App.SearchCommon.IDocumentHelper");oc.z8b(null,vc,0,99).then(nd=>{Cb.tae().prefetchZeroTerm(nd,m.AFrameworkApplication.userSessionId,ab(),!0,"Indoc",null)})}else da.It("InsightsPackage - Failed to prefetch zero term because we failed to resolve the HostRuntime.",15)}}HQc(){var Cb=this.Da.resolve("Common.App.SearchCommon.ISearchHelper");
const oc=rc(Cb.yab());Cb=Cb.yab();Cb=Za()+(""!==Cb?Cb:G.uuc)+"/scripts/microsoft.office.smartlookup.ssr.js";const vc=fb();Wa.a.Ex?this.JWi(oc,Cb):(this.HWi(oc,vc),this.IWi(Cb,vc))}HWi(Cb,oc){const vc=new Sys.Net.WebRequest;vc.set_httpVerb("GET");const nd={};nd.method=vc.get_httpVerb();vc.set_url(Cb);const id=(new Date).getTime();try{window.fetch(vc.getResolvedUrl(),nd).then(()=>{""!==oc&&da.UYe(oc,Cb,(new Date).getTime()-id);this.Da.qb("Common.App.Insights.SmartLookupVersion")})}catch(Nd){da.It("InsightsPackage - Failed to prefetch Html file because of HttpException. Error: "+
Nd.toString(),10)}}IWi(Cb,oc){var vc=new Sys.Net.WebRequest;vc.set_httpVerb("GET");const nd={};nd.method=vc.get_httpVerb();vc.set_url(Cb);let id=-1;if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletPrefetchJSOnIdle",!1))vc=m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletPrefetchDelayInMs",3E5),wc.a.instance.Hb(new ta.a(5,1,vc,()=>{const Nd=Rb.a.create(Cb);Nd.Xyf(()=>{id=Date.now()});Nd.kW((Ce,af)=>{af.succeeded?""!==
oc&&da.UYe(oc,Cb,Date.now()-id):da.It("InsightsPackage - Failed to prefetch JS file.",10)});nb.a.oy(Nd)}));else{id=Date.now();try{window.fetch(vc.getResolvedUrl(),nd).then(()=>{""!==oc&&da.UYe(oc,Cb,Date.now()-id)})}catch(Nd){da.It("InsightsPackage - Failed to prefetch JS file because of HttpException. Error: "+Nd.toString(),10)}}}JWi(Cb,oc){if(Wa.a.Ex){var vc=m.AFrameworkApplication.Me;Cb=new qa.a(Cb,1,null,null,!0,2,null);vc.send(Cb).Sjb(nd=>{nd&&nd.data?nd.data.ee?this.Da.qb("Common.App.Insights.SmartLookupVersion"):
da.It("InsightsPackage - Request for Html with ClientRequestManager returned empty ResponseData. StatusCode: "+nd.data.Ke,10):da.It("InsightsPackage - Request for Html with ClientRequestManager returned no Data.",10)},nd=>{nd&&nd.data?da.It("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. StatusCode: "+nd.data.Ke,10):da.It("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. Unknown HTTP Failure.",10)});m.AFrameworkApplication.fa.ka("SmartLookupPrefetchJSIsEnabled")&&
(oc=new qa.a(oc,1,null,null,!0,2,null),vc.send(oc).Sjb(nd=>{nd&&nd.data?nd.data.ee||da.It("InsightsPackage - Request for SSR JS with ClientRequestManager returned empty ResponseData. StatusCode: "+nd.data.Ke,10):da.It("InsightsPackage - Request for SSR JS with ClientRequestManager returned no Data.",10)},nd=>{nd&&nd.data?da.It("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. StatusCode: "+nd.data.Ke,10):da.It("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. Unknown HTTP Failure.",
10)}))}}dispose(){this.cob&&this.cob.dispose()}}Object(h.a)(Ub,"InsightsPackage",null,[2,3]);var zc=d(29),Pc=d(100),Mc=d(682),ld=d(1130),vb=d(549),cc=d(60),Hc=d(35);class Pb{constructor(Cb,oc,vc,nd=!0){this.streamUrl=Cb;this.objectType=oc;this.formatType=vc;this.renderAfterInsert=nd}}Object(h.a)(Pb,"InsertContentFromStreamData",null,[]);var Uc=d(448),sc=d(30);class lb{constructor(Cb,oc,vc){this.ia=Cb;this.pa=oc;this.ta=vc}insertOnlinePicture(Cb){const oc=Object(Qa.a)(117,this.ta.Ba);Cb&&oc&&(Cb=Object.assign(new vb.a,
{Action:"Insert",Caption:Cb.caption,OriginalUrl:Cb.sourceUrl,Height:Cb.height,Width:Cb.width,LicenseDisplayName:Cb.licenseDisplayName,LicenseUrl:Cb.licenseUrl,ThumbnailUrl:Cb.thumbnailUrl,PageUrl:Cb.pageUrl}),this.ia.Ka(sc.a.Hbb,2,Cb))}insertHtmlText(Cb){if(Cb)if(1===this.pa.Xd().length){const oc=new ld.DictionaryPropertySet;oc.setValue(cc.a.VU,Cb.htmlText);oc.setValue(cc.a.kld,!1);8===this.ia.Ka(Hc.a.Xkd,2,oc)&&this.tkg(Cb)}else this.tkg(Cb)}tkg(Cb){Cb=Object.assign(new Uc.a,{COb:!1,gZ:Cb.htmlText});
this.ia.Ka(sc.a.eya,2,Cb)}insertContentFromStreamUrl(Cb){Cb&&(Cb=new Pb(Cb.streamUrl,Cb.objectType,Cb.formatType,Cb.renderAfterInsert),this.ia.Ka(sc.a.e_c,2,Cb))}getId(){return"InsertContentExecutor"}}Object(h.a)(lb,"InsertContentExecutor",null,[823,845]);var Zb=d(1048),Oc=d(196);class md{}Object(h.a)(md,"CommandMetadataResponse",null,[]);class Ib{constructor(){this.Xge=this.getAllIcons()}executeCommand(){}executeCommandAsync(){return Promise.resolve(null)}openFeedbackPane(){}openSerpletTaskPane(){}sendAutoLaunchSearchRequest(){}openFindReplaceTaskPane(){}openFindReplaceTaskPaneV2(){}openFindTaskPane(){}openNavigationPane(){}closeNavigationPane(){}openPrivacySettings(){Oc.PrivacyDialogManager.Wtd()}browseFiles(){}getId(){return"SerpletExecutor"}getCommandMetadata(Cb){const oc=
new md;Cb.iconNames&&(oc.svgData=this.getCommandIconSvg(Cb.iconNames));if(!Cb.commandId||""===Cb.commandId)return oc.isVisible=!1,oc;try{oc.isVisible=Array.contains(appChrome.selectors.getVisibleControlIds(),Cb.commandId);oc.isDisabled=appChrome.selectors.isControlDisabled(Cb.commandId);oc.label=appChrome.selectors.getControlLabel(Cb.commandId);if(oc.svgData&&""!==oc.svgData)return oc;const vc=appChrome.selectors.getControlIconSet(Cb.commandId),nd=Array(2);nd[0]=vc["default"];nd[1]=vc.icon32;oc.svgData=
this.getCommandIconSvg(nd)}catch(vc){return null}return oc}getCommandIconSvg(Cb){if(!this.Xge)return"";for(let oc=0;oc<Cb.length;oc++){const vc=Cb[oc];if(vc in this.Xge)return this.Xge[vc]}return""}startSpeech(){return Promise.resolve(!1)}stopSpeech(){return Promise.resolve(!1)}getAllIcons(){return{}}createFeedbackPropertiesFromData(Cb){const oc={SourceControlId:"GiveFeedback"};oc.feedbackType="true"===Cb.IsPosFeedback?0:1;const vc={};vc.featureArea=Ib.h3i;oc.telemetryGroup=vc;oc.appData=Cb;return oc}}
Ib.uIj="FA000000012";Ib.nWk="AssetID=";Ib.h3i="SearchPane";Object(h.a)(Ib,"BaseSerpletExecutor",null,[822,845]);var ud=d(28);class od extends Ib{constructor(Cb,oc,vc){super();this.ia=Cb;this.gNg=oc;this.uDe=vc;if(!Cb)throw Error.argumentNull("m_actionManager");}openFeedbackPane(Cb){this.ia.Ka(Na.a.QMb,2,this.createFeedbackPropertiesFromData(Cb))}openHelpTaskPane(Cb){const oc={};oc.query=Ib.nWk+Cb;Cb={};Cb.assetId=Ib.uIj;Cb.nonPersistedSettings=oc;this.ia.Ka(sc.a.Oga,2,Cb)}browseFiles(){this.ia.Ka(Na.a.Z_c,
2,null)}executeCommand(Cb){if(Cb)switch(Cb.CommandId){case 3:appChrome.api.executeCommand(Cb.Data.CommandId,Cb.Data.Payload);break;case 4:if(this.gNg&&this.uDe)try{this.gNg.OQj(Cb.Data.AST)}catch(oc){ud.a.J(509449952,1313,15,`SmartLookup PPTSerpletExecutor executeCommand: Exception thrown while executing provided AST. ${oc}`)}}}}Object(h.a)(od,"PPTSerpletExecutor",Ib,[]);class Ud{isEditingAllowed(){return!0}author(){return null}createdDate(){return null}}Object(h.a)(Ud,"BaseDocumentHelper",null,[824]);
class Ad extends Ud{constructor(){super()}isEditingAllowed(){return zc.App.Lb.Kd.isEditingAllowed}}Object(h.a)(Ad,"PptDocumentHelper",Ud,[]);class be{constructor(){this.Gzc=this.uI=null}o0d(){return null}ZTa(){return this.bab()}ijj(){return this.bab()}qwl(Cb,oc,vc){this.uI||(this.uI=this.xOc());this.uI.hl(Cb,oc,vc)}rwl(Cb,oc,vc){this.uI||(this.uI=this.xOc());this.uI.i2e(Cb,oc,vc)}Oul(Cb,oc){this.Gzc||(this.Gzc=this.o0d());this.Gzc&&this.Gzc.i2e(Cb,oc)}Drd(Cb,oc){this.uI||(this.uI=this.xOc());this.uI.Drd(Cb,
oc)}yre(Cb){this.uI||(this.uI=this.xOc());this.uI.yre(Cb)}qhl(){this.uI&&this.uI.ZYe()}QZe(){this.uI&&this.uI.Skl()}mul(){var Cb=m.AFrameworkApplication.fa.wc("SmartLookupLaunchThrottleThresholdInMilliseconds",1500);Cb=window.performance.now()-be.uug<=Cb;Cb||(be.uug=window.performance.now());return Cb}dispose(){this.uI&&(this.uI.dispose(),this.uI=null)}get Dbc(){return this.uI?this.uI.isVisible:!1}}be.uug=0;Object(h.a)(be,"InsightsManager",null,[333,107]);class uf{constructor(Cb,oc,vc,nd,id,Nd=!0,
Ce=null,af=null){this.DK=this.Gp=this.iia=null;this.VOa=!1;this.TK=null;this.Pd=oc;this.ZHd=Nd;this.DTb=af?af:new Ud;this.FG=Ce;this.NK=Cb;this.ZHd&&(T.a.instance.qb("Common.App.SearchCommon.SearchHostRuntime")&&(this.TK=T.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").tae()),this.aW=T.a.instance.resolve("Common.App.SearchCommon.ISearchHelper"),this.c7a=this.aW.yab())}jib(Cb){if(this.ZHd){Cb=Cb.rawEvent;try{var oc=I.a(Cb.data)}catch(vc){D.ULS.sendTraceTag(595161728,1303,15,this.Cka("Message data from Serplet [{0}] failed to deserialize.",
Cb.data));return}switch(oc.actionType){case 101:Cb=0;this.Gp&&(Cb=this.Gp.entryPoint);this.aW.z8b(this.DK,this.DTb,this.uUa(),Cb).then(vc=>{oc.data=vc;this.ZJb(oc)});break;case 118:oc.data=this.Gp?this.Gp:Object.assign(new fa.a,{selection:Object.assign(new aa.a,{neighborhood:this.iia.neighborhood,mentionStart:this.iia.mentionStart,mentionLength:this.iia.mentionLength})});this.ZJb(oc);break;case 103:Cb=I.a(Object(Qa.a)(String,oc.data));da.sendTelemetryEvent(Cb);break;case 206:this.aW.CXc(oc.data).then(vc=>
{oc.data=vc;this.ZJb(oc)});break;case 112:oc.data.shiftPressed?(Wa.a.gg&&document.activeElement.blur(),this.NK.lYc(0,null,2,null,null),D.ULS.sendTraceTag(592545156,1303,50,this.Cka("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.NK.CUa(0,null,2,null,null),D.ULS.sendTraceTag(592545155,1303,50,this.Cka("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.Iq()}}}Pkb(Cb){if(this.TK){var oc=0;this.Gp&&(oc=this.Gp.entryPoint);this.aW.z8b(this.DK,this.DTb,this.uUa(),oc).then(vc=>{da.Brd("SearchFromHost",
this.DK);this.Gp.launchData||(this.Gp.launchData=new Da.a);const nd=ab();try{this.TK.search(this.Gp,vc,m.AFrameworkApplication.userSessionId,nd,Cb),this.aW.pfh(id=>{da.Brd("SearchFromHostWithToken",this.DK);this.TK.searchAuthenticatedProviders(this.Gp,vc,m.AFrameworkApplication.userSessionId,nd,null,id)})}catch(id){da.It("BaseSmartLookupPane - Fail to search from host. Error: "+id,10)}}).catch(vc=>{da.It("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+vc.toString(),
10)})}}wsc(Cb){this.ZHd&&da.wsc(this.DK,Math.round(window.performance.now()-Cb),this.Gp?Z.a[this.Gp.entryPoint]:"",this.aW.yab(),this.aW.R6f(),m.AFrameworkApplication.LJc,this.VOa,$b(this.Gp?this.Gp.entryPoint:0))}}Object(h.a)(uf,"BaseSmartLookupPane",null,[912,107]);class sd{constructor(){this.type="SmartLookupTaskPaneProps"}}Object(h.a)(sd,"SmartLookupTaskPaneProps",null,[]);var Ze=d(656);class Ke{}Object(h.a)(Ke,"ActionDescriptor",null,[]);var hf=d(99);class Xa extends uf{constructor(Cb,oc,vc,
nd=null,id=null,Nd=null,Ce=!0,af=null,de=null){super(oc,vc,nd,id,Nd,Ce,af,de);this.LPd=!!m.AFrameworkApplication.Aa&&!!m.AFrameworkApplication.Aa.ob&&m.AFrameworkApplication.Aa.ob.oqe;this.hqb=this.RMd=!1;this.v2h=m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxViewportWidthThreshold",1680);this.u2h=m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxPaneWidth",844);this.z2h=m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumViewportWidthThreshold",
1366);this.y2h=m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumPaneWidth",700);Ce||da.It("ReactSmartLookupPane - React SmartLookup pane constructed for legacy SmartLookup.",10);this.bra=Cb;this.qif=rc(this.c7a)}get isVisible(){return this.hqb}Drd(Cb,oc){this.Gp=Cb;this.iia=Cb=Object.assign(new M.a,{neighborhood:Cb.selection.neighborhood,mentionStart:Cb.selection.mentionStart,mentionLength:Cb.selection.mentionLength});this.VOa=!Cb.mentionLength;this.DK=oc;this.Pkb(!1)}yre(Cb){this.Gp=
Cb;this.sza(Object.assign(new M.a,{neighborhood:Cb.selection.neighborhood,mentionStart:Cb.selection.mentionStart,mentionLength:Cb.selection.mentionLength}),!1)}hl(Cb,oc){this.DK=oc;this.sza(Cb,!0)}i2e(Cb,oc,vc){this.Gp=Cb;this.hl(Object.assign(new M.a,{neighborhood:Cb.selection.neighborhood,mentionStart:Cb.selection.mentionStart,mentionLength:Cb.selection.mentionLength}),oc,vc)}Iq(){this.lsd();this.bra.hideTaskPane()}sza(Cb,oc){ja.SessionStatusManager.instance.Z_&&this.TK?(this.iia=Cb,this.VOa=!Cb.mentionLength,
Cb=window.performance.now(),this.initialize(),this.isVisible?m.AFrameworkApplication.fa.ka("SmartLookupDisableRefreshPaneIsEnabled")?(this.bra.updateTaskPane(null),oc&&this.Qhl()):(oc&&this.Pkb(!1),this.RMd=!this.RMd,this.bra.updateTaskPane(this.pda())):(oc&&this.Pkb(this.isVisible),this.bra.showTaskPane(this.pda())),this.wsc(Cb)):(this.bra.showTaskPane(this.pda()),da.thl(ja.SessionStatusManager.instance.Z_,!!this.TK,this.Gp?Z.a[this.Gp.entryPoint]:"",this.aW.yab(),m.AFrameworkApplication.LJc,this.VOa))}Qhl(){if(!this.Gp){const Cb=
Object.assign(new aa.a,{neighborhood:this.iia.neighborhood,mentionStart:this.iia.mentionStart,mentionLength:this.iia.mentionLength});this.Gp=Object.assign(new fa.a,{selection:Cb,userIntent:null,entryPoint:0,launchData:null})}this.Pkb(this.isVisible)}Chl(){const Cb=new Ke;Cb.transactionId=this.DK;Cb.actionType=15;Cb.channelId=G.channelId;this.ZJb(Cb)}jib(Cb){const oc=Cb.rawEvent;document.getElementById(G.fZ)&&oc.source!==document.getElementById(G.fZ).contentWindow||this.z_k(Cb)}z_k(Cb){const oc=Cb.rawEvent;
let vc;try{vc=I.b(oc.data)}catch(nd){D.ULS.sendTraceTag(545604257,1303,15,this.Cka("Message data from Serplet [{0}] failed to deserialize.",oc.data));return}switch(vc.actionType){case 32:m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&(hf.a.OXc()>=this.v2h?this.bra.updateTaskPane(this.y1d(this.u2h)):hf.a.OXc()>=this.z2h&&this.bra.updateTaskPane(this.y1d(this.y2h)));break;case 33:m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",
!1)&&this.bra.updateTaskPane(this.y1d(vc.data));break;case 42:this.bra.updateTaskPane(this.rPi(vc.data));break;case 43:this.bra.updateTaskPane(this.pda());break;default:super.jib(Cb)}}dispose(){}initialize(){this.Alb()}Alb(){const Cb=this.Pd.Fc(G.fZ);Cb.parent=Ca.AFrame.Xi;Cb.uJ=!0}ILa(){this.Pd.vf(G.fZ)}lsd(){this.nqe()&&this.Pd.vf(this.Pd.G8)}zUe(){$addHandler(window,"message",Object(w.a)(this,this.jib,"onIFrameMessage"))}G8e(){$removeHandler(window,"message",Object(w.a)(this,this.jib,"onIFrameMessage"))}nqe(){return!!this.Pd.Ee&&
this.Pd.Ee.name===G.fZ}ZJb(Cb){Cb=I.c(Cb);document.getElementById(G.fZ)&&document.getElementById(G.fZ).contentWindow.postMessage(Cb,Jb.a.DQ(this.qif))}Cka(Cb,...oc){const vc={};this.DK&&(vc[G.SHh]=this.DK);vc[G.THh]=String.format.apply(null,[Cb].concat(oc));return I.c(vc)}uUa(){return oa.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()?3:0}dch(){if(this.TK)this.TK.onPaneThemeChanged(this.uUa());return oa.a("getTheme")?appChrome.api.getTheme():null}ZYe(){}Skl(){document.getElementById(G.fZ)&&
z.FocusManager.Zq(document.getElementById(G.fZ).contentWindow)}dMe(){da.It("ReactSmartLookupPane - Iframe component failed to load.",10)}YDk(){m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableSerpletIFrameLoadHandler",!1)||window.navigator.onLine||da.It("ReactSmartLookupPane - Onload detected no network.",50)}bgj(){return this.Gp?10===this.Gp.entryPoint?2===m.AFrameworkApplication.Aa.ob.zk?CommonUIStrings.l_ReuseSlidesPaneTitle:CommonUIStrings.l_ReuseFilesPaneTitle:
18===this.Gp.entryPoint?CommonUIStrings.l_FindInDocumentPaneTitle:37===this.Gp.entryPoint?CommonUIStrings.l_SummarizePaneTitle:36===this.Gp.entryPoint||38===this.Gp.entryPoint?CommonUIStrings.l_ConvertToDeckPaneTitle:CommonUIStrings.L_SmartLookupPaneTitle:""}pda(){var Cb=CommonUIStrings.L_SmartLookupPaneTitle;m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletDynamicPaneTitle",!1)&&(Cb=this.bgj());const oc=new sd;oc.src=this.qif;oc.id=G.fZ;oc.refreshPane=
this.RMd;oc.onError=Object(w.a)(this,this.dMe,"onIFrameError");oc.onLoad=Object(w.a)(this,this.YDk,"onIFrameLoad");oc.title=Cb;ja.SessionStatusManager.instance.Z_?this.TK||(oc.errorMessage=CommonUIStrings.l_SmartLookupPaneInitializationError,oc.errorType=1):(oc.errorMessage=CommonUIStrings.l_SmartLookupPaneNetworkDisconnected,oc.errorType=0);Cb=Object.assign(new Ze.a,{title:Cb,hideHeader:!1,width:G.width,location:G.kLk,contentProps:oc,isModernPane:!0,onOpen:()=>{this.ILa();this.hqb=!0;this.zUe();
oa.a("registerOnThemeChangeCallback")&&appChrome.api.registerOnThemeChangeCallback(Object(w.a)(this,this.dch,"onThemeIdChanged"));m.AFrameworkApplication.Aa.updateCommandUI();if(this.TK)this.TK.onPaneStateChanged(!0)},onClose:()=>{this.Chl();this.lsd();this.hqb=!1;this.G8e();oa.a("removeOnThemeChangeCallback")&&appChrome.api.removeOnThemeChangeCallback(Object(w.a)(this,this.dch,"onThemeIdChanged"));m.AFrameworkApplication.Aa.updateCommandUI();if(this.TK)this.TK.onPaneStateChanged(!1)}});this.LPd&&
(Cb.enableResize=!0,Cb.minResizeWidth=320,Cb.maxResizeWidth=920);return Cb}rPi(Cb){const oc=this.pda();oc.title=Cb;oc.contentProps.title=Cb;return oc}y1d(Cb){const oc=this.pda();oc.resizeWidth=Cb;return oc}}Object(h.a)(Xa,"ReactSmartLookupPane",uf,[]);var Bb=d(141);class mc{constructor(){this.Ikf=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartLookupPaneResizingEnabled",!1)}showTaskPane(Cb){Bb.UISurfaces.Gq().then(oc=>{this.Ikf||(Cb.enableResize=!1);oc.showTaskPane(G.fZ,
Cb);return null})}updateTaskPane(Cb=null){Bb.UISurfaces.Gq().then(oc=>{oc.setSelectedTaskPane(G.fZ);Cb&&(this.Ikf||(Cb.enableResize=!1),oc.updateTaskPane(G.fZ,Cb));return null})}hideTaskPane(){Bb.UISurfaces.Gq().then(Cb=>{Cb.hideTaskPane(G.fZ,2);return null})}}Object(h.a)(mc,"PptReactSmartLookupPaneHandler",null,[894]);class Qc{static gde(){switch(m.AFrameworkApplication.fa.ka("SmartLookupEnableEdogSourceLocationOverride")?"EDOG":m.AFrameworkApplication.fa.ka("SmartLookupEnableProdSourceLocationOverride")?
"PROD":m.AFrameworkApplication.fa.ka("SmartLookupEnableIntSourceLocationOverride")?"INT":Qc.Dgj()){case "INT":return"WAC.INT.URL";case "EDOG":return"WAC.EDOG.URL";default:return"WAC.PROD.URL"}}static Dgj(){switch(Object(Qa.a)(String,m.AFrameworkApplication.Od.AudienceGroup)||""){case "Dogfood":if(m.AFrameworkApplication.fa){let Cb=m.AFrameworkApplication.fa.Ha("UserPrincipalName");Cb=jc.a.rg(Cb);const oc=m.AFrameworkApplication.fa.Lu("SmartLookupINTEnabledForSKITeam")?m.AFrameworkApplication.fa.eA("SmartLookupINTEnabledForSKITeam"):
[];return 0<=Array.indexOf(oc,Cb)?"INT":"EDOG"}return"EDOG";default:return"PROD"}}}Object(h.a)(Qc,"Utils",null,[]);class td{constructor(Cb,oc=null){this.DK=this.Gp=this.iia=null;this.VOa=!1;this.TK=null;this.NK=Cb;this.DTb=oc?oc:new Ud;T.a.instance.qb("Common.App.SearchCommon.SearchHostRuntime")&&(this.TK=T.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").tae());this.aW=T.a.instance.resolve("Common.App.SearchCommon.ISearchHelper");this.c7a=this.aW.yab()}Pkb(Cb){if(this.TK){var oc=0;
this.Gp&&(oc=this.Gp.entryPoint);this.aW.z8b(this.DK,this.DTb,this.uUa(),oc).then(vc=>{da.Brd("SearchFromHost",this.DK);this.Gp.launchData||(this.Gp.launchData=new Da.a);const nd=ab();try{this.TK.search(this.Gp,vc,m.AFrameworkApplication.userSessionId,nd,Cb),this.aW.pfh(id=>{da.Brd("SearchFromHostWithToken",this.DK);this.TK.searchAuthenticatedProviders(this.Gp,vc,m.AFrameworkApplication.userSessionId,nd,null,id)})}catch(id){da.It("BaseSmartLookupPane - Fail to search from host. Error: "+id,10)}}).catch(vc=>
{da.It("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+vc.toString(),10)})}}zUe(){$addHandler(window,"message",Object(w.a)(this,this.jib,"onIFrameMessage"))}G8e(){$removeHandler(window,"message",Object(w.a)(this,this.jib,"onIFrameMessage"))}ZJb(Cb){Cb=I.c(Cb);document.getElementById(this.Cyb())&&document.getElementById(this.Cyb()).contentWindow.postMessage(Cb,Jb.a.DQ(Za()))}jib(Cb){let oc;Cb=Cb.rawEvent;try{oc=I.b(Cb.data)}catch(vc){D.ULS.sendTraceTag(509614105,
1303,15,this.Cka("Message data from Serplet [{0}] failed to deserialize.",Cb.data));return}switch(oc.actionType){case 103:Cb=I.b(Object(Qa.a)(String,oc.data));da.sendTelemetryEvent(Cb);break;case 206:this.aW.CXc(oc.data).then(vc=>{oc.data=vc;this.ZJb(oc)});break;case 112:oc.data.shiftPressed?(Wa.a.gg&&document.activeElement.blur(),this.NK.lYc(0,null,2,null,null),D.ULS.sendTraceTag(509614104,1303,50,this.Cka("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.NK.CUa(0,null,2,null,null),D.ULS.sendTraceTag(509614103,
1303,50,this.Cka("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.Iq()}}Cka(Cb,...oc){const vc={};this.DK&&(vc[G.SHh]=this.DK);vc[G.THh]=String.format.apply(null,[Cb].concat(oc));return I.c(vc)}wsc(Cb){da.wsc(this.DK,Math.round(window.performance.now()-Cb),this.Gp?Z.a[this.Gp.entryPoint]:"",this.aW.yab(),this.aW.R6f(),m.AFrameworkApplication.LJc,this.VOa,$b(this.Gp?this.Gp.entryPoint:0))}}td.bli="AppProperties";td.ezl="SmartLookupApplicationInterface";Object(h.a)(td,"BaseCopilotAddin",
null,[910,107]);class Md extends td{constructor(Cb,oc,vc,nd){if(!Cb)throw Error.argumentNull("actionManager");if(!oc)throw Error.argumentNull("appForOfficeManager");if(!nd)throw Error.argumentNull("f6Manager");super(nd,vc);this.Ab=!1;this.GHg=!0;this.myg="FA000000006";this.ia=Cb;this.Oc=oc;this.Is={};this.Hqk=Qc.gde();this.Is.sourceLocationOverrideResourceId=this.Hqk;this.Is.ZA="Copilot";this.Is.assetId=this.myg}i2e(Cb,oc){this.Gp=Cb;const vc=Object.assign(new M.a,{neighborhood:Cb.selection.neighborhood,
mentionStart:Cb.selection.mentionStart,mentionLength:Cb.selection.mentionLength});this.DK=oc;this.iia=vc;this.VOa=!vc.mentionLength;ja.SessionStatusManager.instance.Z_&&this.TK?(this.Pkb(!1),this.aW.z8b(this.DK,this.DTb,this.uUa(),Cb.entryPoint).then(nd=>{nd.isFirstLaunch=this.GHg;this.GHg=!1;const id={};id[td.ezl]=this.Gp;id[td.bli]=nd;this.Is.nonPersistedSettings=id;this.Is.c6=Object(w.a)(this,this.mib,"onPaneRendered");this.ia.Ka(sc.a.Oga,2,this.Is);this.Ab=!0})):(this.ia.Ka(sc.a.Oga,2,this.Is),
this.Ab=!0)}mib(){this.zUe()}Iq(){const Cb=this.Cyb();this.G8e();Cb&&this.ia&&this.ia.Ka(sc.a.Vub,2,Cb);this.Ab=!1}Drd(Cb,oc){this.Gp=Cb;this.iia=Cb=Object.assign(new M.a,{neighborhood:Cb.selection.neighborhood,mentionStart:Cb.selection.mentionStart,mentionLength:Cb.selection.mentionLength});this.VOa=!Cb.mentionLength;this.DK=oc;this.Pkb(!1)}dispose(){}Cyb(){if(this.Oc.instance){const Cb=this.Oc.instance.zQ(this.myg+"."+this.Is.sourceLocationOverrideResourceId);if(Cb)return Cb.instanceId;ud.a.J(509433935,
1313,15,"PPT Copilot Addin: Could not find task pane from ID.")}else ud.a.J(509433934,1313,15,"PPT Copilot Addin: AppForOfficeManager is unavailable.");return null}uUa(){return oa.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()?3:0}get isVisible(){return this.Ab}}Object(h.a)(Md,"PptCopilotAddin",td,[]);class Pd extends be{constructor(Cb,oc,vc,nd,id){super();this.wYg=Cb;this.Jb=vc;this.ia=nd;this.Oc=id}xOc(){const Cb=this.Jb.ka("822");return new Xa(new mc,n.a.instance,z.FocusManager.instance(),
T.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),T.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),T.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),Cb,T.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))}o0d(){return this.Jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCopilotAddin",!1)?new Md(this.ia,this.Oc,null,n.a.instance):super.o0d()}bab(){return this.wYg.getSelectedText()}dpg(){return this.wYg.iVj()}}
Object(h.a)(Pd,"SmartLookupManager",be,[]);var Be=d(152);class fe{constructor(Cb,oc,vc,nd,id,Nd,Ce){this.kU=Cb;this.Eb=oc;this.Hrk=vc;this.Upk=nd;this.Bqk=id;this.Hik=Nd;this.R_g=Ce;this.sHa=new Map;if(!Cb)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!oc)throw Error.argumentNull("m_transactionFactory");if(!vc)throw Error.argumentNull("m_textODSLEntity");if(!nd)throw Error.argumentNull("m_shapeODSLEntity");if(!id)throw Error.argumentNull("m_slideODSLEntity");if(!Nd)throw Error.argumentNull("m_imageODSLEntity");
if(!Ce)throw Error.argumentNull("m_tablesODSLEntity");this.kU&&this.kU.execute(af=>{this.Oc=af});this.sHa=new Map;this.sHa.set("text",this.Hrk);this.sHa.set("shapes",this.Upk);this.sHa.set("slides",this.Bqk);this.sHa.set("images",this.Hik);this.sHa.set("tables",this.R_g);this.sHa.set("table",this.R_g)}IGi(Cb,oc){return Object.assign({},...Cb.map(vc=>oc.has(vc.value)?{[vc.name]:oc.get(vc.value)}:{[vc.name]:JSON.parse(vc.value)}))}OQj(Cb){Object(Be.a)(this,void 0,void 0,function*(){if(this.Oc){var oc=
this.Eb.je(15);try{oc.hc(this.Oc.aO.presentation);const vc=new Map;for(const nd of Cb.statements){const id=nd.name.split("_");if(2!==id.length)throw Error.argumentOutOfRange("statement",id,"Provided ODSL statement does not have expected format of action_entity.");const Nd=id[0],Ce=id[1];if(!this.sHa.has(Ce))throw Error.argumentOutOfRange("entityName",Ce,"Provided entity name in ODSL statement is not supported.");const af=this.sHa.get(Ce);if(!af)throw Error.argumentOutOfRange("entity",af,"Could not access entity for provided ODSL statement.");
const de=this.IGi(nd.arguments,vc);if(!de)throw Error.argumentOutOfRange("args",de,"Could not construct ODSL statement input from provided args.");let $f;switch(Nd){case "select":$f=yield af.select(de);break;case "format":$f=yield af.format(de);break;case "insert":$f=yield af.insert(de);break;case "delete":$f=yield af.delete(de);break;case "default":throw Error.argumentOutOfRange("action",Nd,"Provided action in ODSL statement is not supported.");}nd.returnVariable&&$f&&vc.set(nd.returnVariable,$f)}}catch(vc){ud.a.J(509440020,
1313,15,`SmartLookup PPTSerpletExecutor executeCommand: Exception thrown while executing provided AST. ${vc}`)}finally{oc&&oc.dispose()}}else ud.a.J(509440021,1313,15,"SmartLookup ODSLInterpreter interpret: Skipping execution because no AppForOfficeManager instance exists.")})}}Object(h.a)(fe,"ODSLInterpreter",null,[844]);var Mf=d(48),Bd;(function(Cb){Cb.Idle="Idle";Cb.TranscribingVoice="TranscribingVoice";Cb.EndPending="EndPending";Cb.EndPendingWithCancel="EndPendingWithCancel";Cb.CancelPending=
"CancelPending"})(Bd||(Bd={}));Object(h.b)("DictationState",Bd);class Rc{constructor(Cb,oc,vc,nd,id){this.Tb=Cb;this.ia=oc;this.Dg=vc;this.Fa=nd;this.Wye=[];this.Q5c=[];this.DJ=Bd.Idle;this.d$c=!1;this.Sdb=Mf.a.$_d;this.onAction=Nd=>{if(Nd)switch(Nd.actionType){case "SubmitQuery":this.dGj(Nd.query);break;case "ToggleDictation":this.uCj();break;case "CancelQuery":this.cGj()}};this.m$d=()=>[this.Wye.join(" "),this.Q5c.join()].join(" ");if(!this.Tb)throw Error.argumentNull("m_workspace");if(!this.ia)throw Error.argumentNull("m_actionManager");
if(!this.Dg)throw Error.argumentNull("m_f6Manager");if(!this.Fa)throw Error.argumentNull("m_focusManager");if(!id)throw Error.argumentNull("actorFuture");id.execute(()=>{this.start().catch(Nd=>{D.ULS.sendTraceTag(509440287,1313,10,`Unable to start Copilot UX, error: ${Nd}`)})})}Hde(){this.bGj();return""}ocg(){return""}Iuc(){this.NFj();return!0}fEa(){this.ZAj()}BBf(Cb){this.fzj(Cb);return!0}skg(Cb){this.jBj(Cb);return!0}r4g(){}oMb(Cb){var oc,vc;D.ULS.sendTraceTag(509113183,1313,15,`Unexpected "${Cb}" called for Dictation FSM state: "${this.DJ}". Listening: "${this.d$c}"`);
this.d$c?(this.DJ=Bd.EndPending,this.Hwd()):(this.DJ=Bd.Idle,null===(vc=null===(oc=this.hHa)||void 0===oc?void 0:oc.setMicState)||void 0===vc?void 0:vc.call(oc,!1))}XNh(Cb){var oc,vc;null===(vc=null===(oc=this.hHa)||void 0===oc?void 0:oc.setMicState)||void 0===vc?void 0:vc.call(oc,Cb)}bGj(){this.DJ!==Bd.Idle&&this.DJ!==Bd.EndPending?this.oMb("handleTextBeforeSelection"):(this.DJ=Bd.TranscribingVoice,this.XNh(!0))}NFj(){this.DJ!==Bd.TranscribingVoice&&this.DJ!==Bd.EndPending?this.oMb("handleStartTurn"):
this.DJ=Bd.TranscribingVoice}ZAj(){switch(this.DJ){case Bd.EndPending:case Bd.EndPendingWithCancel:this.XNh(!1);const Cb=this.m$d();0<Cb.length&&this.DJ===Bd.EndPending&&this.oah(Cb);this.Wye=[];this.Q5c=[];this.DJ=Bd.Idle;break;case Bd.CancelPending:this.DJ=Bd.EndPendingWithCancel;break;case Bd.TranscribingVoice:this.DJ=Bd.EndPending;break;case Bd.Idle:break;default:this.oMb("handleEndTurn")}}gGj(){this.DJ!==Bd.TranscribingVoice?this.oMb("handleTimeout"):this.DJ=Bd.CancelPending}fzj(Cb){var oc,vc;
this.DJ!==Bd.TranscribingVoice?this.oMb("handleAppendText"):this.hHa&&(this.Q5c.push(Cb),null===(vc=(oc=this.hHa).setQuery)||void 0===vc?void 0:vc.call(oc,this.m$d()))}jBj(Cb){var oc,vc;this.DJ!==Bd.TranscribingVoice?this.oMb("handleFinalText"):(this.Q5c=[],""===Cb?this.gGj():this.hHa&&(this.Wye.push(Cb),null===(vc=(oc=this.hHa).setQuery)||void 0===vc?void 0:vc.call(oc,this.m$d())))}dGj(Cb){this.DJ!=Bd.Idle?this.Hwd():this.oah(Cb)}cGj(){this.DJ!==Bd.Idle&&(this.Hwd(),this.DJ=Bd.CancelPending)}uCj(){this.Hwd()}Hwd(){this.ia.Ka(Hc.a.Umb,
2,{vTf:Rc.jSh});this.d$c=!this.d$c}oah(Cb){Cb=Object.assign(new fa.a,{selection:Object.assign(new aa.a,{neighborhood:Cb,mentionStart:0,mentionLength:Cb.length}),launchData:Object.assign(new Da.a,{landingTab:"Copilot"}),entryPoint:0});this.ia.Ka(Na.a.Y_c,2,Cb)}Sdj(){var Cb;this.Jeb||(this.Jeb=document.createElement("div"),this.Jeb.id="copilotHost",(null!==(Cb=document.getElementById(Rc.tvi))&&void 0!==Cb?Cb:document.body).appendChild(this.Jeb));return this.Jeb}oql(){this.Fa.t_b(this.Sdb);const Cb=
this.Fa.Fc(this.Sdb);Cb.parent=Ca.AFrame.Xi;Cb.uJ=!0;Cb.f8(()=>{var oc;null===(oc=this.hHa)||void 0===oc?void 0:oc.focus()});this.Dg.bja(this.Sdb);this.Dg.DI(this.Sdb);this.Jeb.addEventListener("focusin",oc=>{var vc;oc.preventDefault();oc.stopPropagation();(null===(vc=this.Fa.Ee)||void 0===vc?void 0:vc.name)!==this.Sdb&&this.Fa.XU(this.Sdb,!1)});this.Jeb.addEventListener("focusout",oc=>{var vc,nd,id;oc.preventDefault();oc.stopPropagation();for(oc=null!==(vc=oc.relatedTarget)&&void 0!==vc?vc:document.activeElement;oc;){if(oc===
this.Jeb)return;oc=oc.parentElement}null===(id=null===(nd=this.hHa)||void 0===nd?void 0:nd.collapse)||void 0===id?void 0:id.call(nd);this.Fa.q1(this.Sdb,!1)})}start(){return Object(Be.a)(this,void 0,void 0,function*(){const Cb=this.Sdj();this.hHa=yield(yield Bb.UISurfaces.Rdj()).renderCopilot(Cb,{onAction:this.onAction});if(!this.hHa)throw Error("Copilot control interface is not returned.");this.oql()})}}Rc.tvi="WACViewPanelContainer";Rc.jSh="PowerPointWebEditor.SmartLookup.FABDictationHost";Object(h.a)(Rc,
"PptCopilot",null,[546]);var Gf=d(980),Nf=d(976),Oa=d(979),cb=d(1075),Ic=d(975),qd=d(992),le=d(339),yb=d(981);class ef extends Ub{constructor(){super()}get name(){return"Ppt.SmartLookup"}init(){m.AFrameworkApplication.yza&&this.KWi()}Yb(Cb){super.Yb(Cb);Cb.register(Mc.a,"Box4.Insights.Box4InsightsSelection").as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").ma().oa(()=>new Mc.a);Cb.register(Pd,"PowerPointWebEditor.SmartLookup.SmartLookupManager").as("Common.App.Insights.IInsightsManager").ma().oa(()=>
new Pd(Cb.resolve("Common.App.Insights.IInsightsSelection"),Cb,Cb.resolve("Common.IAppSettingsManager"),Cb.resolve("Common.IActionManagerExtended"),Cb.Ia("PowerPointWebEditor.IAppForOfficeManager")));Cb.register(821,"Common.App.SearchCommon.IDocumentContentExecutor").as("Common.App.SearchCommon.IDocumentContentExecutor").ma().oa(()=>new Zb.a(new e.a(()=>zc.App.Lb?zc.App.Lb.Kd.Di:null),Pc.InteractiveViewManager.instance,Cb.resolve("Box4.ISelectionFactory"),Cb.resolve("PowerPointWebEditor.ISlideReader"),
Cb.resolve("PowerPointWebEditor.IPPTWorkspace"),Cb.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),new r.a,Cb.resolve("Common.IActionManagerExtended"),Cb.resolve("PowerPointWebEditor.IPptSelectionManager"),Cb.resolve("PowerPointWebEditor.IClipServiceManager"),Cb.resolve("PowerPointWebEditor.IPresentationReader")));m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableHALO",!1)&&(Cb.register(le.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper").as("PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper").ma().oa(()=>
new le.a(Cb.resolve("Box4.Graph.IGraphIteratorFactory"),Cb.resolve("Box4.IOutlineEditor"),Cb.resolve("Box4.IOutlineElementNavigator"),Cb.resolve("Box4.ICharacterPropertiesEditor"))),Cb.register(Ic.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText").ma().oa(()=>new Ic.a(Cb.Ia("PowerPointWebEditor.AppForOfficeManager"),Cb.resolve("PowerPointWebEditor.IPptSelectionManager"),Cb.resolve("Box4.IFormattingEditor"),Cb.resolve("Box4.IParagraphEditor"),
Cb.resolve("PowerPointWebEditor.IShapeReader"),Cb.resolve("Box4.List.IListEditor"),Cb.resolve("Box4.ICharacterPropertiesEditor"),Cb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper"))),Cb.register(Nf.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape").ma().oa(()=>new Nf.a(Cb.Ia("PowerPointWebEditor.AppForOfficeManager"),Cb.resolve("PowerPointWebEditor.IPptSelectionManager"),Cb.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),
Cb.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),Cb.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),Cb.resolve("PowerPointWebEditor.IShapeReader"),Cb.resolve("PowerPointWebEditor.IShapeEditor"),Cb.resolve("PowerPointWebEditor.IPPTUnitConversion"),Cb.resolve("PowerPointWebEditor.View.IPPTPageView"),Cb.resolve("PowerPointWebEditor.IGraphTransactionHelper"),Cb.resolve("PowerPointWebEditor.IRibbonChangeManager"))),Cb.register(Oa.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide").ma().oa(()=>
new Oa.a(Cb.Ia("PowerPointWebEditor.AppForOfficeManager"),Cb.resolve("PowerPointWebEditor.IPptSelectionManager"),Cb.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),Cb.resolve("PowerPointWebEditor.Graph.IGraphOperationEventNotifier"))),Cb.register(Gf.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage").ma().oa(()=>new Gf.a(Cb.Ia("PowerPointWebEditor.AppForOfficeManager"),Cb.resolve("PowerPointWebEditor.IPptSelectionManager"))),
Cb.register(cb.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable").ma().oa(()=>new cb.a(Cb.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Cb.resolve("PowerPointWebEditor.IPptSelectionManager"),Cb.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),Cb.resolve("PowerPointWebEditor.IFocusManager"),Cb.resolve("PowerPointWebEditor.IShapeEditor"),Cb.resolve("PowerPointWebEditor.IRibbonChangeManager"),Cb.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),
Cb.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),Cb.resolve("Common.IActionManagerExtended"),Cb.resolve("PowerPointWebEditor.IGraphTransactionHelper"),Cb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper"))),Cb.register(qd.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLContext").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Interfaces.IODSLContext").ma().oa(()=>new qd.a(Cb.Ia("PowerPointWebEditor.AppForOfficeManager"),Cb.resolve("PowerPointWebEditor.IPptSelectionManager"),
Cb.resolve("PowerPointWebEditor.IShapeReader"))),Cb.register(fe,"PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLInterpreter").as("PowerPointWebEditor.SmartLookup.ODSLBox4.IODSLInterpreter").ma().oa(()=>new fe(Cb.Ia("PowerPointWebEditor.AppForOfficeManager"),Cb.resolve("Common.Transaction.ITransactionFactory"),Cb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText"),Cb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape"),Cb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide"),
Cb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage"),Cb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable"))),Cb.register(yb.a,"PowerPointWebEditor.SmartLookup.Recommendations.SmartRecommendations").as("PowerPointWebEditor.SmartLookup.Recommendations.SmartRecommendations").ma().oa(()=>new yb.a(Cb.resolve("PowerPointWebEditor.IPptSelectionManager"),Cb.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Cb.resolve("Common.Transaction.ITransactionFactory"),
Cb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText"),Cb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape"),Cb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide"),Cb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable"),Cb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage"))));Cb.register(822,"Common.App.SearchCommon.ISerpletExecutor").as("Common.App.SearchCommon.ISerpletExecutor").ma().oa(()=>new od(Cb.resolve("Common.IActionManagerExtended"),
Cb.qb("PowerPointWebEditor.SmartLookup.ODSLBox4.IODSLInterpreter"),Cb.qb("PowerPointWebEditor.SmartLookup.ODSLBox4.Interfaces.IODSLContext")));Cb.register(823,"Common.App.SearchCommon.IInsertContentExecutor").as("Common.App.SearchCommon.IInsertContentExecutor").ma().oa(()=>new lb(m.AFrameworkApplication.Ra,Cb.resolve("PowerPointWebEditor.IPptSelectionManager"),Cb.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));Cb.register(824,"Common.App.SearchCommon.IDocumentHelper").ma().oa(()=>new Ad);
m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.CopilotUxIsEnabled",!1)&&(Cb.register(Rc,"PowerPointWebEditor.SmartLookup.PptCopilot").as("PowerPointWebEditor.SmartLookup.PptCopilot").as("PowerPointWebEditor.SmartLookup.FABDictationHost").ma().oa(()=>new Rc(Cb.resolve("PowerPointWebEditor.IPPTWorkspace"),Cb.resolve("Common.IActionManagerExtended"),n.a.instance,z.FocusManager.instance(),Cb.Ia("Common.App.Insights.InsightsActor"))),Cb.resolve("PowerPointWebEditor.SmartLookup.PptCopilot"))}static main(){v.a.instance.Ac(new ef)}}
Object(h.a)(ef,"PptSmartLookupPackage",Ub,[]);Type.registerNamespace("PowerPointWebEditor.SmartLookup");ef.main()}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19809348/wdjs/ppteditDS.smartlookup.js.map