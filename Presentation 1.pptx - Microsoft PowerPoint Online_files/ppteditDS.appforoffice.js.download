'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1E3:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.LCa=this.Wmb=this.uae=this.Tde=this.R8b=this.t5e=null}}Object(K.a)(h,"AppsForOfficeOauthResult",null,[])},1001:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);class h{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=
this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static b4f(e){switch(e){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(K.a)(h,"WopiAuthContext",null,[869])},1288:function(K,U,d){d.r(U);var h=d(0),e=d(18),r=d(392),m=d(272);class n{constructor(){this.hVh=new e.a}get ALc(){return this.hVh}Mmj(F){r.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",F);const V=
new e.a;for(let za of this.ALc)for(let gb of za.hmc)gb.id===F&&V.add(gb);return V}zri(){var F=this.Mmj("ContextMenuText");if(F&&0<F.count){const V=Object.assign(new m.a,{ControlList:[]});for(let za of F)F=za.awc(),0<F.length&&Array.addRange(V.ControlList,F);return V}return null}dxf(F){this.ALc.add(F)}G5k(F){for(let V of this.ALc)if(V.yAf===F.yAf){this.ALc.remove(V);break}}static AUi(F,V,za=null){F=n.Ddj(F);0<F.length&&(n.isd(F,!1),za&&za(V,F))}static Ddj(F){const V=[];if(F&&F.hmc&&0<F.hmc.count)for(let za of F.hmc)if(za.controls&&
0<za.controls.count)for(let gb of za.controls)if(gb.menuItems&&0<gb.menuItems.count)for(let Fb of gb.menuItems)Array.add(V,Fb.id);return V}static isd(F,V){if(F.length){var za=[];for(const gb of F)za.push(appChrome.actions.updateControlEnabledDisabledState(gb,V));appChrome.api.dispatch(za)}}}Object(h.a)(n,"ContextMenuExtensibilityCache",null,[702,703]);var z=d(27),v=d(377),x=d(107),B=d(71),D=d(7);class w{constructor(F,V,za){this._id=F;this.ITh=V;this.QVh=za;this.ylg=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get FTd(){return this.ITh}get jDi(){return this.QVh}execute(F,
V,za){za=za||{};za.commandMode=this.ylg;V.invokeAppCommand(this.FTd,this.jDi,za,(gb,Fb)=>{F.D$g(this.id,this.FTd,gb,Fb)})}}Object(h.a)(w,"AddinNativeActionBase",null,[722]);class J extends w{constructor(F,V){super(1,F,V);this.ylg=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(h.a)(J,"AddinTakeSnapshotAction",w,[]);class G{jOf(F,V){let za=null;switch(F){case 1:za=new J(V,this.f9d().getNativeActionName(F));break;case 2:za=new w(2,V,this.f9d().getNativeActionName(F));break;case 3:za=new w(3,V,this.f9d().getNativeActionName(F))}return za}f9d(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}
Object(h.a)(G,"AddinNativeActionManager",null,[685]);class M{invokeAppCommand(F,V,za,gb){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(F,V,za,gb)}static getInstance(){M.La||(M.La=new M);return M.La}}M.La=null;Object(h.a)(M,"OSFAddinCommandsRuntimeManager",null,[686]);var N=d(77);class R{constructor(){this.CVf=this.displayName=this.M2b=this.WH=this.QM=null;this.isUpgraded=!1}xrg(F,V){return this.QM.getStoreType().toLowerCase()===F.toLowerCase()&&this.QM.getSolutionId().toLowerCase()===V.toLowerCase()}}
Object(h.a)(R,"AddinCommandsResourceItem",null,[]);class C{constructor(){this.FAd=null;this.GFd=0;this.eHd=!1;this.Ma=new N.a;this.q_h=new e.a}Sei(F){this.Ma.addHandler("AddinCommandsLoadingMessageChanged",F)}get G_b(){return this.FAd}hOb(F){F!==this.FAd&&(this.FAd=F,this.Ma.raiseEvent("AddinCommandsLoadingMessageChanged"))}ojl(){this.GFd++;this.G_b||this.hOb(CommonUIStrings.l_LoadingAddInsTitle)}MZe(){this.GFd--;this.O4c()&&(this.eHd?this.G_b!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.hOb(CommonUIStrings.l_ErrorLoadingAddInsTitle):
this.hOb(null))}Hkl(){this.eHd=!0;this.hOb(CommonUIStrings.l_ErrorLoadingAddInsTitle)}XJf(){this.eHd=!1;this.O4c()?this.hOb(null):this.hOb(CommonUIStrings.l_LoadingAddInsTitle)}O4c(){return 0>=this.GFd}get nAb(){return this.q_h}l$a(F,V,za=0){for(let gb of this.nAb)if(gb.xrg(F,V)&&(!gb.WH||gb.WH.n$i===za))return gb;return null}Qxf(F,V,za,gb){const Fb=new R;Fb.QM=F;Fb.WH=V;Fb.M2b=za;Fb.displayName=gb;this.nAb.add(Fb)}Qci(F,V,za,gb){const Fb=new R;Fb.QM=F;Fb.WH=V;Fb.M2b=null;Fb.CVf=za;Fb.displayName=
gb;this.nAb.add(Fb)}o5k(F,V){let za=0;for(let gb of this.nAb)gb.QM.getStoreType()===F&&gb.QM.getSolutionId()===V?this.nAb.removeAt(za):za++}static getInstance(){C.La||(C.La=new C);return C.La}}C.La=null;Object(h.a)(C,"AddinCommandsResourceManager",null,[]);var O=d(194),S=d(452),T=d(170),ca=d(142);class L extends Sys.EventArgs{constructor(){super();this.WH=this.Qu=null}}Object(h.a)(L,"InsertionParamEventArgs",Sys.EventArgs,[]);class da{constructor(F,V,za,gb,Fb,Ec){this.Ew=F;this.Qu=V;this.Qaa=za;this.displayName=
Fb;this.gug=Ec}}Object(h.a)(da,"PostLaunchAddinCommandsParameters",null,[]);var Z=d(36),fa=d(47),aa=d(1244);class ja{constructor(F,V,za,gb=null){this.Orc=z.AFrameworkApplication.fa.Ha("RoamingServiceHandlerWebServiceBase");this.appName=F;this.IUb=V;this.FUb=za;this.AXb=gb}RRc(F){this.C0i(F,Object(D.a)(this,this.ZEa,"getRequestSuccessCallback"),Object(D.a)(this,this.Uka,"getRequestFailureCallback"))}C0i(F,V,za){const gb=new Sys.StringBuilder(this.Orc);gb.append("RoamingServiceHandler.ashx?action=");
gb.append("getAddinTeachingCalloutSettings");gb.append("&");gb.append(this.fce(F));gb.append("&");gb.append(z.AFrameworkApplication.gh);z.AFrameworkApplication.Me.zj(gb.toString(),1,null,null,!0,2,V,za,null)}Lwb(F){this.J0i(F)}J0i(F){var V=new Sys.StringBuilder(this.Orc);V.append("RoamingServiceHandler.ashx?action=");V.append("saveAddinTeachingCalloutSettings");V.append("&");V.append(z.AFrameworkApplication.gh);V=V.toString();F=Z.c(F);z.AFrameworkApplication.Me.zj(V,2,F,null,!0,4,null,Object(D.a)(this,
this.Eaa,"postRequestFailureCallback"),null)}ZEa(F){let V=!1,za=null;try{if(0<F.data.ee.length){const gb=Object(aa.a)(Object,Z.a(F.data.ee)),Fb=gb?gb[this.appName]:null;Fb&&(za=Object(aa.a)(Object,Z.a(Fb.toString())))}V=!0}catch(gb){this.Uka(null)}V&&this.IUb&&this.IUb(za)}Uka(F){this.FUb&&this.FUb(F?F.data:null)}Eaa(F){this.AXb&&this.AXb(F?F.data:null)}fce(F){const V=new Sys.StringBuilder("requestedsettings=");for(let za=0;za<F.count;za++)V.append(F.ga(za)),za<F.count-1&&V.append(";");return V.toString()}}
Object(h.a)(ja,"AddinTeachingUIRoamingRequestHandler",null,[]);var I=d(171);class sa{constructor(F,V,za){this.Nrc=!1;this.Mba=null;this.Ma=F;this.iVb=V;this.dSb=za}hSd(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",Object(D.a)(this,this.rMe,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(D.a)(this,this.FLe,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(D.a)(this,this.qLe,"onCloseButtonClickedEventHandler"),
!0),window.addEventListener("FGWebSurfaceEvent",Object(D.a)(this,this.pmc,"onCampaignLaunchedHandler"),!0)):r.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}rMe(){const F={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:sa.aJ(this.iVb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};this.dSb&&this.dSb.tabs&&!this.dSb.tabs[0].isOfficeTab&&(F["SDX.FeatureFlags"]="NonOfficeTab");ca.a.sendTelemetryEvent(Object.assign(new I.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:T.a.kz(F)}));this.yJa();this.dSb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.dSb,()=>{const V=new L;V.Qu=this.iVb;this.Ma.raiseEvent(O.a.tre,V)}):r.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}qLe(){const F={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:sa.aJ(this.iVb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};
ca.a.sendTelemetryEvent(Object.assign(new I.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:T.a.kz(F)}));this.yJa()}FLe(){const F={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:sa.aJ(this.iVb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ca.a.sendTelemetryEvent(Object.assign(new I.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:T.a.kz(F)}));this.yJa()}pmc(F){if(F&&(F=F.detail)&&F.id&&this.Cme(F.id)){const za=
(F.action||"").toLowerCase();if(F.success&&"opened"===za){var V={["AppTeachingUICalloutAction"]:"CampaignLaunched",["SDX.Id"]:sa.aJ(this.iVb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ca.a.sendTelemetryEvent(Object.assign(new I.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:T.a.kz(V)}));r.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming.");this.yJa();window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",
Object(D.a)(this,this.pmc,"onCampaignLaunchedHandler"),!0)}else try{V=JSON.stringify(F),r.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+V)}catch(gb){V="id : "+F.id+" telemetryEventName: "+F.telemetryEventName,r.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+V+" Error: "+(gb?gb.toString():""))}}}Cme(F){F=fa.a.rg(F);return-1!==F.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==F.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==F.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||
-1!==F.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==F.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==F.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}V0a(F){const V=z.AFrameworkApplication.fa.Ha("WebAppShortName");if(V){const za={},gb={};gb.LastTeachingUIShowTime=(new Date).toUTCString();gb.AddinHasShown=F;za[V]=Z.c(gb);this.Mba=new ja(V,null,null,Object(D.a)(this,this.Eaa,"postRequestFailureCallback")),this.Mba.Lwb(za),r.ULS.sendTraceTag(523535564,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else r.ULS.sendTraceTag(523535565,
220,10,"Fail to save roaming service since AppName is null")}yJa(){if(!this.Nrc){const F=window.g_roamingAddinList;F&&(this.V0a(F),this.Nrc=!0)}}Eaa(F){r.ULS.sendTraceTag(523535566,220,10,"failed to POST data to Roaming Settings Service with status: {0}",F?F.Ke:-1)}static aJ(F){return Telemetry.PrivacyRules.GetPrivacyCompliantId(F.solutionId,F.storeType,F.assetId,null,null,F.storeId)}}Object(h.a)(sa,"PrivateCatalogTeachingCalloutHandler",null,[]);var ka=d(15),Ma=d(16),Ea=d(988);class ma{constructor(){this.addinId=
null;this.targetType=0;this.solutionId=null}}Object(h.a)(ma,"AddinAbstract",null,[]);class va extends Sys.EventArgs{constructor(F){super();this.solutionId=F.solutionId;this.assetId=F.assetId;this.storeType=F.storeType;this.storeId=F.storeId;this.assetStoreId=F.assetStoreId;this.targetType=F.targetType;this.width=F.width;this.height=F.height;this.displayName=F.displayName;this.version=F.version}}Object(h.a)(va,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);var Ca=d(126);class oa{constructor(F){this.Tsb=
this.Qu=null;this.Nrc=!1;this.ZNa=this.myc=this.VKa=this.Ui=this.Mba=this.K1=null;this.Lp=F}get appName(){return z.AFrameworkApplication.fa.Ha("WebAppShortName")}get aAf(){this.Mba||(this.Mba=new ja(this.appName,Object(D.a)(this,this.ZEa,"getRequestSuccessCallback"),Object(D.a)(this,this.Uka,"getRequestFailureCallback"),Object(D.a)(this,this.Eaa,"postRequestFailureCallback")));return this.Mba}get PQa(){this.myc||(this.myc=new e.a);return this.myc}set PQa(F){this.myc=F}get P8a(){this.ZNa||(this.ZNa=
new e.a);return this.ZNa}set P8a(F){this.ZNa=F}hSd(F,V){window.addEventListener?(this.Qu=F,this.Tsb=V,window.addEventListener("LaunchAddinTaskpane",Object(D.a)(this,this.rMe,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(D.a)(this,this.FLe,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(D.a)(this,this.qLe,"onCloseButtonClickedEventHandler"),!0),window.addEventListener("FGWebSurfaceEvent",Object(D.a)(this,this.pmc,"onCampaignLaunchedHandler"),
!0)):r.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}KIl(F,V,za,gb){this.Ui=F;this.PQa=V;this.P8a=za;this.VKa=gb;r.ULS.sendTraceTag(0,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",V?V.count.toString():"null",za?za.count.toString():"null");0<this.PQa.count||0<this.P8a.count?(F=new e.a,F.add(this.appName),this.aAf.RRc(F)):this.VKa(new e.a,null)}rMe(){const F=new ka.ScriptSharpLegacyMap;this.Tsb&&
this.Tsb.tabs&&!this.Tsb.tabs[0].isOfficeTab&&F.$("SDX.FeatureFlags","NonOfficeTab");this.LGa(oa.aJ(this.Qu),"ClickOnLaunch",F);this.yJa();this.Tsb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.Tsb,()=>{const V=new L;V.Qu=this.Qu;this.Lp.raiseEvent(O.a.tre,V)}):r.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}qLe(){this.LGa(oa.aJ(this.Qu),"ClickOnClose");this.yJa()}FLe(){this.LGa(oa.aJ(this.Qu),"ClickOnDismiss");this.yJa()}pmc(F){if(F&&
(F=F.detail)&&F.id&&this.Cme(F.id)){const V=(F.action||"").toLowerCase();if(F.success&&"opened"===V)this.LGa(oa.aJ(this.Qu),"CampaignLaunched"),r.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.yJa(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",Object(D.a)(this,this.pmc,"onCampaignLaunchedHandler"),!0);else{let za;try{za=JSON.stringify(F),r.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+za)}catch(gb){za=
"id : "+F.id+" telemetryEventName: "+F.telemetryEventName,r.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+za+" Error: "+(gb?gb.toString():""))}}}}Cme(F){F=fa.a.rg(F);return-1!==F.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==F.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==F.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==F.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==F.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==F.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}V0a(F){if(this.appName){const V=
{},za={};za.LastTeachingUIShowTime=(new Date).toUTCString();za.AddinHasShown=F;V[this.appName]=Z.c(za);this.aAf.Lwb(V);r.ULS.sendTraceTag(539530527,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else r.ULS.sendTraceTag(539530528,220,10,"Fail to save roaming service since AppName is null")}yJa(){if(!this.Nrc){const F=window.g_roamingAddinList;F&&(this.V0a(F),this.Nrc=!0)}}ZEa(F){F?this.u1e(F)?(r.ULS.sendTraceTag(527523845,220,50,"should show teaching UI"),
this.K1="AddinHasShown"in F&&F.AddinHasShown?F.AddinHasShown.toString():null,this.y2b()):(r.ULS.sendTraceTag(538248466,220,50,"Not Show TeachingUI this time"),this.VKa(this.PQa,null)):(r.ULS.sendTraceTag(527523844,220,50,"userSettings is null"),this.K1=null,this.y2b())}Uka(F){r.ULS.sendTraceTag(539530529,220,10,"GET data from Roaming Settings Service with status: {0}, fallback",F?F.Ke:-1);this.VKa(this.PQa,null)}Eaa(F){r.ULS.sendTraceTag(539530530,220,10,"failed to POST data to Roaming Settings Service with status: {0}",
F?F.Ke:-1)}y2b(){const F=this.o3d();0===F.targetType?(F.solutionId?this.KRe(F):this.LGa(null,"NoSolutionId"),this.wOh(F),this.VKa(this.PQa,null)):this.VKa(this.PQa,F);r.ULS.sendTraceTag(528023563,220,50,"Show teaching callout for: {0}",F.addinId)}KRe(F){const V=new Ea.a;V.callbackFunc=za=>{if(za.errorCode){this.LGa(F.solutionId,"FailToGetAppDetails");var gb=window.g_roamingAddinList;gb&&this.V0a(gb)}else if(za.value)for(gb of za.value)if(za=gb[1],za===F.solutionId){const Fb={};Fb.solutionId=za;Fb.assetId=
gb[5];Fb.storeType=gb[12];Fb.storeId=gb[11];Fb.assetStoreId=gb[6];Fb.targetType=gb[3];Fb.width=gb[7];Fb.height=gb[8];Fb.displayName=gb[0];Fb.version=gb[4];r.ULS.sendTraceTag(0,220,50,"Raise a teaching callout event for content addin: {0}.",F.solutionId);gb=new va(Fb);this.Lp.raiseEvent(O.a.H1e,gb);break}};V.storeType=OSF.StoreTypeEnum.PrivateCatalog;V.fromInsertDialog=!1;V.refresh=!1;this.Ui.queryEntitlementDetails(V)}u1e(F){if("LastTeachingUIShowTime"in F){if(F=+new Date-+new Date(F.LastTeachingUIShowTime.toString()),
F<z.AFrameworkApplication.fa.CQ("AddinShowTeachingUIIntervalInMS",864E5))return r.ULS.sendTraceTag(538248467,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",F),!1}else r.ULS.sendTraceTag(527523846,220,50,"userSetting has no date key");return!0}o3d(){let F=new Ma.a(new ma,0),V=new Ma.a(new ma,0),za=0,gb=0,Fb=0;var Ec=new e.a;for(var $c of this.PQa)Ec.add($c);for(let Ed of this.P8a)Ec.add(Ed);for(let Ed of Ec)if(!("excatalog"!==Ed.storeType||Ca.b(Ed.installTimeInMS)||!Ed.installTimeInMS||
Ed.installTimeInMS<=z.AFrameworkApplication.fa.CQ("DateTimeInMSForNewAddin",16409952E5))){Ec=oa.V6b(Ed);if(this.K1&&($c=this.K1.split(","),0<$c.length&&Array.contains($c,Ec))){Fb++;r.ULS.sendTraceTag(528345032,220,50,"This addin has shown teaching UI before");continue}Ec.startsWith("private_")?(F=oa.F8f(Ed,F),gb++):(V=oa.F8f(Ed,V),za++)}r.ULS.sendTraceTag(528345033,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",gb,za,Fb);return 0<V.value?V.key:
0<F.value?F.key:Object.assign(new ma,{addinId:null,targetType:-1,solutionId:null})}LGa(F,V,za=null){F={["AppTeachingUICalloutAction"]:V,["SDX.Id"]:F,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(za)for(let gb of za.keys)F[gb]=za.ga(gb);ca.a.sendTelemetryEvent(Object.assign(new I.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:T.a.kz(F)}))}wOh(F){F&&(window.g_roamingAddinList=this.K1?this.K1+","+F.addinId:F.addinId)}static aJ(F){return Telemetry.PrivacyRules.GetPrivacyCompliantId(F.solutionId,
F.storeType,F.assetId,null,null,F.storeId)}static F8f(F,V){return V.value<F.installTimeInMS?new Ma.a(Object.assign(new ma,{addinId:oa.V6b(F),targetType:F.targetType,solutionId:F.solutionId}),F.installTimeInMS):V}static V6b(F){return Telemetry.PrivacyRules.IsPrivateAddin(F.storeType,F.assetId,null,null,F.storeId)?"private_"+F.installTimeInMS:F.solutionId}}Object(h.a)(oa,"PrivateCatalogTeachingCalloutHandler2",null,[]);class Da{constructor(F){this.GId=null;this.Pif=F}get yWa(){return this.GId}Dsb(F,
V=null){this.Pif.Dsb(F,V);this.GId=F}hVe(F){this.Pif.hVe(F)}$wh(F){this.GId=F}}Object(h.a)(Da,"RibbonExtensibilityManagerWithChangeDetection",null,[743]);var ta=d(81);const ha=()=>{const F=ta.a.Fyb(window.location.href.toLowerCase(),"wdomexsrctype");return!!F&&"4"===F},Ha=()=>ta.a.Fyb(window.location.href.toLowerCase(),"wdtpl"),bb=()=>{const F=ta.a.Fyb(window.location.href.toLowerCase(),"wdomexsrctype");return!!F&&"1"===F},Na=F=>{let V=null;switch(F){case 0:V="omex";break;case 1:V="spcatalog";break;
case 2:V="spapp";break;case 3:V="filesystem";break;case 4:V="exchange";break;case 6:V="registry";break;case 7:V="inmemory";break;case 8:V="uploadfiledevcatalog";break;case 9:V="hardcodedpreinstall";break;case 10:V="excatalog";break;case 16:V="wopicatalog"}return V},Ia=F=>{let V=-1;switch(F.toLowerCase()){case "omex":V=0;break;case "spcatalog":V=1;break;case "spapp":V=2;break;case "filesystem":V=3;break;case "exchange":V=4;break;case "registry":V=6;break;case "inmemory":V=7;break;case "uploadfiledevcatalog":V=
8;break;case "hardcodedpreinstall":V=9;break;case "excatalog":V=10;break;case "wopicatalog":V=16}return V};class Qa{constructor(){this.title=this.id=this.tabs=null}}Object(h.a)(Qa,"AddInDataTransferObject",null,[]);class qa{constructor(F,V,za){this.kyc=F;this.ETh=V;this.FTh=za}get HF(){return this.kyc}get uci(){return this.ETh}get vci(){return this.FTh}static Dxb(F){return(F=F.zaa)?Object.assign(new Qa,{tabs:F.HF.toArray(),id:F.uci,title:F.vci}):null}}Object(h.a)(qa,"OneLineRibbonExtensibility",null,
[]);class Wa{Dsb(F,V=null){if(F=qa.Dxb(F)){appChrome.addInApi.dispatchActionsToInstallAddIn(F,V);for(const za of F.tabs)if(za.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(F,()=>{});break}}}hVe(F){(F=qa.Dxb(F))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(F)}$wh(){}static GUi(F,V,za=null){F=Wa.Kpj(F);0<F.length&&(Wa.isd(F,!1),za&&za(V,F))}static Kpj(F){const V=[];if(F&&(F=F.zaa,F.HF&&0<F.HF.count))for(let za of F.HF)if(za.groups&&0<za.groups.length)for(const gb of za.groups)if(gb.controls&&
0<gb.controls.length)for(const Fb of gb.controls)Array.add(V,Fb.id);return V}static isd(F){if(F.length){var V=[];for(const za of F)V.push(appChrome.actions.updateControlEnabledDisabledState(za,!0));appChrome.api.dispatch(V)}}}Object(h.a)(Wa,"OneLineRibbonExtensibilityManager",null,[743]);class Hb{constructor(){this.Ver=1}}Object(h.a)(Hb,"CacheItem",null,[]);class jc{constructor(){}}Object(h.a)(jc,"AppsDataCacheManager",null,[723]);class gc{constructor(){new jc(v.a.instance)}Uvh(F,V){F=O.a.f7f()+F;
v.a.instance.setItem(F,V.toString())}E$f(){var F=O.a.H$f();r.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",F);F=v.a.instance.getItem(F);return Z.a(F)}Cxh(F){const V=O.a.H$f();r.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",V);v.a.instance.setItem(V,Z.c(F))}xpg(){return!!v.a.instance.localStorage}static get instance(){gc.La||(gc.La=new gc);return gc.La}}gc.La=null;Object(h.a)(gc,"AddInCommandsCacheManager",null,[687]);var $b=d(548),wb=d(72);class Db{static M7f(F){const V=new e.a;if(Db.mMf)for(var za of Db.mMf)V.add(za);
za=null;switch(F){case "Workbook":za=Db.vVl;break;case "Document":za=Db.kWi;break;case "Presentation":za=Db.XSk}if(za)for(const gb of za)V.add(gb);return V}}Db.mMf=["PrimaryCommandSurface","ContextMenu"];Db.vVl=null;Db.kWi=null;Db.XSk=null;Object(h.a)(Db,"ExtensionPointType",null,[]);class Xb{constructor(F){this.Bof=null;if(Ca.b(F))throw r.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.PTh=F}get hmc(){return this.Bof||
(this.Bof=new e.a)}get yAf(){return this.PTh}}Object(h.a)(Xb,"ContextMenuExtensibility",null,[738]);class ab{constructor(F,V=null,za=0){if(Ca.b(F))throw r.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.C3h=F;this.d8h=V;this.VYh=za}get zaa(){return this.C3h}get startedNode(){return this.d8h}get n$i(){return this.VYh}}Object(h.a)(ab,"RibbonExtensibility",null,
[787]);class Ab{constructor(F){this.WXh=F.entitlement}get entitlement(){return this.WXh}createActionContext(F,V){F={};F.ownerAddinInfo=this.entitlement;F.action=V;return F}}Object(h.a)(Ab,"AddInCommandsContextProvider",null,[]);class rc{constructor(F,V,za){this.abf=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=F;this.eventBuilder=V;this.contextMenuBuilder=za}get addinInfo(){return this.abf}oKi(F){return new Ab(F)}createActionBuilder(F,
V){return OfficeExt.DefaultControlActionBinder.createActionBuilder(F,V.entitlement,V.manifest)}startApplyAddin(F){this.abf=F;const V=this.oKi(F);this.actionBuilder=this.createActionBuilder(V,F)}endApplyAddin(){}U8d(F,V,za=0){return this.ribbonBuilder.HF&&0<this.ribbonBuilder.HF.count?new ab(this.X9i(F,V),this.addinInfo.startedNode,za):null}e3f(){var F=null;if(this.contextMenuBuilder.egd&&0<this.contextMenuBuilder.egd.count){F||(F=this.addinInfo.entitlement.solutionId);F=new Xb(F);for(let V of this.contextMenuBuilder.egd)F.hmc.add(V);
return F}return null}X9i(F,V){return this.ribbonBuilder.HF&&0<this.ribbonBuilder.HF.count?new qa(this.ribbonBuilder.HF,F,V):null}}Object(h.a)(rc,"AddinCommandsBuilder",null,[]);class tb{constructor(F,V,za,gb,Fb,Ec,$c){this.jmb=new wb.a;this.Ew=F;this.Ui=V;this.bT=za;this.EMb=gb;this.H_d=Fb;this.qLa=Ec;this.Psb=$c;this.kba=z.AFrameworkApplication.Aa.vV}t4c(F,V,za,gb,Fb,Ec,$c){const Ed=(pe,Se,Ye,ae)=>{Fb(pe,Se,Ye,ae);pe=$b.a[this.Ew]+Se.assetId;({value:Se}=this.jmb.wg(pe)).returnValue&&(Se.stop(),this.jmb.remove(pe))};
if(0!==this.Ew&&F){r.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",F.count);4===this.Ew&&(r.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",gb)),this.FAi(F,gb),Ec());for(let pe of F)if(F=pe,r.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.bT.PT,Telemetry.PrivacyRules.GetPrivacyCompliantId(F.solutionId,F.ownerAddinStoreType||F.storeType,F.assetId,null,null,F.storeId))),this.$Ph(F))if($c&&F.requireConsent)$c(F,Se=>{try{if(this.kba){const ae=
$b.a[this.Ew]+Se.solutionId,lg=this.kba.Ii("ComponentAttach",ae);this.jmb.$(ae,lg)}const Ye=this.qLa.l$a(Se.storeType,Se.solutionId);6!==this.Ew&&(Ye&&(this.wMc(Ye),Ye.QM.purge(!1)),this.Ui.insertOsfControl(this.bpc(Se,V,za,Ed)),Ye&&this.Ui.ownerAddinControlRecreated(Se.solutionId,Se.storeType))}catch(Ye){r.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.bT.PT,Telemetry.PrivacyRules.GetPrivacyCompliantId(Se.solutionId,
Se.ownerAddinStoreType||Se.storeType,Se.assetId,null,null,Se.storeId),Se.version,Se.storeType,Se.storeId,Ye.message)),Ed(!1,Se,null,null)}});else try{if(this.kba){const Ye=$b.a[this.Ew]+F.solutionId,ae=this.kba.Ii("ComponentAttach",Ye);this.jmb.$(Ye,ae)}const Se=this.qLa.l$a(F.storeType,F.solutionId);z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFAddinLaunchRefactor",!1)&&3===this.Ew&&"excatalog"!==F.storeType&&Se&&!Se.isUpgraded?(this.EMb.$wh(Se.WH),Ed(!0,F,null,
Se.displayName)):6!==this.Ew&&(Se&&(this.wMc(Se),Se.QM.purge(!1)),this.Ui.insertOsfControl(this.bpc(F,V,za,Ed)),Se&&this.Ui.ownerAddinControlRecreated(F.solutionId,F.storeType))}catch(Se){r.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.bT.PT,Telemetry.PrivacyRules.GetPrivacyCompliantId(F.solutionId,F.ownerAddinStoreType||F.storeType,F.assetId,null,null,F.storeId),F.version,F.storeType,
F.storeId,Se.message)),Ed(!1,F,null,null)}else Ed(!1,F,null,null)}}P7j(F,V,za,gb,Fb,Ec){const $c=(Ed,pe,Se,Ye)=>{Ec(Ed,pe,Se,Ye);Ed=$b.a[this.Ew]+pe.solutionId;({value:pe}=this.jmb.wg(Ed)).returnValue&&(pe.stop(),this.jmb.remove(Ed))};if(6===this.Ew&&F)if(r.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.bT.PT,Telemetry.PrivacyRules.GetPrivacyCompliantId(F.solutionId,F.ownerAddinStoreType||F.storeType,F.assetId,null,null,F.storeId))),this.$Ph(F))try{if(this.kba){const pe=
$b.a[this.Ew]+F.solutionId,Se=this.kba.Ii("ComponentAttach",pe);this.jmb.$(pe,Se)}const Ed=this.qLa.l$a(F.storeType,F.solutionId);Ed||$c(!1,F,null,null);z.AFrameworkApplication.Aa&&z.AFrameworkApplication.Aa.ob.cSf?this.v3f(F,V,gb,Fb,za,pe=>{$c(pe,F,za,Ed.displayName)}):(this.v3f(F,V,gb,Fb,za),$c(!0,F,za,Ed.displayName))}catch(Ed){r.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",
this.bT.PT,Telemetry.PrivacyRules.GetPrivacyCompliantId(F.solutionId,F.ownerAddinStoreType||F.storeType,F.assetId,null,null,F.storeId),F.version,F.storeType,F.storeId,Ed.message)),$c(!1,F,null,null)}else $c(!1,F,null,null)}gAk(F,V,za,gb,Fb,Ec){if(Ec)if(Ec._isAddinCommandsManifest(this.bT.PT))try{z.AFrameworkApplication.Aa&&z.AFrameworkApplication.Aa.ob.cSf?this.u3f(F,V,za,Fb,Ec,$c=>{gb($c,F,Ec,Ec.getDefaultDisplayName())}):(this.u3f(F,V,za,Fb,Ec),gb(!0,F,Ec,Ec.getDefaultDisplayName()))}catch($c){r.ULS.sendTraceTag(17586257,
220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.bT.PT,Telemetry.PrivacyRules.GetPrivacyCompliantId(F.solutionId,F.ownerAddinStoreType||F.storeType,F.assetId,null,null,F.storeId),F.version,F.storeType,F.storeId,$c.message)),gb(!1,F,Ec,Ec.getDefaultDisplayName())}else r.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",
this.bT.PT,Telemetry.PrivacyRules.GetPrivacyCompliantId(F.solutionId,F.ownerAddinStoreType||F.storeType,F.assetId,null,null,F.storeId),F.version,F.storeType,F.storeId)),gb(!1,F,null,null);else r.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.bT.PT,Telemetry.PrivacyRules.GetPrivacyCompliantId(F.solutionId,F.ownerAddinStoreType||F.storeType,F.assetId,null,null,F.storeId),F.version,F.storeType,F.storeId)),
gb(!1,F,null,null)}bpc(F,V,za,gb){const Fb={},Ec=document.createElement("div");Ec.setAttribute("visible","false");Fb.div=Ec;Fb.id=F.solutionId;Fb.solutionId=F.solutionId;Fb.version=F.version;Fb.storeType=F.storeType;Fb.storeId=F.storeId;Fb.assetId=F.assetId;Fb.assetStoreId=F.assetStoreId;Fb.isvirtualOsfControl=!0;Fb.virtualOsfControlActivationCallback=($c,Ed)=>{const pe=this.qLa.l$a(F.storeType,F.solutionId);pe&&(pe.isUpgraded&&(F.isUpgraded=!0),this.wMc(pe));this.gAk(F,V,za,gb,$c,Ed)};Fb.reason=
3===this.Ew?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return Fb}u3f(F,V,za,gb,Fb,Ec=null){const $c={};$c.solutionId=gb.getSolutionId();$c.version=gb.getVersion();$c.storeType=gb.getStoreType();$c.storeId=gb.getStoreId();$c.assetId=gb.getAssetId();$c.assetStoreId=gb.getAssetStoreId();$c.targetType=gb.getOsfControlType();let Ed=null,pe=null;if(z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1))Ed=(new OfficeExt.Parser.AddinCommandsManifestParser(this.bT.PT,this.bT.formFactor)).parseExtensions($c,Fb,this.Psb),pe=Db.M7f(this.bT.PT);else try{Ed=(new OfficeExt.Parser.AddinCommandsManifestParser(this.bT.PT,this.bT.formFactor)).parseExtensions($c,Fb,this.Psb),pe=Db.M7f(this.bT.PT)}catch(Ye){throw r.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+Ye.message),Ye;}if(pe&&0<pe.count){if(z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1)){var Se=V(F);V=za(F);za=!!z.AFrameworkApplication.fa&&z.AFrameworkApplication.fa.ka("AddinCommandsMultipleCustomTabsEnabled");Se=new rc(Se,null,V);for(let Ye of pe)Se.commandSurface=Ye,Ed.apply(Se,this.Psb,za)}else try{let Ye=V(F),ae=za(F),lg=!!z.AFrameworkApplication.fa&&z.AFrameworkApplication.fa.ka("AddinCommandsMultipleCustomTabsEnabled");Se=new rc(Ye,null,ae);for(let og of pe)Se.commandSurface=og,Ed.apply(Se,this.Psb,lg)}catch(Ye){throw r.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+
Ye.message),Ye;}if(OSF.OUtil.checkFlight(14))try{let Ye=Se.U8d(F.solutionId,Fb.getDefaultDisplayName()),ae=Se.e3f();Ye&&this.EMb.Dsb(Ye,Ec);ae&&this.H_d.dxf(ae);this.qLa.Qxf(gb,Ye,ae,Fb.getDefaultDisplayName());r.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",Fb.getDefaultDisplayName())}catch(Ye){throw OfficeExt.DevConsole.log(Ye),r.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+Ye.message),Ye;}else try{let Ye=Se.U8d(F.solutionId,Fb.getDefaultDisplayName()),
ae=Se.e3f();Ye&&this.EMb.Dsb(Ye);ae&&this.H_d.dxf(ae);this.qLa.Qxf(gb,Ye,ae,Fb.getDefaultDisplayName());r.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",Fb.getDefaultDisplayName())}catch(Ye){throw r.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+Ye.message),Ye;}}}v3f(F,V,za,gb,Fb,Ec=null){const $c={};$c.solutionId=F.solutionId;$c.version=F.version;$c.storeType=F.storeType;$c.storeId=F.storeId;$c.assetId=F.assetId;$c.assetStoreId=F.assetStoreId;$c.targetType=
F.targetType;const Ed=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.bT.PT,this.bT.formFactor);try{const pe=V.getManifest(),Se=Ed.parse($c,pe,Fb,this.Psb,V.getSharedRuntimeId(),V),Ye=za(F),ae=gb(F),lg=new rc(Ye,null,ae);lg.commandSurface="PrimaryCommandSurface";Se.apply(lg,this.Psb,!0);if(lg.ribbonBuilder.HF&&0<lg.ribbonBuilder.HF.count){const og=lg.U8d(F.solutionId,V.getManifest().getDefaultDisplayName(),1);z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",
!1)?this.EMb.Dsb(og,Ec):og&&this.EMb.Dsb(og,Ec);this.qLa.Qci(V,og,Fb,V.getManifest().getDefaultDisplayName());r.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",V.getManifest().getDefaultDisplayName())}}catch(pe){r.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",V.getManifest().getDefaultDisplayName(),pe.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(pe)}}wMc(F){F.WH&&this.EMb.hVe(F.WH);F.M2b&&this.H_d.G5k(F.M2b);
this.qLa.o5k(F.QM.getStoreType(),F.QM.getSolutionId())}FAi(F,V){V=Na(V);for(let za of this.qLa.nAb){if(za.QM.getStoreType()!==V)continue;let gb=!0;for(let Fb of F){const Ec=Fb;if(Ec&&za.xrg(Ec.storeType,Ec.solutionId)){gb=!1;break}}gb&&(this.wMc(za),za.QM.purge(!1))}}$Ph(F){return!!F&&!!F.solutionId&&!!F.version&&!!F.storeType&&!!F.storeId}}Object(h.a)(tb,"AddInCommandsIntegration",null,[]);var Za=d(1192),fb=d(172),ac=d(944),Dc=d(585),Sc=d(356),xb=d(945),Ta=d(141),ib=d(99),ob=d(65),fc=d(56);class Jb{static get q8(){return Jb.GG||
(Jb.GG=fc.a.instance.qb("Common.Utils.IAriaNotifier"))}static pOf(F,V,za,gb){Jb.TV&&Jb.TV.TL&&Jb.TV.dismiss();Jb.TV=Za.a.Y0d(V,F,F,3);Jb.TV.content=za;Ca.a(gb)||(Jb.TV.title=gb,Jb.TV.S9b=!0);F=new Sys.UI.Bounds(0,0,ib.a.OXc(),ib.a.NXc());Jb.TV.h_=Jb.K9d(F,V,Jb.TV.Hba,1);Jb.TV.show();Jb.q8&&Jb.q8.sendNotification(za.innerText,!0)}static q0d(F,V,za,gb=null){Ta.UISurfaces.FL().then(Fb=>{let Ec=null;Jb.IXb&&(Fb.removeNotification(Jb.IXb),Jb.IXb=null);const $c=Fb.callout(Object.assign(new ac.a,{target:F,
title:V,content:za,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new xb.a,{onDismiss:()=>{Fb.removeNotification(Ec)},directionalHint:null!=gb?gb:null})})),Ed=Object.assign(new Sc.a,{expirationOptions:Object.assign(new Dc.a,{displayTimeoutSeconds:7,onExpire:()=>{Fb.removeNotification(Jb.IXb)}})});Ec=Jb.IXb=Fb.addNotification($c,Ed);return null},Fb=>{r.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",Fb);return null})}static F1e(F){Jb.TV&&
Jb.TV.TL&&Jb.TV.dismiss();const V=new x.StandardDialog;V.T1a=!1;V.Ad=0;V.Ty(fb.a.H7j,CommonUIStrings.l_DialogError,Ca.a(F)?Jb.n6f():F,null)}static Nul(F){Jb.TV&&Jb.TV.TL&&Jb.TV.dismiss();r.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",F.errorCode));const V=Ca.a(F.description)?Jb.n6f():F.description,za=new x.StandardDialog;let gb=null;F.Z0b?(za.Ad=1,za.Oe(1,F.buttonText),za.dza(1)):za.Ad=0;gb=Fb=>{1===Fb?F.Z0b():F.u4b&&F.u4b()};za.T1a=!1;0===F.Lhe?
za.Ty(F.errorCode,F.title?F.title:CommonUIStrings.l_DialogError,V,gb):1===F.Lhe?za.sP(F.title?F.title:CommonUIStrings.l_DialogWarning,V,gb):za.Rlb(F.title?F.title:CommonUIStrings.l_DialogInfo,V,gb)}static K9d(F,V,za,gb){let Fb=0===gb?0:4;const Ec=F.x+F.width-V.x-V.width;V.x-F.x+V.width/2<=za/2?Fb=0===gb?2:5:Ec+V.width/2<=za/2&&(Fb=0===gb?3:6);return Fb}static Yul(F,V,za,gb=!1){(V=qa.Dxb(V))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(V,
Fb=>{Fb&&(gb||Jb.q0d(Fb,za,F,5))})}static Zul(F,V,za=!1){Jb.Yul(V.startedNode?V.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,F),V,V.startedNode?V.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,F),za)}static Xul(F,V,za,gb){if(Jb.tPh)F=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,za,gb,CommonUIStrings.l_InsertionDialogRefresh)),Jb.q0d(V,F,CommonUIStrings.l_ErrorLoadingAddInsTitle,
1);else{V=ob.a.ki(V);var Fb=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),Ec=document.createElement("span");Ec.innerText=Fb[0];var $c=document.createElement("span");$c.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,za,gb,CommonUIStrings.l_InsertionDialogRefresh);$c.className="UIFontBold";za=document.createElement("span");za.innerText=Fb[1];gb=document.createElement("div");Sys.UI.DomElement.addCssClass(gb,"ModalCalloutControl");gb.appendChild(Ec);
gb.appendChild($c);gb.appendChild(za);Jb.pOf(F,V,gb,CommonUIStrings.l_ErrorLoadingAddInsTitle)}}static xwl(F,V){var za=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,gb=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;Jb.tPh?Jb.q0d(V,za,gb):(V=ob.a.ki(V),Jb.pOf(F,V,Jb.bti(gb),za))}static bti(F){const V=document.createElement("div");Sys.UI.DomElement.addCssClass(V,"ModalCalloutControl");V.innerText=F;return V}static n6f(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive}static get tPh(){return z.AFrameworkApplication.Aa.ob.Pp&&
z.AFrameworkApplication.Aa.ob.bWa}}Jb.TV=null;Jb.IXb=null;Jb.GG=null;Object(h.a)(Jb,"AddInCommandsNotificationFactory",null,[]);class xc{constructor(F,V,za,gb,Fb,Ec,$c,Ed=null){this.Ma=new N.a;this.GAd=F;this.lWh=V;this.cB=za;this.Ouf=gb;this.jrb=Fb;this.GTh=Ec;this.nyc=$c;this.s3h=Ed}Rei(F){this.Ma.addHandler(O.a.Wzf,F)}Nfi(F){this.Ma.addHandler(O.a.tre,F)}jii(F){this.Ma.addHandler(O.a.NBh,F)}dfi(F){this.Ma.addHandler(O.a.UVd,F)}b8j(F,V,za){const gb=za[O.a.uJc],Fb=void 0===za[O.a.j8]?0:za[O.a.j8];
if(gb&&0!==Fb)if(0>=gb.count&&4!==Fb)this.tgh(new da(Fb,null,null,V,null,!0));else{var Ec=gb.count,$c=new Da(new Wa),Ed=void 0===za[O.a.k8]?-1:za[O.a.k8],pe=new tb(Fb,this.cB,this.GAd,$c,this.lWh,this.jrb,this.nyc),Se=se=>this.Ouf.xsi(se.solutionId,this.nyc,this.GAd,F),Ye=se=>this.Ouf.yri(se.solutionId),ae=(se,Df,Ci)=>{Ec--;Ci=new da(Fb,Df,$c,V,Ci,0>=Ec);if(se&&Df)this.tgh(Ci);else{if(3===Fb||Df&&Df.isUpgraded)se="",Df&&(se=Telemetry.PrivacyRules.GetPrivacyCompliantId(Df.solutionId,Df.ownerAddinStoreType||
Df.storeType,Df.assetId,null,null,Df.storeId)),Df={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:se},ca.a.sendTelemetryEvent(Object.assign(new I.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:T.a.kz(Df)}));this.sgh(Ci)}Ec||z.AFrameworkApplication.Aa.updateCommandUI()},lg=(se,Df,Ci,oj)=>{ae(se,Df,oj)},og=()=>{this.gKe();0>=gb.count&&4===Fb&&this.jrb.MZe()};6===Fb?(Ed=za[O.a.jXi],za=za[O.a.kXi],pe.P7j(gb.ga(0),Ed,za,Se,Ye,(se,Df,Ci,oj)=>
{ae(se,Df,oj)})):pe.t4c(gb,Se,Ye,Ed,lg,og,this.s3h)}else ca.a.sendTelemetryEvent(Object.assign(new I.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:T.a.kz({["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),r.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.GAd.PT)),this.sgh(new da(Fb,null,null,V,null,!0))}sgh(F){this.gKe(F);this.FCh(!1,F)}tgh(F){const V=F.Qu;
let za=null;null!==V&&(za=V.storeType,za=za.toLowerCase());if(F&&"omex"===za&&(3===F.Ew||V.isUpgraded)){var gb={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(V.solutionId,V.ownerAddinStoreType||V.storeType,V.assetId,null,null,V.storeId)};ca.a.sendTelemetryEvent(Object.assign(new I.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:T.a.kz(gb)}))}this.gKe(F);gb=bb()&&"omex"===za&&!!F.Qaa&&!!V.solutionId&&2===F.Ew&&V.solutionId.toLowerCase()===
Ha().toLowerCase();var Fb="excatalog"===za&&3===F.Ew;if("omex"===za&&F.Qaa&&(3===F.Ew&&"hardcodedpreinstall"!==za||V.isUpgraded)||gb||Fb)gb=new L,gb.Qu=V,gb.WH=F.Qaa.yWa,this.Ma.raiseEvent(O.a.UVd,gb);gb=ha();Fb=Ha();gb&&V&&"excatalog"===V.storeType&&F.Qaa&&5===F.Ew&&Fb&&(V.storeId&&V.storeId.toLowerCase()===Fb.toLowerCase()||V.assetId&&V.assetId.toLowerCase()===Fb.toLowerCase())&&(gb=new L,gb.Qu=V,gb.WH=F.Qaa.yWa,this.Ma.raiseEvent(O.a.UVd,gb),r.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."));
V&&(gc.instance.Uvh(Ia(za),!0),"uploadfiledevcatalog"===za&&(gb=this.GTh.createAddinDataProvider(za,this.cB))&&gb.localCacheAddinCommands(this.cB.Xxa,V.solutionId,V.version,V.storeId),S.a.lnb(O.a.Rsb,"true",Ia(za)));this.FCh(!0,F)}FCh(F,V){F?z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&V.Qaa&&5===V.Ew&&V.Qaa.yWa&&void 0!==V.Qu.showCallout&&null!==V.Qu.showCallout&&V.Qu.showCallout?(z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",
!1)?(new oa(this.Ma)).hSd(V.Qu,qa.Dxb(V.Qaa.yWa)):(new sa(this.Ma,V.Qu,qa.Dxb(V.Qaa.yWa))).hSd(),F=new L,F.WH=V.Qaa.yWa,F.Qu=V.Qu,this.Ma.raiseEvent(O.a.NBh,F)):3!==V.Ew?V.gug&&this.jrb.MZe():V.Qaa&&V.Qaa.yWa&&"hardcodedpreinstall"!==V.Qu.storeType&&Jb.Zul(V.displayName,V.Qaa.yWa,V.Qu.isAutoLaunched):3===V.Ew?V.Qu&&"uploadfiledevcatalog"===V.Qu.storeType.toLowerCase()?(V=this.nyc.Kgj(V.Qu.solutionId),Jb.F1e(V?V:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):this.jrb.Hkl():
V.gug&&this.jrb.MZe()}gKe(F=null){var V=F?F.Qu:null;const za=new L;if(za.Qu=V){var gb=this.jrb.l$a(V.storeType,V.solutionId,6===F.Ew?1:0);if(gb&&gb.WH){za.WH=gb.WH;var Fb=Ha();Fb=bb()&&!!V.solutionId&&!!Fb&&V.solutionId.toLowerCase()===Fb.toLowerCase()&&2===F.Ew;if(3===F.Ew&&"hardcodedpreinstall"!==V.storeType||Fb)F="",gb.WH.zaa&&gb.WH.zaa.HF&&(gb=gb.WH.zaa.HF.ga(0))&&(F=gb.id),V={["SDX_CommandPlacement"]:F,["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(V.solutionId,
V.ownerAddinStoreType||V.storeType,V.assetId,null,null,V.storeId)},ca.a.sendTelemetryEvent(Object.assign(new I.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:T.a.kz(V)}))}}this.Ma.raiseEvent(O.a.Wzf,za)}}Object(h.a)(xc,"LaunchAddinCommandsHandler",null,[700]);class ic{constructor(F){this.N3h=F}get Xxa(){return this.N3h}insertOsfControl(F){return this.Xxa.insertOsfControl(F)}getManifestInvaildErrorString(){return this.Xxa.getManifestInvaildErrorString()}isAddinCommandsAsync(F,V){this.Xxa.isAddinCommandsAsync(F,
V)}isAddinCommandsExAsync(F,V){this.Xxa.isAddinCommandsExAsync(F,V)}ownerAddinControlRecreated(F,V){this.Xxa.ownerAddinControlRecreated(F,V)}queryEntitlementDetails(F){this.Xxa.queryEntitlementDetails(F)}}Object(h.a)(ic,"ContextActivationMgrWrapper",null,[737]);class nc{}nc.Lnb="Alt";nc.Mnb="Command";nc.id="Id";nc.l3a="Image16by16";nc.Nnb="LabelText";nc.button="Button";nc.$7d="FlyoutAnchor";Object(h.a)(nc,"AddinDataNodeConstants",null,[]);var Wb=d(209),wc=d(412),nb=d(319),Rb=d(70);class mb{constructor(F,
V){this.GDc=this.Bdf=null;if(Ca.b(F)||Ca.b(V))throw r.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.RCd=V;this._id=F;this.KN[nc.id]=this._id}get id(){return this._id||""}get KN(){return this.Bdf||(this.Bdf={})}get controlType(){return this.RCd||""}get menuItems(){return this.GDc||(this.GDc=new e.a)}awc(){let F=null;this.RCd===nc.$7d?F=Object.assign(new wc.a,{Menu:this.tvk()}):
this.RCd===nc.button&&(F=Object.assign(new Wb.a,{}));F&&(this.KN[nc.id]&&(F.ExternalId=this.KN[nc.id]),this.KN[nc.Mnb]&&(F.Command=this.KN[nc.Mnb].toString()),this.KN[nc.Nnb]&&(F.LabelText=this.KN[nc.Nnb]),this.KN[nc.Lnb]&&(F.Alt=this.KN[nc.Lnb]),this.KN[nc.l3a]&&(Rb.c()&&appChrome.addInApi.registerAddinIcon&&appChrome.addInApi.registerAddinIcon(this._id,this.KN[nc.l3a]),F.ExternalImageId=this._id));return F}tvk(){const F=Object.assign(new nb.a,{UpdateDynamically:!0,MenuSectionList:[]});if(this.GDc){const V=
Object.assign(new m.a,{ControlList:[]});for(let za of this.GDc)Array.add(V.ControlList,za.awc());Array.add(F.MenuSectionList,V)}return F}}Object(h.a)(mb,"ControlDefinition",null,[698]);class Ub{constructor(F){this.jca=null;if(Ca.b(F))throw r.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=F;this.nlc[nc.id]=this._id}get nlc(){return this.jca||(this.jca={})}get id(){return this._id||
""}awc(){const F=Object.assign(new Wb.a,{});this.jca[nc.id]&&(F.ExternalId=this.jca[nc.id]);this.jca[nc.Mnb]&&(F.Command=this.jca[nc.Mnb].toString());this.jca[nc.Nnb]&&(F.LabelText=this.jca[nc.Nnb]);this.jca[nc.Lnb]&&(F.Alt=this.jca[nc.Lnb]);this.jca[nc.l3a]&&(Rb.c()&&appChrome.addInApi.registerAddinIcon&&appChrome.addInApi.registerAddinIcon(this._id,this.jca[nc.l3a]),F.ExternalImageId=this._id);return F}}Object(h.a)(Ub,"MenuItemDefinition",null,[752]);class zc{constructor(F){this.Fzc=null;if(Ca.b(F))throw r.ULS.sendTraceTag(9175314,
220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=F}get id(){return this._id}get controls(){return this.Fzc||(this.Fzc=new e.a)}awc(){const F=[];if(this.Fzc)for(let V of this.Fzc){const za=V.awc();za&&F.push(za)}return F}}Object(h.a)(zc,"OfficeMenuDefinition",null,[697]);var Pc=d(37);class Mc{constructor(F,V,za){this.JV=this.Xob=null;this.pKd=F;this.Hob=V;this.Xnb=za;this.C2h=new e.a}get Vgd(){return this.pKd}get n2b(){return this.Hob}get ERd(){return this.Xnb}addButton(F){r.ULS.sendTraceTag(17085952,
220,50,"ContextMenu button actiontype: {0}.",F.actionType);this.JV=new mb(this.pRa(F.id),nc.button);this.JV.KN[nc.Nnb]=F.label;this.JV.KN[nc.Lnb]=F.label;this.JV.KN[nc.l3a]=F.icon["16"];this.E0b(this.JV.KN[nc.id],F.action);this.n7a(this.JV.KN);this.Xob.controls.add(this.JV);this.JV=null}startBuildMenu(F){if(Ca.b(this.Xob))this.Xob=new zc(F.id);else{const V=this.pRa(F.id);this.JV=new mb(V,nc.$7d);this.Utb(this.JV.KN,F);this.JV.KN[nc.l3a]=F.icon["16"];this.JV.KN[nc.Mnb]=Pc.a.m8}}addMenuItem(F){r.ULS.sendTraceTag(17085953,
220,50,"ContextMenu menu item actiontype: {0}.",F.actionType);const V=new Ub(this.pRa(F.id));this.Utb(V.nlc,F);F.icon&&(V.nlc[nc.l3a]=F.icon["16"]);this.E0b(V.nlc[nc.id],F.action);this.n7a(V.nlc);this.JV.menuItems.add(V)}endBuildMenu(){Ca.b(this.JV)?(this.egd.add(this.Xob),this.Xob=null):(this.Xob.controls.add(this.JV),this.JV=null)}get egd(){return this.C2h}E0b(F,V){this.ERd.bindAction(F,V)}n7a(F){this.n2b.n7a(F)}pRa(F){return this.Vgd.LEa(F)}Utb(F,V){F[nc.Nnb]=V.label;F[nc.Lnb]=V.label}}Object(h.a)(Mc,
"ContextMenuExtensibilityCreator",null,[729,725]);class ld{constructor(F){this.MWb=F}get Plc(){return this.MWb}LEa(F){return this.Plc+F}}Object(h.a)(ld,"DefaultContextMenuNamingProvider",null,[728]);class vb{constructor(F,V,za,gb){this.MWb=F;z.AFrameworkApplication.fa.ka("AddInCommandsMissingTabIsEnabled")&&za.hlj();this.xtf=V;this.r7h=gb}get Plc(){return this.MWb}get solutionId(){return this.xtf}get j1e(){return this.r7h}LEa(F){F=this.Plc+this.solutionId+F;return this.j1e?(F in vb.vJc||(vb.vJc[F]=
"AddinControl"+vb.Zii++),vb.vJc[F]):F}lRf(F){if(this.j1e){const za=vb.vJc;for(let gb in za){var V=gb;if(F===za[gb])return V.substr(this.Plc.length+this.solutionId.length)}}return F}duj(F){F=this.Plc+this.solutionId+F;return this.j1e?(F in vb.LTd||(vb.LTd[F]="AddinTab"+vb.dji++),vb.LTd[F]):F}}vb.vJc={};vb.LTd={};vb.dji=0;vb.Zii=0;Object(h.a)(vb,"DefaultRibbonNamingProvider",null,[699]);class cc{bindAction(F,V){OfficeExt.DefaultControlActionBinder.bindAction(F,V)}}Object(h.a)(cc,"DefaultUIControlActionBinder",
null,[727]);class Hc{constructor(F){this.PVh=F}get command(){return this.PVh}n7a(F){F[nc.Mnb]=this.command}}Object(h.a)(Hc,"DefaultUIControlCommandBinder",null,[726]);var Pb=d(526);class Uc{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(h.a)(Uc,"AddInControl",null,[]);class sc{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}}Object(h.a)(sc,"AddInGroup",null,
[]);class lb{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(h.a)(lb,"AddInMenuItem",null,[]);class Zb{constructor(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(h.a)(Zb,"AddInTab",null,[]);class Oc{constructor(F,V,za,gb,Fb,Ec){this.kyc=new e.a;this.iTb=this.OAa=this.Yob=null;this.pKd=F;this.Xnb=V;this.Hob=za;this.xtf=gb;this.nyc=
Fb;this.Vff=Ec}get Vgd(){return this.pKd}get HF(){return this.kyc}get ERd(){return this.Xnb}get n2b(){return this.Hob}startBuildTab(F){const V=F.isOfficeTab?F.id:this.Vgd.duj(F.id),za=F.isOfficeTab?null:F.label;this.Yob=Object.assign(new Zb,{id:V,title:za,isOfficeTab:F.isOfficeTab,visible:F.visible,groups:[],tabType:F.tabType,insertBefore:F.insertBefore,insertAfter:F.insertAfter,autoFocus:F.autoFocus})}startBuildGroup(F){const V=this.pRa(F.id);this.OAa=Object.assign(new sc,{id:V,mlrId:F.mlrId,title:F.label,
controls:[],groupType:0})}addNativeGroup(F){this.OAa=Object.assign(new sc,{id:F.id,mlrId:F.mlrId,title:F.label,controls:[],groupType:1});this.Yob.groups.push(this.OAa)}addButton(F){const V=this.pRa(F.id);V&&(this.E0b(V,F.action),r.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",F.actionType),F=Object.assign(new Uc,{id:V,title:F.label,iconLocation:this.vae(F),enabled:F.enabled,controlType:0,attributes:this.Utb()}),this.Vff.Kwf(new Pb.a(V,this.n2b.command.toString())),
this.OAa.controls.push(F))}addNativeControl(F){F.id&&(r.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",F.actionType),F=Object.assign(new Uc,{id:F.id,title:"",iconLocation:"",enabled:F.enabled,controlType:2,attributes:this.Utb()}),this.OAa.controls.push(F))}startBuildMenu(F){const V=this.pRa(F.id);V&&(this.iTb=Object.assign(new Uc,{id:V,title:F.label,iconLocation:this.vae(F),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(F){const V=this.pRa(F.id);V&&(this.E0b(V,
F.action),r.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",F.actionType),F=Object.assign(new lb,{id:V,title:F.label,iconLocation:this.vae(F),enabled:F.enabled,attributes:this.Utb()}),this.Vff.Kwf(new Pb.a(V,this.n2b.command.toString())),this.iTb.menuItems.push(F))}endBuildMenu(){Ca.b(this.iTb.id)||this.OAa.controls.push(this.iTb);this.iTb=null}endBuildGroup(){Ca.b(this.OAa.id)||this.Yob.groups.push(this.OAa);this.OAa=null}endBuildTab(){Ca.b(this.Yob.id)||this.kyc.add(this.Yob);
this.Yob=null}Utb(){const F={};this.n7a(F);return F}vae(F){return F.icon["80"]?F.icon["80"]:F.icon["32"]}n7a(F){this.n2b.n7a(F)}pRa(F){return this.Vgd.LEa(F)}E0b(F,V){this.ERd.bindAction(F,V)}}Object(h.a)(Oc,"OneLineRibbonExtensibilityCreator",null,[724,725]);class md{constructor(F,V){this.MWb=F;this.Xnb=new cc;this.Hob=new Hc(V)}yri(F){F=new ld(F);return new Mc(F,this.Hob,this.Xnb)}xsi(F,V,za,gb){za=new vb(this.MWb,F,za,!0);return new Oc(za,this.Xnb,this.Hob,F,V,gb)}}Object(h.a)(md,"UIExtensibilityFactory",
null,[688]);class Ib{createAddinDataProvider(F,V){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(F,V.Xxa)}static get instance(){Ib.La||(Ib.La=new Ib);return Ib.La}}Ib.La=null;Object(h.a)(Ib,"OSFAddinDataProviderFactory",null,[696]);class ud{constructor(){this.Qsb=null}setErrorMessageForAddin(F,V){this.Qsb||(this.Qsb={});this.Qsb[F]=V}Kgj(F){return this.Qsb&&F in this.Qsb?this.Qsb[F]:null}}Object(h.a)(ud,"AddinCommandsErrorManager",null,[]);class od{constructor(){this.Lhe=0;this.Z0b=
this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.Mhg=!1;this.xKj=this.u4b=null}}Object(h.a)(od,"AddInCommandsNotificationParameters",null,[]);class Ud{constructor(){this.Mbf=this.mAd=null}get FRd(){return this.mAd||(this.mAd=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set FRd(F){this.mAd=F}get Doi(){return this.Mbf||(this.Mbf=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(F,V){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(F,
V)}n9b(F,V,za,gb,Fb){r.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",F);if((F=V.l$a(Fb.ownerAddinInfo.storeType,Fb.ownerAddinInfo.solutionId))&&F.QM&&!F.QM.getIsUpgrading())if(V=null,0<F.QM.getNotificationParams().length&&(V=this.AFf(F.QM.getNotificationParams()[0]))&&2147758681===V.errorCode&&(F.isUpgraded=!0),2!==F.QM.getStatus()&&(1!==F.QM.getStatus()||V&&2147758681===V.errorCode))V&&this.JBh(F,V,null);else try{za.setOwnerAddinEToken(F.QM.getEToken()),Fb.action(za,gb.Xxa)}catch(Ec){r.ULS.sendTraceTag(17425949,
220,10,String.format("HandleAddinCommandsAction error info : {0}.",z.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?Ec.stack:Ec.message)),Jb.F1e(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}}JBh(F,V,za=null){const gb=F.QM;if(1===gb.getNotificationParams().length||V.Mhg){const Fb=V.Z0b,Ec=V.u4b;V.Z0b=()=>{gb.removeFirstNotification();if(0<gb.getNotificationParams().length){const $c=this.AFf(gb.getNotificationParams()[0]);
this.JBh(F,$c)}2147758681===V.errorCode&&(Wa.GUi(F.WH,gb,Object(D.a)(this,this.Ejg,"initUpgradeStateDetectTask")),n.AUi(F.M2b,gb,Object(D.a)(this,this.Ejg,"initUpgradeStateDetectTask")));Fb&&Fb()};V.u4b=()=>{Ec&&Ec();za&&za()};Jb.Nul(V)}}Ejg(F,V){let za=null;za=()=>{F.getIsUpgrading()?window.setTimeout(za,1E3):F.getUpgradingFailed()?Wa.isd(V,!0):z.AFrameworkApplication.Aa.updateCommandUI()};window.setTimeout(za,1E3)}AFf(F){const V=new od;V.Lhe=F.infoType;V.id=F.id;V.title=F.title;V.description=F.description;
V.buttonText=F.buttonTxt;V.Z0b=F.buttonCallback;V.Mhg=F.highPriority;V.u4b=F.dismissCallback;V.errorCode=F.errorCode;V.xKj=F.iframeNotificationUrl;return V}}Object(h.a)(Ud,"AddinCommandsActionHandler",null,[1002]);class Ad{constructor(){this.labelText=null;this.visible=!1}}Object(h.a)(Ad,"AddinStatusCommandValues",null,[]);class be{static cWk(F){const V=new Ad;V.labelText=F.G_b;V.visible=V.labelText?!0:!1;return V}static d2e(){const F=document.getElementById(void 0);F?be.ACh(void 0,void 0,F,void 0,
void 0):r.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",void 0))}static ACh(F,V,za,gb,Fb){za?F.G_b===CommonUIStrings.l_ErrorLoadingAddInsTitle?Jb.Xul(V,za,gb,Fb):F.G_b===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&Jb.xwl(V,za):r.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}Object(h.a)(be,"AddinCommandsStatusHandler",null,[]);class uf{constructor(){this.Ew=this.v1=0;this.CTd=null;this.tmd=this.Owd=
0;this.ZNa=this.aFd=this.EAd=this.DNc=this.AEa=this.$ra=null}get BTd(){this.EAd||(this.EAd=new e.a);return this.EAd}get M8d(){this.aFd||(this.aFd=new e.a);return this.aFd}get P8a(){this.ZNa||(this.ZNa=new e.a);return this.ZNa}}Object(h.a)(uf,"AddinCommandsListLoaderContext",null,[]);const sd=F=>{const V={};V.solutionId=F.solutionId;V.version=F.version;V.storeType=F.storeType;V.storeId=F.storeId;V.assetId=F.assetId;V.assetStoreId=F.assetStoreId;V.targetType=F.targetType;V.requireConsent=F.requireConsent||
!1;V.isAddinCommands=!0;V.addinCommandsActionType=0;return V};class Ze{constructor(F,V){this.entitlement=F;this.metadata=V}w6e(){const F=sd(this.entitlement);F.targetType=this.targetType;return F}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==
this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}Object(h.a)(Ze,"AddinEntitlementEx",null,[]);var Ke=d(1);class hf{constructor(F){this.Fg=null;this.Yba=F}get_current(){if(!this.Fg)throw Error.argumentOutOfRange();return this.Fg.data}moveNext(){if(!this.Fg)return this.Fg=this.Yba,!!this.Yba;if(!this.Fg.next)return!1;
this.Fg=this.Fg.next;return!0}reset(){this.Fg=this.Yba}}Object(h.a)(hf,"ListEnumerator",null,[0]);class Xa{constructor(F,V,za){this.next=za;this.previous=V;this.data=F}}Object(h.a)(Xa,"ListNode",null,[]);class Bb{constructor(){this.H6a=this.cia=null;this.il=0}add(F){this.cia?this.H6a=this.H6a.next=new Xa(F,this.H6a,null):this.cia=this.H6a=new Xa(F,null,null);this.il=this.count+1}insert(F,V){if(F>this.count||0>F)throw Error.argumentOutOfRange("pos");if(F===this.count)this.add(V);else{for(var za=this.cia;0!==
F--;)za=za.next;F=new Xa(V,za.previous,za);F.previous?F.previous.next=F:this.cia=F;F.next?F.next.previous=F:this.H6a=F;this.il=this.count+1}}remove(F){let V=this.cia;for(;V&&V.data!==F;)V=V.next;if(!V)return!1;V.previous?V.previous.next=V.next:this.cia=V.next;V.next?V.next.previous=V.previous:this.H6a=V.previous;this.il=this.count-1;return!0}clear(){let F=this.cia,V;for(this.H6a=this.cia=null;F;)V=F.next,F.previous=null,F.next=null,F=V;this.il=0}indexOf(F){let V=this.cia,za=0;for(;V&&V.data!==F;)V=
V.next,za++;return V?za:-1}ga(F){return this.at(F).data}get count(){return this.il}getEnumerator(){return new hf(this.cia)}[Symbol.iterator](){return Object(Ke.a)(this.getEnumerator())}toArray(){const F=Array(this.count);let V=0;for(let za of this)F[V]=za,V++;return F}at(F){let V=this.cia,za=0;for(;za!==F;){if(!V)throw Error.argumentOutOfRange("pos");V=V.next;za++}return V}}Object(h.a)(Bb,"List",null,[1]);class mc extends Sys.EventArgs{constructor(F){super();this.properties=F}}Object(h.a)(mc,"AddinCommandsEntitlementsRetrievedEventArgs",
Sys.EventArgs,[]);class Qc{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(h.a)(Qc,"MiniAddinInfo",null,[]);class td{constructor(F,V,za){this.Lp=new N.a;this.context=new uf;this.MPd=this.e3e=this.z7a=this.K1=this.Mba=null;this.contextActivationMgr=F;this.$ii=V;this.A7a=za;this.appName=z.AFrameworkApplication.fa.Ha("WebAppShortName")}get NHh(){this.MPd||(this.MPd=new oa(this.Lp));return this.MPd}Qei(F){this.Lp.addHandler(O.a.F_b,F)}lii(F){this.Lp.addHandler(O.a.H1e,F)}FKl(F){null!==
F&&(this.context.v1=F[O.a.k8],this.context.Ew=F[O.a.j8],this.context.Owd=this.context.tmd=0,F=O.a.B7a in F?F[O.a.B7a]:0,-1!==this.context.v1&&0!==this.context.Ew&&(this.context.$ra=new Bb,this.context.AEa=new Bb,this.context.DNc=new Bb,this.context.CTd=this.$ii.createAddinDataProvider(Na(this.context.v1),this.contextActivationMgr),this.context.CTd?this.context.CTd.getEntitlementsAsync(this.contextActivationMgr.Xxa,!0,F,V=>{this.JEk(V)}):r.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",
this.context.v1)))}JEk(F){if(F&&0<F.length){this.context.Owd=F.length;const za=z.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")?Ha():null;for(let gb=0;gb<F.length;gb++){const Fb=F[gb];if(z.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")&&bb()&&Fb&&Fb.storeType&&"omex"===Fb.storeType.toLowerCase()&&Fb.assetId&&za&&Fb.assetId.toLowerCase()===za.toLowerCase()){var V={["SDX_AppInstallOrigin"]:"DeeplinkUser",
["SDX_Id"]:td.aJ(Fb)};ca.a.sendTelemetryEvent(Object.assign(new I.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:T.a.kz(V)}))}!Fb||1!==Fb.targetType&&-1!==Fb.targetType?this.Ghd():(V={},z.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(V.solutionId=Fb.solutionId,V.version=Fb.version):(V.marketplaceId=Fb.solutionId,V.marketplaceVersion=Fb.version),V.storeType=Fb.storeType,V.storeId=Fb.storeId,V.targetData=
Fb,td.tvc?this.contextActivationMgr.isAddinCommandsExAsync(V,Object(D.a)(this,this.qEk,"onIsAddinCommandsExCompleted")):this.contextActivationMgr.isAddinCommandsAsync(V,(Ec,$c,Ed)=>{Ec?($c&&this.context.$ra.add(Ed.targetData),10===this.context.v1&&(Ec=Ed.targetData,$c=Ec.targetType,Ca.b(Ed.targetTypeForExp)||($c=Ed.targetTypeForExp,Ec.targetType=$c),this.context.AEa.add(Ec),0===$c&&this.context.DNc.add(Ec))):(Ed=Ed.targetData,r.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",
Telemetry.PrivacyRules.GetPrivacyCompliantId(Ed.solutionId,Ed.storeType,Ed.assetId,null,null,Ed.storeId),Ed.storeType));this.Ghd()}))}}else this.Ghd()}Ghd(){var F;(F=this.context).tmd=F.tmd+1;this.context.tmd>=this.context.Owd&&(this.A7a.Uvh(this.context.v1,!1),0<this.context.Owd&&10===this.context.v1&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(F=!1,ha()&&(F=this.Tak()),this.hak(),z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)&&!F?td.tvc?this.NHh.KIl(this.contextActivationMgr,this.context.BTd,this.context.P8a,(V,za)=>{const gb=new e.a;for(let Fb of V)V=Fb.w6e(),za&&za.solutionId===Fb.solutionId&&(V.showCallout=!0,this.NHh.wOh(za)),gb.add(V);this.VKa(gb)}):this.S$i(this.context.$ra):this.DIc(this.context.$ra)):this.DIc(this.context.$ra))}DIc(F){if(td.tvc)this.VKa(this.fEi(this.context.BTd));else{var V=new e.a;if(F)for(let za of this.context.$ra)V.add(sd(za));this.context.$ra&&1>this.context.$ra.count&&S.a.lnb(O.a.Rsb,
"false",this.context.v1);F={["ack2"]:V};F[O.a.k8]=this.context.v1;F[O.a.j8]=this.context.Ew;this.Lp.raiseEvent(O.a.F_b,new mc(F),this)}}fEi(F){const V=new e.a;if(F)for(let za of F)V.add(za.w6e());return V}VKa(F){F&&F.count||S.a.lnb(O.a.Rsb,"false",this.context.v1);F={["ack2"]:F};F[O.a.k8]=this.context.v1;F[O.a.j8]=this.context.Ew;this.Lp.raiseEvent(O.a.F_b,new mc(F),this)}V0a(F){if(this.appName){const V={},za={};za.LastTeachingUIShowTime=(new Date).toUTCString();za.AddinHasShown=F;V[this.appName]=
Z.c(za);this.Mba&&(this.Mba.Lwb(V),r.ULS.sendTraceTag(539530527,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else r.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")}S$i(F){(this.z7a=F)?(F=new e.a,F.add(this.appName),this.Mba=new ja(this.appName,Object(D.a)(this,this.ZEa,"getRequestSuccessCallback"),Object(D.a)(this,this.Uka,"getRequestFailureCallback"),Object(D.a)(this,this.Eaa,"postRequestFailureCallback")),
this.Mba.RRc(F)):(F={["ack2"]:new e.a},F[O.a.k8]=this.context.v1,F[O.a.j8]=this.context.Ew,this.Lp.raiseEvent(O.a.F_b,new mc(F),this))}ZEa(F){F?this.u1e(F)?(r.ULS.sendTraceTag(527523845,306,50,"should show teaching UI"),this.K1="AddinHasShown"in F&&F.AddinHasShown?F.AddinHasShown.toString():null,this.y2b()):(r.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),this.DIc(this.z7a)):(r.ULS.sendTraceTag(527523844,306,50,"userSettings is null"),this.K1=null,this.y2b())}Uka(F){r.ULS.sendTraceTag(539530529,
306,10,"GET data from Roaming Settings Service with status: {0}, fallback",F?F.Ke:-1);this.DIc(this.z7a)}Eaa(F){r.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",F?F.Ke:-1)}y2b(){const F=this.o3d();0===F.targetType?(F.solutionId?(this.e3e=F.solutionId,this.KRe()):this.LGa("NoSolutionId"),F.addinId&&(window.g_roamingAddinList=this.K1?this.K1+","+F.addinId:F.addinId),this.Gxf(null)):this.Gxf(F.addinId);r.ULS.sendTraceTag(528023563,306,50,"Show teaching callout for: {0}",
F.addinId)}KRe(){const F=new Ea.a;F.callbackFunc=V=>{if(V.errorCode){this.LGa("FailToGetAppDetails");var za=window.g_roamingAddinList;za&&this.V0a(za)}else if(V.value)for(za of V.value)if(V=za[1],V===this.e3e){const gb={};gb.solutionId=V;gb.assetId=za[5];gb.storeType=za[12];gb.storeId=za[11];gb.assetStoreId=za[6];gb.targetType=za[3];gb.width=za[7];gb.height=za[8];gb.displayName=za[0];gb.version=za[4];za=new va(gb);this.Lp.raiseEvent(O.a.H1e,za);break}};F.storeType=OSF.StoreTypeEnum.PrivateCatalog;
F.fromInsertDialog=!1;F.refresh=!1;this.contextActivationMgr.queryEntitlementDetails(F)}u1e(F){if("LastTeachingUIShowTime"in F){if(F=+new Date-+new Date(F.LastTeachingUIShowTime.toString()),F<z.AFrameworkApplication.fa.CQ("AddinShowTeachingUIIntervalInMS",864E5))return r.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",F),!1}else r.ULS.sendTraceTag(527523846,306,50,"userSetting has no date key");return!0}o3d(){let F=new Ma.a(new Qc,0),V=new Ma.a(new Qc,
0),za=0,gb=0,Fb=0;var Ec=new Bb;if(0<this.context.$ra.count)for(var $c of this.context.$ra)Ec.add($c);if(0<this.context.DNc.count)for(let Ed of this.context.DNc)Ec.add(Ed);for(let Ed of Ec)if(!("excatalog"!==Ed.storeType||Ca.b(Ed.installTimeInMS)||!Ed.installTimeInMS||Ed.installTimeInMS<=z.AFrameworkApplication.fa.CQ("DateTimeInMSForNewAddin",16409952E5))){Ec=td.V6b(Ed);if(this.K1&&($c=this.K1.split(","),0<$c.length&&Array.contains($c,Ec))){Fb++;r.ULS.sendTraceTag(528345032,306,50,"This addin has shown teaching UI before");
continue}Ec.startsWith("private_")?(F.value<Ed.installTimeInMS&&(F=new Ma.a(Object.assign(new Qc,{addinId:Ec,targetType:Ed.targetType,solutionId:Ed.solutionId}),Ed.installTimeInMS)),gb++):(V.value<Ed.installTimeInMS&&(V=new Ma.a(Object.assign(new Qc,{addinId:Ec,targetType:Ed.targetType,solutionId:Ed.solutionId}),Ed.installTimeInMS)),za++)}r.ULS.sendTraceTag(528345033,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",gb,za,Fb);return 0<V.value?V.key:
0<F.value?F.key:Object.assign(new Qc,{addinId:null,targetType:-1,solutionId:null})}Gxf(F){const V=new e.a;for(let za of this.z7a){const gb=sd(za);if(F){const Fb=td.V6b(za);F===Fb&&(gb.showCallout=!0,window.g_roamingAddinList=this.K1?this.K1+","+F:F)}V.add(gb)}this.z7a&&1>this.z7a.count&&S.a.lnb(O.a.Rsb,"false",this.context.v1);F={["ack2"]:V};F[O.a.k8]=this.context.v1;F[O.a.j8]=this.context.Ew;this.Lp.raiseEvent(O.a.F_b,new mc(F),this)}Tak(){if(td.tvc)return this.Uak(this.context.M8d);var F=!1;if(this.context.AEa&&
1>this.context.AEa.count)return F;const V=Ha();if(!V)return F;for(let za of this.context.AEa)if(za.storeId&&za.storeId.toLowerCase()===V.toLowerCase()||za.assetId&&za.assetId.toLowerCase()===V.toLowerCase())F={["SDX_Id"]:td.aJ(za),["SDX_TargetType"]:Ca.b(za.targetType)?"":za.targetType.toString()},ca.a.sendTelemetryEvent(Object.assign(new I.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:T.a.kz(F)})),F=!0;return F}hak(){if(td.tvc)this.iak(this.context.M8d);else if(!(this.context.AEa&&
1>this.context.AEa.count))if(this.A7a.xpg()){var F=this.A7a.E$f();F?(F=this.M5f(this.context.AEa,F),r.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(F=this.M5f(this.context.AEa,null),r.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.A7a.Cxh(F)}else r.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}M5f(F,V){const za={};let gb=!1;for(let Fb of F)if(F=td.aJ(Fb))!V||F in V||(this.Mea(Fb,F),r.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),
"private"===F.toLowerCase()?gb||(gb=!0,za[F]=null):za[F]=null;return za}Mea(F,V){var za=F.installTimeInMS?(new Date(F.installTimeInMS)).toISOString():"";za={["SDX.Id"]:V,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:Ca.b(F.targetType)?"":F.targetType.toString(),["SDX.AdminDeploymentTime"]:za};ca.a.sendTelemetryEvent(Object.assign(new I.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:T.a.kz(za)}));1===F.targetType&&(F={["SDX.Id"]:V,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},
ca.a.sendTelemetryEvent(Object.assign(new I.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:T.a.kz(F)})))}Uak(F){let V=!1;if(F&&1>F.count)return V;const za=Ha();if(!za)return V;for(let gb of F)if(gb.storeId&&gb.storeId.toLowerCase()===za.toLowerCase()||gb.assetId&&gb.assetId.toLowerCase()===za.toLowerCase())F={["SDX_Id"]:td.G$f(gb),["SDX_TargetType"]:Ca.b(gb.targetType)?"":gb.targetType.toString()},ca.a.sendTelemetryEvent(Object.assign(new I.a,{name:"Office.Extensibility.Host.EmailAlertNotification",
dataFields:T.a.kz(F)})),V=!0;return V}iak(F){if(!(F&&1>F.count))if(this.A7a.xpg()){var V=this.A7a.E$f();V?(F=this.N5f(F,V),r.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(F=this.N5f(F,null),r.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.A7a.Cxh(F)}else r.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}N5f(F,V){const za={};let gb=!1;for(let Fb of F)if(F=td.G$f(Fb))!V||F in V||(this.cdk(Fb,F),r.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),
"private"===F.toLowerCase()?gb||(gb=!0,za[F]=null):za[F]=null;return za}cdk(F,V){var za=F.installTimeInMS?(new Date(F.installTimeInMS)).toISOString():"";za={["SDX.Id"]:V,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:Ca.b(F.targetType)?"":F.targetType.toString(),["SDX.AdminDeploymentTime"]:za};ca.a.sendTelemetryEvent(Object.assign(new I.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:T.a.kz(za)}));1===F.targetType&&(F={["SDX.Id"]:V,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},
ca.a.sendTelemetryEvent(Object.assign(new I.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:T.a.kz(F)})))}qEk(F,V,za,gb){F?(-1===gb.targetType&&(gb.targetType=za.targetTypeForExp),F=new Ze(za.targetData,gb),V&&this.context.BTd.add(F),10===this.context.v1&&(this.context.M8d.add(F),0===F.targetType&&this.context.P8a.add(F))):(V=za.targetData,r.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(V.solutionId,V.storeType,
V.assetId,null,null,V.storeId),V.storeType));this.Ghd()}LGa(F){F={["AppTeachingUICalloutAction"]:F,["SDX.Id"]:this.e3e,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ca.a.sendTelemetryEvent(Object.assign(new I.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:T.a.kz(F)}))}static get tvc(){return z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",!1)}static aJ(F){return Telemetry.PrivacyRules.GetPrivacyCompliantId(F.solutionId,
F.storeType,F.assetId,null,null,F.storeId)}static G$f(F){return Telemetry.PrivacyRules.GetPrivacyCompliantId(F.solutionId,F.storeType,F.assetId,null,null,F.storeId)}static V6b(F){return Telemetry.PrivacyRules.IsPrivateAddin(F.storeType,F.assetId,null,null,F.storeId)?"private_"+F.installTimeInMS:F.solutionId}}Object(h.a)(td,"AddInCommandsListLoader",null,[]);var Md=d(1160),Pd=d(182),Be=d(1277),fe=d(29),Mf=d(63);class Bd{constructor(F,V,za){this.udb=this.RGa=this.mfa=this.Bgb=null;this.NEe=this.wcd=
-1;this.AH=null;this.TXg=!1;this.Cxg=F;this.Jb=V;this.Hxg=this.Jb.wc("AddinMaxTabSwitchDetectionTimesForTeachingUI",3);this.qek=this.Jb.wc("AddinMaxDOMElementDetectionTimesForTeachingUI",10);this.P5c=this.Jb.Ha("WebAppShortName");this.Ic=za;fa.a.Xa(this.P5c)&&(this.P5c="PowerPoint")}aJ(F){return Telemetry.PrivacyRules.GetPrivacyCompliantId(F.solutionId,F.storeType,F.assetId,null,null,F.storeId)}D4k(F){this.AH=F;this.Ic.w7a(Object(D.a)(this,this.a$g,"onInsertTabSwitched_ContentAddin"));window.addEventListener("LaunchContentAddin",
Object(D.a)(this,this.JIk,"onTryItButtonClicked_ContentAddin"),!0);window.addEventListener("DismissCallout",Object(D.a)(this,this.BCk,"onDismissButtonClicked_ContentAddin"),!0);window.addEventListener("CloseCallout",Object(D.a)(this,this.ABk,"onCloseButtonClicked_ContentAddin"),!0)}CEk(){this.mfa&&this.udb&&(this.Cxg.n9b({["SourceControlId"]:this.udb}),r.ULS.sendTraceTag(512499854,220,50,"Launch addin command has been triggered"))}cvl(F,V){V?(this.mfa=V.Qu,(this.Bgb=V.WH)&&this.Bgb.zaa&&this.Bgb.zaa.HF&&
(this.RGa=this.Bgb.zaa.HF.ga(0)),this.RGa?this.RGa.isOfficeTab?(F=this.mfa.solutionId,V=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),F in V?this.udb=V[F]:(r.ULS.sendTraceTag(512499852,220,15,"OnLaunchAddinButtonClicked failed to get button id from controlIdMap for add-in: {0}",this.aJ(this.mfa)),this.udb=this.O$i(this.Bgb)),this.udb?0<this.RGa.id.indexOf(Mf.a.jlh)?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(qa.Dxb(this.Bgb),()=>{this.RCh(this.MWc(this.udb))}):
this.Ic.w7a(Object(D.a)(this,this.Sbh,"onTabSwitched")):(this.NWa("NoEnabledButtonFound",this.mfa),r.ULS.sendTraceTag(512499851,220,10,"OnLaunchAddinButtonClicked failed to get button id for addin"),this.xJa())):this.TCh(this.MWc(this.RGa.id),0):(this.NWa("NoTabFound",this.mfa),r.ULS.sendTraceTag(512499853,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),this.xJa())):this.xJa()}Sbh(F,V){!this.RGa||void 0===this.RGa.id||null===this.RGa.id||0>fa.a.rg(this.RGa.id).indexOf(fa.a.rg(V.Xfa))||
(this.Ic.brc(Object(D.a)(this,this.Sbh,"onTabSwitched")),this.FYd(V.c7g,V.Xfa,this.Hxg,!1))}a$g(F,V){"Insert"===V.Xfa&&(this.Ic.brc(Object(D.a)(this,this.a$g,"onInsertTabSwitched_ContentAddin")),this.FYd(V.c7g,V.Xfa,this.Hxg,!0))}FYd(F,V,za,gb){if(0>za)this.NWa("TabSwitchTimeOut",this.mfa);else{var Fb=document.querySelector("button"+this.MWc(V));Fb.hasAttribute("aria-selected")&&"false"!==Fb.getAttribute("aria-selected")?(0<this.NEe&&window.clearTimeout(this.NEe),gb?this.wxl():this.RCh(this.MWc(this.udb))):
this.NEe=window.setTimeout(()=>{this.FYd(F,V,za-1,gb)},1E3)}}MWc(F){return"[id="+F+"]"}wxl(){let F=document.querySelector("button[data-unique-id = 'Ribbon-InsertAddIns']");var V=F?window.getComputedStyle(F,null):null;if(!F||V&&"none"===V.display)if(F=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']"))r.ULS.sendTraceTag(512499849,220,15,"Callout show on Overflow button");else{this.JCb("NoAnchor",this.AH);r.ULS.sendTraceTag(512499850,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");
return}else r.ULS.sendTraceTag(512499848,220,15,"Callout show on OfficeAddin Button");(V=fc.a.instance.Ia("Common.ISystemInitiatedFeedback"))&&F?(V.execute(za=>{za.logActivity("ShowTeachingUIForContentAddin",null)}),this.JCb("Show",this.AH),r.ULS.sendTraceTag(512499846,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity")):(this.JCb("NoSifFutureObject",this.AH),r.ULS.sendTraceTag(512499847,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"))}JIk(){this.JCb("ClickOnLaunch",
this.AH);this.xJa();const F={};F.solutionId=this.AH.solutionId;F.assetId=this.AH.assetId;F.assetStoreId=this.AH.assetStoreId;F.height=this.AH.height?this.AH.height:600;F.storeId=this.AH.storeId;F.targetType=this.AH.targetType;F.width=this.AH.width?this.AH.width:600;F.displayName=this.AH.displayName;F.version=this.AH.version;F.storeType=this.AH.storeType;F.isAddinCommands=!1;this.Cxg.Gd.qCb("0",3,F)}ABk(){this.JCb("ClickOnClose",this.AH);this.xJa()}BCk(){this.JCb("ClickOnDismiss",this.AH);this.xJa()}TCh(F,
V){if(V>this.qek)window.clearTimeout(this.wcd),this.SCh("[data-unique-id='pivotOverflowButton']"),r.ULS.sendTraceTag(512499845,220,50,"ShowTeachingCalloutWithPoll did not find the Addin Tab in time");else{var za=document.querySelector("button"+F);!za||za.hasAttribute("tabIndex")&&"-1"===za.getAttribute("tabIndex")?this.wcd=window.setTimeout(()=>{this.TCh(F,V+1)},1E3):(0<this.wcd&&window.clearTimeout(this.wcd),this.SCh(F))}}RCh(F){let V=document.querySelector("button[data-unique-id='RightPaddle']");
if(V)this.NWa("RightPaddlePresent",this.mfa);else if(F=(V=document.querySelector("button"+F))?window.getComputedStyle(V,null):null,!V||F&&"none"===F.display)if(V=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!V){this.NWa("NoAnchor",this.mfa);r.ULS.sendTraceTag(512499844,220,15,"ShowTeachingCalloutToAddinButton failed to get an anchorElement");this.xJa();return}this.PJh(V,"ShowTeachingUIForAddinButton")}SCh(F){let V=document.querySelector("button"+F);if(!V&&("[data-unique-id='pivotOverflowButton']"!==
F&&(V=document.querySelector("button[data-unique-id='pivotOverflowButton']")),!V)){this.NWa("NoAnchor",this.mfa);r.ULS.sendTraceTag(512499843,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.xJa();return}this.PJh(V,"ShowTeachingUIForAddinTab")}PJh(F,V){F.setAttribute("lpp-id","latestAddin");const za=fc.a.instance.Ia("Common.ISystemInitiatedFeedback");za&&F?(this.NWa("Show",this.mfa),za.execute(gb=>{gb.logActivity(V,null)}),r.ULS.sendTraceTag(512499841,220,50,"TriggerLPPActivity triggered an LPP activity")):
(this.NWa("NoSifFutureObject",this.mfa),r.ULS.sendTraceTag(512499842,220,15,"TriggerLPPActivity failed to get a sifFuture"),this.xJa())}O$i(F){if(!F||!F.zaa||!F.zaa.HF)return null;for(let V of F.zaa.HF)if(V)for(const za of V.groups)if(za)for(const gb of za.controls){if(gb&&gb.attributes&&0===gb.controlType&&gb.enabled)return gb.id;if(gb.menuItems)for(const Fb of gb.menuItems)if(Fb.attributes&&Fb.enabled)return gb.id}return null}NWa(F,V){Bd.Mea(F,this.aJ(V))}JCb(F,V){V=Telemetry.PrivacyRules.GetPrivacyCompliantId(V.solutionId,
V.storeType,V.assetId,null,null,V.storeId);Bd.Mea(F,V)}V0a(F){const V={};V[this.P5c]=Z.c({["LastTeachingUIShowTime"]:(new Date).toUTCString(),["AddinHasShown"]:F});(new ja(this.P5c,null,null,Object(D.a)(this,this.Eaa,"postRequestFailureCallback"))).Lwb(V);r.ULS.sendTraceTag(512499840,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}Eaa(F){r.ULS.sendTraceTag(512499811,306,15,"failed to POST data to Roaming Settings Service with status: {0}",
F?F.Ke:-1)}xJa(){if(!this.TXg){const F=window.g_roamingAddinList;F&&(this.V0a(F),this.TXg=!0)}}static Mea(F,V){F={["AppTeachingUICalloutAction"]:F,["SDX.Id"]:V,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ca.a.sendTelemetryEvent(Object.assign(new I.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:T.a.kz(F)}))}}Object(h.a)(Bd,"AddinTeachingCalloutHandler",null,[]);class Rc{}Object(h.a)(Rc,"AddinCommandsHost",null,[]);var Gf=d(79),Nf=
d(139);class Oa extends Gf.a{constructor(){super(void 0,void 0,void 0,!0);this.wTb="AddinCommandsUILessDialog";this.mQd="WACDialogTitleText";this.Rba="0";this.KP=380;this.vN=190;this.kg=this.wTb;this.Ad=5;this.eWh=String.format("{0}px",this.KP);this.Qba=String.format("{0}px",this.vN);this.Ffe=this.Ir=!1;this.Bu()}Bu(){super.Bu();this.rm.style.width=this.eWh;this.rm.style.height=this.Qba;this.rm.style.padding=this.Rba}eza(F){this.VA();document.getElementById(this.Uh(this.mQd)).innerText=F}VA(){super.VA();
this.Ib.style.width=String.format("{0}px",this.KP);this.Ib.style.height=String.format("{0}px",this.vN);this.Ib.removeAttribute(Nf.a.hf);this.Ib.removeAttribute(Nf.a.e_)}hide(){this.vge()}get fka(){return this.rm}initializeAndShowWithTitle(){this.pj(CommonUIStrings.l_NotificationUITitle,null,null)}}Object(h.a)(Oa,"AddinCommandsUILessDialog",Gf.a,[1001]);var cb=d(42),Ic=d(159),qd=d(39),le=d(340);class yb extends Rc{constructor(F,V,za,gb){super();this.I$=F;this.Oc=V;this.u9c=za;this.hhb=gb}setOwnerAddinEToken(F){this.I$.eToken=
F}showTaskpane(F,V,za){r.ULS.sendTraceTag(509699670,220,50,String.format("ShowTaskpane action called."));this.mkg(F,V,za,!0)||r.ULS.sendTraceTag(509699669,806,10,String.format("ShowTaskpane : instance id is null."))}showDialog(){}createUILessSandbox(F,V,za){r.ULS.sendTraceTag(509699668,220,50,String.format("UILess action called."));this.mkg(F,V,za,!1,this.u9c)||r.ULS.sendTraceTag(509699667,806,10,String.format("UILess : instance id is null."))}disposeHost(){}mkg(F,V,za,gb,Fb=!1){var Ec=this.Oc.zQ(F.solutionId);
Ec||(Ec=this.Oc.m5i(F,V,this.I$.solutionId,Fb));if(Ec&&this.Oc.Qua(Ec.instanceId))return this.Oc.ikb(Ec.instanceId),za(Ec.instanceId,0),Fb||this.Oc.qNb(Ec.instanceId,gb),!0;let $c=null;if(!Ec)if(Ec=this.Oc.iri(F,V,gb,this.I$.solutionId,Fb),Ec.setValue(qd.a.ownerAddinStoreType,this.I$.storeType),$c=Ec.sa(Ic.a.sharedRuntimeId,null),this.Ewg(!!$c,!0),Fb&&(Fb=Fb&&!$c),V=Fb?new Oa:null,Fb?this.Oc.Nlb(Ec,V.fka):(Ec.setValue(cb.a.X_b,gb||!!$c),this.Oc.xph(Ec)),Ec=this.Oc.zQ(F.solutionId))if(Fb&&this.hhb.$(Ec.instanceId,
V),F=this.Oc.sEa(this.I$.solutionId)){if(F=new le.a(F),this.Oc.OMh(F.id,Ec.instanceId),$c&&!this.Oc.g6b(F.xya)&&(F=this.Oc.q9d(F.xya)))F.qw||F.Nai($c),this.Oc.KIc(this.I$.solutionId,F)}else{F=this.Oc.hri(this.I$,$c);if(!F)return za(null,5001),!1;this.Oc.KIc(this.I$.solutionId,F);this.bak(!!$c)}else return za(null,5001),!1;za(Ec.instanceId,0);za=this.Oc.Qua(Ec.instanceId);this.Oc.qNb(Ec.instanceId,za?gb:!0);this.Ewg(!!$c,!1);return!0}Ewg(F,V){F&&window.performance&&window.performance.memory&&r.ULS.sendTraceTag(509699666,
802,50,"Shared runtime memory usage: before={0}, jsHeapSizeLimit={1}, totalJSHeapSize={2}, usedJSHeapSize={3}",V,window.performance.memory.jsHeapSizeLimit,window.performance.memory.totalJSHeapSize,window.performance.memory.usedJSHeapSize)}bak(F){r.ULS.sendTraceTag(509699665,802,50,"PPT WAC add-in created: SolutionId: {0}, StoreType: {1}, IsShareRuntime: {2}",Telemetry.PrivacyRules.GetPrivacyCompliantId(this.I$.solutionId,this.I$.storeType,this.I$.assetId,null,null,this.I$.storeId),this.I$.storeType,
F)}}Object(h.a)(yb,"WACPowerPointAddInCommandsHost",Rc,[]);var ef=d(192);class Cb{constructor(F,V,za,gb,Fb,Ec,$c,Ed,pe,Se,Ye){this.AH=this.W_g=null;if(!F)throw Error.argumentNull("app");this.fma=new C;this.$zg=za;this.Vb=F.aq;this.le=$c;this.Oc=V;this.gma=Ec;this.Oc.Igi(Object(D.a)(this,this.eBi,"clearLoadingAddinMessage"));this.fma.Sei(Object(D.a)(this,this.Tyj,"handleAddinCommandsLoadingMessageChanged"));this.Ea=gb;this.Jb=Fb;Md.a.d$b=Md.a.Mgh;this.hhb=new wb.a;this.RDb=pe;this.ul=Se;this.$fk=new e.a;
this.BDb=new e.a;this.Ic=Ye}get Gd(){return this.Oc}t4c(F){r.ULS.sendTraceTag(512499869,220,50,"LaunchOperationType {0}.",F[O.a.j8]);if(this.Ea.oBb||!this.Ea.Qca){var V=F[O.a.uJc];if(V&&0<V.count){const gb=V.count;for(let Fb=gb-1;0<=Fb;Fb--){const Ec=V.ga(Fb);OSF.OsfControl.isFirstPartyStoreString(Ec.storeType)||V.remove(V.ga(Fb))}V.count<gb&&(this.Ea.oBb&&!this.ul.tea(22)&&this.ul.UDa(22),this.Ea.Qca||this.ul.tea(36)||this.ul.UDa(36));if(!V.count)return}}let za=null;za=z.AFrameworkApplication.fa.ka("HostInstallAddInsIsEnabled")?
new xc(this.gma,this.$zg,new ic(this.Oc.Ui),new md("",Pc.a.p7a),this.fma,Ib.instance,new ud,(gb,Fb)=>{const Ec={};Ec.solutionId=gb.solutionId;Ec.version=gb.version;Ec.storeType=gb.storeType;Ec.storeId=gb.storeId;Ec.assetId=gb.assetId;Ec.assetStoreId=gb.assetStoreId;this.Oc.Exl(Ec,()=>{Fb(gb)})}):new xc(this.gma,this.$zg,new ic(this.Oc.Ui),new md("",Pc.a.p7a),this.fma,Ib.instance,new ud);za.dfi(Object(D.a)(this,this.RAk,"onAutoLaunchAddin"));za.Rei(Object(D.a)(this,this.DEk,"onLaunchAddinCommandsCompleted"));
this.Jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&(V=new Bd(this,this.Jb,this.Ic),za.Nfi(Object(D.a)(V,V.CEk,"onLaunchAddinButtonClicked")),za.jii(Object(D.a)(V,V.cvl,"showCalloutOnAddin")));try{Pd.a.get_instance().Mj(5,null).continueWith(()=>{za.b8j(this.RDb,fe.App.Lb.SF(),F)},11)}catch(gb){r.ULS.sendTraceTag(512499868,220,10,String.format("LaunchAddinCommands error message : {0}.",gb.message))}}Qyj(F){F=F[this.gma.RRa];F=(new Ud).FRd(F);return z.AFrameworkApplication.Qca||
OSF.OsfControl.isFirstPartyStoreString(F.ownerAddinInfo.storeType)}n9b(F){const V=new Ud;this.Oee(V,F[this.gma.RRa])}Oee(F,V){const za=F.FRd(V),gb=new yb(za.ownerAddinInfo,this.Oc,this.Ea.wla,this.hhb);F.n9b(V,this.fma,gb,new ic(this.Oc.Ui),za)}cjh(F){const V=be.cWk(this.fma);F[Be.a.LabelText]=V.labelText;F[Be.a.Visible]=V.visible}Pul(){this.d2e()}GOb(F){F&&O.a.ETd in F&&F[O.a.ETd]&&Jb.F1e(F[O.a.ETd].toString())}R1k(){if(this.fma.O4c()){this.fma.XJf();const F=this.u9d();if(F&&0<F.count)for(let V of F)this.xMb({["ack1"]:V,
["ack0"]:4,["ak0"]:(new Date).getTime()})}else this.Jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&(r.ULS.sendTraceTag(509669719,220,50,"refreshAllAddinCommands: LoadingCompleteForAllProviders() returns {0}",this.fma.O4c()),this.YU(10,!0),this.YU(0,!0))}Tyj(){this.le.Py(new ef.a(2));this.d2e()}CVk(F){F&&O.a.k8 in F?this.YU(F[O.a.k8],!0):r.ULS.sendTraceTag(509669718,220,10,"queryAddinDetailsWithActionData: invalid actionData.")}YU(F,V=!1){this.Oc?(r.ULS.sendTraceTag(509669716,
220,50,"QueryAddinDetails: providerType: {0}, refreshRequired: {1}",F,V),this.Oc.YU(F,V)):r.ULS.sendTraceTag(509669717,220,10,"QueryAddinDetails: abort because m_appForOfficeManager is null.")}xMb(F){r.ULS.sendTraceTag(512499867,220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",F[O.a.j8],F[O.a.k8]);this.fma.ojl();window.setTimeout(()=>{const V=new td(new ic(this.Oc.Ui),Ib.instance,gc.instance);V.Qei((za,gb)=>{this.Jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)&&this.YU(F[O.a.k8]);this.t4c(gb.properties)});V.lii((za,gb)=>{this.AH=gb;this.W_g=new Bd(this,this.Jb,this.Ic);this.W_g.D4k(this.AH)});V.FKl(F)},0)}eBi(){this.fma.XJf()}yoi(F){var V=this.Oc.zQ(F);if(V&&V.qw&&V.qw.Pya&&!(0>=V.qw.state)){var za=new Ud,gb=za.getTaskPaneControlIdFromSolutionIdRuntimeId(F,V.qw.Pya);gb&&(this.Oc.KIc(F,V),this.Oee(za,gb),this.Oc.aLf(F),(V=this.Oc.zQ(F+gb))?this.Oc.setInitialDisplayMode(V.instanceId,1):r.ULS.sendTraceTag(512499866,802,10,"Failed to find auto-loaded shared runtime pane for "+
F))}}Coi(F){if(F&&F.solutionId){var V=new Ud,za=V.Doi;if(za=F.solutionId in za?za[F.solutionId]:null){let gb=this.Oc.zQ(F.solutionId);if(!gb){gb=this.Oc.q9d(F.solutionId);if(!gb){r.ULS.sendTraceTag(512499864,220,15,String.format("AutoShowTaskPane appForOffice is null for {0}",Telemetry.PrivacyRules.GetPrivacyCompliantId(F.solutionId,F.storeType,F.assetId,null,null,F.storeId)));return}this.Oc.KIc(F.solutionId,gb)}F=gb.settings;(F=O.a.Vzf in F?F[O.a.Vzf]:null)&&"true"===F.toLowerCase()&&this.Oee(V,
za)}}else r.ULS.sendTraceTag(512499865,220,10,"LaunchAddInCommands AutoShowTaskPane failed. Invalid solution id.")}Lrl(F){if(void 0===F||null===F||void 0===F[this.gma.RRa]||null===F[this.gma.RRa])return!1;F=F[this.gma.RRa];return fa.a.Xa(F)?!1:this.BDb.contains(F)}Cnl(F){F=F.zaa;if(!F)r.ULS.sendTraceTag(512499863,220,15,"Ribbon Extensibility for React ribbons should not be null.");else if(F.HF)for(let V of F.HF)if(V.groups)for(const za of V.groups)if(za.controls)for(const gb of za.controls)if(this.P4e(gb.id,
gb.enabled),1===gb.controlType&&gb.menuItems)for(const Fb of gb.menuItems)this.P4e(Fb.id,Fb.enabled)}P4e(F,V){if(F&&F.length){var za=this.BDb.contains(F);za&&V&&this.BDb.remove(F);za||V||this.BDb.add(F)}}HNl(F){let V=null,za=null,gb=!0;void 0!==F[O.a.F4d]&&null!==F[O.a.F4d]&&void 0!==F[this.gma.RRa]&&null!==F[this.gma.RRa]&&void 0!==F[O.a.D4d]&&null!==F[O.a.D4d]&&(V=F[O.a.F4d],za=F[this.gma.RRa],gb=F[O.a.D4d]);fa.a.Xa(V)||fa.a.Xa(za)||(F=(new vb("",V,this.gma,!0)).LEa(za),this.P4e(F,gb),this.Vb.updateCommandUI())}H5b(F){if(void 0!==
F&&null!==F&&void 0!==F[O.a.E4d]&&null!==F[O.a.E4d])switch(F[O.a.E4d]){case 1:this.HNl(F);break;case 4:this.BDb.clear(),this.BDb.addRange(this.$fk)}}RAk(F,V){if(V)if(V)if(F=V.Qu,V=V.WH,!bb()&&!ha()||this.Oc.q9d(F.solutionId)){var za=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();(V=F.solutionId in za?za[F.solutionId]:this.Ldj(V))?(this.n9b({["SourceControlId"]:V}),F.isAutoLaunched=!0):r.ULS.sendTraceTag(512499860,220,15,"addinCommandControlId is null")}else r.ULS.sendTraceTag(512259016,
220,15,String.format("AppForOffice is null for {0}",Telemetry.PrivacyRules.GetPrivacyCompliantId(F.solutionId,F.storeType,F.assetId,null,null,F.storeId)));else r.ULS.sendTraceTag(512499861,220,15,"agaveParams is null");else r.ULS.sendTraceTag(512499862,220,15,"No args for OnAutoLaunchAddin event")}Ldj(F){if(!F)return r.ULS.sendTraceTag(512499859,220,10,"Failed to get button id for addin"),null;F=F.zaa;if(!F||!F.HF||!F.HF.count)return r.ULS.sendTraceTag(512499858,220,15,"It has 0 or multiple tabs"),
null;F=F.HF.ga(0);if(!F.groups||1!==F.groups.length)return r.ULS.sendTraceTag(512499857,220,15,"It has 0 or multiple groups"),null;F=F.groups[0];if(!F.controls||1!==F.controls.length)return r.ULS.sendTraceTag(512499856,220,15,"It has 0 or multiple buttons"),null;F=F.controls[0];return F.attributes&&0===F.controlType&&F.enabled?F.id:null}DEk(F,V){let za=null;V&&(za=V);za&&za.WH&&this.Cnl(za.WH);za?(za.Qu&&this.yoi(za.Qu.solutionId),this.Ea.cSj&&window.setTimeout(()=>{za.Qu&&this.Coi(za.Qu)},0)):r.ULS.sendTraceTag(512499855,
220,10,String.format("OnLaunchAddinCommandsCompleted EventArgs is null."))}u9d(){const F=new e.a;this.Ea.Iua&&(this.Ea.g0c&&F.add(0),this.Jb.ka("187")&&F.add(1),this.Jb.ka("305")&&F.add(10),F.add(8));return F}d2e(){const F=this.Jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)||this.Jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinHomeTabEntranceEnabled",!1),V=document.querySelector("[data-unique-id='ShowAddInCommandsLoadStatusCallout']");be.ACh(this.fma,
this.Vb.SF(),V,F?ResourceStrings.L_TabHome:ResourceStrings.L_Insert,CommonUIStrings.L_ButtonOfficeAddins)}huc(F){F&&this.hhb.Fb(F)&&this.hhb.ga(F).initializeAndShowWithTitle()}c$b(F){F&&this.hhb.Fb(F)&&this.hhb.ga(F).hide()}}Object(h.a)(Cb,"AddinCommandsManager",null,[684]);class oc{constructor(){this.B_g={["tabhome"]:"PptRibbon.Home",["tabinsert"]:"PptRibbon.InsertTab",["tabdesign"]:"PptRibbon.Design",["tabtransitions"]:"PptRibbon.Transition",["tabanimations"]:"PptRibbon.Animation",["tabview"]:"PptRibbon.View"};
this.KMg={["tabslideshow"]:["PptRibbon.SlideShow",ResourceStrings.l_SlideShowTab,CommonUIStrings.l_SlideShowTabKeytip],["tabreview"]:["PptRibbon.Review",ResourceStrings.L_ReviewTab,CommonUIStrings.l_ReviewTabKeytip],["tabdeveloper"]:["PptRibbon.Developer",ResourceStrings.l_DeveloperTab,CommonUIStrings.l_DeveloperTabKeytip],["tabaddins"]:["PptRibbon.AddIns",ResourceStrings.l_AddInsTab,CommonUIStrings.l_AddInsTabKeytip]};this.Had=null}get RRa(){return"SourceControlId"}get PT(){return"Presentation"}get formFactor(){return"DesktopFormFactor"}hlj(){if(!this.Had){this.Had=
{};for(const F of Object.keys(this.B_g))this.Had[F]=this.B_g[F];for(const F of Object.keys(this.KMg))this.Had[F]=this.KMg[F][0]}}}Object(h.a)(oc,"AddinCommandsStringProvider",null,[682]);class vc{constructor(F){this.CHi=F}x9i(){return this.CHi.zri()}}Object(h.a)(vc,"ContextMenuExtensibilityHandler",null,[683]);var nd=d(82),id=d(33);class Nd{constructor(F,V,za,gb){this.iCe=null;this.Oc=F;this.T_g=V;this.pa=za;this.Rf=gb}get Xcc(){return this.iCe}set Xcc(F){this.iCe=F}register(){this.pa.fE(Object(D.a)(this,
this.vrd,"selectionChangeEventHandler"));id.a("ExtensibilitySlideSelectionChangedEventFix")&&this.Rf.y7a(Object(D.a)(this,this.vrd,"selectionChangeEventHandler"))}dispose(){this.pa.Xoa(Object(D.a)(this,this.vrd,"selectionChangeEventHandler"));id.a("ExtensibilitySlideSelectionChangedEventFix")&&this.Rf.drc(Object(D.a)(this,this.vrd,"selectionChangeEventHandler"))}vrd(){try{this.Xcc&&this.T_g.Lg(this.Xcc),this.iCe=new nd.a(4,1,0,()=>{this.Xcc=null;this.oIl()},90,"50"),this.T_g.Hb(this.Xcc)}catch(F){r.ULS.sendTraceTag(18442309,
802,10,F.toString())}}oIl(){try{this.Oc.Zjh(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent.toString(),null);const V=this.pa.hk();if(V){var F=V.Uj();if(F)for(const za of F)if(za.Jq){const gb=new le.a(za);this.Oc.l0a(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent.toString(),gb.id,null)}}}catch(V){r.ULS.sendTraceTag(18442310,802,10,V.toString())}}}Object(h.a)(Nd,"AppForOfficeApiSelectionChangeEventListener",null,[669,107]);var Ce=d(556),af=d(1E3),de=d(737);class $f{}$f.generalException=
"generalException";$f.invalidArgument="invalidArgument";$f.notAllowed="notAllowed";$f.apiNotAvailable="apiNotAvailable";$f.unresolvedPendingRequest="unresolvedPendingRequest";$f.timeout="timeout";$f.adalTimeout="adalTimeout";$f.userNotSignedIn="userNotSignedIn";$f.userAborted="userAborted";$f.silentSignInFailed="silentSignInFailed";$f.invalidResourceUrl="invalidResourceUrl";$f.invalidGrant="invalidGrant";$f.connectionLost="connectionLost";$f.clientError="clientError";$f.serverError="serverError";
Object(h.a)($f,"WopiHostErrorCodes",null,[]);var ge=d(227);class ze{}Object(h.a)(ze,"OAuthCallerMetadata",null,[]);var si=d(55);class sh{constructor(F){this.xM=F;this.QXh=z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}iai(F,V,za,gb,Fb,Ec){if(!this.xM)return gb=new af.a,gb.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(gb);const $c=new ze;$c.AddinName=Fb;$c.AddinTrustId=Ec;let Ed=-1;Ec=null;if(gb&&this.fpg())Ec=
this.xM.GKh(O.a.pwd,F,gb,sh.J$f(Fb),$c);else{const pe=Date.now();Ec=this.xM.gI(O.a.pwd,F,$c).then(Se=>{Ed=Date.now()-pe;const Ye=(V||za)&&"login_required"===Se.ErrorCode;return(V&&("interaction_required"===Se.ErrorCode||"consent_required"===Se.ErrorCode||"invalid_grant"===Se.ErrorCode)||Ye)&&this.fpg()?this.xM.GKh(O.a.pwd,F,null,sh.J$f(Fb),$c):Promise.resolve(Se)})}return Ec.then(pe=>{const Se=new af.a;pe.IsSuccess?(Se.token=pe.Token,pe.Telemetry&&(Se.Wmb=pe.Telemetry.fromCache,Se.expiresOn=pe.Telemetry.expiresOn)):
(Se.errorCode=this.Stk(pe),Se.t5e=this.gMk(pe));return Se}).catch(()=>{const pe=new af.a;pe.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(pe)}).then(pe=>{pe.LCa="OauthManager";0<=Ed&&(pe.R8b=Ed);return pe})}jWj(F){const V=(z.AFrameworkApplication.fa.Ha(z.AFrameworkApplication.wK)||"").toLowerCase();return(si.a.xGa||"teams"===V&&ge.OAuthManagerSettings.lbb)&&!sh.DVj(F)||!this.xM||!this.xM.mmg()?!1:!0}fpg(){return this.QXh||1!==de.a.iUc()}Stk(F){switch(F.ErrorCode){case "UserCancelled":case "interaction_required":F=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":F=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":F=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":F=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":F=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":F=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;
break;default:F=F.ErrorCode===$f.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:F.ErrorCode===$f.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:F.ErrorCode===$f.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:F.ErrorCode===$f.invalidGrant?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:F.ErrorCode===$f.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return F}gMk(F){let V=
"";(F=RegExp("AADSTS(\\d+)").exec(F.ErrorMessage))&&1<F.length&&(V=F[1]);return V}static J$f(F){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,F)}static DVj(F){if(!F)return!1;F=F.toLowerCase();for(const V of Ce.AppsForOfficeSingleSignOnManager.WSc)if(V===F)return!0;return!1}}Object(h.a)(sh,"AppsforOfficeTokenFromOauthManager",null,[793]);class dd{constructor(F){this.$rk=F}static P7e(){if(z.AFrameworkApplication.fa.ka("AppForOfficeSSOV2IsEnabled")){var F=
null;try{F=fc.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(V){r.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+V)}F=new sh(F);dd.La=new dd(F)}}static getInstance(){dd.Jif||(dd.P7e(),dd.Jif=!0);return dd.La}}dd.La=null;dd.Jif=!1;Object(h.a)(dd,"AppsForOfficeOauthManagerFactory",null,[759]);class Lc{constructor(F){const V=dd.getInstance();this.qtf=new Ce.AppsForOfficeSingleSignOnManager(F,V)}getAccessTokenAsync(F,V){return new Promise(za=>{const gb=z.AFrameworkApplication.fa.ka("342");
this.qtf.getAccessToken(F,gb,V,(Fb,Ec)=>{const $c={};$c.errorCode=Fb;$c.accessToken=Ec?Ec.accessToken:"";za($c)})})}removeCallbackForAddin(F){this.qtf.removeCallbackForAddin(F)}}Object(h.a)(Lc,"AppForOfficeAuthProvider",null,[710]);class Zd{MJi(F){return new Lc(F)}}Object(h.a)(Zd,"AppForOfficeAuthFactory",null,[558]);var Ne=d(236),Xc=d(62),lf=d(49),Kh=d(634);class bd{constructor(F,V,za,gb,Fb,Ec,$c){this.cGe=this.bGe=this.IDe=this.HDe=0;this.QNg=.5;this.dFb=null;this.qze=0;this.Gek={};this.vic=document.createElement("div");
this.vic.className="OsfAddinOverlay";V.appendChild(this.vic);za.qll(this.vic);this.htk=F;this.VJ=$c;this.VJ.YIc(Object(D.a)(this,this.nJb,"onZoomed"));this.ta=gb;this.Kc=Fb;this.Vq=Ec;this.Vq.aT(Object(D.a)(this,this.GUe,"registerSlideViewElementEvents"))}dispose(){this.VJ.Yod(Object(D.a)(this,this.nJb,"onZoomed"));this.Vq.Uoa(Object(D.a)(this,this.GUe,"registerSlideViewElementEvents"))}initialize(){if(this.ta.Ba){this.GUe(null,null);const F=this.Kc.Jc;F&&(this.HDe=parseFloat(F.UU.style.left),this.IDe=
parseFloat(F.UU.style.top),this.bGe=parseFloat(F.we.va.style.left),this.cGe=parseFloat(F.we.va.style.top))}this.v9e();this.nJb(null,new Kh.a(this.htk.zoom))}GUe(F,V){(F=this.Kc.Jc)&&F!==this.dFb&&(F.tii(Object(D.a)(this,this.eOh,"updateOffsetFromSlideView")),F.thi(Object(D.a)(this,this.dOh,"updateOffsetFromPageContentContainer")),this.dFb&&(this.dFb.e9k(Object(D.a)(this,this.eOh,"updateOffsetFromSlideView")),this.dFb.C8k(Object(D.a)(this,this.dOh,"updateOffsetFromPageContentContainer")),this.O4e(this.dFb,
!1)),V&&V.$2c&&1!==this.qze&&this.O4e(F,!0),this.dFb=F)}O4e(F,V){if(F&&(F=F.gd)&&F.isConnected){var za=F.Uj();if(za&&za.length)for(const Fb of za)if(Fb.Jq){za=Fb.sa(qd.a.b_,null);var gb=Xc.a.Uy(F.eb(qd.a.sid),F.eb(qd.a.cid)).toString();const Ec=Fb.get_shapeId().toString();za=za+Ec+gb;id.a("Microsoft.Office.SharedOnline.FixBug6808089")?(gb=Fb.tg(0),(null===gb||void 0===gb?0:gb.va)?this.ELa(za,V,gb.va.qe):this.ELa(za,V,null)):this.ELa(za,V,null)}}}L6(F){this.qze=F;const V=this.Kc.Jc;V?(r.ULS.sendTraceTag(512369926,
806,50,"AppForOfficeContentAppsContainer.SwitchToMode: Hide the addin container on active slide('{0}#{1}').",V.gd.sid,V.gd.cid),this.O4e(V,2===F)):r.ULS.sendTraceTag(512369925,806,50,"AppForOfficeContentAppsContainer.SwitchToMode: SlideViewElement is null.")}dOh(F,V){this.HDe=V.x;this.IDe=V.y;this.v9e()}eOh(F,V){this.bGe=V.x;this.cGe=V.y;this.v9e()}v9e(){this.vic.style.left=lf.a.Pc(this.HDe+this.bGe+Ne.a.E6-this.QNg);this.vic.style.top=lf.a.Pc(this.IDe+this.cGe+Ne.a.E6-this.QNg)}JSj(F){return F in
this.hsa}Eel(F,V){this.hsa[F]=V}ELa(F,V,za){1===this.qze&&V||F in this.hsa&&this.hsa[F].ELa(V,za)}qnh(F){F in this.hsa&&(this.hsa[F].dispose(),delete this.hsa[F])}vZe(F,V){F in this.hsa&&this.hsa[F].vZe(V)}nJb(){}get hsa(){return this.Gek}}Object(h.a)(bd,"AppForOfficeContentAppsContainer",null,[678,107]);var fd=d(406);class Ve extends x.StandardDialog{constructor(F,V){super();this.tVh=CommonUIStrings.l_AppsforOfficeDeveloperModeCheckboxLabel;this.hYh=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrlText;
this.iYh=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrl;this.dXh=F;this.vTb=V}showDialog(F,V){const za=new Gf.a(void 0,void 0,!1);za.Ad=0;za.kg=fd.a.iod(Number.MAX_VALUE).toString();za.sg=String.format("<div style=\ufffdheight:100px;width:400px;border:none;\ufffd><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>",V,this.iYh,this.hYh,this.tVh);za.pj(F,Object(D.a)(this,this.vBk,"onCheckboxExecute$4"),{optInCheckbox:!1})}vBk(F,
V){1===F&&V.optInCheckbox&&(v.a.instance.getItem("optedIntoAddinDeveloperMode")?v.a.instance.removeItem("optedIntoAddinDeveloperMode"):(v.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.luc()))}luc(){const F=new x.StandardDialog;F.Ad=4;const V=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.dXh)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;F.sP(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,
V,this.vTb)}}Object(h.a)(Ve,"AppForOfficeDeveloperModeOptInDialog",x.StandardDialog,[]);const rf=F=>{const V=[];if(!F)return V;V[OSF.DDA.Marshaling.ThemingKeys.Accent1]=Ag(F.Accent1);V[OSF.DDA.Marshaling.ThemingKeys.Accent2]=Ag(F.Accent2);V[OSF.DDA.Marshaling.ThemingKeys.Accent3]=Ag(F.Accent3);V[OSF.DDA.Marshaling.ThemingKeys.Accent4]=Ag(F.Accent4);V[OSF.DDA.Marshaling.ThemingKeys.Accent5]=Ag(F.Accent5);V[OSF.DDA.Marshaling.ThemingKeys.Accent6]=Ag(F.Accent6);V[OSF.DDA.Marshaling.ThemingKeys.Background1]=
Ag(F.OsfColorScheme?F.OsfColorScheme.Background1:null);V[OSF.DDA.Marshaling.ThemingKeys.Background2]=Ag(F.OsfColorScheme?F.OsfColorScheme.Background2:null);V[OSF.DDA.Marshaling.ThemingKeys.Text1]=Ag(F.OsfColorScheme?F.OsfColorScheme.Text1:null);V[OSF.DDA.Marshaling.ThemingKeys.Text2]=Ag(F.OsfColorScheme?F.OsfColorScheme.Text2:null);V[OSF.DDA.Marshaling.ThemingKeys.Hyperlink]=Ag(F.Hyperlink);V[OSF.DDA.Marshaling.ThemingKeys.FollowedHyperlink]=Ag(F.FollowedHyperlink);const za=F.OsfFontScheme;za&&(V[OSF.DDA.Marshaling.ThemingKeys.HdEastAsian]=
za.HdEaFt,V[OSF.DDA.Marshaling.ThemingKeys.HdLatin]=za.HdLtnFt,V[OSF.DDA.Marshaling.ThemingKeys.HdLocalized]=za.HdLclFt,V[OSF.DDA.Marshaling.ThemingKeys.HdScript]=za.HdSptFt,V[OSF.DDA.Marshaling.ThemingKeys.BdEastAsian]=za.BdEaFt,V[OSF.DDA.Marshaling.ThemingKeys.BdLatin]=za.BdLtnFt,V[OSF.DDA.Marshaling.ThemingKeys.BdLocalized]=za.BdLclFt,V[OSF.DDA.Marshaling.ThemingKeys.BdScript]=za.BdSptFt);V[OSF.DDA.Marshaling.ThemingKeys.BackgroundColor]=Ag(F.Background);return V},Ag=F=>{if(!F)return null;let V;
V=F.b;V+=F.g<<8;return V+=F.r<<16};class ne{constructor(F,V,za){this.VNg=F;this.dR=V;this.dhk=za}register(){this.VNg.fk(Object(D.a)(this,this.vIh,"themeChangedCallback"))}dispose(){this.VNg.Om(Object(D.a)(this,this.vIh,"themeChangedCallback"))}vIh(F,V){if(V.node.Ua(qd.a.Ed)&&(V.property===qd.a.Ed||V.property===qd.a.Fba)){F=V.node;try{var za=rf(F?F.Ed:null)}catch(gb){return}if(F){F=F.Uj();for(const gb of F)gb.Jq&&(F=this.dhk.z3(gb),this.dR.l0a(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent.toString(),
F.id,za))}this.dR.Zjh(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent.toString(),za)}}}Object(h.a)(ne,"AppForOfficeDocumentThemeListener",null,[669,107]);var kf=d(222);class kg extends Gf.a{constructor(F,V,za){super();this.Jra=null;this.mQd="WACDialogTitleText";this.Rba="0";this.tqa="15px";this.dWh="0px";this.Qba="calc(100% - 30px)";this.cWh="100%";this.Vqf=0;this.Ma=new N.a;this.KTh=new G;this.Ad=5;this.kg=this.wTb=za;this.DDd=F;this.ref=V;this.dEd=!!z.AFrameworkApplication.fa&&z.AFrameworkApplication.fa.ka("OfficeAddinEnableInsertDialogAccessibilityFix")}qgi(F){this.Ma.addHandler("OnDialogClosedEventKey",
F)}gml(){this.Vqa=null}Bu(){super.Bu();this.rm.style.width="100%";this.rm.style.height=this.T9b?this.Qba:this.cWh;this.rm.style.marginTop=this.T9b?this.tqa:this.dWh;this.rm.style.padding=this.Rba}VA(){super.VA();this.Ib.style.width=String.format("{0}px",this.DDd*window.innerWidth/100);this.Ib.style.height=String.format("{0}px",this.ref*window.innerHeight/100);this.Ib.style.minWidth="0px";this.dEd&&z.AFrameworkApplication.isRtl&&100===this.DDd&&(this.Ib.style.right="0px",this.Ib.style.marginRight=
"0px");this.Jra=document.getElementById(this.Uh(this.mQd));this.Jra.style.position="absolute";this.Jra.style.whiteSpace="nowrap";this.Jra.style.textOverflow="ellipsis";z.AFrameworkApplication.isRtl?(this.Jra.style.right="14px",this.Jra.style.left="44px"):(this.Jra.style.right="44px",this.Jra.style.left="14px")}eza(F){super.eza(F);this.Jra&&this.Jra.setAttribute("title",F)}get fka(){return this.rm}HWe(){this.Ib.style.width=String.format("{0}px",this.DDd*window.innerWidth/100);this.Ib.style.height=
String.format("{0}px",this.ref*window.innerHeight/100);this.Ib.style.overflowY="hidden";this.Ib.style.overflowX="hidden";this.Ib.style.marginTop="";this.Ib.style.top="";si.a.rcb&&z.AFrameworkApplication.isRtl?(this.Ib.style.right="",this.Ib.style.marginRight=""):(this.Ib.style.left="",this.Ib.style.marginLeft="")}hide(){this.KTh.jOf(3,this.wTb).execute(this,M.getInstance(),{});this.Vqf=window.setTimeout(()=>{this.Ma.raiseEvent("OnDialogClosedEventKey",this.wTb);kf.a.prototype.hide.call(this)},500)}D$g(F){3===
F&&(window.clearTimeout(this.Vqf),this.Ma.raiseEvent("OnDialogClosedEventKey",this.wTb),super.hide())}}Object(h.a)(kg,"AppsForOfficeDialog",Gf.a,[693,674]);class Af{constructor(){this.dialog=this.kg=null}}Object(h.a)(Af,"DialogInfo",null,[]);class Wf{}Wf.url="url";Wf.height="height";Wf.width="width";Wf.R3d="displayInIframe";Wf.eZc="hideTitle";Object(h.a)(Wf,"DialogSettings",null,[]);class vf{constructor(){this.height=this.width=0;this.kg=this.controlId=this.pageUrl=null;this.eZc=this.R3d=!1}}Object(h.a)(vf,
"DisplayDialogParams",null,[]);class De extends Sys.EventArgs{constructor(F,V,za=null,gb="",Fb=""){super();this.controlId=F;this.messageType=V;this.messageContent=za;this.GIe=gb;this.DMa=Fb}}Object(h.a)(De,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class Ee extends Sys.EventArgs{constructor(F,V,za=null,gb="",Fb=""){super();this.controlId=F;this.messageType=V;this.messageContent=za;this.GIe=gb;this.DMa=Fb}}Object(h.a)(Ee,"OnMessageParentEventArgs",Sys.EventArgs,[]);var Jd=d(106);class Og{constructor(F){this.Ma=
new N.a;this.cB=F}Ogi(F){this.Ma.addHandler("OnMessageParentEventKey",F)}Noh(F){this.Ma.removeHandler("OnMessageParentEventKey",F)}Ngi(F){this.Ma.addHandler("OnMessageDialogEventKey",F)}i8k(F){this.Ma.removeHandler("OnMessageDialogEventKey",F)}showDialog(F,V,za,gb){if(Og.iqa.Fb(V))r.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),za(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{const Ye=Z.b(F),ae=Ye[Wf.url];if(this.cB.getOsfControl(V).checkAppDomains(ae)){var Fb=
new vf;Fb.width=Ye[Wf.width];Fb.height=Ye[Wf.height];Fb.pageUrl=ae;Fb.R3d=Ye[Wf.R3d];Fb.eZc=Ye[Wf.eZc];Fb.controlId=V;Fb.kg=Jd.a.create().toString();var Ec=new Af;Ec.kg=Fb.kg;var $c=this.cB.getOsfControl(Fb.controlId).getManifest().getDefaultDisplayName(),Ed=this.cB.getOsfControl(Fb.controlId).getStoreType().toLowerCase();F=null;F=(4===z.AFrameworkApplication.Aa.ob.zk&&"hardcodedpreinstall"===Ed||"sdxcatalog"===Ed)&&Fb.eZc?this.createAndShowAppsForOfficeDialog(Fb.width,Fb.height,Fb.kg,!0,$c):this.createAndShowAppsForOfficeDialog(Fb.width,
Fb.height,Fb.kg,!1,$c);var pe=this.cB.getOsfControl(Fb.controlId),Se=pe.getManifest();V={};V.id=Fb.kg;V.solutionId=pe.getSolutionId();V.version=pe.getVersion();V.storeType=Ed;V.storeId=pe.getStoreId();V.assetId=pe.getAssetId();V.assetStoreId=pe.getAssetStoreId();V.ownerAddinSolutionId=pe.getOwnerAddinSolutionId();V.ownerAddinStoreType=pe.getOwnerAddinStoreType();V.appDomains=Se.getAppDomains();V.dialogUrl=ae;V.osfControlType=1;V.agaveName=$c;V.div=F.fka;r.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",
Telemetry.PrivacyRules.GetPrivacyCompliantId(V.solutionId,V.ownerAddinStoreType||V.storeType,V.assetId,null,null,V.storeId),fa.a.iL(Fb.pageUrl));this.cB.insertDialogControl(V);F.qgi(Object(D.a)(this,this.nCk,"onDialogClosed"));Ec.dialog=F;Og.iqa.$(Fb.controlId,Ec);gb&&gb(V);za(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else r.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),za(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(Ye){r.ULS.sendTraceTag(18371104,
344,10,"ShowDialog: action failed. Exception message: {0}",Ye.message),za(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}awk(F,V,za,gb){z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||""===gb&&(gb=za);try{const Fb=this.LEa(F);Fb&&this.Ma.raiseEvent("OnMessageParentEventKey",new Ee(Fb,OSF.DialogMessageType.DialogMessageReceived,V,za,gb))}catch(Fb){return r.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",
Fb.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}gCi(F,V){if(Og.iqa.Fb(F))try{const za=Og.iqa.ga(F);za.dialog&&za.dialog.hide();this.cB.purgeDialogControl(za.kg);Og.iqa.remove(F);V(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(za){r.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",za.message),V(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else r.ULS.sendTraceTag(18896286,344,
10,"CloseDialog: agave dialog map does not has dialog info for this control."),V(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}whl(F,V,za,gb){z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||""===gb&&(gb=za);if(Og.iqa.Fb(F)&&(F=Og.iqa.ga(F),F.dialog))try{this.Ma.raiseEvent("OnMessageDialogEventKey",new De(F.kg,OSF.DialogMessageType.DialogParentMessageReceived,V,za,gb))}catch(Fb){r.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",
Fb.message)}}LEa(F){let V=null;for(let za of Og.iqa)if(za.value.kg===F){V=za.key;break}return V}nCk(F,V){if(F=this.LEa(V))this.cB.purgeDialogControl(V),Og.iqa.remove(F),this.Ma.raiseEvent("OnMessageParentEventKey",new Ee(F,OSF.DialogMessageType.DialogClosed,null,null,"*"))}createAndShowAppsForOfficeDialog(F,V,za,gb,Fb){F=new kg(F,V,za);Fb=gb?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,Fb);gb&&(F.T9b=!1,F.Ir=!1);F.pj(Fb,null,null);F.gml();return F}static tdg(){return Og.iqa}static getInstance(F){Og.La||
(Og.La=new Og(F));return Og.La}}Og.La=null;Og.iqa=new wb.a;Object(h.a)(Og,"AppsForOfficeDialogManager",null,[666]);var Rg=d(732),Eg=d(67),xf=d(120),hd=d(95),yf=d(177),cd=d(125);class cg extends Sys.EventArgs{constructor(F){super();this.Oca=F}}Object(h.a)(cg,"AppForOfficeFocusOnAddinPaneEventArgs",Sys.EventArgs,[]);var xh=d(48);class Yf{constructor(F,V,za,gb,Fb,Ec){this.cR=[];this.GHe=new Rg.a;this.Fa=V;this.Qr=za;this.kb=gb;this.Oc=Fb;this.le=Ec}get h3(){return this.cR}get Gd(){return this.Oc.value}Cfe(){return 0<
this.dmc}YZ(F){F&&(this.h3.push(F),1===this.dmc&&this.Fa.tj(cd.a.aXd,!0),F.isVisible&&this.Qr.addHandler(F.va,Eg.a.Bf,Object(D.a)(this,this.Vfg,"handleShortCutsOnAddinPane")))}Tnh(F){F&&(Array.remove(this.cR,F),this.Qr.removeHandler(F.va,Eg.a.Bf,Object(D.a)(this,this.Vfg,"handleShortCutsOnAddinPane")),this.dmc||this.Fa.tj(cd.a.aXd,!1))}L6(F){if(1===F||2===F){if(1===F){this.GHe=new Rg.a;for(const V of this.h3)V.isVisible&&this.GHe.add(V.id.toLowerCase())}F=2===F;for(const V of this.h3)this.GHe.contains(V.id.toLowerCase())&&
(V.Xp(F),(F&&1===this.dmc||!F&&!this.dmc)&&this.Fa.tj(cd.a.aXd,F))}}lCj(F,V){for(const za of this.cR)F=za.layout(F,V)}RU(F,V){if(F){F=null;if(V===xh.a.vg)for(V=this.cR.length-1;0<=V;V--){if(this.cR[V].isVisible){F=this.cR[V];break}}else if(V===cd.a.kGf||V===cd.a.Ati||V===xf.AFrame.fW||V===xf.AFrame.t6b||V===cd.a.o3||V===cd.a.Fti||V===xh.a.cF||V===xh.a.jJ||V===xh.a.OW)for(V=0;V<this.cR.length;V++)if(this.cR[V].isVisible){F=this.cR[V];break}this.f8d(F)}}f8d(F){if(F){var V=this.Gd.OSc(F.id);V&&this.le.oXk(new cg(V.Oca));
this.Gd.notifyAgave(F.id,11)}else r.ULS.sendTraceTag(508891138,806,10,"Focus could not be put on the null addin pane!")}h7i(F,V){var za;for(za=0;za<this.cR.length&&this.cR[za].id!==F;za++);if(za===this.cR.length)r.ULS.sendTraceTag(508891137,806,10,String.format("Failed to find the taskpane with instance id: {0}",F)),this.o7e(V);else{F=null;if(5===V)for(--za;0<=za;za--){if(this.cR[za].isVisible){F=this.cR[za];break}}else if(6===V)for(za+=1;za<this.cR.length;za++)if(this.cR[za].isVisible){F=this.cR[za];
break}F?this.f8d(F):this.o7e(V)}}H1f(F){for(const V of this.cR)if(V.id===F){hd.FocusManager.Zq(V.mCi);return}r.ULS.sendTraceTag(508891136,806,10,String.format("Failed to focus on addinpane's the close button with instance id: {0}",F))}$Jl(F){for(let V of Og.tdg())if(V.value.kg.toLowerCase()===F.toLowerCase())return V.value.dialog.hide(),V.key;return null}o7e(F){5===F?this.Fa.CUa(!1):6===F&&this.Fa.CUa(!0)}WYf(){const F=this.kb.Xd();F&&1===F.length&&(this.kb.selectShape(F[0],!0),this.Fa.Bd())}get dmc(){let F=
0;for(const V of this.h3)V.isVisible&&F++;return F}Vfg(F){if(F.keyCode===yf.a.pZ&&F.ctrlKey)for(var V=0;V<this.h3.length;V++){var za=this.h3[V];if(za.isVisible&&za.va.contains(F.target)){za=null;if(F.shiftKey)for(V+=1;V<this.h3.length;V++){if(this.h3[V].isVisible){za=this.h3[V];break}}else for(--V;0<=V;V--)if(this.h3[V].isVisible){za=this.h3[V];break}za&&(this.f8d(za),F.preventDefault(),F.stopPropagation());break}}}vf(F){this.Fa.vf(F)}}Object(h.a)(Yf,"AppForOfficeFocusManager",null,[677]);var Hf=
d(965);class ji{lKi(F,V,za){F=Hf.a.Ibg(F.Nib);F.appName=OSF.AppName.PowerpointWebApp;F.clientMode=1;F.formFactor="DefaultSettings";F.hostControl=V;V=fc.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManager");F.allowExternalMarketplace=F.allowExternalMarketplace&&V.N2b;za.register(F);za=new OSF.ContextActivationManager(F);za.setWSA(z.AFrameworkApplication.mj);return za}}Object(h.a)(ji,"AppForOfficeImportedClassFactory",null,[676]);class Qi{constructor(F){this.ayg=F}tUe(){for(const F of this.ayg)F.register()}dispose(){for(const F of this.ayg)F.dispose()}}
Object(h.a)(Qi,"AppForOfficeListenerManager",null,[675,107]);var ah=d(1245),Kd=d(1246),Qd=d(151),Gg;(function(F){F[F.myAddins=0]="myAddins";F[F.adminManaged=1]="adminManaged";F[F.popular=2]="popular"})(Gg||(Gg={}));Object(h.b)("AddinCollectionType",Gg);class Sg{constructor(){this.downloadNumber=this.AUP=this.priority=0}}Object(h.a)(Sg,"AddinDetailInfo",null,[]);class Wh{constructor(F){this.solutionIds=null;this.errorCode=0;this.failure=null;this.Csa=F}}Object(h.a)(Wh,"AddinCollection",null,[]);class Bg extends Sys.EventArgs{constructor(F,
V,za,gb=null){super();this.a_=F;this.errorCode=V;this.lW=za;this.failure=gb}}Object(h.a)(Bg,"AddinDetailsRefreshedEventArgs",Sys.EventArgs,[]);class oh{constructor(F){this.errorCode=F;this.lW=[];this.failure=null}}Object(h.a)(oh,"GetAddinDetailsResult",null,[]);var Yj=d(387);class Gh{}Object(h.a)(Gh,"GetEntitlementDetailsParameters",null,[]);var Xh=d(156),Yg=d(199),dg=d(6);class Od{constructor(F,V,za=null){this.Ma=new N.a;this.hw=new ah.a(Kd.a.Ml());this.Fn=new Qd.a;this.W2=null;this.Pia=new Yg.a;
this.Pia.add(OSF.StoreTypeEnum.MarketPlace,0);this.Pia.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Oa=F;this.cB=V;this.bB=za;this.dVb=Od.F7b(F,"https://store-images.s-microsoft.com");this.HQa(Object(D.a)(this,this.aib,"onAddinDetailsRefreshed"))}get qTa(){return!!this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}get Rac(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get Ui(){return this.cB.value}C$a(F){if(!this.vla(F))return F=
Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:Gg[F]}),Object.assign(new oh(1),{failure:F});if(this.Fn.ga(F).failure)return Object.assign(new oh(this.Fn.ga(F).errorCode),{failure:this.Fn.ga(F).failure});r.ULS.shipAssertTag(509870082,220,!!this.Fn.ga(F).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",F);const V=new oh(0);for(let za of this.Fn.ga(F).solutionIds)this.hw.Fb(za)&&Array.add(V.lW,this.hw.ga(za));return V}U6b(F){return this.hw.Fb(F)?
this.hw.ga(F):null}BUe(F){if(F){this.HQa(F);for(let za of this.Fn.keys)if(this.vla(za)&&!this.Fn.ga(za).failure){r.ULS.shipAssertTag(509870081,220,!!this.Fn.ga(za).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",za);var V=[];for(let gb of this.Fn.ga(za).solutionIds)Array.add(V,this.hw.ga(gb));V=new Bg(za,this.Fn.ga(za).errorCode,V);F(null,V)}}}YU(F,V=!1){0!==F&&10!==F?r.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",
Yj.a[F]):this.qpc(F,Object(D.a)(this,this.Umc,"onQueryAddinDetailsCompleted"),V)}HQa(F){this.Ma.addHandler(O.a.Ssb,F)}Umc(F,V,za){if(za)if(Od.Adc(F,za,window.performance.now()-V),0===za.errorCode){let Fb;if(za.value){let Ec=0;Fb=Array(za.value.length);za.value.forEach($c=>{Fb[Ec++]=$c})}else Fb=[];this.MM(F,Fb)}else if(-1===za.errorCode||10===za.errorCode)this.MM(F,[]);else{var gb={};gb.collectionType=Gg[F];gb.invokeResultCode=za.errorCode;gb["queryResult.Value"]=za.value?String.format("Length: {0}",
za.value.length):"null";gb.queryStart=V;gb.queryDuration=window.performance.now()-V;this.Fn.$(F,Object.assign(new Wh(F),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",gb)}));r.ULS.sendTraceTag(512231324,220,15,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",Gg[F],this.Fn.ga(F).failure.toString(),JSON.stringify(this.Fn.ga(F).failure))}else gb={},gb.collectionType=Gg[F],gb.queryResult=za?"not null":
"null",gb.queryStart=V,gb.queryDuration=window.performance.now()-V,this.Fn.$(F,Object.assign(new Wh(F),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",gb)})),r.ULS.sendTraceTag(512231323,220,10,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",Gg[F],this.Fn.ga(F).failure.toString(),JSON.stringify(this.Fn.ga(F).failure))}ufe(F){const V={};V.collectionType=Gg[F];this.Fn.$(F,Object.assign(new Wh(F),{errorCode:2,
failure:Error.create("The store is disabled.",V)}));r.ULS.sendTraceTag(510253056,220,15,"Fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",Gg[F],this.Fn.ga(F).failure.toString(),JSON.stringify(this.Fn.ga(F).failure))}Ntc(){return this.vla(2)?this.Oa.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?!!this.Fn.ga(2).failure:!1:!0}qpc(F,V,za=!1){r.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",F);F!==OSF.StoreTypeEnum.MarketPlace&&
F!==OSF.StoreTypeEnum.PrivateCatalog?r.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",F):(this.Ntc()&&this.queryStoreDisabled(0,(gb,Fb)=>{Fb?this.ufe(2):(gb=window.performance.now(),V(2,gb,this.bce()))}),this.queryStoreDisabled(F,(gb,Fb)=>{if(gb===OSF.StoreTypeEnum.MarketPlace&&Fb)this.ufe(0);else if(gb===OSF.StoreTypeEnum.PrivateCatalog&&Fb)this.ufe(1);else{var Ec=window.performance.now();this.Ui.getEntitlementDetails(Object.assign(new Gh,{storeType:gb,refresh:za}),$c=>{V(this.Pia.ga(gb),
Ec,$c)})}}))}MM(F,V){F=new Bg(F,0,V);this.Ma.raiseEvent(O.a.Ssb,F)}aib(F,V){F=Object.assign(new Wh(V.a_),{solutionIds:new e.a});var za=V.lW;for(const gb of za)za=gb.solutionId,this.hw.Fb(za)?this.hw.$(za,this.plc(this.hw.ga(za),V.a_,gb)):this.hw.add(za,gb),F.solutionIds.add(za);this.Fn.$(V.a_,F)}vla(F){return this.Fn.Fb(F)?!!this.hw:!1}get m0b(){return this.bB?!this.bB.AreThirdPartyAddInsAllowed||this.bB.AppsForOfficeThirdPartyIsDisabled:!this.Oa.ka("AreThirdPartyAddInsAllowed")||this.Oa.ka("AppsForOfficeThirdPartyIsDisabled")}get obc(){return this.bB?
!this.bB.AppsForOfficeAllowExternalMarketplace:!this.Oa.ka("AppsForOfficeAllowExternalMarketplace")}get vKa(){return this.bB?this.bB.PopularAddinDetailsJsonString:this.Oa.Ha("PopularAddinDetailsJsonString")}queryStoreDisabled(F,V){if(this.m0b)V(F,!0);else if(F===OSF.StoreTypeEnum.MarketPlace&&this.obc)V(F,!0);else{const za=Od.cwc(F);if(za){const gb=window.performance.now();this.Ui.queryStoreDisabled(za,Fb=>{r.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",
F,Fb,gb,window.performance.now()-gb);V(F,Fb)})}else V(F,!1)}}plc(F,V,za){if(!F)return za;if(!za)return F;if(this.qTa)return 2===V?Od.QZa(za,F):Od.QZa(F,za);if(2===V)return F.addinInfo=za.addinInfo,F;za.addinInfo=F.addinInfo;return za}bce(){if(!this.W2){const F=JSON.parse(this.vKa);this.r6b(F);this.W2=F}return Od.a8a(0,this.W2)}r6b(F){this.qTa&&Od.e0b(F);this.otb(F);this.s6b(F)}otb(F){const V=this.S0b();for(var za=0;za<F.length&&0<V.count;za++){const gb=F[za];if(V.Fb(gb.solutionId)){let Fb=String.format("Found an override, solutionId: {0}",
gb.solutionId);const Ec=V.ga(gb.solutionId);Ec&&(isNaN(Ec.addinInfo.priority)||(Fb=String.format("{0}; AddinInfo.Priority: update {1} to {2}",Fb,gb.addinInfo.priority,Ec.addinInfo.priority),gb.addinInfo.priority=Ec.addinInfo.priority),isNaN(Ec.addinInfo.AUP)||(Fb=String.format("{0}; AddinInfo.AUP: update {1} to {2}",Fb,gb.addinInfo.AUP,Ec.addinInfo.AUP),gb.addinInfo.AUP=Ec.addinInfo.AUP),isNaN(Ec.addinInfo.downloadNumber)||(Fb=String.format("{0}; AddinInfo.DownloadNumber: update {1} to {2}",Fb,gb.addinInfo.downloadNumber,
Ec.addinInfo.downloadNumber),gb.addinInfo.downloadNumber=Ec.addinInfo.downloadNumber),Ec.displayName&&(Fb=String.format("{0}; DisplayName: update {1} to {2}",Fb,gb.displayName,Ec.displayName),gb.displayName=Ec.displayName),Ec.iconUrl&&(Fb=String.format("{0}; IconUrl: update {1} to {2}",Fb,gb.iconUrl,Ec.iconUrl),gb.iconUrl=Ec.iconUrl),Ec.description&&(Fb=String.format("{0}; Description: update {1} to {2}",Fb,gb.description,Ec.description),gb.description=Ec.description));V.remove(gb.solutionId);this.Rac&&
r.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",Fb)}}for(let gb of V.keys)za=V.ga(gb),za.displayName&&za.iconUrl&&za.addinInfo&&(F.push(za),this.Rac&&r.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(za)))}S0b(){const F=new ah.a(Kd.a.Ml());let V=this.Oa.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!V)return F;V=V.trim();if(12>=V.length)return 0<
V.length&&r.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",V),F;this.Rac&&r.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",V);try{const za=[],gb=V.split("|");for(let Fb=gb.length-1;0<=Fb;Fb--){const Ec=gb[Fb],$c=Ec.split("\\");if(2>$c.length){za.push(Ec);continue}const Ed=Od.Xnc($c);Ed?F.Fb(Ed.solutionId)||F.add(Ed.solutionId,Ed):za.push(Ec)}this.Rac&&0<za.length&&r.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",
za.join("|"));this.Rac&&0<F.count&&r.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",F.count,JSON.stringify(dg.toArray(F.values)));return F}catch(za){r.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",V,za.toString())}return F}s6b(F){for(let V=0;V<F.length;V++)Xh.c(F[V].iconUrl.toLowerCase(),"http",0)||(F[V].iconUrl=String.format("{0}/image/apps.{1}",this.dVb,F[V].iconUrl))}static Adc(F,
V,za){const gb={};gb.AddinCollectionType=Gg[F];gb.ErrorCode=V.errorCode;gb.AddinCount=V.value?V.value.length:0;r.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",za,JSON.stringify(gb))}static a8a(F,V){const za={};za.errorCode=F;za.value=V;return za}static cwc(F){return F===OSF.StoreTypeEnum.MarketPlace?"omex":F===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static QZa(F,V){V.solutionId=V.solutionId||F.solutionId;V.version=V.version||
F.version;V.storeType=V.storeType||F.storeType;V.storeId=V.storeId||F.storeId;V.assetId=V.assetId||F.assetId;V.assetStoreId=V.assetStoreId||F.assetStoreId;V.displayName=V.displayName||F.displayName;V.provider=V.provider||F.provider;V.description=V.description||F.description;V.iconUrl=V.iconUrl||F.iconUrl;V.webApplicationId=V.webApplicationId||F.webApplicationId;V.highResolutionIconUrl=V.highResolutionIconUrl||F.highResolutionIconUrl;V.licenseUrl=V.licenseUrl||F.licenseUrl;V.privacyUrl=V.privacyUrl||
F.privacyUrl;V.addinInfo=V.addinInfo||F.addinInfo;isNaN(V.targetType)&&(V.targetType=F.targetType);isNaN(V.height)&&(V.height=F.height);isNaN(V.width)&&(V.width=F.width);return V}static e0b(F){for(const V of F)isNaN(V.targetType)&&(V.targetType=1),V.assetId=V.assetId||V.solutionId,V.storeId=V.storeId||"en-US",V.storeType=V.storeType||"omex",V.assetStoreId=V.assetStoreId||"omex",isNaN(V.width)&&(V.width=0),isNaN(V.height)&&(V.height=0)}static Xnc(F){const V={};let za=0;za<F.length&&0<F[za].trim().length&&
F[za].trim().toLowerCase().startsWith("wa")&&(V.solutionId=F[za].trim(),V.addinInfo=Object.assign(new Sg,{priority:Number.NaN,AUP:Number.NaN,downloadNumber:Number.NaN}),++za<F.length&&0<F[za].trim().length&&(V.addinInfo.priority=parseInt(F[za].trim())),++za<F.length&&0<F[za].trim().length&&(V.addinInfo.AUP=parseInt(F[za].trim())),++za<F.length&&0<F[za].trim().length&&(V.addinInfo.downloadNumber=parseInt(F[za].trim())),++za<F.length&&0<F[za].trim().length&&(V.displayName=F[za].trim()),++za<F.length&&
0<F[za].trim().length&&(V.iconUrl=F[za].trim()),++za<F.length&&0<F[za].trim().length&&(V.description=F[za].trim()));return V.solutionId?V:null}static F7b(F,V){F=F.Ha("AddinImageStoreServiceUrl");if(!F)return V;F=F.toLowerCase();return F.startsWith("http://")||F.startsWith("https://")?F:V}}Object(h.a)(Od,"AddinDetailsManager",null,[651,652]);class We{constructor(F,V=0){this.failure=null;this.Csa=F;this.errorCode=V}}Object(h.a)(We,"AddinQueryResult",null,[]);class Zj extends We{constructor(F,V=0){super(F,
V);this.solutionIds=null}}Object(h.a)(Zj,"AddinCollection",We,[]);var ij=d(696);class Wd{constructor(F,V,za=null){this.Ma=new N.a;this.hw=new ah.a(Kd.a.Ml());this.Fn=new Qd.a;this.W2=null;this.Pia=new Yg.a;this.Pia.add(OSF.StoreTypeEnum.MarketPlace,0);this.Pia.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Oa=F;this.cB=V;this.bB=za;this.dVb=Wd.F7b(F,"https://store-images.s-microsoft.com");this.HQa(Object(D.a)(this,this.aib,"onAddinDetailsRefreshed"))}get isAnonymousUser(){return!!this.Oa&&this.Oa.ka("IsAnonymousUser")}get gTc(){return!!this.Oa&&
this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNoMailboxFixEnabled",!0)}get jxb(){return!!this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNotSignedInFixEnabled",!0)}get qTa(){return!!this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}get yka(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get Ui(){return this.cB.value}C$a(F){if(!this.vla(F))return F=
Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:Gg[F]}),Object.assign(new oh(1),{failure:F});if(this.Fn.ga(F).failure)return Object.assign(new oh(this.Fn.ga(F).errorCode),{failure:this.Fn.ga(F).failure});r.ULS.shipAssertTag(509870082,220,!!this.Fn.ga(F).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",F);const V=new oh(0);for(let za of this.Fn.ga(F).solutionIds)this.hw.Fb(za)&&Array.add(V.lW,this.hw.ga(za));return V}U6b(F){return this.hw.Fb(F)?
this.hw.ga(F):null}BUe(F){if(F){this.HQa(F);for(let V of this.Fn.keys){if(!this.vla(V)||this.Fn.ga(V).failure)continue;r.ULS.shipAssertTag(509870081,220,!!this.Fn.ga(V).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",V);const za=[],gb=this.Fn.ga(V);for(let Fb of gb.solutionIds)Array.add(za,this.hw.ga(Fb));F(null,new Bg(V,gb.errorCode,za,gb.failure))}}}YU(F,V=!1){0!==F&&10!==F?r.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",
Yj.a[F]):this.qpc(F,Object(D.a)(this,this.Umc,"onQueryAddinDetailsCompleted"),V)}HQa(F){this.Ma.addHandler(O.a.Ssb,F)}Umc(F,V,za){if(za)if(Wd.Adc(F,za,window.performance.now()-V),0===za.errorCode){let gb;if(za.value){let Fb=0;gb=Array(za.value.length);za.value.forEach(Ec=>{gb[Fb++]=Ec})}else gb=[];this.MM(new We(F),gb)}else-1===za.errorCode||10===za.errorCode?this.MM(new We(F),[]):(F=this.MWd(F,V,za),this.MM(F));else F=Wd.NWd(F,V),this.MM(F)}MWd(F,V,za){const gb={};gb.collectionType=Gg[F];gb.invokeResultCode=
za.errorCode;gb["queryResult.Value"]=za.value?String.format("Length: {0}",za.value.length):"null";gb.queryStart=V;gb.queryDuration=window.performance.now()-V;return Object.assign(new We(F,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",gb)})}Ntc(){return this.vla(2)?this.Oa.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?!!this.Fn.ga(2).failure:!1:!0}qpc(F,V,za=!1){r.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",F);
F!==OSF.StoreTypeEnum.MarketPlace&&F!==OSF.StoreTypeEnum.PrivateCatalog?r.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",F):(this.Ntc()&&this.queryStoreDisabled(0,(gb,Fb)=>{Fb?(gb=Wd.b8a(2),this.MM(gb)):(gb=window.performance.now(),V(2,gb,this.bce()))}),this.jxb&&this.isAnonymousUser?(F=Wd.FWd(F===OSF.StoreTypeEnum.MarketPlace?0:1),this.MM(F)):this.queryStoreDisabled(F,(gb,Fb)=>{if(gb===OSF.StoreTypeEnum.MarketPlace&&Fb)Fb=Wd.b8a(0),this.MM(Fb);else if(gb===OSF.StoreTypeEnum.PrivateCatalog&&
Fb)Fb=Wd.b8a(1),this.MM(Fb);else{var Ec=window.performance.now();this.Ui.getEntitlementDetails(Object.assign(new Gh,{storeType:gb,refresh:za}),$c=>{V(this.Pia.ga(gb),Ec,$c)})}}))}MM(F,V=null){0!==F.errorCode?(r.ULS.shipAssertTag(509116673,220,!V,"The parameter addinDetails must be null for any failed queries"),r.ULS.shipAssertTag(509116672,220,!!F.failure,"The result.Failure must not be available for any failed queries"),r.ULS.sendTraceTag(510253056,220,this.Wde(F),"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; errorCode: {1}; failure: {2}; errorInfo: {3}",
Gg[F.Csa],ij.a[F.errorCode],F.failure?F.failure.toString():"null",JSON.stringify(F.failure))):(r.ULS.shipAssertTag(509116643,220,!!V,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is invalid.",Gg[F.Csa]),r.ULS.sendTraceTag(509116642,220,15,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails",Gg[F.Csa],V?V.length:-1));F=new Bg(F.Csa,F.errorCode,V,F.failure);this.Ma.raiseEvent(O.a.Ssb,F)}Wde(F){return 3===F.errorCode&&(this.jxb&&
-2147208619===Wd.syb(F)||this.gTc&&-2===Wd.syb(F))?15:2===F.errorCode?15:10}aib(F,V){if(0!==V.errorCode)this.Fn.$(V.a_,Object.assign(new Zj(V.a_,V.errorCode),{failure:V.failure}));else{F=Object.assign(new Zj(V.a_),{solutionIds:new e.a});var za=V.lW;for(const gb of za)za=gb.solutionId,this.hw.Fb(za)?this.hw.$(za,this.plc(this.hw.ga(za),V.a_,gb)):this.hw.add(za,gb),F.solutionIds.add(za);this.Fn.$(V.a_,F)}}vla(F){return this.Fn.Fb(F)?!!this.hw:!1}get m0b(){return this.bB?!this.bB.AreThirdPartyAddInsAllowed||
this.bB.AppsForOfficeThirdPartyIsDisabled:!this.Oa.ka("AreThirdPartyAddInsAllowed")||this.Oa.ka("AppsForOfficeThirdPartyIsDisabled")}get obc(){return this.bB?!this.bB.AppsForOfficeAllowExternalMarketplace:!this.Oa.ka("AppsForOfficeAllowExternalMarketplace")}get vKa(){return this.bB?this.bB.PopularAddinDetailsJsonString:this.Oa.Ha("PopularAddinDetailsJsonString")}queryStoreDisabled(F,V){if(this.m0b)V(F,!0);else if(F===OSF.StoreTypeEnum.MarketPlace&&this.obc)V(F,!0);else{const za=Wd.cwc(F);if(za){const gb=
window.performance.now();this.Ui.queryStoreDisabled(za,Fb=>{r.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",F,Fb,gb,window.performance.now()-gb);V(F,Fb)})}else V(F,!1)}}plc(F,V,za){if(!F)return za;if(!za)return F;if(this.qTa)return 2===V?Wd.QZa(za,F):Wd.QZa(F,za);if(2===V)return F.addinInfo=za.addinInfo,F;za.addinInfo=F.addinInfo;return za}bce(){if(!this.W2){const F=JSON.parse(this.vKa);this.r6b(F);this.W2=F}return Wd.a8a(0,
this.W2)}r6b(F){this.qTa&&Wd.e0b(F);this.otb(F);this.s6b(F)}otb(F){const V=this.S0b();for(var za=0;za<F.length&&0<V.count;za++){const gb=F[za];if(V.Fb(gb.solutionId)){let Fb=String.format("Found an override, solutionId: {0}",gb.solutionId);const Ec=V.ga(gb.solutionId);Ec&&(isNaN(Ec.addinInfo.priority)||(Fb=String.format("{0}; AddinInfo.Priority: update {1} to {2}",Fb,gb.addinInfo.priority,Ec.addinInfo.priority),gb.addinInfo.priority=Ec.addinInfo.priority),isNaN(Ec.addinInfo.AUP)||(Fb=String.format("{0}; AddinInfo.AUP: update {1} to {2}",
Fb,gb.addinInfo.AUP,Ec.addinInfo.AUP),gb.addinInfo.AUP=Ec.addinInfo.AUP),isNaN(Ec.addinInfo.downloadNumber)||(Fb=String.format("{0}; AddinInfo.DownloadNumber: update {1} to {2}",Fb,gb.addinInfo.downloadNumber,Ec.addinInfo.downloadNumber),gb.addinInfo.downloadNumber=Ec.addinInfo.downloadNumber),Ec.displayName&&(Fb=String.format("{0}; DisplayName: update {1} to {2}",Fb,gb.displayName,Ec.displayName),gb.displayName=Ec.displayName),Ec.iconUrl&&(Fb=String.format("{0}; IconUrl: update {1} to {2}",Fb,gb.iconUrl,
Ec.iconUrl),gb.iconUrl=Ec.iconUrl),Ec.description&&(Fb=String.format("{0}; Description: update {1} to {2}",Fb,gb.description,Ec.description),gb.description=Ec.description));V.remove(gb.solutionId);this.yka&&r.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",Fb)}}for(let gb of V.keys)za=V.ga(gb),za.displayName&&za.iconUrl&&za.addinInfo&&(F.push(za),this.yka&&r.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",
JSON.stringify(za)))}S0b(){const F=new ah.a(Kd.a.Ml());let V=this.Oa.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!V)return F;V=V.trim();if(12>=V.length)return 0<V.length&&r.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",V),F;this.yka&&r.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",V);try{const za=[],gb=V.split("|");for(let Fb=gb.length-1;0<=Fb;Fb--){const Ec=
gb[Fb],$c=Ec.split("\\");if(2>$c.length){za.push(Ec);continue}const Ed=Wd.Xnc($c);Ed?F.Fb(Ed.solutionId)||F.add(Ed.solutionId,Ed):za.push(Ec)}this.yka&&0<za.length&&r.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",za.join("|"));this.yka&&0<F.count&&r.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",F.count,JSON.stringify(dg.toArray(F.values)));return F}catch(za){r.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",
V,za.toString())}return F}s6b(F){for(let V=0;V<F.length;V++)Xh.c(F[V].iconUrl.toLowerCase(),"http",0)||(F[V].iconUrl=String.format("{0}/image/apps.{1}",this.dVb,F[V].iconUrl))}static NWd(F,V){const za={};za.collectionType=Gg[F];za.queryResult="null";za.queryStart=V;za.queryDuration=window.performance.now()-V;return Object.assign(new We(F,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",za)})}static b8a(F){const V={};V.collectionType=Gg[F];return Object.assign(new We(F,2),{failure:Error.create("The store is disabled.",
V)})}static FWd(F){const V={};V.collectionType=Gg[F];V.invokeResultCode=-2147208619;V.queryDuration=0;return Object.assign(new We(F,3),{failure:Error.create("Anonymous users do not have installed add-ins.",V)})}static syb(F){return F.failure?F.failure.invokeResultCode:-1E3}static Adc(F,V,za){const gb={};gb.AddinCollectionType=Gg[F];gb.ErrorCode=V.errorCode;gb.AddinCount=V.value?V.value.length:0;r.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",
za,JSON.stringify(gb))}static a8a(F,V){const za={};za.errorCode=F;za.value=V;return za}static cwc(F){return F===OSF.StoreTypeEnum.MarketPlace?"omex":F===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static QZa(F,V){V.solutionId=V.solutionId||F.solutionId;V.version=V.version||F.version;V.storeType=V.storeType||F.storeType;V.storeId=V.storeId||F.storeId;V.assetId=V.assetId||F.assetId;V.assetStoreId=V.assetStoreId||F.assetStoreId;V.displayName=V.displayName||F.displayName;V.provider=V.provider||
F.provider;V.description=V.description||F.description;V.iconUrl=V.iconUrl||F.iconUrl;V.webApplicationId=V.webApplicationId||F.webApplicationId;V.highResolutionIconUrl=V.highResolutionIconUrl||F.highResolutionIconUrl;V.licenseUrl=V.licenseUrl||F.licenseUrl;V.privacyUrl=V.privacyUrl||F.privacyUrl;V.addinInfo=V.addinInfo||F.addinInfo;isNaN(V.targetType)&&(V.targetType=F.targetType);isNaN(V.height)&&(V.height=F.height);isNaN(V.width)&&(V.width=F.width);return V}static e0b(F){for(const V of F)isNaN(V.targetType)&&
(V.targetType=1),V.assetId=V.assetId||V.solutionId,V.storeId=V.storeId||"en-US",V.storeType=V.storeType||"omex",V.assetStoreId=V.assetStoreId||"omex",isNaN(V.width)&&(V.width=0),isNaN(V.height)&&(V.height=0)}static Xnc(F){const V={};let za=0;za<F.length&&0<F[za].trim().length&&F[za].trim().toLowerCase().startsWith("wa")&&(V.solutionId=F[za].trim(),V.addinInfo=Object.assign(new Sg,{priority:Number.NaN,AUP:Number.NaN,downloadNumber:Number.NaN}),++za<F.length&&0<F[za].trim().length&&(V.addinInfo.priority=
parseInt(F[za].trim())),++za<F.length&&0<F[za].trim().length&&(V.addinInfo.AUP=parseInt(F[za].trim())),++za<F.length&&0<F[za].trim().length&&(V.addinInfo.downloadNumber=parseInt(F[za].trim())),++za<F.length&&0<F[za].trim().length&&(V.displayName=F[za].trim()),++za<F.length&&0<F[za].trim().length&&(V.iconUrl=F[za].trim()),++za<F.length&&0<F[za].trim().length&&(V.description=F[za].trim()));return V.solutionId?V:null}static F7b(F,V){F=F.Ha("AddinImageStoreServiceUrl");if(!F)return V;F=F.toLowerCase();
return F.startsWith("http://")||F.startsWith("https://")?F:V}}Object(h.a)(Wd,"AddinDetailsManager1",null,[651,652]);class ki{constructor(F,V=null){this.description=this.provider=this.displayName=this.assetStoreId=this.assetId=this.storeId=this.storeType=this.version=this.solutionId=this.addinInfo=null;this.width=this.height=this.targetType=0;this.privacyUrl=this.licenseUrl=this.highResolutionIconUrl=this.webApplicationId=this.iconUrl=null;this.solutionId=F.solutionId;this.version=F.version;this.storeType=
F.storeType;this.storeId=F.storeId;this.assetId=F.assetId;this.assetStoreId=F.assetStoreId;this.displayName=F.displayName;this.provider=F.provider;this.description=F.description;this.targetType=F.targetType;this.height=F.height;this.width=F.width;this.iconUrl=F.iconUrl;this.webApplicationId=F.webApplicationId;this.highResolutionIconUrl=F.highResolutionIconUrl;this.licenseUrl=F.licenseUrl;this.privacyUrl=F.privacyUrl;this.addinInfo=V}w6e(){const F={};F.solutionId=this.solutionId;F.version=this.version;
F.storeType=this.storeType;F.storeId=this.storeId;F.assetId=this.assetId;F.assetStoreId=this.assetStoreId;F.targetType=this.targetType;F.displayName=this.displayName;F.width=this.width;F.height=this.height;return F}}Object(h.a)(ki,"AddinDetail",null,[]);class xi{constructor(F,V,za,gb,Fb){this.AGc=null;this.Oa=F;this.cB=V;this.S5a=za;this.h5h=gb;this.fTb=Fb}YU(F,V){this.Ui.queryAppDetails(this.h5h,this.fTb,this.solutionIds,F,(za,gb)=>{const Fb=Array(gb.length);for(let Ec=0;Ec<gb.length;Ec++)Fb[Ec]=
new ki(gb[Ec],this.Mdk(gb[Ec].solutionId));V(za,Fb)})}get rXj(){return!!this.Ui.queryAppDetails}Mdk(F){return this.S5a.ga(F)}get solutionIds(){if(!this.AGc){this.AGc=new e.a;for(let F of this.S5a.keys)this.AGc.add(Xh.d(F))}return this.AGc.toArray()}get Ui(){return this.cB.value}}Object(h.a)(xi,"AddinDetailsLoader",null,[]);class Pg{constructor(F,V=0){this.failure=null;this.Csa=F;this.errorCode=V}}Object(h.a)(Pg,"AddinQueryResult",null,[]);class Ej extends Pg{constructor(F,V=0){super(F,V);this.S3e=
this.solutionIds=null}}Object(h.a)(Ej,"AddinCollection",Pg,[]);var Hh=d(1302);class gh extends Hh.a{constructor(){super(Kd.a.Ml())}}Object(h.a)(gh,"AddinDetailTable",Hh.a,[]);class Ie{constructor(F,V,za=null){this.Ma=new N.a;this.hw=new ah.a(Kd.a.Ml());this.Fn=new Qd.a;this.S5a=this.W2=null;this.Pia=new Yg.a;this.Pia.add(OSF.StoreTypeEnum.MarketPlace,0);this.Pia.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Oa=F;this.cB=V;this.bB=za;this.dVb=Ie.F7b(F,"https://store-images.s-microsoft.com");this.gMd=
null;this.HQa(Object(D.a)(this,this.aib,"onAddinDetailsRefreshed"))}get isAnonymousUser(){return!!this.Oa&&this.Oa.ka("IsAnonymousUser")}get gTc(){return!!this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNoMailboxFixEnabled",!0)}get jxb(){return!!this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNotSignedInFixEnabled",!0)}get qTa(){return!!this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}get yka(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",
!1)}get Ui(){return this.cB.value}get mPe(){this.gMd||(this.gMd=new xi(this.Oa,this.cB,this.mPk,0,this.Ui.getAppUILocale()));return this.gMd}C$a(F){if(!this.vla(F))return F=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:Gg[F]}),Object.assign(new oh(1),{failure:F});const V=this.Fn.ga(F);if(V.failure)return Object.assign(new oh(V.errorCode),{failure:V.failure});r.ULS.shipAssertTag(509870082,220,!!V.solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",
F);const za=new oh(0);for(let gb=0;gb<V.solutionIds.count;gb++){const Fb=V.solutionIds.ga(gb),Ec=V.S3e.ga(gb);if(this.hw.Fb(Fb)){const $c=this.hw.ga(Fb);$c.Fb(Ec)?Array.add(za.lW,$c.ga(Ec)):r.ULS.sendTraceTag(0,220,15,"The addin with solutionId '{0}' in '{1}' must contain storeId '{2}' when the collection is ready.",Fb,F,Ec)}else r.ULS.sendTraceTag(0,220,15,"The addin with solutionId '{0}' in '{1}' must exist when the collection is ready.",Fb,F)}return za}U6b(F){var V=null;if(F=this.P$i(F))if(V||
(V=this.uiCulture),F.Fb(V))return F.ga(V);return null}P$i(F){return this.hw.Fb(F)?this.hw.ga(F):null}BUe(F){if(F){this.HQa(F);for(let V of this.Fn.keys){if(!this.vla(V)||this.Fn.ga(V).failure)continue;r.ULS.shipAssertTag(509870081,220,!!this.Fn.ga(V).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",V);const za=[],gb=this.Fn.ga(V);for(let Fb of gb.solutionIds)Array.add(za,this.hw.ga(Fb));F(null,new Bg(V,gb.errorCode,za,gb.failure))}}}YU(F,V=!1){0!==
F&&10!==F?r.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",Yj.a[F]):this.qpc(F,Object(D.a)(this,this.Umc,"onQueryAddinDetailsCompleted"),V)}HQa(F){this.Ma.addHandler(O.a.Ssb,F)}Umc(F,V,za){za?(Ie.Adc(F,za,window.performance.now()-V),0===za.errorCode?(V=za.value?Ie.Uki(za.value):[],this.MM(new Pg(F),V)):-1===za.errorCode||10===za.errorCode?this.MM(new Pg(F),[]):(F=this.MWd(F,V,za),this.MM(F))):(F=Ie.NWd(F,V),this.MM(F))}MWd(F,V,za){const gb={};gb.collectionType=
Gg[F];gb.invokeResultCode=za.errorCode;gb["queryResult.Value"]=za.value?String.format("Length: {0}",za.value.length):"null";gb.queryStart=V;gb.queryDuration=window.performance.now()-V;return Object.assign(new Pg(F,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",gb)})}Ntc(){return this.vla(2)?this.Oa.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?!!this.Fn.ga(2).failure:!1:!0}qpc(F,V,za=!1){r.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",
F);F!==OSF.StoreTypeEnum.MarketPlace&&F!==OSF.StoreTypeEnum.PrivateCatalog?r.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",F):(this.Ntc()&&this.queryStoreDisabled(0,(gb,Fb)=>{Fb?(gb=Ie.b8a(2),this.MM(gb)):this.KSk(V)}),this.jxb&&this.isAnonymousUser?(F=Ie.FWd(F===OSF.StoreTypeEnum.MarketPlace?0:1),this.MM(F)):this.queryStoreDisabled(F,(gb,Fb)=>{if(gb===OSF.StoreTypeEnum.MarketPlace&&Fb)Fb=Ie.b8a(0),this.MM(Fb);else if(gb===OSF.StoreTypeEnum.PrivateCatalog&&Fb)Fb=Ie.b8a(1),this.MM(Fb);
else{var Ec=window.performance.now();this.Ui.getEntitlementDetails(Object.assign(new Gh,{storeType:gb,refresh:za}),$c=>{V(this.Pia.ga(gb),Ec,$c)})}}))}MM(F,V=null){0!==F.errorCode?(r.ULS.shipAssertTag(509116673,220,!V,"The parameter addinDetails must be null for any failed queries"),r.ULS.shipAssertTag(509116672,220,!!F.failure,"The result.Failure must not be available for any failed queries"),r.ULS.sendTraceTag(510253056,220,this.Wde(F),"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; errorCode: {1}; failure: {2}; errorInfo: {3}",
Gg[F.Csa],ij.a[F.errorCode],F.failure?F.failure.toString():"null",JSON.stringify(F.failure))):(r.ULS.shipAssertTag(509116643,220,!!V,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is invalid.",Gg[F.Csa]),r.ULS.sendTraceTag(509116642,220,15,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails",Gg[F.Csa],V?V.length:-1));F=new Bg(F.Csa,F.errorCode,V,F.failure);this.Ma.raiseEvent(O.a.Ssb,F)}Wde(F){return 3===F.errorCode&&(this.jxb&&
-2147208619===Ie.syb(F)||this.gTc&&-2===Ie.syb(F))?15:2===F.errorCode?15:10}aib(F,V){if(0!==V.errorCode)this.Fn.$(V.a_,Object.assign(new Ej(V.a_,V.errorCode),{failure:V.failure}));else{F=Object.assign(new Ej(V.a_),{solutionIds:new e.a,S3e:new e.a});var za=V.lW;for(const Fb of za){za=Fb.solutionId;const Ec=Fb.storeId;if(this.hw.Fb(za)){var gb=this.hw.ga(za);gb.Fb(Ec)?gb.$(Ec,this.plc(gb.ga(Ec),V.a_,Fb)):gb.add(Ec,Fb)}else gb=new gh,gb.add(Ec,Fb),this.hw.add(za,gb);F.solutionIds.add(za);F.S3e.add(Ec)}this.Fn.$(V.a_,
F)}}vla(F){return this.Fn.Fb(F)?!!this.hw:!1}get uiCulture(){return this.bB&&this.bB.UICulture?this.bB.UICulture:this.Ui.getAppUILocale()}get m0b(){return this.bB?!this.bB.AreThirdPartyAddInsAllowed||this.bB.AppsForOfficeThirdPartyIsDisabled:!this.Oa.ka("AreThirdPartyAddInsAllowed")||this.Oa.ka("AppsForOfficeThirdPartyIsDisabled")}get obc(){return this.bB?!this.bB.AppsForOfficeAllowExternalMarketplace:!this.Oa.ka("AppsForOfficeAllowExternalMarketplace")}get mPk(){if(!this.S5a){this.S5a=new ah.a(Kd.a.Ml());
const F=JSON.parse(this.vKa);for(const V of F)this.S5a.add(V.solutionId,V.addinInfo)}return this.S5a}get vKa(){return this.bB?this.bB.PopularAddinDetailsJsonString:this.Oa.Ha("PopularAddinDetailsJsonString")}queryStoreDisabled(F,V){if(this.m0b)V(F,!0);else if(F===OSF.StoreTypeEnum.MarketPlace&&this.obc)V(F,!0);else{const za=Ie.cwc(F);if(za){const gb=window.performance.now();this.Ui.queryStoreDisabled(za,Fb=>{r.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",
F,Fb,gb,window.performance.now()-gb);V(F,Fb)})}else V(F,!1)}}plc(F,V,za){if(!F)return za;if(!za)return F;if(this.qTa)return 2===V?Ie.QZa(za,F):Ie.QZa(F,za);if(2===V)return F.addinInfo=za.addinInfo,F;za.addinInfo=F.addinInfo;return za}KSk(F){const V=window.performance.now();if(this.W2)F(2,V,Ie.a8a(0,this.W2));else if(this.mPe&&this.mPe.rXj)this.mPe.YU(!1,(gb,Fb)=>{this.otb(Fb);this.W2=Fb;F(2,V,Ie.a8a(gb,this.W2))});else{var za=JSON.parse(this.vKa);this.r6b(za);this.W2=za;F(2,V,Ie.a8a(0,this.W2))}}r6b(F){this.qTa&&
Ie.e0b(F);this.otb(F);this.s6b(F)}otb(F){const V=this.S0b();for(var za=0;za<F.length&&0<V.count;za++){const gb=F[za];if(V.Fb(gb.solutionId)){let Fb=String.format("Found an override, solutionId: {0}",gb.solutionId);const Ec=V.ga(gb.solutionId);Ec&&(isNaN(Ec.addinInfo.priority)||(Fb=String.format("{0}; AddinInfo.Priority: update {1} to {2}",Fb,gb.addinInfo.priority,Ec.addinInfo.priority),gb.addinInfo.priority=Ec.addinInfo.priority),isNaN(Ec.addinInfo.AUP)||(Fb=String.format("{0}; AddinInfo.AUP: update {1} to {2}",
Fb,gb.addinInfo.AUP,Ec.addinInfo.AUP),gb.addinInfo.AUP=Ec.addinInfo.AUP),isNaN(Ec.addinInfo.downloadNumber)||(Fb=String.format("{0}; AddinInfo.DownloadNumber: update {1} to {2}",Fb,gb.addinInfo.downloadNumber,Ec.addinInfo.downloadNumber),gb.addinInfo.downloadNumber=Ec.addinInfo.downloadNumber),Ec.displayName&&(Fb=String.format("{0}; DisplayName: update {1} to {2}",Fb,gb.displayName,Ec.displayName),gb.displayName=Ec.displayName),Ec.iconUrl&&(Fb=String.format("{0}; IconUrl: update {1} to {2}",Fb,gb.iconUrl,
Ec.iconUrl),gb.iconUrl=Ec.iconUrl),Ec.description&&(Fb=String.format("{0}; Description: update {1} to {2}",Fb,gb.description,Ec.description),gb.description=Ec.description));V.remove(gb.solutionId);this.yka&&r.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",Fb)}}for(let gb of V.keys)za=V.ga(gb),za.displayName&&za.iconUrl&&za.addinInfo&&(F.push(za),this.yka&&r.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",
JSON.stringify(za)))}S0b(){const F=new ah.a(Kd.a.Ml());let V=this.Oa.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!V)return F;V=V.trim();if(12>=V.length)return 0<V.length&&r.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",V),F;this.yka&&r.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",V);try{const za=[],gb=V.split("|");for(let Fb=gb.length-1;0<=Fb;Fb--){const Ec=
gb[Fb],$c=Ec.split("\\");if(2>$c.length){za.push(Ec);continue}const Ed=Ie.Xnc($c);Ed?F.Fb(Ed.solutionId)||F.add(Ed.solutionId,Ed):za.push(Ec)}this.yka&&0<za.length&&r.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",za.join("|"));this.yka&&0<F.count&&r.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",F.count,JSON.stringify(dg.toArray(F.values)));return F}catch(za){r.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",
V,za.toString())}return F}s6b(F){for(let V=0;V<F.length;V++)Xh.c(F[V].iconUrl.toLowerCase(),"http",0)||(F[V].iconUrl=String.format("{0}/image/apps.{1}",this.dVb,F[V].iconUrl))}static NWd(F,V){const za={};za.collectionType=Gg[F];za.queryResult="null";za.queryStart=V;za.queryDuration=window.performance.now()-V;return Object.assign(new Pg(F,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",za)})}static b8a(F){const V={};V.collectionType=Gg[F];return Object.assign(new Pg(F,2),{failure:Error.create("The store is disabled.",
V)})}static FWd(F){const V={};V.collectionType=Gg[F];V.invokeResultCode=-2147208619;V.queryDuration=0;return Object.assign(new Pg(F,3),{failure:Error.create("Anonymous users do not have installed add-ins.",V)})}static syb(F){return F.failure?F.failure.invokeResultCode:-1E3}static Adc(F,V,za){const gb={};gb.AddinCollectionType=Gg[F];gb.ErrorCode=V.errorCode;gb.AddinCount=V.value?V.value.length:0;r.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",
za,JSON.stringify(gb))}static a8a(F,V){const za={};za.errorCode=F;za.value=V;return za}static cwc(F){return F===OSF.StoreTypeEnum.MarketPlace?"omex":F===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static QZa(F,V){V.solutionId=V.solutionId||F.solutionId;V.version=V.version||F.version;V.storeType=V.storeType||F.storeType;V.storeId=V.storeId||F.storeId;V.assetId=V.assetId||F.assetId;V.assetStoreId=V.assetStoreId||F.assetStoreId;V.displayName=V.displayName||F.displayName;V.provider=V.provider||
F.provider;V.description=V.description||F.description;V.iconUrl=V.iconUrl||F.iconUrl;V.webApplicationId=V.webApplicationId||F.webApplicationId;V.highResolutionIconUrl=V.highResolutionIconUrl||F.highResolutionIconUrl;V.licenseUrl=V.licenseUrl||F.licenseUrl;V.privacyUrl=V.privacyUrl||F.privacyUrl;V.addinInfo=V.addinInfo||F.addinInfo;isNaN(V.targetType)&&(V.targetType=F.targetType);isNaN(V.height)&&(V.height=F.height);isNaN(V.width)&&(V.width=F.width);return V}static Uki(F){const V=Array(F.length);for(let za=
0;za<V.length;za++)V[za]=new ki(F[za],F[za].addinInfo);return V}static e0b(F){for(const V of F)isNaN(V.targetType)&&(V.targetType=1),V.assetId=V.assetId||V.solutionId,V.storeId=V.storeId||"en-US",V.storeType=V.storeType||"omex",V.assetStoreId=V.assetStoreId||"omex",isNaN(V.width)&&(V.width=0),isNaN(V.height)&&(V.height=0)}static Xnc(F){const V={};let za=0;za<F.length&&0<F[za].trim().length&&F[za].trim().toLowerCase().startsWith("wa")&&(V.solutionId=F[za].trim(),V.addinInfo=Object.assign(new Sg,{priority:Number.NaN,
AUP:Number.NaN,downloadNumber:Number.NaN}),++za<F.length&&0<F[za].trim().length&&(V.addinInfo.priority=parseInt(F[za].trim())),++za<F.length&&0<F[za].trim().length&&(V.addinInfo.AUP=parseInt(F[za].trim())),++za<F.length&&0<F[za].trim().length&&(V.addinInfo.downloadNumber=parseInt(F[za].trim())),++za<F.length&&0<F[za].trim().length&&(V.displayName=F[za].trim()),++za<F.length&&0<F[za].trim().length&&(V.iconUrl=F[za].trim()),++za<F.length&&0<F[za].trim().length&&(V.description=F[za].trim()));return V.solutionId?
V:null}static F7b(F,V){F=F.Ha("AddinImageStoreServiceUrl");if(!F)return V;F=F.toLowerCase();return F.startsWith("http://")||F.startsWith("https://")?F:V}}Object(h.a)(Ie,"AddinDetailsManager2",null,[651,652]);class eg{static createInstance(F,V,za=null){if(eg.o_j(F)){if(eg.aji(F))return r.ULS.sendTraceTag(508925833,220,50,"AddinDetailsManagerFactory.CreateInstance: Creating an instance of AddinDetailsManager2."),new Ie(F,V,za);r.ULS.sendTraceTag(508925832,220,50,"AddinDetailsManagerFactory.CreateInstance: Creating an instance of AddinDetailsManager1.");
return new Wd(F,V,za)}r.ULS.sendTraceTag(508925831,220,50,"AddinDetailsManagerFactory.CreateInstance: Creating an instance of AddinDetailsManager");return new Od(F,V,za)}static o_j(F){return(F||z.AFrameworkApplication.fa).getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",!1)}static aji(F){return(F||z.AFrameworkApplication.fa).getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsPopularLoaderEnabled",!1)}}Object(h.a)(eg,"AddinDetailsManagerFactory",
null,[]);var yi=d(205),Fj=d(317),Yh=d(583),ei=d(1243);class Hi extends Gf.a{constructor(){super();this.Qba="calc(100% - 46px)";this.tqa="15px";this.Rba="0";this.zTb="WACDialogPanel";this.KP=695;this.ATb=462;this.vN="80%";this.pSb=350;this.PNa="100%";this.Ad=5;this.kg="AppsForOfficeInsertionDialog";this.dEd=!!z.AFrameworkApplication.fa&&z.AFrameworkApplication.fa.ka("OfficeAddinEnableInsertDialogAccessibilityFix")}Bu(){super.Bu();this.rm.style.width=this.PNa;this.rm.style.height=this.Qba;this.rm.style.marginTop=
this.tqa;this.rm.style.padding=this.Rba}Iaa(){this.rm.style.width=this.PNa;this.rm.style.height=this.Qba;this.rm.style.marginTop=this.tqa;this.rm.style.padding=this.Rba;this.KP>kf.a.TR?(this.Ib.style.width=String.format("{0}px",kf.a.TR),this.Ib.style.overflowX="scroll",z.AFrameworkApplication.isRtl?this.Ib.style.right="0":this.Ib.style.left="0"):(this.Ib.style.width=String.format("{0}px",this.KP),this.Ib.style.overflowX="hidden");this.Ib.offsetHeight>kf.a.hP||this.ATb+50>kf.a.hP?(this.Ib.style.height=
String.format("{0}px",kf.a.hP),this.Ib.style.overflowY="scroll",this.Ib.style.top="0",z.AFrameworkApplication.isRtl?this.Ib.style.right="0":this.Ib.style.left="0",this.dEd||(this.Ib.style.marginTop="-48px"),this.rm.style.minHeight=String.format("{0}px",this.pSb)):(this.Ib.style.overflowY="hidden",this.Ib.style.top="10%",this.Ib.style.height=this.vN);this.VCa()}VCa(){if(this.Ib){var F=this.Ib.style.zIndex;this.Ib.style.zIndex="-9999";if(this.KP>kf.a.TR)z.AFrameworkApplication.isRtl?this.Ib.style.marginRight=
"0":this.Ib.style.marginLeft="0";else{const V=String.format("{0}px",Math.floor(-this.Ib.offsetWidth/2));z.AFrameworkApplication.isRtl?this.Ib.style.marginRight=V:this.Ib.style.marginLeft=V;z.AFrameworkApplication.isRtl?this.Ib.style.right="50%":this.Ib.style.left="50%"}this.Ib.style.zIndex=String(F)}else r.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}VA(){super.VA();const F=document.getElementById(this.Uh(this.zTb));F.style.width=String.format("{0}px",this.KP);F.style.height=
this.vN}get fka(){return this.rm}}Object(h.a)(Hi,"AppsForOfficeInsertionDialog",Gf.a,[645]);class yh extends Gf.a{constructor(F=!0,V=!0,za=null){super();this.Qba="calc(100% - 46px)";this.tqa="15px";this.Rba="0";this.zTb="WACDialogPanel";this.KP=695;this.ATb=462;this.vN="80%";this.pSb=350;this.PNa="100%";this.Qef="auto";this.Ref="5px";this.Sef="auto";this.Pef="40px";this.oAc="100px";this.BTb="200px";this.Ad=5;this.kg="SDXDialog";this.yCc=F;this.T9b=V;this.jAc=za}Bu(){super.Bu();this.rm.style.width=
this.PNa;this.rm.style.height=this.Qba;this.rm.style.marginTop=this.tqa;this.rm.style.padding=this.Rba}Iaa(){this.rm.style.width=this.PNa;this.rm.style.height=this.yCc?this.Qba:"100%";this.rm.style.marginTop=this.yCc?this.tqa:"0px";this.rm.style.padding=this.Rba;if(this.yCc){this.oAc&&this.BTb&&(this.KP=parseInt(this.BTb.substring(0,this.BTb.length-2)),this.vN=this.oAc);this.KP>kf.a.TR?(this.Ib.style.width=String.format("{0}px",kf.a.TR),this.Ib.style.overflowX="scroll",z.AFrameworkApplication.isRtl?
this.Ib.style.right="0":this.Ib.style.left="0"):(this.Ib.style.width=String.format("{0}px",this.KP),this.Ib.style.overflowX="hidden");if(this.Ib.offsetHeight>kf.a.hP||this.ATb+50>kf.a.hP)this.Ib.style.height=String.format("{0}px",kf.a.hP),this.Ib.style.overflowY="scroll",this.Ib.style.top="0",z.AFrameworkApplication.isRtl?this.Ib.style.right="0":this.Ib.style.left="0",this.rm.style.minHeight=String.format("{0}px",this.pSb);else{this.Ib.style.overflowY="hidden";const F="%"===this.vN.substring(this.vN.length-
1,this.vN.length),V=F?parseInt(this.vN.substring(0,this.vN.length-1)):parseInt(this.vN.substring(0,this.vN.length-2));this.Ib.style.top=F?(100-V)/2+"%":100*(kf.a.hP-V)/kf.a.hP/2+"%";this.Ib.style.height=this.vN}this.VCa()}else this.Ib.style.left=this.Qef,this.Ib.style.right=this.Ref,this.Ib.style.top=this.Sef,this.Ib.style.bottom=this.Pef,this.Ib.style.width=this.BTb,this.Ib.style.height=this.oAc,this.Ib.style.overflowX="hidden",this.Ib.style.overflowY="hidden"}VCa(){if(this.Ib){var F=this.Ib.style.zIndex;
this.Ib.style.zIndex="-9999";if(this.KP>kf.a.TR)z.AFrameworkApplication.isRtl?this.Ib.style.marginRight="0":this.Ib.style.marginLeft="0";else{const V=String.format("{0}px",Math.floor(-this.Ib.offsetWidth/2));z.AFrameworkApplication.isRtl?this.Ib.style.marginRight=V:this.Ib.style.marginLeft=V;z.AFrameworkApplication.isRtl?this.Ib.style.right="50%":this.Ib.style.left="50%"}this.Ib.style.zIndex=String(F)}else r.ULS.sendTraceTag(524892188,306,10,"_divMessageBox is null in CenterDialog()")}VA(){super.VA();
const F=document.getElementById(this.Uh(this.zTb));F.style.width=String.format("{0}px",this.KP);F.style.height=this.vN}get fBb(){return this.yCc}get fka(){return this.rm}ikl(F,V,za,gb){this.Qef=F;this.Ref=V;this.Sef=za;this.Pef=gb}jkl(F,V){this.oAc=F;this.BTb=V}}Object(h.a)(yh,"SDXDialog",Gf.a,[]);class La extends Gf.a{constructor(F,V,za,gb){super();this.Qba="calc(100% - 46px)";this.tqa="15px";this.Rba="0";this.zTb="WACDialogPanel";this.KP=695;this.ATb=462;this.vN="80%";this.pSb=350;this.PNa="100%";
this.xOa=null;this.Ad=5;this.kg="AddinInstallDialog";this.rUh=F;this.bca=V;this.J9h=za;this.y3h=gb}Bu(){super.Bu();this.rm.style.width=this.PNa;this.rm.style.height=this.Qba;this.rm.style.marginTop=this.tqa;this.rm.style.padding=this.Rba;document.getElementById(this.Uh("WACDialogButtonPanel")).style.display="none";this.IRa.setAttribute("tabindex","0");$addHandler(this.IRa,"keyup",Object(D.a)(this,this.zEk,"onKeyUp"));const F=document.createElement("iframe");F.setAttribute("id","InstallAddinDialog");
F.setAttribute("src","about:blank");F.setAttribute("width","100%");F.setAttribute("height","100%");F.setAttribute("marginHeight","0");F.setAttribute("marginWidth","0");F.setAttribute("frameBorder","0");F.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups");const V=String.format("https://inclient.store.office.com/gyro/clientstore/flyoutdetails/{0}?client={1}&ui={2}&rs={2}",this.rUh,this.bca,this.J9h);F.setAttribute("src",V);this.xOa=F;$addHandler(F,"load",
Object(D.a)(this,this.onLoad,"onLoad"));$addHandler(window,"message",Object(D.a)(this,this.onMessage,"onMessage"));this.rm.appendChild(F);this.rm.appendChild(this.fLi())}fLi(){const F=document.createElement("div");F.setAttribute("tabindex","0");$addHandler(F,"focus",Object(D.a)(this,this.OEk,"onLoopPivotFocus"));return F}zEk(F){13!==F.keyCode&&32!==F.keyCode||this.hide()}OEk(){this.IRa.focus()}onLoad(){this.xOa.focus()}onMessage(F){F=F.rawEvent;if(F.source===this.xOa.contentWindow&&(F=(F=F.data)?
F.split("|"):null)&&0<F.length&&("REFRESH_REQUIRED"===F[0]||"PRELOAD_MANIFEST"===F[0])){v.a.instance.setItem("refreshRequired","true");const V={};V.solutionId=F[1];V.version=La.pyk(F[3]);V.storeType=F[4];V.storeId=F[5];V.assetId=F[6];V.targetType=La.UMk(F[2]);V.assetStoreId=F[7];V.width=parseInt(F[8]);V.height=parseInt(F[9]);this.y3h(V)}}Iaa(){this.rm.style.width=this.PNa;this.rm.style.height=this.Qba;this.rm.style.marginTop=this.tqa;this.rm.style.padding=this.Rba;this.KP>kf.a.TR?(this.Ib.style.width=
String.format("{0}px",kf.a.TR),this.Ib.style.overflowX="scroll",z.AFrameworkApplication.isRtl?this.Ib.style.right="0":this.Ib.style.left="0"):(this.Ib.style.width=String.format("{0}px",this.KP),this.Ib.style.overflowX="hidden");this.Ib.offsetHeight>kf.a.hP||this.ATb+50>kf.a.hP?(this.Ib.style.height=String.format("{0}px",kf.a.hP),this.Ib.style.overflowY="scroll",this.Ib.style.top="0",z.AFrameworkApplication.isRtl?this.Ib.style.right="0":this.Ib.style.left="0",this.rm.style.minHeight=String.format("{0}px",
this.pSb)):(this.Ib.style.overflowY="hidden",this.Ib.style.top="10%",this.Ib.style.height=this.vN);this.VCa()}VCa(){if(this.Ib){var F=this.Ib.style.zIndex;this.Ib.style.zIndex="-9999";if(this.KP>kf.a.TR)z.AFrameworkApplication.isRtl?this.Ib.style.marginRight="0":this.Ib.style.marginLeft="0";else{const V=String.format("{0}px",Math.floor(-this.Ib.offsetWidth/2));z.AFrameworkApplication.isRtl?this.Ib.style.marginRight=V:this.Ib.style.marginLeft=V;z.AFrameworkApplication.isRtl?this.Ib.style.right="50%":
this.Ib.style.left="50%"}this.Ib.style.zIndex=String(F)}else r.ULS.sendTraceTag(509871430,306,10,"_divMessageBox is null in CenterDialog()")}VA(){super.VA();const F=document.getElementById(this.Uh(this.zTb));F.style.width=String.format("{0}px",this.KP);F.style.height=this.vN}get fka(){return this.rm}dispose(){super.dispose();$removeHandler(window,"message",Object(D.a)(this,this.onMessage,"onMessage"))}static UMk(F){switch(F){case "1":return 0;case "2":return 1;default:return 0}}static pyk(F){const V=
F.split(".");for(let za=0;za<4-V.length;za++)F+=".0";return F}}Object(h.a)(La,"AddinInstallDialog",Gf.a,[]);var sb=d(173);class Ob{constructor(F,V,za){this.Pzb=F;this.onSuccess=V;this.onError=za;$addHandler(window,"message",Object(D.a)(this,this.v9b,"handleResponse"))}v9b(F){try{if(F&&F.rawEvent&&F.rawEvent.origin&&this.Pzb&&this.Pzb.id){var V=this.reh(F.rawEvent.origin);const za=this.reh(document.domain);if(Kd.a.Ml().equals(za,V))if(F.rawEvent.source&&F.rawEvent.source.frameElement&&F.rawEvent.source.frameElement.id&&
Kd.a.Ml().equals(F.rawEvent.source.frameElement.id,this.Pzb.id)){V=null;try{V=JSON.parse(F.rawEvent.data)}catch(gb){r.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",gb.message)}V?(V.statusCode!==sb.a.mx||void 0!==V.error&&V.error?(r.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",V.statusCode,V.error),this.onError()):
(r.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.onSuccess(V.authorizationCode?V.authorizationCode:V.signInUrl)),$removeHandler(window,"message",Object(D.a)(this,this.v9b,"handleResponse")),this.Pzb?document.body.contains(this.Pzb)?document.body.removeChild(this.Pzb):r.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):r.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):r.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else r.ULS.sendTraceTag(51451614,
344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");else r.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else r.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(za){r.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",za.message)}}reh(F){let V="";
try{F&&(V=-1<F.indexOf("//")?F.split("/")[2]:F.split("/")[0])&&(V=V.split(":")[0],V=V.split("?")[0])}catch(za){r.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",za.message)}return V}static ly(F,V,za){new Ob(F,V,za)}}Object(h.a)(Ob,"ResponseHandler",null,[]);var pc=d(216);class Kc{constructor(F){this.Nra=F}tryAuthenticate(F,V){this.qld(Kc.UZh,()=>{F()},V)}tryAuthorize(F,V){this.qld(Kc.AUh,F,V)}getSignInUrl(F,V){this.qld(Kc.otf,F,V)}signOut(F,V){this.qld(Kc.I7h,F,V)}qld(F,
V,za){var gb=new pc.QueryStringBuilder("AuthenticationProxyHandler.aspx");gb.jg("responseType",F);z.AFrameworkApplication.AQa(gb);gb=String.format("{0}{1}&{2}",this.Nra,gb.toString(),z.AFrameworkApplication.gh);const Fb=document.createElement("iframe");Fb.setAttribute("id","privateCatalogIframe");Fb.setAttribute("name","privateCatalogIframe");Fb.setAttribute("style","display: none");Kd.a.Ml().equals(F,Kc.otf)||Fb.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");
Ob.ly(Fb,V,za);Fb.setAttribute("src",gb);document.body.appendChild(Fb)}}Kc.AUh="authcode";Kc.UZh="identitytoken";Kc.otf="signinurl";Kc.I7h="signout";Object(h.a)(Kc,"AuthenticationProxy",null,[]);class Gd{}Gd.getUserId="getUserId";Gd.getLastStoreUpdate="laststoreupdate";Gd.getEntitlement="getEntitlements";Gd.getEToken="getEToken";Gd.getManifest="getManifest";Gd.getAppState="getAppState";Gd.getKilledApps="getRemovedAddins";Gd.getAppDetails="getAppDetails";Gd.removeApps="removeAddin";Gd.getLastPrivateCatalogUpdate=
"getLastPrivateCatalogUpdate";Gd.getPrivateCatalogAddIns="getAddIns";Gd.getPrivateCatalogManifests="getAppManifests";Gd.isStoreDisabled="isStoreDisabled";Object(h.a)(Gd,"S2SWebRequestActions",null,[]);var he=d(534);class Ue{getUserId(F,V){const za=new e.a;za.add(new Ma.a("corr",F));this.Wx(Gd.getUserId,za,1,V)}getLastStoreUpdate(F,V,za){const gb=new e.a;gb.add(new Ma.a("lc",F));gb.add(new Ma.a("corr",V));this.Wx(Gd.getLastStoreUpdate,gb,1,za)}getEntitlement(F,V,za,gb){F=new e.a;F.add(new Ma.a("av",
V));F.add(new Ma.a("corr",za));this.Wx(Gd.getEntitlement,F,1,gb)}getEToken(F,V,za,gb,Fb,Ec){const $c=new e.a;$c.add(new Ma.a("cmu",F));$c.add(new Ma.a("cmf",V));$c.add(new Ma.a("assetid",za));$c.add(new Ma.a("expver",gb));$c.add(new Ma.a("corr",Fb));this.Wx(Gd.getEToken,$c,1,Ec)}getManifest(F,V,za,gb){const Fb=new e.a;Fb.add(new Ma.a("cmu",F));Fb.add(new Ma.a("assetid",V));Fb.add(new Ma.a("corr",za));this.Wx(Gd.getManifest,Fb,1,gb)}getAppState(F,V,za){const gb=new e.a;gb.add(new Ma.a("ma",F));gb.add(new Ma.a("corr",
V));this.Wx(Gd.getAppState,gb,1,za)}getKilledApps(F,V){const za=new e.a;za.add(new Ma.a("corr",F));this.Wx(Gd.getKilledApps,za,1,V)}getAppDetails(F,V,za,gb){const Fb=new e.a;Fb.add(new Ma.a("cmo",F));Fb.add(new Ma.a("corr",za));this.sendWithBody(Gd.getAppDetails,Fb,V,2,gb,!1)}removeApps(F,V,za){const gb=new e.a;gb.add(new Ma.a("corr",V));this.sendWithBody(Gd.removeApps,gb,F,2,za,!1)}getLastPrivateCatalogUpdate(F,V,za,gb,Fb,Ec){const $c=new e.a;$c.add(new Ma.a("catalog","privatecatalog"));$c.add(new Ma.a("clientCode",
F));$c.add(new Ma.a("clientVersion",V));$c.add(new Ma.a("corr",Fb));F=String.format("authorizationCode={0}&refreshToken={1}",za?fa.a.Qe(za):"",gb?fa.a.Qe(gb):"");this.sendWithBody(Gd.getLastPrivateCatalogUpdate,$c,F,2,Ec,!0)}getPrivateCatalogAddIns(F,V,za,gb,Fb,Ec){const $c=new e.a;$c.add(new Ma.a("catalog","privatecatalog"));$c.add(new Ma.a("clientCode",F));$c.add(new Ma.a("clientVersion",V));$c.add(new Ma.a("corr",Fb));F=String.format("authorizationCode={0}&refreshToken={1}",za?fa.a.Qe(za):"",gb?
fa.a.Qe(gb):"");this.sendWithBody(Gd.getPrivateCatalogAddIns,$c,F,2,Ec,!0)}getPrivateCatalogManifests(F,V,za,gb,Fb){const Ec=new e.a;Ec.add(new Ma.a("catalog","privatecatalog"));Ec.add(new Ma.a("corr",gb));F=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",fa.a.Qe(F),V?fa.a.Qe(V):"",za?fa.a.Qe(za):"");this.sendWithBody(Gd.getPrivateCatalogManifests,Ec,F,2,Fb,!0)}isStoreDisabled(F,V){const za=new e.a;za.add(new Ma.a("corr",F));this.Wx(Gd.isStoreDisabled,za,2,V)}Wx(F,V,za,gb){this.sendWithBody(F,
V,null,za,gb,!1)}sendWithBody(F,V,za,gb,Fb,Ec){const $c=new pc.QueryStringBuilder("AddinServiceHandler.ashx");$c.jg("action",F);$c.jg("app",he.a[z.AFrameworkApplication.Aa.ob.zk]);for(let Ed of V)$c.jg(Ed.key,Ed.value);V=String.format("{0}{1}&{2}",z.AFrameworkApplication.Aa.ob.Zna,$c.toString(),z.AFrameworkApplication.gh);z.AFrameworkApplication.Me.zj(V,gb,za,null,!1,2,Ed=>{let pe=null,Se=null;Ed&&Ed.data&&(Ed.data.yj["X-BlockedForMinor"]&&"1"===Ed.data.yj["X-BlockedForMinor"].toString()&&(Ed.data.Ke=
451),pe=Ed.data.ee,Se=Ed.data.yj);Fb(Ed.data.Ke,pe,Se)},Ed=>{var pe=null;let Se=null;Ec&&Ed&&Ed.data&&Ed.data.ee&&(pe=Ed.data.ee,Se=Ed.data.yj);Fb(Ed.data.Ke,pe,Se);if(z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){pe={message:"AddinServiceHandler request failed"};pe.code=Ed.data.Ke;pe.action=F;if(Ed.data.request||Ed.data.request.get_headers())pe["X-UserSessionId"]=Ed.data.request.get_headers()["X-UserSessionId"];408===Ed.data.Ke||
503===Ed.data.Ke?r.ULS.sendTraceTag(538784582,220,10,JSON.stringify(pe)):r.ULS.sendTraceTag(18392345,220,50,JSON.stringify(pe))}else r.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",Ed.data.Ke)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+F,void 0,void 0,void 0,["X-UserKey"])}}Object(h.a)(Ue,"S2SWebRequestManager",null,[]);var Rf=d(32),sf=d(84);class ag{constructor(F,V){this.state=F;this.Pya=V}}Object(h.a)(ag,"BackgroundAppData",null,[730]);class xg{constructor(F,
V,za,gb,Fb,Ec,$c,Ed){this.Oca=null;this.Eek=F;this.urk=gb;this.vA=V;this.wu=za;this.OGb=Fb;this.settings=Ec;this.Iek=$c;this.qw=Ed}get jp(){return this.Eek}get taskpane(){return this.urk}get instanceId(){return this.vA}get shape(){return this.wu}get rYe(){return this.OGb}get iy(){return this.Iek}Nai(F){this.qw=new ag(0,F)}}Object(h.a)(xg,"AppForOffice",null,[672]);var Tg=d(31);class li{}li.c_Error="Error";Object(h.a)(li,"ApiResponseKeyStrings",null,[]);class Li{constructor(F,V,za,gb,Fb){this.EventDispId=
F;this.ControlId=V;this.TargetId=za;this.Handler=gb;this.Callback=Fb}}Object(h.a)(Li,"EventRegistrationParams",null,[]);var Le=d(28);class Ih{constructor(F,V){this.invokeDdaMethod=this.InvokeDdaMethod;this.registerDdaEventAsync=this.RegisterDdaEventAsync;this.wb=z.AFrameworkApplication.Ae;this.aDe=F;this.JCg=V}InvokeDdaMethod(F,V,za){const gb=F.DdaMethod.DispatchId,Fb=this.aDe.waj(gb);Fb?(Fb.parameters=F,Fb.callback=V,Fb.hji=za,Fb.controlId=F.DdaMethod.ControlId,this.wb.Hb(new nd.a(2,1,0,Object(D.a)(Fb,
Fb.go,"go"),90,"51"))):(F="API Call for method ID "+gb+" does not exist:"+Tg.Debug.gu(),Le.a.J(8958091,802,10,F),this.IXd(V))}RegisterDdaEventAsync(F,V,za,gb,Fb){const Ec=new nd.a(2,1,0,Object(D.a)(this,this.c3k,"registerEventTaskProcess"),90,"52");Ec.customData=new Li(F,V,za,gb,Fb);this.wb.Hb(Ec)}UnregisterDdaEventAsync(F,V,za,gb,Fb){const Ec=new nd.a(2,1,0,Object(D.a)(this,this.fMl,"unregisterEventTaskProcess"),90,"53");Ec.customData=new Li(F,V,za,gb,Fb);this.wb.Hb(Ec)}c3k(F){F=F.customData;var V=
this.JCg.n9d(F.EventDispId);V?V.addHandler(F.ControlId,F.Handler,F.Callback,F.TargetId):(V="Event for dispatch ID "+F.EventDispId+" does not exist:"+Tg.Debug.gu(),Le.a.J(8958093,802,10,V),this.IXd(F.Callback))}fMl(F){F=F.customData;var V=this.JCg.n9d(F.EventDispId);V?V.removeHandler(F.ControlId,F.Handler,F.Callback,F.TargetId):(V="Event for dispatch ID "+F.EventDispId+" does not exist:"+Tg.Debug.gu(),Le.a.J(8958095,802,10,V),this.IXd(F.Callback))}IXd(F){if(F){var V={};V[li.c_Error]=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;
F(V)}}}Object(h.a)(Ih,"AppForOfficeApiAdapter",null,[736]);class bj{constructor(F,V,za,gb){this.menuItemId=F;this.mV=V;this.PBl=za;this.T3i=gb}}Object(h.a)(bj,"NewDocumentParameters",null,[]);var zh=d(589),jj=d(130),Sh=d(140),ya=d(44),Ra=d(53),hb=d(75),Eb=d(34),Yb=d(41),Nb=d(51),ed=d(40),zd=d(35),Hd=d(58);class ba{constructor(F,V,za){this.Hgb=[];this.W7c=this.UDb=!1;this.ua=F;this.fG=V;this.Az=za}build(){const F=this.ua.nz();if(!F)return this.Hgb;for(const V of F)if(this.uUk(V),this.W7c)break;return this.Hgb}uUk(F){const V=
Eb.ParagraphReader.textLength(F);this.vUk(F,V);this.W7c||this.bUk(F)}vUk(F,V){this.UDb||(this.fG>=V?this.fG-=V:(this.UDb=!0,this.Az||this.Hgb.push(Nb.a.Lj(Object(aa.a)(sf.a,F),this.fG))));this.UDb&&(this.Az>V-this.fG?0<V&&(this.Hgb.push(Nb.a.createTextRange(Object(aa.a)(sf.a,F),this.fG,V)),this.Az-=V-this.fG,this.fG=0):0<this.Az&&(this.Hgb.push(Nb.a.createTextRange(Object(aa.a)(sf.a,F),this.fG,this.fG+this.Az)),this.Az=0));0>=this.Az&&(this.W7c=!0)}bUk(F){this.UDb||(0<this.fG?--this.fG:(this.UDb=
!0,this.Az||this.Hgb.push(Nb.a.YRa(Object(aa.a)(sf.a,F)))));this.UDb&&0<this.Az&&(this.Hgb.push(Nb.a.lda(Object(aa.a)(sf.a,F))),--this.Az);0>=this.Az&&(this.W7c=!0)}}Object(h.a)(ba,"TextSelectionBuilder",null,[]);var Aa=d(989),Pa=d(30);class ub{constructor(F,V,za,gb,Fb,Ec,$c,Ed,pe,Se,Ye,ae,lg,og,se,Df,Ci,oj,Pl,Pf,Rm,Zf,Ge,Si){this.Ea=F;this.Jb=V;this.FJ=za;this.Rfb=gb;this.pa=Fb;this.BJ=Ec;this.nad=$c;this.Eb=Ed;this.ia=pe;this.ta=Ye;this.wb=ae;this.Tb=Se;this.Sb=lg;this.jc=og;this.Bek=se;this.kb=
Df;this.Gb=Ci;this.xk=oj;this.Ga=Pl;this.Rb=Pf;this.tIa=Rm;this.Gh=Zf;this.Rq=Ge;this.Plk=Si}Vqj(){let F;F="";if(this.kb.rH()){if(1<this.kb.srd())return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,psc:F};const V=this.kb.fo();if(this.a4j(V)){const za=[];this.Ga.eK(V,gb=>{gb&&za.push(gb.characterData)});F=za.join(ub.$Gf);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,psc:F}}}else if(this.kb.pz())return this.getSelectedTextRange();return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,
psc:F}}Rqj(){let F;F="";return{returnValue:({U2e:F}=this.getSelectedSlides()).returnValue,Kgl:F}}ayb(){return this.FJ.Nib.documentUrl}gyj(F){if(!F)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;var V=this.Sb.Cj();if(!this.ta.Ba)throw Error.argumentNull("ActiveSlide is null");const za=this.ta.Ba.ue;switch(F){case "previous":F=za-1;break;case "next":F=za+1;break;case "first":F=0;break;case "last":F=V-1;break;default:if(F=parseInt(F),isNaN(F))return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo}if(0>
F||F>V-1)return OSF.DDA.ErrorCodeManager.errorCodes.ooeNavOutOfBound;V=this.Sb.gA(F);if(!V)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;this.Tb.Ba=V;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}hyj(F){if(!F)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;F=parseInt(F);if(isNaN(F))return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;F=this.Zce(F);if(!F)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist;this.Tb.Ba=F;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}Unl(F){var V=
this.kb.Xd();if(!V.length){if(V=Object(aa.a)(118,this.kb.hk()||this.ta.Ba)){var za=V.Db;F=this.xk.g1d(za.cid,za.sid,V.zs()+1,F,"");za=this.Eb.xd(7);za.hc(V);V.jB(F);this.kb.selectShape(F,!0);za.dispose();this.Rq.lA=F;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}}else if(1===V.length){if(this.kb.rH())return this.Wol(F);if(this.kb.pz())return this.Xol(F)}return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}byh(F,V,za,gb,Fb,Ec,$c,Ed){if(this.cSc(Fb,0,ub.Pnb)||this.cSc(Ec,0,ub.Pnb)||
this.cSc(za,-ub.Pnb,ub.Pnb)||this.cSc(gb,-ub.Pnb,ub.Pnb)||0!==$c&&1!==$c)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;if(F.length>this.Ea.pptEditorAppsForOfficeImageMaxSizeInBytes)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSetDataIsTooLarge;var pe=this.kb.Xd().length;if(V||Fb||Ec||!pe){pe=this.ta.Ba;if(!pe)throw Error.argumentNull("ActiveSlide is null");const Ye=pe.Db,ae=pe.zs();let lg=!0,og=new Hd.a(0,0);V?og=new Hd.a(za,gb):!this.Ea.EQk||Fb&&Ec?og=this.Sb.Rka(Fb,Ec):lg=!1;const se=
this.xk.Uja(!1,Ye.cid,Ye.sid,0,zh.a.RH(og.x),zh.a.RH(og.y),zh.a.RH(Fb),zh.a.RH(Ec),ae+1,!0);lg||(se.vo(Yb.a.Iy),se.vo(Yb.a.Jy));se.qj=!0;se.pud=!0;se.oz=$c;se.jea=0===$c?this.JOf(F):F;const Df=(F=this.WTj(Ed)&&this.Ea.ka("ChatPPTImgShowDesigner"))&&this.Ea.ka("ChatPPTHideImg");se.AAb=!0;$c=this.Eb.xd(7,void 0,()=>{Df&&(this.kb.au(),this.kb.nh())},()=>{Df&&(this.kb.au(),this.kb.nh())});try{if(F&&($c.fd=Pa.a.BIc,Df)){var Se=this.Ea.wc("ChatPPTHideImgMs",3E3);se.PPb=Date.now()+Se;this.wb.Hb(new nd.a(2,
1,Se+this.Ea.wc("ChatPPTUnhideUpdateMs",2E3),()=>{if(0!=se.PPb){se.PPb=0;const Ci=Object(aa.a)(119,se.qc(this.Gb.Na));null===Ci||void 0===Ci?void 0:Ci.hAa()}},void 0,"ShowAddInImg"))}$c.hc(pe);pe.jB(se);this.kb.selectShape(se,!0)}catch(Ci){Le.a.J(509112541,802,10,"setSelectedImageData got exception "+Ci)}finally{$c&&$c.dispose()}this.Rq.lA=se;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}if(1===pe&&(Se=this.kb.fo())&&Se.OLc){pe=this.ta.Ba;if(!pe)throw Error.argumentNull("ActiveSlide is null");
V=this.xab(pe,Se);V.qj=!0;V.oz=$c;V.jea=0===$c?this.JOf(F):F;V.AAb=!0;F=this.Eb.xd(7);try{F.hc(pe),pe.YR([Se]),pe.jB(V),this.kb.selectShape(V,!0)}finally{F&&F.dispose()}this.Rq.lA=V;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}Le.a.J(512263113,802,10,"No placehoder seleted or multi-shape seleted.");return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}WTj(F){const V=this.Ea.Ha("ChatPPTOrigin");return(this.Ea.iA||this.Ea.ZF)&&V===F}wla(){return this.Ea.wla}NSj(){return this.Jb.ka("342")}Ufj(F){if(!F)return null;
F=this.Bek.z3(F);F=0===F.iy?F.node:this.ta.Ba;if(!F)return null;F=Object(aa.a)(117,this.jc.mg(F));return rf(F.Ed)}gYe(F,V){if(F&&V)if(id.a("UseUndoTransactionForSaveSettingToApp")){var za=this.Eb.xd(15,void 0,void 0,void 0,!0);try{za.hc(F),za.fd=Pa.a.eAb,Aa.a.NMh(this.nad.value,F,V)}finally{za&&za.dispose()}}else{za=this.Eb.xd(4);try{za.hc(F),Aa.a.NMh(this.nad.value,F,V),this.Tb.Di.Ega()}finally{za&&za.dispose()}}}$8a(F,V,za){const gb=new x.StandardDialog;gb.Ad=4;gb.Tx(CommonUIStrings.l_GeneralAddInMessageDialogTitle,
CommonUIStrings.l_NewFileAPIConsentMessage,1,Fb=>{2===Fb||0===Fb?za(OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationCancelled):(Fb=new bj("blank","agave",F?ub.Lxk:ub.Mxk,F),this.Plk.create(V,za,Fb).$8a())})}Se(){return this.kb.Se()}Xd(){return this.kb.Xd()}Zqj(){var F=this.kb.Xd();if(!(F.length&&this.kb.pz()&&this.pa.value&&this.pa.value.Pa.length))return[];const V=this.pa.value.Pa.ga(0);return(F=ub.Voj(F[0],V))&&2===F.length?F:[]}JKl(F){if(!F)return!1;this.kb.p9a();if(!F.length)return!0;F[0]!==this.ta.Ba&&
(this.Tb.Ba=F[0]);for(const V of F)V&&this.kb.t7a(V);return!0}IKl(F){if(!F)return!1;if(!F.length)return this.kb.nh(),!0;this.kb.d1a(F,!0);return!0}KKl(F,V,za){if(!ub.msg(F))return!1;if(0>V)return!0;F=(new ba(F,V,za)).build();F=[new jj.Selection(F,!0)];F=new Sh.SelectionCollection(F,0);this.kb.gF(F);return!0}getSelectedSlides(){let F;F="";var V=null;if(!V||!V.length){var za=this.kb.hk()||this.ta.Ba;V||(V=[]);za&&V.push(za)}if(!V.length)return Le.a.J(512263111,802,10,"Unexpected error: cannot get current slide."),
{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,U2e:F};za=[];for(const gb of V){V=gb.ue+1;if(!V)return Le.a.J(512263110,802,10,"Returned slide index is invalid."),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,U2e:F};Array.add(za,[gb.sid.toString(),gb.title||"",V.toString()])}F=Z.c(za);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,U2e:F}}getSelectedTextRange(){var F=[];for(let V=0;V<this.pa.value.Pa.length;V++){const za=this.pa.value.Pa.ga(V);
Array.add(F,this.YWc(za))}F=F.join(ub.$Gf);if(F===hb.AParagraphNode.w_)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,psc:F};F=hb.AParagraphNode.Sod(F);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,psc:F}}a4j(F){if(!F)return!1;let V=F.Pla||F.Hx||F.Wf||F.vd;if(!V&&F.rl)switch(F.Qj){case 0:case 2:case 1:case 3:case 10:case 8:V=!0}return V}b4j(F){if(!F)return!1;let V=F.Pla||F.Hx;if(!V&&F.rl)switch(F.Qj){case 0:case 2:case 1:case 3:case 8:V=
!0}return V}YWc(F){let V="";if(F)for(let za=0;za<F.length;za++){const gb=F.ga(za),Fb=gb.Sa,Ec=gb.Mb-Fb;let $c="";Eb.ParagraphReader.ae(gb.node)&&($c=gb.node.characterData);switch(gb.contextId){case ed.a.paragraph:V+=$c+"\r";break;case ed.a.textRange:0<Ec&&(V+=$c.substr(Fb,Ec));break;case ed.a.endOfParagraph:V+="\r"}}return V}Zce(F){var V=this.ta.presentation;if(!V)throw Error.argumentNull("Presentation is null");V=V.slides||[];for(let za=0;za<V.length;za++)if(V[za].Db.sid===F)return Object(aa.a)(118,
V[za]);return null}Xol(F){if(!this.pa.value||!this.BJ.value||!this.Rfb.value)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(1===this.pa.value.Pa.length){if(!ya.SelectionEditor.Dx(this.pa.value.Pa.mb)&&32!==this.ia.processAction(zd.a.LDa,2))return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;var V=this.pa.value.Pa.mb.Va;const za=V.node,gb=V.Sa;V=V.Mb;const Fb=this.Eb.xd(7);try{Fb.hc(za);let Ec=null;Ec=gb===V?Nb.a.Lj(za,gb):Nb.a.createTextRange(za,gb,V);this.BJ.value.replaceTextRange(Ec,
F)}finally{Fb.dispose()}V=gb+F.length;this.pa.value.setSelection(Ra.SelectionFactory.D3(za,gb,V));return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}Le.a.J(512263107,802,10,"SetTextForSelectedTextRange is called when there are more than one shape selected.");return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}Wol(F){if(!this.pa.value||!this.BJ.value||!this.Rfb.value)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;const V=this.kb.fo();if(!V)return F="Fail to get shape while setting selected shape's text: shape returned as null: "+
Tg.Debug.gu(),Le.a.J(512263106,802,10,F),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.b4j(V)){const za=this.Rb.Lc(V),gb=this.Eb.xd(7);try{gb.hc(za);V.deleteParagraph();this.Rfb.value.nW(za,!0);this.tIa.yi(za);const Fb=za.currentNode,Ec=this.Gh.textLength(Fb),$c=Nb.a.createTextRange(Fb,0,Ec);this.BJ.value.replaceTextRange($c,F)}finally{gb.dispose()}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}Le.a.J(512263105,802,10,"Shape is not supported by SetDataAsync");return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}cSc(F,
V,za){return F<V||za<F}JOf(F){return"data:image/png;base64,"+F}xab(F,V){if(!F)return null;var za=F.Db;F=F.zs();let gb;const Fb=Mf.a.LR,Ec=Mf.a.nY;gb=V?V.zyb(Mf.a.LR,Mf.a.nY):this.Sb.Rka(Mf.a.LR,Mf.a.nY);za=this.xk.Uja(!0,za.cid,za.sid,0,gb.x,gb.y,Fb,Ec,F+1,!0);V&&(za.v8=V.id);return za}static msg(F){if(!F)return!1;let V=F.Pla||F.Hx;if(!V&&F.rl)switch(F.Qj){case 0:case 2:case 1:case 3:case 5:case 6:case 8:V=!0}return V}static Uuj(F,V){F=F.nz();if(!F||!V)return 0;let za=0;for(const gb of F){if(gb===
V)break;za+=Eb.ParagraphReader.textLength(Object(aa.a)(sf.a,gb))+1}return za}static Voj(F,V){if(!ub.msg(F)||!V)return[];var za=-1;let gb=0;for(let Fb of V){V=Eb.ParagraphReader.ae(Fb.node)?Eb.ParagraphReader.textLength(Fb.node):0;if(-1===za)switch(za=Eb.ParagraphReader.ae(Fb.node)?ub.Uuj(F,Object(aa.a)(5,Fb.node)):0,Fb.contextId){case ed.a.paragraph:break;case ed.a.textRange:case ed.a.Mf:za+=Fb.Sa;break;case ed.a.endOfParagraph:za+=V;break;default:return[]}switch(Fb.contextId){case ed.a.paragraph:gb+=
V+1;break;case ed.a.textRange:gb+=Math.max(0,Fb.Mb-Fb.Sa);break;case ed.a.endOfParagraph:gb+=1}}return[za,gb]}}ub.$Gf=" ";ub.Pnb=169056;ub.Mxk="streamEmpty";ub.Lxk="streamBase64";Object(h.a)(ub,"AppForOfficeApiFacadeEditorImpl",null,[735]);class Lb{yfg(F,V,za){if(za.sEa(F))r.ULS.sendTraceTag(512360733,806,10,"[HandlePersistedOwnerApp]This method should not be invoked when OwnerApp already exists.");else if(F=za.g6b(F)){const gb={};gb.solutionId=F.jp.id;gb.version=F.jp.version;gb.storeType=F.jp.storeType;
gb.storeId=F.jp.store;gb.assetId=null;gb.assetStoreId=null;gb.targetType=1;gb.isAddinCommands=!0;gb.addinCommandsActionType=1;gb.sharedRuntimeId=F.qw?F.qw.Pya:null;gb.backgroundState=F.qw?F.qw.state:-1;F.settings=V;za.wUd.gH().Ka(Pa.a.$Zc,2,gb);return!0}return!1}KSj(F,V){if(!F&&!V)return!0;if(!F||!V||Object.keys(F).length!==Object.keys(V).length)return!1;for(let Fb in F){var za=Fb,gb=F[Fb];if(!(za in V)||V[za]!==gb)return!1}return!0}}Object(h.a)(Lb,"AppForOfficeAppSettingProxy",null,[]);class Mb{constructor(F,
V,za,gb){this._id=F;this.c7a=V;this.Y7=za;this.JGc=gb}get id(){return this._id}get version(){return this.c7a}get store(){return this.Y7}get storeType(){return this.JGc}}Object(h.a)(Mb,"AppForOfficeReference",null,[733]);class kd{constructor(F,V){this._id=F;this.U7h=V}get id(){return this._id}get slideId(){return this.U7h}}Object(h.a)(kd,"AppForOfficeShape",null,[732]);class Id{constructor(F,V,za,gb,Fb,Ec=null,$c=!1){this.oXh=F;this.C$h=V;this.f7a=za;this.q6h=gb;this.yLd=Fb;this.isForUILessAction=
$c;this.T3h=Ec}get QUf(){return this.oXh}get visibility(){return this.C$h}get width(){return this.f7a}get row(){return this.q6h}get ownerAddinSolutionId(){return this.yLd}get ownerAddinStoreType(){return this.T3h}}Object(h.a)(Id,"AppForOfficeTaskpane",null,[731]);class ce{constructor(F,V,za,gb=null){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=F;this.controlId=V;this.ddaBinding=za;this.ArrayData=gb}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}
Object(h.a)(ce,"DdaEventArgs",null,[]);class Xe{constructor(F,V){this.ODb=null;this.Oc=F;this.ia=V}n9d(F){this.ODb||this.zPk();if(!F||!this.ODb[F])return null;F=this.ODb[F];F.Gd=this.Oc;F.qn=this.ia;return F}rKf(F){const V=this.ODb;for(let za in V)V[za].removeHandler(F)}set(F,V){this.ODb[F]=V}}Object(h.a)(Xe,"ApiEventStore",null,[]);class jd{constructor(){this.Ko=this.ia=this.Oc=null;this.wl={}}get handlers(){return this.wl}get qn(){return this.ia}set qn(F){this.ia=F}get Gd(){return this.Oc}set Gd(F){this.Oc=
F}raiseEvent(F,V=null){F=this.iua(F);if(V){var za=this.wl[V];za&&za(F)}else for(za in V=this.wl,V){const gb=V[za];gb&&gb(F)}}addHandler(F,V,za=null){this.wl[F]=V;this.l8a(za)}removeHandler(F,V,za=null){delete this.wl[F];this.l8a(za)}get result(){return this.Ko}l8a(F){this.oB(F,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}oB(F,V){F&&(this.Ko={},this.Ko[li.c_Error]=V,F(this.Ko))}}Object(h.a)(jd,"ApiEvent",null,[768]);class rd extends jd{constructor(){super()}iua(F){return F}static get instance(){rd.Sp||
(rd.Sp=new rd);return rd.Sp}}rd.Sp=null;Object(h.a)(rd,"ActivationStatusChangedEvent",jd,[]);class Wc extends jd{constructor(){super()}iua(){return"view"}static get instance(){Wc.Sp||(Wc.Sp=new Wc);return Wc.Sp}}Wc.Sp=null;Object(h.a)(Wc,"ActiveViewChangedEvent",jd,[]);var wd=d(105);class Fe extends jd{constructor(){super();this.Fte=null}iua(){return null}get $sa(){!this.Fte&&this.Gd&&(this.Fte=Og.getInstance(this.Gd.Ui));return this.Fte}addHandler(F,V,za=null,gb=null){this.Gd?this.Gd.Yt.wla()?F in
this.handlers?this.oB(za,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):(r.ULS.sendTraceTag(20247126,802,50,"AddHandler was called."),this.showDialog(F,gb,Fb=>{Fb===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(wd.a.count(this.handlers)||this.$sa.Ogi(Object(D.a)(this,this.vMe,"onMessageParentEvent")),this.handlers[F]=V,this.Gd.Ui?({value:Fb}=Og.tdg().wg(F),Fb?(this.Gd.Ui.setActivationCompletedStatus(Fb.kg,!0),this.Gd.l0a(OSF.DDA.EventDispId.dispidActivationStatusChangedEvent.toString(),Fb.kg,
!0)):r.ULS.sendTraceTag(24463263,806,15,"Show dialog successed but get dialogInfo failed")):r.ULS.sendTraceTag(24463264,806,15,"Show dialog successed but ContextActivationManager is null"),this.l8a(za)):(r.ULS.sendTraceTag(20247127,806,10,"Show dialog failed. Error code: {0}",Fb.toString()),this.oB(za,Fb))})):this.oB(za,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.oB(za,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(F,V,za=null){this.Gd?this.Gd.Yt.wla()?
F in this.handlers?(r.ULS.sendTraceTag(20247128,802,50,"RemoveHandler was called."),this.$sa.gCi(F,gb=>{delete this.handlers[F];wd.a.count(this.handlers)||this.$sa.Noh(Object(D.a)(this,this.vMe,"onMessageParentEvent"));gb!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&r.ULS.sendTraceTag(20247129,806,10,"Close dialog failed. Error code: {0}",gb.toString());this.oB(za,gb)})):this.oB(za,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.oB(za,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):
this.oB(za,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}showDialog(F,V,za){try{this.$sa.showDialog(V,F,za,null)}catch(gb){r.ULS.sendTraceTag(19535264,806,10,"DialogMessageReceivedEvent: Show dialog failed. Exception message: {0}",gb.message),za(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}vMe(F,V){if(V.controlId in this.wl){F={};F[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageType]=V.messageType;F[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageContent]=
V.messageContent;F[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageOrigin]=V.GIe;F[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.TargetOrigin]=V.DMa;const za=this.wl[V.controlId];za&&za(F);V.messageType===OSF.DialogMessageType.DialogClosed&&(delete this.wl[V.controlId],wd.a.count(this.wl)||this.$sa.Noh(Object(D.a)(this,this.vMe,"onMessageParentEvent")))}}static get instance(){Fe.Sp||(Fe.Sp=new Fe);return Fe.Sp}}Fe.Sp=null;Object(h.a)(Fe,"DialogMessageReceivedEvent",jd,[]);
class ak extends jd{constructor(){super()}iua(){return null}addHandler(F,V,za=null){this.Gd?this.Gd.Yt.wla()?(V=this.Gd.Jxb(F))&&V.taskpane&&V.taskpane.isForUILessAction?(this.qn.Ka(Pc.a.huc,2,F),this.l8a(za)):this.oB(za,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.oB(za,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.oB(za,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(F,V,za=null){this.Gd?this.Gd.Yt.wla()?(V=this.Gd.Jxb(F))&&V.taskpane?V.taskpane.isForUILessAction?
(this.qn.Ka(Pc.a.c$b,2,F),this.l8a(za)):this.oB(za,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog):this.oB(za,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.oB(za,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.oB(za,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}Object(h.a)(ak,"DialogNotificationShownInAddinEvent",jd,[]);class tj extends jd{constructor(){super();this.Ui=this.cVd=null}iua(){return null}get $sa(){this.cVd||(this.cVd=Og.getInstance(this.contextActivationMgr));
return this.cVd}get contextActivationMgr(){!this.Ui&&this.Gd&&(this.Ui=this.Gd.Ui);return this.Ui}addHandler(F,V,za=null){this.Gd&&!this.Gd.Yt.wla()?this.oB(za,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):F in this.wl?this.oB(za,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):(wd.a.count(this.wl)||this.$sa.Ngi(Object(D.a)(this,this.y$g,"onMessageDialogEvent")),this.wl[F]=V,this.oB(za,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess))}removeHandler(F,V,za=null){this.Gd&&!this.Gd.Yt.wla()?
this.oB(za,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):F in this.wl?(delete this.wl[F],wd.a.count(this.wl)||this.$sa.i8k(Object(D.a)(this,this.y$g,"onMessageDialogEvent")),this.oB(za,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)):this.oB(za,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}y$g(F,V){V.controlId in this.wl&&(F={},F[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageType]=V.messageType,F[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageContent]=
V.messageContent,F[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageOrigin]=V.GIe,F[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.TargetOrigin]=V.DMa,(V=this.wl[V.controlId])&&V(F))}static get instance(){tj.Sp||(tj.Sp=new tj);return tj.Sp}}tj.Sp=null;Object(h.a)(tj,"DialogParentMessageReceivedEvent",jd,[]);class bh extends jd{constructor(){super()}iua(){return{}}static get instance(){bh.Sp||(bh.Sp=new bh);return bh.Sp}}bh.Sp=null;Object(h.a)(bh,"DocumentSelectionChangedEvent",
jd,[]);class ee extends jd{constructor(){super()}iua(){return null}raiseEvent(F,V){try{const za=this.wl[V];za&&(V={},V[OSF.DDA.Marshaling.ThemingKeys.DocumentTheme.toString()]=F,za(V))}catch(za){Le.a.J(17687447,802,10,"DocumentThemeChanged Event failed, message: "+za.message)}}static get instance(){ee.Sp||(ee.Sp=new ee);return ee.Sp}}ee.Sp=null;Object(h.a)(ee,"DocumentThemeChangedEvent",jd,[]);class Mi extends jd{constructor(){super()}iua(){return null}addHandler(F,V,za=null){this.oB(za,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)}removeHandler(F,
V,za=null){this.oB(za,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)}static get instance(){Mi.Sp||(Mi.Sp=new Mi);return Mi.Sp}}Mi.Sp=null;Object(h.a)(Mi,"OfficeThemeChangedEvent",jd,[]);class Nl{constructor(F){this.i6h=F}onRegisterRichApiEvent(){}onUnregisterRichApiEvent(){}sendRichApiMessageEventEntriesToControl(F,V){this.i6h.executeHandlers(F,V)}}Object(h.a)(Nl,"RichApiEventManagerHost",null,[769]);class Cg extends jd{constructor(){super();this.qNd=null}iua(F){return F}addHandler(F,
V,za=null,gb=null){this.Gd&&Ca.a(gb)?(this.qNd||(this.qNd=new Nl(this),OfficeExtension.WacRuntime.RichApi.initEventManagerHost(this.qNd)),this.wl[F]=V,this.l8a(za)):this.oB(za,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(F,V,za=null,gb=null){this.Gd&&Ca.a(gb)&&F in this.wl?(delete this.wl[F],this.l8a(za)):this.oB(za,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}executeHandlers(F,V){const za={};za[OSF.DDA.WAC.UniqueArguments.ArrayData]=V;(F=this.wl[F])&&F(za)}static get instance(){return Cg.La||
(Cg.La=new Cg)}}Cg.La=null;Object(h.a)(Cg,"RichApiMessageEvent",jd,[]);class zi extends jd{constructor(){super()}iua(F){return F}static get instance(){zi.Sp||(zi.Sp=new zi);return zi.Sp}}zi.Sp=null;Object(h.a)(zi,"SettingsChangedEvent",jd,[]);class Zh extends Xe{constructor(F,V){super(F,V)}zPk(){this.ODb={};this.set(OSF.DDA.EventDispId.dispidSettingsChangedEvent,zi.instance);this.set(OSF.DDA.EventDispId.dispidActiveViewChangedEvent,Wc.instance);this.set(OSF.DDA.EventDispId.dispidActivationStatusChangedEvent,
rd.instance);this.set(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent,ee.instance);this.set(OSF.DDA.EventDispId.dispidOfficeThemeChangedEvent,Mi.instance);this.set(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent,bh.instance);this.set(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,Fe.instance);this.set(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,tj.instance);this.set(OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent,new ak);this.set(OSF.DDA.EventDispId.dispidRichApiMessageEvent,
Cg.instance)}}Object(h.a)(Zh,"EditorEventStore",Xe,[]);class ch{constructor(F){this.Vhc=null;this.Oc=F}waj(F){this.Vhc||this.QPk();if(!F||!this.Vhc[F])return null;if(F=this.Vhc[F]())F.Gd=this.Oc;return F}set(F,V){this.Vhc[F]=V}}Object(h.a)(ch,"ApiMethodFactory",null,[]);class kk{constructor(F,V,za,gb){this.instanceId=F.toLowerCase();this.fileSize=V;this.a7d=gb;this.LDh=za}}Object(h.a)(kk,"DocumentCopy",null,[]);var Vi=d(395),kj=d(262);class Ni extends Vi.a{constructor(F,V,za,gb,Fb,Ec,$c){super();
this.OB=F.string;this.vA=V;this.Jma=za;this.Ifa=Fb;this.nqk=gb;this.Idc=Ec;this.RWa=$c;this.n_a=Object(D.a)(this,this.uDk,"onGetDocumentCopyChunkFinished");this.onError=Object(D.a)(this,this.tDk,"onGetDocumentCopyChunkError")}start(){this.Htd=!1;kj.a.v6f(this.OB,this.vA,this.Jma,this.nqk,this.Ifa,Object(D.a)(this,this.cea,"handleWebserviceResponse"),Object(D.a)(this,this.aea,"handleWebserviceError"))}uDk(F){if(F.hTa){const V={};F=F.result;V.value=F.FileData;V.errorCode=F.ErrorCode;this.Idc(this.vA,
V)}else this.handleError(F)}tDk(F){this.handleError(F)}handleError(F){this.RWa&&(F=F.error,this.RWa(this.vA,!!F&&2===F.type))}}Object(h.a)(Ni,"GetDocumentCopyChunkTask",Vi.a,[]);class ph extends Vi.a{constructor(F,V,za,gb,Fb,Ec){super();this.OB=F.string;this.vA=V;this.Jma=za;this.Ifa=gb;this.Idc=Fb;this.RWa=Ec;this.n_a=Object(D.a)(this,this.wDk,"onGetDocumentCopyFinished");this.onError=Object(D.a)(this,this.vDk,"onGetDocumentCopyError")}start(){this.Htd=!1;kj.a.Rfj(this.OB,this.vA,this.Jma,Object(D.a)(this,
this.cea,"handleWebserviceResponse"),Object(D.a)(this,this.aea,"handleWebserviceError"))}wDk(F){if(F.hTa){const V={};F=F.result;V.fileSize=F.FileSize;V.errorCode=F.ErrorCode;V.format=this.Jma;V.sliceSize=this.Ifa;this.Idc(this.vA,V)}else this.handleError(F)}vDk(F){this.handleError(F)}handleError(F){this.RWa&&(F=F.error,this.RWa(this.vA,!!F&&2===F.type))}}Object(h.a)(ph,"GetDocumentCopyTask",Vi.a,[]);class Ck extends Vi.a{constructor(F,V,za,gb,Fb,Ec,$c){super();this.OB=F.string;this.vA=V;this.Jma=
za;this.dkk=gb;this.ckk=Fb;this.Idc=Ec;this.RWa=$c;this.n_a=Object(D.a)(this,this.CGk,"onReleaseDocumentCopyFinished");this.onError=Object(D.a)(this,this.BGk,"onReleaseDocumentCopyError")}start(){this.Htd=!1;kj.a.Rqc(this.OB,this.vA,this.Jma,this.dkk,this.ckk,Object(D.a)(this,this.cea,"handleWebserviceResponse"),Object(D.a)(this,this.aea,"handleWebserviceError"))}CGk(F){if(F.hTa){const V={};V.errorCode=F.result.ErrorCode;this.Idc(this.vA,V)}else this.handleError(F)}BGk(F){this.handleError(F)}handleError(F){this.RWa&&
(F=F.error,this.RWa(this.vA,!!F&&2===F.type))}}Object(h.a)(Ck,"ReleaseGetDocumentCopyTask",Vi.a,[]);class Rj{constructor(){this.Ded=null}start(){this.Ded.start()}static pLi(F,V,za,gb,Fb,Ec){const $c=new Rj;$c.Ded=new ph(F,V,za,gb,Fb,Ec);return $c}static oLi(F,V,za,gb,Fb,Ec,$c){const Ed=new Rj;Ed.Ded=new Ni(F,V,za,gb,Fb,Ec,$c);return Ed}static SPf(F,V,za,gb,Fb,Ec,$c){const Ed=new Rj;Ed.Ded=new Ck(F,V,za,gb,Fb,Ec,$c);return Ed}}Object(h.a)(Rj,"AppForOfficeTask",null,[]);class Jk{constructor(){this.pve=
1;this.jgf=new wb.a}get qEa(){return this.jgf}vvi(F,V,za,gb){const Fb=this.w9f();F=new kk(F,V,za,gb);this.qEa.$(Fb.toString(),F);return Fb}Ang(F,V){for(let za of this.qEa){const gb=za.value;if(gb.instanceId===F.toLowerCase()&&gb.a7d===V)return!0}return!1}y4f(F){return this.qEa.ga(F.toString())}x5k(F){this.qEa.remove(F.toString())}Rqc(F,V,za,gb){(gb&&this.y5k(V)||za&&this.q5k())&&Rj.SPf(F,V,4,za,gb,()=>{},()=>{}).start()}q5k(){let F=!1;0<this.qEa.count&&(this.jgf=new wb.a,F=!0);return F}y5k(F){if(!F)return!1;
const V=[];for(let za of this.qEa)za.value.instanceId===F.toLowerCase()&&V.push(za.key);for(F=0;F<V.length;F++)this.qEa.remove(V[F]);return 0<V.length}w9f(){return this.pve++}}Object(h.a)(Jk,"GetDocumentCopyHelper",null,[668]);class hk{constructor(F,V){this.ODg=V.length;this.Ifa=F;this.mqk=Math.ceil(this.ODg/F);this.oIi(V)}oIi(F){for(let V=0;V<this.mqk;V++){const za=V*this.Ifa;F.slice(za,Math.min(za+this.Ifa,this.ODg))}}}Object(h.a)(hk,"DocumentCopyCache",null,[]);class Bl{constructor(){this.TDe=
this.pEe=null;this.UDe=this.qEe=0}add(F,V,za,gb){4===V?(this.qEe=F,this.pEe=new hk(za,gb)):3===V&&(this.UDe=F,this.TDe=new hk(za,gb))}remove(F){this.qEe===F?(this.qEe=0,this.pEe=null):this.UDe===F&&(this.UDe=0,this.TDe=null)}contains(F){return 4===F&&!!this.pEe||3===F&&!!this.TDe}}Object(h.a)(Bl,"PerAppCache",null,[]);class ie{get cache(){return ie.ui}get b7d(){return ie.hhk}Ang(F,V){return F in this.cache&&this.cache[F].contains(V)}v6f(){}Rqc(F){if(F.toString()in this.b7d){const V=this.b7d[F.toString()];
delete this.b7d[F.toString()];this.cache[V].remove(F)}}w9f(){return ie.pve++}}ie.ui={};ie.hhk={};ie.pve=1;Object(h.a)(ie,"GetFileApiProxy",null,[801]);class df{constructor(F,V,za){this.xh=0;this.controlId=this.fBa=this.ME=this.YCb=this.Oc=this.Ko=null;this.parameters=F;this.callback=V;this.hji=za;new ie;this.Adb=new Lb;this.HXa=new Jk}get SJc(){this.Adb||(this.Adb=new Lb);return this.Adb}get Pda(){return this.HXa}get Cel(){this.ME||(this.ME=fc.a.instance.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"));
return this.ME}get pJj(){return this.fBa||(this.fBa=fc.a.instance.Ia("Postmessage.IHostPostmessenger"))}get errorCode(){return this.xh}set errorCode(F){this.xh=F}get result(){return this.Ko}set result(F){this.Ko=F}get Yt(){return this.YCb}get Gd(){return this.Oc}set Gd(F){(this.Oc=F)?(this.YCb=this.Oc.Yt,this.HXa=this.Oc.Pda):this.HXa=this.YCb=null}go(){this.Ko={};try{this.jr()}catch(F){this.gak(F)}this.XH()}gak(F){this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;Le.a.J(18396573,802,10,
"Error when executing API: {0}",F.toString())}XH(){this.xh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&Le.a.J(18985232,802,10,"Error when API method failed. m_errorCode = {0}",this.xh);this.Ko[li.c_Error]=this.xh;this.callback(this.Ko)}p9d(){return this.controlId?this.Gd?this.Gd.Q_.QW(this.controlId):null:null}Daj(){if(!this.controlId)return null;let F=null;this.Gd&&(F=this.Gd.Q_.QW(this.controlId));return F?0===F.iy?this.Gd.V_f(F.shape.slideId,F.shape.id):1===F.iy?this.Gd.sEa(F.jp.id):null:
null}Fde(F){return F?this.Gd?this.Gd.Fde(F):null:null}}Object(h.a)(df,"ApiMethod",null,[]);class uj extends df{constructor(){super()}jr(){OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(this.parameters[O.a.Wii][O.a.Vii],this.parameters);this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}get description(){return"Run AddinCommandsRuntimeManager InvocationCompleted."}}Object(h.a)(uj,"AppCommandInvocationCompletedMethod",df,[]);class Xl extends df{constructor(){super()}go(){this.Ko={};this.jr()}jr(){if(this.Yt)try{const F=
this.parameters[OSF.DDA.Marshaling.CreateDocument.Base64].toString();F&&F.length>this.Gd.wUd.rd.pptEditorAppsForOfficeCreateDocumentApiMaxAllowedBase64?(r.ULS.sendTraceTag(587747342,802,15,"Too large base64 stream size:{0}",F.length),this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam,this.XH()):this.Yt.$8a(F,Object(D.a)(this,this.LKi,"createDocumentSuccessCallback"),Object(D.a)(this,this.KKi,"createDocumentFailCallback"))}catch(F){Le.a.J(35156300,802,10,"Exception thrown at CreateDocumentMethod: "+
F.toString()),this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.XH()}else this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.XH()}LKi(F){const V=new x.StandardDialog;V.Ad=4;V.Tx(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,za=>{1===za&&window.open(F);this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;this.XH()})}KKi(F){this.xh=F?F:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.XH()}get description(){return"Create a new ppt document in the user's default folder."}}
Object(h.a)(Xl,"CreateDocumentMethod",df,[]);var Sj=d(96),bk=d(89);class Ii{static r0k(F){const V=new Map;V.set("ApiId",F.toString());Sj.Health.instance.recordKpiUsage(Ii.tth,1,Ii.nth,V)}static q0k(F,V,za){const gb=new Map;gb.set("ApiId",F.toString());F=Object.assign(new bk.a,{extendedProperties:gb,durationMs:Ii.A6f(V,za)});Sj.Health.instance.recordKpiSuccess(Ii.tth,F)}static Slh(F){const V=new Map;V.set("fWacPartition",F.toString());Sj.Health.instance.recordKpiUsage(Ii.uth,1,Ii.nth,V)}static fUe(F,
V){F=Object.assign(new bk.a,{durationMs:Ii.A6f(F,V)});Sj.Health.instance.recordKpiSuccess(Ii.uth,F)}static A6f(F,V){let za=null;F&&V&&(za=V-F);return za}}Ii.tth="PptApiCall";Ii.uth="PptApiRequest";Ii.nth="pptom";Object(h.a)(Ii,"PptWacApiTelemetry",null,[]);class Kk{constructor(){this.ver=0;this.exec=this.sel=null}}Object(h.a)(Kk,"ApiRequest",null,[]);class Ch{constructor(){this.txRn=this.shpLst=this.sldLst=null}}Object(h.a)(Ch,"SelectionData",null,[]);const fi=(F,V)=>{var za=Object,gb=za.assign,Fb=
new Kk,Ec=Object,$c=Ec.assign,Ed=new Ch,pe=F.Yt.Se();const Se=[];if(pe){Se.length=pe.length;for(var Ye=0;Ye<pe.length;Ye++)Se[Ye]=pe[Ye].Db.toString()}pe=F.Yt.Xd();Ye=[];if(pe){Ye.length=pe.length;for(let ae=0;ae<pe.length;ae++)Ye[ae]=pe[ae].get_shapeId().toString()}F=gb.call(za,Fb,{ver:1,exec:V,sel:$c.call(Ec,Ed,{sldLst:Se,shpLst:Ye,txRn:F.Yt.Zqj()})});return Sys.Serialization.JavaScriptSerializer.serialize(F)},Lk=F=>{if(z.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.PowerPointOnline.IncludeWacApiHostTypeRegister")){var V=
F.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var za=V.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);za.addParameter("shortcuts","String[]",1,null,0);V.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);za=V.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);za.addParameter("shortcuts","Object",1,null,0);V=F.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}",
"{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);za=V.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);za.addParameter("pickerCustomizationJsonString","String",1,null,0);V=F.addType("Microsoft.Office.Auth","{8f3d8395-fba3-422f-9e98-33e38d23c2ba}","{e1b105a8-d9d5-4fc8-aa4e-3d90aeb48abf}",3,2);za=V.addMethod("GetAccessTokenFirstPartyOAuth",1,"Object",1,1,"AccessTokenFirstPartyOAuth",4);za.addParameter("appName","String",1,null,0);za.addParameter("target","String",1,
null,0);V=F.addType("Microsoft.Office.AugLoopHostMessageReceivedEventArgs","{52ebe40e-6476-4f8d-81cb-89f5c90e2e76}","{891f2f5b-6598-4c8e-af9d-dc48bf34839f}",2,0);V.addProperty("Data",4,"String",1,!1,null,0);V=F.addType("Microsoft.Office.AugLoopEventService","{846cb932-2065-4d2e-b051-5d6673cca2d9}","{019765ca-6d77-447a-9bd8-b07dc47bc657}",3,2);za=V.addMethod("SendMessage",1,"Void",0,1,"SendMessage",4);za.addParameter("data","String",1,null,0);V.addMethod("_RegisterHostMessageReceivedEvent",2,"Void",
0,1,"_RegisterHostMessageReceivedEvent",4);V.addMethod("_UnregisterHostMessageReceivedEvent",3,"Void",0,1,"_UnregisterHostMessageReceivedEvent",4)}V=F.addType("Microsoft.Office.PowerPoint.Application","{549654b5-691c-491b-bed1-3eccfa85e525}","{64189aae-7617-40e1-ba92-365392bd2387}",3,0);za=V.addMethod("InsertHyperLink",1001,"Void",0,0,"InsertHyperLink",4);za.addParameter("address","String",1,null,0);za.addParameter("displayName","String",1,null,0);za=V.addMethod("InsertSlideFromContent",1002,"Microsoft.Office.PowerPoint.InsertSlideReturnCode",
1,0,"InsertSlideFromContent",4);za.addParameter("slideContent","String",1,null,0);V=F.addType("Microsoft.Office.PowerPoint.Presentation","{a8af8473-88c1-49d7-a986-565cb7100e9e}","",3,0);V.addProperty("SlideMasters",3,"Microsoft.Office.PowerPoint.SlideMasterCollection",3,!0,null,0);V.addProperty("Slides",2,"Microsoft.Office.PowerPoint.SlideCollection",3,!0,null,0);V.addProperty("Tags",4,"Microsoft.Office.PowerPoint.TagCollection",3,!0,null,0);V.addProperty("Title",1,"String",1,!0,null,0);za=V.addMethod("ApplyJOfcCommands",
10,"String",1,0,"ApplyJOfcCommands",4);za.addParameter("commandPayload","String",1,null,0);V.addMethod("GetSelectedShapes",5,"Microsoft.Office.PowerPoint.ShapeScopedCollection",3,0,"SelectedShapes",0);V.addMethod("GetSelectedSlides",6,"Microsoft.Office.PowerPoint.SlideScopedCollection",3,0,"SelectedSlides",0);V.addMethod("GetSelectedTextRange",7,"Microsoft.Office.PowerPoint.TextRange",3,0,"SelectedTextRange",0);V.addMethod("GetSelectedTextRangeOrNullObject",9,"Microsoft.Office.PowerPoint.TextRange",
3,0,"SelectedTextRangeOrNullObject",0);za=V.addMethod("InsertSlidesFromBase64",1003,"Void",0,0,"InsertSlidesFromBase64",0);za.addParameter("base64File","String",1,null,0);za.addParameter("options","Microsoft.Office.PowerPoint.InsertSlideOptions",2,null,0);za=V.addMethod("SetSelectedSlides",8,"Void",0,0,"SetSelectedSlides",0);za.addParameter("slideIds","String[]",1,null,0);za=V.addMethod("_RegisterEvent",1001,"Void",0,1,"_RegisterEvent",0);za.addParameter("referenceId","String",1,null,0);za.addParameter("eventType",
"Int32",1,null,0);za=V.addMethod("_UnregisterEvent",1002,"Void",0,1,"_UnregisterEvent",0);za.addParameter("referenceId","String",1,null,0);za.addParameter("eventType","Int32",1,null,0);V=F.addType("Microsoft.Office.PowerPoint.AddSlideOptions","{171a8d61-4952-4d67-b7e1-0197ac277d6a}","{af133e5f-ae0b-4a2b-8316-7b26d0a6b4f6}",2,0);V.addProperty("LayoutId",1,"String",1,!1,null,0);V.addProperty("SlideMasterId",2,"String",1,!1,null,0);V=F.addType("Microsoft.Office.PowerPoint.BulletFormat","{43bd46c0-809f-4417-b22c-84e44ab6e592}",
"",3,0);V.addProperty("Visible",2,"Boolean",1,!1,null,0);V.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);V=F.addEnumType("Microsoft.Office.PowerPoint.ConnectorType");V.addEnumField("Straight",0);V.addEnumField("Elbow",1);V.addEnumField("Curve",2);V=F.addEnumType("Microsoft.Office.PowerPoint.GeometricShapeType");V.addEnumField("LineInverse",0);V.addEnumField("Triangle",1);V.addEnumField("RightTriangle",2);V.addEnumField("Rectangle",3);V.addEnumField("Diamond",4);V.addEnumField("Parallelogram",
5);V.addEnumField("Trapezoid",6);V.addEnumField("NonIsoscelesTrapezoid",7);V.addEnumField("Pentagon",8);V.addEnumField("Hexagon",9);V.addEnumField("Heptagon",10);V.addEnumField("Octagon",11);V.addEnumField("Decagon",12);V.addEnumField("Dodecagon",13);V.addEnumField("Star4",14);V.addEnumField("Star5",15);V.addEnumField("Star6",16);V.addEnumField("Star7",17);V.addEnumField("Star8",18);V.addEnumField("Star10",19);V.addEnumField("Star12",20);V.addEnumField("Star16",21);V.addEnumField("Star24",22);V.addEnumField("Star32",
23);V.addEnumField("RoundRectangle",24);V.addEnumField("Round1Rectangle",25);V.addEnumField("Round2SameRectangle",26);V.addEnumField("Round2DiagonalRectangle",27);V.addEnumField("SnipRoundRectangle",28);V.addEnumField("Snip1Rectangle",29);V.addEnumField("Snip2SameRectangle",30);V.addEnumField("Snip2DiagonalRectangle",31);V.addEnumField("Plaque",32);V.addEnumField("Ellipse",33);V.addEnumField("Teardrop",34);V.addEnumField("HomePlate",35);V.addEnumField("Chevron",36);V.addEnumField("PieWedge",37);V.addEnumField("Pie",
38);V.addEnumField("BlockArc",39);V.addEnumField("Donut",40);V.addEnumField("NoSmoking",41);V.addEnumField("RightArrow",42);V.addEnumField("LeftArrow",43);V.addEnumField("UpArrow",44);V.addEnumField("DownArrow",45);V.addEnumField("StripedRightArrow",46);V.addEnumField("NotchedRightArrow",47);V.addEnumField("BentUpArrow",48);V.addEnumField("LeftRightArrow",49);V.addEnumField("UpDownArrow",50);V.addEnumField("LeftUpArrow",51);V.addEnumField("LeftRightUpArrow",52);V.addEnumField("QuadArrow",53);V.addEnumField("LeftArrowCallout",
54);V.addEnumField("RightArrowCallout",55);V.addEnumField("UpArrowCallout",56);V.addEnumField("DownArrowCallout",57);V.addEnumField("LeftRightArrowCallout",58);V.addEnumField("UpDownArrowCallout",59);V.addEnumField("QuadArrowCallout",60);V.addEnumField("BentArrow",61);V.addEnumField("UturnArrow",62);V.addEnumField("CircularArrow",63);V.addEnumField("LeftCircularArrow",64);V.addEnumField("LeftRightCircularArrow",65);V.addEnumField("CurvedRightArrow",66);V.addEnumField("CurvedLeftArrow",67);V.addEnumField("CurvedUpArrow",
68);V.addEnumField("CurvedDownArrow",69);V.addEnumField("SwooshArrow",70);V.addEnumField("Cube",71);V.addEnumField("Can",72);V.addEnumField("LightningBolt",73);V.addEnumField("Heart",74);V.addEnumField("Sun",75);V.addEnumField("Moon",76);V.addEnumField("SmileyFace",77);V.addEnumField("IrregularSeal1",78);V.addEnumField("IrregularSeal2",79);V.addEnumField("FoldedCorner",80);V.addEnumField("Bevel",81);V.addEnumField("Frame",82);V.addEnumField("HalfFrame",83);V.addEnumField("Corner",84);V.addEnumField("DiagonalStripe",
85);V.addEnumField("Chord",86);V.addEnumField("Arc",87);V.addEnumField("LeftBracket",88);V.addEnumField("RightBracket",89);V.addEnumField("LeftBrace",90);V.addEnumField("RightBrace",91);V.addEnumField("BracketPair",92);V.addEnumField("BracePair",93);V.addEnumField("Callout1",94);V.addEnumField("Callout2",95);V.addEnumField("Callout3",96);V.addEnumField("AccentCallout1",97);V.addEnumField("AccentCallout2",98);V.addEnumField("AccentCallout3",99);V.addEnumField("BorderCallout1",100);V.addEnumField("BorderCallout2",
101);V.addEnumField("BorderCallout3",102);V.addEnumField("AccentBorderCallout1",103);V.addEnumField("AccentBorderCallout2",104);V.addEnumField("AccentBorderCallout3",105);V.addEnumField("WedgeRectCallout",106);V.addEnumField("WedgeRRectCallout",107);V.addEnumField("WedgeEllipseCallout",108);V.addEnumField("CloudCallout",109);V.addEnumField("Cloud",110);V.addEnumField("Ribbon",111);V.addEnumField("Ribbon2",112);V.addEnumField("EllipseRibbon",113);V.addEnumField("EllipseRibbon2",114);V.addEnumField("LeftRightRibbon",
115);V.addEnumField("VerticalScroll",116);V.addEnumField("HorizontalScroll",117);V.addEnumField("Wave",118);V.addEnumField("DoubleWave",119);V.addEnumField("Plus",120);V.addEnumField("FlowChartProcess",121);V.addEnumField("FlowChartDecision",122);V.addEnumField("FlowChartInputOutput",123);V.addEnumField("FlowChartPredefinedProcess",124);V.addEnumField("FlowChartInternalStorage",125);V.addEnumField("FlowChartDocument",126);V.addEnumField("FlowChartMultidocument",127);V.addEnumField("FlowChartTerminator",
128);V.addEnumField("FlowChartPreparation",129);V.addEnumField("FlowChartManualInput",130);V.addEnumField("FlowChartManualOperation",131);V.addEnumField("FlowChartConnector",132);V.addEnumField("FlowChartPunchedCard",133);V.addEnumField("FlowChartPunchedTape",134);V.addEnumField("FlowChartSummingJunction",135);V.addEnumField("FlowChartOr",136);V.addEnumField("FlowChartCollate",137);V.addEnumField("FlowChartSort",138);V.addEnumField("FlowChartExtract",139);V.addEnumField("FlowChartMerge",140);V.addEnumField("FlowChartOfflineStorage",
141);V.addEnumField("FlowChartOnlineStorage",142);V.addEnumField("FlowChartMagneticTape",143);V.addEnumField("FlowChartMagneticDisk",144);V.addEnumField("FlowChartMagneticDrum",145);V.addEnumField("FlowChartDisplay",146);V.addEnumField("FlowChartDelay",147);V.addEnumField("FlowChartAlternateProcess",148);V.addEnumField("FlowChartOffpageConnector",149);V.addEnumField("ActionButtonBlank",150);V.addEnumField("ActionButtonHome",151);V.addEnumField("ActionButtonHelp",152);V.addEnumField("ActionButtonInformation",
153);V.addEnumField("ActionButtonForwardNext",154);V.addEnumField("ActionButtonBackPrevious",155);V.addEnumField("ActionButtonEnd",156);V.addEnumField("ActionButtonBeginning",157);V.addEnumField("ActionButtonReturn",158);V.addEnumField("ActionButtonDocument",159);V.addEnumField("ActionButtonSound",160);V.addEnumField("ActionButtonMovie",161);V.addEnumField("Gear6",162);V.addEnumField("Gear9",163);V.addEnumField("Funnel",164);V.addEnumField("MathPlus",165);V.addEnumField("MathMinus",166);V.addEnumField("MathMultiply",
167);V.addEnumField("MathDivide",168);V.addEnumField("MathEqual",169);V.addEnumField("MathNotEqual",170);V.addEnumField("CornerTabs",171);V.addEnumField("SquareTabs",172);V.addEnumField("PlaqueTabs",173);V.addEnumField("ChartX",174);V.addEnumField("ChartStar",175);V.addEnumField("ChartPlus",176);V=F.addEnumType("Microsoft.Office.PowerPoint.InsertSlideFormatting");V.addEnumField("KeepSourceFormatting",0);V.addEnumField("UseDestinationTheme",1);V=F.addType("Microsoft.Office.PowerPoint.InsertSlideOptions",
"{9ca3e504-5701-467b-9596-15521056bac3}","{806c3519-08f4-41ba-b0d9-3c323c51c3e9}",2,0);V.addProperty("Formatting",1,"Microsoft.Office.PowerPoint.InsertSlideFormatting",1,!1,null,0);V.addProperty("SourceSlideIds",4,"String[]",1,!1,null,0);V.addProperty("TargetSlideId",5,"String",1,!1,null,0);V=F.addEnumType("Microsoft.Office.PowerPoint.ParagraphHorizontalAlignment");V.addEnumField("Left",0);V.addEnumField("Center",1);V.addEnumField("Right",2);V.addEnumField("Justify",3);V.addEnumField("JustifyLow",
4);V.addEnumField("Distributed",5);V.addEnumField("ThaiDistributed",6);V=F.addType("Microsoft.Office.PowerPoint.ParagraphFormat","{c164d05d-7a4f-409f-8a5e-ef5f1d2ffa54}","",3,0);V.addProperty("BulletFormat",1,"Microsoft.Office.PowerPoint.BulletFormat",3,!0,null,0);V.addProperty("HorizontalAlignment",2,"Microsoft.Office.PowerPoint.ParagraphHorizontalAlignment",1,!1,null,0);V.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);V=F.addType("Microsoft.Office.PowerPoint.ShapeAddOptions","{b75ad347-9abe-4531-a338-3ba7a70bf9e1}",
"{2b45cbde-9fbf-4aa2-9972-5508e4c99ad8}",2,0);V.addProperty("Height",1,"Double",1,!1,null,0);V.addProperty("Left",2,"Double",1,!1,null,0);V.addProperty("Top",3,"Double",1,!1,null,0);V.addProperty("Width",4,"Double",1,!1,null,0);V=F.addType("Microsoft.Office.PowerPoint.ShapeCollection","{27a07ec1-bcc6-45bf-9c60-07250facfbca}","",3,0);za=V.addMethod("AddGeometricShape",6,"Microsoft.Office.PowerPoint.Shape",3,0,"AddGeometricShape",0);za.addParameter("geometricShapeType","Microsoft.Office.PowerPoint.GeometricShapeType",
1,null,0);za.addParameter("options","Microsoft.Office.PowerPoint.ShapeAddOptions",2,null,0);za=V.addMethod("AddLine",7,"Microsoft.Office.PowerPoint.Shape",3,0,"AddLine",0);za.addParameter("connectorType","Microsoft.Office.PowerPoint.ConnectorType",1,null,0);za.addParameter("options","Microsoft.Office.PowerPoint.ShapeAddOptions",2,null,0);za=V.addMethod("AddTextBox",8,"Microsoft.Office.PowerPoint.Shape",3,0,"AddTextBox",0);za.addParameter("text","String",1,null,0);za.addParameter("options","Microsoft.Office.PowerPoint.ShapeAddOptions",
2,null,0);V.addMethod("GetCount",1,"Int32",1,1,"Count",0);za=V.addIndexerMethod(2,"Microsoft.Office.PowerPoint.Shape",3,0);za.addParameter("key","String",1,null,0);za=V.addMethod("GetItemAt",5,"Microsoft.Office.PowerPoint.Shape",3,1,"ItemAt",0);za.addParameter("index","Int32",1,null,0);za=V.addMethod("GetItemOrNullObject",3,"Microsoft.Office.PowerPoint.Shape",3,0,"ItemOrNullObject",0);za.addParameter("id","String",1,null,0);V.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);V.setCollectionInfo("Microsoft.Office.PowerPoint.Shape",
!0);V=F.addType("Microsoft.Office.PowerPoint.SlideLayout","{4494143a-d362-45fd-89c6-506e97741384}","",3,0);V.addProperty("Id",1,"String",1,!0,null,0);V.addProperty("Name",3,"String",1,!0,null,0);V.addProperty("Shapes",4,"Microsoft.Office.PowerPoint.ShapeCollection",3,!0,null,0);V.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);V=F.addType("Microsoft.Office.PowerPoint.SlideLayoutCollection","{8f09fea3-67af-49f9-b42a-0a8f8cd02615}","",3,0);V.addMethod("GetCount",1,"Int32",1,1,"Count",0);za=V.addIndexerMethod(2,
"Microsoft.Office.PowerPoint.SlideLayout",3,0);za.addParameter("key","String",1,null,0);za=V.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.SlideLayout",3,1,"ItemAt",0);za.addParameter("index","Int32",1,null,0);za=V.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.SlideLayout",3,0,"ItemOrNullObject",0);za.addParameter("id","String",1,null,0);V.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);V.setCollectionInfo("Microsoft.Office.PowerPoint.SlideLayout",!0);V=F.addType("Microsoft.Office.PowerPoint.SlideMaster",
"{4a835b29-4422-4659-ab73-2e1e0096e7c1}","",3,0);V.addProperty("Id",1,"String",1,!0,null,0);V.addProperty("Layouts",3,"Microsoft.Office.PowerPoint.SlideLayoutCollection",3,!0,null,0);V.addProperty("Name",4,"String",1,!0,null,0);V.addProperty("Shapes",5,"Microsoft.Office.PowerPoint.ShapeCollection",3,!0,null,0);V.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);V=F.addType("Microsoft.Office.PowerPoint.Tag","{f26bc228-f6da-40de-b9ef-2a57ad2b5162}","",3,0);V.addProperty("Key",2,"String",1,!0,null,0);
V.addProperty("Value",3,"String",1,!1,null,0);V.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);V=F.addType("Microsoft.Office.PowerPoint.TagCollection","{edf01799-a99c-4e57-94f2-5830600f5da4}","",3,0);za=V.addMethod("Add",1,"Void",0,0,"Add",0);za.addParameter("key","String",1,null,0);za.addParameter("value","String",1,null,0);za=V.addMethod("Delete",2,"Void",0,0,"Delete",0);za.addParameter("key","String",1,null,0);V.addMethod("GetCount",3,"Int32",1,1,"Count",0);za=V.addIndexerMethod(4,"Microsoft.Office.PowerPoint.Tag",
3,0);za.addParameter("key","String",1,null,0);za=V.addMethod("GetItemAt",5,"Microsoft.Office.PowerPoint.Tag",3,1,"ItemAt",0);za.addParameter("index","Int32",1,null,0);za=V.addMethod("GetItemOrNullObject",6,"Microsoft.Office.PowerPoint.Tag",3,0,"ItemOrNullObject",0);za.addParameter("key","String",1,null,0);V.addMethod("_OnAccess",7,"Void",0,1,"_OnAccess",0);V.setCollectionInfo("Microsoft.Office.PowerPoint.Tag",!0);V=F.addType("Microsoft.Office.PowerPoint.Slide","{61c859a3-9c46-44a7-a415-aeb6f43a1dc7}",
"",3,0);V.addProperty("Id",1,"String",1,!0,null,0);V.addProperty("Layout",5,"Microsoft.Office.PowerPoint.SlideLayout",3,!0,null,0);V.addProperty("Shapes",4,"Microsoft.Office.PowerPoint.ShapeCollection",3,!0,null,0);V.addProperty("SlideMaster",6,"Microsoft.Office.PowerPoint.SlideMaster",3,!0,null,0);V.addProperty("Tags",7,"Microsoft.Office.PowerPoint.TagCollection",3,!0,null,0);V.addMethod("Delete",3,"Void",0,0,"Delete",0);za=V.addMethod("SetSelectedShapes",8,"Void",0,0,"SetSelectedShapes",0);za.addParameter("shapeIds",
"String[]",1,null,0);V.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);V=F.addEnumType("Microsoft.Office.PowerPoint.ShapeFillType");V.addEnumField("NoFill",0);V.addEnumField("Solid",1);V.addEnumField("Gradient",2);V.addEnumField("Pattern",3);V.addEnumField("PictureAndTexture",4);V.addEnumField("SlideBackground",5);V=F.addType("Microsoft.Office.PowerPoint.ShapeFill","{2df31ab1-fa27-4e46-9704-1fb3f49bed4b}","",3,0);V.addProperty("ForegroundColor",2,"String",1,!1,null,0);V.addProperty("Transparency",
5,"Double",1,!1,null,0);V.addProperty("Type",6,"Microsoft.Office.PowerPoint.ShapeFillType",1,!0,null,0);V.addMethod("Clear",1,"Void",0,0,"Clear",0);za=V.addMethod("SetSolidColor",4,"Void",0,0,"SetSolidColor",0);za.addParameter("color","String",1,null,0);V.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);V=F.addEnumType("Microsoft.Office.PowerPoint.ShapeLineStyle");V.addEnumField("Single",0);V.addEnumField("ThickBetweenThin",1);V.addEnumField("ThickThin",2);V.addEnumField("ThinThick",3);V.addEnumField("ThinThin",
4);V=F.addEnumType("Microsoft.Office.PowerPoint.ShapeLineDashStyle");V.addEnumField("Dash",0);V.addEnumField("DashDot",1);V.addEnumField("DashDotDot",2);V.addEnumField("LongDash",3);V.addEnumField("LongDashDot",4);V.addEnumField("RoundDot",5);V.addEnumField("Solid",6);V.addEnumField("SquareDot",7);V.addEnumField("LongDashDotDot",8);V.addEnumField("SystemDash",9);V.addEnumField("SystemDot",10);V.addEnumField("SystemDashDot",11);V=F.addType("Microsoft.Office.PowerPoint.ShapeLineFormat","{f275eab8-4363-41e8-b11a-e41e3c725f21}",
"",3,0);V.addProperty("Color",1,"String",1,!1,null,0);V.addProperty("DashStyle",2,"Microsoft.Office.PowerPoint.ShapeLineDashStyle",1,!1,null,0);V.addProperty("Style",4,"Microsoft.Office.PowerPoint.ShapeLineStyle",1,!1,null,0);V.addProperty("Transparency",5,"Double",1,!1,null,0);V.addProperty("Visible",6,"Boolean",1,!1,null,0);V.addProperty("Weight",7,"Double",1,!1,null,0);V.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);V=F.addEnumType("Microsoft.Office.PowerPoint.ShapeType");V.addEnumField("Unsupported",
0);V.addEnumField("Image",1);V.addEnumField("GeometricShape",2);V.addEnumField("Group",3);V.addEnumField("Line",4);V=F.addEnumType("Microsoft.Office.PowerPoint.ShapeAutoSize");V.addEnumField("AutoSizeNone",0);V.addEnumField("AutoSizeTextToFitShape",1);V.addEnumField("AutoSizeShapeToFitText",2);V.addEnumField("AutoSizeMixed",3);V=F.addEnumType("Microsoft.Office.PowerPoint.TextVerticalAlignment");V.addEnumField("Top",0);V.addEnumField("Middle",1);V.addEnumField("Bottom",2);V.addEnumField("TopCentered",
3);V.addEnumField("MiddleCentered",4);V.addEnumField("BottomCentered",5);V=F.addEnumType("Microsoft.Office.PowerPoint.ShapeFontUnderlineStyle");V.addEnumField("None",0);V.addEnumField("Single",1);V.addEnumField("Double",2);V.addEnumField("Heavy",3);V.addEnumField("Dotted",4);V.addEnumField("DottedHeavy",5);V.addEnumField("Dash",6);V.addEnumField("DashHeavy",7);V.addEnumField("DashLong",8);V.addEnumField("DashLongHeavy",9);V.addEnumField("DotDash",10);V.addEnumField("DotDashHeavy",11);V.addEnumField("DotDotDash",
12);V.addEnumField("DotDotDashHeavy",13);V.addEnumField("Wavy",14);V.addEnumField("WavyHeavy",15);V.addEnumField("WavyDouble",16);V=F.addType("Microsoft.Office.PowerPoint.ShapeFont","{06c9e9fa-f317-4016-b9f4-aea94e9690f4}","",3,0);V.addProperty("Bold",1,"Boolean",1,!1,null,0);V.addProperty("Color",2,"String",1,!1,null,0);V.addProperty("Italic",3,"Boolean",1,!1,null,0);V.addProperty("Name",5,"String",1,!1,null,0);V.addProperty("Size",6,"Double",1,!1,null,0);V.addProperty("Underline",7,"Microsoft.Office.PowerPoint.ShapeFontUnderlineStyle",
1,!1,null,0);V.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);V=F.addType("Microsoft.Office.PowerPoint.TextRange","{1eb59e56-2d48-4b16-b3bb-4fe7debe51c2}","",3,0);V.addProperty("Font",1,"Microsoft.Office.PowerPoint.ShapeFont",3,!0,null,0);V.addProperty("Length",7,"Int32",1,!1,null,0);V.addProperty("ParagraphFormat",4,"Microsoft.Office.PowerPoint.ParagraphFormat",3,!0,null,0);V.addProperty("Start",9,"Int32",1,!1,null,0);V.addProperty("Text",5,"String",1,!1,null,0);V.addMethod("GetParentTextFrame",
10,"Microsoft.Office.PowerPoint.TextFrame",3,0,"ParentTextFrame",0);za=V.addMethod("GetSubstring",2,"Microsoft.Office.PowerPoint.TextRange",3,0,"Substring",0);za.addParameter("start","Int32",1,null,0);za.addParameter("length","Int32",1,null,0);V.addMethod("SetSelected",8,"Void",0,0,"SetSelected",0);V.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);V=F.addType("Microsoft.Office.PowerPoint.TextFrame","{b5929948-a2b9-4816-8e79-fe9deef82e48}","",3,0);V.addProperty("AutoSizeSetting",1,"Microsoft.Office.PowerPoint.ShapeAutoSize",
1,!1,null,0);V.addProperty("BottomMargin",2,"Double",1,!1,null,0);V.addProperty("HasText",4,"Boolean",1,!0,null,0);V.addProperty("LeftMargin",6,"Double",1,!1,null,0);V.addProperty("RightMargin",7,"Double",1,!1,null,0);V.addProperty("TextRange",8,"Microsoft.Office.PowerPoint.TextRange",3,!0,null,0);V.addProperty("TopMargin",9,"Double",1,!1,null,0);V.addProperty("VerticalAlignment",10,"Microsoft.Office.PowerPoint.TextVerticalAlignment",1,!1,null,0);V.addProperty("WordWrap",11,"Boolean",1,!1,null,0);
V.addMethod("DeleteText",3,"Void",0,0,"DeleteText",0);V.addMethod("GetParentShape",13,"Microsoft.Office.PowerPoint.Shape",3,0,"ParentShape",0);V.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);V=F.addType("Microsoft.Office.PowerPoint.Shape","{62ed0f8f-a9ce-46bd-8ad2-61634aee155d}","",3,0);V.addProperty("Fill",11,"Microsoft.Office.PowerPoint.ShapeFill",3,!0,null,0);V.addProperty("Height",5,"Double",1,!1,null,0);V.addProperty("Id",1,"String",1,!0,null,0);V.addProperty("Left",6,"Double",1,!1,null,
0);V.addProperty("LineFormat",12,"Microsoft.Office.PowerPoint.ShapeLineFormat",3,!0,null,0);V.addProperty("Name",7,"String",1,!1,null,0);V.addProperty("Tags",3,"Microsoft.Office.PowerPoint.TagCollection",3,!0,null,0);V.addProperty("TextFrame",13,"Microsoft.Office.PowerPoint.TextFrame",3,!0,null,0);V.addProperty("Top",8,"Double",1,!1,null,0);V.addProperty("Type",9,"Microsoft.Office.PowerPoint.ShapeType",1,!0,null,0);V.addProperty("Width",10,"Double",1,!1,null,0);V.addMethod("Delete",4,"Void",0,0,"Delete",
0);V.addMethod("GetParentSlide",15,"Microsoft.Office.PowerPoint.Slide",3,0,"ParentSlide",0);V.addMethod("GetParentSlideLayout",16,"Microsoft.Office.PowerPoint.SlideLayout",3,0,"ParentSlideLayout",0);V.addMethod("GetParentSlideLayoutOrNullObject",18,"Microsoft.Office.PowerPoint.SlideLayout",3,0,"ParentSlideLayoutOrNullObject",0);V.addMethod("GetParentSlideMaster",17,"Microsoft.Office.PowerPoint.SlideMaster",3,0,"ParentSlideMaster",0);V.addMethod("GetParentSlideMasterOrNullObject",19,"Microsoft.Office.PowerPoint.SlideMaster",
3,0,"ParentSlideMasterOrNullObject",0);V.addMethod("GetParentSlideOrNullObject",20,"Microsoft.Office.PowerPoint.Slide",3,0,"ParentSlideOrNullObject",0);V.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);V=F.addType("Microsoft.Office.PowerPoint.ShapeScopedCollection","{607dbfd7-bd79-4651-b5ff-3a66bc46be74}","",3,0);V.addMethod("GetCount",1,"Int32",1,1,"Count",0);za=V.addIndexerMethod(2,"Microsoft.Office.PowerPoint.Shape",3,0);za.addParameter("key","String",1,null,0);za=V.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.Shape",
3,1,"ItemAt",0);za.addParameter("index","Int32",1,null,0);za=V.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.Shape",3,0,"ItemOrNullObject",0);za.addParameter("id","String",1,null,0);V.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);V.setCollectionInfo("Microsoft.Office.PowerPoint.Shape",!0);V=F.addType("Microsoft.Office.PowerPoint.SlideCollection","{450b9577-a7dd-4d69-8dc9-afa8fba58465}","",3,0);za=V.addMethod("Add",6,"Void",0,0,"Add",0);za.addParameter("options","Microsoft.Office.PowerPoint.AddSlideOptions",
2,null,0);V.addMethod("GetCount",1,"Int32",1,1,"Count",0);za=V.addIndexerMethod(5,"Microsoft.Office.PowerPoint.Slide",3,0);za.addParameter("key","String",1,null,0);za=V.addMethod("GetItemAt",2,"Microsoft.Office.PowerPoint.Slide",3,1,"ItemAt",0);za.addParameter("index","Int32",1,null,0);za=V.addMethod("GetItemOrNullObject",3,"Microsoft.Office.PowerPoint.Slide",3,0,"ItemOrNullObject",0);za.addParameter("id","String",1,null,0);V.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);V.setCollectionInfo("Microsoft.Office.PowerPoint.Slide",
!0);V=F.addType("Microsoft.Office.PowerPoint.SlideScopedCollection","{574045cb-b56d-4fca-89e5-b567250b9ce5}","",3,0);V.addMethod("GetCount",1,"Int32",1,1,"Count",0);za=V.addIndexerMethod(2,"Microsoft.Office.PowerPoint.Slide",3,0);za.addParameter("key","String",1,null,0);za=V.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.Slide",3,1,"ItemAt",0);za.addParameter("index","Int32",1,null,0);za=V.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.Slide",3,0,"ItemOrNullObject",0);za.addParameter("id",
"String",1,null,0);V.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);V.setCollectionInfo("Microsoft.Office.PowerPoint.Slide",!0);V=F.addType("Microsoft.Office.PowerPoint.SlideMasterCollection","{d5e75669-5fac-49ec-aaad-e1f6181f6fbd}","",3,0);V.addMethod("GetCount",1,"Int32",1,1,"Count",0);za=V.addIndexerMethod(2,"Microsoft.Office.PowerPoint.SlideMaster",3,0);za.addParameter("key","String",1,null,0);za=V.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.SlideMaster",3,1,"ItemAt",0);za.addParameter("index",
"Int32",1,null,0);za=V.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.SlideMaster",3,0,"ItemOrNullObject",0);za.addParameter("id","String",1,null,0);V.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);V.setCollectionInfo("Microsoft.Office.PowerPoint.SlideMaster",!0);V=F.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);V.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,
"AppRuntimeState",0);za=V.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);za.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);V=F.addEnumType("Microsoft.AppRuntime.AppRuntimeState");V.addEnumField("Inactive",0);V.addEnumField("Background",1);V.addEnumField("Visible",2);V=F.addEnumType("Microsoft.AppRuntime.Visibility");V.addEnumField("Hidden",1);V.addEnumField("Visible",2);V=F.addType("Microsoft.AppRuntime.AppRuntimePersistenceService","{e8c34c73-c596-41e3-8943-dd7dd03839c7}",
"{7b93e367-9ccc-4d0e-8d75-79387538164b}",3,0);V.addMethod("GetAppRuntimeStartState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeStartState",0);za=V.addMethod("SetAppRuntimeStartState",1,"Void",0,0,"SetAppRuntimeStartState",0);za.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);V=F.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");V.addEnumField("Unknown",0);V.addEnumField("Basic",1);V.addEnumField("Premium",2);V=F.addType("Microsoft.Office.Licensing.License",
"{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);za=V.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);za.addParameter("feature","String",1,null,0);za.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);za=V.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0);za.addParameter("feature","String",1,null,0);za=V.addMethod("GetMsaDeviceTicket",
7,"String",1,1,"MsaDeviceTicket",4);za.addParameter("resource","String",1,null,0);za.addParameter("policy","String",1,null,0);za.addParameter("options","Microsoft.Office.Licensing.MsaDeviceTicketOptions",3,null,0);za=V.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);za.addParameter("feature","String",1,null,0);za.addParameter("fallbackValue","Boolean",1,null,0);V.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);za=V.addMethod("LaunchUpsellExperience",
4,"Void",0,1,"LaunchUpsellExperience",0);za.addParameter("experienceId","String",1,null,0);za=V.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);za.addParameter("feature","String",1,null,0);V=F.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);V.addProperty("Id",5,"String",1,!0,null,0);V.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);V.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",
0);V=F.addType("Microsoft.Office.Licensing.MsaDeviceTicketOptions","{b20df140-2e7a-4b77-bb33-14fa3f7871aa}","{fdd1b6d0-e5d9-4e98-bdbd-bdcf387c7835}",3,0);V.addProperty("Scopes",1,"String",1,!1,null,0);V=F.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);V.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);za=V.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",
0);za.addParameter("jsonCreate","String",1,null,0);za=V.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);za.addParameter("jsonUpdate","String",1,null,0);za=V.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);za.addParameter("id","String",1,null,0);za=V.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);za.addParameter("id","String",1,null,0);V.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);V=F.addType("Microsoft.DynamicRibbon.RibbonTab",
"{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);V.addProperty("Id",2,"String",1,!0,null,0);za=V.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);za.addParameter("visibility","Boolean",1,null,0);V.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);V=F.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);V.addProperty("Enabled",3,"Boolean",1,!1,null,0);V.addProperty("Id",2,"String",1,!0,null,0);V.addProperty("Label",4,"String",1,!0,null,0);za=V.addMethod("SetEnabled",
5,"Void",0,0,"SetEnabled",0);za.addParameter("enabled","Boolean",1,null,0);V.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);V=F.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);V.addMethod("GetCount",3,"Int32",1,1,"Count",0);za=V.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);za.addParameter("key","String",1,null,0);V.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);V.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",
!0)};var $h=d(43);class Yl{constructor(F,V){this.zjc=F;this.bjc=V}WOf(F){return[200,null,F]}N0i(F,V,za,gb,Fb,Ec){const $c=$h.a.jZ(),Ed=this.zjc.create(V,za,gb);gb.Dwf=Ed;const pe=this.bjc.create(Ec);pe.context.appId=V;pe.context.controlId=za;const Se=()=>{Ii.Slh(!0);Ed.pmd=!1;OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(Ed,Lk,pe,F).then(ae=>{if(!ae)return r.ULS.sendTraceTag(587745500,802,10,"ExecuteRichApiRequest failed."),Fb(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError),
null;Ii.fUe($c,$h.a.jZ());Fb(ae,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess);return null},ae=>{r.ULS.sendTraceTag(587745499,802,10,"A PPT Rich API batch execution was failed, AppId: {0}  Reason: {1}",V,ae);Fb(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return null})},Ye=()=>{Ii.Slh(!1);let ae=F[4];id.a("ExtensibilityUseSerializedPayloads")&&(ae=fi(gb,ae));OfficeExtension.WacRuntime.Utility.createPromise(lg=>{const og={};og.promiseToResolve=lg;og.requestBody=ae;z.AFrameworkApplication.Ra.Ka(Pa.a.NRc,
2,og)}).then(lg=>{id.a("ExtensibilityResetResponse")&&z.AFrameworkApplication.Ra.Ka(Pa.a.NRc,2,{promiseToResolve:null,requestBody:""});if(id.a("ExtensibilityUseSerializedPayloads")){a:if((lg=Sys.Serialization.JavaScriptSerializer.deserialize(lg.toString()))&&lg.sel&&lg.sel.sldLst){var og=Ec.presentation,se=lg.sel.sldLst,Df=[];if(se)for(Ci of se)({slideId:se}=Xc.a.EKh(Ci)).returnValue&&(se=Object(aa.a)(118,og.ZC(se)))&&Df.push(se);var Ci=Df;if(Ci.length&&!gb.Yt.JKl(Ci))lg=null;else{Ci=1===Ci.length?
Ci[0]:null;og=null;if(Ci&&lg.sel.shpLst){Df=lg.sel.shpLst;og=[];if(Df)for(oj of Df)(Df=Ci.GQ(parseInt(oj)))&&og.push(Df);var oj=og;if(oj.length&&!gb.Yt.IKl(oj)){lg=null;break a}og=1===oj.length?oj[0]:null}lg=og&&lg.sel.txRn&&(lg.sel.txRn.length&&2!==lg.sel.txRn.length||2===lg.sel.txRn.length&&0<=lg.sel.txRn[0]&&!gb.Yt.KKl(og,lg.sel.txRn[0],lg.sel.txRn[1]))?null:lg.rst}}else lg=null;lg?(Ii.fUe($c,$h.a.jZ()),Fb(this.WOf(lg),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)):Fb(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else Ii.fUe($c,
$h.a.jZ()),Fb(this.WOf(lg),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess);return null},()=>{Fb(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return null})};F?(Ed.pmd=!0,OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(Ed,Lk,pe,F).then(ae=>{ae&&Ed.dDg?Se():Ye();return null},()=>{Ye();return null})):Se()}}Object(h.a)(Yl,"RichApiRequest",null,[]);class Cl extends df{constructor(F,V,za){super();this.zjc=F;this.bjc=V;this.ta=za}go(){this.Ko={};this.jr()}jr(){const F=this.parameters.ArrayData;
if(F){var V=null,za=this.p9d();za&&za.taskpane&&(V=za.taskpane.ownerAddinSolutionId);try{(new Yl(this.zjc,this.bjc)).N0i(F,V,this.controlId,this.Gd,Object(D.a)(this,this.O0i,"executeRichApiRequestCallback"),this.ta)}catch(gb){Le.a.J(509112536,802,10,"Exception thrown at ExecuteRichApiRequestMethod: "+gb.toString()),this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.XH()}}else this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.XH()}O0i(F,V){this.errorCode=V;this.errorCode===
OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.Ko.Data=F);this.XH()}get description(){return"Run ExecuteRichApi Invocation Completed."}}Object(h.a)(Cl,"ExecuteRichApiRequestMethod",df,[]);class ol extends df{constructor(){super()}go(){this.Ko={};this.jr()}jr(){const F=this.YCb.NSj();r.ULS.sendTraceTag(587747344,802,50,"GetAccessToken was called!");const V=(za,gb)=>{za===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(gb=gb.accessToken,this.Ko[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=
gb):(gb=this.Gd.Q_.QW(this.controlId),r.ULS.sendTraceTag(587747343,802,10,"{0}",{["errorCode"]:za.toString(),["appId"]:gb.jp.id,["storeType"]:gb.jp.storeType}));this.xh=za;this.XH()};this.pJj.execute(za=>{const gb=this.Gd.Ui,Fb=dd.getInstance();Ce.AppsForOfficeSingleSignOnManager.getInstance(gb,za,Fb).getAccessToken(this.controlId,F,this.parameters,V)})}get description(){return"Postmessage to wac host layer to get an access token for Addin."}}Object(h.a)(ol,"GetAccessTokenMethod",df,[]);class Zk extends df{constructor(){super()}jr(){let F=
null;this.Yt&&(F=Microsoft.Office.WebExtension.ActiveView.Edit);F?(this.result[Microsoft.Office.WebExtension.Parameters.Data]=F,this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Returns the ActiveView value for current mode."}}Object(h.a)(Zk,"GetActiveViewMethod",df,[]);var lk=d(1001);class $k extends df{constructor(){super()}go(){this.Ko={};this.jr()}jr(){var F=this.Oc.Ui.getOsfControl(this.controlId);if(!z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.OEP.Block3PGetAuthContext",
!1)||F.isFirstParty()){F=F.getManifest();var V=F.getMarketplaceID(),za=F.getWebApplicationId(),gb=F.getWebApplicationMsaId();fc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(V).then(Fb=>{this.errorCode=0;const Ec={};Ec[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Fb.upn;Ec[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Fb.userId;Ec[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=za;Ec[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=
gb?gb:za;Ec[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Fb.authority;Ec[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=lk.a.b4f(Fb.authorityType);Ec[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Fb.isAnonymous;Ec[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Fb.tenantId;Ec[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Fb.supportsAuthToken;this.Ko[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=
Ec;this.XH()},Fb=>{this.xh=1;this.Ko[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=Fb;this.XH()})}}get description(){return"Return authentication context needed by WebAuth stack."}}Object(h.a)($k,"GetAuthContextMethod",df,[]);class cj extends df{constructor(){super()}go(){this.Ko={};this.jr();this.xh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.XH()}jr(){var F=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];const V=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];
F=this.Pda.y4f(F);!F||V*F.LDh>=F.fileSize?this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeIndexOutOfRange:(Rj.oLi(this.Gd.presentationId,this.controlId,F.a7d,V,F.LDh,Object(D.a)(this,this.W3b,"customizedOnFinished"),Object(D.a)(this,this.V3b,"customizedOnError")).start(),this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}W3b(F,V){F?0===V.errorCode?(F=V.value,this.Ko[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=F,this.Ko[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=
F.length,this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.XH()}V3b(){this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.XH()}get description(){return"Returns the specified slice."}}Object(h.a)(cj,"GetDocumentCopyChunkMethod",df,[]);class fg extends df{constructor(){super();this.Ifa=this.Jma=0}go(){this.Ko={};this.jr();this.xh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&
this.XH()}jr(){try{const F=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()];this.Ifa=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()];if(1>this.Ifa||4194304<this.Ifa)Le.a.J(17310339,802,50,"GetDocumentCopyMethod: Invalid slice size: "+this.Ifa),this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSliceSize;else{switch(F){case 1:this.Jma=4;break;case 2:this.Jma=3;break;default:Le.a.J(17310341,802,50,"GetDocumentCopyMethod: Unsupported file type: "+
F);this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeFileTypeNotSupported;return}this.Pda.Ang(this.controlId,this.Jma)?this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit:this.Pda.qEa.count>=this.Gd.wUd.rd.pptEditorAppForOfficeMaxDocumentReaders?this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeTooManyIncompleteRequests:(this.Cel.U3(!1,!0,()=>{this.Oel()},Object(D.a)(this,this.Qya,"saveFailureCallback")),this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}}catch(F){Le.a.J(17310343,802,10,
"Exception thrown at GetDocumentCopyMethod: "+F.toString()),this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}}Oel(){Rj.pLi(this.Gd.presentationId,this.controlId,this.Jma,this.Ifa,Object(D.a)(this,this.W3b,"customizedOnFinished"),Object(D.a)(this,this.V3b,"customizedOnError")).start()}Qya(){this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.XH();return!1}W3b(F,V){if(F&&F.length){F=V.format;var za=V.sliceSize,gb=V.errorCode;0===gb?(V=V.fileSize,this.Ko[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=
V,V=this.Pda.vvi(this.controlId,V,za,F),this.Ko[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=V,this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.xh=174===gb?OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit:175===gb?OSF.DDA.ErrorCodeManager.errorCodes.ooeTooManyIncompleteRequests:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}else this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.XH()}V3b(F,V){this.xh=V?OSF.DDA.ErrorCodeManager.errorCodes.ooeNetworkProblemRetrieveFile:
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.XH()}get description(){return"Returns the entire document file in slices."}}Object(h.a)(fg,"GetDocumentCopyMethod",df,[]);class al extends df{constructor(){super()}jr(){this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;try{const F=this.Daj(),V=this.Yt.Ufj(F);V&&(this.Ko[""+OSF.DDA.Marshaling.ThemingKeys.DocumentTheme]=V,this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(F){Le.a.J(17687510,802,10,"Exception thrown at GetDocumentThemeMethod: "+
F)}}get description(){return"Returns the DocumentTheme (equivalent to AppForOfficeTheme) value for slide."}}Object(h.a)(al,"GetDocumentThemeMethod",df,[]);class gi extends df{constructor(){super()}jr(){this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;let F=null;if(this.Yt&&void 0!==(F=this.Yt.ayb())&&null!==(F=this.Yt.ayb())){var V={};V[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=F;this.result[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=V;this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}}get description(){return"Returns the file properties. Now it only returns the URL."}}
Object(h.a)(gi,"GetFilePropertiesMethod",df,[]);class rm extends df{constructor(){super()}jr(){this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext}get description(){return"(Not implemented) Returns OfficeTheme properties."}}Object(h.a)(rm,"GetOfficeThemeMethod",df,[]);class xa extends df{constructor(){super()}jr(){this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.Yt)try{var F=this.parameters[OSF.DDA.WAC.UniqueArguments.GetData].CoerceType.toString();F===Microsoft.Office.WebExtension.CoercionType.SlideRange?
(F=null,this.xh=({Kgl:F}=this.Yt.Rqj()).returnValue,this.Ko[OSF.DDA.WAC.UniqueArguments.Data]=F):F===Microsoft.Office.WebExtension.CoercionType.Text?(F=null,this.xh=({psc:F}=this.Yt.Vqj()).returnValue,this.Ko[OSF.DDA.WAC.UniqueArguments.Data]=F):this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}catch(V){Le.a.J(8958164,802,10,"Exception thrown at GetSelectedDataMethod: "+V.toString())}}get description(){return"Get data contained in the current selection of the document."}}Object(h.a)(xa,
"GetSelectedDataMethod",df,[]);class Ff extends df{constructor(){super()}jr(){var F=this.p9d();if(F){const V={};V.Settings=this.D8d(F.settings);this.Ko[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]=V;this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else F="AppForOffice instance could not be found for ID "+this.controlId+Tg.Debug.gu(),Le.a.J(8958160,802,10,F),this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Loads/Refreshes Settings object for an app"}D8d(F){const V=
{};let za=0;for(let gb in F)V[za.toString()]=[gb,F[gb]],za++;return V}}Object(h.a)(Ff,"LoadSettingsMethod",df,[]);class Ri extends df{constructor(){super()}jr(){r.ULS.sendTraceTag(587747346,802,50,"ExecuteAsync was called!");this.YCb.wla()?(this.xh=Fe.instance.$sa.awk(this.controlId,this.parameters[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],this.parameters[O.a.yJc],this.parameters[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin]),this.xh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&
r.ULS.sendTraceTag(587747345,806,10,"ExecuteAsync failed. Error code: {0}",this.xh.toString())):this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported}get description(){return"Run messageParent method."}}Object(h.a)(Ri,"MessageParentMethod",df,[]);class vj extends df{constructor(){super()}jr(){this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.Yt)try{const F=this.parameters[OSF.DDA.Marshaling.NavigationKeys.NavigationRequest],V=F[OSF.DDA.Marshaling.NavigationKeys.GoToType],
za=F[OSF.DDA.Marshaling.NavigationKeys.Id].toString();this.xh=V===OSF.DDA.Marshaling.GoToType.Index?this.Yt.gyj(za):V===OSF.DDA.Marshaling.GoToType.Slide?this.Yt.hyj(za):OSF.DDA.ErrorCodeManager.errorCodes.ooeUnsupportedEnumeration}catch(F){Le.a.J(8958162,802,10,"Exception thrown at navigatetomethod: "+F.toString())}}get description(){return"Go to the slide specified by user."}}Object(h.a)(vj,"NavigateToMethod",df,[]);class Hg extends df{constructor(){super();this.Tye=0}go(){this.Ko={};this.jr();
this.xh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.XH()}jr(){this.Tye=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];const F=this.Pda.y4f(this.Tye);F?(Rj.SPf(this.Gd.presentationId,this.controlId,F.a7d,!1,!1,Object(D.a)(this,this.W3b,"customizedOnFinished"),Object(D.a)(this,this.V3b,"customizedOnError")).start(),this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist}W3b(F,V){F?0===V.errorCode?
(this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,this.Pda.x5k(this.Tye)):this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.XH()}V3b(){this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.XH()}get description(){return"Closes the document file."}}Object(h.a)(Hg,"ReleaseDocumentCopyMethod",df,[]);class ua extends df{constructor(){super();this.SIa=null}jr(){var F=this.p9d();if(F){var V=this.parameters[OSF.DDA.WAC.UniqueArguments.SettingsRequest];
this.SIa=this.D8d(Array.isArray(V[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings])?V[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]:null);V=null;F.taskpane&&(V=F.taskpane.ownerAddinSolutionId);var za;if(F.taskpane&&V)if(za=this.Gd.sEa(V)){this.Yt.gYe(za,this.SIa);if(za=this.Gd.Q_.o9d(V))za.settings=this.SIa;F.settings=this.SIa;this.Gd.K9e(V,this.SIa);this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else this.SJc.yfg(V,this.SIa,this.Oc)?(F.settings=this.SIa,this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):
this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else(za=0===F.iy?this.Gd.V_f(F.shape.slideId,F.shape.id):this.Gd.sEa(F.jp.id))?(this.Yt.gYe(za,this.SIa),F.settings=this.SIa,this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}else F="AppForOffice instance could not be found for ID "+this.controlId+Tg.Debug.gu(),Le.a.J(9052994,802,10,F),this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Saves settings to document."}D8d(F){const V=
{};if(F)for(let za=0;za<F.length;za++){const gb=Array.isArray(F[za])?F[za]:null;gb&&1<gb.length&&(V[gb[0]]=gb[1])}return V}}Object(h.a)(ua,"SaveSettingsMethod",df,[]);class eb extends df{constructor(){super()}jr(){this.YCb.wla()?(Fe.instance.$sa.whl(this.controlId,this.parameters[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],this.parameters[O.a.yJc],this.parameters[OSF.DDA.Marshaling.SendMessageKeys.TargetOrigin]),this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported}get description(){return"Run sendMessage/messageChild method."}}
Object(h.a)(eb,"SendMessageMethod",df,[]);class Tb extends df{constructor(){super()}jr(){this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.Yt)try{const V=this.parameters[OSF.DDA.WAC.UniqueArguments.SetData];var F=V.CoerceType.toString();const za=V[OSF.DDA.WAC.UniqueArguments.Data];if(F===Microsoft.Office.WebExtension.CoercionType.Text)this.xh=this.Yt.Unl(za);else{let gb;if(F===Microsoft.Office.WebExtension.CoercionType.Image)gb=0;else if(F===Microsoft.Office.WebExtension.CoercionType.XmlSvg)gb=
1;else{this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported;return}F=!1;let Fb=0,Ec=0,$c=0,Ed=0;({IHj:F,x:Fb,y:Ec,width:$c,height:Ed}=this.G1i(V,F,Fb,Ec,$c,Ed));this.xh=this.Yt.byh(za,F,Fb,Ec,$c,Ed,gb,this.parameters[O.a.yJc])}}catch(V){Le.a.J(509112542,802,10,"Exception thrown at SetSelectedDataMethod: "+V)}}G1i(F,V,za,gb,Fb,Ec){const $c=F[OSF.DDA.Marshaling.SetDataKeys.ImageLeft],Ed=F[OSF.DDA.Marshaling.SetDataKeys.ImageTop];void 0!==$c&&null!==$c&&"number"===typeof $c&&void 0!==
Ed&&null!==Ed&&"number"===typeof Ed&&(V=!0,za=$c,gb=Ed);F[OSF.DDA.Marshaling.SetDataKeys.ImageWidth]&&(Fb=F[OSF.DDA.Marshaling.SetDataKeys.ImageWidth]);F[OSF.DDA.Marshaling.SetDataKeys.ImageHeight]&&(Ec=F[OSF.DDA.Marshaling.SetDataKeys.ImageHeight]);return{IHj:V,x:za,y:gb,width:Fb,height:Ec}}get description(){return"Writes data to the current selection in the document."}}Object(h.a)(Tb,"SetSelectedDataMethod",df,[]);class uc extends ch{constructor(F){super(F)}QPk(){this.Vhc={};this.set(OSF.DDA.MethodDispId.dispidLoadSettingsMethod,
()=>new Ff);this.set(OSF.DDA.MethodDispId.dispidSaveSettingsMethod,()=>new ua);this.set(OSF.DDA.MethodDispId.dispidGetActiveViewMethod,()=>new Zk);this.set(OSF.DDA.MethodDispId.dispidNavigateToMethod,()=>new vj);this.set(OSF.DDA.MethodDispId.dispidGetSelectedDataMethod,()=>new xa);this.set(OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod,()=>new gi);this.set(OSF.DDA.MethodDispId.dispidGetDocumentThemeMethod,()=>new al);this.set(OSF.DDA.MethodDispId.dispidGetOfficeThemeMethod,()=>new rm);this.set(OSF.DDA.MethodDispId.dispidSetSelectedDataMethod,
()=>new Tb);this.set(OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod,()=>new fg);this.set(OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod,()=>new cj);this.set(OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod,()=>new Hg);this.set(OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod,()=>new uj);this.set(OSF.DDA.MethodDispId.dispidMessageParentMethod,()=>new Ri);this.set(OSF.DDA.MethodDispId.dispidSendMessageMethod,()=>new eb);this.set(OSF.DDA.MethodDispId.dispidGetAccessTokenMethod,
()=>new ol);this.set(OSF.DDA.MethodDispId.dispidGetAuthContextMethod,()=>new $k);this.set(OSF.DDA.MethodDispId.dispidCreateDocumentMethod,()=>new Xl);this.set(OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod,()=>new Cl(this.Oc.Wcl,this.Oc.YSk,this.Oc.aO))}}Object(h.a)(uc,"EditorMethodFactory",ch,[]);class yd extends Sys.EventArgs{constructor(F){super();this.r_h=F}get instanceId(){return this.r_h}}Object(h.a)(yd,"FirstPartyAddInHidingEventArgs",Sys.EventArgs,[]);class oe{constructor(){this.ZXa=
{};this.cAe={};this.rcd={};this.n9c={}}Owf(F,V){V&&F&&(this.ZXa[F]=V,this.n9c[F]=!1)}wbi(F,V){F&&V&&(this.rcd[F]=V)}t5k(F){if(F){var V=this.ZXa[F];V&&(delete this.rcd[V.jp.id],delete this.ZXa[F],delete this.cAe[F],delete this.n9c[F])}}QW(F){return F?this.ZXa[F]:null}pjj(F){return F?this.n9c[F]:!1}Qsj(F){return F?this.cAe[F]:null}KNh(F,V){F&&(this.n9c[F]=V)}vQl(F,V){F&&(this.cAe[F]=V)}o9d(F){if(!F)return null;const V=this.ZXa;for(let za in V){const gb=V[za];if(gb&&gb.jp.id.toLowerCase()===F.toLowerCase())return gb}return null}yaj(F,
V,za){if(!F||!V||!za)return null;const gb=this.ZXa;for(let Fb in gb){const Ec=gb[Fb];if(Ec&&Ec.taskpane&&Ec.taskpane.ownerAddinSolutionId&&Ec.taskpane.ownerAddinSolutionId.toLowerCase()===F.toLowerCase()){const $c=za.getOsfControl(Ec.instanceId);if($c&&$c.getSharedRuntimeId()===V)return Ec}}return null}p8d(F){wd.a.forEach(this.ZXa,(V,za)=>{V=Object(aa.a)(672,za);1===V.iy&&F(V)},null)}d4i(F){const V=this.ZXa;for(let za in V){const gb=Object(aa.a)(672,V[za]);if(gb&&F(gb))return gb}return null}U_f(F){return F in
this.rcd?this.rcd[F]:null}}Object(h.a)(oe,"OsfAppInstacneCache",null,[]);class $d{constructor(){}}Object(h.a)($d,"AppForOfficeSDXDialog",null,[701]);class ve{constructor(F,V,za,gb,Fb,Ec,$c,Ed,pe,Se,Ye,ae,lg,og,se,Df,Ci,oj,Pl,Pf,Rm,Zf,Ge,Si,Fn){this.N2b=!1;this.zdb=this.jfa=this.ute=this.Dwf=null;this.xa=new N.a;this.pHg=!1;this.lo=F;this.FJ=V;this.aDe=new uc(this);this.O5c=new Zh(this,Pf);this.HXa=Rm;this.mXa=gb;this.Xyg={};this.kG=new oe;this.Cek=za;this.lDb=Fb.value;this.oA=$c;this.Rb=Ec;this.u5=
Ed;this.Vb=pe;this.rek=Ci;this.V9=Se;this.Jb=Ye;this.ai=ae;this.ta=lg;this.Ga=og;this.jc=se;this.oc=Df;this.Ydc=Pl;this.Adb=new Lb;this.oek=oj;this.ul=Zf;this.zjc=Ge;this.bjc=Si;this.Zlk=Fn}initialize(){this.L6(this.Vb.mode);this.Vb.GI(Object(D.a)(this,this.lfg,"handleModeSwitch"))}dispose(){this.Vb.IY(Object(D.a)(this,this.lfg,"handleModeSwitch"))}get SJc(){this.Adb||(this.Adb=new Lb);return this.Adb}get Ui(){if(!ve.xva){this.lo&&(this.lo.rd.MSj&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new Ue),
this.Jb.ka("305")&&OfficeExt.PrivateCatalogService.initRequestHandler(new Ue,new Kc(this.lo.rd.yg?z.AFrameworkApplication.fa.appSettings.AuthProxyHandlerWebServiceBase:z.AFrameworkApplication.fa.appSettings.WebServiceBase),this.Jb.ka("306")),OfficeExt.MosRequestHandler.init(new Ue),OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new Ue));const F=new Ih(this.aDe,this.O5c);this.zdb=this.KF.BJi(this.kG);ve.xva=this.Cek.lKi(this.FJ,F,this.zdb);
ve.xva.setOAuthManager(this.Zlk);ve.xva&&"undefined"!==typeof ve.xva.hostCheckReadyHandler&&z.AFrameworkApplication.Jfi(Object(D.a)(ve.xva,ve.xva.hostCheckReadyHandler,"hostCheckReadyHandler"))}return ve.xva}U8e(F){(F=this.Ui.getOsfControl(F))&&this.zdb&&this.zdb.y8g(F)}WIb(F,V){this.zdb.WIb(F,V)}qCb(F,V,za){this.zdb?this.zdb.J7j(F,V,za):r.ULS.sendTraceTag(512508178,806,10,"m_appEventListener is null")}Nlb(F,V,za=null){const gb=this.KF.z3(F);if(this.Jb.ka("569")&&!OSF.OsfControl.isFirstPartyStoreString(this.pvb(gb.storeType)))this.ul.tea(22)||
this.ul.UDa(22);else if(0===gb.iy)this.mXa.JSj(gb.id)?(za=this.mXa.hsa[gb.id],id.a("Microsoft.Office.SharedOnline.FixBug6808089")?this.mXa.ELa(gb.id,this.Z0e(F),V):(za.uZe(V),this.mXa.ELa(gb.id,this.Z0e(F),null))):(F=this.Utd(F,V),F.uZe(V),this.mXa.Eel(gb.id,F));else if(1===gb.iy){const Fb=gb.node.sa(qd.a.b_,null);this.Qua(gb.id)?gb.Nlg||this.qNb(Fb,!0):this.Utd(F,V,za);this.lo.rd.Iua&&!gb.ownerAddinSolutionId&&(V=this.Fde(gb.xya),this.K9e(gb.xya,V.settings))}}launchInsertDialog(){this.xa.raiseEvent("OnInsertionDialogOpened");
this.jfa=new Hi;this.jfa.pj("",null,null);this.Ui.launchInsertDialog(this.jfa.fka)}I7j(F){var V=this.wJc.U6b(F);this.lo.gH().Ka(Pc.a.Cie,2,{version:V.version,storeType:V.storeType,storeId:V.storeId,assetId:V.assetId,assetStoreId:V.assetStoreId,targetType:V.targetType,displayName:V.displayName,solutionId:F,width:V.width,height:V.height});this.Jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MRUAddinInstalledTelemetryEnabled",!0)&&(F=Telemetry.PrivacyRules.GetPrivacyCompliantId(V.solutionId,
V.storeType,V.assetId,null,null,V.storeId),V=new I.a,V.name="Office.Extensibility.Host.InstallMRUAddinFromFlyout",V.dataFields=T.a.kz({CWl:F}),ca.a.sendTelemetryEvent(V))}u4c(F){const V=this.Ui.getAppUILocale()||"en-US";this.Gxg=new La(F,"wac_powerpoint",V,za=>{this.lo.gH().Ka(Pc.a.Cie,2,za);this.Gxg.hide()});this.Gxg.pj("",null,null);return!0}W7j(F){this.xa.raiseEvent("OnInsertionDialogOpened");this.jfa=new Hi;this.jfa.pj("",null,null);if(F){const V={navigationMode:0};V.assetId=F;this.Ui.launchInsertDialog(this.jfa.fka,
"{98143890-AC66-440E-A448-ED8771A02D52}",V)}else this.Ui.launchInsertDialog(this.jfa.fka)}Gug(F){this.xa.raiseEvent("OnInsertionDialogOpened");this.jfa=new Hi;this.jfa.pj("",null,null);this.Ui.launchInsertDialog(this.jfa.fka,F,{navigationMode:0,assetId:null,category:null})}zhg(){this.jfa&&this.jfa.hide()}ikb(F){const V=this.v0f(F);V?this.xph(V):r.ULS.sendTraceTag(512508177,806,10,String.format("Failed to find the AppNode with instance id: {0}",F))}xph(F){const V=this.KF.z3(F);if(this.Jb.ka("569")&&
!OSF.OsfControl.isFirstPartyStoreString(this.pvb(V.storeType)))this.ul.tea(22)||this.ul.UDa(22);else{var za=(gb,Fb)=>{const Ec=this.KF.z3(gb),$c=this.KF.aOc(z.AFrameworkApplication.isRtl,Ec.id,Ec.width,Ec.visibility);Fb.YZ($c);let Ed=Fb=null;this.lo.rd.Iua&&this.lo.rd.A4j&&(Ed=this.kod(F),Fb=()=>{this.aH($c,!0,!1);this.xQb(Ed)});this.Nlb(gb,$c.RJc,Fb);Ed&&(gb=this.zQ(Ed.jp.id).Oca,$c.epl(gb));$c.Xp(Ec.visibility)};if(this.lo.rd.Iua){const gb=this.KF.z3(F),Fb={};Fb.solutionId=gb.xya;Fb.version=gb.version;
Fb.storeType=this.pvb(gb.storeType);Fb.storeId=gb.store;Fb.targetData=F;this.Ui.isAddinCommandsAsync(Fb,(Ec,$c)=>{const Ed=this.kod(F);var pe=F.sa(Ic.a.isForUILessAction,!1);const Se=F.sa(Ic.a.sharedRuntimeId,null),Ye=gb.ownerAddinSolutionId,ae=!!Ed.qw&&0<Ed.qw.state&&!!Ed.qw.Pya;if(!$c&&gb.visibility||$c&&Ye&&!ae||pe&&!fa.a.Xa(Se))za(F,this.oA),this.Q_.KNh(gb.id,$c);else if($c){if(pe=this.g6b(gb.xya))Ed.settings=pe.settings,this.Yt.gYe(F,Ed.settings);this.Q_.Owf(Ed.instanceId,Ed);this.Q_.KNh(Ed.instanceId,
$c);this.K9e(Ed.jp.id,Ed.settings);if(gb.visibility&&this.V9.installVisibleAddinCommandsEnabled||ae){if("omex"!==Fb.storeType.toLowerCase()&&!ae)return;let lg=!1;this.LRe(og=>{if(!og[O.a.bji]){if(og[O.a.Xzf])for(const se of og[O.a.Xzf])if(lg=Xh.e(se[1])===Xh.e(gb.xya))break;lg||this.oIc(Ed)}})}}Ec||Le.a.J(512508176,220,10,"Checking AddinCommands fails for {0} from {1}",gb.xya,this.pvb(gb.storeType))})}else za(F,this.oA)}}Exb(F){return F&&F.assetId?F.sourceLocationOverrideResourceId?String.format("{0}.{1}",
F.assetId,F.sourceLocationOverrideResourceId):F.assetId:null}U9k(F){F.fvb=-1;const V=this.nFf(F);this.OGb=new yh(F.TPc,F.XPc,F.t3d);void 0!=F.dialogLeft&&void 0!=F.p4b&&void 0!=F.dialogTop&&void 0!=F.n4b&&this.OGb.ikl(F.dialogLeft,F.p4b,F.dialogTop,F.n4b);void 0!=F.dialogHeight&&void 0!=F.dialogWidth&&this.OGb.jkl(F.dialogHeight,F.dialogWidth);this.OGb.pj(F.gka,null,null);this.Utd(V,this.OGb.fka,null,F)}F9k(F){F.fvb=1;const V=this.nFf(F),za=this.KF.z3(V);if(z.AFrameworkApplication.J2c(za.xya)){const gb=
this.KF.aOc(z.AFrameworkApplication.isRtl,za.id,za.width,za.visibility,F);this.oA.YZ(gb);gb.Xp(za.visibility);this.Utd(V,gb.RJc,null,F)}}LRe(F){const V={};V.callback=F;z.AFrameworkApplication.Ra.Ka(Pc.a.a0a,2,V)}oIc(F){const V=this.KF.aOc(z.AFrameworkApplication.isRtl,F.instanceId,F.taskpane.width,F.taskpane.visibility);this.oA.YZ(V);V.Xp(F.taskpane.visibility);const za=V.RJc;Object(aa.a)(671,this.KF.t0d(this.lo.rd,F,za,z.AFrameworkApplication.isRtl,this)).oIc(this.Ui,za,()=>{this.xQb(F);this.aH(V,
!1,!!F.qw&&!!F.qw.Pya);v.a.instance.setItem(O.a.DTd,"true")})}aH(F,V,za){F.Xp(!1);za||(ve.xva.purgeOsfControl(F.id,!1),V?this.lo.gH().Ka(Pa.a.XYc,2,F.id):this.O5c.rKf(F.id),F.dispose())}xQb(F){var V={};V.solutionId=F.jp.id;V.version=F.jp.version;V.storeType=F.jp.storeType;V.storeId=F.jp.store;V.assetId=null;V.assetStoreId=null;V.sharedRuntimeId=F.qw?F.qw.Pya:null;V.backgroundState=F.qw?F.qw.state:-1;F=new e.a;F.add(V);V={};V[O.a.uJc]=F;V[O.a.j8]=3;this.lo.gH().Ka(Pc.a.s4c,2,V)}fUc(){const F=this.u5.Ef;
var V=null;F&&(V=new Rf.GraphIterator,V.set(F),V=V.Cb(18));return V}zQ(F){return F?(F=this.kG.o9d(F))&&F.taskpane?F:null:null}m5i(F,V,za,gb){if(!F||!V||!za)return null;F=this.getSharedRuntimeId(V,gb,F.solutionId,za);return(za=this.kG.yaj(za,F,this.Ui))&&za.taskpane?za:null}OSc(F){return F?(F=this.kG.QW(F))&&F.taskpane?F:null:null}sEa(F){if(!F)return null;var V=this.fUc();if(V&&(V=this.Rb.Lc(V))&&V.Cb(19)){do{const za=V.currentNode;if(this.l0b(za.sa(cb.a.dtb,null),F))return za}while(V.Nj(19))}return null}v0f(F){if(!F)return null;
var V=this.fUc();if(V&&(V=this.Rb.Lc(V))&&V.Cb(19)){do{const za=V.currentNode;if(this.l0b(za.sa(qd.a.b_,null),F))return za}while(V.Nj(19))}return null}V_f(F,V){return(F=this.oc.Zk(F))?F.GQ(V):null}dSj(F){return F?this.kG.pjj(F):!1}iri(F,V,za,gb,Fb){if(!F||!F)return null;let Ec;if(!(F.solutionId&&F.version&&F.storeId&&F.storeType))return r.ULS.sendTraceTag(512508175,802,15,"Invalid entitlement"),null;Ec=Object(aa.a)(sf.a,this.lDb.createInstance(1074135137));Ec.setValue(cb.a.dtb,F.solutionId);Ec.setValue(cb.a.$Jc,
F.version);Ec.setValue(cb.a.ZJc,F.storeId);Ec.setValue(qd.a.U_b,this.NNc(F.storeType));Ec.setValue(cb.a.VJc,!1);Ec.setValue(qd.a.b_,Jd.a.create().toString());Ec.setValue(cb.a.rUd,"right");Ec.setValue(cb.a.X_b,za);Fb&&Ec.setValue(Ic.a.isForUILessAction,Fb);gb&&(Ec.setValue(qd.a.udh,gb),(F=this.getSharedRuntimeId(V,Fb,F.solutionId,gb))&&Ec.setValue(Ic.a.sharedRuntimeId,F));return Ec}q9d(F){F=this.sEa(F);return this.kod(F)}hri(F,V){if(!(F&&F&&F.solutionId&&F.version&&F.storeId&&F.storeType))return null;
F=new Mb(F.solutionId,F.version,F.storeId,F.storeType);V=V?new ag(0,V):null;return new xg(F,null,null,null,null,{},1,V)}oQc(F){Ce.AppsForOfficeSingleSignOnManager.zyi(F);const V=this.kG.QW(F);V&&(ve.xva.purgeOsfControl(V.instanceId,!1),this.O5c.rKf(V.instanceId),this.kG.t5k(V.instanceId),this.mXa.qnh(V.instanceId),this.HXa.Rqc(this.presentationId,F,!1,!0))}notifyAgave(F,V){this.Ui.notifyAgave(F,V)}x2k(F){!this.pHg&&F.gk&&(F=F.gk,F.yd(47).h8(Object(D.a)(this,this.dBf,"appDisposeHandler")),F.yd(10).h8(Object(D.a)(this,
this.dBf,"appDisposeHandler")),this.pHg=!0)}dBf(F,V){F=V.node;V=1074135137===F.Xe;if(F.sa(qd.a.Jq,!1)||V)F=this.KF.z3(F),this.oQc(F.id)}nFf(F){var V;const za=Object(aa.a)(9,this.lDb.createInstance(1074135137));za.setValue(cb.a.$Jc,"1.0.0.0");za.setValue(cb.a.ZJc,"en-US");za.setValue(qd.a.b_,Jd.a.create().toString());za.setValue(cb.a.X_b,!0);za.setValue(qd.a.kUd,null);za.setValue(qd.a.bBf,null);za.setValue(cb.a.dtb,this.Exb(F));(null!==(V=F.c$e)&&void 0!==V?V:1)?(za.setValue(cb.a.V_b,"sdxcatalog"),
za.setValue(qd.a.U_b,this.NNc("sdxcatalog"))):(za.setValue(cb.a.V_b,"firstparty"),za.setValue(qd.a.U_b,this.NNc("firstparty")));za.setValue(qd.a.isAddinCommands,!1);za.setValue(cb.a.VJc,!1);za.setValue(cb.a.rUd,"right");return za}kod(F,V=null){if(!F)return null;F=this.KF.z3(F);var za=this.pvb(F.storeType);const gb=new Mb(F.xya,F.version,F.store,za);let Fb=null,Ec=null,$c;if(-1==(null===V||void 0===V?void 0:V.fvb))$c=new $d;else if(0===F.iy)Fb=new kd(F.shapeId,F.slideId);else if(1===F.iy)Ec=new Id(F.QUf,
F.visibility,F.width,F.row,F.ownerAddinSolutionId,F.ownerAddinStoreType,F.Nlg);else return null;let Ed={};V&&OSF.OsfControl.isFirstPartyStoreString(za)?Ed=OSF.OUtil.serializeSettings(V.nonPersistedSettings):F.ownerAddinSolutionId||(Ed=F.settings);za=F.R7a?new ag(F.Ctb,F.R7a):null;return new xg(gb,F.id,Fb,Ec,$c,Ed,$c&&V?V.fvb:F.iy,za)}lmh(F,V=null){if(this.Jb.ka("883")){var za=this.Ui.getOsfControl(F);if(za&&V){if(V.nonPersistedSettings){var gb=OSF.OUtil.serializeSettings(V.nonPersistedSettings);za.setSettings(gb);
za.setHostSettings(gb)}V.ZA&&(gb=Object(aa.a)(672,this.OSc(F)))&&(gb.Oca=V.ZA,this.qNb(F,!0));za.refresh();this.U8e(F)}}}Utd(F,V,za=null,gb=null){const Fb=this.kod(F,gb);if(!Fb||OSF.OsfControl.isFirstPartyStoreString(Fb.jp.storeType)&&!z.AFrameworkApplication.J2c(Fb.jp.id))return null;var Ec=this.KF.z3(F);if(this.Jb.ka("569")&&!OSF.OsfControl.isFirstPartyStoreString(this.pvb(Ec.storeType)))return this.ul.tea(22)||this.ul.UDa(22),null;gb&&gb.ZA&&(Fb.Oca=gb.ZA);Ec=Object(aa.a)(671,this.KF.t0d(this.lo.rd,
Fb,V,z.AFrameworkApplication.isRtl,this));this.kG.Owf(Fb.instanceId,Fb);this.kG.wbi(Fb.jp.id,V);gb&&gb.c6&&gb.c6();this.lo.rd.Iua&&Fb.taskpane&&Fb.taskpane.ownerAddinSolutionId&&(V=this.kG.o9d(Fb.taskpane.ownerAddinSolutionId))&&this.OMh(V.instanceId,Fb.instanceId);Ec.Sul(this.Ui,this.Z0e(F),za,gb,this.V9.powerPointDragInsertImageIsEnabled);Fb.taskpane&&Fb.taskpane.ownerAddinSolutionId||this.x2k(F);return Ec}yHh(F){if(this.V9.p5j){const za=this.Q_.QW(F);if(za&&0===za.iy&&za.shape){var V=this.Q_.Qsj(F);
const gb=new Date;!V||gb.getTime()-V.getTime()>=this.V9.pptEditorAppForOfficeSnapshotIntervalTime?(r.ULS.sendTraceTag(512508173,806,50,"Start to generate addin [{0}] {1} snapshot",za.jp.id,F),(V=this.rek.jOf(1,F))?(this.Q_.vQl(F,gb),V.execute(this,this.oek,null)):r.ULS.sendTraceTag(512508172,806,50,"Snapshot action is null for addin [{0}] {1}.",za?za.jp.id:"AppNotExist",F)):r.ULS.sendTraceTag(512508171,806,50,"Addin [{0}] {1} snapshot interval is less than config interval threshold.",za?za.jp.id:
"AppNotExist",F)}}}D$g(F,V,za,gb){1===F&&this.sIk(V,za,gb)}sIk(F,V,za){let gb=null;za&&za.result&&(za=za.result,gb=za.substr(za.indexOf("base64,")+7));const Fb=this.Q_.QW(F);V===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&gb&&0<gb.length&&Fb?0===Fb.iy&&Fb.shape&&Fb.jp&&this.ai.eNh(Fb.shape.slideId.toString(),Fb.shape.id,gb,()=>{r.ULS.sendTraceTag(512508170,806,50,"Update addin [{0}] {1} snapshot succeed with {2} bytes",Fb.jp.id,F,gb.length)},()=>{r.ULS.sendTraceTag(512508169,806,10,"Update addin [{0}] {1} snapshot failed",
Fb.jp.id,F);return!1}):r.ULS.sendTraceTag(512508168,806,10,"Generate addin [{0}] {1} snapshot failed with {2} bytes",Fb?Fb.jp.id:"AppNotExist",F,gb?gb.length:0)}g6b(F){return F?this.Xyg[F]:null}KIc(F,V){F&&V&&(this.Xyg[F]=V)}get Yt(){this.ute||(this.ute=new ub(this.lo.rd,fc.a.instance.resolve("Common.IAppSettingsManager"),this.FJ,fc.a.instance.oe("Box4.IOutlineEditor"),fc.a.instance.oe("Box4.ISelectionManager"),fc.a.instance.oe("Box4.ICharacterPropertiesEditor"),fc.a.instance.oe("PowerPointWebEditor.IClassFactory"),
fc.a.instance.resolve("Common.Transaction.ITransactionFactory"),this.lo.gH(),fc.a.instance.resolve("PowerPointWebEditor.IPPTWorkspace"),fc.a.instance.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),fc.a.instance.resolve("Common.ITaskManager"),fc.a.instance.resolve("PowerPointWebEditor.IPresentationReader"),fc.a.instance.resolve("PowerPointWebEditor.ISlideReader"),fc.a.instance.resolve("PowerPointWebEditor.IAppforOfficeClassFactory"),fc.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),
fc.a.instance.resolve("PowerPointWebEditor.View.IPPTPageView"),fc.a.instance.resolve("PowerPointWebEditor.IShapeEditor"),fc.a.instance.resolve("PowerPointWebEditor.IShapeReader"),fc.a.instance.resolve("Box4.Graph.IGraphIteratorFactory"),fc.a.instance.resolve("Box4.IOutlineElementNavigator"),fc.a.instance.resolve("Box4.IParagraphReader"),fc.a.instance.resolve("PowerPointWebEditor.IRibbonChangeManager"),fc.a.instance.resolve("Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory")));return this.ute}get Pda(){return this.HXa}l0a(F,
V,za){this.O5c.n9d(F).raiseEvent(za,V)}Zjh(F,V){this.kG.p8d(za=>{this.l0a(F,za.instanceId,V)})}OMh(F,V){if(F&&V){F=this.Q_.QW(F);var za=this.Q_.QW(V);F&&za&&(za.settings=F.settings,this.I$g(V,F.settings))}}K9e(F,V){F&&V&&this.Q_.p8d(za=>{this.l0b(za.taskpane.ownerAddinSolutionId,F)&&!this.SJc.KSj(za.settings,V)&&(za.settings=V,this.I$g(za.instanceId,V))})}lfg(F){this.L6(F.mode)}L6(F){if(1!==F&&2!==F)throw Error.invalidOperation(String.format("The mode '{0}' being swtiched to is unsupported.",F));
r.ULS.sendTraceTag(512508167,806,50,"AppForOfficeManager.SwitchToMode: {0} the content add-in's container on active slide.",2===F?"Show":"Edit");this.mXa.L6(F);this.oA.L6(F)}I$g(F,V){const za=OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString();this.l0a(za,F,V)}pvb(F){switch(F){case 0:F="spcatalog";break;case 1:F="filesystem";break;case 2:F="omex";break;case 3:F="spapp";break;case 4:F="registry";break;case 5:F="inmemory";break;case 6:F="uploadfiledevcatalog";break;case 7:F="excatalog";break;
case 8:F="firstparty";break;case 9:F="sdxcatalog";break;default:throw Error.create(String.format("[{0}] is not the valid store type int value.",F));}return F}NNc(F){if(!F)throw Error.create("Store Type should not be null.");ve.w6||ve.dNj();if(F in ve.w6)return ve.w6[F];throw Error.create(String.format("[{0}] is not the valid store type.",F));}Fde(F){return F?this.kG.d4i(V=>this.l0b(V.jp.id,F)):null}get wUd(){return this.lo}Igi(F){this.xa.addHandler("OnInsertionDialogOpened",F)}cJc(F){this.xa.addHandler("OnFirstPartyAddInHidden",
F)}Z7k(F){this.xa.removeHandler("OnFirstPartyAddInHidden",F)}VXk(F){this.xa.raiseEvent("OnFirstPartyAddInHidden",new yd(F))}rZd(F){const V=yi.a.dqa(this.oA.h3,za=>za.id===F);if(1!==V.length)return!1;this.aH(V[0],!0,this.Qua(F));return!0}qNb(F,V){const za=yi.a.dqa(this.oA.h3,gb=>gb.id===F);1!==za.length?Le.a.J(512508166,220,50,"Panes with appropriate instance id are {0}",za.length):za[0].Xp(V)}K$i(F){const V=yi.a.dqa(this.oA.h3,za=>za.id===F);return 1!==V.length?(Le.a.J(512508165,220,50,"Panes with appropriate instance id are {0}",
V.length),!1):V[0].isVisible}OKl(F,V){const za=this.g6b(F);za&&za.qw&&za.qw.Pya&&(za.qw.state=V?1:0,(this.sEa(F)||this.SJc.yfg(F,za.settings,this))&&this.lo.gH().Ka(Pa.a.RMh,2,za))}L$i(F){return(F=this.g6b(F))&&F.qw?1===F.qw.state:!1}aLf(F){this.Q_.p8d(V=>{this.l0b(V.taskpane.ownerAddinSolutionId,F)&&this.rZd(V.instanceId)})}Jxb(F){return this.kG.QW(F)}Qua(F){if(!F||4===this.Ui.getOsfControlStatus(F))return!1;F=this.Ui.getOsfControl(F);return!!F&&!!F.getSharedRuntimeId()}setInitialDisplayMode(F,V){(F=
this.Ui.getOsfControl(F))&&F.setInitialDisplayMode(V)}getSharedRuntimeId(F,V,za,gb){if(!F)return null;const Fb=new oc;if(!Fb)return null;if(V)return F.getSharedRuntimeId(Fb.PT,V,null);za=(new vb("",gb,Fb,!0)).lRf(za.substr(gb.length));return F.getSharedRuntimeId(Fb.PT,V,za)}I5i(F,V){const za={};za.visibility=V?"Visible":"Hidden";V=JSON.stringify(za);this.K0f(F,65539,"",V)}K5i(F,V,za){this.K0f(F,1,V,za)}Exl(F,V){F=new Mb(F.solutionId,F.version,F.storeId,F.storeType);var za=new Id("right",!0,350,0,
null,null,!1);F=new xg(F,Fj.a.create().toString(),null,za,null,{},1,null);const gb=this.KF.aOc(z.AFrameworkApplication.isRtl,F.instanceId,F.taskpane.width,F.taskpane.visibility);this.oA.YZ(gb);gb.Xp(F.taskpane.visibility);za=gb.RJc;Object(aa.a)(671,this.KF.t0d(this.lo.rd,F,za,z.AFrameworkApplication.isRtl,this)).oIc(this.Ui,za,()=>{this.aH(gb,!1,!1);V()})}K0f(F,V,za,gb){var Fb=Array(6);Fb[0]=65536;Fb[1]=V;Fb[2]=za;Fb[3]=gb;Fb[4]=-1;Fb[5]=!1;V=Array(1);V[0]=Fb;Fb=new ce(OSF.DDA.EventDispId.dispidRichApiMessageEvent,
F,null,V);this.l0a(OSF.DDA.EventDispId.dispidRichApiMessageEvent.toString(),F,Fb)}l0b(F,V){return F&&V?F.toLowerCase()===V.toLowerCase():!1}Z0e(F){return!this.Vb||1!==this.Vb.mode||F&&"FA000000012"===F.sa(qd.a.kUd,null)?1===this.KF.z3(F).iy?!0:this.Ga.uGa(F)?this.ta.Ba===this.jc.mg(F):!1:!1}get presentationId(){return this.lo.lUa().presentationId}get cNf(){return this.mXa}get Q_(){return this.kG}get KF(){return this.Ydc.value}get Wcl(){return this.zjc}get YSk(){return this.bjc}get aO(){return this.ta}static dNj(){ve.w6=
{};ve.w6.inmemory=5;ve.w6.uploadfiledevcatalog=6;ve.w6.spcatalog=0;ve.w6.omex=2;ve.w6.registry=4;ve.w6.spapp=3;ve.w6.filesystem=1;ve.w6.excatalog=7;ve.w6.firstparty=8;ve.w6.sdxcatalog=9}get xJc(){return this.wJc}get wJc(){this.DJc&&!this.ote&&(id.a("Microsoft.Office.SharedOnline.AddinDetailsManagerConfigEnabled")?this.ote=eg.createInstance(this.Jb,new ei.a(()=>this.Ui),{["AppsForOfficeAllowExternalMarketplace"]:this.V9.g0c,["AppsForOfficeThirdPartyIsDisabled"]:this.V9.oBb,["AreThirdPartyAddInsAllowed"]:this.V9.Qca,
["PopularAddinDetailsJsonString"]:ve.vKa}):this.ote=eg.createInstance(new Yh.a({["AppsForOfficeAllowExternalMarketplace"]:this.V9.g0c.toString(),["AppsForOfficeThirdPartyIsDisabled"]:this.V9.oBb.toString(),["AreThirdPartyAddInsAllowed"]:this.V9.Qca.toString(),["PopularAddinDetailsJsonString"]:ve.vKa}),new ei.a(()=>this.Ui)));return this.ote}get DJc(){return this.Jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)}YU(F,V){this.wJc&&this.wJc.YU(F,V)}static get vKa(){return'[{"displayName":"Pro Word Cloud","solutionId":"wa104038830","version":"1.0.0.3","targetType":1,"width":0,"height":0,"description":"Create beautiful word cloud images from your text","iconUrl":"65503.58165d84-0d6e-4545-a991-40ffee49b75a.9fa95f4f-0649-45b6-8ea9-b3b9e7611d90.2a84fadc-6e9a-4a27-a8c3-4c7a71e76546.jpeg","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://prowritingaid.com/art/245/Privacy-Policy.aspx","addinInfo":{"priority":2,"AUP":1,"downloadNumber":2924240}},{"displayName":"QR4Office","solutionId":"wa104051163","version":"1.2.0.3","targetType":1,"width":0,"height":0,"description":"A first-of-its-kind QR-generator that integrates seamlessly into your Office documents.","iconUrl":"53638.20ce8aca-39c5-4b97-b87a-47d0f3e21e0d.0b60ea0f-7e02-4465-baeb-bb55c723d670.9147ef8e-cf16-47cf-af10-ef553e88804d.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://q.michaelzlat.com/","addinInfo":{"priority":2,"AUP":1,"downloadNumber":5211012}},{"displayName":"Pickit | Make impactful presentations in minutes","solutionId":"wa104178141","version":"4.3.3.0","targetType":1,"width":0,"height":0,"description":"Unlimited access to licensed photos, clipart and your company\'s images in PowerPoint.","iconUrl":"52119.865d61ab-6329-4325-ab0d-d26b79dacfb7.7c9712b0-85a4-4901-839e-2ac101b87124.5e9898d6-d6c2-49a0-8098-1eb30d35701b.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://pickit.com/en/privacy-policy","addinInfo":{"priority":1,"AUP":1885,"downloadNumber":1159314}},{"displayName":"Poll Everywhere Presenter","solutionId":"wa104218073","version":"3.0.0.1","targetType":0,"width":960,"height":540,"description":"Gather audience responses via SMS or web, and display them instantly in gorgeous PowerPoint charts.","iconUrl":"27009.88b1aa30-f74d-43ab-b5f6-4565d9a70427.06bc2362-a830-44c4-84e3-f5b99c45acf8.47ba58ff-e53f-4c3e-bea2-3aa7562d1cc6.png","licenseUrl":"https://www.polleverywhere.com/terms","privacyUrl":"https://www.polleverywhere.com/privacy-policy","addinInfo":{"priority":2,"AUP":1495,"downloadNumber":682480}},{"displayName":"Web Video Player","solutionId":"wa104221182","version":"3.3.0.0","targetType":0,"width":730,"height":411,"description":"Add YouTube videos to your PowerPoint presentations or Excel spreadsheets.","iconUrl":"21223.8fa8e2cf-70f0-4b35-ab45-a587c415721d.71d26e67-e3a5-4499-af2a-87e1ada53aca.91b974c8-435a-45c4-bbc7-167fa1d34ffb.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.michael-saunders.com/videoplayer/pages/privacy.html","addinInfo":{"priority":1,"AUP":947,"downloadNumber":331140}},{"displayName":"Web Viewer","solutionId":"wa104295828","version":"1.9.0.0","targetType":0,"width":960,"height":540,"description":"Take it to the web! Insert a secure webpage into your presentation.","iconUrl":"53665.f48f5d64-1b9c-4db4-8579-0a8a770cc1df.479bd539-f5d1-4edd-8d3f-fd2aa12fe078.d7ba8494-d2ee-426a-985a-25a7db9bf8f5.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949675993/Asset_901070fc-4837-4edc-83b0-b3438f2ddf97/OfficeMixEULA.docx","privacyUrl":"https://aka.ms/mixaddinprivacy","addinInfo":{"priority":2,"AUP":2439,"downloadNumber":5015403}},{"displayName":"Mentimeter - Interactive Presentations","solutionId":"wa104379261","version":"3.0.2.4","targetType":0,"width":1000,"height":700,"description":"Engage your audience with fun and interactive presentations, visualizing their opinions in real-time","iconUrl":"51223.47e20eb4-286a-415c-a7c6-a30d8aaf5dd8.bb9bb1df-e506-4b71-82d1-44c6d0de3876.92bae303-c177-4756-a889-8da8fce426e2.png","licenseUrl":"https://www.mentimeter.com/terms","privacyUrl":"https://www.mentimeter.com/privacy","addinInfo":{"priority":1,"AUP":3793,"downloadNumber":4298337}},{"displayName":"LessonPix Symbols","solutionId":"wa104379370","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Access your LessonPix Account and over 50K clipart symbols from within Microsoft Office.","iconUrl":"52104.453267e0-c2e7-43b0-b9d8-1a14024ce16f.bf27c658-00f3-4406-81ca-374c6f1bd24b.9ef3504f-30b7-4fd3-b135-7931280a8d74.png","licenseUrl":"https://lessonpix.com/articles/11/299/LessonPix%20Office%20Add-In%20Terms%20and%20Conditions","privacyUrl":"https://lessonpix.com/articles/11/26/LessonPix+Privacy+Policy","addinInfo":{"priority":1,"AUP":350,"downloadNumber":8447}},{"displayName":"Pexels - Free Stock Photos","solutionId":"wa104379997","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Get great looking free stock photos for your documents and presentations.","iconUrl":"42183.883a975e-b768-42b6-804b-7440e32d8a14.594bab1e-71b2-4309-b08a-27d3d8832a91.9373d154-174d-40db-873f-11b8a2e636a4.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://officeconsult.no/en/pexels-office-add-in/#privacy","addinInfo":{"priority":1,"AUP":412,"downloadNumber":601175}},{"displayName":"officeatwork | Template Chooser for Office - M365","solutionId":"wa104380050","version":"3.4.0.0","targetType":1,"width":0,"height":0,"description":"Access your centrally shared templates in Office, Teams, SharePoint Online, and other Apps.","iconUrl":"21517.40f3490e-24f2-4502-9a44-28e543d36a75.cc0236b1-594c-49ad-9462-3f787be3cd4f.f383d0e6-2de8-4367-9108-e62781456dad","licenseUrl":"https://links.officeatwork.com/officeatwork-licenseterms","privacyUrl":"https://links.officeatwork.com/officeatwork-privacypolicy","addinInfo":{"priority":1,"AUP":795,"downloadNumber":525805}},{"displayName":"Emoji Keyboard","solutionId":"wa104380121","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Emoji for Microsoft Word, PowerPoint and OneNote","iconUrl":"59740.f26acde8-b516-46ad-8220-2984e6945380.2f899a00-04c7-483e-9ee2-e1b35c2b080f.12545571-342a-4850-b117-43d02783ed9d.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://emoji.patbu.xyz/#/privacy","addinInfo":{"priority":1,"AUP":591,"downloadNumber":319195}},{"displayName":"Templafy Company Templates","solutionId":"wa104380278","version":"1.0.0.6","targetType":1,"width":0,"height":0,"description":"Access best practice professional templates and digital assets within your Office applications","iconUrl":"39478.da1eadf9-2005-4a37-9f41-d99acc46197e.5e0830db-920f-4070-b60e-bbd8de8c498c.6e4a303a-5acd-4946-9a57-53715948ec92.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.templafy.com/privacy","addinInfo":{"priority":3,"AUP":110,"downloadNumber":25675}},{"displayName":"PickMe - Presentation images","solutionId":"wa104380510","version":"1.0.0.3","targetType":1,"width":0,"height":0,"description":"Search and add images, photos, icons and background images for your best presentation.","iconUrl":"45844.d6cd8bac-3b6d-45dc-8fbe-6307d6477d25.c4010abd-54d6-4345-be6e-fb8cdb8f926e.2095bcd7-d785-46dd-9472-c95cceb628d2.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://pickme.gettyimagesbank.com/guide/Privacy/privacy_policy","addinInfo":{"priority":3,"AUP":1,"downloadNumber":14098}},{"displayName":"Adobe Acrobat for Microsoft Word, Excel, and PowerPoint","solutionId":"wa104380526","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Do more with enterprise PDF tools, built right into your favorite Microsoft 365 apps.","iconUrl":"832.4553b45a-c9b7-42b8-9c57-e33b57f5df4d.80d83ec3-4ec7-4f7d-b45f-36b1f0c05e78.3d5b10f9-0a9c-4ac1-84fc-b7439dfb4f35.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":3,"AUP":685,"downloadNumber":3103601}},{"displayName":"officeatwork | Content Chooser for Office","solutionId":"wa104380602","version":"3.4.0.0","targetType":1,"width":0,"height":0,"description":"Access your centrally shared content in Word, Excel, PowerPoint, Outlook, Browser, and other Apps.","iconUrl":"21517.8509aff9-edc8-4f6a-8b59-4b406996c84a.d1a19980-7c71-4be1-8215-82ff5834af8f.fa526dd8-ee50-4045-add0-21357070c87b.png","licenseUrl":"https://links.officeatwork.com/officeatwork-licenseterms","privacyUrl":"https://links.officeatwork.com/officeatwork-privacypolicy","addinInfo":{"priority":3,"AUP":379,"downloadNumber":300574}},{"displayName":"PP Timer","solutionId":"wa104380667","version":"3.0.0.1","targetType":0,"width":640,"height":480,"description":"Insert a timer into your PowerPoint presentation. Add an analog or digital timer into your slide.","iconUrl":"34537.0bb60981-b391-4645-8398-65b19c9df09a.571de747-edd5-4568-9dd0-072bcf87df09.69ce727f-55eb-405a-9470-668ccee0d6fc.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://pp-timer.com/privacy-policy","addinInfo":{"priority":1,"AUP":8,"downloadNumber":1681399}},{"displayName":"Script Lab, a Microsoft Garage project","solutionId":"wa104380862","version":"1.5.0.0","targetType":1,"width":0,"height":0,"description":"Create, run, and share your Office Add-in code snippets from within Excel, Word, or PowerPoint.","iconUrl":"52703.9fd54003-f1a2-4196-a8a8-ea11bec509a8.9b4da1d4-cb1c-46e6-9463-8a258eb273e6.b5c7baa9-2a17-4db7-b0dd-ca9dea75bd27.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":3,"AUP":305,"downloadNumber":177312}},{"displayName":"Pixton Comic Characters","solutionId":"wa104380907","version":"3.1.0.0","targetType":1,"width":0,"height":0,"description":"Add illustrated, posable comic characters to your training or educational presentations.","iconUrl":"29860.e57c0b3f-b9bb-4ebd-b4e4-8b64b797db43.8ed21d66-e83f-4ec7-98e4-f637d866c239.755b4296-081d-4793-8eb5-ed82118043d8.png","licenseUrl":"https://www.pixton.com/terms-of-use/addons","privacyUrl":"https://www.pixton.com/privacy-policy/addons","addinInfo":{"priority":1,"AUP":1485,"downloadNumber":1043265}},{"displayName":"Excel-to-Word Document Automation","solutionId":"wa104380955","version":"3.16.2.1","targetType":1,"width":0,"height":0,"description":"Update Word and PowerPoint documents from Excel data, calculations, text, tables, and charts.","iconUrl":"44742.554108a6-3275-4065-9a18-887d38776dca.31f4b432-c6cb-49c5-9fba-56c194301365.e534a91d-b3f5-445e-bdbd-1559dbb4b396.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://analysisplace.com/Privacy","addinInfo":{"priority":3,"AUP":211,"downloadNumber":149144}},{"displayName":"Icons by Noun Project","solutionId":"wa104381063","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"Over 1 million high-quality icons to choose from, perfect for presentations.","iconUrl":"43800.2d301a6f-7f58-486a-aa28-60900de38763.afe578dd-fbdd-497d-b1e4-66a6217bfb17.c7c39ea5-5370-437d-8e9d-f9fe1fa77b09.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://thenounproject.com/legal/#!privacy-policy","addinInfo":{"priority":1,"AUP":318,"downloadNumber":218656}},{"displayName":"Adobe Acrobat Sign for Microsoft Word and PowerPoint","solutionId":"wa104381155","version":"1.1.1.0","targetType":1,"width":0,"height":0,"description":"Do business faster with Adobe Acrobat Sign for Word and PowerPoint.","iconUrl":"31139.c4694bde-161e-42b4-8b8f-87f0c1b5010e.4a78185a-5a69-438c-99c2-80f85f7092a3.39897ffc-7ed4-4e29-bd29-b748bc14ae57.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":2,"AUP":3852,"downloadNumber":5854335}},{"displayName":"IconScout - Icons, Illustrations & 3D Assets","solutionId":"wa104381411","version":"2.4.1.0","targetType":1,"width":0,"height":0,"description":"Seamlessly access over 4.5 Million+ Design assets within Microsoft Office Applications","iconUrl":"36684.41fa480b-3128-4253-a7ae-3e7c1406bfb6.07fc268d-eaaa-4f81-b6b3-911c8b2d104d.5b4a7a13-0f35-4b05-a07e-7b5c347ad154.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://iconscout.com/legal/privacy-policy","addinInfo":{"priority":1,"AUP":645,"downloadNumber":71152}},{"displayName":"Ubi Timer","solutionId":"wa104381448","version":"1.0.0.8","targetType":0,"width":348,"height":720,"description":"Add a customisable timer to your PowerPoint presentation slides.","iconUrl":"8460.b2044bd4-1b25-41e3-9810-3564d9472171.804e0d26-99a8-4b72-a103-49327a1a30b8.f01fef0d-5053-4e80-b246-34524e7c5f69.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://ubicompsolutions.co.uk/timer_privacy","addinInfo":{"priority":3,"AUP":84,"downloadNumber":37025}},{"displayName":"Forms","solutionId":"wa104381526","version":"1.0.0.2","targetType":0,"width":800,"height":450,"description":"Embed surveys, quizzes, and polls directly into a PowerPoint slide.","iconUrl":"3597.3f744035-7cc5-4b23-9aea-1e7380b37172.42f8397f-a77f-48a3-a506-4032a34b3bf7.14bf7247-1539-4086-9824-7fe176221f3d.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://go.microsoft.com/fwlink/?linkid=871815","addinInfo":{"priority":1,"AUP":6617,"downloadNumber":16064476}},{"displayName":"Wooclap","solutionId":"wa104381682","version":"1.0.0.5","targetType":0,"width":900,"height":500,"description":"With its many features and intuitive use, Wooclap turns events into interactive and dynamic learning","iconUrl":"13441.9fb6980a-f99b-4bf1-9d44-82fefa4843e1.4d33dfef-862e-473d-bfb1-2bdabc490da8.e1403f2d-3a83-46a6-8215-0a1020f33bbc.png","licenseUrl":"https://www.wooclap.com/en/terms-of-service","privacyUrl":"https://www.wooclap.com/en/privacy-policy","addinInfo":{"priority":2,"AUP":935,"downloadNumber":4539455}},{"displayName":"MathType","solutionId":"wa104381909","version":"3.5.1.0","targetType":1,"width":0,"height":0,"description":"Write math equations and chemical formulas in your documents and presentations with MathType.","iconUrl":"44741.813eee75-3ca3-4574-8852-d4a1ee5fd6fb.a6600903-ad52-41cc-a277-a99d413f741b.18009730-067c-46f9-a8f7-539cd53cbd6b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.wiris.com/en/mathtype-privacy-policy","addinInfo":{"priority":1,"AUP":1672,"downloadNumber":4062279}},{"displayName":"EasyTimer","solutionId":"wa104382064","version":"1.0.0.2","targetType":0,"width":1000,"height":600,"description":"An easy-to-use timer for your PowerPoint presentations.","iconUrl":"17586.18a4e21f-e685-4cd1-910e-2b2e032b01ff.5f21673c-f2a3-4710-8cdc-532e6d7a4f45.baa310be-ee05-44be-8e2b-1373024798f8.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://lixiaoooowei.github.io/TimerLab/Home/PrivacyPolicy.html","addinInfo":{"priority":2,"AUP":1364,"downloadNumber":1063634}},{"displayName":"Pear Deck Add-in","solutionId":"wa200000094","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Add formative assessments and interactive activities to lessons and presentations","iconUrl":"59452.62af3df0-63ba-40f1-83d3-a0bc16189b66.26661aad-7dc8-4f47-a9d9-3aa9c939d106.e9f66df9-6115-41f5-8721-fab23ac9b3a8.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.peardeck.com/privacy-policy","addinInfo":{"priority":2,"AUP":9847,"downloadNumber":2600980}},{"displayName":"draw.io Diagrams","solutionId":"wa200000113","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Easily embed draw.io diagrams from cloud storage","iconUrl":"14142.2ec57164-ba5b-42ee-8253-ade72ca74c8d.e8efbcc8-e27f-4682-9321-eb111eb3bc68.950e1c22-0dd9-4079-807b-145ecdb6df9c.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474849055/Product_42949683254/Asset_f99133a0-53c0-4c21-905f-757b27070c6a/drawioEULATermsofServicedrawio.pdf","privacyUrl":"https://desk.draw.io/support/solutions/articles/16000096192-privacy-policy-for-draw-io-add-in-for-microsoft-office","addinInfo":{"priority":2,"AUP":783,"downloadNumber":992110}},{"displayName":"Adobe Creative Cloud for Word and PowerPoint","solutionId":"wa200000729","version":"3.19.222.0","targetType":1,"width":0,"height":0,"description":"Bring your creative elements into Microsoft Office. Creative Cloud app is required for this add-in.","iconUrl":"18500.2f664073-3b83-4944-804c-69c30f0e9064.600364c5-532a-4bb4-8ea4-627757d016c6.9c5597d2-2156-401e-8697-18cb65b7c13c.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.adobe.com/go/privacy-policy","addinInfo":{"priority":2,"AUP":681,"downloadNumber":1506340}},{"displayName":"Present Pal add-in - Presentation Support","solutionId":"wa200001313","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Control your slideshow directly from the Present Pal app to make presenting easy and accessible!","iconUrl":"26522.34e9b858-f1e6-4aa8-b47f-dfb0c9224869.2f9ca7d4-7141-4377-bde9-adcb55b44237.6092b85f-1084-427b-a1ec-55b33b8ee41f.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://presentpal.co.uk/privacy-policy","addinInfo":{"priority":3,"AUP":96,"downloadNumber":108511}},{"displayName":"Premast Plus","solutionId":"wa200001396","version":"4.1.3.0","targetType":1,"width":0,"height":0,"description":"Use Premast plus features and professional templates to design better presentation, faster. Without ","iconUrl":"62947.925c188e-dab2-4231-acfb-60d131eb7da4.132d74f0-1c13-48eb-b8f5-fcec0b139825.1b91bd7f-2be5-430e-a33c-2016eb52f79a.png","licenseUrl":"https://premast.com/plus-terms-of-use","privacyUrl":"https://premast.com/privacy-policy","addinInfo":{"priority":1,"AUP":103,"downloadNumber":37282}},{"displayName":"Slides365 - Build Professional Presentations Yourself","solutionId":"wa200001409","version":"1.0.0.3","targetType":1,"width":0,"height":0,"description":"Guided storytelling using pre-built Templates, Industry Domain Slides, Design Slides and Icons","iconUrl":"10382.5c0bebe6-0d6f-40c0-88ff-4bcc1c0a3acb.9a0fd746-d03b-42f5-8b9f-1eced5547c82.1b9b795d-9337-411d-be6b-fd064ef3dec8.png","licenseUrl":"https://slides365.com/Terms.html","privacyUrl":"https://slides365.com/Privacy-Policy.html","addinInfo":{"priority":2,"AUP":124,"downloadNumber":42358}},{"displayName":"SlideHub","solutionId":"wa200001625","version":"1.0.0.7","targetType":1,"width":0,"height":0,"description":"Helps SlideHub users build better presentations faster via various tools and an on-demand service ","iconUrl":"28341.df79b07c-0691-4db6-9851-8b81eaa9f482.805bbb88-2bbf-4a63-9d09-d9c6ebedfc46.339597b4-5e8a-4295-8925-ed11ad30fbc1.png","licenseUrl":"https://slidehub.io/eula","privacyUrl":"https://slidehub.io/privacy","addinInfo":{"priority":2,"AUP":1735,"downloadNumber":12877}},{"displayName":"Breaktime","solutionId":"wa200001661","version":"2.1.0.2","targetType":0,"width":800,"height":600,"description":"A quick way to tell everyone when you\'ll be back, because it\'s Breaktime!","iconUrl":"53429.790a3023-92b3-4c27-bd32-62a1ac84d552.c35b1205-7b21-4321-84c7-9708e97de568.4d0318b8-f51d-4eef-ae55-3c20fb66521e.png","licenseUrl":"https://www.flosim.com/breaktime/EULA.html","privacyUrl":"https://www.flosim.com/breaktime/Privacy_Policy.html","addinInfo":{"priority":1,"AUP":3240,"downloadNumber":3146674}},{"displayName":"Canto Connector","solutionId":"wa200001766","version":"1.5.0.0","targetType":1,"width":0,"height":0,"description":"Simplify how you add images and brand elements to Word and PowerPoint from your Canto image library.","iconUrl":"7869.c66666c2-edf3-4109-955b-4b8dcefb734e.39d11081-f25d-4285-9427-84ecd59deb0a.d2b7f5df-5a3f-4755-a8a6-9c5dd4a750dc.png","licenseUrl":"https://team.canto.com/b/Q9GTF","privacyUrl":"https://www.canto.com/privacy-policy","addinInfo":{"priority":3,"AUP":32,"downloadNumber":52636}},{"displayName":"Jasperactive for Office","solutionId":"wa200002334","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Web-based learning for Microsoft Word, Microsoft Excel and for Microsoft PowerPoint.","iconUrl":"24398.0a1bdc08-ac9f-4231-8e69-4eb02a692937.a4408ec1-bba8-4f97-961d-09257a62e38a.0013100a-0ba3-4b30-b729-14bf64da59dc.png","licenseUrl":"https://jasperactive.com/end-user-license-agreement","privacyUrl":"https://jasperactive.com/privacy-policy","addinInfo":{"priority":2,"AUP":1456,"downloadNumber":948014}},{"displayName":"Kahoot! for PowerPoint","solutionId":"wa200002908","version":"1.1.0.0","targetType":0,"width":800,"height":480,"description":"Host kahoots within PowerPoint and make presentations awesome! ","iconUrl":"5821.dc651664-7ea2-4fed-b845-27e926a3bf3f.29a4cdf3-8814-4a22-b5b3-c79c432e8b0f.0c3e5c0c-62fb-4d25-8518-3bf537f62cd0.png","licenseUrl":"https://trust.kahoot.com/terms-and-conditions","privacyUrl":"https://trust.kahoot.com/privacy-policy","addinInfo":{"priority":1,"AUP":563,"downloadNumber":4724708}},{"displayName":"RRSlide Library","solutionId":"wa200003157","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"We supply PowerPoint templates, infographics, charts, 3D icons, etc. to make a quick presentation","iconUrl":"27146.0ffbcab3-3f86-4d90-847e-e9e416c2f04d.1ada7438-24b1-4363-861f-4f3235e1fe56.1c5b196a-7fe5-49ea-ad4c-a502150e70e9.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://rrslide.com/privacy-policy","addinInfo":{"priority":2,"AUP":150,"downloadNumber":37950}},{"displayName":"Personalised QR Code Generator","solutionId":"wa200003220","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Quickly generate personalised, branded QR codes.","iconUrl":"1053.89a21dfa-3fde-4c6f-89e4-3eae439d83e7.67539e4a-131a-406f-a541-73c85a95eb0f.7a449688-1bb3-4511-9f43-2cc1a09edc9b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://littleappy.co/office/qr-code-generator/privacy","addinInfo":{"priority":3,"AUP":179,"downloadNumber":203447}},{"displayName":"Microsoft Power BI","solutionId":"wa200003233","version":"2.0.0.3","targetType":0,"width":960,"height":570,"description":"Enhance storytelling with data by easily including Power BI reports into your presentation.","iconUrl":"44848.68115a5f-13b5-4260-9fe9-b6c37e561377.e47b03c9-a5b9-4b5b-97be-affb2ee9bff5.82fc138b-c424-4039-b098-8fdbd0d76965.png","licenseUrl":"https://docs.microsoft.com/en-us/dynamics365/legal/apps-for-power-platform-tou","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":1,"AUP":43414,"downloadNumber":23707798}},{"displayName":"Microsoft Power BI Beta","solutionId":"wa200003251","version":"2.0.0.4","targetType":0,"width":960,"height":570,"description":"Enhance storytelling with data by easily including Power BI reports into your presentation.","iconUrl":"44848.e29569b7-a73e-472a-906f-7d3d7b5b56d0.6c0dd532-76c1-4565-a1f0-e5e8d45f1138.f53a6d02-633b-4da5-a56f-f804e844a2a0.png","licenseUrl":"https://docs.microsoft.com/en-us/dynamics365/legal/apps-for-power-platform-tou","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":-1,"AUP":250,"downloadNumber":6885}},{"displayName":"Showmaster (Helper Plugin)","solutionId":"wa200003676","version":"1.0.0.0","targetType":0,"width":957,"height":538,"description":"Impress with remarkable animations, countdown and music before your presentation.","iconUrl":"38182.cc4515b5-7941-4c49-8152-a4da1dceef8d.f2ec1037-3774-4e94-a41a-f9e6432611d8.b9e80121-ccc1-40f9-b6f7-3430a31b50fc.png","licenseUrl":"https://showmaster.app/terms","privacyUrl":"https://showmaster.app/privacy","addinInfo":{"priority":3,"AUP":156,"downloadNumber":22550}},{"displayName":"Showmaster","solutionId":"wa200003706","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Impress with remarkable animations, countdown and music before your presentation.","iconUrl":"38182.e0b83de2-8341-4aaf-a8da-e9a86c1dfdd3.e729953e-7bb6-4556-8a33-55c83e572918.0fe180b8-8511-42ae-b526-0796e91fbee1.png","licenseUrl":"https://showmaster.app/terms","privacyUrl":"https://showmaster.app/privacy","addinInfo":{"priority":3,"AUP":75,"downloadNumber":27278}},{"displayName":"PresenterMedia | Thousands of Animations, Templates, and Designs at your Fingertips","solutionId":"wa200003891","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"Insert customized graphics, templates and videos directly into your presentation.","iconUrl":"37569.30ec0671-d417-4ae9-8009-4cee496ea074.3b3c120c-ea56-4a82-a3c1-82e4591f6140.e03fae66-8132-4071-a176-963a53dd2798.png","licenseUrl":"https://www.presentermedia.com/addin_terms_of_use","privacyUrl":"https://www.presentermedia.com/privacy_policy","addinInfo":{"priority":3,"AUP":109,"downloadNumber":17025}},{"displayName":"Read on reMarkable","solutionId":"wa200003915","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Easily send Word and PowerPoint documents to your reMarkable.","iconUrl":"7364.f24d322e-3985-4b36-9f2b-d1a92a90534c.43df7b3a-e5a9-4d72-ad4c-53ba599d45c7.1c530b09-8be4-40d7-878f-1bacd2fd0bce.png","licenseUrl":"https://support.remarkable.com/hc/en-us/articles/360000282757-reMarkable-End-User-License-Agreement","privacyUrl":"https://support.remarkable.com/hc/en-us/sections/360000090338-Privacy-Policy","addinInfo":{"priority":2,"AUP":250,"downloadNumber":271987}},{"displayName":"Adobe Acrobat Sign for Microsoft Word and PowerPoint - Government","solutionId":"wa200003944","version":"1.1.0.1","targetType":1,"width":0,"height":0,"description":"Do business faster with Adobe Acrobat Sign for Word and PowerPoint.","iconUrl":"36564.aa7b92f6-ad15-4d7f-9951-1891d6c9b744.bab76294-ed68-4ac6-b148-791343322826.105c41f6-ff06-4b30-8a37-a9168d40cfee.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":2,"AUP":3813,"downloadNumber":1223}},{"displayName":"beautiful.ai | AI powered slide templates","solutionId":"wa200003964","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Create beautiful presentations faster with AI powered slide templates","iconUrl":"5525.df072342-580e-437e-9d68-96615f75b68a.7429d240-ba6f-4dc1-b122-5ce6e89e8b49.50a5f98b-bd54-446f-a983-3d56cf4f16ca.png","licenseUrl":"https://www.beautiful.ai/terms-of-service","privacyUrl":"https://www.beautiful.ai/privacy-policy","addinInfo":{"priority":1,"AUP":157,"downloadNumber":39188}},{"displayName":"Project Plan","solutionId":"wa200004643","version":"1.0.0.3","targetType":0,"width":957,"height":538,"description":"Visualize your project plans and roadmaps right in PowerPoint and Excel.","iconUrl":"48512.5fa6879a-44fb-480a-8848-5280995a049e.88d32693-93e0-4681-93a8-a59ee99f893b.c488f1bf-ea9e-4e56-9711-4a5a41a432c4.png","licenseUrl":"https://www.projectplan-powerpoint.com/terms","privacyUrl":"https://www.projectplan-powerpoint.com/privacy","addinInfo":{"priority":1,"AUP":192,"downloadNumber":20986}},{"displayName":"Vevox for PowerPoint (BETA)","solutionId":"wa200004709","version":"1.0.0.2","targetType":1,"width":0,"height":0,"description":"Include Live Polls and interaction in PowerPoint presentations with the #1 rated polling platform.","iconUrl":"30836.b99a2c67-c0f9-4608-ab59-33f5dab5dffa.3c46736f-fe0e-4dad-b17e-edb4bd558f68.7ecef1a1-72c6-4083-afb1-715afe5fb27c.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.vevox.com/terms-conditions#PrivacyPolicy","addinInfo":{"priority":1,"AUP":251,"downloadNumber":274040}},{"displayName":"Ghostwriter","solutionId":"wa200005107","version":"1.0.0.5","targetType":1,"width":0,"height":0,"description":"Introducing Ghostwriter OpenAI GPT-3 for Microsoft Office \u2013 the revolutionary writing assistant ","iconUrl":"8283.9a73910f-bc07-461c-a5aa-da58e2ce898e.24d0d825-2d57-4a56-9377-9087d459417f.b690bd3b-df98-4bef-bfc3-14135f3786f8.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://creativedatastudios.com/privacypolicy.html","addinInfo":{"priority":-1,"AUP":14,"downloadNumber":54328}}]'}Lkl(F,
V=null){if(this.Ui.getOsfControl(F)&&V){if(V.ZA){const za=Object(aa.a)(672,this.OSc(F));za&&(za.Oca=V.ZA)}this.U8e(F)}}}ve.w6=null;ve.xva=null;Object(h.a)(ve,"AppForOfficeManager",null,[673,107,674]);class hc{constructor(F,V,za){this.dR=F;this.ZEg=V;this.Rb=za}register(){this.ZEg.fk(Object(D.a)(this,this.mBf,"appSettingChangedEventHandler"))}dispose(){this.ZEg.Om(Object(D.a)(this,this.mBf,"appSettingChangedEventHandler"))}mBf(F,V){F=V.node;V=V.property;try{if(1074135139===F.Xe&&V===cb.a.YJc){V=null;
var za=this.Rb.Lc(F);za.sc(47)||za.sc(10);za.Cc();this.Qme(za.currentNode)&&(V=new le.a(za.currentNode));var gb=V.settings;id.a("RefreshAppSettingsValue")&&(this.dR.Jxb(V.id).settings=gb);this.dR.l0a(OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString(),V.id,gb)}}catch(Fb){r.ULS.sendTraceTag(18442307,802,10,"Failed to execute AppSettingChangedEventHanlder: {0}.",Fb)}}Qme(F){if(!F)return!1;const V=Object(aa.a)(4,F);return 1074135137===F.Xe||!!V&&V.Jq}}Object(h.a)(hc,"AppForOfficeSettingChangedEventListener",
null,[669,107]);class Of{constructor(F,V,za){this.dR=F;this.dyg=V;this.Rb=za}register(){for(const F of this.dyg)F.IF(Object(D.a)(this,this.nBf,"appSettingCreatedEventHandler"))}dispose(){for(const F of this.dyg)F.oP(Object(D.a)(this,this.nBf,"appSettingCreatedEventHandler"))}nBf(F,V){F=V.node;try{if(this.Qme(F)&&21===V.yW){this.Rb.Lc(F).c9b()||r.ULS.sendTraceTag(20821900,802,15,"Got OnChildTopologyChanged event but no child found.");const za=new le.a(F),gb=za.settings;this.dR.l0a(OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString(),
za.id,gb)}}catch(za){r.ULS.sendTraceTag(20821901,802,10,"Failed to execute AppSettingCreatedEventHandler: {0}.",za)}}Qme(F){if(!F)return!1;const V=Object(aa.a)(4,F);return 1074135137===F.Xe||!!V&&V.Jq}}Object(h.a)(Of,"AppForOfficeSettingCreatedEventListener",null,[669,107]);class Nc{constructor(F,V){this.ia=F;this.Pr=V}register(){this.Pr.fk(Object(D.a)(this,this.LHh,"taskpaneAppCreatedEventHandler"))}dispose(){this.Pr.Om(Object(D.a)(this,this.LHh,"taskpaneAppCreatedEventHandler"))}LHh(F,V){if(F=V.node)F=
new le.a(F),V.property.id===qd.a.b_.id&&1===F.iy&&(V=V.node.sa(qd.a.b_,null))&&this.ia.Ka(Pa.a.ikb,2,V)}}Object(h.a)(Nc,"AppForOfficeTaskpaneAppCreatedEventListener",null,[669,107]);var $e=d(656),lj=d(540),th=d(912),Ig=d(913);class wk{constructor(F,V,za,gb,Fb){this.dR=F;this.lo=V;this.Vb=za;this.kG=gb;this.oA=Fb}register(F){F.controlStatusChanged=Object(D.a)(this,this.y8g,"onControlStatusChanged");F.notifyHost=Object(D.a)(this,this.J$g,"onOsfNotifyHost")}y8g(F){let V=this.kG.U_f(F.getSolutionId());
const za=this.kG.QW(F.getID());za&&za.jp&&F.isFirstParty()&&(V=this.kG.U_f(za.jp.id));if(V&&za&&V.previousSibling){var gb=F.getSolutionId(),Fb=F.getVersion(),Ec=null,$c=null;$c=F.isFirstParty()?OSF.OsfManifestManager.getCachedManifest(gb,""):OSF.OsfManifestManager.getCachedManifest(gb,Fb);F.isFirstParty()&&za.Oca?Ec=za.Oca:$c&&(Ec=$c.getDefaultDisplayName(),za.Oca=Ec);if(0!==za.iy&&-1!==za.iy){Fb=null;$c&&(Fb=$c.getDefaultIconUrl());$c=Object.assign(new th.a,{getContent:()=>V,type:"LegacyTaskPaneProps"});
var Ed=Object.assign(new $e.a,{title:Ec,hideHeader:!0,iconUrl:Fb,width:320,location:2,contentProps:$c,onOpen:()=>{},onClose:()=>{},isModernPane:!0});this.lo.rd.W1c&&(null===za||void 0===za?0:za.settings)&&Ig.a.cog(za.settings)&&(Ed.hideHeader=!1,Ed.contentProps=Ig.a.$gj(za.instanceId,za.settings,$c));Ta.UISurfaces.Gq().then(pe=>{const Se=F.getID();pe.updateTaskPane(Se,Ed);return null}).catch(()=>{Le.a.J(512360770,220,10,"taskPaneAPI.UpdateTaskpane() fails for {0}",gb)});V.previousSibling&&(V.previousSibling.innerText===
Ec||!F.isFirstParty()&&""!==V.previousSibling.innerText)||!Ec||!za.taskpane||za.taskpane.isForUILessAction||(V.previousSibling.innerText=Ec,this.Vb.Vab())}}}J7j(F,V,za){this.J$g(F,V,za)}get DJc(){return this.lo.rd.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)}Zmi(F,V){return Kd.a.Ml().equals(F.solutionId,V.solutionId)&&Kd.a.Ml().equals(F.storeType,V.storeType)}J$g(F,V,za){3===V?(this.dR.zhg(),this.oA.vf(xh.a.lF),za?(this.WIb("InsertAgave",za),this.lo.gH().Ka(Pa.a.$Zc,
2,za)):r.ULS.sendTraceTag(512360769,806,10,"InsertAgave: should have valid insert agave parameters")):41===V?this.WIb("ClickTrust",za):40===V?this.DJc&&this.cCe&&za&&this.Zmi(this.cCe,za)&&za.storeType&&(r.ULS.sendTraceTag(509669715,220,50,"AgaveHostAction.OsfControlLoad: the loadedAgaveParams' PrivacyCompliantId: {0}",wk.aJ(za)),this.cCe=void 0,this.dR.YU(Ia(za.storeType))):36===V?za?this.lo.gH().Ka(Pa.a.$Zc,2,za):r.ULS.sendTraceTag(512360768,806,10,"InsertDevManifest: should have valid insert agave parameters"):
37===V?za&&(F=Object(aa.a)(Object,za),F={["ak1"]:this.dR.Ui.getDevManifestInvalidUrlErrorString(F.manifestUrl)},this.lo.gH().Ka(Pc.a.GOb,2,F)):2===V?this.dR.zhg():9===V?this.lo.rd.Iua&&this.lo.rd.Klg&&this.lo.gH().Ka(Pc.a.iUe,2,za):5===V||6===V?(za=this.kG.QW(F))?0===za.iy?this.oA.o7e(V):this.oA.h7i(F,V):r.ULS.sendTraceTag(512360738,806,10,String.format("Failed to find the cached app with instance Id: {0}",F)):13===V||14===V?(za=this.kG.QW(F))?0===za.iy||za.taskpane&&za.taskpane.isForUILessAction?
this.dR.notifyAgave(F,13===V?11:12):(si.a.gg&&document.activeElement.blur(),13===V?hd.FocusManager.instance().C_e(xh.a.hN):this.oA.H1f(F)):r.ULS.sendTraceTag(512360737,806,10,String.format("Failed to find the cached app with instance Id: {0}",F)):16===V?(V=this.kG.QW(F))?0===V.iy&&this.oA.WYf():r.ULS.sendTraceTag(512360736,806,10,String.format("Failed to find the cached app with instance Id: {0}",F)):17===V||18===V?(V=this.kG.QW(F))?0===V.iy?this.oA.WYf():(si.a.gg&&document.activeElement.blur(),this.oA.H1f(F)):
r.ULS.sendTraceTag(512360735,806,10,String.format("Failed to find the cached app with instance Id: {0}",F)):1===V||10===V?(V=this.kG.QW(F))?0===V.iy&&this.dR.yHh(F):r.ULS.sendTraceTag(512360734,806,10,String.format("Failed to find the cached app with instance Id: {0}",F)):8===V?(F={["ak1"]:this.dR.Ui.getManifestInvaildErrorString()},this.lo.gH().Ka(Pc.a.GOb,2,F)):15===V?(F=this.oA.$Jl(F))&&(V=this.dR.Jxb(F))&&V.taskpane&&!V.taskpane.isForUILessAction&&this.dR.notifyAgave(F,11):23===V?ca.a.sendOtelEvent(Object.assign(new lj.a,
{otelEvent:za})):38===V?ca.a.sendOtelCustomerContent(Object.assign(new lj.a,{otelEvent:za})):32===V?(F=Object(aa.a)(Object,za).solutionId,this.dR.aLf(F)):34===V&&(F=Object(aa.a)(Object,za),V=F.controlId,za=new vb("",F.ownerAddinSolutionId,new oc,!0),F.originalControlId=za?za.lRf(V):V)}WIb(F,V){this.DJc&&V&&(this.cCe=V)}static aJ(F){return Telemetry.PrivacyRules.GetPrivacyCompliantId(F.solutionId,F.storeType,F.assetId,null,null,F.storeId)}}Object(h.a)(wk,"AppForOfficeAppEventHandler",null,[695]);var bl=
d(251),ea=d(1262);class Gj{static idi(F){var V=F.getAttribute("style");V=V?V.toString():"";0>V.indexOf("pointer-events: auto")&&F.className!==Gj.JMb&&(id.a("Microsoft.Office.SharedOnline.FixBug6808089")?F.style.pointerEvents="auto":F.setAttribute("style",V+" pointer-events: auto"))}static Zxf(F){var V=F.getAttribute("style");V=V?V.toString():"";0>V.indexOf("pointer-events: none")&&F.className===Gj.JMb&&(id.a("Microsoft.Office.SharedOnline.FixBug6808089")?F.style.pointerEvents="none":F.setAttribute("style",
V+" pointer-events: none"))}static E6k(F){var V=F.getAttribute("style");V=V?V.toString():"";0<=V.indexOf("pointer-events: none")&&F.className===Gj.JMb&&(id.a("Microsoft.Office.SharedOnline.FixBug6808089")?F.style.pointerEvents="":(V=V.replace("pointer-events: none",""),F.setAttribute("style",V)))}}Gj.Gdl="AppForOfficeContainer EditAppForOfficeContainer";Gj.JMb="AppForOfficeContainer EditAppForOfficeHidden EditAppForOfficeContainer";Gj.PXe="";Object(h.a)(Gj,"AppForOfficeViewHelper",null,[]);var Hj=
d(986),mj=d(137);class Dl{constructor(F,V,za,gb,Fb){this.pA=this.Exg=null;this.CIa=!1;this.nA=V;this.Sk=za;V&&V.taskpane&&V.taskpane.isForUILessAction?(this.pA=null,this.Exg=za):(this.pA=new mj.a,this.pA.qe.className=Gj.JMb,this.pA.qe.id="AppForOffice_"+this.nA.instanceId,this.pA.qe.style.width="100%",this.pA.qe.style.height="100%",this.pA.qe.style.position="relative",this.pA.qe.style.left="0",this.pA.qe.style.top="0",za.appendChild(this.pA.qe));this.Oc=Fb}dispose(){this.u5k();this.nA=null}u5k(){this.pA&&
this.pA.Dq()}uZe(F){F&&this.pA&&F!==this.Sk&&(this.Sk=F,F.appendChild(this.pA.qe),this.CIa&&this.lea())}$Ca(F){F&&(F.qe.innerHTML="")}Sul(F,V,za=null,gb=null,Fb=!1){this.sai(F,V,za,gb,Fb)}oIc(F,V,za){V=this.bpc(V);F.insertBlankControlWithErrorUX(V,()=>{za()})}sai(F,V,za=null,gb=null,Fb=!1){this.CIa=Fb;this.$Ca(this.pA);this.nA&&F&&(this.ELa(V,null),V=this.bpc(this.pA?this.pA.qe:this.Exg,gb,F),V.virtualOsfControlActivationCallback=za,F.insertOsfControl(V),F.setActivationCompletedStatus(this.nA.instanceId,
!0),Fb&&this.lea())}lea(){if(this.pA){var F=this.pA.va;if(F){var V=F.parentNode;V&&"OsfAddinOverlay"!==V.className&&(bl.a.instance.rb(Eg.a.Sfa,V,Object(D.a)(this,this.Xnh,"removePointerEventsStyleHandler")),ea.a.instance.rb(Eg.a.drop,V,Object(D.a)(this,this.Xnh,"removePointerEventsStyleHandler")),bl.a.instance.rb(Eg.a.Tfa,V,Object(D.a)(this,this.jdi,"addPointerEventsStyleHandler")),Gj.Zxf(F))}}}Xnh(F){F=F.mc.target;for(let V=0;V<F.childNodes.length;++V)Gj.E6k(F.childNodes[V]);return!0}jdi(F){F=F.mc.target;
for(let V=0;V<F.childNodes.length;++V)Gj.Zxf(F.childNodes[V]);return!0}ELa(F,V){this.pA&&(F?(null!=V&&this.uZe(V),this.pA.qe.className=""===Gj.PXe?Gj.Gdl:Gj.PXe,Gj.idi(this.pA.va)):(this.pA.qe.className!==Gj.JMb&&(Gj.PXe=this.pA.qe.className),this.pA.qe.className=Gj.JMb))}vZe(F){this.pA&&(this.pA.qe.style.zIndex=String(F))}bpc(F,V=null,za=null){const gb={};gb.div=F;gb.id=this.nA.instanceId;F=this.nA.jp.id;const Fb=this.nA.taskpane?this.nA.taskpane.ownerAddinSolutionId:null;if(za&&Fb){const Ec=this.nA.taskpane.isForUILessAction;
this.nA.qw?gb.sharedRuntimeId=this.nA.qw.Pya:(za=za.getOsfControl(Fb).getManifest(),gb.sharedRuntimeId=this.Oc.getSharedRuntimeId(za,Ec,F,Fb));gb.initialDisplayMode=Ec?1:2}gb.hostInfoFlags=0;gb.sharedRuntimeId?(gb.hostInfoFlags|=1,gb.solutionId=Fb):V?(gb.solutionId=V.assetId,gb.sourceLocationOverrideResourceId=V.sourceLocationOverrideResourceId,gb.featureGates=z.AFrameworkApplication.fa.yhj(V.assetId)):gb.solutionId=F;gb.version=this.nA.jp.version;gb.storeId=this.nA.jp.store;gb.storeType=this.nA.jp.storeType;
gb.assetId=null;gb.assetStoreId=null;gb.settings=this.nA.settings;V&&OSF.OsfControl.isFirstPartyStoreString(this.nA.jp.storeType)&&(gb.hostSettings=OSF.OUtil.serializeSettings(V.nonPersistedSettings));gb.reason=Hj.a.contains(this.nA.jp.id,this.nA.iy,this.nA.jp.store,this.nA.jp.storeType,this.nA.jp.version)?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;0===this.nA.iy?gb.osfControlType=0:1===this.nA.iy&&(gb.osfControlType=
1);z.AFrameworkApplication.Qca||OSF.OsfControl.isFirstPartyStoreString(gb.storeType)||(r.ULS.sendTraceTag(512369924,802,50,(0===this.nA.iy?"Content":"Taskpane")+" web add-in disabled by doc IRM"),gb.hostInfoFlags|=4);this.nA.taskpane?(gb.isForUILessAction=this.nA.taskpane.isForUILessAction,gb.ownerAddinSolutionId=Fb,gb.ownerAddinStoreType=this.nA.taskpane.ownerAddinStoreType):gb.isForUILessAction=!1;return gb}}Object(h.a)(Dl,"AppForOfficeView",null,[671]);var Ai=d(277),nj=d(78);class Bi{constructor(F,
V,za,gb,Fb,Ec,$c,Ed,pe,Se,Ye,ae,lg,og,se){new Ai.a(0,0,0,0);this.$dc=this.aec=this.Bdb=this.vO=this.al=null;this.bHe=ResourceStrings.l_AddinPane;this.nb=lf.a.$d();this.Vb=Ec;this.Rc=Ed;this.oA=$c;this.ke=pe;this.pu=F;this.vA=V;this.lo=za;this.sek=gb;this.Ab=Fb;this.Qr=Se;this.Oc=Ye;this.Mc=ae;this.pc=lg;this.vD=og;this.Is=se;this.initialize()}dispose(){this.Rc&&this.al&&(this.Rc.Bb(Eg.a.click,this.al,Object(D.a)(this,this.hDa,"closePaneButtonClickHandler")),this.Qr.removeHandler(this.al,Eg.a.Bf,Object(D.a)(this,
this.Wfg,"handleShortCutsOnCloseButton")),this.al=null);this.Mc.hkb(Object(D.a)(this,this.Sw,"onUnifiedAppStateChanged"));this.Vb.dMb(Object(D.a)(this,this.tY,"onSetOffline"));this.oA.Tnh(this)}initialize(){const F="label_"+this.vA,V="icon_"+this.vA;this.nb.className=this.pu?"AddinPane AddinPaneRTL":"AddinPane AddinPaneLTR";if(Object(id.a)("AddClassOnSDXPaneContainer")&&this.Is){const za=this.Is.GHh;za&&(this.nb.className+=" "+za)}this.nb.style.position="absolute";this.nb.style.display="none";this.nb.setAttribute(Nf.a.hf,
Nf.a.lsa);this.nb.setAttribute(Nf.a.e_,F);this.al=this.uDa("per","ClosePaneGlyph_16x16x32");Sys.UI.DomElement.addCssClass(this.al,"AddinPaneCloseButton");this.Rc.rb(Eg.a.click,this.al,Object(D.a)(this,this.hDa,"closePaneButtonClickHandler"));this.Qr.addHandler(this.al,Eg.a.Bf,Object(D.a)(this,this.Wfg,"handleShortCutsOnCloseButton"));this.nb.appendChild(this.al);this.lo.rd.ZF&&(Object(id.a)("AddInPaneHeaderEnhancement")?this.ill():Object(id.a)("TempHeaderIconForActionAI")&&this.Is&&"ActionAITaskPane"===
this.Is.GHh&&(this.aec=lf.a.sB(),this.aec.className="PaneIcon",this.aec.id=V,this.aec.src="https://fa000000121.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.1.2303.9002/en-us_web/assets/M365Orange.svg",this.nb.appendChild(this.aec)));this.Bdb=lf.a.$d();this.Bdb.className="PaneLabel";this.Bdb.id=F;this.Bdb.setAttribute(Nf.a.hf,Nf.a.dDf);this.Bdb.setAttribute(Nf.a.n0b,"1");this.nb.appendChild(this.Bdb);this.vO=lf.a.$d();this.vO.className="AddinPanePanelResize";this.nb.appendChild(this.vO);
this.Mc.i8(Object(D.a)(this,this.Sw,"onUnifiedAppStateChanged"));this.Vb.JQa(Object(D.a)(this,this.tY,"onSetOffline"))}ill(){var F,V,za;const gb="icon_"+this.vA;Rb.c()?(null===(V=this.Is)||void 0===V?0:V.HHh)?(this.$dc=lf.a.$d(),this.$dc.className="PaneIcon",this.$dc.id=gb,null===appChrome||void 0===appChrome?void 0:appChrome.api.renderIcon(this.Is.HHh,this.$dc),this.nb.appendChild(this.$dc)):Le.a.J(509120517,811,50,"No Header Icon for current pane:{0}",null===(za=this.Is)||void 0===za?void 0:za.ZA):
Le.a.J(508966294,811,10,"appChrome not loaded yet for pane:{0}",null===(F=this.Is)||void 0===F?void 0:F.ZA)}Sw(F,V){V.$bb&&!this.pc.Pn&&this.isVisible&&this.ohg()}tY(F){F&&this.isVisible&&(Object(id.a)("FixAddInPaneVisibilityInOfflineMode")&&this.Oc.oQc(this.vA),this.ohg())}ohg(){this.Xp(!1);this.lo.gH().Ka(Pa.a.XYc,2,this.vA);this.Vqe()||this.dispose()}layout(F,V){const za=V?F.MD(this.width):F.ND(this.width);this.isVisible&&(V?za.MD(1):za.ND(1),this.vO.style.height=(F.height-this.al.clientHeight-
this.Bdb.clientHeight).toString()+"px",this.vO.style.width="100%");lf.a.O1(this.nb,za);return F}epl(F){this.bHe=F}Xp(F){const V=this.Ab!==F;if(this.Ab=F)this.nb.style.display="block";const za=this.Vqe();this.vD.Kll(this.vA,za);let gb=this.bHe;Object(id.a)("TaskPaneToolTip")&&this.lo.rd.iA?this.Is&&this.Is.JHh?gb=this.Is.JHh:this.Is&&(gb=this.Is.ZA):gb=this.Is?this.Is.ZA:this.bHe;this.vD.qK(this,this.Ab,gb,this.vA);za&&(this.al.style.visibility=F?"visible":"hidden",V&&this.Oc.I5i(this.vA,F))}Vqe(){return this.Oc.Qua(this.vA)}hDa(){this.Xp(!1);
this.lo.gH().Ka(Pa.a.XYc,2,this.vA);this.Vqe()||this.dispose();return!0}tDa(F,V,za,gb,Fb,Ec){const $c=lf.a.sB();$c.alt=Fb;$c.className=nj.getImageClassWithCluster(F,gb);$c.src=this.ke.qk(F+".png");$c.setAttribute("Unselectable","on");F=lf.a.Il();F.className=V+" cui-img-cont-float";F.appendChild($c);V=lf.a.Il();V.className=za;V.setAttribute("Unselectable","on");V.appendChild(F);za=lf.a.kda();za.className="CommentPaneNoBorderButton cui-ctl";za.title=Fb;za.setAttribute(Nf.a.hf,Nf.a.Ju);za.tabIndex=0;
za.appendChild(V);Ec&&(Fb=lf.a.Il(),Fb.className="cui-ctl-mediumlabel",Fb.setAttribute("Unselectable","on"),Fb.innerText=Ec,za.appendChild(Fb));return za}uDa(F,V){return this.tDa(F,"cui-img-16by16","cui-ctl-iconContainer",V,CommonUIStrings.l_DialogClose,null)}Wfg(F){F.keyCode===yf.a.Dp||F.keyCode===yf.a.zK?(this.hDa(null),F.preventDefault(),F.stopPropagation()):F.keyCode===yf.a.$q&&(F.shiftKey?this.Oc.notifyAgave(this.vA,12):this.Oc.notifyAgave(this.vA,11),F.preventDefault(),F.stopPropagation())}get isVisible(){return this.Ab}get va(){return this.nb}get order(){return 6}get width(){return this.isVisible?
this.sek:0}get RJc(){return this.vO}get mCi(){return this.al}get id(){return this.vA}}Object(h.a)(Bi,"AddInPane",null,[694,587,107]);class El{constructor(F,V,za,gb,Fb,Ec,$c,Ed,pe,Se){this.lo=F;this.Vb=V;this.oA=za;this.Rc=gb;this.ke=Fb;this.qR=Ec;this.Oc=$c;this.Mc=Ed;this.pc=pe;this.vD=Se}aOc(F,V,za,gb,Fb){return new Bi(F,V,this.lo,za,gb,this.Vb,this.oA,this.Rc,this.ke,this.qR,this.Oc,this.Mc,this.pc,this.vD,Fb)}z3(F){return new le.a(F)}BJi(F){return new wk(this.Oc,this.lo,this.Vb,F,this.oA)}t0d(F,
V,za,gb,Fb){return new Dl(F,V,za,gb,Fb)}}Object(h.a)(El,"AppforOfficeClassFactory",null,[670]);class te{constructor(F){this.xDg=this.nR=!1;this.Pl=$h.a.jZ();this.Yxg=F;Ii.r0k(this.Yxg)}dw(){this.xDg=!0}dispose(){if(this.xDg&&!this.nR){var F=$h.a.jZ();Ii.q0k(this.Yxg,this.Pl,F);this.nR=!0}}}Object(h.a)(te,"ApiCallLogger",null,[107]);class sm{get formatting(){return 0}set formatting(F){}get sourceSlideIds(){return null}set sourceSlideIds(F){}get targetSlideId(){return null}set targetSlideId(F){}getTypeName(){return"Microsoft.Office.PowerPoint.InsertSlideOptions"}invokePropertyGet(F){switch(F){case 1:return this.formatting;
case 4:return this.sourceSlideIds;case 5:return this.targetSlideId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertyGetAsync(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}invokePropertySet(F,V){switch(F){case 1:this.formatting=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"int");return;case 4:this.sourceSlideIds=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"Array<string>");return;
case 5:this.targetSlideId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertySetAsync(F,V){this.invokePropertySet(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokeMethodAsync(F,V){F=this.invokeMethod(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}}
Object(h.a)(sm,"InsertSlideOptions",null,[]);class Zl{constructor(){this.controlId=this.appId=null}}Object(h.a)(Zl,"RequestContext",null,[]);class Ji{constructor(){this.vtf=this.cmf=null}get layoutId(){return this.cmf}set layoutId(F){this.cmf=F}get slideMasterId(){return this.vtf}set slideMasterId(F){this.vtf=F}getTypeName(){return"Microsoft.Office.PowerPoint.AddSlideOptions"}invokePropertyGet(F){switch(F){case 1:return this.layoutId;case 2:return this.slideMasterId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
}invokePropertyGetAsync(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}invokePropertySet(F,V){switch(F){case 1:this.layoutId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"string");return;case 2:this.slideMasterId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertySetAsync(F,V){this.invokePropertySet(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
}invokeMethodAsync(F,V){F=this.invokeMethod(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}}Object(h.a)(Ji,"AddSlideOptions",null,[]);class Qe{constructor(F,V,za){this.bec=F;this.u0=V;this.Oc=za}getAppRuntimeStartState(){if(!this.Oc.Qua(this.u0))throw Error.invalidOperation("GetAppRuntimeStartState: Invalid controlId or it is not shared runtime.");return this.Oc.L$i(this.bec)?1:0}setAppRuntimeStartState(F){if(!this.Oc.Qua(this.u0)||0!==F&&1!==F)throw Error.invalidOperation("SetAppRuntimeStartState: Invalid controlId or state, or it is not shared runtime.");
this.Oc.OKl(this.bec,1===F)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimePersistenceService"}invokePropertyGet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertyGetAsync(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}invokePropertySet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertySetAsync(F,V){this.invokePropertySet(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(F,
V){switch(F){case 2:return this.Faj();case 1:return this.cjl(V)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokeMethodAsync(F,V){F=this.invokeMethod(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}Faj(){return this.getAppRuntimeStartState()}cjl(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"int");this.setAppRuntimeStartState(F);return null}}Object(h.a)(Qe,"AppRuntimePersistenceService",null,[]);class $l{constructor(F,V){this.u0=
F;this.Oc=V}getAppRuntimeState(){if(!this.Oc.Qua(this.u0))throw Error.invalidOperation("GetAppRuntimeState: Invalid controlId or it is not shared runtime.");return this.Oc.K$i(this.u0)?2:1}setAppRuntimeState(F){if(!this.Oc.Qua(this.u0)||2!==F&&1!==F)throw Error.invalidOperation("GetAppRuntimeState: Invalid controlId or state, or it is not shared runtime.");this.Oc.qNb(this.u0,2===F)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
}invokePropertyGetAsync(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}invokePropertySet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertySetAsync(F,V){this.invokePropertySet(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(F,V){switch(F){case 2:return this.Gaj();case 1:return this.djl(V)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokeMethodAsync(F,
V){F=this.invokeMethod(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}Gaj(){return this.getAppRuntimeState()}djl(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"int");this.setAppRuntimeState(F);return null}}Object(h.a)($l,"AppRuntimeService",null,[]);class mk{insertHyperLink(){}insertSlideFromContent(){return 0}getTypeName(){return"Microsoft.Office.PowerPoint.Application"}invokePropertyGet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
}invokePropertyGetAsync(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}invokePropertySet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertySetAsync(F,V){this.invokePropertySet(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(F,V){switch(F){case 1001:return this.RPj(V);case 1002:return this.lQj(V)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
}invokeMethodAsync(F,V){F=this.invokeMethod(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}RPj(F){const V=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,1,"string");this.insertHyperLink(V,F);return null}lQj(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");return this.insertSlideFromContent(F)}}Object(h.a)(mk,"Application",null,[]);class zf{constructor(F,V){this.KG=
!1;this._id=F;this.yLd=V}get enabled(){return this.KG}set enabled(F){this.KG=F;z.AFrameworkApplication.Ra.Ka(Pc.a.H5b,2,{["DynamicAddinCommandsMethodDispatchId"]:1,["SolutionId"]:this.yLd,["SourceControlId"]:this.id,["MethodData"]:this.enabled})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(F){switch(F){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
}invokePropertyGetAsync(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}invokePropertySet(F,V){switch(F){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertySetAsync(F,V){this.invokePropertySet(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(F,V){switch(F){case 5:return this.ykl(V);
case 1:return this.jI()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokeMethodAsync(F,V){F=this.invokeMethod(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}ykl(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"boolean");this.setEnabled(F);return null}jI(){this._OnAccess();return null}}Object(h.a)(zf,"RibbonButton",null,[]);class Jf{constructor(){}get id(){return null}setVisibility(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(F){switch(F){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
}invokePropertyGetAsync(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}invokePropertySet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertySetAsync(F,V){this.invokePropertySet(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(F,V){switch(F){case 3:return this.Gpl(V);case 1:return this.jI()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokeMethodAsync(F,
V){F=this.invokeMethod(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}Gpl(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"boolean");this.setVisibility(F);return null}jI(){this._OnAccess();return null}}Object(h.a)(Jf,"RibbonTab",null,[]);class Fl{constructor(F,V){this.INa=this.cB=this.xEc=null;this.vqa=F;this.A3a=V;fa.a.Xa(this.vqa)||(this.INa=V.Jxb(F),this.xEc=(this.cB=this.A3a?this.A3a.Ui:null)?this.cB.getOsfControl(this.vqa):null)}get buttons(){return null}executeRequestCreate(){return null}executeRequestUpdate(){return null}getButton(F){let V=
null;if(!this.Fng())return this.tOf();if(!fa.a.Xa(F)&&this.INa&&this.INa.taskpane){if(!this.EJf(F))return this.HOf(F);V=new zf(F,this.INa.taskpane.ownerAddinSolutionId)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(V)}getTab(F){let V=null;if(!this.Fng())return this.tOf();if(!fa.a.Xa(F)&&this.INa&&this.INa.taskpane){if(!this.EJf(F))return this.HOf(F);V=new Jf(F)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(V)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(F){switch(F){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
}invokePropertyGetAsync(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}invokePropertySet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertySetAsync(F,V){this.invokePropertySet(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(F){switch(F){case 1:return this.jI()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokeMethodAsync(F,V){switch(F){case 7:return this.L0i(V);
case 6:return this.M0i(V);case 3:return this.Cbj(V);case 5:return this.euj(V)}F=this.invokeMethod(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}L0i(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");return this.executeRequestCreate(F)}M0i(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");return this.executeRequestUpdate(F)}Cbj(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");return this.getButton(F)}euj(F){F=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");return this.getTab(F)}jI(){this._OnAccess();return null}HOf(F){return this.UOf("ControlIdNotFound",ResourceStrings.L_RichApiErrorMessage_ControlIdNotFound+F)}tOf(){return this.UOf("ApiNotAvailable",ResourceStrings.L_RichApiErrorMessage_ApiNotAvailable)}Fng(){const F=!fa.a.Xa(this.xEc.getSharedRuntimeId());Le.a.J(512497821,802,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",F));return F}EJf(F){if(this.xEc){var V=
this.xEc.getManifest();if(V&&(V=V.getRibbonExtensionControlMap()))return F in V||this.Kyi(F)}return!1}Kyi(F){var V=this.d5i();if(V){V=V.CVf;for(const za of V.tabs){if(za.id===F)return!0;for(const gb of za.groups)for(const Fb of gb.controls){if(Fb.id===F)return!0;if("Menu"===Fb.type){V=Fb;for(const Ec of V.items)if(Ec.id===F)return!0}}}}return!1}d5i(){return C.getInstance().l$a(this.INa.taskpane.ownerAddinStoreType,this.INa.taskpane.ownerAddinSolutionId,1)}UOf(F,V){return OfficeExtension.WacRuntime.Utility.createPromise((za,
gb)=>{gb(OfficeExtension.WacRuntime.Utility.createRichApiException(F,V))})}}Object(h.a)(Fl,"DynamicRibbon",null,[]);class Cc{constructor(F,V,za,gb){this.ncf="";this.PAc=0;this.FG=F;this._id=V;this.dXb=za;this.A3a=gb}get id(){return this._id}_RegisterStateChange(){this.PAc||this.FG.execute(F=>{OfficeExtension.WacRuntime.RichApi.getEventManager().register(this.dXb,this._id,1);this.ncf=F.v0a(this._id,V=>{this.A3a.K5i(this.dXb,this._id,JSON.stringify(V))})});this.PAc++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.PAc--;
this.PAc||this.FG.execute(F=>{F.akb(this._id,this.ncf)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(F){switch(F){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertyGetAsync(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}invokePropertySet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
}invokePropertySetAsync(F,V){this.invokePropertySet(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokeMethodAsync(F,V){switch(F){case 6:return this.hTh();case 7:return this.mTh()}F=this.invokeMethod(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}hTh(){return this._RegisterStateChange()}mTh(){return this._UnregisterStateChange()}}Object(h.a)(Cc,"LicenseFeature",
null,[]);class uo{get scopes(){return null}set scopes(F){}getTypeName(){return"Microsoft.Office.Licensing.MsaDeviceTicketOptions"}invokePropertyGet(F){switch(F){case 1:return this.scopes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertyGetAsync(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}invokePropertySet(F,V){switch(F){case 1:this.scopes=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"string");
return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertySetAsync(F,V){this.invokePropertySet(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokeMethodAsync(F,V){F=this.invokeMethod(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}}Object(h.a)(uo,"MsaDeviceTicketOptions",null,[]);class gn{constructor(F,V){this.FG=fc.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");
this.dXb=F;this.A3a=V}getFeatureTier(F,V){return OfficeExtension.WacRuntime.Utility.createPromise(za=>{const gb=1===V?1:2===V?2:0;this.FG.execute(Fb=>{Fb.getFeatureTier(F,gb).then(Ec=>{za(this.ckj(Ec))},()=>{za(V)})})})}getLicenseFeature(F){F=new Cc(this.FG,F,this.dXb,this.A3a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}getMsaDeviceTicket(){return null}isFeatureEnabled(F,V){return OfficeExtension.WacRuntime.Utility.createPromise(za=>{this.FG.execute(gb=>{gb.isFeatureEnabled(F,
V).then(Fb=>{za(Fb)},()=>{za(V)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(F=>{this.FG.execute(V=>{V=V.isFreemiumUpsellEnabled();F(V)})})}launchUpsellExperience(F){if(this.A3a.Ui.getOsfControl(this.dXb).isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.FG.execute(V=>{V.launchUpsellExperience(F)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException("AccessDenied","");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
}invokePropertyGetAsync(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}invokePropertySet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertySetAsync(F,V){this.invokePropertySet(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(F,V){switch(F){case 7:return this.Rlj(V);case 6:return this.jTh(V)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokeMethodAsync(F,
V){switch(F){case 2:return this.Zgj(V);case 5:return this.bkj(V);case 1:return this.yWj(V);case 3:return this.lXj();case 4:return this.d8j(V)}F=this.invokeMethod(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}Zgj(F){const V=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,1,"int");return this.getFeatureTier(V,F)}bkj(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");
return this.getLicenseFeature(F)}Rlj(F){const V=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string"),za=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,1,"string");F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,2,uo);return this.getMsaDeviceTicket(V,za,F)}yWj(F){const V=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,1,"boolean");return this.isFeatureEnabled(V,F)}lXj(){return this.isFreemiumUpsellEnabled()}d8j(F){F=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");return this.launchUpsellExperience(F)}jTh(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");this._TestFireStateChangedEvent(F);return null}ckj(F){switch(F){case 1:return 1;case 2:return 2;default:return 0}}}Object(h.a)(gn,"License",null,[]);class Lh{get height(){return 0}set height(F){}get left(){return 0}set left(F){}get top(){return 0}set top(F){}get width(){return 0}set width(F){}getTypeName(){return"Microsoft.Office.PowerPoint.ShapeAddOptions"}invokePropertyGet(F){switch(F){case 1:return this.height;
case 2:return this.left;case 3:return this.top;case 4:return this.width}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertyGetAsync(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}invokePropertySet(F,V){switch(F){case 1:this.height=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"number");return;case 2:this.left=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"number");return;case 3:this.top=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"number");return;case 4:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertySetAsync(F,V){this.invokePropertySet(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokeMethodAsync(F,V){F=this.invokeMethod(F,
V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}}Object(h.a)(Lh,"ShapeAddOptions",null,[]);class uh{constructor(F){if(!F)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.HHe=F}areShortcutsInUse(F){return OfficeExtension.WacRuntime.Utility.createPromise((V,za)=>{this.HHe.checkShortcutsInUse(F).then(gb=>{V(gb)}).catch(gb=>{za(gb)})})}getShortcuts(){return OfficeExtension.WacRuntime.Utility.createPromise((F,
V)=>{this.HHe.getShortcuts().then(za=>{F(za)}).catch(za=>{V(za)})})}replaceShortcuts(F){return OfficeExtension.WacRuntime.Utility.createPromise((V,za)=>{this.HHe.replaceShortcuts(F).then(()=>{V(null)}).catch(gb=>{za(gb)})})}getTypeName(){return"Microsoft.Office.ActionService"}invokePropertyGet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertyGetAsync(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}invokePropertySet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
}invokePropertySetAsync(F,V){this.invokePropertySet(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokeMethodAsync(F,V){switch(F){case 3:return this.bni(V);case 1:return this.dsj();case 2:return this.m$k(V)}F=this.invokeMethod(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}bni(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"Array<string>");
return this.areShortcutsInUse(F)}dsj(){return this.getShortcuts()}m$k(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"any");return this.replaceShortcuts(F)}}Object(h.a)(uh,"ActionService",null,[]);class Wi{constructor(){this.data=null}}Object(h.a)(Wi,"AugLoopHostMessageReceivedEventArgs",null,[]);var tm=d(706);class Dk{constructor(F,V=!1,za=null){this.vqa=F;this.DCc=V;this.tEd=za||OfficeExtension.WacRuntime.RichApi.getEventManager()}sendMessage(F){this.DCc||tm.a.wvh(F)}_RegisterHostMessageReceivedEvent(){this.DCc||
(Dk.Tmh||(tm.a.Imh(F=>{this.tEd.fireEvent("",65542,Object.assign(new Wi,{data:F}))}),Dk.Tmh=!0),this.tEd.register(this.vqa,"",65542))}_UnregisterHostMessageReceivedEvent(){this.DCc||this.tEd.unregister(this.vqa,"",65542)}getTypeName(){return"Microsoft.Office.AugLoopEventService"}invokePropertyGet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertyGetAsync(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}invokePropertySet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
}invokePropertySetAsync(F,V){this.invokePropertySet(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(F,V){switch(F){case 1:return this.vhl(V);case 2:return this.gTh();case 3:return this.lTh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokeMethodAsync(F,V){F=this.invokeMethod(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}vhl(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");
this.sendMessage(F);return null}gTh(){this._RegisterHostMessageReceivedEvent();return null}lTh(){this._UnregisterHostMessageReceivedEvent();return null}}Dk.Tmh=!1;Object(h.a)(Dk,"AugLoopEventService",null,[]);var Va=d(337),vh=d(252);class Ol{constructor(F,V,za){this.vPa=this.chf=null;this.vqa=F;this.gpf=V;if(this.Oa=za)this.chf=this.Oa.Ha("GetAccessTokenOAuthFirstPartyAllowList")}Gmj(){this.vPa||(this.vPa=vh.a.Lt(fc.a.instance.Ia("Common.App.OAuth.IOAuthManager")));return this.vPa}xXj(F,V){if(!this.gpf||
""===this.vqa||!this.Oa)return!1;const za=this.gpf.getOsfControl(this.vqa);if(!za)return!1;let gb=!1;this.chf.split(";").forEach(Fb=>{V===Fb&&(gb=!0)});return this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthManagerAPI",!1)&&1===z.AFrameworkApplication.Aa.ob.zk&&za.isFirstParty()&&F===Ol.Cki&&gb&&Xh.d(za.getSolutionId())===Ol.Dki}getAccessTokenFirstPartyOAuth(F,V){let za;za=this.xXj(F,V)?gb=>{const Fb=this.Gmj();Fb.continueWith(()=>{Fb.result.gI(F,V).then(Ec=>{gb(Ec);return Ec})})}:
gb=>{gb(Object.assign(new Va.a,{IsSuccess:!1,Token:null,ErrorCode:"NotEnabled",ErrorMessage:"OAuthManager is disabled."}))};return OfficeExtension.WacRuntime.Utility.createPromise(za)}getTypeName(){return"Microsoft.Office.Auth"}invokePropertyGet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertyGetAsync(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}invokePropertySet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
}invokePropertySetAsync(F,V){this.invokePropertySet(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokeMethodAsync(F,V){switch(F){case 1:return this.u$i(V)}F=this.invokeMethod(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}u$i(F){const V=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,
1,"string");return this.getAccessTokenFirstPartyOAuth(V,F)}}Ol.Cki="Maker";Ol.Dki="fa000000043";Object(h.a)(Ol,"Auth",null,[]);var hn=d(3);class Ij{constructor(){this.bQa=null}asj(){this.bQa||(this.bQa=vh.a.Lt(fc.a.instance.Ia("Common.App.SharedFilePicker.ISharedFilePicker")));return this.bQa}getSharedFilePickerResponse(F){return OfficeExtension.WacRuntime.Utility.createPromise((V,za)=>{try{const gb=this.asj();hn.Task.WAA.call(null,gb).continueWith(()=>{const Fb=gb.result;if(Fb){let Ec={};({Nu:Ec}=
Z.d(F)).returnValue?Fb.pVc(Ec).then($c=>{$c&&0<$c.length?V($c):za(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker returned null or an empty array."))}).catch($c=>{za($c)}):za(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else za(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker is resolved as null."))})}catch(gb){za(gb)}})}getTypeName(){return"Microsoft.Office.SharedFilePicker"}invokePropertyGet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
}invokePropertyGetAsync(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}invokePropertySet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertySetAsync(F,V){this.invokePropertySet(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokeMethodAsync(F,V){switch(F){case 1:return this.$rj(V)}F=this.invokeMethod(F,
V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}$rj(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");return this.getSharedFilePickerResponse(F)}}Object(h.a)(Ij,"SharedFilePicker",null,[]);class Mk{createInstance(F,V,za="",gb=null,Fb=null){switch(F){case "Microsoft.Office.ActionService":return new uh(V);case "Microsoft.Office.SharedFilePicker":return new Ij;case "Microsoft.Office.Auth":return new Ol(za,gb,Fb);case "Microsoft.Office.AugLoopEventService":return new Dk(za)}return null}}
Object(h.a)(Mk,"WacApiHost",null,[]);class ig{constructor(F,V,za){this.pmd=!1;this.dDg=!0;this.IHe=null;this.bec=F;this.u0=V;this.Oc=za}hostName(){return"PowerPointOnline"}appId(){return this.bec}controlId(){return this.u0}createInstance(F){switch(F){case "Microsoft.Office.PowerPoint.AddSlideOptions":return new Ji;case "Microsoft.Office.PowerPoint.Application":return new mk;case "Microsoft.Office.PowerPoint.InsertSlideOptions":return new sm;case "Microsoft.Office.PowerPoint.ShapeAddOptions":return new Lh;
case "Microsoft.AppRuntime.AppRuntimeService":return new $l(this.u0,this.Oc);case "Microsoft.AppRuntime.AppRuntimePersistenceService":return new Qe(this.bec,this.u0,this.Oc);case "Microsoft.Office.Licensing.License":return new gn(this.u0,this.Oc);case "Microsoft.DynamicRibbon.DynamicRibbon":return new Fl(this.u0,this.Oc);case "Microsoft.Office.AugLoopEventService":const V=this.Oc.Ui.getOsfControl(this.u0);if(null===V||void 0===V?0:V.isFirstParty())return this.IHe||(this.IHe=new Mk),F=this.IHe.createInstance(F,
null,this.u0),F.DCc=this.pmd,F}r.ULS.sendTraceTag(509085406,802,10,"Typename: {0} is an invalid parameter. Only instance for Application can be created through this method.",F);return null}static Eq(F){const V=fc.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManager").Dwf;F||(V.dDg=!1);return!V.pmd}}Object(h.a)(ig,"RichApiHost",null,[611]);class Dh{constructor(F,V,za){this.iAd=this.Yh=-1;this.xC=za;0<=F&&(this.Yh+=F,this.iAd=0<V?F+V<this.xC.getCount()?F+V:this.xC.getCount():this.xC.getCount())}get_current(){return-1<
this.Yh&&this.Yh<this.iAd?this.xC.getItemAt(this.Yh):null}moveNext(){const F=this.mKl();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}mKl(){return this.Yh+1<this.iAd?(this.Yh++,!0):!1}}Object(h.a)(Dh,"ElementEnumerator",null,[753]);class zb{constructor(F,V){this.t6a=F;this.MS=V}get fill(){ig.Eq(!1);return null}get height(){ig.Eq(!1);return 0}set height(F){ig.Eq(!1)}get id(){const F=new te(28);try{Le.a.J(572643292,802,50,"PptApi Call - Shape.GetId");if(!this.t6a)return Le.a.J(577525073,
802,10,"Shape is null."),"";const V=this.t6a.get_shapeId().toString();F.dw();return V}finally{F&&F.dispose()}}get left(){ig.Eq(!1);return 0}set left(F){ig.Eq(!1)}get lineFormat(){ig.Eq(!1);return null}get name(){ig.Eq(!1);return null}set name(F){ig.Eq(!1)}get tags(){ig.Eq(!1);return null}get textFrame(){ig.Eq(!1);return null}get top(){ig.Eq(!1);return 0}set top(F){ig.Eq(!1)}get type(){ig.Eq(!1);return 0}get width(){ig.Eq(!1);return 0}set width(F){ig.Eq(!1)}deleteObject(){if(ig.Eq(!0)){var F=new te(45);
try{Le.a.J(572527067,802,50,"PptApi Call - Shape.Delete");const V=Object(aa.a)(118,this.MS);V&&(V.DSi(Object(aa.a)(4,this.t6a)),F.dw())}finally{F&&F.dispose()}}}getParentSlide(){ig.Eq(!1);return null}getParentSlideLayout(){ig.Eq(!1);return null}getParentSlideLayoutOrNullObject(){ig.Eq(!1);return null}getParentSlideMaster(){ig.Eq(!1);return null}getParentSlideMasterOrNullObject(){ig.Eq(!1);return null}getParentSlideOrNullObject(){ig.Eq(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.Shape"}invokePropertyGet(F){switch(F){case 11:return this.fill;
case 5:return this.height;case 1:return this.id;case 6:return this.left;case 12:return this.lineFormat;case 7:return this.name;case 3:return this.tags;case 13:return this.textFrame;case 8:return this.top;case 9:return this.type;case 10:return this.width}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertyGetAsync(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}invokePropertySet(F,V){switch(F){case 5:this.height=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"number");return;case 6:this.left=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"number");return;case 7:this.name=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"string");return;case 8:this.top=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"number");return;case 10:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
}invokePropertySetAsync(F,V){this.invokePropertySet(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(F){switch(F){case 4:return this.V2d();case 15:return this.vnj();case 16:return this.wnj();case 18:return this.xnj();case 17:return this.ynj();case 19:return this.znj();case 20:return this.Anj();case 2:return this.jI()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokeMethodAsync(F,V){F=this.invokeMethod(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}V2d(){this.deleteObject();
return null}vnj(){return this.getParentSlide()}wnj(){return this.getParentSlideLayout()}xnj(){return this.getParentSlideLayoutOrNullObject()}ynj(){return this.getParentSlideMaster()}znj(){return this.getParentSlideMasterOrNullObject()}Anj(){return this.getParentSlideOrNullObject()}jI(){this._OnAccess();return null}}Object(h.a)(zb,"Shape",null,[]);class dj{constructor(F){this.WUb=this.xrb=null;this.MS=F;if(F=Object(aa.a)(118,this.MS))this.xrb=F.sUa();this.IPk()}IPk(){this.WUb=new ka.ScriptSharpLegacyMap;
if(this.xrb)for(const F of this.xrb){const V=new zb(F,this.MS);this.WUb.add(V.id,V)}}addGeometricShape(){ig.Eq(!1);return null}addLine(){ig.Eq(!1);return null}addTextBox(){ig.Eq(!1);return null}getCount(){const F=new te(29);try{Le.a.J(572643288,802,50,"PptApi Call - ShapeCollection.GetCount");if(!this.xrb)return Le.a.J(577525071,802,50,"In Shape.GetCount(), _shapes is null"),0;F.dw();return this.xrb.length}finally{F&&F.dispose()}}getItem(F){const V=new te(31);try{Le.a.J(572643289,802,50,"PptApi Call - ShapeCollection.GetItem");
try{const za=this.WUb.ga(F);V.dw();return za}catch(za){throw Le.a.J(577525069,802,15,String.format("In Shape.GetItem(id), Exception: {0} ",za.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItem(id)");}}finally{V&&V.dispose()}}getItemAt(F){const V=new te(30);try{Le.a.J(572643290,802,50,"PptApi Call - ShapeCollection.GetItemAt");try{const za=this.xrb[F].get_shapeId().toString(),gb=this.WUb.ga(za);
V.dw();return gb}catch(za){throw Le.a.J(577525067,802,15,String.format("In Shape.GetItemAt(index), Exception: {0} ",za.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");}}finally{V&&V.dispose()}}getItemOrNullObject(F){const V=new te(32);try{Le.a.J(572643291,802,50,"PptApi Call - ShapeCollection.GetItemOrNullObject");let za;({value:za}=this.WUb.wg(F));V.dw();return za}finally{V&&
V.dispose()}}_OnAccess(){}getAsyncEnumerator(F,V){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Dh(F,V,this))}getTypeName(){return"Microsoft.Office.PowerPoint.ShapeCollection"}invokePropertyGet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertyGetAsync(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}invokePropertySet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
}invokePropertySetAsync(F,V){this.invokePropertySet(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(F,V){switch(F){case 6:return this.eci(V);case 7:return this.Cci(V);case 8:return this.lei(V);case 1:return this.Q$a();case 2:return this.fab(V);case 5:return this.eab(V);case 3:return this.gab(V);case 4:return this.jI()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokeMethodAsync(F,V){F=this.invokeMethod(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}eci(F){const V=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"int");F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,1,Lh);return this.addGeometricShape(V,F)}Cci(F){const V=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"int");F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,1,Lh);return this.addLine(V,F)}lei(F){const V=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,1,Lh);
return this.addTextBox(V,F)}Q$a(){return this.getCount()}fab(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");return this.getItem(F)}eab(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"int");return this.getItemAt(F)}gab(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");return this.getItemOrNullObject(F)}jI(){this._OnAccess();return null}}Object(h.a)(dj,"ShapeCollection",null,[740]);class am{constructor(F){this.zGc=F}get id(){const F=
new te(15);try{Le.a.J(572643276,802,50,"PptApi Call - SlideLayout.GetId");if(!this.zGc)return Le.a.J(576581654,802,10,"SlideLayout is null."),"";const V=this.zGc.Id.toString();F.dw();return V}finally{F&&F.dispose()}}get name(){const F=new te(16);try{Le.a.J(572643277,802,50,"PptApi Call - SlideLayout.GetName");if(!this.zGc)return Le.a.J(576581655,802,10,"SlideLayout is null."),"";const V=this.zGc.Name;F.dw();return V}finally{F&&F.dispose()}}get shapes(){ig.Eq(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.SlideLayout"}invokePropertyGet(F){switch(F){case 1:return this.id;
case 3:return this.name;case 4:return this.shapes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertyGetAsync(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}invokePropertySet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertySetAsync(F,V){this.invokePropertySet(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(F){switch(F){case 2:return this.jI()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
}invokeMethodAsync(F,V){F=this.invokeMethod(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}jI(){this._OnAccess();return null}}Object(h.a)(am,"SlideLayout",null,[]);class um{constructor(F){this.XUb=null;this.QYb=F;this.JPk()}JPk(){this.XUb=new ka.ScriptSharpLegacyMap;if(this.QYb)for(const F of this.QYb){const V=new am(F);this.XUb.add(V.id,V)}}getCount(){const F=new te(17);try{Le.a.J(572643272,802,50,"PptApi Call - SlideLayoutCollection.GetCount");if(!this.QYb)return Le.a.J(576581651,
802,50,"In SlideLayouts.GetCount(), _slideLayouts is null"),0;F.dw();return this.QYb.length}finally{F&&F.dispose()}}getItem(F){const V=new te(19);try{Le.a.J(572643273,802,50,"PptApi Call - SlideLayoutCollection.GetItem");try{const za=this.XUb.ga(F);V.dw();return za}catch(za){throw Le.a.J(576581652,802,15,String.format("In SlideLayout.GetItem(id), Exception: {0} ",za.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItem(id)");
}}finally{V&&V.dispose()}}getItemAt(F){const V=new te(18);try{Le.a.J(572643274,802,50,"PptApi Call - SlideLayoutCollection.GetItemAt");try{const za=this.XUb.ga(this.QYb[F].Id.toString());V.dw();return za}catch(za){throw Le.a.J(576581653,802,15,String.format("In SlideLayouts.GetItemAt(index), Exception: {0} ",za.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");}}finally{V&&V.dispose()}}getItemOrNullObject(F){const V=
new te(20);try{Le.a.J(572643275,802,50,"PptApi Call - SlideLayoutCollection.GetItemOrNullObject");let za;({value:za}=this.XUb.wg(F));V.dw();return za}finally{V&&V.dispose()}}_OnAccess(){}getAsyncEnumerator(F,V){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Dh(F,V,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideLayoutCollection"}invokePropertyGet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertyGetAsync(F){F=this.invokePropertyGet(F);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}invokePropertySet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertySetAsync(F,V){this.invokePropertySet(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(F,V){switch(F){case 1:return this.Q$a();case 2:return this.fab(V);case 3:return this.eab(V);case 4:return this.gab(V);case 5:return this.jI()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
}invokeMethodAsync(F,V){F=this.invokeMethod(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}Q$a(){return this.getCount()}fab(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");return this.getItem(F)}eab(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"int");return this.getItemAt(F)}gab(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");return this.getItemOrNullObject(F)}jI(){this._OnAccess();return null}}
Object(h.a)(um,"SlideLayoutCollection",null,[740]);class pl{constructor(F){this.Jrb=F}get id(){const F=new te(21);try{Le.a.J(572643269,802,50,"PptApi Call - SlideMaster.GetId");if(!this.Jrb)return Le.a.J(576581648,802,10,"SlideMaster is null."),"";const V=this.Jrb.Id.toString();F.dw();return V}finally{F&&F.dispose()}}get layouts(){const F=new te(23);try{Le.a.J(572643270,802,50,"PptApi Call - SlideMaster.GetLayouts");if(!this.Jrb)return Le.a.J(576581649,802,10,"SlideMaster is null."),null;const V=
new um(this.Jrb.ContentMasters);F.dw();return V}finally{F&&F.dispose()}}get name(){const F=new te(22);try{Le.a.J(572643271,802,50,"PptApi Call - SlideMaster.GetName");if(!this.Jrb)return Le.a.J(576581650,802,10,"SlideMaster is null."),"";const V=this.Jrb.Name;F.dw();return V}finally{F&&F.dispose()}}get shapes(){ig.Eq(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.SlideMaster"}invokePropertyGet(F){switch(F){case 1:return this.id;case 3:return this.layouts;case 4:return this.name;
case 5:return this.shapes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertyGetAsync(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}invokePropertySet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertySetAsync(F,V){this.invokePropertySet(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(F){switch(F){case 2:return this.jI()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
}invokeMethodAsync(F,V){F=this.invokeMethod(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}jI(){this._OnAccess();return null}}Object(h.a)(pl,"SlideMaster",null,[]);class vm{constructor(F,V){this.MS=F;this.ABa=V}get id(){const F=new te(5);try{Le.a.J(572643283,802,50,"PptApi Call - Slide.GetId");if(!this.MS)return Le.a.J(587747398,802,10,"Slide is null."),"";const V=this.MS.Db.toString();F.dw();return V}finally{F&&F.dispose()}}get layout(){const F=new te(9);try{Le.a.J(572643284,
802,50,"PptApi Call - Slide.GetLayout");const V=this.ABa.mY;for(let za=0;za<V.length;za++){const gb=V[za].ContentMasters;for(let Fb=0;Fb<gb.length;Fb++)if(this.MS.Ln===gb[Fb].Id){const Ec=new am(gb[Fb]);F.dw();return Ec}}throw OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError.toString(),"Slide does not have a Layout.");}finally{F&&F.dispose()}}get shapes(){const F=new te(6);try{Le.a.J(572643285,802,50,"PptApi Call - Slide.GetShapes");const V=
new dj(this.MS);F.dw();return V}finally{F&&F.dispose()}}get slideMaster(){const F=new te(8);try{Le.a.J(572643286,802,50,"PptApi Call - Slide.GetSlideMaster");const V=this.ABa.mY;for(let za=0;za<V.length;za++)if(this.MS.jj===V[za].Id){const gb=new pl(V[za]);F.dw();return gb}throw OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError.toString(),"Slide does not have a SlideMaster.");}finally{F&&F.dispose()}}get tags(){ig.Eq(!1);return null}deleteObject(){if(ig.Eq(!0)){var F=
new te(7);try{Le.a.J(572643287,802,50,"PptApi Call - Slide.Delete"),this.ABa.NI(this.MS),F.dw()}finally{F&&F.dispose()}}}setSelectedShapes(){ig.Eq(!1)}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.Slide"}invokePropertyGet(F){switch(F){case 1:return this.id;case 5:return this.layout;case 4:return this.shapes;case 6:return this.slideMaster;case 7:return this.tags}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertyGetAsync(F){F=this.invokePropertyGet(F);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}invokePropertySet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertySetAsync(F,V){this.invokePropertySet(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(F,V){switch(F){case 3:return this.V2d();case 8:return this.Snl(V);case 2:return this.jI()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokeMethodAsync(F,V){F=this.invokeMethod(F,
V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}V2d(){this.deleteObject();return null}Snl(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"Array<string>");this.setSelectedShapes(F);return null}jI(){this._OnAccess();return null}}Object(h.a)(vm,"Slide",null,[]);class Sf{constructor(F){this.YUb=null;this.ABa=F;this.Krb=this.ABa.slides;this.KPk()}KPk(){this.YUb=new ka.ScriptSharpLegacyMap;if(this.Krb)for(const F of this.Krb){const V=new vm(F,this.ABa);this.YUb.add(V.id,
V)}}cfj(){return 0<this.getCount()?this.Krb[this.getCount()-1]:null}u$d(F){return F?F.jj:this.ABa.mY[0].Id}efj(F){const V=this.ABa.mY;for(let za=0;za<V.length;za++)if(F===V[za].Id)return V[za].ContentMasters[0].Id;return 0}add(F){if(ig.Eq(!0)){var V=new te(10);try{Le.a.J(572643278,802,50,"PptApi Call - SlideCollection.Add");const za=this.cfj();let gb=0;gb=F&&F.slideMasterId?parseInt(F.slideMasterId):this.u$d(za);let Fb=0;Fb=F&&F.layoutId?parseInt(F.layoutId):this.efj(gb);this.ABa.q_b(za,null,gb,Fb);
V.dw()}finally{V&&V.dispose()}}}getCount(){const F=new te(11);try{Le.a.J(572643279,802,50,"PptApi Call - SlideCollection.GetCount");if(!this.Krb)return Le.a.J(587747396,802,50,"In Slides.GetCount(), _slides is null"),0;F.dw();return this.Krb.length}finally{F&&F.dispose()}}getItem(F){const V=new te(13);try{Le.a.J(572643280,802,50,"PptApi Call - SlideCollection.GetItem");try{const za=this.YUb.ga(F);V.dw();return za}catch(za){throw Le.a.J(587747394,802,15,String.format("In Slide.GetItem(id), Exception: {0} ",
za.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItem(id)");}}finally{V&&V.dispose()}}getItemAt(F){const V=new te(12);try{Le.a.J(572643281,802,50,"PptApi Call - SlideCollection.GetItemAt");try{const za=this.YUb.ga(this.Krb[F].Db.toString());V.dw();return za}catch(za){throw Le.a.J(587747392,802,15,String.format("In Slide.GetItemAt(index), Exception: {0} ",za.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),
"InvalidParam passed to GetItemAt(index)");}}finally{V&&V.dispose()}}getItemOrNullObject(F){const V=new te(14);try{Le.a.J(572643282,802,50,"PptApi Call - SlideCollection.GetItemOrNullObject");let za;({value:za}=this.YUb.wg(F));V.dw();return za}finally{V&&V.dispose()}}_OnAccess(){}getAsyncEnumerator(F,V){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Dh(F,V,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideCollection"}invokePropertyGet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
}invokePropertyGetAsync(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}invokePropertySet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertySetAsync(F,V){this.invokePropertySet(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(F,V){switch(F){case 6:return this.Aci(V);case 1:return this.Q$a();case 5:return this.fab(V);case 2:return this.eab(V);case 3:return this.gab(V);
case 4:return this.jI()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokeMethodAsync(F,V){F=this.invokeMethod(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}Aci(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,Ji);this.add(F);return null}Q$a(){return this.getCount()}fab(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");return this.getItem(F)}eab(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,
0,"int");return this.getItemAt(F)}gab(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");return this.getItemOrNullObject(F)}jI(){this._OnAccess();return null}}Object(h.a)(Sf,"SlideCollection",null,[740]);class bm{constructor(F){this.ZUb=null;this.RYb=F;this.LPk()}LPk(){this.ZUb=new ka.ScriptSharpLegacyMap;if(this.RYb)for(const F of this.RYb){const V=new pl(F);this.ZUb.add(V.id,V)}}getCount(){const F=new te(24);try{Le.a.J(572643265,802,50,"PptApi Call - SlideMasterCollection.GetCount");
if(!this.RYb)return Le.a.J(576581645,802,50,"In SlideMasters.GetCount(), _slideMasters is null"),0;F.dw();return this.RYb.length}finally{F&&F.dispose()}}getItem(F){const V=new te(26);try{Le.a.J(572643266,802,50,"PptApi Call - SlideMasterCollection.GetItem");try{const za=this.ZUb.ga(F);V.dw();return za}catch(za){throw Le.a.J(576581646,802,15,String.format("In SlideMaster.GetItem(id), Exception: {0} ",za.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),
"InvalidParam passed to GetItem(id)");}}finally{V&&V.dispose()}}getItemAt(F){const V=new te(25);try{Le.a.J(572643267,802,50,"PptApi Call - SlideMasterCollection.GetItemAt");try{const za=this.ZUb.ga(this.RYb[F].Id.toString());V.dw();return za}catch(za){throw Le.a.J(576581647,802,15,String.format("In SlideMasters.GetItemAt(index), Exception: {0} ",za.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");
}}finally{V&&V.dispose()}}getItemOrNullObject(F){const V=new te(27);try{Le.a.J(572643268,802,50,"PptApi Call - SlideMasterCollection.GetItemOrNullObject");let za;({value:za}=this.ZUb.wg(F));V.dw();return za}finally{V&&V.dispose()}}_OnAccess(){}getAsyncEnumerator(F,V){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Dh(F,V,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideMasterCollection"}invokePropertyGet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
}invokePropertyGetAsync(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}invokePropertySet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertySetAsync(F,V){this.invokePropertySet(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(F,V){switch(F){case 1:return this.Q$a();case 2:return this.fab(V);case 3:return this.eab(V);case 4:return this.gab(V);case 5:return this.jI()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
}invokeMethodAsync(F,V){F=this.invokeMethod(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}Q$a(){return this.getCount()}fab(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");return this.getItem(F)}eab(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"int");return this.getItemAt(F)}gab(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");return this.getItemOrNullObject(F)}jI(){this._OnAccess();return null}}
Object(h.a)(bm,"SlideMasterCollection",null,[740]);class Vn{constructor(F){this.DE=new Zl;this.v5=F.presentation}get context(){return this.DE}get slideMasters(){const F=new te(2);try{Le.a.J(508908362,802,50,"PptApi Call - Presentation.GetSlideMasters");const V=new bm(this.v5.mY);F.dw();return V}finally{F&&F.dispose()}}get slides(){const F=new te(3);try{Le.a.J(508908361,802,50,"PptApi Call - Presentation.GetSlides");const V=new Sf(this.v5);F.dw();return V}finally{F&&F.dispose()}}get tags(){ig.Eq(!1);
return null}get title(){const F=new te(4);try{return Le.a.J(508908360,802,50,"PptApi Call - Presentation.GetTitle"),F.dw(),"This is the title property"}finally{F&&F.dispose()}}applyJOfcCommands(F){if(ig.Eq(!0))return OfficeExtension.WacRuntime.Utility.createPromise(V=>{const za={};za.promiseToResolve=V;za.requestBody=F;z.AFrameworkApplication.Ra.Ka(Pa.a.d6d,2,za)}).then(V=>{z.AFrameworkApplication.Ra.Ka(Pa.a.d6d,2,{promiseToResolve:null,requestBody:""});return V.toString()},()=>null)}getSelectedShapes(){ig.Eq(!1);
return null}getSelectedSlides(){ig.Eq(!1);return null}getSelectedTextRange(){ig.Eq(!1);return null}getSelectedTextRangeOrNullObject(){ig.Eq(!1);return null}insertSlidesFromBase64(){ig.Eq(!1)}setSelectedSlides(){ig.Eq(!1)}_RegisterEvent(F,V){OfficeExtension.WacRuntime.RichApi.getEventManager().register(this.context.controlId,F,V)}_UnregisterEvent(F,V){OfficeExtension.WacRuntime.RichApi.getEventManager().unregister(this.context.controlId,F,V)}getTypeName(){return"Microsoft.Office.PowerPoint.Presentation"}invokePropertyGet(F){switch(F){case 3:return this.slideMasters;
case 2:return this.slides;case 4:return this.tags;case 1:return this.title}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertyGetAsync(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}invokePropertySet(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokePropertySetAsync(F,V){this.invokePropertySet(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(F,
V){switch(F){case 5:return this.Qqj();case 6:return this.Sqj();case 7:return this.Xqj();case 9:return this.Yqj();case 1003:return this.mQj(V);case 8:return this.Tnl(V);case 1001:return this.fTh(V);case 1002:return this.kTh(V)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);}invokeMethodAsync(F,V){switch(F){case 10:return this.Vli(V)}F=this.invokeMethod(F,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)}Vli(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,
0,"string");return this.applyJOfcCommands(F)}Qqj(){return this.getSelectedShapes()}Sqj(){return this.getSelectedSlides()}Xqj(){return this.getSelectedTextRange()}Yqj(){return this.getSelectedTextRangeOrNullObject()}mQj(F){const V=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,1,sm);this.insertSlidesFromBase64(V,F);return null}Tnl(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"Array<string>");
this.setSelectedSlides(F);return null}fTh(F){const V=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,1,"int");this._RegisterEvent(V,F);return null}kTh(F){const V=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,1,"int");this._UnregisterEvent(V,F);return null}}Object(h.a)(Vn,"Presentation",null,[]);class sg{create(F){return new Vn(F)}}
Object(h.a)(sg,"PresentationFactory",null,[667]);class nf{create(F,V,za){return new ig(F,V,za)}}Object(h.a)(nf,"RichApiHostFactory",null,[593]);class Jj{constructor(F){this.nb=document.createElement("div");this.nb.className="AddinPaneFrame";this.oA=F}dispose(){}layout(F,V){this.oA.value.lCj(F,V);return F}get isVisible(){return!1}get va(){return this.nb}get order(){return 13}}Object(h.a)(Jj,"AddinPaneFrame",null,[557,587,107]);class If{constructor(){this.eeb=this.h7c=this.K=this.Oc=this.xH=null}get name(){return"PowerPointWebEditor.AppForOffice"}zla(F){return F.resolve("PowerPointWebEditor.IApplicationSettings").iA||
F.resolve("PowerPointWebEditor.IApplicationSettings").ZF}Yb(F){this.xH=F.resolve("Common.AFrameworkApplication");this.K=F;this.K.register(Jk,"PowerPointWebEditor.AppForOfficeApi.GetDocumentCopyHelper").as("PowerPointWebEditor.IGetDocumentCopyHelper").oa(()=>new Jk).ma();this.K.register(Yf,"PowerPointWebEditor.AppForOfficeFocusManager").as("PowerPointWebEditor.IAppForOfficeFocusManager").oa(()=>new Yf(this.K.resolve("PowerPointWebEditor.IAddinPaneFrame").va,this.K.resolve("PowerPointWebEditor.IFocusManager"),
this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.oe("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"))).ma();this.K.register(bd,"PowerPointWebEditor.AppForOfficeContentAppsContainer").as("PowerPointWebEditor.IAppForOfficeContentAppsContainer").oa(()=>new bd(this.K.resolve("PowerPointWebEditor.IPPTZoomManager"),this.K.resolve("Box4.IPageView").container,this.K.resolve("PowerPointWebEditor.IViewElementHelper"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"))).ma();Object(id.a)("RegisterPackageBeforeResolve")&&this.zla(this.K)&&(this.K.register(nf,"PowerPointWebEditor.AppForOfficeApi.RichApiHostFactory").as("PowerPointWebEditor.AppForOfficeApi.IRichApiHostFactory").oa(()=>new nf).ma(),
this.K.register(sg,"PowerPointWebEditor.AppForOfficeApi.PresentationFactory").as("PowerPointWebEditor.AppForOfficeApi.IPresentationFactory").oa(()=>new sg).ma());this.K.register(ve,"PowerPointWebEditor.AppForOfficeManager").as("PowerPointWebEditor.IAppForOfficeManager").oa(()=>new ve(this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.resolve("PowerPointWebEditor.IFrameContext"),new ji,this.K.resolve("PowerPointWebEditor.IAppForOfficeContentAppsContainer"),this.K.oe("PowerPointWebEditor.IClassFactory"),
this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IAppForOfficeFocusManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),
this.K.resolve("PowerPointWebEditor.IPresentationReader"),new G,M.getInstance(),this.K.oe("PowerPointWebEditor.IAppforOfficeClassFactory"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IGetDocumentCopyHelper"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.AppForOfficeApi.IRichApiHostFactory"),this.K.resolve("PowerPointWebEditor.AppForOfficeApi.IPresentationFactory"),this.K.resolve("Common.App.OAuth.IOAuthManager"))).ma();
const V=new n;this.K.register(Cb,"PowerPointWebEditor.AddinCommandsManager").as("PowerPointWebEditor.IAddinCommandsManager").oa(()=>new Cb(this.xH,this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),V,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IAppSettingsManager"),new oc,this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.resolve("Common.IRibbonExternal"),this.K.resolve("Common.IExternalUICommandDefinitionMapping"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),
this.K.resolve("PowerPointWebEditor.View.IViewEventSource"))).ma();this.K.register(vc,"PowerPointWebEditor.ContextMenuExtensibilityHandler").as("PowerPointWebEditor.IContextMenuExtensibilityHandler").oa(()=>new vc(V)).ma();this.K.register(Qi,"PowerPointWebEditor.AppForOfficeListenerManager").as("PowerPointWebEditor.IAppForOfficeListenerManager").oa(()=>new Qi(this.w9i())).ma();this.K.register(El,"PowerPointWebEditor.AppforOfficeClassFactory").as("PowerPointWebEditor.IAppforOfficeClassFactory").oa(()=>
new El(this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.resolve("PowerPointWebEditor.AppFrame"),this.K.resolve("PowerPointWebEditor.IAppForOfficeFocusManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.K.resolve("PowerPointWebEditor.ITaskPaneManager"))).ma();Object(id.a)("RegisterPackageBeforeResolve")&&this.zla(this.K)||(this.K.register(nf,"PowerPointWebEditor.AppForOfficeApi.RichApiHostFactory").as("PowerPointWebEditor.AppForOfficeApi.IRichApiHostFactory").oa(()=>new nf).ma(),this.K.register(sg,"PowerPointWebEditor.AppForOfficeApi.PresentationFactory").as("PowerPointWebEditor.AppForOfficeApi.IPresentationFactory").oa(()=>new sg).ma());this.K.register(557,"PowerPointWebEditor.IAddinPaneFrame").ma().oa(()=>
new Jj(this.K.oe("PowerPointWebEditor.IAppForOfficeFocusManager")));this.K.register(558,"PowerPointWebEditor.IAppForOfficeAuthFactory").ma().oa(()=>new Zd)}init(){z.AFrameworkApplication.ata||this.K.resolve("Common.IAppSettingsManager").ff(Object(D.a)(this,this.en,"onFullAppSettingsReady"))}en(){this.Oc=this.K.resolve("PowerPointWebEditor.IAppForOfficeManager");this.Oc.N2b=!0;z.AFrameworkApplication.fa.ka("OcpsIsEnabled")?this.K.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(F=>
{F.isFeatureEnabled(If.bmk,!0).then(V=>{this.Oc.N2b=V;this.aAb();return null})}):this.aAb()}aAb(){this.K.resolve("PowerPointWebEditor.IAddinCommandsManager");this.K.resolve("PowerPointWebEditor.IAppForOfficeAuthFactory");this.K.resolve("PowerPointWebEditor.IAppForOfficeListenerManager").tUe();this.K.resolve("PowerPointWebEditor.IAppForOfficeContentAppsContainer").initialize();const F=this.K.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory");F.DIl();F.EIl();F.gAj();this.CKl();this.vNj();this.K.resolve("PowerPointWebEditor.IAppForOfficeManager").initialize()}dispose(){this.K.resolve("PowerPointWebEditor.IAppForOfficeManager").dispose();
this.K.resolve("PowerPointWebEditor.IAppForOfficeListenerManager").dispose()}vNj(){const F=this.K.resolve("PowerPointWebEditor.IAddinPaneFrame"),V=this.K.resolve("PowerPointWebEditor.IFocusManager"),za=this.K.resolve("PowerPointWebEditor.IAppForOfficeFocusManager");V.q4(xh.a.asa,xh.a.Xi,F,!za.Cfe());this.xH.aq.yu()}w9i(){const F=[];var V=[];V.push(this.K.resolve("Box4.Graph.IGraphInstance").yd(47));V.push(this.K.resolve("Box4.Graph.IGraphInstance").yd(10));V=new Of(this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),
V,this.K.resolve("Box4.Graph.IGraphIteratorFactory"));F.push(V);V=new hc(this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("Box4.Graph.IGraphInstance").yd(49),this.K.resolve("Box4.Graph.IGraphIteratorFactory"));F.push(V);V=new Nd(this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"));F.push(V);V=new Nc(this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("Box4.Graph.IGraphInstance").yd(47));F.push(V);V=new ne(this.K.resolve("Box4.Graph.IGraphInstance").yd(8),this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.IAppforOfficeClassFactory"));F.push(V);return F}CKl(){this.eeb=z.AFrameworkApplication.fa.Ha("DevAddinManifestFileUrl");this.h7c=z.AFrameworkApplication.fa.Ha("DevAddinManifestGuid");var F=z.AFrameworkApplication.fa.Ha("IsDevAddinTest");if(this.eeb&&this.h7c&&F)if(F="true"===F,v.a.instance.getItem("optedIntoAddinDeveloperMode")||
F&&z.AFrameworkApplication.fa.ka("SuppressDeveloperAddinDialogs"))if(v.a.instance.getItem(this.h7c)||F&&z.AFrameworkApplication.fa.ka("SuppressDeveloperAddinDialogs"))this.Oc.Ui.validateAndCacheNewDevAddinManifest(this.eeb);else{F=new x.StandardDialog;F.Ad=4;const V=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.eeb)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;F.sP(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,
V,Object(D.a)(this,this.Dmh,"registerDevAddinManifestHandler"))}else F=Object(D.a)(this,this.Dmh,"registerDevAddinManifestHandler"),F=new Ve(this.eeb,F),F.Ad=0,F.showDialog(CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeTitle,CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeMessage)}Dmh(F){1===F&&this.eeb&&this.U2k()}U2k(){this.Oc&&(this.Oc.Ui.validateAndCacheNewDevAddinManifest(this.eeb),v.a.instance.setItem(this.h7c,"true"))}static main(){B.a.instance.Ac(new If)}}If.bmk=
"mso_officeStore";Object(h.a)(If,"AppForOfficePackage",null,[2,3]);var Je=d(13);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("OSF");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.AppForOfficeApi");Object(Je.c)("AppForOffice");Type.registerNamespace("CommandUI.AddInCommands");If.main();Object(Je.b)("AppForOffice")},387:function(K,U,d){d.d(U,"a",function(){return h});K=d(0);var h;(function(e){e[e.notSupported=-1]="notSupported";e[e.OMEX=
0]="OMEX";e[e.spCatalog=1]="spCatalog";e[e.spApp=2]="spApp";e[e.fileSystem=3]="fileSystem";e[e.exchange=4]="exchange";e[e.oneDrive=5]="oneDrive";e[e.registry=6]="registry";e[e.inMemory=7]="inMemory";e[e.uploadFileDevCatalog=8]="uploadFileDevCatalog";e[e.hardCodedPreinstall=9]="hardCodedPreinstall";e[e.privateCatalog=10]="privateCatalog";e[e.wopiCatalog=16]="wopiCatalog"})(h||(h={}));Object(K.b)("AddinProviderType",h)},452:function(K,U,d){d.d(U,"a",function(){return r});K=d(0);var h=d(392),e=d(194);
class r{static YAh(m){return parseInt(r.hnb(e.a.GTd,m)||"-1")<=(new Date).getTime()}static e9d(m){return parseInt(r.hnb(e.a.B7a,m)||"-1")}static Dfe(m){return Boolean.parse(r.hnb(e.a.Rsb,m)||"false")}static hnb(m,n){let z=null;try{const v=r.kab();if(void 0!==v&&v){const x=e.a.WTc(m)+n;z=v.getItem(x)}else h.ULS.sendTraceTag(42074645,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(v){h.ULS.sendTraceTag(42074646,220,10,"Failed to get AddinCommands Cache {0} for ProviderType {1}.",
m,n)}return z}static lnb(m,n,z){try{const v=r.kab();if(void 0!==v&&v){const x=e.a.WTc(m)+z;v.setItem(x,n)}else h.ULS.sendTraceTag(42074647,220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(v){h.ULS.sendTraceTag(42074648,220,10,"Failed to set AddinCommands Cache {0} for ProviderType {1}.",m,z)}}static kab(){if(!r.$Ua)return null;let m=null;try{m=localStorage}catch(n){r.$Ua=!1,m=null}return m}}r.$Ua=!0;Object(K.a)(r,"AddinUtil",null,[])},548:function(K,U,d){d.d(U,"a",
function(){return h});K=d(0);var h;(function(e){e[e.notSupported=0]="notSupported";e[e.launchByLocalCacheInitializer=1]="launchByLocalCacheInitializer";e[e.launchByAnonymousApiInitializer=2]="launchByAnonymousApiInitializer";e[e.launchByInsertion=3]="launchByInsertion";e[e.launchByRefresh=4]="launchByRefresh";e[e.launchByLastUpdateInitializer=5]="launchByLastUpdateInitializer";e[e.launchByDynamicCall=6]="launchByDynamicCall"})(h||(h={}));Object(K.b)("AddinCommandsLaunchOperationType",h)},556:function(K,
U,d){d.r(U);K=d(0);var h=d(18),e=d(392),r=d(72);class m{constructor(){this.startTime=0;this.callback=null}}Object(K.a)(m,"SSOCallbackInfo",null,[]);class n{constructor(){this.accessToken=null}}Object(K.a)(n,"AccessTokenInformation",null,[849]);var z=d(1E3);class v{constructor(){this.token=null;this.expiresOn=0;this.LCa=this.rW=null}}Object(K.a)(v,"CachedTokenInfo",null,[]);class x{constructor(){this.Uyc=new h.a;this.dsa=this.csa=!1;this.TMa=this.rW=null;this.startTime=this.retryCount=0;this.bAf=null}get JXd(){return this.Uyc}}
Object(K.a)(x,"SSORequestInfo",null,[]);class B extends x{constructor(){super();this.errorCode=0}}Object(K.a)(B,"SSOFailedRequestInfo",x,[]);var D=d(27);class w{constructor(ca,L,da,Z){this.T7=new h.a;this.AS=new h.a;this.TNa=null;this.NXb=new h.a;this.Rlf=Promise.resolve(null);this.mtf=!1;this.V5h=L;this.vqa=ca;this.JGc=da;this.JTh=Z}ktl(ca){if(this.TNa&&this.TNa.rW===ca.rW){if(Date.now()/1E3+w.Suk>this.TNa.expiresOn)return this.TNa=null,!1;ca=new z.a;ca.token=this.TNa.token;ca.expiresOn=this.TNa.expiresOn;
ca.LCa=this.TNa.LCa;ca.Wmb=!0;ca.R8b=0;this.B9b(ca);return!0}return!1}Irl(ca){for(let L=0;L<this.AS.count;L++)if(this.AS.ga(L).rW===ca.rW&&this.AS.ga(L).TMa===ca.TMa){let da;(da=this.AS.ga(L)).retryCount=da.retryCount+1;ca.retryCount=this.AS.ga(L).retryCount;if(this.AS.ga(L).retryCount<w.NZa||!this.AS.ga(L).csa&&ca.csa||!this.AS.ga(L).dsa&&ca.dsa){if(!this.AS.ga(L).csa&&ca.csa||!this.AS.ga(L).dsa&&ca.dsa)ca.retryCount=0;this.AS.removeAt(L);break}ca=new z.a;ca.errorCode=this.AS.ga(L).errorCode;this.B9b(ca);
return!0}return!1}rei(ca,L){for(let da=0;da<this.AS.count;da++)if(this.AS.ga(da).TMa===ca.TMa&&this.AS.ga(da).rW===ca.rW)return;this.AS.add(Object.assign(new B,{csa:ca.csa,dsa:ca.dsa,rW:ca.rW,TMa:ca.TMa,errorCode:L,retryCount:ca.retryCount}))}get resource(){return this.V5h}a9d(ca,L,da,Z,fa,aa){const {AppsForOfficeSingleSignOnManager:ja}=d(556);""===da&&(da=null);if(this.mtf)ja.cma(aa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var I=null;for(let sa of this.T7)if(sa.csa===
ca&&sa.dsa===L&&sa.rW===da&&sa.TMa===fa){I=sa;break}I||(I=Object.assign(new x,{csa:ca,dsa:L,rW:da,bAf:Z,TMa:fa,retryCount:0,startTime:ja.RF()}),this.T7.add(I));I.retryCount=0;I.JXd.add(aa);this.Rlf=this.Rlf.then(()=>{var {AppsForOfficeSingleSignOnManager:sa}=d(556);if(0<this.T7.count){var ka=this.T7.ga(0);if(this.ktl(ka)||this.Irl(ka))return null;for(let Ea=0;Ea<this.NXb.count;)this.NXb.ga(Ea)+w.LFl<sa.RF()?this.NXb.removeAt(Ea):Ea++;if(this.NXb.count>=w.gvk||this.T7.count>=w.Puk)return ka=new z.a,
ka.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.B9b(ka),null;let Ma=null;D.AFrameworkApplication.Aa&&(sa=D.AFrameworkApplication.Aa.vV)&&(Ma=sa.Ii("ComponentAttach",this.vqa+w.i8h));return ka.TMa.iai(this.resource,ka.csa,ka.dsa,ka.rW,this.JTh,ka.bAf).then(Ea=>{Ma&&Ma.stop();this.B9b(Ea)},()=>{Ma&&Ma.stop();const Ea=new z.a;Ea.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.B9b(Ea)})}return null})}}B9b(ca){const {AppsForOfficeSingleSignOnManager:L}=d(556);
try{if(this.T7.count){var da=this.T7.ga(0);this.T7.removeAt(0);var Z=null;ca.errorCode||(Z=new n,Z.accessToken=ca.token);ca.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&ca.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&ca.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&ca.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.rei(da,ca.errorCode);var fa={};null!=ca.R8b&&(fa.getTokenSilentTime=ca.R8b.toString());
null!=ca.Tde&&(fa.getTokenPopupTime=ca.Tde.toString());null!=ca.uae&&(fa.getIDTokenTime=ca.uae.toString());null!=ca.Wmb&&(fa.tokenCached=ca.Wmb.toString());ca.t5e&&(fa.detailedError=ca.t5e);ca.LCa&&(fa.authLibrary=ca.LCa);da.retryCount&&(fa.retryCount=da.retryCount);for(var aa of da.JXd)L.cma(aa,ca.errorCode,Z,fa);null!=ca.Wmb&&ca.Wmb||this.NXb.add(da.startTime);if(!ca.errorCode)for(null!=ca.expiresOn&&(this.TNa=Object.assign(new v,{token:ca.token,expiresOn:ca.expiresOn,rW:da.rW,LCa:ca.LCa})),this.AS.clear(),
aa=0;aa<this.T7.count;)if(this.T7.ga(aa).rW===da.rW){for(let ja of this.T7.ga(aa).JXd)L.cma(ja,ca.errorCode,Z,fa);this.T7.removeAt(aa)}else aa++}}catch(ja){e.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",ja.message)}}shutdown(){this.mtf=!0;this.T7.clear()}}w.LFl=6E4;w.gvk=6;w.Puk=6;w.NZa=3;w.Suk=300;w.i8h="GetAccessToken";Object(K.a)(w,"SSOCallbackManager",null,[]);var J=d(194),G=d(227),M=d(170),N=d(81),R=d(55),C=d(47),O=d(142),S=d(171);d.d(U,"AppsForOfficeSingleSignOnManager",
function(){return T});class T{constructor(ca,L,da=null){this.dob=new r.a;const Z=new h.a;L&&Z.add(L.$rk);da&&Z.addRange(da);this.cB=ca;this.s9h=Z}removeCallbackForAddin(ca){this.dob.Fb(ca)&&(this.dob.ga(ca).shutdown(),this.dob.remove(ca))}b9d(ca,L,da,Z,fa,aa,ja,I,sa,ka){ka=Object.assign(new m,{startTime:T.RF(),callback:ka});try{const ma=!!da&&""!==da;var Ma=ka.startTime;const va=this.getOsfControl(ca);let Ca=va.getStoreType()||"",oa=va.getOwnerAddinStoreType()||"",Da=va.getSolutionId()||"";const ta=
va.getVersion()||"";Ca=Ca.toLowerCase();oa=oa.toLowerCase();Da=Da.toLowerCase();var Ea=N.a.GVc(L)||"";const ha=N.a.GVc(va.getIframeUrl())||"",Ha=Ea.toLowerCase()===ha.toLowerCase();Ea=Ca;"inmemory"===Ca&&(Ea=oa);const bb=Telemetry.PrivacyRules.GetPrivacyCompliantId(Da,Ea,va.getAssetId(),null,null,va.getStoreId()),Na={["callInstanceId"]:Ma.toString(),["controlSolutionId"]:bb,["controlVersion"]:ta,["storeType"]:Ca,["ownerStoreType"]:oa,["allowConsentPrompt"]:Z.toString(),["forMSGraphAccess"]:fa.toString(),
["allowSignInPrompt"]:aa.toString(),["hasAddinAuthChallenge"]:ma.toString(),["securityOriginEqualsSourceLocation"]:Ha.toString(),["singleSignOnEnabled"]:ja.toString(),["accountTypeFilter"]:I||""};e.ULS.sendTraceTag(51401115,344,50,"{0}",Na);O.a.sendTelemetryEvent(Object.assign(new S.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:M.a.kz(Na)}));Ma=!0;const Ia=D.AFrameworkApplication.fa.Ha("HostAuthType");switch(I){case "aad":Ma="aad"===Ia;break;case "msa":Ma="msa"===Ia;break;
default:Ma=!I||"noFilter"===I}if(Ma){I=null;if(ja)for(let Qa of this.s9h)if(Qa.jWj(Da)){I=Qa;break}I?this.isSSOAddin(ca)?(ja=!0,"omex"===Ea&&(ja=!1),"spapp"===Ea||"spcatalog"===Ea?(e.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),T.cma(ka,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):fa&&!ja?(e.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),T.cma(ka,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,
null,null)):(fa&&"exchange"===Ea&&(Z=!1),this.a9d(ca,L,da,Ea,Z,aa,sa,I,ka))):(e.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),T.cma(ka,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):T.cma(ka,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else T.cma(ka,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(ma){this.U4c(),e.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",
ma.message),T.cma(ka,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(ca,L,da,Z){this.b9d(ca,da[J.a.yJc]||null,da[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,da[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,da[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,da[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,L,da[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||
null,da[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,Z)}a9d(ca,L,da,Z,fa,aa,ja,I,sa){this.dob.Fb(ca)?Z=this.dob.ga(ca):(Z=new w(ca,this.getWebApplicationResource(ca).split(",")[0],Z,this.getDefaultDisplayName(ca)),this.dob.add(ca,Z));const ka=Z.resource;ca=T.Epj(ka,this.getWebApplicationId(ca));const Ma=OfficeExt.WACUtils.getHostSecure(L);ca&&Ma?ca.toLowerCase()===Ma.toLowerCase()?Z.a9d(fa,aa,da,ja,I,sa):(T.qdb('SSO Resource "'+ka+'" cannot be used from "'+L+'" origin due to domain mismatch.'),
e.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),T.cma(sa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(ca||e.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),Ma||e.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),T.cma(sa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))}U4c(){e.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(ca){return this.cB.getOsfControl(ca)}isSSOAddin(ca){return this.getOsfControl(ca).getManifest().isSSOAddin()}getWebApplicationId(ca){return this.getOsfControl(ca).getManifest().getWebApplicationId()}getWebApplicationResource(ca){return this.getOsfControl(ca).getManifest().getWebApplicationResource()}getDefaultDisplayName(ca){return this.getOsfControl(ca).getManifest().getDefaultDisplayName()}static ebg(){try{const ca=
{};R.a.xGa&&G.OAuthManagerSettings.lbb&&(ca.UiHostSupportsAuthTokenAddinList=T.WSc);ca.UiHostSupportsAuthToken=G.OAuthManagerSettings.lbb;return ca}catch(ca){e.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",ca.message)}return null}static getInstance(ca,L,da=null){T.La||(T.La=new T(ca,da));return T.La}static zyi(ca){T.La&&T.La.removeCallbackForAddin(ca)}static qdb(ca){window.console.warn&&window.console.warn(ca)}static Epj(ca,L){if(!ca)return"";L||(L="");
let da=ca.toLowerCase();var Z=L.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(Z)||(T.qdb('SSO App Id "'+L+'" is not a valid format. It will be rejected from store submission.'),e.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));da.endsWith(Z)||(T.qdb('SSO Resource "'+ca+'" does not end with App Id "'+L+'". It will be rejected from store submission.'),e.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!da.startsWith("https://")&&
!da.startsWith("api://"))return T.qdb('SSO Resource "'+ca+'" must be https:// or api:// protocol.'),e.ULS.sendTraceTag(590962909,344,10,"Resource not using https or api protocol."),"";for(L=0;L<ca.length;L++){Z=ca.charAt(L);const fa=C.a.charCodeAt(ca,L);if(33>fa||126<fa||"&"===Z||"?"===Z||"#"===Z||"%"===Z||"\\"===Z)return T.qdb('SSO Resource "'+ca+'" contains an invalid character "'+Z+'".'),e.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+Z+"' in resource URI."),""}if(0<=ca.indexOf("::"))return T.qdb('SSO Resource "'+
ca+'" contains an invalid string "::".'),e.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<ca.length)return T.qdb('SSO Resource "'+ca+'" is '+ca.length+" characters and exceeds the max length of 120 characters."),e.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+ca.length+"."),"";da.startsWith("api://")&&(da="https://"+da.substring(6,da.length));return 8===da.length?"":OfficeExt.WACUtils.getHostSecure(da)||""}static cma(ca,L,da,Z){var fa=ca.startTime;let aa=0;0<fa&&(aa=
T.RF()-fa);fa={["callInstanceId"]:fa.toString(),["callDuration"]:aa.toString(),["errorCode"]:L.toString()};if(Z)for(let ja in Z)fa[ja]=Z[ja];e.ULS.sendTraceTag(51401116,344,50,"{0}",fa);O.a.sendTelemetryEvent(Object.assign(new S.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:M.a.kz(fa)}));ca.callback(L,da)}static RF(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(ca){}return Date.now()}}T.WSc="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");
T.La=null;Object(K.a)(T,"AppsForOfficeSingleSignOnManager",null,[790])},706:function(K,U,d){d.d(U,"a",function(){return e});K=d(0);var h=d(18);class e{static Imh(r){e.f$b.add(r)}static ovh(r){for(let m of e.f$b)m(r)}static Rmh(r){e.Nkb.add(r);if(0<e.TKa.count){for(let m of e.TKa)r(m);e.TKa=new h.a}}static wvh(r){if(0<e.Nkb.count)for(let m of e.Nkb)m(r);else e.TKa.add(r)}}e.TKa=new h.a;e.Nkb=new h.a;e.f$b=new h.a;Object(K.a)(e,"AugLoopEventUtils",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19809348/wdjs/ppteditDS.appforoffice.js.map